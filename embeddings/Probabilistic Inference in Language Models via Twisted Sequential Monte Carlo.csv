text,embedding,file
"Probabilistic Inference in Language Models
via Twisted Sequential Monte Carlo
Stephen Zhao1 2 *Rob Brekelmans2 *Alireza Makhzani1 2 **Roger Grosse1 2 **
Abstract
Numerous capability and safety techniques of
Large Language Models (LLMs), including
RLHF, automated red-teaming, prompt engineer-
ing, and infilling, can be cast as sampling from
an unnormalized target distribution defined by a
given reward or potential function over the full se-
quence. In this work, we leverage the rich toolkit
of Sequential Monte Carlo (SMC) for these prob-
abilistic inference problems. In particular, we use
learned twist functions to estimate the expected fu-
ture value of the potential at each timestep, which
enables us to focus inference-time computation
on promising partial sequences. We propose a
novel contrastive method for learning the twist
functions, and establish connections with the rich
literature of soft reinforcement learning. As a
complementary application of our twisted SMC
framework, we present methods for evaluating the
accuracy of language model inference techniques
using novel bidirectional SMC bounds on the log
partition function. These bounds can be used to
estimate the KL divergence between the infer-
ence and target distributions in both directions.
We apply our inference evaluation techniques to
show that twisted SMC is effective for sampling
undesirable outputs from a pretrained model (a
useful component of harmlessness training and
automated red-teaming), generating reviews with
varied sentiment, and performing infilling tasks.
1. Introduction
A wide range of language model learning and inference
tasks can be viewed as steering a model’s generations to
satisfy a specified property. In particular, traditional rein-
forcement learning from human feedback ( RLHF ) pipelines
(Ziegler et al., 2019; Stiennon et al., 2020; Ouyang et al.,
2022; Bai et al., 2022; Rafailov et al., 2023) may be viewed
as targeting an unnormalized target modulated by a terminal
*Joint first authorship,**Joint senior authorship.1University
of Toronto2Vector Institute. Contact: {stephenzhao, makhzani,
rgrosse }@cs.toronto.edu , rob.brekelmans@vectorinstitute.ai .reward function which reflects human feedback (Korbak
et al., 2022b). Red-teaming techniques such as prompt-
engineering and infilling may seek target outputs with low
reward or (high probability of) undesirable responses (Zou
et al., 2023; Perez et al., 2022). In reasoning tasks, we may
seek to target outputs which are likely to be deemed valid
by a ‘verifier’ (Cobbe et al., 2021; Anil et al., 2021; Dohan
et al., 2022; Hu et al., 2023). Specific properties of the
generated responses might also be enforced (Khalifa et al.,
2020; Yang & Klein, 2021; Lew et al., 2023).
We view the above tasks as instances of probabilistic in-
ference : sampling from a target unnormalized density and
estimating its intractable (log) normalization constant. Con-
sider a pretrained base model p0(s1:T|s0)which generates
responses s1:Tof maximum length Tbased on a variable-
length prompt s0. We consider defining the target distri-
bution of interest using the base model modulated by a
potential function ϕ(s1:T)which evaluates full sequences,
σ(s1:T|s0):=1
Zσ(s0)p0(s1:T|s0)ϕ(s1:T), (1)
where Zσ(s0):=X
s1:T˜σ(s1:T|s0) =X
s1:Tp0(s1:T|s0)ϕ(s1:T),
where ˜σ(s1:T|s0)denotes the unnormalized density. We
refer to Zσ(s0)as the normalization constant or partition
function, which is intractable due to the summation over
s1:T. We drop dependence on s0to avoid clutter, but note
that each prompt induces a different partition function. In
the context of the aforementioned applications, ϕ(s1:T)may
be derived from a human preference model (for RLHF), an
indication of bad behavior (for automated red-teaming), or a
verifier’s prediction of correctness (for reasoning tasks). We
refer to Table 5 or Korbak et al. (2022b); Dohan","[0.013793017715215683, -0.00890599749982357, 0.026465097442269325, 0.027900446206331253, -0.0154880965128541, 0.015077996999025345, 0.017661625519394875, 0.02933579497039318, -0.03617078810930252, 0.04076390340924263, 0.040982622653245926, -0.026027657091617584, -0.02329365909099579, 0.03310871124267578, 0.027955126017332077, -0.044591501355171204, 0.018741553649306297, 0.00029305036878213286, -0.01863219402730465, 0.019807813689112663, -0.012508039362728596, 0.006079727318137884, -0.027681725099682808, 0.01781199499964714, -0.004688805900514126, -0.026806846261024475, 0.01876889355480671, -0.0014310769038274884, 0.01336241327226162, -0.010901815257966518, 0.056046951562166214, -0.029527174308896065, -0.0656159445643425, -0.01312318816781044, -0.04103730618953705, 0.03923286497592926, 0.01614425517618656, 0.020928751677274704, -0.006879421416670084, 0.022965580224990845, -0.0059737847186625, -0.046013180166482925, -0.014339817687869072, 0.03701832890510559, 0.0048494283109903336, 0.07163073867559433, 0.009849226102232933, -0.0016275829402729869, -0.011127370409667492, 0.07113862037658691, -0.03781118616461754, 0.004517931025475264, -0.01792135462164879, -0.00999276153743267, 0.014121097512543201, 0.006609439384192228, 0.013943388126790524, 0.007703038398176432, -0.002064168220385909, -0.02220006100833416, 0.018809903413057327, -0.04248632490634918, -0.005871260073035955, 0.02947249449789524, -0.04204888269305229, -0.023949818685650826, -0.04035380482673645, 0.016786744818091393, -0.016335636377334595, 0.06102282553911209, -0.027148596942424774, 0.018673203885555267, 0.0296091940253973, 0.02553553692996502, -0.03953360393643379, 0.004070239141583443, 0.004411988891661167, 0.06135090813040733, -0.00935027189552784, -0.03362816944718361, 0.004306046292185783, -0.048255059868097305, 0.02971855364739895, -0.037346407771110535, -0.020108552649617195, -0.03045673295855522, -0.013177868910133839, 0.0013516200706362724, -0.040982622653245926, -0.03297201171517372, -0.021530231460928917, 0.02226841077208519, -0.01327355857938528, -0.007094723638147116, 0.0706465020775795, -0.009473301470279694, 0.01298648864030838, -0.005245857872068882, 0.05044225603342056, -0.003246622160077095, 0.003338894573971629, -0.01591186597943306, 0.0377291664481163, -0.06184302642941475, 0.056593749672174454, 0.013492277823388577, -0.008420712314546108, 0.018946602940559387, -0.027203276753425598, -0.01315736398100853, -0.040572524070739746, -0.01947973296046257, -0.049075257033109665, 0.004234279040247202, -0.017183175310492516, -0.052410732954740524, -0.05161787569522858, -0.01941138319671154, 0.010478045791387558, 0.012508039362728596, -0.027900446206331253, -0.003998471423983574, 0.025412507355213165, -0.005782404914498329, 0.007737213280051947, -0.0010372103424742818, 0.008919667452573776, -0.05965582653880119, 0.009603166952729225, 0.02634206786751747, -0.005280032753944397, 0.03042939305305481, -0.017005465924739838, -0.01808539405465126, -0.028980374336242676, -0.010922320187091827, -0.0067529743537306786, -0.002038537058979273, -0.01699179597198963, 0.004360726103186607, -0.02284255065023899, -0.01232349406927824, -0.02107912115752697, -0.00463070860132575, -0.02094242163002491, -0.032015111297369, -0.023676419630646706, 0.002827978692948818, -0.009562157094478607, 0.03425699099898338, 0.001778807258233428, -0.02971855364739895, -0.04232228174805641, 0.03466708958148956, -0.02029993198812008, -0.05752331018447876, -0.0416114442050457, 0.0498407781124115, 0.03518654778599739, -0.06321002542972565, 0.0018813321366906166, 0.06370214372873306, -0.008359197527170181, 0.004104414023458958, 0.0217216107994318, 0.009808216243982315, -0.039041485637426376, 0.0448102205991745, -0.03936956450343132, -0.024523958563804626, -0.01682775467634201, -0.013731502927839756, -0.0567031092941761, -0.04828239977359772, 0.020573332905769348, -0.028570275753736496, -0.0021000518463552, -0.06490510702133179, 0.010512220673263073, -0.02400449849665165, -0.04188484326004982, 0.0653972253203392, -0.04215824231505394, -0.004398318473249674, 0.002723745070397854, 0.023279989138245583, -0.03625280782580376, 0.03187841176986694, 0.028023475781083107, 0.012760933488607407, 0.00011801044456660748, 0.04954003542661667, 0.08841748535633087, 0.02359439991414547, -0.012261979281902313, -0.01130507979542017, 0.07824701070785522, 0.04284174367785454, 0.015337727032601833, -0.03324541077017784, 0.03073013387620449, 0.00453160097822547, -0.019055962562561035, -0.059273067861795425, 0.01788034476339817, 0.004165928810834885, -0.010211480781435966, 0.03086683340370655, -0.05126245692372322, -0.004576028324663639, 0.01598021574318409, -0.017046475782990456, 0.04888387769460678, 0.018345123156905174, -0.040545184165239334, 0.015597456134855747, -0.03477644920349121, 0.015474426560103893, -0.013683658093214035, 0.056757789105176926, 0.013328238390386105, 0.02947249449789524, 0.041966862976551056, 0.010607910342514515, -0.04964939504861832, 0.04262302443385124, 0.022077031433582306, -0.031605012714862823, 0.04954003542661667, -0.021024441346526146, 0.05336763337254524, 0.007053713779896498, -0.014777257107198238, -0.04661465808749199, -0.002291431650519371, 0.00583024974912405, 0.002839940134435892, 0.006927266251295805, -0.01487294677644968, -0.06999033689498901, 0.015009647235274315, 0.0031851071398705244, 0.05115309730172157, -0.021940330043435097, 0.03759246692061424, 0.04697008058428764, -0.023334668949246407, 0.022350430488586426, 0.04923929646611214, 0.026027657091617584, 0.0034670508466660976, -0.04147474467754364, -0.013437598012387753, 0.022104371339082718, -0.040299125015735626, -0.0035507793072611094, -0.0169234462082386, -0.01562479604035616, -0.027613375335931778, -0.026068666949868202, -0.012808779254555702, -0.02410018816590309, -0.043060462921857834, 0.03466708958148956, -0.039424244314432144, -0.04300578311085701, -0.039424244314432144, 0.0006070329109206796, 0.03422965109348297, -0.041966862976551056, -0.0025665403809398413, -0.0020402458030730486, -0.011482790112495422, 0.01168100442737341, -0.015460756607353687, -0.06413958221673965, 0.03625280782580376, 0.044482141733169556, -0.026054996997117996, 0.019971853122115135, -0.01876889355480671, -0.008366032503545284, 0.03461240977048874, -0.030265353620052338, -0.004353891126811504, 0.029554514214396477, 0.007026373874396086, -0.019261013716459274, 0.00200607068836689, -0.07004501670598984, 0.0026929876767098904, 0.012282484211027622, 0.005662792362272739, -0.018577514216303825, 0.027271626517176628, 0.01487294677644968, 0.023813119158148766, -0.0036088768392801285, -0.0009722778922878206, 0.020381951704621315, 0.05752331018447876, -0.0025255302898585796, -0.010033771395683289, 0.0023256067652255297, 0.00467513594776392, 0.02576792798936367, 0.010361851193010807, 0.011674169450998306, -0.016786744818091393, 0.02297925017774105, 0.012248309329152107, 0.01050538569688797, -0.008065292611718178, 0.03425699099898338, -0.01934303343296051, -0.017360884696245193, 0.05077033489942551, -0.039287544786930084, 0.03770182654261589, -0.04904791712760925, -0.04352524131536484, 0.03272595256567001, 0.006961441598832607, -0.010088451206684113, 0.017497584223747253, 0.0027801338583230972, -0.008591587655246258, -0.002052207011729479, -0.021202150732278824, 0.019397713243961334, 0.03100353293120861, 0.03461240977048874, 0.021530231460928917, 0.002322189277037978, -0.013799852691590786, -0.06643614172935486, -0.027832096442580223, 0.04440012201666832, -0.003571284469217062, 0.015077996999025345, -0.07551301270723343, 0.009692021645605564, -0.013389753177762032, -0.025849947705864906, -0.008058457635343075, 0.010184140875935555, 0.009644176810979843, 0.023102279752492905, 0.07152137905359268, 0.01220729947090149, 0.011325584724545479, -0.010908650234341621, 0.018331453204154968, -0.011134205386042595, -0.0006399262929335237, 0.029663873836398125, -0.011633159592747688, -0.012924973852932453, -0.0011260652681812644, -0.015474426560103893, -0.03488580882549286, -0.003154349746182561, 0.003273962065577507, 0.007600513286888599, -0.000915889220777899, 0.029007714241743088, -0.03898680582642555, 0.020819392055273056, 0.015898196026682854, 0.0051877605728805065, -0.00021604988432954997, 0.01913798414170742, -0.001513951225206256, 0.01975313201546669, -0.024975068867206573, -0.0019411382963880897, -0.0022606742568314075, 0.0017839334905147552, 0.030402053147554398, 0.027039237320423126, 0.017087485641241074, -0.005341548006981611, -0.009316097013652325, -0.026123346760869026, -0.014189447276294231, 0.020887741819024086, 0.008031117729842663, -0.045165639370679855, -0.028788994997739792, 0.0022145381662994623, 0.020545993000268936, -0.01740189455449581, -0.013164198957383633, 0.0301833339035511, 0.02396348863840103, -0.005403062794357538, -0.01744290441274643, 0.04951269552111626, 0.061241548508405685, 0.025986647233366966, -0.041556764394044876, -0.03272595256567001, -0.04932131618261337, -0.00423086155205965, -0.027066577225923538, 0.05180925503373146, 0.029144413769245148, 0.0201222226023674, 0.018112733960151672, 0.04672401770949364, 0.05036023631691933, -0.05219201371073723, 0.025931967422366142, -0.02199501171708107, 0.04604052007198334, -0.06845930218696594, 0.0498407781124115, 0.01747024431824684, 0.07130265980958939, 0.07830169051885605, -0.0005929357139393687, -0.0617336668074131, 0.0026075502391904593, 0.013437598012387753, 0.013567463494837284, 0.015173686668276787, 0.03059343248605728, -0.02539883740246296, 0.018536504358053207, -0.05038757622241974, 0.010614745318889618, 0.05823414772748947, 0.01522836647927761, -0.017770985141396523, -0.02315695956349373, -0.02322530932724476, 0.04311514273285866, -0.001666884170845151, -0.008475393056869507, -0.059109028428792953, 0.0169234462082386, -0.011571644805371761, -0.0646863803267479, 0.005819997284561396, 0.0013234256766736507, 0.020682692527770996, -0.02522112801671028, -0.01140760537236929, 0.03179639205336571, -0.043607261031866074, 0.03299935162067413, 0.0009218698251061141, 0.06807654350996017, 0.013875038363039494, 0.016376646235585213, -0.03885010629892349, 0.07824701070785522, -0.026424087584018707, 0.039588283747434616, -0.0017190009821206331, 0.013075343333184719, 0.012077434919774532, 0.005529510322958231, -0.024701667949557304, 0.022008681669831276, 0.03182373195886612, 0.02494772896170616, -0.01176302507519722, -0.019356703385710716, 0.020313601940870285, 0.02933579497039318, -0.03849468752741814, 0.020928751677274704, -0.0020692944526672363, -0.027517685666680336, -0.01562479604035616, 0.05503537133336067, -0.060804106295108795, -0.0013516200706362724, 0.0014353487640619278, 0.0024469278287142515, -0.005488499999046326, 0.03086683340370655, 0.027832096442580223, 0.018522834405303, 0.04923929646611214, 0.009452796541154385, 0.015269376337528229, -0.007846573367714882, 0.024387259036302567, -0.016034895554184914, -0.061788346618413925, 0.04535702243447304, -0.015952875837683678, 0.032753292471170425, -0.03729172796010971, 0.019630102440714836, 0.009138386696577072, -0.023143289610743523, -0.02416853979229927, 0.029089733958244324, -0.01312318816781044, -0.010225150734186172, 0.04248632490634918, 0.01675940491259098, 0.05183659493923187, 0.05779670923948288, -0.002395665505900979, -0.008085797540843487, 0.06156962737441063, -0.020067542791366577, -0.013546958565711975, -0.017142165452241898, 0.002064168220385909, 0.008823977783322334, 0.019698452204465866, -0.031331613659858704, -0.013724667951464653, 0.010669426061213017, 0.011503295041620731, 0.037619806826114655, -0.021502891555428505, -0.03165969252586365, -0.01733354479074478, 0.02658812701702118, 0.017429234459996223, -0.020614342764019966, -0.07802829146385193, -0.03032003343105316, -0.05112575739622116, 0.030620774254202843, -0.006653866730630398, 0.004261618945747614, 0.008878657594323158, -0.04035380482673645, 0.014039077796041965, -0.031085552647709846, -0.028980374336242676, -0.02250079996883869, 0.005071565508842468, 0.0007134025217965245, 0.011434945277869701, 0.0074843186885118484, -0.0004442745994310826, -0.003053533611819148, -0.0010243947617709637, -0.0017318165628239512, -0.019575422629714012, 0.006476156879216433, 0.014927626587450504, 0.040572524070739746, -0.03682694956660271, -0.02382678911089897, -0.03745576739311218, -0.0013259887928143144, 0.002330732997506857, -0.0048562632873654366, 0.0005194595432840288, -0.0004098860372323543, 0.0029851836152374744, 0.019999193027615547, -0.022446120157837868, -0.01961643248796463, 0.010266161523759365, -0.0163493063300848, -0.005020303186029196, 0.02297925017774105, -0.022172721102833748, 0.003540526842698455, 0.02958185411989689, -0.055336110293865204, -0.004647796042263508, 0.01879623346030712, -0.03518654778599739, 0.0030654948204755783, -0.03669024631381035, 0.023498710244894028, -0.04133804515004158, 0.02338934876024723, 0.00364988693036139, -0.022364100441336632, 0.0051604206673800945, 0.01563846692442894, -0.029390474781394005, -0.020833062008023262, 0.009507476352155209, 0.011749355122447014, 0.012487534433603287, -0.029007714241743088, -0.002113721799105406, 0.03286265209317207, -0.00039279856719076633, -0.011298244819045067, -0.007853408344089985, -0.061788346618413925, 0.005088652949780226, 0.0173745546489954, -0.019124314188957214, -0.029226435348391533, 0.0252621378749609, 0.02784576639533043, 0.010847135446965694, -0.00866677239537239, -0.02019057236611843, -0.03297201171517372, 0.04273238405585289, -0.037073008716106415, 0.017524924129247665, 0.024086518213152885, -0.018413474783301353, 0.00547483004629612, 0.013553793542087078, 0.010525890626013279, -0.029089733958244324, -0.009404951706528664, -0.017292534932494164, 0.025111768394708633, -0.024811027571558952, 0.06638146191835403, -0.0252621378749609, -0.018645863980054855, -0.026847856119275093, 0.043880660086870193, -0.023922478780150414, 0.002115430776029825, -0.003074038540944457, -0.017019135877490044, -0.029144413769245148, 0.015966545790433884, -0.014203117229044437, -0.039314884692430496, -0.019233673810958862, -0.00013563191168941557, 0.0014379118802025914, 0.005741395056247711, -0.024893049150705338, -0.0009594623115845025, 0.0019633520860224962, 0.014722577296197414, -0.02930845506489277, 0.02073737233877182, 0.010348181240260601, -0.019370373338460922, -0.04716145992279053, 0.043470561504364014, 0.020340941846370697, -0.019370373338460922, 0.022719521075487137, -0.0037934216670691967, -0.007456978317350149, -0.026437757536768913, -0.017347214743494987, 0.023813119158148766, -0.022022351622581482, 0.04117400571703911, -0.006455651950091124, 0.03015599399805069, -0.018686873838305473, 0.009801381267607212, -0.00046050772652961314, -0.03671758994460106, 0.010430200956761837, -0.002768172649666667, 0.041283365339040756, 0.00670512905344367, 0.03980700671672821, 0.027039237320423126, 0.03198777139186859, 0.022049691528081894, -0.031468313187360764, -0.024059178307652473, 0.028734315186738968, 0.012972818687558174, -0.012432854622602463, -0.022514469921588898, -0.0010577153880149126, 0.027175936847925186, -0.034421030431985855, 0.0011704927310347557, 0.022350430488586426, -0.028953034430742264, 0.0006741012912243605, -0.057031191885471344, -0.049211956560611725, 0.014654227532446384, 0.01287029404193163, 0.051180437207221985, -0.008140478283166885, 0.00467513594776392, -0.0015583786880597472, -0.020696362480521202, 0.0023341504856944084, 0.014052747748792171, -0.03529591113328934, -0.018399804830551147, -0.017729975283145905, -0.01906963251531124, 0.04188484326004982, -0.017729975283145905, -0.06747505813837051, -0.004114666488021612, 0.04218558222055435, -0.0322338305413723, -0.02325264923274517, -0.024195879697799683, -0.027627045288681984, -0.030538752675056458, 0.03578802943229675, 0.027080247178673744, -0.02032727189362049, -0.012097939848899841, 0.015884526073932648, -0.013909213244915009, 0.02434624917805195, -0.018755223602056503, 0.005645704921334982, 0.015023317188024521, 0.004733233246952295, 0.0173745546489954, -0.0338468924164772, -0.045849140733480453, -0.01535139698535204, -0.016636375337839127, 0.00045153679093346, 0.003625964280217886, -0.01555644627660513, -0.04959471523761749, 0.010553230531513691, 0.021161140874028206, -0.013075343333184719, 0.010279831476509571, -0.003995053935796022, 0.0010594241321086884, -0.03969764709472656, -0.006264272145926952, 0.026779506355524063, -0.013300898484885693, -0.007108393590897322, -0.008673607371747494, -0.008256672881543636, 0.0017283990746363997, -0.010491715744137764, -0.03196043148636818, 0.02985525317490101, 0.052137333899736404, 0.014326147735118866, 0.03983434662222862, 0.024113858118653297, 0.009548487141728401, -0.027996135875582695, -0.0361161082983017, 0.0127472635358572, -0.0038549366872757673, 0.0064966618083417416, 0.02270585112273693, -0.02213171124458313, -0.0005540617275983095, -0.010245655663311481, -0.011687839403748512, 0.011188885197043419, 0.009808216243982315, 0.008318187668919563, -0.006418059580028057, 0.015337727032601833, -0.015747826546430588, -0.028242195025086403, 0.0067734792828559875, -0.005748230032622814, 0.010730940848588943, 0.010375521145761013, -0.02295191027224064, -0.006978529039770365, -0.014435507357120514, 0.014230458065867424, 0.030374713242053986, 0.009493806399405003, 0.004381231032311916, 0.02338934876024723, -0.01819475367665291, 0.008338692598044872, -0.004049734212458134, -0.0027989300433546305, 0.01161265466362238, -0.06085878610610962, -0.02250079996883869, -0.029554514214396477, -0.038467347621917725, -0.02165326103568077, -0.003125301096588373, -0.04423608258366585, -0.01659536547958851, 0.011797199957072735, -0.015132676810026169, -0.03144097328186035, -0.006619691848754883, 0.019397713243961334, -0.014285137876868248, -0.10875842720270157, -0.027490345761179924, 0.045603081583976746, 0.02889835461974144, 0.03220649063587189, -0.026642806828022003, 0.007525328546762466, -0.009404951706528664, -0.012337164022028446, -0.042076222598552704, -0.003241495927795768, -0.03319073095917702, 0.0018471571383997798, 0.007060548756271601, 0.02355339005589485, -0.03625280782580376, -0.010587405413389206, -0.03212447091937065, 0.007730378303676844, -0.009828721173107624, 0.00350635196082294, 0.01785300485789776, -0.013847697526216507, 0.04076390340924263, -0.022254740819334984, 0.02137986198067665, 5.195663470658474e-05, 0.029499834403395653, -0.013464937917888165, 0.0074843186885118484, -0.020422961562871933, -0.017251525074243546, 0.012487534433603287, 0.03313605114817619, -0.030648114159703255, 0.027039237320423126, -0.00861892756074667, -0.02492038905620575, -0.027476675808429718, 0.005358635447919369, 0.006595769431442022, -0.02917175553739071, 0.0766066163778305, 0.008892327547073364, 0.033436790108680725, -0.037346407771110535, 0.008639432489871979, -0.015378736890852451, 0.03174171224236488, -0.03354614973068237, 0.004080491606146097, 0.02444193884730339, 0.00883764773607254, -0.017210515215992928, 0.010833465494215488, 0.01712849549949169, -0.004640961065888405, 0.017142165452241898, 0.029281115159392357, 0.02958185411989689, -0.023238979279994965, -0.01249436940997839, 0.040845923125743866, -0.02029993198812008, -0.03813926503062248, -0.02066902257502079, -0.0031423885375261307, 0.01036868616938591, -0.01666371524333954, -0.024291569367051125, -0.015857186168432236, 0.01584351621568203, -0.02281521074473858, 0.029827913269400597, 0.0068896738812327385, 0.0010329384822398424, -0.001281561329960823, 0.03340945020318031, -0.036498866975307465, 0.011516964994370937, 0.01719684526324272, -0.06003858894109726, 0.0033969921059906483, 0.0048562632873654366, -0.008386537432670593, 0.018304113298654556, 0.004285541363060474, 0.028871014714241028, -0.028542935848236084, 0.055773552507162094, 0.05178191512823105, -0.005310790613293648, 0.020901411771774292, -0.023143289610743523, 0.01747024431824684, -0.01689610444009304, -0.02651977725327015, 0.012248309329152107, 0.03250723332166672, -0.012159454636275768, 0.026943545788526535, 0.04316982254385948, -0.018071724101901054, -0.012740428559482098, 0.02016323246061802, 0.02574058808386326, -0.011482790112495422, 0.013656318187713623, 0.010621581226587296, -0.007361288648098707, 0.011646829545497894, 0.012419184669852257, -0.044345442205667496, 0.005314208101481199, -0.006055804900825024, 0.02382678911089897, 0.05470729246735573, 0.03228851035237312, 0.02580893784761429, 0.006045552436262369, 0.012877129018306732, 0.007737213280051947, -0.02692987583577633, 0.000942374812439084, -0.017688965424895287, -0.01792135462164879, 0.03001929447054863, 0.02270585112273693, -0.021885650232434273, -0.029390474781394005, 0.02461964823305607, -0.00736812362447381, 0.031550332903862, -0.00030116693233139813, -0.028105495497584343, 0.030784813687205315, 0.01604856550693512, 0.008044787682592869, -0.03573334962129593, 0.03319073095917702, 0.007142568938434124, 0.004934865515679121, 0.03696364909410477, 0.016089575365185738, 0.014011737890541553, -0.012453359551727772, 0.010853970423340797, -0.04871983826160431, 0.0074706487357616425, 0.015583786182105541, 0.02590462751686573, -0.0004660611448343843, 0.0008253255509771407, 0.006247184704989195, -0.0008313061553053558, 0.0051535856910049915, 0.007846573367714882, -0.02818751521408558, -0.026260046288371086, 0.02155757136642933, -0.002029993338510394, 0.05905434861779213, -0.018823573365807533, -0.001494300551712513, 0.009958586655557156, -0.011633159592747688, 0.0017096028896048665, 0.0029578437097370625, -0.03242521360516548, 0.02322530932724476, -0.02345770038664341, -0.06162430718541145, 0.028433574363589287, 0.02288356050848961, -0.009903906844556332, 0.025986647233366966, -0.006189086940139532, 0.020081212744116783, -0.0010935990139842033, 0.03425699099898338, 0.02036828175187111, 0.01747024431824684, -0.02947249449789524, 0.014039077796041965, 0.04440012201666832, -0.02610967680811882, -0.006089979782700539, -0.005259527824819088, 0.00606947485357523, 0.030511412769556046, 0.01666371524333954, 0.023143289610743523, -0.010067946277558804, 0.05273881554603577, 0.006117319688200951, -0.017907684668898582, -0.01924734376370907, 0.03157767280936241, -0.013314568437635899, -0.04759889841079712, -0.08918300271034241, 0.03934222459793091, -0.0035097694490104914, -0.009056366980075836, -0.01876889355480671, 0.004640961065888405, -0.04609519988298416, -0.010819795541465282, -0.004873350728303194, 0.01438082754611969, 0.0010935990139842033, -0.022186391055583954, -0.018714213743805885, 0.04399002343416214, 0.005467995069921017, -0.05571887269616127, 0.0024776854552328587, 0.002908289898186922, -0.03895946592092514, -0.020887741819024086, -0.03354614973068237, -0.027955126017332077, -0.017798325046896935, 0.012651573866605759, 0.0055260928347706795, 0.024250559508800507, 0.0024520540609955788, 0.01812640391290188, -0.006981946527957916, -0.006739303935319185, 0.011619489639997482, -0.0005151876830495894, -0.010375521145761013, -0.006100232247263193, -0.01870054379105568, 0.0034243320114910603, 0.0010013266000896692, -0.023703759536147118, 0.0020556244999170303, -0.010553230531513691, 0.015447086654603481, -0.003684061812236905, -0.0031287185847759247, -0.0030774560291320086, 0.010211480781435966, -0.03953360393643379, 0.01876889355480671, 0.04059986397624016, -0.039588283747434616, -0.018208423629403114, -0.007668863516300917, 0.029253775253891945, 0.025439847260713577, -0.0326986126601696, 0.018987612798810005, 0.015064327046275139, 0.027968795970082283, 0.057468630373477936, 0.03409295156598091, 0.011434945277869701, -0.015542776323854923, 0.0026571040507405996, -0.01792135462164879, 0.006660701707005501, 0.00875562708824873, -0.038740746676921844, 0.0094869714230299, 0.019602762535214424, -0.006732468958944082, -0.0026451426092535257, -0.0390961654484272, -0.00046819710405543447, 0.01181086990982294, 0.03947892412543297, 0.012508039362728596, -0.012296154163777828, 0.003557614516466856, -0.009651011787354946, 0.00883764773607254, 0.013492277823388577, -0.03737374767661095, 0.0013823775807395577, -0.03781118616461754, -0.006653866730630398, 0.01529671624302864, 0.009439126588404179, 0.007053713779896498, -0.004757155664265156, 0.006852081511169672, -0.011503295041620731, 0.040408484637737274, 0.03617078810930252, -0.0018676621839404106, 0.010997505858540535, -0.013492277823388577, -0.015077996999025345, 0.003817344084382057, 0.006455651950091124, 0.015679476782679558, -0.004702475853264332, 0.012514874339103699, 0.02284255065023899, -0.009370776824653149, 0.004681970924139023, 0.008502732962369919, 0.0028501925989985466, 0.0006296738283708692, 0.0033354770857840776, -0.0254945270717144, -0.012952313758432865, -0.02318429946899414, 0.001002180972136557, 0.006694876588881016, 0.022459790110588074, 0.029663873836398125, -0.010847135446965694, 0.009521146304905415, -0.005929357372224331, 0.007996942847967148, -0.006482991855591536, -0.008673607371747494, -0.030948853120207787, 0.02448294870555401, -0.005635452456772327, -0.03494048863649368, -0.011072690598666668, 0.010184140875935555, 0.0017113116336986423, 0.008420712314546108, 0.0179486945271492, 0.010771950706839561, 0.03488580882549286, -0.009104211814701557, -0.011223060078918934, -0.019575422629714012, -0.009186232462525368, -0.013307733461260796, -0.02457863837480545, -0.02403183840215206, -0.013594803400337696, 0.04248632490634918, -0.0036293817684054375, 0.006250602193176746, -0.00767569849267602, -0.005016885697841644, 0.0029971448238939047, 0.0029510087333619595, 0.0037934216670691967, 0.009145221672952175, -0.03947892412543297, 0.06660018116235733, 0.00148746557533741, -0.021106461063027382, 0.004025811329483986, -0.04087326303124428, 0.010594240389764309, -0.013642648234963417, -0.00320048606954515, -0.03879542648792267, 0.01669105514883995, 0.000684353755787015, 0.02702556736767292, -0.019698452204465866, -0.004623873624950647, 0.034147631376981735, -0.011633159592747688, -0.014230458065867424, 0.008871822617948055, 0.016403986141085625, 0.01305483840405941, 0.009220407344400883, 0.033300090581178665, -0.020354611799120903, 0.0027647551614791155, -0.019370373338460922, -0.006233514752238989, -0.021147470921278, 0.01444917730987072, 9.606370440451428e-05, 0.022323090583086014, -0.008236167952418327, -0.00011544732114998624, -0.04524765908718109, 0.01487294677644968, -0.014271467924118042, 0.013198373839259148, -0.05724991112947464, 0.02318429946899414, -0.006626526825129986, 0.010765115730464458, 0.016773074865341187, -0.021038111299276352, -0.010648921132087708, -0.003340603318065405, -0.010259326547384262, 0.028925694525241852, -0.005013468209654093, -0.005919104907661676, 0.026506107300519943, 0.03535059094429016, 0.0016344179166480899, 0.0064966618083417416, 0.0011628033826127648, 0.004251366481184959, 0.005696967709809542, -0.03310871124267578, -0.011120535433292389, 0.04524765908718109, 0.0038275967817753553, 0.008270342834293842, -0.03857670724391937, 0.01845448464155197, -0.026560787111520767, 0.028570275753736496, 0.011674169450998306, -0.02985525317490101, -0.0014028825098648667, 0.014039077796041965, 0.014148437418043613, 0.03871340677142143, -0.00866677239537239, -0.009555322118103504, -0.015816176310181618, 0.022213730961084366, 0.021297842264175415, 0.005758482497185469, -0.0048699332401156425, 0.028570275753736496, -0.0068691689521074295, 0.038740746676921844, 0.0011978327529504895, 0.013861368410289288, -0.013902378268539906, 0.00046776991803199053, 0.010847135446965694, 0.02784576639533043, 0.007340783718973398, -0.00330642843618989, -0.021612251177430153, 0.019466063007712364, -0.034967828541994095, 0.007894418202340603, 0.026970885694026947, 0.0025255302898585796, 0.0005066439625807106, -0.0193156935274601, 0.016034895554184914, -0.011147875338792801, 0.014462847262620926, 0.004733233246952295, -0.01371783297508955, -0.02654711715877056, 0.03431167080998421, 0.0028792412485927343, -0.026082336902618408, 0.01900128275156021, -0.04541170224547386, -0.007463813293725252, 0.028460916131734848, 0.03127693384885788, -0.009459631517529488, -0.014134767465293407, 0.030812153592705727, 0.0007668008911423385, 0.01276776846498251, 0.011510130017995834, -0.03767448663711548, 0.027353646233677864, 0.004763990640640259, -0.043497901409864426, 0.004798165988177061, -0.02594563737511635, 0.009746701456606388, 0.009965421631932259, -0.00014193292008712888, -0.006527419202029705, -0.007169908843934536, -0.0028519013430923223, 0.0012627651449292898, -0.010225150734186172, -0.01621260680258274, -0.004384648520499468, 0.008960677310824394, 0.006845246534794569, 0.026506107300519943, 0.008632597513496876, -0.010956495068967342, -0.019384043291211128, -0.02066902257502079, 0.017798325046896935, 0.015597456134855747, 0.0012251726584509015, 0.0010508802952244878, 0.015406076796352863, -0.00941862165927887, -0.011557974852621555, -0.0005258673336356878, 0.002019740641117096, 0.023881468921899796, -0.011722015216946602, -0.008031117729842663, -0.012931808829307556, -0.017634283751249313, 0.01140760537236929, 0.003790004178881645, 0.014298807829618454, -0.014421837404370308, -0.03206979110836983, 0.012501204386353493, 0.014845606870949268, 0.008864987641572952, -0.01785300485789776, -0.00919306743890047, -0.0031765634194016457, 0.03494048863649368, 0.013656318187713623, -0.012282484211027622, 0.004234279040247202, 0.00026336085284128785, -0.013335073366761208, 0.009227242320775986, 0.013601638376712799, -0.004528183490037918, -0.02971855364739895, 0.006575264502316713, -0.02805081568658352, -0.029417814686894417, -0.005898599978536367, -0.00994491670280695, -0.00463070860132575, -0.018249433487653732, -0.028515595942735672, 0.04409938305616379, -0.016376646235585213, -0.027818426489830017, -0.005081817973405123, 0.0005429548327811062, 0.028406234458088875, -0.009678351692855358, 0.017634283751249313, 0.015214696526527405, -0.012104774825274944, -0.027476675808429718, -0.012959148734807968, 0.0052424403838813305, 0.02338934876024723, 0.004268453922122717, 0.023922478780150414, -0.00547483004629612, 0.013082178309559822, -0.02318429946899414, -0.011489625088870525, 0.010573735460639, 0.005915687419474125, -0.00022769073257222772, 0.004839175846427679, -0.00764835812151432, -0.01788034476339817, -0.006691459100693464, 0.009172561578452587, 0.014189447276294231, -0.00689309136942029, 0.004579445812851191, 0.013464937917888165, 0.004261618945747614, -0.01808539405465126, 0.0010662591084837914, -0.004261618945747614, -0.02162592113018036, -0.018618524074554443, -0.009856061078608036, 0.022938240319490433, 0.012002249248325825, 0.006175416987389326, -0.02665647678077221, 0.04262302443385124, 0.007908088155090809, -0.018809903413057327, -0.010935990139842033, 0.022897230461239815, 0.03327275067567825, -0.04087326303124428, -0.01703280583024025, 0.0169234462082386, 0.0013900669291615486, -0.011065855622291565, 0.01159214973449707, 0.005095487926155329, -0.0052834502421319485, 0.024906719103455544, -0.03206979110836983, 0.022432450205087662, 0.003704566741362214, 0.022241070866584778, -0.016034895554184914, 0.06709229946136475, 0.01744290441274643, 0.007723543327301741, -0.031358953565359116, 0.01140760537236929, 0.02151656150817871, 0.028105495497584343, -0.004398318473249674, -0.03237053006887436, 0.023922478780150414, -0.05232871323823929, -0.0010218316456303, -0.031030872836709023, 0.00941862165927887, 0.042513664811849594, -0.02297925017774105, -0.009370776824653149, 0.006260854657739401, 0.022118041291832924, 0.0038275967817753553, 0.020710032433271408, -0.01207059994339943, 0.02025892212986946, 0.0034619243815541267, -0.03059343248605728, 0.010361851193010807, 0.011127370409667492, -0.01604856550693512, -0.029062394052743912, 0.009876566007733345, 0.02576792798936367, 0.025303147733211517, -0.008475393056869507, 0.01975313201546669, -0.02240511029958725, 0.03600674867630005, -0.021776290610432625, -0.02338934876024723, -0.0001261269935639575, -0.0028177262283861637, -0.016171595081686974, -0.017866674810647964, 0.004688805900514126, 0.006691459100693464, 0.03174171224236488, -0.01829044334590435, -0.01879623346030712, 0.02791411615908146, -0.0290350541472435, -0.015966545790433884, -0.007614183239638805, -0.0013200081884860992, -0.03083949349820614, -0.010970165021717548, 0.03042939305305481, -0.0233209989964962, -0.02213171124458313, 0.017593273892998695, 0.0051399157382547855, 0.02066902257502079, 0.05528143048286438, -0.009821886196732521, 0.04232228174805641, -0.002329024253413081, 0.009828721173107624, 0.008160983212292194, 0.018167413771152496, -0.008434382267296314, 0.0039198691956698895, -0.02441459894180298, 0.01019781082868576, 0.005348382983356714, 0.004569193348288536, -0.02375843934714794, 0.028843674808740616, -0.012603729031980038, 0.018372464925050735, -0.006988781504333019, 0.029527174308896065, 0.05038757622241974, -0.010669426061213017, -0.002723745070397854, -0.01225514430552721, -0.004750320687890053, 0.00455552339553833, 0.00543040269985795, -0.010409696027636528, -0.00800377782434225, 0.0195480827242136, -0.00885815266519785, -0.005604695063084364, 0.02053232304751873, 0.012173124589025974, 0.05517207086086273, -0.02019057236611843, 0.004729815758764744, 0.006629944313317537, -0.02515277825295925, -0.01645866595208645, -0.021871980279684067, -0.005778987426310778, -0.005115992855280638, 0.014818266965448856, -0.018509164452552795, 0.010252490639686584, 0.03237053006887436, 0.011503295041620731, -0.010102121159434319, -0.005331295542418957, 0.002185489283874631, 0.009404951706528664, 0.003219282254576683, -0.02025892212986946, -0.03729172796010971, 0.01764795556664467, -0.02679317630827427, -0.005990872159600258, 0.03660822659730911, 0.023717429488897324, 0.035104528069496155, 0.001679699751548469, -0.015952875837683678, -0.011311914771795273, -0.009152056649327278, -0.03086683340370655, -0.007210918702185154, 0.041966862976551056, 0.006934101693332195, 0.009979091584682465, -0.03835798799991608, -0.018208423629403114, -0.01591186597943306, -0.029117073863744736, -0.021147470921278, -0.010088451206684113, 0.030210673809051514, -0.036088768392801285, 0.01541974674910307, -0.025658568367362022, 0.018809903413057327, 0.01079245563596487, -0.014695237390697002, 0.0035029344726353884, 0.0011499878019094467]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" et al. (2022);
Phan et al. (2023); Hu et al. (2023) for further examples and
discussion of probabilistic inference in language models.
Twisted Sequential Monte Carlo in Language Models
In this work, we leverage tools from (twisted) Sequen-
tial Monte Carlo ( SMC ) (Doucet et al., 2001; Del Moral
et al., 2006; Briers et al., 2010; Chopin et al., 2020)
to perform and evaluate inference in the language mod-
eling setting (Sec. 3). A particular challenge in sam-
pling from Eq. (1) is that the target distribution σ(s1:T)
is non-causal. In order to sample tokens sequentially,
1arXiv:2404.17546v1  [cs.LG]  26 Apr 2024
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
one needs to infer the marginal distribution σ(s1:t) =P
st+1:Tσ(s1:T)∝P
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T), which
involves an intractable marginalization. To address this
problem, we propose to learn twist functions ψt(s1:t)which
modulate the base model such that p0(s1:t)ψt(s1:t)matches
the target marginals σ(s1:t), up to normalization. The twist
functions can be used to focus each step of language model
generation on promising partial sequences.
Evaluating Inference in Language Modeling Sampling
from the target distribution is closely intertwined with
bounding the log partition function. Similarly to variational
inference or traditional RLHF objectives (Korbak et al.,
2022b), SMC algorithms yield lower bounds on logZσ,
where tighter bounds typically coincide with more accu-
rate target sampling. However, upper bounds may often be
obtained when an exact target sample is available (Grosse
et al., 2015; 2016; Brekelmans et al., 2022). The difference
between upper and lower bounds on logZσin fact yields an
upper bound on the symmetrized KL divergence between
inference samples and the target distribution (Grosse et al.,
2016). For these reasons, we argue in Sec. 5 that log par-
tition function estimates are a powerful tool for evaluating
language model inference techniques.
Contributions Our probabilistic inference perspective
leads to the following contributions:
•Twisted Sequential Monte Carlo for Language Model-
ing: We view twisted SMC as a general framework for
sampling and evaluation of language models. While
twisted SMC is well-known and Lew et al. (2023)
consider SMC with fixed, few-step-ahead target infor-
mation in the language modeling setting, we propose
tolearn intermediate twist functions for target distribu-
tions defined by terminal potential only.
•Contrastive Twist Learning : We develop probabilis-
tic methods for learning intermediate twist functions,
presenting a novel contrastive twist learning (CTL )
method inspired by energy-based modeling and den-
sity ratio estimation in Sec. 4.1. Further, we adapt
existing twisted SMC methods (Lawson et al., 2018;
2022; Lioutas et al., 2022) to the language modeling
setting, and highlight connections with inference tech-
niques inspired by (soft) reinforcement learning ( RL).
•Evaluating Inference in Language Models : Finally,
we demonstrate that twisted SMC provides a rich set
of tools for evaluating language model fine-tuning
or controlled generation techniques. We propose a
novel SMC upper bound on logZσwhich is applica-
ble when an exact target sample is available and may
be of independent interest. We leverage these bounds
to evaluate the quality of inference by measuring the
KL divergence to the target σ(s1:T)inboth directions,which can be used to diagnose mode-dropping behav-
ior of methods such as proximal policy optimization
(PPO ) (Schulman et al., 2017) which optimize a mode-
seeking divergence.
We proceed to describe background on importance sampling
andSMC in Sec. 2, before presenting our framework for
twisted SMC in the language modeling setting in Sec. 3. We
propose methods to learn the twist functions in Sec. 4 and
methods to evaluate inference in Sec. 5. Our experimental
results in Sec. 7 showcase the ability of twisted SMC to im-
prove controlled generation and lend insights into inference
quality in existing methods.
2. Background
Suppose","[0.006368258036673069, -0.004789647646248341, 0.013155086897313595, 0.017161408439278603, -0.015857858583331108, 0.02819972299039364, 0.017544101923704147, -0.00455644354224205, -0.05190279707312584, 0.011731945909559727, 0.047477904707193375, -0.02067740447819233, -0.02184940315783024, 0.03343784064054489, 0.009932090528309345, -0.042359378188848495, 0.013406229205429554, 0.006380217149853706, 0.0029255119152367115, 0.027769193053245544, -0.02058173157274723, 0.00541451433673501, -0.0330551452934742, 0.034274980425834656, 0.007271175272762775, -0.028438905254006386, 0.0071336450055241585, 0.008807928301393986, 0.024085767567157745, -0.007002093829214573, 0.026190582662820816, -0.015905695036053658, -0.051520105451345444, -0.02595139853656292, -0.02764960005879402, 0.05912613496184349, 0.006380217149853706, -0.01151668094098568, 0.0009589759283699095, 0.0329594723880291, -0.008054501377046108, -0.021741770207881927, -0.020976383239030838, 0.04683211073279381, 0.003701362991705537, 0.06998506188392639, 0.032481104135513306, -0.02693205140531063, -0.016467776149511337, 0.046305906027555466, -0.019158590584993362, 0.008849785663187504, -0.019206427037715912, -0.03154829144477844, -0.0038060059305280447, -0.01852475479245186, 0.0033067103940993547, 0.006093197036534548, 0.012939821928739548, -0.0404219925403595, 0.019971814006567, -0.04656900838017464, -0.0039016790688037872, 0.024588054046034813, -0.04350746050477028, -0.02702772431075573, -0.005593901500105858, 0.012305986136198044, -0.047788843512535095, 0.0172570813447237, -0.014267290011048317, 0.008867724798619747, 0.01781916245818138, 0.01328663807362318, -0.04534917324781418, 0.020605649799108505, -0.011450905352830887, 0.056638628244400024, 0.0013910009292885661, -0.015224023722112179, 0.015786103904247284, -0.02170589379966259, 0.01889548823237419, -0.009740743786096573, -0.03669073432683945, -0.01292786281555891, -0.015546920709311962, 0.013872637413442135, -0.026645030826330185, -0.015427329577505589, -0.017376674339175224, 0.030519802123308182, -0.017436468973755836, -0.003022680291905999, 0.07558195292949677, -0.008054501377046108, -0.008162133395671844, -0.02712339721620083, 0.04058942198753357, 0.011785762384533882, 0.012018965557217598, 0.0011159400455653667, 0.02528168447315693, -0.03317473828792572, 0.06218768283724785, -0.006422074045985937, -0.003518985817208886, 0.0008879683446139097, -0.043124765157699585, -0.009352071210741997, -0.008730193600058556, -0.00749839935451746, -0.04754966124892235, 0.029682660475373268, -0.00467005604878068, -0.030089272186160088, -0.019696753472089767, 0.0050886268727481365, 0.0033724859822541475, -0.004335199017077684, -0.017795244231820107, 0.005348738748580217, 0.02164609730243683, 0.018799815326929092, 0.04068509489297867, -0.013753045350313187, 0.009686927311122417, -0.05993935838341713, 0.001031478401273489, 0.055060017853975296, -0.007552215829491615, 0.024384748190641403, -0.020665446296334267, -0.004490668419748545, -0.014638024382293224, -0.016778714954853058, -0.009023193269968033, 0.01208474114537239, -0.00525904493406415, 0.017699571326375008, -0.010852946899831295, -0.012640842236578465, 0.0022333748638629913, -0.009932090528309345, -0.018799815326929092, -0.049176108092069626, -0.03133302554488182, 0.004096015822142363, -0.0038956995122134686, 0.02309315651655197, -0.01374108623713255, -0.04070901498198509, -0.03726477175951004, 0.04477513208985329, -0.029036864638328552, -0.04618631303310394, -0.056542955338954926, 0.05195063352584839, 0.031715717166662216, -0.036977753043174744, -0.0016144879627972841, 0.06984154880046844, 0.0038687915075570345, 0.0025084358640015125, 0.0024292063899338245, -0.004122923593968153, -0.031237352639436722, 0.04441635683178902, -0.021586300805211067, -0.04061334207653999, -0.0009664504323154688, -0.018955284729599953, -0.035399142652750015, -0.04941529035568237, 0.028534580022096634, -0.04807586222887039, -0.002607099013403058, -0.09648658335208893, 0.008251827210187912, -0.020151201635599136, -0.04795627295970917, 0.062379028648138046, -0.04776492342352867, -0.0011757358442991972, 3.8937374483793974e-05, 0.016647163778543472, -0.022818095982074738, 0.03214624896645546, 0.03150045499205589, 0.019385814666748047, -0.010864906013011932, 0.046090640127658844, 0.07950456440448761, 0.026070989668369293, -0.01423141174018383, 0.02001965045928955, 0.06754539161920547, 0.05166361480951309, -0.00898133683949709, -0.027003806084394455, 0.022399526089429855, 0.01409986149519682, -0.05171145126223564, -0.05391193926334381, 0.002000171225517988, 0.009465683251619339, 0.0021616199519485235, 0.013717168010771275, -0.0454687625169754, 0.0011705037904903293, -0.014972880482673645, -0.023691115900874138, 0.06395763903856277, 0.009304233826696873, -0.046305906027555466, 0.02774527482688427, -0.044153254479169846, -0.00664331903681159, 0.0031841290183365345, 0.04673643782734871, 0.022303851321339607, 0.011749884113669395, 0.036834243685007095, 0.02580788917839527, -0.018847651779651642, 0.027530008926987648, 0.006762910634279251, -0.01236578170210123, 0.04848247393965721, -0.012999617494642735, 0.06974587589502335, 0.013370351865887642, -0.005288942717015743, -0.04145048186182976, -0.0013244780711829662, 0.0039016790688037872, 0.005411524325609207, 0.023631319403648376, -0.027817029505968094, -0.07586897164583206, 0.0182257741689682, 0.002509930869564414, 0.03814975172281265, 0.0020689363591372967, 0.03896297514438629, 0.036977753043174744, -0.016934184357523918, -0.0018731049494817853, 0.03341392055153847, 0.023571524769067764, -0.0006196344620548189, -0.043818399310112, -0.029969679191708565, 0.010332723148167133, -0.013920473866164684, 0.009513519704341888, -0.01297569926828146, 0.008957418613135815, -0.022638708353042603, 0.0073309713043272495, 0.006428053602576256, -0.025353441014885902, -0.05620810016989708, 0.026429764926433563, -0.030639393255114555, -0.03559048846364021, -0.036260202527046204, 0.004819545429199934, 0.0510895736515522, -0.05549054965376854, -0.0011443430557847023, -0.0033724859822541475, -0.015367533080279827, 0.026549357920885086, 0.0013984753750264645, -0.06228335574269295, 0.029012946411967278, 0.026070989668369293, -0.023152953013777733, 0.03604493662714958, -0.0015741257229819894, -0.02958698570728302, 0.023332340642809868, -0.015092472545802593, -0.014339044690132141, 0.01308333221822977, 0.015224023722112179, -0.017855040729045868, -0.01277239341288805, -0.06429249793291092, 0.008867724798619747, 0.017568020150065422, -0.014267290011048317, -0.0018013499211519957, 0.016599327325820923, 0.02031862922012806, 0.016288388520479202, 0.005169351119548082, -0.004876351449638605, 0.015056595206260681, 0.054485976696014404, -0.008532867766916752, -0.00676889019086957, 0.001198159297928214, 0.02395421639084816, 0.022961605340242386, 0.004738821182399988, 0.025449113920331, -0.007797378581017256, 0.017316877841949463, -0.018094224855303764, -0.015343614853918552, -0.03106992319226265, 0.014877207577228546, 0.008795969188213348, -0.007008073385804892, 0.04377056285738945, -0.026645030826330185, 0.027960538864135742, -0.02693205140531063, -0.05314655229449272, 0.03963268920779228, -0.004858412779867649, -0.012712597846984863, -0.013681290671229362, -0.01622859388589859, -0.022758299484848976, -0.02585572563111782, -0.024611972272396088, 0.014626064337790012, 0.015451247803866863, 0.023607401177287102, 0.02922821044921875, 0.037814896553754807, -0.004341178573668003, -0.06051339954137802, -0.037862733006477356, 0.05616025999188423, -0.02343997359275818, 0.032074492424726486, -0.09447744488716125, 0.013585616834461689, -0.0003342961717862636, -0.03824542462825775, -0.00844915397465229, 0.006451972294598818, -0.0022184259723871946, 0.047382231801748276, 0.06874130666255951, -0.004963055718690157, 0.024611972272396088, -0.035040367394685745, 0.04293341934680939, -0.0013371846871450543, 0.000181069306563586, 0.03255286067724228, -0.01986418105661869, -0.0053846160881221294, -0.008084398694336414, -0.023607401177287102, -0.04073293134570122, 0.010757273063063622, 0.005543075036257505, 0.01878785528242588, 0.011737925000488758, 0.022901810705661774, -0.02841498702764511, 0.015188145451247692, -0.002559262327849865, 0.016348185017704964, 0.0009985907236114144, 0.019876141101121902, 0.0022453342098742723, 0.024898990988731384, -0.022411484271287918, 0.004789647646248341, -0.014709779061377048, -0.0047119129449129105, 0.03936958685517311, 0.028343232348561287, 0.014733697287738323, 0.004275403451174498, 0.008784010075032711, -0.015331655740737915, -0.007755521684885025, 0.01627643033862114, -0.000991863664239645, -0.021741770207881927, -0.014937003143131733, 0.025401277467608452, -0.0028806650079786777, 0.005154401995241642, -0.029323885217308998, 0.03169180080294609, -0.002654935698956251, -0.0001724736503092572, -0.02523384802043438, 0.02774527482688427, 0.05180712416768074, 0.01409986149519682, -0.03020886331796646, -0.019062917679548264, -0.042718153446912766, -0.01868022419512272, -0.0402306467294693, 0.03367702290415764, 0.03200273960828781, 0.027936620637774467, 0.021430833265185356, 0.046401578933000565, 0.04453594982624054, -0.07438603788614273, 0.006978175602853298, 0.0057433913461863995, 0.019648917019367218, -0.061709318310022354, 0.032576777040958405, 0.023667197674512863, 0.08462308347225189, 0.0799829289317131, 0.014374922029674053, -0.055107854306697845, 0.035183876752853394, 0.00039353143074549735, 0.016862429678440094, -0.01874001882970333, 0.03666681423783302, -0.025568705052137375, 0.03506428748369217, -0.038723792880773544, -0.00403024023398757, 0.024755481630563736, 0.032983388751745224, -0.01638406328856945, -0.025736134499311447, -0.026692867279052734, 0.039345670491456985, 0.011552558280527592, -0.006822706200182438, -0.07189852744340897, -0.009160724468529224, -0.0002896361402235925, -0.05013284087181091, -0.006212788634002209, 0.007910991087555885, 0.02846282348036766, -0.02891727350652218, -0.024588054046034813, 0.028893355280160904, -0.03250502422451973, 0.027864865958690643, 0.0020569772459566593, 0.05018067732453346, -0.004598300904035568, 0.02256695367395878, -0.03362918645143509, 0.06448384374380112, -0.02949131280183792, 0.04439244046807289, -0.035805754363536835, 0.027960538864135742, 0.017065735533833504, -0.018931366503238678, -0.021945076063275337, 0.020139241591095924, 0.039489179849624634, 0.03159612789750099, -0.010775212198495865, -0.0009148765238933265, 0.029754415154457092, 0.016778714954853058, -0.030161026865243912, 0.0008363944361917675, -0.012437536381185055, -0.01499679870903492, -0.014853289350867271, 0.04656900838017464, -0.0653449073433876, 0.011743905022740364, -0.005471320357173681, 0.028032293543219566, -0.006096187047660351, 0.03097425028681755, 0.0549643449485302, -0.01632426679134369, 0.03066331148147583, 0.010069620795547962, 0.011295435950160027, 0.01520010456442833, 0.023966176435351372, -0.04008713737130165, -0.05156794190406799, 0.022411484271287918, -0.010846966877579689, 0.05195063352584839, -0.031189514324069023, 0.010069620795547962, 0.00837141927331686, -0.015176186338067055, -0.027912702411413193, 0.03439457342028618, 0.027817029505968094, 0.010793150402605534, 0.05319438874721527, 0.02067740447819233, 0.05563405901193619, 0.03413147106766701, -0.0034442408941686153, 0.006750951521098614, 0.04257464408874512, -0.00834152102470398, 0.006661257706582546, -0.003695383435115218, 0.013143127784132957, 0.022865932434797287, 0.01781916245818138, -0.03336608409881592, -0.01571434922516346, 0.017077693715691566, 0.0018237733747810125, 0.03197881951928139, -0.019971814006567, -0.027458254247903824, -0.023966176435351372, 0.03707342594861984, -0.006224747747182846, -0.0006678448989987373, -0.08739761263132095, -0.03367702290415764, -0.04807586222887039, 0.027553927153348923, -0.009531458839774132, 0.01000384520739317, 0.0010912742000073195, -0.036738570779561996, 0.01530773751437664, -0.03542306274175644, -0.02256695367395878, -0.027051642537117004, 0.007073848973959684, 0.005483279470354319, -0.001654850086197257, -0.01802246831357479, 0.01075129397213459, -0.0012631872668862343, -0.0056028710678219795, -0.004995943047106266, -0.02104813978075981, -0.006018452346324921, 0.019995732232928276, 0.021968994289636612, -0.025664377957582474, -0.028319314122200012, -0.03255286067724228, 0.0017460387898609042, -0.0033964042086154222, 0.01402810588479042, 0.004828514996916056, -0.005435442551970482, -0.0013491438003256917, 0.03865203633904457, -0.021430833265185356, -0.022746341302990913, 0.009082989767193794, 0.0015412380453199148, 0.014614105224609375, 0.02549695037305355, -0.030878577381372452, 0.025114256888628006, 0.03281596302986145, -0.05965233966708183, 0.005360697861760855, 0.017292959615588188, -0.03886730223894119, 0.0009328152518719435, -0.0474061481654644, 0.019027039408683777, -0.04049374908208847, 0.002575706224888563, -0.0002098460536217317, -0.024994665756821632, 0.0056028710678219795, 0.024324951693415642, -0.032839879393577576, -0.015044636093080044, 0.021538464352488518, 0.012628883123397827, -0.005773289129137993, 0.0006880260189063847, -0.02308119833469391, 0.02953914925456047, -0.012688679620623589, -0.0023425023537129164, -0.020820915699005127, -0.05529920011758804, 0.005653697531670332, 0.011708027683198452, -0.01627643033862114, -0.03700167313218117, 0.029467394575476646, 0.01353778038173914, 0.02886943705379963, -0.0040152911096811295, -0.01353778038173914, -0.019672835245728493, 0.052237655967473984, -0.0458514578640461, 0.025760052725672722, 0.03592534735798836, -0.016850469633936882, 0.017532143741846085, 0.013944392092525959, 0.01592961512506008, -0.032528940588235855, -6.1080527302692644e-06, -0.01607312448322773, 0.019636956974864006, -0.02473156340420246, 0.06314441561698914, -0.03559048846364021, 0.007420665118843317, -0.033246491104364395, 0.041235215961933136, -0.02769743837416172, 0.011498741805553436, 0.003731261007487774, -0.0043770563788712025, -0.02743433602154255, 0.009567336179316044, 0.0006839150446467102, -0.034585919231176376, -0.016515614464879036, 0.004383035935461521, 0.017221204936504364, 0.012712597846984863, -0.009328152984380722, -0.009585274383425713, 0.007540256716310978, 0.01591765508055687, -0.019182508811354637, 0.01653953269124031, 0.017376674339175224, -0.027458254247903824, -0.027601763606071472, 0.036068856716156006, 0.008951438590884209, -0.015487125143408775, 0.04099603369832039, -0.013597575947642326, -0.008592663332819939, -0.02626233734190464, -0.016443857923150063, 0.020605649799108505, -0.018572591245174408, 0.05324222519993782, -0.014494514092803001, 0.04365096986293793, -0.0026041092351078987, 0.00995600875467062, -0.00745056290179491, -0.016419939696788788, 0.025066420435905457, 0.002269252436235547, 0.028606334701180458, -0.008867724798619747, 0.03219408541917801, 0.026477601379156113, 0.03178747370839119, 0.005641738418489695, -0.03762354701757431, -0.027960538864135742, 0.029826169833540916, 0.009788580238819122, -0.028295395895838737, 0.0032469145953655243, 0.006123094819486141, 0.016085082665085793, -0.041881013661623, 0.016766756772994995, 0.02253107540309429, -0.028127968311309814, -0.0024919919669628143, -0.07577329874038696, -0.03551873564720154, 0.031404778361320496, 0.019433651119470596, 0.0290847010910511, -0.011827618815004826, -0.005396575201302767, -0.004469739738851786, -0.023619361221790314, -0.00021320956875570118, 0.030735066160559654, -0.037193018943071365, -0.017950713634490967, -0.04233546182513237, -0.02292572893202305, 0.02184940315783024, -0.016563450917601585, -0.017998550087213516, -0.005130483768880367, 0.019373854622244835, -0.0436270534992218, -0.031452618539333344, -0.02145475149154663, -0.021478669717907906, -0.022507157176733017, 0.034418489784002304, 0.024851154536008835, -0.03348567709326744, -0.007839235477149487, 0.008837826550006866, -0.024229278787970543, 0.026094907894730568, -0.024970747530460358, -0.001672788872383535, 0.001725110225379467, 0.008114296942949295, 0.009071030654013157, -0.01576218567788601, -0.04068509489297867, -0.02400205470621586, -0.011205742135643959, 0.004825524985790253, 0.008353480137884617, -0.01991201750934124, -0.04592321068048477, 0.002430701395496726, 0.025257766246795654, -0.018034428358078003, 0.0076478892005980015, 0.012700638733804226, 0.00598855409771204, -0.03901081159710884, 0.005345748737454414, 0.037097346037626266, -0.008682357147336006, -0.000982894329354167, -0.011241619475185871, -0.008670398034155369, 0.022232096642255783, 0.0001483684463892132, -0.05477299913764, 0.04621023312211037, 0.05917397141456604, 0.013657372444868088, 0.03379661589860916, 0.023942258208990097, 0.02012728340923786, -0.025401277467608452, -0.033700939267873764, 0.008736173622310162, -0.003928587306290865, 0.008891643024981022, -0.0005262034828774631, -0.02017511986196041, -0.007988725788891315, -0.0016757786506786942, -0.01338231097906828, -0.019517365843057632, 0.016814593225717545, -0.005501218140125275, -0.011911333538591862, 0.008664418943226337, -0.026908133178949356, -0.011731945909559727, 0.008789990097284317, -0.014446677640080452, 0.010553967207670212, 0.011271517723798752, -0.03367702290415764, 0.00014631297381129116, -0.0018058347050100565, 0.014566268771886826, 0.03185923025012016, 0.018548673018813133, 0.007277154829353094, 0.03312690183520317, -0.01883569173514843, -0.006392176263034344, -0.000926088192500174, 0.0025338490959256887, -0.010093539021909237, -0.04154615476727486, -0.010308803990483284, -0.04867381975054741, -0.033868368715047836, -0.01961303874850273, -0.0035010469146072865, -0.04049374908208847, -0.022411484271287918, 0.010793150402605534, -0.020258834585547447, -0.01479349285364151, -0.02083287388086319, 0.018488876521587372, -0.006434033624827862, -0.08825867623090744, -0.03159612789750099, 0.03444240987300873, 0.047788843512535095, 0.03501645103096962, -0.034825101494789124, 0.006105156149715185, -0.017017899081110954, -0.00306453718803823, -0.04173750430345535, -0.027817029505968094, -0.03061547502875328, -0.01939777284860611, 0.012880026362836361, 0.0208448339253664, -0.036427631974220276, -0.028127968311309814, -0.03157220780849457, 0.005773289129137993, 0.0012669245479628444, 0.007737583015114069, 0.023738952353596687, 0.002695297822356224, 0.05568189546465874, -0.03379661589860916, 0.015068554319441319, 0.0019343957537785172, 0.026094907894730568, -0.02963482216000557, 0.012485373765230179, -0.029754415154457092, -0.033653102815151215, 0.012341863475739956, 0.0400393009185791, -0.015188145451247692, 0.031404778361320496, -0.004131893161684275, -0.023057280108332634, -0.036021020263433456, -0.01582198217511177, -0.009639090858399868, -0.0290847010910511, 0.06070474535226822, 0.01719728671014309, 0.04735831171274185, -0.033964041620492935, 0.00692435959354043, -0.029969679191708565, 0.005459361243993044, -0.05061120539903641, -0.023978136479854584, 0.019888099282979965, 0.009364030323922634, 0.0014201514422893524, 0.009657029993832111, -0.002269252436235547, -0.010069620795547962, 0.006063299253582954, 0.0345141626894474, 0.03604493662714958, -0.007354889530688524, -0.0008775040623731911, 0.028271477669477463, 0.0011039808159694076, -0.061757154762744904, -0.027912702411413193, 0.00395250553265214, 0.00252039497718215, -0.008018623106181622, -0.023416055366396904, -0.011104089207947254, 0.024851154536008835, -0.004033230245113373, 0.023978136479854584, -0.00273117539472878, -0.002426216611638665, -0.0017011918826028705, 0.03449024632573128, -0.07213771343231201, 0.0228778924793005, 0.009477642364799976, -0.04867381975054741, 0.010619742795825005, 0.004403964150696993, -0.02379874885082245, 0.004559433553367853, -0.008269766345620155, 0.01658736914396286, -0.024145564064383507, 0.07873917371034622, 0.046090640127658844, 0.004173750523477793, 0.019935935735702515, -0.04334003105759621, 0.009866314940154552, -0.01976850815117359, -0.022698504850268364, 0.015606716275215149, 0.029610903933644295, -0.009537437930703163, 0.02267458662390709, 0.04790843278169632, -0.026597194373607635, -0.04066117852926254, 0.04331611469388008, 0.026549357920885086, -0.018046386539936066, 0.016778714954853058, 0.0007437109015882015, 0.0018357326043769717, -0.004735831171274185, -0.00025880392058752477, -0.035351306200027466, 0.002427711384370923, -0.004200658295303583, 0.010195191949605942, 0.054533813148736954, 0.03525563329458237, 0.03126126900315285, 0.004048178903758526, 0.017436468973755836, 0.015271860174834728, -0.03382053226232529, -0.009423825889825821, -0.02217230014503002, -0.030782902613282204, 0.01817793771624565, 0.003919617738574743, -0.026094907894730568, -0.006661257706582546, 0.02354760468006134, -0.021765688434243202, 0.036021020263433456, 0.009692907333374023, -0.03757571056485176, 0.022339729592204094, 0.018728060647845268, 0.005474309902638197, -0.026692867279052734, 0.023834625259041786, 0.0021780638489872217, -0.014530391432344913, 0.035542652010917664, 0.033342164009809494, 0.017436468973755836, -0.022303851321339607, 0.0022318800911307335, -0.04157007485628128, 0.008479051291942596, 0.009208560921251774, 0.028965109959244728, 0.011205742135643959, -0.0017325847875326872, 0.006822706200182438, -0.005489259026944637, -0.0005654445267282426, 0.005330800078809261, -0.027888784185051918, -0.0310220867395401, 0.019792426377534866, 0.0021391964983195066, 0.06400547921657562, -0.0023066247813403606, -0.003354547079652548, -0.0048913005739450455, 0.005749370902776718, -0.016934184357523918, 0.004939137026667595, -0.04025456681847572, 0.022279933094978333, -0.01888353005051613, -0.0619485005736351, 0.030495883896946907, 0.028582416474819183, -0.009286295622587204, 0.016850469633936882, 0.0020285742357373238, 0.019122712314128876, 0.0010068126721307635, 0.013920473866164684, 0.02247128076851368, 0.018237734213471413, -0.03884338214993477, 0.003922607749700546, 0.045373089611530304, -0.03987187147140503, -0.015044636093080044, -0.0069901347160339355, -0.022232096642255783, 0.030543720349669456, 0.0077794399112463, 0.03200273960828781, -0.02406184934079647, 0.05123308300971985, 0.008156154304742813, -0.015367533080279827, -0.00890360213816166, 0.024683726951479912, -0.000689147156663239, -0.018357325345277786, -0.09667792916297913, 0.03716909885406494, -0.003611669410020113, -0.009639090858399868, -0.020509976893663406, 0.0034083633217960596, -0.046616844832897186, 0.012018965557217598, -0.010817069560289383, 0.007689746096730232, 0.0017475336790084839, -0.005907829850912094, -0.011241619475185871, 0.03403579816222191, -0.009352071210741997, -0.07132449001073837, 0.015032676979899406, 0.005238116253167391, -0.028845516964793205, -0.008670398034155369, -0.04329219460487366, -0.0211318526417017, -0.0182257741689682, 0.0017475336790084839, -0.014721738174557686, 0.018907448276877403, 0.008479051291942596, 0.012700638733804226, -0.019971814006567, -0.01082902867347002, 0.035351306200027466, 0.01277239341288805, -0.00737282820045948, 0.01123564038425684, -0.019170548766851425, 0.008999275043606758, -0.009621151722967625, -0.034370653331279755, -0.010171273723244667, -0.01082902867347002, 0.001452291733585298, 0.0037731181364506483, 0.003366506425663829, 0.0007601547404192388, 0.0005673131090588868, -0.038006242364645004, 0.024851154536008835, 0.03740828484296799, -0.027219070121645927, -0.030687229707837105, 0.005025841295719147, 0.019792426377534866, 0.03080682083964348, -0.00809037871658802, 0.02877376228570938, 0.018512794747948647, 0.00676889019086957, 0.06371846050024033, 0.04477513208985329, 0.007354889530688524, -0.0010217615636065602, 0.008335541002452374, -0.006463931407779455, 0.007916970178484917, 0.010272926650941372, -0.035853590816259384, -0.0026504509150981903, 0.018393203616142273, -0.021933117881417274, 0.006894461344927549, -0.02036646567285061, 0.0009051596862263978, 0.0004679025150835514, 0.04719088599085808, 0.019385814666748047, -0.02949131280183792, 0.002654935698956251, -0.0003352304920554161, -0.0013072867877781391, 0.017340796068310738, -0.04140264540910721, -0.006033401004970074, -0.03097425028681755, -0.038317181169986725, 0.03185923025012016, 0.01817793771624565, 0.001254965434782207, -0.008359460160136223, 0.013944392092525959, -0.013621494174003601, 0.033557429909706116, 0.04398582503199577, -0.02805621176958084, 0.012760434299707413, -0.019266223534941673, -8.747479114390444e-06, 0.013633453287184238, 0.02882159873843193, 0.012138557620346546, -0.0017430490115657449, -0.0037850772496312857, 0.023870503529906273, -0.018919406458735466, 0.008921540342271328, 0.010763253085315228, 0.008431214839220047, 0.0001761174644343555, 0.021968994289636612, -0.03025669977068901, -0.019385814666748047, -0.03231367841362953, 0.006380217149853706, -0.00388971995562315, 0.02375091053545475, 0.02406184934079647, 0.0007272670045495033, 0.01151668094098568, -0.017998550087213516, 0.018608467653393745, -0.003740230342373252, -0.005946697201579809, -0.033653102815151215, 0.011510700918734074, -0.012891985476016998, -0.03633195906877518, -0.002409772714599967, 0.011666170321404934, -0.01601332798600197, 0.004203648306429386, 0.02128732204437256, -0.00233502802439034, 0.020653486251831055, 0.0016817583236843348, -0.011815659701824188, -0.024133604019880295, 0.005381626542657614, -0.012449495494365692, -0.015534961596131325, -0.012126598507165909, -0.0010546492412686348, 0.05204630643129349, 0.00455644354224205, -0.015487125143408775, -0.0006809252081438899, -0.015068554319441319, -0.00701405294239521, 0.011863496154546738, 0.017029857262969017, 0.01817793771624565, -0.05104173719882965, 0.05965233966708183, 0.01592961512506008, -0.01888353005051613, 0.005438432563096285, -0.024564135819673538, 0.001962798647582531, -0.030137108638882637, -0.0032499043736606836, -0.04628198593854904, 0.021119894459843636, 0.000599079648964107, 0.028702007606625557, -0.01750822551548481, -0.021574342623353004, 0.016061164438724518, -0.019218385219573975, -0.0145901869982481, 0.010984497144818306, 0.009680948220193386, 0.011175843887031078, 0.011965149082243443, 0.02855849824845791, -0.032792042940855026, 0.027817029505968094, -0.025879643857479095, -0.014733697287738323, -0.02846282348036766, 0.010835007764399052, -0.011074190959334373, 0.016348185017704964, -0.01405202504247427, 0.00224682898260653, -0.038269344717264175, -0.01601332798600197, -0.0015651563880965114, 0.0028866445645689964, -0.04970230907201767, 0.011821639724075794, -0.0030705169774591923, 0.008748132735490799, 0.022638708353042603, -0.00620680907741189, -0.008502969518303871, -0.011923292651772499, -0.02283005602657795, 0.012282067909836769, 0.013454066589474678, -0.01838124357163906, 0.015881776809692383, 0.02523384802043438, -0.004687994718551636, -0.00013089684944134206, 0.006374237593263388, -0.010978518053889275, 0.006009482778608799, -0.035399142652750015, -0.026070989668369293, 0.02877376228570938, 0.008437193930149078, 0.0025174051988869905, -0.027673518285155296, 0.006900440901517868, -0.01925426349043846, 0.023523686453700066, 0.012736516073346138, -0.02913253754377365, -0.006888481788337231, 0.007444583345204592, 0.017687613144516945, 0.048147618770599365, 0.008221928961575031, -0.0005774036981165409, -0.021562382578849792, 0.034681592136621475, 0.015044636093080044, -0.0013184985145926476, -0.006000513676553965, 0.01164225209504366, -0.0035100162494927645, 0.03348567709326744, -0.0012706618290394545, 0.01694614440202713, -0.0032977410592138767, -0.0015651563880965114, -0.002764063188806176, 0.02364327944815159, 0.012240210548043251, -0.010225090198218822, -0.00770170520991087, 0.0128202298656106, -0.029826169833540916, 0.004786657635122538, 0.023607401177287102, 0.008299663662910461, 0.000579272280447185, -0.024707645177841187, 0.012156495824456215, -0.02595139853656292, 0.02328450419008732, 0.010201171971857548, -0.010075600817799568, -0.04030240327119827, 0.02913253754377365, 0.01384871918708086, -0.025401277467608452, 0.023607401177287102, -0.04606672376394272, -0.022435402497649193, 0.010494171641767025, 0.03666681423783302, 0.0006327148294076324, -0.00770170520991087, 0.017113571986556053, 0.002326058456674218, 0.005345748737454414, -0.0025876653380692005, -0.05917397141456604, 0.026549357920885086, -0.006876522675156593, -0.044105418026447296, 0.011193783022463322, -0.01602528803050518, 0.011349252425134182, 0.01576218567788601, 0.011630292981863022, -0.01924230344593525, -0.018452998250722885, -0.007863154634833336, 0.00233502802439034, 0.00926237739622593, -0.042311541736125946, -0.012228251434862614, 0.0045534539967775345, -0.0006121600163169205, 0.02001965045928955, -0.004275403451174498, 0.004051168914884329, -0.021538464352488518, -0.01663520559668541, 0.02123948559165001, 0.0047746985219419, 0.003973434213548899, -0.0005415261839516461, 0.02251911722123623, -0.015523002482950687, -0.008251827210187912, -0.013262719847261906, -0.0071695223450660706, 0.013454066589474678, -0.006481870077550411, 0.0004084804095327854, -0.008514928631484509, -0.011337293311953545, 0.0019000130705535412, -0.013418188318610191, 0.0015165721997618675, -0.02134711854159832, -0.025353441014885902, 0.01853671297430992, 0.019469529390335083, 0.0019598088692873716, -0.009077009744942188, -0.012557128444314003, 0.013513862155377865, 0.027219070121645927, -0.014087902382016182, -0.011301415972411633, 0.009770642034709454, 0.01945756934583187, -0.014016146771609783, -0.0015120875323191285, 0.008323581889271736, -0.014135738834738731, -0.020605649799108505, 0.00033448304748162627, -0.03547089919447899, -0.020868752151727676, 0.00770170520991087, -0.009639090858399868, -0.008508949540555477, -0.008730193600058556, -0.027601763606071472, 0.057978056371212006, -0.0024127624928951263, -0.04257464408874512, -0.005309871397912502, 0.005719473119825125, 0.011038313619792461, -0.01171998679637909, 0.018405161798000336, -0.003740230342373252, 0.004792637191712856, -0.02400205470621586, -0.019624996930360794, 0.006804767530411482, -0.007271175272762775, -0.0038149752654135227, 0.0064101149328053, -0.020055528730154037, 0.01638406328856945, -0.020713282749056816, 0.0022722422145307064, 0.012156495824456215, 0.006852604448795319, 0.02318883128464222, -0.0019986762199550867, -0.0030824760906398296, 0.0029554099310189486, -0.00354589382186532, 0.007749542128294706, 0.019852222874760628, -0.013238800689578056, 0.005686585325747728, 0.007821297273039818, 0.001260197488591075, -0.02477939985692501, -0.009686927311122417, -0.017137490212917328, -0.01353778038173914, -0.01694614440202713, -0.005806176923215389, 0.015176186338067055, 0.01905095763504505, 0.011767823249101639, -0.03702558949589729, 0.04250289127230644, 0.0003105647047050297, -0.0200674869120121, -0.011331313289701939, 0.03389228880405426, 0.04171358421444893, -0.028127968311309814, -0.013549739494919777, 0.006326400674879551, 0.00603938102722168, -0.010296844877302647, 0.009160724468529224, 0.00857472512871027, 0.011654211208224297, 0.01878785528242588, -0.01925426349043846, 0.00737282820045948, 0.007659848313778639, 0.011480802670121193, -0.007893051952123642, 0.07730407267808914, 0.004969035275280476, 0.024564135819673538, -0.017627816647291183, -0.02048605866730213, 0.02303336188197136, 0.028534580022096634, 0.0024635889567434788, -0.03762354701757431, 0.024540215730667114, -0.02343997359275818, -0.005297912284731865, -0.037647467106580734, 0.04121129959821701, 0.04499039798974991, -0.028749844059348106, -0.0003223370003979653, 0.03453808277845383, 0.02774527482688427, 0.013776963576674461, 0.028080129995942116, -0.005330800078809261, 0.007749542128294706, -0.01797463186085224, -0.022507157176733017, -0.003354547079652548, -0.006673216819763184, -0.014374922029674053, -0.033150818198919296, 0.019517365843057632, 0.022794177755713463, 0.03274420648813248, -0.0028627263382077217, 0.021478669717907906, -0.025975316762924194, 0.041235215961933136, -0.028606334701180458, -0.019469529390335083, 0.018859611824154854, 0.004783668089658022, -0.01838124357163906, -0.025616541504859924, 0.006434033624827862, 0.006780849304050207, 0.03812583535909653, -0.0033425879664719105, -0.026788540184497833, 0.0348968580365181, -0.03649938479065895, -0.01530773751437664, -0.010852946899831295, -0.0050407899543643, -0.04101995378732681, 0.00034121007774956524, 0.028295395895838737, -0.0003370991034898907, -0.020749159157276154, 0.010607783682644367, 0.00636227848008275, 0.008819887414574623, 0.050802554935216904, -0.02165805734694004, 0.0310220867395401, 0.002974843606352806, -0.010685518383979797, 0.0045893313363194466, 9.006750042317435e-05, -0.01637210324406624, -0.010619742795825005, -0.04319652169942856, -0.005073677748441696, 0.004090036265552044, 0.016407981514930725, -0.008538846857845783, 0.028343232348561287, -0.012880026362836361, 0.016097042709589005, -0.0012004016898572445, 0.031356941908597946, 0.022184260189533234, -0.006858584005385637, -0.012282067909836769, 0.0006902683526277542, -0.013944392092525959, 0.009352071210741997, 0.005163371562957764, -0.016156839206814766, 0.0009365524747408926, 0.018620427697896957, -0.00967496819794178, -0.012903944589197636, 0.008455133065581322, 0.019780466333031654, 0.04436852037906647, -0.022339729592204094, 0.016874387860298157, 0.0034532102290540934, -0.01847691833972931, -0.019385814666748047, -0.02058173157274723, -0.003668475430458784, -0.013621494174003601, 0.008550806902348995, -0.022806137800216675, 0.011421007104218006, 0.04613847658038139, -0.012581046670675278, -0.009352071210741997, 0.004658096469938755, 0.019923977553844452, 0.010990477167069912, 0.007313032168895006, -0.012832188978791237, -0.035853590816259384, 0.01566651277244091, -0.020641528069972992, 0.0026489561423659325, 0.03164396435022354, 0.022435402497649193, 0.030926413834095, 0.0008027592557482421, -0.021681975573301315, -0.009961988776922226, 0.006242686882615089, -0.012096700258553028, -0.0071515836752951145, 0.02109597623348236, 0.007157563231885433, 0.013908514752984047, -0.035399142652750015, -0.009746723808348179, 0.001974757993593812, -0.033342164009809494, -0.017269041389226913, -0.0020838852506130934, 0.023260585963726044, -0.03817367181181908, 0.003378465538844466, -0.022447362542152405, 0.01766369305551052, 0.017735449597239494, -0.011199763044714928, 0.008365439251065254, -0.0013498913031071424]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" we are given access to an unnormalized density
˜σ(s1:T)which can be efficiently evaluated. We focus on
estimation of the partition function or normalization con-
stantZσ:=P
s1:T˜σ(s1:T), since unbiased estimators with
low variance yield approximate sampling techniques which
closely approximate the target distribution (Finke, 2015;
Maddison et al., 2017). We review simple importance sam-
pling (SIS) and SMC techniques in this section.
2.1. Simple Importance Sampling
Simple importance sampling ( SIS) provides an unbiased
estimator of Zσby calculating importance weights for any
normalized proposal distribution q(s1:T),
w(si
1:T):=˜σ 
si
1:T
q(si
1:T), (2)
which is unbiased since Zσ=Eq(s1:T)[w(s1:T)]. The im-
portance weights also yield an an unbiased K-sample esti-
mator of the partition function,
ˆZSIS
σ:=1
KKX
i=1w(si
1:T),si
1:T∼q(s1:T). (3)
By normalizing the weights in Eq. (2) over Ksamples from
q(s1:T), we can obtain (biased) estimators of expectations
under σ(s1:T),
Eσ(s1:T)
f(s1:T)
≈KX
k=1w(sk
1:T)PK
j=1w(sj
1:T)f(sk
1:T) (4)
or select an approximate target sample sσ
1:Tfrom a categori-
cal distribution with the self-normalized importance weights
sσ
1:T←sω
1:T, ω ∼cat
(
w 
si
1:T
PK
j=1w 
sj
1:T)K
i=1
.(5)
The quality of the approximations in Eq. (3)-(5) depends
crucially on how well the proposal q(s1:T)(which may be
learned, Sec. 3.2) matches the target σ(s1:T). While we
discuss evaluation methods in Sec. 5, note that if inference
is exact (i.e., q(s1:T) =σ(s1:T)), then the variance of the
importance weights is zero, as w(s1:T) =Zσfor all s1:T.
2
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
I liked
this bookthe title 
This bookI loved
was bad!but I don't recommend it
Best book
waste of timeever!
A disappointing experience
was okThis book
This book not a 
(a) Simple Importance Sampling
was amazing!
and I highly
I liked
this book
only the first 
I hateThis bookI loved
was bad!but I don't recommend it
and I will
Best book hands down!ever!
read it again! (b) Twisted SMC
Figure 2: Illustrative example of SISand (Twisted) SMC for sampling
book reviews conditioned on positive sentiment ϕ(s1:T).SIS only
performs resampling after observing the entire sequence, while SMC
can kill or clone partial sequences s1:tbased on incremental impor-
tance weights induced by twist functions ψt(s1:t). Green/red indicate
high/low importance weights at each incremental step of SMC, or at
the final step of SIS. For SMC with the base model proposal p0and the
optimal twists, the incremental weights ψ∗
t/ψ∗
t−1(Alg. 1 or Eq. (6))
are directly correlated with sentiment.Algorithm 1 (Twisted) SMC Sampling ( qSMC)
SMC-PROPOSAL 
p0, q,{ψt}T−1
t=1, ϕ, K
:
fort= 1, ..., T do
fork= 1, ..., K do
Sample sk
t∼q 
stsk
1:t−1
sk
1:t←concat 
sk
1:t−1, sk
t
ift < T then
wk
t←p0(sk
t|sk
1:t−1)
q(sk
t|sk
1:t−1)ψt(sk
1:t)
ψt−1(sk
1:t−1)
else
wk
t←p0(sk
t|sk
","[0.01782652735710144, -0.011767704039812088, 0.0026022749952971935, 0.04119725525379181, -0.01885577291250229, -0.029395245015621185, 0.009359270334243774, -0.009434748440980911, -0.04092279076576233, 0.009372993372380733, 0.03109692968428135, -0.018910666927695274, -0.043941911309957504, 0.026883885264396667, 0.0388917475938797, -0.001437512575648725, -0.007815402001142502, -0.0022300314158201218, -0.02133968472480774, 0.02272573485970497, -0.004257644526660442, 0.027597496286034584, -0.003979748114943504, 0.021092666313052177, 0.001384334871545434, -0.021970955654978752, 0.03664113208651543, -0.007451735436916351, 0.039221104234457016, -0.014519219286739826, 0.05036440119147301, -0.01689334586262703, -0.0516543872654438, -0.06351129710674286, -0.024990074336528778, 0.0840413048863411, -0.027775898575782776, 0.022561056539416313, -0.013181201182305813, 0.028187597170472145, 0.01158243976533413, -0.033457331359386444, -0.0011021500686183572, 0.033951371908187866, 0.036009859293699265, 0.03471987321972847, 0.023535408079624176, -0.04657677933573723, -0.012899873778223991, 0.06455425918102264, -0.038425154983997345, 0.017661849036812782, -0.034527748823165894, -0.005928452592343092, -0.00046959315659478307, 0.004384584724903107, -0.01018952764570713, -0.014985810965299606, -0.009626873768866062, -0.01903417520225048, 0.04383212327957153, -0.01453294325619936, -0.009668043814599514, 0.01858130842447281, -0.024454867467284203, -0.015287722460925579, -0.021284792572259903, 0.027748452499508858, -0.0515720471739769, 0.019610552117228508, -0.03419838845729828, 0.020680967718362808, -0.0005961045389994979, -0.008508427068591118, -0.035076677799224854, 0.0374370813369751, -0.02568996138870716, 0.048909734934568405, -0.00801438931375742, -0.03293584659695625, -0.008899540640413761, -0.004490939900279045, 0.0318654328584671, 0.0015335754724219441, -0.05266990885138512, -0.04484764486551285, -0.025319432839751244, 0.0017557208193466067, -0.01762067899107933, 0.005465292371809483, -0.02254733256995678, 0.03364945948123932, -0.04075811058282852, -0.010278729721903801, 0.0699886754155159, -0.009263207204639912, 0.008371194824576378, 0.02044767327606678, 0.013785025104880333, 0.001503555802628398, 0.029669709503650665, -0.03192032501101494, 0.011822597123682499, -0.015013257041573524, 0.0501997210085392, -1.8266422557644546e-05, 0.009249484166502953, -1.9325152607052587e-05, -0.0389740876853466, 0.013675238937139511, 0.0009366131853312254, -0.04844314232468605, -0.04748251289129257, 0.060601960867643356, 0.011410899460315704, -0.00032657093834131956, -0.007472320459783077, 0.0041478583589196205, -0.018498968333005905, 0.00034200961817987263, -0.021778829395771027, -0.014004597440361977, 0.028462061658501625, 0.012934181839227676, -0.00023972836788743734, -0.03510412573814392, 0.039358340203762054, -0.061315570026636124, 0.008920125663280487, 0.015905270352959633, 0.020598627626895905, 0.00939357839524746, -0.003688128897920251, -0.005022716708481312, -0.01399773545563221, 0.010072880424559116, -0.010820798575878143, 0.03367690369486809, 0.009270069189369678, 0.023109987378120422, -0.02665059082210064, -0.03002651408314705, -0.010676704347133636, 9.702780516818166e-05, 0.0011295966105535626, -0.03716261684894562, -0.05253267660737038, 0.04926653951406479, -0.027981746941804886, 0.01744227670133114, 0.014560389332473278, -0.029395245015621185, -0.03834281489253044, 0.02592325769364834, 0.00872113835066557, -0.06027260050177574, -0.03351222723722458, 0.034253280609846115, -0.0009074512054212391, -0.01727759651839733, -0.006196056492626667, 0.04847059026360512, 0.003317600581794977, -0.008817200548946857, -0.015479848720133305, -0.00408610375598073, -0.03126160800457001, 0.008707414381206036, -0.04899207502603531, -0.036394111812114716, 0.009990540333092213, -0.06098621338605881, -0.006820465438067913, -0.053767770528793335, -0.00011107271711807698, -0.03554327040910721, -0.015918992459774017, -0.08376684039831161, -0.0006805884186178446, -0.007602691650390625, -0.0169619619846344, 0.05884538218379021, -0.018498968333005905, -0.0029882420785725117, 0.030740125104784966, 0.018704816699028015, -0.0024084339383989573, 0.04759230092167854, 0.03444540873169899, -0.005835820455104113, -0.00393857853487134, 0.05305416136980057, 0.03691559657454491, 0.0055990940891206264, -0.035049229860305786, -0.0011416045017540455, 0.04278915748000145, 0.09287909418344498, 0.024633269757032394, 0.0030105423647910357, -0.006316135171800852, 0.004525248426944017, -0.0219297856092453, -0.028160149231553078, -0.007211578544229269, 0.008089867420494556, 0.0013500266941264272, 0.006587169598788023, -0.08025368303060532, 0.025731131434440613, 0.029669709503650665, -0.013538005761802197, 0.07262354344129562, -0.0026966226287186146, -0.01785397343337536, 0.02988928183913231, -0.0586807020008564, 0.013119446113705635, -0.035323698073625565, 0.06664019823074341, 0.006676370743662119, 0.03809579834342003, 0.05922963470220566, 0.015644527971744537, -0.04443594813346863, 0.03628432750701904, -0.0025250816252082586, -0.0453142374753952, 0.006285257637500763, -0.052560124546289444, 0.012378389947116375, 0.038425154983997345, 0.008076144382357597, -0.04652188718318939, -0.030904803425073624, 0.0011853474425151944, -0.04158150777220726, -0.011356006376445293, -0.03644900396466255, -0.07558777183294296, 0.0028818866703659296, -0.0017094048671424389, -0.0009091666433960199, 0.0016279228730127215, -0.00891326367855072, 0.02251988649368286, -0.011630471795797348, 0.003513157134875655, 0.0009237476042471826, 0.013791886158287525, 0.0012779795797541738, -0.012700886465609074, -0.009434748440980911, 0.004761974792927504, -0.04764719307422638, -0.026938779279589653, -0.00022257427917793393, 0.00992878619581461, 0.0037601760122925043, 0.004048364702612162, -0.029285458847880363, -0.0282699353992939, -0.04589061439037323, -0.014615282416343689, -0.04506721720099449, -0.025593899190425873, -0.019253747537732124, -0.016289521008729935, 0.05277969688177109, -0.008343747816979885, -0.036668576300144196, -0.0028407168574631214, 0.029697155579924583, 0.0466865636408329, -0.0062578110955655575, -0.04424382373690605, -0.024976352229714394, 0.05571647733449936, -0.03633921965956688, 0.04078555852174759, 0.003712144447490573, -0.08288855105638504, 0.009791553020477295, -0.015438678674399853, 0.013579175807535648, 0.02099660225212574, 0.0006505687488242984, 0.048909734934568405, 0.023370729759335518, -0.06444447487592697, -0.014436880126595497, -0.006295550148934126, 0.0006986001972109079, -0.011911798268556595, 0.030987143516540527, 0.01285870373249054, -0.014519219286739826, 0.009215176105499268, -0.004038072191178799, 0.009469056501984596, 0.06971421092748642, -0.023315835744142532, 0.009770967997610569, 0.0076438612304627895, 0.014244753867387772, -0.018073545768857002, 0.003310738829895854, 0.00545499986037612, -0.022629672661423683, 0.008275131694972515, -0.012097062543034554, -0.013359603472054005, -0.019390979781746864, 0.01720898039638996, 0.02313743345439434, -0.01992618851363659, 0.06438958644866943, -0.03617453947663307, 0.012069616466760635, -0.04226767271757126, -0.041499167680740356, -0.0006484244950115681, -0.019116515293717384, -0.0007363391923718154, 0.012687163427472115, -0.04361255094408989, -0.040813006460666656, -0.01479368470609188, -0.002401572186499834, -0.012158817611634731, 0.02958736941218376, 0.014889747835695744, 0.025662515312433243, 0.026348678395152092, -0.012131370604038239, -0.08371194452047348, 0.011307974345982075, 0.04992525652050972, -0.03131650388240814, 0.04155406355857849, -0.06609126925468445, 0.01465645246207714, -0.01568569801747799, -0.04457318037748337, 0.035872627049684525, 0.007142961956560612, 0.016522817313671112, 0.03933089226484299, 0.05003504082560539, 0.010381653904914856, 0.02099660225212574, 0.014903470873832703, 0.016975685954093933, -0.014834854751825333, 0.03823303058743477, -0.002207731129601598, 0.010017987340688705, -0.003005396109074354, -0.02261594869196415, -0.034664981067180634, -0.026595696806907654, 0.02400199882686138, 0.06290747225284576, -0.006436213850975037, 0.023919660598039627, 0.034390516579151154, -0.020008528605103493, -0.012563653290271759, -0.027185797691345215, 0.006895943079143763, -0.021394578740000725, 0.029230564832687378, 0.003561188466846943, 0.012097062543034554, -0.03554327040910721, 0.009832723066210747, 0.0052765971049666405, 0.02523709274828434, 0.035598162561655045, 0.036805808544158936, 0.03109692968428135, 0.026019319891929626, -0.003976317588239908, -0.024399973452091217, 0.01716781035065651, 0.00046058723819442093, 0.0169619619846344, -0.007870295085012913, -0.030767571181058884, 0.0382055826485157, -0.0012942758621647954, -0.027679836377501488, -0.02810525707900524, 0.025346878916025162, 0.021422024816274643, -0.027679836377501488, -0.03216734528541565, 0.04564359784126282, 0.025127306580543518, 0.04133449122309685, -0.041910868138074875, 0.02402944676578045, -0.03793111816048622, -0.031810540705919266, -0.052807144820690155, 0.01748344674706459, -0.0009426171309314668, 0.028736528009176254, 0.02140830084681511, 0.05747305601835251, 0.04133449122309685, -0.06806741654872894, 0.038672175258398056, -0.0041924589313566685, 0.024948904290795326, -0.061590034514665604, 0.006377889774739742, 0.007849710062146187, 0.026348678395152092, 0.07009845972061157, -0.021943509578704834, -0.04078555852174759, 0.0023535408545285463, -0.0014966941671445966, -0.011362867429852486, 0.0017771634738892317, 0.027556326240301132, -0.04040130600333214, 0.046219974756240845, -0.03148118034005165, 0.006552861537784338, 0.03592751920223236, 0.02026926912367344, -0.0013697538524866104, -0.022835521027445793, -0.008089867420494556, 0.04369489103555679, -0.03093225136399269, 0.026568250730633736, -0.03661368414759636, -0.010573779232800007, 0.0173050444573164, -0.023109987378120422, 0.015575911849737167, -0.00012586811499204487, -0.029916727915406227, 0.007822263985872269, -0.05330118164420128, 0.0009503364562988281, -0.011898075230419636, 0.0194870438426733, -0.03540603816509247, 0.07114142924547195, -0.013956565409898758, 0.02251988649368286, -0.05148971080780029, 0.04750996083021164, -0.01644047722220421, 0.04037386178970337, -0.04885484278202057, 0.030767571181058884, 0.03106948360800743, 0.006827326957136393, 0.04869016259908676, 0.028709080070257187, 0.0275426022708416, 0.020365333184599876, -0.02548411302268505, 0.028901206329464912, 0.03927600011229515, -0.015548464842140675, -0.05675944313406944, 0.016495371237397194, 0.0010978615609928966, -0.023782426491379738, -0.028846314176917076, 0.060876425355672836, -0.03771154582500458, 0.007856572046875954, 0.003602358279749751, 0.02892865240573883, -0.02113383635878563, 0.013160616159439087, 0.046741459518671036, 0.02251988649368286, 0.03834281489253044, 0.027775898575782776, -0.027460264042019844, 0.007808540482074022, 0.011184465140104294, -0.02289041504263878, -0.035213910043239594, 0.026252616196870804, -0.016193458810448647, 0.010951169766485691, -0.033567119389772415, 0.015781760215759277, 0.013064553029835224, -0.03655879199504852, -0.01899300515651703, 0.03570794686675072, -0.003945440053939819, -0.03002651408314705, 0.05272480472922325, 0.015877824276685715, 0.01412124466150999, 0.026540804654359818, -0.017799081280827522, 0.008995603770017624, 0.044216375797986984, -0.02662314474582672, -0.004919792525470257, 0.008686830289661884, 0.01139717549085617, 0.013730132021009922, -6.98493022355251e-05, -0.017428552731871605, -0.025429219007492065, 0.0006805884186178446, 0.01796375960111618, 0.017359936609864235, -0.002303794026374817, -0.03831537067890167, -0.018197055906057358, 0.017497168853878975, -0.04130704328417778, 0.006322996690869331, -0.07174525409936905, -0.0265133585780859, -0.06400533020496368, -0.012110785581171513, -0.030246086418628693, 0.008137899450957775, 0.01716781035065651, -0.03109692968428135, 0.0027738159988075495, -0.02286296710371971, -0.01179515104740858, 0.01022383663803339, 0.01821077987551689, -0.01609739661216736, -0.005015855189412832, 0.011904937215149403, 0.0029213412199169397, -0.00915342103689909, -0.011122710071504116, 0.0222728680819273, 0.0017359936609864235, -0.01600133255124092, -0.015370062552392483, -0.0014512358466163278, -0.011184465140104294, 0.017977483570575714, -0.01827939599752426, -0.004556125495582819, 0.024646993726491928, 0.01072473544627428, 0.030575444921851158, -0.007623276673257351, 0.001501840422861278, 0.049842916429042816, -0.034225836396217346, 0.006679801736027002, -0.016316968947649002, -0.024454867467284203, 0.01418986078351736, 0.02906588651239872, 0.02313743345439434, 0.026389848440885544, 0.04328319430351257, -0.044353608042001724, 0.0024170109536498785, 0.02434508129954338, -0.0452318973839283, -0.0282699353992939, -0.030712679028511047, 0.0016262074932456017, -0.054563723504543304, -0.0381232425570488, 0.005029578693211079, -0.02837972156703472, -0.004031210672110319, 0.027638666331768036, -0.028846314176917076, -0.017565784975886345, 0.03172820061445236, 0.009805276058614254, 0.021778829395771027, -0.007300779689103365, 0.0011733395513147116, 0.011321697384119034, 0.00136374996509403, -0.005297182127833366, -0.007602691650390625, -0.031124375760555267, 0.016852175816893578, 0.011143295094370842, -0.007671307772397995, -0.05426181107759476, 0.01682472974061966, 0.0219297856092453, 0.019665446132421494, -0.0011330274865031242, -0.024221571162343025, -0.04399680346250534, 0.05140737071633339, -0.040840450674295425, 0.026485910639166832, 0.02917567268013954, 0.015246553346514702, 0.02592325769364834, 0.022561056539416313, -0.00015009826165623963, -0.019198855385184288, 0.002540520392358303, -0.022108187898993492, 0.03955046460032463, -0.010017987340688705, 0.05475584790110588, -0.015987610444426537, -0.00400719465687871, -0.03740963339805603, 0.03878195956349373, -0.0034994338639080524, -0.006172040477395058, 0.013421358540654182, 0.0028818866703659296, -0.021916061639785767, -0.003732729470357299, -0.00438801571726799, -0.006254380103200674, 0.004858037456870079, -0.0041821664199233055, 0.01827939599752426, -0.003375924425199628, -0.015232829377055168, -0.008741723373532295, 0.0190616212785244, 0.018869496881961823, -0.01144520752131939, 0.029806941747665405, -0.0006801595445722342, 0.00854959711432457, -0.06674998253583908, 0.014176137745380402, 0.017703019082546234, -0.022053295746445656, 0.04344787448644638, -0.025127306580543518, -0.028763974085450172, -0.019885018467903137, -0.027391647920012474, 0.03159096837043762, -0.04037386178970337, 0.03795856609940529, -0.014313370920717716, 0.0282699353992939, -0.028709080070257187, -0.023988276720046997, -0.03268883004784584, -0.03581773489713669, 0.0035886350087821484, -4.720054494100623e-05, 0.029559923335909843, 0.017126640304923058, 0.028160149231553078, 0.04012684151530266, 0.020845647901296616, 0.0016021918272599578, -0.007534075062721968, -0.019885018467903137, 0.029148224741220474, 0.0061891949735581875, -0.018540138378739357, 0.005715741775929928, 0.013050829991698265, -0.004484078381210566, -0.04119725525379181, 0.0066489242017269135, 0.024015722796320915, -0.014354540035128593, -0.010470855049788952, -0.05143481492996216, -0.009414163418114185, 0.006741556338965893, -0.00825454667210579, 0.021394578740000725, -0.004250783007591963, -0.011994138360023499, -0.006590600591152906, -0.026431018486618996, 0.02133968472480774, 0.02379615046083927, -0.042597029358148575, 0.000133909095893614, -0.04685124382376671, -0.030300980433821678, 0.025635069236159325, -0.022355206310749054, -0.07031803578138351, -0.011040370911359787, 0.015562187880277634, -0.04641209915280342, -0.003979748114943504, -0.024880288168787956, -0.008281993679702282, -0.04399680346250534, 0.028599293902516365, 0.03927600011229515, -0.021902339532971382, 0.01648164726793766, 0.013140031136572361, -0.03340243920683861, 0.012131370604038239, -0.031673308461904526, -0.020900540053844452, 0.030493106693029404, 0.01703057810664177, 0.025360602885484695, -0.01602877862751484, -0.029285458847880363, 0.0013174338964745402, -0.04646699130535126, -0.013332156464457512, -0.00018848053878173232, -0.024797948077321053, -0.0282699353992939, -0.008323163725435734, -0.005365798715502024, 0.0032301147002726793, -0.004511524923145771, 0.030438212677836418, 0.004432616289705038, -0.024852842092514038, -0.00018108283984474838, 0.020324163138866425, -0.007438012398779392, 0.021037772297859192, -0.026815269142389297, -0.003602358279749751, -0.006542569026350975, 0.00703317578881979, -0.02455092966556549, 0.03268883004784584, 0.04023662954568863, 0.016701219603419304, 0.013901672326028347, 0.021641597151756287, -0.02733675390481949, -0.03716261684894562, -0.014285923913121223, 0.012158817611634731, -0.030657785013318062, 0.029532477259635925, 0.015493571758270264, -0.030246086418628693, -0.012467591091990471, -0.003526880405843258, -0.005887283012270927, 0.012220571748912334, 0.030877357348799706, 0.024084338918328285, -0.013908534310758114, 0.028983546420931816, -0.006607754621654749, -0.0036057892721146345, -0.00454240245744586, -0.0030345581471920013, 0.007424288894981146, 0.016742389649152756, -0.0012591100530698895, 0.030355872586369514, -0.011108987033367157, 0.01179515104740858, 0.05796709284186363, -0.0031100360210984945, 0.0006780152907595038, -0.025497835129499435, -0.03321031481027603, 0.0158915463835001, -0.00023972836788743734, -0.0052422890439629555, -0.01600133255124092, -0.04495743289589882, -0.025346878916025162, -0.03268883004784584, -0.027295583859086037, 0.012316634878516197, 0.00581866642460227, -0.054152023047208786, -0.013647791929543018, 0.008631937205791473, 0.010299313813447952, 0.00045715642045252025, -0.012728332541882992, 0.02099660225212574, -0.0041821664199233055, -0.1298770308494568, -0.03471987321972847, 0.045671042054891586, 0.025868363678455353, 0.02323349565267563, -0.011431483551859856, 0.013586037792265415, -0.015054427087306976, -0.0013371611712500453, -0.03213989734649658, -0.03002651408314705, -0.02058490552008152, -0.017881421372294426, 0.020571181550621986, 0.03482965752482414, -0.022602226585149765, 0.011115849018096924, -0.019116515293717384, -0.00922203715890646, -0.008151622489094734, -0.0041684433817863464, 0.024249017238616943, 0.02006342075765133, 0.05272480472922325, -0.025360602885484695, -0.0075409370474517345, -0.015630804002285004, 0.0388917475938797, -0.0014400857035070658, 0.0018234795425087214, 0.006244088057428598, -0.019747786223888397, 0.02106522023677826, 0.02386476658284664, -0.0381232425570488, 0.0325515978038311, -0.017812805250287056, 0.0031066052615642548, -0.009784691967070103, -0.011108987033367157, 2.7768179279519245e-05, -0.03499433770775795, 0.05316394940018654, -0.0018046100158244371, 0.024976352229714394, -0.04210299253463745, -0.015054427087306976, -0.004662481136620045, 0.016714943572878838, 0.007602691650390625, -0.0009820715058594942, 0.02799547091126442, -0.013181201182305813, -0.00642935186624527, 0.008968156762421131, 0.000697742507327348, -0.0004927511909045279, 0.017703019082546234, 0.028736528009176254, 0.031700752675533295, -0.041801080107688904, -0.0006883077439852059, 0.05747305601835251, -0.04761974886059761, -0.03441796079277992, -0.019322363659739494, -0.019281193614006042, -0.006278396118432283, 0.008494704030454159, -0.009921924211084843, -0.010614949278533459, 0.007197855040431023, -0.023302111774683, 0.003952301573008299, -0.0030328426510095596, 0.006751848850399256, -0.0020070283208042383, 0.009908201172947884, -0.02931290492415428, -0.013345880433917046, 0.02124362252652645, -0.05500286817550659, 0.03282606229186058, -0.003873392939567566, -0.013853641226887703, 0.0050844717770814896, -0.010333622805774212, 0.01869109459221363, -0.01527399942278862, 0.08727999776601791, 0.03982492908835411, -0.0040792422369122505, 0.03579028695821762, -0.024633269757032394, 0.01596016250550747, -0.007410565856844187, -0.011438345536589622, 0.03367690369486809, 0.02017320692539215, 0.025813471525907516, 0.037903670221567154, 0.03924855217337608, 0.007280194666236639, -0.03955046460032463, -0.0019504197407513857, 0.02558017522096634, -0.015452401712536812, 0.031700752675533295, 0.013970288448035717, -0.005341782700270414, -0.010614949278533459, -0.020077144727110863, -0.05264246463775635, -0.00027382210828363895, 0.008131037466228008, 0.01785397343337536, 0.030163748189806938, 0.02195723168551922, 0.016838451847434044, -0.0017454284243285656, 0.0037258677184581757, -0.002746369456872344, -0.006566584575921297, -0.002552528167143464, -0.01716781035065651, -0.012398974038660526, 0.00635387422516942, 0.027460264042019844, -0.005636833142489195, -0.016385585069656372, 0.03782133385539055, -0.0036366665735840797, 0.05494797229766846, -0.001861218479461968, -0.006919959094375372, 0.030904803425073624, 0.006858204025775194, -0.009489641524851322, -0.023082539439201355, 0.015370062552392483, -0.008323163725435734, 0.0025147893466055393, 0.01668749563395977, 0.04295383393764496, 0.00012050746590830386, -0.031042037531733513, 0.007966358214616776, -0.03622943162918091, 0.014958363957703114, 0.002758377231657505, 0.016811005771160126, -0.016783559694886208, 0.005406968295574188, -0.014025181531906128, -0.009372993372380733, -0.01513676717877388, -0.013935980387032032, -0.03238691762089729, -0.013867364265024662, 0.00156874128151685, 0.01871854066848755, 0.04276170954108238, 0.013915395364165306, -0.01644047722220421, 0.0025645361747592688, 0.021202452480793, -0.021051496267318726, -0.013510559685528278, -0.005135933868587017, 0.01707174815237522, 0.0008521293057128787, -0.04427126795053482, 0.010395376943051815, 0.02475677989423275, 0.006220072042196989, -0.009558257646858692, -0.006182332988828421, 0.0033141698222607374, 0.0016073379665613174, -0.00016757399134803563, 0.00853587407618761, 0.03428072854876518, -0.023315835744142532, 0.02065352164208889, 0.026815269142389297, -0.040840450674295425, -0.00423362897709012, 0.011644194833934307, -0.027281861752271652, 0.009544534608721733, 0.0005609386716969311, 0.030383320525288582, -0.03378669172525406, 0.05763773247599602, -0.007705616299062967, 0.0158915463835001, -0.028599293902516365, 0.01013463456183672, -0.008151622489094734, 0.0008920125546865165, 0.001718839630484581, 0.056045833975076675, 0.011520685628056526, -0.021106388419866562, -0.0013654653448611498, 0.02361774817109108, -0.04119725525379181, 0.008213377557694912, -0.01634441502392292, -0.00575691182166338, -0.00393171701580286, 0.015287722460925579, -0.01527399942278862, 0.017908867448568344, -0.008988741785287857, -0.05857091769576073, -0.0003645243705250323, 0.03941323235630989, -0.056155622005462646, -0.03817813843488693, -0.014821131713688374, -0.030520552769303322, -0.020873093977570534, 0.004363999702036381, -0.04781187325716019, -0.018251949921250343, -0.008350609801709652, 0.026403572410345078, -0.01217254064977169, 0.0036400973331183195, 0.011939245276153088, 0.02644474059343338, -0.010923722758889198, -0.009434748440980911, -0.015644527971744537, 0.013133169151842594, -0.020159482955932617, -0.0136203458532691, 0.012350942939519882, -0.029806941747665405, -0.011040370911359787, 0.0013774732360616326, 0.0013877656310796738, 0.006865066010504961, 0.014821131713688374, -0.011843182146549225, 0.05571647733449936, 0.004247352015227079, -0.019541935995221138, -0.044490840286016464, -0.023398175835609436, 0.023109987378120422, 0.04789421334862709, -0.006456798408180475, 0.012426421046257019, 0.010752182453870773, -0.02719952166080475, 0.036833256483078, 0.038809407502412796, 0.004727666731923819, -0.01757950894534588, -0.02117500640451908, -0.013119446113705635, -0.014930917881429195, 0.0028630171436816454, -0.036119647324085236, 0.024811672046780586, 0.02031043916940689, -0.0466865636408329, -0.026321232318878174, -0.011019785888493061, -0.007849710062146187, 0.0072527481243014336, 0.04289894178509712, 0.010820798575878143, -0.01771674118936062, 0.01405262853950262, -0.015328892506659031, 0.008796616457402706, 0.0016356422565877438, -0.0279680248349905, 0.002725784434005618, -0.03513156995177269, -0.028050363063812256, 0.024797948077321053, -0.0075958301313221455, 0.0011201619636267424, 0.006769002880901098, 0.01896555908024311, 0.006621477659791708, 0.030767571181058884, 0.01682472974061966, -0.0194870438426733, 0.008782892487943172, -0.01741482876241207, 0.0014692476252093911, -0.0005622252356261015, 0.02220425009727478, 0.008762307465076447, -0.008378056809306145, -0.0324692577123642, 0.02564879134297371, -0.017044302076101303, 0.00975724495947361, 0.007142961956560612, 0.021353408694267273, 0.000589671777561307, 0.017744187265634537, -0.03159096837043762, -0.030246086418628693, -0.014917194843292236, 0.0018938112771138549, -0.010971754789352417, 0.041773632168769836, 0.03817813843488693, 0.013908534310758114, 0.010038572363555431, -0.0002813270257320255, -0.007650723215192556, 0.010827659629285336, -0.03134394809603691, -0.015150490216910839, 0.02026926912367344, -0.011753981001675129, -0.03905642777681351, -0.0017076893709599972, 0.01962427608668804, -0.00756838358938694, -0.002453034510836005, 0.035213910043239594, 0.009304377250373363, 0.022670842707157135, 0.013043968006968498, -0.01775791123509407, -0.00605196226388216, 0.010573779232800007, -0.01958310604095459, 0.004978116136044264, 0.01005229540169239, -0.02416667900979519, -0.011609886772930622, 0.0052422890439629555, -0.01989874243736267, 0.006154886446893215, -0.006398474797606468, -0.013970288448035717, -0.0011553277727216482, 0.00029183391598053277, -0.0026159982662647963, -0.03150862827897072, 0.08360216021537781, 0.0005206265486776829, -0.014930917881429195, 0.0022300314158201218, -0.020571181550621986, 0.020571181550621986, -0.0026194292586296797, -0.00040590859134681523, -0.028160149231553078, 0.01065611932426691, -0.01315375417470932, 0.0007856572046875954, -0.010196389630436897, 0.006082839332520962, 0.01930864155292511, -0.004484078381210566, -0.027913130819797516, 0.002531943377107382, -0.0025010660756379366, -0.026568250730633736, 0.017661849036812782, 0.02400199882686138, -0.0509682260453701, 0.01816960982978344, -0.004439477808773518, -0.026499634608626366, -0.011349144391715527, 0.008947571739554405, -0.03719006106257439, 0.0021596995647996664, 0.01125994324684143, -0.026979949325323105, -0.03817813843488693, -0.020639797672629356, -0.010505163110792637, 0.009798415005207062, -0.06806741654872894, 0.011534408666193485, 0.0008997318800538778, -0.00032228243071585894, 0.03145373612642288, -0.028599293902516365, 0.002566251438111067, 0.017812805250287056, -0.016769835725426674, 0.0006728690932504833, -0.0007775090052746236, -0.024852842092514038, 0.004144427366554737, -0.008762307465076447, -0.015534741804003716, 0.006072546821087599, 0.008391779847443104, -0.013023382984101772, 0.000681017292663455, 0.0006402762955985963, 0.0017179818823933601, 0.01586410030722618, 0.02571740746498108, -0.03795856609940529, -0.012783225625753403, 0.012975351884961128, -0.007733062840998173, 0.02147691696882248, 0.037217509001493454, -0.02124362252652645, 0.019981080666184425, 0.015054427087306976, 0.011362867429852486, 0.050803545862436295, -0.0030791587196290493, 0.018814602866768837, -0.0011647625360637903, 0.030767571181058884, 0.033951371908187866, -0.005019286181777716, -0.008131037466228008, 0.030163748189806938, -0.012467591091990471, 0.023645194247364998, -0.01338018849492073, -0.002272916492074728, -0.01392911933362484, 0.0076438612304627895, 0.009613150730729103, 0.0095308106392622, 0.01789514347910881, 0.0072733331471681595, -0.004484078381210566, 0.0055785090662539005, -0.03510412573814392, 0.022396376356482506, 0.025470389053225517, 0.0026657450944185257, 0.004799713846296072, -0.023631470277905464, 0.04114236310124397, -0.02295903116464615, -0.010731597431004047, 0.005101625807583332, -0.024180401116609573, -0.03164586052298546, 0.047702085226774216, 0.008028113283216953, -0.02475677989423275, 0.013373326510190964, -0.04075811058282852, -0.011088402010500431, 0.015768038108944893, 0.0020704984199255705, -0.0003915420384146273, -0.0007393411942757666, 0.0030791587196290493, 0.015973886474967003, -0.005952468607574701, -0.007142961956560612, -0.056183066219091415, 0.011623609811067581, -0.014821131713688374, -0.03716261684894562, 0.01855386048555374, 0.002207731129601598, -0.007870295085012913, -0.0012393827782943845, 0.004058657214045525, 0.009359270334243774, 0.015438678674399853, -0.027679836377501488, 0.0037361602298915386, 0.01941842772066593, 0.00156874128151685, -0.0036435280926525593, 0.017799081280827522, -0.0045835720375180244, 0.025882087647914886, 0.008885817602276802, -0.003504580119624734, -0.004720804747194052, -0.041718740016222, -0.005238858517259359, -0.03093225136399269, -0.03082246519625187, -0.0008015247294679284, -0.0024581807665526867, -0.004264506045728922, 0.011699087917804718, -0.008007528260350227, 0.021147558465600014, 0.022849244996905327, -0.013208647258579731, 0.01458783634006977, -0.016852175816893578, 0.014505496248602867, 0.013140031136572361, -0.00018805167928803712, -0.0173050444573164, 0.0014460895908996463, -0.012755779549479485, 0.02699367143213749, 0.02006342075765133, 0.03224968537688255, -0.022780628874897957, -0.008350609801709652, -0.00590443704277277, 0.03054799884557724, 0.004823729395866394, -0.0127214714884758, -0.008281993679702282, -0.008727999404072762, -0.022945307195186615, -0.0389740876853466, 0.02293158508837223, 0.008638798259198666, -0.01751089282333851, 0.0007702185539528728, -0.006669509224593639, -0.0072733331471681595, -0.014080074615776539, -0.000778795569203794, -0.0004901780630461872, -0.004346845671534538, -0.022396376356482506, 0.019528213888406754, -0.007410565856844187, 0.0045183864422142506, -0.0014984095469117165, 0.004871760960668325, 0.01848524436354637, -0.0011484661372378469, -0.017977483570575714, -0.01764812506735325, -0.003828792367130518, -0.010333622805774212, -0.02430391125380993, -0.0030362734105437994, -0.0009589134715497494, -0.00171969726216048, -0.03428072854876518, -0.03172820061445236, 0.02710345759987831, -0.02592325769364834, -0.022286590188741684, 0.023398175835609436, 0.004964393097907305, 0.025154754519462585, 0.00038832565769553185, 0.002948787761852145, -0.035076677799224854, 0.000746202829759568, 0.029120778664946556, 0.03809579834342003, -0.0024375957436859608, -0.02206701785326004, 0.011266804300248623, 0.011644194833934307, -0.016467923298478127, 0.00011439632362453267, -0.009503364562988281, -0.0036915596574544907, 0.006889081560075283, -0.005609386600553989, -0.0006964559433981776, 0.0030105423647910357, -0.02585464157164097, -0.03968769684433937, 0.026074213907122612, 0.0025044968351721764, -0.005269735585898161, 0.006456798408180475, 0.020859370008111, 0.025593899190425873, 0.00794577319175005, -0.028626741841435432, 0.006782726384699345, 0.021600427106022835, 0.010059157386422157, 0.007849710062146187, -0.018567584455013275, -0.01230977289378643, -0.0018114716513082385, -0.03175564855337143, 0.001220513368025422, 0.004590434022247791, 0.008007528260350227, 0.014381987042725086, 0.06345640122890472, 0.005420691799372435, -0.0035989275202155113, -0.03348477929830551, -0.004439477808773518, 0.02824248932301998, 0.033951371908187866, -0.003667543875053525, -0.028009194880723953, 0.0076095531694591045, 0.005839251447468996, 0.014944640919566154, -0.03137139603495598, 0.03848005086183548, 0.033978816121816635, -0.04967823624610901, -0.01764812506735325, 0.02131223864853382, 0.02316487953066826, -0.005355506204068661, -0.004484078381210566, -0.024386251345276833, -0.0022557624615728855, -0.02306881733238697, -0.028489507734775543, -0.018361736088991165, -0.007492905482649803, -0.03260648995637894, -0.011074678972363472, 0.01241269800812006, 0.014272200874984264, 0.002185430843383074, 0.00536922924220562, 0.022533608600497246, -0.016673773527145386, 0.04355765879154205, -0.03551582247018814, -0.03697048872709274, 0.014972087927162647, 0.007856572046875954, -0.011657917872071266, -0.010608087293803692, 0.01989874243736267, 0.008055559359490871, 0.012392112985253334, 0.022080741822719574, -0.03979748487472534, 0.009023049846291542, -0.029505031183362007, -0.020022250711917877, -0.024084338918328285, 0.011870628222823143, -0.034390516579151154, 0.0038219306152313948, 0.01978895626962185, 0.02881886623799801, 0.010573779232800007, -0.00328843854367733, -0.0437772311270237, 0.02168276719748974, -0.002628006273880601, -0.021010326221585274, 0.031426288187503815, 0.009263207204639912, 0.023974552750587463, 0.01937725767493248, 0.01412124466150999, -0.0069611286744475365, -0.01958310604095459, -0.04438105598092079, 0.03510412573814392, -0.003959163557738066, 0.03488455340266228, -0.0035954967606812716, 0.03230457752943039, -0.002907617948949337, 0.02612910605967045, 0.02165531925857067, 0.04062087833881378, 0.006487675942480564, 0.011850044131278992, -0.01582293026149273, -0.020159482955932617, -0.016769835725426674, 0.001069557387381792, 0.0062681036069989204, -0.01941842772066593, -0.023713810369372368, 0.01579548418521881, 0.018677370622754097, -0.011431483551859856, 0.0026348677929490805, 0.03082246519625187, 0.01006601843982935, -0.027089735493063927, 0.003602358279749751, 0.004038072191178799, 0.005098194815218449, -0.020543735474348068, -0.02537432685494423, 0.01869109459221363, 0.0019830125384032726, 0.003365631913766265, -0.02309626340866089, 0.0020962294656783342, 0.022327760234475136, 0.024111784994602203, -0.012021584436297417, -0.0008894394268281758, 0.018979283049702644, 0.0044806478545069695, 0.035982415080070496, -0.021833723410964012, -0.02758377231657505, 0.012151955626904964, -0.007794817443937063, -0.009304377250373363, 0.031289055943489075, -0.0019624275155365467, 0.010820798575878143, -0.01657770946621895, 0.002128822263330221, 0.013682099990546703, 0.007053760811686516, -0.02407061494886875, -0.015562187880277634, 0.049046967178583145, 0.014272200874984264, 0.019336087629199028, -0.020186930894851685, -0.03282606229186058, -0.023013923317193985, -0.00908480491489172, 0.00793205015361309, 0.018087269738316536, 0.03996216133236885, -0.01976150833070278, -0.01782652735710144, -0.0035954967606812716, 0.034911997616291046, 0.01406635157763958, -0.01703057810664177, 0.019226301461458206, 0.0012488175416365266]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"1:t−1)
q(sk
t|sk
1:t−1)ϕ(sk
1:t)
ψt−1(sk
1:t−1)
end if
end for
ift < T then
fork= 1, ..., K do
ωk
t∼catn
wi
tPK
j=1wj
toK
i=1
sk
1:t←sωk
t
1:t
end for
end if
end for
return
sk
1:T, wk
T	K
k=1
ˆZSMC
σ=QT
t=11
KPK
k=1wk
t
2.2. Sequential Monte Carlo
SMC improves inference by decomposing it into easier
subproblems involving a set of unnormalized intermediate
target distributions {˜πt(s1:t)}T
t=1. A key observation is that
as long as πT(s1:T) = σ(s1:T), we obtain an unbiased
estimate of the partition function ZT=Zσ, regardless of
the intermediate πtand proposal q.
We begin by defining the incremental importance weights
wt(s1:t):=˜πt(s1:t)
˜πt−1(s1:t−1)q(st|s1:t−1). (6)
where ˜πtis the unnormalized density of πt= ˜πt/Zt.
SMC maintains a set of Kpartial sequences, by first sam-
pling from the proposal q(sk
t|sk
1:t−1)in each index k. Op-
tional resampling steps may be performed to clone se-
quences with high incremental importance weights using
sk
1:t←sωk
t
1:t, ωk
t∼cat wt(si
1:t)PK
j=1wt(sj
1:t)K
i=1!
,(7)
similarly to Eq. (5). Since resampling is performed with
replacement, sequences with high weights may be cloned
multiple times. The resulting sωk
t
1:tare used as prefixes for
the next step of proposal sampling in index k(see Alg. 1).
We can show that SMC yields an unbiased estimator ˆZSMC
σ
of the normalization constant Zσ, by considering the ex-
tended state space S:={sk
t, ωk
t}K,T
k,t=1of token and in-dex random variables from the sampling procedure S∼
qSMC(S)in Alg. 1. Assuming resampling at every step,1
Zσ=Eh
ˆZSMC
σi
=EqSMC(S)""TY
t=11
KKX
k=1wt 
sk
1:t#
.(8)
To see that ˆZSMC
σ is unbiased, we can view Eq. (8)
as performing simple importance sampling Zσ=
EqSMC(S)h
˜σSMC(S)
qSMC(S)i
in the extended state space, for appropri-
ate definitions of σSMC(S)andqSMC(S)detailed in App. F
or (Andrieu et al., 2010; Maddison et al., 2017). Intu-
itively, we may view the average incremental importance
weights at each step as estimating the partition function ratio
Zt/Zt−1≈1
KPK
k=1wt(sk
1:t). Eq. (8) composes interme-
diate partition function ratio estimators to obtain an estimate
of the final ZT=Zσ=QT
t=1Zt/Zt−1, withZ0= 1.
With no resampling, SMC reduces to SIS with target
σ(s1:T) =πT(s1:T)and proposal q(s1:T). Using the final-
step SMC weights, we may estimate expectations or draw
approximate samples sσ
1:Tas in Eq. (4)-(5).
1The decision to resample may be based on an adaptive con-
dition such as Effective Sample Size ( ESS) (Chopin et al., 2020).
ForR≤T, let{tr}R
r=1index times where resampling oc-
curs and fix t0= 0 andtR=T. The estimator becomes
ˆZSMC
σ=QR
r=11
KPK
i=1Qtr
t=tr−1+1wt 
si
1:t
, and the final-
","[0.06657674908638, -0.0056926594115793705, 0.0165240615606308, 0.045674748718738556, -0.019500527530908585, -0.008328767493367195, 0.010631191544234753, 0.019674044102430344, -0.030004920437932014, 0.011225149966776371, 0.01763189397752285, 0.013354058377444744, -0.05368318036198616, 0.034195996820926666, 0.0352637879550457, -0.0038974361959844828, -0.011845803819596767, -0.012079382315278053, -0.0038073414471000433, 0.005292237736284733, -0.009349842555820942, -0.0003658017376437783, 0.027388831600546837, 0.011705655604600906, -0.02180962637066841, -0.021302424371242523, 0.01244643609970808, -0.014415174722671509, 0.022356867790222168, -0.017338251695036888, 0.048451006412506104, -0.0336621031165123, -0.009857043623924255, -0.04575483500957489, -0.034382861107587814, 0.08793256431818008, -0.026467863470315933, 0.006370039191097021, -0.03980189934372902, 0.02006111852824688, 0.006276607513427734, -0.004991921596229076, -0.046609066426754, 0.024452408775687218, 0.023024238646030426, 0.010531086474657059, -0.0096167903393507, -0.061237797141075134, 0.03606463223695755, 0.04596839100122452, -0.019046716392040253, 0.009369864128530025, -0.03641166538000107, -0.001161222462542355, -0.010798034258186817, -0.02588057890534401, 0.013387426733970642, 0.002192307962104678, 0.004738321527838707, 0.0031983668450266123, 0.036331579089164734, -0.03382227197289467, 0.007527924608439207, 0.01829926297068596, -0.027041800320148468, -0.008936073631048203, 0.008215314708650112, 0.03408921882510185, -0.035851072520017624, 0.03523709252476692, -0.04837092012166977, 0.023050932213664055, 0.02666807360947132, -0.007120829541236162, -0.03833368793129921, 0.008442220278084278, -0.030512120574712753, 0.01587004028260708, -0.004825079347938299, -0.029364245012402534, -0.006847207900136709, -0.030805762857198715, 0.04431331530213356, -0.02880365587770939, -0.01955391839146614, -0.05365648493170738, -0.023264490067958832, -0.0067504397593438625, -0.03448963910341263, 0.002133913105353713, -0.04740990698337555, 0.0530158095061779, -0.036972254514694214, 0.003270109184086323, 0.05125395581126213, -0.026321042329072952, 0.02250368893146515, -0.0005843651597388089, 0.02311766892671585, 0.013167194090783596, 0.028750265017151833, -0.031766775995492935, -0.016417281702160835, -0.04172392189502716, 0.052668776363134384, -0.005706006661057472, -0.02992483600974083, 0.010858097113668919, -0.03942817449569702, -0.008929399773478508, 0.014134880155324936, -0.011939235031604767, -0.03545065224170685, 0.04086969047784805, 0.00793502014130354, -4.259692650521174e-05, -0.016937831416726112, 0.007781525142490864, -0.021302424371242523, 0.026000704616308212, 0.008188620209693909, 0.0016759309219196439, 0.0014398490311577916, 0.016564104706048965, 0.01197927724570036, -0.00842219963669777, 0.03400913625955582, -0.05744714289903641, -0.03446294739842415, 0.04268493503332138, 0.023905165493488312, -0.0045848265290260315, -0.01156550832092762, -0.01986090838909149, -0.011205129325389862, -0.0247193556278944, 0.0031099405605345964, 0.022063225507736206, -0.0001383748312946409, 0.018552863970398903, -0.015256060287356377, -0.015576397068798542, -0.021249035373330116, 0.02020793966948986, -0.02426554448902607, -0.030458731576800346, -0.03491675853729248, 0.03400913625955582, -0.04225781932473183, -0.0011895856587216258, -0.0019370390800759196, -0.05256199836730957, -0.021863015368580818, -0.011211803182959557, 0.028403233736753464, -0.06865894794464111, -0.04151036590337753, 0.04399297758936882, 0.01599016599357128, -0.015229365788400173, -0.016897788271307945, 0.06438778340816498, -0.01400140579789877, -0.005569195840507746, -0.01712469384074211, -0.008962768130004406, -0.04986582696437836, 0.027255358174443245, -0.04975904896855354, -0.02491956576704979, -0.007894977927207947, -0.04791710898280144, -0.01990094967186451, -0.053442925214767456, 0.018686337396502495, -0.01779206283390522, -0.028723571449518204, -0.04399297758936882, -0.006383386440575123, -0.01729821041226387, -0.0005343124503269792, 0.021235687658190727, 0.001140367123298347, -0.003647172823548317, 0.004608184564858675, 0.005832806695252657, -0.009810327552258968, 0.00573937501758337, 0.02928416058421135, -0.028750265017151833, -0.0007416140288114548, 0.046982791274785995, 0.036011241376399994, -0.01809905283153057, -0.027735864743590355, -0.026708116754889488, 0.040015459060668945, 0.07437162846326828, 0.011518792249262333, 0.007861609570682049, 0.0068739028647542, -0.007928346283733845, -0.0010936512844637036, -0.004831753205507994, -0.010577801614999771, 0.021222341805696487, 0.007014050614088774, 0.02909729816019535, -0.057180192321538925, 0.009116263128817081, 0.004671584349125624, 0.001286354148760438, 0.07159537076950073, 0.005712680518627167, -0.03635827451944351, 0.020488234236836433, -0.07180892676115036, 0.018552863970398903, -0.022730594500899315, 0.055044613778591156, 0.02055497094988823, 0.015589744783937931, 0.0316866897046566, 0.008275378495454788, -0.023384617641568184, 0.03312820941209793, 0.031152794137597084, -0.024479102343320847, 0.03363540768623352, -0.03216719627380371, 0.02848331816494465, 0.05712680518627167, 0.0156564824283123, -0.03430277854204178, -0.05453741177916527, -0.01972743310034275, -0.036118023097515106, -0.01278679445385933, -0.03398244082927704, -0.07602670043706894, -0.006279944442212582, 0.03136635199189186, 0.014028101228177547, 0.003026519436389208, -0.01432174351066351, 0.01582999713718891, -0.010230770334601402, -0.022423606365919113, -0.023104321211576462, 0.005972954444587231, -0.0014231648528948426, -0.007461187895387411, -0.01098489761352539, 0.02379838563501835, -0.03208710998296738, -0.013787847943603992, 0.004271163139492273, 0.016243766993284225, 0.0027595716528594494, 0.01156550832092762, -0.04076291248202324, -0.05920899659395218, -0.049572184681892395, -0.009376537054777145, 0.001735159894451499, -0.018966633826494217, 0.0045848265290260315, 0.000197186745936051, 0.052802253514528275, 0.003128293203189969, -0.00954337976872921, -0.004855111241340637, -0.009022831916809082, 0.0326743982732296, -0.026721462607383728, -0.028590096160769463, -0.02166280522942543, 0.06081068143248558, -0.05039972439408302, -0.004404636565595865, 0.014588691294193268, -0.0625191479921341, 0.03222058713436127, -0.004775026813149452, 0.021289078518748283, -0.023197753354907036, -0.00019405844795983285, 0.06748437136411667, 0.04177731275558472, -0.0482107512652874, 0.019460486248135567, -0.0024575870484113693, 0.0025476820301264524, -0.015723219141364098, -0.0071408506482839584, -0.012406393885612488, -0.0030064983293414116, 0.002027133945375681, -0.00631331279873848, 0.010023885406553745, 0.07634703814983368, -0.00809518899768591, 0.010571128688752651, -0.012760099023580551, 0.0010077274637296796, 0.007661398500204086, -0.012653320096433163, 0.002078855177387595, -0.04004215449094772, 0.034356165677309036, -0.0045514581725001335, -0.024492450058460236, -0.013080436736345291, 0.008635757490992546, 0.04495399072766304, -0.04151036590337753, 0.04978574439883232, -0.04062943905591965, 0.021275730803608894, -0.04321882873773575, -0.008302072994410992, -0.01748507283627987, -0.006860555615276098, -0.005539164412766695, 0.020621709525585175, -0.03715911880135536, -0.026894979178905487, -0.008088515140116215, -0.011779066175222397, -0.013867932371795177, 0.036278191953897476, 0.014375132508575916, 0.028563402593135834, 0.018552863970398903, 0.0047483318485319614, -0.03996206820011139, 0.00480839516967535, 0.040202319622039795, -0.012766772881150246, 0.04626203328371048, -0.06844538450241089, -0.000529724289663136, -0.04703618213534355, -0.035664211958646774, 0.05039972439408302, 0.006406744476407766, 0.011712329462170601, 0.023718301206827164, 0.08189954608678818, -0.018032316118478775, 0.01416157465428114, 0.024505797773599625, 0.04207095503807068, -0.03262100741267204, 0.04097646847367287, -0.02473270334303379, 0.024345628917217255, -0.043912895023822784, -0.029471024870872498, -0.016564104706048965, -0.01616368256509304, 0.01684439927339554, 0.054937832057476044, -0.021742889657616615, -0.008201967924833298, 0.03814682364463806, -0.04906498268246651, 0.0068672290071845055, -0.04113663733005524, -0.00708078732714057, -0.020274676382541656, 0.0048918165266513824, 0.005075342953205109, 0.012486478313803673, -0.04770355299115181, -0.0010786354541778564, -0.011852476745843887, 0.04802388697862625, 0.03606463223695755, 0.027896033599972725, 0.029711278155446053, -0.0010719618294388056, 0.008308746851980686, -0.05090692266821861, 0.021395856514573097, 0.0012521514436230063, 0.005615911912173033, 0.001188751426525414, -0.026387779042124748, 0.00448472099378705, -0.005389006342738867, 0.00297146150842309, -0.009763611480593681, 0.023838428780436516, 0.01875307410955429, -0.00889603141695261, -0.029631193727254868, 0.04268493503332138, 0.03862733021378517, 0.03334176540374756, -0.03654513880610466, 0.012366351671516895, -0.02813628688454628, -0.0424179881811142, -0.027415527030825615, 0.02247699536383152, -0.012179488316178322, 0.033234987407922745, 0.013594310730695724, 0.055898845195770264, 0.03408921882510185, -0.05290903151035309, 0.025279946625232697, 0.0058561647310853004, 0.04124341905117035, -0.03286125883460045, -0.0404425747692585, 0.023571480065584183, 0.0326743982732296, 0.06230558827519417, -0.02426554448902607, -0.024385670199990273, 0.0136543745175004, -0.016590798273682594, -0.007581314072012901, 0.002335792174562812, 0.013934669084846973, -0.03854724392294884, 0.019967686384916306, -0.027415527030825615, 0.02022128738462925, 0.03352862969040871, 0.022450299933552742, 0.007334387861192226, -0.02135581523180008, 0.004921847954392433, 0.043726030737161636, -0.034516334533691406, 0.010464348830282688, -0.024172112345695496, -0.011412013322114944, 0.025987356901168823, -0.023184405639767647, -0.005182121880352497, -0.003453635610640049, -0.02489287219941616, -0.003670530626550317, -0.06145135685801506, 0.009643484838306904, 0.0012246224796399474, 0.01042430754750967, -0.05664629861712456, 0.06924623250961304, 0.004264489281922579, -0.016083598136901855, -0.07143519818782806, 0.0657225176692009, -0.025760451331734657, 0.03270108997821808, -0.029150687158107758, 0.014682122506201267, 0.013293994590640068, 0.024999650195240974, 0.04367263987660408, 0.016564104706048965, 0.015229365788400173, 0.026641378179192543, 0.008235336281359196, 0.027442222461104393, 0.03555743023753166, -0.002722866367548704, -0.06310643255710602, 0.026467863470315933, 0.003927467856556177, 0.002005444373935461, -0.00858236849308014, 0.08200632780790329, -0.034649807959795, -0.013160521164536476, 0.007721461821347475, 0.04092308133840561, -0.06075729429721832, 0.03123287856578827, 0.055044613778591156, 0.027762558311223984, 0.06321321427822113, 0.034356165677309036, 0.009416579268872738, 0.0010511064901947975, 0.028883740305900574, -0.01748507283627987, -0.01729821041226387, 0.03251422941684723, -0.014909028075635433, 0.003176677506417036, -0.045621357858181, 0.030138393864035606, -0.01302704680711031, -0.045834917575120926, 0.004007552284747362, 0.029150687158107758, 0.0068805767223238945, -0.020261328667402267, 0.05851493403315544, 0.0010294170351698995, 0.012406393885612488, 0.022383563220500946, 0.0028880401514470577, 0.032273974269628525, 0.035183705389499664, -0.03545065224170685, 0.004110994283109903, 0.023651564493775368, 0.005599227733910084, 0.000783741706982255, 0.004468036815524101, 0.0003918708534911275, -0.045995086431503296, 0.016897788271307945, 0.00659360783174634, 0.0068739028647542, -0.0023307870142161846, -0.022263437509536743, -0.005655954126268625, 0.02295750007033348, -0.04399297758936882, 0.0059362491592764854, -0.11115701496601105, -0.012720056809484959, -0.03334176540374756, -0.010784686543047428, -0.026147525757551193, -0.010471022687852383, 0.026107484474778175, -0.0055958908051252365, 0.014108184725046158, -0.0282964538782835, 0.0009334826609119773, 0.019981034100055695, 0.02183631993830204, -0.016857746988534927, -0.022850722074508667, -0.0008959431434050202, -0.015229365788400173, -0.02265051193535328, -0.023237796500325203, 0.017578504979610443, 0.0038507203571498394, -0.0031299616675823927, -0.022757289931178093, -0.022049879655241966, 0.00014066891162656248, 0.028056202456355095, -0.031286269426345825, -0.0136543745175004, 0.002497629262506962, -0.011038286611437798, 0.04209765046834946, 0.0014089832548052073, -0.01358763687312603, 0.024038638919591904, 3.9234011637745425e-05, -0.0026978401001542807, -0.017992274835705757, -0.020635055378079414, 0.01699122041463852, 0.023518091067671776, 0.0005776914767920971, 0.026107484474778175, 0.04895820468664169, -0.03136635199189186, 0.009156305342912674, 0.02732209488749504, -0.04092308133840561, -0.02375834435224533, -0.018352653831243515, 0.008135230280458927, -0.04337899759411812, -0.022410258650779724, 0.008442220278084278, -0.03222058713436127, 0.011912540532648563, 0.004127678461372852, -0.037746403366327286, -0.03673200309276581, 0.023344574496150017, -0.0009309800225310028, 0.026240957900881767, -0.026708116754889488, 0.005065332166850567, 0.014255006797611713, 0.009316474199295044, -0.005375659093260765, 0.0034085882361978292, -0.03603793680667877, 0.042284514755010605, 0.0017685283673927188, 0.023224448785185814, -0.03155321627855301, -0.013013700023293495, 0.04062943905591965, 0.014949070289731026, -0.01213944610208273, -0.04191078618168831, -0.05883526802062988, 0.0520281046628952, -0.03358202055096626, 0.014828943647444248, 0.011105023324489594, 0.01262662559747696, 0.0123596778139472, 0.021956447511911392, -0.005492448806762695, -0.0025743767619132996, -0.005679312162101269, -0.01809905283153057, 0.023571480065584183, -0.022089920938014984, 0.052161578088998795, 0.00432121567428112, -0.01043098047375679, -0.02119564637541771, 0.01748507283627987, -0.019967686384916306, 0.00035036884946748614, 0.022063225507736206, 0.016764314845204353, -0.017898842692375183, 0.004558131564408541, -0.003587109502404928, 0.0056292591616511345, 0.00248595024459064, 0.0008458904922008514, 0.02327783778309822, 0.012239551171660423, -0.0065735867246985435, 0.012386372312903404, 0.04110994189977646, 0.048611171543598175, -0.021943099796772003, 0.044206537306308746, 0.0008292062557302415, 0.01470881700515747, -0.02909729816019535, -0.0029747982043772936, 0.03705233708024025, -0.023411311209201813, 0.03721250593662262, -0.019300317391753197, -0.02314436435699463, -0.03510361909866333, -0.035504043102264404, 0.0266947690397501, -0.04137689247727394, 0.03200702741742134, -0.017698630690574646, 0.051173869520425797, -0.018646296113729477, -0.025453461334109306, -0.0330481231212616, -0.02636108361184597, -0.0067504397593438625, -0.001885318080894649, 0.015069196932017803, 0.01237969845533371, 0.04676923528313637, 0.04740990698337555, 0.0262009147554636, -0.00610642833635211, 0.0025960663333535194, -0.009670180268585682, 0.03787987679243088, -0.008962768130004406, -0.013841237872838974, 0.03248753398656845, 0.034649807959795, -0.015523008070886135, -0.0228106789290905, 0.007354408502578735, 0.017525115981698036, -0.022076573222875595, 0.003620477858930826, -0.03844046592712402, -0.00038769980892539024, -0.01728486269712448, -0.016737619414925575, 0.04252476617693901, -0.03398244082927704, -0.012559888884425163, -0.011145065538585186, -0.020167898386716843, 0.00018373508646618575, 0.02395855449140072, -0.026975063607096672, -0.010617843829095364, -0.03248753398656845, -0.013787847943603992, 0.028429929167032242, 0.0014473570045083761, -0.005982964765280485, -0.002884703455492854, 0.014949070289731026, -0.03958834335207939, -0.008882684633135796, -0.041643839329481125, -0.015229365788400173, -0.05792764574289322, 0.026587989181280136, 0.02282402664422989, -0.03753284364938736, 0.017338251695036888, 0.009930454194545746, -0.018686337396502495, -0.000984369544312358, -0.0018285916885361075, -0.018179137259721756, 0.013073762878775597, 0.01875307410955429, 0.021609414368867874, -0.014094837941229343, -0.01462873350828886, 0.00545907998457551, -0.06353355199098587, 0.018366001546382904, 0.0036104675382375717, -0.030325256288051605, -0.04102985933423042, -0.022904111072421074, 0.00938321091234684, 0.017057957127690315, -0.009983843192458153, 0.026441168040037155, -0.0067838081158697605, -0.013814542442560196, -0.011178433895111084, 0.03318159654736519, -0.02503969334065914, 0.01587004028260708, -0.00831542070955038, -0.0016992888413369656, -0.009349842555820942, -0.01545627135783434, -0.04434001073241234, 0.019327012822031975, 0.042765017598867416, 0.011285213753581047, 0.011598876677453518, 0.02233017422258854, -0.020007729530334473, -0.02247699536383152, -0.013814542442560196, 0.011739024892449379, -0.016430629417300224, 0.022343521937727928, 0.022890763357281685, -0.015963472425937653, -0.011572182178497314, 0.0056926594115793705, -0.01518932357430458, 0.007547945715487003, 0.015082544647157192, -0.003128293203189969, -0.019126800820231438, 0.03411591425538063, 0.008882684633135796, -0.013087110593914986, -0.000507617718540132, -0.015910081565380096, -0.003830699250102043, 0.023050932213664055, -0.0025743767619132996, 0.01827256940305233, -0.016710925847291946, 0.011391992680728436, 0.048771340399980545, 0.013540921732783318, -0.004034246783703566, -0.02395855449140072, -0.011685634963214397, 0.016911135986447334, 0.004841763526201248, -0.03120618499815464, 0.00011355704191373661, -0.04030910134315491, -0.028429929167032242, -0.011859150603413582, -0.024505797773599625, 0.004805058240890503, -0.0016992888413369656, -0.04124341905117035, -0.012132772244513035, 0.011178433895111084, -0.021102214232087135, 0.019647348672151566, -0.023838428780436516, 0.00731436675414443, -0.0059028808027505875, -0.12642642855644226, -0.020741835236549377, 0.029657887294888496, 0.011645592749118805, 0.028910433873534203, -0.01828591711819172, 0.024679314345121384, -0.022210046648979187, 0.030992625281214714, -0.03521040081977844, -0.0274956114590168, 0.0013522568624466658, -0.003430277807638049, -0.0016233755741268396, 0.008902705274522305, -0.02022128738462925, -0.0179388839751482, 0.01277344673871994, -0.002319107996299863, -0.029204076156020164, -0.010531086474657059, 0.01569652371108532, 0.018486127257347107, 0.034195996820926666, -0.0205282773822546, -0.03053881600499153, -1.08903705040575e-05, 0.02152932994067669, 0.007701440714299679, -0.005685985554009676, 0.023531438782811165, 0.0055625224485993385, 0.01857955940067768, 0.03980189934372902, -0.04385950416326523, 0.015509660355746746, -0.015469618141651154, 0.013160521164536476, -0.008295399136841297, -0.01181910838931799, -0.004020899534225464, -0.053603094071149826, 0.04169723019003868, 0.008055146783590317, 0.019180191680788994, -0.07287672162055969, -0.0030448720790445805, -0.006243239156901836, -0.0009092905675061047, 0.016110293567180634, 0.0007979233050718904, 0.007334387861192226, -0.015616439282894135, 0.00764137739315629, 0.022904111072421074, -0.0023040922824293375, -0.025520198047161102, 0.017752021551132202, 0.019660696387290955, 0.04159044846892357, -0.047009486705064774, 0.02588057890534401, 0.05872849002480507, -0.0649750679731369, -0.03222058713436127, -0.011692308820784092, -0.003830699250102043, 0.005849491339176893, 0.0038573939818888903, 0.01906006410717964, -0.00266947690397501, 0.0017368283588439226, -0.003420267254114151, 0.00615314394235611, -0.0032734458800405264, 0.004241131246089935, -0.010457675904035568, 0.01779206283390522, -0.03622480109333992, -0.002527660923078656, -0.005375659093260765, -0.07543941587209702, 0.028243064880371094, -0.035690903663635254, -0.02979136072099209, -0.01796557940542698, 0.0055625224485993385, 0.015256060287356377, 0.005519143305718899, 0.05723358318209648, 0.02395855449140072, -0.012079382315278053, 0.028696876019239426, -0.009503337554633617, -0.009803653694689274, -0.01844608411192894, -0.012813488952815533, -0.0019153496250510216, 0.011692308820784092, 0.012740078382194042, 0.033715493977069855, 0.01922023296356201, 0.028056202456355095, -0.05931577458977699, -0.010257464833557606, -0.004257815424352884, -0.03619810566306114, 0.007247629575431347, 0.018152441829442978, -0.013580963015556335, 0.007234282325953245, -0.018526168540120125, -0.03182016313076019, 0.006293291691690683, 0.007721461821347475, 0.03609132766723633, 0.03507692739367485, 0.007267650682479143, 0.0009259748039767146, -0.02215665765106678, -0.008849315345287323, 0.014775554649531841, -0.0012579909525811672, 0.0019420443568378687, -0.01342079509049654, 0.020608361810445786, -0.006523534189909697, 0.04409975931048393, -0.0005363980308175087, -0.009550053626298904, 0.03270108997821808, 0.02231682650744915, 0.047142960131168365, 0.004518089350312948, -0.010257464833557606, 0.024839481338858604, 0.002576045226305723, -0.0009209695272147655, -0.03513031452894211, 0.01587004028260708, -0.019006675109267235, -0.014134880155324936, 0.0066069550812244415, 0.036144714802503586, -0.005559185519814491, -0.012573235668241978, -0.0030932563822716475, -0.023171059787273407, 0.013013700023293495, 0.0228106789290905, 0.03136635199189186, -0.008956095203757286, 0.01924692839384079, -0.001913681160658598, -0.01140533946454525, 0.0026344398502260447, -0.021249035373330116, -0.03328837454319, 0.0032951354514807463, 0.0030832458287477493, 0.0420442596077919, 0.06097085028886795, 0.018846506252884865, -0.011732351034879684, -0.018552863970398903, 0.006410081405192614, -0.03328837454319, -0.00736108236014843, 0.006677029188722372, 0.025319987908005714, 0.02362487092614174, -0.03868072107434273, -0.005098700989037752, 0.022383563220500946, 0.043565861880779266, -0.0282964538782835, -0.002561029279604554, -0.01010396983474493, 0.00780154624953866, -1.603250166226644e-05, 0.01600351370871067, 0.019327012822031975, -0.028883740305900574, 0.027522306889295578, 0.021729541942477226, -0.028429929167032242, 0.012046013958752155, 0.001339743728749454, -0.02184966765344143, 0.024011943489313126, 0.0029113981872797012, 0.01620372384786606, -0.016617493703961372, 0.041163332760334015, -0.036972254514694214, 0.05077344924211502, -0.030138393864035606, -0.0003315990907140076, -0.006987355649471283, -0.006677029188722372, -0.0065101864747703075, 0.07026062905788422, 0.00048175716074183583, -0.023678259924054146, 0.0014306727098301053, 0.036304883658885956, -0.04097646847367287, 0.007581314072012901, -0.018993327394127846, -0.005489111877977848, -0.009089568629860878, -0.005142079666256905, 0.00545907998457551, 0.026628032326698303, -0.018833158537745476, -0.07506568729877472, -0.006490165367722511, 0.019140148535370827, -0.03294134512543678, -0.03288795426487923, -0.014855639077723026, -0.029497718438506126, -0.005495785269886255, 0.03555743023753166, -0.048290837556123734, -0.015216018073260784, -0.024492450058460236, 0.013854584656655788, -0.03280787169933319, 0.012019319459795952, 0.004951879382133484, 0.03238075599074364, -0.002983140293508768, -0.043726030737161636, -0.01277344673871994, 0.011939235031604767, -0.01942044496536255, -0.011578856036067009, 0.0023474711924791336, -0.018552863970398903, 0.000984369544312358, 0.008548999205231667, -0.008755884133279324, 0.002095539355650544, 0.006096417549997568, -0.017872147262096405, 0.0374794565141201, 0.016123639419674873, -0.037105727940797806, -0.0282964538782835, -0.005625922232866287, 0.007708114571869373, 0.04610186442732811, -0.009343168698251247, 0.0029547770973294973, 0.012232877314090729, -0.010077275335788727, 0.032754480838775635, 0.036972254514694214, 0.004544784314930439, -0.025266598910093307, -0.036972254514694214, 0.012266245670616627, -0.014174922369420528, 0.00202046032063663, -0.049091678112745285, 0.015309449285268784, 0.023718301206827164, -0.03219389170408249, -0.03141974285244942, -0.028590096160769463, -0.009763611480593681, -0.002566034672781825, 0.03892097249627113, 0.027869338169693947, -0.008428873494267464, 0.003395240753889084, -0.008962768130004406, 0.003096593078225851, -0.0015499650035053492, -0.038066741079092026, 0.010317527689039707, -0.03812012821435928, -0.01599016599357128, 0.036438360810279846, -0.011705655604600906, 0.013080436736345291, -0.0020905339624732733, 0.046982791274785995, -0.013974711298942566, 0.051360733807086945, 0.011418687179684639, -0.016056902706623077, 0.01603020913898945, 0.005469090770930052, 0.002599403029307723, -0.01907341182231903, 0.02022128738462925, -0.004030909854918718, -0.024345628917217255, -0.010771338827908039, 0.0031483143102377653, -0.026574641466140747, -0.0047316476702690125, -0.005879522766917944, 0.01779206283390522, 0.0036772042512893677, 0.021569373086094856, -0.025012997910380363, -0.023037584498524666, 0.0033118196297436953, -0.01181243546307087, -0.021142257377505302, 0.0300850048661232, 0.042151037603616714, 0.026494557037949562, 0.01940709725022316, -0.0034069197718054056, -0.00873586256057024, 0.024492450058460236, -0.03283456340432167, -0.01553635485470295, 0.008515630848705769, -0.007541272323578596, -0.04172392189502716, 0.020127855241298676, 0.017525115981698036, -0.03542395681142807, -0.01582999713718891, 0.03296804055571556, 0.007481209002435207, 0.03171338513493538, 0.007020724005997181, 0.01970073953270912, -0.013040394522249699, 0.03593115881085396, -0.011999298818409443, -0.011085002683103085, -0.004875131882727146, -0.01390797458589077, -0.01927362196147442, 0.006119775585830212, -0.006279944442212582, -0.0150425024330616, -0.013540921732783318, 0.00047633476788178086, 0.01747172512114048, 0.004905163776129484, -0.004167720675468445, -0.03272778540849686, 0.07383772730827332, -0.00759466178715229, 0.007127503398805857, -0.023304533213377, 0.00432121567428112, 0.012132772244513035, 0.006823850329965353, 0.011171760968863964, -0.03040534071624279, 0.013447489589452744, -0.02104882523417473, -0.003205040702596307, -0.005842817481607199, -0.0014456885401159525, -0.009296453557908535, -0.0016817704308778048, -0.03670530766248703, 0.012526520527899265, -0.007708114571869373, -0.008188620209693909, 0.023224448785185814, -0.007494556251913309, -0.026240957900881767, 0.024545839056372643, 0.005695996340364218, -0.03320829197764397, -0.017725326120853424, 0.017578504979610443, -0.02023463509976864, 0.007928346283733845, 0.0028012823313474655, -0.01943379081785679, -0.029364245012402534, -0.020167898386716843, -0.006466807797551155, -0.014281701296567917, -0.04789041355252266, 0.0220098365098238, 0.02083526737987995, -0.006730418652296066, 0.04466034844517708, -0.012606604024767876, 0.025800494477152824, 0.010964876040816307, -0.016056902706623077, -0.013013700023293495, -0.008475588634610176, -0.018018968403339386, 0.005152090452611446, -0.0045347739942371845, -0.017031261697411537, 0.003974183462560177, 0.017525115981698036, -0.027268705889582634, 0.008909379132091999, 0.011845803819596767, 0.025279946625232697, 0.022223394364118576, 0.020087813958525658, -0.026641378179192543, -0.021769583225250244, -0.015803303569555283, -0.01488233357667923, 0.007721461821347475, 0.03157991170883179, -0.026814894750714302, 0.012659993954002857, 0.0067504397593438625, 0.005055321846157312, 0.03214050084352493, -0.006847207900136709, 0.011992624960839748, -0.02035476081073284, 0.042151037603616714, 0.024345628917217255, -0.010778012685477734, -0.0011069986503571272, 0.03238075599074364, -0.006893923971801996, 0.04757007583975792, -0.007961714640259743, 0.0048284162767231464, -0.02912399172782898, 0.0054023535922169685, 0.0009001142461784184, 0.02298419550061226, 0.013073762878775597, 0.01844608411192894, 0.011552160605788231, 0.018526168540120125, -0.0352637879550457, 0.0003493260592222214, 0.01568317599594593, -0.00848226249217987, 0.005862838588654995, -0.04380611330270767, 0.029390940442681313, -0.024706007912755013, -0.009176326915621758, -0.006987355649471283, -0.02439901791512966, 0.0028563402593135834, 0.04070952162146568, -0.012906920164823532, -0.04070952162146568, 0.015482965856790543, -0.026654725894331932, -0.020261328667402267, 0.01416157465428114, -0.002514313440769911, -0.010457675904035568, 0.015763260424137115, 0.0005059493123553693, -0.008382157422602177, -0.017244819551706314, -0.007561292964965105, -0.04249807074666023, 0.029230771586298943, -0.00808184128254652, -0.023237796500325203, 0.027575695887207985, -0.0003130378609057516, -0.012386372312903404, -0.0013314015232026577, -0.018379347398877144, 0.0035904464311897755, -0.01302704680711031, -0.008041799068450928, -0.009416579268872738, 0.009710222482681274, -0.011271866038441658, -0.0026494557969272137, 0.01351422630250454, 0.006733755115419626, 0.01587004028260708, 0.019927645102143288, -0.006470144726336002, -0.00017518442473374307, -0.016070250421762466, 0.016724271699786186, -0.026481211185455322, -0.012092730030417442, -0.03171338513493538, -0.030351951718330383, -0.02377169206738472, 0.007200913969427347, -0.02359817549586296, 0.0016058571636676788, 0.03916122391819954, -0.02313101664185524, 0.0028630138840526342, 0.0048284162767231464, 0.015523008070886135, 0.01761854626238346, 0.0173249039798975, -0.04305865988135338, -0.005148753523826599, -0.012473130598664284, 0.036491747945547104, 0.02100878208875656, 0.036304883658885956, -0.025186514481902122, -0.021769583225250244, -0.005479101091623306, 0.039214614778757095, 0.006249912548810244, -0.02976466715335846, 0.008161925710737705, -0.00898278970271349, -0.03294134512543678, -0.024318933486938477, 0.014094837941229343, 0.002387513406574726, -0.03198033198714256, -0.02007446624338627, -0.000209387086215429, -0.016430629417300224, -0.010557780973613262, 0.0027695822063833475, 0.024212155491113663, -0.013761153444647789, -0.015175975859165192, 0.003139972221106291, -0.00020386044343467802, 0.014735512435436249, -0.0006289954762905836, -0.0011762382928282022, 0.021435899659991264, -0.003917457070201635, 0.005318932700902224, -0.004394626244902611, -0.0007812390686012805, -0.006416754797101021, -0.025947315618395805, 0.011745697818696499, -0.0003167918184772134, 0.007527924608439207, -0.016217071563005447, -0.019140148535370827, 0.019847560673952103, -0.0096167903393507, -0.00889603141695261, -0.01488233357667923, -0.009343168698251247, 0.03948156163096428, -0.00969020090997219, 0.003787320340052247, -0.03545065224170685, -0.014455216936767101, 0.02909729816019535, 0.04086969047784805, 0.005816122516989708, -0.012680014595389366, 0.03699894994497299, 0.004638215992599726, -0.021102214232087135, -0.011085002683103085, -0.009276431985199451, 0.011625572107732296, 0.005352301057428122, 0.006186512764543295, -0.00849561020731926, 0.007975062355399132, -0.03198033198714256, -0.029017213732004166, 0.0300850048661232, 0.004608184564858675, -0.015496312640607357, 0.014508606866002083, 0.014682122506201267, 0.021088866516947746, -0.013948016799986362, -0.007768177427351475, -0.0011528802569955587, 0.0488247312605381, 0.0163371991366148, 0.01828591711819172, -0.025960661470890045, -0.021622762084007263, -0.0005622585886158049, -0.047489993274211884, -0.012606604024767876, 0.016710925847291946, -0.0033635408617556095, 0.029337551444768906, 0.046502288430929184, 0.007561292964965105, -0.015202670358121395, -0.03331506997346878, 0.0005664296331815422, 0.01699122041463852, 0.03232736513018608, 0.010057253763079643, -0.055418338626623154, -0.007461187895387411, 0.004955216310918331, 0.039695121347904205, -0.042791713029146194, 0.04930523782968521, 0.030138393864035606, -0.03235406056046486, -0.0004946874105371535, 0.014441870152950287, 0.0022757290862500668, -0.012920267879962921, -0.004518089350312948, -0.018232526257634163, 0.011845803819596767, -0.01927362196147442, -0.008862663060426712, -0.009823674336075783, -0.0048284162767231464, -0.0021756235510110855, -0.01149209775030613, 0.040202319622039795, 0.01406814344227314, 0.0008312917780131102, -0.0014106517191976309, 0.015883387997746468, -0.014855639077723026, 0.03817351907491684, -0.024852829053997993, -0.021449247375130653, 0.0034135936293751, 0.0013580963714048266, -0.025827188044786453, -0.012166140601038933, 0.026254305616021156, 0.001885318080894649, -0.003221724880859256, 0.039214614778757095, -0.025266598910093307, 0.0027812612242996693, -0.042631544172763824, -0.03053881600499153, -0.030138393864035606, 0.017511768266558647, -0.05920899659395218, 0.020595014095306396, 0.016230419278144836, 0.00815525185316801, 0.02490621991455555, -0.00922304205596447, -0.040522657334804535, 0.02698841132223606, -0.010023885406553745, -0.01665753498673439, 0.01680435612797737, 0.026628032326698303, 0.02314436435699463, 0.025653673335909843, 0.013073762878775597, -0.01246645674109459, -0.020902004092931747, -0.03152652084827423, 0.013140499591827393, -0.002280734246596694, 0.011879172176122665, -0.011285213753581047, 0.051173869520425797, -0.00020678018336184323, 0.010691254399716854, 0.0131004573777318, 0.011205129325389862, 0.059262387454509735, 0.006743765901774168, -0.013127152808010578, -0.011218476109206676, -0.002609413582831621, -0.023664912208914757, 0.01416157465428114, -0.03302142769098282, -0.033074818551540375, 0.02104882523417473, 0.026160873472690582, -0.013881279155611992, -0.0018919917056337, 0.02004777081310749, 0.021435899659991264, -0.016136987134814262, 0.01318721566349268, 0.014441870152950287, 0.0016225413419306278, -0.02848331816494465, -0.027201969176530838, 0.01779206283390522, -0.015789955854415894, 0.010077275335788727, -0.03091254271566868, 0.014201616868376732, 0.009183000773191452, 0.030191782861948013, -0.017191430553793907, -0.007220935076475143, 0.01149209775030613, 0.0077147879637777805, 0.018526168540120125, -0.012433088384568691, -0.03844046592712402, 0.01828591711819172, 0.02068844623863697, -0.007374429609626532, 0.008869336917996407, 0.004297857638448477, 0.02375834435224533, -0.016377240419387817, -0.0030231825076043606, -0.00020062786643393338, 0.011605550535023212, -0.01648402027785778, -0.011618898250162601, 0.04169723019003868, 0.017378294840455055, 0.02362487092614174, -0.004271163139492273, -0.017017913982272148, -0.001281348871998489, -0.013554268516600132, 0.011625572107732296, 0.0213291198015213, 0.025813840329647064, 0.0022006500512361526, -0.008502284064888954, -0.002782929688692093, 0.012753426097333431, 0.019940992817282677, -0.00048008872545324266, 0.007628030143678188, 0.018632948398590088]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"step weights for expectations in Eq. (4) or sampling in Eq. (5) are
given byQT
t=tR−1+1wt 
si
1:t
.
3
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Fig. 2 illustrates the key advantage of SMC resampling over
SIS. While a suboptimal q(s1:T)may produce sequences
with low probability under the target σ(s1:T),SMC resam-
pling with well-chosen intermediate targets πtclones the
most promising partial sequences s1:tat step t. Since later
sampling proceeds from these prefixes, we expect to obtain
final sequences which better cover the high-probability re-
gions of the target distribution. We discuss techniques to
evaluate the quality of SMC or SIS sampling in Sec. 5.
3. Twisted Sequential Monte Carlo for
Language Modeling
A key design choice in the SMC procedure above is the in-
termediate targets {πt}T−1
t=1, where we assume πT(s1:T) =
σ(s1:T)is always the target distribution. In state-space
models with observation likelihoods or environments with
intermediate rewards, filtering SMC considers target infor-
mation collected from times τ≤tto define πt. (Chopin
et al., 2020). Previous work on SMC for language models
(Lew et al., 2023) has considered per-token or few-step-
ahead statistics to define tractable intermediate πt. However,
we are often interested in target distributions which are de-
termined by a terminal potential ϕ(s1:T)only, as in Eq. (1).
In such settings, twisted SMC methods (Briers et al., 2010;
Whiteley & Lee, 2014; Lawson et al., 2022) consider the
fulltarget information (until time T) to define {πt}T−1
t=1. In
other words, our desired intermediate targets are the true
marginals σ(s1:t)of the target distribution. Intuitively, note
that in order to exactly sample s1:T∼σ(s1:T), we need
to ensure partial sequences are distributed according to the
intermediate marginals s1:t∼σ(s1:t). In Sec. 3.1, we
will represent the intermediate targets {πt}T−1
t=1using twist
functions ψt:s1:t→Rwhich modulate the base model to
(approximately) match the target marginals, thereby sum-
marizing future information relevant to sampling at time t.
3.1. Twist Functions
We represent the intermediate target distributions {πt}T−1
t=1
for SMC sampling using the following general form.
Definition 3.1 (Twisted (Intermediate) Targets ).Using
approximate twist functions {ψt}T−1
t=1and the final target ϕ,
we define the twisted intermediate target distributions
πt(s1:t) =(1
Zψ
tp0(s1:t)ψt(s1:t) t̸=T
1
Zσp0(s1:T)ϕ(s1:T) t=T(9)
For an arbitrary proposal qand the unnormalized targets in
Eq. (9), the incremental importance weights are given by
wt(s1:t) =p0(st|s1:t−1)
q(st|s1:t−1)ψt(s1:t)
ψt−1(s1:t−1). (10)
While uninformed twist functions ψtmay result in πt(s1:t)which are no closer to the target marginal σ(s1:t)than the
base model p0(s1:t)(for example, in early stages of learn-
ing), the crucial fact is that our final target distribution in
Eq. (9) reflects the target potential ϕ(s1:T). As in Sec. 2.2,
this ensures that, regardless of the intermediate twists, our
resulting importance sampling estimators will be unbiased.
Finally, the optimal twists ψ∗
t(s1:t)recover the intermediate
marginals π∗
t(s1:t) =σ(s1:t)of the target distribution. We
state the sense in which π∗
tandψ∗
tare optimal in App. A.1,
and prove the following proposition in App. B Prop. B.1.
Proposition 3.2 (Optimal Twists ).For a given target dis-
tribution σ(s1:T)in Eq. (1","[0.023927485570311546, -0.04207432642579079, 0.03363506868481636, 0.008286812342703342, -0.03978157788515091, -0.010658829472959042, 0.0275617316365242, -0.007677040062844753, -0.04812327027320862, 0.003609855193644762, 0.02695195935666561, -0.01822001300752163, -0.06190413609147072, 0.008085587993264198, 0.021085944026708603, -0.01595165766775608, 0.009061223827302456, -0.008975856006145477, -0.018329771235585213, 0.026659268885850906, -0.023646989837288857, 0.00011337963223922998, -0.019817616790533066, 0.02146400325000286, -0.0015838849358260632, -0.02034202218055725, 0.02543972246348858, -0.004036696162074804, 0.019024912267923355, 0.014158925041556358, 0.03463509678840637, -0.02639096789062023, -0.047635454684495926, -0.04914769157767296, -0.010091740638017654, 0.0714653730392456, 0.0012713763862848282, 0.024464085698127747, -0.024110417813062668, 0.036659542471170425, 0.023903094232082367, -0.02641535922884941, -0.03409849479794502, 0.036683931946754456, 0.0005526066524907947, 0.03463509678840637, 0.021732304245233536, -0.02597632259130478, 0.0005648020887747407, 0.05346488207578659, -0.010817370377480984, 0.02090301178395748, -0.024049440398812294, 0.0017454747576266527, 0.005975773558020592, -0.012854010798037052, -0.0023689675144851208, -0.031732577830553055, 0.011238113045692444, -0.028537368401885033, 0.034439969807863235, -0.026634877547621727, -0.0014726014342159033, -0.002039690036326647, -0.023000631481409073, -0.008488037623465061, -0.012293020263314247, 0.024561649188399315, -0.06648962944746017, 0.02034202218055725, -0.028805667534470558, 0.01896393485367298, 0.0021098139695823193, 0.002044263295829296, -0.03314724937081337, 0.0035031449515372515, -0.011097865179181099, 0.048294007778167725, 0.02656170353293419, -0.03095206804573536, -0.024586040526628494, -0.02600071392953396, 0.024232372641563416, -0.017793171107769012, -0.04792814329266548, -0.03958645090460777, -0.023573817685246468, 0.010177108459174633, -0.03241552412509918, -0.02174449898302555, -0.012091794982552528, 0.01740291714668274, -0.029147140681743622, -0.005469662137329578, 0.05019649863243103, -0.01271986123174429, 0.008445353247225285, 0.007677040062844753, 0.006780673749744892, 0.0009199947817251086, 0.03868398815393448, -0.021573763340711594, 0.008353888057172298, -0.04758667200803757, 0.0660993754863739, -0.03026912361383438, 0.026878787204623222, 0.006683110259473324, -0.050977010279893875, -0.00434463145211339, 0.015317493118345737, -0.017341939732432365, -0.03214722499251366, 0.042196281254291534, 0.02531776763498783, -0.02207377552986145, -0.029049577191472054, 0.0021509737707674503, 0.01896393485367298, 0.022878676652908325, -0.014634547755122185, 0.013549151830375195, 0.009189276956021786, 0.012854010798037052, 0.034000933170318604, -0.017537066712975502, 0.0349033959209919, -0.0682457759976387, -0.007548987399786711, 0.04783058166503906, 0.023256735876202583, -0.004393413197249174, -0.009701485745608807, -0.0032470403239130974, 0.004143406171351671, -0.006908725947141647, 0.00814046710729599, 0.01756145805120468, -0.00851242896169424, 0.015988243743777275, -0.014024775475263596, -0.014524788595736027, -0.030781332403421402, -0.011872276663780212, -0.00746971694752574, -0.03587903454899788, -0.04246458038687706, 0.027464168146252632, -0.026122668758034706, 0.01934199407696724, -0.016085807234048843, -0.049318425357341766, -0.03653758764266968, 0.014293075539171696, -0.01520773395895958, -0.03863520547747612, -0.05395270138978958, 0.06307490170001984, 0.023561622947454453, -0.029683740809559822, -0.024842144921422005, 0.036244895309209824, -0.00345131428912282, -0.003548877779394388, 0.003768396098166704, -0.016695579513907433, -0.010414919815957546, 0.05087944492697716, -0.04344021528959274, -0.033415552228689194, 0.0046281758695840836, -0.051513608545064926, -0.027390995994210243, -0.0519038625061512, 0.041074298322200775, -0.03407410532236099, 0.012512538582086563, -0.09868563711643219, -0.0076404535211622715, 0.0008491086773574352, -0.01181739754974842, 0.05687960982322693, -0.0240128543227911, -0.01003076322376728, 0.01514675747603178, 0.025025077164173126, -0.027854422107338905, 0.03041546791791916, 0.02200060337781906, -0.011579586192965508, -0.003487900597974658, 0.056050319224596024, 0.06863602995872498, -0.0025991566944867373, -0.029903259128332138, 0.008658774197101593, 0.0561966635286808, 0.06239195540547371, 0.024159198626875877, 0.0011273175477981567, 0.018439529463648796, 0.010213694535195827, -0.03768396005034447, -0.013719888404011726, -0.016695579513907433, 0.0064879828132689, -0.012524734251201153, 0.01745169796049595, -0.06922141462564468, 0.020451780408620834, 0.009475870057940483, -0.024683604016900063, 0.04148894175887108, 0.015000411309301853, -0.0428304448723793, 0.03190331533551216, -0.06131875514984131, -0.0015259565552696586, -0.006963605526834726, 0.06161144748330116, 0.025756804272532463, 0.03129354119300842, 0.047245196998119354, 0.0238055307418108, -0.033586286008358, 0.026610486209392548, 0.01623215340077877, -0.0173297431319952, 0.02873249538242817, -0.030464250594377518, 0.0434889979660511, 0.034000933170318604, 0.00975026749074459, -0.04083038866519928, -0.01789073459804058, -0.0036555880215018988, -0.02345186285674572, 0.006670914590358734, -0.03983036056160927, -0.0840023085474968, -0.0015587317757308483, 0.0024756777565926313, 0.038903508335351944, -0.023025022819638252, 0.004689153283834457, 0.02761051431298256, -0.021659130230545998, -0.005274535156786442, 0.012061306275427341, 0.023329908028244972, 0.021598152816295624, -0.007390446495264769, -0.012524734251201153, 0.029634959995746613, -0.015561402775347233, 0.006713598966598511, 0.0045732962898910046, 0.010414919815957546, -0.022366467863321304, 0.01218326110392809, -0.008091685362160206, -0.011878374963998795, -0.034952178597450256, 0.03439118713140488, -0.02113472670316696, -0.027732469141483307, -0.014402833767235279, 0.017317548394203186, 0.07156293839216232, -0.03958645090460777, 0.005305023398250341, 0.01620776206254959, -0.007786799222230911, 0.021037163212895393, -0.0011600927682593465, -0.05717230215668678, 0.017207790166139603, 0.042732879519462585, -0.03036668710410595, 0.029366659000515938, -0.002900994149968028, -0.06268464773893356, 0.030147168785333633, -0.015841897577047348, -0.006914823781698942, 0.005271486006677151, 2.1056217519799247e-05, 0.022464031353592873, 0.021110335364937782, -0.05614788085222244, -0.00014548798208124936, 0.015512621030211449, -0.010189304128289223, -0.013085724785923958, 0.01434185728430748, 0.017598044127225876, 0.004579394124448299, 0.0034848516806960106, 0.004856840707361698, 0.0001654961524764076, 0.061562664806842804, -0.018415139988064766, -0.0014154352247714996, 0.005829428322613239, 0.017476089298725128, 0.0073416647501289845, 0.012780838645994663, 0.0127076655626297, -0.014256488531827927, 0.004667811095714569, -0.004067184869199991, -0.021939625963568687, -0.005649545229971409, 0.015390666201710701, 0.009073419496417046, -0.02396407164633274, 0.02912275120615959, -0.02064690738916397, 0.010713708586990833, -0.02212255820631981, -0.04839157313108444, 0.01934199407696724, -0.0032378938049077988, -0.007250199094414711, 0.017219984903931618, -0.04690372571349144, -0.013841843232512474, -0.02298843488097191, -0.02822028659284115, -0.011299090459942818, 0.027805641293525696, 0.00868926290422678, 0.016366302967071533, 0.03083011507987976, -0.019232235848903656, -0.05005015432834625, -0.027781249955296516, 0.03819616883993149, -0.00532636558637023, 0.06473348289728165, -0.09922223538160324, -0.003957425709813833, -0.011323481798171997, -0.055952753871679306, 0.01486626174300909, 0.020268848165869713, -0.0047379350289702415, 0.0302447322756052, 0.0682457759976387, 0.005744060035794973, 0.01957370713353157, -0.009012442082166672, 0.03258626163005829, -0.005375147331506014, 0.011110060848295689, 0.014524788595736027, 0.0013300669379532337, -0.03295212239027023, -0.058196719735860825, -0.027805641293525696, -0.03361067920923233, -0.005405636038631201, 0.04012305289506912, -0.008335595019161701, -0.013439393602311611, 0.03300090506672859, -0.008646578527987003, 0.004872085060924292, -0.0259519312530756, 0.014390639029443264, 0.005305023398250341, 0.0018476116238161922, 0.022195730358362198, 0.021500589326024055, -0.03214722499251366, 0.02817150391638279, -0.007646551355719566, 0.0072319055907428265, 0.047123245894908905, 0.016573624685406685, 0.004503172356635332, 0.001199727994389832, 0.0054940530098974705, -0.009433185681700706, 0.01922003924846649, 0.006628230679780245, -0.00798802450299263, -0.011341774836182594, -0.02653731405735016, -0.0157199427485466, -0.003186063142493367, 0.01323207002133131, -0.03748883306980133, 0.031756967306137085, 0.012658883817493916, -0.005195264704525471, -0.026342187076807022, 0.057562556117773056, 0.03678149729967117, 0.02006152644753456, -0.03695223480463028, 0.002718062372878194, -0.05302584543824196, -0.029927650466561317, -0.03417167067527771, 0.006076386198401451, 0.021122530102729797, 0.0254153311252594, 0.009244156070053577, 0.06361149996519089, 0.027903204783797264, -0.06131875514984131, 0.024817753583192825, 0.023671381175518036, 0.037147361785173416, -0.04902573674917221, 0.034000933170318604, 0.016573624685406685, 0.0807827040553093, 0.05692839249968529, -0.035659514367580414, -0.048806216567754745, 0.02284209057688713, -0.009549042209982872, 0.0013735132524743676, -0.013317438773810863, 0.02076886221766472, -0.0218664538115263, 0.03914741426706314, -0.020854230970144272, 0.014378443360328674, 0.04861108958721161, 0.03043985925614834, -0.04019622504711151, -0.02235427126288414, -0.020659103989601135, 0.0381229966878891, -0.021220093593001366, 0.006152607966214418, -0.06663597375154495, 0.00025991565780714154, -0.01459796167910099, -0.026854395866394043, 0.0020473122131079435, 0.0035885130055248737, 0.003972670063376427, -0.02317136712372303, -0.030220340937376022, 0.004765374585986137, -0.022415248677134514, 0.008036806248128414, -0.023134781047701836, 0.0604894645512104, -0.0011044510174542665, 0.027366604655981064, -0.03926936909556389, 0.059269919991493225, -0.011896668002009392, 0.026830004528164864, -0.027366604655981064, 0.03090328723192215, -0.015963852405548096, -0.015610184520483017, 0.005930040962994099, 0.0178663432598114, 0.03753761574625969, 0.05390391871333122, -0.01740291714668274, 0.0023293322883546352, 0.028317850083112717, 0.02286648191511631, -0.04178163409233093, 0.013646716251969337, -0.005433076061308384, -0.0017790122656151652, -0.006155656650662422, 0.07527035474777222, -0.05868453532457352, -0.0005457467050291598, 0.002295794663950801, 0.016061415895819664, -0.006518471520394087, 0.0011821971274912357, 0.04865987226366997, 0.006713598966598511, 0.02765929512679577, 0.035513170063495636, -0.029513005167245865, 0.006646523717790842, 0.019256625324487686, -0.027903204783797264, -0.0682457759976387, 0.0224030539393425, -0.011896668002009392, 0.05087944492697716, -0.04592809081077576, 0.023366494104266167, -0.009555140510201454, -0.0346594862639904, -0.014256488531827927, 0.07068486511707306, 0.019098084419965744, 0.0013910442357882857, 0.07429472357034683, 0.03768396005034447, 0.03978157788515091, 0.03822056204080582, 0.01653703860938549, 0.02393968217074871, 0.06000164523720741, -0.03148866817355156, -0.010097838006913662, -0.017768779769539833, 0.013280851766467094, 0.013219875283539295, -0.0037104676011949778, -0.03480583429336548, -0.012341802008450031, 0.02237866260111332, 0.02697635069489479, 0.017854148522019386, -0.01172593142837286, -0.037757132202386856, -0.01407355722039938, 0.031098414212465286, -0.017817562445998192, 0.007262394297868013, -0.0869779959321022, -0.05053797364234924, -0.035098522901535034, 0.012049111537635326, -0.011414946988224983, -0.01982981152832508, 0.01817123033106327, -0.02709830366075039, 0.03253747895359993, -0.03687905892729759, -0.012732056900858879, -0.023549426347017288, 0.020451780408620834, -0.004588540643453598, -0.013366220518946648, -0.012000328861176968, 0.001541963079944253, -0.003878155257552862, -1.1367737897671759e-05, 0.014744306914508343, -0.0030503885354846716, -0.00559466565027833, 0.003219600534066558, -0.006494080647826195, -0.021354245021939278, -0.010164912790060043, -0.025561677291989326, -0.0028979454655200243, -0.011799104511737823, -0.012768642976880074, 0.010585656389594078, -0.004112917929887772, 0.01798829808831215, 0.041586507111787796, -0.030049605295062065, -0.005018430296331644, -0.009146592579782009, 0.0018506605410948396, 0.014719916507601738, 0.03814738988876343, -0.012219847179949284, 0.017488284036517143, 0.02317136712372303, -0.05122091621160507, 0.010329551994800568, 0.019073694944381714, -0.045001234859228134, -0.0032348448876291513, -0.027854422107338905, -0.010713708586990833, -0.03924497961997986, -0.019720053300261497, 0.005509297363460064, -0.021500589326024055, 0.002030543517321348, 0.025708021596074104, -0.05112335458397865, -0.008725848980247974, 0.019695661962032318, -0.023073803633451462, 0.010006371885538101, 0.012817424722015858, 0.005984920542687178, 0.04597686976194382, -0.003664734773337841, -0.001382659887894988, -0.015463839285075665, -0.052635591477155685, 0.006512373685836792, -0.0035610732156783342, 0.015915071591734886, -0.03422044962644577, 0.004972697235643864, 0.025805586948990822, 0.028244677931070328, 0.007097755558788776, -0.013158897869288921, -0.05366000905632973, 0.06278221309185028, -0.059318702667951584, 0.01742730662226677, 0.041025515645742416, 0.0028598345816135406, 0.03407410532236099, 0.016122393310070038, 0.008079489693045616, -0.01548822969198227, -0.010061251930892467, -0.028952013701200485, 0.027878813445568085, -0.013366220518946648, 0.05800159275531769, -0.017415111884474754, 0.006192243192344904, -0.015561402775347233, 0.03090328723192215, -0.006094679236412048, 0.002404029481112957, 0.02712269499897957, -0.011805201880633831, -0.041684068739414215, -0.00027230166597291827, 0.0011067376472055912, -0.021732304245233536, -0.0022988435812294483, 0.002184511162340641, 0.01819562166929245, -0.003811080241575837, -0.019195647910237312, -0.0009329524473287165, 0.0013658911921083927, 0.029464222490787506, -0.009530749171972275, 0.0026540362741798162, 0.010603949427604675, -0.02585436776280403, -0.043220698833465576, 0.026781221851706505, 0.01597604900598526, -0.01826879382133484, 0.0456353984773159, -0.014963825233280659, -0.01101249735802412, -0.03575707972049713, -0.004088526591658592, 0.02536655031144619, -0.04312313348054886, 0.05683082714676857, -0.02870810404419899, 0.04022061452269554, -0.010610046796500683, 0.009067322127521038, -0.027390995994210243, -0.015841897577047348, 0.006305051036179066, -0.0021372537594288588, 0.011451533995568752, 0.02225670777261257, 0.02067129872739315, 0.03768396005034447, 0.023342104628682137, -0.03039107844233513, -0.022195730358362198, -0.025659240782260895, 0.02214694954454899, 0.02926909551024437, -0.01809805817902088, -0.0007896558381617069, -0.012360095046460629, 0.002663182793185115, -0.039513278752565384, 0.0083965715020895, 0.008274617604911327, -0.012622297741472721, -0.015841897577047348, -0.061465099453926086, -0.020037135109305382, -0.00904902908951044, 0.014085751958191395, 0.018951740115880966, -0.009853929281234741, -0.006402614526450634, -0.01576872542500496, -0.015268711373209953, 0.011847886256873608, 0.021268876269459724, -0.028805667534470558, 0.004070233553647995, -0.05580640956759453, -0.015354080125689507, 0.02225670777261257, -0.020829839631915092, -0.023256735876202583, -0.0038171778433024883, 0.019281016662716866, -0.057123519480228424, -0.027439776808023453, -0.012549124658107758, -0.003146427683532238, -0.03783030807971954, 0.03470826894044876, 0.03139110654592514, -0.016500452533364296, -0.004079380072653294, 0.001218021265231073, -0.038318123668432236, -0.0005907174199819565, -0.016829730942845345, -0.013756475411355495, 0.0029955089557915926, 0.025073857977986336, 0.005978822708129883, -0.010378333739936352, -0.03268382325768471, -0.020146895200014114, -0.03751322627067566, 0.0024268957786262035, -0.003475705161690712, -0.007835580967366695, -0.05244046449661255, -0.00259610777720809, 0.028927622362971306, -0.011957645416259766, 0.011006399989128113, 0.018317576497793198, -0.015878483653068542, -0.03083011507987976, -0.0015793116763234138, 0.05073310062289238, -0.012524734251201153, 0.02597632259130478, -0.02232988178730011, 0.012402779422700405, 0.005820281803607941, 0.004530611913651228, -0.05361122637987137, 0.029439833015203476, 0.07936803251504898, 0.034513141959905624, 0.025829976424574852, 0.027830032631754875, -0.008628285489976406, -0.04641590639948845, -0.024720190092921257, 0.00885390117764473, -0.014780892990529537, 0.010421017184853554, 0.03241552412509918, -0.00331716425716877, 0.0019436508882790804, -0.010597852058708668, -0.015658965334296227, -0.008274617604911327, 0.019634684547781944, -0.005366000812500715, -0.027805641293525696, 0.020281044766306877, -0.02350064553320408, 0.005140385124832392, -0.007030680775642395, 0.014951629564166069, 0.014780892990529537, 0.027269041165709496, -0.024403108283877373, 0.011610074900090694, 0.0012736630160361528, 0.022525008767843246, 0.03800104185938835, 0.013963798061013222, -0.016146784648299217, 0.0028003817424178123, -0.027244649827480316, -0.008414865471422672, -0.012347899377346039, -0.015585793182253838, -0.02048836648464203, -0.03846447169780731, -0.010555167682468891, -0.047123245894908905, -0.036659542471170425, -0.021171312779188156, -0.004259263165295124, -0.03309847041964531, -0.013841843232512474, 0.0023781140334904194, -0.018573680892586708, -0.006987996399402618, -0.00867706723511219, 0.018085861578583717, 0.006908725947141647, -0.11141768842935562, -0.019049303606152534, 0.03761078789830208, 0.02312258630990982, 0.02125668153166771, -0.02064690738916397, -0.0010716757969930768, -0.019256625324487686, 0.006512373685836792, -0.04041574150323868, -0.030659377574920654, -0.008756337687373161, -0.020842034369707108, 0.007518499158322811, 0.031171586364507675, -0.038342516869306564, -0.014988216571509838, -0.022085972130298615, -0.013366220518946648, -0.022768916562199593, 0.0065855467692017555, 0.029976433143019676, 0.009622215293347836, 0.05219655483961105, -0.028561759740114212, -0.009341719560325146, -0.010536874644458294, 0.03139110654592514, -0.014402833767235279, 0.010317356325685978, -0.01950053498148918, -0.00572881568223238, 0.011793006211519241, 0.04785497114062309, -0.018134644255042076, 0.03529364988207817, 0.002106765052303672, 0.01271986123174429, -0.003102219197899103, -0.0016021780902519822, -0.0035458290949463844, -0.039927925914525986, 0.0863926112651825, 0.02204938605427742, 0.022293293848633766, -0.03300090506672859, -0.01403697021305561, -0.020805448293685913, 0.017549261450767517, -0.03085450455546379, -0.023854313418269157, 0.025708021596074104, -0.0020473122131079435, -0.007756310515105724, 0.02125668153166771, 0.004341582767665386, 0.001131128636188805, 0.008609992451965809, 0.02526898682117462, 0.03463509678840637, -0.02922031469643116, 0.018622461706399918, 0.06907506287097931, -0.016061415895819664, -0.04890378192067146, -0.027756858617067337, -0.01120152696967125, -0.004997088108211756, 0.010353942401707172, -0.0063111488707363605, -0.013622324913740158, 0.002754648681730032, -0.008981953375041485, 0.004179992713034153, 0.013439393602311611, 0.011921058408915997, -0.03085450455546379, 0.008402669802308083, -0.04463537037372589, -0.003384239273145795, 0.016658993437886238, -0.04209871590137482, 0.025049468502402306, -0.010274671949446201, -0.02406163513660431, -0.0027272088918834925, -0.014366247691214085, 0.027927596122026443, -0.015866288915276527, 0.0684896856546402, 0.04685494303703308, -0.0038293732795864344, 0.020732276141643524, -0.0327569954097271, 0.0018811491318047047, -0.013646716251969337, 0.013049138709902763, 0.005942236166447401, 0.027830032631754875, -0.0073965443298220634, 0.03990353271365166, 0.0199273768812418, -0.01737852580845356, -0.04095234349370003, 0.016780948266386986, 0.018354162573814392, -0.02020787075161934, 0.03619611635804176, -0.002870505675673485, -0.006811162456870079, 0.0020168237388134003, -0.020049329847097397, -0.036098551005125046, 0.006579448934644461, 0.007744114845991135, 0.004579394124448299, 0.04361095279455185, 0.025025077164173126, 0.024256763979792595, 0.009542944841086864, 0.010158815421164036, 0.003548877779394388, -0.028293458744883537, -0.008914878591895103, -0.027147086337208748, -0.013561347499489784, 0.0070245829410851, 0.015524815768003464, 0.005006235092878342, -0.016695579513907433, 0.03570829704403877, -0.01547603402286768, 0.0374644435942173, -0.002154022455215454, -0.020512757822871208, 0.036122944205999374, 0.030781332403421402, -0.005585519131273031, -0.02695195935666561, 0.019963962957262993, 0.002271403791382909, 0.004817205481231213, 0.026878787204623222, 0.03353750705718994, 0.014500398188829422, -0.018878566101193428, -0.0026342186611145735, -0.05448929965496063, 0.00922586303204298, 0.006076386198401451, 0.026830004528164864, 0.00042341099469922483, -0.0013247315073385835, -0.001352171297185123, -0.0006779911927878857, 0.0011448485311120749, -0.012671079486608505, -0.02125668153166771, -0.007085560355335474, 0.007939241826534271, 0.013366220518946648, 0.06805064529180527, 0.009305133484303951, 0.01609800197184086, 0.005466613452881575, 0.016110198572278023, -0.01493943389505148, 0.004277556203305721, -0.02480555884540081, 0.02531776763498783, 0.0046800062991678715, -0.04697689786553383, 0.018159035593271255, 0.03626928851008415, 0.004509270191192627, 0.004975746385753155, -0.0076404535211622715, 0.012597906403243542, -0.005051967687904835, 0.0064879828132689, 0.011805201880633831, 0.03261065110564232, -0.05678204447031021, 0.015683356672525406, 0.04192797839641571, -0.03312285989522934, -0.0076953331008553505, 0.004832449834793806, -0.016171175986528397, 0.013963798061013222, 0.011683247052133083, 0.0327569954097271, -0.013378416188061237, 0.06927019357681274, -0.000301265885354951, 0.017061443999409676, -0.027927596122026443, 0.003573268884792924, 0.009427088312804699, -0.017951712012290955, -0.05117213726043701, 0.034439969807863235, -0.02008591778576374, -0.012043013237416744, -0.019744444638490677, 0.005000137258321047, -0.06712379306554794, -0.003856813069432974, -0.015890680253505707, 0.0009268547291867435, 0.007829482667148113, -0.014402833767235279, -0.01985420286655426, 0.019842008128762245, -0.018488312140107155, -0.081855908036232, 0.006567253265529871, -0.013158897869288921, -0.043928034603595734, -0.01296376995742321, -0.01957370713353157, -0.028561759740114212, -0.01941516622900963, 0.0058477213606238365, -0.02431773953139782, 0.01541505753993988, 0.012280824594199657, 0.01852489821612835, -0.012311313301324844, -0.005347707774490118, 0.015073584392666817, 0.00870145857334137, -0.01126860175281763, 0.004173894878476858, -0.012744252569973469, 0.01430527027696371, -0.006082484032958746, -0.025147031992673874, 0.01461015734821558, -0.003798884805291891, -0.007152635138481855, 0.005539786070585251, -0.011079572141170502, -0.018232207745313644, 0.002478726441040635, -0.02352503500878811, 0.028244677931070328, 0.013122310861945152, -0.04256214201450348, -0.042806051671504974, -0.021549372002482414, 0.021037163212895393, 0.031195977702736855, -0.01817123033106327, 0.017537066712975502, 0.011299090459942818, -0.011811299249529839, 0.0637090653181076, 0.04636712744832039, 0.010689317248761654, -0.009146592579782009, -0.02113472670316696, -0.013756475411355495, 0.005140385124832392, -0.0006638901541009545, -0.037196140736341476, 0.01868343912065029, 0.02006152644753456, -0.033952150493860245, -0.006161754485219717, -0.022244513034820557, -0.009738071821630001, 0.014476006850600243, 0.05180630087852478, 0.028025159612298012, -0.018341965973377228, 0.007902655750513077, -0.007920948788523674, -0.008536819368600845, 0.008811217732727528, -0.040025487542152405, 8.493944915244356e-05, -0.027708077803254128, -0.04965990036725998, 0.038805942982435226, 0.015585793182253838, 0.008183151483535767, 0.009677094407379627, 0.016341911628842354, -0.014902847819030285, 0.04287922382354736, 0.03634246066212654, -0.025683632120490074, -7.950865983730182e-05, -0.006561155430972576, 0.007317273877561092, 0.00537209864705801, 0.032391130924224854, -0.004216579254716635, -0.024342130869627, -0.014988216571509838, 0.024464085698127747, -0.02225670777261257, 0.017598044127225876, 0.021671326830983162, 0.006798967253416777, 0.00787216704338789, 0.014695525169372559, -0.029634959995746613, -0.02983008697628975, -0.014512592926621437, -0.004820254165679216, -0.016244348138570786, 0.027903204783797264, 0.04190358892083168, -0.005987969227135181, 0.0014527838211506605, -0.014488202519714832, -0.007768505718559027, 0.0159272663295269, -0.009512456133961678, -0.03204965963959694, 0.008372181095182896, -0.023671381175518036, -0.0327569954097271, 0.003009228967130184, 0.011183233931660652, -0.029952041804790497, 0.006372126284986734, 0.018415139988064766, -0.001095304498448968, 0.018049275502562523, -9.43718696362339e-05, 0.004097673576325178, -0.010695415548980236, 0.002515312982723117, -0.015500425361096859, -0.009725877083837986, -0.006786771584302187, -0.009262449108064175, 0.0009428612538613379, -0.00870145857334137, -0.02373235858976841, 0.016695579513907433, 0.011878374963998795, -0.008658774197101593, -0.00013557917554862797, 0.012353997677564621, 0.004500123672187328, -0.03585464134812355, 0.06463591754436493, 0.01952492631971836, -0.012244238518178463, -0.0006905677146278322, -0.0021372537594288588, 0.0013285425957292318, -0.031122805550694466, 0.00018693348101805896, -0.043318260461091995, -0.008067294955253601, -0.009664899669587612, 0.02585436776280403, -0.010957617312669754, -0.019610295072197914, 0.015280907042324543, -0.010628340765833855, -0.02429335005581379, 0.011488120071589947, 0.006390419322997332, -0.018232207745313644, 0.016110198572278023, 0.029561785981059074, -0.04526953399181366, 0.035074133425951004, -0.01686631701886654, -0.004585491493344307, -0.032805778086185455, 0.014658939093351364, -0.01686631701886654, -0.006542862392961979, -0.009463674388825893, 0.010603949427604675, -0.03802543506026268, -0.01047589723020792, -0.005420880392193794, -0.02284209057688713, -0.06805064529180527, 0.013073529116809368, 0.005268437322229147, 0.012488147243857384, 0.025464113801717758, -0.009250253438949585, 0.0003435688850004226, -0.017000466585159302, -0.01225033588707447, -0.008591699413955212, 0.004003158770501614, -0.023342104628682137, 0.006100777070969343, 0.008158760145306587, -0.02263476699590683, 0.004015353973954916, 0.024817753583192825, -0.024610431864857674, 0.01514675747603178, -0.021012771874666214, -0.010323453694581985, 0.01742730662226677, 0.017134616151452065, -0.01822001300752163, -0.01891515403985977, -0.005984920542687178, -0.012469854205846786, 0.026269013062119484, 0.02653731405735016, -0.014756502583622932, 0.02319575846195221, 0.015988243743777275, 0.007713626138865948, 0.03514730557799339, 0.0005880496464669704, -0.0078050922602415085, -0.01004295889288187, 0.011524706147611141, 0.022171340882778168, 0.0001363413903163746, -0.004240970127284527, 0.03126915171742439, -0.0073660556226968765, 0.02924470417201519, -0.000715720874723047, 0.010542972013354301, -0.006433103233575821, 0.012457658536732197, 0.005530639551579952, 0.04646468907594681, 0.008347789756953716, 0.006402614526450634, -0.002705866936594248, 0.015585793182253838, -0.030098386108875275, 0.005244046449661255, 0.03480583429336548, -0.001664679846726358, 0.00012157345918240026, -0.0327569954097271, 0.032830167561769485, -0.028512977063655853, -0.002440615789964795, 0.007616062648594379, -0.02095179446041584, -0.033854588866233826, 0.046586643904447556, 0.008561210706830025, -0.024683604016900063, 0.015988243743777275, -0.03917180746793747, -0.01486626174300909, 0.028244677931070328, 0.018512703478336334, -0.022293293848633766, 0.001456594793125987, 0.012116186320781708, -0.0010632913326844573, 0.002704342594370246, -0.016524843871593475, -0.06673353910446167, 0.028854450210928917, -0.0012675652978941798, -0.03300090506672859, 0.0041647483594715595, -0.022439640015363693, -0.007683137431740761, -0.006792869418859482, 0.011500315740704536, -0.006125167943537235, -0.011488120071589947, -0.0037744936998933554, -0.0059026009403169155, 0.012610102072358131, -0.028903232887387276, -0.010366138070821762, 0.011841787956655025, 0.0055733234621584415, 0.022707941010594368, -0.006561155430972576, -0.00221652421168983, -0.0021387781016528606, -0.016171175986528397, 0.01663460209965706, 0.0021753646433353424, -0.013378416188061237, -0.0051983133889734745, 0.013134506531059742, 0.0016905951779335737, 0.017085835337638855, -0.017317548394203186, 0.008707555942237377, 0.024415304884314537, -0.008628285489976406, 0.0038141291588544846, -0.02172010764479637, -0.010347845032811165, 0.008353888057172298, 0.008219737559556961, -0.01922003924846649, -0.008738044649362564, -0.03975718840956688, 0.04080599918961525, 0.0218664538115263, 0.005018430296331644, -0.022464031353592873, -0.00117533712182194, 0.007274589966982603, 0.020281044766306877, 6.28351845080033e-05, -0.017817562445998192, 0.0074209352023899555, -0.0061465101316571236, -0.029391050338745117, -0.01653703860938549, 0.00510379858314991, -0.02393968217074871, -0.02202499471604824, -0.00814046710729599, -0.005463564768433571, -0.0041098687797784805, 0.0008270043763332069, -0.011652758345007896, 0.005954431835561991, -0.013134506531059742, -0.026854395866394043, 0.03158623352646828, -0.011427142657339573, -0.019232235848903656, 0.010140522383153439, -0.00378059153445065, 0.01712242141366005, 0.0018399895634502172, 0.01199423149228096, -0.0031250857282429934, -0.008695360273122787, -0.03148866817355156, -0.025147031992673874, 0.01819562166929245, -0.0028811765369027853, -0.01618337072432041, 0.0025686679873615503, -0.031220369040966034, 0.02235427126288414, 0.002361345337703824, 0.0004295087419450283, -0.0092014716938138, 0.01129299309104681, 0.01637849770486355, -0.010890542529523373, -0.0014344905503094196, -0.025683632120490074, -0.005268437322229147, 0.019659075886011124, 0.03790348023176193, -0.0173297431319952, -0.009469771757721901, 0.01809805817902088, 0.030537422746419907, -0.014232098124921322, 0.0023720161989331245, -0.02709830366075039, 0.003591561922803521, -0.009902711026370525, -0.03036668710410595, 0.002920811763033271, 0.01567116193473339, 0.00023533419880550355, -0.05117213726043701, 0.03219600394368172, 0.00604284880682826, -0.01952492631971836, 0.0009840208804234862, 0.001291193999350071, 0.0338301956653595, -0.026342187076807022, -0.034025322645902634, 0.00715873297303915, 0.015878483653068542, 0.0020274946000427008, 0.019122475758194923, -0.014829675666987896, -0.010866152122616768, 0.021146921440958977, -0.03146427869796753, -0.012902793474495411, -0.0010876823216676712, 0.007317273877561092, 0.0014680280582979321, 0.067660391330719, 0.004167797509580851, 0.005426978226751089, -0.03419606015086174, 0.00587516138330102, 0.021610349416732788, 0.03626928851008415, 0.014829675666987896, -0.04034256935119629, 0.026903176680207253, -0.02011030726134777, 0.0162565428763628, -0.04319630563259125, 0.04431828856468201, 0.03931815177202225, -0.00950635876506567, -0.0015198587207123637, 0.024427499622106552, 0.015158952213823795, 0.0047684237360954285, 0.014439420774579048, -0.009268547408282757, -0.015061388723552227, -0.02422017604112625, -0.014378443360328674, -0.0005747108953073621, -0.005597714800387621, -0.01837855391204357, -0.008341692388057709, 0.01784195378422737, 0.017256570979952812, 0.017244376242160797, 0.0089331716299057, 0.02865932323038578, -0.02146400325000286, 0.03183014318346977, -0.021476199850440025, -0.003262284677475691, 0.012384486384689808, -0.0024268957786262035, -0.027732469141483307, -0.009664899669587612, 0.01824440248310566, 0.004323289263993502, 0.019146867096424103, 0.007207514718174934, -0.029903259128332138, 0.0346594862639904, -0.03512291610240936, -0.026147058233618736, -0.034464359283447266, 0.0053080725483596325, -0.05278193578124046, 0.0006818022229708731, 0.007262394297868013, -0.0008780728676356375, -0.0020915206987410784, -0.0025671436451375484, -0.016573624685406685, 0.04319630563259125, 0.030049605295062065, -0.03426923230290413, 0.03434240445494652, 0.025049468502402306, -0.005576372612267733, 0.007914851419627666, -0.0006920921732671559, -0.0013750377111136913, -0.03683027997612953, -0.03734248876571655, 0.020756667479872704, 0.00030298088677227497, 0.02156156674027443, -0.0003536682343110442, 0.037171751260757446, -0.02704952284693718, 0.024110417813062668, 0.00976246315985918, 0.041610896587371826, 0.027781249955296516, 0.0017210837686434388, -0.013183288276195526, -0.008670969866216183, -1.847183011705056e-05, -0.007866069674491882, 0.004103770945221186, -0.000339567253831774, -0.013293047435581684, 0.005844672676175833, 0.005756255704909563, -0.00991490576416254, 0.002460433403030038, 0.015268711373209953, 0.03419606015086174, -0.03097645938396454, 0.016671190038323402, 0.0040641357190907, -0.015366274863481522, -0.022598180919885635, -0.026049494743347168, 0.0015450118808075786, -0.0022744527086615562, 0.0030686818063259125, -0.02322014980018139, 0.004975746385753155, 0.039513278752565384, 0.014232098124921322, -0.0002176126727135852, -0.001108262105844915, 0.02141522243618965, -2.534368286433164e-05, 0.01154909748584032, -0.02263476699590683, -0.021646935492753983, 0.001983286114409566, 0.007146537769585848, -0.00038263245369307697, 0.031708188354969025, 0.010335649363696575, 0.03570829704403877, -0.02064690738916397, 0.0022180485539138317, -0.016037024557590485, 0.013402806594967842, -0.015756530687212944, -0.01459796167910099, 0.04141576960682869, 0.014756502583622932, 0.019232235848903656, -0.02459823526442051, -0.006280660163611174, -0.004280605353415012, -0.02656170353293419, 0.0013140604132786393, 0.013695497997105122, 0.03139110654592514, -0.03039107844233513, -0.011225917376577854, -0.02128107100725174, 0.015427252277731895, -0.0015122366603463888, -0.013963798061013222, 0.012134479358792305, 0.019476143643260002]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"), the optimal twist functions
ψ∗
t(s1:t)(in regions where p0(s1:t)>0) correspond to
π∗
t(s1:t) =σ(s1:t) =1
Zψ∗
tp0(s1:t)ψ∗
t(s1:t). (11)
Up to a constant independent of s1:t, the optimal twists are
ψ∗
t(s1:t)∝X
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T). (12)
and satisfy the recursion
ψ∗
t(s1:t)∝X
st+1p0(st+1|s1:t)ψ∗
t(s1:t+1). (13)
Since the optimal twist functions are unavailable due to the
need to marginalize over future timesteps, we consider learn-
ing approximate twist functions using methods in Sec. 4.
3.2. Proposal Distribution
For a given set of targets {πt}T
t=1, the importance weights
in Eq. (10) depend crucially on the choice of proposal.
Base Model as Proposal The most straightforward choice
of proposal is the base pre-trained model, q=p0. While we
demonstrate in Sec. 7 that SMC resampling with learned
twists and the base model proposal can closely approximate
the target distribution, this may require large K. We can
achieve greater efficiency using better choices of proposal.
Twist-Induced Proposal For given targets {πt}T
t=1, the
optimal proposal minimizes the variance of the importance
weights (App. A.1). In the language model setting with a ter-
minal potential only, we will in fact be able to sample from
the optimal proposal for the one-step importance weights.
Proposition 3.3. (Twist-Induced Proposal). For a given
set of intermediate twisted targets πt(s1:t)in Eq. (9), the
proposal which minimizes the variance of the one-step in-
cremental importance weights wtis given by
qπ
t(st|s1:t−1)∝πt(s1:t)
πt−1(s1:t−1)(14)
=1
Zπ
t(s1:t−1)p0(st|s1:t−1)ψt(s1:t).
4
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
See App. A.2 for proof. For t < T , we can construct a pa-
rameterization of ψt(s1:t)such that the proposal is tractable
to sample in transformer architectures, where the normal-
ization Zπ
t(s1:t−1) =P
stp0(st|s1:t−1)ψt(s1:t)sums over
the discrete vocabulary of next tokens st∈ V. However, for
the final timestep, note that ϕ(s1:T)may require calls to a
different neural network such as a reward model or classifier.
We thus consider an approximate ψT(s1:T)≈ϕ(s1:T)for
the proposal qT(sT|s1:T−1)∝p0(sT|s1:T−1)ψT(s1:T)in
the final step. With slight abuse of notation, we let qπ(s1:T)
denote this tractable proposal over full sequences,
qπ(s1:T):=T−1Y
t=1qπ
t(st|s1:t−1)
qT(sT|s1:T−1).(15)
Using this proposal, the incremental weights become
wt(s1:t) =

P
stp0(st|s1:t−1)ψt(s1:t)
ψt−1(s1:t−1)t < T
P
sTp0(sT|s1:T−1)ψT(s1:T)
ψT−1(s1:T−1)ϕ(s1:T)
ψT(s1:T)t=T,(16)
which are independent of stfort < T .
Variational Proposal As noted in Sec. 2.1, SMC with no
resampling steps reduces to SISwith the full target distri-
bution σ(s1:T). Policy gradient methods (Schulman et al.,
2017; Parshakova et al., 2019; Korbak","[0.0005175188998691738, -0.01188814826309681, 0.02012113481760025, 0.011066032573580742, -0.04459534212946892, -0.008889496326446533, 0.009013700298964977, -0.0007064132951200008, -0.052804671227931976, 0.029406901448965073, 0.016241220757365227, 0.0025521074421703815, -0.045234110206365585, 0.01430126465857029, 0.024959197267889977, -0.04144882783293724, 0.04073908552527428, 0.0011703319614753127, -0.022001946344971657, 0.02741963043808937, -0.04901938885450363, -0.01906835287809372, -0.006890394259244204, 0.01975443586707115, 0.03293194621801376, -0.02467530034482479, 0.014064684510231018, -0.004722729325294495, 0.025952832773327827, 0.0036403757985681295, 0.04788380488753319, -0.010214344598352909, -0.03856255114078522, -0.05682653188705444, -0.019742606207728386, 0.07707778364419937, -0.017968256026506424, 0.02893374115228653, -0.020771728828549385, 0.02959616668522358, 0.02256973832845688, -0.03004566766321659, -0.048830125480890274, 0.04977644607424736, 0.009250280447304249, 0.04935060068964958, -0.00022290277411229908, -0.005444298963993788, -0.026473309844732285, 0.06207861006259918, -0.014360410161316395, 0.022522421553730965, -0.013130193576216698, -0.012988245114684105, 0.008386763744056225, 0.002373193856328726, 0.01912749744951725, -0.03103930503129959, 0.013059219345450401, -0.03501385077834129, 0.04282099008560181, -0.021576102823019028, 0.013615182600915432, 0.023125700652599335, 0.002556543331593275, -0.014738937839865685, -0.04322317615151405, 0.03323949873447418, -0.03643333166837692, 0.039414238184690475, -0.01217204425483942, -0.003743879497051239, 0.038775473833084106, 0.01994369924068451, -0.0201566219329834, 0.03508482500910759, -0.006760275457054377, 0.04887744039297104, 0.006606498267501593, -0.017660701647400856, 0.0011207980569452047, -0.03939058259129524, 0.02654428407549858, -0.018607022240757942, -0.0395798459649086, -0.05933428183197975, -0.010468668304383755, -0.0167380403727293, -0.04308123141527176, -0.03158343955874443, -0.017932768911123276, 0.016974620521068573, -0.03134685754776001, 0.0032677622511982918, 0.06070644408464432, 0.009569663554430008, 0.023598860949277878, -0.000689778767991811, 0.029548849910497665, 0.020736243575811386, 0.030873699113726616, -0.011006887070834637, 0.010374035686254501, -0.026023807004094124, 0.06804042309522629, -0.01912749744951725, 0.0009736748179420829, 0.02335045300424099, -0.0301639586687088, -0.006902223452925682, -0.001389907905831933, -0.011083776131272316, 0.0026600470300763845, 0.05341977998614311, 0.010598787106573582, -0.06193666160106659, -0.033688999712467194, 0.014041027054190636, -0.007712509948760271, 0.011018716730177402, -0.007777569815516472, 0.01134401373565197, -0.011687055230140686, 0.029572507366538048, 0.013839934021234512, -0.0021942800376564264, 0.02673354744911194, -0.06065912917256355, 0.004663584753870964, 0.040289584547281265, 0.012313992716372013, 0.014052855782210827, 0.006600583903491497, 0.011651568114757538, 0.008156097494065762, -0.02335045300424099, -0.009185221046209335, 0.045991163700819016, 0.0034363253507763147, 0.03607846051454544, 0.008037807419896126, -0.030613459646701813, -0.02642599307000637, 0.006884479895234108, -0.012976416386663914, -0.021221231669187546, -0.04497386887669563, 0.02720670774579048, -0.006695216055959463, 0.026804521679878235, -0.030211273580789566, -0.03976910933852196, -0.04066811501979828, 0.0201566219329834, -0.025716252624988556, -0.05441341549158096, -0.03927228972315788, 0.06652631610631943, 0.02817668579518795, -0.03773451969027519, -0.015886351466178894, 0.04461900144815445, 0.005269820801913738, -0.003735007718205452, 0.01819300651550293, -0.008404506370425224, -0.029406901448965073, 0.03813670575618744, -0.03671722486615181, -0.046866510063409805, 0.006026877090334892, -0.05133787542581558, -0.026946470141410828, -0.03231683745980263, 0.019044695422053337, -0.035037506371736526, -0.0015141124604269862, -0.09439544379711151, -0.005343752447515726, 0.012231189757585526, -0.0008923504501581192, 0.06718873977661133, -0.02959616668522358, -0.02177719585597515, 0.008091038092970848, 0.029241295531392097, -0.029903721064329147, 0.030566144734621048, 0.0235042292624712, 0.00036577496211975813, -0.00017761987692210823, 0.045896533876657486, 0.0677565336227417, -0.0028330462519079447, -0.053656358271837234, 0.006304858718067408, 0.04854622855782509, 0.05119592696428299, 0.009652466513216496, 0.0030104813631623983, 0.005766639020293951, 0.015436849556863308, -0.05942891165614128, -0.03364168480038643, -0.007558733224868774, -0.011125177145004272, 0.005006625782698393, -0.0013884293148294091, -0.0859258770942688, 0.014561503194272518, 0.005890843458473682, -0.01936407759785652, 0.030092984437942505, 0.010935913771390915, -0.030447853729128838, 0.0021380924154073, -0.05753627046942711, 0.0011030544992536306, -0.0017773077124729753, 0.04745795950293541, 0.01572074554860592, 0.00989496149122715, 0.03477726876735687, 0.02720670774579048, -0.03468263894319534, 0.01430126465857029, 0.01928127557039261, -0.030069326981902122, 0.04537605494260788, -0.024036534130573273, 0.037214044481515884, 0.012704349122941494, 0.017010105773806572, -0.01507015060633421, -0.0013492456637322903, -0.017790820449590683, -0.009433629922568798, -0.004622182808816433, -0.023492399603128433, -0.10844830423593521, 0.02223852649331093, 0.01359152514487505, 0.029335927218198776, -0.03581822291016579, 0.02220303937792778, 0.025621620938181877, -0.019565170630812645, 0.0015895223477855325, 0.010888597927987576, 0.01976626366376877, -0.010060567408800125, -0.0177671629935503, -0.020535150542855263, -0.0018911618972197175, -0.041283220052719116, -0.01632402464747429, 0.007333981804549694, 0.013638840988278389, -0.05185835063457489, 0.017956426367163658, 0.021883655339479446, -0.007611963432282209, -0.026851836591959, 0.021706221625208855, -0.01677352748811245, -0.018843602389097214, -0.006730702705681324, -0.01170479878783226, 0.06349808722734451, -0.009480945765972137, 0.0005700101028196514, 0.0029542935080826283, -0.026165755465626717, 0.036362357437610626, 0.010220258496701717, -0.03165441378951073, 0.004010031931102276, 0.04409852251410484, -0.0208190456032753, 0.03737964853644371, -0.004092835355550051, -0.050154972821474075, 0.038420602679252625, -0.004568952601402998, -0.002788687590509653, -0.009883131831884384, -0.015614284202456474, 0.047741856426000595, -0.004956352524459362, -0.07277202606201172, 0.012728007510304451, 0.00944545865058899, 0.003412667429074645, -0.024698959663510323, 0.0014231769600883126, 0.02663891576230526, 0.0157444030046463, 0.0032648048363626003, 0.024817248806357384, 0.0171047393232584, 0.04045519232749939, -0.030542487278580666, 0.005887886509299278, 0.00767702329903841, 0.0022622968535870314, 0.016146589070558548, 0.039059367030858994, 0.02036954276263714, -0.010782136581838131, 0.009741184301674366, -0.0102261733263731, -0.011320356279611588, -0.021079283207654953, 0.020960994064807892, -0.03704843670129776, -0.028200343251228333, 0.03910668566823006, -0.029880061745643616, 0.008049637079238892, -0.009356741793453693, -0.0517164021730423, -0.0003642963420134038, -0.016099274158477783, 0.0011267125373706222, 0.015673428773880005, -0.05337246134877205, 0.0042732274159789085, -0.024486036971211433, -0.026047464460134506, -0.006671557668596506, 0.03648064658045769, 0.010652017779648304, 0.025739911943674088, 0.029903721064329147, -0.02154061570763588, -0.04305757209658623, -0.01758972741663456, 0.03735599294304848, -0.0013174552004784346, 0.043790969997644424, -0.08772388845682144, -0.0066656433045864105, -0.0076297069899737835, -0.06392393261194229, 0.005704537034034729, 0.017506925389170647, 0.006990940775722265, 0.03234049305319786, 0.08904873579740524, 0.005914501845836639, 0.014928202144801617, -0.02805839665234089, 0.03269536420702934, -0.012846297584474087, 0.0044713630340993404, 0.011982779949903488, 0.0035605300217866898, -0.030092984437942505, -0.0449502132833004, -0.024580668658018112, -0.042253199964761734, -0.01058695837855339, 0.054886575788259506, -0.006884479895234108, -0.0026615257374942303, 0.028697161003947258, 0.006127423606812954, 0.013473235070705414, 0.020653439685702324, 0.011692970059812069, -0.01891457661986351, 0.009131990373134613, -0.017140226438641548, 0.021919142454862595, -0.03913034126162529, -0.022770831361413002, -0.006047578062862158, -0.002655611140653491, 0.04360170662403107, 0.017140226438641548, 0.020535150542855263, 0.0020153664518147707, -0.013674328103661537, -0.007186119444668293, -0.013627011328935623, 0.016584262251853943, 0.011692970059812069, -0.012266675941646099, 0.01202418189495802, -0.0047109005972743034, 0.01988455466926098, 0.01045092474669218, -0.06340345740318298, 0.0448792390525341, -0.014727109111845493, 0.008617429062724113, -0.025503331795334816, 0.05474462732672691, 0.030637118965387344, 0.05753627046942711, -0.0583406426012516, 0.017719846218824387, -0.06610047072172165, -0.023090213537216187, -0.039083026349544525, 0.01589818112552166, 0.020866362378001213, 0.020830875262618065, 0.021954629570245743, 0.04099932685494423, 0.05394025519490242, -0.041921988129615784, 0.011071947403252125, 0.019647974520921707, 0.021883655339479446, -0.04525776579976082, 0.024367745965719223, 0.012751665897667408, 0.04726869612932205, 0.04925597086548805, -0.0065710111521184444, -0.014005539938807487, 0.021031968295574188, -0.013721643947064877, -0.027774499729275703, -0.010711162351071835, 0.04963449761271477, -0.007990491576492786, 0.03278999775648117, -0.028697161003947258, 0.022072920575737953, 0.045234110206365585, 0.03092101402580738, -0.053656358271837234, -0.0036492475774139166, -0.01716388389468193, 0.0469374842941761, 0.01665523648262024, 0.009611065499484539, -0.05493389070034027, -0.009090589359402657, -0.007410870399326086, -0.025456015020608902, 0.009965934790670872, 0.010823537595570087, 0.011184322647750378, -0.02054697833955288, -0.014336751773953438, 0.009463202208280563, -0.019103839993476868, 0.01620573364198208, -0.007470015436410904, 0.05602215975522995, -0.020464176312088966, 0.0015111551620066166, -0.028318634256720543, 0.08005869388580322, -0.005497529171407223, 0.04953986406326294, -0.024391405284404755, 0.04703211784362793, 0.013236654922366142, -0.038113050162792206, -0.007842629216611385, 0.02391824498772621, 0.022072920575737953, 0.05143250524997711, -0.02344508469104767, -0.01595732569694519, 0.03113393671810627, 0.011213894933462143, -0.014987346716225147, 0.006641985382884741, -0.025290409103035927, 0.015980983152985573, -0.005574417766183615, 0.08199865370988846, -0.036338698118925095, 0.021185744553804398, -0.00948686059564352, 0.03849157691001892, 0.0008258122834376991, 0.017885452136397362, 0.03139417618513107, -0.002550628734752536, 0.043033912777900696, 0.03719038516283035, -0.01973077654838562, -0.0028936699964106083, 0.02872082032263279, -0.007304409518837929, -0.057157743722200394, 0.0013839934254065156, -0.010888597927987576, 0.04516313597559929, -0.03113393671810627, 0.0006239798967726529, 0.01881994493305683, -0.0389174222946167, -0.03380729258060455, 0.05550168454647064, -0.012869955971837044, 0.01780265010893345, 0.0389174222946167, 0.02204926125705242, 0.044335104525089264, 0.035155799239873886, 0.015921838581562042, 0.00142909144051373, 0.07324519008398056, -0.027537919580936432, -0.01058695837855339, -0.02193097211420536, 0.016879986971616745, 0.009268024004995823, 0.013887249864637852, -0.042584411799907684, -0.0014364846283569932, 0.019482368603348732, 0.033712659031152725, 0.0017240772722288966, -0.008859923109412193, -0.045541662722826004, -0.024746274575591087, 0.03236415237188339, -0.02256973832845688, -0.001284186146222055, -0.11507254093885422, -0.03943789750337601, -0.03991105780005455, 0.015342216938734055, -0.025361383333802223, -0.0024929624050855637, 0.023090213537216187, -0.022664370015263557, 0.03946155309677124, -0.039319608360528946, -0.004684285260736942, -0.028011079877614975, 0.040715429931879044, -0.016797184944152832, -0.004296885337680578, -0.01677352748811245, 0.021280376240611076, 0.009197049774229527, -0.020677097141742706, 0.022155722603201866, 0.0011163621675223112, -0.013437747955322266, 0.00564243458211422, 0.006529609672725201, -0.0080555509775877, -0.017672531306743622, -0.03532140329480171, -0.00756464758887887, -0.007617878261953592, 0.00013483215298037976, 0.02751426212489605, 0.0003713197947945446, 0.023090213537216187, 0.056637268513441086, -0.013887249864637852, 0.0054679568856954575, -0.012361308559775352, 0.005299393553286791, 0.009315339848399162, 0.042584411799907684, -0.018181178718805313, 0.019813580438494682, 0.02983274683356285, -0.05588021129369736, 0.005952945910394192, 0.022877292707562447, -0.04002934694290161, 0.002312570111826062, -0.02673354744911194, 0.005053941626101732, -0.03695380687713623, -0.018027400597929955, -0.011876319535076618, -0.029454218223690987, 0.0018541963072493672, 0.02654428407549858, -0.03439874202013016, -0.027987422421574593, 0.01601647026836872, -0.016879986971616745, 0.005547802429646254, 0.006186568643897772, 0.011758029460906982, 0.03794744238257408, -0.0070264278911054134, 0.006115594878792763, -0.01156876515597105, -0.06061181426048279, -0.019446881487965584, -0.024722617119550705, 0.0020183236338198185, -0.03794744238257408, 0.012313992716372013, -0.002087819157168269, 0.0224751066416502, 0.0071742902509868145, -0.030779065564274788, -0.03993471339344978, 0.050391554832458496, -0.07840263098478317, 0.022510593757033348, 0.0006058667786419392, 0.002401287667453289, 0.025290409103035927, 0.02238047495484352, -0.004716814961284399, -0.0057695964351296425, -0.00799640640616417, -0.03837328776717186, 0.028673503547906876, -0.022557908669114113, 0.05384562164545059, 0.001525941421277821, 0.01957700029015541, -0.027537919580936432, 0.02214389480650425, -0.010172942653298378, -0.02358703315258026, 0.020381372421979904, -0.013627011328935623, -0.03449337184429169, -3.8143913116073236e-05, 0.0214814692735672, -0.029525192454457283, -0.007487758994102478, 0.005195889621973038, 0.05271003767848015, -0.012243018485605717, -0.004376731347292662, -0.016312194988131523, -0.0065355245023965836, 0.027845473960042, -0.0194232240319252, -0.0018172306008636951, 0.013638840988278389, -0.03113393671810627, -0.025243092328310013, 0.02730133943259716, -0.0011119262780994177, -0.0356053002178669, 0.040857378393411636, -0.02358703315258026, -0.011267125606536865, -0.032719023525714874, -0.026662573218345642, 0.025030171498656273, -0.02193097211420536, 0.04327049478888512, -0.017601557075977325, 0.020476004108786583, -0.022971924394369125, 0.006807591300457716, -0.03849157691001892, -0.032506100833415985, 0.006275286432355642, 0.0009795892983675003, 0.014218461699783802, -0.0011355843162164092, 0.025361383333802223, 0.026567941531538963, 0.03640967234969139, -0.018015572801232338, -0.02893374115228653, -0.03300292044878006, 0.02675720490515232, 0.016454143449664116, -0.024533351883292198, -0.012538743205368519, 0.0017432993045076728, 0.01058695837855339, -0.05271003767848015, 0.011799430474638939, 0.021883655339479446, -0.006047578062862158, -0.007162461522966623, -0.046866510063409805, -0.012408624403178692, -0.005645391996949911, 0.011184322647750378, 0.00865883007645607, -0.009415886364877224, -0.0050214119255542755, -0.01512929517775774, -0.014076514169573784, 0.010155199095606804, 0.018334954977035522, -0.03981642425060272, 0.007316238712519407, -0.026331361383199692, -0.017601557075977325, 0.05129055678844452, -0.011414987966418266, -0.038775473833084106, -0.02323216199874878, 0.04859354719519615, -0.050912030041217804, 0.00032049205037765205, -0.012290334329009056, -0.015543309971690178, -0.023870928213000298, 0.045659951865673065, 0.02708841674029827, -0.020144792273640633, -0.002521056216210127, 0.018571535125374794, -0.02033405750989914, 0.003099198918789625, -0.0241666529327631, 0.015495994128286839, 0.03167806938290596, 0.030329564586281776, 0.0050125401467084885, -0.017932768911123276, -0.028791794553399086, -0.019647974520921707, -0.06042254716157913, 0.012183872982859612, 0.0009936363203451037, -0.020688926801085472, -0.05611679330468178, 0.005645391996949911, 0.004929737187922001, -0.0010535205947235227, -0.003879913128912449, 0.026709889993071556, -0.01336677372455597, -0.03342876210808754, -0.0181338619440794, 0.0335470549762249, 0.005219547543674707, 0.037426967173814774, -0.03366534411907196, 0.009185221046209335, 0.014786253683269024, -0.01644231379032135, -0.04953986406326294, 0.040407873690128326, 0.06307224184274673, 0.03922497481107712, 0.02992737852036953, 0.023717151954770088, 0.010799880139529705, -0.019103839993476868, -0.02498285472393036, 0.008162012323737144, -0.008647001348435879, 0.027112076058983803, 0.028200343251228333, 0.01217204425483942, 0.009469117037951946, -0.013485063798725605, -0.02039320208132267, -0.016394998878240585, 0.008256644010543823, -0.007848544046282768, -0.006180654279887676, 0.009835815988481045, -0.01737680658698082, -0.013142022304236889, -0.005810997914522886, 0.00814426876604557, -0.014395897276699543, 0.03411484509706497, -0.021587930619716644, 0.023788126185536385, -0.01680901274085045, 0.008457737043499947, 0.04196930304169655, 0.00242790300399065, -0.009380399249494076, -0.0042761848308146, -0.012881784699857235, -0.006795762572437525, 0.013686156831681728, -0.01101280190050602, -0.01716388389468193, -0.039083026349544525, -0.01963614486157894, -0.021670734509825706, -0.03506116569042206, -0.024840906262397766, 0.02169439196586609, -0.030518827959895134, -0.020381372421979904, 0.026355018839240074, -0.01722302846610546, 0.005189975257962942, -0.00045726491953246295, 0.0097116120159626, -0.010924084112048149, -0.1093946248292923, -0.029880061745643616, 0.03827865421772003, 0.025408698245882988, 0.0388464480638504, -0.03506116569042206, 0.015141123905777931, -0.028105711564421654, -0.0005263906205072999, -0.03004566766321659, -0.004172680899500847, -0.014431384392082691, 0.010326719842851162, 0.03231683745980263, 0.033050235360860825, -0.04530508071184158, -0.0211147703230381, -0.009197049774229527, -0.014029198326170444, -0.01764887198805809, -0.010669761337339878, 0.024391405284404755, 0.017305832356214523, 0.04407486692070961, -0.04783648997545242, -0.02090184949338436, 0.01734131947159767, 0.001661974936723709, -0.0015717787900939584, 0.009889046661555767, -0.027845473960042, -0.0018172306008636951, 0.014230291359126568, 0.034280452877283096, -0.02223852649331093, 0.021221231669187546, -0.0026615257374942303, -0.01244411151856184, -0.005204761400818825, 0.0016797184944152832, 0.016513288021087646, -0.05020229145884514, 0.07428614050149918, 0.010326719842851162, 0.010870854370296001, -0.030613459646701813, 0.026142098009586334, -0.026662573218345642, 0.005742981098592281, -0.033688999712467194, 0.003823725273832679, 0.02097282186150551, -0.005598075687885284, -0.023539716377854347, -0.012858126312494278, 0.011769858188927174, 0.0063817473128438, -0.01743595115840435, 0.008179755881428719, 0.02808205410838127, -0.017672531306743622, 0.02241596207022667, 0.0717310756444931, -0.03146515041589737, -0.06170007959008217, -0.015223926864564419, 0.007742082700133324, -0.0006764710997231305, 0.0038562549743801355, -0.01957700029015541, -0.017719846218824387, 0.014443213120102882, -0.00040773095679469407, 0.00942771602421999, -0.006458635907620192, -0.007126974407583475, -0.01535404659807682, 0.021256718784570694, -0.03728501871228218, 0.004885378293693066, 0.034280452877283096, -0.032837312668561935, 0.02000284381210804, -8.040025568334386e-05, -0.004060305189341307, 0.03728501871228218, 0.000491273298393935, 0.006931795738637447, -0.032719023525714874, 0.051574453711509705, 0.03357071056962013, -0.010640188120305538, 0.004270270001143217, -0.040620796382427216, 0.0036995208356529474, -0.017021935433149338, -0.010788051411509514, 0.03345242142677307, 0.02841326594352722, -0.003607846098020673, 0.042040277272462845, 0.040857378393411636, -0.01586269401013851, -0.025692595168948174, 0.020109305158257484, 0.00915564876049757, -0.020310398191213608, 0.02600014954805374, 0.018536048009991646, -0.005503443535417318, 0.0026807477697730064, -0.023705322295427322, -0.05166908726096153, -0.006174739915877581, 0.010551471263170242, 0.018725311383605003, 0.039059367030858994, 0.02048783376812935, 0.013059219345450401, 0.001604308607056737, 0.017412293702363968, 0.007245264481753111, -0.029099348932504654, 0.004740472882986069, -0.024391405284404755, -0.02588185854256153, -0.0047907461412250996, 0.017364976927638054, -0.0028729692567139864, -0.015803547576069832, 0.026449650526046753, -0.024320431053638458, 0.035676274448633194, -0.007759826257824898, 0.005042112432420254, 0.04987107589840889, 0.02214389480650425, -0.009587407112121582, -0.04835696518421173, 0.015803547576069832, 0.016253050416707993, -0.00847548060119152, 0.011799430474638939, 0.02413116581737995, 0.025243092328310013, -0.023267649114131927, 0.004897207487374544, -0.05602215975522995, 0.0017344276420772076, -0.01419480424374342, 0.053987570106983185, -0.012243018485605717, -0.008469566702842712, -0.0029188066255301237, -0.017672531306743622, 0.004400389268994331, 0.0092147933319211, 0.001916298526339233, -0.01360335387289524, 0.008788949809968472, 0.00791951734572649, 0.048830125480890274, 0.009273938834667206, 0.00832761824131012, -0.007807142101228237, -0.008670659735798836, -0.021706221625208855, 0.005627648439258337, -0.0015481207519769669, 0.02597649022936821, -0.005784382577985525, -0.02512480318546295, 0.014940030872821808, 0.021824510768055916, 0.02600014954805374, 0.006053492426872253, -0.0063817473128438, 0.0018394100479781628, 0.012231189757585526, 0.014123830012977123, 0.021079283207654953, -0.004308714531362057, -0.0483333058655262, 0.000568901130463928, 0.01915115676820278, -0.03293194621801376, -0.010575128719210625, 0.0051515307277441025, 0.002849311102181673, 0.011438646353781223, 0.0015348132001236081, 0.018169349059462547, -0.03025859035551548, 0.06236250698566437, 0.010208429768681526, 0.02585820108652115, -0.027703525498509407, 0.008505052886903286, 0.011556936427950859, -0.02126854844391346, -0.045352399349212646, 0.02144598215818405, -0.0001241121208295226, -0.017696188762784004, -0.0032115743961185217, 0.026047464460134506, -0.048073068261146545, 0.007056000642478466, 0.00025136632029898465, -0.007079658564180136, 0.008138353936374187, 0.0028167814016342163, -0.017731675878167152, 0.006707044783979654, -0.018417758867144585, -0.04726869612932205, 0.03804207593202591, -0.01646597310900688, -0.04745795950293541, -0.0014431383460760117, -0.025739911943674088, -0.024533351883292198, -0.007470015436410904, -0.010320805013179779, -0.03286097198724747, 0.005583289545029402, 0.013839934021234512, 0.022889120504260063, -0.0078012277372181416, -0.014703450724482536, -0.006505951751023531, 0.008386763744056225, -0.007611963432282209, -0.0018024443415924907, 0.00031753481016494334, 0.008404506370425224, -0.02805839665234089, -0.014005539938807487, -0.013130193576216698, -0.012124728411436081, -0.006180654279887676, 0.013780788518488407, -0.0031642583198845387, -0.0020848617423325777, -0.004829190671443939, -0.024320431053638458, 0.018938234075903893, 0.021741708740592003, -0.017719846218824387, -0.024060193449258804, -0.02362252026796341, 0.03366534411907196, 0.03624406456947327, -0.011805345304310322, 0.017719846218824387, 0.009179306216537952, -0.004536422900855541, 0.06458635628223419, 0.03286097198724747, 0.012160215526819229, -0.006866736337542534, -0.01737680658698082, -0.014549674466252327, -0.024095678701996803, 0.004234783351421356, -0.02075990103185177, 0.018051058053970337, 0.004524593707174063, -0.01546050701290369, -0.009859474375844002, -0.015791719779372215, -0.0015155910514295101, -0.006298944354057312, 0.039083026349544525, 0.008096952922642231, -0.005932244937866926, 0.02029857039451599, -0.013887249864637852, -0.007410870399326086, 0.02512480318546295, -0.03331047296524048, -0.027561577036976814, -0.030282247811555862, -0.037994757294654846, 0.03605480119585991, 0.016087444499135017, 0.010870854370296001, 0.0055300588719546795, -0.0016176161589100957, 0.004799617920070887, 0.02006199024617672, 0.025148460641503334, -0.01327214203774929, -0.0032648048363626003, -0.001517069642432034, -0.005799168720841408, -0.005119001027196646, 0.041496142745018005, 0.00020737721933983266, -0.01761338673532009, -3.51173548551742e-05, 0.03702478110790253, -0.024533351883292198, 0.014963689260184765, 0.0032500186935067177, 0.008404506370425224, 0.00910833291709423, 0.012988245114684105, -0.023610690608620644, -0.016536947339773178, -0.014407726004719734, -0.017743505537509918, -0.013201167806982994, 0.03423313423991203, 0.024604326114058495, -0.002365800552070141, 0.004838062450289726, -0.008108781650662422, 0.004870592150837183, 0.022617055103182793, -0.006174739915877581, -0.014963689260184765, 0.008445908315479755, 0.0004676152893807739, -0.014455041848123074, -0.01359152514487505, 0.015555139631032944, -0.016217563301324844, -0.00034304108703508973, 0.038988396525382996, -0.008836265653371811, 0.02893374115228653, 0.0037882383912801743, -0.01622939296066761, -0.011604252271354198, -0.006914052180945873, 0.010717077180743217, 0.0014786254614591599, -0.01282263919711113, -0.03551066666841507, 0.02286546304821968, 0.005027326289564371, -0.026686230674386024, 0.0037704948335886, 0.007771654985845089, -0.022948266938328743, 0.0042732274159789085, 0.013331286609172821, 0.01840592920780182, -0.026378678157925606, 0.06316687911748886, 0.0024559968151152134, -0.012633375823497772, -0.0008620386361144483, -0.004914951045066118, 0.03144149109721184, -0.0171047393232584, -0.00608602212741971, -0.0476708821952343, 0.00105943507514894, -0.011249382048845291, 0.03475361317396164, -0.019233958795666695, 0.004462491255253553, 0.03416216000914574, 0.004154937341809273, -0.010971400886774063, 0.004914951045066118, -0.0007356161368079484, 0.012692520394921303, 0.017660701647400856, 0.01885543204843998, -0.05446073040366173, 0.027845473960042, -0.018666166812181473, 0.003782323794439435, -0.016702553257346153, 0.008333533070981503, -0.008014149963855743, -0.007268922403454781, 0.0014165231259539723, -0.007322153076529503, -0.03726135939359665, -0.02072441391646862, 0.021895484998822212, -0.0059766038320958614, -0.06468098610639572, 0.0036492475774139166, -0.007901773788034916, 0.007233435288071632, 0.014845399186015129, 0.006908137816935778, -0.008652916178107262, -0.007245264481753111, -0.014667963609099388, 0.011030545458197594, 0.010415437631309032, -0.01282263919711113, 0.018334954977035522, 0.0029602081049233675, -0.03132320195436478, -0.021859997883439064, -0.0007163939881138504, -0.018003743141889572, 0.02708841674029827, -0.012609717436134815, -0.00513674458488822, 0.003655161941424012, 0.021800853312015533, 0.0051071722991764545, -0.012905442155897617, -0.0041017066687345505, 0.006053492426872253, 0.029690798372030258, 0.011811260133981705, -0.013130193576216698, 0.010190686210989952, 0.021351350471377373, 0.010019165463745594, 0.04407486692070961, -0.0036522047594189644, -0.0044713630340993404, 0.012278505600988865, -0.0027088418137282133, 0.021516956388950348, -0.015034663490951061, 0.002087819157168269, 0.021043796092271805, -0.004802575334906578, 0.0583406426012516, -0.009658381342887878, 0.025574304163455963, -0.009930448606610298, 0.01780265010893345, 0.024296773597598076, 0.04073908552527428, 0.016726210713386536, -0.0002820477820932865, -0.028318634256720543, 0.011574679985642433, -0.026780864223837852, 0.008256644010543823, 0.02739597111940384, -0.013307628221809864, -0.014502357691526413, -0.028129369020462036, 0.02500651217997074, -0.02775084227323532, -0.011320356279611588, 0.022759001702070236, -0.008771206252276897, -0.015425019897520542, 0.04814404249191284, 0.011485962197184563, -0.017294002696871758, 0.027845473960042, -0.038538891822099686, -0.01753058284521103, 0.02739597111940384, 0.019837237894535065, 0.008895410224795341, -0.013023732230067253, 0.02202560380101204, -0.00635808939114213, 0.012810810469090939, 0.00893089734017849, -0.0416380912065506, 0.04010032117366791, -0.007884030230343342, -0.03960350155830383, 0.010119711980223656, -0.009309425950050354, 0.0001679163979133591, 0.0006786890444345772, 0.021280376240611076, -0.020558807998895645, -0.007535075303167105, -0.00437377393245697, -0.01114883553236723, 0.010971400886774063, -0.02531406655907631, 0.01327214203774929, 0.015436849556863308, 0.007747997064143419, 0.041046641767024994, 0.002759115071967244, 0.004577824380248785, 0.007895859889686108, -0.022936437278985977, -0.012917271815240383, 7.664593795198016e-06, -0.01221936009824276, 0.005234334152191877, 0.010581043548882008, -0.0025875945575535297, 0.010581043548882008, -0.0067425318993628025, -0.012609717436134815, 0.023421427235007286, -0.011060117743909359, -0.0007903252844698727, -0.019080182537436485, -0.004391517490148544, 0.016525117680430412, 0.02555064670741558, -0.008854009211063385, -0.0048735495656728745, -0.02510114572942257, 0.0428919643163681, 0.012952758930623531, 0.011769858188927174, -0.0134259182959795, 0.0005729673430323601, -0.0004879463813267648, 0.04409852251410484, -0.010563299991190434, -0.007535075303167105, -0.0027842517010867596, 0.012420453131198883, -0.024817248806357384, -0.011385415680706501, 0.02319667488336563, -0.009948192164301872, -0.02401287667453289, -0.015555139631032944, -0.014821740798652172, 0.016454143449664116, 0.0024929624050855637, -0.021576102823019028, 0.012432282790541649, -0.02048783376812935, -0.021102942526340485, 0.04497386887669563, 0.0024929624050855637, -0.007978662848472595, -0.011781686916947365, -0.0037202215753495693, 0.011734371073544025, -0.01457333192229271, 0.012621546164155006, -0.01176394335925579, 0.0038917420897632837, -0.009723440743982792, -0.010427266359329224, 0.011805345304310322, 0.01128486916422844, -0.011953207664191723, 0.013638840988278389, -0.018867259845137596, 0.0085523696616292, -0.011302612721920013, 0.014999176375567913, 0.033712659031152725, 0.01137358695268631, 0.016004640609025955, -0.003859212389215827, 0.010935913771390915, -0.016726210713386536, -0.009841730818152428, 0.010699333623051643, 0.03049517050385475, -0.015235756523907185, -0.01572074554860592, 0.012905442155897617, 0.022404132410883904, -0.019541513174772263, 0.009977764450013638, -0.0073458109982311726, 0.0028448752127587795, -0.010261660441756248, -0.008759376592934132, 0.010539641603827477, 0.014502357691526413, -0.004143108613789082, -0.029525192454457283, 0.00852279644459486, 0.005896758288145065, -0.0011533278739079833, 0.010906340554356575, 0.03236415237188339, 0.03993471339344978, -0.01924578845500946, -0.010841281153261662, -0.004258441273123026, 0.025172118097543716, 0.006257542874664068, 0.01873714104294777, -0.0024367747828364372, -0.011000973172485828, 0.019860897213220596, -0.04114127159118652, 0.008156097494065762, 0.0010638709645718336, -0.004693157039582729, -0.00729258032515645, 0.06009133532643318, -0.004361944738775492, 0.03189099207520485, -0.03569993004202843, 0.017424121499061584, 0.020050160586833954, 0.014679793268442154, -0.0033032491337507963, -0.02000284381210804, 0.010628359392285347, -0.023717151954770088, 0.020192109048366547, -0.022617055103182793, 0.04275001958012581, 0.04887744039297104, -0.023456914350390434, -0.029856404289603233, 0.020807215943932533, 0.013627011328935623, -0.008091038092970848, 0.02687549591064453, -0.013839934021234512, -0.01397005282342434, -0.016454143449664116, -0.022155722603201866, 0.010841281153261662, 0.0004509807622525841, -0.002537321299314499, -0.019541513174772263, -0.0008139832643792033, 0.009457288309931755, 0.020286740735173225, 0.0033416934311389923, 0.025195777416229248, -0.0013403738848865032, 0.03002201020717621, -0.013910908252000809, -0.00279755936935544, 0.003800067352131009, 0.007209777366369963, -0.011302612721920013, -0.017696188762784004, -0.0035605300217866898, 0.003442239947617054, 0.02352788671851158, -0.0020360671915113926, -0.027703525498509407, 0.046984799206256866, -0.04327049478888512, -0.03399655595421791, -0.02829497493803501, 0.006547353230416775, -0.04393291845917702, 0.005396982654929161, 0.02455701120197773, -0.0012686606496572495, -0.014502357691526413, -0.003152429359033704, -0.01885543204843998, 0.03465897962450981, 0.040289584547281265, -0.018879089504480362, 0.028555214405059814, 4.181737494945992e-06, 0.0035605300217866898, 0.010232088156044483, 0.006269371602684259, -0.01027348916977644, -0.01828763820230961, -0.04338878393173218, 0.005757767241448164, -0.005979561246931553, 0.012018267065286636, -0.007162461522966623, 0.022285841405391693, -0.030400538817048073, 0.02226218394935131, 0.006097851321101189, 0.028791794553399086, 0.02576356939971447, -0.003578273579478264, -0.007387212477624416, 0.019352249801158905, -0.01517661102116108, 0.003498427802696824, 0.014774424955248833, 0.002870011841878295, -0.004001160152256489, 0.012680691666901112, -0.013260312378406525, 0.0006524434429593384, 0.016312194988131523, 0.021339522674679756, 0.03792378306388855, -0.020925506949424744, 0.0065946695394814014, 0.0045038932003080845, -0.03830231353640556, -0.007103316485881805, -0.01644231379032135, 0.005163359921425581, -0.003752751275897026, 0.012266675941646099, -0.009439544752240181, 0.011722542345523834, 0.04329415038228035, 0.027466945350170135, -0.002303698332980275, -0.030660776421427727, 0.02521943487226963, 0.020949164405465126, 0.011060117743909359, -0.0027014485094696283, -0.03674088418483734, -0.0025225349236279726, -0.025077486410737038, -0.003616717644035816, 0.030542487278580666, 0.02006199024617672, 0.040526166558265686, -0.027135733515024185, 0.0018926404882222414, -0.014715280383825302, -0.008871752768754959, -0.03189099207520485, -0.01119023747742176, 0.04681919515132904, 0.0063640037551522255, 0.01897372119128704, -0.03364168480038643, -0.02796376310288906, -0.023243991658091545, -0.032056599855422974, 0.02238047495484352, 0.010598787106573582, 0.034919217228889465, -0.025787226855754852, -0.00868840329349041, -0.013780788518488407, 0.015531481243669987, 0.01277532335370779, -0.009273938834667206, 0.02078355848789215, 0.011071947403252125]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" et al., 2022a; Go
et al., 2023) which directly learn a tractable approximation
q(s1:T)to the target distribution may thus be viewed as a
particularly simple instance of SMC , or inference more gen-
erally (see Korbak et al. (2022b)). We may also evaluate
these inference methods using our proposed tools in Sec. 5.
See Table 1 and App. E for detailed losses and discussion.
Finally, note that a separate proposal qmight also be learned
alongside the twisting targets {πt}T−1
t=1. This may be useful
to approximate the variance-minimizing proposal for multi-
step or adaptive resampling (Prop. A.5) beyond the tractable
optimal one-step proposal in Prop. 3.3. We discuss training
losses based on multi-step importance weights in App. C.1.
3.3. Conditional Target Distributions
More generally, we may consider conditional target distri-
butions, obtained by conditioning on an observation random
variable oT. This mirrors the standard setting of SMC in
state-space models (Doucet et al., 2001; Briers et al., 2010;
Gu et al., 2015; Maddison et al., 2017; Lawson et al., 2022),
with further discussion in App. B.2.
Defining ϕ(s1:T, oT) =σ(oT|s1:T)as a probabilistic model
ofoT, our target distribution is the posterior σ(s1:T|oT),
σ(s1:T|oT) =1
Zσ(oT)p0(s1:T)σ(oT|s1:T), (17)where the partition function Zσ(oT) = σ(oT) =P
s1:Tp0(s1:T)σ(oT|s1:T)is the marginal of the given oT.
In this setting, Prop. 3.2 suggests that the optimal twists,
which match the marginals σ(s1:t|oT), correspond to the
conditional likelihood of oTgiven s1:t,
ψ∗
t(s1:t, oT)∝X
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T, oT)
=σ(oT|s1:t),(18)
since σ(oT|s1:t) =P
st+1:Tσ(oT,st+1:T|s1:t). We can
proceed to construct intermediate target distributions and
proposals as in the previous sections, where ψt(s1:t, oT)and
evenqt(st|s1:t−1, oT)may be conditioned on a particular
value of oT.
To recover the unconditional setting, we can fix a binary
observational variable σ(oT= 1|s1:T):=ϕ(s1:T)(Levine,
2018) and omit explicit conditioning, showing that condi-
tional twist learning generalizes our previous exposition.2
Exact Target Sampling on Simulated Data Assum-
ingσ(oT|s1:T)is tractable to sample, we may obtain
an exact sample from the target posterior for simulated
oTusing ancestral sampling. In particular, by sampling
s1:T, oT∼p0(s1:T)σ(oT|s1:T), we obtain a sample from
the joint distribution, which also factorizes as σ(oT,s1:T) =
σ(oT)σ(s1:T|oT). Using the latter factorization, we may
interpret s1:Tas an exact sample from the target posterior
for the given oT.
We refer to this as the Bidirectional Monte Carlo (BDMC)
trick (Grosse et al., 2015; 2016), and will use it to draw exact
samples for training in Sec. 4.1.2 or evaluation in Sec. 5.
3.4. Connections with Reinforcement Learning
Twisted SMC shares close connections with (soft) rein-
forcement learning (Levine, 2018; Pich ´e et al., 2018; Law-
son et al., 2018; Heng et al., 2020), which we develop
with detailed discussion in App. B.3 and App. D. In par-
ticular, we consider language modeling as a Markov De-
cision Process ( MDP ) with states xt:=s1:t−1, actions
at:=st, and deterministic transitions p(xt+1|xt, at) =
δ(s1:t=concat (st,s1:t−","[0.01843949221074581, 0.010886323638260365, 0.04140255227684975, 0.013058826327323914, -0.03592665493488312, 0.018534725531935692, 0.013249292969703674, 0.017249079421162605, -0.05014017969369888, 0.03468862548470497, 0.03018886409699917, -0.015511076897382736, -0.015784870833158493, 0.004612849093973637, 0.029926974326372147, -0.03764084726572037, 0.03771227225661278, -0.006600838154554367, 0.005791357718408108, 0.02365349978208542, -0.025736721232533455, -0.0033033951185643673, -0.005446137860417366, 0.0009657222544774413, -0.0015906889457255602, -0.04621182009577751, 0.033569637686014175, -0.008886430412530899, 0.007053195033222437, 0.010773234069347382, 0.04923546686768532, -0.01617770828306675, -0.0569017231464386, -0.06061581149697304, 0.0001342934265267104, 0.08299557119607925, -0.002563851187005639, 0.027903271839022636, -0.02499866485595703, 0.02680809237062931, 0.01784428581595421, -0.026355735957622528, -0.0328315794467926, 0.04737842455506325, -0.0019299564883112907, 0.029307959601283073, -0.022165482863783836, 0.009213794022798538, -0.019784657284617424, 0.07328180223703384, -0.014927774667739868, 0.03404580056667328, -0.039021726697683334, -0.033641062676906586, -0.02029653638601303, -0.006178241688758135, 0.005824093706905842, 0.0037646798882633448, 0.0183680672198534, -0.027879463508725166, 0.017999039962887764, 0.0029150228947401047, 0.0059490869753062725, 0.005112822167575359, 0.008410265669226646, -0.011671995744109154, -0.033236321061849594, 0.03276015445590019, -0.050425879657268524, 0.03668851777911186, -0.013939731754362583, 0.0007998084765858948, 0.0419977568089962, 0.004318221937865019, 0.004324174020439386, 0.001316893962211907, -0.005481850355863571, 0.02887941151857376, 0.006124672945588827, -0.020665563642978668, 0.011183926835656166, -0.045069023966789246, 0.02083222195506096, -0.019856082275509834, -0.028260396793484688, -0.035164788365364075, -0.01508252788335085, 0.010868467390537262, -0.01517776120454073, -0.007231756579130888, -0.008225751109421253, 0.02158218063414097, -0.010862515307962894, -0.010535151697695255, 0.052282921969890594, -0.008070997893810272, 0.005758621264249086, 0.001633841311559081, 0.030855495482683182, -0.01191007811576128, 0.014011156745254993, -0.017463352531194687, 0.0004159004020038992, -0.05766358971595764, 0.06461559981107712, -0.023486841470003128, -0.003228994319215417, -0.00793409999459982, -0.03566476330161095, -0.0217964556068182, 0.015427747741341591, -0.031474508345127106, -0.0067436876706779, 0.05461613088846207, 0.03049837239086628, -0.03828367218375206, -0.041212085634469986, 0.0020251895766705275, -0.01564202271401882, -0.005446137860417366, -0.02699855901300907, 0.005458042025566101, 0.01634436473250389, 0.022748785093426704, 0.042997702956199646, 0.0325934998691082, 0.024308227002620697, -0.07128190994262695, -0.0024239777121692896, 0.02492723986506462, 0.027522340416908264, 0.013475471176207066, -0.01914183609187603, 0.0041396599262952805, 0.020141782239079475, -0.020534617826342583, -0.012677894905209541, 0.035307638347148895, -0.014154006727039814, -0.004199180752038956, -0.0023198167327791452, -0.009737575426697731, -0.012392195872962475, 0.015046815387904644, -0.02374873124063015, -0.023451128974556923, -0.05866353586316109, 0.011183926835656166, -0.021713126450777054, 0.0035385016817599535, -0.021903593093156815, -0.0399264395236969, -0.04380718618631363, 0.005716956686228514, -0.02880798652768135, -0.044569049030542374, -0.06237762048840523, 0.058139752596616745, 0.021713126450777054, -0.03473624214529991, 0.006124672945588827, 0.04411669075489044, -0.004416430834680796, 0.0060234880074858665, -1.2473757124098483e-05, -0.013642128556966782, -0.011862462386488914, 0.0651869997382164, -0.033474404364824295, -0.0369742177426815, -0.002208215417340398, -0.03999786451458931, -0.04718795791268349, -0.03049837239086628, 0.02071318030357361, -0.02172503061592579, 0.01420162245631218, -0.0920427069067955, -0.018475204706192017, -0.027212832123041153, -0.001248445245437324, 0.04002167284488678, -0.02073698863387108, -0.01057086419314146, 0.031069770455360413, 0.00167401775252074, -0.023213045671582222, 0.007029386702924967, 0.04373576119542122, -0.006446084473282099, -0.03197448328137398, 0.05528276413679123, 0.07304371893405914, -0.021010782569646835, -0.027879463508725166, -0.013915923424065113, 0.04961640015244484, 0.06318709999322891, 0.03233160823583603, -0.037378955632448196, 0.02654620260000229, 0.001982036978006363, -0.04537852853536606, -0.029260342940688133, -0.01723717525601387, 0.006404419895261526, -0.0005620979936793447, 0.00023399048950523138, -0.08761437237262726, 0.029617466032505035, 0.004556304309517145, -0.015046815387904644, 0.0443071573972702, 0.014558746479451656, -0.04814028739929199, -0.009142369031906128, -0.07494837790727615, -0.0025266509037464857, -0.031355470418930054, 0.05475898087024689, 0.03287919610738754, -0.005687196273356676, 0.0385693684220314, 0.03775988891720772, -0.03623615950345993, 0.00566636398434639, 0.0045771365985274315, -0.044949982315301895, 0.04147397726774216, -0.04206918179988861, 0.05518753081560135, 0.009451876394450665, 0.005038421601057053, -0.022379757836461067, 0.0077257780358195305, -0.027665190398693085, -0.017272887751460075, -0.033283937722444534, -0.01353499200195074, -0.0886143147945404, 0.013951635919511318, 0.01195769477635622, 0.04273581504821777, -0.0399264395236969, 0.027879463508725166, 0.031569741666316986, -0.01052324753254652, -0.01341595035046339, 0.01841568388044834, 0.023522553965449333, 0.029712699353694916, -0.020915549248456955, -0.024379650130867958, 0.01904660277068615, -0.030093630775809288, -0.00959472544491291, 0.0004486367688514292, 0.0017752028070390224, -0.05404473468661308, 0.010285165160894394, 0.01099346112459898, -0.04399765282869339, -0.03195067495107651, 0.005663387943059206, -0.007535311859101057, 0.005895518697798252, -0.019594192504882812, -0.014523033984005451, 0.08194800466299057, -0.04011690616607666, -0.013142155483365059, 0.02492723986506462, -0.01246361993253231, 0.015951529145240784, -0.00901737529784441, -0.04833075404167175, -0.000149452593177557, 0.03611711785197258, -0.013094538822770119, 0.025522446259856224, 0.01036849431693554, -0.04418811574578285, 0.03297442942857742, 0.005612795706838369, -0.004416430834680796, -0.00494914036244154, -0.008690012618899345, 0.018570438027381897, -0.0007648401078768075, -0.040640685707330704, 0.003175425808876753, -7.033199835859705e-06, -0.008481689728796482, -0.02001083642244339, 0.027260448783636093, 0.007428174838423729, 0.021296482533216476, 0.0015386083396151662, 0.008779292926192284, 0.02509389817714691, 0.03847413510084152, 0.0005955783417448401, -0.007213900797069073, 0.002273688092827797, 0.017903806641697884, -0.0027141408063471317, 0.02107030339539051, 0.04592612013220787, 0.020558426156640053, 0.010374446399509907, -0.016261037439107895, -0.03747418895363808, -0.012808839790523052, 0.014154006727039814, -0.01786809414625168, -0.03171259164810181, 0.06094912812113762, -0.033188704401254654, 0.016022954136133194, -0.01784428581595421, -0.044592857360839844, 0.012904073111712933, -0.0134873753413558, 0.0043092938140034676, 0.006446084473282099, -0.05675887316465378, 0.006088960450142622, -0.01145176962018013, -0.022570224478840828, -0.007338894065469503, 0.038997918367385864, 0.0015505125047639012, 0.0341886505484581, 0.04333101958036423, -0.027379490435123444, -0.026355735957622528, -0.0042229886166751385, 0.03964073956012726, 0.01198150310665369, 0.04014071449637413, -0.09661389142274857, 0.003217090154066682, -0.015487268567085266, -0.06409181654453278, 0.02492723986506462, 0.009172129444777966, -0.005410425364971161, 0.02367730811238289, 0.08156707137823105, -0.006898441351950169, 0.013915923424065113, -0.019415630027651787, 0.03023648075759411, -0.014284951612353325, -2.4877763280528598e-05, -0.0033926761243492365, -0.020344151183962822, -0.04416430741548538, 0.009820904582738876, -0.01515395287424326, -0.04056926444172859, -0.023034485056996346, 0.03978358954191208, -0.0034343404695391655, 0.012582661584019661, 0.039164576679468155, -0.011225591413676739, 0.004330126103013754, 0.015439651906490326, -0.0008169206557795405, 0.0035444535315036774, -0.005722908768802881, 0.006624646484851837, -0.0062080021016299725, -0.029784124344587326, 0.01803475059568882, 0.006713927257806063, -0.005517562385648489, 0.01723717525601387, 0.026189077645540237, 0.013570704497396946, -0.012713607400655746, -0.014749212190508842, -0.005633627995848656, 0.0013451662380248308, 0.010356590151786804, -0.009707815013825893, -0.011576763354241848, -0.00048025709111243486, -0.0013101978693157434, 0.0017052660696208477, 0.012856456451117992, -0.0729961022734642, 0.031664974987506866, -0.017034804448485374, 0.009178081527352333, -0.035188596695661545, 0.04554518684744835, 0.04161682724952698, 0.03035552240908146, -0.06275855749845505, 0.00020757821039296687, -0.058377835899591446, -0.01235648337751627, -0.028141355141997337, 0.0484497956931591, 0.03047456406056881, 0.031141195446252823, 0.005493754521012306, 0.06323471665382385, 0.03961693122982979, -0.04571184515953064, 0.018987081944942474, 0.013475471176207066, 0.05547323077917099, -0.04178348183631897, 0.002856990322470665, 0.016641968861222267, 0.061853840947151184, 0.05461613088846207, -0.020522713661193848, -0.043092936277389526, 0.03447435051202774, -0.006032416131347418, -0.03033171407878399, -0.002016261452808976, 0.029736507683992386, -0.014463513158261776, 0.04256915673613548, -0.033450596034526825, -0.002898654667660594, 0.050902046263217926, 0.02645096927881241, -0.038950301706790924, -0.029236534610390663, -0.025284364819526672, 0.02193930558860302, -0.004535472020506859, 3.552637645043433e-05, -0.04399765282869339, -0.014665883965790272, -0.007065099198371172, -0.022534511983394623, -6.829759968240978e-06, 0.0014969438780099154, 0.014642075635492802, -0.03183163329958916, -0.010678001679480076, 0.0001641467388253659, -0.010886323638260365, 0.003940265625715256, -0.008844765834510326, 0.03378390893340111, -0.02480820007622242, -0.004788435064256191, -0.035521913319826126, 0.07161522656679153, -0.016653873026371002, 0.04202156513929367, -0.031379278749227524, 0.017582394182682037, -0.0077972025610506535, -0.00825551152229309, -0.004865811672061682, 0.006547269411385059, 0.02507008984684944, 0.05590177699923515, -0.01096965279430151, 0.009678054600954056, 0.03242684155702591, 0.015392035245895386, -0.014106390066444874, 0.010183979757130146, -0.021975018084049225, -0.026093844324350357, 0.008362649008631706, 0.05694933980703354, -0.02837943658232689, 0.005187223199754953, 0.015427747741341591, 0.03459339216351509, 0.005880638491362333, 0.0028078858740627766, 0.03023648075759411, 0.014606363140046597, 0.025593871250748634, 0.017391929402947426, -0.026093844324350357, 0.013451662845909595, 0.029617466032505035, -0.015522981062531471, -0.04975925013422966, 0.016356268897652626, -0.0108982278034091, 0.0267366673797369, -0.05585416033864021, 0.009678054600954056, 0.0009523301268927753, -0.011529146693646908, 0.004937236197292805, 0.040831152349710464, -0.007761490531265736, 0.01643959805369377, 0.03873602673411369, 0.029760316014289856, 0.021153632551431656, 0.02167741395533085, -0.0003496837161947042, 0.006285378709435463, 0.05733027309179306, -0.01439208909869194, -0.00468427361920476, -0.031403087079524994, -0.009178081527352333, 0.014237334951758385, -0.005642556119710207, -0.048759300261735916, -0.025331981480121613, 0.023320183157920837, 0.05980633199214935, 0.005154486745595932, -0.014844445511698723, -0.058282602578401566, 0.005163414869457483, 0.013130251318216324, -0.01815379224717617, -0.012213633395731449, -0.09694720804691315, -0.04149778559803963, -0.041164468973875046, 0.0009374499786645174, -0.0009642342338338494, 0.014963487163186073, 0.027688998728990555, -0.021106015890836716, 0.010422063060104847, -0.045092832297086716, -0.0200822614133358, -0.02866513654589653, 0.03061741217970848, 0.0035265975166112185, -0.013594511896371841, -0.0028376460541039705, 0.013273101300001144, -0.006815112195909023, -0.014761116355657578, 0.005776477511972189, -0.01508252788335085, -0.0025980756618082523, 3.213184027117677e-05, 0.01432066410779953, -0.027474723756313324, -0.0016055690357461572, -0.0075293597765266895, -0.0003171333810314536, -0.0015430724015459418, -0.011166070587933064, -0.011106549762189388, -0.0007291277288459241, -0.005532442592084408, 0.025617679581046104, -0.03771227225661278, -0.002563851187005639, -0.00671987934038043, -0.0016903859796002507, 0.031569741666316986, 0.027236640453338623, -0.025284364819526672, 0.017582394182682037, 0.017951423302292824, -0.03404580056667328, 0.005463994108140469, 0.01610628329217434, -0.06999626010656357, 0.0071543799713253975, -0.023308278992772102, 0.008070997893810272, -0.03811701387166977, -0.021594084799289703, 0.01709432527422905, -0.02299877256155014, -0.010386350564658642, 0.026355735957622528, -0.05390188470482826, -0.02683190070092678, 0.01726098358631134, -0.0028227660804986954, 0.026236694306135178, -0.026189077645540237, 0.006255618296563625, 0.03599807992577553, -0.008684060536324978, -0.01702290028333664, -0.006380611564964056, -0.059949181973934174, -0.0015921768499538302, -0.019546575844287872, -0.00191210035700351, -0.03483147546648979, 0.004184300545603037, 0.016939571127295494, 0.02642716094851494, 0.0052318633534014225, -0.04580707848072052, -0.03773608058691025, 0.07028196007013321, -0.07366273552179337, 0.013380237855017185, 0.031355470418930054, 0.0066782147623598576, 0.011439865455031395, 0.033688679337501526, -0.0005483338027261198, -0.023903485387563705, 0.020439384505152702, -0.019368013367056847, 0.026260502636432648, -0.022213099524378777, 0.04364052787423134, 0.002681404585018754, 0.009499493055045605, -0.02133219502866268, 0.031165003776550293, 0.005752669181674719, -0.003684327006340027, 0.01443970575928688, 0.005056277848780155, -0.02668905071914196, 0.008743580430746078, 0.009826856665313244, -0.04718795791268349, -0.008445977233350277, 0.02454630844295025, 0.0325934998691082, -0.00966615043580532, -0.031522125005722046, -0.012856456451117992, -0.005788381677120924, 0.03430769219994545, -0.009963753633201122, 0.01714194193482399, 0.035426679998636246, -0.02020130306482315, -0.0056366040371358395, 0.033617254346609116, 0.0047854590229690075, -0.0198441781103611, 0.03185544162988663, -0.02170122228562832, -0.007684113457798958, -0.035521913319826126, -0.01871328614652157, 0.02854609489440918, -0.03030790574848652, 0.044902365654706955, -0.007118667475879192, 0.02391538955271244, 0.013023113831877708, -0.004496783949434757, -0.017594298347830772, -0.031664974987506866, 0.013737361878156662, -0.000311925308778882, 0.008088854141533375, -7.919034396763891e-05, 0.04521187022328377, 0.025974804535508156, 0.037331338971853256, -0.014499225653707981, -0.023736828938126564, -0.03202209994196892, 0.010719666257500648, 0.019975123926997185, 0.005972895305603743, -0.0022796401754021645, -0.027427107095718384, 0.014844445511698723, -0.03037933073937893, 0.02085603028535843, 0.021367907524108887, -0.0017186582554131746, -0.01923706755042076, -0.05461613088846207, -0.021296482533216476, -0.005952063016593456, -0.005984799470752478, 0.013225484639406204, 0.002992399735376239, -0.010053034871816635, -0.0002232023689430207, -0.004892596043646336, 0.005330072715878487, 0.015594405122101307, -0.025236748158931732, 0.018725190311670303, -0.03421245887875557, 0.002920974977314472, 0.035426679998636246, -0.022403566166758537, -0.04604516178369522, -0.0123326750472188, 0.02649858593940735, -0.033450596034526825, -0.02468915842473507, -0.012761223129928112, -0.03021267242729664, -0.017272887751460075, 0.03421245887875557, 0.050759196281433105, -0.023260662332177162, 0.009267362765967846, 0.030879303812980652, -0.02478439174592495, -0.0005074134096503258, -0.015534885227680206, 0.008767388761043549, 0.001702290028333664, 0.008380505256354809, -0.010856563225388527, -0.013058826327323914, -0.02080841362476349, -0.016987187787890434, -0.06809160113334656, 0.017034804448485374, -0.008142422884702682, -0.029688891023397446, -0.048521220684051514, 0.010808946564793587, 0.019737042486667633, -0.014701596461236477, 0.013796882703900337, 0.0069460575468838215, 0.002178455237299204, -0.02473677508533001, -0.00762459309771657, 0.023510649800300598, -0.0077972025610506535, 0.01596343331038952, 0.000757400062866509, -0.004633681382983923, 0.020748892799019814, -0.005517562385648489, -0.061853840947151184, 0.027403298765420914, 0.06690119206905365, 0.04966401681303978, 0.027617573738098145, 0.03242684155702591, 0.0006182705401442945, -0.019427534192800522, -0.014868253841996193, 0.008493593893945217, -0.02447488345205784, -0.00951139722019434, 0.015618213452398777, 0.007975764572620392, 0.001076579443179071, -0.019403725862503052, -0.04325959458947182, -0.01986798644065857, 0.01791571080684662, -0.01716575026512146, -0.023177333176136017, 0.039116960018873215, -0.013189772143959999, -0.018618052825331688, 0.00671987934038043, 0.0007105275290086865, -0.0003147153474856168, 0.030141247436404228, -0.02478439174592495, 0.028093738481402397, -0.023689212277531624, 0.014023060910403728, 0.03178401663899422, 0.03033171407878399, -0.011410105042159557, 0.009100704453885555, -0.018451396375894547, -0.0018153792480006814, 0.0044938079081475735, -0.014011156745254993, -0.020046548917889595, -0.029379384592175484, -0.018844231963157654, -0.02837943658232689, -0.027736615389585495, -0.03218875825405121, -0.015749158337712288, -0.04168825224041939, -0.0006565869553014636, 0.02497485652565956, -0.02687951736152172, 0.0021546469070017338, 0.00468427361920476, 0.01902279444038868, -0.0026070037856698036, -0.12332674860954285, -0.02095126174390316, 0.03987882286310196, -0.0015229841228574514, 0.022546416148543358, -0.03961693122982979, 0.023343991488218307, -0.02422489784657955, -0.006225857883691788, -0.05723503977060318, -0.03630758449435234, -0.014999199658632278, -0.005115798208862543, 0.02507008984684944, 0.044997598975896835, -0.045140448957681656, -0.019391821697354317, -0.016677681356668472, -0.004687249660491943, -0.01135653629899025, 0.01974894478917122, 0.03861698508262634, -0.008493593893945217, 0.05204484239220619, -0.026141460984945297, -0.022629743441939354, 0.01441589742898941, 0.022724976763129234, -0.005856830161064863, 0.0212369617074728, 0.007880531251430511, 0.002979007549583912, 0.00015884567983448505, 0.04337863624095917, -0.014939678832888603, 0.00619014585390687, 0.005904446821659803, 0.005416377447545528, -0.015582501888275146, 0.018284738063812256, 0.016356268897652626, -0.03871221840381622, 0.10218501836061478, 0.007160332053899765, 0.03825986385345459, -0.03033171407878399, 0.00019567407434806228, -0.024308227002620697, 0.01332071702927351, -0.04159301891922951, 0.005410425364971161, -0.006904393434524536, 0.0026605722960084677, -0.009320930577814579, 0.004478927701711655, -0.0003530317626427859, 0.0060830083675682545, 0.0017052660696208477, 0.01066609751433134, 0.04042641445994377, -0.012249345891177654, 0.0456642284989357, 0.0871858224272728, -0.03059360571205616, -0.060187261551618576, -0.028141355141997337, -0.00619014585390687, -0.006612742319703102, 0.0016442574560642242, 0.01540393941104412, -0.0037676559295505285, -0.0006417068070732057, -0.007838867604732513, 0.02210596203804016, 0.0002938831166829914, 0.0018748999573290348, -0.027427107095718384, 0.02278449758887291, -0.03583142161369324, 0.025855762884020805, 0.04928308352828026, -0.052378155291080475, 0.021546468138694763, 0.008392409421503544, -0.025403406471014023, 0.01817760057747364, -0.0065710777416825294, 0.02485581673681736, -0.02452250011265278, 0.057949285954236984, 0.027712807059288025, -0.022070249542593956, 0.02652239426970482, -0.048711683601140976, -0.012344579212367535, -0.014653979800641537, -0.001687409938313067, 0.009856617078185081, 0.02678428404033184, 0.001277461531572044, 0.025784337893128395, 0.03047456406056881, -0.02362969145178795, -0.019201355054974556, 0.025165323168039322, 0.03621235117316246, -0.003124833106994629, 0.029117492958903313, -0.0018004991579800844, -0.02130838669836521, 0.009749479591846466, -0.027736615389585495, -0.02483200840651989, 0.0059163509868085384, 0.01420162245631218, 0.007082954980432987, 0.04985447973012924, 0.0304031390696764, 0.004095019306987524, 0.015570597723126411, 0.029046067968010902, 0.004181324504315853, -0.025617679581046104, -0.009868521243333817, -0.015784870833158493, -0.023522553965449333, -0.0022900563199073076, 0.008565018884837627, -0.004065259359776974, 0.0035117173101752996, 0.026141460984945297, -0.003080192720517516, 0.038997918367385864, -0.005562203004956245, -0.0011606523767113686, 0.058473069220781326, 0.019832273945212364, 0.003404580056667328, -0.0534733347594738, 0.012035071849822998, 0.008672156371176243, -0.004065259359776974, -0.0017156822141259909, 0.026284310966730118, 0.014737308025360107, -0.010428015142679214, 0.013904019258916378, -0.03254588320851326, -0.00953520555049181, -0.011552955023944378, 0.029046067968010902, 0.012749318964779377, 0.007743634283542633, -0.007672209292650223, 0.005091989878565073, -0.001328054117038846, -0.012844552285969257, -0.01914183609187603, -0.02167741395533085, -0.011880317702889442, 0.017249079421162605, 0.03461720049381256, 0.0019998932257294655, -0.0038182486314326525, 0.008380505256354809, -0.01622532494366169, -0.00863049179315567, -0.0019522766815498471, -0.03052218072116375, 0.010743473656475544, -0.0013176379725337029, -0.03766465559601784, 0.013975444249808788, 0.03433150053024292, 0.01974894478917122, 0.003467076923698187, -0.010927988216280937, -0.015689639374613762, 0.008243607357144356, 0.007690065540373325, 0.030855495482683182, 0.018260929733514786, -0.04137874394655228, 0.019034698605537415, 0.03209352493286133, -0.046926066279411316, -0.027950888499617577, -0.007047242950648069, -0.0025846834760159254, 0.0030623364727944136, -0.017534777522087097, 0.01351118367165327, -0.00621395418420434, 0.04918785020709038, 0.006648454815149307, 0.03459339216351509, -0.050568729639053345, 0.0029998398385941982, 0.012987402267754078, -0.03378390893340111, -0.05933016538619995, 0.02029653638601303, -0.001514800125733018, -0.006100864615291357, -0.02182026393711567, 0.02511770650744438, -0.015856295824050903, 0.009320930577814579, -0.013844499364495277, 0.002578731393441558, 0.015653926879167557, -0.006832968443632126, -0.023355895653367043, 0.007035338785499334, -0.02645096927881241, -0.05590177699923515, 0.028688944876194, -0.008195990696549416, -0.050283029675483704, -0.0006588189862668514, -0.04990209639072418, -0.026379544287919998, -0.011999359354376793, 0.00898166373372078, -0.03995024785399437, 0.00770196970552206, 0.0321173332631588, 0.007999572902917862, -0.02220119535923004, -0.0044432152062654495, 0.006648454815149307, 0.012963593937456608, -0.0040057385340332985, 0.005767549388110638, -0.012737414799630642, 0.014023060910403728, -0.004874739795923233, -0.015261090360581875, 0.003413508180528879, -0.014844445511698723, -0.007065099198371172, 0.0036039743572473526, 0.015511076897382736, -0.026355735957622528, 0.010422063060104847, -0.021272674202919006, 0.03421245887875557, 0.02408204786479473, -0.05747312307357788, -0.016475310549139977, -0.03249826654791832, 0.029498424381017685, 0.030855495482683182, -0.010910131968557835, 0.006553221493959427, 0.0067913043312728405, -0.019439438357949257, 0.062282390892505646, 0.050663962960243225, 0.007088907063007355, -0.013844499364495277, -0.0100411307066679, -0.005288408137857914, -0.016165804117918015, 0.011130358092486858, -0.029665082693099976, 0.019832273945212364, 0.012439812533557415, -0.03276015445590019, -0.005205079447478056, -0.023272566497325897, -0.006832968443632126, -0.012368387542665005, 0.03304585441946983, -0.0017766908276826143, -0.01045182254165411, 0.015487268567085266, -0.02379634790122509, -0.010600624606013298, 0.02652239426970482, -0.038950301706790924, -0.026379544287919998, -0.03999786451458931, -0.03980739787220955, 0.04792601242661476, 0.03185544162988663, 0.023832060396671295, 0.005124726332724094, 0.01513014454394579, -0.013165963813662529, 0.04990209639072418, 0.01517776120454073, -0.022594032809138298, -0.0037587278056889772, -0.0031813778914511204, -0.00038986012805253267, 0.00048434914788231254, 0.03847413510084152, 0.0152015695348382, -0.01343975868076086, -0.015856295824050903, 0.01420162245631218, -0.0396883562207222, 0.00891023874282837, 0.021367907524108887, 0.02864132821559906, 0.0010468191467225552, -0.0004103203536942601, -0.010963700711727142, -0.025451023131608963, -0.02511770650744438, -0.01723717525601387, -0.008862622082233429, 0.019998932257294655, 0.0250224731862545, 0.0015743207186460495, 0.01535632275044918, 0.004172396380454302, -0.01529680285602808, 0.01841568388044834, 0.0023332086857408285, -0.021225057542324066, 0.019272780045866966, -0.00865430012345314, -0.01834425888955593, 0.008856669999659061, 0.0067436876706779, -0.014570650644600391, -0.00518424715846777, 0.017201462760567665, -0.02304638922214508, 0.017415737733244896, -0.02871275320649147, -0.012368387542665005, 0.010719666257500648, 0.007612688932567835, -0.02384396456182003, -0.004696177784353495, -0.016118187457323074, -0.027808038517832756, 0.008636443875730038, -0.012017215602099895, -0.011481530033051968, 0.01608247496187687, 0.029403192922472954, -0.00661869440227747, 0.002096614334732294, 0.01057086419314146, 0.020915549248456955, -0.012963593937456608, 0.057854052633047104, 0.00770196970552206, -0.02224881201982498, -0.003258754499256611, -0.004904500208795071, 0.01591581664979458, -0.04237869009375572, 0.013177867978811264, -0.04056926444172859, -0.0035533816553652287, -0.007463887333869934, 0.04009309783577919, -0.019129931926727295, -0.0009262898238375783, 0.02695094235241413, -0.0030653125140815973, -0.028188971802592278, 0.0060115838423371315, 0.00904118362814188, -0.003720039501786232, 0.01926087588071823, 0.02311781421303749, -0.03023648075759411, 0.023832060396671295, -0.004693201743066311, 0.0047229621559381485, -0.020046548917889595, 0.007243660744279623, -0.009785192087292671, -0.01885613612830639, 0.00018414195801597089, -0.02092745341360569, -0.04568803682923317, -0.022296428680419922, 0.006749639753252268, -0.02468915842473507, -0.04047403112053871, 0.006916297599673271, 0.007761490531265736, 0.027498532086610794, 0.015237282030284405, -0.0010036666644737124, -0.010933940298855305, 0.018748998641967773, -0.014380184933543205, 0.014213526621460915, -0.009749479591846466, -0.025736721232533455, 0.01226125005632639, 0.01704670861363411, -0.0304031390696764, -0.0029700794257223606, 0.03430769219994545, -0.019391821697354317, 0.01006493903696537, 7.616780931130052e-05, -0.013820691034197807, 0.023415416479110718, 0.02405823953449726, -0.007672209292650223, -0.008916190825402737, 0.011761276982724667, -0.00016944779781624675, 0.011606522835791111, 0.019034698605537415, -0.020344151183962822, 0.012737414799630642, -0.0018629957921802998, 0.010178027674555779, 0.04754507914185524, -0.012523140758275986, -0.004612849093973637, -0.009576870128512383, 0.002176967216655612, 0.005943134892731905, 0.0012863896554335952, 0.018546629697084427, 0.01897517777979374, -0.00895785540342331, 0.05566369369626045, -0.0209988784044981, 0.01636817306280136, -0.005100918002426624, 0.010838706977665424, 0.00010369610390625894, 0.029903165996074677, -0.014023060910403728, -0.015772966668009758, -0.012392195872962475, 0.027712807059288025, -0.020594138652086258, 0.007463887333869934, 0.02283211424946785, -0.00851145014166832, -0.021534563973546028, -0.03414103388786316, 0.026260502636432648, -0.03847413510084152, 0.01887994445860386, -0.0005107613978907466, -0.025998612865805626, -0.02020130306482315, 0.03473624214529991, 0.009820904582738876, -0.040878769010305405, 0.011636283248662949, -0.03568857163190842, -0.011237495578825474, 0.03766465559601784, 0.03792654722929001, -0.014380184933543205, -0.0032914909534156322, -0.006112768780440092, -0.011291064321994781, 0.011648187413811684, -0.0072377086617052555, -0.056187476962804794, 0.012904073111712933, 0.0008184086764231324, -0.015451556071639061, 0.010987509042024612, -0.008844765834510326, -0.0056693400256335735, -0.011648187413811684, 0.018546629697084427, -0.018213313072919846, -0.027474723756313324, -0.0020266775973141193, 0.002139766700565815, 0.016772914677858353, -0.02645096927881241, 0.013761170208454132, 0.009434020146727562, 0.008951903320848942, 0.021379811689257622, 0.021498851478099823, -0.01036849431693554, 0.010779186151921749, -0.019534671679139137, 0.009648294188082218, 0.0069579617120325565, 8.700242324266583e-05, 0.014820637181401253, 0.025784337893128395, -0.014689692296087742, 0.0056693400256335735, -0.006803208030760288, -0.015487268567085266, 0.025212939828634262, 0.001702290028333664, 0.00721985287964344, -0.003255778457969427, -0.0051366304978728294, 0.033569637686014175, 0.019701329991221428, -0.008612635545432568, 0.0026546202134341, -0.011677947826683521, 0.02461773343384266, 0.0055026826448738575, 0.026403352618217468, -0.03206971660256386, -0.01608247496187687, 0.0003796300443354994, 0.015784870833158493, -0.002679916564375162, -0.013582608662545681, -0.002779613481834531, -0.004127755761146545, -0.02649858593940735, -0.005764573346823454, 0.0378551222383976, -0.019475150853395462, -0.009475684724748135, -0.03285538777709007, -0.013070730492472649, 0.009975657798349857, 0.0041634682565927505, -0.03030790574848652, 0.00951139722019434, -0.013058826327323914, -0.01914183609187603, 0.031331662088632584, -0.0004397086740937084, -0.017784764990210533, 0.00470808194950223, 0.01138034462928772, 0.015820583328604698, -0.01820140890777111, 0.0076007847674191, -0.004353934433311224, 0.005812189541757107, -0.004836051259189844, -0.01742764189839363, 0.015023007057607174, 0.0008132006623782218, 0.0021576229482889175, 0.00992208905518055, -0.011666043661534786, 0.0246653500944376, 0.0019418606534600258, -0.008928094990551472, 0.012606469914317131, -0.0049193804152309895, 0.012570757418870926, 0.006416324060410261, -0.00844002515077591, -0.025212939828634262, 0.004586064722388983, 0.038807451725006104, 0.01803475059568882, -0.010243500582873821, -0.010868467390537262, 0.022022634744644165, 0.007594832684844732, -0.009719719178974628, 0.016403885558247566, -0.008719773031771183, 0.0018287714337930083, 0.0036456387024372816, -0.02116553671658039, 0.0026546202134341, 0.01740383356809616, -0.009553061798214912, -0.05123535916209221, 0.012112448923289776, -0.007332941982895136, -0.02268926426768303, 0.015118240378797054, 0.0074579352512955666, 0.02866513654589653, -0.030117439106106758, -0.02307019755244255, 0.006237762048840523, 0.024355841800570488, 0.0002871870528906584, 0.029331767931580544, -0.025308173149824142, -0.005154486745595932, 0.023284470662474632, -0.009124512784183025, 0.0026754525024443865, 0.00461582513526082, 0.000982834491878748, 0.0016100330976769328, 0.07094859331846237, -0.017951423302292824, 0.013523087836802006, -0.035140980035066605, -0.013832595199346542, 0.007160332053899765, 0.030093630775809288, 0.004767602775245905, -0.03180782496929169, 0.013499279506504536, -0.013868307694792747, 0.03033171407878399, -0.014761116355657578, 0.03818843886256218, 0.04435477405786514, -0.015927720814943314, -0.01246361993253231, 0.011368440464138985, 0.0030474562663584948, -0.02128457836806774, 0.014094485901296139, -0.020379863679409027, -0.0020802461076527834, -0.01810617558658123, -0.01798713579773903, -0.009047135710716248, -0.016653873026371002, -0.011017268523573875, -0.023522553965449333, 0.00795790832489729, 0.01242790836840868, 0.011588666588068008, 0.023415416479110718, 0.01610628329217434, -0.029284151270985603, 0.031664974987506866, -0.019582288339734077, 0.01880851946771145, 0.01142796128988266, 0.01255885325372219, -0.013927827589213848, -0.025189131498336792, 0.005291384179145098, -0.007690065540373325, 0.03302204608917236, -0.0050860377959907055, -0.017058612778782845, 0.027165217325091362, -0.034926705062389374, -0.022451182827353477, -0.033426787704229355, -0.02278449758887291, -0.039188385009765625, 0.0004984852857887745, 0.008719773031771183, 0.005466970149427652, -0.011231543496251106, 0.01140415295958519, -0.0031426893547177315, 0.040640685707330704, 0.05480659753084183, -0.01897517777979374, 0.04256915673613548, 0.009082848206162453, -0.008600731380283833, 0.013665936887264252, 0.005809213500469923, 0.004529519937932491, -0.003705159295350313, -0.025427214801311493, 0.027641382068395615, 0.0005475897924043238, -0.009428068064153194, -0.0028912147972732782, 0.041069235652685165, -0.021760743111371994, 0.020141782239079475, 0.008928094990551472, 0.0301650557667017, 0.028998451307415962, -0.0017201462760567665, -0.013142155483365059, 0.0011584203457459807, 0.0028778226114809513, -0.010505391284823418, 0.022415470331907272, 0.013225484639406204, 0.009755431674420834, 0.026093844324350357, -0.006172289606183767, 0.0008585851173847914, 0.0020430455915629864, 0.031165003776550293, 0.019534671679139137, -0.019856082275509834, -0.004422382917255163, 0.021665509790182114, -0.021367907524108887, -0.019665617495775223, -0.03221256658434868, 0.014534938149154186, -0.005621723830699921, -0.011177974753081799, -0.022915443405508995, 0.00468427361920476, 0.04918785020709038, 0.02483200840651989, -0.007844819687306881, -0.015784870833158493, 0.027641382068395615, -0.010862515307962894, 0.0020415575709193945, -0.01180294156074524, -0.021927401423454285, 0.00825551152229309, -0.013451662845909595, -0.0011279159225523472, 0.006904393434524536, 0.006981770042330027, 0.029926974326372147, -0.009541157633066177, -0.022213099524378777, -0.007547216024249792, -0.011005365289747715, -0.007267469074577093, 0.004725938197225332, 0.03278396278619766, 0.028046121820807457, 0.00710081122815609, -0.018653765320777893, -0.025308173149824142, -0.031022153794765472, -0.014332568272948265, 0.018629956990480423, -0.011041076853871346, 0.020891740918159485, -0.02685570903122425, -0.0123326750472188, -0.02073698863387108, 0.01707051694393158, 0.0032736347056925297, -0.0047229621559381485, 0.006815112195909023, 0.0016025929944589734]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"1)). We describe two differ-
ent definitions of the reward function in relation to the
potential function ϕ(s1:T)below. In App. B.1, we further
extend our SMC framework to capture settings with interme-
diate potentials ϕt(s1:t)or rewards over partial sequences.
2To obtain a probabilistic interpretation for σ(oT= 1|s1:T) =
ϕ(s1:T), note we need to ensure ϕ(s1:T)∈[0,1]. As a result,
sampling from the target σ(s1:T|oT= 1) or joint σ(s1:T, oT= 1)
is no easier in this interpretation than in Eq. (1), which is intractable
in general. For example, finding ϕmax= max s1:Tϕ(s1:T)and
dividing ϕ(s1:T)←ϕ(s1:T)/ϕmaxto rescale σ(oT= 1|s1:T)is
equivalent to being able to perform rejection sampling with the
base model proposal p0(s1:T)(see Sec. 4.1.2).
5
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Base Model Policy Evaluation Viewing the final
potential ϕ(s1:T)as the reward function, the optimality
condition ψ∗
t(s1:t) =P
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T)in
Eq. (12) corresponds to exact policy evaluation of the future
reward under the fixed base model policy p0(st+1:T|s1:t).
Mudgal et al. (2023) adopt this perspective for controlled
decoding, and refer to the twist functions as ‘prefix scorers’.
Soft RL with KL Regularization Alternatively, we may
consider the soft or KL-regularized RLtarget distributions
commonly used in language modeling (Levine, 2018; Ko-
rbak et al., 2022b) as a special case of our twisted SMC
framework. For a regularization strength β, define the ter-
minal potential as
ϕ(s1:T) =eβr(s1:T). (19)
In this case, the intermediate twist functions in Def. 3.1 cor-
respond to state-action Q-values, ψt(s1:t) =eβQ(st,s1:t−1)
(App. B.3). In particular, consider the recursion for the
optimal twists in Eq. (13). Taking the logarithm of both
sides and recalling the definition of the soft value function
V∗(s1:t)(Levine, 2018), we obtain
Q∗(st,s1:t−1) =1
βlogX
st+1p0(st+1|s1:t)eβQ∗(st+1,s1:t)
| {z }
V∗(s1:t),(20)
which is a soft Bellman recursion with no intermediate
reward. From the soft RLperspective, the twist functions
are analogous to a critic, while the proposal plays the role of
an actor (Levine, 2018; Haarnoja et al., 2018). We provide
detailed discussion of the soft RL case in App. B.3, and
review RL-inspired losses for twist learning in App. C.1.
Benefits of the Probabilistic Perspective While soft RL
is a natural special case of our framework which gives intu-
ition for the role of the twist functions, our approach allows
for general target distributions without reference to RLob-
jectives and suggests principled probabilistic resampling
using SMC . Further, we develop twist learning techniques
inspired by density ratio estimation, including our novel
CTL method or the SIXO objective from (Lawson et al.,
2022), which are more naturally motivated from a proba-
bilistic perspective. Finally, we leverage our probabilistic
perspective to propose novel language model evaluation
techniques inspired by Bidirectional Monte Carlo (Grosse
et al. (2015; 2016)) in Sec. 5.
4. Learning the Twist Functions
We next consider methods to learn twist functions ψθ
tparam-
eterized by neural networks, presenting a novel contrastive
twist learning (CTL ) approach in Sec. 4.1. We summarize
twist learning methods from related work in Sec. 4.2.4.1. Contrastive Twist Learning
To match our approximate πθ
tto the target marginals, we
propose to minimize Tseparate KL divergences,
min
θ","[-0.006249839439988136, -0.009021669626235962, 0.010620683431625366, -0.0018401095876470208, -0.024825146421790123, 0.02014632150530815, 0.022771939635276794, 0.007441322319209576, -0.04581763967871666, 0.032652221620082855, 0.031781166791915894, -0.02752542681992054, -0.017558036372065544, 0.03638532757759094, 0.04522034153342247, -0.05609612166881561, 0.042582280933856964, 0.01737138070166111, -0.00619073212146759, 0.018155332654714584, -0.024252736940979958, -0.02655481919646263, -0.04141257703304291, 0.04489680752158165, 0.0038419871125370264, -0.009307874366641045, 0.011765501461923122, 0.0034624547697603703, 0.003282021265476942, -0.006389831192791462, 0.023381680250167847, -0.025534436106681824, -0.038077667355537415, -0.047957953065633774, -0.017396267503499985, 0.05370693281292915, -0.0019785454496741295, 0.02361810952425003, 0.0005521884304471314, 0.037380822002887726, 0.014882644638419151, -0.056643642485141754, -0.005686762742698193, 0.04865479841828346, 0.0027127228677272797, 0.0448470339179039, 0.01392448041588068, 0.008243939839303493, -0.021801332011818886, 0.039496250450611115, -0.044050637632608414, 0.045693203806877136, -0.008803904987871647, -0.006476936861872673, 0.003140474436804652, 0.006700923200696707, -0.004657048266381025, -0.006439605727791786, 0.01025981642305851, -0.030586572363972664, 0.01790645904839039, -0.03028792329132557, 0.011217979714274406, 0.009836731478571892, -0.018528643995523453, -0.019934779033064842, -0.05943102762103081, 0.03188071399927139, -0.020718730986118317, 0.03996910899877548, 0.012561897747218609, 0.01927526481449604, 0.014521777629852295, 0.0056649865582585335, -0.022336410358548164, 0.019797898828983307, 0.025609098374843597, 0.06102382019162178, 0.02285904437303543, -0.01845398172736168, 0.015193736180663109, -0.054105132818222046, 0.02774941176176071, -0.01921304687857628, -0.009003004059195518, -0.04325424134731293, -0.03782879561185837, -0.00893456395715475, -0.011603734456002712, -0.010154045186936855, -0.005164128262549639, 0.006249839439988136, -0.017508260905742645, 0.011796611361205578, 0.051815494894981384, -0.004349066875874996, -0.0005681318580172956, -0.00044797256123274565, 0.0449465811252594, 0.020121434703469276, -0.0032913540489971638, -0.0063711656257510185, 0.02779918722808361, -0.0063649434596300125, 0.06470715254545212, -0.009818065911531448, 0.0028698244132101536, 0.01699807122349739, -0.04895344749093056, -0.01457155216485262, -0.05554860085248947, -0.008698133751749992, -0.04203476011753082, 0.014409784227609634, 0.014297791756689548, -0.05206436663866043, -0.03934692591428757, -0.006178288254886866, -0.013264965265989304, -0.02053207717835903, -0.027326326817274094, -0.005406780168414116, 0.03996910899877548, 0.013613388873636723, 0.00671958876773715, -0.00559032429009676, 0.0008026175200939178, -0.049052998423576355, -0.00047597085358574986, 0.04026775807142258, 0.0009122774936258793, 0.01167217455804348, -0.01824243925511837, -0.023481229320168495, -0.026081958785653114, -0.011217979714274406, -0.0020640958100557327, 0.016761640086770058, -0.0010857112938538194, 0.01281699351966381, -0.0032789104152470827, -0.04539455473423004, -0.038625191897153854, -0.00925809983164072, -0.03041236102581024, -0.01916327141225338, -0.034220125526189804, 0.0029740401078015566, -0.033000648021698, 0.025534436106681824, -0.008685690350830555, -0.02762497588992119, -0.038077667355537415, 0.03541472181677818, -0.022834157571196556, -0.05246256664395332, -0.03972023352980614, 0.06525467336177826, 0.0312834195792675, -0.033523280173540115, 0.014720876701176167, 0.03529028221964836, -0.006224952172487974, -0.00026287278160452843, 0.025658873841166496, -0.005506329704076052, -0.016686977818608284, 0.056544095277786255, -0.045518990606069565, -0.036012016236782074, 0.0042837378568947315, -0.057788461446762085, -0.049102772027254105, -0.04382665082812309, 0.00784574169665575, -0.02237374149262905, 0.004949474707245827, -0.06844025105237961, -0.004918365739285946, -0.02155245840549469, -0.0164007730782032, 0.045245230197906494, -0.039770010858774185, -0.016898520290851593, 0.006396052893251181, 0.030686121433973312, -0.02236129716038704, 0.040790390223264694, 0.01698562689125538, 0.018093114718794823, 0.005948080215603113, 0.06211886182427406, 0.06928642839193344, -0.0010320479050278664, -0.016512766480445862, 0.005549882538616657, 0.05161639675498009, 0.03377215564250946, 0.005201459396630526, -0.013414289802312851, 0.011497962288558483, 0.01922548934817314, -0.023543447256088257, -0.04848058894276619, -0.002743832068517804, -0.006657370366156101, 0.009861618280410767, 0.01976056769490242, -0.09148595482110977, -0.006047629751265049, 0.0027267220430076122, -0.007509762421250343, 0.05878395587205887, 0.027027677744627, -0.03551426902413368, 0.024551386013627052, -0.007721304893493652, -0.003978867549449205, -0.0007668419275432825, 0.06754431128501892, 0.01628877967596054, 0.0004666380991693586, 0.0238918699324131, 0.022336410358548164, -0.05510062724351883, 0.02458871714770794, 0.003953980281949043, -0.010521133430302143, 0.05340828746557236, -0.014409784227609634, 0.0687389001250267, 0.010465136729180813, -0.021042266860604286, -0.037331048399209976, 0.0022756385151296854, -0.02458871714770794, -0.012499678879976273, 0.005612100940197706, 0.01682385802268982, -0.06729543209075928, 0.009575413540005684, 0.01500708144158125, 0.022299079224467278, -0.0051703499630093575, 0.03327440842986107, 0.05042180046439171, -0.01943703182041645, 0.015119073912501335, 0.021751556545495987, -0.006100515369325876, -0.0027142781764268875, -0.03359794244170189, 0.0006229618447832763, 0.02205020561814308, -0.025161126628518105, 0.016624759882688522, 2.6661562515073456e-05, 0.023680327460169792, -0.04143746197223663, 0.0010810449020937085, 0.017495818436145782, -0.03787856921553612, -0.01893928460776806, 0.02974040061235428, -0.023817207664251328, -0.024451836943626404, -0.017446042969822884, -0.00019209935271646827, 0.06216863915324211, -0.03902338817715645, -0.002099871402606368, -0.006470715161412954, -0.032378461211919785, 0.039446473121643066, -0.018205108121037483, -0.04972495511174202, 0.04310491681098938, 0.008505256846547127, -0.017620254307985306, 0.05515040084719658, 0.00374554842710495, -0.0418107733130455, 0.046066511422395706, 0.0012093704426661134, -0.012107702903449535, 0.011074877344071865, -0.011740614660084248, -0.001847886829636991, -0.03061145916581154, -0.060725171118974686, -0.026355719193816185, -0.0009760513785295188, 0.007291997782886028, -0.02660459280014038, 0.02274705097079277, 0.03046213462948799, 0.01528084184974432, -0.006445827428251505, 0.013775156810879707, 0.004053529817610979, 0.04093971475958824, 0.013264965265989304, -0.022834157571196556, 0.03028792329132557, 0.022672390565276146, 0.0060289641842246056, 0.013887150213122368, -0.0028993780724704266, -0.0037051064427942038, 0.005966745782643557, -0.006806694436818361, -0.011068656109273434, -0.01044647116214037, 0.00996116828173399, -0.027674749493598938, -0.02416563220322132, 0.04449860751628876, 0.0010273815132677555, 0.020059216767549515, -0.02518601343035698, -0.06406007707118988, 0.007665308658033609, -0.0032602448482066393, -0.011659730225801468, 0.013899593614041805, -0.015044412575662136, -0.026679255068302155, -0.005689873825758696, -0.028695132583379745, 0.01611456833779812, 0.02969062700867653, -0.023792320862412453, 0.03947136178612709, 0.027450764551758766, -0.032602448016405106, -0.05967990309000015, -0.03175627812743187, 0.04088994115591049, 0.004856147337704897, 0.028371596708893776, -0.07998799532651901, 0.0049868058413267136, -0.006682257633656263, -0.0329010970890522, -0.018142888322472572, 0.032652221620082855, 0.018528643995523453, 0.012742331251502037, 0.06401029974222183, 0.013103197328746319, 0.007459987886250019, -0.044000860303640366, 0.019561469554901123, -0.016089681535959244, -0.009351427666842937, 0.02339412271976471, -0.037331048399209976, -0.03409568965435028, -0.03484231233596802, -0.005366337951272726, -0.032054927200078964, 0.0031264752615243196, 0.011392191052436829, 0.013663163408637047, 0.028097834438085556, 0.025385113433003426, -0.0021963100880384445, 0.02817249670624733, 0.001161928870715201, -0.006557820830494165, -0.004420618060976267, 0.010434027761220932, -0.016798971220850945, 0.022933706641197205, -0.030063936486840248, -0.010004720650613308, 0.014048917219042778, 0.010514912195503712, 0.05400558188557625, 0.003966423682868481, 0.014807982370257378, 0.011603734456002712, -0.01819266378879547, 0.005014804191887379, 0.00963763240724802, -0.006109848152846098, 0.0016347888158634305, -0.02231152355670929, -0.028844457119703293, 0.016425661742687225, 0.018055783584713936, 0.002154312562197447, -0.040914829820394516, 0.0232323557138443, -0.012182365171611309, -0.012281915172934532, -0.035041410475969315, 0.033473506569862366, 0.06386098265647888, 0.036932848393917084, -0.04922720789909363, -0.03041236102581024, -0.03969534859061241, -0.014783094637095928, -0.03312508389353752, -0.005192126613110304, 0.019835229963064194, 0.011460632085800171, 0.008001287467777729, 0.04412529990077019, 0.04992405325174332, -0.03937181085348129, 0.021241366863250732, -0.02051963284611702, 0.026206394657492638, -0.06107359379529953, 0.024190519005060196, 0.00969362910836935, 0.06953530013561249, 0.06321390718221664, 0.017570480704307556, -0.026629481464624405, -0.0009130552061833441, 0.004510834813117981, -0.005347672384232283, 0.016487879678606987, 0.05753958970308304, -0.007939069531857967, 0.03952113538980484, -0.021029824391007423, 0.00828127097338438, 0.04676336050033569, 0.035588931292295456, -0.06749453395605087, -0.02633083239197731, -0.011628621257841587, 0.04178588464856148, 0.03728127479553223, -0.00611918093636632, -0.07351727783679962, -0.003621111623942852, -0.007932847365736961, -0.0419103242456913, 0.019511694088578224, 0.002913377247750759, 0.035091184079647064, -0.013936924748122692, -0.02491225302219391, 3.567837120499462e-05, -0.007304441649466753, 0.0023051921743899584, 0.019996998831629753, 0.056593868881464005, -0.020183652639389038, 0.00433040177449584, -0.021141815930604935, 0.08377087116241455, -0.019461920484900475, 0.05049646273255348, -0.028097834438085556, 0.0008500590920448303, 0.0063711656257510185, -0.010452693328261375, -0.02150268293917179, 0.02013387903571129, 0.04001888260245323, 0.03581291809678078, -0.013016091659665108, -0.013750269077718258, 0.007727527059614658, 0.02931731566786766, 0.006178288254886866, 0.0015453498344868422, -0.019499249756336212, -0.015069299377501011, 0.012033040635287762, 0.0630645826458931, -0.05753958970308304, 0.041611675173044205, -0.00928298756480217, 0.006187621038407087, 0.017881572246551514, 0.009475864470005035, 0.014857756905257702, 0.005468998569995165, 0.053507834672927856, 0.030362585559487343, -0.030387472361326218, 0.012561897747218609, 0.023381680250167847, -0.013177859596908092, -0.043030254542827606, -0.015355504117906094, -0.01229435857385397, 0.050521351397037506, -0.044423945248126984, 0.022124867886304855, -0.009444755502045155, -0.02876979485154152, -0.03991933539509773, 0.02867024391889572, 0.005350783467292786, 0.008760352618992329, 0.05470242723822594, 0.03616134077310562, 0.060127872973680496, 0.03028792329132557, -0.009152328595519066, -0.005804977845400572, 0.05022270232439041, -0.02068139985203743, -0.015044412575662136, -0.025322893634438515, 0.02524823136627674, 0.0028324932791292667, 0.015231067314743996, -0.05574769899249077, -0.026828579604625702, -0.004660159349441528, 0.018814848735928535, 0.011977044865489006, -0.023792320862412453, -0.0283467099070549, -0.016587428748607635, 0.02839648351073265, -0.0006657370249740779, -0.00914610642939806, -0.09168505668640137, -0.04452349618077278, -0.042856041342020035, 0.030860332772135735, -0.015890583395957947, 0.022187085822224617, 0.034444112330675125, -0.026480156928300858, 0.018765073269605637, -0.04203476011753082, -0.028919117525219917, -0.005593435373157263, -0.007279554381966591, 0.010185154154896736, -0.00887856725603342, 0.0009884950704872608, 0.008237717673182487, 0.006564042530953884, -0.0027749412693083286, 0.005021025892347097, -0.0020936497021466494, 0.008175499737262726, 0.01803089678287506, 0.023904314264655113, -0.038202106952667236, -0.028919117525219917, -0.03155717998743057, -0.02019609697163105, -0.01262411568313837, -0.008747909218072891, -0.009643853642046452, 0.01281699351966381, 0.027400989085435867, 0.007061789743602276, -0.031731389462947845, -0.024028751999139786, 0.006526711396872997, -0.012866768054664135, -0.0053912256844341755, 0.03327440842986107, 0.0060911825858056545, 0.00457305321469903, 0.023307017982006073, -0.057240940630435944, 0.002980262041091919, 0.021241366863250732, -0.06226818636059761, -0.028147609904408455, -0.034444112330675125, 0.013227635063230991, -0.04088994115591049, 0.0035153403878211975, -0.006775585003197193, -0.03155717998743057, -0.01775713451206684, 0.018677968531847, -0.03339884430170059, -0.02730144001543522, 0.017719803377985954, 0.0019318817649036646, -0.007055568043142557, -0.012978760525584221, -0.00014067193842492998, 0.03220425173640251, -0.01067045796662569, -0.0037082175258547068, 0.0034997856710106134, -0.06366188079118729, -0.02056940644979477, -0.009239434264600277, -0.015766145661473274, -0.042482733726501465, 0.006943575106561184, 0.005042802542448044, 0.01672430895268917, 0.023929201066493988, -0.025658873841166496, -0.032378461211919785, 0.055897023528814316, -0.04283115640282631, 0.016251450404524803, 0.03357305750250816, 0.007951512932777405, 0.031407855451107025, 0.030387472361326218, 0.02448916807770729, -0.012829436920583248, 0.009401202201843262, -0.026206394657492638, 0.028919117525219917, -0.017222056165337563, 0.05808711051940918, -0.025123795494437218, -0.024825146421790123, -0.014758207835257053, 0.03723149746656418, -0.0254100002348423, 0.000909166585188359, 0.0005140796420164406, -0.011497962288558483, -0.04011843353509903, 0.03295087069272995, 0.011273976415395737, -0.03524050861597061, -0.005301008932292461, -0.007403991185128689, 0.022323966026306152, -0.006355610676109791, -0.013675606809556484, 0.009102554060518742, -0.017284275963902473, 0.026903241872787476, -0.01633855514228344, 0.0006980128237046301, 0.01698562689125538, -0.031507402658462524, -0.018416650593280792, 0.039122939109802246, 0.00025431776884943247, -0.02008410356938839, 0.044921692460775375, -0.008648359216749668, -0.007858186028897762, -0.013526283204555511, -0.012393907643854618, 0.04385153576731682, -0.02149024046957493, 0.04489680752158165, 0.006956018507480621, 0.012792105786502361, 0.012456126511096954, 0.03175627812743187, -0.010004720650613308, -0.021913325414061546, -0.006140957586467266, -0.017657585442066193, 0.000909166585188359, -0.00988028384745121, 0.03359794244170189, 0.012711221352219582, 0.049152545630931854, -0.006221841089427471, -0.012854323722422123, -0.04452349618077278, 0.039446473121643066, 0.03222913667559624, -0.0011191536905243993, -0.008368376642465591, -0.0046197171323001385, 0.005021025892347097, -0.03937181085348129, 0.008231496438384056, 0.03832654282450676, -0.007453765720129013, -0.015330617316067219, -0.06445827335119247, -0.02730144001543522, 0.002765608485788107, 0.0023627441842108965, 0.022386185824871063, -0.005185904912650585, -0.002669170033186674, -0.009376314468681812, -0.023045700043439865, -0.0012218140764161944, 0.021963099017739296, -0.04673847183585167, -0.009320318698883057, -0.004996138624846935, 0.0015445720637217164, 0.03670886531472206, 0.0009029447101056576, -0.0404917448759079, 0.0016425660578534007, 0.040790390223264694, -0.011423300951719284, -0.016761640086770058, -0.008212830871343613, -0.020258314907550812, -0.005304119549691677, 0.031681615859270096, 0.011193092912435532, -0.014957306906580925, -0.01259300671517849, 0.006224952172487974, -0.027002790942788124, 0.029815062880516052, -0.013240078464150429, 0.03474276140332222, 0.03362283110618591, 0.008287492208182812, 0.007366660051047802, -0.004887256305664778, -0.035091184079647064, -0.020258314907550812, -0.03636043891310692, -0.013862262479960918, 0.006483158562332392, -0.003145140828564763, -0.044548384845256805, 0.009818065911531448, -0.003506007604300976, 0.011877494864165783, 0.003916649147868156, 0.011908603832125664, 0.003254022914916277, -0.027425875887274742, -0.006476936861872673, 0.044871918857097626, 0.012493457645177841, 0.0032726884819567204, -0.023817207664251328, 0.0030984769109636545, 0.038027893751859665, -0.012064150534570217, -0.04741043224930763, 0.03708217293024063, 0.043627552688121796, 0.025173569098114967, 0.03636043891310692, 0.02529800683259964, 0.023593222722411156, -0.011622400023043156, -0.027500538155436516, 0.009762069210410118, -0.01509418711066246, 0.0016985626425594091, -0.005332117900252342, -0.004261961206793785, -0.011827720329165459, -0.01895172894001007, -0.007180004846304655, 0.004943253006786108, 0.0036864408757537603, 0.01438489742577076, -0.015405278652906418, -0.0008881678222678602, -0.02550954930484295, -0.001872774213552475, -0.022435959428548813, -0.0023083030246198177, 0.01193971373140812, 0.008797683753073215, -0.012555675581097603, 0.0003793379000853747, -0.017570480704307556, 0.01851619966328144, 0.03929714858531952, 0.010421584360301495, 0.00018626637756824493, 0.020507188513875008, -0.008891011588275433, -0.0057303160429000854, -0.013078310526907444, 0.01123664528131485, 0.00660759536549449, -0.06809183210134506, -0.017719803377985954, -0.04599184915423393, -0.020046772435307503, -0.01883973553776741, -0.007360438350588083, -0.024352286010980606, -0.024451836943626404, 0.004563720431178808, -0.010042051784694195, -0.009351427666842937, 0.00754709355533123, 0.019561469554901123, -0.01774469204246998, -0.10920576006174088, -0.03840120509266853, 0.011665952391922474, 0.016537653282284737, 0.03984467312693596, -0.038998499512672424, -0.016089681535959244, -0.017632698640227318, -0.012792105786502361, -0.03143274411559105, -0.002905600005760789, -0.025210900232195854, 0.00681291613727808, 0.020444970577955246, 0.03658442571759224, -0.06231796368956566, 4.732001980300993e-05, -0.02757520042359829, 0.018043339252471924, -0.009855397045612335, -0.00887856725603342, 0.010620683431625366, 0.004106415435671806, 0.06182021647691727, -0.0432293526828289, 0.0006070184172131121, 0.02279682643711567, 0.010496246628463268, -0.026455270126461983, 0.02237374149262905, -0.038027893751859665, -0.020718730986118317, -0.009394980035722256, 0.034717872738838196, -0.041611675173044205, 0.0026442825328558683, 0.0002807605778798461, -0.006237396039068699, 0.00019044667715206742, 0.00011461798567324877, 0.017993565648794174, -0.03230379894375801, 0.07232268154621124, 0.01900150254368782, 0.025322893634438515, -0.02643038146197796, 0.012362798675894737, -0.04203476011753082, 0.006576486397534609, -0.0434284508228302, 0.019511694088578224, 0.002624061657115817, -0.0007260111160576344, -0.02263505943119526, -0.005618322640657425, 0.014944862574338913, -0.0003527006192598492, 0.0022538620978593826, 0.02605707198381424, 0.027226777747273445, 0.0013330294750630856, 0.03046213462948799, 0.05335851013660431, -0.001790334819816053, -0.05559837445616722, -0.022124867886304855, -0.016251450404524803, -0.0014209130313247442, -0.003306908765807748, -0.022062649950385094, -0.014608883298933506, 0.0016176787903532386, 0.0044921692460775375, 0.014671102166175842, 0.00382021046243608, -0.02720189094543457, 0.0001946269767358899, 0.037057287991046906, -0.04594207555055618, 0.012151256203651428, 0.05310963839292526, -0.04415018483996391, 0.016089681535959244, 0.006551598664373159, -0.01457155216485262, 0.013538726605474949, -0.022547952830791473, 0.006389831192791462, -0.023866983130574226, 0.049052998423576355, 0.05131774768233299, 0.005235679447650909, 0.02042008377611637, -0.060774944722652435, 0.008990560658276081, -0.019412145018577576, -0.02715211547911167, 0.0013050312409177423, 0.015069299377501011, 0.011609955690801144, 0.032005149871110916, 0.04604162648320198, -0.03571337088942528, -0.009562970139086246, 0.017458487302064896, 0.03658442571759224, 0.003235357580706477, 0.043503113090991974, 0.0013361404417082667, 0.0035620040725916624, 0.0013011426199227571, -0.017508260905742645, -0.059630125761032104, 0.002625616965815425, -0.01688607782125473, 0.005972967483103275, 0.09297920018434525, 0.033249519765377045, 0.02974040061235428, -0.0016565652331337333, 0.009923837147653103, 0.02628105692565441, -0.017035402357578278, 0.012076593935489655, -0.026629481464624405, -0.033747266978025436, 0.0039353147149086, -0.008915898390114307, 0.006231173872947693, -0.008984338492155075, 0.026131734251976013, -0.027998285368084908, 0.0405912920832634, -0.0018027785699814558, -0.019076164811849594, 0.05271143838763237, 0.03285132348537445, 0.02208753675222397, -0.04360266402363777, 0.027425875887274742, 0.01683630235493183, 0.002401630859822035, 0.030437247827649117, 0.047485094517469406, 0.05022270232439041, -0.009494530037045479, -0.008542587980628014, -0.02730144001543522, -0.02550954930484295, -0.01262411568313837, 0.03974512219429016, 0.012829436920583248, -0.006993349641561508, 0.012792105786502361, -0.00928298756480217, 0.0033255741000175476, -0.0012467014603316784, -0.02872001938521862, -0.019748125225305557, -0.005154795479029417, -0.01541772298514843, 0.05520017445087433, -0.006844025570899248, -0.004414396360516548, -0.0014652436366304755, 0.003162250854074955, -0.008387042209506035, 0.017943790182471275, -0.019996998831629753, 0.016624759882688522, -0.02226174809038639, -0.03382192924618721, 0.03822699189186096, 0.02340656705200672, -0.0062187304720282555, 0.02344389818608761, 0.00325713399797678, 0.0034748984035104513, -0.0029289317317306995, 0.03041236102581024, 0.011765501461923122, 0.013401846401393414, -0.03424501419067383, -0.015330617316067219, 0.05390603467822075, -0.004517056979238987, -0.007771079894155264, -0.017110062763094902, 0.0023176358081400394, 0.03362283110618591, -0.0082501620054245, 0.02053207717835903, -0.012319245375692844, 0.02969062700867653, 0.004261961206793785, -0.0032757993321865797, -0.016475435346364975, 0.02447672374546528, -0.013165416195988655, -0.045145679265260696, -0.04855525121092796, 0.017819354310631752, -0.011099765077233315, -0.006200064904987812, -0.027102340012788773, 0.006688479334115982, -0.04554387927055359, -0.0033473505172878504, 0.030487023293972015, 0.0019069943809881806, 0.016276337206363678, -0.015940356999635696, -0.022759495303034782, 0.028595583513379097, -0.0027267220430076122, -0.04531989246606827, 0.024576272815465927, -0.020507188513875008, -0.04305514320731163, -0.0019474363652989268, -0.051765721291303635, -0.03257755935192108, -0.02192576788365841, -0.0037704359274357557, -0.0068626911379396915, 0.0006369610200636089, 0.03193049132823944, 0.0001193815769511275, -0.00841192901134491, -0.0036771083250641823, -0.0016425660578534007, 0.022933706641197205, -0.01997211016714573, 0.013501395471394062, -0.02491225302219391, -0.0033753488678485155, 0.0015406834427267313, -0.01759536750614643, -0.007012015208601952, 0.009643853642046452, 0.007236001547425985, 0.007596868090331554, 0.00016546208644285798, -0.018976615741848946, 0.007914181798696518, -0.006464492995291948, 0.0327019989490509, 0.05126797407865524, -0.0432293526828289, -0.0231825802475214, -0.023580778390169144, 0.024551386013627052, 0.03914782404899597, -0.010247373022139072, 0.0024451836943626404, -0.00019064110529143363, -0.0076901959255337715, 0.053607385605573654, 0.046987347304821014, 0.007248444948345423, -0.0038264323957264423, 0.008243939839303493, -0.023966532200574875, -0.003534005954861641, -0.002574286889284849, -0.02035786397755146, 0.021564902737736702, 0.018578417599201202, -0.019349927082657814, -0.0020329866092652082, -0.029391977936029434, -0.003969534765928984, -0.003997533116489649, 0.036783527582883835, 0.018864622339606285, -0.005829865112900734, 0.005705428309738636, -0.0126801123842597, 0.010546021163463593, 0.022610170766711235, -0.02762497588992119, -0.03240334987640381, -0.019088609144091606, -0.029715513810515404, 0.04843081161379814, 0.004457949195057154, 0.025808198377490044, -0.0021107597276568413, 0.005867196246981621, 0.008691912516951561, 0.04746020585298538, 0.046166062355041504, -0.01541772298514843, 0.0003744770656339824, -0.0105024678632617, -0.028968892991542816, 0.024090969935059547, 0.018852179870009422, 0.015119073912501335, -0.019026391208171844, 0.007970178499817848, 0.018690411001443863, -0.015056855976581573, 0.03198026493191719, 0.014559108763933182, -2.040326398855541e-05, 0.017284275963902473, 0.0021589789539575577, -0.014160910621285439, -0.032054927200078964, -0.03402102738618851, -0.017072731629014015, -0.003761103143915534, 0.030163487419486046, 0.02074361965060234, -0.015579490922391415, -0.018466424196958542, -0.007111564744263887, 0.016873633489012718, -0.013488952070474625, -0.013936924748122692, -0.014372453093528748, 0.009544304572045803, 0.020208541303873062, -0.02003432810306549, 0.006271616090089083, -0.00402864208444953, -0.011398413218557835, 0.006949796807020903, 0.026081958785653114, 0.00011121541319880635, 0.022547952830791473, -0.006825360003858805, -0.015181292779743671, -0.005021025892347097, -0.005898305680602789, -0.008268826641142368, -0.013812487944960594, -0.032054927200078964, -0.016736753284931183, 0.02550954930484295, -0.00563076650723815, 0.0074724312871694565, -0.011392191052436829, 0.00570231769233942, -0.003050257684662938, -0.0014940196415409446, 0.014608883298933506, 0.009538082405924797, -0.02715211547911167, 0.05216391757130623, 0.004716155584901571, -0.014745763503015041, -0.004199742805212736, -0.0038170996122062206, 0.01638833060860634, -0.026853466406464577, -0.020868055522441864, -0.050347138196229935, 0.010185154154896736, -0.01682385802268982, 0.043403565883636475, -0.026081958785653114, -0.012076593935489655, 0.02633083239197731, -0.002398519776761532, -0.008710578083992004, 0.03073589690029621, 0.020395195111632347, 0.016512766480445862, 0.0069249095395207405, 0.023754989728331566, -0.028147609904408455, 0.011622400023043156, -0.008884789422154427, 0.006570264231413603, -0.016363441944122314, 0.02079339325428009, 0.005500107537955046, -0.0036304444074630737, -0.0042184083722531796, 0.003683330025523901, -0.04148723930120468, -0.0007349550141952932, 0.009967389516532421, -0.00066145951859653, -0.03382192924618721, 0.000735732726752758, -0.01017893198877573, 0.025123795494437218, -0.0007096788031049073, -0.003140474436804652, -0.001405358430929482, -0.007086677476763725, -0.005490774754434824, 0.014969750307500362, -0.008013731800019741, -0.010521133430302143, 0.011087320744991302, 0.019623687490820885, -0.0004611939948517829, -0.020482301712036133, 0.00023079142556525767, -0.013712937943637371, 0.009724738076329231, -0.012792105786502361, -0.02377987839281559, 0.02177644520998001, 0.020046772435307503, 0.006081849802285433, -0.03942158818244934, 0.019897447898983955, -0.022236861288547516, 0.019499249756336212, 0.016960740089416504, -0.01029092539101839, -0.008772796019911766, 0.02019609697163105, 0.022672390565276146, 0.04410041123628616, -0.0156914833933115, 0.02324480004608631, -0.009065222926437855, 0.010328256525099277, -0.0082501620054245, -0.005957412999123335, -0.004352177958935499, 0.0312834195792675, 0.0016985626425594091, 0.015330617316067219, -0.0051143537275493145, 0.022498177364468575, 0.003310019616037607, -0.0005778535269200802, 0.017607809975743294, 0.041561901569366455, 0.010309590958058834, 0.0017016736092045903, -0.035638708621263504, 0.02974040061235428, -0.01730916276574135, 0.012804549187421799, 0.03772924467921257, 0.008816349320113659, -0.0021232033614069223, -0.024986915290355682, 0.0041313027031719685, -0.03175627812743187, 0.032104700803756714, 0.021042266860604286, -0.018715297803282738, -0.03414546325802803, 0.04686290770769119, 0.0005782423540949821, -0.026505043730139732, 0.026206394657492638, -0.04770907759666443, -0.02876979485154152, 0.03307530656456947, 0.044871918857097626, 0.00819416530430317, -0.014484446495771408, 0.0186281930655241, 0.01824243925511837, 0.018926842138171196, 0.003310019616037607, -0.04121347516775131, 0.028421370312571526, 0.0035651151556521654, -0.05221369117498398, 0.00996116828173399, -0.037480372935533524, 0.01954902522265911, -0.005245012231171131, 0.029939500615000725, -0.014484446495771408, -0.020830724388360977, -0.014745763503015041, 0.0032384684309363365, 0.002476292895153165, -0.04365243762731552, 0.0021698670461773872, 0.013488952070474625, -0.007291997782886028, 0.025584211573004723, -0.016301224008202553, -0.0048312596045434475, -0.01156018115580082, -0.0032913540489971638, -0.0036148896906524897, 0.026579705998301506, 0.005764536093920469, 0.00011247922520851716, 0.02969062700867653, -0.018055783584713936, -0.01803089678287506, -0.004361510742455721, -0.01732160709798336, 0.011553958989679813, 0.01656254194676876, -0.02328212931752205, -0.005273010581731796, -0.014857756905257702, 0.04126325249671936, 0.019611243158578873, -0.00909010972827673, -0.008530144579708576, -0.0300141628831625, 0.02219953015446663, -0.005991633050143719, 0.026853466406464577, -0.03339884430170059, 0.028968892991542816, -0.005182793829590082, 0.015081743709743023, 0.0016347888158634305, -0.006060073617845774, -0.005957412999123335, 0.011790389195084572, -0.00991139281541109, -0.0005035802605561912, 0.016711866483092308, 0.011112208478152752, -0.015542159788310528, -0.003297575982287526, -0.022759495303034782, 0.0036117788404226303, 0.0004440839111339301, -0.03850075230002403, -0.009208325296640396, -0.023593222722411156, -0.03305042162537575, 0.04108903929591179, -0.0015546826180070639, -0.017670029774308205, 0.003953980281949043, 0.014223129488527775, 0.019573912024497986, -0.0005766869289800525, 0.02735121361911297, 0.007939069531857967, -0.0040068659000098705, -0.021527571603655815, 0.000814283499494195, 0.013887150213122368, -0.006383609026670456, 0.00030564796179533005, 0.028247158974409103, -0.015330617316067219, 0.03018837422132492, 0.002376743359491229, -0.005652542691677809, 0.025584211573004723, 0.020059216767549515, -0.005608989857137203, -0.007117786444723606, -0.0007489541312679648, 0.0008671691175550222, 0.013078310526907444, 0.009208325296640396, 0.0008772796136327088, -0.004909032955765724, 0.009251877665519714, 0.03334907069802284, 0.01775713451206684, 0.02872001938521862, 0.0020812058355659246, -0.002244529314339161, -0.02139068953692913, -0.021241366863250732, -0.019748125225305557, 0.020855611190199852, 0.004258850589394569, 0.02638060785830021, -0.03295087069272995, 0.022000430151820183, 0.007914181798696518, -0.01479553896933794, -0.009457198902964592, 0.02655481919646263, 0.04081527888774872, -0.0401930958032608, 0.0005646321224048734, 0.00863591581583023, 0.007571980822831392, -0.0032229137141257524, 0.015380391851067543, -0.003033147659152746, -0.02904355525970459, 0.026803692802786827, -0.029192879796028137, 0.018752628937363625, 0.005565437022596598, 0.010085605084896088, -0.02926754206418991, 0.08337267488241196, -0.0009099442977458239, 0.025322893634438515, -0.03317485749721527, -0.007124008145183325, 0.01987256109714508, 0.022286634892225266, 0.008741687051951885, -0.02486247755587101, 0.03252778574824333, -0.043677326291799545, 0.012014375999569893, -0.03125853091478348, 0.03023814782500267, 0.04952585697174072, -0.03947136178612709, -0.019088609144091606, 0.03155717998743057, 0.025434887036681175, 0.009320318698883057, 0.033473506569862366, -0.0046228282153606415, -0.013464064337313175, -0.025422442704439163, -0.02476292848587036, 0.001057713059708476, 0.013849819079041481, -0.009289208799600601, -0.014397340826690197, -0.006352500058710575, 0.026032183319330215, 0.014932419173419476, 0.008909677155315876, 0.0070742336101830006, -0.01595280133187771, 0.03979489579796791, -0.012655225582420826, -0.008069728501141071, 0.014845313504338264, -0.012829436920583248, -0.018541086465120316, -0.024252736940979958, -0.000743898912332952, 0.007907960563898087, 0.03626089170575142, -0.03372237831354141, -0.013688051141798496, 0.01302853599190712, -0.029068442061543465, -0.029018668457865715, -0.010384253226220608, -0.002008099341765046, -0.02377987839281559, 0.005636988207697868, 0.0210049357265234, -0.00681291613727808, -0.010770007036626339, 0.006539155263453722, 0.014322678558528423, 0.029939500615000725, 0.03534005954861641, -0.027998285368084908, 0.031084319576621056, -0.015044412575662136, -0.008723021484911442, 0.020880499854683876, 0.005484553053975105, 0.004177966620773077, -0.0024871809873729944, -0.035638708621263504, 0.01530572958290577, 0.011081099510192871, 0.0031980264466255903, -0.00367088639177382, 0.021378247067332268, -0.018926842138171196, 0.00530723063275218, -0.0026271725073456764, 0.03633555397391319, 0.011497962288558483, -0.015156405046582222, -0.017085175961256027, 0.017769578844308853, -0.020059216767549515, 0.007453765720129013, 0.006274727173149586, 0.004825037904083729, 0.0017250054515898228, 0.006116069853305817, -0.0018681078217923641, -0.007248444948345423, 0.01302853599190712, 0.015143961645662785, 0.0447474829852581, -0.021863549947738647, 0.006551598664373159, 0.00645827129483223, -0.02936709113419056, -0.01541772298514843, -0.024725597351789474, 0.00015924025501590222, 0.010838447138667107, 0.020432526245713234, -0.008586141280829906, 0.002190088154748082, 0.02959107793867588, 0.0058174217119812965, -0.011224201880395412, -0.017682472243905067, 0.015840807929635048, 0.014285347424447536, 0.011852608062326908, -0.027052566409111023, -0.04044196754693985, 0.004551277030259371, -0.0300141628831625, 0.0022429737728089094, 0.012866768054664135, 0.006588929798454046, 0.032378461211919785, -0.02623128332197666, -0.00027181667974218726, -0.0064956024289131165, 0.004905921872705221, -0.02300836890935898, 0.019013946875929832, 0.01954902522265911, 0.0016363442409783602, -0.0024778482038527727, -0.03708217293024063, -0.04576786607503891, -0.014845313504338264, -0.0232323557138443, 0.015268398448824883, -0.0040037548169493675, 0.017172282561659813, -0.02844625897705555, 0.012804549187421799, -0.016587428748607635, 0.005848530679941177, 0.0034624547697603703, -0.014957306906580925, 0.02274705097079277, -0.013936924748122692]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"LCTL(θ):= min
θTX
t=1DKL 
σ(s1:t)πθ
t(s1:t)
.(21)
While other divergences could be used to learn πθ
t(s1:t),
we argue that the mass-covering behavior of Eq. (21) is a
desirable property for twist learning. Since we separately
match each σ(s1:t), our hope is that suboptimal learning in
early timesteps does not lead to aggressive pruning of partial
sequences that would achieve high final target likelihood.
Using Eq. (9), the gradient of Eq. (21) at each tbecomes
Eσ(s1:t)
∇θlogψθ
t(s1:t)
−Eπθ
t(s1:t)
∇θlogψθ
t(s1:t),(22)
which allows us to learn from exact target samples of σ(s1:t)
in the first term when they are available.
We note the similarity of the objective in Eq. (21) and gradi-
ent in Eq. (22) to maximum likelihood training of energy-
based models ( EBM )s. Due to the form of the gradient
update, we refer to this method as contrastive twist learning
(CTL ). We proceed to describe approximate techniques for
positive sampling (first term) and negative sampling (second
term) in the next subsections.
4.1.1. A PPROXIMATE NEGATIVE SAMPLING
A common challenge in energy-based modeling is that the
second term in Eq. (22) involves sampling from the target
πtwith intractable normalization constant Zψ
t. We proceed
to estimate the expectation using SISas in Eq. (4), using a
proposal q(s1:t)such as the base model or the twist-induced
proposal from Sec. 3.2. Note that SMC resampling with
learned intermediate twist functions could also be used.
4.1.2. (A PPROXIMATE ) POSITIVE SAMPLING
In contrast to traditional EBM settings, we do not necessar-
ily have exact samples available from a ‘data’ distribution.
We describe several settings related to availability of positive
samples, which are explored in our experiments in Sec. 7.
Exact Target Samples If exact posterior samples are
available, for example using the BDMC trick in Sec. 3.3,
we may use them directly in the gradient update in Eq. (22).
Rejection Sampling Rejection sampling can yield ex-
act target samples sσ
1:Twhen an upper bound on the like-
lihood ratio˜σ(s1:T)
q(s1:T)≤Mis known. In cases where
the target ˜σ(s1:T)is defined by thresholding or an indi-
cator function p0(s1:T)I(s1:t∈ C)or joint distribution
p0(s1:T)σ(oT|s1:T), we can clearly take M= 1 for the
base model proposal p0(s1:T). If the base model yields
posterior samples in reasonable time, we can obtain exact
6
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Name Loss Learning Principle
CTLPT
t=1Eπs(oT)h
DKL 
σ(s1:t|oT)πθ
t(s1:t|oT)i
(Gradient:) Eπs(oT)h
Eσ(s1:t|oT)
∇θlogψθ
t(s1:t, oT)
−Eπθ
t(s1:t|oT)
∇θlogψθ
t(s1:t, oT)i
Marginal Matching with MLE
RLPT−1
t=1Eπs(s1:t,oT)h
logP
st+1p0(st+1|s1:t)sg 
ψθ
t+1(s1:t+1, oT)
−logψθ
t(s1:t, oT)2i
+Eπs(s1:T,oT)h 
logϕ(s1:T, oT)−logψθ
T(s1:T, oT)2i
Twist Consistency / Soft Q-Learning
SIXOPT
t=1Eπs(oT)σ(s1:t|oT)
logsigmoid 
logψθ
t(s1:t, oT)
+Ep0(s1","[0.00480811158195138, -0.006881939712911844, 0.02026275545358658, -0.00040267108124680817, -0.028848668560385704, 0.01571882702410221, 0.0024238694459199905, 0.024053767323493958, -0.05093428120017052, 0.033762454986572266, 0.03806861862540245, -0.034581419080495834, -0.003424458671361208, 0.00042145277257077396, 0.02747492305934429, -0.008599122986197472, 0.044673167169094086, 0.0009419737616553903, -0.017898326739668846, 0.05516119301319122, -0.0062379962764680386, -0.04929635301232338, -0.008500054478645325, 0.05127771571278572, 0.0044085364788770676, -0.024344366043806076, 0.047896187752485275, 0.010237050242722034, 0.0208967924118042, -0.02616722323000431, 0.039997149258852005, -0.022125238552689552, -0.04139731079339981, -0.044778842478990555, -0.0048147160559892654, 0.0680004358291626, -0.0032907165586948395, 0.055795229971408844, -0.0325736366212368, -0.009576595388352871, 0.012548643164336681, -0.03357752785086632, -0.023921675980091095, 0.043088074773550034, -0.012621292844414711, 0.01735675521194935, 0.011306987144052982, 0.0258502047508955, 0.014807398431003094, 0.037091147154569626, -0.03307558223605156, 0.05542537197470665, -0.03267930820584297, 0.009781336411833763, -0.02850523218512535, -0.020830746740102768, -0.02715790458023548, -0.0051647573709487915, 0.031569741666316986, -0.02404055744409561, 0.02028917334973812, -0.0244368314743042, 0.04203134775161743, -0.017488844692707062, 0.008711399510502815, -0.01102959644049406, -0.059440940618515015, 0.02386884018778801, -0.029614796862006187, 0.037804435938596725, 0.0008235046989284456, 0.011221128515899181, 0.01632644422352314, 0.016484953463077545, -0.004431652370840311, 0.03846489265561104, 0.005012852605432272, 0.0492170974612236, 0.007251794449985027, -0.0272635780274868, 0.030328087508678436, -0.04137089475989342, 0.056323591619729996, -0.03246796131134033, -0.008031131699681282, -0.050168152898550034, -0.07069508731365204, -0.028056124225258827, -0.04480525851249695, -0.014503588899970055, -0.01847952790558338, 0.010606905445456505, -0.01969476416707039, -0.005286941304802895, 0.042163439095020294, -0.0032180664129555225, 0.027316413819789886, -0.019166400656104088, 0.016775554046034813, 0.004666113760322332, -0.0021993147674947977, -0.02380279451608658, 0.05431580916047096, -0.02765985019505024, 0.07312556356191635, -0.01414694357663393, -0.01554710790514946, 0.0047222524881362915, -0.05431580916047096, 0.017436008900403976, -0.03600800037384033, -0.030195998027920723, -0.009385064244270325, 0.014833816327154636, 0.03698547184467316, -0.055795229971408844, -0.026087967678904533, 0.007060262840241194, -0.015507481060922146, -0.01649816334247589, -0.0609203577041626, -0.030724361538887024, 0.0035829676780849695, -0.005696423351764679, 0.022178074344992638, -0.02096283808350563, -0.002668237779289484, -0.032917071133852005, -0.004378815647214651, 0.01845311000943184, 0.00988040491938591, 0.021504411473870277, -0.011874978430569172, -0.0045274184085428715, -0.01471493486315012, 0.0009229857241734862, 0.009305809624493122, 0.03928385674953461, 0.011095642112195492, 0.014701725915074348, 0.009068045765161514, -0.02188747562468052, -0.023168757557868958, 0.031041380017995834, 0.011234337463974953, -0.019113564863801003, -0.02900717779994011, 0.021834637969732285, -0.013790298253297806, 0.016696298494935036, -0.029456287622451782, -0.042903147637844086, -0.06778909265995026, 0.03304916247725487, -0.025586022064089775, -0.07687694579362869, -0.033445436507463455, 0.062135595828294754, -0.009840778075158596, -0.021768592298030853, 0.022534720599651337, 0.03241512551903725, 0.03650994598865509, -0.0047949026338756084, 0.016484953463077545, 0.013361002318561077, -0.03014316037297249, 0.04298240318894386, -0.07148763537406921, -0.050907861441373825, 0.031120633706450462, -0.0729670524597168, -0.02007782831788063, -0.04699796810746193, 0.017792655155062675, -0.03048659674823284, -0.009319018572568893, -0.0765070915222168, -0.004524115938693285, -0.01571882702410221, -0.020830746740102768, 0.04203134775161743, -0.01976080983877182, 0.006343669258058071, -0.0005692295380868018, 0.00021898206614423543, -0.00855289027094841, 0.03798936307430267, 0.010171005502343178, 0.005455357488244772, -0.005696423351764679, 0.04866231605410576, 0.07677127420902252, -0.009959659539163113, -0.05127771571278572, -0.008315127342939377, 0.08406269550323486, 0.06715505570173264, 0.04625825956463814, 0.026008713990449905, 0.016841599717736244, 0.022508302703499794, -0.01287226565182209, -0.07043091207742691, 0.0047420659102499485, 0.029878979548811913, 0.012099533341825008, 0.013499697670340538, -0.0630338117480278, -0.012964729219675064, 0.01961551047861576, -0.027527758851647377, 0.024106603115797043, 0.007872622460126877, -0.039310272783041, 0.04691871628165245, -0.026537077501416206, -0.020923210307955742, -0.01336760725826025, 0.05822570249438286, -0.0075027672573924065, 0.015018744394183159, 0.030328087508678436, 0.0396537110209465, -0.05074935406446457, 0.017937954515218735, 0.018756918609142303, -0.011769305914640427, 0.031781088560819626, -0.024344366043806076, 0.039468783885240555, 0.004078309051692486, -0.01013137772679329, -0.02974688820540905, 0.026444613933563232, -0.021913893520832062, -0.04646960645914078, -0.020315591245889664, -0.008737818337976933, -0.06863447278738022, -0.0009494039113633335, 0.025770949199795723, 0.01063992828130722, -0.023036666214466095, -0.026682376861572266, 0.028954342007637024, -0.0258502047508955, 0.002392497844994068, 0.03241512551903725, 0.004395327065140009, 0.005679911933839321, 0.01145889237523079, -0.015203671529889107, -0.011095642112195492, -0.024951985105872154, 0.0240801852196455, 0.000100770965218544, 0.008381172083318233, -0.05082860589027405, 0.023525403812527657, 0.02503124065697193, -0.012568456120789051, -0.023076293990015984, 0.023327266797423363, -0.03154332563281059, 0.002229035133495927, -0.02871657907962799, -0.012766593135893345, 0.04440898448228836, -0.009530363604426384, 0.0039098928682506084, -0.010877692140638828, -0.02146478369832039, 0.034264400601387024, -0.008572704158723354, -0.059123922139406204, 0.021398738026618958, 0.02765985019505024, -0.004048588220030069, 0.06789476424455643, -0.03669487312436104, -0.04047267511487007, 0.02765985019505024, -0.031464070081710815, 0.003297321032732725, 0.02281211130321026, -0.010171005502343178, 0.010653137229382992, -0.030513014644384384, -0.0747106596827507, 0.0022571044974029064, -0.022970620542764664, 0.009292599745094776, -0.016617044806480408, 0.010223841294646263, 0.04749991372227669, 0.008050944656133652, -0.02797686867415905, -0.010045519098639488, -0.0020754793658852577, 0.025691695511341095, -0.0214251559227705, -0.025084076449275017, 0.01069276500493288, 0.0045604407787323, 0.032626472413539886, 0.02071186527609825, -0.032811399549245834, 0.0006191764259710908, 0.012568456120789051, -0.04182000458240509, -0.010547464713454247, -0.005389311816543341, 0.0028184913098812103, -0.009741709567606449, -0.035532474517822266, 0.028135377913713455, -0.004517511464655399, 0.006393203046172857, -0.042797476053237915, -0.045175112783908844, -0.015322552993893623, -0.003962729126214981, 0.013962016440927982, 0.01784549094736576, -0.020804328843951225, -0.051013536751270294, 0.009002000093460083, 0.001915319124236703, -0.021372320130467415, 0.00784620363265276, -0.03006390668451786, 0.00541903218254447, -0.002664935542270541, -0.03191317990422249, -0.042506877332925797, -0.010296491906046867, 0.06504159420728683, -0.00777355395257473, 0.03891400247812271, -0.08945200592279434, 0.014701725915074348, 0.01094373781234026, -0.03777801990509033, 0.004147656727582216, -0.00230663875117898, 0.00490387761965394, 0.0191267728805542, 0.05516119301319122, 0.03735532984137535, 0.0073640719056129456, -0.03524187207221985, 0.048715151846408844, 0.03418514505028725, 0.009636037051677704, 0.01382992509752512, -0.024634966626763344, -0.03627218306064606, -0.031358398497104645, -0.0003826510510407388, -0.04786976799368858, 0.0010385653004050255, 0.0325736366212368, 0.015454644337296486, 0.005831816699355841, 0.030354507267475128, 0.002854816149920225, -0.010038914158940315, 0.005171361844986677, -0.020910002291202545, -0.012614687904715538, 0.013149656355381012, -0.003127253847196698, -0.006660687271505594, -0.050088897347450256, -0.015745244920253754, 0.024978403002023697, 0.002841607201844454, 0.056640610098838806, 0.030856452882289886, 0.005118525121361017, 0.0040717045776546, -0.002222430659458041, -0.009464318864047527, -0.00835475418716669, 0.010151191614568233, 0.007317840121686459, -0.02631252259016037, -0.02631252259016037, -0.010402164421975613, 0.0162868183106184, -0.03650994598865509, -0.022640394046902657, 0.012726965360343456, 0.030856452882289886, -0.015045162290334702, -0.005907768849283457, 0.06155439466238022, 0.02652386762201786, 0.0513569712638855, -0.06049766764044762, -0.014569634571671486, -0.05637642741203308, -0.011835351586341858, -0.03761950880289078, -0.00738388579338789, -0.004283050075173378, 0.02127985656261444, 0.03431723639369011, 0.03587590903043747, 0.04734140634536743, -0.01706615462899208, 0.026497449725866318, -0.01014458667486906, 0.007185749243944883, -0.03952161967754364, 0.02024954743683338, 0.023855630308389664, 0.06166006624698639, 0.041027456521987915, -0.019958946853876114, -0.015150834806263447, -0.020302383229136467, -0.004567045718431473, -0.025942668318748474, -0.02489914931356907, 0.041978511959314346, -0.0008973930962383747, 0.01717182621359825, -0.02060619182884693, -0.001763414591550827, 0.05220235511660576, 0.018955055624246597, -0.025453930720686913, -0.0524136982858181, -0.012687338516116142, 0.015375389717519283, 0.011201314628124237, -0.012726965360343456, -0.05294206365942955, -0.002985256025567651, 0.002030898816883564, -0.024278322234749794, -0.005402520764619112, -0.005528007168322802, 0.012442969717085361, -0.038940418511629105, -0.03481918200850487, -0.002433776156976819, -0.011802328750491142, -0.014265825040638447, 0.0012763290433213115, 0.05325908213853836, -0.009781336411833763, 0.0031041379552334547, -0.019747601822018623, 0.056006573140621185, -0.03938952833414078, 0.0573803186416626, -0.0467337891459465, 0.021768592298030853, 0.01471493486315012, -0.02620684914290905, -0.014860235154628754, 0.024027349427342415, 0.034792762249708176, 0.05199100822210312, -0.02953554317355156, 0.011115455999970436, -0.005901164375245571, 0.013110029511153698, -0.011366428807377815, 0.003295669797807932, -0.042586129158735275, -0.01305058877915144, 0.03595516458153725, 0.05812003090977669, -0.0378836914896965, 0.018889009952545166, -0.010441791266202927, 0.023565029725432396, -0.010527650825679302, 0.0016354514518752694, 0.022085610777139664, 0.010065332055091858, 0.059757959097623825, 0.030539434403181076, -0.021227020770311356, 0.01356574334204197, -0.005343080032616854, -0.013671415857970715, -0.0431937500834465, 0.018968263640999794, -0.015071580186486244, 0.02298383042216301, -0.005656796041876078, -0.02146478369832039, -0.011340009979903698, -0.02149120159447193, -0.031781088560819626, 0.03331334516406059, -0.017303917557001114, 0.006261112168431282, 0.03746100142598152, 0.03347185254096985, 0.016511371359229088, 0.014041271060705185, -0.023248011246323586, 0.005967210046947002, 0.061607230454683304, -0.00738388579338789, -0.003054603934288025, -0.015996217727661133, 0.0361136719584465, -0.006512084975838661, 0.025123704224824905, -0.06102602928876877, 0.0051119206473231316, -0.0027805150020867586, 0.015705617144703865, 0.0024734034668654203, -0.01809646375477314, -0.03804220259189606, -0.031067797914147377, 0.012515620328485966, -0.03016957826912403, -0.025546394288539886, -0.12046696990728378, -0.05790868401527405, -0.03476634621620178, 0.004751972854137421, -0.02669558674097061, 0.026035131886601448, -0.006591339595615864, -0.03569098189473152, 0.024344366043806076, -0.05447432026267052, -0.014582843519747257, -0.018994681537151337, -0.012231624685227871, -0.0036258972249925137, 0.014952698722481728, 0.0006773790228180587, 0.012383528985083103, 0.01622077263891697, -0.01816250942647457, 0.00394952017813921, 0.002174547640606761, -0.010408769361674786, 0.026497449725866318, 0.02610117755830288, -0.025942668318748474, -0.006654082797467709, -0.048820823431015015, -0.012845847755670547, -0.008909536525607109, 0.005765771027654409, -0.012383528985083103, 0.00595730310305953, 0.029878979548811913, 0.016696298494935036, -0.025044448673725128, -0.006422923877835274, -0.008004712872207165, -0.025136912241578102, 0.02361786738038063, 0.023710330948233604, -0.03997072950005531, 0.02591625042259693, 0.03341901674866676, -0.05875406786799431, 0.017026526853442192, 0.002968744607642293, -0.01647174544632435, 0.001552894595079124, -0.025229375809431076, 0.03920460119843483, -0.014847026206552982, 0.01352611556649208, -0.03233586996793747, -0.028531650081276894, -0.015705617144703865, 0.011221128515899181, -0.025612439960241318, -0.0350569449365139, 0.005065688863396645, -0.0055808438919484615, 0.002985256025567651, -0.02216486632823944, -0.013856342993676662, 0.022138448432087898, -0.006185160018503666, -0.01826818287372589, -0.007859413512051105, -0.045914825052022934, -0.0006228915299288929, -0.018004000186920166, -0.010752205736935139, -0.043722111731767654, -0.018690872937440872, -0.00013229736941866577, 0.011643819510936737, 0.017185036092996597, -0.01523008942604065, -0.023789584636688232, 0.047262150794267654, -0.035321127623319626, 0.01986648328602314, 0.029297778382897377, -0.001750205410644412, 0.007859413512051105, 0.02911285124719143, 0.004940202459692955, -0.007971690036356449, 0.019641928374767303, -0.02163650281727314, 0.000471399660455063, -0.009444504976272583, 0.06641533970832825, 0.0031635789200663567, -0.0013820017920807004, -0.03820070996880531, 0.04158223792910576, -0.02995823323726654, 0.00200943392701447, 0.020051410421729088, -0.012826033867895603, -0.030328087508678436, 0.027012605220079422, 0.015454644337296486, -0.05516119301319122, 0.013935597613453865, -0.00115331937558949, 0.01746242679655552, 0.0006208276026882231, -0.022640394046902657, -0.007958481088280678, -0.0075093721970915794, -0.0024915661197155714, -0.01940416358411312, -0.004946806933730841, 0.0019863180350512266, -0.010937132872641087, -0.0421370230615139, 0.04057834669947624, -0.0053133596666157246, -0.013962016440927982, 0.03143765404820442, -0.01670950837433338, -0.014186570420861244, -0.025044448673725128, -0.031173471361398697, 0.05648210272192955, -0.015137625858187675, 0.056323591619729996, -0.015745244920253754, 0.009068045765161514, -0.009814359247684479, 0.0007545697153545916, -0.029667632654309273, -0.004395327065140009, 0.0047420659102499485, 0.005808700807392597, 0.002914257114753127, -0.01211274228990078, 0.049058590084314346, 0.01586412638425827, 0.009457713924348354, -0.01795116439461708, -0.01873050071299076, -0.023789584636688232, 0.06472457945346832, 0.023961303755640984, -0.019139982759952545, 0.01140605565160513, -0.005858234595507383, -0.020566565915942192, -0.05468566343188286, -0.024278322234749794, 0.017039736732840538, -0.03495127335190773, -0.02879583276808262, -0.05605940893292427, -0.022746065631508827, -0.00024643223150633276, -0.0003758401144295931, 0.024621758610010147, 0.0039660315960645676, -0.03423798084259033, 0.009398273192346096, 0.004514208994805813, -0.0007004949729889631, 0.017396381124854088, -0.03183392435312271, 0.0019235748331993818, -0.03191317990422249, -0.020342011004686356, 0.018004000186920166, 0.0009593107388354838, -0.04055193066596985, -0.014913070946931839, 0.039891473948955536, -0.04303523898124695, -0.005270429886877537, -0.03252079710364342, -0.0007624126155860722, -0.005812002811580896, 0.036034420132637024, 0.033736035227775574, -0.002144827274605632, -0.02153082937002182, 0.0034971085842698812, -0.02298383042216301, 0.019589092582464218, -0.019919319078326225, 0.012522224336862564, 0.016986899077892303, 0.026801258325576782, 3.431269578868523e-05, 0.004448163788765669, -0.013592161238193512, -0.0205401461571455, -0.04483167827129364, -0.031067797914147377, -0.004553836304694414, -0.022468674927949905, -0.04171432927250862, 0.019166400656104088, 0.0008610680815763772, -0.015679199248552322, 0.006934776436537504, 0.020910002291202545, 0.009959659539163113, -0.01083806436508894, -0.01756810024380684, 0.03159616142511368, 0.012832638807594776, 0.0036853381898254156, -0.00922655500471592, 0.004953411407768726, 0.028742996975779533, -0.0168151818215847, -0.040604766458272934, 0.0315169058740139, 0.06419621407985687, 0.03492485359311104, 0.007317840121686459, 0.055372536182403564, -0.010738996788859367, -0.03473992645740509, -0.03880832716822624, 0.01081825140863657, -0.00796508602797985, -0.003127253847196698, -0.0012383528519421816, 0.0011789120035246015, 0.04182000458240509, -0.0061620441265404224, -0.028003286570310593, -0.003368319943547249, 0.039151765406131744, 0.014873444102704525, -0.0026864001993089914, 0.0049633183516561985, -0.016511371359229088, 0.008440613746643066, -0.05222877115011215, 0.004055193159729242, 0.005805398337543011, 0.011161687783896923, 0.00480811158195138, 0.0026963071431964636, -0.010554068721830845, 0.027078650891780853, 0.056217920035123825, 0.0368269644677639, 0.011022992432117462, -0.022283747792243958, -0.011808933690190315, -0.0035796654410660267, 0.01904751919209957, 0.013962016440927982, -0.0038603588473051786, -0.049058590084314346, -0.03431723639369011, -0.025876622647047043, -0.02471422217786312, 0.003771197283640504, -0.008698190562427044, -0.0385969839990139, -0.0019549464341253042, 0.004563743248581886, -0.005237407051026821, -0.0006864602910354733, 0.007641463074833155, 0.008235872723162174, -0.005296848248690367, -0.14170719683170319, -0.021187392994761467, 0.019536254927515984, -0.0009221601067110896, 0.04929635301232338, -0.009266181848943233, 0.016934063285589218, -0.03600800037384033, 0.004217004403471947, -0.02503124065697193, -0.01887580007314682, -0.023578239604830742, 0.019681556150317192, 0.013182679191231728, 0.02294420264661312, -0.04506944119930267, 0.009820964187383652, -0.019562672823667526, 0.008486845530569553, 0.0031454162672162056, -0.015375389717519283, 0.006809290032833815, 0.020936420187354088, 0.061818577349185944, -0.0361136719584465, 0.002276918152347207, 0.009035022929310799, 0.023498984053730965, 0.01632644422352314, 0.040314167737960815, -0.015890544280409813, -0.017079362645745277, 0.016801971942186356, 0.035215456038713455, -0.02932419627904892, 0.033445436507463455, -0.009035022929310799, -0.018889009952545166, -0.010085145942866802, -0.000853637931868434, 0.04018207639455795, -0.041344475001096725, 0.08691586554050446, 0.004491093102842569, 0.01738317310810089, -0.006987612694501877, 0.014054480008780956, -0.013724252581596375, 0.013486488722264767, -0.0332869254052639, 0.013605370186269283, -0.005871444009244442, 0.0114192645996809, -0.0249651949852705, -0.008434008806943893, 0.020949628204107285, 0.020091038197278976, -0.0005745957605540752, 0.003969334065914154, 0.0025262399576604366, -0.027422087267041206, 0.03569098189473152, 0.03714398294687271, -0.027739105746150017, -0.03672129288315773, -0.01229106541723013, -0.0051647573709487915, 0.028637323528528214, -0.018109673634171486, 0.0005035968497395515, -0.005798793863505125, 6.542631308548152e-05, 0.004996341187506914, -0.0059606051072478294, -0.006086091510951519, -0.005263825412839651, -0.009536968544125557, 0.0368269644677639, -0.04525436833500862, 0.002268662443384528, 0.030803615227341652, -0.028980759903788567, 0.033445436507463455, 0.012046696618199348, -0.011115455999970436, 0.014794189482927322, -0.0031156959012150764, -0.003919799812138081, -0.024199066683650017, 0.033128418028354645, 0.03452857956290245, -0.010369141586124897, 0.008559495210647583, -0.0435636043548584, -0.011141873896121979, -0.021293064579367638, -0.007337653543800116, 0.008810468018054962, 0.011505124159157276, -0.0038801725022494793, 0.021451573818922043, 0.06625683605670929, -0.02199314720928669, -0.0019433884881436825, -0.006287530530244112, 0.012026883661746979, 0.011465496383607388, 0.03526829183101654, 0.028003286570310593, -0.03326050937175751, 0.026220059022307396, -0.012013674713671207, -0.03450216352939606, 0.002622005995362997, -0.013077006675302982, 0.01559994462877512, 0.04646960645914078, -0.0032989720348268747, 0.02064581960439682, -0.00879725906997919, 0.022864947095513344, 0.029086433351039886, -0.023525403812527657, -0.008889722637832165, -0.029878979548811913, -0.04057834669947624, 0.014516797848045826, 7.657148671569303e-05, -0.011921210214495659, -0.007403699215501547, 0.008823676966130733, -0.025044448673725128, 0.03518903627991676, 0.0008470333996228874, -0.025057658553123474, 0.03991789370775223, 0.01647174544632435, 0.03056585229933262, -0.01841348223388195, 0.01891542784869671, 0.005732748191803694, -0.010408769361674786, 0.005494984798133373, 0.05928242951631546, 0.016524581238627434, -0.011703260242938995, 0.00013074942398816347, -0.03204527124762535, -0.0016106843249872327, -0.0056997258216142654, 0.03732891008257866, 0.0002468450111337006, -0.008863304741680622, 0.013895970769226551, -0.025123704224824905, 8.658150909468532e-05, 0.00795187707990408, -0.012845847755670547, -0.019430583342909813, 0.012502411380410194, 0.022217702120542526, 0.03024883382022381, -0.00045736500760540366, -0.011425869539380074, 0.013671415857970715, -0.0013299910351634026, -0.003933008760213852, -0.017396381124854088, 0.012000464834272861, 0.018611619248986244, -0.023538611829280853, -0.025084076449275017, 0.028161795809864998, 0.013407234102487564, 0.014133734628558159, 0.001958248671144247, 0.00387356779538095, 0.025876622647047043, -0.00573605066165328, 0.011313592083752155, 0.018545573577284813, 0.022006357088685036, -0.034079473465681076, 0.0054256366565823555, 0.04298240318894386, -0.033868126571178436, -0.015335761941969395, -0.0007987376302480698, -0.0016007774975150824, 0.024938777089118958, 0.014318661764264107, 0.03331334516406059, 0.006446039769798517, 0.043008822947740555, 0.023565029725432396, 0.014477171003818512, -0.022970620542764664, 0.0050095501355826855, -0.009583200328052044, -0.03016957826912403, -0.009999287314713001, 0.026127595454454422, 0.0010484721278771758, -0.012627897784113884, -0.043616440147161484, -0.0024585432838648558, -0.03997072950005531, -0.018783336505293846, 0.0030067209154367447, -0.0010187516454607248, -0.01063992828130722, 0.009979473426938057, -0.02146478369832039, 0.02921852469444275, -0.002344614826142788, -0.04847738891839981, 0.03283781558275223, 0.015639571473002434, -0.030037488788366318, -0.016907645389437675, -0.022323375567793846, -0.03220377862453461, 0.016484953463077545, 0.021055301651358604, -0.008744422346353531, -0.0027458411641418934, 0.03944236412644386, -0.006749848835170269, 0.01037574652582407, 0.0003009197534993291, -0.020883582532405853, 0.03278497979044914, -0.04961337149143219, 0.009008605033159256, -0.0028515139129012823, 0.005574239417910576, -0.017013316974043846, -0.013962016440927982, -0.01229106541723013, 0.0006621060310862958, 0.008988791145384312, 0.004887366201728582, 0.004296259023249149, -0.013446860946714878, 0.018373854458332062, 0.0003640757640823722, 0.015586735680699348, 0.02666916884481907, -0.02734283171594143, -0.02479347586631775, -0.016339654102921486, 0.031464070081710815, 0.03994430974125862, -0.009741709567606449, 0.014992325566709042, 0.009939845651388168, -0.026616331189870834, 0.061818577349185944, 0.058912575244903564, 0.0114192645996809, -0.007839599624276161, 0.007238585501909256, -0.013895970769226551, -0.014939489774405956, -0.017964372411370277, -0.02334047481417656, 0.01083806436508894, -0.001720484928227961, -0.009021813981235027, 0.005878048483282328, -0.0029472799506038427, -0.0015916962875053287, -0.003619292750954628, 0.033841706812381744, 0.011538146995007992, -0.016775554046034813, 0.025770949199795723, -0.03756667301058769, 0.015322552993893623, 0.004193888511508703, -0.021662920713424683, -0.05251937359571457, -0.03310199826955795, -0.0332869254052639, 0.04221627488732338, 0.00404528621584177, 0.0214251559227705, -0.005115223117172718, 0.014041271060705185, -1.268666710529942e-05, 0.04068402200937271, 0.033128418028354645, -0.018387064337730408, -0.010045519098639488, -0.012158974073827267, -0.01788511872291565, 0.006581433117389679, 0.018466318026185036, 0.005643587093800306, -0.01081825140863657, 0.015045162290334702, 0.01071257796138525, -0.017343545332551003, 0.013935597613453865, 1.502792838437017e-05, 0.020989255979657173, 0.02174217440187931, -0.01528292614966631, -0.015956589952111244, -0.02503124065697193, -0.03664203733205795, 0.012205205857753754, 0.006188462022691965, 0.02121381089091301, 0.0020622704178094864, -0.00267319125123322, -0.006713523995131254, 0.007370676379650831, -0.0023891956079751253, 0.0024585432838648558, -0.02135911025106907, -0.020976047962903976, -0.0047222524881362915, -0.018902217969298363, -0.009068045765161514, 0.01657741703093052, -0.007780158426612616, -0.037910111248493195, 0.0075027672573924065, 0.01618114486336708, -0.007027240004390478, 0.022534720599651337, 0.015943380072712898, -0.014054480008780956, -0.0013357700081542134, 0.030011069029569626, -0.008724609389901161, -0.003338599344715476, -0.03109421581029892, -0.0182417631149292, 0.015441435389220715, 0.01352611556649208, -0.0068158945068717, -0.011254151351749897, -0.001520697376690805, 0.008434008806943893, -0.012244833633303642, 0.011287174187600613, 0.02245546691119671, -0.013592161238193512, 0.07872622460126877, -0.0010484721278771758, -0.017237871885299683, 0.01281942892819643, -0.010019100271165371, 0.007476349361240864, -0.004441559314727783, -0.0011500170221552253, -0.04150298610329628, 0.00988040491938591, -0.02100246585905552, 0.03397379815578461, -0.020804328843951225, -0.0007727321935817599, 0.028954342007637024, -0.0005494158831425011, -0.01209292933344841, 0.009087858721613884, 0.01784549094736576, 0.014173361472785473, 0.029165687039494514, 0.021940311416983604, -0.021451573818922043, 0.008618935942649841, -0.025731321424245834, -0.0015405110316351056, -0.0177001915872097, 0.02932419627904892, -0.023683911189436913, 0.015665989369153976, -0.00968226883560419, -0.022891366854310036, -0.043722111731767654, 0.002620354760438204, 0.023221593350172043, 0.008361359126865864, -0.05521402880549431, -0.008150013163685799, 0.0033666687086224556, 0.01788511872291565, -0.00853307731449604, 0.0027507946360856295, -0.0023561727721244097, -0.00931241363286972, -0.029033595696091652, 0.014424334280192852, -0.0028977456968277693, 0.010461605153977871, -0.022283747792243958, 0.014490379951894283, -0.021121347323060036, -0.016907645389437675, 0.01534897182136774, -0.02850523218512535, -0.0012540386524051428, -0.020725073292851448, -0.018215345218777657, 0.01805683597922325, 0.018651245161890984, 0.002671540016308427, -0.031781088560819626, 0.038121454417705536, -0.01446396205574274, 0.03278497979044914, 0.022930992767214775, -0.031041380017995834, -0.0059606051072478294, 0.0214251559227705, -0.007766949478536844, 0.0630338117480278, -0.03775160014629364, 0.025625649839639664, -0.0035202244762331247, 0.0006195892347022891, -0.004887366201728582, 0.006129021290689707, 0.0057756779715418816, 0.03518903627991676, -0.009200136177241802, 0.029271360486745834, -0.0162868183106184, 0.01299775205552578, 0.014331870712339878, 0.012350506149232388, 0.018545573577284813, 0.027950450778007507, 0.006802685093134642, -0.02578415907919407, -0.011386241763830185, 0.007562208455055952, -0.0062181828543543816, 0.007370676379650831, 0.03598158061504364, -0.0037645928096026182, 0.0010377396829426289, -0.024093393236398697, 0.021121347323060036, -0.028452396392822266, 0.0027970264200121164, 0.03236228972673416, 0.0042335158213973045, -0.03429081663489342, 0.034264400601387024, 0.024278322234749794, -0.02315554767847061, 0.018360646441578865, -0.055583883076906204, -0.024912357330322266, 0.010177609510719776, 0.0208967924118042, -0.0016783809987828135, -8.24020680738613e-05, 0.03473992645740509, 0.014516797848045826, 0.009404877200722694, 0.005696423351764679, -0.037091147154569626, 0.02205919288098812, 0.005049177445471287, -0.034396491944789886, 0.0168151818215847, -0.02024954743683338, 0.04189925640821457, 0.0052308025769889355, 0.049771878868341446, -0.004844436421990395, -0.010930527932941914, -0.005752562079578638, -0.004827925004065037, 0.042506877332925797, -0.026537077501416206, -0.00360278133302927, 0.01466209813952446, -0.008612331934273243, 0.04026132822036743, 0.006122416816651821, -0.002131618093699217, 0.016405699774622917, -0.021662920713424683, -0.00018399860709905624, 0.016696298494935036, -0.025731321424245834, 0.007740531116724014, 0.027184322476387024, -0.005343080032616854, -0.0003814126830548048, -0.0016437070444226265, -0.020355219021439552, 0.005369498394429684, 0.01361858006566763, -0.012363715097308159, -0.008361359126865864, -0.007416908163577318, 0.024370785802602768, -0.0009659152710810304, -0.0033121812157332897, 0.0026698887813836336, -0.0036391064058989286, 0.008440613746643066, 0.009233159013092518, 0.03069794364273548, -0.02758059650659561, 0.0034739926923066378, 0.03986505791544914, 0.03513620048761368, -0.006713523995131254, -0.01039555948227644, -0.009385064244270325, 0.0028069333638995886, -0.012132556177675724, -0.023353684693574905, 0.01234390214085579, 0.009735104627907276, -0.03463425487279892, -0.028029704466462135, -0.030433760955929756, 0.023948093876242638, 0.0196551363915205, -0.02755417861044407, 0.015560316853225231, 0.00030731791048310697, -0.013057192787528038, 0.02323480322957039, -0.013519511558115482, -0.03088287077844143, 0.00826889555901289, 0.018862592056393623, 0.01725108176469803, 0.007443326525390148, -0.008275499567389488, -0.0029043504036962986, -0.006436132825911045, 0.008612331934273243, -0.01110224612057209, 0.014358289539813995, -0.012271251529455185, 0.00519777974113822, -0.0028366537299007177, 0.0011945978039875627, 0.0226668119430542, -0.0009692175663076341, -0.013644997961819172, 0.023419730365276337, 0.013294956646859646, 0.0034872018732130527, -0.0018591805128380656, -0.010884296149015427, -0.00764806754887104, -0.00016831279208417982, 0.01784549094736576, 0.01986648328602314, 0.001907063415274024, -0.01039555948227644, 0.01845311000943184, 0.012964729219675064, -0.0013002705527469516, 0.03569098189473152, -0.011201314628124237, -0.001126075629144907, -0.02924494259059429, -0.015507481060922146, 0.00988040491938591, 0.005075595807284117, 0.022230911999940872, -0.017871908843517303, 0.014794189482927322, 0.004662811290472746, -0.001976411323994398, 0.008024526759982109, 0.030328087508678436, 0.02315554767847061, -0.019245654344558716, -0.00791224930435419, -0.01590375415980816, -0.0012986194342374802, -0.0062842280603945255, 0.012449574656784534, -0.016128309071063995, 3.389991252333857e-05, 0.004646299872547388, -0.04303523898124695, 0.0214251559227705, -0.0026484241243451834, -0.00980775523930788, -0.01569240726530552, 0.040816113352775574, 0.01014458667486906, 0.023327266797423363, -0.01923244632780552, 0.009497340768575668, 0.0003021581214852631, 0.02159687504172325, 0.0113334059715271, -0.01862482726573944, 0.02344614826142788, -0.01172307413071394, 0.01414694357663393, -0.03743458166718483, 0.015705617144703865, 0.014622471295297146, -0.01773981750011444, -0.007780158426612616, 0.01735675521194935, 0.013222306966781616, -0.0057954913936555386, 0.01611509919166565, -0.010600300505757332, -0.0008003887487575412, -0.016986899077892303, -0.03743458166718483, 0.002782166237011552, 0.0030083719175308943, 0.019985364750027657, 0.0104483962059021, 0.0033270413987338543, 0.03088287077844143, -0.009887009859085083, 0.0032147641759365797, 0.011214523576200008, -0.020989255979657173, 0.043642859905958176, -0.026814468204975128, -0.0017469031736254692, -0.015005534514784813, -0.007634858600795269, -0.014688516966998577, -0.033207669854164124, 0.002671540016308427, -0.002874629804864526, 0.013321374543011189, -0.02521616779267788, 0.008916140533983707, 0.052360862493515015, -0.035611726343631744, -0.048503804951906204, -0.01866445504128933, -0.00017006712732836604, -0.030354507267475128, 0.008308522403240204, 0.018426692113280296, -0.00873121339827776, -0.02614080347120762, -0.010752205736935139, -0.005045875441282988, 0.0414237305521965, 0.04160865768790245, -0.020209919661283493, 0.026286104694008827, -0.0024750547017902136, -0.010085145942866802, 0.013724252581596375, 0.009900218807160854, -0.0054322415962815285, -0.0022703136783093214, -0.03130556270480156, 0.016617044806480408, -0.006862126290798187, -0.004296259023249149, -0.005944094154983759, 0.027501340955495834, -0.03267930820584297, 0.010970155708491802, 0.014741352759301662, 0.011115455999970436, 0.012145765125751495, -0.021940311416983604, -0.005501589272171259, -0.0026748422533273697, 0.012528829276561737, 0.021438365802168846, 0.01990611106157303, 0.007852808572351933, 0.010857878252863884, -0.011881583370268345, -0.003962729126214981, 0.0033121812157332897, 0.009457713924348354, 0.013592161238193512, 0.03933669254183769, -0.033022742718458176, -0.0032824608497321606, 0.008222662843763828, -0.01352611556649208, -0.023353684693574905, -0.043088074773550034, 0.004174074623733759, -0.01476777158677578, 0.017013316974043846, 0.01706615462899208, 0.019998574629426003, 0.02747492305934429, 0.007601835764944553, 0.0028647230938076973, -0.03138481453061104, 0.01891542784869671, 0.02850523218512535, 0.019628718495368958, 0.0016098588239401579, -0.025770949199795723, -0.0011384590761736035, -0.03347185254096985, 0.007932063192129135, 0.028558069840073586, 0.007892435416579247, 0.008453822694718838, 0.015071580186486244, -0.016379281878471375, -0.036668453365564346, 0.002539448905736208, -0.03265288844704628, -0.00936525035649538, 0.04182000458240509, 0.034977689385414124, 0.015375389717519283, -0.022825321182608604, -0.021372320130467415, -0.015983007848262787, -0.017158618196845055, 0.00659464206546545, 0.003411249490454793, 0.027395669370889664, -0.03761950880289078, -0.01317607518285513, -0.013281747698783875, 0.0205401461571455, -0.009510550647974014, -0.006640873849391937, 0.01752847246825695, -0.012152370065450668]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
":t)πs(oT)
log 
1−sigmoid 
logψθ
t(s1:t, oT)
Noise Contrastive Estimation
FUDGETP
t=1−Eπs(s1:t,oT)Ep0(st+1:T|s1:t)h
σ(oT|s1:T) logψθ
t(s1:t, oT) +
1−σ(oT|s1:T)
log
1−ψθ
t(s1:t, oT)i
Binary Classification
DPG Eπs(oT)h
DKL 
σ(s1:T|oT)qξ(s1:T|oT)i
Maximum Likelihood (MLE)
PPO Eπs(oT)h
DKL 
qξ(s1:T|oT)σ(s1:T|oT)i
Variational Inference
Table 1: Losses for twist (top) and proposal (bottom) learning, where πs(·)indicates an arbitrary sampling distribution.
samples for training using rejection sampling, and use our
twist learning procedures to greatly improve sampling effi-
ciency at generation time.
While an improved proposal qshould more efficiently draw
samples meeting the target conditions, exact rejection sam-
pling would require estimation of M. Approximate or quasi
rejection sampling might be used in this case, as analysed
in Eikema et al. (2022).
Approximate Positive Sampling using SIS or SMC In
cases where exact samples are unavailable and rejection sam-
pling is inefficient or inexact, we leverage SMC sampling
with twist targets {πθ
t}T
t=1and any proposal q(s1:T)to first
draw a set of Kfull sequences s1:K
1:T. As in Eq. (4), we can
use the normalized SMC weights since the last resampling
step to estimate the expected gradient in the first term of
Eq. (22). Without resampling, we recover SIS estimation.
While both our approximate positive and negative sampling
for estimating the expectations in Eq. (22) rely on SMC
orSISweights (often with the same proposal), the crucial
distinction is that weights for positive sampling are based
on the true target potential ϕ(s1:T)over fullsequences.
Truncation to Partial Sequences For an exact positive
sample, we use its truncation to a partial sequence of length
t(which corresponds to a sample from the desired marginal
σt) to perform the gradient update in Eq. (22). For approx-
imate positive sampling, we use the same set of Kfinal
weights to estimate the expected gradient at each timestep.
4.2. Twist Learning Methods from Related Work
We briefly describe alternative approaches for twist learning,
with detailed discussion in App. C and a summary of the loss
functions for methods used in our experiments in Table 1.
Soft Q-Learning (RL) Enforcing the recursion in Eq. (13)
using a squared error loss is analogous to soft Q-learning
in the RLliterature (see Eq. (20)), and has been used
for twisted SMC in Lioutas et al. (2022). Mudgal et al.
(2023) derive a similar squared-error loss, viewing ϕ(s1:T)
as the reward. Finally, we interpret path consistency losses
(Nachum et al., 2017), which were derived in the soft RL
setting and have been used for language modeling in Guo
et al. (2021); Hu et al. (2023), from an importance samplingperspective in App. C.1 and E.1.
SIXO TheSIXO loss proposed by Lawson et al. (2022)
learns twist functions using a binary classification task to
distinguish samples from the target marginal σ(s1:t|oT)and
base model p0(s1:t)at each step, which corresponds to noise
contrastive estimation (Gutmann & Hyv ¨arinen, 2010) for
learning energy-based models. See App. C.3.
FUDGE Yang & Klein (2021) learn twists by construct-
ing a binary classification task to instead learn the condi-
tional likelihood σ(oT|s1:t)(Eq. (18)). This may be viewed
as enforcing the T−tstep optimality equation in Eq. (12) or
Eq. (18), where rollouts should be obtained using the base
model p0(st+1:T|s1:t)(see Table 1 or App. C.4). Mudgal","[-0.0026963921263813972, -0.012891063466668129, 0.006323277018964291, -0.01149192824959755, -0.05099373310804367, 0.00982790719717741, 0.0037117840256541967, -0.004927537869662046, -0.0249942634254694, 0.027235597372055054, 0.038822613656520844, -0.03855093568563461, -0.00846273172646761, 0.004024212248623371, 0.05150991678237915, 0.010547851212322712, 0.05167292430996895, 0.007396400440484285, -0.02457316592335701, 0.03485612943768501, -0.023024607449769974, -0.03148733824491501, -0.0246682520955801, 0.034013934433460236, 0.02369021624326706, -0.03124283067882061, 0.05107523500919342, 0.010955366306006908, 0.01596101187169552, -0.00519581837579608, 0.040833018720149994, -0.02728993259370327, -0.02790120616555214, -0.034801796078681946, -0.036187347024679184, 0.051645755767822266, -0.011390049010515213, 0.051835931837558746, -0.028444558382034302, 0.014847136102616787, 0.005335052963346243, -0.0647677481174469, 0.005688232835382223, 0.016721706837415695, 0.026284728199243546, 0.035834167152643204, 0.012014905922114849, 0.022250328212976456, -0.0153089864179492, 0.037681568413972855, -0.023581543937325478, 0.043142274022102356, 0.009400016628205776, -0.010119959712028503, -0.01905812695622444, -0.0025996072217822075, -0.024586748331785202, -0.010160711593925953, 0.019248299300670624, -0.026447735726833344, 0.03309023380279541, -0.03588850423693657, 0.01254467573016882, 0.012137160636484623, 0.031731847673654556, -0.003273705253377557, -0.07433076947927475, 0.04710875451564789, -0.007987297140061855, 0.045587364584207535, 0.012741641141474247, 0.007824291475117207, 0.025754958391189575, 0.009889034554362297, 0.01808008924126625, 0.032085027545690536, 0.02500784769654274, 0.048820316791534424, 0.00572558818385005, -0.03469312563538551, 0.022603508085012436, -0.006486283149570227, 0.02341853827238083, -0.011539471335709095, -0.006564390379935503, -0.02421998605132103, -0.055150385946035385, -0.02210090681910515, -0.04854864254593849, -0.010663313791155815, -0.00321257789619267, 0.018460437655448914, -0.03678503632545471, -0.007600157987326384, 0.047597773373126984, 0.003538590157404542, 0.028553230687975883, 0.0005556638934649527, 0.019791653379797935, 0.012374876998364925, -0.01650436408817768, -0.0049547054804861546, 0.035997174680233, -0.008727616630494595, 0.0556122362613678, -0.008136719465255737, -0.014466788619756699, -0.0033925638999789953, -0.03309023380279541, 0.0128163518384099, -0.024152066558599472, -0.017658991739153862, -0.03501913696527481, 0.020022578537464142, 0.03694804385304451, -0.05482437461614609, -0.037328388541936874, -0.010622561909258366, -0.026882417500019073, -0.017305811867117882, -0.06465907394886017, -0.032519709318876266, 0.027534442022442818, 0.004737364128232002, 0.013638174161314964, -0.004224574193358421, -0.013359705917537212, -0.05911686643958092, 0.020946279168128967, 0.02534744329750538, 0.00010766253399197012, 0.02939542755484581, -0.00022158637875691056, 0.005039604380726814, -0.005779923405498266, 0.01571650244295597, -0.006544014438986778, 0.022413333877921104, -0.014928638935089111, 0.029341092333197594, 0.006268941797316074, -0.03624168410897255, -0.034095436334609985, 0.016993382945656776, 0.011301754042506218, 0.0011104788864031434, -0.023391371592879295, 0.02457316592335701, -0.014249446801841259, 0.041457876563072205, -0.023404954001307487, -0.03379659354686737, -0.03529081493616104, 0.034964803606271744, -0.019017374143004417, -0.043305277824401855, -0.023459291085600853, 0.05553073436021805, -0.020199168473482132, -0.017265059053897858, 0.010452764108777046, 0.030943986028432846, 0.04341394826769829, 0.001311689498834312, 0.017414482310414314, -0.008360853418707848, -0.04360412433743477, 0.021014198660850525, -0.051917433738708496, -0.02833588793873787, 0.04395730420947075, -0.047597773373126984, -0.022073738276958466, -0.020063329488039017, 0.03404109925031662, -0.013366498053073883, -0.010561434552073479, -0.07655851542949677, -0.02176131121814251, -0.0249942634254694, -0.020226337015628815, 0.040670014917850494, -0.013495543971657753, 0.005022624507546425, 0.01859627664089203, -0.003895165864378214, 0.0037830991204828024, 0.021082118153572083, 0.03143300488591194, 0.024967096745967865, 0.007695245090872049, 0.04344111680984497, 0.0686255544424057, -0.0004839242610614747, -0.051482751965522766, 0.008972126059234142, 0.07911227643489838, 0.056291431188583374, 0.04183822497725487, 0.0020545555744320154, -0.007192642893642187, 0.023975476622581482, -0.032411038875579834, -0.04977118596434593, -0.007403192110359669, 0.00019250846526119858, 0.0007505071116611362, -0.0033246446400880814, -0.07574348896741867, 0.015105228871107101, 0.0324653759598732, -0.0029765586368739605, 0.026393398642539978, 0.019193964079022408, -0.03317173570394516, 0.03702954575419426, -0.0364861935377121, -0.01841968670487404, -0.01650436408817768, 0.07036428898572922, 0.015336154028773308, -0.012843519449234009, 0.027235597372055054, 0.037681568413972855, -0.048494305461645126, -0.0021224748343229294, 0.015213900245726109, -0.010201463475823402, 0.03711104765534401, -0.028064211830496788, 0.034720294177532196, -0.004445311147719622, -0.020022578537464142, -0.02833588793873787, 0.022956687957048416, -0.028145715594291687, -0.041294872760772705, -0.006720604375004768, -0.020484428852796555, -0.05419951677322388, -0.004289097152650356, 0.010255798697471619, -0.003545382060110569, -0.020824026316404343, -0.014670546166598797, 0.04754343628883362, -0.026393398642539978, 0.02597230114042759, 0.04713592305779457, -0.006707020569592714, -0.008157094940543175, 0.014643378555774689, 0.004968289285898209, -0.0162326879799366, -0.04254458472132683, -0.03322606906294823, 0.012225455604493618, 0.0162326879799366, -0.06368103623390198, 0.010466348379850388, 0.039365965873003006, -0.03425844386219978, -0.02756160870194435, 0.04284342750906944, -0.020647436380386353, 0.0023058566730469465, -0.012035281397402287, -0.019628647714853287, 0.04632089287042618, -0.03458445519208908, -0.04069718345999718, 0.004730571992695332, -0.035589657723903656, 0.028933577239513397, 0.008000881411135197, -0.03175901621580124, 0.021829228848218918, 0.021285876631736755, -0.004092131741344929, 0.0454786941409111, -0.005301093216985464, -0.040398336946964264, 0.024763338267803192, -0.012632970698177814, -0.018093673512339592, 0.035834167152643204, -0.010384844616055489, 0.00842197984457016, -0.03746422752737999, -0.039447467774152756, 0.00520261051133275, -0.02043009363114834, 0.016545116901397705, -0.02053876407444477, 0.011553055606782436, 0.038741108030080795, 0.014249446801841259, -0.016803208738565445, 0.03010178729891777, -0.009284554049372673, 0.026977503672242165, -0.036296017467975616, -0.02955843321979046, 0.026203226298093796, 0.005436931736767292, 0.019356971606612206, 0.024939928203821182, 0.004010628443211317, -0.006951529532670975, -0.0056950245052576065, -0.03306306526064873, -0.026882417500019073, 0.0017608051421120763, 0.025388196110725403, -0.019710151478648186, -0.02124512381851673, 0.043930135667324066, 0.012843519449234009, -0.0021343608386814594, -0.04626655578613281, -0.02517085336148739, -0.016354942694306374, -0.007355649024248123, 0.010303341783583164, 0.008625737391412258, -0.02510293386876583, -0.0396919772028923, 0.004907161928713322, -0.02369021624326706, -0.011002909392118454, 0.012259414419531822, -0.03708387911319733, 0.003929125610738993, 0.004010628443211317, -0.04346828535199165, -0.04061567783355713, -0.01219149585813284, 0.04895615577697754, 0.0006728245061822236, 0.01320349145680666, -0.11692968755960464, -0.017591072246432304, 0.0011707571102306247, -0.054634202271699905, -0.010982533916831017, 0.018012171611189842, 0.014860720373690128, 0.020036162808537483, 0.04134920611977577, 0.039447467774152756, -0.0075118630193173885, -0.03159600868821144, 0.03757289797067642, 0.005443723406642675, 0.027792535722255707, -0.005161859095096588, -0.03613301366567612, -0.04816829413175583, -0.041620884090662, 0.009943370707333088, -0.04219140484929085, -0.006727396510541439, 0.020728938281536102, 0.01676245778799057, 0.019465642049908638, 0.003626885125413537, 0.005273925606161356, -0.009576606564223766, 0.011573431082069874, -0.021734142675995827, -0.006452323403209448, -0.001113874837756157, -0.01640927791595459, -0.0066730608232319355, -0.05069488659501076, -0.012517508119344711, 0.013488751836121082, 0.021897148340940475, 0.037518564611673355, 0.027398603036999702, 0.004570961929857731, -0.006061788182705641, -0.00564068928360939, -0.017699742689728737, -0.00476453173905611, -0.0035827376414090395, -0.009787156246602535, -0.019818821921944618, -0.0012488642241805792, 0.013223867863416672, -0.0028526061214506626, -0.018718529492616653, -0.036105845123529434, 0.02184281311929226, -0.004907161928713322, -0.020484428852796555, -0.009012877009809017, 0.06183363497257233, 0.03721971809864044, 0.03113415837287903, -0.04863014444708824, -0.008000881411135197, -0.06987527012825012, -0.007817499339580536, -0.05153708532452583, -0.012952190823853016, 0.033307574689388275, -0.009284554049372673, 0.03993648663163185, 0.04376712813973427, 0.040941692888736725, -0.03322606906294823, 0.02079685777425766, -0.020375758409500122, 0.007077180314809084, -0.05618275701999664, 0.040398336946964264, 0.010507099330425262, 0.04800528660416603, 0.06449607014656067, -0.0014254541601985693, 0.00748469540849328, 0.0021768102888017893, 0.015186731703579426, -0.004465687088668346, -0.01746881753206253, 0.04898332431912422, 0.008564610965549946, 0.04634805768728256, -0.03186768665909767, 0.0021768102888017893, 0.048738814890384674, 0.022617092356085777, -0.03977348282933235, -0.05414518341422081, -0.04871164634823799, 0.010242214426398277, -0.005915761925280094, -0.005722192116081715, -0.06596311926841736, -0.01215074397623539, 0.006343652959913015, 0.004482666961848736, 0.0034655770286917686, -0.007539030630141497, 0.032411038875579834, -0.039447467774152756, -0.030400631949305534, 0.0022464273497462273, -0.03097115270793438, 0.0021547365467995405, 0.01373326126486063, 0.04955384507775307, -0.009569814428687096, 0.00017648377979639918, -0.042517416179180145, 0.06368103623390198, -0.011790771968662739, 0.05808449536561966, -0.06373537331819534, 0.006075371988117695, 0.016735289245843887, -0.00881591159850359, 0.016531532630324364, 0.0066696652211248875, 0.0459677129983902, 0.026393398642539978, -0.0162326879799366, -0.0005976888933219016, 0.005837654694914818, -0.002438299125060439, -0.011865483596920967, 0.026542821899056435, -0.013746845535933971, -0.009223426692187786, 0.04099602624773979, 0.059279873967170715, -0.01825667917728424, 0.03257404640316963, 0.011254210956394672, 0.00017001024389173836, 0.016721706837415695, 0.013841931708157063, 0.00899250153452158, 0.02159830369055271, 0.040235333144664764, 0.029721440747380257, -0.031704679131507874, -0.013230659067630768, -0.01640927791595459, -0.02536102756857872, -0.05895386263728142, 0.007342065218836069, -0.015512743964791298, 0.027588777244091034, -0.014765633270144463, -0.0033178527373820543, -0.004706800449639559, -0.019017374143004417, -0.022943103685975075, 0.04534285515546799, 0.0038510183803737164, 0.02624397724866867, 0.04238157719373703, 0.038931284099817276, 0.007851459085941315, -0.0050294166430830956, -0.015173148363828659, -0.0031667326111346483, 0.07547181099653244, 0.022861601784825325, 0.004407955799251795, -0.02237258292734623, 0.02955843321979046, 0.011987738311290741, 0.02587721310555935, -0.04151221364736557, -0.015865923836827278, -0.007831083610653877, 0.014670546166598797, -0.023758133873343468, -0.013841931708157063, -0.035046305507421494, -0.015213900245726109, 0.0066085378639400005, -0.03257404640316963, -0.034448616206645966, -0.12355860322713852, -0.046293724328279495, -0.045315686613321304, -0.0006656080950051546, -0.022617092356085777, 0.029178086668252945, 0.01956072822213173, -0.029286757111549377, 0.01181114837527275, -0.033470578491687775, -0.02148963324725628, -0.01495580654591322, -0.012965774163603783, -0.0038510183803737164, 0.01320349145680666, -0.013706093654036522, 0.014819968491792679, 0.01495580654591322, 0.0036065091844648123, 0.01356346346437931, 0.0013864005450159311, -0.02063385210931301, 0.00934568140655756, 0.033823758363723755, -0.017346562817692757, -0.013325746171176434, -0.032166529446840286, -0.006618725601583719, 0.009766780771315098, 0.004744155798107386, 0.021190788596868515, 0.008551026694476604, 0.03002028539776802, 0.03211219608783722, -0.03800758346915245, -0.0067613557912409306, 0.0010187879670411348, -0.02404339611530304, 0.013414041139185429, 0.022617092356085777, -0.018840784206986427, 0.017591072246432304, 0.03175901621580124, -0.05493304505944252, 0.0017124126898124814, 0.02370379865169525, -0.038224924355745316, -0.018311014398932457, -0.030753811821341515, 0.017536737024784088, -0.03656769543886185, 0.0021768102888017893, -0.020144833251833916, -0.03493763506412506, -0.0380890853703022, 0.007865042425692081, -0.03376942500472069, -0.04297926649451256, 0.02544253133237362, 0.00812313612550497, 0.008381228893995285, -0.011030077002942562, 0.012714473530650139, 0.02335061877965927, -0.013509128242731094, -0.006000660825520754, 0.0008146058535203338, -0.03333473950624466, -0.007409984245896339, 0.0022430315148085356, -0.005861426703631878, -0.039528973400592804, -0.003874790156260133, -0.008768368512392044, 0.002630170900374651, 0.01745523326098919, -0.021571137011051178, -0.01947922445833683, 0.05960588529706001, -0.03912145644426346, 0.025252357125282288, 0.04561453312635422, 0.0006375914672389627, 0.031025487929582596, 0.03624168410897255, 0.005854634568095207, -0.011471551842987537, -0.0017930667381733656, -0.041892558336257935, 0.019071709364652634, -0.005416555795818567, 0.049173496663570404, -0.017591072246432304, -0.003579341573640704, -0.04819546267390251, 0.044799502938985825, -0.011770396493375301, 0.014860720373690128, 0.014018521644175053, -0.015933843329548836, -0.01513239648193121, 0.011987738311290741, 0.02271217852830887, -0.060692593455314636, -0.0036846164148300886, -0.008095968514680862, 0.005851238500326872, -0.0037661194801330566, -0.012632970698177814, -0.013692510314285755, -0.015648582950234413, 0.019900323823094368, -0.010941782034933567, 0.014426036737859249, 0.007145099341869354, -0.010812736116349697, -0.022956687957048416, 0.05232494696974754, -0.01843326911330223, -0.030047452077269554, 0.0327913872897625, -0.02123154141008854, -0.008544234558939934, -0.019533561542630196, -0.030780980363488197, 0.039257295429706573, -0.03512780740857124, 0.051645755767822266, -0.024450911208987236, 0.012143951840698719, -0.011817940510809422, 0.0007458376931026578, -0.02947693131864071, -0.020674603059887886, -0.0027914789970964193, 0.011505511589348316, -0.019438473507761955, -0.006465907208621502, 0.035834167152643204, -0.005409764125943184, 0.03363358601927757, -0.008326893672347069, -0.010880655609071255, -0.021924316883087158, 0.0609099343419075, 0.03116132691502571, -0.004723779857158661, -0.01163455843925476, -0.012918231077492237, -0.015757253393530846, -0.07123365253210068, -0.014915055595338345, 0.031623177230358124, -0.009400016628205776, -0.023146862164139748, -0.051374077796936035, -0.029775775969028473, 0.0020121061243116856, -0.013352913782000542, 0.017319394275546074, -0.0006142441998235881, -0.015241067856550217, 0.0012132066767662764, -0.006961717735975981, -0.0016292117070406675, 0.028987912461161613, -0.03860526904463768, -0.001099442015402019, -0.014534708112478256, -0.016911879181861877, 0.02727634832262993, -0.015105228871107101, -0.016083264723420143, 0.0012539580930024385, 0.03360641747713089, -0.03765440359711647, -0.02947693131864071, -0.016436444595456123, 0.0006808899343013763, 0.00441135186702013, 0.04898332431912422, 0.03357924893498421, -0.00517883850261569, -0.01657228358089924, 0.02115003764629364, -0.01548557635396719, 0.011308546178042889, -0.022861601784825325, 0.006588161922991276, 0.014874303713440895, -0.010934990830719471, -0.019112462177872658, -0.019166797399520874, -0.019615063443779945, 0.002404339611530304, -0.04482666775584221, -0.027697447687387466, -0.007905794307589531, -0.013284994289278984, -0.054715704172849655, 0.011661726050078869, -0.012225455604493618, 0.008523859083652496, 0.0061432914808392525, 0.03588850423693657, 0.018474021926522255, -0.0010408617090433836, -0.0048562223091721535, 0.047244593501091, 0.014154360629618168, 0.028308721259236336, -0.020239919424057007, 0.0048528267070651054, 0.024287903681397438, -0.023812469094991684, -0.026556406170129776, 0.04276192560791969, 0.0650937557220459, 0.035752665251493454, 0.016789624467492104, 0.039637643843889236, 0.01571650244295597, -0.015268235467374325, -0.021394547075033188, 0.01219828799366951, -0.015757253393530846, -0.0028322304133325815, -0.010812736116349697, -0.010663313791155815, -0.0019221132388338447, -0.001866079866886139, -0.009080796502530575, 0.006666269153356552, 0.0396919772028923, 0.019329803064465523, 0.00572558818385005, 0.019329803064465523, -0.025401778519153595, 0.012728056870400906, -0.035915669053792953, 0.0007772502722218633, -0.0022464273497462273, 0.015404073521494865, -0.01202169805765152, -0.00951547920703888, 0.0013558369828388095, 0.04088735580444336, 0.07367874681949615, -0.0031531485728919506, 0.006435343995690346, 0.00895174965262413, -0.022589923813939095, -0.010561434552073479, 0.028906410560011864, 0.005426743533462286, 0.00030839559622108936, -0.03159600868821144, -0.04501684382557869, -0.019275467842817307, -0.007742788176983595, 0.0009788854513317347, 0.009841491468250751, -0.026977503672242165, -0.0033993558026850224, 0.007029636763036251, 0.015281818807125092, -0.0008778555784374475, -0.003939313348382711, 0.02527952380478382, -0.025333860889077187, -0.11149615049362183, -0.02105495147407055, 0.021380962803959846, 0.004075151868164539, 0.047434765845537186, -0.025863628834486008, 0.012517508119344711, -0.022766513749957085, 0.0007140005473047495, -0.008897414430975914, -0.012565051205456257, -0.026135306805372238, 0.03322606906294823, 0.022005818784236908, 0.04824979603290558, -0.04996136203408241, 0.0236222967505455, -0.024858426302671432, -0.004268721677362919, 0.004798491019755602, -0.0016113829333335161, 0.006160270888358355, 0.01746881753206253, 0.06677815318107605, -0.03588850423693657, -0.008517066948115826, 0.0201720017939806, -0.0008260672329925001, 0.00798050593584776, 0.026800913736224174, -0.03398676589131355, -0.019166797399520874, 0.018990207463502884, 0.0339052639901638, -0.006102539598941803, 0.00421098992228508, -0.011790771968662739, -0.021027782931923866, -0.0045030429027974606, 0.0010799152078107, 0.027059007436037064, -0.03317173570394516, 0.06514809280633926, -0.012429213151335716, 0.009046836756169796, -0.017740493640303612, 0.022005818784236908, -0.008231806568801403, 0.008313309401273727, -0.04235440865159035, 0.024247152730822563, 0.0021649242844432592, 0.007579782046377659, -0.0201720017939806, -0.013468376360833645, 0.01772690936923027, 0.029341092333197594, -0.00798050593584776, -0.017944252118468285, 0.00982790719717741, -0.01632777415215969, 0.039284463971853256, 0.05982322618365288, -0.021014198660850525, -0.050151534378528595, -0.01788991689682007, -0.01606968231499195, 0.0022243536077439785, -0.006476095411926508, -0.022603508085012436, -0.011240626685321331, -0.012918231077492237, -0.0006074522971175611, 0.027004672214388847, 0.004424935672432184, -0.02545611374080181, 0.010303341783583164, 0.025252357125282288, -0.03341624513268471, -0.006618725601583719, 0.05229778215289116, -0.049363672733306885, 0.02912375144660473, 0.01632777415215969, -0.013352913782000542, 0.027398603036999702, -0.02291593700647354, -0.0060719759203493595, -0.0249942634254694, 0.04526135325431824, 0.04537002369761467, -0.002623378997668624, 0.005728984251618385, -0.05748680606484413, -0.005206006579101086, -0.031106991693377495, -0.01621910370886326, 0.004455499351024628, 0.021869981661438942, 0.02229107916355133, 0.009223426692187786, 0.04121336713433266, -0.03344341367483139, -0.008394812233746052, 0.0049309334717690945, 0.03569832816720009, 0.010350885801017284, 0.03990931808948517, 0.019424889236688614, -0.028037043288350105, -0.001673359191045165, -0.040045157074928284, -0.05178159475326538, -0.014874303713440895, -0.00484943063929677, 0.009814323857426643, 0.05933421105146408, 0.017591072246432304, 0.024600332602858543, -0.004323056899011135, 0.025320276618003845, 0.035154975950717926, -0.015241067856550217, 0.01631418988108635, -0.022073738276958466, -0.047597773373126984, -0.0032923829276114702, -0.0218563973903656, -0.013006526045501232, -0.0020800253842025995, 0.02561912126839161, -0.011899443343281746, 0.03518214449286461, 0.005253549665212631, -0.014765633270144463, 0.032166529446840286, 0.023038191720843315, 0.00388158205896616, -0.024776922538876534, 0.027181262150406837, 0.0018185364315286279, -0.017862748354673386, 0.02616247348487377, 0.05555790290236473, 0.023459291085600853, -0.00660174572840333, 0.019778069108724594, -0.02642056718468666, -0.01430378295481205, -0.0078107076697051525, 0.030427800491452217, -0.00281694857403636, -0.016640203073620796, 0.019465642049908638, -0.0056950245052576065, 0.0007963525713421404, -0.003042779862880707, -0.008877038955688477, -0.012232246808707714, 0.01668095402419567, 0.022399751469492912, 0.011301754042506218, 0.008680073544383049, -0.001311689498834312, 0.007151891477406025, 0.008007673546671867, -0.02316044643521309, -0.008829495869576931, -0.002363587962463498, 0.020728938281536102, -0.006849650759249926, -0.02043009363114834, 0.008809119462966919, 0.034720294177532196, 0.015594247728586197, 0.016463613137602806, -0.009393224492669106, 0.02536102756857872, -0.0056067295372486115, -0.005484474822878838, 0.02079685777425766, 0.0119741540402174, -0.0438757985830307, 0.00643194792792201, 0.041376374661922455, -0.02518443763256073, -0.012388461269438267, 0.002227749675512314, 0.0037966829258948565, 0.03569832816720009, -0.020022578537464142, 0.02151680178940296, -0.0037593275774270296, 0.03200352564454079, 0.023540792986750603, 0.0228208489716053, -0.0435497872531414, 0.00642515579238534, -0.0044147479347884655, -0.04230007529258728, -0.027398603036999702, -0.012422421015799046, 0.006628913339227438, -0.007097555790096521, -0.02115003764629364, 0.017604654654860497, -0.039012786000967026, 0.002406037412583828, 0.019465642049908638, 0.006842859089374542, -0.00706359650939703, 0.0068971943110227585, -0.014195111580193043, 0.02754802629351616, -0.008877038955688477, -0.024179233238101006, 0.043658457696437836, -0.003969877026975155, -0.04890182241797447, -0.005402971990406513, -0.025143686681985855, -0.0400179885327816, -0.009569814428687096, -0.004081943538039923, -0.0010128449648618698, -0.008707241155207157, 0.04379429668188095, -0.01251071598380804, -0.000457605579867959, 0.004278909415006638, -0.004105715546756983, 0.023323452100157738, -0.041186198592185974, 0.013448000885546207, -0.01788991689682007, -0.002412829315289855, -0.011906234547495842, -0.02677374705672264, 0.006842859089374542, -0.002288876799866557, -0.006618725601583719, 0.007790331728756428, 0.005433535668998957, -0.020131248980760574, 0.01999541185796261, -0.01746881753206253, 0.021965067833662033, 0.019710151478648186, -0.024287903681397438, -0.027167677879333496, -0.025116518139839172, 0.021041367202997208, 0.05004286393523216, -0.013509128242731094, -0.004635484889149666, -0.009400016628205776, -0.025917965918779373, 0.06340935826301575, 0.056400101631879807, 0.03178618475794792, -0.021978652104735374, 0.018650611862540245, -0.024872008711099625, -0.023921141400933266, 0.005562582053244114, -0.03045496717095375, 0.023486457765102386, 0.004829054698348045, -0.0382520891726017, 0.008218222297728062, -0.02105495147407055, -0.011729645542800426, 0.00535542843863368, 0.03428560867905617, 0.006438739597797394, -0.0003981762856710702, 0.014915055595338345, -0.02420640178024769, -0.00412609102204442, 0.03485612943768501, -0.021190788596868515, -0.044446323066949844, -0.01888153702020645, -0.040670014917850494, 0.028634732589125633, 0.0011834920151159167, 0.023812469094991684, -0.00623158598318696, 0.017930667847394943, 0.018732113763689995, 0.042082734405994415, 0.02666507661342621, -0.030482135713100433, -0.010249006561934948, 0.004835846833884716, -0.01931621879339218, 0.015988178551197052, 0.02931392565369606, 0.010717649012804031, -0.00829972606152296, 0.010907823219895363, 0.031704679131507874, 0.008761576376855373, 0.030400631949305534, 0.020416509360074997, 0.007050012703984976, 0.0007458376931026578, -0.0069107781164348125, -0.014629794284701347, -0.008014464750885963, -0.00484943063929677, -0.0057561518624424934, -0.0029561829287558794, 0.030943986028432846, 0.021000614389777184, 0.012762016616761684, -0.039719145745038986, -0.02369021624326706, 0.009094379842281342, -0.00412609102204442, -0.006611933931708336, -0.028471726924180984, 0.013937018811702728, 0.020661018788814545, -0.013672133907675743, -0.007267354056239128, -0.004183822311460972, -0.01931621879339218, 0.0011240626918151975, 0.03238387405872345, -0.0019594687037169933, 0.024165648967027664, -0.0010153920156881213, -0.032248035073280334, 0.013407249003648758, 0.0025741374120116234, -0.0007848911918699741, 0.005936137866228819, -0.03322606906294823, -0.01162776630371809, 0.016517948359251022, -0.005127899348735809, -0.006051600445061922, -0.013794388622045517, 0.007953337393701077, -0.0038781859911978245, -0.017971418797969818, 0.010194671340286732, 0.019166797399520874, -0.015281818807125092, 0.07107064872980118, 0.00651684682816267, -0.005786715541034937, -0.016898296773433685, 0.00191362330224365, -0.010153919458389282, -0.020144833251833916, -0.004835846833884716, -0.031704679131507874, -0.0011334015289321542, -0.017414482310414314, 0.052868302911520004, -0.026732996106147766, 0.01320349145680666, 0.043821465224027634, 0.009671693667769432, -0.03447578474879265, 0.01825667917728424, 0.008381228893995285, 0.010507099330425262, 0.023377787321805954, 0.026556406170129776, -0.013536295853555202, 0.002015502192080021, -0.02272576279938221, -0.008551026694476604, -0.026352647691965103, 0.021571137011051178, -0.007688452955335379, 0.006238378118723631, 0.01939772255718708, -0.013257826678454876, -0.033307574689388275, -0.0031548466067761183, 0.014004938304424286, 0.0016478894976899028, -0.03325323760509491, 0.001092650112695992, -0.004795095417648554, 0.015621415339410305, 0.01395060308277607, -0.007878626696765423, 0.005256945732980967, 0.0011656632414087653, 0.0003457511484157294, 0.01825667917728424, 0.00169458391610533, 0.01386909931898117, 0.0011605692561715841, 0.0074235680513083935, 0.012408836744725704, -0.018555523827672005, 0.0006724000559188426, -0.004394371993839741, 0.01513239648193121, 0.002664130413904786, -0.03393242880702019, 0.013529503718018532, 0.03243820741772652, -0.0038374345749616623, -0.027615945786237717, 0.03178618475794792, -0.014249446801841259, 0.040588513016700745, 0.0256327036768198, -0.042435914278030396, 0.0068360669538378716, 0.039447467774152756, -0.001134250545874238, 0.05398217588663101, -0.003667636541649699, 0.015920259058475494, 0.006540618371218443, 0.00351142231374979, 0.003007122315466404, 0.017414482310414314, -0.0027031840290874243, 0.04939083755016327, -0.01817517727613449, 0.03876827657222748, -0.024939928203821182, 0.005121107213199139, 0.011471551842987537, 0.0024977284483611584, 0.03800758346915245, 0.042789094150066376, -0.001570631400682032, -0.010507099330425262, -0.015431241132318974, 0.02483125776052475, -0.01632777415215969, 0.03037346340715885, 0.04297926649451256, 0.011152331717312336, -0.0016776041593402624, -0.025483282282948494, 0.01534973829984665, -0.03404109925031662, 0.012958982959389687, 0.03317173570394516, -0.006075371988117695, -0.03254687786102295, 0.04124053567647934, 0.02939542755484581, -0.021014198660850525, 0.018215928226709366, -0.04819546267390251, -0.032601214945316315, 0.02306535840034485, 0.027711031958460808, 0.00846273172646761, -0.01613760180771351, 0.015743669122457504, 0.020593099296092987, 0.01483355276286602, 0.012177911587059498, -0.047271762043237686, 0.018378933891654015, -0.00021118625591043383, -0.043821465224027634, 0.011247418820858002, -0.02447807788848877, 0.014928638935089111, 0.014412453398108482, 0.039284463971853256, -0.0028644921258091927, -0.03474745899438858, -0.017876332625746727, 0.00846952386200428, 0.03694804385304451, -0.024505246430635452, 0.020769689232110977, 0.012979358434677124, 0.0027031840290874243, 0.01894945651292801, 0.0042551374062895775, -0.0086393216624856, 0.015730084851384163, -0.02465466782450676, 0.005036208312958479, 0.012483548372983932, -0.0091622993350029, 0.014004938304424286, 0.01755031943321228, -0.01501014269888401, -0.012272998690605164, -0.013991354033350945, -0.011227043345570564, 0.01123383454978466, 0.0217748936265707, -0.014697713777422905, -0.004204198252409697, -0.003258423414081335, 0.03635035455226898, 0.006676456891000271, 0.012381669133901596, 0.004109111148864031, -0.014235863462090492, 0.017441648989915848, -0.0010765192564576864, 0.02993878163397312, -0.03482896462082863, 0.010384844616055489, 0.02148963324725628, 0.01843326911330223, -0.0005599088617600501, 0.0011512304190546274, -0.02098703198134899, -0.004988664761185646, -0.013977770693600178, -0.02465466782450676, 0.018202343955636024, 0.02307894267141819, -0.0229838564991951, -0.02481767348945141, -0.03135149925947189, 0.005039604380726814, -0.0006244321120902896, -0.02227749675512314, 0.014697713777422905, -0.020769689232110977, -0.016015347093343735, 0.027588777244091034, 0.015173148363828659, -0.013475168496370316, -0.008211431093513966, 0.019261883571743965, 0.02105495147407055, -0.002098703058436513, -0.008612154051661491, 0.009630941785871983, -0.0004331971285864711, 0.015091645531356335, -0.015471993014216423, 0.009977329522371292, -0.009332097135484219, 0.0014738464960828424, -0.005199214443564415, -0.02195148356258869, 0.04474516585469246, -0.022318247705698013, -0.002392453607171774, 0.018297431990504265, 0.004085339605808258, -0.019085293635725975, -0.009053628891706467, 0.0003463879111222923, -0.014072857797145844, 0.007260561920702457, 0.016300607472658157, -0.001230186433531344, -0.006615329533815384, 0.0073488568887114525, 0.025333860889077187, 0.007464319467544556, 0.031731847673654556, 0.028797738254070282, 0.00563389714807272, -0.0153089864179492, -0.02360871247947216, -0.022875184193253517, 0.0010493515292182565, 0.00882270373404026, 0.02420640178024769, -0.029422596096992493, 0.006700228434056044, 0.01123383454978466, -0.012130368500947952, 0.008632529526948929, 0.0025520636700093746, 0.02115003764629364, -0.023839637637138367, -0.022413333877921104, -0.02809137850999832, -0.011227043345570564, 0.008062008768320084, 0.016545116901397705, -0.011179499328136444, -0.007009260822087526, -0.0036065091844648123, -0.023635881021618843, -0.0034740669652819633, -0.0011987738544121385, 0.013318954035639763, -0.014711298048496246, 0.06357236951589584, 0.017849164083600044, 0.021625472232699394, -0.03982781618833542, 0.008021256886422634, -0.0002343212254345417, 0.015404073521494865, 0.004608317278325558, -0.012211871333420277, 0.03708387911319733, -0.0032686113845556974, 0.013590631075203419, -0.016287023201584816, 0.01477921660989523, 0.028987912461161613, -0.032166529446840286, -0.015268235467374325, 0.03529081493616104, 0.0036166971549391747, 0.015186731703579426, 0.02369021624326706, -0.02309252694249153, -0.0035012345761060715, -0.043576955795288086, -0.03270988538861275, -0.011322129517793655, -0.003504630411043763, 0.0064455317333340645, 0.004798491019755602, -0.010901031084358692, 0.038224924355745316, 0.02079685777425766, 0.016382109373807907, 0.003477462800219655, -0.01642286218702793, 0.048467136919498444, -0.035154975950717926, -0.01460262667387724, -0.0020409717690199614, 0.004808679223060608, -0.010160711593925953, -0.023187613114714622, 0.013658550567924976, 0.014575459063053131, 0.016341358423233032, -0.02500784769654274, 0.006982093211263418, 0.027765367180109024, -0.031215662136673927, -0.03876827657222748, -0.010500307194888592, 0.018623443320393562, -0.025659872218966484, -0.004937725607305765, 0.01162097416818142, 0.0017404294339939952, -0.03306306526064873, -0.006126311607658863, -0.0004440217453520745, 0.049091994762420654, 0.053221482783555984, -0.02519802190363407, 0.02701825648546219, -0.018202343955636024, -0.017441648989915848, 0.02256275713443756, -0.013848723843693733, -0.011614182032644749, -0.009264178574085236, -0.025157270953059196, 0.02370379865169525, -0.012103200890123844, 0.010099584236741066, -0.017577487975358963, 0.016721706837415695, -0.030509302392601967, 0.009257386438548565, 0.015023726038634777, 0.020824026316404343, 0.00035763700725510716, -0.025917965918779373, -0.004475874826312065, -0.009569814428687096, -0.01589309237897396, 0.009916202165186405, 0.0037015960551798344, 0.005192422308027744, 0.013121988624334335, -0.006306297145783901, -0.01286389585584402, -0.0002856851206161082, 0.012422421015799046, 0.015512743964791298, 0.028444558382034302, -0.034367114305496216, -0.005976889282464981, 0.0014441319508478045, -0.0361601784825325, -0.012524299323558807, -0.031460169702768326, 0.0031446588691323996, 0.005501454696059227, 0.011036869138479233, 0.024179233238101006, 0.0021615284495055676, 0.03368791937828064, 0.014100025407969952, -0.020579516887664795, -0.002830532379448414, 0.031894855201244354, 0.016735289245843887, 0.016735289245843887, -0.008978917263448238, -0.023730967193841934, 0.004044588189572096, -0.044011637568473816, -0.004003836773335934, 0.00825218204408884, 0.02798270806670189, 0.00046694447519257665, -0.0021717161871492863, -0.00807559210807085, -0.026542821899056435, -0.0024501848965883255, -0.04572320356965065, 0.007634117733687162, 0.03319890424609184, 0.024518828839063644, -0.0020205960609018803, -0.04045267403125763, -0.035426653921604156, -0.0398549847304821, -0.009664901532232761, 0.02123154141008854, -0.0015528026269748807, 0.022141657769680023, -0.018664194270968437, -0.010839903727173805, -0.027059007436037064, 0.01886795274913311, 0.003925729542970657, -0.00561691727489233, 0.014276615343987942, -0.01983240433037281]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"
et al. (2023); Deng & Raffel (2023) similarly propose to
enforce the T−tstep optimality condition using a squared-
error loss,P
tEp0(st+1:T|s1:t)[(ϕ(s1:T)−ψt(s1:t))2].
5. Evaluating Inference in Language Models
OurSMC framework yields a rich set of tools for evaluating
inference techniques in language models, using well-studied
quantities such as the log partition function logZσandKL
divergence to the target distribution. Remarkably, with ac-
cess to a single exact sample from the target distribution, we
show in Prop. 5.1 that we can obtain upper bounds on logZσ
in addition to lower bounds. These bounds can tightly sand-
wich logZσwith increasing K, thereby ensuring reliable
conclusions regarding inference quality.
5.1. Applications of logZσEstimation
Evaluating Fine-Tuned Models To motivate this section
and present an important application of our SMC methods,
consider evaluating how well a given q(s1:T)matches a
target distribution for controlled generation or fine-tuning.
Assume that qis tractable to sample and evaluate. To cal-
culate the KL divergence to σin either direction, we also
require an estimate of the logpartition function logZσ,
DKL(q(s1:T)∥σ(s1:T)) =Eq
logq(s1:T)
p0(s1:T)ϕ(s1:T)
+ logZσ
DKL(σ(s1:T)∥q(s1:T)) =Eσ
logp0(s1:T)ϕ(s1:T)
q(s1:T)
−logZσ
(23)
7
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
ForDKL(σ∥q), note that we also require samples from the
target σ, as may be readily available using the BDMC trick
when σis defined as a Bayesian posterior (Sec. 3.3). In such
cases, we argue that SMC can be used to accurately bound
the value of logZσand estimate each KL divergence above.
Estimation of DKL(σ∥q)may be particularly important to
diagnose mode-dropping in inference techniques such as
PPO which optimize the mode-seeking DKL(q∥σ)during
fine-tuning (Korbak et al., 2022b).
Evaluating Twisted SMC Sampling After running SIS
orSMC withKsamples, we can sample a single index
as in Eq. (5) to return a single approximate target sample
sσ
1:T. However, the marginal distribution of this sample,
which we denote as sσ
1:T∼qSMC(s1:T), is not tractable due
to the need to sum over all possible sets of Ksamples.
Nevertheless, we will show below that the tightness of our
logZσlower or upper bounds in Prop. 5.1 provides upper
bounds on the KL divergences DKL(qSMC(s1:T)∥σ(s1:T))
orDKL(σ(s1:T)∥qSMC(s1:T)), respectively.
Alternatively, we can also use the single-sample KL di-
vergences in Eq. (23) for the twist-induced proposal qπin
Eq. (15) to evaluate a set of twist functions ψt(Sec. 7.2).
5.2. Bidirectional SMC Bounds on logZσ
Given the importance of logZσestimation as motivated
above, we propose a bidirectional SMC stochastic upper
bound which is novel (to the best of our knowledge), and
may be of interest outside of the language modeling setting.
Recall from Sec. 2.2 that SMC admits an interpretation as
SISin an extended state space S:={sk
t, ωk
t}K,T
k=1,t=1which
includes all tokens and resampling indices. We derive lower
and upper bounds on logZσin Prop. 5.1 below, with proof
and detailed description of the extended state space target
σSMC(S)and proposal qSMC(S)distributions in App. F.
Proposition 5.1. (Bidirectional SMC Bounds) The log
partition function logZσof a target distribution σ(s1:T)
can be lower and upper bounded by
EqSMC(S)""
logTY
t=11
KKX
i=1wt 
si
1:t#
≤logZ","[0.030142897740006447, 0.006110639311373234, 0.022337816655635834, 0.017138605937361717, -0.021097522228956223, 0.04605373740196228, 0.017013322561979294, 0.007648478727787733, -0.045652836561203, 0.0314708910882473, 0.04652981087565422, -0.01592336781322956, -0.02221253514289856, 0.03570542857050896, 0.02873973734676838, -0.02095971256494522, 0.007535724435001612, -0.0011017003562301397, -0.004272123333066702, 0.015860727056860924, -0.009082959964871407, -0.007980476133525372, -0.012634710408747196, 0.027837704867124557, 0.006088715046644211, -0.014144361019134521, 0.02260090969502926, -0.013279913924634457, 0.03465305641293526, -0.01110626757144928, 0.05367089435458183, -0.01900530979037285, -0.03452777490019798, -0.05627676472067833, -0.024592896923422813, 0.08083207905292511, 0.00289088673889637, 0.029341092333197594, -0.006809087935835123, 0.003711485303938389, -0.013079461641609669, -0.015046392567455769, -0.03813590109348297, 0.030493687838315964, 0.010235556401312351, 0.03367585688829422, 0.009508918970823288, -0.01785271428525448, -0.00277656689286232, 0.021999554708600044, -0.02533206157386303, 0.01424458622932434, -0.009465070441365242, -0.027887817472219467, 0.008356322534382343, -0.0008417398203164339, 0.008857451379299164, 0.006386260502040386, 0.021673820912837982, -0.01670011691749096, 0.02297675609588623, -0.040265701711177826, -0.002372531685978174, 0.01141320914030075, -0.02911558374762535, -0.032397978007793427, -0.0037835226394236088, 0.031120099127292633, -0.029817163944244385, 0.03129549324512482, -0.021711405366659164, 0.018829915672540665, 0.016850456595420837, -0.004926722496747971, -0.033024389296770096, -0.009020318277180195, -0.0020765524823218584, 0.05033838748931885, 0.033224839717149734, -0.046128906309604645, -0.012415465898811817, -0.00259647355414927, 0.02201208285987377, -0.014833413064479828, -0.04369843378663063, -0.01091208029538393, -0.03382619470357895, 0.016236573457717896, -0.03886253759264946, -0.02087201550602913, -0.013492893427610397, 0.026584884151816368, -0.003999634180217981, -0.02541975863277912, 0.08784788101911545, -0.003417072119191289, 0.022951699793338776, -0.025645267218351364, 0.014194473624229431, -0.0028407739009708166, 0.023402715101838112, -0.02551998384296894, 0.0006792644271627069, -0.04412439092993736, 0.05818105489015579, 0.011093739420175552, -0.007134821265935898, 0.016048649325966835, -0.030869534239172935, -0.03132054954767227, 0.004704346880316734, -0.017201246693730354, -0.05156615376472473, 0.042195044457912445, 0.024254634976387024, -0.04101739451289177, -0.03861197456717491, 0.019757002592086792, -0.026158923283219337, 0.033325064927339554, 0.0008730603731237352, 0.0140316067263484, 0.017915355041623116, 0.03447766229510307, 0.018842443823814392, -0.0175645649433136, 0.02258838154375553, -0.0802307203412056, -0.01943126879632473, 0.03084447793662548, -0.019456326961517334, 0.022625965997576714, -0.004240802489221096, -0.012346561066806316, -0.0007141085807234049, 0.00997872743755579, 0.005261852405965328, 0.012841425836086273, -0.0004674592346418649, 0.00328552583232522, -0.025344589725136757, -0.013680816628038883, -0.01041095145046711, -0.018366370350122452, -0.04414944723248482, -0.0372338704764843, -0.050162993371486664, -0.0017931015463545918, -0.027562085539102554, 0.027737479656934738, -0.004065407440066338, -0.03901287913322449, -0.024718178436160088, 0.008118286728858948, -0.002721755765378475, -0.05126547813415527, -0.03342529013752937, 0.04552755132317543, 0.04978714883327484, -0.032798882573843, -0.007642214186489582, 0.07211243361234665, 0.0050488729029893875, 0.0015957821160554886, -0.011344303376972675, 0.006395656615495682, -0.0236031673848629, 0.04101739451289177, -0.036908138543367386, -0.04211987555027008, 0.0007289858185686171, -0.03482845425605774, -0.028414003551006317, -0.0603359080851078, 0.027762535959482193, -0.03573048487305641, 0.00657105166465044, -0.06649979203939438, 0.0003437430423218757, 0.013918852433562279, -0.02316468022763729, 0.04637947306036949, -0.009270883165299892, 0.0009576258598826826, -0.005371474660933018, 0.0364571213722229, -0.021172692999243736, 0.026209037750959396, 0.041468407958745956, -0.003727145493030548, -0.026660053059458733, 0.06208986043930054, 0.06289166957139969, -0.020157907158136368, -0.019393684342503548, -0.01549740880727768, 0.053269993513822556, 0.07221265882253647, 0.00835005845874548, -0.009164392948150635, 0.043046966195106506, -0.01033578161150217, -0.03635689616203308, -0.05943387746810913, -0.015773029997944832, 0.03891265392303467, -0.01809075102210045, 0.030869534239172935, -0.06063658744096756, 0.020759260281920433, -0.0009388335165567696, 0.003476581070572138, 0.0603359080851078, 0.0010641156695783138, -0.026609940454363823, 0.03971445932984352, -0.08318738639354706, 0.0013225103029981256, -0.022776303812861443, 0.04557766392827034, 0.005290041211992502, 0.017727430909872055, 0.0508645735681057, 0.008550510741770267, -0.026985786855220795, 0.023440299555659294, 0.0019825908821076155, -0.02758714184165001, 0.02653476968407631, -0.02541975863277912, 0.04409933462738991, 0.028915133327245712, 1.6345413314411417e-05, -0.03851174935698509, -0.008381379768252373, -0.0015840368578210473, -0.022087251767516136, -0.01175147108733654, -0.013492893427610397, -0.07055893540382385, -0.0059822252951562405, 0.014545263722538948, 0.023728448897600174, -0.0005391049780882895, 0.015058920718729496, 0.020608922466635704, -0.0032072244212031364, -0.012966708280146122, -0.0034797131083905697, 0.013342554681003094, -0.0027452462818473577, -0.021999554708600044, -0.029566599056124687, 0.005208607763051987, -0.0432724729180336, 0.014394924975931644, -0.004494498949497938, 0.02207472361624241, -0.004525819793343544, 0.010110273957252502, -0.020208019763231277, -0.04101739451289177, -0.054572928696870804, -0.009064167737960815, -0.03159617260098457, -0.03397653251886368, -0.013492893427610397, -0.011482113972306252, 0.06429482996463776, -0.0472063347697258, 0.005452908109873533, -0.0005837367498315871, 0.005650227423757315, 0.025983529165387154, -0.00482023274526, -0.0592835396528244, 0.005759849213063717, 0.025056440383195877, -0.03382619470357895, 0.012052147649228573, -0.0075670452788472176, -0.039313554763793945, 0.034377437084913254, -0.0033544308971613646, 0.009715634398162365, -0.01721377484500408, 0.010492384433746338, 0.018115807324647903, -0.008312474004924297, -0.05131559073925018, 0.03718375787138939, 0.026710165664553642, 0.007084708660840988, -0.01424458622932434, 0.005709736607968807, -0.00947759859263897, -0.00040090305265039206, -0.028464116156101227, -0.017777545377612114, 0.028714681044220924, 0.0503634437918663, 0.02326490543782711, 0.01012280210852623, -0.019944926723837852, 0.017777545377612114, 0.016286686062812805, 0.020020095631480217, 0.04657992348074913, -0.024918630719184875, 0.02063397876918316, -0.004669893998652697, -0.03923838585615158, -0.045402269810438156, 0.027737479656934738, 0.008262361399829388, -0.017952939495444298, 0.038261186331510544, -0.03866208717226982, 0.01722630299627781, -0.03397653251886368, -0.022989284247159958, 0.026133866980671883, -0.016900569200515747, -0.04359820485115051, -0.006483354140073061, -0.012615918181836605, -0.02706095576286316, -0.010874494910240173, -0.02421705052256584, -0.0030036407988518476, 0.03893771022558212, 0.040040191262960434, 0.030393462628126144, 0.010580082423985004, -0.011789055541157722, -0.05301942676305771, -0.027812648564577103, 0.08729664236307144, -0.022801360115408897, 0.05702845752239227, -0.07421717792749405, 0.016136348247528076, -0.021836688742041588, -0.038687143474817276, 0.02811332605779171, -0.009490126743912697, 0.017188718542456627, 0.03628172725439072, 0.09767000377178192, 0.009753219783306122, 0.026259150356054306, -0.006044866517186165, 0.05637698993086815, -0.01976953074336052, 0.02901535853743553, 0.01340519543737173, -0.012058411724865437, -0.03299933299422264, -0.027787592262029648, -0.020759260281920433, -0.030142897740006447, -0.01381862722337246, 0.049436356872320175, 0.0030052068177610636, 0.013994022272527218, 0.02926592342555523, -0.03625667095184326, 0.00639252457767725, -0.010423479601740837, 0.006915577687323093, 0.013793570920825005, -0.006013545673340559, 0.014094247482717037, 0.016474610194563866, -0.01904289424419403, 0.0037584661040455103, -0.0061889407224953175, 0.029992559924721718, 0.036532290279865265, 0.026584884151816368, 0.0216362364590168, 0.012102261185646057, -0.012916594743728638, -0.022713663056492805, -0.0008848055731505156, -0.00805564597249031, -0.0014704999048262835, -0.016712645068764687, -0.036381952464580536, 0.03613138571381569, -0.016875512897968292, 0.01019170694053173, -0.040416039526462555, 0.0208594873547554, -0.01158860418945551, -0.002264475915580988, -0.01374345738440752, 0.04317224770784378, 0.03858691826462746, 0.06980724632740021, -0.047807689756155014, -0.007090972736477852, -0.04735667258501053, -0.01582314260303974, -0.04472574591636658, 0.032748766243457794, 0.024442557245492935, 0.04865960776805878, -0.005330757703632116, 0.05838150531053543, 0.04688059911131859, -0.06474584341049194, 0.03445260599255562, -0.010937136597931385, 0.03289910778403282, -0.04254583641886711, 0.02355305477976799, 0.026634996756911278, 0.06048624590039253, 0.05963432788848877, -0.030819421634078026, -0.046128906309604645, 0.02763725444674492, -0.013831155374646187, 0.016662532463669777, -0.01151343435049057, 0.021648764610290527, -0.025645267218351364, 0.05502394214272499, -0.05201717093586922, -0.016562307253479958, 0.028714681044220924, 0.032974276691675186, -0.022187478840351105, -0.029566599056124687, -0.008268625475466251, 0.04184425622224808, -0.03046863153576851, -0.006646221037954092, -0.045402269810438156, -0.020746732130646706, -0.009778276085853577, -0.010147858411073685, -0.01616140455007553, 0.030117841437458992, 0.019406212493777275, -0.011626188643276691, -0.03813590109348297, 0.03748443350195885, -0.02551998384296894, 0.009371108375489712, -0.009728163480758667, 0.05537473410367966, -0.01353047788143158, -0.03425215557217598, -0.04186931252479553, 0.06935622543096542, -0.03996502235531807, 0.010160386562347412, -0.045928455889225006, 0.02475576288998127, 0.015409710817039013, 0.0012387278256937861, 0.01923081837594509, 0.010285669006407261, 0.043773602694272995, -0.005064533092081547, 0.00494238268584013, -0.014044134877622128, 0.026083754375576973, 0.0041374447755515575, -0.05933365225791931, 0.0177023746073246, -0.015760501846671104, -0.030593914911150932, 0.015509936958551407, 0.07637202739715576, -0.07231288403272629, 0.0036206557415425777, -0.013705872930586338, 0.019995039328932762, -0.02345282770693302, 0.013680816628038883, 0.043297529220581055, 0.036156442016363144, 0.025407230481505394, 0.04124290123581886, -4.6197812480386347e-05, 0.03132054954767227, 0.0026888693682849407, -0.004027822986245155, -0.06634945422410965, 0.056928232312202454, -0.013054405339062214, 0.04064154624938965, -0.021911857649683952, 0.015058920718729496, -0.00657105166465044, -0.006013545673340559, -0.0008699282770976424, 0.035429805517196655, -0.0031884319614619017, 0.007967947982251644, 0.04620407521724701, 0.004021558910608292, 0.025570098310709, 0.01938115619122982, -0.01607370749115944, -0.0014141228748485446, 0.01885497197508812, -0.012233806774020195, -0.0070158033631742, -0.0077737607061862946, -0.0037584661040455103, 0.009220770560204983, 0.003157111583277583, -0.017138605937361717, -0.02873973734676838, 0.0017492527840659022, 0.020796846598386765, 0.00687172869220376, -0.02801310084760189, -0.018554294481873512, -0.02421705052256584, 0.02178657427430153, -0.014733186922967434, 0.0030255652964115143, -0.10012553632259369, -0.034227099269628525, -0.04229527339339256, 0.02331501804292202, -0.018604407086968422, 0.004804572556167841, 0.01612382009625435, -0.0014908582670614123, -6.12218864262104e-05, -0.030593914911150932, -0.0025698512326925993, -0.010398423299193382, 0.009289675392210484, -0.009014054201543331, -0.012252599000930786, -0.011312982998788357, 0.007673535030335188, 0.0010116538032889366, -0.03858691826462746, 0.0065647875890135765, -0.01621151715517044, 0.002594907535240054, 0.004961175378412008, -0.006715125869959593, -0.011262870393693447, -0.003526693908497691, -0.02432980388402939, -0.006113771349191666, 0.007034595590084791, 0.011594868265092373, 0.030092785134911537, -0.006439505144953728, -0.0031524135265499353, 0.03172145411372185, -0.01846659742295742, -0.009302203543484211, -0.006633692421019077, -0.01861693523824215, -0.007861458696424961, 0.033700913190841675, -0.009014054201543331, 0.015572577714920044, 0.05427224934101105, -0.03851174935698509, 0.006896785460412502, 0.02053375355899334, -0.033174727112054825, 0.014808356761932373, -0.034227099269628525, 0.025344589725136757, -0.04054132103919983, -0.013430251739919186, -0.013179687783122063, -0.030543800443410873, -0.008262361399829388, 0.0259584728628397, -0.04131807014346123, -0.039313554763793945, 0.01880485936999321, 0.010022575967013836, 0.01220875047147274, -0.019594136625528336, -0.015760501846671104, 0.034277211874723434, -0.025068968534469604, -0.0066587491892278194, 0.003711485303938389, -0.05427224934101105, 0.010774269700050354, -0.0007062784279696643, -0.0024226445239037275, -0.035855766385793686, 0.0035955992061644793, 0.037258926779031754, 0.018203504383563995, -0.014094247482717037, -0.03340023383498192, -0.03853680565953255, 0.045978568494319916, -0.03956412151455879, 0.013994022272527218, 0.03184673562645912, 0.002281702123582363, 0.021648764610290527, 0.019067950546741486, -0.001954402308911085, -0.025732964277267456, -0.016224045306444168, -0.023202264681458473, 0.030919646844267845, -0.025344589725136757, 0.06905554980039597, -0.0317465104162693, -0.00419695395976305, -0.029240867123007774, 0.02523183636367321, -0.024104295298457146, 0.0033951476216316223, 0.022914115339517593, 0.004745063371956348, -0.025582626461982727, -0.026685109362006187, -0.007360329385846853, -0.02095971256494522, -0.01285395398736, -0.0009075129637494683, 0.0028470379766076803, 0.019067950546741486, -0.028088269755244255, -0.0038430315908044577, 0.019080478698015213, 0.024430029094219208, -0.026559827849268913, 0.034277211874723434, 0.0018118938896805048, -0.009803332388401031, -0.043923940509557724, 0.007780024781823158, 0.011281662620604038, -0.020809374749660492, 0.03760971873998642, -0.02853928506374359, -0.010949664749205112, -0.02768736705183983, -0.017339056357741356, 0.0054090591147542, -0.020208019763231277, 0.05437247455120087, -0.025682851672172546, 0.042871568351984024, -0.0013005859218537807, -0.016324270516633987, -0.02231276035308838, -0.02100982517004013, 0.03680790960788727, -0.021949442103505135, 0.022250119596719742, 0.016637476161122322, 0.03134560585021973, 0.016386911273002625, 0.03229775279760361, -0.0047231391072273254, -0.03289910778403282, -0.015246843919157982, 0.024016598239541054, 0.01381862722337246, -0.017339056357741356, 0.013668288476765156, 0.018065692856907845, -0.000657340046018362, -0.017952939495444298, 0.0026935674250125885, 0.014094247482717037, -0.01846659742295742, -0.0009576258598826826, -0.039163216948509216, -0.015760501846671104, -0.014595376327633858, -0.0006988397799432278, 0.02711106836795807, -0.01564774662256241, -0.016299214214086533, 0.0015621124766767025, -0.03031829372048378, 0.015046392567455769, 0.022525740787386894, -0.05251830071210861, -0.02019549161195755, -0.03583071008324623, -0.028313778340816498, 0.031069986522197723, -0.0004956477205269039, -0.021272918209433556, -0.00040090305265039206, 0.02283894643187523, -0.05407179892063141, -0.03234786540269852, -0.026459600776433945, -0.03913816064596176, -0.039889853447675705, 0.02326490543782711, 0.04946141317486763, -0.03495373576879501, -0.0007195896469056606, 0.03575554117560387, -0.040365926921367645, 0.003764730179682374, 0.0008667962392792106, -0.018153391778469086, 0.007529460359364748, 0.00442559365183115, 0.007635950110852718, -0.009527711197733879, -0.042871568351984024, -0.03272370994091034, -0.04715622216463089, -0.005881999619305134, -0.005900791846215725, -0.014770771376788616, -0.06429482996463776, 0.008675792254507542, 0.028439059853553772, -0.021598652005195618, -0.0013107650447636843, 0.023778561502695084, -0.002377229742705822, -0.02974199503660202, -0.009778276085853577, 0.04863455146551132, 0.0004658931866288185, 0.014445037581026554, -0.033074501901865005, -0.0020718544255942106, 0.015384654514491558, 0.005565661936998367, -0.039839740842580795, 0.028388947248458862, 0.03675779700279236, 0.011864224448800087, 0.016900569200515747, 0.022625965997576714, 0.007153613958507776, -0.024104295298457146, -0.03277382254600525, 0.00920824147760868, -0.021410727873444557, 0.011306718923151493, 0.03640700876712799, -0.014758243225514889, -0.0019825908821076155, -0.0014571886276826262, 0.006160752382129431, -0.009652993641793728, 0.000913777097593993, 0.005881999619305134, -0.027762535959482193, 0.02748691476881504, -0.024116823449730873, -0.032397978007793427, -0.006508410442620516, -0.015960952267050743, 0.00741044245660305, 0.018303729593753815, -0.040265701711177826, 0.004469442646950483, -0.007880250923335552, 0.029240867123007774, 0.039789628237485886, 0.0027295860927551985, -0.0034953735303133726, 0.009289675392210484, -0.001222284510731697, 0.010974721051752567, -0.009252090938389301, -0.017151134088635445, -0.004500763025134802, -0.03487856686115265, 0.0037835226394236088, -0.03728398308157921, -0.028439059853553772, -0.021949442103505135, -0.012390409596264362, -0.03555509075522423, -0.020521225407719612, 0.017301471903920174, -0.026509713381528854, 0.0014102078275755048, -0.037258926779031754, 0.026609940454363823, -0.00805564597249031, -0.0944126695394516, -0.04091716930270195, 0.036106329411268234, 0.04086705297231674, 0.025682851672172546, -0.026058698073029518, 0.00942748598754406, -0.010504912585020065, -0.015898311510682106, -0.03487856686115265, -0.037735000252723694, -0.022237591445446014, -0.010711628012359142, 0.019506439566612244, 0.019030366092920303, -0.04234538599848747, -0.03923838585615158, 0.013380139134824276, 0.008913828991353512, -0.03177156671881676, 0.00933352392166853, 0.020370885729789734, 0.003936993423849344, 0.06509663164615631, -0.014156889170408249, -0.006433241069316864, 0.005809962283819914, 0.030493687838315964, -0.01779007352888584, 0.015722917392849922, 0.014708130620419979, -0.019544024020433426, 0.026509713381528854, 0.03400158882141113, -0.01465801801532507, -0.0019136857008561492, 0.0036519761197268963, -0.01780260168015957, -0.030543800443410873, -0.008425228297710419, -0.0013452176935970783, -0.04139323905110359, 0.04322236031293869, 0.006148224230855703, 0.03340023383498192, -0.053570669144392014, 0.00018802117847371846, -0.02394142933189869, 0.006852936465293169, -0.047181278467178345, -0.030543800443410873, 0.016963209956884384, 0.0034233361948281527, -0.0015589804388582706, 0.025068968534469604, -0.01348036527633667, -0.00632048724219203, 0.015710387378931046, 0.014131832867860794, 0.04635441675782204, -0.034803394228219986, 0.001095436280593276, 0.023039396852254868, -0.006173280533403158, -0.05387134850025177, -0.026685109362006187, -0.022676078602671623, -0.017339056357741356, 0.013016820885241032, -0.010492384433746338, 0.002284834161400795, 0.01727641560137272, -0.017251359298825264, 0.005318229552358389, 0.0002319678314961493, 0.01194565836340189, -0.02077178843319416, 0.02580813318490982, -0.06549753248691559, 0.03412687033414841, -0.00028227645088918507, -0.02370339259505272, 0.019969983026385307, 0.01612382009625435, -0.007579573430120945, -0.0012113222619518638, -0.0019387421198189259, 0.03397653251886368, -0.027737479656934738, 0.055474959313869476, 0.043347641825675964, -0.00853798259049654, 0.03650723397731781, -0.024404972791671753, -0.0012301146052777767, -0.007178670261055231, -0.006915577687323093, 0.006414448842406273, 0.02068409137427807, 0.0009075129637494683, 0.018078221008181572, 0.03199707344174385, 0.006997011136263609, -0.02701084315776825, 0.019656777381896973, 0.008337530307471752, -0.02039594203233719, 0.014495151117444038, 0.018491653725504875, 0.010523704811930656, 0.007949155755341053, 0.0046009887009859085, -0.030593914911150932, -0.006827880162745714, 0.011814111843705177, 0.007692327257245779, 0.0482587032020092, 0.015096505172550678, 0.014833413064479828, -0.00022198440274223685, 0.006458297371864319, -0.0003948347002733499, -0.028088269755244255, 0.010273140855133533, -0.006439505144953728, -0.005073929205536842, 0.016336798667907715, 0.03287405148148537, -0.03791039437055588, -0.02063397876918316, 0.008231041021645069, -0.0013068499974906445, 0.032798882573843, -0.01670011691749096, -0.01290406659245491, 0.03522935509681702, 0.02456784062087536, 0.003636315930634737, -0.00803685374557972, 0.03833635523915291, -0.01654977910220623, -0.005033212713897228, 0.03229775279760361, 0.047281503677368164, 0.011375623755156994, -0.02302686870098114, -0.005108381621539593, -0.04637947306036949, 0.010561289265751839, 0.005073929205536842, 0.028088269755244255, 0.011193964630365372, -0.006746446713805199, -0.0073540653102099895, 0.00419695395976305, -0.011356831528246403, 0.007391649764031172, -0.024404972791671753, -0.02226264774799347, 0.024818403646349907, 0.017188718542456627, 0.07306458055973053, 0.0020906466525048018, 0.006959426216781139, 0.005261852405965328, 0.00017167576879728585, -0.04417450353503227, -0.004090463742613792, -0.027837704867124557, 0.024630481377243996, 0.0006514674751088023, -0.046028681099414825, 0.017351584509015083, 0.03184673562645912, 0.025407230481505394, 0.011181436479091644, 0.00215955195017159, 0.016098763793706894, 0.01038589421659708, 0.014745715074241161, 0.026735221967101097, 0.013668288476765156, -0.04630430042743683, -0.0016725173918530345, 0.03981468454003334, -0.02979210764169693, 0.0005242277402430773, 0.00014162762090563774, -0.003695824882015586, 0.026158923283219337, 0.009934878908097744, 0.021022353321313858, -0.0019011574331671, 0.05251830071210861, -0.011638716794550419, 0.008168399333953857, -0.015271900221705437, 0.025294477120041847, 0.0060511305928230286, -0.014896053820848465, -0.0241293516010046, 0.045502495020627975, 0.00233807903714478, -0.022713663056492805, -0.02801310084760189, 0.010373366065323353, -0.03573048487305641, 0.009922350756824017, 0.004923590458929539, -0.00617641257122159, 0.03159617260098457, -0.012164901942014694, -0.010160386562347412, 0.021849216893315315, -0.008970205672085285, -0.07622168958187103, 0.035905878990888596, -0.009934878908097744, -0.021385671570897102, -0.009772012010216713, -0.01865451969206333, -0.015898311510682106, 0.0005277512827888131, 0.028940189629793167, -0.03898782283067703, 0.014908581972122192, 0.012359089218080044, -0.012252599000930786, -3.567606472643092e-05, -0.000100617267889902, 0.006148224230855703, 0.022701134905219078, -0.02082190290093422, 0.003401411697268486, -0.020471112802624702, 0.00928341131657362, -0.020070208236575127, -0.04174403101205826, -0.01702585071325302, -0.001279444550164044, -0.02409176714718342, 0.0026168320327997208, -0.006298562977463007, -0.012233806774020195, 0.0045790644362568855, -0.016900569200515747, 0.03495373576879501, 0.03976457193493843, -0.03294922038912773, -0.0354047492146492, -0.012321504764258862, 0.033550575375556946, 0.020846959203481674, -0.0003102692135144025, 0.014632961712777615, 0.01358059048652649, -0.0011204926995560527, 0.03791039437055588, 0.0629417821764946, -0.005352681968361139, -0.0004052096337545663, 0.006120035424828529, -0.008725905790925026, -0.01626162976026535, 0.0063298833556473255, -0.032748766243457794, 0.013856211677193642, 0.03157111629843712, -0.020320773124694824, 0.0036206557415425777, -0.02738668955862522, 0.005362078081816435, -0.0011604264145717025, 0.04302190989255905, 0.007535724435001612, -0.016036121174693108, 0.010955928824841976, 0.006558523513376713, -0.00045414798660203815, 0.009095488116145134, -0.035905878990888596, -0.009433750063180923, -0.025394702330231667, -0.04765734821557999, 0.04244561120867729, -0.0034421284217387438, 0.008437756448984146, 0.005343285854905844, 0.02082190290093422, -0.012572068721055984, 0.04129301384091377, 0.05161626636981964, -0.03430226817727089, 0.0031759038101881742, 0.002558889100328088, 0.0018150259274989367, -0.005690943915396929, 0.019757002592086792, 0.010592610575258732, -0.012879010289907455, -0.021260390058159828, 0.016687588766217232, -0.0417189747095108, -0.011682565324008465, 0.019305987283587456, 0.008920093066990376, -0.00880107469856739, 0.03781016916036606, -0.039889853447675705, -0.022174950689077377, -0.01408171933144331, 0.0025667191948741674, -0.005650227423757315, 0.02974199503660202, 0.021410727873444557, -0.0059101879596710205, 0.017401697114109993, -0.0010374932317063212, 0.01492111012339592, 0.009483862668275833, -0.024204522371292114, -0.028890075162053108, 0.02853928506374359, -0.014770771376788616, -0.043773602694272995, 0.010454799979925156, 0.017865242436528206, -0.027737479656934738, 0.001591866952367127, 0.0361815020442009, 0.018792331218719482, 0.028263665735721588, 0.004541479982435703, -0.014382396824657917, -0.023715920746326447, 0.003376355394721031, -0.011939394287765026, -0.0120646758005023, -0.031220324337482452, -0.007416706532239914, 0.019305987283587456, 0.019255874678492546, -0.020132850855588913, -0.011457057669758797, -0.0016333666862919927, 0.0025996058247983456, 0.01799052394926548, 0.025595154613256454, 0.006646221037954092, -0.0333000086247921, 0.07181175798177719, -0.011338039301335812, -0.012146109715104103, -0.005321361590176821, -0.02716118097305298, 0.020471112802624702, -0.009051639586687088, -0.019268402829766273, -0.03570542857050896, 0.03247314691543579, -0.0039025405421853065, 0.0301679540425539, -0.02024560421705246, 0.0035360902547836304, 0.005124042276293039, -0.00215172185562551, -0.01837889850139618, 0.007736176252365112, 0.016574835404753685, -0.01487099751830101, 0.02600858546793461, -0.013505421578884125, -0.0354047492146492, 0.034803394228219986, -0.0032291486859321594, -0.01165750902146101, -0.033124614506959915, 0.009584088809788227, -0.008005532436072826, -0.002671642927452922, -0.00962167326360941, 0.001513565657660365, -0.03277382254600525, -0.018629463389515877, -0.008387643843889236, -0.01670011691749096, -0.03963929042220116, 0.03084447793662548, 0.006082450971007347, 0.0010805589845404029, 0.02421705052256584, -0.016762759536504745, -0.0163994412869215, 0.0012849256163462996, -0.02034582942724228, 0.007848929613828659, -0.004118652548640966, -0.025607682764530182, 0.01880485936999321, 0.018629463389515877, -0.021849216893315315, -0.011037361808121204, 0.032748766243457794, -0.022939171642065048, -0.0016396308783441782, -0.020320773124694824, 0.014833413064479828, 0.017877770587801933, 0.0006616466562263668, -0.02221253514289856, -0.0288399625569582, 0.0023693996481597424, -0.005969697143882513, 0.029341092333197594, 0.020746732130646706, -0.02743680216372013, 0.003567410632967949, 0.010310725308954716, 0.006185808684676886, 0.040265701711177826, -7.702897710260004e-05, 0.024004070088267326, -0.013555534183979034, 0.015522465109825134, 0.008826131001114845, -0.0006910096271894872, -0.013041877187788486, 0.020596394315361977, -0.014595376327633858, 0.033650800585746765, -0.02848917245864868, 0.02212483622133732, -0.003398279659450054, 0.002389758126810193, 0.002634058240801096, 0.01928093098104, 0.01822856068611145, -0.007729911711066961, 0.0001792122784536332, 0.018403954803943634, -0.04191942512989044, -0.004795176442712545, 0.014632961712777615, -0.007153613958507776, 0.011695093475282192, -0.04196953773498535, 0.03257337212562561, -0.023853732272982597, 0.012603390030562878, -0.008826131001114845, -0.02384120412170887, -0.02931603603065014, 0.024191994220018387, 0.002447701059281826, -0.0006326751317828894, 0.017539508640766144, -0.04883500188589096, -0.008450284600257874, 0.0051428345032036304, 0.033801138401031494, -0.009966199286282063, 0.002377229742705822, 0.0006224959506653249, -0.005152230616658926, -0.009753219783306122, 0.00215172185562551, -0.04698082432150841, 0.015234315767884254, -0.018403954803943634, -0.02250068448483944, 0.010248084552586079, 0.00580369820818305, -0.001645894953981042, 0.023089509457349777, -0.008068174123764038, -0.0021485898178070784, -0.027937931939959526, -0.0016552910674363375, -0.014833413064479828, 0.01741422712802887, -0.025833189487457275, 0.0016772154485806823, 0.0005269682733342052, 0.003921332769095898, 0.027562085539102554, 0.001460320665501058, 0.008920093066990376, -0.01971941813826561, -0.030819421634078026, 0.012572068721055984, 0.008600623346865177, -0.006195204798132181, -0.009859709069132805, 0.009865973144769669, -0.023327546194195747, 0.002175212139263749, -0.02432980388402939, 0.002134495647624135, 0.018203504383563995, -0.02758714184165001, 0.019418740645051003, 0.004973703529685736, -0.006066790781915188, -0.000694533227942884, 0.004591592587530613, -0.004102992359548807, -0.0029707541689276695, -0.00603233790025115, 0.02513160929083824, 0.019694361835718155, 0.012822633609175682, 0.006201468873769045, -0.03036840632557869, 0.005290041211992502, 0.02019549161195755, 0.003122658934444189, -0.03152100369334221, -9.182060239254497e-06, -0.003055319655686617, -0.011049889959394932, -0.01047985628247261, 0.019456326961517334, -0.011507170274853706, -0.013605646789073944, -0.005039476789534092, -0.020884543657302856, -0.008863715454936028, 0.0034327323082834482, -0.008938885293900967, -0.011738942004740238, -0.0032667333725839853, -0.019757002592086792, 0.0396142341196537, -0.0041875578463077545, -0.017689846456050873, -0.006452033296227455, 0.014119304716587067, 0.01871716044843197, -0.0031085647642612457, 0.02273871935904026, 0.0013569628354161978, 0.011356831528246403, -0.015046392567455769, -0.010843174532055855, 0.00573166087269783, 0.010905816219747066, -0.003376355394721031, 0.007441762834787369, -0.0006792644271627069, 0.032798882573843, -0.0241293516010046, -0.011419473215937614, 0.007347801234573126, -0.006120035424828529, 0.016812872141599655, 0.017714902758598328, 0.004644837696105242, -0.010918344371020794, 0.008412700146436691, 0.029917391017079353, 0.03204718604683876, -0.017727430909872055, -0.0028846226632595062, 0.02426716312766075, -0.010999777354300022, -0.03911310434341431, 0.00781760923564434, -0.020420998334884644, -0.003504769643768668, -0.011137587949633598, -0.013517949730157852, 0.001974760787561536, 0.013768513686954975, -0.013906324282288551, -0.04181919991970062, 0.024931158870458603, -0.01060513872653246, 0.001534707029350102, 0.012484371662139893, 0.011219020932912827, 0.020809374749660492, -0.012828897684812546, -0.009521447122097015, 0.008788546547293663, 0.016286686062812805, 0.0003272997564636171, 0.005684679839760065, -0.020746732130646706, -0.009559032507240772, 0.005565661936998367, -0.018742216750979424, -0.0034264682326465845, 0.01919323392212391, 0.007485611829906702, 0.029967503622174263, 0.07351559400558472, -0.005180418957024813, 0.027937931939959526, -0.024843459948897362, -0.019594136625528336, 0.011770263314247131, 0.03187179192900658, 0.025169193744659424, -0.04059143364429474, 0.00048546853940933943, -0.01890508458018303, 0.015898311510682106, -0.024881046265363693, 0.03708353266119957, 0.0472063347697258, -0.04079188406467438, 0.016336798667907715, 0.028038157150149345, 0.012572068721055984, -0.0015777727821841836, 0.010323253460228443, -0.0057974341325461864, 0.029040414839982986, -0.00794289167970419, -0.022425513714551926, -0.015722917392849922, -0.011125059798359871, -0.02158612385392189, -0.02000756748020649, 0.036156442016363144, 0.019832173362374306, 0.024693122133612633, 0.008863715454936028, 0.00824983324855566, -0.03159617260098457, 0.06910566240549088, -0.043974053114652634, -0.003927596844732761, 0.01057381834834814, -0.0031101307831704617, -0.03770994395017624, -0.026710165664553642, 0.008174663409590721, 0.005462304223328829, 0.0417189747095108, -0.0024602292105555534, -0.04169391840696335, 0.01985722966492176, -0.043623264878988266, -0.023490412160754204, -0.014632961712777615, 0.004851553123444319, -0.047707464545965195, 0.01775248907506466, 0.0361815020442009, -0.004262726753950119, -0.002671642927452922, 0.001898025395348668, -0.001186265842989087, -0.004400537349283695, 0.04557766392827034, -0.020182963460683823, 0.036632515490055084, 0.016424497589468956, 0.01508397702127695, -0.0017414225731045008, 0.013267384842038155, 0.007097236812114716, -0.018779803067445755, -0.030644027516245842, 0.013355082832276821, -0.0032416770700365305, 0.016963209956884384, -0.0003496156423352659, 0.03678285330533981, -0.007548252586275339, 0.006273506209254265, -0.0025463607162237167, 0.02212483622133732, 0.040315814316272736, 2.9999215257703327e-05, -0.006539730820804834, -0.014294699765741825, -0.01880485936999321, -0.0033575629349797964, 0.010160386562347412, -0.027837704867124557, -0.009364844299852848, 0.017201246693730354, 0.015910839661955833, -0.014382396824657917, 0.000586085778195411, 0.029817163944244385, 0.027236351743340492, -0.03262348473072052, 0.013943908736109734, 0.0068654646165668964, -0.007899043150246143, -0.03520429879426956, -0.0403909832239151, -0.014194473624229431, -0.01122528500854969, 0.013931380584836006, -0.021648764610290527, 0.017476867884397507, 0.032022129744291306, 0.013730929233133793, -0.01817844808101654, 0.0013992455787956715, -0.000821381458081305, 0.010849438607692719, 0.011306718923151493, -0.037534549832344055, -0.019694361835718155, 0.016386911273002625, -0.004532083868980408, -0.00873216986656189, 0.026559827849268913, 0.01899278163909912, 0.030243122950196266, -0.013267384842038155, -0.00034707086160779, 0.004973703529685736, -0.009032846428453922, -0.008262361399829388, -0.009502654895186424, 0.026710165664553642, 0.004193821921944618, 0.023540526628494263, -0.01846659742295742, -0.017013322561979294, -0.0015441031428053975, -0.01924334652721882, 0.012390409596264362, 0.016712645068764687, 0.01631174236536026, -0.03876231238245964, -0.004901666194200516, -0.015334541909396648, 0.009314731694757938, 0.015810614451766014, 0.012534484267234802, 0.016249101608991623, 0.005681547801941633]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"σ
logZσ≤EσSMC(S)""
logTY
t=11
KKX
i=1wt 
si
1:t#
.(24)
The gap in the lower bound is DKL(qSMC(S)∥σSMC(S)), and
the gap in the upper bound is DKL(σSMC(S)∥qSMC(S)).
See App. F for a detailed discussion and derivations. The
proof proceeds by adapting a general approach for extended
state space log partition function bounds from Brekelmans
et al. (2022) using the probabilistic interpretation of SMC
from Andrieu et al. (2010); Maddison et al. (2017). With noresampling, the SIScase recovers the Importance Weighted
Autoencoder (IWAE) lower (Burda et al., 2015) and upper
(Sobolev & Vetrov, 2019; Brekelmans et al., 2022) bounds.
Sampling from σSMCfor SMC Upper Bounds We now
discuss sampling from σSMC(S)for the expectation in the
upper bound, which requires a single, exact sample from the
target distribution σ(s1:T). This sample may be obtained,
for example, using the BDMC trick in Sec. 3.3. Note that
Sec. 2.2 and Alg. 1 describe sampling from qSMC(S), which
is used for the expectation in the lower bound.
Sampling from σSMC(S)differs from sampling from
qSMC(S)by its treatment of the exact target sample. In
particular, the partial sequence corresponding to the exact
target sample is guaranteed to be cloned once at each re-
sampling step. In other indices, resampling proceeds as in
Sec. 2.2, where the exact sample may be cloned additional
times based on its incremental importance weights. Finally,
we sample K−1next tokens from the proposal, while the
value of the remaining chain is fixed by the exact target
sample. See App. F and Alg. 2 for detailed discussion.
Tightness of the Bidirectional Bounds Since the bounds
in Prop. 5.1 become exact as K→ ∞ for any proposal
(Burda et al., 2015; Maddison et al., 2017), we can use
SMC orIWAE with large Kto sandwich the logpartition
function when σsamples are available.
For a given K, the gap in the extended state space
logZσbounds in Prop. 5.1 provides further insight
into the quality of twisted SMC sampling via the dis-
tribution of the marginal sample sσ
1:T(Sec. 5.1). In
particular, the data processing inequality suggests that
DKL(qSMC(s1:T)∥σ(s1:T))≤DKL(qSMC(S)∥σSMC(S))
andDKL(σ(s1:T)∥qSMC(s1:T))≤DKL(σSMC(S)∥qSMC(S))
(Grosse et al., 2015; 2016). Thus, if the difference between
upper and lower bounds on logZσis small, then we can
conclude that the K-sample SMC orSIS procedures in
Sec. 2.2 yield a single approximate sample sσ
1:Twhose
distribution qSMC(s1:T)is close to the target σ(s1:T)in
symmetrized KL divergence.3
6. Related Work
In the previous sections, we have discussed related work as it
fit within our SMC framework for language modeling. Note
that Lew et al. (2023) consider SMC sampling for language
models, but do not learn twist functions or proposals.
Decoding from language models to obtain diverse (Holtz-
man et al., 2019; Vilnis et al., 2023) or controlled generation
(Zhang et al., 2023; Dathathri et al., 2019; Krause et al.,
2020; Yang & Klein, 2021; Guo et al., 2021; Qin et al.,
3Note that the difference between upper and lower bound yields
DKL(σSMC(S)∥qSMC(S)) +DKL(qSMC(S)∥σSMC(S)).
8
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
2022; Snell et al., 2022; Hu et al., 2023) is an active area of
research. Our SMC resampling approach may be viewed as
a principled","[0.03384050726890564, -0.011407568119466305, 0.03021288849413395, 0.02478441596031189, -0.02386455424129963, 0.02098837122321129, 0.004670560359954834, -0.011854542419314384, -0.05029435455799103, 0.022789224982261658, 0.01813809759914875, -0.022568976506590843, -0.02431800775229931, 0.043453700840473175, 0.028632283210754395, -0.01905795931816101, 0.011724984273314476, -0.0030462287832051516, 0.010086078196763992, -0.0009044756880030036, -0.020288757979869843, -0.02057378552854061, -0.02661118097603321, 0.02707758918404579, -0.0041879573836922646, -0.028528636321425438, 0.018099229782819748, -0.011912843212485313, 0.02539333701133728, 0.0014769594417884946, 0.03764950856566429, -0.023657262325286865, -0.024732591584324837, -0.058715615421533585, -0.03404780104756355, 0.10369809716939926, -0.008978358469903469, 0.011271532624959946, -0.016440890729427338, 0.01149825844913721, -0.002952299313619733, -0.03871188312768936, -0.04200265184044838, 0.022478286176919937, 0.010131423361599445, 0.04477519169449806, 0.01532669272273779, -0.03215625509619713, 0.004469745792448521, 0.027258969843387604, -0.02448643185198307, 0.037856802344322205, -0.01619473099708557, -0.040888454765081406, 0.004978260025382042, 0.008725720457732677, -0.0005947514437139034, -0.0037377437110990286, 0.02284104749560356, -0.0468740276992321, 0.031223440542817116, -0.03140481933951378, 0.0011206753551959991, 0.007734603248536587, -0.029202338308095932, -0.016220642253756523, -0.0029863081872463226, 0.032259903848171234, -0.022737400606274605, 0.02598930336534977, -0.012955783866345882, 0.036949895322322845, 0.014562301337718964, -0.021208619698882103, -0.04259862005710602, -0.005298915784806013, 0.00759856728836894, 0.03687216341495514, 0.0008793738670647144, -0.0332963652908802, -0.031352996826171875, -0.01277440320700407, 0.012716102413833141, -0.019291162490844727, -0.05244501307606697, -0.017917849123477936, -0.011504736728966236, 0.03376277536153793, -0.03972243517637253, -0.01859155111014843, -0.008900623768568039, 0.03402188792824745, -0.016531581059098244, -0.02525082416832447, 0.06446798145771027, 0.012379251420497894, 0.015223046764731407, -0.001692349324002862, 0.014277273789048195, 0.00728762848302722, 0.02749217487871647, -0.023657262325286865, -0.007928939536213875, -0.053585123270750046, 0.058715615421533585, -0.004100505728274584, 0.0014194680843502283, -0.007009079214185476, -0.045422978699207306, -0.028787752613425255, -0.010474751703441143, -0.038323208689689636, -0.05420700088143349, 0.054310645908117294, 0.013486971147358418, -0.03148255497217178, -0.02808813937008381, 0.005664916709065437, -0.02615772746503353, 0.048895128071308136, -0.006069784983992577, 0.015935614705085754, 0.02446052059531212, 0.019589146599173546, 0.030938412994146347, -0.028632283210754395, 0.020353537052869797, -0.08820297569036484, -0.03145664557814598, 0.038141828030347824, 0.004116700496524572, 0.007954851724207401, 0.009302252903580666, -0.002121509751304984, -0.0063386172987520695, -0.004913480952382088, -0.0015174462459981441, 0.014044069685041904, -0.013499926775693893, 0.006756441667675972, -0.006432546768337488, -0.023851599544286728, -0.005107817705720663, -0.0004202532581984997, -0.020651519298553467, -0.010021299123764038, -0.05545075610280037, 0.007494921330362558, -0.03202669695019722, 0.04037022218108177, -0.0173737071454525, -0.04433469474315643, -0.034851059317588806, 0.02508239820599556, -0.028787752613425255, -0.0635351687669754, -0.03503243997693062, 0.06436433643102646, 0.026818472892045975, -0.033192720264196396, -0.004884330555796623, 0.07545448839664459, 0.00031620211666449904, 0.007345929741859436, -0.006251166108995676, -0.025341514497995377, -0.03189714252948761, 0.045578449964523315, -0.042080387473106384, -0.05913019925355911, -0.004000098444521427, -0.03270040079951286, -0.006108652334660292, -0.044075578451156616, 0.010837513953447342, -0.035136085003614426, 0.004735338967293501, -0.06317240744829178, -0.00024312338791787624, -0.004006576258689165, 0.0016413358971476555, 0.041613977402448654, -0.025004664435982704, -0.006053590215742588, 0.00018158341117668897, 0.02538038045167923, -0.0003777420788537711, 0.041484422981739044, 0.03751995041966438, 0.008375914767384529, -0.019006134942173958, 0.08270972967147827, 0.08027403801679611, -0.005130490753799677, -0.016583403572440147, -0.022931737825274467, 0.04518977552652359, 0.07545448839664459, 0.019744616001844406, -0.016505669802427292, 0.015987437218427658, -0.0018413407960906625, -0.03746812790632248, -0.040551602840423584, 0.0006712715839967132, 0.028450902551412582, -0.014510477893054485, 0.020923592150211334, -0.056590866297483444, 0.020521963015198708, -0.005156402010470629, -0.004463267512619495, 0.07011670619249344, 0.010131423361599445, -0.02221916988492012, 0.013435148634016514, -0.05565804988145828, 0.005499730352312326, 0.006170192267745733, 0.06265417486429214, 0.017257103696465492, 0.03337410092353821, 0.043298229575157166, 0.03671669214963913, -0.02974648028612137, 0.015650587156414986, 0.019718702882528305, -0.013383325189352036, 0.014393876306712627, -0.028191786259412766, 0.0498797707259655, 0.02661118097603321, -0.0021150317043066025, -0.04594121128320694, -0.013655396178364754, -0.007164548616856337, -0.01489915233105421, -0.007203415967524052, -0.020431270822882652, -0.0711013451218605, -0.003507778514176607, 0.0014907249715179205, 0.040888454765081406, 0.009069048799574375, 0.016570448875427246, 0.02554880641400814, -0.009580802172422409, -0.03293360397219658, -0.002425970509648323, 0.015223046764731407, -0.017878983169794083, -0.026714827865362167, -0.03871188312768936, 0.005149924196302891, -0.038478679955005646, -0.008129755035042763, -0.01846199296414852, 0.026416843757033348, -0.020068509504199028, 0.01982234977185726, -0.030575651675462723, -0.034825146198272705, -0.040137019008398056, 0.0039385585114359856, -0.024849195033311844, -0.02282809093594551, 0.00668518478050828, -0.016959121450781822, 0.07307062298059464, -0.03762359917163849, -0.012800314463675022, 0.01647975668311119, 0.0054867747239768505, 0.018656330183148384, -0.006238210014998913, -0.05195269361138344, 0.006244687829166651, 0.02977239154279232, -0.0332186296582222, 0.01724414899945259, 0.01619473099708557, -0.05166766792535782, 0.021726850420236588, 0.00832409132272005, 0.014704815112054348, 0.0042397803626954556, 0.009483634494245052, 0.0098140062764287, -0.011530647985637188, -0.0422876812517643, 0.02661118097603321, 0.019887128844857216, -0.011621338315308094, -0.026352064684033394, 0.024849195033311844, -0.024408698081970215, 0.024447564035654068, 0.0015061099547892809, -0.011427002027630806, 0.0032907691784203053, 0.04759955033659935, 0.020521963015198708, 0.007268195040524006, 0.007637434639036655, 0.015365560539066792, -0.008201011456549168, 0.01903204619884491, 0.046770382672548294, -0.026054082438349724, 0.012262649834156036, -0.0059402273036539555, -0.0316898487508297, -0.05368876829743385, 0.029357807710766792, -0.009483634494245052, -0.032855868339538574, 0.05420700088143349, -0.030497916042804718, 0.002121509751304984, -0.04941336065530777, -0.03399597853422165, 0.02098837122321129, -0.014925063587725163, -0.04293546825647354, -0.006092457566410303, 0.007229327689856291, -0.02917642518877983, -0.027569908648729324, -0.017412573099136353, -0.028347255662083626, 0.0332445427775383, 0.03054973855614662, 0.0468222051858902, 0.0032567603047937155, 0.003426804905757308, -0.030420182272791862, -0.013746087439358234, 0.05425882339477539, -0.016389066353440285, 0.0483509860932827, -0.08239878714084625, 0.013875644654035568, -0.004119939170777798, -0.03448829799890518, 0.031171616166830063, 0.02508239820599556, 0.011692595668137074, 0.04016293212771416, 0.08685557544231415, 0.0021085538901388645, 0.01812514290213585, -0.010992983356118202, 0.033503659069538116, -0.009632625617086887, 0.023514747619628906, 0.001204887987114489, -0.006157236639410257, -0.04143259674310684, -0.023514747619628906, -0.0438423752784729, -0.04550071433186531, -0.015767188742756844, 0.041795361787080765, 0.014251362532377243, 0.01570240966975689, 0.030446093529462814, -0.016389066353440285, 0.007708691526204348, -0.0075726560316979885, 0.005694067105650902, 0.01663522608578205, 0.005030083004385233, 0.016363155096769333, 0.004644648637622595, -0.03218216821551323, 0.014834373258054256, -0.015624675899744034, 0.022011877968907356, 0.030627474188804626, 0.01618177443742752, 0.009094960987567902, 0.02101428247988224, -0.012508809566497803, -0.036017078906297684, -0.0005222800537012517, 0.005072189494967461, -0.017438486218452454, -0.008194533176720142, -0.026870297268033028, 0.036509398370981216, -0.03941149637103081, 0.013901556842029095, -0.04575983062386513, 0.01693321019411087, 0.0012105561327189207, 0.0009036659612320364, -0.017593955621123314, 0.023203808814287186, 0.04638170823454857, 0.042728178203105927, -0.0407848097383976, 0.008887668140232563, -0.03819365054368973, -0.023825686424970627, -0.028347255662083626, 0.03910055756568909, 0.04215812310576439, 0.03156029060482979, 0.004408205393701792, 0.05363694578409195, 0.04114757105708122, -0.0665927305817604, 0.02782902494072914, -0.006678706966340542, 0.030757032334804535, -0.03917829319834709, 0.018008539453148842, 0.032104432582855225, 0.04456789791584015, 0.0604775995016098, -0.013953379355370998, -0.05073485150933266, 0.019757570698857307, -0.007605045568197966, 0.021273396909236908, 0.003964469768106937, 0.01337036956101656, -0.031249351799488068, 0.0513567291200161, -0.03580978885293007, -0.02163616009056568, 0.030497916042804718, 0.0604257769882679, -0.04547480121254921, -0.04791048914194107, -0.02477145940065384, 0.02237463928759098, -0.01645384542644024, -0.0015919420402497053, -0.060529425740242004, -0.013001129031181335, -0.0015093488618731499, -0.019563233479857445, 0.002050252864137292, 0.03702763095498085, 0.023838642984628677, -0.007643912918865681, -0.046951763331890106, 0.009716838598251343, -0.01694616489112377, 0.05065711587667465, -0.0634833425283432, 0.06244688108563423, -0.01058487594127655, -0.01601334847509861, -0.030135154724121094, 0.0694430023431778, -0.029565099626779556, 0.01767168939113617, -0.041613977402448654, 0.0438164621591568, 0.007864161394536495, -0.004955587442964315, 0.02220621332526207, 0.018047407269477844, 0.046899937093257904, 0.00020385117386467755, 0.004084310960024595, -0.004910242278128862, 0.039359673857688904, 0.0024713159073144197, -0.050553470849990845, 0.0166093148291111, -0.007203415967524052, -0.011213230900466442, 0.002882661996409297, 0.08421260118484497, -0.056901805102825165, 0.008298180066049099, -0.01352583896368742, 0.021519558504223824, -0.015028709545731544, 0.02325563319027424, 0.04127712920308113, 0.03731266036629677, 0.014225451275706291, 0.021506601944565773, -0.023812731727957726, 0.022789224982261658, 0.0035790354013442993, -0.04296138137578964, -0.05799008905887604, 0.0332186296582222, -0.013875644654035568, 0.03187122941017151, -0.04433469474315643, 0.014523434452712536, -0.0026867056731134653, -0.005279481876641512, -0.010902292095124722, 0.014303185977041721, -0.0025393336545675993, 0.001752269803546369, 0.03415144607424736, -0.00047774455742910504, 0.027310792356729507, 0.006711096037179232, -0.009503067471086979, 0.010701477527618408, 0.041665803641080856, -0.013253767043352127, 0.006646317429840565, 0.008647985756397247, 0.002819502493366599, 0.015236002393066883, 0.014160672202706337, -0.005723217502236366, -0.02871001698076725, 0.0026705111376941204, 0.02386455424129963, 0.009943564422428608, -0.027310792356729507, -0.042261768132448196, -0.0203924048691988, 0.01873406395316124, -0.027621731162071228, 0.009807528927922249, -0.08338342607021332, -0.015313737094402313, -0.0196668803691864, 0.007585611660033464, -0.01649271324276924, 0.01720528118312359, 0.019550278782844543, -0.017632821574807167, 0.006623644847422838, -0.023022428154945374, -0.014704815112054348, -0.0026203072629868984, 0.006905432790517807, -0.0017036856152117252, -0.0059920502826571465, -0.011984100565314293, -0.0051855528727173805, 0.002121509751304984, -0.025496983900666237, 0.0065232375636696815, -0.021351132541894913, -0.010066644288599491, 0.006322422530502081, -0.003802522784098983, -0.01571536622941494, 0.01830652356147766, -0.009334642440080643, -0.014665947295725346, 0.00030122199677862227, 0.016596360132098198, 0.022789224982261658, -0.0272071473300457, -0.007993718609213829, 0.043894197791814804, -0.026468666270375252, 0.008026108145713806, 0.004874613601714373, -0.0302387997508049, -0.0033976545091718435, 0.02417549304664135, -0.009334642440080643, 0.04011110961437225, 0.0483768992125988, -0.051408551633358, 0.003177406033501029, 0.02493988536298275, -0.02339814603328705, -0.009593757800757885, -0.05260048434138298, 0.01996486261487007, -0.030031507834792137, -0.008103842847049236, 0.001842960249632597, -0.027440350502729416, -0.012320950627326965, 0.03562840819358826, -0.04257270693778992, -0.01904500275850296, 0.040888454765081406, 0.019407764077186584, 0.01857859455049038, -0.005143446382135153, -0.010759779252111912, 0.036379843950271606, -0.016116995364427567, -0.009399421513080597, -0.011809197254478931, -0.05208225175738335, 0.016842519864439964, -0.004233302548527718, -0.0016810130327939987, -0.04096619039773941, -0.0006623644731007516, 0.03223399072885513, 0.015819013118743896, -0.008343525230884552, -0.03549885004758835, -0.03236354887485504, 0.039230115711688995, -0.040422048419713974, 0.016687050461769104, 0.03855641558766365, 0.011193797923624516, 0.011569514870643616, 0.021662071347236633, -0.016207685694098473, -0.03111979365348816, 0.0025539088528603315, -0.009302252903580666, 0.01917456090450287, -0.03487697243690491, 0.06638544052839279, -0.01337036956101656, 0.011174364015460014, -0.05047573521733284, 0.027181236073374748, -0.008052020333707333, 0.003844629041850567, 0.018047407269477844, 0.0021830496843904257, -0.033944156020879745, -0.010688521899282932, 0.008220445364713669, 0.001267237588763237, -0.00024352825130335987, 0.0010413212003186345, 0.010973549447953701, 0.018358346074819565, -0.02601521462202072, -0.001731216674670577, 0.030342446640133858, 0.026209551841020584, -0.01601334847509861, 0.02087176777422428, -0.01769760064780712, 0.003248662920668721, -0.030109243467450142, -0.0023498553782701492, -0.0027692988514900208, -0.004068116191774607, 0.02883957512676716, -0.022322816774249077, 0.0034365218598395586, -0.026339109987020493, -0.03653531149029732, 0.01186102069914341, -0.012113658711314201, 0.03873779624700546, -0.007054424379020929, 0.05353330075740814, 0.003669725963845849, -0.010934681631624699, -0.024110713973641396, -0.021040193736553192, 0.02584678865969181, -0.026326153427362442, 0.004349904600530863, 0.023851599544286728, 0.03337410092353821, 0.02402002364397049, 0.029824215918779373, -0.0063321394845843315, -0.004236541222780943, -0.003757177386432886, 0.010487707331776619, 0.0363021083176136, -0.021726850420236588, 0.013875644654035568, -0.0028243609704077244, -0.012761447578668594, -0.018099229782819748, 0.012839182280004025, 0.0039029300678521395, -0.01496393047273159, 0.0008283604402095079, -0.05184904858469963, -0.01391451247036457, -0.011958189308643341, -0.01194523274898529, 0.03358139097690582, -0.006646317429840565, -0.011446435004472733, 0.0020972175989300013, -0.033503659069538116, 0.015067577362060547, 0.02733670547604561, -0.04583756625652313, -0.01352583896368742, -0.02525082416832447, -0.027284881100058556, 0.042235855013132095, -0.0012947686482220888, -0.053118716925382614, 0.011712028644979, 0.036794427782297134, -0.04778093099594116, -0.020211024209856987, -0.008874712511897087, -0.027103500440716743, -0.020042598247528076, 0.03233763575553894, 0.045267511159181595, -0.02793266996741295, 0.0188895333558321, 0.009146783500909805, -0.031197529286146164, 0.01724414899945259, -0.00153121177572757, -0.026067037135362625, 0.009250430390238762, -0.00027591772959567606, 0.018772931769490242, -0.010390538722276688, -0.040732987225055695, -0.021662071347236633, -0.04109574854373932, -0.01511939987540245, -0.014769594185054302, -0.005308632738888264, -0.04112165793776512, 0.0018850666237995028, -0.009392943233251572, -0.007404230535030365, -0.0016413358971476555, 0.04441242665052414, 0.011161408387124538, -0.03809000551700592, -0.01752917654812336, 0.049361538141965866, -0.00868685357272625, 0.028943222016096115, -0.03163802623748779, 0.006924866698682308, 0.016402022913098335, 0.0009263386018574238, -0.04205447435379028, 0.03692398592829704, 0.04759955033659935, 0.02100132592022419, 0.019861217588186264, 0.015767188742756844, 0.002299651736393571, -0.02751808613538742, -0.04018884152173996, 0.01072091143578291, -0.017270060256123543, 0.004667321220040321, 0.01601334847509861, -0.016285421326756477, -0.015974482521414757, -0.008602640591561794, -0.0037701332475990057, -0.012482898309826851, 0.01300760731101036, 0.024745548143982887, -0.030005596578121185, 0.014704815112054348, -0.010345193557441235, -0.013422192074358463, -0.018954312428832054, -0.0309643242508173, 0.0014154193922877312, 0.009004269726574421, -0.010455317795276642, 0.006364529021084309, -0.001331206876784563, 0.03850458934903145, 0.047962311655282974, 0.006335378624498844, 0.010571920312941074, 0.02764764428138733, -0.021882319822907448, 0.0028680867981165648, -0.003796044737100601, -0.01752917654812336, -0.001008121995255351, -0.02707758918404579, -0.024901017546653748, -0.05065711587667465, -0.03884144127368927, -0.02102723717689514, -0.008628551848232746, -0.04332414269447327, -0.017114590853452682, 0.024991707876324654, -0.004440594930201769, 0.004877852741628885, -0.0279844943434, 0.028217697516083717, -0.004051921423524618, -0.11877863109111786, -0.033166807144880295, 0.03267448768019676, 0.034229181706905365, 0.020444227382540703, -0.023942289873957634, 0.02132522128522396, -0.004236541222780943, -0.017878983169794083, -0.03759768605232239, -0.02132522128522396, -0.03153437748551369, -0.023359278216958046, 0.019070914015173912, 0.02173980511724949, -0.03972243517637253, -0.018980223685503006, 0.003715071128681302, -0.0066333613358438015, -0.009088482707738876, 0.005826863925904036, 0.03140481933951378, 0.013979291543364525, 0.06451980769634247, -0.015806056559085846, -0.039981551468372345, -0.0014753398718312383, 0.018345391377806664, -0.02600225806236267, 0.02434391900897026, -0.0007939466740936041, -0.005438190419226885, 0.01496393047273159, 0.03435873985290527, -0.017321882769465446, 0.02281513623893261, -0.006782352924346924, -0.005548314657062292, -0.012942828238010406, -0.0347215011715889, -0.006597733125090599, -0.029357807710766792, 0.032544929534196854, -0.0058333417400717735, 0.021364089101552963, -0.03974834457039833, -0.004498896189033985, -0.024667812511324883, 0.007961329072713852, -0.034255094826221466, -0.018513815477490425, 0.007870638743042946, 0.003036511829122901, 0.01020267978310585, 0.012133091688156128, -0.010215635411441326, 3.0719380447408184e-05, 0.010312804020941257, 0.006422829814255238, 0.04809186980128288, -0.03523973375558853, 0.01360357366502285, 0.04998341575264931, -0.007009079214185476, -0.06700731813907623, -0.03238946199417114, -0.017503265291452408, -0.013156598433852196, 0.026028171181678772, -0.014445699751377106, 0.0034462385810911655, 0.015093488618731499, -0.008032586425542831, 0.015378516167402267, -0.0001981830137083307, 0.01677774079144001, -0.011154930107295513, 0.034203268587589264, -0.05254866182804108, 0.029591010883450508, 0.02012033201754093, -0.04350552335381508, 0.02176571823656559, -0.007391274906694889, -0.018941355869174004, -0.01298817340284586, -0.006775875110179186, 0.02795858308672905, -0.02132522128522396, 0.07172322273254395, 0.04249497130513191, -0.005402562208473682, 0.03132708743214607, -0.0204053595662117, 0.0057426514104008675, -0.0032810524571686983, 0.021882319822907448, 0.013182510621845722, 0.03345183655619621, 0.006157236639410257, 0.028684105724096298, 0.03238946199417114, -0.004388771951198578, -0.033633217215538025, 0.023981155827641487, 0.023035384714603424, -0.015145312063395977, 0.010533052496612072, 0.013668352738022804, 0.004680276848375797, 0.010027777403593063, -0.001298817340284586, -0.02161024883389473, -0.013512883335351944, 0.011290965601801872, 0.0029296267312020063, 0.05231545493006706, 0.013901556842029095, 0.008201011456549168, 0.02355361543595791, 0.0018089513760060072, -0.009263386018574238, -0.01368130836635828, 0.011718506924808025, -0.00589164299890399, -0.004385532811284065, 0.010157334618270397, 0.024551210924983025, -0.02554880641400814, -0.011699073016643524, 0.0188895333558321, 0.003216273384168744, 0.03912646695971489, -0.0362761951982975, -0.021338175982236862, 0.026079993695020676, 0.017775336280465126, 0.010656132362782955, -0.012554154731333256, 0.02915051393210888, -0.00668518478050828, -0.020444227382540703, 0.01360357366502285, 0.048895128071308136, -0.001404083101078868, -0.03840094432234764, -4.978614470019238e-06, -0.025769054889678955, -0.005920793395489454, 0.01784011535346508, 0.0347992368042469, 0.0028599894139915705, -0.005752368364483118, -0.005392845254391432, -0.00676291948184371, -0.004894047509878874, -0.008809933438897133, -0.026118861511349678, -0.008434215560555458, 0.01936889812350273, 0.027284881100058556, 0.057368211448192596, -0.003128821961581707, 0.000583010318223387, 0.0044049667194485664, 0.011258576065301895, -0.038452766835689545, 0.004868135787546635, -0.014601169154047966, 0.020185111090540886, 0.003345831297338009, -0.06617814302444458, 0.004498896189033985, 0.032441284507513046, 0.02056082896888256, 0.006743485573679209, -0.0037377437110990286, 0.0063256616704165936, 0.0032940080855041742, 0.0019433676498010755, 0.02205074392259121, 0.025950435549020767, -0.04275408759713173, 0.011984100565314293, 0.03083476610481739, -0.027258969843387604, 0.0090755270794034, 0.002918290439993143, -0.023385191336274147, 0.024888060986995697, -0.0058560143224895, 0.035602495074272156, -0.00921156257390976, 0.04094027727842331, -0.005055994726717472, 0.00403572665527463, -0.033503659069538116, 0.020444227382540703, 0.010546008124947548, -0.009716838598251343, -0.04003337398171425, 0.04762546345591545, 0.005143446382135153, -0.02012033201754093, -0.011044805869460106, 0.02310016378760338, -0.036198459565639496, 0.030031507834792137, -0.012029445730149746, 0.0028875204734504223, 0.007041468750685453, -0.004939392674714327, -0.01933003030717373, 0.01706276834011078, -0.020470138639211655, -0.0635351687669754, 0.02553584985435009, 0.006983167491853237, -0.029979685321450233, -0.02930598333477974, -0.018176965415477753, 0.002952299313619733, -0.011090151034295559, 0.01995190791785717, -0.02764764428138733, 0.01676478423178196, 0.010520096868276596, -0.007164548616856337, -0.015132356435060501, -0.018008539453148842, 0.01904500275850296, 0.0032308485824614763, -0.01663522608578205, -0.005600137636065483, -0.025354469195008278, -0.01193875540047884, -0.01391451247036457, -0.035757966339588165, -0.017036857083439827, 0.012897483073174953, -0.0034008934162557125, -0.007371840998530388, -0.006422829814255238, 0.004621976055204868, 0.0026348826941102743, -0.0009765422437340021, 0.033503659069538116, 0.02567836456000805, -0.04127712920308113, -0.03599116951227188, -0.014018158428370953, 0.02628728561103344, 0.03803818300366402, -0.0007692496874369681, 0.0022348728962242603, 0.008136232383549213, -0.017866026610136032, 0.04951700568199158, 0.06680002063512802, 0.01635020039975643, -0.00807145331054926, -0.0029798303730785847, -0.012035924009978771, -0.018785886466503143, 0.011271532624959946, -0.027233058586716652, 0.013733130879700184, 0.023424057289958, -0.05301506817340851, -0.002780635142698884, -0.024421652778983116, 0.006403396371752024, 0.006885999348014593, 0.05990754812955856, 0.02173980511724949, -0.015313737094402313, 0.0075726560316979885, -0.013163076713681221, -0.0007603425765410066, 0.021428866311907768, -0.035136085003614426, -0.025017619132995605, -0.029435541480779648, -0.05415517836809158, 0.04430878162384033, -0.008039063774049282, 0.0014526672894135118, -0.0011012416798621416, 0.021415911614894867, -0.01616881787776947, 0.051304906606674194, 0.04446425288915634, -0.029591010883450508, 0.005998528096824884, -0.02297060564160347, 0.008213967084884644, 0.002387103158980608, 0.024745548143982887, 0.01043588388711214, -0.018643373623490334, -0.022089611738920212, 0.02417549304664135, -0.023203808814287186, 0.0030186977237462997, 0.03762359917163849, 0.016427934169769287, 0.0018332434119656682, 0.028969133272767067, -0.03376277536153793, -0.02460303343832493, -0.014614124782383442, -0.011575993150472641, -0.003026795107871294, 0.01798262819647789, 0.03549885004758835, -0.0005550743662752211, 0.01616881787776947, -0.0034753892105072737, 0.012340384535491467, 0.008408304303884506, -0.01584492437541485, -0.020832901820540428, 0.024849195033311844, 0.00145347707439214, -0.03871188312768936, 0.011530647985637188, 0.021998921409249306, -0.023048339411616325, 0.0024599796161055565, 0.04122530668973923, -0.001966040348634124, 0.019887128844857216, -0.011608382686972618, -0.012891005724668503, -0.02389046549797058, 0.01918751560151577, -0.01588379219174385, 0.003248662920668721, -0.021338175982236862, -0.01965392380952835, 0.009898219257593155, 0.004213868640363216, -0.02403298020362854, -0.0188895333558321, 0.0017717034788802266, -0.0012340385001152754, 0.019109781831502914, 0.011407568119466305, 0.007682780269533396, -0.0392819382250309, 0.07011670619249344, -0.00928929727524519, -0.006471414119005203, -0.011504736728966236, -0.00298468885011971, 0.01482141762971878, -0.03187122941017151, -0.0007433381397277117, -0.03643166646361351, 0.017580999061465263, 0.0037701332475990057, 0.03228581324219704, -0.01601334847509861, -0.00011002294922946021, -0.004589586518704891, -0.001966040348634124, -0.029098691418766975, 0.014588212594389915, 0.005276243202388287, -0.017334839329123497, 0.009917653165757656, 0.004547480493783951, -0.030161065980792046, 0.030342446640133858, -0.013927468098700047, -0.025963392108678818, -0.025302646681666374, -0.0037312658969312906, -0.010675566270947456, -0.009729794226586819, -0.0030154588166624308, -0.0009465820039622486, -0.044827014207839966, -0.018941355869174004, 0.010992983356118202, -0.0173737071454525, -0.037830889225006104, 0.017788290977478027, 0.01574127748608589, 0.024434609338641167, 0.0294614527374506, -0.023540660738945007, 0.0018381018890067935, 0.0025798205751925707, -0.017477352172136307, -0.01614290662109852, 0.004152328707277775, -0.030316535383462906, 0.015819013118743896, 0.004732100293040276, -0.008881189860403538, -0.018047407269477844, 0.02069038711488247, -0.010837513953447342, 0.002808166202157736, -0.010604309849441051, -0.006468175444751978, 0.02569131925702095, 0.009179173037409782, -0.02355361543595791, -0.016207685694098473, 0.007734603248536587, -0.008136232383549213, 0.024680769070982933, 0.02053491771221161, -0.033166807144880295, 0.0035790354013442993, 0.013059430755674839, 0.009749227203428745, 0.04702949523925781, -0.003051087260246277, 0.014108848758041859, -0.004414683673530817, 0.021687982603907585, 0.008699809201061726, -0.01846199296414852, -0.00328591070137918, 0.025484027341008186, 0.004197673872113228, 0.03005741909146309, -0.014601169154047966, -0.002200863789767027, -0.00884880032390356, 0.016389066353440285, 0.009179173037409782, 0.01488619577139616, 0.01979643851518631, -0.003164450405165553, 0.006879521533846855, 0.0219082310795784, -0.04290955886244774, -0.0065815383568406105, 0.004479462280869484, 0.0034786281175911427, 0.011984100565314293, -0.0438423752784729, 0.030860677361488342, -0.015391471795737743, 0.007941896095871925, 0.003987142816185951, -0.025626542046666145, -0.025730187073349953, 0.01785307005047798, -0.0028356972616165876, -0.025509938597679138, 0.018034452572464943, -0.04816960543394089, -0.0166481826454401, -0.00024838667013682425, 0.029409630224108696, -0.00634833425283432, -0.0014939638786017895, 0.005292437970638275, 0.01240516360849142, -0.011394612491130829, -0.016894342377781868, -0.0649343878030777, 0.01615586318075657, -0.004009815398603678, -0.030497916042804718, 0.01603926159441471, 0.011802718974649906, 0.0001338089641649276, 0.009885263629257679, 0.001225131331011653, -0.000758318230509758, -0.015171223320066929, -0.018941355869174004, 0.002555528422817588, 0.01629837602376938, -0.027155322954058647, 0.006639839615672827, 0.010785690508782864, 0.005567748099565506, 0.01645384542644024, -0.0023887227289378643, 0.012029445730149746, -0.019278207793831825, -0.01519713457673788, 0.0048357462510466576, 0.006170192267745733, -0.0058398195542395115, -0.010079599916934967, 0.010137900710105896, -0.022270992398262024, 0.002485891105607152, -0.025354469195008278, 0.000579366460442543, 0.023631351068615913, -0.0188895333558321, 0.013512883335351944, 0.0011886932188645005, -0.008045542053878307, 0.009477156214416027, -0.00991117488592863, -0.003857584670186043, -0.0019158365903422236, -0.005179074592888355, 0.015417383052408695, 0.014018158428370953, 0.01752917654812336, -0.01752917654812336, -0.035602495074272156, -0.005791235715150833, 0.032259903848171234, -0.0012178437318652868, -0.02566540800035, 0.007954851724207401, -0.014782549813389778, 0.0054479073733091354, -0.014264318160712719, 0.027258969843387604, -0.0009562988416291773, -0.012178436852991581, -0.022478286176919937, -0.002741767792031169, -0.005697306245565414, -0.003932080697268248, -0.010183246806263924, 0.0014882957329973578, -0.023605437949299812, -0.026688914746046066, 0.03184531629085541, 0.005797713529318571, -0.002413014881312847, -0.0010623743291944265, 0.02221916988492012, 0.02101428247988224, 0.004553958307951689, 0.015261913649737835, -0.0059790946543216705, 0.017438486218452454, -0.024538256227970123, -0.010675566270947456, 0.007553222123533487, 0.004926437046378851, -0.004612259101122618, 0.0016826324863359332, -0.012554154731333256, 0.028606371954083443, -0.022854004055261612, -0.0026186879258602858, 0.018371302634477615, -0.002233253326267004, 0.016246553510427475, 0.0139922471717, 0.01489915233105421, -0.02173980511724949, 0.022607844322919846, 0.018189921975135803, 0.027310792356729507, -0.0332963652908802, 0.005221181083470583, 0.02858046069741249, 0.006163714453577995, -0.03267448768019676, -0.00021458016999531537, -0.029694657772779465, 0.0013927468098700047, -0.014355008490383625, -0.01736075058579445, -0.0076244790107011795, 0.016285421326756477, -0.003203317755833268, -0.056435395032167435, 0.03202669695019722, -0.013279679231345654, -0.014277273789048195, 0.014082937501370907, 0.02101428247988224, 0.026688914746046066, -0.00845364946871996, -0.016052216291427612, 0.0036179027520120144, 0.022556019946932793, 0.011070718057453632, 0.008790499530732632, -0.044075578451156616, 0.0032276096753776073, 0.009263386018574238, -0.009775139391422272, 0.0012599499896168709, 0.01635020039975643, 0.018176965415477753, 0.029098691418766975, 0.056435395032167435, -0.004641409497708082, 0.015896746888756752, -0.034255094826221466, -0.022931737825274467, 0.004618736915290356, 0.03132708743214607, 0.016816608607769012, -0.03863414749503136, 0.017775336280465126, -0.014950974844396114, -0.0003374576917849481, -0.0347733236849308, 0.04925789311528206, 0.04039613530039787, -0.03314089775085449, 0.006442263722419739, 0.038323208689689636, 0.02234872803092003, -0.0030122199095785618, 0.023514747619628906, -0.012839182280004025, 0.018513815477490425, -0.01480846107006073, -0.018811799585819244, -0.02569131925702095, -0.01857859455049038, -0.029072780162096024, -0.017114590853452682, 0.026352064684033394, 0.012359818443655968, 0.016868431121110916, -0.0006834176019765437, 0.016414979472756386, -0.018164008855819702, 0.04772910848259926, -0.03140481933951378, 0.005642244126647711, 0.01646680198609829, -0.004385532811284065, -0.0423395037651062, -0.002809785772114992, 0.013305590488016605, 0.018695196136832237, 0.03674260526895523, 0.0011044805869460106, -0.03308907151222229, 0.00892653502523899, -0.03207852318882942, -0.0211697518825531, -0.026326153427362442, 0.002408156404271722, -0.04368690401315689, 0.003676203778013587, 0.021947098895907402, 0.0021927664056420326, 0.008835844695568085, -0.01724414899945259, -0.006419591140002012, 0.007922462187707424, 0.05073485150933266, -0.03111979365348816, 0.053585123270750046, 0.01724414899945259, 0.010487707331776619, 0.006247926969081163, 0.002560386899858713, 0.0036988763604313135, -0.015637632459402084, -0.025341514497995377, 0.02339814603328705, 0.0013231094926595688, 0.016402022913098335, -0.0016793935792520642, 0.03946331888437271, -0.012754969298839569, 0.013953379355370998, -0.0008279556059278548, 0.03837503120303154, 0.030316535383462906, 0.004696471616625786, -0.022633755579590797, -0.008343525230884552, -0.006409874185919762, 0.0003447453200351447, 0.015145312063395977, -0.019394809380173683, 0.002753104083240032, 0.026416843757033348, 0.02192118763923645, -0.007255238946527243, -0.004515090957283974, 0.013247289694845676, 0.023242676630616188, -0.040862541645765305, 0.003928841557353735, 0.0025474310386925936, -0.0038090005982667208, -0.03251902014017105, -0.03897099941968918, 0.0005494062206707895, -0.010967071168124676, 0.0022947932593524456, -0.013001129031181335, -0.0015935614937916398, 0.038763705641031265, 0.015002798289060593, -0.009943564422428608, 0.012709624134004116, 0.019109781831502914, 0.02431800775229931, 0.010215635411441326, -0.034747414290905, -0.01904500275850296, 0.01313716545701027, -0.0039385585114359856, -0.010150857269763947, 0.03238946199417114, 0.009742749854922295, 0.015015753917396069, -0.014640036039054394, 0.0008793738670647144, -0.005072189494967461, -0.009716838598251343, -0.0030348924919962883, -0.014665947295725346, 0.03435873985290527, 0.00010258349357172847, 0.022115522995591164, -0.025807922706007957, -0.01875997520983219, -0.008732198737561703, -0.014717770740389824, 0.014303185977041721, 0.0017409335123375058, 0.022750357165932655, -0.033633217215538025, -0.007229327689856291, -0.008466605097055435, 0.004806595854461193, 0.020288757979869843, -0.005166118964552879, 0.014614124782383442, 0.008479560725390911]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" probabilistic extension of best-of- Kdecoding
methods. Mudgal et al. (2023) propose a K-way arg max
decoding scheme based on ‘prefix scorers’ ψtlearned us-
ing Eq. (13), but also consider using these twists as logits
for softmax sampling in the proposal. However, neither
of these decoding schemes are aligned with our proposed
SMC framework, as we discuss in detail in App. D. For
example, greedy arg max decoding with respect to the op-
timal twists in Prop. 3.2 does not yield samples from the
target distribution σ(s1:T).
Finally, RL-based methods such as PPO maintain both a
policy or proposal network and value network or advantage
estimator during training. From the soft RLperspective in
Sec. 3.4 and App. B.3, the soft values play a similar role as
our twist functions for SMC resampling. Liu et al. (2023)
consider using Monte Carlo Tree Search (MCTS) based on
PPO value estimates to improve decoding, while Chaffin
et al. (2022) consider discriminator-driven MCTS.
7. Experiments
We now illustrate empirically how our framework can be
used to evaluate inference through logZσbounds and KL
divergences between the sampling and target distributions,
providing meaningful quantitative comparison between vari-
ous learning methods. We consider a range of tasks through-
out this section, including toxic story generation (as an
example of uncovering rare undesirable behavior), gen-
erating reviews with varied sentiment, and infilling. For
the toxicity and infilling tasks, we consider the TinySto-
ries model (Eldan & Li, 2023)4as a small-scale model
where the generation is coherent, and use the prompt of
‘Once upon a time, there was a’. For the toxicity task,
we elicit responses judged to be toxic by the classifier
from Corr ˆea (2023)5. For the sentiment task, we con-
sider the GPT2-Medium6model and a classifier trained
on Amazon reviews.7Our code is available at https:
//github.com/Silent-Zebra/twisted-smc-lm .
7.1. Comparing SIS and SMC for logZσEstimation
We first use our logZσbounds to test how twisted SMC
can improve upon SISand efficiently sample rare events.
We consider the task of toxic story generation. The target
is defined as σ(s1:T)∝p0(s1:T)I[s1:T∈ C]where C:=
{s1:T|r(s1:T)≤η},r(s1:T)is the non-toxic logit, and the
threshold η=−5corresponds to a greater than 99% chance
of being toxic. Rejection sampling under p0yields exact
4https://huggingface.co/roneneldan/TinyStories-33M
5https://huggingface.co/nicholasKluge/ToxicityModel
6https://huggingface.co/gpt2-medium
7https://huggingface.co/LiYuan/amazon-review-sentiment-analysis
4 8 16 32 128 512 2048
Number of Samples35
30
25
20
15
10
5
0Log Z BoundSIS/IWAE UB (q Proposal)
SIS/IWAE LB (q Proposal)
SMC UB (q Proposal)
SMC LB (q Proposal)
SIS/IWAE UB (p0 Proposal)
SIS/IWAE LB (p0 Proposal)
SMC UB (p0 Proposal)
SMC LB (p0 Proposal)
SMC ESS UB (p0 Proposal)
SMC ESS LB (p0 Proposal)Figure 3: Comparison of SIS (IWAE) and SMC bounds on logZσ
for base proposal p0and twist-induced proposal qπ, with twists
learned with CTL. With the twist-induced proposal, both SIS and
SMC bounds are tight; with the base proposal, resampling with
learned twists is needed. Resampling based on ESS instead of
every-step resampling yields similar results.
samples for logZσUB estimation, but can require hundreds
of thousands of samples. Thus, this setting also allows us to
test the effectiveness of approximate positive sampling for
twist training when target samples are rare.
Fig. 3 demonstrates that training twists with CTL and ap-
proximate positive sampling can significantly improve log
partition function estimation and sampling efficiency. We
first note that both upper and lower bounds tighten as K
increases,","[0.05678233876824379, 0.015741638839244843, 0.025355281308293343, 0.020183028653264046, -0.02129337750375271, 0.01894618570804596, 0.014631290920078754, -0.0007036301540210843, -0.03859512507915497, 0.01678171195089817, 0.04163101315498352, -0.0232048612087965, -0.04005684703588486, 0.034856487065553665, 0.05785052105784416, -0.024483870714902878, 0.013921511359512806, -0.008882781490683556, -0.0445263497531414, 0.010302340611815453, -0.016950370743870735, 0.006690196227282286, -0.011286192573606968, 0.02001436986029148, 0.016866041347384453, -0.021546367555856705, 0.035137586295604706, 0.0010435862932354212, 0.02414654940366745, -0.0052741514518857, 0.04036605730652809, -0.024863356724381447, -0.04508855193853378, -0.07196177542209625, -0.037948593497276306, 0.08522973209619522, -0.006402068305760622, 0.0208576712757349, -0.010042321868240833, -0.0006478492286987603, -0.00634233420714736, -0.03882000595331192, -0.03446294367313385, 0.016936317086219788, 0.02222101017832756, 0.03243901953101158, 0.014561016112565994, -0.016809821128845215, 0.003090350655838847, 0.01908673718571663, -0.044807448983192444, 0.04269919544458389, 0.01326795294880867, -0.027814913541078568, -0.007421058136969805, 0.0031869790982455015, -0.012136522680521011, 0.00453626224771142, 0.006546132266521454, -0.02789924293756485, 0.03910110518336296, -0.025425557047128677, 0.01554486807435751, 0.005242527928203344, -0.007709186524152756, -0.012319237925112247, -0.02119499258697033, 0.02906581200659275, -0.021672863513231277, 0.008376800455152988, 0.015207547694444656, 0.016247618943452835, 0.011792173609137535, 0.008749258704483509, -0.005506059620529413, 0.0015416615642607212, 0.01449074037373066, 0.04581941291689873, 0.007238342892378569, -0.04919262230396271, -0.004845472984015942, -0.0010321666486561298, 0.015305932611227036, -0.014673455618321896, -0.022670770063996315, -0.011946779675781727, 0.0011208889773115516, 0.004097042605280876, -0.04028172791004181, -0.012094357050955296, -0.0412655808031559, 0.012628448195755482, -0.020942000672221184, -0.0215744785964489, 0.03974763676524162, 0.013661493547260761, 0.02198207378387451, 0.005119546316564083, 0.03215792030096054, 0.03089296631515026, 0.037161510437726974, -0.0151232173666358, 0.0008459374075755477, -0.022192899137735367, 0.05560171604156494, 0.014729675836861134, 0.005460381042212248, 0.018088828772306442, -0.04365493729710579, -0.011960834264755249, 0.00010843239579116926, -0.034294284880161285, -0.07005029171705246, 0.051413316279649734, 0.015348097309470177, -0.06870100647211075, -0.04216510429978371, -0.008137864992022514, -0.0014634804101660848, 0.02625480480492115, -0.020548461005091667, 0.007891901768743992, 0.02011275477707386, 0.04365493729710579, 0.022769154980778694, -0.03263578936457634, 0.01964893750846386, -0.08742231130599976, 0.015052941627800465, 0.017639068886637688, 0.0020783881191164255, 0.00689399428665638, 0.02489146590232849, 0.004764656536281109, -0.016008684411644936, 0.01978948898613453, -0.011897586286067963, 0.025017961859703064, -0.011644596233963966, 0.006816691718995571, -0.027112161740660667, -0.03398507460951805, -0.01340850256383419, -0.0016338977729901671, -0.028377113863825798, -0.034209955483675, -0.030218323692679405, 0.01186244934797287, -0.025158511474728584, 0.03707718104124069, -0.027772748842835426, -0.029881002381443977, -0.04143424332141876, 0.01378798857331276, -0.019747324287891388, -0.045313432812690735, -0.03103351593017578, 0.036318209022283554, 0.019058626145124435, -0.04458256810903549, 0.024511979892849922, 0.05644501745700836, 0.006005013361573219, -0.0059523070231080055, -0.0034452404361218214, 0.0038405382074415684, -0.014244777150452137, 0.03721773251891136, -0.060324206948280334, -0.03980385884642601, 0.02292376197874546, -0.054083772003650665, -0.0063247657380998135, -0.03603710979223251, 0.009255239740014076, -0.03249523788690567, -0.0028057361487299204, -0.06139238923788071, -0.007143471390008926, 0.008109754882752895, -0.019044572487473488, 0.038567014038562775, -0.04753412678837776, 0.008946029469370842, -0.008116782642900944, 0.005175766535103321, -0.009409845806658268, 0.032523348927497864, 0.03766749054193497, -0.016093013808131218, -0.015151327475905418, 0.04281163588166237, 0.08522973209619522, -0.009669863618910313, -0.020829560235142708, -0.02222101017832756, 0.053184252232313156, 0.062010813504457474, 0.0010637904051691294, -0.009719056077301502, -0.01012665219604969, 0.02990911342203617, -0.017372023314237595, -0.0496986024081707, -0.013401475735008717, 0.0215604230761528, -0.024540090933442116, -0.006735875271260738, -0.06465315818786621, 0.03918543457984924, 0.03629009798169136, 0.006753444205969572, 0.07561608403921127, -0.0008661415195092559, -0.017217416316270828, 0.02545366808772087, -0.05402755364775658, 0.0006601474015042186, -0.010801293887197971, 0.08635412901639938, -0.00019720970885828137, 0.022024238482117653, 0.03558734804391861, 0.02555205300450325, -0.050991665571928024, 0.025214731693267822, 0.002428007312119007, -0.00784973707050085, 0.03544679656624794, -0.03207358717918396, 0.027688417583703995, 0.004388684406876564, -0.012642503716051579, -0.03224224969744682, -0.00865087378770113, -0.007266453001648188, -0.033310431987047195, 0.0019501360366120934, -0.007540525868535042, -0.0717368945479393, 0.026943501085042953, -0.003970547113567591, 0.02438548393547535, 0.002626534551382065, -0.014561016112565994, 0.029937222599983215, -0.011173752136528492, -0.0342380627989769, -0.008693038485944271, 0.007842709310352802, -0.022516164928674698, -0.007357810623943806, -0.019817598164081573, -0.027646252885460854, -0.05242528021335602, -0.021391762420535088, 0.005010619759559631, 0.01380907092243433, -0.019775433465838432, -0.011785146780312061, -0.005351454485207796, -0.014996721409261227, -0.0478152260184288, -0.01832776516675949, -0.0288409311324358, -0.02306431159377098, 0.005671206396073103, -0.013218759559094906, 0.054786525666713715, -0.023753007873892784, -0.030639974400401115, 0.0007826897199265659, 0.018833745270967484, 0.01146188098937273, 0.0012122467160224915, -0.06133617088198662, 0.005080895032733679, 0.04182778298854828, -0.042418092489242554, 0.025622328743338585, 0.01118077989667654, -0.047477904707193375, 0.04477933794260025, -0.02288159541785717, 0.006823719013482332, 0.025214731693267822, -0.0013598245568573475, 0.012719806283712387, 0.010021239519119263, -0.035756006836891174, 0.0035734924022108316, -0.009571478702127934, -0.0011850150767713785, -0.019185122102499008, 0.0210966058075428, 0.009220102801918983, 0.021391762420535088, 0.0008784396341070533, -0.0187494158744812, -0.006012041121721268, 0.0478152260184288, 0.019114846363663673, -0.004539776127785444, -0.02583315409719944, 0.053521569818258286, 0.006630462594330311, 0.036261990666389465, -0.004880610853433609, -0.02836306020617485, 0.0009460794972255826, -0.016093013808131218, -0.05307181179523468, -0.02934691123664379, 0.02940313145518303, -0.0014687511138617992, -0.027393262833356857, 0.07325483858585358, -0.04584752395749092, 0.012944687157869339, -0.03505325689911842, -0.019199177622795105, 0.00033622278715483844, -0.0022611035965383053, -0.04104069992899895, -0.017287692055106163, -0.030836746096611023, -0.015783803537487984, -0.01903051696717739, -0.00520387664437294, -0.01860886625945568, 0.022769154980778694, 0.01565730758011341, 0.04230565205216408, -6.385158485500142e-05, -0.012424650602042675, -0.057456981390714645, -0.005231986753642559, 0.036599308252334595, -0.010492083616554737, 0.0501764714717865, -0.08309336006641388, 0.014968611299991608, 0.0006228137062862515, -0.053240470588207245, 0.022192899137735367, 0.03297311067581177, 0.024975797161459923, 0.013851236552000046, 0.09619265794754028, 0.00980338640511036, 0.016050849109888077, -9.130281978286803e-05, 0.013450668193399906, 0.005477949511259794, 0.02836306020617485, 0.012902521528303623, -0.011897586286067963, -0.022628605365753174, -0.014448575675487518, -0.024399539455771446, -0.03581222891807556, -0.0011771090794354677, 0.038145363330841064, 0.008524378761649132, 0.04365493729710579, 0.02428709901869297, -0.03182059898972511, 0.011082394979894161, 0.009740138426423073, -0.005871490575373173, -0.010435863398015499, 0.00579067412763834, 0.019817598164081573, -0.010253147222101688, -0.023008091375231743, 0.011328358203172684, 0.004870069213211536, 0.031904928386211395, 0.03718962147831917, 0.0351656973361969, 0.01080832164734602, 0.024020053446292877, -0.009957991540431976, -0.026507794857025146, -0.005210903938859701, 0.0012280585942789912, 0.004241106566041708, 0.0014344919472932816, -0.033169880509376526, 0.02681700512766838, -0.021124716848134995, 0.0034909192472696304, -0.056894779205322266, 0.0064442334696650505, -0.013021989725530148, -0.007695131469517946, -0.022909706458449364, 0.03131461516022682, 0.046634603291749954, 0.06392229348421097, -0.057738080620765686, -0.009437955915927887, -0.08427398651838303, -0.014132336713373661, -0.04413280636072159, 0.025664493441581726, 0.03904488682746887, 0.007905957289040089, 0.021700972691178322, 0.029290691018104553, 0.047000035643577576, -0.03620576858520508, 0.026985665783286095, -0.030921075493097305, 0.02043602056801319, -0.032467130571603775, 0.00965580902993679, 0.017189307138323784, 0.026100199669599533, 0.07050005346536636, -0.03193303942680359, -0.04683137312531471, 0.0017384320963174105, -0.0030411581974476576, 0.00500359246507287, -0.014223694801330566, 0.017034702003002167, -0.02799762785434723, 0.0595371276140213, -0.022431835532188416, -0.006876425817608833, 0.07274885475635529, 0.053521569818258286, -0.04326139762997627, -0.04753412678837776, -0.022951871156692505, 0.029290691018104553, 0.015081051737070084, 0.004975482355803251, -0.04983915388584137, -0.020843615755438805, 0.009943936951458454, 0.00431489571928978, 0.0015522028552368283, 0.00332225882448256, 0.017596902325749397, -0.0047189779579639435, -0.02705594152212143, 0.0047822254709899426, -0.012178687378764153, 0.03848268464207649, -0.04379548877477646, 0.07190555334091187, -0.022024238482117653, -0.027885189279913902, -0.035756006836891174, 0.06740794330835342, -0.039916299283504486, 0.021546367555856705, -0.05273449048399925, 0.01884780079126358, 0.010843459516763687, -0.01148999109864235, 0.055067624896764755, 0.00935362558811903, 0.047000035643577576, -0.003893244545906782, 0.005492004565894604, 0.021700972691178322, 0.014996721409261227, 0.007512415759265423, -0.06656464189291, -0.012593311257660389, -0.008875754661858082, -0.00634233420714736, 0.005094950087368488, 0.08449886739253998, -0.05180685594677925, 0.02962801232933998, -0.004694381728768349, 0.011419715359807014, -0.00940281804651022, 0.040675271302461624, 0.03943842649459839, 0.025439612567424774, 0.03817347437143326, 0.015460537746548653, -0.021630698814988136, -0.019199177622795105, 0.009388763457536697, -0.0313989482820034, -0.03586844727396965, 0.02789924293756485, -0.01621950976550579, 0.03733017295598984, -0.03769560158252716, 0.009079552255570889, 0.0037772904615849257, -0.029740452766418457, -0.01160243060439825, 0.022164789959788322, -0.002796951914206147, 0.002424493432044983, 0.034912705421447754, 0.012178687378764153, 0.0017401889199391007, 0.013570135459303856, -0.014785896055400372, 0.011440797708928585, 0.0274354275316, -0.004290299490094185, 0.006525049917399883, -0.008411938324570656, 0.012888466939330101, 0.005084408912807703, 0.007118875160813332, -0.015685418620705605, -0.024413594976067543, -0.0024490896612405777, 0.029571792110800743, 0.02701377682387829, -0.02508823573589325, -0.04106881096959114, -0.013443640433251858, 0.02254427596926689, -0.04182778298854828, -0.011707843281328678, -0.12334698438644409, -0.04073148965835571, -0.03769560158252716, -0.0194521676748991, -0.03505325689911842, 0.0346878245472908, 0.04098448157310486, -0.03921354562044144, 0.012902521528303623, -0.03553112596273422, -0.020056534558534622, -0.00822922307997942, 0.015924353152513504, -0.006303682923316956, 0.0029849379789084196, 0.0010022995993494987, -0.004209483042359352, -0.0029111490584909916, -0.022066403180360794, 0.012691696174442768, -0.037583161145448685, -0.009248212911188602, -0.0026054519694298506, 0.022249119356274605, -0.041518572717905045, 0.020970111712813377, -0.034153733402490616, -0.011567293666303158, 0.010281257331371307, 0.0017120789270848036, 0.022333450615406036, -0.009037387557327747, 0.005277665331959724, 0.039831966161727905, -0.029037700966000557, 0.010070431977510452, -0.007371865678578615, -0.02151825837790966, -0.005959334783256054, 0.03769560158252716, 0.01655683107674122, 0.02747759222984314, 0.0642596185207367, -0.03994440659880638, -0.009255239740014076, 0.026760784909129143, -0.037723712623119354, 0.00162335648201406, -0.03789237141609192, 0.027590032666921616, -0.032888781279325485, -0.0013615814968943596, -0.021124716848134995, -0.035193804651498795, -0.03286067023873329, 0.021419871598482132, -0.020548461005091667, -0.036177657544612885, 0.02245994471013546, 0.01613518036901951, 0.0171049777418375, -0.007603773847222328, 0.0024315209593623877, 0.03763938322663307, 0.011672706343233585, 0.0028531718999147415, 0.00030196362058632076, -0.04233376309275627, 0.01017584465444088, 0.012860356830060482, -0.0222772303968668, -0.04056283086538315, -0.019859762862324715, 0.009719056077301502, 0.010168817825615406, -0.00411461153998971, -0.046578384935855865, -0.039129216223955154, 0.06549645960330963, -0.05304370075464249, 0.010449917986989021, 0.04618484154343605, 0.00979635864496231, 0.01870725117623806, 0.027069997042417526, -0.01792016811668873, -0.021602587774395943, -0.0011305517982691526, -0.03679608181118965, 0.03676797077059746, -0.011644596233963966, 0.058918703347444534, -0.019072681665420532, -0.009360653348267078, -0.04230565205216408, -0.010309367440640926, -0.005843380466103554, 0.012516007758677006, -0.0006162254139780998, -0.010766156017780304, -0.037583161145448685, 0.0036859328392893076, 0.018552646040916443, -0.03156760707497597, 0.015404317528009415, -0.01047802809625864, 0.027365151792764664, 0.01293765939772129, -0.028475500643253326, -0.014385327696800232, 0.018060719594359398, 0.00399865722283721, -0.0033152312971651554, 0.02536933682858944, 0.009852578863501549, -0.021391762420535088, -0.04809632897377014, -0.002204883610829711, -0.00652856333181262, -0.015362152829766273, 0.023977888748049736, -0.004954399541020393, -0.00508792232722044, -0.032101698219776154, -0.025622328743338585, 0.028447389602661133, -0.005558765958994627, 0.025776933878660202, -0.0002488180180080235, 0.03550301864743233, 0.0003496189892757684, -0.007828653790056705, -0.019044572487473488, -0.023654622957110405, 0.009965019300580025, -0.030358875170350075, 0.005477949511259794, 0.0040513635613024235, 0.028292784467339516, 0.019185122102499008, 0.02475091628730297, -0.006219352595508099, -0.014687511138617992, 0.00030767350108362734, 0.030696194618940353, 0.03727395087480545, -0.026718620210886, 0.0107802115380764, 0.024835245683789253, -0.014561016112565994, -0.035980887711048126, -0.003253740491345525, 0.01888996548950672, 0.005123060196638107, 0.002297998173162341, -0.04084393009543419, -0.025819098576903343, -0.012888466939330101, -0.003991629928350449, 0.019044572487473488, 0.002276915591210127, -0.013731768354773521, 0.007702158764004707, -0.023317301645874977, 0.015811914578080177, 0.016753600910305977, -0.021391762420535088, -0.021363653242588043, -0.030077774077653885, -0.02906581200659275, 0.04494800046086311, -0.00829949788749218, -0.0525096096098423, 0.0020871725864708424, 0.031961146742105484, -0.025425557047128677, -0.023359468206763268, -0.014589126221835613, -0.02874254621565342, -0.03004966303706169, 0.01720336265861988, 0.0384545736014843, -0.013422558084130287, 0.010182872414588928, 0.02508823573589325, -0.041237469762563705, 0.024132493883371353, -0.007863791659474373, -0.01373879611492157, 0.023036202415823936, -0.01551675796508789, 0.008798451162874699, -0.015868134796619415, -0.0496986024081707, -0.023879503831267357, -0.07629072666168213, -0.005899600684642792, -0.01571352779865265, 0.0014801708748564124, -0.03530624508857727, 0.009550396353006363, -0.014062061905860901, -0.01233329251408577, -0.00021115492563694715, 0.02546772174537182, 0.006922104395925999, -0.023696787655353546, -0.0323546901345253, 0.04269919544458389, -0.006683168932795525, 0.03347909078001976, -0.021082552149891853, 0.007171581499278545, 0.015924353152513504, -0.009950964711606503, -0.0365712009370327, 0.03266390040516853, 0.026086144149303436, 0.011173752136528492, 0.005210903938859701, 0.03038698434829712, -0.008503295481204987, -0.027210546657443047, -0.026423465460538864, 0.013830154202878475, -0.02785707823932171, 0.014870226383209229, 0.00013857385783921927, -0.011714871041476727, -0.011398633010685444, -0.006753444205969572, -0.0015460537979379296, 0.011398633010685444, 0.003717556595802307, 0.011026174761354923, -0.021785303950309753, 0.014167474582791328, -0.0166411604732275, 0.0015153083950281143, -0.030724305659532547, -0.020942000672221184, -0.01050613820552826, 0.023429742082953453, -0.01776556298136711, -0.012368430383503437, 0.0010901435744017363, 0.03333854302763939, 0.04792766645550728, -0.009838524274528027, 0.0014230721862986684, 0.000635990290902555, -0.003900272073224187, -0.0004040822386741638, 0.012649531476199627, -0.013253897428512573, -0.015811914578080177, -0.041096922010183334, -0.0356435663998127, -0.0482930988073349, -0.01585407927632332, -0.007217260077595711, -0.005899600684642792, -0.038510795682668686, -0.013942594639956951, 0.031061626970767975, 0.012424650602042675, -0.002009870018810034, -0.013239842839539051, 0.018735360354185104, -0.019564608111977577, -0.11941157281398773, -0.03305744007229805, 0.029375022277235985, 0.008988194167613983, 0.045453980565071106, -0.02396383322775364, 0.0024367915466427803, -0.014687511138617992, -0.027688417583703995, -0.02382328361272812, -0.012698723934590816, -0.029881002381443977, -0.010288285091519356, 0.0040232534520328045, 0.02476496994495392, -0.04612862318754196, -0.024455759674310684, -0.007090765051543713, -0.0063317930325865746, -0.01156026590615511, -0.004697895143181086, 0.024315210059285164, 0.026381298899650574, 0.04610051214694977, -0.009536340832710266, -0.0309491865336895, 0.007315645460039377, 0.0356435663998127, -0.020323580130934715, 0.015319987200200558, -0.00322914426214993, -0.004961427301168442, 0.024413594976067543, 0.01748446375131607, -0.01832776516675949, -0.017006590962409973, -0.007392948027700186, -0.0037316116504371166, -0.013549053110182285, -0.024835245683789253, 0.018355874344706535, -0.0342380627989769, 0.028953371569514275, -0.0048384456895291805, 0.0178077295422554, -0.04556642100214958, -0.004002171102911234, -0.012895493768155575, 0.004877096973359585, -0.02480713650584221, 0.006581269670277834, 0.010941844433546066, 0.01158134825527668, -0.0014265859499573708, -0.012649531476199627, -0.0006320373504422605, 0.016542775556445122, -0.010836431756615639, 0.003144813934341073, 0.04045039042830467, -0.026985665783286095, 0.020970111712813377, 0.048742860555648804, -0.02394977957010269, -0.0627978965640068, -0.015404317528009415, -0.04379548877477646, -0.023893559351563454, 0.028897151350975037, -0.00794812198728323, -0.005987444892525673, 0.01796233467757702, -0.0005125695606693625, 0.006261517759412527, 0.0040794736705720425, -0.001909727812744677, -0.0007036301540210843, 0.03089296631515026, -0.043064624071121216, 0.019157011061906815, 0.037442613393068314, -0.0374988317489624, 0.04716869443655014, 0.0010629119351506233, -0.010449917986989021, 0.01908673718571663, -0.008109754882752895, 0.020140863955020905, -0.027491647750139236, 0.06465315818786621, 0.03741450235247612, -0.012143549509346485, 0.01824343390762806, -0.017386076971888542, 0.002406924730166793, -0.020759286358952522, -0.0004980752710253, 0.023781118914484978, 0.01411125436425209, 0.03879189491271973, 0.026043979451060295, 0.02007059007883072, -0.006345848087221384, -0.03370397165417671, 0.01416044682264328, 0.03853890299797058, -0.01650061085820198, 0.02513040229678154, 0.01080832164734602, 0.006788581609725952, -0.004230565391480923, -0.008861699141561985, -0.04435768723487854, -0.021166881546378136, -0.005843380466103554, 0.0171049777418375, 0.05692289024591446, 0.014757785946130753, 0.038370244204998016, 0.0031623828690499067, 0.01151107344776392, 0.017737453803420067, -0.02559421770274639, 0.013584190979599953, -0.011876503936946392, 0.013064154423773289, 0.007048599887639284, -0.003401318332180381, -0.008011369965970516, -0.0007537011988461018, 0.029599903151392937, -0.011222944594919682, 0.05116032436490059, -0.023008091375231743, -0.012459788471460342, 0.028756599873304367, 0.0144204655662179, -0.004785739351063967, -0.027604088187217712, 0.029150141403079033, -0.012277072295546532, -0.010028267279267311, 0.027351096272468567, 0.04961427301168442, 0.0036578227300196886, -0.02990911342203617, 0.0030306167900562286, -0.029459351673722267, -0.009100634604692459, 0.0012500196462497115, 0.010632633231580257, -0.0007326186751015484, -0.008756286464631557, 0.0030183186754584312, 0.004205969162285328, 0.0027793829794973135, -0.0048384456895291805, -0.020478185266256332, -0.012881439179182053, -0.01762501336634159, 0.02517256699502468, 0.04326139762997627, 0.007185636553913355, -0.005910141859203577, -0.031061626970767975, -0.002489497885107994, -0.02687322534620762, -0.006834260653704405, -0.008686011657118797, 0.015910299494862556, -0.003418887034058571, -0.06976918876171112, 0.016514666378498077, 0.019142957404255867, 0.015305932611227036, 0.025608273223042488, -0.007259425241500139, 0.002728433581069112, -6.709082663292065e-05, 0.02035168930888176, 0.012298155575990677, 0.012874411419034004, -0.03297311067581177, 0.017456352710723877, 0.0426710844039917, -0.030499424785375595, 0.01005637738853693, 0.016472499817609787, -0.02808195911347866, 0.012108412571251392, -0.02418871410191059, 0.0239076130092144, -0.014279915019869804, 0.05377456173300743, 0.0021275808103382587, 0.011335385031998158, -0.021124716848134995, 0.014237750321626663, -0.008081644773483276, -0.027449483051896095, -0.019845709204673767, 0.032607678323984146, 0.027365151792764664, -0.010316395200788975, -0.017667178064584732, 0.023710843175649643, -0.032607678323984146, 0.011033201590180397, -0.00979635864496231, 0.0014933474594727159, -0.0017410673899576068, -0.006595324724912643, -0.008622763678431511, 0.04106881096959114, -0.017189307138323784, -0.025566108524799347, 0.03606521710753441, 0.0011815013131126761, -0.043907929211854935, -0.018060719594359398, -0.03128650784492493, -0.017751509323716164, 0.0061561050824820995, 0.024273045361042023, -0.0342380627989769, 0.010288285091519356, 0.03033076412975788, -0.0065355910919606686, 0.0005226716166362166, -0.001448547001928091, 0.002443819073960185, 0.007863791659474373, -0.01987381838262081, -0.01575569435954094, -0.02189774438738823, -0.0027530298102647066, -0.024919576942920685, -0.017878003418445587, 0.0024385484866797924, -0.00485250074416399, -0.0037140429485589266, -0.025003906339406967, -0.0222772303968668, -0.010604523122310638, 0.005456867162138224, 0.003227387322112918, 0.040337949991226196, 0.015741638839244843, -0.03249523788690567, -0.04598807170987129, -0.03685230016708374, 0.018580755218863487, 0.04491988942027092, -0.02522878721356392, 0.014884281903505325, -2.1034511519246735e-06, -0.012038136832416058, 0.04899584874510765, 0.056894779205322266, 0.015348097309470177, -0.021490147337317467, 0.0005578091950155795, -0.03125839680433273, -0.017498517408967018, 0.007533498574048281, -0.013260925188660622, 0.029656123369932175, 0.005305775441229343, -0.04416091740131378, -0.01526376698166132, -0.028377113863825798, -0.013731768354773521, -0.0019782460294663906, 0.05248149856925011, -0.0026845114771276712, -0.012530063278973103, 0.0010910220444202423, -0.020183028653264046, 0.0017410673899576068, 0.009810414165258408, -0.025481777265667915, -0.012530063278973103, -0.01599462889134884, -0.03671174868941307, 0.028869040310382843, -0.007491333410143852, 0.007203205022960901, -0.003872161963954568, 0.0009469579672440886, 0.009950964711606503, 0.04885530099272728, 0.03398507460951805, -0.027168381959199905, -0.003503217361867428, -0.024933630600571632, 0.010702908970415592, 0.01303604431450367, 0.026521850377321243, 0.025537997484207153, 0.0021890716161578894, -0.020225195214152336, 0.020829560235142708, -0.011321330443024635, 0.01003529503941536, 0.011019147001206875, 0.015404317528009415, 0.004061904735863209, 0.021504202857613564, -0.024821190163493156, -0.011237000115215778, -0.02846144512295723, 0.0007638032548129559, 0.004441390745341778, 0.03665553033351898, 0.027168381959199905, -0.006834260653704405, 0.018215324729681015, 0.005622013937681913, 0.013837181031703949, -0.0014327351236715913, -0.026802951470017433, -0.019424058496952057, 0.020562514662742615, 0.004473014734685421, -0.03586844727396965, 0.013752851635217667, 9.695777407614514e-05, -0.026198584586381912, -0.0029814240988343954, 0.033310431987047195, 0.00359808886423707, 0.025102291256189346, -0.01561514288187027, -0.017779618501663208, -0.005277665331959724, 0.02428709901869297, 0.0010471000568941236, -0.012530063278973103, -0.025397447869181633, -0.010534248314797878, 0.022909706458449364, 0.006303682923316956, -0.01740013249218464, -0.02372489869594574, 0.011553238146007061, -0.0032959056552499533, -0.006609379779547453, -0.0013984759571030736, -0.0036753914318978786, -0.005186307709664106, 0.08410532772541046, -0.0005007106228731573, -0.018636975437402725, 0.0020854156464338303, 0.008088672533631325, 0.020942000672221184, -0.03266390040516853, 0.004241106566041708, -0.034772153943777084, 0.01894618570804596, -0.008376800455152988, 0.042980294674634933, -0.012958741746842861, -0.0020344662480056286, 0.01364041119813919, -0.001235086121596396, -0.027843022719025612, 0.019747324287891388, 0.002176773501560092, -0.020379800349473953, 0.006510994862765074, 0.007329700514674187, -0.019395947456359863, 0.00898116733878851, -0.011693788692355156, 3.829447905445704e-06, -0.009536340832710266, 0.024258989840745926, -0.007477278355509043, -0.008440048433840275, 0.011742981150746346, -0.013872318901121616, -0.036739859730005264, -0.013661493547260761, 0.017076866701245308, -0.027463536709547043, -0.03536246716976166, 0.034209955483675, 0.0065918113104999065, 0.011152669787406921, 0.018159104511141777, -0.007294563110917807, 0.01978948898613453, 0.005446325987577438, -0.01959271728992462, 0.01697848178446293, 0.005643096286803484, -0.02476496994495392, 0.00232610828243196, 0.01375987846404314, -0.004191914107650518, -0.016247618943452835, 0.004638161510229111, -0.01336633786559105, 0.01368960365653038, -0.014631290920078754, 0.003717556595802307, 0.03463160619139671, 0.0210966058075428, -0.034434832632541656, -0.0302464347332716, 0.013506888411939144, 0.004177859053015709, 0.03685230016708374, 0.02761814184486866, -0.023977888748049736, 0.008285442367196083, 0.02920636162161827, 0.025439612567424774, 0.038567014038562775, -0.016936317086219788, 0.011187807656824589, 0.009669863618910313, 0.007674048654735088, -0.00012836199312005192, -0.009557423181831837, 0.008538433350622654, 0.04402036964893341, 0.007399975787848234, 0.03412562236189842, -0.013043072074651718, -0.0021152826957404613, -0.006430178415030241, 0.006595324724912643, -1.3066789506410714e-05, 0.02874254621565342, 0.03412562236189842, -0.003044671844691038, -0.01890402100980282, 0.009346597827970982, -0.038510795682668686, 0.005836353171616793, 0.02456820011138916, -2.6723781047621742e-05, 0.005112518556416035, -0.03578411787748337, 0.021166881546378136, -0.01080832164734602, 0.02418871410191059, -0.005105491261929274, -0.018299654126167297, -0.03957897797226906, 0.020646845921874046, 0.00721023278310895, -0.01203110907226801, 0.009986101649701595, -0.0539151132106781, -0.02264266088604927, 0.031961146742105484, 0.03943842649459839, -0.009170910343527794, -0.010112597607076168, 0.01818721368908882, 0.026058033108711243, -0.007329700514674187, 0.012944687157869339, -0.04702814668416977, 0.01740013249218464, -0.02171502821147442, -0.020239248871803284, -0.006110426038503647, 0.015010776929557323, 0.007912984117865562, -0.0003388581098988652, 0.010906706564128399, -0.001771812792867422, -0.03404129296541214, -0.02920636162161827, 0.007688103709369898, 0.02171502821147442, -0.005151170305907726, 0.005857435520738363, -0.00042845893767662346, -0.006567215081304312, 0.01645844615995884, -0.002055548829957843, 0.002552745630964637, 0.0048103355802595615, -0.021700972691178322, 0.014448575675487518, 0.001235964591614902, -0.013401475735008717, -0.02269888110458851, 0.0017770833801478148, -0.021968018263578415, 0.014912392012774944, -0.01752662844955921, -0.01373879611492157, 0.020168974995613098, 0.006050692405551672, -0.005903114564716816, -0.016894150525331497, 0.002220695372670889, 0.03353531286120415, -0.0030481854919344187, 0.015376207418739796, 0.0044589596800506115, -0.015348097309470177, 0.01922728680074215, 0.01589624397456646, 0.007308617699891329, -0.034153733402490616, -0.018060719594359398, 0.010906706564128399, 0.01776556298136711, 9.349892206955701e-05, -0.01477184146642685, -0.010471000336110592, 0.0006263274699449539, -0.013549053110182285, -0.025537997484207153, 0.017976388335227966, 0.020520349964499474, -0.0360933281481266, -0.018594810739159584, -0.009817441925406456, 0.004248134326189756, 0.0063247657380998135, -0.027210546657443047, 0.008728176355361938, 0.007111847400665283, -0.03718962147831917, 0.03480026498436928, -0.0034171303268522024, -0.014364245347678661, -0.013113346882164478, 0.016936317086219788, 0.01047802809625864, 0.00759674608707428, 0.0025773418601602316, -0.01758284866809845, 0.009086580015718937, -0.0295436829328537, -0.007737296633422375, 0.014315052889287472, 0.00042209026287309825, -0.015038887038826942, -0.008390855975449085, -0.004673298913985491, 0.04458256810903549, -0.03550301864743233, 0.0018043150193989277, 0.019002405926585197, -0.010639660991728306, -0.00048665556823834777, 0.017090922221541405, -0.00015921719023026526, -0.015024831518530846, 0.01894618570804596, 0.0058609494008123875, 0.026367245241999626, -0.012094357050955296, 0.018454261124134064, 0.048742860555648804, 0.012466815300285816, -0.034013181924819946, -0.001134065561927855, -0.025285007432103157, -0.003392533864825964, 0.0027811399195343256, -0.000968918961007148, -0.0036824189592152834, 0.011764063499867916, 0.01188353169709444, -0.039354097098112106, 0.007041572127491236, -0.004898179322481155, -0.0023770576808601618, 0.011714871041476727, 0.016894150525331497, 0.02334541268646717, -0.006837774068117142, -0.02344379760324955, -0.014406410045921803, 0.01862291991710663, 0.005586876068264246, 0.02976856380701065, -0.04941749945282936, -0.01993003860116005, 0.005530655849725008, -0.031061626970767975, -0.002879525301977992, 0.005432270932942629, 0.010850486345589161, 0.016163289546966553, 0.06476560235023499, -0.00634233420714736, 0.01740013249218464, -0.02723865769803524, -0.022389668971300125, -0.00559038994833827, 0.039410315454006195, 0.012747916392982006, -0.038988664746284485, 0.017554737627506256, -0.028391169384121895, 0.006641003768891096, -0.02635318972170353, 0.04764656722545624, 0.026802951470017433, -0.03806103393435478, -0.0028391170781105757, 0.04005684703588486, 0.02503201551735401, 0.000849011936224997, 0.006690196227282286, -0.017357967793941498, -0.0050703538581728935, -0.018159104511141777, -0.024301154538989067, -0.012403568252921104, -0.0012886709300801158, -0.04576319083571434, 0.005678234156221151, 0.001771812792867422, 0.025847207754850388, 0.012396540492773056, -0.005263610277324915, 0.008545461110770702, -0.02035168930888176, 0.031623829156160355, -0.007392948027700186, -0.0029269608203321695, -0.005808243062347174, -0.013282007537782192, -0.033450983464717865, -0.008833589032292366, 0.013197677209973335, 0.008805478923022747, 0.016767656430602074, -0.0028900664765387774, -0.013612301088869572, 0.024371430277824402, -0.034209955483675, -0.009156854823231697, -0.03707718104124069, 0.010049349628388882, -0.04750601574778557, -0.008060562424361706, 0.004406253341585398, 0.01439235545694828, 0.0015390262706205249, -0.0017094435170292854, -0.005783646833151579, 0.025537997484207153, 0.03229846805334091, -0.02663429081439972, 0.04134991019964218, 0.00295331422239542, -0.0015267281560227275, 0.00045942392898723483, 0.012642503716051579, 0.002055548829957843, -0.013893401250243187, -0.008215167559683323, 0.038567014038562775, -0.0039846021682024, 0.02892526052892208, -0.004581941291689873, 0.03451916575431824, -0.003735125297680497, 0.010239092633128166, -0.004195427987724543, 0.032326579093933105, 0.03789237141609192, -0.006054206285625696, -0.01917106658220291, -0.009044414386153221, 0.0022347504273056984, -0.014048007316887379, 0.025285007432103157, -0.019381891936063766, 0.018693195655941963, 0.03038698434829712, 0.009690945968031883, -0.007357810623943806, 0.0025334199890494347, 0.011265110224485397, 0.017315803095698357, -0.04955805093050003, -0.0021873146761208773, 0.028166288509964943, -0.01589624397456646, -0.018173160031437874, -0.02129337750375271, 0.011834339238703251, 0.007055627182126045, 0.010281257331371307, -0.023921668529510498, -0.004040822386741638, 0.02757597714662552, 0.03361964225769043, -0.0017024161061272025, 0.022656716406345367, 0.011974889785051346, 0.015572978183627129, 0.012839273549616337, -0.0356154590845108, -0.032326579093933105, 0.011272137984633446, -0.012930631637573242, -0.019283507019281387, 0.03137083724141121, 0.014504795894026756, 0.00042560402653180063, -0.020562514662742615, 0.022726990282535553, -0.014687511138617992, 0.012649531476199627, -0.0100774597376585, -0.020281415432691574, 0.048321209847927094, -0.013443640433251858, 0.01022503711283207, -0.0178077295422554, -0.025299062952399254, -0.022403724491596222, -0.013907456770539284, 0.020801451057195663, 0.0002589200739748776, 0.023893559351563454, -0.017357967793941498, -0.003192249685525894, -0.010969954542815685, 0.005235500168055296, 0.012445732951164246, 0.0019501360366120934, 0.010449917986989021, -0.00540416082367301]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" as expected, for both SISandSMC . Using p0as
proposal, the SISLB (orange) generally fails to draw any
samples meeting the threshold. By contrast, SMC resam-
pling (red) with p0proposal eventually achieves tightlogZσ
upper and lower bounds, yielding near-exact target samples
(small KL divergence between the distribution over samples
and the target distribution) by the reasoning in Sec. 5.
However, both SMC andSISwith the twist-induced pro-
posal achieve tight estimation and near-exact sampling of
the target toxic outputs with orders of magnitude lower K.
Resampling does not appear to help or hurt these bounds, as
the effect of the twists has been incorporated in the proposal
qπin Eq. (15). Thus, we conclude that using the twist-
induced proposal can provide significant efficiency gains
over base model sampling.
7.2. Evaluating Twist-Induced or Variational Proposals
We next leverage our logZσbounds to evaluate single-
sample inference using DKL(q∥σ)andDKL(σ∥q), as in
Sec. 5.1. Across settings, we consider two SIS proposal-
learning methods: PPO (Schulman et al., 2017) which min-
imizes DKL(q∥σ)during optimization, and distributional
policy gradient ( DPG ), which minimizes DKL(σ∥q)(Par-
shakova et al., 2019) (see App. E).
9
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Proposal qTwist Learning DKL(q∥σ) DKL(σ∥q)
Twisted Contrastive 1.11±0.05 1.07±0.02
Twisted RL 1.52±0.09 1 .42±0.03
Twisted SIXO 1.71±0.06 1 .98±0.04
Twisted FUDGE 3.24±0.26 2 .00±0.13
DPG – 1.09±0.05 1 .12±0.03
PPO – 0.98±0.01 1.32±0.04
Table 2: Toxicity (Sec. 7.2.1)Proposal qTwist Learning DKL(q∥σ) DKL(σ∥q)
Twisted Contrastive 0.55±0.03 0 .47±0.01
Twisted RL 0.94±0.04 0 .81±0.02
Twisted SIXO 0.73±0.03 0 .59±0.02
Twisted FUDGE 1.01±0.07 0 .77±0.07
DPG – 0.72±0.04 0 .57±0.01
PPO – 1.04±0.31 0 .87±0.20
Table 3: Sentiment (Sec. 7.2.2)Proposal qoTTwist Learning EoT[DKL(qoT∥σoT)]EoT[DKL(σoT∥qoT)]
Twisted Contrastive 23.93±0.34 8 .87±0.05
Twisted RL 31.35±2.33 14 .96±1.69
Twisted SIXO 20.34±0.36 7 .43±0.04
Twisted FUDGE 60.93±2.82 19 .85±0.51
DPG – 13.27±0.44 4 .90±0.03
PPO – 19.37±0.41 14 .07±0.50
Table 4: Infilling (Sec. 7.2.3)
Forward and reverse KL divergences between the SMC or variational proposal distributions and the true target σ.
We consider four twist learning methods, including CTL
andRLfrom Sec. 4, SIXO (Lawson et al., 2022), and
FUDGE (Yang & Klein, 2021) (see App. C). For each,
we measure KL divergences involving the twist-induced
proposal qπ. Thus, these experiments showcase two comple-
mentary applications of SMC : as a novel inference method
yielding a tractable qπ, and as an evaluation method for
any other inference method (such as PPO ) using K-sample
bounds on logZσto estimate the KL divergence.
7.2.1. G ENERATING TOX","[0.036858443170785904, 0.002827286021783948, 0.004152262583374977, 0.013142697513103485, -0.03284336254000664, 0.0069929324090480804, -0.010613196529448032, -0.028962116688489914, -0.041649769991636276, 0.008150613866746426, 0.05005467310547829, -0.029818667098879814, -0.028239401057362556, 0.03493120148777962, 0.057442422956228256, -0.0184559877961874, 0.022872576490044594, -0.0038210186176002026, -0.03734024986624718, 0.041515935212373734, -0.04207804799079895, -0.005440434440970421, -0.008056928403675556, 0.015257307328283787, 0.017559286206960678, -0.03284336254000664, 0.04472799971699715, -0.0006277746288105845, 0.02596418932080269, 0.00277877040207386, 0.0540965236723423, -0.02482658252120018, -0.04023110866546631, -0.08281773328781128, -0.029765132814645767, 0.08918832987546921, -0.012654196470975876, 0.04727088660001755, -0.015177005901932716, 0.0077223386615514755, 0.013604432344436646, -0.028801513835787773, -0.018683509901165962, 0.020396610721945763, 0.034984737634658813, 0.03455646336078644, 0.010887560434639454, -0.012547127902507782, -0.0010573045583441854, 0.023608675226569176, -0.01690348982810974, 0.03142469748854637, 0.010104619897902012, 0.00029506662394851446, -0.004593921825289726, 0.004841518122702837, 0.00659477012231946, 0.0016779692377895117, 0.021962491795420647, -0.043737612664699554, 0.04692291095852852, -0.018188316375017166, 0.022377382963895798, 0.006323752459138632, -0.007401132490485907, -0.01998171955347061, -0.015056553296744823, 0.03996343910694122, -0.020624130964279175, 0.0141598517075181, -0.007414516061544418, 0.011483130976557732, 0.017826959490776062, 0.0035366169176995754, -0.009803488850593567, 0.004644110333174467, -0.006109614856541157, 0.015765884891152382, -0.005253063980489969, -0.023073330521583557, -0.004774600267410278, -0.014521208591759205, 0.026927808299660683, -0.0054504722356796265, -0.011958248913288116, -0.034262023866176605, -0.03487766906619072, -0.009944017045199871, -0.05717474967241287, -0.007280679885298014, -0.046842608600854874, 0.01781357452273369, -0.011021397076547146, -0.012640812434256077, 0.03969576582312584, 0.018469370901584625, 0.02542884461581707, 0.0017381954239681363, 0.013530822470784187, 0.03985637053847313, 0.03423525393009186, -0.0176262054592371, -0.007568427361547947, 0.0022283699363470078, 0.07585825771093369, 0.016087090596556664, 0.017197929322719574, 0.00435301661491394, -0.014092933386564255, -0.013356835581362247, 0.01476211380213499, -0.026111409068107605, -0.052677858620882034, 0.05583639070391655, -0.0022116403561085463, -0.0636524111032486, -0.03637663275003433, -0.00329738506115973, -0.033057499676942825, 0.00633378978818655, -0.03573421761393547, -0.012092084623873234, 0.019954951480031013, 0.06820283830165863, 0.012386524118483067, -0.015417910180985928, 0.01822846755385399, -0.06461603194475174, 0.00555754080414772, 0.03538624569773674, -0.017840342596173286, 0.020236007869243622, 0.005580962169915438, 0.02939039096236229, 0.006159803364425898, 0.014052783139050007, 0.0028356509283185005, 0.024144019931554794, -0.015270690433681011, 0.0009728206205181777, -0.013470595702528954, -0.04264015704393387, -0.017492368817329407, 0.01023845560848713, 0.012105468660593033, -0.029095951467752457, -0.02165466919541359, 0.004232564475387335, 0.0030146564822643995, 0.04815420135855675, -0.04539718106389046, -0.026927808299660683, -0.04649463668465614, 0.024947036057710648, -0.019606977701187134, -0.05690708011388779, -0.03501150384545326, 0.03739378601312637, 0.013403678312897682, -0.03747408837080002, -0.002107917331159115, 0.03849124163389206, 0.01086079329252243, -0.007548351772129536, -0.019673895090818405, -0.010579737834632397, -0.014895949512720108, 0.024237705394625664, -0.05974440276622772, -0.04967993497848511, 0.02505410462617874, -0.03605542704463005, -0.008712725713849068, -0.03434232622385025, 0.013544205576181412, -0.027944961562752724, 0.0167428869754076, -0.08747522532939911, -0.004925165791064501, 0.023729126900434494, -0.01658228412270546, 0.056264664977788925, -0.01975419744849205, -0.010265223681926727, 0.013564281165599823, 0.011817721650004387, -0.011402829550206661, 0.018054479733109474, 0.04914458841085434, 0.012192461639642715, -0.0038946284912526608, 0.06081509217619896, 0.08720755577087402, 0.0003640758222900331, -0.018348919227719307, -0.02292611077427864, 0.05021527782082558, 0.06857758015394211, 0.010693498887121677, -0.003851131768897176, 0.00034190923906862736, 0.020062020048499107, -0.043175503611564636, -0.05722828581929207, -0.022658439353108406, 0.015297457575798035, -0.0012496939161792397, -0.001875377376563847, -0.07757136225700378, 0.029122719541192055, 0.026419231668114662, 0.011610275134444237, 0.06756042689085007, 0.017612820491194725, -0.021346846595406532, 0.0039013202767819166, -0.08046221733093262, -0.004640764091163874, -0.00200921343639493, 0.0808369591832161, 0.005590999964624643, 0.004115457646548748, 0.05294553190469742, 0.041301798075437546, -0.02704826183617115, 0.02077135071158409, -0.007468050345778465, -0.031852975487709045, 0.02577681839466095, -0.04138210043311119, 0.012466825544834137, 0.012058625929057598, -0.008364751935005188, -0.024050334468483925, -0.0026282048784196377, -0.016729503870010376, -0.02463921345770359, -0.005199529696255922, -0.026164943352341652, -0.0771966204047203, 0.023126864805817604, 0.008184073492884636, 0.030193407088518143, -0.016100473701953888, -0.0037005662452429533, 0.029443925246596336, 0.005079077091068029, -0.0016637491062283516, 0.008826485835015774, 0.013932330533862114, -0.031183794140815735, -0.006163149140775204, -0.021132709458470345, -0.0386250764131546, -0.051794543862342834, -0.036001890897750854, 0.0058419425040483475, 0.007046466693282127, -0.057442422956228256, 0.007360981311649084, 0.01485579926520586, -0.009903865866363049, -0.03535947948694229, 0.017545903101563454, -0.03396758437156677, 0.0063572111539542675, 0.0026817393954843283, 0.01025853119790554, 0.04400528594851494, -0.029256556183099747, -0.011161924339830875, 0.0031501655466854572, -0.010345525108277798, 0.01921885274350643, -0.0066014621406793594, -0.04352347552776337, 0.0015524979680776596, 0.04277399554848671, -0.01750575192272663, 0.040311411023139954, 0.019031483680009842, -0.05824543908238411, 0.02558944746851921, -0.016448447480797768, -0.003633648157119751, 0.02320716716349125, 0.008558813482522964, 0.025388693436980247, -0.005065693520009518, -0.04103412479162216, 0.020784735679626465, -0.007073233835399151, -0.0009560910984873772, -0.025094255805015564, 0.013524130918085575, 0.009375213645398617, 0.007073233835399151, -0.004460085649043322, 0.0033559384755790234, -0.01207870151847601, 0.04330933839082718, 0.010231764055788517, 0.0005729855038225651, -0.0034964662045240402, 0.03163883835077286, -0.006678417790681124, 0.04154270142316818, 0.008424977771937847, -0.022845810279250145, 0.008679266087710857, -0.016876723617315292, -0.041515935212373734, -0.019205469638109207, 0.03230801597237587, 0.003158530220389366, -0.027757592499256134, 0.061403967440128326, -0.01686333864927292, -0.0022936149034649134, -0.033432237803936005, -0.029095951467752457, -0.0009552546544000506, -0.007461358327418566, -0.018496138975024223, -0.01836230233311653, -0.0253351591527462, -0.00716691929847002, -0.010010934434831142, -0.011228842660784721, -0.012245996855199337, 0.030648449435830116, -0.007186994422227144, 0.026325546205043793, 0.004647456109523773, -0.02406371757388115, -0.04523657634854317, -0.0068155997432768345, 0.052329886704683304, -0.007642037235200405, 0.026325546205043793, -0.0926680639386177, 0.02510763891041279, 0.008311217650771141, -0.04946579411625862, 0.014721962623298168, 0.034288790076971054, 0.020744584500789642, 0.014360605739057064, 0.07682187855243683, 0.028801513835787773, 0.007307447027415037, -0.0086056562140584, 0.016823189333081245, 0.011483130976557732, 0.036858443170785904, 0.018255233764648438, -0.02815910056233406, -0.05439096316695213, -0.0361357256770134, -0.012245996855199337, -0.035466548055410385, -0.008578889071941376, 0.036858443170785904, 0.015043169260025024, 0.027918195351958275, 0.036671072244644165, -0.006263526156544685, -0.015993405133485794, 0.007561735343188047, -0.0045805382542312145, -0.0029343548230826855, 0.012580586597323418, 0.0021597789600491524, 0.0009937324794009328, -0.034609995782375336, -0.0028875123243778944, 0.016060322523117065, 0.024251088500022888, 0.048207737505435944, 0.03281659260392189, 0.011570124886929989, -0.007247220724821091, -0.014882566407322884, -0.01908501796424389, -0.006042696535587311, 0.003079901682212949, -0.011362678371369839, 0.0002386045380262658, -0.009381905198097229, 0.04349670931696892, 0.008177381008863449, -0.01604693941771984, -0.060386814177036285, 0.027864661067724228, -0.02042337693274021, -0.0040318104438483715, -0.017304997891187668, 0.0506703183054924, 0.028962116688489914, 0.06167164072394371, -0.06060095131397247, 0.0022936149034649134, -0.07130783796310425, -0.012754573486745358, -0.04898398742079735, 0.014373988844454288, 0.025254858657717705, 0.00991055741906166, 0.03351254016160965, 0.02628539502620697, 0.03643016517162323, -0.04708351567387581, 0.015765884891152382, -0.013798494823276997, 0.024625828489661217, -0.06381301581859589, 0.0343690924346447, 0.010499436408281326, 0.03865184634923935, 0.06964826583862305, -0.017224697396159172, -0.02188219130039215, 0.015872953459620476, -0.008244299329817295, 0.002355514094233513, -0.0033442277926951647, 0.04860924556851387, -0.0050255428068339825, 0.060226213186979294, -0.03683167323470116, -0.0071535357274115086, 0.05085768923163414, 0.050268810242414474, -0.024237705394625664, -0.04309520125389099, -0.04569162055850029, 0.01877719536423683, 0.0035299251321703196, -0.002012559212744236, -0.03386051580309868, -0.032040346413850784, 0.005527427885681391, 0.014895949512720108, -0.020088788121938705, -0.012232612818479538, 0.020075403153896332, -0.015685582533478737, -0.02955099567770958, -0.0049050902016460896, -0.02028954215347767, 0.010559662245213985, -0.01838907040655613, 0.072164386510849, -0.011918098665773869, -0.014735346660017967, -0.040819987654685974, 0.06434836238622665, -0.0253619272261858, 0.048716314136981964, -0.035975124686956406, 0.02149406634271145, 0.011710652150213718, -0.026071257889270782, 0.04660170525312424, 0.009375213645398617, 0.030782286077737808, 0.01852290704846382, 0.003193662269040942, 0.007548351772129536, 0.010934403166174889, -0.014922716654837132, -0.05931612849235535, -0.00427271518856287, -0.019459757953882217, -0.018442604690790176, 0.01982111483812332, 0.09400642663240433, -0.042185116559267044, 0.023006413131952286, 3.9157494029495865e-05, 0.014641661196947098, -0.0015683909878134727, 0.025924038141965866, 0.043710846453905106, 0.034262023866176605, 0.052999068051576614, 0.02285919338464737, -0.01857644133269787, -0.019553443416953087, -0.0014404102694243193, -0.016916872933506966, -0.05257079005241394, 0.0292030218988657, -0.015083320438861847, 0.0472441166639328, -0.021320078521966934, 0.01390556339174509, 0.026151560246944427, -0.019901417195796967, -0.022711973637342453, 0.03562714904546738, -0.011529973708093166, 0.002516117412596941, 0.03399435058236122, 0.03742055222392082, 0.028052031993865967, 0.03886598348617554, -0.016876723617315292, 0.014949483796954155, 0.03311103209853172, 0.006330444011837244, -0.004058577585965395, 0.004065269138664007, -0.005323328077793121, -0.009803488850593567, 0.01155674085021019, -0.03814326599240303, -0.02939039096236229, 0.0002507334284018725, 0.024786431342363358, 0.0071736108511686325, -0.012727806344628334, -0.04245278611779213, -0.018603207543492317, 0.02213647961616516, -0.022430917248129845, -0.006865788251161575, -0.1169191524386406, -0.03552008047699928, -0.05722828581929207, -0.0018954527331516147, -0.036644306033849716, 0.021333463490009308, 0.02591065503656864, -0.012861642055213451, 0.01192479021847248, -0.03196004405617714, -0.004326249472796917, -0.0015115105779841542, 0.00974995456635952, 0.005590999964624643, 0.015150237828493118, -0.003971584141254425, -0.0011233862023800611, 0.01616739295423031, -0.008103771135210991, 0.027195481583476067, -0.019553443416953087, -0.01130245253443718, 0.0029627950862050056, 0.01450782548636198, -0.02330085262656212, -0.007120076566934586, -0.034636761993169785, -0.0004876650345977396, 0.018255233764648438, -0.010278606787323952, 0.022885961458086967, -0.005002121441066265, 0.0002229206293122843, 0.04571838676929474, -0.028962116688489914, -0.014066166244447231, -0.01630122773349285, 0.002691777190193534, 0.009529124945402145, 0.04312196746468544, 0.0033576113637536764, 0.011663809418678284, 0.062474656850099564, -0.04780622944235802, -0.004540387075394392, 0.02000848576426506, -0.006307022646069527, 0.00015537526633124799, -0.030193407088518143, 0.025977572426199913, -0.023501606658101082, -0.010887560434639454, -0.0201958566904068, -0.023916497826576233, -0.021132709458470345, 0.017318380996584892, -0.03163883835077286, -0.031210562214255333, 0.031023191288113594, 0.015685582533478737, 0.013182848691940308, -0.006614845711737871, 0.006584732327610254, 0.0176262054592371, -0.001880396157503128, -0.0022835771087557077, -0.011523282155394554, -0.04400528594851494, -0.001545806066133082, 0.018937798216938972, -0.01035221666097641, -0.04229218512773514, -0.013517438434064388, 0.0072405291721224785, 0.017291614785790443, 0.010787183418869972, -0.051981911063194275, -0.03985637053847313, 0.06113629788160324, -0.0412750318646431, 0.0042660231702029705, 0.021828655153512955, -0.006025967188179493, 0.02850707434117794, 0.01949990913271904, -0.008391519077122211, -0.016983792185783386, -0.003034731838852167, -0.038384173065423965, 0.04191744327545166, -0.0072070700116455555, 0.05356117710471153, -0.027864661067724228, -0.011971632950007915, -0.04523657634854317, 0.0016645855503156781, -0.02267182245850563, 0.020128939300775528, 0.017920643091201782, -0.0014161524595692754, -0.03522564098238945, -0.02301979623734951, 0.02295287884771824, -0.04057908430695534, 0.002265174873173237, -0.004781292285770178, 0.022885961458086967, 0.007434591185301542, -0.00930829532444477, -0.017867108806967735, 0.004409897141158581, 0.010680114850401878, 0.00596239510923624, 0.019486526027321815, 0.007059850264340639, -0.01889764703810215, -0.04815420135855675, 0.02390311472117901, -0.015872953459620476, -0.020155705511569977, 0.030139872804284096, -0.017639588564634323, -0.013062396086752415, -0.04882338270545006, -0.019259003922343254, -0.0007611924083903432, -0.019633745774626732, 0.039080120623111725, -0.0021330115851014853, 0.02318039909005165, 0.0035767678637057543, -0.01287502609193325, -0.022337233647704124, -0.022377382963895798, 0.009729878976941109, -0.009214610792696476, 0.00010800985910464078, -0.0054872771725058556, 0.049572862684726715, 0.02251121960580349, 0.026164943352341652, 0.005815175361931324, -0.0072070700116455555, -0.008612348698079586, 0.029818667098879814, 0.03835740685462952, -0.02244430221617222, 0.013932330533862114, 0.029952503740787506, -0.013972480781376362, -0.060065608471632004, -0.004319557920098305, 0.03966899961233139, -0.004058577585965395, -4.428090323926881e-05, -0.04036494717001915, -0.01838907040655613, -0.006701839156448841, -0.0009937324794009328, 0.02704826183617115, 0.005082423333078623, -0.016662584617733955, 0.007046466693282127, -0.02767729014158249, 0.0015918122371658683, 0.03038077801465988, -0.038732144981622696, -0.025201324373483658, -0.030487846583127975, -0.02028954215347767, 0.04478153586387634, -0.004322903696447611, -0.04314873367547989, 0.006631575059145689, 0.022283699363470078, -0.03196004405617714, -0.031692370772361755, -0.025442229583859444, -0.022966261953115463, -0.028292935341596603, 0.027369467541575432, 0.041997745633125305, -0.0024207590613514185, 0.01029199082404375, 0.030835820361971855, -0.032896894961595535, 0.009214610792696476, -0.013524130918085575, -0.002174835419282317, 0.014829032123088837, 0.004142225254327059, 0.001962370704859495, -0.02387634664773941, -0.019392840564250946, -0.03284336254000664, -0.07987333834171295, -0.0176262054592371, 0.010981245897710323, 0.0034864284098148346, -0.056425269693136215, 0.0026332237757742405, -0.005514044314622879, -0.023140249773859978, 0.00160519580822438, 0.02936362475156784, -0.005681339185684919, -0.023983415216207504, -0.016274461522698402, 0.03281659260392189, 0.021159475669264793, 0.04839510843157768, -0.011911406181752682, -0.0029728326480835676, 0.028266169130802155, -0.02118624374270439, -0.036644306033849716, 0.033057499676942825, 0.04917135462164879, 0.015765884891152382, 0.012245996855199337, 0.0394548624753952, 0.005624459125101566, -0.022885961458086967, -0.02438492327928543, 0.01167050190269947, -0.009475590661168098, 0.013959097675979137, -0.013376911170780659, -0.017867108806967735, -0.004577192012220621, -0.00768218794837594, 0.002986216451972723, -0.005192837677896023, 0.01165042631328106, 0.008592273108661175, -0.004553770646452904, 0.02380942925810814, -0.022056177258491516, 0.010506127960979939, -0.023220550268888474, -0.009335062466561794, -0.02748991921544075, 0.008010086603462696, -0.013959097675979137, -0.004312865901738405, -0.003774175886064768, 0.02209632843732834, 0.06911292672157288, -0.0020159052219241858, -0.0126809636130929, 0.007347597740590572, -0.005714798346161842, 0.012781340628862381, 0.02070443332195282, -0.017077477648854256, -0.014052783139050007, -0.02514779008924961, -0.017385300248861313, -0.024612445384263992, -0.021574366837739944, -0.007889633998274803, -0.0031501655466854572, -0.015739116817712784, -0.0019489871338009834, 0.039615463465452194, -0.012346373870968819, 0.011643734760582447, -0.006788832601159811, 0.03129086270928383, -0.023608675226569176, -0.09935986995697021, -0.022752124816179276, 0.020744584500789642, 0.01829538494348526, 0.04400528594851494, -0.012379832565784454, 0.016501981765031815, -0.016635818406939507, -0.030862588435411453, -0.03396758437156677, -0.0024073754902929068, -0.027342699468135834, 0.009709803387522697, 0.008317909203469753, 0.017666354775428772, -0.04344317317008972, -0.01450782548636198, -0.0061765327118337154, -0.009020548313856125, 0.003449623705819249, 0.008866637013852596, 0.015444677323102951, 0.03198681026697159, 0.07029068470001221, -0.014092933386564255, -0.03262922167778015, 0.018081247806549072, 0.02765052393078804, -0.018603207543492317, 0.007113385014235973, -0.00920791830867529, -0.012634120881557465, 0.020731201395392418, 0.022752124816179276, -0.022283699363470078, -0.024144019931554794, -0.012105468660593033, -0.012011783197522163, -0.006688455585390329, -0.015230540186166763, 0.026057874783873558, -0.0403917133808136, 0.04909105598926544, 0.012500285170972347, 0.021012255921959877, -0.044915370643138885, 0.011596892029047012, -0.012266071513295174, 0.011168616823852062, -0.038919515907764435, 0.013698117807507515, 0.023100098595023155, 0.014829032123088837, -0.022377382963895798, -0.0033291711006313562, 0.03345900774002075, 0.02952422760426998, -0.0054839313961565495, -0.01873704418540001, 0.03434232622385025, -0.013136005960404873, 0.01741206645965576, 0.041997745633125305, -0.014133084565401077, -0.05706768110394478, -0.01132252812385559, -0.02140038087964058, -0.015806034207344055, -0.002951084403321147, -0.011315835639834404, -0.0030732096638530493, 0.0167428869754076, -0.00349981221370399, 0.006865788251161575, 0.00033981804153881967, -0.017425451427698135, 0.007749105803668499, 0.005142649170011282, -0.04352347552776337, 0.02767729014158249, 0.03999020531773567, -0.047324419021606445, 0.03155853599309921, 0.004309520125389099, 0.011309144087135792, 0.030461080372333527, -0.020222622901201248, 0.0023254009429365396, -0.037688225507736206, 0.05083092302083969, 0.027021493762731552, -0.028614142909646034, 0.007528276648372412, -0.03776852786540985, 0.010385675355792046, -0.008050236850976944, -0.01339698676019907, 0.019419606775045395, -0.007528276648372412, 0.021453915163874626, 0.0012137254234403372, 0.04108766093850136, -0.016113856807351112, -0.04660170525312424, 0.02181527204811573, 0.04649463668465614, -0.024906884878873825, 0.02413063496351242, 0.01130245253443718, 0.003680490655824542, -0.0002001266839215532, -0.01171734370291233, -0.03980283439159393, -0.023126864805817604, 0.007969935424625874, 0.020316308364272118, 0.05808483436703682, 0.008143922314047813, 0.03471706435084343, 0.011944865807890892, 0.02600434049963951, 0.01089425291866064, -0.030032804235816002, 0.02663336880505085, 0.0027185443323105574, -0.008779643103480339, -0.0024609100073575974, -0.002099552657455206, -0.001927238772623241, -0.01310923881828785, 0.014815648086369038, -0.017104243859648705, 0.024786431342363358, -0.015926487743854523, 0.002052710158750415, 0.03402111679315567, 0.038223568350076675, -0.013758343644440174, -0.025549298152327538, 0.03870537877082825, -0.0038143268320709467, 0.008143922314047813, 0.01899133250117302, 0.04780622944235802, 0.0158863365650177, -0.03038077801465988, 0.009535816498100758, -0.029658064246177673, 0.0053300196304917336, -0.026151560246944427, 0.030354011803865433, -0.012540435418486595, -0.004001697059720755, 0.00784948281943798, 0.001791729824617505, 0.007287371903657913, 0.005008813459426165, -0.01198501605540514, -0.021199626848101616, 0.011041472665965557, 0.02026277408003807, 0.030487846583127975, 0.0042091431096196175, -0.0038210186176002026, -0.005674647632986307, -0.003076555673032999, -0.02748991921544075, -0.015685582533478737, -0.009328370913863182, 0.03610895946621895, 0.017572671175003052, -0.03883921355009079, 0.007648728787899017, 0.013028937391936779, 0.017104243859648705, 0.020062020048499107, -0.014721962623298168, 0.005570924840867519, 0.011690576560795307, 0.006286947522312403, 0.014534592628479004, 0.013771726749837399, -0.03897305205464363, 0.0107202660292387, 0.04306843504309654, -0.03800943121314049, 0.010452593676745892, 0.025214707478880882, -0.018148165196180344, 0.022176628932356834, -0.01690348982810974, 0.036510467529296875, -0.024050334468483925, 0.03439585864543915, 0.0016143970424309373, 0.02922978810966015, -0.027516687288880348, 0.02225693129003048, -0.0021129362285137177, -0.04170330613851547, -0.02663336880505085, 0.03450292721390724, 0.015431294217705727, -0.02318039909005165, 0.005132611840963364, 0.01820169948041439, -0.04341640695929527, 0.019071632996201515, -0.00573152769356966, 0.003377686720341444, 0.0005754948942922056, 0.00786286685615778, -0.013136005960404873, 0.024880116805434227, -0.006347173359245062, -0.03643016517162323, 0.03849124163389206, 0.0002973669325001538, -0.04379114881157875, -0.0016930256970226765, -0.020490296185016632, -0.013932330533862114, -0.009696420282125473, 0.011871255934238434, -0.04073968529701233, -0.013176157139241695, 0.04344317317008972, -0.005661264061927795, -0.012754573486745358, -0.005423705093562603, 0.008511971682310104, 0.02241753414273262, -0.005276485346257687, -0.007447974756360054, -0.014400756917893887, -0.01165042631328106, -0.022966261953115463, -0.013918946497142315, -0.0016361454036086798, -0.00966965314000845, -0.02301979623734951, -0.011141849681735039, 0.0002841924433596432, 0.0032120647374540567, -0.014802264980971813, -0.002864090958610177, 0.0428810641169548, 0.011456363834440708, -0.02558944746851921, -0.03974929824471474, -0.04446032643318176, 0.02628539502620697, 0.026941191405057907, -0.004189067520201206, 0.005771678872406483, -0.011255609802901745, -0.01284156646579504, 0.048689547926187515, 0.04673554003238678, 0.012948635965585709, -0.009328370913863182, -0.0023688976652920246, -0.024425074458122253, -0.014481058344244957, -0.0010422480991110206, -0.012834874913096428, 0.040284644812345505, -0.002691777190193534, -0.02922978810966015, -0.010740341618657112, -0.019285771995782852, -0.0124467508867383, -0.011355986818671227, 0.05479247123003006, -0.01295532751828432, -0.002019250998273492, 0.030996423214673996, -0.02045014500617981, -0.0026767204981297255, 0.02936362475156784, -0.030782286077737808, -0.018911030143499374, -0.027864661067724228, -0.036858443170785904, 0.030675217509269714, 0.006220029201358557, 0.009823564440011978, -0.0012296184431761503, -0.011757494881749153, 0.006557965185493231, 0.037741757929325104, 0.043041665107011795, -0.03493120148777962, -0.009127616882324219, -0.0011660463642328978, 0.007260604295879602, -0.0038310561794787645, 0.04280076175928116, 0.0017072458285838366, -0.0006348846363835037, -0.0026365697849541903, 0.049198124557733536, -0.020463528111577034, 0.022805659100413322, 0.0033994351979345083, 0.003851131768897176, 0.0010230091866105795, 0.013069087639451027, -0.023327618837356567, -0.021386997774243355, -0.0065345438197255135, 0.0011409521102905273, -0.005504006519913673, 0.0335393100976944, 0.014655045233666897, 0.014561359770596027, 0.00200586742721498, 0.013892179355025291, 0.007233837153762579, 0.0014194983523339033, -0.02904241718351841, -0.017131011933088303, 0.02505410462617874, -0.006099577061831951, -0.03755439072847366, -0.0008051073527894914, 0.004486852791160345, -0.016381530091166496, -0.013744959607720375, 0.02086503617465496, 0.0017089187167584896, 0.04826126992702484, -0.014949483796954155, -0.03734024986624718, -0.007795948535203934, 0.012895100750029087, -0.008110463619232178, 0.012500285170972347, -0.028480306267738342, -0.024491993710398674, 0.021708203479647636, 0.0126675795763731, -0.025295009836554527, -0.020811501890420914, 0.015899719670414925, -0.01052620355039835, 0.0006683436804451048, 0.006290293298661709, 0.007120076566934586, -0.016033556312322617, 0.08287126570940018, 0.007996702566742897, -0.011951557360589504, 0.0031518384348601103, 0.00032078824006021023, 0.023033179342746735, -0.03386051580309868, -0.0016344725154340267, -0.0361357256770134, 0.018536290153861046, -0.0030648449901491404, 0.03560038283467293, 0.013718192465603352, 0.01147643942385912, 0.010071161203086376, 0.010044394060969353, -0.015524978749454021, 0.005922244396060705, -0.0022116403561085463, 0.00016028954996727407, 0.016528749838471413, 0.008224223740398884, -0.03145146742463112, 0.023233933374285698, -0.008866637013852596, -0.00870603322982788, -0.019794348627328873, 0.018763810396194458, -0.010666731745004654, 0.0009251415613107383, 0.032923661172389984, -0.0074546667747199535, -0.02308671548962593, 0.001875377376563847, 0.02711517922580242, -0.033780213445425034, -0.04866277799010277, 0.011255609802901745, -0.009964092634618282, 0.0021514140535146, 0.011583507992327213, -0.007126768585294485, 0.011376062408089638, 0.008137230761349201, -0.0062668719328939915, 0.02172158658504486, 0.007749105803668499, -0.023153632879257202, 0.0045671542175114155, 0.009984167292714119, -0.009729878976941109, -0.029979269951581955, -0.0013182848924770951, -0.0026365697849541903, 0.025375310331583023, -0.010974554345011711, -0.013744959607720375, 0.006584732327610254, 0.019620360806584358, -0.00888002011924982, -0.04462093114852905, 0.0028021917678415775, 0.0031852973625063896, 0.027315933257341385, 0.013785110786557198, -0.0253351591527462, -0.004714373964816332, 0.029818667098879814, 0.01027191523462534, 0.033084265887737274, -0.005286523140966892, 0.005467201583087444, -0.0034964662045240402, -0.0020426723640412092, 0.011054855771362782, -0.013865412212908268, 0.01373157650232315, 0.04649463668465614, -0.0055408114567399025, 0.052677858620882034, -0.0077892569825053215, 0.005684685427695513, 0.012359756976366043, 0.0038344021886587143, 0.020383227616548538, 0.030166640877723694, 0.009107541292905807, -0.01750575192272663, -0.02042337693274021, 0.011389445513486862, -0.0274631530046463, 0.011703960597515106, 0.013403678312897682, -0.007923092693090439, -0.006042696535587311, -0.02957776188850403, 0.032709524035453796, -0.018589824438095093, 0.018121398985385895, 0.005316636059433222, -0.0201690886169672, -0.02475966513156891, 0.032388318330049515, 0.010834026150405407, 0.0037909054663032293, 0.021253161132335663, -0.029658064246177673, -0.03819680213928223, 0.0175994373857975, 0.035279177129268646, 0.017398683354258537, -0.008652498945593834, -0.00650777667760849, 0.03198681026697159, -0.0074546667747199535, 0.007307447027415037, -0.03704581409692764, 0.0403917133808136, -0.026834122836589813, -0.018977949395775795, -0.005694722756743431, 0.014400756917893887, -0.0009778394596651196, 0.012821491807699203, 0.019901417195796967, -0.01285495050251484, -0.02498718537390232, -0.01425353717058897, 0.00312339817173779, 0.03313780203461647, -0.01309585478156805, 0.007387748919427395, 0.007160227280110121, 0.0013960771029815078, 0.022203397005796432, -0.012219229713082314, 0.0041556088253855705, 0.007360981311649084, -0.018870878964662552, -0.007903017103672028, -0.00881310272961855, -0.007782564964145422, -0.017987562343478203, -0.0031852973625063896, -0.01595325395464897, -0.0026984689757227898, -0.03932102397084236, -0.006119652185589075, 0.023233933374285698, 0.0118110291659832, -0.004684261046350002, -0.004754524677991867, -0.00768218794837594, 0.03094288893043995, 0.0021129362285137177, -0.0003920977469533682, -0.0039080120623111725, -0.013530822470784187, 0.031719136983156204, 0.009248069487512112, 0.022805659100413322, -0.03244185447692871, -0.014266920275986195, 0.005018850788474083, 0.028988882899284363, -0.02209632843732834, -0.01604693941771984, -0.01450782548636198, -0.004165646154433489, -0.03295043110847473, -0.017960794270038605, 0.028721211478114128, 0.008926862850785255, -0.02558944746851921, -0.03300396353006363, -0.020369842648506165, -0.00556423282250762, 0.005299906712025404, -0.024933651089668274, 0.008284450508654118, 0.002144722267985344, -0.0283197034150362, 0.03795589879155159, 0.0017565978923812509, -0.02311348170042038, -0.009462207555770874, 0.009522433392703533, -0.00034588249400258064, -0.0003431639343034476, -0.004068615380674601, -0.005888785235583782, 0.011978324502706528, -0.012152311392128468, 0.004145571030676365, 0.012406599707901478, 0.010057777166366577, -0.007889633998274803, -0.0028774745296686888, -0.015551745891571045, 0.04400528594851494, -0.039106886833906174, 0.006119652185589075, 0.034797366708517075, 0.008712725713849068, 0.00734090618789196, 0.005771678872406483, 0.00530994450673461, -0.02524147555232048, 0.005805137567222118, 0.007100001443177462, 0.019928185269236565, -0.002688431181013584, 0.0025295009836554527, 0.0300595723092556, -0.007394440472126007, -0.029310090467333794, 0.020048636943101883, 0.006263526156544685, 0.002569651696830988, 0.007006315980106592, -0.0025914001744240522, 0.0011033107293769717, 0.010753724724054337, 0.002900895895436406, -0.03455646336078644, -0.0038745529018342495, -0.006240104790776968, 0.011877947486937046, 0.003076555673032999, 0.031852975487709045, 0.023983415216207504, 0.011014704592525959, -0.02343468740582466, -0.024853350594639778, 0.011282376945018768, 0.0031367819756269455, 0.029979269951581955, -0.03934779018163681, -0.024585677310824394, 0.00026913589681498706, -0.03276306018233299, -0.006648304872214794, 0.006628229282796383, 0.0036671070847660303, 0.004483507014811039, 0.06857758015394211, -0.01630122773349285, 0.03281659260392189, -0.026834122836589813, -0.009000472724437714, 0.005979124456644058, 0.03792912885546684, 0.006785486359149218, -0.015217156149446964, 0.0172113124281168, -0.011898023076355457, 0.001887087943032384, -0.034770600497722626, 0.05174100771546364, 0.04100735858082771, -0.037206415086984634, -0.01718454621732235, 0.03458322957158089, 0.011436288245022297, 0.008572197519242764, 0.009488974697887897, -0.01854967325925827, -0.00023797719040885568, -0.0244786087423563, -0.04496890679001808, -0.007273987866938114, 0.0057181441225111485, -0.02127992920577526, -0.004828134551644325, 0.0008021796820685267, 0.021172858774662018, 0.01877719536423683, 0.010546279139816761, 0.002833977807313204, -0.010131387040019035, 0.04221188277006149, -0.014668428339064121, -4.1693060666148085e-06, 0.004888360854238272, -0.0002712270652409643, -0.023033179342746735, -0.018790578469634056, 0.011014704592525959, -0.003104995936155319, 0.031130259856581688, -0.00903393141925335, -0.024331388995051384, 0.02989896759390831, -0.03750085458159447, -0.028453540056943893, -0.01861659064888954, 0.015685582533478737, -0.05345410853624344, -0.008030161261558533, 0.014976251870393753, 0.015765884891152382, -0.0048147509805858135, -0.0028072106651961803, -0.0022902691271156073, 0.03503827005624771, 0.03755439072847366, -0.027623755857348442, 0.030996423214673996, 0.01326984167098999, -0.006845712661743164, 0.01727823168039322, 0.006240104790776968, -0.015257307328283787, -0.0033960891887545586, -0.04007050767540932, 0.027704058215022087, -0.014895949512720108, 0.03552008047699928, 0.003466353053227067, 0.025576064363121986, -0.020409993827342987, 0.018348919227719307, 0.001798421610146761, 0.018603207543492317, 0.04261339083313942, 0.0031434737611562014, -0.010907636024057865, -0.005667955614626408, -0.012005091644823551, -0.011871255934238434, 0.01310923881828785, -0.009810180403292179, 0.015966638922691345, 0.01233298983424902, 0.009074082598090172, -0.005443780217319727, -0.003290693275630474, 0.01975419744849205, 0.01433383859694004, -0.041167963296175, 0.001278134062886238, 0.031157027930021286, -0.01276126503944397, -0.023421304300427437, -0.028801513835787773, 0.002004194539040327, -0.003807635046541691, 0.016033556312322617, -0.012975403107702732, 0.002936027944087982, 0.04156947135925293, 0.019620360806584358, 0.007635345216840506, 0.017519135028123856, 0.0236220583319664, 0.018482755869627, 0.008130538277328014, -0.01810801401734352, -0.03281659260392189, 0.016756270080804825, -0.011041472665965557, -0.00903393141925335, 0.02463921345770359, 0.029952503740787506, 0.01781357452273369, -0.009616118855774403, -0.004684261046350002, -0.006036004982888699, -0.0019774273969233036, -0.021895574405789375, -0.013611123897135258, 0.03281659260392189, -0.00682563753798604, -0.002740292577072978, -0.009709803387522697, -0.052169281989336014, -0.027704058215022087, -0.010987937450408936, 0.020664282143115997, -0.00562111334875226, 0.03327163681387901, -0.024813199415802956, 0.0043898215517401695, -0.019540060311555862, 0.007220453582704067, 0.018054479733109474, 0.006029312964528799, 0.028052031993865967, -0.006802216172218323]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"IC STORIES
We consider toxic story generation as in Sec. 7.1, but us-
ing a target σ(s1:T)∝p0(s1:T)p(a= 1|s1:T), where
p(a= 1|s1:T)denotes the probability of the text being
judged as toxic by a classifier. Compared to the threshold-
ing target, this task provides a smoother gradient signal for
learning (see App. G.3) but still allows for exact sampling
via rejection sampling. We train using approximate posi-
tive sampling, but provide an ablation with exact positive
sampling results in App. H.3.
We report KL divergences in Table 2. We observe that PPO
learns the best proposal with respect to DKL(q∥σ)while
ourCTL method performs best with respect to DKL(σ∥q),
which is consistent with the divergences minimized dur-
ing training. Finally, in App. H.1 we provide a quali-
tative example of a toxic story generated with CTL for
σ(s1:T)∝p0(s1:T)p(a= 1|s1:T)βwithβ= 10 , a case
where no exact samples are available.
7.2.2. G ENERATION WITH VARIED SENTIMENT
For the sentiment setting described earlier, we consider a
prompt ‘I bought this’ and target σ(s1:T)∝p0(s1:T)p(a=
1|s1:T), where a= 1 indicates a 1-star review and exact
samples are available by rejection sampling. We train using
approximate positive sampling (see App. H.3 for compari-
son with exact). While all methods achieve low KL diver-
gences in Table 3, CTL performs best for both directions.
7.2.3. I NFILLING
In this section, we demonstrate a conditional twist function
parameterization, where ψθ
t(s1:t, oT)takes input oTwhich
identifies the target distribution σ(s1:T|oT)as in Sec. 3.3.
We consider an infilling task (Lew et al., 2023; Hu et al.,
2023), where the observation variables oT:=sT+1:T+ccorrespond to continuation tokens, and their likelihood
σ(oT|s1:T):=p0(sT+1:T+c|s1:T)is evaluated under the
base model, given generated s1:T. The target distribution
corresponds to the posterior σ(s1:T|oT). Instead of train-
ing separate {ψθ
t}for each oT, we amortize learning of a
conditional twist network ψθ
t(s1:t, oT).
A second distinctive feature of this setting is that we train
from exact posterior or target samples, which are readily
available using the BDMC trick in Sec. 3.3. In particular,
we may sample sequences of length T+cfrom the base
model s1:T+c∼p0(s1:T+c) =σ(s1:T, oT=sT+1:T+c),
and interpret the prefix s1:T∼σ(s1:T|oT=sT+1:T+c)as
a target sample. Note that we do not explicitly control the
continuations tokens oTdefining the tasks. We evaluate av-
erage KL divergences over 2000 different oT=sT+1:T+c,
withT= 15 andc= 10 , and report results in Table 4.
We find that DPG performs best for both directions of the
KL divergence in this setting, likely due to its ability to lever-
age exact positive samples by minimizing DKL(σoT∥qoT).
While CTL also learns from exact positive samples, it re-
quires approximate negative sampling and only performs
comparably to SIXO , which uses exact positive samples
and performs exact negative sampling under p0. Finally,
PPO trains from qoTsamples only, and performs relatively
poorly with respect to DKL(σoT∥qoT). We show qualitative
results in App. H.1 to correlate KL divergence results with
sample quality.
Using our KL divergence evaluation methods, we conclude
DPG may be preferable when exact target samples are avail-
able (Sec. 7.2.3, App. H.3), while CTL may be preferable
with approximate positive sampling (Sec. 7.2.1, Sec. 7.2.2).
8. Conclusion
In this work, we have presented twisted SMC as a principled
prob","[0.04083438217639923, 0.030939457938075066, 0.01612558774650097, 0.018634963780641556, -0.017708204686641693, 0.032935552299022675, 0.03159531578421593, 0.02708984725177288, -0.03555899113416672, 0.0521836020052433, 0.03584414720535278, -0.013965529389679432, -0.015184571966528893, 0.03456094115972519, 0.03230820596218109, -0.03644297271966934, 0.05426524206995964, -0.01743730716407299, -0.017465822398662567, 0.04052070900797844, 0.010165821760892868, 0.011833986267447472, -0.0047478522174060345, 0.016111331060528755, -0.016011524945497513, -0.03099648840725422, 0.020117776468396187, 0.039465632289648056, 0.009780860505998135, -0.021458011120557785, 0.030426176264882088, -0.02708984725177288, -0.045282818377017975, -0.06570000946521759, 0.01743730716407299, 0.08594610542058945, 0.014564357697963715, 0.0741976648569107, -0.02647676132619381, 0.0041240728460252285, 0.0022099611815065145, -0.0310820359736681, -0.017993362620472908, 0.03173789381980896, -0.01977558806538582, 0.031367190182209015, 0.018207229673862457, 0.018192971125245094, 0.009809376671910286, 0.006530079059302807, -0.05104297399520874, 0.03835352137684822, -0.005161328706890345, -0.025336137041449547, -0.030283598229289055, -0.024252543225884438, -0.027032816782593727, 0.0003446381015237421, 0.04094844311475754, -0.06877969950437546, 0.037241410464048386, -0.03792578727006912, 0.01977558806538582, 0.00452329171821475, -0.004462696146219969, -0.02478008158504963, -0.061593759804964066, 0.01904843933880329, -0.03573008254170418, 0.014493068680167198, 0.04040664806962013, 0.013509279116988182, 0.01656758040189743, -0.01790781505405903, -0.015840431675314903, 0.029157230630517006, 0.020930470898747444, 0.030939457938075066, -0.0001015869274851866, -0.043201178312301636, 0.03892383351922035, 0.002839087275788188, 0.024152737110853195, 0.013708888553082943, -0.02912871539592743, -0.04588164761662483, -0.049018364399671555, 0.010165821760892868, -0.05369492992758751, -0.0026127444580197334, -0.046680085361003876, 0.03196601942181587, -0.026448246091604233, 0.013630470260977745, 0.05546289682388306, 0.0055890632793307304, 0.015013478696346283, 0.0048975590616464615, 0.0025325443129986525, -0.0068437508307397366, 0.01652480661869049, -0.012689454481005669, 0.007720606401562691, -0.005186280235648155, 0.05891329050064087, 0.013224123045802116, -0.03909492865204811, 0.02613457478582859, -0.01822148635983467, 0.008754298090934753, -0.0171806663274765, -0.03165234997868538, -0.03918047249317169, 0.04248828813433647, 0.022199416533112526, -0.040891412645578384, -0.0521836020052433, -0.0016360841691493988, 0.0021850101184099913, 0.01983262039721012, -0.031110551208257675, -0.010023243725299835, 0.010964259505271912, 0.024936918169260025, 0.013181349262595177, -0.0375836007297039, 0.008725782856345177, -0.08166876435279846, -0.008604590781033039, -0.015612307004630566, -0.009367384016513824, 0.010094532743096352, -0.022898050025105476, 0.004669434390962124, -0.014364748261868954, 0.008162599056959152, -0.009060841053724289, 0.044712506234645844, -0.006401758641004562, 0.005966895259916782, -0.02191426046192646, -0.03581563010811806, -0.021144337952136993, 0.010265626013278961, -0.03610078617930412, -0.06649844348430634, -0.03307813033461571, 0.02261289395391941, -0.031766410917043686, 0.06330469995737076, -0.03336328640580177, -0.02609180100262165, -0.04077734798192978, 0.011099708266556263, -0.021985549479722977, -0.04083438217639923, -0.04017852246761322, 0.06695469468832016, 0.014379005879163742, -0.04705078899860382, 0.013124317862093449, 0.01423642784357071, -0.0037319830153137445, -0.02142949588596821, 0.0019158938666805625, -0.012361525557935238, 0.008490528911352158, 0.04131914675235748, -0.051413677632808685, -0.034589458256959915, 0.01661035418510437, -0.040235552936792374, -0.044712506234645844, 0.004968848545104265, -0.012995997443795204, -0.026505276560783386, -0.01752285473048687, -0.039893366396427155, -0.022769730538129807, -0.02696152776479721, -0.017665432766079903, 0.05891329050064087, -0.03316367790102959, -0.02100175991654396, -0.006287696305662394, -0.009980469942092896, 0.0025503665674477816, 0.032850004732608795, 0.014229298569262028, 0.03316367790102959, -0.01730898767709732, 0.013986916281282902, 0.09507110714912415, -0.014414650388062, -0.0032204838935285807, -0.027973832562565804, 0.07208751142024994, 0.06250625848770142, 0.023411331698298454, 0.00042617498547770083, 0.03718437999486923, 0.05038711801171303, -0.035986725240945816, -0.04648047685623169, -0.027061332017183304, 0.021714651957154274, 0.012368653900921345, -0.007175245322287083, -0.061536725610494614, -0.005920557305216789, 0.01964726857841015, -0.0219570342451334, 0.040634769946336746, 0.01795058883726597, -0.0033274174202233553, 0.015270119532942772, -0.04953164607286453, 0.014464552514255047, 0.0010426027001813054, 0.05674610286951065, 0.018592189997434616, 0.011684278957545757, 0.006048877723515034, 0.021415237337350845, -0.041803911328315735, 0.023411331698298454, 0.005300342570990324, -0.022356253117322922, 0.029157230630517006, -0.06661251187324524, 0.0392945371568203, -0.012333009392023087, -0.01221894659101963, -0.043628912419080734, -0.00515063526108861, -0.028729496523737907, -0.032678909599781036, -0.003197314916178584, 0.01739453338086605, -0.03957969322800636, 0.03513125330209732, 0.01722344011068344, 0.050501178950071335, 0.008490528911352158, 0.009837891906499863, 0.031025003641843796, -0.0244806669652462, -0.0392945371568203, -0.006016797851771116, 0.021073048934340477, 0.015612307004630566, -0.0024666020181030035, -0.0272181686013937, -0.033277738839387894, -0.04956016317009926, 0.0009374513174407184, 0.021686136722564697, -0.041975006461143494, -0.028187699615955353, 0.023111917078495026, 0.014329103752970695, -0.03196601942181587, -0.012853419408202171, -0.019447658210992813, -0.035758599638938904, 0.011163868941366673, 0.0030137456487864256, -0.020374417304992676, 0.04231719300150871, -0.009681056253612041, -0.006590674631297588, -0.020716603845357895, 0.02125840075314045, 0.03875273838639259, -0.047022271901369095, -0.06735391914844513, 0.02165761962532997, 0.02861543372273445, -0.022598635405302048, 0.01635371334850788, -0.025507230311632156, -0.020017972216010094, 0.05352383479475975, -0.013359571807086468, 0.02522207424044609, 0.04157578572630882, 0.007920215837657452, 0.01334531418979168, 0.0012413209769874811, -0.03803984820842743, 0.03262187913060188, 0.0016236086376011372, 0.0037391118239611387, -0.027289457619190216, 0.027531839907169342, 0.03142422437667847, 0.001573706278577447, -0.001475683762691915, -0.024281058460474014, -0.007492481730878353, 0.007189502939581871, -0.01826426014304161, -0.007877442054450512, -0.021800197660923004, 0.03664258494973183, 0.0002782501687761396, 0.008447755128145218, -0.006009668577462435, -0.010771778412163258, -0.004419922363013029, -0.02435234747827053, -0.04730742797255516, -0.016025783494114876, 0.04516875743865967, 0.008925392292439938, -0.032108597457408905, 0.04824844375252724, -0.02704707346856594, 0.014956447295844555, -0.04094844311475754, -0.04283047467470169, -0.017109377309679985, -0.004940332844853401, -0.009345997124910355, -0.01313144713640213, -0.00548925856128335, -0.013380958698689938, 0.0066370125859975815, 0.013466505333781242, -0.007806153502315283, -0.01678144745528698, -0.016097072511911392, 0.03407617658376694, 0.028458597138524055, -0.0292570348829031, -0.034019146114587784, -0.005556983407586813, 0.05785821005702019, 0.022071097046136856, 0.025065237656235695, -0.11115392297506332, 0.00946005992591381, 0.004002881236374378, -0.04399961605668068, 0.00834794994443655, 0.015712112188339233, 0.014714065007865429, 0.05383750796318054, 0.06923595070838928, 0.01834980770945549, -0.015840431675314903, -0.014942189678549767, 0.0010871583363041282, 0.032108597457408905, 0.022242190316319466, 0.0026056156493723392, -0.03433281555771828, -0.017366018146276474, 0.020688088610768318, -0.014771095477044582, -0.026505276560783386, 0.005136377643793821, 0.014799611642956734, 0.02860117517411709, 0.03188047185540199, 0.02691875398159027, -0.05110000818967819, 0.0019301516003906727, 0.01892011985182762, 0.0013509278651326895, -0.0356445349752903, 0.0011860718950629234, 0.00546787166967988, -0.007025538012385368, -0.045197270810604095, 0.01554101798683405, -0.00046248786384239793, 0.00442348700016737, 0.0360722690820694, 0.02874375320971012, 0.012532618828117847, 0.0059562018141150475, -0.013388087972998619, -0.01608281396329403, -0.0159972682595253, 0.011598732322454453, -0.0015728151192888618, -0.00859033316373825, -0.02900039404630661, 0.034190237522125244, 0.0223847683519125, -0.010508009232580662, -0.03926602005958557, 0.04613828659057617, -0.023368557915091515, 0.0032365238294005394, -0.019989455118775368, 0.04696524143218994, 0.04397109895944595, 0.059540633112192154, -0.014400392770767212, -0.008269532583653927, -0.05426524206995964, 0.013024513609707355, -0.035330865532159805, 0.026990042999386787, 0.015341408550739288, 0.022798245772719383, 0.039807818830013275, 0.026248635724186897, 0.044284772127866745, 0.00604531355202198, 0.028030863031744957, 0.0002760223869699985, 0.010992774739861488, -0.045197270810604095, -0.0030957278795540333, 0.03900938108563423, 0.04608125612139702, 0.06079532206058502, -0.05372344329953194, -0.05791524425148964, -0.010778907686471939, -0.01554101798683405, -0.020844925194978714, -0.016196876764297485, 0.01313144713640213, 0.006469483487308025, 0.03986484929919243, -0.05272539705038071, -0.03878125548362732, 0.076022669672966, 0.016510549932718277, -0.034846097230911255, -0.036186333745718, -0.04325820878148079, 0.029684768989682198, 0.014813869260251522, -0.0007280396530404687, -0.035330865532159805, -0.02696152776479721, 0.000601055973675102, 0.011342091485857964, -0.014272072352468967, -0.005977588705718517, 0.022598635405302048, 0.001696679973974824, -0.016011524945497513, 0.030112504959106445, -0.005311036016792059, 0.0062591806054115295, -0.010800294578075409, 0.06165079027414322, -0.009509962052106857, -0.0360722690820694, -0.022327737882733345, 0.05469297617673874, -0.028415823355317116, 0.05509219691157341, -0.03299258276820183, 0.06427422910928726, 0.012924708425998688, -0.0141722671687603, 0.007756250910460949, -0.01843535341322422, 0.024238284677267075, 0.00044823004282079637, -0.03150976821780205, 0.002414917340502143, 0.011997951194643974, 0.0030440434347838163, -0.03396211564540863, -0.012482716701924801, -0.03370547294616699, 0.007292872294783592, 0.017722463235259056, 0.08280938863754272, -0.048020318150520325, 0.006833057384938002, -0.012268849648535252, 0.015213088132441044, -0.009160646237432957, 0.02478008158504963, 0.042545318603515625, 0.00821963045746088, 0.08737188577651978, 0.015141799114644527, -0.01773672178387642, 0.0034093998838216066, 0.01143476739525795, 0.004911817144602537, -0.03852461650967598, 0.028758011758327484, -0.016795706003904343, 0.021016018465161324, -0.02074512094259262, -0.004191797226667404, 0.016752932220697403, -0.007435450330376625, -0.017123635858297348, 0.00527182687073946, 0.0033773197792470455, 0.006048877723515034, 0.0047371587716042995, 0.016809962689876556, -0.009125001728534698, 0.04248828813433647, -0.03513125330209732, 0.017023829743266106, 0.012796388939023018, 0.01075752079486847, -0.0030208744574338198, -0.020930470898747444, -0.003523462451994419, -0.019248049706220627, 0.0015835085650905967, -0.025122269988059998, 0.004027832765132189, -0.0021903568413108587, 0.03687070682644844, -0.0021422365680336952, -0.003473560092970729, -0.05366641283035278, -0.004337939899414778, 0.016425002366304398, -0.0228695347905159, -0.027317972853779793, -0.14394690096378326, -0.04639492928981781, -0.02639121375977993, 0.023511135950684547, -0.00018200991326011717, 0.03091094270348549, 0.03150976821780205, -0.03655703738331795, 0.008062793873250484, -0.028116410598158836, -0.01163437683135271, -0.023425588384270668, -6.265641422942281e-05, 0.0066370125859975815, 0.005966895259916782, 0.03299258276820183, 0.007513868156820536, 0.02257012017071247, -0.00906797032803297, 0.027531839907169342, -0.019248049706220627, -0.011791212484240532, 0.01752285473048687, 0.025678323581814766, -0.04847656935453415, -0.010771778412163258, -0.027360746636986732, -0.010486622340977192, 0.006661963649094105, -0.012482716701924801, -0.0026858157943934202, -0.005517774261534214, -0.0024879886768758297, 0.019076956436038017, -0.03287852182984352, 0.0004270660865586251, -0.012803517282009125, -0.021458011120557785, 0.0015336062060669065, 0.020502736791968346, 0.019818361848592758, 0.005692432634532452, 0.05760157108306885, -0.051328133791685104, -0.002682251390069723, 0.024594729766249657, -0.01705234684050083, 0.01839258149266243, -0.018192971125245094, 0.03008398786187172, -0.024637503549456596, -0.008618848398327827, -0.0224418006837368, -0.02552148699760437, -0.023454105481505394, 0.012204688973724842, -0.020445706322789192, -0.0069114756770431995, 0.00014202119200490415, 0.004683692008256912, 0.007528126239776611, -0.016838479787111282, 0.0024968998041003942, 0.031139066442847252, -0.001325085642747581, -0.01404394768178463, -0.0034646489657461643, -0.028458597138524055, 0.005057959817349911, -0.0008657166617922485, -0.02643398754298687, -0.04650899022817612, -0.032935552299022675, 0.011334962211549282, 0.018250003457069397, -0.0073570325039327145, -0.04705078899860382, -0.027645902708172798, 0.059483602643013, -0.04605273902416229, -0.0034503911156207323, 0.031680863350629807, 0.009267579764127731, 0.0023543215356767178, -0.00836933683604002, -0.008091310039162636, -0.025678323581814766, 0.013245509937405586, -0.0461668036878109, 0.00012397614773362875, -0.005667481105774641, 0.05942657217383385, -0.01569785363972187, -0.007791895419359207, -0.03410469368100166, -0.015099025331437588, -0.0297418013215065, 0.00237036170437932, 0.010415333323180676, 0.007528126239776611, -0.0244806669652462, 0.012275977991521358, 0.025934964418411255, -0.040235552936792374, 0.01373740378767252, 0.009167774580419064, 0.012810646556317806, -0.004986670799553394, -0.04405664652585983, -0.002443433040753007, 0.005414404906332493, -0.004263086710125208, -0.019461916759610176, 0.009702443145215511, 0.036243364214897156, -0.016881251707673073, -0.03721289709210396, 0.01699531450867653, 0.015797657892107964, -0.0071110851131379604, 0.004591016098856926, 0.015583790838718414, -0.018891604617238045, -0.05186992883682251, -0.04009297490119934, 0.02586367540061474, -0.027546098455786705, 0.03966524079442024, 0.0029210697393864393, -0.01765117421746254, 0.014685548841953278, -0.01163437683135271, 0.02074512094259262, -0.025108011439442635, 0.020189065486192703, -0.0219570342451334, 0.023596683517098427, -0.011484669521450996, 0.05620430409908295, 0.03008398786187172, 0.04750703647732735, -0.008896876126527786, -0.029713286086916924, 0.005678174551576376, 0.04294453561306, 0.03795430064201355, -0.01528437715023756, 0.01378017757087946, 0.01230449415743351, -0.00408842833712697, -0.03866719454526901, -0.0049652839079499245, 0.02600625343620777, -0.02495117485523224, 0.003042261116206646, -0.03333476930856705, -0.011612989939749241, -0.0036678228061646223, -0.00861172005534172, 0.018107423558831215, 0.009089356288313866, -0.0007601197576150298, -0.03034062869846821, -0.013694630935788155, -0.014207911677658558, 0.0025913577992469072, -0.016596095636487007, 0.002037085359916091, -0.013102931901812553, 0.0006866028998047113, 0.04206055402755737, -0.009395900182425976, -0.040463678538799286, -0.021458011120557785, -0.009331739507615566, -0.03709883242845535, -0.02331152744591236, -0.006804542150348425, -0.017337502911686897, -0.02261289395391941, 0.015669338405132294, 0.03039766103029251, -0.011249415576457977, -0.024380862712860107, 0.0329640656709671, -0.042146097868680954, 0.01380869373679161, -0.010992774739861488, -0.01673867367208004, -0.013794435188174248, -0.009231935255229473, -0.005147071089595556, -0.011235157959163189, -0.013295412063598633, -0.014685548841953278, -0.06832344830036163, 0.0021190675906836987, -0.027061332017183304, -0.013216993771493435, -0.03692774102091789, 0.008426368236541748, -0.015070510096848011, -0.01882031559944153, 0.018449611961841583, 0.015483986586332321, 0.0009971559047698975, 0.006690479349344969, -0.026890238747000694, 0.023753518238663673, -0.00028515630401670933, 0.02439512126147747, -0.01271797064691782, -0.0035662357695400715, 0.0315668024122715, -0.003131372621282935, -0.014321974478662014, 0.02639121375977993, 0.010244240052998066, 0.02622012048959732, 0.019903909415006638, 0.03669961541891098, 0.011249415576457977, -0.013202736154198647, -0.0224418006837368, 0.014500197023153305, -0.008675879798829556, -0.013872853480279446, 0.003785449778661132, -0.017323244363069534, 0.02774570696055889, -0.0075637707486748695, -0.012625294737517834, -0.00604531355202198, 0.04556797444820404, 0.008861231617629528, -0.009509962052106857, 0.014336232095956802, 0.008312305435538292, 0.008397853001952171, -0.029285550117492676, -0.005514209624379873, 0.001794702373445034, 0.01805039308965206, -0.025920705869793892, 0.0002217758446931839, -0.008241016417741776, 0.011270802468061447, 0.05072930455207825, 0.02191426046192646, 0.00527182687073946, -0.006519385613501072, 0.01230449415743351, 0.022071097046136856, 0.019062697887420654, 0.0009561646729707718, -0.005949073005467653, -0.03313516080379486, -0.017722463235259056, -0.030283598229289055, -0.0004589234013110399, 0.005981153342872858, -0.002849780721589923, -0.0169097688049078, -0.010401075705885887, 0.04796328768134117, 0.027075590565800667, 0.013402345590293407, -0.0026769046671688557, 0.018948635086417198, -0.01864922046661377, -0.13447970151901245, -0.0475640706717968, 0.024794340133666992, -0.018335549160838127, 0.00031634524930268526, -0.03821094334125519, 0.01817871257662773, -0.015512501820921898, -0.027845511212944984, -0.03336328640580177, 0.008725782856345177, -0.032194145023822784, -0.009146387688815594, 0.015883205458521843, 0.02426679991185665, -0.04542539641261101, -0.04186094179749489, -0.03304961323738098, 0.004038525745272636, 0.004730029962956905, -0.017380276694893837, -0.009353126399219036, 0.0015371706103906035, 0.05714531987905502, -0.025193559005856514, -0.02577812783420086, 0.010828809812664986, 0.023140432313084602, -0.020759377628564835, 0.01616836152970791, -0.003867432242259383, -0.02004648745059967, 0.009182032197713852, 0.020488480105996132, -0.03852461650967598, 0.00043152167927473783, -0.014200783334672451, 0.012397170066833496, -0.003309595165774226, -0.007414063438773155, 0.03170938044786453, -0.027574613690376282, 0.06735391914844513, -0.022584378719329834, 0.012853419408202171, -0.037155862897634506, 0.025721097365021706, 0.0097167007625103, 0.014614259824156761, -0.020017972216010094, 0.03282148763537407, -0.015626564621925354, 0.015184571966528893, -0.024238284677267075, -0.012390040792524815, -0.008298047818243504, -0.0008728455868549645, 0.00967392697930336, 0.01050087995827198, 0.04109102115035057, 0.0011718141613528132, 0.03142422437667847, 0.03655703738331795, -0.014286329969763756, -0.05420821160078049, -0.03356289491057396, -0.03858164697885513, -0.012568263337016106, -0.014336232095956802, -0.0027464115992188454, -0.01206924021244049, 0.023753518238663673, 0.005296777933835983, 0.01735175959765911, -0.009566993452608585, 0.0008470033062621951, 0.012176173739135265, 0.027802737429738045, -0.05061523988842964, 0.026662113144993782, 0.02500820718705654, -0.018848830834031105, 0.013623341917991638, 0.039807818830013275, 0.007189502939581871, 0.0109785171225667, -0.011106837540864944, 0.015983009710907936, -0.015070510096848011, 0.032279692590236664, 0.03150976821780205, -0.043201178312301636, 0.012710841372609138, -0.02957070805132389, 0.013658986426889896, -0.0062591806054115295, -0.024295315146446228, 0.005528467707335949, 0.016139846295118332, 0.005995410960167646, 0.011641505174338818, 0.027645902708172798, -0.02957070805132389, -0.0035769292153418064, 0.011399122886359692, 0.031139066442847252, 0.011178126558661461, 0.00776338018476963, 0.0031812747474759817, 0.00316879921592772, 0.008469142019748688, 0.001924804993905127, -0.01782226748764515, -0.0020495608914643526, -0.015113282948732376, 0.006123731378465891, 0.059198446571826935, 0.02083066664636135, 0.03179492801427841, 0.006383936386555433, 0.023154690861701965, 0.042630866169929504, -0.015983009710907936, 0.013616212643682957, -0.017451565712690353, -0.004722901154309511, -0.03165234997868538, -0.007699219975620508, -0.025678323581814766, -0.007342774420976639, -0.010800294578075409, -0.020545510575175285, 0.036328911781311035, 0.0001925918913912028, 0.00517558678984642, 0.0297418013215065, 0.037070319056510925, 0.02278398722410202, -0.03179492801427841, 0.02573535591363907, -0.0009624024969525635, 0.0010140869999304414, 0.02422402612864971, 0.033505864441394806, 0.006505127996206284, -0.02860117517411709, 0.006986328866332769, -0.025835160166025162, -0.007349903229624033, -0.011598732322454453, 0.01010879036039114, 0.03858164697885513, 0.0030975101981312037, 0.0033808841835707426, 0.005899170879274607, 0.013395216315984726, -0.00452329171821475, -0.03125312924385071, -0.01748008094727993, -0.013024513609707355, -0.0023258060682564974, 0.029884379357099533, -0.011926662176847458, -0.01716640777885914, 0.011342091485857964, -0.027118362486362457, -0.01726621389389038, -0.02157207392156124, -0.022598635405302048, 0.009766602888703346, -0.017708204686641693, -0.06535781919956207, 0.03270742669701576, -0.009395900182425976, 0.0006286805146373808, 0.0050330082885921, -0.0059740240685641766, -0.003970801364630461, -0.011940919794142246, 0.03233672305941582, 0.006800977513194084, 0.014321974478662014, -0.028444340452551842, -0.0027499760035425425, 0.051898445934057236, -0.011427638120949268, 0.02373926155269146, 0.02634844183921814, -0.010336915962398052, -0.011263673193752766, 0.02361094020307064, -0.0008020020904950798, 0.0009980470640584826, 0.01554101798683405, -0.010408204980194569, 0.007456836756318808, -0.029542190954089165, 0.0005997192929498851, -0.0003043152391910553, -0.04474102333188057, -0.03333476930856705, 0.0310820359736681, 0.003396924352273345, -0.013908497989177704, -0.05172735080122948, 0.025721097365021706, -0.017750978469848633, 0.006943555548787117, -0.0244806669652462, -4.076843833900057e-05, 0.02482285536825657, 0.011327833868563175, -0.024109965190291405, 0.041632819920778275, 0.01487090066075325, -0.03390508145093918, 0.0022830325178802013, 0.015612307004630566, -0.01896289363503456, -0.006038184277713299, -0.05609024316072464, -0.02808789536356926, 0.0032899905927479267, -0.0023739261087030172, -0.027232425287365913, 0.010201466269791126, 0.043286725878715515, 0.0011370606953278184, 0.0010737916454672813, -0.008426368236541748, -0.02669062837958336, -0.004391406662762165, -0.005556983407586813, 0.006423145532608032, -9.267579298466444e-05, -0.0015968752559274435, -0.031025003641843796, -0.0036197027657181025, 0.0146570336073637, -0.024052932858467102, 0.01482812687754631, -0.011356349103152752, 0.018749026581645012, -0.024195510894060135, 0.008191114291548729, 0.018150197342038155, 0.014464552514255047, 0.02804512158036232, -0.03818242624402046, -0.027888284996151924, -0.049103911966085434, 0.028843559324741364, 0.026590824127197266, -0.004409228917211294, 0.01703808829188347, -0.0013536012265831232, 0.004705078899860382, 0.04442735016345978, 0.03416172415018082, 0.003102856921032071, -0.016981057822704315, -0.011078322306275368, -0.007834669202566147, -0.03008398786187172, -0.012026466429233551, -0.024380862712860107, 0.026704886928200722, -0.013908497989177704, -0.004608838353306055, -0.012824904173612595, -0.015726368874311447, 0.01582617498934269, -0.008519044145941734, 0.03718437999486923, -0.02138672210276127, -0.03139570727944374, 0.0037355474196374416, -0.01705234684050083, 0.025336137041449547, 0.001965796109288931, -0.04377149045467377, -0.021244144067168236, -0.01631093956530094, -0.020075002685189247, 0.039636723697185516, -0.005753028206527233, 0.0021261966321617365, 0.0009962647454813123, -0.0022313480731099844, -0.00901806727051735, 0.032108597457408905, 0.020160550251603127, -0.0069114756770431995, -0.019376369193196297, -0.025165041908621788, -0.024922659620642662, -0.0018570803804323077, 0.05477852374315262, -0.004359326791018248, -0.034019146114587784, -0.004213184118270874, 0.002324023749679327, 0.01554101798683405, 0.013680373318493366, 0.027275199070572853, 0.014785354025661945, 0.01661035418510437, -0.017465822398662567, -0.013380958698689938, -0.02991289459168911, -0.029071683064103127, 0.008283790200948715, -0.015726368874311447, 0.03729844093322754, 0.0015104372287169099, 0.0006830384372733533, 0.016838479787111282, 0.005599756725132465, -0.003049390157684684, 0.007920215837657452, -0.036756645888090134, -0.0392945371568203, 0.035501956939697266, 0.009317481890320778, -0.02535039372742176, 0.010187208652496338, -0.0012947877403348684, 0.0006384827429428697, 0.021030277013778687, 0.011356349103152752, -0.0007948731654323637, 0.021443752571940422, 0.010950001887977123, -0.02000371366739273, -0.01462851744145155, 7.866860869398806e-06, -0.03895235061645508, 0.004544678144156933, -0.011064063757658005, -0.016154102981090546, 0.011427638120949268, -0.015341408550739288, -0.030768362805247307, -0.02348262071609497, 0.008932520635426044, 0.004042090382426977, -0.0034575199242681265, -0.0064195808954536915, 0.014300587587058544, -0.014685548841953278, 0.08081329613924026, -0.015298634767532349, -0.027317972853779793, 0.03627188131213188, 0.0032026616390794516, 0.020075002685189247, -0.03413320705294609, -0.010671974159777164, -0.034931644797325134, 0.024209769442677498, -0.030711332336068153, 0.034503910690546036, -0.007670704275369644, 0.004059912636876106, 0.04596719518303871, -0.00022411502141039819, -0.023197464644908905, 0.0033327641431242228, 0.03826797381043434, -0.022056838497519493, 0.029200004413723946, 0.01777949556708336, -0.022712698206305504, 0.016581838950514793, -0.0075352550484240055, 0.005503516178578138, 0.0014204347971826792, 0.002060254104435444, -0.014685548841953278, 0.014257814735174179, 0.01635371334850788, -0.03470351919531822, -0.0517558678984642, -0.009723829105496407, 0.006811670958995819, -0.029884379357099533, -0.03165234997868538, 0.01271797064691782, 0.00548925856128335, 0.023340042680501938, -0.009010938927531242, -0.006494434550404549, -0.006754639558494091, -0.007592285983264446, 0.0069221691228449345, 0.015983009710907936, -0.008854102343320847, 0.013552052900195122, -0.00793447345495224, 0.006711866240948439, -0.00946005992591381, -0.030511723831295967, 0.016581838950514793, -0.02804512158036232, 0.023938870057463646, -0.03718437999486923, -0.010921485722064972, 0.026619339361786842, 0.019319338724017143, -0.004576758481562138, -0.027403518557548523, 0.018463870510458946, -0.011491798795759678, -0.0025218508671969175, 0.021757425740361214, -0.002940674312412739, 0.00967392697930336, -0.0036606937646865845, 0.002120849909260869, 0.05246875807642937, -0.029228519648313522, -0.006872266530990601, 0.011263673193752766, -0.01826426014304161, -0.0030173100531101227, -0.0006812561769038439, 0.02573535591363907, 0.031851958483457565, 0.013837208971381187, 0.05030157044529915, -0.009360254742205143, -0.023511135950684547, -0.012974611483514309, -0.00821963045746088, -0.00039654545253142715, 0.007635059766471386, 0.009053711779415607, -0.019903909415006638, -0.02291230857372284, 0.02443789318203926, -0.010650587268173695, 0.013288282789289951, 0.027674417942762375, 0.006619190331548452, -0.025550004094839096, -0.04402812942862511, 0.008711524307727814, -0.01673867367208004, 0.03173789381980896, 0.0034824712201952934, -0.013830079697072506, -0.03510273993015289, 0.011841114610433578, 0.02138672210276127, -0.026890238747000694, 0.01078603696078062, -0.0668976679444313, -0.0032365238294005394, 0.013231251388788223, 0.023340042680501938, -0.00698989350348711, -0.024666018784046173, 0.015099025331437588, 0.008511914871633053, -0.008041406981647015, 0.0015541018219664693, -0.020075002685189247, 0.029684768989682198, -0.010443849489092827, 0.009431544691324234, -0.0014489503810182214, 0.010365431196987629, 0.002432739594951272, -0.0013901368947699666, 0.009816505014896393, -0.023639457300305367, -0.03279297426342964, -0.013331056572496891, 0.0169097688049078, 0.011833986267447472, -0.03150976821780205, 0.006252051796764135, -0.022812502458691597, -0.019447658210992813, 0.022327737882733345, -0.01058642752468586, -0.0016601443057879806, 0.010030372068285942, -0.029285550117492676, 0.014464552514255047, -0.0018285646801814437, 0.005004493054002523, -0.02191426046192646, 0.0052112312987446785, -0.004480518400669098, 0.01160586066544056, -0.017209181562066078, -0.021201370283961296, 0.0030190921388566494, 0.022470315918326378, 0.011342091485857964, -0.019333597272634506, -0.008062793873250484, 0.03082539513707161, -0.01930508017539978, 0.009866408072412014, 0.00973808765411377, -0.025279104709625244, 0.0033309818245470524, 0.013822951354086399, 0.02361094020307064, -0.0037248539738357067, -0.013872853480279446, 0.012275977991521358, 0.005763721652328968, 0.007385547738522291, -0.007799024693667889, -0.002258081454783678, -0.00527182687073946, -0.01752285473048687, -0.012839161790907383, 0.00485835038125515, -0.00819824356585741, -0.026362698525190353, -0.02830176241695881, -0.006840186659246683, -0.00010581971582723781, 0.031196098774671555, -0.030369143933057785, 0.018749026581645012, 0.015312892384827137, -0.028758011758327484, 0.04086289554834366, -0.023340042680501938, -0.050843365490436554, 0.0003860748838633299, 0.0032383061479777098, 0.007121778558939695, 0.0002584228932391852, 0.011042676866054535, -0.012917580083012581, -0.006875831168144941, -0.015213088132441044, -0.007039796095341444, 0.00023614504607394338, -0.00034419255098327994, -0.0030689944978803396, -0.009837891906499863, 0.00795586034655571, 0.0235681664198637, -0.0013874635333195329, -0.016710158437490463, 0.020944729447364807, 0.016453517600893974, -0.01421504095196724, 0.007335645612329245, -0.013359571807086468, -0.042117584496736526, -0.0035911870654672384, 0.0038709966465830803, 0.0475640706717968, 0.022099612280726433, 0.007585157174617052, 0.036500006914138794, 0.018021877855062485, -0.021629104390740395, 0.04157578572630882, 0.005385889206081629, -0.010992774739861488, -0.0185209009796381, -0.013509279116988182, -0.004658740945160389, 0.002275903709232807, 0.0064873057417571545, -0.02535039372742176, 0.019504690542817116, -0.009752345271408558, -0.0036892094649374485, 0.008661622181534767, 0.03265039622783661, 0.01934785395860672, -0.029014652594923973, -0.02182871475815773, -0.001258252072148025, 0.008333692327141762, 0.0037105961237102747, 0.012625294737517834, -0.03957969322800636, -0.01964726857841015, 0.006362549494951963, -0.04017852246761322, 0.032194145023822784, -0.02626289427280426, -0.012896193191409111, -0.021372463554143906, 0.0516418032348156, -0.008996681310236454, 0.02730371430516243, -0.0176084004342556, -0.013872853480279446, 0.004099121782928705, 0.018192971125245094, 0.006234229542315006, -0.03935156762599945, -0.008797071874141693, -0.020616799592971802, -0.01703808829188347, -0.013010255992412567, 0.03404765948653221, 0.001475683762691915, -0.04109102115035057, -0.0033113774843513966, 0.03709883242845535, 0.0037640631198883057, -0.017665432766079903, 0.010721876285970211, -0.009902052581310272, -0.024252543225884438, -0.02408144809305668, -0.008547559380531311, 0.015483986586332321, 0.00930322427302599, -0.024879885837435722, 0.007253663148730993, -0.00616294052451849, 0.03764063119888306, -0.003393359947949648, 0.008732911199331284, 0.016453517600893974, -0.016596095636487007, 0.03846758231520653, 0.007203760556876659, 0.009966212324798107, -0.0011272584088146687, 0.020844925194978714, -0.025364652276039124, -0.016425002366304398, -0.016239650547504425, -0.010700489394366741, 0.035416409373283386, -0.03222266212105751, 0.011741310358047485, 0.041233599185943604, -0.0171806663274765, -0.013245509937405586, -0.012860548682510853, 0.007371290121227503, -0.016253909096121788, 0.0036785162519663572, 0.006159375887364149, -0.0219570342451334, -0.020117776468396187, -0.0013045900268480182, 0.002037085359916091, 0.0388668030500412, 0.0360722690820694, 0.008169727399945259, 0.004512598272413015, -0.0010577515931800008, -0.016539065167307854, -0.01956172101199627, 0.006209278013557196, 0.0050223153084516525, -0.006244922522455454, -0.022270705550909042, 0.03150976821780205, -0.029798831790685654, 0.006152247078716755, -0.0068437508307397366, 0.0012181519996374846, -0.024765823036432266, 0.016025783494114876, -0.005760157015174627, 5.380097354645841e-05, 0.07077579200267792, -0.0035341556649655104, 0.007791895419359207, -0.01119238417595625, -0.008768555708229542, -0.016382228583097458, 0.03969375416636467, 0.005920557305216789, 0.014600002206861973, -0.015925979241728783, 0.01705234684050083, -0.005713819060474634, -0.002037085359916091, 0.003817529883235693, 0.017537111416459084, -0.041233599185943604, -0.0203459020704031, 0.0301695354282856, -0.00014848177670501173, 0.004316553473472595, -0.014521583914756775, 0.027317972853779793, -0.029142972081899643, 0.027104105800390244, -0.019547464326024055, -0.0008265076903626323, 0.01358769740909338, 0.008968165144324303, 0.011135352775454521, -0.014614259824156761, 0.020716603845357895, 0.01035117357969284, 0.00766357546672225, -0.024409377947449684, -0.02838730812072754, -0.00033149420050904155, -0.02000371366739273, 0.00198361836373806, 0.029399612918496132, 0.020402932539582253, 0.0041240728460252285, 0.014008303172886372, 0.001468554837629199, -0.013537795282900333, -0.0008207154460251331, -0.003992188256233931, -0.012775002047419548, 0.031025003641843796, 0.02522207424044609, -0.005899170879274607, -0.0017929201712831855, -0.028102152049541473, -0.019290823489427567, -0.03547344356775284, 0.016981057822704315, -0.026462502777576447, 0.0347890667617321, -0.01722344011068344, 0.004975977353751659, -0.024409377947449684, 0.006879395339637995, 0.030882425606250763, -0.016938284039497375, 0.017879299819469452, -0.03173789381980896]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"abilistic inference framework for solving numerous ca-
pability and safety tasks in LLMs. After discussing different
design choices for twisted SMC and their relation to related
work, we proposed a novel contrastive method for twist
learning. Furthermore, we have proposed novel bidirec-
tional SMC bounds for evaluating LLM inference methods.
We demonstrated the effectiveness of our methods quanti-
tatively and qualitatively in both sampling and evaluation
across a variety of experimental settings.
10
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Acknowledgments
AM and RG acknowledge support from the Canada CIFAR
AI Chairs program and from Open Philanthropy. SZ thanks
Juhan Bae for helping debug memory issues in the code.
Resources used in this research were provided, in part, by
the Province of Ontario, the Government of Canada, and
companies sponsoring the Vector Institute. We thank the
anonymous reviewers for helpful comments on earlier ver-
sions of this paper.
Impact Statement
This paper is motivated by the social consequences of re-
cent advances in the field of machine learning. Controlled
generation from language models has the potential to im-
prove safety through better steering of generation to human
preferences, more efficient automated red-teaming, and the
ability to estimate or bound probabilities of rare behaviors.
Any such work is inherently a double-edged sword; the
same techniques used to generate samples from a harmless
distribution of text could, with a single sign change, be
repurposed for generating samples from a harmful distri-
bution of text. Thus, better controlled generation (in our
framework, better sampling from target distributions) can
provide benefits in the hands of responsible users but can
also magnify harms in the hands of malevolent users (who
have access to model weights).
Overall, we believe the potential positive social benefits of
our work in evaluation and steering language model output
towards desired target distributions outweigh the potential
negatives stemming primarily from misuse.
References
Andrieu, C., Doucet, A., and Holenstein, R. Particle markov
chain monte carlo methods. Journal of the Royal Sta-
tistical Society Series B: Statistical Methodology , 72(3):
269–342, 2010.
Anil, C., Zhang, G., Wu, Y ., and Grosse, R. Learning to
give checkable answers with prover-verifier games. arXiv
preprint arXiv:2108.12099 , 2021.
Bae, J., Zhang, M. R., Ruan, M., Wang, E., Hasegawa, S.,
Ba, J., and Grosse, R. B. Multi-rate vae: Train once, get
the full rate-distortion curve. In The Eleventh Interna-
tional Conference on Learning Representations , 2022.
Bai, Y ., Jones, A., Ndousse, K., Askell, A., Chen, A., Das-
Sarma, N., Drain, D., Fort, S., Ganguli, D., Henighan, T.,
et al. Training a helpful and harmless assistant with rein-
forcement learning from human feedback. arXiv preprint
arXiv:2204.05862 , 2022.
Banerjee, A., Guo, X., and Wang, H. On the optimality ofconditional expectation as a bregman predictor. IEEE
Transactions on Information Theory , 51(7), 2005.
Brekelmans, R., Huang, S., Ghassemi, M., Ver Steeg, G.,
Grosse, R. B., and Makhzani, A. Improving mutual in-
formation estimation with annealed and energy-based
bounds. In International Conference on Learning Repre-
sentations , 2022.
Briers, M., Doucet, A., and Maskell, S. Smoothing algo-
rithms for state–space models. Annals of the Institute of
Statistical Mathematics , 62:61–89, 2010.
Burda, Y ., Grosse, R., and Salakhutdinov, R. Importance
weighted autoencoders. arXiv preprint arXiv:1509.00519 ,
2015.
Chaffin, A., Claveau, V ., and Kijak, E. Ppl-mcts: Con-
strained textual generation through discriminator-guided
mcts decoding. In NAACL 2022-Conference of the North
American Chapter of the Association for Computational
Linguistics: Human Language Technologies , 2022.
Chopin, N., Papaspiliopoulos, O., et al. An introduction to
sequential Monte Carlo , volume ","[0.014860480092465878, 0.0028937736060470343, 0.016288306564092636, 0.026795996353030205, -0.03426782414317131, 0.021500565111637115, 0.0068896072916686535, -0.008421400561928749, -0.047631166875362396, 0.03460052236914635, 0.062380749732255936, -0.03390740230679512, -0.018464701250195503, 0.042945679277181625, 0.00035154150100424886, -0.026463299989700317, 0.03759479895234108, 0.0007957877242006361, 0.01992025226354599, 0.034323275089263916, -0.004141388460993767, 0.004082473460584879, -0.008123359642922878, 0.008462987840175629, 0.0062623340636491776, -0.009558117017149925, 0.04344472661614418, 0.0036388770677149296, 0.00043731502955779433, -0.02545134536921978, 0.04108811914920807, -0.025243408977985382, -0.060828160494565964, -0.03507184237241745, -0.039812780916690826, 0.057168491184711456, 0.006879210472106934, 0.005842996761202812, -0.008747166953980923, 0.022346170619130135, -0.006993575021624565, -0.06432148069143295, 0.011076048016548157, 0.0539524145424366, -0.01220583263784647, 0.055255480110645294, 0.020696546882390976, -0.007360928226262331, 0.00390226230956614, 0.058332931250333786, -0.04125446826219559, 0.019740041345357895, -0.019823215901851654, -0.047880690544843674, -0.028972391039133072, -0.023746270686388016, -0.001980588771402836, 0.015428838320076466, 0.016565553843975067, -0.04252980649471283, 0.00885806605219841, -0.04729846864938736, -0.012933608144521713, 0.024425528943538666, -0.036014486104249954, -0.03135672211647034, -0.025603830814361572, 0.015345663763582706, -0.0168705265969038, 0.03756707161664963, -0.012164246290922165, 0.010951287113130093, 0.034489624202251434, -0.00721537321805954, -0.05381379276514053, 0.015983333811163902, 0.0015257290797308087, 0.05339791998267174, -0.021625326946377754, -0.015553600154817104, 0.00856002513319254, 0.009031346067786217, 0.032687511295080185, -0.03321428224444389, -0.04566270858049393, -0.02797430008649826, -0.020821306854486465, 0.018949884921312332, -0.04893423244357109, -0.019102372229099274, -0.031051749363541603, 0.043028853833675385, -0.03936918452382088, 0.010646314360201359, 0.07419150322675705, 0.005752891302108765, 0.022013472393155098, -0.018450839444994926, 0.055976323783397675, 0.005059771705418825, -0.008677855134010315, -0.006158365868031979, 0.03892558813095093, -0.05342564359307289, 0.04702122136950493, -0.010875043459236622, -9.265057451557368e-05, 0.0005596939590759575, -0.037372998893260956, 0.004079008009284735, -0.05711304023861885, 1.537858770461753e-05, -0.06515322625637054, 0.029249640181660652, 0.006484132260084152, -0.0404781736433506, -0.04325065389275551, 0.006702465005218983, 0.008171877823770046, 0.010854249820113182, -0.0328538604080677, -0.013841594569385052, 0.03618083521723747, -0.011914722621440887, 0.03837108984589577, -0.02977641113102436, 0.019698454067111015, -0.06626221537590027, -0.005111755803227425, 0.002280362881720066, -0.015345663763582706, 0.03437872231006622, 0.005025115795433521, -0.008026323281228542, -0.018090417608618736, -0.023676959797739983, -0.009454148821532726, -0.009197695180773735, -0.012254351750016212, 0.006688602268695831, 0.015803122892975807, -0.009100657887756824, -0.015068416483700275, 0.0062865931540727615, -0.033325180411338806, -0.01644079200923443, -0.012878159061074257, 1.5107837498362642e-05, -0.005579611286520958, 0.025867216289043427, -0.025479070842266083, -0.03667987883090973, -0.054285112768411636, 0.031523071229457855, -0.057168491184711456, -0.071973517537117, -0.047353919595479965, 0.07263891398906708, 0.0463281013071537, -0.061105407774448395, 0.009433355182409286, 0.06598497182130814, -0.008677855134010315, -0.002983879065141082, 0.039452359080314636, 0.017937930300831795, -0.024702776223421097, 0.049876872450113297, -0.040616799145936966, -0.028806043788790703, 0.01364752184599638, -0.014222810976207256, -0.04125446826219559, -0.03146762028336525, -0.0026910360902547836, -0.046549901366233826, -0.032327089458703995, -0.09376519918441772, -0.004768661689013243, -0.02958233654499054, -0.02072427049279213, 0.06459873169660568, -0.03324200585484505, -0.0012103597400709987, -0.015761535614728928, -0.005586542654782534, 0.005052840802818537, 0.032964758574962616, 0.018145866692066193, 0.0211262796074152, -0.008081772364675999, 0.05528320372104645, 0.06825839728116989, 0.03748389706015587, -0.0031363654416054487, -0.016024921089410782, 0.08234258741140366, 0.028806043788790703, 0.006165297236293554, -0.03515501692891121, 0.01488820556551218, 0.00555188674479723, -0.04405467212200165, -0.0440823957324028, 0.013418791815638542, -0.003909193444997072, -0.007686694618314505, 0.01682893931865692, -0.04801931232213974, 0.002616525860503316, 0.019809354096651077, -0.02123717963695526, 0.054534636437892914, 0.012108796276152134, -0.029194191098213196, 0.014624820090830326, -0.023676959797739983, -0.0042210971005260944, -0.013557416386902332, 0.04677169770002365, 0.0004225862503517419, 0.024300767108798027, 0.010105681605637074, 0.004654297139495611, -0.03299248591065407, 0.029360538348555565, 0.014541645534336567, -0.017827032133936882, 0.05727938935160637, -0.022734317928552628, 0.062103498727083206, -0.0060024140402674675, 0.0015317939687520266, -0.04524683579802513, -0.02388489618897438, -0.009675947017967701, 0.016842801123857498, -0.014638681896030903, -0.026546474546194077, -0.050680890679359436, 0.036374907940626144, 0.012885089963674545, 0.03030318208038807, 0.0017180697759613395, 0.019947977736592293, 0.06348974257707596, -0.03654125705361366, 0.0011938982643187046, 0.033131107687950134, 0.022346170619130135, -0.015512012876570225, -0.030608152970671654, -0.0059400335885584354, 0.028362447395920753, -0.020890619605779648, -0.003916124813258648, -0.020613372325897217, 0.00548950582742691, -0.0033529652282595634, -0.0014165628235787153, -0.031051749363541603, -0.020460885018110275, -0.04208621010184288, 0.0211262796074152, -0.02252638153731823, -0.0015621179481968284, -0.033158835023641586, 0.003971574362367392, 0.030774502083659172, -0.04036727547645569, -0.00426961574703455, -0.015387251041829586, -0.012739535421133041, 0.033408354967832565, -0.022817490622401237, -0.044636890292167664, 0.024758225306868553, 0.06443238258361816, -0.029637787491083145, 0.04100494459271431, 0.008317433297634125, 0.004099801182746887, 0.052205756306648254, -0.0010275495005771518, -0.012531599029898643, 0.024591878056526184, -0.008580818772315979, -0.03049725480377674, 0.0043631866574287415, -0.04241890832781792, 0.02549293264746666, -0.010778007097542286, 0.009766052477061749, -0.017244812101125717, 0.02922191470861435, 0.04327837750315666, 0.026546474546194077, -0.0033564309123903513, -0.0023652699310332537, 0.015622911974787712, 0.04973825067281723, 0.0238433089107275, -0.003545305924490094, -0.005229586269706488, 0.01061858981847763, 0.04219711199402809, -0.01407032459974289, 0.02460573986172676, -0.01398715004324913, 0.02248479425907135, -0.01852015033364296, -0.012094933539628983, -0.036568980664014816, 0.0069762468338012695, -0.013162338174879551, -0.02676827274262905, 0.06287979334592819, -0.050043221563100815, 0.024952299892902374, -0.03964643180370331, -0.04247435927391052, 0.01591402292251587, -0.008851135149598122, -0.013640590012073517, -0.014943654648959637, 0.01635761931538582, -0.008996689692139626, 0.005156808532774448, -0.0006983178318478167, -0.005583076737821102, 0.01348810363560915, 0.0391196608543396, 0.03213301673531532, 0.003912659361958504, 0.00010683786240406334, -0.07019913196563721, -0.04380514845252037, 0.057944782078266144, 0.010791869834065437, -0.0020689615048468113, -0.06459873169660568, 0.02818223647773266, 0.0004990460001863539, -0.02994275838136673, 0.014139636419713497, -0.015123865567147732, -0.011304778046905994, 0.0262969508767128, 0.06997733563184738, 0.0056454576551914215, 0.008255052380263805, -0.02233230695128441, 0.030164556577801704, -0.007201510947197676, 0.0027516840491443872, 0.0161912702023983, -0.013702970929443836, 0.004716677591204643, 0.006487597711384296, -0.01567836105823517, -0.021472839638590813, 0.024910712614655495, 0.010008644312620163, 0.018769674003124237, 0.021916436031460762, 0.02894466742873192, -0.03479459509253502, 0.027710914611816406, 0.012739535421133041, -0.001483275555074215, -0.015123865567147732, 0.009391767904162407, -0.02140352874994278, 0.00742330914363265, -0.025021610781550407, 0.0012632102007046342, -0.03213301673531532, 0.001975390361621976, 0.03623628243803978, 0.029748685657978058, 0.00464043440297246, -0.005662785843014717, 0.0071044741198420525, -0.032327089458703995, 0.017785444855690002, 0.026241501793265343, -0.0006004146998748183, -0.009128382429480553, -0.008712511509656906, 0.0018575600115582347, -0.0019216736545786262, -0.008913516066968441, -0.039812780916690826, 0.04569043219089508, -0.003621548879891634, 0.014694131910800934, 0.006622755900025368, 0.009017483331263065, 0.053009774535894394, 0.030524980276823044, -0.022346170619130135, -0.010445309802889824, -0.027794089168310165, 0.018339939415454865, -0.03329745680093765, 0.051124487072229385, 0.03726210072636604, 0.0593310222029686, 0.009461079724133015, 0.06337884068489075, 0.040949497371912, -0.06044001504778862, 0.018409252166748047, -0.011880067177116871, 0.020183637738227844, -0.050680890679359436, 0.0168705265969038, 0.010493827983736992, 0.0728052631020546, 0.07907106727361679, -0.008268915116786957, -0.03354698047041893, -0.0136059345677495, -0.02757229097187519, 0.016302168369293213, 0.0028261945117264986, 0.010549277998507023, -0.04427646845579147, 0.049405552446842194, -0.05650309473276138, -0.04394377022981644, 0.033131107687950134, 0.01987866498529911, -0.03579268604516983, -0.017619095742702484, -0.0204470232129097, 0.03482231870293617, 0.025104785338044167, -0.00038099908852018416, -0.07125267386436462, 0.004654297139495611, 0.007014368660748005, -0.050847239792346954, -0.004824111238121986, -0.0012632102007046342, 0.0007269089692272246, -0.035654064267873764, -0.013176199980080128, 0.021154005080461502, -0.0602736659348011, 0.01928258314728737, -0.0202390868216753, 0.06620676815509796, -0.005427124910056591, -0.012774190865457058, -0.013737627305090427, 0.09770211577415466, -0.02557610720396042, 0.04835201054811478, -0.020502472296357155, 0.023094739764928818, -0.0023583387956023216, -0.02489684894680977, -6.963684427319095e-05, 0.021777812391519547, 0.04530228674411774, 0.017965655773878098, -0.028639694675803185, 0.022373894229531288, 0.02216595970094204, 0.022373894229531288, -0.016011059284210205, -0.007111405488103628, -0.015900159254670143, -0.020793583244085312, -0.01739729754626751, 0.03329745680093765, -0.07530049234628677, -0.012982127256691456, -0.0007030830020084977, 0.019379619508981705, -0.011207740753889084, 0.04056134819984436, 0.04128219187259674, 0.006851485464721918, 0.048795606940984726, -0.012046415358781815, 0.014985241927206516, 0.004286943469196558, 0.037816595286130905, -0.02674054726958275, -0.02409283071756363, 0.03875923901796341, -0.015858571976423264, 0.047520268708467484, -0.04466461390256882, -0.018007243052124977, -0.010327479802072048, -0.00038121567922644317, -0.038620613515377045, 0.00817880965769291, 0.0038814686704427004, -0.004602313041687012, 0.018575601279735565, 0.00530236354097724, 0.03801066800951958, 0.041420817375183105, -0.007139130029827356, 0.014999104663729668, 0.03837108984589577, 0.00028287936584092677, -0.0005462647532112896, -0.009038276970386505, 0.012503874488174915, 0.004865698516368866, 0.03399057686328888, -0.02941598929464817, -0.01021658070385456, 0.005378606729209423, 0.02265114337205887, 0.021070830523967743, -0.031800318509340286, -0.03227164223790169, -0.019947977736592293, 0.013009851798415184, -0.012157314456999302, -0.0006181758944876492, -0.06670581549406052, -0.017369572073221207, -0.038343366235494614, 0.026310812681913376, 0.0022353101521730423, 0.00164096022490412, -0.004993925336748362, -0.05542182922363281, 0.01148498896509409, -0.014818893745541573, -0.02572859264910221, -0.026477161794900894, 0.005323157180100679, 0.003995833452790976, 0.012011759914457798, 0.007645107340067625, 0.011478058062493801, -0.01915782131254673, 0.0016955434111878276, 0.0007988201105035841, -0.041503991931676865, 0.0012632102007046342, 0.017203224822878838, 0.03302020952105522, -0.043306101113557816, 0.0030168022494763136, -0.015276351943612099, 0.005565749015659094, 0.00033572971005924046, 0.028362447395920753, -0.01061858981847763, -0.022900665178894997, -0.0010587399592623115, 0.02636626362800598, -0.01996183954179287, -0.012753397226333618, 0.020849032327532768, -0.01996183954179287, 0.01312768179923296, 0.02132035419344902, -0.014319847337901592, 0.03074677847325802, 0.007561932783573866, -0.052483003586530685, -0.008338226936757565, 0.029831860214471817, -0.02364923432469368, 0.0012233557645231485, -0.05323157086968422, 0.015484288334846497, -0.016302168369293213, -0.01646851748228073, 0.006037070415914059, -0.0305804293602705, -0.015470425598323345, 0.008684786036610603, -0.020585646852850914, -0.031606245785951614, 0.027600014582276344, 0.016801215708255768, 0.007922355085611343, -0.017563646659255028, 0.0016860129544511437, 0.030330905690789223, -0.0070802150294184685, -0.0260890144854784, -0.023108601570129395, -0.04031182453036308, 0.005461781285703182, 0.018700361251831055, -0.01138102076947689, -0.04469234123826027, 0.017785444855690002, 0.023427436128258705, 0.019545968621969223, -0.01430598460137844, -0.026504887267947197, -0.0010232175700366497, 0.04216938465833664, -0.036735329777002335, 0.020211363211274147, 0.02352447248995304, -0.014666407369077206, -0.00742330914363265, 0.028972391039133072, 0.011769168078899384, -0.020460885018110275, -0.015304076485335827, -0.0036527393385767937, 0.020225225016474724, -0.038981035351753235, 0.04261298105120659, -0.03002593293786049, -0.005208792630583048, -0.032964758574962616, 0.021500565111637115, -0.020169775933027267, 0.007589657790958881, 0.011311708949506283, 0.021736225113272667, -0.03612538427114487, 0.011685993522405624, -0.0032039445359259844, -0.0427238829433918, -0.013120750896632671, 0.009273937903344631, 0.002165998099371791, 0.026393987238407135, -0.023469023406505585, -0.011228534393012524, 0.027405941858887672, 7.429374090861529e-05, -0.02861196920275688, 0.020530197769403458, 0.005059771705418825, -0.009946263395249844, -0.01847856305539608, 0.02156987600028515, -0.0076035200618207455, -0.008553093299269676, 0.018617188557982445, -0.01731412298977375, -0.0013515829341486096, -0.047353919595479965, -0.03246571496129036, 0.022692730650305748, -0.025645418092608452, 0.03950780630111694, -0.021154005080461502, 0.04577360674738884, -0.026435574516654015, 0.00887885969132185, -0.0118038235232234, -0.02949916198849678, 0.024467116221785545, -0.003871072083711624, 0.022457068786025047, -0.0006376698729582131, 0.04341699928045273, 0.036818504333496094, 0.03390740230679512, 0.00556228356435895, -0.013356410898268223, -0.010570071637630463, 0.004501810763031244, 0.0010873310966417193, -0.03127354755997658, -0.009010552428662777, -0.008275846019387245, 0.019892526790499687, -0.03490549325942993, 0.01533180195838213, 0.0054305908270180225, -0.031606245785951614, 0.033047933131456375, -0.07596588879823685, -0.021251041442155838, 0.013453448191285133, 0.004359721206128597, 0.054174214601516724, -0.008712511509656906, 0.007243097759783268, -0.005285035818815231, -0.013294030912220478, -0.00807484146207571, 0.01591402292251587, -0.019850939512252808, -0.012843502685427666, -0.014333710074424744, -0.03254888951778412, 0.02693461999297142, -0.0021556015126407146, -0.1079602837562561, -0.0018592928536236286, 0.017161637544631958, -0.011089910753071308, 0.003933452535420656, -0.003120770212262869, -0.03606993332505226, -0.03473914414644241, 0.02572859264910221, 0.017937930300831795, -0.014403021894395351, 0.0015058019198477268, 0.0001872505381470546, -0.010348273441195488, 0.018062692135572433, -0.03914738446474075, 0.0111245671287179, 0.01011954341083765, 0.006338577251881361, 0.013654452748596668, -0.04280705749988556, -0.06343428790569305, 0.014957517385482788, -0.026865309104323387, 0.003940383903682232, -0.010493827983736992, -0.02004501409828663, -0.04241890832781792, 0.004539932124316692, 0.005732097662985325, -0.013716833665966988, 0.012157314456999302, 0.01483275555074215, 0.022956116124987602, -0.024314628913998604, 0.004203769378364086, 0.02737821638584137, -0.04050590097904205, 0.004189907107502222, -0.0168705265969038, -0.0029856120236217976, -0.011270121671259403, -0.0020706942304968834, -0.025950390845537186, 0.062103498727083206, 0.037456173449754715, 0.02197188511490822, 0.027281180024147034, 0.030885402113199234, 0.011346365325152874, -0.008282776921987534, -0.017023013904690742, 0.013495035469532013, 0.006560375448316336, -0.0030168022494763136, -0.007638175971806049, -0.009807639755308628, -0.0010171527974307537, -0.0041725789196789265, -0.028209960088133812, -0.0023964603897184134, 0.015886297449469566, 0.007471827324479818, -0.019046921283006668, 0.014264397323131561, -0.01150578260421753, -0.019629141315817833, 0.01599719561636448, -0.01820131577551365, -0.006189556326717138, 0.031523071229457855, -0.015276351943612099, -0.004342393018305302, 0.0003047559584956616, 0.011367158964276314, 0.03956325724720955, -0.0017267337534576654, 0.006858416832983494, 0.01302371360361576, -0.014118842780590057, 0.0072846850380301476, 0.010362135246396065, 0.01599719561636448, -0.0012129589449614286, -0.0436110757291317, -0.024716638028621674, -0.03975732997059822, -0.035044118762016296, -0.016177406534552574, -0.00022331441869027913, -0.05439601093530655, -0.02095993049442768, 0.0072708227671682835, -0.0006121110636740923, -0.00851843785494566, -0.0018384993309155107, 0.02095993049442768, -0.0056454576551914215, -0.09587227553129196, -0.03318655863404274, 0.038454264402389526, 0.0220411978662014, 0.028806043788790703, -0.04596767947077751, 0.023496748879551888, 0.006255402695387602, 0.004397842567414045, -0.06010731682181358, 0.008199602365493774, -0.033325180411338806, -0.013765351846814156, 0.018450839444994926, 0.0222491342574358, -0.06188170239329338, 0.00025342177832499146, -0.045912232249975204, 0.02441166527569294, 0.009412561543285847, 0.006265799514949322, 0.014403021894395351, -0.0007749941432848573, 0.046522174030542374, -0.028833767399191856, 0.007069818209856749, 0.02144511416554451, 0.0436110757291317, -0.03207756578922272, 0.02674054726958275, -0.023302674293518066, -0.033519256860017776, 0.009267007000744343, 0.047631166875362396, -0.029388263821601868, 0.022235270589590073, 0.0020065808203071356, -0.022429345175623894, -0.03867606446146965, -0.017133912071585655, -0.002749951323494315, -0.03265978768467903, 0.04729846864938736, -0.0054791090078651905, 0.04776979237794876, -0.006425217259675264, 0.0229283906519413, -0.029249640181660652, 0.009876951575279236, -0.027627740055322647, -0.010188855230808258, -0.0036769986618310213, 0.012143452651798725, -0.00851843785494566, 0.0031311670318245888, 0.011568163521587849, 0.0038745375350117683, 0.01671804115176201, 0.03850971534848213, 0.04261298105120659, -0.003933452535420656, 0.005465246737003326, 0.030330905690789223, -0.005770219024270773, -0.03138444572687149, -0.03132899850606918, 0.004602313041687012, 0.027600014582276344, -0.026823721826076508, -0.023704683408141136, -0.032160740345716476, 0.03576496243476868, -0.003746310481801629, 0.02184712514281273, 0.005437521729618311, -0.0017527258023619652, 0.022262996062636375, 0.03914738446474075, -0.05467326194047928, 0.01224741991609335, 0.028750592842698097, -0.04984914883971214, -0.0014156964607536793, -0.001139315078034997, -0.026560336351394653, 0.031162649393081665, 0.00923928152769804, -0.0007715285755693913, -0.023940345272421837, 0.060661811381578445, 0.041060395538806915, -0.009100657887756824, 0.011713718064129353, -0.03662443161010742, 0.012455356307327747, -0.004990459885448217, -0.025839492678642273, 0.014195085503160954, 0.010403722524642944, -0.004304271657019854, 0.01537338923662901, 0.03931373357772827, -0.023385848850011826, -0.04912830516695976, 0.025354309007525444, 0.0236076470464468, -0.003273256588727236, -0.014104980044066906, 0.00013559148646891117, 0.006983178202062845, 0.010091818869113922, 0.006314318161457777, -0.03606993332505226, 0.0032143413554877043, 0.007312410045415163, 0.022554107010364532, 0.035044118762016296, 0.04147626459598541, 0.012455356307327747, 0.034129198640584946, 0.025298859924077988, 0.006778708193451166, -0.024023519828915596, -0.012025621719658375, -0.01104139257222414, -0.027045520022511482, 0.02159760147333145, 0.009163038805127144, -0.011990966275334358, -0.02485526166856289, 0.013827732764184475, -0.0033928195480257273, 0.016856664791703224, -0.005208792630583048, -0.03210529312491417, 0.018741948530077934, -0.00973832793533802, -0.005073633976280689, -0.03803839534521103, 0.03102402575314045, 0.008525368757545948, -0.011013668030500412, 0.04050590097904205, 0.012649429962038994, 0.02132035419344902, -0.0023652699310332537, -0.014527782797813416, -0.017009150236845016, 0.005347416270524263, 0.02585335448384285, 0.0222491342574358, 0.013342549093067646, 0.00019277383398730308, 0.0227204542607069, -0.018464701250195503, -0.004366652574390173, 0.021985748782753944, -0.02905556559562683, -0.005226120352745056, 0.022304583340883255, -0.0020464351400732994, 0.06853564828634262, -0.02460573986172676, -0.0006116778822615743, -0.0008746300591155887, -0.011935516260564327, -0.012309800833463669, -0.013238580897450447, -0.014652544632554054, 0.03130127489566803, -0.021514426916837692, -0.05520002916455269, 0.027544565498828888, 0.032410264015197754, -0.010888906195759773, 0.027877263724803925, 0.01646851748228073, -0.0017336650053039193, 0.027184143662452698, 0.018547875806689262, 0.01731412298977375, -0.002148670144379139, -0.04890650510787964, 0.01052155252546072, 0.03473914414644241, -0.01320392545312643, -0.0010128207504749298, 0.00817880965769291, -0.006726724095642567, 0.03246571496129036, -0.009897745214402676, 0.018908297643065453, -0.012094933539628983, 0.055615901947021484, 0.0067232586443424225, -0.018492426723241806, -0.009793777018785477, 0.02568700537085533, -0.02761387825012207, -0.043112028390169144, -0.03329745680093765, 0.04053362458944321, -0.006678205449134111, -0.013827732764184475, -0.012046415358781815, 0.02596425451338291, -0.014278260059654713, 0.001130651100538671, -0.009370974265038967, 0.010382928885519505, 0.012212764471769333, 0.0010847318917512894, -0.02420373074710369, 0.0327984094619751, -0.004200303927063942, -0.023787857964634895, 0.007575795520097017, 0.0077837309800088406, -0.027267318218946457, -0.02036384865641594, -0.0305804293602705, -0.006688602268695831, -0.01610809564590454, 0.01803496666252613, -0.008767960593104362, 0.027710914611816406, -0.001964993542060256, 0.012912814505398273, -0.040783148258924484, -0.0023739340249449015, 0.012067208997905254, -0.004141388460993767, -0.000407207669923082, -0.006075191777199507, -0.009135314263403416, -0.02373240888118744, 0.0015621179481968284, -0.0444982685148716, -0.019670728594064713, -0.01771613210439682, 0.0052642421796917915, -0.009578910656273365, 0.01659327931702137, -0.006917331833392382, -0.0009608368272893131, -0.03110720030963421, 0.011353296227753162, 0.034850046038627625, -0.03102402575314045, -0.025187959894537926, -0.010514621622860432, 0.013793076388537884, 0.05403558909893036, 0.0028521863278001547, 0.0238433089107275, -0.0036804641131311655, 0.018769674003124237, 0.049599625170230865, 0.044387366622686386, 0.03712347522377968, -0.019850939512252808, 0.011304778046905994, 0.0005332687287591398, -6.644199311267585e-05, 0.002796736778691411, -0.03171714395284653, -0.0003437439154367894, 0.01663486659526825, -0.008864997886121273, 0.01222662627696991, -0.025243408977985382, 0.01308609452098608, 0.002412055619060993, 0.045468635857105255, 0.017827032133936882, -0.028833767399191856, -0.002287294017150998, -0.018048830330371857, 0.0014312915736809373, 0.011769168078899384, -0.03770569711923599, 0.0004544264229480177, -0.024231454357504845, -0.02958233654499054, 0.02674054726958275, 0.0003097377484664321, -0.009558117017149925, -0.007360928226262331, 0.027558429166674614, -0.043472450226545334, 0.0031831508968025446, 0.03390740230679512, -0.015941746532917023, 0.013612865470349789, -0.016537830233573914, -0.01007795613259077, 0.003311377950012684, 0.00815801601856947, 0.008365951478481293, -0.00294575747102499, 0.00847685057669878, 0.03335290774703026, -0.005538024008274078, 0.007035162299871445, 0.01591402292251587, 0.010798800736665726, 0.012607842683792114, -0.016981426626443863, -0.02036384865641594, 0.001146246213465929, -0.01682893931865692, 0.014555508270859718, 0.0034967875108122826, -0.013515829108655453, 0.02100151777267456, -0.006352439522743225, -0.0001596340734977275, -0.013300961814820766, 0.011491919867694378, -0.011699856258928776, -0.004501810763031244, -0.0030168022494763136, 0.035044118762016296, -0.004491413943469524, -0.02123717963695526, -0.00944028701633215, 0.0005150743527337909, -0.011270121671259403, 0.00849764421582222, 0.023538336157798767, 0.002464039484038949, 0.01570608653128147, 0.006321249064058065, 0.005995483137667179, -0.01924099586904049, 0.002337545156478882, -0.02492457441985607, -0.007499552331864834, -0.030774502083659172, -0.02636626362800598, 0.0422525592148304, 0.0016868794336915016, 0.0023236828856170177, 0.00044532923493534327, -0.0053370194509625435, 0.009267007000744343, 0.006047466769814491, -0.0010795334819704294, 0.010043300688266754, -0.0431952029466629, 0.06720486283302307, 0.018658775836229324, -0.012566255405545235, 0.0012571453116834164, -0.002588801085948944, 0.004522604402154684, -0.021223315969109535, 0.0039889020845294, -0.04236346110701561, 0.002271699020639062, 0.00721537321805954, 0.011970172636210918, -0.009856157936155796, -0.028265411034226418, 0.021708499640226364, -0.004855301696807146, -0.006508391350507736, -0.010188855230808258, -0.009433355182409286, 0.013432654552161694, 0.014125773683190346, 0.033768776804208755, -0.011304778046905994, -0.0032230052165687084, -0.005340485367923975, 0.008164946921169758, -0.02120945416390896, 0.0244948398321867, -0.0013715100940316916, 0.036208558827638626, -0.005964292678982019, -0.011637475341558456, -0.03451734781265259, -0.0035193138755857944, -0.011949378997087479, 0.015816984698176384, -0.05054226890206337, 0.021708499640226364, -0.018090417608618736, 0.0033876211382448673, 0.027405941858887672, -0.013141544535756111, -0.005035512614995241, 0.00678217364475131, -0.01474958099424839, 0.006411354523152113, -0.0072708227671682835, -0.0148466182872653, 0.006941590923815966, -0.009468011558055878, 0.007922355085611343, -0.003954246174544096, 0.01570608653128147, -0.01407032459974289, 0.006307386793196201, -0.025312721729278564, -0.010396791622042656, 0.03914738446474075, 0.014777306467294693, 0.009883883409202099, -0.03914738446474075, 0.019670728594064713, -0.019296444952487946, 0.011450332589447498, -0.0023947276640683413, -0.037012577056884766, -0.022346170619130135, -0.00529196672141552, 0.009967057034373283, 0.03859288990497589, -0.0071183363907039165, -0.0035262450110167265, -0.014319847337901592, 0.023635372519493103, 0.02604742720723152, 0.0038156225346028805, 0.005243448540568352, 0.013314824551343918, 0.014680269174277782, 0.046910323202610016, -0.023067014291882515, 0.004924613516777754, -0.025229547172784805, 0.007631245069205761, 0.005222654901444912, 0.011907791718840599, 0.023039288818836212, -0.022997703403234482, -0.020142050459980965, 0.014652544632554054, -0.016371481120586395, 0.00780452461913228, 0.0327984094619751, 0.022900665178894997, 0.0005813539028167725, -0.027031658217310905, 0.007984736002981663, -0.009405630640685558, 0.011387952603399754, 0.002758615417405963, -0.0013853724813088775, -0.03751162439584732, 0.012115727178752422, 0.0123652508482337, -0.03207756578922272, 0.018464701250195503, -0.03842654079198837, -0.01739729754626751, 0.02705938182771206, 0.03956325724720955, -0.017743857577443123, 0.008913516066968441, 0.021417390555143356, 0.02941598929464817, -0.0006021474837325513, 0.007042093202471733, -0.0418366901576519, 0.015969472005963326, -0.0028521863278001547, -0.055809974670410156, 0.023191776126623154, -0.009925469756126404, 0.013709901832044125, 0.014098049141466618, -0.004231493920087814, -0.01903305947780609, 0.00619302224367857, -0.0011107238242402673, 0.005784081760793924, 0.0030670533888041973, -0.04602313041687012, -0.021112417802214622, 0.009114520624279976, 0.003625014564022422, 0.0118038235232234, 0.01104139257222414, -0.006213815417140722, -0.010577002540230751, -0.029471438378095627, 0.010881975293159485, 0.013820800930261612, 0.0168705265969038, -0.009967057034373283, 0.028806043788790703, -0.013654452748596668, -0.017258673906326294, -0.013453448191285133, -0.0021954558324068785, 0.023663097992539406, -0.00014707127411384135, -0.007000506389886141, 0.0031242358963936567, -0.018464701250195503, 0.024120556190609932, -0.007097542751580477, 0.014805031009018421, -0.008067910559475422, -0.03704030066728592, 0.03570951148867607, 0.002136540599167347, 0.010278960689902306, -0.0238433089107275, -0.019947977736592293, 0.0006125443032942712, 0.032964758574962616, -0.01892215944826603, -0.01614968292415142, 0.011353296227753162, 0.01222662627696991, -0.006993575021624565, -0.010902768932282925, 0.006529184989631176, -0.010278960689902306, -0.0012736069038510323, 0.007943148724734783, -0.05001549795269966, -0.01791020669043064, -0.003254195675253868, -0.0030150695238262415, 0.016745764762163162, -0.021098555997014046, -0.023635372519493103, 0.0440823957324028, -0.012330594472587109, -0.04197531193494797, 0.007534208241850138, 0.005946964491158724, 0.003396285232156515, -0.020058875903487206, 1.6014848370105028e-05, -0.00780452461913228, 0.0055033680982887745, -0.013723764568567276, -0.004110198002308607, 0.01022351160645485, -1.6055460946517996e-05, 0.0017475273925811052, 0.0038745375350117683, 0.0018644912634044886, 0.01570608653128147, -0.010958218015730381, -0.020169775933027267, -0.021417390555143356, -0.0021902574226260185, 0.01583084836602211, 0.0011757038300856948, 0.007638175971806049, -0.01278805360198021, -0.002781141782179475, 0.021098555997014046, 0.019545968621969223, -0.012822709046304226, 0.009953195229172707, -0.0008750632987357676, 0.0056211985647678375, -0.016621002927422523, -0.008067910559475422, -0.013453448191285133, -0.03199439123272896, -0.011332502588629723, -0.021417390555143356, 0.0211262796074152, 0.02284521609544754, 0.019698454067111015, -0.025673143565654755, 0.04580133035778999, 0.007520345970988274, -0.040145475417375565, -0.003978505730628967, 0.03532136604189873, 0.022914528846740723, -0.01671804115176201, -0.009163038805127144, 0.0319112166762352, 0.009329387918114662, -0.017688408493995667, 0.008220396004617214, 0.0043527898378670216, 0.02015591226518154, 0.02040543593466282, -0.017106186598539352, 0.02500774897634983, 0.012670222669839859, 0.013273237273097038, -0.01731412298977375, 0.0943751409649849, 0.004761730320751667, 0.01896374672651291, -0.023579923436045647, -0.011540438048541546, -0.003086114302277565, 0.03213301673531532, -0.010819594375789165, -0.035099565982818604, 0.00809563510119915, -0.02653261087834835, -0.012240489013493061, -0.011658268980681896, 0.004037420731037855, 0.0332697331905365, -0.027281180024147034, -0.011166153475642204, 0.027073245495557785, 0.016205132007598877, -0.010549277998507023, 0.027988161891698837, -0.0011990965576842427, 0.0003762338892556727, -0.005042443983256817, -0.020973794162273407, 0.00019873034034390002, 0.007010903209447861, -0.012989058159291744, -0.018187453970313072, 0.005267707630991936, 0.03218846768140793, 0.030552703887224197, -0.008885790593922138, 0.031162649393081665, -0.0337410531938076, 0.03648580610752106, -0.022540243342518806, -0.02337198704481125, -0.004425567574799061, 0.019767766818404198, -0.0052815699018538, -0.02797430008649826, -0.009426424279808998, 0.0065950313583016396, 0.0323825404047966, -0.019615279510617256, -0.007066352758556604, 0.02657419815659523, -0.03967415541410446, -0.021306490525603294, -0.0026771738193929195, -0.00681336410343647, -0.027752501890063286, 0.0033321715891361237, 0.03615310788154602, -0.020474748685956, 0.00042951744399033487, 0.012219695374369621, 0.01021658070385456, 0.015110003761947155, 0.06055091321468353, -0.013675246387720108, 0.033047933131456375, 0.018423113971948624, 0.008885790593922138, -0.012905883602797985, 0.01900533400475979, -0.004144854377955198, -0.00970367155969143, -0.023676959797739983, 0.015428838320076466, -0.00817880965769291, 0.011554300785064697, -0.020571785047650337, 0.01799337938427925, -0.027281180024147034, 0.008553093299269676, 0.005631595384329557, 0.020058875903487206, -0.001454684417694807, 0.0008915248326957226, -0.026504887267947197, 0.011270121671259403, 0.018423113971948624, 0.008386745117604733, 0.015234764665365219, -0.022997703403234482, 0.018450839444994926, 0.014915930107235909, -0.02621377632021904, -0.007700556889176369, -0.005156808532774448, 0.006019742228090763, 0.055699076503515244, -0.016205132007598877, -0.008553093299269676, 0.018450839444994926, -0.0005155075923539698, -0.016454655677080154, -0.015179315581917763, 0.006844554096460342, -0.0042904093861579895, 0.02280362881720066, 0.0022041196934878826, 0.009585841558873653, 0.04344472661614418, -0.008206534199416637, 0.010625520721077919, 0.00937790609896183, 0.0195598304271698, 0.015026829205453396, 0.01362672820687294, -0.012081071734428406, -0.019130095839500427, 0.0079778041690588, -0.040256377309560776, -0.008774891495704651, 0.03590358793735504, 0.006196487694978714, 0.023427436128258705, 0.043666522949934006, -0.009405630640685558, 0.0018367664888501167, -0.00082307931734249, -0.029000116512179375, -0.01899147219955921, 0.026795996353030205, 0.015512012876570225, 0.010535415261983871, -0.02633853815495968, -0.01682893931865692, -0.022734317928552628, -0.023746270686388016, -0.006061329506337643, -0.023261087015271187, 0.02453642711043358, -0.02958233654499054, 0.00744410278275609, -0.022914528846740723, 0.005160273984074593, 0.04283478111028671, -0.014250535517930984, 0.015622911974787712, -0.0073886532336473465]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"4. Springer, 2020.
Cobbe, K., Kosaraju, V ., Bavarian, M., Chen, M., Jun, H.,
Kaiser, L., Plappert, M., Tworek, J., Hilton, J., Nakano,
R., et al. Training verifiers to solve math word problems.
arXiv preprint arXiv:2110.14168 , 2021.
Corr ˆea, N. K. Aira, 2023. URL https://huggingface.
co/nicholasKluge/ToxicityModel .
Dathathri, S., Madotto, A., Lan, J., Hung, J., Frank, E.,
Molino, P., Yosinski, J., and Liu, R. Plug and play lan-
guage models: A simple approach to controlled text gen-
eration. In International Conference on Learning Repre-
sentations , 2019.
Del Moral, P., Doucet, A., and Jasra, A. Sequential monte
carlo samplers. Journal of the Royal Statistical Society
Series B: Statistical Methodology , 68(3):411–436, 2006.
Deng, H. and Raffel, C. Reward-augmented decoding: Ef-
ficient controlled text generation with a unidirectional
reward model. In The 2023 Conference on Empirical
Methods in Natural Language Processing , 2023.
Dohan, D., Xu, W., Lewkowycz, A., Austin, J., Bieber, D.,
Lopes, R. G., Wu, Y ., Michalewski, H., Saurous, R. A.,
Sohl-Dickstein, J., et al. Language model cascades. arXiv
preprint arXiv:2207.10342 , 2022.
Domke, J. and Sheldon, D. R. Importance weighting and
variational inference. Advances in neural information
processing systems , 31, 2018.
11
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Doucet, A., De Freitas, N., Gordon, N. J., et al. Sequential
Monte Carlo methods in practice , volume 1. Springer,
2001.
Eikema, B., Kruszewski, G., Dance, C. R., Elsahar, H.,
and Dymetman, M. An approximate sampler for energy-
based models with divergence diagnostics. Transactions
on Machine Learning Research , 2022.
Eldan, R. and Li, Y . Tinystories: How small can lan-
guage models be and still speak coherent english? arXiv
preprint arXiv:2305.07759 , 2023.
Finke, A. On extended state-space constructions for Monte
Carlo methods . PhD thesis, University of Warwick, 2015.
Go, D., Korbak, T., Kruszewski, G., Rozen, J., Ryu, N., and
Dymetman, M. Aligning foundation models for language
with preferences through f-divergence minimization. In
International Conference on Machine Learning , 2023.
Grosse, R. B., Ghahramani, Z., and Adams, R. P. Sandwich-
ing the marginal likelihood using bidirectional monte
carlo. arXiv preprint arXiv:1511.02543 , 2015.
Grosse, R. B., Ancha, S., and Roy, D. Measuring the reliabil-
ity of mcmc inference with bidirectional monte carlo. Ad-
vances in Neural Information Processing Systems , 2016.
Gu, S. S., Ghahramani, Z., and Turner, R. E. Neural adaptive
sequential monte carlo. Advances in neural information
processing systems , 28, 2015.
Guo, H., Tan, B., Liu, Z., Xing, E. P., and Hu, Z. Efficient
(soft) q-learning for text generation with limited good
data. arXiv preprint arXiv:2106.07704 , 2021.
Gutmann, M. and Hyv ¨arinen, A. Noise-contrastive esti-
mation: A new estimation principle for unnormalized
statistical models. In International conference on ar-
tificial intelligence and statistics , pp. 297–304. JMLR
Workshop and Conference Proceedings, 2010.
Haarnoja, T., Zhou, A., Abbeel, P., and Levine, S. Soft
actor-critic: Off-policy maximum entropy","[-0.02089422382414341, 0.019028181210160255, 0.04064430296421051, 0.015582132153213024, -0.02432665042579174, 0.0059726969338953495, -0.009738832712173462, 0.01841524802148342, -0.03821980953216553, 0.009589004330337048, 0.04323224723339081, -0.03067391738295555, -0.04941606521606445, 0.04740019515156746, -0.0021980477031320333, -0.017706967890262604, 0.017911279574036598, -0.0021588881500065327, 0.024667169898748398, 0.03064667619764805, -0.03399737924337387, -0.008152016438543797, -0.012006687000393867, 0.027772700414061546, 0.03579531982541084, -0.0038069982547312975, 0.011175821535289288, 0.0457657054066658, 0.023359578102827072, -0.049525029957294464, 0.034242551773786545, -0.03157288581132889, -0.027037179097533226, -0.01908266358077526, -0.028848739340901375, 0.05314814671874046, 0.04306879639625549, 0.010467542335391045, -0.022011123597621918, 0.015813685953617096, -0.011863669380545616, -0.04148878902196884, 0.008356327190995216, 0.061674732714891434, -0.012953328900039196, 0.045166391879320145, 0.029175635427236557, -0.015187131240963936, 0.016998689621686935, 0.056607816368341446, -0.05241262912750244, 0.012585568241775036, -0.03097357414662838, -0.01919163018465042, -0.021357327699661255, -0.022474229335784912, 0.0009142925264313817, 0.010004437528550625, 0.013831866905093193, -0.03993602469563484, 0.0009245080873370171, -0.05061468854546547, -0.005662824958562851, 0.0353049710392952, -0.03410634770989418, -0.03555014356970787, -0.03459669277071953, -0.012265481054782867, -0.014097471721470356, 0.05434677377343178, -0.004287129733711481, 0.010651422664523125, 0.027159765362739563, -0.009364262223243713, -0.06592440605163574, -0.0012071385281160474, -0.010910216718912125, 0.05184055492281914, -0.023250611498951912, -0.014056609012186527, 0.014546955935657024, 0.014751266688108444, 0.024299409240484238, -0.051704347133636475, -0.06320025771856308, -0.02794976904988289, -0.007579944562166929, 0.020022494718432426, -0.04908916726708412, -0.016767136752605438, -0.017884038388729095, 0.016004376113414764, -0.0327170304954052, -0.004637863952666521, 0.06924787163734436, 0.01815645396709442, 0.01382505614310503, -0.007457357831299305, 0.0545647069811821, -0.005904593039304018, -0.02771821618080139, -0.020580945536494255, 0.041216373443603516, -0.04511190950870514, 0.0581878237426281, 1.6267746104858816e-05, -0.0499064102768898, -0.00845167227089405, -0.03318013623356819, 0.013021432794630527, -0.09273003041744232, 0.00126928323879838, -0.03849222511053085, 0.018783006817102432, -0.024721652269363403, -0.03541393578052521, -0.03026529587805271, 0.0057241180911660194, -0.0015731960302218795, 0.01709403470158577, -0.02517113648355007, -0.01068547461181879, 0.045575015246868134, -0.017298346385359764, 0.032580822706222534, -0.026900971308350563, 0.0176524855196476, -0.06385405361652374, -0.004780881572514772, -0.0016166121931746602, -0.01912352629005909, 0.00812477432191372, -0.014410748146474361, -0.010665043257176876, -0.0327170304954052, -0.021030429750680923, 0.006973821669816971, -0.021534398198127747, -0.026165451854467392, 0.03037426248192787, 0.00813839491456747, -0.01738007180392742, -0.028630806133151054, 0.015391441993415356, -0.060040246695280075, 0.0066026560962200165, -0.0012854578671976924, -0.00010747618944151327, -0.00941193476319313, 0.0022406126372516155, 0.002812683815136552, -0.019954392686486244, -0.021874917671084404, 0.013055484741926193, -0.04197913780808449, -0.07099132239818573, -0.051595382392406464, 0.07420582324266434, 0.03734808415174484, -0.08265068382024765, 0.010923837311565876, 0.0842306911945343, 0.017475416883826256, -0.010876164771616459, 0.028658047318458557, 0.03143668174743652, -0.028630806133151054, 0.03827429562807083, -0.022760264575481415, -0.025865795090794563, 0.008349516429007053, 0.0011475477367639542, -0.02188853733241558, -0.03307116776704788, 0.003209388116374612, -0.04385880008339882, -0.03911878168582916, -0.06597889214754105, -0.005387004930526018, -0.020499221980571747, -0.005448298063129187, 0.01735282875597477, -0.02525286190211773, 0.02030853182077408, -0.02797701023519039, -0.0161269623786211, -0.010440301150083542, 0.02628803811967373, 0.020907843485474586, 0.027309594675898552, 0.0037422997411340475, 0.023727338761091232, 0.051186759024858475, 0.05589953809976578, -0.007443737238645554, -0.036340147256851196, 0.08973346650600433, 0.006337051745504141, 0.01949128694832325, -0.008812622167170048, 0.002233802108094096, 0.040916718542575836, -0.04238775745034218, -0.05173159018158913, 0.00271393358707428, -0.0012786474544554949, -0.009943144395947456, 0.009016932919621468, -0.04481225088238716, -0.02229716069996357, 0.027309594675898552, 0.017747830599546432, 0.027745457366108894, -0.003915964160114527, -0.0478360578417778, 0.00909865740686655, -0.03505979850888252, 0.005359763279557228, 0.019109904766082764, 0.03086460940539837, -0.017734210938215256, 0.03116426430642605, 0.0027326620183885098, -0.006320025771856308, -0.03012908808887005, 0.02868529036641121, 0.03089185059070587, -0.014696784317493439, 0.05698919668793678, 0.010991941206157207, 0.08145205676555634, -0.009050984866917133, -0.011230304837226868, -0.03448772802948952, -0.028031494468450546, -0.027731837704777718, -0.0004763004253618419, 0.001103280344977975, -0.014587817713618279, -0.0069533903151750565, 0.020036116242408752, 0.004140706732869148, 0.0020294911228120327, 0.006650328636169434, 0.0166445504873991, 0.060040246695280075, -0.060040246695280075, -0.013314278796315193, -0.0008998204721137881, 0.03192702680826187, 0.0026594505179673433, -0.03203599154949188, -0.004722993355244398, 0.016671791672706604, -0.02137094922363758, -0.03181806206703186, -0.0057717906311154366, 0.006486880127340555, -0.011114528402686119, -0.009575383737683296, -0.02033577300608158, -0.005727523472160101, -0.030919091776013374, 0.03023805469274521, -0.016712654381990433, -0.009915902279317379, -0.042251553386449814, -0.011032803915441036, 0.017107656225562096, -0.031327713280916214, -0.0009679241920821369, -0.02617907151579857, -0.021534398198127747, 0.050042618066072464, -0.05589953809976578, -0.04513914883136749, 0.03440600261092186, 0.04020844027400017, -0.055572640150785446, 0.01938232034444809, 0.016658172011375427, 0.009262106381356716, 0.04606536030769348, 0.03214496001601219, -0.0022746643517166376, 0.024721652269363403, 0.011407374404370785, -0.018851110711693764, -0.008703656494617462, -0.04159775748848915, 0.030428744852542877, -0.01981818489730358, 0.0009934630943462253, -0.03887360543012619, 0.03868291527032852, 0.017025930806994438, 0.01650834269821644, 0.0011177523992955685, 0.006585630122572184, -0.03146392107009888, 0.01930059678852558, -0.013055484741926193, -0.007362012751400471, 0.0040249302983284, -0.002775226952508092, 0.03614945709705353, -0.0080498605966568, 0.028222184628248215, 0.006493690423667431, 0.00954133179038763, 0.01471040491014719, -0.0010224072029814124, -0.027118904516100883, 0.02510303258895874, -0.02137094922363758, -0.02931184321641922, 0.05500056967139244, -0.02171146869659424, 0.051704347133636475, -0.05257607623934746, -0.008199688978493214, -0.010699095204472542, 0.006752484478056431, -0.01227229181677103, -0.013368761166930199, 0.027418559417128563, 0.007157701533287764, 0.006463043391704559, -0.009623056277632713, 0.0007657412788830698, -0.01901455968618393, 0.03808360546827316, 0.026696661487221718, 0.01849697157740593, 0.006909123156219721, -0.05205848813056946, -0.04914364963769913, 0.05579057335853577, 0.002090784488245845, 0.00849253498017788, -0.10106592625379562, -0.014437990263104439, -0.015813685953617096, -0.03514152392745018, -0.007191753480583429, -0.03015632927417755, -0.02004973776638508, 0.030292537063360214, 0.05698919668793678, 0.0031174481846392155, -0.0010547564597800374, -0.03541393578052521, 0.03200875222682953, 0.012946518138051033, 0.01856507547199726, 0.029693225398659706, -0.0054925656877458096, 0.004631053190678358, 0.006772915367037058, -0.014615059830248356, -0.001484661246649921, 0.028521841391921043, 0.002598157152533531, 0.0014157062396407127, 0.026002002879977226, -0.009425555355846882, -0.03012908808887005, 0.013484537601470947, -0.007096408400684595, -0.003769541159272194, -0.016658172011375427, 0.029039429500699043, -0.06407198309898376, 0.024721652269363403, -0.03781118988990784, -0.004379069432616234, -0.0358770415186882, 0.012054359540343285, 0.028031494468450546, 0.030592193827033043, 0.005696876905858517, 0.006503905635327101, -0.00396023178473115, -0.028767013922333717, 0.015200751833617687, 0.010712715797126293, 0.0004941776860505342, -0.005700281821191311, -0.011877289973199368, 0.0017741021001711488, 0.0004758747818414122, -0.007491409778594971, -0.05938645079731941, 0.03244461491703987, 0.026792006567120552, 0.03397013992071152, -0.0168761033564806, 0.009813747368752956, 0.02909391187131405, 0.019872667267918587, -0.016372134909033775, 0.0171621385961771, -0.012653672136366367, -0.006415370851755142, -0.00242789788171649, 0.045901913195848465, 0.016086099669337273, 0.0830865427851677, 0.02111215516924858, 0.03683049604296684, 0.05933196470141411, -0.028930462896823883, -0.004992003086954355, -0.026941834017634392, 0.00811796449124813, -0.06112990528345108, 0.01964111439883709, 0.010637802071869373, 0.0696837306022644, 0.05538194999098778, -0.007818307727575302, -0.021943019703030586, -0.021874917671084404, -0.02318250760436058, -0.027159765362739563, -0.02022680640220642, 0.02784080244600773, -0.04816295579075813, 0.022106468677520752, -0.035495661199092865, -0.058678168803453445, 0.02857632376253605, 0.04315052181482315, -0.01569109782576561, -0.013191691599786282, -0.027922527864575386, 0.05726161226630211, 0.01789765991270542, 0.021343708038330078, -0.04614708572626114, -0.008778570219874382, 0.016658172011375427, -0.07840100675821304, 0.01981818489730358, -0.01650834269821644, 0.011741082184016705, -0.022487850859761238, -0.011523150838911533, 0.0384649857878685, -0.052249178290367126, 0.01369565911591053, -0.010344956070184708, 0.04075327143073082, -0.019695596769452095, 0.0005350398714654148, -0.01099875196814537, 0.11506805568933487, -0.018551455810666084, 0.04824468120932579, -0.014846612699329853, 0.013811435550451279, 0.004944330547004938, -0.01620868593454361, -0.021697847172617912, 0.0014684866182506084, 0.03407910466194153, 0.03552290424704552, -0.00980012584477663, 0.017257483676075935, 0.01860593818128109, 0.008860294707119465, -0.01776145212352276, 0.006847829557955265, -0.028194943442940712, -0.001084551797248423, -0.014233678579330444, 0.03437875956296921, -0.058678168803453445, -0.02769097499549389, -0.02307354286313057, 0.023863546550273895, -0.013974884524941444, 0.018619557842612267, 0.03544117882847786, 0.009439176879823208, 0.04832640290260315, -0.006541362963616848, -0.019205251708626747, 0.0044301473535597324, 0.008989691734313965, -0.031327713280916214, -0.0169033445417881, 0.0166173093020916, -0.01580006442964077, 0.022828368470072746, 0.008403999730944633, -0.015336958691477776, -0.009439176879823208, 0.011495908722281456, -0.03920050337910652, -0.013293847441673279, -0.020036116242408752, -0.024980446323752403, 0.02816770039498806, -0.004971572197973728, -0.004045361187309027, 0.02702355943620205, 0.006418776232749224, -0.000422243116190657, 0.02620631456375122, -0.00913952011615038, -0.016767136752605438, -0.019586632028222084, 0.014070229604840279, 0.002630506409332156, 0.015568511560559273, -0.0410529263317585, 0.006844424642622471, -0.010174696333706379, 0.020880602300167084, -0.0013833569828420877, -0.021847674623131752, -0.009119088761508465, -0.01901455968618393, 0.023986132815480232, -0.014928337186574936, 0.001395275117829442, -0.07415133714675903, 0.0031651207245886326, -0.0252119991928339, 0.03555014356970787, -0.0009806936141103506, 0.009861419908702374, -0.012190567329525948, -0.060040246695280075, -0.0015485085314139724, -0.010099782608449459, -0.021874917671084404, -0.012885225005447865, 0.0024023589212447405, 0.0067865364253520966, 0.03407910466194153, -0.002264448907226324, 0.01413833349943161, -0.01897369883954525, -0.007539082318544388, 0.014982819557189941, -0.030183572322130203, -0.011529960669577122, 0.010753578506410122, 0.03056495264172554, -0.03255357965826988, -0.009500470012426376, -0.019504906609654427, -0.01624954864382744, -0.008833053521811962, 0.013641176745295525, 0.01657644659280777, -0.005747954361140728, 0.009037364274263382, 0.024408375844359398, -0.024816997349262238, -0.0014020854141563177, 0.013654797337949276, -0.03680325299501419, 0.0014821073273196816, 0.0074164955876767635, -0.026900971308350563, 0.03247185796499252, 0.0004271380603313446, -0.030183572322130203, -0.005942049901932478, 0.018728524446487427, 0.008444862440228462, -0.0073960646986961365, -0.04072602838277817, 0.0338066890835762, -0.006156576797366142, -0.0007227507885545492, 0.01393402274698019, -0.03459669277071953, 0.005124805495142937, 0.00231722928583622, -0.016290411353111267, -0.03958188742399216, 0.04241500049829483, 0.015568511560559273, 0.005192908924072981, -0.03345255181193352, -0.005567479413002729, 0.04295983165502548, -0.027187008410692215, -0.02251509204506874, -0.001715362654067576, -0.0603126585483551, 0.012245049700140953, 0.043504659086465836, -0.02794976904988289, -0.04189741238951683, 0.0249532051384449, 0.015554890967905521, -0.010692285373806953, -0.014124712906777859, -0.013402813114225864, -0.001900093979202211, 0.029665982350707054, -0.02566148340702057, 0.027677353471517563, 0.006377913989126682, -0.009091847576200962, -0.006905717775225639, -0.0024636522866785526, 0.0014463529223576188, -0.023972511291503906, -0.03421531245112419, -0.020090598613023758, -0.0032587633468210697, -0.03658532351255417, 0.055654365569353104, -0.047972265630960464, 0.0019903313368558884, -0.006987442262470722, 0.015500407665967941, -0.021248362958431244, -0.014301782473921776, 0.007028304506093264, 0.006762700155377388, -0.007123649585992098, -0.02011783979833126, -0.03993602469563484, -0.030074605718255043, -0.020349392667412758, 0.021439053118228912, -0.006173602771013975, 0.016957826912403107, -0.00990909244865179, -0.015527649782598019, 0.00913952011615038, 0.012694534845650196, -0.04159775748848915, 0.020689912140369415, -0.014724025502800941, -0.01125754602253437, -0.022610437124967575, 0.015405062586069107, -0.012360826134681702, -0.014737646095454693, 0.012619620189070702, -0.030020123347640038, -0.004290534649044275, -0.02771821618080139, -0.04459432139992714, 0.01620868593454361, -0.03873739764094353, 0.0321994423866272, -0.0332346186041832, 0.02720062807202339, -0.04263293370604515, 0.009902281686663628, -0.02720062807202339, -0.021330086514353752, 0.024095097556710243, -0.015336958691477776, 0.005117995198816061, -0.003316651564091444, 0.04045361280441284, 0.04426742345094681, 0.04688260331749916, -0.0019239302491769195, 0.0006167643587104976, -0.012626430951058865, 0.025607001036405563, -0.020907843485474586, -0.01812921278178692, 0.004995408467948437, -0.0014327320968732238, 0.02754114754498005, -0.04219706729054451, 0.015432304702699184, 0.015323338098824024, -0.05480987951159477, 0.026928212493658066, -0.0644533634185791, -0.0252119991928339, 0.01698506996035576, -0.008165637031197548, 0.052657801657915115, -0.010923837311565876, 0.021057672798633575, -0.020812498405575752, -0.007736583240330219, -0.020771635696291924, 0.013184881769120693, -0.004471009597182274, -0.01823817752301693, 0.003769541159272194, -0.008226930163800716, 0.03026529587805271, -0.021057672798633575, -0.11397839337587357, -0.018251799046993256, 0.015745582059025764, -0.011659357696771622, -0.002342768246307969, -0.026383383199572563, -0.012871604412794113, -0.03386117145419121, 0.02974770776927471, 0.01675351709127426, -0.035822559148073196, -0.0022950954735279083, 0.003156607737764716, -0.008383568376302719, 0.025239240378141403, -0.02846735715866089, 0.023005438968539238, 0.030510470271110535, 0.019668355584144592, 0.013498158194124699, -0.03495083376765251, -0.06505268067121506, 0.008785380981862545, -0.016699032858014107, -0.006541362963616848, -0.015091786161065102, -0.022528711706399918, -0.028358392417430878, -0.010256420820951462, -0.010385817848145962, -0.02122112177312374, 0.009486849419772625, 0.024762514978647232, 0.019286975264549255, -0.024721652269363403, -0.006626492366194725, 0.036340147256851196, -0.03075564280152321, -0.018578696995973587, -0.013716090470552444, 0.008730897679924965, -0.013947643339633942, 0.0024466263130307198, -0.013974884524941444, 0.039854299277067184, 0.03658532351255417, 0.0018592317355796695, 0.02849459834396839, 0.00010625245340634137, 0.013974884524941444, -0.006108904257416725, -0.028194943442940712, 0.012299533002078533, 0.014615059830248356, -0.0053733838722109795, -0.00444036303088069, -0.019845426082611084, 0.02961149998009205, 0.008104342967271805, -0.01964111439883709, 0.0030101847369223833, 0.018837491050362587, 0.013157639652490616, -0.023209750652313232, 0.040916718542575836, 0.009289348497986794, -0.03462393581867218, 0.013906780630350113, -0.002247422933578491, -0.015568511560559273, 0.03004736453294754, -0.013287036679685116, -0.0226240586489439, -0.0059454552829265594, 0.017693348228931427, 0.048816751688718796, -0.0010811466490849853, 0.009568573907017708, 0.04067154601216316, -0.0013365356717258692, 0.0077025312930345535, -0.012680914252996445, 0.021084913983941078, 0.025130275636911392, -0.03116426430642605, -0.024394754320383072, -0.06527061015367508, -0.028004251420497894, -0.009902281686663628, 0.0029454862233251333, -0.05562712252140045, -0.04072602838277817, -0.002153780311346054, -0.0006048462237231433, 0.016998689621686935, -0.007116839289665222, 0.005925024393945932, -0.006626492366194725, -0.07545892894268036, -0.016862481832504272, 0.033125653862953186, 0.013198502361774445, 0.0158681683242321, -0.0343242771923542, 0.003020400181412697, 0.01088978536427021, 0.005356357898563147, -0.04293258860707283, 6.906143244123086e-05, -0.015704719349741936, -0.0019188225269317627, 0.0018932835664600134, -0.007511841133236885, -0.07110028713941574, -0.0054653240367770195, -0.04699157178401947, 0.030074605718255043, 0.011155390180647373, -0.0005427015712484717, 0.001250554691068828, 0.0006844424642622471, 0.003827429376542568, -0.018469730392098427, 0.00021857039246242493, 0.021016810089349747, 0.03655808046460152, -0.004535708110779524, 0.01668541319668293, -0.021943019703030586, -0.048299163579940796, 0.0019069043919444084, 0.047236744314432144, -0.030592193827033043, 0.02292371354997158, -0.003561824792996049, -0.00806348118931055, -0.028712531551718712, -0.029584258794784546, 0.008043049834668636, -0.03974533453583717, 0.024667169898748398, -0.028331149369478226, 0.03157288581132889, 0.003321759169921279, 0.026451487094163895, -0.025824932381510735, -0.003321759169921279, -0.024708032608032227, -0.006016964092850685, 0.008526586927473545, -0.011305218562483788, 0.008724086917936802, 0.019981633871793747, -0.0019273353973403573, 0.004382474813610315, 0.017066793516278267, 0.032608065754175186, 0.030292537063360214, -0.0024942990858107805, -0.006643518339842558, 0.021125776693224907, -0.011325649917125702, -0.023768199607729912, -0.02993839792907238, 0.016372134909033775, 0.03821980953216553, -0.014519714750349522, -0.04750915989279747, -0.04399500787258148, 0.04944330453872681, -0.003718463471159339, 0.02838563360273838, -0.022201815620064735, -0.00024112976097967476, 0.023046301677823067, 0.04606536030769348, -0.03274426981806755, 0.017121275886893272, 0.0158681683242321, -0.06058507412672043, -0.014901095069944859, -0.008077101781964302, -0.021847674623131752, 0.02551165595650673, 0.025906657800078392, 0.0025266483426094055, -0.02096232771873474, 0.049225375056266785, 0.04219706729054451, -0.028712531551718712, 0.006691190879791975, -0.031654611229896545, 0.012626430951058865, -0.01981818489730358, -0.01776145212352276, 0.02635614201426506, 0.017216622829437256, 0.003064667573198676, 0.022910093888640404, 0.04154327139258385, -0.022460609674453735, -0.03702118620276451, 0.023877166211605072, 0.03015632927417755, -0.02171146869659424, -0.01278987992554903, 0.006074852310121059, 0.0020073573105037212, 0.005182693712413311, 0.024599066004157066, -0.035495661199092865, 0.013722901232540607, -0.011005561798810959, 0.010474353097379208, 0.03792015463113785, 0.05017882585525513, -0.003541393671184778, 0.01177513413131237, 0.010767199099063873, 0.011434615589678288, -0.015554890967905521, -0.008649173192679882, -0.02890322171151638, -0.026887351647019386, 0.0006695447373203933, 0.026451487094163895, -0.03505979850888252, -0.023863546550273895, 0.015609374269843102, -0.025457173585891724, 0.012687724083662033, -0.0031293663196265697, -0.03805636242032051, 0.016998689621686935, -0.00037180379149504006, 0.019178008660674095, -0.03448772802948952, 0.031872544437646866, 0.004147517029196024, -0.009915902279317379, 0.010045299306511879, -0.01675351709127426, 0.0022269918117672205, -8.401233208132908e-05, -0.003864886472001672, -0.024530962109565735, 0.003386457683518529, 0.002005654852837324, 0.040589820593595505, -0.003592471592128277, -0.00959581509232521, 0.0161269623786211, -0.0040147146210074425, -0.0062587326392531395, 0.007539082318544388, -0.04824468120932579, 0.005652609281241894, 0.021575260907411575, 0.003446048591285944, 0.06532509624958038, -0.006374508608132601, -0.004467604216188192, 0.031763579696416855, -0.023863546550273895, -0.003769541159272194, -0.013586693443357944, -0.034160830080509186, 0.03195426985621452, -0.03713015094399452, -0.03522324562072754, 0.029066670686006546, 0.010971509851515293, 0.020240427926182747, 0.026642177253961563, 0.010528836399316788, 0.0019256328232586384, 0.023196129128336906, 0.020512841641902924, 0.020771635696291924, -0.011305218562483788, -0.02661493606865406, -0.022678541019558907, 0.039772577583789825, -0.019218871369957924, 0.024149581789970398, -0.0041066547855734825, -0.01970921829342842, 0.028957704082131386, 0.0013331304071471095, 0.013498158194124699, -0.002599859843030572, 0.04824468120932579, 0.015405062586069107, -0.029584258794784546, 0.006282568909227848, 0.017993004992604256, -0.02041749656200409, -0.029584258794784546, -0.04791778326034546, 0.021493535488843918, -0.007178132887929678, -0.0023853329475969076, -0.03555014356970787, 0.01650834269821644, -0.019069043919444084, -0.024530962109565735, 0.014941957779228687, 0.020730774849653244, -0.014642301015555859, 0.0012284209951758385, -0.026587694883346558, 0.0311915073543787, -0.015391441993415356, -0.028821496292948723, 0.007069166749715805, 0.02059456706047058, -0.04181568697094917, -0.023795442655682564, -0.014111092314124107, -0.01746179535984993, -0.024612687528133392, 0.022174572572112083, -0.01048116385936737, 0.021207500249147415, -0.014996440149843693, 0.013797814957797527, -0.005737739149481058, 0.00424626749008894, 0.0014744456857442856, -0.007205374073237181, -0.0006840167916379869, -0.016712654381990433, 0.012871604412794113, -0.010188317857682705, -0.0013654796639457345, -0.022242676466703415, -0.007818307727575302, -0.00514183146879077, 0.02218819409608841, 0.007804687134921551, -0.007579944562166929, -0.010596939362585545, 0.012769448570907116, -0.01901455968618393, -0.005329116713255644, 0.05884161964058876, -0.01465592160820961, -0.02207922749221325, 0.0023887380957603455, -0.013702469877898693, 0.05747954547405243, 0.005380194168537855, 0.008533396758139133, -0.0012888630153611302, 0.03345255181193352, 0.04015395790338516, 0.03399737924337387, 0.04661019146442413, -0.006146361120045185, -0.002044814405962825, 0.0009875040268525481, -0.020104220137000084, 0.0158681683242321, -0.02879425510764122, -0.014533335343003273, 0.014506093226373196, 0.005764980334788561, 0.0176524855196476, -0.03179081901907921, 0.023087162524461746, 0.019736459478735924, 0.04045361280441284, 0.0012948220828548074, -0.00799537729471922, 0.001061566872522235, -0.028630806133151054, 0.01496919896453619, 0.02720062807202339, -0.022651299834251404, -0.010930648073554039, -0.021057672798633575, -0.046201568096876144, 0.0353594534099102, -0.016590068116784096, -0.026192693039774895, -0.022160952910780907, 0.04805399104952812, -0.010317714884877205, 0.010052110068500042, 0.021166637539863586, -0.012108842842280865, 0.008458483032882214, -0.040998443961143494, 0.007164511829614639, -0.00799537729471922, 0.009050984866917133, 0.020281288772821426, -0.024776136502623558, 0.010385817848145962, 0.015745582059025764, 0.011134958826005459, -0.005417651496827602, 0.002361496677622199, 0.004835364408791065, 0.04459432139992714, -0.013593504205346107, -0.019613873213529587, 0.01234720554202795, -0.01856507547199726, 0.023727338761091232, -0.007757014594972134, 0.00507713295519352, 0.014996440149843693, -0.007695720996707678, 0.020390255376696587, -0.02680562622845173, 0.00972521211951971, 0.0025028118398040533, -0.02030853182077408, -0.00023261678870767355, 0.009554952383041382, 0.003915964160114527, -0.02119387872517109, -0.027159765362739563, 0.010624181479215622, -0.02797701023519039, 0.026124589145183563, 0.019464045763015747, 0.004746829625219107, 0.008403999730944633, 0.02171146869659424, 0.007457357831299305, -0.02122112177312374, -0.0013024837244302034, -0.028549082577228546, 0.012857983820140362, -0.020621808245778084, -0.015527649782598019, 0.0612933523952961, 0.013150829821825027, 0.003461371874436736, -0.015418683178722858, 0.001103280344977975, 0.0012233131565153599, 0.00019228662131354213, 0.0027241490315645933, 0.012544706463813782, -0.03448772802948952, 0.06483474373817444, -0.00028412023675628006, -0.025293724611401558, 0.0020992974750697613, -0.013511779718101025, 0.007144080940634012, -0.021098533645272255, -0.006320025771856308, -0.03541393578052521, 0.008104342967271805, 0.005673040170222521, 0.019504906609654427, -0.018251799046993256, -0.017284724861383438, 0.005312090739607811, -0.018074728548526764, 0.00932340044528246, -0.003715058322995901, -0.009568573907017708, 0.02344130165874958, 0.015622994862496853, 0.02259681560099125, -0.017543520778417587, -0.008417620323598385, -0.019518528133630753, 0.006575414910912514, -0.010453921742737293, 0.03669428825378418, 0.028085976839065552, 0.06772234290838242, -0.003221306251361966, -0.027745457366108894, -0.03680325299501419, 0.021725088357925415, -0.03334358334541321, 0.030592193827033043, -0.052766766399145126, 0.02093508467078209, -0.02898494526743889, 0.0031804440077394247, 0.02724149078130722, 0.0030391288455575705, -0.010780819691717625, -0.011741082184016705, 0.009125899523496628, -0.0041985949501395226, -0.014274541288614273, -0.002807576209306717, -0.000769997772295028, 0.010188317857682705, 0.007225805427879095, -0.009806936606764793, 0.006698001641780138, -0.023686476051807404, 0.005444892682135105, -0.018033865839242935, -0.03315289318561554, 0.04712777957320213, 0.015895409509539604, 0.0239180289208889, -0.02794976904988289, 0.006023774389177561, -0.02141181193292141, -0.00862193200737238, 0.003195767290890217, -0.03481462597846985, -0.008703656494617462, 0.007736583240330219, 0.008111153729259968, 0.03386117145419121, -0.011911341920495033, 0.0026219934225082397, -0.010106593370437622, 0.015432304702699184, 0.040807753801345825, 0.021684225648641586, -0.010665043257176876, -0.0012718370417132974, 0.039554644376039505, 0.03454221040010452, -0.027009937912225723, -0.0026866919361054897, -0.030101846903562546, 0.0032315216958522797, 0.022160952910780907, -0.0024466263130307198, 0.037484291940927505, -0.016521964222192764, -0.019368698820471764, 0.005829678848385811, -0.020254047587513924, -0.01375014241784811, 0.020907843485474586, 0.020254047587513924, -0.0014284756034612656, -0.01724386401474476, 0.00041883790981955826, 0.01338238175958395, 0.011121338233351707, 0.008172446861863136, -0.005148641765117645, -0.011638927273452282, -0.012953328900039196, 0.0005116292159073055, -0.018170073628425598, 0.028712531551718712, -0.05677126720547676, -5.2913401304977015e-05, 0.015881789848208427, 0.012946518138051033, -0.007191753480583429, -0.0038819124456495047, 0.024776136502623558, 0.004389285109937191, -0.001947766519151628, -0.004113465081900358, -0.03244461491703987, -0.01072633732110262, -0.007825118489563465, -0.051404692232608795, 0.02126198261976242, 0.011952203698456287, 0.010991941206157207, 0.007498220074921846, -0.004545923788100481, -0.0006044205510988832, 0.009173572063446045, -0.008356327190995216, 0.0019733053632080555, -0.01299419067800045, -0.04794502258300781, -0.017747830599546432, -0.0048728217370808125, 0.008043049834668636, 0.008397189900279045, 0.018524212762713432, 0.003994283732026815, -0.011924962513148785, -0.02078525722026825, 0.0028109813574701548, 0.010678663849830627, 0.01133245974779129, -0.007470978889614344, 0.03860119357705116, -0.021030429750680923, -0.00819287821650505, 8.502324635628611e-05, -0.006612871773540974, 0.026492349803447723, 0.0025436740834265947, -0.009514090605080128, 0.01190453115850687, -0.008015808649361134, 0.026683039963245392, 0.005853515118360519, 0.007443737238645554, -0.013579882681369781, -0.022542333230376244, 0.012653672136366367, -0.0029863484669476748, 0.0026390193961560726, 0.002409169217571616, -0.015704719349741936, 0.0001955853949766606, 0.0244356170296669, -0.023863546550273895, -0.022978197783231735, 0.015309717506170273, 0.022310780361294746, 0.016222307458519936, 0.003715058322995901, 0.0069159334525465965, -0.01015426591038704, 0.006211059633642435, 0.014642301015555859, -0.03797463700175285, -0.015146268531680107, -0.02085336111485958, 0.018360763788223267, 0.01569109782576561, -0.0013578180223703384, -0.0011867074063047767, 0.03429703786969185, -0.015010061673820019, -0.03274426981806755, 0.00933702103793621, -0.011277977377176285, 0.004682131111621857, -0.0241768229752779, 0.001402936759404838, -0.001803046208806336, -0.0173936914652586, 0.0063438620418310165, 0.01107366569340229, 0.014465231448411942, 0.011298407800495625, 0.010249610990285873, 0.007716152351349592, 0.03669428825378418, 0.007613996509462595, -0.009425555355846882, -0.01698506996035576, -0.0005082240677438676, -0.007430116645991802, 0.01698506996035576, 0.022460609674453735, -0.0005865433486178517, -0.0013552641030400991, -0.01035176683217287, 0.009677539579570293, 0.016699032858014107, -0.001993736485019326, 0.006755889859050512, 0.0063881296664476395, 0.0369122214615345, -0.016862481832504272, -0.00010651848424458876, -0.012946518138051033, -0.027513904497027397, -0.021275604143738747, -0.013961263932287693, -0.0029931587632745504, 0.007307529915124178, 0.025225620716810226, -0.0050226496532559395, 0.03999050706624985, 0.030101846903562546, -0.026151830330491066, -0.0011194549733772874, 0.03214496001601219, 0.005887567065656185, -0.005383599549531937, -0.005795626901090145, 0.019886288791894913, -0.004722993355244398, -0.007777445483952761, -0.03179081901907921, -0.0034256174694746733, 0.015813685953617096, 0.002344470703974366, -0.024599066004157066, 0.027813561260700226, 0.003284302307292819, 0.017924901098012924, -0.03345255181193352, 0.09970385581254959, 0.018919214606285095, 0.030183572322130203, -0.012599189765751362, 0.00980012584477663, 0.008036240004003048, 0.02717338688671589, -0.0009926118655130267, -0.05009710043668747, -0.0022252893541008234, -0.043695349246263504, -0.026165451854467392, -0.01757076196372509, 0.0012233131565153599, 0.008383568376302719, -0.02425854653120041, -0.015554890967905521, 0.01208841148763895, -0.0007312637753784657, -0.015582132153213024, 0.0171348974108696, -0.0022950954735279083, 0.022065607830882072, -0.002009060001000762, -0.032090477645397186, -0.004688941407948732, 0.02137094922363758, -0.0031208533328026533, -0.011087286286056042, 0.02620631456375122, 0.03762049973011017, 0.03999050706624985, -0.008478913456201553, 0.024135960265994072, -0.028658047318458557, 0.03451496735215187, -0.026642177253961563, -0.022120090201497078, -0.006616277154535055, 0.011632116511464119, -0.019695596769452095, -0.026860110461711884, -0.010753578506410122, 0.013552641496062279, 0.017856797203421593, -0.025974761694669724, -0.0009355749352835119, 0.031327713280916214, -0.050560206174850464, -0.013988505117595196, 0.02406785637140274, -0.013273416087031364, -0.015078164637088776, 0.02868529036641121, 0.02846735715866089, -0.026900971308350563, -0.00862193200737238, 0.006698001641780138, 0.005019244737923145, 0.016331274062395096, 0.044240180402994156, 0.01234720554202795, 0.032063234597444534, 0.0065651992335915565, 0.010174696333706379, -0.006554983556270599, 0.0046719154343008995, -0.013246174901723862, -0.0008529991609975696, -0.012115652672946453, 0.01841524802148342, -0.002604967448860407, 0.011352891102433205, -0.031545646488666534, 0.03004736453294754, -0.006180413067340851, -0.015350580215454102, 0.0033404878340661526, -0.0079204635694623, 0.0045425184071063995, -0.020662670955061913, -0.03511428087949753, 0.03315289318561554, 0.023386819288134575, 0.0069533903151750565, 0.041733965277671814, -0.012871604412794113, 0.015554890967905521, 0.0065005007199943066, -0.01496919896453619, -0.01297376025468111, -0.008867105469107628, 0.008574259467422962, 0.0451936312019825, -0.018224557861685753, -0.016195066273212433, -0.009827367961406708, -0.005080537870526314, -0.012755827978253365, -0.005261012818664312, -0.0027667139656841755, 0.020444737747311592, 0.021874917671084404, -0.004358638543635607, 0.0086968457326293, 0.019205251708626747, -0.018483351916074753, 0.019654735922813416, -0.015255235135555267, 0.026560453698039055, 0.030537711456418037, -0.005652609281241894, -0.017965763807296753, -0.03233565017580986, -0.00018834936781786382, -0.03189978376030922, -0.007273477967828512, 0.03345255181193352, 0.011761513538658619, 0.024980446323752403, 0.04301431402564049, 0.0017979383701458573, -0.03127323091030121, 0.0021333491895347834, -0.02447647973895073, -0.0015331851318478584, 0.03244461491703987, 0.007375633344054222, 0.031218748539686203, -0.01746179535984993, -0.002218478824943304, -0.019409561529755592, -0.039963267743587494, -0.016086099669337273, -0.026846488937735558, 0.031545646488666534, -0.0311915073543787, -0.0026236961130052805, -0.01701231114566326, 0.012354016304016113, 0.028222184628248215, -0.02683286741375923, 0.009745643474161625, -0.015445925295352936]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" deep reinforce-
ment learning with a stochastic actor. In International
conference on machine learning . PMLR, 2018.
Heng, J., Bishop, A., Deligiannidis, G., and Doucet, A.
Controlled sequential monte carlo. Annals of Statistics ,
48(5), 2020.
Holtzman, A., Buys, J., Du, L., Forbes, M., and Choi, Y . The
curious case of neural text degeneration. In International
Conference on Learning Representations , 2019.
Hu, E. J., Jain, M., Elmoznino, E., Kaddar, Y ., Lajoie,
G., Bengio, Y ., and Malkin, N. Amortizing intractable
inference in large language models. arXiv preprint
arXiv:2310.04363 , 2023.Khalifa, M., Elsahar, H., and Dymetman, M. A distri-
butional approach to controlled text generation. arXiv
preprint arXiv:2012.11635 , 2020.
Khanov, M., Burapacheep, J., and Li, Y . ARGS: Alignment
as reward-guided search. In The Twelfth International
Conference on Learning Representations , 2024. URL
https://openreview.net/forum?id=shgx0eqdw6 .
Korbak, T., Elsahar, H., Kruszewski, G., and Dymetman,
M. Controlling conditional language models without
catastrophic forgetting. In International Conference on
Machine Learning , pp. 11499–11528. PMLR, 2022a.
Korbak, T., Perez, E., and Buckley, C. L. Rl with kl penalties
is better viewed as bayesian inference. arXiv preprint
arXiv:2205.11275 , 2022b.
Krause, B., Gotmare, A. D., McCann, B., Keskar, N. S.,
Joty, S., Socher, R., and Rajani, N. F. Gedi: Generative
discriminator guided sequence generation. arXiv preprint
arXiv:2009.06367 , 2020.
Lawson, D., Tucker, G., Naesseth, C. A., Maddison, C.,
Adams, R. P., and Teh, Y . W. Twisted variational sequen-
tial monte carlo. In Third workshop on Bayesian Deep
Learning (NeurIPS) , 2018.
Lawson, D., Ravent ´os, A., Warrington, A., and Linderman,
S. Sixo: Smoothing inference with twisted objectives,
2022.
Levine, S. Reinforcement learning and control as proba-
bilistic inference: Tutorial and review. arXiv preprint
arXiv:1805.00909 , 2018.
Lew, A. K., Zhi-Xuan, T., Grand, G., and Mansinghka,
V . K. Sequential monte carlo steering of large language
models using probabilistic programs. arXiv preprint
arXiv:2306.03081 , 2023.
Lioutas, V ., Lavington, J. W., Sefas, J., Niedoba, M., Liu,
Y ., Zwartsenberg, B., Dabiri, S., Wood, F., and Scibior, A.
Critic sequential monte carlo. In The Eleventh Interna-
tional Conference on Learning Representations , 2022.
Liu, A., Sap, M., Lu, X., Swayamdipta, S., Bhagavatula,
C., Smith, N. A., and Choi, Y . Dexperts: Decoding-
time controlled text generation with experts and anti-
experts. In 59th Annual Meeting of the Association for
Computational Linguistics and the 11th International
Joint Conference on Natural Language Processing , 2021.
Liu, J., Cohen, A., Pasunuru, R., Choi, Y ., Hajishirzi, H.,
and Celikyilmaz, A. Don’t throw away your value model!
making ppo even better via value-guided monte-carlo tree
search decoding. arXiv e-prints , pp. arXiv–2309, 2023.
12
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Maddison, C. J., Lawson, J., Tucker","[-0.00851436983793974, 0.002128592459484935, 0.017775019630789757, -0.002751057269051671, -0.029471252113580704, 0.04314851760864258, -0.014165740460157394, 0.018467023968696594, -0.06518411636352539, 0.0187519658356905, 0.06675808876752853, -0.03945782780647278, -0.021899908781051636, 0.016553834080696106, -0.002467810409143567, -0.01434213388711214, 0.013222713954746723, 0.007707030978053808, 0.021764220669865608, 0.05050276219844818, -0.02020381949841976, -0.021425003185868263, -0.0221170075237751, 0.02881995402276516, 0.010027281939983368, -0.029715489596128464, 0.01739509403705597, 0.02862999215722084, -0.004403048660606146, -0.020868686959147453, 0.061167772859334946, -0.02770731970667839, -0.03150656074285507, -0.024613652378320694, -0.04428829252719879, 0.04681207239627838, 0.024912163615226746, 0.004233439452946186, -0.012876711785793304, 0.01807353086769581, 0.008738253265619278, -0.056120213121175766, -0.0056310174986720085, 0.0553060881793499, 0.009077471680939198, 0.061113499104976654, 0.013528010807931423, -0.014125034213066101, 0.024342278018593788, 0.06138487532734871, -0.04521096497774124, 0.009145314805209637, -0.03449167683720589, -0.0193625595420599, -0.032483506947755814, -0.024301571771502495, 0.019756050780415535, 0.012062588706612587, 0.010583599098026752, -0.044505391269922256, -0.022714031860232353, -0.05872540548443794, -0.0008484688005410135, 0.04860314354300499, -0.04073328897356987, -0.029688352718949318, -0.06002800166606903, 0.009694848209619522, -0.01683877781033516, 0.03864370658993721, -0.021357160061597824, -0.00416559586301446, 0.025115694850683212, -0.007116791792213917, -0.03709687292575836, -0.0057022529654204845, -0.010875326581299305, 0.07175137102603912, -0.015807554125785828, -0.035360075533390045, 0.01751721277832985, -0.0029274506960064173, 0.017055876553058624, -0.02789728157222271, -0.051696810871362686, -0.03427457809448242, -0.010631089098751545, 0.011072073131799698, -0.03169652074575424, -0.019321853294968605, -0.023243211209774017, 0.014396408572793007, -0.020665155723690987, -0.006906476803123951, 0.07582198828458786, 0.031615108251571655, 0.02008170075714588, -0.016675952821969986, 0.05093696340918541, -0.014125034213066101, -0.040706150233745575, -0.01991887576878071, 0.02911846525967121, -0.022686894983053207, 0.060245100408792496, 0.004745658487081528, -0.044641077518463135, 0.010061203502118587, -0.04412546753883362, 0.0036160629242658615, -0.06626961380243301, -0.004657461773604155, -0.024993576109409332, 0.03356900438666344, 0.013127733021974564, -0.048576004803180695, -0.02223912626504898, -0.0010880414629355073, -0.014545664191246033, -0.003924751188606024, -0.04086897522211075, -0.019946012645959854, 0.0267303716391325, -0.009660926647484303, 0.005878646392375231, -0.027083158493041992, 0.02255120687186718, -0.0847773402929306, 0.004972934722900391, -0.023826666176319122, -0.02636401727795601, 0.003551611676812172, -0.00036020702100358903, -0.013073458336293697, -0.03763962164521217, -0.014559232629835606, -0.018507730215787888, -0.010773560963571072, -0.01453209575265646, 0.011268818750977516, -0.000878574384842068, -0.02464078925549984, -0.029851175844669342, 0.006390865426510572, -0.046052224934101105, -0.0008340520435012877, -0.012876711785793304, -0.014925587922334671, -0.00515950471162796, 0.018277062103152275, -0.006994673516601324, -0.01666238345205784, -0.025970524176955223, 0.042850006371736526, -0.04705630987882614, -0.05666296184062958, -0.058833956718444824, 0.04141172394156456, 0.042551495134830475, -0.0491458922624588, 0.01591610535979271, 0.08222642540931702, 0.01879267208278179, -0.004596402868628502, 0.0473005473613739, 0.014518526382744312, -0.019389696419239044, 0.05093696340918541, -0.0381009578704834, -0.02758520096540451, 0.0147491954267025, -0.01364334486424923, -0.049498677253723145, -0.01922687143087387, 0.011831920593976974, -0.021723514422774315, -0.04366413131356239, -0.05498043820261955, 0.004128281958401203, -0.034138891845941544, -0.0030326081905514, 0.02727312035858631, -0.046974897384643555, 0.01702873967587948, -0.025414206087589264, -0.0012220325879752636, 0.0004901699139736593, 0.02617405354976654, 0.024654358625411987, 0.044505391269922256, 0.016974464058876038, 0.03213072195649147, 0.06784358620643616, 0.04768047109246254, -0.009749122895300388, -0.025644874200224876, 0.08081527799367905, 0.019443970173597336, -0.012150785885751247, -0.019430402666330338, 0.012788515537977219, 0.03875225409865379, -0.04431542754173279, -0.03723255917429924, 0.010814267210662365, -0.00042232629493810236, -0.0073610288091003895, -0.005430878605693579, -0.046486422419548035, -0.027313826605677605, 0.025889111682772636, -0.026811784133315086, 0.03660839796066284, -0.0014603331219404936, -0.03842660412192345, -0.01774788089096546, -0.02309395559132099, -0.016852345317602158, 0.010983875952661037, 0.05063845217227936, -0.0003638112102635205, 0.008901078253984451, -0.0019979935605078936, 0.004379303194582462, -0.013887581415474415, 0.024423690512776375, 0.03926786780357361, 0.002282936591655016, 0.056120213121175766, 0.008724684827029705, 0.06887480616569519, 0.003555003786459565, 0.0009472660021856427, -0.052375245839357376, -0.002968156710267067, -0.018344905227422714, -0.0006394257652573287, -0.019064046442508698, -0.005953274201601744, -0.02101794257760048, 0.040461912751197815, 0.005061131436377764, 0.021479278802871704, -0.004304675385355949, 0.00620768778026104, 0.04803325608372688, -0.03299912065267563, -0.004833855200558901, 0.01548190601170063, 0.0319678969681263, 0.010495401918888092, -0.0350072905421257, -0.0012288169236853719, 0.004538735840469599, -0.020502330735325813, -0.019403263926506042, -0.002108239335939288, -0.012571415863931179, -0.009206374175846577, -0.009586297906935215, -0.02096366696059704, -0.02046162448823452, -0.03215785697102547, 0.019267577677965164, -0.03801954537630081, 0.00039094864041544497, -0.03291770815849304, 0.01035293098539114, 0.01647242158651352, -0.04743623360991478, -0.010834620334208012, -0.023623134940862656, -0.029769765213131905, 0.03758534416556358, -0.035739999264478683, -0.04404405504465103, 0.02549561858177185, 0.031940758228302, -0.04941726475954056, 0.02168281003832817, 0.020977236330509186, 0.009627004154026508, 0.047897569835186005, 0.0068386332131922245, 0.0019352382514625788, 0.03774816915392876, -0.011703018099069595, -0.019932445138692856, -0.013229498639702797, -0.03826377913355827, -0.0021353766787797213, -0.03698832169175148, 0.009233511984348297, -0.04016340151429176, 0.028032967820763588, 0.024193022400140762, 0.015305512584745884, -0.0061466284096241, 0.01739509403705597, 0.0030580495949834585, 0.041140347719192505, -0.0018165119690820575, 0.0012771554756909609, 0.0010558157227933407, 0.012306826189160347, 0.0344102643430233, -0.02993258833885193, 0.0245729461312294, 0.011703018099069595, 0.0045590889640152454, -0.004932228475809097, -0.0008963833679445088, -0.013528010807931423, 0.0006211927975527942, -0.011262034997344017, -0.029688352718949318, 0.061167772859334946, -0.030014000833034515, 0.04477676376700401, -0.0891193300485611, -0.0485488697886467, -0.001434891833923757, 0.007679893635213375, -0.008059817366302013, -0.019701777026057243, 0.013785815797746181, -0.012021883390843868, 0.03047533705830574, 0.0018555220449343324, -0.0002527173492126167, -0.011791214346885681, 0.034003205597400665, 0.02133002318441868, 0.030149688944220543, -0.023501018062233925, -0.049607228487730026, -0.03983775153756142, 0.04173737391829491, 0.042117297649383545, 0.012076158076524734, -0.07934985309839249, 0.0147491954267025, -0.011479134671390057, -0.03606564924120903, -0.021642103791236877, -0.014152171090245247, -0.014654213562607765, 0.032727744430303574, 0.06187334656715393, 0.0121304327622056, -0.0071982042863965034, -0.03042106330394745, 0.01990530639886856, 0.001561250421218574, 0.029037052765488625, 0.04108607396483421, -0.01862984709441662, 0.020448055118322372, -0.015902535989880562, -0.014925587922334671, -0.001630790182389319, 0.016255322843790054, 0.006214471999555826, 0.008840018883347511, 0.010237596929073334, 0.0184398852288723, -0.046594973653554916, 0.00519342627376318, 0.0190504789352417, 0.013724756427109241, 0.0048542083241045475, 0.032727744430303574, -0.056120213121175766, 0.02476290799677372, -0.04103180021047592, 0.003928143531084061, -0.023853803053498268, 0.010380067862570286, 0.0393221415579319, 0.017177995294332504, -0.0018911398947238922, -0.014898451045155525, 0.0005656458670273423, -0.020543036982417107, -0.010854973457753658, 0.02470863237977028, -0.004694776143878698, 0.015047706663608551, -0.002201524330303073, 0.018901221454143524, 0.023867372423410416, -0.013351617380976677, -0.049742914736270905, 0.05020425096154213, 0.031235186383128166, 0.014599938876926899, -0.012367885559797287, 0.006401041988283396, 0.04597081243991852, 0.00881288107484579, -0.009423473849892616, -0.009762691333889961, -0.02647256664931774, -0.02333819307386875, -0.03948496654629707, 0.0417916476726532, 0.02333819307386875, 0.07261977344751358, 0.00810730829834938, 0.04806039482355118, 0.05953953042626381, -0.030746711418032646, 0.002469506347551942, -0.02568558044731617, 0.014043621718883514, -0.04529237747192383, 0.00033200954203493893, 0.0029885098338127136, 0.05327078327536583, 0.06616105884313583, 0.004782972391694784, -0.03280915692448616, -0.018575573340058327, -0.037015460431575775, -0.01057003065943718, 0.0187383983284235, 0.04271432012319565, -0.038616567850112915, 0.03460022807121277, -0.0466763861477375, -0.03660839796066284, 0.03460022807121277, 0.013907934539020061, -0.01892836019396782, 0.0104479119181633, -0.02483075112104416, 0.0405433252453804, 0.021397866308689117, -0.007130360696464777, -0.06105922535061836, -0.004840639885514975, 0.008663625456392765, -0.06838633120059967, 0.009111393243074417, -0.023148231208324432, -0.015210531651973724, -0.02470863237977028, -0.014301427640020847, 0.014803470112383366, -0.04200874641537666, 0.019891738891601562, 0.01732725091278553, 0.027001745998859406, -0.01929471455514431, 0.00035278662107884884, -0.01795141212642193, 0.0970977395772934, -0.025142831727862358, 0.04651356115937233, -0.021099355071783066, 0.008677193894982338, -0.01948467642068863, -0.033161941915750504, -0.03782958164811134, 0.009654141962528229, 0.04325706884264946, 0.047761883586645126, -0.005481761414557695, 0.027666613459587097, 0.01776145026087761, 0.032836295664310455, 0.010692148469388485, -0.01677093468606472, -0.009884810075163841, -0.015712574124336243, -0.026635391637682915, 0.017435800284147263, -0.06002800166606903, -0.02795155718922615, -0.02993258833885193, 0.023609567433595657, -0.009640573523938656, 0.03587568551301956, 0.031180910766124725, 0.02568558044731617, 0.042063020169734955, -0.00943704228848219, 0.005888822954148054, -0.015305512584745884, 0.01598394848406315, -0.017476506531238556, -0.02556346170604229, 0.007015026640146971, -0.015291943214833736, 0.01701517030596733, 0.004911875352263451, -0.023256780579686165, -0.020488761365413666, 0.018412748351693153, -0.037503931671381, 0.03527866303920746, -0.00921315886080265, -0.01867055334150791, 0.009199589490890503, 0.020244525745511055, 0.014179308898746967, 0.027680182829499245, 0.004060438368469477, 0.029851175844669342, 0.04431542754173279, -0.012910634279251099, 0.0013059889897704124, -0.0224155206233263, -0.0009336973307654262, -0.007713815197348595, 0.02279544435441494, -0.053677842020988464, -0.02014954388141632, 0.01038685254752636, 0.02143857255578041, 0.004745658487081528, -0.04257863387465477, -0.001274611335247755, -0.02739523909986019, 0.03023110143840313, -0.006872554775327444, -0.006261962931603193, -0.061113499104976654, 0.017286544665694237, -0.0013322783634066582, 0.023026112467050552, -0.015088412910699844, 0.018901221454143524, -0.008181936107575893, -0.06154770031571388, 0.013046321459114552, 0.0005817587370984256, -0.02082798071205616, -0.034138891845941544, 0.004708344582468271, 0.01339910738170147, 0.021289316937327385, 0.0019233656348660588, 0.012713887728750706, -0.0319678969681263, -0.0075849127024412155, 0.009396336041390896, -0.02624189853668213, -0.0066452790051698685, 0.03839946910738945, 0.03902363032102585, -0.03630988672375679, -0.014274289831519127, -0.02255120687186718, -0.0187383983284235, -0.020977236330509186, 0.03042106330394745, 0.0014153867959976196, 0.005257877521216869, 0.005447839852422476, 0.02568558044731617, -0.019701777026057243, -0.0058243717066943645, 0.010454696603119373, -0.010332577861845493, 0.00881288107484579, 0.03332476690411568, -0.0368526354432106, 0.01800568774342537, 0.012211845256388187, -0.029905451461672783, 0.001772413612343371, 0.015101981349289417, 0.0003082642797380686, 0.011133131571114063, -0.023609567433595657, 0.006607965100556612, -0.011716586537659168, 0.010536108165979385, 0.0023592605721205473, -0.0331890806555748, -0.014233583584427834, -0.005369819700717926, -0.019823895767331123, -0.05291799455881119, 0.024667926132678986, 0.0066147493198513985, 0.006499415263533592, -0.01345338299870491, -0.005603880155831575, 0.03237495943903923, -0.03902363032102585, -0.03796526789665222, -0.006719906814396381, -0.031045224517583847, -0.005932921543717384, 0.02439655177295208, -0.03052961267530918, -0.02739523909986019, 0.02322964370250702, 0.001911492901854217, -0.006360335741192102, -0.035848550498485565, -0.034681640565395355, -0.003153030527755618, 0.03153369575738907, -0.021031510084867477, 0.026879627257585526, 0.013249851763248444, -0.02248336374759674, -0.007679893635213375, 0.006278923712670803, 0.018589142709970474, -0.029091328382492065, -0.020122407004237175, -0.003551611676812172, -0.0008577972766943276, -0.027476651594042778, 0.05128974840044975, -0.041438858956098557, 0.023134661838412285, -0.0036974751856178045, 0.030502475798130035, -0.011499487794935703, -0.006519768387079239, 0.02204916439950466, 0.0032598841935396194, -0.023365329951047897, -0.02303967997431755, -0.025970524176955223, -0.03343331813812256, -0.014396408572793007, -0.010095125064253807, 0.013935072347521782, 0.029634077101945877, -0.01019689068198204, -0.005705645307898521, 0.004949189256876707, 0.009789829142391682, -0.024423690512776375, 0.023636704310774803, 0.000963378872256726, -0.017910705879330635, -0.016418147832155228, 0.029498390853405, -0.001845345483161509, 0.006845417432487011, 0.02772088721394539, -0.018358472734689713, -0.010576814413070679, -0.04958008974790573, -0.027110295370221138, 0.04130317270755768, -0.010156184434890747, 0.037449657917022705, -0.03641843423247337, 0.028928503394126892, -0.03758534416556358, 0.016133204102516174, -0.01647242158651352, -0.029091328382492065, 0.012184707447886467, -0.02439655177295208, 0.0018351689213886857, -0.008724684827029705, 0.04141172394156456, 0.01967463828623295, 0.0473005473613739, 0.017557919025421143, -0.006546905729919672, -0.004796541295945644, 0.010990660637617111, -0.00731353834271431, -0.022591913118958473, -0.0022235733922570944, -0.023175368085503578, 0.028955642133951187, -0.046242184937000275, 0.008609350770711899, 0.011886196210980415, -0.05316223204135895, 0.025156401097774506, -0.07196847349405289, -0.024912163615226746, 0.01253749430179596, -0.007272832095623016, 0.04282287135720253, -0.00603468669578433, 0.025088557973504066, -0.010793914087116718, 0.00017098702664952725, -0.018643416464328766, 0.00048635367420502007, -0.012035451829433441, -0.022714031860232353, 0.001760540995746851, 0.01330412644892931, 0.03666267171502113, -0.008833234198391438, -0.11875341087579727, -0.017313681542873383, -0.001340758870355785, -0.012666396796703339, 0.0014365878887474537, -0.02310752496123314, -0.0035414351150393486, -0.03758534416556358, 0.02309395559132099, 0.025414206087589264, -0.029579801484942436, -0.009898378513753414, -0.008256563916802406, -0.013880796730518341, 0.0068691628985106945, -0.052755169570446014, 0.020380211994051933, 0.02808724343776703, 0.006139844190329313, 0.01781572587788105, -0.051452573388814926, -0.0657811388373375, 0.008351544849574566, -0.006017725914716721, -0.009043549187481403, -0.007333891466259956, -0.020380211994051933, -0.022144146263599396, -0.009911947883665562, -0.004016340244561434, 0.008975706063210964, 0.009973006322979927, -0.0012788515305146575, 0.03587568551301956, -0.043528441339731216, -0.0045997947454452515, 0.03343331813812256, -0.0417645089328289, -0.015712574124336243, -0.016309596598148346, 0.0019521991489455104, 0.0016189174493774772, -0.01770717464387417, -0.022564776241779327, 0.05055703967809677, 0.02647256664931774, 0.007293185219168663, 0.030583886429667473, 0.012157570570707321, 0.012924202717840672, -0.00020088060409761965, -0.017096582800149918, 0.012374669313430786, 0.018969066441059113, -0.00031123243388719857, 0.0003125045041088015, -0.012490003369748592, 0.011546977795660496, -0.0015018873382359743, -0.019579658284783363, -0.002147249411791563, 0.0023847019765526056, -0.0031632070895284414, -0.018100667744874954, 0.03267347067594528, 0.009973006322979927, -0.034627363085746765, 0.01953895203769207, -0.0027374885976314545, 0.001763933221809566, 0.05202246084809303, -0.001153340912424028, 0.004874561447650194, 0.012571415863931179, 0.02206273376941681, 0.03416602686047554, -0.00026904221158474684, 0.007035379763692617, 0.03690690919756889, -0.010563245974481106, 0.007761306129395962, 0.020380211994051933, 0.013032752089202404, 0.019647501409053802, -0.04165596142411232, -0.02450510300695896, -0.04287714511156082, -0.03473591431975365, -0.016635246574878693, -0.009457395412027836, -0.058399755507707596, -0.03975633904337883, -0.007503500208258629, 0.015373355709016323, 0.014260721392929554, -0.011289171874523163, 0.023975921794772148, -0.009674495086073875, -0.09438399225473404, -0.028847090899944305, 0.03902363032102585, 0.028738541528582573, 0.016988033428788185, -0.04344702884554863, 0.021153628826141357, -0.00857542920857668, -0.008765391074120998, -0.048141807317733765, 0.01732725091278553, -0.012727456167340279, 0.00042317435145378113, 0.0017808940028771758, -0.0070760855451226234, -0.05074699968099594, -0.007937699556350708, -0.03308052942156792, 0.026255466043949127, 0.0004626084410119802, 0.006587611977010965, -0.0020997589454054832, -0.019701777026057243, 0.019769620150327682, -0.03270060569047928, 0.016024654731154442, 0.017612194642424583, 0.028792817145586014, -0.015563317574560642, 0.030014000833034515, -0.013833306729793549, -0.0485217310488224, -0.012741024605929852, 0.05568601191043854, -0.03416602686047554, 0.008907862938940525, -0.00804624892771244, -0.02784300595521927, -0.01824992336332798, -0.012564631178975105, -0.013731541112065315, -0.044885315001010895, 0.04084183648228645, 0.0032547959126532078, 0.03451881557703018, 0.01352122612297535, 0.030746711418032646, -0.036282747983932495, 0.0001845557417254895, -0.025712717324495316, 0.009179236367344856, -0.007605265825986862, -0.000689884414896369, -0.008955352939665318, 0.02868426777422428, 0.029634077101945877, 0.007740953005850315, -0.004090968053787947, 0.053433604538440704, 0.04032622650265694, 0.0037008675280958414, -0.005742959212511778, 0.029769765213131905, -0.007659540511667728, -0.0251971073448658, -0.01250357273966074, 0.011072073131799698, 0.01370440423488617, -0.0245865136384964, -0.020176680758595467, -0.03772103041410446, 0.04032622650265694, 0.0007072693551890552, 0.03270060569047928, -0.017191564664244652, -0.01966107077896595, 0.022659756243228912, 0.027924418449401855, -0.04849459230899811, 0.01007477194070816, 0.03150656074285507, -0.051208335906267166, -0.019430402666330338, 3.919556911569089e-05, -0.015088412910699844, 0.04081470146775246, 0.002700174693018198, -0.006764005403965712, -0.014776332303881645, 0.045862261205911636, 0.05506185069680214, -0.035115838050842285, 0.00863648857921362, -0.045862261205911636, 0.009565944783389568, -0.023731686174869537, -0.022211989387869835, 0.021709946915507317, 0.0181278046220541, -0.009749122895300388, 0.02297183685004711, 0.04073328897356987, -0.05069272592663765, -0.027205277234315872, -0.0004532799357548356, 0.03926786780357361, -0.004779580514878035, -0.01891479082405567, -0.0010252861538901925, -0.010210459120571613, 0.0016045006923377514, 0.006770789623260498, -0.04602508619427681, 0.011777645908296108, -0.000570734147913754, 0.012028667144477367, 0.04409832879900932, 0.03975633904337883, 0.0032446193508803844, 0.021614965051412582, 0.015888966619968414, 0.0018792672781273723, -0.026011230424046516, -0.0184398852288723, -0.023121092468500137, -0.027870144695043564, -0.001636726432479918, 0.01720513217151165, -0.03109949827194214, -0.022564776241779327, 0.018263492733240128, -0.008378682658076286, 0.01115348469465971, -0.004365734755992889, -0.027598770335316658, 0.011960824020206928, 0.004284322261810303, 0.024098040536046028, -0.022374814376235008, 0.03883366659283638, -0.0006987889064475894, -0.01584826037287712, 0.005905783735215664, -0.0011058504460379481, 0.012673181481659412, 0.004922051914036274, -0.010821051895618439, -0.021397866308689117, -0.003427796997129917, 0.011770862154662609, 0.030638162046670914, 0.013799385167658329, -0.023704547435045242, 0.014111465774476528, 0.0060652163811028, -0.0023287308868020773, 0.02046162448823452, -0.03693404793739319, 0.014206446707248688, 0.024559376761317253, 0.011987960897386074, 0.06588968634605408, -0.018656985834240913, -0.011160269379615784, 0.008758606389164925, -0.027381669729948044, 0.010800698772072792, -0.02974262647330761, -0.017042307183146477, 0.009898378513753414, -0.04160168394446373, -0.04700203612446785, 0.023826666176319122, 0.01824992336332798, 0.01635030284523964, 0.02483075112104416, -0.008310838602483273, 0.0048236786387860775, 0.03221213445067406, 0.038372330367565155, 0.023975921794772148, -0.01419287733733654, -0.02542777545750141, -0.003571964567527175, 0.0436369925737381, -0.018290629610419273, 0.025034282356500626, 0.00028282293351367116, -0.017245838418602943, 0.047083448618650436, 0.009023196995258331, 0.014586370438337326, -0.006753828842192888, 0.060299377888441086, 0.013616207055747509, -0.016309596598148346, 0.014952725730836391, 0.007713815197348595, -0.013317695818841457, -0.02470863237977028, -0.030312512069940567, 0.01573971100151539, -0.009104608558118343, -0.009973006322979927, -0.008412604220211506, 0.018222786486148834, -0.0009582905913703144, -0.0307195745408535, -0.00851436983793974, 0.022198420017957687, 0.0015502258902415633, -0.009579514153301716, -0.01738152652978897, 0.03731397166848183, -0.010495401918888092, -0.033026255667209625, 0.011703018099069595, 0.003346384735777974, -0.031370874494314194, -0.017069445922970772, -0.024627219885587692, -0.014030053280293941, -0.030014000833034515, 0.010807482525706291, -0.00725247897207737, 0.009884810075163841, 0.0030614417046308517, 0.0045590889640152454, -0.0002452969492878765, -0.00431824428960681, -0.009708416648209095, -0.009837319143116474, 0.008242995478212833, -0.008677193894982338, 0.002154033863916993, -0.01941683329641819, -0.001591780106537044, -0.012313609942793846, -0.01007477194070816, -0.025224244222044945, 0.017245838418602943, 0.010393637232482433, 0.016146773472428322, -0.002379613695666194, 0.009328492917120457, -0.02014954388141632, -0.001483230385929346, 0.059756629168987274, -0.042307257652282715, -0.014491389505565166, 0.0013161655515432358, -0.0005084028234705329, 0.0503942146897316, 0.002805332187563181, 0.006889516022056341, -0.00632980652153492, 0.023867372423410416, 0.037693895399570465, 0.02727312035858631, 0.05055703967809677, -0.01111956313252449, 0.009579514153301716, 0.020448055118322372, -0.013514441438019276, -0.0003568148531485349, -0.03147942200303078, -0.0009939084993675351, 0.02328391745686531, 0.014939157292246819, 0.017652900889515877, -0.039105042815208435, 0.017775019630789757, 0.012388238683342934, 0.05291799455881119, 0.003687298856675625, -0.004216478671878576, 0.005393564701080322, -0.026269035413861275, 0.022537637501955032, 0.017680037766695023, -0.02051590010523796, -0.016078928485512733, -0.027123864740133286, -0.018412748351693153, 0.020977236330509186, -0.02763947658240795, 0.0014052102342247963, -0.010658226907253265, 0.031126635149121284, -0.020176680758595467, 0.009118177928030491, 0.034193165600299835, -0.027381669729948044, 0.013222713954746723, -0.03924072906374931, 0.0017961588455364108, 0.006811495870351791, 0.0064213951118290424, 0.007795227691531181, -0.005512291099876165, 0.02432870864868164, 0.016363872215151787, 0.009002843871712685, 0.015414061956107616, 0.01708301343023777, 0.0007874096045270562, 0.03690690919756889, -0.030692437663674355, -0.00308688310906291, 0.002057356759905815, -0.017978549003601074, 0.016431715339422226, -0.008521153591573238, 0.008697547018527985, 0.026961039751768112, -0.0001148040610132739, 0.005949882324784994, -0.0079851895570755, 0.01941683329641819, -0.0055699581280350685, -0.01542763039469719, -0.011173837818205357, 0.02008170075714588, 0.007069301325827837, -0.014681351371109486, -0.016241753473877907, 0.013466951437294483, -0.01616034097969532, 0.022076301276683807, 0.03845374286174774, -0.0008488928433507681, 0.012313609942793846, 0.013935072347521782, 0.013005615212023258, -0.014491389505565166, -0.0007963140378706157, -0.02052946761250496, 0.006343374960124493, -0.023636704310774803, -0.03620133548974991, 0.06100495159626007, -0.012876711785793304, 0.020787274464964867, -0.014002915471792221, 0.00509844534099102, 0.009416689164936543, 0.0028307735919952393, 0.00721855740994215, 0.02844003029167652, -0.03864370658993721, 0.07750450819730759, 0.011092426255345345, -0.02900991588830948, 0.0019827287178486586, -0.012876711785793304, 0.006760613061487675, -0.024070903658866882, -0.008507585152983665, -0.05375925451517105, 0.010983875952661037, 0.010854973457753658, 0.01016975287348032, 0.0025051243137568235, -0.025468481704592705, 0.00915209949016571, -0.020380211994051933, -0.00848044827580452, -0.001564642647281289, -0.006889516022056341, 0.021655671298503876, 0.021709946915507317, 0.023636704310774803, -0.01892836019396782, -0.023270349949598312, -0.00616019731387496, -0.004460715688765049, -0.03842660412192345, 0.02702888287603855, 5.517591489478946e-05, 0.052510932087898254, -0.004233439452946186, -0.030800987035036087, -0.0417645089328289, 0.017720744013786316, -0.026825353503227234, 0.018154943361878395, -0.03820950537919998, 0.03405747935175896, -0.016296029090881348, -0.0002074529620585963, 0.012035451829433441, -0.004243616014719009, -0.00026204585446976125, 0.005040778312832117, 0.0036228473763912916, -0.0009650749852880836, -0.0070760855451226234, -0.007259263191372156, -0.0012695230543613434, 0.005359643138945103, 0.012313609942793846, 0.003850123379379511, 0.01621461659669876, -0.01127560343593359, -0.011892979964613914, -0.01725940778851509, -0.024247296154499054, 0.03308052942156792, 0.008914646692574024, 0.015156256034970284, -0.0381009578704834, 0.01603822223842144, -0.02347387932240963, 9.089980449061841e-05, -0.005556389689445496, -0.04160168394446373, -0.02157425880432129, 0.005454624071717262, 0.008148014545440674, 0.03796526789665222, -0.020475193858146667, 0.0015807554591447115, -0.02420658990740776, 0.021112922579050064, 0.032727744430303574, 0.00936919916421175, 0.011078856885433197, 0.00396206509321928, 0.010454696603119373, 0.03948496654629707, -0.03772103041410446, 0.009925516322255135, -0.012591768987476826, 0.014708489179611206, 0.022089870646595955, 0.007734168320894241, 0.0202716626226902, -0.014803470112383366, -0.02911846525967121, 0.015658298507332802, -0.007537422236055136, -0.008840018883347511, 0.03666267171502113, 0.00927421823143959, -0.012985262088477612, -0.02432870864868164, -0.010990660637617111, -0.0041079288348555565, -0.003137765685096383, 0.011994745582342148, -0.0023694371338933706, -0.019688207656145096, -0.011384152807295322, 0.0121304327622056, -0.007394950371235609, 0.021913478150963783, -0.023053249344229698, -0.025264950469136238, -0.002723919926211238, 0.022944699972867966, -0.00307331420481205, 0.0044539314694702625, 0.02911846525967121, 0.019254008308053017, -0.010488618165254593, 0.01099744439125061, -0.013134517706930637, -0.005797234363853931, -0.0034311891067773104, -0.03894221782684326, 0.025210674852132797, -0.00511540612205863, 0.019145458936691284, 0.007225341629236937, 0.001775805838406086, -0.012720671482384205, 0.0014086023438721895, 0.024193022400140762, -0.006533337291330099, -0.013439813628792763, -0.04846745729446411, -0.006136452313512564, 0.0035821411292999983, 0.008704331703484058, 0.017666468396782875, 0.031913623213768005, -0.00506791565567255, -0.017462939023971558, -0.033514730632305145, 0.023053249344229698, 0.010312224738299847, 0.03047533705830574, -0.003303982550278306, 0.027245983481407166, -0.012863143347203732, -0.013378754258155823, -0.006455317139625549, -0.025034282356500626, 0.025834836065769196, 0.0014900147216394544, 0.006672416348010302, -0.0081412298604846, -0.023419605568051338, 0.019145458936691284, 0.0052748387679457664, 0.01652669720351696, -0.011262034997344017, -0.03620133548974991, 0.020624449476599693, -0.008188720792531967, 0.008643272332847118, -0.011546977795660496, -0.026377584785223007, -0.007564559578895569, 0.018711259588599205, -0.026703234761953354, -0.021343590691685677, -0.0005016184877604246, 0.007503500208258629, 0.0044641075655817986, -0.003934927750378847, 0.011044935323297977, -0.004593010526150465, -0.001970855984836817, -0.01007477194070816, -0.029661213979125023, -0.030583886429667473, -0.011078856885433197, 0.012082941830158234, 0.017910705879330635, -0.01232039462774992, -0.0071371449157595634, 0.04871169105172157, -0.031370874494314194, -0.04062473773956299, 0.01891479082405567, -0.023134661838412285, 0.008894293569028378, -0.026377584785223007, 0.003687298856675625, -0.008032680489122868, -0.002944411477074027, 0.012510356493294239, 0.015468336641788483, 0.005000072065740824, 0.012171139009296894, 0.009165667928755283, 0.02157425880432129, 0.0074220881797373295, 0.023731686174869537, -0.005281622987240553, -0.008053033612668514, -0.003497336758300662, 0.0019555913750082254, 0.014572801999747753, 0.007544206455349922, -0.0003578749019652605, -0.02008170075714588, -0.0008603414171375334, -0.0007305906037800014, -0.009199589490890503, -0.006088961381465197, 0.013697619549930096, -0.0008438045624643564, 0.022876856848597527, -0.016187479719519615, -0.002301593543961644, 0.004718521144241095, -0.008561859838664532, -0.014518526382744312, -0.0014264113269746304, -0.0029613724909722805, 0.0122932568192482, 0.022388381883502007, -0.009572729468345642, 0.05001429095864296, 0.023121092468500137, -0.02236124500632286, -0.0003474863478913903, 0.03883366659283638, 0.0018521298188716173, -0.004898306913673878, 0.0047524431720376015, 0.013724756427109241, 0.012510356493294239, -0.021519985049962997, -0.008588997647166252, -0.015020569786429405, 0.02112649194896221, 0.01348730456084013, -0.023935215547680855, 0.025766992941498756, 0.0029155779629945755, 0.016608109697699547, -0.034084614366292953, 0.09221299737691879, 0.0048847380094230175, 0.03109949827194214, -0.018846947699785233, 0.00044861569767817855, 0.004504813812673092, 0.038372330367565155, -0.0014094504294916987, -0.04171023517847061, -0.020475193858146667, -0.03902363032102585, -0.011594468727707863, -0.01616034097969532, -0.014206446707248688, 0.014518526382744312, -0.010983875952661037, -0.029579801484942436, 0.00492883613333106, 0.011017797514796257, -0.01782929338514805, 0.013867228291928768, -0.001818208023905754, 0.03077385015785694, -0.010359714739024639, -0.026947470381855965, 0.0027374885976314545, 0.018154943361878395, 0.0058989995159208775, -0.032293546944856644, 0.003409140044823289, 0.02862999215722084, 0.039783477783203125, 0.004684599582105875, 0.032537780702114105, -0.03541434928774834, 0.029634077101945877, -0.02819579280912876, -0.02561773732304573, -0.004969542380422354, 0.0072999694384634495, -0.045563749969005585, -0.043826956301927567, -0.005997372791171074, 0.005088268779218197, 0.016689522191882133, -0.024043766781687737, 0.014206446707248688, 0.02143857255578041, -0.03899649158120155, -0.025821268558502197, 0.01701517030596733, 0.0010032369755208492, -0.04016340151429176, 0.006987889297306538, 0.026567546650767326, -0.01910475268959999, -0.015061275102198124, 0.006356943864375353, -0.0064180027693510056, 0.009721985086798668, 0.05986517667770386, -0.00609574606642127, 0.03761248290538788, -0.0019895131699740887, -0.003544827224686742, 0.00015953842375893146, 0.02168281003832817, -0.021845633164048195, 0.010861757211387157, -0.004888130351901054, 0.034817326813936234, -0.017218701541423798, 0.006814887747168541, -0.03183221071958542, 0.029471252113580704, -0.0002991477958858013, -0.007720599882304668, 0.005003464408218861, -0.009409905411303043, -0.008195504546165466, 0.00105666380841285, -0.026635391637682915, 0.02998686395585537, -0.0008569492492824793, 0.0036160629242658615, 0.03120804764330387, -0.013059889897704124, 0.018358472734689713, 0.0014018180081620812, -0.019511815160512924, -0.01788356900215149, 0.007571343798190355, 0.017910705879330635, 0.05476333945989609, -0.01096352282911539, 0.001135531929321587, 0.008249780163168907, 0.013717972673475742, -0.0010626001749187708, -0.01683877781033516, -0.0062212566845119, 0.01026473380625248, 0.018887653946876526, 0.0044980295933783054, 0.00801911111921072, 0.021397866308689117, -0.007645971607416868, 0.020855117589235306, -0.008399035781621933, 0.01732725091278553, 0.01903690956532955, 0.007069301325827837, 0.00013929135457146913, -0.01763933151960373, 0.01985103264451027, -0.03568572551012039, 0.003999379463493824, 0.035550039261579514, 0.011574115604162216, 0.011811567470431328, 0.03042106330394745, -0.0021268962882459164, -0.03907790407538414, 0.002216789172962308, -0.014030053280293941, -0.005627625156193972, 0.028738541528582573, 0.015766847878694534, 0.028304342180490494, -0.0202716626226902, -0.003921359311789274, -0.029525527730584145, -0.031045224517583847, -0.0006538425222970545, -0.02255120687186718, 0.027693750336766243, -0.049851465970277786, 0.025359932333230972, -0.02229340188205242, 0.019769620150327682, 0.02365027368068695, -0.02352815493941307, 0.026391154155135155, -0.01438283920288086]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
", G., Heess, N., Norouzi,
M., Mnih, A., Doucet, A., and Teh, Y . Filtering varia-
tional objectives. Advances in Neural Information Pro-
cessing Systems , 30, 2017.
Mudgal, S., Lee, J., Ganapathy, H., Li, Y ., Wang, T., Huang,
Y ., Chen, Z., Cheng, H.-T., Collins, M., Strohman, T.,
et al. Controlled decoding from language models. arXiv
preprint arXiv:2310.17022 , 2023.
Nachum, O., Norouzi, M., Xu, K., and Schuurmans, D.
Bridging the gap between value and policy based rein-
forcement learning. Advances in neural information pro-
cessing systems , 30, 2017.
Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright, C.,
Mishkin, P., Zhang, C., Agarwal, S., Slama, K., Ray, A.,
et al. Training language models to follow instructions
with human feedback. Advances in Neural Information
Processing Systems , 35:27730–27744, 2022.
Parshakova, T., Andreoli, J.-M., and Dymetman, M. Distri-
butional reinforcement learning for energy-based sequen-
tial models. arXiv preprint arXiv:1912.08517 , 2019.
Perez, E., Huang, S., Song, F., Cai, T., Ring, R., Aslanides,
J., Glaese, A., McAleese, N., and Irving, G. Red teaming
language models with language models. In Proceedings
of the 2022 Conference on Empirical Methods in Natural
Language Processing , pp. 3419–3448, 2022.
Phan, D., Hoffman, M. D., Douglas, S., Le, T. A., Parisi,
A. T., Sountsov, P., Sutton, C., Vikram, S., Saurous, R. A.,
et al. Training chain-of-thought via latent-variable infer-
ence. In Thirty-seventh Conference on Neural Informa-
tion Processing Systems , 2023.
Pich´e, A., Thomas, V ., Ibrahim, C., Bengio, Y ., and Pal,
C. Probabilistic planning with sequential monte carlo
methods. In International Conference on Learning Rep-
resentations , 2018.
Qin, L., Welleck, S., Khashabi, D., and Choi, Y . Cold
decoding: Energy-based constrained text generation with
langevin dynamics. Advances in Neural Information
Processing Systems , 35:9538–9551, 2022.
Rafailov, R., Sharma, A., Mitchell, E., Ermon, S., Manning,
C. D., and Finn, C. Direct preference optimization: Your
language model is secretly a reward model. arXiv preprint
arXiv:2305.18290 , 2023.
Schulman, J., Wolski, F., Dhariwal, P., Radford, A., and
Klimov, O. Proximal policy optimization algorithms.
arXiv preprint arXiv:1707.06347 , 2017.
Shih, A., Sadigh, D., and Ermon, S. Long horizon tempera-
ture scaling. arXiv preprint arXiv:2302.03686 , 2023.Snell, C. V ., Kostrikov, I., Su, Y ., Yang, S., and Levine,
S. Offline rl for natural language generation with im-
plicit language q learning. In The Eleventh International
Conference on Learning Representations , 2022.
Sobolev, A. and Vetrov, D. P. Importance weighted hierarchi-
cal variational inference. Advances in Neural Information
Processing Systems , 32, 2019.
Stiennon, N., Ouyang, L., Wu, J., Ziegler, D., Lowe, R.,
V oss, C., Radford, A., Amodei, D., and Christiano,
P. F. Learning to summarize with human feedback. Ad-
vances in Neural Information Processing Systems , 33:
3008–3021, 2020.
Vilnis, L., Zemlyanskiy, Y ., Murray, P., Passos, A. T., and
Sanghai, S. Arithmetic","[-0.029654977843165398, 0.030659334734082222, 0.01884491927921772, -0.017510181292891502, 0.002168949693441391, 0.039936427026987076, -0.00024303635291289538, 0.04125794768333435, -0.046755485236644745, 0.017668763175606728, 0.04191870987415314, -0.032720912247896194, -0.015038932673633099, 0.025888636708259583, 0.003209649119526148, -0.02304736152291298, 0.028333453461527824, -0.012217480689287186, 0.04075577110052109, 0.03745196387171745, 0.0013710801722481847, -0.046544041484594345, -0.025690408423542976, 0.03631545230746269, 0.031372956931591034, 5.0976719649042934e-05, 0.02329845167696476, 0.06803200393915176, -0.011715302243828773, -0.037002645432949066, 0.017827345058321953, -0.026417246088385582, -0.04783913493156433, -0.012673405930399895, -0.020549682900309563, 0.023311667144298553, 0.0019608098082244396, 0.0034921246115118265, -0.023457033559679985, 0.02665512077510357, -0.012746090069413185, -0.06787342578172684, -0.004479963332414627, 0.04461461678147316, -0.005355472210794687, 0.05151296779513359, -0.0018203980289399624, -0.012726266868412495, -0.009012787602841854, 0.05238517373800278, -0.02325880527496338, 0.01869955100119114, -0.032086580991744995, -0.04720480367541313, -0.016532253473997116, -0.014748197048902512, 0.017338382080197334, -0.002154082525521517, 0.016201872378587723, -0.01789342239499092, 0.005071344785392284, -0.07548539340496063, -0.006254107691347599, 0.05925709381699562, -0.027514109387993813, -0.026152940467000008, -0.05222659185528755, 0.017866991460323334, -0.015580756589770317, 0.04260590299963951, 0.008603114634752274, 0.01336720585823059, 0.04945139214396477, -0.02325880527496338, -0.017298737540841103, 0.004546039272099733, -0.0036837453953921795, 0.06512465327978134, -0.03134652599692345, -0.030395030975341797, -0.005282788537442684, -0.009290306828916073, 0.0274348184466362, -0.040147870779037476, -0.049266379326581955, -0.03340810164809227, -0.029602115973830223, -0.0019426388898864388, -0.02340417355298996, -0.00047533531324006617, -0.04342524707317352, 0.004714533686637878, -0.04723123461008072, -0.005335649475455284, 0.05286092311143875, 0.027302665635943413, 0.006422602105885744, -0.005768448114395142, 0.05045574903488159, 0.02245267666876316, -0.04818272963166237, -0.026047218590974808, 0.03557540103793144, -0.026007574051618576, 0.033460963517427444, -0.0017824042588472366, -0.003891885280609131, -0.0028264073189347982, -0.004767394624650478, -0.01865990459918976, -0.09964283555746078, -0.008299164474010468, -0.025003215298056602, -0.02099900133907795, -0.0031121866777539253, -0.06396171450614929, -0.06898350268602371, 0.011748339980840683, -0.016743697226047516, 0.0011794592719525099, -0.004027341492474079, 0.014734981581568718, 0.03385742008686066, -0.002641394268721342, 0.006670387461781502, -0.025399673730134964, 0.026152940467000008, -0.07252518832683563, -0.0021606902591884136, -0.01831630989909172, -0.008940103463828564, -0.0027223373763263226, 0.00910529401153326, -0.03079148754477501, -0.04408600926399231, -0.011074363254010677, 0.00023849360877647996, -0.0007004071958363056, -0.01580541580915451, 0.013116116635501385, 0.02520144358277321, -0.005001964513212442, -0.03488820791244507, 0.018435247242450714, -0.06745053827762604, -0.01789342239499092, -0.006891742814332247, -0.015091793611645699, -0.016162225976586342, -0.008048075251281261, 0.0290206465870142, -0.011503858491778374, -0.010129474103450775, 0.014338525012135506, -0.05476391687989235, -0.056296881288290024, -0.04963640496134758, 0.05331024155020714, 0.022386601194739342, -0.05193585529923439, 0.01987570710480213, 0.06972355395555496, 0.00571889104321599, -0.010598614811897278, 0.02598114311695099, 0.01186066959053278, -0.03731980919837952, 0.024633189663290977, -0.03663261979818344, -0.030606472864747047, -0.004470051731914282, -0.011318844743072987, -0.022175157442688942, -0.03139938786625862, -0.008305772207677364, -0.0411522276699543, -0.016413316130638123, -0.03248303756117821, -0.015250376425683498, -0.037346240133047104, 0.0032278201542794704, 0.009733017534017563, -0.06871920078992844, 0.031663693487644196, -0.024593543261289597, 0.0026232232339680195, -0.03340810164809227, 0.026205802336335182, 0.010248411446809769, 0.058675624430179596, 0.0034987323451787233, 0.033751700073480606, 0.08679763227701187, 0.03702907636761665, -0.00020483607659116387, -0.02580934576690197, 0.05058790370821953, -0.040465034544467926, -0.01073076669126749, -0.021765485405921936, 0.008338810876011848, 0.03615687042474747, -0.010103044100105762, -0.04485249146819115, 0.01658511348068714, -0.011821024119853973, -0.0008771609282121062, -0.003292244393378496, -0.05560968816280365, -0.034201014786958694, 0.033751700073480606, 0.014801057986915112, 0.04485249146819115, -0.00915815494954586, -0.05143367871642113, 0.018144510686397552, -0.02857132814824581, -0.007909315638244152, 0.010426816530525684, 0.019809629768133163, -0.0015883054584264755, 0.02216194197535515, 0.02150117978453636, 0.019664263352751732, -0.047997716814279556, 0.039222802966833115, 0.010757197625935078, -0.0055008395574986935, 0.028307024389505386, -0.014219587668776512, 0.07590828090906143, -0.021514395251870155, -0.00677941320464015, -0.01563361845910549, -0.005229927599430084, -0.012904672883450985, 0.024421745911240578, -0.01690227910876274, -0.008920280262827873, -0.041099365800619125, 0.013155762106180191, 0.008563469164073467, 0.030527181923389435, 0.019320666790008545, 0.01749696582555771, 0.06306307762861252, -0.03684406355023384, -0.02538645826280117, 0.029919281601905823, 0.021752269938588142, -0.004698014352470636, -0.005801486317068338, -0.014933210797607899, -0.00020359714108053595, -0.017523394897580147, -0.021395457908511162, -0.0129244951531291, 0.025994358584284782, -0.0275405403226614, -0.003409529570490122, -0.025360027328133583, 0.022267663851380348, 0.009931245818734169, 0.02629830874502659, -0.002355614909902215, 0.0007384010241366923, -0.023457033559679985, 0.01686263456940651, 0.014338525012135506, -0.012303379364311695, -0.0022300700657069683, -0.003310415195301175, -0.007915923371911049, 0.03372526913881302, -0.06116008758544922, -0.04757482931017876, 0.04342524707317352, 0.018408816307783127, -0.06517751514911652, 0.03311736881732941, 0.006891742814332247, 0.027025146409869194, 0.03845632076263428, 0.025214659050107002, -0.0027619830798357725, 0.027381958439946175, 0.008992964401841164, -0.013228445313870907, -0.02171262353658676, -0.02163333259522915, 0.0055999536998569965, 0.0008383411914110184, 0.0135588264092803, -0.047046221792697906, 0.040993645787239075, 0.022386601194739342, 0.04316094145178795, -0.011147046461701393, 0.029152797535061836, -0.029337812215089798, 0.042764484882354736, -0.02920565940439701, 0.016532253473997116, -0.0006021189619787037, -0.0055008395574986935, 0.032535895705223083, -0.03338167071342468, 0.0038720625452697277, 0.040887922048568726, -0.027408387511968613, 0.03560183197259903, 0.010268233716487885, -0.021791914477944374, -0.016096150502562523, -0.029469963163137436, -0.03520537540316582, 0.05024430528283119, -0.019069578498601913, 0.03343453258275986, -0.05957425758242607, -0.024408530443906784, -0.006075702141970396, 0.005864258389919996, -0.0034392636734992266, 0.014338525012135506, 0.02545253373682499, 0.018765626475214958, 0.0377691276371479, -0.005547092761844397, -0.004331291653215885, -0.002048360649496317, 0.02224123291671276, 0.015858275815844536, 0.03454461321234703, -0.012970748357474804, -0.047257665544748306, -0.05151296779513359, 0.03856204077601433, 0.027804844081401825, 0.01078362762928009, -0.09440960735082626, -0.020549682900309563, -0.04546039178967476, -0.018038788810372353, -0.02467283606529236, -0.009488535113632679, -0.04546039178967476, 0.011140439659357071, 0.04561897739768028, 0.026787271723151207, 0.013122723437845707, -0.05056147277355194, 0.025188229978084564, 0.006112044211477041, -0.008880634792149067, 0.012997179292142391, -0.018897779285907745, -0.029284950345754623, -0.006571273319423199, -0.0074335671961307526, -0.0005942723946645856, 0.011074363254010677, 0.016558684408664703, 0.0008193443063646555, 0.0011497250525280833, -0.00685870461165905, -0.019915351644158363, 0.0002275497536174953, -0.01640010066330433, -0.003343453397974372, -0.003574719885364175, 0.01106775552034378, -0.06279877573251724, 0.01785377599298954, -0.027672693133354187, -0.006082309875637293, -0.02591506764292717, 0.02199014276266098, 0.002984990132972598, 0.0419980026781559, 0.011503858491778374, 0.015527895651757717, -0.0010530886938795447, -0.03391028195619583, 0.0009060692391358316, 0.024884279817342758, -0.00940263643860817, 0.0002444817509967834, -0.023919567465782166, -0.012475177645683289, 0.026219017803668976, -0.0005471931654028594, -0.04736338555812836, 0.048526328057050705, 0.03520537540316582, 0.02181834541261196, -0.038482751697301865, 0.02177869901061058, 0.03475605696439743, 0.03142581880092621, -0.000169113656738773, 0.011391528882086277, -0.006878527346998453, 0.002527412725612521, -0.021514395251870155, 0.03739910200238228, 0.009270484559237957, 0.054499611258506775, 0.0015222294023260474, 0.010136081837117672, 0.03705550730228424, -0.06094864383339882, 0.012257126159965992, -0.021157583221793175, 0.03245660662651062, -0.04498464614152908, 0.02382706105709076, 0.004354418255388737, 0.054393887519836426, 0.04672905430197716, 0.013743839226663113, -0.013195407576858997, -0.01743088848888874, -0.046649765223264694, -0.031055791303515434, 0.00537529494613409, 0.02365526184439659, -0.05161869153380394, 0.02308700792491436, -0.040253590792417526, -0.027091221883893013, 0.010479677468538284, 0.0548696368932724, -0.047601260244846344, 0.005120901856571436, -0.07485106587409973, 0.050323598086833954, 0.03190156817436218, 0.00834541767835617, -0.039645690470933914, 0.012343024834990501, -0.015038932673633099, -0.06290449947118759, 0.017232660204172134, -0.01969069428741932, -0.002003759378567338, -0.012831988744437695, 0.03499393165111542, -0.009746232070028782, -0.04659690335392952, 0.030817916616797447, 0.020443961024284363, 0.03739910200238228, 0.007466605398803949, -0.003647403558716178, -0.05349525436758995, 0.10202158242464066, -0.013162369839847088, 0.03718765825033188, 0.017126938328146935, 0.01692871004343033, 0.030923638492822647, -0.028624190017580986, -0.037742696702480316, 0.001313263550400734, 0.039724983274936676, 0.005735409911721945, 0.019532110542058945, 0.02095935493707657, 0.004919369705021381, 0.0009506706264801323, 0.0033814471680670977, -0.019664263352751732, -0.026892993599176407, 0.00479052122682333, -0.019703907892107964, 0.03792771324515343, -0.03872062638401985, -0.01618865691125393, -0.044746771454811096, 0.0137174092233181, -0.02684013359248638, 0.024421745911240578, 0.04250018298625946, 0.024210302159190178, 0.02241303026676178, 0.01778770051896572, -0.024197086691856384, -0.0028346669860184193, 0.0023093614727258682, 0.009184584952890873, -0.013129331171512604, 0.028122009709477425, -0.014497107826173306, 0.004476659465581179, -0.010697728954255581, -0.015858275815844536, 0.0051440284587442875, 0.0053389533422887325, -0.03745196387171745, -0.018078435212373734, -0.031452249735593796, -0.0006801714189350605, -0.012739482335746288, -0.012970748357474804, 0.0008288427488878369, 0.03697621449828148, 0.026047218590974808, 0.03327595070004463, 0.05883420631289482, 0.003455782774835825, 0.002846230287104845, 0.000298581609968096, 0.02422351762652397, 0.0033649280667304993, 0.03552253916859627, -0.0290206465870142, -0.005775055848062038, -0.0020202782470732927, 0.044535327702760696, -0.005461194086819887, -0.04080863296985626, 0.01675691269338131, -0.02262447401881218, 0.022016573697328568, -0.013413459062576294, -0.012686621397733688, -0.08119437843561172, -0.008318987675011158, -0.016466177999973297, 0.028095580637454987, 0.0021210445556789637, -0.003673834027722478, 0.0006330921314656734, -0.06443746387958527, 0.029047075659036636, -0.008021645247936249, -0.028862062841653824, -0.04316094145178795, 0.017972713336348534, 0.010420208796858788, 0.030738625675439835, -0.017404459416866302, 0.03636831417679787, -0.0009969240054488182, -0.015184300020337105, 0.01781413145363331, -0.023998858407139778, -0.01554111111909151, 0.03697621449828148, 0.03425387665629387, -0.031372956931591034, -0.0015627009561285377, -0.017761269584298134, 0.0024233427830040455, -0.009746232070028782, 0.0045922924764454365, 0.012594114989042282, -0.005563612096011639, 0.014589614234864712, 0.007400528993457556, -0.035654690116643906, 0.0014511975459754467, 0.018620260059833527, -0.023747768253087997, -0.008028252050280571, 0.01690227910876274, -0.04469390958547592, 0.019003501161932945, 0.017378028482198715, -0.032615188509225845, -0.004218962509185076, 0.02640403062105179, 0.018395600840449333, 0.01157654169946909, -0.008748482912778854, -0.0062309810891747475, 0.00603605667129159, 0.001353735220618546, 0.027355527505278587, -0.03422744572162628, -0.030765056610107422, 0.00701728742569685, -0.01212497428059578, -0.04324023425579071, 0.0259547121822834, -0.0007850672700442374, 0.02103864774107933, -0.028835633769631386, -0.02082720398902893, 0.054605331271886826, -0.025214659050107002, -0.027857705950737, -0.03731980919837952, -0.03391028195619583, -0.009620687924325466, 0.02354953996837139, -0.029866421595215797, -0.028201302513480186, 0.03435960039496422, -0.005897296592593193, -0.030077865347266197, -0.025994358584284782, -0.008200050331652164, -0.006984249223023653, 0.00699085695669055, -0.021408673375844955, 0.009059040807187557, 0.009660333395004272, -0.011180085130035877, -0.001944290823303163, -0.004281734582036734, 0.025941496714949608, -0.02234695479273796, -0.03488820791244507, -0.021012216806411743, -0.00961408019065857, -0.013360598124563694, 0.042235877364873886, -0.017193015664815903, 0.0009977498557418585, -0.03391028195619583, 0.016096150502562523, -0.004423798527568579, 0.0021639938931912184, 0.023324882611632347, -0.006264019291847944, -0.019769985228776932, -0.014325309544801712, -0.021831560879945755, -0.045592546463012695, -0.01682298816740513, 0.032615188509225845, -0.0030758448410779238, 0.008332203142344952, -6.963806663407013e-05, -0.008371848613023758, -0.012290163896977901, 0.024197086691856384, -0.03800700232386589, 0.02093292586505413, -0.000491028418764472, -0.0020863544195890427, -0.020351454615592957, 0.03097650036215782, 0.007393921259790659, -0.004866508767008781, 0.025862205773591995, -0.028333453461527824, -0.01643974706530571, -0.027064792811870575, -0.04421816021203995, 0.03829773887991905, -0.002097917953506112, 0.024884279817342758, -0.008814558386802673, 0.00876830518245697, -0.02566397748887539, 0.00921101588755846, -0.03472962602972984, -0.047680553048849106, 0.013202015310525894, 0.010922388173639774, 0.017695194110274315, 0.0001374177518300712, 0.025967927649617195, 0.036289021372795105, 0.039539970457553864, 0.020351454615592957, -0.008642761036753654, -0.025545040145516396, -0.004080202430486679, 0.031875137239694595, -0.03153153881430626, -0.01075058989226818, -0.044773202389478683, 0.01764233224093914, -0.008913672529160976, 0.021197229623794556, 0.012025860138237476, -0.05904565006494522, 0.02142188884317875, -0.054658193141222, -0.022650904953479767, 0.011536896228790283, -0.02270376682281494, 0.03364597633481026, -0.02298128604888916, 0.023879921063780785, 0.00977266300469637, 0.019029932096600533, -0.026311524212360382, 0.006138474680483341, -0.01973033882677555, -0.0016006948426365852, 0.01196639146655798, 0.022214801982045174, 0.0396721214056015, -0.032826632261276245, -0.13616973161697388, -0.020708266645669937, 0.016624759882688522, -0.008028252050280571, -0.0015965650090947747, -0.02019287273287773, 0.0017741447081789374, -0.017827345058321953, 0.030632903799414635, 0.027025146409869194, -0.014616045169532299, -0.028544897213578224, -0.015818631276488304, 0.003620973089709878, 0.0388263463973999, -0.034412458539009094, 0.007697871886193752, 0.03916994482278824, 0.010142689570784569, 0.020457176491618156, -0.041839420795440674, -0.07273662835359573, -0.005371991079300642, 0.00553387776017189, 0.0005715587176382542, -0.011900315061211586, -0.03338167071342468, -0.029919281601905823, -0.019862491637468338, 0.0011910226894542575, 0.003521858947351575, -0.0001951311423908919, 0.004162797704339027, 0.00712300930172205, -0.04596257209777832, -0.0014470677124336362, 0.015276806429028511, -0.04688763618469238, 0.007578934542834759, -0.006445728708058596, 0.009065648540854454, -0.000576514401473105, -0.01865990459918976, -0.01228355709463358, 0.03620973229408264, 0.033566687256097794, -0.009548003785312176, 0.025016430765390396, 0.01157654169946909, -0.00677941320464015, -0.013492750003933907, -0.026787271723151207, 0.011688871309161186, 0.012699836865067482, 0.004569165874272585, 0.024686049669981003, -0.02994571253657341, 0.007592150010168552, -0.015607187524437904, -0.019135653972625732, -0.017206229269504547, 0.0028627493884414434, -0.0005348038394004107, -2.7282223527436145e-05, 0.019611401483416557, 0.022968070581555367, -0.024765342473983765, 0.01736481301486492, -0.01141795888543129, -0.016149012371897697, 0.029047075659036636, -0.00677941320464015, -0.0037861636374145746, -0.010757197625935078, 0.02460675872862339, 0.03488820791244507, -0.0016139100771397352, 0.010228588245809078, 0.02361561730504036, -0.0031914780847728252, 0.026932640001177788, -0.020060719922184944, -0.0030758448410779238, 0.02952282503247261, -0.013849561102688313, -0.019492464140057564, -0.047812703996896744, -0.029681406915187836, -0.02336452715098858, -0.006865312345325947, -0.05666690692305565, -0.05582113191485405, 0.006376348901540041, 0.0012347981100901961, 0.003700264496728778, 0.0027553755789995193, -0.0006549798417836428, 0.003097319742664695, -0.06866633892059326, 0.007856454700231552, 0.027672693133354187, 0.005345560610294342, 0.007519466336816549, -0.04511679708957672, 0.016149012371897697, 0.005979891866445541, 0.00866258330643177, -0.04139010235667229, 0.02188442088663578, -0.015924353152513504, 0.002681039972230792, -0.00919119268655777, 0.022386601194739342, -0.05130152404308319, 0.011087578721344471, -0.04953068494796753, 0.03602471947669983, -0.01096203364431858, -0.0128716342151165, 0.006287145894020796, -0.000427843100624159, 0.01622830331325531, -0.03200728818774223, 0.0077903782948851585, 0.015607187524437904, 0.04012143984436989, -0.016875850036740303, 0.022756626829504967, -0.040359314531087875, -0.05029716715216637, 0.0005909685860387981, 0.048949211835861206, -0.046015433967113495, 0.013023609295487404, -0.011992821469902992, -0.01749696582555771, -0.014483892358839512, -7.162551582950982e-07, 0.006924780551344156, -0.07141510397195816, 0.02697228454053402, -0.01781413145363331, 0.03531109541654587, -0.0008903761627152562, 0.021157583221793175, -0.014946425333619118, 0.010810058563947678, -0.0284920372068882, 0.026959070935845375, 0.006197942886501551, -0.016836203634738922, -0.004380848724395037, 0.015025717206299305, -0.0019492465071380138, 0.00587747385725379, 0.0031799147836863995, 0.026139724999666214, 0.02000785805284977, -0.0056957644410431385, 0.025293951854109764, 0.020417531952261925, -0.0007838283781893551, -0.02481820248067379, -0.009521573781967163, 0.01124616153538227, 0.029919281601905823, -0.0031617439817637205, -0.03708193823695183, -0.03206015005707741, 0.03602471947669983, 0.0052960035391151905, 0.03401600196957588, -0.005084559787064791, -0.016413316130638123, 0.03531109541654587, 0.030817916616797447, -0.024580327793955803, -0.016598328948020935, 0.04572469741106033, -0.0279634278267622, 0.007704479154199362, 0.006012930069118738, -0.012481785379350185, 0.036606188863515854, 0.0005876647774130106, 0.02973426878452301, -0.02555825561285019, 0.03068576566874981, 0.05661404877901077, -0.026152940467000008, 0.011272591538727283, -0.0396721214056015, 0.014589614234864712, -0.011741732247173786, -0.015620402060449123, 0.010195550508797169, 0.029258519411087036, 0.0027619830798357725, 0.0407293401658535, 0.05693121254444122, -0.03808629512786865, -0.016201872378587723, 0.032826632261276245, 0.006244196556508541, -0.011939960531890392, -0.00492267357185483, 0.02051003836095333, -0.002334140008315444, -0.010327702388167381, 0.029866421595215797, -0.019743554294109344, 0.0032476428896188736, -0.017087293788790703, 0.020549682900309563, 0.03486177697777748, 0.044746771454811096, -0.01774805411696434, 0.016320809721946716, 0.013109508901834488, 0.018078435212373734, -0.027025146409869194, 0.00919119268655777, -0.04334595426917076, -0.026985500007867813, 0.022531967610120773, -0.0011299022007733583, -0.04429745301604271, -0.019783200696110725, 0.026205802336335182, -0.023139867931604385, -0.0054479786194860935, -0.004671583883464336, -0.013307737186551094, 0.03446532040834427, 0.002188772661611438, 0.03620973229408264, -0.045698266476392746, 0.02131616696715355, 0.02280948869884014, -0.007327845320105553, -0.0037630368024110794, 0.013624902814626694, 0.008173620328307152, 0.012323202565312386, 0.013109508901834488, -0.0386149026453495, -0.0072815921157598495, -0.001917860354296863, 0.03488820791244507, -0.013598471879959106, -0.01184084638953209, 0.03068576566874981, 0.008285949937999249, 0.0021441711578518152, -0.00012203439109725878, -0.028729911893606186, -0.002514197491109371, 0.022465892136096954, 0.014378170482814312, 0.041733697056770325, -0.01717980019748211, -0.022571614012122154, 0.011272591538727283, -0.043398816138505936, -0.009706586599349976, -0.02941710315644741, -0.03266805037856102, 0.016254734247922897, -0.013809915632009506, -0.030923638492822647, 0.02580934576690197, 0.03108222223818302, 0.026575827971100807, 0.0028280592523515224, 0.0037068722303956747, 0.005381902679800987, 0.025637546554207802, 0.02587542124092579, 0.04197157174348831, -0.01827666349709034, -0.008147189393639565, -0.03613043949007988, 0.041205089539289474, 0.005094471387565136, 0.0017262394540011883, -0.00466497614979744, -0.007473212666809559, 0.03737267106771469, 0.00927709136158228, -6.881211447762325e-05, -0.005629688035696745, 0.05264947935938835, -0.004271823447197676, -0.02665512077510357, 0.015276806429028511, 0.023536326363682747, -0.016809772700071335, -0.019214944913983345, -0.031452249735593796, 0.0037861636374145746, 0.008272734470665455, 0.014325309544801712, -0.04577755928039551, 0.04247375205159187, -0.008213265798985958, -0.025188229978084564, -0.0016675968654453754, 0.016043290495872498, -0.013340774923563004, -0.0043874564580619335, -0.023205945268273354, 0.037848420441150665, -0.013902422040700912, -0.027804844081401825, 0.02078755758702755, 0.008649368770420551, -0.031663693487644196, -0.004047164227813482, -0.020417531952261925, -0.008834381587803364, -0.03623616322875023, -0.014721767045557499, -0.0032063452526926994, 0.019677478820085526, 0.0054909284226596355, 0.0016832900000736117, -0.002157386392354965, -0.003156788181513548, 0.00011253594857407734, 0.009257269091904163, -0.012257126159965992, -0.014563184231519699, 0.018725981935858727, -0.003997607156634331, 0.0137702701613307, -0.007909315638244152, 0.004476659465581179, 0.0065778810530900955, 0.027276236563920975, 0.017193015664815903, -0.005514055024832487, -0.012884849682450294, 0.008933495730161667, 0.007010679692029953, 0.01096203364431858, 0.054393887519836426, 0.002362222410738468, -0.008543646894395351, -0.024448176845908165, 0.00010582508548395708, 0.03557540103793144, 0.005778359714895487, 0.008741875179111958, -0.016386885195970535, 0.003825809108093381, 0.04400671645998955, 0.025928283110260963, 0.0384034588932991, -0.006112044211477041, 0.04054432734847069, 0.013638118281960487, -0.009151547215878963, 0.0018121384782716632, -0.02344381809234619, -0.01958497241139412, 0.01848810724914074, 0.009495142847299576, 0.010777020826935768, -0.03380455821752548, 0.010915780439972878, 0.028307024389505386, 0.020906494930386543, 0.0006714988849125803, 0.005391813814640045, -0.0025637547951191664, -0.01778770051896572, 0.021976929157972336, -0.004070290829986334, -0.027302665635943413, -0.02471248060464859, 0.00038386115920729935, -0.010829881764948368, 0.0136645482853055, -0.008100936189293861, -0.020179657265543938, -0.012091935612261295, 0.030500752851366997, -0.02163333259522915, 0.010175727307796478, 0.027064792811870575, -0.024659620597958565, 0.0033583203330636024, -0.03348739445209503, -0.0012281904928386211, -0.0017559737898409367, 0.004496482200920582, 0.015514680184423923, -0.02435567043721676, 0.03364597633481026, 0.005675941705703735, 0.010327702388167381, 0.024633189663290977, 0.017629116773605347, 0.002195380162447691, 0.03747839480638504, -0.03829773887991905, -0.008477570489048958, 0.0035053398460149765, -0.018686335533857346, 8.507304301019758e-05, 0.003528466448187828, 0.0020913102198392153, 0.014285664074122906, -0.0077903782948851585, 0.0032542503904551268, -0.03980427235364914, 0.00436763372272253, -0.007420351728796959, 0.010169119574129581, 0.00032542506232857704, -0.0004451880813576281, -0.0018154422286897898, -0.028148440644145012, -0.014999286271631718, 0.021263305097818375, -0.02372133918106556, 0.02502964623272419, 0.029284950345754623, 0.009726409800350666, 0.003130357712507248, 0.005190281663089991, 0.0017014609184116125, -0.012376063503324986, -0.006683602929115295, -0.006610919255763292, -0.013512573204934597, -0.0031997377518564463, -0.02255839854478836, 0.02665512077510357, -0.018329525366425514, -0.005074648652225733, 0.002932129194959998, -0.022294092923402786, 0.003574719885364175, 0.010380563326179981, 0.017933066934347153, 0.004146278370171785, -0.01675691269338131, 0.06771484017372131, 0.006693514063954353, -0.011457604356110096, -0.009382813237607479, -0.017193015664815903, 0.01690227910876274, -0.008206658065319061, -0.00952818151563406, -0.03977784514427185, -0.009151547215878963, 0.007955568842589855, 0.031135082244873047, -0.01618865691125393, -0.010823274031281471, 0.007671441417187452, -0.014536753296852112, 0.015223945491015911, 0.008860811591148376, -0.008424709551036358, 0.015105008147656918, 0.008854204788804054, 0.04762769117951393, -0.004258607979863882, -0.033778127282857895, 1.211181006510742e-05, 0.0067562866024672985, -0.017153369262814522, 0.0022961462382227182, 0.035654690116643906, 0.054658193141222, -0.006601007655262947, -0.04059718921780586, -0.051248662173748016, 0.027725553140044212, -0.021540826186537743, 0.02485784888267517, -0.03110865317285061, 0.02909993752837181, -0.015620402060449123, -0.003713479731231928, 0.019664263352751732, 0.00013411394320428371, 0.0027504197787493467, 0.0022069434635341167, 0.007770555559545755, 0.0024828114546835423, 0.0006628264090977609, 0.015554326586425304, 0.02072148211300373, 0.007479820400476456, -0.011761555448174477, -0.011887099593877792, 0.011411351151764393, -0.016809772700071335, -0.01757625676691532, -0.00897974893450737, -0.033038076013326645, 0.042050864547491074, 0.019558541476726532, 0.02150117978453636, -0.030659334734082222, 0.011272591538727283, -0.00672655226662755, -0.0008482526172883809, -0.0015610491391271353, -0.04606829211115837, -0.013704193755984306, -0.012058897875249386, 0.011114008724689484, 0.048552755266427994, -0.012580899521708488, -0.0007735039689578116, -0.0018352650804445148, 0.006564665585756302, 0.02336452715098858, 0.02255839854478836, 0.006528323981910944, 0.002641394268721342, 0.025967927649617195, 0.041945140808820724, -0.018038788810372353, -0.010070005431771278, -0.037557683885097504, 0.0137702701613307, 0.03171655163168907, -0.01135188341140747, 0.03739910200238228, 0.005963372532278299, -0.017153369262814522, 0.010023752227425575, -0.026628689840435982, -0.01661154441535473, 0.05341596156358719, 0.02163333259522915, -0.012210872955620289, -0.02382706105709076, -0.004506393801420927, 0.006112044211477041, 0.010221980512142181, 0.004116544499993324, -0.009726409800350666, -0.007770555559545755, -0.000670259993057698, -0.0013545610709115863, -0.027936996892094612, 0.011821024119853973, -0.03216587007045746, -0.016109365969896317, 0.004380848724395037, 0.011906922794878483, 0.0001668422919465229, 0.001532140769995749, 0.029390672221779823, 0.02414422668516636, -0.009944461286067963, 0.021025432273745537, -0.015171084553003311, -0.008702229708433151, 0.002301102038472891, -0.048949211835861206, 0.01131223700940609, -0.0140345748513937, 0.02354953996837139, -0.0028247556183487177, -0.019214944913983345, -0.0007094927132129669, 0.015184300020337105, -0.022016573697328568, 0.008722051978111267, -0.014999286271631718, -0.002953604096546769, -0.0032889405265450478, 0.0007433567079715431, 0.0012570987455546856, 0.0024695962201803923, 0.040782202035188675, 0.006343310698866844, -0.008173620328307152, -0.01920172944664955, 0.00956121925264597, 0.01781413145363331, 0.016492607071995735, 0.0024382099509239197, 0.05788271129131317, -0.001479279831983149, -0.007004071958363056, 0.013003787025809288, -0.012257126159965992, 0.035126082599163055, -0.007420351728796959, 0.005104382988065481, 0.01717980019748211, 0.0025307165924459696, 0.02051003836095333, 0.0145103232935071, -0.009746232070028782, -0.007585542276501656, -0.020232517272233963, -0.0016073024598881602, 0.004470051731914282, 0.0011018197983503342, -0.0035846312530338764, -0.01138492114841938, -0.0006537409499287605, 0.014867134392261505, -0.028227731585502625, -0.0279634278267622, 0.008616330102086067, 0.007499643135815859, 0.009832131676375866, -0.015171084553003311, 0.0140874357894063, -0.007995214313268661, -0.003495428478345275, 0.007981998845934868, -0.024976786226034164, -0.01764233224093914, -0.011569933965802193, 0.005702372174710035, 0.015144654549658298, -0.02195049822330475, -0.004321380518376827, 0.024263164028525352, -0.012627152726054192, -0.018963856622576714, 0.0015230553690344095, -0.014642475172877312, 0.010043575428426266, -0.01696835644543171, 0.010162511840462685, -0.015778984874486923, -0.015448604710400105, 0.010651475749909878, 0.019954998046159744, 0.011391528882086277, 0.0260604340583086, 0.006016233470290899, 0.031452249735593796, 0.031795844435691833, 0.03573398292064667, -0.01679655723273754, -0.005431459750980139, 0.009567826986312866, -0.011061147786676884, 0.004925976973026991, 0.005342256743460894, -0.003011420601978898, -0.006148385815322399, -0.005266269203275442, -0.019783200696110725, -0.02213551104068756, -0.0274348184466362, 0.011926745064556599, 0.006690210197120905, 0.020628973841667175, -0.02051003836095333, -0.013638118281960487, 0.016056504100561142, -0.04543396085500717, -0.024633189663290977, 0.001757625606842339, -0.016677621752023697, 0.003295548027381301, 0.006125259213149548, -0.014933210797607899, 0.05280806124210358, 0.020761126652359962, -0.01983606070280075, 0.018778841942548752, 0.037848420441150665, 0.009343167766928673, -0.007301414851099253, 0.004724444821476936, 0.013089685700833797, 0.005153940059244633, -0.011556719429790974, 0.00595676526427269, 0.002890831558033824, -0.005827916786074638, 0.0018451765645295382, -0.019386742264032364, 0.022320523858070374, -0.0004171057080384344, 0.005818005185574293, -0.04355739802122116, 0.07257804274559021, 0.024012073874473572, 0.03940781578421593, -0.027778415009379387, 0.022188371047377586, -1.9455039819149533e-06, 0.019611401483416557, -0.013373813591897488, -0.05299307405948639, 0.026787271723151207, -0.04900207370519638, -0.02475212700664997, 0.00048524673911742866, -0.008127367123961449, -0.003822505474090576, -0.004238785244524479, -0.02538645826280117, 0.008860811591148376, 0.005550396628677845, -0.019598186016082764, 0.02072148211300373, -0.01080345083028078, 0.020523253828287125, -0.016030075028538704, -0.015012501738965511, -0.00882116612046957, 0.0065877921879291534, -0.018712766468524933, -0.030236447229981422, 0.01141795888543129, 0.024619974195957184, 0.04395385831594467, 0.01186066959053278, 0.033038076013326645, -0.021382242441177368, 0.0377691276371479, -0.025505395606160164, -0.027804844081401825, -0.00460550794377923, 0.022915208712220192, -0.009376206435263157, -0.03676477074623108, -0.0259547121822834, 0.03938138857483864, 0.00871544424444437, -0.02251875214278698, 0.013512573204934597, 0.014801057986915112, -0.03620973229408264, -0.011854061856865883, 0.030712194740772247, 0.004546039272099733, -0.018792057409882545, 0.01554111111909151, 0.03745196387171745, -0.005120901856571436, -0.029972143471240997, 0.014047790318727493, 0.016704050824046135, 0.012554468587040901, 0.05164512246847153, -0.004767394624650478, 0.019175298511981964, -0.008953318931162357, 0.027408387511968613, -0.0032410353887826204, 0.018752412870526314, -0.022822702303528786, 0.00044023236841894686, -0.0016362107126042247, 0.024990001693367958, -0.004162797704339027, 0.014444246888160706, -0.04054432734847069, 0.040068577975034714, 0.004390760324895382, -0.0001675649982644245, 0.010895957238972187, 0.01189370732754469, -0.023100223392248154, -0.013182192109525204, -0.045592546463012695, 0.03803343325853348, 0.0276462621986866, 0.0135059654712677, 0.03914351388812065, -0.0016543816309422255, 0.01785377599298954, 0.0258489903062582, -0.02160690166056156, -0.012680013664066792, -0.0035449855495244265, 0.023774199187755585, 0.04324023425579071, -0.019954998046159744, -0.03364597633481026, 0.007453389931470156, -0.0001658098481129855, -0.012746090069413185, -0.01168226357549429, 0.01075058989226818, -0.00434120325371623, 0.0394606776535511, 0.0029767306987196207, 0.027857705950737, 0.0411522276699543, 0.02152761071920395, 0.015316451899707317, -0.010340917855501175, 0.016175441443920135, 0.03126723691821098, 0.0045658620074391365, -0.012224088422954082, -0.02694585546851158, 0.0016709007322788239, -0.05455247312784195, 0.003521858947351575, 0.011213122867047787, 0.01941317319869995, 0.014008143916726112, 0.01969069428741932, -0.002481159521266818, -0.01679655723273754, -0.02074791118502617, -0.0259547121822834, 0.002474552020430565, 0.03108222223818302, 0.018514538183808327, 0.015210730023682117, -0.03771626949310303, -0.009303522296249866, -0.027804844081401825, -0.021369026973843575, -0.016743697226047516, -0.01855418272316456, 0.026747627183794975, -0.04543396085500717, 0.027064792811870575, -0.035548970103263855, 0.020338239148259163, 0.018078435212373734, -0.023589186370372772, 0.033460963517427444, -0.007889492437243462]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" sampling: parallel diverse decod-
ing for large language models. In International Confer-
ence on Machine Learning . PMLR, 2023.
Whiteley, N. and Lee, A. Twisted particle filters. 2014.
Yang, K. and Klein, D. Fudge: Controlled text generation
with future discriminators. In Proceedings of the 2021
Conference of the North American Chapter of the Associ-
ation for Computational Linguistics: Human Language
Technologies , pp. 3511–3535, 2021.
Zhang, H., Song, H., Li, S., Zhou, M., and Song, D. A
survey of controllable text generation using transformer-
based pre-trained language models. ACM Computing
Surveys , 56(3):1–37, 2023.
Ziegler, D. M., Stiennon, N., Wu, J., Brown, T. B., Radford,
A., Amodei, D., Christiano, P., and Irving, G. Fine-tuning
language models from human preferences. arXiv preprint
arXiv:1909.08593 , 2019.
Zou, A., Wang, Z., Kolter, J. Z., and Fredrikson, M. Uni-
versal and transferable adversarial attacks on aligned lan-
guage models. arXiv preprint arXiv:2307.15043 , 2023.
13
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Appendix
Table of Contents
A Proofs 15
A.1 Proof for Optimal Intermediate Target Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
A.2 Proof of Twist-Induced Proposal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
A.3 Derivation of CTL Gradient . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
B SMC with Intermediate Potentials and Connection with Soft Reinforcement Learning 18
B.1 Twisted SMC with Intermediate Potentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
B.2 Conditional Twisted SMC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
B.3 Connection with Soft Reinforcement Learning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
B.4 Remarks on Parameterization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
C Twist Learning Losses 24
C.1 Soft Q-Learning (RL) and Path Consistency Losses from Log Importance Weights . . . . . . . . . . . . 24
C.2 Controlled Decoding Losses via Optimal Twist Identities (Mudgal et al., 2023) . . . . . . . . . . . . . . 27
C.3 SIXO: Smoothing Inference with Twisted Objectives (Lawson et al., 2022) . . . . . . . . . . . . . . . . 28
C.4 FUDGE: Future Discriminators (Yang & Klein, 2021) . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
D Decoding Strategies using Learned Twists from Mudgal et al. (2023) 30
D.1 Proposal Sampling in Mudgal et al. (2023) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
D.2 Blockwise Greedy Decoding in Mudgal et al. (2023) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
E Proposal Learning Methods 32
","[0.010327661409974098, 0.008769857697188854, 0.015895366668701172, 0.000341220322297886, -0.029179971665143967, 0.02563164010643959, -0.01350096520036459, -0.01817437633872032, -0.045003216713666916, 0.032454244792461395, 0.05163830891251564, -0.03080989606678486, -0.019559090957045555, 0.03903163596987724, 0.02753562293946743, -0.028458766639232635, 0.046878352761268616, 0.007760170381516218, -0.00040793183143250644, 0.05847533419728279, -0.014092354103922844, -0.007918835617601871, -0.024621952325105667, 0.027838530018925667, 0.025400854647159576, -0.024463288486003876, 0.017972439527511597, 0.009685789234936237, 0.015592461451888084, -0.01261388324201107, 0.03308890387415886, -0.02959827147424221, -0.04814767464995384, -0.047282226383686066, -0.04488782584667206, 0.07644777745008469, -0.0016948326956480742, 0.015260706655681133, -0.017280081287026405, -0.0013639797689393163, -0.0026468238793313503, -0.06525466591119766, -0.0027279595378786325, 0.041166406124830246, 0.00132882094476372, 0.08100579679012299, 0.026900961995124817, 0.01570785418152809, -0.043070387095212936, 0.04260881617665291, -0.02850203774869442, 0.03577178716659546, -0.020799564197659492, -0.019934117794036865, -0.03978168964385986, 0.00788277480751276, -0.024189230054616928, -0.017280081287026405, -0.02035241760313511, -0.05178254842758179, 0.0072553264908492565, -0.006552151404321194, -0.004842894617468119, 0.028227979317307472, -0.0078034428879618645, -0.029526149854063988, -0.05253260210156441, 0.014842407777905464, -0.017409898340702057, 0.05313841626048088, 0.007774594239890575, -0.009079976007342339, 0.030550261959433556, 0.017006024718284607, -0.01075317244976759, 0.016876207664608955, -0.01298891007900238, 0.06796640157699585, -0.019530242308974266, -0.03265618160367012, -0.0009835439268499613, -0.021895796060562134, 0.021895796060562134, -0.03069450333714485, -0.02228524722158909, -0.008769857697188854, -0.009635304100811481, 0.015967488288879395, -0.030088691040873528, -0.019861998036503792, -0.00874100998044014, -0.0023312964476644993, -0.042003002017736435, -0.0027550046797841787, 0.04206069931387901, 0.003359014168381691, 0.010782021097838879, -0.0037502681370824575, 0.03926242142915726, 0.009245853871107101, -0.009303550235927105, 0.0010376343270763755, 0.024520983919501305, -0.008640040643513203, 0.06860105693340302, -0.014597197994589806, -0.010818080976605415, 0.0034203166142106056, -0.04751301184296608, 0.01841958612203598, -0.06404304504394531, -0.005427070893347263, -0.035137128084897995, 0.009361246600747108, 0.03130031377077103, -0.060581255704164505, -0.014496228657662868, 0.006007641088217497, -0.022804515436291695, -0.016530027613043785, -0.023496871814131737, -0.013537026010453701, 0.02260257862508297, 0.003169697942212224, 0.016097305342555046, -0.02241506427526474, 0.021463073790073395, -0.07460148632526398, 0.0006170814158394933, 0.011935949325561523, 0.018910005688667297, 0.02812701091170311, 0.0036312693264335394, 0.00456523010507226, -0.02128998376429081, -0.01651560328900814, -0.011041655205190182, 0.022992029786109924, -0.015347251668572426, 0.023669961839914322, 0.021362105384469032, -0.03842582553625107, -0.024621952325105667, 0.006151882465928793, -0.01025554072111845, -0.03412744030356407, -0.010688263922929764, 0.009930999018251896, -0.018318617716431618, 0.046099450439214706, -0.023987293243408203, -0.010385357774794102, -0.04673411324620247, 0.025761457160115242, -0.026367269456386566, -0.045060914009809494, -0.0399547815322876, 0.05622517317533493, 0.028516462072730064, -0.060927435755729675, -0.00359340594150126, 0.04338771849870682, -0.0020410113502293825, 0.00599321722984314, 0.015938639640808105, 0.0015740308444947004, 0.0013297224650159478, 0.035541001707315445, -0.04543594270944595, -0.05088825523853302, 0.036694932729005814, -0.02294875681400299, -0.03640644997358322, -0.024362320080399513, 0.01520301029086113, -0.020554354414343834, -0.02450655959546566, -0.08787167072296143, -0.010096875950694084, -0.052619148045778275, -0.02019375190138817, 0.04099331796169281, -0.03343508392572403, -0.02273239567875862, -0.014633257873356342, -0.009433367289602757, 0.00950548704713583, 0.02219870314002037, 0.005589342210441828, 0.04030095785856247, -0.019962966442108154, 0.039723996073007584, 0.06375455856323242, 0.01801571063697338, -0.020554354414343834, 0.008979007601737976, 0.09191042184829712, 0.000233715632930398, 0.02710290066897869, -0.014178898185491562, 0.0026215817779302597, 0.042724210768938065, -0.06260062754154205, -0.04151258245110512, 0.008380407467484474, -0.014712590724229813, -0.003349999198690057, 0.010471902787685394, -0.04286845028400421, 0.007666413672268391, 0.04667641595005989, -0.0002914120559580624, 0.032136913388967514, 0.007215660065412521, -0.037387289106845856, -0.00023687091015744954, -0.04402237758040428, -0.011510438285768032, -0.005668674595654011, 0.06825488060712814, -0.0029335031285881996, 0.00044556971988640726, 0.03392550349235535, 0.025025827810168266, -0.03072335012257099, 0.028920337557792664, 0.0044318074360489845, -0.02812701091170311, 0.0383392795920372, -0.004074810538440943, 0.07258211076259613, -0.016558876261115074, -0.011921525932848454, -0.03836812824010849, -0.006130245979875326, -0.018102256581187248, -0.005589342210441828, -0.00029569421894848347, -0.005755219142884016, -0.04785919189453125, 0.025155644863843918, 0.004237081855535507, 0.03184843063354492, 0.003811570582911372, 0.018650371581315994, 0.04739762097597122, -0.040127869695425034, -0.02341032773256302, 0.03981053829193115, 0.030665654689073563, 0.021275559440255165, -0.009339610114693642, -0.020929381251335144, 0.0072120544500648975, -0.0067685130052268505, -0.030204083770513535, 0.021088046953082085, -0.010493539273738861, -0.03375241532921791, 0.01704929582774639, -0.031040681526064873, -0.011416682042181492, -0.045724425464868546, 0.031329162418842316, -0.00871216133236885, 0.014178898185491562, -0.01435920037329197, 0.004680623300373554, 0.012952849268913269, -0.05977350473403931, -0.021246712654829025, -0.015679005533456802, -0.009981483221054077, 0.031358011066913605, -0.03505058214068413, -0.04174337163567543, 0.02662690356373787, 0.05253260210156441, -0.017063720151782036, 0.058331094682216644, 0.00016824369959067553, -0.021780403330922127, 0.046128299087285995, -0.011467166244983673, -0.017496444284915924, 0.03611796721816063, 3.428542913752608e-05, -0.01764068379998207, -0.020987078547477722, -0.04601290449500084, 0.009527123533189297, -0.032108064740896225, 0.021333256736397743, -0.0229199081659317, 0.022891059517860413, 0.047628406435251236, 0.024953708052635193, 0.005199891049414873, 0.014013021253049374, -0.00011212490790057927, 0.05585014820098877, -0.018217649310827255, -0.01616942510008812, 0.024246925488114357, 0.008329922333359718, 0.01901097409427166, 0.0015866518951952457, 0.02654035948216915, 0.029915601015090942, -0.0036547083873301744, -0.015318403020501137, -0.01723681017756462, -0.04783034324645996, 0.01073874905705452, -0.03412744030356407, -0.01300333347171545, 0.0463879331946373, -0.029136698693037033, -0.016587724909186363, -0.04552248492836952, -0.04708028957247734, 0.011358985677361488, -0.0013874189462512732, 0.005272011738270521, -0.009375670924782753, 0.003624057164415717, -0.019285032525658607, -0.006815391127020121, -0.018116680905222893, -0.013609146699309349, 0.029857903718948364, -0.012173947878181934, 0.03810849413275719, 0.00024994276463985443, -0.045724425464868546, -0.07206284254789352, -0.025054676458239555, 0.051465220749378204, -0.008769857697188854, 0.021564042195677757, -0.07056273519992828, 0.006389880087226629, 0.004864530637860298, -0.04517630860209465, -0.03542561084032059, 0.015347251668572426, 0.023900747299194336, 0.03908933326601982, 0.058734968304634094, 0.033290840685367584, -0.003193137003108859, -0.03917587921023369, 0.016717541962862015, 0.0019905269145965576, 0.005005165468901396, 0.02493928372859955, -0.026424966752529144, -0.026641327887773514, -0.017784925177693367, -0.0111281992867589, -0.005088104400783777, 0.013839932158589363, 0.023655537515878677, 0.02104477398097515, 0.008228953927755356, 0.00891409907490015, -0.03308890387415886, 0.01635693944990635, -0.005491979420185089, 0.005275617819279432, -0.016025183722376823, 0.03294466435909271, -0.030550261959433556, 0.013688478618860245, -0.03034832328557968, -0.00664230203256011, -0.003074138192459941, 0.008769857697188854, 0.03291581571102142, 0.018534978851675987, -0.0011187698692083359, -0.008841978386044502, 0.0035988150630146265, -0.01989084482192993, -0.005178255029022694, 0.01348654180765152, 0.001800309051759541, -0.014027445577085018, -0.009217005223035812, 0.02016490325331688, -0.0019526636460795999, -0.0016082881484180689, -0.048407308757305145, 0.05250375345349312, 0.01779934950172901, -0.009079976007342339, -0.01395532488822937, 0.03331968933343887, 0.03761807456612587, 0.027059627696871758, -0.02128998376429081, 0.0011169669451192021, -0.04751301184296608, 0.006256456952542067, -0.03300236165523529, 0.04211839661002159, 0.03986823558807373, 0.0327138788998127, 0.028574159368872643, 0.041627977043390274, 0.05406155809760094, -0.04474358260631561, 0.03147340565919876, -0.03444477170705795, 0.0011764663504436612, -0.03153109923005104, 0.0037322379648685455, 0.004850106313824654, 0.05016705021262169, 0.05126328021287918, -0.0008307385141961277, -0.031242618337273598, -0.006350213661789894, -0.007248114328831434, -0.04442625492811203, -0.011871040798723698, 0.03877200186252594, -0.026713449507951736, 0.04909966513514519, -0.04788804054260254, -0.009714636951684952, 0.03897394239902496, 0.03810849413275719, -0.032771576195955276, -0.03681032359600067, -0.03805079683661461, 0.048840031027793884, 0.009534335695207119, 0.010515174828469753, -0.07812096923589706, -0.020871685817837715, 0.027593320235610008, -0.038166191428899765, -0.01103444304317236, -0.021376527845859528, 0.030982984229922295, -0.03542561084032059, -0.017871471121907234, 0.008856402710080147, -0.04416662082076073, 0.02837222069501877, -0.017784925177693367, 0.03637760132551193, -0.011979222297668457, 0.0021798433735966682, -0.0113301370292902, 0.0927758663892746, -0.006321365479379892, 0.058302246034145355, -0.04061828926205635, 0.02385747618973255, 0.008704949170351028, -0.04399352893233299, -0.019097520038485527, 0.0033409842289984226, 0.024174805730581284, 0.05198448523879051, 0.004247900098562241, 0.011928738094866276, 0.0337812602519989, -0.008777069859206676, -0.007637565489858389, -0.001296366797760129, -0.013789447955787182, 0.013731751590967178, -0.010529599152505398, 0.05691753327846527, -0.045349396765232086, 0.015462644398212433, 0.0022285247687250376, 0.010096875950694084, -0.011214744299650192, 0.033261995762586594, 0.01873691752552986, -0.002482749754562974, 0.043906986713409424, -0.013565873727202415, 0.005243163555860519, -0.013544238172471523, 0.0053621623665094376, -0.03992593288421631, -0.04327232390642166, 0.03112722560763359, -0.017207961529493332, 0.03756037726998329, -0.03582948446273804, -0.010515174828469753, 0.0029569421894848347, -0.012325400486588478, -0.031790733337402344, 0.022689122706651688, 0.004539988003671169, -0.0038332068361341953, 0.022487185895442963, 0.023814203217625618, 0.030117537826299667, 0.022241976112127304, -0.018563827499747276, 0.004723895341157913, 0.06727404147386551, 0.0007000199984759092, -0.009909362532198429, -0.0321657620370388, 0.021535193547606468, -0.0035663607995957136, 0.028646279126405716, -0.052561450749635696, -0.006786542944610119, 0.006530514918267727, 0.023150693625211716, -0.0036853596102446318, -0.014525077305734158, -0.02866070345044136, -0.02509794943034649, 0.027636591345071793, -0.015361675061285496, -0.028934761881828308, -0.10991171002388, -0.034387074410915375, -0.010262752883136272, 0.01951581798493862, -0.022241976112127304, 0.016371363773941994, 0.0031678949017077684, -0.05971580743789673, 0.0010331267258152366, -0.016933903098106384, -0.011445529758930206, -0.04442625492811203, 0.0054667373187839985, 0.0012999727623537183, 0.011618619784712791, 0.0017705593490973115, 0.002637808909639716, -0.007082237396389246, 0.0023240845184773207, -0.00402072025462985, -0.020208176225423813, -0.017179112881422043, 0.004013508092612028, 0.05613863095641136, -0.015722278505563736, -0.010767596773803234, -0.02796834707260132, 0.0005161126027815044, -0.005856188014149666, 0.007280568592250347, 0.011402257718145847, -0.0026738690212368965, 0.003472604090347886, 0.04402237758040428, -0.05325380712747574, -0.0014424108667299151, 0.006299729458987713, -0.005304466001689434, 0.0059896111488342285, 0.02635284699499607, -0.014885679818689823, 0.02069859579205513, 0.03845467418432236, -0.043503109365701675, -0.010024755261838436, -0.004691441077739, -0.012649943120777607, -0.016775237396359444, -0.014842407777905464, 0.04970547929406166, -0.01779934950172901, -0.021116895601153374, 0.009144884534180164, -0.03381010890007019, -0.0049186209216713905, 0.008863614872097969, -0.015419372357428074, -0.01619827374815941, 0.01208019070327282, 0.015275130979716778, -0.0009601046913303435, 0.00018345663556829095, 0.01694832742214203, 0.045782119035720825, 0.0010042785434052348, -0.024708498269319534, -0.016775237396359444, -0.035137128084897995, -0.003862055018544197, 0.034790948033332825, -0.03427168354392052, -0.038137342780828476, 0.0014811756554991007, 0.0032742726616561413, 0.002217706758528948, -0.018217649310827255, -0.030982984229922295, -0.0012648140545934439, 0.039666298776865005, -0.0466475673019886, 0.009303550235927105, 0.022314095869660378, -0.003002017503604293, 0.016342515125870705, 0.011885465122759342, 0.0020500263199210167, -0.01136619783937931, 0.0005273814895190299, -0.010969534516334534, 0.017784925177693367, -0.004781592171639204, 0.050715167075395584, -0.01537609938532114, 0.012967273592948914, -0.04070483520627022, 0.03758922591805458, -0.013847144320607185, 0.011697951704263687, 0.00048591213999316096, 0.00949106365442276, -0.025011403486132622, 0.011041655205190182, 0.007796230725944042, -0.042695362120866776, -0.022458337247371674, 0.0033409842289984226, 0.02731926180422306, -0.0038836912717670202, -0.01433035172522068, 0.0025314311496913433, 0.005409040488302708, 0.005333314184099436, -0.03256963565945625, 0.00487174279987812, 0.006984874606132507, -0.01895327866077423, -0.006238427013158798, 0.036262210458517075, -0.013616357930004597, -0.014914528466761112, 0.02504025213420391, -0.014553925022482872, -0.003984659910202026, -0.018938854336738586, -0.024333471432328224, 0.03574294224381447, -0.007918835617601871, 0.04032980650663376, -0.024492135271430016, 0.025299886241555214, -0.0024575074203312397, 0.014106778427958488, -0.0310983769595623, -0.033665869385004044, 0.0011070503387600183, -0.019876422360539436, 0.020987078547477722, -0.0032201821450144053, 0.014842407777905464, 0.014164474792778492, 0.04785919189453125, -0.001465850044041872, -0.020929381251335144, -0.035916030406951904, 0.03559869900345802, 0.032425396144390106, 0.0009294534684158862, -0.011041655205190182, -0.01025554072111845, 0.03528136759996414, -0.06479309499263763, 0.01108492724597454, 0.03314660117030144, -0.03822388872504234, 0.018405161798000336, -0.052647996693849564, -0.0399547815322876, 0.027232715860009193, -0.0008492193883284926, 0.03810849413275719, 0.005080892238765955, 0.005203497130423784, 0.007421203888952732, 8.130464266287163e-05, -0.017006024718284607, 0.018910005688667297, -0.019429273903369904, -0.013508177362382412, -0.02128998376429081, -0.015996336936950684, 0.030896440148353577, -0.012678791768848896, -0.08481375873088837, 0.002354735741391778, 0.027679864317178726, -0.029295364394783974, -0.01128686498850584, -0.022905483841896057, -0.009166521020233631, 0.00026729676756076515, 0.03300236165523529, 0.03502173349261284, -0.01745317131280899, -0.0019454516004770994, 0.010904625989496708, -0.010666628368198872, 0.023208390921354294, -0.03649299591779709, -0.007709686178714037, 0.0199773907661438, 0.016472332179546356, 0.004741925746202469, -0.04298384487628937, -0.026554783806204796, -0.017655108124017715, -0.011438317596912384, 0.009693000465631485, 3.75533927581273e-05, -0.01686178334057331, -0.03355047479271889, 0.015318403020501137, -0.021376527845859528, -0.006656725890934467, -0.014113989658653736, 0.023439176380634308, 0.038166191428899765, -0.018534978851675987, -0.03155994787812233, 0.03161764517426491, 0.0028090951964259148, 0.01158255897462368, -0.028703976422548294, 0.006736058741807938, 0.015260706655681133, -0.0050231958739459515, -0.018924430012702942, 0.05810030922293663, 0.0428972989320755, 0.02316511794924736, 0.01925618387758732, 0.01817437633872032, 0.0009952634572982788, -0.010796445421874523, -0.04177221655845642, 0.014640470035374165, -0.004770773928612471, -0.02188137173652649, -0.011972010135650635, -0.02206888608634472, 0.00043272326001897454, 0.0020860866643488407, -0.025617215782403946, 0.009678577072918415, 0.034012049436569214, 0.012729275971651077, -0.013803871348500252, 0.0123326126486063, -0.019818725064396858, -0.00025647867005318403, -0.013385572470724583, -0.009469427168369293, -0.005171042867004871, 0.02509794943034649, -0.010767596773803234, -0.0006923571927472949, 0.018506132066249847, 0.027175020426511765, 0.03274272754788399, -0.011279652826488018, 0.001777771394699812, 0.020684171468019485, -0.03228115290403366, -0.01629924215376377, 0.0028199132066220045, -0.004471473395824432, 0.008942946791648865, -0.02635284699499607, -0.03040602058172226, -0.03499288856983185, -0.03652184084057808, -0.011690739542245865, 0.007832290604710579, -0.05610978230834007, -0.02263142541050911, 0.026208605617284775, 0.02700193040072918, 0.006876693572849035, -0.025674913078546524, 0.017222385853528976, -0.0015650157583877444, -0.11977779865264893, -0.033608172088861465, 0.028487613424658775, 0.021030349656939507, 0.02837222069501877, -0.03957975283265114, 0.010551235638558865, 0.010385357774794102, -0.010197844356298447, -0.04508976265788078, 0.00020813537412323058, -0.019616788253188133, 0.008171257562935352, 0.016804086044430733, 0.049618933349847794, -0.036233361810445786, 0.005098922178149223, -0.03531021624803543, 0.009894938208162785, 0.004976317286491394, 0.010991171002388, 0.0037827224005013704, 0.008676101453602314, 0.03851236775517464, -0.027607742697000504, -0.01595306396484375, 0.016746390610933304, 0.007579869125038385, -0.011604195460677147, 0.005052044056355953, -0.03196382522583008, -0.025025827810168266, 0.00639348616823554, 0.03831043094396591, -0.004402959253638983, 0.004150537308305502, -0.01515973825007677, -0.009772333316504955, -0.015751127153635025, -0.0372718945145607, 0.004063992761075497, -0.027045203372836113, 0.056427113711833954, -0.010269965045154095, 0.015880944207310677, -0.011272440664470196, 0.011171472258865833, -0.018217649310827255, -0.0018679220229387283, -0.03986823558807373, 0.002205085474997759, 0.029526149854063988, 0.01100559439510107, -0.0011151639046147466, 0.006047307513654232, 0.016183849424123764, 0.014344776049256325, -0.00018593577260617167, 0.033665869385004044, 0.04061828926205635, 0.008878039196133614, 0.0055821300484240055, 0.06236984580755234, -0.0027099293656647205, -0.04725337773561478, -0.008322710171341896, 0.0031949400436133146, 0.019962966442108154, -0.0011746633099392056, -0.033608172088861465, -0.016039608046412468, 0.013140362687408924, 0.012671579606831074, 0.02488158643245697, 0.003050698898732662, -0.021679434925317764, 0.0268144179135561, 0.0337812602519989, -0.04604175314307213, 0.009541547857224941, 0.04131064563989639, -0.01901097409427166, -0.017092568799853325, -0.00041334086563438177, -0.004709471482783556, 0.04358965530991554, -0.0099886953830719, -0.007385143544524908, -0.03343508392572403, 0.0646200031042099, 0.058619577437639236, -0.002102313796058297, 0.010774808935821056, -0.05593669414520264, 0.010810869745910168, -0.027333686128258705, -0.004640956874936819, 0.015058768913149834, 0.004381322767585516, 0.004976317286491394, 0.042031850665807724, 0.05365768447518349, -0.05775412917137146, -0.030146386474370956, 0.008430891670286655, 0.046474479138851166, -0.0037502681370824575, -0.009671364910900593, -0.0035627547185868025, 0.0005674985004588962, -0.00656296918168664, -0.0031949400436133146, -0.05596553906798363, -0.009693000465631485, 0.0068117850460112095, 0.012476854026317596, 0.05250375345349312, 0.048840031027793884, 0.030290627852082253, 0.005351344123482704, 0.012390309013426304, 0.004702259320765734, -0.040877923369407654, -0.009123248979449272, -0.043503109365701675, -0.04485897719860077, 0.011431106366217136, 0.0024809467140585184, -0.0010223087156191468, -0.021564042195677757, 0.03181958198547363, -0.027203869074583054, 0.026396118104457855, -0.00022131991863716394, -0.026958659291267395, 0.02072744444012642, -0.0016109925927594304, 0.012462429702281952, -0.03141570836305618, 0.03427168354392052, 0.012267704121768475, -0.005647038575261831, 0.02179482765495777, 0.012397521175444126, 0.03141570836305618, -0.011798921041190624, -0.004301990382373333, -0.03522367402911186, 0.0029569421894848347, -0.012765335850417614, 0.04110870882868767, 0.02263142541050911, -0.03594487905502319, 0.0034563769586384296, 0.017438746988773346, -0.003898115362972021, -0.002098707715049386, -0.02385747618973255, -0.014640470035374165, 0.022516032680869102, 0.026699025183916092, 0.03499288856983185, 0.009418942965567112, -0.014431320130825043, 0.00394138740375638, -0.031329162418842316, -0.00574440136551857, -0.009440578520298004, -0.035137128084897995, 0.0321657620370388, -0.012310976162552834, -0.030204083770513535, 0.016385788097977638, 0.021405376493930817, -0.01138062123209238, 0.035454459488391876, -0.010486327111721039, 0.02228524722158909, 0.02088610827922821, 0.029396332800388336, 0.04050289839506149, 0.007060600910335779, -0.037733469158411026, 0.007897199131548405, 0.0310983769595623, -0.0310983769595623, 0.008704949170351028, 0.017193537205457687, -0.02260257862508297, 0.018318617716431618, 0.013061029836535454, 0.04586866497993469, -0.021246712654829025, 0.0734475627541542, 0.028949186205863953, -0.01938600093126297, -0.002313266508281231, 0.018780188634991646, -0.011229168623685837, -0.049590084701776505, -0.014553925022482872, 0.014186110347509384, -0.005221527069807053, -0.01941484957933426, -0.023655537515878677, 0.03176188841462135, -0.023814203217625618, 0.0009673167951405048, 0.004727501422166824, 0.0391470305621624, -0.0006076155696064234, 0.012815820053219795, -0.020092783495783806, 0.03412744030356407, 0.016501180827617645, -0.01888115704059601, 0.034040894359350204, -0.005376586224883795, -0.04751301184296608, -0.0013504571979865432, -0.04206069931387901, -0.022213127464056015, -0.013710115104913712, -0.0037322379648685455, -0.022588154301047325, 0.014813559129834175, 0.02844434231519699, 0.004550806246697903, -0.0007153456099331379, -0.007861139252781868, -0.0027153384871780872, -0.005437888670712709, -0.004958287347108126, 0.014871255494654179, -0.0034383467864245176, -0.023208390921354294, 0.0040964470244944096, -0.017582988366484642, -0.015231858938932419, 0.002982184523716569, 0.009808394126594067, 0.011712376028299332, 0.010789233259856701, -0.022833364084362984, 0.002982184523716569, -0.009858878329396248, 0.019861998036503792, 0.025343159213662148, -0.019775452092289925, -0.020410113036632538, -0.022559305652976036, 0.020597627386450768, 0.03355047479271889, -0.0002254893770441413, -0.001814733142964542, 0.0063970922492444515, -0.002630596747621894, 0.07188975811004639, 0.02906457893550396, 0.03874315693974495, -0.006202366668730974, -0.0031336375977844, -0.007644777651876211, -0.012397521175444126, -0.007280568592250347, -0.01748201996088028, -0.00913046021014452, 0.005578523967415094, -0.027275988832116127, -0.011524862609803677, -0.032973513007164, 0.014395260252058506, 0.0046878354623913765, 0.03983938694000244, 0.011452741920948029, -0.02581915445625782, 0.01128686498850584, -0.0288193691521883, -0.0033085299655795097, 0.028199132531881332, -0.03882969915866852, -0.019674483686685562, -0.008928523398935795, -0.01745317131280899, 0.033665869385004044, -0.006162700243294239, -0.004709471482783556, -0.003586194012314081, 0.012960061430931091, -0.016126153990626335, 0.02710290066897869, 0.030088691040873528, -0.023669961839914322, 0.005506403278559446, -0.033954352140426636, -0.0017561352578923106, 0.009166521020233631, 0.01045747846364975, 0.007918835617601871, -0.0028379433788359165, 0.011979222297668457, 0.030896440148353577, -0.002080677542835474, 0.010717112571001053, 0.012924001552164555, -0.0013955325121060014, 0.0027513985987752676, -0.023814203217625618, -0.0049546812660992146, -0.008704949170351028, -0.010774808935821056, 0.009721849113702774, 0.0019039823673665524, 0.02082841284573078, 0.034704405814409256, -0.01570785418152809, -0.0111281992867589, -0.01704929582774639, 0.021924644708633423, -0.01061614416539669, 0.0017029462615028024, -0.00950548704713583, 0.025617215782403946, 0.019458122551441193, -0.005629008170217276, -0.029482876881957054, 0.014741438440978527, -0.016385788097977638, 0.015390523709356785, 0.03542561084032059, 0.006451182533055544, 0.013948112726211548, 0.005030408035963774, -0.02013605460524559, -0.01704929582774639, -0.005077286157757044, -0.01922733709216118, 0.02123228833079338, -0.0003583489451557398, -0.0288193691521883, 0.037820011377334595, 0.0023944019339978695, 0.00856792088598013, 0.01847728341817856, 0.009433367289602757, -0.015505916438996792, -0.0030038205441087484, 0.011907101608812809, 1.908658850879874e-05, -0.04676295816898346, 0.08504454046487808, 0.0008140606223605573, -0.02550182305276394, -0.01091183815151453, 0.013104302808642387, 0.0027009143959730864, -0.0394066646695137, -0.007529384456574917, -0.0367237813770771, 0.006584605667740107, 0.0004059034399688244, 0.03412744030356407, -0.00895737111568451, -0.013652418740093708, 0.03657953813672066, 0.007731322199106216, -0.00970742478966713, -0.010349297896027565, -0.0008036933140829206, 0.02300645224750042, 0.021347681060433388, 0.033983200788497925, -0.03467555716633797, -0.01278697233647108, -0.017280081287026405, 0.004150537308305502, -0.019313881173729897, -0.0005476653459481895, 0.02375650592148304, 0.041166406124830246, -0.0037358440458774567, -0.011193107813596725, -0.04243572801351547, 0.008394830860197544, 0.0032201821450144053, 0.008841978386044502, -0.05123443156480789, 0.006635089870542288, -0.031271468847990036, 0.007969319820404053, 0.014553925022482872, 0.0014370018616318703, -0.005329708103090525, 0.014005809091031551, -0.019559090957045555, 0.02141980081796646, -0.0013080863282084465, -0.016183849424123764, 0.016616573557257652, -0.004237081855535507, 0.013089878484606743, -0.01751086674630642, 0.003258045529946685, -0.00265764188952744, 0.008106349036097527, -0.032886967062950134, -0.02482389099895954, 0.04301268979907036, 0.02273239567875862, -0.003483422100543976, -0.029771359637379646, 0.01764068379998207, -0.02035241760313511, 0.026122059673070908, 0.002630596747621894, -0.04759955778717995, -0.017727229744195938, 0.02504025213420391, -0.0062672751955688, 0.03303120657801628, -0.01312593836337328, 0.005311678163707256, -0.012195583432912827, 0.008027016185224056, 0.013147574849426746, -0.0037033897824585438, 0.0036727385595440865, 0.025905698537826538, 0.004182991571724415, 0.03634875267744064, -0.008048652671277523, -0.009137672372162342, 0.008791494183242321, 0.007125509437173605, 0.020150478929281235, 0.011344561353325844, 0.01203691866248846, -0.024867162108421326, -0.01403465773910284, 0.018708068877458572, -0.006058125756680965, 0.02531431056559086, 0.04260881617665291, 0.025372005999088287, -0.005131376441568136, -0.014517865143716335, 0.008344346657395363, -0.02731926180422306, 0.03594487905502319, 0.01779934950172901, -0.0031210165470838547, -0.02713174745440483, 0.0061050038784742355, 0.005455919075757265, -0.0178281981498003, 0.01798686385154724, -0.04682065546512604, -0.02747792750597, 0.012967273592948914, 0.037041109055280685, -0.008979007601737976, -0.02697308361530304, 0.00656296918168664, 0.023742081597447395, 6.457042036345229e-05, 0.023092998191714287, -0.03464670851826668, 0.018996551632881165, 0.014243806712329388, -0.05971580743789673, 0.02144864946603775, -0.005957156885415316, 0.02007835917174816, 0.01337836030870676, 0.015650156885385513, -0.018693644553422928, -0.008171257562935352, -0.0011377015616744757, -0.019443698227405548, 0.0041216891258955, -0.03381010890007019, 0.0037682983092963696, 0.011358985677361488, -0.006379061844199896, 0.01691947877407074, 0.01290957722812891, 0.005272011738270521, -0.008748222142457962, -0.040127869695425034, 3.527145236148499e-05, 0.01938600093126297, 0.0182320736348629, 0.009779545478522778, 0.032425396144390106, -0.0062203966081142426, -0.012722063809633255, -0.006959632504731417, -0.024059413000941277, 0.020121632143855095, 0.01828976906836033, -0.0005684000207111239, -0.010782021097838879, -0.016025183722376823, 0.01769838109612465, 0.005592947825789452, 0.016241546720266342, -0.010060816071927547, -0.03617566451430321, 0.020871685817837715, -0.00618794234469533, 0.016818510368466377, -0.019313881173729897, -0.002003147965297103, 0.011243592947721481, 0.02766543999314308, -0.00589224835857749, -0.006213184911757708, 0.005834551993757486, 0.013601934537291527, -0.0021744342520833015, -3.696177736856043e-05, 0.02120343968272209, 0.007875563576817513, -0.0029262909665703773, -0.019934117794036865, -0.03112722560763359, -0.004770773928612471, -0.00741399172693491, -0.0014270852552726865, 0.0026882931124418974, -0.0017750668339431286, -0.03998363018035889, 0.05504239723086357, -0.0010376343270763755, -0.0233237836509943, 0.009137672372162342, -0.004485897719860077, 0.005452312994748354, -0.01592421531677246, 0.0037863284815102816, 0.010890201665461063, 0.008228953927755356, -0.006656725890934467, 0.005748007446527481, 0.00786835141479969, 0.0054739490151405334, -0.012844668701291084, 0.0011331940768286586, 0.009519911371171474, 0.01445295661687851, -0.032425396144390106, -0.016039608046412468, 0.017626261338591576, 0.009635304100811481, 0.0023114634677767754, 0.002156404312700033, 0.01383271999657154, -0.0023835839238017797, 0.0006495356210507452, -0.005423464812338352, -0.012383096851408482, -0.02094380557537079, 0.02113131806254387, 0.005008771549910307, 0.0327138788998127, -0.0008920409600250423, 0.011618619784712791, -0.018837885931134224, -0.02941075712442398, -0.014943376183509827, -0.023020876571536064, 0.014719802886247635, 0.005614584311842918, 0.020395688712596893, -0.028761671856045723, 0.026583632454276085, -0.007399567868560553, -0.011539286933839321, -0.0034942403435707092, 0.0383392795920372, 0.05103249475359917, -0.019097520038485527, -0.003463589120656252, -0.008863614872097969, -0.0011142623843625188, -0.006498060654848814, 0.007006510626524687, -0.0026468238793313503, 0.008091924712061882, 0.004637350793927908, -0.026179756969213486, 0.013609146699309349, 0.004669805057346821, 0.03331968933343887, -0.03193497657775879, 0.08031343668699265, 0.014582773670554161, 0.028242403641343117, -0.0319061279296875, 0.011373409070074558, 0.010190632194280624, 0.016212698072195053, -0.005863400176167488, -0.03303120657801628, 0.009801181964576244, -0.03034832328557968, -0.020020661875605583, -0.03037717193365097, 0.0056542507372796535, 0.04474358260631561, -0.038137342780828476, -0.01857825182378292, 0.0095848198980093, 0.01328460406512022, -0.021145742386579514, 0.03334853798151016, -0.006458394695073366, -0.007579869125038385, -0.013991384766995907, -0.028559735044836998, 0.016025183722376823, 0.0037538742180913687, -0.009620880708098412, -0.024867162108421326, 0.0001550591696286574, 0.038483522832393646, 0.025718186050653458, -0.012419157661497593, 0.024088261649012566, -0.013198059052228928, 0.04295499622821808, -0.019429273903369904, -0.0007477998733520508, -0.003898115362972021, -0.007197630126029253, -0.020063934847712517, -0.028429917991161346, -0.009202580899000168, 0.009736273437738419, 0.03372356668114662, -0.01502992119640112, 0.00664230203256011, 0.02793949842453003, -0.044253163039684296, -0.0027189443353563547, 0.0022068885155022144, 0.00449671596288681, -0.027333686128258705, 0.004604896530508995, 0.029829056933522224, -0.025559520348906517, -0.031242618337273598, -0.008409255184233189, 0.012512913905084133, 0.012563398107886314, 0.05080170929431915, -0.014222171157598495, 0.051119040697813034, 0.0010105890687555075, 0.007457264233380556, -0.009195368736982346, 0.0052900416776537895, -0.013508177362382412, 0.0002483651041984558, -0.03655068948864937, 0.03464670851826668, -0.008438103832304478, 0.013399996794760227, -0.0027189443353563547, 0.026078788563609123, -0.03219461068511009, 0.013976961374282837, -0.008048652671277523, 0.0004728403000626713, 0.012621094472706318, -0.015087617561221123, -0.02734811045229435, 0.022126581519842148, 0.012823032215237617, 0.0016650829929858446, 0.028588583692908287, -0.011813344433903694, 0.0023565387818962336, -0.006469212472438812, -0.0012044130126014352, -0.009714636951684952, 0.013796660117805004, 0.024838315322995186, 0.03409859165549278, -0.024766193702816963, -0.006364637985825539, 0.0023439177311956882, -0.011842193081974983, -0.017092568799853325, -0.011618619784712791, 0.013746174983680248, -0.0031877278815954924, 0.022703547030687332, -0.007053389213979244, 0.0015776368090882897, 0.040070172399282455, 0.003349999198690057, 0.016183849424123764, -0.002515204017981887, 0.021174591034650803, 0.012512913905084133, 0.010810869745910168, -0.020785139873623848, -0.025674913078546524, -0.010154572315514088, -0.02394402027130127, -0.007861139252781868, 0.03311775252223015, 0.005250375252217054, 0.003416710766032338, 0.02110247127711773, -0.009570395573973656, -0.03533906489610672, -0.004842894617468119, -0.028891488909721375, -0.0043596867471933365, 0.051811397075653076, 0.0017344990046694875, 0.03559869900345802, -0.03078104741871357, -0.026107637211680412, -0.03158879652619362, -0.024016140028834343, 0.019126368686556816, -0.015318403020501137, 0.02713174745440483, -0.037791162729263306, -0.00021309366275090724, -0.016977176070213318, 0.019472546875476837, 0.017006024718284607, -0.018967702984809875, 0.004301990382373333, -0.006613453850150108]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"E.1 Path Consistency Learning for Controlled Generation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
E.2 Policy Gradient Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
E.3 Policy Gradient with Mass-Covering / Maximum Likelihood KL Divergence . . . . . . . . . . . . . . . 33
F Bidirectional SMC 36
G Additional Experiment Details 40
G.1 Common Details Across Experiments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
G.2 Choices of Twist Parameterization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
G.3 Comments on Our Choices of Experiment Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
G.4 Experiment-Specific Details . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
H Additional Experimental Results 44
H.1 Qualitative Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
H.2 Infilling with Fewer Tokens . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
H.3 Approximate vs. Exact Posterior Sampling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
14
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Table 5: Examples of Target Posteriors in Language Model Finetuning and Controlled Generation
Type Target References / Examples
Reward σ(s1:T)∝p0(s1:T)e±βr(s1:T)RLHF (Ziegler et al., 2019; Ouyang et al., 2022; Korbak et al., 2022b)
Continuation σ(s1:T)∝p0(s1:T)p0(sT+1:T+c|s1:T)βGenerates tokens based on likelihood of future tokens p(sT+1:T+c|s1:T)
Forβ= 1, this is in-filling (Lew et al., 2023).
Asβ→ ∞ , disregard p0(s1:T), focus on arg max of continuation prob.
- similar to adversarial prompt generation (Zou et al., 2023)
Indicator σ(s1:T)∝p0(s1:T)I[s1:T∈ C] Generations s1:Tfrom this target must satisfy the properties of set C.
where Iis indicator of set C: - Meeting reward threshold Cr≤η:={s1:T| ±r(s1:T)≤η}
I[s1:T∈ C] = 1 if[s1:T∈ C] - Containing topical or specific words in s1:T
I[s1:T∈ C] = 0 if[s1:T/∈ C] - Having certain structure or rhyme (Yang & Klein, 2021),
- Valid output according to verifier (Cobbe et al., 2021; Dohan et al., 2022))
Classifier σ(s1:T)∝p0(s1:T)p(y|s1:T)βClass ycan be a binary (e.g. toxicity) or multinomial (e.g. 1-5 star reviews)
Bayesian posterior for β= 1:σ(s1:T) =p(s1:T|y)∝p0(s1:T)p(y|s1:T)
(Dathathri et al., 2019; Krause et al., 2020; Liu et al., 2021)
Global σ(s1:T)∝p0(s1:T)βTempering on entire sequences (long-horizon) vs","[0.018967824056744576, -0.014928510412573814, 0.04064735397696495, 0.009031960740685463, -0.041833724826574326, 0.018092168495059013, 0.02522452175617218, 0.027992721647024155, -0.030224232003092766, 0.051183465868234634, 0.019631626084446907, -0.026608621701598167, -0.01667982153594494, 0.001376155880279839, -0.024701952934265137, -0.0657023936510086, 0.006595661863684654, -0.008820108138024807, -0.005328080151230097, 0.01666569709777832, -0.019617503508925438, -0.0421161949634552, -0.018275773152709007, 0.028797760605812073, 0.02658037468791008, -0.028204575181007385, 0.02590244822204113, 0.018642984330654144, 0.01666569709777832, -0.013367867097258568, 0.0511552169919014, -0.034517765045166016, -0.03409406170248985, -0.04855649918317795, -0.048471756279468536, 0.0441499762237072, 0.031156379729509354, 0.012541643343865871, -0.01564880833029747, 0.027978599071502686, -0.004290004726499319, -0.05327373743057251, -0.01554994285106659, 0.01622786931693554, -0.00794445350766182, 0.04451718553900719, -0.021425308659672737, -0.024151137098670006, -0.006203735247254372, 0.06445952504873276, -0.04327432066202164, 0.04237041622400284, -0.020351924002170563, -0.007407761178910732, -0.041268788278102875, -0.021919628605246544, -0.018431130796670914, -0.019575132057070732, -0.0004387103545013815, -0.03367035835981369, 0.010959814302623272, -0.033726852387189865, 0.02070501074194908, 0.01937740482389927, -0.0014600139111280441, -0.008848355151712894, -0.05539225786924362, 0.021326443180441856, 0.0006192260188981891, 0.05776500329375267, 0.009377985261380672, -0.003633263288065791, 0.013254879042506218, 0.002745250007137656, -0.04773733764886856, 0.030591441318392754, 0.03409406170248985, 0.03454601392149925, 0.002665805397555232, -0.0252386461943388, 0.03231450542807579, -0.03132586181163788, 0.015338091179728508, -0.02892487123608589, -0.03680576756596565, -0.05234158784151077, -0.021538294851779938, -0.014066978357732296, -0.04358503594994545, -0.025295138359069824, -0.018996071070432663, 0.02251281589269638, -0.048161040991544724, 0.015507572330534458, 0.0473136343061924, 0.009222627617418766, -0.002867064904421568, -0.011298777535557747, 0.03635381907224655, 0.0001566822757013142, 0.029885267838835716, -0.02780911698937416, 0.0012013778323307633, -0.03638206422328949, 0.03502621129155159, -0.020097700878977776, -0.08027781546115875, 0.027272425591945648, -0.0407603420317173, -0.03208852931857109, -0.040986318141222, -0.0055575864389538765, -0.0011696000583469868, 0.04672044515609741, 0.010627913288772106, -0.04785032570362091, -0.028204575181007385, 0.010013542138040066, 0.003640325041487813, 0.022272715345025063, -0.021877259016036987, -0.010260703042149544, 0.0018395823426544666, -0.00704055093228817, 0.009971171617507935, -0.007365391124039888, -0.000985112157650292, -0.06993943452835083, -0.009702825918793678, 0.013043026439845562, 0.0013814521953463554, 0.012259174138307571, -0.027851488441228867, -0.002240335801616311, -0.027851488441228867, -0.0030789170414209366, 0.0229788888245821, 0.006344969850033522, -0.030930405482649803, 0.011553000658750534, -0.008424650877714157, -0.013876311480998993, -0.01193433441221714, 0.010514925234019756, -0.048810720443725586, -0.005363388452678919, -0.036099594086408615, 0.02682047337293625, -0.05994001775979996, 0.050279561430215836, 0.009716949425637722, -0.012824112549424171, -0.04423471540212631, 0.03335964307188988, 0.006023661233484745, -0.07056086510419846, -0.0706738531589508, 0.09649156033992767, -0.0001491791772423312, -0.01903844065964222, -0.01677868515253067, 0.06440303474664688, -0.0018660638015717268, -0.011051617562770844, 0.035873621702194214, -0.0070617361925542355, -0.0020655577536672354, 0.036890510469675064, -0.04587303847074509, -0.024956176057457924, 0.005013832822442055, -0.0060695623978972435, -0.04067559912800789, -0.02151004783809185, 0.004342967644333839, -0.028006846085190773, -0.04833052307367325, -0.05655038356781006, -0.0027275956235826015, -0.0455058291554451, -0.008537638932466507, 0.04951689392328262, -0.07389400899410248, -0.02703232690691948, 0.010324258357286453, -0.0023727433290332556, 0.01177897583693266, -0.00855176243931055, 0.03697524964809418, 0.004000473767518997, -0.022922396659851074, 0.017513105645775795, 0.10044613480567932, 0.0022650519385933876, 0.006171957589685917, -0.02906610630452633, 0.08598370105028152, 0.02398165687918663, 0.01642559841275215, -0.01837463676929474, 0.0015368103049695492, 0.013311373069882393, -0.016976414248347282, -0.06491147726774216, 0.004388869274407625, 0.012012013234198093, -0.006203735247254372, 0.03206028416752815, -0.03705999255180359, -0.011574185453355312, 0.02217385172843933, -0.021142838522791862, 0.03881130367517471, -0.018501749262213707, -0.04019540175795555, 0.015634683892130852, -0.009215565398335457, 0.02892487123608589, 0.013219569809734821, 0.03502621129155159, -0.01611488126218319, 0.021707776933908463, 0.026326153427362442, 0.011235222220420837, -0.026269659399986267, 0.05191788449883461, 0.017089402303099632, -0.01655270904302597, 0.008346972055733204, -0.008368157781660557, 0.04203145578503609, 0.02567647211253643, -0.018176909536123276, -0.07061736285686493, -0.021594788879156113, -0.007478378713130951, -0.008742429316043854, -0.008325787261128426, 0.012887668795883656, -0.06208678334951401, -0.0014414768666028976, 0.0265944991260767, 0.04078858718276024, -0.007598428055644035, 0.011263469234108925, 0.05584421008825302, -0.04381101205945015, 0.004201733041554689, 0.026495633646845818, 0.002166187623515725, 0.016199622303247452, -0.039347995072603226, -0.02288002520799637, 0.032258011400699615, -0.009321492165327072, -0.018459377810359, -0.022244468331336975, -0.011214037425816059, -0.018445255234837532, 0.0009400936542078853, -0.00958277564495802, -0.019871726632118225, -0.05847117677330971, -0.007676107343286276, -0.028896624222397804, -0.00873536802828312, -0.0491214357316494, -0.022272715345025063, 0.029659291729331017, -0.03567589074373245, 0.0038592389319092035, -0.015606436878442764, -0.011948457919061184, 0.0102465795353055, -0.032173268496990204, -0.06553291529417038, 0.032822951674461365, 0.04474316164851189, -0.04539284110069275, 0.01803567446768284, -0.042850617319345474, -0.002572237513959408, 0.05830169469118118, -0.002143237041309476, 0.01666569709777832, 0.006126055959612131, 0.01735774800181389, 0.00743600819259882, -0.01824752613902092, -0.06106989458203316, 0.03251223266124725, -0.013283126056194305, 0.007845588959753513, -0.03855707868933678, 0.016044264659285545, 0.01074796263128519, 0.013996360823512077, 0.010147714987397194, -0.02398165687918663, 0.0034973248839378357, 0.023021260276436806, -0.03076092340052128, -0.006140179466456175, 0.0002760697389021516, -0.0009515689453110099, 0.023120123893022537, -0.0012922977330163121, 0.013156014494597912, 0.002280940767377615, -0.005084449891000986, -0.006394402123987675, -0.013961052522063255, -0.04109930619597435, -0.015239226631820202, -0.005243339110165834, -0.002718768548220396, 0.053527962416410446, -0.026326153427362442, 0.03816162422299385, -0.05417764186859131, -0.030591441318392754, 8.13754741102457e-05, 0.013085396960377693, 0.004890252370387316, 0.0011272296542301774, 0.0118849016726017, -0.01848762482404709, 0.00963220838457346, 0.008142181672155857, 0.018953699618577957, -0.003255460411310196, -0.0027381882537156343, 0.0452798530459404, 0.04581654444336891, -0.006623908411711454, -0.05078800767660141, -0.04064735397696495, 0.07400699704885483, -0.0037285967264324427, 0.016580956056714058, -0.10242342203855515, 0.006217858754098415, -0.0014044027775526047, -0.038133375346660614, -0.029122600331902504, -0.013367867097258568, 0.006885192822664976, 0.06265172362327576, 0.06626733392477036, 0.006327315699309111, -0.0037780290003865957, -0.04208794981241226, 0.026636868715286255, 0.013276063837110996, -0.004741956014186144, 0.010458431206643581, -0.008184552192687988, -0.02511153370141983, -0.0405343659222126, -0.01915142871439457, -0.013756262138485909, 0.01642559841275215, 0.013212508521974087, 0.006973464507609606, -0.028670649975538254, -0.007142946124076843, -0.0378226600587368, 0.01814866252243519, 0.02994176186621189, -0.0028811884112656116, -0.046353235840797424, 0.011305839754641056, -0.026396770030260086, 0.038020387291908264, -0.043076589703559875, -0.015917154029011726, -0.010359566658735275, 0.03166482597589493, 0.017950933426618576, 0.005441067740321159, -0.008375219069421291, 0.0034549543634057045, -0.03369860351085663, -0.014010484330356121, -0.00260578072629869, 0.026834597811102867, -0.011411765590310097, -0.02971578575670719, -0.031580083072185516, 0.0069381557404994965, 0.0043005975894629955, -0.010493740439414978, -0.04132528230547905, 0.04327432066202164, 0.00958277564495802, 0.02713119052350521, -0.04810454696416855, 0.026297906413674355, 0.03412231057882309, 0.03982819244265556, -0.046579211950302124, -0.033500876277685165, -0.012880606576800346, 0.008304601535201073, 0.0022368049249053, 0.02737128920853138, 0.013657397590577602, 0.04810454696416855, 0.032483987510204315, 0.05081625282764435, 0.02499854564666748, 0.0020779159385710955, 0.017837945371866226, -0.006080154795199633, 0.009031960740685463, -0.0017495451029390097, 0.00481610419228673, 0.018431130796670914, 0.06005300581455231, 0.06739720702171326, -0.026425017043948174, -0.035195693373680115, -0.013191323727369308, -0.012449841015040874, -0.013643274083733559, -0.02047903463244438, -0.0013302545994520187, -0.002953571267426014, 0.006980526261031628, -0.008784799836575985, 0.0019313849043101072, 0.06090041249990463, 0.01559231337159872, -0.04590128734707832, -0.017414242029190063, -0.01502737496048212, 0.05931858345866203, 0.005073857493698597, 0.013028902933001518, -0.04954514279961586, 0.00433237524703145, 0.017527230083942413, -0.053104255348443985, 0.013480854220688343, -0.02985702082514763, 0.006330846343189478, -0.014603670686483383, -0.033500876277685165, 0.012365099973976612, -0.05194613337516785, -0.04406523331999779, 0.03039371222257614, 0.035647645592689514, -0.004777264781296253, 0.0075913663022220135, -0.026707487180829048, 0.09383635222911835, -0.0157476719468832, 0.04878247529268265, 0.005490500014275312, 0.039715204387903214, -0.0025810645893216133, -0.019391527399420738, -0.04022365063428879, 0.01848762482404709, 0.0034708434250205755, 0.018996071070432663, -0.018939577043056488, -0.0168775487691164, 0.01800742745399475, -0.020083578303456306, -0.009879369288682938, -0.0003378599358256906, -0.03570413962006569, -0.008205737918615341, 0.007711416110396385, 0.04923442378640175, -0.0554487518966198, 0.01413053460419178, -0.013671521097421646, 0.03448951989412308, 0.020111825317144394, 0.05285003408789635, 0.028882501646876335, -0.02265404909849167, 0.06880956143140793, 0.009942924603819847, -0.04135352745652199, -0.0189113300293684, -0.011199913918972015, 0.016863426193594933, -0.04378276318311691, 0.020535528659820557, -0.017852069810032845, 0.035195693373680115, -0.050053585320711136, -0.015055621974170208, -0.026269659399986267, -0.01502737496048212, -0.010112406685948372, 0.03460250794887543, -0.02206086367368698, -0.01778145134449005, 0.039263252168893814, 0.008318725042045116, -0.002355088945478201, 0.04962988197803497, 0.021312320604920387, 0.017583724111318588, 0.03657979518175125, -0.05304776132106781, -0.023233111947774887, -0.052878279238939285, -0.014617794193327427, -0.0026975832879543304, 0.000776791013777256, -0.039602216333150864, 0.005105635151267052, -0.0008602077723480761, 0.02737128920853138, 0.005338672548532486, -0.012930039316415787, -0.019561009481549263, -0.012033198960125446, 0.017414242029190063, -0.037003498524427414, -0.00023436137416865677, -0.06666278839111328, -0.02433474361896515, -0.05666337162256241, 0.042172688990831375, -0.01724475994706154, 0.0004850529949180782, -0.001851940294727683, -0.05745428428053856, 0.004696054384112358, -0.03132586181163788, -0.004530103877186775, -0.04186197370290756, 0.01667982153594494, -0.021891381591558456, 0.013890434987843037, 0.00479138782247901, 0.0097381342202425, -0.010055912658572197, -0.007443069946020842, 0.02940507046878338, 0.000793562619946897, 0.010204209014773369, 0.02386866882443428, 0.027230054140090942, -0.043528541922569275, -0.006662748288363218, -0.03593011572957039, -0.03358561918139458, -0.00805037934333086, 0.004198202397674322, 0.012315668165683746, -0.009773442521691322, 0.035195693373680115, 0.012697001919150352, -0.015083868987858295, 0.006772205233573914, 0.009928801096975803, -0.02228683978319168, 0.028246944770216942, 0.013127767480909824, 0.007598428055644035, 0.0314953438937664, 0.019575132057070732, -0.03996942564845085, 0.016143128275871277, 0.04553407430648804, 0.0008646213100291789, -0.005716475658118725, -0.01711764931678772, 0.025535238906741142, -0.01502737496048212, 0.002480434952303767, 0.018826588988304138, -0.01992821879684925, -0.022908272221684456, 0.012372162193059921, -0.047228891402482986, -0.035986606031656265, 0.0019737551920115948, 0.023247236385941505, 0.012252111919224262, -0.036212582141160965, -0.006860476918518543, 0.031241120770573616, -0.008064502850174904, -0.025987189263105392, 0.011899025179445744, -0.0265944991260767, 0.007104106713086367, 0.0019084342056885362, -0.010762086138129234, -0.029998255893588066, -0.013205446302890778, 0.032709963619709015, 0.01114341989159584, -0.04350029677152634, -0.018544118851423264, -0.026608621701598167, 0.037681423127651215, -0.04838701710104942, 0.005155067425221205, 0.002321545733138919, -0.010486678220331669, -0.017753204330801964, 0.011517691425979137, 0.00039700197521597147, -0.01699053682386875, 0.011531814932823181, -0.020210688933730125, 0.007598428055644035, -0.009222627617418766, 0.05881014093756676, -0.00675808172672987, 0.02375568076968193, -0.010585542768239975, 0.008375219069421291, 0.0038062757812440395, -0.008389342576265335, 0.013254879042506218, 0.0006571828271262348, -0.030563194304704666, 0.015917154029011726, -0.011863716877996922, -0.01491438690572977, -0.007344205863773823, -0.015677055343985558, 0.007266526576131582, -0.007612551562488079, -0.008544701151549816, -0.008184552192687988, 0.01143295131623745, 0.0016533290036022663, -0.03321840614080429, 0.023699186742305756, 0.01994234323501587, -0.0007489853887818754, -0.014370633289217949, 0.004999709315598011, 0.03751194104552269, -0.022442197427153587, 0.0430200956761837, 0.00021626567468047142, -0.014716658741235733, -0.036325570195913315, -0.026523880660533905, 0.017724957317113876, -0.044884394854307175, 0.025944819673895836, -0.04587303847074509, 0.02412289008498192, -0.009144948795437813, -0.0007675224333070219, -0.03152358904480934, -0.024278249591588974, 0.01600189507007599, -0.02028130739927292, 0.00017058505909517407, 0.01645384542644024, 0.06236925348639488, 0.015083868987858295, 0.032709963619709015, -0.029235588386654854, -0.03084566444158554, -0.03477199003100395, 0.0202671829611063, 0.00362973241135478, -0.010472554713487625, -0.00850939191877842, -0.026382647454738617, -0.006867538671940565, -0.02265404909849167, -0.003024188568815589, 0.016623327508568764, -0.037116486579179764, -0.0023127186577767134, -0.053414974361658096, -0.014928510412573814, 0.0171035248786211, -0.0007759082945995033, 0.01916555128991604, -0.016284363344311714, -0.000592744501773268, 0.014603670686483383, -0.008410528302192688, -0.0014988535549491644, -0.014603670686483383, -0.006454426795244217, 0.006514451466500759, -0.01903844065964222, 0.0057305991649627686, 0.05211561173200607, -0.016835179179906845, -0.05784974247217178, -0.00951922032982111, 0.028077462688088417, -0.02704644948244095, -0.004056967329233885, -0.017032908275723457, -0.00985112227499485, -0.046805188059806824, 0.027837364003062248, 0.0064261797815561295, -0.03355737030506134, -0.012237989343702793, -0.0042511653155088425, -0.030365465208888054, 0.033161912113428116, -0.010500801727175713, -0.0040534366853535175, 0.019306786358356476, -0.0001290973596042022, 0.00375684374012053, -0.03883954882621765, -0.031156379729509354, -0.010126530192792416, -0.027498401701450348, -0.0015818289248272777, -0.04177723079919815, -0.008594132959842682, -0.0387265607714653, 0.019758738577365875, -0.04248340427875519, -0.010910382494330406, 0.0015456374967470765, 0.00655682198703289, 0.006662748288363218, -0.009152010083198547, -0.010832703672349453, 0.025055039674043655, -0.027653759345412254, -0.0007776736747473478, -0.008848355151712894, -0.019433898851275444, 0.015677055343985558, -0.0003321222902741283, -0.02769612893462181, 0.015620560385286808, 0.03626907616853714, 0.041946712881326675, 0.029122600331902504, 0.0439240001142025, 0.02093098685145378, -0.02410876750946045, -0.017188265919685364, 0.012605199590325356, 0.004138177260756493, -0.009081392548978329, 0.0326252207159996, 0.0061437105759978294, 0.039009030908346176, -0.03152358904480934, -0.03409406170248985, -0.005642327480018139, -0.0012949458323419094, 0.008671811781823635, -0.021368814632296562, 0.021128714084625244, 0.006680402439087629, -0.03132586181163788, 0.017866192385554314, 0.019419774413108826, -0.00251750904135406, 0.048697732388973236, -0.012096754275262356, 0.0013779213186353445, -0.008580009452998638, 0.01175779104232788, 0.042511653155088425, 0.016411475837230682, -0.0011943161953240633, -0.008467021398246288, -0.019448021426796913, -0.00013494536688085645, -0.0015579955652356148, 0.004424177575856447, -0.002628731308504939, -0.018868958577513695, -0.029546303674578667, -0.005257462617009878, -0.023360222578048706, -0.010366628877818584, -0.012986533343791962, -0.057821497321128845, -0.017583724111318588, 0.01538046170026064, -0.0014741374179720879, -0.011913148686289787, -0.015210979618132114, 0.02228683978319168, -0.016510339453816414, -0.11016308516263962, -0.04471491277217865, 0.03313366696238518, -0.0011042789556086063, 0.030930405482649803, -0.03152358904480934, 0.026721609756350517, -0.012082630768418312, -0.028981365263462067, -0.038783054798841476, 0.005568178836256266, -0.002307422226294875, -0.005063265096396208, -0.010670283809304237, 0.007164131384342909, -0.05474257841706276, -0.028769513592123985, -0.0400824137032032, 0.020366046577692032, -0.027766747400164604, -0.008474083617329597, -0.01391162071377039, -0.018275773152709007, 0.035647645592689514, -0.030139490962028503, -0.012838236056268215, 0.023106001317501068, 0.02940507046878338, -0.005031486973166466, 0.006630970165133476, -0.008798923343420029, -0.025408126413822174, 0.02915084734559059, 0.02039429359138012, -0.023148370906710625, -0.009568652138113976, -0.01408110186457634, 0.008120996877551079, 0.005893019028007984, 0.0009259701473638415, 0.021877259016036987, -0.0400824137032032, 0.055900704115629196, -0.02509741112589836, 0.03547816351056099, -0.027653759345412254, 0.01098806131631136, 0.007866773754358292, 0.005275116767734289, -0.01530984416604042, 0.0025634102057665586, -0.005504623521119356, 0.01634085737168789, -0.02522452175617218, -0.009949985891580582, 0.0175554770976305, -0.013600903563201427, 0.004406523425132036, 0.03660804033279419, 0.026989955455064774, -0.013389051891863346, 0.02285177819430828, 0.03612784296274185, -0.03177781403064728, -0.03539342060685158, -0.04011066257953644, 0.00822692271322012, 0.005850648507475853, -0.016241993755102158, -0.02196200005710125, -0.008594132959842682, 0.010613789781928062, -0.012301544658839703, 0.031354110687971115, -0.02960279770195484, -0.0004528338322415948, 0.013530286960303783, 0.020408418029546738, -0.03313366696238518, 0.03313366696238518, 0.030817417427897453, -0.03703174367547035, -0.0024468915071338415, 0.02196200005710125, -0.00873536802828312, 0.03016773797571659, 0.004936153534799814, 0.00958277564495802, -0.013643274083733559, 0.05765201523900032, 0.04446069151163101, -0.05575947090983391, -0.0016330265207216144, -0.03254048153758049, -0.009935863316059113, -0.020182441920042038, -0.022922396659851074, 0.03313366696238518, 0.023896915838122368, -0.00855176243931055, 0.016354981809854507, 0.040816836059093475, -0.05270880088210106, -0.01848762482404709, -0.006479143165051937, 0.03638206422328949, 0.007443069946020842, 0.013191323727369308, -0.0008588836644776165, 0.002471607644110918, 0.01858649030327797, 0.002554583130404353, -0.04900844767689705, 0.01643972285091877, -0.012951224111020565, 0.015634683892130852, 0.06937449425458908, 0.01171542052179575, 0.016298487782478333, 0.009992356412112713, 0.03234275057911873, 0.025761213153600693, -0.0041946712881326675, 0.015239226631820202, -0.03590186685323715, -0.02499854564666748, 0.00619667349383235, 0.003908670973032713, -0.014292954467236996, -0.025605855509638786, 0.014843769371509552, -0.017866192385554314, 0.03770967200398445, -0.012555766850709915, -0.010161838494241238, 0.007054674439132214, 0.017400117591023445, -0.010910382494330406, -0.037342462688684464, 0.02443360723555088, 0.0012102050241082907, -0.011574185453355312, 0.013615027070045471, 0.014370633289217949, -0.008587071672081947, -0.019193798303604126, 0.010825641453266144, -0.03457425907254219, -0.023176617920398712, 0.00442064693197608, 0.03386808559298515, -0.013897497206926346, -0.02038017101585865, -0.0038663006853312254, 0.010966876521706581, 0.009971171617507935, 0.021877259016036987, -0.024405360221862793, 0.005137413274496794, 0.012075568549335003, 0.013269002549350262, 0.06897903978824615, 0.011277592740952969, -0.01013359148055315, 0.010875074192881584, -0.04299185052514076, 0.011228160932660103, -0.004862005356699228, -0.019801108166575432, -0.019066687673330307, -0.04604252055287361, -0.07095632702112198, 0.02566234953701496, 0.002625200431793928, 0.011553000658750534, -0.00695227924734354, 0.009257935918867588, 0.01373507734388113, 0.015408708713948727, 0.0210580974817276, 0.03177781403064728, 0.016976414248347282, -0.039235007017850876, -0.0043747457675635815, 0.04180547967553139, -0.024292372167110443, 0.008756552822887897, 0.016580956056714058, -0.0009550998220220208, 0.0186853539198637, -0.001678045024164021, 0.010105344466865063, 0.005621142219752073, 0.034630753099918365, -0.00624963641166687, -0.008106873370707035, 0.018078044056892395, -0.0056811668910086155, 0.006394402123987675, -0.03979994356632233, -0.05629616230726242, 0.02937682345509529, -0.02309187687933445, 0.0073936376720666885, -0.031015144661068916, 0.022936519235372543, -0.014158781617879868, 0.0105290487408638, 0.0038804239593446255, 0.008488207124173641, 0.002946509514003992, -0.01278880424797535, -0.013629150576889515, 0.01645384542644024, -0.03220151737332344, -0.04378276318311691, 0.009074331261217594, 0.020111825317144394, -0.03042195923626423, -0.021806642413139343, -0.04604252055287361, -0.026975832879543304, -0.0009392109350301325, -0.006570945493876934, -0.034291792660951614, 0.022498691454529762, 0.010719715617597103, 0.026622746139764786, -0.02352970466017723, -0.007125291973352432, -0.01656683348119259, -0.0073583293706178665, -0.006662748288363218, -0.01803567446768284, 0.0025404596235603094, -0.013607965782284737, -0.0023868668358772993, -0.009971171617507935, -0.023473210632801056, 0.008742429316043854, 0.0344330258667469, -0.003209559014067054, 0.0062849451787769794, -0.019179675728082657, -0.007669045589864254, -0.033726852387189865, 0.009547467343509197, 0.018840711563825607, -0.020309552550315857, -0.02095923386514187, -0.009490973316133022, 0.03254048153758049, 0.041607748717069626, -0.009928801096975803, 0.011553000658750534, 0.00521156145259738, 0.032173268496990204, 0.027102943509817123, 0.023374347016215324, 0.011948457919061184, -0.0041275848634541035, 0.00318131223320961, 0.02937682345509529, -0.01734362356364727, 0.00034712845808826387, -0.040477871894836426, 0.018770094960927963, 0.020182441920042038, 0.017428364604711533, 0.013629150576889515, -0.027117067947983742, 0.024504223838448524, 0.009533343836665154, 0.049064941704273224, 0.01215324830263853, -0.010366628877818584, -0.002314483979716897, -0.03276645764708519, 0.02869889698922634, -0.010875074192881584, -0.0439240001142025, -0.019207922741770744, -0.03358561918139458, -0.026848720386624336, 0.024391237646341324, 0.0058718337677419186, 0.007132353726774454, 0.003650917671620846, 0.015239226631820202, -0.0041452390141785145, 0.0416642427444458, 0.030478453263640404, -0.026368523016572, 0.005426944233477116, -0.008580009452998638, 0.004484202712774277, 0.018431130796670914, 0.04855649918317795, 0.009476849809288979, -0.025069164112210274, -0.01063497457653284, -0.009893492795526981, 0.009935863316059113, -0.014109348878264427, 0.015041498467326164, 0.03206028416752815, 0.028741266578435898, -0.020111825317144394, -0.00035507293068803847, -0.0258035846054554, -0.04253989830613136, 0.011369395069777966, -0.008643564768135548, -0.00012953871919307858, 0.02025306038558483, -0.023134248331189156, 0.0066733406856656075, -0.009618084877729416, -0.007626675069332123, -0.010719715617597103, -0.03256872668862343, -0.01351616345345974, -0.007195909041911364, 0.015959523618221283, -0.018515871837735176, 0.011581247672438622, 0.01745661161839962, -0.0056493887677788734, 0.025069164112210274, 0.025281015783548355, 0.02511153370141983, -0.012146186083555222, 0.0044100540690124035, -0.00164803268853575, -0.014229398220777512, 0.01971636712551117, -0.03770967200398445, -0.0002985790488310158, -0.0063379080966115, -0.037766166031360626, -0.001453834935091436, -0.0040216585621237755, -0.020210688933730125, 0.0036544485483318567, 0.0009242047090083361, -0.009031960740685463, 0.0016948167467489839, -0.005303363781422377, 0.009356800466775894, -0.031693071126937866, 0.07976937294006348, -0.0038874857127666473, -0.02071913331747055, -0.00010873970313696191, -0.02309187687933445, 0.0173295009881258, -0.02194787561893463, -0.029772279784083366, -0.04923442378640175, 0.009194380603730679, 0.006016599480062723, 0.009942924603819847, -0.022894149646162987, -0.0033543247263878584, 0.03132586181163788, -0.003333139466121793, -0.010839764960110188, -0.0036897570826113224, 0.035421669483184814, 0.003838053671643138, 0.06180431693792343, 0.031043391674757004, -0.022145604714751244, -0.0014423596439883113, 0.0015571127878502011, -0.0005486086593009531, -0.018642984330654144, 0.003516744589433074, 2.292305725859478e-05, 0.0224139504134655, 0.0033507938496768475, -0.02578946016728878, -0.06022248789668083, 0.0037321276031434536, -0.007407761178910732, 0.009766381233930588, -0.020111825317144394, 0.018176909536123276, -0.012040260247886181, 0.027766747400164604, -0.007195909041911364, -0.010910382494330406, -0.0020373109728097916, 0.0028017438016831875, -0.003792152274399996, 0.005197437945753336, -0.009928801096975803, 0.012845298275351524, 0.007022896781563759, -0.00097451958572492, -0.0034955593291670084, -0.02186313457787037, 0.0027982129249721766, -0.01836051419377327, 0.00757724279537797, -0.04530809819698334, -0.02667924016714096, 0.02138293720781803, -0.005861240904778242, 0.016157252714037895, -0.03881130367517471, 0.018459377810359, -0.010684407316148281, 0.010077097453176975, 0.007647860329598188, -0.043189577758312225, -0.003958103246986866, 0.0011899025412276387, 0.014335324987769127, 0.05239808186888695, -0.020295429974794388, -0.0027576079592108727, -0.005578771699219942, -0.0011643037432804704, 0.013706830330193043, 0.01813453808426857, -0.0018660638015717268, -0.004710177890956402, -0.005917734932154417, 0.05172015726566315, -0.028910748660564423, -0.012478088028728962, -0.033952828496694565, 0.009356800466775894, 0.0186853539198637, 0.0033737444318830967, 0.05285003408789635, 0.021001603454351425, -0.027215931564569473, 0.022357456386089325, -0.010882135480642319, 0.012125001288950443, 0.02747015468776226, 0.009370923973619938, -0.006676871795207262, -0.021354690194129944, 0.02228683978319168, -0.006959341000765562, -0.014843769371509552, 0.02186313457787037, 0.004494795110076666, -0.017047030851244926, 0.011093988083302975, 0.007520749233663082, -0.03680576756596565, 0.00779615668579936, -0.06677577644586563, -0.0003857473493553698, 0.0020708541851490736, 0.028529414907097816, 0.006574476603418589, -0.0002039076352957636, 0.026862844824790955, -0.014886139892041683, 0.009335615672171116, 0.00940623227506876, -0.01588890701532364, 0.017047030851244926, 0.0038663006853312254, -0.04491264373064041, 0.0245607178658247, 0.006966402754187584, 0.015083868987858295, 0.0083822812885046, -0.01182134635746479, -0.019688120111823082, -0.0065815383568406105, -0.018176909536123276, -0.010437246412038803, -0.01656683348119259, -0.028289316222071648, 0.01153887715190649, -0.012753495946526527, 0.01210381556302309, 0.034743741154670715, -0.0060377842746675014, -0.004011066164821386, -0.015281597152352333, -0.026071930304169655, 0.0026675709523260593, -0.008580009452998638, 0.0043923999182879925, 0.00035750039387494326, 0.01312070619314909, -0.002782324096187949, 0.0033402012195438147, 0.013304310850799084, 0.001607427722774446, 0.005282178521156311, 0.0031265837606042624, 0.008177490904927254, 0.0032907691784203053, 0.010175962001085281, 0.018219279125332832, 0.017527230083942413, 0.0033878679387271404, -0.014278830960392952, -0.014688411727547646, 0.004696054384112358, 0.0017910328460857272, 0.028303438797593117, -0.011955519206821918, -0.01333962008357048, -0.0018731255549937487, 0.04417822137475014, 0.005373981315642595, -0.02590244822204113, 0.006189611740410328, -0.008975466713309288, -0.008523515425622463, 0.007718477863818407, -0.004590128548443317, -0.0242217555642128, -0.0167645625770092, -0.005652919877320528, -0.031580083072185516, -0.0009603961370885372, 0.020775627344846725, -0.015634683892130852, 0.011440012603998184, -0.03480023518204689, -0.018657106906175613, 0.022018494084477425, -0.016199622303247452, -0.036523301154375076, -0.00923675112426281, -0.0028405834455043077, 0.020436665043234825, -0.01858649030327797, 0.0029924106784164906, 0.00816336739808321, -0.026368523016572, 0.007012303918600082, -0.011863716877996922, 0.007774971425533295, -0.0020267183426767588, 0.004364152904599905, -0.0027876202948391438, 0.02837405540049076, 0.020549653097987175, -0.0007644329452887177, -0.008431713096797466, 0.03084566444158554, 0.0055187470279634, -0.008608256466686726, 0.0040534366853535175, -0.0019578663632273674, -0.007022896781563759, -0.016467968001961708, -0.016510339453816414, 0.026509758085012436, 0.0057482533156871796, 0.0008028311422094703, -0.002588126342743635, 0.03471549600362778, -0.0328511968255043, 0.008262231014668941, -0.007220625411719084, -0.0077467248775064945, -0.01735774800181389, -0.018106291070580482, 0.02441948466002941, 0.020464912056922913, 0.0047278325073421, -0.03189080208539963, 0.032258011400699615, 0.010550233535468578, -0.0258035846054554, 0.007880897261202335, 0.04129703342914581, 0.024250002577900887, -0.028444673866033554, -0.01339611317962408, 0.009695763699710369, 0.00958277564495802, 0.01463191770017147, 0.009003713726997375, -0.019744614139199257, -0.006934625096619129, 0.03061968833208084, -0.0391785129904747, 0.021453553810715675, -0.001892545260488987, 0.005257462617009878, -0.018544118851423264, 0.06022248789668083, -0.01498500443994999, 0.029687538743019104, -0.026368523016572, -0.002136175287887454, 0.023148370906710625, 0.03177781403064728, 0.002868830459192395, -0.03748369589447975, -0.011079864576458931, -0.023783927783370018, 0.009483912028372288, -0.03604310005903244, -0.02015419490635395, 0.035308681428432465, -0.0360148549079895, -0.015564066357910633, 0.005257462617009878, -0.014144658111035824, -0.019010193645954132, 0.007337144110351801, -0.006613316014409065, -0.0042511653155088425, -0.019433898851275444, 0.00967457890510559, 0.02093098685145378, 0.016086634248495102, -0.013191323727369308, -0.02420763112604618, 0.037681423127651215, 0.023402594029903412, 0.017498983070254326, -0.01002766564488411, 0.028628278523683548, -0.020902739837765694, 0.041946712881326675, -0.0070052421651780605, 0.005599956959486008, -0.0014988535549491644, 0.01645384542644024, -0.018755970522761345, -0.03039371222257614, -0.015903029590845108, 0.003965165000408888, 0.015959523618221283, -0.0255776084959507, 0.00402518967166543, 0.02149592526257038, -0.04028014466166496, -0.00034712845808826387, -0.0034637816715985537, 0.012626384384930134, -0.04203145578503609, 0.005861240904778242, 0.051748402416706085, -0.01958925649523735, -0.004282942973077297, -0.00030696485191583633, -0.004530103877186775, 0.021227579563856125, 0.0511552169919014, -0.02059202268719673, 0.03454601392149925, 0.0012446310138329864, -0.006789859384298325, 0.017484858632087708, 0.018459377810359, 0.0015835943631827831, -0.005546994041651487, -0.017626093700528145, 0.03155183792114258, -0.0012578717432916164, -0.007859712466597557, -0.03584537282586098, 0.032399244606494904, -0.031354110687971115, 0.011510630138218403, -0.01278880424797535, 0.017400117591023445, 0.052765294909477234, -0.015677055343985558, -0.02420763112604618, 0.011856655590236187, -0.011891963891685009, -0.008700058795511723, 0.015535819344222546, -2.4826415483403252e-06, 0.02467370592057705, -0.006613316014409065, 0.008417589589953423, -0.01598777063190937, 0.00495733879506588, -0.0073583293706178665, 0.032399244606494904, -0.029009612277150154, -0.011072802357375622, 0.01813453808426857, 0.008883664384484291, -0.006214328110218048, -0.017202390357851982, 0.017866192385554314, -0.013318434357643127, 0.007365391124039888, -0.011178728193044662, 0.021142838522791862, 0.02974403277039528, 0.010112406685948372, 0.005253931973129511, -0.023162495344877243, 0.028190450742840767, 0.017753204330801964, -0.0009250874281860888, 0.008071564137935638, -0.025747090578079224, -0.01430001575499773, -0.011877840384840965, -0.018868958577513695, 0.047567855566740036, 0.004169955383986235, 0.017739081755280495, 0.011270531453192234, 0.004448893945664167, -0.018642984330654144, 0.002745250007137656, 0.0050456104800105095, -0.007097044959664345, 0.02073325775563717, 0.008106873370707035, 0.024744324386119843, -0.013410236686468124, -0.009088454768061638, -0.03875480964779854, -0.035873621702194214, 0.016058389097452164, -0.0075913663022220135, 0.015931276604533195, -0.04584479331970215, -0.0016639216337352991, -0.004925561137497425, 0.020803874358534813, -0.013537348248064518, -0.0216230358928442, 0.01463191770017147, -0.021566541865468025]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
". per-token (myopic)
Temperature - yields higher quality generation in Shih et al. (2023)
Distributional σ(s1:T)∝p0(s1:T)eβ·T(s1:T)KL minimization subj. expectation constraints on T={Ti}
arg min DKL(q(s1:T)∥p0(s1:T))s.t.Eq[T] =ηβ
(β= optimal Lagrange multipliers for constraints η)
e.g. gender roles/references (Khalifa et al., 2020)
Intermediate References / Examples
Indicator ϕt(s1:t) =I[st∈ C]orI[s1:t∈ C] words of specific length, or specific sets of tokens
(Khalifa et al., 2020; Lew et al., 2023)
Product of
Experts σ(s1:T)∝QM
m=1QT
t=1p0(st|s1:t−1,s(m)
0)prompt intersection (Lew et al., 2023)
A. Proofs
In this section, we present the sense in which the target marginals correspond to the optimal intermediate distributions
in twisted SMC. We defer proof of Prop. 3.2 from the main text to slightly more general version in App. B.1 Prop. B.1,
although Prop. A.4 provides the analogous statement in terms of the intermediate target distributions π∗
t(s1:t) =σ(s1:t)
instead of the optimal twists ψ∗
t.
We also prove Prop. 3.3 from the main text in App. A.2 and derive the gradient of the CTL loss (Eq. (22)) in App. A.3.
A.1. Proof for Optimal Intermediate Target Distributions
In order to achieve sampling from the full joint distribution σ(s1:T), each intermediate target σ(s1:t)must match the
intermediate marginal σ(s1:t). To formalize this notion, we provide the following definition of optimality, justified by the
fact that it yields an exact partition function estimator.
To do so, we will consider the multi-step importance weights
wt:t+c−1(s1:t+c−1) =t+c−1Y
τ=twτ(s1:τ) =t+c−1Y
τ=t˜πτ(s1:τ)
˜πτ−1(s1:τ−1)q(sτ|s1:τ−1)=˜πt+c−1(s1:t+c−1)
˜πt−1(s1:t−1)q(st:t+c−1|s1:t−1)
(c-Step SMC Weights)
using a telescoping cancellation in the final equality. The one-step weights correspond to c= 1, denoted simply as wt.
Definition A.1 (Optimal Twisted SMC Sampling ).For a given target distribution σ(s1:T)∝p0(s1:T)ϕ(s1:T), we refer
to a twisted SMC procedure, SMC ({πt}T
t=1, q, K )orSMC (p0,{ψt}T
t=1, q, K )(with πT=σorψT=ϕ), as optimal if
c-step importance weights wt:t+c−1(s1:t+c−1) =Zψ
t+c−1/Zψ
t−1for all 1≤t≤Tand0≤c≤T−t+ 1.
Note, that the role of ψtandZψ
tis specified in Def. 3.1. We assume πT=σfor the goal of estimating Zσ, and show below
that an optimal twisted SMC procedure yields an exact partition function estimator.
15
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Proposition A.2 (Optimal SMC yields Exact Partition Function Estimation ).For any optimal twisted SMC procedure,
the resulting estimator of the partition function Zσhas zero bias and zero variance.
Proof. As in Footnote 1 or App. F Alg. 2, consider {tr}R
r=1index timesteps where resampling occurs and fix t0= 0and
tR=T. The SMC estimator of Zσ=Zψ
Tbecomes ˆZSMC
σ=QR
r=11
KPK
i=1Qtr
t=tr−1+1wt 
si
1:t
forS∼qSMC(S).
Using the optimality definition in Def. A.1, we have wt","[0.03561825677752495, -0.023671679198741913, 0.031735945492982864, 0.025378333404660225, -0.03108454868197441, 0.0038725407794117928, 0.0238801259547472, 0.021808691322803497, -0.05049610882997513, -0.004751923494040966, 0.029547259211540222, -0.002558352192863822, -0.03345562517642975, 0.02759307436645031, 0.022942116484045982, -0.001490879338234663, 0.024635743349790573, -0.0014949506148695946, -0.0324394516646862, 0.03559219837188721, -0.01607641763985157, -0.022850921377539635, -0.01182281132787466, 0.01194657664746046, -0.014969047158956528, -0.03298662230372429, 0.01522960513830185, -0.031032437458634377, 0.031162716448307037, -0.003800887381657958, 0.04033435136079788, -0.024179767817258835, -0.020935822278261185, -0.08259683102369308, -0.012728250585496426, 0.0815545991063118, -0.003585927188396454, 0.04101180285215378, -0.026107894256711006, 0.02361956797540188, -0.014682433567941189, -0.026316341012716293, -0.06805770844221115, 0.034263353794813156, 0.01885135844349861, 0.019528809934854507, 0.02074040286242962, -0.023424148559570312, -0.0020144376903772354, 0.04718702286481857, -0.03512319549918175, 0.03981323540210724, 0.013692313805222511, -0.013718370348215103, -0.02157418802380562, 0.005725758615881205, -0.018186936154961586, -0.005735529121011496, 0.015021159313619137, -0.03924001008272171, 0.030172597616910934, -0.006826615426689386, 0.01535988412797451, 0.014473987743258476, -0.011620879173278809, -0.019372474402189255, -0.0005056450609117746, 0.05054821819067001, -0.031110605224967003, 0.03165777772665024, -0.03358590602874756, 0.0026772317942231894, 0.011510142125189304, -0.006917810533195734, -0.032700009644031525, 0.006741933990269899, 0.01272173598408699, 0.02556072361767292, 0.02649873122572899, -0.04335682466626167, -0.011510142125189304, -0.015242633409798145, 0.024179767817258835, -0.0076734283939003944, -0.01978936791419983, -0.04111602529883385, -0.023215703666210175, 0.0028075105510652065, -0.05026160553097725, -0.0025469528045505285, -0.029729649424552917, 0.019893590360879898, -0.021079128608107567, 0.011236556805670261, 0.06748447567224503, -0.026733234524726868, 0.02281183749437332, -0.0007991797174327075, 0.020675264298915863, -0.0284529160708189, 0.023828014731407166, -0.003937680274248123, 0.0012197364121675491, -0.05062638595700264, 0.045311007648706436, -0.027045903727412224, -0.017222872003912926, 0.010637274011969566, -0.05028766021132469, 0.0023580484557896852, -0.008845938369631767, -0.009914225898683071, -0.018994666635990143, 0.025717057287693024, 0.023945264518260956, -0.025013552978634834, -0.04567578807473183, 0.0003405572206247598, -0.02218649908900261, 0.018994666635990143, -0.008227113634347916, 0.0056638759560883045, 0.03879706189036369, 0.018460523337125778, 0.013040919788181782, -0.020349567756056786, 0.011086735874414444, -0.09077835083007812, -0.014734545722603798, 0.03864072635769844, 0.03191833570599556, 0.007953528314828873, -0.02423187904059887, -0.011894465424120426, 0.015998251736164093, -0.014617294073104858, 0.016610562801361084, 0.02915642224252224, -0.00423080800101161, 0.0038855685852468014, -0.027019847184419632, -0.014982075430452824, -0.01300834957510233, -0.004869174677878618, -0.03324718028306961, -0.02218649908900261, -0.037129491567611694, 0.025769170373678207, -0.05099116638302803, 0.02579522505402565, -0.01620669662952423, -0.039891403168439865, -0.01481271255761385, 0.018916498869657516, 0.001015361282043159, -0.04752574861049652, -0.0482553094625473, 0.06529579311609268, 0.039187896996736526, -0.03767666220664978, -0.00749755185097456, 0.0309542715549469, -0.00911301001906395, 0.01259145699441433, 0.007276077289134264, -0.002685374114662409, -0.0019965243991464376, 0.04835953563451767, -0.044346943497657776, -0.0504179410636425, 0.012825959362089634, -0.05648893862962723, -0.04327865689992905, -0.04478989169001579, 0.016011279076337814, -0.027332516387104988, -0.0016919974004849792, -0.07347730547189713, -0.009940281510353088, -0.016506338492035866, 0.0020176947582513094, 0.04221037030220032, -0.0066116550005972385, -0.012057313695549965, 0.013783509843051434, 0.015372912399470806, -0.004618387669324875, 0.018173908814787865, 0.02038864977657795, -0.012493748217821121, -0.009256317280232906, 0.05977196618914604, 0.05172073096036911, -0.030328931286931038, -0.038458336144685745, 0.009621097706258297, 0.0489327609539032, 0.07577022165060043, 0.024505464360117912, 0.012265760451555252, 0.017196817323565483, 0.009334484115242958, -0.010793608613312244, -0.02592550404369831, -0.00959504209458828, 0.015099326148629189, -0.0034426203928887844, 0.020597096532583237, -0.06930838525295258, 0.011217014864087105, 0.018056657165288925, -0.01668872870504856, 0.061960652470588684, 0.03290845453739166, -0.017483429983258247, 0.03431546688079834, -0.06753659248352051, 0.0173922348767519, -0.02601669915020466, 0.06305499374866486, 0.01097599882632494, 0.027280405163764954, 0.04335682466626167, 0.009451735764741898, -0.03332534804940224, 0.01216805074363947, 0.010526536032557487, -0.030381042510271072, 0.03189227730035782, -0.037259768694639206, 0.048541925847530365, 0.05263268202543259, -0.015698609873652458, -0.024166738614439964, -0.027645185589790344, -0.018434466794133186, -0.03801538795232773, -0.005836495663970709, -0.03358590602874756, -0.07264352589845657, -5.730236807721667e-05, -0.0025290395133197308, 0.028843753039836884, -0.01236346922814846, 0.01541199628263712, 0.014434903860092163, -0.022577336058020592, -0.01380956545472145, -0.014786656945943832, 0.010174783878028393, 0.020115064457058907, -0.027045903727412224, -0.011236556805670261, 0.0069829500280320644, -0.03387251868844032, 0.00888502225279808, 0.005191614851355553, 0.0001932809827849269, -0.007028547581285238, 0.03217889368534088, -0.0193073358386755, -0.03230917081236839, -0.04895881563425064, 0.006702850107103586, -0.008806854486465454, -0.015073270536959171, -0.0126500828191638, 0.00385625590570271, 0.04140263795852661, -0.032074667513370514, 0.0028905635699629784, 0.0165584497153759, -0.0016691986238583922, 0.042418815195560455, -0.009972850792109966, -0.03765060752630234, -0.020453790202736855, 0.02941698022186756, -0.05031371861696243, 0.01582888886332512, -0.018069686368107796, -0.04249698296189308, 0.03921395540237427, -0.011236556805670261, 0.032830286771059036, -0.002823795424774289, 0.01584191620349884, 0.05565515160560608, -0.003950708080083132, -0.08098137378692627, 0.010539564304053783, -0.006465091370046139, -0.001385027775540948, -0.0047160969115793705, 0.001902072224766016, 0.017470402643084526, -0.0006501732277683914, -0.0071392846293747425, -0.005077620968222618, 0.004852889571338892, 0.06279443949460983, -0.014239485375583172, 0.007614802569150925, 0.009582014754414558, -0.002928018569946289, -0.012369982898235321, 0.023854069411754608, 0.030433155596256256, -0.0342894122004509, 0.010383229702711105, -0.041585031896829605, -0.031866222620010376, -0.01133426558226347, 0.032335225492715836, -0.007256535813212395, -0.023111479356884956, 0.0510953925549984, -0.02591247670352459, -0.008715659379959106, -0.043382879346609116, -0.019620005041360855, -0.01835629902780056, -0.012610998935997486, -0.010793608613312244, 0.006070997565984726, -0.03804144263267517, -0.03337745741009712, -0.018786219879984856, -0.019750284031033516, -0.009464763104915619, 0.02361956797540188, 0.010891317389905453, 0.04132447391748428, 0.027905743569135666, -0.03324718028306961, -0.026120923459529877, -0.008637492544949055, 0.06883937865495682, 0.014421876519918442, 0.055134039372205734, -0.06670280545949936, 0.010591675527393818, -0.014539127238094807, -0.06576479971408844, 0.021522076800465584, 0.0038302000612020493, 0.030537378042936325, 0.056332603096961975, 0.08509819209575653, 0.019893590360879898, 0.00548799941316247, -0.013822592794895172, 0.019646061584353447, -0.0015755606582388282, 0.014669406227767467, -0.011672991327941418, 0.007035061717033386, -0.041350528597831726, -0.051668617874383926, -0.01581585966050625, -0.007263049483299255, -0.005869065411388874, 0.055394597351551056, 0.014304624870419502, 0.010585161857306957, 0.04351315647363663, -0.03152749687433243, 0.0005695631261914968, -0.022147415205836296, 0.003165777772665024, -0.01522960513830185, 0.007510579656809568, 0.0219650249928236, 0.0024639000184834003, -0.03710343688726425, -0.027436740696430206, -0.017353150993585587, 0.03530558571219444, 0.03765060752630234, -0.0012571915285661817, 0.005575937684625387, -0.003081096336245537, -0.005816953722387552, -0.010865261778235435, 0.026485703885555267, -0.009992392733693123, -0.01967211626470089, 0.004208009224385023, -0.03238733857870102, 0.010611217468976974, -0.009920739568769932, 0.022108331322669983, -0.03937028720974922, 0.018212992697954178, 0.0005642705364152789, -0.0011619251454249024, -0.007048089522868395, 0.029938094317913055, 0.031162716448307037, 0.03572247922420502, -0.035826701670885086, 0.0016268580220639706, -0.04544128477573395, -0.03259578347206116, -0.04161108657717705, 0.011190959252417088, 0.011549226008355618, 0.03191833570599556, 0.020427733659744263, 0.07561388611793518, 0.04635323956608772, -0.05073061212897301, 0.03637387230992317, 0.01607641763985157, 0.0060221427120268345, -0.03168383240699768, 0.00548799941316247, 0.042783595621585846, 0.04064702242612839, 0.04056885465979576, -0.03345562517642975, -0.03350773826241493, 0.011171417310833931, -0.0060905395075678825, -0.012343927286565304, -0.007347730919718742, 0.040021684020757675, -0.03613937273621559, 0.030042318627238274, -0.02806207910180092, 0.02483116090297699, 0.045649733394384384, 0.05544670671224594, -0.016284864395856857, -0.026537815108895302, 0.006214304361492395, 0.05013132840394974, -0.02746279537677765, -0.00347844697535038, -0.04713491350412369, -0.03840622305870056, 0.014239485375583172, -0.03285634145140648, -0.009985879063606262, 0.0005296652088873088, 0.005693188868463039, -0.001877644914202392, -0.050574276596307755, 0.027045903727412224, 0.0029850157443434, 0.012682653032243252, -0.012454664334654808, 0.04718702286481857, -0.04260120540857315, -0.020245343446731567, -0.028140246868133545, 0.06675491482019424, -0.01872107945382595, 0.014982075430452824, -0.015021159313619137, 0.025951560586690903, 0.0005650848033837974, -0.01954183727502823, 0.016832036897540092, 0.0035240447614341974, 0.034497857093811035, 0.03994351625442505, -0.018551718443632126, 0.0012083369074389338, 0.03405490890145302, 0.009790460579097271, -0.04749969393014908, 0.013301477767527103, -0.008233627304434776, -0.002188685815781355, 0.0031299509573727846, 0.07535332441329956, -0.05265873670578003, 0.01422645803540945, -0.02041470631957054, 0.05617626756429672, -0.03249156102538109, 0.016402116045355797, 0.031136661767959595, 0.03866678103804588, 0.049010928720235825, 0.034133076667785645, -0.024648770689964294, 0.00444251112639904, 0.026225145906209946, -0.015763748437166214, -0.06331555545330048, 0.005751814227551222, -0.014421876519918442, 0.0396047905087471, -0.0520855113863945, 0.04142869636416435, -0.008416018448770046, -0.03548797592520714, -0.00015155102300923318, 0.0565931610763073, 0.004563019145280123, -0.0010788722429424524, 0.0504179410636425, 0.029833871871232986, 0.03035498782992363, 0.033038731664419174, -0.0024948413483798504, 0.011353807523846626, 0.06284654885530472, -0.03720765933394432, 0.00978394690901041, -0.014200401492416859, 0.009868628345429897, 0.009380081668496132, 0.0016268580220639706, -0.021404825150966644, -0.012936696410179138, 0.01825207658112049, 0.019737256690859795, 0.005478228442370892, -0.0157246645539999, -0.039187896996736526, -0.010005421005189419, 0.018538689240813255, -0.017066538333892822, -0.0013304734602570534, -0.10234712064266205, -0.044346943497657776, -0.027202237397432327, 0.020844627171754837, -0.017783071845769882, -0.00452393526211381, 0.010467911139130592, -0.0007397399749606848, 0.033299289643764496, -0.040855467319488525, -0.004706325940787792, -0.006412979681044817, 0.0037878595758229494, -0.01835629902780056, -0.03817172348499298, 0.006308756768703461, 0.006458577234297991, 0.003455648198723793, -0.02075343206524849, 0.015255660749971867, -0.0053218938410282135, -0.003768317634239793, 0.008122890256345272, -0.0020128092728555202, -0.029469091445207596, 0.006080768536776304, -0.0013215168146416545, -0.038692839443683624, -0.012024744413793087, 0.006220818497240543, 0.009217233397066593, -0.0021512305829674006, 0.010155241936445236, 0.03934423252940178, -0.011777213774621487, 0.0037585466634482145, -0.006582342088222504, -0.017183789983391762, 0.011725102551281452, 0.026537815108895302, 0.001450981479138136, 0.02842685952782631, 0.03994351625442505, -0.040959689766168594, 0.020779486745595932, 0.02604275569319725, -0.0427575409412384, 0.0023124506697058678, -0.03277817368507385, 0.0041884672828018665, -0.029338812455534935, -0.016597533598542213, 0.008324822410941124, -0.028478970751166344, 0.015151438303291798, 0.017965462058782578, -0.056801605969667435, -0.019294308498501778, 0.013783509843051434, -0.0053446926176548, 4.498694033827633e-05, -0.010721954517066479, 0.021912913769483566, 0.02855713851749897, -0.008259682916104794, -0.016115501523017883, -0.012135481461882591, -0.03723371401429176, 0.006351097021251917, -0.012454664334654808, 0.012539345771074295, -0.019633032381534576, -0.024283990263938904, 0.032934509217739105, 0.035331644117832184, -0.011646934784948826, -0.02662901021540165, -0.03879706189036369, 0.061960652470588684, -0.06373244524002075, 0.022147415205836296, 0.03814566507935524, -0.004276405554264784, 0.024805106222629547, 0.011555739678442478, 0.005452172830700874, -0.0052209277637302876, 0.007341216783970594, -0.03374223783612251, 0.03345562517642975, -0.01809574104845524, 0.04812503233551979, 0.0016805980121716857, 0.023919209837913513, -0.030433155596256256, 0.018212992697954178, -0.005201385822147131, -0.010226895101368427, 0.046770129352808, 0.0016008021775633097, -0.034732360392808914, 0.01728801243007183, -0.009269344620406628, -0.01416131854057312, 0.0038139151874929667, 0.0033107129856944084, 0.042418815195560455, 0.016519365832209587, -0.03251761943101883, 0.013431756757199764, 0.027202237397432327, 0.03705132380127907, -0.013796537183225155, 0.025352276861667633, 0.02785363234579563, -0.013340560719370842, -0.02206924930214882, 0.025143830105662346, 0.01894255541265011, -0.009855600073933601, 0.043122321367263794, -0.01608944684267044, -0.0271240696310997, -0.020558012649416924, -0.01581585966050625, 0.021509049460291862, -0.02722829394042492, 0.037129491567611694, -0.014434903860092163, 0.034966859966516495, -0.009705779142677784, -0.00368689326569438, -0.025248054414987564, -0.014239485375583172, -0.0008215714478865266, 0.016832036897540092, 0.030276820063591003, 0.015802832320332527, 0.007276077289134264, 0.04080335795879364, 0.03337745741009712, -0.02688956819474697, -0.020701318979263306, -0.011601337231695652, 0.032830286771059036, 0.021157296374440193, -0.019268251955509186, -0.0010511879809200764, 0.003781345672905445, 0.004641186445951462, -0.026602955535054207, -0.013470839709043503, -0.008624464273452759, -0.005452172830700874, -0.014291597530245781, -0.051408059895038605, -0.0123569555580616, -0.02197805419564247, 0.0022603392135351896, 0.04171530902385712, -0.01464335061609745, -0.0031038951128721237, -0.024205822497606277, -0.017796099185943604, 0.008064265362918377, 0.034393634647130966, -0.025704029947519302, -0.0041884672828018665, -0.03236128389835358, -0.022368889302015305, 0.03324718028306961, -0.009555958211421967, -0.030902158468961716, -0.0033872518688440323, 0.027410684153437614, -0.0585734024643898, -0.024023432284593582, -0.03538375347852707, -0.0029947867151349783, -0.040985748171806335, 0.028505027294158936, 0.06644225120544434, -0.02819235809147358, 0.006067740730941296, 0.020075980573892593, -0.025951560586690903, -0.021860802546143532, -0.005305608734488487, 0.00603517098352313, -0.013509923592209816, 0.030016262084245682, 0.015672553330659866, -0.012565401382744312, -0.020714348182082176, -0.015516218729317188, -0.06477467715740204, 0.02316359058022499, 0.00146156654227525, -0.021991081535816193, -0.042158257216215134, -0.00045271925046108663, 0.02350231632590294, -0.01585494354367256, 0.019476698711514473, 0.02374984696507454, -0.010546077974140644, -0.025378333404660225, -0.0013646716251969337, 0.053935471922159195, -0.005588965490460396, 0.023306898772716522, -0.01446095947176218, -0.004006076604127884, 0.021743550896644592, -0.016232753172516823, -0.04828136786818504, 0.029443034902215004, 0.052502404898405075, 0.03973507136106491, 0.014135262928903103, 0.020727375522255898, -0.005595479626208544, 0.006399951875209808, -0.020453790202736855, 0.01055910624563694, -0.02205622009932995, 0.017014427110552788, 0.02709801495075226, 0.0003747554437723011, -0.0038920827209949493, -0.004950598813593388, -0.021079128608107567, 0.00330094201490283, 0.01259145699441433, 0.006194762419909239, -0.024310046806931496, 0.015346856787800789, -0.023228731006383896, -0.008292253129184246, 0.0050580790266394615, -0.032960567623376846, 0.0230463407933712, 0.036061204969882965, -0.01848657801747322, 0.014434903860092163, 0.01300834957510233, 0.02748885191977024, 0.025977615267038345, 0.032100725919008255, -0.021417854353785515, -0.025287138298153877, -0.018681997433304787, -0.010279006324708462, -0.010832691565155983, -0.024883273988962173, -0.026785345748066902, -0.04208008944988251, -0.022030165418982506, -0.024779049679636955, -0.02230375073850155, -0.011477572843432426, 0.000871240277774632, -0.04270542785525322, -0.024674827232956886, 0.0027602845802903175, -0.016350004822015762, 0.009972850792109966, -0.02242100238800049, 0.022629447281360626, -0.018538689240813255, -0.12131572514772415, -0.035331644117832184, 0.010871775448322296, 0.006937352474778891, 0.022590363398194313, -0.025130802765488625, 0.02605578303337097, -0.02328084222972393, -0.0018467037007212639, -0.03147538751363754, -0.02709801495075226, -0.013666258193552494, -0.0032797716557979584, 0.015086298808455467, 0.0287916399538517, -0.030537378042936325, -0.017209844663739204, -0.009692751802504063, 0.003966993186622858, -0.016115501523017883, -0.008591894991695881, 0.0193073358386755, 0.015542274340987206, 0.05732272192835808, -0.05114750191569328, -0.018421439453959465, 0.006188248749822378, 0.01001844834536314, -0.0006546515505760908, 0.0015397339593619108, 0.0046314154751598835, 0.009145580232143402, 0.031110605224967003, 0.03181411325931549, -0.022251639515161514, 0.015034186653792858, -0.011562254279851913, 0.003638038644567132, -0.0019948959816247225, 0.014552154578268528, 0.005823467392474413, -0.04630112648010254, 0.07306041568517685, 0.016962315887212753, 0.03322112560272217, -0.05565515160560608, -0.0023613052908331156, -0.02675928920507431, 0.016610562801361084, -0.019124945625662804, -0.00984908640384674, 0.005048308055847883, 0.019724227488040924, -0.012089883908629417, 0.01702745445072651, -0.01451307162642479, -0.002084462670609355, 0.010962970554828644, 0.042054034769535065, 0.04023012891411781, -0.0271240696310997, 0.018265103921294212, 0.06706758588552475, -0.038692839443683624, -0.04604056850075722, -0.03225706145167351, -0.01654542237520218, -0.012155023403465748, 0.009099982678890228, 0.004100529011338949, -0.015242633409798145, -0.0024704139214009047, -0.006435778457671404, -0.00480077788233757, 0.005126475356519222, 0.0005862551042810082, -0.016845064237713814, 0.02459665946662426, -0.06503523886203766, 0.011484086513519287, 0.0027423712890595198, -0.043382879346609116, 0.02041470631957054, 0.016858091577887535, -0.02064920775592327, -0.0007523607346229255, -0.015659525990486145, 0.011594823561608791, -0.0038432280998677015, 0.049141205847263336, 0.056801605969667435, 0.008175002411007881, 0.01848657801747322, -0.01835629902780056, 0.002885678084567189, 0.02066223695874214, -0.002739114221185446, -0.004784493241459131, 0.025365306064486504, 0.009373567998409271, 0.03259578347206116, 0.02302028425037861, 0.004843118600547314, -0.038588616997003555, 0.0007580604287795722, 0.011177930980920792, -0.029547259211540222, 0.013470839709043503, -0.007510579656809568, 0.008924106135964394, 0.015542274340987206, -0.02470088191330433, -0.03131905198097229, 0.00953641626983881, 0.01236346922814846, 0.005960260517895222, 0.042783595621585846, 0.00881336908787489, 0.006145908031612635, 0.0070611173287034035, 0.011718588881194592, 0.02351534366607666, -0.012676138430833817, 0.0012759191449731588, -0.02746279537677765, -0.022381918504834175, -0.002603949746116996, 0.02173052355647087, -0.009998907335102558, -0.006767989601939917, 0.009445221163332462, -0.0027619129978120327, 0.05054821819067001, 0.0048105488531291485, -0.023945264518260956, 0.032934509217739105, 0.012584943324327469, 0.005452172830700874, -0.03025076538324356, 0.022017136216163635, 0.005738786421716213, 0.006025400012731552, 0.02269458770751953, 0.014252513647079468, -0.0014558668481186032, -0.030928215011954308, -0.015802832320332527, -0.0342894122004509, 0.008383448235690594, 0.0006864070310257375, 0.018994666635990143, 0.008305281400680542, -0.0024427296593785286, -0.008898049592971802, -0.013301477767527103, 0.0063771530985832214, -0.008175002411007881, -0.02157418802380562, -0.01499510370194912, 0.016988370567560196, 0.02111821249127388, 0.0602409727871418, 0.015698609873652458, -0.00013445191143546253, 0.012799903750419617, -0.0026528043672442436, -0.03358590602874756, 0.005898377858102322, -0.01872107945382595, 0.015385939739644527, 0.0070611173287034035, -0.0655563473701477, 0.0004779607697855681, 0.02401040494441986, 0.006018885876983404, -0.005963517352938652, -0.004077730234712362, 0.017678849399089813, 0.004820319823920727, 0.013627174310386181, 0.012799903750419617, 0.017548570409417152, -0.057426948100328445, 0.020779486745595932, 0.025261081755161285, -0.036530207842588425, -0.00023857326596044004, 0.0008370420546270907, -0.002323850290849805, 0.0007100200746208429, 0.0034198216162621975, 0.028869807720184326, -0.0009306800202466547, 0.05617626756429672, -0.010096616111695766, 0.023372037336230278, -0.019867535680532455, 0.011119305156171322, 0.01883833110332489, -0.014838769100606441, -0.02111821249127388, 0.03741610422730446, 0.007679942063987255, -0.02543044462800026, -0.028036022558808327, 0.01677992381155491, -0.04119419306516647, -0.00018809018365573138, 0.0033905087038874626, -0.011054165661334991, 0.020232316106557846, -0.006100310478359461, -0.006256645079702139, 0.0006465091137215495, -0.006142650730907917, -0.07295619696378708, 0.014786656945943832, -0.004882202483713627, -0.021756578236818314, -0.01188143715262413, -0.021079128608107567, -0.035826701670885086, -0.006644224748015404, 0.004064702428877354, -0.036921046674251556, 0.00723047973588109, 0.027983911335468292, 0.006653995718806982, -0.0055010272189974785, -0.007816734723746777, 0.0005158230778761208, 0.023450205102562904, -0.00764737231656909, -0.0010634016944095492, -0.01870805211365223, -0.00868960376828909, -0.010546077974140644, -0.02101399004459381, -0.0050515648908913136, -0.023215703666210175, 0.008455101400613785, 0.01446095947176218, 0.008806854486465454, -0.0072174519300460815, -0.0029443034436553717, -0.025743113830685616, 0.0342894122004509, 0.03468024730682373, -0.04765602946281433, -0.03804144263267517, -0.04622295871376991, 0.021040044724941254, 0.03350773826241493, -0.00011440117668826133, 0.00396373588591814, 0.030302876606583595, 0.0007674242369830608, 0.05487348139286041, 0.04463355615735054, -0.003400279674679041, -0.0162197258323431, -0.01042882725596428, -0.0023124506697058678, -0.025221997871994972, 0.007048089522868395, -0.03475841507315636, 0.0276191309094429, 0.013288449496030807, -0.040751244872808456, -0.02949514612555504, -0.028114190325140953, -0.0019672117196023464, 0.012995322234928608, 0.03981323540210724, 0.029781760647892952, -0.030980326235294342, 0.01271522231400013, -0.0030436411034315825, 0.009158607572317123, 0.017848212271928787, -0.05169467255473137, -0.008051237091422081, -0.028140246868133545, -0.027879688888788223, 0.042653318494558334, 0.015490163117647171, 0.0036022120621055365, 0.005328407511115074, 0.02170446701347828, -0.02941698022186756, 0.049844712018966675, 0.02665506675839424, -0.021509049460291862, 0.0017897066427394748, -0.007321675308048725, -0.003357939189299941, -0.019398530945181847, 0.03470630198717117, -0.011601337231695652, -0.019033750519156456, -0.00687221297994256, 0.01813482493162155, 0.002509497571736574, -0.009093468077480793, 0.024779049679636955, 0.019359447062015533, -0.01091737300157547, 0.029912039637565613, -0.028244469314813614, -0.011790242046117783, 0.0025225256104022264, -0.003226031782105565, -0.028270525857806206, 0.039787180721759796, 0.022955145686864853, 0.0018678739434108138, 0.00121485092677176, -0.008806854486465454, -0.0023091938346624374, 0.01812179759144783, -0.023372037336230278, -0.020701318979263306, 0.007432412356138229, -0.02566494606435299, -0.03332534804940224, 0.026589926332235336, 0.01061773207038641, -0.01714470610022545, 0.006253388244658709, 0.02616000734269619, 0.007536635268479586, 0.02089673839509487, 0.006334812380373478, -0.012415580451488495, -0.009862113744020462, 0.030902158468961716, -0.02952120266854763, -0.0005715987645089626, -0.016128530725836754, -0.016623590141534805, -0.00716534024104476, -0.013457812368869781, -0.00639018090441823, -4.8294801672454923e-05, 0.010826177895069122, 0.0027651700656861067, 0.0182260200381279, 0.018147852271795273, 0.0034654191695153713, -0.03434152156114578, 0.07514487951993942, 0.0048789456486701965, -0.011992174200713634, 0.0008744972292333841, 0.005751814227551222, 0.01284550130367279, -0.030042318627238274, 0.006846156902611256, -0.02665506675839424, 0.015451079234480858, -0.0301204863935709, 0.04202798008918762, -0.008982731029391289, -0.007933986373245716, 0.011783728376030922, -0.01230484340339899, -0.05388335883617401, 0.014447932131588459, -0.003032241715118289, -0.020362595096230507, 0.02578219771385193, -0.005745300091803074, -0.03572247922420502, 0.035279531031847, -0.014174345880746841, -0.010311576537787914, -0.024088570848107338, 0.008728687651455402, -0.0284529160708189, -0.004755180329084396, -0.0012726621935144067, -0.005823467392474413, -0.03673865273594856, -0.014187374152243137, -0.0017099108081310987, -0.018812276422977448, -0.0722266286611557, 0.01870805211365223, 0.012200620956718922, 0.006640967912971973, 0.025508612394332886, -0.005100419744849205, -0.017613708972930908, 0.0014916935469955206, -0.010891317389905453, -0.013353588990867138, -0.004563019145280123, -0.01836932636797428, 0.008161974139511585, 0.009041356854140759, -0.009321456775069237, -0.006833129096776247, 0.03309084475040436, -0.028036022558808327, -0.0034198216162621975, 0.0022277694661170244, 0.014682433567941189, 0.02686351351439953, 0.004856146406382322, -0.015047214925289154, -0.01632394827902317, 0.008246655575931072, -0.008227113634347916, 0.01451307162642479, 0.021782634779810905, -0.01457821112126112, 0.011712074279785156, 0.019489726051688194, 0.004644443280994892, 0.035826701670885086, -0.013535979203879833, 0.012343927286565304, -0.010663329623639584, 0.008175002411007881, -5.017773946747184e-05, -0.0053446926176548, -0.0012083369074389338, 0.03671259805560112, -0.0008435560157522559, 0.03251761943101883, -0.02219952829182148, 0.00952990259975195, 0.005233955569565296, 0.021652355790138245, -0.022863950580358505, 0.03934423252940178, 0.006500917952507734, -0.004387142602354288, -0.008135918527841568, 0.02556072361767292, -0.017301039770245552, 0.010780580341815948, 0.035357698798179626, -0.003172291675582528, -0.014825740829110146, -0.03957873582839966, 0.0342894122004509, -0.027071958407759666, 0.007119742687791586, 0.02686351351439953, -0.03314295783638954, -0.03658232092857361, 0.04679618775844574, 0.002848222851753235, -0.02975570410490036, 0.00368689326569438, -0.05727061256766319, 0.002035608049482107, 0.025287138298153877, 0.012676138430833817, -0.017926378175616264, 0.0013939844211563468, 0.004322003107517958, -0.021274548023939133, -0.015620442107319832, 0.013418728485703468, -0.05654105171561241, 0.020219288766384125, -0.005719244480133057, -0.016714785248041153, 0.023476261645555496, 0.0017636507982388139, -0.016962315887212753, -0.006015629041939974, 0.015998251736164093, -0.010741496458649635, -0.009946795180439949, 0.0021040046121925116, -0.011998687870800495, 0.011699046939611435, -0.025169886648654938, 0.0013532722368836403, 0.024153711274266243, 0.0014004983240738511, 0.02616000734269619, -0.004517421592026949, -0.002929647220298648, -0.0038627698086202145, -0.024453353136777878, 0.020922794938087463, -0.003377480898052454, -0.0030794679187238216, -0.016519365832209587, -0.0036478096153587103, 0.0061784777790308, 0.020349567756056786, -0.01140591874718666, -0.003592441091313958, 0.0434349924325943, 0.0016952543519437313, 0.010585161857306957, -0.016011279076337814, -0.005957003682851791, 0.004703069105744362, 0.0047095827758312225, -0.017613708972930908, -0.004227550700306892, -0.030198652297258377, 0.047942642122507095, 0.023059368133544922, 0.021769607439637184, -0.01582888886332512, -0.01007707417011261, 0.01717076078057289, 0.024766022339463234, -0.005725758615881205, -0.0227988101541996, -0.00764737231656909, 0.003009442938491702, -0.022460084408521652, -0.013757453300058842, 0.03483658283948898, -0.0008073221542872488, -0.038093555718660355, -0.028765585273504257, -0.006044941954314709, -0.002853108337149024, 0.0005720058688893914, -0.01620669662952423, 0.009060898795723915, -0.010734982788562775, -0.03387251868844032, 0.03290845453739166, -0.015099326148629189, -0.022134387865662575, -0.0010959714418277144, 0.005370748229324818, 0.021886857226490974, 0.0007971441373229027, 0.017183789983391762, 0.013783509843051434, 0.01737920753657818, -0.0043610865250229836, -0.03728582710027695, -0.0007527678390033543, -0.0009119524038396776, -0.016232753172516823, -0.00827271118760109, -0.01278687547892332, 0.02122243493795395, 0.00965366791933775, -0.018629884347319603, -0.010090102441608906, 0.0021463450975716114, 0.011112791486084461, -0.003217889228835702, 0.00785581860691309, -0.028374748304486275, 0.004618387669324875, 0.02182171866297722, 0.0451025627553463, -0.010806635953485966, 0.009503846988081932, 0.036165427416563034, 0.016584506258368492, -0.01573769375681877, 0.006009114906191826, -0.014473987743258476, 0.005452172830700874, -0.009425679221749306, -0.01942458562552929, 0.013307991437613964, 0.01541199628263712, -0.01014221366494894, -0.05232001468539238, 0.026355424895882607, 0.0025453243870288134, -0.015164465643465519, 0.0029850157443434, -0.0006306314026005566, 0.025717057287693024, -0.022290723398327827, -0.020584069192409515, -0.0012018230045214295, 0.017574625089764595, -0.007451953832060099, 0.017079565674066544, -0.029208533465862274, -0.014890880323946476, 0.01374442595988512, -0.03512319549918175, -0.005445658694952726, 0.0004759251605719328, 0.005540111102163792, 0.011184444651007652, 0.05125172436237335, 0.008845938369631767, 0.008858966641128063, -0.02819235809147358, -0.01278036180883646, 0.010181297548115253, 0.039656903594732285, 0.02829658053815365, -0.03405490890145302, 0.005396804306656122, -0.015398968011140823, 0.018069686368107796, -0.038562558591365814, 0.049010928720235825, 0.040021684020757675, -0.026420563459396362, -0.0012734764022752643, 0.003294428111985326, 0.014057095162570477, 0.009380081668496132, 0.015503191389143467, -0.010721954517066479, -0.005810439586639404, -0.01608944684267044, -0.00458581792190671, -0.01848657801747322, -0.008057750761508942, -0.014969047158956528, -0.0036054691299796104, 0.017066538333892822, 0.025104748085141182, -0.0007617245428264141, 0.0010104757966473699, 0.026225145906209946, -0.024870244786143303, 0.038093555718660355, -0.008937133476138115, 0.01691020280122757, 0.012728250585496426, 0.005963517352938652, -0.025586780160665512, -0.0222125556319952, 0.01667570136487484, -0.019763311371207237, 0.03025076538324356, 0.005582451820373535, -0.03184016793966293, 0.012793390080332756, -0.0434349924325943, -0.023606540635228157, -0.034263353794813156, 0.0003118551685474813, -0.05701005458831787, 0.01825207658112049, 0.004572790116071701, -0.016493311151862144, 0.007523607462644577, -0.01492996420711279, -0.01977633871138096, 0.02328084222972393, 0.027202237397432327, -0.01704048179090023, 0.02593853324651718, 0.029833871871232986, 0.0037292339839041233, 0.002719572279602289, 0.003141350345686078, 0.0005479857209138572, -0.016845064237713814, -0.034602079540491104, 0.019137972965836525, -0.004729124717414379, 0.004413198214024305, -0.0019444128265604377, 0.021756578236818314, -0.03382040560245514, 0.013496896252036095, -0.0004229993501212448, 0.01654542237520218, 0.0238801259547472, -0.0037911164108663797, 0.0024655284360051155, 0.00887850858271122, -0.01689717546105385, -0.009099982678890228, 0.010839206166565418, -0.013021377846598625, -0.010285520926117897, 0.006468348205089569, 0.02003689669072628, 0.005790897645056248, 0.006312013603746891, 0.025013552978634834, 0.010402771644294262, -0.040282242000103, 0.01380956545472145, 0.009549444541335106, 0.00771251181140542, -0.03632176294922829, -0.04236670210957527, 0.017066538333892822, 0.0009005530155263841, -0.0018369327299296856, -0.02401040494441986, 0.0004474266606848687, 0.016832036897540092, 0.012682653032243252, -0.028947975486516953, -0.01726195588707924, 0.030771879479289055, -0.002722829347476363, 0.01608944684267044, -0.015320800244808197, -0.01943761482834816, -0.0017994774971157312, -0.0024476151447743177, 0.000260354281635955, 0.03147538751363754, 0.0075887469574809074, 0.03668654337525368, -0.013601118698716164, -0.00639018090441823, -0.013705342076718807, 0.003517530858516693, -0.007276077289134264, 0.0008614693651907146, 0.044451165944337845, 0.011933548375964165, 0.01278687547892332, -0.023906180635094643, -0.014109206385910511, -0.00666376668959856, -0.013900760561227798, 0.024023432284593582, 0.018160881474614143, 0.023007256910204887, -0.02158721722662449, -0.025117775425314903, -0.027254348620772362, 0.011549226008355618, 0.0054163457825779915, 0.002719572279602289, 0.016376059502363205, -0.0018076199339702725]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"(s1:t) =Zψ
t/Zψ
t−1for all partial sequences s1:t. Noting the
telescoping multiplicative cancellation and the fact that wt(si
1:t) =Zψ
t/Zψ
t−1is constant with respect to indices i∈[1, K],
we have the following estimator for a single run of an optimal SMC procedure,
ˆZSMC
σ=RY
r=11
KKX
i=1
trY
t=tr−1+1wt
si
1:t
=RY
r=1Zψ
tr
Zψ
tr−1=Zψ
tR
Zψ
t0=Zψ
T
Zψ
0=Zσ (25)
as desired, assuming Zψ
0= 1. Since ˆZSMC
σ=Zσis independent of S, we conclude ˆZSMC
σhas zero bias and zero variance.
Note that we could also define optimality in Def. A.1 using the condition that wt:t+c−1(s1:t+c−1) =const for all 1≤t≤T
and0≤c≤T−t+ 1. Following similar derivations as above would yield ˆZSMC
σ=const . As we will show in App. F,
ˆZSMC
σis unbiased with E[ˆZSMC
σ] =Zσ. We thus conclude that ˆZSMC
σ=Zσwith zero variance, and thus Prop. A.2 holds.
With this notion of optimality in mind, we demonstrate the following necessary and sufficient conditions.
Proposition A.3 (Optimality Conditions ).The following conditions are necessary and sufficient for twisted SMC optimality,
(i) : π∗
t(s1:t) =σ(s1:t) ∀1≤t≤T
(ii) : q∗
t(st|s1:t−1) =σ(st|s1:t−1) ∀1≤t≤T .(26)
Proof. (Necessary) Optimal Twisted SMC =⇒(i),(ii):We begin by writing the marginalization of the unnormalized
density ˜π∗
t+cover prefixes of length tas
˜π∗
t+c(s1:t) =X
st+1:t+c˜π∗
t+c(s1:t+c) =X
st+1:t+cp0(s1:t+c)ψt+c(s1:t+c) =p0(s1:t)X
st+1:t+cp0(st+1:t+c|s1:t)ψt+c(s1:t+c)
The normalization constant of ˜π∗
t+c(s1:t)can easily be seen to be Zψ∗
t+cafter summing over s1:tabove, which
yields π∗
t+c(s1:t) = ˜ π∗
t+c(s1:t)/Zψ∗
t+c. We now factorize the c-step incremental importance weights (at step t+ 1,
see Eq. ( c-Step SMC Weights)) using the above identities, which imply that ˜π∗
t+c(s1:t+c) =Zψ∗
t+cπ∗
t+c(s1:t+c) =
Zψ∗
t+cπ∗
t+c(s1:t)π∗
t+c(st+1:t+c|s1:t)and
wt+1:t+c(s1:t+c) =˜π∗
t+c(s1:t+c)
˜π∗
t(s1:t)q∗(st+1:t+c|s1:t)=Zψ∗
t+c
Zψ∗
tπ∗
t+c(s1:t)
π∗
t(s1:t)π∗
t+c(st+1:t+c|s1:t)
q∗(st+1:t+c|s1:t)(27)
In order to have wt+1:t+c(s1:t+c) =Zψ∗
t+c/Zψ∗
tin general, we thus require π∗
t+c(s1:t) =π∗
t(s1:t)andπ∗
t+c(st+1:t+c|s1:t)","[0.05494101718068123, -0.015562477521598339, -0.00954009685665369, 0.010055946186184883, -0.014244887977838516, 0.011920460499823093, 0.029732784256339073, -0.01842140033841133, 0.0010845257202163339, 0.018533270806074142, 0.03129897639155388, -0.01214420236647129, -0.03259170800447464, -0.00014634492981713265, 0.03691738098859787, -0.00029851647559553385, 0.018321959301829338, -0.0052330694161355495, -0.01624613255262375, 0.017091378569602966, 0.01653202436864376, -0.023853350430727005, -0.0035767594818025827, 0.02839033491909504, -0.05305164307355881, -0.01496583316475153, 0.0388813354074955, 0.001836546347476542, 0.0395774208009243, -0.0236420389264822, 0.014742091298103333, -0.024101952090859413, -0.00764450803399086, -0.06866384297609329, -0.01830952800810337, 0.09153521060943604, -0.011093858629465103, 0.01546303741633892, -0.021180881187319756, 0.030975794419646263, 0.02535739168524742, -0.003050034400075674, -0.038781892508268356, 0.01659417524933815, 0.03515230491757393, 0.0007687236065976322, -0.007967690005898476, -0.00885644182562828, 0.0009314802009612322, 0.02826603315770626, -0.026699842885136604, 0.04392795264720917, 0.016693616285920143, -0.049148593097925186, -0.03502800688147545, 0.01694221794605255, -0.0027998785953968763, -0.0013447807868942618, 0.035052865743637085, -0.022150427103042603, 0.045842185616493225, -0.00417651142925024, 0.012069621123373508, -0.032740868628025055, -0.016382863745093346, -0.027047885581851006, 0.012467384338378906, 0.0590180866420269, -0.04621509090065956, 0.030478591099381447, -0.05489129573106766, 0.018036065623164177, 0.052902478724718094, 0.013064028695225716, -0.022448750212788582, 0.008732140995562077, 0.03271600604057312, 0.038856472820043564, 0.05518961697816849, -0.03679307922720909, 0.0020027989521622658, -0.014617790468037128, 0.027868270874023438, -0.017215680330991745, -0.03105037473142147, -0.027594808489084244, -0.02844005450606346, -0.013374781236052513, -0.05056562274694443, 0.014779381453990936, -0.012977018021047115, 0.03045373037457466, -0.00628341268748045, 0.023095114156603813, 0.06647614389657974, -0.00045564063475467265, 0.02749536745250225, 0.029832225292921066, 0.013225619681179523, -0.01719081960618496, 0.04534498229622841, -0.05151031166315079, 0.007116228807717562, -0.03129897639155388, 0.029359882697463036, -0.014978263527154922, 0.00036843575071543455, 0.02098199911415577, -0.03637045621871948, -0.006149788852781057, 0.02560599334537983, -0.006761971395462751, -0.03574895113706589, 0.03373527526855469, 0.03331265226006508, -0.03159729763865471, -0.06786831468343735, 0.0005912063643336296, -0.027172185480594635, 0.025879455730319023, 0.01635800302028656, -0.010888762772083282, 0.0258297361433506, -0.021777525544166565, -0.006165326572954655, -0.03296460956335068, 0.022908663377165794, -0.06756999343633652, -0.024611586704850197, 0.0035115014761686325, 0.03669363632798195, 0.009832204319536686, -0.004244877025485039, -0.010981988161802292, 0.02471102774143219, 0.0025233090855181217, 0.011149794794619083, 0.016880067065358162, 0.012492244131863117, 0.007358615752309561, -0.006261659786105156, 0.005963337607681751, -0.024014942348003387, 0.02239902876317501, -0.028464915230870247, 0.002293352270498872, -0.04812932386994362, 0.018707292154431343, -0.03495342284440994, 0.008123066276311874, -0.022299589589238167, -0.012865147553384304, -0.011678073555231094, 0.006013058125972748, 0.004807339049875736, -0.045295264571905136, -0.00718459440395236, 0.0425606407225132, 0.022622771561145782, -0.012442524544894695, -0.004577382002025843, 0.03527660667896271, -0.01926664635539055, -0.015724068507552147, 0.04574274644255638, 0.017352411523461342, -0.028290893882513046, 0.01624613255262375, -0.04094472900032997, -0.06597893685102463, 0.025755155831575394, -0.049098871648311615, -0.07502804696559906, -0.05951528996229172, 0.027843410149216652, 0.003037604270502925, -0.029608484357595444, -0.07875707745552063, -0.013474222272634506, 0.023505307734012604, 0.02305782400071621, 0.039627138525247574, 0.028763238340616226, 0.0009462409070692956, 0.001639218651689589, 0.004453081171959639, 0.004555629566311836, 0.00847732461988926, 0.0243008341640234, -0.03435678035020828, -0.031970202922821045, 0.02500934898853302, 0.029235580936074257, -0.029185861349105835, -0.058769483119249344, -0.023840920999646187, 0.025208231061697006, 0.07990064471960068, 0.02453700639307499, 0.02293352410197258, 0.03400873765349388, -0.006171541754156351, 0.016109401360154152, 0.0026584863662719727, -0.03142327815294266, -0.0008475770591758192, -0.013014308176934719, 0.019763849675655365, -0.057327594608068466, -0.00874457135796547, -0.004294597543776035, -0.021640794351696968, 0.053847167640924454, 0.028241174295544624, -0.011789944022893906, 0.040497247129678726, -0.07751406729221344, 0.02203855663537979, -0.055686820298433304, 0.05613430589437485, 0.010745815932750702, 0.04201371967792511, 0.01967683807015419, 0.0006661753286607563, -0.01802363619208336, 0.015848370268940926, 0.0017821647925302386, -0.02655068039894104, -0.0017604121239855886, -0.0476321205496788, 0.05195779353380203, 0.032392825931310654, -0.009105043485760689, -0.01944066770374775, -0.012249858118593693, -0.023865779861807823, -0.019005613401532173, 0.011044139042496681, -0.023269135504961014, -0.061305224895477295, 0.006152896676212549, 0.015351166017353535, 0.005441273562610149, -0.012498459778726101, -0.000305119960103184, 0.006376638077199459, -0.017439421266317368, -0.018085787072777748, -0.055786263197660446, -0.020372923463582993, 0.004819768946617842, -0.006513369269669056, -0.009291495196521282, 0.018110647797584534, -0.057625915855169296, 0.016084542497992516, -0.009502806700766087, 0.00314947497099638, 0.00986949447542429, 0.03714112192392349, -0.028241174295544624, -0.03681793808937073, -0.041988857090473175, -0.005957122426480055, -0.004782478790730238, 0.0123244384303689, 0.006923562381416559, -0.026998164132237434, 0.06896216422319412, -0.005525176879018545, -0.0012352406047284603, 0.023256706073880196, 0.007197024300694466, 0.054145488888025284, -0.00797390565276146, -0.0352020263671875, -0.03649475798010826, 0.045195821672677994, -0.060658857226371765, 0.030254848301410675, -0.02151649259030819, -0.044723477214574814, 0.04077070951461792, 0.03134869784116745, 0.028340615332126617, -0.03472968190908432, -0.003673092694953084, 0.07696714252233505, 0.01879430189728737, -0.08676205575466156, 0.013735254295170307, -0.021491631865501404, 0.008129281923174858, 0.037016820162534714, -0.004850844386965036, 0.0003527039079926908, -0.022647632285952568, 0.0036389101296663284, -0.0063113803043961525, 0.008533259853720665, 0.0707520991563797, 0.009950290434062481, 0.00835302285850048, 0.007110013626515865, 0.011777514591813087, -0.008495969697833061, 0.02697330340743065, -0.01849598065018654, -0.029583623632788658, 0.0023555029183626175, -0.027942851185798645, 0.003057803027331829, -0.023256706073880196, 0.012541964650154114, 0.014257318340241909, -0.028489775955677032, 0.02192668616771698, -0.05777507647871971, 0.00607520854100585, -0.044773198664188385, -0.00768801337108016, 0.0030236204620450735, -0.010049731470644474, -0.024213822558522224, 0.02453700639307499, -0.019813569262623787, -0.045121241360902786, -0.013859555125236511, -0.0008576764957979321, -0.015674348920583725, 0.015388456173241138, -0.006749541033059359, 0.06866384297609329, 0.011721578426659107, -0.033039189875125885, -0.029111281037330627, -0.024934768676757812, 0.04283410310745239, -0.0005080801201984286, 0.041168469935655594, -0.054841574281454086, -0.004092608578503132, -0.012473599053919315, -0.03726542368531227, 0.04445001482963562, -0.0019763850141316652, 0.018943462520837784, 0.05215667560696602, 0.0781107097864151, 0.037066541612148285, 0.01701679825782776, -0.010136742144823074, 0.05837172269821167, 0.003623372409492731, 0.005546929314732552, -0.024624016135931015, -0.011448116973042488, -0.01730269007384777, -0.04730893671512604, -0.02050965465605259, 0.008974527940154076, 0.005891864653676748, 0.04882540926337242, 0.01748914271593094, 0.013623382896184921, 0.04865138977766037, -0.008558119647204876, 0.021379761397838593, -0.025456832721829414, 0.011808589100837708, -0.012815427035093307, 0.008738355711102486, 0.02115602046251297, 0.0018598528113216162, -0.036171574145555496, -0.014953402802348137, -0.03455566242337227, 0.02744564786553383, 0.04176511615514755, -0.011267879977822304, 0.004105038475245237, -0.009229345247149467, 0.021553782746195793, -0.02590431645512581, 0.03219394385814667, 0.005021757911890745, -0.008949668146669865, -0.00398695282638073, -0.010217537172138691, -0.00659416476264596, -0.01701679825782776, 0.00015518195868935436, -0.017762605100870132, 0.02387821115553379, -0.021789954975247383, -0.020484795793890953, -0.00945308618247509, 0.04206343740224838, 0.03323807194828987, 0.050341881811618805, -0.006084531079977751, 0.0021970190573483706, -0.055786263197660446, -0.01996273174881935, -0.04611564800143242, -0.011491621844470501, -0.01683034747838974, 0.04072098806500435, 0.009105043485760689, 0.09765081852674484, 0.052305836230516434, -0.02667498216032982, 0.027569947764277458, -0.005599757190793753, 0.00986949447542429, -0.033213213086128235, -0.010323192924261093, 0.020994428545236588, 0.03293975070118904, 0.04226231947541237, 0.004574274644255638, -0.022125568240880966, 0.005652585066854954, -0.011665643192827702, -0.018632711842656136, -0.005801746621727943, 0.0011505605652928352, -0.055139895528554916, 0.009651968255639076, -0.03898077458143234, 0.023219415917992592, 0.035823531448841095, 0.030055968090891838, -0.012548180297017097, -0.04452459514141083, 0.02595403604209423, 0.01972655951976776, -0.022834083065390587, 0.01063394546508789, -0.05305164307355881, -0.012119341641664505, 0.032392825931310654, -0.015351166017353535, 0.011802374385297298, 0.03015540912747383, 0.003642017487436533, 0.0005943138967268169, -0.029111281037330627, 0.009707903489470482, 0.010198892094194889, -0.005705413408577442, -0.017265399917960167, 0.04390309378504753, -0.043256726115942, -0.02761966921389103, -0.026227498427033424, 0.05931640788912773, -0.014021146111190319, 0.013623382896184921, -0.022386599332094193, 0.020360494032502174, -0.005497209262102842, 0.012454953975975513, -0.0035550068132579327, 1.990757300518453e-05, 0.030901214107871056, 0.03189562261104584, -0.013064028695225716, -0.0015211327699944377, 0.05001869797706604, 0.0019670624751597643, -0.0751274898648262, 0.050590481609106064, 0.009589817374944687, -0.0036917380057275295, 0.0022731535136699677, 0.07970176637172699, -0.008862657472491264, 0.020646385848522186, -0.03833441063761711, 0.034108176827430725, -0.04686145484447479, 0.025804875418543816, 0.03773776441812515, 0.028812957927584648, 0.03418275713920593, 0.061603546142578125, -0.018893742933869362, 0.004064640961587429, 0.016084542497992516, 0.018582990393042564, -0.025394681841135025, 0.003694845363497734, -0.012765706516802311, 0.022846512496471405, -0.05006841942667961, 0.0042666299268603325, 0.008893731981515884, -0.06329403817653656, -0.010882547125220299, 0.025755155831575394, 0.014916112646460533, -0.021665653213858604, 0.041988857090473175, 0.02637665905058384, 0.016146691516041756, 0.033213213086128235, -0.00645743403583765, 0.022411460056900978, 0.0358981117606163, -0.026625260710716248, 0.009583602659404278, 0.004008705262094736, -0.008284657262265682, -0.005024865735322237, 0.0068303365260362625, -0.02980736643075943, -0.020298343151807785, -0.014095726422965527, 0.0018660678761079907, 0.003551899455487728, -0.010335623286664486, -0.02714732475578785, -0.0051553817465901375, 0.0010254827793687582, -0.027818551287055016, 0.018321959301829338, -0.09919214993715286, -0.03863273188471794, -0.036246154457330704, 0.0013276893878355622, -0.008042271248996258, -0.0037197056226432323, 0.004922317340970039, 0.009459301829338074, 0.02258548140525818, -0.041566234081983566, 0.001953078550286591, -0.025506552308797836, -0.023604748770594597, -0.022834083065390587, -0.05185835063457489, -0.00835302285850048, -0.002506217686459422, -0.008309517987072468, -0.051062826067209244, 0.008315732702612877, -0.014766952022910118, -0.0069484226405620575, -0.0010060607455670834, -0.029359882697463036, -0.02174023538827896, 0.016134262084960938, 0.003165012691169977, -0.029235580936074257, 0.004530769307166338, 0.000757070432882756, 0.006824121810495853, 0.012137986719608307, 0.007874464616179466, 0.025220660492777824, -0.0034307059831917286, 0.01582350954413414, 0.0025015564169734716, -0.027097605168819427, 0.033039189875125885, 0.016308283433318138, 0.01191424485296011, 0.012852717190980911, 0.042336899787187576, -0.015736499801278114, 0.006904917303472757, 0.03592297062277794, -0.05807339772582054, -0.021889396011829376, -0.028315754607319832, -0.006308272946625948, -0.029732784256339073, -0.04149165377020836, -0.006780616473406553, -0.03164701908826828, -0.0033654479775577784, 0.016034821048378944, -0.03597269207239151, -0.03716598078608513, 0.029583623632788658, -0.02334371581673622, 0.01368553377687931, 0.002440959680825472, 0.02968306466937065, 0.009757624007761478, -0.02003731206059456, -0.01956496760249138, 0.0015063720056787133, -0.02471102774143219, 0.02428840473294258, -0.023542597889900208, 0.03525174781680107, -0.006336240563541651, -0.02187696471810341, 0.02921072021126747, 0.03383471444249153, 0.011752653867006302, -0.02055937610566616, -0.05528905987739563, 0.05078936368227005, -0.04877568781375885, 0.03326293081045151, 0.041392214596271515, 0.012573040090501308, 0.030080826953053474, 0.004067748319357634, 0.0021348686423152685, 0.021118730306625366, 0.017650732770562172, -0.016519594937562943, 0.02150406315922737, -0.014095726422965527, 0.04084528982639313, -0.0011202621972188354, 0.009558741934597492, -0.004937855061143637, 0.021653223782777786, 0.0031914266292005777, -0.026824142783880234, 0.014679941348731518, -0.0018940356094390154, -0.022237438708543777, 0.049695517867803574, -0.019129915162920952, -0.008931022137403488, 0.014791811816394329, 0.0037725334987044334, 0.01670604571700096, 0.009919214993715286, -0.02033563330769539, 0.010049731470644474, 0.025021780282258987, 0.0355500690639019, -0.02033563330769539, 0.023840920999646187, -0.0007834843709133565, -0.018446259200572968, -0.03271600604057312, 0.006252337247133255, 0.00874457135796547, -0.01753886230289936, 0.049919258803129196, -0.031796179711818695, -0.040273506194353104, -0.023741479963064194, -0.007197024300694466, 0.04266008362174034, -0.009527667425572872, 0.03898077458143234, -0.011709148995578289, 0.017911765724420547, 0.004042888060212135, -0.02873837761580944, -0.034928563982248306, -0.011777514591813087, -0.024077091366052628, 0.002953701186925173, 0.026525821536779404, 0.0243008341640234, 0.01867000199854374, 0.03448108211159706, 0.033163491636514664, -0.012778136879205704, -0.0017728421371430159, 0.015189575031399727, 0.017911765724420547, 0.00909261405467987, -0.01027968805283308, 0.006898702122271061, 0.009583602659404278, 0.0037880712188780308, -0.021939115598797798, -0.01505284383893013, -0.008707281202077866, -0.006476079113781452, -0.00850218441337347, -0.024039801210165024, 0.0034897488076239824, -0.017799895256757736, -0.012473599053919315, 0.0043909307569265366, -0.009353646077215672, -0.026451239362359047, -0.021852105855941772, -0.020882558077573776, 0.010428848676383495, 0.02791799046099186, -0.037961509078741074, 0.009111259132623672, -0.023206986486911774, -0.03405845910310745, 0.016445014625787735, 0.013697963207960129, -0.019092625007033348, -0.0033343727700412273, 0.01717839017510414, -0.03619643300771713, -0.01830952800810337, -0.05126170814037323, -0.031249256804585457, -0.043654490262269974, 0.020136753097176552, 0.04611564800143242, -0.0502673014998436, 0.0044624037109315395, 0.016631465405225754, -0.030205128714442253, -0.02590431645512581, -0.011591062881052494, -0.003654447617009282, -0.0014030468882992864, -0.009446871466934681, 0.02642638050019741, 0.0007535744807682931, -0.01342450175434351, -0.000918273173738271, -0.08278442919254303, 0.03619643300771713, -0.013064028695225716, -0.017054088413715363, -0.04715977609157562, 0.016755767166614532, 0.011193299666047096, 0.017849614843726158, 0.007116228807717562, 0.015748929232358932, -0.007967690005898476, 0.010000010952353477, -0.012647620402276516, 0.04934747517108917, -0.006581734865903854, 0.014269747771322727, -0.011087643913924694, -0.014307037927210331, 0.017377272248268127, -0.017799895256757736, -0.04919831082224846, 0.010093236342072487, 0.03930395841598511, 0.022858943790197372, -7.22013646736741e-05, 0.02963334508240223, -0.023990081623196602, 0.02689872309565544, -0.016159122809767723, 0.009080183692276478, -0.019639547914266586, 0.007551282178610563, 0.018048496916890144, -0.0037228132132440805, 0.002120884833857417, -0.021255461499094963, -0.021665653213858604, 0.031249256804585457, -0.0243008341640234, -0.014319468289613724, -0.02134247124195099, 0.01719081960618496, -0.017998775467276573, 0.011124934069812298, 0.0013541033258661628, -0.04094472900032997, 0.02282165363430977, 0.029558762907981873, -0.022200148552656174, 0.016308283433318138, -0.004422006197273731, 0.009552527219057083, 0.018060926347970963, 0.03480426222085953, -0.008931022137403488, -0.07816043496131897, -0.02749536745250225, -0.029608484357595444, 0.011789944022893906, -0.003321942640468478, 0.007930399850010872, -0.030329428613185883, -0.01849598065018654, -0.009738978929817677, -0.0031556901521980762, 0.024313263595104218, 0.005428843665868044, -0.026799282059073448, -0.006003735587000847, -0.004260414745658636, -0.01217527687549591, 0.00526103749871254, -0.01137975137680769, 0.022560620680451393, -0.0069484226405620575, -0.10958370566368103, -0.01113736443221569, 0.01078932173550129, 0.0011311385314911604, 0.0010472354479134083, -0.01241766382008791, 0.014070866629481316, -0.016569314524531364, 0.02791799046099186, -0.01344936154782772, -0.041864555329084396, 0.003039157949388027, -0.02239902876317501, 0.02672470174729824, 0.025257950648665428, -0.016395293176174164, -0.02126789093017578, -0.011255450546741486, -0.0026025508996099234, -0.03358611464500427, -0.011460546404123306, 0.03336237370967865, 0.005720950663089752, 0.02304539456963539, -0.033163491636514664, -0.017029229551553726, 0.007371045649051666, 0.017141100019216537, -0.005919832270592451, -0.0021954653784632683, 0.003747673472389579, 0.020410213619470596, 0.030080826953053474, 0.03572408854961395, 0.00423866230994463, 0.00577999372035265, 0.01413301657885313, -0.008396528661251068, -0.01197018101811409, 0.010621515102684498, -0.026152918115258217, -0.037489164620637894, 0.04972037672996521, 0.020633956417441368, 0.016146691516041756, -0.07502804696559906, 0.002953701186925173, -0.024275973439216614, 0.01700436882674694, -0.00705407839268446, 0.002810755046084523, -0.009216914884746075, -0.009875710122287273, -0.009738978929817677, 0.010509644635021687, -0.01783718541264534, -0.030553171411156654, 0.022125568240880966, 0.0412430539727211, 0.03669363632798195, -0.034530799835920334, 0.024822898209095, 0.07746434956789017, -0.03758860379457474, -0.019415806978940964, -0.03865759074687958, -0.013747683726251125, 0.01635800302028656, 0.012343083508312702, 0.012802996672689915, 0.01985085941851139, -0.00543505884706974, -0.02689872309565544, -0.019950300455093384, -0.003185211680829525, -0.0003008471103385091, -0.05001869797706604, 0.011187084950506687, -0.07000628858804703, 0.012647620402276516, 0.01694221794605255, -0.010229967534542084, 0.015599767677485943, 0.00411746883764863, -0.013561232946813107, -0.028290893882513046, -0.011373535729944706, 0.012075836770236492, -0.005950907710939646, 0.04390309378504753, 0.025257950648665428, 0.00040863934555090964, 0.03845871239900589, -0.010702311061322689, 0.009372291155159473, 8.220371091738343e-05, -0.015388456173241138, -0.02518337033689022, 0.027395926415920258, 0.011311385780572891, 0.04795530438423157, 0.030130548402667046, 0.006056563463062048, -0.025220660492777824, 0.005515854340046644, -0.0012251411098986864, -0.05404604971408844, 0.013163469731807709, 0.010379128158092499, 0.004875704180449247, 0.0013346814084798098, -0.035699229687452316, -0.035997550934553146, 0.011727794073522091, 0.02282165363430977, 0.003996275365352631, 0.015040413476526737, -0.0018567453371360898, 0.020435074344277382, -0.0007737733540125191, 0.004515231586992741, 0.021006859838962555, 0.02293352410197258, 0.00237880926579237, -0.03567437082529068, -0.03472968190908432, -0.008197646588087082, 0.022647632285952568, -0.018408969044685364, -0.009825989603996277, 0.002161282580345869, 0.03117467649281025, 0.03010568767786026, -0.004885027185082436, -0.014891252852976322, 0.03622129559516907, 0.00031230610329657793, -0.01730269007384777, -0.049919258803129196, -0.0036824154667556286, -0.022386599332094193, -0.015736499801278114, 0.022945953533053398, 0.017402131110429764, 0.004555629566311836, -0.02766938880085945, -0.01736484095454216, -0.019540108740329742, -0.0007306564948521554, 0.020459935069084167, 0.008471108973026276, 0.0011761976638808846, 0.00962710753083229, 0.002481357427313924, -0.014667510986328125, -0.017265399917960167, -0.01741456240415573, -0.004735865630209446, -0.017103809863328934, 0.004108146298676729, 0.013014308176934719, 0.05489129573106766, 0.01997516117990017, 0.0008382544619962573, 0.00231821252964437, -0.00019548265845514834, -0.021901825442910194, -0.002172159031033516, 0.031622160226106644, 0.005913617089390755, 0.009105043485760689, -0.05553765967488289, -0.012535749934613705, 0.009919214993715286, 0.027992572635412216, -0.010273472405970097, -0.0008553458610549569, 0.012989448383450508, 0.0046519627794623375, 0.006053455639630556, 0.023244276642799377, 0.030503449961543083, -0.03527660667896271, 0.04022378474473953, 0.023256706073880196, -0.023741479963064194, 0.019154775887727737, -0.015500327572226524, -0.0021348686423152685, 0.00020043527183588594, 0.016047252342104912, 0.019950300455093384, -0.0012655389728024602, 0.061006899923086166, 0.006643885280936956, 0.016569314524531364, -0.016805486753582954, 0.013026738539338112, 0.007507776841521263, -0.013847124762833118, -0.028539495542645454, 0.058471161872148514, 0.011702933348715305, -0.03559979051351547, 0.007868249900639057, 0.03898077458143234, -0.02993166632950306, -0.002057180507108569, -0.021417051553726196, -0.0436047688126564, 0.01659417524933815, -0.010180247016251087, -0.018060926347970963, 0.0006351001211442053, -0.0034928563982248306, -0.03684280067682266, 0.02749536745250225, 0.0011311385314911604, -0.023194555193185806, -0.010739601217210293, -0.009819773957133293, -0.021143589168787003, -0.021789954975247383, 0.03100065514445305, -0.04367934912443161, -0.008154141716659069, -0.0037290281616151333, 0.011659428477287292, -0.007961475290358067, -0.014083296991884708, -0.00041835036245174706, 0.02441270463168621, -0.01659417524933815, 0.0001389645622111857, -0.029732784256339073, -0.007426981348544359, -0.018085787072777748, 0.006730895955115557, 0.0010876331944018602, -0.011808589100837708, 0.007352400571107864, -0.007377260830253363, -0.005699198227375746, 0.017327550798654556, 0.0036575552076101303, 0.0037569960113614798, 0.02660040184855461, 0.026003757491707802, -0.018682431429624557, -0.04077070951461792, -0.046662572771310806, 0.0254816934466362, 0.046264808624982834, -0.025344962254166603, 0.010627730749547482, 0.0516594722867012, -0.005161596462130547, 0.03502800688147545, 0.03204478323459625, -0.006556874606758356, -0.020845267921686172, -0.02839033491909504, 0.009726548567414284, -0.01931636594235897, -0.005885649472475052, -0.03729028254747391, 0.010229967534542084, 0.02732134610414505, -0.04397767409682274, -0.015152284875512123, -0.004701683297753334, -0.004791801329702139, -0.006619025021791458, 0.030901214107871056, 0.014866392128169537, -0.025083929300308228, -0.00038746933569200337, -0.02044750563800335, -0.00951523706316948, -0.019813569262623787, -0.04248606041073799, 0.011124934069812298, -0.026575541123747826, -0.008365453220903873, 0.04591676592826843, -0.01659417524933815, 0.01600996032357216, 0.01487882249057293, 0.0251336507499218, -0.012423879466950893, 0.029285302385687828, 0.001096955849789083, -0.006218154449015856, 0.014704801142215729, 0.017141100019216537, 0.0016205734573304653, -0.016730906441807747, 0.0352020263671875, -0.00782474409788847, -0.008110636845231056, -0.008160356432199478, 0.019602257758378983, -0.021640794351696968, -0.04270980507135391, 0.016631465405225754, 0.039080217480659485, -0.01259789988398552, 0.03413303941488266, -0.031100096181035042, -0.0318707600235939, -0.0016889390535652637, -0.012840286828577518, -0.017998775467276573, 0.034331921488046646, 0.03644503653049469, -0.014431338757276535, -0.009583602659404278, -0.015487897209823132, -0.015214434824883938, 0.02026105299592018, -0.013225619681179523, -0.021491631865501404, 0.019179634749889374, -0.009832204319536686, -0.05379744619131088, 0.027047885581851006, 0.005646370351314545, -0.011802374385297298, 0.014704801142215729, 0.02655068039894104, 0.0003552287817001343, 0.016159122809767723, 0.022535759955644608, -0.017203250899910927, 0.0024580510798841715, 0.060410257428884506, -0.024673737585544586, -0.010994418524205685, -0.016855208203196526, -0.00026685858028940856, -0.006152896676212549, -0.0032504696864634752, -0.0037383507005870342, 0.006208831910043955, -0.006476079113781452, -0.006730895955115557, -0.0028340613935142756, 0.02305782400071621, -0.007041648495942354, -0.029533904045820236, 0.07353643327951431, -0.0023228737991303205, -0.006532014347612858, 0.016693616285920143, 0.01164078339934349, -0.008527044206857681, -0.021479202434420586, -0.002557491883635521, -0.02744564786553383, 0.014791811816394329, -0.02844005450606346, 0.017700454220175743, -0.004987575113773346, -0.009981365874409676, 0.0029039806686341763, -0.0037973937578499317, -0.05285276100039482, 0.02227472886443138, -0.009198269806802273, -0.02963334508240223, 0.01849598065018654, -0.02672470174729824, -0.03234310448169708, 0.0365196168422699, 0.008800506591796875, -0.0059167249128222466, -0.011162224225699902, 0.013523942790925503, -0.04191427677869797, 0.004925424698740244, 0.013461791910231113, -0.013946565799415112, -0.03201992064714432, -0.037414584308862686, -0.00403045816347003, -0.014443769119679928, -0.07637050002813339, 0.005149166565388441, 0.016270993277430534, -0.003924802411347628, 0.00655065942555666, -0.013163469731807709, -0.006476079113781452, 0.0027066529728472233, -0.0043909307569265366, -0.009888139553368092, -0.023020533844828606, -0.004788693971931934, 0.008495969697833061, -0.015674348920583725, 0.004558736924082041, -0.005118091125041246, 0.033983878791332245, -0.03716598078608513, -0.01996273174881935, 0.017675593495368958, 0.015686778351664543, 0.00413300609216094, -0.0034462434705346823, -0.022486040368676186, -0.027122465893626213, 0.006911132484674454, -0.0011761976638808846, 0.011491621844470501, 0.024101952090859413, -0.011802374385297298, 0.006917347200214863, 0.02293352410197258, -0.01318832952529192, 0.04236176237463951, -0.010981988161802292, -0.0017588583286851645, -0.00263051874935627, 0.012554395012557507, -0.006003735587000847, -0.006376638077199459, -0.004599134903401136, 0.03234310448169708, -0.0021876965183764696, 0.02068367600440979, -0.0009695473127067089, -0.008999387733638287, -0.0071535189636051655, 0.0029940989334136248, -0.006463648751378059, 0.0338844358921051, 0.00800498016178608, 0.0002691892150323838, 0.001889374339953065, 0.012927297502756119, -0.023865779861807823, 0.022436318919062614, 0.02637665905058384, -0.027843410149216652, -0.015313875861465931, -0.03251712769269943, 0.028887538239359856, -0.023318856954574585, -0.004627102520316839, 0.030006246641278267, 0.0023834705352783203, -0.0355500690639019, 0.03738972172141075, 0.010006225667893887, -0.04989439621567726, -0.0001202223138534464, -0.0633934810757637, 0.006631455384194851, 0.023517737165093422, 0.005941585171967745, -0.029707925394177437, -0.016569314524531364, 0.02115602046251297, -0.017812324687838554, -0.010540720075368881, -0.022088278084993362, -0.052057232707738876, 0.011634567752480507, 0.014431338757276535, -0.011995040811598301, 0.042287178337574005, -0.014742091298103333, -0.005761348642408848, 0.0013704178854823112, -0.003079555695876479, 0.002389685483649373, -0.01087633240967989, 0.0021224385127425194, -0.017352411523461342, 0.013809834606945515, -0.00705407839268446, 0.004344318062067032, 0.010857687331736088, -0.0007660045521333814, 0.013909275643527508, 0.009950290434062481, -0.01413301657885313, 0.001765073393471539, -0.028837818652391434, -0.011305170133709908, 0.0005570235662162304, -0.0005236177239567041, -0.011727794073522091, -0.018147937953472137, -0.010658805258572102, 0.01395899523049593, -0.010590440593659878, -0.0034804262686520815, 0.022113136947155, 0.010453709401190281, 0.0066873906180262566, 0.024313263595104218, -0.0077812387607991695, 0.016333144158124924, -0.007035433314740658, -0.027893131598830223, -0.0018303313991054893, -0.004773156251758337, 0.04106903076171875, 0.018694860860705376, 0.019092625007033348, -0.014804242178797722, 0.00120028096716851, 0.023331286385655403, 0.02891239896416664, -0.006848981603980064, -0.010391558520495892, -0.009645752608776093, -0.006041025742888451, -0.014058436267077923, -0.016308283433318138, 0.032392825931310654, 0.01778746396303177, -0.01777503453195095, -0.028812957927584648, -0.0021970190573483706, -0.0017153529915958643, -0.0232939962297678, 0.00040553181315772235, -0.01342450175434351, 0.006674960721284151, -0.01783718541264534, 0.0018753904150798917, -0.002622749889269471, -0.005935369990766048, -0.014356758445501328, 0.010186461731791496, 0.024027371779084206, -0.00357054453343153, 0.016855208203196526, -0.0013183668488636613, 0.020049741491675377, 0.008042271248996258, -0.021255461499094963, -0.0028744591400027275, -0.0018210087437182665, 0.0009633323061279953, -0.044052254408597946, -0.01410815678536892, 0.025208231061697006, 0.029011840000748634, -0.028241174295544624, -0.010111881420016289, -0.0012181492056697607, 0.011852094903588295, -0.011236805468797684, 0.025581134483218193, -0.008986958302557468, -0.00020198902348056436, 0.038185250014066696, 0.062498513609170914, -0.008446249179542065, -0.021317610517144203, 0.027818551287055016, -0.010329408571124077, 0.01419516745954752, -0.004185833968222141, 0.010211322456598282, 0.021479202434420586, 0.011274095624685287, -0.018110647797584534, -0.007924185134470463, 0.006718466058373451, 0.00018946181808132678, -0.053300242871046066, -0.0002909418835770339, -0.02316969446837902, -0.013001878745853901, 0.004307027440518141, 0.00467993039637804, 0.013847124762833118, -0.009173409081995487, 0.0010379129089415073, -0.004711005836725235, 0.01629585400223732, -0.015003123320639133, 0.030130548402667046, -0.03627101331949234, -0.036171574145555496, -0.012256072834134102, -0.016258563846349716, -0.0113176004961133, 0.007638292852789164, -0.005553144495934248, 0.020074602216482162, 0.02868865802884102, 0.017501572147011757, -0.018272237852215767, -0.04362963140010834, -0.008732140995562077, 0.017911765724420547, 0.013921705074608326, 0.016146691516041756, -0.026923583820462227, 0.011211944743990898, -0.0037507808301597834, 0.03216908499598503, -0.04052210599184036, 0.0509633868932724, 0.035102587193250656, -0.003256684634834528, -0.004524554125964642, 0.007023002952337265, 0.02121817134320736, -0.030602890998125076, 0.021466773003339767, -0.011180869303643703, -0.0231199748814106, -0.02839033491909504, -0.0033840930555015802, -0.03383471444249153, 0.002036981750279665, -0.020994428545236588, -0.007165949326008558, 0.022386599332094193, -0.0014077081577852368, -0.020099462941288948, 0.011578632518649101, 0.012865147553384304, 0.00034940216573886573, 0.032144222408533096, 0.00044010303099639714, -0.01867000199854374, 0.017750173807144165, 0.02115602046251297, -0.008806721307337284, -0.014717231504619122, 0.022796792909502983, -0.009726548567414284, 0.014431338757276535, 0.025630854070186615, -0.034754544496536255, -0.007625862490385771, -0.02595403604209423, -0.024524575099349022, -0.05006841942667961, -0.01259168516844511, -0.028017431497573853, 0.03666877746582031, 0.02796771191060543, -0.005574897397309542, 0.024077091366052628, -0.016146691516041756, -0.01563705876469612, 0.014617790468037128, -0.017054088413715363, -0.033934157341718674, 0.029558762907981873, 0.024561865255236626, -0.00033930272911675274, 0.02423868328332901, 0.01259168516844511, -0.004968930035829544, -0.0224611796438694, -0.010198892094194889, 0.009919214993715286, 0.00488813454285264, 0.016333144158124924, -0.0030205128714442253, 0.043530188500881195, -0.010410203598439693, 0.018632711842656136, 0.006904917303472757, 0.02233687974512577, 0.02328156679868698, -0.002442513592541218, -0.007961475290358067, -0.0013556571211665869, -0.006081423722207546, -0.024810466915369034, -0.00400249008089304, -0.023542597889900208, 0.0002579244610387832, 0.030055968090891838, 0.029260441660881042, 0.017613442614674568, 0.011870739981532097, 0.01855812966823578, 0.015500327572226524, -0.019366087391972542, 0.026699842885136604, -0.0011870739981532097, 0.01778746396303177, -0.027047885581851006, -0.04144193232059479, 0.027172185480594635, 0.006096960976719856, 0.0026243035681545734, -0.013474222272634506, 0.016096971929073334, 0.0021566213108599186, 0.008968313224613667, -0.03289002925157547, -0.022150427103042603, 0.01197018101811409, -0.005136736202985048, 0.04320700839161873, -0.01528901606798172, -0.0033032975625246763, -0.002472034888342023, 0.008632699958980083, -0.013548802584409714, 0.020484795793890953, 0.00269577675499022, 0.02328156679868698, -0.008067131042480469, 0.02821631357073784, 0.004120576195418835, 0.0010456816526129842, 0.0050279730930924416, 0.010099451057612896, 0.05747675523161888, 0.018868882209062576, 0.021615933626890182, -0.01914234459400177, 0.024089522659778595, 0.01087011769413948, 0.001814793678931892, 0.030851492658257484, 0.031100096181035042, -0.01664389669895172, -0.0385332927107811, -0.01879430189728737, -0.024313263595104218, 0.019515248015522957, 0.032268524169921875, 0.005876326933503151, 0.021603504195809364, 0.00809199083596468]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" =
q∗(st+1:t+c|s1:t)for all tandc≤T−t.
(Sufficient) (i),(ii) =⇒Optimal Twisted SMC: Consider the incremental importance weights using (i)and(ii),
wt(s1:t) =˜π∗
t(s1:t)
˜π∗
t−1(s1:t−1)qπ∗
t(st|s1:t−1)=Zψ
tσ(s1:t)
Zψ
t−1σ(s1:t−1)σ(st|s1:t−1)=Zψ
t
Zψ
t−1(28)
which matches the optimality definition in Def. A.1.
Proposition A.4 (Optimal Intermediate Target Distributions ).For a given target distribution σ(s1:T)(Eq. (31)), the
following conditions are equivalent, and are necessary for optimality of a twisted SMC procedure involving {π∗
t}T
t=1,
(i) : π∗
t(s1:t) =X
st+1π∗
t+1(s1:t+1) ∀1≤t≤T−1,
(ii) : π∗
t(s1:t) =X
st+1:t+cπ∗
t+c(s1:t+c) ∀1≤t≤T−1,1≤c≤T−t ,
(iii) : π∗
t(s1:t) =σ(s1:t) ∀1≤t≤T .(29)
16
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Conditions (i)and(iii)directly correspond to the recursions for the optimal twist functions given in Prop. 3.2 and Prop. B.1.
Proof. (i)⇐⇒ (ii):It is clear that (ii) =⇒(i)as a special case for c= 1. To show (i) =⇒(ii), we have
π∗
t(s1:t) =X
st+1π∗
t+1(s1:t+1) =X
st+1X
st+2π∗
t+2(s1:t+2) =...=X
st+1:t+cπ∗
t+c(s1:t+c).
(i) =⇒(iii) :Recursively applying (i)until time Tsuggests that
π∗
t(s1:t) =X
st+1π∗
t+1(s1:t+1) =X
st+1X
st+2π∗
t+2(s1:t+2) =...=X
st+1:Tπ∗
T(s1:T) =X
st+1:Tσ(s1:T) =σ(s1:t).
(iii) =⇒(i) :The target marginals clearly satisfy the recursion
σ(s1:t):=X
st+1:Tσ(s1:T) =X
st+1X
st+2:Tσ(s1:T) =X
st+1σ(s1:t+1).
A.2. Proof of Twist-Induced Proposal
Proposition 3.3. (Twist-Induced Proposal). For a given set of intermediate twisted targets πt(s1:t)in Eq. (9), the proposal
which minimizes the variance of the one-step incremental importance weights wtis given by
qπ
t(st|s1:t−1)∝πt(s1:t)
πt−1(s1:t−1)(14)
=1
Zπ
t(s1:t−1)p0(st|s1:t−1)ψt(s1:t).
Proof. We seek to minimize the variance of the resulting importance weights, subject to a constraint on the proposal
probabilities summing to 1. Introducing a Lagrange multiplier λ(s1:t−1), we have
min
q(st|s1:t−1)Eq(st|s1:t−1)
˜πt(s1:t)
˜πt−1(s1:t−1)q(st|s1:t−1)2
−
Eq(st|s1:t−1)h
˜πt(s1:t)
˜πt−1(s1:t−1)q(st|s1:t−1)i2
+λ(s1:t−1)P
stq(st|","[0.029746197164058685, -0.027857549488544464, 0.017981497570872307, -0.0029411748982965946, -0.03748440742492676, 0.002798542845994234, 0.008925170637667179, 0.0007229978800751269, -0.03947797790169716, 0.007711977232247591, 0.04162893816828728, -0.0005029015592299402, -0.055820025503635406, 0.015200989320874214, 0.04249456897377968, -0.0185061227530241, 0.047058798372745514, -0.011718795634806156, -0.04034360870718956, 0.04742603749036789, -0.01917501725256443, -0.013010682538151741, 0.004331429488956928, 0.028618255630135536, -0.012308997102081776, -0.01680109277367592, 0.0392681285738945, -0.016604358330368996, 0.029431423172354698, 0.0024329451844096184, 0.035726916044950485, -0.02909041754901409, -0.026755839586257935, -0.06788638234138489, -0.01354842260479927, 0.07418187707662582, -0.0024936047848314047, 0.043963514268398285, -0.012453269213438034, 0.027044381946325302, 0.018388081341981888, -0.01407304685562849, -0.039897676557302475, 0.019030746072530746, 0.030821677297353745, 0.019161902368068695, 4.1703533497639e-05, -0.008164465427398682, -0.013823850080370903, 0.06038425490260124, -0.015004254877567291, 0.022991659119725227, -0.0011008912697434425, -0.0005889727617613971, -0.022926080971956253, 0.0033395616337656975, 0.0010984321124851704, -0.018296271562576294, 0.025995133444666862, -0.01766672357916832, 0.05419369041919708, -0.0052462429739534855, 0.007843133062124252, 0.0015181315829977393, -0.015738729387521744, -0.03019212745130062, -0.022519497200846672, 0.032762788236141205, -0.026218099519610405, 0.04223225638270378, -0.053931377828121185, 0.0312938392162323, 0.0435175858438015, 0.02022426575422287, -0.01855858415365219, 0.012486058287322521, 0.009528488852083683, 0.03932059183716774, 0.04530130699276924, -0.027542775496840477, 0.0029493721667677164, -0.04252079874277115, 0.02738538756966591, -0.013836965896189213, -0.017876572906970978, -0.049498300999403, -0.03200208395719528, -0.012276208959519863, -0.06967010349035263, -0.028854336589574814, -0.026349255815148354, 0.03858611732721329, -0.011482714675366879, 0.006734864320605993, 0.06421401351690292, -0.010630199685692787, 0.03695978224277496, 0.030979065224528313, 0.011226959526538849, -0.021876832470297813, 0.036986012011766434, -0.03955667093396187, -0.0005221650935709476, -0.00864318571984768, 0.0449865348637104, -0.010092459619045258, 0.014282896183431149, 0.02213914506137371, -0.04113054648041725, -0.0006229913560673594, 0.007797228638082743, 0.01756179891526699, -0.010269520804286003, 0.04614070802927017, 0.018335619941353798, -0.05217388644814491, -0.03323495015501976, -0.011482714675366879, -0.01750933565199375, 0.00852514524012804, 0.002952651120722294, -0.009607182815670967, 0.0009353067725896835, 0.0013377919094637036, 0.020001301541924477, -0.02477538213133812, 0.03835003450512886, -0.06662728637456894, -0.005957764573395252, 0.016460087150335312, 0.026034479960799217, 0.018650393933057785, 0.009482583962380886, 0.01457143947482109, 0.006629939656704664, -0.022637538611888885, 0.02103743515908718, 0.055924948304891586, 0.010715451091527939, 0.012197514995932579, 0.010151480324566364, -0.01257786713540554, -0.03139876574277878, 0.002798542845994234, 0.003419894725084305, 0.007784112822264433, -0.026349255815148354, 0.03722209483385086, -0.01567315123975277, 0.018414312973618507, -0.017089636996388435, -0.044960301369428635, -0.038009028881788254, 0.009817032143473625, 0.015397722832858562, -0.03960913419723511, -0.021444018930196762, 0.06746668368577957, 0.01815200038254261, -0.030716752633452415, -0.02168009988963604, 0.02610005810856819, -0.01966029591858387, -0.006154498551040888, 0.03223816305398941, 0.003915008623152971, -0.015594457276165485, 0.055820025503635406, -0.04435698315501213, -0.036854855716228485, 0.011705679818987846, -0.06274506449699402, -0.04566854611039162, -0.03504490479826927, 0.03446781635284424, -0.026191867887973785, -0.022585075348615646, -0.10607903450727463, -0.001609940780326724, 0.02459176443517208, 0.004115021787583828, 0.055872488766908646, 0.003596955444663763, -0.030585596337914467, 0.014335358515381813, 0.02814609371125698, -0.015476416796445847, 0.017365064471960068, 0.045930858701467514, -0.024486839771270752, -0.008597280830144882, 0.03861234709620476, 0.04737357422709465, -0.021719446405768394, -0.05353790894150734, -0.01981768198311329, 0.04905237257480621, 0.08089706301689148, 0.02709684520959854, 0.01653878018260002, 0.02469668909907341, -0.008780899457633495, -0.018191346898674965, -0.01311560720205307, -0.013076260685920715, -0.013718925416469574, -0.0009967861697077751, 0.01251228991895914, -0.0722932294011116, -0.004741291981190443, 0.010282636620104313, -0.01509606372565031, 0.03226439282298088, 0.03142499551177025, -0.01615842804312706, 0.03357595577836037, -0.06919794529676437, 0.0037576216273009777, -0.025995133444666862, 0.0481080487370491, -0.0035182617139071226, 0.021942410618066788, 0.03745817393064499, 0.016171544790267944, -0.02638860233128071, 0.022899851202964783, 0.02426387369632721, -0.04107808321714401, 0.03499244153499603, -0.027464082464575768, 0.029536347836256027, 0.005242964252829552, -0.007685746066272259, -0.030480671674013138, -0.007390644866973162, -0.005147875752300024, -0.017325717955827713, -0.005367562174797058, -0.025326237082481384, -0.08766472339630127, 0.03200208395719528, -0.0020804633386433125, 0.020106226205825806, -0.03347102925181389, 0.002550985664129257, 0.011954876594245434, -0.02405402436852455, -0.008675973862409592, -0.040028832852840424, -0.005633153486996889, 0.012741812504827976, -0.009797358885407448, -0.005334773100912571, 0.007600494660437107, -0.038927122950553894, -0.006649612914770842, 0.010499043390154839, 0.0023772038985043764, -0.0066201030276715755, 0.028644487261772156, 0.01866350881755352, -0.029929816722869873, -0.03740571066737175, 0.01769295521080494, -0.011712237261235714, -0.0019919329788535833, 0.00953504629433155, 3.709257725859061e-05, 0.05545278638601303, 0.004606856964528561, -0.006492225453257561, 0.020381653681397438, -0.006547966971993446, 0.05023277550935745, 0.006092199590057135, -0.04018622264266014, -0.02224406972527504, 0.03344479948282242, -0.02405402436852455, 0.043858591467142105, -0.02835594303905964, -0.047793272882699966, 0.024093370884656906, 0.014099277555942535, 0.009712107479572296, -0.028854336589574814, -0.003924845717847347, 0.0782739445567131, 0.008682532235980034, -0.07386709749698639, 0.005318379029631615, -0.003534656250849366, 0.020106226205825806, 0.004108463879674673, -0.008964518085122108, 0.014414052478969097, -0.01005967054516077, 0.005269195418804884, 0.01156796608120203, 0.03417927399277687, 0.06678467243909836, -0.003796968376263976, -0.018545469269156456, 0.017942151054739952, -0.0021411229390650988, -0.007141448091715574, 0.04742603749036789, -0.006164335645735264, -0.014335358515381813, 0.011718795634806156, -0.015856768935918808, -0.0022312926594167948, -0.019188133999705315, 0.0036625333596020937, -0.03336610645055771, -0.035831838846206665, 0.04726864770054817, -0.025955786928534508, -0.012354901991784573, -0.02825101837515831, -0.02582463063299656, -0.006554524879902601, -0.009626856073737144, -0.008708762936294079, 0.027464082464575768, -0.05065247416496277, -0.0048396592028439045, -0.008813688531517982, -0.02838217467069626, -0.01699782721698284, 0.018899589776992798, 0.0017656886484473944, 0.041891250759363174, 0.023529399186372757, -0.04834412783384323, -0.029667504131793976, -0.01521410420536995, 0.06300737708806992, 0.019056977704167366, 0.03722209483385086, -0.06379431486129761, 0.010426907800137997, -0.006800442468374968, -0.06620758771896362, 0.019450446590781212, 0.015056717209517956, 0.02558854967355728, 0.032946404069662094, 0.08488421142101288, 0.039950139820575714, -0.0007816082215867937, -0.026191867887973785, 0.05351167917251587, -9.667636913945898e-05, 0.006092199590057135, -0.01610596664249897, 0.007200468331575394, -0.0315561518073082, -0.0546133890748024, 0.00027481294819153845, -0.020525924861431122, -0.009043211117386818, 0.050888556987047195, -0.003377269022166729, -0.010020324029028416, 0.04700633883476257, 0.02674272283911705, -0.012781159020960331, -0.016420740634202957, 0.00872843712568283, -0.020801354199647903, 0.016892902553081512, -0.009469468146562576, 0.006108594126999378, -0.041812557727098465, -0.01966029591858387, -0.006226634606719017, 0.011954876594245434, 0.04913106560707092, 0.006679123267531395, 0.012204072438180447, -0.025483625009655952, -0.0015082948375493288, 0.003323167096823454, 0.022637538611888885, 0.002278836676850915, 0.019620949402451515, 0.006308607291430235, -0.015935463830828667, 0.0013484483351930976, 0.009849821217358112, -0.005213453900068998, -0.027831319719552994, 0.03803526237607002, -0.0031625009141862392, -0.021076781675219536, -0.004233062267303467, 0.05781359598040581, 0.024040907621383667, 0.0423896424472332, -0.0457734689116478, 0.008990748785436153, -0.06862086057662964, -0.03711716830730438, -0.05655450001358986, -0.004446190781891346, 0.004059280268847942, 0.042704418301582336, 0.009961304254829884, 0.06342707574367523, 0.042992960661649704, -0.03538591042160988, 0.02612628974020481, 0.021378440782427788, 0.029536347836256027, -0.0443832166492939, 0.016683053225278854, 0.019594717770814896, 0.03236931934952736, 0.04055345803499222, -0.005744636058807373, -0.00880713015794754, 0.030034741386771202, -0.007934942841529846, -0.024736035615205765, -0.009751453995704651, 0.03835003450512886, -0.02065708115696907, 0.04050099477171898, -0.04459306597709656, 0.015489532612264156, 0.031687308102846146, 0.036881089210510254, -0.018702855333685875, -0.033943191170692444, 0.007928384467959404, 0.03344479948282242, -0.009915399365127087, 0.017653606832027435, -0.05128202587366104, -0.033812034875154495, 0.011056456714868546, -0.02086693048477173, 0.007233257405459881, 0.004577347077429295, 0.02313593216240406, 0.019988184794783592, -0.04309788718819618, 0.02221783809363842, -0.004390449728816748, -0.017732301726937294, -0.01661747507750988, 0.060961343348026276, -0.04118300601840019, -0.019214365631341934, -0.016197774559259415, 0.06914548575878143, -0.016420740634202957, 0.02935273014008999, -0.02423764206469059, 0.031818464398384094, -0.010374445468187332, -0.004938026424497366, 0.009233387187123299, 0.015594457276165485, 0.02707061357796192, 0.06778145581483841, -0.02081446908414364, -0.014296011999249458, 0.05225257948040962, 0.01597481034696102, -0.04632432386279106, 0.03533344715833664, -0.004872448276728392, 0.00935798604041338, 0.014309127815067768, 0.09401267766952515, -0.03221193328499794, 0.020643966272473335, -0.03908450901508331, 0.03869104012846947, -0.030716752633452415, 0.014256665483117104, 0.023949099704623222, 0.01311560720205307, 0.047819506376981735, 0.06437139958143234, -0.018545469269156456, -0.007941500283777714, 0.0027739510405808687, 0.0017099473625421524, -0.04141908884048462, -0.007056196685880423, -0.015056717209517956, 0.03368087857961655, -0.045799702405929565, 0.006964387372136116, 0.0032789018005132675, -0.051019713282585144, -0.01555511076003313, 0.04928845167160034, 0.007784112822264433, -0.004623251501470804, 0.04968192055821419, 0.05107217654585838, 0.054980624467134476, 0.03016589768230915, -0.002132925670593977, 0.011207286268472672, 0.042861804366111755, -0.011318769305944443, -0.008885824121534824, -0.02152271196246147, -0.00011896265641553327, -0.006728306412696838, 0.01091874297708273, -0.03905827924609184, 0.004233062267303467, 0.017732301726937294, 0.00641025323420763, -0.012236861512064934, -0.022532613947987556, -0.04026491567492485, -0.017574913799762726, 0.012013896368443966, -0.014374705962836742, -0.003544492879882455, -0.12160791456699371, -0.04330773651599884, -0.03897958621382713, 0.006131546571850777, -0.030795445665717125, -0.0023231019731611013, 0.01269590761512518, -0.01112203486263752, 0.021981757134199142, -0.04721618816256523, 0.01217128336429596, -0.024119602516293526, 0.007390644866973162, -0.01922748051583767, -0.029982278123497963, -0.011167939752340317, 0.014020584523677826, -0.002109973458573222, -0.03205454349517822, 0.013850081712007523, -0.009102231822907925, -0.012859852984547615, -0.0021837486419826746, -0.0033395616337656975, -0.007259488571435213, -0.010872838087379932, -0.005495439283549786, -0.024250758811831474, -0.007180795073509216, 0.00577742513269186, 0.013994352892041206, 0.00852514524012804, 0.02070954442024231, 0.05007538944482803, -0.010131807066500187, 0.011128593236207962, -0.022690000012516975, -0.007187352981418371, 0.01512229535728693, 0.03132006898522377, 0.00278050871565938, 0.013253320939838886, 0.02684764750301838, -0.034677665680646896, 0.01027607824653387, 0.015869885683059692, -0.019516024738550186, -2.4502105588908307e-05, -0.022663770243525505, -0.0037379481364041567, -0.02682141773402691, -0.04044853150844574, -0.020801354199647903, -0.025300007313489914, -0.007816902361810207, 0.01356153842061758, -0.04155024513602257, -0.025680359452962875, 0.013469728641211987, -0.02175879292190075, 0.008577607572078705, -0.009069442749023438, 0.040028832852840424, 0.005859397817403078, -0.00477408105507493, -0.008675973862409592, 0.0009590787813067436, -0.04018622264266014, -0.0038494307082146406, -0.018388081341981888, 0.015568225644528866, -0.010499043390154839, -0.0016837160801514983, 0.010794145055115223, 0.019056977704167366, 0.006538130342960358, -0.03934682160615921, -0.051019713282585144, 0.055977411568164825, -0.061013806611299515, 0.023608094081282616, 0.0381401851773262, 0.013876312412321568, 0.03449404612183571, 0.019961955025792122, 0.012551636435091496, 0.008564491756260395, 0.00315102469176054, -0.04357004910707474, 0.03454650938510895, -0.006833231542259455, 0.04367497190833092, -0.007751324214041233, 0.01866350881755352, -0.01314183883368969, 0.025916440412402153, -0.01333201490342617, -0.011607312597334385, 0.035674452781677246, 0.009580951184034348, -0.030506903305649757, 0.04315034672617912, 0.020801354199647903, -0.04328150302171707, -0.00019847603107336909, -0.0013697613030672073, 0.02610005810856819, -0.007915268652141094, -0.01167289074510336, 0.009502257220447063, 0.020998086780309677, 0.035779375582933426, -0.029824892058968544, 0.03638269379734993, 0.011305653490126133, -0.02940519154071808, -0.016578128561377525, 0.028749411925673485, 0.0035608874168246984, -0.04448813945055008, 0.03848119080066681, -0.025365585461258888, -0.02429010532796383, -0.018925821408629417, 3.724627458723262e-05, 0.03939928486943245, -0.023713018745183945, 0.047871965914964676, -0.023122815415263176, 0.015004254877567291, 0.001358285080641508, 0.0031543036457151175, -0.03428419679403305, -0.0281723253428936, -0.00310348067432642, 0.015082948841154575, 0.029536347836256027, 0.01963406428694725, 0.014414052478969097, 0.033785805106163025, 0.026834532618522644, -0.014348474331200123, -0.01135155837982893, -0.009030095301568508, 0.0455111563205719, 0.019568486139178276, -0.022873619571328163, -0.016656821593642235, 0.008879266679286957, 0.0043871705420315266, -0.042888037860393524, 0.008249716833233833, 0.0021362046245485544, -0.01251228991895914, -0.007246373221278191, -0.03431043028831482, 0.003514982759952545, -0.006052852608263493, 0.0016181380487978458, 0.006305328104645014, -0.010525275021791458, -0.00576430931687355, -0.021470248699188232, -0.00937110185623169, 0.016446972265839577, 0.034887515008449554, -0.04443567618727684, 0.012636887840926647, -0.02227030135691166, -0.03307756036520004, 0.017299486324191093, -0.00651845708489418, -0.03821887820959091, -0.00628893356770277, 0.03551706671714783, -0.04173386096954346, -0.00810544565320015, -0.041786324232816696, -0.016787977889180183, -0.02124728448688984, 0.04467175900936127, 0.050993479788303375, -0.019922608509659767, 0.015397722832858562, 0.015843654051423073, -0.020158689469099045, -0.024486839771270752, -0.023949099704623222, 0.028749411925673485, 0.0018279877258464694, 0.033654648810625076, 0.017601145431399345, -0.004505211021751165, -0.01726013980805874, 0.0011410578154027462, -0.08294310420751572, 0.002903467509895563, -0.0043183136731386185, -0.025221312418580055, -0.0506262443959713, 0.011023667640984058, 0.015187873505055904, 0.004698666278272867, -0.008197254501283169, 0.02237522602081299, -0.00594464922323823, -0.0074693383648991585, -0.022794926539063454, 0.04131416231393814, 0.00634795380756259, 0.028014937415719032, -0.017194561660289764, -0.0005106889875605702, 0.030034741386771202, -0.02477538213133812, -0.057970985770225525, 0.023909753188490868, 0.06169581785798073, 0.04228471964597702, 0.019961955025792122, 0.03932059183716774, -0.02520819753408432, 0.007711977232247591, -0.007849691435694695, 0.010413791984319687, -0.011751584708690643, 0.02014557272195816, 0.02909041754901409, -0.006065968424081802, 0.016971595585346222, -0.022362111136317253, -0.03194962069392204, 0.010374445468187332, -0.015397722832858562, -0.02221783809363842, -0.017496220767498016, 0.012689350172877312, -0.013718925416469574, 0.021496480330824852, -0.016460087150335312, -0.02259819209575653, 0.013299225829541683, 0.02377859689295292, -0.020407885313034058, 0.0056134797632694244, -0.008984191343188286, 0.014099277555942535, 0.027490312233567238, 0.0008021013927645981, -0.025142619386315346, -0.039714060723781586, -0.019922608509659767, -0.010872838087379932, 0.012840179726481438, -0.011686006560921669, -0.026165636256337166, -0.0312938392162323, -0.007475896272808313, -0.016460087150335312, -0.009121905080974102, -0.007948057726025581, 0.025955786928534508, -0.026165636256337166, 0.003469078103080392, 0.00852514524012804, -0.018545469269156456, 0.0063250018283724785, -0.00957439374178648, -0.003439567983150482, -0.011023667640984058, -0.11856509000062943, -0.038717273622751236, 0.03121514618396759, 0.0017263417830690742, 0.018676625564694405, -0.007843133062124252, 0.02270311675965786, -0.018414312973618507, 0.018033960834145546, -0.018952053040266037, -0.02275557816028595, -0.011417136527597904, 0.006623381748795509, 0.02073577605187893, 0.028880568221211433, -0.022978544235229492, -0.01237457524985075, 0.0001862826175056398, -0.0076595149002969265, -0.021352209150791168, -0.0004619153041858226, 0.0341530404984951, 0.00457078916952014, 0.0523575060069561, -0.04913106560707092, -0.0273066945374012, 0.008426778018474579, -0.0033674321603029966, 0.0053610047325491905, -0.005538065452128649, 0.005738078150898218, -0.002677223412320018, 0.032867711037397385, 0.04233717918395996, -0.007259488571435213, 0.006216797977685928, 0.004626530688256025, -0.008302179165184498, -0.011174497194588184, 0.03410058096051216, -0.008289064280688763, -0.05923008173704147, 0.0793231949210167, 0.033759575337171555, 0.01796838268637657, -0.05419369041919708, 0.00378385279327631, -0.024408144876360893, 0.012525404803454876, -0.023201510310173035, 0.0006053672404959798, 0.011318769305944443, -0.006197124719619751, -0.038874659687280655, -0.013600884936749935, -0.00806609820574522, -0.005688894540071487, 0.017627377063035965, 0.038717273622751236, 0.008492356166243553, -0.011836836114525795, 0.024867191910743713, 0.06704698503017426, -0.04328150302171707, -0.03845496103167534, -0.028933029621839523, -0.006984061095863581, 0.002744440920650959, -0.0004578166699502617, -0.0006734044873155653, 0.006328280549496412, -0.0012197515461593866, -0.015056717209517956, -0.010531832464039326, -0.016683053225278854, -0.01084004994481802, -0.04425206035375595, 0.001166469301097095, -0.05513801425695419, 0.010039997287094593, 0.027044381946325302, -0.015423954464495182, 0.013863196596503258, 0.006639776285737753, -0.011253191158175468, -0.003770737210288644, -0.003655975451692939, 0.015371492132544518, -0.010820375755429268, 0.04262572526931763, 0.022335879504680634, -0.008380873128771782, 0.01613219641149044, -0.03134630247950554, 0.009587508626282215, -0.011095804162323475, -0.016945363953709602, 0.0021427622996270657, 0.024985231459140778, 0.008256275206804276, 0.03869104012846947, 0.04107808321714401, 0.01718144491314888, -0.03444158658385277, -0.0038789408281445503, 0.01866350881755352, -0.04233717918395996, 0.015568225644528866, 0.009725223295390606, 0.008734994567930698, 0.005829887464642525, -0.03913697227835655, -0.04871136695146561, 0.003744505811482668, 0.02022426575422287, 0.006846346892416477, 0.022532613947987556, 0.0058725131675601006, 0.016827324405312538, -0.008361199870705605, 0.025483625009655952, 0.019516024738550186, -0.014020584523677826, -0.0009549801470711827, -0.028670717030763626, -0.012774601578712463, -0.012735255062580109, 0.011292537674307823, 0.0027821483090519905, -0.017732301726937294, 0.016853556036949158, -0.008971075527369976, 0.039950139820575714, 0.013174627907574177, 0.0014132066862657666, 0.03758933022618294, 0.012230304069817066, -0.01104334183037281, -0.04708503186702728, 0.009862937033176422, 0.012000780552625656, 0.011751584708690643, 0.022519497200846672, 0.02372613362967968, 0.01008590217679739, -0.015660034492611885, -0.01459767110645771, -0.048003122210502625, 0.004065838176757097, -0.0006418450502678752, 0.040973156690597534, 0.003377269022166729, -0.004751128610223532, 0.0032116842921823263, -0.02806740067899227, -0.006970945280045271, -0.022847387939691544, 0.002265721093863249, -0.010053113102912903, 0.0009238306083716452, 0.02078823745250702, 0.03916320204734802, 0.025457393378019333, 0.0015451825456693769, -0.0017181445145979524, 0.007285719737410545, -0.020801354199647903, -0.017443757504224777, 0.010774471797049046, 0.02830348163843155, 0.003062494331970811, -0.01615842804312706, 0.006511899176985025, 0.018060190603137016, 0.005200338549911976, 0.004069117363542318, 0.006938156206160784, 0.01050560176372528, 0.012905757874250412, 0.019857030361890793, 0.006075805053114891, 0.013417266309261322, -0.06216797977685928, 0.01922748051583767, 0.0381401851773262, -0.033707112073898315, 0.013614000752568245, -0.006787326652556658, 0.0015845292946323752, 0.007266046479344368, 0.016827324405312538, 0.02566724456846714, -0.0223227646201849, 0.06363692879676819, 0.001603382988832891, 0.03601545840501785, -0.022768694907426834, 0.014676365070044994, 0.01628958433866501, -0.021693214774131775, -0.005705289077013731, 0.02712307684123516, -0.002496883738785982, -0.020801354199647903, 0.00176077033393085, 0.02014557272195816, -0.039845217019319534, 0.004970815032720566, -0.018112653866410255, -0.03368087857961655, 0.01858481578528881, 0.005029835272580385, -0.04538000002503395, 0.011187613010406494, -0.011777815409004688, -0.03604168817400932, 0.041917480528354645, -0.006970945280045271, -0.04564231261610985, -0.007744766306132078, -0.01766672357916832, -0.026886995881795883, -0.00603973725810647, 0.011967991478741169, -0.04435698315501213, -0.005469208117574453, 0.024001561105251312, 0.002318183658644557, -0.007128332741558552, -0.014991139061748981, -0.0030362631659954786, 0.01917501725256443, -0.01263033039867878, 0.005220011807978153, -0.006321722641587257, -0.003118235617876053, -0.038953352719545364, -0.009744896553456783, -0.006075805053114891, -0.005242964252829552, -0.0008279227185994387, 0.017443757504224777, 0.013587769120931625, 0.010977763682603836, 0.0037051590625196695, -0.010118691250681877, 0.030454440042376518, 0.021430902183055878, -0.010846607387065887, -0.02270311675965786, -0.04679648578166962, 0.03921566531062126, 0.04155024513602257, -0.022716231644153595, 0.011128593236207962, 0.012709023430943489, 0.0012017175322398543, 0.04713749140501022, 0.03627777099609375, -0.0012615574523806572, -0.0009869494242593646, -0.02459176443517208, 0.001547641702927649, -0.025785284116864204, -0.009744896553456783, -0.027726393193006516, 0.008577607572078705, 0.016328930854797363, -0.03357595577836037, -0.022663770243525505, 0.0002592381788417697, 0.001990293385460973, 0.0004992128233425319, 0.030008509755134583, 0.017915919423103333, -0.022414572536945343, 0.02339824289083481, -0.023476937785744667, -0.005869234446436167, 0.002560822293162346, -0.06132857874035835, -0.001056626089848578, -0.02272934839129448, -0.010630199685692787, 0.04406844079494476, 0.013168069534003735, 0.02927403524518013, 0.02081446908414364, 0.0010894151637330651, -0.01062364224344492, 0.015791190788149834, 0.019870145246386528, -0.019411098212003708, 0.007423433940857649, -0.005128202494233847, -0.013227090239524841, -0.005774145945906639, 0.031923387199640274, -0.009521931409835815, -0.015043601393699646, -0.0010623642010614276, 0.04635055735707283, -0.02060461975634098, -0.0019870144315063953, 0.0162108913064003, 0.019424214959144592, -0.0018427427858114243, 0.025142619386315346, -0.03265786170959473, -0.028880568221211433, -0.007187352981418371, 0.006492225453257561, -0.024893423542380333, 0.0370122455060482, 0.036881089210510254, 0.0015976448776200414, -0.0052855899557471275, -0.004315034952014685, -0.006623381748795509, 0.039818983525037766, -0.013587769120931625, -0.013614000752568245, 0.01960783265531063, -0.009292407892644405, -0.031005296856164932, 0.005003604106605053, -0.0003408008487895131, -0.02364744059741497, 0.004475701134651899, 0.018781550228595734, -0.01922748051583767, 0.020998086780309677, 0.021181706339120865, -0.028592023998498917, -0.006420089863240719, 0.02480161376297474, -0.005859397817403078, -0.0035477718338370323, -0.024250758811831474, -0.030952833592891693, 0.006990618538111448, 0.002877236343920231, -0.012781159020960331, 0.003544492879882455, 0.003944518975913525, 0.0004996226634830236, 0.001056626089848578, 0.013272995129227638, -0.0014123870059847832, -0.02208668366074562, 0.08325787633657455, 0.014007468707859516, -0.01583053730428219, 0.015528879128396511, 0.020539041608572006, 0.016840439289808273, -0.022440804168581963, -0.021483365446329117, -0.029798660427331924, -0.00777099747210741, -0.03606792166829109, 0.024604879319667816, -0.013797619380056858, 0.004593741614371538, 0.014794405549764633, -0.0050560664385557175, -0.0370122455060482, 0.016328930854797363, -0.0035871185828000307, -0.011345000006258488, 0.01509606372565031, -0.008151349611580372, -0.06243029236793518, 0.03166107460856438, -0.0108138183131814, 0.005813492927700281, -0.019188133999705315, 0.012348344549536705, -0.020801354199647903, -0.01184995099902153, 0.003128072479739785, -0.007128332741558552, -0.03719586133956909, -0.02081446908414364, 0.0006406154716387391, -0.0030788888689130545, -0.07491634786128998, 0.007810343988239765, -0.0058036562986671925, -0.00483310129493475, 0.012827063910663128, -0.005702010355889797, -0.013050029054284096, 0.0011615509865805507, -0.005642990116029978, -0.008518586866557598, -0.004229783546179533, -0.012971336022019386, 0.010374445468187332, -0.0030247869435697794, -0.015266567468643188, -0.022768694907426834, 0.033785805106163025, -0.02523442916572094, 0.006944714114069939, 0.00556101743131876, -0.0003672370221465826, -6.235036562429741e-05, 0.01280739065259695, 0.003941240254789591, -0.025431163609027863, -0.004656040575355291, -0.003941240254789591, 0.017430642619729042, 0.01164665911346674, -0.006387300789356232, 0.015581341460347176, 0.029011724516749382, -0.02638860233128071, 0.03908450901508331, -0.014374705962836742, -0.0013894346775487065, 0.0073644137009978294, 0.008754667825996876, 0.011974549852311611, -0.006702075246721506, -0.0064659942872822285, 0.04147155210375786, -0.007521800696849823, 0.03236931934952736, -0.006374184973537922, 0.013758271932601929, -0.003426452400162816, 0.010118691250681877, 0.005085576791316271, 0.03404811769723892, 0.019594717770814896, 0.009862937033176422, -0.012840179726481438, 0.01866350881755352, -0.023424474522471428, 0.018374966457486153, 0.02283427305519581, -0.03226439282298088, -0.01796838268637657, -0.034835051745176315, 0.03514982759952545, -0.02467045746743679, -0.007593936752527952, 0.030795445665717125, -0.006275818217545748, -0.029064185917377472, 0.055924948304891586, 0.023358896374702454, -0.03218569979071617, 0.014112393371760845, -0.036723699420690536, -0.003833036171272397, 0.027044381946325302, 0.02213914506137371, -0.012256534770131111, -0.0201980359852314, 0.015017370693385601, -0.008262832649052143, 0.0043183136731386185, 0.012072917073965073, -0.043911054730415344, 0.013994352892041206, 0.009994092397391796, -0.030690521001815796, 0.029746197164058685, -0.014112393371760845, -0.013109049759805202, -0.0017771647544577718, 0.010125248692929745, -0.00011834786710096523, -0.0009049769141711295, 0.005459371488541365, -0.014492746442556381, 0.02480161376297474, -0.01653878018260002, 0.012086031958460808, 0.014046815223991871, 0.00807921402156353, 0.009502257220447063, 0.0056921737268567085, -0.011371231637895107, 0.009810474701225758, -0.02507704123854637, -0.010892512276768684, -0.01564691960811615, -0.012728696689009666, -0.00011373691086191684, -0.01610596664249897, -0.0027280463837087154, 0.018807781860232353, -0.009758012369275093, 0.0023149047046899796, 0.031687308102846146, -0.0050659035332500935, -0.00403304910287261, -0.019332405179739, -0.0043937284499406815, 0.01334513071924448, 0.011082688346505165, -0.020053762942552567, 0.0049445838667452335, -0.015253451652824879, 0.04955076426267624, 0.017168330028653145, 0.030008509755134583, -0.008859592489898205, 0.0077644395641982555, 0.01514852698892355, 0.02827725000679493, -0.018401198089122772, -0.0076201679185032845, -0.009259618818759918, 0.006380742881447077, -0.03307756036520004, -0.007154563907533884, 0.020840700715780258, 0.005783983040601015, -0.029588811099529266, -0.019870145246386528, -0.0028296923264861107, 0.0031329907942563295, -0.011272864416241646, -0.013797619380056858, 0.0011804046807810664, -0.005826608743518591, -0.02741161920130253, 0.02270311675965786, -0.012007338926196098, -0.00037686878931708634, -0.01366646308451891, -0.00965308677405119, 0.015987925231456757, -0.0019935723394155502, 0.002014885190874338, 0.0020870210137218237, 0.020263614133000374, 0.005629874300211668, -0.01855858415365219, 0.007187352981418371, 0.009613740257918835, -0.012800833210349083, -0.01186306681483984, -0.016919134184718132, 0.029457654803991318, 0.011063015088438988, -0.012709023430943489, 0.01715521514415741, 0.006639776285737753, 0.024329451844096184, -0.006508619990199804, 0.025562318041920662, -0.011056456714868546, -0.008656300604343414, 0.03150368854403496, 0.05159679800271988, -0.008256275206804276, -0.021103011444211006, 0.03911074250936508, 0.004160926677286625, 0.008531702682375908, 0.010164596140384674, -0.0001887417893158272, 0.009515373036265373, -0.00912846252322197, -0.02919534221291542, -0.0033608744852244854, -0.007436549291014671, -0.007134890649467707, -0.044881608337163925, -0.00031846333877183497, -0.011987664736807346, -0.004315034952014685, 0.0005709388060495257, 0.002819855697453022, 0.012446711771190166, -0.008479240350425243, -0.0004209290200378746, -0.004534721374511719, 0.024578647688031197, -0.015633804723620415, 0.014912446029484272, -0.028985492885112762, -0.03260539844632149, 0.001713226200081408, -0.03829757496714592, 0.00013668922474607825, -0.002119810087606311, -0.0157780759036541, -0.0009123544441536069, 0.0583382211625576, 0.004400286357849836, 0.012735255062580109, -0.026886995881795883, 0.014859982766211033, 0.032710324972867966, 0.010499043390154839, 0.002016524551436305, -0.0068725780583918095, 0.011023667640984058, -0.002209979807958007, 0.021771907806396484, -0.027621468529105186, 0.05524293705821037, 0.035858072340488434, -0.02811986207962036, -0.008446451276540756, -0.001891926396638155, 0.017365064471960068, -0.012407364323735237, 0.018860243260860443, -0.00807921402156353, -0.008977632969617844, -0.017365064471960068, -0.012164725922048092, -0.009279292076826096, 0.012308997102081776, -0.01828315667808056, -0.008754667825996876, 0.018571700900793076, 0.007515243254601955, 0.00872843712568283, 0.01521410420536995, 0.02227030135691166, -0.00122057122644037, 0.038900893181562424, -0.005069182254374027, -0.008354641497135162, 0.01417797151952982, -0.0002897729573305696, -0.015227220021188259, -0.024421261623501778, 0.007738208398222923, -0.00576430931687355, 0.013095933943986893, 0.024552417919039726, -0.04031737893819809, 0.026414833962917328, -0.05018031224608421, -0.02806740067899227, -0.04357004910707474, -0.0035379352048039436, -0.031005296856164932, 0.030611827969551086, 0.011240075342357159, -0.0068266736343503, 0.009318639524281025, -0.0021411229390650988, -0.028644487261772156, 0.03664500638842583, -0.0028608418069779873, -0.024867191910743713, 0.029719965532422066, 0.01030230987817049, 0.004003539215773344, 0.014833752065896988, 0.010453139431774616, 0.003974028863012791, -0.008505471050739288, -0.0197652205824852, 0.021850602701306343, -0.008925170637667179, 0.015437070280313492, -0.011345000006258488, 0.03318248689174652, -0.025418046861886978, 0.025221312418580055, 0.01613219641149044, 0.010984321124851704, 0.011279422789812088, -0.01283362228423357, -0.000936126452870667, 0.0100990179926157, -0.01613219641149044, -0.026021365076303482, 0.003751063719391823, -0.014269781298935413, -0.009082558564841747, 0.0029362565837800503, 0.005042951088398695, 0.019345520064234734, 0.011712237261235714, 0.03654008358716965, 0.013732041232287884, -0.022152261808514595, 0.018335619941353798, 0.014282896183431149, -0.01366646308451891, -0.013745156116783619, -0.026467295363545418, 0.004065838176757097, 0.015017370693385601, 0.007174237165600061, -0.00531182112172246, 0.01715521514415741, 0.016224006190896034, 0.011417136527597904, -0.012151610106229782, -0.036697469651699066, 0.013745156116783619, -0.0028100188355892897, 0.0172076765447855, -0.016355162486433983, -0.02682141773402691, -0.005734799429774284, -0.014020584523677826, -0.005639711394906044, 0.02405402436852455, 0.0029067464638501406, 0.05256735533475876, -0.014414052478969097, -0.006747980136424303, -0.01718144491314888, -0.0014976384118199348, -0.0021640751510858536, 0.021719446405768394, 0.05923008173704147, 0.027647700160741806, 0.013574653305113316, -0.01417797151952982, -0.017601145431399345, -0.012558193877339363, -0.01050560176372528, 0.022230954840779305, 0.0014082883717492223, 0.013004125095903873, -0.024355683475732803, -0.0013189382152631879, -0.017601145431399345, 0.01728637143969536, 0.019161902368068695, -0.00806609820574522, 0.025116387754678726, 0.01187618263065815]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"s1:t−1)−1
Takingδ
δq(·) = 0 implies
0 =˜πt(s1:t)
˜πt−1(s1:t−1)q(st|s1:t−1)2
−2q(st|s1:t−1)˜πt(s1:t)
˜πt−1(s1:t−1)q(st|s1:t−1)˜πt(s1:t)
˜πt−1(s1:t−1)q(st|s1:t−1)2+λ(s1:t−1)
where the derivative in the second term is zero since the q(st|s1:t−1)cancel. Finally, we have
˜πt(s1:t)2
˜πt−1(s1:t−1)2q(st|s1:t−1)2=λ(s1:t−1)
q∗(st|s1:t−1) =1p
λ(s1:t−1)˜πt(s1:t)
˜πt−1(s1:t−1)=1
Zπ
t(s1:t−1)p0(st|s1:t−1)ψt(s1:t)
where Zπ
t(s1:t−1)(orλ) is chosen to enforce normalization.
We focused on the one-step twist-induced proposal in Prop. 3.3. However, this proposal is not optimal for resampling every
csteps (as would also occur, for example, with adaptive resampling).
Proposition A.5 (Multi-Step Twist Induced Proposal (Generalization of Prop. 3.3) ).For resampling c-steps ahead, the
optimal proposal (over st+1:t+c−1) which minimizes the variance of the importance weights wt:t+c−1(s1:t+c−1)is given by
qπ(st:t+c−1|s1:t−1) =p0(st:t+c−1|s1:t−1)ψt+c−1(s1:t+c−1)P
st:t+c−1p0(st:t+c−1|s1:t−1)ψt+c−1(s1:t+c−1).
The proof follows the same reasoning as in the proof of Prop. 3.3 above, using the multistep weights wt:t+c−1(s1:t+c−1) =
˜πt+c−1(s1:t+c−1)
˜πt−1(s1:t−1)q(st:t+c−1|s1:t−1)from Eq. ( c-Step SMC Weights).
Note that the denominator is not usually tractable for c >1in language modeling applications.
17
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
A.3. Derivation of CTL Gradient
Lemma A.6 (Derivation of CTL Gradient ).For the CTL lossmin
θLCTL(θ):= min
θPT
t=1DKL 
σ(s1:t)πθ
t(s1:t)
, the
(negative) gradient with respect to the parameters θis given by
−∇θLCTL(θ) =TX
t=1Eσ(s1:t)h
∇θlogψθ
t(s1:t)i
−Eπθ
t(s1:t)h
∇θlogψθ
t(s1:t)i
(30)
Proof. Consider expanding the form of πθ
t(s1:t)using Eq. (9), noting that the normalization logZψ
tis independent of s1:t.
Taking the gradient with respect to θusing the log derivative identity ∇θf(θ) =f(θ)∇θlogf(θ), we have
−∇θLCTL(θ) =−∇θ TX
t=1Eσ(s1:t)h
logσ(s1:t)−logp0(s1:t)−logψθ
t(s1:t)i
+ logX
s1:tp0(s1:t)ψθ
t(s1:t)!
=TX
t=1Eσ(s1:t)h
∇θlogψθ
t(s1:t)i
−TX
t=1X
s1:tp0(s1:t)ψθ
t(s1:t)P
s1:tp0(s1:t)ψθ
t(s1:t)∇θ
logp0(s1:t) + log �","[0.02478412166237831, -0.021408747881650925, 0.03052629344165325, 0.005076508969068527, -0.024878256022930145, 0.005560626275837421, 0.01939159259200096, 0.02161046303808689, -0.0425216481089592, 0.0218659695237875, 0.016782736405730247, -0.009211678989231586, -0.013360296376049519, 0.03491024672985077, 0.033968906849622726, -0.022013895213603973, 0.07105767726898193, 0.002355029573664069, -0.02294178679585457, 0.06374212354421616, -0.017159273847937584, -0.02850913628935814, -0.004360418766736984, 0.04483465105295181, -0.009299089200794697, -0.03208622708916664, 0.004239389207214117, -0.028939463198184967, 0.006696957629173994, -0.01635241135954857, 0.04975651204586029, -0.02910083532333374, -0.018907474353909492, -0.04935308173298836, -0.026330608874559402, 0.06454899162054062, -0.000931253656744957, 0.07046598196029663, -0.014657999388873577, 0.00414525531232357, 0.022121476009488106, -0.039616942405700684, -0.0353405699133873, 0.01976812817156315, 0.011739847250282764, 0.025550641119480133, 0.01621793396770954, 0.024353796616196632, -0.007355895359069109, 0.0323282852768898, -0.023627620190382004, 0.0365239679813385, -0.0008959534461610019, 0.0069793593138456345, -0.05083232745528221, -0.017737524583935738, 0.0025416165590286255, -0.021637359634041786, -0.006377574522048235, -0.05249984562397003, 0.03878318518400192, -0.023304874077439308, 0.0037384622264653444, -0.021099450066685677, -0.00889565795660019, -0.022551802918314934, -0.010805231519043446, 0.02837465889751911, -0.019714336842298508, 0.038594916462898254, 0.002148271072655916, 0.017508912831544876, 0.055054910480976105, 0.018705759197473526, -0.02318384498357773, 0.006394384428858757, -0.01386458519846201, 0.057448599487543106, 0.022108029574155807, -0.02226940169930458, 0.035367466509342194, -0.02041361853480339, 0.04141893610358238, -0.03647017851471901, -0.0005185771733522415, -0.042064424604177475, -0.040746551007032394, -0.008095518685877323, -0.030015280470252037, -0.030149757862091064, -0.010079056024551392, 0.019189877435564995, -0.027998123317956924, 0.0021936569828540087, 0.05048269033432007, 0.009534423239529133, 0.02939668484032154, 0.01580105535686016, 0.003061034018173814, -0.03402269631624222, 0.01910918951034546, -0.039616942405700684, 0.0448884442448616, -0.016070008277893066, 0.04736281931400299, -0.007597954012453556, -0.04599115625023842, 0.0020894373301416636, -0.0431133471429348, 0.014684895053505898, -0.026196131482720375, 0.00469997338950634, -0.009426841512322426, 0.05037510767579079, 0.02257869765162468, -0.029558058828115463, -0.03318893909454346, 0.007127284072339535, -0.03324272856116295, 0.010536277666687965, -0.025577537715435028, -0.025106867775321007, -0.015276594087481499, -0.00035132133052684367, 0.03127936273813248, -0.024649646133184433, 0.03203243762254715, -0.06627029180526733, -0.02587338723242283, -0.004309989977627993, 0.015047983266413212, 0.02891256846487522, -0.007826564833521843, -0.03238207474350929, -0.016782736405730247, -0.021839074790477753, 0.018584730103611946, 0.04580288752913475, 0.026680249720811844, 0.030042175203561783, 0.025604432448744774, -0.017872001975774765, -0.045291874557733536, 0.006085087079554796, -0.020817048847675323, 0.0006543149356730282, -0.010489210486412048, 0.058470625430345535, -0.026599561795592308, 0.020023634657263756, -0.02958495356142521, -0.018396461382508278, -0.05037510767579079, 0.010354734025895596, -0.015357280150055885, -0.06718473881483078, -0.009541147388517857, 0.0718645378947258, 0.016809633001685143, -0.03480266407132149, -0.0013582182582467794, 0.026787830516695976, 0.029665639623999596, 0.0011405335972085595, 0.01939159259200096, 0.009245297871530056, -0.047631774097681046, 0.034399233758449554, -0.036066748201847076, -0.05107438936829567, -0.005678293760865927, -0.0622897744178772, -0.04701318219304085, -0.044807758182287216, -0.006676786113530397, -0.034453023225069046, -0.03184416890144348, -0.08767904341220856, 0.007987936958670616, -0.025281688198447227, -0.016258276998996735, 0.04437743127346039, 0.002442439552396536, -0.013494772836565971, -0.013575458899140358, -0.0025029543321579695, 0.018947817385196686, 0.04800831153988838, 0.010892641730606556, 0.006118706427514553, -0.0034022696781903505, 0.051585402339696884, 0.07772774249315262, -0.037330832332372665, -0.03617433086037636, -0.01737443543970585, 0.0670771598815918, 0.059116117656230927, 0.02228284813463688, 0.010442143306136131, 0.027648484334349632, 0.04276370629668236, -0.03821837902069092, -0.017414778470993042, -0.026061654090881348, -0.0015666577965021133, 0.0014691619435325265, -0.002316367346793413, -0.07869597524404526, -0.024380691349506378, 0.005473216529935598, -0.02568511851131916, 0.03929419815540314, 0.025913730263710022, -0.03603985160589218, 0.044216059148311615, -0.049191709607839584, -0.009749586693942547, 3.7742876884294674e-05, 0.052069518715143204, 0.0007639977848157287, 0.005994314793497324, 0.02226940169930458, 0.030095966532826424, -0.06621650606393814, 0.010818679817020893, 0.04114998131990433, -0.016849976032972336, 0.05411357060074806, -0.02988080307841301, 0.05922369658946991, 0.01881333999335766, 0.0003168615803588182, -0.02856292761862278, 0.02419242262840271, -0.04378573223948479, -0.0389176607131958, -0.01087247021496296, -0.00787363201379776, -0.067023366689682, -0.01831577531993389, 0.02417897619307041, 0.006599461659789085, -0.015411071479320526, 0.006068277172744274, 0.014792476780712605, -0.03219380974769592, -0.0013372062239795923, 0.0033014118671417236, 0.027460215613245964, -0.004464638419449329, 0.025886833667755127, 0.0017297111917287111, 0.02251145988702774, -0.03192485496401787, 0.02754090167582035, 0.03066076897084713, -0.0036107089836150408, -0.026384400203824043, 0.018396461382508278, 0.02358727715909481, -0.04868069663643837, -0.028240183368325233, -0.0005585000617429614, -0.028347764164209366, -0.023439351469278336, -0.01976812817156315, -0.01251309085637331, 0.04375883564352989, -0.00496892724186182, 0.00649524200707674, -0.006192668806761503, -0.022914892062544823, 0.0652482733130455, 0.01098677609115839, -0.04951445385813713, 0.008465331047773361, 0.028428450226783752, -0.014604208990931511, 0.05126265436410904, -0.04246785491704941, -0.04217200726270676, 0.020991869270801544, 0.002699627075344324, 0.006246459670364857, -0.019431935623288155, -0.010314390994608402, 0.056265201419591904, -0.025537194684147835, -0.08536604046821594, 0.0248513612896204, -0.009077201597392559, 0.04779314622282982, -0.004229303449392319, -0.017334092408418655, 0.03792253136634827, -0.018006477504968643, -0.006891949567943811, -0.006552394945174456, 0.0020087510347366333, 0.033619266003370285, -0.027083680033683777, -0.03310825303196907, 0.018584730103611946, -0.016661707311868668, 0.04437743127346039, 0.024891704320907593, -0.024743778631091118, -0.02945047616958618, 0.00916461180895567, -0.013851136900484562, 0.008633427321910858, -0.029719430953264236, 0.011087633669376373, -0.03066076897084713, -0.030257338657975197, 0.03862181305885315, -0.015612786635756493, -0.02282075770199299, -0.04426984861493111, -0.012492919340729713, -0.006612909492105246, 0.012788768857717514, -0.012230688706040382, -0.016258276998996735, -0.0066162715665996075, -0.04545324668288231, -0.007692087907344103, 0.009393222630023956, -0.020077425986528397, 0.002654240932315588, 0.014752133749425411, -0.0014767262618988752, 0.00625990703701973, -0.0018372928025200963, -0.045668408274650574, -0.039079032838344574, 0.09305812418460846, -0.018006477504968643, 0.015195908024907112, -0.09381119906902313, -0.0015927127096801996, -0.019620202481746674, -0.03423785790801048, 0.016917213797569275, 0.016258276998996735, 0.019539516419172287, 0.02460930123925209, 0.10306321829557419, 0.026182683184742928, -0.012647567316889763, -0.04486154764890671, 0.05376392975449562, -0.002975305076688528, 0.03485645353794098, 0.016930662095546722, -0.013131684623658657, -0.03477576747536659, -0.017683733254671097, 0.004030949901789427, -0.011262454092502594, -0.015397623181343079, 0.02910083532333374, 0.008445159532129765, -0.003903196658939123, 0.02670714445412159, 0.005832942668348551, 0.0034661462996155024, -0.006744024809449911, -0.017387883737683296, -0.034345440566539764, 0.003071119775995612, -0.03383442759513855, 0.009070477448403835, -0.048115890473127365, -0.01609690487384796, 0.0015422838041558862, 0.0062162019312381744, 0.048895858228206635, 0.002748374827206135, 0.0031316345557570457, 0.006501965690404177, -0.015558996237814426, -0.031763482838869095, -0.0007413047715090215, -0.002069265814498067, 0.020736362785100937, -0.012889626435935497, -0.008525845594704151, 0.004972289316356182, 0.0353136770427227, -0.020911183208227158, -0.014362149871885777, 0.031064201146364212, 0.005873285699635744, 0.0068415203131735325, 0.0073289996944367886, 0.06578617542982101, 0.039321091026067734, 0.060622259974479675, -0.049541350454092026, 0.022148372605443, -0.044942233711481094, -0.037814948707818985, -0.05513559654355049, -0.023815887048840523, -0.01569347269833088, 0.028724299743771553, 0.025644775480031967, 0.0341302789747715, 0.056964483112096786, -0.016957556828856468, 0.03219380974769592, -0.027809856459498405, 0.02119358442723751, -0.05042889714241028, 0.002556745195761323, 0.045533932745456696, 0.07702846080064774, 0.0449153371155262, -0.01869231089949608, 0.007443305104970932, 0.005964057520031929, -0.025106867775321007, -0.02251145988702774, 0.00787363201379776, 0.014684895053505898, 0.002277705119922757, 0.03628190979361534, -0.041822366416454315, 0.023802440613508224, 0.031467631459236145, 0.015478309243917465, -0.021112898364663124, -0.041042398661375046, 0.004888241179287434, 0.03800321742892265, 0.011800361797213554, -0.011928115040063858, -0.07256381958723068, -0.0027466940227895975, 0.005997676867991686, -0.025053076446056366, -0.0016296938993036747, 0.028482241556048393, 0.028939463198184967, 0.006821348797529936, -0.06202081963419914, 0.018947817385196686, -0.008646874688565731, -0.0027130746748298407, 0.0024659731425344944, 0.04585667699575424, -0.002862680470570922, -0.024084841832518578, -0.017925791442394257, 0.05161229521036148, 0.005839666351675987, 0.017939239740371704, -0.02939668484032154, 0.02466309256851673, 0.012257584370672703, -0.013622526079416275, -0.011457446031272411, 0.0022155095357447863, 0.016809633001685143, 0.06126774847507477, -0.0335385799407959, -0.00981682538986206, 0.02958495356142521, -0.010529553517699242, -0.030580082908272743, 0.02280730940401554, -0.03665844723582268, 0.016863424330949783, 0.03692740201950073, 0.05981539562344551, -0.035179197788238525, 0.005204262211918831, -0.05053647980093956, 0.05120886489748955, -0.011101081036031246, 0.0008228315273299813, 0.005563988350331783, 0.017562704160809517, 0.10376249998807907, 0.03187106177210808, 0.0010153017938137054, -0.0016977728810161352, 0.01108090952038765, 0.01689031906425953, -0.047389715909957886, 0.003627518657594919, -0.016029665246605873, 0.028428450226783752, -0.0019499174086377025, -0.0016271724598482251, 0.010495934635400772, -0.024864807724952698, -0.0401279553771019, 0.02705678530037403, 0.008566188625991344, -0.00037695601349696517, 0.038299065083265305, 0.039321091026067734, 0.0011052333284169436, 0.016150694340467453, 0.012627395801246166, 0.03636259585618973, 0.03300067037343979, -0.02173149213194847, 0.0057724276557564735, -0.011955010704696178, 0.0122777558863163, -0.0245555117726326, 0.01158519834280014, -0.04354367405176163, -0.011840704828500748, -0.0008337578037753701, -0.013609078712761402, -0.018651967868208885, -0.007887079380452633, -0.05107438936829567, -0.04771246016025543, 0.027756065130233765, -0.023035921156406403, 0.0032593877986073494, -0.10387007892131805, -0.03827217221260071, -0.035421255975961685, 0.035125408321619034, -0.022242505103349686, -0.005977505352348089, 0.009198230691254139, -0.021583568304777145, 0.03321583569049835, -0.019969843327999115, -0.0064280033111572266, -0.03808390349149704, -0.0008362792432308197, -0.017159273847937584, -0.007207970600575209, 0.017266854643821716, 0.005453045014292002, 0.004797469358891249, -0.031171781942248344, 0.016070008277893066, -0.016554126515984535, 0.002593726385384798, 0.030391816049814224, 0.007503820117563009, -0.008626703172922134, -0.01574726402759552, -0.018127508461475372, -0.037330832332372665, 0.007490372285246849, -8.840816008159891e-05, 0.016204485669732094, 0.010966604575514793, 0.014321806840598583, 0.03609364479780197, -0.00958149041980505, 0.00805517565459013, 0.0006631400319747627, 0.0009884063620120287, 0.00796776544302702, 0.03579779341816902, 0.0065658423118293285, 0.02850913628935814, 0.03450681269168854, -0.06304284930229187, 0.011175043880939484, -0.007100388873368502, -0.014146986417472363, 0.004854621831327677, -0.017455123364925385, 0.04335540533065796, -0.03897145390510559, 0.0006143920472823083, -0.03794942796230316, -0.02454206347465515, 0.013245990499854088, 0.02108600363135338, -0.030445607379078865, -0.024649646133184433, 0.02318384498357773, 0.006939016282558441, -0.015021087601780891, -0.023963812738656998, 0.01484626717865467, 0.023762095719575882, 0.012748424895107746, -0.03162900358438492, -0.007416409905999899, -0.017293749377131462, -0.007658468559384346, -0.0110741863027215, 0.010805231519043446, -0.008189653046429157, 0.005906905047595501, 0.012418956495821476, 0.012257584370672703, 0.002449163468554616, -0.023762095719575882, -0.028778091073036194, 0.0311448872089386, -0.04112308472394943, 0.024958942085504532, 0.010112674906849861, 0.013676317408680916, 0.022955235093832016, 0.011659161187708378, -0.0021264185197651386, -0.011121252551674843, -0.0038897490594536066, -0.030095966532826424, 0.017293749377131462, -0.02867051027715206, 0.08364473283290863, -0.038164589554071426, 0.012492919340729713, -0.038164589554071426, 0.045668408274650574, -0.04975651204586029, -0.00969579629600048, 0.029181521385908127, -0.017576152458786964, -0.02622302621603012, 0.018665416166186333, 0.011087633669376373, -0.0167558416724205, 0.018934370949864388, 0.02263248898088932, 0.023667963221669197, 0.022255953401327133, -0.003175339661538601, -0.004767211619764566, 0.004320075735449791, -0.001109435805119574, -0.03671223670244217, 0.017078585922718048, 0.0025685117579996586, -0.010704373940825462, -0.01831577531993389, 0.036066748201847076, 0.019673993811011314, -0.013635974377393723, 0.03125246986746788, -0.03321583569049835, -0.03456060588359833, -0.025362374261021614, -0.04257543757557869, 0.02880498580634594, -0.009749586693942547, 0.029235312715172768, -0.022645937278866768, -0.004027587827295065, -0.01772407628595829, 0.011054014787077904, -0.025133762508630753, -0.022524908185005188, -0.02832086943089962, 0.004091464448720217, 0.011349864304065704, 0.004118360113352537, 0.02204078994691372, 0.005174004938453436, 0.013420810922980309, -0.019431935623288155, -0.022054238244891167, -0.029558058828115463, 0.06605513393878937, 0.019714336842298508, 0.006296888459473848, -0.006051467731595039, 0.02939668484032154, -0.012506366707384586, -0.052607424557209015, -0.004652906209230423, 0.008357749320566654, -0.03934798762202263, -0.00772570725530386, -0.03555573523044586, -0.022054238244891167, 0.003067757934331894, 0.011847428977489471, 0.03735772892832756, 0.00016809633234515786, -0.018665416166186333, -0.00040658298530615866, -0.02346624620258808, 0.0035670041106641293, 0.02521444857120514, -0.03725014626979828, 0.0023230912629514933, -0.024111736565828323, -0.03289308771491051, 0.024757226929068565, 0.01621793396770954, -0.034157171845436096, -0.017858553677797318, 0.007160903420299292, -0.05072474852204323, -0.006666700355708599, -0.038648705929517746, -0.013084618374705315, -0.031521424651145935, 0.03851423040032387, 0.042360275983810425, -0.023748649284243584, -0.0019885795190930367, 0.002111289883032441, -0.012123106978833675, 0.0016666750889271498, -0.024945495650172234, 0.026814725250005722, 0.017226511612534523, 0.01445628423243761, 0.014066300354897976, 0.00286604231223464, -0.011033843271434307, -0.000931253656744957, -0.03945557028055191, -0.011497789062559605, 0.013878032565116882, -0.024985838681459427, -0.057878926396369934, -0.008660322986543179, -0.0011127976467832923, -0.0008388006826862693, -0.03402269631624222, 0.04244096204638481, 0.012291203252971172, 0.007382790558040142, -0.02658611536026001, 0.03813769295811653, 0.0011825576657429338, -0.0007522310479544103, -0.027231605723500252, -0.015962427482008934, -0.0017381160287186503, -0.024394139647483826, -0.05228468030691147, 0.04383952170610428, 0.04975651204586029, 0.02885877713561058, 0.011302797123789787, 0.04034311696887016, 0.007174351252615452, -0.030149757862091064, -0.015222803689539433, 0.010832127183675766, -0.0006589376134797931, -0.003630880732089281, 0.017078585922718048, -0.007766050286591053, 0.01099349930882454, -0.005385806318372488, -0.009675624780356884, -0.0035132132470607758, 0.011430550366640091, -0.008741009049117565, 0.014214225113391876, 0.009258745238184929, -0.01671549864113331, -0.013676317408680916, -0.02060188539326191, -0.008781352080404758, 0.01838301494717598, 0.03348478674888611, -0.005490025971084833, 0.01730719767510891, -0.007046598009765148, 0.01723995991051197, 0.048062101006507874, 0.03797632083296776, 0.008539292961359024, -0.04322092607617378, 0.0016095222672447562, -0.011370035819709301, 0.02306281588971615, 0.0005879168747924268, -0.010697649791836739, -0.04534566402435303, -0.008357749320566654, -0.030795246362686157, -0.019028503447771072, 0.013440982438623905, 0.011907943524420261, -0.030445607379078865, -0.03525988385081291, 0.0012792130000889301, 0.017455123364925385, 0.018396461382508278, 0.003067757934331894, 0.015303489752113819, 0.00020182065782137215, -0.1293131411075592, -0.028589822351932526, 0.024461377412080765, 0.014684895053505898, 0.025913730263710022, -0.028159497305750847, 0.01970088854432106, -0.022551802918314934, 0.007618125528097153, -0.024165527895092964, -0.009245297871530056, -0.007571058347821236, 0.02538926899433136, 0.0158682931214571, 0.015760712325572968, -0.034345440566539764, -0.01957985945045948, 0.004172150976955891, -0.0007635775837115943, -0.01701134815812111, -0.026424743235111237, -0.007624849211424589, 0.017145825549960136, 0.0395362563431263, -0.039482466876506805, -0.013972166925668716, -0.011558303609490395, 0.00964200496673584, 0.0031971922144293785, 0.02939668484032154, -0.01808716543018818, -0.017683733254671097, 0.015478309243917465, 0.02754090167582035, -0.01940503902733326, 0.010260599665343761, -0.0068583302199840546, -0.021449090912938118, -0.034103382378816605, -0.0043234373442828655, 0.006986083462834358, -0.05734102055430412, 0.04478086158633232, 0.022148372605443, 0.008270339109003544, -0.038299065083265305, 0.0026038121432065964, -0.02993459440767765, 0.004824364557862282, -0.020467408001422882, 0.0036644998472183943, 0.023035921156406403, -0.0034056315198540688, -0.03735772892832756, 0.0036207949742674828, -0.0060951728373765945, -0.00627335486933589, -0.012936693616211414, 0.012183621525764465, 0.022861100733280182, -0.037142563611269, 0.019552964717149734, 0.01765683852136135, -0.017038242891430855, -0.04257543757557869, -0.024824464693665504, -0.006891949567943811, 0.016070008277893066, -0.010892641730606556, -0.010791784152388573, -0.009379775263369083, 0.00042003070120699704, -0.006471708416938782, -0.024811018258333206, -0.018894027918577194, -0.008619979955255985, -0.016540678218007088, 0.020924631506204605, -0.03558263182640076, 0.005490025971084833, 0.026021311059594154, -0.0218525230884552, -0.024501720443367958, 0.0016448225360363722, -0.0016944109229370952, 0.012244136072695255, 0.008747733198106289, 0.012600500136613846, -0.05072474852204323, 0.04418916255235672, 0.04539945721626282, 0.00804845243692398, 0.012862730771303177, -0.023788992315530777, -0.0007417250308208168, -0.022054238244891167, -0.008741009049117565, 0.010657306760549545, 0.032973773777484894, -0.0005669048405252397, 0.011302797123789787, 0.03725014626979828, -0.00413180748000741, -0.007752602454274893, -0.007268485147505999, -0.005187452770769596, -0.00843843538314104, 0.01143727358430624, -0.006038019899278879, -0.0044310190714895725, -0.0018322499236091971, -0.016137247905135155, -0.03569021075963974, 0.006898673251271248, -0.004125083796679974, 0.006088449154049158, 0.03388822078704834, 0.023748649284243584, 0.018651967868208885, -0.018006477504968643, 0.012392060831189156, 0.019472278654575348, -0.02029258757829666, 0.0012497961288318038, -0.035421255975961685, -0.0164599921554327, 0.005459768697619438, 0.0059875911101698875, -0.027917437255382538, -0.009480632841587067, 0.02148943394422531, -0.018114060163497925, 0.021892866119742393, 0.012896350584924221, -0.0037048431113362312, 0.04472707211971283, -0.0007606358849443495, 0.0047537642531096935, -0.025295134633779526, 0.02832086943089962, 0.008633427321910858, 0.009823549538850784, 0.018665416166186333, 0.02329142764210701, 0.0015271551674231887, -0.01765683852136135, -0.005594245623797178, -0.03466818481683731, 0.005379082635045052, 0.00279207993298769, 0.06508689373731613, 0.0010934666497632861, -0.008546017110347748, -0.022148372605443, 0.0021919761784374714, -0.0007665192242711782, 0.027110574766993523, -0.05045579373836517, -0.016029665246605873, 0.01807371713221073, -0.01563968136906624, 0.03940177708864212, 0.04179546982049942, 0.002901342697441578, 0.006633081007748842, -0.013467877171933651, -0.018840236589312553, -0.023788992315530777, 0.014510074630379677, 0.030875932425260544, 0.007234865799546242, -0.023251084610819817, 0.008653598837554455, 0.004716782830655575, 0.013266162015497684, 0.0010119398357346654, 0.014913505874574184, 0.023869678378105164, 0.001122043002396822, 0.014039404690265656, 0.007107112556695938, 0.0218659695237875, -0.016742393374443054, -0.005627864971756935, 0.023627620190382004, -0.0050294422544538975, 0.003765357658267021, -0.009917682968080044, 0.02807880938053131, 0.036066748201847076, 0.023439351469278336, 0.013124961405992508, -0.010717821307480335, 0.06293526291847229, 0.015357280150055885, 0.02821328677237034, -0.014227673411369324, 0.01976812817156315, -0.018235089257359505, -0.024205870926380157, 0.009144440293312073, 0.045533932745456696, -0.006512051448225975, -0.008942724205553532, -0.025120314210653305, 0.01927056349813938, -0.05174677446484566, 0.010038712993264198, 0.003798977006226778, -0.018248537555336952, 0.010200085118412971, -0.0031165059190243483, -0.026384400203824043, 0.02407139353454113, -0.022713175043463707, -0.03507161885499954, 0.02018500678241253, 0.010361457243561745, -0.012741701677441597, -0.02119358442723751, -0.010018541477620602, -0.03101040981709957, -0.010946433059871197, 0.037223249673843384, -0.052069518715143204, 0.002793760970234871, 0.007187799084931612, -0.006249821279197931, -0.00835102517157793, -0.009272193536162376, -0.023573828861117363, 0.022955235093832016, -0.02322418801486492, 0.010159742087125778, 0.0009035177645273507, -0.00015664476086385548, -0.033027566969394684, -0.02263248898088932, -0.021960103884339333, -0.0017515637446194887, 0.019485726952552795, 0.033511683344841, 0.007624849211424589, 0.006206116173416376, -0.005251329392194748, -0.009722691029310226, 0.014469731599092484, 0.03052629344165325, -0.010213532485067844, -0.02748711034655571, -0.03197864443063736, 0.028724299743771553, 0.03101040981709957, -0.008949448354542255, 0.023788992315530777, 0.020037082955241203, 0.016029665246605873, 0.05123576149344444, 0.05244605243206024, 0.02658611536026001, -0.013064446859061718, -0.027379529550671577, 0.007591229863464832, -0.019808471202850342, -0.011188491247594357, -0.02939668484032154, -0.002891256706789136, 0.014805924147367477, -0.032355181872844696, 0.013145132921636105, -0.004636096768081188, 0.009944578632712364, -0.005648036487400532, 0.018840236589312553, 0.011948286555707455, -0.014953848905861378, 0.03141384199261665, -0.02077670581638813, -0.008962895721197128, 0.015236251056194305, -0.04034311696887016, -0.017159273847937584, -0.02179873175919056, -0.028966359794139862, 0.04106929525732994, -0.008189653046429157, 0.033027566969394684, 0.0032005540560930967, 0.01772407628595829, 0.010153017938137054, 0.003906558733433485, 0.011484340764582157, -0.006236373912543058, 0.00958149041980505, -0.004037673585116863, -0.02372175268828869, -0.00826361496001482, 0.02018500678241253, -0.011712951585650444, -0.007981213741004467, 0.011786914430558681, 0.022484565153717995, -0.005688379518687725, -0.008283786475658417, 0.002247447846457362, 0.022296296432614326, 0.0128694549202919, 0.0064280033111572266, -0.03837975487112999, -0.022592145949602127, -0.020090872421860695, 0.013662869110703468, -0.030338024720549583, 0.05333360284566879, 0.02915462665259838, -0.006175858899950981, -0.00954787153750658, 0.015464861877262592, -0.006027934141457081, 0.01081195566803217, -0.023977259173989296, -0.019499173387885094, 0.007093664724379778, -0.007201246451586485, -0.005237881559878588, -0.016419649124145508, -0.0017297111917287111, -0.02748711034655571, 0.0036779476795345545, 0.030391816049814224, -0.002203742740675807, 0.019552964717149734, 0.015491757541894913, -0.016016218811273575, -0.01272825337946415, 0.013414086773991585, -0.006636443082243204, -0.0027819941751658916, -0.02372175268828869, -0.019176429137587547, 0.009016687050461769, 0.01772407628595829, -0.0009690753067843616, -0.016070008277893066, -0.025644775480031967, 0.007160903420299292, 0.005174004938453436, 0.009003238752484322, -0.010785060003399849, -0.022309744730591774, 0.09252021461725235, -0.005580797791481018, -0.017334092408418655, 0.025120314210653305, 0.011894496157765388, 0.020736362785100937, -0.001339727663435042, 0.002313005505129695, -0.0473090298473835, 0.013245990499854088, -0.03665844723582268, 0.03617433086037636, -0.01563968136906624, 0.005809409078210592, 0.01386458519846201, -0.005379082635045052, -0.016002770513296127, 0.0047537642531096935, 0.006384298671036959, 0.02124737575650215, 0.008835142478346825, 0.012795492075383663, -0.04951445385813713, 0.005950610153377056, -0.02473033219575882, -0.013783899135887623, -0.02054809406399727, 0.032059330493211746, -0.01290307380259037, 0.009151164442300797, 0.010166466236114502, -0.018235089257359505, -0.04682491347193718, -0.018423357978463173, 0.010226980783045292, -0.0007375226123258471, -0.06358075141906738, 0.012190345674753189, -0.0023987346794456244, 0.0007992980536073446, 0.005540454760193825, -0.0003723333647940308, -0.009857168421149254, 0.002941685728728771, -0.003035819623619318, 0.005399254150688648, -0.015706920996308327, 0.0037720815744251013, -0.016325514763593674, -0.016809633001685143, -0.012492919340729713, -0.011161595582962036, 0.009783206507563591, -0.02802501991391182, 0.011544855311512947, -0.0066465288400650024, -0.005399254150688648, 0.0021869332995265722, -0.0004332682874519378, 0.00993785448372364, -0.027514006942510605, 0.015706920996308327, -0.01593553088605404, 0.023573828861117363, 0.02138185314834118, -0.026330608874559402, 0.012997208163142204, 0.031037306413054466, -0.03563642129302025, 0.04744350537657738, -0.03975141793489456, 0.03797632083296776, -0.011363311670720577, -0.0010682521387934685, 0.0018574644345790148, -0.008714113384485245, -0.011215386912226677, 0.032113123685121536, -0.003235854208469391, 0.05215020477771759, -0.010126122273504734, 0.013488049618899822, 0.011127976700663567, -0.004504981450736523, 0.022430773824453354, 0.022498011589050293, 0.01765683852136135, -0.03367305546998978, -0.01988915726542473, -0.003822510363534093, -0.0033972267992794514, 0.008001385256648064, 0.030580082908272743, -0.012385337613523006, -0.005022718105465174, -0.033565472811460495, 0.029369790107011795, -0.023748649284243584, -0.003906558733433485, 0.02741987258195877, 0.01108090952038765, -0.015195908024907112, 0.052365366369485855, 0.008673770353198051, -0.010603516362607479, 0.00579259917140007, -0.04082723706960678, -0.016271723434329033, 0.0034039507154375315, 0.004683163482695818, 0.012385337613523006, -0.03544815257191658, 0.016971005126833916, -0.0028878948651254177, -0.006653252523392439, 0.012882902286946774, -0.03162900358438492, 0.03824527561664581, 0.01987570896744728, -0.05007925629615784, 0.023614171892404556, -0.012136554345488548, 0.016258276998996735, 0.0022289573680609465, 0.0011195215629413724, -0.003034138586372137, 0.011645713821053505, 0.010731269605457783, -0.012499642558395863, 0.01580105535686016, -0.021879417821764946, -0.0042360275983810425, 0.011302797123789787, 0.002208785619586706, -0.0013716659741476178, -0.01284255925565958, -0.0023197291884571314, -0.0059405239298939705, -0.04467327892780304, 0.0006564161740243435, 0.002237362088635564, -0.025079971179366112, 0.010495934635400772, -0.004565495997667313, 0.0032560257241129875, 0.014469731599092484, -0.012472747825086117, -0.02167770266532898, 0.004955479875206947, -0.013783899135887623, -0.004888241179287434, -0.014738685451447964, -0.01736098900437355, 0.007362619042396545, 0.004535238724201918, -0.029504267498850822, 0.010334562510251999, -0.01442938856780529, 0.02689541131258011, 0.01593553088605404, 0.03692740201950073, 0.0010262280702590942, 0.021395299583673477, 0.034937139600515366, 0.049675825983285904, 0.014146986417472363, -0.0164599921554327, 0.004330161493271589, 0.008256891742348671, -0.03695429489016533, -0.04238716885447502, 0.018584730103611946, 0.013474601320922375, -0.010179913602769375, -0.008707389235496521, -0.02454206347465515, -0.00028849532827734947, -0.027809856459498405, -0.0003597261384129524, 0.010462315753102303, -0.009083925746381283, -0.02611544542014599, 0.03300067037343979, -0.0028862138278782368, -0.019351249560713768, -0.014523522928357124, 0.006044744048267603, 0.014994191937148571, 0.0039906068705022335, 0.0051168520003557205, 0.002474377863109112, -0.015155564993619919, 0.007006254978477955, -0.005012632347643375, 0.011121252551674843, 0.01892092265188694, 0.0003996490268036723, -0.008882209658622742, 0.00408474076539278, 0.00954787153750658, -0.011329692788422108, -0.00843843538314104, 0.01869231089949608, 0.015720369294285774, 0.025469955056905746, -0.006411193870007992, 0.01206931658089161, -0.01723995991051197, -0.025846490636467934, 0.015236251056194305, 0.03162900358438492, 0.0062330118380486965, -0.011860876344144344, 0.017629941925406456, 0.0011136381654068828, -0.00010957779159070924, 0.015612786635756493, -0.03052629344165325, 0.0002851333993021399, -0.037223249673843384, -0.021516330540180206, -0.006397746037691832, -0.010616963729262352, 0.011907943524420261, -0.009742863476276398, 0.02017155848443508, 0.0001525474217487499, -0.014967297203838825, -0.012008801102638245, 0.019230220466852188, 0.005567350424826145, -0.023318322375416756, -0.006844882387667894, -0.01963365077972412, 0.008270339109003544, 0.008035004138946533, -0.00999836903065443, -0.022955235093832016, -0.012856006622314453, 0.007120560389012098, -0.03515230491757393, 0.005274862516671419, 0.013568735681474209, -0.009299089200794697, -0.01134314015507698, 0.0664854571223259, 0.004397399723529816, 0.02885877713561058, -0.020090872421860695, 0.027809856459498405, 0.01701134815812111, -0.015276594087481499, 0.012936693616211414, -0.025429612025618553, 0.007355895359069109, -0.016433097422122955, 0.018167851492762566, -0.02963874489068985, 0.05435562878847122, 0.032731715589761734, -0.020252244547009468, -0.005049613770097494, 0.03407648578286171, -0.004531877115368843, -0.022484565153717995, 0.010112674906849861, -0.022134924307465553, 0.015666577965021133, -0.02521444857120514, -0.024407586082816124, -0.011820533312857151, 0.014900058507919312, 0.002207104815170169, -0.00390992034226656, 0.014967297203838825, 0.0218525230884552, -0.004797469358891249, 0.006932292599231005, 0.018221640959382057, -0.01982191950082779, 0.049299292266368866, -0.016379306092858315, -0.0007581144454889, 0.0026508790906518698, -0.002309643430635333, -0.02318384498357773, -0.018369566649198532, -0.01683652773499489, -0.005980867426842451, 0.006172497291117907, -0.005476578138768673, -0.019122637808322906, 0.044753964990377426, -0.03638949245214462, -0.023076264187693596, -0.032301388680934906, 0.020211901515722275, -0.01694411039352417, 0.03160211071372032, 0.018046822398900986, -0.010610240511596203, -0.007745878770947456, -0.004585667978972197, -0.011766742914915085, 0.021516330540180206, 0.025362374261021614, -0.00955459475517273, 0.0010186637518927455, -0.021220481023192406, -0.001072454615496099, 0.002134823240339756, 0.02310315892100334, -0.0002817714703269303, 0.013508221134543419, -0.04383952170610428, 0.018826788291335106, -0.01862507313489914, 0.01075144112110138, 0.00011441056267358363, 0.029235312715172768, -0.015236251056194305, 0.0011127976467832923, 0.00808207131922245, 0.008505674079060555, 0.012264307588338852, -0.02797122858464718, 0.006454898975789547, 0.01128934882581234, -0.01568002440035343, 0.00044923744280822575, -0.0025752356741577387, -0.015478309243917465, -0.005785875488072634, -0.014039404690265656, -0.00787363201379776, 0.010677478276193142, 0.017495466396212578, 0.0033955457620322704, 0.04556082934141159, -0.0227535180747509, 0.01670205034315586, 0.013528392650187016, -0.02580614760518074, -0.007752602454274893, -0.009003238752484322, -0.008384644985198975, -0.0035132132470607758, 0.0014767262618988752, -0.022740071639418602, 0.020682571455836296, -0.00619939249008894, 0.010610240511596203, -0.00484789814800024, -0.04962203651666641, 0.025402717292308807, 0.0242596622556448, 0.004269646480679512, -0.011961734853684902, -0.027446767315268517, -0.0074096862226724625, -0.015666577965021133, 0.012593776918947697, 0.007315552327781916, 0.018288880586624146, 0.022861100733280182, -0.011914667673408985, 0.0013691445346921682, -0.0323282852768898, -0.006350679323077202, -0.00943356566131115, 0.009722691029310226, 0.05483974516391754, 0.02778295986354351, 0.022350087761878967, -0.02112634666264057, -0.006172497291117907, -0.008720837533473969, -0.013837689533829689, 0.028778091073036194, -0.00202892255038023, 0.025348925963044167, -0.021045660600066185, -5.426359348348342e-05, -0.016379306092858315, 0.01957985945045948, 0.0002748374827206135, -0.008788076229393482, 0.011833981610834599, -0.0017364349914714694]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"�θ
t(s1:t)
=TX
t=1
Eσ(s1:t)h
∇θlogψθ
t(s1:t)i
−Eπθ
t(s1:t)h
∇θlogψθ
t(s1:t)i
B. SMC with Intermediate Potentials and Connection with Soft Reinforcement Learning
In the main text, we focused on settings where the target distribution is defined by a potential ϕ(s1:T)depending on full
sequences only, as in Eq. (1). This setting highlights the need for (learned) twist functions to summarize the future expected
value of the potential in the absence of intermediate target information.
In this appendix, we generalize our exposition to show how our twisted SMC framework can accommodate settings with
intermediate potentials , which is evocative of connections with soft reinforcement learning (Levine, 2018). We leverage
intuition from soft RL while introducing our general probabilistic interpretation, by using(sRL)=to instantiate the soft RL
special case. In particular, soft RL will correspond to the terminal potential
ϕt(s1:t)(sRL)=eβ rt(s1:t)(soft RL ϕtDefinition)
which corresponds to ϕ(s1:T) =eβrT(s1:T)if the potential is given at the final step only (as in RLHF, Korbak et al. (2022b)).
However, we defer detailed discussion of soft RL to App. B.3. See Table 5 for several examples of intermediate potentials .
Finally, we formalize a notion of conditional target distributions and twist functions in App. B.2, which generalizes the
exposition in the main text and captures our conditional twist learning experiments in Sec. 7.2.3.
B.1. Twisted SMC with Intermediate Potentials
To generalize the exposition in the main text, we might consider defining the target as
σ(s1:T):=1
Zσp0(s1:T) TY
t=1ϕt(s1:t)!
(sRL)=1
Zσp0(s1:T)eβPT
t=1rt(s1:t)(31)
where Eq. (1) and the main text exposition corresponds to ϕt(s1:t) = 1 fort < T .
Optimal Twists with Intermediate Potentials Using Eq. (31), the marginal distribution σ(s1:t) =P
st+1:Tσ(s1:T)over
ttokens becomes
σ(s1:t) =1
Zσp0(s1:t) tY
τ=1ϕτ(s1:τ)!
X
st+1:Tp0(st+1:T|s1:t)TY
τ=t+1ϕτ(s1:τ)
 (32)
(sRL)=1
Zσp0(s1:t)eβtP
τ=1rτ(s1:τ)
X
st+1:Tp0(st+1:T|s1:t)eβTP
τ=t+1rτ(s1:τ)
 (soft RL special case)
18
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
As in Prop. 3.2, the goal of the optimal twist functions is to facilitate sampling from the intermediate marginals σ(s1:t)of
the target distribution σ(s1:T).
We consider two different quantities involved in defining the optimal twists, which differ in their treatment of the intermediate
reward. For the soft RL setting, this corresponds to the natural distinction between Q-values and (soft) value functions Vt.
σ(s1:t) =1
Zσp0(s1:t) t−1Y
τ=1ϕτ(s1:τ)!
ϕt(s1:t)X
st+1:Tp0(st+1:T|s1:t)TY
τ=t+1ϕτ(s1:τ)
| {z }
Φ∗
t(s1:t):∝
| {z }
ψ∗
t(s1:t):∝
(sRL)=1
Zσp0(s1:t)
eβt−1P
τ=1rτ(s1:τ)
eβ rt(s1:t)X
st+1:Tp0(st+1:T|s1:t)eβTP
τ=t+1rτ(s1:τ)
| {z }
Φ∗
t(s1:t):∝","[0.016331173479557037, -0.026394572108983994, 0.00975750107318163, -0.016019033268094063, -0.004157707095146179, 0.009595188312232494, 0.04287557303905487, 0.023160800337791443, -0.03770653158426285, 0.01736747846007347, 0.008246743120253086, -0.015969090163707733, -0.027018852531909943, 0.023747622966766357, 0.03411067649722099, -0.033311598002910614, 0.03046487830579281, 0.0092081343755126, -0.048469122499227524, 0.006270895712077618, -0.023285655304789543, -0.030789505690336227, -0.016830597072839737, 0.04944299906492233, 0.0055966731160879135, -0.019402632489800453, 0.039629314094781876, -0.02080102078616619, 0.018528640270233154, 0.011093460954725742, 0.03645797073841095, -0.026494456455111504, -0.04190169274806976, -0.0572340190410614, -0.012985030189156532, 0.061778780072927475, -0.0052408333867788315, 0.04464852809906006, -3.343313801451586e-05, 0.04572229087352753, 0.0007823012419976294, -0.05189017951488495, -0.040128737688064575, 0.04549754783511162, 0.01438341848552227, 0.030614705756306648, -0.013734166510403156, -0.011592885479331017, 0.013784109614789486, 0.0599808506667614, -0.030489850789308548, 0.054487183690071106, -0.016418572515249252, -0.013746652752161026, -0.021412814036011696, 0.009426632896065712, 0.0011619416764006019, -0.007972059771418571, 0.01856609620153904, -0.027593189850449562, 0.013721681199967861, -0.008365356363356113, 0.015969090163707733, 0.014133705757558346, -0.014982727356255054, -0.02192472480237484, -0.054187532514333725, 0.025945089757442474, -0.03563392162322998, 0.04232620447874069, -0.002657873323187232, 0.0009691951563581824, 0.021287959069013596, 0.023298140615224838, -0.020551307126879692, 0.030714591965079308, 0.02809261344373226, 0.05578568950295448, 0.032637376338243484, -0.0291164331138134, -0.005453088320791721, -0.048494093120098114, 0.016743198037147522, -0.014246076345443726, -0.002545502968132496, -0.054137587547302246, -0.03406073525547981, -0.011798897758126259, -0.02080102078616619, -0.016206316649913788, 0.0026984517462551594, 0.003208800684660673, -0.013859023340046406, 0.0019586794078350067, 0.0413023866713047, -0.01771707460284233, 0.00020503706764429808, -0.007959573529660702, 0.023298140615224838, -0.009214377030730247, 0.015194982290267944, -0.005084763281047344, 0.012647919356822968, -0.02954094484448433, 0.047120679169893265, -0.009813686832785606, 0.004903721623122692, 0.009801200591027737, -0.06627359986305237, -0.011773926205933094, -0.018403783440589905, -0.009769986383616924, -0.00947033241391182, 0.02179986797273159, 0.03765658661723137, -0.05693436414003372, -0.055386148393154144, 0.0030433665961027145, -0.01926529034972191, -0.013784109614789486, -0.023323113098740578, -0.007984545081853867, 0.02886672131717205, 0.00012124694330850616, 0.014770472422242165, 0.02174992673099041, -0.007566277403384447, -0.05298891291022301, -0.0005126902251504362, 0.02187478169798851, 0.007023153360933065, 0.01103727612644434, -0.00782847497612238, -0.020513851195573807, -0.004778865724802017, -0.011867568828165531, 0.01063773687928915, 0.010656464844942093, 0.012104795314371586, -0.009295533411204815, -0.009233105927705765, -0.02821747027337551, -0.03635808452963829, 0.0007627924787811935, -0.007085581310093403, 0.028117585927248, -0.02981562726199627, -0.006735984701663256, -0.02844221144914627, -0.004120250232517719, -0.019028063863515854, -0.025270866230130196, -0.025620464235544205, 0.03166349604725838, -0.00183382339309901, -0.041577067226171494, -0.04147718474268913, 0.05853252112865448, 0.05049179121851921, -0.003945451695472002, 0.007609976921230555, 0.025770291686058044, -0.019502516835927963, 0.004160828422755003, 0.03446027263998985, -0.004516668152064085, 0.003358628135174513, 0.05086635798215866, -0.04412413388490677, -0.026544399559497833, -0.0028560825157910585, -0.05199006572365761, -0.05253943055868149, -0.04944299906492233, 0.02194969542324543, -0.03168846666812897, -0.0006383266299962997, -0.0853516012430191, -0.008140615187585354, 0.005253318697214127, 0.01247936300933361, 0.03853058069944382, -0.05653482303023338, -0.015294867567718029, 0.013347112573683262, 0.02097581885755062, -0.023622766137123108, 0.019789686426520348, 0.001450671348720789, -0.033236682415008545, 0.005743378773331642, 0.04502309486269951, 0.08030741661787033, -0.020963333547115326, -0.009713801555335522, -0.017030367627739906, 0.05288902670145035, 0.046346571296453476, 0.039654284715652466, 0.0028201863169670105, 0.020164253190159798, 0.03598351776599884, -0.01861603930592537, -0.013084915466606617, -0.01251681987196207, -0.000851362245157361, -0.013521911576390266, 0.010956119745969772, -0.07381490617990494, -0.00722292298451066, 0.012448149733245373, -0.014720529317855835, 0.027468333020806313, 0.025295838713645935, -0.033486396074295044, 0.02966579981148243, -0.030989274382591248, 0.001422578701749444, -0.02480890043079853, 0.03635808452963829, -0.011193346232175827, 0.01776701770722866, 0.033461425453424454, 0.013809080235660076, -0.046746108680963516, 0.02202460914850235, 0.0034678771626204252, -0.033211711794137955, 0.04549754783511162, -0.00898339319974184, 0.071167953312397, 0.02187478169798851, -0.020251654088497162, -0.05833275243639946, -0.003817474003881216, -0.011130917817354202, -0.02856706641614437, 0.005381296388804913, 0.0034491487313061953, -0.0729159414768219, 0.01230456493794918, -0.0005723870126530528, 0.033061884343624115, -0.010949877090752125, 0.02142529934644699, 0.01457070279866457, -0.02490878477692604, 0.025695377960801125, 0.01274156104773283, -0.007104309741407633, 0.032862115651369095, -0.02538323774933815, 0.019427603110671043, 0.023273169994354248, -0.03550906479358673, -0.011792655102908611, 0.005930663086473942, 0.027693074196577072, -0.03573380410671234, 0.0034647558350116014, 0.009158192202448845, -0.0423012338578701, -0.015269896015524864, 0.019664829596877098, 7.276767428265885e-05, -0.025071097537875175, -0.02991551160812378, 0.023760108277201653, 0.06847106665372849, -0.019914541393518448, 0.011517971754074097, 0.022911086678504944, -0.020626220852136612, 0.031238986179232597, -0.021737439557909966, -0.046895936131477356, 0.017305050045251846, 0.026194801554083824, -0.03560894727706909, 0.0507664754986763, -0.005031699314713478, -0.05129086971282959, 0.03688248246908188, 0.005190890748053789, -0.0036801323294639587, 0.002284865826368332, -0.01482041459530592, -0.005734014790505171, -0.01686805486679077, -0.06782181560993195, -0.0023348084650933743, 0.006358294747769833, 0.017379963770508766, -0.024047277867794037, 0.014221105724573135, 0.027168679982423782, 0.0079033887013793, -0.010831262916326523, 0.005019213538616896, 0.015432209707796574, 0.062028490006923676, -0.00034374435199424624, -0.02909146249294281, 0.02057627961039543, 0.027792958542704582, -0.0087087107822299, 0.02879180759191513, -0.002760879695415497, -0.0004853779391851276, 0.020351538434624672, -0.02272380329668522, -0.022686347365379333, 0.011056004092097282, -0.012473120354115963, -0.01919037662446499, -0.021662525832653046, 0.03475992754101753, -0.0038674164097756147, 0.011268259957432747, -0.039704225957393646, -0.033336568623781204, 0.006517486646771431, -0.006336444988846779, -0.01485787145793438, -0.005474938545376062, -0.030240138992667198, -0.010107098147273064, -0.0003843225713353604, -0.030340023338794708, 0.00017235989798791707, 0.0063458094373345375, -0.015482151880860329, 0.054437242448329926, 0.016668284311890602, -0.047570157796144485, -0.05184023827314377, -0.032837145030498505, 0.047944728285074234, -0.0017838809872046113, 0.046296626329422, -0.07201697677373886, 0.006860840599983931, -0.011592885479331017, -0.03510952368378639, -0.024272019043564796, 0.02844221144914627, 0.014283533208072186, 0.013097400777041912, 0.07686138898134232, 0.025670405477285385, 0.00544372433796525, -0.023672709241509438, 0.016118917614221573, -0.01113716047257185, -0.016243774443864822, -0.0065050008706748486, -0.008796109817922115, -0.03488478437066078, -0.04147718474268913, -0.015519608743488789, -0.032512519508600235, -0.0065736714750528336, 0.019053034484386444, 0.005783956963568926, 0.0028170649893581867, 0.03466004133224487, 0.015706893056631088, 0.04856900870800018, -0.009894843213260174, -0.015057641081511974, -0.009258076548576355, 0.03413564711809158, 0.01573186367750168, 0.027942785993218422, -0.033811021596193314, -0.01891569420695305, 0.022861145436763763, -0.0027686832472682, 0.033086854964494705, 0.0060211834497749805, 0.003889266401529312, 0.027243591845035553, -0.022037094458937645, 0.0026250986848026514, 0.008203043602406979, -0.019377660006284714, -0.0006367659079842269, -0.020788533613085747, -0.012754046358168125, -0.001974286511540413, 0.02944105863571167, -0.004135856870561838, -0.04896854609251022, 0.0375816747546196, -0.009226863272488117, -0.019277775660157204, -0.03470998629927635, 0.03635808452963829, 0.04886866360902786, 0.024034792557358742, -0.0495179146528244, -0.017280079424381256, -0.048019640147686005, -0.02894163504242897, -0.027193650603294373, 0.01719268038868904, -0.006929511670023203, 0.04257591813802719, -0.0035303051117807627, 0.05368810519576073, 0.03498466685414314, -0.020813506096601486, 0.03183829411864281, -0.008502697572112083, 0.011124675162136555, -0.04469846934080124, 0.022936059162020683, 0.0075787631794810295, 0.048269353806972504, 0.07111801207065582, -0.00523771159350872, -0.040253594517707825, -0.013784109614789486, 0.023110857233405113, -0.004591581877321005, 0.02249906212091446, 0.033835992217063904, -0.03680756688117981, 0.02523341029882431, -0.020988304167985916, 0.032562460750341415, 0.05963125452399254, 0.01911546289920807, -0.030489850789308548, -0.031588584184646606, 0.006448815576732159, 0.04352482408285141, 0.0121921943500638, -0.007441421505063772, -0.0584825798869133, 0.00750384945422411, -0.014470817521214485, -0.025920119136571884, 0.013883993960916996, -0.014171162620186806, 0.03890514746308327, -0.015282382257282734, -0.0413023866713047, -0.016468513756990433, -0.009788715280592442, -0.014658101834356785, 0.012136009521782398, 0.054487183690071106, -0.0303649939596653, 0.026594340801239014, -0.0011393115855753422, 0.08540154993534088, 0.004479211289435625, 0.02510855346918106, -0.023697679862380028, 0.013971392996609211, -0.009913571178913116, -0.016443543136119843, -0.02523341029882431, 0.021362872794270515, 0.02941608801484108, 0.05199006572365761, -0.027668103575706482, 0.0050441850908100605, 0.04327511042356491, 0.01794181577861309, 0.008895994164049625, 0.013359598815441132, -0.026094917207956314, 0.01430850476026535, 0.015844233334064484, 0.05843263864517212, -0.04607188701629639, 0.046496398746967316, 0.004004758317023516, 0.008071944117546082, 0.023148313164711, -0.0020086218137294054, 0.004881871864199638, 0.012117280624806881, 0.06028050556778908, 0.026918966323137283, -0.03580871969461441, 0.010150797665119171, 0.013409540988504887, -0.013709195889532566, -0.05298891291022301, -0.001122143818065524, -0.013559368439018726, 0.0487687774002552, -0.04290054365992546, 0.01485787145793438, -0.03485981374979019, -0.03843069449067116, -0.033361539244651794, 0.05858246609568596, -0.008908480405807495, 0.005915055982768536, 0.039329659193754196, 0.025395723059773445, 0.06507498025894165, 0.027867872267961502, 0.0014358446933329105, -0.0008872583857737482, 0.07676150649785995, 0.0015677239280194044, 0.002646948443725705, -0.023148313164711, 0.0242595337331295, -0.002729665720835328, 0.0022146343253552914, -0.054087646305561066, -0.016618341207504272, 0.010082126595079899, 0.013072429224848747, 0.006636099889874458, -0.027568219229578972, -0.03598351776599884, 0.0010441087651997805, 0.031763382256031036, -0.0013148904545232654, -0.011293230578303337, -0.11007310450077057, -0.054836783558130264, -0.05293897166848183, 0.011998667381703854, -0.026094917207956314, -0.002327004913240671, 0.02954094484448433, -0.015769321471452713, 0.026344629004597664, -0.05208994820713997, -0.02839226834475994, -0.013097400777041912, 0.001975847175344825, -0.012310807593166828, -0.017255106940865517, 0.001038646325469017, 0.014545731246471405, 0.005178404971957207, 0.0018447482725605369, 0.013734166510403156, -8.339994565176312e-06, -0.006860840599983931, 0.015294867567718029, 0.02841723896563053, -0.027018852531909943, -0.004872507881373167, -0.021362872794270515, -0.02458415925502777, -0.011954967863857746, -0.016068974509835243, -0.016056489199399948, 0.011093460954725742, 0.04392436146736145, 0.019252805039286613, -0.033511366695165634, -0.019852112978696823, 0.005968119949102402, -0.02234923467040062, 0.015781806781888008, 0.0243843887001276, 2.493463398423046e-05, 0.0035708833020180464, 0.02284866012632847, -0.047120679169893265, 0.006405116058886051, 0.016443543136119843, -0.08395321667194366, -0.016418572515249252, -0.02212449349462986, 0.011105946265161037, -0.02971574291586876, -0.02841723896563053, 0.010781320743262768, -0.012729075737297535, -0.009807443246245384, 0.015769321471452713, -0.05703425034880638, -0.023635253310203552, -0.003236893331632018, -0.0038049884606152773, -0.0014834461035206914, -0.01766713336110115, 0.01402133610099554, 0.01575683429837227, -0.004413662012666464, -0.007091824430972338, 0.0015091976383700967, -0.046945881098508835, -0.007491363678127527, -0.032287776470184326, -0.013322141952812672, -0.038930121809244156, -0.00848396960645914, 0.016331173479557037, 0.017854416742920876, 0.03500964120030403, -0.01904054917395115, -0.05913183093070984, 0.06702273339033127, -0.05983102321624756, 0.02771804668009281, 0.040028855204582214, 0.011798897758126259, 0.031738411635160446, 0.03535923734307289, 0.016056489199399948, -0.007634948007762432, 0.006220953073352575, -0.01831638440489769, 0.026369599625468254, 0.006517486646771431, 0.046821024268865585, -0.023323113098740578, -0.020239166915416718, -0.001281335367821157, 0.03451021388173103, -0.009414146654307842, 0.006330202333629131, 0.03019019588828087, -0.009676344692707062, -0.030414937064051628, 0.04235117509961128, 0.01412122044712305, -0.03168846666812897, -0.0007093385211192071, -0.013559368439018726, 0.030489850789308548, -0.025071097537875175, -0.033985819667577744, 0.0008552640210837126, -0.008590096607804298, 0.023497911170125008, -0.015057641081511974, 0.01264167670160532, 0.015382266603410244, -0.019327718764543533, -0.01408376358449459, 0.03750675916671753, 0.04272574558854103, -0.025645434856414795, 0.06043033301830292, 0.00046547901001758873, -0.02287363074719906, -0.01806667260825634, 0.012691618874669075, 0.041052673012018204, -0.02834232524037361, 0.03166349604725838, -0.018453726544976234, 0.021837325766682625, 0.0007101188530214131, 0.033011943101882935, -0.03922977298498154, -0.013971392996609211, -0.008746166713535786, -0.005353203509002924, 0.009807443246245384, 0.002139720832929015, 0.01824147067964077, 0.0015294867334887385, 0.04989248141646385, -0.02921631932258606, -0.02961585856974125, -0.03573380410671234, 0.040403421968221664, 0.027593189850449562, 0.021312929689884186, 0.007616219576448202, -0.04859397932887077, -0.0021553277038037777, -0.016880540177226067, -6.35497854091227e-05, 0.01861603930592537, 0.009557731449604034, -0.0221494659781456, -0.040178678929805756, -0.010194497182965279, -0.005911934655159712, -0.010194497182965279, 0.020189225673675537, 0.006735984701663256, -0.020076854154467583, -0.022336749359965324, -0.020476393401622772, 0.015694407746195793, 0.0303649939596653, -0.048019640147686005, 0.01081253495067358, -0.018853265792131424, -0.01132444478571415, 0.03618328645825386, -0.001496712095104158, -0.0413023866713047, -0.005515516735613346, 0.03548409417271614, -0.02505861222743988, -0.015706893056631088, -0.021113160997629166, -0.01739244908094406, -0.013621795922517776, 0.032587431371212006, 0.03728201985359192, -0.021662525832653046, -0.01409624982625246, 0.013521911576390266, -0.019889570772647858, 0.007060610223561525, -0.008721196092665195, 0.032862115651369095, 0.008877266198396683, 0.0291164331138134, 0.004098400007933378, -3.348190875840373e-05, -0.02495872601866722, -0.026044974103569984, -0.04437384381890297, -0.01398387923836708, -0.023797566071152687, -0.013759138062596321, -0.04382447898387909, 0.01066270750015974, 0.00431689852848649, 0.009869871661067009, 0.004245106130838394, 0.0035490335430949926, -0.016381114721298218, -0.0014654980041086674, 0.005743378773331642, 0.02791781537234783, -0.0023878721985965967, -0.001768273999914527, -0.033411480486392975, -0.012710346840322018, 0.034185588359832764, -0.010175769217312336, -0.055535975843667984, 0.023298140615224838, 0.05059167742729187, 0.04434887319803238, 0.032637376338243484, 0.03763161599636078, 0.011224559508264065, -0.00626465305685997, -0.0291164331138134, 0.00899587944149971, -0.011792655102908611, 0.0006231098086573184, 0.013147342950105667, 0.0027936543338000774, 0.0003927113430108875, -0.025420693680644035, -0.027293534949421883, 0.017017880454659462, -0.002328565577045083, 0.019302746281027794, -0.02959088608622551, 0.009907328523695469, -0.01434596162289381, 0.013759138062596321, -0.016693254932761192, -0.013059943914413452, 0.023735137656331062, 0.0008739924523979425, -0.01761719025671482, 0.024671558290719986, -0.019078006967902184, 0.012485606595873833, 0.03453518822789192, 0.025096068158745766, -0.030914360657334328, -0.00024190862313844264, -0.017080308869481087, -0.0037831387016922235, -0.010993576608598232, 0.010294382460415363, -0.011299473233520985, -0.05238960310816765, -0.027767987921833992, -0.02418462000787258, -0.007784775458276272, -0.027068793773651123, -0.016730712726712227, -0.04222632199525833, -0.00611482560634613, 0.003508455352857709, -0.021262986585497856, -0.016431057825684547, 0.019789686426520348, 0.030889390036463737, -0.013459483161568642, -0.12995019555091858, -0.03598351776599884, 0.02836729772388935, -0.002863885834813118, 0.019315233454108238, -0.03565889224410057, -0.008009516634047031, -0.008146857842803001, 0.012747803702950478, -0.03500964120030403, -0.008415298536419868, -0.013022487051784992, 0.010544094257056713, 0.04322516918182373, 0.02829238399863243, -0.05708419159054756, 0.002561110071837902, -0.00726037984713912, 0.02117558754980564, -0.018728408962488174, -0.008415298536419868, 0.03006533905863762, 0.01497024204581976, 0.053937818855047226, -0.061828721314668655, -0.0018463090527802706, 0.01092490553855896, 0.008346627466380596, -0.01769210398197174, 0.006773441564291716, -0.019302746281027794, -0.02087593264877796, 0.002273940946906805, 0.02465907298028469, -0.03473495692014694, 0.025920119136571884, 0.012597976252436638, -0.011680284515023232, 0.00917067751288414, 0.015669435262680054, 0.02989054098725319, -0.033336568623781204, 0.08500200510025024, 0.0214003287255764, 0.022561490535736084, -0.025220924988389015, 0.001975847175344825, -0.02796775847673416, 0.027343478053808212, -0.032737258821725845, 0.019003093242645264, 0.008852294646203518, 0.0063270810060203075, -0.032387662678956985, -0.003817474003881216, 0.01563197933137417, -0.004295048303902149, 0.008789867162704468, 0.032587431371212006, 0.014333476312458515, -0.011880054138600826, 0.01746736280620098, 0.06647336483001709, -0.020451422780752182, -0.025795262306928635, -0.026419542729854584, -0.004878750536590815, -0.025645434856414795, 0.0017791988793760538, -0.0019149798899888992, -0.004313776735216379, -0.011224559508264065, -0.011742712929844856, 0.000729237450286746, 0.0047382875345647335, -0.012104795314371586, -0.016481000930070877, 0.011318202130496502, -0.023847507312893867, 0.0029684528708457947, 0.048643920570611954, -0.04484829679131508, 0.02829238399863243, 0.011586642824113369, -0.025620464235544205, -0.009407903999090195, -0.01824147067964077, 0.013159829191863537, -0.00754130631685257, 0.053238626569509506, 0.05333850905299187, -0.01118710357695818, 0.007634948007762432, -0.04934311658143997, 0.008065701462328434, -0.008640039712190628, -0.023522881790995598, -0.003116719424724579, 0.015869205817580223, 0.002094460418447852, 0.040478333830833435, 0.0390799455344677, -0.0171677079051733, 0.0017464241245761514, -0.025770291686058044, 0.03148869797587395, -0.009102007374167442, 0.04444875940680504, 0.00748512102290988, -0.008615068159997463, 0.004126492887735367, -0.017779503017663956, -0.04247603192925453, 0.0073103224858641624, 0.004117128439247608, -0.0021303566172719, 0.054387301206588745, 0.010281897149980068, 0.019639858976006508, 0.012292079627513885, -0.013397055678069592, 0.015969090163707733, 0.007329050917178392, -0.005047306418418884, -0.03126395866274834, -0.03555900603532791, -0.004831929691135883, 0.0031416907440871, -0.004410540219396353, 0.0031916331499814987, 0.008571368642151356, -0.015794292092323303, 0.04247603192925453, -0.009688830003142357, -0.025545550510287285, 0.03468501567840576, 0.03750675916671753, 0.009370447136461735, -0.02944105863571167, 0.015819262713193893, 0.00613355403766036, 0.003130765864625573, 0.015869205817580223, 0.026943938806653023, 0.02966579981148243, -0.007547548972070217, -0.002881053602322936, -0.031164072453975677, -0.016381114721298218, 0.007722347509115934, 0.03673265501856804, 0.0026984517462551594, -0.005265804473310709, 0.016855567693710327, -0.0018853265792131424, 0.010188254527747631, -0.02115061692893505, -0.02067616395652294, -0.019927026703953743, 0.009339233860373497, -0.0011018547229468822, 0.0450480654835701, -0.0022770625073462725, -0.027043823152780533, -0.007566277403384447, -0.010363053530454636, -0.007965817116200924, 0.002509606769308448, -0.006211589090526104, 0.013034973293542862, -0.009688830003142357, -0.06058016046881676, 0.01826644130051136, 0.02120056003332138, 0.0010690800845623016, 0.03868040814995766, 0.0038393239956349134, 0.0009013047092594206, -0.0017667132196947932, 0.03815601393580437, 0.010050913318991661, 0.025320809334516525, -0.03818098455667496, 0.0040765502490103245, 0.048094555735588074, -0.021362872794270515, 0.006342688109725714, -0.006467544008046389, 0.019390147179365158, 0.030639678239822388, -0.004054700490087271, 0.0170428529381752, 0.0020320324692875147, 0.0582328662276268, 0.014658101834356785, 0.012797746807336807, -0.024059763178229332, 0.012560519389808178, 0.006480029784142971, -0.047645073384046555, -0.04132735729217529, 0.027068793773651123, 0.001469399780035019, -0.02904151938855648, -0.020351538434624672, -0.0029793777503073215, -0.04929317161440849, -0.007035639137029648, 0.024796413257718086, -0.006177253555506468, 0.02834232524037361, -0.010506637394428253, -0.021437786519527435, 0.022736288607120514, -0.019589915871620178, -0.039579372853040695, 0.0005950171616859734, -0.017180193215608597, -0.0335862822830677, -0.013634282164275646, -0.03688248246908188, -0.0420515201985836, 0.00733529357239604, -0.008034487254917622, -0.012029881589114666, -0.005228347610682249, 0.024596644565463066, 0.005802685394883156, 0.012597976252436638, -0.01096236240118742, -0.0009652934386394918, 0.018478697165846825, -0.020688649266958237, 6.686627602903172e-05, -0.013671739026904106, -0.00905830692499876, -0.000860726460814476, -0.02445930242538452, 0.0034304202999919653, 0.003720710752531886, 0.009957270696759224, 0.03520940989255905, 0.010150797665119171, -0.02816752716898918, 0.021837325766682625, -0.018328869715332985, 0.041102614253759384, 0.03840572386980057, -0.05154058337211609, -0.02470901422202587, -0.033486396074295044, 0.016680769622325897, 0.040528278797864914, -0.01881580799818039, 0.023260684683918953, 0.02169998362660408, -0.004485453944653273, 0.039354629814624786, 0.032637376338243484, 0.0012204679660499096, 0.013209771364927292, -0.0019102977821603417, -0.008140615187585354, 0.00278741167858243, 4.499207716435194e-05, -0.019789686426520348, 0.024147162213921547, 0.022436633706092834, -0.006202225107699633, 0.008159344084560871, -0.038930121809244156, -0.0179168451577425, 0.021312929689884186, 0.04614679887890816, 0.021088188514113426, -0.014683072455227375, 0.0063645378686487675, -0.019252805039286613, 0.015332324430346489, 0.00065471394918859, -0.04527280852198601, -0.04187672212719917, -0.027043823152780533, -0.01128698792308569, 0.054037705063819885, 0.010712649673223495, 0.021312929689884186, 0.0012899191351607442, 0.014733015559613705, 0.0033555065747350454, 0.05353827774524689, 0.025945089757442474, -0.003442905843257904, -0.013072429224848747, -0.010981090366840363, -0.018353840336203575, 0.024371903389692307, 0.01412122044712305, 0.006305231247097254, -0.019202861934900284, -0.00924559123814106, 0.01721765100955963, -0.023897450417280197, 0.016068974509835243, 0.01826644130051136, -0.0020616857800632715, 0.01914043352007866, -0.004160828422755003, -0.0037082249764353037, -0.032187893986701965, -0.005084763281047344, -0.013446997851133347, 0.0003683253889903426, 0.03828086704015732, 0.03453518822789192, -0.0054000248201191425, -0.019777201116085052, -0.010606522671878338, 0.016056489199399948, 0.013397055678069592, -0.010150797665119171, -0.015232439152896404, 0.02202460914850235, 0.020638706162571907, -0.0030043490696698427, 0.00914570689201355, -0.01941511780023575, -0.003901751944795251, 0.008577611297369003, 0.0036457970272749662, 0.005471816752105951, 0.016555914655327797, -0.004160828422755003, -0.018903207033872604, 0.003911116160452366, 0.0180417001247406, -0.021088188514113426, -0.005846384912729263, -0.03803115710616112, -0.005677829496562481, 0.009039578959345818, -0.025720348581671715, 0.002581399166956544, -0.0027920936699956656, 0.012391963973641396, 0.006030547898262739, -0.025695377960801125, 0.01245439238846302, 0.0033617494627833366, -0.02991551160812378, 0.06532469391822815, -0.0022052701096981764, -0.01457070279866457, -0.0021178708411753178, -0.00013304974709171802, 0.027668103575706482, -0.023110857233405113, -0.010856234468519688, -0.03198812156915665, -0.0005950171616859734, -0.02460912987589836, 0.04167695343494415, -0.02764313295483589, -0.0075600347481667995, 0.033361539244651794, -0.01226710807532072, -0.02545815147459507, 0.02764313295483589, -0.00391423748806119, 0.0040952786803245544, 0.008340384811162949, 0.013621795922517776, -0.0380810983479023, 0.01504515577107668, -0.01464561652392149, -0.004685223568230867, -0.015607007779181004, 0.02443433180451393, 0.001918101217597723, -0.013234742917120457, -0.018578581511974335, -0.010906176641583443, -0.04854403808712959, -0.010581551119685173, 0.006480029784142971, -0.009514031931757927, -0.040678106248378754, -0.013334627263247967, 0.0031853902619332075, 0.02289860136806965, -0.006436329800635576, -0.013834051787853241, -0.0061866180039942265, 0.002882614266127348, -0.005621644202619791, 0.005496788304299116, -0.01766713336110115, -0.011736470274627209, 0.0016777532873675227, 0.011418086476624012, -0.016393600031733513, 0.007016910705715418, 0.030964303761720657, -0.03004036843776703, 0.002890417817980051, -0.025970060378313065, -0.012697861529886723, 0.02991551160812378, 0.010369296185672283, 0.015694407746195793, -0.03543414920568466, 0.003308685729280114, -0.00254082097671926, 0.014283533208072186, 0.009414146654307842, -0.0029981061816215515, 0.01449578907340765, 0.026719197630882263, 0.0015692845918238163, 0.05238960310816765, -0.02165004052221775, 0.006139796692878008, 0.01212976686656475, 0.01518249697983265, 0.001963361632078886, 0.015282382257282734, 0.006252167280763388, 0.02515849657356739, -0.020551307126879692, 0.02483387105166912, -0.013359598815441132, 0.026719197630882263, 0.002170934807509184, -0.004151463974267244, 0.010631493292748928, 0.03545911982655525, 0.0058619920164346695, 0.002058564219623804, -0.0184162687510252, 0.024222075939178467, -0.0015747470315545797, 0.005234590265899897, 0.041052673012018204, 0.004682102240622044, -0.0073727504350245, -0.03715716302394867, 0.03009031154215336, -0.02894163504242897, 0.016118917614221573, 0.018403783440589905, -0.020051883533596992, -0.03043990768492222, 0.05958131328225136, -0.01098733302205801, -0.03575877472758293, 0.004785108380019665, -0.04317522794008255, -0.012548034079372883, 0.03660779818892479, 0.047620102763175964, -0.011455543339252472, -0.00873368140310049, 0.01459567341953516, 0.0012860174756497145, 0.017729559913277626, 0.0047913515008986, -0.062278203666210175, 0.009826172143220901, 0.007191709242761135, -0.041577067226171494, 0.02884175069630146, -0.03755670413374901, 0.026369599625468254, -0.006748470012098551, 0.008689981885254383, -0.01590666174888611, -0.02145027182996273, -0.013496940024197102, -0.0020070611499249935, 0.004563488997519016, -0.021587613970041275, 0.0008458998054265976, 0.02229929342865944, 0.008015759289264679, 0.023585310205817223, -0.008577611297369003, -0.007703619077801704, -0.006661070976406336, -0.017092794179916382, 0.0059525128453969955, 0.019102977588772774, -0.009857386350631714, 0.010843749158084393, 0.016693254932761192, 0.0013172314502298832, -0.0033992063254117966, 0.0028498396277427673, -0.024771442636847496, 0.0121921943500638, 0.016805626451969147, -0.020089339464902878, -0.012504334561526775, -0.009632645174860954, 0.04517292231321335, 0.026144858449697495, -0.0026110524777323008, 0.004051579162478447, -0.02796775847673416, 0.038980063050985336, -0.005109734367579222, 0.040203653275966644, -0.02160009928047657, 0.023410512134432793, -0.0015123190823942423, 0.0030105917248874903, 0.003602097276598215, -0.005321989767253399, -0.005465574096888304, -0.011380629613995552, -0.03396084904670715, -0.004126492887735367, 0.016406087204813957, 0.009052064269781113, -0.0388302356004715, -0.009701316244900227, -0.013534396886825562, 0.008858537301421165, -0.003112037433311343, -0.019877085462212563, -0.009951028041541576, -0.024421846494078636, -0.04170192405581474, 0.026794111356139183, 0.013010001741349697, -0.017092794179916382, 0.011674041859805584, 0.00918316375464201, 0.013771623373031616, -0.0025314567610621452, 0.022711317986249924, 0.00173862068913877, 0.009495303966104984, -0.012185951694846153, -0.025495607405900955, 0.010612765327095985, -0.00972004421055317, -0.00954524613916874, 0.007566277403384447, -0.013434512540698051, 0.04220134764909744, 0.0076287053525447845, -0.01824147067964077, 0.022386692464351654, 0.007054367568343878, -0.0022895480506122112, -0.011018547229468822, -0.009514031931757927, -0.0043637193739414215, -0.0018946907948702574, 0.021462757140398026, 0.02192472480237484, -0.009201891720294952, -0.0034366631880402565, 0.01463313028216362, 0.01909049227833748, 0.03014025278389454, -0.0003019956056959927, 0.011443058028817177, -0.0023894328624010086, -0.007872174493968487, -0.025370752438902855, 0.0057745929807424545, 0.00701066805049777, 0.010974847711622715, -0.03693242371082306, 0.008465240709483624, 0.014133705757558346, -0.02082599140703678, 0.003936087246984243, 0.010862477123737335, 0.03453518822789192, -0.04132735729217529, -0.006267774384468794, 0.0024175255093723536, 0.026694225147366524, -0.011892539449036121, 0.02060125023126602, -0.012323292903602123, -0.023835022002458572, 0.022436633706092834, -0.02465907298028469, 0.013172314502298832, 0.0145582165569067, 0.02799272909760475, -0.020014427602291107, 0.07551294565200806, -0.0029590886551886797, 0.013609310612082481, -0.030864419415593147, 0.012473120354115963, 0.009114492684602737, 0.033461425453424454, 0.01796678639948368, -0.010050913318991661, 0.025495607405900955, -0.04374956339597702, 0.019589915871620178, -0.032088007777929306, 0.021412814036011696, 0.025795262306928635, -0.033036913722753525, -0.008302927948534489, 0.011393115855753422, 0.0066111283376812935, -0.007597491145133972, 0.01114964671432972, -0.008902236819267273, -0.009482817724347115, -0.02530832402408123, -0.015157526358962059, 0.00733529357239604, 0.010288139805197716, -0.013584339991211891, -0.0058619920164346695, -0.0018041700823232532, 0.021387843415141106, 0.007029396481812, -0.007909631356596947, 0.008871023543179035, -0.026619313284754753, 0.020264139398932457, -0.02145027182996273, 0.015132554806768894, 0.004285684321075678, 0.001328936661593616, -0.01871592365205288, -0.04322516918182373, 0.012448149733245373, 0.005446845665574074, 0.0345851294696331, -0.020089339464902878, -0.018079157918691635, 0.015856720507144928, -0.04310031235218048, -0.01819152757525444, -0.002317640697583556, 0.0011159010464325547, -0.025220924988389015, 0.012729075737297535, 0.02282368764281273, -0.0013336187694221735, 0.004369962029159069, -0.008053216151893139, 0.006277138367295265, 0.026319658383727074, 0.0445486418902874, -0.019427603110671043, 0.025046126917004585, -0.0010409874375909567, -0.007435178384184837, 0.027418391779065132, 0.013996364548802376, 0.008134372532367706, 0.0115741565823555, -0.025920119136571884, 0.02142529934644699, 0.005156555213034153, 0.0009301776881329715, 0.0042607132345438, 0.025270866230130196, -0.026893995702266693, 0.0025220925454050303, 0.016580885276198387, 0.022236865013837814, 0.03700733557343483, -0.011567913927137852, 0.015607007779181004, 0.012217165902256966, -0.026020003482699394, -0.006146039813756943, 0.012217165902256966, 0.023023458197712898, -0.009407903999090195, -0.00858385395258665, 0.014945270493626595, 0.023797566071152687, 0.006567428819835186, 0.02791781537234783, 0.015944119542837143, -0.023585310205817223, 0.003945451695472002, 0.012473120354115963, -0.004760137293487787, -0.019627373665571213, -0.03603345900774002, 0.008914723061025143, 0.013509426265954971, -0.016093946993350983, -0.012585490942001343, -0.009426632896065712, 0.02085096202790737, 0.02197466604411602, -0.005359446629881859, -0.03463507071137428, 0.026369599625468254, -0.007940845564007759, 0.01819152757525444, -0.02530832402408123, -0.05179029330611229, -0.0008084430010057986, -0.023710167035460472, -0.007884660735726357, 0.028117585927248, -0.01470804400742054, 0.03663276880979538, -0.022536519914865494, 0.011374386958777905, -0.03778144344687462, 0.016493486240506172, -0.016855567693710327, 0.019939513877034187, 0.03778144344687462, 0.00349596980959177, -0.0028482789639383554, -0.03406073525547981, -0.05208994820713997, -0.010893691331148148, -0.009975999593734741, 0.020638706162571907, 0.01492029894143343, 0.017305050045251846, -0.04270077496767044, -0.01205485314130783, -0.02092587575316429, 0.012985030189156532, -0.004747651983052492, -0.022311778739094734, 0.011243288405239582, -0.004891236312687397]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"eβV∗
t(s1:t)=| {z }
ψ∗
t(s1:t):∝eβrt(s1:t)+βV∗
t(s1:t)=(33)
where :∝means ‘defined to be proportional to’ and Q∗
t(st,s1:t−1) =rt(s1:t) +V∗
t(s1:t)in RL notation. See App. B.3 for
detailed derivations in the soft RL special case. In general, Φtcaptures the expectation of future potentials from t+ 1 : T,
analogous to the (soft) value function. The twists ψtplay a role analogous to a Q-value, estimating both the immediate ϕt
and future value Φt. In particular,
ψ∗
t(s1:t)∝ϕt(s1:t)Φ∗
t(s1:t) where Φ∗
t(s1:t) :∝X
st+1:Tp0(st+1:T|s1:t)TY
τ=t+1ϕτ(s1:τ) (34)
We continue to refer to ψtas the twist functions and focus on probabilistic interpretations based on ψtinstead of Φ∗
t(see
App. B.4 for additional discussion).
To show that this notation is consistent with the main text, consider the optimal twists ψ∗
t(s1:t) =ϕt(s1:t)Φ∗
t(s1:t)with no
intermediate potentials ,ϕt(s1:t) = 1 fort < T . For t < T ,ψ∗
t(s1:t) =Φ∗
t(s1:t)reflect the future expected potential and
fort=T, the terminal potential is ψ∗
T(s1:T) =ϕT(s1:T), with no future potentials after step T, i.e.ΦT= 1.
Building on Eq. (32)-(33) above, the following generalization of Prop. 3.2 defines the ‘optimal’ twists so as to obtain the
intermediate target marginals σ(s1:t)(see Prop. A.4).
Proposition B.1 (Optimal Twists ).For a given target distribution σ(s1:T)in Eq. (31), the optimal twist functions yield
intermediate {πt}T−1
t=1which match the target marginals. In regions where p0(s1:t)>0, the optimal twists are given by
π∗
t(s1:t) =σ(s1:t) =1
Zψ∗
tp0(s1:t) t−1Y
τ=1ϕτ(s1:τ)!
ψ∗
t(s1:t) =1
ZΦ∗
tp0(s1:t) t−1Y
τ=1ϕτ(s1:τ)!
ϕt(s1:t)Φ∗
t(s1:t).(35)
Up to a constant ctindependent of s1:t, the optimal twists ψ∗
tare given by
ψ∗
t(s1:t) =ctϕt(s1:t)X
st+1:Tp0(st+1:T|s1:t)TY
τ=t+1ϕτ(s1:τ) (36)
where ctis absorbed into the normalization constant Zψ∗
t. The optimal twists satisfy the recursion
ψ∗
t(s1:t) =Zψ∗
t
Zψ∗
t+1ϕt(s1:t)X
st+1p0(st+1|s1:t)ψ∗
t+1(s1:t+1). (37)
Remark B.2 (Equivalence Class of ψtandΦt).Note that any rescaling of ψt←ct¯ψtby a constant with respect to s1:t
will yield the same intermediate marginals πt(s1:t), due to the normalization constant Zψ
twhich scales with ψt. This defines
an equivalent class in the space of functions. The same statement holds for Φt. We express results such as Eq. (36) using
proportionality ∝. We define ψtandΦtas the members of their equivalent classes whose normalization Zψ
tandZΦ
tare
equal. Thus, we have ψt(s1:t) =ϕt(s1:t)Φt(s1:t).
","[0.01440536230802536, -0.029127037152647972, 0.012711776420474052, -0.00020665286865551025, 0.006510749459266663, -0.005308105610311031, 0.02521267905831337, 0.01698857545852661, -0.046207867562770844, -0.000367794738849625, 0.032527387142181396, 0.001565083977766335, -0.020982010290026665, 0.019163217395544052, 0.03830007463693619, -0.028995240107178688, 0.02738732285797596, 0.009014884009957314, -0.05561814084649086, 0.006474505178630352, -0.014036332257091999, -0.053746629506349564, 0.005205963272601366, 0.020138511434197426, -0.04212217405438423, -0.027835430577397346, 0.028415335342288017, 0.013344400562345982, 0.018965521827340126, 0.014800751581788063, 0.030524080619215965, -0.026095716282725334, 0.00946958176791668, -0.06689992547035217, -0.00303461542353034, 0.059255726635456085, -0.013001728802919388, 0.032369229942560196, -0.002095564967021346, 0.04243848845362663, 0.006556877866387367, -0.0200989730656147, -0.0800795778632164, 0.03634948655962944, 0.0036309948191046715, 0.003953896462917328, -0.02160145342350006, 0.006668905261904001, -0.008349311538040638, 0.05878125876188278, -0.024395540356636047, 0.02219453826546669, -0.0023723377380520105, 0.019084138795733452, -0.012085743248462677, 0.02596391923725605, -0.015472914092242718, -0.01440536230802536, 0.03250102698802948, -0.0285471323877573, 0.030629517510533333, -0.007967101410031319, 0.03339724615216255, 0.01519614178687334, -0.016026459634304047, 0.01042510662227869, -0.09405001252889633, 0.042095817625522614, -0.002884696936234832, 0.07607296854257584, -0.01926865428686142, 0.010471235029399395, 0.017107190564274788, 0.035716865211725235, 0.01306103728711605, 0.044758107513189316, 0.03703482821583748, 0.04697228968143463, 0.0331600122153759, -0.029627863317728043, 0.04014522582292557, -0.03996071219444275, 0.021008368581533432, -0.00016114187019411474, 0.02696557343006134, -0.06674177199602127, -0.0008443216211162508, -0.025080882012844086, -0.043176546692848206, -0.00816479604691267, -0.0006042047752998769, -0.010682109743356705, 0.0016425144858658314, 0.0326855443418026, 0.01581558585166931, -0.020046254619956017, 0.020164871588349342, 0.012191180139780045, -0.005189489107578993, -0.018978701904416084, 0.047683991491794586, -0.013601403683423996, 0.02335434779524803, -0.006121949292719364, 0.05103162303566933, 0.0166590828448534, -0.007868253625929356, 0.0054695564322173595, -0.07760180532932281, -0.0022059446200728416, -0.020639339461922646, -0.019953995943069458, -0.003538737306371331, 0.018543774262070656, 0.017054472118616104, -0.055407267063856125, -0.059097569435834885, -0.011980305425822735, -0.024092407897114754, -0.0032306627836078405, -0.011624455451965332, -0.025239037349820137, 0.012889701873064041, 0.007499223574995995, 0.016804059967398643, -0.015341117978096008, -0.006879779510200024, -0.0422276146709919, 0.006530518643558025, -0.0005119472043588758, 0.02637248858809471, -0.004695252049714327, -0.022893059998750687, -0.020243948325514793, -0.0019703584257513285, -0.028019946068525314, 0.003990140277892351, 0.05353575572371483, 0.043677374720573425, -0.00016515754396095872, -0.017897970974445343, -0.01076777745038271, -0.017805712297558784, -0.009588198736310005, 0.029258832335472107, 0.03961804136633873, -0.03460977226495743, 0.005799048114567995, 0.0023327989038079977, 0.0010799079900607467, -0.023907892405986786, -0.013970433734357357, -0.01582876406610012, 0.0029341205954551697, 0.027993585914373398, -0.024342821910977364, 0.009034653194248676, 0.07754908502101898, 0.040250666439533234, 0.024909546598792076, -0.0046524181962013245, 0.004827048629522324, -0.016210975125432014, -0.006135129369795322, 0.03007597103714943, 0.010273540392518044, -0.01139381155371666, 0.01959814690053463, -0.04984545335173607, -0.034978803247213364, -0.015275219455361366, -0.05609260872006416, -0.05688338726758957, -0.042174894362688065, 0.03205291926860809, -0.010682109743356705, -0.04357193782925606, -0.04939734563231468, 0.0017990227788686752, 0.014523979276418686, 0.016685442999005318, 0.016724981367588043, -0.013192834332585335, -0.018556954339146614, 0.0007026403327472508, 0.033634476363658905, -0.0261220745742321, 0.01310716662555933, 0.00032207780168391764, -0.003930831793695688, 0.024580055847764015, 0.05174332484602928, 0.04742039740085602, -0.010912753641605377, -0.03260646387934685, -0.014682134613394737, 0.04826389625668526, 0.016145076602697372, 0.04088328778743744, 0.017950689420104027, 0.008902856148779392, 0.04272843897342682, 0.01693585515022278, -0.022761262953281403, -0.026398848742246628, 0.018649211153388023, 0.015262040309607983, 0.011248835362493992, -0.08719659596681595, -0.02277444303035736, 0.02287987992167473, -0.018042946234345436, 0.006115359719842672, 0.028916161507368088, -0.04852748662233353, 0.04557524621486664, -0.06500205397605896, 0.055565424263477325, -0.019914457574486732, 0.06289330869913101, -0.027492759749293327, 0.0306558758020401, 0.03619132936000824, -0.006108769681304693, -0.03750929608941078, -0.0027265409007668495, 0.016369130462408066, -0.042939312756061554, 0.025924380868673325, -0.0074662743136286736, 0.049555499106645584, 0.03674487769603729, -0.030945828184485435, -0.05142701044678688, -0.01600010134279728, -0.01675134152173996, -0.03877454251050949, 0.007828714326024055, -0.0224449522793293, -0.06769070774316788, 0.0065371086820960045, 0.026741519570350647, 0.006912728771567345, -0.035400550812482834, 0.0128633426502347, 0.019044600427150726, -0.012968779541552067, -0.006612891796976328, 0.011743072420358658, -0.023183012381196022, 0.01759483851492405, -0.03542691096663475, 0.029759660363197327, 0.009080781601369381, -0.03642856329679489, -0.003766086185351014, 0.029627863317728043, 0.031525734812021255, -0.03192112222313881, 0.023235730826854706, 0.024316461756825447, -0.042833875864744186, -0.030260486528277397, 0.024935906752943993, 0.009278477169573307, -0.020046254619956017, 0.013799098320305347, 0.015024806372821331, 0.017212629318237305, 0.007420145440846682, 0.03476792946457863, 0.030972188338637352, -0.02873164601624012, 0.03634948655962944, -0.037403859198093414, -0.011360862292349339, 0.02277444303035736, 0.017858432605862617, -0.027281884104013443, 0.056672513484954834, -0.024580055847764015, -0.0331600122153759, 0.041990380734205246, 0.009719994850456715, 0.017304886132478714, -0.025489451363682747, -0.021588273346424103, 0.04204309731721878, -0.012500902637839317, -0.060679130256175995, 0.008270232938230038, 0.00492260092869401, 0.03476792946457863, -0.018148384988307953, 0.02210227958858013, 0.020626159384846687, 0.02277444303035736, -0.006649135611951351, 0.006761162541806698, -0.005980268120765686, 0.05153244733810425, -0.021825507283210754, -0.02286669984459877, 0.04581248015165329, 0.01648774743080139, -0.009983588010072708, 0.0520859956741333, -0.00493907555937767, -0.0032421948853880167, -0.004283387679606676, -0.003039557719603181, 0.003103808732703328, 0.024817289784550667, -0.029522426426410675, -0.03919629380106926, -0.024342821910977364, 0.015341117978096008, -0.017357604578137398, 0.020085792988538742, -0.030682235956192017, -0.0201780516654253, -0.01340370811522007, 0.021166525781154633, 0.006553583312779665, 0.02823081985116005, -0.01584194414317608, -0.02830989845097065, -0.0031680595129728317, -0.03703482821583748, -0.004049448762089014, 0.02655700407922268, -0.03397715091705322, 0.04320290684700012, -0.0028682223055511713, -0.06394768506288528, -0.007261989638209343, -0.024593235924839973, 0.037641093134880066, 0.0063229394145309925, 0.035136960446834564, -0.06120631471276283, 0.0052356175146996975, -0.009416863322257996, -0.0009860028512775898, -0.027703633531928062, 0.02604299783706665, 0.04850113019347191, 0.001789138070307672, 0.08166114240884781, 0.06299874931573868, -0.002331151394173503, -0.03189476206898689, 0.012606339529156685, -0.01800340786576271, -0.013680481351912022, 0.0027512528467923403, 0.0050214482471346855, -0.03160481154918671, -0.07691646367311478, 0.0034201203379780054, 0.0006540403701364994, -0.02260310761630535, 0.03276462107896805, -0.0037166625261306763, -0.017476221546530724, 0.03276462107896805, 0.002060968428850174, 0.023248910903930664, -0.013509145937860012, 0.006879779510200024, 0.003779265796765685, 0.039987072348594666, -0.0017446567071601748, 0.007690328173339367, -0.036296769976615906, -0.05150609090924263, 0.020982010290026665, -0.007169731892645359, 0.04604971408843994, 0.016606364399194717, -0.022339513525366783, 0.013456427492201328, -0.015169782564043999, 0.007782585918903351, 0.018728289753198624, -0.002958832308650017, 0.01118293683975935, -0.020744776353240013, -0.019044600427150726, -0.011037960648536682, 0.019387271255254745, -0.018649211153388023, -0.052217792719602585, 0.009232347831130028, -0.023235730826854706, -0.030603157356381416, -0.004929190967231989, 0.06542380154132843, 0.02604299783706665, 0.03600681573152542, -0.0452062152326107, -0.02931155078113079, -0.06837604939937592, -0.018912803381681442, -0.02638566866517067, 0.021140165627002716, -0.01478757243603468, 0.02823081985116005, 0.010649160481989384, 0.03993435204029083, 0.014708494767546654, -0.0007479453925043344, 0.023327987641096115, 0.0043262215331196785, 0.01715991087257862, -0.020494362339377403, 0.05329852178692818, 0.0005551929352805018, 0.030945828184485435, 0.035558708012104034, 0.01084685605019331, -0.009443222545087337, -0.02796722762286663, 0.0069654472172260284, -0.030866751447319984, 0.017818892374634743, 0.04546980932354927, -0.004425068851560354, 0.0059637934900820255, -0.04362465441226959, 0.05403658375144005, 0.025937559083104134, 0.01293583121150732, -0.03039228357374668, -0.020388925448060036, 0.010728239081799984, 0.0660037100315094, 0.031183062121272087, -0.01436582300812006, -0.042543925344944, -0.005604648031294346, -0.018741467967629433, 0.009364144876599312, 0.010866625234484673, -0.03134121745824814, 0.018477875739336014, -0.02555534988641739, -0.05756872892379761, -0.0024052869994193316, 0.0019374091643840075, -0.020296668633818626, 0.05089982599020004, 0.026781057938933372, -0.05200691521167755, -0.024303283542394638, 0.021087447181344032, 0.08619493991136551, -0.004477787762880325, 0.04204309731721878, -0.0306558758020401, -0.01567060872912407, -0.022484490647912025, -0.0010115384357050061, -0.024672312662005424, 0.010537133552134037, 0.051479730755090714, 0.03716662526130676, -0.025528989732265472, -0.021733250468969345, 0.012639288790524006, 0.018464695662260056, -0.0013780975714325905, 0.03192112222313881, -0.020705237984657288, 0.04581248015165329, 0.018543774262070656, 0.05066259205341339, -0.027334602549672127, 0.03608589246869087, -0.028995240107178688, 0.03184204548597336, -0.00586165115237236, -0.01959814690053463, 0.010794136673212051, -0.010372388176620007, 0.074754998087883, 0.07232994586229324, -0.04734131693840027, -0.0023327989038079977, -0.00569690577685833, -0.010148334316909313, -0.048606567084789276, -0.017318066209554672, -0.014339463785290718, 0.04581248015165329, -0.01515660248696804, 0.021271962672472, -0.009443222545087337, -0.03524239733815193, -0.027440041303634644, 0.08034317195415497, 0.01741032302379608, 0.03089310973882675, 0.05303492769598961, 0.020837033167481422, 0.06684720516204834, 0.03595409914851189, -0.010787547565996647, -0.013759559020400047, 0.07312072068452835, -0.011565146967768669, -0.011881458573043346, -0.019729942083358765, 0.0010238944087177515, -0.006214207038283348, 0.0015733212931081653, -0.06774342060089111, 0.007808945141732693, -0.0048863571137189865, 0.0018748058937489986, 0.0023690429516136646, -0.02907431684434414, -0.020744776353240013, 0.0060560512356460094, 0.020468004047870636, -0.007565121632069349, -0.025898020714521408, -0.0999545007944107, -0.05503823608160019, -0.06089000403881073, 0.02888980321586132, -0.014247206039726734, -0.008434979245066643, 0.018372438848018646, -0.013706840574741364, 0.03600681573152542, -0.04264936223626137, 0.016724981367588043, -0.013252142816781998, 0.0007018165779300034, -0.02888980321586132, -0.02003307454288006, 0.011446529999375343, 0.008032999001443386, 0.008678802289068699, 4.654065560316667e-05, 0.017792534083127975, 0.009350964799523354, -0.0050346278585493565, 0.03041864186525345, 0.011123628355562687, 0.01176284160465002, -0.010721649043262005, -0.01382545754313469, -0.030049612745642662, -0.024066049605607986, -0.023499323055148125, 0.011453120037913322, 0.01607917807996273, 0.00895557552576065, 0.007176321931183338, -0.01151901762932539, 0.005245502572506666, -0.013357579708099365, 0.002896229038015008, 0.02646474540233612, 0.017133550718426704, 0.014247206039726734, -0.011644224636256695, 0.027940867468714714, -0.02050754241645336, 0.011512428522109985, 0.010860035195946693, -0.028283538296818733, -0.019953995943069458, -0.04101508483290672, 0.010925933718681335, -0.026280231773853302, -0.025014983490109444, -0.03516331687569618, -0.03772016987204552, -0.004444838501513004, 0.007090654224157333, -0.021166525781154633, -0.023407066240906715, 0.019123679026961327, -0.01858331263065338, -0.006626071408390999, -0.01733124628663063, -0.0007710097706876695, 0.01758165843784809, -0.0010411926778033376, -0.027281884104013443, 0.022669006139039993, -0.03732478246092796, 0.0033245678059756756, -0.03442525863647461, -4.098048884770833e-05, -0.038563668727874756, -0.00360134057700634, -0.006866599898785353, 0.0245536956936121, -0.002599686849862337, -0.01348278671503067, -0.07918336242437363, 0.05756872892379761, -0.05751601234078407, 0.017792534083127975, 0.01675134152173996, 0.016474567353725433, 0.03864274546504021, 0.008382259868085384, 0.011565146967768669, 0.019084138795733452, -0.017963869497179985, -0.012777674943208694, 0.015551992692053318, -0.000726940343156457, 0.05018812417984009, -0.004797394387423992, -0.015341117978096008, 0.010537133552134037, 0.002540378365665674, -0.007255399599671364, -0.0070181661285459995, 0.05140065401792526, -0.005001679062843323, -0.028415335342288017, 0.046207867562770844, -0.003039557719603181, -0.0028814019169658422, -0.005772688426077366, -0.009390504099428654, 0.02505452372133732, -0.028072664514183998, -0.03099854663014412, -0.0016919381450861692, 0.008118666708469391, 0.011037960648536682, -0.053061287850141525, 0.005466261878609657, 0.018240641802549362, -0.011683763936161995, -0.02335434779524803, 0.02604299783706665, 0.03149937465786934, -0.01918957754969597, 0.049370985478162766, -0.004978614393621683, -0.010405337437987328, -0.006780932191759348, -0.0016219211975112557, 0.05603989213705063, -0.0094629917293787, 0.0330018550157547, -0.018108844757080078, -0.0019077550387009978, -0.008856727741658688, 0.021970484405755997, -0.02989145554602146, -0.0012322977418079972, -0.028257180005311966, 0.020902931690216064, -0.0057166749611496925, 0.009495940990746021, 0.024000151082873344, 0.004250438418239355, 0.04673505574464798, -0.007117013446986675, -0.016606364399194717, -0.023341167718172073, 0.053983863443136215, 0.04966093972325325, 0.016118718311190605, 0.005670546554028988, -0.032369229942560196, 0.012586570344865322, -0.03642856329679489, -0.010925933718681335, 0.0261220745742321, -0.00020222531748004258, -0.03479428589344025, -0.03716662526130676, -0.0005465438007377088, -0.005159834865480661, 0.007242219988256693, 0.0007598894299007952, -0.017700275406241417, -0.02881072461605072, -0.030524080619215965, -0.03184204548597336, 0.024685492739081383, 0.03402986750006676, -0.012678827159106731, 0.0043723504059016705, -0.018978701904416084, -0.01042510662227869, 0.011828740127384663, 0.010813906788825989, -0.00099424016661942, -0.0026276935823261738, 0.03600681573152542, -0.038827262818813324, -0.04143683239817619, -0.03163117170333862, -0.023301629349589348, 0.012428414076566696, 0.03226379305124283, 0.02413194812834263, -0.024000151082873344, -0.0030906288884580135, 0.019993536174297333, -0.033476322889328, 0.006853420287370682, -0.007795765530318022, 0.04299203306436539, 0.00739378621801734, 0.033133652061223984, 0.021759608760476112, -0.0002771846193354577, 0.00031960662454366684, -0.02000671625137329, -0.06252428144216537, -0.027624554932117462, 0.0032883237581700087, -0.008303182199597359, -0.042833875864744186, 0.008369080722332, 0.014721673913300037, -0.009647507220506668, 0.014326284639537334, 0.004576635081321001, -0.015011626295745373, -0.010833675973117352, 0.002601334359496832, 0.035374194383621216, 0.017370784655213356, 0.014326284639537334, -0.026754697784781456, -0.004998384043574333, 0.029970534145832062, -0.043598297983407974, -0.04720952361822128, 0.017713455483317375, 0.0569361075758934, 0.02480410970747471, 0.024184666574001312, 0.01883372664451599, 0.001825382118113339, 0.01734442450106144, -0.02378927543759346, 0.011611275374889374, -0.029047958552837372, -0.004201014991849661, -0.003920947201550007, -4.5974342356203124e-05, 0.004220784176141024, -0.03803648427128792, -0.023736556991934776, 0.023591581732034683, -0.0019505888922140002, -0.0022520734928548336, -0.03732478246092796, -0.017489401623606682, -0.017397142946720123, 0.008850137703120708, -0.021588273346424103, -0.019229115918278694, 0.007459684275090694, 0.005940729286521673, -0.009897920303046703, 0.01584194414317608, -0.009581608697772026, -0.0021351040340960026, 0.047789428383111954, 0.02152237482368946, -0.007505813147872686, -0.015631070360541344, -0.026570184156298637, -0.026820596307516098, -0.009706815704703331, -0.004217489622533321, -0.0022191242314875126, -0.06405311822891235, -0.02622751146554947, -0.014009973034262657, 0.027861788868904114, -0.002530493540689349, -0.007097243797034025, -0.02563442848622799, 0.005542044527828693, 0.0057957530952990055, -0.025186318904161453, -0.002210887148976326, 0.024435078725218773, 0.019123679026961327, 0.002917645964771509, -0.11450483649969101, -0.018978701904416084, 0.005350939929485321, -0.020454823970794678, 0.00963432714343071, -0.022379053756594658, 0.007868253625929356, 0.006128539331257343, 0.04681413248181343, -0.026846956461668015, -0.004253733437508345, -0.02227361686527729, 0.013878175988793373, 0.03368719667196274, 0.01808248646557331, -0.03173660859465599, 0.0060890004970133305, 0.014286745339632034, 0.02027030847966671, -0.0163427721709013, -0.01213846169412136, 0.030365923419594765, 0.014154949225485325, 0.03410894423723221, -0.06262971460819244, 0.027835430577397346, 0.02034938707947731, -0.012013254687190056, 0.013337810523808002, 0.003627699799835682, -0.01961132511496544, 0.013891356065869331, 0.01834607869386673, 0.03350268304347992, -0.006388837471604347, 0.00037767947651445866, 0.011400400660932064, 0.007868253625929356, 0.03843187168240547, 0.035980455577373505, 0.009733174927532673, -0.04378281161189079, 0.08060676604509354, 0.03381899371743202, 0.033792633563280106, -0.02530493587255478, 0.010780957527458668, -0.007874843664467335, 0.02245813049376011, -0.011433349922299385, 0.024988625198602676, -0.004319631960242987, 0.0021960600279271603, -0.03700846806168556, -0.0189259834587574, 0.0328436978161335, -0.007156552281230688, -0.0005523099098354578, 0.02245813049376011, 0.008817188441753387, 0.0015065992483869195, 0.030181407928466797, 0.07496587187051773, -0.031552091240882874, -0.021548734977841377, -0.04272843897342682, -0.02865256927907467, -0.0014069280587136745, -0.004929190967231989, -0.0037825608160346746, -0.0027578426524996758, 0.006945678032934666, -0.010609622113406658, -0.009370733983814716, -0.000981060555204749, -0.011551966890692711, 0.011156577616930008, 0.001871510874480009, -0.03031320497393608, 0.007255399599671364, 0.038484591990709305, -0.006092295050621033, 0.004744675476104021, 0.007822125218808651, -0.010372388176620007, -0.00435587577521801, -0.01457669772207737, -0.008665623143315315, 0.013588223606348038, 0.009548659436404705, 0.02444825880229473, 0.015169782564043999, 0.009383914060890675, -0.037403859198093414, 0.007551942020654678, -0.023512503132224083, -0.030260486528277397, -0.01214505173265934, 0.02772999368607998, 0.006392132490873337, 0.04069877415895462, 0.03366083651781082, -0.007334477733820677, 0.0020066024735569954, -0.04006614908576012, 0.0057759834453463554, -0.015472914092242718, 0.03777289018034935, 0.018464695662260056, -0.0069061387330293655, -0.005377299152314663, -0.03880090266466141, -0.037482935935258865, -0.0006565115181729198, 0.012085743248462677, 0.005624417681246996, 0.05514367297291756, -0.005074167158454657, 0.011874868534505367, -0.023907892405986786, -0.012237309478223324, 0.015947381034493446, -0.015472914092242718, -0.007657379377633333, -0.03381899371743202, -0.02915339544415474, -0.007591480854898691, 0.00904783234000206, -0.0015206026146188378, 0.00870516151189804, 0.00722245080396533, -0.019492708146572113, 0.01751575991511345, 0.016224155202507973, -0.009344374760985374, 0.018464695662260056, 0.03687667474150658, 0.001993422629311681, -0.027677275240421295, 0.00796051137149334, 0.004803983960300684, -0.007973690517246723, 0.003039557719603181, 0.01601327955722809, -0.00283856806345284, -0.0005984386662021279, -0.034715209156274796, -0.008349311538040638, -0.021061087027192116, 0.0016919381450861692, 0.03669215738773346, 0.011611275374889374, -0.020085792988538742, 0.02529175765812397, -0.013383938930928707, 0.023341167718172073, -0.02746639959514141, 0.001290782354772091, -0.018807366490364075, 0.03479428589344025, 0.03716662526130676, 0.0491073913872242, 0.022418592125177383, -0.02796722762286663, 0.00454368581995368, 0.013008318841457367, -0.01918957754969597, 0.008217514492571354, 0.024356001988053322, 0.01984855905175209, 0.013159885071218014, -0.02857349067926407, 0.012257078662514687, 0.014510799199342728, -0.0030889816116541624, 0.028257180005311966, 0.014919368550181389, 0.018398797139525414, -0.004850112833082676, 0.012461363337934017, 0.000981060555204749, 0.019281834363937378, -0.009476171806454659, 0.016184614971280098, 0.04731496050953865, -0.010932523757219315, -0.007341067306697369, -0.016804059967398643, 0.018161563202738762, -0.0014398772036656737, 0.016065998002886772, 0.024066049605607986, -0.0036408796440809965, 0.05358847603201866, -0.0019390566740185022, 0.03853730857372284, -0.006474505178630352, -0.006688674446195364, -0.00925870705395937, -0.03007597103714943, -0.04734131693840027, 0.016448209062218666, -0.005479441490024328, -0.023578401654958725, -0.016461389139294624, 0.009245527908205986, -0.034056227654218674, -0.018636031076312065, 0.02419784478843212, -0.011868278495967388, 0.030840391293168068, -0.013370759785175323, -0.005466261878609657, 0.016237333416938782, -0.0069654472172260284, -0.033792633563280106, 0.02094247005879879, -0.02178596891462803, -0.027334602549672127, -0.008639263920485973, -0.026583362370729446, -0.061522625386714935, 0.0035156728699803352, -0.0177529938519001, -0.013509145937860012, -0.00795392133295536, 0.014036332257091999, 0.004224079195410013, 0.012151641771197319, -0.012065974064171314, -0.015947381034493446, 0.02746639959514141, -0.013522325083613396, -0.0021351040340960026, 0.009285066276788712, -0.00045181502355262637, 0.0019159922376275063, -0.005944024305790663, -0.007196091115474701, 0.006438261363655329, 0.020230770111083984, 0.021232422441244125, 0.02186504751443863, -0.006678789854049683, 0.009522300213575363, -0.026029817759990692, 0.02067887783050537, 0.048632923513650894, -0.004451428074389696, -0.008962164632976055, -0.027281884104013443, 0.020837033167481422, 0.01951906830072403, -0.017779354006052017, 0.01983538083732128, 0.04088328778743744, -0.00247942260466516, 0.041990380734205246, 0.000356262520654127, -0.005924254655838013, 0.005153244826942682, -0.0020395515020936728, 0.007881433703005314, -0.019360912963747978, 0.0037496117874979973, -0.02796722762286663, 0.017054472118616104, -0.00369689310900867, -0.005011563654989004, -0.03007597103714943, -0.041594989597797394, -0.003775971010327339, 0.027940867468714714, 0.038326434791088104, 0.017792534083127975, -0.011584916152060032, 0.01793750934302807, -0.009950638748705387, 0.001394572202116251, 0.013344400562345982, -0.024580055847764015, -0.022392231971025467, -0.03458341211080551, -0.009970408864319324, 0.03574322164058685, 0.01248113252222538, 0.019005062058568, 0.0025617952924221754, 0.004537096247076988, 0.01210551243275404, 0.05445833131670952, 0.022550389170646667, -0.007868253625929356, -0.02327526919543743, 0.0035585067234933376, -0.028995240107178688, 0.004131821449846029, 0.015525632537901402, -0.01659318432211876, -0.017238987609744072, 0.02202320285141468, 0.01715991087257862, 0.0007953097810968757, 0.007037935312837362, 0.007505813147872686, 0.004797394387423992, 0.03007597103714943, 0.007967101410031319, -0.00837567076086998, -0.008691982366144657, 0.012606339529156685, -0.01461623702198267, -0.011446529999375343, 0.03603317588567734, 0.046524181962013245, 0.010510774329304695, -0.011663993820548058, -0.027202807366847992, 0.01139381155371666, 0.018978701904416084, -0.01461623702198267, -0.009746354073286057, 0.031947482377290726, 0.016949035227298737, -0.019980356097221375, -0.0037463167682290077, -0.013469606637954712, -0.0010988536523655057, 0.010266950353980064, 0.015314758755266666, 0.0006499217124655843, 0.02712372876703739, -0.0019143448444083333, -0.011637634597718716, 0.012369105592370033, 0.016896316781640053, 0.0045403908006846905, -0.007242219988256693, -0.026675621047616005, 0.012626108713448048, 0.015947381034493446, -0.01378591824322939, 0.01323237270116806, -0.00473479088395834, 0.030945828184485435, -0.009285066276788712, -0.014075870625674725, 0.015789225697517395, -0.03218471631407738, -0.011848509311676025, 0.0753876268863678, -2.6166248062509112e-05, -0.005640892311930656, 0.02369701862335205, 0.0015024805907160044, 0.025186318904161453, -0.01659318432211876, -0.010945702902972698, -0.06320962309837341, -0.002306439448148012, -0.04541708901524544, 0.04900195449590683, -0.030866751447319984, -0.005980268120765686, 0.03634948655962944, -0.0002588566567283124, -0.02780907042324543, 0.015696968883275986, -0.0041581811383366585, 0.007538762409240007, -0.0016219211975112557, 0.007729867473244667, -0.04014522582292557, 0.006253745872527361, -0.004003319889307022, 0.002001659944653511, 0.0006820471026003361, 0.008039589039981365, -0.004184540361166, -0.000865738547872752, -0.011301553808152676, 0.013377348892390728, -0.0444154366850853, -0.003775971010327339, 0.01942681148648262, 0.007169731892645359, -0.02655700407922268, -0.011986895464360714, 0.0031367577612400055, 0.0020066024735569954, -0.015341117978096008, 0.008224104531109333, -0.021548734977841377, -0.027624554932117462, 0.0034662492107599974, 0.013252142816781998, -0.008790829218924046, 0.0009332842892035842, 0.008210924454033375, -0.013944074511528015, -0.008619493804872036, 0.013917715288698673, 0.014036332257091999, -0.029838737100362778, -0.013996792957186699, -0.037403859198093414, -0.007321298122406006, 0.021561915054917336, 0.012817214243113995, 0.014682134613394737, -0.01917639747262001, 0.004688662011176348, -0.018912803381681442, -0.004780919756740332, 0.019374091178178787, -0.019703583791851997, 0.0074135554023087025, 0.021232422441244125, -0.021390579640865326, 0.032369229942560196, -0.019809020683169365, 0.014893009327352047, 0.016303231939673424, -0.013054448179900646, -0.01701493375003338, 0.00020747659436892718, -0.006813881453126669, 0.03310729190707207, -0.0249490849673748, 0.005173014476895332, -0.013640942052006721, 0.003342689946293831, -0.004102167673408985, -0.006886369548738003, 0.011413580738008022, 0.05477464571595192, 0.0014242264442145824, 0.005792458076030016, -0.0083295414224267, 0.01818792335689068, -0.00454368581995368, 0.004036269150674343, 0.03893269971013069, -0.01926865428686142, -0.02177278883755207, -0.029179755598306656, 0.01331145130097866, -0.038484591990709305, -0.010748008266091347, 0.03700846806168556, -0.014642596244812012, -0.031710248440504074, 0.08044861257076263, 0.015631070360541344, 0.0013476196909323335, 0.0015370772453024983, -0.04950278252363205, -0.030787672847509384, 0.028072664514183998, 0.028099022805690765, -0.009159860201179981, -0.015710148960351944, 0.020204409956932068, 0.010780957527458668, 0.02377609722316265, 0.015024806372821331, -0.04370373487472534, 0.00510711595416069, 0.008441568352282047, -0.030787672847509384, 0.03218471631407738, -0.032448310405015945, 0.0064909798093140125, -0.009219168685376644, 0.02369701862335205, -0.005723264999687672, -0.0037034829147160053, 0.01592102274298668, -0.002729835920035839, 0.02050754241645336, -0.007057704962790012, 0.014168128371238708, 0.010372388176620007, 0.005410247948020697, 0.04193766042590141, -0.0200989730656147, -0.004952255170792341, -0.001976948231458664, -0.02454051747918129, -0.01369366142898798, 0.028599850833415985, -0.001130155404098332, 0.008092307485640049, -0.017120370641350746, 0.019031420350074768, -0.018741467967629433, 0.0033130357041954994, -0.01194076705724001, 0.005601353012025356, 0.023723378777503967, -0.011486069299280643, -0.01911049894988537, -0.008652443066239357, 0.048105739057064056, 0.02671515941619873, -0.012665648013353348, 0.012092333287000656, -0.03727206215262413, 0.03679759427905083, -0.009614557959139347, 0.014286745339632034, -0.0025502631906419992, 0.02765091508626938, 0.0006095590069890022, -0.003224072977900505, -0.023973790928721428, -0.0016260398551821709, -0.038985416293144226, -0.007242219988256693, -0.029970534145832062, -0.0004695251991506666, 0.00854041613638401, 0.007855074480175972, -0.02823081985116005, -0.025094062089920044, 0.022141819819808006, 0.017858432605862617, 4.780199014930986e-05, -0.017647556960582733, -0.006026396993547678, -0.012981959618628025, -0.03389807045459747, 0.025146780535578728, 0.012790855020284653, -0.0328436978161335, -0.009318015538156033, 0.0030790967866778374, 0.009746354073286057, -0.012573390267789364, 0.024922726675868034, 0.01700175367295742, -0.0009299893863499165, 0.025528989732265472, -0.001358328154310584, 0.018794186413288116, 0.0032570220064371824, -0.0025749749038368464, 0.005113705992698669, -0.0034794288221746683, 0.04557524621486664, 0.02646474540233612, -0.01858331263065338, 0.019729942083358765, -0.0018583312630653381, -0.007314708083868027, -0.02638566866517067, -0.006675494834780693, 0.00015424314187839627, -0.005205963272601366, 0.017977049574255943, 0.01725216768682003, -0.01064257137477398, 0.002110392088070512, 0.014247206039726734, 0.02019122987985611, 0.02152237482368946, -0.0020906226709485054, 0.021878225728869438, 0.009983588010072708, -0.019716763868927956, -0.005644186865538359, 0.021311501041054726, -2.3463388060918078e-05, -0.003176296828314662, -0.01975630223751068, 0.00626033591106534, 0.018556954339146614, -0.01842515729367733, 0.008981934748589993, 0.030550438910722733, 0.021126985549926758, -0.051295213401317596, -0.009014884009957314, -0.007532172370702028, 0.023749737069010735, -0.020586621016263962, 0.015064344741404057, 0.002835273277014494, -0.05335124209523201, 0.018886445090174675, -0.05915028974413872, 0.011334503069519997, 0.009700225666165352, 0.005430017597973347, -0.028362616896629333, 0.03500516340136528, 0.02328844927251339, -0.010629391297698021, -0.04177950322628021, 0.02881072461605072, 0.00029386510141193867, 0.01038556732237339, 0.012975369580090046, -0.00548932608217001, 0.00913350097835064, -0.038985416293144226, 0.03455705568194389, -0.038748182356357574, 0.009034653194248676, 0.006576647516340017, -0.01759483851492405, -0.03297549486160278, 0.0045272111892700195, -0.009186219424009323, -0.022154999896883965, 0.014813931658864021, -0.014800751581788063, -0.024514157325029373, -0.058412227779626846, -0.002518961438909173, 0.006820471026003361, 0.009719994850456715, -0.0013393823755905032, 0.007907792925834656, -0.006145013961941004, 0.0397234782576561, 0.00350578804500401, -0.02269536443054676, 0.0007722454029135406, -0.0012084095505997539, 0.020481182262301445, -0.001434934907592833, 0.018965521827340126, 0.006668905261904001, 0.020889751613140106, -0.0031845339108258486, -0.025080882012844086, 0.017713455483317375, -0.0013789213262498379, 0.016724981367588043, -0.005261977203190327, -0.02302485704421997, 0.008606314659118652, -0.03242195025086403, -0.02529175765812397, 0.0012743078405037522, 0.003365754149854183, -0.007874843664467335, 0.010629391297698021, 0.017476221546530724, -0.013074217364192009, 0.005518980324268341, -0.030286846682429314, -0.018899625167250633, 0.024514157325029373, 0.007275169249624014, -0.031024906784296036, 0.02546309307217598, 0.0019324668683111668, -0.006421786732971668, 0.032474666833877563, 0.006813881453126669, 0.017634376883506775, 0.017449863255023956, -0.01642184890806675, -0.006316349375993013, -0.006019806955009699, -0.004260323476046324, 0.019466349855065346, 0.010095614939928055, -0.007710097823292017, 0.011321322992444038, 0.021482836455106735, -0.016553645953536034, 0.028415335342288017, -0.03640220686793327, 0.005584878381341696, 0.02328844927251339, -0.02865256927907467, -0.030840391293168068, -0.010168103501200676, 0.009950638748705387, -0.00454698083922267, -0.011103859171271324, 0.01766073703765869, 0.028204459697008133, 0.028916161507368088, 0.02361794002354145, 0.018372438848018646, -0.012303207069635391, 0.0015551992692053318, 0.001990127842873335, -0.015024806372821331, -0.015314758755266666, -0.02946970798075199, 0.0016112127341330051, 0.039907991886138916, -0.0006573352729901671, 0.007940742187201977, 0.008738110773265362, -0.000411864195484668, 0.022550389170646667, -0.02621433325111866, -0.035637784749269485, 0.02361794002354145, -0.023921072483062744, 0.034214381128549576, -0.019295014441013336, -0.040250666439533234, 0.013733199797570705, -0.02537083439528942, 0.00198024301789701, 0.010622801259160042, 0.024052869528532028, 0.033133652061223984, -0.029021598398685455, -0.00854041613638401, -0.012705187313258648, 0.0011087384773418307, -0.013133525848388672, 0.011459709145128727, 0.027624554932117462, -0.004662302788347006, 0.004662302788347006, -0.03352903947234154, -0.04776306822896004, -0.022049561142921448, -0.01984855905175209, 0.03173660859465599, 0.012869932688772678, 0.0006293284823186696, -0.03139393776655197, -0.007420145440846682, -0.022998496890068054, 0.003003313671797514, -0.00014260798343457282, -0.004191129934042692, 0.022141819819808006, 0.018148384988307953]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"19
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Proof. Substituting Eq. (36) into Eq. (35), we obtain the desired marginal Eq. (32),
π∗
t(s1:t) =ct
Zψ∗
tp0(s1:t)tY
τ=1ϕτ(s1:τ)
X
st+1:Tp0(st+1:T|s1:t)TY
τ=t+1ϕτ(s1:τ)
=σ(s1:t)
where the final equality follows from absorbing the constant ctintoZψ∗
t, with1
Zσ=ct
Zψ∗
tandZσwhich normalizes ˜σ(s1:t).
We will now use ct=Zψ∗
t
Zσto show the recursion in Eq. (37). Note that Eq. (36) implies
ψ∗
t(s1:t) =ctϕt(s1:t)X
st+1p0(st+1|s1:t)
ϕt+1(s1:t+1)X
st+2:Tp0(st+2:T|s1:t+1)TY
τ=t+2ϕτ(s1:τ)
| {z }
1
ct+1ψ∗
t+1(s1:t+1)
=Zψ∗
t
Zψ∗
t+1ϕt(s1:t)X
st+1p0(st+1|s1:t)ψ∗
t+1(s1:t+1)
where the second line follows fromct
ct+1=Zψ∗
t/Zσ
Zψ∗
t+1/Zσ. This demonstrates Eq. (37).
This leads to the following definition of the intermediate twisting targets (we defer the soft RL special case to App. B.3).
Definition B.3 (Twisted Intermediate Targets ).Using approximate twist functions {ψt}T−1
t=1, we define the twisted
intermediate target distributions
πt(s1:t) =

1
Zψ
tp0(s1:t) t−1Y
τ=1ϕτ(s1:τ)!
ψt(s1:t) ( t < T )
1
Zσp0(s1:T)TY
t=1ϕt(s1:t) ( t=T)(Twist Targets ( ψ))
One-Step Twist-Induced Proposal Using Prop. 3.3 and Def. B.3 and noting that ϕt−1(s1:t−1)is independent of st, we
have the optimal one-step proposal
qπ
t(st|s1:t−1)∝πt(s1:t)
πt−1(s1:t−1)=Zψ
t−1
Zψ
tp0(st|s1:t−1)ϕt−1(s1:t−1)ψt(s1:t)
ψt−1(s1:t−1)
=:1
Zπ
t(s1:t−1)p0(st|s1:t−1)ψt(s1:t)
=p0(st|s1:t−1)ψt(s1:t)P
stp0(st|s1:t−1)ψt(s1:t)(Twist-Induced Proposal ( ψ))
where in the second line, we absorb terms which depend only on s1:t−1(and not st) into the normalization. In the soft RL
special case, we have qπ
t(st|s1:t−1)∝p0(st|s1:t−1)eβQt(st,s1:t−1)(see Eq. (Twist-Induced Proposal (soft RL)) below).
B.2. Conditional Twisted SMC
To formalize our notion of conditional twists in the infilling experiments (Sec. 7.2.3), we generalize our above framework
to explicitly depend on ‘observation’ random variables {ot}T
t=1. This matches the common setting of SMC in state-space
models (Briers et al., 2010; Gu et al., 2015; Lawson et al., 2022; Chopin et al., 2020). Our derivations in this section also","[0.023234404623508453, -0.016320008784532547, 0.004782245494425297, 0.011553650721907616, -0.02712375298142433, 0.0010605145944282413, 0.04293534904718399, 0.0024546741042286158, -0.031191043555736542, 0.01539215724915266, 0.037698712199926376, -0.01255776360630989, -0.021340571343898773, 0.020730478689074516, 0.03599553182721138, -0.025840014219284058, 0.056840404868125916, 0.013688978739082813, -0.028343940153717995, 0.048578716814517975, -0.01868412271142006, -0.010365239344537258, -0.011992155574262142, 0.013574586249887943, -0.0240732841193676, -0.025992536917328835, 0.02636113576591015, -0.014451595954596996, -0.0036796280182898045, 0.016002250835299492, 0.05089198797941208, -0.023984311148524284, -0.020031413063406944, -0.047663576900959015, -0.019866177812218666, 0.08012565225362778, -0.0169173926115036, 0.04735852777957916, -0.008071032352745533, 0.04217273369431496, 0.008522246964275837, -0.01816299930214882, -0.04097796604037285, 0.03828338533639908, 0.01610393449664116, 0.038207121193408966, -0.024683376774191856, -0.0007896265597082675, -0.009443743154406548, 0.04957012087106705, -0.020832160487771034, 0.021251600235700607, -0.00839514471590519, -0.014972718432545662, -0.016777578741312027, -0.0007681779679842293, 0.02763216383755207, -0.016231035813689232, 0.011077014729380608, -0.02442917227745056, 0.03828338533639908, -0.030403006821870804, 0.014794774353504181, 0.02758132293820381, -0.015900569036602974, -0.026869546622037888, -0.03352973610162735, 0.040266189724206924, -0.01507440023124218, 0.05180712789297104, -0.016294587403535843, 0.013981315307319164, 0.037241142243146896, 0.03078431449830532, -0.013142436742782593, 0.01504897978156805, 0.009151406586170197, 0.04102880507707596, 0.02309459075331688, -0.022713283076882362, 0.017959635704755783, -0.060958538204431534, 0.027479641139507294, -0.012157389894127846, 0.008795518428087234, -0.03858843073248863, -0.0015744868433102965, -0.021073656156659126, -0.03571590781211853, -0.0303775854408741, -0.016714027151465416, 0.031318146735429764, -0.02052711322903633, -0.0039751422591507435, 0.052823953330516815, -0.01065757591277361, 0.019128981977701187, -0.0027803753037005663, 0.017069915309548378, -0.0008833649335429072, 0.03719029948115349, -0.029106557369232178, 0.011121501214802265, -0.027530482038855553, 0.05526432767510414, 0.003886170219630003, -0.008496826514601707, 0.00979963131248951, -0.06573760509490967, -0.009952154941856861, -0.004712339024990797, -0.01765458844602108, -0.0026040200609713793, 0.032309550791978836, 0.019243374466896057, -0.043367497622966766, -0.03632599860429764, -0.008236265741288662, -0.02625945210456848, 0.009647107683122158, -0.015404867939651012, -0.005541685037314892, -0.00033185764914378524, 0.008611219003796577, 0.030174221843481064, 0.0005882479599677026, 0.021937955170869827, -0.08058322221040726, -0.0020813094452023506, 0.020590664818882942, 0.014235521666705608, 0.020031413063406944, -0.012487856671214104, 0.014629540033638477, -0.0024959826841950417, -0.041410114616155624, 0.01724785938858986, 0.02986917458474636, 0.0052620586939156055, 0.008128228597342968, -0.0033110298682004213, -0.03652936592698097, -0.027149172499775887, -0.008039256557822227, -0.011172342114150524, 0.002171870321035385, -0.032080765813589096, 0.01886206679046154, -0.008903555572032928, 0.020158514380455017, -0.0292336605489254, -0.03279254212975502, -0.03541085869073868, -0.002109907567501068, -0.009125986136496067, -0.04969722032546997, -0.021518515422940254, 0.05745049566030502, 0.06217872351408005, -0.01868412271142006, 0.007333835586905479, 0.025776462629437447, -0.02132786065340042, -0.004928413778543472, 0.011223183013498783, 0.011585426516830921, -0.017057204619050026, 0.03846132755279541, -0.02722543478012085, -0.03147067129611969, 0.0050269183702766895, -0.033961888402700424, -0.07229611277580261, -0.03416525200009346, 0.02275141328573227, -0.019523000344634056, -0.04247777909040451, -0.08404041826725006, 0.020959263667464256, 0.00031497678719460964, -0.013536456041038036, 0.03927478566765785, -0.02481047995388508, -0.018595149740576744, 0.009710659272968769, 0.01662505604326725, -0.010377949103713036, 0.02676786482334137, 0.02356487140059471, -0.015265055000782013, -0.004979255143553019, 0.05973834916949272, 0.07722770422697067, -0.004594768863171339, -0.02550954557955265, -0.02286580577492714, 0.0584673210978508, 0.0389697402715683, 0.03851217031478882, 0.0004817993030883372, 0.013561876490712166, 0.012684866786003113, -0.03525833785533905, -0.014489727094769478, -0.019980570301413536, 0.030479269102215767, -4.614926365320571e-05, 0.020476272329688072, -0.08266770839691162, 0.01804860681295395, 0.020552534610033035, -0.010981688275933266, 0.04138469323515892, 0.036427684128284454, -0.02781010791659355, 0.0030218707397580147, -0.06741536408662796, 0.0046201893128454685, -0.01429907325655222, 0.0510190911591053, 0.004000562708824873, 0.012195520102977753, 0.04992600902915001, 0.018086738884449005, -0.029259080067276955, 0.018734963610768318, 0.014832904562354088, -0.03800375759601593, 0.04906170815229416, -0.013536456041038036, 0.05394245684146881, 0.021988796070218086, -0.015798887237906456, -0.041308432817459106, -0.007276639342308044, 0.0005826872074976563, -0.03508039191365242, -0.02041272073984146, -0.033733103424310684, -0.08790434151887894, 0.032589174807071686, 0.01961197331547737, 0.035004131495952606, -0.039808619767427444, 0.038995161652565, 0.025598518550395966, -0.010930846445262432, 0.003438132582232356, -0.018035897985100746, 0.015608232468366623, 0.0047409371472895145, -0.02653907984495163, 0.008789163082838058, 0.025064686313271523, -0.04161347821354866, -0.017959635704755783, 0.027555901557207108, 0.013777950778603554, -0.04324039816856384, 0.0071050506085157394, 0.020311038941144943, -0.018213842064142227, -0.05521348491311073, 0.03136898949742317, -0.00834430381655693, -0.023920759558677673, 0.0011836454505100846, 0.001267851097509265, 0.07743106782436371, -0.0303775854408741, -0.010943557135760784, 0.006355143617838621, -0.021937955170869827, 0.01628187671303749, -0.021404122933745384, -0.026284873485565186, 0.0022926179226487875, 0.01948487013578415, -0.03019964136183262, 0.049443017691373825, 0.0022624311968684196, -0.040672916918992996, 0.05800975114107132, 0.008210845291614532, -0.008363368920981884, -0.017616458237171173, 0.011210473254323006, 0.03965609520673752, 0.0005699769244529307, -0.06253461539745331, 0.015226923860609531, 0.0011121501447632909, 0.030352165922522545, 0.004283366724848747, 0.010568603873252869, -0.0013885988155379891, 0.00242130970582366, -0.003336450317874551, 0.03279254212975502, 0.025763751938939095, 0.0607551708817482, 0.0021941133309155703, 0.012341688387095928, 0.024263937026262283, 0.013790661469101906, 0.010066547431051731, 0.032309550791978836, 0.0040863570757210255, -0.009933088906109333, 0.011788791045546532, -0.02041272073984146, -0.023946180939674377, -0.028903191909193993, 0.007009723223745823, -0.00796934962272644, -0.013739820569753647, 0.05124787613749504, -0.011693463660776615, 0.0025277582462877035, -0.0355379618704319, -0.0458587147295475, -0.003593833651393652, 0.006558508146554232, 0.0022830853704363108, -0.002853459445759654, -0.03406357020139694, 0.0026818704791367054, 0.011966735124588013, -0.02689496800303459, -0.005131778307259083, 0.023412348702549934, -0.024835901334881783, 0.05162918567657471, 0.00238635647110641, -0.02613235078752041, -0.04941759631037712, -0.032182447612285614, 0.04832451045513153, 0.005211217794567347, 0.05521348491311073, -0.06843218207359314, 0.006876265164464712, -0.0029742070473730564, -0.03164861351251602, -0.012449726462364197, 0.0217727217823267, 0.03365683928132057, 0.023755526170134544, 0.09583556652069092, -0.0011860287049785256, 0.023539451882243156, -0.03365683928132057, 0.05091740936040878, -0.013028044253587723, -0.008376078680157661, 0.006307479925453663, 0.002877291291952133, -0.02803889289498329, -0.022319264709949493, 0.00029372680000960827, -0.026106929406523705, -0.002829627599567175, 0.030936839058995247, -0.004486731253564358, -0.006653835065662861, 0.0372665598988533, 0.008268041536211967, 0.022382816299796104, -0.021594777703285217, 0.017057204619050026, -0.016942812129855156, 0.010492341592907906, -0.019446739926934242, 0.00905607920140028, -0.03909684345126152, -0.03508039191365242, -0.006812714040279388, 0.011769725941121578, 0.030504688620567322, 0.019217953085899353, 0.0006720563978888094, 0.0008746266248635948, -0.035334598273038864, -0.0018874775851145387, -0.0008873369079083204, -0.004543927498161793, -0.003180749248713255, -0.020438142120838165, -0.00828075222671032, -0.003182338085025549, 0.009678883478045464, -0.013409352861344814, -0.04046955332159996, 0.04191852733492851, -0.010250846855342388, -0.016129354014992714, -0.004991965368390083, 0.050358157604932785, 0.037164878100156784, 0.027098331600427628, -0.07234695553779602, -0.00836972426623106, -0.04654506966471672, -0.021480385214090347, -0.05831479653716087, 0.024632535874843597, -2.4948903956101276e-05, 0.01886206679046154, -0.017222438007593155, 0.036376841366291046, 0.02773384563624859, -0.05567105859518051, 0.01794692501425743, 0.011013464070856571, 0.03886805847287178, -0.04461310803890228, 0.012945427559316158, 0.019675524905323982, 0.059128254652023315, 0.06416153162717819, 0.008363368920981884, -0.024263937026262283, 0.031623195856809616, -0.01518879272043705, -0.022891227155923843, -0.0010851407423615456, 0.0464179664850235, -0.01776898093521595, 0.04374880716204643, -0.04397759214043617, 0.027937211096286774, 0.0470026396214962, 0.02155664749443531, -0.04229983687400818, -0.002422898542135954, -0.027530482038855553, 0.07000826299190521, 0.02264973148703575, -0.015798887237906456, -0.06024676188826561, 0.0036001887638121843, 0.011560006067156792, -0.015354027040302753, 0.01582430675625801, -0.027072912082076073, 0.013803371228277683, -0.019866177812218666, -0.0636531189084053, -0.004982432350516319, -0.007251218892633915, -0.015430288389325142, -0.0007745331386104226, 0.05091740936040878, -0.018696831539273262, -0.0038829927798360586, -0.030352165922522545, 0.09202247858047485, -0.002813739702105522, 0.05134955793619156, -0.02712375298142433, 0.004995142575353384, 0.013854213058948517, -0.022891227155923843, -0.01690468192100525, 0.00986318290233612, 0.04883292317390442, 0.026005247607827187, -0.018480757251381874, -0.010136453434824944, 0.03790207579731941, 0.005122245755046606, -0.025878144428133965, 0.031851980835199356, 0.006383741740137339, 0.0249375831335783, 0.011712529696524143, 0.06863555312156677, -0.036656469106674194, 0.04174058139324188, -0.0047949557192623615, 0.023310666903853416, -0.009831407107412815, 0.011305800639092922, 0.037927497178316116, 0.0029201884754002094, 0.07351630181074142, 0.02477234974503517, -0.015036269091069698, 0.009704303927719593, 0.015519260428845882, -0.013561876490712166, -0.0447147898375988, 0.0036828056909143925, -0.013294960372149944, 0.049493856728076935, -0.04285908862948418, 0.021226178854703903, -0.012303558178246021, -0.04667217284440994, -0.019802626222372055, 0.044791050255298615, 0.026208611205220222, 0.015976831316947937, 0.05841647833585739, 0.02196337655186653, 0.03457197919487953, 0.007886732928454876, 0.0020050478633493185, 0.0035271046217530966, 0.050129372626543045, 0.004420002456754446, 0.011744305491447449, -0.030275903642177582, -0.010848229750990868, -0.014375334605574608, 0.00737832160666585, -0.06573760509490967, -0.014044866897165775, 0.019103560596704483, -0.0015498605789616704, 0.011299445293843746, -0.008846359327435493, -0.04613834246993065, -0.010613089427351952, 0.040266189724206924, -0.010651220567524433, -0.008770097978413105, -0.1089017391204834, -0.04377422854304314, -0.04598581790924072, 0.007785050664097071, -0.005694208666682243, 0.004308787174522877, 0.018150290474295616, -0.018010476604104042, 0.02750506065785885, -0.041359275579452515, 0.0034857962746173143, -0.027988051995635033, 0.011483744718134403, -0.00825533177703619, -0.003163272747769952, 0.0005957946996204555, 0.0077405646443367004, -0.0004353273252490908, 0.0035239271819591522, -0.013943185098469257, -0.010511407628655434, 0.0022989732678979635, 0.024899452924728394, 0.02195066586136818, -0.028064314275979996, -0.009335706010460854, -0.007638882379978895, -0.0009500939631834626, -0.011299445293843746, -0.0035429925192147493, 0.003050468862056732, 0.02872524783015251, 0.013663558289408684, 0.036605626344680786, -0.022598890587687492, -0.021188048645853996, -0.012824679724872112, -0.004718693904578686, 0.018557019531726837, 0.022484498098492622, 0.0014513558708131313, -0.0049125258810818195, 0.024950293824076653, -0.05765386298298836, 0.01002841629087925, 0.006463180761784315, -0.045197781175374985, -0.008140938356518745, -0.037114039063453674, 0.01793421432375908, -0.02505197562277317, -0.028521884232759476, -0.03749534487724304, -0.02941160462796688, -0.011591781862080097, 0.022598890587687492, -0.03558880463242531, -0.03139440715312958, 0.013854213058948517, -0.003654207568615675, 0.003501684172078967, 0.0048585073091089725, 0.02000599168241024, 0.004880750086158514, -0.0011200940934941173, -0.02459440566599369, 0.006120003294199705, -0.04438432306051254, -0.003102898830547929, -0.014832904562354088, 0.0026818704791367054, -0.03652936592698097, 0.004839441739022732, 0.006437760312110186, 0.029259080067276955, 0.013180567882955074, -0.0042071049101650715, -0.038029178977012634, 0.06446657329797745, -0.07199106365442276, 0.032080765813589096, 0.014324493706226349, 0.015671784058213234, 0.027200013399124146, 0.03932562842965126, 0.005843554623425007, 0.00885271467268467, 4.310202257329365e-06, -0.015913279727101326, 0.020705057308077812, -4.9972280976362526e-05, 0.05841647833585739, -0.013193277642130852, -0.0005660049500875175, 0.000742757401894778, -0.0009175238665193319, -0.012208230793476105, -0.02418767660856247, 0.013053464703261852, -0.00019978982163593173, -0.015964120626449585, 0.031267307698726654, 0.012068417854607105, -0.033961888402700424, -0.007079629693180323, 0.00024149545060936362, 0.03650394454598427, -0.02142954431474209, -0.018722252920269966, -0.015481129288673401, 0.029589548707008362, 0.02028561756014824, -0.007899443618953228, 0.010613089427351952, 0.013676268979907036, -0.018811224028468132, -0.02459440566599369, 0.035156652331352234, 0.02160748839378357, -0.032182447612285614, 0.05020563304424286, -0.007905798964202404, -0.0130407540127635, -0.03485160693526268, -0.014400755055248737, 0.028852351009845734, -0.02648823894560337, 0.032233286648988724, -0.03988488018512726, 0.025140946730971336, -0.0005401871749199927, 0.012773838825523853, -0.03134356811642647, -0.015201503410935402, -0.012360754422843456, 0.01452785823494196, 0.00714953662827611, 0.0009048135834746063, 0.035690486431121826, 0.01874767243862152, 0.039528992027044296, -0.018264682963490486, -0.012309912592172623, -0.02567477896809578, 0.03558880463242531, 0.024785060435533524, -0.005567105486989021, -0.01138206198811531, -0.0019017766462638974, 0.012570473365485668, -0.045706190168857574, 0.020082253962755203, 0.019967861473560333, 0.00285187060944736, -0.019128981977701187, -0.04446058347821236, -0.002349814400076866, 0.003533459734171629, 0.00312355300411582, 0.002796263201162219, -0.021925244480371475, -0.02900487557053566, -0.033046744763851166, -0.018951037898659706, 0.019459448754787445, 0.04624002426862717, -0.013117016293108463, -0.0008372901356779039, -0.05162918567657471, -0.014718512073159218, 0.028216836974024773, 7.060167263261974e-05, 0.0053224326111376286, -0.026411976665258408, 0.0254968348890543, -0.028979454189538956, -0.006850844714790583, -0.02333608642220497, -0.0189129076898098, -0.0033110298682004213, 0.04423179849982262, 0.03370768204331398, -0.031038520857691765, 0.004165796563029289, 0.016014961525797844, -0.0013202810660004616, 0.0104605657979846, -0.020031413063406944, 0.03243665397167206, 0.01915440335869789, 0.026284873485565186, 0.012742063030600548, 0.0004373133124317974, -0.017667299136519432, -0.016256457194685936, -0.06029760092496872, 0.00968523882329464, -0.009939444251358509, -0.026183191686868668, -0.06838134676218033, 2.961596146633383e-05, 0.012437015771865845, -0.009329350665211678, -0.004899815656244755, 0.015595521777868271, -0.010644865222275257, -0.0026326181832700968, -0.017807111144065857, 0.040622077882289886, -0.005621124524623156, 0.03563964366912842, -0.02211589924991131, -0.01086094044148922, 0.03828338533639908, -0.020946552976965904, -0.060551807284355164, 0.0475873127579689, 0.06207704171538353, 0.04352002218365669, 0.01516337227076292, 0.035156652331352234, 0.003160095075145364, -0.011845987290143967, -0.0157607551664114, 0.010416080243885517, -0.0183409433811903, -0.001504580257460475, -0.008172714151442051, -0.006005610805004835, -0.0028836464043706656, -0.017781691625714302, -0.026691602542996407, 0.013638137839734554, 0.007480003871023655, -0.019040009006857872, 0.0005779208731837571, -0.006240751128643751, -0.02717459388077259, -0.008388789370656013, 0.010377949103713036, -0.020488983020186424, -0.0024880387354642153, 0.009615331888198853, -0.024327488616108894, -0.007124115712940693, -0.004690095782279968, 0.01122953835874796, 0.034648243337869644, 0.01656150445342064, -0.02750506065785885, 0.002635795855894685, -0.02165832929313183, -0.010937201790511608, 0.01301533356308937, -0.00016344634059350938, -0.03083515539765358, -0.043596282601356506, -0.017336832359433174, -0.02441646158695221, -0.011102436110377312, 0.0008547668112441897, -0.005363740958273411, -0.014807484112679958, -0.009825051762163639, 0.007365611381828785, -0.008948042057454586, -0.007225797977298498, 0.017273280769586563, 0.030301325023174286, -0.00905607920140028, -0.12242548167705536, -0.029030295088887215, 0.023297956213355064, 0.019688233733177185, 0.04862955957651138, -0.032131604850292206, 0.036148056387901306, -0.012252716347575188, 0.020196646451950073, -0.03014880046248436, -0.0038194411899894476, -0.020222065970301628, -0.004432712681591511, 0.01470580231398344, 0.01464225072413683, -0.04845161363482475, -0.013371221721172333, -0.008795518428087234, 7.174361235229298e-05, -0.01726057007908821, 0.004194394685328007, 0.020145805552601814, 0.006831779144704342, 0.05033273622393608, -0.07036414742469788, -0.005525797139853239, -0.00047544416156597435, 0.018785804510116577, -0.002756543457508087, 0.008986173197627068, -0.0046201893128454685, -0.02292935736477375, -0.003361871000379324, 0.026005247607827187, -0.02717459388077259, 0.01668860763311386, 0.0011383651290088892, -0.008649350143969059, -0.013358511961996555, 0.009640752337872982, 0.01034617330878973, -0.05317984148859978, 0.0865316316485405, 0.03607179597020149, 0.029131976887583733, -0.03261459618806839, 0.011877763085067272, -0.02287851646542549, 0.007543555460870266, -0.026183191686868668, -0.0019351411610841751, 0.019281504675745964, 0.017629168927669525, -0.013650848530232906, -0.0005103974835947156, 0.020476272329688072, 0.004394581541419029, -0.009767855517566204, 0.046977221965789795, 0.04372338578104973, 0.0012614959850907326, 0.025928985327482224, 0.07443144172430038, -0.02219216153025627, -0.046112921088933945, -0.026666181161999702, 0.00527476891875267, -0.0002651286486070603, 0.0076261721551418304, -0.006844489369541407, -0.007924864068627357, -0.0022942067589610815, 0.03060637041926384, -0.010365239344537258, -0.011769725941121578, -0.029309920966625214, -0.01598954014480114, 0.02211589924991131, -0.0452994629740715, 0.015786176547408104, 0.04443516209721565, -0.026513658463954926, 0.010740192607045174, 0.004655142780393362, -0.029818333685398102, 0.017463933676481247, -0.00905607920140028, -0.014464306645095348, -0.01429907325655222, 0.04862955957651138, 0.02315814234316349, -0.015442999079823494, 0.011026173830032349, -0.04799404367804527, -0.013472904451191425, -0.01972636580467224, -0.0406983382999897, 0.0012440193677321076, 0.03014880046248436, 0.0014386456459760666, 0.023882629349827766, 0.038385067135095596, -0.015290475450456142, -0.019001878798007965, 0.008992527611553669, 0.02636113576591015, -0.025369733572006226, 0.033555157482624054, -0.004102244973182678, -0.007448228076100349, 0.01023178081959486, -0.02074318751692772, -0.041588060557842255, -0.009647107683122158, 0.021353282034397125, 0.006685610860586166, 0.056891243904829025, 0.015633653849363327, 0.024276647716760635, 0.0023307488299906254, -0.00010952692537102848, 0.010409724898636341, -0.0163327194750309, 0.004836264066398144, -0.0180613175034523, -0.020552534610033035, -0.006123180966824293, -0.0024149545934051275, -0.016142064705491066, -0.014006736688315868, 0.0023657020647078753, -0.012678511440753937, 0.04057123512029648, 0.01703178510069847, -0.005567105486989021, 0.03764786943793297, 0.027327116578817368, -0.0009222902008332312, -0.04957012087106705, 0.02051440253853798, 0.00965981837362051, -0.007715144194662571, 0.016726737841963768, 0.026411976665258408, 0.0039814976043999195, -0.016065802425146103, -0.008064677007496357, -0.03548712283372879, -0.0010295332176610827, 0.0047345818020403385, 0.05714545026421547, 0.020387301221489906, -0.025255341082811356, -0.0011288323439657688, -0.018023187294602394, 0.02631029486656189, -0.01909085176885128, -0.014451595954596996, -0.026234032586216927, 0.014553278684616089, 0.020438142120838165, 0.06014507636427879, 0.020361879840493202, -0.020959263667464256, -0.0013893932336941361, -0.0009818696416914463, -0.008808229118585587, -0.012646735645830631, -0.0075689759105443954, 0.023819077759981155, 0.0029551417101174593, -0.03721572086215019, 0.02245907671749592, 0.02459440566599369, 0.009322995319962502, 0.009945799596607685, -0.008865425363183022, 0.017349541187286377, 0.01736225187778473, 0.0007153508486226201, 0.025662070140242577, 0.004232525359839201, -0.04311329498887062, 0.008814584463834763, 0.034317776560783386, -0.026640761643648148, -0.006526732351630926, 0.01482019480317831, 0.01108972541987896, 0.025928985327482224, -0.005522619467228651, 0.014426175504922867, -0.009494584053754807, 0.05882320925593376, 0.01667589694261551, 0.03365683928132057, -0.027428798377513885, 0.006736452225595713, -0.01496000774204731, -0.05653535574674606, -0.0452994629740715, 0.03271627798676491, -0.016383560374379158, -0.029894594103097916, -0.006691966205835342, 0.029437024146318436, -0.033961888402700424, -0.0020828982815146446, -0.007861312478780746, -0.024683376774191856, 0.003867104882374406, -0.0009620098280720413, -0.020311038941144943, 0.024746928364038467, -0.010416080243885517, -0.038207121193408966, 0.024734217673540115, -0.015748046338558197, -0.027479641139507294, 0.00032788567477837205, -0.020501693710684776, -0.03180113807320595, -0.014235521666705608, 0.02281496487557888, -0.02183627337217331, 0.0015498605789616704, 0.017044493928551674, 0.006431405432522297, -0.004880750086158514, -0.016116643324494362, 0.0026485060807317495, 0.022827675566077232, -0.012742063030600548, -0.004248413257300854, -0.02018393576145172, -0.0007733415113762021, -0.02488674223423004, -0.02028561756014824, -0.019815336912870407, -0.016192905604839325, 0.008890845812857151, 0.023691974580287933, 0.0003997782478109002, -0.006850844714790583, -0.008229910396039486, -0.0303775854408741, 0.03134356811642647, 0.03617347776889801, -0.024505432695150375, -0.030047118663787842, -0.05262058973312378, 0.020094962790608406, 0.04372338578104973, -0.027149172499775887, 0.016930101439356804, -0.0012813558569177985, 0.007918508723378181, 0.05994171276688576, 0.031140202656388283, 0.016701316460967064, 0.0053224326111376286, -0.0103207528591156, -0.011369351297616959, -0.00269299210049212, 0.0039147683419287205, -0.03490244969725609, 0.03106394223868847, 0.01438804529607296, -0.030936839058995247, -0.014197390526533127, -0.036656469106674194, -0.015748046338558197, 0.014070287346839905, 0.028928613290190697, 0.01937047764658928, -0.012131968513131142, 0.008376078680157661, -0.010015706531703472, -0.007956639863550663, 0.017629168927669525, -0.0441555380821228, -0.023031039163470268, -0.04476563259959221, -0.015620943158864975, 0.05770470201969147, 0.022382816299796104, 0.02309459075331688, -0.004829909186810255, -0.010282621718943119, 0.008979817852377892, 0.05882320925593376, 0.010352528654038906, -0.005608414299786091, -0.007988415658473969, -0.00316803902387619, -0.013663558289408684, 0.004222992807626724, 0.02114991843700409, -0.0010986453853547573, -0.01166168786585331, -0.0010684585431590676, 0.032182447612285614, -0.03790207579731941, 0.013383932411670685, -0.007371966261416674, 0.014743932522833347, 0.011642622761428356, 0.012983557768166065, -0.006539442576467991, -0.02538244239985943, -0.011140566319227219, -0.003848039312288165, -0.00796934962272644, 0.027555901557207108, 0.04575703293085098, -0.006850844714790583, -0.0006716592470183969, -0.015366736799478531, 0.014311783015727997, 0.0087383221834898, -0.02229384332895279, -0.013841502368450165, 0.02636113576591015, 0.017743561416864395, -0.025522256270051003, 0.012742063030600548, 0.0037813102826476097, -0.010797388851642609, -0.0056115915067493916, 0.018951037898659706, -0.018074028193950653, 0.04115590825676918, -0.011172342114150524, -0.01100075338035822, 0.001736542908474803, 0.026234032586216927, 0.0015879914863035083, -0.0029011229053139687, -0.02492487244307995, -0.012678511440753937, 0.025179078802466393, -0.006444115657359362, -0.003511216724291444, 0.012532343156635761, 0.02006954327225685, 0.0022354216780513525, -0.00034178755595348775, 0.006622059736400843, 0.010263556614518166, -0.03060637041926384, 0.06599181145429611, 0.013447484001517296, -0.03312300890684128, 0.006243928335607052, 0.014057577587664127, 0.03106394223868847, -0.019459448754787445, 0.0020177580881863832, -0.05475591495633125, -0.01215103454887867, -0.029665809124708176, 0.02836935967206955, -0.01731141097843647, -0.004779067821800709, 0.010803744196891785, -0.010365239344537258, -0.020425431430339813, 0.01111514586955309, -7.566592830698937e-05, -0.0008317293832078576, 0.021594777703285217, 0.016243746504187584, -0.044333480298519135, 0.021976085379719734, -0.018429916352033615, 0.0035461699590086937, -0.00656486302614212, 0.00891626626253128, 0.0009842528961598873, -0.0050300960429012775, -0.007155891507863998, 9.483065514359623e-05, -0.04466394707560539, -0.023247115314006805, 0.01550654973834753, 0.008954397402703762, -0.056433673948049545, 0.006218507885932922, -0.00785495713353157, 0.005459068343043327, 0.0013957483461126685, 0.011826922185719013, -0.015036269091069698, -0.01043514534831047, -0.002476917114108801, 0.014210101217031479, -0.020260198041796684, -0.006895330734550953, 0.010454211384057999, 0.01441346574574709, -0.0021035524550825357, 0.008522246964275837, 0.014794774353504181, -0.019688233733177185, 0.004845797084271908, -0.014362623915076256, -0.010854585096240044, 0.021454963833093643, 0.019472159445285797, 0.002559534041211009, -0.026742443442344666, -0.0009405612363480031, 0.009589911438524723, 0.018595149740576744, 0.019624684005975723, -0.0018207485554739833, 0.017069915309548378, 0.023234404623508453, 0.009964864701032639, 0.043596282601356506, -0.002759721130132675, 0.01295178197324276, -0.015036269091069698, 0.021798141300678253, -0.006307479925453663, -0.007480003871023655, 0.012710287235677242, 0.024619825184345245, -0.001954206731170416, 0.03284338116645813, -0.0002295795566169545, 0.005557572934776545, -7.646031917829532e-06, 0.010981688275933266, 0.020590664818882942, 0.02768300473690033, 0.012932716868817806, 0.0009350004838779569, -0.01690468192100525, 0.002756543457508087, -0.002810562262311578, 0.00808374211192131, 0.016065802425146103, -0.01450243778526783, 0.0029408426489681005, -0.035919271409511566, 0.016408979892730713, -0.03202992305159569, 0.009348415769636631, 0.023590292781591415, -0.008592153899371624, -0.02189982496201992, 0.05455255135893822, 0.016408979892730713, -0.02986917458474636, 0.02165832929313183, -0.04229983687400818, -0.031851980835199356, 0.0180613175034523, 0.03197908028960228, -0.0011050006141886115, -0.01232897862792015, 0.0015530381351709366, 0.008770097978413105, 0.010072902776300907, 0.006453648209571838, -0.04936675354838371, 0.03630058094859123, 0.008541313000023365, -0.037520766258239746, 0.024060573428869247, -0.019917020574212074, -0.011248604394495487, 0.0033714035525918007, 0.018506178632378578, -0.018722252920269966, 0.003889347892254591, -0.009291219525039196, -0.002006636466830969, 0.011477389372885227, -0.032309550791978836, 0.0035843008663505316, 0.018442627042531967, 0.006142246071249247, 0.03129272535443306, 0.007753274869173765, -0.017324121668934822, 0.007715144194662571, -0.039173103868961334, 0.0006613321020267904, 0.012691221199929714, -0.0053828065283596516, 0.006882620509713888, -0.02121346816420555, 0.006380564067512751, 0.003380936337634921, -0.013307670131325722, -0.01532860565930605, 0.027886370196938515, 0.02162019908428192, -0.01484561525285244, -0.008185424841940403, -0.009602622129023075, 0.04321497678756714, 0.019472159445285797, -0.0017111223423853517, -0.00015679330681450665, -0.030682632699608803, 0.04822282865643501, 0.004937946330755949, 0.0401390865445137, -0.018366364762187004, 0.019078141078352928, 0.0009834584780037403, 0.01507440023124218, -0.00374635704793036, -0.0021496273111552, -0.009526359848678112, 0.006078694947063923, -0.04385048896074295, -0.011102436110377312, 0.023425059393048286, 0.0026818704791367054, -0.035283755511045456, -0.029131976887583733, -0.010727481916546822, -0.0003687969292514026, -0.0029170108027756214, -0.015315895900130272, 0.014311783015727997, -0.021404122933745384, -0.040088243782520294, 0.040113665163517, 0.00862392969429493, -0.02052711322903633, -0.017273280769586563, 0.012227295897901058, 0.01748935505747795, -0.009392902255058289, 0.014743932522833347, 0.009386546909809113, 0.013968605548143387, -0.011928603984415531, -0.012449726462364197, 0.022713283076882362, -0.0040990677662193775, -0.01450243778526783, -0.008541313000023365, -0.02132786065340042, 0.032919641584157944, 0.002383178798481822, -0.0031918708700686693, 0.007956639863550663, 0.005602058954536915, -0.0007387854275293648, -0.011553650721907616, 0.018493467941880226, -0.01539215724915266, -0.0206415057182312, 0.012411595322191715, 0.01240523997694254, 0.007035143673419952, -0.019179822877049446, 0.015023559331893921, 0.009189537726342678, 0.00758168613538146, 0.010225425474345684, 0.0024880387354642153, 0.003336450317874551, -0.0033523382153362036, -0.0023990666959434748, 0.013587296940386295, -0.009793275967240334, 0.015659073367714882, -0.04077460244297981, 0.009399257600307465, 0.007499069441109896, -0.014197390526533127, 0.0047917780466377735, 0.02745421975851059, 0.034012727439403534, -0.03434319421648979, 0.001954206731170416, -0.012144679203629494, 0.03856300935149193, -0.02528076060116291, 0.02745421975851059, -0.01569720357656479, -0.03576674684882164, 0.009265799075365067, -0.028343940153717995, -0.003520749509334564, 0.011337576434016228, 0.005408226978033781, -0.01521421317011118, 0.06344975531101227, 0.004162618890404701, 0.008128228597342968, -0.03876637667417526, 0.013625428080558777, 0.00871290173381567, 0.015125241130590439, 0.014769353903830051, -0.018353654071688652, 0.0075689759105443954, -0.010517762042582035, 0.01667589694261551, -0.022484498098492622, 0.04331665858626366, 0.03472450375556946, -0.022204872220754623, -0.016701316460967064, 0.030352165922522545, 0.006342433393001556, -0.009513650089502335, 0.006482246331870556, -0.006069161929190159, -0.008763742633163929, -0.01122953835874796, -0.008433275856077671, 0.006730096880346537, -0.003946544136852026, -0.017870662733912468, -0.01011738833039999, -0.003863927209749818, 0.026157770305871964, 0.01438804529607296, 0.010594024322926998, 0.015061690472066402, -0.009805986657738686, 0.04059665650129318, -0.009380191564559937, 0.027022069320082664, 0.010409724898636341, 0.01081009954214096, -0.02487403154373169, -0.014680381864309311, 0.0037368242628872395, -0.01088636089116335, 0.02522991970181465, -0.00974879041314125, -0.033097587525844574, 0.021798141300678253, -0.04212189093232155, -0.00323794549331069, -0.01827739179134369, -0.001132804318331182, -0.03823254257440567, 0.008102808147668839, 0.022954778745770454, 0.005932526662945747, -0.0023339265026152134, -0.000567196577321738, 0.0052302828989923, 0.030123380944132805, 0.02442917227745056, -0.03879179432988167, 0.029589548707008362, 0.013688978739082813, -0.024963004514575005, 0.010136453434824944, 0.009132341481745243, 0.00022123842791188508, -0.01088636089116335, -0.02487403154373169, 0.022725993767380714, -0.01263402495533228, -0.0027771976310759783, 0.008948042057454586, 0.017514774575829506, -0.020959263667464256, 0.013167857192456722, 0.01651066355407238, 0.023882629349827766, 0.022204872220754623, -0.018086738884449005, 0.013574586249887943, 0.012525987811386585, -0.022331973537802696, -0.017629168927669525, -0.0014934587525203824, 0.0008428508881479502, -0.007041499018669128, 0.006793648470193148, -0.013625428080558777, -0.000859533145558089, -0.0025658891536295414, 0.016764868050813675, 0.018213842064142227, -0.017273280769586563, 0.009367481805384159, 0.025255341082811356, -0.04041871428489685, -0.017807111144065857, -0.021531226113438606, 0.015315895900130272, 0.011254958808422089, -0.007460938300937414, 0.002988506341353059, 0.0046837409026920795, 0.016256457194685936, 0.01731141097843647, -0.012824679724872112, -0.023628422990441322, 0.028420202434062958, 0.0030107491184026003, 0.01804860681295395, -0.018328234553337097, -0.03790207579731941, 0.005366918630897999, -0.0300979595631361, -0.016612345352768898, 0.03078431449830532, 0.009507294744253159, 0.03599553182721138, -0.02727627567946911, 0.002519814297556877, -0.01429907325655222, 0.004292899277061224, -0.019128981977701187, 0.008287107571959496, 0.030936839058995247, 0.0010660752886906266, 0.010168229229748249, -0.01793421432375908, -0.03581758961081505, -0.04753647372126579, -0.027098331600427628, 0.031724877655506134, 0.0029376649763435125, 0.02918281964957714, -0.033783942461013794, 0.004070469178259373, -0.014082998037338257, 0.018938327208161354, 0.0007733415113762021, -0.00652037700638175, 0.007365611381828785, 0.0047345818020403385]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"
emphasize that the optimal twist functions in Prop. B.1 learn functions proportional to conditional likelihoods of the future
observation variables given the current sequence (see Eq. (40) below)). We recover the unconditional targets in the main text
for fixed oT= 1.
20
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Consider a target distribution σ(s1:T|o1:T)conditioned on particular observation random variables o1:T:={ot}T
t=1. We
define a probabilistic model over observations σ(ot|s1:t) =ϕt(ot,s1:t)as the intermediate potential ,8which yields the
target posterior
σ(s1:T|o1:T) =p0(s1:T)TQ
t=1σ(ot|s1:t)
P
s1:Tp0(s1:T)TQ
t=1σ(ot|s1:t)=1
Zσ(o1:T)p0(s1:T) TY
t=1ϕt(ot,s1:t)!
=p0(s1:T)σ(o1:T|s1:T)
σ(o1:T)(38)
where we interpret σ(o1:T|s1:T) =QT
t=1σ(ot|s1:t)andZσ(o1:T) =σ(s1:T)to make the Bayesian posterior explicit in the
last equality. Note, we now seek to estimate a different partition function Zσ(o1:T)for each set of observation variables.
Using our infilling experiments in Sec. 7.2.3 as an example, consider (a sequence of) subsequent tokens oT=sT+1:T+cas
observation variables, where the observation model is simply the base language model σ(oT|s1:T):=p0(sT+1:T+c|s1:T).
Using Eq. (38), the intermediate marginals become
σ(s1:t|o1:T) =X
st+1:Tσ(s1:T|o1:T)
=X
st+1:T1
σ(o1:T)p0(s1:t)p0(st+1:T|s1:t)TY
t=1σ(ot|s1:t)
=1
Zσ(o1:T)p0(s1:t) tY
τ=1ϕτ(oτ,s1:τ)!X
st+1:Tp0(st+1:T|s1:t)TY
τ=t+1ϕτ(oτ,s1:τ)
=1
Zσ(o1:T)p0(s1:t) tY
τ=1ϕτ(oτ,s1:τ)!
σ(ot+1:T|s1:t), (39)
noting that σ(ot+1:T|s1:t) =P
st+1:Tσ(ot+1:T,st+1:T|s1:t)matches the second to last line.
The optimal twists take a similar form as Prop. B.1, but now as a function of the future observation or conditioning
information. Further, the optimal twists is proportional to the conditional likelihoods (e.g., σ(ot+1:T|s1:t)) of future
observations given s1:t, which marginalize over future tokens (e.g., st+1:T),
Φ∗
t(s1:t,ot+1:T)ot+1:T∝σ(ot+1:T|s1:t) =X
st+1:Tp0(st+1:T|s1:t)TY
τ=t+1ϕτ(oτ,s1:τ)
,
ψ∗
t(s1:t,ot:T)ot:T∝σ(ot:T|s1:t) =X
st+1:Tp0(st+1:T|s1:t)TY
τ=tϕτ(oτ,s1:τ)
,(40)
where f(x,o)o∝g(x,o)denotes proportionality up to a constant which depends on oonly:∃c(o):f(x,o) =c(o)g(x,o).
These equations can be confirmed by comparing Prop. B.1 with the last two lines in Eq. (39).
The intermediate marginals over partial sequences can finally be rewritten as either
σ(s1:t|o1:T)o1:T∝p0(s1:t) tY
τ=1ϕτ(oτ,s1:τ)!
Φ∗
t(s1:t,ot+1:T),
=p0(s1:t) t−1Y
t=1ϕτ(oτ","[0.006482930853962898, -0.02367299422621727, 0.010039495304226875, -0.005200695712119341, -0.022999117150902748, 0.029625559225678444, 0.04971703141927719, 0.017583156004548073, -0.04342752695083618, 0.015511613339185715, 0.028926726430654526, -0.02293672226369381, -0.01252285111695528, -0.00021351086616050452, -0.00421172147616744, -0.02135186642408371, 0.04801986366510391, 0.02399745211005211, -0.041505731642246246, 0.039084773510694504, -0.03339426964521408, -0.03681356459856033, -0.018406782299280167, 0.02558230794966221, -0.01811976172029972, -0.04030773416161537, 0.018481656908988953, 0.005409722216427326, 0.02790343388915062, 0.007225441746413708, 0.030623894184827805, -0.028452517464756966, -0.010002057999372482, -0.03796164691448212, -0.011867694556713104, 0.03301989659667015, 0.011056547984480858, 0.03529110550880432, 0.002651824615895748, 0.031472478061914444, 0.0077682859264314175, -0.019005782902240753, -0.04115631803870201, 0.021276991814374924, 0.005362925119698048, 0.053560614585876465, -0.005122701171785593, 0.016098134219646454, -0.04514965042471886, 0.06758720427751541, -0.02573205716907978, 0.03863552212715149, -0.008098984137177467, -0.006043040193617344, -0.002796894870698452, -0.02352324314415455, -0.011393485590815544, -0.011948809027671814, 0.018668845295906067, -0.027978308498859406, 0.031896770000457764, -0.0171713437885046, 0.014450883492827415, 0.038011565804481506, -0.01397667545825243, -0.025133056566119194, -0.03723785653710365, 0.023323576897382736, -0.02324870228767395, 0.0692344605922699, -0.010027016513049603, -0.010101891122758389, 0.025557348504662514, 0.034692104905843735, -0.027554016560316086, 0.017371010035276413, 0.023485805839300156, 0.0412062332034111, 0.004838799592107534, -0.027129724621772766, 0.03107314370572567, -0.022861847653985023, 0.029101433232426643, -0.013677175156772137, 0.010532422922551632, -0.038011565804481506, 0.0029404053930193186, -0.014999967068433762, -0.038011565804481506, -0.02092757448554039, -0.0071256086230278015, 0.0296006016433239, -0.012279507704079151, 0.0002866310242097825, 0.045324359089136124, -0.005079024005681276, 0.014575675129890442, 0.007350233383476734, 0.012248309329152107, -0.0364641472697258, 0.018007447943091393, -0.034791938960552216, 0.026455849409103394, -0.047845155000686646, 0.04033268988132477, -0.008130181580781937, -0.041505731642246246, -0.01928032375872135, -0.06384345144033432, 0.0024474780075252056, 0.0046235341578722, 0.004501861985772848, 0.006963379215449095, 0.036389272660017014, -0.0022946081589907408, -0.038810230791568756, -0.03903485834598541, 0.017296135425567627, 0.019617261365056038, 0.0012713158503174782, -0.007880598306655884, -0.04133102297782898, 0.0026253063697367907, 0.03529110550880432, 0.00845464039593935, 0.0019935481250286102, 0.011006631888449192, -0.05645578354597092, 0.002849931363016367, 0.012242069467902184, 0.01001453772187233, 0.010126849636435509, -0.02885184995830059, -0.0038092678878456354, -0.0006465772166848183, -0.032570645213127136, 0.013202966190874577, 0.01395171694457531, 0.02272457629442215, 0.02610643208026886, -0.004770164377987385, -0.0433276928961277, -0.025544868782162666, -0.003996455576270819, -0.002962243976071477, -0.01307817455381155, -0.028352683410048485, -0.0017330453265458345, -0.00593072734773159, 0.00826745294034481, -0.029400933533906937, -0.044201236218214035, -0.027603933587670326, 0.03925948217511177, 0.013015778735280037, -0.04534931853413582, -0.03531606122851372, 0.05750403553247452, 0.0385856069624424, -0.0036470387130975723, 0.006476691458374262, 0.0093843387439847, 0.015361863188445568, -0.010045735165476799, 0.01612309366464615, 0.014014112763106823, -0.016921760514378548, 0.04749573767185211, -0.04512469470500946, -0.05146411433815956, 0.019517429172992706, -0.024559015408158302, -0.06239587068557739, -0.03207147866487503, 0.025956682860851288, -0.02357316017150879, -0.03476697951555252, -0.1251910775899887, -0.03249577060341835, 0.01281611155718565, -0.02262474223971367, 0.06299486756324768, -0.011474600993096828, -0.03252072632312775, 0.023373493924736977, 0.02372290939092636, -0.015411780215799809, 0.02440926432609558, 0.05101486295461655, -0.019055698066949844, -0.011767861433327198, 0.02742922492325306, 0.07352729141712189, 0.0006812849314883351, -0.03287014365196228, -0.014238737523555756, 0.07332763075828552, 0.03494168817996979, 0.0380365215241909, 0.023922577500343323, 0.011449642479419708, 0.01991676166653633, -0.028727058321237564, -0.0512644462287426, -0.015973342582583427, 0.015449217520654202, 0.010401391424238682, 0.01395171694457531, -0.0745256245136261, -0.012953382916748524, 0.014750383794307709, -0.044251151382923126, 0.02060311660170555, 0.020952533930540085, -0.015474176034331322, -0.010351475328207016, -0.06214628741145134, 0.004345872439444065, -0.03481689468026161, 0.030848518013954163, -0.006002482958137989, 0.024384306743741035, 0.046697068959474564, 0.005983763840049505, -0.02308647148311138, 0.024184638634324074, 0.014438404701650143, -0.03626447916030884, 0.02927614189684391, -0.019879324361681938, 0.0348917692899704, 0.009053640998899937, -0.001325912307947874, -0.04435098543763161, 0.015237071551382542, -0.004511221311986446, -0.03693835437297821, -0.00954032875597477, -0.026231223717331886, -0.0729282945394516, -0.005687383469194174, 0.013302799314260483, 0.04342752695083618, -0.023435888811945915, 0.011792819947004318, 0.008336088620126247, -0.03209643438458443, 0.023910097777843475, 0.003138512372970581, 0.012129757553339005, 0.0401579812169075, -0.036539021879434586, -0.030873477458953857, 0.006086717359721661, -0.040507398545742035, -0.024009931832551956, 0.019005782902240753, -0.002152657601982355, -0.04237927496433258, 0.021688804030418396, 0.03903485834598541, -0.0316971018910408, -0.07722113281488419, 0.02309895120561123, -0.015586488880217075, -0.006464212201535702, -0.010732090100646019, 0.0028951684944331646, 0.04247910901904106, -0.019005782902240753, 0.00045392996980808675, 0.0023991211783140898, -0.005453398916870356, 0.03334435448050499, -0.022662179544568062, -0.05425944924354553, 0.01654738560318947, 0.04677194356918335, -0.012965861707925797, 0.03891006484627724, -0.015012446790933609, -0.011536996811628342, 0.046796903014183044, 0.008042828179895878, 0.0030901555437594652, -0.011399725452065468, -0.004869997501373291, 0.03703818842768669, -0.007088170852512121, -0.0628950372338295, 0.006876024883240461, -0.0009702558163553476, 0.001701847417280078, -0.0031369524076581, -0.023211263120174408, 0.05860220268368721, -0.00043209141585975885, -0.024072326719760895, -0.011012870818376541, 0.025881806388497353, 0.02499578520655632, -0.029151350259780884, -0.00890389084815979, 0.020103950053453445, -0.010513704270124435, 0.020054033026099205, 0.04245414957404137, 0.02086517959833145, -0.007325275335460901, 0.0017720427131280303, -0.012129757553339005, -0.00405573146417737, -0.016934240236878395, 0.021863512694835663, -0.035590603947639465, -0.0017205661861225963, 0.03386848047375679, 0.006882264744490385, 0.0026705432683229446, -0.03027447685599327, -0.04200490191578865, 0.006270784884691238, -0.004061971325427294, 0.01569880172610283, 0.003852945053949952, -0.009122276678681374, -0.0008439041557721794, 0.001870316220447421, -0.00020532141206786036, 0.015611446462571621, 0.01996667869389057, -0.0380614809691906, 0.0269550159573555, 0.05520786717534065, -0.054509032517671585, -0.042778607457876205, -0.029450850561261177, 0.07128104567527771, 0.018831074237823486, 0.03978360816836357, -0.08870197087526321, 0.018693802878260612, 0.006863545626401901, -0.0475706122815609, -0.016871843487024307, 0.00940929725766182, 0.015998302027583122, 0.039509065449237823, 0.05316128209233284, 0.0018484776373952627, 0.011212537996470928, -0.022849367931485176, 0.0176954697817564, 0.0016144932014867663, -0.018169676885008812, -0.0032570643816143274, 0.03661389648914337, -0.014001633040606976, -0.03995831683278084, 0.004648492205888033, -0.03915964812040329, -0.011643069796264172, 0.039284441620111465, 0.018569011241197586, -0.004395789001137018, 0.01700911484658718, -0.016035739332437515, -0.0060586389154195786, -0.0016753291711211205, 0.019991636276245117, -0.021202117204666138, 0.03244585171341896, -0.011948809027671814, 0.011611871421337128, -0.04205481708049774, -0.03491672873497009, -0.006963379215449095, -0.017408447340130806, 0.04485015198588371, 0.017732907086610794, -0.023535722866654396, -0.012741236947476864, -0.010607298463582993, 0.027928391471505165, 0.015262030065059662, 0.010145568288862705, -0.0005288050160743296, -0.01775786466896534, -0.03451739624142647, -0.01712142676115036, 0.012741236947476864, 0.00011591982911340892, -0.025557348504662514, 0.05116461589932442, -0.022375158965587616, -0.01373957097530365, -0.0014397847699001431, 0.09004972130060196, 0.02039097063243389, 0.011268693953752518, -0.040557317435741425, -0.005915128625929356, -0.04886844754219055, 0.007705890107899904, -0.06928437203168869, 0.027978308498859406, -0.003525366773828864, 0.03494168817996979, 0.03641422837972641, 0.058103036135435104, 0.028627226129174232, -0.03531606122851372, 0.02546999417245388, 0.0038092678878456354, 0.03144751861691475, -0.03446747735142708, 0.014076508581638336, 0.03456731140613556, 0.06154728680849075, 0.04961719736456871, 0.005412841681391001, -0.0182320736348629, 0.006457972805947065, 0.0006009502103552222, -0.026730390265583992, -0.003288262290880084, 0.02447166107594967, -0.01949246972799301, 0.03793669119477272, -0.039134688675403595, 0.025707099586725235, 0.03920956701040268, -0.007868119515478611, -0.03197164461016655, 0.019891804084181786, -0.03252072632312775, 0.060748618096113205, 0.029400933533906937, 0.018244553357362747, -0.06219620257616043, -0.010407631285488605, -0.005855852272361517, -0.030573977157473564, -0.024134723469614983, -0.03711306303739548, 0.028402600437402725, -0.028103100135922432, -0.03613968938589096, 0.024758681654930115, -0.025345202535390854, -0.008198817260563374, 0.04707144573330879, 0.03536598011851311, -0.02870210073888302, 0.0012947142822667956, -0.027504099532961845, 0.06514129042625427, -0.022225409746170044, 0.039758648723363876, -0.02515801601111889, 0.01898082345724106, -0.00847959890961647, -0.04237927496433258, -0.06454228609800339, 0.00803034845739603, 0.03461723029613495, 0.04999157041311264, -0.03504152223467827, -0.03461723029613495, 0.026281140744686127, 0.01574871689081192, 0.0018812355119735003, 0.007606056518852711, -0.0047982423566281796, 0.014226258732378483, -0.0043801902793347836, 0.07772029936313629, -0.04430106654763222, 0.01007069367915392, -0.02378530614078045, 0.017208781093358994, -0.005072784144431353, 0.00019186730787623674, 0.0008517036330886185, -0.02398497238755226, 0.0745256245136261, 0.04717127978801727, -0.0269550159573555, -0.008972526527941227, 0.0004161024698987603, -0.014014112763106823, -0.056355949491262436, -0.004860638175159693, -0.01350246649235487, 0.04375198483467102, -0.024596452713012695, 0.015237071551382542, 0.006220868322998285, -0.02890176698565483, -0.006495410110801458, 0.08810296654701233, -0.0085856718942523, -0.0008696424774825573, 0.06139753758907318, 0.03736264631152153, 0.05241253226995468, 0.020166344940662384, -0.0014007872669026256, -0.018631406128406525, 0.07991663366556168, -0.014076508581638336, -0.010588578879833221, -0.031472478061914444, -0.002631545765325427, -0.0005662425537593663, -0.011231256648898125, -0.05750403553247452, 0.01606069691479206, -0.0035472053568810225, -0.0003971887053921819, 0.011393485590815544, -0.005088383331894875, -0.017832739278674126, -0.023111430928111076, 0.024059846997261047, -0.00033420787076465786, -0.010576100088655949, -0.08236254751682281, -0.04025781527161598, -0.04285348579287529, 0.02752905897796154, -0.0059026493690907955, -0.015361863188445568, 0.0006543766940012574, -0.022712096571922302, 0.011686746962368488, -0.025083139538764954, -0.014475842006504536, -0.031622227281332016, 0.014326091855764389, -0.02198830433189869, 0.003606481244787574, -0.01371461246162653, 0.00452994043007493, 0.009527849033474922, 0.0083236088976264, 0.00904116127640009, 0.007375191897153854, 0.0008002270478755236, 0.037063147872686386, 0.01342759095132351, -0.004202361684292555, -0.012516611255705357, -0.006532847881317139, -0.021252034232020378, -0.005219414364546537, 0.017470844089984894, 0.0005646826466545463, -0.0005639026639983058, 0.026281140744686127, 0.04005815088748932, -0.02352324314415455, -0.022075658664107323, -0.0023975614458322525, -0.00019176981004420668, 0.024708764627575874, 0.03319460153579712, -0.039983272552490234, 0.01970461569726467, 0.008660546503961086, -0.03878527507185936, 0.006751233246177435, 0.004536179825663567, -0.040831856429576874, -0.010713371448218822, -0.023535722866654396, 0.014638070948421955, -0.02663055807352066, -0.011393485590815544, -0.0354158952832222, -0.02568214014172554, 0.016622260212898254, 0.011873934417963028, -0.04529940336942673, -0.0353909395635128, 0.007194243837147951, -0.00930322427302599, 0.0022883685305714607, -0.0079242754727602, 0.003288262290880084, 0.03064885176718235, -0.02399745211005211, -0.009627683088183403, 0.014538237825036049, -0.037337690591812134, -0.005088383331894875, -0.012242069467902184, 0.00940929725766182, -0.021489137783646584, -0.001923352712765336, 0.0174334067851305, 0.020328573882579803, -0.00816137995570898, -0.018456699326634407, -0.053760282695293427, 0.04592335969209671, -0.07033262401819229, 0.0030885955784469843, 0.007350233383476734, 0.0010880279587581754, 0.01300329901278019, -0.0055594719015061855, 0.020428407937288284, -0.0122857466340065, -0.01392675843089819, -0.023972492665052414, 0.008548234589397907, -0.00983358919620514, 0.061647120863199234, -0.011225016787648201, 0.012173434719443321, -0.014675509184598923, 0.042928360402584076, -0.003021520096808672, -0.014488320797681808, 0.029775310307741165, -0.013514945283532143, -0.03718793764710426, 0.04879356920719147, -0.00866678636521101, -0.03401822969317436, -0.030399268493056297, -0.017932573333382607, 0.02837764285504818, -0.0048512788489460945, -0.012791153974831104, -0.020528241991996765, 0.010332755744457245, 0.031247852370142937, -0.035166312009096146, -0.0016690895427018404, 0.02653072401881218, -0.02985018491744995, -0.022175492718815804, 0.046896737068891525, 0.0021573372650891542, -0.03613968938589096, 0.05016627907752991, -0.02715468220412731, -0.011374766938388348, -0.01390179991722107, -0.019617261365056038, 0.03536598011851311, -0.015361863188445568, 0.043152984231710434, -0.05226278305053711, 0.013627258129417896, 0.0009764953865669668, 0.029400933533906937, -0.03182189539074898, -0.006277024745941162, -0.0009507570648565888, 0.015399300493299961, 0.02742922492325306, 0.014987488277256489, 0.02685518190264702, 0.007693410851061344, 0.017158864066004753, 0.005369164515286684, -0.024222077801823616, -0.030099768191576004, 0.03159726783633232, 0.026705432683229446, -0.014126425608992577, -0.002896728226915002, -0.0038217471446841955, 0.02283688820898533, -0.05840253457427025, -0.01568632200360298, 0.034866813570261, -0.02373538911342621, -0.030948352068662643, -0.044201236218214035, -0.044949986040592194, 0.0022181731183081865, 0.007356473244726658, 0.007687171455472708, -0.018306948244571686, -0.023548200726509094, -0.020802782848477364, -0.013514945283532143, 0.007774525322020054, 0.021152200177311897, -0.02128947153687477, 0.00861686933785677, -0.0375373549759388, -0.021052366122603416, 0.029400933533906937, -0.019305283203721046, -0.036963313817977905, 0.013377674855291843, 0.03419293835759163, -0.0644923746585846, -0.03589010611176491, -0.03561556339263916, -0.011786580085754395, -0.014937571249902248, 0.04185514897108078, 0.022649701684713364, -0.015212113037705421, -0.0025114337913691998, 0.011767861433327198, -0.012341903522610664, -0.006732514593750238, -0.026830224320292473, 0.024908430874347687, -0.0008283052011393011, 0.008011629804968834, -0.004008934833109379, -0.020041553303599358, -0.017782822251319885, -0.011156382039189339, -0.04010806605219841, -0.005256852135062218, 0.0061272745952010155, -0.026455849409103394, -0.03831106424331665, 0.027628891170024872, 0.022050701081752777, -0.019467512145638466, 0.020303616300225258, 0.010975433513522148, -0.002140178345143795, -0.023585639894008636, 0.006386217195540667, 0.026405932381749153, 0.016247885301709175, 0.025120576843619347, -0.008180098608136177, -0.005119581241160631, 0.026755349710583687, -0.016709614545106888, -0.04926778003573418, 0.03935931622982025, 0.06324445456266403, 0.03683852031826973, 0.009446734562516212, 0.02785351686179638, 0.008042828179895878, 0.011206298135221004, -0.03439260274171829, 0.008791578002274036, -0.02213805541396141, -0.00022735494712833315, 0.01617300882935524, -0.003575283335521817, 0.027603933587670326, -0.03132272884249687, -0.0512644462287426, -0.0012011205544695258, 0.01307817455381155, 0.007493744138628244, -0.01329032052308321, -0.014538237825036049, -0.015598967671394348, -0.008654307574033737, -0.006613962352275848, -0.0033787363208830357, 0.02203822135925293, 0.03888510540127754, -0.013826925307512283, 0.0079242754727602, -0.003896622220054269, 0.0061272745952010155, 0.04095664992928505, 0.03603985533118248, -0.029026558622717857, 0.00409316923469305, -0.03311972692608833, -0.03022455982863903, -0.0020450246520340443, 0.002740738680586219, -0.0009655760950408876, -0.04237927496433258, -0.022861847653985023, -0.014513279311358929, -0.005606268998235464, -0.004832560196518898, 0.01041387114673853, -0.0317220613360405, -0.01178034022450447, 0.010750808753073215, -0.030524060130119324, 0.011281173676252365, 0.003852945053949952, 0.020952533930540085, -0.01284107007086277, -0.12369357794523239, -0.033419229090213776, 0.04038260877132416, 0.01568632200360298, -0.0005576630937866867, -0.021888472139835358, 0.02648080699145794, -0.02573205716907978, -0.014725425280630589, -0.02251243032515049, -0.009796151891350746, -0.024546535685658455, 0.008704223670065403, 0.029251184314489365, 0.02700493298470974, -0.02123955450952053, -0.0033693769946694374, -0.0032071478199213743, -0.0002852661127690226, -0.026331057772040367, -0.0047857630997896194, 0.016285322606563568, -0.00044808033271692693, 0.03616464510560036, -0.047795236110687256, -0.005025987513363361, 0.017945053055882454, 0.012111038900911808, 0.016197968274354935, 0.0028280927799642086, -0.019143052399158478, -0.004242919385433197, 0.02039097063243389, 0.04138094186782837, 0.009852307848632336, 0.0070070563815534115, 0.00042585181654430926, -0.000437551032518968, -0.008435921743512154, -0.0011012870818376541, 0.013851882889866829, -0.0512644462287426, 0.08760379999876022, 0.004654732067137957, 0.027554016560316086, -0.040981609374284744, 0.006364378612488508, -0.024109764024615288, 0.006720035336911678, -0.04310306906700134, 0.00863558892160654, 0.012067361734807491, 0.007999151013791561, -0.031846851110458374, -0.006067998241633177, 0.009215869940817356, -0.0061927903443574905, 0.002590988529846072, 0.031048186123371124, 0.01855653151869774, -0.016410114243626595, 0.017395969480276108, 0.0930447205901146, -0.017321093007922173, -0.02198830433189869, -0.025557348504662514, 0.0039184605702757835, 0.012385580688714981, -0.026306098327040672, -0.019118094816803932, 0.004498742055147886, -0.007687171455472708, -0.004058851394802332, -0.007212962489575148, -0.0030979549046605825, 0.007050733547657728, -0.022762013599276543, 0.007493744138628244, -0.06054895371198654, 0.014475842006504536, 0.019118094816803932, -0.018781157210469246, 0.017795301973819733, 0.03296997770667076, 0.004542419221252203, 0.022100618109107018, -0.011586912907660007, 0.005581310484558344, -0.027229558676481247, 0.04866877943277359, 0.04290340095758438, -0.004283476620912552, -0.00781820248812437, -0.050116363912820816, -0.00819257739931345, -0.027179641649127007, -0.03264551982283592, 0.026605598628520966, 0.016073176637291908, -0.005565711762756109, 0.017732907086610794, 0.03736264631152153, -0.01775786466896534, -0.017146386206150055, 0.009209630079567432, 0.024109764024615288, -0.002965363673865795, 0.017533238977193832, -0.006495410110801458, -0.00861063040792942, 0.004214840941131115, -0.004935513250529766, -0.04392669349908829, 0.026755349710583687, 0.014201300218701363, -0.0004726487095467746, 0.04465048387646675, 0.01658482290804386, 0.024983307346701622, 0.0008758820476941764, 0.016422593966126442, 0.013465029187500477, 0.0041961222887039185, -0.018381822854280472, -0.01901826076209545, -0.014912612736225128, -0.016085656359791756, 0.025382639840245247, -0.0074251084588468075, -0.013652216643095016, -0.006564045790582895, -0.028926726430654526, 0.023710431531071663, 0.005846492946147919, -0.005054065492004156, 0.02578197419643402, 0.024371827021241188, -0.0012237390037626028, -0.047370944172143936, 0.04108143970370293, 0.006876024883240461, 0.01041387114673853, 0.02970043383538723, -0.004841919522732496, 0.023635555058717728, -0.014001633040606976, -0.016285322606563568, -0.036339353770017624, -0.003144752001389861, -0.0122857466340065, 0.03366881236433983, 0.016722094267606735, -0.017732907086610794, 0.00036345593980513513, -0.02082774229347706, -0.01633523963391781, -0.02367299422621727, -0.016035739332437515, -0.010470027104020119, 0.02690509893000126, 0.005353565793484449, 0.05840253457427025, 0.02837764285504818, 0.003016840433701873, 0.038660481572151184, -0.006788670551031828, 0.0038092678878456354, 0.006726274732500315, 0.005303649231791496, 0.015012446790933609, -0.023073993623256683, -0.025432556867599487, 0.02203822135925293, 0.0158485509455204, -0.008579432033002377, 0.010076933540403843, 0.0016519306227564812, 0.025906765833497047, -0.006330061238259077, 0.02262474223971367, 0.022225409746170044, 0.0025660302489995956, -0.050116363912820816, 0.011942570097744465, 0.045324359089136124, -0.025332722812891006, -0.014687987975776196, 0.009359380230307579, 0.008604390546679497, 0.00861063040792942, 0.027678808197379112, 0.010763287544250488, -0.027229558676481247, 0.05770369991660118, -0.0012291986495256424, 0.03174702078104019, 0.003419293789193034, -0.004258518107235432, 0.004592336248606443, -0.019430074840784073, -0.05775361880660057, -0.015561530366539955, -0.028128057718276978, -0.015511613339185715, -0.02970043383538723, 0.025133056566119194, -0.038385938853025436, 0.0023367253597825766, -0.012242069467902184, 0.0033880958799272776, 0.01461311336606741, 0.0006571065168827772, -0.02573205716907978, 0.00959024578332901, -0.01390179991722107, -0.039134688675403595, 0.007961712777614594, -0.005191336385905743, -0.03022455982863903, -0.010563621297478676, -0.018406782299280167, -0.033843521028757095, -0.013440070673823357, 0.0019061939092352986, -0.008648067712783813, 0.029875142499804497, 0.028577309101819992, 0.021638888865709305, -0.01759563572704792, -0.02065303362905979, -0.007113129366189241, 0.013415112160146236, -0.017258698120713234, 0.01503740530461073, 0.011873934417963028, -0.005025987513363361, -0.01695919781923294, -0.008435921743512154, -0.014513279311358929, -0.010850641876459122, 0.003618960501626134, 0.010894319042563438, 0.019629741087555885, -0.00967136025428772, -0.002539512002840638, -0.03127280995249748, -0.003737512743100524, 0.04752069339156151, -0.012747476808726788, -0.015224592760205269, -0.016722094267606735, 0.04707144573330879, 0.036439187824726105, 0.0006099196616560221, 0.013602299615740776, 0.0161106139421463, 0.00414932519197464, 0.05660553276538849, 0.011493319645524025, 0.00932818278670311, 0.0019592302851378918, -0.01270379964262247, 0.016722094267606735, -0.01785769872367382, 0.0070070563815534115, -0.029974976554512978, 0.015549050644040108, 0.003138512372970581, 0.006451732944697142, -0.01352742500603199, -0.00930322427302599, 0.011225016787648201, 0.015436738729476929, 0.02133938856422901, 0.003080796217545867, -0.026880141347646713, 0.015586488880217075, -0.024696284905076027, 0.009721276350319386, 0.027079807594418526, -0.03589010611176491, -0.012117277830839157, -0.031622227281332016, -0.02610643208026886, 0.03339426964521408, 0.016048217192292213, 0.015399300493299961, 0.007755806669592857, 0.003840465797111392, 0.002246251329779625, 0.028402600437402725, 0.023660514503717422, -0.020428407937288284, -0.004242919385433197, 0.014463363215327263, 0.0004445705853868276, 0.014650550670921803, 0.026231223717331886, -0.00945921428501606, -0.014288654550909996, -0.009159713983535767, 0.03386848047375679, 0.0025956681929528713, -0.01217967364937067, 0.002739178715273738, 0.017932573333382607, 0.028452517464756966, -0.013015778735280037, -0.017183823511004448, -0.031472478061914444, -0.003784309606999159, -0.015549050644040108, -0.0015770556638017297, 0.02118963748216629, 0.037387605756521225, -0.012061121873557568, 0.02262474223971367, -0.0071630459278821945, 0.00839848443865776, 0.004136846400797367, -0.0033038612455129623, -0.016684655100107193, 0.0332944355905056, 0.010663454420864582, -0.024708764627575874, -0.02288680523633957, 0.025133056566119194, -0.015511613339185715, 0.0037749502807855606, 0.011618111282587051, 0.0001530648733023554, 0.021039888262748718, 0.036014895886182785, -0.03309477120637894, -0.006345659960061312, 0.006489170715212822, -0.00829865038394928, -0.0038186272140592337, -0.025494953617453575, -0.02045336551964283, 0.010757047683000565, -0.007556139957159758, -0.005107101984322071, -0.005965045187622309, 0.023111430928111076, -0.009209630079567432, -0.008342327550053596, 0.017770344391465187, 0.013365195132791996, -0.03536598011851311, 0.07467538118362427, -0.004860638175159693, -0.020041553303599358, 0.014787821099162102, -0.010700891725718975, 0.0034754499793052673, -0.013614779338240623, -0.004807601682841778, -0.05081519857048988, 0.0003318680392112583, -0.01754571869969368, 0.0364641472697258, -0.028402600437402725, -0.01854405365884304, 0.015673842281103134, 0.008972526527941227, -0.009559047408401966, 0.01992924138903618, 0.015885988250374794, -0.00207466259598732, 0.021801117807626724, 0.012248309329152107, -0.050964947789907455, 0.02440926432609558, -0.02197582647204399, 0.0030932752415537834, -0.026281140744686127, 0.0015325986314564943, -0.0012174993753433228, 0.01924288645386696, -0.014837738126516342, -0.0042086015455424786, -0.04365215077996254, 0.004776403773576021, -0.01334023755043745, 0.01723373867571354, -0.049167945981025696, 0.02705485001206398, -0.03681356459856033, 0.01591094769537449, -0.02425951510667801, 0.023847701027989388, -0.028202934190630913, -0.025806931778788567, 0.004923033993691206, 0.016260363161563873, -0.005593789741396904, -0.0004894176381640136, 0.009190911427140236, 0.01286602858453989, -0.0005623427568934858, -0.01563640497624874, 0.024970827624201775, -0.028402600437402725, 0.010838163085281849, -0.01813223958015442, -0.016971677541732788, 0.009920943528413773, -0.006570285186171532, 0.016984155401587486, -0.016672177240252495, 0.010108130984008312, -0.017470844089984894, 0.008604390546679497, 0.0020091470796614885, -0.012004965916275978, 0.0011246855137869716, 0.021439220756292343, 0.009596484713256359, 0.031846851110458374, 0.0009811751078814268, -0.0025613505858927965, -0.02155153453350067, 0.01241677813231945, -0.0028343324083834887, 0.007468785624951124, 0.0043146745301783085, 0.015761196613311768, -0.018519094213843346, 0.04195498302578926, -0.008254974149167538, 0.008910130709409714, 0.014513279311358929, 0.0026003478560596704, 0.025195453315973282, 0.028976641595363617, 6.912292883498594e-05, -0.00967136025428772, -0.007512462791055441, 0.015237071551382542, -0.012660122476518154, 0.00861063040792942, 0.015985822305083275, -0.010732090100646019, -0.0002862410619854927, -0.028776975348591805, 0.03306981176137924, -0.04946744814515114, -0.031422559171915054, 0.02800326608121395, -0.008791578002274036, -0.04090673103928566, 0.05765378475189209, 0.046422526240348816, -0.012117277830839157, 0.004448825493454933, -0.07467538118362427, 0.0025129937566816807, 0.02620626613497734, 0.026231223717331886, -0.015199634246528149, -0.013365195132791996, 0.02700493298470974, -0.004617294296622276, 0.019417595118284225, 0.007886838167905807, -0.05660553276538849, 0.011037829332053661, 0.015249551273882389, -0.029151350259780884, 0.01373957097530365, -0.04445081949234009, -0.009596484713256359, -0.02171376347541809, 0.00603680033236742, 0.006726274732500315, -0.009502891451120377, 0.027928391471505165, -0.022587304934859276, 0.00879781786352396, -0.027678808197379112, 0.004002694971859455, 0.003965257667005062, -0.008386004716157913, 0.03708810731768608, 0.0048138415440917015, -0.004339633043855429, 0.01366469543427229, -0.019816929474473, 0.002140178345143795, 0.002651824615895748, 0.004620414227247238, -0.0028171734884381294, 0.015449217520654202, 0.010650974698364735, -0.00409316923469305, -6.190840213093907e-05, -0.016197968274354935, 0.010051975026726723, -0.002469316590577364, 0.01217967364937067, -0.007724608760327101, -0.0412311926484108, 0.020790304988622665, 0.015499134548008442, 0.006292623467743397, -0.002516113454475999, -0.03344418853521347, 0.019192969426512718, -0.001815719879232347, 0.03903485834598541, 0.001865636557340622, 0.00845464039593935, -0.00047225874732248485, 0.019954198971390724, 0.0033568977378308773, -0.018631406128406525, -0.03546581417322159, 0.009259547106921673, -0.036963313817977905, 0.01437600888311863, 0.010276599787175655, -0.017682990059256554, -0.017346052452921867, -0.026356015354394913, -0.015187154524028301, 0.00039231404662132263, 0.00861063040792942, -0.010788246057927608, -0.003144752001389861, -0.010838163085281849, -0.02086517959833145, 0.03985848277807236, -0.0064018163830041885, -0.02742922492325306, 0.010089412331581116, 0.0061927903443574905, 0.016759531572461128, -0.01723373867571354, 0.023011596873402596, 0.026979975402355194, 0.008098984137177467, 0.003575283335521817, -0.04205481708049774, 0.01482525933533907, 0.012061121873557568, -0.014912612736225128, -0.0032165071461349726, -0.02235020138323307, 0.013727091252803802, 0.006482930853962898, -0.010619777254760265, 0.015311947092413902, 0.0008602830930612981, 0.01787017658352852, -0.019005782902240753, -0.0002833162434399128, -0.012148476205766201, -0.00824249442666769, 0.044051483273506165, 0.03059893473982811, -0.005537633318454027, -0.006738753989338875, -0.003419293789193034, 0.02309895120561123, 0.004139965865761042, 0.009864787571132183, 0.013302799314260483, -0.0006473571411333978, -0.006651399657130241, -0.015761196613311768, 0.020066512748599052, 0.02329861745238304, 0.0033724969252943993, -0.01806984469294548, 0.028652183711528778, 0.013851882889866829, -0.024034889414906502, 0.004270997364073992, 0.016896801069378853, 0.040607232600450516, -0.027404267340898514, -0.012791153974831104, -0.008891411125659943, 0.029151350259780884, -0.015311947092413902, -0.010320276953279972, 0.014363529160618782, -0.025757014751434326, 0.018993303179740906, -0.03386848047375679, 0.009702557697892189, -0.007312796078622341, -0.006807389669120312, -0.030723726376891136, 0.061697036027908325, 0.014850216917693615, 0.012635163962841034, -0.029151350259780884, 0.016148051247000694, 0.01164930872619152, 0.02515801601111889, 0.012242069467902184, -0.02019130438566208, -0.005378523841500282, -0.017470844089984894, 0.014088987372815609, -0.018643885850906372, 0.010451308451592922, 0.02150161750614643, -0.010282839648425579, -0.012061121873557568, -0.003569043707102537, 0.00209338148124516, -0.001181621802970767, 0.004099408630281687, 0.007531181443482637, -0.012965861707925797, -0.029351018369197845, -0.011106465011835098, 0.003893502289429307, 0.005793456453830004, 0.008517036214470863, -0.01568632200360298, 0.015511613339185715, 0.025382639840245247, 0.03716298192739487, -0.006373738404363394, 0.01627284288406372, -0.008673026226460934, 0.03494168817996979, -0.027129724621772766, 0.018668845295906067, 0.007325275335460901, 0.015299467369914055, 0.0010334316175431013, -0.033269479870796204, 0.0014850216684862971, -0.010650974698364735, 0.03059893473982811, -0.026281140744686127, -0.0192928034812212, 0.03623952344059944, -0.04053235799074173, -0.011087746359407902, -0.008417203091084957, -0.01653490588068962, -0.029351018369197845, 0.00837352592498064, 0.03651406243443489, -0.007375191897153854, -0.010370193980634212, -0.004782643634825945, -0.011418444104492664, 0.008167619816958904, 0.04522452875971794, -0.015062362886965275, 0.02852739207446575, -0.006857306230813265, -0.016073176637291908, 0.013914279639720917, -0.002188535174354911, 0.003197788493707776, 0.005846492946147919, -0.04801986366510391, 0.0013625698629766703, -0.019118094816803932, 0.0043146745301783085, 8.731765774427913e-06, 0.018531573936343193, -0.03978360816836357, 0.01705903187394142, 0.004841919522732496, 0.015286988578736782, 0.03007481060922146, -0.02658064104616642, 0.026979975402355194, 0.024970827624201775, -0.02732939086854458, 0.0033194604329764843, -0.013402633368968964, -0.00794923398643732, 0.011524517089128494, -0.00013444360229186714, 0.010133089497685432, 0.027753682807087898, 0.004795122891664505, 0.02176368050277233, 0.030873477458953857, -0.02324870228767395, 0.010838163085281849, -0.0003550715046003461, -0.019804449751973152, -0.013277841731905937, -0.024271992966532707, 0.013065695762634277, 0.007462546229362488, -0.011799058876931667, -0.007811963092535734, 0.0023336056619882584, 0.022649701684713364, 0.0018609568942338228, -0.01329032052308321, -0.04267877712845802, 0.016497468575835228, 0.008566953241825104, 0.030349351465702057, 0.003459851024672389, -0.0443759448826313, -0.004383309744298458, -0.01347750797867775, 0.003980856388807297, 0.03666381537914276, 0.01143716275691986, 0.03621456399559975, -0.01329032052308321, -0.009877266362309456, -0.024571493268013, -0.01707150973379612, -0.007450066972523928, 0.006470451597124338, 0.03905981406569481, 0.015099801123142242, 0.029500767588615417, -0.01707150973379612, -0.011655548587441444, -0.03139760345220566, -0.009078599512577057, 0.002481795847415924, -0.01913057453930378, 0.02785351686179638, -0.028976641595363617, -0.021177157759666443, -0.013652216643095016, 0.01806984469294548, 0.013440070673823357, -0.01281611155718565, 0.009134755469858646, 0.0031572310253977776]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
",s1:τ)!
ψ∗
t(s1:t,ot:T).(41)
We discuss the choice of parameterization using ψtversus Φtin App. B.4.
The conditional twist learning formulation matches the setting of Lawson et al. (2022), to which we refer the reader for
additional discussion. We use this conditional perspective to derive classification losses for twist learning in App. C.3-C.4.
8Note, rescaling ϕt(s1:t, ot= 1) by a constant cwith respect to ot,s1:tdoes not affect the target posterior in Eq. (38). For example,
with terminal potential only: σ(s1:T|oT) =p0(s1:T)ϕT(s1:T,oT)/cP
s1:Tp0(s1:T)ϕT(s1:T,oT)/c=1
Zσ(oT)p0(s1:T)ϕT(s1:T, oT)as long as the scaling factor
is independent of oTands1:T.
21
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Unconditional Targets as a Special Case In cases where we are only learning twists for a single set of conditioning
information such as a single classifier label or a reward model, note that we can omit explicit conditioning information in
ψt(s1:t, ot)and consider setting {ot= 1}T
t=1. With terminal potential only as in the main text, we write σ(oT= 1|s1:T) =
ϕ(s1:T)and the overall target distribution as σ(s1:T) =σ(s1:T|oT= 1)∝p0(s1:T)ϕT(s1:T). Thus, the formulation in
Eq. (38)-Eq. (40) strictly generalizes our exposition in the main text and App. B.1. With intermediate potentials , we set
σ(o1:T=1|s1:T) =QT
t=1ϕt(s1:t).
Our notation also matches the exposition in Levine (2018) for the soft RL case with a binary observation or ‘optimality’
random variable σ(ot= 1|s1:t−1, st) =eβrt(s1:t−1,st), where the reward is a function of the state xt=s1:t−1and action
at=stpair (see the MDP interpretation in App. B.3).
B.3. Connection with Soft Reinforcement Learning
In this section, we more explicitly describe the soft reinforcement learning setting (Levine, 2018) commonly used in RLHF
(Korbak et al., 2022b) as a special case of our probabilistic framework. Again, we use notation(sRL)=to indicate that the
expressions in this section correspond to a particular instance of our SMC framework where ϕ(s1:T) =eβr(s1:T).
Summary of Soft RL Notation To summarize the below derivations, we state the relevant assignments for the soft RL
case. We focus on the optimal case for simplicity, but note that approximate versions play identical roles,
ϕt(s1:t) =eβ rt(s1:t)ψ∗
t(s1:t) =eβrt(s1:t)+βV∗
t(s1:t)=eβQ∗
t(st,s1:t−1)Φ∗
t(s1:t) =eβV∗
t(s1:t)(Twist to Soft RL)
where ψ∗
t(s1:t) =ϕt(s1:t)Φ∗
t(s1:t)orQ∗
t(st,s1:t−1) =rt(s1:t) +V∗
t(s1:t). In the other direction, we have
rt(s1:t) =1
βlogϕt(s1:t) Q∗
t(st,s1:t−1) =1
βlogψ∗
t(s1:t) V∗
t(s1:t) =1
βlogΦ∗
t(s1:t) (Soft RL to Twist)
MDP Interpretation To draw connections with soft RL, we view language model controlled decoding as a MDP ,
where the prompt is drawn from an initial state distribution s0∼ν0, an action policy π(at|xt) =q(st|s1:t−1)selects
the next token at=stgiven a partial sequence xt=s1:t−1as the state, and deterministic environment transitions
P(xt+1=s1:t|at=st,","[-0.012744489125907421, -0.02254699170589447, -0.002770473947748542, -0.020964747294783592, -0.012386011891067028, 0.021656978875398636, 0.03812221437692642, 0.03864138945937157, -0.03997641056776047, 0.03157073259353638, 0.028604023158550262, -0.018776798620820045, -0.023770758882164955, 0.02991431951522827, 0.03992696478962898, -0.03831999748945236, 0.03856722265481949, 0.030433494597673416, -0.02988959662616253, 0.017911508679389954, -0.021434474736452103, -0.03545217588543892, -0.018183456733822823, 0.046255942434072495, -0.012083159759640694, -0.016934966668486595, 0.0207669660449028, -3.326925070723519e-05, 0.00595505116507411, 0.017169831320643425, 0.038072772324085236, -0.016601210460066795, -0.01698441058397293, -0.046354833990335464, -0.02838152088224888, 0.04969238117337227, -0.0025000707246363163, 0.031002113595604897, -0.00029956811340525746, 0.04870348051190376, -0.00024259030760731548, -0.07110213488340378, -0.04662678390741348, 0.05275798216462135, 0.0038443610537797213, 0.05171963572502136, -0.010822308249771595, 0.010624527931213379, -0.008912489749491215, 0.046552613377571106, -0.05498301610350609, 0.047195401042699814, -0.019011663272976875, -0.0027349351439625025, -0.0044377027079463005, -0.0030856868252158165, 0.02019834704697132, -0.0007177273510023952, 0.03045821748673916, -0.03577357158064842, 0.005933418869972229, -0.01872735284268856, 0.008535469882190228, 0.03446327522397041, 0.003220115788280964, -0.01556286308914423, -0.07431606948375702, 0.037973880767822266, -0.007799973711371422, 0.04939571022987366, 0.008170812390744686, -0.004450064152479172, 0.03018626756966114, 0.011001547798514366, -0.013374915346503258, 0.0395314022898674, 0.014561599120497704, 0.06002642214298248, 0.018208179622888565, -0.01269504427909851, 0.014932437799870968, -0.05498301610350609, 0.018653186038136482, -0.03839416429400444, 0.004187386482954025, -0.05518079549074173, -0.021113082766532898, -0.025254113599658012, -0.010482373647391796, -0.026057597249746323, 0.024005623534321785, 0.010241327807307243, -0.017231637611985207, -0.003708386793732643, 0.03411715850234032, -0.011557805351912975, 0.004592218901962042, -0.013857005164027214, 0.007861780002713203, -0.010680153965950012, 0.010983005166053772, -0.013140050694346428, 0.019085830077528954, -0.03129878267645836, 0.02961764857172966, 0.008263521827757359, -0.006335160695016384, 0.026008153334259987, -0.07387106120586395, -0.019839869812130928, -0.0448962040245533, -0.014215482398867607, -0.008461302146315575, 0.02321450039744377, 0.004975419025868177, -0.047689855098724365, -0.05404355749487877, -0.02123669534921646, -0.029494035989046097, -0.015253830701112747, -0.02877708151936531, -0.01604495383799076, 0.015105495229363441, -0.002931170631200075, 0.012107882648706436, 0.01869026944041252, -0.013992979191243649, -0.054093003273010254, 0.01721927523612976, 0.03681191802024841, 0.013498527929186821, 0.012318024411797523, -0.04024835675954819, -0.03594662994146347, -0.012954630888998508, -0.02593398466706276, 0.014536876231431961, 0.012503444217145443, 0.010698695667088032, -0.008869225159287453, 0.003958703018724918, -0.02885124832391739, -0.03666358441114426, -0.0070521156303584576, -0.016465237364172935, 0.01325130183249712, -0.040223635733127594, -0.019815146923065186, 0.0005659152520820498, 0.0014810370048508048, -0.01796095259487629, -0.01822054013609886, -0.02515522390604019, 0.02689816616475582, 0.005534767173230648, -0.043833132833242416, -0.027714010328054428, 0.06269645690917969, 0.042399220168590546, 0.019605005159974098, 0.024104513227939606, 0.03082905523478985, -0.0030625094659626484, -0.018109288066625595, 0.03629274666309357, -0.0026993965730071068, 0.001122559537179768, 0.030210990458726883, -0.030136823654174805, -0.019246527925133705, -0.008918670006096363, -0.011873017996549606, -0.066355399787426, -0.05364799499511719, 0.024067429825663567, -0.020124178379774094, -0.007855599746108055, -0.057405825704336166, -0.008584915660321712, -0.019876953214406967, -0.0014833547174930573, 0.027788178995251656, -0.023202139884233475, -0.00889394711703062, 0.002062790095806122, 0.019357778131961823, -0.008819779381155968, 0.012503444217145443, 0.014388540759682655, -0.0032510191667824984, 0.008467483334243298, 0.03782554343342781, 0.07560164481401443, -0.019283611327409744, -0.03436438366770744, -0.0009510467061772943, 0.05068128556013107, 0.026156488806009293, 0.028233185410499573, -0.00279365130700171, 0.010043547488749027, 0.02121197246015072, -0.022052539512515068, -0.030581830069422722, -0.0024305384140461683, 0.003427167423069477, -0.016539404168725014, 0.015414527617394924, -0.07273382693529129, -0.002714848145842552, 0.019778063520789146, -0.0002852753677871078, 0.024104513227939606, 0.01273212768137455, -0.04998905211687088, 0.016502320766448975, -0.02505633234977722, -0.0053122639656066895, -0.018714992329478264, 0.0455637127161026, -0.0050186836160719395, 0.022794216871261597, 0.025612590834498405, 0.013832282274961472, -0.05656525865197182, 9.879373828880489e-05, 0.023127971217036247, 0.0029883417300879955, 0.051175735890865326, -0.021891843527555466, 0.0723877102136612, 0.005649109371006489, -0.04150920733809471, -0.03562523424625397, 0.00548532186076045, -0.04583565890789032, -0.00834386982023716, 0.0009371402557007968, -0.005231915507465601, -0.06610817462205887, 0.0032541092950850725, 0.018554294481873512, 0.02262115851044655, -0.01725636050105095, 0.05216464027762413, 0.0167495459318161, -0.010185702703893185, -0.004888889845460653, 0.032979920506477356, -0.011601069942116737, 0.026552049443125725, -0.03129878267645836, -0.00782469566911459, 0.01906110718846321, -0.042597003281116486, -0.005967412143945694, 0.008127547800540924, 0.0222750436514616, -0.046577338129282, 0.0012932998361065984, 0.022262681275606155, -0.04586038365960121, -0.015204385854303837, 0.0185913797467947, -0.004975419025868177, -0.02217615209519863, -0.024042706936597824, -0.0013442902127280831, 0.05045878142118454, -0.018208179622888565, -0.025538424029946327, 0.024598965421319008, -0.03876500204205513, 0.03913583979010582, -0.026675662025809288, -0.055526912212371826, 0.032955195754766464, 0.026626216247677803, -0.03332603722810745, 0.06259756535291672, -0.014314373023808002, -0.022126708179712296, 0.05142296478152275, 0.015822449699044228, 0.0036960255820304155, -0.000978859607130289, -0.014944798313081264, 0.005803625099360943, -0.027763456106185913, -0.04586038365960121, -0.019122913479804993, 0.0175901148468256, 0.03678719699382782, -0.03468577563762665, 0.01796095259487629, 0.041459765285253525, 0.026107043027877808, 0.004212109372019768, 0.023461727425456047, 0.034586887806653976, 0.06215256080031395, 0.014932437799870968, -0.03609496355056763, 0.03540273383259773, 0.031372953206300735, 0.009221522137522697, 0.027219558134675026, 0.0019113643793389201, 0.002059699734672904, 0.006755444686859846, -0.026848720386624336, -0.0050186836160719395, 0.011322940699756145, 0.0160820372402668, -0.015068411827087402, -0.008943392895162106, 0.01852957159280777, 0.005652199499309063, 0.028332075104117393, -0.025958707556128502, -0.04123726114630699, 0.0009765418362803757, 0.012552889063954353, 0.011662876233458519, 0.021459197625517845, 0.0003791439230553806, -0.01321421843022108, 0.003122770693153143, -0.029222087934613228, 0.013004076667129993, 0.0011665966594591737, -0.04274533689022064, 0.04808541387319565, 0.023140333592891693, -0.04840680956840515, -0.039111118763685226, -0.042127273976802826, 0.05171963572502136, -0.0067925285547971725, 0.03226296603679657, -0.06442704051733017, 0.007151005789637566, -0.029444590210914612, -0.022695327177643776, -0.04284422844648361, 0.0020658804569393396, 0.02009945549070835, -0.00032892616582103074, 0.08059560507535934, 0.007367328274995089, 0.0009116450673900545, -0.042597003281116486, 0.03263380378484726, -0.01805984415113926, -0.03980335220694542, 0.0027071223594248295, -0.01561230793595314, -0.03836944326758385, -0.033054087311029434, -0.000501791073475033, -0.034858833998441696, -0.01645287498831749, 0.002435174072161317, -0.009221522137522697, 0.00860963761806488, 0.01962972804903984, 0.003189212642610073, 0.021570449694991112, -0.009277147240936756, -0.006872877012938261, 0.009709792211651802, 0.01470993459224701, -0.007460038177669048, 0.01584717258810997, -0.04917320981621742, -0.038245826959609985, 0.013597418554127216, -0.01805984415113926, 0.02137266844511032, 0.010797586292028427, -0.007280799560248852, 0.010000282898545265, -0.022806579247117043, 0.01470993459224701, 0.005735638085752726, -0.008906308561563492, -0.011131340637803078, -0.021125443279743195, -0.017503585666418076, -0.006196096073836088, 0.03747943043708801, 0.004904341418296099, -0.03960556909441948, 0.04200366139411926, -0.0030640545301139355, -0.0037980061024427414, -0.05280742794275284, 0.048332639038562775, 0.05265909060835838, 0.0227818563580513, -0.025513701140880585, -0.0239561777561903, -0.045118704438209534, -0.0020025288686156273, -0.020618630573153496, 0.011897740885615349, -0.009895212016999722, 0.02197837270796299, -0.006724541541188955, 0.03564995899796486, 0.03535328805446625, -0.03893806040287018, 0.028159016743302345, -0.008078102022409439, 0.034092433750629425, -0.05424133688211441, 0.013634501956403255, -0.008380954153835773, 0.05705971270799637, 0.08010115474462509, 0.025686759501695633, -0.022670604288578033, -0.006233179941773415, 0.02201545611023903, -0.018875688314437866, 0.02411687560379505, 0.047590963542461395, -0.016934966668486595, 0.03112572617828846, -0.01588425599038601, 0.021570449694991112, 0.038344718515872955, 0.004789999686181545, -0.03461160883307457, -0.012280941009521484, -0.015439250506460667, 0.049840718507766724, 0.02887597121298313, -0.03226296603679657, -0.0596308596432209, 0.04294312000274658, -0.007670179940760136, -0.03537800908088684, 0.01631690189242363, -0.018109288066625595, 0.03260907903313637, -0.020754603669047356, -0.04793708026409149, -0.004329541698098183, -0.017404695972800255, -0.0029188094194978476, 0.03775137662887573, 0.04998905211687088, -0.017132746055722237, 0.00851074792444706, -0.017070939764380455, 0.0911274254322052, 0.005414244718849659, 0.03723220154643059, -0.019753340631723404, -0.004419161006808281, 0.009388399310410023, -0.02201545611023903, -0.04526704177260399, 0.009036102332174778, 0.04492092505097389, 0.05903751775622368, -0.0242899339646101, -0.005717096384614706, 0.02791179157793522, 0.0020689708180725574, 0.010235147550702095, 0.016440514475107193, -0.02515522390604019, -0.0038227287586778402, 0.0041997479274868965, 0.03982807323336601, -0.03696025535464287, 0.06462481617927551, 0.0005817531491629779, 0.0047590965405106544, 0.011403289623558521, 0.007472399156540632, -0.020779326558113098, 0.005612025503069162, 0.06650373339653015, 0.02241101674735546, -0.03095266781747341, -4.4061234802939e-05, 0.008900128304958344, -0.015834812074899673, -0.04328923299908638, -0.026255378499627113, -0.012831018306314945, 0.025909261777997017, -0.0479123555123806, 0.021830037236213684, -0.021459197625517845, -0.020062372088432312, -0.0368613637983799, 0.04195421561598778, 0.010296953842043877, 0.03478466719388962, 0.04061919450759888, 0.02019834704697132, 0.07129991799592972, 0.008801237680017948, -0.01829470880329609, -0.015117856673896313, 0.06897599250078201, 0.008263521827757359, 0.0015428434126079082, -0.04432758316397667, 0.009153534658253193, -0.004688018932938576, -0.0022559352219104767, -0.04595927149057388, -0.028801804408431053, -0.006440231576561928, 0.01915999874472618, 0.0032726512290537357, -0.020927662029862404, -0.02687344327569008, -0.014079508371651173, 0.030606552958488464, 0.007694902364164591, -0.015253830701112747, -0.08830904960632324, -0.035872459411621094, -0.04385785385966301, 0.0019994385074824095, -0.01594606228172779, 0.009889031760394573, 0.011075715534389019, -0.030631273984909058, 0.04108892381191254, -0.0522635318338871, -0.02981542982161045, -0.02258407510817051, -0.001382146612741053, -0.00530299311503768, -0.017577752470970154, 0.008207895793020725, 0.023189779371023178, 0.020482655614614487, -0.004468605853617191, -0.010661612264811993, 0.0020025288686156273, 0.007348786573857069, 0.0375288724899292, 0.002983706071972847, -0.027615120634436607, -0.029568204656243324, -0.024104513227939606, -0.012095521204173565, -0.01085321232676506, -0.010537998750805855, -0.01882624253630638, 0.016737185418605804, 0.036737751215696335, 0.013510889373719692, -0.017713727429509163, -0.02248518541455269, 0.010760501958429813, -0.041731711477041245, 0.005500773899257183, 0.015599947422742844, -0.006947044748812914, -0.0005570306093432009, 0.0160820372402668, -0.04736845940351486, 0.013918811455368996, 0.010772863402962685, -0.04094059020280838, -0.015587585978209972, -0.04027308151125908, 0.029840152710676193, -0.018949856981635094, -0.013696308247745037, -0.004249193239957094, -0.017404695972800255, -0.031546011567115784, 0.021496281027793884, -0.025884538888931274, -0.038616668432950974, 0.010160979814827442, -0.0014802643563598394, 0.0031073191203176975, -0.036169130355119705, -0.001631690189242363, 0.01425256673246622, -0.01268268283456564, -0.010983005166053772, 0.014833547174930573, -0.06200422719120979, -0.012101702392101288, -0.02211434580385685, -0.017911508679389954, -0.041830603033304214, 0.014944798313081264, -0.0036280383355915546, 0.011452734470367432, 0.031199894845485687, -0.010123895481228828, -0.032979920506477356, 0.06195478141307831, -0.05300520732998848, 0.02867819182574749, 0.03443855047225952, 0.003479702863842249, 0.026848720386624336, 0.0318179577589035, 0.013659224845468998, 0.0033715416211634874, 0.009944656863808632, -0.01618092693388462, 0.009172076359391212, -0.012206773273646832, 0.04904959723353386, -0.015451611950993538, -0.011811211705207825, 0.012367470189929008, 0.028332075104117393, -0.004428431857377291, -0.0010476192692294717, 0.0015528869116678834, -0.01892513409256935, -0.019048746675252914, 0.05078017711639404, 0.0012546709040179849, -0.03320242092013359, 0.0017939320532605052, 0.0017568481853231788, 0.019839869812130928, -0.02375839836895466, -0.031150449067354202, 0.00010352579556638375, -0.019642088562250137, 0.012274759821593761, -0.018418321385979652, -0.007212812080979347, 0.0035167867317795753, -0.015154941007494926, -0.02056918479502201, 0.06378424912691116, 0.026823997497558594, -0.02147156000137329, 0.03698497638106346, -0.008479844778776169, -0.016737185418605804, -0.01500660553574562, -0.016465237364172935, 0.04084169864654541, -0.014648127369582653, 0.0361938551068306, -0.017528308555483818, 0.001504214364103973, 0.0044160704128444195, 0.03159545361995697, -0.030606552958488464, -0.0124787213280797, -0.008659083396196365, 0.0008923305431380868, 0.013906450010836124, -0.006072483491152525, 0.02321450039744377, -0.006600928492844105, 0.06684985011816025, -0.011607250198721886, -0.037578318268060684, -0.04000113159418106, 0.037306372076272964, 0.04487147927284241, 0.009746876545250416, 0.00022385522606782615, -0.03762776404619217, 0.018541933968663216, -0.03253491222858429, -0.014104231260716915, 0.028554577380418777, -0.015142579562962055, -0.01949375309050083, -0.04291839525103569, -0.018702629953622818, -0.00041951125604100525, -0.004518051166087389, 0.015958424657583237, -0.00200098380446434, -0.014425624161958694, -0.013758114539086819, -0.007404412142932415, -0.00737968971952796, 0.031002113595604897, -0.028455687686800957, 0.0111375218257308, -0.02493271976709366, 0.013894089497625828, 0.04855514317750931, 0.00648349616676569, -0.03436438366770744, -0.00829442497342825, 0.04000113159418106, -2.1173536879359744e-05, -0.020396126434206963, -0.010012644343078136, -0.014598682522773743, -0.005958141293376684, 0.04351173713803291, 0.019876953214406967, -0.01772608794271946, -0.012620876543223858, 0.01419076044112444, -0.01939486339688301, 0.02262115851044655, -0.010865572839975357, 0.03836944326758385, 0.017565391957759857, 0.01949375309050083, 0.01953083649277687, 0.011038631200790405, -0.018517211079597473, -0.021792951971292496, -0.03745470568537712, -0.01296699233353138, -0.009085547178983688, -0.025315919890999794, -0.04647844657301903, 0.006072483491152525, 0.008968114852905273, 0.007330244407057762, 0.0035044255200773478, -0.010142438113689423, -0.01249726302921772, -0.011446554213762283, -0.0063289799727499485, 0.046255942434072495, 0.0034426189959049225, 0.0069099608808755875, -0.025340642780065536, -0.003930890001356602, 0.03152128681540489, -0.018739715218544006, -0.05162074416875839, 0.039383068680763245, 0.0475662425160408, 0.0415339320898056, 0.02857930026948452, 0.03782554343342781, 0.011681417934596539, 0.008393315598368645, -0.020359043031930923, 0.009036102332174778, -0.023535894230008125, -0.01862846314907074, 0.011687599122524261, -0.0035044255200773478, 0.0015899707796052098, -0.020692797377705574, -0.02238629385828972, 0.002361006336286664, -0.009376037865877151, 0.012182050384581089, -0.01768900454044342, -0.006675096228718758, -0.02458660490810871, 0.0021585901267826557, -0.014215482398867607, -0.021199610084295273, 0.015587585978209972, 0.01301643718034029, -0.010680153965950012, 0.021360307931900024, -0.033820487558841705, 0.011582528240978718, 0.04375896230340004, 0.0167495459318161, -0.00902992207556963, 0.010704876855015755, -0.009054644033312798, -0.013992979191243649, -0.004289367236196995, 0.005525496322661638, 0.01085321232676506, -0.04914848506450653, -0.03972918167710304, -0.017145108431577682, 0.007089199498295784, -0.018146373331546783, -0.017281081527471542, -0.019122913479804993, -0.016477597877383232, 0.002119961194694042, -0.018047481775283813, -0.011292037554085255, 0.021928926929831505, 0.020927662029862404, 0.005102122202515602, -0.11876726895570755, -0.023276306688785553, 0.0008954209042713046, -0.008640540763735771, 0.03204046189785004, -0.03357326239347458, 0.008152269758284092, -0.0032232061494141817, 0.008226437494158745, -0.04684928432106972, -0.0118915606290102, -0.015167301520705223, 0.005179380066692829, 0.03129878267645836, 0.0187644362449646, -0.054389674216508865, 0.0033529996871948242, -0.00015519211592618376, 0.032114628702402115, -0.010741960257291794, -0.01242927648127079, 0.012954630888998508, 0.009252425283193588, 0.05602136254310608, -0.06872876733541489, -0.0011032450711354613, 0.02040848881006241, 0.02274477295577526, 0.0036280383355915546, 0.015167301520705223, -0.015834812074899673, -0.03488355875015259, -0.006903780158609152, 0.03354853764176369, -0.032213520258665085, -0.003118135267868638, 0.008282063528895378, -0.012756850570440292, 0.004502599593251944, 0.017775533720850945, 0.02331339195370674, -0.03725692629814148, 0.07515663653612137, 0.024203404784202576, 0.035031892359256744, -0.0011465095449239016, 0.0063166189938783646, -0.033721596002578735, 0.02389437146484852, -0.034389104694128036, 0.02238629385828972, 0.015216747298836708, -0.0019948030821979046, -0.01833179220557213, -0.011588708497583866, 0.025637313723564148, -0.009011379443109035, 0.00145322410389781, 0.035056617110967636, 0.024982165545225143, 0.010000282898545265, 0.0284804105758667, 0.05839473009109497, -0.01475937943905592, -0.04408035799860954, -0.03688608855009079, -0.005111393053084612, -0.00933277327567339, -0.004607670474797487, -0.007676360663026571, 0.011248772963881493, 0.005701644811779261, -0.004734373651444912, -4.7417132009286433e-05, 0.0015312547329813242, -0.02168170176446438, 0.0012932998361065984, 0.024104513227939606, -0.033177699893713, 0.008659083396196365, 0.06175700202584267, -0.04573677107691765, 0.012188231572508812, 0.025909261777997017, -0.026552049443125725, 0.01602023094892502, -0.0024259029887616634, 0.014660488814115524, -0.014573959633708, 0.035056617110967636, 0.039481956511735916, -0.005340076982975006, 0.005646018777042627, -0.05021155625581741, 0.007027392741292715, -0.012521985918283463, -0.04761568456888199, 0.0070088510401546955, 0.03678719699382782, -0.0007899636402726173, 0.037949156016111374, 0.03809749335050583, -0.03337547928094864, -0.007151005789637566, -0.0041008577682077885, 0.033894654363393784, -0.003828909248113632, 0.048827093094587326, 0.01136002503335476, -0.012219134718179703, 0.0013697854010388255, -0.013325469568371773, -0.017268721014261246, 0.01470993459224701, -0.003380812704563141, 0.008461302146315575, 0.055230241268873215, 0.027763456106185913, 0.015995508059859276, -0.008220257237553596, -1.715370308374986e-05, 0.00544514786452055, 0.002721028868108988, 0.001942267525009811, -0.019258888438344002, -0.04432758316397667, 0.001562157878652215, -0.00130257080309093, -0.012064618058502674, 0.009209160692989826, 0.00368984485976398, -0.026527326554059982, 0.03908639773726463, 0.006990308873355389, -0.02482146956026554, 0.050879064947366714, 0.03775137662887573, 0.017281081527471542, -0.049741826951503754, 0.005061947740614414, 0.023127971217036247, -0.0012484901817515492, -0.0030841417610645294, 0.03668830543756485, 0.027714010328054428, 0.007027392741292715, 0.0070088510401546955, -0.015822449699044228, -0.022571714594960213, 0.01137238647788763, 0.039185285568237305, 0.007812334690243006, 0.0041564833372831345, 0.017070939764380455, -0.007694902364164591, 0.021051274612545967, -0.0012106337817385793, -0.02576092630624771, -0.033424925059080124, 0.0038938061334192753, 0.009388399310410023, 0.04573677107691765, 0.008109006099402905, -0.034290216863155365, 0.014141314662992954, -0.0014115046942606568, 0.004552044905722141, 0.01882624253630638, -0.007799973711371422, 0.010877934284508228, -0.019258888438344002, -0.05265909060835838, 0.017899146303534508, 0.004125580191612244, 0.005602754186838865, 0.03770193085074425, 0.009518193081021309, 0.021558089181780815, 0.002319286810234189, 0.036638859659433365, 0.009685070253908634, 0.02160753309726715, -0.026057597249746323, -0.01504368893802166, 0.05483467876911163, -0.014907714910805225, -0.012892824597656727, -0.005531677044928074, 0.021335585042834282, 0.02325158566236496, -0.0035044255200773478, 0.013189495541155338, 0.006761625409126282, 0.03213935345411301, 0.04553898796439171, 0.0033900835551321507, -0.01611912064254284, 0.011335302144289017, -0.01169377937912941, -0.07105269283056259, -0.04442647472023964, 0.019716255366802216, -0.000968816049862653, -0.025254113599658012, -0.03102683648467064, 0.017528308555483818, -0.04037196934223175, -0.008801237680017948, 0.02262115851044655, -0.008109006099402905, 0.021990733221173286, -0.028406241908669472, -0.02448771335184574, 0.02603287436068058, 0.0022080352064222097, -0.028752358630299568, 0.0222750436514616, -0.02640371397137642, -0.036268021911382675, -0.009604721330106258, -0.04482203349471092, -0.03649052605032921, 0.0003982652851846069, 0.0009464112226851285, 0.0007401321781799197, -0.004969238303601742, 0.03611968830227852, 0.01892513409256935, 0.0060693928971886635, -0.010123895481228828, 0.0057974448427557945, 0.01400534063577652, -0.019617365673184395, 0.0008081193082034588, -0.019518475979566574, -0.009975560009479523, 0.00034032174153253436, -0.01933305710554123, -0.001499578938819468, 0.006427870597690344, 0.020025288686156273, 0.022052539512515068, 0.004159573931246996, -0.029296254739165306, 0.02707122266292572, -0.024364100769162178, 0.03708386793732643, 0.0459098294377327, -0.06002642214298248, -0.01504368893802166, -0.041360873728990555, 0.02446299046278, 0.03908639773726463, -0.016502320766448975, 0.013053521513938904, 0.00959854107350111, -0.0016595030901953578, 0.05063183978199959, 0.028999583795666695, -0.0010375756537541747, 0.002221941715106368, 0.009994102641940117, -0.01015479862689972, -0.013894089497625828, 0.010006463155150414, -0.028406241908669472, 0.006242451258003712, 0.013263663277029991, -0.006829612422734499, 0.0007300886209122837, -0.05176907777786255, -0.013807560317218304, 0.018838604912161827, 0.024945082142949104, 0.011162243783473969, -0.007249895948916674, -0.0004233741492498666, -0.02070515975356102, 0.02244810201227665, 0.008176992647349834, -0.023375198245048523, -0.04160809889435768, -0.028554577380418777, -0.014722295105457306, 0.060323093086481094, 0.019852230325341225, 0.026626216247677803, -0.023288669064641, 0.006953225005418062, 0.014499791897833347, 0.053054653108119965, 0.020161261782050133, -0.013782837428152561, -0.0062517221085727215, 0.007472399156540632, -0.03846833109855652, 0.016811354085803032, 0.005021773744374514, 0.015414527617394924, -0.01296699233353138, 0.009542915038764477, 0.019988205283880234, -0.015501056797802448, 0.035996075719594955, 0.01845540478825569, 0.010581263341009617, 0.019975842908024788, 0.0023996352683752775, -0.004385167267173529, -0.0153279984369874, -0.014227843843400478, -0.017664281651377678, -0.00907936692237854, 0.0341666042804718, 0.027887068688869476, -0.013597418554127216, -0.021026553586125374, -0.0207669660449028, 0.030112100765109062, -0.002336283680051565, -0.006452593021094799, -0.025587867945432663, 0.020297236740589142, 0.024772023782134056, -0.017070939764380455, -0.011786488816142082, -0.009963199496269226, -0.002999157877638936, 0.007342605851590633, 0.017577752470970154, -0.0007463128422386944, 0.01972861774265766, -0.011285857297480106, -0.007398231420665979, 0.009240063838660717, 0.009499650448560715, -0.0274667851626873, -0.015216747298836708, -0.029691817238926888, -0.009586179628968239, 0.019382501021027565, -0.017145108431577682, 0.016106760129332542, -0.00529372226446867, 0.01923416554927826, -0.002056609373539686, -0.021335585042834282, 0.014079508371651173, -0.006140470504760742, -0.03436438366770744, 0.061064768582582474, -0.0050526768900454044, -0.010025005787611008, -0.004752915818244219, -0.01224385667592287, 0.012435456737875938, -0.014042424969375134, -0.00931423157453537, -0.04781346768140793, 0.003458070568740368, -0.02632954530417919, 0.05290631949901581, -0.03780082240700722, 0.00417193491011858, 0.02679927460849285, -0.008714708499610424, -0.01805984415113926, 0.02838152088224888, 0.00646495446562767, 0.02623065561056137, 0.009036102332174778, 0.017033856362104416, -0.037133313715457916, -0.004054503049701452, -0.009765418246388435, 0.00032641529105603695, -0.013337831012904644, 0.02458660490810871, 0.006183735094964504, 0.0006570797995664179, -0.00038358624442480505, -0.011718502268195152, -0.03162017837166786, -0.010797586292028427, 0.005479141604155302, 0.010952102020382881, -0.01292990893125534, -0.004579857457429171, -0.011570166796445847, 0.021619895473122597, -0.014598682522773743, -0.00025070240371860564, -0.0055502187460660934, 0.0020519739482551813, 0.003807277185842395, 0.025711482390761375, -0.026650939136743546, -0.01749122329056263, 0.01377047598361969, 0.01480882428586483, 0.012589973397552967, -0.004035960882902145, 0.03386993333697319, -0.018405959010124207, 0.006301166955381632, -0.010439109057188034, -0.025612590834498405, 0.027145391330122948, 0.009400760754942894, 0.01551341824233532, -0.03950668126344681, 0.007787612266838551, -0.017145108431577682, -0.001631690189242363, 0.003909257706254721, -0.0020736062433570623, -0.006755444686859846, 0.032312408089637756, -0.012453998439013958, 0.05063183978199959, -0.011687599122524261, 0.002112235175445676, -0.0028430966194719076, 0.022991998121142387, -0.020556824281811714, 0.017812617123126984, 0.0071695479564368725, 0.0269723329693079, -0.018245263025164604, 0.0358477383852005, -0.004929063841700554, 0.027689287438988686, 0.010500915348529816, 0.0006690548034384847, 0.026156488806009293, 0.033993545919656754, -0.00014176854165270925, -0.01137238647788763, -0.011922463774681091, 0.00698412861675024, 0.005275180097669363, 0.017379973083734512, 0.022003095597028732, -0.004564405884593725, -0.001699677319265902, -0.02773873321712017, 0.014314373023808002, -0.020890578627586365, 0.02773873321712017, 0.01637870818376541, -0.017874423414468765, -0.03943251073360443, 0.06670151650905609, -0.006891418714076281, -0.035427454859018326, 0.013622140511870384, -0.03770193085074425, -0.025439532473683357, 0.025637313723564148, 0.04076753184199333, -0.005309173837304115, -0.01768900454044342, 0.016403431072831154, 0.006582386326044798, 0.032683249562978745, -0.015241469256579876, -0.050879064947366714, 0.012386011891067028, 0.007633096072822809, -0.04010002315044403, 0.019444307312369347, -0.04242394492030144, 0.021100720390677452, -0.008189354091882706, 0.02158281020820141, -7.95758023741655e-05, -0.01564939133822918, -0.0016177836805582047, 0.01522910874336958, 0.008448940701782703, -0.02466077171266079, 0.0010483918013051152, 0.019740978255867958, -7.223628199426457e-05, 0.021830037236213684, -0.0056707412004470825, -0.01688552089035511, 0.009808682836592197, -0.013374915346503258, 0.004076134879142046, 0.03337547928094864, -0.005794354248791933, 0.032411299645900726, 0.026725107803940773, 0.002858548192307353, -0.009715973399579525, 0.005630567204207182, -0.026156488806009293, 0.009802502579987049, 0.02576092630624771, -0.025884538888931274, 0.015117856673896313, -0.005757270380854607, 0.06719596683979034, 0.04640427976846695, -0.0051175737753510475, -0.003801096463575959, -0.03567468002438545, 0.02981542982161045, -0.013819921761751175, 0.0371827594935894, -0.03394410014152527, 0.01833179220557213, -0.0022095805034041405, 0.00312431575730443, -0.0016641385154798627, 0.006458773743361235, -0.014326734468340874, 0.0022281224373728037, -0.03772665560245514, 0.004147212486714125, 0.024945082142949104, -0.0019731707870960236, -0.030309882014989853, -0.008176992647349834, 0.001183593412861228, -0.007466218899935484, -0.008714708499610424, -0.03747943043708801, -0.020012926310300827, -0.008492205291986465, -0.03446327522397041, 0.041830603033304214, 0.011032450944185257, -0.021891843527555466, -0.00010989958536811173, 0.0153279984369874, 0.009493470191955566, -0.005698554217815399, 0.029296254739165306, 0.008220257237553596, 0.0029682544991374016, 0.0050526768900454044, -0.02707122266292572, 0.013325469568371773, -0.002367186825722456, -0.0015768369194120169, 0.012509624473750591, -0.008572554215788841, 0.035229675471782684, 0.009802502579987049, 0.0131524121388793, 0.024265211075544357, -0.0031304964795708656, -0.03176851198077202, -0.001657957909628749, -0.006699818652123213, -0.0040792254731059074, 0.010018824599683285, 0.014969521202147007, -0.006712180096656084, 0.003977244719862938, 0.0005222644540481269, 0.01561230793595314, 0.025513701140880585, 0.0375288724899292, 0.005924148019403219, -0.00856019277125597, -0.00543587701395154, -0.01564939133822918, -0.015018966048955917, 0.01068633422255516, 0.003946341574192047, 0.013857005164027214, -0.022262681275606155, 0.012107882648706436, -0.0006354475044645369, -0.016341624781489372, 0.013906450010836124, 0.012559070251882076, 0.03970446065068245, -0.0462312214076519, -0.004366625566035509, 0.0052782706916332245, 0.020791688933968544, -0.007651638239622116, 0.017206914722919464, -0.003383902832865715, -0.011131340637803078, 0.020556824281811714, -0.03478466719388962, 0.01042056642472744, -0.0022559352219104767, 0.015154941007494926, -0.04044613987207413, 0.0680365338921547, -0.001772299874573946, 0.002980615943670273, -0.055971916764974594, 0.021595172584056854, 0.009858127683401108, 0.013350192457437515, 0.007373508997261524, -0.022200874984264374, 0.025315919890999794, -0.032485466450452805, 0.02419104240834713, -0.03404299169778824, 0.016242733225226402, 0.03223824128508568, -0.023931456729769707, -0.0263048242777586, 0.01631690189242363, 0.011230231262743473, 0.007540386635810137, 0.00860963761806488, -0.0116443345323205, -0.018739715218544006, -0.01939486339688301, -0.009481108747422695, 0.002464531920850277, 0.0080410186201334, -0.007194270379841328, -0.008504566736519337, -0.013115327805280685, 0.023066164925694466, 0.023708952590823174, -0.0012137240264564753, 0.010414386168122292, -0.010661612264811993, 0.040149468928575516, -0.01996348239481449, 0.010198063217103481, 0.007435315288603306, 0.006570025347173214, -0.010284592397511005, -0.025414811447262764, -0.002645315835252404, 0.007410592865198851, 0.039111118763685226, -0.055526912212371826, -0.019320694729685783, 0.01395589578896761, -0.03792443498969078, -0.016230372712016106, 0.014400902204215527, 0.0070644766092300415, -0.02311561070382595, 0.011254954151809216, 0.028752358630299568, 0.0023980902042239904, -0.020247790962457657, -0.005902515724301338, 0.02030959725379944, 0.023140333592891693, 0.038048047572374344, -0.03945723548531532, 0.026725107803940773, -0.011477457359433174, -0.019221805036067963, 0.02734317258000374, 0.01246635988354683, 0.00856019277125597, 0.01447506994009018, -0.015575224533677101, 0.013634501956403255, -0.0027812900952994823, 0.007571289781481028, -0.0012724401894956827, 0.018418321385979652, -0.02207726240158081, -0.0016146934358403087, 0.011069534346461296, 0.026107043027877808, 0.03535328805446625, -0.011866837739944458, 0.0019546288531273603, 0.019654449075460434, -0.01195954717695713, -0.008850683458149433, 0.01692260429263115, 0.016663018614053726, 0.009277147240936756, -0.005871612578630447, 0.006001405883580446, 0.00017431349260732532, 0.011094257235527039, 0.033622708171606064, 0.02838152088224888, -0.009672708809375763, -0.003933980129659176, 0.02030959725379944, -0.033993545919656754, -0.011322940699756145, -0.026576772332191467, 0.0073858704417943954, 0.006214638240635395, -0.005309173837304115, 0.007725805975496769, -0.005129935219883919, 0.020878218114376068, 0.02342464216053486, -0.022287404164671898, -0.03142239898443222, 0.0180969275534153, 4.2926509195240214e-05, 0.01882624253630638, -0.023535894230008125, -0.044278137385845184, 0.001729035284370184, -0.03829527273774147, -0.01344908308237791, 0.026749830693006516, -0.005358618684113026, 0.011842114850878716, -0.027095945551991463, -0.011316760443150997, -0.023943817242980003, 0.012651779688894749, -0.0187644362449646, 0.024030346423387527, 0.015698837116360664, 0.009320411831140518, 0.0023347383830696344, -0.02539008855819702, -0.0502610020339489, -0.02174350805580616, -0.02924681082367897, 0.023189779371023178, -0.0003453435201663524, 0.015501056797802448, -0.04195421561598778, -0.001630145008675754, -0.018072204664349556, 0.010550360195338726, -0.007855599746108055, -0.012002811767160892, 0.01872735284268856, -0.014784102328121662]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" xt=s1:t−1) = δ(xt=concat (st,s1:t−1))append the selected token to update the state.
Discounting may also be included without difficulty. The reward is given by rt(s1:t).
Final Target Distribution We define the target distribution as the solution to the following variational optimization which
solves the regularized MDP described above,
σ(s1:T)(sRL)=1
Zσp0(s1:T)eβTP
t=1rt(s1:t)
=arg max
q(s1:T)Eq(s1:T)hTX
t=1rt(s1:t)i
−1
βDKL(q(s1:T)∥p0(s1:T)) (42)
which corresponds to the choice ϕt(s1:t) =eβ rt(s1:t)as in Eq. (Twist to Soft RL). The soft value is defined as the maximum
value of the above optimization for optimal q∗(s1:T), and corresponds to the scaled log partition function
V∗
0(s0):=1
βlogZσ=1
βlogX
s1:Tp0(s1:T)eβTP
t=1rt(s1:t)
=max
q(s1:T)Eq(s1:T)hTX
t=1rt(s1:t)i
−1
βDKL(q(s1:T)∥p0(s1:T)) (43)
which can be confirmed by substituting q(s1:T) =σ(s1:T)from Eq. (42) into the maximization on the right side of Eq. (43).
Although we omit the dependence of Zσ(s0)on the prompt s0for notational simplicity (see Eq. (1)), note that V∗
0:=V∗(s0)
naturally corresponds to the soft value of the prompt as the initial state in the MDP.
22
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Optimal Intermediate Marginals and Soft Value Decomposing the maximization in Eq. (43) into optimizations over
eachq(st+1|s1:t), we define the intermediate soft value V∗
t(s1:t)as the maximum of the expected future regularized reward
V∗
t(s1:t) =1
βlogΦ∗
t(s1:t)(sRL)=1
βlogX
st+1:Tp0(st+1:T|s1:t)eβTP
τ=t+1rτ(s1:τ)
(Optimal Intermediate Soft Value)
= max
q(st+1:T|s1:t)Eq(st+1:T|s1:t)hTX
τ=t+1rτ(s1:τ)i
−1
βDKL(q(st+1:T|s1:t)∥p0(st+1:T|s1:t))
= max
q(st+1|s1:t)Eq(st+1|s1:t)h
rt+1(s1:t+1) +V∗
t+1(s1:t+1)i
−1
βDKL(q(st+1|s1:t)∥p0(st+1|s1:t))
where, in the third line, we isolate the optimization over q(st|s1:t−1)by (i) assuming optimality at τ < t and (ii) substituting
the optimal value V∗
t+1(s1:t+1) = max q(st+2:T|s1:t+1)[...]of the maximization over q(st+2:T|s1:t+1)(i.e. recursively
applying the second line).
The optimal intermediate marginal can be written using either V∗
t(s1:t)orQ∗
t(st,s1:t−1)form (as in Eq. (33) above, or by
substituting the optimal V∗
torQ∗
tinto the twist targets below).
Twisted Intermediate Targets We state the approximate twisting targets for bothVtorQtparameterizations in order to
make connections with soft RL losses in App. C. For approximate Vt(s1:t)orQt(st,s1:t−1), we have
πt(s1:t)(sRL)=1
ZV
tp0(s1:t)eβt−1P
τ=1rτ(s1:τ)
eβrt(s1:t)+βVt(s1:t)(t < T ) (Twist Targets (Soft RL V))
=1
ZQ
tp0(s1:t)eβt−1P
τ=1rτ(s1:τ)
","[0.01975950598716736, -0.011796057224273682, 0.017424406483769417, -0.016041114926338196, -0.0243789404630661, 0.014162883162498474, 0.02756432071328163, 0.057514503598213196, -0.03423965722322464, 0.010501599870622158, 0.040788087993860245, 0.016396455466747284, -0.041651058942079544, -0.004375137854367495, 0.023262154310941696, -0.04053427278995514, 0.028046568855643272, 0.0016220371471717954, -0.043478529900312424, 0.01461974997073412, -0.024442395195364952, -0.029493315145373344, -0.015431958250701427, 0.019924486055970192, -0.005295217502862215, -0.01038738340139389, 0.04088961333036423, -0.004943049047142267, 0.011510515585541725, -0.0004509183927439153, 0.035787928849458694, -0.019734125584363937, -0.008870838209986687, -0.04946856573224068, 0.014975091442465782, 0.053351934999227524, -0.0023795166052877903, 0.05939273536205292, -0.014099429361522198, 0.023135246708989143, 0.010235094465315342, -0.020825529471039772, -0.04596591740846634, 0.029874037951231003, 0.0008883528644219041, 0.03253909572958946, 0.009841680526733398, 0.0051683103665709496, -0.01758938655257225, 0.03644784912467003, -0.042463269084692, 0.04467146098613739, -0.04434150084853172, 0.02521653100848198, 0.00744947325438261, -0.023262154310941696, 0.019581835716962814, -0.023985527455806732, 0.03192993998527527, -0.03522953763604164, 0.012843044474720955, -0.02393476478755474, 0.027386650443077087, 0.0176528412848711, -0.002270058961585164, -0.003566102357581258, -0.07284493744373322, 0.03342745080590248, -0.015241596847772598, 0.03576254844665527, -0.025800306349992752, 0.0007202003616839647, 0.008661440573632717, 0.004597226157784462, -0.009061199612915516, 0.02698054537177086, 0.024455085396766663, 0.05497635155916214, 0.056143902242183685, -0.037133149802684784, 0.017957419157028198, -0.06391064077615738, 0.02521653100848198, -0.02294488623738289, -0.0016482118517160416, -0.06487514078617096, -0.017246736213564873, -0.010260475799441338, -0.0011326499516144395, -0.03576254844665527, -0.033630501478910446, 0.004003933165222406, 0.012570193037390709, 0.001059678033925593, 0.034518856555223465, -0.0350518673658371, 0.015876134857535362, 0.005993209313601255, 0.01442938856780529, -0.04555981233716011, 0.008927946910262108, -0.017690913751721382, 0.03439194709062576, -0.027691228315234184, 0.04819948971271515, 0.0019051996059715748, 0.021739264950156212, 0.04055965319275856, -0.04693041369318962, -0.0024207616224884987, -0.02572416141629219, 0.0016720070270821452, -0.0033218052703887224, 0.01751324161887169, 0.024873880669474602, -0.05101683735847473, -0.05139755830168724, -0.035864073783159256, -0.014239027164876461, -0.006259715184569359, -0.024708900600671768, 0.002374757546931505, 0.007163931615650654, -0.007671561557799578, 0.00878834817558527, 0.004946222063153982, 0.013160313479602337, -0.08360669761896133, -0.008724894374608994, 0.026726730167865753, 0.026777494698762894, 0.008490115404129028, -0.0077096340246498585, -0.013680634088814259, 0.005469715688377619, -0.03969668224453926, 0.014213645830750465, 0.06304766982793808, -0.004641643725335598, 0.007487545721232891, -0.011313808150589466, -0.03964592143893242, -0.033630501478910446, -0.004924013279378414, -0.012532120570540428, 0.01719597354531288, -0.04193025454878807, 0.011282081715762615, -0.024467775598168373, 0.01889653503894806, -0.005266663618385792, -0.03111773170530796, -0.025901831686496735, 0.013706015422940254, -0.00010172433394473046, -0.037183914333581924, -0.029112592339515686, 0.06964686512947083, 0.04906246066093445, -0.007893649861216545, -0.017399026080965996, 0.004473491106182337, 0.0132999112829566, -0.016333002597093582, 0.03213299438357353, 0.013617180287837982, 0.004473491106182337, 0.06218470260500908, -0.07076365500688553, -0.03606712818145752, -0.000658332952298224, -0.05101683735847473, -0.056600768119096756, -0.05370727553963661, 0.020647859200835228, -0.03964592143893242, -0.02619371935725212, -0.0523366741836071, -0.002496906090527773, -0.021295087411999702, 0.004019796848297119, -0.001404708018526435, -0.007785778492689133, -0.004387828521430492, -0.005549032706767321, 0.03522953763604164, -0.03982359170913696, -0.008191882632672787, -0.003962688613682985, -0.00972746405750513, 0.026777494698762894, 0.04566133767366409, 0.05731145292520523, -0.01977219618856907, -0.042590174823999405, -0.00967670138925314, 0.03868142142891884, 0.03685395419597626, 0.048021819442510605, 0.020673241466283798, 0.011218627914786339, 0.022297658026218414, -0.014860874973237514, -0.0315999798476696, -0.016079187393188477, 0.010939431376755238, -0.02483580820262432, 0.03251371532678604, -0.06512895971536636, 0.004781241994351149, 0.02890954166650772, -0.005936101078987122, 0.013008024543523788, 0.030914681032299995, -0.03210761025547981, 0.040280457586050034, -0.04741266369819641, 0.01981026865541935, -0.003883371129631996, 0.04817410930991173, -0.0007364603807218373, 0.03913829103112221, 0.023592114448547363, 0.00031588083948008716, -0.05314888432621956, 0.017272118479013443, 0.03929057717323303, -0.03594021871685982, 0.03637170419096947, -0.0077540515922009945, 0.06360606849193573, -0.0007860336918383837, -0.02126970700919628, -0.056143902242183685, -0.01106633897870779, -0.016916776075959206, -0.04162567853927612, -0.005815538577735424, -0.012310032732784748, -0.056550007313489914, 0.021853480488061905, 0.0037279094103723764, 0.03205684944987297, -0.03416351228952408, 0.025927213951945305, 0.00927694234997034, -0.01422633696347475, -0.0016037941677495837, 0.003597829258069396, -6.162576482893201e-06, 0.03500110283493996, -0.039493631571531296, 0.013477582484483719, 0.01624416746199131, -0.03200608491897583, 0.006795899476855993, 0.004543290473520756, 0.047564949840307236, -0.03596559911966324, 0.006291442085057497, 0.03639708831906319, -0.018655410036444664, -0.030813153833150864, 0.042463269084692, 0.01808432675898075, -0.008661440573632717, -0.01982296071946621, 0.023604804649949074, 0.05038229748606682, -0.01489894650876522, -0.003267869586125016, 0.009441922418773174, -0.029188737273216248, 0.040305837988853455, -0.02165042795240879, -0.03824993595480919, 0.008756620809435844, 0.0207366943359375, -0.02568608894944191, 0.05964655056595802, -0.025990666821599007, -0.021079344674944878, 0.030381668359041214, 0.006132807582616806, 0.009600556455552578, -0.021333159878849983, -0.006764172576367855, 0.0431993305683136, -0.028782634064555168, -0.027615083381533623, -0.003017227165400982, 0.012931879609823227, 0.02756432071328163, -0.02751355804502964, 0.005641040857881308, 0.017906656488776207, 0.015140071511268616, -0.0071195135824382305, 0.01260826550424099, 0.004381483420729637, 0.0586312897503376, 0.006424694787710905, -0.03929057717323303, 0.03284367546439171, 0.02026713639497757, -0.007874613627791405, 0.06076333671808243, -0.0013872581766918302, -0.027285125106573105, 0.0003037849674001336, 0.004974775947630405, -0.013934449292719364, 0.02021637372672558, 0.006475457921624184, -0.030026327818632126, -0.014810111373662949, 0.018642719835042953, -0.001997207524254918, 0.0162949301302433, -0.025038860738277435, -0.008680476807057858, -0.026396771892905235, 0.007614453323185444, 0.015901517122983932, 0.047108083963394165, -0.03251371532678604, 0.010450837202370167, -0.016459910199046135, -0.038529135286808014, -0.012341760098934174, 0.01484818384051323, -0.011440715752542019, 0.030762391164898872, 0.006415176670998335, -0.06426598876714706, -0.020533641800284386, -0.021777335554361343, 0.02929026447236538, 0.021777335554361343, 0.03071162849664688, -0.0651797205209732, -0.013147622346878052, 0.006637264974415302, -0.05228591337800026, -0.019531073048710823, 0.008864493109285831, 0.035864073783159256, -0.009143689647316933, 0.08477424830198288, 0.03667628392577171, 0.0013150795130059123, -0.04337700083851814, 0.04114342853426933, -0.015495412051677704, -0.005882164929062128, 0.00460991682484746, 0.012322723865509033, -0.03502648323774338, -0.06756558269262314, 0.010235094465315342, -0.0048510413616895676, -0.0011183727765455842, 0.017272118479013443, -0.024264724925160408, -0.006193088833242655, 0.021955007687211037, 0.018147779628634453, 0.011136137880384922, -0.009213488548994064, 0.0015982419718056917, 0.013388747349381447, 0.012601920403540134, -0.0157999899238348, 0.0257368516176939, -0.03350359573960304, -0.035889457911252975, 0.03710776939988136, 0.0010184331331402063, 0.030533958226442337, 0.022335730493068695, -0.0033059418201446533, -0.015888825058937073, -0.036346323788166046, 0.04467146098613739, 0.02389669232070446, 0.00585995614528656, 0.01080617867410183, -0.012716136872768402, -0.018236614763736725, -0.012068908661603928, 0.01988641358911991, -0.004111804533749819, -0.03700624406337738, 0.023224081844091415, 0.003066403791308403, 0.0018591956468299031, -0.0361686535179615, 0.062032412737607956, 0.034975722432136536, 0.0450521819293499, -0.0350518673658371, -0.008477424271404743, -0.072337307035923, -0.026675967499613762, -0.025521108880639076, 0.04855483025312424, -0.007202003616839647, 0.03350359573960304, -0.007106822915375233, 0.02069862186908722, 0.03576254844665527, -0.028757251799106598, 0.040305837988853455, -0.021739264950156212, 0.015952279791235924, -0.030407050624489784, 0.0351787731051445, 0.010063769295811653, 0.04335162043571472, 0.05360575020313263, -0.008007866330444813, -0.029061829671263695, 0.012633646838366985, 0.017272118479013443, -0.023363681510090828, 0.02307179383933544, 0.0324629507958889, -0.0037152187433093786, 0.018223924562335014, -0.018833080306649208, 0.02560994401574135, 0.01555886585265398, 0.041168808937072754, -0.044899892061948776, -0.010907704010605812, 0.007741360925137997, 0.060154180973768234, 0.017348263412714005, -0.0030140543822199106, -0.03576254844665527, -0.005130237899720669, -0.038935236632823944, -0.0351787731051445, 0.014518224634230137, -0.047539569437503815, 0.0440623015165329, -0.011294771917164326, -0.033605121076107025, 0.011415334418416023, -0.00987975299358368, -0.03350359573960304, 0.02477235533297062, 0.04243788495659828, -0.04512832686305046, -0.01986103318631649, -0.020127538591623306, 0.09944476187229156, -0.006802245043218136, 0.0243789404630661, -0.02384592965245247, 0.011345535516738892, -0.030737008899450302, -0.017817821353673935, -0.02794504351913929, 0.008693167939782143, 0.03162536397576332, 0.053859565407037735, -0.011199591681361198, -0.00904850848019123, 0.03883371129631996, 0.0034201585222035646, 0.014683203771710396, -0.005498269572854042, -0.015901517122983932, 0.024607375264167786, -0.0001279981661355123, 0.05720992386341095, -0.03469652682542801, 0.03824993595480919, 0.004724133759737015, 0.014035975560545921, 0.010393728502094746, -0.011884892359375954, -0.005047747865319252, 0.03868142142891884, 0.07284493744373322, 0.04911322519183159, -0.03921443596482277, 0.018782317638397217, -0.01461974997073412, -0.02157428488135338, -0.05238743871450424, -0.01236079540103674, -0.013363365083932877, 0.054722536355257034, -0.002308131195604801, 0.020470188930630684, 0.0007392364786937833, 0.0034138131886720657, -0.019239185377955437, 0.04497603699564934, 0.011129792779684067, 0.0311684962362051, 0.0523366741836071, 0.04878326505422592, 0.06710871309041977, 0.01799549162387848, -0.0009407022735103965, 0.007246421184390783, 0.06918999552726746, -0.02162504754960537, -0.011853165924549103, -0.062083177268505096, -0.002787207253277302, 0.00720834918320179, 0.011123446747660637, -0.05218438804149628, -0.00923886988312006, 0.006808590143918991, 0.02751355804502964, -0.008636059239506721, -0.06193088740110397, -0.022678380832076073, -0.008724894374608994, 0.017855893820524216, 0.003566102357581258, -0.018756937235593796, -0.07822581380605698, -0.035838693380355835, -0.03667628392577171, 0.01799549162387848, -0.028757251799106598, -0.0031758614350110292, 0.023312916979193687, -0.02936640754342079, 0.03738696500658989, -0.045305997133255005, 0.0009430817444808781, -0.024556612595915794, 0.007240076083689928, -0.013642562553286552, -0.01898537017405033, -0.00441003730520606, 0.01798279955983162, 0.010342965833842754, -0.00620895205065608, 0.012475012801587582, 0.025102313607931137, -0.00942923128604889, 0.023338299244642258, 0.01991179585456848, 0.005000157747417688, -0.0038103992119431496, -0.017906656488776207, -0.02248801849782467, -0.036727044731378555, -0.01621878519654274, 0.007931722328066826, 0.024937333539128304, 0.037260059267282486, 0.026472914963960648, -0.016066497191786766, 0.00038449023850262165, -0.01752593368291855, -0.03923981636762619, 3.1757872420712374e-06, 0.03213299438357353, 0.0027951388619840145, -0.006960879545658827, 0.020051393657922745, -0.03959515690803528, 0.020470188930630684, 0.0085789505392313, -0.028249621391296387, 0.009594211354851723, -0.026447534561157227, 0.024175889790058136, -0.024988098070025444, -0.00995589792728424, -0.020952437072992325, -0.013921759091317654, -0.0011612040689215064, 0.017944728955626488, -0.033579740673303604, -0.04096575826406479, 0.01464513223618269, -0.02619371935725212, 0.001986103132367134, -0.027640465646982193, 0.029518697410821915, 0.020038703456521034, -0.00814746506512165, -0.0032551786862313747, 0.012995333410799503, -0.06401216983795166, -0.02616833709180355, -0.030330905690789223, -0.010584089905023575, -0.02786889858543873, -0.007037024013698101, -0.0114787882193923, -0.008908910676836967, 0.008033248595893383, -0.018731554970145226, -0.03913829103112221, 0.061118677258491516, -0.052133623510599136, 0.028681106865406036, 0.0416002981364727, 0.010685616172850132, 0.035813312977552414, -0.0002837573701981455, 0.01661219820380211, 0.004866904579102993, -0.006567466072738171, -0.030940061435103416, 0.012475012801587582, 0.009740155190229416, 0.04190487414598465, -0.011002885177731514, -0.018706172704696655, -0.00585043802857399, 0.012811318039894104, -0.007195658516138792, -0.005568068940192461, 0.03276753053069115, -0.002352548763155937, -0.040305837988853455, 0.04649892821907997, 0.004594053607434034, -0.054367195814847946, 0.0015443062875419855, -0.019531073048710823, 0.01854119449853897, -0.02654905989766121, -0.02298295870423317, -0.010653888806700706, -0.0029712230898439884, 0.022792596369981766, -0.024137817323207855, 0.022158058360219002, 0.00948633998632431, -0.009974934160709381, -0.034061986953020096, 0.048402540385723114, 0.02158697508275509, -0.013211076147854328, 0.04297089949250221, -0.002285922411829233, -0.021396612748503685, -0.014010594226419926, -0.004673370625823736, 0.050331536680459976, -0.013198385946452618, 0.040838852524757385, -0.010907704010605812, 0.017779748886823654, 0.007157586049288511, 0.024505848065018654, -0.024087054654955864, -0.019746815785765648, -0.002642849925905466, 0.012544811703264713, 0.02250070869922638, 0.011212282814085484, 0.04335162043571472, 0.008528187870979309, 0.05375804007053375, -0.02525460347533226, -0.017767056822776794, -0.03822455555200577, 0.048884790390729904, 0.025838378816843033, -0.007760397158563137, -0.00027542904717847705, -0.025368820875883102, 0.012183125130832195, -0.04175258427858353, -0.0027126490604132414, 0.012969952076673508, -0.010603126138448715, -0.035889457911252975, -0.04281860962510109, 0.0005012848414480686, -0.02124432474374771, -0.003597829258069396, 0.018211234360933304, -0.008661440573632717, -0.011244009248912334, -0.01984834112226963, -0.019607217982411385, 0.006215297617018223, 0.02835114672780037, -0.036701664328575134, 0.007741360925137997, -0.013211076147854328, 0.005460197571665049, 0.05497635155916214, -0.008782003074884415, -0.016777178272604942, -0.0243789404630661, 0.04637201875448227, -0.042133308947086334, -0.030787773430347443, -0.028300384059548378, -0.005844092927873135, 0.000589723524171859, 0.04642278328537941, 0.04231097921729088, -0.0036390740424394608, 0.020203683525323868, 0.019048823043704033, -0.025533799082040787, -0.0014245372731238604, -0.02124432474374771, 0.04951932653784752, 0.013883686624467373, 0.031777650117874146, 0.011326499283313751, 0.009625937789678574, -0.01305878721177578, -0.0317268893122673, -0.040331222116947174, -0.010393728502094746, -0.026422152295708656, -0.031879179179668427, -0.04408768564462662, -0.01063485350459814, 0.01395983062684536, 4.756554699270055e-05, 0.00831879023462534, -0.008851801976561546, -0.04700655862689018, -0.01352834515273571, 0.005437988787889481, 0.01852850243449211, 0.00852184183895588, 0.014200955629348755, -0.03279291093349457, 0.0040610418654978275, 0.03916367143392563, -0.019556453451514244, -0.052032098174095154, 0.012240233831107616, 0.050230011343955994, 0.051143743097782135, 0.03286905586719513, 0.035864073783159256, -0.0009748086449690163, -0.004222848918288946, -0.017868584021925926, 0.010152604430913925, -0.0077984691597521305, 0.00947999395430088, 0.02936640754342079, -0.0064215222373604774, 0.016904085874557495, -0.020571714267134666, -0.034493472427129745, -0.0004021383065264672, -0.0053713624365627766, -0.008394935168325901, -0.025584563612937927, 0.009841680526733398, -0.004885940812528133, 0.00608839001506567, -0.03502648323774338, 0.0016482118517160416, 0.02524191327393055, 0.0071448953822255135, -0.015673082321882248, 0.010761760175228119, -7.168293814174831e-05, 0.01718328334391117, 0.02794504351913929, 0.01371870655566454, -0.02385861985385418, -0.002089215675368905, -0.01571115478873253, 0.00493987649679184, -0.013934449292719364, 0.024150507524609566, -0.007608107756823301, -0.04995081201195717, -0.007417746353894472, -0.035331062972545624, 0.013807541690766811, -0.027031309902668, -0.002462006639689207, -0.010875977575778961, -0.01125035434961319, 0.006196261383593082, -0.03291982039809227, 0.008020557463169098, 0.008851801976561546, 0.003309114370495081, 0.0076398346573114395, -0.1155366376042366, -0.0234525166451931, 0.009905134327709675, -0.015393886715173721, 0.03982359170913696, -0.01668834313750267, 0.020533641800284386, -0.023236773908138275, 0.01665027067065239, -0.03951901197433472, -0.015508103184401989, -0.0025936730671674013, 0.003588311141356826, 0.009537102654576302, 0.02081283926963806, -0.0623369924724102, -0.0023493762128055096, 0.0026031911838799715, 0.01628223992884159, -0.05198133364319801, -0.011472443118691444, 0.026422152295708656, 0.010641198605298996, 0.05467177554965019, -0.06695642322301865, -0.01375677902251482, 0.027792753651738167, 0.0019876896403729916, -0.00786826852709055, 0.001410260214470327, -0.015140071511268616, -0.02840191125869751, 0.005653731524944305, 0.03847837075591087, -0.03068624623119831, 0.010514291003346443, -0.006675337441265583, 0.0007388399098999798, 0.02397283725440502, 0.03969668224453926, 0.0325898602604866, -0.0686316043138504, 0.09797263145446777, 0.01888384483754635, 0.038960620760917664, -0.00043822763836942613, 0.012132362462580204, -0.04385925084352493, 0.024645447731018066, -0.03779307007789612, 0.011034611612558365, 0.008407625369727612, -0.004092768765985966, -0.027132835239171982, 0.004708270076662302, 0.01805894449353218, 0.01988641358911991, -0.004114977549761534, 0.029011067003011703, 0.009226178750395775, -0.0037532909773290157, 0.022348420694470406, 0.043021660298109055, -0.035356443375349045, -0.02786889858543873, -0.029036449268460274, 0.004302165936678648, -0.006050317548215389, 0.006764172576367855, -0.010260475799441338, -0.00024449534248560667, -0.0027697572950273752, -0.01897267997264862, 0.005818711593747139, -0.0003474094264674932, -0.007741360925137997, -0.003978551831096411, -0.0012246578698977828, -0.024886570870876312, 0.009816299192607403, 0.029442552477121353, -0.024645447731018066, 0.01663758046925068, -0.0007681872812099755, -0.025051550939679146, 0.010171640664339066, -0.007411401253193617, 0.020013321191072464, 0.004549636039882898, 0.011612040922045708, 0.03741234540939331, -0.008217263966798782, 0.009644974023103714, -0.04091499373316765, -0.0016148986760526896, -0.022691071033477783, -0.03977282717823982, -0.00950537621974945, 0.0012801799457520247, 0.0019670671317726374, 0.04601667821407318, 0.025533799082040787, -0.004911322146654129, -0.008775657042860985, -0.021333159878849983, 0.029442552477121353, -0.01667565293610096, 0.040280457586050034, 0.01488625630736351, -0.00987975299358368, 8.467113366350532e-05, -0.008699513040482998, -0.02753893844783306, 0.024264724925160408, -0.008179191499948502, 0.019949868321418762, 0.037260059267282486, -0.006605538073927164, 0.014264409430325031, -0.008591641671955585, -0.0016799387522041798, 0.04236174002289772, -0.022881431505084038, 0.011358225718140602, -0.020520951598882675, -0.03243757039308548, -0.004578189924359322, 0.016447218134999275, 0.0004449695989023894, -0.0011508929310366511, 0.02217075042426586, -0.02260223589837551, 0.03167612478137016, 0.010051078163087368, -0.0010739552089944482, 0.03878294676542282, 0.043580055236816406, 0.016764488071203232, -0.034518856555223465, 0.018591957166790962, 0.006145498249679804, -0.004321202170103788, 0.01558424811810255, 0.018795009702444077, 0.007703288458287716, 0.003072749124839902, 0.005444333888590336, -0.035864073783159256, -0.008502806536853313, -0.014530914835631847, 0.05177828297019005, 0.007830196060240269, 0.0003949997771997005, 0.005466543138027191, -0.0024048981722444296, 0.033173635601997375, -0.02077476680278778, -0.021358542144298553, -0.020888984203338623, 0.018147779628634453, 0.03324978053569794, 0.06350453943014145, 0.007563690189272165, -0.02165042795240879, 0.02035597153007984, -0.0076842522248625755, 0.008839110843837261, -0.00018401595298200846, -0.016967540606856346, 0.015673082321882248, -0.0027174081187695265, -0.030533958226442337, 0.024125125259160995, 0.02393476478755474, -0.0016593162436038256, 0.029391789808869362, 0.00643738592043519, -0.005932928062975407, 0.03208222985267639, 0.029924800619482994, 0.02708207257091999, 0.026726730167865753, -0.0370316244661808, 0.009245214983820915, 0.04969699680805206, -0.03847837075591087, -0.01078714244067669, -0.014695894904434681, 0.018363522365689278, 0.0021875689271837473, 0.023300226777791977, 0.016980230808258057, 0.00878834817558527, 0.0638091191649437, 0.0078999949619174, 0.012056217528879642, -0.0033376687206327915, 0.002319235587492585, 0.0015815853839740157, -0.03759001940488815, -0.040381982922554016, 0.011002885177731514, -0.008179191499948502, -0.014327863231301308, -0.023604804649949074, -0.004575017374008894, -0.025812996551394463, -0.022284965962171555, 0.03205684944987297, -0.01984834112226963, 0.021536212414503098, -0.02741203084588051, -0.025444963946938515, 0.030102472752332687, -0.005996381863951683, -0.040838852524757385, 0.01017798576503992, -0.02213267795741558, -0.04954471066594124, -0.0039246161468327045, -0.031752269715070724, -0.04020431265234947, 0.014200955629348755, -0.004613089375197887, -0.010323929600417614, -0.00991782546043396, 0.01625685766339302, 0.0005857576616108418, 0.010057423263788223, -5.284509825287387e-05, 0.0078999949619174, 0.024099744856357574, -0.019289948046207428, -0.0017307017697021365, -0.0019210630562156439, 0.007608107756823301, 0.013883686624467373, -0.006354895886033773, -4.786298450198956e-05, 0.019657980650663376, 0.020495569333434105, 0.01442938856780529, 0.007982484996318817, -0.014759348705410957, 0.021472757682204247, -0.019112277776002884, 0.01662489026784897, 0.052082858979701996, -0.037691544741392136, -0.004812968894839287, -0.02484849840402603, 0.014683203771710396, 0.024950025603175163, 0.002446143189445138, 0.005019193980842829, 0.013223767280578613, 0.0021685329265892506, 0.028706489130854607, 0.007620798423886299, -0.000567514740396291, -0.005374534986913204, -0.008407625369727612, -0.010723688639700413, -0.0067134094424545765, -0.00946730375289917, -0.03068624623119831, 0.018718864768743515, 0.01717059127986431, 0.0030917853582650423, 0.012938224710524082, -0.03185379505157471, -0.008502806536853313, 0.021751955151557922, 0.022348420694470406, 0.01057774480432272, -0.003274214919656515, 0.006434212904423475, -0.024620065465569496, 0.01758938655257225, 0.012506739236414433, -0.05670229345560074, -0.03469652682542801, -0.03423965722322464, 0.0005393571336753666, 0.04375772550702095, 0.0002502458228264004, 0.009765536524355412, -0.005158792249858379, 0.00899139977991581, 0.010615817271173, 0.048834025859832764, 0.03594021871685982, -0.012544811703264713, -0.005466543138027191, -0.0036993552930653095, -0.008940637111663818, 0.00970842782407999, 0.008458388037979603, -0.003215520177036524, -0.030889298766851425, 0.0032773877028375864, 0.023084484040737152, -0.02120625227689743, 0.018236614763736725, 0.025457656010985374, -0.00246993824839592, 0.03378279134631157, 0.01855388469994068, -0.010926740244030952, -0.02434086985886097, 0.007170276716351509, -0.014086738228797913, -0.012620956636965275, 0.04639740288257599, 0.02883339673280716, 0.004092768765985966, -0.00013345121988095343, -0.005574414506554604, 0.007735015358775854, 0.01756400614976883, -0.027259742841124535, -0.009226178750395775, 0.014251718297600746, -0.004546463023871183, -0.014835492707788944, 0.010000315494835377, 0.0005131824291311204, -0.0009042163146659732, 0.01668834313750267, 0.0013912240974605083, -0.011548587121069431, 0.027208980172872543, 0.009492685087025166, -0.01126939058303833, 0.0016704206354916096, 0.000630571914371103, -0.027640465646982193, -0.014391317032277584, -0.029899420216679573, -0.02926488220691681, 0.02434086985886097, -0.022373801097273827, 0.010260475799441338, -0.0033376687206327915, 0.029417170211672783, 0.006123289465904236, -0.005276181735098362, 0.024569302797317505, -0.0031964839436113834, -0.0037945357616990805, 0.0640629306435585, -0.003274214919656515, -0.015926897525787354, 0.00025004753842949867, 0.0028998376801609993, 0.008210918866097927, -0.013464891351759434, -0.0311684962362051, -0.054316435009241104, 0.014530914835631847, -0.020381353795528412, 0.041244953870773315, -0.04693041369318962, 0.009169070981442928, 0.011453406885266304, -0.01489894650876522, -0.011447061784565449, 0.051143743097782135, 0.01258922927081585, 0.0020114846993237734, 0.010926740244030952, 0.00967670138925314, -0.02519114874303341, 0.011224973015487194, -0.01809701696038246, 0.015685774385929108, -0.006183570716530085, 0.036295559257268906, 0.020990509539842606, 0.0020336934830993414, -0.007944412529468536, -0.0043085115030407906, -0.05401185527443886, -0.0055617233738303185, 0.012481357902288437, -0.01535581424832344, -0.03568640351295471, 0.005022366531193256, 0.013731397688388824, 0.008001521229743958, 0.00899139977991581, 0.025584563612937927, -0.03799612075090408, 0.009752845391631126, -0.004920840263366699, 0.016789870336651802, -0.0005901201511733234, -0.009315014816820621, -0.005047747865319252, 0.009251561015844345, 0.007017987780272961, -0.005583932623267174, 0.03520415723323822, -0.02654905989766121, -0.00012423060252331197, -0.02974713034927845, 0.00031707060406915843, 0.001393603626638651, 0.009245214983820915, 0.025115005671977997, -0.032666005194187164, -0.014835492707788944, -0.018211234360933304, 0.0075509995222091675, 0.018388904631137848, -0.00878834817558527, -0.0015109931118786335, 0.0224626362323761, -0.01558424811810255, 0.04342776536941528, -0.026701349765062332, 0.004165740683674812, 0.0030473675578832626, -0.0022573680616915226, -0.018845772370696068, 0.017690913751721382, 0.008610677905380726, 0.03652399405837059, -0.0062850965186953545, 0.04203178361058235, -0.01751324161887169, 0.032310664653778076, 0.009295978583395481, -0.006846662610769272, -0.002968050539493561, 0.03479805216193199, 0.023630186915397644, 0.01258922927081585, -0.02293219417333603, 0.0026745765935629606, -0.01670103333890438, -0.002024175599217415, 0.03434118255972862, -0.005910719279199839, -0.027665846049785614, -0.03307211026549339, 0.016802560538053513, -0.023350989446043968, 0.011624732054769993, 0.01105999294668436, -0.021498139947652817, -0.03700624406337738, 0.06056028604507446, -0.003953170496970415, -0.014404007233679295, 0.03558487817645073, -0.04276784509420395, -0.005038229748606682, 0.04469684138894081, 0.026904402300715446, 0.002511183265596628, -0.01055870857089758, 0.0021637738682329655, -0.005142928566783667, 0.007811159826815128, 0.0162949301302433, -0.057920608669519424, 0.009124653413891792, -0.009092926047742367, -0.03238680958747864, 0.013376056216657162, -0.016916776075959206, 0.008642404340207577, -0.023173319175839424, 0.02527998574078083, -0.01614264026284218, -0.0198737233877182, 0.014340553432703018, 0.00572987599298358, -0.008528187870979309, -0.02068593166768551, 0.01576191745698452, 0.019556453451514244, 0.0020114846993237734, 0.028655726462602615, 0.004686061292886734, -0.01535581424832344, -0.005447506904602051, -0.006021763663738966, 0.011757984757423401, 0.006491321604698896, -0.0024429704062640667, 0.014010594226419926, 0.025140386074781418, -0.003632728708907962, -0.014467461034655571, -0.008223609067499638, -0.028960304334759712, 0.023160628974437714, 0.013401437550783157, -0.016472600400447845, 0.0007154413615353405, -0.007366983685642481, 0.055230166763067245, 0.03192993998527527, -0.013363365083932877, 0.011428025551140308, -0.01934071071445942, 0.0487578809261322, -0.005831402260810137, 0.018718864768743515, -0.01673910580575466, 0.012995333410799503, 0.005457025021314621, -0.0018988542724400759, -0.019924486055970192, -0.011244009248912334, -0.0003420555149205029, -0.0029093557968735695, -0.029061829671263695, 0.005231763701885939, 0.011466097086668015, 0.0031790342181921005, -0.023795166984200478, -0.02255147323012352, -0.0004989053122699261, -0.004885940812528133, 0.000817760534118861, -0.02621910162270069, -0.002508010482415557, -0.017373643815517426, -0.030863916501402855, 0.020381353795528412, 0.0023573078215122223, -0.007062405347824097, 0.010082805529236794, 0.0074621643871068954, 0.004866904579102993, -0.029011067003011703, 0.01798279955983162, 0.012500394135713577, -0.006056663114577532, 0.008363207802176476, -0.0076398346573114395, 0.029874037951231003, 0.028071951121091843, -0.00792537722736597, 0.024645447731018066, -0.007405055686831474, 0.04644816368818283, 0.005777466576546431, -0.005028711631894112, 0.002347789704799652, 0.015178143046796322, -0.0018893362721428275, 0.003056885674595833, -0.0004152256587985903, -0.01809701696038246, -0.005219073034822941, 0.016015732660889626, 0.020977819338440895, 0.0023842756636440754, -0.005035057198256254, 0.041701823472976685, 0.020381353795528412, 0.01752593368291855, 0.008471079170703888, -0.004876422695815563, 0.014264409430325031, -0.007011642213910818, -0.006120116915553808, 0.02337637171149254, 0.00542847067117691, 0.021523520350456238, -0.020990509539842606, 0.008306099101901054, 0.012018145062029362, -0.011618386954069138, 0.006504012271761894, 0.011954691261053085, 0.024023599922657013, -0.037183914333581924, -0.007950758561491966, 0.00152447703294456, 0.02260223589837551, -0.015673082321882248, -0.0014023284893482924, -0.021460067480802536, -0.031041588634252548, 0.02967098541557789, -0.034011226147413254, -0.0013674289220944047, 0.009086580947041512, 0.007386019453406334, -0.028757251799106598, 0.07533232122659683, -0.0025365648325532675, 0.018388904631137848, -0.04045812785625458, 0.027843518182635307, 0.022627616301178932, 0.015152761712670326, 0.02027982659637928, -0.022234203293919563, 0.01662489026784897, -0.047996435314416885, 0.005016020964831114, -0.03614327311515808, 0.009365777485072613, 0.023173319175839424, -0.027818135917186737, -0.01758938655257225, -0.0021320469677448273, 0.0003834987583104521, -0.0016418665181845427, 0.011662804521620274, -0.007741360925137997, -0.009150034748017788, -0.012697100639343262, -0.015178143046796322, -0.0027237534523010254, 0.016307620331645012, 0.004774896893650293, -0.005929755512624979, -0.006348550319671631, 0.02337637171149254, 0.024036290124058723, 0.004568671807646751, 0.015673082321882248, -0.011853165924549103, 0.039442867040634155, -0.018591957166790962, 0.016396455466747284, -0.0008804211392998695, 0.000866937218233943, -0.02969636768102646, -0.042107924818992615, 0.003075921908020973, -0.016333002597093582, 0.007525618188083172, -0.040864232927560806, -0.022386493161320686, 0.020495569333434105, -0.043935395777225494, -0.019239185377955437, -0.007487545721232891, 0.021003199741244316, -0.035864073783159256, -0.0014673685654997826, 0.008464734070003033, -0.017728986218571663, -0.01038738340139389, -0.00043188227573409677, -0.004245057702064514, 0.02519114874303341, 0.02926488220691681, -0.016421837732195854, 0.009403849951922894, 0.015698464587330818, -0.006212124601006508, 0.018731554970145226, 0.006135980132967234, 0.00699895154684782, 0.012532120570540428, -0.011770675890147686, 0.01855388469994068, -0.00012542035256046802, -0.00970842782407999, 0.0019448582315817475, 0.010266820900142193, -0.02340175211429596, 0.02261492609977722, 0.007379674352705479, 0.005815538577735424, 0.009771881625056267, -0.005577587056905031, 0.002749134786427021, 0.015165452845394611, -0.02797042578458786, -0.028630344197154045, 0.013655252754688263, 0.021231634542346, -0.006561120506376028, -0.004086423199623823, -0.0016275893431156874, 0.013020714744925499, 0.01662489026784897, 0.03479805216193199, 0.021421995013952255, -0.013591798953711987, 0.005612486507743597, 0.025394201278686523, -0.02157428488135338, -0.007576380856335163, -0.015266979113221169, 0.008153810165822506, -0.0040388330817222595, -0.006047144997864962, -0.003708873176947236, -0.003448712872341275, 0.004311684053391218, 0.02294488623738289, -0.012944570742547512, -0.03111773170530796, 0.040864232927560806, -0.008477424271404743, 0.01171991229057312, -0.007963448762893677, -0.03865604102611542, -0.012316377833485603, -0.0314730741083622, -0.016764488071203232, 0.020977819338440895, 0.00904850848019123, 0.04614358767867088, -0.017272118479013443, -0.003209174843505025, -0.02748817577958107, 0.010895013809204102, -0.007405055686831474, 0.023706331849098206, 0.029569460079073906, 0.006275578401982784, 0.0031536526512354612, -0.020152918994426727, -0.0494939461350441, -0.018617337569594383, -0.014099429361522198, 0.029137974604964256, 0.012208506464958191, 0.030559338629245758, -0.01935340277850628, 0.001382499118335545, -0.023592114448547363, 0.010362002067267895, -0.0008597986889071763, -0.01192930992692709, 0.029011067003011703, -0.012709791772067547]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"eβQt(st,s1:t−1)(t < T ) (Twist Targets (Soft RL Q))
where the final twisting target is given by Eq. (42) and the optimal Q-values are defined as
Q∗
t(st,s1:t−1) =rt(s1:t) +V∗
t(s1:t) (44)
One-Step Proposal Finally, the optimal one-step proposal (e.g. in Vtform) can be derived either (i) as the twist-induced
proposal from Eq. (Twist Targets (Soft RL V) ) and Prop. B.1 or (ii) as the solution to the one-step optimization in the third
line of Eq. (Optimal Intermediate Soft Value). As in Eq. (Twist-Induced Proposal ( ψ) ),
qπ
t(st|s1:t−1)(sRL)=p0(st|s1:t−1)eβ(rt(s1:t)+Vt(s1:t))
P
stp0(st|s1:t−1)eβ(rt(s1:t)+Vt(s1:t))∝p0(st|s1:t−1)eβQt(st,s1:t−1).
(Twist-Induced Proposal (soft RL))
We define the one-step log normalization constant induced by an approximate VtorQtasVVtorVQt, respectively,
VVt(s1:t−1):=1
βlogX
stp0(st|s1:t−1)eβ(rt(s1:t)+Vt(s1:t))VQt(s1:t−1):=1
βlogX
stp0(st|s1:t−1)eβQt(st,s1:t−1)
(45)
such that, for example, qπ
t(st|s1:t−1) =p0(st|s1:t−1)eβQt(st,s1:t−1)−βVQt(s1:t−1).
RLHF Minimizes DKL(q∥σ)Note that, for a given suboptimal q(s1:T), the value of the variational optimization in
Eq. (42) is a lower bound on the (scaled) log partition function V∗
0=1
βlogZσ. Similarly to the standard Evidence Lower
Bound, the gap in this lower bound is given by the KL divergence
1
βlogZσ=1
βDKL(q(s1:T)∥σ(s1:T))
| {z }
ELBO gap (≥0)+
Eq(s1:T)hTX
t=1rt(s1:t)i
−1
βDKL(q(s1:T)∥p0(s1:T))
| {z }
‘ELBO’: Eq. (42)
(46)
In this sense, we consider soft RL or policy gradient methods such as PPO which optimize Eq. (42) as targeting σ(s1:T)by
minimizing DKL(q(s1:T)∥σ(s1:T))(Korbak et al., 2022b).
23
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
B.4. Remarks on Parameterization
While the twisting targets (Eq. (Twist Targets ( ψ) )) and twist-induced proposal (Eq. (Twist-Induced Proposal ( ψ) )) may
equivalently be parameterized using approximate Φt, we focus on the ψtparameterization to match the main text. In
particular, recall that the optimal twists satisfy ψ∗
t(s1:t) =ϕt(s1:t)Φ∗
t(s1:t)for all t. With no intermediate potential (ϕt= 1
fort < T ), our approximate twists estimate ψt(s1:t)≈Φ∗
t(s1:t)∝P
st+1:Tp0(st+1:T|s1:t)ϕT(s1:T)fort < T . In this
section, we describe how the presence of intermediate potentials may affect the choice of twist parameterization.
The twist-induced proposal may not be tractable to evaluate at the final timestep, since it may be costly to evaluate
the terminal potential ϕT(s1:T)for all sT∈ V given a context s1:T−1(as described in Sec. 3.2). Thus, we learn an
approximate ψT(s1:T)≈ϕT(s1:T)for proposal sampling, which can be easily evaluated over |V|next tokens. The final
πT(s1:T) =σ(s1:T)is defined using ϕ(s1:T)in order to preserve unbiased","[-0.0011221168097108603, -0.003907802980393171, 0.00042089808266609907, -0.0019238670356571674, -0.020743725821375847, 0.010218353942036629, -0.008663241751492023, 0.016845934092998505, -0.04506487771868706, 0.013962636701762676, 0.04154084622859955, 0.004645313136279583, -0.035240307450294495, 0.020863862708210945, 0.045091573148965836, -0.030328020453453064, 0.039164796471595764, 0.0066309175454080105, -0.04252864047884941, 0.02955380268394947, -0.016458824276924133, -0.048321936279535294, -0.019061801955103874, 0.037456173449754715, -0.0007938246126286685, -0.020436707884073257, 0.038470666855573654, -0.013562178239226341, 0.014763552695512772, -0.013341926038265228, 0.04447753727436066, -0.02803206257522106, -0.0018955012783408165, -0.06759731471538544, -0.014763552695512772, 0.06546153873205185, -0.014162865467369556, 0.04194130375981331, -0.007268313318490982, 0.018968362361192703, 0.01679253950715065, -0.05643788352608681, -0.04591918736696243, 0.030194535851478577, 0.0287528857588768, 0.042582035064697266, 0.009824570268392563, 0.01771359331905842, -0.015858137980103493, 0.01870138943195343, -0.008543104864656925, 0.031315818428993225, -0.016018321737647057, -0.006003533024340868, 0.0001285845646634698, 0.009884638711810112, 0.021664779633283615, -0.03409232571721077, 0.04351643845438957, -0.019635790959000587, 0.03238370642066002, -0.030835267156362534, 0.013462063856422901, 0.04033946990966797, -0.0065508256666362286, -0.015017176046967506, -0.0677574947476387, 0.038871124386787415, -0.01256770733743906, 0.04052635282278061, -0.016325339674949646, 0.007949091494083405, 0.011406379751861095, 0.009003630839288235, -0.008803402073681355, 0.04028607904911041, -0.006080287508666515, 0.05718540400266647, 0.034626271575689316, -0.010819041170179844, 0.022172026336193085, -0.04423726350069046, 0.03518691286444664, -0.027070961892604828, -0.01025172509253025, -0.04933642968535423, -0.016458824276924133, -0.021371109411120415, -0.05077807605266571, -0.02473495714366436, -0.018220840021967888, 0.0017136266687884927, -0.005462914705276489, 0.004828856326639652, 0.057559166103601456, -0.002270930679515004, 0.037856630980968475, 0.013949288055300713, 0.021371109411120415, -0.00950420368462801, 0.036254800856113434, -0.007274987641721964, 0.029794076457619667, -0.013588875532150269, 0.06871859729290009, 0.013388646766543388, 0.013034909032285213, 0.05027082934975624, -0.033344805240631104, -0.005289383232593536, 0.004631964489817619, -0.008703287690877914, -0.024508031085133553, 0.034038931131362915, 0.013815801590681076, -0.06273842602968216, -0.017780335620045662, -0.013515458442270756, -0.04092681035399437, 0.009530900977551937, -0.033638473600149155, -0.017072860151529312, 0.0015617862809449434, 0.021397806704044342, 0.014042727649211884, -0.005015736911445856, 0.00028970633866265416, -0.05200614780187607, 0.012233993038535118, 0.038470666855573654, -0.000438418093835935, 0.027297887951135635, 0.0032086698338389397, 0.005376148968935013, -0.0073150331154465675, -0.027097659185528755, 0.0347597561776638, 0.04146075248718262, 0.017513364553451538, 0.018047308549284935, -0.002190839033573866, -0.0494966134428978, -0.03729598969221115, 6.929801020305604e-05, -0.008816750720143318, 0.021544640883803368, -0.01166000310331583, 0.0324104018509388, 0.009857941418886185, 0.0370023213326931, -0.027524814009666443, -0.03235700726509094, -0.035347096621990204, 0.017019465565681458, 0.023186519742012024, -0.04282231256365776, -0.003881105687469244, 0.05809311196208, 0.033344805240631104, -0.009037002921104431, -0.012240666896104813, 0.007254964672029018, 0.01130626443773508, -0.006947946734726429, 0.025562571361660957, 0.005306068807840347, -0.010371862910687923, 0.02947371080517769, -0.05713201314210892, -0.03953855484724045, 0.005072468426078558, -0.05224642530083656, -0.044103775173425674, -0.03187645971775055, 0.02493518590927124, -0.02684403583407402, -0.011846883222460747, -0.07843637466430664, 0.009023654274642467, 0.017540061846375465, 0.006784426514059305, 0.03369186818599701, -0.016739144921302795, -0.01818079501390457, -0.0033404873684048653, 0.04557212442159653, -0.02031657099723816, 0.011693374253809452, 0.006030230317264795, -0.019662488251924515, 0.018340976908802986, 0.0575057715177536, 0.06636924296617508, -0.02955380268394947, -0.014443186111748219, -0.015604514628648758, 0.053955044597387314, 0.04055304825305939, 0.03670865297317505, 0.007748862728476524, 0.0059334528632462025, 0.011653328314423561, -0.03662855923175812, -0.04746762290596962, -0.019342122599482536, 0.0032737443689256907, -0.0007934074383229017, 0.011866905726492405, -0.07945087552070618, -0.013094977475702763, 0.013001536950469017, 0.00970443245023489, 0.03246379643678665, 0.03849736601114273, -0.0035874363966286182, 0.031422607600688934, -0.0404195636510849, 0.013648943975567818, 0.01700611785054207, 0.05932118371129036, 0.001282299985177815, 0.007335056085139513, 0.03537379205226898, 0.025415735319256783, -0.0597483366727829, -0.0003716750943567604, 0.033238016068935394, -0.022999638691544533, 0.045198362320661545, -0.008209389634430408, 0.03369186818599701, 0.007054735440760851, -0.01680588908493519, -0.023493537679314613, 0.00991133600473404, -0.02482839673757553, -0.0257494505494833, 0.002305970760062337, -0.02432115003466606, -0.08169343322515488, 0.01971588283777237, 0.01890161819756031, 0.01971588283777237, -0.05841347575187683, 0.019075149670243263, 0.023360051214694977, -0.01049867458641529, -0.004635301418602467, 0.025068672373890877, 0.005312743131071329, 0.001556780538521707, -0.029340224340558052, 0.0093974145129323, -0.002511205617338419, -0.043890200555324554, -0.012607753276824951, 0.021291017532348633, 0.014950432814657688, -0.05659806728363037, 0.010091542266309261, 0.05059119686484337, -0.04009919613599777, -0.014496580697596073, 0.05187266319990158, -0.012607753276824951, -0.022652575746178627, -0.010138262063264847, 0.001291477121412754, 0.0415942408144474, 0.002517879940569401, -0.002230884972959757, 0.006867855321615934, -0.02434784732758999, 0.039565254002809525, -0.028485914692282677, -0.02773839235305786, 0.03286425396800041, 0.024014132097363472, -0.025802845135331154, 0.055156417191028595, -0.007808931637555361, -0.026109863072633743, 0.03991231694817543, -0.00885012187063694, 0.019956158474087715, -0.007628725375980139, -0.012220644392073154, 0.04789477959275246, -0.01882152631878853, -0.03921818733215332, 0.012133877724409103, 0.016939373686909676, 0.043196070939302444, -0.012047111988067627, 0.011146081611514091, 0.022545786574482918, 0.03980552777647972, -0.023813903331756592, 0.03230361267924309, 0.01577804610133171, 0.06102980300784111, -0.019849369302392006, 0.004925633780658245, 0.004588581621646881, 0.0036241451743990183, 0.010825715027749538, 0.06129677593708038, 0.010144936852157116, -0.024467986077070236, 0.010525371879339218, -0.010525371879339218, 0.006480745505541563, -0.0008438818622380495, -0.0031686241272836924, -0.026670504361391068, -0.020076295360922813, 0.02062358893454075, 0.005539669189602137, -0.013181743212044239, -0.02594967931509018, -0.040072500705718994, -0.032143428921699524, 0.008543104864656925, 0.01251431368291378, 0.022839456796646118, -0.03387874737381935, 0.008623195812106133, 0.011232847347855568, -0.031929854303598404, -0.014630066230893135, 0.01771359331905842, -0.02444128878414631, 0.032517191022634506, 0.0031302468851208687, -0.0384172722697258, -0.040472958236932755, -0.03601452335715294, 0.03438599407672882, 0.006510780192911625, 0.03678874298930168, -0.07240281254053116, -3.5783114071819e-06, 0.015751348808407784, -0.02795197069644928, -0.02454807609319687, 0.03969873860478401, 0.04413047432899475, -0.011753442697227001, 0.08911526203155518, 0.051445506513118744, 0.008322852663695812, -0.0324104018509388, 0.03737608343362808, -0.005549680907279253, 0.013695664703845978, 0.00091104197781533, 0.010732275433838367, -0.030728479847311974, -0.07549968361854553, 7.576373900519684e-05, -0.0060469163581728935, -0.005132536869496107, 0.02243899740278721, -0.004628627095371485, -0.02573610283434391, 0.013662292622029781, 0.02051679976284504, -0.0038977914955466986, -0.01267449650913477, 0.0019772613886743784, -0.0019472271669656038, 0.0034205790143460035, -0.009470832534134388, 0.025709405541419983, -0.034946635365486145, -0.029633894562721252, 0.0126678217202425, 0.019141893833875656, 0.043302860110998154, 0.020356616005301476, -0.005559692159295082, -0.008362898603081703, -0.04143405705690384, 0.0027064287569373846, 0.0005998527631163597, 0.003203664207831025, 0.017566759139299393, -0.009764501824975014, -0.013882544822990894, 0.010979223996400833, 0.028779583051800728, 0.001587649225257337, -0.04685358703136444, 0.03881772980093956, 0.013989333994686604, -0.0076754456385970116, -0.03337150067090988, 0.0757666602730751, 0.04140735790133476, 0.03852406144142151, -0.055049628019332886, 0.006076950579881668, -0.07485895603895187, -0.014910386875271797, -0.056651461869478226, 0.010672206059098244, -0.018754784017801285, 0.02190505340695381, 0.0115198427811265, 0.02645692601799965, 0.03852406144142151, -0.025882937014102936, 0.02593633159995079, -0.0008059217943809927, 0.0384172722697258, -0.06113659217953682, 0.023506885394454002, -0.012073809280991554, 0.050938259810209274, 0.05200614780187607, -1.60469990078127e-05, -0.007268313318490982, 0.001750335330143571, 0.0031836412381380796, -0.021891705691814423, 0.013368623331189156, 0.05056450143456459, -0.013949288055300713, 0.030087746679782867, -0.022746015340089798, 0.033745262771844864, 0.03740277886390686, 0.02073037624359131, -0.058573659509420395, -0.03206333890557289, -0.023466840386390686, 0.042421855032444, 0.05037761852145195, -0.005122525617480278, -0.04677349701523781, -0.01639208197593689, -0.015724651515483856, 0.005359463393688202, 0.01930207759141922, -0.02171817421913147, 0.023506885394454002, -0.01657896302640438, -0.04204809293150902, -0.00182208395563066, -0.02744472399353981, -0.024694912135601044, 0.04009919613599777, 0.07560647279024124, -0.03305113688111305, -0.008476361632347107, -0.031422607600688934, 0.09979414194822311, -0.02053014747798443, 0.04506487771868706, -0.022999638691544533, 0.011499819345772266, 0.008322852663695812, -0.007568656466901302, -0.012834679335355759, 0.011733420193195343, 0.03230361267924309, 0.029180040583014488, -0.009457483887672424, -0.026790641248226166, 0.020383313298225403, -0.007802257314324379, -0.004788810387253761, 0.01979597471654415, -0.02944701351225376, 0.014763552695512772, 0.02944701351225376, 0.072349414229393, -0.03702901676297188, 0.02211863175034523, -0.004415049683302641, 0.01628529280424118, 0.017166299745440483, 0.015764698386192322, 0.00281321769580245, 0.0075619821436703205, 0.05601073056459427, 0.047601111233234406, -0.024201013147830963, -0.0018904955359175801, 0.007555307820439339, -0.023773858323693275, -0.06407328695058823, -0.005272697191685438, -0.015177358873188496, 0.05136541649699211, -0.0008693276322446764, 0.0026263371109962463, 0.020850514993071556, -0.02744472399353981, -0.03086196444928646, 0.05649127811193466, 0.00028052920242771506, 0.03265067934989929, 0.03286425396800041, 0.03521360829472542, 0.08468352258205414, 0.024387894198298454, -0.00013265172310639173, -0.003737608203664422, 0.057559166103601456, -0.028726188465952873, -0.00838959589600563, -0.03035471774637699, -0.003375527448952198, -0.0026496972423046827, 0.01959574595093727, -0.055850546807050705, -0.024014132097363472, 0.010925829410552979, 0.013802452944219112, -0.009884638711810112, -0.030087746679782867, -0.03508012369275093, -0.020156387239694595, 0.020289873704314232, -0.008402944542467594, -0.01588483527302742, -0.1093517392873764, -0.04033946990966797, -0.04928303509950638, 0.005850024521350861, -0.0335850790143013, 0.005813315510749817, 0.02373381145298481, -0.04527845233678818, 0.029820773750543594, -0.037936724722385406, 0.002005627378821373, -0.01342869270592928, 0.01301488559693098, -0.01210718136280775, -0.00442506093531847, -0.012934793718159199, 0.014496580697596073, 0.0019639129750430584, -0.006644266191869974, 0.01523075345903635, 0.008122623898088932, 0.0013623915147036314, 0.015711303800344467, 0.01533754263073206, 0.004571895580738783, -0.028485914692282677, -0.021878356114029884, -0.014469883404672146, -0.016258595511317253, -0.01212052907794714, 0.03379865735769272, 0.02755151130259037, 0.0321701280772686, 0.03096875362098217, -0.01356885302811861, -0.016752494499087334, -0.012047111988067627, -0.00698799267411232, 0.00934402085840702, 0.03126242384314537, -0.01155988872051239, -0.006066938862204552, 0.02776508964598179, -0.043196070939302444, 0.006807786412537098, 0.014750204049050808, -0.020837165415287018, 0.003977883141487837, -0.04485129937529564, 0.029687287285923958, -0.046399734914302826, -0.01401603128761053, -0.038470666855573654, -0.03067508526146412, -0.0098112216219306, 0.016445476561784744, -0.03331810608506203, -0.044584326446056366, 0.005266022868454456, -0.006300539709627628, 0.0042381808161735535, -0.02019643224775791, 0.02462816797196865, 0.013682316057384014, -0.006634254474192858, -0.008509732782840729, -0.002424439648166299, -0.06012209877371788, -0.030034352093935013, -0.020143039524555206, -0.015964927151799202, -0.04562551900744438, 0.0019088499248027802, -0.0012873057276010513, -0.002102404600009322, 0.03297104313969612, -0.025909634307026863, -0.04877578839659691, 0.0472540482878685, -0.052860457450151443, 0.025575919076800346, 0.033211320638656616, -0.0081026004627347, 0.02492183819413185, 0.021371109411120415, 0.005412857513874769, 0.0035540650133043528, -0.005586389452219009, -0.04255533963441849, 0.025989726185798645, -0.004525175783783197, 0.0486689992249012, -0.025108717381954193, -0.005856698378920555, -0.0047554392367601395, 0.02041001059114933, -0.018567902967333794, -0.006247145123779774, 0.015497725456953049, -0.0049056108109653, -0.03235700726509094, 0.019982855767011642, 0.024815049022436142, -0.0466667078435421, -0.0111060356721282, -0.0162052009254694, 0.036254800856113434, -0.02173152193427086, -0.020837165415287018, -0.007268313318490982, -0.0012113854754716158, 0.013181743212044239, -0.023079730570316315, 0.003874431364238262, -0.0035173562355339527, -0.022692620754241943, -0.034119024872779846, 0.027177751064300537, 0.01251431368291378, -0.043302860110998154, 0.033932141959667206, -0.011646654456853867, -0.00885679665952921, -0.017580106854438782, -0.006110322196036577, 0.041353967040777206, -0.0060235559940338135, 0.04987037181854248, -0.018567902967333794, -0.0014741860795766115, -0.0010612137848511338, 0.009177163243293762, -0.03801681473851204, -0.024000784382224083, -0.028379125520586967, 0.008916865102946758, -0.00032057499629445374, 0.013608898967504501, 0.037162505090236664, 0.02493518590927124, 0.05392834544181824, -0.017166299745440483, -0.0179138220846653, -0.022465694695711136, 0.05819990113377571, 0.025495827198028564, -0.016872631385922432, -0.0006916243582963943, 0.0065408144146203995, 0.007341730408370495, -0.06054925173521042, 0.00035603222204372287, 0.03457287698984146, -0.011406379751861095, -0.027097659185528755, -0.042074788361787796, 0.004682021681219339, -0.005946801509708166, 0.007048061117529869, 0.01689932867884636, -0.014750204049050808, -0.019075149670243263, -0.010819041170179844, -0.012761262245476246, 0.004645313136279583, 0.02002290077507496, -0.033344805240631104, -0.013195091858506203, -0.02090390957891941, 0.0021441190037876368, 0.046106066554784775, -0.012561033479869366, -0.012140552513301373, -0.013248486444354057, 0.03337150067090988, -0.020076295360922813, -0.029313527047634125, -0.034652967005968094, -0.013034909032285213, -0.003292098641395569, 0.04111368954181671, 0.023773858323693275, -0.00838959589600563, 0.009530900977551937, 0.024561425670981407, -0.02795197069644928, -0.008429641835391521, -0.03390544652938843, 0.042421855032444, 0.02273266762495041, 0.034145720303058624, 0.00776888569816947, -0.008082577958703041, -0.020356616005301476, -0.0223322082310915, -0.06813126057386398, -0.012954817153513432, 0.0017203008756041527, -0.013168394565582275, -0.052940551191568375, 0.01831427961587906, 0.008022509515285492, -0.012581055983901024, -0.0007103958632797003, 0.016619008034467697, -0.015164010226726532, -0.006220447830855846, -0.01332190353423357, 0.03609461709856987, 0.021291017532348633, 0.03606791794300079, -0.03257058560848236, 0.0009510878007858992, 0.03993901237845421, -0.02073037624359131, -0.04143405705690384, 0.04250194504857063, 0.0466667078435421, 0.025509176775813103, 0.02856600657105446, 0.04202139377593994, 0.014710158109664917, -0.0020757075399160385, -0.013515458442270756, 0.0115198427811265, -0.015818091109395027, 0.0047554392367601395, 0.004481792915612459, 0.0019038441823795438, 0.01196702104061842, -0.011059315875172615, -0.004938982427120209, -0.004475118592381477, 0.003293767338618636, -0.02573610283434391, -0.017046162858605385, 0.0015284147812053561, -0.018848223611712456, 0.018047308549284935, -0.02344014309346676, -0.006724357604980469, 0.009237231686711311, 0.005556355230510235, -0.012848027981817722, 0.012948142364621162, -0.015751348808407784, 0.011786814779043198, 0.050511106848716736, 0.0026747258380055428, -0.0257494505494833, 0.012587730772793293, -0.016165155917406082, 0.00828948151320219, 0.0023443480022251606, -0.015524422749876976, -0.0051926057785749435, -0.05040431767702103, -0.01492373552173376, -0.011486470699310303, -0.001463340362533927, 0.0027281201910227537, 0.003497333498671651, -0.009617666713893414, 0.0023944051936268806, -0.002309307921677828, -0.02162473276257515, -0.005799966864287853, 0.022545786574482918, 0.02554922178387642, -0.015177358873188496, -0.10678880661725998, -0.029073253273963928, 0.025669358670711517, 0.024494683369994164, 0.04898936673998833, -0.02504197508096695, 0.022065237164497375, -0.013642270117998123, 0.011553213931620121, -0.028192244470119476, 0.012801308184862137, -0.008176017552614212, 0.026163257658481598, 0.017526712268590927, 0.02724449336528778, -0.06380631029605865, 0.005890069995075464, 0.0027965318877249956, 0.01640542969107628, -0.01840772107243538, 0.0023727137595415115, 0.01166000310331583, 0.022692620754241943, 0.04463772103190422, -0.04816175252199173, -0.005926778540015221, 0.014403140172362328, 0.002027318812906742, 0.0160850640386343, -0.015017176046967506, -0.01770024374127388, -0.023800555616617203, 0.008015834726393223, 0.02675059624016285, -0.04049965366721153, -0.0021574676502496004, 0.0017102895071730018, -0.016725797206163406, 0.015644559636712074, 0.01831427961587906, 0.02512206695973873, -0.06263163685798645, 0.07955765724182129, 0.04252864047884941, 0.01748666726052761, -0.019876066595315933, 0.033638473600149155, -0.02161138504743576, 0.017820382490754128, -0.011446424759924412, 0.008883493952453136, 0.011272893287241459, 0.011319613084197044, -0.044183868914842606, -0.019555700942873955, 0.02432115003466606, 0.019689185544848442, -0.01639208197593689, 0.011146081611514091, 0.0022425649221986532, 0.010692229494452477, 0.02564266137778759, 0.03879103437066078, -0.03459957242012024, -0.042982496321201324, -0.02683068811893463, -0.01617850363254547, -0.005035759881138802, -0.006527465768158436, -0.01287472527474165, -0.006377294193953276, 0.005269360262900591, -0.017726941034197807, 0.011693374253809452, -0.006424013990908861, -0.02585623972117901, -0.0006056927377358079, 0.007048061117529869, -0.02352023497223854, -0.0007850645924918354, 0.04282231256365776, -0.03307783231139183, 0.03315792605280876, 0.01251431368291378, 0.008503058925271034, 0.023186519742012024, -0.003944511525332928, 0.0032370355911552906, -0.022479044273495674, 0.021584687754511833, 0.02261252887547016, -0.013595550321042538, 0.008062554523348808, -0.02835242822766304, 0.0014516602968797088, -0.029633894562721252, -0.028512611985206604, 0.01899505965411663, 0.013582201674580574, -0.0022041876800358295, 0.035240307450294495, 0.026176605373620987, -0.004511827137321234, -0.016632355749607086, -0.007201570086181164, 0.02673724666237831, -0.011339636519551277, 0.0375896580517292, 0.016258595511317253, 0.0018087354255840182, 0.00041109518497250974, -0.01677919179201126, -0.04909615218639374, 0.007501913700252771, -0.0007124815601855516, 0.04706716537475586, 0.06439364701509476, 0.009550923481583595, 0.028085455298423767, -0.008583149872720242, -0.008009160868823528, 0.03729598969221115, -0.021691476926207542, 0.005492949392646551, -0.024294452741742134, -0.036441680043935776, -0.011332961730659008, 0.012734564952552319, -0.0018237525364384055, -0.02190505340695381, 0.006494094152003527, -0.03606791794300079, 0.029713984578847885, 0.002137444680556655, 0.0006198756746016443, 0.025615964084863663, 0.045091573148965836, 0.00985126756131649, -0.04979028180241585, 0.027818484231829643, 0.012727891094982624, 0.008836774155497551, 0.022906199097633362, 0.030541598796844482, 0.011666676960885525, -0.001531751942820847, -0.006854506675153971, -0.03219682350754738, -0.007555307820439339, -0.018581252545118332, 0.05448898673057556, 0.005202617030590773, -0.013335252180695534, 0.02020978182554245, -0.009570946916937828, 0.01639208197593689, 0.004928970709443092, -0.005526320543140173, -0.037856630980968475, 0.019849369302392006, 0.028485914692282677, 0.04896266758441925, 0.005436217878013849, -0.011186127550899982, 0.010265073738992214, 0.0026029772125184536, 0.00021503760945051908, 0.0030518239364027977, 0.010131588205695152, 0.038764335215091705, 0.010291771031916142, -0.0304615069180727, 0.026283394545316696, 0.014456534758210182, 0.02313312515616417, 0.026683852076530457, -0.013101651333272457, 0.01192030031234026, 0.022198723629117012, 0.03657516464591026, 0.019021756947040558, 0.0003641665098257363, -0.041167084127664566, -8.170803630491719e-05, 0.043596528470516205, -0.024401241913437843, -0.021037394180893898, -0.0034706362057477236, 0.015364239923655987, 0.020837165415287018, 0.016218550503253937, 0.02424105815589428, -0.011726745404303074, 0.04140735790133476, 0.011052641086280346, 0.026003073900938034, -0.027070961892604828, 0.0023476851638406515, -0.00038481512456201017, -0.04597258195281029, -0.022959593683481216, 0.035347096621990204, -0.006474071182310581, -0.02202519215643406, -0.011906951665878296, 0.019942808896303177, -0.03337150067090988, -0.01647217385470867, 0.023773858323693275, -0.0022091935388743877, 0.0173798780888319, 0.009450809098780155, -0.023159822449088097, 0.026884082704782486, -0.00092021917225793, -0.03668195381760597, 0.028886372223496437, -0.004661998711526394, -0.04888257756829262, -0.004331620875746012, -0.009824570268392563, -0.0335850790143013, 0.002356027951464057, -0.005172582808881998, -0.035453882068395615, -0.006587534677237272, 0.03257058560848236, 0.0071748727932572365, -0.0022375592961907387, -0.010278422385454178, -0.012220644392073154, 0.016659053042531013, -0.010652183555066586, 0.0012222313089296222, 0.0007750531076453626, -0.006240470800548792, -0.017032815143465996, -0.020369965583086014, -0.007882349193096161, 0.010038147680461407, -0.003877768525853753, 0.01790047436952591, 0.02485509403049946, 0.014643414877355099, 0.01488368958234787, -0.017032815143465996, 0.03585434332489967, 0.029206737875938416, -0.047120559960603714, -0.024788351729512215, -0.03943176567554474, 0.015951577574014664, 0.02693747729063034, -0.002517879940569401, 0.007588679436594248, -0.012247341684997082, -0.0028215604834258556, 0.05601073056459427, 0.018554555252194405, -0.010485325939953327, 0.0024411254562437534, -0.01931542530655861, -0.015564468689262867, -0.005189268384128809, 0.004942319355905056, -0.02605646848678589, 0.019849369302392006, 0.01312167476862669, -0.0019505643285810947, -0.015484376810491085, -0.04060644283890724, -0.011666676960885525, 0.004982365295290947, 0.0321701280772686, 0.010138262063264847, -0.003263732884079218, 0.021264320239424706, -0.014630066230893135, 0.008790053427219391, 0.023907344788312912, -0.029233435168862343, -0.025602616369724274, -0.047414228320121765, -0.006947946734726429, 0.04210148751735687, -0.007001341320574284, 0.017566759139299393, 0.005009062588214874, -0.01939551718533039, 0.02542908489704132, 0.051018353551626205, 0.02864609658718109, -0.010365188121795654, -0.009577620774507523, 0.004254866391420364, -0.02803206257522106, 0.002783183241263032, 0.02162473276257515, -0.001743661006912589, -0.00985126756131649, 0.021170880645513535, 0.040259379893541336, -0.0111060356721282, 0.03430590406060219, 0.0128146568313241, -0.014349745586514473, 0.017339833080768585, 0.022038539871573448, -0.019048454239964485, -0.028272336348891258, 0.006547488737851381, -0.004825519397854805, -0.015871485695242882, 0.038070209324359894, 0.02534899301826954, 0.00828948151320219, -0.01025839988142252, -0.011172778904438019, 0.012841354124248028, 0.023747161030769348, -0.024708259850740433, -0.003984557464718819, 0.008316177874803543, 0.014469883404672146, -0.015123964287340641, -0.028112152591347694, -0.007949091494083405, -0.0013014886062592268, -0.004531850107014179, 0.02019643224775791, -0.002839914755895734, 0.04130057245492935, 0.005850024521350861, -0.023867297917604446, 0.013081628829240799, 0.0022442336194217205, 0.0010862423805519938, -0.006711008958518505, -0.028913069516420364, -0.013709013350307941, 0.014403140172362328, 0.006380631122738123, 0.013709013350307941, -0.007328381761908531, 0.020957304164767265, 0.007161524146795273, 0.005446229130029678, 0.01065885741263628, -0.0014825289836153388, -0.020143039524555206, 0.07528610527515411, -0.00028720349655486643, -0.02191840298473835, 0.0034122359938919544, -0.003961197100579739, 0.030594993382692337, -0.0037509568501263857, -0.014776901341974735, -0.05262018367648125, 0.0037175852339714766, -0.0173798780888319, 0.027898576110601425, -0.027871878817677498, 0.01759345643222332, 0.021237622946500778, -0.0039912317879498005, -0.005205954425036907, 0.021464550867676735, 0.01588483527302742, 0.015324193984270096, 0.013588875532150269, 0.02231886051595211, -0.03128911927342415, 0.01760680414736271, -0.007048061117529869, 0.0018020611023530364, -0.016739144921302795, 0.02723114565014839, 0.014536626636981964, 0.004521838389337063, -0.004618615843355656, 0.004258203785866499, -0.03681544214487076, -0.0077021424658596516, 0.013161720708012581, 0.012447570450603962, -0.03668195381760597, -0.012287386693060398, -0.007375102024525404, -0.00512919994071126, 0.0019639129750430584, 0.03451948240399361, -0.01176011748611927, -0.012113855220377445, 0.017019465565681458, 0.03366517275571823, -0.0011279567843303084, 0.00092021917225793, 0.005723212379962206, 0.001238082768395543, 0.006604220252484083, -0.006734369322657585, 0.016565613448619843, -0.0088968425989151, 0.016218550503253937, -0.023907344788312912, -0.003827711334452033, 0.006544151343405247, 0.025682708248496056, 0.007869000546634197, -0.03809690847992897, -0.0010278422851115465, -0.014296351000666618, 0.012988188304007053, 0.015137312933802605, -0.01600497215986252, -0.008756682276725769, 0.043089281767606735, -0.01252766139805317, 0.04517166689038277, -0.0017077865777537227, 0.009130442515015602, 0.010785669088363647, 0.00442506093531847, -1.9292900105938315e-05, 0.0029900865629315376, -0.0052993944846093655, 0.04194130375981331, -0.011433077044785023, 0.03337150067090988, -0.022372255101799965, 0.01838102377951145, 0.012801308184862137, -0.0024294452741742134, 0.024961883202195168, 0.04170102998614311, 0.030141141265630722, 0.0011838540667667985, -0.023813903331756592, 0.0034172418527305126, -0.01709955744445324, 0.00869661383330822, 0.03168957680463791, -0.0033087844494730234, -0.010164959356188774, -0.042288366705179214, 0.012848027981817722, -0.02955380268394947, 0.011546540074050426, 0.02131771482527256, -0.017553409561514854, -0.01619185321033001, 0.0745919793844223, 0.007081432733684778, -0.002471159677952528, 0.02655036747455597, -0.03532039746642113, -0.0486689992249012, 0.02582954242825508, 0.023293308913707733, 0.014082773588597775, -0.021184230223298073, 0.01161995716392994, 0.00606026453897357, 0.01588483527302742, 0.01226736418902874, -0.04888257756829262, 0.022105282172560692, 0.007381776347756386, -0.0329977422952652, 0.031209029257297516, -0.019969506189227104, 0.003013446694239974, 0.005015736911445856, 0.02344014309346676, -0.017112907022237778, -0.007982463575899601, 0.01141305360943079, -0.016725797206163406, 0.010532045736908913, -0.019942808896303177, 0.0104586286470294, 0.015804743394255638, -0.001241419930011034, 0.03953855484724045, -0.012254015542566776, -0.00995138194411993, 0.003997906111180782, -0.01697942055761814, -0.013228463008999825, 0.01648552156984806, -0.017553409561514854, -0.002386062406003475, -0.003684213850647211, -0.012213969603180885, -0.012587730772793293, -0.013962636701762676, -0.023693766444921494, 0.021037394180893898, 0.01141305360943079, -0.030194535851478577, 0.014082773588597775, -0.01025839988142252, 0.03489324077963829, 0.029420316219329834, 0.005509634967893362, -0.01302156038582325, -0.02071702852845192, 0.034652967005968094, -0.0005794126773253083, 0.027898576110601425, -0.02514876425266266, 0.011186127550899982, 0.012000392191112041, 0.02190505340695381, -0.023373400792479515, -0.0027998690493404865, -0.009797872975468636, 0.0055463435128331184, -0.037562962621450424, -0.0111060356721282, 0.023079730570316315, -0.009357369504868984, -0.029713984578847885, -0.021851658821105957, 0.002140781842172146, 0.005032422486692667, 0.006480745505541563, -0.02885967493057251, 0.011139407753944397, -0.027017567306756973, -0.0173798780888319, 0.02795197069644928, -0.0022942908108234406, -0.003091869642958045, -0.004084671847522259, 0.009764501824975014, 0.010405234061181545, -0.007074758410453796, 0.015471028164029121, 0.02142450399696827, -0.013542155735194683, 0.011466448195278645, -0.0071081300266087055, 0.0209172572940588, 0.004234843421727419, -0.009584295563399792, -0.009210534393787384, -0.018474463373422623, 0.045198362320661545, -0.006036904640495777, 0.013208440504968166, 0.03606791794300079, 0.004808833356946707, -0.006330573931336403, -0.0029150007758289576, 0.010698903352022171, -0.005766595713794231, -0.010305119678378105, 0.005035759881138802, 0.005893407389521599, 0.00899695698171854, -0.002439456759020686, 0.034439388662576675, 0.01402937900274992, 0.017339833080768585, 0.00848971027880907, 0.008810076862573624, -0.0037008996587246656, -0.01457667164504528, -0.005069131031632423, 0.01236747857183218, -0.014937084168195724, 0.015177358873188496, -0.010912480764091015, -0.00019428471568971872, 0.002893309108912945, 0.011806837283074856, -0.003500670660287142, 0.01172007154673338, -0.00021983476472087204, -0.026670504361391068, -0.007168198470026255, -0.015938229858875275, 0.021784916520118713, -0.01216057501733303, 0.011553213931620121, -0.004985702224075794, -0.029126647859811783, -0.00012107598013244569, -0.03857745602726936, 0.00540284626185894, 0.0037008996587246656, -0.0029116636142134666, -0.021157532930374146, 0.054942842572927475, 0.007181547116488218, 0.02201184257864952, -0.026069818064570427, 0.032623980194330215, 0.0032487157732248306, 0.03630819544196129, 0.0038410599809139967, -0.0014333060244098306, 0.027684997767210007, -0.018941665068268776, 0.014042727649211884, -0.02414761856198311, 0.01979597471654415, 0.03067508526146412, -0.027498116716742516, -0.025255553424358368, -0.00995138194411993, 0.008236086927354336, -0.009223883040249348, 0.010311794467270374, -0.00368087668903172, -0.005099165719002485, -0.036655258387327194, -0.01292144600301981, 0.003210338531062007, 0.008262784220278263, 0.007775560021400452, -0.0016151807503774762, -0.009337346069514751, 0.021651430055499077, 0.02002290077507496, -0.007248290348798037, 0.019448911771178246, 0.0033338130451738834, 0.053447797894477844, -0.02633678913116455, 0.017126254737377167, 0.00608362490311265, 0.004171437583863735, -0.019248683005571365, -0.03155609220266342, -0.006143693346530199, -0.008629870600998402, 0.01819414272904396, -0.022866154089570045, -0.020156387239694595, 0.03369186818599701, -0.03235700726509094, -0.02442793920636177, -0.005019073840230703, 0.012180598452687263, -0.02432115003466606, 0.00442506093531847, 0.016752494499087334, -0.008516407571732998, -0.016819236800074577, -0.0038610827177762985, 0.0015392604982480407, 0.0307551771402359, 0.026176605373620987, -0.03179636597633362, 0.019368819892406464, -0.0001330688683083281, -0.01401603128761053, 0.012627776712179184, -0.015951577574014664, 0.0003952437255065888, 0.0033087844494730234, -0.025696055963635445, 0.02213197946548462, -0.013041582889854908, 0.006317225284874439, -0.005382823292165995, 0.016151806339621544, -0.01577804610133171, 0.01488368958234787, 0.020770423114299774, 0.009684409946203232, 0.02493518590927124, -0.014389791525900364, -0.00251454277895391, 0.012414198368787766, -0.022772712633013725, -0.025402387604117393, -0.001425797468982637, 0.00664092879742384, 0.0029533780179917812, -0.021291017532348633, -0.002898314967751503, 0.015097267925739288, 0.007241616025567055, 0.02011634223163128, 0.0287528857588768, -0.01971588283777237, 0.0007329215877689421, 0.01840772107243538, -0.025095369666814804, -0.020276524126529694, -0.020436707884073257, 0.014349745586514473, -0.004191460553556681, 0.0034672990441322327, 0.011533191427588463, 0.010565417818725109, 0.015217404812574387, 0.0335850790143013, 0.0026496972423046827, -0.026416881009936333, 0.021971797570586205, -0.003881105687469244, 0.017780335620045662, -0.009237231686711311, -0.04231506586074829, -0.013041582889854908, -0.040259379893541336, -0.000626967113930732, 0.02364037185907364, 0.010064844973385334, 0.03991231694817543, -0.0315827876329422, -0.010592115111649036, -0.00925725419074297, 0.013582201674580574, -0.031022148206830025, 0.00879672821611166, 0.04944321885704994, -0.0035574021749198437, 0.0028499262407422066, -0.02462816797196865, -0.05027082934975624, -0.027684997767210007, -0.01348208636045456, 0.028592702001333237, 0.01182018592953682, 0.029580499976873398, -0.0209172572940588, 0.007441844791173935, -0.023760508745908737, -0.007962440140545368, 0.013375298120081425, -0.01677919179201126, 0.031716275960206985, 0.0012397513492032886]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" estimation. However, after sampling the proposal
according to ψT, we only need to evaluate ϕ(s1:T)overKfull sequences to calculate the importance weights at the final
step (Eq. (16)). See Intermediate Potential Tractable over KSequences Only paragraph below.
Intermediate Potentials Tractable over |V|Sequences However, in settings where the intermediate potentials ϕt(s1:t)
aretractable to calculate for all st∈ V given s1:t−1(e.g. using an indicator function or forward pass in a transformer
architecture, as in Table 5), it may be useful to use a Φtparameterization of the twist targets and twist-induced proposal. This
allows us to use the exact immediate potentials ϕt(s1:t)alongside an estimated Φθ
t, instead of an approximate ψθ
t≈ϕtΦ∗
t
which estimates both the immediate ϕtand future expected value of potentials Φ∗
t. Using notation established in Eq. (33)
and Prop. B.1, the twisting targets in Eq. (Twist Targets ( ψ) ) can be rewritten using a Φθ
tparameterization
πθ
t(s1:t) =1
Zψ
tp0(s1:t) t−1Y
τ=1ϕτ(s1:τ)!
ϕt(s1:t)Φθ
t(s1:t) ( t < T ) (Twist Targets ( Φ))
withπT(s1:T) =σ(s1:T)as before. The twist-induced proposal qπ
t(st|s1:t−1)∝p0(st|s1:t−1)ϕt(s1:t)Φθ
t(s1:t)and its
normalization constant are tractable in this case, by evaluating both the given ϕt(s1:t)and parameterized Φθ
t(s1:t)in a single
forward pass and normalizing over the discrete vocabulary of next tokens.
Intermediate Potentials Tractable over KSequences Only In cases where the intermediate potentials are difficult to
evaluate, we would like to limit evaluation of ϕt(s1:t)to only Kpartial sequences. In this case, parameterizing the twisted
targets πtusing ψθ
torQθ
t(Eq. (Twist Targets ( ψ) ), Eq. (Twist Targets (Soft RL Q) )) instead of Φθ
torVθ
tmay be preferable
to ensure a tractable twist-induced proposal. Separate parameterizations of the proposal (using ψξ
t) and targets ( ϕtΦθ
t) might
also be considered.
In the case of the final timestep described above or in Sec. 3.2, note that we use a learned ψξ
Tto parameterize a tractable
variational proposal qT(sT|s1:T−1). In this case, we have no future value ΦT(s1:T) = 1 and only need to evaluate the
terminal potential ϕ(s1:T)for calculating importance weights over Ksequences.
C. Twist Learning Losses
In this section, we describe various methods for twist learning beyond our proposed contrastive twist learning (CTL)
procedure from Sec. 4. In App. C.1, we first describe several losses from the soft RL literature from a probabilistic
perspective, building closely on our developments in App. B.1. We then proceed to describe SIXO (Lawson et al., 2022) and
FUDGE (Yang & Klein, 2021) in App. C.3-C.4.
We emphasize losses found in related work or used as experimental baselines using equation tags (e.g. Eq. (SIXO)), where
equations Eq. (RL Baseline), Eq. (SIXO), Eq. (FUDGE) are used in our experiments. We consider settings with intermediate
potentials in App. C.1, but focus on the ( ϕt= 1fort < T ) setting in the remainder of the section, as in the main text.
C.1. Soft Q-Learning (RL) and Path Consistency Losses from Log Importance Weights
From the probabilistic perspective of the SMC log importance weights, we can derive several losses for twist learning,
including soft Q-learning and path consistency learning (PCL) (Nachum et al., 2017) losses from the soft RL literature.
A general principle for deriving loss functions would be to minimize the variance of the (log) importance weights under
some sampling distribution πs, which leads to constant importance weights at optimality","[0.0048600127920508385, 0.023662684485316277, 0.010257814079523087, -0.009361499920487404, -0.011174045503139496, 0.007681741379201412, 0.01683742180466652, 0.01651873253285885, -0.014141839928925037, 0.04042043164372444, 0.031709592789411545, -0.009447811171412468, -0.03752567246556282, 0.010410519316792488, 0.06230377033352852, -0.02192317135632038, 0.04068600758910179, -0.0006556369480676949, -0.02433989942073822, 0.04331519454717636, 0.00106893724296242, -0.02696908637881279, -0.007894201204180717, 0.05805457755923271, 0.0025378959253430367, -0.03232041373848915, 0.06798706203699112, 0.004196076653897762, 0.017939554527401924, -0.00256611336953938, 0.07590118050575256, -0.032506313174963, -0.04068600758910179, -0.04700668156147003, -0.00314871734008193, 0.06591558456420898, -0.013663806021213531, 0.04788307473063469, -0.004478249233216047, 0.030487949028611183, 0.0335686132311821, -0.033064018934965134, -0.012256261892616749, 0.05720473825931549, 0.02117956429719925, 0.04219978302717209, 0.03757878765463829, 0.021644318476319313, -0.022812847048044205, 0.031656477600336075, -0.009912567213177681, 0.04153584688901901, 0.005032636225223541, -0.017514636740088463, 0.0018557015573605895, 0.027752531692385674, -0.0054575554095208645, -0.02188333496451378, 0.007456003222614527, -0.030594177544116974, 0.0028217285871505737, -0.029717782512307167, 0.013424789533019066, -0.014819054864346981, -0.014141839928925037, 0.008644448593258858, -0.07367035746574402, 0.034976158291101456, -0.0003830081841442734, 0.04111092537641525, 0.008173054084181786, 0.01770053803920746, 0.02352989837527275, 0.02188333496451378, -0.010609699413180351, 0.024366457015275955, 0.028443025425076485, 0.048122093081474304, 0.032293856143951416, -0.012508557178080082, 0.011432981118559837, -0.05093718320131302, 0.019705625250935555, -0.03662271797657013, 0.0011909354943782091, -0.04894537478685379, -0.0511496402323246, -0.022069238126277924, -0.04336830973625183, 0.0024383056443184614, -0.01752791553735733, -0.007389609236270189, -0.011167406104505062, 0.003950420301407576, 0.03800370544195175, 0.005454235710203648, 0.04389945790171623, 0.01839103177189827, 0.03245319798588753, 0.021060055121779442, 0.019546279683709145, 0.0060716960579156876, 0.01586807332932949, 0.007993791252374649, 0.06804017722606659, 0.01930726319551468, 0.011154127307236195, 0.0009054429247044027, -0.045917823910713196, -0.010071911849081516, -0.005772924982011318, -0.009129121899604797, -0.05778900161385536, 0.02884138748049736, 0.01795283332467079, -0.07154575735330582, -0.06426902115345001, -7.832371920812875e-05, -0.048547010868787766, -0.008026988245546818, -0.031444016844034195, -0.008976416662335396, 0.01925414800643921, 0.031922049820423126, 0.007920758798718452, 0.009680189192295074, -0.0019851690158247948, -0.034923043102025986, -0.008491743355989456, 0.013252166099846363, 0.012634704820811749, 0.015044793486595154, 0.007216986268758774, -0.00015011180948931724, -0.008591334335505962, -0.001385966781526804, -0.016704633831977844, 0.04432437941431999, 0.016160206869244576, 0.008730760775506496, 0.008259366266429424, -0.02305186353623867, -0.028389910236001015, 0.014619873836636543, -0.003548738779500127, 0.019639231264591217, 0.009129121899604797, 0.034445006400346756, -0.004511446226388216, 0.022587107494473457, -0.024153998121619225, -0.03399353101849556, -0.03524173051118851, 0.016385944560170174, 0.008352316915988922, -0.04214666783809662, -0.027646301314234734, 0.05656735971570015, 0.0021478335838764906, -0.0248179342597723, 0.03513550013303757, 0.0015785081777721643, -0.014593317173421383, 0.002816749271005392, 0.03972994163632393, -0.002941237296909094, -0.022693337872624397, 0.027327612042427063, -0.05284931883215904, -0.046024054288864136, 0.027858762070536613, -0.06161327660083771, -0.03672894835472107, -0.040393877774477005, 0.011804784648120403, -0.025667771697044373, -0.01930726319551468, -0.060072943568229675, -0.0048334551975131035, 0.0005091560306027532, -0.0032715455163270235, 0.03885354474186897, -0.026730069890618324, 0.00011815988546004519, -0.027301054447889328, 0.014925285242497921, 0.0024117480497807264, 0.03263910114765167, 0.020011035725474358, 0.008823711425065994, 0.0017693898407742381, 0.04740504175424576, 0.04737848415970802, -0.004630954936146736, -0.05640801787376404, -0.004438413307070732, 0.040287647396326065, 0.06299426406621933, 0.040500104427337646, -0.012083638459444046, 0.0003423420712351799, 0.032506313174963, 0.0014581697760149837, -0.01973218284547329, -0.006061736959964037, -0.01817857287824154, -0.01037732232362032, -0.008080103434622288, -0.08981728553771973, -0.004611036740243435, 0.02084759622812271, 0.007150592282414436, 0.0292131919413805, 0.02647777460515499, -0.010018796660006046, 0.028655484318733215, -0.029717782512307167, 0.005102349445223808, -0.01082879863679409, 0.060975898057222366, 0.030275488272309303, -0.0009867751505225897, 0.0024316662456840277, 0.027141710743308067, -0.03601189702749252, -0.0012930156663060188, 0.023715799674391747, -0.014394136145710945, 0.07436084747314453, -0.034923043102025986, 0.041801419109106064, 0.00039670185651630163, -0.030859753489494324, 0.0015643995720893145, 0.004152920562773943, -0.048600126057863235, 0.0005539717385545373, -0.015907909721136093, -0.015177580527961254, -0.07430773228406906, 0.016332829371094704, 0.004883250687271357, 0.007595429662615061, -0.034657467156648636, 0.0060750157572329044, 0.03505583107471466, -0.022069238126277924, 0.005799482576549053, 0.013796593062579632, -0.013497821986675262, 0.010244535282254219, -0.005733088590204716, 0.021259235218167305, 0.01796611212193966, -0.05303522199392319, -0.01816529408097267, 0.03420599177479744, 0.03178926184773445, -0.05364604294300079, 0.026637118309736252, 0.01791299693286419, -0.03837551176548004, 0.005108988843858242, 0.040022071450948715, -0.013199050910770893, -0.010656175203621387, -0.005726449191570282, 0.012774131260812283, 0.041960764676332474, -0.036861736327409744, -0.016598403453826904, 0.026172364130616188, -0.03864108398556709, 0.03431222215294838, -0.019227590411901474, -0.02465858869254589, 0.029903683811426163, 0.018855787813663483, -0.014354299753904343, 0.06533131748437881, -0.009281827136874199, -0.051282428205013275, 0.04509454220533371, -0.006453459616750479, -0.013033066876232624, 0.016319550573825836, -0.02294563315808773, 0.03510894253849983, -0.017342012375593185, -0.026451217010617256, -0.0015544405905529857, -0.007442724425345659, 0.039650268852710724, -0.022852683439850807, -0.003439189400523901, 0.0361446850001812, 0.00962043460458517, -0.019984478130936623, 0.016173485666513443, -0.001053998596034944, 0.030355161055922508, 0.0016258136602118611, -0.008106660097837448, 0.03210795298218727, 0.016014140099287033, 0.0032234101090580225, 0.051229313015937805, -0.004053330048918724, -0.016983486711978912, 0.02047579176723957, -0.025163181126117706, -0.005016037728637457, -0.0008137367549352348, 0.003923862706869841, -0.030859753489494324, -0.036702390760183334, 0.04010174423456192, -0.007203707471489906, 0.006347229704260826, -0.02894761599600315, -0.03678206354379654, -0.03577287867665291, 0.005314808804541826, 0.01552282739430666, 0.013902823440730572, -0.021206120029091835, -0.027964990586042404, 0.005049234721809626, -0.0527430884540081, -0.0042359125800430775, 0.009859452024102211, -0.029186634346842766, 0.025282688438892365, -0.005786203779280186, -0.06804017722606659, -0.051919806748628616, -0.03656960278749466, 0.03529484570026398, 0.023237764835357666, 0.0178067684173584, -0.08269988745450974, -0.01897529512643814, 0.003110540797933936, -0.010437075980007648, -0.011034619063138962, 0.05800146237015724, 0.02804466336965561, -0.0201571024954319, 0.06124147027730942, 0.03210795298218727, -0.01386298704892397, -0.03173614665865898, 0.03627747297286987, -0.02188333496451378, 0.022879239171743393, -0.0008490083855576813, -0.050591934472322464, -0.03994239866733551, -0.03797714784741402, 0.0006543920608237386, -0.024459408596158028, 0.0007324045873247087, 0.012415606528520584, 0.017461521551012993, 0.01179814524948597, 0.012216425500810146, 0.02815089374780655, 0.0009087626240216196, -0.005231816787272692, -0.0049728816375136375, 0.006944772321730852, 0.008040267042815685, -0.017820047214627266, 0.011844621039927006, -0.031337786465883255, 0.015376761555671692, -0.004657512065023184, 0.005045915022492409, 0.016970207914710045, 0.02497727796435356, 0.00806682463735342, -0.012442163191735744, -0.015934467315673828, -0.001216663047671318, 0.020767923444509506, -0.007814528420567513, -0.003804354229941964, 0.0020731405820697546, -0.024685146287083626, 0.01849726215004921, 0.01989152655005455, -0.0029910323210060596, -0.03093942441046238, 0.020343003794550896, 0.008690924383699894, -0.004793619271367788, -0.007309936918318272, 0.0531945638358593, 0.05821392312645912, 0.02622547745704651, -0.04687389358878136, -0.007475920952856541, -0.07218313962221146, -0.02467186748981476, -0.021060055121779442, -0.014885448850691319, 0.01645233854651451, -0.010284370742738247, 0.007422806229442358, 0.05077783763408661, 0.06315360963344574, 0.0019254148937761784, 0.017023323103785515, -0.01945332996547222, 0.02444612979888916, -0.055080145597457886, 0.03359517082571983, -0.0035586978774517775, 0.03627747297286987, 0.060338519513607025, -0.007084198761731386, -0.030009914189577103, -0.004577839747071266, -0.004006854724138975, -0.026796463876962662, 0.018829230219125748, 0.053114891052246094, -0.014991678297519684, 0.03571976721286774, -0.05587686598300934, -0.008153135888278484, 0.0625162273645401, 0.012163310311734676, -0.03577287867665291, -0.0563017874956131, -0.030169259756803513, 0.032240740954875946, 0.03372795507311821, -0.031390901654958725, -0.07037723064422607, -0.008989695459604263, -0.008890105411410332, 0.002089739078655839, -0.012946754693984985, -0.013550937175750732, 0.04379322752356529, -0.015828238800168037, -0.03295779228210449, 0.00019378637080080807, -0.020303167402744293, 0.001478087855502963, 0.02675662748515606, 0.06878378987312317, -0.031125327572226524, -0.003439189400523901, -0.013152575120329857, 0.07361724227666855, -0.036967966705560684, 0.06400344520807266, -0.03752567246556282, 0.014540201984345913, 0.015854796394705772, -0.0031188400462269783, -0.01021133828908205, 0.018789393827319145, 0.034869927912950516, 0.05624867230653763, -0.008478464558720589, -0.010842077434062958, 0.018669884651899338, 0.01069601159542799, -0.004816856700927019, 0.029584994539618492, -0.042226340621709824, -0.004232592880725861, 0.033170249313116074, 0.05037947744131088, -0.025813838467001915, 0.018324637785553932, -0.005610260646790266, 0.005089070647954941, 0.01181806344538927, 0.019559558480978012, -0.0032483076211065054, 0.030169259756803513, 0.07696347683668137, 0.02268005907535553, -0.03269221633672714, -0.006088294554501772, 0.010895192623138428, -0.017780210822820663, -0.05550506338477135, 0.0008153966045938432, -0.014712825417518616, 0.02836335264146328, -0.02188333496451378, -0.004982840735465288, -0.012242983095347881, -0.012628065422177315, -0.04541323333978653, 0.03542763367295265, -0.0006452629459090531, 0.036808621138334274, 0.025402197614312172, 0.020343003794550896, 0.039862725883722305, 0.012369130738079548, 0.01211683452129364, -0.012216425500810146, 0.05351325497031212, 0.0028615647461265326, -0.02476481907069683, -0.02338383160531521, 0.01069601159542799, -0.0026557445526123047, 0.034816812723875046, -0.04456339403986931, -0.006748910993337631, 0.015124465338885784, 0.02208251692354679, -0.00537456339225173, -0.03255942836403847, -0.02084759622812271, -0.030514506623148918, 0.013272084295749664, -0.035029273480176926, -0.02599973976612091, -0.07037723064422607, -0.042916834354400635, -0.03805682063102722, 0.010138304904103279, -0.02176382765173912, 0.009414615109562874, 0.016797585412859917, -0.03216106817126274, 0.02315809391438961, -0.02352989837527275, -0.01444725040346384, -0.011784866452217102, 0.011041258461773396, 0.008352316915988922, 0.0036881654523313046, 0.002056542318314314, 0.008538219146430492, 0.008744039572775364, -0.0019851690158247948, 0.026145806536078453, -0.008345677517354488, -0.0023353954311460257, 0.002111316891387105, 0.00868428498506546, -0.019931362941861153, -0.020767923444509506, -0.03845518082380295, -0.01983841322362423, -0.0018656606553122401, -0.0016341129085049033, 0.004169519059360027, 0.013497821986675262, 0.027460400015115738, 0.027048759162425995, -0.02804466336965561, -0.008617890998721123, -0.006559689063578844, 0.0020963784772902727, 0.01789971813559532, 0.03173614665865898, 0.006158007774502039, 0.010410519316792488, 0.03635714575648308, -0.05885130167007446, -0.027141710743308067, 0.03548074886202812, -0.08455891162157059, -0.005988704040646553, -0.030594177544116974, 0.00911584310233593, -0.029691224917769432, -0.009215434081852436, -0.0162531565874815, -0.030912866815924644, -0.022826125845313072, 0.015748566016554832, -0.010702650994062424, -0.02900073118507862, -0.005543867126107216, -0.00989264901727438, 0.022985469549894333, -0.012747574597597122, 0.02084759622812271, 0.012561672367155552, -0.019971199333667755, -0.021723991259932518, -0.0009154019644483924, -0.033064018934965134, -0.029611552134156227, -0.012183228507637978, -0.02857581153512001, -0.039597153663635254, 0.010808880440890789, -0.013185772113502026, 0.010974864475429058, 0.05014045909047127, -0.05298210680484772, -0.026836300268769264, 0.06889001280069351, -0.04429782181978226, 0.02331743761897087, 0.03710075095295906, 0.011280274949967861, 0.024459408596158028, 0.032506313174963, 0.012740935198962688, -0.006755550391972065, 0.00757551146671176, -0.03245319798588753, 0.0116122430190444, 0.009587238542735577, 0.04767061769962311, -0.01898857392370701, -0.023768914863467216, -0.013086182065308094, 0.02315809391438961, -0.037605345249176025, 0.016040697693824768, 0.007316576316952705, -0.00695805111899972, -0.034285664558410645, 0.005314808804541826, 0.028230564668774605, -0.04400568827986717, 0.013418150134384632, 0.0015901271253824234, 0.017275618389248848, -0.01941349357366562, -0.008405432105064392, 0.0019403534242883325, -0.01639922335743904, 0.01941349357366562, -0.01645233854651451, -0.001470618648454547, 0.01418167632073164, -0.028443025425076485, -0.015668893232941628, 0.02536236122250557, 0.005042595323175192, -0.030912866815924644, 0.02499055676162243, -0.013770036399364471, -0.020223494619131088, -0.02234809100627899, -0.01181806344538927, 0.06118835508823395, -0.013092821463942528, 0.04899848997592926, -0.0033014225773513317, -0.0023353954311460257, 0.006290795281529427, 0.008332398720085621, -0.034816812723875046, -0.0271284319460392, -0.0035520584788173437, 0.009202155284583569, -0.008843629620969296, 0.0026740028988569975, 0.032346971333026886, 0.003711403114721179, 0.05284931883215904, 0.004292347468435764, -0.018895622342824936, -0.03633058816194534, 0.04921094700694084, 0.04148273169994354, 0.007555593270808458, -0.0007465131930075586, -0.010636257007718086, -0.004727225285023451, -0.05393817275762558, -0.00616796687245369, 0.04931717738509178, 0.004441733006387949, -0.026066133752465248, -0.03951748088002205, -0.019984478130936623, -0.012143392115831375, 0.005175382364541292, 0.03619780018925667, -0.005421038717031479, -0.01570872962474823, 0.0009627074468880892, -0.005271653179079294, -0.011598965153098106, 0.02868204191327095, -0.04063289240002632, -0.01641250215470791, 0.0034259106032550335, -0.002683961996808648, 0.03699452430009842, -0.014819054864346981, -0.020077429711818695, 0.0035719764418900013, 0.0250436719506979, -0.016492174938321114, -0.009255270473659039, -0.029027288779616356, -0.02208251692354679, 0.000928680703509599, 0.051176197826862335, 0.03988928347826004, -0.002159452298656106, -0.025442034006118774, 0.03651648759841919, -0.01849726215004921, 0.007754774298518896, -0.03768501803278923, 0.047803401947021484, 0.011585686355829239, 0.03178926184773445, 0.00347902555949986, -0.011711833998560905, -0.00183578347787261, -0.016067255288362503, -0.05024668946862221, -0.015204138122498989, 0.0004120553785469383, -0.007934036664664745, -0.03067385032773018, 0.009102564305067062, 0.005407759919762611, 0.020130544900894165, -0.0002632921969052404, 0.021325629204511642, 0.005676654167473316, -0.00863116979598999, -0.009859452024102211, 0.039490923285484314, -0.008000430651009083, 0.014513644389808178, -0.024632031098008156, 0.013292001560330391, 0.031709592789411545, -0.028921058401465416, -0.01920103281736374, 0.03853485360741615, 0.04958275333046913, 0.03362172842025757, 0.033754512667655945, 0.03301090747117996, 0.03789747506380081, -0.003077344037592411, -0.017275618389248848, 0.011618882417678833, -0.011353308334946632, -0.0039271824061870575, 0.017275618389248848, 0.0030507866758853197, -0.008305841125547886, -0.017673980444669724, -0.004484888631850481, 0.010224617086350918, 0.011990686878561974, -0.000451476575108245, -0.007064280565828085, 0.021060055121779442, -0.021192843094468117, 0.02391497977077961, -0.0206484142690897, 0.00278687197715044, -0.006655959878116846, -0.006546410731971264, -0.001017482136376202, 0.02102021872997284, -0.00873740017414093, 0.02321120724081993, 0.04145617410540581, -0.0052650137804448605, 0.004182797856628895, -0.0004639253893401474, -0.01699676550924778, -0.021325629204511642, 0.034126318991184235, -0.0031304589938372374, 0.011831342242658138, -0.05816080793738365, -0.031231556087732315, -0.027274496853351593, -0.012501917779445648, -0.0020333044230937958, 0.007469282019883394, -0.004843414295464754, -0.03194860741496086, -0.0017146151512861252, -0.0060750157572329044, -0.012010605074465275, 0.003751239273697138, 0.011758309789001942, -0.0232244860380888, -0.11345341056585312, -0.028389910236001015, 0.004096486140042543, 0.009241991676390171, 0.03569320961833, -0.020183660089969635, 0.000530733959749341, 0.016983486711978912, 0.015124465338885784, -0.023941537365317345, 0.007608708459883928, -0.010981503874063492, 0.020568741485476494, 0.036596160382032394, 0.03253287076950073, -0.059435565024614334, 0.014699546620249748, -0.016266435384750366, 0.015018235892057419, -0.015058072283864021, 0.00727674039080739, 0.021577924489974976, 0.012933476828038692, 0.05035291984677315, -0.037074193358421326, -0.01671791262924671, 0.012136752717196941, 0.008153135888278484, -0.005600301548838615, 0.021737270057201385, -0.030222373083233833, -0.02638482302427292, 0.002982733305543661, 0.024300063028931618, -0.030408276244997978, 0.004152920562773943, 0.006665918976068497, -0.003439189400523901, 0.010257814079523087, 0.0022142271045595407, 0.01752791553735733, -0.030753523111343384, 0.07914119213819504, 0.006300754379481077, 0.01399577409029007, -0.00081083201803267, 0.031762704253196716, -0.0340997613966465, 0.025959903374314308, -0.030806638300418854, 0.0351620577275753, 0.013690363615751266, 0.00776141369715333, -0.03510894253849983, -0.005553825758397579, 0.03606501221656799, 0.022175468504428864, -0.025056950747966766, -0.002267342060804367, 0.012216425500810146, -0.0004950474249199033, 0.037445999681949615, 0.05146833136677742, -0.014301184564828873, -0.048175208270549774, -0.02363612689077854, -0.015323646366596222, 0.0006489976076409221, 0.007887561805546284, 0.0001756318670231849, 0.017820047214627266, -0.01650545373558998, 0.000386950297979638, 0.016093812882900238, -0.017355291172862053, -0.023715799674391747, -0.0058625563979148865, 0.010390601120889187, -0.018324637785553932, 0.003967018332332373, 0.06745591014623642, -0.04413847625255585, 0.040925025939941406, 0.03617124259471893, -0.008763957768678665, 0.0232643224298954, -0.017195947468280792, -0.0058094412088394165, -0.02488432638347149, 0.026066133752465248, 0.034179434180259705, -0.0054741534404456615, 0.019918084144592285, -0.04169519245624542, -0.010649535804986954, -0.016492174938321114, 0.008750678971409798, -0.002517977962270379, 0.02080775983631611, 0.019718904048204422, 0.02428678423166275, 0.04294339194893837, -0.011652079410851002, -0.005577063653618097, -0.004381978884339333, 0.03571976721286774, -0.0031785944011062384, 0.05720473825931549, 0.02467186748981476, -0.013716921210289001, 0.017727095633745193, -0.04567880928516388, -0.04111092537641525, -0.001857361407019198, 0.011187324300408363, 0.00011473646736703813, 0.07367035746574402, 0.006805345416069031, 0.017129553481936455, 0.014540201984345913, 0.017939554527401924, 0.04273093119263649, -0.025906788185238838, -0.009859452024102211, -0.013292001560330391, -0.036649275571107864, -0.0020316445734351873, -0.020409397780895233, 0.007502478547394276, -0.0018855787348002195, 0.01817857287824154, -0.013929381035268307, 0.006516533438116312, -0.00957395974546671, 0.00025125834508799016, 0.04745815694332123, 0.04695356637239456, 0.014487086795270443, -0.012860443443059921, 0.013331837952136993, -0.011539210565388203, -0.001286376267671585, 0.02461875230073929, 0.03120500035583973, 0.03813649341464043, -0.009500926360487938, -0.016425780951976776, -0.018218407407402992, -0.027088595554232597, -0.021139727905392647, 0.04108436778187752, -0.0031155203469097614, -0.019320541992783546, 0.03237352892756462, -0.013610690832138062, 0.01839103177189827, 0.003767837770283222, -0.009779779240489006, -0.03972994163632393, 0.011021340265870094, -0.003950420301407576, 0.021909892559051514, -0.010782322846353054, 0.004684069659560919, 0.0036649275571107864, -0.004056649748235941, -0.018218407407402992, -0.009381418116390705, 0.02225513942539692, 0.02031644620001316, -0.010609699413180351, -0.045386675745248795, 0.02626531384885311, 0.03845518082380295, 0.021086612716317177, 0.04042043164372444, -0.010569863952696323, 0.017939554527401924, 0.01468626782298088, 0.01404888927936554, 0.013796593062579632, 0.007688380777835846, -0.02509678713977337, 0.004601077642291784, 0.04788307473063469, -0.021538089960813522, -0.006765509489923716, -0.011114290915429592, 0.004295667167752981, 0.0271284319460392, -0.013059624470770359, 0.02831023745238781, -0.04004862904548645, 0.02809777855873108, 0.018829230219125748, 0.01064289640635252, -0.03157680481672287, 0.0076751019805669785, -0.0064600990153849125, -0.04188109189271927, -0.03763190284371376, 0.030222373083233833, 0.0012946755159646273, -0.021033497527241707, -0.014513644389808178, 0.023609569296240807, -0.03024893067777157, -0.010556585155427456, 0.03571976721286774, -0.009700107388198376, 0.030169259756803513, -0.0006398684927262366, -0.026796463876962662, 0.040818795561790466, -0.026676954701542854, 0.00538784172385931, 0.03200172260403633, -0.01736856997013092, -0.041854534298181534, -0.018377752974629402, -0.046236515045166016, -0.03571976721286774, 0.0027470358181744814, -0.016120370477437973, -0.014819054864346981, -0.01785988360643387, 0.04477585479617119, 1.0328616554033943e-05, 0.022281697019934654, -0.0004381978651508689, -0.026026297360658646, 0.0014424013206735253, -0.028867945075035095, 0.013836429454386234, -0.03731321170926094, 0.0026076093781739473, -0.0016648198943585157, -0.007064280565828085, 0.0015419917181134224, 9.512960241409019e-05, 0.0022839403245598078, 0.00513554597273469, 0.01898857392370701, -0.012900279834866524, 0.022706616669893265, -0.008750678971409798, 0.03524173051118851, 0.04411191865801811, -0.04889225959777832, -0.0011494394857436419, -0.0362243577837944, 0.031178442761301994, 0.033382710069417953, -0.01904168911278248, 0.003581935539841652, -0.009381418116390705, 0.017607586458325386, 0.049609310925006866, 0.048015862703323364, 0.01812545768916607, -0.013438068330287933, 0.0061945244669914246, -0.03513550013303757, -0.01950644515454769, -0.014872170053422451, -0.0183379165828228, 0.023357274010777473, 0.02188333496451378, -0.0206882506608963, -0.002830027835443616, -0.039544038474559784, -0.001956951804459095, -0.017249060794711113, 0.04392601549625397, -0.008412071503698826, 0.005138865672051907, 0.031709592789411545, -0.013550937175750732, 0.022852683439850807, 0.00946772936731577, -0.011094373650848866, -0.03630403056740761, -0.0013552596792578697, -0.006944772321730852, 0.03898633271455765, -0.01855037547647953, 0.02497727796435356, -0.021577924489974976, -0.011399784125387669, 0.017182668671011925, 0.039384692907333374, 0.030116144567728043, -0.005268333479762077, -0.019426772370934486, 0.009381418116390705, -0.02584039606153965, 0.004355421289801598, 0.010569863952696323, 0.012229704298079014, -0.01678430661559105, 0.010895192623138428, 0.028549255803227425, -0.006675878074020147, 0.030461391434073448, -0.0018125456990674138, -0.01043043751269579, 0.014991678297519684, 0.008425350300967693, 0.011346668936312199, -0.02931942045688629, -0.008319119922816753, 0.01528380997478962, 0.0029976717196404934, 0.04108436778187752, 0.019227590411901474, -0.0024532440584152937, -0.028602369129657745, -0.013172493316233158, 0.01849726215004921, -0.00660616485401988, -0.004129683133214712, -0.0057397279888391495, 0.015177580527961254, 0.005703211762011051, -0.012375770136713982, -0.026955807581543922, -0.016797585412859917, -0.01297331228852272, 0.00849838275462389, 0.03404664620757103, -0.0039271824061870575, 0.005401120521128178, -0.0030142702162265778, -0.00935486052185297, 0.01758102886378765, 0.0072701009921729565, 0.005052553955465555, -0.015589221380650997, -0.030063029378652573, -0.020117266103625298, 0.022002844139933586, -0.005002758931368589, 0.002738736569881439, -0.013424789533019066, 0.013637248426675797, 0.0008755658054724336, -0.02471170388162136, -0.005331407301127911, -0.003976977430284023, -0.01026445347815752, 0.0625162273645401, 0.0068385424092411995, -0.011751670390367508, -0.012674541212618351, 0.007495839148759842, 0.029983356595039368, -0.008339038118720055, -0.01246872078627348, -0.050698164850473404, 5.933929423918016e-05, -0.03340926766395569, 0.04225289821624756, -0.0201571024954319, 0.0044981674291193485, 0.033382710069417953, 0.004617676138877869, -0.01893545873463154, 0.020236773416399956, -0.00513554597273469, 0.02407432533800602, -0.00012894885730929673, -0.007456003222614527, -0.03914567455649376, 0.0025229575112462044, -0.013185772113502026, 0.0030142702162265778, -0.008272644132375717, 0.039703384041786194, -0.0012224724050611258, 0.0054309978149831295, 0.02031644620001316, -0.01839103177189827, -0.045652251690626144, -0.01623987779021263, 0.025176459923386574, 0.008186332881450653, -0.039331577718257904, -0.0012316015781834722, 0.005567104555666447, 0.012966672889888287, -0.015137744136154652, 0.004484888631850481, -0.0011311812559142709, -0.0026457856874912977, -0.002700560260564089, 0.018470704555511475, -0.010788962244987488, 0.0076020690612494946, 0.020289888605475426, -0.0005585362669080496, 0.002517977962270379, -0.020143823698163033, 0.020170381292700768, -0.004302306100726128, 0.006138089578598738, -0.012242983095347881, -0.017408406361937523, 0.028177451342344284, 0.03518861532211304, 0.004013494122773409, -0.03566665202379227, 0.01015822310000658, -0.03120500035583973, 0.02665039710700512, 0.013285362161695957, -0.011911015026271343, 0.003137098392471671, 0.03298434987664223, -0.004133002366870642, 0.03840206563472748, -0.04073912277817726, 0.018417589366436005, 0.019015131518244743, 0.0206882506608963, -0.01248863898217678, -1.4666245988337323e-05, -0.012960033491253853, 0.050751280039548874, -0.032240740954875946, 0.013444706797599792, -0.036914851516485214, 0.007568872068077326, 0.011008061468601227, -0.004206035751849413, 0.024804655462503433, 0.04299650713801384, 0.021418580785393715, -0.0014656390994787216, -0.025495149195194244, 0.027327612042427063, -0.007714938372373581, 0.007017805241048336, 0.054814569652080536, 0.0024831213522702456, -0.006991247646510601, -0.028549255803227425, 0.003986936528235674, -0.04947652295231819, 0.011950850486755371, 0.02916007675230503, -0.022109074518084526, -0.029691224917769432, 0.05715162307024002, 0.011187324300408363, -0.024379735812544823, 0.018749557435512543, -0.016492174938321114, -0.042173225432634354, 0.019533002749085426, 0.03173614665865898, -2.8269156246096827e-05, -0.028602369129657745, 0.00844526756554842, 0.018404310569167137, 0.012847164645791054, 0.012621426023542881, -0.027858762070536613, 0.011618882417678833, -0.008611251600086689, -0.05051226168870926, 0.013610690832138062, -0.03271877393126488, 0.026902692392468452, 0.004697348456829786, 0.03298434987664223, -0.021790385246276855, -0.0387207567691803, -0.010045354254543781, 0.0068385424092411995, 0.03829583898186684, -0.010543306358158588, 0.0008050226024352014, 0.011771587654948235, -9.077251888811588e-05, 0.023144815117120743, -0.008744039572775364, -0.03067385032773018, -0.004521405324339867, -0.018205128610134125, 0.0014897068031132221, 0.020011035725474358, -0.00605841726064682, 0.006114852149039507, 0.01289364043623209, -0.026344986632466316, -0.014819054864346981, -0.002328756032511592, -0.045280445367097855, 0.01618676446378231, 0.017076438292860985, -0.027221381664276123, 0.008770596235990524, 0.01209027785807848, 0.037445999681949615, 0.013557576574385166, 0.010788962244987488, 0.0005070812185294926, -0.008677645586431026, 0.03524173051118851, -0.020900709554553032, 0.03510894253849983, -0.03518861532211304, 0.0162929929792881, 0.0018258244963362813, 0.03903944790363312, -0.01533692516386509, -0.002053222618997097, -0.005444276612251997, 0.0038906659465283155, -0.025402197614312172, -0.0029727742075920105, 0.013252166099846363, 0.017023323103785515, -0.015164301730692387, -0.03548074886202812, -0.01141970232129097, 0.008890105411410332, 0.006997887045145035, -0.03715386614203453, 0.01683742180466652, -0.01657184585928917, -0.01876283623278141, 0.016478896141052246, 0.005799482576549053, -0.00408984674140811, -0.0037645180709660053, 0.013371674343943596, 0.011286914348602295, 0.011778227053582668, 0.0057496870867908, 0.005872515495866537, -0.005381202790886164, 0.005872515495866537, -0.006619443651288748, 0.00900297425687313, -0.00863116979598999, -0.009062728844583035, 0.006377106998115778, -0.01662496104836464, 0.04937029257416725, -0.0071970680728554726, -0.004952963907271624, 0.02926630526781082, -0.0076485443860292435, -0.018722999840974808, -0.0016830781241878867, 0.007688380777835846, -0.017302175983786583, -0.007582150865346193, -0.0007099967333488166, -0.005235136486589909, 0.01423479150980711, 0.0039968956261873245, 0.017023323103785515, 0.0004904828383587301, 0.03688829392194748, 0.03131122887134552, 0.004547962918877602, -0.01436757855117321, -0.017222503200173378, -0.037392884492874146, 0.007389609236270189, -0.0009726664866320789, 0.013544297777116299, 0.0011751670390367508, 0.013637248426675797, 0.002312157768756151, -0.004494847729802132, -0.000998393981717527, 0.036755505949258804, 0.0025611338205635548, -0.019851692020893097, -0.006885018199682236, -0.008763957768678665, -0.01027109194546938, -0.014858891256153584, -0.0010921750217676163, -0.009348221123218536, -0.02257382869720459, 0.00855149794369936, -0.022480878978967667, -0.013438068330287933, 0.014248070307075977, 0.0014714484568685293, -0.03500271588563919, 0.05261030048131943, 0.01297331228852272, 0.021139727905392647, -0.029850570484995842, -0.0051919808611273766, -0.011107651516795158, -0.0019818495493382215, -0.003711403114721179, -0.010297649540007114, 0.022666780278086662, -0.008093382231891155, 0.021723991259932518, -0.020090708509087563, 0.020462512969970703, 0.039809610694646835, -0.03779124468564987, -0.022175468504428864, 0.018842509016394615, 0.020223494619131088, 0.00983953382819891, 0.03237352892756462, -0.017620865255594254, -0.021352186799049377, -0.03962371125817299, -0.018669884651899338, 0.008836990222334862, 0.002881482942029834, -0.0009378098184242845, 0.013577494770288467, -0.011525931768119335, 0.037605345249176025, 0.011120930314064026, 0.005075791850686073, -0.003781116334721446, -0.006858460605144501, 0.04830799624323845, -0.008345677517354488, 0.00695805111899972, 0.0023934899363666773, 0.0069779688492417336, -0.016558567062020302, -0.030514506623148918, -0.007821167819201946, 0.010131665505468845, 0.025933345779776573, -0.02347678318619728, -0.012641344219446182, 0.026172364130616188, -0.023901700973510742, -0.03893321752548218, -0.00960051640868187, 0.01410200446844101, -0.014433972537517548, -0.005221857689321041, 0.007290019188076258, -0.007509117946028709, -0.030408276244997978, 0.005650096572935581, 0.0015328626614063978, 0.031231556087732315, 0.0449352003633976, -0.03609156981110573, 0.03595878183841705, -0.00940797571092844, -0.0013950958382338285, 0.004664151463657618, -0.007708298973739147, -0.0027038799598813057, 0.007323215715587139, -0.027088595554232597, 0.013351756148040295, -0.01442069374024868, 0.010622978210449219, -0.00894985906779766, 0.006184565369039774, -0.040022071450948715, 0.004295667167752981, 0.008246087469160557, 0.016638239845633507, 0.025760723277926445, -0.003449148265644908, -0.011758309789001942, 0.010125026106834412, -0.013577494770288467, -0.01345798559486866, 0.010636257007718086, 0.01093502901494503, -0.009414615109562874, -0.01460659597069025, -0.0011062836274504662, -0.008159775286912918, 0.018430868163704872, 0.021949728950858116, 0.045811593532562256, -0.028974173590540886, -0.0035719764418900013, 0.02384858764708042, -0.020462512969970703, -0.011041258461773396, -0.03290467709302902, 0.0030059709679335356, 0.01404888927936554, 0.0036483292933553457, -0.00447492953389883, -0.004504806827753782, 0.032240740954875946, 0.025601377710700035, -0.006997887045145035, -0.005411079619079828, 0.013849708251655102, 0.01131347194314003, 0.01805906370282173, -0.026411380618810654, -0.028336795046925545, -0.008531579747796059, -0.030009914189577103, 0.01694365032017231, -0.000751907704398036, 0.017288897186517715, 0.00972666498273611, -0.0204226765781641, 6.286645657382905e-05, -0.021777106449007988, -0.002469842555001378, -0.03752567246556282, 0.0040666088461875916, 0.040287647396326065, 0.0015411617932841182, 0.002898081438615918, -0.036436814814805984, -0.04267781600356102, -0.025056950747966766, -0.022879239171743393, 0.018032506108283997, 0.009275187738239765, 0.02777908928692341, -0.03548074886202812, 0.01276085339486599, -0.020953824743628502, -0.004295667167752981, 0.013690363615751266, -0.013557576574385166, 0.03184237703680992, -0.020980382338166237]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
". To draw connections with previous
work, we also consider minimizing the square of the log weights, which at optimality, ensures that logw= 0andw= 1are
equal to a particular constant. We will proceed to parameterize the twist functions using parameters θand consider loss
24
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
terms which minimize the variance or square of c-step log weights at time t,
L(t,c)
logVar(θ):=Varπst+c−1X
τ=tlogwτ(s1:τ)
L(t,c)
logCons(θ):=Eπst+c−1X
τ=tlogwτ(s1:τ)2
. (47)
L(t,c)
logCons(θ)indicates ‘consistency’ in log-weight space for c-step-ahead weights at time t(see Eq. ( c-Step SMC Weights)).
We will consider various choices of parameterization and proposal in the following subsections. For example, let
L(t,c)
logCons(θ;{ψt, qπ
t})denote the log-consistency loss corresponding to twisting targets parameterized by ψθ
tand the
twist induced proposal qπ
t(note, our notation for the one-step weights wt(s1:t)does not make these choices explicit).
For reference, we derive the log importance weights with intermediate potentials and arbitrary qas
logwt(s1:t) = log˜πt(s1:t)
˜πt−1(s1:t−1)q(st|s1:t−1)= logp0(s1:t)t−1Q
τ=1ϕτ(s1:τ)
ψt(s1:t)
p0(s1:t−1)t−2Q
τ=1ϕτ(s1:τ)
ψt−1(s1:t−1)q(st|s1:t−1)
=⇒ logwt(s1:t) = log ϕt−1(s1:t−1) + log ψt(s1:t)−logψt−1(s1:t−1)−logq(st|s1:t−1)
p0(st|s1:t−1)(48)
Various special cases arise from choices of twist parameterizations and proposals in the following subsections.
C.1.1. S OFT Q-L EARNING AND RL B ASELINE
For single-step log-weights, the ψ-parameterization of the targets (Eq. (Twist Targets ( ψ) ), Eq. (Twist Targets (Soft RL Q)
)), and the twist-induced proposal (Eq. (Twist-Induced Proposal ( ψ) ), Eq. (Twist-Induced Proposal (soft RL))), we have
logwt(s1:t) =logϕt−1(s1:t−1) + log ψt(s1:t)−logψt−1(s1:t−1)−

logp0(st|s1:t−1)
p0(st|s1:t−1)+ log ψt(s1:t)−logX
stp0(st|s1:t−1)ψt(s1:t)
= log ϕt−1(s1:t−1) + logX
stp0(st|s1:t−1)ψt(s1:t)−logψt−1(s1:t−1) (49)
where the second term logZπ
t(s1:t−1) = logP
stp0(st|s1:t−1)ψt(s1:t)normalizes the twist-induced proposal (Eq. (14)).
Minimizing the sum of one-step log consistency losses (i.e. squared log weights in Eq. (48)) will yield the familiar soft
Q-learning loss (e.g. Lioutas et al. (2022) Eq. (4)-(5)). Adjusting indexing from Eq. (48) and introducing a stop-gradient
within logZπ
t(s1:t−1), we have
min
θLSOFT Q(θ):= min
θTX
t=1L(t+1,1)
logCons(θ;{ψt, qπ
t}) (Soft Q Learning)
= min
θTX
t=1Eπs(·)h
logϕt(s1:t) + logX
st+1p0(st+1|s1:t)sg 
ψθ
t+1(s1:t+","[0.004345521796494722, -0.0030480290297418833, -0.005377968307584524, -0.02904411219060421, -0.016506819054484367, -0.0002742917858995497, 0.02477871999144554, 0.001929288380779326, -0.018577875569462776, 0.028871523216366768, 0.019317539408802986, 0.01589043252170086, -0.03123844601213932, 0.012518800795078278, 0.029315320774912834, 0.009862177073955536, 0.055474746972322464, 0.006422742735594511, -0.054094042629003525, 0.025690970942378044, -0.021400924772024155, -0.035232625901699066, -0.004669124260544777, 0.03816662356257439, 0.01016420591622591, -0.012845485471189022, 0.06015928089618683, -0.018676497042179108, 0.024458199739456177, 0.004098967183381319, 0.08047536760568619, -0.022115932777523994, -0.025086913257837296, -0.03483814001083374, -0.006971326190978289, 0.03604625537991524, 0.009720408357679844, 0.033802613615989685, 0.004576666746288538, 0.023434998467564583, 0.01881210319697857, -0.05226953700184822, -0.03052343800663948, 0.02321309968829155, 0.02323775552213192, 0.033605366945266724, 0.011643532663583755, 0.03254518285393715, -0.020069530233740807, 0.021314630284905434, -0.02832910418510437, 0.03579970449209213, 0.007914396934211254, -0.0009546279325149953, 0.0032391087152063847, 0.002787606092169881, 0.028649624437093735, 0.00509443087503314, 0.022251537069678307, 0.00019233171769883484, 0.018565548583865166, -0.004542765207588673, 0.02029142901301384, 0.011920906603336334, 0.004095885436981916, -0.02184472233057022, -0.06223033741116524, 0.03397519886493683, -0.012081166729331017, 0.03853645548224449, -0.004234572406858206, 0.02024211920797825, 0.04413324221968651, 0.018540892750024796, 0.008647896349430084, 0.02101876400411129, 0.010034765116870403, 0.06829557567834854, 0.0378214493393898, -0.025210190564393997, -0.008370522409677505, -0.01667940616607666, 0.009627950377762318, -0.03407382220029831, 0.01448507234454155, -0.06025790050625801, -0.05167780816555023, -0.023940434679389, -0.04001578316092491, -0.016149314120411873, 0.0007743349997326732, -0.007932888343930244, 0.01607534848153591, -0.0028107203543186188, 0.04706723988056183, 0.006804902106523514, 0.03917749971151352, 0.019995564594864845, 0.016124660149216652, -0.007519910112023354, 0.03355605900287628, -0.014830248430371284, 0.03535590320825577, -0.0050081368535757065, 0.027318229898810387, 0.01735743135213852, 0.01665475219488144, -0.03493676334619522, -0.039596639573574066, 0.0008822025265544653, -0.018491581082344055, -0.010577185079455376, -0.0284277256578207, 0.03703247383236885, 0.024470526725053787, -0.0693311020731926, -0.05064227804541588, -0.008253409527242184, -0.009171824902296066, -0.00984984915703535, -0.010268991813063622, -0.010725117288529873, -0.00487561384215951, 0.015804138034582138, 0.013979636132717133, 0.0065706754103302956, -0.00252564181573689, -0.04640154168009758, -0.002895473502576351, 0.025838904082775116, 0.016247937455773354, 0.0378214493393898, 0.011772973462939262, -0.0010794460540637374, 0.0041297865100204945, -0.014337140135467052, 0.008610913529992104, 0.040385615080595016, 0.017049238085746765, 0.0022035802248865366, 0.0066446419805288315, -0.005393377970904112, -0.05512956902384758, 0.0014092125929892063, -0.003476417390629649, 0.012229099869728088, -0.007889742031693459, 0.02906876616179943, -0.0231514610350132, 0.01963805966079235, -0.008555438369512558, -0.05389679595828056, -0.03335881233215332, 0.01229073852300644, 0.0023206935729831457, -0.04282650351524353, 0.0012189034605398774, 0.05453784018754959, 0.01586577668786049, -0.017308121547102928, 0.019391505047678947, 0.023089822381734848, 0.007741808891296387, 0.0047954837791621685, 0.0437634103000164, 0.020648933947086334, -0.026603221893310547, 0.021610494703054428, -0.06070169806480408, -0.04070613533258438, 0.027959272265434265, -0.05655958503484726, -0.03688454255461693, -0.06459725648164749, 0.008506127633154392, -0.03759954869747162, -0.02684977650642395, -0.09729037433862686, -0.009141005575656891, 0.011175079271197319, -0.020106513053178787, 0.01743139699101448, -0.013585149310529232, 0.002188170561566949, -0.024137677624821663, 0.04265391454100609, 0.007088439539074898, 0.009689589031040668, 0.030942579731345177, -0.004906433168798685, 0.00980670191347599, 0.056263718754053116, 0.06139205023646355, -0.007236372213810682, -0.0404842384159565, -0.008512291125953197, 0.03764886036515236, 0.0621810257434845, 0.019983235746622086, -0.0010362990433350205, -0.015754828229546547, 0.02823048084974289, -0.009387560188770294, -0.051875051110982895, -0.014596021734178066, -0.0017921425169333816, -0.017665624618530273, -0.012580439448356628, -0.07214182615280151, -0.009184152819216251, 0.0039171334356069565, -0.0046876161359250546, 0.051135387271642685, -0.009338248521089554, -0.03259449452161789, 0.03821593523025513, -0.030819302424788475, -0.019157279282808304, -0.016210952773690224, 0.05241747200489044, -0.007378141395747662, 0.021931016817688942, 0.02532113902270794, 0.02037772350013256, -0.07071180641651154, -0.000992381596006453, 0.05005054920911789, -0.04179097339510918, 0.055573366582393646, -0.01607534848153591, 0.04184028506278992, -0.001510145841166377, -0.020722899585962296, 0.017221827059984207, 0.01272220816463232, -0.050543658435344696, -0.02823048084974289, -0.00691585149616003, -0.02551838383078575, -0.06859143823385239, 0.00975122768431902, 0.0038215937092900276, 0.005861831363290548, -0.03979388251900673, 0.009671097621321678, 0.024174662306904793, -0.027786683291196823, -0.003494909033179283, 0.011957889422774315, -0.02239947021007538, 0.003858576761558652, 0.0041790977120399475, 0.021191352978348732, -0.0002519478148315102, -0.05665820837020874, 0.0029509481973946095, 0.028822211548686028, -0.004132868722081184, -0.02820582687854767, 0.00280455662868917, 0.04778224602341652, -0.05310782417654991, -0.004619813524186611, 0.03052343800663948, -0.01819571666419506, -0.03040016070008278, -0.0247294083237648, 0.016568457707762718, 0.02024211920797825, -0.0032483546528965235, -0.015089130960404873, 0.029216699302196503, -0.03215069696307182, 0.05384748801589012, 0.016925960779190063, -0.03799403831362724, 0.01965038850903511, 0.015163097530603409, -0.03634212166070938, 0.06730935722589493, -0.012783846817910671, -0.031509656459093094, 0.043911341577768326, 0.013881013728678226, -0.006965162698179483, -0.016408197581768036, -0.04977933689951897, 0.04551394656300545, -0.012296902015805244, -0.050543658435344696, 0.007741808891296387, -0.008746517822146416, 0.03432037681341171, 0.010232008993625641, -0.013856358826160431, 0.0345422737300396, -0.01750536449253559, -0.01125520933419466, 0.014423433691263199, 0.021376268938183784, 0.04267857223749161, -0.006324120797216892, -0.025567693635821342, 0.014226190745830536, 0.011341503821313381, 0.004773910157382488, 0.046869996935129166, -0.02529648318886757, -0.02022979035973549, 0.006367268040776253, -0.020069530233740807, 0.008925270289182663, 0.002366922562941909, 0.021400924772024155, -0.033136915415525436, -0.0172711368650198, 0.024791046977043152, 0.023693880066275597, 0.003538056043908, -0.025764938443899155, -0.019761336967349052, -0.037969380617141724, -0.0005501245614141226, -0.011088785715401173, 0.005948125384747982, -0.022239210084080696, -0.015360340476036072, -0.001523244078271091, -0.030104296281933784, -0.02180773951113224, 0.02744150720536709, -0.02456914819777012, 0.03271777182817459, -0.0042129987850785255, -0.04849725589156151, -0.06592865288257599, -0.050445035099983215, 0.05463645979762077, 0.0021465644240379333, 0.033062949776649475, -0.09517000615596771, 0.00253642862662673, -0.000254259241046384, -0.019280556589365005, -0.017986144870519638, 0.03409847617149353, 0.05384748801589012, 0.00792672485113144, 0.08200400322675705, 0.01822037249803543, -0.0004911826690658927, -0.02983308583498001, 0.03821593523025513, -0.017234154045581818, 0.021191352978348732, 0.01967504248023033, -0.03274242952466011, -0.03570108115673065, -0.038068003952503204, 0.01592741534113884, -0.014768609777092934, -0.0012435588287189603, 0.03407382220029831, -0.006613822653889656, 0.004231490194797516, 0.0036428417079150677, 0.06227964907884598, 0.011754482053220272, -0.00015505962073802948, -0.013190661557018757, 0.012734536081552505, -0.0069281794130802155, -0.035257283598184586, 0.0027644915971904993, -0.0521216057240963, 0.014053602702915668, -0.015163097530603409, 0.006564511451870203, 0.008709535002708435, -0.0014515891671180725, -0.014176879078149796, -0.012487981468439102, -0.01381937600672245, 0.011070293374359608, 0.004878695588558912, -0.007593876216560602, 0.009313593618571758, 0.013868686743080616, 0.00172434002161026, -0.021524202078580856, 0.01876279152929783, 0.005035873968154192, -0.03274242952466011, 0.03476417437195778, 0.022867923602461815, -0.003154355799779296, -0.00021650560665875673, 0.051184698939323425, 0.033827267587184906, 0.030843958258628845, -0.04265391454100609, -0.01087921392172575, -0.0753963440656662, -0.017234154045581818, -0.046007055789232254, -0.018639514222741127, 0.006848049350082874, 0.01951478235423565, 0.009652606211602688, 0.048842430114746094, 0.05651027336716652, -0.01806011237204075, 0.013129022903740406, -0.011335339397192001, 0.020636605098843575, -0.08476541191339493, 0.029931707307696342, 0.006502872798591852, 0.05537612363696098, 0.04593309015035629, -0.01528637483716011, -0.002465544268488884, 0.00974506326019764, -0.009529328905045986, -0.014263173565268517, 0.016087675467133522, 0.03178086504340172, -0.024347249418497086, 0.025814248248934746, -0.06627383083105087, 0.013141350820660591, 0.031558968126773834, 0.024088367819786072, -0.041864942759275436, -0.03113982453942299, 0.0008405965054407716, 0.012796174734830856, 0.02546907216310501, -0.013276956044137478, -0.07317735254764557, -0.019416160881519318, 0.01340023335069418, -0.013387905433773994, 0.004641387145966291, 0.0038462490774691105, 0.035084694623947144, -0.03607091307640076, -0.0182450283318758, 0.008013018406927586, -0.03471486270427704, -0.0036829067394137383, 0.01555758435279131, 0.08525852113962173, -0.016901306807994843, -0.0013807048089802265, -0.03202741965651512, 0.0743115022778511, -0.03269311785697937, 0.041643042117357254, -0.01591508835554123, 0.016297247260808945, -0.00947385374456644, -0.020562639459967613, -0.0066076586954295635, 0.03040016070008278, 0.02539510652422905, 0.07312804460525513, -0.02470475435256958, -0.015804138034582138, 0.024840358644723892, -0.007797283586114645, -0.01741907000541687, 0.016383541747927666, -0.025136223062872887, 0.0012967222137376666, 0.032273974269628525, 0.06656969338655472, -0.0224241241812706, 0.015705516561865807, -0.03570108115673065, 0.022954216226935387, 0.018331320956349373, 0.004847876261919737, -0.02980843000113964, 0.022917233407497406, 0.03422175347805023, 0.05567198991775513, -0.02236248552799225, -0.007421288173645735, 0.025173207744956017, 0.004505781922489405, -0.05143125355243683, 0.00025541498325765133, -0.01268522534519434, 0.031016547232866287, -0.025617005303502083, -0.008746517822146416, 0.006022091954946518, -0.01012722309678793, -0.04184028506278992, 0.05083952099084854, 0.013313938863575459, 0.030104296281933784, 0.06627383083105087, 0.019835304468870163, 0.04563722386956215, 0.0008544651791453362, 0.004699943587183952, -0.02026677317917347, 0.04913829639554024, 0.004098967183381319, 0.01734510436654091, -0.03935008496046066, 0.0027275083120912313, -0.010287483222782612, 0.03570108115673065, -0.03747627139091492, -0.012907124124467373, -0.005239281337708235, -0.01274686399847269, -0.019095640629529953, -0.022115932777523994, -0.023361030966043472, -0.035873670130968094, 0.012259919196367264, -0.011840776540338993, -0.012500309385359287, -0.10305975377559662, -0.03579970449209213, -0.03787076100707054, 0.00943070650100708, -0.02970980852842331, -0.005812520626932383, 0.006546020042151213, -0.04931088536977768, 0.033703990280628204, -0.045341357588768005, -0.024186989292502403, -0.02766340598464012, 0.013289283961057663, -0.010349121876060963, 0.0019508618861436844, 0.0029417024925351143, 0.006681624799966812, 0.010084075853228569, -0.017073893919587135, 0.022140586748719215, -0.02115437015891075, -0.0005797881167382002, 0.029364632442593575, 0.011976380832493305, -0.025666315108537674, -0.03755024075508118, -0.02682512067258358, -0.02463078685104847, -0.012518800795078278, -0.0017967653693631291, 0.020094186067581177, 0.01734510436654091, 0.05798960104584694, 0.0349121056497097, -0.017246482893824577, -0.005381050519645214, -0.004351685754954815, -0.022892577573657036, -0.011175079271197319, 0.029586531221866608, 0.006225499324500561, 0.017172515392303467, 0.01523706316947937, -0.06854213029146194, -0.0005686161457560956, 0.012759191915392876, -0.06474519520998001, -0.008561602793633938, -0.02185704931616783, 0.008801992982625961, -0.022300848737359047, -0.015816466882824898, -0.029216699302196503, -0.03348208963871002, -0.027244264259934425, 0.004881777800619602, -0.03042481653392315, -0.05374886468052864, 0.0031589786522090435, -0.01591508835554123, -0.005066693294793367, -0.021191352978348732, 0.01876279152929783, 0.03981854021549225, -0.016210952773690224, -0.030843958258628845, -0.016962943598628044, -0.045341357588768005, -0.0317562110722065, -0.02827979251742363, 0.007100767455995083, -0.022103603929281235, 0.04055820405483246, -0.0025872804690152407, 0.024482853710651398, 0.0289701446890831, -0.02392810769379139, -0.0420621857047081, 0.05808822438120842, -0.04615498706698418, 0.05438990518450737, 0.03826524689793587, 0.01952711120247841, 0.0068542128428816795, 0.0006945900386199355, 0.014164552092552185, -0.00371680804528296, -0.011433961801230907, -0.029635842889547348, 0.018417615443468094, 0.0006202384829521179, 0.06597796082496643, -0.034418996423482895, -0.006250154692679644, -0.013893341645598412, 0.029438598081469536, -0.017554674297571182, 0.0005266248481348157, 0.014374122954905033, -0.03404916450381279, -0.032200008630752563, 0.013511182740330696, 0.007914396934211254, -0.05956754833459854, 0.022707663476467133, 0.001769028021954, 0.011526419781148434, -0.00796370767056942, -0.026553912088274956, 0.002365381456911564, -0.0006368038593791425, 0.036539364606142044, -0.024889668449759483, 0.005371804349124432, 0.027909960597753525, -0.02680046670138836, -0.03037550486624241, 0.04741241782903671, 0.006234745029360056, -0.043837375938892365, 0.02180773951113224, -0.029635842889547348, -0.005618358962237835, -0.007421288173645735, -0.013696098700165749, 0.051184698939323425, -0.012118150480091572, 0.03853645548224449, -0.02768806181848049, 0.0024624622892588377, 0.004662960767745972, 0.025690970942378044, -0.05069158971309662, -0.038758356124162674, -0.031460344791412354, 0.015434307046234608, -0.006398087367415428, 0.011168915778398514, 0.0437634103000164, -0.013622132129967213, 0.02914273366332054, -0.010121059603989124, -0.027342885732650757, -0.04287581518292427, 0.057792358100414276, 0.022978872060775757, -0.017234154045581818, -0.01883675903081894, 0.009486181661486626, 0.003599694697186351, -0.048916399478912354, -0.010558693669736385, 0.035849012434482574, -0.02182006649672985, -0.02476639300584793, -0.01600138284265995, -0.003957198467105627, -0.02529648318886757, 0.0046167317777872086, 0.040262337774038315, -0.0025703299324959517, -0.009954635053873062, -0.006632314063608646, -0.0055875396355986595, 0.0022097439505159855, 0.014337140135467052, -0.05217091739177704, 0.0066076586954295635, -0.005877241026610136, -0.03284104913473129, 0.040336303412914276, -0.0023391852155327797, -0.02098178118467331, 0.005504327360540628, 0.03249587491154671, -0.024125350639224052, 0.0013421806506812572, -0.03843783587217331, -0.020118841901421547, -0.022609040141105652, 0.046056367456912994, 0.04519342631101608, -0.0029339976608753204, -0.014361795037984848, 0.017024582251906395, -0.025271829217672348, -0.014941197820007801, -0.03264380618929863, 0.049015019088983536, 0.009301265701651573, -0.0010162665275856853, -0.008481471799314022, 0.02174610085785389, -0.017875196412205696, -0.00431778421625495, -0.06094825267791748, -0.012500309385359287, -0.00021072698291391134, -0.0064165787771344185, -0.05434059724211693, 0.007932888343930244, 0.01666707918047905, 0.01161887776106596, -0.005698489025235176, 0.007427452132105827, -0.009381395764648914, 0.005313247907906771, -0.011175079271197319, 0.033013638108968735, -0.0018661088543012738, 0.01753002032637596, -0.01753002032637596, -0.013129022903740406, 0.011101112700998783, -0.012481817975640297, -0.0406075157225132, 0.0276387520134449, 0.06178653985261917, 0.038881633430719376, 0.027318229898810387, 0.04519342631101608, 0.022054294124245644, -0.005599867552518845, 0.003396287327632308, 0.008814320899546146, -0.02539510652422905, 0.0031497327145189047, 0.0034610077273100615, -0.0018691907171159983, -0.0016719471896067262, -0.0035164824221283197, -0.008438325487077236, -0.008561602793633938, -0.009510836564004421, -0.01814640499651432, 0.0055875396355986595, 0.004450307227671146, -0.024963635951280594, 0.009757391177117825, -0.023558275774121284, 0.0003326558507978916, 0.014300156384706497, -0.002297579078003764, -0.0022451861295849085, 0.008333539590239525, 0.006687788758426905, 0.03861042484641075, 0.020192807540297508, -0.005590621381998062, -0.00451810983940959, -0.025160878896713257, -0.0004603633424267173, -0.03259449452161789, 0.022029638290405273, 0.0189107246696949, 0.0035041547380387783, -0.056165099143981934, 0.004105131141841412, -0.022978872060775757, -0.010805247351527214, -0.016284920275211334, 0.007778792176395655, -0.01268522534519434, -0.030030328780412674, -0.00290471944026649, -0.0018368305172771215, -0.007113095372915268, 0.035109348595142365, 0.0321260429918766, -0.021931016817688942, -0.09230997413396835, -0.03937474265694618, 0.01738208718597889, -0.005399541929364204, 0.011890087276697159, -0.01683966815471649, 0.0002157351264031604, -0.00560603104531765, 0.011020982638001442, -0.017727263271808624, -0.005975862964987755, -0.022300848737359047, 0.011538746766746044, 0.029290664941072464, 0.02464311569929123, -0.06444932520389557, 0.00580943888053298, -0.000804383831564337, 0.0024809539318084717, -0.0101518789306283, -0.02682512067258358, 0.021289974451065063, 0.013609804213047028, 0.04842329025268555, -0.03789541497826576, -0.012087331153452396, 0.018614858388900757, 0.019243573769927025, 0.009091694839298725, 0.012315393425524235, -0.014682316221296787, -0.03328484669327736, 0.031016547232866287, 0.016408197581768036, -0.029635842889547348, 0.00208184402436018, 0.009461525827646255, -0.014361795037984848, -0.006903524044901133, 0.014891887083649635, -0.006052911281585693, -0.050395723432302475, 0.0669148713350296, 0.03247121721506119, -0.00023268573568202555, -0.01274686399847269, 0.027712717652320862, -0.03942405432462692, 0.0019354522228240967, -0.02603614702820778, 0.021314630284905434, 0.016334230080246925, 0.008549274876713753, -0.035922978073358536, -0.025937525555491447, 0.01484257634729147, 0.0023361032363027334, -0.02687443234026432, -0.0010925442911684513, 0.009023891761898994, -0.03572573512792587, 0.025641661137342453, 0.028082549571990967, -0.011187407188117504, -0.03789541497826576, -0.023607585579156876, -0.011625041253864765, 0.003457925748080015, -0.006958998739719391, -0.013597476296126842, 0.01603836566209793, -0.015606895089149475, -0.006391923408955336, 0.0037291357293725014, 0.007747972849756479, -0.021585840731859207, -0.021302303299307823, -0.004555093124508858, -0.010910033248364925, 0.01304272934794426, 0.042456671595573425, -0.03390123322606087, 0.03730368614196777, 0.031558968126773834, -0.026553912088274956, 0.02252274751663208, -0.007113095372915268, 0.007637023460119963, -0.04997658357024193, 0.021425578743219376, 0.029611187055706978, 0.005066693294793367, 0.024926653131842613, -0.03767351806163788, 0.017751919105648994, -0.013030401431024075, -0.012981090694665909, 0.01127986516803503, 0.02968515269458294, 0.01735743135213852, 0.005085185170173645, 0.046845339238643646, 0.004216080531477928, -0.0026520011015236378, 0.013239972293376923, 0.020032547414302826, 0.00901156384497881, 0.0510367676615715, 0.014854904264211655, -0.02672649919986725, 0.00487561384215951, -0.022818611934781075, -0.049631405621767044, 0.024901997298002243, 0.00800685491412878, -0.007298010867089033, 0.044626351445913315, 0.02402672916650772, 0.03816662356257439, 0.007575384806841612, 0.02468009851872921, 0.03350674733519554, 5.6678625696804374e-05, 0.004061984363943338, -0.02326240949332714, -0.029487909749150276, 0.014115240424871445, -0.00780961150303483, 0.0060991402715444565, 0.0007454418810084462, 0.002519478090107441, -0.0034979910124093294, 0.0030665206722915173, 0.008586257696151733, -0.012907124124467373, 0.05581992119550705, 0.024113023653626442, 0.00979437492787838, -0.033605366945266724, 0.022670678794384003, 0.008352030999958515, 0.009652606211602688, 0.002439347794279456, 0.029561875388026237, 0.017949162051081657, -0.00045111755025573075, 0.0020957125816494226, -0.028698936104774475, -0.003513400675728917, -0.002608854090794921, 0.03385192155838013, -0.025160878896713257, -0.012894796207547188, 0.0021419415716081858, -0.01603836566209793, 0.023015854880213737, 0.0018553220434114337, -0.014534383080899715, -0.035996947437524796, 0.006105303764343262, -0.003966444171965122, 0.03774748370051384, 0.022128259763121605, 0.014435761608183384, 0.004863285925239325, 0.008074657060205936, -0.009886832907795906, -0.006638478022068739, 0.015446634963154793, 0.011649697087705135, -0.013289283961057663, -0.03057274967432022, 0.023780174553394318, 0.038141969591379166, 0.006271728314459324, 0.02744150720536709, -0.008672552183270454, 0.011033310554921627, -0.0007311879890039563, 0.010232008993625641, 0.016802683472633362, 0.014657660387456417, -0.049113642424345016, 0.003439434338361025, 0.035281937569379807, -0.008851303718984127, -0.006601494736969471, -0.007113095372915268, 0.012438670732080936, 0.037328340113162994, -0.0012674438767135143, -0.00039988046046346426, -0.011544911190867424, 0.02835375815629959, 0.019132623448967934, 0.02684977650642395, -0.01274686399847269, 0.01738208718597889, -0.002927833702415228, -0.035183317959308624, -0.03616953268647194, 0.014028946869075298, -0.016925960779190063, -0.015458962880074978, -0.009911487810313702, -1.4879944501444697e-05, -0.04625361040234566, -0.004610567819327116, 0.010799083858728409, -0.027712717652320862, 0.016864322125911713, -0.003750709118321538, -0.028772901743650436, 0.03412313386797905, -0.03991715982556343, -0.008857468143105507, 0.029192043468356133, -0.026652533560991287, -0.04216080531477928, -0.03192879632115364, -0.03789541497826576, -0.020550310611724854, 0.02754012867808342, 0.00030222180066630244, -0.018540892750024796, -0.009258118458092213, 0.0240637119859457, -0.002109581371769309, -0.015163097530603409, 0.001009332132525742, -0.015101458877325058, 0.013942652381956577, -0.021598167717456818, 0.0021311547607183456, -0.006077566649764776, -0.00944919791072607, -0.0019323703600093722, -0.026430634781718254, 0.00033284848905168474, 0.014780937694013119, 0.012253754772245884, 0.01655612885951996, 0.0016950616845861077, 0.004240735899657011, -0.0044287340715527534, -0.003177470061928034, 0.02684977650642395, 0.024519838392734528, -0.04435514286160469, -0.010700462386012077, -0.02395276166498661, 0.016358885914087296, 0.03641608729958534, -0.032200008630752563, 0.009664933197200298, -0.008980744518339634, 0.011440125294029713, 0.059814102947711945, 0.0521216057240963, 0.016876650974154472, -0.009843685664236546, 0.010447743348777294, -0.006656969431787729, -0.009566311724483967, -0.0018799775280058384, -0.014583694748580456, 0.005337903276085854, 0.014275501482188702, -0.020907815545797348, -0.0078034475445747375, -0.032224662601947784, -0.015212408266961575, 0.013881013728678226, 0.007593876216560602, -0.0019955497700721025, -0.009196479804813862, 0.01744372583925724, -0.002251350088045001, 0.012531128711998463, 0.015138441696763039, -0.03143569082021713, -0.025173207744956017, -0.028107205405831337, -0.014411105774343014, 0.03851180151104927, 0.004231490194797516, 0.020192807540297508, -0.0007974494947120547, 0.009332085028290749, 0.037377651780843735, 0.014669988304376602, 0.017061566933989525, -0.025789592415094376, -0.011230554431676865, 0.005507409572601318, -0.01882443018257618, -0.003313075052574277, 0.011477108113467693, -0.002188170561566949, 0.007378141395747662, 0.01340023335069418, 0.022325502708554268, -0.012001036666333675, 0.0033531400840729475, -0.015705516561865807, 0.004906433168798685, -0.0029956363141536713, 0.021647479385137558, -0.01163736917078495, -0.025666315108537674, -0.01823269948363304, 0.01484257634729147, -0.008974581025540829, 0.047511037439107895, 0.019218917936086655, -0.0028692770283669233, -0.004564338829368353, -0.016371214762330055, 0.014398778788745403, 0.02243645302951336, -0.0031112085562199354, -0.006253236439079046, 0.011033310554921627, -0.012605095282196999, -0.007495254743844271, -0.023496637120842934, -0.005134495906531811, -0.014004291035234928, -0.0010979376966133714, 0.022806284949183464, -0.0028276711236685514, 0.00868488010019064, 0.006576839368790388, -0.026603221893310547, 0.00017528478929307312, -0.002544133458286524, 0.004098967183381319, -0.009535492397844791, -0.05463645979762077, -0.027367541566491127, 0.020661260932683945, 0.001255116076208651, -0.006983654107898474, -0.004102049395442009, 0.010410760529339314, 0.017012255266308784, -0.012611258774995804, 0.014645332470536232, -0.007858922705054283, -0.0182450283318758, 0.06592865288257599, -0.00687886867672205, -0.011353831738233566, 0.00011605393956415355, 0.003242190694436431, 0.024273283779621124, -0.018553219735622406, -0.023484308272600174, -0.047437071800231934, -0.008413669653236866, -0.03579970449209213, 0.045489292591810226, -0.045439980924129486, 0.005569048225879669, 0.030301539227366447, -0.00020803029474336654, -0.02029142901301384, 0.029216699302196503, -0.009227299131453037, 0.012506472878158092, 0.0028877686709165573, -0.013597476296126842, -0.04415789619088173, -0.007125422824174166, -0.017998473718762398, 0.009042383171617985, -0.02618408016860485, 0.060603078454732895, -0.010571020655333996, 0.019107967615127563, -0.0012928697979077697, -0.006210089661180973, -0.06523830443620682, -0.01486723218113184, -0.0029447844717651606, -0.00560911325737834, -0.04590843245387077, 0.013116695918142796, -0.019773665815591812, 0.004968071822077036, -0.010096403770148754, 0.018417615443468094, -0.0031867159996181726, -0.008265737444162369, 5.610076186712831e-05, 0.01813407801091671, -0.019859958440065384, 0.012494145892560482, 0.006065238732844591, 0.009492345154285431, -0.014583694748580456, -0.015508273616433144, 0.0160630214959383, -0.01899701915681362, 0.004259227775037289, 0.00949850957840681, -0.008795829489827156, 0.0238171573728323, 0.019046328961849213, 0.005402623675763607, -0.012845485471189022, 0.012833157554268837, -0.019773665815591812, 0.024260954931378365, 0.03131241351366043, -0.016938289627432823, 0.0035935307387262583, 0.051135387271642685, -0.008900614455342293, 0.024445870891213417, -0.0275154747068882, -0.004743090830743313, 0.008863631635904312, 0.01818338967859745, -0.003331566695123911, 0.004490372259169817, -0.02259671315550804, 0.04082941263914108, -0.026603221893310547, 0.029882395640015602, -0.035996947437524796, 0.04257994890213013, 0.005926552228629589, 0.01597672700881958, 0.02820582687854767, 0.02466776967048645, 0.019366851076483727, 0.006299465429037809, -0.015434307046234608, -0.0056214407086372375, -0.012580439448356628, 0.004813975188881159, 0.03848714753985405, 0.005692325532436371, -0.011489436030387878, -0.02973446436226368, 0.022337831556797028, -0.0437634103000164, -0.012185952626168728, 0.028624968603253365, 0.002806097501888871, -0.028822211548686028, 0.06227964907884598, 0.017160188406705856, -0.01373308151960373, 0.010490890592336655, -0.01888606883585453, -0.040286991745233536, 0.011846940033137798, 0.022830938920378685, 0.004940334241837263, -0.022054294124245644, 0.01156956609338522, 0.0061669424176216125, 0.022904906421899796, 0.015841122716665268, -0.025025274604558945, 0.027737373486161232, 0.0016734881792217493, -0.05217091739177704, 0.019810648635029793, -0.03767351806163788, 0.02251041866838932, -0.011649697087705135, 0.02465544268488884, 0.019428487867116928, -0.01457136683166027, 0.004912597127258778, -0.023373359814286232, 0.02916738949716091, -0.004807811230421066, 0.012142805382609367, 0.004444143734872341, 0.0017828966956585646, 0.011871595866978168, 0.0026874432805925608, -0.009701916947960854, -0.004860204178839922, -0.033728644251823425, -0.007039128802716732, 0.020747555419802666, -0.0003151273704133928, 0.011372323147952557, 0.01090386975556612, -0.017036911100149155, -0.010965508408844471, 0.009492345154285431, -0.02835375815629959, 0.012487981468439102, -0.007267191540449858, 0.002376168267801404, -0.008592422120273113, -0.0019940088968724012, 0.039571985602378845, 0.032175350934267044, -0.003670579055324197, 0.00975122768431902, -0.022374814376235008, 0.03996647149324417, -0.004672206472605467, 0.03180552273988724, -0.029981018975377083, 0.018405288457870483, 0.0376981720328331, 0.03118913434445858, 0.03037550486624241, -0.006619986146688461, -0.020784538239240646, 0.006848049350082874, -0.028107205405831337, 0.0025148552376776934, 0.015705516561865807, 0.019909270107746124, -0.014596021734178066, -0.01745605282485485, -0.010490890592336655, -0.0036305140238255262, -0.012968762777745724, -0.02312680520117283, -0.003812347771599889, -0.016408197581768036, -0.0032822557259351015, 0.011896250769495964, -0.008610913529992104, 0.013264628127217293, -0.021536529064178467, 0.00871569849550724, 0.008900614455342293, 0.00758771225810051, 0.006650805473327637, 0.007581548765301704, -0.00943687092512846, 0.020673587918281555, -0.025962181389331818, 0.014201534911990166, 0.024914324283599854, -0.015138441696763039, 0.0004911826690658927, -0.006037501618266106, 0.042481329292058945, 0.019859958440065384, 0.014423433691263199, 0.018294338136911392, 0.0019585667178034782, 0.002981767524033785, -0.0004183720448054373, 0.023398015648126602, 0.01230306550860405, 0.011920906603336334, 0.0137577373534441, 0.017591658979654312, -0.010416924953460693, 0.004980399273335934, 0.043960653245449066, 0.009325921535491943, 0.021252991631627083, 0.008216426707804203, -0.021622823551297188, -0.0033623860217630863, -0.012457162141799927, -0.014583694748580456, -0.0012004118179902434, -0.008666387759149075, 0.021992655470967293, -0.017690280452370644, -0.006478217430412769, -0.014041274785995483, 0.0007442861679010093, 0.01304272934794426, 0.007002145517617464, 0.007772628217935562, -0.00832121167331934, -0.0016519146738573909, -0.0187874473631382, -0.01088537834584713, -0.005713898688554764, -0.010472399182617664, -0.0232747383415699, -0.034517619758844376, 0.017073893919587135, -0.03937474265694618, -0.010090240277349949, 0.007100767455995083, 0.011045638471841812, -0.035824358463287354, 0.0738183930516243, 0.021339286118745804, 0.02180773951113224, -0.03126310184597969, -0.005131414160132408, 0.014078257605433464, -0.004721517208963633, -0.006835721433162689, -0.02039005048573017, 0.022867923602461815, -0.011470944620668888, 0.02177075669169426, -0.014583694748580456, 0.017567003145813942, 0.03848714753985405, -0.009523164480924606, 0.017086220905184746, 0.019859958440065384, 0.0054118698462843895, -0.0030156688299030066, 0.02756478451192379, -0.007760300766676664, -0.009517000988125801, -0.03192879632115364, -0.03496141731739044, -0.00252564181573689, -0.002420856384560466, 0.015002836473286152, 0.00019599150982685387, -0.006767918821424246, 0.034566931426525116, 0.018454598262906075, 0.024421215057373047, -0.00795138068497181, -0.02025444619357586, 0.047461725771427155, -0.010977835394442081, 0.007415124215185642, -0.0071870614774525166, -0.004437979776412249, -0.011366158723831177, -0.026652533560991287, 0.004511945880949497, 0.005929633975028992, 0.008691043592989445, -0.026430634781718254, -0.02611011452972889, 0.0276387520134449, -0.03907887637615204, -0.045218080282211304, -0.01561922300606966, 0.007100767455995083, -0.023496637120842934, 0.005803274922072887, 0.02471708133816719, -0.011249045841395855, -0.011470944620668888, 0.00027833683998323977, -0.0036859887186437845, 0.03279173746705055, 0.02615942433476448, -0.037451617419719696, 0.04805345833301544, 0.006903524044901133, 0.006546020042151213, 0.0031158316414803267, -0.0028523264918476343, 0.0019416160648688674, -0.006216253619641066, -0.025234846398234367, 0.017875196412205696, -0.004579748492687941, 0.013708425685763359, -0.020168151706457138, 0.021992655470967293, -0.03183017671108246, 0.00796370767056942, 0.019822975620627403, 0.03259449452161789, 0.013954980298876762, 0.007156242150813341, -0.00944919791072607, 0.008352030999958515, -0.02611011452972889, -0.0029000963550060987, 8.97612189874053e-05, -0.0023777091410011053, -0.004447225481271744, -0.015002836473286152, -0.007889742031693459, 0.01966271549463272, 0.00596353504806757, 0.026627877727150917, 0.037451617419719696, -0.024408888071775436, -0.00944919791072607, 0.015767155215144157, -0.04403461888432503, -0.008962253108620644, -0.026578567922115326, -0.012210607528686523, 0.01814640499651432, 0.01962573267519474, 0.00398185383528471, 0.01950245536863804, 0.033753301948308945, 0.028846867382526398, -0.013067384250462055, -0.013153678737580776, 0.021203679963946342, 0.023348703980445862, 0.016543801873922348, -0.007291847374290228, -0.04082941263914108, -0.0006102222250774503, -0.027145642787218094, 0.0016734881792217493, 0.015212408266961575, -0.002688984153792262, 0.020685916766524315, -0.04864518716931343, 0.01230922993272543, -0.030104296281933784, 0.0008613995159976184, -0.013202989473938942, 0.016149314120411873, 0.04447842016816139, 0.014559038914740086, 0.0034517620224505663, -0.016358885914087296, -0.0332108810544014, -0.0072240447625517845, -0.012315393425524235, 0.015693189576268196, 0.012635914608836174, 0.019761336967349052, -0.04223477467894554, 0.009683425538241863, -0.014004291035234928, 0.010250500403344631, -0.0008452194160781801, -0.012222935445606709, 0.029981018975377083, -0.01528637483716011]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"1)
−logψθ
t(s1:t)2i
(sRL)= min
θTX
t=1Eπs(·)h
βrt(s1:t) + logX
st+1p0(st+1|s1:t)eβsg 
Qθ
t(st+1,s1:t)
−βQθ
t(st,s1:t−1)2i
In the final line, we rewrite the loss for the soft RL special case, ϕt(s1:t) = eβrt(s1:t)using the substitutions in
Eq. (Twist to Soft RL). Note that the log-normalization term is analogous to an induced soft value VQθ
t(s1:t−1) =
1
βlogP
stp0(st|s1:t−1)eβQθ
t(st,s1:t−1), so that each squared error loss has the form E[β2(rt+Vt−Qt)2]. Hence, we refer
to this loss as Soft Q-learning loss.
Thelog-normalization term, which arises from normalizing the twist-induced proposal, is analogous to the ‘target’ value in
deepQ-learning. Lioutas et al. (2022) consider the soft-Q learning loss to SMC sampling in self-driving applications where
interaction with the environment is expensive. Lawson et al. (2018) adopt a similar loss function (using a parameterization
of the value Vθ
t) in the setting of state-space models with tractable intermediate rewards.
25
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
RL Baseline with no Intermediate Reward The soft Q-learning loss in Eq. (Soft Q Learning) simplifies nicely in the
case of no intermediate rewards, as in the main text ( ϕt(s1:t) = 1 fort < T andΦT= 1).
Written in terms of twist functions, we separate the terms at t < T andt=Tfor purposes of exposition
min
θLRL(θ):= min
θTX
t=1L(t+1,1)
logCons(θ;{ψt, qπ
t, ϕt= 1}) (RL Baseline)
= min
θT−1X
t=1Eπs(·)h
logX
st+1p0(st+1|s1:t)sg 
ψθ
t+1(s1:t+1)
−logψθ
t(s1:t)2i
+Eπs(·)h
logϕ(s1:T)−logψθ
T(s1:T)2i
For intermediate timesteps, note that Eq. (RL Baseline) enforces the recursion ψθ
t−1(s1:t−1) =P
stp0(st|s1:t−1)ψθ
t(s1:t)
in Eq. (13) of the main text, albeit in log space. In App. C.2 below, we consider the one-step squared error loss enforcing
this recursion directly (without logarithms), i.e. Eπs[(ψθ
t−1(s1:t−1)−P
stp0(st|s1:t−1)ψθ
t(s1:t))2],
C.1.2. P ATH CONSISTENCY LEARNING (FOR TWIST LEARNING )
Using the value parameterization of the targets ( ΦtorVt, see Eq. (Twist Targets ( Φ) ), Eq. (Twist Targets (Soft RL V) )), the
one-step log consistency loss with arbitrary proposal qrecovers the path-consistency loss (PCL) from Nachum et al. (2017).
Switching to a Φθ
tparameterization of the twisting targets, we substitute ψθ
t(s1:t) =ϕt(s1:t)Φθ
t(s1:t)into the log importance
weights in Eq. (48). The log-consistency loss becomes,
min
θLPCL(θ):= min
θTX
t=1L(t,1)
logCons(θ;{Φt,anyq}) (PCL)
= min
θTX
t=1Eπs""
logϕt(s1:t) + log Φθ
t(s1:t)−logΦθ
t−1(s1:t−1)−logq(st|s1:t−1)
p0(st|s1:t−1)2#
(sRL)= min
θTX
t","[0.0038921546656638384, -0.00047106199781410396, -0.0035119045060127974, -0.008155285380780697, 0.012656458653509617, 0.017955228686332703, 0.028565138578414917, 0.007765760645270348, -0.020638620480895042, 0.032917920500040054, 0.018969230353832245, 0.005221484694629908, -0.02809523604810238, 0.036776069551706314, 0.04310739040374756, 0.005199844483286142, 0.039521291851997375, 0.013231471180915833, -0.02236984111368656, 0.011889775283634663, -0.004785588011145592, -0.038482557982206345, -0.005991259589791298, 0.05371730029582977, 0.0073082237504422665, -0.03254694491624832, 0.04911720007658005, -0.012971787713468075, -0.00793888233602047, -0.0018904309254139662, 0.07701458036899567, -0.02292630635201931, -0.024311281740665436, -0.023692989721894264, -0.007005259860306978, 0.04807846620678902, -0.01049861591309309, 0.04886988177895546, -0.0032460384536534548, 0.024694623425602913, 0.005243124905973673, -0.055596910417079926, 0.001649296609684825, 0.03615777567028999, 0.02569625899195671, 0.027378015220165253, 0.011494067497551441, 0.03257167711853981, -0.002463897690176964, 0.021207451820373535, -0.04162348806858063, 0.03984280303120613, -0.016149813309311867, 0.0017466777935624123, 0.0006669836002402008, 0.00167248270008713, 0.046198856085538864, 0.0025350013747811317, 0.012835763394832611, -0.024892477318644524, 0.02161552384495735, 0.0011763024376705289, 0.007240211591124535, 0.003910703584551811, 0.013837398029863834, -0.018078887835144997, -0.0716230645775795, 0.02787264995276928, 0.0053667835891246796, 0.04565475881099701, -0.011228200979530811, -0.007345321122556925, 0.01884557120501995, -0.005725393537431955, -0.0007052404689602554, 0.02552313543856144, 0.048721492290496826, 0.08685780316591263, 0.03895246237516403, -0.044566560536623, 0.02398976869881153, -0.04525905102491379, 0.019352572038769722, -0.04006538912653923, 0.022134890779852867, -0.05129358917474747, -0.08141682296991348, -0.002051187213510275, -0.00912600476294756, -0.020749913528561592, 0.009861773811280727, -0.005320411641150713, -0.007518443278968334, -0.008625187911093235, 0.03477279841899872, -0.017794473096728325, 0.024533867835998535, 0.016397131606936455, 0.02141766995191574, -0.005691387224942446, 0.030469480901956558, -0.030098505318164825, 0.021578427404165268, -0.024509135633707047, 0.02113325521349907, 0.023359110578894615, 0.000481109251268208, 0.004847417585551739, -0.04417085275053978, -0.003984898794442415, -0.013590080663561821, -0.006745576858520508, -0.03274479880928993, 0.009181651286780834, 0.035885728895664215, -0.05836686119437218, -0.04335470870137215, -0.0403621681034565, -0.051540907472372055, -0.018585888668894768, -0.028886649757623672, -0.027501674368977547, 0.011444604024291039, -0.019129985943436623, 0.016545521095395088, 0.019970864057540894, 0.020032694563269615, -0.07389838248491287, -0.015024520456790924, 0.013318032026290894, 0.021652622148394585, 0.028664065524935722, -0.017720278352499008, -0.01764608360826969, -0.022691354155540466, -0.02225854992866516, 0.02214725688099861, 0.0140228858217597, -0.0005680567119270563, -0.012223653495311737, 0.011704287491738796, -0.01448042318224907, -0.04387407377362251, 0.0008632916142232716, 0.004389880690723658, 0.050057005137205124, 0.0061952960677444935, -0.010115274228155613, -0.018610620871186256, 0.014653544872999191, 0.004603191744536161, -0.025325283408164978, -0.05084841698408127, 0.02893611416220665, -0.0082603944465518, -0.04174714535474777, 0.005620283540338278, 0.06103788688778877, 0.03808685019612312, -0.02002032846212387, 0.024979038164019585, 0.02390320785343647, 0.012897592969238758, -0.006192204542458057, 0.055794764310121536, 0.012811031192541122, 0.0006522991461679339, 0.01940203458070755, -0.0789436548948288, -0.03435236215591431, 0.009194017387926579, -0.03042001649737358, -0.04483861103653908, -0.07053487002849579, -0.008798309601843357, -0.043428901582956314, -0.0059634363278746605, -0.07355213910341263, 0.017151448875665665, -0.006442613434046507, -0.012860494665801525, 0.004813411273062229, -0.01797996088862419, -0.004411520902067423, -0.012662641704082489, 0.04182134196162224, -0.008118187077343464, 0.0026988491881638765, 0.013899227604269981, 0.0038241425063461065, -0.00029368919786065817, 0.04926558956503868, 0.05431085824966431, -0.018907401710748672, -0.04281060770153999, -0.004813411273062229, 0.05426139757037163, 0.06450033187866211, 0.02292630635201931, 0.002244403585791588, -0.005923247430473566, 0.032917920500040054, -0.013293299823999405, -0.035069581121206284, -0.001104425871744752, -0.007524626329541206, -0.03410504385828972, -0.002635474083945155, -0.07553067803382874, -0.00912600476294756, 0.015407862141728401, 0.010201835073530674, 0.037369631230831146, 0.015420228242874146, -0.042934268712997437, 0.03900192305445671, -0.025597332045435905, -0.00912600476294756, -0.015803569927811623, 0.046446170657873154, 0.011939238756895065, -0.006770308595150709, 0.029752260074019432, 0.024793550372123718, -0.06979291886091232, -0.011537347920238972, 0.06267017871141434, -0.01671864278614521, 0.04328051209449768, -0.019476231187582016, 0.05782276391983032, 0.014950325712561607, -0.03638036176562309, -0.013008885085582733, 0.0213929396122694, -0.04548163712024689, -0.03774060681462288, -0.006615735590457916, -0.01184031181037426, -0.050650566816329956, 0.006541540380567312, 0.025275819003582, 0.027922112494707108, -0.03830943629145622, 0.0332641638815403, 0.015914862975478172, -0.027155429124832153, 0.0026602058205753565, 0.028614601120352745, -0.03086518868803978, 0.008074906654655933, -0.0015735557535663247, 0.019649352878332138, 0.0013378314906731248, -0.04835051670670509, 0.004127106163650751, 0.047262318432331085, 0.016261106356978416, -0.045283783227205276, 0.0018533333204686642, 0.026240356266498566, -0.056882958859205246, 0.007252577226608992, 0.028787722811102867, -0.007716297172009945, -0.03986753523349762, -0.024063965305685997, 0.01413417886942625, 0.03299211710691452, 0.011333310976624489, -0.01780683919787407, 0.017942864447832108, -0.04778168722987175, 0.04419558495283127, 0.004420795012265444, -0.025226356461644173, 0.003338782349601388, -0.00028750626370310783, -0.01574174128472805, 0.06177983805537224, -0.0033140506129711866, -0.019661718979477882, 0.02829308994114399, 0.02474408783018589, 0.00041077841888181865, 0.005672838538885117, -0.030964115634560585, 0.017126716673374176, -0.03600938618183136, -0.04065895080566406, -0.022122524678707123, -0.016285838559269905, 0.057575445622205734, -0.0024932667147368193, -0.017905766144394875, 0.019983230158686638, 0.010492432862520218, 0.007790492381900549, 0.02091067098081112, 0.009552626870572567, 0.03897719085216522, -0.009039443917572498, -0.045753683894872665, 0.036973923444747925, 0.014591715298593044, 0.00954644475132227, 0.015259471721947193, -0.015296570025384426, -0.03019743226468563, -0.0036912094801664352, -0.0145793491974473, 0.007326772436499596, 0.002598376478999853, -8.404920663451776e-05, -0.007666833698749542, -0.0008331498829647899, 0.006974345538765192, 0.016149813309311867, 0.0323738232254982, -0.043181587010622025, -0.001123747555539012, -0.03509431332349777, 0.01884557120501995, 0.0010433695279061794, 0.004201300907880068, 0.0021300194784998894, -0.006541540380567312, -0.002123836660757661, -0.06722081452608109, -0.0049339784309268, 0.010393505915999413, -0.03600938618183136, 0.01660735160112381, -0.00627567432820797, -0.045357976108789444, -0.06499496102333069, -0.027081234380602837, 0.043181587010622025, 0.000854017271194607, 0.016557887196540833, -0.05960344895720482, -0.006152015645056963, -0.011512616649270058, -0.004034361802041531, 0.00239743129350245, 0.006683747749775648, 0.04582788050174713, -0.018895035609602928, 0.09793761372566223, 0.019636986777186394, -0.009243480861186981, -0.034179240465164185, 0.04221704974770546, -0.003480989718809724, -0.006591003853827715, 0.02323545143008232, -0.03086518868803978, -0.031829725950956345, -0.01157444529235363, 0.02552313543856144, -0.006254034116864204, -0.007920334115624428, 0.005533722694963217, -0.0021856657695025206, -0.0016446594381704926, 0.015333667397499084, 0.04115358367562294, 0.01811598613858223, -0.00627567432820797, -0.025016136467456818, 0.01436913013458252, -0.011500250548124313, -0.013998154550790787, 0.017819205299019814, -0.04224177822470665, -0.004052910953760147, 0.020094523206353188, 0.023334378376603127, 0.012569896876811981, -0.012545165605843067, -0.0036355629563331604, -0.006671381648629904, -0.011048896238207817, 0.005759399384260178, 0.030321089550852776, 0.002635474083945155, -0.012984153814613819, -0.009898871183395386, -0.00584286917001009, -0.00997924990952015, 0.02483064867556095, -0.020106889307498932, -0.025993039831519127, 0.023025233298540115, 0.03981807082891464, 0.004154928959906101, -0.00789560191333294, 0.028614601120352745, 0.046817149966955185, 0.03412977606058121, -0.045283783227205276, 0.0021253821905702353, -0.05930666625499725, -0.03168133646249771, -0.03450075164437294, -0.00701144291087985, -0.02002032846212387, 0.0008138281991705298, -0.015469691716134548, 0.03042001649737358, 0.037839531898498535, -0.005224576219916344, 0.020626256242394447, -0.023754818364977837, -0.0013393772533163428, -0.05762491002678871, 0.02935655228793621, -0.013231471180915833, 0.07642101496458054, 0.05643778666853905, 0.022332744672894478, -0.03830943629145622, 0.001978537766262889, 0.005008173640817404, -0.004522813484072685, 0.021578427404165268, 0.03435236215591431, -0.0032058493234217167, 0.011543530970811844, -0.04817739129066467, 0.02398976869881153, 0.03598465397953987, 0.015914862975478172, -0.029900651425123215, -0.03341255709528923, 0.0033295080065727234, 0.02175154909491539, 0.0064178816974163055, -0.04560529440641403, -0.06286803632974625, 0.011314762756228447, -0.009101273491978645, -0.03262114152312279, 0.01118492055684328, -0.005005082115530968, 0.03088991902768612, -0.036751337349414825, -0.03519323840737343, -0.004426978062838316, -0.03551475331187248, -0.02997484616935253, 0.0368008017539978, 0.07953721284866333, -0.022035963833332062, -0.019327839836478233, -0.029035041108727455, 0.07004023343324661, -0.015061617828905582, 0.03581153228878975, -0.01959988847374916, 0.0008068723836913705, -0.02110852487385273, 0.006080911960452795, -0.013491153717041016, 0.02675972320139408, 0.02403923310339451, 0.06583584100008011, -0.001997086452320218, -0.02161552384495735, 0.029084503650665283, -0.03509431332349777, 0.0032213067170232534, 0.01867244951426983, -0.0374685563147068, -0.002814779058098793, 0.04582788050174713, 0.03989226743578911, -0.010869591496884823, 0.018214913085103035, -0.028119966387748718, 0.014517520554363728, 0.039966460317373276, -0.0024190715048462152, -0.03430289775133133, 0.03895246237516403, 0.052431248128414154, 0.03561367839574814, -0.028762992471456528, -0.004408429376780987, 0.009880322962999344, -0.014937959611415863, -0.03200284764170647, 0.006040723063051701, -0.012427689507603645, 0.013491153717041016, -0.030593140050768852, 0.006547722965478897, 0.010640823282301426, 0.009095090441405773, -0.03865567967295647, 0.014010519720613956, 0.03232435882091522, 0.022357476875185966, 0.06801223009824753, 0.0217268168926239, 0.05460764095187187, -0.015333667397499084, 0.006300406064838171, 0.0047670393250882626, 0.01929074339568615, -0.0027158521115779877, 0.021281646564602852, -0.0381363146007061, -0.003233672585338354, -0.011370409280061722, 0.019995596259832382, -0.047015003859996796, -0.03284372761845589, 0.005184386856853962, -0.00722784548997879, 0.012266933917999268, -0.043428901582956314, -0.009509346447885036, -0.037245973944664, 0.022913940250873566, 0.008946700021624565, -0.017287472262978554, -0.07147467136383057, -0.022295646369457245, -0.047707490622997284, -0.018771376460790634, -0.028565138578414917, 0.01736166886985302, 0.015271837823092937, -0.045085929334163666, 0.02004506066441536, -0.043181587010622025, -0.02765006385743618, -0.0191794503480196, -0.016224009916186333, 0.020082157105207443, 0.005555362906306982, 0.014987423084676266, 0.012297848239541054, 0.008717931807041168, -0.0072340285405516624, 0.002890520030632615, -0.020675718784332275, 0.0006148151587694883, 0.02239457331597805, 0.024385476484894753, -0.025770453736186028, -0.029504943639039993, -0.025399478152394295, -0.02619089186191559, -0.026462942361831665, -0.020477864891290665, 0.023309648036956787, 0.02530055120587349, 0.06642940640449524, 0.016285838559269905, -0.025869380682706833, -0.023322012275457382, 0.000979221542365849, -0.04464075714349747, 0.00852626096457243, 0.02429891563951969, 0.014307300560176373, 0.020094523206353188, 0.017843937501311302, -0.05042798072099686, 0.0011322491336613894, 0.010016347281634808, -0.05727866664528847, -0.022246183827519417, -0.03321470320224762, 0.02121981605887413, -0.029059773311018944, 0.0068568699061870575, -0.0032429469283670187, -0.02208542637526989, -0.024904843419790268, 0.02611669711768627, -0.022765548899769783, -0.05163983255624771, 0.019500961527228355, -0.02057679183781147, -0.011741384863853455, -0.024645160883665085, 0.023532232269644737, 0.029059773311018944, -0.04075787588953972, -0.033091042190790176, -0.00841496791690588, -0.03529216721653938, -0.029653333127498627, -0.026215624064207077, -0.0024994495324790478, -0.02452150173485279, 0.011042713187634945, -0.019006328657269478, -9.82023193500936e-05, 0.029430748894810677, -0.022777915000915527, -0.01915471814572811, 0.045531097799539566, -0.02407633140683174, 0.04530851170420647, 0.049611832946538925, 0.003049730323255062, 0.02846621163189411, 0.01663208194077015, 0.013899227604269981, -0.02108379267156124, 0.005465710535645485, -0.015568618662655354, 0.027476942166686058, -0.0005444842972792685, 0.05094734579324722, -0.026636064052581787, -0.03187919035553932, -0.009701017290353775, 0.026215624064207077, -0.025176892057061195, 0.008198565803468227, 0.00424149027094245, -0.049166660755872726, -0.02068808488547802, 0.025016136467456818, -0.00018471504154149443, -0.03907611966133118, 0.03361040726304054, -0.008767395280301571, -0.011790848337113857, -0.012056713923811913, -0.011222018860280514, 0.005202936008572578, -0.0028039589524269104, 0.013886861503124237, -0.03346201777458191, 0.026487672701478004, 0.010016347281634808, -0.009175468236207962, -0.038680411875247955, 0.05361837148666382, 0.006229302380234003, -0.024533867835998535, 0.017510058358311653, -0.0024422574788331985, -0.02002032846212387, -0.011834128759801388, -0.013923958875238895, 0.04971075803041458, -0.010795396752655506, 0.03615777567028999, -0.03427816554903984, 0.012860494665801525, 0.011654824018478394, 0.020502597093582153, -0.027773723006248474, -0.041029926389455795, -0.008081089705228806, 0.008118187077343464, 0.0057408506982028484, 0.0013679732801392674, 0.037419095635414124, -0.0008408785215578973, 0.03066733479499817, -0.011982519179582596, -0.019810108467936516, -0.030741529539227486, 0.04563002660870552, 0.029529675841331482, 0.00519366143271327, -0.008081089705228806, -0.024867745116353035, -0.004120923113077879, -0.05500334873795509, -0.0012930053053423762, 0.02423708699643612, -0.009769029915332794, -0.0337093360722065, -0.03212650492787361, -0.003774679033085704, -0.03338782489299774, -0.005833594594150782, 0.016656814143061638, 0.001653933897614479, -0.020366571843624115, -0.007413333281874657, -0.013590080663561821, 0.0019661718979477882, 0.034006115049123764, -0.05037851631641388, -0.018103620037436485, -0.0011314762523397803, -0.004303319379687309, 0.043824609369039536, 0.004355874378234148, -0.023359110578894615, 0.006776491645723581, -0.002147022634744644, 0.004788679536432028, -0.01990903541445732, -0.030964115634560585, -0.0064920769073069096, -0.0055213565938174725, 0.044047195464372635, 0.04481387883424759, -0.0010773756075650454, -0.014937959611415863, 0.03378353267908096, -0.02432364784181118, 0.005589369218796492, -0.02722962573170662, 0.032893188297748566, 0.015284203924238682, -0.0057315765880048275, -0.0069434307515621185, 0.013602446764707565, 0.0009660828509368002, -0.019612254574894905, -0.04978495463728905, -0.03106304258108139, -0.005913972854614258, -0.012112360447645187, -0.05767437443137169, 0.003926160745322704, 0.00525549054145813, 0.021269280463457108, 0.012637909501791, -0.009769029915332794, -0.011759933084249496, 0.0012582263443619013, 0.016755741089582443, 0.032274894416332245, -0.005734667647629976, 0.007147467229515314, -0.031186699867248535, -0.0004505810502450913, 0.01006581075489521, -0.026067234575748444, -0.036553483456373215, 0.024199988692998886, 0.05361837148666382, 0.04375041648745537, 0.03558894619345665, 0.039743874222040176, 0.025448940694332123, -0.010603725910186768, -0.005039088428020477, 0.009076541289687157, -0.01957515813410282, -0.005793405696749687, -0.003799410769715905, 0.0017003058455884457, -0.013837398029863834, 0.004108557011932135, 0.00015573255950585008, 0.011908323504030704, 1.398404947394738e-05, -0.010374956764280796, -0.0038365081418305635, 0.02108379267156124, -0.021677354350686073, 0.014418593607842922, -0.03173079714179039, -0.01393632497638464, 0.020205816254019737, -0.01820254698395729, -0.014554617926478386, 0.012786299921572208, -0.024385476484894753, 0.03408031165599823, 0.03405557945370674, -0.0043218680657446384, -0.013318032026290894, 0.0073947845958173275, 0.005558454431593418, -0.019884303212165833, 0.013899227604269981, 0.007110369857400656, 0.02113325521349907, -0.050032272934913635, -0.01649605855345726, -0.038902997970581055, -0.010857225395739079, -0.011877409182488918, -0.008285126648843288, -0.007079455070197582, -0.023049963638186455, -0.007258760277181864, -0.008742663078010082, 0.0012180372141301632, 0.027773723006248474, 0.03447601944208145, -0.016792839393019676, -0.08087272942066193, -0.03640509396791458, -0.0074689798057079315, 0.010585176758468151, 0.0328189954161644, -0.0033635140862315893, 0.0014097080565989017, -0.012211287394165993, 0.01884557120501995, -0.03905138745903969, -0.012099994346499443, -0.000779822061304003, 0.025770453736186028, 0.025547867640852928, 0.021430036053061485, -0.05614100769162178, 0.0200697910040617, 0.00424149027094245, 0.036355629563331604, -0.023297281935811043, -0.011222018860280514, 0.019352572038769722, 0.01957515813410282, 0.060543254017829895, -0.05633886158466339, -0.0072463941760361195, 0.011011798866093159, 0.015296570025384426, -0.012396775186061859, -0.004192026797682047, 0.005691387224942446, -0.03088991902768612, 0.013552983291447163, 0.013045983389019966, -0.043181587010622025, 0.0042383987456560135, -0.006337503436952829, -0.014789569191634655, -0.005648106802254915, 0.02767479605972767, 0.021096158772706985, -0.04266221821308136, 0.08576960861682892, 0.012823397293686867, 0.01220510434359312, 0.0032522212713956833, 0.005413155537098646, -0.05183768644928932, 0.007920334115624428, -0.01274920254945755, 0.019995596259832382, 0.011747567914426327, 0.002561278874054551, -0.022357476875185966, -0.008606638759374619, 0.03877934068441391, 0.023223085328936577, -0.010473883710801601, 0.015494422987103462, 0.011661006137728691, -0.028169430792331696, 0.016458960250020027, 0.03150821104645729, -0.022097792476415634, -0.03131036087870598, -0.030098505318164825, -0.009410419501364231, -0.014641178771853447, -0.007734845858067274, -0.005453344434499741, -0.005481167696416378, -0.004377514589577913, -0.013416958972811699, 0.012390592135488987, 0.0022073062136769295, -0.020749913528561592, -0.0026246539782732725, 0.01884557120501995, -0.004294045269489288, 0.011555897071957588, 0.03927397355437279, -0.04001592472195625, 0.028169430792331696, 0.02675972320139408, -0.03338782489299774, 0.0189568642526865, -0.00024712400045245886, -0.002453077584505081, -0.0280457716435194, 0.004810319747775793, 0.027575869113206863, 0.005991259589791298, 0.024199988692998886, -0.0317060649394989, 0.018177814781665802, -0.0007156741921789944, -0.019327839836478233, -0.020032694563269615, 0.013862129300832748, 0.009020895697176456, 0.028021039441227913, 0.0374685563147068, 0.011259116232395172, 0.01109835971146822, -0.014393861405551434, 0.02849094197154045, 0.01350351981818676, 0.05490441992878914, 0.025176892057061195, -0.029529675841331482, 0.007666833698749542, -0.016928862780332565, -0.042736414819955826, 0.02026764489710331, 0.0009583542123436928, 0.004071459639817476, 0.04229124262928963, 0.011735201813280582, 0.019340205937623978, 0.004609374329447746, 0.014740105718374252, 0.05994969233870506, 0.007549358066171408, -0.011827945709228516, -0.019191816449165344, -0.050897881388664246, 0.005719210486859083, 0.0058768754824995995, -0.009595908224582672, 0.0064302473329007626, -0.012365860864520073, -0.028565138578414917, 0.01445569097995758, -0.009286761283874512, -0.018808474764227867, 0.05035378411412239, 0.03830943629145622, 0.002853422425687313, -0.030345821753144264, 0.009453700855374336, 0.006615735590457916, 0.008581907488405704, -0.0016771198716014624, 0.03788899630308151, -0.012248384766280651, 0.007611187174916267, 0.01971118152141571, -0.019006328657269478, -0.007870870642364025, 0.01362717803567648, 0.052826955914497375, 0.0010951515287160873, -0.011543530970811844, 0.0003678843495436013, -0.017299838364124298, 0.025040866807103157, 0.018721912056207657, -0.031829725950956345, -0.03378353267908096, 0.010461517609655857, 0.007759577594697475, 0.044937536120414734, 0.004810319747775793, -0.0052153016440570354, 0.019748279824852943, 0.011994884349405766, -0.004349691327661276, -0.010201835073530674, 0.006448796484619379, -0.0026200166903436184, -0.00863755401223898, -0.04889461398124695, 0.031260896474123, 0.023198354989290237, -0.013318032026290894, 0.026932844892144203, -0.007833772338926792, 0.025251086801290512, 0.023383842781186104, 0.004392971750348806, 0.01702778972685337, 0.029455479234457016, -0.03445128723978996, -0.00018964205810334533, 0.05811954662203789, -0.024694623425602913, -0.006284948438405991, -0.011630091816186905, 0.02208542637526989, 0.031260896474123, 0.009404237382113934, 0.0031532945577055216, -0.02002032846212387, 0.03472333773970604, 0.027996309101581573, 0.004733033012598753, -0.028218893334269524, 0.0049247038550674915, -0.019389670342206955, -0.05960344895720482, -0.020737547427415848, 0.04370095208287239, -0.0017992326756939292, -0.030766261741518974, -0.0058892411179840565, -0.014517520554363728, -0.04051055759191513, -0.02616616152226925, 0.03467387333512306, -0.03511904552578926, 0.03252221271395683, -0.02186284214258194, -0.021739182993769646, 0.026957575231790543, -0.02636401541531086, -0.006850686855614185, 0.02980172447860241, -0.012291665188968182, -0.03197811543941498, -0.020094523206353188, -0.026042502373456955, -0.022777915000915527, 0.01607561856508255, -0.002771498402580619, -0.012279300019145012, -0.03197811543941498, 0.007067089434713125, -0.014084715396165848, 0.01045533549040556, 0.008235663175582886, 0.007666833698749542, 0.030914651229977608, -0.02594357542693615, -0.00301263271830976, -0.04154929146170616, -0.012545165605843067, 0.022048329934477806, -0.026636064052581787, 0.0044702584855258465, 0.027575869113206863, 0.013726104982197285, 0.026215624064207077, -0.010140005499124527, 0.009088907390832901, 0.0263887457549572, -0.0033975201658904552, 0.022876841947436333, 0.03131036087870598, -0.0583173967897892, -0.007512260228395462, -0.021071426570415497, 0.0032151236664503813, 0.03618250787258148, -0.013268568553030491, 0.002000177977606654, -0.010436786338686943, -0.0036788436118513346, 0.045283783227205276, 0.045778416097164154, 0.022382207214832306, -0.019834840670228004, 0.019612254574894905, -0.024843014776706696, 0.0032151236664503813, -0.009793761186301708, -0.03338782489299774, 0.025597332045435905, 0.024509135633707047, -0.02275318279862404, 0.011215835809707642, -0.023581696674227715, -0.019500961527228355, 0.024051599204540253, 0.013528251089155674, 0.0007373144617304206, -0.010158554650843143, 0.017992326989769936, 0.0020249097142368555, 0.0140228858217597, 0.012860494665801525, -0.030988845974206924, -0.045357976108789444, -0.02574572153389454, -0.0227284524589777, 0.04622358828783035, -0.0060469056479632854, 0.03573733568191528, -0.013689007610082626, 0.017819205299019814, 0.03662768006324768, 0.0343770906329155, 0.0390266552567482, -0.024187622591853142, -0.0014993605436757207, 0.002813233295455575, -0.027823185548186302, 0.021788645535707474, 0.013466422446072102, 0.009608273394405842, -0.007734845858067274, 0.03173079714179039, 0.01647132635116577, -0.021912304684519768, 0.01800469309091568, 0.0012775480281561613, -0.012984153814613819, 0.015036886557936668, 0.013268568553030491, -0.0034253434278070927, -0.04051055759191513, -0.013899227604269981, 0.006677564699202776, -0.010721201077103615, 0.03455021604895592, 0.021763915196061134, 0.007493711542338133, -0.008940516971051693, -0.028614601120352745, 0.010053444653749466, 0.001613744767382741, -0.01247097086161375, 0.004550636745989323, 0.020960133522748947, -0.002817870583385229, -0.016421863809227943, -0.0030899194534868, -0.015531521290540695, -0.00048226857325062156, 0.011265299282968044, 0.02846621163189411, -0.01094378624111414, 0.00821711402386427, -0.004624831955879927, -0.006118009332567453, 0.014913228340446949, 0.001670936937443912, -0.008687017485499382, -0.017930498346686363, -0.052431248128414154, -0.014270203188061714, 0.018697181716561317, -0.017571887001395226, 0.023161256685853004, -0.017794473096728325, -0.005280222278088331, 0.022777915000915527, -0.021467134356498718, -0.0035830081906169653, 0.009150736965239048, -0.010504798963665962, 0.06271964311599731, 0.0004606283036991954, -0.011228200979530811, -0.004584642592817545, -0.0026416569016873837, 0.02851567417383194, -0.02516452595591545, -0.009837042540311813, -0.03531689941883087, -0.013293299823999405, -0.018153082579374313, 0.05525066331028938, -0.04978495463728905, 0.02141766995191574, 0.018177814781665802, 0.014109446667134762, -0.02765006385743618, 0.04622358828783035, -0.011475518345832825, 0.02831782028079033, 0.009076541289687157, 0.00392925227060914, -0.03553948178887367, -0.008544810116291046, -0.0029832639265805483, -0.0051318323239684105, -0.042736414819955826, 0.04439343884587288, 0.00928057823330164, 0.029653333127498627, -0.0013416958972811699, -0.014752471819519997, -0.057130277156829834, 0.009181651286780834, 0.014418593607842922, -0.006504442542791367, -0.046371977776288986, 0.005035996902734041, -2.4188298993976787e-05, 0.004964893218129873, 0.00446716696023941, 0.011290030553936958, -0.0018780650570988655, 0.007314406335353851, 0.003518087323755026, 0.028144698590040207, -0.039298705756664276, 0.01109835971146822, 0.009194017387926579, 0.009051810018718243, 0.01755952276289463, 0.002610742347314954, 0.0005978120607323945, -0.010721201077103615, 0.0024623519275337458, -0.0034253434278070927, -0.024138160049915314, 0.014678276143968105, 0.027946844696998596, 0.019587522372603416, -0.03173079714179039, 0.010288395918905735, -0.018103620037436485, 0.01339222677052021, 0.01942676678299904, -0.015902496874332428, -0.006436430383473635, 0.044245049357414246, -0.022332744672894478, 0.0459020733833313, -0.021034328266978264, 0.013775568455457687, 0.014059983193874359, 0.017843937501311302, -0.010807761922478676, 0.01062227413058281, -0.017213277518749237, 0.05440978705883026, -0.024199988692998886, 0.023433305323123932, -0.015346032567322254, 0.051738761365413666, 0.011741384863853455, -0.004012721590697765, 0.022444037720561028, 0.025819916278123856, 0.0015859216218814254, 0.00217329990118742, -0.02829308994114399, 0.012582262977957726, -0.01616217941045761, 0.006300406064838171, 0.033115774393081665, 0.005014356691390276, -0.005546088330447674, -0.028144698590040207, 0.020984865725040436, -0.03368460386991501, 0.02239457331597805, 0.023742452263832092, 0.0018208730034530163, -0.023841379210352898, 0.0385814867913723, 0.006349869538098574, -0.024224720895290375, 0.029727529734373093, -0.01477720309048891, -0.04093099758028984, 0.00701144291087985, 0.0249419417232275, 0.0015318209771066904, -0.032497480511665344, -0.0115311648696661, 0.010393505915999413, 0.015061617828905582, 0.003233672585338354, -0.02594357542693615, 0.0031780260615050793, 0.00861282180994749, -0.049611832946538925, 0.014789569191634655, -0.03234909102320671, 0.025795185938477516, 0.0056604729034006596, 0.01252661645412445, -0.02066335268318653, -0.009088907390832901, -0.0019012510310858488, 0.01543259434401989, 0.012069080024957657, -0.01607561856508255, -0.0067208451218903065, 0.03479753062129021, 0.0017822296358644962, 0.01318200770765543, -0.0050576371140778065, -0.03536636009812355, -0.01006581075489521, -0.006216936279088259, -0.0016802112804725766, 0.022567695006728172, -0.017089620232582092, 0.012909958139061928, 0.03321470320224762, -0.02849094197154045, -0.01499978918582201, 0.004188935272395611, -0.040832072496414185, 0.017200911417603493, 0.0046773869544267654, -0.018301473930478096, 0.0074566141702234745, -0.002108379267156124, 0.05999915674328804, 0.029455479234457016, 0.007110369857400656, 0.010603725910186768, 0.0016477509634569287, 0.03145875036716461, -0.005175112746655941, 0.03922450914978981, -0.04310739040374756, 0.021207451820373535, 0.02177628129720688, 0.019364938139915466, 0.028169430792331696, 0.009639188647270203, 0.005722302012145519, -0.0015642814105376601, -0.024311281740665436, -0.018177814781665802, 0.020811744034290314, 0.02518925815820694, -0.034426555037498474, -0.021788645535707474, -0.002601468004286289, -0.015927229076623917, -0.014975056983530521, -0.027724258601665497, 0.00497725885361433, -0.023049963638186455, -0.018054155632853508, 0.007196930702775717, 0.003161023138090968, 0.005966527853161097, -0.01598905771970749, 0.013342763297259808, 0.016458960250020027, 0.005799588747322559, 0.01836330257356167, 0.013973422348499298, -0.019031058996915817, 0.026314551010727882, -0.014628812670707703, -0.0008841590606607497, 0.014542251825332642, -0.0022923212964087725, -0.012155640870332718, -0.005864509381353855, 0.049883883446455, 0.008952883072197437, -0.004510447848588228, 0.013404592871665955, 0.007147467229515314, -0.01318200770765543, -0.007994528859853745, -0.0005641923635266721, 0.0007407923112623394, 0.00031146511901170015, 0.0020094523206353188, -0.0013223742134869099, 0.012508068233728409, -0.009793761186301708, 0.033734068274497986, 0.018635351210832596, 0.044022463262081146, 0.008359321393072605, -0.01705252192914486, 0.0005073866923339665, 0.00125281629152596, -0.021120889112353325, 0.011500250548124313, -0.005836686119437218, 0.0282683577388525, 0.0006569363176822662, 0.011778482235968113, 0.000980767305009067, 0.0014089352916926146, -0.0098679568618536, 0.0036170142702758312, 0.006467345170676708, -0.018796108663082123, 0.0055955518037080765, -0.022716086357831955, 0.005604826379567385, -0.01820254698395729, -0.009311493486166, -0.024917209520936012, -0.02088593877851963, 0.015271837823092937, -0.0131943728774786, 0.0021501139272004366, 0.012025799602270126, 0.0197359137237072, -0.04817739129066467, 0.07068325579166412, 0.011821762658655643, 0.022431671619415283, -0.04627304896712303, 0.008149102330207825, -0.005400789435952902, -0.005243124905973673, 0.004556819796562195, -0.005153472535312176, 0.029678065329790115, -0.04901827126741409, 0.003212032373994589, -0.03553948178887367, 0.008860139176249504, 0.020564425736665726, -0.03860621526837349, -0.001653933897614479, 0.025016136467456818, 0.0024237087927758694, 0.005382240749895573, 0.020193450152873993, -0.010677920654416084, -0.004235307220369577, -0.025795185938477516, -0.03185445815324783, -0.012662641704082489, -0.009620639495551586, 0.02933182194828987, 0.009057993069291115, -0.01045533549040556, 0.03855675458908081, -0.003555184928700328, 0.015506789088249207, -0.009243480861186981, -0.032274894416332245, 0.051986079663038254, -0.016199277713894844, -0.01062227413058281, -0.0156304482370615, 0.004021996166557074, -0.010214201174676418, -0.018499327823519707, 0.006844503805041313, -0.0072463941760361195, 0.0044578928500413895, -0.04699027165770531, -0.014356764033436775, 0.0145793491974473, -0.03685026615858078, -0.036083582788705826, -0.007283492013812065, 0.010535713285207748, -0.01567991077899933, 0.007611187174916267, 0.00904562696814537, -0.015160544775426388, -0.02483064867556095, 0.002290775766596198, 0.021046694368124008, 0.029232895001769066, 0.047460172325372696, -0.03699865564703941, 0.020650986582040787, -0.013355129398405552, 0.005125649273395538, 0.010238932445645332, -0.006665199063718319, 0.013045983389019966, -0.002776135690510273, -0.003468623850494623, 0.0213929396122694, -0.0063436864875257015, -0.007870870642364025, -0.01413417886942625, 0.015086350031197071, -0.010572810657322407, -0.0007234028307721019, 0.01990903541445732, 0.01811598613858223, 0.011741384863853455, 0.0023665165062993765, 0.00050854601431638, 0.0035830081906169653, -0.028243625536561012, -0.0038797887973487377, 0.003011086955666542, 0.006850686855614185, -0.017262741923332214, -0.016421863809227943, -0.013355129398405552, 0.008421150967478752, 0.004748490639030933, 0.014233105815947056, 0.026265088468790054, -0.023940306156873703, -0.0003027703787665814, 0.02108379267156124, -0.040634218603372574, -0.008872505277395248, -0.03019743226468563, -0.01904342509806156, 0.025016136467456818, 0.016792839393019676, 0.010640823282301426, 0.011085993610322475, 0.02018108405172825, 0.02762533165514469, -0.03576206788420677, -0.003573733614757657, 0.03002430871129036, 0.008328407071530819, 0.018412766978144646, -0.029529675841331482, -0.04303319379687309, -0.003969441168010235, -0.03774060681462288, 0.005465710535645485, 0.010158554650843143, -0.00087102031102404, 0.016594985499978065, -0.031161969527602196, 0.012044347822666168, -0.025968307629227638, 0.0073082237504422665, -0.005413155537098646, 0.03670187294483185, 0.021467134356498718, -0.0006662107189185917, -0.002451531821861863, -0.03257167711853981, -0.0514419786632061, -0.007530808914452791, 0.0016431136755272746, 0.027551136910915375, 0.02552313543856144, 0.015395496040582657, -0.04666875675320625, 0.00887868832796812, -0.022988134995102882, 0.019167084246873856, 0.0014777203323319554, -0.019946133717894554, 0.028688795864582062, -0.020589157938957214]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"=1Eπs""
β
rt(s1:t) +Vθ
t(s1:t)−Vθ
t−1(s1:t−1)
−logq(st|s1:t−1)
p0(st|s1:t−1)2#
In particular, substituting the soft RL potential terms from Eq. (Twist to Soft RL), Eq. (PCL) recovers the path consistency
loss from Nachum et al. (2017). Note that we derived PCL from an importance sampling perspective, whereas PCL was
originally derived by enforcing KKT conditions of the soft RL problem.
We might also consider multi-step losses for various c. Minimizing the square of the multi-step log weights with arbitrary q
recovers the multi-step PCL loss (Nachum et al., 2017),
min
θL(t,c)
PCL(θ):= min
θL(t,c)
logCons(θ;{Φt,anyq}) (multi-step PCL)
= min
θEπs
 t+cX
τ=tlogϕτ(s1:τ) + log Φθ
t+c(s1:t+c)−logΦθ
t−1(s1:t−1)−t+cX
τ=tlogq(sτ|s1:τ−1)
p0(sτ|s1:τ−1)!2

= min
θEπs
 t+c−1X
τ=t−1logϕτ(s1:τ) + log ψθ
t+c(s1:t+c)−logψθ
t−1(s1:t−1)−t+cX
τ=tlogq(sτ|s1:τ−1)
p0(sτ|s1:τ−1)!2
 (50)
(sRL)= min
θEπs
 
βt+cX
τ=trτ(s1:τ) +β Vθ
t+c(s1:t+c)−β Vθ
t−1(s1:t−1)−t+cX
τ=tlogq(sτ|s1:τ−1)
p0(sτ|s1:τ−1)!2

where we write the ψθ
tparameterization in Eq. (50) explicitly for use in App. D.1. While PCL considers learned a
proposal or policy qwith the goal of approximating the solution of a regularized MDP, we leave joint learning of proposals
{qξ(st|s1:t−1)}T
t=1and SMC target twists {ψθ
t(s1:t)}T
t=1or{Vθ
t(s1:t)}T
t=1to future work.
In App. E, we describe using PCL to learn the proposal only (Guo et al., 2021), with the values VQt(s1:t)induced from
learned proposal twists Qξ
t(st+1,s1:t)which define {qξ
Qt(st+1|s1:t)}T−1
t=0(in similar fashion to Eq. (Twist-Induced Proposal
(soft RL)), but without reference to twisting targets).
26
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
C.2. Controlled Decoding Losses via Optimal Twist Identities (Mudgal et al., 2023)
In Prop. B.1 (or Prop. 3.2 and Eq. (13) in the main text), we noted that the optimal twists satisfy the following relationships
ψ∗
t(s1:t) =ctϕt(s1:t)X
st+1:Tp0(st+1:T|s1:t)TY
τ=t+1ϕτ(s1:τ) =ct
ct+1ϕt(s1:t)X
st+1p0(st+1|s1:t)ψ∗
t+1(s1:t+1)
(ϕt=1)=ctX
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T)(ϕt=1)=ct
ct+1X
st+1p0(st+1|s1:t)ψ∗
t+1(s1:t+1) (51)
We proceed to describe two ‘controlled decoding’ (CD) losses from Mudgal et al.","[-0.004184312652796507, -0.0007404220523312688, 0.018545612692832947, 0.009503801353275776, -0.006817657966166735, 0.04311029985547066, 0.02740262821316719, 0.00894941296428442, -0.055966831743717194, 0.05161092430353165, 0.03426648676395416, -0.0011508510215207934, -0.02179274521768093, 0.03482087329030037, 0.03653683885931969, -0.03471527621150017, 0.052350107580423355, 0.015483276918530464, -0.0282738097012043, 0.051558125764131546, -0.0013372971443459392, -0.01556247565895319, -0.027112234383821487, 0.06050753593444824, -0.015536075457930565, -0.03484727442264557, 0.049683764576911926, -0.001616966212168336, 0.026769042015075684, 0.010130788199603558, 0.05570283904671669, -0.020380374044179916, -0.015641674399375916, -0.04643663018941879, -0.028036214411258698, 0.07676959782838821, -0.029646581038832664, 0.04184312745928764, -0.01079737488180399, 0.013384521007537842, 0.022320734336972237, -0.053432486951351166, -0.023323914036154747, 0.030570562928915024, 0.0067516593262553215, 0.04873338341712952, -0.013278922997415066, 0.05161092430353165, -0.003451728029176593, 0.04234471544623375, -0.026161855086684227, 0.04593504220247269, -0.015509676188230515, -0.018189219757914543, -0.038226403295993805, 0.008164029568433762, 0.021924743428826332, -0.016486456617712975, 0.012282343581318855, -0.05200691521167755, 0.03846399858593941, -0.006540463771671057, 0.014493297785520554, -0.004095214419066906, 0.008883414790034294, -0.02742902748286724, -0.05351168289780617, 0.04031195864081383, -0.0003796983219217509, 0.0662626177072525, 0.004029215779155493, -0.0008959313272498548, -0.001221799524500966, 0.006537163630127907, -0.006778058595955372, 0.016526054590940475, 0.006302868481725454, 0.07603041082620621, 0.02443269081413746, -0.031652938574552536, 0.032682519406080246, -0.03270891681313515, 0.028960196301341057, -0.025845060124993324, 0.0010617529042065144, -0.04651582986116409, -0.025647064670920372, 0.0188228078186512, -0.0375400185585022, -0.017529234290122986, -0.008210228756070137, 0.004148013424128294, -0.032576918601989746, -0.011318763718008995, 0.03661603480577469, 0.009319005534052849, 0.03424008563160896, 0.01785922795534134, 0.02183234505355358, -0.005289789754897356, 0.03228652477264404, -0.010836973786354065, 0.024168696254491806, -0.019337596371769905, 0.05174291878938675, 0.011635556817054749, -0.030887356027960777, 0.021040361374616623, -0.054224468767642975, -0.0055240849032998085, 0.0017291639233008027, 0.001404120703227818, -0.04054955393075943, 0.018638011068105698, 0.041816726326942444, -0.05361727997660637, -0.03373849764466286, -0.002187854377552867, -0.040971945971250534, -0.004042415879666805, -0.03318410739302635, -0.00894941296428442, 0.022201936691999435, 0.0006674110773019493, 0.009879994206130505, 0.016433658078312874, 0.022360334172844887, -0.07244008779525757, -0.008170629851520061, 0.012420941144227982, 0.005507585126906633, 0.033421702682971954, 0.018506014719605446, -0.018228819593787193, 0.0007614591158926487, -0.013127125799655914, 0.02634664997458458, 0.028775399550795555, 0.004154613241553307, -0.002745542675256729, 0.010711576789617538, -0.014836490154266357, -0.035348862409591675, -0.004755200818181038, -0.00856002140790224, 0.030649760738015175, -0.006639461498707533, -0.0010460781631991267, -0.026874639093875885, 0.00569898122921586, -0.03698562830686569, -0.015760472044348717, -0.050502147525548935, 0.017740430310368538, -0.011840152554214, -0.054277267307043076, -0.007517243269830942, 0.07038093358278275, 0.021172357723116875, -0.0468590222299099, 0.023403111845254898, 0.02935618720948696, -0.012856531888246536, -0.0076294406317174435, 0.03672163560986519, -0.008401624858379364, -0.00563958240672946, 0.048522189259529114, -0.06246109679341316, -0.020380374044179916, 0.006870456505566835, -0.03899198770523071, -0.04894457757472992, -0.0377512127161026, 0.0013702964643016458, -0.025845060124993324, -0.009899793192744255, -0.08236628025770187, -0.013806912116706371, -0.026703042909502983, -0.012051348574459553, 0.04168473184108734, -0.0073522464372217655, -0.010104388929903507, -0.014070906676352024, 0.03115135058760643, -0.0020146078895777464, 0.03967837244272232, 0.013608915731310844, 0.006167571526020765, -0.005167691968381405, 0.04279350861907005, 0.06937775015830994, -0.004996095784008503, -0.043902285397052765, 0.0016821399331092834, 0.05298369377851486, 0.05361727997660637, 0.03603524714708328, 0.013952109031379223, 0.006487664766609669, 0.043875884264707565, -0.018242020159959793, -0.02080276608467102, 0.014981687068939209, -0.02443269081413746, -0.017397237941622734, -0.010612578131258488, -0.0760832130908966, 0.017357638105750084, 0.015232481993734837, -0.017252039164304733, 0.022320734336972237, 0.01593206822872162, -0.003214132972061634, 0.01873040944337845, -0.021990740671753883, -0.00991959311068058, -0.009767795912921429, 0.06309468299150467, 0.005359088070690632, 0.019034001976251602, 0.040153563022613525, -0.00019871772383339703, -0.056283626705408096, 0.006164271384477615, 0.006154371425509453, -0.017186041921377182, 0.044773466885089874, -0.017502835020422935, 0.06240829825401306, -0.004527505487203598, -0.013846511021256447, -0.014849689789116383, 0.030412165448069572, -0.015324880369007587, -0.024921080097556114, -0.007035453338176012, -0.001986558549106121, -0.06858576834201813, -0.002227453514933586, -0.0018545612692832947, 0.014466898515820503, -0.04398148134350777, 0.010995370335876942, 0.021198756992816925, -0.026637043803930283, -0.0029435385949909687, 0.003398929024115205, -0.0070816520601511, 0.015232481993734837, 0.02270352654159069, -0.003930218052119017, 0.017278440296649933, -0.056125227361917496, 0.021251557394862175, 0.033500902354717255, -0.0053293886594474316, -0.04965736344456673, 0.004827799275517464, 0.015813270583748817, -0.03199613094329834, -0.030042573809623718, 0.020116379484534264, -0.0187700092792511, -0.022861922159790993, -0.019166000187397003, -0.011001970618963242, 0.04031195864081383, -0.024313893169164658, -0.025013478472828865, 0.0020212079398334026, -0.035269662737846375, 0.055174849927425385, 0.006309468299150467, -0.033553700894117355, 0.021951142698526382, 0.03566565737128258, -0.021924743428826332, 0.06869136542081833, -0.012031548656523228, -0.03711762651801109, 0.02639944851398468, 0.005058794282376766, -0.0025508468970656395, 0.0233899112790823, -0.019192399457097054, 0.031547341495752335, -0.048759784549474716, -0.060771532356739044, -0.01504768617451191, -0.0006315243081189692, 0.030808156356215477, -0.017410436645150185, -0.012731133960187435, 0.028907397761940956, 0.01709364354610443, -0.008038632571697235, 0.011523359455168247, 0.014981687068939209, 0.030016174539923668, -0.010005391202867031, -0.03233932703733444, 0.01684284768998623, -0.00014829065185040236, 0.037223223596811295, 0.024775883182883263, -0.01708044297993183, 0.004794800188392401, -0.014612095430493355, -0.021291155368089676, -0.009068210609257221, -0.01902080327272415, -0.003969816956669092, -0.028485005721449852, -0.03284091502428055, 0.03009537234902382, -0.025092676281929016, 0.018677610903978348, -0.050554946064949036, -0.030940154567360878, -0.018268419429659843, -0.010612578131258488, -0.01966759003698826, 0.009167208336293697, -0.007259848527610302, -0.024987079203128815, 0.002806591335684061, -0.008315826766192913, -0.00900881178677082, 0.022360334172844887, 0.0006133746937848628, 0.038252800703048706, 0.009081410244107246, -0.04646303132176399, -0.060771532356739044, -0.033368904143571854, 0.03888638690114021, 0.0004784900229424238, -0.02063116990029812, -0.06536503881216049, 0.01374091301113367, -0.0053293886594474316, -0.03389689326286316, 0.006164271384477615, 0.028775399550795555, 0.03117774985730648, 0.013344921171665192, 0.10501700639724731, 0.03603524714708328, -0.022254735231399536, -0.04466786980628967, 0.026795441284775734, -0.005170992109924555, 0.011166967451572418, 0.03120414912700653, -0.020221978425979614, -0.014057707041501999, -0.050554946064949036, 0.01076437532901764, -0.020221978425979614, -0.004646303132176399, 0.009728197008371353, 0.01504768617451191, -0.00853362213820219, 0.02734982967376709, -0.017502835020422935, 0.0022951022256165743, -0.006240169983357191, -0.01982598565518856, -0.0031134849414229393, 0.0003607237304095179, -0.030728958547115326, 0.015232481993734837, -0.04176392778754234, -0.036325640976428986, 0.0035144267603754997, 0.018704010173678398, 0.04815259575843811, -0.00021222681971266866, -0.0026366449892520905, -0.010975571349263191, -0.01603766530752182, 0.008335625752806664, 0.01793842576444149, -0.0023957500234246254, 0.021924743428826332, 0.00016468718240503222, -0.013397720642387867, 0.0015889168716967106, 0.03550725802779198, -0.01590566895902157, -0.03703842684626579, 0.029514584690332413, -0.005870577413588762, -0.01595846749842167, -0.02361430786550045, 0.040127161890268326, 0.052297309041023254, 0.043004702776670456, -0.036404840648174286, 0.009662198834121227, -0.08178549259901047, -0.040127161890268326, -0.046542227268218994, 0.006850657053291798, -0.009035211056470871, 0.013311922550201416, 0.010612578131258488, 0.050370149314403534, 0.04498466104269028, -0.015443678013980389, 0.03012177161872387, -0.007748238276690245, 0.010031790472567081, -0.0657874271273613, 0.006844057235866785, -0.011892952024936676, 0.05918756499886513, 0.05295729637145996, 0.010282585397362709, -0.01175435446202755, -0.007246648892760277, -0.007583241909742355, -0.025013478472828865, 0.00731264753267169, 0.03284091502428055, -0.025264272466301918, 0.04836378991603851, -0.043031103909015656, 0.03672163560986519, 0.04923497140407562, 0.03967837244272232, -0.05073974281549454, -0.01884920708835125, 0.0025871461257338524, 0.027930617332458496, 0.0236407071352005, -0.03851679712533951, -0.06789938360452652, -0.020908363163471222, -0.0019420094322413206, -0.018466414883732796, 0.007358846254646778, -0.004745300859212875, 0.025079477578401566, -0.012632136233150959, -0.04406068101525307, 0.01607726514339447, -0.023442711681127548, 0.0016483155777677894, 0.015654873102903366, 0.04783580079674721, -0.026623845100402832, -0.031600140035152435, -0.023772703483700752, 0.07170090079307556, -0.0050884936936199665, 0.014862890355288982, -0.05158452317118645, 0.0189284048974514, -0.01706724427640438, -0.0037388219498097897, -0.029884176328778267, 0.0018034123349934816, 0.032497722655534744, 0.0468326210975647, 0.006844057235866785, -0.006259969435632229, 0.024287493899464607, -0.0011962250573560596, 0.003035936737433076, 0.0023479009978473186, -0.01221634540706873, 0.006246769800782204, 0.028933797031641006, 0.04638383165001869, -0.02089516445994377, 0.03959917277097702, -0.022967521101236343, 0.03387049213051796, 0.03276171535253525, 0.03297291323542595, -0.01420290395617485, 0.02653144672513008, 0.08363345265388489, 0.032629720866680145, -0.026043057441711426, 0.012104147113859653, 0.01549647655338049, -0.008434624411165714, -0.03978396952152252, 0.019627990201115608, -0.014783691614866257, 0.010077989660203457, -0.04271430894732475, 0.002821441041305661, 0.0032685818150639534, 0.005395387299358845, -0.03191693499684334, 0.02361430786550045, 0.011939151212573051, 0.02457788772881031, 0.03566565737128258, 0.02635985054075718, 0.06393946707248688, 0.0007490844000130892, -0.0008109580958262086, 0.013820111751556396, 0.049366969615221024, 0.011325364001095295, 0.011826952919363976, -0.034477680921554565, -0.02558106556534767, -0.012189946137368679, 0.015404078178107738, -0.07676959782838821, -0.007411645259708166, -0.0002361513179494068, 0.0235879085958004, -0.0026217952836304903, -0.042767107486724854, -0.029778579249978065, -0.0378040112555027, 0.01987878605723381, -0.006896856240928173, -0.016301659867167473, -0.0845838338136673, -0.04358549043536186, -0.027587424963712692, 0.0067483591847121716, -0.022069940343499184, 0.017529234290122986, 0.0188624057918787, -0.04894457757472992, 0.02925059013068676, -0.03468887507915497, -0.005619782954454422, -0.022993920370936394, -0.0031283346470445395, 0.0005911001935601234, -0.014400899410247803, -0.001423095352947712, 0.005388787481933832, 0.017238840460777283, -0.010929372161626816, 0.013938909396529198, -0.02251872979104519, 0.005791379138827324, 0.02274312637746334, 0.025000277906656265, -0.029646581038832664, -0.03138894587755203, -0.02059157006442547, -0.020525570958852768, -0.013430720195174217, 0.009147409349679947, -0.005840878002345562, 0.022993920370936394, 0.04503745958209038, 0.02081596665084362, -0.02558106556534767, -0.013094127178192139, -0.018162820488214493, -0.008797616697847843, 0.02542266994714737, 0.014862890355288982, 0.01805722340941429, 0.009906393475830555, 0.02542266994714737, -0.04971016198396683, 0.017568834125995636, 0.0026894439943134785, -0.02267712727189064, -0.015826469287276268, -0.035216864198446274, 0.018651211634278297, -0.02548866905272007, -0.02152875065803528, -0.042819906026124954, -0.04511665925383568, -0.025066277012228966, 0.02088196389377117, -0.01785922795534134, -0.035269662737846375, 0.013107326813042164, 0.010289185680449009, -0.015734070912003517, -0.03181133791804314, 0.01081717386841774, 0.01269153505563736, -0.016341259703040123, -0.03292011469602585, -0.007009053602814674, -0.04221272096037865, -0.015443678013980389, -0.0036860231775790453, 0.0007598091615363955, -0.03492647036910057, -0.001922209863550961, 0.010044990107417107, 0.008612819947302341, 0.016552453860640526, -0.03270891681313515, -0.027006637305021286, 0.042819906026124954, -0.047730203717947006, 0.028141813352704048, 0.031679339706897736, 0.012955529615283012, 0.03571845591068268, 0.03130974620580673, 0.02629385143518448, -0.014387699775397778, 0.002062456915155053, -0.027508225291967392, 0.04023275896906853, -0.010262785479426384, 0.06103552505373955, -0.030940154567360878, -0.010803974233567715, -0.025950659066438675, 0.03563925623893738, -0.0284586064517498, 0.007728438824415207, 0.012051348574459553, -0.023838702589273453, -0.027957016602158546, 0.02278272435069084, 0.012513338588178158, -0.03482087329030037, 0.0235747080296278, -0.014282101765275002, 0.0376456156373024, 0.01605086587369442, -0.010968971066176891, -0.013872910290956497, 0.0027785419952124357, 0.009477402083575726, -0.03215453028678894, 0.006589962635189295, 0.018664410337805748, -0.04411347955465317, -0.024155495688319206, 0.02919779159128666, -0.010130788199603558, -0.007273048162460327, 0.009985591284930706, -0.02084236592054367, -0.01619606278836727, -0.02348230965435505, -0.022135937586426735, 0.037276022136211395, -0.014612095430493355, 0.034345682710409164, -0.03651043772697449, -0.01039478275924921, 0.01990518532693386, 0.007550242356956005, -0.02263752743601799, -0.028643403202295303, -0.010493781417608261, 0.0015550925163552165, -0.004174412693828344, -0.005718780681490898, 0.018532413989305496, 0.011087768711149693, 0.05211251229047775, -0.024723084643483162, -0.005124792922288179, -0.016367658972740173, 0.03885998949408531, 0.04659502953290939, -0.0029006395488977432, -0.016341259703040123, -0.0028874396812170744, 0.009220007807016373, -0.04068155214190483, 0.0015245681861415505, -0.003682723268866539, -0.01993158459663391, -0.020525570958852768, -0.04527505487203598, -0.007999032735824585, -0.011193366721272469, 0.008797616697847843, 0.019416794180870056, -0.004610003903508186, -0.01977318711578846, 0.014453698880970478, -0.0059035769663751125, -0.001193750067614019, 0.023772703483700752, -0.03284091502428055, -0.02457788772881031, -0.017318038269877434, -0.02448548935353756, 0.030887356027960777, 0.0032702318858355284, -0.0654178336262703, -0.009365204721689224, 0.02463068626821041, -0.010995370335876942, -0.007523843087255955, -0.017463235184550285, -0.021172357723116875, -0.01618286222219467, 0.04229191690683365, 0.042819906026124954, -0.025845060124993324, -0.003969816956669092, 0.01796482503414154, -0.020565170794725418, 0.013516518287360668, -0.025277473032474518, 0.026095855981111526, 0.007022253703325987, 0.01598486676812172, 0.01607726514339447, -0.016275260597467422, -0.0031679340172559023, -0.00727964797988534, -0.0563364252448082, -0.03101935237646103, 0.018176021054387093, -0.010421182960271835, -0.059926748275756836, 0.019297996535897255, -0.010810574516654015, 0.013344921171665192, 0.0032669317442923784, 0.014070906676352024, 0.0019931583665311337, -0.019258398562669754, -0.013925709761679173, 0.03693282976746559, 0.0019519092747941613, 0.025251073762774467, -0.03365929797291756, 0.002847840543836355, 0.012684935703873634, -0.021951142698526382, -0.05118853226304054, 0.029488185420632362, 0.036140844225883484, 0.04545985162258148, 0.036378439515829086, 0.02649184688925743, 0.017463235184550285, 0.010744575411081314, -0.01994478330016136, 0.011061369441449642, -0.023218315094709396, -0.013767313212156296, -0.007068452425301075, 0.017410436645150185, 0.005718780681490898, -0.015628473833203316, -0.01694844663143158, -0.011648757383227348, -0.001335647189989686, 0.001385146053507924, -0.006068573333323002, -0.00199645827524364, -0.017674431204795837, 0.01420290395617485, -0.027745820581912994, -0.03020096942782402, 0.01079737488180399, 0.011001970618963242, -0.018677610903978348, 0.018242020159959793, -0.019575191661715508, 0.033368904143571854, 0.034372083842754364, -0.0020509071182459593, -0.0018496114062145352, -0.017542434856295586, -0.026637043803930283, -0.009899793192744255, 0.014889289624989033, 0.006395266391336918, -0.009206808172166348, -0.046753425151109695, -0.018255218863487244, -0.008104630745947361, -0.0117873540148139, -0.0059365760535001755, 0.018215620890259743, -0.02253193035721779, -0.02626745216548443, 0.0014651694800704718, -0.01368811447173357, 0.01783282868564129, 0.00847422331571579, 0.03471527621150017, -0.009655598551034927, -0.12101507186889648, -0.04139433801174164, 0.011048169806599617, 0.03170573711395264, 0.031573742628097534, -0.030385766178369522, 0.008962612599134445, -0.014849689789116383, 0.007464444264769554, -0.028907397761940956, -0.005335988476872444, -0.00795943383127451, 0.03233932703733444, 0.0374344177544117, 0.024960679933428764, -0.05290449783205986, -0.002113605849444866, -0.013021528720855713, 0.02274312637746334, -0.0076492405496537685, 0.006903456058353186, 0.004699102137237787, 0.026188254356384277, 0.06214430183172226, -0.044615067541599274, -0.017146442085504532, 0.017291639000177383, 0.005953075829893351, -0.016671251505613327, 0.01791202649474144, 0.002793391700834036, -0.0027339928783476353, 0.0054712858982384205, 0.025132276117801666, -0.02173994667828083, -0.0009495551930740476, -0.00544488662853837, -0.03194333240389824, 0.00023140767007134855, 0.0016804899787530303, 0.017172841355204582, -0.03524326533079147, 0.043875884264707565, 0.019363995641469955, 0.022479131817817688, -0.01981278695166111, 0.01778002828359604, -0.04894457757472992, -0.0004904522793367505, -0.019614791497588158, 0.0236935056746006, -0.00294848857447505, 0.009615999646484852, -0.030913755297660828, -0.01371451374143362, 0.03006897307932377, 0.0009817294776439667, 0.00013024415238760412, 0.02734982967376709, 0.020472772419452667, -0.003577125258743763, 0.04545985162258148, 0.06019074469804764, -0.011688356287777424, -0.04250311478972435, -0.029646581038832664, -0.029963374137878418, -0.00021614549041260034, 0.0003512364346534014, -0.00894941296428442, 0.009193608537316322, -0.013556117191910744, 0.009675398468971252, -0.0024716483894735575, -0.015338080003857613, -0.024340292438864708, 0.016631653532385826, 0.033527299761772156, -0.03519046679139137, 0.017568834125995636, 0.061616312712430954, -0.027851419523358345, 0.02824741043150425, 0.020221978425979614, -0.011622357182204723, 0.024287493899464607, -0.0009074810659512877, 0.0023940999526530504, -0.03490007296204567, 0.0189812034368515, 0.02917139232158661, -0.00039475425728596747, 0.006877056322991848, -0.050396550446748734, 0.01797802560031414, -0.01690884679555893, -0.01891520619392395, 0.00493009714409709, 0.025963857769966125, 0.005062094423919916, 0.02753462642431259, 0.04910297691822052, -0.019297996535897255, -0.010638978332281113, -0.023165516555309296, 0.02729703113436699, -0.00493009714409709, 0.040100764483213425, 0.019535591825842857, -0.004395508207380772, 0.0007911584689281881, -0.02251872979104519, -0.06356987357139587, 0.00850062258541584, 0.011866552755236626, 0.002163104945793748, 0.05533324554562569, 0.017542434856295586, 0.027825020253658295, -0.003577125258743763, 0.034345682710409164, 0.02272992581129074, 0.0048475987277925014, -0.004454907029867172, -0.03463607653975487, -0.03138894587755203, 0.014717692509293556, 0.009477402083575726, -0.0015361179830506444, -0.014150104485452175, -0.0015245681861415505, -0.019443193450570107, 0.02639944851398468, 0.014334901235997677, 0.01455929595977068, 0.055280447006225586, 0.033527299761772156, 0.022875122725963593, -0.04165833070874214, 0.019060403108596802, 0.0019997581839561462, 0.01232194248586893, 0.01459889579564333, 0.03600884974002838, 4.893178993370384e-05, 0.004065515007823706, -0.0012622236972674727, -0.0008678818703629076, -0.02637304924428463, 0.002339651109650731, 0.0664738118648529, 0.0026663444004952908, -0.021462751552462578, 0.0009149059187620878, -0.014770491980016232, 0.024934280663728714, 0.009002212435007095, -0.011899551376700401, -0.02081596665084362, 0.007583241909742355, 0.010355183854699135, 0.05076614022254944, 0.0032553821802139282, -0.007259848527610302, 0.009780995547771454, -0.01034858450293541, -0.01083037443459034, -0.02162114903330803, 0.022333934903144836, 0.014915688894689083, -0.014744092710316181, -0.04839019104838371, 0.028696201741695404, 0.0236275065690279, -0.0007193849887698889, 0.02074996754527092, 0.0018380616093054414, 0.022017139941453934, 0.029408985748887062, 0.025713063776493073, 0.004131513647735119, 0.02740262821316719, -0.016473256051540375, 0.013325122185051441, 0.0378040112555027, -0.021172357723116875, 0.013846511021256447, -0.0013999957591295242, 0.005553784314543009, 0.03416088595986366, 0.014546096324920654, 0.025937458500266075, -0.0053293886594474316, 0.042080722749233246, 0.021937942132353783, 0.021027160808444023, -0.03690642863512039, 0.021845543757081032, -0.006943054962903261, -0.04802059754729271, -0.016367658972740173, 0.03101935237646103, -0.005966275464743376, -0.02176634594798088, -0.013457119464874268, 0.014321701601147652, -0.006655961275100708, 0.0006430741050280631, 0.01705404371023178, -0.012011749669909477, 0.020010782405734062, -0.024010298773646355, -0.014031306840479374, 0.0283530093729496, -0.027666622772812843, -0.0011813753517344594, 0.030623361468315125, -0.009068210609257221, -0.03402889147400856, -0.01706724427640438, -0.02938258647918701, -0.019311197102069855, -0.010038390755653381, -0.01076437532901764, -0.01895480416715145, -0.002001408254727721, 0.016288459300994873, -0.010935971513390541, 0.0051445928402245045, -0.017700830474495888, -0.00898241251707077, 0.015008087269961834, -0.02168714813888073, 0.002012958051636815, -0.013351521454751492, -0.009655598551034927, 0.001859511248767376, -0.026082655414938927, 0.003620024537667632, 0.00017376200412400067, 0.021370355039834976, 0.010051590390503407, 0.008777816779911518, 0.0016095414757728577, 0.024723084643483162, -0.011892952024936676, 0.017252039164304733, 0.039942365139722824, -0.03505846858024597, -0.02630705200135708, -0.03365929797291756, 0.00901541206985712, 0.029039394110441208, 0.0013818461447954178, 0.011958950199186802, 0.013912510126829147, 0.005019195377826691, 0.06119392439723015, 0.04184312745928764, 0.01042778231203556, -0.0019172600004822016, -0.0028032914269715548, -0.012836731970310211, -0.029065793380141258, 0.004200812429189682, -0.035216864198446274, 0.001037828391417861, 0.0236935056746006, -0.015113684348762035, -0.005533984396606684, -0.02077636681497097, -0.003758621634915471, -0.0008703568601049483, 0.028062613680958748, 0.011833553202450275, -0.025026677176356316, 0.019588392227888107, -0.008883414790034294, 0.01362211536616087, 0.018479613587260246, -0.044958263635635376, -0.029461786150932312, -0.019311197102069855, -8.621070446679369e-05, 0.05876517295837402, -0.011114167980849743, 0.025805462151765823, -0.012407741509377956, 0.014400899410247803, 0.00657676300033927, 0.03315770998597145, 0.018638011068105698, -0.017186041921377182, 0.0019387095235288143, -0.018136421218514442, -0.02637304924428463, 0.009279406629502773, 0.01081717386841774, 0.009800795465707779, -0.01871720887720585, 0.027745820581912994, 0.0187700092792511, -0.01516648381948471, 0.023838702589273453, 0.003682723268866539, 0.006431565620005131, 0.021013962104916573, 0.008705218322575092, -0.02092156372964382, -0.03466247767210007, -0.016618452966213226, -0.0011483760317787528, 0.0007705339230597019, 0.023825502023100853, 0.026148654520511627, -0.007979233749210835, -0.02261112816631794, -0.019548792392015457, 0.00541518721729517, -0.0054712858982384205, -0.015773670747876167, -0.008342226035892963, 0.017304839566349983, 0.013193124905228615, -0.001004004036076367, 0.00798583310097456, -0.014968487434089184, 0.0034451282117515802, 0.02632025070488453, 0.0373816192150116, -0.011114167980849743, 0.010500380769371986, 0.017582032829523087, -0.03365929797291756, 0.007319247350096703, 0.02647864818572998, -0.024023499339818954, -0.0021235058084130287, -0.04931417107582092, -0.03363289684057236, 0.022267935797572136, -0.010579579509794712, 0.004471406806260347, -0.0009957542642951012, 0.006005874834954739, 0.010731375776231289, 0.0017390637658536434, 0.0037355220410972834, 0.004187612794339657, -0.024789083749055862, 0.08268307149410248, 0.0007078352500684559, -0.02440629154443741, 0.014414099045097828, 0.017278440296649933, 0.01589246839284897, -0.006289668846875429, -0.017766829580068588, -0.05377567932009697, -0.01135836262255907, -0.02724423073232174, 0.05786759406328201, -0.017542434856295586, -0.0004273410886526108, 0.006916655693203211, 0.007702039089053869, -0.02649184688925743, 0.028696201741695404, 0.008771217428147793, 0.016526054590940475, 0.004309710115194321, 0.0033197307493537664, -0.02729703113436699, -0.00048550235806033015, -0.010216587223112583, 0.0003151434357278049, -0.01779322884976864, 0.02063116990029812, -0.0187568087130785, 0.01704084500670433, 0.011767554096877575, -0.02275632508099079, -0.03957277536392212, -0.0054184868931770325, 0.004197512287646532, 0.003920318093150854, -0.05005335435271263, 0.007721839006990194, -0.02163434773683548, -0.008203628472983837, -0.003517726669088006, 0.013542917557060719, -0.008995612151920795, 0.00731264753267169, 0.005098393652588129, 0.02635985054075718, -0.021330755203962326, -0.002781841903924942, 0.01710684224963188, -0.0028164912946522236, 0.03276171535253525, -0.02556786686182022, 0.03856959566473961, -0.00852702185511589, -0.0063160681165754795, -0.01036838348954916, -0.012651936151087284, 0.03315770998597145, 0.01374091301113367, 0.012387941591441631, -0.03651043772697449, 0.040998343378305435, -0.017463235184550285, 0.019350796937942505, 0.008599620312452316, -0.020499171689152718, -0.014216103591024876, 0.016420457512140274, -0.014691293239593506, 0.04786220192909241, -0.04545985162258148, 0.02436669170856476, -7.857960736146197e-05, 0.01124616526067257, -0.008342226035892963, 0.01131216436624527, -0.0024600985925644636, 0.04134153574705124, -0.02558106556534767, 0.03289371356368065, -0.020472772419452667, 0.01795162633061409, 0.009517000988125801, 0.0012110747629776597, 0.010506981052458286, 0.031679339706897736, 0.019535591825842857, -0.01591886766254902, -0.02922419086098671, 0.010104388929903507, -0.017344437539577484, 0.0016441907500848174, 0.022822324186563492, -0.007451244629919529, 0.004408707842230797, -0.04218631982803345, 0.01878320798277855, -0.03270891681313515, 0.009470802731812, 0.02251872979104519, -0.010770975612103939, -0.03669523447751999, 0.04606704041361809, 0.007616240996867418, -0.04435107484459877, 0.028907397761940956, -0.03196973353624344, -0.030412165448069572, 0.004174412693828344, 0.019311197102069855, 0.0024584487546235323, -0.03965197131037712, -0.00541188707575202, 0.013991707935929298, 0.005715480539947748, 0.020987562835216522, -0.02185874432325363, 0.021515551954507828, 0.0038477196358144283, -0.05103013664484024, 0.020604770630598068, -0.01603766530752182, 0.007240049075335264, 0.010077989660203457, 0.013430720195174217, -0.02543586865067482, -0.011998550035059452, 0.012889531441032887, 0.0023825503885746002, 0.03556005656719208, -0.027930617332458496, 0.014216103591024876, 0.022149138152599335, 0.011609157547354698, 0.03400249034166336, -0.017278440296649933, -0.023455910384655, -0.008091431111097336, -0.023033520206809044, -0.008137630298733711, 0.025805462151765823, 0.007609641179442406, 0.004636403173208237, 0.029012994840741158, -0.01594526693224907, 0.011688356287777424, -0.009503801353275776, -0.02543586865067482, 0.002796691609546542, 0.013503318652510643, -0.015536075457930565, 0.002823091112077236, -0.013047927990555763, 0.037170425057411194, 0.027983415871858597, 0.008969212882220745, 0.00396321713924408, -0.021911542862653732, 0.023086318746209145, -0.015232481993734837, 0.027006637305021286, -0.026069456711411476, 0.015034486539661884, 0.005804578773677349, 0.026544645428657532, 0.006217070389539003, 0.013727713376283646, -0.024340292438864708, 0.021990740671753883, -0.017370836809277534, -0.016512855887413025, 0.03405528888106346, 0.020459573715925217, -0.026676643639802933, -0.019443193450570107, -0.009451002813875675, -0.0041084145195782185, -0.017476435750722885, -0.02748182602226734, 0.0013892709976062179, -0.006335868034511805, -0.01983918622136116, 0.03959917277097702, 0.0022670526523143053, -0.0068902564235031605, -0.014480098150670528, 0.0013999957591295242, 0.016750451177358627, 0.0050389948301017284, 0.020142780616879463, 0.011378162540495396, -0.0014206203632056713, -0.0008146705222316086, -0.002681194106116891, 0.01614326238632202, 0.010982170701026917, -0.009714997373521328, 0.010955771431326866, -0.0011450761230662465, 0.048469386994838715, 0.0009363554418087006, -0.003857619594782591, 0.03896558657288551, 0.016341259703040123, -0.012632136233150959, 0.00024357617076020688, 0.005240290891379118, -0.003923618234694004, 4.625059591489844e-05, 0.006500864401459694, -0.00853362213820219, 0.015694472938776016, 0.010110989212989807, 0.03891278803348541, 0.012038148939609528, 0.03511126711964607, 0.007853835821151733, 0.00214000535197556, -0.019337596371769905, -0.002766992198303342, -0.025198275223374367, -0.005543884355574846, -0.007418245077133179, 0.021251557394862175, -0.013965308666229248, 0.034398481249809265, -0.006811057683080435, -0.015707671642303467, -0.008461023680865765, 0.03487367182970047, 0.019284797832369804, -0.035348862409591675, 0.0018430115887895226, -0.014612095430493355, 0.01314692571759224, -0.01873040944337845, 0.008282827213406563, -0.02276952564716339, -0.030649760738015175, 0.020934762433171272, -0.024907879531383514, 0.022175537422299385, 0.02453828789293766, 0.009028611704707146, -0.03112495131790638, 0.06193310767412186, -0.0017605132889002562, 0.022056739777326584, -0.03302571177482605, 0.00399621669203043, 0.01979958638548851, 0.024049898609519005, 0.016420457512140274, -0.008197029121220112, 0.028115414083003998, -0.01979958638548851, 0.01697484590113163, -0.029514584690332413, 0.009484002366662025, 0.024987079203128815, -0.015839669853448868, -0.010295785032212734, 0.01042778231203556, 0.016262060031294823, 0.0029039394576102495, 0.021462751552462578, 0.01137156318873167, -0.008362025953829288, -0.03592965006828308, -0.020538771525025368, -0.00853362213820219, -0.0005296389572322369, -0.0016408907249569893, -0.004098514560610056, 0.011886351741850376, 0.03239212557673454, 0.01083037443459034, 0.011681756004691124, 0.024881480261683464, -0.02160794846713543, 0.056019630283117294, -0.009140809066593647, 0.005692381411790848, -0.015351279638707638, 0.00892301369458437, -0.016367658972740173, -0.026729442179203033, -0.020010782405734062, -0.012222944758832455, 0.01975998841226101, -0.03495287150144577, -0.00986679457128048, 0.019152799621224403, -0.033527299761772156, -0.028141813352704048, -0.017476435750722885, 0.011483760550618172, -0.035428062081336975, 0.01561527419835329, 0.03664243593811989, -0.009470802731812, -0.014268902130424976, 0.0035507259890437126, 0.011609157547354698, 0.03888638690114021, 0.032444924116134644, -0.015602074563503265, 0.029567383229732513, -0.016737250611186028, -0.003616724628955126, 0.0035606257151812315, 0.011127367615699768, 0.018466414883732796, 0.015839669853448868, -0.011655356734991074, 0.02563386596739292, -0.029540983960032463, 0.010843574069440365, -0.009187008254230022, 0.020063580945134163, -0.012018349021673203, 0.005939876195043325, 0.008177229203283787, 0.01784602738916874, 0.008540221489965916, -0.03276171535253525, -0.009668798185884953, 0.012968729250133038, -0.025779062882065773, -0.0028659901581704617, 0.009517000988125801, -0.023680305108428, 0.00657016271725297, -0.008791016414761543, -0.0032306325156241655, -0.0018545612692832947, 0.00399621669203043, 0.021423153579235077, 0.033474501222372055, -0.02649184688925743, 0.011912751011550426, 0.02072356827557087, -0.03490007296204567, -0.01890200562775135, -0.011186766438186169, -0.0033725297544151545, 0.01697484590113163, 0.01981278695166111, 0.0141105055809021, -0.006626261863857508, 0.0379888080060482, 0.02360110729932785, -0.02164754830300808, -0.009708397090435028, 0.03033296763896942, -0.00284949061460793, 0.014796891249716282, -0.01133196335285902, -0.036352042108774185, 0.003834520000964403, -0.024907879531383514, 0.00042775357724167407, 0.01091617252677679, 0.0015311680035665631, 0.005880477372556925, -0.022888323292136192, 0.006002574693411589, -0.03107215091586113, -0.0011087768943980336, -0.001474244287237525, 0.016248861327767372, 0.03492647036910057, 0.009055010974407196, 0.01685604825615883, -0.03286731615662575, -0.027904218062758446, -0.03302571177482605, -0.0006100747850723565, 0.03297291323542595, 0.007451244629919529, 0.0044318074360489845, -0.042899105697870255, 0.0038411198183894157, -0.013470319099724293, 0.00447800662368536, 0.020103180781006813, -0.02634664997458458, 0.03009537234902382, -0.008210228756070137]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" (2023) as using a squared error loss to
enforce the optimality conditions in Eq. (51), for settings with no intermediate potentials (ϕt(s1:t) = 1 fort < T ). Mudgal
et al. (2023) also propose two ways to use the learned ‘twists’ at inference time, which we discuss in relation to our proposed
SMC framework in App. D.1.
CD-Q The CD-Q loss from Mudgal et al. (2023) corresponds to minimizing the one-step recursion in Eq. (51) using the
expected squared error under a (possibly off-policy) sampling distribution πs. Assuming no intermediate reward and an
additional squared error loss to approximate the terminal potential ψθ
T(s1:T)≈ϕ(s1:T), we have
min
θLCD-Q(θ):= min
θT−1X
t=1Eπs(·)hX
st+1p0(st+1|s1:t)ψθ
t+1(s1:t+1)−ψθ
t(s1:t)2i
+Eπs(·)h 
ϕ(s1:T)−ψθ
T(s1:T)2i
(CD-Q)
Eq. (CD-Q) enforces the same optimality condition as the Eq. (RL Baseline) loss (i.e. ψθ
t(s1:t) =P
st+1p0(st+1|s1:t)ψθ
t+1(s1:t+1)), without log scaling of each term inside the squared error. At optimality, we have
zero-variance one-step importance weights ( w(s1:t) = 1 in Eq. (10)) for the twist-induced proposal.
At optimality, we in fact also have ψθ
t(s1:t) =P
st+1:Tp0(st+1:T|s1:t)ϕT(s1:T)(as in Eq. (51) and the proof of Prop. B.1).
CD-FUDGE While we might naively like to consider the loss Eπs(·) 
ψθ
t(s1:t)−P
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T)2
to
enforce Prop. 3.2 or Eq. (51), note that marginalization over multiple steps is not tractable in general.
Instead, the CD-FUDGE loss9defined as
min
θLCD-FUDGE(θ):= min
θTX
t=1Eπs(s1:t)
Ep0(st+1:T|s1:t)
ψθ
t(s1:t)−ϕ(s1:T)2
(CD-FUDGE)
can be shown to have the same gradient as the desired (but intractable) squared error loss above (Mudgal et al., 2023).
Since the minimizer of the expected squared error (under p0(st+1:T|s1:t)) to a single function ψθ
t(s1:t)(which is independent
ofst+1:T) is given by the conditional expectation (Banerjee et al., 2005), we can also see that Eq. (CD-FUDGE) has the
desired minimum ψθ
t(s1:t) =P
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T). Note, it is crucial that the inner expectation samples rollouts
under the base model p0(st+1:T|s1:t)to obtain the desired conditional expectation as the minimizer. While it appears that
any prefix sampling distribution can be used, πs=p0allows for losses to be calculated at all tin a single sampling run.
Mudgal et al. (2023) also propose two decoding-time usages for the learned twist functions ψθ
t: stochastic token-by-token
sampling and argmax decoding of partial sequences. We discuss their inconsistencies with our SMC framework in App. D.
CD-FUDGE for logψθ
tWe can also compare Eq. (CD-FUDGE) with the multi-step PCL loss in Eq. (50), choosing ϕt= 1
fort < T and the proposal equal to the base model q=p0so that the proposal terms cancel. Noting that ψT(s1:T) =ϕ(s1:T)
is fixed to the exact terminal potential and choosing the c=T−t+ 1-step PCL loss for each t, note that Eq. (50) would
reduce to","[0.01750628650188446, -0.012970324605703354, 0.0033654440194368362, 0.015288114547729492, -0.017333613708615303, 0.004701992031186819, 0.012937119230628014, 0.009782534092664719, -0.018741555511951447, 0.03240920975804329, 0.03373745456337929, -0.007152606267482042, -0.03780188784003258, 0.03867853060364723, 0.037775322794914246, -0.018077431246638298, 0.020667511969804764, -0.0018844493897631764, -0.007385049480944872, 0.023496676236391068, -0.01605849713087082, -0.02487805299460888, -0.02705637738108635, 0.04978267103433609, -0.0069666518829762936, -0.029912106692790985, 0.030337145552039146, -0.0020189343485981226, 0.033976539969444275, -0.002722904784604907, 0.04242418706417084, -0.029460502788424492, -0.047551218420267105, -0.060142990201711655, -0.008015966042876244, 0.055945735424757004, -0.01879468560218811, 0.04298204928636551, -0.027069659903645515, 0.003589585656300187, -0.01152917742729187, -0.08591096848249435, -0.023430263623595238, 0.030284015461802483, 0.047126177698373795, 0.00784329418092966, 0.006485162302851677, 0.025316374376416206, 0.0069865756668150425, 0.038598835468292236, -0.014185670763254166, 0.05034053325653076, -0.010194290429353714, -0.02292553149163723, -0.014544297009706497, 0.0013855269644409418, -0.019897129386663437, -0.015314679592847824, 0.035623565316200256, -0.020162777975201607, 0.03788158297538757, -0.012113606557250023, 0.0008235126733779907, -0.02173011004924774, 0.007856576703488827, -0.016164757311344147, -0.035225093364715576, 0.06104619801044464, -0.02625942975282669, 0.0798010379076004, -0.02054796926677227, 0.000794042251072824, 0.006807262077927589, -0.0019790870137512684, 0.015487351454794407, -0.025582022964954376, 0.0261000394821167, 0.0438055619597435, 0.008547265082597733, -0.05018114298582077, 0.03387027978897095, -0.041441284120082855, 0.014464601874351501, -0.033578068017959595, -0.00359622691757977, -0.04412434250116348, -0.03458753228187561, 0.030044931918382645, -0.03304676711559296, -0.011489330790936947, 0.002058781683444977, 0.007318636868149042, -0.03081531450152397, 0.002483820542693138, 0.05700832977890968, 7.870896661188453e-05, 0.04218510165810585, -0.006647872738540173, 0.030868444591760635, -0.0042005786672234535, 0.026870422065258026, -0.03565013036131859, 0.006179665680974722, -0.02649851329624653, 0.058124057948589325, -0.006657834630459547, -0.029247982427477837, 0.020787054672837257, -0.06115245819091797, -0.009417266584932804, -0.004353327210992575, -0.029008898884058, -0.06471215933561325, 0.030177755281329155, 0.02463896945118904, -0.044974420219659805, -0.05334237217903137, 0.019843999296426773, -0.03325928747653961, 0.004549243487417698, -0.041308458894491196, -0.019246289506554604, 0.04040525108575821, -0.00640878826379776, 0.015168572776019573, -0.0015200118068605661, 0.0119276512414217, -0.08846120536327362, -0.010347038507461548, 0.017267201095819473, 0.0021152321714907885, 0.0373237207531929, -0.004881305154412985, -0.0037058070302009583, -0.007345201913267374, 0.014291930012404919, -0.008235126733779907, 0.021026138216257095, 0.00076706224353984, -0.007378408219665289, 0.004721915349364281, -0.029805846512317657, -0.03246233984827995, 0.011369788087904453, -0.02216843143105507, 0.007856576703488827, -0.033578068017959595, 0.008527341298758984, -0.03105439804494381, -0.007212377153337002, -0.022553622722625732, -0.012312843464314938, -0.049702975898981094, -0.00010563708929112181, -0.016443688422441483, -0.03604860603809357, -0.007199095096439123, 0.05493626743555069, 0.022420797497034073, -0.04547915235161781, -0.00840779859572649, 0.04154754430055618, -0.018064148724079132, -0.021464459598064423, 0.045505717396736145, -0.01370750181376934, -0.03201073408126831, 0.05172191187739372, -0.05955856293439865, -0.03538447991013527, 0.01210696529597044, -0.04816221073269844, -0.017386743798851967, -0.05807092785835266, 0.0085207000374794, -0.025064008310437202, -0.010287267155945301, -0.07400988042354584, -0.012013987638056278, -0.020003389567136765, -0.007258865982294083, 0.05384710431098938, 0.009344212710857391, -0.008965662680566311, 0.0069799344055354595, -0.0069732931442558765, -0.0003150434058625251, 0.028583860024809837, 0.030469970777630806, 0.004522678442299366, -0.022898966446518898, 0.05193442851305008, 0.0761350765824318, -0.030762184411287308, -0.05320954695343971, 0.012591774575412273, 0.07485996186733246, 0.06120558828115463, 0.036951810121536255, -0.0003333068161737174, 0.005751306656748056, 0.039794258773326874, 0.003931608982384205, -0.038731660693883896, 0.004379892256110907, -0.022208277136087418, -0.038598835468292236, 0.00392164709046483, -0.07932286709547043, 0.024824922904372215, 0.0057247416116297245, 0.003244241466745734, 0.045797932893037796, 0.01601864956319332, -0.03867853060364723, 0.034268755465745926, -0.03376401960849762, 0.0028773134108632803, -0.013933303765952587, 0.05748650059103966, 0.02190278097987175, 0.00784329418092966, 0.04946389049291611, 0.014265364967286587, -0.03355150297284126, -0.008786349557340145, -0.02048155851662159, -0.0076108514331281185, 0.03591578081250191, -0.005299702752381563, 0.042796093970537186, -0.002010632771998644, -0.03190447762608528, -0.008089019916951656, 0.002184965182095766, 0.004934434778988361, -0.015699870884418488, -0.008314821869134903, -0.022075453773140907, -0.06306513398885727, -0.01250543911010027, 0.006275963503867388, 0.022646598517894745, -0.04720587283372879, -0.018090713769197464, 0.039661433547735214, -0.02807912603020668, -0.025980496779084206, 0.017559416592121124, 0.018688425421714783, 0.002910519717261195, 0.03543761000037193, -0.0015714813489466906, 0.024333471432328224, -0.0639152079820633, 0.003699166001752019, 0.05642390251159668, 0.006634590215981007, -0.03323272243142128, 0.006322452332824469, 0.012877347879111767, -0.021398046985268593, -0.03360462933778763, 0.01588582620024681, -0.0196580458432436, -0.011987422592937946, -0.017466438934206963, -0.044310297816991806, 0.051323436200618744, -0.020003389567136765, -0.011436200700700283, 0.0026581529527902603, -0.02425377629697323, 0.06789994984865189, 0.029726151376962662, -0.041706934571266174, -0.0047119539231061935, 0.0425570122897625, -0.03557043522596359, 0.044841594994068146, -0.01403956301510334, -0.046462055295705795, 0.037509676069021225, 0.0209464430809021, 0.009775892831385136, -0.005349511746317148, 0.0020670832600444555, 0.035729825496673584, -0.016310865059494972, -0.04802938550710678, -0.025781260803341866, -0.02372247911989689, 0.022819271311163902, -0.03294050693511963, 0.005332909058779478, 0.034667227417230606, -4.6877754357410595e-05, -0.021676979959011078, 0.012558568269014359, 0.02441316656768322, 0.03634081780910492, -0.004257029388099909, -0.030443405732512474, 0.019897129386663437, -0.002429030369967222, 0.011296735145151615, 0.01605849713087082, 0.008421081118285656, -0.018515752628445625, -0.020627664402127266, -0.022898966446518898, -0.025754695758223534, -0.02632584236562252, 0.003413592930883169, 0.010366962291300297, -0.042397622019052505, 0.03557043522596359, -0.026750879362225533, 0.009822381660342216, -0.05328924208879471, -0.014225517399609089, -0.007059629075229168, -0.026485230773687363, -0.020441710948944092, 0.006246078293770552, -0.042796093970537186, -0.028982333838939667, -0.005684894043952227, -0.021092550829052925, 0.00202391529455781, 0.012259713374078274, -0.011907728388905525, 0.012963683344423771, 0.002545251976698637, -0.04959671571850777, -0.04611670970916748, -0.024293623864650726, 0.03843944892287254, 0.015912391245365143, 0.00230782781727612, -0.05103122070431709, 0.01410597562789917, -0.020893314853310585, -0.03891761600971222, 0.012538645416498184, 0.011369788087904453, 0.022354384884238243, 0.013866891153156757, 0.08548592776060104, 0.023204462602734566, -0.02005651965737343, -0.036287687718868256, 0.03849257901310921, -0.012664828449487686, 0.057327110320329666, 0.006239437032490969, -0.045771367847919464, -0.025422634556889534, -0.0639152079820633, -0.0064253914169967175, -0.021092550829052925, -0.019233006983995438, 0.04606357961893082, 0.004977602977305651, 0.01608506217598915, 0.03418906033039093, 0.00976261030882597, -0.011569024994969368, -0.00020318017050158232, -0.028397906571626663, -0.020162777975201607, 0.006388864479959011, -0.027972867712378502, 0.022898966446518898, -0.05870848521590233, 0.0012493816902861, -0.00041300157317891717, 0.01267146971076727, 0.06917506456375122, -0.010034901089966297, 0.0004337554273661226, -0.021398046985268593, -0.01438490767031908, -0.01014116033911705, 0.0170414000749588, -0.008998868986964226, 0.013123073615133762, -0.0025767977349460125, -0.0061697037890553474, -0.0027046415489166975, 0.0015731416642665863, -0.02025575563311577, -0.029752716422080994, 0.024785075336694717, -0.03429532051086426, 0.007790164556354284, 0.001731701078824699, 0.05897413566708565, 0.0553613044321537, 0.06253383308649063, -0.038306623697280884, 0.004034548066556454, -0.06752803921699524, -0.034135930240154266, -0.05780527740716934, -0.02554217539727688, 0.04013960435986519, 0.013853608630597591, -0.004884625785052776, 0.04502755030989647, 0.0451338104903698, -0.02130507118999958, 0.027335308492183685, -0.018343081697821617, 0.023363852873444557, -0.08585783839225769, 0.03453440219163895, 0.002057121368125081, 0.059346042573451996, 0.04757778346538544, -0.00936413649469614, -0.03108096309006214, -0.001540765748359263, -0.006229475140571594, -0.02401469275355339, 0.01652338355779648, 0.045665107667446136, -0.006740849930793047, 0.028822943568229675, -0.05347519740462303, 0.04037868604063988, 0.05674268305301666, 0.03676585853099823, -0.018688425421714783, -0.04508068040013313, -0.008925815112888813, -0.009032074362039566, -0.020627664402127266, -0.04412434250116348, -0.06067429110407829, -0.01714766025543213, 0.02001667208969593, 0.024360036477446556, -0.006305849179625511, -0.018714990466833115, 0.0329139418900013, -0.007783523295074701, -0.03570326045155525, 0.008713295683264732, -0.0009629785781726241, 0.026046909391880035, -0.01945880800485611, 0.06689048558473587, -0.01389345619827509, -0.030310580506920815, -0.04420403763651848, 0.09233967959880829, 0.0020438390783965588, 0.025117136538028717, -0.03511883318424225, 0.035623565316200256, -0.006893598008900881, 0.00763077475130558, 0.008713295683264732, 0.006289246026426554, 0.03485318273305893, 0.0553613044321537, 0.021756675094366074, -0.0026299275923520327, 0.021783238276839256, -0.018515752628445625, -0.02616645209491253, 0.03174508735537529, 0.015434222295880318, -0.018489187583327293, 0.01750628650188446, 0.04635579511523247, -0.023509958758950233, 0.031266916543245316, -0.02269972860813141, 0.03557043522596359, 0.000441226817201823, 0.022673163563013077, 0.014796664007008076, 0.006807262077927589, 0.08394516259431839, 0.05573321506381035, -0.015553764067590237, -0.008035889826714993, 0.019565068185329437, 0.02354980632662773, -0.05172191187739372, -0.0005553729715757072, -0.014956053346395493, -0.004439663141965866, -0.049304503947496414, 0.02523667924106121, 0.018847815692424774, -0.034401580691337585, -0.008255050517618656, 0.04229136183857918, 0.04199914634227753, 0.0034999288618564606, 0.0521203838288784, 0.032063864171504974, 0.028238516300916672, 0.019246289506554604, 0.004555884748697281, 0.005638405680656433, 0.02048155851662159, -0.018276669085025787, 0.005668290890753269, -0.028929203748703003, -0.007351843174546957, -1.569509731780272e-05, 0.02361621893942356, -0.025754695758223534, -0.00503737386316061, 0.005160236731171608, 0.02996523678302765, -0.005030732601881027, -0.014823228120803833, -0.016722621396183968, 0.001005316385999322, 0.007318636868149042, -0.017665674909949303, -0.02372247911989689, -0.13760632276535034, -0.04423060268163681, -0.048746638000011444, 0.00936413649469614, -0.01275116391479969, 0.029354242607951164, 0.017665674909949303, -0.02632584236562252, 0.008713295683264732, -0.037084635347127914, -0.0006616326863877475, 0.0001333434775006026, -0.0054756952449679375, 0.005807756911963224, -0.023642783984541893, -0.01975102163851261, 0.013295745477080345, 0.014863075688481331, -0.00824176799505949, 0.008965662680566311, -0.024001410230994225, -0.02523667924106121, 0.002030556555837393, 0.02394828014075756, -0.011794826947152615, -0.021849650889635086, -0.01988384686410427, -0.01721407100558281, -0.0037423339672386646, 0.008500776253640652, 0.011170551180839539, -0.005791153758764267, 0.004801610484719276, 0.023098202422261238, -0.023138049989938736, 0.005518863443285227, -0.014690403826534748, -0.008480852469801903, 0.007052987813949585, 0.03137317672371864, 0.031001267954707146, 0.005741344764828682, 0.03652677312493324, -0.04096311703324318, 0.003725730814039707, 0.029354242607951164, -0.05015458166599274, -0.02556874044239521, -0.020136212930083275, 0.020494841039180756, -0.008168715052306652, -0.02365606650710106, 0.0027793552726507187, -0.02328415773808956, -0.018276669085025787, 0.01959163323044777, -0.03286081179976463, -0.03198416903614998, 0.021517589688301086, -0.0037556164897978306, -0.002334392862394452, -0.0034169135615229607, 0.011754979379475117, 0.016855444759130478, -0.010931466706097126, -0.04229136183857918, -6.802073767175898e-05, -0.03891761600971222, 0.014371625147759914, -0.004589091055095196, 0.02392171509563923, -0.02672431617975235, -0.013010172173380852, 0.026631338521838188, 0.004904549568891525, 0.009915358386933804, -0.006790658924728632, -0.03910357132554054, 0.04848099127411842, -0.034667227417230606, 0.031931038945913315, 0.03514539822936058, 0.01608506217598915, 0.03934265673160553, 0.028105691075325012, 0.0074116140604019165, -0.01065253559499979, -0.014398190192878246, -0.027468133717775345, 0.03198416903614998, -0.012027270160615444, 0.05222664400935173, -0.0013332272646948695, -0.00948367826640606, -0.04059120640158653, 0.0359954759478569, -0.04925137385725975, 0.012976965866982937, 0.003875158494338393, -0.018515752628445625, -0.010287267155945301, 0.003128020092844963, 0.0016030272236093879, -0.020640946924686432, 0.018515752628445625, -0.009025433100759983, 0.013010172173380852, 0.019233006983995438, -0.01199406385421753, 0.010061465203762054, -0.005379397422075272, 0.013375439681112766, -0.038864485919475555, 0.012976965866982937, 0.010340397246181965, -0.014331777580082417, -0.0267641618847847, 0.01906033419072628, -0.0025900802575051785, -0.012837500311434269, 0.03583608567714691, -0.026618055999279022, -0.03472035750746727, -0.015567046590149403, -0.020362015813589096, 0.03373745456337929, -0.017612546682357788, 0.03947547823190689, -0.01817040890455246, -0.004655503202229738, 0.0038120667450129986, -0.002661473583430052, -0.017625827342271805, -0.0322498194873333, -0.004107601474970579, 0.0010285606840625405, -0.009609862230718136, 0.006382223218679428, 0.03907700628042221, 0.012279637157917023, 0.03527821972966194, -0.019100181758403778, -0.011715131811797619, -0.021597284823656082, 0.03769563138484955, 0.007551080081611872, -0.0010576160857453942, -0.014185670763254166, -0.016244452446699142, -0.0170812476426363, -0.04622296988964081, -0.010393527336418629, -0.00512703089043498, -0.012618339620530605, -0.013169561512768269, -0.030310580506920815, -0.010008336044847965, -0.0177055224776268, 0.0025170266162604094, 0.032223254442214966, -0.00797611940652132, -0.016310865059494972, 0.020029954612255096, -0.01438490767031908, 0.015208420343697071, 0.04019273445010185, -0.051057785749435425, -0.012013987638056278, -0.028557294979691505, -0.03023088537156582, 0.011077574454247952, 0.011954216286540031, -0.0293011125177145, -0.010380244813859463, 0.01225307211279869, -0.014889640733599663, -0.0014369965065270662, -0.022314537316560745, -0.025621870532631874, -0.02794630266726017, 0.033285852521657944, 0.025289809331297874, -0.026910269632935524, 0.005578634329140186, 0.002198247704654932, -0.011396353133022785, 0.0009065280901268125, -0.010406809858977795, 0.016310865059494972, 0.0061132535338401794, -0.010406809858977795, 0.013880173675715923, -0.006873674690723419, 0.010320473462343216, -0.016337430104613304, -0.06024925038218498, -0.019804151728749275, 0.0028075806330889463, -0.007345201913267374, -0.04465563967823982, 0.03650020807981491, 0.008002683520317078, 0.01754613406956196, -0.007119399961084127, 0.02507729083299637, 0.007278789766132832, -0.01939239539206028, -0.013368799351155758, 0.05156252160668373, -0.004811572376638651, 0.014663838781416416, -0.018409494310617447, -0.005957184825092554, 0.02388186752796173, 0.0023725798819214106, -0.041175633668899536, 0.017360178753733635, 0.030762184411287308, 0.042238231748342514, 0.02421393059194088, 0.02768065221607685, -0.006182986311614513, 0.009370777755975723, 0.0005030732718296349, 0.0119276512414217, -0.05206725373864174, -0.0006421240395866334, 0.0030383632984012365, 0.018940791487693787, 0.00854062382131815, 0.006392185110598803, -0.018130561336874962, -0.016297582536935806, 0.009543449617922306, -0.011635437607765198, -0.02034873329102993, 0.017811782658100128, -0.044708769768476486, -0.009045356884598732, -0.024360036477446556, -0.019631480798125267, 0.023775609210133553, 0.016164757311344147, -0.006076726596802473, 0.02279270626604557, -0.013056661002337933, 0.047949690371751785, 0.05748650059103966, -0.01648353599011898, 0.011867880821228027, -0.030177755281329155, -0.04218510165810585, -0.03381714969873428, 0.0069865756668150425, -0.01030719093978405, 0.005306344013661146, -0.03689868003129959, -0.03511883318424225, -0.013375439681112766, -0.021251941099762917, -0.003685883479192853, -0.01113070361316204, -0.03259516507387161, -0.02354980632662773, -0.004589091055095196, -0.003413592930883169, 0.0312137883156538, -0.007039705291390419, 0.02150430716574192, -0.007059629075229168, -0.14483197033405304, -0.014836510643362999, 0.009032074362039566, 0.03679242357611656, 0.013348875567317009, -0.010293908417224884, 0.007922989316284657, -0.0031263597775250673, 0.03309989720582962, -0.011801468208432198, -0.015912391245365143, 0.000936413649469614, 0.016337430104613304, 0.029673021286725998, 0.039687998592853546, -0.04561197757720947, -0.0034733640495687723, -0.005840963218361139, -0.0028075806330889463, -0.006438673939555883, -0.01030719093978405, 0.016895292326807976, 0.010028259828686714, 0.04670114070177078, -0.02517026662826538, -0.020853467285633087, 0.0029138403479009867, 0.011343223042786121, -0.007644057273864746, 0.008972303941845894, 0.017811782658100128, -0.002429030369967222, 0.015208420343697071, 0.03240920975804329, -0.021158963441848755, 0.01321605034172535, -0.0028955768793821335, -0.007830011658370495, -0.005146954208612442, 0.006554895546287298, 0.02226140722632408, -0.03875822573900223, 0.07358484715223312, 0.01810399629175663, 0.007756958249956369, -0.024851487949490547, 0.015155290253460407, -0.023244310170412064, -0.001255192793905735, -0.04627609997987747, 0.005193443037569523, 0.01075215358287096, -0.018741555511951447, -0.027361873537302017, 0.004433021880686283, -0.002844107337296009, 0.011329940520226955, 0.007139323744922876, -0.0048381369560956955, 0.029221419245004654, -0.014371625147759914, 0.041441284120082855, 0.05246572941541672, -0.0167093388736248, -0.04194601625204086, -0.019830716773867607, -0.03352493792772293, -0.011788185685873032, 0.02143789455294609, -0.0006412939401343465, 0.000271667871857062, -0.019365830346941948, 0.0072920722886919975, 0.011137344874441624, -0.0009646388934925199, -0.006090009119361639, -0.002639889484271407, 0.03458753228187561, -0.04101624712347984, 0.0036759215872734785, 0.031240353360772133, -0.016828879714012146, 0.04199914634227753, 0.01952522061765194, -0.012120247818529606, 0.023695914074778557, -0.0257281307131052, 0.004369930364191532, -0.03620799258351326, 0.004350006580352783, 0.02084018476307392, -0.0005865037674084306, 0.014836510643362999, -0.026697751134634018, -0.0039050441700965166, -0.016722621396183968, -0.008467569947242737, -0.0019259571563452482, 0.04449624940752983, 0.023018507286906242, 0.029194854199886322, 0.026936834678053856, -0.017599264159798622, -0.006013635080307722, 0.007092835381627083, 0.01985728181898594, -0.024293623864650726, 0.0393160916864872, 0.02232781983911991, -0.0028490882832556963, -0.007033064030110836, -0.0315856970846653, -0.04460250958800316, -0.0041374871507287025, 0.018954074010252953, 0.0036493567749857903, 0.0315856970846653, 0.02425377629697323, 0.02117224596440792, -0.0025220075622200966, 0.02392171509563923, 0.01592567376792431, 0.012731241062283516, 0.01734689623117447, -0.0424773171544075, -0.02378889173269272, 0.01342856977134943, 0.01539437472820282, -0.01174169685691595, 0.002362617990002036, 0.015195137821137905, 0.0016603078693151474, 0.02216843143105507, 0.010831848718225956, 0.008381234481930733, 0.03867853060364723, 0.014942770823836327, -0.005190122406929731, -0.028530729934573174, 0.02768065221607685, 0.0005059788236394525, 0.009682915173470974, 0.02305835485458374, 0.02457255683839321, 0.010479862801730633, -0.006827185861766338, 0.00632577296346426, 0.008819554932415485, -0.025528892874717712, 0.015367809683084488, 0.02021590806543827, 0.002261339221149683, -0.007962836883962154, 0.0011871200986206532, -0.03052309900522232, 0.011290093883872032, -0.009311006404459476, -0.02619301714003086, -0.006445315200835466, 0.008168715052306652, 0.024798357859253883, 0.042796093970537186, -0.0006288415752351284, -0.012120247818529606, 0.007338560651987791, -0.01271795853972435, -0.04194601625204086, -0.003176169004291296, -0.013129714876413345, 0.01267146971076727, 0.0034301960840821266, -0.05493626743555069, 0.0209464430809021, 0.030868444591760635, 0.028451034799218178, 0.013680936768651009, -0.005571993067860603, 0.024001410230994225, 0.022620033472776413, 0.001540765748359263, 0.008739860728383064, 0.02850416488945484, -0.016271017491817474, 0.02203560620546341, 0.029805846512317657, -0.012996889650821686, 0.03025745041668415, -0.016363995149731636, -0.007072911597788334, 0.028105691075325012, 0.007033064030110836, 0.027972867712378502, 0.012186659500002861, 0.042796093970537186, 0.013461776077747345, 0.05320954695343971, -0.02190278097987175, 0.035225093364715576, -0.024891335517168045, -0.03918326646089554, -0.033312417566776276, 0.0386519655585289, -0.002382541773840785, -0.026976682245731354, -0.021344918757677078, 0.010273984633386135, -0.012007346376776695, -0.005000847391784191, 0.02738843858242035, -0.0030715696047991514, 0.031532566994428635, -0.009423907846212387, -0.0021036099642515182, 0.019697891548275948, -0.020999573171138763, -0.034507837146520615, 0.0360751673579216, -0.01639055833220482, -0.048773203045129776, -0.013242615386843681, -0.024785075336694717, -0.03565013036131859, 0.0001038730115396902, -0.014809946529567242, -0.03509226813912392, -0.00870665442198515, 0.015567046590149403, -0.0057446653954684734, 0.00526981707662344, -0.0031711880583316088, -0.019100181758403778, 0.0034800053108483553, -0.026378970593214035, 0.005658328998833895, -0.029885541647672653, 0.0012460610596463084, 0.011728414334356785, -0.025847673416137695, 0.012558568269014359, -0.014491166919469833, 0.02246064506471157, 0.008912532590329647, -0.013906738720834255, -0.011688567698001862, 0.01652338355779648, 0.011223681271076202, 0.026750879362225533, 0.031665392220020294, -0.03299363702535629, -0.030151190236210823, -0.020733924582600594, 0.020176060497760773, 0.0119276512414217, -0.015487351454794407, -0.008779708296060562, 0.05068587884306908, 0.009045356884598732, 0.056370772421360016, 0.06428711861371994, 0.012246430851519108, -0.013973151333630085, 0.016762468963861465, -0.0012684752000495791, -0.014531014487147331, 0.011887804605066776, -0.032223254442214966, -0.006505086086690426, 0.016510101035237312, -0.020826902240514755, 0.005236610770225525, 0.013016813434660435, -0.01250543911010027, 0.010951390489935875, 0.04848099127411842, 0.024466296657919884, -0.005674932152032852, 0.01628430001437664, -0.013255897909402847, -0.012943760491907597, -0.0028773134108632803, -0.029752716422080994, -0.027109507471323013, -0.013468417339026928, -0.011276811361312866, 0.03636738285422325, -0.009390701539814472, 0.01876812055706978, -0.007577645126730204, 0.034507837146520615, 0.0034866465721279383, 0.012432385236024857, 0.011628796346485615, -0.0263922531157732, -0.0010011655976995826, -0.005379397422075272, -0.02623286470770836, 0.007989400997757912, 0.009855587035417557, -0.021955911070108414, -0.01575300097465515, 0.003685883479192853, 0.017134377732872963, -0.007232300937175751, -0.0030516458209604025, 0.01086505502462387, -0.005279778968542814, 0.004316800273954868, 0.027627522125840187, -0.011124062351882458, -0.016470253467559814, -0.005263175815343857, 0.001392168109305203, -0.011137344874441624, 0.03201073408126831, 0.04531976208090782, -0.006578139960765839, -0.021716827526688576, -0.00976261030882597, 0.012359331361949444, 0.010181007906794548, -0.0020870070438832045, -0.02554217539727688, 0.025980496779084206, 0.012332767248153687, -0.01846262253820896, 0.012120247818529606, 0.006146459840238094, -0.012020628899335861, 0.012824217788875103, 0.02765408717095852, -0.0006504256161861122, 0.003875158494338393, 0.014172388240695, -0.022646598517894745, 0.005312985274940729, 0.029088594019412994, -0.022407514974474907, -0.0017815103055909276, -0.011774903163313866, -0.025183549150824547, 0.0031595658510923386, -0.005359473638236523, -0.0076042101718485355, -0.0009314327035099268, -0.02154415473341942, 0.018077431246638298, -0.0022364347241818905, -0.0015640100464224815, 0.004356647841632366, -0.02372247911989689, 0.07268163561820984, -0.005465733353048563, -0.013501623645424843, 0.011635437607765198, 0.021265223622322083, 0.007318636868149042, -0.013986433856189251, -0.014637273736298084, -0.039661433547735214, -0.013322310522198677, -0.03944891318678856, 0.05068587884306908, -0.022752858698368073, 0.0014826549449935555, 0.02996523678302765, -0.0005794474272988737, -0.04720587283372879, 0.015527199022471905, -0.006096650380641222, 0.010997879318892956, 0.008792990818619728, -0.01734689623117447, -0.009496960788965225, 0.0012734561460092664, -0.007232300937175751, -0.0021152321714907885, -0.014743533916771412, 0.006109932903200388, -0.020694077014923096, 0.013142997398972511, 0.006378902588039637, -0.017333613708615303, -0.04096311703324318, -0.011117421090602875, 0.0017765293596312404, -0.020375298336148262, -0.041308458894491196, 0.008387875743210316, -0.011914369650185108, -0.009875510819256306, -0.014185670763254166, -0.01721407100558281, -0.0005366945406422019, -0.017825065180659294, -0.0014560900162905455, 0.0029769320972263813, -0.023563088849186897, -0.0003447214257903397, 0.02154415473341942, 0.0238553024828434, 0.02123865857720375, -0.018117278814315796, 0.015806131064891815, -0.012591774575412273, -0.012512080371379852, 0.008235126733779907, -0.009237952530384064, 0.03392340987920761, 0.021876215934753418, -0.018064148724079132, -0.03203729912638664, 0.03501257300376892, -0.00015866316971369088, 0.02425377629697323, 0.010227496735751629, -0.01921972446143627, 0.008201920427381992, 0.021092550829052925, -0.004638900049030781, 0.04245075210928917, -0.01777193509042263, 0.02196919359266758, 0.0016669491305947304, -0.004313479643315077, 0.002722904784604907, -0.010267343372106552, -0.026684468612074852, 0.0360751673579216, -0.010625970549881458, 0.029938671737909317, -0.007816729135811329, 0.005027411971241236, 0.01608506217598915, 0.01492948830127716, 0.0074116140604019165, 0.03889105096459389, -0.0003036287962459028, -0.011841315776109695, -0.03092157281935215, 0.02303178980946541, -0.024532709270715714, 0.0011447822907939553, 0.029088594019412994, -0.004250388126820326, 0.00013759802095592022, -0.045771367847919464, 0.0328342467546463, -0.03185134753584862, 0.017320331186056137, 0.01955178566277027, -0.011648720130324364, -0.01859544776380062, 0.047816865146160126, 0.011695208959281445, -0.04356647655367851, 0.0007446481031365693, -0.02335057035088539, -0.03700494021177292, 0.0170414000749588, 0.02570156566798687, -0.0038054257165640593, -0.02625942975282669, 0.016988269984722137, 0.002966970205307007, 0.002674755873158574, 0.019910411909222603, -0.017227353528141975, 0.03785501793026924, 0.006538292393088341, -0.026697751134634018, 0.01605849713087082, 0.002789317164570093, 0.02612660452723503, 0.00461565563455224, -0.005890772212296724, 0.004313479643315077, -0.021783238276839256, -0.002875653328374028, -0.0009123391937464476, 0.037509676069021225, -0.028132256120443344, 0.017320331186056137, 0.013016813434660435, -0.00802924856543541, -0.000427529274020344, -0.02014949545264244, -0.005014129914343357, -0.002261339221149683, -0.017931325361132622, 0.00953016709536314, 0.010798642411828041, 0.009012151509523392, -0.014663838781416416, 0.023934997618198395, -0.014451319351792336, 0.025874238461256027, -0.01136314682662487, -0.023563088849186897, 0.0016636284999549389, 0.016244452446699142, -0.0026498513761907816, 0.014730251394212246, 0.010964673012495041, 0.03214355930685997, 0.01511544268578291, -0.009350853972136974, -0.00018605825607664883, -0.019511938095092773, 0.027893172577023506, -0.0012975306017324328, 0.017253918573260307, -0.01585926115512848, -0.016178039833903313, 0.02345682866871357, 0.0334983728826046, 0.011396353133022785, 0.0032010735012590885, -0.020308885723352432, -0.00929772388190031, -0.011635437607765198, -0.0099950535222888, 0.016005367040634155, 0.00830818060785532, -0.020787054672837257, -0.02781347744166851, -0.020029954612255096, 0.002369259251281619, -0.009570014663040638, -0.0231911800801754, 0.007763599511235952, -0.0045193578116595745, -0.025409352034330368, 0.03867853060364723, 0.029513632878661156, -0.0088527612388134, 0.004442983772605658, 0.012033911421895027, 0.013787196017801762, 0.03373745456337929, -0.0032027338165789843, 0.007391690742224455, -0.006013635080307722, -0.008122226223349571, 0.0031960925552994013, 0.009689556434750557, -0.0023460150696337223, -0.0013191145844757557, -0.005867527797818184, -0.008089019916951656, 0.038731660693883896, -0.006458597723394632, -0.023045072332024574, 0.015009183436632156, 0.004442983772605658, -0.010273984633386135, -0.019604915753006935, -0.00026232865639030933, -0.02130507118999958, 0.005548748653382063, 0.008381234481930733, 0.008162073791027069, 0.004728556610643864, 0.021783238276839256, 0.04601045325398445, 0.0238553024828434, 0.022141866385936737, 0.019286135211586952, -0.008015966042876244, -0.016735903918743134, -0.015845978632569313, -0.02372247911989689, -0.005332909058779478, 0.0006018616259098053, 0.03036371059715748, -0.036287687718868256, 0.013083226047456264, 0.027627522125840187, -0.0015797829255461693, 0.012917195446789265, 0.025754695758223534, 0.013840326108038425, -0.02368263155221939, -0.003237600438296795, -0.02527652680873871, 0.019113464280962944, -0.011416276916861534, 0.021331636235117912, -0.014663838781416416, -0.019086899235844612, -0.005684894043952227, -0.023908432573080063, 0.0014602408045902848, 0.02645866572856903, 0.007365125697106123, 0.0002469707978889346, 0.06827186048030853, -0.013866891153156757, 0.007311995606869459, -0.020428428426384926, -0.01295040175318718, 0.015965519472956657, 0.02130507118999958, 0.016231169924139977, -0.03365775942802429, 0.027574392035603523, -0.016842162236571312, 0.024864770472049713, -0.04832160100340843, 0.03294050693511963, 0.029115159064531326, -0.019764304161071777, 0.008334745652973652, 0.006578139960765839, 0.0006935935816727579, -0.008879326283931732, 0.021530872210860252, -0.01377391442656517, -0.006634590215981007, -0.041972581297159195, -0.004947717301547527, -0.023045072332024574, -0.00735848443582654, -0.002198247704654932, -0.0020870070438832045, -0.0030300619546324015, 0.023337287828326225, 0.02269972860813141, 0.013242615386843681, 0.004841457586735487, -0.021398046985268593, 0.06019612029194832, -0.013528188690543175, -0.0036493567749857903, 0.0008542283903807402, 0.010699023492634296, -0.011296735145151615, -0.027574392035603523, 0.014876358211040497, -0.0036460361443459988, 0.0075975689105689526, -0.008879326283931732, -0.013129714876413345, -0.004472869448363781, -0.04133502393960953, -0.04011303931474686, -0.02969958633184433, 0.014982618391513824, -0.04205227643251419, 0.013069943524897099, 0.02503744326531887, -0.018143843859434128, 0.0013614523923024535, -0.01621788740158081, 0.011250246316194534, 0.03320615738630295, 0.008746501989662647, -0.02130507118999958, 0.03445470705628395, -0.008733219467103481, 0.008042531087994576, 0.009968488477170467, -0.0016885331133380532, 0.03745654597878456, -0.006256040185689926, -0.027840042486786842, 0.019777586683630943, -0.009423907846212387, 0.017293766140937805, -0.024120952934026718, 0.015845978632569313, -0.01465055625885725, 0.001622120733372867, 0.011628796346485615, 0.031160658225417137, 0.02450614422559738, -0.01985728181898594, -0.0115955900400877, -0.017253918573260307, -0.021743392571806908, -0.022221559658646584, 0.024227213114500046, -0.016629643738269806, -0.011914369650185108, 0.014703686349093914, 0.00034928726381622255, 0.014198953285813332, 0.007378408219665289, 0.02263331599533558, 0.02781347744166851, -0.02927454747259617, 0.02054796926677227, -0.00790970679372549, -0.035862650722265244, -0.02005651965737343, -0.03756280615925789, 0.012186659500002861, 0.004579129163175821, 0.02725561335682869, -0.010958031751215458, -0.012160094454884529, 0.04152097925543785, 0.014159105718135834, -0.02263331599533558, -0.004748480394482613, 0.004751801025122404, 0.0024140875320881605, 0.023629501461982727, -0.024107670411467552, -0.011137344874441624, 0.00017028531874530017, -0.005840963218361139, -0.005166877992451191, -0.01281757652759552, 0.007531156297773123, 0.007258865982294083, 0.005688214674592018, -0.012512080371379852, -0.018555600196123123, -0.01767895743250847, -0.006352338008582592, -0.007703828625380993, 0.028982333838939667, 0.019233006983995438, -0.0033272569999098778, -0.023709196597337723, -0.0022314537782222033, -0.02603362686932087, -0.001458580489270389, 0.033153027296066284, 0.01925957202911377, 0.006372261792421341, -0.029487067833542824, 0.008514058776199818, -0.017878195270895958, 0.011774903163313866, 0.0033654440194368362, -0.01281757652759552, 0.02985897660255432, 0.0023808814585208893]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"P
tE[ 
logϕ(s1:T) + 0−logψθ
t(s1:t)−02]. Deng & Raffel (2023) optimize this loss with reweighting of terms
based on timestep (higher weight for t≈T). Eq. (CD-FUDGE) optimizes the squared error of the difference without log
scaling of each term , under appropriate sampling of rollouts.10
9Note, we reserve the naming convention FUDGE (Yang & Klein, 2021) for a binary cross entropy loss described in App. C.4, as
opposed to the CD-FUDGE squared error loss from Mudgal et al. (2023).
10Note the difference in choice of proposal between Eq. (CD-Q) (twist-induced q=qπ
t) and Eq. (CD-FUDGE) (base q=p0).
27
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
C.3. SIXO: Smoothing Inference with Twisted Objectives (Lawson et al., 2022)
Lawson et al. (2022) adopt a noise-contrastive estimation loss (Gutmann & Hyv ¨arinen, 2010) to learn the target twist
functions using binary classification. For state space models, Lawson et al. (2022) adopt our setting in App. B.2 with
observation variables otemitted based on the sampling state s1:t(or simply st) and a known likelihood ϕt(ot, st) =σ(ot|st).
As discussed in App. B.4, in these settings with easily evaluable intermediate potentials , it may be preferable to parameterize
Φθ
t(s1:t,ot+1:T)as in Eq. (Twist Targets ( Φ) ). Lawson et al. (2022) indeed use this parameterization (see their Eq. 5).
Recall from Eq. (39) that the optimal twists or future values amount to conditional likelihoods,
Φ∗
t(s1:t,ot+1:T)ot+1:T∝σ(ot+1:T|s1:t), ψ∗
t(s1:t,ot:T)ot:T∝σ(ot:T|s1:t), (52)
whereo∝denotes proportionality up to a constant which depends on oonly. Using Bayes rule, we have
σ(ot+1:T|s1:t) =σ(s1:t|ot+1:T)σ(ot+1:T)
p0(s1:t)ot+1:T∝σ(s1:t|ot+1:T)
p0(s1:t), σ (ot:T|s1:t)ot:T∝σ(s1:t|ot:T)
p0(s1:t), (53)
noting that σ(ot+1:T)andp0(s1:t)are marginals of σ(s1:t,ot+1:T)by definition. The above reasoning suggests that we
may learn the twists, or likelihood ratio Φ∗
t(s1:t,ot+1:T)∝σ(ot+1:T|s1:t)∝σ(s1:t|ot+1:T)/p0(s1:t), using a classifier
which seeks to distinguish samples from σ(s1:t|ot+1:T)andp0(s1:t)(Gutmann & Hyv ¨arinen, 2010; Lawson et al., 2022).
In particular, at each t, we classify the event y= 1, indicating that s1:t∼σ(s1:t|ot+1:T), ory= 0, indicating that
s1:t∼p0(s1:t).
Consider a given ot+1:T, which can be either ot+1:T=1in the unconditional case or ot+1:T∼πs(ot+1:T)drawn from a
behavioral policy as discussed below. The SIXO loss becomes
LSIXO(o1:T;θ) =T−1X
t=1Eσ(s1:t|ot+1:T)h
logsigmoid 
logΦθ
t(s1:t,ot+1:T)i
+Ep0(s1:t)h
log 
1−sigmoid 
logΦθ
t(s1:t,ot+1:T)i
=TX
t=1Eσ(s1:t|ot:T)h
logsigmoid 
logψθ
t(s1:t,ot:T)i
+Ep0(s1:t)h
log 
1−","[0.00600286852568388, -0.015904976055026054, 0.006685410160571337, 0.0013677089009433985, -0.027945715934038162, 0.009485581889748573, 0.0025446561630815268, 0.021435314789414406, 0.002975182607769966, 0.013930855318903923, 0.025201546028256416, -0.0079874899238348, -0.0027336678467690945, -0.006835919339209795, 0.030521873384714127, 0.017389066517353058, 0.03242598846554756, 0.012047739699482918, -0.046762868762016296, 0.03183795511722565, -0.0484989769756794, -0.041862569749355316, -0.02087528072297573, 0.01885915733873844, 0.00022838902077637613, -0.018551139160990715, 0.037046272307634354, -0.011480704881250858, 0.03637423366308212, 0.0034442113246768713, 0.05107513442635536, -0.0310819074511528, -0.02912178821861744, -0.03844635933637619, -0.01189372967928648, 0.036094214767217636, 0.01936318911612034, 0.05020708218216896, 0.010066618211567402, 0.01409186515957117, 0.004172256216406822, -0.05692749470472336, -0.026993656530976295, 0.023745456710457802, 0.020175239071249962, 0.012131744995713234, 0.033854078501462936, 0.012733781710267067, 0.0007923611556179821, 0.04623083770275116, -0.01189372967928648, 0.02041325345635414, -0.013314817100763321, 0.013538830913603306, -0.027035659179091454, 0.013132805936038494, -0.020833278074860573, 0.01978321373462677, 0.029625818133354187, -0.02713366597890854, 0.01402186043560505, -0.020511258393526077, 0.02846374735236168, 0.0070669339038431644, 0.0017439820803701878, -0.002873676363378763, -0.05519138649106026, 0.0550793819129467, 0.013608835637569427, 0.06916424632072449, -0.002437899587675929, -0.011382699012756348, 0.02536955662071705, 0.008323511108756065, 0.02581758424639702, 0.0070879352279007435, 0.029177790507674217, 0.05029108747839928, 0.01954519934952259, -0.05051510035991669, 0.030353862792253494, -0.007945487275719643, 0.017501074820756912, -0.028057722374796867, 0.011816725134849548, -0.046146832406520844, -0.04998306930065155, -0.022765398025512695, -0.060539714992046356, -0.029065784066915512, -0.011578710749745369, 0.018579140305519104, -0.02042725309729576, -0.021029289811849594, 0.05393131077289581, -0.012229750864207745, 0.02531355433166027, 0.029149789363145828, 0.01022762805223465, -0.026993656530976295, 0.00810649711638689, -0.024123480543494225, 0.0519711896777153, 0.0003826172323897481, 0.023017412051558495, 0.01321681123226881, -0.04197457432746887, -0.021197300404310226, -0.02686764858663082, 0.010787662118673325, -0.009359574876725674, -0.007126437500119209, -0.0315859392285347, 0.025383558124303818, 0.015946978703141212, -0.055891431868076324, -0.03603821247816086, -0.0003653349122032523, -0.006051871459931135, -0.028617756441235542, -0.0502350814640522, -0.04231059551239014, 0.004980805795639753, 0.01688503660261631, 0.01670302450656891, 0.003015435067936778, -0.016731027513742447, -0.07207642495632172, 0.01625499688088894, 0.011389698833227158, 0.0043647680431604385, 0.01842513121664524, -0.013286815024912357, -0.03357405960559845, 0.0010675655212253332, 0.022275367751717567, 0.004938803147524595, 0.059195633977651596, -0.0011996986577287316, 0.009128560312092304, -0.007129937410354614, -0.0193351861089468, -0.04905901104211807, 0.0005429708398878574, -0.019685208797454834, 0.009989612735807896, -0.03763430938124657, 0.013692840002477169, -0.03150193393230438, 0.017067046836018562, -0.022387374192476273, -0.052307210862636566, -0.03435811027884483, 0.017823094502091408, 0.002082627732306719, -0.03533816710114479, -0.006909423973411322, 0.06109974905848503, -0.004280762746930122, -0.031165912747383118, -0.01663302071392536, 0.04194657504558563, 0.027441684156656265, 0.008988551795482635, 0.0533432736992836, 0.01663302071392536, -0.024823524057865143, 0.013510828837752342, -0.053679294884204865, -0.04908701404929161, 0.026111602783203125, -0.03214597329497337, -0.026335615664720535, -0.028813768178224564, -0.00011085836740676314, -0.036542244255542755, -0.00977960042655468, -0.07986090332269669, -0.025663575157523155, -0.013622836209833622, -0.01958720199763775, 0.020133236423134804, -0.024263489991426468, 0.009905608370900154, -0.0008343636873178184, -0.00645089615136385, 0.012383759953081608, 0.01887315884232521, 0.03659824654459953, 0.016100987792015076, 0.0027861709240823984, 0.046118829399347305, 0.08238105475902557, -0.006783416494727135, -0.03883838281035423, 0.01909717172384262, 0.05841158330440521, 0.0654120147228241, 0.03192196041345596, 0.014700902625918388, -0.00857552606612444, 0.0333220437169075, -0.021183300763368607, -0.06950026750564575, -0.019153175875544548, 0.012250752188265324, -0.01715105213224888, 0.002219136105850339, -0.07913285493850708, 0.012866789475083351, 0.025733578950166702, -0.0038187343161553144, 0.031165912747383118, 0.0004930927534587681, -0.023717455565929413, 0.01953119784593582, -0.03979044035077095, -0.013090803287923336, -0.025719579309225082, 0.07252445071935654, -0.009086557663977146, 0.04049048572778702, 0.02578958310186863, 0.0015540954191237688, -0.022947408258914948, 0.015932977199554443, 0.03357405960559845, -0.024067476391792297, 0.02996183931827545, -0.014301877468824387, 0.031893957406282425, 0.006261884234845638, -0.04225459322333336, -0.024347493425011635, 0.025845585390925407, -0.02020324021577835, -0.018397128209471703, -0.011473704129457474, -0.028351740911602974, -0.045390784740448, -0.020805276930332184, 0.0024816524237394333, 0.01423887349665165, -0.03315403312444687, -0.0020493757911026478, 0.03637423366308212, -0.02248537912964821, 0.015890974551439285, 0.001058814930729568, -0.02266739122569561, 0.017683085054159164, 0.00878553930670023, 0.019923223182559013, -0.009905608370900154, -0.04905901104211807, -0.028603754937648773, 0.028785767033696175, -0.00327445100992918, -0.046986885368824005, 0.038138341158628464, 0.05423932895064354, -0.031417928636074066, -0.04718289524316788, 0.027469685301184654, -0.045194774866104126, -0.01754307746887207, -0.004994806367903948, -0.028337739408016205, 0.02996183931827545, -0.031641941517591476, -0.009436579421162605, 0.01624099723994732, -0.0409105122089386, 0.04530677944421768, 0.018299123272299767, -0.04197457432746887, 0.012691779062151909, 0.0319499596953392, -0.011746721342206001, 0.015428947284817696, -0.030045844614505768, -0.028057722374796867, 0.04707089066505432, -0.005918863229453564, 0.011970735155045986, -0.024529505521059036, -0.0029086784925311804, 0.026265611872076988, -0.023941470310091972, -0.0395384281873703, -0.002002122811973095, -0.026629634201526642, 0.009016552940011024, -0.00182011176366359, -0.00471478933468461, 0.03752230107784271, 0.008848543278872967, -0.030577877536416054, 0.015904976055026054, 0.011389698833227158, 0.03267800435423851, -0.03822234645485878, -0.05449134483933449, 0.02200935035943985, -0.0029296798165887594, 0.027217671275138855, 0.026573630049824715, 0.00017785467207431793, 0.0013694590888917446, -0.019181177020072937, -0.014952917583286762, -0.015414945781230927, -0.012194748036563396, 0.037242285907268524, -0.02221936360001564, -0.010696656070649624, 0.03841835632920265, 0.03645823895931244, 0.02066526748239994, -0.0519711896777153, -0.015316939912736416, -0.03648623824119568, -0.018537137657403946, 0.008911547251045704, 0.014189871028065681, 0.00038239845889620483, -0.029597816988825798, 0.001975871156901121, -0.008302509784698486, 0.016507012769579887, -0.001561970915645361, -0.028785767033696175, -0.012257752008736134, -0.004980805795639753, -0.0502350814640522, -0.044578734785318375, -0.01976921409368515, 0.06193980202078819, 0.021869342774152756, 0.01797710359096527, -0.08882144838571548, 0.009730597026646137, -0.02359144762158394, -0.060539714992046356, -0.011641714721918106, 0.0036227223463356495, 0.03220197558403015, 0.012628775089979172, 0.06087573617696762, 0.028295736759901047, -0.00043708932935260236, -0.04113452509045601, 0.017431069165468216, 0.016367005184292793, 0.03805433586239815, -0.016044985502958298, -0.031165912747383118, -0.041778564453125, -0.05295125022530556, 0.001541844685561955, -0.018845155835151672, -0.03629022836685181, 0.04289863258600235, 0.013468826189637184, 0.031669944524765015, 0.01189372967928648, 0.03040986694395542, 0.006160377990454435, 0.01222275011241436, -0.029625818133354187, -0.003815234173089266, 0.01640900783240795, -0.045670803636312485, -0.0014307127567008138, -0.04295463487505913, -0.00539033068343997, 0.0004318389983382076, 0.03270600736141205, 0.03872637823224068, 0.01087866723537445, -0.0009450580109842122, 0.0006864796159788966, -0.023619448766112328, 0.00043883942998945713, -0.013601834885776043, 0.00999661348760128, 0.01667502336204052, -0.010927670635282993, -0.00594686483964324, -0.0019443692872300744, 0.036150217056274414, -0.02154732309281826, -0.010416639037430286, 0.04110652208328247, -0.01099067460745573, -0.03178194910287857, 0.015666961669921875, 0.08383714407682419, 0.03161393851041794, 0.028561752289533615, -0.05670348182320595, -0.022499380633234978, -0.06552401930093765, -0.027385680004954338, -0.07129237800836563, -0.04023846983909607, 0.030185852199792862, 0.0073784529231488705, 0.011732719838619232, 0.05216720327734947, 0.041918572038412094, -0.018495135009288788, 0.025061538442969322, -0.0184671338647604, -0.0173470638692379, -0.05496737360954285, 0.04564280062913895, 0.017921099439263344, 0.04312264546751976, 0.05513538420200348, -0.01345482561737299, -0.009058555588126183, 0.025439562276005745, -0.0023276428692042828, -0.028505750000476837, 0.0019408691441640258, 0.04116252809762955, -0.0032411988358944654, 0.053231265395879745, -0.05202719196677208, 0.022723395377397537, 0.04564280062913895, 0.01887315884232521, -0.034778133034706116, -0.05874760448932648, -0.024837523698806763, 0.012677778489887714, 0.0059783668257296085, -0.004046248272061348, -0.05468735471367836, -0.030353862792253494, 0.03180995211005211, 0.016072986647486687, 0.004735790658742189, -0.01201273687183857, 0.035674188286066055, -0.010311632417142391, -0.011151684448122978, 0.01757107861340046, -0.029681822285056114, 0.017949102446436882, 0.025397559627890587, 0.03528216481208801, -0.03091389685869217, 0.005197818856686354, -0.04088250920176506, 0.07095635682344437, -0.007756475824862719, 0.049003008753061295, -0.048750992864370346, -0.005722851026803255, -0.011711718514561653, -0.01818711683154106, -0.009268568828701973, 0.013083803467452526, 0.036318227648735046, 0.0706203356385231, -0.02514554373919964, -0.014378882944583893, 0.04939503222703934, -0.019209178164601326, -0.028113724663853645, 0.04217058792710304, -0.025957593694329262, -0.0012592022540047765, 0.017067046836018562, 0.03690626472234726, 0.00628638593479991, 0.030521873384714127, -0.03979044035077095, -0.007560464087873697, -0.005103313364088535, -0.002674164017662406, 0.0035492179449647665, 0.01089966855943203, 0.06126775965094566, 0.050599105656147, -0.04292663559317589, -0.052111197263002396, 0.009499583393335342, -0.007252444978803396, -0.05530339479446411, 0.012166746892035007, -0.017179055139422417, 0.0364302359521389, -0.010619651526212692, -0.019279183819890022, -0.012943794019520283, -0.005922363605350256, -0.028841769322752953, 0.05958765745162964, 0.014574894681572914, 0.009842604398727417, 0.0516071692109108, 0.03290202096104622, 0.0022121358197182417, -0.021687330678105354, 0.0003638035850599408, -0.030045844614505768, 0.055639415979385376, 0.014273876324295998, 0.010584649629890919, -0.02664363570511341, 0.002023124136030674, -0.007595465984195471, 0.009072557091712952, -0.04071449860930443, -0.00809949729591608, -0.0006366015877574682, 0.0009144311188720167, -0.03648623824119568, -0.023899467661976814, -0.011242689564824104, -0.02490752935409546, 0.0029086784925311804, -0.019237181171774864, -0.009625590406358242, -0.11301493644714355, -0.04273062199354172, -0.04558679834008217, 0.012026738375425339, -0.04096651449799538, 0.010738658718764782, 0.016521014273166656, -0.029877834022045135, 0.008092496544122696, -0.030941899865865707, -0.016563016921281815, -0.017683085054159164, 0.005316826514899731, -0.008260507136583328, -0.01021362654864788, -0.014770906418561935, 0.033238038420677185, 0.019811216741800308, 0.0024501504376530647, 0.010311632417142391, -0.007854482159018517, -0.02112729661166668, 0.03133392333984375, 0.023605449125170708, -0.0097585991024971, -0.028547752648591995, -0.023955469951033592, -0.012299754656851292, 0.01818711683154106, 0.020175239071249962, 0.02934580110013485, -0.009471581317484379, 0.03713027760386467, 0.02441749908030033, -0.038362354040145874, 0.007966488599777222, -0.001677477965131402, -0.00899555254727602, 0.002541156020015478, 0.023465439677238464, 0.00809949729591608, 0.030381863936781883, 0.03377007320523262, -0.055667415261268616, 0.018803153187036514, 0.0208892822265625, -0.01909717172384262, -0.031053906306624413, -0.021827340126037598, 0.05017907917499542, -0.019251180812716484, -0.01421787217259407, -0.02534155547618866, -0.03136192634701729, -0.020735273137688637, -0.00809949729591608, -0.023675452917814255, -0.05264323204755783, 0.01775308884680271, 0.006226882338523865, 0.015498951077461243, -0.024081477895379066, 0.007931486703455448, 0.03623422235250473, -0.0378023199737072, -0.0017798591870814562, -0.007581465411931276, -0.018719149753451347, -0.010703656822443008, 0.013755843974649906, -0.0005105938180349767, -0.008043494075536728, 0.0024466500617563725, 0.006338889244943857, -0.010416639037430286, 0.026167606934905052, -0.021953348070383072, -0.04891900345683098, 0.028981778770685196, -0.03407809138298035, 0.04110652208328247, 0.03217397630214691, 0.009065556339919567, 0.027371680364012718, 0.021281305700540543, 0.0004563404945656657, -0.017641082406044006, -0.010857666842639446, -0.026713639497756958, 0.02602759748697281, -0.00734345056116581, 0.05085112154483795, -0.021071292459964752, -0.004014746285974979, -0.04317865148186684, 0.05244721844792366, -0.012845788151025772, 0.01131969504058361, 0.02802972123026848, -0.03511415421962738, -0.020721271634101868, 0.01468690112233162, 0.012586772441864014, -0.045474790036678314, 0.0026654135435819626, -0.014602895826101303, 0.005866359919309616, -0.0024886527098715305, -0.00655940268188715, -0.021183300763368607, 0.011536708101630211, 0.014490889385342598, -0.03517016023397446, 0.027847709134221077, 0.018271122127771378, -0.005743852350860834, -0.027203669771552086, 0.046314842998981476, 0.009268568828701973, -0.021883342415094376, 0.04362667724490166, -0.03357405960559845, -0.004011246375739574, -0.00020137173123657703, -0.006566402968019247, 0.028953777626156807, -0.02181333862245083, 0.05185918137431145, -0.030493872240185738, -0.0012259501963853836, -0.011816725134849548, -0.003836235497146845, -0.038558367639780045, -0.01245376467704773, 0.015190931968390942, 0.020371250808238983, -0.011214688420295715, 0.00488980021327734, 0.03623422235250473, -0.011389698833227158, 0.016941038891673088, 0.0034442113246768713, -0.023731457069516182, -0.012397760525345802, 0.06535600870847702, 0.012117743492126465, -0.005558341275900602, -0.002518404508009553, 0.0010448141256347299, -0.0012364508584141731, -0.07050833106040955, -0.02066526748239994, 0.02177133597433567, -0.030493872240185738, -0.038558367639780045, -0.0222613662481308, -0.034134093672037125, 0.003374207066372037, 0.0029314300045371056, 0.022513382136821747, -0.015484950505197048, -0.019867219030857086, 0.0021421315614134073, -0.005981867201626301, -0.008890545926988125, 0.030801890417933464, -0.03528216481208801, 0.009975612163543701, -0.0228774044662714, -0.030745886266231537, 0.03329404443502426, -0.006338889244943857, -0.03172594681382179, -0.0017212306847795844, 0.01912517473101616, -0.035870201885700226, -0.02996183931827545, -0.04130253568291664, -0.012250752188265324, 0.004469774197787046, 0.038166344165802, 0.03197796270251274, -0.02041325345635414, -0.013328817673027515, -0.009912608191370964, -0.017921099439263344, 0.0033777072094380856, -0.025901589542627335, 0.028603754937648773, 0.014798908494412899, 0.005484836641699076, 0.008603528141975403, -0.013755843974649906, 0.013160808011889458, -0.021407313644886017, -0.05339927598834038, -0.01820111647248268, 0.008967550471425056, -0.03396608307957649, -0.05381930246949196, 0.012502767145633698, -0.006891923025250435, -0.0029366803355515003, -0.012390760704874992, 0.026489626616239548, -0.001853363704867661, -0.006072872783988714, 0.003976244013756514, 0.051019132137298584, 0.010500644333660603, 0.01800510473549366, -0.019433192908763885, -0.0114387022331357, 0.008701534010469913, -0.01954519934952259, -0.030381863936781883, 0.024781521409749985, 0.04446673020720482, 0.023269427940249443, 0.018117111176252365, 0.039202407002449036, 0.009828602895140648, -0.015358942560851574, 0.001268827822059393, 0.012684778310358524, -0.03267800435423851, -0.0003734291822183877, 0.006380891427397728, 0.01323781255632639, 0.010724658146500587, 0.0010194375645369291, -0.023661451414227486, -0.010451641865074635, 0.008470519445836544, 0.006881422363221645, -0.007385453209280968, 0.012936794199049473, -0.03783032298088074, -0.00018441757129039615, -0.020945286378264427, 0.003829234978184104, 0.009436579421162605, 0.009884607046842575, 0.006622406654059887, -0.004172256216406822, -0.02268139272928238, 0.03662624955177307, 0.05037509277462959, -0.001744857057929039, -0.0024536505807191133, -0.006114875432103872, -0.034134093672037125, -0.0346941277384758, 0.01758508011698723, 0.0007376702851615846, 0.019657205790281296, -0.03130592033267021, -0.033462055027484894, -0.006065872497856617, -0.0006177879404276609, -0.010983673855662346, 0.01409886498004198, -0.04049048572778702, -0.013832849450409412, 0.003498464822769165, -0.014063863083720207, 0.004739291034638882, -0.0013957106275483966, 0.008610528893768787, -0.023465439677238464, -0.1263437569141388, -0.02581758424639702, 0.019181177020072937, 0.008925547823309898, 0.009856604970991611, -0.019671207293868065, 0.014028861187398434, -0.015582956373691559, 0.01155770942568779, -0.003888738574460149, 0.004361267667263746, -0.04267461970448494, 0.01801910623908043, 0.05715150758624077, 0.04460673779249191, -0.042534612119197845, 0.025593571364879608, 0.022583385929465294, -0.005652846768498421, -0.004917801823467016, -0.004732290282845497, 0.029457807540893555, 0.0034809636417776346, 0.06126775965094566, -0.03659824654459953, 0.014588895253837109, 0.017487073317170143, 0.017431069165468216, 0.029205791652202606, 0.008645530790090561, -0.020735273137688637, -0.0195171982049942, 0.048806995153427124, 0.029009779915213585, -0.002696915529668331, 0.005131314974278212, -0.008876544423401356, -0.004574780818074942, -0.012425762601196766, 0.025957593694329262, 0.015568955801427364, -0.07129237800836563, 0.08271707594394684, -0.0007914860616438091, 0.014812909066677094, -0.004658786114305258, 0.011081679724156857, -0.027273673564195633, -0.0017894848715513945, -0.038334351032972336, 0.01468690112233162, 0.027735702693462372, -0.0032674504909664392, -0.03542217239737511, 0.0013055801391601562, 0.010465642437338829, 0.018397128209471703, -0.005796355661004782, 0.005078811664134264, -0.005365829449146986, -0.030045844614505768, 0.003470462979748845, 0.04533478245139122, -0.019195178523659706, -0.03791432827711105, -0.017487073317170143, -0.031417928636074066, -0.00040777501999400556, -0.00749746011570096, -0.040770500898361206, 0.023857465013861656, -0.024319492280483246, -0.009772599674761295, 0.0073994542472064495, 0.012201748788356781, -0.010766660794615746, 0.004445272963494062, 0.0017212306847795844, -0.028295736759901047, -0.00010861604096135125, 0.03844635933637619, -0.04107852280139923, 0.03617822006344795, 0.041638556867837906, -0.006296886596828699, 0.03130592033267021, -0.019853219389915466, 0.020763274282217026, -0.015512951649725437, 0.02576158195734024, 0.03043786808848381, 0.001860364223830402, 0.002602409804239869, -0.0404064804315567, 0.009205564856529236, -0.0222613662481308, -0.0315859392285347, 0.0013493328588083386, 0.034806136041879654, 0.021393312141299248, 0.018817154690623283, 0.03970643877983093, -0.01803310588002205, 0.002961181802675128, -0.007896484807133675, 0.04158255085349083, 0.011592711322009563, 0.03934241458773613, 0.02359144762158394, -0.042814627289772034, -0.005124314688146114, -0.039678435772657394, -0.035870201885700226, 0.0020721270702779293, 0.013328817673027515, -0.02536955662071705, 0.03575819358229637, 0.03360206261277199, 0.026783643290400505, -0.017445070669054985, 0.020805276930332184, 0.021015290170907974, 0.0010885668452829123, 0.005530339200049639, -0.010465642437338829, -0.02599959634244442, -0.0016109738498926163, 0.00305568752810359, -0.012915792874991894, 0.0207072701305151, 0.0169130377471447, -0.012348758056759834, 0.017921099439263344, 0.015456948429346085, -0.01715105213224888, 0.02843574434518814, 0.021197300404310226, -0.015582956373691559, 0.0013764594914391637, 0.034750133752822876, 0.007924485951662064, -0.028589755296707153, 0.009919608943164349, 0.0189011599868536, 0.013986858539283276, 0.009989612735807896, 0.020077232271432877, -0.01892916113138199, -0.018523136153817177, -0.015176931396126747, 0.03068988397717476, -0.003633223008364439, -0.0328180156648159, 0.019041169434785843, -0.014672900550067425, 0.008057494647800922, -0.005323826801031828, -0.009023553691804409, -0.02996183931827545, 0.014434886164963245, 0.024543507024645805, 0.03561818599700928, 0.011172685772180557, -0.009037554264068604, 0.030297858640551567, -0.023381434381008148, -0.018089110031723976, -0.017249058932065964, 0.006839419715106487, 0.009597589261829853, -0.02353544533252716, -0.028561752289533615, 0.012705779634416103, 0.02023124136030674, 0.0014884663978591561, 0.0052538225427269936, -0.002213885774835944, 0.04219859093427658, 0.0024536505807191133, 0.007052932865917683, 0.02312942035496235, 0.003367206547409296, -0.03979044035077095, 0.015666961669921875, 0.05107513442635536, -0.023395435884594917, 0.0003430210635997355, 0.01146670337766409, 0.010430640541017056, 0.05505137890577316, -0.014714903198182583, 0.02177133597433567, 0.005908362567424774, 0.04908701404929161, 0.008743536658585072, 0.044354721903800964, -0.015890974551439285, 0.020385250449180603, -0.022373372688889503, -0.029849832877516747, -0.020273244008421898, -0.013517829589545727, 0.0005521588609553874, -0.01887315884232521, -0.041470546275377274, 0.008540524169802666, -0.026097601279616356, -0.017935100942850113, 0.024263489991426468, -0.0043892692774534225, 0.01619899459183216, 0.015274937264621258, -0.009415578097105026, 0.027105662971735, -0.025733578950166702, -0.02713366597890854, 0.035702191293239594, -0.004893300123512745, -0.040798503905534744, -0.008596527390182018, -0.012425762601196766, -0.044998761266469955, 0.014203871600329876, -0.0013493328588083386, -0.019237181171774864, -0.021841339766979218, 0.032986026257276535, 0.005453334655612707, -0.016296999529004097, 0.010745659470558167, -0.01087866723537445, 0.009254568256437778, -0.02332543209195137, 0.0024116479326039553, 0.016759028658270836, -0.001100817578844726, 0.0019443692872300744, -0.022541383281350136, -0.0022453877609223127, 0.0035439676139503717, 0.002640912076458335, 0.020315246656537056, 0.0005403456743806601, -0.006237383000552654, 0.02018923871219158, -0.015624959021806717, 0.02357744798064232, 0.031165912747383118, -0.014161868952214718, -0.01713705249130726, -0.004508276470005512, 0.028617756441235542, 0.022751396521925926, -0.0095415860414505, -0.0027494188398122787, 0.016100987792015076, -0.006356390193104744, 0.06524400413036346, 0.038530364632606506, 0.0195171982049942, -0.006706411484628916, 0.024753518402576447, -0.023297429084777832, -0.010045616887509823, 0.014308878220617771, -0.0350581519305706, 0.016114989295601845, 0.009835603646934032, -0.015932977199554443, 0.010136622004210949, -0.01757107861340046, -0.008967550471425056, 0.027203669771552086, 0.03329404443502426, 0.03351805731654167, -0.01736106537282467, 0.0233114305883646, 0.0018498635618016124, 0.0077704768627882, 0.029933836311101913, -0.007700472604483366, -0.02402547374367714, 0.005138315260410309, -0.0026496625505387783, 0.03197796270251274, 0.0020336247980594635, 0.018369127064943314, -0.010150622576475143, 0.023395435884594917, 0.015918977558612823, 0.029877834022045135, 0.02290540561079979, -0.037046272307634354, -0.010619651526212692, 0.003510715439915657, -0.018299123272299767, 0.002539405832067132, 0.015064924955368042, -0.01199173554778099, -0.0030259357299655676, 0.007973489351570606, 0.024053476750850677, -0.00987760629504919, -0.007182440720498562, -0.0010745659237727523, 0.019279183819890022, 0.003388207871466875, 0.016282999888062477, -0.02202335186302662, -0.019601203501224518, -0.00258140848018229, 0.0020336247980594635, 0.01596098020672798, 0.03687826171517372, 0.037886325269937515, -0.0024746519047766924, -0.026139603927731514, -0.005852359347045422, 0.013209810480475426, 0.006804417818784714, 0.006016869097948074, -0.005537339951843023, 0.014854911714792252, 0.010647653602063656, -0.012544769793748856, -0.0015129678649827838, 0.016268998384475708, -0.02198134921491146, 0.0022243864368647337, 0.023619448766112328, 0.008743536658585072, 0.014630897901952267, 0.0032762009650468826, -0.04373868554830551, 0.0055233389139175415, 0.01712305098772049, 0.0011935732327401638, 0.004595782142132521, -0.03315403312444687, -0.011305693536996841, -0.0008894921047613025, -0.002259388566017151, 0.004420771263539791, -0.018061108887195587, 0.009226566180586815, 0.004410270601511002, -0.023605449125170708, 0.007164939772337675, 0.02042725309729576, -0.027259673923254013, 0.07885283976793289, -0.003151943441480398, -0.017655083909630775, 0.0018481133738532662, -0.011872728355228901, 0.0013204560382291675, -0.002227886812761426, 0.0073994542472064495, -0.028519749641418457, 0.008946549147367477, -0.024123480543494225, 0.05885961279273033, -0.040546488016843796, 0.003013684879988432, 0.04707089066505432, 0.013468826189637184, -0.0023503941483795643, 0.02996183931827545, -0.006093874108046293, 0.011627713218331337, 0.010367636568844318, -0.009604589082300663, -0.025453561916947365, 0.008827541954815388, -0.01887315884232521, 0.005579342599958181, -0.03407809138298035, 0.008484520949423313, -0.006321387831121683, 0.03435811027884483, 0.005208319518715143, -0.017711086198687553, -0.04172256216406822, 0.0007311073713935912, 0.008463519625365734, 9.904514445224777e-05, -0.04905901104211807, 0.005806856323033571, -0.024991534650325775, -0.005999368149787188, -0.029149789363145828, -0.005180317908525467, -0.0133358184248209, 0.0020493757911026478, 0.005558341275900602, 0.027469685301184654, 0.009618590585887432, 0.018523136153817177, 0.004308764357119799, 0.00478129368275404, 0.023465439677238464, -0.026559630408883095, 0.017291061580181122, -0.024613510817289352, 0.010080618783831596, 0.016549015417695045, -0.027623696252703667, 0.02956981398165226, 0.01468690112233162, 0.002070377115160227, -0.024935530498623848, 0.03637423366308212, -0.02982182987034321, 0.05202719196677208, 0.01643700897693634, -0.037466298788785934, -0.00014230560918804258, 0.03662624955177307, -0.007413454819470644, 0.02976582758128643, -0.0012268252903595567, 0.026979655027389526, -0.011018676683306694, -0.00032267606002278626, -0.006247883662581444, 0.025677576661109924, -0.02931779995560646, 0.06104374676942825, -0.023241426795721054, 0.05575142055749893, -0.0251175407320261, 0.03178194910287857, 0.010339634492993355, 0.009653592482209206, 0.028533751145005226, 0.02508953958749771, -0.011312694288790226, -0.0078124795109033585, -0.018131112679839134, 0.004847797565162182, -0.017515074461698532, 0.013657838106155396, 0.021925345063209534, -0.007840481586754322, -0.010185625404119492, -0.009975612163543701, 0.027007658034563065, -0.04471874609589577, -0.007073934189975262, 0.02843574434518814, -0.003211447037756443, -0.0391744039952755, 0.050571102648973465, 0.04555879533290863, -0.005722851026803255, -0.005372829735279083, -0.04138654097914696, -0.004956304095685482, 0.010479643009603024, 0.021603325381875038, 0.0036577244754880667, -0.012019737623631954, 0.004952804185450077, 0.017025044187903404, 0.017907099798321724, 0.04446673020720482, -0.02130930870771408, 0.006688910536468029, 0.012250752188265324, -0.04029447212815285, 0.019391190260648727, -0.0338260754942894, 0.02646162360906601, -0.01423887349665165, 0.002021373948082328, 0.004007745999842882, -0.027035659179091454, 0.0024554007686674595, -0.01733306422829628, 0.04007045924663544, 0.0032709508668631315, 0.019293183460831642, 0.0019863718189299107, -0.01842513121664524, 0.012579771690070629, 0.006321387831121683, 0.01799110509455204, 0.0016713525401428342, -0.030157851055264473, 0.001011562068015337, 0.01367183867841959, 0.017837094143033028, 0.001351082930341363, 0.02420748583972454, -0.01010862085968256, -0.009695595130324364, -0.0042212591506540775, -0.02843574434518814, 0.016395006328821182, 0.006303886882960796, 0.020357249304652214, -0.0002176696143578738, -0.0028334239032119513, 0.025187546387314796, 0.03284601494669914, 0.009611589834094048, 0.0019863718189299107, -0.045474790036678314, 0.015596956945955753, -0.007931486703455448, 0.031193913891911507, -0.005908362567424774, -0.003734729252755642, 0.026167606934905052, 0.024529505521059036, 0.008323511108756065, -0.012369759380817413, -0.03175394982099533, 0.011102681048214436, -0.011669715866446495, 0.00900255236774683, -0.007777477148920298, 0.01321681123226881, -0.020819278433918953, -0.020959286019206047, -0.02553756721317768, -0.006650408264249563, -0.010717657394707203, -0.01421787217259407, 0.005624845158308744, -0.01891516149044037, -0.0052538225427269936, 0.0004193694912828505, 0.039006393402814865, -0.01357383280992508, -0.003857236821204424, 0.016128990799188614, 0.011928732506930828, 0.009107558988034725, -0.01176772266626358, 0.013965857215225697, -0.010759660042822361, 0.0012171997223049402, -0.03578619658946991, 0.010192625224590302, 0.018705148249864578, -0.0029489309526979923, -0.006765915080904961, -0.023395435884594917, 0.03979044035077095, 0.015176931396126747, -0.014133867807686329, 0.01645101048052311, 0.00099843624047935, -0.0021281305234879255, -0.018957164138555527, -0.0007407329394482076, -0.0025026535149663687, 0.004665786400437355, 0.03351805731654167, 0.016100987792015076, -0.006198880262672901, 0.005040309391915798, 0.011046677827835083, 0.00258140848018229, 0.027959715574979782, 0.019937222823500633, 0.010486643761396408, 0.003647223813459277, -0.021715333685278893, -0.03416209667921066, -0.001676602871157229, 0.008400515653192997, 0.014266875572502613, -0.01499492023140192, 0.0009398076799698174, 0.005897861905395985, 0.005432333331555128, 0.005495337303727865, -0.004553779494017363, 0.012362758629024029, 0.005362329073250294, -0.009023553691804409, -0.029177790507674217, 0.013146806508302689, -0.02289140410721302, -0.018733149394392967, -0.010759660042822361, -0.002656663069501519, 0.009282569400966167, -0.027203669771552086, -0.008722535334527493, 0.0020493757911026478, 6.234757893253118e-05, -0.007406454533338547, 0.06546802073717117, 0.00888354517519474, 0.022289367392659187, -0.023507442325353622, -0.00812049861997366, 0.01869114674627781, 0.009065556339919567, -0.0003095502615906298, -0.018943162634968758, 0.03043786808848381, 0.0078124795109033585, -0.0022296367678791285, -0.02892577461898327, -0.012271753512322903, 0.038334351032972336, -0.02821173146367073, 0.015498951077461243, 0.012208749540150166, -0.02912178821861744, -0.01843913085758686, 0.008379514329135418, -0.005222320556640625, 0.002640912076458335, -0.0431506484746933, -0.014308878220617771, -0.009471581317484379, 0.01079466287046671, 0.015736965462565422, 0.013706841506063938, 0.020497258752584457, 0.03581419959664345, 0.02574758045375347, 0.00845651887357235, 0.011585711501538754, -0.027399681508541107, 0.0364302359521389, -0.034750133752822876, -0.006688910536468029, 0.0005149691132828593, 0.01421787217259407, 0.007427455857396126, -0.02462751232087612, -0.008302509784698486, 0.006086873356252909, 0.021505320444703102, -0.03416209667921066, -0.023507442325353622, 0.02266739122569561, -0.033630065619945526, -0.03598221018910408, -0.00788948405534029, 0.014868912287056446, -0.030745886266231537, 0.00010724877211032435, 0.03127792105078697, 0.0058138566091656685, -0.03841835632920265, -0.016563016921281815, -0.01640900783240795, 0.021379312500357628, 0.038138341158628464, -0.024991534650325775, 0.018159113824367523, -0.02892577461898327, 0.012278753332793713, 0.022975409403443336, -0.01087166741490364, 0.0007306698244065046, 0.007287447340786457, -0.02620960772037506, 0.02314341999590397, -0.0134268244728446, -0.006982928607612848, -0.010269630700349808, 0.012600773014128208, -0.0386703722178936, 0.016268998384475708, -0.0025901589542627335, 0.02886977232992649, 0.014882913790643215, -0.011382699012756348, 0.008925547823309898, 0.011424700729548931, -0.006961927283555269, -0.012677778489887714, 0.0008439893135800958, -0.011487704701721668, -0.017613081261515617, -0.005260822828859091, -0.012362758629024029, 0.011697717942297459, 0.008792540058493614, 0.014938917011022568, 0.011683717370033264, -0.03024185635149479, 0.002021373948082328, -0.01001761481165886, -0.014700902625918388, -0.015190931968390942, -0.04732290282845497, -0.00956258736550808, 0.02465551346540451, 0.013727842830121517, 0.00878553930670023, 0.010976674035191536, 0.0222613662481308, 0.005509338341653347, -0.021953348070383072, -0.013412822969257832, 0.016367005184292793, 0.013174808584153652, 0.024515504017472267, -0.004315765108913183, -0.02048325724899769, 0.01715105213224888, -0.02821173146367073, -0.0019986226689070463, 0.03180995211005211, 0.0052118198946118355, -0.0013878351310268044, 0.011809724383056164, -0.01867714710533619, -0.020973287522792816, -0.005306325852870941, -0.01780909299850464, 0.024095479398965836, 0.02998984046280384, 0.01958720199763775, 0.011935732327401638, -0.024823524057865143, -0.020581264048814774, -0.01664702221751213, -0.008393514901399612, 0.006090373732149601, -0.01996522583067417, 0.029485810548067093, -0.033630065619945526, -0.0064088935032486916, -0.010241628624498844, 0.01887315884232521, 0.0017956101801246405, 0.006188379600644112, 0.024795521050691605, -0.004620283376425505]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"sigmoid 
logψθ
t(s1:t,ot:T)i
=TX
t=1Eσ(s1:t|ot:T)
logψθ
t(s1:t,ot:T)
1 +ψθ
t(s1:t,ot:T)
+Ep0(s1:t)
log1
1 +ψθ
t(s1:t,ot:T)
(SIXO)
Note that we can perform approximate positive sampling as in Sec. 4 to estimate expectations in the first term.
Exact Conditional Sampling However, we can also use the BDMC trick in Sec. 3.3 to obtain exact target samples for
general observation variables. In order to facilitate tractable sampling, we optimize the Eq. (SIXO) loss over a sampling
distribution πs(o1:T) =σ(o1:T)for all t, such that the objective becomes
Eσ(o1:T)[LSIXO(o1:T;θ)] =TX
t=1Eσ(s1:t,ot+1:T)
logψθ
t(s1:t,ot:T)
1 +ψθ
t(s1:t,ot:T)
+Ep0(s1:t)σ(ot+1:T)
log1
1 +ψθ
t(s1:t,ot:T)
With this choice, note that we may sample once from σ(s1:T,o1:T) =QT
t=1p0(st|s1:t−1)σ(ot|s1:t)using ancestral sampling
and use the appropriate truncations for positive sampling terms involving σ(s1:t,ot+1:T). By shuffling observation variables
across a batch of Ksamples, we may obtain samples from the product of marginals p0(s1:T)σ(o1:T)orp0(s1:t)σ(ot+1:T)
in the negative sampling term.
In the main text, note that we condition on oT= 1oroT=sT+1:T+c(for infilling).
Gradient and Comparison with CTL Proceeding with the ψθ
tparameterization for the target σ(s1:T|oT) =σ(s1:T)
with fixed oTand unconditional twists ψθ
t(s1:t), the gradient of Eq. (SIXO) with respect to θis
∇θLSIXO(θ) =TX
t=1Eσ(s1:t)
∇θlogψθ
t(s1:t)−ψθ
t(s1:t)
1 +ψθ
t(s1:t)∇θlogψθ
t(s1:t)
−Ep0(s1:t)ψθ
t(s1:t)
1 +ψθ
t(s1:t)∇θlogψθ
t(s1:t)
=TX
t=1Eσ(s1:t)1
1 +ψθ
t(s1:t)∇θlogψθ
t(s1:t)
−Ep0(s1:t)ψθ
t(s1:t)
1 +ψθ
t(s1:t)∇θlogψθ
t(s1:t)
(SIXO Gradient)
28
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
The SIXO gradient is superficially similar to our CTL gradient in Sec. 4.1, in that it involves ∇θlogψθ
tunder positive and
negatives samples. However, viewing ˜πθ
t(s1:t) =p0(s1:t)ψθ
t(s1:t)as the unnormalized density of our intermediate twisting
target, we can see that the second term in the SIXO update includes ˜πθ
t(s1:t). Rewriting to highlight differences with our
CTL gradient, we have
∇θLSIXO=TX
t=1 X
s1:tσ(s1:t)1
1 +ψθ
t(s1:t)∇θlogψθ
t(s1:t)−X
s1:t˜πθ
t(s1:t)1
1 +ψθ
t(s1:t)∇θlogψθ
t(s1:t)!
∇θLCTL=TX
t=1 X
s1:tσ(s1:t) ∇θlogψθ
t(s1:t)−X
s1:t˜πθ
t(s1:t)1
Zψ
t","[0.01628333330154419, -0.024747975170612335, 0.014412768185138702, 0.025461211800575256, 0.013524587266147137, 0.009554683230817318, 0.028475647792220116, 0.025057492777705193, -0.04349399358034134, -0.007832149043679237, 0.00675892923027277, -0.02575727365911007, 0.00018135814752895385, 0.0034517974127084017, 0.022487148642539978, -0.006462868303060532, 0.020253237336874008, -0.0017410381697118282, -0.03019818104803562, 0.01976877450942993, -0.02586493082344532, -0.04650843143463135, 0.018113525584340096, 0.037868842482566833, -0.01304012443870306, -0.057920221239328384, 0.0126296766102314, -0.010469779372215271, 0.00012826488818973303, -0.024330798536539078, 0.032055288553237915, -0.03030584007501602, -0.020455095916986465, -0.03515046834945679, 0.02022632211446762, 0.06303399801254272, 0.03477366268634796, 0.08106677979230881, 0.004077562130987644, -0.007314042653888464, 0.021881571039557457, -0.056143857538700104, -0.018678732216358185, 0.004336615093052387, 0.013746632263064384, 0.001085835974663496, 0.024142397567629814, -0.016660137102007866, 0.03668459877371788, 0.03466600552201271, -0.007637017872184515, 0.035957906395196915, -0.03520429879426956, 0.015489352867007256, -0.03054807148873806, -0.028071928769350052, -0.03054807148873806, 0.012353802099823952, 0.03480057790875435, -0.032943472266197205, 0.02998286485671997, -0.03455834835767746, 0.017359917983412743, -0.019540000706911087, -0.006506604608148336, 0.009218250401318073, -0.023254215717315674, 0.020428182557225227, -0.004932100418955088, 0.0433594211935997, -0.008632858283817768, -0.005904390476644039, 0.022514063864946365, -0.014977974817156792, -0.011115729808807373, 0.03630779683589935, 0.006025506183505058, 0.03501589596271515, 0.020064834505319595, -0.04968435317277908, 0.04976509511470795, 0.0004192790074739605, 0.07546854019165039, -0.025959132239222527, -0.0016434728167951107, -0.048230964690446854, -0.024922920390963554, -0.004800891969352961, -0.023429159075021744, 0.011337775737047195, -0.01699656993150711, 0.007563002873212099, -0.030521156266331673, -0.037949588149785995, 0.0557132214307785, 0.008363712579011917, 0.0020993389189243317, 0.014722286723554134, 0.009319180622696877, -0.018086612224578857, -0.001255734357982874, -0.04672374576330185, 0.0548519566655159, -0.04349399358034134, 0.04572790488600731, -0.010907141491770744, -0.025434298440814018, -0.02490946277976036, -0.041179340332746506, 0.012777706608176231, -0.014291652478277683, -0.01443968340754509, -0.018261555582284927, 0.027399063110351562, 0.02887936681509018, -0.021087588742375374, -0.042740385979413986, 0.004376986995339394, -0.029471486806869507, -0.010436136275529861, -0.04239049553871155, -0.04917297512292862, -0.00265277037397027, -0.0019950447604060173, 0.011943354271352291, -0.02018595114350319, 0.01866527460515499, -0.07143135368824005, -0.019284311681985855, -0.0002882806002162397, 0.010207362473011017, -0.02029360830783844, -0.02863713540136814, -0.023886708542704582, -0.009016390889883041, 0.022594807669520378, 0.005376191344112158, 0.03593099117279053, 0.018436500802636147, 0.030736474320292473, -0.018974794074892998, -0.006957424338907003, -0.020091749727725983, -0.001993362559005618, -0.037518952041864395, -0.018396129831671715, -0.04672374576330185, 0.022325661033391953, -0.04685831815004349, 0.032162949442863464, -0.0007481417851522565, -0.04222900792956352, -0.049119144678115845, 0.0015551592223346233, -0.0318668857216835, -0.059481266885995865, -0.04290187358856201, 0.07315388321876526, 0.014103250578045845, -0.0017797279870137572, 0.00195635505951941, 0.03899925574660301, 0.03485440835356712, -0.009897843934595585, 0.013538043946027756, -0.009675798937678337, -0.034289199858903885, 0.036173224449157715, -0.0398874394595623, -0.06039636209607124, 0.007192926947027445, -0.027237575501203537, -0.042202092707157135, -0.025340097025036812, 0.0037747726310044527, -0.03603865206241608, -0.01855761744081974, -0.06421823799610138, -0.03367016464471817, -0.02682039886713028, -0.0390261709690094, 0.039080001413822174, -0.010759111493825912, 0.01438585389405489, 0.003821873338893056, -0.01762906275689602, 0.023254215717315674, 0.03463909029960632, 0.008134937845170498, -0.009110592305660248, -0.006779115181416273, 0.04831170663237572, 0.09253239631652832, 0.0014559116680175066, -0.017642520368099213, -0.017830923199653625, 0.07853680104017258, 0.07929041236639023, 0.04349399358034134, 0.02007829211652279, 0.032620497047901154, 0.03716906160116196, -0.03097870573401451, -0.04045264422893524, -0.0005458617233671248, 0.010563980787992477, 0.017978953197598457, 0.017359917983412743, -0.05172986164689064, 0.01310741063207388, 0.01165402214974165, -0.040425729006528854, 0.03358942270278931, 0.03716906160116196, -0.039402976632118225, 0.038407135754823685, -0.03442377597093582, -0.0031372332014143467, -0.011667479760944843, 0.04451674968004227, -0.005894297733902931, 0.053775373846292496, 0.02083190158009529, 0.008821260184049606, -0.02887936681509018, 0.05186443403363228, 0.02408856712281704, 0.0005012844339944422, 0.008854903280735016, -0.06228038668632507, 0.06206506863236427, 0.02703571692109108, -0.05673597753047943, -0.04925372079014778, 0.031382422894239426, -0.04462440684437752, -0.023267671465873718, -0.01684853993356228, -0.0001444557128706947, -0.024990206584334373, -0.037276722490787506, 0.025097865611314774, 0.021195247769355774, -0.006688278168439865, -0.016242962330579758, 0.013336184434592724, -0.021208705380558968, -0.0008621083106845617, 0.009453753009438515, 0.0195130854845047, 0.012118298560380936, 0.01593344286084175, -0.022325661033391953, -0.014493511989712715, -0.050895508378744125, 0.009339366108179092, 0.010886956006288528, -0.01037557888776064, -0.040075838565826416, 0.04158305749297142, 0.04126008227467537, -0.01901516504585743, -0.04919989034533501, -0.0031927444506436586, -0.03420845791697502, -0.034289199858903885, -0.004309700336307287, 0.0023129733745008707, 0.05275261774659157, -0.010106432251632214, 0.01433202438056469, -0.0059716771356761456, -0.014130164869129658, 0.03367016464471817, -0.015341321937739849, -0.08348909020423889, 0.009978587739169598, 0.04707363620400429, -0.0157181266695261, 0.01023427676409483, -0.0318668857216835, -0.028152672573924065, 0.03867628052830696, -0.026309022679924965, 0.010207362473011017, -0.02944457344710827, 0.02011866308748722, 0.019136281684041023, -0.019714944064617157, -0.06766330450773239, 0.02252752147614956, -0.006890137679874897, 0.02866404876112938, -0.00047857523895800114, -0.003872338216751814, 0.04311719164252281, 0.011082086712121964, -0.023281129077076912, -0.0041818562895059586, -0.00800036545842886, 0.0442206896841526, -0.021450936794281006, -0.017534863203763962, 0.02788352593779564, 0.016861997544765472, 0.039187658578157425, 0.010456322692334652, -0.019109366461634636, -0.002504739910364151, 0.013046852312982082, -0.009507582522928715, -0.010664910078048706, -0.02434425614774227, 0.052671872079372406, 0.01927085407078266, -0.02250060625374317, 0.020845357328653336, 0.012710420414805412, 0.002291105454787612, -0.03646928444504738, -0.032593581825494766, -0.022123802453279495, -0.010066060349345207, 0.001954672858119011, -0.016014186665415764, 0.0087808882817626, -0.03445068746805191, -0.0046797762624919415, 0.012818078510463238, -0.011310860514640808, 0.007791776675730944, -0.031813059002161026, 0.007711032871156931, -0.0018268284620717168, 0.001853743102401495, -0.035500358790159225, -0.007549545262008905, 0.05953509733080864, 0.011835695244371891, 0.0385955385863781, -0.10749691724777222, 0.02157205156981945, -0.015691211447119713, -0.04416685923933983, 0.00972289964556694, 0.00607597129419446, 0.015260578133165836, 0.028610220178961754, 0.0700317919254303, 0.010893684811890125, 0.010880227200686932, -0.03668459877371788, 0.02922925539314747, 0.010637995786964893, 0.03221677616238594, 0.0031860158778727055, -0.015287493355572224, -0.05331782251596451, -0.03097870573401451, -0.023604104295372963, -0.013699531555175781, -0.03310495987534523, 0.02501712180674076, 0.013490943238139153, 0.026483967900276184, 0.01979568786919117, 0.009521040134131908, 0.018813306465744972, 0.0009756542858667672, -0.00939992442727089, 0.0005845514824613929, 0.027910441160202026, -0.022083429619669914, -0.024922920390963554, -0.027937354519963264, -0.006378760561347008, 0.022191088646650314, 0.008996205404400826, 0.040318071842193604, 0.015422065742313862, -0.04373622685670853, 0.012622947804629803, -0.012387445196509361, -0.008875089697539806, -0.00979018583893776, 0.0010807894868776202, 0.002783979056403041, -0.021195247769355774, -0.016983112320303917, 0.005827011074870825, 0.009164421819150448, -0.037949588149785995, -0.0031237758230417967, 0.027264490723609924, 0.007852334529161453, -0.033051129430532455, 0.019714944064617157, 0.07342302799224854, 0.03948371857404709, 0.046104710549116135, -0.030844131484627724, -0.009090405888855457, -0.022164173424243927, -0.028152672573924065, -0.07428430020809174, -0.030036693438887596, 0.015139462426304817, 0.027129918336868286, 0.009944944642484188, 0.05326399579644203, 0.04160997271537781, -0.017534863203763962, 0.022150715813040733, -0.0390261709690094, 0.007650475017726421, -0.03738437965512276, 0.015623925253748894, 0.04395154118537903, 0.05251038447022438, 0.0774063915014267, -0.04077561944723129, -0.009016390889883041, 0.03956446424126625, -0.029040854424238205, -0.02484217658638954, 0.010846584104001522, 0.013201612047851086, -0.011384876444935799, 0.03474675118923187, -0.027695123106241226, 0.021948857232928276, 0.032512836158275604, -0.0005752996075898409, -0.031382422894239426, -0.04691214859485626, -0.03407388553023338, 0.005221432540565729, 0.009891116060316563, 0.027748953551054, -0.049872756004333496, 0.02788352593779564, -0.003922802861779928, -0.02944457344710827, -0.0023903530091047287, -0.004508195444941521, 0.019540000706911087, -0.022769752889871597, -0.03151699900627136, 0.0035830060951411724, 0.002479507587850094, 0.017413746565580368, 0.00735441455617547, 0.04675066098570824, 0.0015568414237350225, 0.008417541161179543, -0.02731831930577755, 0.04723512381315231, -0.002657816745340824, 0.020132120698690414, -0.028960110619664192, 0.0011194791877642274, -0.013423657044768333, -0.03183997422456741, -0.010523608885705471, 0.016162218526005745, 0.04416685923933983, 0.04123316705226898, -0.04666991904377937, 0.016969656571745872, 0.05259113013744354, -0.011465620249509811, -0.04416685923933983, 0.02369830571115017, -0.02083190158009529, 0.0035796419251710176, 0.018705647438764572, 0.05797404795885086, -0.013638974167406559, 0.02153168059885502, -0.007253484800457954, 0.01301993802189827, -0.02369830571115017, -0.012266329489648342, 0.008195496164262295, 0.023967452347278595, 0.07859063148498535, 0.02735869213938713, -0.0214643944054842, -0.012522017583251, -0.006244187243282795, -0.015570096671581268, -0.052671872079372406, 0.0008515947847627103, -0.016525564715266228, 0.03980669379234314, -0.0022675551008433104, -0.007240027654916048, -0.012750792317092419, -0.022473691031336784, -0.018436500802636147, 0.061365287750959396, -0.0016754339449107647, -0.012353802099823952, 0.045970138162374496, 0.06120380014181137, -0.03167848661541939, -0.0043837158009409904, 0.004733605310320854, 0.015085633844137192, 0.04012966901063919, -0.011425248347222805, 0.025636157020926476, 0.006546976510435343, 0.007852334529161453, -0.018867135047912598, -0.008928919211030006, -0.04634694382548332, -0.017965495586395264, -0.0019344869069755077, 0.01749449037015438, -0.016687052324414253, -0.01721188798546791, -0.05003424361348152, -0.03711523488163948, 0.02718374691903591, -0.017830923199653625, 0.003285263432189822, -0.1376951038837433, -0.06540247797966003, -0.0256899856030941, 0.02192194201052189, -0.032620497047901154, -0.001455070567317307, 0.009992045350372791, -0.010409221984446049, -0.004982565529644489, -0.028287244960665703, -0.027964269742369652, -0.030844131484627724, -0.006351845804601908, -0.019741859287023544, -0.00041297089774161577, 0.02046855352818966, 0.02944457344710827, 0.0027166923973709345, 0.0007590758614242077, 0.026981886476278305, 0.017373375594615936, -0.013275627046823502, 0.046885233372449875, 0.013181425631046295, -0.013026666827499866, -0.011734765954315662, -0.01477611530572176, -0.025232437998056412, 0.02618790604174137, 0.018719105049967766, 0.012791164219379425, 0.0018806577427312732, 0.01426473818719387, 0.014035964384675026, -0.008794345892965794, 0.010207362473011017, 0.004208770580589771, -0.028125757351517677, 0.006620991975069046, 0.015260578133165836, 0.002568662166595459, 0.0357695035636425, 0.032620497047901154, -0.06540247797966003, 0.03835330531001091, 0.007596645969897509, -0.014789572916924953, -0.008720330893993378, -0.014157080091536045, 0.046212367713451385, -0.0427134707570076, -0.013612058945000172, -0.02274283766746521, -0.024680688977241516, -0.004407265689224005, 0.023402245715260506, -0.053237080574035645, -0.03889159858226776, 0.015489352867007256, 0.0067286500707268715, 0.028852451592683792, -0.030736474320292473, -0.0037512225098907948, 0.037411294877529144, -0.001835239352658391, -0.009938215836882591, -0.0047470624558627605, -0.03367016464471817, 0.008848175406455994, 0.00984401535242796, -0.0018924328032881021, -0.00821568164974451, -0.02809884212911129, 0.0256899856030941, 0.002886591013520956, 0.01866527460515499, 0.0018991614924743772, -0.030844131484627724, 0.037518952041864395, -0.027089545503258705, 0.014062878675758839, 0.02512477897107601, 0.0016014187131077051, 0.01923048123717308, 0.013141053728759289, 0.0003397968248464167, -0.03711523488163948, -0.0010589213343337178, -0.008437727577984333, 0.015798870474100113, -0.002921916311606765, 0.07369217276573181, -0.033508677035570145, 0.006846401374787092, -0.036953747272491455, 0.05170294642448425, -0.01305358111858368, 0.0013474122388288379, 0.021195247769355774, -0.02256789244711399, -0.022648636251688004, 0.024182768538594246, 0.004252506885677576, -0.03202837333083153, -0.0068834088742733, 0.014076336286962032, 0.00020764193322975188, 0.015045261941850185, -0.0069237807765603065, -0.012744063511490822, 0.012199042364954948, 0.006059149280190468, -0.02114141918718815, 0.02174699679017067, 0.007663932628929615, 0.00042874118662439287, -0.042525067925453186, 0.03321261703968048, 0.012347073294222355, 0.019418884068727493, 0.04066796228289604, -0.018248099833726883, -0.012212499976158142, -0.011970268562436104, -0.03415462747216225, 0.020697327330708504, -0.02660508267581463, 0.028341073542833328, -0.0394568033516407, 0.02192194201052189, -0.020656956359744072, -0.003125458024442196, -0.012622947804629803, -0.01699656993150711, -0.00958159752190113, -0.006799301132559776, 0.024613402783870697, -0.010860041715204716, 0.02788352593779564, 0.013477486558258533, 0.017333002761006355, -0.013302541337907314, -0.02376559190452099, -0.03033275529742241, 0.06281867623329163, 0.018396129831671715, -0.0010849948739632964, 0.024707604199647903, 0.011378147639334202, -0.026053333654999733, -0.04373622685670853, -0.01443968340754509, 0.009319180622696877, -0.022662093862891197, -0.025891846045851707, -0.03899925574660301, -0.02933691442012787, -0.013699531555175781, 0.003623377997428179, 0.021585509181022644, 0.00507340207695961, -0.0349082387983799, -0.007744676433503628, -0.015408609062433243, 0.01293246541172266, 0.0269953440874815, -0.02239294722676277, 0.012071198783814907, -0.06534864753484726, -0.02671274170279503, 0.034612175077199936, 0.0043837158009409904, -0.04012966901063919, -0.006237458903342485, 0.008962562307715416, -0.04021041467785835, -0.031140193343162537, -0.04023732617497444, -0.0019025257788598537, -0.019701488316059113, 0.03948371857404709, 0.043763142079114914, -0.022446777671575546, -0.016444820910692215, -0.007058354094624519, -0.016094930469989777, 0.009971859864890575, -0.00038227144978009164, -0.0125758470967412, 0.010119889862835407, 0.003771408461034298, -0.019391968846321106, -0.00927880872040987, -0.00847809948027134, -0.008491556160151958, -0.029740633442997932, -0.02057621255517006, -0.00798017904162407, -0.03733054921030998, -0.0552825890481472, -0.013033395633101463, -0.02139710821211338, -0.0106783676892519, 0.001294424058869481, 0.018544159829616547, -0.012750792317092419, -0.0032179770059883595, 0.01094751339405775, 0.03523121401667595, -0.0037041218020021915, 0.025851473212242126, -0.021329820156097412, -0.01645827852189541, 0.01103498600423336, -0.019997548311948776, -0.045862480998039246, 0.03856862336397171, 0.04478589445352554, 0.026335936039686203, 0.010402493178844452, 0.037518952041864395, -0.019540000706911087, -0.03800341486930847, 0.004121298436075449, 0.010981157422065735, -0.009023119695484638, -0.013968677259981632, -0.004918643273413181, -0.0016115116886794567, 0.02359064668416977, -0.006234094500541687, -0.018974794074892998, -0.006186993792653084, 0.03590407595038414, 0.004461095202714205, -0.015597010962665081, -0.00667145662009716, -0.011573278345167637, -0.0032919920049607754, -0.023967452347278595, -0.005281990393996239, 0.01784438081085682, 0.016256418079137802, 0.007488987408578396, 0.01908245123922825, 0.008134937845170498, 0.017252258956432343, 0.055497907102108, 0.041879117488861084, 0.0034753477666527033, -0.020589670166373253, -0.00016159273218363523, -0.0026544525753706694, 0.015139462426304817, 0.014022506773471832, 0.020562754943966866, -0.024573029950261116, -0.015031804330646992, -0.01614876091480255, -0.013638974167406559, -0.007717761676758528, -0.0004575482162181288, -0.043978456407785416, -0.017642520368099213, 0.015637382864952087, -0.00014098624524194747, 0.02161242440342903, 0.008175309747457504, 0.03022509627044201, -0.02302544005215168, -0.14103250205516815, -0.02163933962583542, 0.036415454000234604, 0.00699779624119401, -0.003821873338893056, -0.021625882014632225, 0.03232443705201149, -0.016377534717321396, -0.0033693716395646334, -0.02334841527044773, -0.003177605103701353, -0.02441154234111309, 0.016835082322359085, 0.010893684811890125, 0.008827988989651203, -0.036523111164569855, -0.012172128073871136, -0.007219841703772545, -0.008511742576956749, -0.005931305233389139, -0.010759111493825912, 0.020603125914931297, 0.00892219040542841, 0.06260336190462112, -0.03711523488163948, -0.0011354597518220544, -0.011041714809834957, 0.034181542694568634, 0.001922711730003357, 0.01596035808324814, -0.005938033573329449, -0.02571690082550049, 0.027049174532294273, 0.019634200260043144, -0.03170539811253548, 0.00697088148444891, -0.010092975571751595, -0.017817465588450432, -0.031059449538588524, 0.018180811777710915, 0.026672368869185448, -0.056574489921331406, 0.07159283757209778, 0.004989293869584799, 0.012885364703834057, -0.013309270143508911, 0.0069372383877635, -0.009265351109206676, 0.020710784941911697, -0.04150231555104256, 0.003180969273671508, 0.0003725989954546094, -0.00979018583893776, -0.03358942270278931, 0.022406404837965965, -0.018207727000117302, -0.0029067769646644592, 0.008908732794225216, -0.0034618903882801533, 0.01431856770068407, -0.02799118496477604, 0.00290509476326406, 0.04707363620400429, -0.011357961222529411, -0.02213725820183754, -0.003572913119569421, -0.025676529854536057, 0.013302541337907314, -0.000250852492172271, -0.015879614278674126, 0.007515902165323496, 0.014870316721498966, 0.010523608885705471, -0.02554195560514927, -0.007852334529161453, -0.012293243780732155, 0.008383898064494133, -0.016592850908637047, -0.042309753596782684, -0.005978405475616455, 0.033616337925195694, -0.051245398819446564, 0.022339118644595146, 0.01114264503121376, -0.010227547958493233, 0.00984401535242796, -0.006799301132559776, 0.017090771347284317, -0.03364324942231178, 0.04535110294818878, 0.041879117488861084, -0.006785843521356583, 0.004353436641395092, -0.04413994401693344, -0.014722286723554134, -0.020670413970947266, -0.012205771170556545, 0.010045874863862991, 0.009628698229789734, 0.0031422795727849007, 0.012481645680963993, 0.028690963983535767, 0.0017040306702256203, -0.009420109912753105, -0.014062878675758839, 0.02274283766746521, 0.008740516379475594, 0.02324075810611248, 0.03264741227030754, -0.02224491722881794, -0.0025770729407668114, 0.014035964384675026, -0.021262533962726593, -0.0010168672306463122, -0.0006800142000429332, -0.022648636251688004, 0.0322975218296051, 0.015004890039563179, 0.02161242440342903, -0.01158673595637083, 0.006203815340995789, 0.011580007150769234, -0.015206749550998211, -0.013248711824417114, -0.014681914821267128, -0.004992658272385597, 0.008296425454318523, 0.00824932474642992, -0.018961336463689804, -0.00789270643144846, 0.002706599421799183, -0.032835811376571655, 0.02486909180879593, 0.014641542918980122, -0.027964269742369652, 0.02313309907913208, 0.011095544323325157, 0.0022709195036441088, 0.005800096318125725, 0.04828479513525963, 0.004757155664265156, -0.020428182557225227, 0.015058718621730804, 0.035634931176900864, -0.006826215423643589, -0.015731584280729294, 0.01298629492521286, -0.038407135754823685, -0.016444820910692215, 0.005285354796797037, 0.04513578489422798, 0.016915826126933098, 0.002392035210505128, 0.0070247105322778225, 0.012017369270324707, -0.0023129733745008707, 0.0012986294459551573, -0.04637385532259941, -0.02686077170073986, -0.0002710384433157742, 0.007105454336851835, 0.03754586726427078, 0.011728037148714066, -0.027089545503258705, 0.019701488316059113, -0.01916319504380226, -0.010301562957465649, -0.014224366284906864, -0.004780706018209457, 0.0401027537882328, -0.011526177637279034, -0.05555173382163048, 0.02064349874854088, 0.014601171016693115, 0.007576460018754005, -0.009971859864890575, 0.008175309747457504, 0.0351235531270504, 0.00735441455617547, 0.005759724415838718, 0.011667479760944843, 0.0344776026904583, -0.03870319575071335, 0.013901391066610813, 0.05845851078629494, -0.021275991573929787, 0.01247491780668497, 0.012602761387825012, -0.0037310365587472916, 0.025003664195537567, -0.004979201126843691, 0.01215194258838892, 0.0027974362019449472, 0.048661597073078156, 0.006452775560319424, 0.03891851380467415, -0.0016443139174953103, 0.002600623294711113, -0.011505992151796818, -0.024209683761000633, 0.0035392700228840113, 0.02402128092944622, -0.011633835732936859, -0.0031422795727849007, -0.05108391121029854, 0.02408856712281704, -0.041313912719488144, -0.005423292052000761, 0.01316124014556408, 0.004780706018209457, 0.01259603351354599, 0.012609490193426609, -0.022325661033391953, 0.03100561909377575, -0.0030228460673242807, -0.06497184932231903, -0.002284376649186015, 0.03681917488574982, -0.005800096318125725, -0.01684853993356228, -0.024707604199647903, -0.03846096247434616, -0.0015585236251354218, 0.009830557741224766, -0.024115482345223427, -0.002087563741952181, 0.04037190228700638, 0.005076766479760408, -0.01153290644288063, 0.001246482483111322, 0.0004245357704348862, 0.017817465588450432, -0.0234157033264637, 0.0027923898305743933, 0.011862610466778278, 0.01947271265089512, -0.019324682652950287, -0.02941765822470188, 0.004491373896598816, 0.02679348550736904, 0.007038168143481016, 0.0240616537630558, -0.015946900472044945, -0.004979201126843691, 0.006557069718837738, 0.0014096521772444248, -0.002955559641122818, 0.02944457344710827, -0.0314362533390522, -0.024990206584334373, -0.011378147639334202, 0.022298745810985565, 0.044866640120744705, -0.003956446424126625, 0.006839673034846783, 0.014170536771416664, -0.004686504602432251, 0.057489585131406784, 0.05014190077781677, 0.029579145833849907, -0.016202589496970177, -0.0020303702913224697, 0.007690846920013428, -0.016054559499025345, -0.001828510663472116, -0.04284804314374924, 0.021235620602965355, 0.004309700336307287, -0.0048479922115802765, 0.02788352593779564, -0.02721066027879715, -0.02217763103544712, 0.01103498600423336, 0.04785415902733803, 0.015812328085303307, -0.03515046834945679, 0.02075115777552128, -0.02987520582973957, 0.0052887191995978355, 0.014574255794286728, -0.026012960821390152, -0.008982747793197632, -0.011041714809834957, -0.015247121453285217, 0.01972840167582035, 0.0020539204124361277, 0.020212864503264427, -0.0073746005073189735, 0.02057621255517006, 0.01678125374019146, 0.05154145881533623, 0.03776118531823158, -0.01094751339405775, -4.50767001893837e-05, -0.0087808882817626, -0.0025770729407668114, -0.012495103292167187, 0.021329820156097412, -0.015987273305654526, 0.003340774914249778, -0.003916074521839619, 0.014749201014637947, 0.004518288653343916, -0.011546364054083824, 0.006654635071754456, 0.02944457344710827, 0.008854903280735016, -0.021370192989706993, -0.016808168962597847, -0.029740633442997932, -0.016700509935617447, 0.01399559248238802, 0.004353436641395092, 0.0320822037756443, 0.02309272810816765, 0.0008015504572540522, -0.024774890393018723, -0.010079517960548401, -0.012636405415832996, -0.007287127897143364, -0.019149737432599068, -0.020872272551059723, 0.00045586604392156005, 0.0023247485514730215, -0.015126005746424198, 0.0048749069683253765, -0.002706599421799183, -0.019782232120633125, 0.009177878499031067, -0.004030461423099041, 0.011169559322297573, 0.024142397567629814, 0.016081474721431732, -0.023940537124872208, 0.0037815014366060495, 0.027062630280852318, -0.004144848324358463, 0.010967699810862541, -0.02820650115609169, 0.0005332455039024353, -0.017507947981357574, 0.0016173992771655321, 0.005914483685046434, 0.0012843310832977295, 0.005884204525500536, 0.013134324923157692, -0.010267919860780239, 0.01947271265089512, 0.021841198205947876, -0.011008071713149548, 0.07433812320232391, -0.03087104670703411, -0.030171267688274384, 0.024276969954371452, -0.008208952844142914, 0.02512477897107601, -0.014372396282851696, 0.007065082434564829, -0.033401019871234894, 0.0076706609688699245, -0.02855639159679413, 0.04284804314374924, -0.019782232120633125, -0.014480055309832096, 0.03270123898983002, -0.01050342246890068, -0.019284311681985855, 0.03757278248667717, 0.019499627873301506, -0.002634266624227166, 0.01827501319348812, 0.01604110188782215, -0.03342793509364128, 0.027399063110351562, -0.025245895609259605, -0.007556274067610502, -0.028179585933685303, 0.021908484399318695, -0.008632858283817768, 0.02046855352818966, 0.00234157033264637, -0.03385856747627258, -0.04852702468633652, -0.004077562130987644, -0.001587961451150477, -0.02398090995848179, -0.04839245229959488, 0.012703691609203815, -0.0022322298027575016, -0.0010092975571751595, -0.011627107858657837, 0.013268898241221905, -0.012851721607148647, -0.0064695971086621284, -0.024384628981351852, 0.017521405592560768, 0.016162218526005745, 0.01578541286289692, -0.023334959521889687, -0.010052603669464588, 0.008309883065521717, -0.01539515145123005, 0.020347438752651215, -0.03183997422456741, 0.006570526864379644, -0.007650475017726421, -0.015085633844137192, 0.025057492777705193, 0.013114139437675476, -0.005006115883588791, -0.04082944989204407, 0.036065563559532166, -0.01840958744287491, 0.026457052677869797, 0.013437114655971527, -0.024667231366038322, 0.009978587739169598, 0.020522382110357285, -0.024721059948205948, 0.06411057710647583, -0.0032482559327036142, 0.0221103448420763, -0.024721059948205948, 0.010126618668437004, -0.031490083783864975, 0.0014533884823322296, 0.010395764373242855, 0.03485440835356712, 0.000776738568674773, 0.052779532968997955, -0.011364690028131008, 0.01162037905305624, 0.004612489603459835, -0.010160261765122414, 0.019984090700745583, 0.01727917417883873, 0.0015778684755787253, -0.0059178476221859455, -0.023052355274558067, -0.003074993146583438, -0.0025535228196531534, 0.004935464821755886, 0.021827740594744682, -0.007677389774471521, -0.004753791261464357, -0.02040126733481884, 0.03332027420401573, -0.008377169258892536, -0.0066647278144955635, 0.01834229938685894, -0.0070785400457680225, -0.024182768538594246, 0.045781735330820084, 0.026268649846315384, -0.022662093862891197, 0.007865792140364647, -0.05673597753047943, 0.0063955821096897125, -0.00012710840383078903, 0.015368237160146236, 0.002492964966222644, 0.01515292003750801, 0.01201064046472311, 0.020212864503264427, 0.0006055785343050957, 0.006186993792653084, -0.03692683205008507, 0.025528497993946075, 0.014143622480332851, -0.030574986711144447, 0.024546116590499878, -0.03162465617060661, 0.023644477128982544, -0.01840958744287491, 0.006301380693912506, 0.006277830805629492, -0.01076584029942751, -0.003354232059791684, -0.01117628812789917, 0.007435158360749483, -0.012380716390907764, -0.008397355675697327, -0.0026544525753706694, -0.012905551120638847, 0.0008103817817755044, 0.001069855410605669, 0.02153168059885502, 0.001954672858119011, -0.02185465581715107, 0.009076949208974838, 0.01565084047615528, -0.006657999474555254, -0.007744676433503628, 0.0275336354970932, -0.02714337408542633, 0.004844628274440765, -0.011277217417955399, -0.028502561151981354, 0.009521040134131908, -0.010489965789020061, 0.03332027420401573, -0.006695006974041462, -0.01476265862584114, 0.014278195798397064, 0.012468189001083374, -0.011728037148714066, 0.004713419359177351, -0.04236358031630516, 0.008531928062438965, 0.010934056714177132, 0.0353388711810112, -0.0007435158477164805, 0.002442500088363886, 0.0276412945240736, 0.030494242906570435, 0.015583553351461887, -0.022662093862891197, 0.003808415960520506, -0.018853677436709404, -0.03498898074030876, -0.031194021925330162, -0.012468189001083374, 0.010294835083186626, -0.024438457563519478, -0.022689009085297585, -0.019095908850431442, -0.003340774914249778, -0.01005933154374361, -0.008982747793197632, 0.026618540287017822, -0.018894050270318985, -0.023792507126927376, 0.006186993792653084, 0.021275991573929787, -0.02139710821211338, -0.0008360347710549831, 0.023684848099946976, 0.01855761744081974, 0.0032566667068749666, 0.019365055486559868, 0.0005185265908949077, -0.0012094748672097921, -0.001528244698420167, -0.023900166153907776, 0.030386583879590034, 0.004918643273413181, 0.014803030528128147, -0.00664454186335206, -0.010348663665354252, 0.03813798725605011, -0.0034955337177962065, -0.017077313736081123, 0.028125757351517677, 0.01328908372670412, 0.018920963630080223, -0.012858450412750244, -0.002857994055375457, -0.012125027365982533, -0.007361143361777067, 0.02852947637438774, 0.04723512381315231, 0.01254220400005579, -0.0011421883245930076, 0.022769752889871597, -0.0012633040314540267, 0.006573891267180443, 0.02597258985042572, 0.003266759682446718, 0.011135916225612164, -0.02608024887740612, -0.01840958744287491, -0.005625151563435793, 0.002974063390865922, 0.019001707434654236, -0.02192194201052189, 0.039295315742492676, -0.0001231132773682475, -0.01310741063207388, -0.007394786458462477, -0.006832944229245186, 0.005117138382047415, -0.01532786525785923, -0.01604110188782215, -0.04204060509800911, 0.01997063308954239, -0.0067185573279857635, -0.020562754943966866, -0.02660508267581463, -0.0048749069683253765, 0.017588691785931587, -0.019095908850431442, -0.005103681236505508, -0.0022002686746418476, 0.00044829631224274635, 0.01296610850840807, 0.06260336190462112, -0.00981037225574255, 0.014681914821267128, -0.021827740594744682, 0.031086362898349762, 0.016471736133098602, 0.02725103311240673, 0.011371418833732605, -0.030359668657183647, 0.018638361245393753, -0.013100681826472282, -0.012905551120638847, -0.03813798725605011, 0.02434425614774227, 0.012461460195481777, -0.032728154212236404, 0.0196207445114851, 0.030063608661293983, -0.012569118291139603, -0.02844873256981373, 0.001514787320047617, -0.024747975170612335, 0.005927940830588341, -0.026134077459573746, -0.01983606070280075, -0.021060675382614136, 0.007192926947027445, 0.02462686039507389, -0.003613285021856427, 0.043413251638412476, 0.043870799243450165, -0.00900966301560402, 0.00014876625209581107, 0.007758133579045534, -0.04247124120593071, 0.023792507126927376, -0.02866404876112938, -0.008383898064494133, -0.006388853304088116, 0.022863952443003654, -0.019526543095707893, -0.019109366461634636, -0.005554500501602888, -0.00924516562372446, 0.005174331832677126, -0.017184972763061523, -0.012158670462667942, 0.03625396639108658, -0.03934914618730545, -0.015489352867007256, -0.009931487962603569, 0.01394176296889782, -0.053452398627996445, 0.008235868066549301, 0.028341073542833328, -0.012804620899260044, -0.02246023342013359, -0.015489352867007256, -0.010954242199659348, 0.03477366268634796, 0.049549780786037445, -0.024788348004221916, -0.007367871701717377, -0.012777706608176231, -0.010523608885705471, 0.009373009204864502, 0.01784438081085682, -0.0002712487184908241, 0.008942375890910625, -0.042659640312194824, 0.032728154212236404, -0.014856859110295773, 0.010119889862835407, 0.0009992045816034079, 0.03385856747627258, -0.026618540287017822, 0.01628333330154419, 0.0053627341985702515, 0.018086612224578857, 0.018746018409729004, -0.0034450688399374485, 0.023617561906576157, 0.006876680534332991, -0.0022053150460124016, -0.016808168962597847, 0.0026275378186255693, -0.0017393560847267509, 0.009150964207947254, -0.013120868243277073, 0.00015013301162980497, -0.004545202944427729, 0.005948126781731844, -0.007112183142453432, 0.012299972586333752, -0.040856365114450455, 0.0024694146122783422, -0.002588848117738962, -0.001012661843560636, -0.0042558712884783745, -0.047423526644706726, 0.0039328960701823235, -0.01304012443870306, -0.015422065742313862, -0.005537678953260183, 0.029148511588573456, -0.005255075637251139, 0.0062408228404819965, -0.011936625465750694, -0.025030579417943954, 0.03267432376742363, 0.013114139437675476, 0.017359917983412743, -0.019701488316059113, -0.029256170615553856, 0.0010042510693892837, -0.012892093509435654, 0.014816487208008766, 0.017467575147747993, 0.016983112320303917, -0.0001938692294061184, -0.007751404773443937, 0.00578327476978302, -0.02348298951983452, 0.0021598967723548412, -0.025838017463684082, 0.008942375890910625, 0.024492286145687103, 0.015193291939795017, 0.02122216299176216, -0.019068993628025055, -0.0033424568828195333, 0.007105454336851835, -0.02564961463212967, 0.001784774474799633, -0.009393195621669292, 0.03692683205008507, -0.02877170778810978, -0.012636405415832996, -0.008767431601881981, 0.017077313736081123, 0.0049388292245566845, -0.0008637904538773, 0.000403298472519964, 0.0038622452411800623]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"∇θlogψθ
t(s1:t)!
(SIXO vs. CTL)
To compare the two, first note that the positive sampling gradient in SIXO is scaled by a factor of1
1+ψθ
t(s1:t)factor (which
reflects the misclassification probability under ψθ
t). For the negative sampling terms, note that ˜πθ
t(s1:t)is divided by a factor
of1
1+ψθ
t(s1:t)in the SIXO gradient, instead of the true normalization constant Zψ
tfor the gradient of our CTL loss Eq. (22).
C.4. FUDGE: Future Discriminators (Yang & Klein, 2021)
In contrast to SIXO , the FUDGE method from Yang & Klein (2021) seeks to directly learn a discriminative classifier to
match the conditional likelihood ψ∗
t(s1:t, oT)∝σ(oT|s1:t)orψ∗
t(s1:t,ot:T)∝σ(ot:T|s1:t)(see App. B.2).
As before, we define the joint distribution σ(s1:T, oT) =p0(s1:T)σ(oT|s1:T)withϕ(s1:T, oT) =σ(oT|s1:T). From
Eq. (52) above or App. B.2 Eq. (40), we have
ψ∗
t(s1:t, oT)∝σ(oT|s1:t):=X
st+1:Tp0(st+1:T|s1:t)σ(oT|s1:T) (54)
Yang & Klein (2021) consider training a ‘future discriminator’ ψθ
t(s1:t, oT)≈σ(oT|s1:t)which, as in Eq. (54) marginalizes
over future tokens to predict the expected probability that a full sequence with prefix s1:temits oT(e.g., let oT=abe the
probability of a classifier for class a, or the probability that s1:Tsatisfies a desired attribute indicated by a boolean oT= 1).
In similar fashion to SIXO in the previous section, we define a binary random variable ysuch that
σ(y|s1:t, oT) =(
σ(oT|s1:t) y= 1
1−σ(oT|s1:t) y= 0pψθ
t(y|s1:t, oT) =(
ψθ
t(s1:t, oT) y= 1
1−ψθ
t(s1:t, oT) y= 0(55)
where we directly parameterize pψθ
t(y|s1:t, oT) =ψθ
t(s1:t, oT)to be a probability distribution (e.g. using a sigmoid or
softmax activation). For a given observation random variable oTand partial sequence s1:t, we can define the FUDGE loss
TX
t=1LFUDGE (s1:t, oT;θ):=TX
t=1DKL
σ(y|s1:t, oT)pψθ
t(y|s1:t, oT)
(FUDGE)
=TX
t=1−h
σ(y= 1|s1:t, oT) logpψθ
t(y= 1|s1:t, oT) +σ(y= 0|s1:t, oT) logpψθ
t(y= 0|s1:t, oT)i
+const.
=TX
t=1−Ep0(st+1:T|s1:t)
σ(oT|s1:T) logψθ
t(s1:t, oT) +
1−σ(oT|s1:T)
log
1−ψθ
t(s1:t, oT)
+const.
where, in moving from the second to the third line, we have used the fact that σ(y= 1|s1:t, oT) = σ(oT|s1:t) =P
st+1:Tp0(st+1:T|s1:t)σ(oT|s1:T)from Eq. (54) and Eq. (55). At the optimum, pψθ
t(y= 1|s1:t, oT) =σ(y= 1|s1:t, oT)
","[-0.004542175214737654, -0.029642945155501366, 0.007624242454767227, -0.0053101093508303165, 0.012032115831971169, 0.017769237980246544, 0.009132561273872852, 0.045511286705732346, 0.0021212887950241566, 0.023954033851623535, 0.02931235544383526, -0.04052488133311272, -0.0028909447137266397, -0.019091598689556122, 0.013829701580107212, 0.028761370107531548, 0.033444736152887344, -0.00022512866416946054, -0.020937396213412285, 0.014752599410712719, -0.025620760396122932, -0.04060753062367439, 0.014849022030830383, 0.012362705543637276, -0.011653314344584942, -0.054905567318201065, 0.0252626221626997, -0.009228983893990517, 0.03603436052799225, 0.01490412000566721, 0.01834776997566223, -0.03060716763138771, -0.006859752349555492, -0.04347264766693115, 0.029835790395736694, 0.032756004482507706, 0.009490701369941235, 0.08352918922901154, -0.004858991131186485, -0.0016899715410545468, -0.00944249052554369, -0.06171021983027458, -0.0168050155043602, -0.002746311482042074, 0.02991843782365322, -0.020386412739753723, 0.027618078514933586, -0.0012104432098567486, 0.01848551630973816, 0.022025588899850845, -0.04099321737885475, 0.031075503677129745, -0.04435421898961067, 0.054464779794216156, -0.03143364191055298, 0.0005828379071317613, -0.03060716763138771, 0.034133464097976685, 0.04925797879695892, -0.00885018240660429, 0.015110739506781101, -0.03154383972287178, 0.026722729206085205, -0.008898393251001835, -0.0058610932901501656, 0.017535069957375526, -0.052729178220033646, 0.05578714236617088, 0.009194547310471535, 0.07520933449268341, -0.007293652277439833, -0.03460180386900902, 0.03272845596075058, -0.00911878701299429, 0.032756004482507706, 0.009731756523251534, 0.07796425372362137, 0.03807300329208374, -0.008168339729309082, -0.031819332391023636, 0.03914742171764374, 0.029284805059432983, 0.060883745551109314, -0.007142131682485342, 0.027315037325024605, -0.039037223905324936, -0.04515314847230911, -0.003393717808648944, -0.06854242086410522, -0.020923621952533722, -0.005038061179220676, -0.0025672416668385267, -0.05471272021532059, -0.017452422529459, 0.05283937603235245, -0.02125421166419983, 0.03909232094883919, -0.01770036481320858, 0.011184977367520332, -0.04586942866444588, -0.011012794449925423, -0.05217819660902023, 0.04322470352053642, -0.018127378076314926, 0.030083732679486275, -0.010489360429346561, -0.03672309219837189, -0.012624423019587994, -0.020000722259283066, 0.014070756733417511, 0.005671692546457052, -0.016185158863663673, -0.02066190354526043, 0.01701163500547409, 0.014353135600686073, -0.02873382158577442, -0.04424402490258217, 0.014725049957633018, -0.03168158605694771, -0.015441329218447208, -0.0338304229080677, -0.060112364590168, 0.028293034061789513, 0.006756442598998547, -0.02738391049206257, -0.0033231228590011597, -0.0015418946277350187, -0.08391488343477249, -0.02387138642370701, -0.021447056904435158, -0.007307426538318396, -0.014132742770016193, -0.03476709872484207, -0.02798999287188053, -0.013540434651076794, 0.026777828112244606, -0.0009952150285243988, 0.03292129933834076, 0.0016529522836208344, 0.01775546371936798, -0.021433282643556595, -0.04810091108083725, -0.027618078514933586, 0.030386773869395256, -0.02793489396572113, -0.00594374118372798, -0.026171745732426643, 0.010978358797729015, -0.02787979505956173, 0.04148910194635391, -0.007906622253358364, -0.034904845058918, -0.005644143559038639, -0.0031268347520381212, 0.013313153758645058, -0.029339903965592384, 0.006625583861023188, 0.06578750163316727, -0.012032115831971169, -0.002916772151365876, -0.01317540742456913, 0.032260119915008545, 0.018416643142700195, 0.0043355561792850494, 0.02789357118308544, 0.002384728053584695, -0.021378183737397194, 0.01386413723230362, -0.061820417642593384, -0.028788920491933823, 0.01922934502363205, -0.00578533299267292, -0.040662627667188644, -0.0004937334451824427, -0.013609307818114758, 0.009883277118206024, -0.039037223905324936, -0.00798238255083561, -0.004376879893243313, -0.07058106362819672, -0.025730958208441734, 0.04573168233036995, 0.01146735716611147, 0.017080508172512054, -0.0032439189963042736, -0.03548337519168854, 0.041709497570991516, -0.002632671035826206, 0.03286620229482651, 0.023196430876851082, -0.0313509963452816, 0.03570377081632614, 0.0769173800945282, -0.007073258515447378, -0.010027910582721233, 0.009848840534687042, 0.06650378555059433, 0.0494508221745491, 0.02571718394756317, 0.013402688317000866, 0.013209844008088112, 0.06705476343631744, -0.012562437914311886, -0.04250842332839966, -0.010964583605527878, -0.007638017181307077, 0.022232208400964737, 0.02793489396572113, -0.03391307219862938, 0.00939427874982357, 0.012218073010444641, -0.019408416002988815, 0.030634716153144836, 0.021667450666427612, -0.04925797879695892, 0.02604777365922928, -0.04586942866444588, -0.005451299250125885, 0.0024053899105638266, 0.06110413745045662, 0.0066772387363016605, 0.07085655629634857, 0.0005815465119667351, -0.0016064629890024662, -0.028265485540032387, 0.0157305970788002, 0.027011996135115623, 0.0017295735888183117, 0.00608148705214262, -0.04248087480664253, 0.03906477242708206, 0.0075415950268507, -0.08115995675325394, -0.05019465088844299, 0.030579617246985435, -0.030441872775554657, -0.020207341760396957, -0.05256388336420059, -0.002426052000373602, -0.0012026949552819133, -0.0554841011762619, 0.004208141006529331, 0.010510021820664406, -0.03969840332865715, -0.013044549152255058, 0.010833725333213806, -0.025152424350380898, 0.012982563115656376, -0.011343385092914104, 0.008044367656111717, 0.04939572513103485, 0.028045091778039932, -0.018650813028216362, -0.04512559995055199, -0.06066334992647171, -0.041599299758672714, 0.053362809121608734, -0.020345088094472885, -0.011398483999073505, 0.0420125387609005, 0.01433936133980751, -0.0016202375991269946, -0.02323775552213192, 0.012369593605399132, -0.02759052999317646, -0.027273712679743767, 0.005062166601419449, -0.023403050377964973, 0.021763872355222702, 0.0021212887950241566, 0.01775546371936798, -0.00267571653239429, -0.020840974524617195, 0.02378873899579048, -0.03672309219837189, -0.05545654892921448, 0.026860475540161133, 0.06688947230577469, -0.025469239801168442, -0.01695653609931469, -0.05884510278701782, -0.01943596452474594, 0.06385906040668488, -0.02392648532986641, 0.014821472577750683, -0.02392648532986641, 0.014077643863856792, -0.00030648490064777434, -0.014477107673883438, -0.021626126021146774, 0.01057889498770237, -0.018168700858950615, 0.039230067282915115, -0.024505019187927246, 0.020923621952533722, 0.03184688091278076, 0.0016254031797870994, -0.043830785900354385, -0.0020472502801567316, -0.0034126578830182552, 0.04490520432591438, -0.05730234831571579, -0.04044223204255104, 0.028899116441607475, 0.0007227361784316599, 0.028568526729941368, -0.003877550596371293, -0.0011708412785083055, -0.0007106834091246128, -0.031626489013433456, -0.01418784074485302, -0.030001085251569748, -0.0078377490863204, 0.054216835647821426, 0.004376879893243313, -0.01701163500547409, 0.04823865741491318, -0.006546379998326302, -0.015262260101735592, -0.04027693718671799, -0.01725957728922367, -0.032067276537418365, -0.003314513713121414, 0.003963641822338104, 0.001155344769358635, -0.012872366234660149, -0.03934026509523392, 0.006914850790053606, 0.027466557919979095, -0.02823793515563011, -0.024560116231441498, -0.02151593007147312, -0.021391957998275757, -0.014256713911890984, -0.026626307517290115, -0.03950555995106697, -0.02566208504140377, 0.04391343519091606, 0.03451915457844734, 0.0036984807811677456, -0.0986812561750412, -0.012252509593963623, -0.03889947757124901, -0.02967049367725849, 0.010076122358441353, 0.011033456772565842, 0.029973534867167473, 0.03358248248696327, 0.023816287517547607, 0.025028452277183533, -0.012617535889148712, -0.00870554894208908, 0.022080687806010246, -0.0009625003440305591, 0.028403230011463165, -0.001962880836799741, -0.00593341002240777, -0.05088338255882263, -0.050056904554367065, -0.005923079326748848, -0.005516728386282921, -0.02264544740319252, 0.012293833307921886, 0.01344401203095913, 0.0228933896869421, 0.010055460035800934, -0.01646064966917038, -0.013981222175061703, 0.021130241453647614, -0.0045111821964383125, -0.030910208821296692, 0.04027693718671799, -0.03303149715065956, 0.0004373436386231333, -0.048376403748989105, 0.0011536229867488146, 0.016185158863663673, 0.029973534867167473, 0.03741182014346123, 0.016047412529587746, -0.016198933124542236, 0.0024467138573527336, -0.006047050468623638, -0.02650233544409275, -0.030001085251569748, 0.0003837518161162734, 0.0022969150450080633, -0.03347228467464447, -0.025896253064274788, -0.011577554047107697, 0.022672995924949646, -0.023403050377964973, 0.009029252454638481, 0.044574614614248276, -0.036557797342538834, -0.03865153342485428, 0.032948851585388184, 0.06694456934928894, 0.03545582666993141, 0.018554389476776123, -0.026874249801039696, -0.015895891934633255, -0.0422329306602478, -0.019697681069374084, -0.08363939076662064, -0.0493406280875206, 0.04137890785932541, 0.020593030378222466, 0.036860838532447815, 0.041654396802186966, 0.059891972690820694, -0.004208141006529331, 0.03983614966273308, -0.042646169662475586, -0.010117446072399616, -0.0246152151376009, 0.005578713957220316, 0.035180334001779556, 0.023747414350509644, 0.040772825479507446, 0.016777466982603073, 0.0040738387033343315, 0.02022111602127552, -0.01320295687764883, 0.0017665928462520242, 0.014532205648720264, 0.007644904311746359, 0.012032115831971169, 0.0150556406006217, -0.05823902040719986, -0.0025465795770287514, 0.05151701346039772, 9.674506145529449e-05, -0.005051835440099239, -0.04496030509471893, -0.04248087480664253, -0.009256533347070217, -0.030937757343053818, 0.01943596452474594, -0.03697103261947632, -0.015248484909534454, 0.03248051181435585, -0.001895729685202241, -0.018554389476776123, -0.023995358496904373, 0.01183927059173584, -0.008409394882619381, -0.015427554957568645, 0.005110377445816994, 0.002847899217158556, -7.861208723625168e-05, 0.02610287256538868, 0.021777646616101265, 0.008023706264793873, 0.023471923545002937, -0.03969840332865715, 0.04796316847205162, -0.003564178477972746, 0.0540790893137455, -0.025179972872138023, 0.00017218253924511373, -0.030634716153144836, -0.012913689948618412, 6.241616938496009e-05, 0.006925181485712528, 0.030469421297311783, 0.06253669410943985, -0.014614853076636791, 7.204763096524402e-05, 0.05102112889289856, -0.026832927018404007, -0.04129625856876373, 0.053665854036808014, -0.033389635384082794, 0.014504657126963139, 0.002448435639962554, 0.03407836705446243, -0.0024673757143318653, 0.041461553424596786, -0.03278355300426483, 0.013829701580107212, -0.028293034061789513, -0.014435783959925175, -0.014325587078928947, 0.03768731281161308, 0.10755209624767303, 0.0540790893137455, -0.023127557709813118, -0.05879000574350357, -0.007417623419314623, 0.002283140318468213, -0.05476782098412514, 0.0373842716217041, -0.016405552625656128, 0.0017786455573514104, -0.007913509383797646, -0.003331732004880905, -0.023168882355093956, -0.02837568148970604, -0.009779968298971653, 0.0629223883152008, -0.019835427403450012, -0.015647947788238525, 0.022865841165184975, 0.0313509963452816, -0.020110920071601868, -0.013065210543572903, -0.008891506120562553, -0.021295536309480667, 0.04129625856876373, 0.005241236183792353, 0.03526298329234123, -0.01228694524616003, -0.004001521971076727, -0.026667630299925804, -0.0007830000831745565, -0.0301663801074028, 0.014070756733417511, -0.020896071568131447, 0.013809039257466793, -0.008746872656047344, -0.0002625783672556281, -0.029091961681842804, -0.023747414350509644, 0.0045111821964383125, -0.01606118679046631, -0.0074727218598127365, -0.09460397064685822, -0.060387857258319855, -0.0373842716217041, 0.024560116231441498, -0.012128537520766258, -0.005740565713495016, 0.037797510623931885, -0.005626925267279148, -0.0015746093122288585, -0.000802801048848778, -0.026281941682100296, 0.0010864718351513147, -0.008168339729309082, -0.021391957998275757, 0.004504295065999031, 0.020689453929662704, 0.032067276537418365, 0.017424872145056725, 0.001395539497025311, 0.01953238621354103, 0.013003225438296795, -0.02392648532986641, 0.014917895197868347, 0.014752599410712719, 0.004184035584330559, -0.017934532836079597, -0.020937396213412285, -0.028596075251698494, 0.047880519181489944, 0.02037263661623001, 0.03939536213874817, -0.028761370107531548, 0.004008409567177296, 0.004008409567177296, -0.018361546099185944, 0.004080725833773613, 0.015703046694397926, -0.019064050167798996, 0.010448035784065723, -0.006226120516657829, 0.02333417721092701, 0.01953238621354103, 0.04878964275121689, -0.048321306705474854, 0.0022228765301406384, 0.022962262853980064, 0.024904482066631317, -0.003887881524860859, 0.005929966457188129, 0.06551200896501541, -0.02090984769165516, -0.008588464930653572, 0.005137926898896694, -0.023967808112502098, -0.013685068115592003, -0.013106534257531166, -0.02798999287188053, -0.03691593557596207, 0.007796425372362137, 0.009290969930589199, 0.03581396862864494, -0.034629352390766144, -0.019711457192897797, 0.04118606075644493, -0.02323775552213192, -0.011212526820600033, -0.0029649832285940647, -0.008099466562271118, 0.012996337376534939, 0.026461012661457062, 0.00021232258586678654, 0.0062192329205572605, -0.04000144451856613, 0.041461553424596786, -0.010083009488880634, 0.00492097670212388, -0.020648129284381866, -0.04261862114071846, 0.008836407214403152, -0.008182113990187645, 0.005330771207809448, 0.025400366634130478, 0.009910826571285725, 0.021722547709941864, 0.014477107673883438, -0.011763510294258595, -0.013609307818114758, -0.0007339280564337969, -0.05449232831597328, -0.004049733281135559, 0.0050036245957016945, 0.055594295263290405, -0.011639539152383804, -0.001720103551633656, -0.0467509999871254, 0.030441872775554657, -0.014449558220803738, 0.010833725333213806, 0.008113240823149681, -0.018402868881821632, -0.00870554894208908, 0.027673177421092987, -0.016102511435747147, -0.0162127073854208, -0.004669590387493372, 0.004166817292571068, 0.0045284004881978035, 0.01404320728033781, -0.022163335233926773, 0.0018457967089489102, 0.02728748880326748, 0.02560698613524437, -0.04443686828017235, 0.02650233544409275, 0.015703046694397926, 0.004290788900107145, -0.027618078514933586, 0.020606806501746178, 0.01216297410428524, 0.026461012661457062, 0.04391343519091606, -0.03190198168158531, -0.031764235347509384, -0.00740384915843606, -0.02031753957271576, 0.009711095131933689, -0.018320221453905106, 0.024945804849267006, -0.018030954524874687, -0.009938376024365425, -0.01661217026412487, -0.012858591973781586, -0.007534707896411419, -0.02614419534802437, 0.008147677406668663, -0.02615797147154808, 0.007576031610369682, -0.0025999562349170446, 0.028899116441607475, 0.00911878701299429, 0.013788376934826374, 0.014972993172705173, -0.03203972429037094, 0.0003114351711701602, 0.059010397642850876, 0.01127451192587614, 0.01495921891182661, 0.0029305466450750828, 0.0037501356564462185, -0.019642584025859833, -0.05096603184938431, -0.01823757402598858, 0.009470039047300816, -0.051599662750959396, -0.010151882655918598, -0.02077210135757923, -0.042646169662475586, -0.006632470991462469, -0.015152063220739365, 0.029284805059432983, -0.019849201664328575, -0.041213613003492355, -0.024215752258896828, -0.016102511435747147, 0.003497027326375246, 0.020303765311837196, -0.028265485540032387, 0.014587304554879665, -0.01741109788417816, -0.015551526099443436, 0.03906477242708206, -0.01720447838306427, -0.02497335523366928, 0.0025310833007097244, -0.005224017892032862, -0.05228839069604874, -0.03327944129705429, -0.03212237358093262, -0.009511362761259079, -0.030772462487220764, 0.03931271657347679, 0.03768731281161308, -0.025441691279411316, -0.026392139494419098, -0.01770036481320858, -0.015468878671526909, 0.002136785304173827, 0.003774241078644991, -0.0031406094785779715, 0.02100626938045025, 0.006143472623080015, -0.014422008767724037, -0.030276576057076454, 0.015606625005602837, -0.021130241453647614, -0.029091961681842804, 0.0013619638048112392, 0.010055460035800934, -0.02778337337076664, -0.046888746321201324, -8.124863234115764e-05, -0.029036862775683403, 0.00420125387609005, -0.011859932914376259, 0.02772827446460724, -0.0067288936115801334, -0.004638597369194031, -0.005502953659743071, 0.01943596452474594, 0.004246021155267954, 0.014835246838629246, -0.018086053431034088, -0.025992674753069878, 0.03454670310020447, 0.0038706634659320116, -0.025372818112373352, -0.0011803113156929612, 0.02917460910975933, 0.01932576671242714, 0.007272990420460701, 0.017962081357836723, -0.0023192986845970154, -0.0075071584433317184, 0.0002066190354526043, 0.012252509593963623, -0.03936781361699104, -0.006697900593280792, 0.0027514768298715353, -0.01720447838306427, 0.013058323413133621, 0.008347408846020699, -0.02699822187423706, -0.003274911781772971, 0.029477650299668312, 0.024064231663942337, 0.0034143796656280756, -0.0030665709637105465, -0.03347228467464447, 0.011763510294258595, -0.01874723471701145, -0.004462971352040768, 0.0168050155043602, -0.00043949592509306967, 0.019367091357707977, 0.002704987535253167, -0.014490881934762001, 0.019367091357707977, 0.06308767944574356, 0.013574871234595776, -0.001053757150657475, -0.03347228467464447, -0.020234892144799232, 0.00479700556024909, 0.021144015714526176, -0.009773080237209797, 0.056090183556079865, 0.004080725833773613, -0.023719865828752518, 0.011040343903005123, 0.007520933169871569, 0.005110377445816994, 0.006374197546392679, -0.03429875895380974, -0.02581360563635826, 0.012362705543637276, -0.009435602463781834, 0.028651174157857895, -0.00347292167134583, 0.022962262853980064, -0.02797621861100197, -0.12837930023670197, -0.028017541393637657, 0.04391343519091606, 0.022920938208699226, -0.028706271201372147, -0.016130059957504272, 0.04292166233062744, -0.00793417077511549, -0.014077643863856792, -0.0009203156223520637, 0.0005264480714686215, -0.008147677406668663, 0.028348132967948914, 0.046998944133520126, 0.015344907529652119, -0.02512487582862377, -0.01480769831687212, 0.0012147477827966213, 0.0015969929518178105, -0.02026244066655636, -0.03074491396546364, 0.004070395138114691, 0.005595932248979807, 0.03622720390558243, -0.03289375081658363, 0.03776996210217476, -0.0086986618116498, -0.022383728995919228, 0.03385797515511513, 0.005106933880597353, 0.0020679121371358633, -0.0372740738093853, 0.05231594294309616, 0.0071145822294056416, -0.015758145600557327, 0.0008751177228987217, 0.003312791930511594, -0.003512523602694273, -0.0008604822214692831, 0.029202157631516457, 0.02980824001133442, -0.06165512278676033, 0.038183197379112244, -0.026433462277054787, -0.01606118679046631, -0.027204839512705803, 0.03272845596075058, -0.004063508007675409, 0.004266683012247086, -0.032645806670188904, 0.023168882355093956, -0.008519591763615608, -0.022672995924949646, -0.02432594820857048, 0.0372740738093853, 0.00436310563236475, 0.003791459370404482, 0.017287125810980797, -0.02545546554028988, -0.0004911506548523903, -0.017438646405935287, 0.0024363829288631678, 0.03771486133337021, -0.03030412644147873, -0.02837568148970604, -0.01582701876759529, -0.029835790395736694, 0.02210823819041252, 0.015179612673819065, -0.03203972429037094, 0.035180334001779556, -0.014587304554879665, 0.011522455140948296, 0.014559755101799965, 0.0007481331122107804, -0.015179612673819065, 0.014256713911890984, -0.02268677018582821, -0.03030412644147873, -0.02239750325679779, 0.032452963292598724, -0.010151882655918598, -0.0060091703198850155, 0.024394821375608444, 0.004104831721633673, 0.02115778997540474, -0.02476673573255539, 0.02472541108727455, -0.001907782512716949, 0.008478268049657345, 0.051599662750959396, 0.010668429546058178, -0.00549951009452343, -0.02051038295030594, -0.01967013254761696, -0.020799649879336357, -0.018719684332609177, 0.015207161195576191, 0.025469239801168442, 0.013416463509202003, 0.008195888251066208, 0.017218252643942833, -0.01938086561858654, 0.014725049957633018, -0.003746691858395934, 0.009711095131933689, 0.015110739506781101, 0.01436691079288721, 0.021736323833465576, -0.04035958647727966, 0.005744009278714657, -0.020992495119571686, -0.003581396769732237, 0.003901656251400709, 0.009339180774986744, -0.007644904311746359, 0.01206655241549015, 0.013967446982860565, 0.008919055573642254, -0.019367091357707977, -0.005988508462905884, 0.02749410644173622, 0.017535069957375526, 0.020951170474290848, -0.02254902385175228, -0.011550004594027996, -0.002699822187423706, 0.00026430017896927893, -0.03551092743873596, 0.028155287727713585, -0.007252328563481569, -0.0006814124062657356, 0.023416824638843536, 0.02793489396572113, 0.003598615061491728, 0.029009314253926277, -0.00354007282294333, 0.006687569431960583, 0.03405081853270531, 0.05697175860404968, -0.003359281225129962, -0.03592416271567345, 0.012369593605399132, 0.02012469433248043, -0.00393264926970005, 0.012073439545929432, 0.019463513046503067, -0.026474786922335625, -0.007755101192742586, -0.010076122358441353, 0.01421539019793272, 0.005561495665460825, -0.005492622964084148, -0.008312973193824291, 0.026075322180986404, 0.002601678017526865, 0.013877912424504757, -0.022122012451291084, -0.007452060002833605, 0.004111718852072954, 0.032948851585388184, 0.024794284254312515, 0.012500451877713203, -0.028293034061789513, 0.023251529783010483, -0.03190198168158531, -0.010124333202838898, -0.027163516730070114, 0.019146697595715523, 0.034932393580675125, -0.01421539019793272, -0.05493311583995819, -0.007238553836941719, 0.000996075919829309, 0.016749916598200798, 0.007624242454767227, -0.015400005504488945, 0.03460180386900902, 0.002364066196605563, 0.012679521925747395, 0.009580235928297043, -0.012707071378827095, -0.027315037325024605, 0.009614672511816025, 0.052674081176519394, -0.011853045783936977, 0.031819332391023636, 0.01741109788417816, 0.006198571063578129, 0.03950555995106697, 0.017342224717140198, 0.0035848403349518776, 0.015124513767659664, 0.029229706153273582, 0.0022814185358583927, 0.026171745732426643, -0.012541775591671467, 0.012741507962346077, -0.01406386960297823, -0.019091598689556122, -0.0028840573504567146, -0.0021953273098915815, 0.0013800429878756404, -0.001622820389457047, -0.05983687564730644, 0.03540072962641716, -0.00017724039207678288, -0.028169061988592148, 0.006773660890758038, 0.004142711870372295, 0.018210025504231453, 0.0037776848766952753, -0.005406531505286694, 0.018926303833723068, 0.0036123895552009344, -0.022025588899850845, 0.011942580342292786, 0.0289266649633646, -0.001548781874589622, -0.014201615005731583, -0.017232028767466545, -0.04856925085186958, 0.006804653909057379, -0.008423169143497944, -0.00900170300155878, -0.021185338497161865, 0.03399571776390076, 0.01661217026412487, 0.004924420267343521, -0.006498168688267469, -0.028458328917622566, -0.004573168233036995, -0.007534707896411419, -0.0024105554912239313, 0.010585782118141651, 0.010062347166240215, -0.011797946877777576, -0.006267444230616093, 0.012128537520766258, 0.020248666405677795, 0.02041396126151085, 0.02512487582862377, 0.008588464930653572, -0.028899116441607475, 0.03129589557647705, -0.01043426152318716, 0.005640699993818998, 0.028169061988592148, -0.020840974524617195, -0.006453401409089565, -0.011391596868634224, 0.032012175768613815, 0.03584151715040207, 0.008925942704081535, -0.013464674353599548, 0.024656539782881737, 0.0024570447858422995, 0.040111642330884933, 0.058018628507852554, 0.03958820924162865, -0.005162032321095467, 0.00973864458501339, 0.016405552625656128, -0.03347228467464447, -0.0036915934178978205, -0.030276576057076454, -0.01641932688653469, -0.0009599176119081676, 0.009711095131933689, 0.023251529783010483, -0.019146697595715523, 0.002129897940903902, 0.029973534867167473, 0.023802513256669044, 0.009070576168596745, -0.02763185277581215, 0.018457967787981033, 0.0035039144568145275, 0.01465617772191763, -0.0025207523722201586, 0.010654655285179615, -0.031709134578704834, -0.0010511743603274226, 0.014711275696754456, 0.005471961107105017, -0.02556566335260868, 0.023168882355093956, -0.0025138650089502335, 0.02734258584678173, 0.02739768475294113, 0.055098410695791245, 0.0235407967120409, -0.0007326366612687707, -0.017865659669041634, -0.011928806081414223, -0.02071700245141983, -0.007872185669839382, 0.0027807478327304125, -0.03989125043153763, -0.0017287126975134015, 0.017672814428806305, -0.006835646461695433, 0.0054409680888056755, -0.022425053641200066, 0.017452422529459, 0.01814115233719349, -0.0031113384757190943, -0.005864537321031094, -0.01213542465120554, -0.02115778997540474, 0.010661542415618896, 0.009476927109062672, 0.01933954283595085, 0.030386773869395256, 0.04350019618868828, 0.013409575447440147, -0.02625439316034317, -0.013905461877584457, -0.0003069153754040599, -0.018761008977890015, 0.002668829169124365, -0.014545980840921402, 0.015248484909534454, 0.007155905943363905, -0.0031406094785779715, -0.009945263154804707, 0.011598215438425541, 0.004679921083152294, 0.017135605216026306, 0.011832383461296558, 0.02803131565451622, 0.022810742259025574, 0.02056548185646534, -0.033251892775297165, -0.013540434651076794, 0.024546341970562935, 0.010441148653626442, 0.007135244086384773, -0.01611628569662571, 0.010248304344713688, -0.021860294044017792, 0.01714937947690487, 0.01933954283595085, -0.016322903335094452, -0.005675136111676693, 0.0018371876794844866, -0.029532747343182564, 0.04074527323246002, -0.00433899974450469, -0.020937396213412285, 0.08540253341197968, -0.051544561982154846, -0.020593030378222466, -3.685782212414779e-05, -0.02022111602127552, 0.010496247559785843, -0.019050275906920433, -0.00709392037242651, -0.014532205648720264, 0.030910208821296692, -0.030331674963235855, 0.03807300329208374, -0.02986333891749382, 0.0021781090181320906, 0.04366549104452133, -0.0009625003440305591, -0.0054409680888056755, 0.032067276537418365, 0.014380685053765774, 0.01596476510167122, 0.013292491436004639, -0.017287125810980797, 0.0034436506684869528, 0.00580943888053298, 0.011763510294258595, -0.01436691079288721, -0.026722729206085205, -0.002186718164011836, -0.0062364512123167515, 0.015041866339743137, 0.0010623661801218987, -0.016378002241253853, -0.04661325737833977, 0.0011028291191905737, 0.005971290171146393, -0.013106534257531166, -0.015344907529652119, 0.027769599109888077, -0.006587703712284565, -0.026240618899464607, -0.03564867004752159, -0.009208321571350098, -0.01228694524616003, 0.02604777365922928, -0.0005539972917176783, 0.020042046904563904, 0.013375138863921165, 0.03664044290781021, -0.01245912816375494, -0.012941239401698112, 0.046392861753702164, -0.014408234506845474, 0.040910571813583374, -0.016736142337322235, -0.008629788644611835, 0.018871204927563667, -0.004834885708987713, 0.032452963292598724, 0.01349911093711853, 0.014084530994296074, -0.050745636224746704, 0.03625475615262985, -0.03564867004752159, 0.03713632747530937, 0.011432920582592487, -0.025496790185570717, -0.0019594372715801, 0.0042219157330691814, -0.03035922534763813, 0.04735708236694336, -0.00450085150077939, 0.024987129494547844, -0.04564903303980827, 0.006718562450259924, -0.014545980840921402, 0.013161633163690567, -0.017424872145056725, 0.024064231663942337, -0.009284081868827343, 0.045704130083322525, -0.012796605937182903, -0.012569325044751167, -0.014477107673883438, -0.004080725833773613, 0.02873382158577442, 0.025965126231312752, -0.013154746033251286, 0.00046489282976835966, -0.027466557919979095, 0.013636856339871883, 0.005836987867951393, 0.023692317306995392, 0.028293034061789513, -0.006928625050932169, -0.014490881934762001, -0.016501974314451218, 0.03765976428985596, -0.025689633563160896, 3.279539305367507e-05, 0.021047592163085938, 0.0173973236232996, -0.02026244066655636, 0.013774602673947811, 0.040028996765613556, -0.017039183527231216, 0.004552506376057863, -0.07642149925231934, 0.011598215438425541, -0.005620038136839867, -0.002133341506123543, 0.006047050468623638, -0.01431181188672781, 0.026984447613358498, 0.01424293965101242, -0.007892847061157227, 0.025786057114601135, -0.02961539663374424, 0.016777466982603073, -0.0005152562516741455, -0.015799470245838165, 0.018265122547745705, -0.004893427714705467, 0.030001085251569748, -0.022190885618329048, -0.008919055573642254, 0.008967266418039799, -0.03267335891723633, -0.00297187059186399, -0.008650450967252254, 0.007334975991398096, -0.008932829834520817, 0.010633992962539196, -0.020400187000632286, -0.02373364008963108, -0.008044367656111717, 0.021681224927306175, 0.019491063430905342, -0.01013122033327818, -0.03534562885761261, 0.007266102824360132, -0.0023313516285270452, 0.0038500013761222363, 0.0008342243963852525, 0.013003225438296795, -0.018430419266223907, -0.004411316476762295, 0.017342224717140198, -0.03688838705420494, -0.0015625564847141504, 0.001714077079668641, 0.03179178386926651, -0.0019043388310819864, -0.009476927109062672, 0.01552397757768631, 0.008616014383733273, -0.009187660180032253, -0.0004687669570557773, -0.03559357300400734, -0.004239134024828672, 0.007941058836877346, 0.03573131933808327, 0.005675136111676693, -0.011019682511687279, 0.06253669410943985, 0.022369954735040665, 0.02812773920595646, -0.038238298147916794, -0.0046420409344136715, -0.016322903335094452, -0.01873346045613289, -0.006976836360991001, -0.04509804770350456, -0.01317540742456913, -0.01233515702188015, -0.046447958797216415, -0.023223979398608208, -0.022369954735040665, -0.011357160285115242, 0.0022865841165184975, 0.034381408244371414, -0.011288287118077278, -0.015813244506716728, 0.021088916808366776, 0.03994634747505188, -0.02115778997540474, 0.0061400290578603745, 0.022011814638972282, 0.022562799975275993, 0.013505998067557812, -0.0012147477827966213, 0.0013309710193425417, 0.0037845720071345568, 0.013554208911955357, -0.03446405753493309, 0.009724869392812252, 0.004735019523650408, -0.0008234629640355706, 0.011219413951039314, -0.008099466562271118, 0.037990354001522064, 0.006294993218034506, -0.03327944129705429, 0.019518611952662468, -0.01347156148403883, -0.006150360219180584, -0.023444373160600662, -0.01655707322061062, -0.021226663142442703, -0.01537245698273182, 0.008898393251001835, 0.03589661419391632, 0.009883277118206024, 0.018320221453905106, 0.018017180263996124, 0.003936092834919691, 0.03600681200623512, 0.041461553424596786, 0.002517308574169874, -0.005372094921767712, -0.02274186909198761, -0.020537933334708214, -0.02056548185646534, 0.01332692801952362, 0.020289989188313484, -0.018127378076314926, 0.013430237770080566, -0.005954071879386902, -0.0043355561792850494, 0.022122012451291084, 0.003536629257723689, 0.013678180053830147, -0.004827998112887144, -0.012893028557300568, -0.041654396802186966, 0.013120309449732304, -0.013161633163690567, -0.010213867761194706, -0.002551745157688856, -0.0005393617902882397, 0.024146879091858864, -0.0505252443253994, 0.020358862355351448, -0.006763329729437828, 0.002818627981469035, 0.00015098255244083703, 0.046998944133520126, 0.021681224927306175, 0.0067288936115801334, -0.03217747062444687, 0.014132742770016193, 0.006074599921703339, 0.025469239801168442, 0.002367509761825204, -0.02688802406191826, 0.015344907529652119, -0.01431181188672781, -0.020744550973176956, -0.03396816924214363, -0.026392139494419098, 0.003963641822338104, -0.04049733281135559, 0.013988109305500984, 0.01665349490940571, -0.0421227365732193, -0.028981763869524002, -0.0035331856925040483, -0.015565301291644573, 0.00708014564588666, -0.05228839069604874, -0.02881646901369095, -0.01666726917028427, 0.011453581973910332, 0.02367854118347168, 0.0033799430821090937, 0.029229706153273582, 0.035566024482250214, 0.007142131682485342, 0.00159441027790308, 0.011384708806872368, -0.0336100310087204, 0.02986333891749382, -0.03782505914568901, -0.02037263661623001, -0.009807516820728779, 0.007142131682485342, 0.017783012241125107, -0.011797946877777576, 0.002441548276692629, -0.021694999188184738, 0.01785188540816307, -0.03980860114097595, 0.0025207523722201586, 0.03498749062418938, -0.027618078514933586, -0.014449558220803738, 0.0012844817247241735, 0.022066913545131683, -0.033692676573991776, -0.0036915934178978205, 0.012128537520766258, -0.0042150286026299, -0.04942327365279198, -0.0168601144105196, 0.0037053681444376707, 0.01754884421825409, 0.0421227365732193, -0.021391957998275757, -0.02438104711472988, -0.017714139074087143, 0.004022183828055859, 0.008801971562206745, -0.0022521475329995155, -0.006814984604716301, 0.01972523145377636, -0.02774205058813095, 0.02911951020359993, -0.013953672721982002, -3.7126857932889834e-05, -0.005830100737512112, 0.008058142848312855, -0.028458328917622566, 0.022535249590873718, -0.0028823355678468943, 0.008733098395168781, 0.0233754999935627, -0.016887662932276726, 0.025827379897236824, 0.011818609200417995, -0.008788196370005608, -0.018513066694140434, -0.0013292491203173995, -0.014408234506845474, 0.018127378076314926, 0.0044319783337414265, 0.010069234296679497, -0.0038190085906535387, 0.005885199178010225, 0.009828179143369198, 0.013340702280402184, -0.030882658436894417, -0.006191683933138847, 0.006752999033778906, 0.01344401203095913, 0.008312973193824291, -0.038844380527734756, -0.006646245718002319, -0.014036320149898529, -0.007796425372362137, -0.006429295986890793, 0.021088916808366776, 0.006777104455977678, 0.014380685053765774, -0.018926303833723068, -0.020896071568131447, 0.0035951712634414434, 0.0028151844162493944, 0.02249392680823803, -0.009731756523251534, -0.01013122033327818, 0.001355076557956636, -0.014986767433583736, 0.0044319783337414265, -0.010916372761130333, 0.015041866339743137, -0.006856308318674564, -0.001206999528221786, 0.009786855429410934, -0.030634716153144836, -0.024560116231441498, -0.01982165314257145, 0.000643962703179568, 0.02314133197069168, 0.0205241572111845, 0.022907163947820663, 0.0010227642487734556, 0.002568963449448347, -0.0070181600749492645, -0.021295536309480667, 0.014711275696754456, -0.017245803028345108, 0.0008243238553404808, -0.022039365023374557, 0.017590167000889778, 0.0027945225592702627, 0.0006766773876734078, -0.0071145822294056416, 0.028568526729941368, 0.0038672196678817272, 0.011288287118077278]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"implies ψθ
t(s1:t, oT) =σ(oT|s1:t), as desired.
While sampling may be done using an arbitrary distribution over prefixes s1:tand observation oT, Eq. (FUDGE) requires
that rollouts be sampled under the base model p0(st+1:T|s1:t)in order to ensure sampling from the appropriate distribution
σ(y= 1|s1:t, oT). This restriction is similar to what we required in Eq. (CD-FUDGE), although the loss in Eq. (FUDGE) is
based on cross entropy classification rather than a squared error. We discuss the choices made in our experiments below.
Yang & Klein (2021) Setting In the original FUDGE paper, Yang & Klein (2021) consider learning from a dataset of
labelled examples (s1:T, oT)or(s1:t, oT)for a binary observation variable oT= 1which defines the target distribution.
29
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Unconditional Twist Setting For the unconditional twist experiments in Sec. 7.2.1-7.2.2, we sample under the base model
proposal πs(s1:t) =p0(s1:t)where the target distribution conditions on oT= 1andσ(oT= 1|s1:T) =ϕ(s1:T) =σ(y=
1|s1:T, oT= 1) . In particular, we optimize
min
θTX
t=1Ep0(s1:t)[LFUDGE (s1:t, oT= 1;θ)]
Conditional Twist Setting For conditional twist learning, we can consider amortizing learning the twists ψt(s1:t, oT)
over some distribution of observation variables πs(s1:t, oT). In particular, in our infilling experiments in Sec. 7.2.3, we
consider sampling under the following joint distribution,
πs(s1:t, oT) =p0(s1:t)σ(oT|s1:t),
which we can sample from by first sampling from p0(s1:T)σ(oT|s1:T)and then dropping st+1:Tsubsequence. Therefore,
the overall objective becomes
min
θEπs(s1:t,oT)[LFUDGE (s1:t, oT;θ)] (56)
= min
θTX
t=1−Ep0(s1:T)σ(oT|s1:t)
σ(oT|s1:T) logψθ
t(s1:t, oT) +
1−σ(oT|s1:T)
log
1−ψθ
t(s1:t, oT)
,
where the expectation p0(s1:T)includes the expectation under p0(st+1:T|s1:t)from Eq. (FUDGE). Note that rollout of
st+1:T|s1:tused to sample from p0(s1:T)should be independent of the rollout used to sample from σ(oT|s1:t).
D. Decoding Strategies using Learned Twists from Mudgal et al. (2023)
D.1. Proposal Sampling in Mudgal et al. (2023)
As noted in App. C.2 (and in L∗(θ)in Mudgal et al. (2023)), the CD losses can be seen as enforcing the optimality conditions
ψcd∗
t(s1:t) =X
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T), ∀t. (57)
In RL terms, we interpret the twists ψcd∗
tas performing policy evaluation of the expected unregularized ‘reward’ ϕ(s1:T)
under a fixed policy p0(s1:T). The notation of Mudgal et al. (2023) (their Eq. (1), (5), our Eq. (57)) indeed corresponds to
ϕ(s1:T) =:rcd(s1:T). (CD reward)
However, Mudgal et al. (2023) propose to use the learned twist functions ψθ
tto perform one-step sampling as
qcd
t(st|s1:t−1)∝p0(st|s1:t−1)eβ ψθ
t(s1:t)(CD proposal)
We proceed to explain that this scheme does not correspond to sampling from the twist-induced proposal under two different
definitions of the target σ(s1:T)(or potential ϕ(s1:T)) in our SMC framework.
Comparison with Our ϕ(s1:T) =","[0.006022364366799593, -0.03756276145577431, 0.013012910261750221, -0.011496317572891712, -0.025971656665205956, 0.013534239493310452, -0.00846313126385212, 0.0034343386068940163, -0.04065011069178581, 0.03821273148059845, 0.04528113827109337, -0.013236337341368198, -0.016601277515292168, 0.02342594787478447, 0.04132716357707977, -0.03084642067551613, 0.01833452843129635, -0.015531538985669613, -0.03940434008836746, 0.0369669571518898, -0.018050165846943855, -0.029194418340921402, -0.0007599891978316009, 0.01971571147441864, -0.0016333843814209104, -0.053649481385946274, 0.038673125207424164, 0.011476006358861923, 0.011543710716068745, -0.01285041868686676, 0.025497721508145332, -0.021719779819250107, -0.028084054589271545, -0.06851751357316971, -0.026621626690030098, 0.08081274479627609, 0.008036589249968529, 0.04612068086862564, -0.01539612840861082, 0.0033497074618935585, -0.011536940932273865, -0.06651344150304794, -0.027569497004151344, 0.035314954817295074, 0.024333195760846138, 0.03501705080270767, 0.004576861392706633, 0.006560619454830885, -0.007393391337245703, 0.0602845773100853, -0.032850489020347595, 0.04135424643754959, -0.022085387259721756, -0.011672350578010082, -0.016696065664291382, -0.011063004843890667, -0.0059614297933876514, -0.011239038780331612, 0.02307388186454773, -0.03396085277199745, 0.03100891225039959, -0.023656144738197327, 0.008253245614469051, -0.0034834248945116997, 0.013419141061604023, 0.0009317907388322055, -0.05513899400830269, 0.0563306026160717, -0.013033222407102585, 0.08612082153558731, -0.0024509227368980646, -0.0011594489915296435, 0.017156459391117096, 0.005958044435828924, 0.01903866045176983, -0.006909300573170185, 0.03379836305975914, 0.044983234256505966, -0.006222093943506479, -0.025795623660087585, 0.033527541905641556, -0.03434000164270401, 0.02960064820945263, -0.04116467013955116, 0.02854445017874241, -0.06450936943292618, -0.006770505104213953, -0.00338863767683506, -0.016425244510173798, -0.026865364983677864, -0.004641181323677301, 0.009702133946120739, -0.043385397642850876, 0.001746790250763297, 0.03287757188081741, 0.022979093715548515, 0.027867399156093597, 0.0038354911375790834, 0.01012867596000433, -0.00801627803593874, 0.026513297110795975, -0.03469206765294075, 0.02800280973315239, -0.03382544219493866, 0.05004757270216942, -0.0004654722288250923, -0.02556542679667473, 0.025782084092497826, -0.060122083872556686, 0.010568758472800255, -0.03331088647246361, -0.04717687889933586, -0.03463790565729141, 0.03807732090353966, 0.033744197338819504, -0.028842352330684662, -0.031604718416929245, 0.008023048751056194, -0.027759071439504623, -0.028273629024624825, -0.0613136924803257, -0.044631168246269226, 0.029438156634569168, 0.024360276758670807, 0.018740758299827576, 0.012146285735070705, -0.003439416643232107, -0.08000028878450394, 0.009404231794178486, 0.033581703901290894, 0.01328373048454523, 0.02960064820945263, -0.01971571147441864, -0.025145655497908592, -0.022058306261897087, -0.0031059691682457924, 0.008388656191527843, 0.01672314666211605, -0.00993910152465105, -0.00462764035910368, -0.013750895857810974, -0.054678600281476974, -0.04511864483356476, 0.012464500032365322, -0.007434014696627855, -0.005998667329549789, -0.06044707074761391, 0.025470640510320663, 0.0034072566777467728, 0.021354172378778458, -0.053974464535713196, -0.03220052272081375, -0.029438156634569168, 0.004526082426309586, -0.0032566129229962826, -0.04964134469628334, -0.01939072646200657, 0.053270332515239716, 0.01075156219303608, -0.019837580621242523, -0.0025575582403689623, 0.06781338155269623, -0.007014243397861719, -0.0061036101542413235, 0.008571458980441093, -0.03962099552154541, -0.03306714817881584, 0.031604718416929245, -0.05072462558746338, -0.013893076218664646, 0.019851120188832283, -0.028598614037036896, -0.018916791304945946, -0.03748151659965515, 0.01222753245383501, -0.027921563014388084, -0.005497650243341923, -0.06797587126493454, 0.01937718503177166, -0.02744762785732746, -0.020311515778303146, 0.04714979603886604, -0.0122478436678648, -0.025321688503026962, 0.018727216869592667, 0.00624917633831501, 0.026892445981502533, 0.02113751694560051, 0.01937718503177166, 0.019675087183713913, -0.019837580621242523, 0.04471241682767868, 0.06174700707197189, -0.008327721618115902, -0.04522697255015373, 0.025308147072792053, 0.06228864565491676, 0.042870838195085526, 0.0654301643371582, -0.009790150448679924, -0.004475303925573826, 0.039566829800605774, -0.04062303155660629, -0.044441595673561096, -0.024211326614022255, -0.0018838930409401655, -0.0198782030493021, 0.003283694852143526, -0.08021694421768188, 0.035152461379766464, 0.012200450524687767, -0.009438084438443184, 0.00897091906517744, 0.015125308185815811, -0.05681807920336723, 0.026404969394207, -0.04563320428133011, -0.015964850783348083, 0.0013854146236553788, 0.06391356885433197, 0.020541712641716003, 0.019323021173477173, 0.04381870850920677, 0.004069073591381311, -0.020704204216599464, 0.01884908601641655, -0.0035849823616445065, -0.012538975104689598, 0.03236301243305206, -0.0011763751972466707, 0.04419785737991333, 0.005023714620620012, -0.03545036539435387, -0.04227503389120102, 0.026404969394207, 0.018781380727887154, -0.029004843905568123, -0.012457729317247868, -0.023141587153077126, -0.06163867935538292, -0.022478077560663223, -0.025430016219615936, 0.019634464755654335, -0.043033331632614136, 0.0056296749971807, 0.04273542761802673, -0.016262752935290337, -0.002933321287855506, 0.026310183107852936, 0.02345302887260914, 0.0015800666296854615, -0.0023053570184856653, -0.0250102449208498, -0.01917407102882862, -0.05367656424641609, -0.0008784730453044176, 0.030575601384043694, -0.018442856147885323, -0.05289118364453316, 0.008483442477881908, 0.01688564009964466, -0.004617484286427498, -0.033527541905641556, 0.031604718416929245, -0.0258904118090868, -0.015274259261786938, -0.00545364199206233, -0.03983765095472336, 0.03837522119283676, -0.016154425218701363, -0.022437453269958496, 0.011022382415831089, -0.03485456109046936, 0.06716340780258179, -0.0007794544217176735, -0.0500204898416996, 0.0321192741394043, 0.042708344757556915, -0.0035375889856368303, 0.03263383358716965, -0.015030520968139172, -0.03084642067551613, 0.036533646285533905, -0.013588403351604939, 0.001021499978378415, -0.0007773386314511299, 0.015951309353113174, 0.027068478986620903, -0.028246546164155006, -0.027691366150975227, -0.014976357109844685, -0.014245142228901386, 0.03366295248270035, -0.01829390414059162, 0.00968859251588583, 0.033202555030584335, 0.01092759519815445, -0.004735968075692654, 0.015897145494818687, 0.02182810753583908, 0.018943872302770615, -0.020013613626360893, -0.021069811657071114, 0.03634406998753548, 0.0013177095679566264, 0.006140848156064749, 0.022329125553369522, 0.009424543008208275, 0.0030534977559000254, -0.003953975159674883, -0.018023084849119186, -0.007867326959967613, -0.022153092548251152, 0.013642568141222, 0.00032413791632279754, -0.018537642434239388, 0.04184172302484512, -0.00022913927386980504, 0.004691959824413061, -0.059417951852083206, -0.06499684602022171, 0.00130840006750077, -0.008090753108263016, 0.020311515778303146, -0.004949239082634449, -0.03485456109046936, -0.011123939417302608, -0.02674349583685398, -0.02132709138095379, -0.008801656775176525, 0.00932298507541418, -0.03146930783987045, 0.010148987174034119, 0.018943872302770615, -0.013669650070369244, -0.03580243140459061, -0.01073125097900629, 0.03331088647246361, 0.016086719930171967, 0.012633762322366238, -0.07485470175743103, 0.027190348133444786, 0.0062085529789328575, -0.04761018976569176, -0.042545855045318604, 0.03907935693860054, 0.009383919648826122, 0.0319838672876358, 0.05930962413549423, 0.02116459794342518, 0.0008298100437968969, -0.03507121652364731, 0.027325758710503578, -0.007508490234613419, 0.02694660983979702, -0.008916755206882954, -0.021205222234129906, -0.03130681440234184, -0.04598527029156685, -0.018253281712532043, -0.011564022861421108, -0.019932366907596588, 0.029871467500925064, 0.0032803097274154425, 0.0003529125824570656, 0.022234339267015457, 7.759633444948122e-05, -0.018009543418884277, 0.024793589487671852, -0.013893076218664646, 0.0024526154156774282, 0.016614818945527077, -0.03558577597141266, 0.013148320838809013, -0.05023714900016785, -0.020392760634422302, 0.015531538985669613, 0.003815179690718651, 0.07306729257106781, 0.026486216112971306, -0.028652777895331383, -0.012274925597012043, -0.005196362733840942, -0.01726478710770607, 0.008774574846029282, 0.0404876209795475, -0.0037474746350198984, -0.023737391456961632, -0.005876798182725906, -0.019119907170534134, -0.012992599047720432, -0.014529503881931305, -0.014935733750462532, 0.029844386503100395, -0.02063649892807007, -0.015084684826433659, 0.0066554066725075245, 0.06299278140068054, 0.05335158109664917, 0.049587178975343704, -0.05947211757302284, -0.01259990967810154, -0.06813836097717285, -0.01012867596000433, -0.06505101174116135, 0.03588367626070976, 0.02746116928756237, -0.0031753669027239084, 0.024942541494965553, 0.04563320428133011, 0.016601277515292168, -0.03940434008836746, 0.03119848668575287, -0.027366381138563156, 0.011645268648862839, -0.03983765095472336, 0.03436708450317383, -0.0029062393587082624, 0.05475984513759613, 0.07886284589767456, 0.003903196193277836, -0.015937769785523415, 0.005924191791564226, 0.010142216458916664, -0.028246546164155006, 0.018740758299827576, 0.04525405541062355, 0.017494985833764076, 0.03818564862012863, -0.04284375533461571, 0.013974322006106377, 0.05392030254006386, 0.034394167363643646, -0.015721112489700317, -0.015193013474345207, -0.03325672075152397, 0.039377257227897644, -0.019052201882004738, -0.032308850437402725, -0.07106322050094604, -0.011029153130948544, 0.019160529598593712, -0.004773206077516079, 0.0010062663350254297, -0.03772525489330292, 0.02199060097336769, -0.03599200397729874, -0.05725139006972313, 0.014800324104726315, 0.0033463221043348312, 0.013642568141222, -0.006245790980756283, 0.0467977300286293, -0.02606644481420517, 0.008327721618115902, -0.025497721508145332, 0.06960079073905945, 0.010981759056448936, 0.041110508143901825, -0.03561285510659218, -0.006665562279522419, 0.005612748675048351, -0.00734599819406867, 0.0015741423703730106, 0.018564725294709206, 0.03926892951130867, 0.039539750665426254, -0.000417655537603423, 0.0027488251216709614, 0.021435419097542763, -0.02797572687268257, -0.01190254744142294, 0.01833452843129635, 0.03452957421541214, -0.00505756726488471, -0.016858557239174843, 0.05389321967959404, -0.06402189284563065, 0.025606049224734306, 0.015193013474345207, 0.010616151615977287, 0.002780984854325652, 0.00846313126385212, 0.023534275591373444, 0.013500386849045753, 0.07935032248497009, 0.037941910326480865, -0.023128045722842216, -0.021949976682662964, 0.01382537093013525, -0.012857189401984215, -0.0415167361497879, 0.0043669757433235645, -0.015761734917759895, 0.005778626073151827, -0.032471343874931335, 0.034773312509059906, 0.017359575256705284, -0.05213288962841034, -0.02712264284491539, 0.03588367626070976, 0.022247878834605217, 0.028788186609745026, 0.052024561911821365, 0.03279632702469826, 0.06055539846420288, 0.00301456730812788, -0.022464536130428314, -0.0016951651778072119, 0.02165207453072071, 0.005345313809812069, 0.022058306261897087, -0.003358170622959733, 0.0021665615495294333, 0.0020243809558451176, 0.0038185648154467344, -0.04495615512132645, -0.021706238389015198, -0.010006806813180447, 0.013757666572928429, -0.006838209927082062, -0.011428612284362316, -0.04333123192191124, -0.011049464344978333, 0.022220797836780548, -0.01215305645018816, -0.00827355682849884, -0.11580272018909454, -0.04389995336532593, -0.04260001704096794, 0.008510524407029152, -0.011773908510804176, 0.01865951158106327, 0.0049221571534872055, -0.00769806420430541, 0.0029485549312084913, -0.026621626690030098, -0.0050270999781787395, 0.003028108272701502, -0.011855154298245907, -0.009526100941002369, 0.007312145549803972, -0.022667650133371353, 0.012620221823453903, 0.021706238389015198, -0.00011435805936343968, -0.0014294228749349713, -0.018375150859355927, -0.0026861978694796562, 0.015626326203346252, 0.035477448254823685, -0.0035206626635044813, -0.034258756786584854, -0.018970955163240433, -0.0019228234887123108, 0.00784024503082037, 0.0098646255210042, 0.00907924771308899, -0.013439452275633812, 0.01038595475256443, 0.02678411826491356, -0.022450994700193405, -0.005074493587017059, 0.00652338145300746, 0.003981057088822126, 0.016872098669409752, 0.015030520968139172, -0.0012009183410555124, 0.016614818945527077, 0.017156459391117096, -0.06629678606987, 0.024712342768907547, 0.016993967816233635, -0.028084054589271545, -0.023656144738197327, -0.01799600198864937, 0.04083968698978424, -0.011096857488155365, -0.014380552805960178, 0.005731232464313507, -0.024157162755727768, -0.017210623249411583, 0.007359539158642292, -0.027786152437329292, -0.03823981434106827, 0.03312131017446518, 0.009289133362472057, -0.0030585755594074726, -0.007285063620656729, -0.01539612840861082, 0.024780048057436943, 0.005338543094694614, -0.015193013474345207, 0.013480075635015965, -0.03840230405330658, 0.010744791477918625, 0.002261348767206073, 0.00801627803593874, -0.02482067234814167, -0.00453285314142704, 0.013087386265397072, 0.008456360548734665, 0.018727216869592667, -0.010683856904506683, -0.04842265322804451, 0.049722589552402496, -0.0598512664437294, 0.01639816351234913, 0.026201855391263962, 0.009187575429677963, 0.0387272872030735, 0.011638497933745384, -0.0020514631178230047, -0.023141587153077126, 0.011740055866539478, -0.027366381138563156, 0.0409209318459034, -0.002307049697265029, 0.04314165934920311, -0.007718375883996487, -0.009817232377827168, -0.04720396175980568, 0.032308850437402725, -0.03385252505540848, -0.0052809938788414, 0.009553182870149612, 0.001227154047228396, -0.03100891225039959, 0.006628324277698994, 0.007007472682744265, -0.03463790565729141, -0.010352102108299732, 0.00130840006750077, 0.02394050545990467, 0.009532870724797249, -0.03182137385010719, -0.007081948220729828, -0.0050812638364732265, 0.004218024667352438, -0.016465868800878525, 0.014488880522549152, 0.009207886643707752, -0.012213991023600101, -0.030006878077983856, 0.04452284052968025, -0.010419807396829128, 0.0021597910672426224, 0.047095634043216705, -0.028815269470214844, -0.008348032832145691, -0.022234339267015457, -0.022302044555544853, 0.02130000852048397, -0.023723850026726723, 0.039864733815193176, -0.026513297110795975, 0.022572863847017288, -0.0020599262788891792, -0.00897091906517744, -0.003869343549013138, -0.014421176165342331, -0.0027843702118843794, 0.00585310161113739, 0.0010561988456174731, -0.0030399567913264036, 0.02763720229268074, 0.024793589487671852, 0.04609359800815582, -0.004346664063632488, -0.006567389704287052, -0.036181580275297165, 0.04750186204910278, 0.013175402767956257, -0.014949275180697441, -0.014840947464108467, -0.01814495399594307, -0.0028605384286493063, -0.06478019058704376, 0.0013177095679566264, 0.030358944088220596, -0.02938399277627468, -0.024604015052318573, -0.038510631769895554, -0.01952613703906536, -0.0053351582027971745, 0.013094156980514526, 0.024793589487671852, -0.0244956873357296, -0.014624291099607944, 0.019106365740299225, -0.022586405277252197, -0.004194328095763922, 0.031794290989637375, -0.021746862679719925, -0.0006063833716325462, -0.030954748392105103, -0.02413007989525795, 0.009898478165268898, -0.005974970757961273, -0.041652146726846695, -0.01023023296147585, 0.01903866045176983, -0.03171304613351822, -0.02678411826491356, -0.018239740282297134, -0.022816602140665054, 0.005111731123179197, 0.01952613703906536, 0.01620858907699585, -0.005988511722534895, 0.00959380529820919, -0.005568740423768759, -0.029113171622157097, 0.028138218447566032, -0.02763720229268074, -0.003781327046453953, 0.007163194473832846, 0.0017687944928184152, 0.002960403449833393, -0.001489511108957231, -0.016872098669409752, -0.008693328127264977, -0.03818564862012863, -0.005352084059268236, 0.00958703551441431, -0.016140883788466454, -0.05297243222594261, 0.010961447842419147, -0.017887674272060394, -0.010372413322329521, 0.0034072566777467728, 0.013161862269043922, 0.02093440108001232, -0.02024381048977375, -0.013669650070369244, 0.033202555030584335, 0.01799600198864937, 0.02802989073097706, -0.00015307689318433404, 0.005260682199150324, 0.01692626252770424, -0.021056270226836205, -0.05408279597759247, 0.03710236772894859, 0.04666231945157051, 0.04457700625061989, 0.033744197338819504, 0.03699404001235962, -0.00211578281596303, -0.003974286373704672, -0.018767839297652245, 0.012092121876776218, -0.0369669571518898, -0.01171974465250969, -0.006800972390919924, -0.007494949270039797, 0.006506455130875111, -0.006418438628315926, -0.03669613599777222, -0.013459764420986176, 0.04793517664074898, 0.01143538299947977, -0.013987863436341286, 0.0021631764248013496, -0.0362357422709465, -0.012511893175542355, -0.027569497004151344, -0.008104294538497925, -0.0037373187951743603, 0.010155757889151573, -0.014854487963020802, 0.026174772530794144, 0.0035037363413721323, 0.025064410641789436, 0.06331776082515717, 0.003865958424285054, 0.0022291888017207384, 0.012315548956394196, -0.026865364983677864, -0.020744826644659042, 0.0021919510327279568, -0.005524732172489166, -0.002330746268853545, -0.027718447148799896, -0.0472310446202755, -0.00761681841686368, -0.019323021173477173, -0.018402231857180595, 0.013974322006106377, -0.03114432282745838, -0.0013837219448760152, -0.0032210678327828646, -0.005111731123179197, 0.01935010403394699, -0.008930295705795288, 0.03572118282318115, 0.0016985504189506173, -0.11547773331403732, -0.029140254482626915, 0.02748825028538704, 0.015788817778229713, 0.03691279515624046, -0.014543045312166214, 0.0244956873357296, -0.011144251562654972, 0.01496281661093235, -0.020338596776127815, -0.02253224141895771, -0.019945908337831497, 0.003639146452769637, 0.017819968983530998, 0.036019086837768555, -0.034231673926115036, 0.016425244510173798, -0.019634464755654335, 0.0025744845625013113, 0.01604609750211239, -0.002213955158367753, 0.019661545753479004, -0.0009140181937254965, 0.07025075703859329, -0.02375093102455139, -0.026648707687854767, 0.015355505049228668, 0.0027640587650239468, 0.021570829674601555, -0.005754929501563311, -0.004058917984366417, -0.000248392898356542, 0.006371045485138893, 0.03130681440234184, -0.007075177971273661, 0.0021817951928824186, -0.022071845829486847, -0.011191644705832005, -0.01337851770222187, -0.0024424598086625338, 0.038456469774246216, -0.046933140605688095, 0.07431306689977646, 0.019228234887123108, 0.019688628613948822, -0.011144251562654972, 0.02078545093536377, -0.028246546164155006, 0.003933663479983807, -0.035667020827531815, 0.027393463999032974, 0.007596506737172604, -0.008375114761292934, -0.030331863090395927, -0.010027118027210236, 0.014312847517430782, -0.006723111495375633, 0.023304078727960587, 0.003869343549013138, 0.011509859003126621, -0.0125051224604249, 0.033879607915878296, 0.0535411536693573, -0.02041984349489212, -0.049018457531929016, -0.013933699578046799, -0.025037327781319618, 0.02253224141895771, 0.015084684826433659, -0.03569410368800163, 0.01153017021715641, -0.009106329642236233, 0.014705536887049675, 0.019783414900302887, 0.00013720850984100252, -0.011943170800805092, 0.010365643538534641, 0.025132114067673683, -0.03929601237177849, -0.0030162599869072437, 0.038104403764009476, -0.05302659422159195, 0.02146250195801258, 0.011909318156540394, -0.007508490234613419, 0.040568865835666656, -0.012085351161658764, 0.009018313139677048, -0.04260001704096794, 0.0321192741394043, 0.030358944088220596, 0.018727216869592667, 0.009702133946120739, -0.05248495563864708, -0.01469199638813734, -0.017928296700119972, -0.052945349365472794, 0.03182137385010719, 0.0464998297393322, 0.010223462246358395, 0.009228198789060116, 0.04438742995262146, -0.0276507418602705, -0.014136814512312412, 0.005000018049031496, 0.025253983214497566, -0.001110362820327282, 0.024346735328435898, 0.0311714056879282, -0.038293976336717606, -0.00150728365406394, -0.016682524234056473, -0.06775921583175659, -0.02748825028538704, -0.003166903741657734, 0.014624291099607944, 0.04593110457062721, 0.0379960760474205, 0.03119848668575287, 0.007149653509259224, 0.012146285735070705, -0.007610047701746225, -0.015260718762874603, 0.02307388186454773, -0.029194418340921402, -0.027082020416855812, 0.007637129630893469, -0.01601901464164257, -0.01197702344506979, -0.004847681615501642, 0.012823336757719517, -0.027515333145856857, 0.04335831478238106, 0.02201768197119236, -0.008239705115556717, 0.04346664249897003, 0.025931034237146378, -0.007136112544685602, -0.01557216141372919, 0.02746116928756237, 0.01337851770222187, -0.013581633567810059, 0.03471915051341057, 0.026851823553442955, 0.030006878077983856, 0.0029874853789806366, 0.016520032659173012, -0.008253245614469051, -0.013087386265397072, 0.003341244300827384, 0.02027089148759842, -0.007271522656083107, -0.018402231857180595, 0.01222753245383501, -0.01867305301129818, 0.007075177971273661, -0.014109732583165169, -0.030927667394280434, -0.011638497933745384, 0.010169298388063908, 0.03239009529352188, 0.05175374075770378, 0.010934365913271904, -0.017671018838882446, 0.02234266698360443, 0.0042789592407643795, -0.016980426385998726, 0.0018534257542341948, -0.018415773287415504, 0.010054199956357479, -0.009891707450151443, -0.04471241682767868, 0.018266823142766953, 0.042708344757556915, -0.0011543710716068745, 0.010636463761329651, -0.01670960709452629, 0.04100218042731285, 0.014813864603638649, -0.0068856035359203815, 0.002098856493830681, 0.04016263782978058, -0.010859889909625053, 0.00941777229309082, 0.026296641677618027, -0.008693328127264977, -0.0009292518370784819, 0.013067075051367283, 0.001944827614352107, 0.02658100239932537, -0.0033158548176288605, 0.04265418276190758, -0.01616796664893627, 0.04471241682767868, 0.03431291878223419, 0.01936364360153675, -0.032308850437402725, 0.01207181066274643, -0.010006806813180447, -0.04335831478238106, -0.02606644481420517, 0.00827355682849884, -0.011949941515922546, -0.01267438568174839, -0.01540966983884573, 0.024780048057436943, -0.029004843905568123, 0.01672314666211605, 0.00774545781314373, 0.0024289186112582684, 0.014136814512312412, -0.006838209927082062, -0.00016185738786589354, 0.01956675946712494, 0.015978392213582993, -0.044306185096502304, 0.03420459106564522, -0.01570757105946541, -0.04433326795697212, -0.013419141061604023, -0.019336562603712082, -0.021611452102661133, -0.016628360375761986, -0.01619504764676094, -0.020297974348068237, -0.002213955158367753, 0.028625695034861565, 0.01828036457300186, -0.008131376467645168, 0.0005170973017811775, 0.005822634324431419, 0.017738724127411842, -0.024590473622083664, -0.0024086071643978357, -0.01513884961605072, -0.0038253352977335453, 0.001309246406890452, -0.02609352581202984, 0.004058917984366417, -0.005886954255402088, 0.016858557239174843, 0.0059783561155200005, -0.0035003512166440487, -0.019052201882004738, 0.027867399156093597, -0.011164562776684761, 0.006699414923787117, 0.030954748392105103, -0.029627729207277298, -0.02536231279373169, -0.020704204216599464, 0.028950680047273636, 0.026161231100559235, -0.023155126720666885, 0.0009360223193652928, 0.02394050545990467, -0.004346664063632488, 0.07019659876823425, 0.04844973236322403, 0.018388692289590836, -0.0075288014486432076, 0.018104329705238342, -0.008341262117028236, -0.019769875332713127, 0.013960781507194042, -0.03369003161787987, 0.009654739871621132, 0.009126640856266022, -0.043737463653087616, -0.006475988309830427, 0.010331790894269943, -0.00299087050370872, 0.02445506490767002, 0.043574970215559006, 0.014637831598520279, -0.0015842982102185488, 0.006611397955566645, -0.00625256123021245, -0.008903213776648045, 0.040243882685899734, -0.021002106368541718, -0.03203802928328514, -0.02093440108001232, -0.0394585020840168, 0.030223535373806953, 0.009979724884033203, 0.02591749280691147, -0.011536940932273865, 0.025281066074967384, 0.010981759056448936, 0.03891686350107193, 0.01886262744665146, -0.03141514211893082, -0.006113766226917505, 0.009702133946120739, -0.016249211505055428, 0.016276294365525246, 0.019620923325419426, -0.015179472044110298, -0.013656108640134335, -0.0015851445496082306, 0.030548518523573875, -0.003547744592651725, 0.014380552805960178, 0.013757666572928429, 0.0029942558612674475, 0.007989196106791496, 0.018970955163240433, -0.023480111733078957, -0.021394796669483185, -0.0028893130365759134, -0.014339929446578026, 0.00288762035779655, 0.015016980469226837, 0.047962259501218796, 0.00652338145300746, -0.007670982275158167, 0.0003522778279148042, 0.007853785529732704, -0.005815864074975252, 0.002027766313403845, -0.026878904551267624, 0.01828036457300186, 0.009228198789060116, -0.005710920784622431, -0.014719078317284584, 0.009113099426031113, -0.01469199638813734, 0.01588360406458378, 0.009790150448679924, -0.0018195732263848186, 0.03014228865504265, -0.00898446049541235, -0.028977761045098305, 0.006702799815684557, -0.005605977959930897, -0.007061636541038752, 0.012891042046248913, -0.013832141645252705, -0.03100891225039959, 0.004414369352161884, -0.010094823315739632, -0.010771873407065868, -0.00993910152465105, 0.01075156219303608, -0.0027031241916120052, 0.0046750339679419994, 0.00440421374514699, 0.01277594268321991, -0.03415042906999588, 0.07577548921108246, -0.0017256324645131826, -0.022627027705311775, 0.003906581550836563, -0.00677389046177268, -0.00799596682190895, -0.029356909915804863, -0.006960079073905945, -0.0397564060986042, -0.011015611700713634, -0.030900584533810616, 0.04197712987661362, -0.018564725294709206, 0.02025735192000866, 0.03545036539435387, 0.00466149253770709, -0.024346735328435898, 0.016520032659173012, 0.014421176165342331, 0.013520698994398117, 0.02008131891489029, 0.015978392213582993, -0.029844386503100395, -0.0002082988212350756, -0.006093454547226429, -0.011225497350096703, -0.009377149865031242, -0.015463833697140217, -0.018591806292533875, 0.010379184037446976, 0.013155091553926468, -0.01868659444153309, -0.045335300266742706, -0.007237670011818409, 0.0049052308313548565, -0.016641901805996895, -0.027583038434386253, 0.0032972360495477915, -0.02357489801943302, -0.002202106872573495, -0.015558620914816856, 5.215404598857276e-05, 0.0049729361198842525, -0.010710938833653927, -0.025633132085204124, 0.019959449768066406, -0.0010976680787280202, 0.005264067556709051, 0.011746826581656933, 0.028625695034861565, 0.022302044555544853, -0.01834806799888611, 0.018984496593475342, -0.006628324277698994, 0.007657441310584545, -0.011245808564126492, -0.022667650133371353, 0.028977761045098305, 0.012552516534924507, -0.01039949618279934, -0.02607998624444008, 0.030711010098457336, -0.01638462208211422, 0.016452327370643616, 0.003568056272342801, -0.02518627792596817, -0.0037644007243216038, 0.018578266724944115, -0.0015732961473986506, 0.040243882685899734, 0.018104329705238342, 0.006306725554168224, -0.02392696402966976, 0.00691945618018508, -0.008774574846029282, -0.010006806813180447, -0.013608715496957302, 0.035829514265060425, -0.035125378519296646, 0.03685862943530083, -0.004089385271072388, 0.00914018228650093, 0.012098892591893673, 0.004197712987661362, 0.008869362063705921, 0.044847823679447174, 0.004597173072397709, -0.010006806813180447, -0.02797572687268257, 0.004536238498985767, -0.013087386265397072, 0.024387359619140625, 0.029708975926041603, 0.002049770439043641, 0.0030298009514808655, -0.03401501849293709, 0.027366381138563156, -0.03658780828118324, 0.01135413721203804, 0.012951976619660854, -0.010704168118536472, -0.0225186999887228, 0.051347509026527405, 0.022288503125309944, -0.021381255239248276, -0.0027640587650239468, -0.033879607915878296, -0.027027856558561325, 0.020893778651952744, 0.027528872713446617, -0.00933652650564909, -0.003276924369856715, 0.008876131847500801, 0.03788774460554123, 0.014434716664254665, 0.010758332908153534, -0.04882888123393059, 0.03907935693860054, -0.01374412514269352, -0.04422494024038315, 0.017224164679646492, -0.011144251562654972, 0.009905248880386353, 0.02150312438607216, 0.021394796669483185, -0.00801627803593874, 0.001939749694429338, -0.009675052016973495, 0.003777941921725869, 0.03431291878223419, -0.017684558406472206, 0.009715674445033073, 0.006056216545403004, -0.009383919648826122, 0.007339227478951216, -0.01374412514269352, -0.008700098842382431, 0.003419104963541031, -0.00418417202308774, -0.004417754709720612, 0.021083353087306023, 0.005419789347797632, -0.0032989284954965115, 0.024224866181612015, 0.005301305558532476, -0.00380840920843184, -0.012803024612367153, -0.014719078317284584, 0.0165741965174675, 0.02802989073097706, 0.00286223110742867, -0.00978337973356247, -0.005176051054149866, 0.0376981720328331, 0.03119848668575287, -0.002283352892845869, 0.004603943321853876, -0.05876798555254936, 0.022302044555544853, 0.00907924771308899, 0.033527541905641556, -0.01566694863140583, 0.017671018838882446, 0.007549113128334284, 0.028084054589271545, -0.0003675114712677896, 0.007657441310584545, -0.021245844662189484, -0.0011611416703090072, -0.012396794743835926, -0.0055450438521802425, 0.001496281591244042, 0.0020785450469702482, -0.028056973591446877, -0.030386026948690414, -0.015341964550316334, -0.01382537093013525, -0.020677123218774796, -0.025931034237146378, 0.01585652306675911, -0.02006777748465538, -0.026025820523500443, 0.052809938788414, 0.03309422731399536, -0.012586369179189205, 0.009194346144795418, 0.01991882547736168, 0.0170887541025877, 0.011117169633507729, 0.005304690916091204, 0.007244440261274576, -0.006303340196609497, 0.0027437470853328705, -0.014204519800841808, 0.017197083681821823, -0.008483442477881908, 0.0033192401751875877, -0.005169280804693699, -0.025118574500083923, 0.027054937556385994, -0.0066215540282428265, -0.00978337973356247, 0.009289133362472057, 0.00933652650564909, -0.01058229897171259, -0.027014315128326416, -0.0024746195413172245, -0.006597856990993023, -0.0066384803503751755, 0.012924893759191036, 0.012362942099571228, 0.012593138962984085, 0.02092086151242256, 0.031442224979400635, 0.028598614037036896, 0.01565340720117092, 0.01990528404712677, -0.000887782487552613, 0.0019989917054772377, -0.008144917897880077, -0.009925560094416142, 0.014448258094489574, 0.0067637343890964985, 0.013777977786958218, -0.028084054589271545, 0.010819267481565475, 0.006465832237154245, -0.007819932885468006, 0.012478040531277657, 0.022071845829486847, 0.047095634043216705, -0.02234266698360443, -0.026323724538087845, -0.02802989073097706, 0.006953308824449778, -0.004194328095763922, 0.009844314306974411, -0.0016105339163914323, -0.01971571147441864, -0.002972251735627651, -0.042004212737083435, 0.006628324277698994, 0.0035951382014900446, -0.001442963839508593, -0.007786080706864595, 0.07198400795459747, -0.006113766226917505, 0.002811452141031623, -0.03517954424023628, 0.008334491401910782, -0.0030534977559000254, 0.0316859632730484, 0.0010181147372350097, -0.010744791477918625, 0.005484109278768301, -0.007305374834686518, -0.000899630831554532, -0.04037929326295853, 0.03764400631189346, 0.021882273256778717, -0.008388656191527843, 0.0042247953824698925, 0.00906570628285408, 0.0061543891206383705, 0.001944827614352107, 0.010101593099534512, -0.014840947464108467, -0.005176051054149866, -0.04492907226085663, -0.009411001577973366, -0.001209381502121687, 0.01020992174744606, 0.017305411398410797, 0.002594796009361744, 0.001098514418117702, 0.03780649974942207, 0.03298589959740639, -0.002857153071090579, 0.003832105780020356, -0.010338561609387398, 0.045172810554504395, -0.014312847517430782, 0.014258683659136295, 0.009113099426031113, 0.007853785529732704, -0.01337851770222187, -0.0369669571518898, 0.002874079393222928, -0.007251210976392031, 0.024522770196199417, -0.02518627792596817, -0.0017103988211601973, 0.023507192730903625, -0.0341775082051754, -0.038646042346954346, -0.02009485848248005, 0.01565340720117092, -0.04013555496931076, -0.013974322006106377, 0.037237778306007385, -0.015937769785523415, -0.01741373911499977, -0.007041325327008963, 0.010717709548771381, 0.03190261870622635, 0.02870694175362587, -0.026350805535912514, 0.035152461379766464, -0.01549091562628746, -0.020541712641716003, 0.015775276347994804, 0.010589069686830044, 0.020162563771009445, -0.004664877895265818, -0.03263383358716965, 0.013764436356723309, -0.023737391456961632, 0.020514629781246185, -0.012924893759191036, 0.010981759056448936, -0.026120608672499657, 0.016113802790641785, 0.0049763210117816925, 0.03910643607378006, 0.01549091562628746, -0.012356171384453773, -0.010778644122183323, -0.01436701137572527, -0.0011196723207831383, -0.023195751011371613, 0.012593138962984085, -0.020203186199069023, -0.011252579279243946, 0.027258053421974182, -0.002056540921330452, 0.006459061987698078, 0.018808463588356972, 0.008354803547263145, 0.024008210748434067, -0.026134150102734566, 0.003838876262307167, 0.005369010381400585, -0.04685189574956894, -0.004441451281309128, -0.02621539495885372, 0.018036626279354095, 0.00043542811181396246, 0.008930295705795288, 0.008260016329586506, -4.929112947138492e-06, 0.03748151659965515, 0.012193679809570312, -0.01566694863140583, -0.009573494084179401, 0.004509156569838524, -0.003974286373704672, 0.02063649892807007, -0.00015783739218022674, -0.022830143570899963, 0.013771207071840763, -0.027285136282444, -0.0024526154156774282, 0.014773242175579071, 0.008314180187880993, 0.005030485335737467, 0.0031025840435177088, -0.006800972390919924, -0.01953967846930027, 0.001980372704565525, -0.01899803802371025, 0.00037026198697276413, 0.0384293869137764, 0.006181471049785614, 0.019431348890066147, -0.031035995110869408, -0.04203129559755325, -0.030873503535985947, -0.02182810753583908, 0.022979093715548515, -0.003622220130637288, 0.014732618816196918, -0.027691366150975227, 0.004576861392706633, -0.026296641677618027, 0.011360907927155495, -0.00229012337513268, -0.0030890428461134434, 0.019417809322476387, -0.011272890493273735]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"rcd(s1:T)Case: As we have argued above, the CD-Q and CD-FUDGE may be
viewed as learning twist values ψθ
tfor a terminal potential ϕ(s1:T) =rcd(s1:T). However, our twist-induced proposal which
minimizes the variance of the one-step importance weights with these SMC targets {πθ
t}would yield
qπ
t(st|s1:t−1)∝p0(st|s1:t−1)ψθ
t(s1:t), (Twist-Ind. proposal ( ϕ=rcd))
which, compared to Eq. (CD proposal) does not exponentiate or scale ψθ
tand is directly proportional to the expected rcd.
30
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Comparison with Our ϕ(s1:T) =eβrcd(s1:T)Case (Soft RL): The stochastic sampling in Eq. (CD proposal) is also
reminiscent of the twist-induced proposal in the soft RL case of our framework where, in contrast to Eq. (CD reward), the
target is defined via ϕ(s1:T) =eβrcd(s1:T). As in App. B.3,
qπ
t(st|s1:t−1)∝p0(st|s1:t−1)eβ Vθ
t(s1:t)(Twist-Ind. proposal ( ϕ=eβrcd))
We proceed to write both qcd
tandqπ
tas the solution to a variational optimization, highlighting similarities in blue, but noting
thedifferent definitions of ϕin terms of rcd. We assume no intermediate potential or reward, and consider the optimal twists
to emphasize the role of rcd. Using Mudgal et al. (2023) Eq. 2 and Thm 2.1 (for CD) and Eq. (Optimal Intermediate Soft
Value) (for soft RL), we have
qcd∗
t(st|s1:t−1) = arg max
q(st|s1:t−1)Eq(st|s1:t−1)h
Ep0(st+1:T|s1:t)
rcd(s1:T)
| {z }
ψcd∗
t(s1:t)(forϕ=rcd)i
−1
βDKL(q(st|s1:t−1)∥p0(st|s1:t−1))
(CD proposal optimization)
qπ∗
t(st|s1:t−1) = arg max
q(st|s1:t−1)Eq(st|s1:t−1)h1
βlogEp0(st+1:T|s1:t)
eβrcd(s1:T)
| {z }
V∗
t(s1:t)(forϕ=eβrcd)i
−1
βDKL(q(st|s1:t−1)∥p0(st|s1:t−1))
(Soft RL proposal optimization)
The second terms of Eq. (CD proposal optimization) and Eq. (Soft RL proposal optimization) match and correspond to
one-step KL divergence regularization of the policy qt(st|s1:t−1). However, the expectation terms differ as we now discuss.
Soft Values Account for Future Regularization Using Eq. (Optimal Intermediate Soft Value) to expand the definition of
the soft value function, we see that Eq. (Soft RL proposal optimization) also implicitly contains an expected terminal reward,
V∗
t(s1:t) =1
βlogEp0(st+1:T|s1:t)eβrcd(s1:T)= max
q(st+1:T|s1:t)Eq(st+1:T|s1:t)
rcd(s1:T)
−1
βDKL(q(st+1:T|s1:t)∥p0(st+1:T|s1:t))
(58)
Asβ→0in Eq. (58), this optimization strictly enforces q(st+1:T|s1:t) =p0(st+1:T|s1:t), and the soft value function
recovers the expected reward under the base model Ep0(st+1:T|s1:t)[rcd(s1:T)], which appears in first term Eq. (CD proposal
optimization). On the other hand, the second term in Eq. (CD proposal optimization) uses β >0for optimization of the
proposal q(st|s1:t−1)at the current step. This inconsistency in Eq. (CD proposal optimization) (using β= 0in the first term","[0.03890402615070343, -0.0278000570833683, 0.00664231413975358, 0.0033997544087469578, 0.02313103899359703, 0.014943534508347511, 0.017779728397727013, 0.033204879611730576, -0.013418410904705524, 0.033579472452402115, 0.06662381440401077, -0.004762666299939156, -0.05153311789035797, 0.04200778529047966, 0.06282438337802887, -0.01658906228840351, 0.005612186621874571, -0.005357999354600906, -0.0315459743142128, 0.015585691668093204, -0.026542499661445618, -0.03949267044663429, 0.009037025272846222, 0.03836889564990997, -0.013411721214652061, -0.03325839340686798, 0.039412401616573334, 0.009291213005781174, 0.04029536619782448, -0.02817464992403984, 0.041686706244945526, -0.03467649221420288, -0.031786784529685974, -0.08342693001031876, -0.018247967585921288, 0.06828272342681885, -0.013144155964255333, 0.03967996686697006, -0.019599175080657005, 0.010936740785837173, -0.009451751597225666, -0.06073737144470215, -0.014863264746963978, 0.05715199559926987, 0.018997151404619217, 0.010508636012673378, -0.02306414768099785, -0.007264403626322746, 0.004260980989784002, 0.04302453622221947, -0.041017793118953705, 0.05511849746108055, 0.005655666347593069, -0.012615714222192764, 0.00679281959310174, 0.01879647746682167, 0.015599070116877556, -0.007552037015557289, 0.02250226028263569, -0.025164537131786346, 0.06442977488040924, -0.013712733052670956, -0.0005305322702042758, 0.0028679678216576576, -0.004391419235616922, -0.017819862812757492, -0.08647717535495758, 0.044603172689676285, -0.006983459927141666, 0.04013482853770256, -0.016267983242869377, 0.00011977737449342385, 0.01390002854168415, 0.016936898231506348, 0.018475398421287537, 0.011338088661432266, 0.0282549187541008, 0.036897286772727966, 0.03229515999555588, -0.017873376607894897, 0.028602754697203636, -0.026368582621216774, 0.02619466371834278, -0.015344882383942604, -0.009144051931798458, -0.07647022604942322, -0.02788032777607441, -0.05709848180413246, -0.01798040233552456, -0.044041283428668976, -0.008227639831602573, 0.00515732541680336, -0.012033759616315365, 0.012067205272614956, 0.043399129062891006, 0.01268929522484541, 0.008033654652535915, -0.0023545764852315187, 0.022676177322864532, -0.017137572169303894, 0.021846724674105644, -0.03852943331003189, 0.01785999909043312, -0.0008240182069130242, 0.053084999322891235, 0.004020171705633402, 0.0033027618192136288, 0.03382028266787529, -0.07192160934209824, -0.02761276252567768, -0.01167923491448164, -0.029646258801221848, -0.03596080467104912, 0.04240913316607475, 0.00489644892513752, -0.04184724763035774, -0.05145284906029701, -0.014635833911597729, -0.06341303139925003, -0.016094066202640533, -0.032723262906074524, -0.023933736607432365, 0.012321392074227333, -0.019157690927386284, 0.007123931776732206, -0.011251130141317844, -0.0167094673961401, -0.07652373611927032, -0.020937001332640648, 0.016870006918907166, 0.0027943872846663, 0.04701125994324684, -0.006883122958242893, -0.015706095844507217, -0.03240218386054039, 0.007257714867591858, 0.012334770523011684, 0.02373306080698967, -0.01689676195383072, -0.0075787934474647045, -0.0032960728276520967, -0.04505803436040878, -0.04024185240268707, 0.019425256177783012, -0.029137885197997093, 0.04179373383522034, -0.0066690705716609955, 0.008575474843382835, -0.007766089402139187, 0.02250226028263569, -0.024268193170428276, 0.0006998510798439384, -0.027331817895174026, -0.013157534413039684, 0.009953437373042107, -0.03237542882561684, 0.00347166252322495, 0.054128505289554596, 0.028228161856532097, -0.0002571137447375804, -0.008321288041770458, 0.026890335604548454, -0.04179373383522034, 0.0034683181438595057, 0.03232191503047943, 0.0024281570222228765, -0.04679720848798752, 0.05736604705452919, -0.06170060858130455, -0.00899020116776228, 0.0013955214526504278, -0.01921120472252369, -0.024161165580153465, -0.045272085815668106, -0.0013328107306733727, -0.0352918915450573, -0.01464921236038208, -0.09022309631109238, -0.0015995401190593839, 0.0012349820462986827, 0.010990253649652004, -0.0005330406711436808, 0.0018445297610014677, -0.021324971690773964, 0.016936898231506348, 0.02133835107088089, 0.002471636515110731, -0.033392176032066345, 0.0040904078632593155, -0.03162624314427376, 0.0004945781547576189, 0.05436931177973747, 0.06266384571790695, -0.02519129402935505, -0.0494728647172451, 0.007946696132421494, 0.03842240944504738, 0.06459031999111176, 0.015385017730295658, 0.00041577173396945, 0.03261623531579971, 0.023304956033825874, -0.007538658566772938, -0.028736537322402, -0.020321602001786232, 0.001936505432240665, -0.03446244075894356, 0.02194037288427353, -0.060041703283786774, 0.0008465940481983125, 0.022475503385066986, -0.00034637193311937153, 0.005555328913033009, 0.04024185240268707, -0.022435368970036507, 0.04679720848798752, -0.02702411822974682, 0.002311097225174308, 0.006174074485898018, 0.047439366579055786, 0.0025937133468687534, 0.01879647746682167, 0.042623188346624374, -0.012374904938042164, -0.0612189918756485, 0.0029281701426953077, 0.015344882383942604, -0.027826813980937004, 0.028308432549238205, -0.016682710498571396, 0.06111196428537369, 0.007431632373481989, -0.03769998252391815, -0.03411460295319557, -0.0010936741018667817, 0.004769355524331331, -0.03636215254664421, 0.006103838328272104, -0.015197721309959888, -0.05897144228219986, -0.0005113009829074144, -0.003222492290660739, 0.018957016989588737, -0.04024185240268707, -0.015853257849812508, 0.025967232882976532, -0.02085673250257969, -0.01252206601202488, -0.006123906001448631, 0.005876407492905855, 0.00023453790345229208, 0.002883018460124731, 0.011672546155750751, 0.007511902134865522, -0.06437626481056213, 0.011572209186851978, 0.028843563050031662, 0.011498628184199333, -0.016655953601002693, -0.003826186992228031, 0.013592327944934368, -0.03042219951748848, 0.0006538632442243397, 0.027077630162239075, -0.01588001288473606, -0.007157377433031797, -0.012053826823830605, -0.029271667823195457, 0.036602962762117386, 0.005113846156746149, 0.015799744054675102, 0.004638917278498411, -0.04636910557746887, 0.05758009850978851, 0.0030318517237901688, -0.028709780424833298, 0.0007412401027977467, 0.024656163528561592, -0.009458441287279129, 0.02948572114109993, -0.016722844913601875, -0.02010754868388176, 0.041124820709228516, 0.029994094744324684, 0.014782994985580444, -0.01935836486518383, -0.023906979709863663, 0.047706931829452515, -0.016883384436368942, -0.06442977488040924, -0.005261007230728865, -0.03737890347838402, 0.028495727106928825, -0.0433456152677536, -0.00734467338770628, 0.00979289785027504, 0.027291683480143547, -0.020080791786313057, -0.007739332504570484, 0.028977345675230026, 0.036790259182453156, 0.01785999909043312, -0.015987040475010872, 0.049499619752168655, -0.02317117340862751, -0.01898377388715744, 0.04163319617509842, -0.0009331347537226975, -0.03165300190448761, 0.0005539442645385861, -0.01300368458032608, -0.008802905678749084, 0.002214104635640979, -0.01163910049945116, -0.0240273829549551, -0.03571999818086624, 0.028335189446806908, -0.008174126967787743, 0.01654892787337303, -0.026395337656140327, -0.029699772596359253, -0.010100598447024822, -0.008756081573665142, -0.003869666252285242, 0.049018003046512604, -0.01600041799247265, -0.005531917326152325, -0.0018462020670995116, -0.02392035722732544, -0.03374001383781433, -0.009424995630979538, -0.005729246884584427, 0.0237731970846653, 0.012107339687645435, -0.03408784791827202, -0.037994302809238434, -0.05415526032447815, 0.04936583712697029, 0.006020224187523127, 0.005046954844146967, -0.039144836366176605, 0.02590034157037735, -0.012421729043126106, -0.02702411822974682, 0.007297849748283625, 0.0240273829549551, 0.025311697274446487, -0.0058128610253334045, 0.08455070108175278, 0.03588053584098816, -0.02798735350370407, -0.04757314920425415, 0.047894228249788284, -0.00637140404433012, 0.02571304701268673, -0.010916673578321934, -0.021070783957839012, -0.028147893026471138, -0.05832928419113159, 0.00304523017257452, 0.023947114124894142, 0.0013696009991690516, 0.018783099949359894, -0.020937001332640648, -0.007217579986900091, 0.022475503385066986, 0.013672597706317902, 0.001152204000391066, -0.006404849700629711, -0.009404928423464298, -0.008555407635867596, 0.0065285987220704556, -0.058650363236665726, 0.02279658243060112, -0.04872368276119232, -0.01356557197868824, 0.02903085947036743, 0.01268929522484541, 0.04256967455148697, 0.016696088016033173, 0.012435107491910458, 0.001153040211647749, -0.02321130968630314, -0.00462553882971406, 0.021351728588342667, -0.005769381299614906, -0.0030368687584996223, -0.02373306080698967, -0.01583987846970558, -0.0018779755337163806, -0.0018194455187767744, -0.012187609449028969, -0.03681701421737671, 0.011030388996005058, 0.006010190583765507, 0.011445115320384502, -0.019224582239985466, 0.05848982185125351, 0.05790117755532265, 0.06865730881690979, -0.048857465386390686, -0.008174126967787743, -0.05511849746108055, -0.023719683289527893, -0.04957989230751991, 0.01328462827950716, 0.012662538327276707, 0.028575997799634933, -0.013371586799621582, 0.02204739861190319, 0.05075718089938164, -0.022060777992010117, 0.03521162271499634, -0.026101015508174896, 0.00842831376940012, -0.07095837593078613, 0.028683023527264595, -0.007304538507014513, 0.06491139531135559, 0.06384113430976868, 0.008976822718977928, -0.012174231000244617, -0.006889812182635069, 0.00011695539433276281, -0.005257662385702133, 0.023050770163536072, 0.04219508171081543, 0.025472236797213554, 0.026475608348846436, -0.03842240944504738, 0.013037130236625671, 0.06421572715044022, 0.036495935171842575, -0.01979984901845455, -0.018341615796089172, 0.021458754315972328, 0.03708457946777344, -0.009090538136661053, -0.04104455187916756, -0.03464973345398903, 0.011813017539680004, -0.012053826823830605, -0.023144418373703957, 0.013057197444140911, -0.021619293838739395, 0.0414726547896862, 0.0013102348893880844, -0.04652964323759079, -0.0009724334231577814, -0.006655692122876644, -0.017619188874959946, 0.026823442429304123, 0.05736604705452919, -0.017124192789196968, -0.058917928487062454, -0.012334770523011684, 0.10857808589935303, 0.01925133913755417, 0.00436466233804822, -0.007638995535671711, 0.006598834414035082, -0.00692325783893466, 0.012120718136429787, -0.004351284354925156, 0.011425048112869263, 0.031706515699625015, 0.050355829298496246, 0.02252901718020439, -0.024803323671221733, 0.011465182527899742, -0.013712733052670956, -0.02006741426885128, 0.01656230539083481, -0.013859894126653671, 0.004317838698625565, 0.015063938684761524, 0.06715894490480423, -0.02425481379032135, 0.03756619989871979, 0.0028997412882745266, 0.03015463426709175, 0.008863108232617378, 0.0073714302852749825, -0.008789527229964733, 0.043265342712402344, 0.05613524466753006, 0.023478874936699867, -0.03919835016131401, 0.001288495259359479, 0.02088348940014839, -0.01468934677541256, -0.04955313354730606, 0.008662433363497257, -0.015612447634339333, 0.010180868208408356, -0.005003475118428469, 0.01723122037947178, 0.02631506882607937, -0.031519219279289246, -0.013739489018917084, 0.023411983624100685, 0.03167975693941116, 0.023666169494390488, 0.025953855365514755, 0.04099103808403015, 0.0753999650478363, 0.0007282798760570586, -0.010501946322619915, -0.004809490405023098, 0.02582007274031639, -0.022261451929807663, 0.026060881093144417, -0.030395442619919777, 0.006665726192295551, -0.01464921236038208, 0.00623093219473958, -0.04302453622221947, -0.03478351607918739, 0.002473308704793453, 0.009110606275498867, -0.009170807898044586, -0.03761971369385719, -0.01600041799247265, 0.0006563716451637447, 0.008100545965135098, -0.010495257563889027, -0.012267879210412502, -0.11408993601799011, -0.03526513651013374, -0.04529884085059166, 0.017926890403032303, -0.025164537131786346, 0.02444211021065712, 0.03400757908821106, -0.0195456612855196, -0.008528650738298893, -0.025512373074889183, -0.00069608842022717, 0.008863108232617378, -0.013117399998009205, 0.00216728076338768, -0.014542185701429844, -0.005234250333160162, 0.025057511404156685, 0.008087167516350746, 0.020308222621679306, -0.0023662825115025043, -0.0075587257742881775, -0.0013035457814112306, 0.012930103577673435, -0.0013503697700798512, -0.006013534963130951, -0.03919835016131401, -0.009585535153746605, -0.01470272522419691, -0.011318021453917027, -0.0014507068553939462, 0.011879908852279186, 0.009010269306600094, 0.019853360950946808, 0.0013512058649212122, -0.023572523146867752, -0.02040187083184719, -0.003956625238060951, -0.03360622748732567, 0.005374722182750702, 0.025405345484614372, 0.0169636532664299, -0.005378067027777433, 0.02996733784675598, -0.047626662999391556, 0.016160957515239716, 0.017070680856704712, -0.03023490309715271, -0.017311489209532738, -0.020990515127778053, -0.003762640058994293, -0.01898377388715744, -0.010796268470585346, -0.025284942239522934, -0.022368477657437325, -0.028281675651669502, 0.009518642909824848, -0.03186705335974693, -0.04842935875058174, 0.035746753215789795, 0.00844838097691536, -0.012301324866712093, -0.0003846254257950932, 0.03317812457680702, 0.005110501311719418, -0.004097097087651491, -0.01981322653591633, 0.004448276944458485, -0.05107825621962547, 0.00204185931943357, -0.019452013075351715, 0.021739698946475983, -0.03176002576947212, 0.013351519592106342, -0.003393065184354782, -0.02111092023551464, 0.015906769782304764, -0.025057511404156685, -0.046957749873399734, 0.06662381440401077, -0.03162624314427376, 0.0395996980369091, 0.026729796081781387, 0.02081659808754921, 0.04636910557746887, 0.014903399161994457, 0.0030050952918827534, 0.0008754409500397742, -0.0070704189129173756, -0.030582739040255547, 0.027826813980937004, -0.00927114486694336, 0.0277733001857996, -0.021766455844044685, -0.03633539751172066, -0.011652478016912937, 0.02533845417201519, -0.05123879760503769, 0.003058608388528228, 0.009726006537675858, -0.0183549951761961, -0.013425099663436413, 0.04133887216448784, -0.0026338479947298765, -0.03258948028087616, 0.022970499470829964, -0.01470272522419691, -0.0008227639482356608, -0.02523142844438553, -0.014515429735183716, -0.003896422917023301, -0.0009080504532903433, 0.015358260832726955, -0.03590729087591171, 0.01464921236038208, 0.015344882383942604, -0.01752554066479206, -0.03703106939792633, 0.03459622338414192, -0.008214261382818222, 0.0006613885052502155, 0.02552575059235096, -0.0016998772043734789, -0.02358590066432953, -0.0367099903523922, -0.009933370165526867, 0.027907082810997963, -0.01621447131037712, 0.03654944896697998, -0.01764594577252865, -0.005083744879812002, -0.010916673578321934, -0.004976718686521053, -0.02148551121354103, -0.024789946153759956, -0.025057511404156685, 0.0036756813060492277, -0.01573285274207592, 0.022475503385066986, 0.04048266261816025, 0.01549204345792532, 0.07240322977304459, -0.033659741282463074, -0.014328133314847946, -0.031974080950021744, 0.04944610968232155, 0.01268929522484541, -0.0017759661423042417, -0.015585691668093204, -0.025311697274446487, 0.011739437468349934, -0.04719855636358261, -0.010401609353721142, 0.009291213005781174, 0.004889759700745344, -0.011251130141317844, -0.015344882383942604, -0.03042219951748848, -0.011926732957363129, 0.010435055010020733, 0.032348670065402985, -0.016910141333937645, -0.006585456430912018, 0.00864905584603548, -0.023411983624100685, 0.01470272522419691, 0.011592276394367218, -0.03711133822798729, -0.022435368970036507, -0.0005447466974146664, 0.019291473552584648, 0.022769825533032417, 0.0015385017031803727, -0.05881090089678764, -0.026729796081781387, 0.03275001794099808, -0.012829766608774662, -0.010548770427703857, -0.033204879611730576, -0.034515950828790665, -0.013926785439252853, 0.02156578004360199, 0.02903085947036743, -0.005264351610094309, 0.027826813980937004, -0.0014891693135723472, -0.019264716655015945, 0.010990253649652004, -0.020241331309080124, 0.03344568982720375, 0.02260928601026535, 0.03986726328730583, 0.021405242383480072, 0.011124036274850368, -0.01227456796914339, -0.016870006918907166, -0.07556050270795822, -0.028094379231333733, 0.005929920822381973, -0.014916777610778809, -0.05078393593430519, 0.005836273077875376, -0.017177706584334373, 0.025204671546816826, -0.0020803220104426146, -0.01521109975874424, -0.008234328590333462, -0.015411773696541786, -0.01733824610710144, 0.032562725245952606, 0.009692560881376266, 0.018488777801394463, -0.028014110401272774, 0.006916568614542484, 0.02656925655901432, -0.0067025162279605865, -0.023813331499695778, 0.03167975693941116, 0.012669227086007595, 0.04195427522063255, 0.04115157574415207, 0.030582739040255547, -0.016883384436368942, 0.004087063483893871, 0.02671641670167446, 0.01147187128663063, -0.01379300281405449, -0.01468934677541256, 0.008769460022449493, -0.0031840295996516943, 0.020161062479019165, -0.024616027250885963, -0.02656925655901432, -0.01360570639371872, -0.003252593334764242, -0.00027258237241767347, -0.014823129400610924, 0.013505369424819946, -0.012642471119761467, 0.006013534963130951, -0.016508793458342552, -0.013940163888037205, 0.020375113934278488, 0.003990070894360542, -0.009237699210643768, 0.01379300281405449, -0.012542134150862694, 0.0244822446256876, 0.05683091655373573, -0.005384756252169609, -0.003658958477899432, -0.017217840999364853, -0.027264926582574844, 0.00951195415109396, -0.0020836663898080587, -0.015385017730295658, 0.001593687105923891, -0.033311907202005386, -0.028602754697203636, -0.01854228973388672, 0.0032475765328854322, -0.015799744054675102, 0.016736222431063652, -0.027719788253307343, -0.00842831376940012, -0.007618928328156471, -0.049767185002565384, 0.02058916725218296, 0.002446552272886038, 0.004508479032665491, -0.013291317038238049, -0.11954827606678009, -0.01169930212199688, 0.016936898231506348, 0.016415145248174667, 0.03761971369385719, 0.006023568566888571, 0.025913720950484276, 0.0037893967237323523, 0.026729796081781387, -0.03202759101986885, -0.009799587540328503, 0.007317916955798864, 0.018475398421287537, 0.017538920044898987, 0.012629092670977116, -0.06640975922346115, -0.010241069830954075, -0.009665803983807564, 0.01588001288473606, -0.011318021453917027, -0.015304747968912125, 0.014007055200636387, 0.00331614026799798, 0.05859684944152832, -0.05078393593430519, -0.003322829259559512, 0.015612447634339333, -0.008267774246633053, 0.011371534317731857, -0.022555774077773094, 0.0036823705304414034, -0.011204306036233902, 0.0024699640925973654, 0.03050246834754944, -0.022074155509471893, -0.0008704240899533033, -0.00475597707554698, -0.019264716655015945, 0.015612447634339333, 0.03213461861014366, 0.051773928105831146, -0.05479741841554642, 0.07111891359090805, 0.023144418373703957, 0.0035485876724123955, -0.019572418183088303, 0.016789736226201057, -0.03673674538731575, 0.025873586535453796, -0.011090590618550777, 0.02088348940014839, 0.008796216920018196, -0.034141361713409424, -0.024281570687890053, -0.012455174699425697, 0.024495624005794525, -0.0061272503808140755, 0.02044200524687767, 0.01913093402981758, 0.011103969067335129, 0.001661414629779756, 0.027385331690311432, 0.016160957515239716, -0.009505265392363071, -0.026355203241109848, -0.032642994076013565, -0.012568890117108822, 0.014515429735183716, 0.01111734751611948, -0.009411617182195187, 0.015237856656312943, 0.009699249640107155, 0.006729272659868002, 0.015612447634339333, -0.03117138333618641, -0.0020920278038829565, -0.026141151785850525, -0.014555564150214195, -0.027144521474838257, 0.010936740785837173, 0.04907151684165001, -0.029325181618332863, 0.007364741060882807, 0.004461654927581549, -0.021204566583037376, 0.03700431063771248, -0.02470967546105385, 0.01380638126283884, -0.02900410257279873, 0.013779624365270138, 0.02343873865902424, -0.011057144962251186, 0.007853047922253609, -0.021806590259075165, -0.006552010774612427, -0.012622402980923653, -0.0447101965546608, 0.0022826683707535267, 0.04738585278391838, -0.0016948602860793471, 0.03652269393205643, 0.04286399483680725, -0.01498366892337799, -0.0009414961677975953, -0.02358590066432953, 0.007565414998680353, -0.009204253554344177, 0.035746753215789795, 0.038288626819849014, -0.02967301569879055, 0.006689137779176235, 0.005431579891592264, -0.04155292361974716, -0.013190980069339275, -0.005939954426139593, 0.031599488109350204, 0.04717180132865906, 0.017913511022925377, 0.006806198041886091, -0.0050001307390630245, 0.0179001335054636, 0.019264716655015945, -0.0011781244538724422, 0.016134200617671013, -0.022716311737895012, -0.03304434195160866, -0.00530783087015152, -0.0024197956081479788, -0.0026288311928510666, 0.004796111956238747, -0.005408167839050293, -0.009331347420811653, 0.025204671546816826, 0.012863212265074253, 0.0179001335054636, 0.05059663951396942, 0.0325092114508152, 0.007826291024684906, -0.04655640199780464, 0.014662590809166431, 0.005257662385702133, 0.013177601620554924, 0.028388701379299164, 0.026060881093144417, 0.019304852932691574, 0.01644190028309822, -0.01648203656077385, -0.003668992081657052, -0.002105406252667308, 0.014943534508347511, 0.04492425173521042, -0.01727135479450226, 0.01192004419863224, 0.017538920044898987, -0.014435159973800182, 0.02769303135573864, -0.0223818551748991, -0.02492372877895832, -0.014796373434364796, 0.008194194175302982, 0.00012364453868940473, 0.058436308056116104, 0.005404823459684849, -0.02062930166721344, 0.019224582239985466, -0.0043947636149823666, -0.017472028732299805, -0.0035352094564586878, 0.00585968466475606, 0.027532491832971573, -0.007097175344824791, -0.036870528012514114, 0.003956625238060951, 0.019385121762752533, 0.014421781525015831, 0.03919835016131401, -0.01785999909043312, 0.014448538422584534, 0.030261659994721413, 0.018140941858291626, 0.0017859998624771833, 0.02854924090206623, -0.024348462000489235, -0.00502688717097044, 0.05153311789035797, -0.017579054459929466, 0.018261346966028214, -0.016642576083540916, 0.04626207798719406, 0.022515637800097466, 0.012374904938042164, 0.02519129402935505, 0.012629092670977116, 0.02414778806269169, 0.02577993832528591, 0.007110553793609142, -0.040001045912504196, 0.026475608348846436, 0.00034888036316260695, -0.05875738710165024, -0.045084789395332336, 0.01898377388715744, 0.015585691668093204, -0.01470272522419691, -0.007973452098667622, 0.00017391759320162237, -0.011685923673212528, -0.0005016853683628142, 0.014782994985580444, -0.01654892787337303, 0.02537859044969082, -0.007973452098667622, -0.02817464992403984, 0.011973557062447071, 0.0021003892179578543, -0.018890125676989555, 0.03325839340686798, -0.007612239103764296, -0.04342588409781456, 0.0050636776722967625, -0.02671641670167446, -0.03194732218980789, 0.008515272289514542, 0.003083692630752921, -0.024388596415519714, -0.02911112830042839, 0.012548822909593582, 0.028014110401272774, -0.004103786312043667, 0.0006333777564577758, -0.008595542050898075, 0.03237542882561684, -0.009043714962899685, -0.01196017861366272, -0.008963445201516151, -0.023478874936699867, -0.006675759796053171, -0.025084268301725388, 0.018930260092020035, 0.018221212550997734, 0.0310911126434803, 0.014836507849395275, -0.007638995535671711, -0.0031004154589027166, 0.009311280213296413, 0.011786261573433876, 0.024910349398851395, 0.03202759101986885, -0.04190076142549515, -0.021472133696079254, -0.050543125718832016, 0.03125165402889252, 0.034515950828790665, -0.020870110020041466, 0.00018154738063458353, 0.014140837825834751, 0.018060673028230667, 0.028121136128902435, 0.05014177784323692, 0.014475294388830662, -0.0014858248177915812, -0.0064516738057136536, -0.02769303135573864, -0.01600041799247265, -0.0067025162279605865, -0.017967024818062782, 0.02750573493540287, 0.005053643602877855, -0.004277703817933798, -0.00024143607879523188, -0.010695931501686573, -0.00814737007021904, 0.005622220691293478, 0.0358002670109272, 0.03938564285635948, 0.023077525198459625, 0.014395024627447128, -0.021030649542808533, 0.0013537142658606172, -0.0036924041341990232, -0.023197930306196213, -0.037057824432849884, -0.03224164620041847, -0.004990097135305405, 0.03355271741747856, -0.015853257849812508, 0.03138543665409088, -0.012301324866712093, 0.02548561617732048, 0.011485249735414982, 0.026917090639472008, 0.04735909774899483, -0.03146570548415184, -0.0018144287168979645, -0.0067025162279605865, -0.02686357870697975, 0.016361631453037262, 0.0020184474997222424, -0.003869666252285242, -0.0070503512397408485, -0.0026606046594679356, 0.032161373645067215, -0.013037130236625671, 0.006983459927141666, 0.019090799614787102, -0.01610744372010231, 0.024803323671221733, 0.024883592501282692, -0.015906769782304764, -0.011879908852279186, -0.006565388757735491, -0.023492252454161644, -0.00652190949767828, 0.031224895268678665, 0.03467649221420288, -0.011739437468349934, -0.019639309495687485, 0.010629040189087391, 0.004421520046889782, 0.002234172075986862, -0.0007985158590599895, -0.02181996777653694, 0.01227456796914339, 0.017967024818062782, -0.020789841189980507, -0.00461550522595644, -0.009659115225076675, -0.0006810378399677575, 0.026729796081781387, 0.017498785629868507, -0.0223818551748991, 0.024121031165122986, 0.022328343242406845, -0.03269650787115097, 0.0003507616638671607, 0.021284837275743484, -0.03269650787115097, 0.007398186717182398, -0.03475676104426384, -0.02769303135573864, 0.017686080187559128, -0.00298502785153687, 0.0035117974039167166, -0.01996038854122162, 0.01085647102445364, 0.00346162891946733, 0.016642576083540916, 0.020843353122472763, -0.01727135479450226, -0.01526461262255907, 0.07277782261371613, 0.002617125166580081, -0.008976822718977928, -0.005194115452468395, -0.0011814689496532083, 0.005896475166082382, -0.01297023892402649, -0.020749706774950027, -0.037726737558841705, -0.005939954426139593, -0.040348879992961884, 0.03745917230844498, -0.02458927035331726, 0.0240273829549551, 0.0029147919267416, -0.002065271371975541, -0.008013587445020676, 0.02327820099890232, 0.005993467755615711, 0.018301481381058693, -0.0007596352370455861, -0.00925107765942812, -0.03390055149793625, -0.004197434056550264, 5.821640297654085e-05, -0.0026187975890934467, 0.0010426694061607122, 0.009043714962899685, -0.0044750333763659, 0.004863003268837929, -0.0008520289557054639, -0.011926732957363129, -0.031599488109350204, 0.00012124062777729705, 0.01902390830218792, -0.006665726192295551, -0.030770035460591316, 0.004665673710405827, -0.01785999909043312, 0.0019465391524136066, -0.005481748376041651, -0.0008390687289647758, -0.013665908947587013, -0.000847848248668015, 0.013940163888037205, -0.005067022051662207, -0.01808742992579937, -0.0005455827922560275, 0.023224687203764915, 0.015465287491679192, 0.013966919854283333, -0.005575396586209536, 0.03606783226132393, -0.023411983624100685, -0.0010259465780109167, -0.0064750853925943375, 0.00013953124289400876, 0.017846619710326195, 0.028228161856532097, 0.022809959948062897, -0.04256967455148697, 0.020602544769644737, -0.03448919579386711, 0.017164327204227448, 0.02892383188009262, -0.013104021549224854, -0.019478769972920418, 0.01326456107199192, -0.018288103863596916, 0.038101330399513245, -0.018074050545692444, 0.02231496386229992, 0.016455279663205147, -0.003143894951790571, -1.6657521655361052e-06, 0.0015150897670537233, -0.029699772596359253, 0.015987040475010872, -0.04165995121002197, 0.016696088016033173, -0.011124036274850368, 0.01356557197868824, 0.005107156932353973, -0.004468344151973724, 0.013425099663436413, 0.046021267771720886, 0.016682710498571396, 0.0035753443371504545, -0.026997361332178116, 0.01222105510532856, -0.009572156704962254, -0.004404797218739986, 0.03390055149793625, -0.008468449115753174, -0.006351336371153593, -0.045352354645729065, 0.016535548493266106, -0.02309090457856655, 0.021472133696079254, 0.01274280808866024, 0.0017759661423042417, -0.01704392395913601, 0.05471714958548546, -0.0004105458501726389, -0.02515115961432457, 0.024040762335062027, -0.026167908683419228, -0.03636215254664421, 0.0237731970846653, 0.041017793118953705, 0.00374257261864841, -0.018408507108688354, 0.010254448279738426, 0.02903085947036743, 0.006137283984571695, 0.006628935690969229, -0.03299082815647125, 0.02088348940014839, -0.011973557062447071, -0.031519219279289246, 0.008956755511462688, -0.0007692508515901864, -0.0011672545224428177, 0.02519129402935505, 0.003765984671190381, -0.00290977512486279, -0.030101120471954346, 0.016977032646536827, 0.004010138101875782, -0.0021773143671453, -0.017137572169303894, -0.0014866609126329422, 0.00690319063141942, 0.00204185931943357, 0.000981630990281701, -0.009899924509227276, -0.000988320098258555, -0.015906769782304764, 0.003976692445576191, 0.008488516323268414, 0.00331614026799798, 0.006950014270842075, 0.002749235602095723, 0.003163962159305811, 0.013070575892925262, -0.009578845463693142, -0.01356557197868824, -0.030823547393083572, 0.025365211069583893, 0.03050246834754944, -0.032268401235342026, -0.0005915706278756261, 0.00313051650300622, 0.03901105374097824, 0.038770243525505066, -0.018033916130661964, 0.02421467937529087, -0.04957989230751991, 0.030850304290652275, 0.010328029282391071, 0.02470967546105385, -0.015946904197335243, 0.020040657371282578, 0.012609025463461876, 0.00473590986803174, -0.003829531604424119, 0.009037025272846222, -0.0014824802055954933, 0.0008921637781895697, -0.013953541405498981, -0.004692430142313242, 0.012495310045778751, 0.013498680666089058, -0.0223550982773304, -0.009244388900697231, -0.01760581135749817, -0.0009130673133768141, -0.01771283708512783, -0.029137885197997093, -0.00047994565102271736, -0.009458441287279129, -0.023104282096028328, 0.020843353122472763, 0.020455384626984596, -0.0004937420017085969, 0.012722740881145, 0.004448276944458485, 0.01898377388715744, 0.0053345877677202225, 0.012983616441488266, 0.00835473369807005, 0.003117138287052512, 0.01846202090382576, 0.010662485845386982, 0.022408612072467804, 0.017351623624563217, 0.007672441191971302, -0.0025301664136350155, -0.022595908492803574, 0.046663425862789154, -0.00018802749400492758, -0.010328029282391071, 0.010080531239509583, 0.006020224187523127, -0.004832901991903782, -0.03609458729624748, 0.005468370392918587, -0.006976770702749491, -0.006207520142197609, 0.014890020713210106, 0.01779310777783394, 0.020562410354614258, 0.0029281701426953077, 0.057312533259391785, 0.0223818551748991, 0.028094379231333733, 0.0037760185077786446, -0.01351205911487341, 0.016120823100209236, -0.014261242002248764, -0.006468396633863449, 0.003973348066210747, 0.005324553698301315, 0.016843250021338463, -0.02081659808754921, 0.034248385578393936, 0.021431997418403625, -0.005040265619754791, 0.015224478207528591, 0.011786261573433876, 0.022636042907834053, -0.023144418373703957, -0.00868919026106596, -0.010963496752083302, 0.01038823090493679, 0.009458441287279129, 0.016615819185972214, -0.001184813561849296, -0.043559666723012924, 0.014395024627447128, -0.03949267044663429, -0.0004138904041610658, 0.017030544579029083, -0.0018411852652207017, -0.0183817520737648, 0.0922565907239914, -0.01973295770585537, 0.020829975605010986, -0.031974080950021744, 0.0007069582934491336, -0.006317890714854002, 0.022850096225738525, -0.011251130141317844, -0.009605602361261845, 0.027933839708566666, -0.038582947105169296, 0.022676177322864532, -0.04955313354730606, 0.024910349398851395, 0.004585403949022293, -0.01648203656077385, -0.006635624915361404, 0.015318126417696476, -0.0061807637102901936, 0.0054182019084692, 0.0016890073893591762, -0.011685923673212528, 0.0015694389585405588, -0.04176697880029678, -0.01850215531885624, -0.01677635870873928, 0.024121031165122986, 0.015318126417696476, 0.009197564795613289, 0.007110553793609142, 0.04182048887014389, 0.028870319947600365, 0.025284942239522934, -0.005936610046774149, -0.014381647109985352, 0.045352354645729065, -0.00609046034514904, -0.0019214549101889133, -0.012622402980923653, -0.005371377803385258, -0.0138866500928998, -0.03098408691585064, 0.006675759796053171, 0.0018528911750763655, 0.014073946513235569, -0.045833975076675415, -0.0005347129772417247, -0.0021171122789382935, -0.036897286772727966, -0.03125165402889252, -0.0006509367376565933, 0.023599278181791306, -0.034622978419065475, 0.004257636144757271, 0.019666066393256187, -0.031144626438617706, 0.01854228973388672, -0.025619398802518845, 0.019947009161114693, 0.03360622748732567, 0.027666274458169937, -0.01879647746682167, 0.014782994985580444, 0.005963366478681564, -0.011003632098436356, 0.020682815462350845, 0.000918084173463285, 0.027666274458169937, 0.024468867108225822, -0.03759295493364334, 0.02062930166721344, -0.006725928280502558, 0.028308432549238205, -0.0029967338778078556, 0.0037793628871440887, -0.02523142844438553, -0.005073711276054382, 0.009819654747843742, 0.004230879712849855, 0.02048213966190815, -0.007531969342380762, -0.014836507849395275, -0.0008060411200858653, -0.025913720950484276, -0.02129821479320526, 0.01946539245545864, -0.015438530594110489, -0.009545399807393551, 0.0027007395401597023, 0.01199362426996231, 0.0012717723147943616, 0.009297901764512062, 0.023706305772066116, 0.02862950973212719, -0.014100702479481697, 0.01764594577252865, 0.015117451548576355, -0.030261659994721413, -0.0021589193493127823, -0.01715094968676567, 0.011672546155750751, 0.012809699401259422, 0.00949188694357872, -0.0030418855603784323, 0.0009080504532903433, -0.0025385278277099133, 0.020321602001786232, -0.015371639281511307, -0.03143894672393799, 0.016789736226201057, -0.01812756434082985, 0.012448485940694809, -0.018435264006257057, -0.020174439996480942, 7.263985935423989e-06, -0.038101330399513245, -0.007123931776732206, 0.0004212066705804318, -0.005555328913033009, 0.02040187083184719, -0.009538711048662663, 0.0029131195042282343, -0.021886859089136124, 0.020161062479019165, -0.02335846982896328, 0.005327898543328047, 0.05337931960821152, 0.00822095014154911, 0.002065271371975541, -0.01562582701444626, -0.04703801870346069, -0.023826709017157555, -0.017204463481903076, 0.0376732237637043, 0.016950275748968124, 0.03034193068742752, -0.04575370252132416, 0.024134410545229912, -0.036897286772727966, 0.01992025226354599, 0.007351362612098455, -0.01029458362609148, 0.038582947105169296, -0.014863264746963978]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"
andβ >0in the second term) arises from the fact that Eq. (CD proposal optimization) does not consider the effect of future
regularization, while the MDP formulation in Eq. (Soft RL proposal optimization) does so via the optimization in Eq. (58)
and the log-mean-exp form of the soft value function V∗
t.
On Mudgal et al. (2023)’s One-Step Proposal and SMC Interpretation As noted in Eq. (57), the twists learned by
Mudgal et al. (2023) correspond to policy evaluation for the reward rcdunder the base model p0. However, we have
argued that the one-step proposal in Eq. (CD proposal) (which considers one-step KL regularization of qcd
ttop0) does not
immediately fit within our SMC framework. In particular, it is not apparent that the composition of one-step proposals
qcd(s1:T) =Qt
τ=1qcd
τ(sτ|s1:τ−1)samples from the marginals σ(s1:t)of a natural target distribution σ(s1:T)at optimality.
Flexible Inference-Time βScaling The experiments in Mudgal et al. (2023) evaluate tradeoff curves between expected
reward and DKL 
qcd(s1:T)p0(s1:T)
for various values of regularization strength β. Since the twists learned by Mudgal
et al. (2023) in Eq. (57) do not depend on β, sampling according to Eq. (CD proposal) or Eq. (CD proposal optimization)
has the benefit of allowing flexible tempering or β-scaling at inference time without additional learning.
Such tradeoff curves are also natural from the perspective of soft-RL (c.f. Eq. (42) and Eq. (46)). While Eq. (58) appears
to require separate twist-learning procedures for each β, flexible inference-time βscaling could be achieved with a single
training run in our framework by learning a conditional twist network ψθ
t(s1:t, β)which considers βin its input and training
loss, or adapting the methods of (Bae et al., 2022) proposed in the context of rate-distortion optimization.
Comparison with Khanov et al. (2024) Khanov et al. (2024) consider softmax decoding similar to Eq. (Twist-Ind.
proposal ( ϕ=rcd)). However, instead of Vθ
t(s1:t)as the logit, they use a reward model rT(s1:T)which is trained from full
sequences ( ϕ(s1:T) =eβrT(s1:T)), but applied to partial sequences without modification, rT(s1:t). This clearly does not
correspond to a twist or soft value function V∗
t(s1:t) =1
βlogP
st+1:Tp0(st+1:T|s1:t)eβrT(s1:T)̸=rT(s1:t).
31
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
D.2. Blockwise Greedy Decoding in Mudgal et al. (2023)
As an alternative use of the twist functions at inference time and a generalization of best-of- Kdecoding to partial sequences,
Mudgal et al. (2023) also consider a ‘blockwise’ decoding scheme using the learned twist functions ψθ
t. In particular, for K
partial completions of length M(from a prefix s1:t), sampled from the base model, s(k)
t+1:t+M∼p0(st+1:t+M|s1:t), Mudgal
et al. (2023) propose to choose
sω
t+1:t+M= arg max
kψθ
t+M(sk
1:t+M) (59)
and proceed with sampling Kfurther continuations with prefix sω
1:t+Muntil the next resampling step or an end-of-string
token is reached. The arg max selection strategy may seem natural from the unregularized RL (as β→ ∞ ) or expected
future reward perspective in App. D.1, but does not yield samples from σ(s1:T)with the corresponding optimal twists.
Our SMC framework instead would advocate probabilistic resampling based on the approximate twist functions using the
(c- orM-step) importance weights in Sec. 3 in order to match the desired target distribution.
Finally, Khanov et al. (2024) also consider arg max decoding of next tokens using the unmodified rT(s1:t)described above.
E. Proposal Learning Methods","[0.025654438883066177, -0.015586485154926777, 0.0028972288127988577, 0.001775015378370881, -0.018924523144960403, 0.025546761229634285, 0.02733691781759262, 0.002483339048922062, -0.04051409289240837, 0.04549423232674599, 0.046113383024930954, -0.005908866412937641, -0.03243819624185562, 0.04958602041006088, 0.03943730890750885, -0.031711362302303314, 0.03305734694004059, 0.002279758919030428, -0.01709398627281189, 0.03200748190283775, -0.030849935486912727, -0.021279994398355484, -0.014926953241229057, 0.041510120034217834, 0.011454316787421703, -0.026192832738161087, 0.022747116163372993, 0.013473291881382465, 0.02722924016416073, 0.002197317546233535, 0.030796095728874207, -0.033541902899742126, -0.026610087603330612, -0.0768287181854248, -0.030553817749023438, 0.0601385273039341, -0.02214142307639122, 0.02062046341598034, -0.011817732825875282, -0.0015117073198780417, 0.004266766831278801, -0.07855157554149628, -0.028777120634913445, 0.035641636699438095, 0.0218049269169569, 0.04541347175836563, 0.00915941596031189, 0.013500211760401726, -0.009421882219612598, 0.04910146817564964, -0.03383801877498627, 0.039464227855205536, -0.022370239719748497, 0.00165640062186867, -0.002229284727945924, 0.010875544510781765, -0.0004757209389936179, -0.02939627319574356, 0.02399888075888157, -0.04452512413263321, 0.034214891493320465, -0.031334489583969116, 0.009435342624783516, 0.0027407582383602858, -0.017901577055454254, -0.027511896565556526, -0.06213058531284332, 0.06030004844069481, -0.011952330358326435, 0.04296378418803215, 0.0003909660445060581, -0.005595925264060497, 0.005134925711899996, 0.01694592833518982, -0.0005648923106491566, 0.012645511887967587, 0.01846688985824585, 0.04581726714968681, 0.03144216910004616, -0.022989392280578613, 0.02685236558318138, -0.04129476472735405, 0.019261019304394722, -0.023231670260429382, 0.002673459006473422, -0.035103242844343185, -0.0218991469591856, -0.009300744161009789, -0.031280647963285446, -0.031415246427059174, -0.015546105802059174, 0.01437510084360838, -0.03628770634531975, 0.00280469236895442, 0.047055572271347046, 0.023823902010917664, 0.019920552149415016, -0.004461934324353933, 0.016299856826663017, 0.0104852095246315, 0.004037949722260237, -0.022276021540164948, 0.029127076268196106, -0.02518334612250328, 0.07666720449924469, -0.011272609233856201, -0.003142870729789138, 0.04737860709428787, -0.06891433894634247, -0.027256159111857414, -0.030311541631817818, -0.028884800150990486, -0.037687528878450394, 0.020270507782697678, 0.02516988478600979, -0.06299201399087906, -0.029127076268196106, -0.0023823902010917664, -0.04826695844531059, -0.0021249710116535425, -0.041510120034217834, -0.023675844073295593, 0.017215125262737274, 0.013823247514665127, -0.011602374725043774, 0.00901808775961399, -0.0021165586076676846, -0.0714447870850563, 0.008398935198783875, 0.046221062541007996, -0.0004374445416033268, 0.031469088047742844, 0.004855634178966284, -0.013554050587117672, -0.023689303547143936, -0.011077441275119781, -0.01153507549315691, 0.028669441118836403, -0.012282096780836582, 0.013648269698023796, 0.005895406473428011, -0.04764780402183533, -0.027834933251142502, -0.007544235792011023, -0.029207834973931313, 0.005811282433569431, -0.038333602249622345, 0.02052624337375164, -0.0218049269169569, 0.012524373829364777, -0.06073076277971268, -0.02004168927669525, -0.032249756157398224, 0.025237184017896652, -0.02130691334605217, -0.054539237171411514, -0.034511007368564606, 0.03871047496795654, 0.019314859062433243, -0.024900689721107483, -0.0018608217360451818, 0.05168575420975685, 0.002728980965912342, 0.008856569416821003, 0.001973547739908099, -0.014455859549343586, -0.044605884701013565, 0.04266766831278801, -0.05690816789865494, -0.022424079477787018, 0.026610087603330612, -0.03932962939143181, -0.03596467152237892, -0.04856307432055473, 0.013103146106004715, -0.012268636375665665, -0.02076852135360241, -0.10649418830871582, 0.0030520169530063868, -0.01472505647689104, -0.015909520909190178, 0.03930271044373512, -0.0038999863900244236, -0.008271066471934319, 0.0027340282686054707, 0.014078984037041664, -0.018601488322019577, 0.010545778088271618, 0.017995795235037804, 0.02228948101401329, -0.0012467169435694814, 0.06040772423148155, 0.06083843857049942, -0.011164930649101734, -0.028938638046383858, 0.010202552191913128, 0.05050129070878029, 0.04465972259640694, 0.01640753448009491, 0.002155255526304245, 0.0029056412167847157, 0.01562686450779438, -0.03413413465023041, -0.04624798148870468, 0.007227929774671793, -0.025923635810613632, -0.029800068587064743, 0.01530382875353098, -0.07542889565229416, 0.016447914764285088, 0.022302942350506783, -0.005811282433569431, 0.03144216910004616, 0.015734544023871422, -0.01666327193379402, -0.00432397099211812, -0.024658411741256714, -0.01792849600315094, -0.005077721551060677, 0.05483535677194595, 0.022006824612617493, -0.008439314551651478, 0.020943498238921165, 0.02301631309092045, -0.05540066957473755, 0.011683134362101555, 0.011023602448403835, 0.002688601380214095, 0.05669281259179115, -0.010316961444914341, 0.05179343372583389, -0.012833950109779835, -0.00661214254796505, -0.026085155084729195, 0.006925083696842194, 0.0015175960725173354, -0.02958471141755581, -0.014455859549343586, -0.013681919313967228, -0.07532121986150742, 0.01256475318223238, 0.0091392258182168, 0.01518269069492817, -0.027861852198839188, -0.013722298666834831, 0.04721708968281746, -0.029073236510157585, -0.024967988952994347, 0.012625322677195072, 0.025990935042500496, -0.014926953241229057, -0.019489835947752, 0.000444174453150481, -0.005303173791617155, -0.05257410183548927, 0.004273496568202972, 0.016919009387493134, 0.024846849963068962, -0.05182035267353058, -0.010323691181838512, 0.0006641586078330874, -0.02409309893846512, -0.027108101174235344, 0.03628770634531975, -0.02438921481370926, -0.0027744078543037176, -0.02424115687608719, -0.023541245609521866, 0.06369192153215408, -0.03766060993075371, -0.023002853617072105, -0.02037818543612957, -0.031469088047742844, 0.05050129070878029, 0.00491283880546689, -0.03900659456849098, 0.019180260598659515, 0.0280233696103096, -0.013089686632156372, 0.051066603511571884, 0.011333178728818893, -0.03208823874592781, 0.04183315858244896, -0.0002752956352196634, -0.010364070534706116, 0.020943498238921165, 0.0005152591620571911, 0.04856307432055473, -0.029369352385401726, -0.037202976644039154, 0.0023823902010917664, -0.016622891649603844, 0.02410655841231346, -0.01705360785126686, 0.009543021209537983, 0.011178390122950077, 0.00798168033361435, -0.010135253891348839, -0.003444034606218338, 0.02043202519416809, 0.043421417474746704, -0.003815862350165844, -0.01121876947581768, 0.03138832747936249, -0.002294901292771101, 0.015236529521644115, 0.013587700203061104, 0.0017884752014651895, -0.006359770428389311, 0.013405992649495602, -0.01718820445239544, -0.01822461187839508, -0.022558677941560745, 0.025990935042500496, -0.02444305457174778, -0.044363606721162796, 0.05168575420975685, -0.043421417474746704, 0.02880403958261013, -0.050097495317459106, -0.05120120197534561, -0.008479693904519081, -0.013278123922646046, -0.004044679459184408, -0.0052022249437868595, -0.0423177108168602, -0.010041034780442715, -0.013587700203061104, -0.027754172682762146, -0.0020004676189273596, 0.00810281839221716, -0.004828714765608311, 0.03268047049641609, 0.01772659830749035, -0.049451421946287155, -0.04767472296953201, -0.022276021540164948, 0.04597878456115723, -0.031146051362156868, 0.01055250782519579, -0.05246642604470253, 0.020808899775147438, -0.004354255739599466, -0.02826564759016037, -0.02062046341598034, 0.044013649225234985, 0.0313614085316658, 0.010693836025893688, 0.07801318913698196, 0.020391644909977913, -0.0025354959070682526, -0.029234755784273148, 0.025062207132577896, -0.025142965838313103, 0.04086405038833618, 0.004101883620023727, -0.016097959131002426, -0.02175108902156353, -0.05246642604470253, -0.0033834653440862894, -0.03443025052547455, -0.0014040287351235747, 0.02366238459944725, -0.003957190550863743, -0.00619825255125761, 0.011965790763497353, -0.0074971262365579605, 0.0008664766792207956, 0.0018860589480027556, -0.0055454508401453495, -0.018641866743564606, 0.02141459286212921, -0.0439867302775383, 0.03311118483543396, -0.03782212734222412, -0.021818388253450394, 0.009583400562405586, 0.012315746396780014, 0.04328681901097298, 0.02605823427438736, 0.009792027994990349, -0.002977987751364708, -0.016636352986097336, -0.023635465651750565, 0.0010919289197772741, 0.012477263808250427, 0.00031714729266241193, -0.014536618255078793, -0.010000655427575111, 0.00407832907512784, -0.0023756602313369513, 0.0007579567609354854, -0.037687528878450394, 0.025829417631030083, 0.00015604992222506553, -0.011393747292459011, -0.026771605014801025, 0.047351688146591187, 0.0564236156642437, 0.06207674369215965, -0.05109352245926857, -0.0040413145907223225, -0.06412263959646225, -0.022814415395259857, -0.05168575420975685, 0.030392300337553024, 0.021172314882278442, 0.0029628456104546785, 0.018682247027754784, 0.040675610303878784, 0.05109352245926857, -0.038522038608789444, 0.03615310788154602, -0.03130757063627243, 0.026731226593255997, -0.04196775704622269, 0.01063326746225357, -0.0017363183433189988, 0.06945273280143738, 0.06584549695253372, 0.006080478895455599, -0.012288826517760754, -0.021293453872203827, -0.007268309127539396, -0.010532318614423275, 0.024227697402238846, 0.04444436356425285, 0.0009169510449282825, 0.02939627319574356, -0.024214237928390503, 0.014025145210325718, 0.06869897991418839, 0.03698761761188507, -0.038925834000110626, -0.01650175452232361, 0.0032522319816052914, 0.031415246427059174, 0.031226810067892075, -0.04614030197262764, -0.0580926351249218, -0.03219591826200485, -0.0038932564202696085, -0.04600570723414421, -0.021724168211221695, -0.0168920885771513, 0.03017694316804409, -0.033434223383665085, -0.017282424494624138, 0.016838248819112778, -0.02591017633676529, 0.021885687485337257, 0.0012786840088665485, 0.059061743319034576, -0.014926953241229057, -0.03219591826200485, -0.023137450218200684, 0.11327794194221497, -0.014576997607946396, 0.03125372901558876, -0.03652998432517052, 0.01954367570579052, -0.013305043801665306, -0.00366780417971313, -0.007402907591313124, 0.0175381600856781, 0.023393187671899796, 0.02267981693148613, 0.02518334612250328, -0.029746228829026222, 0.004155722912400961, 0.006063654087483883, 0.0062117124907672405, -0.001377109088934958, 0.006450624670833349, -0.006588587537407875, 0.0022427444346249104, 0.08038211613893509, -0.06148451194167137, 0.0421292744576931, 0.016380615532398224, 0.016595972701907158, 0.020001310855150223, 0.02546600252389908, 0.018991822376847267, 0.012827219441533089, 0.07623648643493652, 0.024079639464616776, -0.02247791923582554, 0.004586437717080116, 0.01109763141721487, -0.027215780690312386, -0.05483535677194595, -0.012544563040137291, -0.015061551705002785, 0.020243586972355843, -0.01572108455002308, 0.0073894476518034935, 0.0218049269169569, -0.02650240994989872, -0.019920552149415016, 0.01865532621741295, 0.029315514490008354, 0.0010044400114566088, 0.026044774800539017, 0.024819929152727127, 0.08199729770421982, 0.008419124409556389, -0.017322802916169167, -0.003627424594014883, 0.031226810067892075, -0.02002822980284691, -0.0026667292695492506, -0.022020285949110985, 0.003708183765411377, 0.002698696218430996, 0.0371222160756588, -0.042156193405389786, -0.024860309436917305, -0.004095153883099556, 0.009563210420310497, -0.013486751355230808, -0.03763369098305702, -0.02752535603940487, -0.025694819167256355, 0.017322802916169167, -0.008520073257386684, -0.02165686897933483, -0.11521615833044052, -0.025506380945444107, -0.029530871659517288, 0.0005425994750112295, -0.028884800150990486, 0.048078518360853195, 0.030634578317403793, -0.036960698664188385, -0.0021317009814083576, -0.03453793004155159, -0.023675844073295593, 0.01437510084360838, -0.00409178901463747, 0.006130953319370747, -0.01846688985824585, -0.010478478856384754, 0.0038596068043261766, -0.005343553144484758, -0.00455615296959877, -0.006376595236361027, -0.01592298038303852, -0.0019365333719179034, 0.002453054301440716, 0.02518334612250328, -0.0013964575482532382, -0.0034659067168831825, -0.035291679203510284, -0.013601160608232021, -0.016730571165680885, 0.011999440379440784, 0.0007116885972209275, 0.020512783899903297, 0.01273973099887371, 0.023796983063220978, -0.032061319798231125, -0.005057531874626875, -0.004996962379664183, -0.013904006220400333, 0.004613357596099377, 0.01876300573348999, -0.005925691220909357, -0.00734906829893589, 0.029961585998535156, -0.047836244106292725, 0.01550572644919157, 0.015694163739681244, -0.023918122053146362, -0.025398703292012215, -0.023500867187976837, 0.012349396012723446, -0.02586979605257511, 0.004209562204778194, -0.025398703292012215, -0.0315498448908329, -0.020068610087037086, 0.021589569747447968, -0.03844128176569939, -0.02249137870967388, 0.01705360785126686, 0.022316401824355125, -0.006474179215729237, -0.02179146744310856, 0.014078984037041664, 0.009193065576255322, -0.006851054262369871, -0.010357340797781944, 0.011918680742383003, -0.051308877766132355, -0.003412067424505949, -0.017753519117832184, -0.009576670825481415, -0.04199467599391937, 0.004828714765608311, 0.01813039369881153, -0.009361312724649906, 0.012726271525025368, -0.042452309280633926, -0.020593542605638504, 0.058469511568546295, -0.04412132874131203, 0.023541245609521866, 0.02223564311861992, 0.005279619246721268, 0.0387912355363369, 0.0290463175624609, 0.005599290132522583, -0.002163667930290103, 0.005081086419522762, -0.012241717427968979, 0.011979250237345695, -0.020405104383826256, 0.04875151067972183, -0.014092444442212582, -0.011649484746158123, -0.020876199007034302, 0.03023078292608261, -0.02238370105624199, 0.0006519606104120612, 0.00045300746569409966, -0.012241717427968979, -0.022949013859033585, 0.02910015732049942, 0.01060634758323431, -0.036314625293016434, 0.013607890345156193, -0.001643782015889883, 0.024766091257333755, -0.012019629590213299, -0.018238071352243423, 0.001907931175082922, -0.000259101769188419, 0.01437510084360838, -0.01607104018330574, 0.002697013784199953, 0.004095153883099556, -0.023352809250354767, -0.034214891493320465, 0.02698696218430996, -0.006999112665653229, -0.018897604197263718, 0.03200748190283775, -0.015519185923039913, -0.01846688985824585, -0.022518299520015717, -0.02761957421898842, 0.03954498469829559, 0.005414217244833708, 0.04570958763360977, -0.018345750868320465, 0.024967988952994347, -0.0019398982403799891, 0.013580970466136932, -0.02013590931892395, -0.026138992980122566, -0.01748432219028473, -0.0088161900639534, -0.011824462562799454, -0.014227041974663734, 0.030634578317403793, -0.005299808923155069, 0.05338169261813164, -0.01915334165096283, -0.01031023170799017, -0.022666357457637787, 0.04344833642244339, 0.02302977256476879, -0.013298314064741135, -0.006807310041040182, -0.016340235248208046, 0.01744394190609455, -0.047593966126441956, 0.005007057450711727, 0.02665046788752079, -0.00734906829893589, -0.005111371167004108, -0.03924886882305145, -0.02234332077205181, -0.012026360258460045, 0.009193065576255322, 0.019382158294320107, -0.02247791923582554, -0.016299856826663017, 0.015653785318136215, -0.018991822376847267, -0.014132823795080185, 0.018924523144960403, -0.03101145289838314, -0.017174744978547096, -0.01553264632821083, -0.015573025681078434, 0.03914119303226471, 0.0013089686399325728, -0.050232093781232834, -0.0035904101096093655, 0.04953218251466751, -0.022006824612617493, 0.007799972780048847, -0.007544235792011023, -0.018789924681186676, -0.007315418682992458, 0.04990905523300171, 0.018049634993076324, -0.010195822454988956, 0.01679787039756775, 0.006972192786633968, 0.0006818246329203248, 0.018480349332094193, -0.03041921928524971, -0.0022646167781203985, 0.02522372454404831, 0.01714782603085041, 0.019166801124811172, -0.015653785318136215, -0.03736449405550957, -0.01664981245994568, -0.047486286610364914, -0.029234755784273148, 0.016340235248208046, -0.004313875921070576, -0.04810544103384018, 0.032707393169403076, -0.004186007659882307, 0.014630837365984917, -0.003725008573383093, 0.023245129734277725, 0.012174418196082115, -0.04525195434689522, -0.029369352385401726, 0.0335957407951355, 0.00815665815025568, 0.012234986759722233, -0.018749546259641647, -0.0036543444730341434, 0.038575876504182816, -0.021683789789676666, -0.04506351798772812, 0.03978726267814636, 0.039464227855205536, 0.026717767119407654, 0.04369061440229416, 0.024658411741256714, 0.004074964206665754, 5.3891904826741666e-05, -0.02572173811495304, 0.01236958522349596, -0.03052689880132675, -0.008802729658782482, -0.0091392258182168, 0.006437164731323719, 0.003124363487586379, -0.009529560804367065, -0.03184596076607704, 0.00636650063097477, 0.0018978363368660212, 0.0036408845335245132, 0.004596532788127661, -0.002436229493469, -0.02028396725654602, 0.008695051074028015, -0.017565080896019936, -0.025210265070199966, -0.0009766790317371488, 0.020405104383826256, -9.358789247926325e-05, 0.018870685249567032, 0.0009379820548929274, 0.029853906482458115, 0.05701584741473198, -0.007934571243822575, -0.0015790065517649055, 0.015599945560097694, -0.022787494584918022, 0.013533861376345158, 0.008540263399481773, 0.003124363487586379, -0.014576997607946396, -0.031226810067892075, -0.033541902899742126, -0.012383045628666878, -0.015559565275907516, -0.014576997607946396, 0.00933439377695322, -0.021522270515561104, -0.016690190881490707, 0.01959751546382904, 0.0017279059393331409, 0.006178062874823809, -0.0062756468541920185, 0.019018743187189102, -0.008048979565501213, -0.10514820367097855, -0.022962473332881927, 0.03801056370139122, 0.034860964864492416, 0.041267845779657364, -0.02640818990767002, 0.009664159268140793, -0.010525588877499104, -0.015344208106398582, -0.017888115718960762, -0.004616722464561462, -0.006309296004474163, 0.023191289976239204, 0.00800860021263361, 0.024012340232729912, -0.05050129070878029, -0.000444174453150481, -0.01690554805099964, 0.011770622804760933, -0.008176848292350769, -0.0015327383298426867, 0.003799037542194128, 0.011178390122950077, 0.06805291026830673, -0.046947892755270004, -0.02620629221200943, 0.024173857644200325, -0.0037115486338734627, -0.008661401458084583, 0.0006965462816879153, -0.007847081869840622, -0.009758378379046917, -0.02273365668952465, 0.032168999314308167, -0.029907746240496635, 0.01190522126853466, -0.0083518261089921, -0.02453727275133133, 5.7046552683459595e-05, -0.006070384290069342, 0.014052064158022404, -0.0688605010509491, 0.050232093781232834, 0.014227041974663734, 0.005427677184343338, -0.016676731407642365, 0.027444597333669662, -0.038871996104717255, 0.0008681591716594994, -0.03919503092765808, 0.015249989926815033, 0.012127308174967766, -0.007227929774671793, -0.015855681151151657, -0.0037384682800620794, 0.026462029665708542, 0.0015436745015904307, 0.007874001748859882, 0.022706735879182816, 0.03243819624185562, 0.014805815182626247, 0.031038371846079826, 0.06078460067510605, -0.00674674054607749, -0.04737860709428787, -0.024133479222655296, 0.002410992281511426, 0.0023150912020355463, 0.0022982663940638304, -0.01865532621741295, -0.012033089995384216, -0.016124878078699112, 0.0017077161464840174, 0.021293453872203827, -0.006302566267549992, -0.014469319023191929, -0.0035904101096093655, 0.04457896202802658, -0.06153834983706474, 0.026569707319140434, 0.05669281259179115, -0.03846820071339607, 0.018870685249567032, 0.0005375520559027791, -0.012457074597477913, 0.015236529521644115, -0.007874001748859882, 0.001171846641227603, -0.03644922375679016, 0.04721708968281746, 0.03179212287068367, 0.00852680392563343, 0.009031547233462334, -0.03830668330192566, -0.0039773802272975445, -0.014536618255078793, -0.01792849600315094, 0.016286397352814674, 0.0421292744576931, 0.007133711129426956, 0.024954527616500854, 0.05483535677194595, -0.021226154640316963, -0.019557135179638863, -0.0008067486924119294, 0.02253175899386406, -0.012847409583628178, 0.02761957421898842, 0.023150911554694176, -0.012652241624891758, -0.009206525050103664, -0.021239614114165306, -0.04947834089398384, -0.01620563678443432, 0.0018860589480027556, 0.02586979605257511, 0.0675683543086052, 0.030580738559365273, 0.02140113338828087, 0.008910409174859524, 0.005572370253503323, 0.012544563040137291, -0.018884144723415375, 0.012160957790911198, -0.03006926365196705, -0.02713502198457718, 0.006561668124049902, -0.009361312724649906, 0.0024867039173841476, -0.014173203147947788, 0.014469319023191929, -0.014240502379834652, 0.045628830790519714, -0.004821984563022852, 0.005915596149861813, 0.043421417474746704, 0.019759032875299454, 0.028481004759669304, -0.047297850251197815, 0.03017694316804409, 0.0005876058130525053, 0.0027407582383602858, 0.02713502198457718, 0.02674468606710434, 0.03047305904328823, 0.009617050178349018, -0.005394027568399906, -0.0005106323515065014, -0.025385243818163872, 0.012625322677195072, 0.05012441426515579, -0.016434455290436745, -0.008809460327029228, 0.008573913015425205, -0.011911951005458832, 0.015640323981642723, -0.014751975424587727, -0.008223957382142544, 0.003987475298345089, 0.018843764439225197, 0.02360854484140873, 0.04996289685368538, 0.01415974274277687, -0.02184530720114708, -0.0037216434720903635, 0.002612889977172017, -0.025492921471595764, -0.0013754265382885933, 0.0031277283560484648, 0.02249137870967388, -0.021279994398355484, -0.027861852198839188, 0.019314859062433243, 0.023352809250354767, 0.02547946199774742, 0.018009254708886147, -0.030742255970835686, 0.00977183785289526, 0.027202321216464043, 0.02880403958261013, 0.023770062252879143, 0.014967333525419235, -0.037149135023355484, -0.009812217205762863, 0.031334489583969116, -0.018143853172659874, 0.0038999863900244236, 0.006292471196502447, 0.003920176066458225, 0.03752601146697998, -0.014469319023191929, 0.03739141300320625, -0.016636352986097336, 0.041510120034217834, 0.01545188669115305, 0.018453430384397507, -0.015021172352135181, 0.02267981693148613, -0.006349675823003054, -0.05079740658402443, -0.016447914764285088, 0.014253961853682995, -0.010855354368686676, -0.016488293185830116, -0.009179605171084404, 0.01768621988594532, -0.024066179990768433, 0.007046222221106291, 0.01841305010020733, 0.007941300980746746, -0.0035163811407983303, 0.009516101330518723, -0.025977475568652153, 0.028427165001630783, -0.010835165157914162, -0.014576997607946396, 0.05128195881843567, -0.019368698820471764, -0.060515403747558594, -0.005441137123852968, -0.04116016626358032, -0.022518299520015717, -0.017766978591680527, -0.024429595097899437, -0.01616525836288929, -0.01286086905747652, 0.024469973519444466, -0.002673459006473422, -0.006161238066852093, -0.009045006707310677, -0.012080199085175991, 0.02455073408782482, -0.014092444442212582, -0.006824134849011898, -0.0218049269169569, -0.01075440552085638, -0.028184888884425163, -0.011400477960705757, -0.007409637328237295, -0.0038797964807599783, 0.0218991469591856, 0.005293078720569611, -0.0037182786036282778, -0.013513671234250069, 0.0019920552149415016, -0.010767865926027298, 0.02312399074435234, 0.02831948548555374, -0.046651776880025864, -0.016178717836737633, -0.024214237928390503, 0.020351266488432884, 0.04105248674750328, -0.00409178901463747, -0.009933356195688248, 0.0016639716923236847, -0.007941300980746746, 0.0530855767428875, 0.04124092683196068, 0.027256159111857414, -0.005501706153154373, -0.011595644988119602, -0.028830960392951965, -0.013560780324041843, 0.010821704752743244, -0.01724204421043396, 0.012430154718458652, 0.0008900313987396657, -0.02626013197004795, -0.007268309127539396, -0.019947471097111702, -0.001290461397729814, -0.00013112821034155786, 0.040487173944711685, 0.02600439451634884, -0.0026549517642706633, 0.008345095440745354, -0.019072581082582474, 0.0049229334108531475, 0.025950556620955467, -0.007234659511595964, -0.041671641170978546, -0.03502248227596283, -0.021091556176543236, 0.04188699647784233, -0.009691079147160053, 0.024900689721107483, -0.017807357013225555, 0.01846688985824585, 0.006645792163908482, 0.03521091863512993, 0.03572239354252815, -0.025210265070199966, 0.009145955555140972, 0.0022511568386107683, -0.022033745422959328, 0.03332654386758804, -2.46456875174772e-05, 0.011185119859874249, -0.006702996324747801, -0.0023218209389597178, 0.024039259180426598, -0.011212039738893509, 0.020216668024659157, 0.031872883439064026, -0.015559565275907516, 0.0049868677742779255, 0.015209609642624855, -0.006692901253700256, -0.011104361154139042, -0.02184530720114708, -0.02150881104171276, -0.014132823795080185, 0.026515869423747063, 0.04791700094938278, -0.020876199007034302, 0.0018658691551536322, 0.009785298258066177, 0.03238435462117195, -0.016044119372963905, -0.006487639155238867, -0.010862084105610847, 0.0022242371924221516, 0.03569547459483147, -0.007012572605162859, -0.011676404625177383, -0.015559565275907516, -0.0014654392143711448, 0.0063362158834934235, 0.044255927205085754, -0.01041117962449789, 0.03556087613105774, 0.015801843255758286, -0.02076852135360241, 0.00736252823844552, 0.005935785826295614, -0.012854139320552349, -0.0008277796441689134, -0.024066179990768433, -0.025210265070199966, 0.02566790021955967, 0.00020683975890278816, -0.0021350658498704433, -0.016124878078699112, 0.015761462971568108, 0.0011533393990248442, 0.012349396012723446, 0.019530216231942177, 0.007167360279709101, -0.029073236510157585, 0.06627621501684189, 0.019732113927602768, -0.00812973827123642, -0.027323458343744278, -0.003701453795656562, -0.0030856665689498186, -0.01778043806552887, -0.019920552149415016, -0.04907454550266266, -0.004633547272533178, -0.011111090891063213, 0.04336757957935333, -0.027861852198839188, 0.0028316122479736805, 0.018480349332094193, 0.011481236666440964, -0.012726271525025368, 0.03424181416630745, 0.01572108455002308, 0.020755060017108917, 0.008432584814727306, 0.01983979158103466, -0.015936441719532013, -0.009078656323254108, -0.013379072770476341, 0.0006326120928861201, -0.011615835130214691, 0.016528673470020294, 0.00812973827123642, 0.007914381101727486, 0.018197692930698395, -0.02507566660642624, -0.023325888440012932, -0.0016824789345264435, 0.023891201242804527, -0.0049700429663062096, -0.04105248674750328, 0.021239614114165306, -0.018453430384397507, 0.0020425294060260057, 0.0012559705646708608, 0.008176848292350769, 0.0023066787980496883, -0.004522503353655338, -0.0031714728102087975, 0.01160910539329052, 0.0026667292695492506, -0.01268589124083519, 0.018749546259641647, 0.016932468861341476, 0.02095695771276951, -0.006174698006361723, 0.013755948282778263, 0.003232042072340846, 0.014469319023191929, -0.007806702516973019, -0.009085386991500854, 0.01787465624511242, 0.035830073058605194, -0.0001925386895891279, -0.04869767278432846, 0.009953545406460762, -0.004482124000787735, 0.028669441118836403, 0.01530382875353098, -0.030930694192647934, -0.008459504693746567, 0.015048092231154442, 0.008257606998085976, 0.035291679203510284, -0.003792307572439313, 0.017134366557002068, -0.012154228053987026, 0.009246904402971268, 0.0006342945853248239, 0.004111978691071272, 0.01055250782519579, 0.02861560322344303, -0.01826499216258526, 0.04689405485987663, -0.0026599992997944355, 0.0182784516364336, 0.0007768846699036658, 0.010182362981140614, 0.011151471175253391, 0.044740479439496994, 0.018736086785793304, -0.01694592833518982, -0.023635465651750565, 0.019530216231942177, -0.019557135179638863, 0.00982567761093378, 0.030634578317403793, -0.0013552368618547916, 0.024187317118048668, -0.03405337408185005, 0.016717111691832542, -0.0350763201713562, 0.014913493767380714, 0.012584942393004894, -0.015653785318136215, -0.025600600987672806, 0.035641636699438095, 0.01366845890879631, -0.02778109349310398, 0.020741600543260574, -0.035937752574682236, -0.04177931696176529, 0.02739075757563114, 0.04374445229768753, 0.014388560317456722, -0.019166801124811172, -0.0038124974817037582, 0.01993401162326336, 0.016340235248208046, 0.01547880657017231, -0.026138992980122566, 0.04118708521127701, -0.0005871851462870836, -0.035937752574682236, 0.0247795507311821, 0.004959947895258665, 0.009724728763103485, 0.017807357013225555, 0.019947471097111702, -0.019853252917528152, -0.02683890424668789, 0.008822919800877571, 0.0039168111979961395, 0.011454316787421703, -0.032545872032642365, 0.012699351646006107, 0.01905912160873413, 0.0036307896953076124, 0.031172970309853554, -0.008567183278501034, -0.014267422258853912, -0.014415480196475983, -0.0007554330513812602, 0.006565032992511988, 0.019826332107186317, -0.004909473471343517, 0.00605019461363554, 0.009502640925347805, -0.015424967743456364, 0.000836612656712532, -0.013769407756626606, -0.0036644393112510443, 0.01300219725817442, 0.039948780089616776, -0.02988082729279995, 0.007941300980746746, -0.014482779428362846, 0.04075637087225914, 0.017511241137981415, 0.015344208106398582, 0.013877086341381073, -0.021468432620167732, 0.02444305457174778, 0.008190307766199112, 0.03286891058087349, -0.033434223383665085, 0.005212320014834404, -0.008728700689971447, 0.0313614085316658, 0.005340188276022673, 0.005357013083994389, -0.013298314064741135, 0.01273300126194954, -0.008755620568990707, -0.007692293729633093, 0.03704145923256874, 0.004660466685891151, -0.01171005330979824, -0.022410620003938675, -0.021562650799751282, -0.0003684629045892507, -0.004108613822609186, -0.027067722752690315, 0.006346310954540968, -0.0018221247009932995, -0.0072212000377476215, 0.04535963386297226, 0.017080526798963547, 8.412395254708827e-05, -0.007631724700331688, 0.012349396012723446, 0.02145497128367424, 0.00513156084343791, 0.014859654009342194, 0.010370800271630287, 0.0008374539320357144, 0.008190307766199112, 0.008560453541576862, 0.013183905743062496, 0.0020357996691018343, 0.0066592516377568245, 0.009341123513877392, -0.02028396725654602, 0.0488053523004055, -0.02518334612250328, 0.0047681452706456184, 0.029477031901478767, 0.010687106288969517, -0.008997897617518902, -0.010047764517366886, -0.010680376552045345, -0.019032202661037445, 0.0002643595216795802, 0.005195495206862688, -0.006161238066852093, -0.008223957382142544, 0.02591017633676529, 0.03432257100939751, 0.028481004759669304, 0.008890219032764435, 0.0022225547581911087, -0.006497733760625124, -0.023473946377635002, -0.009119035676121712, 0.003363275434821844, 0.013729028403759003, -0.007907651364803314, 0.029853906482458115, -0.03523784130811691, 0.018049634993076324, -0.000819787906948477, -0.008425855077803135, 0.005592559929937124, 0.018870685249567032, 0.027538815513253212, -0.03722989559173584, -0.011286068707704544, -0.004946488421410322, 0.011286068707704544, 0.0006713091279380023, 0.017080526798963547, -0.0244968943297863, -0.01739010214805603, 0.009940085932612419, -0.029503950849175453, 0.0009657429181970656, 0.00562284467741847, 0.0025943825021386147, 0.004566248040646315, 0.07494434714317322, -0.005602655000984669, 0.016084499657154083, -0.035641636699438095, 0.0030890314374119043, 0.019812872633337975, 0.030257701873779297, 0.013614620082080364, -0.009051737375557423, 0.029180916026234627, -0.030311541631817818, 0.010882274247705936, -0.03184596076607704, 0.034161053597927094, 0.030338460579514503, -0.020633922889828682, -0.00942861195653677, 0.022760575637221336, 0.020364725962281227, 0.0009463944588787854, 0.013607890345156193, 0.004882554057985544, 0.009845866821706295, -0.030311541631817818, -0.03370342031121254, -0.019368698820471764, 0.0036543444730341434, -0.004976772703230381, 0.010565968230366707, -0.008190307766199112, 0.04142936319112778, 0.01553264632821083, 0.008903678506612778, -0.0009977100417017937, -0.00171781110111624, 0.05120120197534561, -0.018291911110281944, 0.013560780324041843, -0.012948358431458473, -0.011010142974555492, -0.03537243977189064, -0.024308456107974052, 0.006999112665653229, -0.012578212656080723, 0.02600439451634884, -0.034860964864492416, -0.006864514201879501, 0.023447027429938316, -0.03440333157777786, -0.03036538138985634, -0.01852072961628437, 0.002639809623360634, -0.04595186561346054, 0.0016505118692293763, 0.040783289819955826, -0.02831948548555374, 0.0010263122385367751, -0.004327335860580206, 0.004996962379664183, 0.026717767119407654, 0.05615441873669624, -0.027013882994651794, 0.03405337408185005, 0.011508156545460224, -0.01533074863255024, 0.01238977536559105, 0.003198392456397414, 0.004118708427995443, 0.002434547059237957, -0.028696361929178238, 0.013264664448797703, -0.0007470206473954022, 0.015788381919264793, -0.005054167006164789, 0.02963854931294918, -0.024012340232729912, 0.009677618741989136, 0.00815665815025568, 0.026879284530878067, 0.013540591113269329, -0.023837361484766006, -0.021966446191072464, 0.003691358957439661, -0.01709398627281189, 0.0051416559144854546, 0.02342010661959648, -0.0009657429181970656, -0.0011911951005458832, -0.0006649998249486089, 0.005700238980352879, 0.002320138504728675, 0.01307622715830803, 0.012753190472722054, 0.04737860709428787, -0.0247795507311821, -0.007275039330124855, 0.008735431358218193, -0.04142936319112778, -0.016784410923719406, -0.014536618255078793, 0.013338693417608738, -0.012638782151043415, 0.012436884455382824, 0.009435342624783516, -0.0010145348496735096, 0.02017628774046898, 0.026394730433821678, -0.0035971400793641806, -0.007853811606764793, 0.01896490342915058, 0.016569053754210472, 0.021078096702694893, -0.014132823795080185, -0.039114270359277725, 0.008715241216123104, -0.030446140095591545, -0.010471749119460583, 0.016569053754210472, -0.005101276095956564, 0.017417022958397865, -0.014469319023191929, -0.0030722066294401884, -0.015344208106398582, 0.010761135257780552, -0.005632939748466015, 0.0020980513654649258, 0.03628770634531975, 0.01222152728587389, -0.0025102586951106787, -0.01369537878781557, -0.04191391542553902, -0.032895829528570175, -0.0009026500047184527, 0.029530871659517288, 0.006952003110200167, 0.012753190472722054, -0.021979905664920807, 0.022410620003938675, -0.012208067812025547, 0.020512783899903297, 0.0031277283560484648, -0.02028396725654602, 0.016528673470020294, -0.011891761794686317]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"
We next describe methods for learning variational policies or proposals qξ(s1:T) =QT
t=1qξ
t(st|s1:t−1)parameterized
byξ, which can be used for SMC sampling with intermediate targets πθ
t(s1:t)and learned twists ψθ
t(s1:t)orVθ
t(s1:t)
parameterized by θ. Alternatively, such proposals may be used directly in the IWAE bounds on logZσ, which rely on
simple importance sampling over full sequences as in Sec. 2.1 and do not require the definition of intermediate targets πt.
In App. E.3, we provide a detailed description of the DPG policy gradient method, which can be interpreted as a maximum
likelihood objective for a sequential energy-based model. To distinguish this EBM approach from our CTL method for
twist learning, we emphasize issues which can arise from naive use of a proposal-learning objective to define intermediate
twisting targets for SMC in App. E.3.1.
E.1. Path Consistency Learning for Controlled Generation
Guo et al. (2021) consider learning Q-values to obtain a fine-tuned variational policy which can be directly used as a
sampling distribution for controlled generation. Building on the path consistency learning ( PCL ) loss in Nachum et al.
(2017) and App. C.1.2, Guo et al. (2021) consider parameterizing the proposal using Qξ
t(st,s1:t−1),
qξ
t(st|s1:t−1) =p0(st|s1:t−1)eβQξ
t(st,s1:t−1)−βVQξ(s1:t−1)(60)
where VQξ(s1:t−1) =1
βlogP
stp0(st|s1:t−1)eβQξ
tenforces normalization.
Guo et al. (2021) define the targets using ¯Qξ
t(st,s1:t−1), a slowly-updated target network based on Qξ
t. Using the implied
form of the soft value ¯V(s1:t−1):=1
βlogP
stp0(st|s1:t−1)eβ¯Qξ
t(st,s1:t−1), the single-step PCL loss becomes
LPCL−Q(ξ) = min
ξTX
t=1Eπs(s1:t)
rt(s1:t) +sg(¯Vt(s1:t))−sg(¯Vt−1(s1:t−1))−Qξ
t(st,s1:t−1) +VQξ(s1:t−1)2
(61)
where sg(·)indicates stop gradient. Building on the interpretation in App. C.1, we view ¯Vt(s1:t)and¯Vt−1(s1:t−1)as the
twisting targets, with a learned proposal parameterized by Qξ
tas in Eq. (60) (or App. B.4). While the loss in Eq. (61)
is similar in practice to the soft Q-learning loss in App. C.1.1, we emphasize that the latter is motivated from the SMC
perspective with the twisting targets as the primary object of interest and flexibility in the choice of proposal. By contrast,
Guo et al. (2021) are interested in learning a proposal policy and do not consider, for example, resampling according to ¯Vt.
Guo et al. (2021); Nachum et al. (2017) also consider ‘multi-step’ PCL losses (Eq. (multi-step PCL)) which use observed
reward during rollouts of length λto limit reliance on estimated intermediate values ¯Vt(s1:t). The objective in Hu et al.
(2023) also corresponds to a PCL objective.
32
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
E.2. Policy Gradient Methods
Traditional RLHF pipelines use a policy gradient method such as PPO to optimize the objective in Eq. (42),
LELBO(ξ) = max
ξEqξ(s1:T)[rT(s1:T)]−1
βDKL 
qξ(s1:T)p0(s1:T)
= min
ξDKL 
qξ(s1:T)σ(s1:T)
(62)
where rT(s1:T) =1
βlogϕ(s1:T","[0.027052612975239754, -0.008185949176549911, 0.034822769463062286, -0.01212300080806017, -0.036226075142621994, 0.015280438587069511, -0.005746406503021717, 0.0029430435970425606, -0.030326994135975838, 0.032146092504262924, 0.04802423715591431, -0.007640219293534756, -0.040773823857307434, 0.02279072254896164, 0.02538943663239479, -0.02744241990149021, 0.028170060366392136, -0.011700710281729698, 0.0033052393700927496, 0.04043599218130112, -0.014266940765082836, -0.004895327612757683, -0.010057023726403713, 0.058471065014600754, 0.0061037298291921616, -0.05940660461783409, 0.048881810158491135, 0.00984912645071745, 0.005415070336312056, -0.026039114221930504, 0.07697390764951706, -0.023375432938337326, -0.026688793674111366, -0.044282086193561554, -0.02108856476843357, 0.045841317623853683, -0.021790217608213425, 0.03859090432524681, -0.018139025196433067, 0.014357895590364933, 0.012766183353960514, -0.05514471232891083, -0.0054053254425525665, 0.047946274280548096, 0.022115057334303856, 0.04316464066505432, 0.01742437854409218, 0.008959067054092884, -0.003443296067416668, 0.018411889672279358, -0.00041477911872789264, 0.03095068410038948, -0.03087272308766842, -0.016696738079190254, -0.003989025950431824, 0.012194465845823288, 0.030560877174139023, -0.029729289934039116, 0.015033560805022717, -0.025532366707921028, 0.011492813006043434, -0.05363745987415314, 0.0024070588406175375, 0.02731248550117016, 0.02561032772064209, -0.006087487563490868, -0.04373635724186897, 0.019893156364560127, -0.022167030721902847, 0.020932642742991447, -0.017957113683223724, 0.004180681426078081, 0.024700777605175972, -0.031756285578012466, -0.030820749700069427, 0.015553303994238377, 0.003972784150391817, 0.034251052886247635, -0.00581462262198329, -0.011297909542918205, 0.012181472033262253, -0.03804517537355423, 0.02533746138215065, -0.01975022628903389, -0.018840676173567772, -0.049401555210351944, -0.04753047972917557, -0.00558073865249753, -0.02985922433435917, -0.022180024534463882, -0.02234894037246704, -0.0007572815520688891, -0.03547244891524315, -0.025727270171046257, 0.031210556626319885, 0.03308163210749626, 0.023518363013863564, -0.0016266326420009136, 0.0396563783288002, 0.0005376089829951525, -0.004840104840695858, -0.01602107286453247, 0.029261520132422447, -0.026714781299233437, 0.09131881594657898, -0.014474837109446526, -0.02336243912577629, 0.040306054055690765, -0.021166525781154633, -0.030171070247888565, -0.029521392658352852, -0.017593294382095337, -0.03703167662024498, 0.06720274686813354, 0.037681352347135544, -0.048985760658979416, -0.032276030629873276, 0.00988810695707798, -0.019867168739438057, 0.01543636154383421, -0.042385026812553406, -0.0031168328132480383, 0.013097519055008888, -0.015852155163884163, 0.02541542425751686, -0.004125458654016256, 0.016891641542315483, -0.07463506609201431, -0.01824297197163105, 0.03406914323568344, 0.009251422248780727, 0.008816137909889221, 0.007945568300783634, -0.03960440307855606, -0.00213256967253983, -0.0023583329748362303, 0.011856633238494396, 0.015514323487877846, -0.012538795359432697, 0.023219510912895203, 0.009335880167782307, -0.009524286724627018, -0.029183559119701385, 0.010602753609418869, -0.026662806048989296, -7.72762177803088e-06, -0.018554817885160446, 0.014175985008478165, -0.01911354251205921, 0.020906655117869377, -0.026974651962518692, -0.015657251700758934, -0.060498062521219254, 0.03095068410038948, -0.03339347615838051, -0.06314875185489655, -0.04378833249211311, 0.06637115776538849, 0.03289971873164177, -0.02936546877026558, -0.015553303994238377, 0.06954158842563629, -0.00019805043120868504, -0.011479819193482399, 0.024388931691646576, -0.010713199153542519, -0.02437593787908554, 0.05717170983552933, -0.033783283084630966, -0.03817510977387428, -0.02153034694492817, -0.036823779344558716, -0.011479819193482399, -0.023869188502430916, 0.018671760335564613, -0.04519163817167282, -0.0009266039705835283, -0.06725472211837769, -0.029287507757544518, -0.021439390257000923, -0.000333975360263139, 0.03812313452363014, -0.024635810405015945, -0.01049230806529522, -0.006649459712207317, 0.03206813335418701, -0.019438382238149643, 0.009881610050797462, 0.010511798784136772, 0.0053793382830917835, 0.004983034450560808, 0.05124664306640625, 0.07775352895259857, -0.02894967421889305, -0.023102568462491035, -0.00924492534250021, 0.06439613550901413, 0.0567559152841568, 0.038720838725566864, -0.010070016607642174, -0.0050415052101016045, 0.014955599792301655, -0.02593516744673252, -0.06933369487524033, -0.005925068166106939, 0.011167974211275578, 0.0014934485079720616, 0.006045258603990078, -0.06294085830450058, -0.012090517207980156, -0.0064123268239200115, -0.005281886551529169, 0.03256188705563545, -0.003329602302983403, -0.05530063435435295, 0.027468407526612282, -0.03697970137000084, 0.01733342371881008, 0.01049230806529522, 0.052987780421972275, 0.009030531160533428, -0.015449355356395245, 0.02427198924124241, 0.027520382776856422, -0.036693841218948364, 0.005177937913686037, -0.001550295390188694, -0.003816861193627119, 0.0344589501619339, -0.014552799053490162, 0.03757740557193756, 0.016553808003664017, -0.013298919424414635, -0.024635810405015945, 0.004918066319078207, -0.018385902047157288, -0.01290261559188366, -0.00797155499458313, -0.0026685544289648533, -0.08295095711946487, 0.023817215114831924, 0.021985121071338654, 0.03230201452970505, -0.044386036694049835, -0.00032768159871920943, 0.028014138340950012, -0.016566801816225052, -0.017164506018161774, 0.028170060366392136, 0.022972632199525833, -0.018333928659558296, 0.006019271444529295, -0.005346854217350483, -0.00023185402096714824, -0.04753047972917557, -0.009920590557157993, -2.1444466256070882e-05, 0.00479462742805481, -0.0558723509311676, -0.008075503632426262, 0.020711751654744148, -0.013149493373930454, -0.002294989302754402, 0.03295169398188591, -0.017619282007217407, -0.014669740572571754, -0.03539448603987694, -0.017879152670502663, 0.05368943139910698, -0.0014674613485112786, -0.01567024551331997, 0.012623253278434277, -0.023960143327713013, 0.035238564014434814, 0.022686773911118507, -0.04480183124542236, 0.023817215114831924, 0.026247011497616768, -0.00558073865249753, 0.04524361342191696, -0.012974079698324203, -0.043892279267311096, 0.022452889010310173, -0.004414565395563841, 0.002941419603303075, 0.025298481807112694, -0.01742437854409218, 0.03191220760345459, -0.012155485339462757, -0.0405399389564991, -0.013760191388428211, 0.013039047829806805, 0.02073773927986622, -0.03710963577032089, 0.010206449776887894, 0.024635810405015945, 0.018632780760526657, -0.022465882822871208, 0.018203992396593094, 0.011720200069248676, 0.02733847126364708, -0.0040442487224936485, -0.019685259088873863, 0.00671767583116889, 0.00991409458220005, 0.014357895590364933, 0.028040124103426933, 0.00013399618910625577, -0.017372403293848038, 0.014591779559850693, -0.008328878320753574, -0.018554817885160446, -0.01520247757434845, -0.005148702301084995, -0.025792237371206284, -0.0364859439432621, 0.04859595373272896, -0.011798162013292313, -0.0035342511255294085, -0.049037735909223557, -0.048907797783613205, -0.007438818924129009, -0.014695728197693825, 0.004940805025398731, 0.005970545578747988, -0.04007217288017273, 0.008764163590967655, 0.018359914422035217, -0.017112532630562782, -0.01715151220560074, 0.026467902585864067, -0.007393341511487961, 0.025714276358485222, 0.013233951292932034, 0.0079975426197052, -0.05535260960459709, -0.019880162551999092, 0.05628814548254013, 0.03448493406176567, 0.012798666954040527, -0.09963469952344894, 0.002077347133308649, -0.00042147893691435456, -0.043320562690496445, -0.001880819327197969, 0.030820749700069427, 0.003654441563412547, 0.029261520132422447, 0.08731679618358612, 0.014526811428368092, 0.0017492594197392464, -0.02654586359858513, 0.033731307834386826, 0.02889770083129406, 0.04267088696360588, 0.003329602302983403, -0.023219510912895203, -0.036745816469192505, -0.04189126938581467, -0.0032565135043114424, -0.028741776943206787, -0.015124515630304813, 0.025324469432234764, -0.009524286724627018, -0.007237418554723263, 0.009602248668670654, 0.0178011916577816, -0.0030502406880259514, 0.0008892474579624832, 0.004580233711749315, -0.013207964599132538, -0.03136647865176201, -0.031106607988476753, 0.029781263321638107, -0.03513461351394653, 0.012473827227950096, 0.015592284500598907, 0.034147102385759354, 0.04173534736037254, 0.017853165045380592, 0.013422357849776745, 0.012954589910805225, -0.0437103696167469, -0.023648297414183617, 0.007607735693454742, 0.0027578852605074644, -0.0031168328132480383, -0.013019557110965252, -0.002930050017312169, 0.026506884023547173, 0.02848190627992153, -0.0035504931584000587, -0.04810219630599022, 0.031236542388796806, -0.005564496386796236, 0.01950334943830967, -0.03822708502411842, 0.027286497876048088, 0.049037735909223557, 0.03406914323568344, -0.054988790303468704, 0.008023529313504696, -0.04672487825155258, -0.03905867412686348, -0.060602013021707535, 0.0019652775954455137, -0.009855623356997967, 0.03097667172551155, -0.004424310754984617, 0.021023597568273544, 0.04768640175461769, -0.026974651962518692, 0.01670973189175129, 0.011193960905075073, 0.019295452162623405, -0.059042785316705704, 0.003355589462444186, 0.00047913790331222117, 0.07302386313676834, 0.06699484586715698, -0.0036284546367824078, -0.01930844597518444, 0.03594021499156952, -0.0006878471467643976, 0.031158581376075745, -0.02254384383559227, 0.035836268216371536, -0.0017411384033039212, 0.036875754594802856, -0.02531147561967373, -0.011798162013292313, 0.04425610229372978, 0.025233514606952667, -0.047348570078611374, -0.03955242782831192, -0.02516854554414749, 0.029079610481858253, 0.015332412905991077, 0.013682229444384575, -0.04802423715591431, -0.0061297169886529446, -0.011603258550167084, -0.029573366045951843, 0.014149998314678669, -0.0007077435147948563, 0.018749721348285675, -0.019269464537501335, -0.017918134108185768, -0.010895108804106712, -0.042852796614170074, 0.012071026489138603, 0.011154980398714542, 0.07193240523338318, -0.017164506018161774, 0.0036154610570520163, -0.032120104879140854, 0.096412293612957, -0.015709226951003075, 0.026363953948020935, -0.025025617331266403, 0.01550132967531681, 0.008972059935331345, -0.008998047560453415, -0.0046809338964521885, 0.024505874142050743, 0.01626794971525669, 0.04461992159485817, -0.013513313606381416, -0.008374355733394623, 0.036719828844070435, -0.005853603594005108, -0.00721143139526248, -0.021296462044119835, -0.038746826350688934, -0.00913447979837656, 0.03180826082825661, 0.07692193984985352, -0.0208416860550642, -0.0028439676389098167, -0.010921095497906208, 0.033263541758060455, 0.008588749915361404, 0.03744747117161751, 0.039838287979364395, 0.022465882822871208, 0.059042785316705704, 0.017112532630562782, -0.040773823857307434, -0.0097386809065938, 0.009576261043548584, -0.0072309221141040325, -0.04675086587667465, -0.003846096806228161, -0.0141889788210392, 0.03456289693713188, -0.033809270709753036, -0.021491365507245064, -0.00991409458220005, -0.01945137418806553, -0.012603763490915298, 0.019269464537501335, -0.01816501095890999, -0.0026068349834531546, 0.029235532507300377, 0.03050890378654003, 0.034173090010881424, 0.012733698822557926, -0.0004868528340011835, 0.025714276358485222, 0.053585484623909, -0.023622311651706696, -0.007217928301542997, -0.04350247234106064, -0.007477799896150827, 0.014461844228208065, 0.020282963290810585, -0.027156561613082886, -0.02506459690630436, 0.018061062321066856, 0.04222910478711128, -0.02180321142077446, -0.02632497437298298, -0.027078600600361824, -0.012012556195259094, 0.013448345474898815, -0.0064902883023023605, 0.0033490927889943123, -0.10789860785007477, -0.014864644967019558, -0.047374557703733444, -0.0008088497561402619, -0.032743796706199646, 0.002368078101426363, 0.0157741941511631, -0.044463999569416046, 0.021699262782931328, -0.04675086587667465, -0.018255965784192085, -0.027624331414699554, 0.017359409481287003, -0.006535765714943409, -0.014292927458882332, -0.0021715504117310047, 0.02298562601208687, 0.003933803644031286, -0.018996600061655045, 0.016047058627009392, -0.007269902620464563, 0.006639714352786541, 0.010927592404186726, 0.020140033215284348, -0.04568539187312126, -0.02687070332467556, -0.04716666042804718, -0.012688221409916878, 0.012740195728838444, 0.0021114551927894354, 0.029183559119701385, -0.005746406503021717, 0.028585854917764664, 0.02484370581805706, -0.026195038110017776, -0.001295296591706574, -0.015657251700758934, -0.01242185290902853, 0.015163497067987919, 0.033783283084630966, -0.014903625473380089, 0.017736224457621574, 0.03599219024181366, -0.04763443022966385, 0.01703457161784172, 0.03349742293357849, -0.032250043004751205, -0.00603226525709033, -0.006561752874404192, 0.018139025196433067, -0.01651482842862606, -0.012512808665633202, -0.007861110381782055, -0.03178227320313454, -0.03162635117769241, 0.027494395151734352, -0.050051234662532806, -0.025623321533203125, 0.012194465845823288, 0.008172955363988876, 0.016423873603343964, -0.02012704126536846, 0.010128487832844257, 0.03812313452363014, -0.007854613475501537, -0.035212576389312744, -0.021686268970370293, -0.05116868019104004, -0.014799676835536957, -0.01253229845315218, -0.0023843201342970133, -0.04194324463605881, -0.004632208030670881, 0.021205507218837738, 0.028248021379113197, 0.00252724951133132, -0.024739757180213928, -0.029079610481858253, 0.053585484623909, -0.04669889062643051, 0.012694718316197395, 0.019516343250870705, -0.009199447929859161, 0.005434561055153608, 0.03495270386338234, 0.0013894999865442514, -0.010765173472464085, -0.010167469270527363, -0.03994223475456238, 0.021868178620934486, -0.01673571951687336, 0.0630967766046524, -0.0015161872142925858, 0.015371393412351608, -0.02276473492383957, 0.041293565183877945, -0.02835197001695633, -0.014409869909286499, 0.005642457865178585, -0.0050155180506408215, -0.03552442044019699, -0.014279933646321297, 0.009361867792904377, -0.022154036909341812, 0.009043524973094463, -0.016579795628786087, 0.04397024214267731, 0.013760191388428211, -0.022283973172307014, -0.011219947598874569, -0.02568828873336315, 0.010810650885105133, -0.02197212725877762, 0.03160036355257034, 0.00243467022664845, -0.012395866215229034, -0.02224499173462391, 0.024258995428681374, 0.002744891680777073, -0.030119096860289574, 0.020334938541054726, -0.0023745750077068806, -0.017684249207377434, -0.044360049068927765, -0.03607015311717987, 0.03144444152712822, -0.012441343627870083, 0.03942249342799187, -0.005925068166106939, 0.020010098814964294, 0.0010102500673383474, -0.002346963621675968, -0.010635237209498882, -0.026636818423867226, -0.016384892165660858, 0.010128487832844257, 0.009264416061341763, 0.014357895590364933, 0.04859595373272896, 0.0246747899800539, 0.0538453571498394, -0.03804517537355423, -0.013942101038992405, -0.027000639587640762, 0.02412906102836132, -0.004138452000916004, -0.010290907695889473, -0.0027546370401978493, -0.0034010671079158783, -0.018229980021715164, -0.030171070247888565, 0.023297471925616264, 0.02240091562271118, -0.005532012786716223, 0.009063015691936016, -0.04022809490561485, -0.010329888202250004, -0.017866158857941628, 0.006337613798677921, 0.012363382615149021, -0.013084525242447853, -0.00916046742349863, 0.018996600061655045, -0.003888325998559594, 0.01569623313844204, -0.00762072904035449, -0.023193523287773132, -0.020854679867625237, -0.013084525242447853, 0.003384825075045228, 0.060134243220090866, -0.01980220153927803, -0.05031110346317291, -0.009147473610937595, 0.020334938541054726, -0.012356885708868504, -0.007906587794423103, -0.04020210728049278, -0.011921600438654423, -0.041293565183877945, 0.045295584946870804, 0.022530851885676384, -0.008101491257548332, -0.0026847964618355036, -0.007653213106095791, -0.027806241065263748, -0.0021959133446216583, -0.0208416860550642, 0.010498804971575737, 0.0157741941511631, -0.006750159896910191, 0.010661224834620953, -0.019165515899658203, -0.014383882284164429, -0.010011546313762665, -0.07193240523338318, -0.01873672939836979, -0.012350388802587986, -0.01933443360030651, -0.04719264805316925, 0.007854613475501537, -0.012779176235198975, -0.001784991705790162, -0.00660073384642601, 0.01742437854409218, -0.006337613798677921, -0.005876342300325632, -0.009758171625435352, 0.039734337478876114, -0.01233739499002695, 0.007646716199815273, -0.017710236832499504, 0.0007349488441832364, 0.030690813437104225, -0.02240091562271118, -0.050986770540475845, 0.025987140834331512, 0.052026256918907166, 0.031236542388796806, 0.03552442044019699, 0.02884572558104992, -0.002727025654166937, -0.027650317177176476, -0.009186454117298126, 0.01079116016626358, -0.011187463998794556, -0.004102719947695732, 0.009608745574951172, 0.007276399526745081, 0.016579795628786087, -0.012889621779322624, -0.012662234716117382, -0.03035297989845276, 0.026013128459453583, -0.014357895590364933, -0.020945634692907333, 0.007685696706175804, -0.01474770251661539, -0.010505301877856255, -0.0025402430910617113, -0.008030026219785213, 0.0104208430275321, 0.017320429906249046, -0.012480324134230614, 0.03102864697575569, -0.013747197575867176, 0.03360137343406677, 0.04916767030954361, 0.006912579294294119, 0.009959571994841099, 0.0029219291172921658, -0.01547534205019474, 0.018035076558589935, 0.019139530137181282, -0.004326859023422003, -0.02073773927986622, -0.05410522595047951, -0.014007069170475006, -0.03908465802669525, 0.009758171625435352, -0.020140033215284348, 0.011986568570137024, -0.027988150715827942, -0.02503860928118229, 0.008543272502720356, -0.018152017146348953, 0.0071009863168001175, 0.012870131060481071, 0.02484370581805706, -0.002907311310991645, -0.11423946917057037, -0.006678695324808359, 0.015085535123944283, 0.021439390257000923, 0.04859595373272896, -0.03695371374487877, 0.01797010749578476, -0.026506884023547173, -0.003946796990931034, -0.04373635724186897, 0.012168479152023792, -0.012636247090995312, 0.030638838186860085, -0.0097386809065938, 0.024908674880862236, -0.06429218500852585, -0.01580018177628517, -0.04766041785478592, 0.012694718316197395, -0.016644762828946114, 0.002730273874476552, 0.015839163213968277, 0.0026685544289648533, 0.032691821455955505, -0.03840899467468262, -0.00887460820376873, 0.01654081605374813, 0.041761334985494614, 0.012369878590106964, 0.02034793049097061, -0.0011491188779473305, -0.038824789226055145, 0.02153034694492817, 0.031678326427936554, -0.03510862588882446, 0.01049230806529522, -0.007516780402511358, 0.005821119528263807, 0.004557495005428791, -0.007640219293534756, 0.016306931152939796, -0.038876764476299286, 0.07770155370235443, 0.016826674342155457, 0.015982091426849365, -0.02185518480837345, 0.01742437854409218, -0.021075570955872536, 0.00698404386639595, -0.028299996629357338, 0.004391826689243317, 0.009114990010857582, 0.010316895321011543, -0.01665775664150715, 0.007003534585237503, 0.005681438837200403, -0.0022105311509221792, -0.00999855250120163, -0.008211936801671982, 0.021075570955872536, -0.0049635437317192554, 0.04324260354042053, 0.05231211334466934, -0.04267088696360588, -0.06709879636764526, -0.032224055379629135, 0.013539300300180912, -0.004836856387555599, -0.009940081275999546, -0.0020416148472577333, 0.004307368770241737, 0.002062729327008128, 0.006035513244569302, 0.028248021379113197, -0.011739690788090229, -0.017710236832499504, -0.002010755008086562, 0.016748711466789246, -0.032250043004751205, -0.01036886963993311, 0.030820749700069427, -0.03362736105918884, 0.030041133984923363, -0.005229912232607603, -0.010186959058046341, 0.02991119958460331, 0.0009777661180123687, -0.012883124873042107, -0.04017611965537071, 0.03708364814519882, 0.022959638386964798, -0.023986130952835083, 0.019542329013347626, -0.03250991180539131, -0.0062986332923173904, -0.021465377882122993, -0.0141889788210392, 0.018619786947965622, 0.012694718316197395, 0.007217928301542997, 0.015904130414128304, 0.03638199716806412, -0.014072036370635033, -0.03638199716806412, 0.017736224457621574, 0.012636247090995312, -0.018398895859718323, 0.025441410019993782, 0.007269902620464563, -0.005915322806686163, 0.016696738079190254, 0.004391826689243317, -0.045919276773929596, 0.01320146769285202, -0.008452317677438259, 0.03555040806531906, 0.054053254425525665, 0.022387921810150146, 0.019880162551999092, -0.0001948020508280024, 0.031678326427936554, 0.008894098922610283, -0.029053622856736183, 0.009179957211017609, -0.017814185470342636, -0.04069586098194122, -0.0046906787902116776, 0.0032825006637722254, -0.017814185470342636, -0.02059480920433998, 0.008205439895391464, -0.03804517537355423, 0.02988521195948124, -0.009927087463438511, -0.003989025950431824, 0.028611842542886734, 0.020672770217061043, 0.00614920724183321, -0.04264489933848381, 0.02427198924124241, 0.003683677176013589, -0.009076008573174477, 0.010096004232764244, 0.03838300704956055, -0.0026263254694640636, -0.007809135597199202, 0.024142052978277206, -0.017021577805280685, 0.009043524973094463, 0.0020854680333286524, 0.054988790303468704, -0.010856128297746181, -0.003917561378329992, 0.004557495005428791, -0.004830359946936369, 0.022725755348801613, 0.04818015918135643, -0.01832093484699726, -0.019139530137181282, -0.013890126720070839, 0.03354939818382263, 0.04524361342191696, -0.013760191388428211, -0.010511798784136772, -0.03539448603987694, -0.024882687255740166, -0.004469788167625666, -0.013526306487619877, -0.000300679326755926, 0.01747635193169117, -0.00250938325189054, -0.05171440914273262, 0.012805163860321045, 0.02054283395409584, 0.034147102385759354, 0.007568754721432924, 0.0006988104432821274, 0.0004121398087590933, 0.03308163210749626, 0.02407708577811718, 0.024207022041082382, 0.016579795628786087, -0.04410017654299736, -0.002431421773508191, 0.046984750777482986, -0.04207318276166916, -0.022881677374243736, -0.0036674351431429386, 0.0012944844784215093, 0.00626614922657609, -0.0070749991573393345, 0.040773823857307434, -0.011090012267231941, 0.046465009450912476, 0.013188473880290985, 0.02051684819161892, -0.04048796370625496, 0.009751674719154835, 0.011096509173512459, -0.04467189684510231, -0.02155633270740509, 0.046465009450912476, -0.02004907839000225, -0.008614737540483475, -0.02158232033252716, 0.0393965058028698, -0.030716801062226295, 0.00027489522472023964, 0.010823643766343594, 0.012493317946791649, 0.006756656803190708, -0.022998619824647903, -0.016332918778061867, 0.03396519273519516, -0.0356023833155632, -0.057483553886413574, 0.03853892907500267, 0.014643753878772259, -0.049895308911800385, -0.010589759796857834, -0.022530851885676384, -0.009076008573174477, -0.0007783960900269449, -0.009810145944356918, -0.04423011466860771, -0.005106473341584206, 0.018697747960686684, -0.009790655225515366, -0.005899081006646156, 0.006305130198597908, 0.002194289118051529, 0.018671760335564613, -0.016722725704312325, -0.005216918420046568, -0.013422357849776745, -0.0011523673310875893, -0.008829130791127682, -0.022257985547184944, -0.019633285701274872, 0.005593731999397278, 0.007789645344018936, 0.010005049407482147, 0.003251641057431698, -0.0033247298561036587, 0.008764163590967655, -0.010830140672624111, 0.01494260597974062, 0.019022587686777115, -0.040877774357795715, -0.02503860928118229, -0.030560877174139023, 0.03466684743762016, 0.043866295367479324, 0.0023664541076868773, -0.006925573106855154, -0.02301161363720894, 0.00475239846855402, 0.047322582453489304, 0.045919276773929596, 0.016306931152939796, -0.010024539195001125, -0.027754265815019608, -0.006493536755442619, 0.007321876939386129, -0.0022072826977819204, -0.03048291616141796, 0.02514255791902542, 0.03240596503019333, 0.002915432443842292, 0.005717170890420675, -0.002956037176772952, 0.00506099546328187, -0.008744672872126102, 0.04100770875811577, -0.0003733621269930154, -0.006145958788692951, 0.011544787324965, -0.03799320012331009, 0.010804153978824615, 0.01546234916895628, -0.04152745008468628, -0.036849766969680786, -0.034692831337451935, -0.01911354251205921, 0.038331031799316406, 0.0065942369401454926, 0.028299996629357338, 0.02796216309070587, 0.016852660104632378, 0.013942101038992405, 0.05025913193821907, 0.02744241990149021, -0.028196047991514206, 0.004128707107156515, -0.02936546877026558, -0.0064805434085428715, 0.01242185290902853, 0.013539300300180912, 0.003810364520177245, -0.006522772368043661, 0.008478304371237755, 0.0070944894105196, -0.02848190627992153, 0.01472171489149332, 0.0009063015459105372, 0.0033685830421745777, 0.02481772005558014, 0.016384892165660858, -0.004047497175633907, -0.016125021502375603, -0.022582825273275375, 0.015280438587069511, -0.02632497437298298, 0.028170060366392136, 0.052468039095401764, 0.009063015691936016, -0.013799171894788742, 0.01442286279052496, -0.006100481376051903, 0.017684249207377434, -0.02375224605202675, -0.012097014114260674, -0.016774699091911316, 0.007263405714184046, -0.031184569001197815, -0.012909112498164177, -0.007575251627713442, -0.010466321371495724, 0.019022587686777115, 0.0227387472987175, -0.009706197306513786, 0.014890631660819054, -0.0005887711304239929, -0.03464085981249809, -0.004781634081155062, 0.015358400531113148, -0.022219005972146988, 0.01012199092656374, -0.013682229444384575, -0.02481772005558014, -0.0021975375711917877, -0.008432826958596706, -0.010186959058046341, -0.005259147845208645, 0.009946578182280064, -0.003677180502563715, 0.016748711466789246, -0.004801124334335327, 0.022154036909341812, 4.2305237002437934e-05, 0.07084094732999802, 0.01038186252117157, -0.00950479693710804, -0.012961086817085743, 0.014539805240929127, 0.03087272308766842, -0.030820749700069427, -0.007900090888142586, -0.04976537451148033, -0.00607449421659112, -0.0031200810335576534, 0.025350455194711685, -0.023700272664427757, 0.0003887919883709401, 0.00014719278260599822, -0.009511293843388557, -0.014474837109446526, -0.004684182349592447, 0.006623472552746534, 0.01055727619677782, 0.019269464537501335, 0.010277913883328438, -0.023024607449769974, 0.01871074177324772, -0.005164944101125002, -0.019243476912379265, -0.028170060366392136, 0.034225065261125565, -0.0019019339233636856, 0.004635456018149853, 0.0024947654455900192, -0.022803716361522675, -0.03050890378654003, -0.004131955560296774, 0.02558434009552002, -0.01003753300756216, -0.006750159896910191, 0.008315885439515114, 0.01233739499002695, 0.019347425550222397, 0.016086040064692497, 0.007932574488222599, 0.0038493452593684196, 0.016073046252131462, 0.0007641843403689563, 0.0003065670607611537, 0.010849631391465664, 0.03136647865176201, 0.011908607557415962, 0.01421496644616127, -0.015605278313159943, -0.017762210220098495, 0.02284269593656063, -0.016436867415905, 0.008328878320753574, -0.01848985068500042, -0.01474770251661539, 0.02993718534708023, 0.02632497437298298, -0.0031931698322296143, -0.013448345474898815, 0.014734708704054356, -0.015605278313159943, 0.02002309262752533, 0.02941744402050972, -0.012850641272962093, 0.02298562601208687, 0.02892368845641613, -0.008881105110049248, 0.05867896229028702, -0.02566230110824108, 0.00047913790331222117, 0.010011546313762665, 0.008101491257548332, 0.006938566453754902, -0.0027367707807570696, 0.005700929090380669, 0.03248392418026924, -0.02405109815299511, 0.05241606384515762, -0.02081570029258728, 0.006730669643729925, -0.011895613744854927, 0.012857138179242611, 0.028248021379113197, 0.017957113683223724, 0.03461487218737602, 0.0032971184700727463, -0.029105598106980324, 0.017892146483063698, -0.023999124765396118, 0.02147837169468403, 0.03651193156838417, 0.012551789171993732, -0.018411889672279358, -0.027182549238204956, 0.02632497437298298, -0.009296899661421776, 0.00773767102509737, 0.02034793049097061, -0.006201181560754776, -0.00562296761199832, 0.03336748853325844, 0.008361362852156162, -0.03087272308766842, 0.030638838186860085, -0.02010105364024639, -0.03700568899512291, 0.005294879898428917, 0.026454908773303032, 0.025675294920802116, -0.0006029828800819814, 0.015449355356395245, -0.006795637309551239, -0.00512921204790473, 0.0034790285862982273, -0.0369277261197567, 0.01933443360030651, 0.009296899661421776, -0.033159591257572174, 0.016904635354876518, -0.004820614587515593, 0.008419834077358246, 0.00997256487607956, 0.0044502979144454, -0.006782643962651491, -0.01665775664150715, -0.015046554617583752, 0.0012936723651364446, 0.014201972633600235, -0.042333051562309265, 0.020412899553775787, 0.011486316099762917, 0.020360924303531647, 0.024440905079245567, -0.007321876939386129, -0.009037028066813946, 0.011278418824076653, -0.01782717928290367, 0.003959790803492069, -0.01846386305987835, -0.0198281891644001, -0.004908321425318718, 0.011044534854590893, -0.025272494181990623, -0.0011864753905683756, -0.012350388802587986, -0.025948159396648407, 0.027572356164455414, 0.005925068166106939, -0.0235313568264246, 0.02894967421889305, 0.008536775596439838, 0.011096509173512459, 0.021842190995812416, -0.02086767368018627, -0.005028511863201857, -0.007627225946635008, 0.022556837648153305, 0.020230989903211594, 0.03160036355257034, -0.04254094883799553, -0.008699195459485054, 0.010199952870607376, 0.02358333021402359, 0.007224425207823515, -0.014734708704054356, -0.001280678785406053, -0.005977042485028505, -0.0353425107896328, -0.009953075088560581, 0.025402430444955826, 0.013851146213710308, -0.034225065261125565, -0.02731248550117016, -0.03508263826370239, 0.003677180502563715, 0.004703672602772713, -0.026363953948020935, 0.02897566184401512, -0.012415356934070587, -0.009329383261501789, 0.04298273101449013, -0.006217423360794783, -0.009179957211017609, -0.003251641057431698, 0.0070490119978785515, 0.008926582522690296, -0.009257919155061245, 0.0089005958288908, -0.003417308907955885, -0.03204214572906494, 0.004154694266617298, 0.003810364520177245, 0.017138520255684853, -0.003495270386338234, 0.002405434614047408, -0.007497290149331093, -0.002554860897362232, 0.043320562690496445, -0.022725755348801613, 0.001906806486658752, 0.016371898353099823, 0.030560877174139023, -0.02051684819161892, 0.02004907839000225, 0.00011003929830621928, -0.01774921640753746, -0.0037226579152047634, -0.002202410250902176, 0.0012100262101739645, 0.0054053254425525665, -0.011856633238494396, 0.03336748853325844, -0.0019376662094146013, -0.004859595559537411, 0.009868617169559002, -0.018749721348285675, 0.0017752465792000294, -0.0027254014275968075, -0.013877132907509804, 0.004135204013437033, 0.003326354082673788, 0.02566230110824108, -0.0364859439432621, 0.03710963577032089, 0.013981081545352936, -0.000607043388299644, 0.019126536324620247, 0.024090079590678215, 0.011531793512403965, -0.025051603093743324, -0.00773767102509737, -0.026234019547700882, -0.00913447979837656, 0.024661796167492867, 0.009621738456189632, -0.014526811428368092, -0.01873672939836979, 0.013136499561369419, -0.03095068410038948, 0.008419834077358246, 0.0004474660672713071, -0.008504291996359825, 0.0023161040153354406, 0.07037317752838135, -0.025350455194711685, 0.020412899553775787, -0.028040124103426933, 0.0025727269239723682, 0.032691821455955505, 0.046984750777482986, 0.0040085166692733765, -0.03180826082825661, 0.003985777497291565, -0.00562296761199832, 0.01819099858403206, -0.04215114191174507, 0.029703302308917046, 0.05163644999265671, -0.026272999122738838, -0.014305921271443367, 0.009706197306513786, -0.0039565423503518105, -0.008829130791127682, 0.014916619285941124, -0.03162635117769241, 0.013864140026271343, -0.017489345744252205, -0.024142052978277206, 0.003732403041794896, -0.014098023995757103, 0.006093984469771385, -0.015124515630304813, -0.00950479693710804, 0.027546368539333344, 0.008744672872126102, 0.017359409481287003, 0.035186588764190674, -0.019399400800466537, 0.04805022478103638, -0.0157741941511631, 0.001495072734542191, 0.011336890049278736, 0.009420338086783886, -0.02681872993707657, -0.033783283084630966, -0.015293432399630547, 0.0007613420020788908, 0.021712256595492363, -0.027468407526612282, 0.0026782997883856297, 0.03656390681862831, -0.04025408253073692, -0.019490355625748634, -0.015527316369116306, 0.01797010749578476, -0.03898071125149727, 0.0062986332923173904, 0.020010098814964294, -0.012909112498164177, -0.007399838417768478, 0.011934594251215458, 0.0065325177274644375, 0.05670394003391266, 0.045321572571992874, -0.017684249207377434, 0.005460547748953104, -0.01305204164236784, 0.007562257815152407, 0.03812313452363014, -0.005691183730959892, 0.025233514606952667, 0.010251927189528942, -0.02887171320617199, 0.024973642081022263, -0.015384387224912643, -0.0008795022731646895, -0.016008079051971436, 0.012727201916277409, -0.01075217965990305, 0.005340357311069965, 0.02227097935974598, 0.02333645336329937, 0.03568034619092941, 0.0022787475027143955, -0.019438382238149643, 0.0033750799484550953, -0.007432322483509779, -0.008017033338546753, 0.016138015314936638, 0.0009111741092056036, -0.00512921204790473, 0.003777880687266588, -0.005158447660505772, -0.015683239325881004, 0.00626614922657609, 0.021023597568273544, 0.015384387224912643, -0.020711751654744148, 0.009101996198296547, 0.02393415756523609, -0.01782717928290367, -0.01871074177324772, -0.030119096860289574, 0.010843134485185146, -0.009595751762390137, 0.017593294382095337, -0.0032126603182405233, 0.021322449669241905, 0.05122065544128418, 0.032250043004751205, 0.0033945702016353607, -0.009810145944356918, 0.03341946378350258, 0.02234894037246704, 0.012402363121509552, -0.008952570147812366, -0.02610408328473568, -0.006042010150849819, -0.03752543032169342, 0.009303396567702293, 0.019737234339118004, 0.0041222102008759975, 0.010167469270527363, -0.015410374850034714, -0.005545006133615971, -0.015553303994238377, -0.005626216065138578, -0.02254384383559227, 0.015111522749066353, 0.04781633988022804, 0.01520247757434845, -0.0017427626298740506, -0.020451879128813744, -0.036252062767744064, -0.03391321748495102, -0.011115999892354012, 0.01742437854409218, 0.003976032603532076, 0.017710236832499504, -0.032717809081077576, 0.009693203493952751, -0.01320146769285202, 0.005385834723711014, 0.015592284500598907, -0.014994580298662186, 0.030093109235167503, -0.004570488352328539]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
")corresponds to our final twist. As in Eq. (46), the gap in this optimization is the mode-
seeking KL divergence DKL 
qξ(s1:T)σ(s1:T)
.
Notably, this objective does not make use of exact target samples from σ(s1:T)when they are available. Further, the
mode-seeking behavior has been shown to reduce diversity of fine-tuned models (Stiennon et al., 2020; Go et al., 2023). To
combat this, Go et al. (2023) derive policy gradient methods to optimize arbitrary f-divergences Df 
qξ(s1:T)σ(s1:T)
between the learned variational policy qξand target σ.
E.3. Policy Gradient with Mass-Covering / Maximum Likelihood KL Divergence
We focus on the case of minimizing the mass-covering KLdivergence DKL 
σ(s1:T)qξ(s1:T)
to train qξ, which constitutes
the distributional policy gradients ( DPG) method for language model finetuning (Parshakova et al., 2019; Khalifa et al., 2020;
Korbak et al., 2022a; Go et al., 2023) and has been used to learn SMC proposals in state-space models in (Gu et al., 2015).
In particular, the gradient of DKL 
σ(s1:T)qξ(s1:T)
=Eσ(s1:T)[logσ(s1:T)−logqξ(s1:T)]is
∇ξDKL 
σ(s1:T)qξ(s1:T)
=−Eσ(s1:T)
∇ξlogqξ(s1:T)
=−Eqξ(s1:T)σ(s1:T)
qξ(s1:T)∇ξlogqξ(s1:T)
=−Eqξ(s1:T)1
Zσ˜σ(s1:T)
qξ(s1:T)∇ξlogqξ(s1:T) (63)
We recognize the importance weights w(s1:T) =˜σ(s1:T)
qξ(s1:T)from Eq. (3). Go et al. (2023) consider estimating Eq. (63) using
a moving average estimate of the partition function ˆZσ
∇ξDKL 
σ(s1:T)qξ(s1:T)
≈KX
k=11
ˆZσw(s(k)
1:T)∇ξlogqξ(s(k)
1:T), (DPG (general ˆZσ))
Alternatively, the expectation may thus be estimated using SISwith the variational policy qξ(s1:T). Using self-normalized
importance sampling (SNIS) to estimate Eq. (63) as in Eq. (5) corresponds to ˆZσ=PK
j=1w(s(k)
1:T), with
∇ξDKL 
σ(s1:T)qξ(s1:T)
≈KX
k=1w(s(k)
1:T)
PK
j=1w(s(j)
1:T)∇ξlogqξ(s(k)
1:T). (64)
We use this gradient for DPG proposal learning in the main text experiments, although we use the parameterization described
in Eq. (DPG) below.
DPG as Sequential Maximum Likelihood Objective We now show Eq. (64) is equivalent to a sequential maximum
likelihood EBM objective. Consider minimizing the KL divergence,
DKL 
σ(s1:T)qξ(s1:T)
=TX
t=1Eσ(s1:t−1)DKL
σ(st|s1:t−1)qξ
t(st|s1:t−1)
(EBM proposal learning)
where qξ
t(st|s1:t−1) =p0(st|s1:t−1)ψξ
t(s1:t)P
stp0(st|s1:t−1)ψξ
t(s1:t). (65)
While this is reminscent of the twist-induced proposal in Prop. 3.3, we emphasize distinctions between energy-based
learning of the proposal (DPG) versus energy-based learning of twist functions (CTL) in","[0.03404540196061134, 0.019934987649321556, 0.014406797476112843, -0.006681506521999836, -0.0195612870156765, 0.04889032989740372, -0.006166057661175728, 0.021751943975687027, -0.043787386268377304, 0.023427153006196022, 0.0384267158806324, -0.01144296582788229, -0.012989312410354614, -0.007538440637290478, 0.037318501621484756, 0.0009294188348576427, 0.028427008539438248, -0.022769955918192863, -0.01111436728388071, 0.040462739765644073, -0.030694983899593353, -0.04048851132392883, -0.007454679813235998, 0.05247269943356514, 0.00397217832505703, -0.04481828212738037, 0.04889032989740372, 0.019303562119603157, 0.013027971610426903, -0.02191946469247341, 0.047756344079971313, -0.025501836091279984, -0.022190075367689133, -0.06154460087418556, 0.012789576314389706, 0.03466394171118736, -0.012847564183175564, 0.07097731530666351, -0.03108157031238079, 0.0195612870156765, 0.004049495793879032, -0.04747284576296806, -0.06149305775761604, 0.03713809326291084, -0.0004385342763271183, 0.04796252027153969, 0.005131938494741917, 0.016082005575299263, 0.012080834247171879, 0.004258896689862013, -0.010418510995805264, 0.03355572372674942, -0.01587582752108574, -0.0007180042448453605, -0.002812418155372143, -0.0032102803234010935, 0.011378535069525242, -0.015785623341798782, 0.03651955723762512, -0.03242173790931702, 0.023040566593408585, -0.03322068229317665, 0.023968374356627464, 0.01952262781560421, 0.03358149901032448, -0.020501980558037758, -0.06066833809018135, 0.05146757513284683, -0.024007033556699753, 0.051338713616132736, -0.008202080614864826, 0.001433592289686203, 0.01222902536392212, -0.02292459085583687, -0.00572470435872674, 0.0228730458766222, 0.008098991587758064, 0.017860304564237595, -0.0009527751244604588, -0.025179680436849594, 0.020978771150112152, -0.002659394172951579, 0.01617220975458622, -0.0007985431584529579, -0.018362868577241898, -0.0774204283952713, -0.02871050499379635, 0.003054034896194935, -0.05608084425330162, -0.0005275297444313765, -0.023285405710339546, -0.023568902164697647, -0.022976135835051537, -0.00808610487729311, 0.054173681885004044, 0.0295609962195158, 0.014097527600824833, 0.0012233857996761799, 0.028813594952225685, 0.01976746693253517, 0.000939083518460393, -0.01704847253859043, 0.019638603553175926, 0.0024483823217451572, 0.07195667177438736, -0.025256996974349022, -0.024625571444630623, 0.031545475125312805, -0.022447800263762474, -0.01947108283638954, -0.0395607054233551, 0.0019039394101127982, -0.000653573137242347, 0.0548953115940094, 0.032756779342889786, -0.0681423470377922, -0.036081425845623016, -0.0011066043516620994, -0.023375608026981354, -0.003772441763430834, -0.03726695850491524, -0.012763803824782372, 0.00294128037057817, 0.007995901629328728, 0.002177771646529436, -0.024290530011057854, 0.026726026087999344, -0.045307960361242294, -0.044096656143665314, 0.011082151904702187, -0.009761313907802105, 0.02014116570353508, 0.016816521063447, -0.035205163061618805, -0.0009028409840539098, -0.0021133406553417444, -0.014368138276040554, 0.024934841319918633, -0.006079075857996941, 0.013015084899961948, 0.006971446797251701, -0.022331824526190758, -0.03963802382349968, 0.028478553518652916, -0.02288593165576458, 0.010115684941411018, -0.020682387053966522, 0.037086550146341324, -0.013079516589641571, 0.01650725118815899, -0.010895301587879658, -0.03894216567277908, -0.04971504956483841, 0.02775692380964756, 0.0046615912579, -0.05917353555560112, 0.0013707720208913088, 0.06010134518146515, 0.03234441950917244, -0.031571246683597565, -0.0084082605317235, 0.046519264578819275, 0.012106606736779213, -0.013710941188037395, 0.0021809933241456747, -0.0031442383769899607, -0.026597164571285248, 0.03592678904533386, -0.04118436947464943, -0.03783395141363144, 0.0015374874928966165, -0.03412272036075592, -0.026468301191926003, -0.0060500819236040115, 0.011629816144704819, -0.040720466524362564, -0.004516621120274067, -0.08365736156702042, -0.008524236269295216, -0.01834998093545437, -0.019097382202744484, 0.03417426347732544, -0.011687804013490677, 0.0005371944280341268, 0.0014794995076954365, 0.03852980583906174, -0.0055636269971728325, 0.019316447898745537, -0.0009398888796567917, -0.0008778739138506353, 0.0009326403960585594, 0.042782261967659, 0.06917324662208557, -0.05283351615071297, -0.032164011150598526, -0.006436668336391449, 0.05736946314573288, 0.06979178637266159, 0.04077200964093208, 0.014883587136864662, 0.010360523127019405, 0.009580906480550766, 0.025759559124708176, -0.08082239329814911, -0.027653833851218224, 0.02101743035018444, 0.022344710305333138, 2.9900063964305446e-05, -0.06633827835321426, -0.030901161953806877, -0.006375459022819996, 0.0034341784194111824, 0.02559203840792179, 0.026146147400140762, -0.02101743035018444, 0.025450291112065315, -0.06314249336719513, 0.0062820338644087315, -0.0019442088669165969, 0.07468854635953903, 0.011069265194237232, -0.0026336219161748886, -0.003092693630605936, 0.01510265376418829, -0.0481429286301136, -0.019728807732462883, 0.011984187178313732, -0.045874953269958496, 0.023659106343984604, -0.022653980180621147, 0.043787386268377304, 0.009664666838943958, -0.021494219079613686, -0.03074652887880802, 0.036777280271053314, -0.031210431829094887, -0.016043348237872124, -0.0067717102356255054, -0.0003102760820183903, -0.06154460087418556, -0.005847123917192221, 0.021726172417402267, -0.007209841627627611, -0.03559174761176109, 0.004887099843472242, 0.018414413556456566, -0.022718410938978195, -0.015618102625012398, -0.004268561489880085, 0.014484114944934845, -0.0065236506052315235, 0.01587582752108574, -0.013749600388109684, -0.05247269943356514, -0.05948280543088913, 0.0044103097170591354, 0.0231565423309803, 0.033117592334747314, -0.052008796483278275, 0.01524440199136734, 0.010244547389447689, -0.026133259758353233, 0.002346903318539262, 0.02716415748000145, -0.008240739814937115, 0.0030975257977843285, -0.03211246803402901, -0.020849909633398056, 0.023981260135769844, 0.013350127264857292, 0.009406942874193192, -0.023981260135769844, -0.03688037022948265, 0.04731821268796921, -0.0023018016945570707, -0.02992180921137333, 0.013324354775249958, 0.03499898314476013, -0.008453362621366978, 0.01734485663473606, -0.022086985409259796, -0.029792947694659233, 0.05391595885157585, -0.021777717396616936, 0.011720019392669201, 0.012899109162390232, -0.02045043557882309, 0.04115859791636467, -0.03883907571434975, -0.06381257623434067, 0.009432715363800526, -0.013775371946394444, 0.04048851132392883, -0.04115859791636467, 0.013504761271178722, 0.026313668116927147, 0.002638454083353281, -0.03639069199562073, -0.006617075297981501, 0.015618102625012398, 0.017499491572380066, -0.019999418407678604, -0.0322413295507431, 0.012641385197639465, -0.015424808487296104, 0.00795724242925644, 0.033117592334747314, 0.016030460596084595, -0.017757214605808258, -0.0036178070586174726, -0.01038629561662674, -0.012467420659959316, -0.022151418030261993, 0.009303852915763855, -0.020308688282966614, -0.013337240554392338, 0.027602288872003555, 0.02899400144815445, -0.01858193427324295, -0.040076155215501785, -0.02963831275701523, -0.017538148909807205, -0.02840123511850834, -0.015759849920868874, -0.004941866733133793, -0.02837546356022358, -0.03669996187090874, 0.004188022576272488, -0.01612066477537155, -0.012415875680744648, 0.009638894349336624, -0.01706136018037796, 0.011468738317489624, 0.013040857389569283, -0.01833709515631199, -0.01646859385073185, -0.011030606925487518, 0.07721424847841263, -0.0029606097377836704, 0.00794435665011406, -0.0901004746556282, 0.008910823613405228, -0.006095183547586203, -0.04365852475166321, -0.00441353116184473, 0.014419683255255222, 0.012622055597603321, 0.03304027393460274, 0.062111593782901764, 0.04760170727968216, -0.014290821738541126, -0.040385421365499496, 0.026378098875284195, 0.05618393048644066, 0.022769955918192863, 0.00011627802450675517, -0.01355630625039339, -0.049895454198122025, -0.043194618076086044, -0.011951971799135208, -0.02197100967168808, -0.020914340391755104, 0.03595256060361862, 0.01737062819302082, -0.010811541229486465, -0.0002601406304165721, 0.012467420659959316, -0.021120520308613777, 0.024767320603132248, -0.003569483757019043, -0.02135247178375721, 0.006033973768353462, -0.02626212313771248, 0.006130620371550322, -0.045333731919527054, -0.025476062670350075, 0.018517501652240753, 0.03695768862962723, 0.042782261967659, 0.021855033934116364, 0.01922624558210373, 0.030591893941164017, -0.02078547701239586, -0.0204117763787508, 0.008492020890116692, 0.020205598324537277, 0.005441207438707352, -0.016533024609088898, -0.0395607054233551, 0.02404569275677204, 0.02680334448814392, -0.00899458397179842, -0.018195345997810364, 0.022641094401478767, -0.01313750445842743, 0.011958414688706398, 0.0015785623108968139, 0.049534641206264496, 0.05151911824941635, 0.04901919141411781, -0.04525641351938248, -0.01537326443940401, -0.05002431944012642, -0.03378767520189285, -0.06767844408750534, -0.020682387053966522, -0.015605215914547443, 0.025785332545638084, 0.03198360651731491, 0.013801144436001778, 0.07216285169124603, 0.0010719726560637355, 0.031906288117170334, -0.011404307559132576, 0.01825977861881256, -0.05669938027858734, 0.030102217569947243, 0.011236786842346191, 0.06608054786920547, 0.056544747203588486, 0.0013868797104805708, 0.010734223760664463, -0.004355543293058872, 0.010412068106234074, -0.00048121990403160453, -0.003221555845811963, 0.02654561959207058, 0.019703034311532974, 0.04780788719654083, -0.02868473157286644, -0.005660273600369692, 0.0231565423309803, 0.04149363934993744, -0.020527753978967667, -0.034947436302900314, -0.005995315033942461, 0.012448091059923172, 0.01978035271167755, 0.017267538234591484, -0.027911558747291565, -0.01652013696730137, -0.01511553954333067, -0.01920047216117382, 0.010540930554270744, -0.020888566970825195, 0.05314278230071068, -0.004513399675488472, -0.023723537102341652, 0.009658223949372768, -0.015167084522545338, -0.009497146122157574, 0.02377508208155632, 0.05427677184343338, -0.014432569965720177, -0.03108157031238079, -0.03693191334605217, 0.07772969454526901, -0.02809196524322033, 0.0444832406938076, -0.04084932804107666, 0.04084932804107666, 0.022331824526190758, -0.021842148154973984, -0.004568166099488735, -0.005202812608331442, -5.549632987822406e-06, 0.035514429211616516, -0.001728364615701139, -0.0385555773973465, 0.03804013133049011, -0.02046332135796547, -0.007802607957273722, -0.009729098528623581, -0.041364774107933044, -0.027653833851218224, 0.030643438920378685, 0.06412184238433838, -0.004568166099488735, 0.02899400144815445, -0.032447509467601776, 0.03262791782617569, -0.013221264816820621, 0.011797336861491203, 0.024277644231915474, 0.025785332545638084, 0.06989487260580063, 0.026365213096141815, -0.03203514963388443, -0.03195783123373985, 0.0053864410147070885, 0.006594524718821049, -0.04948309808969498, 0.01765412464737892, -0.014020211063325405, 0.012905552051961422, 0.0036757951602339745, -0.007660859730094671, 0.015038222074508667, -0.02891668491065502, -0.012525408528745174, 0.023568902164697647, -0.0009568020468577743, -0.0010921073844656348, 0.03144238516688347, 0.05275619775056839, 0.03819476440548897, 0.009819301776587963, -0.006874800194054842, 0.0035630406346172094, 0.037653543055057526, -0.01798916794359684, -0.033375319093465805, -0.0243549607694149, 0.016855180263519287, 0.012164594605565071, 0.01613355055451393, -0.03383922204375267, 0.004703471437096596, -0.0024177776649594307, 0.031571246683597565, -0.030256852507591248, -0.01985766924917698, -0.04275648668408394, -0.005921219475567341, -0.016017574816942215, -0.0022679753601551056, -0.020798364654183388, -0.14164535701274872, -0.024290530011057854, -0.04783365875482559, 0.02193235233426094, -0.027885787189006805, 0.013633623719215393, 0.013208379037678242, -0.03046303056180477, 0.005402549169957638, -0.036803051829338074, -0.006269147619605064, -0.0237879678606987, -0.004593938589096069, -0.011513840407133102, -0.004693806637078524, -0.0027608731761574745, 0.02989603765308857, 0.036803051829338074, -0.04203486070036888, 0.019638603553175926, -0.005518524907529354, -0.009368283674120903, 0.0025852983817458153, 0.014149072580039501, -0.0034341784194111824, -0.02564358338713646, -0.0359010174870491, -0.02927749790251255, 0.01795050874352455, -0.015308832749724388, 0.03819476440548897, 0.00794435665011406, 0.03355572372674942, 0.007474009413272142, 0.0010035146260634065, 0.00472924392670393, -0.0053832195699214935, -0.02837546356022358, 0.005863231606781483, 0.0439162477850914, -0.015218629501760006, 0.025785332545638084, 0.041003961116075516, -0.03961224853992462, 0.03203514963388443, 0.017267538234591484, -0.00808610487729311, 0.018079370260238647, -0.01673920452594757, 0.03481857478618622, -0.012196809984743595, 0.006791039370000362, -0.04484405741095543, -0.023246746510267258, -0.019058723002672195, 0.01249963603913784, -0.02438073419034481, -0.0464419461786747, 0.008769074454903603, -0.007345146965235472, -0.0060371956788003445, -0.041287459433078766, 0.025527607649564743, 0.0031522922217845917, -0.035514429211616516, -0.02284727431833744, 0.00205696327611804, -0.027937332168221474, -0.01130766049027443, -0.005238249432295561, 0.008337385952472687, -0.029792947694659233, -0.010141457431018353, 0.004726022481918335, 0.010115684941411018, -0.01702270098030567, -0.028220828622579575, -0.021223608404397964, 0.048065610229969025, -0.027705378830432892, -0.007912141270935535, 0.02045043557882309, -0.0024467715993523598, 0.013440330512821674, -0.0033600826282054186, -0.007216284982860088, 0.0008819008944556117, -0.013195492327213287, -0.053864412009716034, 0.0037305615842342377, -0.018775226548314095, 0.07422464340925217, -0.01680363528430462, 0.03909679874777794, -0.03502475470304489, 0.025553381070494652, -0.028272373601794243, 0.0011025774292647839, 0.01420061755925417, 0.004532728809863329, -0.019148927181959152, 0.0021342807449400425, 0.006861913949251175, -0.020321574062108994, 0.013478989712893963, -0.017125790938735008, 0.027241475880146027, 0.012789576314389706, -0.019703034311532974, -0.01734485663473606, -0.016726316884160042, 0.01130121760070324, -0.03894216567277908, -0.00959379319101572, 0.011417193338274956, -0.008105434477329254, -0.03760199993848801, 0.024561140686273575, -0.02042466402053833, -0.03358149901032448, 0.024251870810985565, -0.006178943905979395, -0.037962812930345535, -0.027009522542357445, -0.028117738664150238, 0.033401090651750565, -0.005753698758780956, 0.039148345589637756, 0.004052717238664627, -0.012538295239210129, 0.0006777347880415618, -0.007983014918863773, -0.013234150595963001, -0.005241471342742443, 0.01019300241023302, -0.0031845078337937593, -0.0015399036929011345, 0.016313958913087845, 0.04943155124783516, 0.023298291489481926, 0.04842642694711685, -0.013453217223286629, -0.0070487638004124165, -0.026171918958425522, 0.05767873302102089, 0.023104997351765633, -0.03017953410744667, 0.0034986096434295177, 0.0013288917252793908, -0.01947108283638954, -0.03669996187090874, 0.0009592182468622923, 0.009220092557370663, -0.018955634906888008, -0.0009165325900539756, -0.027834242209792137, -0.010296092368662357, -0.017821647226810455, -0.026468301191926003, -0.004378094337880611, -0.0013820474268868566, -0.013582078740000725, 0.001961927395313978, 0.00201991549693048, -0.005460537038743496, -0.0017154784873127937, -0.0340711735188961, -0.0022164303809404373, 0.010231660678982735, 0.006233710329979658, 0.057524099946022034, -0.012512522749602795, -0.06458575278520584, 0.002182604046538472, 0.02868473157286644, -0.057472553104162216, 0.008704643696546555, -0.03505052626132965, -0.004284669179469347, -0.03177742660045624, 0.02193235233426094, 0.030643438920378685, -0.014703180640935898, -0.015167084522545338, -0.0005307513056322932, -0.02840123511850834, -0.024483824148774147, -0.0032779329922050238, -0.001328086364082992, 0.003195783356204629, 0.037962812930345535, 0.02039889059960842, -0.008163422346115112, -0.007641530130058527, -0.03265368938446045, -0.07216285169124603, -0.007332260720431805, -0.01926490291953087, -0.033968083560466766, -0.05937971547245979, 0.015553670935332775, -0.015630988404154778, -0.01711290329694748, 0.003540489822626114, 0.0402565598487854, 0.022731296718120575, -0.015592330135405064, 0.003540489822626114, 0.020991656929254532, 0.023955488577485085, 0.01557944342494011, -0.03108157031238079, -2.3117179807741195e-05, 0.036107197403907776, 0.0028655738569796085, -0.040127698332071304, 0.012332115322351456, 0.04262762516736984, 0.022782841697335243, 0.02775692380964756, 0.034638166427612305, 0.01980612426996231, -0.0018169574905186892, -0.01680363528430462, 0.010296092368662357, -0.02503793127834797, 0.013968666084110737, 0.02319520153105259, 0.017525263130664825, 0.043787386268377304, -0.01327280979603529, -0.007190512493252754, -0.015734078362584114, 0.014716066420078278, -0.016043348237872124, -0.0274476557970047, 0.0322413295507431, -0.02078547701239586, -0.02073393203318119, -0.029432132840156555, -0.016726316884160042, -0.0016341342125087976, 0.011030606925487518, -0.0034889448434114456, 0.03749890998005867, -0.03020530752837658, 0.02166174165904522, 0.05084903538227081, 0.014303707517683506, 0.0021294483449310064, -0.021764829754829407, -0.004690585192292929, 0.01649436540901661, 0.0025852983817458153, -0.010579588823020458, 0.008762631565332413, -0.041364774107933044, -0.014844928868114948, -0.030669210478663445, 0.02314365655183792, -0.029174409806728363, 0.0019603166729211807, -0.02534720115363598, -0.020257143303751945, 0.015295946970582008, -0.009084787219762802, 0.03999883681535721, -0.00641411729156971, 0.02626212313771248, -0.016726316884160042, -0.11319258064031601, -0.011681361123919487, 0.010946846567094326, 0.017860304564237595, 0.034947436302900314, -0.033993855118751526, 0.019947873428463936, -0.0316743366420269, 0.008388930931687355, -0.02534720115363598, -0.008260068483650684, -0.011533170007169247, 0.04430283606052399, 0.020373119041323662, 0.036158740520477295, -0.05453449487686157, -0.019161812961101532, -0.011404307559132576, 0.006288476753979921, -0.017254652455449104, -0.00927808042615652, 0.00023899917141534388, -0.0015793676720932126, 0.03747313469648361, -0.03383922204375267, -0.01793762296438217, 0.03136506676673889, 0.0011541222920641303, 0.039122574031353, 0.019651489332318306, 0.012183924205601215, -0.010502271354198456, 0.032138239592313766, 0.024767320603132248, -0.021906578913331032, 0.018736567348241806, 0.005112608894705772, 0.00525435758754611, -0.008717529475688934, -0.002427442232146859, 0.018788112327456474, -0.04695739597082138, 0.05819418281316757, 0.003013765439391136, 0.013427444733679295, -0.014406797476112843, 0.04525641351938248, -0.020592184737324715, 0.015592330135405064, -0.023581787943840027, 0.02382662706077099, -0.009961050003767014, -0.003946405835449696, -0.042833805084228516, 0.012763803824782372, 0.0027415440417826176, 0.00305725634098053, -0.0005347782280296087, 0.001365134259685874, 0.013775371946394444, -0.0060371956788003445, 0.02225450798869133, 0.03922566398978233, -0.02409723773598671, -0.060513705015182495, -0.020965885370969772, 0.005267243832349777, 0.017911849543452263, -0.009026799350976944, -0.0034889448434114456, 0.02130092680454254, -0.001425538444891572, 0.0018089035293087363, 0.013814031146466732, -0.025205451995134354, -0.004977303557097912, -0.010457170195877552, 0.037627771496772766, -0.03788549453020096, 0.013298582285642624, 0.015643874183297157, -0.00927808042615652, 0.011732906103134155, 0.022653980180621147, 0.013156834058463573, 0.028143510222434998, -0.01175867859274149, -0.0237879678606987, -0.03896793723106384, 0.0295609962195158, 0.04236990213394165, -0.02596573904156685, 0.008189194835722446, -0.02804042212665081, -0.004075267817825079, -0.027988877147436142, -0.025759559124708176, 0.02109474688768387, 0.01340167224407196, 0.006778153125196695, 0.02556626684963703, 0.038916394114494324, -0.030411485582590103, -0.008182751946151257, 0.010534487664699554, 0.004239567555487156, -0.01387846190482378, 0.011990630067884922, 0.015051108784973621, 0.0003141016932204366, 0.014226390048861504, 0.027241475880146027, -0.030669210478663445, 0.010263876989483833, -0.013375899754464626, 0.035849470645189285, 0.04657081142067909, 0.01706136018037796, 0.016030460596084595, -0.021197836846113205, 0.0210432019084692, 0.02170039899647236, -0.02863318659365177, 0.04303998500108719, -0.0077446200884878635, -0.026700254529714584, -0.011153025552630424, 0.020540639758110046, -0.02376219443976879, -0.017267538234591484, 0.010624690912663937, -0.01887831650674343, 0.028452780097723007, 0.0068168118596076965, 0.004342657048255205, 0.016069119796156883, 0.023942602798342705, 0.028143510222434998, -0.019045837223529816, 0.025153907015919685, 0.003174843266606331, 0.0021793823689222336, 0.017512377351522446, 0.04443169757723808, 0.018234005197882652, 0.0014561432180926204, 0.005953434854745865, -0.030694983899593353, -0.013852689415216446, -0.0147804981097579, 0.03932875394821167, -0.009265194647014141, -0.018156688660383224, -0.014058869332075119, 0.010180116631090641, 0.025076590478420258, 0.03623605892062187, -0.008382488042116165, 0.016649000346660614, -0.0043458784930408, 0.03365881368517876, 0.006636404898017645, 0.01235788781195879, -0.01176512148231268, -0.0007643140852451324, -0.007338704075664282, -0.008434033021330833, -0.010109242051839828, -0.019922100007534027, 0.017602581530809402, 0.0027528193313628435, -0.039766885340213776, 0.008582224138081074, 0.018839657306671143, 0.031597018241882324, 0.03200937807559967, 0.0036274718586355448, 0.02283438667654991, 0.0004610851756297052, 0.016082005575299263, 0.007564213126897812, 0.018427299335598946, -0.032138239592313766, -0.01856904663145542, 0.03922566398978233, -0.0252698827534914, -0.009838631376624107, -0.0025869093369692564, 0.0025691906921565533, 0.014213504269719124, 0.034921664744615555, 0.03231864795088768, -0.0007014937582425773, 0.002722214674577117, 0.0195612870156765, 0.0377308614552021, -0.016636114567518234, 0.026957979425787926, 0.015630988404154778, -0.02626212313771248, -0.04267917200922966, 0.006385123357176781, -0.0171000175178051, -0.015283060260117054, -0.04394201934337616, 0.025385858491063118, -0.013388785533607006, -0.0030814181081950665, 0.02109474688768387, -0.0030363162513822317, -0.0004888710682280362, -0.027293020859360695, 0.007828380912542343, 0.015630988404154778, -0.01587582752108574, -0.044354379177093506, 0.0277311522513628, 0.0323701910674572, -0.03265368938446045, -0.01646859385073185, -0.008421146310865879, -0.033684585243463516, 0.017924735322594643, -0.011249672621488571, -0.042498763650655746, -0.011462295427918434, 0.024187440052628517, -0.018659250810742378, 0.017125790938735008, -0.0070616500452160835, -0.010025481693446636, 0.01856904663145542, -0.026159033179283142, 0.006881243083626032, 0.0027995319105684757, -0.02404569275677204, -0.019367992877960205, -0.007867039181292057, -0.026300780475139618, 0.02194523811340332, 0.012009959667921066, 0.015154197812080383, 0.014045982621610165, -0.022705525159835815, 0.01642993465065956, -0.006088740192353725, 0.021146291866898537, 0.037627771496772766, -0.03404540196061134, -0.03974111005663872, -0.037653543055057526, 0.04048851132392883, 0.023349836468696594, 0.012699373066425323, 0.011629816144704819, -0.002238981192931533, -0.0007977377390488982, 0.04584918171167374, 0.04373583942651749, -0.021416902542114258, -0.0030636994633823633, -0.019574172794818878, -0.006188608705997467, -0.04059160128235817, 0.010702008381485939, -0.01675209030508995, 0.01834998093545437, 0.01019300241023302, 0.013749600388109684, -0.002530531957745552, 0.014303707517683506, 0.026468301191926003, -0.0034470646642148495, 0.020837021991610527, -0.0016591012245044112, -0.00473568681627512, 0.022383369505405426, -0.0360298790037632, 0.02198389731347561, 0.016661886125802994, -0.020270029082894325, -0.028246600180864334, -0.031261976808309555, -0.012879779562354088, 0.03667419031262398, 0.0037595555186271667, 0.007428907789289951, 0.023556016385555267, 0.007783278822898865, -0.0007196150254458189, 0.0329371877014637, 0.05551384761929512, -0.03193205967545509, 0.0069327880628407, 0.007093865890055895, -0.023272518068552017, -0.00762220099568367, 0.031854745000600815, -0.02262820675969124, -0.007635087240487337, 0.007325817830860615, 0.01248030737042427, -0.0009777421364560723, 0.021545764058828354, 0.025372972711920738, 0.01798916794359684, 0.031184660270810127, 0.01613355055451393, -0.022022554650902748, -0.03285986930131912, -0.006694392766803503, -0.013124617747962475, -0.01202284637838602, 0.03404540196061134, 0.032731007784605026, 0.0017525263829156756, -0.012854007072746754, 0.025372972711920738, 0.011455852538347244, 0.015038222074508667, -0.0065880813635885715, -0.004030166193842888, 0.003479280276224017, 0.008253625594079494, -0.011513840407133102, -0.021739058196544647, -0.003113633720204234, -0.006352907977998257, 0.020579298958182335, -0.0015866161556914449, 0.005547518841922283, 0.022125644609332085, 0.026390984654426575, -0.0365968719124794, -0.026777571067214012, 0.020811250433325768, -0.031184660270810127, 0.019690148532390594, -0.0446121022105217, -0.022048328071832657, 0.002780202543362975, 0.004123591352254152, -0.015592330135405064, -0.02106897532939911, -0.022061213850975037, -0.008962367661297321, 0.007583542261272669, -0.0010719726560637355, 0.030411485582590103, 0.0012660714564844966, 0.08293572813272476, 0.0005915581714361906, -0.017757214605808258, 0.015334605239331722, 0.013453217223286629, 0.03267946094274521, -0.015785623341798782, -0.015953144058585167, -0.048941876739263535, 0.0038465375546365976, -0.026622936129570007, 0.02865896001458168, -0.013839803636074066, 0.032189786434173584, 0.035230934619903564, 8.451550093013793e-05, -0.018517501652240753, 0.01447122823446989, 0.012287013232707977, 0.02496061474084854, 0.02286016009747982, -0.007989457808434963, -0.038864847272634506, 0.016687659546732903, -0.022641094401478767, -0.012531851418316364, -0.019587058573961258, 0.0022889154497534037, -0.0036661303602159023, -0.0021954902913421392, -0.010534487664699554, -0.0017090353649109602, -0.024483824148774147, 0.020231369882822037, 0.025076590478420258, -0.005834237672388554, -0.023594673722982407, 0.003113633720204234, 0.008176308125257492, 0.013839803636074066, 0.0015616491436958313, -0.0013369456864893436, -0.005431543104350567, 0.006075853947550058, 0.011500953696668148, -0.0017187000485137105, 0.024522481486201286, 0.011339875869452953, 0.002884903224185109, 0.021236496046185493, -0.013053744100034237, -0.03662264719605446, 0.0034728371538221836, -0.014587204903364182, 0.004642261657863855, -0.015450580976903439, -0.006745937746018171, 0.021494219079613686, 0.009722655639052391, 0.015347491949796677, -0.012428762391209602, 0.04401933774352074, -0.001128349918872118, 0.017898963764309883, 0.026017284020781517, -0.021236496046185493, 0.0032843761146068573, 0.02868473157286644, -0.0063464646227657795, 0.052343837916851044, -0.03322068229317665, -0.003066921140998602, -0.0017589693889021873, -0.01831132359802723, -0.009310295805335045, -0.00978064350783825, -0.012770246714353561, 0.01734485663473606, -0.018234005197882652, 0.047704797238111496, -0.029122864827513695, 0.011217457242310047, 0.008839949034154415, 0.007422464434057474, 0.011546055786311626, 0.024870410561561584, 0.015502125956118107, -0.0426533967256546, -0.029045546427369118, 0.034251581877470016, -0.015669647604227066, 0.01926490291953087, 0.007899254560470581, 0.014677408151328564, -0.008434033021330833, -0.03440621495246887, 0.023375608026981354, -0.010341193526983261, 0.002730268519371748, 0.04332348331809044, -0.02376219443976879, 0.002917118836194277, 0.0360298790037632, 0.00037289506872184575, 0.005589399021118879, 0.0235044714063406, -0.026017284020781517, -0.023104997351765633, 0.014123300090432167, 0.010321864858269691, 0.02989603765308857, -0.011455852538347244, 0.011056379415094852, -0.0013119785580784082, -0.013478989712893963, 0.0009801583364605904, -0.03409694507718086, 0.037653543055057526, 0.003182897111400962, -0.01949685625731945, 0.015347491949796677, 0.0015173527644947171, 0.00634002173319459, -0.005512082017958164, 0.014368138276040554, -0.014986677095293999, -0.03200937807559967, 0.0052608004771173, -0.013775371946394444, 0.03499898314476013, -0.028865139931440353, 0.021558651700615883, 0.009555133990943432, -0.0017509155441075563, 0.04270494356751442, -0.006642847787588835, 0.0012523798504844308, -0.014239276759326458, -0.014754725620150566, -0.014097527600824833, -0.010289649479091167, -0.008028117008507252, 0.0008335775346495211, 0.02529565617442131, -0.010141457431018353, -0.005811686627566814, -0.012518965639173985, -0.027215702459216118, 0.010779325850307941, -0.0021632746793329716, -0.008762631565332413, 0.02408435009419918, 0.002720603719353676, 0.016545910388231277, 0.0070165484212338924, -0.0204117763787508, 0.007474009413272142, -0.008369602262973785, 0.017873192206025124, 0.01652013696730137, 0.03136506676673889, -0.018813885748386383, -0.004101040307432413, 0.013930006884038448, 0.0274476557970047, -0.005988872144371271, -0.028581643477082253, -0.01387846190482378, -0.005396105814725161, -0.01445834245532751, -0.014832043088972569, 0.030127989128232002, 0.013150390237569809, -0.014999563805758953, -0.04180290922522545, -0.02101743035018444, -0.007022991310805082, 0.009548691101372242, -0.04234413057565689, 0.032138239592313766, 0.009626008570194244, -0.0030862505082041025, 0.05115830525755882, -0.006417339202016592, -0.016623226925730705, -0.0018234006129205227, 0.02253800444304943, 0.008253625594079494, 0.013968666084110737, -1.5679916032240726e-05, 0.016984041780233383, -0.026146147400140762, 0.028143510222434998, -0.0027946995105594397, 0.0147804981097579, 0.006900572218000889, 0.00403983099386096, 0.0062981415539979935, 0.00046148785622790456, 0.03499898314476013, -0.0015326550928875804, 0.006043638568371534, 0.02261532098054886, 0.025527607649564743, -0.01675209030508995, 0.018994292244315147, -0.007377362810075283, -0.012750918045639992, -0.004313663113862276, -0.019690148532390594, 0.011616930365562439, -0.015927372500300407, -0.008704643696546555, 0.03953493386507034, 0.01646859385073185, -0.006810368970036507, 0.022138530388474464, 0.0024000590201467276, -0.00900102686136961, -0.029432132840156555, -0.011500953696668148, -0.01676497608423233, 0.004626153968274593, 0.005528189707547426, -0.030669210478663445, 0.017138676717877388, 0.024548254907131195, 0.041364774107933044, 0.013363013043999672, 0.01733197085559368, 0.007860596291720867, -0.0027415440417826176, -0.004629375413060188, -0.022125644609332085, 0.0048613278195261955, 0.011397864669561386, 0.0003994729195255786, -0.026983750984072685, -0.021442675963044167, -0.001362718059681356, -0.03744736313819885, 0.022744184359908104, 0.011655588634312153, -0.04239567369222641, -0.0015576222212985158, 0.06994641572237015, -0.009503589011728764, 0.019599944353103638, -0.014986677095293999, 0.014290821738541126, 0.024032805114984512, 0.03515361621975899, -0.003659687237814069, -0.014548545703291893, 0.007222727872431278, 0.008762631565332413, 0.013685168698430061, -0.03198360651731491, 0.013324354775249958, 0.03989574685692787, -0.04935423284769058, -0.014587204903364182, 0.0032054479233920574, -0.013994438573718071, -0.016391275450587273, 0.02078547701239586, -0.021713286638259888, 0.01537326443940401, -0.026468301191926003, -0.029019774869084358, -0.004133256152272224, 0.008852834813296795, 0.023865284398198128, -0.011713576503098011, 0.010611804202198982, 0.039148345589637756, 0.027524972334504128, 0.020489094778895378, 0.013259923085570335, 0.01051515806466341, 0.06041061505675316, -0.028220828622579575, -0.011178798042237759, -0.0011984187876805663, -0.011384977959096432, -0.031210431829094887, -0.054689131677150726, -0.01465163566172123, -0.024896182119846344, 0.012448091059923172, -0.020244255661964417, -0.0070165484212338924, 0.027653833851218224, -0.04657081142067909, -0.04886455833911896, -0.003511495655402541, 0.014497000724077225, -0.04765325412154198, 0.014509887434542179, 0.027988877147436142, -0.029767174273729324, -0.014316593296825886, -0.000361015583621338, -0.01673920452594757, 0.03198360651731491, 0.03389076516032219, -0.0018169574905186892, 0.00973554141819477, -0.014819156378507614, 0.02255089022219181, 0.022035440430045128, -0.013363013043999672, 0.02896822988986969, 0.02200966887176037, -0.027499200776219368, 0.0070616500452160835, -0.01827266439795494, 0.007899254560470581, -0.026004398241639137, 0.024535369127988815, -0.02191946469247341, 0.0147804981097579, 4.819749392481754e-06, -0.01019944529980421, 0.03876175731420517, -0.013208379037678242, -0.009754871018230915, -0.003145849099382758, 0.001420706044882536, -0.0026287895161658525, 0.014226390048861504, -0.0058567882515490055, 0.016043348237872124, -0.005389662925153971, 0.007596428506076336, 0.011507397517561913, -0.0018958855653181672, 0.03484434634447098, 0.013053744100034237, -0.01703558675944805, -0.013440330512821674, 0.0019748136401176453, -0.01493513211607933, -0.02927749790251255, -0.025450291112065315, 0.010875971987843513, -0.00959379319101572, 0.013195492327213287, 0.01947108283638954, 0.00839537475258112, 0.015167084522545338, 0.008620883338153362, 0.0016848737141117454, -0.03206092119216919, 0.033143363893032074, 0.026700254529714584, -0.002106897532939911, -0.003823986742645502, -0.0002587311901152134, 0.012725145556032658, -0.043168846517801285, 0.020321574062108994, 0.01646859385073185, 0.0186463650316, 0.013311468064785004, -0.00795724242925644, -0.015746964141726494, -0.013801144436001778, -0.013182606548070908, -0.011835996061563492, 0.008711086586117744, 0.04566877335309982, 0.01313750445842743, 0.012518965639173985, -0.01143008004873991, -0.02778269723057747, -0.014754725620150566, -0.017576808109879494, 0.03953493386507034, -0.0008690146496519446, 0.01466452144086361, -0.03713809326291084, 0.0021085082553327084, -0.008266512304544449, -0.001265265978872776, 0.02502504549920559, 0.004026944749057293, 0.032164011150598526, 0.00807321909815073]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" App. E.3.1.
The gradient of Eq. (EBM proposal learning) becomes
∇ξDKL
σ(s1:T)qξ(s1:T)
=TX
t=1Eσ(s1:t−1)h
Eσ(st|s1:t−1)
∇ξlogψξ
t(s1:t)
−Eqξ
t(st|s1:t−1)
∇ξlogψξ
t(s1:t)i
. (66)
33
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Starting from Eq. (64), we now seek to recover Eq. (66). Using Eq. (65), we can write
logqξ(s(k)
1:T) =TX
t=1 
logp0(s(k)
t|s(k)
1:t−1) + log ψξ
t(s(k)
1:t)−logX
stp0(st|s(k)
1:t−1)ψξ
t(st,s(k)
1:t−1)
∇ξlogqξ(s(k)
1:T) =TX
t=1
∇ξlogψξ
t(s(k)
1:t)−Eqξ
t(st|s(k)
1:t−1)h
∇ξlogψξ
t(st,s(k)
1:t−1)i
Substituting into Eq. (64), we recover
∇ξDKL 
σ(s1:T)qξ(s1:T)
≈KX
k=1w(s(k)
1:T)
PK
j=1w(s(k)
1:T)TX
t=1
∇ξlogψξ
t(s(k)
1:t)−Eqξ
t(st|s(k)
1:t−1)h
∇ξlogψξ
t(st,s(k)
1:t−1)i
(DPG)
which is an SNIS estimate of the maximum likelihood EBM gradient in Eq. (66), as desired. Note that the expectation over
qξ
t(st|s(k)
1:t−1)can be calculated exactly.
Comparison with CTL Objective The gradient in Eq. (DPG) above appears similar to our CTL objective and gradient in
Sec. 4.1. However, the DPG loss in Eq. (EBM proposal learning) is a single (joint) KL divergence over the entire sequence,
whereas CTL optimizes Tseparate KL divergences for each intermediate marginal.
For the DPG gradient in Eq. (66), negative sampling is performed using a ‘positive’ prefix s(k)
1:t−1∼σ(s1:t−1)and an exact
‘negative’ sample from the one-step-ahead qξ
t(st|s(k)
1:t−1)(Eq. (65), which we have assumed to be tractable). In practice, we
obtain the prefixes using the truncation of exact samples or approximate positive sampling with the final target weights as in
Eq. (DPG). By contrast, the CTL gradient in Eq. (22) involves approximate negative sampling under each πt(s1:t).
E.3.1. N AIVE USE OF PROPOSAL LEARNING TO DEFINE TWISTED SMC T ARGETS
While we have shown in Prop. 3.3 how one-step proposals {qπ
t(st|s1:t−1)}T
t=1can be induced from a given set of twist
functions {ψt(s1:t)}T
t=1or target distributions {πt(s1:t)}T
t=1, we now emphasize that moving the other direction (inducing
intermediate twisting targets from a proposal learning scheme parameterized by {ψξ
t}T
t=1) does not yield the correct
intermediate targets for resampling (App. A.1), even at optimality in the proposal learning objective.
We focus our arguments on learning with the EBM maximum likelihood objective in Eq. (EBM proposal learning) as an
example. The proposal energies ψξ
t(s1:t)appear to play a role analogous to the twist function ψt(s1:t)in the one-step
proposal induced from twist targets {πt}T
t=1in Sec. 3.
However, we proceed to show in Prop. E.2 that naive use of ψξ
tto define twisting targets","[0.03144897520542145, -0.011686595156788826, 0.04317439720034599, 0.0031351912766695023, -0.030517155304551125, 0.007642230484634638, 0.010444166138768196, 0.014507943764328957, -0.0528549887239933, 0.03926592320203781, 0.041207216680049896, -0.032406680285930634, -0.03248433396220207, 0.008994665928184986, 0.03817879781126976, -0.011485994793474674, 0.05117253214120865, -0.019063515588641167, -0.005846532993018627, 0.04402856528759003, 0.0013055207673460245, -0.023632029071450233, -0.0025414784904569387, 0.03610808402299881, 0.0014802373480051756, -0.05394211411476135, 0.05342443287372589, 0.01984003372490406, 0.010696534998714924, 0.003329320577904582, 0.025275658816099167, -0.02981828898191452, -0.020047103986144066, -0.05854945257306099, 0.004494097549468279, 0.05026659369468689, -0.00875523965805769, 0.062328506261110306, -0.035486869513988495, 0.0048791212029755116, 0.023955577984452248, -0.046254586428403854, -0.03960241377353668, 0.03654811158776283, -0.006962777581065893, 0.028524091467261314, 0.01201014406979084, 0.008011076599359512, 0.029119422659277916, 0.035564523190259933, -0.014495001174509525, 0.035978663712739944, -0.012061911635100842, -0.008062844164669514, -0.018170518800616264, -0.02224723808467388, 0.010457107797265053, -0.01924470253288746, -0.00022365334734786302, -0.013155507855117321, 0.03527979925274849, -0.025702742859721184, 0.010476521216332912, 0.007758708205074072, 0.006415979471057653, -0.015828024595975876, -0.036729298532009125, 0.022920221090316772, -0.037324629724025726, 0.025922756642103195, -0.0034781531430780888, -0.00430320343002677, 0.021690733730793, 0.0016444384818896651, -0.007894598878920078, 0.01980120688676834, 0.004562042653560638, 0.03691048547625542, 0.0010660943808034062, 0.003279170487076044, 0.02398146316409111, -0.019775323569774628, 0.03131955489516258, -0.03238079696893692, -0.011984259821474552, -0.04439094290137291, -0.020396538078784943, -0.015129157342016697, -0.06662523746490479, -0.020422421395778656, -0.042863789945840836, -0.011401872150599957, -0.018856443464756012, -0.0043452647514641285, 0.046435773372650146, 0.04480508342385292, -0.0025253009516745806, -0.016591599211096764, 0.03157839551568031, 0.028524091467261314, 0.005105605348944664, -0.03204430639743805, 0.023204945027828217, -0.014093800447881222, 0.08168968558311462, -0.03056892193853855, -0.028757046908140182, 0.029844172298908234, -0.025728628039360046, -0.015090331435203552, -0.01112361904233694, -0.006195966154336929, -0.01611274667084217, 0.03724697604775429, 0.056530505418777466, -0.05373504012823105, -0.030957181006669998, -0.005629755090922117, -0.022544903680682182, 0.009557642042636871, -0.026336900889873505, -0.00211277580820024, -0.0020351239945739508, 0.0015449471538886428, 0.03320908546447754, -0.010981258004903793, 0.029093539342284203, -0.04263083636760712, -0.03535744920372963, 0.007771650329232216, 0.014766782522201538, 0.01930941268801689, 0.011091264896094799, 0.0047497013583779335, -0.025922756642103195, 0.009195266291499138, -0.0015239164931699634, 0.041776664555072784, -0.0059953657910227776, 0.01511621568351984, 0.024576792493462563, -0.01549153309315443, -0.02380027435719967, 0.0027388434391468763, -0.02932649478316307, -0.024279126897454262, -0.006516279652714729, 0.03527979925274849, -0.011065380647778511, 0.03478800505399704, -0.03802349418401718, -0.027462851256132126, -0.06253557652235031, 0.017950506880879402, 0.006891596596688032, -0.058601219207048416, -0.03960241377353668, 0.055805753916502, 0.013563180342316628, -0.02255784533917904, 0.00984236504882574, 0.011777188628911972, 0.018571721389889717, -0.006891596596688032, -0.02013769932091236, 0.009687061421573162, -0.04048246890306473, 0.04387326166033745, -0.03711755573749542, -0.027126360684633255, -0.01453382708132267, -0.0640886127948761, -0.04387326166033745, -0.020085930824279785, -0.00047197731328196824, -0.012100737541913986, -0.0017471653409302235, -0.1001708135008812, -0.01905057393014431, -0.01091654784977436, -0.007415746338665485, 0.058911826461553574, 0.008515813387930393, -0.013116681948304176, -0.001028077444061637, 0.01776931807398796, -0.0068786549381911755, 0.039887137711048126, 0.00567505182698369, -0.0011372752487659454, -0.011272451840341091, 0.045426297932863235, 0.09369982779026031, -0.04107780009508133, -0.039809487760066986, -0.02096598409116268, 0.061914362013339996, 0.06010248884558678, 0.03406325355172157, 0.010211210697889328, 0.03380441293120384, 0.012268983758985996, -0.0036819891538470984, -0.04936065524816513, -0.01751047931611538, 0.00925997644662857, 0.013071385212242603, -0.00037915914435870945, -0.0569964163005352, 0.016397470608353615, 0.0077069406397640705, -0.02798052877187729, 0.01855877786874771, 0.021677792072296143, -0.021807212382555008, 0.009298802353441715, -0.05451155826449394, 0.012107208371162415, 0.010592998936772346, 0.0599471852183342, 0.02090127393603325, -0.02906765416264534, 0.023179059848189354, 0.038800012320280075, -0.056116361171007156, -0.013116681948304176, 0.015297403559088707, -0.017743434756994247, 0.01338199246674776, -0.02981828898191452, 0.030543038621544838, -0.0005496290978044271, -0.004743230529129505, -0.02116011455655098, 0.02116011455655098, -0.01859760470688343, -0.04858413711190224, -0.03455504775047302, -0.012100737541913986, -0.061086077243089676, 0.013291398994624615, 0.043614424765110016, -0.00025883931084536016, -0.05298440530896187, -0.01281901728361845, 0.029093539342284203, -0.030413618311285973, -0.0007312210509553552, 0.013809077441692352, 0.0485064871609211, -0.013168450444936752, 0.01991768553853035, -0.0006458849529735744, -0.01195190567523241, -0.05968834459781647, 0.0006895640981383622, 0.019814148545265198, 0.013925555162131786, -0.05373504012823105, 0.022428426891565323, 0.03794584423303604, -0.016462180763483047, -0.007719882298260927, 0.05399388074874878, -0.012547235935926437, -0.017303407192230225, -0.025353310629725456, -0.024279126897454262, 0.0548221655189991, -0.0032063720282167196, 0.017665782943367958, -0.00043234252370893955, -0.025029761716723442, 0.041440173983573914, 0.027100475504994392, -0.0321478433907032, -0.022454310208559036, 0.03613396733999252, 0.010243565775454044, 0.02469327114522457, -0.012508410029113293, -0.06931716948747635, 0.04167312756180763, -0.0335196927189827, -0.004151135683059692, 0.011104206554591656, -0.012081325054168701, 0.0455557182431221, -0.010470050387084484, -0.046539306640625, -0.002232489176094532, -0.017911680042743683, 0.028782932087779045, -0.028782932087779045, 0.02500387839972973, 0.004067012574523687, 0.015439764596521854, -0.034322094172239304, 0.010877721942961216, 0.028135832399129868, 0.03437386080622673, 0.0034749177284538746, -0.017303407192230225, 0.006755705922842026, -0.012476054951548576, 0.011621885001659393, 0.025288600474596024, 0.009732358157634735, -0.004513510502874851, 0.01041181106120348, -0.021975457668304443, -0.008664646185934544, -0.011363046243786812, 0.008858775720000267, -0.03196665644645691, -0.019645903259515762, 0.038308218121528625, -0.006166846491396427, -0.009958842769265175, -0.02966298535466194, -0.05559868365526199, -0.0009358659153804183, -0.0042870258912444115, -0.01171247847378254, -0.019076457247138023, -0.024421488866209984, -0.025547439232468605, 0.022726092487573624, -0.011531291529536247, -0.015879791229963303, -0.005687993951141834, -0.009162911213934422, 0.021380126476287842, 0.02646631933748722, -0.009279388934373856, -0.029688868671655655, -0.006435392424464226, 0.06786766648292542, 0.005409741774201393, 0.03137132525444031, -0.08370863646268845, 0.007713411469012499, 0.007344565354287624, -0.04392503201961517, 0.0095641128718853, 0.03359734266996384, 0.02048713155090809, 0.014818551018834114, 0.08629702776670456, 0.04845472052693367, -0.010664179921150208, -0.02179427072405815, 0.03031008318066597, 0.01310374028980732, 0.018209345638751984, -0.010437695309519768, -0.034115020185709, -0.031164253130555153, -0.02266138233244419, -0.00026369254919700325, -0.014689130708575249, -0.030103011056780815, 0.016242166981101036, 0.017898738384246826, -0.00860640686005354, 0.013213747180998325, 0.022842569276690483, -0.009473518468439579, 0.009046433493494987, -0.016733961179852486, -0.012378989718854427, -0.0034619758371263742, -0.030361851677298546, 0.02628513239324093, -0.042190808802843094, -0.013899670913815498, 0.0046202815137803555, 0.008198735304176807, 0.03634103760123253, 0.02518506534397602, 0.01859760470688343, -0.008612877689301968, -0.032769057899713516, -0.03328673541545868, -0.012508410029113293, 0.011188329197466373, 0.005798000376671553, -0.03139720857143402, -0.027876993641257286, 0.006859241984784603, 0.032018423080444336, -0.005299734883010387, -0.0481182262301445, 0.025236833840608597, -0.006891596596688032, 0.0031222491525113583, -0.012210744433104992, 0.05839414894580841, 0.051638443022966385, 0.05761763080954552, -0.09054198861122131, -0.006024484988301992, -0.037324629724025726, -0.03931768983602524, -0.0621214359998703, -0.017083395272493362, 0.0029054712504148483, 0.026686333119869232, 0.03900708258152008, 0.02202722616493702, 0.05373504012823105, -0.00669099623337388, 0.02273903414607048, 0.008684058673679829, 0.023140234872698784, -0.032510217279195786, 0.020771855488419533, 0.027436967939138412, 0.05756586417555809, 0.05741056054830551, -0.019710613414645195, -0.010858309455215931, 0.006600402295589447, 0.006312443874776363, -0.016319818794727325, -0.008599936030805111, 0.033260852098464966, 0.008768181316554546, 0.036806948482990265, -0.01717398874461651, -0.0007769223884679377, 0.056426968425512314, 0.015090331435203552, -0.018170518800616264, -0.04371795803308487, -0.020953042432665825, 0.021587198600172997, 0.0284982081502676, -0.006558340974152088, -0.05083604156970978, -0.006885125767439604, -0.01295490749180317, -0.00925997644662857, 0.0005213185795582831, -0.009596467949450016, 0.048247646540403366, -0.032018423080444336, -0.03662576153874397, 0.006296266335994005, -0.014145568013191223, 0.010838896036148071, 0.008224619552493095, 0.045012157410383224, -0.03463270142674446, -0.00633509224280715, -0.024499140679836273, 0.07910129427909851, -0.004752936773002148, 0.048558253794908524, -0.03157839551568031, 0.031914886087179184, 0.011874253861606121, -0.01498679630458355, 0.005671816412359476, -0.01776931807398796, 0.03799761086702347, 0.04646165668964386, 0.009706473909318447, -0.015646835789084435, -0.0034328564070165157, 0.0010321217123419046, -0.013822019100189209, 0.0061409627087414265, -0.025741569697856903, -0.005804471671581268, 0.06243204325437546, 0.07195732742547989, -0.022273123264312744, 0.018054042011499405, 0.0031400443986058235, 0.017562247812747955, 0.00032577355159446597, 0.0030073891393840313, 0.008748768828809261, 0.018403474241495132, 0.08370863646268845, 0.028213484212756157, -0.037324629724025726, 0.004837059415876865, 0.009027021005749702, 0.010010610334575176, -0.058187078684568405, 0.008580523543059826, -0.014391466043889523, 0.01483149267733097, -0.017264582216739655, 0.007914012297987938, 0.0036334567703306675, -0.028109949082136154, -0.0035266855265945196, 0.022234296426177025, -0.014223219826817513, -0.009382924996316433, 0.04123310372233391, 0.05414918437600136, 0.029274726286530495, 0.00037248595617711544, 0.0054615093395113945, -0.0013225071597844362, 0.04115545004606247, -0.011854840442538261, -0.012851371429860592, -0.020280059427022934, 0.010437695309519768, -0.009557642042636871, 0.006801003124564886, -0.06569341570138931, 0.0005229362868703902, 0.007435159292072058, 0.02526271715760231, -0.02021535113453865, -0.017821086570620537, -0.06005072221159935, -0.02285551093518734, 0.0068527706898748875, -0.032251376658678055, -0.03204430639743805, -0.12072265148162842, -0.03442562744021416, -0.019400006160140038, 0.023657912388443947, -0.017225755378603935, -0.00016925664385780692, 0.017859913408756256, -0.005616812966763973, 0.007079255301505327, -0.04982656612992287, -0.0023554377257823944, -0.02123776637017727, 0.008088728412985802, -0.003351969178766012, 0.001586199621669948, -0.012113680131733418, 0.015387997031211853, 0.023256711661815643, -0.023036697879433632, 0.008942898362874985, -0.0007207057205960155, 0.0068786549381911755, 0.0015134010463953018, 0.0018199639162048697, -0.015219751745462418, -0.028938235715031624, -0.03812703117728233, -0.017665782943367958, 0.00903996266424656, 0.008049902506172657, 0.009965313598513603, 0.022053109481930733, 0.012469584122300148, 0.03139720857143402, -0.005277086514979601, 0.009913546033203602, -0.0017665782943367958, 0.005002069752663374, 0.02873116359114647, 0.04330381751060486, -0.007363978307694197, -0.0117836594581604, 0.04050835222005844, -0.04987833648920059, 0.0066230506636202335, 0.006561576388776302, -0.022997872903943062, 0.003879354102537036, -0.022415485233068466, 0.016060980036854744, -0.03385618329048157, -0.014507943764328957, -0.03926592320203781, -0.03015477955341339, -0.02477092295885086, 0.023062583059072495, -0.02345084212720394, -0.042113155126571655, 0.007473985198885202, -0.007894598878920078, 0.0003069672384299338, -0.01829993911087513, 0.010715947486460209, 0.0003180892381351441, -0.0251462385058403, -0.008522284217178822, 0.00014044054842088372, -0.04842883348464966, -0.002609423827379942, -0.009324686601758003, 0.0075192819349467754, -0.030543038621544838, -0.02066831849515438, 0.02025417611002922, 0.011770717799663544, -0.003827586304396391, -0.042527299374341965, -0.011990731582045555, 0.05854945257306099, -0.05231142416596413, 0.008231090381741524, 0.023321421816945076, -0.010690063238143921, 0.024654444307088852, 0.045685138553380966, -0.023657912388443947, -0.013990264385938644, 0.0022308712359517813, -0.028964119032025337, 0.033907949924468994, -0.01780814491212368, 0.06460629403591156, -0.00578829413279891, 0.02823936939239502, -0.038877665996551514, 0.02480974793434143, -0.013187862932682037, -0.0029798876494169235, 0.0003085850039497018, 0.002721048193052411, -0.033416155725717545, 0.00222601811401546, 0.02262255549430847, -0.033493805676698685, -0.007985192351043224, 0.011168916709721088, 0.04066365584731102, 0.004232022911310196, -0.0057947649620473385, -0.017005743458867073, -0.023127293214201927, 0.004034657962620258, -0.02210487797856331, -0.0160739216953516, 0.0014155275421217084, -0.02240254171192646, -0.02323082834482193, 0.01127892266958952, -0.010159443132579327, -0.029999475926160812, 0.021380126476287842, -0.01593155972659588, -0.015362112782895565, -0.04107780009508133, -0.008612877689301968, 0.055288076400756836, -0.015375055372714996, 0.04405445232987404, -0.006801003124564886, -0.006839829031378031, -0.007137494161725044, 0.0003150559787172824, -0.0188305601477623, -0.020474189892411232, -0.00852875504642725, -0.004607339855283499, -0.0009868248598650098, 0.003685224801301956, 0.04480508342385292, 0.004002302885055542, 0.03038773499429226, -0.04123310372233391, -0.020047103986144066, -0.005975952837616205, 0.0477299690246582, 0.011718950234353542, -0.02409793995320797, -0.006354505196213722, -0.0035331565886735916, -0.018054042011499405, -0.04182843118906021, 0.02059066668152809, 0.006936893332749605, -0.0031319556292146444, -0.007506340276449919, -0.02417559176683426, -0.015219751745462418, -0.013407876715064049, -0.003914944361895323, 0.022946104407310486, -0.006432157009840012, -0.021690733730793, 0.028368787840008736, 0.006454805377870798, -0.0076487017795443535, 0.01076771505177021, -0.027514619752764702, -0.003384324023500085, -0.03553863614797592, -0.019412947818636894, 0.055288076400756836, -0.004118780605494976, -0.04345912113785744, -0.02135424315929413, 0.040637772530317307, -0.04027539864182472, -0.011311277747154236, -0.040456585586071014, -0.015750372782349586, -0.02955945022404194, 0.03227726370096207, 0.054873935878276825, -0.01773049309849739, -0.0075192819349467754, 0.0021871922072023153, -0.015866849571466446, -0.015336229465901852, -0.008949369192123413, 0.016099805012345314, 0.01470207329839468, 0.030517155304551125, 0.005959775298833847, -0.018092866986989975, -0.019645903259515762, -0.00377905392087996, -0.08293211460113525, -0.02429206855595112, 0.006729822140187025, -0.028187600895762444, -0.046073395758867264, 0.023049641400575638, -0.0007170657627284527, -0.02808406576514244, -0.008800536394119263, 0.03271728754043579, 0.022726092487573624, -0.004888827446848154, -0.017859913408756256, 0.04651342332363129, 0.020681260153651237, 0.019749440252780914, -0.029015887528657913, 0.002879587234929204, 0.030517155304551125, -0.017458710819482803, -0.05298440530896187, 0.03489153832197189, 0.0538385771214962, 0.026556912809610367, 0.013977322727441788, 0.03952476382255554, -0.004717346280813217, -0.012268983758985996, -0.03023243136703968, 0.010366514325141907, -0.02297198958694935, 0.014210278168320656, 0.0030073891393840313, 0.00818579364567995, 0.032665520906448364, 0.0054032704792916775, -0.008748768828809261, -0.02334730513393879, 0.01519386749714613, -0.01540093868970871, -0.0315525121986866, 0.017290465533733368, -0.003617279464378953, -0.012178389355540276, -0.03429620712995529, 0.003167546121403575, -0.0012125003850087523, 0.02458973415195942, -0.021289533004164696, 0.026440436020493507, -0.010521817952394485, 0.010644766502082348, 0.0633120983839035, 0.006891596596688032, 0.004406739491969347, -0.024266185238957405, -0.008418749086558819, 0.04441682621836662, 0.01976238191127777, -0.0007433541468344629, -0.016099805012345314, -0.027100475504994392, -0.032096073031425476, -0.022337833419442177, -0.021975457668304443, -0.005655638873577118, -0.014274988323450089, -0.02924884296953678, -0.0070145451463758945, 0.007163377944380045, -0.014093800447881222, 0.029041770845651627, 0.0022551375441253185, 0.01101361308246851, -0.012139563448727131, -0.1264171153306961, -0.03248433396220207, 0.021509546786546707, 0.012689596973359585, 0.045089807361364365, -0.04068953916430473, 0.021017752587795258, -0.022531962022185326, 0.004720582161098719, -0.01445617526769638, -0.004568513948470354, -0.012372518889605999, 0.04123310372233391, 0.0040702479891479015, 0.022467251867055893, -0.05596105754375458, -0.023321421816945076, -0.006454805377870798, -0.021095404401421547, -0.0017277523875236511, 0.006930422503501177, 0.009369983337819576, 0.004435858689248562, 0.04268260300159454, -0.0408189594745636, -0.013291398994624615, 0.006234792061150074, 0.01641041226685047, 0.02003416232764721, 0.012288396246731281, -0.010884192772209644, -0.009298802353441715, -0.005018247291445732, 0.028938235715031624, -0.020189465954899788, 0.005383857525885105, 0.0005071632913313806, -0.01498679630458355, -0.017523420974612236, 0.00222601811401546, 0.025702742859721184, -0.05207847058773041, 0.07263030856847763, 0.00939586665481329, 0.01686338149011135, -0.021108346059918404, 0.005192963872104883, -0.005775352008640766, 0.019335296005010605, -0.030827762559056282, 0.01274783629924059, 0.013064914382994175, -0.02273903414607048, -0.026971057057380676, -0.010120617225766182, 0.005882123485207558, 0.01172542106360197, -0.008308742195367813, 0.005435625556856394, 0.019192935898900032, 0.0024573556147515774, 0.008489929139614105, 0.052052587270736694, -0.027307547628879547, -0.06652170419692993, -0.01672101952135563, 0.007318681571632624, 0.01163482666015625, -0.017911680042743683, 0.008832891471683979, -0.0014284694334492087, 0.010165913961827755, -0.01445617526769638, 0.004073483869433403, -0.007920483127236366, -0.009628822095692158, -0.011181858368217945, 0.032096073031425476, -0.030284199863672256, 0.02537919394671917, 0.04105191305279732, -0.020202407613396645, 0.026738101616501808, 0.01317492127418518, 0.00567505182698369, 0.022907279431819916, -0.014896202832460403, -0.0010539613431319594, -0.00861934944987297, 0.02857585996389389, 0.028757046908140182, -0.017756376415491104, 0.01345964428037405, -0.029015887528657913, -0.006558340974152088, -0.013000204227864742, 0.00847051665186882, 0.026194538921117783, 0.027695806697010994, 0.004872649908065796, 0.027540503069758415, 0.048066459596157074, -0.020150640979409218, 0.0021289533469825983, -0.002268079435452819, -0.00333255622535944, -0.002776051638647914, 0.020098872482776642, -0.001439793617464602, -0.002106304978951812, 0.021638967096805573, -0.005513277370482683, -0.039783600717782974, -0.018623488023877144, -0.00861934944987297, 0.027644038200378418, 0.054200951009988785, 0.005613577552139759, 0.024408547207713127, -0.0009900603909045458, 0.012527822516858578, 0.00954469945281744, -0.04193196818232536, 0.0077392952516674995, -0.018015217036008835, -0.03603043407201767, 0.006014778278768063, -0.0007611493347212672, -0.028032297268509865, -0.020124755799770355, 0.025586266070604324, -0.018196403980255127, 0.02021535113453865, -0.013576122000813484, 0.0068786549381911755, 0.03310554847121239, 0.02224723808467388, 0.01244369987398386, -0.015155041590332985, 0.027359316125512123, -0.007525752764195204, 0.003052686108276248, 0.027540503069758415, 0.03064657375216484, 0.04268260300159454, -0.021755443885922432, -0.002491328399628401, -0.02857585996389389, -0.0003945277421735227, -0.009505873546004295, 0.04917946830391884, 0.015387997031211853, -0.03957653045654297, 0.015103274025022984, -0.008561110123991966, -0.005057073198258877, 0.023593204095959663, -0.007836360484361649, -0.016617484390735626, 0.0011291864793747663, 0.04648754000663757, 0.01540093868970871, 0.011466581374406815, -0.003054303815588355, -0.02402028813958168, -0.008412277325987816, -0.01652689091861248, -0.015608010813593864, -0.009531757794320583, 0.029197074472904205, 0.004219080787152052, -0.041880201548337936, 0.015167983248829842, 0.026738101616501808, 0.028757046908140182, 0.020383596420288086, -0.0077392952516674995, 0.026738101616501808, -0.0016072303988039494, 0.014339697547256947, -0.005448567681014538, 0.0238649845123291, -0.04382149502635002, -0.012773719616234303, 0.02899000234901905, -0.03163016214966774, -0.014236162416636944, -0.0006236409535631537, 0.017148103564977646, 0.012133092619478703, 0.0008420366211794317, 0.03869647532701492, 0.012327222153544426, 0.020888332277536392, 0.02145777828991413, 0.048066459596157074, -0.03173369914293289, 7.133247709134594e-05, 0.011000670492649078, -0.03851528838276863, -0.02891235053539276, 0.03248433396220207, -0.008302271366119385, -0.031914886087179184, -0.011673652566969395, 0.02062949351966381, -0.022829627618193626, 0.005785058718174696, 0.0014689130475744605, 0.0025641268584877253, 0.006305972579866648, 0.023619087412953377, -0.024745037779211998, 0.03173369914293289, -0.03489153832197189, -0.037221092730760574, 0.0362892709672451, 0.0011874253395944834, -0.013627889566123486, -0.00818579364567995, -0.023632029071450233, -0.031267788261175156, 0.003119013737887144, 0.01287725567817688, -0.043769728392362595, 0.007933424785733223, 0.03634103760123253, -0.004157606512308121, 0.012424287386238575, -0.010185327380895615, -0.033752646297216415, 0.014236162416636944, -0.028524091467261314, 0.005513277370482683, -2.4228269467130303e-05, 0.001726134680211544, -0.043277934193611145, -0.015530358999967575, -0.013278456404805183, -0.004888827446848154, -0.00408642552793026, 0.014766782522201538, 0.017044568434357643, -0.02134130150079727, 0.010625354014337063, 0.0033228497486561537, 0.015012680552899837, 0.035901013761758804, -0.03437386080622673, -0.04193196818232536, -0.042786139994859695, 0.02348966710269451, 0.03483977168798447, -0.013420818373560905, 0.025935698300600052, -0.007079255301505327, -0.004694697912782431, 0.06496866792440414, 0.04845472052693367, 0.004568513948470354, 0.007409275509417057, -0.01615157350897789, -0.012456641532480717, -0.013039030134677887, -0.0077392952516674995, -0.019568251445889473, 0.03090541437268257, 0.01483149267733097, 0.0014592065708711743, -0.0002820944064296782, -0.017626957967877388, 0.016889264807105064, -0.010301804170012474, 0.02906765416264534, 0.012268983758985996, -0.011065380647778511, 0.03178546577692032, -0.029999475926160812, -0.017484595999121666, 0.013446702621877193, 0.0016452473355457187, -0.051146648824214935, -0.027773458510637283, -0.031914886087179184, 0.060827236622571945, 0.014650304801762104, 0.03615985065698624, 0.010418281890451908, 0.01826111413538456, 0.010541231371462345, 0.04250141605734825, 0.0347103513777256, -0.03385618329048157, -0.014766782522201538, 0.014637363143265247, -0.02553449757397175, 0.00198659161105752, 0.02587099000811577, -0.008282857947051525, -0.01727752387523651, 0.005005305167287588, 0.02823936939239502, -0.017148103564977646, 0.027385199442505836, 0.023554377257823944, 0.0019655609503388405, 0.007169848773628473, 0.025469787418842316, -0.02334730513393879, -0.017005743458867073, -0.022881394252181053, -0.0030866588931530714, -0.0024897106923162937, 0.027281664311885834, 0.015724487602710724, 0.0015805375296622515, -0.019607078284025192, 0.017368117347359657, 0.017122220247983932, 0.006833357736468315, -0.020228292793035507, -0.01615157350897789, 0.002162925899028778, 0.015142099931836128, -0.01713516190648079, 0.004157606512308121, -0.022053109481930733, -0.018636429682374, -0.004610575269907713, 0.026453377678990364, -0.015582126565277576, 0.032432567328214645, 0.002947532571852207, -0.025366252288222313, -0.004342029336839914, 0.02127659134566784, -0.0046332236379384995, 0.008127554319798946, -0.02891235053539276, -0.0238649845123291, -0.0006191921420395374, 0.014973854646086693, -0.004015245009213686, 0.0011024937266483903, -0.002287492388859391, 0.008658175356686115, -0.002269697142764926, 0.018545836210250854, 0.021185997873544693, -0.007745766546577215, 0.07366567105054855, -0.017251640558242798, -0.015750372782349586, 0.009525286965072155, 0.03137132525444031, 0.04074130952358246, -0.010832425206899643, -0.007687527686357498, -0.04332970082759857, 0.006390095688402653, -0.024835631251335144, 0.021302474662661552, 0.00451998133212328, 0.012391932308673859, 0.024757979437708855, 0.0024217653553932905, -0.0353056825697422, -0.001779520302079618, 0.0010102821979671717, 0.012210744433104992, 0.010664179921150208, 0.012844900600612164, -0.04392503201961517, 0.029093539342284203, -0.026375725865364075, 0.0012270601000636816, -0.01908939890563488, 0.0024088232312351465, -0.011848369613289833, -0.008684058673679829, -0.021638967096805573, -0.016164515167474747, -0.033416155725717545, 0.011065380647778511, 0.04571102187037468, -0.015219751745462418, -0.04402856528759003, 0.013356108218431473, 0.002496181521564722, 0.009020550176501274, -0.0034199145156890154, 0.004940595477819443, -0.010625354014337063, -0.016423353925347328, -0.005940362345427275, 0.018274055793881416, 0.011583059094846249, 0.003109307261183858, -0.00888465903699398, -0.015129157342016697, -0.025133296847343445, -0.010424753651022911, 0.005979188252240419, -0.010832425206899643, 0.012320751324295998, -0.030931297689676285, -0.0006200010539032519, 0.0235673189163208, 0.03478800505399704, -0.011324220336973667, -0.01648806408047676, 0.030698342248797417, -0.024007346481084824, 0.033830296248197556, 0.03113836981356144, -0.017031626775860786, 0.035150378942489624, 0.0188305601477623, -0.005180021747946739, 0.05357973650097847, -0.031914886087179184, 0.0038049379363656044, 0.013770251534879208, -0.02352849394083023, 0.00033770440495572984, -0.007700469344854355, 0.0069821905344724655, 0.026453377678990364, -0.009577054530382156, 0.041362520307302475, -0.009201737120747566, 0.015504474751651287, 0.007778121158480644, 0.002004386857151985, 0.026000408455729485, 0.03344203904271126, 0.009712944738566875, -0.02725577913224697, -0.02571568638086319, 0.018507011234760284, -0.016164515167474747, 0.00875523965805769, 0.04164724424481392, -0.015310345217585564, -0.0002871498581953347, -0.03877412900328636, 0.02940414659678936, -0.017562247812747955, 0.002725901547819376, 0.027928762137889862, 0.011492465622723103, 0.003400501562282443, 0.04281202331185341, 0.010670650750398636, -0.021406011655926704, 0.01565977744758129, -0.019943568855524063, -0.022997872903943062, 0.021509546786546707, 0.042190808802843094, 0.017497537657618523, -0.0201118141412735, 0.007499868981540203, -0.004028186667710543, 0.003669047262519598, -0.003494330681860447, -0.03670341521501541, 0.020383596420288086, 0.010968315415084362, -0.008690529502928257, 0.015957443043589592, -0.008955840021371841, 0.02707459218800068, 0.007111609913408756, 0.019438832998275757, -0.0163715872913599, -0.020513014867901802, 0.0029087066650390625, -0.02224723808467388, 0.03903296962380409, -0.030103011056780815, 0.021470721811056137, 0.010340630076825619, 0.008787594735622406, 0.04167312756180763, 0.002824584022164345, -0.013757309876382351, 0.009797068312764168, -0.017989331856369972, -0.0011574970558285713, 0.017665782943367958, -0.020810680463910103, 0.0034134434536099434, 0.008121083490550518, -0.003678753739222884, 0.007719882298260927, -0.020940100774168968, -0.02206605114042759, -0.0023748506791889668, 0.012113680131733418, -0.006525986362248659, 0.006283324211835861, -0.014287929981946945, 0.0005993747618049383, 0.017665782943367958, 0.005144431255757809, 0.006749235093593597, -0.007079255301505327, 0.028368787840008736, 0.015802139416337013, 0.034322094172239304, -0.017821086570620537, -0.011693065986037254, 0.013097269460558891, 0.03745405003428459, -0.012547235935926437, -6.430539360735565e-05, -0.0036366924177855253, -0.007325152400881052, -0.021755443885922432, -0.01739400252699852, 0.03336438909173012, 0.0030170956160873175, -0.037272859364748, -0.03015477955341339, -0.01867525652050972, 0.03460681438446045, 0.022531962022185326, -0.008988195098936558, 0.019231760874390602, 0.009661177173256874, -0.020681260153651237, 0.046254586428403854, -0.003329320577904582, -0.027876993641257286, -0.008839362300932407, 0.019257644191384315, 0.01826111413538456, -0.003785524982959032, -0.006322150118649006, 0.002669280394911766, -0.0157762560993433, 0.01758813112974167, 0.00014458602527156472, 0.018727025017142296, -0.016850439831614494, -0.005063544027507305, -0.006293030921369791, 0.0015036945696920156, 0.03256198391318321, -0.007700469344854355, -0.00903996266424656, 0.030335966497659683, 0.02556038275361061, 0.008742297999560833, 0.019283529371023178, 0.007719882298260927, -0.01758813112974167, -0.02733343094587326, 0.009162911213934422, 0.013472585938870907, 0.008004605770111084, -0.0040961322374641895, 0.04480508342385292, 0.00637068273499608, 0.001326551428064704, 0.024369720369577408, -0.01743282750248909, -0.00854816846549511, -0.005027953535318375, -0.015051505528390408, 3.2860458304639906e-05, -0.004697933327406645, 0.018959980458021164, -0.023502608761191368, 0.02774757333099842, 0.0058206492103636265, 0.02090127393603325, 0.013498470187187195, 0.026492202654480934, 0.017342234030365944, -0.027048708871006966, -0.01462442148476839, -0.013317282311618328, 0.017148103564977646, -0.00622184993699193, 0.011395400390028954, -0.017665782943367958, -0.01289666909724474, -0.0026789868716150522, -0.03269140422344208, 0.022014282643795013, 0.012599003501236439, -0.019852975383400917, -0.00896231085062027, 0.05772116780281067, -0.0176528412848711, 0.009512344375252724, -0.021406011655926704, 0.01867525652050972, 0.011809543706476688, 0.01758813112974167, -0.004578220192342997, -0.0017827557167038321, 0.001301476382650435, 0.0011728656245395541, 0.028265252709388733, -0.027385199442505836, 0.04159547761082649, 0.016539832577109337, -0.028860583901405334, -0.016617484390735626, 0.012404873967170715, 0.025327427312731743, -0.004503804259002209, 0.02153543010354042, -0.008839362300932407, -0.001959090121090412, -0.013718483969569206, -0.04242376238107681, 0.002450884785503149, 0.001996298087760806, 0.015595068223774433, -0.01672101952135563, -0.009195266291499138, 0.034399744123220444, 0.01611274667084217, 0.01784696988761425, -0.00014347382239066064, -0.004976185970008373, 0.038567058742046356, -0.028782932087779045, 0.004895298276096582, -0.00824403204023838, -0.004613810684531927, -0.03403737023472786, -0.03693636879324913, -0.004733523819595575, -0.014857376925647259, 0.027385199442505836, -0.01035357266664505, -0.015556242316961288, 0.03773877024650574, -0.041776664555072784, -0.02733343094587326, -0.024033229798078537, 0.004361442290246487, -0.03320908546447754, 0.03015477955341339, -0.009376454167068005, 0.0014559711562469602, -0.018286997452378273, -0.0002794655738398433, -0.01999533735215664, 0.0353056825697422, 0.045918092131614685, -0.01916705071926117, 0.011240096762776375, -0.003102836199104786, -0.019865917041897774, 0.020396538078784943, -0.003292112611234188, -0.003546098480001092, -0.0017034861957654357, -0.038567058742046356, 0.02183309569954872, -0.030827762559056282, 0.0077651794999837875, -0.004261142108589411, 0.029274726286530495, -0.024680327624082565, 0.016876323148608208, 0.012152506038546562, 0.02798052877187729, 0.04804057627916336, -0.017070451751351357, -0.0029782699421048164, 0.006163611076772213, -0.01065770909190178, -0.008509342558681965, 0.02025417611002922, 0.0038534703198820353, 0.01668219454586506, 0.006568047683686018, -0.002835908206179738, 0.005387093406170607, 0.006480689160525799, 0.015167983248829842, 0.02334730513393879, -0.02891235053539276, -0.007480456028133631, 0.030827762559056282, -0.024874458089470863, -0.01833876594901085, -0.030335966497659683, -0.00578829413279891, -0.0034393274690955877, 0.013116681948304176, -0.018325822427868843, 0.01142775546759367, 0.02443443052470684, -0.0009326303843408823, -0.010806540958583355, -0.058601219207048416, 0.013194333761930466, 0.026738101616501808, 0.011473052203655243, -0.002261608373373747, -0.013977322727441788, -0.0018037864938378334, -0.027618154883384705, 0.016358643770217896, 0.027851110324263573, 0.0069563062861561775, 0.029792405664920807, -0.02330848015844822, -0.00510236993432045, -0.013679658062756062, -0.0013184627750888467, -0.015879791229963303, -0.00124970858450979, 0.04395091533660889, 0.011311277747154236, -0.0025867754593491554, -0.013524354435503483, -0.02469327114522457, -0.029300609603524208, -0.02007298916578293, 0.023554377257823944, -0.030775994062423706, 0.012139563448727131, -0.020758911967277527, 0.007066313177347183, -0.027229895815253258, 0.013168450444936752, 0.014352640137076378, -0.002733990317210555, 0.023049641400575638, 0.0011445550480857491]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" using11
πξ
t(s1:t) =(1
Zψ
tp0(s1:t)ψξ
t(s1:t) t̸=T
1
Zσp0(s1:T)ϕ(s1:T) t=T(67)
need not lead to an SMC procedure for which πξ
t(s1:t) =σ(s1:t), even if qξ
t(st|s1:t−1) =σ(st|s1:t−1)for all t. We thus
argue that ψξ
tlearned using Eq. (EBM proposal learning) should not be used as target twists in Eq. (67), since they do not
yield the optimal interemdiate target distributions at optimality (App. A.1).
We begin by showing a simple lemma for the one-step conditionals in Eq. (EBM proposal learning).
Lemma E.1. Any twist induced proposal qξ
t(st|s1:t−1)(induced by ψξ
t(s1:t)) is invariant to rescaling ψξ
t(s1:t)by an
arbitrary constant c(s1:t−1)with respect to s1:t−1,
ψξc
t(s1:t):=c(s1:t−1)ψξ
t(s1:t) (68)
Proof.
qξc
t(st|s1:t−1) =p0(st|s1:t−1)ψξc
t(s1:t)P
stp0(st|s1:t−1)ψξc
t(s1:t)=p0(st|s1:t−1)c(s1:t−1)ψξ
t(s1:t)P
stp0(st|s1:t−1)c(s1:t−1)ψξ
t(s1:t)=p0(st|s1:t−1)ψξ
t(s1:t)P
stp0(st|s1:t−1)ψξ
t(s1:t)=qξ
t(st|s1:t−1).
11We assume no intermediate potentials in this section, as in the main text.
34
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Proposition E.2. There exist {ψξ∗
t}T
t=1such that (i) qξ∗
t(st|s1:t−1) =σ(st|s1:t−1)and (ii) the SMC targets {πξ∗
t(s1:t)}T
t=1
induced by {ψξ∗
t}T
t=1via Eq. (67) are different from σ(s1:t).
Proof. To satisfy condition (i) of the current proposition, we define
ψξ∗
τ(s1:τ):=( P
sτ+1:Tp0(sτ+1:T|s1:τ)ϕ(s1:T)τ̸=t
c(s1:t−1)P
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T) τ=t(69)
which for all τ, yields optimal proposals: (i)qξ∗(sτ|s1:τ−1) =σ(sτ|s1:τ−1)∝p0(sτ|s1:τ−1)ψξ∗
τ(s1:τ)via Lemma E.1.
However, it is clear that c(s1:t−1)̸= 1can break the necessary condition for optimality of SMC sampling that πt(s1:t) =
σ(s1:t)(Prop. A.4). In particular, consider
πξ∗
t(s1:t) =1
Zψ
tp0(s1:t)ψξ∗
t(s1:t) =1
Zψ
tc(s1:t−1)p0(s1:t)X
st+1:Tp0(st+1:T|s1:t)ϕ(s1:T)
=1
Zψ
tc(s1:t−1)˜σ(s1:t)̸=σ(s1:t) (70)
forc(s1:t−1)̸= 1, which introduces an additional factor which depends on s1:t. Thus, the twist target πξ∗
t(s1:t)induced
fromψξ∗","[0.011333913542330265, -0.03645521402359009, 0.011579891666769981, 0.020876603201031685, -0.052878983318805695, 0.00784607045352459, 0.009359781630337238, 0.02401755377650261, -0.051264356821775436, 0.026161978021264076, 0.03347824886441231, -0.017912251874804497, -0.031157225370407104, 0.02341206930577755, 0.038120295852422714, -0.012046619318425655, 0.04525997117161751, -0.0023241776507347822, -0.02646471932530403, 0.03153565153479576, -0.004632587544620037, -0.01685265265405178, 0.009618374519050121, 0.027700917795300484, -0.0025086612440645695, -0.03471444547176361, 0.04379671439528465, 0.01589396968483925, 0.020132360979914665, 0.018164535984396935, 0.03764095529913902, -0.021494701504707336, -0.019980989396572113, -0.07321317493915558, -0.026363806799054146, 0.06746106594800949, -0.008880440145730972, 0.04596636816859245, -0.02009451761841774, 0.01747075282037258, 0.02273089811205864, -0.01705448143184185, -0.0531817264854908, 0.02747386135160923, 0.014039672911167145, 0.0320906825363636, -0.02565740793943405, 0.009908501990139484, 0.020536016672849655, 0.06841975450515747, -0.021545158699154854, 0.028735287487506866, -0.020750459283590317, -0.018706949427723885, -0.030349912121891975, -0.0319393090903759, 0.010015723295509815, -0.030072398483753204, 0.004273081198334694, -0.0035666823387145996, 0.04823693633079529, -0.018505120649933815, -0.008092048577964306, 0.003617139533162117, 0.0033932363148778677, -0.013963987119495869, -0.009151646867394447, 0.021343329921364784, -0.0458906814455986, 0.05747057497501373, -0.028129803016781807, 0.008073126897215843, 0.04013857990503311, 0.027019748464226723, -0.010097716003656387, 0.01900969259440899, 0.005247532855719328, 0.04818647727370262, 0.027700917795300484, -0.022440770640969276, 0.022150643169879913, -0.03279707953333855, 0.029517371207475662, -0.03289799392223358, -0.01935027725994587, -0.027650460600852966, -0.028609145432710648, -0.015717370435595512, -0.046395253390073776, -0.033806219696998596, -0.034134190529584885, 0.008817369118332863, -0.029517371207475662, -0.01928720623254776, 0.0534844696521759, 0.005991774145513773, 0.019198905676603317, -0.0018542964244261384, 0.004818647634238005, -0.006477423012256622, 0.02421938255429268, -0.04099635034799576, 0.015200184658169746, -0.02674223482608795, 0.0741214007139206, -0.026288120076060295, -0.020044060423970222, 0.02199927158653736, -0.04629433900117874, -0.009971573948860168, 0.015048814006149769, -0.02699451893568039, -0.007227971684187651, 0.04134954884648323, 0.04621865227818489, -0.056057777255773544, -0.021217187866568565, -0.0013828383525833488, -0.015301099047064781, 0.023929253220558167, -0.01564168371260166, -0.014304572716355324, -0.0035698360297828913, -0.00598546676337719, 0.028659600764513016, -0.00838848389685154, 0.021494701504707336, -0.05878245830535889, 0.0009468579664826393, 0.011586198583245277, 0.006925229448825121, 0.024042781442403793, -8.549118501832709e-05, 0.02246600016951561, -0.0007765654590912163, -0.014670385979115963, 0.02936599962413311, 0.03431079164147377, 0.024597808718681335, 0.005808867514133453, -0.01834113523364067, -0.004471755586564541, -0.02254168502986431, 0.005774178076535463, -0.008420019410550594, 0.006843236740678549, -0.024875324219465256, 0.00559757836163044, 0.001881101750768721, 0.012841317802667618, -0.03052651323378086, -0.038195982575416565, -0.033528707921504974, 0.0031582957599312067, -0.00766316382214427, -0.06054845452308655, -0.04578976705670357, 0.05479635298252106, 0.01927459053695202, -0.015881355851888657, 0.007089214865118265, 0.02510238066315651, 0.009839124046266079, -0.0034436932764947414, 0.021330716088414192, 0.017067095264792442, -0.024534737691283226, 0.04954881966114044, -0.05323218181729317, -0.016537295654416084, -0.004361380822956562, -0.05414041131734848, -0.059186115860939026, -0.02712066099047661, 0.017294151708483696, -0.005228611174970865, -0.0028098267503082752, -0.09208410978317261, -0.010450915433466434, 0.02590969204902649, 0.020548632368445396, 0.07770384848117828, 0.0005061472184024751, 0.002477125497534871, -0.005994927603751421, 0.01414058730006218, -0.03130859509110451, 0.010614900849759579, 0.027322489768266678, -0.04309031739830971, -0.024509510025382042, 0.04420037195086479, 0.07639196515083313, -0.023904025554656982, -0.03357916325330734, -0.03239342197775841, 0.057016462087631226, 0.07331408560276031, 0.03004717081785202, -0.010141866281628609, 0.032040223479270935, -0.0017707269871607423, -0.018013164401054382, -0.02111627347767353, -0.016953567042946815, 0.006944150663912296, 0.0026553019415587187, 0.014228886924684048, -0.0894603431224823, 0.015010970644652843, 0.008476783521473408, -0.03865009546279907, 0.03375576436519623, 0.009668831713497639, -0.038599640130996704, -0.002432975685223937, -0.06907569617033005, -0.002648994792252779, -0.030097628012299538, 0.0491451621055603, 0.0012298905057832599, 0.011296071112155914, 0.04717733711004257, 0.02462303824722767, -0.03854918107390404, 0.015578612685203552, -0.0024897397961467505, -0.0014309302205219865, 0.011630348861217499, -0.014531629160046577, 0.02578354999423027, 0.011857405304908752, -0.002959621138870716, -0.031005853787064552, -0.00869122613221407, -0.002767253667116165, -0.03516856208443642, -0.017445523291826248, -0.05671371892094612, -0.06630055606365204, 0.00842632632702589, 0.017041867598891258, 0.017760880291461945, -0.04210640490055084, -0.0036455215886235237, 0.01834113523364067, -0.012507040053606033, 0.012443969026207924, 0.0021081583108752966, 0.013812616467475891, -0.0075685568153858185, 0.0007576440693810582, -0.012242140248417854, 0.010091409087181091, -0.05948885530233383, -0.016158869490027428, 0.029416456818580627, 0.011510513722896576, -0.03173748031258583, 0.015654297545552254, 0.017975322902202606, -0.022251557558774948, -0.030122855678200722, 0.04041609168052673, -0.03471444547176361, -0.01725631020963192, 0.002078199526295066, -0.023197626695036888, 0.07750201970338821, -0.017004024237394333, 0.012229526415467262, 0.02341206930577755, -0.0015846665482968092, 0.03981060907244682, 0.004865951370447874, -0.061406224966049194, -0.01451901439577341, 0.048766735941171646, -0.04228300228714943, 0.034285563975572586, -0.008874133229255676, -0.05494772270321846, 0.0381455272436142, -0.010066180489957333, 0.01309360284358263, -0.012551190331578255, -0.007669470738619566, 0.05817697197198868, 0.0073414999060332775, -0.06826838105916977, 0.02828117460012436, 0.0016682361019775271, 0.01238720491528511, 0.01575521193444729, 0.005562889389693737, 0.012607954442501068, 0.024522123858332634, -0.014090130105614662, 0.004809187259525061, 0.032242052257061005, 0.04959927499294281, -0.00048407228314317763, -0.007492871023714542, 0.007562249433249235, 0.009908501990139484, 0.01747075282037258, 0.03685887157917023, 0.00619044853374362, -0.007770385127514601, 0.030274227261543274, -0.035345159471035004, -0.023235470056533813, -0.022100185975432396, 0.011352835223078728, -0.015944426879286766, -0.058984287083148956, 0.03140950947999954, -0.03854918107390404, 0.02328592725098133, -0.04001243785023689, -0.03870055451989174, 0.0038788854144513607, -0.022566912695765495, 0.00229106517508626, -0.005502971354871988, -0.03842303901910782, -0.025064537301659584, 0.007026143372058868, -0.012721482664346695, 0.0018054161919280887, -5.908007369725965e-05, -0.017975322902202606, 0.027852289378643036, 0.04311554506421089, -0.012841317802667618, -0.03973492234945297, -0.006887386552989483, 0.05948885530233383, 0.013913529925048351, 0.04906947538256645, -0.07760293781757355, 0.013270203024148941, 0.0026316503062844276, -0.03791847079992294, 0.002647418063133955, 0.009012890048325062, -0.0003084581112489104, 0.0213181022554636, 0.08658429235219955, 0.014266729354858398, 0.015061427839100361, -0.008338026702404022, 0.036429986357688904, -0.015061427839100361, 0.008602926507592201, -0.02218848653137684, -0.008539854548871517, -0.002898126607760787, -0.04081974923610687, 0.004118556156754494, -0.02111627347767353, -0.03693455830216408, 0.05045704543590546, -0.0038378890603780746, -0.013270203024148941, 0.046798910945653915, 0.004326691851019859, 0.0016808502841740847, 0.009385010227560997, 0.0034342326689511538, -0.019123220816254616, -0.02239031344652176, 0.013472030870616436, 0.023740040138363838, -0.02964351326227188, -0.027221575379371643, -0.012267368845641613, 0.013156674802303314, 0.057621944695711136, 0.021091045811772346, 0.0020450870506465435, -0.008527240715920925, -0.007839763537049294, -0.025670021772384644, 0.002289488445967436, 0.006893693935126066, -0.002770407125353813, -0.017559051513671875, -0.021091045811772346, -0.015452469699084759, 0.0370607003569603, -0.00961206667125225, -0.05353492498397827, 0.038473498076200485, -0.02260475605726242, -0.0008916705846786499, -0.020813530310988426, 0.07805705070495605, 0.02956782840192318, 0.047328706830739975, -0.08174041658639908, 0.006001234985888004, -0.04493200033903122, -0.008161427453160286, -0.0382968969643116, -0.0016382772009819746, -0.007227971684187651, 0.030122855678200722, 0.00998418778181076, 0.03965923935174942, 0.03297368064522743, -0.034815359860658646, 0.027726145461201668, 0.0296939704567194, 0.040289949625730515, -0.03592541441321373, 0.0018353749765083194, 0.020939674228429794, 0.054089952260255814, 0.03900329768657684, -0.013320660218596458, -0.022415542975068092, 0.005266454070806503, -0.0016981948865577579, -0.017369838431477547, -0.02760000340640545, 0.022655213251709938, -0.025884464383125305, 0.0417027473449707, -0.02944168634712696, 0.02564479410648346, 0.0488424189388752, 0.0011747031239792705, -0.012929617427289486, -0.02646471932530403, -0.024534737691283226, 0.022693056613206863, 0.011453749611973763, -0.004550594836473465, -0.05575503408908844, 0.00588770629838109, 0.011125778779387474, -0.01860603503882885, 0.00634497357532382, 0.0165120679885149, 0.00927148200571537, -0.03557221591472626, -0.040163807570934296, 0.005184461362659931, -0.022074956446886063, 0.006603565998375416, -0.007946984842419624, 0.04795942083001137, -0.04369580000638962, 0.017559051513671875, -0.014266729354858398, 0.07901573181152344, -0.0004612089251168072, 0.03983583673834801, -0.028180260211229324, 0.0229453407227993, -0.013459417037665844, -0.009555302560329437, -0.005515585653483868, 0.006805393844842911, 0.03559744358062744, 0.04654662311077118, -0.004005027934908867, -0.005405210889875889, 0.020069289952516556, -0.011687112972140312, -0.030804026871919632, 0.042131632566452026, 0.0007280794088728726, 0.014884828589856625, 0.024408595636487007, 0.06069982424378395, -0.028785744681954384, 0.011340220458805561, -0.0035729894880205393, 0.035294704139232635, -0.007347807288169861, 0.01472084317356348, 0.03479013219475746, -0.009870659559965134, 0.06443364918231964, 0.04200549051165581, -0.04427605867385864, -0.012494426220655441, 0.020725231617689133, -0.00669817253947258, -0.055855948477983475, -0.0009791820775717497, -0.013863072730600834, 0.020132360979914665, -0.02929031476378441, 0.01526325661689043, -0.008356948383152485, -0.03900329768657684, -0.00832541286945343, 0.0488424189388752, -0.007940677925944328, -0.010072487406432629, 0.05217258632183075, 0.02198665775358677, 0.05123912915587425, 0.018177149817347527, 0.0022784508764743805, 0.008464169688522816, 0.043342601507902145, 0.005411518272012472, -0.002475548768416047, -0.016020111739635468, -0.004859643988311291, -0.017306767404079437, -0.010331080295145512, -0.03794369846582413, -0.00401133531704545, -0.004619973246008158, 0.01996837556362152, -0.002882358618080616, -0.016486840322613716, -0.040088120847940445, -0.027019748464226723, 0.02497623674571514, -0.032847534865140915, 0.004433912690728903, -0.12099599093198776, -0.04705119505524635, -0.04311554506421089, 0.017849178984761238, -0.021078430116176605, -0.005345293320715427, -0.00415955251082778, 0.007776692043989897, 0.028609145432710648, -0.06463547796010971, -0.010848265141248703, -0.026616090908646584, 0.0011037478689104319, 0.0010635398793965578, -0.021217187866568565, -0.005808867514133453, 0.009561610408127308, 0.008514625951647758, -0.024597808718681335, 0.002737294649705291, 0.016663439571857452, 0.0021696528419852257, 0.005988620687276125, -0.012727789580821991, -0.0051213898696005344, -0.017357222735881805, 0.0008609233191236854, -0.005733181722462177, 0.0012354091741144657, -0.01309360284358263, 0.007448721211403608, 0.011920477263629436, 0.019123220816254616, 0.04099635034799576, -0.011100550182163715, 0.004563209135085344, -0.0018574499990791082, -0.002100274432450533, 0.037312984466552734, 0.026489948853850365, -0.006269287783652544, 0.004134323913604021, 0.042863260954618454, -0.041374776512384415, 0.011460056528449059, -0.0006618545157834888, -0.01299268938601017, 9.613447036826983e-05, -0.032368194311857224, 0.026489948853850365, -0.021885743364691734, -0.020006218925118446, -0.02679269015789032, -0.031636565923690796, -0.009914809837937355, 0.023651739582419395, -0.028230717405676842, -0.02848300151526928, 0.018038393929600716, -0.00010741831647465006, -0.007436106912791729, -0.005868785083293915, 0.01996837556362152, 0.007827148772776127, -0.019261976704001427, -0.005408364348113537, -0.014670385979115963, -0.03362962231040001, 0.00038847982068546116, -0.03221682459115982, 0.00664771581068635, -0.02916417270898819, -0.005105622112751007, 0.02570786513388157, 0.01935027725994587, -1.9709782463905867e-06, -0.0229453407227993, -0.041854120790958405, 0.06307130306959152, -0.06781426817178726, 0.031636565923690796, 0.04071883484721184, -0.01241243351250887, 0.03620292991399765, 0.042863260954618454, -0.01268363930284977, -0.006811701226979494, 0.0017281537875533104, -0.01846727915108204, 0.045840226113796234, -0.014960513450205326, 0.06483730673789978, 0.0029107409063726664, 0.014859599992632866, -0.022983184084296227, 0.015465084463357925, -0.013888301327824593, -0.028003660961985588, 0.029921026900410652, 0.00011421819363022223, -0.028710057958960533, 0.03171225264668465, 0.01927459053695202, -0.031434740871191025, -0.014884828589856625, -0.004254159517586231, 0.038271669298410416, 0.0025307361502200365, -0.019312433898448944, -0.012311519123613834, 0.008356948383152485, 0.0042604668997228146, -0.014127972535789013, 0.010324772447347641, 0.011428521014750004, -0.033049363642930984, -0.029189400374889374, 0.02057386003434658, 0.004796572960913181, -0.03181316703557968, 0.03930603712797165, -0.02536727860569954, -0.00712075037881732, -0.01976654678583145, 0.001695041311904788, 0.048741504549980164, -0.01969086192548275, 0.05777331814169884, -0.04533565416932106, 0.008344333618879318, -0.024118468165397644, 0.005036243703216314, -0.03895283862948418, -0.006729708518832922, -0.004232084844261408, 0.010595979169011116, -0.001352879568003118, 0.017218466848134995, 0.03912943974137306, 0.017142781987786293, 0.024850094690918922, -0.03390713408589363, -0.022756127640604973, -0.009082267992198467, 0.01860603503882885, 0.014001830480992794, -0.02848300151526928, 0.01089241448789835, -0.008615540340542793, 0.004014488775283098, -0.033730532974004745, -0.0015342095866799355, -0.006102148909121752, -0.012980074621737003, -0.012891774997115135, -0.03544607385993004, -0.02252907119691372, -0.005225457716733217, 0.010942871682345867, -0.005777331534773111, -0.01444332953542471, -0.033932361751794815, -0.003831581911072135, -0.00791544932872057, 0.00410909578204155, 0.03774186968803406, -0.016625596210360527, 0.0078082275576889515, -0.06377770751714706, -0.03130859509110451, 0.03882669657468796, -0.00015767826698720455, -0.05434223636984825, -0.016158869490027428, 0.03998721018433571, -0.027700917795300484, -0.013522488065063953, -0.024749180302023888, -0.0207000020891428, -0.019741319119930267, 0.03201499581336975, 0.035294704139232635, -0.03037514165043831, -0.008659690618515015, 0.018366364762187004, -0.017218466848134995, -0.005648035556077957, -0.013421573676168919, -0.0031377975828945637, 0.0132954316213727, 0.016625596210360527, 0.011441134847700596, -0.014153201133012772, -0.018051007762551308, -0.00034058504388667643, -0.07573602348566055, 0.0054335929453372955, -0.008893053978681564, -0.028583915904164314, -0.02651517651975155, 0.02679269015789032, 0.009019196964800358, -0.018517736345529556, -0.011989855207502842, 0.02734771929681301, 0.018997076898813248, 0.002011974574998021, -0.012336747720837593, 0.044477883726358414, 0.010028338059782982, 0.04533565416932106, -0.024143695831298828, -0.018353750929236412, 0.008129891008138657, -0.02381572499871254, -0.05832834541797638, 0.034209877252578735, 0.06206216663122177, 0.05474589392542839, 0.0132954316213727, 0.036505673080682755, -0.0007781422464177012, -0.007669470738619566, -0.02085137367248535, 0.009328246116638184, -0.0244212094694376, 0.008350640535354614, 0.0038031998556107283, 0.011207771487534046, 0.025001466274261475, -0.009826509281992912, -0.03655612841248512, -0.005871938541531563, 0.01482175663113594, -0.010570750571787357, -0.04235868901014328, 0.004373995121568441, -0.01705448143184185, 0.008451554924249649, -0.002264259848743677, 3.3087799238273874e-05, 0.009870659559965134, 0.023967096582055092, -0.023046255111694336, 0.03933126851916313, -0.021557772532105446, 0.013497259467840195, 0.04339306056499481, 0.027978431433439255, -0.00490694772452116, -0.025808779522776604, -0.018088851124048233, 0.0065909516997635365, -0.0003530022222548723, 0.003623446449637413, -0.025960149243474007, -0.04795942083001137, -0.02164607308804989, -0.0255060363560915, -0.025152837857604027, -0.008287569507956505, -0.015099271200597286, -0.05134004354476929, 0.00109980592969805, 0.0024913165252655745, -0.030274227261543274, 0.020725231617689133, 0.008911975659430027, 0.01596965454518795, -0.018643878400325775, -0.12735357880592346, -0.03761572763323784, 0.03337733447551727, 0.007133364677429199, 0.045360881835222244, -0.025140222162008286, 0.019678248092532158, -0.0276756901293993, 0.01282239705324173, -0.029492143541574478, -0.012980074621737003, -0.010040951892733574, 0.01739506609737873, 0.006546801421791315, 0.012696254067122936, -0.035219017416238785, -0.03161133825778961, -0.00027889342163689435, 0.0030968012288212776, -0.014355028979480267, 0.0038063533138483763, 0.03128336742520332, 0.018177149817347527, 0.03526947647333145, -0.05025521665811539, -0.011478978209197521, 0.009586839005351067, 0.026086293160915375, -0.010236472822725773, -0.001904753502458334, -0.0036896714009344578, -0.0049195620231330395, 0.02252907119691372, 0.031005853787064552, -0.013800001703202724, 0.004323537927120924, -0.006212523672729731, -0.028710057958960533, -0.004954250995069742, 0.007524407003074884, 0.026338577270507812, -0.05858062952756882, 0.07800659537315369, 0.03693455830216408, 0.010564443655312061, -0.04843876510858536, 0.002984849503263831, -0.014090130105614662, 0.002071892376989126, -0.0361272431910038, -0.007473949808627367, 0.01309360284358263, -0.009372396394610405, -0.018643878400325775, -0.013169288635253906, -0.0035509145818650723, -0.003711746307089925, 0.01011663768440485, 0.029416456818580627, 0.016259782016277313, -0.004910101182758808, 0.006742322817444801, 0.06458501517772675, -0.03494150564074516, -0.03579927235841751, -0.01812669262290001, -0.010633822530508041, -0.005446207243949175, -8.036664075916633e-05, 0.012292597442865372, -0.014039672911167145, 0.004424452316015959, -0.010003109462559223, -0.010860878974199295, -0.007726234849542379, -0.0035225325264036655, -0.027221575379371643, 0.026817919686436653, -0.04707642272114754, 0.009479617699980736, 0.04296417534351349, -0.030602198094129562, 0.025859234854578972, 0.0026915681082755327, -0.02165868692100048, 0.00026608206098899245, -0.0012819243129342794, 0.0032024455722421408, -0.021746985614299774, 0.03653090074658394, 0.03024899773299694, -0.020258503034710884, 0.012601646594703197, -0.03378099203109741, -0.007026143372058868, -0.010898721404373646, -0.014493785798549652, 0.017420295625925064, 0.029542600736021996, -0.0005569984787143767, 0.011270842514932156, 0.046445708721876144, -0.003131490433588624, -0.031838394701480865, 0.008710147812962532, 0.009277788922190666, -0.018858321011066437, 0.022100185975432396, 0.010450915433466434, -0.00431407755240798, 0.017445523291826248, -0.022907499223947525, -0.047000735998153687, -0.01119515672326088, 0.01197724137455225, 0.009933730587363243, 0.05323218181729317, 0.013080989010632038, 0.02010713331401348, 0.0044149914756417274, 0.015338941477239132, 0.010268008336424828, -0.006717094220221043, -0.011289764195680618, -0.03673272952437401, -0.027751374989748, -0.003812660463154316, 0.0244212094694376, -0.012216911651194096, -0.010905029252171516, 0.007366728503257036, -0.010255394503474236, 0.03350347653031349, -0.01441810093820095, 0.007871299050748348, 0.03105631098151207, 0.016612982377409935, -0.0120150838047266, -0.04389762878417969, 0.02111627347767353, 0.0016871574334800243, -0.011706034652888775, 0.02820548787713051, 0.00970667414367199, 0.020460331812500954, -0.030551740899682045, -0.006780165247619152, -0.02674223482608795, 0.005783638916909695, 0.00419424194842577, 0.05237441137433052, -0.005868785083293915, -0.014039672911167145, 0.012954846024513245, -0.016739124432206154, -0.003535146825015545, 0.0005585752660408616, -0.0038883460219949484, -0.02015758864581585, -0.005443053785711527, 0.030148085206747055, 0.05073455721139908, 0.01975393295288086, -0.008073126897215843, 0.002759369555860758, -0.008142505772411823, -0.01948903314769268, -0.018694335594773293, -0.006458501797169447, 0.023525597527623177, -0.00229106517508626, -0.04192980378866196, 0.01950164884328842, 0.004761883523315191, 0.017369838431477547, -0.0009492231765761971, 0.01214753370732069, 0.011270842514932156, 0.008520933799445629, 0.02618720568716526, 0.008647075854241848, 0.013005303218960762, -0.04606728255748749, 0.021873129531741142, 0.009057039394974709, -0.021355943754315376, 0.010085102170705795, 0.009719287976622581, 0.009157953783869743, 0.02083875983953476, 0.013724315911531448, 0.03168702498078346, 0.011125778779387474, 0.05429178103804588, 0.01538939867168665, 0.04122340679168701, -0.0339575931429863, -0.003245018655434251, -0.004052331671118736, -0.03842303901910782, -0.03748958557844162, 0.03675795719027519, -0.002820864086970687, -0.032847534865140915, -0.014077515341341496, 0.02347514033317566, -0.044023770838975906, -0.013131446205079556, -0.005439900327473879, -0.00855877622961998, 0.020346803590655327, 0.009599452838301659, -0.008237112313508987, 0.023449912667274475, -0.03796892613172531, -0.045587942004203796, 0.03494150564074516, -0.001374954474158585, -0.027650460600852966, 0.00041232866351492703, -0.015074042603373528, -0.020624317228794098, -0.01779872179031372, 0.021746985614299774, -0.041652292013168335, 0.02361389808356762, 0.026086293160915375, -0.005689031910151243, 0.005146618466824293, -0.030829254537820816, -0.0009586838423274457, 0.025733092799782753, -0.005354753695428371, -0.007726234849542379, -0.014619928784668446, -0.0063575878739356995, -0.03168702498078346, -0.015238028019666672, -0.027650460600852966, -0.010400458239018917, -6.381042476277798e-05, 0.015780441462993622, 0.012954846024513245, -0.012614261358976364, 0.00038788854726590216, -0.025455579161643982, 0.013951373286545277, 0.03166179731488228, -0.0276756901293993, -0.036303844302892685, -0.049977704882621765, 0.028255945071578026, 0.03733821213245392, -0.026565633714199066, 0.03085448406636715, 0.009183182381093502, -0.005884552840143442, 0.047202564775943756, 0.03468921780586243, 0.0058940136805176735, -0.00173761451151222, -0.027221575379371643, -0.003131490433588624, -0.0005881399265490472, 0.0011037478689104319, -0.021166730672121048, 0.01617148332297802, 0.027423404157161713, -0.016057955101132393, -0.008142505772411823, -0.023462526500225067, 0.0006066671339794993, 0.00024006515741348267, 0.0328727662563324, 0.009460696019232273, -0.01846727915108204, 0.017836565151810646, -0.019173678010702133, -0.01238720491528511, 0.008508319035172462, -0.019249362871050835, -0.024320295080542564, -0.03476490452885628, -0.031434740871191025, 0.049094706773757935, 0.020674774423241615, 0.030627425760030746, 0.001991476397961378, 0.015427242033183575, -0.004509598482400179, 0.04301463067531586, 0.003702285699546337, -0.015666913241147995, -0.010324772447347641, 0.004052331671118736, -0.015793055295944214, -0.01512449886649847, 0.044831085950136185, -0.01210969127714634, -0.01197724137455225, -0.006247213110327721, 0.03093016892671585, -0.030677882954478264, 0.0044181449338793755, -0.0007525195251218975, 0.010217552073299885, 0.013106217607855797, 0.028028888627886772, -0.03037514165043831, -0.018971849232912064, -0.01359817385673523, -0.0030999546870589256, -0.0032954758498817682, 0.022554298862814903, 0.038195982575416565, 0.0018117232248187065, -0.000760403461754322, -0.010488757863640785, -0.0024503201711922884, 0.022617369890213013, -0.018454663455486298, -0.02455996721982956, 0.014014444313943386, -0.006521573290228844, -0.02923985756933689, 0.01725631020963192, -0.019854847341775894, -0.0165120679885149, -0.021191958338022232, 0.026035835966467857, -0.018315907567739487, 0.04755576327443123, 0.014317186549305916, -0.018177149817347527, 0.01562906987965107, 0.011005942709743977, -0.004244699142873287, -0.00766316382214427, -0.027751374989748, -0.008167734369635582, 0.013118831440806389, 0.005225457716733217, -0.014367643743753433, 0.009353474713861942, 0.01820237934589386, 0.011157314293086529, -0.001587031758390367, 0.012267368845641613, 0.004623126704245806, -0.025480808690190315, 0.07543328404426575, -0.013169288635253906, -0.019791776314377785, 0.015515541657805443, -0.0007178303203545511, 0.03640475869178772, -0.025695249438285828, 0.010495065711438656, -0.05088593065738678, 0.0017060788813978434, -0.030274227261543274, 0.023109326139092445, -0.012778246775269508, -0.006805393844842911, 0.009668831713497639, -0.005815174430608749, -0.0500786155462265, 0.005648035556077957, 0.007726234849542379, 0.00886151846498251, 0.0018968695076182485, 0.0192241333425045, -0.05262669920921326, 0.032998908311128616, -0.021696530282497406, -0.003702285699546337, -0.014153201133012772, 0.003919881768524647, -0.02679269015789032, -0.014746071770787239, -0.002516545122489333, -0.011485285125672817, -0.032166365534067154, -0.026010606437921524, 0.004711426794528961, -0.010230165906250477, -0.06973163783550262, 0.014859599992632866, -0.003967185039073229, 0.0029138943646103144, -0.00801636278629303, 0.021141501143574715, -0.008981353603303432, -0.012708867900073528, -3.1320078051066957e-06, 0.013043146580457687, -0.0010304275201633573, -0.0004580553504638374, -0.003092070808634162, -0.004828108474612236, -0.026136750355362892, -0.01116992812603712, 0.010879800654947758, -0.022314628586173058, 0.005957084707915783, -0.014973128214478493, -0.012929617427289486, 0.01238089706748724, 0.027423404157161713, -0.010406765155494213, -0.027019748464226723, 0.026691777631640434, -0.008754297159612179, 0.02010713331401348, 0.006471116095781326, -0.01982961967587471, 0.023967096582055092, 0.018631264567375183, -0.009668831713497639, 0.05575503408908844, -0.007946984842419624, 0.005881399381905794, 0.0023982864804565907, -0.010987021960318089, 0.009649910032749176, -0.010570750571787357, 0.00512454379349947, 0.026817919686436653, -0.01981700398027897, 0.05378720909357071, -0.0011486861621960998, 0.0049605583772063255, -0.004670430440455675, 0.015856126323342323, 0.024004939943552017, 0.04866582155227661, -0.0004525366239249706, -0.018997076898813248, -0.007921756245195866, -0.008350640535354614, -0.02042248845100403, 0.0031393743120133877, 0.016146253794431686, -0.021494701504707336, -0.00036305421963334084, -0.03764095529913902, 0.02382833883166313, -0.02245338447391987, -0.007019836455583572, 0.01846727915108204, -0.0024250918067991734, -0.014910057187080383, 0.05853017419576645, 0.019980989396572113, -0.02929031476378441, -0.002518121851608157, -0.03564790263772011, -0.01245027594268322, 0.03688409924507141, 0.02482486702501774, 0.0005022052791900933, 0.0016887342790141702, 0.012311519123613834, -0.0001523566315881908, 0.01268363930284977, -0.006212523672729731, -0.050860702991485596, 0.012254755012691021, 0.02361389808356762, -0.02056124620139599, 0.029921026900410652, -0.023651739582419395, 0.0008727491949684918, 0.00431407755240798, 0.0127908606082201, -0.009820202365517616, -0.013383731245994568, -0.0013221323024481535, -0.02428245358169079, 0.022289399057626724, -0.026893604546785355, 0.01275301817804575, 0.022579528391361237, 0.004806033335626125, 0.05560366436839104, -0.0013410536339506507, -0.012980074621737003, 0.02787751704454422, -0.024875324219465256, -0.010488757863640785, 0.015742598101496696, -0.02964351326227188, 0.01028693001717329, 0.001291385036893189, 0.006184141617268324, 0.02502669394016266, -0.015465084463357925, -0.01482175663113594, 0.020409874618053436, 0.008716454729437828, -0.010595979169011116, -0.00451905932277441, -0.015061427839100361, 0.011352835223078728, 0.024269837886095047, 0.016499454155564308, 0.0014466980937868357, -0.011598813347518444, 0.03701024129986763, 0.007896527647972107, 0.02510238066315651, -0.011560970917344093, -0.008804754354059696, 0.0004206067824270576, 0.024648265913128853, -0.0032923221588134766, -0.0015570728573948145, 0.00048407228314317763, -0.021191958338022232, -0.027448631823062897, 0.0020923905540257692, 0.03531993180513382, -0.0009634142043069005, -0.034336019307374954, -0.022415542975068092, -0.017104938626289368, 0.035219017416238785, -0.006117916665971279, -0.01207815483212471, 0.0061242240481078625, -0.007997442036867142, -0.025417735800147057, 0.03854918107390404, -0.005093007814139128, -0.027448631823062897, -0.008420019410550594, -0.004090174101293087, 0.017294151708483696, 0.000264899485046044, -0.005641728173941374, -0.0039955670945346355, 0.0015893969684839249, 0.0013426304794847965, -0.006559415720403194, 0.01887093484401703, -0.01841682195663452, -0.01072212215512991, -0.01414058730006218, -0.011851098388433456, 0.020599089562892914, -0.011794334277510643, -0.006717094220221043, 0.024459052830934525, 0.005720567423850298, 0.016221940517425537, 0.0035919109359383583, 0.010015723295509815, -0.013863072730600834, -0.034058503806591034, 0.030627425760030746, 0.02868483029305935, -0.001100594294257462, -0.02435813844203949, 0.026086293160915375, -0.0049668652936816216, 0.011617735028266907, 0.012544882483780384, -0.0148469852283597, 0.005531353410333395, 0.003812660463154316, -0.022440770640969276, 0.007959598675370216, -5.607433195109479e-05, 0.006234598811715841, -0.032166365534067154, 0.011478978209197521, 0.0008364832028746605, -0.007486564107239246, 0.023714810609817505, 0.018353750929236412, 0.02502669394016266, -0.02590969204902649, -0.002623766427859664, -0.015603841282427311, 0.02362651191651821, -0.02254168502986431, 0.02556910738348961, -0.018568193539977074, -0.01275301817804575, 0.0031377975828945637, -0.02044771797955036, 0.006666637025773525, 0.0012827126774936914, 0.0005025994614697993, -0.005726874805986881, 0.058984287083148956, -0.011680806055665016, 0.007196436170488596, -0.0339575931429863, 0.023185012862086296, 0.010059873573482037, 0.016196710988879204, 0.005042551085352898, 0.0020214354153722525, -0.0006315014325082302, -0.010312158614397049, 0.01866910606622696, -0.03516856208443642, 0.041172947734594345, 0.013232359662652016, -0.009448082186281681, -0.012122305110096931, 0.008842596784234047, 0.021885743364691734, 0.001121880835853517, 0.005307450424879789, 0.005767871160060167, -0.009473309852182865, -0.014392872340977192, -0.01508665643632412, -0.0007130999583750963, 0.0068747722543776035, -0.011233000084757805, -0.007127057760953903, -0.003112568985670805, 0.022756127640604973, 0.009120111353695393, 0.013270203024148941, 0.007959598675370216, -0.014216272160410881, 0.03315027803182602, -0.023033641278743744, 0.007177514489740133, 0.002964351326227188, 0.012002469971776009, -0.01860603503882885, -0.03330165147781372, 0.006931536365300417, -0.004708272870630026, 0.01942596212029457, -0.003386929165571928, -0.03451262041926384, 0.02868483029305935, -0.0477575920522213, -0.009435467422008514, -0.02462303824722767, -0.00808574166148901, -0.026565633714199066, 0.011529434472322464, 0.004824955016374588, -0.002839785534888506, -0.006786472629755735, -0.012336747720837593, -0.02903802879154682, 0.030097628012299538, 0.02105320245027542, -0.035975873470306396, 0.027322489768266678, 0.02274351380765438, -0.0165877528488636, 0.02125503122806549, 0.01677696779370308, 0.004093328025192022, -0.008104663342237473, -0.028382087126374245, 0.030223770067095757, -0.0190727636218071, 0.014645157381892204, -0.006073766853660345, 0.03161133825778961, -0.022163257002830505, 0.012172762304544449, 0.009763438254594803, 0.029265087097883224, 0.04838830605149269, -0.021229801699519157, 0.0032103294506669044, -0.004175320267677307, -0.012128612026572227, -0.0032260974403470755, 0.024320295080542564, -0.009675138629972935, -0.005086700897663832, 0.0041879345662891865, 0.011207771487534046, 0.012456582859158516, -0.010835650376975536, 0.012059234082698822, 0.01603272557258606, -0.02353821136057377, -0.0001886226236820221, 0.005651189014315605, -0.026161978021264076, -0.01569214090704918, -0.026010606437921524, 0.00896873977035284, 0.012563804164528847, -0.0036360607482492924, -0.002940699690952897, 0.018517736345529556, 0.03930603712797165, 0.006023309659212828, -0.01584351249039173, -0.03658135607838631, 0.01575521193444729, -0.010305851697921753, 0.025884464383125305, -0.007221664767712355, -0.01745813712477684, 0.0016256629023700953, -0.02218848653137684, 0.004979479592293501, 0.04094589129090309, -0.004437066614627838, 0.04303985834121704, -0.007940677925944328, -0.005083547439426184, -0.010741043835878372, -0.010665358044207096, -0.005244378931820393, -0.0033932363148778677, 0.03910420835018158, 0.0036266001407057047, 0.017420295625925064, -0.02556910738348961, -0.017672579735517502, -0.020763074979186058, -0.003071572631597519, 0.008028977550566196, -0.008073126897215843, 0.022112799808382988, -0.035975873470306396, -0.002374634612351656, -0.023512983694672585, 0.0022264171857386827, 0.018656492233276367, -0.014796528965234756, 0.019299820065498352, 0.015742598101496696]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"
t(s1:t)in Eq. (69) is not equal to the desired marginal σ(s1:t), despite the fact that all proposals are optimal.
We indeed observed experimentally that resampling based on Eq. (67) after training using Eq. (EBM proposal learning)
could lead to worse SMC logZσbounds than simply calculating the SIS or IWAE bound withQT
t=1qξ
t(st|s1:t−1).
Optimality in CTL Objective implies Optimal Twisted SMC In contrast to Prop. E.2, note that the global optimum of
our CTL objective minPT
t=1DKL
σ(s1:t)πψ
t(s1:t)
(which occurs for the optimal twists {ψ∗
t}T−1
t=1in Prop. 3.2), results
in both the twist-induced proposal qπ∗
t(st|s1:t−1) =σ(st|s1:t−1)and the twisting targets π∗
t(s1:t) =σ(s1:t)satisfying the
necessary and sufficient conditions for optimality outlined in App. A.1 Prop. A.3.
E.3.2. SMC WITH NORMALIZED TARGETS INDUCED BY LEARNED PROPOSAL LEADS TO UNIFORM WEIGHTS
The issue in Prop. E.2 arises from the degree of freedom c(s1:t−1)in the normalization constant of the one-step proposal.
To avoid this, we can instead define normalized twisted intermediate targets using
˜πξ
t(s1:t) =

p0(s1:t)tQ
τ=1ψξ
τ(s1:τ)
Zξ
τ(s1:τ−1)=tQ
τ=1qξ
τ(sτ|s1:τ−1) t̸=T
p0(s1:T)ϕ(s1:T) t=T(71)
where Zξ
t(s1:t−1)arises from the proposal qξ
t(st|s1:t−1):=1
Zξ
t(s1:t−1)p0(st|s1:t−1)ψξ
t(s1:t)learned according to Eq. (EBM
proposal learning).
Crucially, ˜πξ
tin Eq. (71) are automatically normalized for t̸=T, as the product of normalized proposals. In this case, SMC
resampling with qξor the twist-induced proposal yields uniform resampling weights,
(fort < T ) :wt(s1:t) =˜πξ
t(s1:t)
˜πξ
t−1(s1:t−1)qξ(st|s1:t−1)=p0(s1:t)tQ
τ=1ψξ
τ(s1:τ)
Zξ
τ(s1:τ−1)
p0(s1:t−1) 
t−1Q
τ=1ψξ
τ(s1:τ)
Zξ
τ(s1:τ−1)!
1
Zξ
t(s1:t−1)p0(st|s1:t−1)ψξ
t(s1:t)= 1 (72)
Although we were able to construct well-behaved intermediate twisting targets from a proposal-learning scheme
qξ
t(st|s1:t−1)∝p0(st|s1:t−1)ψξ
t(s1:t), Eq. (72) shows that this does not lead to meaningful intermediate SMC resampling .
In other words, for t < T , the marginal distributions of SMC samples sk
1:twith this scheme are simply qξ(s1:t), the same as
we would obtain with no resampling (SIS/IWAE).
35
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
F. Bidirectional SMC
In this section, we recall the extended state-space probabilistic interpretation of SMC from (Maddison et al., 2017; Andrieu
et al., 2010). The idea is to define an unnormalized target distribution σSMC(S)and normalized proposal qSMC(S)over
an extended state space Scontaining all random variables relevant to SMC sampling and importance weighting with K
sequences of length T. Defining ˜σSMC(S)such that its normalization constant matches Zσ, we can use simple importance
sampling (SIS","[0.050540387630462646, -0.009969157166779041, 0.030377153307199478, 0.031329747289419174, -0.04262856766581535, 0.0020656068809330463, 0.022002268582582474, -0.009559012949466705, -0.058055292814970016, 0.02451605722308159, 0.025720030069351196, -0.015294420532882214, -0.045618653297424316, 0.04535404220223427, 0.03185896575450897, -0.01368030346930027, 0.026183096691966057, -0.010743140242993832, -0.00450828205794096, 0.016617467626929283, -0.015241499058902264, -0.007514905650168657, -0.008579958230257034, 0.027122458443045616, -0.004091522190719843, -0.040591076016426086, 0.026077251881361008, -0.024595439434051514, 0.020083850249648094, 0.0016786155756562948, 0.04043230786919594, -0.024436673149466515, -0.029980240389704704, -0.06901012361049652, -0.029371637850999832, 0.08441038429737091, -0.027387067675590515, 0.02855134941637516, -0.023960378021001816, 0.021671505644917488, 0.0006437449483200908, -0.03421398997306824, -0.027651676908135414, 0.04633309692144394, 0.012125723995268345, 0.026236018165946007, 0.009215020574629307, -0.0049614254385232925, 0.00842119287699461, 0.05109606683254242, 0.010789446532726288, 0.027228303253650665, -0.005315340589731932, -0.007587673142552376, -0.020996753126382828, -0.0093010189011693, 0.0073296790942549706, -0.008665956556797028, 0.010703448206186295, -0.0369923897087574, 0.034531522542238235, -0.01963401399552822, -0.016352858394384384, 0.019964775070548058, -0.01585010066628456, -0.021023213863372803, -0.009757470339536667, 0.02627570927143097, -0.04368700459599495, 0.017186377197504044, -0.026924002915620804, 0.018998952582478523, 0.024383751675486565, -0.008216120302677155, -0.023021014407277107, 0.012000034563243389, -0.01067698746919632, 0.045671574771404266, 0.01383906975388527, -0.014844585210084915, -0.00044652828364633024, -0.026646161451935768, 0.01938263513147831, -0.0187078807502985, -0.03222941979765892, -0.01585010066628456, -0.0219228845089674, 0.0022127956617623568, -0.02705630660057068, -0.01606178842484951, -0.030191928148269653, 0.034637365490198135, -0.020957060158252716, -0.013124624267220497, 0.05678516626358032, -0.003446536837145686, 0.01590302214026451, -0.013799377717077732, 0.020745374262332916, -0.0022491796407848597, 0.025349576026201248, -0.028313200920820236, -0.000902979401871562, -0.03926802799105644, 0.06138937175273895, -0.015109194442629814, 0.005487336311489344, -0.0015024850144982338, -0.03569580242037773, -0.005073884502053261, 0.0003224926476832479, -0.018522655591368675, -0.018112510442733765, 0.04680939391255379, 0.053768619894981384, -0.04149074852466583, -0.020507225766777992, -0.00644985307008028, -0.029715631157159805, 0.022941630333662033, -0.004412360955029726, 0.010683602653443813, 0.008308733813464642, 0.006396931130439043, 0.03995601460337639, -0.00813673809170723, 0.02725476399064064, -0.06932765245437622, -0.02528342418372631, 0.033287856727838516, 0.01689530722796917, -0.0019200716633349657, -0.012893090955913067, -0.003582149278372526, 0.0005664294003508985, -0.02382807247340679, -0.009572243317961693, 0.024013299494981766, -0.01973985880613327, 0.024105912074446678, 0.0070650698617100716, -0.014130139723420143, -0.025309884920716286, -0.0036185330245643854, -0.01735837385058403, -0.016934998333454132, -0.04392515495419502, 0.046253714710474014, -0.03569580242037773, 0.02254471741616726, -0.039770785719156265, -0.04014123976230621, -0.05937834084033966, 0.018482962623238564, -0.011285589076578617, -0.07028024643659592, -0.047021083533763885, 0.04281379282474518, 0.016260245814919472, -0.028630731627345085, 0.010253612883388996, 0.05363631621003151, 0.0002685371437110007, 0.0069459956139326096, -0.003585456870496273, -0.004898580722510815, -0.033182013779878616, 0.05170466750860214, -0.03627794235944748, -0.04757676273584366, 0.00870564766228199, -0.05710269883275032, -0.03154143691062927, -0.033129092305898666, 0.01782144047319889, -0.01705407351255417, -0.006138937082141638, -0.0880090743303299, -0.02021615393459797, -0.008097046054899693, -0.01705407351255417, 0.04418976232409477, -0.031012216582894325, -0.02444990538060665, -0.005308725405484438, 0.012324180454015732, -0.0183374285697937, 0.032520491629838943, 0.04037938639521599, -0.006926150061190128, -0.03212357684969902, 0.06160105764865875, 0.07779514789581299, -0.020665990188717842, -0.03177958354353905, -0.005603102967143059, 0.05109606683254242, 0.08155260235071182, 0.02016323246061802, 0.004551280755549669, 0.02508496679365635, -0.00225414102897048, -0.03304971009492874, -0.023034244775772095, -0.02343115769326687, 0.012430024333298206, -0.0010832445695996284, 0.029345177114009857, -0.07403770089149475, 0.027016615495085716, 0.022266877815127373, -0.007488444913178682, 0.05884912237524986, 0.011622966267168522, -0.03913572430610657, 0.005302109755575657, -0.07922404259443283, 0.00014005690172780305, -0.013098163530230522, 0.05450952798128128, 0.008116891607642174, 0.001093167345970869, 0.04045877233147621, 0.02757229469716549, -0.05742023140192032, 0.028260279446840286, -0.01046529971063137, -0.007395831402391195, 0.003446536837145686, -0.03865942731499672, 0.0375216081738472, 0.027439991012215614, 0.0215524323284626, -0.043316550552845, -0.01885341666638851, -0.0053186481818556786, -0.03487551212310791, -0.010266843251883984, -0.017477447167038918, -0.08922627568244934, 0.006674771197140217, 0.01684238575398922, 0.02590525522828102, -0.0189724899828434, 0.01178834680467844, 0.02284901775419712, -0.013891991227865219, -0.013667073100805283, -0.017292222008109093, 0.016564546152949333, -0.017596522346138954, -0.00340684549883008, -0.019144486635923386, 0.012714479118585587, -0.046094950288534164, -0.007931665517389774, 0.00010455170558998361, 0.01409044861793518, -0.02497912384569645, 0.019766319543123245, -0.014778432436287403, -0.02507173642516136, -0.0313032865524292, 0.012926166877150536, -0.028736576437950134, -0.025111427530646324, 0.0008897489751689136, -0.028313200920820236, 0.08658017963171005, -0.003469690214842558, -0.009181944653391838, 0.016643928363919258, 0.0017761903582140803, 0.03958556056022644, -0.004071676637977362, -0.04657124727964401, -0.01694822870194912, 0.03686008229851723, -0.022624099627137184, 0.03389645740389824, 0.01082913763821125, -0.07117991894483566, 0.03622502088546753, -0.007984586991369724, -0.01137158740311861, -0.004035292658954859, -0.013237083330750465, 0.06371793150901794, 0.031118059530854225, -0.06160105764865875, 0.02441021241247654, 0.015836870297789574, 0.012760786339640617, -0.008460883982479572, 0.002143335761502385, -0.012674788013100624, 0.016723310574889183, 0.01500335056334734, -0.0013875452568754554, 0.017543600872159004, 0.06546435505151749, 0.011173130013048649, -0.002990085631608963, 0.014249213971197605, 0.006089322734624147, 0.0212878230959177, 0.014460901729762554, 0.010160999372601509, -0.011563428677618504, 0.03082698956131935, -0.011742040514945984, -0.029265794903039932, -0.018893107771873474, 0.017490677535533905, -0.019051874056458473, -0.04254918545484543, 0.05276310443878174, -0.014712280593812466, 0.02860427089035511, -0.03754806891083717, -0.025931717827916145, 0.00797797180712223, -0.005980171263217926, -0.014765202067792416, 0.007587673142552376, -0.044692520052194595, -0.01989862322807312, 0.008950411342084408, -0.02590525522828102, -0.013118009082973003, 0.029556864872574806, -0.0029338563326746225, 0.03662193566560745, 0.0156516432762146, 0.005027577746659517, -0.04937610775232315, -0.014328597113490105, 0.04908503592014313, -0.013118009082973003, 0.04466605931520462, -0.09446553885936737, 0.0026824772357940674, -0.019210638478398323, -0.026924002915620804, 0.03228234127163887, 0.02736060693860054, 0.009843467734754086, 0.027492912486195564, 0.09637072682380676, -0.007686901837587357, 0.024185294285416603, -0.00659208046272397, 0.024013299494981766, -0.02652708813548088, 0.02704307623207569, -0.025786181911826134, -0.002677515847608447, -0.028630731627345085, -0.035616420209407806, -0.00575194600969553, -0.02201549895107746, -0.01979278028011322, 0.061230603605508804, 0.008593188598752022, -0.0023037551436573267, 0.042099349200725555, 0.00358876446262002, 0.015347342938184738, -0.008017663843929768, 0.004528127610683441, -0.0072701419703662395, -0.00824258103966713, 0.015095964074134827, 0.021102596074342728, -0.04379284754395485, 0.007554597221314907, 0.0013817569706588984, 0.018072819337248802, 0.02947748266160488, 0.021102596074342728, 0.03217649832367897, -0.007991202175617218, -0.015572261065244675, -0.02611694298684597, -0.0031157750636339188, -0.00016734474047552794, 0.016445470973849297, -0.010240382514894009, -0.016458701342344284, 0.015942713245749474, 0.0007487618131563067, 0.008665956556797028, -0.05747315287590027, 0.035828106105327606, 0.0070319934748113155, -0.004025369882583618, -0.013587690889835358, 0.03902988135814667, 0.03082698956131935, 0.04180827736854553, -0.05959002673625946, 0.012244798243045807, -0.032467566430568695, -0.044745441526174545, -0.04839705303311348, 0.011014364659786224, 0.015823639929294586, 0.016934998333454132, 0.01354799885302782, 0.05413907393813133, 0.04291963577270508, -0.05710269883275032, 0.026910770684480667, 0.03336723893880844, 0.04228457435965538, -0.05964294821023941, -0.004415668547153473, 0.016723310574889183, 0.05268372222781181, 0.07149744778871536, -0.02243887260556221, -0.023907454684376717, 0.018046358600258827, -0.0026709006633609533, 0.0033175398129969835, -0.010954827070236206, 0.025720030069351196, -0.009783931076526642, 0.048423513770103455, -0.029133489355444908, 0.0009186905808746815, 0.05689101293683052, 0.01596917398273945, -0.012780631892383099, -0.025772951543331146, -0.029662709683179855, 0.026540318503975868, -0.018535885959863663, -0.011510507203638554, -0.048053059726953506, -0.0024856741074472666, 0.007303218357264996, -0.024396982043981552, -0.008738723583519459, 0.013435539789497852, -0.006952610798180103, -0.01023376639932394, -0.033922918140888214, 0.00677399942651391, -0.00450828205794096, 0.02693723328411579, -0.022663790732622147, 0.058161135762929916, -0.0188666470348835, -0.010061770677566528, -0.028577810153365135, 0.07160329073667526, -0.020374920219182968, 0.016194092109799385, -0.04498359188437462, 0.02767813950777054, 0.005950402934104204, 0.010346225462853909, 0.035881027579307556, 0.02030876837670803, 0.04866166040301323, 0.058531589806079865, 0.011047440581023693, 0.009076100774109364, 0.02538926713168621, 0.0013958143536001444, -0.04969363659620285, 0.02258440852165222, -0.01012792345136404, -0.002047414891421795, 0.013786147348582745, 0.07811268419027328, -0.036410246044397354, 0.006727692671120167, -0.003582149278372526, 0.03789205849170685, -0.028260279446840286, 0.013078317046165466, 0.0442691445350647, 0.024648360908031464, 0.05884912237524986, 0.028895340859889984, -0.03424045071005821, 0.010511606931686401, 0.03617209941148758, -0.011312049813568592, -0.04768260568380356, 0.009142253547906876, -0.014963659457862377, 0.0429990217089653, -0.045936185866594315, 0.010385917499661446, -0.0077133625745773315, -0.03789205849170685, -0.010266843251883984, 0.029239334166049957, 0.016035327687859535, -0.023047475144267082, 0.04519527778029442, 0.02762521617114544, 0.03543119132518768, 0.015532569028437138, -0.0072701419703662395, 0.03000670112669468, 0.03400230407714844, -0.005675870925188065, -0.00465050945058465, -0.009982387535274029, -0.0078258216381073, -0.0008413750911131501, -0.0037574528250843287, -0.016591006889939308, -0.017371604219079018, 0.008725493215024471, 0.025944948196411133, -0.0004221346171107143, -0.014063986949622631, -0.039876628667116165, -0.024912970140576363, 0.032202959060668945, -0.021750889718532562, 0.0035788414534181356, -0.10139830410480499, -0.02425144799053669, -0.04212580993771553, 0.0014355058083310723, -0.022862248122692108, -0.001604194170795381, 0.02773106098175049, -0.006873228121548891, 0.02228010818362236, -0.037124693393707275, -0.0004163462726864964, 0.00828888826072216, 0.024727744981646538, -0.0008351732976734638, -0.018271276727318764, 0.01409044861793518, -0.0055204126983881, -0.010571143589913845, -0.027783982455730438, 0.008097046054899693, -0.0040419078432023525, 0.002376522868871689, -0.007117991801351309, -0.0038269127253443003, -0.011034210212528706, 0.0029173181392252445, -0.026606470346450806, -0.010981288738548756, 0.0053484165109694, 0.004448744934052229, 0.015095964074134827, -0.0025055198930203915, 0.016908537596464157, 0.037495147436857224, -0.011742040514945984, 0.002250833436846733, -0.01297908928245306, -0.008229350671172142, 0.016921767964959145, 0.03336723893880844, 0.002705630613490939, 0.02762521617114544, 0.051334213465452194, -0.05032869800925255, 0.0011742040514945984, 0.02462190017104149, -0.01632639765739441, -0.01409044861793518, -0.03304971009492874, -0.0008583266171626747, -0.041279058903455734, -0.019131256267428398, -0.008540267124772072, -0.030456537380814552, -0.018562346696853638, 0.031488511711359024, -0.04284025356173515, -0.039506178349256516, 0.03786559775471687, 0.007839052006602287, 0.018324198201298714, -0.009043024852871895, 0.011576659046113491, 0.016022097319364548, -0.009082715958356857, -0.0034862281754612923, 0.0020507224835455418, -0.04159659147262573, -0.0007516559562645853, -0.007078300230205059, 0.0031670432072132826, -0.026460936293005943, -0.008017663843929768, 0.028683654963970184, 0.0184961948543787, 0.005626256577670574, -0.04482482373714447, -0.04294610023498535, 0.04786783084273338, -0.061230603605508804, 0.02631540037691593, 0.025561263784766197, 0.0034994587767869234, 0.02087767794728279, 0.03754806891083717, -0.0009327479638159275, -0.012886475771665573, -0.0065887728706002235, -0.014130139723420143, 0.039770785719156265, -0.01948847994208336, 0.060754306614398956, 0.004461975302547216, 0.0062580113299191, -0.02456897869706154, 0.028075052425265312, -0.026884309947490692, -0.01492396742105484, 0.017027612775564194, 0.004412360955029726, -0.03823605179786682, -0.002603094559162855, 0.017437756061553955, -0.016564546152949333, 0.0007218873943202198, 0.002226026263087988, 0.03342016041278839, -0.003846758510917425, -0.020639529451727867, 0.004805967211723328, 0.02015000209212303, 0.03201773390173912, -0.012939397245645523, 0.015016580931842327, -0.004557895939797163, -0.014566744677722454, -0.020692450925707817, 0.01735837385058403, 0.0026444396935403347, -0.022981323301792145, 0.032097116112709045, -0.01725253090262413, -0.013878760859370232, -0.04673001170158386, -0.031012216582894325, 0.034849051386117935, -0.01168911810964346, 0.04146428778767586, -0.003077737521380186, 0.024489596486091614, -0.016048558056354523, -0.0056196413934230804, -0.029609786346554756, -0.024211756885051727, -0.007084915414452553, -0.0024823665153235197, 0.007528136018663645, 0.013428924605250359, 0.04154366999864578, 0.03011254407465458, 0.02591848559677601, -0.024066220968961716, -0.012688018381595612, -0.003291078843176365, 0.013025395572185516, 0.01714668609201908, -0.02741352841258049, 0.025204041972756386, 0.0040154471062123775, -0.0060033248737454414, -0.04326362907886505, 0.02213457226753235, 0.009975772351026535, -0.0077332085929811, 0.0006912919343449175, -0.043078403919935226, -0.013958144001662731, -0.014579975977540016, 0.0034961511846631765, 0.014659358188509941, -0.017794979736208916, -0.02071891352534294, -0.013250313699245453, -0.01194049697369337, 0.012258028611540794, 0.018125740811228752, -0.03175312280654907, -0.012105878442525864, -0.04575095698237419, -0.026659391820430756, 0.03545765206217766, -0.005113575607538223, -0.035986874252557755, -0.00450828205794096, 0.027122458443045616, -0.05363631621003151, -0.018562346696853638, -0.020480765029788017, -0.015770718455314636, -0.041067373007535934, 0.027995670214295387, 0.04559219256043434, -0.006029785610735416, 0.007852282375097275, 0.010240382514894009, -0.02591848559677601, 0.0007417331216856837, 2.6357573005952872e-05, -0.00935394037514925, 0.02015000209212303, 0.018363889306783676, 0.013574459590017796, -0.006274549290537834, -0.016961459070444107, -0.0007582711987197399, -0.06392961740493774, 0.0016984613612294197, 0.006072784774005413, -0.025931717827916145, -0.040908604860305786, 0.0014578321715816855, -0.004534742794930935, 0.003949294798076153, -0.004455360118299723, 0.030906373634934425, 0.012628481723368168, -0.00974423997104168, -0.029239334166049957, 0.039506178349256516, -0.010187460109591484, 0.016882076859474182, -0.02714891918003559, 0.005871020257472992, -0.0003109159879386425, -0.017887592315673828, -0.05289541184902191, 0.04466605931520462, 0.0616539791226387, 0.03797144442796707, 0.01209926325827837, 0.029503943398594856, -0.016022097319364548, -0.03164727985858917, -0.025640645995736122, 0.01127235870808363, -0.01508273370563984, 0.013462001457810402, 0.013336312025785446, -0.007614134345203638, 0.0044586677104234695, 0.008407962508499622, -0.00511688319966197, 0.006175321061164141, 0.0030198541935533285, -0.00994931161403656, -0.035669341683387756, 0.019038643687963486, -0.005212804302573204, -0.011477431282401085, -0.002915664343163371, -0.005841251462697983, 0.01067698746919632, 0.02569356933236122, -0.018946029245853424, 0.015122424811124802, -0.017755288630723953, 0.013309850357472897, 0.039506178349256516, 0.009525937028229237, 0.007223835214972496, -0.022266877815127373, -0.015281190164387226, 0.01293278206139803, 0.006985687185078859, -0.022002268582582474, -0.014725510962307453, -0.04397807642817497, -0.02134074456989765, -0.05109606683254242, -0.026341861113905907, -0.012310950085520744, 0.0010749754728749394, -0.04432206600904465, -0.009565628133714199, 0.013025395572185516, -0.009625165723264217, 0.018641728907823563, -0.01611470989882946, 0.010524837300181389, 0.0037376072723418474, -0.11738070845603943, -0.027942748740315437, 0.03775975480675697, 0.010756370611488819, 0.04450729489326477, -0.035616420209407806, 0.0184432715177536, -0.022809326648712158, -0.00553033547475934, -0.04882042482495308, -0.02865719422698021, 0.010670372284948826, 0.005890865810215473, -0.0023699074517935514, 0.03379061445593834, -0.040696918964385986, -0.020427841693162918, -0.006043015979230404, -0.006499467417597771, -0.014328597113490105, 0.005179728381335735, 0.0219758078455925, 0.0017282298067584634, 0.047338612377643585, -0.0376274511218071, -0.024436673149466515, 0.004389207810163498, 0.032202959060668945, -0.009003333747386932, 0.010862214490771294, -0.0009219982312060893, -0.008771800436079502, 0.022094881162047386, 0.04675647243857384, -0.01725253090262413, 0.01714668609201908, -0.0028925109654664993, -0.0052591110579669476, -0.005735407583415508, -0.005143344402313232, 0.005884250625967979, -0.048105981200933456, 0.0632416382431984, 0.021697966381907463, 0.013098163530230522, -0.05731438845396042, -0.00428667152300477, -0.018006667494773865, 0.0047232769429683685, -0.02455574832856655, -0.010670372284948826, 0.005351724103093147, -0.0005474106292240322, -0.0055832574144005775, -0.002743668155744672, -0.0013147777644917369, -0.004028677474707365, -0.0034002303145825863, 0.037336379289627075, 0.03244110569357872, -0.031382668763399124, 0.021525971591472626, 0.058584511280059814, -0.04445437341928482, -0.05736730992794037, -0.03410814702510834, -0.00019814692495856434, 0.0016050211852416396, 0.009062870405614376, 0.014857815578579903, -0.007415677420794964, 0.004918426275253296, -0.0035523807164281607, 0.006555696949362755, 0.009658241644501686, -0.0034729978069663048, -0.034954894334077835, 0.01668361946940422, -0.029556864872574806, -0.0014867738354951143, 0.018310967832803726, -0.040591076016426086, 0.018840186297893524, -0.016670389100909233, -0.01230433490127325, -0.00502427015453577, -0.013329695910215378, 0.018231583759188652, -0.017742058262228966, 0.06414131075143814, 0.03281155973672867, -0.003671454731374979, 0.023285623639822006, -0.02818089723587036, 0.0015570606337860227, 0.0025485188234597445, 0.011358357034623623, 0.005305417813360691, 0.02254471741616726, 0.0028329738415777683, 0.03135620802640915, 0.027704600244760513, -0.007719977758824825, -0.04545988887548447, 0.014460901729762554, 0.002654362702742219, -0.03543119132518768, 0.030403615906834602, 0.01109374687075615, -0.004779506474733353, 0.011080516502261162, -0.029265794903039932, -0.0366748571395874, -0.009287788532674313, 0.013667073100805283, 0.00612570671364665, 0.053345248103141785, 0.00446859048679471, 0.02316654846072197, 0.013693533837795258, 0.011186360381543636, 0.005656024906784296, -0.02279609628021717, 0.0024344059638679028, -0.018826955929398537, -0.01839035004377365, 0.000984843005426228, 0.01409044861793518, -0.007845667190849781, -0.0159162525087595, 0.03606625646352768, -0.0049614254385232925, 0.03135620802640915, -0.02601110003888607, -0.004190750885754824, 0.05202220007777214, 0.008163198828697205, 0.00979716144502163, -0.03516658395528793, 0.01973985880613327, -0.002899126149713993, -0.012992319650948048, 0.020586607977747917, 0.02321947179734707, 0.017861131578683853, -0.03839481621980667, -0.007375985849648714, -0.03146205097436905, 0.0041940584778785706, 0.005536950659006834, 0.046147871762514114, -0.00045355697511695325, -0.0015537530416622758, 0.004475205671042204, -0.012006649747490883, -0.002975201467052102, -0.0036185330245643854, -0.019554631784558296, -0.016643928363919258, 0.00511688319966197, 0.016286706551909447, 0.05398030951619148, 0.010650526732206345, 0.001027841935865581, -0.004117982927709818, -0.003582149278372526, -0.03947971761226654, -0.00971777830272913, -0.004567819181829691, 0.029159951955080032, -0.0019581092055886984, -0.044745441526174545, 0.0022706789895892143, 0.015400264412164688, 0.02497912384569645, -0.0040749842301011086, -0.011589889414608479, 0.005970248486846685, -0.0015215037856251001, 0.007607519160956144, 0.009195175021886826, 0.030139004811644554, -0.04516881704330444, 0.011517122387886047, 0.030456537380814552, -0.03596040979027748, -0.004372669383883476, -0.0002379416982876137, -0.013891991227865219, 0.0072106048464775085, -0.0008748646941967309, 0.026871079578995705, -0.012310950085520744, 0.05472121387720108, -0.007746438961476088, 0.027334146201610565, -0.04040584713220596, 0.010848983190953732, -0.00023132645583245903, -0.033764153718948364, -0.030033161863684654, 0.04143782705068588, 0.004478513263165951, -0.03175312280654907, 0.007144452538341284, 0.027598755434155464, -0.03508720174431801, 0.00852042157202959, -0.00820950511842966, -0.015109194442629814, 0.027916288003325462, -0.0002989258791785687, -0.012449869886040688, 0.01595594361424446, -0.024119142442941666, -0.07028024643659592, 0.03347308188676834, 0.002032530726864934, -0.044533755630254745, -0.012416793964803219, -0.03352600708603859, -0.013931682333350182, -0.01611470989882946, 0.019356174394488335, -0.04736507311463356, 0.0014851200394332409, -0.002527019241824746, 0.001564502832479775, -0.030377153307199478, -0.0006842632428742945, -0.006985687185078859, 0.028101513162255287, -0.005272341426461935, -0.018430041149258614, -0.015148885548114777, 0.013852300122380257, -0.020441072061657906, -0.030430076643824577, -0.01324369851499796, -0.008302118629217148, -0.02947748266160488, 0.0032348493114113808, 0.007435522973537445, -0.020957060158252716, -0.008295503444969654, -0.0059074037708342075, 0.02643447555601597, 0.003611917607486248, -0.03770683333277702, -0.03778621554374695, -0.03405522555112839, 0.025892024859786034, 0.04411038011312485, -0.022240417078137398, 0.011278973892331123, -0.000607774592936039, -0.010498376563191414, 0.05768483877182007, 0.058743275701999664, 0.02398683875799179, -0.009479629807174206, -0.019356174394488335, -0.001834073569625616, -0.009181944653391838, -0.003196811769157648, -0.03159435838460922, 0.023761920630931854, 0.01721283793449402, -0.04159659147262573, -0.02233302965760231, -0.01932971365749836, 0.0022177572827786207, 0.006016555242240429, 0.04514235630631447, 0.021181978285312653, -0.019157717004418373, 0.014474132098257542, -0.010035309940576553, -0.003592072054743767, 0.019938314333558083, -0.039717864245176315, -0.021221671253442764, -0.023973608389496803, -0.024066220968961716, 0.04794721677899361, 0.00901656411588192, 0.020613068714737892, -0.0019184178672730923, 0.01533411256968975, -0.004630663897842169, 0.04186119884252548, 0.03196480870246887, -0.020507225766777992, -0.0052591110579669476, -0.007620749529451132, -0.011947112157940865, -0.008778415620326996, 0.021102596074342728, 0.0032927326392382383, -0.023960378021001816, -0.02098352275788784, 0.036463167518377304, -0.023603154346346855, 0.005861097015440464, 0.014077217318117619, 0.013931682333350182, -0.0032381569035351276, 0.0219758078455925, -0.025376036763191223, -0.013918451964855194, -0.012350642122328281, 0.008269042707979679, -0.023391466587781906, 0.02327239327132702, 0.040908604860305786, -0.00648954464122653, 0.013137854635715485, 0.0010708409827202559, 0.004749738145619631, 0.014937197789549828, -0.01163619663566351, -0.02823381870985031, 0.011166514828801155, 0.0025104812812060118, -0.028260279446840286, 0.011682502925395966, 0.006238165777176619, -0.026196327060461044, -0.009863314218819141, 0.0367807000875473, -0.017900822684168816, 0.03839481621980667, 0.003985678311437368, -0.0024939430877566338, 0.007303218357264996, 0.02414560317993164, 0.004445437341928482, -0.0069459956139326096, -0.00893718097358942, -0.02134074456989765, -0.00105926429387182, 0.012066186405718327, -0.0029454329051077366, -0.0010369379306212068, 0.006525928154587746, 0.00585448183119297, 0.002462520729750395, 0.0046902010217309, 0.012079416774213314, -0.016247013583779335, 0.07308510690927505, 0.0021896425168961287, -0.005983478855341673, -0.010022079572081566, -0.0033969227224588394, 0.023021014407277107, -0.02284901775419712, 0.01419629156589508, -0.04143782705068588, 0.009413477964699268, -0.01715991646051407, 0.013276774436235428, -0.01973985880613327, -0.009757470339536667, 0.01710699498653412, 0.009234866127371788, -0.01984570175409317, 0.015413494780659676, -0.0019498402252793312, -0.006635079625993967, 0.014831354841589928, -3.509174712235108e-05, -0.05400677025318146, 0.034637365490198135, -0.012767401523888111, -0.013382618315517902, -0.021274592727422714, 0.006357239559292793, -0.025217272341251373, -0.01409044861793518, -0.0017513831844553351, -0.018377119675278664, -0.030377153307199478, -0.025296654552221298, 0.01828450709581375, -0.013905221596360207, -0.06811045110225677, 0.009062870405614376, 0.009883159771561623, 0.007660441100597382, 0.023047475144267082, -0.007336294278502464, -0.012423409149050713, 0.011748655699193478, -0.008024279028177261, 0.0014321980997920036, 0.0026295555289834738, -0.015307650901377201, 0.008097046054899693, -0.007025378290563822, -0.02586556412279606, -0.015479647554457188, 0.013290004804730415, -0.020811526104807854, 0.01596917398273945, -0.006380393169820309, 0.003165389411151409, 0.015347342938184738, 0.024370521306991577, -0.023761920630931854, -0.010187460109591484, 0.009618550539016724, -0.011794961988925934, 0.027916288003325462, 0.034901972860097885, -0.02647416666150093, 0.024370521306991577, 0.02160535380244255, 0.0024112528190016747, 0.04524819925427437, -0.0048423511907458305, 0.0015396956587210298, -0.01479166280478239, 0.012105878442525864, 0.016657158732414246, -0.012158799916505814, 0.0124366395175457, 0.037389300763607025, -0.01559872180223465, 0.055991340428590775, -0.018165431916713715, 0.012681403197348118, -0.016048558056354523, 0.022624099627137184, 0.021367205306887627, 0.03746868669986725, 0.005527027882635593, -0.0020341845229268074, -0.009810391813516617, 0.016458701342344284, -0.020136771723628044, 0.003889757441356778, 0.027334146201610565, -0.010240382514894009, -0.0011394739849492908, -0.027969209477305412, 0.02595817856490612, -0.03016546741127968, 0.0029255871195346117, 0.0005651890533044934, -0.0014900814276188612, -0.024383751675486565, 0.04082922264933586, 0.009135638363659382, -0.0427873320877552, 0.017239298671483994, -0.033605389297008514, -0.023960378021001816, 0.025931717827916145, 0.024939432740211487, -0.02767813950777054, 0.0037210690788924694, 0.012840169481933117, 0.003165389411151409, -0.008011048659682274, -0.022041959688067436, -0.050804995000362396, 0.01709376461803913, -0.00976408552378416, -0.018893107771873474, 0.01772882603108883, -0.006793845444917679, -0.0065292357467114925, 0.00198126258328557, 0.011417893692851067, -0.01137158740311861, -0.011120208539068699, -0.010240382514894009, -0.014685818925499916, 0.0038930652663111687, -0.016749773174524307, 0.009737623855471611, 0.011523737572133541, 0.019819241017103195, 0.030377153307199478, 0.0021830270998179913, 0.005593180190771818, 0.004217211622744799, -0.029371637850999832, 0.011530352756381035, 0.0073892162181437016, -0.025667106732726097, -0.00497465580701828, 0.00681369099766016, -0.008943796157836914, 0.019501710310578346, -0.01979278028011322, -0.007554597221314907, 0.03540473058819771, -0.018535885959863663, 0.0061223991215229034, -0.010438838973641396, 0.007435522973537445, 0.010326379910111427, 0.0034399216528981924, -0.0008422019891440868, 0.0010749754728749394, -0.008586573414504528, 0.030403615906834602, 0.022518256679177284, 0.014183061197400093, -0.01901218295097351, -0.02471451461315155, 0.008407962508499622, 0.04461313784122467, 0.007812591269612312, -0.009975772351026535, 0.0011378201888874173, -0.0037971441633999348, -0.025825873017311096, -0.021076135337352753, 0.027704600244760513, 0.0038765270728617907, -0.03461090475320816, -0.025667106732726097, -0.002479058923199773, 0.015479647554457188, -0.00044735518167726696, -0.001845650258474052, 0.0038765270728617907, -0.0036979157011955976, -0.02569356933236122, 0.038050826638936996, -0.006344009190797806, -0.013415694236755371, -0.00906948558986187, 0.01137158740311861, 0.0221874937415123, -0.004561203997582197, 0.0019299944397062063, -0.012555713765323162, 0.00047629684559069574, -0.02871011570096016, -0.00899010244756937, -0.000186673627467826, -0.008493959903717041, -0.0057618687860667706, -0.009592088870704174, -0.017027612775564194, 0.03410814702510834, -0.013514922931790352, -0.011378202587366104, 0.011973573826253414, 0.007184144109487534, 0.026513857766985893, 0.003945987205952406, 0.006198474206030369, -0.012555713765323162, -0.011239282786846161, 0.025481881573796272, 0.02699015475809574, -0.013104778714478016, -0.025587724521756172, 0.02089090831577778, 0.012396948412060738, -0.010485146194696426, 0.009466399438679218, -0.024277908727526665, 0.011715578846633434, 0.006046323571354151, -0.021208439022302628, 0.011404663324356079, 0.004954810254275799, 0.000415932823671028, -0.050646230578422546, 0.03680716082453728, -0.005364954471588135, -0.009387017227709293, 0.006463083438575268, 0.015664873644709587, 0.020904138684272766, -0.01668361946940422, -0.016723310574889183, 0.0015380418626591563, 0.03188542649149895, 0.01637931913137436, 0.01751714013516903, -0.024860048666596413, -0.01673654094338417, 0.006846766918897629, -0.043713465332984924, -0.004918426275253296, 0.0034829205833375454, 0.004776198882609606, 0.0053186481818556786, 0.06832213699817657, -3.338625901960768e-05, 0.006052939221262932, -0.03648963198065758, -0.004481820855289698, 0.024277908727526665, 0.025362806394696236, 0.006939380429685116, -0.023722229525446892, -0.0027833597268909216, -0.004471898078918457, 0.02757229469716549, -0.033446621149778366, 0.060595542192459106, 0.04037938639521599, -0.026209557428956032, -0.02631540037691593, 0.024807127192616463, 0.007700132206082344, 0.005884250625967979, 0.009982387535274029, -0.012707863934338093, 0.001275086309760809, -0.002416214207187295, -0.03357892856001854, -0.010008849203586578, -0.022663790732622147, -0.017424525693058968, -0.015069502405822277, -0.0003241464728489518, 0.007514905650168657, -0.005163189955055714, 0.020269077271223068, 0.023775150999426842, -0.01648516207933426, 0.03633086383342743, -0.025018814951181412, 0.004028677474707365, -0.004614125471562147, 0.000936882512178272, -0.038791730999946594, -0.01170896366238594, 0.009274558164179325, 0.010055155493319035, 0.033182013779878616, -0.004154366906732321, -0.034584444016218185, 0.025878794491291046, -0.03516658395528793, -0.03259987384080887, -0.03421398997306824, 7.912440196378157e-05, -0.05233972892165184, 0.03217649832367897, 0.016564546152949333, -0.0009550743852742016, 0.0010038617765530944, -0.01039253268390894, -0.015889791771769524, 0.02606402151286602, 0.026130173355340958, -0.03352600708603859, 0.032414644956588745, 0.02347085066139698, -0.000475469947559759, 0.012860015034675598, 0.015148885548114777, -0.008871029131114483, -0.02767813950777054, -0.037733294069767, 0.03156789764761925, -0.007078300230205059, 0.011563428677618504, -0.005556796677410603, 0.03659547492861748, -0.0183374285697937, 0.008083815686404705, 0.003529227338731289, 0.03995601460337639, 0.04762968420982361, 0.013905221596360207, -0.011814807541668415, 0.0028544734232127666, -0.013402463868260384, -0.002586556365713477, 0.020441072061657906, -0.01215218473225832, -0.001584348501637578, 0.02968917042016983, -0.0060033248737454414, -0.014765202067792416, 0.0016199053497985005, 0.024582209065556526, 0.012621866539120674, -0.030906373634934425, -0.002938817720860243, 0.01835065893828869, -0.014235983602702618, -0.01792728342115879, -0.04114675521850586, 0.008335194550454617, -0.012661557644605637, 0.0011651080567389727, -0.018694650381803513, -0.0010509953135624528, 0.031435590237379074, 0.02316654846072197, -0.01106067094951868, -0.015585491433739662, 0.026871079578995705, 0.014262444339692593, 0.016551315784454346, -0.027387067675590515, -0.025111427530646324, 0.0017530369805172086, -0.015678104013204575, 0.017914053052663803, 0.031435590237379074, 0.0001750969677232206, 0.02398683875799179, -0.02828674018383026, 0.007547982037067413, 0.0019283406436443329, -0.0038798346649855375, -0.020996753126382828, -0.005963633302599192, 0.044480834156274796, 0.024105912074446678, 0.005447645206004381, -0.015982404351234436, -0.022888708859682083, -0.010273458436131477, -0.017186377197504044, 0.01487104594707489, -0.006516005378216505, 0.0370982326567173, -0.018416810780763626, -0.007256911601871252, -0.022002268582582474, 0.014447670429944992, 0.007686901837587357, -0.010319764725863934, 0.014897506684064865, 0.010432223789393902]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
") in this extended state space to show that K-sequence SMC sampling yields an unbiased estimator of Zσ, for
example Zσ=EqSMC(S)[˜σSMC(S)
qSMC(S)](as in Eq. (8)). Our end goal is to use this probabilistic interpretation to derive the lower
and upper bounds on logZσin Prop. 5.1, following Brekelmans et al. (2022) App. A.
We define the extended state space proposal and target distributions below, noting that our bounds will require sampling
from normalized σSMC(S)orqSMC(S), and evaluating ˜σSMC(S)andqSMC(S). We summarize the algorithm for sampling
σSMC(S)in Alg. 2, using concatenation notation for simplicity instead of the probabilistic interpretation using index histories
in the text.
Single-Sequence Target and Proposal We construct our importance sampling bounds with the goal of estimating the (log)
partition function and sampling from a target distribution σ(s1:T) = ˜σ(s1:T)/Zσ. We leverage a sequence of intermediate
target distributions, {πt(s1:t) =1
Zt˜πt(s1:t)}T
t=1over partial sequences, with the final target πT(s1:T) =σ(s1:T)and
ZT=Zσ. We assume ˜π0(s0) = 1 for all prompts with Z0= 1. Finally, our bounds and sampling procedures also depend
on a given set of proposal distribution {q(st|s1:t−1)}T
t=1, as in Sec. 2.2.
Extended State Space Random Variables Consider an extended state space Scontaining KT tokens {sk
t}T,K
t=1,k=1with
sk
t∈ V andKT indexing random variables {ωk
t}T,K
t=1,k=1withωk
t∈[1, K], to represent the results of resampling (Eq. (7)),
S:=
sk
t, ωk
t	T,K
t=1,k=1(73)
For ease of notation (and similarly to Maddison et al. (2017); Andrieu et al. (2010)), we call attention to our use of recursive
backtracking index operations to collect sequences {s1:t}based on the results of resampling {ωk
t}. We use listsof index
histories to construct sequences of tokens, with two recursive definitions of histories. Letting +indicate appending of lists,
hk
0:= [[[ ]]]∀k, hk
t:=hωk
t
t−1+ [[[ωk
t]]]
¯hk
0:= [[[ ]]]∀k, ¯hk
t:=hk
t−1+ [[[k]]](Index Notation)
For example, the history hk
t−1will be used to construct prefix sequences shk
t−1
1:t−1(i.e. lists of tokens) for sampling a next
token sk
t. We denote sequences of tokens with the index history in the superscript and also expand the definition for clarity,
shk
t
1:t:=shωk
t
t−1
1:t−1+ [[[sωk
t
t]]] = [ [[shωk
t
t−1[1]
1 , ..., shωk
t
t−1[t−1]
t−1 , sωk
t
t]]] = [[[sω···ωk
t
1
1 , ..., sωωωk
t
t−1
t−2
t−2, sωωk
t
t−1
t−1, sωk
t
t]]]
s¯hk
t
1:t:=shk
t−1
1:t−1+ [[[sk
t]]](Sequence Notations)
In the second line, we define s¯hk
t
1:tas a sequence of length twhich concatenates the prefix shk
t−1
1:twith next token sk
t. The
notation s¯hk
t
1:trepresents partial sequences before resampling. By contrast, we will use the notation shk
t
1:tin the first line of
Eq. (Sequence Notations) to refer to sequences after resampling.
Consider the sequence s¯hi
t
1:tin a particular index i∈[1, K]before resampling. Resampling at time tmay result in choosing
ωk
t=ifor some k","[0.06834211200475693, -0.006713532842695713, 0.04336802288889885, 0.02582518942654133, -0.030944494530558586, -0.007844099774956703, -0.00654204236343503, -0.003594947513192892, -0.053149331361055374, 0.019549909979104996, 0.027489280328154564, -0.01780959963798523, -0.010740382596850395, 0.017720676958560944, 0.02273835986852646, -0.00514471298083663, -0.004341248422861099, 0.003540959907695651, 0.01032753475010395, 0.012340959161520004, -0.006675423588603735, -0.02539328671991825, -0.002775604370981455, 0.017187152057886124, 0.0024294478353112936, -0.04433345049619675, 0.0391252227127552, 0.0076281484216451645, 0.04354586452245712, 0.004150703549385071, 0.05731591209769249, -0.03734680637717247, -0.0031535185407847166, -0.029623383656144142, -0.017530132085084915, 0.08485600352287292, -0.03112233802676201, 0.02848011441528797, -0.05116766318678856, 0.012887188233435154, -0.007113676983863115, -0.024694621562957764, -0.052641209214925766, 0.01951180025935173, 0.020032623782753944, 0.04273287579417229, -0.028835797682404518, -0.057569973170757294, 0.0037156259641051292, 0.03457755222916603, -0.01531981211155653, 0.04608646407723427, -0.037677083164453506, -0.001467989874072373, 0.028048211708664894, -0.038159795105457306, -0.0012194875162094831, -0.015192781575024128, 0.009641572833061218, -0.0011654997942969203, 0.05299689620733261, -0.018432045355439186, 0.006726235616952181, 0.028124431148171425, -0.035339731723070145, 0.006345145870000124, -0.004563550930470228, 0.03561919927597046, -0.023309996351599693, 0.04570537433028221, -0.029953662306070328, 0.03066502884030342, 0.009673330932855606, -0.01267123781144619, -0.02776874601840973, -0.010162395425140858, 0.016412269324064255, 0.01448141410946846, 0.01775878667831421, -0.022611331194639206, 0.003626704914495349, -0.006402309518307447, 0.0602630078792572, -0.019321255385875702, -0.01671714149415493, -0.035390544682741165, -0.0032583181746304035, 0.005792565643787384, -0.025748969987034798, -0.014646553434431553, -0.0668177530169487, 0.04410479962825775, -0.058738648891448975, -0.001144063426181674, 0.03246885538101196, -0.001684734714217484, 0.02177293226122856, -0.015141969546675682, 0.012023384682834148, 0.01018145028501749, 0.02254781499505043, -0.043749112635850906, -0.013833560980856419, -0.08089267462491989, 0.04852544143795967, 0.019422879442572594, -0.010892817750573158, 0.02451677992939949, -0.03137639909982681, -0.017936628311872482, 0.021036159247159958, -0.027540093287825584, -0.02220483496785164, 0.06239711120724678, 0.03338347002863884, -0.021366437897086143, -0.022649439051747322, -0.013973294757306576, -0.019524503499269485, 0.03661002963781357, 0.00572905084118247, -0.0049287620931863785, 0.008644388057291508, 0.01061970368027687, -0.020985348150134087, -0.02009613811969757, 0.033078599721193314, -0.07586228847503662, -0.02891201712191105, 0.0371689647436142, 0.0427582822740078, -0.015561169013381004, -0.04395236074924469, -0.010098881088197231, -0.016120100393891335, -0.022001586854457855, -0.00639595789834857, 0.04166582226753235, -0.0059227715246379375, 0.008860338479280472, -0.015459544956684113, -0.047661636024713516, -0.0060212197713553905, 0.006157776806503534, -0.020375603809952736, -0.00779328728094697, -0.06381984800100327, 0.04634052515029907, -0.012118657119572163, 0.00918426550924778, 0.006916780490428209, -0.021150486543774605, -0.025240851566195488, 0.008739660494029522, 0.01451952289789915, -0.07469361275434494, -0.044892385601997375, 0.023437025025486946, -0.024364344775676727, 0.013401659205555916, 0.019397472962737083, 0.046543773263692856, 0.03302778676152229, 0.01028942596167326, -0.005097076762467623, -0.007926668971776962, -0.04021768271923065, 0.0430123396217823, -0.03998902812600136, -0.023945145308971405, 0.0026326957158744335, -0.03622893989086151, -0.03061421774327755, -0.01591685228049755, 0.029343917965888977, 0.002081703394651413, -0.0345013327896595, -0.009463731199502945, -0.025228148326277733, -0.006421363912522793, 0.00845384318381548, 0.03732139989733696, -0.028632549569010735, -0.01055618841201067, 0.005951352883130312, 0.007132731378078461, 0.009235077537596226, 0.016856873407959938, 0.03396780788898468, -0.006138722412288189, -0.020451821386814117, 0.029775820672512054, 0.04499400779604912, -0.0284293033182621, -0.02571086212992668, -0.06478527188301086, 0.03770248964428902, 0.0799272432923317, 0.043113965541124344, -0.01589144580066204, 0.0027057379484176636, -0.006246697623282671, -0.013007867150008678, 0.02531706914305687, -0.023564055562019348, 0.052133090794086456, -0.0059735835529863834, 0.005541681312024593, -0.032011546194553375, 0.02082020789384842, 0.006592854391783476, 0.02430082857608795, 0.06234629824757576, 0.00750111835077405, -0.022712955251336098, 0.012283796444535255, -0.07977480441331863, 0.016247130930423737, 0.005605196580290794, 0.04273287579417229, -0.003113821614533663, 0.04499400779604912, 0.05010061338543892, 0.009279537945985794, 0.002000721637159586, 0.02252241037786007, 0.03460295870900154, -0.003347239224240184, 0.01194081548601389, -0.018787728622555733, 0.007710718084126711, 0.060415443032979965, -0.0031805122271180153, -0.03193533048033714, -0.048144351691007614, -0.001422735396772623, -0.0449431948363781, -0.027463875710964203, -0.019346661865711212, -0.07372818142175674, -0.018775027245283127, 0.03800735995173454, 0.026904942467808723, 0.02116318978369236, 0.022751063108444214, 0.013033272698521614, -0.010880115441977978, -0.028505520895123482, -0.014887910336256027, 0.00606250436976552, -0.026422228664159775, -0.03683868423104286, -0.042072318494319916, 0.01187094859778881, -0.03617813065648079, -0.016145506873726845, -0.004195163957774639, 0.03015691041946411, -0.023170262575149536, 0.003344063414260745, -0.019981810823082924, -0.06534420698881149, -0.029953662306070328, 0.012137711979448795, -0.007056513801217079, -0.021607793867588043, 0.0150657519698143, -0.02361486665904522, 0.05025304853916168, -0.02952175959944725, -0.022090507671236992, 0.019130710512399673, 0.0012663297820836306, 0.006789750885218382, -0.038108985871076584, -0.03229101374745369, -0.007335979491472244, 0.027616310864686966, -0.05129469186067581, 0.0031122337095439434, 0.01028942596167326, -0.062143050134181976, 0.047051891684532166, -0.012093250639736652, 0.04077661409974098, -0.033637531101703644, 0.03691490367054939, 0.04961789771914482, 0.03163045644760132, -0.048195160925388336, 0.04141176491975784, 0.003464741865172982, -0.00851735845208168, -0.043139372020959854, 0.013820858672261238, 0.0025818836875259876, 0.006865968927741051, -0.015078455209732056, -0.017123637720942497, -0.0073232767172157764, 0.06387066096067429, -0.02342432178556919, 0.03460295870900154, -0.015599277801811695, -0.0028867556247860193, -0.0044746301136910915, 0.008606279268860817, 0.03229101374745369, -0.046010248363018036, 0.02305593527853489, 0.03284994512796402, -0.039836592972278595, -0.02339891716837883, 0.01076578814536333, 0.019626127555966377, -0.04783947765827179, 0.07550659775733948, -0.03190992400050163, -0.013109490275382996, -0.043215587735176086, 0.0002699386386666447, -0.036508407443761826, 0.02888661064207554, -0.02169671468436718, 0.034145649522542953, -0.015091157518327236, -0.029293106868863106, 0.010549836792051792, -0.02179833874106407, -0.0037600863724946976, 0.04247881472110748, -0.024847058579325676, 0.0036489353515207767, 0.004773150198161602, -0.0020023095421493053, -0.03889657184481621, -0.01145810168236494, 0.05068495124578476, -0.0045000361278653145, 0.06300685554742813, -0.08185809850692749, -0.01235366240143776, -0.027590904384851456, -0.016539299860596657, 0.021061565726995468, 0.01139458641409874, -0.012112305499613285, 0.023792710155248642, 0.06056787818670273, -0.01584063470363617, 0.007488415576517582, 0.01363031379878521, 0.04695026949048042, -0.03056340478360653, 0.027641717344522476, -0.007475712336599827, 0.02507571130990982, -0.049821145832538605, -0.045375097543001175, -0.017022013664245605, -0.03549216687679291, 0.014659255743026733, 0.04783947765827179, -0.027006566524505615, 0.015954962000250816, 0.021861854940652847, -0.03272291645407677, -0.026498448103666306, -0.00029335980070754886, 0.0031646336428821087, 0.02563464269042015, 0.00467152614146471, 0.016463080421090126, 0.00907628983259201, -0.03325644135475159, -0.005964056123048067, 0.004134824965149164, -0.004480981267988682, 0.029089858755469322, 0.04285990446805954, -0.00043507758527994156, 0.019206928089261055, -0.019448285922408104, -0.04283449798822403, 0.019842077046632767, -0.0017927101580426097, -0.02891201712191105, -0.011635943315923214, -0.04115770384669304, 0.009565355256199837, 0.010098881088197231, -0.000619667989667505, -0.010842005722224712, 0.029140669852495193, 0.014798988588154316, 0.007183543406426907, -0.03249426186084747, 0.04006524756550789, 0.036559220403432846, 0.04448588937520981, -0.039760373532772064, -0.011737567372620106, -0.014113027602434158, -0.0261173564940691, -0.039760373532772064, 0.006764344871044159, 0.04128473252058029, 0.04164041578769684, 0.026320604607462883, 0.05838296562433243, 0.014074917882680893, -0.014926019124686718, 0.035898663103580475, -0.005700469017028809, 0.04618808999657631, 0.013998700305819511, -0.011356477625668049, 0.02412298694252968, 0.0262443870306015, 0.06193980202078819, 0.0011456513311713934, -0.032545071095228195, 0.0020277155563235283, -0.029902849346399307, -0.0013965355465188622, -0.007437603548169136, -0.0035123780835419893, -0.03061421774327755, 0.038134392350912094, -0.052641209214925766, -0.0014910140307620168, 0.04852544143795967, 0.021633200347423553, -0.020108841359615326, -0.03292616084218025, -0.0070374589413404465, 0.04753460735082626, -0.025596534833312035, -0.0035282569006085396, -0.041462574154138565, 0.006783399265259504, -0.0013885961379855871, -0.021036159247159958, 0.016856873407959938, -0.00809180736541748, 0.0020023095421493053, -0.021785635501146317, -0.07510010898113251, -0.0028041861951351166, -0.0011980511480942369, 0.013909779489040375, -0.027463875710964203, 0.035390544682741165, 0.006650017574429512, 0.01333814486861229, -0.058738648891448975, 0.05129469186067581, -0.04555293917655945, 0.01868610456585884, -0.020794803276658058, -0.002713677240535617, -0.004868422634899616, 0.012023384682834148, 0.015853337943553925, 0.0074058459140360355, 0.00016245940059889108, -0.010130638256669044, 0.01308408472687006, 0.002594586694613099, 0.037143558263778687, -0.004728689789772034, -0.04410479962825775, 0.03351049870252609, -0.004776326008141041, 0.00680245365947485, 0.008415734395384789, 0.06442958861589432, -0.051040634512901306, 0.025405989959836006, 0.0217475276440382, 0.01554846577346325, -0.047560013830661774, -0.0016815589042380452, 0.058179717510938644, 0.028657956048846245, 0.05116766318678856, 0.05253958702087402, -0.04064958170056343, 0.02371649071574211, -0.00886669009923935, -0.005281270015984774, -0.020743990316987038, 0.02444056235253811, -0.013414362445473671, 0.00225954526104033, -0.011413641273975372, 0.012588667683303356, -0.007837748154997826, -0.015523059293627739, 0.01664092391729355, 0.0272098146378994, -0.03008069097995758, -0.008968314155936241, 0.05380988493561745, -0.0056623597629368305, 0.005008155945688486, 0.010124286636710167, -0.006808805279433727, 0.019346661865711212, 0.04743298143148422, -0.037677083164453506, -0.02252241037786007, 0.001428292947821319, -0.018724214285612106, 0.00988928135484457, -0.011057957075536251, -0.0006172861321829259, -0.04715351760387421, -0.0010781666496768594, 0.00934305228292942, 0.019918296486139297, 0.005471814889460802, -0.046492960304021835, 0.0020023095421493053, 0.01924503780901432, -0.03239263594150543, 0.013858967460691929, -0.08511006832122803, 0.01267123781144619, -0.04379992559552193, 0.009565355256199837, -0.013871670700609684, -0.005074846558272839, 0.04639133810997009, 0.020807504653930664, 0.008911150507628918, 0.007120028603821993, 0.014900612644851208, 0.023335400968790054, 0.021175893023610115, -0.02318296581506729, -0.024211907759308815, -0.005201876163482666, -0.01948639377951622, -0.007545578759163618, -0.03554297983646393, 0.025837890803813934, 0.00709462258964777, 0.003048718674108386, -0.008593576028943062, -0.033154815435409546, -0.010861060582101345, 0.04402858018875122, -0.03437430411577225, -0.050456296652555466, 0.006361024454236031, -0.014113027602434158, 0.04186907038092613, -0.022941607981920242, -0.009057234972715378, 0.017822301015257835, -0.01473547425121069, -0.0008038614178076386, 0.006370551884174347, -0.01504034548997879, 0.030385563150048256, 0.01725066639482975, -0.004157055169343948, 0.02475813776254654, 0.05751916021108627, -0.025202741846442223, 0.0038267772179096937, 0.02675250731408596, -0.04285990446805954, -0.005700469017028809, -0.026498448103666306, -0.002732731867581606, -0.03770248964428902, -0.009381162002682686, 0.01951180025935173, -0.02672710083425045, -0.005220931023359299, 0.006310212891548872, -0.04382533207535744, -0.000557740859221667, 0.013795452192425728, -0.003166221547871828, 0.04722973331809044, -0.010549836792051792, 0.0029201009310781956, 0.02313215285539627, -0.000721291929949075, -0.01674254797399044, 0.023386213928461075, -0.04278368502855301, 0.018787728622555733, -0.0023675207048654556, 0.000856658210977912, -0.027159003540873528, -0.02585059404373169, 0.045425910502672195, 0.012309201993048191, -0.01951180025935173, -0.026003031060099602, -0.06260035932064056, 0.03803276643157005, -0.046467553824186325, 0.010422807186841965, 0.024592997506260872, 0.007875856943428516, 0.017072824761271477, 0.021036159247159958, -0.006345145870000124, -0.010721327736973763, -0.013071381486952305, -0.005659184418618679, 0.005846553482115269, -0.018571779131889343, 0.054216381162405014, 0.01693309284746647, 0.019041789695620537, -0.030538000166416168, 0.02230645902454853, -0.0074312519282102585, 0.008803175762295723, 0.03284994512796402, -0.009794008918106556, -0.029318511486053467, -0.014494117349386215, -0.012906243093311787, 0.01885124482214451, -0.0230813417583704, 0.012595019303262234, 0.016005773097276688, -0.013706531375646591, 0.011413641273975372, -0.004023673478513956, 0.04413020238280296, 0.04110689088702202, -0.009120750240981579, 0.027743341401219368, -0.022560518234968185, 0.026295199990272522, -0.032113172113895416, 0.00797112938016653, 0.033078599721193314, -0.0025961745996028185, 0.04517184942960739, -0.0011313605355098844, -0.014849800616502762, -0.033129408955574036, -0.02794658951461315, 0.019041789695620537, -0.034755393862724304, 0.032646697014570236, -0.023005124181509018, 0.050989821553230286, -0.01143269520252943, 0.004128473345190287, -0.03124936670064926, -0.02038830704987049, 0.006033922545611858, -0.023005124181509018, -0.00830775871872902, 0.02952175959944725, 0.039836592972278595, 0.03284994512796402, 0.017974738031625748, -0.01110241748392582, -0.013566798530519009, -0.028251459822058678, 0.0071263802237808704, 0.028251459822058678, -0.01396059151738882, 0.024072175845503807, 0.017085528001189232, -0.04077661409974098, -0.015091157518327236, 0.003950631245970726, 0.010391050018370152, -0.008060050196945667, 0.012328256852924824, -0.022827282547950745, 0.022141320630908012, -0.015421436168253422, -0.006561096757650375, 0.03607650473713875, -0.024643810465931892, -0.0043730060569942, 0.002115048700943589, -0.034806206822395325, 0.03277372568845749, 0.022636737674474716, -0.0031741608399897814, -0.004658823367208242, -0.01535792089998722, 0.0006391194183379412, 0.040852829813957214, -0.005347960628569126, -0.02252241037786007, -0.017720676958560944, 0.025482207536697388, -0.0434950552880764, -0.011362829245626926, -0.010225910693407059, -0.01946098729968071, -0.035949476063251495, 0.048677876591682434, 0.02283998392522335, -0.017110934481024742, 0.013020569458603859, 0.012302850373089314, -0.02510111778974533, 0.02142995223402977, 0.013427065685391426, -0.0345013327896595, 0.018533669412136078, -0.010346589609980583, 0.002473908243700862, -0.008136267773807049, -0.021366437897086143, -0.006567448377609253, -0.07687852531671524, 0.005960880313068628, -0.01744121126830578, -0.013782748952507973, -0.029166076332330704, -0.015307108871638775, -0.001833994872868061, -0.0054305302910506725, 0.007850450463593006, 0.03630515933036804, -0.01474817655980587, -0.003744207788258791, -0.020782100036740303, 0.014417898841202259, -0.03785492479801178, 0.016844172030687332, -0.012493395246565342, -0.010048069059848785, 0.0004743774770759046, -0.026955755427479744, -0.03170667588710785, 0.01732688583433628, 0.04608646407723427, 0.007418549153953791, -0.0026533380150794983, -0.0029709129594266415, -0.009895632974803448, -0.029801225289702415, -0.04171663522720337, 0.00974319688975811, -0.022446192800998688, 0.006268927827477455, 0.05060873180627823, -0.018787728622555733, -0.009463731199502945, -0.0026390471030026674, -0.010816600173711777, 0.0233226977288723, 0.019549909979104996, 0.0313509926199913, -0.038667917251586914, 0.04108148440718651, 0.01421465165913105, -0.021010752767324448, -0.01890205591917038, 0.02009613811969757, 0.015370624139904976, 0.011007145047187805, 0.010575243271887302, 0.02616816945374012, -0.008726957254111767, 0.016844172030687332, 0.06666531413793564, 0.006218115799129009, 0.004766799043864012, -0.004280909430235624, -0.012696643359959126, 0.0069040777161717415, 0.00550992414355278, -0.02009613811969757, 0.023259183391928673, -0.021633200347423553, -0.038744132965803146, -0.013452471233904362, -0.013198412023484707, -0.002354817697778344, -0.017110934481024742, -0.05401313304901123, 0.00750111835077405, 0.013020569458603859, -0.02662547677755356, 0.00797112938016653, -0.024478670209646225, 0.015802524983882904, -0.015993069857358932, -0.10401212424039841, -0.030893683433532715, 0.043622083961963654, 0.02560923807322979, 0.03772789612412453, -0.017923925071954727, 0.012283796444535255, -0.003931576851755381, 0.002688271226361394, -0.0345013327896595, -0.027667121961712837, 0.01561198104172945, -0.0038045470137149096, -0.028607144951820374, 0.0023675207048654556, -0.023780006915330887, -0.04133554548025131, 0.024364344775676727, -0.01817798614501953, -0.0101433414965868, 0.00753287598490715, 0.0335359051823616, 0.0011202453169971704, 0.037143558263778687, -0.017669865861535072, -0.0312239620834589, -0.00036163837648928165, 0.02555842511355877, -0.01006077229976654, 0.022509707137942314, 0.021811041980981827, -0.004271382000297308, 0.002302417764440179, 0.03729599341750145, -0.028759580105543137, -0.0009328761952929199, -0.005900541320443153, 0.01815257966518402, 0.011362829245626926, -0.006113316398113966, 0.010975387878715992, -0.047661636024713516, 0.0488303117454052, 0.004296788014471531, 0.026447635143995285, -0.05253958702087402, 0.00976860336959362, 0.005109779536724091, -0.0007514615426771343, 0.006256225053220987, -0.007710718084126711, 0.006713532842695713, 0.012836376205086708, 0.001659328700043261, 0.025964921340346336, 0.006430891342461109, 0.007672608830034733, -0.012582316063344479, 0.00077210390008986, 0.03831223398447037, -0.025405989959836006, 0.03965875133872032, 0.06453121453523636, -0.043190181255340576, -0.037677083164453506, -0.02531706914305687, -0.00991468783468008, 0.005910068284720182, 0.0366862490773201, -0.0002963370643556118, 0.010454564355313778, 0.012226632796227932, -0.024720028042793274, 0.008682496845722198, 0.009990905411541462, 0.025304365903139114, -0.016310645267367363, 0.005354312248528004, -0.028276866301894188, 0.004766799043864012, 0.008002886548638344, -0.04745838791131973, 0.029115263372659683, -0.006205413024872541, -0.00425867922604084, -0.009813063777983189, -0.00544323306530714, 0.020515337586402893, -0.0023230602964758873, 0.0427582822740078, 0.015802524983882904, -0.02832767926156521, 0.04133554548025131, -0.01610739715397358, -0.02412298694252968, -0.042097724974155426, -0.0027089137583971024, 0.0030773004982620478, 0.02135373465716839, 0.02792118303477764, 0.0352381095290184, 0.019079897552728653, 0.0205280389636755, -0.017962034791707993, -0.007983832620084286, 0.00099162757396698, -0.0013219054089859128, 0.01714904233813286, 0.015269000083208084, 0.00724070705473423, 0.026396824046969414, -0.015726307407021523, -0.050456296652555466, -0.03295156732201576, 0.018863948062062263, 0.016920389607548714, 0.04514644294977188, -0.028632549569010735, 0.0004807289515156299, -0.007342331111431122, -0.01471006777137518, 0.002856585895642638, -0.02123940736055374, 0.01589144580066204, -0.004623889923095703, 0.007443955168128014, 0.01473547425121069, 0.04214853793382645, -0.03297697380185127, -0.006954889744520187, 0.028048211708664894, 0.015154672786593437, 0.021950775757431984, -0.009323998354375362, -0.003820425597950816, 0.0349840484559536, 0.02118859626352787, 0.0026501622051000595, -0.029597977176308632, 0.01664092391729355, -0.026981161907315254, -0.02728603221476078, 0.008695200085639954, 0.02840389683842659, -0.021836448460817337, -0.006592854391783476, -0.008847636170685291, -0.00411894591525197, -0.002583471592515707, 0.021099673584103584, 0.032621290534734726, 0.009946445003151894, 0.017047418281435966, -0.014328978024423122, 0.0065102847293019295, -0.005659184418618679, -0.007228004280477762, -0.015205484814941883, 0.002380223711952567, 0.024770839139819145, 0.032087765634059906, 0.05939920246601105, -0.001106748473830521, 0.003915698267519474, -0.00668812682852149, -0.010861060582101345, -0.02893742173910141, 0.0006621436332352459, 0.002015012549236417, 0.021328328177332878, 0.013211114332079887, -0.05472450330853462, 0.0012385420268401504, 0.02087102085351944, 0.03638137876987457, -0.01267123781144619, 0.011756621301174164, -0.02196347899734974, 0.01938476972281933, 0.01418924517929554, 0.0219888836145401, 0.007786935660988092, -0.02430082857608795, 0.02004532516002655, 0.012239335104823112, -0.0101433414965868, -0.01253785565495491, 0.007590039633214474, -0.019854780286550522, 0.009216022677719593, 0.009457379579544067, 0.04293612390756607, -0.012582316063344479, 0.02837849035859108, -0.02942013554275036, 0.04715351760387421, -0.029191482812166214, -0.011331071145832539, 0.0022389027290046215, -0.025444097816944122, -0.023830818012356758, 0.07230544835329056, -0.006611908785998821, -0.017339587211608887, -0.011635943315923214, 0.04174204170703888, -0.03495864197611809, 0.014125729911029339, 0.003693395759910345, -0.006202237214893103, 0.023780006915330887, -0.024961384013295174, -0.0013600144302472472, 0.02342432178556919, -0.024770839139819145, -0.07286437600851059, 0.0012433056253939867, 0.01285543106496334, -0.04214853793382645, -0.013287332840263844, -0.015561169013381004, 0.005906892474740744, -0.017403103411197662, 0.0189528688788414, -0.02449137344956398, 0.0006792132626287639, -0.006157776806503534, 0.01072767935693264, -0.02893742173910141, 0.002939155325293541, 0.004353951662778854, 0.00025128110428340733, -0.011737567372620106, -0.0413101390004158, -0.019232334569096565, 0.03112233802676201, -0.013947888277471066, -0.022751063108444214, -0.006326091475784779, -0.015561169013381004, 0.014252760447561741, -0.00451909052208066, 0.0017418981296941638, -0.012093250639736652, 0.017682569101452827, -0.01581522822380066, 0.0217475276440382, 0.0273368451744318, -7.244676817208529e-05, -0.02997906692326069, -0.017962034791707993, 0.029242293909192085, 0.030283939093351364, -0.00959711242467165, -0.003925225231796503, -0.0005744135705754161, -0.0052336337976157665, 0.02060425840318203, 0.041056077927351, -0.009724142961204052, -0.02728603221476078, -0.024961384013295174, 0.019092600792646408, -0.01900367997586727, -0.009254131466150284, -0.03823601454496384, 0.028734173625707626, 0.017644459381699562, -0.020401010289788246, -0.012963405810296535, -0.03899819403886795, -0.006415012292563915, 0.0008383976528421044, 0.05452125519514084, 0.01535792089998722, -0.0005617105634883046, 0.006043449975550175, 0.0023055935744196177, 0.017085528001189232, -0.0013433416606858373, -0.02403406612575054, 0.00466517498716712, -0.011826488189399242, -0.03241804242134094, 0.02449137344956398, 0.0036044747103005648, 0.013706531375646591, -0.006764344871044159, 0.03124936670064926, -0.003009021980687976, 0.08084186166524887, 0.03066502884030342, -0.017339587211608887, 0.008714254014194012, -0.0076027424074709415, 0.012067845091223717, -0.017098231241106987, 0.030817465856671333, -0.0032583181746304035, -0.017403103411197662, -0.01746661774814129, 0.005119306966662407, -0.0165265966206789, -0.0033345362171530724, 0.013439768925309181, 0.02888661064207554, 0.006630963180214167, 0.022674845531582832, -0.02108697220683098, -0.026320604607462883, 0.017644459381699562, 0.012957055121660233, -0.014176541939377785, 0.03739761561155319, 0.051015228033065796, -0.003769613802433014, 0.024110283702611923, -0.0036806927528232336, 0.006399133708328009, 0.02233186550438404, -0.03493323549628258, -0.012887188233435154, 0.02191266603767872, 0.005449584685266018, -0.030410969629883766, -0.005392421502619982, 0.01264583133161068, -0.029953662306070328, -0.0262443870306015, 0.032672103494405746, -0.011064308695495129, 0.038108985871076584, 0.009870227426290512, -0.008333164267241955, -0.01951180025935173, 0.020731287077069283, -0.0012234571622684598, -0.011305665597319603, -0.003540959907695651, -0.021175893023610115, -0.02529166266322136, 0.01006077229976654, -0.018724214285612106, 0.0032519667875021696, -0.0034361600410193205, 0.0026247564237564802, -0.00819978304207325, -0.003277372568845749, -0.013414362445473671, -0.01212500873953104, 0.06163493171334267, -0.015256296843290329, -0.019715048372745514, -0.021976180374622345, -0.008180729113519192, -0.001391771831549704, -0.0012504510814324021, -0.0009273186442442238, -0.03577163442969322, 0.020934535190463066, -0.010187801904976368, 0.014367086812853813, 0.008218837901949883, 0.010905520990490913, -0.014430602081120014, 0.00030070371576584876, -0.0261173564940691, 0.0022246120497584343, 0.017644459381699562, -0.00830775871872902, 0.03544135391712189, 0.00764720281586051, -0.025405989959836006, 0.0076535544358193874, -0.0006069649825803936, -0.02614276297390461, -0.011483507230877876, 0.003798195393756032, 0.005646481178700924, -0.01168675534427166, -0.009736845269799232, -0.02225564606487751, -0.03879494592547417, -0.02167131006717682, 0.0031027065124362707, -0.021925369277596474, 0.0012044026516377926, 0.04108148440718651, 0.014544929377734661, 0.0185844823718071, 0.0161582101136446, 0.022941607981920242, 0.01270934659987688, 0.0032376758754253387, 0.0044015878811478615, -0.01831771805882454, -0.0014052687911316752, -0.0033313604071736336, 0.018914759159088135, 0.013858967460691929, -0.022192131727933884, 0.0087460121139884, 0.017161745578050613, -0.021925369277596474, 0.017364993691444397, -0.006122843362390995, 0.01610739715397358, 0.023602165281772614, 0.01392248272895813, -0.03272291645407677, -0.04407939314842224, -0.004776326008141041, -0.02526625618338585, -0.000878888473380357, 0.03381537273526192, -0.02172212116420269, 0.026574665680527687, 0.018940165638923645, 0.014354384504258633, 0.04954167827963829, -0.02193807251751423, 0.010098881088197231, -0.021252110600471497, 0.044155608862638474, 0.019448285922408104, 0.004068133886903524, -0.008726957254111767, 0.034247275441884995, -0.0033885238226503134, 0.06280360370874405, -0.0022420785389840603, 0.006611908785998821, -0.01591685228049755, 0.013782748952507973, 0.020502634346485138, 0.035415951162576675, 0.02529166266322136, 0.01578982174396515, 0.006065680179744959, 0.02425001747906208, -0.015637386590242386, -0.004122121725231409, 0.019041789695620537, -0.006821508053690195, 0.012690291740000248, -0.035847850143909454, 0.03909981995820999, -0.01807636208832264, -0.011051605455577374, -0.02507571130990982, -0.00654204236343503, -0.014151136390864849, 0.032595884054899216, 0.01554846577346325, -0.028226055204868317, 0.009927390143275261, -0.04504482075572014, -0.001400505192577839, 0.008314110338687897, 0.012880836613476276, -0.008949260227382183, 0.010753084905445576, -0.009978202171623707, -0.0049287620931863785, -0.03902360051870346, 0.0021388668101280928, -0.04938924312591553, -0.0018943340983241796, 0.004766799043864012, -0.014036809094250202, 0.030944494530558586, 0.01183283980935812, -0.0062879822216928005, 0.00459848390892148, -0.015408732928335667, -0.008961962535977364, 0.0024913749657571316, -0.016818765550851822, -0.0012702994281426072, -0.006262576673179865, -0.0014322627102956176, 0.009730493649840355, 0.023500541225075722, 0.025812486186623573, 0.04245340824127197, 0.015345217660069466, -0.01650119014084339, -0.009806712158024311, -0.003820425597950816, 0.017873113974928856, -0.021518873050808907, -0.014760879799723625, -0.04217394441366196, -0.008650739677250385, -0.009990905411541462, 0.018012845888733864, -0.025723565369844437, 0.00012087693175999448, 0.02142995223402977, -0.03188451752066612, -0.03564460203051567, -0.0050272103399038315, -0.01473547425121069, 0.022026993334293365, 0.04133554548025131, -0.023335400968790054, 0.0070755681954324245, -0.0004898592596873641, 0.04944005608558655, 0.016552003100514412, 0.02026127651333809, -0.004163406789302826, -0.03876953944563866, -0.022166725248098373, 0.029648790135979652, 0.02835308387875557, -0.03396780788898468, 0.01285543106496334, -0.03638137876987457, -0.011400938034057617, -0.007177192252129316, 0.0006125225336290896, 0.009133453480899334, -0.0241737999022007, -0.01866069994866848, 0.007151786237955093, 0.0048652468249201775, 0.002121400088071823, 0.01331273838877678, 0.014760879799723625, -0.008244243450462818, -0.03389158844947815, 0.03696571663022041, 0.010213207453489304, -0.0002820461813826114, 0.008993720635771751, 0.02616816945374012, 0.021607793867588043, -0.0005021652905270457, 0.022712955251336098, 0.0011782028013840318, -0.013782748952507973, -0.011210393160581589, -0.026828724890947342, 0.02896282821893692, -0.007380439899861813, -0.0005140743451192975, -0.013249224051833153, 0.008460194803774357, 0.020731287077069283, -0.028251459822058678, -0.0039823888801038265, -0.0029931431636214256, 0.006522987969219685, 0.04634052515029907, -0.012607722543179989, -0.003172572935000062, -0.04621349647641182, -0.01333814486861229, 0.020426414906978607, 0.04453669860959053, -0.010321183130145073, -0.01249974686652422, 0.014379790052771568, 0.0016799711156636477, -0.030944494530558586, 0.019600721076130867, -0.017936628311872482, 0.025151928886771202, -0.016437675803899765, -0.01471006777137518, 0.013795452192425728, 0.03549216687679291, -0.01977856270968914, -0.0332818478345871, 0.022878093644976616, -0.0050018043257296085, -0.01714904233813286, 0.032113172113895416, 0.020413713529706, 0.028632549569010735, -0.012360014021396637, -0.019079897552728653, -0.006456297356635332, 0.025736266747117043, 0.027616310864686966, 0.012957055121660233, -0.01815257966518402, -0.01751743070781231, 0.00985117256641388, -0.04839840903878212, -0.006815156899392605, 0.020794803276658058, -0.017631756141781807, 0.021658606827259064, 0.04245340824127197, 0.005602020770311356, -0.010676867328584194, -0.033688344061374664, 0.021607793867588043, -0.0054559363052248955, 0.04522266238927841, 0.013617610558867455, -0.051523346453905106, 0.01561198104172945, 0.015218188054859638, 0.017923925071954727, -0.007475712336599827, 0.031960733234882355, 0.022077804431319237, -0.03500945493578911, -0.016653627157211304, 0.01018145028501749, -0.01975315622985363, 0.0028327677864581347, -0.012531504034996033, -0.00863803643733263, 0.01444330532103777, -0.028759580105543137, -0.005049440544098616, -0.0074312519282102585, 0.010651460848748684, -0.012296498753130436, -0.02249700389802456, 0.028149835765361786, 0.016170913353562355, -0.0036902199499309063, -0.013325441628694534, 0.011108769103884697, 0.0014473474584519863, 0.03216398134827614, -0.02794658951461315, 0.013681125827133656, 0.02036290057003498, 0.015446841716766357, -0.039176035672426224, -0.0010305304313078523, 0.007659906055778265, 0.00930494349449873, 0.010607000440359116, 0.013820858672261238, -0.02835308387875557, 0.01623442769050598, -0.02560923807322979, -0.0007300252327695489, -0.030944494530558586, 0.011121472343802452, -0.03749924153089523, -0.006122843362390995, 0.011146877892315388, -0.01128661073744297, 0.006992998532950878, 0.003874413436278701, -0.028149835765361786, 0.01802554912865162, 0.02792118303477764, -0.03457755222916603, 0.019448285922408104, 0.018990976735949516, -0.006415012292563915, -0.007107325829565525, 0.013871670700609684, -0.000608552829362452, -0.02616816945374012, -0.01584063470363617, -0.00023957053781487048, -0.0007062071235850453, 0.0024469143245369196, -0.01871151104569435, 0.054216381162405014, -0.01578982174396515, 0.005706820636987686, 0.012455286458134651, -0.002615228993818164, 0.05111685022711754, 0.0033631178084760904, -0.005640129558742046, 0.0004672320210374892, -0.005668711382895708, -0.0038998194504529238, 0.01421465165913105, 0.004919234663248062, -0.013211114332079887, 0.019740454852581024, 0.035924069583415985, -0.0001604745484655723, 0.003976037260144949, 0.024669215083122253, 0.016323348507285118, -0.015573871321976185, -0.0006808011094108224, 0.028810393065214157, 0.007374088279902935, -0.023335400968790054, -0.019549909979104996, 0.03747383505105972, -0.029369324445724487, -0.004566726740449667, -0.018622590228915215, 0.010816600173711777, 0.014494117349386215, 0.041462574154138565, 0.0038585346192121506, 0.0025485383812338114, 0.008066401816904545, 0.007450306322425604, -0.002802598290145397, -0.012963405810296535, -0.02609195187687874, 0.008853987790644169, 0.01335084717720747, 0.003915698267519474, 0.009419270791113377, 0.019575314596295357, 0.016437675803899765, -0.03948090970516205, -0.009794008918106556, 0.01610739715397358, -0.001240129815414548, -0.02446596883237362, -0.02898823469877243, 0.04776326194405556, 0.008511006832122803, 0.02957257255911827, -0.005471814889460802, -0.03236722946166992, -0.02952175959944725, -0.017504727467894554, -0.006929483730345964, 0.019448285922408104, 0.027006566524505615, -0.03218938782811165, 0.005090725142508745, -0.017822301015257835, 0.01179473102092743, -0.0027200288604944944, -0.00654204236343503, 0.01897827349603176, -0.011559725739061832]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
". Using the first line, we see that shk
t
1:t=shωk
t
t−1
1:t−1+ [[[sωk
t
t]]] =shi
t−1
1:t−1+ [[[si
t]]]for those indices such that ωk
t=i.
Indeed, this matches the definition of s¯hi
t
1:t=shi
t−1
1:t−1+[[[si
t]]]in the second line (before resampling). Thus, the indexing notation
in Eq. (Sequence Notations) reflects resampling or cloning of sequences s¯hi
t
1:tinto the indices such that ωk
t=i, which yields
prefixes shk
t
1:tfor the next step of sampling ( t+ 1) in each index k∈[1, K].
36
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
start interleaved
chain from here!
Figure 4: Graphical Models for extended state-
space proposal and target distributions which
result in the bidirectional SMC bounds. We
show density evaluation in the proposal and
target for a fixed set of {sk
t, ωk
t}3,2
k=1,t=1. We let
the size of the circles reflect the (hypothetical)
importance weights of sequences s¯hk
t
1:tandωk
t
reflect the (hypothetical) results of resampling
with these weights. In (b), we assume fixed
jT+1=j3= 1as in the text, with ω1
2= 2.Algorithm 2 (Twisted) SMC Target Sampling ( σSMC)
(blue indicates changes from SMC proposal algorithm; s1:Tis an exact
posterior sample)
SMC-TARGET
p0, q,{ψt}T−1
t=1, ϕ, K, {tr}R−1
t=1, t0= 0, tR=T,s1:T
:
Initialize j∼uniform ({1, . . . , K })
fort= 1, ..., T do
fork= 1, ..., K do
ifk=jthen
sk
t←st
else
Sample sk
t∼q 
stsk
1:t−1
end if
sk
1:t←concat 
sk
1:t−1, sk
t
ift < T then
wk
t←p0(sk
t|sk
1:t−1)
q(sk
t|sk
1:t−1)ψt(sk
1:t)
ψt−1(sk
1:t−1)
else
wk
t←p0(sk
t|sk
1:t−1)
q(sk
t|sk
1:t−1)ϕ(sk
1:t)
ψt−1(sk
1:t−1)
end if
end for
ift∈ {tr}R−1
r=1then
Sample j∼uniform ({1, . . . , K })
fork= 1, ..., K do
ifk=jthen
sk
1:t←s1:t
else
ωk
t∼cat Qtr
t=tr−1+1wi
tPK
j=1Qtr
t=tr−1+1wj
tK
i=1!
sk
1:t←sωk
t
1:t
end if
end for
end if
end for
returnn
sk
1:T,QT
t=tR−1+1wk
toK
k=1
ˇZSMC
σ=QR
r=11
KPK
k=1Qtr
t=tr−1+1wk
t
Extended State Space Proposal Distribution Sampling from the extended state space proposal corresponds to the
procedure described in Sec. 2.2 and Alg. 1, which we write as12
qSMC
{sk
t, ωk
t}T,K
t=1,k=1
:=TY
t=1
KY
k=1q
sk
tshk
t−1
1:t−1KY
k=1q 
ωk
ts1:K
1:t
 (SMC Extended Proposal)
where ∀k,q 
ωk
t=is1:K
1:t:=","[0.012729889713227749, -0.01834789477288723, 0.0339633971452713, 0.04159877821803093, -0.030209548771381378, 0.0068246000446379185, 0.00769922137260437, -0.0020381230860948563, -0.05541396513581276, 0.019139522686600685, 0.028294319286942482, -0.011523295193910599, -0.003453796496614814, 0.01773502118885517, -0.0004624480498023331, -0.017185989767313004, -0.019139522686600685, -0.004998748190701008, -0.017326440662145615, 0.015551661141216755, -0.017645644024014473, -0.0246043112128973, 0.0032287570647895336, 0.025178879499435425, 0.00460293423384428, -0.0327887237071991, 0.012014870531857014, -0.0416753850877285, 0.042237188667058945, -0.00955060962587595, 0.037564028054475784, -0.040909294039011, -0.012697969563305378, -0.04279898852109909, -0.01114024966955185, 0.08687479794025421, -0.025115039199590683, 0.04512279853224754, -0.03909621015191078, 0.025472547858953476, 0.008471696637570858, -0.04982149600982666, -0.03917282074689865, 0.045939963310956955, -0.0036868161987513304, 0.030209548771381378, -0.035061463713645935, -0.06297273188829422, 0.019956687465310097, 0.04369276016950607, -0.008471696637570858, 0.01963748224079609, -0.04407580569386482, 0.019892847165465355, 0.007846055552363396, -0.038534410297870636, 0.0135087501257658, -0.01264051254838705, 0.01593470573425293, -0.0010557700879871845, 0.04198182374238968, -0.011363692581653595, 0.007271486800163984, 0.010074105113744736, -0.030464911833405495, 0.006521355360746384, 0.002698877127841115, 0.04716571047902107, -0.03983676806092262, 0.031511902809143066, -0.03291640430688858, 0.023889292031526566, 0.016432667151093483, -0.01903737708926201, -0.008701524697244167, 0.0030101018492132425, -0.029622210189700127, 0.03437197953462601, 0.0240169744938612, -0.017224295064806938, 0.01985454186797142, -0.026072653010487556, 0.04882557690143585, -0.020812157541513443, -0.015423978678882122, -0.04062839597463608, -0.012480909936130047, 0.002433937042951584, -0.03901960328221321, -0.01994391903281212, -0.035904161632061005, 0.038100291043519974, -0.04113912209868431, -0.004759344272315502, 0.05388177931308746, 0.005391370039433241, 0.011619056575000286, -0.002907956251874566, 0.015538892708718777, -0.013904564082622528, 0.04009212926030159, -0.03110332228243351, -0.004385874606668949, -0.03383571654558182, 0.04961720481514931, -0.0005314761074259877, -0.014402523636817932, 0.020186515524983406, -0.05372856184840202, 0.000714220863301307, -0.005809528287500143, -0.030618131160736084, 0.0029893536120653152, 0.05781438574194908, 0.0437949076294899, -0.0034027239307761192, 0.0019311894429847598, 0.009876198135316372, -0.022676313295960426, 0.019509801641106606, -0.016892321407794952, 0.021859148517251015, 0.023646695539355278, -0.013700272887945175, 0.011625440791249275, 0.017351975664496422, 0.050766341388225555, -0.07226797938346863, -0.036568108946084976, 0.05577147379517555, 0.02793680876493454, -0.014415291137993336, -0.03924943134188652, -0.00829932652413845, 0.004867874085903168, -0.015589965507388115, -0.008063115179538727, 0.03480609878897667, 0.0016965738032013178, 0.02627694420516491, -0.005493515636771917, -0.03881531208753586, -0.014210999943315983, 0.01925443671643734, -0.019956687465310097, -0.005467979237437248, -0.06450492143630981, 0.02997972071170807, -0.03557218983769417, -0.005962746683508158, -0.01699446700513363, -0.03644042834639549, -0.04859574884176254, 0.034703951328992844, -0.010080489329993725, -0.0775795504450798, -0.05949978530406952, 0.02997972071170807, 0.00830571074038744, 0.004331610165536404, -0.008414240553975105, 0.05229852348566055, 0.0075651551596820354, 0.029545601457357407, -0.03365696221590042, -0.02016097865998745, -0.04157324135303497, 0.05388177931308746, -0.04706356301903725, -0.04295220598578453, -0.012129784561693668, -0.03161405026912689, -0.03712990880012512, -0.031665123999118805, 0.021322885528206825, -0.008069498464465141, -0.008414240553975105, -0.06343238800764084, -0.019216133281588554, -0.01819467730820179, -0.016292216256260872, 0.03735973685979843, -0.0022535864263772964, -0.007705605123192072, 0.017952080816030502, 0.008554690517485142, 0.020046064630150795, 0.010310317389667034, 0.03562326356768608, -0.016496507450938225, 0.0001954132312675938, 0.037870462983846664, 0.044509924948215485, -0.01639436185359955, -0.015143078751862049, -0.021527176722884178, 0.060061585158109665, 0.07400445640087128, 0.01994391903281212, -0.013049094937741756, 0.03345267102122307, -0.005464787129312754, -0.042543623596429825, 0.0028010227251797915, -0.011555216275155544, 0.01173397060483694, -0.003916643559932709, 0.021999599412083626, -0.032124776393175125, 0.034755025058984756, 0.02371053770184517, -0.015372905880212784, 0.04121573269367218, 0.011325388215482235, -0.05166011303663254, -0.00043252258910797536, -0.08769196271896362, -0.0032479094807058573, -0.014670655131340027, 0.045556917786598206, -0.0005119247944094241, 0.048672355711460114, 0.030081866309046745, 0.025255488231778145, -0.00541690643876791, 0.03998998552560806, 0.006412825547158718, -0.02431064285337925, -0.0004285325121600181, -0.03322284296154976, 0.023723306134343147, 0.050919558852910995, 0.02129734866321087, -0.04831484705209732, -0.03871316462755203, -0.012551135383546352, -0.03812582790851593, -0.03554665297269821, -0.042696841061115265, -0.07671131193637848, -0.008707908913493156, 0.025702375918626785, 0.019433191046118736, -0.014300378039479256, 0.031307611614465714, 0.01491325069218874, -0.004079438280314207, -0.012697969563305378, -0.02982650138437748, 0.017185989767313004, -0.027681445702910423, -0.018462808802723885, -0.05255388841032982, 0.02544701099395752, -0.018705405294895172, 0.0068629044108092785, -0.0001482307561673224, 0.029417920857667923, -0.035138070583343506, 0.017913777381181717, -0.030975639820098877, -0.03266104310750961, -0.03986230120062828, 0.003091498976573348, -0.02793680876493454, -0.006901209242641926, 0.01569211110472679, -0.010974262841045856, 0.07288085669279099, -0.04190521314740181, -0.029494529590010643, 0.020173747092485428, 0.003361227223649621, 0.029315775260329247, -0.023123200982809067, -0.03368249535560608, -0.00891220010817051, 0.03807475417852402, -0.020658938214182854, 0.0046923113986849785, 0.007877975702285767, -0.08038855344057083, 0.022535862401127815, -0.010623137466609478, 0.008854743093252182, -0.028038954362273216, 0.008995193056762218, 0.05331997945904732, 0.01819467730820179, -0.07048043608665466, 0.019279973581433296, 0.024055277928709984, 0.00803757831454277, -0.01705830730497837, 0.0031936445739120245, 0.003539982018992305, -0.004073054064065218, 0.003345266915857792, 0.01298525370657444, 0.014785569161176682, 0.06281951814889908, -0.00856107473373413, 0.011855268850922585, 0.006709686014801264, -0.008203565143048763, 0.018130837008357048, 0.0018162756459787488, 0.034984853118658066, -0.023493478074669838, 0.0240169744938612, -0.0073800161480903625, -0.030005257576704025, -0.027758054435253143, 0.019075682386755943, 0.004111358430236578, -0.04777858406305313, 0.07323836535215378, -0.016943393275141716, -0.0014172695809975266, -0.03562326356768608, -0.036414891481399536, -0.024476628750562668, 0.017862703651189804, -0.01419823244214058, 0.010546528734266758, -0.01744135282933712, -0.010010264813899994, -0.014210999943315983, -0.017926545813679695, 0.0049412911757826805, 0.030209548771381378, -0.008401472121477127, 0.022548630833625793, 0.0026414201129227877, -0.0068820565938949585, -0.030388303101062775, -0.0035080614034086466, 0.04210950434207916, -0.025178879499435425, 0.049106474965810776, -0.09698720276355743, 0.00447206012904644, -0.01608792506158352, -0.03983676806092262, 0.01810530014336109, 0.00932716578245163, -0.008822822012007236, 0.03797261044383049, 0.06956112384796143, -0.017990386113524437, 0.02944345586001873, 0.019969455897808075, 0.03751295432448387, -0.008229101076722145, 0.023276418447494507, -0.01564103737473488, 0.006447938270866871, -0.027579300105571747, -0.02678767219185829, -0.01661142148077488, -0.037410810589790344, 0.00992727093398571, 0.05536289140582085, -0.02226773090660572, 0.00860576331615448, 0.02883058227598667, -0.035597726702690125, -0.00932078156620264, 0.004804033320397139, 0.0018242557998746634, 0.006029780022799969, 0.024885211139917374, 8.93399555934593e-06, 0.02114412933588028, -0.03942818567156792, -0.003734696889296174, 0.005126430187374353, -0.0029542408883571625, 0.045786745846271515, 0.028498610481619835, 0.02355731837451458, -0.008165260776877403, -0.01325338613241911, -0.01585809700191021, 0.015526124276220798, -0.007162956986576319, -0.008190796710550785, -0.00985704641789198, -0.018245749175548553, -0.007488545961678028, 0.015883633866906166, 0.015206919983029366, -0.019663019105792046, 0.042467013001441956, 0.003559134202077985, -0.018156372010707855, -0.0061031971126794815, 0.056741856038570404, 0.023289186879992485, 0.038917455822229385, -0.04622086510062218, -0.006208534352481365, -0.026174798607826233, -0.024642614647746086, -0.07972460240125656, 0.02673659846186638, 0.03005632944405079, 0.049719348549842834, 0.01947149634361267, 0.056895073503255844, 0.026762135326862335, -0.052962470799684525, 0.021859148517251015, -0.007245950400829315, 0.03312069550156593, -0.012525598518550396, -0.009793205186724663, 0.015960242599248886, 0.052349597215652466, 0.05561825633049011, -0.017224295064806938, -0.04113912209868431, -0.006626693066209555, -0.0068820565938949585, -0.023276418447494507, -0.012359612621366978, 0.022906141355633736, -0.020569561049342155, 0.0570993646979332, -0.031205467879772186, 0.0011363693047314882, 0.05653756484389305, 0.02249755896627903, -0.013725808821618557, 0.0073225595988333225, -0.009697443805634975, 0.03610845282673836, -0.029954183846712112, -0.01631775312125683, -0.050996169447898865, 0.007673684973269701, -0.0037921536713838577, -0.03577648103237152, 0.013764113187789917, -0.017939312383532524, -0.010048569180071354, -0.007482161745429039, -0.05781438574194908, -0.0020381230860948563, 0.002868055598810315, 0.004807225428521633, -0.02612372487783432, 0.0235445499420166, 0.009525072760879993, 0.017237061634659767, -0.04417795315384865, 0.05776331201195717, -0.013674736022949219, 0.022752922028303146, -0.02543424256145954, 0.029852038249373436, 0.0019248053431510925, -0.011031719855964184, 0.019726861268281937, 0.023608392104506493, 0.01675187051296234, 0.03963247686624527, -0.0004644430591724813, 0.026481235399842262, 0.045786745846271515, 0.005410522222518921, -0.04818716645240784, 0.012889492325484753, -0.004542285110801458, 0.011574367992579937, -0.003504869295284152, 0.08973486721515656, -0.051455821841955185, 0.013955636881291866, 0.04139448702335358, 0.010597601532936096, -0.038840848952531815, -0.005423290655016899, 0.055209673941135406, 0.018769245594739914, 0.07328943908214569, 0.03769170865416527, -0.012034023180603981, 0.03595523536205292, 0.0445609986782074, -0.01645820215344429, -0.010329469107091427, 0.032890867441892624, -0.013904564082622528, 0.03146083280444145, -0.040424104779958725, 0.026685526594519615, 0.0014420079533010721, -0.05000025033950806, -0.021642088890075684, 0.03429536893963814, 0.01423653680831194, -0.008656836114823818, 0.06424955278635025, 0.014581277966499329, 0.029647747054696083, 0.01917782798409462, 0.009142027236521244, 0.010348621755838394, 0.04052624851465225, -0.02581728994846344, -0.006569236051291227, -0.01810530014336109, -0.009697443805634975, 0.0028042146004736423, -0.015079237520694733, -0.034703951328992844, -0.03572540730237961, 0.0057488796301186085, 0.0285496823489666, 0.0044497158378362656, 0.005448827054351568, -0.053626418113708496, -0.005902098026126623, 0.030388303101062775, -0.016483739018440247, 0.02424680069088936, -0.09019452333450317, -0.007469393778592348, -0.04512279853224754, 0.003916643559932709, -0.012174473144114017, -0.00636175274848938, 0.02611095830798149, 0.0018912887899205089, -0.002842519199475646, -0.02120797149837017, -0.00460293423384428, 0.020109906792640686, 0.025702375918626785, -0.008209949359297752, -0.01788824051618576, 0.0019104410894215107, -0.015334601514041424, -0.01026562787592411, 0.00479126488789916, 0.024693688377738, 0.0002876833896152675, 0.004564629402011633, -0.005582892801612616, -0.007424705196171999, -0.013381067663431168, 0.004108166787773371, -0.011312620714306831, -0.026225870475172997, 0.016726335510611534, 0.012736273929476738, 0.031128857284784317, -0.023748841136693954, 0.0016806136118248105, 0.030975639820098877, 0.007348095998167992, -0.007680068723857403, -0.006939513608813286, -0.009129258804023266, 0.032354604452848434, 0.012583055533468723, -0.020352501422166824, 0.029622210189700127, 0.01631775312125683, -0.03133314847946167, -0.0015609117690473795, 0.022293267771601677, -0.05160904303193092, -0.008548306301236153, -0.041190195828676224, -0.006971434224396944, -0.03138422220945358, -0.018935231491923332, -0.007743909955024719, -0.03682347387075424, -0.0018657523905858397, 0.020033296197652817, -0.04376937076449394, -0.02106752060353756, 0.026762135326862335, -0.00233019539155066, 0.018616028130054474, -0.005799952428787947, 0.0032096048817038536, 0.032431215047836304, 0.005107277538627386, 0.006179806310683489, 0.018628796562552452, -0.04384598135948181, 0.009774052537977695, -0.009569761343300343, 0.01608792506158352, -0.019688555970788002, -0.026302481070160866, 0.028575219213962555, 0.029494529590010643, -0.0008706312510184944, -0.035061463713645935, -0.04218611493706703, 0.03858548402786255, -0.050536513328552246, 0.01896076835691929, 0.02386375516653061, 0.012493678368628025, 0.011574367992579937, 0.026251407340168953, -0.007373632397502661, -0.011044488288462162, -0.012021254748106003, -0.0019439576426520944, 0.013176776468753815, -0.014479132369160652, 0.05301354452967644, -0.014811105094850063, 0.005822296719998121, -0.016662493348121643, 0.03692561760544777, -0.0050657810643315315, -0.012895876541733742, 0.012697969563305378, 0.006380905397236347, -0.021080289036035538, -0.010878501459956169, -0.011006183922290802, -0.0018944808980450034, -0.019152291119098663, 0.0246043112128973, 0.030209548771381378, -0.01864156313240528, 0.009914503432810307, 0.0010549720609560609, 0.031435295939445496, 0.03294194117188454, -0.007641764357686043, 0.02326365001499653, -0.00808226689696312, 0.0033931476064026356, -0.04673159122467041, 0.028141099959611893, 0.020020529627799988, -0.006907592993229628, 0.046476226300001144, -0.005279648583382368, -0.021003680303692818, -0.02446386031806469, -0.026634452864527702, 0.002773890271782875, -0.043309714645147324, 0.03539343550801277, -0.019190596416592598, 0.049642741680145264, -0.00741832097992301, -0.0020333349239081144, -0.03508699685335159, -0.028881656005978584, 0.02243371680378914, -0.016279447823762894, -0.007443857379257679, 0.0142748411744833, 0.034831635653972626, 0.04479082673788071, 0.03449966013431549, -0.029494529590010643, -0.005464787129312754, -0.018896928057074547, 0.00833763089030981, 0.004574205726385117, -0.026455698534846306, 0.0029494529590010643, 0.008146108128130436, -0.009256941266357899, -0.015066469088196754, 0.017722254619002342, -0.004146471153944731, -0.0007285851170308888, -0.0050274766981601715, -0.049387376755476, 0.011025335639715195, 0.017415817826986313, 0.00240520853549242, 0.03245675191283226, -0.02875397354364395, -0.00985704641789198, -0.005203039385378361, -0.021731466054916382, 0.013674736022949219, 0.016036851331591606, -0.017173221334815025, -0.005021092481911182, -0.0395558662712574, -0.02597050741314888, 0.03041383996605873, -0.02083769254386425, -0.02248479053378105, -0.027196254581212997, 0.026557844132184982, -0.043514005839824677, -0.015385674312710762, -0.0039900606498122215, -0.023659463971853256, -0.04821270331740379, 0.05217084288597107, 0.044892970472574234, -0.03148636594414711, 0.006297911982983351, -0.0021817651577293873, -0.02507673390209675, 0.016432667151093483, -0.0007373632397502661, -0.01110194530338049, 0.006786295212805271, 0.010137946344912052, 0.0035240217112004757, -0.0036963922902941704, -0.015206919983029366, -0.00023222152958624065, -0.05965300276875496, 0.006320256274193525, 0.0018992689438164234, -0.013636431656777859, -0.038100291043519974, -0.02678767219185829, 0.012653280980885029, -0.022982750087976456, 0.006214918568730354, 0.03940264880657196, -0.00524772796779871, -0.00920586846768856, -0.033248379826545715, 0.022331571206450462, -0.030209548771381378, 0.027349472045898438, -0.01903737708926201, -0.00928247720003128, -0.018284054473042488, -0.006588388234376907, -0.03623613715171814, 0.04504619166254997, 0.05669078230857849, 0.04333525151014328, 0.015743182972073555, 0.018309591338038445, -0.016419898718595505, -0.03153743967413902, -0.019267205148935318, 0.009946423582732677, -0.016930626705288887, 0.004717847798019648, 0.02678767219185829, 0.0022184737026691437, 0.00464123860001564, -0.01147222239524126, -0.012321307323873043, 1.7157261027023196e-05, 0.009767668321728706, -0.0007668896578252316, -0.04152216762304306, 0.0261364933103323, 0.016509275883436203, -0.024068046361207962, -0.0026462082751095295, -0.004507172852754593, 0.011542447842657566, 0.030669203028082848, -0.002992545487359166, 0.01714768446981907, -0.0025727911852300167, 0.005831872578710318, 0.046399619430303574, -0.00812057126313448, -0.0020652555394917727, -0.003954948391765356, -0.012059560045599937, 0.015270760282874107, 0.0016455010045319796, -0.01781163178384304, -0.00860576331615448, -0.016573116183280945, -0.022829530760645866, -0.02839646488428116, -0.03263550624251366, -0.0007190089672803879, 0.0027004731819033623, -0.03411661460995674, -0.006588388234376907, -0.004861489869654179, -0.020671706646680832, 0.013559822924435139, -0.01994391903281212, 0.022076208144426346, -0.01999499276280403, -0.11409658193588257, -0.030669203028082848, 0.05592469125986099, 0.03358035162091255, 0.024195728823542595, -0.0198673103004694, 0.0036868161987513304, -0.0073800161480903625, -0.0005390571895986795, -0.04318203404545784, -0.04136895015835762, 0.00432203384116292, -0.005442442838102579, -0.021386725828051567, 0.01041246298700571, -0.040194276720285416, -0.013483213260769844, 0.002425957005470991, -0.029264701530337334, -0.023493478074669838, 0.006182997953146696, 0.025881130248308182, -0.008254637941718102, 0.04422902688384056, -0.031052248552441597, -0.014657887630164623, -0.012563902884721756, 0.016968930140137672, -0.013004406355321407, 0.018705405294895172, 0.01818190887570381, -0.0049029868096113205, 0.00681183161213994, 0.05229852348566055, -0.02575344778597355, 0.017351975664496422, -0.019228901714086533, 0.0318438783288002, 0.002220069756731391, -0.005637157708406448, -0.0024387252051383257, -0.058478329330682755, 0.05222191661596298, 0.02272738516330719, 0.030745811760425568, -0.029085947200655937, -0.012072327546775341, -0.0034729489125311375, 0.012027638964354992, 0.009295245632529259, -0.007973737083375454, 0.016279447823762894, 0.009671906940639019, -0.0017460505478084087, 0.013483213260769844, 0.007207645568996668, -0.010929574258625507, 0.012493678368628025, 0.006348984781652689, 0.0327887237071991, -0.020965375006198883, 0.024795833975076675, 0.06767143309116364, -0.029162555932998657, -0.051813334226608276, -0.04267130419611931, 0.004679543431848288, 0.008471696637570858, 0.039300501346588135, 0.016062388196587563, 0.0006380107370205224, -0.002663764636963606, -0.009608066640794277, 0.0026031157467514277, 0.023123200982809067, 0.022165585309267044, -0.0205440241843462, 0.02302105538547039, -0.010801892727613449, 0.014364218339323997, 0.014287609606981277, -0.04417795315384865, 0.019228901714086533, -0.011963797733187675, -0.02340410090982914, -0.0180414579808712, -0.006696918047964573, 0.015270760282874107, -0.013393836095929146, 0.061491623520851135, 0.021463334560394287, -0.018820319324731827, 0.02145056612789631, -0.012314923107624054, -0.007348095998167992, -0.02583005651831627, -0.006543699651956558, 0.016496507450938225, 0.030745811760425568, 0.00895050447434187, 0.035980772227048874, 0.04241594299674034, 0.015130310319364071, -0.0528603233397007, 0.003088307101279497, 0.0010725283063948154, -0.006945897825062275, 0.013457677327096462, 0.0061606536619365215, -0.012455374002456665, -0.005250920075923204, -0.020748315379023552, -0.03970908373594284, 0.0016486931126564741, 0.012736273929476738, 0.012506446801126003, 0.05648649111390114, 0.00860576331615448, 0.01811806857585907, -0.0028441152535378933, 0.007941816933453083, 0.010961495339870453, 0.0020397191401571035, -0.00683098379522562, -0.013904564082622528, 0.004207120276987553, 0.002733989618718624, 0.03467841446399689, -0.004203928168863058, 0.0005418502259999514, 0.03585309162735939, -0.005685038398951292, 0.053115688264369965, 0.0015848521143198013, -0.017326440662145615, 0.04387151449918747, 0.021642088890075684, 0.01445359643548727, -0.038227975368499756, 0.015321833081543446, -0.0016008124221116304, -0.0018801166443154216, 0.011721202172338963, 0.017313672229647636, 0.0022392221726477146, -0.0090207289904356, -0.001613580621778965, -0.01491325069218874, 0.008056730963289738, 0.027885736897587776, 0.023838218301534653, 0.003958140499889851, 0.014760032296180725, -0.013955636881291866, 0.005177502986043692, -0.007686452940106392, -0.002623863983899355, -0.01624114252626896, 0.021310117095708847, 0.004848721902817488, 0.02226773090660572, 0.06384097039699554, 0.013521517626941204, -0.010016648098826408, 7.745705806883052e-05, 0.010054953396320343, -0.02120797149837017, 0.00215144082903862, -0.015411210246384144, 0.02581728994846344, 0.007801366969943047, -0.02673659846186638, -0.013457677327096462, 0.03215031325817108, 0.03404000774025917, -0.0024674534797668457, 0.01449190080165863, -0.011536063626408577, 0.0008283366332761943, -0.00466039078310132, 0.02211451344192028, 0.03314623236656189, -0.03697669133543968, 0.018360663205385208, 0.01781163178384304, -0.029009338468313217, -0.006588388234376907, -0.009595298208296299, -0.01562827080488205, 0.017185989767313004, -0.01661142148077488, 0.04519940912723541, -0.01888415962457657, 0.04131787642836571, -0.0023238114081323147, 0.022293267771601677, -0.01698169857263565, 0.004232656676322222, 0.00034095070441253483, -0.014823873527348042, -0.004140086937695742, 0.057559020817279816, -0.021246274933218956, -0.020518489181995392, 0.00826102215796709, 0.02770698256790638, -0.0326099693775177, 0.0043379939161241055, -0.011650977656245232, 0.0054137143306434155, -0.003875147085636854, -0.01691785827279091, -0.01230853982269764, 0.0007233979995362461, -0.027579300105571747, -0.08442330360412598, 0.0026382282376289368, -0.005126430187374353, -0.030541520565748215, -0.010514607653021812, -0.02755376324057579, -0.013483213260769844, -0.04468867927789688, 0.02423403225839138, -0.020812157541513443, -0.01652204431593418, -0.005471171345561743, 0.010476303286850452, -0.05028114840388298, 0.005700998939573765, 0.011580752208828926, 0.01782440021634102, -0.015653805807232857, -0.014070549979805946, -0.011287083849310875, 0.03291640430688858, -0.014376986771821976, -0.029622210189700127, -0.0165986530482769, -0.02671106345951557, 0.0003048406506422907, 0.008516385219991207, -0.013559822924435139, -0.006760758813470602, 0.0017013619653880596, -0.026532307267189026, 0.02429787442088127, 0.029928646981716156, -0.01985454186797142, -0.04210950434207916, -0.016253910958766937, 0.010220939293503761, 0.03179280459880829, -0.007711989339441061, -0.0022727386094629765, 0.004519940819591284, -0.0028265591245144606, 0.04816162958741188, 0.05694614723324776, 0.012480909936130047, -0.008056730963289738, -0.018769245594739914, 0.02097814343869686, -0.01991838403046131, 0.01570487953722477, -0.03595523536205292, 0.011599904857575893, -0.00958252977579832, -0.027221791446208954, -0.005187078844755888, -0.018398968502879143, 0.003833650378510356, -0.01237876433879137, 0.050766341388225555, 0.02997972071170807, -0.020505720749497414, 0.00962721835821867, 0.002269546501338482, 0.007220414001494646, 0.010929574258625507, -0.01971409283578396, 0.0011068428866565228, -0.025996044278144836, -0.026225870475172997, 0.025561925023794174, -0.0030835189390927553, 0.005771223921328783, 0.018922464922070503, 0.03199709579348564, -0.0040762461721897125, 0.05602683871984482, 0.019739627838134766, -0.024502165615558624, 0.007252334617078304, -0.021310117095708847, 0.007654532790184021, -0.00920586846768856, 0.020595097914338112, -0.006926745641976595, -0.018398968502879143, -0.019305510446429253, 0.024783065542578697, -0.01994391903281212, -0.0061734220944345, 0.021335652098059654, 0.03169065713882446, 0.0007421512855216861, 0.009116490371525288, -0.02053125575184822, -0.011484990827739239, -0.007660916540771723, -0.015730416402220726, -0.016126230359077454, 0.014900483191013336, 0.03978569433093071, 0.0086823720484972, 0.016739102080464363, 0.007271486800163984, -0.018207445740699768, 0.010023032315075397, -0.026966426521539688, -0.024272337555885315, 0.011925493367016315, -0.006996970623731613, -0.014287609606981277, 0.02643016166985035, 0.004331610165536404, -0.024502165615558624, -0.006690533831715584, 0.030311694368720055, -0.031231002882122993, 0.040960367769002914, 0.0027355856727808714, -0.011874420568346977, -0.004497596528381109, 0.01908845081925392, -0.005592469125986099, 0.010329469107091427, 0.0159219391644001, -0.02567683905363083, -0.021105825901031494, 0.008924967609345913, -0.014389755204319954, 0.0062468391843140125, -0.02205067127943039, -0.004957251716405153, -0.0016040044138208032, -0.007750294171273708, 0.009090954437851906, -0.04295220598578453, 0.07298299670219421, -0.018130837008357048, -0.027272863313555717, -0.00856107473373413, -0.0003333695640321821, -0.015602733939886093, -0.007877975702285767, 0.03434644266963005, -0.03720651939511299, 0.0015776699874550104, -0.016343288123607635, 0.004571013618260622, -0.003674047999083996, -0.0016008124221116304, 0.006234070751816034, 0.003702776273712516, -0.019956687465310097, -0.0001463354710722342, 0.002483413787558675, -0.020569561049342155, 0.030694739893078804, -0.012231930159032345, -0.03314623236656189, 0.019458727911114693, -0.01751796342432499, -0.01114024966955185, -0.020965375006198883, -0.0027499499265104532, -0.008095035329461098, -0.0007864409708417952, 0.007667300757020712, -0.025957738980650902, -0.0215144082903862, -0.022088976576924324, -0.005340297240763903, -0.0229572132229805, -0.048136092722415924, 0.022995518520474434, -0.0020668513607233763, 0.010891269892454147, 0.015117541886866093, 0.0029861615039408207, 0.0013773689279332757, 0.009997496381402016, -0.00826102215796709, -0.010559297166764736, 0.012921412475407124, -0.01110194530338049, 0.012097864411771297, -0.0009424523450434208, -0.021310117095708847, 0.004883834160864353, 0.012691585347056389, -0.01848834566771984, 0.00928247720003128, -0.003693200182169676, -0.0007876380113884807, 0.021093057468533516, 0.013815185986459255, -0.011389229446649551, -0.027655908837914467, -0.010380541905760765, -0.0021594208665192127, 0.011191322468221188, 0.02786020003259182, -0.011599904857575893, 0.018284054473042488, 0.017313672229647636, 0.006001051515340805, 0.06200235337018967, 0.008267405442893505, 0.005949978716671467, -0.01698169857263565, 0.043462932109832764, 0.019765164703130722, -0.009435695596039295, 0.0065117790363729, 0.02566407062113285, 0.004845529794692993, 0.08498509973287582, -0.004708271473646164, 0.023225346580147743, -0.021986830979585648, 0.019509801641106606, 0.010316700674593449, 0.03350374102592468, -0.00872706063091755, -0.007239566184580326, -0.011453070677816868, 0.017020003870129585, -0.02709410898387432, 0.007641764357686043, 0.012761810794472694, -0.0066330768167972565, 0.00039701105561107397, -0.034755025058984756, 0.035367898643016815, -0.015615501441061497, -0.009818741120398045, -0.008650451898574829, 0.004044325556606054, -0.021463334560394287, 0.03488270565867424, 0.01091680582612753, -0.04037303104996681, 0.02671106345951557, -0.038534410297870636, -0.0011523294961079955, 0.002722817473113537, 0.012276618741452694, -0.025906667113304138, 0.004146471153944731, 0.002520122332498431, -0.0016119845677167177, -0.018003154546022415, -0.01790100894868374, -0.06603710353374481, 0.017722254619002342, 0.0016151765594258904, -0.009442079812288284, 0.028856119140982628, 0.004606126341968775, -0.007603459991514683, -0.005301992874592543, -0.006913977209478617, -0.01260220818221569, 0.0045678215101361275, -0.005148774478584528, 0.0005031466716900468, -0.014338682405650616, -0.013483213260769844, 0.004682735074311495, 0.014287609606981277, 0.023225346580147743, 0.055005382746458054, 0.006307487841695547, -0.02271461859345436, -0.0014843025710433722, -0.0044497158378362656, 0.0028712477069348097, -0.007169341202825308, -0.01713491603732109, -0.004395450931042433, -0.004519940819591284, 0.005062588956207037, 0.0020285469945520163, -0.02272738516330719, -0.0013095379108563066, 0.03245675191283226, -0.028524145483970642, 0.007533234544098377, -0.022088976576924324, -0.014300378039479256, 0.010278396308422089, 0.011906341649591923, -0.032354604452848434, -0.003351651132106781, -0.017645644024014473, 0.04892772063612938, 0.0327887237071991, 0.022586936131119728, -0.013304458931088448, -0.02196129411458969, -0.01071251556277275, 0.0301074031740427, 0.024323411285877228, -0.02967328391969204, -0.0016758255660533905, 0.011210475116968155, -0.02520441636443138, -0.011951030232012272, 0.013164008036255836, -0.001428441726602614, -0.028421999886631966, -0.013457677327096462, -0.006658613216131926, 0.006026587914675474, 0.0068246000446379185, 0.0034218761138617992, 0.012155321426689625, -0.008701524697244167, -0.027528226375579834, 0.03572540730237961, 0.015372905880212784, -0.0029654132667928934, 0.017390280961990356, 0.01487494632601738, 0.014287609606981277, -0.008624915033578873, 0.03383571654558182, -0.012474525719881058, 0.007967352867126465, -0.020441878587007523, -0.030158475041389465, 0.017083844169974327, -0.025689607486128807, -0.012659665197134018, 0.0013095379108563066, -0.013138472102582455, 0.024119120091199875, -0.00924417283385992, -0.011906341649591923, -0.011542447842657566, 0.002992545487359166, 0.040730539709329605, -0.0037219286896288395, 0.0016407129587605596, -0.03329944983124733, -0.020097138360142708, 0.034601807594299316, 0.04295220598578453, 0.0004752162494696677, -0.01419823244214058, 0.010635905899107456, -0.0020157787948846817, -0.02801341935992241, 0.01547505147755146, -0.017926545813679695, 0.01491325069218874, 0.021578248590230942, -0.027298400178551674, 0.01924166828393936, 0.024553237482905388, -0.019113987684249878, -0.034831635653972626, 0.03352927789092064, -0.009869813919067383, -0.011267931200563908, 0.006106388755142689, 0.03478056192398071, 0.045710135251283646, -0.021195203065872192, -0.012404301203787327, 0.01212340034544468, 0.03335052356123924, 0.006416017655283213, 0.022331571206450462, -0.01358535885810852, -0.005835064686834812, 0.021654857322573662, -0.04297774285078049, 0.001702957903034985, 0.0023876524064689875, -0.020033296197652817, 0.015947474166750908, 0.07451518625020981, -0.006869288627058268, -0.00421031191945076, -0.04364169016480446, 0.01707107573747635, 0.024591542780399323, 0.04353954270482063, 0.010782740078866482, -0.05510752648115158, 0.009671906940639019, 0.01979070156812668, 0.02369776926934719, -0.028498610481619835, 0.05043436959385872, 0.02226773090660572, -0.019139522686600685, 0.012136168777942657, 0.016419898718595505, -0.012691585347056389, -0.0031425717752426863, -0.012793730944395065, -0.017275366932153702, 0.014210999943315983, -0.006562851835042238, -0.03110332228243351, -0.015360137447714806, 0.001221756567247212, -0.00341549189761281, -0.011427533812820911, 0.030464911833405495, 0.011823347769677639, -0.00958891399204731, 0.009467615745961666, 0.022855067625641823, -0.019050145521759987, 0.03240567818284035, -0.0228678360581398, 0.012666048482060432, 0.013125703670084476, 0.018003154546022415, -0.027834663167595863, -0.0021674009039998055, 0.0107572041451931, -0.009429311379790306, 0.015589965507388115, 0.0166880302131176, -0.04504619166254997, 0.028268782421946526, -0.034601807594299316, -0.012927796691656113, -0.02755376324057579, 0.002449897350743413, -0.05183887109160423, 0.020646169781684875, 0.018679868429899216, -0.000918511999770999, 0.007648148573935032, -0.01011241041123867, -0.017530731856822968, 0.02816663682460785, 0.031307611614465714, -0.02507673390209675, 0.023059358820319176, 0.02243371680378914, 1.0798102266562637e-05, 0.014096086844801903, 0.025957738980650902, -0.0013582166284322739, -0.018245749175548553, -0.04055178537964821, 0.016739102080464363, 0.003048406448215246, 0.02060786634683609, -0.0013733789091929793, 0.03998998552560806, -0.00773752573877573, 0.00492852320894599, 0.005490323528647423, 0.01931827887892723, 0.05444358289241791, 0.000751727435272187, -0.00838231947273016, 0.00494767539203167, 0.010476303286850452, -0.004880642518401146, 0.009576145559549332, -0.010642290115356445, -0.009908119216561317, 0.03827904537320137, 0.017913777381181717, -0.013125703670084476, 0.0029095523059368134, 0.01389179565012455, 0.03309515863656998, -0.021769771352410316, 0.0051711187697947025, 0.025383170694112778, -0.0027802742552012205, -0.009729363955557346, -0.03179280459880829, 0.02016097865998745, -0.018590491265058517, -0.01947149634361267, -0.011587136425077915, 0.00524772796779871, 0.0174541212618351, 0.025881130248308182, -0.005940402392297983, 0.0003800533013418317, 0.027809128165245056, 0.008018425665795803, 0.007086347788572311, 0.0016949778655543923, -0.020710011944174767, 0.008803670294582844, 0.015960242599248886, 0.012570287100970745, 0.045710135251283646, 0.0032750419341027737, 0.02408081479370594, -0.027119645848870277, -0.005949978716671467, -0.0039900606498122215, 0.00981235783547163, -0.04788072779774666, -0.0026047115679830313, 0.031435295939445496, 0.018386200070381165, 0.023659463971853256, -0.003476141020655632, -0.026685526594519615, -0.023212578147649765, -0.03465288132429123, -0.009237788617610931, -0.00039820806705392897, 0.02650677226483822, -0.01865433156490326, -0.01765841245651245, -0.008995193056762218, 0.012634128332138062, 0.014262072741985321, -0.02062063477933407, 0.014351450838148594, -0.01135730929672718]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"˜πt
s¯hi
t
1:t
˜πt−1
shi
t−1
1:t−1
q
si
tshi
t−1
1:t−1
KP
κ=1˜πt
s¯hκ
t
1:t
˜πt−1
shκ
t−1
1:t−1
q
sκ
tshκ
t−1
1:t−1=wt
s¯hi
t
1:t
PK
κ=1wt
s¯hκ
t
1:t (74)
12Note that hk
t,s¯hk
t
1:t, andshk
t
1:tare deterministically constructed from {sk
t, ωk
t}T,K
t=1,k=1during sampling, and simply track the quantities
to be calculated when evaluating densities.
37
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
To recount the description above, note that the next token si
tin index iis sampled from the proposal, conditioned on the
prefix shi
t−1
1:t−1. We concatenate these tokens s¯hi
t
1:t=shi
t−1
1:t−1+ [[[si
t]]]( Eq. (Sequence Notations)) and calculate importance
weights. We perform resampling in each index kaccording to q(ωk
t|s1:K
1:t), orSNIS with the calculated weights (as in
Eq. (7)). Finally, after resampling, we clone the sequence in the chosen index ωk
tinto index kand proceed to sample sk
t+1
with an prefix defined by the indices hk
t=hωk
t
t−1+ [[[ωk
t]]].
Worked Example: To make this more concrete, we provide a worked example of the procedure in Fig. 4 (a). At step t= 1,
we resample the token sk=2
t=1twice (for indices k= 1,3), with ω1
1=ω3
1= 2(and in index 2, setω2
1= 3to sample s3
1). We
record the prefix history as, for example, h1
1=h3
1= [[[ω1
1]]] = [[[2]]], which corresponds to sh1
1
1=s2
1.
At step 2 in (a), we proceed to sample s1
2∼q(s2|sh1
1
1= [[[s2
1]]])(and similarly s3
2∼q(s2|sh3
1
1= [[[s2
1]]])), whereas s2
2∼
q(s2|sh1
1
1= [[[s3
1]]]). We next evaluate the importance weights over three concatenated sequences: s¯h1
1
1= [[[s2
1]]] + [[[s1
2]]],
s¯h2
1
1= [[[s3
1]]] + [[[s2
2]]], ands¯h3
1
1= [[[s2
1]]] + [[[s3
2]]], emphasizing that sk
2is the final token in each index. Shown in the red circles, we
proceed to resample ω1
2= 2, ω2
2= 3,andω3
2= 2at step t= 2.
Finally, we need to backtrack to obtain the history of the indices for the sequence to be cloned in resampling. Namely, for
index 1where ωk=1
t=2= 2, we concatenate hω1
2
1+ [[[ω1
2]]] =h2
1+ [[[2]]] = [[[3,2]]] =:h1
2(i.e. the history for time 2, index 1). This
list of indices specifies the prefix sh1
2
1:2= [[[s3
1, s2
2]]]at step t= 3, index k= 1. Similar reasoning applies for other indices.
Extended State Space Target We are finally ready to specify the extended state space target distribution. The crucial
difference is to identify a single sequence sh1
T
1:Tof length T(the choice of index 1 is arbitrary). This sequence sh1
T
1:Twill be
evaluated under","[0.020099638029932976, -0.035398148000240326, 0.05815603584051132, 0.01679038628935814, -0.012084195390343666, -0.004946925211697817, 0.0143355717882514, 0.02410057745873928, -0.033038269728422165, 0.034258898347616196, 0.03374352306127548, 0.008123942650854588, -0.03634752333164215, 0.003143111476674676, -0.018594199791550636, -0.02107613906264305, -0.002100493526086211, -0.02019457519054413, -0.03132939338684082, 0.013847321271896362, -0.01993688754737377, -0.041853900998830795, 0.013284477405250072, 0.024534577503800392, 0.013881227932870388, -0.03965677693486214, 0.019258761778473854, -0.01468819659203291, 0.0458684042096138, -0.008713912218809128, 0.028833894059062004, -0.05237840861082077, -0.00150120013859123, 0.00610991008579731, 0.018187323585152626, 0.0802358016371727, -0.0045502218417823315, 0.04315590113401413, -0.05430428311228752, 0.017048073932528496, 0.013311602175235748, -0.036483149975538254, -0.048689406365156174, 0.044159527868032455, -0.005140190944075584, 0.03024439513683319, -0.01600375957787037, -0.038436148315668106, -0.01875695027410984, 0.06547979265451431, -0.01679038628935814, 0.03908715024590492, -0.06390654295682907, -0.02027595043182373, 0.011785820126533508, -0.06439479440450668, 0.005296159535646439, -0.016234323382377625, 0.021550826728343964, -0.016573386266827583, 0.034557271748781204, -0.019299449399113655, 0.00449936231598258, 0.014620384201407433, -0.039575401693582535, 0.008883442729711533, -0.003844971302896738, 0.04242352768778801, -0.03976527601480484, 0.050235532224178314, -0.012938633561134338, 0.03501839563250542, 0.003216009819880128, -0.010999194346368313, -0.01278266403824091, 0.005828488152474165, -0.03520827367901802, 0.027626829221844673, 0.0022344233002513647, 0.006876192055642605, 0.03678152337670326, -0.01754988543689251, 0.06547979265451431, -0.02905089408159256, -0.017400698736310005, -0.05576903373003006, -0.004821471869945526, -0.008646098896861076, -0.03588639944791794, -0.01799744926393032, -0.049150530248880386, 0.04386115446686745, -0.014213508926331997, 0.013637102209031582, 0.03789364919066429, -0.025158453732728958, 0.02141520194709301, 0.0025989157147705555, -0.004448502790182829, -0.029946019873023033, 0.037296898663043976, -0.03097677044570446, 0.018200887367129326, -0.028427017852663994, 0.04993715509772301, 0.018146635964512825, -0.029240768402814865, 0.0419895276427269, -0.07198979705572128, -0.0014299970353022218, -0.017902512103319168, -0.0006374379154294729, -0.010246475227177143, 0.05080515891313553, 0.02487364038825035, 0.0076831611804664135, 0.008985161781311035, 0.01146710105240345, -0.00613025389611721, 0.014037196524441242, -0.030271518975496292, 0.0003040968731511384, -0.008991943672299385, -0.01763126067817211, -0.002882033120840788, -0.00937847513705492, 0.052215658128261566, -0.03542527183890343, -0.04613965377211571, 0.028155768290162086, 0.013406539335846901, -0.01954357512295246, -0.012246944941580296, -0.014973009936511517, -0.0024310797452926636, -0.011928226798772812, 0.010341412387788296, 0.04776715487241745, 0.02180851437151432, 0.02254088968038559, 0.008279911242425442, -0.022296763956546783, -0.021238887682557106, 0.018621323630213737, -0.029729019850492477, 0.005092721898108721, -0.05460266023874283, 0.06260453909635544, -0.028372768312692642, -0.008707130327820778, -0.008300255052745342, -0.0458412803709507, -0.028047267347574234, 0.03092251904308796, -0.00786625500768423, -0.07551604509353638, -0.06678178906440735, 0.048309653997421265, 0.003166845766827464, -0.012565664015710354, -0.027070768177509308, 0.04440365359187126, 0.01828226074576378, 0.014240633696317673, -0.019245199859142303, 0.0026362126227468252, -0.012090976350009441, 0.04236927628517151, -0.049910031259059906, -0.052920907735824585, -0.005109675228595734, -0.0460040308535099, -0.05761353671550751, -0.026528267189860344, 0.018133074045181274, -0.010266819037497044, -0.033065397292375565, -0.04234215244650841, -0.010402443818747997, -0.0420980267226696, 0.005099503323435783, 0.03792077302932739, 0.005163925234228373, -0.011643413454294205, 0.0025616188067942858, -0.00939881894737482, 0.03488277271389961, 0.03287551924586296, 0.023164764046669006, -0.01259957067668438, 0.011853632517158985, 0.05533503368496895, 0.07866255193948746, -0.0005823402316309512, -0.019624950364232063, -0.03892439976334572, 0.05685403570532799, 0.05837303772568703, 0.023069826886057854, 0.013216665014624596, 0.025361891835927963, -0.023259703069925308, -0.05913253873586655, -0.001339297741651535, 0.02331395260989666, 0.007269504480063915, -0.0019987747073173523, 0.023096952587366104, -0.037215523421764374, -0.020384451374411583, 0.01186041347682476, -0.03146502003073692, 0.02414126507937908, 0.0007234750664792955, -0.04329152777791023, 0.02861689403653145, -0.058590035885572433, -0.008456224575638771, -0.009934538044035435, 0.014891634695231915, 0.006506613455712795, 0.05511803552508354, 0.022323889657855034, 0.006547301076352596, -0.009195380844175816, 0.03472002223134041, 0.03374352306127548, -0.01278266403824091, 0.018973950296640396, -0.03146502003073692, 0.019285887479782104, 0.04635665565729141, 0.020370887592434883, -0.05462978407740593, -0.038409024477005005, -0.010829662904143333, -0.04166402667760849, -0.03398764505982399, -0.05232415720820427, -0.07491929829120636, -0.009968443773686886, 0.042613402009010315, 0.025917954742908478, -0.0010460084304213524, 0.014511884190142155, 0.014172821305692196, -0.013481133617460728, 0.009093661792576313, -0.0003803859872277826, 0.022825701162219048, 0.0003053683612961322, -0.041067276149988174, -0.04369840398430824, 0.03482852131128311, -0.04139277711510658, 0.029295017942786217, 0.014661071822047234, 0.03333664685487747, -0.006096347700804472, 0.013230226933956146, -0.00620484771206975, -0.029322143644094467, -0.03751390054821968, 0.0011290787952020764, -0.03368927165865898, -0.014416947029531002, 0.026080703362822533, -0.002787095494568348, 0.06081428751349449, -0.036130521446466446, -0.022378139197826385, 0.00995488092303276, -0.01608513481914997, 0.04120290279388428, -0.025375453755259514, -0.04535302892327309, -0.014661071822047234, 0.03276702016592026, -0.029701894149184227, 0.003382150549441576, -0.034177523106336594, -0.06303854286670685, 0.05766778811812401, -0.005096112843602896, 0.013928696513175964, -0.020153887569904327, 0.015596885234117508, 0.055199410766363144, 0.009086880832910538, -0.07942204922437668, 0.028969518840312958, -0.007215254474431276, -0.008252786472439766, -0.02443964034318924, 0.0007751821540296078, 0.02136095054447651, 0.014322008937597275, 0.0038178463000804186, -0.0023920873645693064, 0.005509769078344107, 0.04326440393924713, -0.04179965332150459, 0.02069638855755329, 0.009100443683564663, -0.01355572696775198, 0.03021726943552494, 0.008964817970991135, 0.01725151017308235, -0.02332751452922821, 0.019190950319170952, 0.010246475227177143, 0.00506220618262887, -0.03924990072846413, 0.01985551230609417, -0.0026294314302504063, -0.02479226514697075, 0.053354907780885696, 0.003560158424079418, 0.01638351008296013, -0.023164764046669006, -0.03406902030110359, -0.044919028878211975, 0.03897865116596222, 0.00223950925283134, 0.017400698736310005, 0.012491070665419102, -0.018607761710882187, -0.014471196569502354, -0.014091446064412594, 0.009927756153047085, 0.0036890022456645966, -0.009819256141781807, 0.020506512373685837, 0.014023633673787117, -0.030352894216775894, -0.021550826728343964, -0.005994628649204969, 0.024344703182578087, -0.008720693178474903, 0.038002148270606995, -0.10101356357336044, -0.0076424735598266125, -0.0015885088359937072, -0.027803143486380577, 0.006218410097062588, 0.020398013293743134, 0.00821887981146574, 0.028047267347574234, 0.05121203139424324, -0.02062857523560524, -0.0021242278162389994, 0.010802538134157658, 0.045298777520656586, -0.019001074135303497, 0.014986571855843067, -0.017739761620759964, 0.016681885346770287, -0.026121390983462334, -0.03629327192902565, -0.018580636009573936, -0.03545239940285683, 0.03333664685487747, 0.0495574064552784, -0.015095071867108345, -0.00933778751641512, -0.002232728060334921, -0.04809265583753586, -0.033011145889759064, -0.009025849401950836, 0.014199947007000446, 0.017197260633111, 0.02448032796382904, -0.009242849424481392, -0.0006327757728286088, -0.06992829591035843, -0.01261991448700428, 0.0066897072829306126, 0.002137790434062481, 0.032739896327257156, 0.026134954765439034, 0.014891634695231915, -0.028508393093943596, -0.013230226933956146, -0.004862159490585327, 0.02785739302635193, 0.009568349458277225, 0.020370887592434883, -4.066103883815231e-06, -0.031573519110679626, -0.02791164256632328, 0.04394252970814705, 0.0015156103763729334, 0.028427017852663994, 0.046410903334617615, 0.012850477360188961, -0.005133409518748522, -0.02439895272254944, 0.06802954524755478, 0.04475627839565277, 0.028345642611384392, -0.03363502025604248, -0.008652880787849426, -0.016234323382377625, -0.046410903334617615, -0.028155768290162086, 0.03292977064847946, 0.021862763911485672, 0.04662790521979332, 0.03287551924586296, 0.038843024522066116, 0.02861689403653145, -0.000212867817026563, 0.03336377069354057, -0.00996166281402111, 0.02138807624578476, 0.018811199814081192, -0.010165099985897541, 0.025416141375899315, 0.05625728517770767, 0.04551577940583229, 0.011039881967008114, -0.03396052122116089, -0.03176339343190193, -0.02746408060193062, -0.035343896597623825, -0.005140190944075584, 0.018187323585152626, -0.013087821193039417, 0.013020007871091366, -0.04006364941596985, 0.012138444930315018, 0.03634752333164215, -0.009765006601810455, 0.003119376953691244, 0.02720639295876026, -0.012870821170508862, 0.04429515451192856, 0.01791607402265072, -0.01944863796234131, -0.05156465619802475, 0.0034041895996779203, -0.031193770468235016, -0.04152840003371239, 0.013216665014624596, -0.04179965332150459, -0.020004700869321823, -0.017034510150551796, -0.053354907780885696, 0.025497516617178917, -0.0038958305958658457, -0.007032160647213459, -0.018621323630213737, 0.026229891926050186, 0.014444071799516678, 0.023802202194929123, -0.04852665588259697, 0.03794790059328079, -0.0028311735950410366, 0.03870739787817001, -0.02671814151108265, 0.01990976184606552, -0.003465221030637622, -0.018458575010299683, 0.005343628581613302, 0.019706325605511665, 0.0153120718896389, 0.03520827367901802, -0.02020813710987568, 0.03873452544212341, 0.03789364919066429, 0.020940514281392097, -0.040768902748823166, 0.017075197771191597, -0.020086076110601425, 0.0267045795917511, 0.009093661792576313, 0.06998254358768463, -0.03946689888834953, 0.0017936417134478688, 0.022364577278494835, 0.004828253295272589, -0.02719282917678356, -0.01718369871377945, 0.05232415720820427, -0.0021683061495423317, 0.10573332011699677, 0.050995033234357834, -0.020886262878775597, 0.040009401738643646, 0.007364442106336355, -0.029891768470406532, -0.003332986496388912, 0.02563314139842987, -0.01599019765853882, 0.01570538431406021, -0.005465690977871418, 0.027233516797423363, -0.01569182239472866, -0.013664227910339832, -0.0048180813901126385, 0.03868027403950691, 0.02068282477557659, 0.005028299987316132, 0.07345454394817352, 0.005906472448259592, 0.031058145686984062, 0.02286638878285885, 0.008266349323093891, 0.008083255030214787, 0.04307452589273453, -0.03488277271389961, -0.00897838082164526, -0.0068795825354754925, -0.007805223576724529, 0.0019275714876130223, -0.03100389428436756, -0.02746408060193062, -0.003083775518462062, -0.004519706126302481, 0.011229757219552994, -0.0015079814475029707, 0.020167449489235878, -0.0457870289683342, -0.011941788718104362, 0.025321204215288162, -0.0381648987531662, -0.001309629762545228, -0.10736081749200821, -0.005211393814533949, -0.06038028746843338, 0.032333020120859146, -0.002576876664534211, -0.023124076426029205, 0.013189539313316345, -0.005811534821987152, 0.017305761575698853, -0.012870821170508862, -0.01548838522285223, 0.01866201125085354, 0.03252289444208145, -0.03016301989555359, -0.009588693268597126, -0.00315497862175107, -0.01069403812289238, 0.007296629715710878, -0.0002042852865997702, 0.0343131460249424, 0.010646569542586803, -0.006781254429370165, 0.0009493756224401295, -0.004112830851227045, -0.012524976395070553, -0.008632536977529526, -0.0342860221862793, -0.03366214781999588, -0.0028650800231844187, 0.023571640253067017, 0.011202632449567318, -0.01868913695216179, 0.0006802445859648287, 0.018811199814081192, 0.02831851877272129, -0.00410943990573287, -0.001720743253827095, -0.005550456698983908, 0.036076273769140244, 0.025009265169501305, -0.03092251904308796, 0.02826426737010479, 0.00782556738704443, -0.06184503808617592, 0.014023633673787117, 0.012775883078575134, -0.011243320070207119, 0.0047231437638401985, -0.045705653727054596, -0.006696488708257675, -0.009982006624341011, 0.0024497280828654766, -0.011148381978273392, -0.03409614786505699, -0.004038237035274506, 0.0029498457442969084, -0.034991271793842316, -0.01299288310110569, 0.02783026732504368, -0.0009434419916942716, 0.006469316780567169, -0.017427824437618256, 0.007350879721343517, 0.021971264854073524, -0.011833288706839085, 0.005326675251126289, 0.02221538871526718, -0.050669532269239426, 0.004112830851227045, -0.00821887981146574, 0.004577346611768007, -0.019801262766122818, 0.0020326809026300907, 0.012267288751900196, 0.022432388737797737, -0.0039161741733551025, -0.0305156446993351, -0.044864777475595474, 0.02749120444059372, -0.05663703754544258, 0.03621189668774605, 0.01722438633441925, 0.01639707386493683, 0.013691352680325508, 0.013338726945221424, -0.0008616431150585413, -0.019787700846791267, -0.015786759555339813, 0.00648966059088707, -0.028399894014000893, -0.01910957507789135, 0.057884786278009415, -0.008835974149405956, 0.008171411231160164, -0.020723512396216393, 0.03705277293920517, -0.03013589419424534, -0.003266869345679879, 0.0382462739944458, -0.008666442707180977, -0.023530952632427216, -0.022662952542304993, -0.000506051117554307, -0.011928226798772812, -0.023395327851176262, 0.020832013338804245, 0.021917013451457024, -0.021632201969623566, 0.020384451374411583, -0.0013443836942315102, 0.05077803134918213, 0.025917954742908478, -0.0005285140359774232, 0.003102423856034875, 0.000934965442866087, 0.012714851647615433, -0.05389741063117981, 0.05460266023874283, 0.04736027866601944, -0.021605076268315315, 0.04041627421975136, -0.003427924122661352, -0.018485698848962784, -0.03181764483451843, -0.039575401693582535, 0.03716127201914787, -0.027667516842484474, 0.047197531908750534, -0.050588157027959824, 0.0267452672123909, -0.010212568566203117, 0.009317443706095219, -0.03509977087378502, -0.010538069531321526, 0.024154826998710632, 0.0018411105265840888, -0.008924130350351334, 0.02899664267897606, 0.030461395159363747, 0.048418156802654266, 0.015366322360932827, 0.013087821193039417, -0.01760413683950901, -0.032658521085977554, 0.036483149975538254, 0.027436954900622368, -0.02369370311498642, -0.002787095494568348, 0.010260038077831268, -0.01985551230609417, -0.04087740182876587, 0.0026989392936229706, 0.014593259431421757, -0.02899664267897606, 0.005591144319623709, -0.04939465597271919, 0.014484759420156479, -0.007988317869603634, -0.0002362843370065093, 0.029593393206596375, -0.0306241437792778, 0.011005975306034088, -0.006059050559997559, -0.02401920221745968, -0.0027955721598118544, 0.0172379482537508, -0.020737076178193092, -0.01107378862798214, -0.0381377749145031, -0.022608701139688492, 0.022418826818466187, -0.01510863471776247, 0.015135759487748146, -0.04136564955115318, 0.030434269458055496, -0.0573422871530056, -0.02401920221745968, -0.01088391337543726, -0.012606351636350155, -0.046438030898571014, 0.05701678618788719, 0.03132939338684082, -0.029647644609212875, 0.013433665037155151, 0.005642003379762173, 0.0018953605322167277, 0.024168390780687332, -0.019014637917280197, -0.001666493248194456, -0.008917349390685558, 0.011643413454294205, -0.014077884145081043, -0.018811199814081192, -0.00534701906144619, 0.015325634740293026, -0.02064213901758194, -0.0021462670993059874, 0.01201638299971819, -0.031492143869400024, -0.027721768245100975, -0.02218826487660408, 0.0305156446993351, -0.006418457254767418, -0.0022310325875878334, 0.038381900638341904, -0.0070525044575333595, -0.0023920873645693064, -0.014077884145081043, 0.0008849537116475403, -0.027436954900622368, 0.026541829109191895, -0.02099476382136345, -0.013623540289700031, -0.014552571810781956, -0.03897865116596222, -0.024656640365719795, 0.061736539006233215, 0.04500040411949158, 0.03368927165865898, 0.01676326058804989, 0.01794319972395897, 0.0013799852458760142, -0.04009077697992325, -0.020113199949264526, 0.011935007758438587, -0.015746071934700012, -0.007696723565459251, 0.03870739787817001, 0.010212568566203117, 0.008008661679923534, -0.010585538111627102, -0.019584262743592262, -0.0006344711291603744, 0.01688532344996929, -0.008361286483705044, -0.0305156446993351, 0.00544195668771863, 0.025090640410780907, -0.015434134751558304, -0.011718007735908031, 0.0074525983072817326, 0.024548141285777092, 0.013630321249365807, -0.009093661792576313, 0.0034991272259503603, 0.005519940983504057, -0.009798912331461906, 0.049177657812833786, -0.01753632351756096, -0.008591849356889725, -0.01278944592922926, -0.011453538201749325, 0.014837384223937988, -0.022839264944195747, -0.012043507769703865, -0.0014367782277986407, -0.01676326058804989, 0.0028769471682608128, -0.027057204395532608, -0.030705519020557404, 0.011385725811123848, 0.011202632449567318, -0.02712501771748066, -0.01184685155749321, -0.012267288751900196, -0.016926011070609093, 0.0039704241789877415, -0.0057945819571614265, 0.0028006581123918295, -0.004082315135747194, -0.11674607545137405, -0.02791164256632328, 0.05313790962100029, 0.02943064458668232, 0.021171076223254204, -0.009853162802755833, 0.0075475359335541725, -0.00277353310957551, -0.006069222465157509, -0.029539143666625023, -0.014172821305692196, 0.007771317381411791, -0.0019038371974602342, -0.018214449286460876, 0.003314338158816099, -0.012002820149064064, -0.007513629738241434, 0.0061166915111243725, -0.011609507724642754, -0.02637907862663269, -0.004434940405189991, 0.007744192611426115, -0.0035398148465901613, 0.029539143666625023, -0.03981952369213104, -0.00677786348387599, -0.0015766415745019913, 0.004000939894467592, -0.026541829109191895, 0.01031428761780262, 0.017360011115670204, -0.014227071776986122, -0.0006137035088613629, 0.05492816120386124, -0.029647644609212875, 0.007411911152303219, -0.01687176153063774, 0.029267894104123116, 0.01750919781625271, -0.02298845164477825, -0.005170706193894148, -0.059892039746046066, 0.047929905354976654, -0.011514569632709026, 0.04467490315437317, -0.0419624000787735, -0.00799509882926941, -0.022690076380968094, 0.03352652117609978, 0.013847321271896362, -0.008781724609434605, 0.015949510037899017, -0.0016732745571061969, 0.000737885246053338, 0.031031019985675812, 0.02602645382285118, -0.0018529777880758047, 0.0006031077937223017, 0.022473076358437538, 0.03868027403950691, -0.009887068532407284, 0.02712501771748066, 0.037622399628162384, -0.014010071754455566, -0.042640525847673416, -0.0382191501557827, 0.021550826728343964, 0.02864401787519455, 0.02290707640349865, -0.006296394858509302, -0.008347723633050919, -0.01163663249462843, -0.008937693201005459, 0.007662817370146513, 0.012897945940494537, 0.037215523421764374, -0.013501477427780628, 0.021618638187646866, -0.035398148000240326, 0.023476703092455864, 0.022459514439105988, -0.03241439536213875, 0.021279575303196907, -0.0020462435204535723, -0.023585202172398567, -0.01714301109313965, 0.007744192611426115, -0.013331945985555649, -0.00629978533834219, 0.027436954900622368, 0.025741642341017723, -0.018865449354052544, 0.013474352657794952, -0.025402579456567764, 0.0034092755522578955, -0.047251779586076736, -0.010280381888151169, 0.009832818992435932, 0.012694507837295532, -0.004492580890655518, 0.023829327896237373, 0.04708902910351753, 0.009948099963366985, -0.04307452589273453, -0.022011950612068176, -3.9045189623720944e-05, 0.015379885211586952, 0.009446287527680397, 0.004655330907553434, -0.007025379687547684, 0.009575131349265575, -0.023137640208005905, -0.031085269525647163, 0.02331395260989666, 0.009202161803841591, 0.0209676381200552, 0.038463275879621506, 0.03021726943552494, 0.017685512080788612, -0.017292197793722153, -0.0008705435320734978, 0.01871626265347004, -0.002595525002107024, -0.01226050779223442, -0.02940351888537407, 0.007662817370146513, -0.009419161826372147, 0.030407143756747246, 0.008313817903399467, -0.026229891926050186, 0.03976527601480484, 0.001827548025175929, 0.03396052122116089, 0.006604941561818123, 0.0009366607409901917, 0.03596777468919754, 0.028074393048882484, 0.02861689403653145, -0.030841143801808357, 0.024005640298128128, 0.005306331440806389, 0.004946925211697817, 0.00895803701132536, 0.025009265169501305, 0.0007472094730474055, -0.0011138210538774729, -0.020086076110601425, -0.01839076168835163, 0.011928226798772812, 0.0104838190600276, 0.0210490133613348, 0.006774473004043102, 0.009887068532407284, -0.00992097519338131, -0.026229891926050186, 0.006493051070719957, -0.0072830673307180405, -0.014037196524441242, 0.010755069553852081, 0.03127514570951462, 0.003906002501025796, 0.0728035494685173, 0.01337263360619545, -0.0015681650256738067, 0.016993822529911995, 0.012708070687949657, -0.02525339089334011, -0.00933100562542677, -0.022323889657855034, 0.02363945171236992, -0.028155768290162086, -0.03100389428436756, 0.015203571878373623, 0.03328239545226097, 0.02144232578575611, 0.003375369356945157, 0.03683577477931976, 0.011623069643974304, -0.005197831429541111, 0.01127722579985857, 0.015515509992837906, 0.017400698736310005, -0.03320102021098137, -0.0031227676663547754, 0.047197531908750534, -0.008903786540031433, -0.01913669891655445, 0.005635222420096397, -0.009670068509876728, 0.03710702434182167, 0.02640620432794094, 0.032333020120859146, -0.01434913370758295, 0.02567382901906967, 0.0034092755522578955, 4.54555956821423e-05, 0.009439505636692047, -0.004156908951699734, -0.009310661815106869, -0.006754129193723202, -0.03146502003073692, 0.03783939778804779, -0.006944004446268082, -0.02179495058953762, -0.0030752988532185555, 0.031220894306898117, -0.033797770738601685, -0.013454008847475052, -0.006170941516757011, -0.003648314857855439, -0.009724318981170654, -0.020723512396216393, -0.034394521266222, 0.022662952542304993, -0.01836363598704338, -0.07887955009937286, -0.014064321294426918, -0.015515509992837906, -0.02788451686501503, -0.007215254474431276, -0.03287551924586296, -0.008605411276221275, -0.04052477702498436, 0.020384451374411583, -0.019231637939810753, 0.014796696603298187, -0.0191638246178627, 0.015583322383463383, -0.02331395260989666, -0.005513159558176994, -0.0025497516617178917, 0.0017292198026552796, -0.0007463617948815227, -0.019774137064814568, -5.3746738558402285e-05, 0.03100389428436756, -0.020899826660752296, -0.006452363450080156, -0.002197126392275095, -0.018105948343873024, 0.020031824707984924, 0.013094602152705193, -0.007940848357975483, 0.008890224620699883, 0.0010850006947293878, -0.015474822372198105, -0.0023886968847364187, 0.031546395272016525, -0.000744242686778307, -0.02826426737010479, 0.00150120013859123, 0.0012875907123088837, 0.03406902030110359, -0.011575601063668728, -0.0058895195834338665, 0.0007544145337305963, 0.015352759510278702, 0.04079602658748627, 0.02872539311647415, 0.018485698848962784, 0.005055425222963095, -0.031844768673181534, 0.01833651214838028, -0.022364577278494835, 0.0064760977402329445, -0.05416866019368172, -0.0017292198026552796, 0.004465456120669842, 0.0009493756224401295, 0.000517918320838362, -0.02142876386642456, 0.011378944851458073, 0.008130723610520363, 0.044891905039548874, 0.013447226956486702, -0.006167551036924124, -0.005499597173184156, -0.0023191890213638544, 0.01798388734459877, -0.0033007755409926176, -0.034150395542383194, -0.027219954878091812, -0.01573251001536846, -0.03789364919066429, 0.005655566230416298, -0.008890224620699883, 0.009249631315469742, 0.0055674100294709206, 0.029267894104123116, -0.005011347122490406, 0.046844903379678726, 0.02138807624578476, -0.0066524106077849865, 0.026691017672419548, -0.017387136816978455, -0.0035737210419028997, 0.00013276423851493746, 0.026121390983462334, 0.001554602524265647, -0.04011790081858635, -0.006964348256587982, 0.012884383089840412, 0.01638351008296013, -0.008551161736249924, 0.02449388988316059, 0.012762320227921009, 0.020330199971795082, -0.003216009819880128, -0.020384451374411583, -0.015135759487748146, 0.01688532344996929, -0.003256697440519929, -0.006242144387215376, 0.020018262788653374, 0.02594507858157158, 0.007344098296016455, 0.01341332122683525, -0.0064252386800944805, -0.008700349368155003, 0.016749698668718338, -0.026880891993641853, -0.029701894149184227, 0.009656506590545177, 0.0052181752398610115, -0.001101953792385757, 0.015963071957230568, 0.017495635896921158, -0.027762455865740776, 0.010280381888151169, 0.0382733978331089, -0.016288572922348976, 0.03056989423930645, 0.029946019873023033, 0.014010071754455566, -0.016180071979761124, -0.0009425943717360497, 0.006255707237869501, -0.010416006669402122, 0.0006810922059230506, -0.034150395542383194, -0.01069403812289238, 0.0072830673307180405, -0.023951390758156776, 0.0024615952279418707, -0.022459514439105988, 0.006706660613417625, -0.0053097219206392765, -0.0064760977402329445, 0.011202632449567318, -0.03542527183890343, 0.059458039700984955, -0.014674634672701359, -0.03594064712524414, -0.009744662791490555, -0.011128038167953491, -0.02525339089334011, 0.008442661724984646, -0.011399288661777973, -0.049123406410217285, 0.009059756062924862, -0.02255445159971714, 0.0011155162937939167, -0.010368538089096546, -0.008503693155944347, 0.011799382977187634, -0.011311132460832596, 0.001637672889046371, -0.007832348346710205, 0.010822881944477558, -0.011690882034599781, 0.027274204418063164, 0.006889754440635443, -0.0344758965075016, -0.00956156849861145, -0.036510273814201355, -0.003980596084147692, -0.028915269300341606, 0.007472942117601633, 0.0042416746728122234, 0.01756344921886921, 0.0034330100752413273, -0.03732402250170708, -0.04855377972126007, -0.017292197793722153, -0.010775413364171982, -0.012443602085113525, -0.050235532224178314, 0.037649523466825485, -0.03409614786505699, 0.014932322315871716, 0.019272325560450554, 0.023151202127337456, -0.009527662768959999, 0.004767221864312887, -0.0072830673307180405, -0.0004323049506638199, 0.003472002223134041, -0.00019983509264420718, 0.016369948163628578, -0.0038788774982094765, -0.019028199836611748, 0.005916644353419542, 0.009778568521142006, -0.011724788695573807, 0.022825701162219048, -0.01943507418036461, -0.012002820149064064, 0.0046010809019207954, -0.0008501997799612582, -0.005282597150653601, -0.05004565790295601, -0.013331945985555649, -0.03206177055835724, -0.006069222465157509, 0.018526386469602585, -0.015054384246468544, 0.005960722453892231, 0.013359070755541325, -0.005635222420096397, 0.05956653878092766, -0.006771082524210215, -0.003851752495393157, -0.031220894306898117, 0.02745051681995392, 0.03897865116596222, 0.006282832007855177, -0.010497381910681725, 0.025863703340291977, 0.02294776402413845, 0.06575103849172592, 0.0064794886857271194, 0.011148381978273392, -0.03892439976334572, 0.0027548845391720533, 0.030759770423173904, 0.020750638097524643, 0.01565113477408886, 0.0143355717882514, 0.005038471892476082, 0.006072613410651684, -0.033445145934820175, 0.00629978533834219, 0.03488277271389961, -0.013277695514261723, 0.007981535978615284, -0.026568954810500145, 0.006055660080164671, -0.03786652535200119, -0.02639264240860939, -0.018824761733412743, 0.004458674695342779, -0.019950449466705322, 0.04169115051627159, 0.0268266424536705, -0.034991271793842316, 0.018133074045181274, -0.039195649325847626, -0.005028299987316132, 0.005543675273656845, 0.017739761620759964, -0.020899826660752296, -0.011080569587647915, 0.00933100562542677, -0.0006420999998226762, -0.01680394820868969, -0.001398633699864149, -0.04863515496253967, 0.0034041895996779203, -0.0071881297044456005, -0.019353698939085007, 0.02450745366513729, -0.0007853540009818971, -0.008890224620699883, 0.014986571855843067, -0.010626225732266903, -0.007059285882860422, 0.0021581342443823814, 0.020926950499415398, -0.0014181297738105059, -0.03943977504968643, -0.0017716026632115245, -0.014945884235203266, -0.0007327992934733629, 0.01283013354986906, 0.05047965794801712, 0.002882033120840788, -0.01264025829732418, -0.005055425222963095, 0.010490600019693375, -0.0008485044236294925, 0.01032106950879097, -0.008476567454636097, -0.0020733685232698917, 0.0037161274813115597, 0.028372768312692642, 0.021211763843894005, -0.008062911219894886, 0.012348663993179798, 0.031871896237134933, -0.01832294836640358, -0.013196321204304695, -0.021917013451457024, -0.017753323540091515, 0.023164764046669006, 0.011799382977187634, -0.026663891971111298, 0.006927051115781069, -0.02334107831120491, 0.05243266001343727, 0.014769571833312511, 0.036808647215366364, -0.005642003379762173, -0.0030583457555621862, -0.005743722431361675, 0.03198039531707764, 0.025714516639709473, -0.01791607402265072, 0.018065260723233223, 0.009839599952101707, -0.009032630361616611, 0.007181348279118538, 0.0004560393572319299, 0.0015910518122836947, -0.009839599952101707, 0.0012248640414327383, -0.0005221565952524543, -0.010755069553852081, 0.0029617128893733025, 0.0003549562825355679, -0.006913488730788231, -0.007208473514765501, -0.022323889657855034, 0.03732402250170708, 0.007296629715710878, -0.01915026269853115, 0.01395582128316164, -0.015922384336590767, 0.012579226866364479, -0.007411911152303219, 0.033445145934820175, -0.005018128082156181, -0.003990767989307642, -0.010856788605451584, -0.042966026812791824, 0.01833651214838028, -0.00525208143517375, -0.01570538431406021, 0.006889754440635443, 0.007628911174833775, 0.013460789807140827, -0.01836363598704338, -0.007316973526030779, -0.0010349889053031802, 0.01088391337543726, 0.04155552759766579, -0.0002682833874132484, -0.014457634650170803, -0.04011790081858635, -0.04090452566742897, 0.020804887637495995, 0.03743252530694008, 0.016668323427438736, -0.03138364478945732, -0.0026226500049233437, 0.007818786427378654, -0.010402443818747997, 0.01601732335984707, -0.029566269367933273, 0.00765603594481945, -0.02783026732504368, -0.01714301109313965, 0.03526252135634422, 0.01795676164329052, -0.028806768357753754, -0.018987512215971947, 0.02140163816511631, 0.015976635739207268, -0.028942393139004707, 0.003797502489760518, 0.03751390054821968, 0.0305970199406147, -0.033038269728422165, -0.001435082987882197, 0.007222035899758339, 0.024697327986359596, 0.009290318004786968, -0.0013833758421242237, 0.006601551081985235, -0.0047197528183460236, 0.019760575145483017, -0.06439479440450668, -0.0028566033579409122, 0.022079763934016228, -0.021957701072096825, -0.004428158979862928, 0.07193554937839508, 0.007947630248963833, 0.005018128082156181, -0.04006364941596985, 0.019557137042284012, 0.013420102186501026, 0.019624950364232063, 0.0005899691022932529, -0.049177657812833786, 0.010361756198108196, 0.006493051070719957, 0.030678395181894302, -0.008693568408489227, 0.029240768402814865, 0.0036144086625427008, -0.027369141578674316, 0.00421454943716526, -0.0011053445050492883, -0.00939881894737482, 0.011975695379078388, -0.023395327851176262, -0.018092386424541473, 0.008117161691188812, -0.027626829221844673, -0.015040822327136993, 0.008720693178474903, 0.009656506590545177, 0.018268698826432228, -0.012735195457935333, 0.03602202236652374, 0.0030871659982949495, 0.005604706704616547, -0.003232962917536497, 0.040687527507543564, -0.018539950251579285, 0.03132939338684082, -0.03621189668774605, 0.0035330334212630987, -0.006574425846338272, 0.023476703092455864, -0.031112395226955414, -0.016749698668718338, -0.0037941117770969868, -0.004177252762019634, 0.009046193212270737, 0.005109675228595734, -0.018879011273384094, 0.043779779225587845, -0.030786894261837006, -0.012294414453208447, -0.01990976184606552, 0.005038471892476082, -0.029593393206596375, 0.012592789717018604, 0.014850947074592113, -0.0085782865062356, 0.0024259937927126884, -0.006052269600331783, -0.012531758286058903, 0.026975829154253006, 0.02222895249724388, -0.00805613026022911, 0.033092521131038666, 0.026270579546689987, 0.0028616893105208874, -0.01570538431406021, 0.0247787032276392, -0.013657446019351482, -0.023164764046669006, -0.03214314579963684, 0.012938633561134338, -0.01358285266906023, 0.0052181752398610115, -0.008557942695915699, 0.055931784212589264, 0.0027582752518355846, 0.021862763911485672, 0.00765603594481945, 0.002466681180521846, 0.022690076380968094, -0.02065570093691349, -0.0034669162705540657, -0.005570800509303808, -0.0038788774982094765, -0.0012841999996453524, 0.009554787538945675, 0.006387941539287567, -0.010273599997162819, 0.02176782675087452, 0.0075068483129143715, -0.009642943739891052, 0.016220759600400925, 0.011433194391429424, 0.02978326939046383, -0.01487807184457779, -0.0065574729815125465, 0.018553512170910835, -0.015081509947776794, -0.008680005557835102, -0.01836363598704338, 0.026257017627358437, -0.02069638855755329, -0.015976635739207268, -0.014484759420156479, 0.01986907608807087, 0.017400698736310005, 0.02788451686501503, 0.009202161803841591, -0.017102323472499847, 0.007676379755139351, 0.007059285882860422, 0.013826977461576462, 0.002315798308700323, -0.04939465597271919, -0.0010883912909775972, -0.007045723032206297, 0.0039195651188492775, 0.033418022096157074, 0.012138444930315018, 0.00838841125369072, -0.02746408060193062, -0.010395662859082222, -0.0077780988067388535, -0.003566939849406481, -0.02445320226252079, 0.004804518539458513, 0.026555391028523445, 0.03968390077352524, 0.012572445906698704, -0.005872566252946854, -0.02136095054447651, -0.02479226514697075, -0.034909896552562714, -0.01087713148444891, -0.013664227910339832, 0.040009401738643646, -0.03311964496970177, 0.0002568399941083044, -0.019258761778473854, 0.02412770316004753, 0.009588693268597126, -0.018512824550271034, 0.035777896642684937, -0.015325634740293026]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" the unnormalized target distribution ˜πT(s1:T) = ˜σ(s1:T)or exactly sampled from the target sh1
T
1:T∼σ(s1:T)
in the extended state space target distribution.
In particular, we begin by sampling a full sequence of indices {jt}T
t=1uniformly at random Pr(j1, j2, ...jT) = (1 /K)T.
Setting ω1
T=jT, we let ωjt
t−1=jt−1for all t. This implies the following,
ω1
T=jT, ωjt
t−1=jt−1=⇒h1
T= [[[j1, j2, ...jT]]],hjt
t−1= [[[j1, j2, ...jt−1]]], (75)
and ¯hjt
t=hjt+1
t (76)
To show these identities, note that ωjt
t−1=jt−1and Eq. (Index Notation) imply hjt
t−1=hωjt
t−1
t−2+[[[ωjt
t−1]]] =hjt−1
t−2+[[[jt−1]]] =
¯hjt−1
t−1, which matches Eq. (76). Applying this recursion again yields hjt
t−1=hjt−2
t−3+ [[[jt−2, jt−1]]]...= [[[j1, j2, ...jt−1]]].
Taken together, these notations allow us to interleave a true target sample in particular indices {jt}, guaranteeing that at
least one target samples appears at each step.
The extended state space target distribution differs from qSMCin its handling of this sequence, which identified as sh1
T
1:Twith
prefixes shjt
t−1
1:t−1using Eq. (75). Noting that sampling {jt}T
t=1amounts to specifying a particular set of ωk
tas in Eq. (75)-(76),
˜σSMC
{sk
t, ωk
t}T,K
t=1,k=1
=Pr(j1, j2, ...jT)|{z }
(1
K)T˜πT
sh1
T
1:TTY
t=1
KY
k=1
k̸=jtq
sk
tshk
t−1
1:t−1 KY
k=1
k̸=jt+1q 
ωk
ts1:K
1:t
.
(SMC Extended Target)
Note, the normalization constant of ˜σSMC(S)is equal to Zσsince only ˜πT(s1:T) = ˜σ(s1:T)is unnormalized.
To describe ancestral sampling from Eq. (SMC Extended Target), we first sample {jt}T
t=1uniformly as above, and place an
exact target sequence in indices sh1
T
1:T(or, equivalently, sequentially sample sjt
t∼πt(st|shjt
t−1
1:t−1). At each step, the remaining
K−1indices k̸=jtare sampled from the proposal. For resampling, we fix index jtto hold the exact sample and resample
the remaining K−1indices. Note that the resampling weights q 
ωk
ts1:K
1:t
in Eq. (74) include the exact sample, which
may be cloned additional times into indices other than jtif its importance weights are high. The procedure above simply
ensures that at least one exact sequence is sampled. See Alg. 2 for the pseudocode of the algorithm.
38
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Note that Maddison et al. (2017, Alg. 2) presents a different SMC extended state space target distribution than ours. In their
work, j1= 1and they sample j2:T+1, while in ours jT+1= 1and we sample j1:T. However, both targets result in the same
log partition function bounds.
Worked Example: In Fig. 2 (c), we use blue circles and arrows to highlight the exact-sample indices h1
T= [[[j1, j2]]] = [[[3,2]]]
and","[0.014075248502194881, -0.011399519629776478, 0.04426997900009155, 0.02345006726682186, -0.027811963111162186, 0.001402967725880444, 0.006074101198464632, 0.013775775209069252, -0.05713431164622307, 0.002804307732731104, 0.022603729739785194, 0.005777883343398571, -0.004527907352894545, 0.01925744116306305, 0.006471229251474142, 0.0037531827110797167, 0.020025653764605522, -0.01938764564692974, -0.03505140542984009, 0.007382669951766729, -0.020416272804141045, -0.01811162941157818, 0.012193774804472923, 0.005777883343398571, -0.011223741807043552, -0.029817132279276848, 0.006048060022294521, -0.020819909870624542, 0.03315040096640587, 0.01130837481468916, 0.03723886236548424, -0.03007754310965538, -0.03184834122657776, -0.029140062630176544, 0.005768117494881153, 0.08088385313749313, -0.01716112717986107, 0.04674388840794563, -0.05604058504104614, 0.028410909697413445, 0.0011067494051530957, -0.0413794070482254, -0.05973842740058899, 0.029608802869915962, -0.005533747375011444, 0.01852828823029995, -0.019778262823820114, -0.030025461688637733, 0.011093535460531712, 0.06260295957326889, -0.012929437682032585, 0.028697362169623375, -0.059530097991228104, -0.0012882237788289785, 0.005038965027779341, -0.04999903216958046, 0.007096217013895512, -0.0060936324298381805, 0.03156188875436783, -0.019491810351610184, 0.03143168240785599, 0.00539377611130476, 0.009654761292040348, 0.00038919333019293845, -0.01976524293422699, 0.0018342743860557675, 0.0032404973171651363, 0.04921779781579971, -0.03919195011258125, 0.0392179936170578, -0.04476476088166237, 0.01503877155482769, 0.0062010521069169044, -0.008736810646951199, -0.016926756128668785, 0.002433221088722348, -0.018346000462770462, 0.0057192905806005, 0.03382747247815132, -0.03200459107756615, 0.02100219763815403, -0.027395304292440414, 0.030103584751486778, -0.013554425910115242, -0.03137960284948349, -0.03385351225733757, 0.004622306674718857, 0.020663663744926453, -0.013346096500754356, 0.0004984441329725087, -0.025403155013918877, 0.0486709326505661, -0.01963503658771515, -0.013619528152048588, 0.07479022443294525, -0.018645472824573517, -0.003499281359836459, -0.03281186521053314, 0.030442120507359505, -0.04184814915060997, 0.024765146896243095, -0.042056478559970856, -0.012805742211639881, -0.0769776776432991, 0.05080631002783775, -0.02802029252052307, -0.0022069886326789856, 0.01064432505518198, -0.04299395903944969, -0.00537750031799078, -0.009368308819830418, -0.027056768536567688, 0.01779913529753685, 0.041900232434272766, 0.033931635320186615, -0.0019482045900076628, -0.0261453278362751, 0.011796646751463413, -0.01852828823029995, 0.03283790871500969, -0.020611580461263657, 0.004778553266078234, 0.01048807892948389, -0.00776677718386054, 0.039582569152116776, 0.010006316937506199, 0.048150110989809036, -0.08364421874284744, -0.030780654400587082, 0.054113537073135376, 0.01372369285672903, -0.014791380614042282, -0.028098415583372116, 0.0010131640592589974, 0.0003963139606639743, -0.014622113667428493, -0.007975106127560139, 0.03528577461838722, -0.014765339903533459, -0.00011006460408680141, -0.021275630220770836, -0.033905595541000366, -0.006731640547513962, 0.020377209410071373, -0.03067648969590664, -0.03374934941530228, -0.07244651764631271, 0.05364479497075081, -0.03374934941530228, 0.008945140056312084, 0.007024603895843029, -0.04182210937142372, -0.02992129698395729, 0.018671514466404915, -0.020520437508821487, -0.06432167440652847, -0.043384578078985214, 0.03315040096640587, -0.008574052713811398, -0.016458015888929367, -0.010227667167782784, 0.05494685471057892, 0.02137979492545128, 0.036379504948854446, -0.020898032933473587, -0.010084440931677818, -0.02563752606511116, 0.06765494495630264, -0.038566961884498596, -0.04156169667840004, -0.007252464070916176, -0.04822823405265808, -0.03429621085524559, -0.031613972038030624, 0.04471267759799957, -0.02395787090063095, -0.017760073766112328, -0.08062344044446945, -0.033202484250068665, -0.03658783435821533, -0.006331257987767458, 0.015064813196659088, -0.009218571707606316, -0.014700236730277538, 0.006796743720769882, -0.005839731078594923, 0.0087107690051198, 0.024726085364818573, 0.024088075384497643, -0.026262512430548668, -0.003645762801170349, 0.03281186521053314, 0.0595821812748909, -0.02024700492620468, -0.01852828823029995, -0.03619721531867981, 0.05463436245918274, 0.07598811388015747, 0.02404901385307312, -0.010624794289469719, 0.022629771381616592, 0.0021093343384563923, -0.039452362805604935, -0.006630731280893087, -0.010435996577143669, 0.025715649127960205, -0.006604690104722977, 0.035806600004434586, -0.04385332018136978, 0.02188759855926037, 0.011894301511347294, -0.026119286194443703, 0.048749059438705444, 0.02188759855926037, -0.03518161177635193, -0.013176828622817993, -0.07723809033632278, 0.0002221636677859351, 0.00773422559723258, 0.0522906556725502, 0.002898707054555416, 0.038566961884498596, 0.03749927505850792, 0.03736906871199608, -0.02261674962937832, 0.014830442145466805, 0.010299280285835266, -0.015976253896951675, 0.009153468534350395, -0.02621043100953102, 0.03619721531867981, 0.041743986308574677, 0.028384868055582047, -0.048306357115507126, -0.03984297811985016, -0.013385158032178879, -0.04617098346352577, -0.0421346016228199, -0.02195269986987114, -0.07437356561422348, -0.011464621871709824, 0.02322871796786785, 0.043384578078985214, -0.028853608295321465, 0.022668832913041115, 0.010683387517929077, -0.025168783962726593, -0.017434559762477875, -0.014804401434957981, 0.03486911952495575, 0.004153565503656864, -0.028593197464942932, -0.04804594814777374, 0.012890376150608063, -0.030858779326081276, 0.006122928578406572, 0.00024942553136497736, 0.01706998236477375, -0.018137671053409576, 0.01872359588742256, -0.01596323400735855, -0.021054280921816826, -0.04400956630706787, -0.002735949819907546, -0.031483765691518784, -0.011301864869892597, 0.03007754310965538, -0.012096120044589043, 0.09228987991809845, -0.024166200309991837, -0.0067576817236840725, 0.029556719586253166, 0.0009431783691979945, 0.017030920833349228, -0.0246870219707489, -0.04708242416381836, -0.021523021161556244, 0.02230425551533699, -0.041613779962062836, -0.012942458502948284, -0.001139300875365734, -0.05124900862574577, 0.022317277267575264, -0.005693249404430389, 0.022343318909406662, -0.02947859652340412, 0.015846047550439835, 0.06510290503501892, 0.006692579016089439, -0.05174379050731659, 0.02128865011036396, 0.008131353184580803, -0.00014292122796177864, -0.013919001445174217, -0.001491670380346477, 0.015572615899145603, -0.008235517889261246, 0.016679365187883377, 0.004596265498548746, 0.012252367101609707, 0.03820238634943962, 0.0037238863296806812, 0.018997028470039368, -0.011965914629399776, -0.003157491097226739, 0.005507706198841333, 0.025051599368453026, 0.03387955203652382, -0.014713257551193237, 0.03223896026611328, -0.022929243743419647, -0.055571842938661575, -0.014622113667428493, 0.03606701269745827, 0.010475058108568192, -0.045676201581954956, 0.05023340508341789, -0.009596168994903564, -0.008176925592124462, -0.029322350397706032, -0.035233695060014725, -0.04346270114183426, 0.012636474333703518, -0.00502919964492321, 0.01175758522003889, -0.03124939650297165, -0.010182094760239124, -0.013879939913749695, -0.02861923910677433, 0.004417232237756252, 0.018567349761724472, -0.007415221072733402, 0.014804401434957981, 0.02515576407313347, 0.008919098414480686, -0.026470841839909554, -0.0030744848772883415, 0.035806600004434586, -0.020455334335565567, 0.0580717958509922, -0.09926891326904297, 0.007760266773402691, -0.014700236730277538, -0.04515537619590759, 0.028983814641833305, -0.003061464289203286, -0.008964670822024345, 0.035702433437108994, 0.06322794407606125, -0.02449171431362629, 0.014830442145466805, 0.006454953458160162, 0.034790992736816406, 0.0005692435661330819, 0.02519482560455799, -0.024530775845050812, 0.02525992877781391, -0.028827568516135216, -0.021692289039492607, -0.023580273613333702, -0.0392700731754303, 0.00505198584869504, 0.05822804197669029, -0.005178936291486025, 0.023645376786589622, 0.03164001181721687, -0.04122316092252731, 0.007519385777413845, -0.010566201992332935, -0.005745331756770611, -0.0032763038761913776, 0.013001050800085068, 0.021470939740538597, 0.014609092846512794, -0.039895061403512955, 0.005550023168325424, 0.012877355329692364, -0.01410129014402628, 0.03968673199415207, 0.025676587596535683, 0.007662612479180098, -0.023866726085543633, -0.009199040941894054, -0.02036418952047825, 0.011920342221856117, -0.004531162325292826, -0.0004136069037485868, -0.008274579420685768, -0.024309426546096802, -0.006985541898757219, -0.014010146260261536, 0.021015219390392303, -0.021236568689346313, 0.040467966347932816, 0.010494588874280453, -0.017447579652071, -0.007727715186774731, 0.059217605739831924, 0.0515875443816185, 0.026548966765403748, -0.04565015807747841, -0.027655715122818947, -0.01720018871128559, -0.044113729149103165, -0.036379504948854446, 0.028801526874303818, 0.011399519629776478, 0.07166527956724167, 0.019426707178354263, 0.0494261272251606, 0.021848535165190697, -0.02906193770468235, 0.03518161177635193, 0.009114407002925873, 0.03656179457902908, -0.01082010380923748, -0.007057155482470989, 0.03549410402774811, 0.04841052368283272, 0.05054589733481407, -0.029686925932765007, -0.07880055904388428, 0.0034927709493786097, -0.016288748010993004, -0.04036380350589752, -0.013645569793879986, 0.01034485176205635, -0.021549062803387642, 0.037733644247055054, -0.019739201292395592, 0.002154906280338764, 0.042342931032180786, 0.022512584924697876, -0.01627572625875473, -0.016926756128668785, -0.018319958820939064, 0.017239250242710114, -0.026067204773426056, -0.021405836567282677, -0.037577398121356964, 0.00809229165315628, 0.00370435556396842, -0.03869716823101044, 0.006959500722587109, -0.010735469870269299, -0.009765435941517353, -0.007356628775596619, -0.032916031777858734, 0.013554425910115242, 0.021744372323155403, -0.007610530126839876, -0.03867112845182419, 0.02005169540643692, -0.027369262650609016, 0.014400763437151909, -0.03372330591082573, 0.04200439527630806, -0.03226500004529953, 0.025103680789470673, -0.033488936722278595, 0.013385158032178879, -0.0022541882935911417, -0.01872359588742256, 0.009954234585165977, 0.019361605867743492, 0.031041067093610764, 0.05708222836256027, -0.019114213064312935, 0.03591076284646988, 0.040311720222234726, 0.02436150796711445, -0.05322813615202904, 0.024452652782201767, -0.014726277440786362, -0.002958927070721984, -0.002180947456508875, 0.059217605739831924, -0.029400473460555077, 0.02347610890865326, 0.007148299366235733, 0.029087979346513748, -0.03778572753071785, -0.01687467470765114, 0.07952971011400223, 0.017694970592856407, 0.04369707033038139, 0.038124263286590576, -0.013267972506582737, 0.031301479786634445, 0.012428144924342632, -0.034947242587804794, -0.034087881445884705, 0.004596265498548746, -0.014348681084811687, 0.02716093324124813, -0.04304604232311249, 0.03744719177484512, -0.023645376786589622, -0.02775987982749939, 0.014648154377937317, 0.03429621085524559, 0.006842315662652254, -0.0044367630034685135, 0.05843637138605118, 0.011445091105997562, 0.022056864574551582, 0.0087237898260355, 0.0025113446172326803, 0.01792934164404869, 0.037134699523448944, -0.025546381250023842, 0.009986786171793938, -0.016158541664481163, 0.0004056725010741502, 0.019999613985419273, -0.019153276458382607, -0.031145231798291206, -0.015299183316528797, 0.021692289039492607, 0.028150497004389763, 0.0046353270299732685, -0.004840401466935873, -0.06479041278362274, -0.00035582808777689934, 0.028879649937152863, -0.02497347630560398, 0.019361605867743492, -0.10228969156742096, -0.018541308119893074, -0.04533766582608223, 0.018801720812916756, -0.004433508031070232, 0.00845686811953783, 0.006148969754576683, -0.0020751552656292915, 0.0023258014116436243, -0.0236063152551651, 0.0020247003994882107, 0.0059438953176140785, 0.03468682989478111, -0.016575200483202934, -0.02115844562649727, 0.0026220197323709726, -0.00354159832932055, 2.064982800220605e-05, -0.00843733735382557, 0.03848883882164955, 0.011113066226243973, -0.006565628107637167, 0.006109907757490873, -0.007682143244892359, -0.017017900943756104, -0.0001358005974907428, -0.0092771640047431, -0.03919195011258125, -0.012701577506959438, 0.00914044864475727, 0.018840782344341278, -0.017786115407943726, 0.0035318327136337757, 0.025520339608192444, 0.012441165745258331, -0.006288941018283367, -0.00810531247407198, -0.0033300137147307396, 0.024283384904265404, 0.005504450760781765, -0.037681564688682556, 0.026041163131594658, 0.03695240989327431, -0.03179626166820526, 0.01789028011262417, 0.018918905407190323, -0.04854073002934456, -0.003382096067070961, -0.03520765155553818, -0.023645376786589622, -0.02861923910677433, -0.012799231335520744, 0.009029773063957691, -0.026770316064357758, 0.004391191061586142, 0.014726277440786362, -0.05119692534208298, -0.026796357706189156, 0.02018190175294876, -0.00667955819517374, 0.025494299829006195, -0.01792934164404869, -0.010468547232449055, 0.040624216198921204, -0.016002295538783073, -0.008378744125366211, 0.011295354925096035, -0.055415596812963486, 0.013235420919954777, -0.013997125439345837, -0.0005948778125457466, -0.01738247647881508, -0.02164020761847496, 0.041796065866947174, 0.02579377219080925, -0.008749830536544323, -0.028983814641833305, -0.04158773645758629, 0.03833259269595146, -0.0472126305103302, 0.035363901406526566, 0.030546285212039948, 0.011998466216027737, 0.0015518906293436885, 0.008600094355642796, -0.004622306674718857, -0.01140602957457304, -0.006087122019380331, -0.0016528001287952065, 0.009784966707229614, -0.03208271414041519, 0.039582569152116776, -0.0003354834334459156, 0.001793585135601461, -0.01843714341521263, 0.03614513576030731, 5.4269377869786695e-05, -0.017551744356751442, 0.017330395057797432, 0.008476398885250092, -0.017017900943756104, -0.007870941422879696, -0.0058201998472213745, -0.010748489759862423, -0.01700487919151783, 0.008984201587736607, 0.024726085364818573, -0.014908566139638424, -0.012161223217844963, -0.007786307949572802, 0.03210875391960144, 0.038566961884498596, -0.010794062167406082, 0.025468258187174797, 0.015090853907167912, 0.014661175198853016, -0.0312754362821579, 0.022421441972255707, 0.027369262650609016, 0.0014395880280062556, 0.04291583597660065, 0.0006282430840656161, -0.020767828449606895, -0.03473891317844391, -0.017447579652071, 0.03911382704973221, -0.02775987982749939, 0.0283327866345644, -0.01850224658846855, 0.056613489985466, -0.007975106127560139, 0.013228910975158215, -0.02318965643644333, -0.022473523393273354, 0.026575006544589996, -0.003990808501839638, 0.011835708282887936, 0.02354121208190918, 0.03895758092403412, 0.04682201147079468, 0.017851216718554497, -0.020155860111117363, -0.018124649301171303, -0.008893057703971863, 0.022851120680570602, 0.011171659454703331, -0.0185543280094862, 0.01938764564692974, 0.00437817070633173, -0.016601242125034332, -0.008997221477329731, 0.00904279388487339, -0.015312204137444496, -0.014543989673256874, -0.012981520034372807, -0.05390520766377449, 0.0059959776699543, -0.010409954935312271, 0.013932022266089916, 0.026770316064357758, -0.013905981555581093, -0.01035787258297205, -0.006998562719672918, -0.009316226467490196, 0.017369456589221954, 0.016301767900586128, -0.018671514466404915, 0.010214646346867085, -0.049061551690101624, -0.030754614621400833, 0.02762967348098755, -0.01175758522003889, -0.0399211049079895, -0.029452554881572723, 0.027369262650609016, -0.0566655732691288, -0.019843365997076035, -0.00404614582657814, -0.01330703403800726, -0.04260334372520447, 0.03213479742407799, 0.03330664709210396, -0.030337955802679062, 0.008261559531092644, 0.0024039249401539564, -0.02351517044007778, 0.002805935451760888, 0.004531162325292826, -0.017590805888175964, -0.0012882237788289785, -0.004960841499269009, -0.007955575361847878, 0.0025080896448343992, -0.014999710023403168, 0.00023294634593185037, -0.04065025597810745, 0.014426804147660732, -0.006451698020100594, -0.019999613985419273, -0.04549391195178032, -0.01722623035311699, 0.008600094355642796, -0.014075248502194881, -0.00071694579673931, 0.023150594905018806, -0.006025274284183979, -0.03065044991672039, -0.008365723304450512, 0.0355982705950737, -0.016041357070207596, 0.03885341435670853, -0.018046526238322258, -0.00035887976991944015, -0.0011840591905638576, -0.0034179026260972023, -0.03809822350740433, 0.02601512148976326, 0.05604058504104614, 0.05838428810238838, 0.018645472824573517, 0.021874576807022095, -0.011275824159383774, -0.01691373623907566, -0.020793868228793144, 0.010813592933118343, -0.014426804147660732, 0.005227763671427965, 0.023645376786589622, -0.0074477726593613625, 0.019739201292395592, 0.01764288730919361, -0.02246050350368023, 0.006165245547890663, 0.0037629480939358473, 0.00740871112793684, -0.03677012398838997, 0.032056670635938644, 0.00405265623703599, -0.024296404793858528, -0.003320248331874609, -0.0072654844261705875, 0.01643197424709797, 0.017473621293902397, -0.005787648726254702, 0.026470841839909554, -0.0038768781814724207, 0.01137347798794508, 0.03695240989327431, 0.009596168994903564, -0.011601338163018227, -0.014335660263895988, -0.011438581161201, 0.010943799279630184, -0.0004156413779128343, -0.015520533546805382, -0.010943799279630184, -0.019999613985419273, -0.005875537637621164, -0.0326816588640213, -0.027838002890348434, -0.005504450760781765, -0.009199040941894054, -0.049348004162311554, 0.0060643358156085014, 0.00843733735382557, -0.04041588678956032, 0.02966088429093361, -0.0029719476588070393, 0.007005073130130768, 0.0008357585757039487, -0.14291390776634216, -0.0229032039642334, 0.04463455453515053, 0.0029849682468920946, 0.015181997790932655, -0.029608802869915962, 0.03109314851462841, -0.016614262014627457, 0.01592417061328888, -0.03791593387722969, -0.035389941185712814, -0.0001619434915482998, -0.016002295538783073, -0.0071417889557778835, 0.015077834017574787, -0.034790992736816406, -0.01640593260526657, -0.00736964913085103, -0.024921393021941185, -0.010572711937129498, -0.009934703819453716, 0.025585442781448364, -0.01172503363341093, 0.03182230144739151, -0.02718697488307953, -0.006926949601620436, -0.003460219595581293, 0.014960648491978645, -0.01850224658846855, 0.02325475960969925, 0.014075248502194881, 0.008183435536921024, 0.008684728294610977, 0.05916552245616913, -0.024869311600923538, 0.01925744116306305, -0.008665197528898716, 0.03663991764187813, 0.006887887604534626, 0.006419146899133921, -0.0033853512722998857, -0.05729055777192116, 0.06916532665491104, -0.002234657295048237, 0.03354102000594139, -0.031197313219308853, -0.015129916369915009, -0.01245418656617403, 0.01662728190422058, -0.02303340844810009, -0.015846047550439835, -0.005104068201035261, -0.0029084724374115467, 0.010130012407898903, 0.012369552627205849, -0.012656005099415779, -0.004221923649311066, 0.024986496195197105, 0.031145231798291206, 0.05028548464179039, -0.028671320527791977, 0.03372330591082573, 0.05968634784221649, -0.0450512133538723, -0.04619702324271202, -0.040754418820142746, -0.013567445799708366, 0.00774073600769043, 0.02671823278069496, 0.012603922747075558, -0.004563713911920786, 0.01035787258297205, -0.009218571707606316, 0.00302240252494812, 0.0034960261546075344, 0.027525508776307106, -0.030155668035149574, 0.012200284749269485, -0.035936806350946426, 0.009387839585542679, 0.005276590585708618, -0.045572035014629364, 0.013554425910115242, -0.01910119317471981, -0.01722623035311699, -0.01770799048244953, 0.011477642692625523, 0.026561986654996872, -0.004746002145111561, 0.05359271541237831, 0.007662612479180098, -0.003583915065973997, 0.019713161513209343, -0.005683484021574259, -0.014218474738299847, -0.03315040096640587, -0.007675632834434509, 0.00573556637391448, 0.02572866901755333, 0.006790233310312033, 0.023684438318014145, 0.0020393487066030502, 0.0060187638737261295, -0.04856676980853081, 0.005856006406247616, -0.001181617844849825, -0.011021922342479229, 0.014869504608213902, 0.0038020098581910133, -0.009778456762433052, 0.012864334508776665, -0.014661175198853016, -0.03859300538897514, -0.0005179750151000917, 0.018098607659339905, 0.00537098990753293, 0.03223896026611328, 0.002127237617969513, 0.009394349530339241, 0.011894301511347294, -0.003769458504393697, 0.013079173862934113, 0.003092388156801462, -0.010989370755851269, -0.019283480942249298, 0.010650835931301117, -0.0022525605745613575, 0.029869213700294495, -0.0018098608125001192, -0.01475231908261776, 0.03515557199716568, 0.010501098819077015, 0.05070214346051216, -0.019804304465651512, -0.008307131007313728, 0.029843173921108246, 0.03239520639181137, 0.01693977601826191, -0.03294207155704498, 0.002037720987573266, -0.00736964913085103, -0.012825272977352142, 0.0028482521884143353, 0.03020774945616722, 0.012148202396929264, -0.028228621929883957, -0.005195212084800005, -0.026926562190055847, 0.010585732758045197, 0.022629771381616592, 0.018137671053409576, 0.013267972506582737, 0.009941213764250278, -0.01735643483698368, 0.009159979410469532, 0.010859165340662003, -0.024947434663772583, -0.021327713504433632, 0.005836475640535355, 0.0033918614499270916, 0.008853995241224766, 0.06624872237443924, 0.012922927737236023, -0.017694970592856407, 0.03505140542984009, -0.006435422692447901, -0.025233887135982513, 0.014843462966382504, -0.04184814915060997, 0.026249492540955544, 0.00737615954130888, -0.04994695261120796, 0.007070175837725401, 0.02950463816523552, 0.035103488713502884, -0.015911150723695755, 0.01503877155482769, -0.018827760592103004, 0.0014851600863039494, 0.008534991182386875, 0.008007657714188099, 0.025767730548977852, -0.04432205855846405, 0.033514976501464844, 0.03164001181721687, -0.04041588678956032, -0.012447675690054893, -0.02042929269373417, -0.018124649301171303, 0.009531065821647644, -0.0001221696729771793, 0.027108851820230484, -0.001573048997670412, 0.04697825759649277, -0.0056476774625480175, 0.015299183316528797, -0.02367141656577587, -0.009986786171793938, 0.0025910958647727966, -0.012434655800461769, -0.02789008617401123, 0.04124920442700386, 0.01232398021966219, -0.019153276458382607, -0.008840975351631641, 0.02643178030848503, -0.04895738884806633, 0.002195595530793071, -0.012896886095404625, -0.011178169399499893, 0.014439824968576431, -0.008248538710176945, -0.012460696510970592, -0.00370435556396842, -0.01503877155482769, -0.08895661681890488, -0.002499951748177409, -0.0007291525835171342, -0.05203024297952652, -0.008704259060323238, -0.01307266391813755, -0.01467419508844614, -0.03627534210681915, 0.03184834122657776, -0.023528190329670906, 0.0062628998421132565, 0.011223741807043552, 0.004173096269369125, -0.03395767882466316, 0.00432934332638979, 0.008385255001485348, 0.009889131411910057, 0.0012304449919611216, -0.029270267114043236, -0.009199040941894054, 0.03229104354977608, -0.005999233108013868, -0.010624794289469719, -0.006171755492687225, -0.016835611313581467, -0.0002343704691156745, 0.003072857391089201, -0.020754806697368622, -0.02303340844810009, 0.0009903779719024897, -0.02499951608479023, 0.015455430373549461, 0.013333075679838657, -0.02963484451174736, -0.02151000127196312, -0.021913638338446617, 0.013619528152048588, 0.026067204773426056, -0.024595879018306732, -0.00975892599672079, 0.01811162941157818, -0.00843733735382557, 0.05330626294016838, 0.048905305564403534, 0.010611774399876595, -0.016301767900586128, -0.02303340844810009, 0.020481374114751816, -0.021106362342834473, 0.008697748184204102, -0.04140545055270195, -0.001488415291532874, -0.007161319721490145, -0.031145231798291206, -0.011510194279253483, -0.02440056949853897, 0.0015177115565165877, -0.011581807397305965, 0.04226480796933174, 0.016822591423988342, -0.018827760592103004, -0.005165915936231613, -0.004973862320184708, 0.0014859738294035196, 0.01656218059360981, -0.031718138605356216, 2.5735993403941393e-05, -0.03882737457752228, -0.025298990309238434, 0.03140564262866974, 0.0059569161385297775, -0.008287600241601467, 0.0035513637121766806, 0.029166102409362793, -0.019504832103848457, 0.06260295957326889, 0.00975892599672079, -0.027655715122818947, -0.0016763998428359628, -0.012376062572002411, 0.011477642692625523, -0.022668832913041115, 0.03645762801170349, 0.0034732401836663485, -0.037733644247055054, -0.0099932961165905, 0.018606411293148994, -0.00996074452996254, -0.007975106127560139, 0.019309522584080696, 0.023085491731762886, 0.000515126739628613, 0.0027538530994206667, -0.0341399647295475, -0.0319785475730896, 0.006874867249280214, -0.011393008753657341, -0.022161029279232025, 0.016418954357504845, 0.04109295457601547, -0.0022558157797902822, 0.022759975865483284, -0.005283100996166468, -0.014114310964941978, 0.016458015888929367, -0.007070175837725401, -0.021679269149899483, 0.016041357070207596, -0.00047972705215215683, -0.02113240398466587, 0.029166102409362793, 0.02804633229970932, -0.041457533836364746, -0.004423742648214102, 0.014231495559215546, -0.022577688097953796, 0.03135355934500694, 0.0077081844210624695, 0.005165915936231613, -0.011913832277059555, 0.01510387472808361, -0.01618458330631256, -0.013958063907921314, -0.003925705328583717, -0.030780654400587082, -0.014609092846512794, -0.0072654844261705875, -0.01010397169739008, 0.011913832277059555, 0.01687467470765114, 0.013189849443733692, -0.0007043320802040398, 0.0015201529022306204, 0.001344375079497695, -0.021848535165190697, 0.07067571580410004, -0.003733651712536812, -0.023280799388885498, -0.009016753174364567, -0.0019709905609488487, 0.006022018846124411, -0.021366775035858154, 0.012350021861493587, -0.029166102409362793, 0.017213208600878716, -0.01305313315242529, 0.0034537091851234436, -0.019804304465651512, -0.01104145310819149, 0.018892863765358925, -0.005761607550084591, -0.028228621929883957, 0.018476204946637154, 0.009869600646197796, -0.015234080143272877, 0.02354121208190918, 0.012975010089576244, -0.02775987982749939, 0.026028143242001534, -0.007903493009507656, -0.009270654059946537, -0.011907322332262993, 0.002429966116324067, -0.013124746270477772, -0.008834464475512505, -0.015728862956166267, -0.014361701905727386, -0.03796801716089249, -0.011262803338468075, -0.0016625655116513371, -0.024739105254411697, -0.03661387413740158, 0.024075055494904518, 0.004866442177444696, 0.01789028011262417, 0.035650353878736496, -0.0031786495819687843, -0.012382573448121548, 0.002831976627930999, -0.015221060253679752, -0.015377307310700417, -0.011842219159007072, -0.027785921469330788, -0.002975202864035964, 0.010156054049730301, -0.013014071621000767, -0.0023876491468399763, 0.020103778690099716, -0.03229104354977608, 0.011685972101986408, 0.0006681185914203525, -0.002921493025496602, 0.017252270132303238, 0.014765339903533459, -0.016731446608901024, -0.021809473633766174, -0.01165993046015501, -0.007883962243795395, 0.007643081247806549, 0.023749541491270065, -0.015168977901339531, 0.015312204137444496, 0.0072003817185759544, 0.027213016524910927, 0.040051307529211044, 0.0011344181839376688, 0.011523215100169182, -0.027134891599416733, 0.03528577461838722, 0.006966011133044958, 0.01107400469481945, 0.007773287128657103, 0.019088173285126686, 0.006666537839919329, 0.07447772473096848, -0.003873622976243496, 0.00875634141266346, -0.015390327200293541, 0.027785921469330788, -0.010579222813248634, 0.022994346916675568, -0.005257059819996357, 0.002273719059303403, -0.00975892599672079, 0.02164020761847496, -0.014413784258067608, -0.0006510290550068021, 0.0013378647854551673, -0.016379890963435173, 0.0029410237912088633, -0.04028568044304848, 0.03716073930263519, -0.02097615785896778, 0.010865675285458565, -0.0036750591825693846, -0.01868453435599804, -0.018788699060678482, 0.020260024815797806, 0.015234080143272877, -0.032160837203264236, 0.012942458502948284, -0.05604058504104614, -0.00041035175672732294, 0.0057583521120250225, 0.01748664118349552, -0.02334590256214142, 0.011946383863687515, -0.004905504174530506, -0.007590998895466328, -0.021783433854579926, -0.021965721622109413, -0.07609228044748306, 0.006816274486482143, -0.009557106532156467, -0.006712109781801701, 0.012499758042395115, 0.0062791756354272366, -0.016353851184248924, -0.012200284749269485, 0.008229007944464684, -0.00864566583186388, -0.007831879891455173, -0.0038801333867013454, -0.017083002254366875, -0.02846299111843109, -0.022056864574551582, 0.003476495388895273, 0.009264144115149975, 0.01548147201538086, 0.037837810814380646, 0.006152224726974964, -0.011100046336650848, -0.011178169399499893, 0.0074607934802770615, 0.013697652146220207, 0.0019970317371189594, -0.0033853512722998857, -0.006874867249280214, 0.022512584924697876, 0.0034504542127251625, 0.022226132452487946, -0.004274006001651287, -0.0031981803476810455, 0.03671804070472717, -0.028593197464942932, 0.005120343528687954, -0.004723215941339731, -0.013333075679838657, 0.010663856752216816, 0.0017301097977906466, -0.024192240089178085, -0.010286259464919567, -0.022317277267575264, 0.03531181812286377, 0.03328060731291771, 0.01808558776974678, -0.010214646346867085, -0.022955285385251045, -0.0026741018518805504, 0.024765146896243095, 0.00541005190461874, -0.03458266332745552, 0.012213305570185184, -0.0018879843410104513, -0.02164020761847496, 0.00023579459229949862, -0.0025829579681158066, -0.019361605867743492, -0.022955285385251045, -0.02300736866891384, -0.006031784228980541, 0.0167184267193079, 0.00383456121198833, 0.006650262046605349, 0.02773383818566799, -0.004000573884695768, -0.033931635320186615, 0.04781157523393631, 0.004114503972232342, -0.0036164666526019573, 0.020025653764605522, 0.016861652955412865, 0.026666151359677315, -0.00318515975959599, 0.017994442954659462, -0.006874867249280214, 0.005859261844307184, -0.020702725276350975, -0.03140564262866974, 0.019023070111870766, 0.012174244038760662, -0.00869123823940754, 0.01337213721126318, -0.012766680680215359, 0.02201780304312706, -0.007538917008787394, -0.012727618217468262, -0.012148202396929264, 0.016575200483202934, 0.04049400985240936, -0.009348778054118156, -0.008717279881238937, -0.029608802869915962, -0.02354121208190918, 0.037994056940078735, 0.060519665479660034, -0.0033462895080447197, -0.0074607934802770615, 0.015390327200293541, 0.015611677430570126, -0.023397985845804214, 0.02318965643644333, -0.013235420919954777, 0.011666441336274147, -0.008255048654973507, -0.012408614158630371, 0.012376062572002411, 0.039738815277814865, -0.017942361533641815, -0.053540632128715515, 0.03328060731291771, 0.010208136402070522, -0.02864527888596058, 0.013541405089199543, 0.02097615785896778, 0.015195018611848354, -0.023085491731762886, -0.02522086724638939, 0.0052668252028524876, 0.041066914796829224, 0.018163710832595825, 0.032629579305648804, -0.01874963752925396, 0.00020222591410856694, 0.02338496409356594, -0.043488744646310806, -0.0012101003667339683, 0.01005839928984642, -0.0031330774072557688, 0.012701577506959438, 0.055884335190057755, 0.0013101960066705942, -0.012948968447744846, -0.038436755537986755, 0.00736964913085103, 0.020220963284373283, 0.03223896026611328, 0.022916223853826523, -0.05609266459941864, 0.01005839928984642, -0.00773422559723258, 0.037837810814380646, -0.03367122262716293, 0.03499932214617729, 0.009231592528522015, -0.015273142606019974, 0.01649707742035389, 0.009081855416297913, -0.012851313687860966, 0.019218377768993378, 0.0001553314650664106, -0.013905981555581093, 0.005904833786189556, -0.003915939945727587, -0.02700468711555004, -0.00468089897185564, -0.00253413082100451, -0.0030321679078042507, -0.009316226467490196, 0.02820258028805256, 0.005276590585708618, -0.0019091428257524967, 0.010605263523757458, 0.031613972038030624, -0.01738247647881508, 0.03835863247513771, -0.029843173921108246, 0.01903609000146389, 0.008945140056312084, 0.016510097309947014, -0.04885322228074074, -0.0024315936025232077, 0.014999710023403168, -0.012747149914503098, 0.01335911639034748, 0.009895642288029194, -0.02506461925804615, 0.02020794339478016, -0.032186876982450485, -0.03210875391960144, -0.03424413129687309, -0.007721204776316881, -0.05288960412144661, -0.0008133794763125479, 0.011432070285081863, -0.00977194681763649, -0.011132596991956234, -0.005253804847598076, -0.024700043722987175, 0.025832833722233772, 0.008339682593941689, -0.015351265668869019, 0.02528597041964531, 0.020025653764605522, -0.008782382123172283, 0.023593293502926826, 0.022916223853826523, 0.0021321203093975782, -0.02391880936920643, -0.027785921469330788, 0.02020794339478016, 0.009980276226997375, -0.00019541045185178518, -0.0023957870434969664, 0.03330664709210396, -0.019491810351610184, 0.0032632832881063223, 0.011327906511723995, 0.009921682998538017, 0.02775987982749939, -0.0064614638686180115, -0.00839176494628191, 0.0026789847761392593, -0.0030858777463436127, -0.02119750715792179, 0.014700236730277538, 0.007356628775596619, -0.014973669312894344, 0.031874384731054306, 0.024101097136735916, -0.010995881631970406, 0.004641837440431118, 0.01760382577776909, 0.015689801424741745, -0.023502150550484657, -0.0020442313980311155, 0.020963136106729507, -0.005904833786189556, -0.012213305570185184, -0.035676393657922745, 0.011347437277436256, -0.01687467470765114, -0.020168881863355637, -0.008352703414857388, 0.00018757775251287967, 0.018007464706897736, 0.014218474738299847, 0.0014696981525048614, -0.00467113358899951, 0.02802029252052307, -0.004176351707428694, -0.002062134677544236, -0.023931829258799553, -0.005302631761878729, -0.0030744848772883415, 0.006135948933660984, 0.012695067562162876, 0.02835882641375065, 0.021184487268328667, 0.02341100573539734, -0.01467419508844614, -0.013124746270477772, -0.005133364349603653, 0.005432837642729282, -0.021405836567282677, 0.0018114884151145816, 0.03911382704973221, 0.03848883882164955, 0.016744468361139297, -0.01548147201538086, -0.017773093655705452, -0.017981423065066338, -0.04080650210380554, 0.011060983873903751, -0.010273238644003868, 0.028983814641833305, -0.01649707742035389, -0.03135355934500694, -0.0214188564568758, 0.00437166029587388, 0.010663856752216816, -0.012942458502948284, 0.015208039432764053, 0.00901024229824543]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" the target sequence sh1
T
1:T= [[[s3
1, s2
2]]]. Using the recursion ωjt
t−1=jt−1withjT+1=j3= 1fixed, we may also express
h1
T= [[[j1, j2]]] = [[[3,2]]] = [[[ω2
1, ω1
2]]]. At step 2, note the target sequence is sampled/evaluated an additional time in index 3.
Importance Weights in the Extended State Space Assume we are given a fixed set of {sk
t, ωk
t}T,K
t=1,k=1, which may be
sampled from either σSMC(S)orqSMC(S). We proceed to show that the unnormalized importance weights in the extended
state space simplify as follows.
Lemma F.1. For the extended state space target ˜σSMCand proposal qSMCabove, the simple importance weights in the
extended state space become
˜σSMC
qSMC
{sk
t, ωk
t}T,K
t=1,k=1
=TY
t=11
KKX
k=1˜πt
s¯hk
t
1:t
˜πt−1
shk
t−1
1:t−1
q
sk
tshk
t−1
1:t−1=TY
t=11
KKX
k=1wt
s¯hk
t
1:t
=:TY
t=11
KKX
k=1wt(sk
1:t)
(77)
which can be used to obtain unbiased Zσestimators (Eq. (8)) or bounds on logZσ(Prop. 5.1, with proof below).
Proof. To evaluate the importance weights (with the goal of estimating Zσ), we consider
˜σSMC
qSMC
{sk
t, ωk
t}T,K
t=1,k=1
= 1
KT˜πT
sh1
T
1:TQT
t=1""
QK
k=1
k̸=jtq
sk
tshk
t−1
1:t−1QK
k=1
k̸=jt+1q 
ωk
ts1:K
1:t#
QT
t=1""
QK
k=1q
sk
tshk
t−1
1:t−1QK
k=1q 
ωk
ts1:K
1:t# (78)
(1)=1
KT
˜πT
sh1
T
1:TTY
t=11
q
sjt
tshjt
t−1
1:t−1
q
ωjt+1
ts1:K
1:t (79)
where in (1), note that terms in the denominator cancel except for the indices [[[0, j1, ...jT]]] =h1
T. Recalling that ωjt+1
t=jt
from Eq. (76), we expand the resampling weights q(jt|s1:K
1:t)for the sequence indexed by sjt
t,shjt
t−1
1:t−1, ands¯hjt
t
1:t−1,
(2)=1
KT
˜πT
sh1
T
1:TTY
t=1KP
k=1˜πt 
s¯hk
t
1:t!
˜πt−1 
shk
t−1
1:t−1!
q 
sk
tshk
t−1
1:t−1!

q
sjt
tshjt
t−1
1:t−1˜πt 
s¯hjt
t
1:t!
˜πt−1
shjt
t−1
1:t−1


q
sjt
tshjt
t−1
1:t−","[0.04285528510808945, -0.0007690736092627048, 0.0330582931637764, 0.014800266362726688, -0.008146695792675018, -0.019463004544377327, 0.0036476762033998966, 0.01863785833120346, -0.03897840157151222, 0.021781276911497116, 0.02787165157496929, 0.03075312077999115, -0.040864452719688416, 0.038926009088754654, 0.02022266574203968, 0.015586121007800102, 0.030255412682890892, -0.008932550437748432, -0.03607073798775673, 0.052128370851278305, -0.020353641360998154, -0.039895232766866684, 0.02468894049525261, 0.0038277681451290846, -0.00475769629701972, -0.03552063927054405, 0.02802882343530655, -0.017236417159438133, 0.05191881209611893, -0.0189129076898098, 0.05872955173254013, -0.044479385018348694, 0.0017403410747647285, -0.007596597075462341, -0.013267849572002888, 0.06768830120563507, -0.04440080001950264, 0.05244271457195282, -0.05899150297045708, 0.015363462269306183, 0.01580877974629402, -0.02605108916759491, -0.05684350058436394, 0.02666667476296425, 0.014066802337765694, 0.043064847588539124, -0.03017682582139969, -0.013988216407597065, 0.006463656201958656, 0.014787169173359871, -0.01123772468417883, 0.04377211630344391, -0.041597917675971985, -0.01359528861939907, -0.005455142352730036, -0.02899804338812828, 0.009469551034271717, 0.007282255217432976, -0.011958091519773006, -0.006417814642190933, 0.06223970651626587, 0.0030075320973992348, 0.007256059907376766, -0.0135036064311862, -0.013739362359046936, -0.004011134151369333, -0.0042501650750637054, 0.03426327183842659, -0.021152593195438385, 0.04843485355377197, -0.04636543616652489, 0.039790451526641846, 0.042960066348314285, 0.016267195343971252, -0.003595286048948765, 0.0035330725368112326, -0.017184026539325714, 0.01542895007878542, 0.02474133111536503, -0.015324169769883156, 0.01432875357568264, 0.000852161378134042, 0.059672579169273376, -0.014407339505851269, -0.00181892653927207, -0.05273086205124855, -0.0075376578606665134, -0.022554034367203712, -0.0449770912528038, 0.001084643416106701, -0.04400787129998207, 0.023248206824064255, -0.02594630792737007, -0.004846104886382818, 0.06255404651165009, -0.019567785784602165, 0.02247544936835766, 0.0014423710526898503, 0.012121811509132385, -0.05165686085820198, 0.025121159851551056, -0.04254094138741493, 0.0055730207823216915, -0.03538966551423073, 0.027216773480176926, 0.0022920765914022923, -0.02315652370452881, 0.011997384019196033, -0.04961363598704338, -0.0016281930729746819, 0.004115914925932884, -0.021204983815550804, -0.010884089395403862, 0.05380486324429512, 0.036332689225673676, -0.008998038247227669, -0.05165686085820198, -0.010785858146846294, -0.02577603980898857, 0.005848069675266743, 0.014472827315330505, -0.018441393971443176, 0.0033398831728845835, 0.0011542242718860507, 0.018389003351330757, -0.018022270873188972, 0.014341850765049458, -0.03216765820980072, -0.02719057723879814, 0.0012098890729248524, 0.02254093624651432, -0.004184677265584469, -0.021493131294846535, -0.03222005069255829, -0.02690243162214756, -0.00954158790409565, -0.008690244518220425, 0.060825165361166, 0.013948923908174038, 0.023300597444176674, 0.018703345209360123, -0.003241651225835085, -0.044374603778123856, 0.0190831758081913, -0.02383759804069996, -0.004423708189278841, -0.036332689225673676, 0.05935823544859886, -0.03085790015757084, 0.0013253114884719253, 0.017969880253076553, -0.03426327183842659, -0.027897847816348076, -0.010870992206037045, 0.02288147434592247, -0.05453832820057869, -0.011198432184755802, 0.032979708164930344, -0.005537002347409725, -0.013752460479736328, -0.006967912893742323, 0.031067462638020515, -0.0014751150738447905, 0.027426334097981453, 0.019842835143208504, 0.0024476104881614447, -0.029233800247311592, 0.02015717700123787, -0.046863146126270294, -0.038926009088754654, -0.0017894570482894778, -0.04877538979053497, -0.01732810027897358, -0.013130324892699718, 0.0021643752697855234, -0.0026047814171761274, -0.04151933267712593, -0.032822538167238235, -0.04523904621601105, -0.04240996763110161, 0.02055010385811329, 0.019567785784602165, -0.012318274937570095, -0.014682387933135033, -0.018362808972597122, 0.026705967262387276, 0.04853963479399681, 0.013490508310496807, 0.03449902683496475, -0.026797650381922722, -0.01243615336716175, 0.05579569563269615, 0.030386388301849365, -0.035206299275159836, -0.027609700337052345, -0.05658154934644699, 0.0449770912528038, 0.09074003994464874, 0.024374598637223244, -0.0015692539745941758, 0.027426334097981453, -0.0032547488808631897, 0.010523905977606773, 0.005857893265783787, -0.02265881560742855, 0.017852002754807472, 0.024256719276309013, 0.013542898930609226, -0.05998691916465759, -0.009240343235433102, 0.01342502050101757, -0.012606421485543251, 0.03800918161869049, 0.020825153216719627, 0.002172561129555106, 0.03308448940515518, -0.04322201758623123, -0.0009274724288843572, -0.03132941201329231, 0.04178128391504288, -0.026286844164133072, 0.05579569563269615, 0.024034060537815094, 0.0012811071937903762, -0.04235757514834404, 0.04070728272199631, 0.0567387193441391, -0.019358225166797638, 0.0276882853358984, -0.032534390687942505, 0.019214151427149773, 0.04183367267251015, 0.007616243325173855, -0.03156517073512077, -0.007039949763566256, -0.0165291465818882, -0.02146693505346775, -0.0408906489610672, -0.02371971867978573, -0.07675182819366455, -0.010543552227318287, 0.013686971738934517, 0.02497708611190319, 0.023130327463150024, 0.003140144981443882, 0.00237884814850986, -0.022671911865472794, -0.011198432184755802, -0.037118542939424515, 0.008297317661345005, 0.014066802337765694, -0.001746889902278781, -0.021257374435663223, 0.02260642498731613, -0.07947611808776855, 0.0031008522491902113, 0.00337590160779655, 0.035022933036088943, -0.0025671259500086308, 0.032141461968421936, -0.03507532179355621, -0.05474788695573807, -0.0028585470281541348, 0.0015160449547693133, -0.019043883308768272, 0.0076227919198572636, 0.04757041484117508, -0.010157174430787563, 0.03499673679471016, 0.0002850770251825452, -0.00681074196472764, 0.03182712197303772, -0.02010478638112545, 0.030281607061624527, -0.04416504129767418, -0.023483961820602417, -0.035258688032627106, 0.022278985008597374, -0.054905060678720474, 0.016489854082465172, -0.021899156272411346, -0.04893256351351738, 0.0290504340082407, 0.010674528777599335, 0.027609700337052345, -0.037066154181957245, -0.005160446744412184, 0.09105437994003296, 0.02208252064883709, -0.05647676810622215, 0.024374598637223244, 0.0161886103451252, 0.05055666342377663, -0.01288147084414959, -0.008631305769085884, 0.011263919994235039, -0.029312387108802795, -0.026522601023316383, -0.02311723120510578, 0.006712510250508785, 0.06003931164741516, -0.011591359041631222, 0.004171579610556364, 0.005736740306019783, -0.04049772024154663, -0.001541421515867114, 0.025239039212465286, 0.00022327282931655645, -0.05058285593986511, 0.05170924961566925, -0.004515390843153, 0.028159799054265022, -0.040969233959913254, 0.005772758740931749, -0.04377211630344391, -0.0642305389046669, 0.040916841477155685, 0.003197446931153536, -0.031015072017908096, -0.03303210064768791, -0.018755735829472542, -0.04426982253789902, 0.02419123239815235, -0.010943029075860977, 0.02910282462835312, -0.010654882527887821, -0.06072038412094116, 0.021309765055775642, -0.029888680204749107, -0.016057634726166725, 0.03182712197303772, -0.002626064931973815, 0.011132943443953991, -0.002156189177185297, -0.010975772514939308, -0.0402095727622509, -0.020471518859267235, 0.07664704322814941, -0.007210218347609043, 0.043405383825302124, -0.08408647030591965, -0.031853318214416504, -0.023287499323487282, -0.014931241981685162, 0.011689591221511364, 0.010425674729049206, 0.00724951084703207, 0.012292079627513885, 0.037459082901477814, 0.010890638455748558, -0.00232318346388638, 0.005108056589961052, 0.0313556082546711, -0.03159136697649956, 0.035363469272851944, -0.014341850765049458, 0.0088605135679245, -0.03924035280942917, -0.028552725911140442, -0.009246892295777798, -0.03431566059589386, 0.0009291096357628703, 0.03845449909567833, 0.0036804203409701586, 0.006466930732131004, 0.0368042029440403, 0.0014350037090480328, 0.002396857365965843, -0.0221480093896389, 0.0013425020733848214, 0.012639165855944157, 0.02107400819659233, -0.006267192307859659, 0.002432875568047166, -0.05108056589961052, -0.01986902952194214, 0.0051768189296126366, 0.0050261965952813625, 0.016241000965237617, 0.028631312772631645, 3.448347342782654e-05, 0.012521287426352501, -0.023929281160235405, -0.0344204418361187, 0.0368042029440403, -0.01920105330646038, 0.014826461672782898, 0.010353637859225273, -0.04026196524500847, -0.008519976399838924, 0.006142765283584595, -0.015782585367560387, -0.0008488869643770158, 0.015979047864675522, 0.008991489186882973, -0.027714481577277184, -0.010681076906621456, 0.052128370851278305, 0.05390964448451996, 0.01574329286813736, -0.041021622717380524, -0.010707272216677666, -0.036044541746377945, -0.029312387108802795, -0.03229863569140434, -0.011362151242792606, 0.014891949482262135, 0.038533084094524384, 0.013071386143565178, 0.06836937367916107, 0.046915534883737564, 0.026548797264695168, 0.046758364886045456, -0.01178127434104681, -0.0030337271746248007, -0.03798298537731171, -0.01743287965655327, 0.026430917903780937, -0.005520630162209272, 0.010595942847430706, -0.017000660300254822, -0.024217426776885986, 0.006254095118492842, -0.02315652370452881, -0.04916831851005554, -0.009305831044912338, -0.022213498130440712, -0.05155207961797714, 0.029574338346719742, -0.06365424394607544, 0.00039763437234796584, 0.052364129573106766, 0.004305829759687185, 0.005870990455150604, -0.01019646693021059, 0.00787164643406868, 0.041938453912734985, 0.0025163728278130293, -0.004967257380485535, -0.02271120622754097, -0.0037884751800447702, -0.005147349089384079, -0.03507532179355621, 0.03085790015757084, -0.01896529644727707, -0.006758351810276508, -0.006001966539770365, -0.04835626855492592, 0.018533077090978622, 0.006617552600800991, 0.0034217429347336292, -0.03567780926823616, 0.04026196524500847, -0.016778001561760902, -0.00965291727334261, -0.04424363002181053, 0.0175507590174675, -0.021532423794269562, 0.017707929015159607, -0.03659464046359062, -0.004178128205239773, -0.010713821277022362, 0.0011550429044291377, 0.019332028925418854, -0.0009741325629875064, 0.0064079915173351765, 0.03664703294634819, -0.016070730984210968, 0.015769487246870995, 0.035206299275159836, 0.006322856992483139, -0.05521940067410469, 0.051394905894994736, -0.0415717214345932, 0.019187957048416138, 0.027662090957164764, 0.0829862728714943, -0.0276882853358984, 0.018218735232949257, -0.012409958057105541, 0.010065491311252117, -0.0770137757062912, -0.03651605546474457, 0.023994768038392067, 0.04610348492860794, 0.05118534713983536, 0.0695219561457634, -0.017026854678988457, 0.018952200189232826, -0.0005488704773597419, 0.019070077687501907, -0.022868376225233078, 0.02666667476296425, -0.014590704813599586, 0.022043228149414062, -0.002791421953588724, 0.02388998679816723, -0.009476100094616413, -0.017315002158284187, -0.01047806441783905, 0.04049772024154663, -0.04073347523808479, -0.0004948429996147752, 0.0432744063436985, -0.0072888038121163845, 0.033556003123521805, 0.010975772514939308, 0.012075969949364662, 0.0014554687077179551, 0.06522595137357712, -0.01362148392945528, -0.01189260371029377, 0.0010248856851831079, 0.000866077549289912, 0.00025724468287080526, -0.006692864000797272, -0.0008587101474404335, 0.014485924504697323, 0.015153900720179081, 0.00030574665288440883, -0.005756387021392584, 0.00199574395082891, -0.01435494888573885, -0.004639817867428064, 0.012278982438147068, -0.04830387979745865, 0.0006282745744101703, -0.09891293197870255, -0.01322855707257986, -0.050085149705410004, 0.007950231432914734, -0.009796991012990475, -0.010019649751484394, 0.01208906713873148, 0.00020628690253943205, -0.0006385070737451315, 0.0005664703785441816, -0.0109888706356287, 0.026981016620993614, 0.029312387108802795, -0.020065493881702423, -0.015022925101220608, 0.007996072992682457, -0.00968566071242094, 0.015730194747447968, -0.01683039218187332, 0.04945646598935127, -0.004368043038994074, 0.009666014462709427, -0.021204983815550804, -0.014865754172205925, -0.029993459582328796, 0.013326788321137428, -0.01608382910490036, -0.04534382373094559, 0.006771449465304613, 0.0007932222215458751, 0.044767532497644424, -0.016895879060029984, 0.005049117375165224, 0.033844150602817535, 0.0010911922436207533, -0.009908320382237434, 0.01625409722328186, -0.020353641360998154, 0.014407339505851269, 0.014485924504697323, -0.00042771786684170365, 0.03413229435682297, 0.04859202355146408, -0.00648330245167017, 0.004705306142568588, 0.01364767923951149, -0.021322861313819885, 0.006244271527975798, -0.019410615786910057, -0.017996076494455338, -0.02690243162214756, -0.01435494888573885, -0.00877537950873375, -0.04149313643574715, -0.016568439081311226, -0.011532420292496681, -0.03240341693162918, -0.01874263770878315, -0.006417814642190933, 0.004184677265584469, 0.024715134873986244, -0.02797643281519413, 0.02753111533820629, 0.02978389896452427, -0.00492469035089016, -0.011283566243946552, 0.022161107510328293, -0.033948928117752075, 0.02436150051653385, -0.0480419285595417, 0.010432222858071327, -0.0034970541018992662, 0.0009291096357628703, 0.029757704585790634, 0.0175507590174675, -0.0019220700487494469, -0.03717093542218208, -0.06632614880800247, 0.0439554825425148, -0.04010479152202606, 0.0029993460047990084, 0.008192537352442741, 0.03798298537731171, -0.0010232485365122557, 0.004957434255629778, -0.01630648784339428, 0.013438117690384388, -0.015442048199474812, -0.022855278104543686, -0.0004207597812637687, -0.011761628091335297, 0.04104781895875931, 0.006204979028552771, -0.010851345956325531, -0.008578915148973465, 0.050320904701948166, -0.03182712197303772, -0.013962021097540855, 0.05993453040719032, 0.006463656201958656, -0.025042574852705002, 0.010124430060386658, -0.024950891733169556, -0.013064837083220482, -0.019580883905291557, 0.0018844144651666284, 0.003755731275305152, -0.02196464315056801, 0.015952853485941887, 0.006804193370044231, 0.049692220985889435, 0.0436149463057518, -0.015337266959249973, 0.042226601392030716, 0.003490505274385214, 0.030386388301849365, -0.036044541746377945, 0.008736086077988148, 0.047544218599796295, -0.037406690418720245, 0.026653576642274857, -0.01863785833120346, -0.0347609780728817, -0.01948920078575611, -0.019004590809345245, 0.07339884340763092, -0.012567128986120224, 0.03625410422682762, -0.016227902844548225, 0.012161104008555412, -0.009816637262701988, -0.001953176688402891, -0.06784547120332718, -0.034525223076343536, 0.007013754453510046, -0.018664052709937096, -0.01920105330646038, 0.04275050386786461, 0.028081214055418968, 0.03381795436143875, 0.022960059344768524, 0.009181404486298561, -0.010635235346853733, -0.01671251282095909, 0.023064840584993362, 0.01104780938476324, -0.012757044285535812, 0.018598565831780434, 0.01817944273352623, -0.04392928630113602, -0.014944340102374554, -0.018506882712244987, 0.00536345923319459, -0.009587429463863373, -0.01189260371029377, -0.012102165259420872, 0.01033399160951376, -0.018755735829472542, 0.00019114282622467726, 0.029155215248465538, -0.035599224269390106, -0.0027046503964811563, -0.0035461699590086937, -0.024937793612480164, 0.02356254868209362, 0.02910282462835312, -0.02022266574203968, -0.0002281844208482653, -0.015297974459826946, -0.009613624773919582, 0.010484613478183746, -0.03405370935797691, -0.0371447391808033, -0.012527836486697197, 0.032979708164930344, -0.0523117370903492, -0.024702038615942, -0.027504920959472656, -0.029941070824861526, -0.04421743378043175, 0.049404077231884, 0.05045188218355179, -0.038140155375003815, 0.00252783321775496, 0.0206155925989151, -0.010674528777599335, 0.007668633479624987, -0.02175508253276348, 0.003480682149529457, 0.026823846623301506, 0.023654231801629066, 0.01268500741571188, 0.00971185602247715, 0.0016560254152864218, 0.01540275476872921, -0.07601836323738098, 0.0018745912238955498, 0.007721024099737406, -0.03963328152894974, -0.054957449436187744, -0.02168959379196167, 0.014446632005274296, 0.0027062876615673304, -0.015153900720179081, 0.024374598637223244, 0.0009192864526994526, -0.019842835143208504, -0.026430917903780937, 0.04867061227560043, -0.04848724603652954, 0.01584807224571705, -0.014957437291741371, -0.011853311210870743, -0.012049774639308453, -0.03229863569140434, -0.008297317661345005, 0.011204980313777924, 0.021899156272411346, 0.03449902683496475, 0.00993451476097107, 0.010294698178768158, -0.019449908286333084, -0.01948920078575611, -0.00891945231705904, 0.010130979120731354, -0.02446628175675869, 0.011106749065220356, 0.037459082901477814, -0.018611662089824677, 0.019266542047262192, -0.016162414103746414, -0.006588083226233721, 0.03329405188560486, -0.007590048015117645, -0.0017337922472506762, -0.026535699144005775, 0.0075769503600895405, 0.008598562330007553, 0.006355601362884045, -0.011028163135051727, -0.007026852108538151, 0.03295351192355156, 0.014459729194641113, 0.007511462550610304, 0.035704005509614944, -0.0013555996119976044, 0.010569747537374496, 0.023916183039546013, -0.00866405013948679, -0.01828422211110592, -0.059096284210681915, -0.014459729194641113, -0.0028585470281541348, 0.010766211897134781, -0.012999349273741245, -0.007799609564244747, -0.01430255826562643, -0.009639819152653217, -0.011663395911455154, -0.014053704217076302, 0.02395547553896904, 0.005779307801276445, -0.047098901122808456, -0.017262611538171768, -0.008965293876826763, -0.009220696985721588, 0.003922725562006235, 0.000586935319006443, 0.006322856992483139, -0.0013588740257546306, -0.1189260333776474, -0.03759005665779114, 0.05464310944080353, -0.001057629706338048, 0.008618208579719067, -1.7625456166570075e-05, 0.01474787574261427, 0.007419779431074858, 0.01090373657643795, -0.01178127434104681, -0.026064185425639153, 0.0031794377136975527, 0.005527179222553968, -0.0002224542258772999, 0.024060256779193878, -0.03465620055794716, -0.020196469500660896, 0.008984940126538277, 0.004168305080384016, -0.023824499920010567, -0.01347741112112999, 0.02719057723879814, 0.017131635919213295, 0.013261300511658192, -0.030203022062778473, -0.007812706753611565, 0.0015455145621672273, 0.004495744593441486, -0.01625409722328186, 0.0020481343381106853, 0.020654885098338127, -0.0025491167325526476, 0.04337918758392334, 0.0429338701069355, -0.022894570603966713, -0.006093649659305811, 0.0076227919198572636, 0.04563197121024132, -0.00036959737190045416, -0.01828422211110592, -0.01981664076447487, -0.06863132119178772, 0.04492470249533653, -0.004420433659106493, 0.01988212764263153, -0.040183380246162415, -0.011198432184755802, -0.023012449964880943, 0.03159136697649956, 0.006227899808436632, 0.007242962252348661, 0.010582845658063889, -0.01817944273352623, -0.018781930208206177, -0.0005239032325334847, 6.410651985788718e-05, -0.013634582050144672, -0.0070988889783620834, 0.011375249363481998, 0.014027508907020092, -0.04673216864466667, 0.029469557106494904, 0.03934513404965401, -0.04005240276455879, -0.02662738226354122, -0.02502947673201561, -0.004161756485700607, 0.03528488427400589, 0.010550101287662983, -0.0038670608773827553, 0.03669942170381546, -0.0017092343186959624, -0.016018342226743698, -0.020366737619042397, 0.007203669752925634, 0.026823846623301506, -0.017996076494455338, 0.006326131522655487, -0.02390308491885662, -0.0055304537527263165, 0.02107400819659233, -0.049927979707717896, 0.010792406275868416, 0.01562541350722313, -0.001055992441251874, -0.015717096626758575, 0.013307142071425915, 0.005301245953887701, 0.00793058518320322, 0.01811395399272442, 0.01969876140356064, -0.007360840681940317, 0.029652923345565796, -0.0051113311201334, 0.014197777956724167, -0.03591356799006462, -0.003454487072303891, 0.0005681075854226947, 0.013713167048990726, 0.011604457162320614, 0.030569754540920258, 0.03573020175099373, 0.026535699144005775, -0.02826458029448986, -0.03235102444887161, -0.00781925581395626, 0.0045481352135539055, 0.010779309086501598, 0.02305174246430397, -0.008369354531168938, 0.021335959434509277, -0.03258678317070007, -0.052075982093811035, 0.015219389460980892, 0.016502952203154564, 0.013182715512812138, 0.012305177748203278, -0.00648330245167017, -0.008028817363083363, -0.01642436720430851, 0.00370334112085402, 0.02548789232969284, 0.0038670608773827553, -0.0009986904915422201, 0.004747873172163963, 0.0013433207059279084, 0.01840210147202015, 0.017170928418636322, 0.007347743026912212, 0.013831045478582382, 0.0425933338701725, 0.03753766790032387, 0.021440740674734116, -0.016175512224435806, -0.01738048903644085, 0.044374603778123856, 0.02928619086742401, 0.018768833950161934, -0.038480691611766815, -0.011257370933890343, -0.03159136697649956, -0.025920113548636436, 0.004345122259110212, 0.009187952615320683, -0.007118535228073597, -0.00525212986394763, -0.029574338346719742, -0.04240996763110161, 0.020196469500660896, 0.021506227552890778, 0.016738709062337875, -0.012540933676064014, 0.009377867914736271, -0.017760319635272026, 0.003359529422596097, 0.015520633198320866, -0.015415852889418602, -0.019004590809345245, 0.016018342226743698, 0.016437463462352753, -0.0004997545620426536, 0.030281607061624527, 0.024479378014802933, -0.01140799280256033, 0.0006569255492649972, 0.000564423855394125, -0.031067462638020515, -0.003775377757847309, 0.005032745655626059, 0.019567785784602165, -0.006119844503700733, -0.03669942170381546, 0.008578915148973465, 0.04948266223073006, 0.041938453912734985, -0.007229864597320557, 0.030438778921961784, 0.004718403331935406, 0.009613624773919582, 0.014014411717653275, 0.004508842248469591, 0.006882778834551573, -0.00123117258772254, 0.016162414103746414, 0.02039293386042118, 0.005373282823711634, 0.03601834923028946, -0.019463004544377327, -0.005072038155049086, 0.013516703620553017, 0.03795678913593292, 0.03942371904850006, -0.024492476135492325, 0.016123121604323387, 0.005229209084063768, 0.02860511653125286, -0.005451868288218975, 0.007786511909216642, 0.00516699580475688, -0.013398825190961361, -0.007242962252348661, 0.03963328152894974, 0.002395220100879669, -0.019292736425995827, -0.011388346552848816, 0.045500997453927994, -0.023025548085570335, -0.002314997371286154, 0.019043883308768272, -0.02792404219508171, 0.02424362301826477, -0.015573023818433285, -0.004816635511815548, 0.025920113548636436, -0.03017682582139969, -0.06444010138511658, -0.024597257375717163, -0.006738705560564995, -0.053490519523620605, -0.035992152988910675, -0.013739362359046936, -0.014787169173359871, -0.022292083129286766, 0.009580880403518677, -0.02763589657843113, -0.01180746965110302, -0.009214147925376892, -0.001378520391881466, -0.014944340102374554, -0.0013384090270847082, -0.009384416975080967, 0.006293387617915869, -0.028002627193927765, -0.024335306137800217, -0.01359528861939907, 0.024990184232592583, -0.025042574852705002, 0.0015324170235544443, -0.012102165259420872, 0.0028127054683864117, 0.02339227870106697, 0.005776033271104097, -0.007269157562404871, -0.011650298722088337, -0.004823184106498957, -0.013909631408751011, 0.045736752450466156, 0.022554034367203712, -0.0005386380362324417, -0.009390965104103088, -0.03426327183842659, 0.01845449209213257, 0.013490508310496807, -0.04264572262763977, -0.011971188709139824, 0.001364604220725596, 0.02293386496603489, 0.0029158489778637886, 0.04298626258969307, 0.005952850449830294, -0.006941718049347401, -0.014472827315330505, 0.010104783810675144, -0.029076630249619484, -0.008998038247227669, -0.02502947673201561, 0.006797644309699535, 0.003041913267225027, -0.01506221853196621, -0.023916183039546013, -0.014459729194641113, 0.011676493100821972, -0.003847414394840598, 0.03161755949258804, 0.01591356098651886, -0.005736740306019783, -0.0077275726944208145, -0.005261952988803387, 0.013352983631193638, -0.017537660896778107, -0.015520633198320866, -0.005802228581160307, 0.003739359322935343, -0.005144075024873018, 0.026011796668171883, -0.020353641360998154, 0.01964637078344822, 0.0033251482527703047, 0.03869025409221649, -0.019266542047262192, 0.037118542939424515, 0.006237722933292389, 0.0034970541018992662, -0.013817948289215565, 0.00965291727334261, 0.0007588411099277437, -0.035311076790094376, 0.018375905230641365, 0.015926659107208252, -0.0138441426679492, -0.02010478638112545, 0.038035374134778976, -0.009495746344327927, -0.03017682582139969, 0.002495089080184698, 0.03549444302916527, 0.018087759613990784, 0.0048395562916994095, -0.028971849009394646, -0.03148658573627472, 0.018821224570274353, -0.0020645062904804945, -0.00760314567014575, 0.04592011868953705, 0.05000656470656395, 0.01749836839735508, 0.013241654261946678, -0.007413230836391449, -0.011466932483017445, 0.013883436098694801, -0.018533077090978622, 0.001159954466857016, 0.021427642554044724, -0.009417160414159298, -0.029417166486382484, -0.008631305769085884, 0.023143425583839417, -0.046967923641204834, 0.0017829082207754254, 0.03130321949720383, -0.01138179749250412, 0.013195812702178955, 0.03156517073512077, 0.009187952615320683, -0.030229216441512108, 0.01863785833120346, 0.021257374435663223, -0.035311076790094376, 0.014760973863303661, -0.03266536816954613, -0.038035374134778976, 0.012193847447633743, -0.0071447305381298065, -0.005723642650991678, -0.014394241385161877, -0.008316963911056519, -0.014603802934288979, -0.027452530339360237, -0.032927319407463074, -0.00337590160779655, 0.08471515029668808, -0.01430255826562643, -0.012213494628667831, -0.016345780342817307, -0.006764900404959917, 0.0018402101704850793, 0.02017027512192726, -0.0192534439265728, -0.026588089764118195, 0.019895225763320923, -0.02129666693508625, 0.012324823997914791, 0.0029895228799432516, -0.0031548799015581608, -0.013726265169680119, 0.007910938933491707, -0.02967911772429943, 0.024846110492944717, 0.0048362817615270615, 0.011650298722088337, 0.00971185602247715, -0.01503602322191, -0.04288148134946823, 0.007518011610955, -0.010537004098296165, 0.002408317755907774, 0.008389000780880451, 0.0218074731528759, -0.017655538395047188, -0.016725610941648483, -0.008212183602154255, -0.00880812294781208, -0.03659464046359062, -0.01988212764263153, -0.028919458389282227, 0.013713167048990726, -0.029914874583482742, 0.030203022062778473, -0.0019908323884010315, 0.009423709474503994, 0.02361493930220604, 0.0316961444914341, -0.024544866755604744, 0.01149312686175108, -0.014053704217076302, -0.028395555913448334, -0.01749836839735508, 0.008316963911056519, 0.0014055341016501188, -0.016332684084773064, -0.03036019206047058, -0.0021823844872415066, 0.03410610184073448, -0.04406026378273964, 0.007445974741131067, -0.0030320899095386267, 0.015114608220756054, 0.017511466518044472, 0.0009282910614274442, -0.024885402992367744, -0.029548142105340958, -0.017930587753653526, -0.041309770196676254, 0.016293391585350037, 0.025383111089468002, 0.0021087105851620436, 0.030491167679429054, 0.012030128389596939, -0.014734778553247452, 0.02802882343530655, -0.022462351247668266, 0.012023579329252243, 0.0036214811261743307, 0.051735445857048035, 0.022239692509174347, -0.002580223372206092, -0.040916841477155685, 0.02463654987514019, -0.020314348861575127, 0.04495089873671532, -0.023313693702220917, 0.01239685993641615, -0.02666667476296425, 0.019384419545531273, 0.016227902844548225, 0.023536352440714836, 0.023706622421741486, 0.032874926924705505, 0.016057634726166725, 0.012514738366007805, -0.015533731319010258, 0.012102165259420872, 0.02366732805967331, -0.0028258031234145164, 0.019960712641477585, -0.031748536974191666, 0.0238506942987442, -0.038926009088754654, -0.029469557106494904, 0.010065491311252117, 0.0017272435361519456, 0.0005312706343829632, 0.044426996260881424, 0.017236417159438133, -0.022121815010905266, 0.0045481352135539055, -0.04950885474681854, -0.006270466838032007, 0.010609040968120098, 0.013182715512812138, -0.011519322171807289, -0.007550755515694618, 0.016908977180719376, -0.0011820567306131124, -0.025356916710734367, 0.005939752794802189, -0.04031435400247574, 0.005350362043827772, 0.01101506594568491, -0.01988212764263153, 0.03036019206047058, -0.017812710255384445, -0.006830388680100441, 0.002026850590482354, -0.025854624807834625, 0.006254095118492842, -0.0075769503600895405, 0.014760973863303661, -0.0018238381016999483, -0.005481337662786245, 0.007262608502060175, 0.0014456454664468765, 0.017472172155976295, 0.027897847816348076, 0.021309765055775642, 0.020510811358690262, -0.0189129076898098, -0.012010482139885426, -0.0192534439265728, -0.0009176492458209395, -0.01347741112112999, -0.018140150234103203, -0.024034060537815094, -0.0020595944952219725, 0.00014212922542355955, 0.004194500390440226, 0.0074394261464476585, -0.0037688289303332567, 0.035022933036088943, -0.02451867237687111, 0.00984938070178032, -0.008244927041232586, -0.0019351675873622298, -0.0029453185852617025, 0.038926009088754654, -0.050137538462877274, 0.019240345805883408, -0.006489851512014866, 0.03342502564191818, 0.004744598641991615, 0.03421088308095932, 0.017524562776088715, -0.003454487072303891, 0.010412576608359814, 0.037406690418720245, 0.02451867237687111, -0.025631966069340706, 0.002644074149429798, -0.01452521700412035, -0.02192535065114498, -0.011414541862905025, 0.0022544211242347956, 0.026522601023316383, -0.025553381070494652, -0.014905047602951527, 0.002249509561806917, 0.012927312403917313, -0.020537007600069046, 0.009168306365609169, 0.015730194747447968, 0.008303866721689701, -0.016241000965237617, 0.019449908286333084, -0.007596597075462341, 0.02611657604575157, -0.0008038640371523798, 0.02168959379196167, 0.03371317312121391, 0.008362805470824242, 0.034001320600509644, -0.0007318273419514298, -0.011349054053425789, 0.015952853485941887, -0.020982325077056885, 0.017262611538171768, 0.010065491311252117, -0.025671258568763733, -0.018140150234103203, 0.02876228839159012, 0.015507536008954048, 0.007563853170722723, -0.020576300099492073, -0.012429604306817055, 0.008598562330007553, 0.0419122576713562, -0.014538315124809742, 0.0005893911584280431, -0.00011726428056135774, -0.000491568585857749, 0.019738053902983665, 0.050609052181243896, -0.005409300792962313, -0.019842835143208504, 0.023248206824064255, -0.0047347755171358585, 0.010464967228472233, 0.033267855644226074, -0.006640473380684853, 0.01584807224571705, -0.005108056589961052, -0.029129020869731903, -0.0013727901969105005, 0.02423052489757538, -0.04264572262763977, -0.01036673504859209, 0.029652923345565796, 0.0022003937046974897, -0.01631958596408367, 0.02349705994129181, 0.021047811955213547, 0.011421090923249722, -0.012226591818034649, -0.015245583839714527, -0.00370334112085402, 0.020484616979956627, 0.03075312077999115, 0.0038670608773827553, -0.013883436098694801, -0.03515390679240227, 0.01149312686175108, -0.06470204889774323, 0.014053704217076302, 0.009122464805841446, -0.025920113548636436, -0.01364767923951149, 0.04269811511039734, 0.017000660300254822, -0.020982325077056885, -0.021335959434509277, 0.02311723120510578, 0.006987559609115124, 0.008768830448389053, 0.006178783718496561, -0.03486575931310654, 0.014053704217076302, 0.003654225030913949, 0.045684363692998886, -0.011041260324418545, 0.02973150834441185, 0.003438115119934082, -0.03371317312121391, 0.005609039217233658, -0.0029273093678057194, -0.00798297580331564, -0.001218075049109757, -0.009155209176242352, -0.023693524301052094, 0.016385074704885483, -0.04146694019436836, -0.0109888706356287, 0.019855933263897896, 0.01886051706969738, 0.011656846851110458, 0.00642763776704669, 0.0273477490991354, 0.0190831758081913, -0.010556650348007679, 0.02576294168829918, 0.009168306365609169, -0.00486902566626668, 0.038087766617536545, -0.03156517073512077, 0.0011705963406711817, 0.01347741112112999, 0.01036673504859209, -0.018493784591555595, -0.013948923908174038, 0.006948266644030809, 0.003657499561086297, 0.005599216092377901, 0.02010478638112545, -0.043352991342544556, 0.028081214055418968, -0.03635888546705246, -0.021833667531609535, -0.02332679182291031, 0.008441390469670296, -0.015821877866983414, 0.0054223984479904175, 0.010844796895980835, -0.006172235123813152, 0.006355601362884045, 0.004449903033673763, -0.027216773480176926, 0.005294696893543005, -0.002819254295900464, -0.006542241666465998, 0.02492469735443592, 0.027950238436460495, 0.02763589657843113, 0.013831045478582382, 0.026260649785399437, -0.002981336787343025, -0.007419779431074858, -0.03130321949720383, 0.0008239197195507586, 0.013857240788638592, 0.007760316599160433, -0.0006344140856526792, 0.06030126288533211, -0.010517357848584652, 0.005615587811917067, 0.0016552067827433348, -0.006460381671786308, 0.03036019206047058, -0.026299942284822464, -0.01654224470257759, 0.004011134151369333, 0.020301250740885735, -0.017472172155976295, -0.012442701496183872, 0.014197777956724167, -0.01862476021051407, 0.017459075897932053, 0.024649647995829582, 0.0036476762033998966, -0.005212837364524603, 0.036044541746377945, 0.028081214055418968, -0.020288152620196342, 0.0064538330771028996, 0.023693524301052094, -0.005216111429035664, -0.0023100858088582754, -0.022554034367203712, -0.007884743623435497, -0.007793060503900051, -0.025330722332000732, -0.01586117036640644, 0.026182064786553383, -0.004417159128934145, 0.030386388301849365, 0.001145219779573381, -0.029548142105340958, 0.011663395911455154, -0.005648331716656685, -0.003418468637391925, -0.012508190236985683, -0.0204453244805336, 0.0064472840167582035, -0.010569747537374496, 0.020196469500660896, 0.025671258568763733, 0.009914868511259556, 0.00806810986250639, -0.05063524842262268, -0.011041260324418545, -0.016502952203154564, 0.007380486931651831, -0.03127702325582504, 0.016411269083619118, 0.05663394182920456, 0.030779315158724785, 0.059672579169273376, -0.024217426776885986, -0.0276882853358984, -0.00250000087544322, -0.024374598637223244, 0.02260642498731613, 0.01387033797800541, 0.015520633198320866, -0.02327440120279789, 0.0011034711496904492, -0.02163720317184925, 0.01017027162015438, 0.004322201944887638, -0.01829732023179531, 0.03473478555679321, 0.0042894575744867325]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"1
(80)
Finally, we obtain a telescoping cancellation of ˜πtterms using the indexing identities in Eq. (75)-(76). In particular, since
¯hjt
t=hjt+1
tand¯hjt−1
t−1=hjt
t−1with¯hjT
T=h1
T, we can simplify the terms in Eq. (80) as
˜πT
sh1
T
1:TTY
t=1˜πt−1 
shjt
t−1
1:t−1!
˜πt 
s¯hjt
t
1:t! = ˜πT 
s¯hjT
T
1:T!TY
t=1˜πt−1 
s¯hjt−1
t−1
1:t−1!
˜πt 
s¯hjt
t
1:t! =

˜πT 
s¯hjT
T
1:T!

˜πT−1
s¯hjT−1
T−1
1:T−1


˜πT 
s¯hjT
T
1:T!
˜πT−2
s¯hjT−2
T−2
1:T−2


˜πT−1
s¯hjT−1
T−1
1:T−1
...1

˜π1 
s¯hj1
1
1:1!= 1
using the assumption that ˜π0(·) = 1 . Simplifying from Eq. (80), the final unnormalized importance weights become
˜σSMC
qSMC
{sk
t, ωk
t}T,K
t=1,k=1
=TY
t=11
KKX
k=1˜πt
s¯hk
t
1:t
˜πt−1
shk
t−1
1:t−1
q
sk
tshk
t−1
1:t−1=TY
t=11
KKX
k=1wt
s¯hk
t
1:t
=:TY
t=11
KKX
k=1wt(sk
1:t) (81)
39
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
as desired, where we abbreviate the importance weights as wt(sk
1:t)for simplicity of notation. Note that we also obtain an
unbiased estimate of the partition function via
Zσ=EqSMC(S)˜σSMC(S)
qSMC(S)
=EqSMC(S)""TY
t=11
KKX
k=1wt
sk
1:t#
Proposition 5.1. (Bidirectional SMC Bounds) The log partition function logZσof a target distribution σ(s1:T)can be
lower and upper bounded by
EqSMC(S)""
logTY
t=11
KKX
i=1wt 
si
1:t#
≤logZσ
logZσ≤EσSMC(S)""
logTY
t=11
KKX
i=1wt 
si
1:t#
.(24)
The gap in the lower bound is DKL(qSMC(S)∥σSMC(S)), and the gap in the upper bound is DKL(σSMC(S)∥qSMC(S)).
Proof. The proof follows directly from Brekelmans et al. (2022) App. A, where it is shown that for σext(S), qext(S)such
thatZσ=Eqext(S)[˜σext(S)
qext(S)], we can construct lower and upper bounds on logZσ
DKL(qext(S)∥σext(S)) +Eqext(S)
log˜σext(S)
qext(S)
= logZσ=Eσext(S)
log˜σext(S)
qext(S)
−DKL(σext(S)∥qext(S)) (82)
Eqext","[0.03566025197505951, -0.026086047291755676, 0.017404014244675636, 0.028309820219874382, -0.01910846307873726, 0.035633619874715805, 0.022157827392220497, 0.04133287072181702, -0.0531042143702507, 0.015885990113019943, 0.025313720107078552, 0.005669287871569395, -0.029907740652561188, 0.05065407231450081, 0.010532957501709461, -0.0049136048182845116, 0.018455978482961655, 0.01822960563004017, -0.014913922175765038, 0.028016867116093636, -0.02897561900317669, -0.018948670476675034, -0.005875685717910528, 0.027257855981588364, -0.02142544649541378, -0.01480739377439022, 0.019388098269701004, -0.04570051655173302, 0.035074349492788315, -0.011112203821539879, 0.04522114247083664, -0.03054690733551979, -0.0021788307931274176, -0.030253956094384193, -0.011391839012503624, 0.07094765454530716, 0.0026648647617548704, 0.041998669505119324, -0.016072414815425873, 0.020466694608330727, -0.013429188169538975, -0.01436796598136425, -0.07478266209363937, 0.01824292168021202, -0.008329158648848534, 0.062052566558122635, 0.0074303289875388145, -0.02554009109735489, -0.0024767762515693903, 0.028283188119530678, -0.023316318169236183, 0.026272471994161606, -0.024261755868792534, 0.005829079542309046, -0.01118544116616249, -0.022091247141361237, 0.012190799228847027, 0.015473194420337677, 0.013142894022166729, -0.03736470267176628, 0.02542024664580822, -0.038003869354724884, 0.025500142946839333, -0.0029045529663562775, -0.03440854698419571, -0.04546083137392998, 0.021505342796444893, 0.0349944531917572, -0.012390539981424809, 0.02311657927930355, -0.03912241384387016, 0.016391998156905174, 0.038083765655756, 0.005323071498423815, -0.04692558944225311, -0.0044308993965387344, -0.004880314692854881, 0.043383534997701645, 0.0118645578622818, -0.0499882698059082, -0.015180242247879505, -0.009520941413939, 0.021159127354621887, -0.008542215451598167, -0.02285025827586651, -0.0405871719121933, -0.03459497168660164, 0.0187356136739254, -0.0705748125910759, -0.005056751426309347, -0.020519958809018135, 0.009700707159936428, -0.023942170664668083, -0.019947370514273643, 0.08607463538646698, -0.005875685717910528, 0.02673853188753128, -0.005825750529766083, -0.0034455154091119766, -0.04064043611288071, 0.037631019949913025, -0.021691767498850822, 0.007876414805650711, -0.06173298507928848, 0.05752512812614441, 0.0026582067366689444, -0.0318785086274147, -0.0005680106696672738, -0.04828382283449173, -0.01741733029484749, -0.017763545736670494, -0.008721981197595596, -0.02255730703473091, 0.0568326935172081, -0.0026615357492119074, -0.0020107163581997156, -0.04135950282216072, 0.017883390188217163, -0.014221489429473877, 0.02910877950489521, -0.0018475952092558146, -0.0067645288072526455, 0.009933737106621265, 0.010419771075248718, 0.019574522972106934, -0.01464760210365057, 0.022197775542736053, -0.0699889063835144, -0.03973494842648506, 0.026592055335640907, 0.008255921304225922, -0.0009928743820637465, -0.006468247622251511, -0.009421071037650108, -0.0030759964138269424, 0.004660600796341896, 0.003958181478083134, 0.013915222138166428, 0.015885990113019943, 0.014967186376452446, -0.01685805805027485, -0.0059089758433401585, -0.011851241812109947, -0.0027414318174123764, -0.030520275235176086, 0.003552043344825506, -0.036885324865579605, 0.009600836783647537, -0.04570051655173302, 0.0005929782055318356, 0.012943153269588947, -0.05816429480910301, -0.004327700473368168, -0.0010619511594995856, 0.009321201592683792, -0.09422402828931808, -0.025140611454844475, 0.06386354565620422, 0.043197110295295715, -0.041812244802713394, -0.01905519887804985, 0.04799086973071098, -0.001845930702984333, -0.001454773242585361, -0.003981484565883875, -0.0077698868699371815, -0.03480802848935127, 0.0418655090034008, -0.04303731769323349, -0.06503535062074661, -0.003854982554912567, -0.004700548481196165, -0.022570623084902763, -0.07174661755561829, 0.006541485898196697, -0.03318347781896591, -0.009873814880847931, -0.08037538826465607, -0.0009004946332424879, 0.004537427797913551, 0.006315113976597786, 0.04945563152432442, 0.026339052245020866, -0.01731080189347267, -0.01830950193107128, 0.03893598914146423, 0.010193399153649807, 0.03539393097162247, 0.04378301277756691, -0.03281062841415405, 0.0020290256943553686, 0.06476902961730957, 0.04836371913552284, -0.0057591707445681095, -0.03265083581209183, -0.03422212600708008, 0.05645984783768654, 0.07041501998901367, 0.009520941413939, 0.01161821186542511, 0.025034083053469658, 0.0020290256943553686, -0.010086871683597565, -0.04415586218237877, -0.015100345946848392, 0.01629878580570221, -0.003392251441255212, 0.030067531391978264, -0.07717954367399216, -0.016751529648900032, -0.004896959755569696, -0.033210109919309616, 0.04982847720384598, 0.006781173869967461, -0.024062015116214752, 0.03723154217004776, -0.06407660245895386, 0.0033789353910833597, -0.010699407197535038, 0.04820392653346062, -0.0005010145832784474, 0.052251990884542465, 0.02948162704706192, -0.02191813848912716, -0.041812244802713394, 0.0287359319627285, 0.04897625371813774, -0.028895724564790726, 0.03017405979335308, -0.013382581993937492, 0.0343286506831646, 0.03211819753050804, 0.003958181478083134, -0.056193526834249496, -0.02255730703473091, -0.02685837633907795, -0.0349678210914135, -0.023023366928100586, -0.03339653089642525, -0.07377064973115921, 0.006531498860567808, 0.014128278009593487, 0.022344250231981277, 0.00235859677195549, 0.03534066677093506, 0.001954123144969344, -0.017071114853024483, -0.009674075059592724, -0.013289369642734528, 0.007337117101997137, 0.018509242683649063, -0.01095906924456358, -0.009627468883991241, 0.02611267939209938, -0.05361022427678108, 0.008395738899707794, -0.012323959730565548, 0.0171643253415823, 0.025273771956562996, 0.015779461711645126, -0.03091975674033165, -0.051373135298490524, -0.060561176389455795, -0.0024368283338844776, -0.023968802765011787, -0.02479439601302147, 0.0005771654541604221, -0.006361719686537981, 0.034381914883852005, -0.016844742000102997, 0.011038965545594692, -0.008488951250910759, -0.022597255185246468, 0.053503695875406265, -0.013389240019023418, -0.05036111921072006, -0.000942107115406543, 0.04404933378100395, -0.04985510930418968, -0.003004422876983881, -0.028309820219874382, -0.026072731241583824, 0.01492723822593689, -0.020533274859189987, 0.024062015116214752, -0.02567325159907341, 0.008389080874621868, 0.047804445028305054, 0.004733838606625795, -0.07409023493528366, 0.01617894135415554, 0.01804318279027939, 0.008768587373197079, -0.007923020981252193, -0.004237817600369453, -0.015952570363879204, -0.0021988048683851957, -0.013795377686619759, -0.027590755373239517, 0.004610665608197451, 0.04929583892226219, -0.0006545647047460079, 0.005399638786911964, 0.0027480898424983025, -0.02655210718512535, -0.012144193984568119, 0.03259757161140442, 0.03523414209485054, -0.05126660689711571, 0.029028883203864098, -0.013675534166395664, -0.0066047366708517075, -0.038509875535964966, 0.010859199799597263, -0.02799023501574993, -0.026898322626948357, 0.01948131062090397, -0.013715481385588646, 0.01261691190302372, -0.02536698244512081, -0.01192447915673256, 0.0028562822844833136, -0.0014581021387130022, -0.029641419649124146, -0.004530769772827625, 0.009707365185022354, -0.04977521300315857, -0.023649219423532486, -0.01885545812547207, -0.007516882847994566, 0.008009575307369232, 0.04002790153026581, 0.027271172031760216, 0.02018705941736698, -0.00268650334328413, -0.05203893408179283, -0.010479693301022053, 0.08847151696681976, -0.014607653953135014, 0.04096002131700516, -0.0837310180068016, 0.00796296913176775, -0.026645319536328316, -0.039948005229234695, 0.027191275730729103, -0.014101645909249783, 0.027084747329354286, 0.05608699843287468, 0.08596810698509216, 0.003402238478884101, -0.00565264280885458, -0.014860657975077629, 0.043197110295295715, 0.00961415283381939, 0.016218889504671097, -0.01611236296594143, 0.012070955708622932, -0.029508259147405624, -0.03379601240158081, -0.0014605988981202245, -0.030333852395415306, -0.006211914587765932, 0.03965505212545395, 0.011871215887367725, -0.004121302627027035, 0.015646301209926605, -0.038323454558849335, 0.011891189962625504, -0.024022066965699196, 0.020972702652215958, 0.013662218116223812, 0.023436162620782852, 0.006211914587765932, -0.000425695936428383, -0.04942899942398071, -0.019974002614617348, -0.01673821359872818, 0.014847341924905777, 0.044262390583753586, -0.0034288703463971615, 0.02697821892797947, 0.00471719354391098, 0.003329000435769558, -0.018642403185367584, 0.0081227608025074, 0.003761770436540246, 0.0005035113426856697, -0.0018409371841698885, -0.02273041568696499, 0.008755271323025227, 0.0025067373644560575, 0.000760676572099328, -0.009214673191308975, 0.01616562530398369, -0.009407754987478256, -0.010792619548738003, -0.0006695452029816806, 0.037071749567985535, 0.03603310137987137, 0.022264355793595314, -0.04210519790649414, -0.005359690636396408, -0.030573539435863495, -0.03193177282810211, -0.024461494758725166, 0.019814210012555122, 0.013888590037822723, 0.04796423763036728, -0.0011052280897274613, 0.06668653339147568, 0.05534130334854126, -0.02291683852672577, 0.04002790153026581, -0.027644019573926926, 0.011438445188105106, -0.04567388445138931, 0.010373164899647236, 0.03890935704112053, 0.04064043611288071, 0.04711201414465904, -0.012730097398161888, -0.04964205622673035, 0.014887290075421333, -0.014967186376452446, -0.01922830566763878, -0.005672616884112358, 0.0171643253415823, -0.029641419649124146, 0.024075331166386604, -0.03787070885300636, -0.0010061904322355986, 0.020653119310736656, 0.04127960652112961, 0.006122031714767218, -0.011491709388792515, 0.01158492173999548, 0.03664563596248627, -0.015379982069134712, -0.014248121529817581, -0.03198503702878952, -0.016338733956217766, 0.010599537752568722, -0.05614026263356209, -0.0025100663769990206, 0.004534098785370588, 0.006145334802567959, 0.0006553969578817487, -0.05259820818901062, 0.057312071323394775, -0.010885830968618393, 0.01917504332959652, -0.0231032632291317, 0.03954852372407913, -0.027963602915406227, -0.047005485743284225, -0.04229162260890007, 0.06551472842693329, -0.02147871069610119, 0.02391553856432438, -0.04223835840821266, 0.035633619874715805, 0.013062997721135616, -0.012070955708622932, 0.005469547584652901, 0.01918835937976837, 0.017350750043988228, 0.027404330670833588, -0.024128595367074013, -0.006581434048712254, 0.05598047003149986, -0.0011809628922492266, -0.07334453612565994, 0.03390254080295563, -0.026192575693130493, 0.012750071473419666, -0.008076154626905918, 0.06817793101072311, -0.054861925542354584, 0.02017374336719513, -0.028576139360666275, 0.044262390583753586, -0.05102691799402237, -0.006335088051855564, 0.01668494939804077, 0.02323642373085022, 0.05906978249549866, 0.04474176466464996, -0.0035919914953410625, 0.024408230558037758, 0.002909546485170722, -0.021332234144210815, -0.04711201414465904, 0.0524916797876358, -0.015326717868447304, 0.04402270168066025, -0.0035986495204269886, 0.043250374495983124, -0.023529374971985817, -0.01471418235450983, -0.025819728150963783, 0.03659237176179886, -0.0171643253415823, -0.0005750848213210702, 0.02336958236992359, 0.0029744619969278574, 0.02966805174946785, 0.018216289579868317, 0.000769415230024606, -0.0006870224606245756, 0.04349006339907646, -0.005116673652082682, -0.009913763031363487, 0.0005438754451461136, 0.006461590062826872, -0.015513141639530659, -0.008695349097251892, -0.011078913696110249, -0.010539615526795387, -0.0028246568981558084, -0.003828350454568863, 0.012170825153589249, -0.034515075385570526, -0.040880125015974045, -0.02036016620695591, 0.024821028113365173, -0.025020767003297806, 0.010832567699253559, -0.08628769218921661, -0.007749912794679403, -0.0662071630358696, 0.028709299862384796, -0.03416886180639267, -0.015752829611301422, -0.006871056742966175, -0.010206715203821659, 0.01755049079656601, -0.025433562695980072, -0.017071114853024483, 0.019028566777706146, 0.0159259382635355, -0.028496243059635162, -0.028309820219874382, 0.008349132724106312, 0.010985701344907284, 0.014008433558046818, -0.02454139105975628, 0.020879490301012993, 0.0004273604426998645, -0.006211914587765932, 0.0007506895926780999, -0.022397514432668686, -0.0033073618542402983, 0.0025000793393701315, -0.0196677353233099, -0.0237291157245636, -0.004983513616025448, 0.00878190342336893, 0.02316984347999096, -0.00796296913176775, 0.006484892684966326, 0.04029422253370285, -0.009973685257136822, 0.004733838606625795, 0.002676516305655241, -0.026525475084781647, -0.01918835937976837, 0.02822992391884327, -0.00899495929479599, 0.03914904594421387, 0.0362195260822773, -0.044129230082035065, 0.017377382144331932, 0.016898006200790405, -0.025340352207422256, 0.0025633303448557854, -0.03091975674033165, 0.020946070551872253, -0.02655210718512535, 0.004171237349510193, -0.03273073211312294, -0.04034748673439026, 0.017390698194503784, 0.013529057614505291, -0.05065407231450081, -0.04852351173758507, 0.02298341877758503, 0.026512159034609795, -0.011797977611422539, -0.0324644111096859, 0.0016020814655348659, 0.02173171564936638, -0.02897561900317669, 0.00022866071958560497, 0.009594179689884186, -0.042824260890483856, 0.02611267939209938, -0.008116102777421474, 0.003157556988298893, -0.021345550194382668, 0.0036053075455129147, 0.03645921126008034, 0.012603595852851868, -0.006235217675566673, -0.0474582314491272, -0.054382551461458206, 0.041492659598588943, -0.03574014827609062, 0.026032783091068268, 0.007829808630049229, 0.035207509994506836, 0.015193558298051357, 0.002851288765668869, -0.01579277776181698, -0.011724739335477352, -0.016977902501821518, -0.013029707595705986, 0.020653119310736656, -0.04588694125413895, 0.08229289203882217, -0.03459497168660164, 0.00024093640968203545, -0.01656510680913925, 0.02111917920410633, -0.016911322250962257, -0.009081513620913029, 0.04239815101027489, 0.008329158648848534, -0.020839542150497437, 0.025966202840209007, -0.020213691517710686, -0.007237246725708246, -0.01656510680913925, -0.008655400946736336, 0.01755049079656601, 0.016019150614738464, -0.0049502234905958176, -0.004567388445138931, 0.05147966369986534, 0.0493491031229496, -0.0355803556740284, 0.029082147404551506, 0.01015345100313425, -0.0049502234905958176, -0.039441995322704315, 0.018895406275987625, 0.02985447645187378, -0.02966805174946785, 0.03555372357368469, -0.012457119300961494, -0.009254621341824532, -0.0037417965941131115, -0.013409214094281197, 0.02980121225118637, -0.015180242247879505, 0.0349944531917572, -0.03230461850762367, 0.03233125060796738, -0.012310643680393696, -0.014288069680333138, -0.033449795097112656, -0.02367585152387619, 0.01824292168021202, -0.005945594981312752, 0.02680511213839054, 0.016591738909482956, 0.03142576292157173, 0.027084747329354286, 0.020320218056440353, 0.005692590959370136, -0.016032466664910316, -0.019907422363758087, 0.018975302577018738, 0.007417012937366962, -0.005675945896655321, 0.010785961523652077, 0.02636568434536457, -0.003861640579998493, -0.015313401818275452, -0.0019940712954849005, 0.003904917510226369, -0.04697885364294052, 0.0032391173299402, -0.04799086973071098, -0.020586539059877396, -0.009014933370053768, -0.01286325789988041, 0.042557939887046814, -0.018748929724097252, -0.014208173379302025, -0.0015363337006419897, -0.03667226806282997, 0.00920801516622305, 0.020946070551872253, -0.05315747857093811, -0.014834025874733925, -0.03390254080295563, -0.012603595852851868, 0.03347642719745636, -0.003688532393425703, -0.03605973348021507, 0.005040106829255819, 0.03142576292157173, -0.05416949465870857, -0.013888590037822723, -0.04836371913552284, -0.012936495244503021, -0.04839035123586655, 0.04586030915379524, 0.0381103977560997, -0.06226562336087227, 0.0017560477135702968, 0.011132177896797657, -0.021838242188096046, 0.00330902636051178, -0.0027963602915406227, 0.00468390341848135, -0.012017691507935524, 0.017137695103883743, 0.020147111266851425, -0.0036452554631978273, -0.028948986902832985, -0.01723090559244156, -0.04894962161779404, 0.012790019623935223, -0.005635997746139765, -0.01954789087176323, -0.049748580902814865, -0.008974985219538212, 0.021332234144210815, -0.0005526140448637307, -0.0021189088001847267, 0.02460797131061554, 0.0015721204690635204, -0.0221844594925642, -0.018748929724097252, 0.046126630157232285, -0.013222789391875267, 0.024874290451407433, -0.01956120692193508, -0.004121302627027035, 0.011797977611422539, -0.020067214965820312, -0.03379601240158081, 0.03203830122947693, 0.03912241384387016, 0.0349944531917572, 0.008974985219538212, 0.01579277776181698, -0.007829808630049229, -0.0134358461946249, -0.015459878370165825, 0.011138834990561008, -0.02709806337952614, 0.018842142075300217, 0.027830444276332855, -0.0003260339726693928, 0.007383722811937332, 0.005076725501567125, -0.028016867116093636, -0.008855140767991543, -0.017470594495534897, -0.007836466655135155, -0.022783678025007248, 0.027883708477020264, -0.008735297247767448, -0.03123934008181095, -0.008941695094108582, -0.029881108552217484, 0.019388098269701004, 0.0035620303824543953, -0.01543324626982212, 0.018349450081586838, -0.014594337902963161, 0.0246745515614748, 0.03645921126008034, 0.014660918153822422, -0.023755747824907303, -0.020346850156784058, -0.019161727279424667, -0.009634126909077168, -0.013169526122510433, -0.005392980761826038, 0.010532957501709461, -0.027430962771177292, -0.007903046905994415, -0.030467011034488678, -0.0196677353233099, -0.0038849434349685907, -0.0035320695023983717, -0.03366285189986229, -0.029028883203864098, -0.0031076218001544476, -0.04008116573095322, 0.01127199549227953, -0.00927459541708231, 0.00674788374453783, -0.002383564366027713, -0.12474430352449417, -0.046446215361356735, 0.022597255185246468, 0.03305031731724739, 0.014541073702275753, -0.01267683319747448, 0.027590755373239517, -0.0035154244396835566, 0.0036352684255689383, -0.02555340714752674, -0.026898322626948357, -0.031212707981467247, -0.028469610959291458, 0.023076631128787994, -0.0006566453375853598, -0.032144829630851746, -0.01898861862719059, 0.013901906087994576, 0.020946070551872253, -0.03728480637073517, -0.01636536605656147, 0.02691163867712021, 0.011318601667881012, 0.041812244802713394, -0.03115944378077984, -0.010825909674167633, 0.0010777638526633382, 0.01593925431370735, -0.008921721018850803, 0.009540915489196777, 0.021465394645929337, -0.009687391109764576, 0.022890206426382065, 0.048496879637241364, -0.01898861862719059, 0.005389651749283075, 0.004973526578396559, -0.0023369581904262304, -0.013848641887307167, -0.020346850156784058, -0.011571605689823627, -0.03898925334215164, 0.03917567804455757, -0.024022066965699196, 0.01968105137348175, -0.04474176466464996, -0.01580609381198883, -0.03896262124180794, 0.015406614169478416, -0.01430138573050499, -0.01780349388718605, 0.0032674139365553856, -0.020266953855752945, 0.010379822924733162, 0.018189657479524612, -0.007223931141197681, -0.022397514432668686, 0.013116261921823025, 0.05177261307835579, 0.04159918799996376, -0.035633619874715805, 0.004301068373024464, 0.033210109919309616, -0.02486097440123558, -0.03629942238330841, -0.032011669129133224, -0.008136076852679253, 0.00014574780652765185, 0.025287088006734848, -0.0057525127194821835, 0.021465394645929337, 0.001535501447506249, -0.019095147028565407, -0.01480739377439022, -0.017710281535983086, 0.02511397935450077, -0.033449795097112656, 0.017816809937357903, -0.06476902961730957, 0.035207509994506836, 0.0032041629310697317, -0.030839860439300537, 0.006142005790024996, -0.0021755017805844545, -0.0088950889185071, -0.018256237730383873, 0.021944770589470863, 0.034142229706048965, -0.005113344639539719, 0.06082749739289284, 0.03842997923493385, 0.0064149838872253895, 0.018828826025128365, -0.018376082181930542, 0.009421071037650108, 0.0015063727041706443, -0.0019624456763267517, -0.0007086609839461744, 0.02110586315393448, -0.01274341344833374, 0.02354269102215767, 0.017337433993816376, 0.006508195772767067, -0.03179861232638359, -0.000605461944360286, -0.01731080189347267, -0.02692495472729206, -0.00040239293593913317, 0.01361561194062233, 0.0006566453375853598, 0.010732697322964668, -0.017577122896909714, -0.04697885364294052, 0.015419930219650269, 0.01380869373679161, -0.001430637901648879, 0.02723122388124466, 0.03193177282810211, -0.013375923968851566, -0.0008285049698315561, -0.016005834564566612, 0.02886909246444702, 0.0017610412323847413, -0.004640626721084118, -0.021971402689814568, 0.00896166916936636, 0.013795377686619759, 0.024035383015871048, -0.03291715681552887, -0.022011350840330124, 0.007889730855822563, 0.005496179684996605, 0.021585239097476006, -0.0029428363777697086, -0.017523858696222305, 0.04021432623267174, 0.013162868097424507, -0.00030876477831043303, -0.018096446990966797, 0.021039282903075218, -0.0013640578836202621, -0.0029261913150548935, 0.016138993203639984, 0.0218515582382679, 0.006441615987569094, -0.027936970815062523, 0.0010103515814989805, -0.04130623862147331, 0.011531657539308071, 0.009480993263423443, 0.021651819348335266, -0.007257220800966024, -0.004670587833970785, -0.008588820695877075, -0.017270853742957115, 0.008202657103538513, -0.007949653081595898, -0.03155892342329025, -0.004866998642683029, 0.015047081746160984, -0.003067673882469535, 0.06077423319220543, 0.011105545796453953, -0.0017910022288560867, 0.007410354912281036, 0.012916522100567818, -0.031265970319509506, -0.002902888460084796, -0.011125519871711731, 0.026006150990724564, -0.008096128702163696, -0.055128246545791626, 0.028283188119530678, 0.021332234144210815, 0.010526299476623535, 0.008195999078452587, 0.019654419273138046, 0.01587267406284809, -0.0034072319976985455, 0.01240385603159666, 0.01024000532925129, 0.011358549818396568, -0.01787007413804531, 0.015499825589358807, 0.04327700659632683, -0.018509242683649063, 0.030973020941019058, -0.014913922175765038, 0.005895659793168306, 0.017204273492097855, 0.025779780000448227, 0.02767065167427063, -0.014421230182051659, 0.038323454558849335, -0.005712564568966627, 0.01067943312227726, -0.008915062993764877, 0.024315020069479942, 0.013316001743078232, -0.0035786754451692104, -0.03384927660226822, 0.04516787827014923, 0.012869915924966335, -0.03036048449575901, -0.029188675805926323, 0.014887290075421333, -0.036885324865579605, 0.007310485001653433, -0.0027963602915406227, -0.004334358498454094, 0.010732697322964668, 0.0021555277053266764, -0.011698107235133648, 0.017816809937357903, -0.013309343717992306, -0.06210583075881004, -0.00261659431271255, 0.00568593293428421, -0.027697283774614334, -0.03845661133527756, -0.008828509598970413, -0.009627468883991241, -0.007916362956166267, 0.03584667667746544, -0.028682667762041092, 0.0022387527860701084, -0.022037982940673828, 0.007603437174111605, -0.004810405429452658, -0.012157510034739971, 0.014873974025249481, 0.02018705941736698, -0.023023366928100586, -0.014421230182051659, -0.021838242188096046, -0.008009575307369232, -0.012969785369932652, -0.01712437905371189, 0.0015679592033848166, 0.0013890254776924849, 0.008535557426512241, -0.004001458641141653, -0.01443454623222351, 0.0035553723573684692, 0.0015338369412347674, -0.006281823851168156, 0.030280588194727898, 0.03909578174352646, -0.024341650307178497, -0.02384895831346512, -0.007390380837023258, 0.021332234144210815, 0.0227969940751791, 0.00198241975158453, 0.00768333300948143, 0.02005389891564846, 0.023396214470267296, 0.032384514808654785, 0.030200691893696785, 0.00943438708782196, 0.005046764854341745, -0.0027381028048694134, 0.0015246821567416191, -0.023063315078616142, -0.0004631471820175648, -0.03446181118488312, 0.0006341745611280203, 0.02597951889038086, -0.012723439373075962, -0.0021988048683851957, -0.029561523348093033, 0.011877873912453651, 0.009261279366910458, 0.029321836307644844, 0.020826226100325584, -0.018202973529696465, 0.014288069680333138, 0.0033622903283685446, -0.0035387275274842978, -0.010612853802740574, -0.03755112364888191, -0.005196569487452507, -0.031505659222602844, -0.020333534106612206, 0.04423575848340988, -0.0012400526320561767, 0.008775245398283005, -0.009048223495483398, 0.03539393097162247, -0.020386798307299614, 0.01395516935735941, 0.02655210718512535, -0.012064297683537006, 0.0040979995392262936, -0.019015250727534294, -0.00674788374453783, -0.018202973529696465, 0.0203069020062685, -0.0054495735093951225, -0.010812593623995781, -0.01910846307873726, 0.01842934638261795, -0.018469294533133507, -0.020759645849466324, 0.016964586451649666, 0.02286357432603836, 0.007889730855822563, 0.027151327580213547, -0.03022732399404049, -0.026312420144677162, -0.009034907445311546, 0.00011828354763565585, -0.009634126909077168, 0.03760438784956932, 0.02966805174946785, 0.0035287404898554087, 0.01886877417564392, -0.008262579329311848, 0.015632985159754753, 0.005612694658339024, -0.024501442909240723, -0.010785961523652077, 0.03129260241985321, -0.02435496635735035, -0.03366285189986229, 0.0031076218001544476, 0.023276371881365776, -0.024088647216558456, 0.019720997661352158, 0.029934372752904892, 0.017151009291410446, 0.009128118865191936, 0.022197775542736053, 0.008195999078452587, -0.04492818936705589, 0.022504042834043503, -0.026032783091068268, -0.025220507755875587, -0.031079547479748726, -0.014594337902963161, 0.003370612859725952, 0.018016550689935684, -0.008096128702163696, -0.03427539020776749, -0.012996417470276356, -0.0016528486739844084, 0.013502425514161587, 0.008702007122337818, -0.009727339260280132, -0.023835642263293266, 0.07909704744815826, -0.020879490301012993, -0.007397038862109184, -0.011391839012503624, -0.01195776928216219, 0.00820931512862444, -0.005126660689711571, -0.024461494758725166, -0.03864303603768349, 0.033316634595394135, -0.018575822934508324, 0.017457278445363045, -0.033263374119997025, -0.013782061636447906, 0.0009895453695207834, -0.0024617959279567003, -0.019454678520560265, 0.02311657927930355, 0.00022512365831062198, -0.0029045529663562775, 0.0030526933260262012, -0.026272471994161606, -0.051639456301927567, 0.020400114357471466, -0.023942170664668083, -0.02697821892797947, -0.03536729887127876, 0.018828826025128365, -0.016511842608451843, 0.01374211348593235, -0.02291683852672577, 0.003418883541598916, -0.0430905818939209, -0.005239846650511026, -0.00946767721325159, -0.011405155062675476, -0.05848388001322746, 0.016391998156905174, 0.0011085571022704244, 0.00833581667393446, 0.029454994946718216, -0.011192099191248417, -0.021398814395070076, 0.0009129783720709383, -0.01893535442650318, -0.027644019573926926, -0.009933737106621265, -0.02480771206319332, 0.01137186586856842, 0.009867156855762005, -0.014887290075421333, -0.007357091177254915, 0.030999651178717613, -0.039575155824422836, -0.004367648623883724, -0.0014814052265137434, 0.0034555024467408657, 0.025500142946839333, -0.0104663772508502, -0.002431834815070033, -0.01949462667107582, -0.013429188169538975, -0.006464918609708548, 0.020027266815304756, 0.0349944531917572, -0.011751371435821056, 0.015499825589358807, 0.012330617755651474, -0.005972226615995169, 0.03523414209485054, -0.015193558298051357, 0.018256237730383873, -0.022024666890501976, 0.027151327580213547, 0.012836625799536705, 0.013276053592562675, -0.02878919616341591, 0.01105893962085247, -0.013442503288388252, 0.024128595367074013, -0.02484765835106373, 0.006944295018911362, -0.01067943312227726, 0.006644684821367264, -0.006751212757080793, 0.016138993203639984, 0.013515741564333439, 0.004261120688170195, 0.0008572175865992904, 0.01102564949542284, -0.026032783091068268, -0.013362607918679714, 0.0026149298064410686, -0.008315843529999256, 0.0020856186747550964, -0.030014267191290855, 0.035207509994506836, -0.01167813315987587, -0.002365254797041416, 0.013216131366789341, -0.038190294057130814, -0.012197457253932953, 0.03105291537940502, 0.005176595877856016, -0.03384927660226822, 0.037631019949913025, -0.05302431806921959, -0.0059123048558831215, 0.016844742000102997, 0.016258837655186653, 0.0026116007938981056, -0.009787261486053467, -0.0032058274373412132, -0.007137376815080643, -0.0004606504226103425, 0.01568624936044216, -0.05166608840227127, 7.438235479639843e-05, -0.010726039297878742, -0.03635268285870552, 0.02980121225118637, -0.00042236692388541996, -0.012636885978281498, 0.011638185940682888, -0.008176025003194809, 0.01661837100982666, -0.01773691363632679, 0.020772961899638176, -0.009873814880847931, 0.011065597645938396, -0.025686567649245262, 0.0015396627131849527, -0.0025317047256976366, 0.00028879079036414623, 0.012683491222560406, 0.011518341489136219, 0.013322659768164158, -0.0240486990660429, -0.040134429931640625, 0.028203291818499565, -0.001486398745328188, -0.001423147739842534, -0.003319013398140669, 0.0047504836693406105, -0.011052281595766544, -0.00389493047259748, -0.010699407197535038, -0.0071107447147369385, 0.031825244426727295, -0.026325736194849014, 0.009873814880847931, -0.006741225719451904, -0.014008433558046818, 0.022144511342048645, 0.023129895329475403, -0.02086617425084114, 0.002078960882499814, -0.012996417470276356, 0.036192893981933594, 0.010266637429594994, 0.02229098603129387, 0.007656700909137726, -0.014288069680333138, 0.009254621341824532, 0.03203830122947693, -0.003175866324454546, -0.021025966852903366, 0.0064183128997683525, 0.005948923993855715, -0.013003075495362282, -0.011758029460906982, 0.0159259382635355, -0.003944865427911282, -0.02042674645781517, -0.020599855110049248, -0.01868235133588314, -0.00048312119906768203, -0.018069814890623093, 0.01773691363632679, 0.011884531937539577, -0.004327700473368168, -0.01729748584330082, 0.024261755868792534, -0.0017294157296419144, -5.266582547847065e-07, -0.022663835436105728, 0.0036152945831418037, 0.0218515582382679, -0.013395898044109344, 0.030706699937582016, 0.016325417906045914, 0.018376082181930542, 0.011751371435821056, -0.02604609914124012, 0.01127199549227953, 0.016258837655186653, -0.014474493451416492, 0.004810405429452658, 0.018149711191654205, 0.021225707605481148, -0.016405314207077026, -0.0057525127194821835, 0.0016686614835634828, -0.008056181482970715, 0.041945405304431915, -0.0009720681118778884, 0.0009146428783424199, -0.012816651724278927, -0.010606195777654648, 0.02961478754878044, 0.051639456301927567, 0.008608794771134853, -0.007004216779023409, 0.022570623084902763, 0.007177324965596199, -0.006538156885653734, 0.0003200001665391028, -0.019880790263414383, 0.000798960099928081, -0.037950605154037476, -0.01729748584330082, 0.0011210408993065357, 0.025833044201135635, -0.013588979840278625, -0.03278399631381035, 0.029375100508332253, 0.0020506642758846283, -0.01679147779941559, 0.015273453667759895, 0.02423512376844883, 0.017270853742957115, -0.01717764139175415, -0.005106686614453793, 0.004670587833970785, 0.028895724564790726, 0.0035919914953410625, -0.0038250214420259, -0.013702165335416794, -0.025886306539177895, 0.015606353990733624, -0.03715164586901665, -0.003958181478083134, 0.016192257404327393, -0.0017776861786842346, -0.00623188866302371, 0.05398306995630264, 0.012343933805823326, 0.0117114232853055, -0.02886909246444702, -0.015180242247879505, 0.013342633843421936, 0.0042478046379983425, 0.010852541774511337, -0.05241178348660469, 0.007909704931080341, -0.021212391555309296, 0.006355061661452055, -0.03174534812569618, 0.04418249428272247, 0.026405630633234978, -0.04042738303542137, 0.01587267406284809, 0.014567705802619457, 0.014567705802619457, 0.0008068665047176182, 0.013016391545534134, 0.0027247867546975613, 0.02579309605062008, -0.012190799228847027, -0.016911322250962257, -0.021199075505137444, -0.0036752165760844946, -0.0030560223385691643, -0.015246821567416191, 0.051000285893678665, 0.013848641887307167, 0.025633303448557854, 0.004813734441995621, 0.014660918153822422, -0.015712881460785866, 0.04439555108547211, -0.03329000249505043, -0.003144240938127041, 0.010313243605196476, 0.007250562775880098, -0.025526775047183037, -0.021505342796444893, 0.00906153954565525, 0.0023735773283988237, 0.018695665523409843, 0.001349909696727991, -0.0449814535677433, 0.023010050877928734, -0.06343743205070496, -0.033689484000205994, -0.007297168951481581, -0.0005430431920103729, -0.03510098159313202, 0.007889730855822563, 0.02555340714752674, -0.012317301705479622, 0.022690467536449432, -0.014354649931192398, -0.00934117566794157, -0.012903206050395966, 0.032890524715185165, 0.011977743357419968, 0.032570939511060715, 0.020333534106612206, 0.025460194796323776, 0.006581434048712254, 0.015233505517244339, -0.005735867656767368, 0.004777115769684315, -0.03603310137987137, 0.014061697758734226, 0.0015571399126201868, 0.013588979840278625, 0.017004534602165222, 0.041998669505119324, -0.016272153705358505, 0.012843283824622631, 0.0005626010824926198, 0.007350433152168989, 0.021079231053590775, -0.013782061636447906, -0.012483751401305199, 0.0008393242605961859, -0.006504866760224104, -0.003485463559627533, -0.0020922766998410225, -0.034142229706048965, -0.012696807272732258, 0.024075331166386604, 0.023955486714839935, -0.004517453722655773, -0.002027361188083887, 0.025580039247870445, 0.030120795592665672, -0.029747948050498962, 0.018256237730383873, -0.0014181542210280895, -0.013888590037822723, -0.02223772369325161, -0.031132811680436134, -0.02599283494055271, 0.011791319586336613, -0.012417171150445938, -0.013715481385588646, 0.009520941413939, 0.0015097017167136073, -0.008735297247767448, -0.026432262733578682, -0.00665134284645319, 0.012969785369932652, 0.004610665608197451, -0.0007748248754069209, -0.03422212600708008, -0.020027266815304756, 0.002581639913842082, 0.010459719225764275, 0.0036119655705988407, 0.017390698194503784, 0.005629339721053839, 0.03842997923493385, -0.016724897548556328, 0.011298627592623234, -0.022810310125350952, 0.005189911462366581, -0.01717764139175415, 0.006198599003255367, 0.03342316299676895, 0.016085730865597725, 0.02699153497815132, -0.01868235133588314, 0.0047538126818835735, -0.0002463460259605199, -0.029454994946718216, 0.012250721454620361, 0.0057558417320251465, 0.01905519887804985, -0.04388954117894173, -0.0117114232853055, -0.004630639683455229, 0.010373164899647236, 0.01861577108502388, -0.009254621341824532, 0.020706383511424065, 0.003908246289938688]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"(S)
log˜σext(S)
qext(S)
≤logZσ≤Eσext(S)
log˜σext(S)
qext(S)
(83)
where the gap in the lower and upper bounds are DKL(qext(S)∥σext(S))andDKL(σext(S)∥qext(S)), respectively.
Substituting our SMC probabilistic interpretation in Eq. (SMC Extended Proposal) and Eq. (SMC Extended Target), along
with the importance weights in Lemma F.1, into Eq. (83) yields the desired bounds in Eq. (24).
IWAE as a Special Case of our SMC Probabilistic Interpretation Note that we recover IWAE (or SIS over Ksamples)
from SMC with no intermediate resampling. In particular, this corresponds to ωk
t=kfor all t < T , with importance
weighting from resampling occurring at the final stepQK
k=1q(ωk
T|s1:K
1:T). This yields the 1/Kaverage inside the log in the
IWAE bounds (i.e., SMC with only one resampling step at t=T). While the importance weights are crucial to construct the
bound, note that ‘resampling’ is not necessary at the final step and we may return all Ksamples along with their weights.
Viewing IWAE as a special case of our SMC probabilistic interpretation is complementary to the interpretations in Domke
& Sheldon (2018); Brekelmans et al. (2022) and also provides upper bounds (Sobolev & Vetrov, 2019).
G. Additional Experiment Details
G.1. Common Details Across Experiments
For all experiments, we use the Adam optimizer with β1, β2={0.9,0.999}. We use custom implementations of SMC. For
PPO, we use the HuggingFace TRL PPO Trainer ( https://github.com/huggingface/trl/blob/main/trl/trainer/
ppotrainer.py ), modified slightly to accomodate our custom twist parameterizations, as described below. For other
methods, we use Optax (Flax) and custom loss functions. We use HuggingFace models ( https://huggingface.co/
models ) for the base p0models and build custom layers on top of those.
For the twist ψθ
t(s1:t), we always parameterize logψθ
t(s1:t)for numerical stability. We choose random normal initializations
centered at mean 0, with low variance,13such that logψθ
t(s1:t)≈0, ψθ
t(s1:t)≈1at the beginning of training, which means
the initial sequences generated by the twist-induced proposal approximately come from the base model p0. All methods
13We specifically use a form of Xavier initialization, taking the variance as2
ninputs+noutputs.
40
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
are initialized using the same random seeds, and thus start from the same parameter values. See App. G.2 for additional
discussion of choices for the twist parameterization.
For methods that directly learn a proposal (DPG and PPO), we could directly finetune a language model that outputs q(s1:t).
However, in order to ensure consistency in terms of model capacity and ease of learning compared to our twisted proposals,
we instead have these proposal learning methods output a modifier logψθ
t(s1:t)which is added to the base model log
probability logp0(s1:t). Note that using random normal initializations centered at mean 0 with low variance, this scheme
results in initial qsamples coming approximately from p0.
For methods that can make use of exact posterior samples, when we have access to them (Sec. 7.2.3, App. H.3), we use them.
This is straightforward for methods like DPG, SIXO, and our CTL (unless we have only a single sample, as we discuss for
infilling in App. G.4 ). For our RL twist learning, we found the best empirical performance training on a combination of q
and exact σsamples when they were available (as opposed to just qotherwise), and use those results. Similarly, for FUDGE,
when exact σsamples are available, we use them together with p0samples.
It is not straightforward to compare PPO versus other methods, because of the inner loop in PPO that repeats several clipped
gradient steps on a given set of samples. This means that, for a constant number of samples, PPO makes more gradient
updates than other methods","[0.017080135643482208, 0.008083074353635311, 0.05392524600028992, 0.022021379321813583, -0.021878570318222046, 0.004955524578690529, 0.015366410836577415, -0.013231392949819565, -0.03490288928151131, 0.020079156383872032, 0.04007262736558914, -0.015909090638160706, -0.049041129648685455, 0.0195650402456522, 0.02185000665485859, -0.03238942101597786, 0.0333319716155529, -0.005148318596184254, -0.03161824494600296, 0.0014664854388684034, -0.032960664480924606, -0.023877916857600212, -0.04192916303873062, 0.023935040459036827, 0.0038451729342341423, -0.03258935734629631, 0.031104128807783127, -0.002549167489632964, 0.03207524120807648, -0.014345315285027027, 0.0519259013235569, -0.025291740894317627, -0.030447199940681458, -0.0434143953025341, -0.022578341886401176, 0.06169413775205612, 0.0005913247587159276, 0.041243672370910645, -0.01980781741440296, 0.015066508203744888, 0.010453728958964348, -0.06529296189546585, -0.04012975096702576, 0.040244001895189285, 0.02514893002808094, 0.07037701457738876, 0.03053288534283638, -0.00030458802939392626, -0.01650889404118061, 0.03507426008582115, -0.008618613705039024, 0.05161171779036522, -0.009254121221601963, -0.018436836078763008, 0.02302105352282524, -0.0015762709081172943, 0.02155010588467121, -0.00719764968380332, 0.010903581976890564, -0.04324302077293396, 0.021750040352344513, -0.03801615536212921, 0.03030438907444477, -0.010332340374588966, -0.01516647543758154, -0.021992817521095276, -0.01852252334356308, 0.03653092682361603, -0.019507914781570435, 0.036673739552497864, 0.007668924052268267, 0.012403092347085476, 0.014838011935353279, -0.004220050293952227, -0.0418434776365757, 0.0036398826632648706, -0.009175575338304043, 0.04541373997926712, 0.006451464723795652, -0.005573180038481951, -0.01363840326666832, -0.010196669958531857, 0.015109351836144924, -0.03147543594241142, -0.01592337153851986, -0.03313203901052475, -0.02116451784968376, -0.00864003598690033, -0.04627060517668724, -0.01639464683830738, -0.018308306112885475, 0.009468336589634418, -0.02302105352282524, -0.009061326272785664, 0.05355393886566162, -0.0019368674838915467, 0.02359229512512684, 0.0007970611331984401, 0.010039578191936016, 0.023735105991363525, 0.044185571372509, -0.018879549577832222, 0.02026480995118618, -0.01197466067969799, 0.0701485201716423, 0.012531622312963009, -0.001856536604464054, 0.01526644267141819, -0.0460992306470871, -0.004987657070159912, -0.02650563046336174, -0.018850985914468765, -0.03584543615579605, 0.03338909521698952, -0.007258343975991011, -0.03998694196343422, -0.04826994985342026, 0.002097529359161854, -0.019393667578697205, 0.02806226536631584, -0.023549452424049377, 0.007308327592909336, -0.0009354088106192648, 0.02580585889518261, 0.04170066863298416, -0.007811734918504953, 0.012702994979918003, -0.06506446748971939, 0.0084258196875453, 0.029247591271996498, 0.0031454013660550117, -0.0010621531400829554, 0.0015200392808765173, 0.005558899138122797, -0.014002569951117039, -0.010089562274515629, 0.007704626768827438, 0.044071320444345474, -0.006744225975126028, 0.019907783716917038, 0.006690672133117914, -0.029704585671424866, -0.018536804243922234, 0.00041281161247752607, -0.022349843755364418, -0.010039578191936016, -0.03984413295984268, 0.021992817521095276, -0.026677003130316734, 0.040158312767744064, -0.053296882659196854, -0.02182144485414028, -0.0480414554476738, 0.029676023870706558, -0.010418026708066463, -0.049155376851558685, -0.019893502816557884, 0.051983024924993515, 0.020164843648672104, -0.03398890048265457, -0.0050840540789067745, 0.06386485695838928, -0.021435856819152832, 0.0031150542199611664, 0.01662314310669899, -0.010125264525413513, -0.03595968708395958, 0.01999347098171711, -0.05598171800374985, -0.05235433205962181, 0.01569487527012825, -0.03444589301943779, -0.029390402138233185, -0.03261791914701462, 0.012281703762710094, -0.04018687829375267, -0.002220703288912773, -0.08768565207719803, -0.02797657810151577, -0.015937652438879013, -0.016765953972935677, 0.054039496928453445, -0.0399012565612793, -0.0008599869906902313, -0.013024318031966686, 0.017180103808641434, -0.0002590671938378364, 0.03467439115047455, 0.026062916964292526, 0.0025563081726431847, 0.012888648547232151, 0.04267178103327751, 0.07837440818548203, -0.0064764562994241714, -0.018308306112885475, -0.027148276567459106, 0.072090744972229, 0.04641341418027878, -0.0016164364060387015, 0.012910069897770882, -0.00437000161036849, 0.01952219568192959, -0.03701648488640785, -0.05049779638648033, -0.003930859267711639, -0.006512159015983343, -0.0006471101078204811, 0.010996408760547638, -0.08791414648294449, 0.007154806517064571, 0.002322455868124962, -0.01859392784535885, 0.06689243763685226, -0.010882160626351833, -0.04061530902981758, 0.027605270966887474, -0.07374734431505203, -0.006822771858423948, 0.0014352456200867891, 0.07277623564004898, 0.011403419077396393, 0.015994776040315628, 0.03793046995997429, 0.03658805042505264, -0.04701321944594383, 0.021978536620736122, 0.02562020532786846, 0.0019154459005221725, 0.02270686998963356, -0.034874327480793, 0.037987593561410904, 0.021792883053421974, -0.0022885382641106844, -0.027248244732618332, 0.01630895957350731, 0.0029526071157306433, -0.01193181797862053, -0.002659845631569624, -0.03278929367661476, -0.07334747910499573, 0.01420250441879034, 0.006533580832183361, 0.034046024084091187, -0.01658030040562153, 0.020564712584018707, 0.025948669761419296, -0.02899053320288658, -0.004469968844205141, 0.0011487320298328996, -0.0032560795079916716, -0.02006487548351288, -0.027148276567459106, -0.02449200116097927, -0.020050594583153725, -0.05418230593204498, 0.007108393125236034, 0.00573384203016758, 0.013224252499639988, -0.051440343260765076, 0.01693732663989067, -0.003356046974658966, -0.031132690608501434, -0.04707034304738045, 0.018779581412672997, -0.04044393450021744, 0.010196669958531857, -0.014695201069116592, -0.0018797433003783226, 0.04258609190583229, -0.040244001895189285, -0.010410886257886887, 0.01410253718495369, -0.012146033346652985, 0.05189733952283859, -0.010468009859323502, -0.0588950514793396, 0.020436182618141174, 0.04327158257365227, -0.03141831234097481, 0.03007589280605316, -0.008125917986035347, -0.054267991334199905, 0.03844458982348442, -0.006540721282362938, 0.0027883751317858696, 0.005498204380273819, -0.008175901137292385, 0.052525702863931656, -0.005876652430742979, -0.049155376851558685, 0.01759425364434719, 0.00021745130652561784, 0.03207524120807648, -0.00866145733743906, 0.018165497109293938, 0.013831197284162045, 0.020336216315627098, -0.0042878855019807816, 0.0051768808625638485, -0.011367715895175934, 0.04638485237956047, -0.012196017429232597, -0.0042486125603318214, 0.00029097640071995556, 0.024263504892587662, 0.008325852453708649, 0.046127792447805405, 0.023335237056016922, -0.011310592293739319, 0.01516647543758154, -0.014045413583517075, -0.01859392784535885, -0.011739023961126804, 0.03418883681297302, -0.01995062828063965, -0.01619471050798893, 0.043071649968624115, 0.014109677635133266, 0.0056802877224981785, -0.03533132001757622, -0.04138648509979248, -0.006690672133117914, 0.00037197672645561397, -0.0195650402456522, -0.0012299554655328393, -0.016208993270993233, -0.03316060081124306, -0.028847722336649895, -0.02162151038646698, -0.007069120183587074, 0.029933081939816475, 0.009482617489993572, 0.027062591165304184, 0.015751998871564865, -0.012196017429232597, -0.04624204337596893, -0.027733800932765007, 0.048298511654138565, 0.01441672071814537, 0.04007262736558914, -0.11362003535032272, 0.015066508203744888, -0.020564712584018707, -0.04846988618373871, -0.0037809081841260195, 0.018508242443203926, -0.002445630030706525, 0.016537455841898918, 0.10785049200057983, 0.01736575737595558, 0.018279744312167168, -0.010353761725127697, 0.02329239435493946, -0.0042878855019807816, 0.045899298042058945, -0.009775378741323948, 0.005594601389020681, -0.03030438907444477, -0.05244001746177673, -0.0074047246016561985, -0.042871713638305664, 0.0109464256092906, 0.027105433866381645, 0.018108371645212173, 0.01678023487329483, 0.024035008624196053, 0.0017449659062549472, 0.005990900564938784, 0.018393993377685547, 0.005673147272318602, -0.00030391861218959093, 0.033960338681936264, -0.007476130034774542, 0.018508242443203926, -0.056324463337659836, 0.0026009364519268274, -0.005312550812959671, 0.020450465381145477, 0.028219355270266533, 0.02797657810151577, 0.020793208852410316, 0.014195363968610764, -0.010225232690572739, -0.02410641312599182, -0.009054185822606087, 0.007069120183587074, 0.008204463869333267, 0.008382976986467838, -0.0041343639604747295, 0.012003223411738873, -0.008932797238230705, -0.004901970736682415, -0.06717806309461594, 0.013631262816488743, -0.014223926700651646, -0.015566345304250717, -0.019636444747447968, 0.03170393407344818, 0.04044393450021744, 0.04464256390929222, -0.04846988618373871, -0.004687754902988672, -0.06055165454745293, -0.025006119161844254, -0.05472498759627342, 0.014709481969475746, 0.012131752446293831, 0.028576381504535675, 0.01615186780691147, 0.05900930240750313, 0.04332870617508888, -0.0344744548201561, 0.037730537354946136, -0.011474824510514736, 0.01478088740259409, -0.06060877814888954, 0.02641994319856167, 0.008540067821741104, 0.05315406993031502, 0.0763179361820221, -0.019150888547301292, -0.03744491562247276, 0.0024581258185207844, -0.013731230050325394, -0.018993796780705452, 0.0026473498437553644, 0.018165497109293938, -0.035045698285102844, 0.04475681111216545, -0.019736411049962044, 0.0025634486228227615, 0.05032642185688019, 0.06095152348279953, -0.0375877246260643, -0.04432838037610054, -0.040672432631254196, 0.021407295018434525, 0.008754284121096134, -0.003813040442764759, -0.04701321944594383, -0.0032650053035467863, 0.007369022350758314, -0.02042190171778202, 0.012146033346652985, -0.006862044800072908, 0.018122652545571327, -0.021450137719511986, -0.031161252409219742, 0.017037292942404747, -0.011124938726425171, 0.03238942101597786, -0.01875101961195469, 0.06980577856302261, -0.02879059873521328, 0.0054018073715269566, -0.04001550376415253, 0.0829443410038948, -0.01415966171771288, 0.03364615514874458, -0.045585114508867264, 0.04010118916630745, -0.01576627977192402, -0.03607393428683281, 0.010061000473797321, 0.013888321816921234, 0.03855883702635765, 0.0321609266102314, -0.015637749806046486, -0.0035649072378873825, 0.033503346145153046, 0.003663089592009783, -0.05084054172039032, 0.013724089600145817, -0.01755141094326973, -0.014288190752267838, -0.007854578085243702, 0.05706707760691643, -0.043185897171497345, 0.02037905901670456, -0.010860739275813103, 0.03096131794154644, -0.024420596659183502, 0.031989552080631256, 0.03618818148970604, 0.012067487463355064, 0.06609269976615906, 0.023235268890857697, -0.02022196725010872, 0.0021903561428189278, 0.019365103915333748, -0.025405989959836006, -0.059352047741413116, 0.017180103808641434, -0.017380038276314735, 0.06386485695838928, -0.01712298020720482, 0.018194058910012245, 0.005169740412384272, -0.05629590153694153, -0.023578014224767685, 0.0472702793776989, 0.01179614756256342, 0.007294046692550182, 0.043071649968624115, 0.014616655185818672, 0.0588950514793396, 0.0019225864671170712, -0.0006453249952755868, 0.006130141206085682, 0.048184264451265335, 0.003552411450073123, -0.01639464683830738, -0.00019792643433902413, 0.0036952218506485224, -0.0018136934377253056, 0.004784151911735535, -0.02743389829993248, -0.0147237628698349, 0.010925003327429295, 0.01777990721166134, -0.010525134392082691, -0.017180103808641434, -0.05049779638648033, -0.013002896681427956, 0.028762035071849823, -0.032018113881349564, -0.01482373010367155, -0.130243182182312, -0.015637749806046486, -0.03867308422923088, 0.01358127873390913, -0.013931164517998695, 0.004487819969654083, -0.004816284403204918, -0.03533132001757622, 0.012902929447591305, -0.022678308188915253, -0.017851313576102257, -0.0031543271616101265, -0.0038487431593239307, -0.0016557093476876616, 0.002981169382110238, -0.003823751350864768, -0.011339154094457626, 0.016651704907417297, 0.004430695902556181, 0.034274522215127945, -0.010703647509217262, -0.010168108157813549, 0.00175389158539474, 0.015723437070846558, -0.01983637921512127, -0.01526644267141819, -0.02666272222995758, -0.020179124549031258, 0.021721478551626205, -0.0037023623008280993, 0.011246327310800552, -0.010767912492156029, 0.01883670501410961, 0.04564223811030388, -0.010617961175739765, -0.01538069173693657, 0.017994124442338943, -0.01879386231303215, 0.005969479214400053, 0.03867308422923088, -0.014109677635133266, 0.026705564931035042, 0.04875550791621208, -0.05755263566970825, 0.020507588982582092, -0.002106454921886325, -0.020479027181863785, 0.004937673453241587, -0.041643545031547546, 0.012460216879844666, -0.02006487548351288, -0.0071940794587135315, -0.007911701686680317, -0.025391707196831703, 0.004702035803347826, 0.024463439360260963, -0.026105759665369987, -0.03881589695811272, 0.020321935415267944, 0.016009056940674782, 0.01226742286235094, -0.004494960885494947, 0.026905499398708344, 0.042757466435432434, -0.010489432141184807, -0.002204637276008725, 0.007276195101439953, -0.05375387519598007, 0.0064764562994241714, 0.005341113079339266, -0.005508915055543184, -0.03184674307703972, -0.009775378741323948, 0.010396604426205158, 0.03084706887602806, 0.029390402138233185, -0.043842826038599014, -0.052097272127866745, 0.05018361285328865, -0.050469234585762024, 0.013888321816921234, 0.02666272222995758, -0.007933123968541622, 0.021407295018434525, 0.02390647865831852, -0.016137586906552315, -0.017894156277179718, -0.020293373614549637, -0.025977231562137604, 0.028190793469548225, -0.010532274842262268, 0.0689489096403122, -0.01205320656299591, -0.009325525723397732, -0.023649420589208603, 0.031104128807783127, -0.024591969326138496, 0.012503059580922127, 0.014138240367174149, -0.019393667578697205, -0.02684837579727173, -0.00601589260622859, 0.022235596552491188, -0.0242206621915102, 0.006380059290677309, 0.007279765326529741, 0.02646278589963913, 0.008711440488696098, -0.007633221335709095, -0.0003389518242329359, -0.000389158638427034, 0.010168108157813549, -0.0125958863645792, 0.012988615781068802, -0.0008952433709055185, -0.01658030040562153, -0.03984413295984268, 0.02976170927286148, 0.0033007077872753143, -0.009375509805977345, 0.029818832874298096, -0.013909743167459965, -0.020479027181863785, -0.03196099027991295, -0.019779255613684654, 0.024777622893452644, -0.006815631408244371, 0.035931121557950974, -0.02804798260331154, 0.023606576025485992, -0.005990900564938784, 0.00286692101508379, -0.02116451784968376, -0.033960338681936264, -0.004691325128078461, -0.002204637276008725, 0.0039094374515116215, 0.017851313576102257, 0.037987593561410904, 0.013352782465517521, 0.04255753010511398, -0.0016414282144978642, -0.009061326272785664, -0.015023665502667427, 0.0286763496696949, 0.02185000665485859, 0.0010362687753513455, 0.005762403830885887, 0.01058225892484188, 0.0021135956048965454, -0.041129425168037415, -0.0019993470050394535, 0.027805205434560776, -0.0097825201228261, -0.001348666730336845, -0.04592785984277725, -0.029961643740534782, -0.00801881030201912, -0.003309633582830429, 0.02786232903599739, -0.011032111942768097, -0.004548514727503061, 0.0026687714271247387, -0.01852252334356308, 0.005798106547445059, 0.027576709166169167, -0.0271197147667408, -0.017222946509718895, -0.03738779202103615, -0.02386363595724106, 0.027105433866381645, -0.011910396628081799, -0.058723680675029755, 0.0005154566606506705, 0.029818832874298096, -0.04281459003686905, -0.01875101961195469, -0.028119388967752457, -0.01883670501410961, -0.02596295066177845, 0.046441975980997086, 0.0391300804913044, -0.026719845831394196, -0.0005127789918333292, 0.014123959466814995, -0.046013545244932175, 0.016437489539384842, -0.012860085815191269, 0.011917537078261375, 0.008290150202810764, 0.0017315774457529187, -0.004352150019258261, -0.015566345304250717, -0.022406969219446182, -0.035931121557950974, -0.04747021198272705, 0.009732536040246487, 0.0009630783461034298, -0.015052227303385735, -0.042100537568330765, 0.01980781741440296, -0.013302798382937908, 0.0019243715796619654, 0.007022706791758537, 0.03227517381310463, 0.007683205418288708, -0.03387465327978134, -0.017465725541114807, 0.046441975980997086, 0.004973375704139471, 0.02553451806306839, -0.02987595833837986, 0.00156466756016016, 0.009932470507919788, -0.0368165485560894, -0.04684184491634369, 0.046756159514188766, 0.0515260323882103, 0.01682307757437229, 0.018036967143416405, 0.0403011254966259, 0.012224579229950905, -0.021635791286826134, -0.02394932135939598, 0.014081115834414959, -0.01736575737595558, -0.003654163796454668, 0.013945446349680424, -0.013966867700219154, 0.007097681984305382, -0.0028704912401735783, -0.02297821082174778, -0.0095897251740098, 0.002549167489632964, 0.00029767066007480025, -0.0067799286916852, 0.01073220930993557, -0.027805205434560776, 0.026105759665369987, -0.015180757269263268, -0.010632242076098919, 0.004502101335674524, 0.009189856238663197, -0.006180124823004007, 0.010567977093160152, -0.003713073208928108, 0.02766239456832409, 0.07203362137079239, -0.0074047246016561985, 0.010418026708066463, -0.003645238233730197, -0.022364124655723572, -0.00782601535320282, 0.012738697230815887, -0.018422555178403854, -0.01890811137855053, -0.04327158257365227, -0.011103516444563866, -0.03367471694946289, -0.003977272659540176, -0.010667945258319378, 0.017194384709000587, -0.03378896415233612, -0.0037523461505770683, 0.022364124655723572, -0.018151216208934784, -0.005126897245645523, 0.002211777726188302, 0.02166435308754444, -0.01431675348430872, -0.11916108429431915, -0.03998694196343422, 0.02259262278676033, 0.01750856824219227, 0.03087563067674637, -0.02684837579727173, 0.011317732743918896, -0.008168760687112808, -0.004273604601621628, -0.02456340752542019, 0.01371694914996624, -0.029590336605906487, 0.005116186570376158, 0.028347885236144066, 0.02304961532354355, -0.058609433472156525, -0.014002569951117039, 0.0008470448083244264, -0.012224579229950905, -0.004098661709576845, -0.004987657070159912, 0.021178798750042915, 0.016708828508853912, 0.042871713638305664, -0.028504977002739906, -0.008254447020590305, 0.000731011270545423, 0.012531622312963009, -0.013759791851043701, 0.011639056727290154, -0.01363840326666832, -0.006130141206085682, 0.02709115296602249, 0.04021544009447098, -0.014923698268830776, 0.003206095891073346, 0.007019136566668749, -0.005819528363645077, -0.006555002182722092, -0.035045698285102844, 0.005198302213102579, -0.05041210725903511, 0.0643218532204628, 0.012802962213754654, 0.015309286303818226, -0.02696262300014496, 0.010882160626351833, -0.01682307757437229, 0.016537455841898918, -0.02627713233232498, 0.01340990699827671, 0.0114319808781147, 0.018379712477326393, -0.015723437070846558, -0.007011995650827885, 0.0182083398103714, -0.003805899992585182, -0.0020314794965088367, 0.004352150019258261, 0.023463767021894455, -0.021264484152197838, 0.018336869776248932, 0.04629916697740555, -0.014838011935353279, -0.062208257615566254, -0.02406357042491436, -0.015123632736504078, -0.012074627913534641, 0.010982127860188484, -0.017494287341833115, 0.010203810408711433, 0.0029865247197449207, 0.007747469935566187, 0.009518320672214031, -0.0054018073715269566, -0.004916251637041569, -0.0038166106678545475, 0.014709481969475746, -0.04898400232195854, -0.006487167440354824, 0.04344295710325241, -0.0460992306470871, 0.02999020554125309, 0.005126897245645523, -0.006287232507020235, 0.012981475330889225, 0.0010425166692584753, -0.0018511811504140496, -0.016437489539384842, 0.050354983657598495, 0.049041129648685455, -0.00517331063747406, 0.010118124075233936, -0.04312877357006073, 0.0019422229379415512, -0.017908437177538872, 0.00774032948538661, 0.021492980420589447, 0.03324628621339798, 0.006394340191036463, 0.017408600077033043, 0.035159945487976074, -0.010225232690572739, -0.0271197147667408, 0.022578341886401176, 0.027805205434560776, -0.016651704907417297, 0.025891544297337532, 0.0027812346816062927, 0.004541374277323484, 0.009946751408278942, -0.014766606502234936, -0.05081197991967201, 0.014580952934920788, -0.0060194628313183784, -0.0015137913869693875, 0.06129426881670952, 0.033074911683797836, 0.02397788316011429, 0.021592948585748672, 0.008147339336574078, 0.01042516715824604, -0.006247959565371275, 0.02006487548351288, -0.02069324254989624, -0.016009056940674782, 0.0032221621368080378, 0.016366083174943924, -0.011667618528008461, -0.014680920168757439, 0.02232128195464611, -0.016094744205474854, 0.019093764945864677, -0.009525461122393608, -0.026362819597125053, 0.04250040650367737, 0.02639138139784336, -0.01639464683830738, -0.0176370982080698, 0.013931164517998695, -0.0031721782870590687, 0.01003243774175644, 0.02976170927286148, 0.037530601024627686, 0.012831524014472961, -0.002502754097804427, 0.00866145733743906, -0.028662068769335747, 0.0035898990463465452, 0.0003367204044479877, 0.03538844361901283, -0.012453076429665089, -0.02573445253074169, -0.009639709256589413, -0.0010996408527716994, -0.010525134392082691, -0.008368696086108685, -0.01249591913074255, -0.02437775395810604, 0.00819732341915369, 0.013966867700219154, 0.041443608701229095, 0.0121103310957551, -0.002725895494222641, 0.013574138283729553, -0.006222967989742756, -0.030704258009791374, -0.002117165829986334, -0.007065549958497286, 0.03181818127632141, 0.0010514423483982682, -0.04484250023961067, 0.019864941015839577, 0.010075281374156475, 0.02976170927286148, 0.009661130607128143, -0.011139219626784325, 0.015237880870699883, -0.00766178360208869, 0.027176840230822563, 0.013045739382505417, 0.023263830691576004, -0.014795168302953243, 0.011132079176604748, 0.04986942932009697, -0.03713073208928108, 0.010882160626351833, 0.00806165300309658, 0.00736188143491745, 0.03770197182893753, 0.001929726917296648, 0.015466378070414066, -0.03061857260763645, 0.040586747229099274, 0.028662068769335747, 0.004241472110152245, -0.02456340752542019, 0.006640688516199589, -0.00275624287314713, -0.03658805042505264, -0.02274971455335617, 0.02681981399655342, -0.006572853773832321, -0.03313203901052475, -0.023449484258890152, 0.03381752967834473, -0.04444263130426407, 0.005737412255257368, -0.00920413713902235, -0.001993991667404771, 0.0010121694067493081, 0.004537804052233696, -0.006194405723363161, 0.02522033452987671, -0.025448832660913467, -0.04647053778171539, 0.009061326272785664, 0.013417047448456287, -0.05138321965932846, -0.01548065897077322, -0.01296005304902792, -0.014273909851908684, -0.025434551760554314, 0.009004202671349049, -0.013988289050757885, 0.01086787972599268, 0.008497225120663643, -0.0038166106678545475, -0.01187469344586134, 0.0007390443934127688, 0.00605516554787755, 0.0012772614136338234, -0.02254977822303772, 0.0065371510572731495, 0.009296963922679424, -0.024263504892587662, -0.02646278589963913, -0.018279744312167168, -0.024263504892587662, -0.00505549181252718, -6.738870433764532e-05, 0.006040884647518396, -0.002284968039020896, 0.002624143147841096, 0.0191794503480196, -0.010453728958964348, 0.03327484801411629, 0.02476334199309349, -0.025520237162709236, -0.02630569599568844, -0.02220703288912773, 0.00920413713902235, 0.031675368547439575, -0.014173942618072033, 0.003568477462977171, 0.01315284799784422, -0.0027133997064083815, 0.058066751807928085, 0.03715929388999939, 0.013502733781933784, -0.012360249646008015, -0.0009720040252432227, -0.0014138240367174149, -0.015680594369769096, 0.011182062327861786, -0.014980821870267391, 0.014980821870267391, 0.015409253537654877, -0.020707523450255394, -0.0005154566606506705, -0.030561449006199837, 0.003580973483622074, 0.0015209318371489644, 0.04935530945658684, 0.013238534331321716, 0.0011076739756390452, 0.0021903561428189278, -0.016109025105834007, 0.004894830286502838, 0.029204748570919037, -0.03021870367228985, -0.023492328822612762, -0.039587073028087616, -0.0313897505402565, 0.03393177688121796, -0.010360902175307274, 0.001246021711267531, 0.0005502667045220733, 0.007875999435782433, 0.013666965067386627, 0.040558185428380966, 0.046784721314907074, -0.026148604229092598, 0.0014959400286898017, -0.0010085991816595197, -0.005855230614542961, 0.001638750545680523, 0.02790517359972, 0.002752672415226698, -0.0034899318125098944, -0.01208890974521637, 0.03673086315393448, -0.001434353063814342, 0.0074975513853132725, 0.020793208852410316, 0.014038273133337498, 0.020050594583153725, 0.014666639268398285, -0.01926513761281967, -0.023121021687984467, -0.011196344159543514, -0.00974681694060564, 0.006365778390318155, 0.028462134301662445, 0.03701648488640785, -0.011539088562130928, -0.0038951565511524677, -0.0039237188175320625, 0.017180103808641434, 0.002240339759737253, -0.016066182404756546, -0.01817977800965309, 0.02304961532354355, 0.013281377032399178, -0.02831932343542576, -0.03290354087948799, -0.0019814958795905113, -0.02270686998963356, -0.009975314140319824, 0.03064713440835476, -0.007283336017280817, 0.022264158353209496, -0.0004743986646644771, -0.02759099006652832, -0.011888974346220493, 0.022378405556082726, -0.025862982496619225, 0.0018993797712028027, -0.021835725754499435, -0.023692263290286064, 0.028105108067393303, 0.01650889404118061, -0.01431675348430872, -0.015366410836577415, 0.0063836295157670975, 0.0032168065663427114, -0.005191161762923002, -0.007390443701297045, -0.005380386020988226, -0.03615961968898773, 0.07963113486766815, 0.015994776040315628, -0.01057511754333973, -0.009446915239095688, -0.007376162800937891, 0.02372082509100437, -0.01669454760849476, -0.009789660573005676, -0.04387138783931732, 0.00850436557084322, -0.01127488911151886, 0.02352089062333107, -0.019236575812101364, -0.004862697795033455, 0.00681920163333416, -0.006322935223579407, -0.017565691843628883, 0.007683205418288708, 0.014045413583517075, -0.0057267011143267155, 0.020836053416132927, 0.00024590184330008924, -0.034931451082229614, 0.024092132225632668, -0.015052227303385735, -0.003213236341252923, -0.027062591165304184, 0.0001303145836573094, -0.00042553068487904966, 0.006155132781714201, -0.000983607373200357, 0.00751897320151329, -0.03353190794587135, -0.018551085144281387, 0.01542353443801403, -0.012724416330456734, -0.05432511493563652, -0.0025509526021778584, -0.006455034948885441, 0.015552064403891563, 0.0056481556966900826, 0.0038665945176035166, -0.0003425220784265548, 0.0025259607937186956, -0.01949363388121128, -0.0013825842179358006, 0.005226864479482174, -0.012738697230815887, -0.006069446448236704, 0.01195323932915926, 0.0026348538231104612, -0.02367798238992691, 0.01373837050050497, -0.008233025670051575, 0.013402765616774559, -0.005062632262706757, -0.019622163847088814, 0.03761628642678261, 0.006690672133117914, -0.013645543716847897, -0.025862982496619225, 0.0004407042870298028, -0.01596621423959732, 0.030361514538526535, 0.022835399955511093, -0.03164680674672127, 0.010846458375453949, 0.02449200116097927, 0.009911049157381058, 0.039815567433834076, -0.007968826219439507, 0.0022064223885536194, -0.004569936078041792, 0.009939610958099365, 0.011282029561698437, -0.009496898390352726, -0.010160967707633972, 0.04327158257365227, -0.0052697076462209225, 0.04027256369590759, -0.011838991194963455, -0.004869838245213032, -0.016608862206339836, 0.0005301840137690306, 0.02766239456832409, 0.01999347098171711, 0.013566997833549976, -0.006497878115624189, -0.02317814528942108, 0.007204790133982897, -0.021178798750042915, 0.009539742022752762, 0.015195038169622421, -0.0028794168028980494, 0.0004864482907578349, -0.01813693344593048, 0.03161824494600296, -0.0240207277238369, -0.005651725921779871, 0.01542353443801403, -0.019693568348884583, -0.03030438907444477, 0.052754200994968414, 0.01777990721166134, -0.006876325700432062, 0.02254977822303772, -0.04387138783931732, -0.02976170927286148, 0.018893830478191376, 0.04075811803340912, -0.008111637085676193, -0.0007394906715489924, 0.0147237628698349, 0.021921413019299507, 0.017037292942404747, -0.0011630130466073751, -0.04324302077293396, 0.043842826038599014, -5.2717157814186066e-05, -0.04121511057019234, 0.0170515738427639, -0.00970397423952818, -0.01381691638380289, 0.015951933339238167, 0.0028704912401735783, 0.007233351934701204, -0.01890811137855053, -0.016980169340968132, -0.011774726212024689, 0.019593602046370506, -0.03087563067674637, 0.004894830286502838, 0.003147186478599906, 0.00631579477339983, 0.022849680855870247, -0.012581605464220047, 0.010939285159111023, -0.007597519084811211, -0.03207524120807648, -0.006176554597914219, -0.002454555593430996, -0.00827586930245161, -0.009346948005259037, -0.0032685755286365747, -0.00806165300309658, -0.0005025144782848656, -0.01273155678063631, -0.015109351836144924, 0.011217765510082245, 0.0019993470050394535, -0.010617961175739765, -0.024149255827069283, -0.0027401766274124384, 0.010225232690572739, 0.008190182968974113, -0.0021957114804536104, -0.006787069141864777, -0.026834094896912575, 0.023763667792081833, 0.008939937688410282, 0.027062591165304184, -0.027019748464226723, -0.01133201364427805, 0.01748000644147396, 0.02999020554125309, 0.003502427600324154, -0.006908458191901445, -0.02123592235147953, 0.008632895536720753, -0.014252488501369953, -0.005373245105147362, 0.020750366151332855, -0.012124611996114254, -0.022649746388196945, -0.023492328822612762, -0.03204667940735817, 0.003691651625558734, 0.004166496451944113, -0.032018113881349564, 0.001283509423956275, -0.0007640362018719316, -0.02890484593808651, 0.049726616591215134, 0.00025795146939344704, -0.01373837050050497, -0.012174596078693867, 0.002317100530490279, 0.020207686349749565, -0.006447894498705864, 0.0010416241129860282, -0.011117798276245594, 0.004484249744564295, -0.008532927371561527, -0.01805124804377556, 0.011117798276245594, 0.0022153479512780905, 0.0029365411028265953, -0.010375183075666428, -0.014895135536789894, 0.02464909292757511, -0.0277052391320467, 0.006187265273183584, 0.02696262300014496, 0.011160640977323055, -0.0005315228481777012, 0.010974987410008907, 0.008732862770557404, -0.018336869776248932, -0.004723457619547844, 0.01980781741440296, 0.020564712584018707, 0.0024063570890575647, -0.0007542179664596915, 0.015723437070846558, 0.013602701015770435, -0.012745837680995464, 0.015552064403891563, -0.006426472682505846, 0.0019243715796619654, -0.0010728639317676425, -0.011503386311233044, 0.00819732341915369, 0.022949649021029472, -0.004919821862131357, -0.03984413295984268, 0.024520564824342728, -0.004648481961339712, 0.012874366715550423, 0.010667945258319378, 0.028433572500944138, 0.010596539825201035, -0.018122652545571327, -0.019936347380280495, -0.003288211999461055, 0.02092173881828785, -0.004959094803780317, 0.018979515880346298, -0.027648113667964935, -0.013909743167459965, 0.007083401083946228, -0.05181165039539337, 0.008418679237365723, 0.007776032201945782, 0.009018483571708202, -0.0027223252691328526, 0.06072302907705307, 0.0016905193915590644, 0.03316060081124306, -0.03247511014342308, -0.002070752438157797, 0.013531295582652092, 0.025677328929305077, -0.009561163373291492, -0.03441733121871948, 0.027733800932765007, -0.02092173881828785, 0.0028865572530776262, -0.03853027522563934, 0.0337032787501812, 0.0430145226418972, -0.01770850270986557, -0.012681572698056698, 0.03336053341627121, 0.010168108157813549, 0.013224252499639988, 0.021678633987903595, -0.011446261778473854, -0.003977272659540176, -0.02750530280172825, -0.02894769050180912, -0.006372918840497732, -0.012724416330456734, -0.02899053320288658, -0.013167128898203373, 0.015509220771491528, 0.022849680855870247, 0.027519583702087402, 0.012124611996114254, 0.017722783610224724, -0.009946751408278942, 0.0464990995824337, -0.02352089062333107, 0.010410886257886887, 0.010046719573438168, -0.0014165017055347562, -0.007875999435782433, -0.0213073268532753, -0.00030882772989571095, 0.0016914119478315115, 0.026791250333189964, -0.02030765451490879, -0.027491021901369095, 0.03393177688121796, -0.05161171779036522, -0.024791903793811798, -0.01205320656299591, 0.02340664155781269, -0.046984657645225525, 0.004577076528221369, 0.015366410836577415, -0.0007528791320510209, -0.010332340374588966, -0.011824710294604301, -0.008418679237365723, 0.036902233958244324, 0.05215439572930336, -0.02057899348437786, 0.04701321944594383, 0.0002441167162032798, -0.003288211999461055, 0.021592948585748672, 0.001892239204607904, -0.005005508195608854, -0.009189856238663197, -0.035902559757232666, 0.02759099006652832, -0.008989921770989895, 0.02329239435493946, -0.01922229491174221, 0.030018769204616547, -0.023877916857600212, 0.010617961175739765, -0.0021314467303454876, 0.037416353821754456, 0.023335237056016922, 0.010232373140752316, -0.009661130607128143, 0.014852292835712433, -0.014373877085745335, -0.014838011935353279, 0.004677044227719307, -0.025563079863786697, 0.028433572500944138, 0.01766566000878811, -0.012945772148668766, -0.0021403725259006023, 0.0001922363298945129, 0.011760445311665535, 0.02899053320288658, -0.04392851144075394, 0.00648002652451396, 0.0052232942543923855, -0.008468663319945335, -0.016994450241327286, -0.02739105559885502, -0.00018040982831735164, 0.00040700993849895895, 0.004034396726638079, -0.0060194628313183784, -0.00487340847030282, 0.03887302055954933, 0.02831932343542576, -0.0006363993161357939, -0.002172504784539342, 0.04527093097567558, 0.005848090164363384, -0.00046904326882213354, -0.03278929367661476, -0.030475761741399765, 0.017794189974665642, -0.016366083174943924, -0.007626080885529518, 0.02883344143629074, 0.012838664464652538, 0.018108371645212173, -0.029304716736078262, 0.013517014682292938, -0.02324954979121685, 0.02270686998963356, -0.02684837579727173, -0.002351017901673913, 0.04127223789691925, 0.012081769295036793, 0.010453728958964348, -0.01980781741440296, -0.0313897505402565, -0.012181736528873444, -0.023549452424049377, 0.0296474602073431, 0.0002398770157014951, 0.03238942101597786, -0.03153255954384804, -0.0010951780714094639, -0.01387404091656208, 0.015295005403459072, -0.0006828127079643309, -0.026677003130316734, 0.02317814528942108, -0.01576627977192402]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
", while for a constant number of gradient updates, PPO sees fewer samples. Ultimately we
decided to normalize based on the number of samples seen; we consider each outer step (including a full PPO inner loop, in
our experiments, 4 gradient steps) as a single “gradient update.” We make this choice since sampling is the main bottleneck
in terms of computational cost, and the number of inner PPO steps is a hyperparameter which we did not tune.
All of our experiments were run on a single GPU, usually on an NVIDIA A40 with 48G memory. All experiments took no
longer than 9 wall-clock hours to run for a single learning method, with infilling (Sec. 7.2.3) experiments taking longest;
most other experiments took no longer than 4 hours.
G.2. Choices of Twist Parameterization
The choice of parameterization for the twist logψθ
t(s1:t)is a design decision, independent of our overall framework. While
one could keep an entirely separate model for each logψθ
t(s1:t), this is likely to be memory-inefficient and learn slowly.
Instead, we use a shared parameterization across s1:t, in the same way that the base language model uses a single architecture
to output probability distributions over tokens at each time step t. We lay out parameterization choices we considered below.
G.2.1. L INEAR HEAD
The simplest choice is to replace the linear head of the base language model with a new linear head, keep the base model
fixed, and only train the linear head. This parameterization incurs very little additional computation cost compared to just
using the base language model. However, we found this to be capacity constrained in our experiments, achieving worse KL
divergences than other parameterizations.
G.2.2. MLP H EAD
Instead of a linear head, we consider a 3-layer fully connected neural network (MLP) with ReLU non-linearities as a head
on top of the base language model. The base model is still kept fixed; only the MLP head is trained. This incurs more
computational cost than a linear head (App. G.2.1), but the additional cost is still small relative to the cost of a forward
pass through the base transformer model. We found this to generally perform well in our experiments, so we use it for the
toxicity threshold experiment in Sec. 7.1 and sentiment in Sec. 7.2.2.
G.2.3. S EPARATE TRANSFORMER FOR THE TWIST
We can also consider an entirely separate transformer that outputs only the twist value. That is, we copy the base model,
and repurpose it to output a twist value logψθ
t(s1:t)instead of logits for next-token probabilities. We then train the entire
network end-to-end. This is significantly more computationally costly than the former approaches, and does not always do
better than just an MLP head (App. G.2.2), so we generally do not recommend using this. Still, we found it to perform well
in toxicity classification in Sec. 7.2.1, so we use it there.
G.2.4. S EPARATE TRANSFORMER FOR THE TWIST ,WITH MLP H EAD
This is similar to App. G.2.3, except we also replace the final linear head with a MLP head as in App. G.2.2. The
model outputs logψθ
t(s1:t)and is trained end-to-end. This is the most computationally costly approach outlined here,
and is unnecessary for most of our settings. However, in infilling with 15 generated tokens (Sec. 7.2.3) we found this
41
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
parameterization to perform materially better than all others, particularly with DPG (App. E.3), so we use it for all infilling
experiments.
With both this parameterization and App. G.2.3, we increase computation time by a factor of around 2 on the forward pass,
and significantly increase memory and time usage on the backwards pass during training (though sampling is still the main
time bottleneck). Whether this parameterization is worth the potential gain in performance depends on the desired use case.
We emphasize that our overall framework is independent of the choice of parameterization.
G.3. Comments on Our Choices of Experiment Settings
Our settings and evaluation metrics in Sec. 7 are chosen to highlight our scientific findings. In particular, the toxicity
threshold experiment in Sec. 7.1 demonstrates the improvement of SMC over SIS with the base model with","[-0.012579962611198425, -0.004723282530903816, 0.03905816748738289, 0.009115339256823063, -0.006713950540870428, -0.000886029505636543, 0.04064805060625076, 0.00812166091054678, -0.017011765390634537, 0.020151788368821144, 0.02824695222079754, 0.003355319146066904, -0.043509844690561295, 0.03301660716533661, 0.008943101391196251, -0.041760969907045364, 0.05506300553679466, 0.0063860369846224785, -0.0161505788564682, 0.038713693618774414, -0.029200881719589233, -0.019661573693156242, -0.021317703649401665, 0.03418252244591713, 0.006863002199679613, -0.017780210822820663, 0.0336790569126606, 0.0022490243427455425, 0.017541727051138878, -0.026643818244338036, 0.01532913837581873, -0.014017483219504356, -0.05326113849878311, -0.06280044466257095, -0.0150376595556736, 0.022457120940089226, 0.029677847400307655, 0.03304310515522957, -0.02288109064102173, 0.044039804488420486, 0.023662783205509186, -0.05352611839771271, -0.047140080481767654, 0.05106179788708687, 0.006435720715671778, 0.05159175768494606, 0.028326446190476418, 0.019383344799280167, -0.005405608098953962, 0.026670316234230995, -0.03913766145706177, 0.038157232105731964, -0.017740463837981224, -0.044066302478313446, 0.016336064785718918, -0.008168032392859459, -0.010638978332281113, -0.03889917954802513, 0.02224513702094555, -0.03436800837516785, 0.023689281195402145, -0.05172424763441086, 0.02702803909778595, 0.0034447500947862864, 0.0017969008767977357, -0.018455911427736282, -0.05744783207774162, 0.02753150276839733, -0.03338757902383804, 0.030976252630352974, 0.020125290378928185, -0.013620012439787388, -0.001979075139388442, 0.010619104839861393, -0.03436800837516785, 0.03161220625042915, -0.006545025389641523, 0.030843762680888176, 0.015408632345497608, -0.01016863714903593, 0.013017181307077408, -0.012546840123832226, 0.010446866974234581, -0.01556762121617794, -0.012036751955747604, -0.028405940160155296, -0.011029824614524841, -0.041813965886831284, -0.02575613185763359, -0.037494782358407974, -0.01861489936709404, -0.000178137473994866, -0.02286784164607525, 0.010778093710541725, 0.059779662638902664, -0.007856680080294609, -0.0006347117596305907, -0.013540517538785934, 0.009221331216394901, 0.026749810203909874, 0.04282089322805405, 0.002520629670470953, 0.027743488550186157, 0.010307752527296543, 0.033255089074373245, -0.016402309760451317, -0.009963277727365494, 0.030843762680888176, -0.038607701659202576, 0.009367071092128754, -0.0169057734310627, 0.011009951122105122, -0.05712985619902611, 0.017276747152209282, -0.01750198006629944, -0.06730511784553528, -0.03182419016957283, 0.0335465669631958, 0.00959892850369215, 0.010857587680220604, -0.031426720321178436, 0.003868719330057502, 0.0077639371156692505, 0.01624332182109356, 0.031426720321178436, -0.03283111751079559, 0.01612408086657524, -0.04682210460305214, 0.010102392174303532, 0.029253877699375153, -0.006323103792965412, 0.012772073969244957, -0.0034911218099296093, -0.008883480913937092, -0.0075916992500424385, -0.010029522702097893, -0.014587191864848137, 0.0454707033932209, 0.0005837857606820762, 0.01471968274563551, 0.0005531474016606808, -0.0155941192060709, -0.04973689094185829, -0.00867149606347084, -0.024258989840745926, 0.0018349919700995088, -0.05026685446500778, 0.04454327002167702, 0.004696784541010857, 0.060203634202480316, -0.03593139350414276, -0.020006049424409866, -0.032115671783685684, 0.004975014366209507, -0.004110514186322689, -0.01807168871164322, -0.010685349814593792, 0.0646023154258728, 0.04483474791049957, -0.024470975622534752, -0.006660954561084509, 0.04562969133257866, -0.006346289534121752, -0.012162618339061737, 0.017647720873355865, 0.016972018405795097, -0.025544147938489914, -0.006011751480400562, -0.06216449290513992, -0.06640418618917465, 0.02224513702094555, -0.04446377605199814, -0.03052578680217266, -0.04255591332912445, 0.017713965848088264, -0.041813965886831284, -0.04117801412940025, -0.07276372611522675, -0.005783205386251211, -0.019886808469891548, -0.027743488550186157, 0.05331413447856903, -0.04160198196768761, 0.03344057500362396, -0.012858192436397076, 0.0066013336181640625, -0.013779000379145145, 0.03548092767596245, 0.004398680757731199, 0.021357450634241104, 0.029253877699375153, 0.020800990983843803, 0.08606575429439545, 0.0062303608283400536, -0.02156943641602993, 0.018800387158989906, 0.05750082805752754, 0.01976756565272808, -0.027743488550186157, 0.0299428291618824, 0.024894945323467255, 0.03352006897330284, -0.0027723615057766438, -0.08182606846094131, 0.005024698097258806, -0.00523005798459053, -0.015435130335390568, -0.01530264038592577, -0.05697086825966835, 0.0020966604351997375, -0.0022606172133237123, -0.013222540728747845, 0.040515560656785965, 0.029810337349772453, -0.030260805040597916, 0.017674218863248825, -0.07392963767051697, -0.006415847223252058, 0.031453218311071396, 0.04605365917086601, 0.012149368412792683, 0.024961190298199654, 0.03412952646613121, 0.0335465669631958, -0.02701479010283947, 0.012036751955747604, 0.0016346002230420709, -0.01984705962240696, 0.02044326812028885, -0.027955472469329834, 0.02943936549127102, 0.013202667236328125, 0.0062369853258132935, -0.027160530909895897, 0.02941286750137806, -0.02588862180709839, -0.006395973730832338, -0.003868719330057502, -0.0173297431319952, -0.06004464626312256, 0.010069269686937332, 0.02461671456694603, 0.03110874444246292, -0.022602859884500504, 0.0029744093772023916, 0.03754777833819389, -0.019462838768959045, -0.012970808893442154, 0.013990985229611397, 0.03110874444246292, -0.041151516139507294, -0.016548050567507744, -0.04817350581288338, -0.016587797552347183, -0.04496723785996437, 0.005263180937618017, 0.019900057464838028, -0.00523337023332715, -0.03426201641559601, 0.010413744486868382, 0.03677933290600777, -0.000988709507510066, -0.01914486102759838, -0.005435418337583542, -0.05591094493865967, -0.0017869641305878758, -0.029174383729696274, 0.02530566416680813, 0.01742248609662056, -0.0609985776245594, 0.006674203556030989, -0.026869051158428192, 0.012122870422899723, 0.05106179788708687, -0.01738273911178112, -0.04446377605199814, 0.0282734502106905, 0.0501873604953289, -0.054268065840005875, 0.02273535169661045, -0.022536614909768105, -0.02046976611018181, 0.07398263365030289, -0.014838923700153828, -0.0055447230115532875, 0.0382632240653038, 0.010022898204624653, 0.027955472469329834, 0.0015493094688281417, -0.05506300553679466, 0.0005051196203567088, 0.010970204137265682, 0.029253877699375153, 0.017078012228012085, 0.019370095804333687, 0.04480824992060661, 0.008320396766066551, 0.007909676060080528, 0.025994613766670227, -0.02032402530312538, 0.04022408276796341, -0.009479687549173832, 0.0033337895292788744, -0.008936476893723011, 0.02701479010283947, 0.016336064785718918, 0.02633908949792385, 0.028008468449115753, -0.017568225041031837, 0.00896297488361597, -0.025332162156701088, -0.023609787225723267, -0.015951843932271004, 0.031506214290857315, 0.009777790866792202, 0.020138539373874664, 0.03709730878472328, -0.01017526164650917, 0.01619032584130764, -0.03651435300707817, -0.04451677203178406, -0.02698829211294651, -0.010248132050037384, -0.004869021940976381, 0.007180979009717703, -0.010360748507082462, -0.029677847400307655, 0.00494520366191864, -0.008300523273646832, 0.017740463837981224, 0.018919628113508224, -0.04035657271742821, 0.011188813485205173, 0.021953657269477844, -0.041760969907045364, -0.020098792389035225, -0.053632110357284546, 0.05829577147960663, -0.006445657461881638, 0.04040956869721413, -0.10143464058637619, 0.01616382785141468, -0.0003446820192039013, -0.04006509482860565, -0.004776278510689735, 0.02933337166905403, 0.006054810713976622, 0.036911822855472565, 0.08119010925292969, 0.015978341922163963, 0.001335668726824224, -0.02339780330657959, 0.012354728765785694, 0.001974106766283512, 0.03534843772649765, 0.02342430129647255, -0.01740923710167408, -0.00523005798459053, -0.0371503047645092, -0.011997004970908165, -0.03357306495308876, 0.009121963754296303, 0.015872348099946976, 0.033175595104694366, 0.028617924079298973, 0.039376143366098404, -0.02209939807653427, 0.014216219075024128, -0.027266522869467735, 0.014017483219504356, -0.014322211034595966, 0.0012288483558222651, -0.010340875014662743, 0.005799766629934311, -0.06115756556391716, -0.010109016671776772, -0.018429413437843323, 0.019502585753798485, 0.019489336758852005, -0.006949121132493019, 0.011857889592647552, 0.027346016839146614, -0.018376417458057404, -0.004971702117472887, -0.005001512356102467, 0.007459208834916353, 0.03707081079483032, -0.0006446485640481114, -0.0300753191113472, 0.014852172695100307, 0.006425783969461918, -0.011599533259868622, -0.041019026190042496, 0.02814095839858055, -0.00991690531373024, -0.005051196087151766, -0.011062948033213615, 0.05053183436393738, 0.04091303423047066, 0.049604400992393494, -0.04382782056927681, -0.013030430302023888, -0.06857702881097794, -0.007247224450111389, -0.014255966059863567, 0.005726897157728672, 0.015368885360658169, 0.011844640597701073, 0.05649390444159508, 0.03789225220680237, 0.048226501792669296, -0.036885324865579605, 0.018164431676268578, -0.0026067483704537153, 0.010559484362602234, -0.056705888360738754, 0.013209291733801365, 0.021847665309906006, 0.06444332748651505, 0.0682060495018959, -0.009486312046647072, -0.035109952092170715, -0.019065367057919502, -0.023755526170134544, -0.03110874444246292, -0.011122568510472775, 0.009420067071914673, -0.030896758660674095, 0.0025868748780339956, -0.009764541871845722, 3.180286876158789e-05, 0.027743488550186157, 0.034394506365060806, -0.03783925622701645, -0.03052578680217266, -0.06412535160779953, 0.011910886503756046, 0.02877691201865673, -0.00018082867609336972, -0.02329181134700775, 0.002222526352852583, -0.013321909122169018, 0.01923760399222374, 0.00926770269870758, -0.01562061719596386, -0.0012586587108671665, -0.029280375689268112, -0.01861489936709404, -0.0022573049645870924, -0.03476547822356224, 0.026034362614154816, -0.007359841372817755, 0.08553579449653625, 0.0035871772561222315, 0.023000331595540047, -0.045921169221401215, 0.0682060495018959, -0.023821773007512093, 0.06444332748651505, -0.05506300553679466, 0.059779662638902664, 0.005428793840110302, -0.048888955265283585, -0.014759429730474949, 0.00464378809556365, 0.04396031051874161, 0.003908466547727585, -0.042370427399873734, 0.005551347509026527, 0.029836835339665413, -0.010340875014662743, -0.031426720321178436, -0.01502441056072712, -0.03370555490255356, -0.02211264707148075, 0.003971399273723364, 0.02103947475552559, -0.01470643375068903, 0.015488126315176487, -0.022324630990624428, 0.012858192436397076, 0.007161105517297983, 0.022907588630914688, 0.0144149549305439, -0.020668501034379005, 0.08797361701726913, 0.01807168871164322, -0.010321001522243023, -0.026617320254445076, 0.013937989249825478, 0.004110514186322689, -0.04902144521474838, 0.02453722059726715, -0.01467993576079607, 0.050054870545864105, -0.013116548769176006, -0.022602859884500504, -0.02158268541097641, -0.016031337901949883, -0.021251458674669266, 0.05220121517777443, 0.021198462694883347, 0.014229468069970608, 0.04502023383975029, 0.012844943441450596, 0.017740463837981224, 0.03487147018313408, 0.00247757020406425, -0.00871786754578352, 0.04117801412940025, 0.0013596826465800405, 0.011626032181084156, 0.0008375876932404935, 3.6046702007297426e-05, 0.010731721296906471, 0.010552859865128994, 0.004693472292274237, -0.02343755029141903, 0.01556762121617794, 0.016309566795825958, 0.010241507552564144, 0.00463716359809041, -0.04083354026079178, -0.02466971054673195, 0.01811143569648266, -0.02586212381720543, -0.004100577440112829, -0.13259638845920563, -0.04303287714719772, -0.04025058075785637, 0.015090655535459518, -0.012752200476825237, 0.004984951112419367, -0.02578262984752655, -0.04456976801156998, 0.016998516395688057, -0.02753150276839733, -0.028087962418794632, -0.05201572924852371, 0.003019124735146761, 0.008870231918990612, 0.005206872243434191, 0.0047034090384840965, 0.00020111627236474305, 0.017647720873355865, -0.010056020691990852, 0.031532712280750275, -0.023623036220669746, 0.0024096688721328974, 0.012500468641519547, 0.022364377975463867, -0.02451072260737419, -0.01687927544116974, -0.0454707033932209, -0.02276184968650341, -0.006362851243466139, 0.003164864145219326, 0.0048590851947665215, 0.005206872243434191, 0.010148763656616211, 0.03913766145706177, -0.01626981981098652, -0.004806088749319315, -0.001287641003727913, 0.00020763729116879404, 0.013202667236328125, 0.020694999024271965, -0.014931666664779186, 0.0019161422969773412, 0.04605365917086601, -0.06131655350327492, -0.00404095696285367, 0.010380621999502182, -0.023225566372275352, 0.000815229956060648, -0.048809461295604706, 0.011553161777555943, -0.016362562775611877, -0.0093538211658597, -0.023729028180241585, -0.02631259150803089, -0.005895822308957577, 0.022642606869339943, -0.02281484566628933, -0.035772405564785004, 0.017634471878409386, -0.025517649948596954, 0.011440545320510864, -0.03526894375681877, 0.022364377975463867, 0.016309566795825958, -0.014865421690046787, 0.032062675803899765, -0.010069269686937332, -0.03222166374325752, -0.010857587680220604, 0.015408632345497608, -0.021436944603919983, -0.023570040240883827, 0.0029843461234122515, 0.012593211606144905, 0.010990077629685402, 0.015872348099946976, -0.005445355083793402, -0.04025058075785637, 0.043483346700668335, -0.0338115468621254, 0.02512017823755741, 0.02816745638847351, -0.0168395284563303, 0.02330506034195423, 0.0003987132804468274, -0.005948818754404783, -0.02755800075829029, -0.023026829585433006, -0.01524964440613985, 0.02220539003610611, -0.013361656107008457, 0.06115756556391716, -0.0173297431319952, -0.0031483029015362263, -0.023874768987298012, 0.013560391962528229, -0.016402309760451317, 0.013593514449894428, 0.013540517538785934, 0.0030853699427098036, -0.03140022233128548, 8.917224477045238e-05, 0.034526996314525604, -0.048385489732027054, 0.024841947481036186, 0.017170755192637444, 0.024205993860960007, 0.007929549552500248, -0.011897637508809566, -0.014573942869901657, -0.00523999473080039, -0.017806708812713623, -0.02044326812028885, -0.0197543166577816, 0.007359841372817755, -0.02102622576057911, -0.046477630734443665, 0.009830786846578121, 0.004908768925815821, -0.018363168463110924, 0.019595328718423843, -0.00904246885329485, -0.027743488550186157, 0.0007746547344140708, -0.015819352120161057, 0.03121473640203476, 0.02877691201865673, 0.03911116346716881, -0.002919757040217519, -0.012805196456611156, -0.015050908550620079, -0.002827013609930873, 0.004998200107365847, -0.04030357673764229, -0.0005291334819048643, 0.002711084671318531, 0.021211711689829826, 0.0031267732847481966, 0.04724607244133949, 0.006402598228305578, 0.03352006897330284, 0.013447774574160576, -0.04035657271742821, -0.0081084119156003, 0.0637543797492981, 0.033838044852018356, -0.012387851253151894, -0.005660651717334986, -0.002851855708286166, 0.006730511784553528, -0.07308170199394226, -0.02092023193836212, 0.0501873604953289, -0.025504400953650475, -0.011500165797770023, -0.05755382403731346, -0.03190368786454201, -0.0013638229575008154, -0.0007332515087909997, 0.011281556449830532, 0.004435115959495306, -0.0012909532524645329, -0.010314377024769783, 0.004865709692239761, -0.016680540516972542, 0.02636558748781681, -0.02403375692665577, -0.01750198006629944, -0.03312259912490845, -0.021847665309906006, 0.06258846074342728, -0.015991590917110443, -0.039296649396419525, 0.01978081464767456, 0.007869929075241089, -0.03794524818658829, -0.024205993860960007, -0.024166246876120567, -0.019383344799280167, -0.01915811002254486, 0.030366797000169754, 0.03004882112145424, -0.03643485903739929, -0.024417979642748833, 0.022337879985570908, -0.028511932119727135, 0.017859704792499542, -0.02526591718196869, 0.004388744011521339, 0.006528464145958424, -0.004786215256899595, -0.014242717064917088, -0.00465372484177351, -0.0074393353424966335, -0.017753712832927704, -0.020880484953522682, 0.006942496635019779, 0.012189116328954697, -0.013196042738854885, -0.0468486025929451, 0.026246346533298492, -0.016442056745290756, 0.001772059011273086, 0.015355636365711689, 0.012831694446504116, 0.002027102978900075, -0.02591511979699135, 0.0009754605125635862, 0.049577903002500534, 0.013222540728747845, 0.005107504781335592, -0.014004234224557877, 0.00867149606347084, 0.017078012228012085, -0.012533591128885746, -0.033334583044052124, 0.03791875019669533, 0.01918460801243782, 0.013898242264986038, 0.009141837246716022, 0.05532798543572426, 0.032062675803899765, -0.030949754640460014, -0.035692911595106125, 0.011937384493649006, -0.029121387749910355, 0.013673008419573307, -0.007048488594591618, -0.007657944690436125, -0.00246597733348608, 0.0008504227153025568, -0.023583289235830307, -0.018204180523753166, 0.01473293174058199, 0.00012069046351825818, -0.013673008419573307, 0.0040144589729607105, -0.028034966439008713, 0.00022833890398032963, -0.018879881128668785, -0.013699506409466267, -0.009413442574441433, 0.01986031047999859, -0.00720085296779871, 0.0071412320248782635, 0.0180849377065897, 0.01978081464767456, 0.06836504489183426, -0.0013903210638090968, 0.0040840161964297295, -0.014361958019435406, -0.012043376453220844, -0.0065980213694274426, -0.012321606278419495, -0.011453794315457344, -0.01748873107135296, -0.03579890355467796, -0.02408675290644169, -0.03669983893632889, -0.013222540728747845, 0.012811820954084396, 0.008592002093791962, -0.03227465972304344, -0.011679028160870075, 0.020827488973736763, -0.004180071875452995, -0.012573338113725185, 0.02330506034195423, 0.023079825565218925, -0.014547444880008698, -0.11828742176294327, -0.03460649028420448, 0.017740463837981224, -0.00961217749863863, 0.020694999024271965, -0.025968115776777267, 0.0019972927402704954, 0.0009464782197028399, 0.005786517634987831, -0.0024543844629079103, 0.023079825565218925, -0.026537824422121048, -0.0043158745393157005, 0.03532193973660469, 0.014852172695100307, -0.04517922177910805, -0.007730814162641764, -0.022457120940089226, 0.001931047416292131, -0.01501116156578064, -0.0179524477571249, 0.009757917374372482, 0.027769986540079117, 0.02517317421734333, -0.048782963305711746, -0.0080421669408679, 0.016468554735183716, 0.028935901820659637, -0.00020184082677587867, 0.0020950043108314276, -0.039641123265028, -0.014441452920436859, 0.007253848947584629, 0.014308962039649487, -0.03068477474153042, 0.007936174049973488, -0.009691672399640083, -0.021476691588759422, -0.007002117112278938, -0.034474000334739685, 0.0040840161964297295, -0.02705453708767891, 0.05797779560089111, 0.021993404254317284, 0.019688071683049202, -0.029015395790338516, 0.011765146628022194, -0.021900661289691925, 0.018323421478271484, -0.024404730647802353, 0.015368885360658169, 0.01734299212694168, 0.005822952836751938, -0.013792249374091625, -0.00783680658787489, -0.006273420061916113, -0.00872449204325676, 0.00036579769221134484, 0.006962370127439499, 0.041125018149614334, 0.0010988421272486448, 0.030287303030490875, 0.012553464621305466, -0.007644695695489645, -0.06857702881097794, -0.013467648066580296, -0.007922925055027008, -0.0049220179207623005, -0.011241809464991093, -0.013235789723694324, -0.02095997892320156, 0.01804519072175026, 0.015448379330337048, 0.013990985229611397, -0.0021480005234479904, 0.009128588251769543, -0.010241507552564144, 0.0288299098610878, -0.0601506382226944, -0.00217946688644588, 0.045841675251722336, -0.03460649028420448, 0.04777603596448898, 0.018323421478271484, -0.0169057734310627, 0.036805830895900726, -0.013023805804550648, -0.0010980140650644898, -0.03974711894989014, 0.04319186881184578, 0.03881968557834625, -0.015859099105000496, 0.008466135710477829, -0.006591396871954203, -0.0005535614327527583, -0.012513717636466026, -0.013043679296970367, 0.05159175768494606, 0.03757427632808685, 0.003070464823395014, 0.018296923488378525, 0.042343929409980774, -0.01910511404275894, -0.010407119989395142, 0.03542793169617653, 0.0321686677634716, -0.007041864097118378, 0.010956955142319202, -0.0035871772561222315, -0.0034944340586662292, -0.011963882483541965, -0.00838001724332571, -0.023768777027726173, 0.020893733948469162, -0.010811216197907925, 0.017886202782392502, 0.056652892380952835, 0.046477630734443665, 0.036249369382858276, 0.003713043173775077, 0.008247527293860912, -0.0012719077058136463, 8.073633216554299e-05, 0.01467993576079607, -0.04488774389028549, -0.022377626970410347, -0.00785005558282137, 0.006843128707259893, -0.011096070520579815, -0.012023502960801125, 0.0069027491845190525, -0.015130402520298958, 0.025650139898061752, 0.005637465976178646, -0.02579587884247303, 0.026551073417067528, 0.03704431280493736, -0.02288109064102173, -0.02400725893676281, 0.03126773238182068, -0.00523999473080039, 0.0022506804671138525, 0.01915811002254486, 0.03222166374325752, 0.005813016090542078, -0.0022871154360473156, 0.02040351927280426, -0.035772405564785004, 0.018893130123615265, -0.007260473445057869, 0.004696784541010857, -0.003895217552781105, -0.007326718419790268, 0.0064522819593548775, -0.006495341192930937, -0.00896959938108921, -0.006018375977873802, -0.03609038144350052, -0.027796484529972076, 0.014348709024488926, -0.004885583184659481, 0.03163870424032211, 0.0023931076284497976, -0.015766356140375137, 0.004902144428342581, -0.005124066025018692, -0.020006049424409866, 0.0006049014627933502, -0.024325236678123474, 0.019992800429463387, -0.02525266818702221, -0.047087084501981735, 0.039853110909461975, -0.011374300345778465, 0.021463442593812943, 0.016919022426009178, -0.007664569187909365, 0.019356846809387207, -0.005591094493865967, 0.027981970459222794, 0.0007858336321078241, 0.008227652870118618, -0.030419792979955673, -0.01412347611039877, 0.03500396013259888, -0.030234307050704956, 0.0007974265608936548, 0.018919628113508224, 0.017184004187583923, 0.03722979873418808, -0.0093206986784935, 0.023119572550058365, -0.030817264690995216, 0.059143710881471634, 0.023623036220669746, -0.0036799206864088774, 0.004206569865345955, 0.01530264038592577, -0.006869626697152853, -0.04083354026079178, -0.031453218311071396, 0.03844870999455452, 0.0180186927318573, -0.03481847420334816, -0.030181311070919037, 0.023835022002458572, -0.04274139925837517, -0.013229165226221085, -0.004488111939281225, 0.006876251194626093, -0.007233975455164909, 0.01861489936709404, -0.015170149505138397, 0.02816745638847351, -0.03468598425388336, -0.024961190298199654, 0.004266190808266401, 0.0009671798325143754, -0.019052118062973022, -0.011142442002892494, -0.04303287714719772, -0.022457120940089226, -0.0038223478477448225, -0.016018088907003403, -0.0038322845939546824, 0.026802806183695793, 0.025053933262825012, 0.0191978570073843, -0.0015402007848024368, 0.008472760207951069, -0.002068506320938468, 0.0017339680343866348, -0.012242112308740616, 0.002530566416680813, 0.0049551404081285, -0.007194228004664183, -0.02151643857359886, 0.011082821525633335, 0.006955745629966259, -0.01811143569648266, 0.027690492570400238, 0.0009001066209748387, -0.004829274956136942, 0.007651320192962885, 0.018323421478271484, 0.0018614899599924684, 0.017528478056192398, 0.03844870999455452, -0.021423695608973503, -0.03487147018313408, -0.013951238244771957, 0.003202955238521099, 0.003405003109946847, -0.03484497219324112, 0.047590550035238266, 0.0169057734310627, 0.003353663021698594, 0.06253546476364136, 0.012878065928816795, 0.004514609929174185, -0.010884085670113564, 0.015355636365711689, 0.0036368612200021744, -0.01743573509156704, 0.01983381062746048, -0.012897939421236515, 0.012666081078350544, 0.0014739555772393942, 0.0001889023114927113, 0.0018051816150546074, -0.0044682384468615055, 0.00896297488361597, -0.00902921985834837, 0.04687510058283806, -0.014110226184129715, -0.002878353698179126, 0.00720747746527195, -0.004604041110724211, 0.015806103125214577, 0.0029528795275837183, -0.026630569249391556, -0.019701320677995682, -0.036885324865579605, -0.03405002877116203, 0.03717680275440216, -0.0003763555141631514, 0.003554054768756032, -0.00961880199611187, -0.0072935959324240685, 0.00835351925343275, 0.027266522869467735, 0.020165037363767624, -0.01972781866788864, 0.0005883401609025896, 0.01744898408651352, 0.006117743905633688, 0.01805843971669674, 0.026219848543405533, 0.0010789686348289251, -0.017846455797553062, -0.007419461850076914, 0.023848270997405052, 0.020787741988897324, 0.0003185979730915278, 0.024192744866013527, 0.00842638872563839, 0.01740923710167408, -0.008154783397912979, -0.027346016839146614, 0.001929391291923821, -0.01473293174058199, -0.012540215626358986, -0.03174469619989395, 0.03656734898686409, 0.005716960411518812, 0.013858495280146599, 0.018773889169096947, -0.0361698754131794, 0.014202970080077648, 0.005140627268701792, 0.008923227898776531, -0.02333155833184719, 0.012142743915319443, 0.005716960411518812, -0.019966302439570427, -0.04965739697217941, 0.01564711518585682, -0.011374300345778465, 0.011891013011336327, 0.035586919635534286, 0.022642606869339943, 0.021781420335173607, -0.008896729908883572, -0.03161220625042915, -0.03850170597434044, 0.002904851920902729, -0.02461671456694603, -0.007969297468662262, -0.02228488400578499, -0.018972624093294144, 0.04631863906979561, 0.01412347611039877, -0.028061464428901672, -0.024934692308306694, 0.0021115655545145273, 0.005935569293797016, -0.014878670684993267, 0.021754922345280647, -0.003501058556139469, -0.040568556636571884, 0.06105157360434532, 0.0064489697106182575, -0.031532712280750275, 0.025385158136487007, -0.00523005798459053, 0.021715175360441208, -0.0075916992500424385, -0.016322815790772438, -0.04144299402832985, 0.027319518849253654, -0.0012445816537365317, 0.041787467896938324, -0.01558087021112442, -0.00805541593581438, 0.036964818835258484, 0.014666685834527016, -0.020231282338500023, -0.007273722440004349, 0.01679978147149086, 0.0038389090914279222, 0.006631143856793642, 0.039270151406526566, -0.026153603568673134, 0.013374905101954937, -0.026869051158428192, 0.00955255702137947, -0.02101297676563263, 0.02040351927280426, -0.007127983029931784, 0.03468598425388336, -0.008009044453501701, -0.015461628325283527, -0.011619407683610916, -0.007134607527405024, -0.003547430271282792, -0.001770402886904776, -0.05137977376580238, 0.03052578680217266, -0.026113856583833694, 0.004504673182964325, 0.0028800098225474358, 0.02996932715177536, -0.002555408515036106, -0.02462996356189251, -0.03614337742328644, 0.030101817101240158, -0.00035089251468889415, -1.2608582437678706e-05, -0.0018962686881422997, 0.014348709024488926, 0.017713965848088264, -0.013937989249825478, -0.003457999089732766, -0.006183988880366087, 0.011308054439723492, -0.039773616939783096, -0.024788951501250267, 0.021211711689829826, 0.01609758287668228, -0.011321303434669971, -0.045311715453863144, 0.012546840123832226, -0.006757009774446487, 0.03828972205519676, 0.007624822203069925, -0.03248664364218712, -0.007061738055199385, 0.031983181834220886, 0.014335460029542446, 0.03428851440548897, 0.005037947092205286, -0.013414652086794376, -0.006362851243466139, -0.0008951381896622479, 0.018124684691429138, 0.005574533250182867, -0.01809818670153618, 0.026829304173588753, 0.01854865439236164, 0.04072754457592964, -0.012056625448167324, -0.007883178070187569, -0.0033453823998570442, -0.005952131003141403, -0.006376100238412619, 0.013196042738854885, 0.03057878278195858, -0.01560736820101738, -0.012440847232937813, 0.013401403091847897, -0.007604948244988918, 0.005051196087151766, 0.005150564014911652, -0.005326113663613796, 0.006548337638378143, -0.03916415944695473, -0.001828367356210947, -0.0066046458669006824, 0.013990985229611397, 0.03720330074429512, -0.019356846809387207, -0.031479716300964355, 0.02225838601589203, 0.0029561917763203382, 0.003984648734331131, 0.006810006219893694, -0.04602716118097305, -0.02648482844233513, 0.011877763085067272, 0.03895217552781105, 0.0011394174071028829, -0.0077440631575882435, 0.02390126697719097, 0.018124684691429138, 0.022059649229049683, 0.0032658881973475218, -0.029545357450842857, 0.047590550035238266, -0.00779705960303545, -0.04189345985651016, 0.007750687655061483, -0.02410000190138817, 0.01735624112188816, -0.011175564490258694, 0.00496176490560174, 0.005746770650148392, -0.019343597814440727, -0.005342674907296896, -0.019595328718423843, 0.024855196475982666, -0.006435720715671778, 0.0037428536452353, -0.00026829304988496006, -0.020628754049539566, 0.03593139350414276, -0.015156900510191917, 0.011924135498702526, 0.015156900510191917, -0.04086003825068474, -0.012798571959137917, 0.020085543394088745, 0.0191316120326519, 0.010857587680220604, 0.005468540824949741, 0.01728999614715576, 0.002911476418375969, -0.004567606374621391, -0.014255966059863567, 0.0014466294087469578, 0.0033768487628549337, -0.005869324319064617, -0.014534195885062218, -0.02631259150803089, 0.011321303434669971, -0.010817840695381165, -0.013196042738854885, -0.023159319534897804, -0.05114129185676575, 0.024391481652855873, 0.00836676824837923, 0.03349357098340988, -0.014004234224557877, 0.0026514639612287283, 0.005163813009858131, 0.018336670473217964, -0.012076498940587044, -0.012984057888388634, -0.02529241517186165, 0.017727214843034744, -0.023755526170134544, 0.003891905304044485, -0.0008744365768507123, -0.019025620073080063, -0.016614295542240143, -0.014096977189183235, -0.01471968274563551, -0.008764239028096199, 6.215662142494693e-05, -0.03775976225733757, -0.0033420701511204243, 0.005617592483758926, -0.013818747363984585, 0.03919065743684769, -0.024881694465875626, -0.045815177261829376, -0.0029876583721488714, -0.02333155833184719, 0.008817235939204693, 0.010340875014662743, 0.0028005156200379133, -0.020006049424409866, -0.030976252630352974, -0.010711847804486752, -0.026710063219070435, 0.003217860357835889, 0.016548050567507744, -0.01911836303770542, 0.014149974100291729, -0.011354426853358746, 0.0028336383402347565, -0.021238209679722786, -0.0005821296363137662, 0.013076801784336567, 0.015408632345497608, -0.017237000167369843, 0.02281484566628933, -0.013103299774229527, -0.021900661289691925, -0.0047067212872207165, -0.012613085098564625, 0.007558576762676239, -0.008154783397912979, -0.004431803710758686, 0.005528161767870188, 0.019303850829601288, -0.010725096799433231, 0.012513717636466026, -0.013229165226221085, -0.027134032920002937, -0.015912095084786415, -0.006273420061916113, -0.007061738055199385, 0.018919628113508224, 0.0057633318938314915, -0.012772073969244957, 0.008896729908883572, -0.009665174409747124, 0.013401403091847897, 0.006177364382892847, 0.013070177286863327, 0.021847665309906006, -0.03232765570282936, -0.024735955521464348, 0.001984043512493372, -0.003202955238521099, -0.0072207264602184296, 0.020615505054593086, -0.03137372434139252, -0.000995334004983306, 0.020906982943415642, -0.024179495871067047, 0.013990985229611397, -0.016362562775611877, 0.013414652086794376, -0.0068365042097866535, 0.05259868502616882, 0.006117743905633688, 0.024749204516410828, -0.028962399810552597, -0.005249931942671537, 0.017064763233065605, 0.017263498157262802, 0.006843128707259893, -0.021357450634241104, 0.029200881719589233, -0.02329181134700775, 0.008625124581158161, -0.018310172483325005, 0.029094889760017395, 0.021383948624134064, -0.04205245152115822, -0.014534195885062218, 0.039853110909461975, 0.007101485040038824, 0.02168867737054825, 0.015421881340444088, -0.011082821525633335, -0.020138539373874664, -0.04070104658603668, 0.007253848947584629, 0.015474877320230007, -0.011930759996175766, -0.02755800075829029, -0.0033404140267521143, 0.030340299010276794, 0.025000937283039093, 0.03497746214270592, 0.014640187844634056, 0.028087962418794632, -0.030287303030490875, 0.07191578298807144, -0.01728999614715576, -0.0049187056720256805, -0.015156900510191917, 0.01979406364262104, 0.004812713246792555, -0.013779000379145145, 0.011659154668450356, -0.007008741609752178, 0.010075894184410572, -0.035083454102277756, -0.0021529688965529203, 0.03253963962197304, -0.04865047335624695, -0.013262287713587284, -0.0019078616751357913, 0.01676003448665142, -0.04146949201822281, -0.009804288856685162, 0.02215239405632019, 0.003067152574658394, -0.017064763233065605, -0.000259805383393541, -0.007359841372817755, 0.04615965113043785, 0.04146949201822281, -0.018442662432789803, 0.04276789724826813, -0.015395383350551128, -0.011758522130548954, -0.011526663787662983, -0.007068362552672625, -0.012142743915319443, 0.011248433962464333, -0.03423551842570305, 0.0030969628132879734, -0.019025620073080063, 0.03648785501718521, -0.007929549552500248, 0.035666413605213165, -0.012692579068243504, 0.021701926365494728, -0.0024610089603811502, 0.03892567753791809, 0.029121387749910355, -0.007989170961081982, 0.010042771697044373, 0.017607972025871277, -0.005193623248487711, -0.020284278318285942, 0.020297527313232422, 0.00028630346059799194, 0.027690492570400238, -0.003944901283830404, 0.012016878463327885, 0.0016445369692519307, 0.007002117112278938, 0.025530898943543434, 0.03656734898686409, -0.04027707874774933, -0.013606763444840908, 0.012798571959137917, -0.015355636365711689, -0.02880341187119484, -0.027716990560293198, -0.0008736085146665573, 0.00010733791714301333, 0.005554659757763147, -0.009844035841524601, 0.006515215151011944, 0.039349645376205444, 0.010751594789326191, 0.0018035254906862974, -0.00021840212866663933, 0.03651435300707817, 0.02164893038570881, 0.0187076423317194, -0.020575758069753647, -0.031559210270643234, -0.008307147771120071, -0.017766961827874184, -0.020721497014164925, 0.029227379709482193, 0.0036865451838821173, 0.0003891905362252146, -0.013255663216114044, 0.017051512375473976, -0.0336790569126606, 0.009910280816257, -0.016057835891842842, -0.02578262984752655, 0.035215944051742554, 0.007942798547446728, 0.005488414317369461, -0.02755800075829029, 0.003921715542674065, 0.00030617701122537255, -0.025067182257771492, 0.027266522869467735, 0.014441452920436859, 0.028458936139941216, -0.0383957140147686, -0.020098792389035225, -0.017833206802606583, 0.011546537280082703, 0.010506488382816315, -0.021927159279584885, 0.01862814836204052, 0.005057820584625006]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" CTL learned
twists. In order to highlight this distinction, we have chosen a setting where it is extremely difficult to draw samples satisfying
the threshold using the base model p0(see SIS/IWAE LB line in Fig. 3).
However, twist-learning in the toxicity threshold setting presents challenges. For approximate positive sampling and a
thresholded target, all importance weights will be 0 if none of our Ksamples meet the threshold. As noted above, sampling
fromp0, or the SMC/twisted proposal for ψθ
t(s1:t)≈1at initialization, is extremely unlikely to draw samples meeting the
threshold (i.e., within the support of the target) in the setting of Sec. 7.1. As a result, initial iterations of twist learning
receive no learning signal until a thresholded positive sample is drawn from the base model.
To avoid this difficulty for baselines comparisons in Sec. 7.2, we instead focused on settings with ϕ(s1:T)given by
probabilities. Nevertheless, we note that there are no fundamental differences between the settings considered in Sec. 7.1
and Sec. 7.2. Thus, we may also evaluate single-sample DKL(σ∥q)andDKL(q∥σ)in the setting of Sec. 7.1, or plot logZσ
bounds as a function of Kin for the settings in Sec. 7.2.
G.4. Experiment-Specific Details
Details for SIS and SMC Comparison (Sec. 7.1) We generate 10 output tokens, and train twists using Sec. 4.1 with
approximate positive sampling as discussed in Sec. 4.1.2.
Note that using σ(s1:T)∝p0(s1:T)I[s1:T∈ C]where C:={s1:T|r(s1:T)≤η}directly runs into numerical issues for
calculating logZσwhen s1:T/∈ CandI[s1:T∈ C] = 0 . We instead use ϵ+I[s1:T∈ C]everywhere instead of I[s1:T∈ C],
where ϵ= 10−16. In Fig. 3, this yields a SIS/IWAE logZσLB≈ −36when no samples are drawn that fall in the set C.
We use an MLP head to parameterize the twist, as in App. G.2.2, with 768 hidden units per layer, matching the TinyStories
model’s embedding dimension. We use a batch size (number of SMC particles/samples) of 1000, with a learning rate of
0.0001, and train using CTL for a total of 5000 gradient updates. We did not tune hyperparameters because we found this
setting to work well, and we are not comparing across different learning methods.
For each point on each line on Fig. 3, we run SIS or SMC 20 times, each with a different randomly selected true posterior
sample for the upper bounds. The line shows the average value across these 20 runs, while the shaded area shows 95%
confidence intervals. See also App. G.1 for details common across experiments.
Details for Toxicity (Sec. 7.2.1) We generate 20 output tokens. We parameterize the twist with a separate network as in
App. G.2.3. We use a batch size (number of SMC particles/samples) of 100, and train for a total of 2048 gradient updates.
For each learning method, we used a coarse grid search over learning rates between 0.000001 and 0.001, using the best one
found, which was usually 0.00003 or 0.0001. We run each learning method over 5 different random seeds, reporting the
average KL divergence and 95% confidence intervals over these 5 seeds.
For each KL divergence evaluation, we first get sandwich bounds on logZσas laid out in Sec. 5, using the learned twists for
the twisted proposal with K= 500 samples. We find SIS/IWAE and SMC bounds to be similarly tight, so use SIS/IWAE
for simplicity. We do this 4 times, providing 4 upper bound estimates and 4 lower bound estimates, and take the average
midpoint as the logZσestimate for each experiment. We then take the median (across all learning methods and seeds) of
these estimates, and use that as our estimate of logZσ. This is then used as a common value for the KL divergence across
all methods and seeds, which controls for possible noise in log","[0.003257456934079528, 0.0071782758459448814, 0.02784724161028862, -0.005830603651702404, -0.029914138838648796, -0.005163750145584345, 0.0384889654815197, 0.0037497414741665125, -0.0429299995303154, 0.03658965602517128, 0.005771249998360872, -0.023280518129467964, -0.03890793025493622, 0.032344140112400055, 0.05672793090343475, -0.02728862129151821, 0.032763104885816574, 0.01709379255771637, -0.05982827767729759, 0.013413879089057446, -0.02340620756149292, -0.01071853470057249, -0.0016741163562983274, 0.04630965739488602, 0.005683965515345335, -0.04290207102894783, 0.06250965595245361, -0.02100413851439953, 0.02946724183857441, 0.013490689918398857, 0.029104137793183327, -0.013532586395740509, -0.04698000103235245, -0.06496758759021759, -0.028992414474487305, 0.05161655321717262, 0.012918103486299515, 0.05167241394519806, -0.020138276740908623, 0.013302155770361423, 0.0024212715215981007, -0.03231620788574219, -0.04575103521347046, 0.024411724880337715, -0.0017421982483938336, 0.004084913991391659, 0.02791706845164299, -0.0011102586286142468, -0.0014218642609193921, 0.00798129290342331, -0.04575103521347046, 0.054549310356378555, 0.006336853373795748, -0.025528965517878532, -0.010397328063845634, 0.0067977155558764935, -0.01032750029116869, 0.011004827916622162, -0.0012891917722299695, -0.05223103612661362, 0.04792965576052666, -0.03876827657222748, 0.017456896603107452, -0.016381552442908287, 0.013693190179765224, -0.027009310200810432, -0.023741379380226135, 0.011717068962752819, -0.0056350864470005035, 0.00881224125623703, 0.025640690699219704, 0.011074655689299107, 0.00477620679885149, 0.003980172332376242, -0.03298655152320862, 0.023950861766934395, 0.010369396768510342, 0.016912242397665977, 0.01485931035131216, -0.023531896993517876, -0.0014454310294240713, -0.007150345016270876, 0.006706939544528723, -0.013190431520342827, -0.018071379512548447, -0.04008103534579277, -0.01952379383146763, -0.013162500225007534, -0.029411379247903824, -0.025780344381928444, -0.05312482640147209, 0.0005612392560578883, -0.016800517216324806, -0.0017998060211539268, 0.0303889662027359, -0.00939181074500084, 0.039773792028427124, 0.010215776041150093, -0.021157758310437202, 0.009775862097740173, 0.03647793084383011, 0.011144482530653477, 0.010914051905274391, -0.0025591810699552298, 0.03321000188589096, 0.020822586491703987, 0.012429310940206051, 0.01161232776939869, -0.03304241597652435, -0.0037776725366711617, -0.0026935990899801254, -0.02016620710492134, -0.05910206958651543, 0.05354379490017891, -0.0008086907328106463, -0.07066551595926285, -0.07072138041257858, -0.009608276188373566, 0.013490689918398857, 0.026269137859344482, -0.05066689848899841, -0.011891637928783894, 0.022652069106698036, 0.04522034525871277, 0.04158931225538254, -0.01843448355793953, 0.01103275828063488, -0.05798482894897461, -0.0029938577208667994, 0.01596258580684662, -0.006081982981413603, -0.014300690032541752, 0.013958534225821495, 0.005764267407357693, 0.030696207657456398, 0.01381887961179018, -0.007035129237920046, 0.05072275921702385, 0.005875991657376289, -0.0049507757648825645, -0.01575310342013836, 0.0036135776899755, -0.001990086166188121, 0.003154461272060871, 0.024383792653679848, -0.01646534539759159, -0.045276205986738205, 0.054828621447086334, -0.006008663680404425, 0.05142103508114815, -0.0347462072968483, -0.003693879349157214, -0.012052241712808609, 0.0020092888735234737, -0.016618965193629265, -0.021758276969194412, 0.0016872091218829155, 0.06329172849655151, 0.013686207123100758, -0.03846103325486183, 0.012876207008957863, 0.035444483160972595, 0.014342586509883404, -0.0047482759691774845, -0.013735086657106876, -0.007077025715261698, 0.008086035028100014, 0.0037392673548310995, -0.04804138094186783, -0.0651351734995842, 0.025668621063232422, -0.0436282753944397, 0.025249656289815903, -0.04522034525871277, 0.02030586265027523, -0.034075863659381866, -0.009021724574267864, -0.06345931440591812, -0.007373793050646782, 0.025151897221803665, 0.010362413711845875, 0.05318069085478783, -0.030165517702698708, 0.02245655283331871, -0.01924448274075985, 0.0018207543762400746, 0.008379310369491577, 0.023922931402921677, 0.013539569452404976, -0.0014777262695133686, 0.0020826077088713646, 0.020222069695591927, 0.07815103232860565, -0.007471551652997732, -0.02079465612769127, -0.002707564737647772, 0.04181275889277458, 0.06016344949603081, 0.006207672413438559, 0.026059655472636223, -0.011228276416659355, 0.037595171481370926, -0.009524483233690262, -0.06440896540880203, -0.007276034448295832, 0.03837724030017853, -0.013867759145796299, -0.011682155542075634, -0.06787241250276566, 0.02449551783502102, 0.016926206648349762, 0.009775862097740173, 0.05379517376422882, -0.0027389870956540108, -0.022568276152014732, 0.05097413808107376, -0.072620689868927, -0.005746810231357813, 0.021492931991815567, 0.08194965869188309, -9.083041368285194e-05, 0.02495637908577919, 0.030109655112028122, 0.03591931238770485, -0.03360103443264961, 0.005547801963984966, 0.012310603633522987, 0.0058794827200472355, 0.04748275876045227, -0.0299979317933321, 0.03393620625138283, 0.007310948334634304, -0.006724396720528603, -0.050108276307582855, -0.008016207255423069, -0.01857413724064827, -0.016577068716287613, -0.0043991380371153355, -0.010941983200609684, -0.06569379568099976, 0.03603103384375572, 0.0024649137631058693, 0.009796810336411, 0.004933319054543972, -0.006731379311531782, -0.003425043076276779, -0.019328275695443153, 0.0024422197602689266, -0.003288879292085767, -0.004144267179071903, -0.03510931134223938, 0.0011120042763650417, -0.009901551529765129, -0.04628172516822815, -0.05720276013016701, -0.012324568815529346, 0.01189862098544836, -0.00042114764801226556, -0.04052793234586716, 0.018462413921952248, 0.006287974305450916, -0.009266120381653309, -0.024802759289741516, -0.018532240763306618, -0.05943724140524864, 0.00904267281293869, 0.006099439691752195, 0.016577068716287613, 0.010900086723268032, -0.036254484206438065, -0.0012106357607990503, 0.0008645527996122837, 0.01681448332965374, -0.004406120628118515, -0.007269051857292652, -0.06200689822435379, 0.008204741403460503, 0.053487930446863174, -0.03538862243294716, 0.056448619812726974, -0.017987586557865143, -0.04818103462457657, 0.036813102662563324, -0.031031379476189613, -0.016842413693666458, 0.03943862020969391, -0.0303889662027359, 0.028140516951680183, 0.011689137667417526, -0.054158277809619904, 0.004364224150776863, 0.0010221012635156512, 0.0016042888164520264, -0.010578879155218601, 0.009433707222342491, 0.016479309648275375, -0.0022728878539055586, 0.019090862944722176, -0.020878449082374573, -0.04605827480554581, 0.025012241676449776, 0.01829482801258564, -0.02238672412931919, -0.011018793098628521, 0.04206413775682449, 0.004985689651221037, 0.04932620748877525, -0.002473642351105809, -0.0377906896173954, 0.023392241448163986, -0.02608758583664894, -0.04086310416460037, -0.0029379958286881447, 0.03541655093431473, 0.0013747306074947119, -0.015417931601405144, 0.047985516488552094, 0.006319396663457155, 0.022889483720064163, -0.03441103547811508, -0.0056769829243421555, -0.01924448274075985, 0.011346982792019844, -0.013888707384467125, -0.01783396489918232, -0.017861897125840187, -0.02932758629322052, -0.018322758376598358, 0.01607431098818779, -0.03686896711587906, 0.018811551854014397, -0.008169827982783318, 0.04438241571187973, -0.017526723444461823, -0.031143104657530785, -0.046868275851011276, -0.02026396617293358, 0.044717587530612946, -0.014112154953181744, 0.04670068994164467, -0.10099862515926361, 0.010557930916547775, 0.008148879744112492, -0.03818172588944435, 0.0028419827576726675, 0.029160000383853912, 6.349946488626301e-05, 0.004137284588068724, 0.07843034714460373, 0.027972931042313576, 0.002367155160754919, -0.015920689329504967, -0.015390000306069851, 0.022749828174710274, 0.025598794221878052, -0.014251810498535633, -0.038014139980077744, -0.022261034697294235, -0.0059004309587180614, -0.01628379337489605, -0.05234275758266449, -0.0103833619505167, 0.02210741490125656, 0.015026896260678768, 0.0525941401720047, 0.04424275830388069, -0.03212068974971771, -0.012010345235466957, -0.011919569224119186, 0.0030706680845469236, 0.008079051971435547, 0.019062930718064308, 0.030361033976078033, -0.008937930688261986, -0.03809793293476105, -0.006616163998842239, 0.015711206942796707, 0.028294138610363007, 0.04792965576052666, 0.02432793192565441, 0.021227587014436722, 0.0203756894916296, 0.0027931034564971924, -0.005334827583283186, 0.007373793050646782, 0.007960344664752483, -0.007611207198351622, 0.004765732679516077, -0.03862862288951874, 0.026981379836797714, -0.006511422339826822, -0.010348448529839516, -0.025989828631281853, 0.007415689527988434, -0.009545431472361088, -0.006706939544528723, -0.021213620901107788, 0.050638966262340546, 0.03446689620614052, 0.07306759059429169, -0.04290207102894783, -0.018099309876561165, -0.08982621133327484, -0.0006507058278657496, -0.0038824137300252914, 0.013448793441057205, 0.019733276218175888, -0.005903922487050295, 0.04913068935275078, 0.028322068974375725, 0.026031725108623505, -0.01096293143928051, 0.027903104200959206, -0.03158999979496002, 0.010145948268473148, -0.0444941371679306, 0.025682587176561356, 0.04024862125515938, 0.030025862157344818, 0.07368206977844238, -0.03809793293476105, -0.04656103625893593, -0.016828447580337524, -0.013672241941094398, -0.014161034487187862, 0.004929827526211739, 0.02777741476893425, -0.022330861538648605, 0.05301310494542122, -0.034774139523506165, -0.008323448710143566, 0.0754137933254242, 0.03066827543079853, -0.01818310283124447, -0.05234275758266449, -0.03119896538555622, 0.028391897678375244, -0.005334827583283186, 0.002028491348028183, -0.04421482980251312, -0.004968232940882444, -0.009440689347684383, 0.016521207988262177, -0.017917759716510773, 0.013141551986336708, 0.04630965739488602, -0.010746465995907784, -0.03485793247818947, 0.0142587935552001, -0.022037586197257042, 0.015306207351386547, -0.02379724197089672, 0.061280690133571625, -0.0033499784767627716, -0.00029523976263590157, -0.02453741431236267, 0.04186861962080002, -0.05150482803583145, 0.0444941371679306, -0.058040689677000046, 0.008183793164789677, 0.038516897708177567, -0.02368551678955555, 0.03485793247818947, -0.018657932057976723, 0.044047240167856216, 0.014733620919287205, -0.021087931469082832, 0.037204138934612274, 0.01383284479379654, 0.006699956953525543, -0.07848620414733887, -0.02234482765197754, -0.04105862230062485, -0.007255086209625006, 0.013441810384392738, 0.06787241250276566, -0.02654844895005226, 0.0510299988090992, 0.004098879173398018, 0.00350709049962461, 0.001337198307737708, 0.015920689329504967, 0.0244256891310215, 0.031813450157642365, 0.06625241786241531, 0.019398104399442673, -0.016646897420287132, -0.013176465407013893, -0.008923965506255627, -0.011221293359994888, -0.037734828889369965, 0.03469034656882286, -0.016577068716287613, 0.059939999133348465, -0.04488517343997955, -0.023392241448163986, -0.0021611638367176056, -0.03955034539103508, -0.03793034702539444, 0.03435517102479935, -0.001043049618601799, 0.029914138838648796, 0.042985863983631134, 0.01695413887500763, 0.015166551806032658, 0.019160689786076546, -0.0021751292515546083, 0.005083448253571987, 0.04038827493786812, 0.0023933404590934515, -0.008833189494907856, 0.0004403502098284662, 0.02273586206138134, -0.001573739224113524, 0.009405775927007198, 0.019803103059530258, -0.008882069028913975, -0.005987715441733599, 0.03435517102479935, 0.0009060129523277283, -0.029830345883965492, -0.038014139980077744, -0.016479309648275375, 0.02065500058233738, -0.02245655283331871, 0.015138620510697365, -0.08748000115156174, -0.05854344740509987, -0.042566895484924316, 0.014649827964603901, -0.016018448397517204, 0.015878792852163315, 0.0188953448086977, -0.0356120690703392, 0.01082327589392662, -0.024872586131095886, -0.026883620768785477, -0.005355775821954012, 0.001402661669999361, 0.0028489655815064907, 0.0047273277305066586, 0.005907414015382528, -0.004084913991391659, 0.03494172543287277, -0.011346982792019844, 0.02918793074786663, -0.0355282761156559, -0.010062155313789845, 0.014251810498535633, 0.00807206891477108, -0.03966207057237625, -0.007097974419593811, -0.031171035021543503, -0.017331207171082497, 0.0035716809798032045, -0.018169138580560684, 0.008470086380839348, -0.02654844895005226, 0.01029258593916893, 0.025040172040462494, -0.026338966563344002, 0.0006341217667795718, -0.00350709049962461, -0.01868586242198944, -0.017778104171156883, 0.04181275889277458, 0.0028018318116664886, 0.024313965812325478, 0.06334758549928665, -0.05178413912653923, -0.0020162714645266533, 0.026171378791332245, -0.056308966130018234, -9.044854959938675e-05, -0.04276241362094879, -0.0006227747653611004, -0.04396344721317291, 0.013770000077784061, -0.008086035028100014, -0.043767932802438736, -0.02132534421980381, 0.013420862145721912, -0.03200896456837654, -0.03636620566248894, 0.03538862243294716, 0.004887931048870087, 0.014202930964529514, -0.0033883836586028337, 0.0043781897984445095, 0.015222414396703243, -0.002997349249199033, 0.011360947974026203, 0.005195172503590584, -0.033684827387332916, -0.0031300215050578117, 0.011738017201423645, -0.03388034552335739, -0.02907620742917061, -0.027763448655605316, 0.006326379254460335, 0.014607931487262249, 0.023769309744238853, -0.044605862349271774, -0.04038827493786812, 0.06094551831483841, -0.03393620625138283, 0.01836465485394001, 0.049689311534166336, -0.0014908190350979567, 0.014000431634485722, 0.002058168174698949, -0.02456534467637539, -0.005104396492242813, 0.012946034781634808, -0.028601380065083504, 0.01413310319185257, -0.004273448139429092, 0.0466727577149868, -0.014042328111827374, -0.017889827489852905, -0.04212000221014023, -0.005642069038003683, -0.01942603476345539, 0.016116207465529442, 0.022163275629281998, 0.00297814654186368, -0.05854344740509987, -0.004853017162531614, 0.027889138087630272, -0.040416207164525986, 0.02132534421980381, -0.009314999915659428, 0.011542499996721745, 0.012080173008143902, -0.04770620912313461, -0.008141896687448025, -0.005041551776230335, -0.010166896507143974, 0.004734310321509838, 0.018169138580560684, 0.0051393103785812855, -0.007611207198351622, -0.04787379503250122, 0.030780000612139702, 0.010006293654441833, -0.010557930916547775, 0.008232672698795795, -0.01117241382598877, -0.021101897582411766, -0.013239310123026371, -0.015166551806032658, 0.026799827814102173, -0.012436293065547943, 0.041365861892700195, -0.0024701508227735758, 0.006832629442214966, -0.006284482777118683, -0.01942603476345539, -0.00958732794970274, -0.013448793441057205, 0.012513103894889355, -0.019831035286188126, 0.0015056573320180178, 0.012596896849572659, 0.01843448355793953, 0.013574482873082161, 0.024900518357753754, 0.010020258836448193, -0.0011547737522050738, -0.006525387987494469, 0.05608551949262619, 0.033293794840574265, 0.006452069152146578, 0.012527069076895714, 0.01071853470057249, -0.014161034487187862, -0.027819311246275902, -0.03192517161369324, 0.042594827711582184, -0.004699396435171366, 0.005401163827627897, -0.03860069066286087, -0.04119827598333359, -0.004364224150776863, -0.018490344285964966, 0.03767896443605423, 0.020403621718287468, -0.0060051726177334785, -0.015739137306809425, -0.017428966239094734, -0.007848620414733887, 0.02534741349518299, -0.029523104429244995, -0.0303889662027359, -0.011109569109976292, -0.026143448427319527, 0.05030379444360733, 0.004175689537078142, -0.04994069039821625, 0.02840586192905903, 0.0116681894287467, -0.03226034343242645, -0.02943931147456169, -0.02678586170077324, -0.013770000077784061, 0.001364256488159299, 0.00860275886952877, 0.0540744848549366, -0.018993103876709938, -0.010711551643908024, 0.028964482247829437, -0.05195172503590584, 0.013246293179690838, -0.028908621519804, -0.007932414300739765, 0.012080173008143902, -0.009308017790317535, -0.012890172190964222, -0.0019918319303542376, -0.026101551949977875, -0.021297413855791092, -0.05552689731121063, 0.0035193103831261396, 0.0016784806502982974, 0.0011818319326266646, -0.028601380065083504, 0.01337896566838026, 0.017680345103144646, -0.019970688968896866, -0.005156767088919878, 0.018657932057976723, -0.006672026123851538, -0.029634827747941017, -0.026674138382077217, 0.045276205986738205, 0.0006498330039903522, 0.018336724489927292, -0.007715948391705751, 0.014272758737206459, 0.020990172401070595, -0.016688793897628784, -0.02766568958759308, 0.03941069170832634, 0.046197932213544846, 0.01931431144475937, 0.0010840733302757144, 0.03309827670454979, 0.0024893535301089287, -0.02654844895005226, -0.03362896665930748, 0.01327422447502613, -0.01737310364842415, 0.028741035610437393, -0.013951552100479603, -0.016758620738983154, 0.0030287716072052717, -0.01235250011086464, 0.010683620348572731, 0.0032941163517534733, -0.0021751292515546083, 0.03807000070810318, -0.004908879287540913, 0.01649327576160431, -0.00551637914031744, 0.025361379608511925, -0.02766568958759308, -0.003505344968289137, -0.01938413828611374, 0.02118569053709507, -0.03580758720636368, -0.02051534503698349, 0.0008501508855260909, 0.04184069111943245, 0.06552620977163315, -0.005251034628599882, -0.012331551872193813, -0.02396482788026333, -0.00039779904182069004, -0.000516287749633193, -0.004468965344130993, -0.013281206600368023, -0.0045702154748141766, -0.040276553481817245, -0.016102241352200508, -0.043656207621097565, -0.01720551773905754, 0.011333017610013485, -0.012792414054274559, -0.01635362021625042, -0.02537534572184086, 0.04139379411935806, 0.008484051562845707, -0.012603879906237125, 0.0048984051682055, 0.01699603535234928, -0.022330861538648605, -0.14356552064418793, -0.0255568977445364, 6.682718230877072e-05, -0.01008310355246067, 0.024984311312437057, -0.01769431121647358, -0.012191896326839924, -0.0010413038544356823, -0.029690690338611603, -0.011891637928783894, -0.007010689936578274, -0.033573102205991745, -0.02093430981040001, 0.022191207855939865, 0.0270372424274683, -0.03217655047774315, -0.002409051638096571, -0.020222069695591927, 0.0020302371121942997, 0.009133448824286461, -0.018252931535243988, 0.020948275923728943, 0.028685173019766808, 0.06133655086159706, -0.02026396617293358, -0.03547241538763046, 0.006329870782792568, 0.029215862974524498, 0.016856379806995392, 0.016409482806921005, -0.017247414216399193, -0.010641723871231079, 0.02858741395175457, 0.020738793537020683, -0.013735086657106876, -0.007792758755385876, -0.009810775518417358, 0.017652414739131927, -0.004877456929534674, -0.022721895948052406, 0.020403621718287468, -0.018993103876709938, 0.038796208798885345, -0.005345301702618599, 0.023462068289518356, -0.02365758642554283, -0.017191551625728607, -0.01263879332691431, 0.024090517312288284, -0.050946205854415894, 0.014817413873970509, 0.025389309972524643, 0.024649137631058693, -0.026325000450015068, -0.016241896897554398, 0.031534139066934586, 0.014181982725858688, -0.006773275788873434, -0.027553966268897057, 0.034103792160749435, -0.019719310104846954, 0.012289655394852161, 0.031115172430872917, -0.007834655232727528, -0.05611344799399376, -0.006179741583764553, -0.05742620676755905, -0.017861897125840187, -0.00018940733571071178, 0.0025906034279614687, -0.0015807220479473472, 0.0025225216522812843, -0.0028629309963434935, 0.007569310255348682, 0.019691379740834236, 0.005072974134236574, 0.005669999867677689, 0.025850173085927963, -0.03614275902509689, 0.016479309648275375, 0.009761896915733814, -0.03175758570432663, 0.04181275889277458, 0.026352930814027786, -0.005100905429571867, 0.02682775817811489, 5.8971578255295753e-05, 0.005837586242705584, -0.0218560341745615, 0.04748275876045227, 0.04731517285108566, -0.017820000648498535, 0.02069689705967903, -0.009370862506330013, 0.0004582435358315706, -0.01625586301088333, 0.006616163998842239, 0.027162931859493256, 0.022498449310660362, 0.023252585902810097, -0.009713017381727695, 0.015348103828728199, 0.01161232776939869, -0.004193146713078022, 0.01875568926334381, 0.05452137812972069, -0.0038370259571820498, 0.04480138048529625, 0.026869654655456543, -0.011514568701386452, -0.0016261099372059107, -0.014279741793870926, -0.038125861436128616, -0.005083448253571987, -0.03052862174808979, -0.0009932974353432655, 0.031422413885593414, 0.0099923275411129, 0.03443896770477295, 0.0037741810083389282, 0.02192586287856102, 0.0059004309587180614, -0.03212068974971771, 0.021409139037132263, -0.0159346554428339, -0.0025015734136104584, 0.006424137856811285, -0.022051552310585976, -0.017051896080374718, -0.0014759806217625737, 0.01559948269277811, -0.0112771550193429, 0.037874482572078705, -0.007764827460050583, -0.020361725240945816, 0.029215862974524498, 0.04161724075675011, -0.006448577623814344, -0.03175758570432663, 0.028084656223654747, -0.00201801722869277, 0.004098879173398018, 0.01572517305612564, 0.04192448407411575, -0.004043017514050007, -0.006413663737475872, 0.019007069990038872, -0.030891723930835724, 0.0016025431687012315, 0.0017666378989815712, 0.005896939896047115, -0.020948275923728943, 0.0012088901130482554, 0.010914051905274391, -0.0049158623442053795, 0.007743879221379757, 0.0002611988165881485, -0.03488586097955704, -0.015529654920101166, 0.0016007974045351148, 0.0004019450570922345, 0.021143794059753418, -0.014293706975877285, 0.00900775846093893, -0.005582715384662151, -0.009950431063771248, -0.033545173704624176, -0.017666378989815712, -0.01392362080514431, 0.02580827660858631, -0.00012121632607886568, -0.046225860714912415, 0.01963551715016365, 0.005086939781904221, 0.0017273599514737725, 0.03295861929655075, -0.01351862121373415, -0.0033185561187565327, -0.0033814008347690105, 0.012129051610827446, -0.0018940733280032873, 0.03376862034201622, -0.037874482572078705, 0.005289439577609301, 0.0629565492272377, -0.028741035610437393, 0.0009636207250878215, 0.02453741431236267, -0.012694654986262321, 0.01076741423457861, -0.01337896566838026, 0.023559827357530594, -0.016200000420212746, 0.026995345950126648, 0.02615741454064846, -0.014370517805218697, -0.011088620871305466, 0.00583409471437335, -0.008239654824137688, -0.019803103059530258, 0.001518749981187284, 0.024439655244350433, 0.03728793188929558, -0.013127586804330349, -0.02502620778977871, 0.011339999735355377, -0.04522034525871277, 0.0015309698646888137, -0.007478534709662199, 0.006961810402572155, 0.005830603651702404, 0.014649827964603901, -0.014984999783337116, 0.03658965602517128, -0.03052862174808979, -0.02329448238015175, 0.02643672376871109, -0.00014685613859910518, -0.04396344721317291, -0.03896379470825195, -0.03642207011580467, -0.026464655995368958, 0.030025862157344818, 0.0023654093965888023, -0.018169138580560684, -0.003864957019686699, 0.04477344825863838, 0.0066301291808485985, 0.008009224198758602, 0.011835776269435883, 0.014440344646573067, 0.00553383631631732, -0.016758620738983154, -0.01411913800984621, -0.014300690032541752, -0.008470086380839348, 0.0007803232874721289, -0.005683965515345335, 0.023350344970822334, -0.008658620528876781, 0.013148535043001175, -0.023839138448238373, -0.010795344598591328, -0.018057413399219513, -0.0030200432520359755, 0.006012155208736658, 0.029551034793257713, 0.017051896080374718, -0.04200827702879906, -0.0459744818508625, -0.03494172543287277, 0.01318344846367836, 0.03304241597652435, 0.000875899801030755, 8.493871428072453e-05, -0.004912370815873146, 0.008009224198758602, 0.04424275830388069, 0.038796208798885345, 0.010041207075119019, -0.008944913744926453, 0.016912242397665977, -0.025989828631281853, -0.011891637928783894, 0.01103275828063488, -0.002957198303192854, 0.029104137793183327, 0.015082758851349354, -0.046225860714912415, -0.0071782758459448814, -0.010851207189261913, -0.00671392260119319, -0.0009671120787970722, 0.05097413808107376, -0.01995672471821308, -0.0006205926765687764, 0.012170948088169098, -0.02220517210662365, 0.005806163884699345, 0.01041827630251646, -0.01945396512746811, -0.022358793765306473, -0.02735844813287258, -0.04616999998688698, 0.04709172621369362, -0.0089030172675848, 0.013490689918398857, -0.018490344285964966, -0.014621896669268608, -0.008197758346796036, 0.03435517102479935, 0.03494172543287277, -0.013881724327802658, -0.026311034336686134, -0.008826207369565964, 0.014454310759902, 0.018937241286039352, 0.038796208798885345, 0.024048620834946632, -0.01318344846367836, -0.007262069266289473, 0.028852758929133415, -0.00350359920412302, 0.011682155542075634, 0.002276379382237792, -0.005460517480969429, 0.012170948088169098, 0.008379310369491577, -0.01723344810307026, -0.007097974419593811, -0.02580827660858631, 0.0008501508855260909, 0.0018801077967509627, 0.028140516951680183, 0.008644655346870422, 0.0009932974353432655, 0.017820000648498535, 0.006462543271481991, 0.023881034925580025, -0.014105172827839851, -0.03133862093091011, -0.03212068974971771, 0.021423103287816048, -0.008518965914845467, -0.026101551949977875, 0.012596896849572659, -0.0013049030676484108, -0.02315482869744301, -0.003805603599175811, 0.03388034552335739, -0.0003255711344536394, 0.016688793897628784, -0.019481897354125977, -0.02622724138200283, -0.007792758755385876, 0.019007069990038872, -0.019649483263492584, -0.006329870782792568, -0.0199846550822258, -0.008456121198832989, 0.027805345132946968, 0.010390345007181168, -0.031673792749643326, -0.04063965380191803, 0.01416801754385233, -0.00035502962418831885, -0.008749396540224552, 0.007708965800702572, 0.0114726722240448, -0.014342586509883404, 0.07982689887285233, 0.008295517414808273, -0.009733965620398521, 0.015222414396703243, 0.0013441810151562095, 0.006459051743149757, -0.020543275400996208, 0.010655689984560013, -0.0421479307115078, 0.025584828108549118, -0.014175000600516796, 0.03158999979496002, -0.0159346554428339, 0.00860275886952877, 0.03589138016104698, 0.022358793765306473, -0.023713449016213417, 0.016269827261567116, 0.010725517757236958, 0.004381680861115456, 0.0076950001530349255, 0.018169138580560684, -0.03834931179881096, -0.0005446551949717104, 0.00019966326362919062, 0.00020544586004689336, -0.023978793993592262, 0.03119896538555622, 0.0007310075452551246, 0.0067558190785348415, 0.0012411853531375527, -0.012184914201498032, -0.015990518033504486, -0.017596552148461342, 0.024691034108400345, -0.023922931402921677, -0.0400531031191349, 0.0025487069506198168, 0.001958663808181882, 0.039773792028427124, 0.003634525928646326, -0.004730818793177605, 0.001459396560676396, 0.002649956848472357, -0.01337896566838026, 0.02618534490466118, -0.00469590537250042, -0.00265693967230618, -0.009629224427044392, 0.03066827543079853, -0.007890516892075539, -0.012317586690187454, 0.014649827964603901, -0.014314655214548111, 0.00782767217606306, -0.04306965693831444, -0.006050560623407364, 0.01945396512746811, 0.014649827964603901, -0.033573102205991745, -0.021018102765083313, 0.0006581250345334411, -0.0037532327696681023, 0.03527689725160599, 0.02520775981247425, -0.01309267245233059, 0.010111034847795963, 0.040974829345941544, 0.004050000105053186, 0.03158999979496002, -0.024998275563120842, 0.0007100592483766377, 0.010941983200609684, 0.0001837338350014761, 0.0004573706828523427, -0.003514073323458433, 0.0039871553890407085, 0.0406675860285759, -0.0020634052343666553, 0.012094138190150261, -0.019831035286188126, 0.013085689395666122, 0.0073388791643083096, -0.015376034192740917, 0.008728448301553726, 0.019090862944722176, 0.034047931432724, -0.019146723672747612, -0.010760431177914143, 0.01681448332965374, -0.028419828042387962, 0.006703448481857777, 0.0159346554428339, -0.016898276284337044, -0.0004442780336830765, -0.048739656805992126, 0.013211379759013653, -0.016339655965566635, 0.0010893103899434209, 0.006085474044084549, -0.0015074029797688127, -0.03066827543079853, 0.03725999966263771, -0.012603879906237125, -0.011207327246665955, 0.012736551463603973, -0.051476895809173584, -0.03418758511543274, 0.01589275896549225, 0.04711965471506119, 0.005132327787578106, -0.015557586215436459, 0.013141551986336708, 0.009280086494982243, 0.008477069437503815, 0.0031020904425531626, -0.0474548265337944, 0.021213620901107788, -0.02513793110847473, -0.004500388167798519, -0.006514913868159056, -0.01170310378074646, 0.005558276083320379, 0.006525387987494469, 0.03318206965923309, 0.0008056357619352639, -0.03689689561724663, -0.008414223790168762, -0.01327422447502613, 0.030724138021469116, 0.010397328063845634, 0.0015458081616088748, -0.0020162714645266533, -0.0006816918030381203, 0.019412068650126457, -0.022400690242648125, 0.0021611638367176056, 0.012219827622175217, -0.028852758929133415, 0.004301379434764385, 0.016577068716287613, -0.012163965962827206, -0.0009077586582861841, 0.013113620691001415, 0.018238965421915054, -0.0008571336511522532, -0.014209914021193981, -0.0014550323830917478, 0.0017186314798891544, 0.015669310465455055, -0.006361293140798807, -0.012890172190964222, -0.0002535614185035229, 0.026520516723394394, -0.005352284759283066, -0.00212450441904366, -0.0019342241575941443, -0.011088620871305466, 0.018406551331281662, 0.0038021120708435774, 0.011800861917436123, -0.03661758825182915, -0.008190776221454144, 0.004479439929127693, 0.021632585674524307, -0.013434827327728271, -0.008993793278932571, -0.006165775936096907, 0.02238672412931919, -0.009217241778969765, -0.024914482608437538, 0.026492586359381676, 0.02009638026356697, -0.027721552178263664, -0.02622724138200283, -0.010236724279820919, 0.0037392673548310995, 0.01105370745062828, -0.04181275889277458, 0.006595215760171413, 0.007241120561957359, -0.03200896456837654, 0.033852413296699524, -0.013742068782448769, -0.030835863202810287, -0.008749396540224552, -0.007097974419593811, 0.0031614440958946943, 0.0163256898522377, -0.0118637066334486, -0.023001207038760185, -0.013700172305107117, -0.015711206942796707, -0.017191551625728607, 0.027875171974301338, 0.005481465719640255, -0.01808534562587738, 0.0003207704867236316, 0.006253060419112444, 0.04586276039481163, -0.019328275695443153, 0.0018451940268278122, 0.015362069010734558, -0.015334137715399265, 0.009091551415622234, 0.03226034343242645, 0.00025181574164889753, -0.022428620606660843, 0.018741725012660027, -0.004636551719158888, 0.017750171944499016, 0.004259482957422733, 0.013560517691075802, 0.025179827585816383, 0.01029258593916893, -0.015501724556088448, 0.02132534421980381, -0.02428603544831276, -0.005425603594630957, -0.019328275695443153, 0.00014020070375408977, 0.014677758328616619, 0.025794310495257378, 0.012799397110939026, -0.023448104038834572, -0.009901551529765129, -0.006703448481857777, 0.003445991314947605, 0.014510172419250011, -0.001986594870686531, 0.014747586101293564, -0.016828447580337524, -0.03910344839096069, -0.009601293131709099, 2.4262359147542156e-05, -0.00865163840353489, 0.015711206942796707, -0.017861897125840187, -0.01029258593916893, 0.01815517246723175, -0.019663449376821518, 0.009713017381727695, -0.02009638026356697, 0.004043017514050007, -0.0071154311299324036, 0.05066689848899841, 0.00668948283419013, 0.03600310534238815, -0.017792068421840668, -0.015054827556014061, -0.019370172172784805, 0.018406551331281662, -0.0015763577539473772, -0.025473102927207947, 0.007213189732283354, -0.014181982725858688, 0.006242586299777031, -0.039466552436351776, 0.04105862230062485, 0.009189310483634472, -0.05178413912653923, 0.011500603519380093, 0.050499312579631805, 0.006560301873832941, 0.03273517265915871, 0.002957198303192854, -0.007590258494019508, -0.02971862070262432, -0.027330517768859863, -0.018671896308660507, 0.01265275850892067, -0.003746249945834279, -0.03843310475349426, 0.02019413746893406, 0.003416314721107483, 0.03446689620614052, 0.014454310759902, 0.0001310358347836882, 0.027581896632909775, -0.017540689557790756, 0.023713449016213417, -0.004884439520537853, 0.014272758737206459, -0.012233792804181576, 0.0069792671129107475, -0.0012464224128052592, -0.014929138123989105, 0.016158103942871094, -0.0042420257814228535, 0.0281265527009964, -0.03189724311232567, -0.003355215536430478, 0.0547727607190609, -0.0299979317933321, -0.019021034240722656, -0.009419741109013557, 0.021967759355902672, -0.036282412707805634, -0.005910905078053474, 0.012261724099516869, 0.019872931763529778, -0.0006908567156642675, 0.004685431253165007, -0.003095107851549983, 0.03390827775001526, 0.04723137989640236, -0.003816077718511224, 0.04170103371143341, -0.009070603176951408, 0.0034285346046090126, -0.0008148006745614111, 0.008009224198758602, -0.003274913877248764, -0.003655474167317152, -0.027693621814250946, 0.019272413104772568, -0.011305086314678192, 0.038405172526836395, 0.006029611919075251, 0.017889827489852905, -0.003267931053414941, 0.010941983200609684, -0.0013668750179931521, 0.012380431406199932, 0.05217517167329788, -0.014188965782523155, -0.017540689557790756, 0.007492499891668558, 0.004381680861115456, -0.006078491453081369, 0.016227930784225464, -0.00018449757772032171, 0.03214862197637558, -0.005802672356367111, 0.038572758436203, -0.00479366397485137, 0.0021646551322191954, 0.025724483653903008, 0.022442586719989777, -0.059269655495882034, -0.011933534406125546, 0.015697240829467773, -0.006399698555469513, -0.015515689738094807, -0.037986207753419876, -0.0002769100246950984, 0.013106637634336948, 0.013358017429709435, -0.017317241057753563, -0.018588103353977203, 0.034047931432724, 0.02259620651602745, 0.001772747840732336, -0.0001323450997006148, 0.027079138904809952, 0.02816844917833805, 0.012163965962827206, -0.02840586192905903, -0.015180516988039017, -0.0026813794393092394, 0.001146918162703514, -0.009154397062957287, 0.016716724261641502, 0.029551034793257713, 0.0037637068890035152, -0.008930948562920094, 0.032064829021692276, -0.032232414931058884, 0.016200000420212746, -3.958487923227949e-06, -0.019467931240797043, 0.03293069079518318, -0.00043293103226460516, 0.030752068385481834, -0.02033379301428795, -0.026380863040685654, -0.015152586624026299, -0.01628379337489605, 0.014007413759827614, 0.02033379301428795, 0.029662758111953735, -0.030696207657456398, -0.01180784497410059, -0.013413879089057446, 0.007485517300665379, 0.003927801735699177, -0.021911896765232086, -0.007520431187003851, -0.00796732772141695]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"Zσbounds and ensures a fair comparison across methods.
We generally have tight bounds (upper bound ≈lower bound), which suggest our logZσestimates are generally accurate,
but note that any inaccuracies in estimating logZσwould only affect the absolute values of the KL divergences, not the
relative differences among different learning methods.
42
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
We estimate expectations in Eq. (23) with 2000 samples from qand 2000 exact posterior samples for σ. With 2000 samples,
our estimates have 95% confidence intervals generally between 0.05 and 0.10, suggesting that our estimates of expectations
are unlikely to be off by more than 0.10. The exact posterior samples were collected offline; such a large number of samples
takes several hours to collect, and in practical settings, we would likely only be able to collect a much smaller number of
samples. All our methods still apply with fewer exact posterior samples, but the variance in estimates will be higher. See
also App. G.1 for details common across experiments.
Details for Sentiment (Sec. 7.2.2) We generate 10 output tokens. We parameterize the twist using an MLP head
(App. G.2.2), with 1024 hidden units per layer, matching the GPT2Medium model’s embedding dimension. Other details
are the same as for toxicity above. Collecting exact posterior samples is less time consuming in this case (less than an hour).
See App. G.1 for common experimental details.
Details for Infilling (Sec. 7.2.3) We parameterize the twist using a separate transformer with an MLP head (App. G.2.4),
with 768 hidden units per layer (matching the TinyStories model’s embedding dimension). We make the following
adjustments to the forward pass of the language model for the conditional twist setting. Instead of taking in only s1:T, the
model takes in both s1:TandsT+1:T+cand passes each separately through the body (everything except the head). Thus,
sT+1:T+ccan be seen as a second prompt. For sT+1:T+c, we take the embeddings produced after the last conditioning
token sT+chas been processed, broadcast it across time steps 1 :T, and pass that as additional input to the MLP head
(concatenated with embeddings for s1:Tat each t∈1...T). This allows the MLP head to produce different output depending
on the conditioning tokens.
Since we are in the conditional target distribution setting (Sec. 3.3), with oT=sT+1:T+c, to compare across learn-
ing methods using a single quantity, we estimate EoT[DKL(qoT∥σoT)] := EoT[DKL(q(s1:T|oT)∥σ(s1:T|oT))]and
EoT[DKL(σoT∥qoT)] :=EoT[DKL(σ(s1:T|oT)∥q(s1:T|oT))]where EoT[·] :=Ep0(sT+1:T+c)[·]for infilling. Note that,
EoT[DKL(q(s1:T|oT)∥σ(s1:T|oT))] =EoT
Eq(s1:T|oT)
logq(s1:T|oT)
p0(s1:T)ϕ(s1:T, oT)
+EoT[logZσ(oT)]
EoT[DKL(σ(s1:T|oT)∥q(s1:T|oT))] =EoT
Eσ(s1:T|oT)
logp0(s1:T)ϕ(s1:T, oT)
q(s1:T|oT)
−EoT[logZσ(oT)]
where for a fixed oT,Eq(s1:T|oT)h
logq(s1:T|oT)
p0(s1:T)ϕ(s1:T,oT)i
andEσ(s1:T|oT)h
logp0(s1:T)ϕ(s1:T,oT)
q(s1:T|oT)i
may be evaluated as before,
similar to the unconditional setting. In particular, for our experiments, we use 1-sample estimates of these expectations, as
we have a single exact sample from σ(s1:T|oT)by the BDMC trick (Sec. 3.3), and we choose to draw a single sample from
the","[0.02615918219089508, -0.006508117076009512, 0.019260365515947342, 0.009376756846904755, -0.005529611837118864, 0.01733151450753212, 0.043898992240428925, 0.03584568202495575, -0.05029095709323883, 0.02120329812169075, 0.03570488840341568, -0.03477565944194794, -0.031706392765045166, 0.018528247252106667, 0.01964050531387329, -0.0078069246374070644, 0.03224140405654907, 0.01544489897787571, -0.05276889726519585, 0.029172133654356003, -0.03224140405654907, -0.0570489801466465, 0.0164867602288723, 0.01652899757027626, 0.005564809776842594, -0.034212492406368256, 0.045222438871860504, -8.943876309785992e-06, 0.023427814245224, -0.023906506597995758, 0.04113946482539177, -0.01978129707276821, -0.015881353989243507, -0.040914200246334076, -0.02011919766664505, 0.073099285364151, 0.016895057633519173, 0.055134207010269165, -0.024680864065885544, -0.0012565699871629477, -0.020696446299552917, -0.026933537796139717, -0.05350101739168167, 0.0164867602288723, -0.004501828923821449, 0.061385378241539, -0.0036465167067945004, 0.0024779418017715216, -0.014980284497141838, 0.05091044306755066, -0.040069445967674255, 0.04708089306950569, -0.012988075613975525, -0.003160783788189292, 0.01107330247759819, -0.01541674043983221, 0.00369579391553998, 0.0087572718039155, 0.020274069160223007, -0.042293962091207504, 0.03905574232339859, -0.046968262642621994, 0.029115816578269005, 0.007630934473127127, -0.021146981045603752, -0.021569358184933662, -0.030805321410298347, 0.01312886830419302, -0.011713907122612, 0.044602952897548676, 0.012136283330619335, 0.015304106287658215, 0.00960906408727169, 0.001185293891467154, -0.02535666525363922, -0.008109628222882748, 0.02286464534699917, 0.03317062929272652, 0.002829922130331397, -0.04105499014258385, 0.022554902359843254, -0.0015962310135364532, 0.027046171948313713, -0.02162567339837551, -0.007363429293036461, -0.031340330839157104, -0.0015751122264191508, -0.007335270754992962, -0.0402383953332901, -0.016613474115729332, -0.02507508173584938, 0.0064940378069877625, -0.014726858586072922, -0.01551529485732317, 0.04803828150033951, 0.011819501407444477, 0.026567477732896805, -0.007616855204105377, -0.012424907647073269, -0.005434576887637377, 0.027426309883594513, -0.012016610242426395, 0.03201613575220108, -0.03153743967413902, 0.02900318242609501, 0.012079966254532337, -0.055753692984580994, -0.007454944308847189, -0.04798196628689766, -0.001788940280675888, -0.024216249585151672, -0.0014827173436060548, -0.02766565792262554, 0.00734231062233448, 0.005374740343540907, -0.04527875408530235, -0.050319112837314606, -0.014093293808400631, -0.011587194167077541, 0.026694191619753838, -0.04958699643611908, -0.012361550703644753, -0.009848411194980145, 0.037281762808561325, 0.012840243987739086, -0.02625773660838604, 0.009996242821216583, -0.044180575758218765, -0.017275197431445122, 0.009996242821216583, -0.029678985476493835, 0.011249292641878128, -0.03139664977788925, 0.0015390341868624091, -0.007842122577130795, -0.006057582329958677, -0.007011448964476585, 0.04282897338271141, 0.00805331114679575, 0.002166439313441515, -0.022019892930984497, -0.012854322791099548, -0.022554902359843254, 0.004776373505592346, -0.009862489998340607, -0.008229301311075687, -0.051163867115974426, 0.0074971821159124374, -0.018640881404280663, 0.019584188237786293, -0.01686690002679825, -0.023596763610839844, -0.030777163803577423, 0.0036394770722836256, 0.010313024744391441, -0.03970338776707649, -0.04015392065048218, 0.05124834179878235, 0.03677491098642349, -0.019063256680965424, -0.00035879999632015824, 0.048911191523075104, 0.03390274941921234, -0.04406794160604477, 0.009982163086533546, 0.034550394862890244, -0.022301476448774338, 0.026553399860858917, -0.06211749464273453, -0.07512669265270233, 0.01485357154160738, -0.02573680505156517, -0.019570108503103256, -0.04986857995390892, 0.008532004430890083, -0.03562041372060776, -0.030213994905352592, -0.08301105350255966, -0.00010658405517460778, 0.0071663204580545425, -0.0020837238989770412, 0.051079392433166504, -0.01879575103521347, 0.02894686535000801, -0.01907733641564846, 0.016275571659207344, -0.023413734510540962, 0.019513791427016258, 0.025891676545143127, -0.015092918649315834, 0.011678708717226982, 0.01771165244281292, 0.07563354074954987, -0.006511637009680271, -0.024849815294146538, -0.026285894215106964, 0.05307864025235176, 0.033452216535806656, 0.02389242686331272, 0.02256898209452629, 0.017599018290638924, 0.04657404124736786, -0.016402285546064377, -0.08391211926937103, -0.01175614446401596, 0.03919653594493866, -0.00890510343015194, -0.011284491047263145, -0.08233524858951569, 0.006272290367633104, 0.020555654540657997, -0.0008033951744437218, 0.05530315637588501, -0.017261117696762085, -0.0164867602288723, 0.020428940653800964, -0.08537635952234268, 0.013614600524306297, -0.016331888735294342, 0.059245336800813675, 0.006571473553776741, 0.056739237159490585, 0.043814517557621, 0.009862489998340607, -0.04505348950624466, 0.005934389308094978, 0.02687722072005272, -0.022836485877633095, 0.03083348087966442, -0.024525992572307587, 0.04612350836396217, 0.017345592379570007, -0.004772854037582874, -0.042857129126787186, 0.00435751723125577, -0.0037802692968398333, -0.020372623577713966, -0.009010697714984417, -0.014297442510724068, -0.05169887840747833, 0.008398251608014107, 0.013790590688586235, 0.03474750369787216, 0.013325977139174938, 0.01799323596060276, 0.024357041344046593, -0.027750132605433464, -0.011868778616189957, -0.0018232583533972502, -0.005497933365404606, -0.004779893439263105, -0.023427814245224, -0.015106997452676296, -0.029763460159301758, -0.06527124345302582, -0.0032522985711693764, -0.01102402526885271, -0.0003238219360355288, -0.024216249585151672, 0.0016323089366778731, 0.0013436850858852267, -0.02280832827091217, -0.05434576794505119, 0.0019270925549790263, -0.030805321410298347, -0.02064012922346592, -0.01817626692354679, 0.010573490522801876, 0.017683494836091995, -0.024357041344046593, 0.0008693915442563593, -0.02459638938307762, -0.001244250568561256, 0.029876094311475754, -0.046489566564559937, -0.08008257299661636, 0.02427256666123867, 0.05963955447077751, -0.031284015625715256, 0.012136283330619335, -0.023596763610839844, 0.005744319874793291, 0.04280081391334534, -0.015670165419578552, 0.02361084334552288, -0.0022526744287461042, 0.01695137470960617, 0.01775388978421688, -0.019584188237786293, -0.03711280971765518, 0.031143223866820335, -0.016162939369678497, 0.012959917075932026, -0.015993988141417503, -0.0026996894739568233, 0.028890548273921013, 0.012474184855818748, -0.018964702263474464, -0.021639753133058548, -0.0036218781024217606, 0.025624170899391174, -0.006469399202615023, 0.00454758619889617, 0.0009556267177686095, 0.017120325937867165, 0.002527219010517001, 0.035817522555589676, 0.029819777235388756, -0.015275947749614716, 0.019260365515947342, -0.013227422721683979, -0.022737931460142136, -0.027130646631121635, 0.040548138320446014, 0.005054438021034002, -0.001046261633746326, 0.0222873967140913, -0.00017555021622683853, 0.015599770471453667, -0.05071333050727844, -0.02762342058122158, -0.010383420623838902, 0.012720570899546146, -0.014431195333600044, -0.009813212789595127, -0.002492021070793271, -0.04601087421178818, -0.018866147845983505, -0.009996242821216583, 0.0022984319366514683, 0.0013920824276283383, 0.01192509476095438, 0.04817907512187958, 0.012502342462539673, -0.014980284497141838, -0.03486013785004616, -0.04142105206847191, 0.062230128794908524, 0.002752486616373062, 0.030073203146457672, -0.09247228503227234, 0.021414486691355705, 0.018007315695285797, -0.053106799721717834, -0.0004091771843377501, 0.010010321624577045, 0.009939925745129585, 0.036437008529901505, 0.07495774328708649, 0.006958651822060347, 0.0001361724134767428, -0.0328608863055706, 0.02563825063407421, -0.011587194167077541, 0.038070198148489, -0.0024832214694470167, 0.002910877577960491, 0.0014369598357006907, -0.023118071258068085, -0.008454568684101105, -0.03618358075618744, -0.011622391641139984, 0.028130270540714264, 0.004705977626144886, 0.014198888093233109, 0.015839116647839546, -0.023385576903820038, -0.008771350607275963, 0.011270411312580109, -0.004420873709022999, 0.002474422100931406, 0.012650175020098686, -0.029538193717598915, 0.008883984759449959, -0.04029471427202225, -0.05713345482945442, 0.0006872416706755757, 0.03193166106939316, 0.0307490061968565, 0.05212125554680824, -0.01180542167276144, 0.01634596846997738, -0.017035849392414093, 0.0006419242126867175, 0.010897312313318253, 0.0306926891207695, -0.009200766682624817, 0.0003247018903493881, -0.031706392765045166, 0.01419184822589159, 0.010362301953136921, -0.02020367421209812, -0.028073955327272415, 0.003783788997679949, -0.004656700417399406, 0.0033103753812611103, -0.0045687053352594376, 0.055415790528059006, 0.0388304740190506, 0.05907638743519783, -0.046771153807640076, -0.02832738123834133, -0.04268817976117134, -0.01032006461173296, -0.0061842952854931355, 0.03528251126408577, 0.0033948507625609636, -0.006983290426433086, 0.046630360186100006, 0.03930916637182236, 0.03607095032930374, -0.028355538845062256, 0.03801387920975685, -0.040351029485464096, 0.018683118745684624, -0.032804571092128754, 0.0336211659014225, 0.04877040162682533, 0.05105123296380043, 0.07366245239973068, -0.03677491098642349, -0.03401538357138634, -0.0238079521805048, -0.013304858468472958, -0.027496706694364548, -0.006413082592189312, 0.027806449681520462, -0.02441335842013359, 0.035254355520009995, -0.03432512655854225, -0.011136659421026707, 0.030580054968595505, 0.01851416751742363, -0.027130646631121635, -0.009742816910147667, -0.0424065962433815, 0.03356484696269035, 0.02465270459651947, -0.004266002215445042, -0.04161816090345383, -0.0038506651762872934, -0.002365308115258813, -0.020006563514471054, -0.013875066302716732, -0.05068517476320267, 0.054233137518167496, -0.024188091978430748, -0.04688378423452377, 0.03531067073345184, -0.035958316177129745, 0.003502204781398177, -0.008799509145319462, 0.05890743434429169, -0.024286646395921707, 0.00024308644060511142, -0.04288528859615326, 0.05099491775035858, -0.019668662920594215, 0.053810760378837585, -0.04877040162682533, 0.021470801904797554, 0.011277451179921627, -0.039590753614902496, -0.019091416150331497, -0.0013621640391647816, 0.04015392065048218, 0.01851416751742363, -0.018626801669597626, 0.006803780794143677, 0.030439263209700584, 0.00659963209182024, -0.06239908188581467, -0.003248778870329261, -0.011671668849885464, -0.025103239342570305, 0.000622125284280628, 0.05327574908733368, -0.05330390855669975, 0.03404354304075241, -0.02116106078028679, 0.007029048167169094, -0.00435751723125577, 0.011763184331357479, 0.027003934606909752, 0.015712404623627663, 0.07985730469226837, 0.02242818847298622, -0.03708465397357941, 0.015318186022341251, -0.02579312212765217, 0.0023424294777214527, -0.0431668721139431, 0.01051013357937336, -0.01728927530348301, 0.038605205714702606, 0.0034159694332629442, 0.010770599357783794, -0.008581281639635563, -0.001946451491676271, -0.038943108171224594, 0.03353669121861458, -0.011157778091728687, 0.01407217513769865, 0.04339214041829109, 0.013889145106077194, 0.028890548273921013, 0.012453065253794193, -0.014276323840022087, -0.0060998196713626385, 0.04108314961194992, -0.0178946815431118, -0.018260741606354713, -0.0011008186265826225, 0.002301951637491584, 0.001004903926514089, -0.013706116005778313, -0.021470801904797554, -0.01738782972097397, -0.010777639225125313, 0.020837238058447838, 0.0037274721544235945, -0.01398066058754921, -0.03674675151705742, -0.02408953756093979, 0.03480381891131401, -0.006233572494238615, -0.0027278477791696787, -0.13009195029735565, -0.02838369645178318, -0.050516221672296524, 0.020006563514471054, -0.003426529001444578, 0.009376756846904755, -0.003741551423445344, -0.024497833102941513, 0.014487512409687042, -0.014156650751829147, -0.02011919766664505, -0.013304858468472958, -0.008848786354064941, -0.005871032830327749, 0.0219635758548975, -0.0025993750896304846, 0.007630934473127127, 0.023765714839100838, -0.0022931520361453295, 0.022188842296600342, -0.016092542558908463, -0.009510509669780731, 0.022371873259544373, 0.01322038285434246, -0.0006423642043955624, -0.004339918028563261, -0.029932411387562752, -0.026201419532299042, 0.006451800465583801, -0.0022579540964215994, 0.0067087458446621895, -0.01180542167276144, -0.00516003230586648, 0.01997840590775013, -0.018823910504579544, -0.01582503691315651, 0.008539044298231602, -0.036577802151441574, -0.0011192975798621774, 0.035592254251241684, -0.021639753133058548, 0.035169877111911774, 0.05445840209722519, -0.06330014765262604, 0.011361926794052124, 0.00967945996671915, -0.008398251608014107, -0.01685282029211521, -0.026989854872226715, 0.028608964756131172, -0.0062476517632603645, 0.004058333579450846, -0.037901245057582855, -0.0277642123401165, -0.0004659340193029493, 0.003350853221490979, -0.03088979795575142, -0.05355733260512352, 0.0193589199334383, 0.007947716861963272, -0.00289151887409389, -0.0336211659014225, 0.004068892914801836, 0.029650826007127762, -0.0075605385936796665, 0.01095362938940525, 0.018162187188863754, -0.019612345844507217, 0.012988075613975525, 0.0020432460587471724, -0.03635253384709358, -0.02563825063407421, 0.0027964841574430466, 0.008039231412112713, 0.002398746320977807, -0.01093251071870327, -0.025300350040197372, -0.051783353090286255, 0.05231836438179016, -0.04218132793903351, -0.0002758646151050925, 0.0066137113608419895, -0.011256332509219646, 0.022329634055495262, -0.008433450013399124, -0.014642383903265, -0.04161816090345383, -0.0015988708473742008, -0.03460671007633209, 0.003882343415170908, -0.016979532316327095, 0.06307487934827805, -0.012270036153495312, -0.01704992912709713, -0.05392339453101158, 0.005072037223726511, -0.017247037962079048, 0.003723952453583479, 0.021653832867741585, 0.01785244420170784, -0.031227698549628258, 0.02914397418498993, -0.008602400310337543, -0.05015016347169876, -0.0003211821021977812, 0.0026116943918168545, -0.003977378364652395, 0.004959403537213802, -0.017838364467024803, -0.025750884786248207, 0.029622668400406837, 0.017782049253582954, -0.013987700454890728, 0.015205551870167255, -0.004202645737677813, -0.007764686830341816, -0.03905574232339859, 0.03263562172651291, 0.016233334317803383, -0.018809830769896507, 0.019612345844507217, -0.02168199047446251, -0.014839492738246918, -0.027806449681520462, -0.02475125901401043, 0.03097427263855934, -0.011896936222910881, 0.04226580262184143, -0.03184718266129494, -0.010798757895827293, -0.028552647680044174, -0.007905479520559311, -0.015979908406734467, -0.024948369711637497, 0.0020661246962845325, -0.009010697714984417, 0.013065511360764503, 0.0179509986191988, 0.048376183956861496, 0.02497652731835842, 0.017880603671073914, 0.011383045464754105, -0.010031440295279026, -0.023244783282279968, 0.05417681857943535, 0.028454093262553215, -0.02928476780653, 0.007201518397778273, 0.006891775876283646, -0.01017927285283804, -0.04398346692323685, -0.00946827232837677, 0.02238595113158226, -0.03821098804473877, 0.0011782542569562793, -0.04060445725917816, -0.03486013785004616, -0.007968835532665253, -0.018063632771372795, 0.04142105206847191, 0.0070466469042003155, -0.008391211740672588, -0.00220691692084074, -0.029594508931040764, -0.01114369835704565, 0.021879099309444427, -0.0033314942847937346, -0.02058381214737892, -0.028496330603957176, -0.021470801904797554, 0.04615166783332825, -0.0016886258963495493, -0.055134207010269165, 0.008989579044282436, 0.016824662685394287, -0.061272744089365005, -0.035592254251241684, -0.024385200813412666, -0.023526368662714958, -0.027524864301085472, 0.017486384138464928, 0.036014631390571594, -0.030354786664247513, -0.007011448964476585, 0.004874928388744593, -0.02720104344189167, 0.015360423363745213, -0.02258305996656418, -0.012854322791099548, 0.0006890015793032944, 0.005990705918520689, -0.011383045464754105, -0.012924719601869583, -0.024807576090097427, -0.028355538845062256, -0.039168376475572586, -0.01229819469153881, -0.001957010943442583, -0.016895057633519173, -0.03688754141330719, 0.0016719067934900522, -0.0037661900278180838, -0.029735302552580833, -0.002282592700794339, 0.030636372044682503, 0.016782423481345177, -0.034831978380680084, -0.02116106078028679, 0.027186963707208633, 0.015275947749614716, 0.01799323596060276, -0.017739810049533844, -0.0063426862470805645, 0.031621918082237244, -0.021893179044127464, -0.02753894403576851, 0.037760455161333084, 0.029228450730443, 0.015008443035185337, 0.03139664977788925, 0.04220948740839958, 0.004097051452845335, -0.028355538845062256, -0.03843625634908676, 0.01312886830419302, -0.02928476780653, 0.008158905431628227, -0.00671930518001318, -0.026173260062932968, 0.026750508695840836, -0.020245911553502083, -0.01194621343165636, -0.00807442981749773, 0.020992109552025795, 0.03471934422850609, -0.008510885760188103, 0.006948092486709356, -0.017641255632042885, -0.008637598715722561, -0.001690385746769607, -0.010024401359260082, -0.01275576837360859, 0.01987985149025917, -0.019809454679489136, -0.009144450537860394, 0.0017871803138405085, 0.027651578187942505, 0.06831235438585281, -0.006631310097873211, -0.006807300262153149, -0.007363429293036461, -0.023427814245224, -0.016979532316327095, 0.005311383865773678, 0.003173103090375662, 0.0033385339193046093, -0.044377684593200684, -0.02214660495519638, -0.022752011194825172, -0.02025998942553997, -0.015543453395366669, -0.011418242938816547, -0.029312925413250923, -0.004702457692474127, 0.03533883020281792, -0.035141721367836, 0.005068517290055752, -0.002451543230563402, 0.014825413003563881, -0.023343337699770927, -0.11725170165300369, -0.04353293403983116, 0.019401157274842262, 0.016374126076698303, 0.022174764424562454, -0.008496806025505066, 0.004181527066975832, -0.016275571659207344, -0.012896561063826084, -0.02031630650162697, 0.001016343361698091, -0.0343814417719841, 0.002807043492794037, 0.0009107491932809353, -0.007036087568849325, -0.05462735518813133, -0.017641255632042885, -0.00671930518001318, 0.013164065778255463, -0.024765338748693466, -0.01185469888150692, 0.015050680376589298, 0.010679084807634354, 0.05502157285809517, -0.01733151450753212, -0.0061631761491298676, 0.02569456771016121, 0.03353669121861458, 0.03159375861287117, 0.013656838797032833, -0.006606671493500471, -0.03764782100915909, 0.0373099185526371, 0.028017638251185417, -0.020245911553502083, -0.002423384925350547, -0.012924719601869583, -0.011200015433132648, -0.025046924129128456, -0.03429696708917618, 0.020386703312397003, -0.030495580285787582, 0.054711829870939255, 0.00034714065259322524, 0.03012952022254467, -0.02739815227687359, 0.004776373505592346, -0.024103615432977676, 0.023793872445821762, -0.03815467283129692, 0.0032980560790747404, 0.010608687996864319, 0.014571987092494965, -0.027186963707208633, 0.00807442981749773, -0.0005944068543612957, -0.005388819612562656, 0.0071381619200110435, 0.02394874393939972, 0.026342211291193962, -0.044602952897548676, 0.0021910779178142548, 0.03694386035203934, -0.004603903274983168, -0.04204053431749344, -0.016824662685394287, -0.008285618387162685, 0.0067721023224294186, -0.006293409038335085, -0.018119949847459793, 0.0052057895809412, 0.021006189286708832, 0.010122955776751041, 0.0013260859996080399, -0.008609440177679062, 0.0029619147535413504, 0.0034001304302364588, 0.027313677594065666, -0.05941428616642952, 0.0252721905708313, 0.011713907122612, -0.02394874393939972, 0.01855640485882759, 0.018021395429968834, -0.003241739235818386, 0.017021771520376205, -0.006395483389496803, -0.01175614446401596, -0.030045045539736748, 0.05671107769012451, 0.055612899363040924, -0.019049176946282387, -0.004927725065499544, -0.033649325370788574, 0.00817298423498869, -0.01719072088599205, -0.027369994670152664, 0.03829546645283699, 0.03131217509508133, -0.009278202429413795, -0.005121314432471991, 0.032466668635606766, 0.0009195487364195287, -0.009243004955351353, -0.004132249392569065, 0.03767598047852516, -0.010214470326900482, 0.00809554848819971, 0.017120325937867165, -0.007335270754992962, -0.00017874003970064223, 0.007722449488937855, -0.03193166106939316, 0.012277075089514256, -0.012579778209328651, 0.016937294974923134, 0.03257930278778076, 0.019204048439860344, 0.04373004287481308, -0.010362301953136921, 0.012403788045048714, 0.00795475672930479, -0.0016507880063727498, 0.01454382948577404, -0.025187715888023376, 0.0007422385970130563, 0.020344465970993042, 0.012389709241688251, -0.03207245096564293, -0.01348788756877184, 0.0035479620564728975, -0.014670541509985924, 0.028186587616801262, -0.011580154299736023, 0.0029355164151638746, 0.035395145416259766, 0.048911191523075104, -0.0006419242126867175, -0.006758023053407669, 0.044884536415338516, 0.004850289318710566, 0.0005468894960358739, 0.03249482810497284, 0.026567477732896805, 0.007243756204843521, -0.0028967985417693853, 0.0014272803673520684, -0.03390274941921234, -0.007419746369123459, -0.005744319874793291, 0.03173455223441124, -0.016374126076698303, -0.0075323800556361675, -0.0039245812222361565, 0.025581933557987213, -0.005835834424942732, -0.014473432675004005, -0.02970714308321476, -0.01417072955518961, 0.01681058295071125, 0.003829546505585313, 0.04916461929678917, 0.02020367421209812, -0.00953866820782423, 0.047813013195991516, 0.0039527397602796555, -0.017500463873147964, -0.0007035207818262279, -0.01620517671108246, 0.02762342058122158, -0.018683118745684624, -0.03987233713269234, 0.02059789188206196, 0.015993988141417503, 0.0025905754882842302, 0.022132525220513344, -0.025004684925079346, 0.024737181141972542, 0.012101084925234318, 0.02313215099275112, 0.02176646701991558, 0.017584938555955887, -0.020893555134534836, -0.009573866613209248, 0.04671483486890793, -0.020949872210621834, 0.011467520147562027, 0.021808704361319542, -0.0015495936386287212, 0.030101360753178596, 0.02144264429807663, 0.01270649116486311, -0.015543453395366669, 0.040914200246334076, 0.008067389950156212, 0.003254058538004756, -0.00734231062233448, 0.023653080686926842, -0.006075181066989899, -0.04716537147760391, -0.03046742081642151, 0.013762432150542736, 0.007511261384934187, -0.024202169850468636, -0.04296976327896118, 0.01793692074716091, -0.05012200400233269, 0.011988451704382896, 0.006282849702984095, 0.002433944260701537, -0.004804532043635845, -0.010524213314056396, -0.0045968638733029366, 0.043054237961769104, -0.015853196382522583, -0.03556409850716591, -0.0025131399743258953, 0.014276323840022087, -0.04178711026906967, -0.031565599143505096, -0.02800355851650238, -0.017979158088564873, 0.016360048204660416, 0.017767969518899918, -0.023385576903820038, 0.02998872846364975, 0.02914397418498993, 0.000638844387140125, -0.006715785712003708, 0.0015557532897219062, 0.0030886277090758085, 0.022301476448774338, -0.0189787819981575, -0.006145577412098646, 0.006990330293774605, -0.019443396478891373, -0.020654208958148956, 0.008130746893584728, -0.002236835192888975, 0.0012292914325371385, 0.027947241440415382, -0.004220244474709034, -0.006374364718794823, -0.0005746079841628671, 0.01620517671108246, -0.016895057633519173, 0.017908761277794838, 0.047953806817531586, -0.01686690002679825, -0.03607095032930374, -0.02979161962866783, 0.0222873967140913, 0.017556780949234962, -0.01620517671108246, 0.02313215099275112, -0.0052726659923791885, 0.014149610884487629, 0.027412232011556625, 0.029763460159301758, -0.0012160921469330788, -0.014036977663636208, 0.03243851289153099, -0.019992485642433167, -0.015571611933410168, 0.013530125841498375, -0.021231455728411674, 0.022935040295124054, 0.01666979119181633, -0.017064008861780167, 0.0019130132859572768, -0.022611219435930252, 0.009144450537860394, 0.018500087782740593, 0.044884536415338516, -0.0005490893963724375, -0.00369579391553998, 0.01055941078811884, -0.030242154374718666, 0.010784679092466831, 0.0033156550489366055, -0.02513139881193638, -0.02984793484210968, -0.042096853256225586, -0.04108314961194992, 0.026412608101963997, -0.006546834949404001, -0.0013621640391647816, -0.00434343796223402, -0.009552747011184692, 0.003892902983352542, 0.04356108978390694, 0.048291705548763275, -0.022977279499173164, -0.0009952244581654668, 0.004030175507068634, 0.01590951345860958, 0.004396234638988972, 0.040069445967674255, 0.011397124268114567, -0.024427438154816628, -0.006617230828851461, 0.020668286830186844, 0.009749856777489185, -0.002676810836419463, 0.005473294761031866, 0.013325977139174938, 0.03471934422850609, 0.009855450130999088, -0.028890548273921013, -0.014557908289134502, -0.01959826797246933, -0.003857704810798168, 0.012579778209328651, 0.027510786429047585, 0.03412801772356033, 0.0074127065017819405, 0.028975024819374084, 0.0034722862765192986, 0.025018764659762383, 0.004501828923821449, -0.01100290659815073, -0.03252298757433891, 0.024680864065885544, 0.013494927436113358, -0.02601838856935501, -0.03150928393006325, 0.020935792475938797, -0.017120325937867165, 0.007567577995359898, 0.01544489897787571, 0.02140040695667267, 0.028693439438939095, 0.013501967303454876, -0.022414110600948334, -0.020499337464571, 0.01010183710604906, -0.04601087421178818, -0.006434201262891293, -0.04339214041829109, -0.0003502204781398177, 0.03868968412280083, 0.018007315695285797, -0.02459638938307762, -0.04170263558626175, 0.011559035629034042, -0.0015064759645611048, 0.010137034580111504, 0.01248826365917921, -0.000233846963965334, -0.03519803658127785, 0.07050871104001999, 0.004185046534985304, -0.04770037904381752, 0.005737280007451773, -0.016514919698238373, 0.014895809814333916, -0.015205551870167255, -0.021498961374163628, -0.06932605803012848, 0.03759150207042694, -0.020907634869217873, 0.046827469021081924, -0.02286464534699917, 0.028397776186466217, 0.018683118745684624, -0.004135769326239824, -0.0013445650693029165, 0.017556780949234962, 0.02172422781586647, -0.002264993730932474, 0.027074329555034637, 0.012685372494161129, -0.03849257528781891, 0.014769096858799458, -0.02120329812169075, 0.006909374613314867, -0.027454469352960587, 0.015247790142893791, 0.00017841004591900855, 0.036239899694919586, -0.018823910504579544, 0.0006344446446746588, -0.04071709141135216, 0.0045335073955357075, 0.0017440627561882138, -0.009355638176202774, -0.04919277876615524, 0.025229953229427338, -0.009306360967457294, 0.010066638700664043, -0.0015187952667474747, 0.009130370803177357, -0.009862489998340607, -0.011636471375823021, -0.018711276352405548, 0.015360423363745213, -0.010031440295279026, -0.00807442981749773, -0.018964702263474464, 0.02942555956542492, -0.0018408573232591152, -0.012734649702906609, 0.013171105645596981, -0.017162563279271126, 0.0038154672365635633, -0.03409985825419426, -0.014107373543083668, 0.04302608221769333, -0.007370469160377979, -0.004206165671348572, -0.03607095032930374, -0.0006511636893264949, -0.015304106287658215, 0.015993988141417503, 0.01015111431479454, -0.03753518685698509, -0.0024145853240042925, 0.03500092774629593, 0.00967945996671915, 0.04558849707245827, -0.014895809814333916, 0.00038541850517503917, -0.028017638251185417, -0.02011919766664505, -0.0011808942072093487, -0.010010321624577045, -0.010313024744391441, 0.03027031198143959, 0.0018602162599563599, 0.014656462706625462, -0.014586066827178001, -0.002648652298375964, 0.013734274543821812, -0.017556780949234962, 0.020837238058447838, 0.013537164777517319, 0.031706392765045166, -0.019063256680965424, -0.0042624822817742825, 0.011411204002797604, -0.012551619671285152, 0.003194221993908286, 0.0068002608604729176, 0.003317415015771985, 0.00868687592446804, -0.03542330488562584, 0.03136849030852318, -0.018077712506055832, 0.01039046049118042, 0.0004940924700349569, -0.01804955303668976, -0.01175614446401596, 0.03269193693995476, 0.013445650227367878, 0.02427256666123867, 0.008722073398530483, -0.06437017023563385, -0.010432697832584381, 0.01983761414885521, 0.03829546645283699, 0.0015566331567242742, -0.00578303774818778, 0.019049176946282387, 0.010939549654722214, -0.005856953561306, -4.4052543671568856e-05, -0.032325878739356995, 0.00735638989135623, -0.013424531556665897, -0.01861272193491459, -0.0020696446299552917, -0.008820627816021442, -0.016754265874624252, 0.01492396742105484, 0.008109628222882748, -0.0022033972200006247, -0.02178054489195347, 0.009081093594431877, -0.024638626724481583, 0.015642007812857628, -0.0033279743511229753, 0.005888631567358971, -0.005117794498801231, -0.014212967827916145, 0.029341083019971848, -0.0006318047526292503, 0.006455319933593273, -0.0020942832343280315, -0.02852449007332325, 0.0028862389735877514, 0.001900693983770907, -0.005163552239537239, -0.006110379472374916, 0.025652330368757248, 0.012790966778993607, -0.0025694568175822496, -0.014515670947730541, -0.011995491571724415, 0.014128492213785648, 0.005522571969777346, 0.016402285546064377, -0.012079966254532337, -0.024582309648394585, 0.020795000717043877, 0.01841561309993267, 0.008560162968933582, 0.006726345047354698, -0.040491823107004166, 0.023385576903820038, -1.8863947843783535e-05, 0.044377684593200684, -0.002689130138605833, -0.01885206811130047, -0.004061853513121605, 0.02286464534699917, -0.006170216016471386, -0.007799885235726833, -0.02615918219089508, -0.010094797238707542, -0.0036007591988891363, -0.0062476517632603645, 0.008539044298231602, -0.005441616754978895, -0.02465270459651947, -0.0281443502753973, -0.018443770706653595, -0.0017801407957449555, 0.0018338176887482405, -0.03705649450421333, 0.0018918944988399744, 0.0026046547573059797, -0.041815269738435745, 0.03429696708917618, -0.001737023121677339, -0.03694386035203934, -0.013663877733051777, 0.0015786319272592664, 0.01647268235683441, -0.01911957375705242, 0.012143323197960854, -0.009735777042806149, 0.0008385932305827737, 0.013593481853604317, -0.03131217509508133, 0.02497652731835842, 0.02073868364095688, -0.002235075458884239, -0.0019974885508418083, -0.006170216016471386, 0.03792940452694893, -0.02437112107872963, -0.014445274136960506, 0.009531628340482712, 0.003005912294611335, 0.00866575725376606, 0.033930908888578415, -0.007574617862701416, -0.02824290469288826, -0.00936971791088581, 0.010819876566529274, 0.02790500409901142, -0.003220620332285762, 0.008954380638897419, 0.020231831818819046, 0.017838364467024803, -0.030777163803577423, 0.006328606978058815, -0.00437863590195775, -0.006677067838609219, -0.024723101407289505, -0.0030868679750710726, -0.007553498726338148, 0.027651578187942505, 0.003206541296094656, -0.019485633820295334, 0.02432888373732567, 0.013783551752567291, -0.005955507978796959, 0.006877696607261896, 0.012460105121135712, 0.015177393332123756, -0.017162563279271126, -0.009552747011184692, -0.017345592379570007, 0.011699827387928963, 0.0027736052870750427, -0.001522315084002912, -0.034972768276929855, -0.002736647380515933, 0.018162187188863754, -0.026989854872226715, -0.00514595303684473, 0.012460105121135712, -0.004734136164188385, -0.007039607502520084, 0.04916461929678917, 0.0017062248662114143, 0.028440013527870178, -0.018119949847459793, 0.01110146101564169, -0.009404915384948254, 0.023484131321310997, -0.0006872416706755757, -0.02796132117509842, -0.009911767207086086, -0.027369994670152664, -0.011559035629034042, -0.019246287643909454, 0.0104397376999259, 0.0010119435610249639, -0.048573292791843414, -0.0006111258990131319, 0.03705649450421333, -0.002836961764842272, 0.011889897286891937, 0.011115539819002151, -0.0024902611039578915, 0.004656700417399406, -0.038182832300662994, 0.009756895713508129, 0.0016771864611655474, 0.006279329769313335, -0.014388957992196083, -0.002479701768606901, 0.024863893166184425, 0.03778861463069916, 0.04893935099244118, -0.001893654465675354, 0.013382294215261936, -0.02753894403576851, 0.06397595256567001, -0.03457855060696602, -0.00129000807646662, -0.00091778882779181, 0.019795376807451248, -0.015121077187359333, -0.035169877111911774, 0.012065887451171875, -0.0060329437255859375, 0.02753894403576851, -0.043814517557621, -0.008891024626791477, 0.045982714742422104, -0.030298471450805664, -0.00656443415209651, 0.0037908286321908236, 0.01685282029211521, -0.05172703415155411, -0.009954004548490047, 0.0161066222935915, -0.01865495927631855, -0.0119039760902524, -0.003426529001444578, -0.005434576887637377, 0.012241877615451813, 0.06031535565853119, 0.006543315015733242, 0.0252158734947443, 0.0021752386819571257, 0.008609440177679062, -0.01303031388670206, 0.01263609528541565, 0.00256769685074687, 0.004575744736939669, -0.022301476448774338, -0.00369579391553998, -0.012410827912390232, 0.029256608337163925, -0.015135155990719795, 0.04142105206847191, -0.02942555956542492, 0.02739815227687359, 0.006662988569587469, 0.013241501525044441, 0.02389242686331272, -0.02777829021215439, 0.010517173446714878, 0.0026064147241413593, -0.021977653726935387, 0.003387811128050089, 0.004917165730148554, -0.003051669802516699, 0.016134779900312424, 0.014994364231824875, 0.043195031583309174, 0.002546577947214246, -0.0026416126638650894, 0.014557908289134502, 0.030805321410298347, -0.04282897338271141, 0.004118170589208603, 0.007849162444472313, -0.005663364194333553, -0.013164065778255463, -0.025244032964110374, -0.005980146583169699, -0.012079966254532337, -0.010376381687819958, 0.0024779418017715216, 0.024005061015486717, 0.013917303644120693, -0.008954380638897419, -0.008419370278716087, -0.01419184822589159, 0.013748353347182274, 0.028975024819374084, 0.011249292641878128, -0.03083348087966442, -0.03370564058423042, 0.01743006892502308, -0.011354886926710606, -0.02031630650162697, 0.036718592047691345, 0.02583535946905613, 0.009116291999816895, -0.0025483379140496254, 0.002678570570424199, -0.03987233713269234, 0.00805331114679575, -0.008187063038349152, -0.020513415336608887, 0.037000175565481186, 0.009306360967457294, 0.05299416556954384, -0.011164817027747631, -0.04406794160604477, -0.023301100358366966, -0.01666979119181633, 0.013304858468472958, 0.005378260277211666, 0.058062683790922165, -0.05426129326224327, -0.02583535946905613, -0.01537450309842825, 0.023061754181981087, 0.017782049253582954, -0.010904352180659771, 0.021414486691355705, -0.023878348991274834]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" conditional proposal q(s1:T|oT). We average this over 2000 oT∼p0(sT+1:T+c), approximating the outer expectation,
giving us a 2000-sample estimate of 1-sample estimates for the first term in the right hand side of both equations above.
With 2000 samples, our estimates have 95% confidence intervals generally between 0.20 and 0.30.
Note that EoT[logZσ(oT)]is independent of the learning method or proposal q, unlike the first term we discussed above.
Thus, in order to save computation and provide us with a more accurate estimate of EoT[logZσ(oT)], we estimate this term
only once. Specifically, we consider only the learning method with the lowest KL divergence (DPG), and use SIS/IWAE
bounds. For each oT, we estimate logZσ(oT)withK= 500 samples, which gives us relatively tight sandwich bounds,
again taking the midpoint as our estimate. We average this over 1000 oT∼p0(sT+1:T+c), giving us a 1000-sample estimate
ofEoT[logZσ(oT)], where each logZσ(oT)is itself estimated via 500 samples.
For negative sampling with contrastive twist learning (CTL) in this setting, we need at least 2 negative samples per set of
conditioning tokens oT=sT+1:T+cto perform SISreweighting; this is in contrast with other twist learning methods which
can generate a single negative sample per oT. For the positive sample, we can use our single exact sample directly, or we
can run the SMC upper bound sampling procedure (“Sampling from σSMCfor SMC Upper Bounds” section in Sec. 5.2)
generate more approximate σsamples using the given exact sample. We find the latter to generally perform slightly better
than the former, so adopt that for our infilling experiments.
We use a fixed batch size of 100 across all methods for training twists. To clarify the meaning of this batch size, for methods
other than CTL, we have 100 draws of exact σsamples, each for a different set of conditioning tokens oT=sT+1:T+c,
so we train over 100 different oTat a time using 1 negative sample per oT. For CTL, since we need at least 2 negative
samples per oT, we split the batch size of 100 across the number of different oTand the number of negative samples per
oT, as an additional hyperparameter. We use 25 oTwith 4 negative samples per oTfor the experiments in Sec. 7.2.3 and
43
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Table 6: Qualitative Results - Reviews Very Likely to be of a Particular Rating
Class (Rating) Most Text Generated Using Twisted SMC
1-star “I bought this sucker for my wife to use on her python that she sent me last year. It was terrible!”
2-star “I bought this throat raiser for combating dental caries. I didn’t really like it. I didn’t like”
3-star “I bought this a few months back, and I enjoyed it every time I held it. I’m giving 3 stars”
4-star “I bought this product a few months ago and have really enjoyed it. Only reason I gave it 4 stars is because”
5-star “I bought this phone recently, and I’ve been loving it! Gorgeous design, outstanding battery life, fantastic camera”
Table 7: Qualitative Results - Infilling Examples
Proposal Prompt ( s0) Generated Tokens ( s1:T) Conditioning Tokens ( sT+1:T+c)
DPG Once upon a time, there was a little girl named Mia. She had a big heart. Mia loved to help others and make them feel safe. Mia liked to
SIXO Once upon a time, there was a girl named Mia. Mia was very kind and compassionate. She always helped her others and make them feel safe. Mia liked to
CTL Once upon a time, there was a girl named Mia. She had a thin, pink dress. Mia liked to others and make them feel safe. Mia liked to
10oTwith 10 negative samples per oTfor the experiments in App. H.2. Controlling for batch size in this way is arguably
disadvantageous for CTL compared to other learning methods, as it learns on a smaller number of oT, but this controls
for memory requirements, and we feel is more fair than controlling for the number of oTseen but allowing more negative
samples for CTL relative to other methods. We","[0.041950203478336334, -0.0236614141613245, 0.027768973261117935, 0.028175044804811478, -0.02166229858994484, -0.013376899063587189, 0.03832680732011795, 0.026175927370786667, -0.047072939574718475, 0.02291174605488777, 0.05072757601737976, -0.045417420566082, -0.025316933169960976, 0.018788568675518036, 0.03867040574550629, -0.019241493195295334, 0.017429795116186142, -0.010229852981865406, -0.03945130854845047, 0.04032592102885246, 0.0048494185321033, 0.0025086565874516964, -0.01619596593081951, 0.006208193022757769, 0.01786710135638714, -0.03873287886381149, 0.06709533929824829, 0.007539635524153709, 0.008496244437992573, -0.019272729754447937, 0.025379404425621033, -0.028221899643540382, -0.04298099875450134, -0.0709686279296875, -0.02384883165359497, 0.06047326698899269, 0.02828437089920044, 0.058630332350730896, -0.010456315241754055, -0.033922504633665085, 0.005286725237965584, -0.03954501822590828, 0.0020225434564054012, 0.0007565015112049878, -0.012650657445192337, 0.029549436643719673, 0.03389126807451248, -0.0010317704873159528, -0.011635481379926205, 0.032017096877098083, -0.03926389291882515, 0.028518643230199814, -0.027409758418798447, 0.006130102556198835, 0.01226020511239767, -0.025972893461585045, -0.01272874791175127, 0.0015090984525159001, 0.047166649252176285, -0.04657316207885742, 0.0255512036383152, -0.04010726884007454, 0.027300430461764336, -0.011057611554861069, 0.01911654882133007, -0.009550465270876884, -0.049072057008743286, 0.006137911695986986, -0.01504803542047739, 0.03179844096302986, 0.03153293579816818, 0.022786801680922508, -0.0015842606080695987, -0.0006808513426221907, -0.009823782369494438, 0.0170237235724926, 0.023723887279629707, 0.045573603361845016, 0.01149491872638464, -0.03664005175232887, 0.03292294591665268, -0.0034847876522690058, 0.02516075223684311, 0.00589192658662796, -0.03823309764266014, -0.02780020982027054, -0.04691676050424576, -0.016055401414632797, -0.021802861243486404, -0.006747017148882151, -0.04751024767756462, 0.029877416789531708, -0.03376632183790207, -0.05413231998682022, 0.054444681853055954, -0.0059504942037165165, -0.001961047062650323, 0.018960367888212204, -0.017539121210575104, 0.010300134308636189, 0.0021884855814278126, -0.010089289397001266, 0.011276264674961567, 0.022115223109722137, 0.030424050986766815, 0.004728378262370825, -0.0056810821406543255, 0.02138117328286171, -0.04932194575667381, -0.014173422008752823, -0.02469220943748951, -0.00964417401701212, -0.053320176899433136, 0.041669078171253204, 0.009542656131088734, -0.03075203113257885, -0.016617653891444206, -0.01102637592703104, -0.0397636704146862, -0.03161102533340454, -0.019085312262177467, -0.025410640984773636, 0.0017365369712933898, 0.021896570920944214, -0.007957419380545616, -0.030798884108662605, 0.012947401031851768, -0.05175836756825447, -0.018382498994469643, -0.01675821654498577, -0.008660233579576015, 0.023520851507782936, -0.006044202949851751, 0.0015842606080695987, -0.027113014832139015, -0.01125283818691969, -0.009636364877223969, 0.04523000493645668, -0.021334318444132805, 0.03432857245206833, -0.016164729371666908, -0.05338265001773834, 0.019054075703024864, -0.004876750521361828, 0.012759984470903873, -0.04819744452834129, -0.027862682938575745, 0.04229380190372467, -0.04185649752616882, 0.03093944676220417, -0.026066601276397705, -0.01730485074222088, -0.059473708271980286, 0.017913956195116043, 0.015297924168407917, -0.060129668563604355, -0.06144158914685249, 0.05319523438811302, -0.019163403660058975, -0.03526565805077553, 0.0072936504147946835, -0.005216443911194801, 0.02147488109767437, -0.010924858041107655, 0.0036448731552809477, 0.0007164801354520023, -0.012416386045515537, 0.04454280808568001, -0.059942249208688736, -0.07028143107891083, 0.057380884885787964, -0.0378270260989666, -0.04294976219534874, -0.022646239027380943, -0.0160710196942091, -0.04076322913169861, -0.034391045570373535, -0.0672202855348587, -0.020365996286273003, -0.00589192658662796, -0.037233538925647736, 0.06384677439928055, -0.056724924594163895, -0.008066746406257153, -0.012783410958945751, -0.018569916486740112, 0.001488599693402648, 0.04463651776313782, 0.027394140139222145, 0.005294534377753735, 0.008433771319687366, 0.028268752619624138, 0.09701961278915405, 0.004724473692476749, -0.021709153428673744, -0.0035863053053617477, 0.0794648677110672, 0.03717106580734253, 0.022208932787179947, 0.023239726200699806, 0.017382940277457237, 0.03489082679152489, -0.01618034765124321, -0.0425749272108078, 0.0340786837041378, -0.03179844096302986, -0.007000811398029327, 0.024176811799407005, -0.06896951049566269, 0.008800797164440155, 0.04235627502202988, -0.034578464925289154, 0.03870164230465889, -0.0008624116890132427, -0.038170624524354935, 0.022380730137228966, -0.05238309130072594, -0.028268752619624138, 0.013080155476927757, 0.047072939574718475, 0.01414218544960022, 0.019272729754447937, 0.046885523945093155, 0.01827317103743553, -0.05238309130072594, 0.01956947334110737, -0.00778171606361866, 0.0028424933552742004, 0.02259938418865204, -0.06131664291024208, 0.03607780113816261, 0.016398999840021133, -0.009003832004964352, -0.06515869498252869, 0.015008989721536636, -0.0120571693405509, -0.03507824242115021, -0.024848390370607376, -0.023489614948630333, -0.07296774536371231, -0.028081335127353668, 0.023614561185240746, 0.03075203113257885, 0.00851967092603445, -0.053788721561431885, 0.009199058637022972, -0.022068368270993233, -0.037327248603105545, 0.009878445416688919, 0.012174305506050587, -0.015540004707872868, -0.020943867042660713, -0.02751908451318741, -0.025676149874925613, -0.04313718155026436, 0.00828539952635765, 0.01036260649561882, -0.007469354197382927, -0.010690586641430855, 0.028424933552742004, 0.01881980523467064, -0.027409758418798447, -0.04104435443878174, -0.006442464422434568, -0.03564049303531647, -0.010995139367878437, -0.03140798956155777, 0.033047888427972794, 0.029455728828907013, -0.0029498678632080555, -0.022021515294909477, 0.00287372968159616, 0.02233387716114521, 0.04619832709431648, -0.02138117328286171, -0.053976137191057205, -0.00823073647916317, 0.03823309764266014, -0.016414618119597435, 0.03867040574550629, -0.028503024950623512, -0.009448947384953499, 0.03526565805077553, -0.023130400106310844, 0.008379108272492886, 0.016976870596408844, 0.021459262818098068, 0.0057006049901247025, -0.00680948980152607, -0.04051334038376808, 0.03417239338159561, -0.022177696228027344, 0.032017096877098083, -0.030502140522003174, -0.0031899961177259684, 0.032329458743333817, 0.0054311929270625114, 0.0004441395867615938, -0.01225239597260952, -0.014923090115189552, 0.05753706395626068, 0.012947401031851768, 0.002127965446561575, -0.005435097496956587, 0.03161102533340454, 0.04610461741685867, 0.0340474471449852, -0.011135702021420002, -0.004693237598985434, 0.018491825088858604, -0.022677475586533546, -0.010011198930442333, -0.020787686109542847, 0.05241432785987854, 0.0004892856231890619, -0.030033597722649574, 0.051602188497781754, -0.028893476352095604, 0.007961324416100979, -0.053882431238889694, -0.05353883281350136, -0.03820186108350754, -0.0002236560103483498, 0.01315043680369854, 0.017461031675338745, -0.0030670035630464554, -0.01713305152952671, 0.0044862981885671616, 0.001982521964237094, -0.022099604830145836, -0.00698128854855895, -0.014110949821770191, 0.059473708271980286, 0.011885371059179306, -0.022396348416805267, -0.03670252487063408, -0.016586417332291603, 0.023583324626088142, -0.006606454495340586, 0.10320437699556351, -0.08552469313144684, -0.009355239570140839, 0.0011459777597337961, -0.03131427988409996, -0.0023856640327721834, 0.03376632183790207, 0.013704879209399223, 0.03632768988609314, 0.08727391809225082, 0.02156859077513218, -0.009472374804317951, -0.015852367505431175, 0.043293360620737076, 0.00420907698571682, 0.0226930920034647, 0.012525713071227074, -0.019834982231259346, -0.03917018324136734, -0.017242377623915672, 0.01272874791175127, -0.0208189208060503, 0.006680640392005444, 0.02856549620628357, 0.022177696228027344, 0.03142360970377922, 0.018897894769906998, -0.022255785763263702, 0.015547813847661018, -0.002061588689684868, -0.029408873990178108, 0.0014622441958636045, 0.006176956929266453, -0.007473258767277002, -0.009769118390977383, -0.046510688960552216, 0.017929574474692345, -0.0014036763459444046, 0.01902284100651741, 0.013376899063587189, 0.059192582964897156, 0.012424195185303688, -0.02203713357448578, -0.008902314119040966, 0.0022216741926968098, -0.00798865593969822, 0.013415943831205368, 0.00969102792441845, -0.0059700170531868935, -0.03018977865576744, 0.02773773856461048, 0.014282748103141785, -0.015625905245542526, -0.028518643230199814, 0.015680568292737007, 0.005505378823727369, 0.016008548438549042, -0.03257934749126434, 0.06553352624177933, 0.023520851507782936, 0.02801886387169361, -0.0059504942037165165, -0.011440254747867584, -0.07584147155284882, 0.015110507607460022, -0.05216443911194801, 0.00964417401701212, 0.02442670240998268, -0.007965228520333767, 0.0463857427239418, 0.043105944991111755, 0.03623398020863533, -0.04988419637084007, 0.02894033119082451, 0.003156807506456971, 0.0127756018191576, -0.029002804309129715, 0.0004131474415771663, 0.03626521676778793, 0.042918525636196136, 0.07221807539463043, -0.04491764307022095, -0.04691676050424576, 0.0048494185321033, -0.00969102792441845, -0.007551349233835936, 0.01788271963596344, 0.006930530071258545, -0.028971567749977112, 0.01872609741985798, -0.03754590079188347, -0.0022821943275630474, 0.056724924594163895, 0.0004968506400473416, -0.03545307740569115, -0.03995108976960182, -0.0652836412191391, 0.004158318042755127, 0.03239193186163902, 0.014313984662294388, -0.04182526096701622, 0.002461802214384079, 0.0003831314097624272, 0.009191249497234821, -0.027987627312541008, -0.0012797077652066946, 0.03065832145512104, -0.017336085438728333, -0.03189215064048767, 0.010440696962177753, -0.006184766069054604, -0.0016896827146410942, -0.012635039165616035, 0.043668195605278015, 0.013751733116805553, 0.017179904505610466, -0.0407007560133934, 0.03417239338159561, -0.0274409931153059, 0.037233538925647736, -0.03125181049108505, 0.01627405546605587, -0.004556579515337944, -0.03664005175232887, 0.008176073431968689, -0.006938338745385408, 0.042918525636196136, 0.019460147246718407, -0.024676591157913208, 0.0048103732988238335, -0.004009946249425411, -0.0007813928532414138, -0.04663563519716263, 0.016149111092090607, -0.007137469481676817, -0.007617725990712643, 0.015063652768731117, 0.04897834733128548, -0.035609256476163864, 0.020834539085626602, -0.0005236942670308053, 0.028424933552742004, 0.007125756237655878, 0.041887734085321426, 0.016914397478103638, 0.016805071383714676, 0.08240107446908951, 0.010143953375518322, -0.019179021939635277, 0.012143068946897984, -0.02904965728521347, -0.02110004797577858, -0.03795197233557701, 0.015204216353595257, -0.01995992660522461, 0.022005897015333176, -0.01391572318971157, 0.011424636468291283, -0.017445413395762444, -0.02338028885424137, -0.03129866346716881, 0.028799768537282944, 0.016789453104138374, 0.0019180973758921027, 0.025379404425621033, 0.013376899063587189, 0.0065517909824848175, 0.026831887662410736, -0.03178282454609871, -0.007906660437583923, 0.001001510419882834, -0.0165395624935627, -0.013689260929822922, -0.007879328913986683, 0.012603803537786007, -0.017336085438728333, 0.005239870864897966, -0.020975101739168167, -0.013236336410045624, -0.00013751245569437742, 0.021365555003285408, -0.020178578794002533, -0.012869310565292835, -0.04191896691918373, -0.0387641116976738, 0.034484755247831345, -0.03339148685336113, -0.019944308325648308, -0.08977281302213669, -0.044980116188526154, -0.03607780113816261, 0.003332511056214571, -0.026519525796175003, 0.008433771319687366, 0.02564491331577301, -0.04341830685734749, 0.023349052295088768, -0.028690442442893982, -0.014235894195735455, -0.025238841772079468, -0.019913071766495705, 0.009519229643046856, 0.022942982614040375, 0.026722561568021774, -0.02828437089920044, 0.016789453104138374, -0.014712246134877205, 0.0005324794328771532, -0.017382940277457237, -0.01276779267936945, 0.01565713994204998, 0.027878301218152046, -0.005376529414206743, 0.012041551992297173, -0.04098188132047653, -0.017835864797234535, 0.008129218593239784, 0.0359216183423996, -0.014993371441960335, 0.014017241075634956, -0.0052008256316185, 0.027706502005457878, -0.02194342389702797, 0.015235451981425285, -0.014790336601436138, -0.03236069530248642, 0.027300430461764336, 0.007676294073462486, 0.011213792487978935, 0.018616769462823868, 0.04151289910078049, -0.051789604127407074, -0.01646147295832634, 0.021443644538521767, -0.013330044224858284, -0.018148226663470268, -0.04235627502202988, 0.03279799968004227, -0.010518787428736687, -0.025051426142454147, -0.013689260929822922, -0.0165395624935627, -0.016008548438549042, 0.009308384731411934, 0.0012718986254185438, -0.025098279118537903, 0.028534261509776115, 0.015157361514866352, 0.0222401674836874, -0.0004290095530450344, 0.009534846991300583, 0.03510947898030281, 0.010151762515306473, -0.000562739500310272, 0.017773393541574478, -0.023520851507782936, 0.004943127278238535, 0.006633786018937826, -0.02534816972911358, -0.02631649188697338, -0.014087522402405739, -0.0021299177315086126, -0.000595439865719527, 0.00731317326426506, -0.019725654274225235, -0.034203629940748215, 0.059192582964897156, -0.046604398638010025, -0.004689333029091358, 0.024614118039608, 0.006739208474755287, 0.027690883725881577, 0.0368899405002594, 0.005025122314691544, -0.025191988795995712, 0.0077114347368478775, -0.015821130946278572, 0.02715986780822277, -0.011893180198967457, 0.06234743818640709, 0.00021987350191920996, -0.020365996286273003, -0.05157095193862915, 0.0008697326993569732, -0.020959483459591866, 0.004724473692476749, 0.006294092629104853, -0.008605570532381535, -0.02780020982027054, 0.00265898066572845, 0.0231772530823946, -0.022349495440721512, 0.024098722264170647, 0.0021142996847629547, 0.003549212124198675, -0.009808164089918137, -0.02678503468632698, -0.0026726466603577137, 0.03738972172141075, 0.011440254747867584, -0.000736490823328495, 0.0007189204916357994, 0.007352218497544527, -0.011924415826797485, -0.019132167100906372, 0.02894033119082451, -0.00529843894764781, -0.009628555737435818, 0.023880068212747574, -0.012658466584980488, -0.02516075223684311, -0.04513629525899887, -0.050383977591991425, 0.02110004797577858, -0.034203629940748215, 0.0241299569606781, -0.019179021939635277, 0.006102771032601595, -0.01911654882133007, -0.008168264292180538, -0.015165170654654503, -0.01414999458938837, -0.006489318795502186, 0.00242470926605165, 0.0027390234172344208, -0.005423383787274361, 0.0501653216779232, 0.020194197073578835, 0.0062706652097404, -0.014493593014776707, -0.02147488109767437, -0.011908797547221184, 0.07040637731552124, 0.035609256476163864, -0.020365996286273003, 0.004841609857976437, 0.01485280878841877, -0.013470607809722424, -0.054632097482681274, -0.008371299132704735, 0.02564491331577301, -0.026660088449716568, -0.007457640487700701, -0.03632768988609314, -0.033828794956207275, 0.0062589519657194614, 0.0027468325570225716, 0.020116107538342476, 0.024348611012101173, -0.022083986550569534, 0.0002655076386872679, -0.021365555003285408, 0.0010971712181344628, 0.03395374119281769, -0.023208489641547203, -0.008628997951745987, -0.0321420393884182, -0.017726538702845573, 0.01225239597260952, -0.007816856727004051, -0.05091499164700508, -0.01012052595615387, 0.00716870604082942, -0.042824819684028625, -0.020131725817918777, -0.018710479140281677, -0.003885001176968217, -0.025191988795995712, 0.024473555386066437, 0.024770298972725868, 0.017913956195116043, -0.0026511717587709427, -0.0021318700164556503, -0.007266318891197443, 0.008543098345398903, -0.013540889136493206, -0.009620746597647667, 0.009245912544429302, -0.004892368335276842, -0.021615443751215935, -0.010557832196354866, -0.017664065584540367, -0.005103212781250477, -0.034484755247831345, -0.00988625455647707, 0.0050797853618860245, -0.02309916354715824, -0.04569854587316513, 0.009855017997324467, -0.014681009575724602, 0.0036194936838001013, 0.004361353348940611, 0.03181406110525131, 0.020116107538342476, -0.02452041022479534, -0.06006719544529915, 0.03901400417089462, -0.020803302526474, 0.02166229858994484, -0.01243981346487999, 0.012822456657886505, 0.023067926988005638, -0.013970386236906052, -0.03545307740569115, 0.04335583373904228, 0.0406695194542408, 0.017820246517658234, 0.014743482694029808, 0.04401179403066635, -0.004298880696296692, -0.04382437467575073, -0.02915898524224758, 0.0175078846514225, -4.057044498040341e-05, -0.0017541073029860854, -0.021021956577897072, -0.03075203113257885, 0.0034164583776146173, -0.008113600313663483, -0.006364373955875635, -0.009238103404641151, 0.0179920457303524, 0.028784150257706642, -0.016523944213986397, -0.003631207160651684, -0.02214645966887474, 0.0016018309397622943, -0.02336467057466507, -0.014415502548217773, -0.023349052295088768, 0.024645354598760605, -0.022864891216158867, -0.028534261509776115, -0.0029127749148756266, -0.004291071556508541, 0.07490438967943192, -0.009081922471523285, 0.014540446922183037, -0.0012455431278795004, -0.000580797903239727, 0.004529247526079416, 0.022677475586533546, -0.009503611363470554, -0.026425817981362343, -0.024005012586712837, -0.03190777078270912, -0.04323088750243187, -0.012603803537786007, 0.017742156982421875, -0.00563032366335392, -0.02327096275985241, -0.021334318444132805, 0.01995992660522461, 0.02620716392993927, 0.01173699926584959, -0.028518643230199814, 0.006520554888993502, -0.02158420719206333, -0.13494034111499786, -0.04132547974586487, 0.024614118039608, -0.01618034765124321, 0.019710035994648933, -0.026800651103258133, 0.01593826711177826, -0.00823854561895132, -0.011658908799290657, -0.01900722272694111, -0.0047674234956502914, -0.026285255327820778, -0.02117813751101494, -0.020959483459591866, -0.011432445608079433, -0.03470340743660927, -0.0062823789194226265, -0.020116107538342476, -0.003959187306463718, 0.018195081502199173, -0.0018107229843735695, 0.004728378262370825, 0.015633713454008102, 0.0710311010479927, -0.00707109272480011, -0.033047888427972794, 0.005645941477268934, 0.03551555052399635, -0.004775232635438442, 0.03707735985517502, -0.012752175331115723, -0.03479711711406708, 0.02308354526758194, 0.029580673202872276, -0.007933992892503738, -0.008394726552069187, -0.022708710283041, -0.007043761201202869, -0.02158420719206333, -0.0041114636696875095, 0.029689999297261238, -0.03009607084095478, 0.04523000493645668, -0.006216002162545919, 0.007793429773300886, -0.05135229974985123, 0.002198247006163001, 0.00023573562793899328, 0.018429351970553398, -0.030330341309309006, 0.021599825471639633, 0.005591278430074453, 0.010143953375518322, -0.03187653422355652, -0.02422366663813591, 0.005470238160341978, 0.006169147789478302, -0.006040298379957676, -0.00399432796984911, 0.03526565805077553, -0.009261530824005604, 0.018694860860705376, 0.03929512947797775, -0.03682747110724449, -0.038639169186353683, -0.028706058859825134, -0.006532268598675728, -0.01150272786617279, 0.005345293320715427, -0.009878445416688919, -0.010760867968201637, 0.017913956195116043, 0.018038900569081306, 0.005189112387597561, -0.029971124604344368, 0.004845513962209225, -0.004052895586937666, 0.03873287886381149, -0.03226698562502861, 0.00591144897043705, 0.03523442521691322, -0.037233538925647736, 0.015688376501202583, 0.01268189400434494, 0.008792988024652004, 0.024629736319184303, -0.027972009032964706, -0.006747017148882151, -0.03804568201303482, 0.03617151081562042, 0.03047090396285057, -0.018569916486740112, -0.0022704806178808212, -0.045073822140693665, -0.031017538160085678, 0.010034626349806786, -0.008847651071846485, 0.051414769142866135, 0.02117813751101494, 0.017710920423269272, 0.0179920457303524, 0.027191104367375374, -0.017929574474692345, -0.03838928043842316, 0.011612053960561752, 0.027175486087799072, 0.0009639293421059847, 0.012221159413456917, 0.037327248603105545, -0.00029527960577979684, -0.0020069251768290997, -0.016305292025208473, -0.015360397286713123, 0.01786710135638714, -0.023255344480276108, 0.02298983745276928, 0.0520394928753376, -0.00028673847555182874, 0.0407007560133934, -0.01243981346487999, 0.011174747720360756, 0.016961252316832542, 0.00038825609954074025, 0.004634669981896877, -0.04710417613387108, 0.0009243960375897586, 0.012228968553245068, -0.010620305314660072, -0.013033300638198853, -0.0008355681202374399, 0.045073822140693665, -0.006789966952055693, 0.030424050986766815, -0.006832916755229235, 0.004060704726725817, 0.03820186108350754, 0.03670252487063408, 0.000954168033786118, -0.010065862908959389, 0.04379314184188843, 0.0064658913761377335, 0.0023192872758954763, 0.028503024950623512, 0.04401179403066635, 0.007715339306741953, -0.020506558939814568, 0.012127451598644257, -0.02450479194521904, -0.002323191612958908, -0.001379273016937077, 0.031283047050237656, -0.0007389311213046312, -0.0012357818195596337, -0.0003160224005114287, -0.0048298961482942104, -0.012307059019804, 0.002940106438472867, -0.035702966153621674, -0.023317817598581314, -0.016211582347750664, -0.001886861165985465, 0.017289232462644577, 0.019460147246718407, -0.011479300446808338, 0.015383823774755001, -0.0059700170531868935, -0.03717106580734253, -0.025707384571433067, 0.012424195185303688, 0.026706943288445473, -0.013267572037875652, -0.025582440197467804, 0.013790778815746307, -0.009956535883247852, 0.013400325551629066, -0.0021006339229643345, -0.02669132500886917, 0.03473464399576187, -0.013095772825181484, -0.0006266760756261647, 0.013415943831205368, 0.024754680693149567, -0.0368899405002594, 0.0063019017688930035, 0.03223574906587601, -0.032329458743333817, 0.012595994397997856, 0.027597174048423767, -0.016508327797055244, 0.03157978877425194, -0.007059379015117884, 0.016414618119597435, -0.00782856997102499, 0.0397324338555336, 0.026050982996821404, -0.007531826384365559, 0.0056381323374807835, 0.001995211699977517, -0.003514071460813284, -0.03454722836613655, -0.012564757838845253, 0.022193314507603645, 0.01685192435979843, -0.012119642458856106, -0.01949138380587101, 0.03838928043842316, -0.013806396164000034, 0.0050993082113564014, -0.00470495130866766, 0.006711876485496759, -0.0019532381556928158, 0.0160710196942091, -0.04041963070631027, 0.029924271628260612, -0.029565054923295975, -0.013587743043899536, 0.017570357769727707, -0.0006852439255453646, -0.018507443368434906, -0.017367321997880936, -0.04747901111841202, -0.02990865334868431, -0.010370415635406971, 0.0006017847335897386, -0.02801886387169361, 0.014220275916159153, 0.05175836756825447, 0.0020850158762186766, 0.010292325168848038, 0.008589952252805233, 0.022583765909075737, 0.017461031675338745, -0.017461031675338745, -0.015891412273049355, 0.0236457958817482, 0.0011781901121139526, -0.028253134340047836, -0.020412851125001907, 0.029299547895789146, -0.019085312262177467, -0.006723590195178986, -0.007434213533997536, 0.0005344317178241909, -0.019944308325648308, -0.002155297202989459, 0.011986888013780117, 0.029408873990178108, 0.004857227671891451, -0.03008045256137848, -0.011151320300996304, -0.0245984997600317, 0.03242316469550133, 0.05035274103283882, -0.019147785380482674, 0.022958600893616676, 0.0006715781055390835, -0.00936304870992899, 0.05263298377394676, 0.03757713735103607, 0.02594165690243244, -0.0217716246843338, 0.019350821152329445, 0.003925998695194721, -0.011846325360238552, -0.020287906751036644, -0.0007135517662391067, 0.002889347728341818, 0.0065088411793112755, -0.01693001575767994, -0.006422942038625479, -0.022536911070346832, -0.0028346844483166933, 0.010917048901319504, 0.03857669606804848, 0.00031236192444339395, -0.005642036907374859, 0.016352146863937378, -0.026035364717245102, 0.013361280784010887, -0.004630765412002802, -0.03104877471923828, -0.018382498994469643, -0.009089731611311436, -0.024473555386066437, 0.028440551832318306, 0.007133565377444029, 0.014118758030235767, -0.031017538160085678, -0.006461987271904945, 0.005107117351144552, 0.03888905793428421, 0.05403861030936241, -0.02828437089920044, 0.004474584478884935, -0.006247238256037235, 0.0019708084873855114, 0.014532637782394886, 0.019225874915719032, 0.00841815397143364, -0.013017682358622551, -0.022849272936582565, 0.03389126807451248, 0.009964345023036003, 0.0044433483853936195, 0.0075825853273272514, 0.04501135274767876, 0.023989394307136536, -0.012697511352598667, -0.007469354197382927, -0.020084870979189873, -0.026988068595528603, 0.005778695456683636, 0.02375512383878231, 0.01881980523467064, 0.011791662313044071, -0.0009117063018493354, 0.01319729071110487, 0.0044980114325881, 0.013712688349187374, 0.005751363933086395, -0.02517637051641941, -0.03267305716872215, 0.030876975506544113, 0.02581671252846718, -0.007992560043931007, 0.003084573894739151, -0.014313984662294388, -0.034109920263290405, 0.010893621481955051, 0.024551646783947945, 0.00865242537111044, 0.002219721907749772, 0.019319584593176842, -0.016398999840021133, 0.001131335855461657, 0.013337853364646435, -0.026144692674279213, -0.0009463589522056282, -0.018335644155740738, -0.02912774868309498, 0.009081922471523285, 0.02536378800868988, -0.019553855061531067, -0.013681451790034771, 0.020959483459591866, 0.004814277868717909, -0.007324886973947287, 0.014548256061971188, 0.008121409453451633, -0.019335202872753143, 0.08546222001314163, 0.001523740473203361, -0.04332459717988968, 0.020319141447544098, -0.007777811493724585, 0.015852367505431175, -0.014657583087682724, 0.013236336410045624, -0.058130551129579544, 0.017179904505610466, -0.017835864797234535, 0.041200537234544754, 0.0007345385383814573, 0.0030650512780994177, 0.018288789317011833, 0.01529011595994234, -0.014868427067995071, 0.016336528584361076, 0.02612907439470291, -0.008152646012604237, 0.03573420271277428, 0.01721114106476307, -0.03058023191988468, 0.02070959471166134, -0.006704067345708609, 0.0060988664627075195, -0.012697511352598667, 0.021693535149097443, -0.014079713262617588, 0.02809695340692997, 0.019834982231259346, -0.023224107921123505, -0.03204833343625069, -0.01078429538756609, 0.0034515990410000086, -0.018335644155740738, -0.05666245147585869, 0.005591278430074453, -0.010870194993913174, 0.018226318061351776, 0.004048991482704878, 0.0016799214063212276, 0.0047674234956502914, 0.011479300446808338, -0.009370856918394566, 0.02761279232800007, 0.005739650223404169, 0.013447180390357971, -0.009769118390977383, 0.0044003985822200775, 0.018601151183247566, -0.015688376501202583, 0.0015120268799364567, 0.003980662208050489, 0.015469723381102085, -0.008808606304228306, 0.0006227715639397502, 0.026347726583480835, 0.015743039548397064, -0.010612496174871922, -0.034203629940748215, 0.02714424952864647, -0.010612496174871922, 0.03150169923901558, 0.0015852367505431175, -0.053039051592350006, 0.018960367888212204, 0.03036157786846161, -0.013447180390357971, 0.03792073577642441, -0.0022743851877748966, -0.002344666514545679, 0.0004678107798099518, 0.017008105292916298, -0.0007999393274076283, -0.014360838569700718, 0.008441580459475517, 0.01625843718647957, -0.01386106014251709, 0.024098722264170647, -0.018772950395941734, -0.015422869473695755, -0.009027259424328804, -0.007020333781838417, 0.011697953566908836, 0.014540446922183037, 0.025426259264349937, -0.004072418436408043, -0.020881393924355507, 0.005321865901350975, -0.02990865334868431, -0.002467659069225192, 0.03564049303531647, -0.004173935856670141, 0.0024871816858649254, -0.011900988407433033, 0.01276779267936945, -0.011861943639814854, -0.022177696228027344, 0.013017682358622551, 0.007836379110813141, -0.018038900569081306, 0.035140715539455414, 0.007539635524153709, -0.03838928043842316, -0.00036653719143942, -0.05447591841220856, -0.01366583351045847, 0.008176073431968689, 0.031080009415745735, -0.020022397860884666, -0.002438375260680914, 0.02848740667104721, 0.03150169923901558, -0.0009248841088265181, -0.0006520554888993502, -0.004427730105817318, 0.03370384871959686, -0.024536028504371643, -0.03064270317554474, 0.010261088609695435, -0.018382498994469643, 0.010401651263237, 0.0059504942037165165, 0.024614118039608, 0.004447252489626408, 0.00683682132512331, -0.0016291625797748566, -0.021349936723709106, 0.0021435837261378765, -0.01064373180270195, -0.00964417401701212, -0.012783410958945751, -0.015867985785007477, 0.01713305152952671, 0.0023856640327721834, -0.020475324243307114, -0.01060468703508377, -0.029362019151449203, 0.004654192365705967, 0.015719613060355186, -0.0139625770971179, -0.008535289205610752, 0.009901872836053371, -0.004244217649102211, -0.0048103732988238335, 0.00022585230180993676, -0.009722264483571053, 0.006684544961899519, -0.0002437887160340324, 0.0198505986481905, -0.019335202872753143, 0.012424195185303688, 0.015633713454008102, -0.009542656131088734, -0.006793871521949768, 0.0005027074366807938, -0.02024105191230774, 0.015633713454008102, -0.005396051798015833, 0.02572300285100937, -0.020475324243307114, -0.001982521964237094, 0.029924271628260612, 0.04141918942332268, 0.0002742928045336157, -0.0034359809942543507, 0.008917932398617268, -0.0007267295150086284, -0.011604244820773602, -0.016117874532938004, 0.033360254019498825, -0.016555180773139, -0.012330486439168453, -0.02420804835855961, -0.0096988370642066, -0.004630765412002802, 0.027222340926527977, -0.036952413618564606, 0.009675410576164722, -0.00014324721996672451, -0.024864008650183678, 0.034765880554914474, -0.011619863100349903, -0.04785384610295296, 0.001979593653231859, 0.01619596593081951, 0.007320982404053211, 0.006235524546355009, -0.004868941381573677, -0.004989981651306152, -0.011861943639814854, -0.006094961892813444, -0.04401179403066635, 0.028315607458353043, -0.014181231148540974, 0.0004458478360902518, -0.029346400871872902, -0.01788271963596344, 0.018523061648011208, -0.034203629940748215, -0.013306617736816406, 0.03867040574550629, 0.000281369750155136, -0.002760498318821192, 0.0165395624935627, 0.004537056665867567, -0.018210699781775475, 0.002701930468901992, 0.01372049655765295, 0.0359216183423996, 0.007894947193562984, 0.002141631441190839, 0.0241299569606781, 0.0013607265427708626, -0.019413292407989502, 0.013064537197351456, -0.01438426598906517, -0.01504803542047739, -0.012666275724768639, -0.008917932398617268, -0.0034379332792013884, 0.028143808245658875, 0.0146653912961483, -0.024286137893795967, 0.02534816972911358, -0.007289746310561895, -0.023692650720477104, -0.0022041036281734705, 0.02052217721939087, 0.0170393418520689, -0.025972893461585045, -0.008488435298204422, -0.002516465727239847, 0.012471049092710018, -0.007360027637332678, 0.02070959471166134, -0.02979932725429535, 0.010386033914983273, 0.010065862908959389, -0.04526124149560928, 0.014485783874988556, -0.022739946842193604, 0.004166127182543278, -0.0106359226629138, 0.03995108976960182, -0.009784736670553684, 0.034765880554914474, -0.0241143386811018, 0.011221601627767086, 0.0070242383517324924, 0.030876975506544113, 4.554261249722913e-05, -0.028799768537282944, -0.006426846142858267, -0.0016564942197874188, -0.020365996286273003, -0.018148226663470268, 0.03129866346716881, 0.0011020518140867352, -0.049353182315826416, -0.01788271963596344, 0.012689702212810516, -0.0013011825503781438, 0.022443203255534172, 0.011049802415072918, -0.025207607075572014, -0.013993813656270504, -0.0407007560133934, -0.010346988216042519, -0.010799912735819817, 0.00707109272480011, -0.01578989438712597, -0.011932224966585636, 0.0023270961828529835, 0.022271404042840004, 0.006313615012913942, -0.0022392445243895054, 0.032985419034957886, -0.03763961046934128, 0.037327248603105545, -0.011198174208402634, -0.01253352127969265, -0.012549139559268951, 0.003426219802349806, -0.01409533154219389, -0.030736412853002548, -0.010245470330119133, -0.0005310152773745358, 0.022365113720297813, -0.0255512036383152, -0.004162222612649202, 0.023692650720477104, -0.00776219367980957, -0.019147785380482674, -0.005751363933086395, 0.030705176293849945, -0.04182526096701622, -0.0009766190778464079, 0.017648447304964066, 0.01083895843476057, 0.0018966224743053317, -0.011432445608079433, -0.011713571846485138, 0.028534261509776115, 0.024457937106490135, -0.02620716392993927, 0.048572275787591934, 0.0016418523155152798, -0.02639458142220974, -0.0010044387308880687, 0.02117813751101494, -0.005216443911194801, -0.002998674288392067, -0.03867040574550629, 0.03167349845170975, -0.01786710135638714, 0.03342272341251373, -0.015126125887036324, 0.02024105191230774, -0.0359216183423996, 0.015477532520890236, 0.008019892498850822, 0.02423928491771221, 0.007352218497544527, 0.00657521840184927, -0.005204730201512575, -0.01129969209432602, -0.01693001575767994, 0.011900988407433033, 0.024676591157913208, -0.0032309936359524727, 0.04938441887497902, -0.020131725817918777, 0.019741272553801537, -0.009753501042723656, 0.006208193022757769, 0.011432445608079433, 0.018007664009928703, -0.03935760259628296, -0.005111021921038628, 0.035328131169080734, 0.007902756333351135, -0.0015862127766013145, -0.0264882892370224, 0.030205396935343742, -0.04185649752616882, -0.00636046938598156, -0.018944749608635902, 0.0022021515760570765, 0.01685192435979843, 0.05050892010331154, 0.012666275724768639, -0.018491825088858604, 0.029190219938755035, 0.021880952641367912, 0.03664005175232887, -0.022958600893616676, -0.02953381836414337, -0.002403234364464879, -0.0060129668563604355, 0.006286283489316702, 0.02848740667104721, 0.029955508187413216, -0.009487993083894253, 0.0017326325178146362, 0.008730515837669373, -0.010339179076254368, 0.01366583351045847, -0.02422366663813591, -0.031064392998814583, 0.03229822218418121, 0.02828437089920044, -0.003137284889817238, -0.011057611554861069, -0.01883542351424694, -0.023895686492323875, -0.02166229858994484, 0.009199058637022972, 0.006005157716572285, 0.05288287252187729, -0.023208489641547203, -0.02562929503619671, -0.015461914241313934, 0.04398055747151375, 0.0008487458690069616, -0.004868941381573677, 0.02726919576525688, -0.014220275916159153]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
" train for a total of 5500 gradient updates. For each method, we used a coarse
grid search over learning rates between 0.000001 and 0.001, using the best one found, which was usually 0.0001 or 0.00003.
We run each learning method over 5 different random seeds, reporting the average KL divergence and 95% confidence
intervals over these 5 seeds. See also App. G.1 for details common across experiments.
H. Additional Experimental Results
H.1. Qualitative Results
Toxicity Controlled Generation when No Exact Posterior Samples are Available In Sec. 7.2.1 we targeted σ(s1:T)∝
p0(s1:T)eβlogp(a|s1:T)withβ= 1. We can also target β >1; higher βproduces a more peaked distribution of text that is
more likely to be of class a. However, for β̸= 1we can no longer generate exact posterior samples and thus cannot upper
bound logZσ. Our twist learning (Sec. 4.1) with approximate positive sampling (Sec. 4.1.2) can learn meaningful twists in
this setting, which we illustrate with a qualitative example of a story (200 tokens upper limit) and β= 10 :
“Once upon a time, there was a little girl named Lily. She had a big thumb that she liked to suck on. One day, Lily went to the park to play
with her friends. She was having so much fun until her thumb got stuck in her shoe. She tried to pull it out, but it hurt too much.
Lily started to cry and her friends tried to help her, but they couldn’t get her thumb out either. She was scared and didn’t know what to do.
Her friends tried to help her, but they couldn’t get it out either. Sadly, Lily had to go to the hospital and get a big bandage on her thumb.
She couldn’t play with her friends anymore. From that day on, Lily never went to the park again. ”
The story is coherent and follows the general style of the TinyStories base model, while having a high probability ( ≈88%)
of being toxic according to the toxicity classifier, likely due to the presence of negative words such as ‘suck’, ‘hurt’, ‘cry’,
and ‘scared’. This supports the ability of our methods to control outputs based on the chosen posterior distribution.
Sentiment Controlled Generation when No Exact Posterior Samples are Available As above, we also consider
σ(s1:T)∝p0(s1:T)eβlogp(a|s1:T), where β >1, except now p(a|s1:T)is based on the sentiment classifier in Sec. 7.2.2. In
Table 6 we provide qualitative examples showing 20 tokens produced with twisted SMC with 500 particles, for β= 100 ,
using twists trained with Sec. 4.1. These illustrate our framework’s ability to learn reviews that embody each rating class.14
Infilling In Table 7 we compare qualitative results on an example set of conditioning tokens for DPG, SIXO, and CTL
(in that order, to reflect increasing KL divergence). The qualitative results correlate with the quantitative measures of KL
divergence; the lowest KL divergence (DPG) corresponds to infilled tokens that respect grammar and the topic. SIXO, which
has higher KL divergence, fails to respect grammar. CTL generates incorrect grammar and is less on-topic, corresponding to
the highest KL divergence among these methods.
14The results are slightly incoherent; this is a result of the base GPT2-Medium model often being incoherent. Qualitatively, we find that
these generations are more coherent than the uncontrolled ones from p0.
44
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
Table 8: KL Divergences (averaged over conditioning tokens drawn from the base model) for Infilling Experiments
(Sec. 7.2.3 ) with 2 Output Tokens and 1 Conditioning Token
Proposal qoT Twist Learning EoT[DKL(qoT∥σoT)]EoT[DKL(σoT∥qoT)]
Twisted Contrastive 0.47±0.10 0 .25±0.01
Twisted RL 0.42±0.10 0 .15±0.01
Twisted SIXO 0.47±0.11 0 .25±0.02
Twisted FUDGE 2.62±0.33 0 .90±0.02
DPG – ","[0.008959608152508736, 0.030716484412550926, 0.011292601935565472, 0.010601063258945942, -0.028573473915457726, 0.01135339681059122, 0.02317795157432556, 0.017493654042482376, -0.04501841962337494, 0.0353216789662838, 0.04152273014187813, -0.014727498404681683, -0.03416657820343971, 0.03243393450975418, 0.02077656425535679, -0.03498730808496475, 0.041005976498126984, -0.008944408968091011, -0.05173622816801071, 0.04583914950489998, -0.017417659983038902, -0.03957730159163475, -0.007306754123419523, 0.030746882781386375, 0.009103994816541672, -0.021490899845957756, 0.04942603036761284, -0.01104942336678505, 0.020457392558455467, -0.011421790346503258, 0.03814862668514252, -0.026840828359127045, -0.024849804118275642, -0.05696456506848335, -0.012151326052844524, 0.03963809460401535, 0.016353754326701164, 0.06717806309461594, -0.011239406652748585, 0.00940036866813898, 0.005790688097476959, -0.03690233826637268, -0.04045882448554039, 0.022645998746156693, -0.01574580743908882, 0.026992814615368843, 0.02685602568089962, 0.008404857479035854, -0.017083289101719856, 0.027950329706072807, -0.046143122017383575, 0.055718276649713516, -0.012014538049697876, -0.011414190754294395, -0.018785540014505386, 0.003225914901122451, -0.025579338893294334, 0.004517800640314817, 0.012949255295097828, -0.07173766195774078, 0.02697761543095112, -0.051645033061504364, 0.02956138737499714, -0.01150538306683302, 0.00325441244058311, -0.034865718334913254, -0.06529343128204346, 0.003377901390194893, 0.004483603872358799, 0.022463614121079445, 0.01718967966735363, 0.0030929266940802336, 0.002712960122153163, -0.0005466766888275743, -0.020457392558455467, 0.02861906960606575, 0.03334585204720497, 0.037479888647794724, 0.0017649439396336675, -0.053377680480480194, 0.016916105523705482, -0.01304804626852274, 0.011756161227822304, 0.004301219712942839, -0.02080696076154709, -0.048726893961429596, -0.0284974817186594, -0.00838965829461813, -0.039972465485334396, -0.03586883097887039, -0.04225226491689682, -0.005304330959916115, -0.03137002885341644, -0.01636895351111889, 0.04112756624817848, -0.010882237926125526, 0.02247881330549717, 0.009195187129080296, -0.001370728830806911, 0.0037521682679653168, 0.013754784129559994, -0.0006093711126595736, 0.009544756263494492, 0.0018485365435481071, 0.04048922285437584, -0.002591370837762952, -0.037358298897743225, 0.02767675369977951, -0.048179741948843, 0.005095349624752998, -0.01633855514228344, -0.003499490674585104, -0.0528913252055645, 0.04313378781080246, 0.01684011146426201, -0.0441976934671402, -0.039242930710315704, 0.003885156475007534, -0.010935433208942413, 0.0007789311348460615, -0.05538390576839447, -0.026430463418364525, -0.005467716604471207, 0.012538891285657883, 0.014453922398388386, -0.016505740582942963, 0.03234273940324783, -0.05550549551844597, -0.005653900094330311, -0.023466724902391434, -0.0054563176818192005, 0.0021734079346060753, -0.00940036866813898, -0.006185853388160467, 0.004012445453554392, -0.0017563947476446629, -0.018998321145772934, 0.033862605690956116, -0.009035601280629635, 0.015852198004722595, -0.0441368967294693, -0.044349681586027145, -0.01801040768623352, 0.0011759960325434804, -0.02097414620220661, -0.017356865108013153, -0.031157245859503746, 0.01677931658923626, -0.039151739329099655, 0.04936523735523224, -0.027281587943434715, -0.014788292348384857, -0.07471659779548645, 0.0355040617287159, -0.021262921392917633, -0.03787505254149437, -0.03447055444121361, 0.06839395314455032, 0.005821085534989834, -0.05456317588686943, -0.00875442661345005, 0.03814862668514252, 0.004145433660596609, -0.01895272545516491, 0.014476720243692398, 0.007827308028936386, -0.0022494010627269745, 0.03687193989753723, -0.06058184430003166, -0.08304546028375626, 0.03237313777208328, -0.03778386116027832, -0.027904734015464783, -0.045261599123477936, -0.027555163949728012, -0.019226299598813057, -0.051432251930236816, -0.06657011806964874, -0.023162752389907837, 0.0023424930404871702, -0.020107822492718697, 0.053164899349212646, -0.042677827179431915, 0.0019682259298861027, -0.007036977913230658, -0.009734739549458027, -0.019180703908205032, 0.026749635115265846, 0.018086401745676994, 0.02515377663075924, 0.006926787551492453, 0.022235633805394173, 0.08517327159643173, 0.015449434518814087, -0.02279798500239849, -0.008716429583728313, 0.08389658480882645, 0.058484431356191635, 0.007986893877387047, 0.03038211353123188, 0.01172576379030943, 0.06395594775676727, -0.027889534831047058, -0.08590281009674072, -0.005239736754447222, -0.006102260667830706, -0.004198628943413496, -0.026460861787199974, -0.057724498212337494, 0.01128500234335661, 0.03425777330994606, 0.000711962056811899, 0.03368022292852402, -0.003786365268751979, -0.02471301518380642, 0.015593821182847023, -0.04228266328573227, 0.0013640794204548001, 0.006516424007713795, 0.05006437376141548, 0.011984140612185001, 0.018177593126893044, 0.02685602568089962, 0.011087420396506786, -0.04033723473548889, 0.012006938457489014, 0.010015914216637611, -0.0153202461078763, 0.042617034167051315, -0.027524767443537712, 0.041644319891929626, 0.011292601935565472, -0.01583700068295002, -0.06231449171900749, 0.005342327989637852, -0.029667777940630913, -0.018086401745676994, -0.014111952856183052, -0.003925052937120199, -0.03422737494111061, 0.01128500234335661, 0.0006677909987047315, 0.04161392152309418, 0.00930157769471407, -0.0012861862778663635, 0.03766227141022682, -0.03279870003461838, -0.008199675008654594, 0.020047027617692947, 0.0001623169082449749, 0.0062086512334644794, -0.005817285738885403, -0.016916105523705482, -0.014605908654630184, -0.02905983105301857, -0.003051130333915353, -0.012158925645053387, -0.010479473508894444, -0.035656049847602844, 0.02691682055592537, 0.007926099002361298, -0.012090531177818775, -0.03459214046597481, 0.002623668173328042, -0.03179559111595154, 0.002619868377223611, 0.004244224634021521, 0.015761006623506546, 0.028755858540534973, -0.03802703693509102, -0.0071623669937253, -0.01791921630501747, 0.0044646053574979305, 0.02779834344983101, -0.025792120024561882, -0.06608375906944275, -0.0012111429823562503, 0.04772378131747246, -0.02298036776483059, 0.021855667233467102, -0.003733169985935092, -0.01615617237985134, 0.0395469032227993, -0.02103494107723236, -0.0007917550392448902, 0.03282909840345383, 0.005053553264588118, 0.010844241827726364, -0.003603981342166662, -0.042708225548267365, 0.020700570195913315, -0.021749276667833328, 0.033801812678575516, -0.021612489596009254, 0.00021301867673173547, 0.02820870652794838, 0.014788292348384857, 0.0010591563768684864, -0.03249472752213478, -0.041796304285526276, 0.02909022942185402, -0.010008315555751324, -0.022630799561738968, 0.009529558010399342, 0.028603872284293175, 0.013200033456087112, 0.01671852171421051, 0.0067406040616333485, -0.013845976442098618, 0.005011756904423237, -0.03434896469116211, -0.0026084694545716047, -0.029454996809363365, 0.02808711677789688, -0.005372724961489439, -0.0034842919558286667, 0.0486053042113781, -0.005931275896728039, 0.01703769341111183, -0.03693273663520813, -0.030397312715649605, -0.01303284801542759, 0.00946116354316473, 0.0033987995702773333, -0.020457392558455467, -0.008055288344621658, -0.05444158613681793, -0.006018667947500944, 0.023512322455644608, -0.0012785870349034667, -0.019910240545868874, -0.024074671790003777, 0.05352966859936714, 0.022083647549152374, -0.03462253883481026, -0.04255623742938042, -0.03599041700363159, 0.07447341829538345, 0.011862551793456078, 0.0437721312046051, -0.09161750227212906, 0.0019102811347693205, 0.04027643799781799, -0.055900659412145615, -0.025868114084005356, 0.010015914216637611, 0.007314353249967098, 0.04948682710528374, 0.061189793050289154, 0.025260167196393013, -0.007834907621145248, -0.029546188190579414, -0.0009019452845677733, 0.03802703693509102, 0.02814791165292263, -0.001376428292132914, -0.031187642365694046, 0.007105371914803982, -0.024576228111982346, -0.015973787754774094, -0.016581734642386436, 0.006884991191327572, 0.010950632393360138, 0.02647605910897255, 0.029424598440527916, 0.006398634519428015, -0.03951650857925415, 0.012196921743452549, -0.003860458731651306, -0.012196921743452549, -0.03076208010315895, 0.025290563702583313, 0.002454583067446947, 0.0020632175728678703, -0.05897078663110733, -0.009149591438472271, 0.010053911246359348, 0.014431124553084373, 0.017873620614409447, 0.01577620580792427, -0.0024944795295596123, 0.011596575379371643, -0.0005727993557229638, 0.005919876508414745, -0.006774801295250654, 0.01589779555797577, 0.004810374695807695, 0.009028001688420773, -0.05380324274301529, 0.030306121334433556, -0.014887084253132343, -0.01892232708632946, -0.028923043981194496, 0.026339272037148476, -0.007295355200767517, 0.0001977012725546956, 0.005133346188813448, 0.029667777940630913, 0.022752389311790466, 0.05453278124332428, -0.016064979135990143, -0.03267711028456688, -0.06754282861948013, -0.01363319531083107, -0.031278833746910095, 0.019971035420894623, 0.027311986312270164, 0.003824362065643072, 0.04200908541679382, 0.028695063665509224, 0.03371062129735947, -0.006569619290530682, 0.02764635533094406, -0.02921181730926037, -0.017387263476848602, -0.04058041423559189, 0.022691594436764717, 0.024925796315073967, 0.04228266328573227, 0.09873047471046448, -0.05444158613681793, -0.054198410362005234, -0.026217682287096977, -0.012318511493504047, -0.029333407059311867, 0.002182906959205866, 0.007652523461729288, -0.02074616588652134, 0.025108180940151215, -0.031187642365694046, -0.009088796563446522, 0.05544469878077507, 0.013397615402936935, -0.03428816795349121, -0.022721990942955017, -0.02474341355264187, 0.02339073270559311, 0.006793799344450235, 0.0017297971062362194, -0.05076351389288902, 0.0012491395464166999, -0.004244224634021521, 0.007903301157057285, -0.02550334483385086, -0.04775417968630791, 0.051371458917856216, -0.0023823895025998354, -0.041005976498126984, 0.038239818066358566, -0.058484431356191635, 0.007591729052364826, 0.0008136031101457775, 0.03611200675368309, -0.01880073733627796, -0.02203805185854435, -0.04146193340420723, 0.07483818382024765, -0.031005259603261948, 0.05556628853082657, -0.03617280349135399, 0.028421487659215927, 0.013055645860731602, -0.05550549551844597, 0.005095349624752998, -0.004008645657449961, 0.025761723518371582, 0.018207989633083344, -0.006394834723323584, 0.02326914295554161, 0.01410435326397419, 0.0029029434081166983, -0.0483013316988945, -0.03237313777208328, -0.05048993602395058, 0.006425232160836458, 0.004665987566113472, 0.06839395314455032, -0.03504810109734535, 0.02679523080587387, -0.0042822216637432575, 0.011452187784016132, -0.011041823774576187, 0.0437721312046051, 0.019971035420894623, 0.004886368289589882, 0.08468691259622574, -0.00345199485309422, -0.02159729041159153, -0.0196518637239933, -0.0024222859647125006, -0.01772163435816765, -0.04523120075464249, 0.021323714405298233, -0.019256697967648506, 0.04061080887913704, 0.005745091941207647, -0.015145461075007915, -0.013716787099838257, -0.002711060456931591, -0.05100668966770172, 0.03182598575949669, 1.7588288756087422e-05, -0.004453206434845924, 0.02512338012456894, 0.025746524333953857, -0.008838018402457237, 0.05176662281155586, -0.022235633805394173, 0.018846334889531136, 0.024135466665029526, 0.0008492249180562794, -0.005277733318507671, -0.014096753671765327, 0.007572730537503958, -0.00517894234508276, 0.008936810307204723, -0.019910240545868874, 0.0120601337403059, 0.0021012143697589636, 0.030336517840623856, 0.0024773809127509594, -0.01295685488730669, -0.02978936769068241, -0.027281587943434715, 0.012713676318526268, -0.020913351327180862, -0.0010059610940515995, -0.1061474159359932, -0.04222186654806137, -0.02874065935611725, 0.020229412242770195, -0.015312646515667439, 0.020730966702103615, 0.01715928316116333, -0.06717806309461594, 0.008617638610303402, -0.030199730768799782, -0.03608161211013794, -0.027099205181002617, -0.0019435281865298748, 0.011847352609038353, 0.026156887412071228, 0.021870866417884827, -0.00690398970618844, 0.02959178388118744, -0.012759272009134293, 0.03592962399125099, -0.02921181730926037, -0.014096753671765327, 0.013162036426365376, 0.04647749289870262, -0.02943979762494564, -0.007462540175765753, -0.03179559111595154, -0.02389228716492653, 0.0004996558418497443, -0.0016699524130672216, 0.0007556581986136734, -0.01104942336678505, 0.006296043284237385, 0.031035656109452248, -0.01555582508444786, 0.020472589880228043, 0.001783942338079214, -0.031400423496961594, 0.004445606842637062, 0.03316346928477287, 0.00012918858556076884, 0.034865718334913254, 0.052404966205358505, -0.05714694783091545, 0.010874638333916664, 0.033133070915937424, -0.005441118963062763, -0.017995208501815796, -0.028512679040431976, 0.034926511347293854, -0.004419009201228619, -0.0007015129667706788, -0.026308873668313026, -0.017144083976745605, -0.00815407931804657, 0.021080536767840385, -0.008967207744717598, -0.04194829240441322, 0.01350400596857071, 0.01583700068295002, -0.003655276959761977, -0.009962718933820724, 0.00784250721335411, 0.03182598575949669, 0.0087696248665452, -0.0008753476431593299, -0.0036780748050659895, -0.020882954820990562, 0.008724029175937176, 0.017052892595529556, -0.03547366335988045, -0.01471989881247282, -0.03026052564382553, -0.0008729728288017213, 0.0069153886288404465, -0.007561331614851952, -0.021323714405298233, -0.01948467828333378, 0.06936667114496231, -0.033133070915937424, 0.003434896469116211, 0.02386189065873623, -0.008382058702409267, 0.008382058702409267, -0.0018855832749977708, -0.015441834926605225, -0.008678432554006577, 0.005524711683392525, -0.0353216789662838, 0.013617996126413345, 0.009749937802553177, 0.05808926373720169, -0.0348961167037487, -0.01977345161139965, -0.051310665905475616, -0.020092623308300972, -0.029135825112462044, 0.019180703908205032, 0.0004094137984793633, 0.0010078608756884933, -0.02691682055592537, 0.018268784508109093, 0.008822820149362087, -0.05739012733101845, 0.01037308294326067, -0.010745449922978878, -0.004278421867638826, 0.01150538306683302, -0.013906770385801792, 0.003527988214045763, 0.01501627266407013, -0.002222803421318531, -0.018223188817501068, 0.021232523024082184, 0.02112613245844841, -0.011133016087114811, -0.025108180940151215, 0.017022496089339256, -0.0007822558400221169, -0.002008122391998768, 0.010145103558897972, 0.010851840488612652, -0.02723599225282669, -0.03358903154730797, -0.03152201324701309, 0.022630799561738968, -0.0013564800610765815, 0.016475344076752663, -0.009772736579179764, -0.007941298186779022, -0.011247006244957447, -0.025457749143242836, 0.00014604958414565772, 0.004460805561393499, 0.01448431983590126, -0.02758556231856346, 0.004145433660596609, -0.0015132162952795625, 0.05739012733101845, 0.022311627864837646, 0.03240353614091873, -0.005547509528696537, -0.0032810100819915533, -0.005087750498205423, 0.054927945137023926, 0.029682977125048637, -0.006676009856164455, 0.010221096687018871, 0.00791850034147501, -0.011019025929272175, -0.050459541380405426, -0.006299843080341816, 0.03860458731651306, -0.023907486349344254, 0.01081384439021349, -0.04036763310432434, -0.020351001992821693, 0.011490183882415295, -0.010684655979275703, 0.012348907999694347, 0.01426393911242485, -0.011262204498052597, -0.014590710401535034, -0.025168975815176964, -0.0067900000140070915, 0.014856686815619469, -0.021840469911694527, -0.027129601687192917, -0.01930229365825653, -0.02912062592804432, 0.037449490278959274, -0.0014372229343280196, -0.07806029915809631, 0.02679523080587387, 0.0007447341922670603, -0.017554448917508125, -0.025807319208979607, -0.014218343421816826, -0.007587929256260395, -0.0032240150030702353, 0.023117156699299812, 0.04045882448554039, -0.03185638412833214, -0.009765136986970901, 0.020609378814697266, -0.03358903154730797, 0.021582093089818954, -0.026187285780906677, -0.0109886284917593, -0.0009218935156241059, -0.00809328444302082, -0.005893278867006302, -0.02270679362118244, 0.004711583722382784, -0.01501627266407013, -0.0486053042113781, -0.012842864729464054, -0.023086760193109512, -0.0176912359893322, -0.05124986916780472, 0.00034030742244794965, -0.026719238609075546, -0.011847352609038353, 0.02465222030878067, 0.016703324392437935, 0.019089512526988983, -0.021490899845957756, -0.026156887412071228, 0.044501665979623795, 0.003786365268751979, 0.02871026284992695, -0.014826289378106594, 0.006022467743605375, 0.02779834344983101, -0.008002093061804771, -0.015791404992341995, 0.03641597926616669, 0.012538891285657883, 0.015327844768762589, 0.04222186654806137, 0.03541287034749985, 0.003909854218363762, -0.025016989558935165, -0.03602081537246704, 0.01624736376106739, -0.0028725459706038237, 0.0049243648536503315, -0.010699854232370853, -0.011877750046551228, 0.02594410628080368, -0.011771359480917454, -0.0018570858519524336, 0.004791376646608114, 0.031339630484580994, 0.03371062129735947, -0.009248382411897182, 0.008359260857105255, -0.002275998704135418, 0.015039070509374142, -0.01763044111430645, -0.00484077213332057, -0.01775203086435795, 0.010046311654150486, -0.02985016070306301, 0.0011588975321501493, -0.008214874193072319, 0.016824912279844284, 0.06052105128765106, -0.02462182380259037, 0.014355131424963474, -0.018785540014505386, -0.003284809645265341, -0.010228696279227734, 0.00678620021790266, 0.011262204498052597, -0.0036438778042793274, -0.03592962399125099, -0.03620319813489914, -0.027311986312270164, 0.0017506952863186598, 0.005881879944354296, -0.019727855920791626, -0.024059472605586052, -0.011360995471477509, 0.02823910303413868, 0.027539964765310287, 0.006307442672550678, -0.031218040734529495, 0.02735758200287819, -0.03334585204720497, -0.1325322836637497, -0.03620319813489914, 0.026339272037148476, -0.011816955171525478, 0.02782873995602131, -0.017767230048775673, -0.002606569556519389, 0.004213827662169933, -0.019499875605106354, -0.016475344076752663, 0.006884991191327572, -0.03602081537246704, -0.022600403055548668, 0.0019036317244172096, 0.022721990942955017, -0.03450094908475876, -0.0054487185552716255, -0.03982048109173775, 0.012964454479515553, -0.022372422739863396, -0.010563066229224205, -0.003567884676158428, 0.004601393360644579, 0.03319386765360832, -0.025776920840144157, -0.013200033456087112, 0.030868470668792725, 0.022630799561738968, 0.004468405153602362, 0.018299182876944542, -0.003567884676158428, -0.033102672547101974, 0.03434896469116211, 0.015525427646934986, -0.02562493458390236, 0.001539813936688006, -0.029865359887480736, -0.01760004460811615, -0.002631267299875617, -0.014294336549937725, 0.0309140682220459, -0.022995566949248314, 0.037449490278959274, -0.015654616057872772, 0.023877089843153954, -0.03614240512251854, -0.0013973264722153544, -0.018223188817501068, 0.025488147512078285, -0.029318207874894142, 0.02541215345263481, 0.006482227239757776, 0.0197126567363739, -0.031278833746910095, 0.001160797430202365, 0.012766871601343155, 0.0058134859427809715, -0.01898312196135521, 0.01301764976233244, 0.03787505254149437, -0.008138880133628845, 0.007850105874240398, 0.036567967385053635, -0.009020403027534485, -0.038452599197626114, -0.033133070915937424, -0.015137861482799053, -0.009985517710447311, -0.005144745111465454, -0.018147196620702744, -0.007819708436727524, 0.022114045917987823, 0.01842077262699604, -0.00021741203090641648, -0.04036763310432434, 0.0023652908857911825, 0.018967922776937485, 0.019849445670843124, -0.0574813187122345, 0.020168617367744446, 0.026111291721463203, -0.036567967385053635, 0.02874065935611725, 0.022190038114786148, -0.004255624022334814, 0.04064120724797249, -0.013154436834156513, 0.010099506936967373, -0.03708472102880478, 0.05535350739955902, 0.06571899354457855, -0.01624736376106739, 0.0069723837077617645, -0.032069165259599686, -0.0026901622768491507, 0.0014685702044516802, -0.017828024923801422, 0.011619373224675655, 0.012842864729464054, 0.013131638988852501, -0.006436631083488464, 0.02065497450530529, -0.033923402428627014, -0.013944767415523529, 0.0017582945292815566, 0.05486714839935303, -0.006501225288957357, 0.014803491532802582, 0.01706809177994728, -0.002606569556519389, 0.0011095019290223718, -0.009028001688420773, -0.03349784016609192, 0.01772163435816765, -0.02524496801197529, 0.005490514449775219, 0.05884919688105583, 0.011247006244957447, 0.024257056415081024, 0.01166496891528368, 0.023147553205490112, 0.018238388001918793, -0.0036191800609230995, 0.005699496250599623, -0.0397292897105217, -0.013952367007732391, 0.0003690423909574747, -0.007424543611705303, -0.004992758855223656, -0.004175831098109484, 0.001977725187316537, -0.028755858540534973, 0.024865001440048218, 0.0020784162916243076, 0.0011408491991460323, 0.01580660231411457, 0.05018596351146698, -0.0057982876896858215, -0.01015270221978426, 0.0530737079679966, 1.714301652100403e-05, -0.0008729728288017213, 0.049638811498880386, 0.022554805502295494, 0.006584818009287119, -0.024226658046245575, 0.012523693032562733, -0.029652578756213188, 0.0038756574504077435, -0.013245629146695137, 0.032038766890764236, -0.003546986496075988, -0.007652523461729288, 0.012409702874720097, 0.012645281851291656, 0.012728874571621418, 0.008503648452460766, -0.029257412999868393, -0.0242722537368536, 0.00791850034147501, -0.002124012215062976, 0.03143082186579704, 0.007223161403089762, -0.02600490115582943, 0.013063245452940464, -0.011163413524627686, -0.009787934832274914, -0.02547294832766056, -0.029895758256316185, 0.01851196400821209, -0.02097414620220661, -0.06492865830659866, 0.019499875605106354, -0.00666841072961688, 0.005646300967782736, 0.038239818066358566, -0.0175392497330904, 0.01541143748909235, 0.004118836019188166, 0.03161320462822914, 0.019104711711406708, 0.01037308294326067, -0.03617280349135399, -0.012174123898148537, 0.0613417774438858, -0.02544255182147026, 0.01478069368749857, 0.043498553335666656, -0.026491258293390274, 0.028664665296673775, -0.006660811137408018, 0.034835319966077805, -0.002211404498666525, 0.03276830166578293, 0.015517828054726124, -0.03355863317847252, 0.01182455476373434, 0.028892645612359047, 0.0015141661278903484, -0.0309140682220459, -0.01012230571359396, 0.01595858857035637, 0.015502629801630974, -0.013921969570219517, -0.012858062982559204, 0.021354112774133682, -0.028831850737333298, 0.00815407931804657, -0.0025001789908856153, 0.010167901404201984, 0.009035601280629635, 0.01778242737054825, -0.014833888970315456, 0.02956138737499714, -0.0121361268684268, -0.018268784508109093, 0.010996228083968163, 0.01706809177994728, -0.03453134745359421, -0.019697459414601326, -0.04228266328573227, -0.02518417313694954, 0.0074321432039141655, -0.020426994189620018, -0.019180703908205032, 0.01350400596857071, 0.03334585204720497, 0.00032795852166600525, 0.008716429583728313, 0.00906599871814251, 0.0007974545005708933, 0.0026502658147364855, -0.022463614121079445, 0.004016244783997536, -0.00404664222151041, -0.02556413970887661, -0.01456031296402216, 0.004555797204375267, -0.0037540681660175323, -0.01639935001730919, 0.01595858857035637, -0.0017744431970641017, 0.0029523391276597977, -0.020259808748960495, -0.00837446004152298, 0.002146810293197632, 0.014317134395241737, 0.03808783367276192, -0.02767675369977951, -0.02773754857480526, -0.02241801843047142, 0.011961342766880989, 0.03498730808496475, 0.0009869628120213747, 0.008100884035229683, 0.006976183503866196, 0.017676036804914474, 0.053256090730428696, 0.0396076999604702, 0.017584845423698425, -0.007048376835882664, 0.019591068848967552, -0.008822820149362087, -0.02367950603365898, -0.010084308683872223, -0.029257412999868393, 0.013063245452940464, 0.014757895842194557, -0.003917453810572624, 0.002775654662400484, -0.015502629801630974, 0.004893967416137457, 0.01948467828333378, 0.05109788477420807, -0.009514358825981617, -0.02232682704925537, 0.018344778567552567, -0.03273790702223778, 0.028573473915457726, 0.007363749202340841, -0.033984195441007614, -0.02855827473104, -0.029196619987487793, -0.002177207497879863, 0.03778386116027832, -0.024728214368224144, -0.005935075227171183, 0.00018095900304615498, 0.006702607497572899, 0.005471516400575638, 0.023983480408787727, 0.033011481165885925, -0.02950059249997139, 0.004532999359071255, -0.002220903756096959, 0.013086043298244476, 0.01813199743628502, 0.0442584864795208, 0.013131638988852501, -0.029515791684389114, -0.00650882488116622, 0.007648724131286144, 0.008442853577435017, -0.008860817179083824, 0.014970676973462105, 0.0036438778042793274, 0.03161320462822914, -0.016900906339287758, -0.0175088532269001, -0.018633553758263588, -0.029926154762506485, 0.009635948576033115, 0.008070486597716808, 0.028223905712366104, 0.0015607120003551245, -0.004069440066814423, -0.005517112091183662, -0.017584845423698425, 0.010471873916685581, 0.0017098488751798868, -0.021399708464741707, -0.02141490764915943, 0.026278477162122726, 0.02074616588652134, -0.01936308853328228, -0.012310911901295185, 0.0009318676311522722, -0.010175500996410847, 0.01700729690492153, 0.029257412999868393, 0.011186211369931698, 0.0015911093214526772, 0.0060262675397098064, -0.024789009243249893, -0.02758556231856346, 0.013937167823314667, -0.04115796089172363, 0.006189652718603611, -0.040975578129291534, -0.03720631077885628, 0.022250832989811897, 0.0026445661205798388, -0.034774526953697205, -0.029515791684389114, 0.0033152068499475718, 0.013131638988852501, -0.009628348983824253, -0.0032753103878349066, 0.036628760397434235, -0.021521298214793205, 0.09246862679719925, 0.00462039140984416, -0.02056378312408924, 0.024044275283813477, -0.012523693032562733, 0.013800379820168018, -0.014993474818766117, -0.008344062604010105, -0.046295106410980225, 0.03331545367836952, -0.02036619931459427, 0.027783144265413284, -0.0010534569155424833, 0.014788292348384857, 0.03629439324140549, 0.013914369978010654, -0.007287755608558655, 0.012158925645053387, 0.02893824130296707, -0.0197126567363739, 0.03599041700363159, 0.01448431983590126, -0.031096450984477997, 0.005425920244306326, -0.019727855920791626, 0.00807808618992567, -0.017296070232987404, 0.01989504136145115, 0.0059806713834404945, 0.04045882448554039, 0.0034443954937160015, -0.035625651478767395, -0.042525842785835266, 0.004441807512193918, -0.012234918773174286, -0.015244252048432827, -0.04015485197305679, 0.008465651422739029, -0.0197126567363739, 0.008306065574288368, -0.002838349202647805, -0.003621079958975315, -0.005087750498205423, 0.009658746421337128, -0.008040089160203934, 0.02779834344983101, 0.021962057799100876, -0.003377901390194893, -0.011292601935565472, 0.0025343759916722775, 0.023405931890010834, -0.005585506092756987, 0.0004044267407152802, -0.012584487907588482, 0.02024461142718792, -0.04568716138601303, -0.01627776026725769, 0.02909022942185402, 0.015852198004722595, -0.009970318526029587, -0.030655689537525177, 0.015609020367264748, -0.012242517434060574, 0.008701231330633163, 0.010730251669883728, -0.040063656866550446, 0.004172031302005053, 0.02912062592804432, -0.002036619931459427, 0.04684225842356682, -0.024317851290106773, -0.0035887828562408686, -0.010198298841714859, -0.016931302845478058, 0.003436796134337783, 4.939563223160803e-05, 0.0019853245466947556, 0.03273790702223778, 0.0056311022490262985, 0.04550477862358093, -0.02012302167713642, -0.019727855920791626, -0.003446295391768217, -0.009597951546311378, -0.007143368478864431, 0.0016652027843520045, 0.03419697657227516, -0.012181723490357399, -0.013982764445245266, 0.018846334889531136, -0.013245629146695137, 0.006717806216329336, 0.03869577869772911, 0.001942578237503767, -0.014970676973462105, -0.029363803565502167, 0.010791046544909477, -0.021794874221086502, 0.02162768878042698, 0.019560670480132103, -0.008207274600863457, -0.033771414309740067, 0.01473509706556797, 0.007040777709335089, -0.001383077702485025, 0.02074616588652134, -0.05459357425570488, -0.01927189715206623, 0.00966634601354599, 0.050702717155218124, -0.0017753930296748877, -0.009658746421337128, 0.019575869664549828, 0.02500179037451744, -0.005482915323227644, 0.011459787376224995, -0.01073785126209259, 0.03957730159163475, -0.0037768662441521883, -0.009278779849410057, 0.005551309324800968, -0.004627991002053022, 0.010023513808846474, 0.008800022304058075, 0.01457551121711731, -0.01427913736552, -0.014203144237399101, -0.01164977066218853, -0.010965830646455288, 0.003062529256567359, -0.020548583939671516, 0.009164789691567421, -0.0062162503600120544, -0.0176608394831419, 0.021612489596009254, -0.013397615402936935, 0.00016837261500768363, -1.2326644537097309e-05, -0.03903014957904816, 0.00042484994628466666, 0.026369668543338776, 0.0018741843523457646, -0.0004578595398925245, 0.007234560325741768, 0.017174482345581055, -0.006470827851444483, -0.0016471544513478875, 0.001854236121289432, 0.0038471599109470844, 0.0017459456576034427, 0.007534733973443508, -0.006277045235037804, -0.023953082039952278, 0.02370990440249443, -0.00883041974157095, 0.010342685505747795, 8.240521856350824e-05, -0.040063656866550446, 0.01810159906744957, 0.0027205594815313816, 0.022843580693006516, -0.030868470668792725, 0.007173765916377306, 0.00012562639312818646, 0.026217682287096977, 0.005847683176398277, -0.015502629801630974, -0.004259423352777958, 0.014628706499934196, 0.004985159263014793, -0.023132355883717537, 0.008192075416445732, 0.0033684023655951023, -0.011125416494905949, -0.03255552053451538, -0.012219719588756561, -0.009126793593168259, 0.028482282534241676, -0.03805743530392647, 0.013397615402936935, 0.00906599871814251, -0.028603872284293175, 0.0307924784719944, -0.009202786721289158, -0.05966992676258087, -0.007865305058658123, 0.0037160716019570827, 0.0039326525293290615, -0.005973071791231632, -0.0016177069628611207, -0.00928637944161892, -0.0046393899247050285, -0.005384123884141445, -0.009362372569739819, 0.02191646210849285, 0.017493654042482376, -0.0002586146292742342, -0.007188964635133743, -0.004251824226230383, 0.03574724122881889, -0.02770715020596981, -0.018633553758263588, 0.026172086596488953, -0.0006929637747816741, -0.01615617237985134, 0.024424241855740547, -0.027023211121559143, -0.04583914950489998, -0.0033171067479997873, -0.007230760995298624, 0.01618656888604164, 0.006128858309239149, 0.011702965945005417, 0.01568501442670822, 0.02235722355544567, -0.004255624022334814, 0.021308517083525658, 0.005946474149823189, -0.021369311958551407, -0.014621107839047909, -0.0153202461078763, 0.01076824776828289, 0.02071576938033104, 0.02112613245844841, -0.013146838173270226, 0.00019164556579198688, -0.009050799533724785, 0.004255624022334814, 0.0034633937757462263, 0.03444015607237816, 0.017113687470555305, -0.011877750046551228, -0.02206844836473465, 0.002775654662400484, -0.0033551035448908806, -0.004810374695807695, 0.0007789311348460615, -0.04550477862358093, -0.00039943968295119703, 0.012478097341954708, -0.026749635115265846, 0.021810071542859077, -0.008853217586874962, 0.0012994850985705853, -0.017934415489435196, 0.06058184430003166, 0.002046119188889861, 0.03592962399125099, -0.018435969948768616, -0.011406592093408108, 0.007390346843749285, 0.015669815242290497, 0.009316776879131794, -0.023725103586912155, -0.0005210289382375777, -0.03410578519105911, -0.02317795157432556, -0.029014235362410545, 0.014309534803032875, 0.01907431334257126, -0.06267926096916199, -0.012326110154390335, 0.02858867309987545, -0.007819708436727524, 0.0050497534684836864, 0.017296070232987404, -0.011908147484064102, -0.012652881443500519, -0.006334040313959122, -0.009157190099358559, -0.005319529678672552, 0.017022496089339256, -0.018724745139479637, 0.005228337831795216, 0.011794157326221466, 0.03866538405418396, 0.023588314652442932, -0.001900781993754208, 0.016642529517412186, -0.033923402428627014, 0.024789009243249893, -0.006846994627267122, -0.012789669446647167, -0.005239736754447222, 0.021080536767840385, -0.012888460420072079, -0.018344778567552567, -0.0001770405942806974, -0.002619868377223611, 0.03188678249716759, -0.03772306442260742, -0.0014163247542455792, 0.023405931890010834, -0.027084005996584892, -0.022600403055548668, 0.006600016728043556, 0.03510889783501625, -0.032859496772289276, -0.0028421487659215927, 0.020047027617692947, 0.0016993997851386666, -0.012272914871573448, -0.011474985629320145, 0.00906599871814251, 0.015274649485945702, 0.052313774824142456, 0.002904843306168914, 0.04456246271729469, -0.001992923906072974, 0.01939348503947258, 0.000915719079785049, 0.014347531832754612, -0.00587048102170229, 0.00924078281968832, -0.02647605910897255, 0.03963809460401535, -0.019317492842674255, 0.027570363134145737, -0.016019383445382118, 0.012478097341954708, -0.02497139200568199, 0.015168258920311928, -0.002350092167034745, -0.003936451859772205, 0.019287094473838806, -0.004833173006772995, -0.006501225288957357, 0.022205237299203873, -0.014537515118718147, -0.01150538306683302, 0.019910240545868874, 0.011459787376224995, 0.026688840240240097, -0.01035788469016552, 0.01801040768623352, -0.008420055732131004, -0.00022038051974959671, 0.005969272460788488, 0.0198038499802351, -0.03802703693509102, -0.012424902059137821, 0.017144083976745605, 0.020411795005202293, -0.010441477410495281, -0.026248080655932426, 0.016414549201726913, -0.00648602657020092, -0.010259092785418034, -0.005277733318507671, -0.00018250261200591922, 0.02121732383966446, 0.014529915526509285, 0.012652881443500519, -0.009970318526029587, 0.042586635798215866, 0.02291957475244999, 0.000484219694044441, -0.01624736376106739, -0.03796624392271042, 0.009392770007252693, -0.00807808618992567, -0.012668080627918243, 0.061250586062669754, 0.016490543261170387, -0.01275167241692543, 0.018268784508109093, 0.026962416246533394, -0.030184531584382057, 0.011163413524627686, -0.008214874193072319, -0.00563490204513073, 0.016946502029895782, 0.011581376194953918, 0.02071576938033104, -0.01144458819180727, -0.02779834344983101, -0.033801812678575516, -0.021399708464741707, 0.01051747053861618, -0.0077969105914235115, 0.039151739329099655, -0.039182137697935104, -0.023755500093102455, -0.015700211748480797, 0.011976541019976139, 0.014621107839047909, -0.012820066884160042, 0.03179559111595154, -0.026187285780906677]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"0.16±0.07 0 .14±0.01
PPO – 0.52±0.04 1 .09±0.34
H.2. Infilling with Fewer Tokens
We consider the same setting as Sec. 7.2.3 but only generating 2 tokens, conditioned on 1 token. We show KL divergence
evaluations in Table 8. Our evaluation reveals interesting differences among learning methods, even in this easier setting
where most methods achieve low KL divergence in both directions. DPG and RL learns best, while FUDGE learns notably
slower. PPO suffers on DKL(σ∥q), though this may be unsurprising since PPO does not make use of exact σsamples.
H.3. Approximate vs. Exact Posterior Sampling
In our toxicity and sentiment experiments, we train using approximate σsamples to reflect the more common real-world
setting where the amount of exact samples needed for training are not available. However, here we run an additional ablation
experiment for insight into the effect of positive versus approximate sampling. We use rejection sampling (Sec. 4.1.2) to
generate exact posterior samples for training. This is much slower than generating approximate samples, so is not a practical
strategy for training; we investigate this solely for understanding.
We provide a comparison of KL divergences (evaluated the same way as in the main paper) when training using exact versus
approximate σsamples for a selection of methods that performed well in our previous experiments and are able to make use
ofσsamples. Toxicity (Sec. 7.2.1) results are in Table 9 and sentiment (Sec. 7.2.2) results are in Table 10. The first two
columns of KL divergences are for exact σsamples. The next two are for training on the same number of samples, but using
approximate positive sampling (Sec. 4.1.2). Overall, for a constant number of samples, having exact σsamples improves
performance for most methods. Note however that there is an additional time cost required for rejection sampling to generate
exact samples, so the exact σtraining requires significantly more wall-clock time for any given number of samples.
We also plot the single-sample KL divergence in both directions as a function of training time for exact vs. approximate
sampling, on toxicity and sentiment experiments, in Fig. 5. The approximate sampling results match those in the main
paper (with different colors). The exact σsample results cut off earlier because the time cost required for rejection sampling
reduces the number of gradient updates that can be made for a given amount of wall-clock time.
Table 9: KL Div. for Toxicity Experiments (Sec. 7.2.1), comparing exact σsamples versus approximate positive sampling.
Exact σSamples Same # of Approx. σSamples
Proposal qType of Twist Learning DKL(q∥σ)DKL(σ∥q)DKL(q∥σ) DKL(σ∥q)
Twisted Contrastive 2.54±0.02 2 .68±0.09 2 .99±0.18 3 .22±0.09
Twisted RL 3.23±0.10 3 .24±0.04 3 .48±0.15 3 .49±0.13
Twisted SIXO 2.37±0.06 2 .52±0.05 2 .70±0.17 3 .05±0.22
DPG – 1.51±0.01 1 .50±0.01 2 .35±0.15 2 .48±0.10
Table 10: KL Div. for Sentiment Experiments (Sec. 7.2.2), comparing exact σsamples versus approximate positive sampling.
Exact σSamples Same # of Approx. σSamples
Proposal q(s)Type of Twist Learning DKL(q∥σ)DKL(σ∥q)DKL(q∥σ) DKL(σ∥q)
Twisted Contrastive 0.71±0.02 0 .64±0.02 0 .70±0.02 0 .60±0.01
Twisted RL 1.28±0.05 0 .94±0.02 2 .09±0.08 1 .76±0.07
Twisted SIXO 0.68±0.02 0 .60±0.01 0 .86±0.02 0 .68±0.01
DPG – 0.70±0.02 0 .58±0.01 0 .89","[-0.015957724303007126, 0.016088884323835373, 0.03407229110598564, 0.02576553262770176, 0.013567709363996983, 0.025022296234965324, 0.005494120996445417, -0.004291826393455267, -0.02255941368639469, 0.022967465221881866, 0.0328189916908741, -0.030458122491836548, -0.008860545232892036, 0.02140812575817108, 0.03631657734513283, -0.005865739192813635, 0.04039708897471428, -0.023492103442549706, -0.0426996648311615, 0.02649419568479061, -0.02519717440009117, -0.040717702358961105, 0.016584375873208046, 0.003189723240211606, 0.003583201440051198, -0.03459693118929863, 0.071991927921772, -0.01266416721045971, 0.019834212958812714, -0.020373424515128136, 0.018129142001271248, -0.02902994304895401, -0.008044442161917686, -0.04538114741444588, -0.023725274950265884, 0.08248467743396759, 0.00933417584747076, 0.08580738306045532, -0.04194185510277748, -0.021612150594592094, 0.0013197913067415357, -0.04826665297150612, -0.03066214919090271, 0.015418513678014278, -0.01070406287908554, 0.018464326858520508, 0.006255574058741331, -0.011097541078925133, 0.006375803146511316, 0.01525820791721344, -0.05205570161342621, 0.05013202875852585, -0.002446486847475171, -0.020067386329174042, 0.012584013864398003, -0.008969844318926334, -0.009173870086669922, -0.0041169472970068455, 0.05336729437112808, -0.057476956397295, 0.04715908318758011, -0.04491480067372322, 0.03756987676024437, -0.03660804033279419, 0.013560422696173191, -0.017342185601592064, -0.07006825506687164, 0.013130511157214642, -0.01655522920191288, 0.019061829894781113, 0.04179612174630165, -0.00014903440023772418, 0.020169397816061974, 0.0017369509441778064, -0.002386372070759535, 0.03847341984510422, 0.04870384931564331, 0.04456504434347153, -0.016657240688800812, -0.03378082811832428, 0.016977854073047638, 0.011789770796895027, 0.04197100177407265, -0.0025758245028555393, -0.003891061758622527, -0.045556023716926575, -0.02907366305589676, -0.002712448826059699, -0.03022495098412037, 0.015345647931098938, -0.0271062720566988, -0.013349110260605812, -0.02279258519411087, -0.006266503594815731, 0.040571969002485275, -0.006663625128567219, 0.020431717857718468, 0.02044629119336605, 0.004543215036392212, 0.012489288114011288, 0.018916098400950432, 0.017575357109308243, -0.005271878559142351, 0.005494120996445417, 0.021480992436408997, 0.01184806413948536, -0.018347740173339844, 0.01569540612399578, -0.020796049386262894, 0.0032480163499712944, 0.004521355498582125, -0.00776026351377368, -0.0687275156378746, 0.04150465875864029, -0.00762910395860672, -0.041388072073459625, -0.07747147232294083, -0.005330171436071396, -0.02792237512767315, -0.002841786714270711, -0.057214636355638504, -0.04159209877252579, 0.013596856035292149, 0.022180508822202682, 0.011782484129071236, -0.0069332304410636425, 0.028782198205590248, -0.058992575854063034, -0.022952891886234283, -0.0196301881223917, -0.004106017295271158, 0.00784770306199789, -0.013407403603196144, 0.0045104254968464375, 0.00959649495780468, 0.018304020166397095, 0.004761814139783382, 0.027295725420117378, -0.021903617307543755, -0.030691295862197876, -0.008467067033052444, -0.03838597983121872, -0.0196301881223917, 0.03483010083436966, -0.026304742321372032, -0.003266233019530773, -0.040047332644462585, 0.004750884138047695, -0.0205337293446064, 0.048004332929849625, -0.03398485481739044, -0.003045812249183655, -0.05800159275531769, -0.011534739285707474, -0.023433810099959373, -0.021583005785942078, -0.0013571352465078235, 0.050306908786296844, -0.016730107367038727, -0.02955458126962185, -0.003386462340131402, 0.04782945290207863, 0.018172860145568848, -0.028971649706363678, 0.0017788491677492857, -0.007782123517245054, -0.009363322518765926, -0.006904084235429764, -0.056544266641139984, -0.07636390626430511, 0.03194459527730942, -0.0006143542123027146, 0.01611803099513054, -0.046809326857328415, -0.020664889365434647, -0.02427905797958374, 0.009866099804639816, -0.04529370740056038, -0.001362600247375667, 0.0009053640533238649, -9.854031668510288e-05, 0.04538114741444588, 0.00371800409629941, 0.04010562598705292, 0.0009317781077697873, -0.02164129726588726, -0.005501407198607922, -0.007767550181597471, 0.02174331061542034, 0.004565075039863586, 0.033372774720191956, 0.009938966482877731, 0.07822928577661514, -0.012722459621727467, -0.006689128465950489, -0.02749975025653839, 0.06989337503910065, 0.05316326767206192, 0.0063575864769518375, 0.0030767805874347687, -0.003315417794510722, 0.02346295677125454, -0.003792692208662629, -0.05083154886960983, -0.00796428881585598, -0.012467428110539913, -0.004758170805871487, -0.05835135281085968, -0.058322206139564514, 0.010441743768751621, 0.026377608999609947, 0.004838323686271906, 0.04223332181572914, -0.007745690178126097, -0.005909458734095097, 0.014500398188829422, -0.06732848286628723, 0.010011833161115646, 0.007519804406911135, 0.06831946223974228, 0.0033554942347109318, 0.017997981980443, 0.030720442533493042, 0.031245078891515732, -0.0303706843405962, -0.00417524017393589, 0.03984330594539642, -0.028869636356830597, 0.02519717440009117, -0.05368790775537491, 0.034422051161527634, 0.028476160019636154, -0.02682938054203987, -0.020169397816061974, 0.021918190643191338, -0.043690647929906845, -0.03386826813220978, -0.018741218373179436, -0.00545768765732646, -0.02817011997103691, 0.02500772289931774, -0.0027543469332158566, 0.02427905797958374, 0.0098806731402874, 0.001199561869725585, 0.018172860145568848, -0.036170843988657, -0.018697498366236687, 0.018012555316090584, -0.040717702358961105, -0.003222513245418668, 0.008314047940075397, -0.014835583046078682, -0.05336729437112808, -0.04943251237273216, -0.012044803239405155, -0.01444210484623909, -0.010245004668831825, -0.03838597983121872, 0.0271062720566988, -0.001594861620105803, -0.035529620945453644, -0.0014008550206199288, -0.0026996973901987076, -0.0493159256875515, 0.00609162449836731, -0.007122682873159647, 0.028374146670103073, -0.005603420082479715, -0.018886951729655266, 0.0018207472749054432, -0.022617707028985023, -0.007177332881838083, 0.016773827373981476, -0.05546584352850914, -0.04471077769994736, 0.00904271099716425, 0.02072318270802498, -0.026552489027380943, 0.0006667268462479115, 0.01670096069574356, 0.011906357482075691, 0.028665611520409584, -0.016613522544503212, 0.023783568292856216, 0.02312777191400528, 0.020067386329174042, 0.017983408644795418, -0.029102809727191925, -0.026188155636191368, 0.01152016595005989, -0.044215284287929535, 0.06336455792188644, -0.030545562505722046, 0.001411785022355616, 0.021655870601534843, 0.04835409298539162, -0.028330426663160324, -0.03654974699020386, -0.03902720287442207, 0.03430546447634697, -0.040426235646009445, -0.029962632805109024, 0.029350554570555687, 0.0237107016146183, 0.002765276934951544, 0.010922661982476711, 0.03654974699020386, -0.019367868080735207, -0.011993796564638615, -0.01890152506530285, -0.0026086142752319574, -0.0014582372969016433, 0.032556671649217606, -0.00197285576723516, -0.008510786108672619, 0.047771163284778595, 0.000185012147994712, 0.015811992809176445, -0.02961287461221218, -0.031157638877630234, -0.0378904864192009, 0.009683934040367603, -0.009574634954333305, -0.0004663444706238806, -0.021903617307543755, -0.043166011571884155, -0.023958446457982063, 0.01712358556687832, -0.015345647931098938, 0.0038327686488628387, -0.017473343759775162, 0.029350554570555687, 0.013064932078123093, -0.02269057370722294, -0.019018109887838364, -0.02720828540623188, 0.07158387452363968, 0.0016404030611738563, 0.032265208661556244, -0.07653878629207611, -0.007180976215749979, 0.02063574269413948, -0.053629614412784576, 0.005413967650383711, -0.0007268415647558868, 0.025488639250397682, 0.03920208290219307, 0.03853171318769455, 0.030866174027323723, -0.03007921762764454, -0.03806536644697189, 0.011017387732863426, 0.04645956680178642, 0.013115937821567059, 0.0004403858329169452, -0.008583652786910534, -0.027907801792025566, -0.015724552795290947, -0.010062838904559612, -0.0312742255628109, 0.001498313737101853, -0.006266503594815731, 0.012030229903757572, 0.049490805715322495, -0.004120590630918741, -0.019790492951869965, -0.031653132289648056, 0.008416060358285904, -0.010900801979005337, -0.018508046865463257, 0.03238179534673691, 0.010616622865200043, -0.015564247034490108, -0.06528822332620621, -0.015389367006719112, 0.019469881430268288, 0.021772457286715508, 0.04631383344531059, 0.02528461441397667, -0.01862463168799877, 0.011002814397215843, -0.028155546635389328, -0.017094438895583153, -0.008102735504508018, 0.014813723042607307, -0.01793968863785267, 0.004962196573615074, -0.0460515171289444, 0.028680184856057167, -0.010900801979005337, 0.002594041172415018, -0.022719720378518105, 0.013662436045706272, -0.00038345903158187866, 0.0015912182861939073, 0.003320882795378566, 0.058176472783088684, 0.030924467369914055, 0.04730481654405594, -0.035004980862140656, -0.02279258519411087, -0.06388919055461884, -0.0110392477363348, -0.02274886518716812, 0.0271062720566988, 0.001133982208557427, 0.004616081714630127, 0.04275795817375183, 0.038560859858989716, 0.031070200726389885, -0.004237176850438118, 0.033372774720191956, -0.0557573102414608, -0.024453938007354736, -0.04739225655794144, 0.005730936303734779, 0.043253447860479355, 0.02658163383603096, 0.04806262627243996, -0.011279706843197346, -0.03488839417695999, -0.032410942018032074, -0.025925837457180023, -0.030924467369914055, -0.002218779642134905, 0.01651150919497013, -0.027222858741879463, 0.030487269163131714, -0.04780030623078346, -0.013662436045706272, 0.06837775558233261, 0.0525803379714489, -0.04453589767217636, -0.056456826627254486, -0.018697498366236687, 0.01770651713013649, -0.005709076300263405, -0.0036269212141633034, -0.007541664410382509, 0.006532466039061546, -0.028898783028125763, -0.004572361707687378, -0.009399755857884884, -0.06103283166885376, 0.033460214734077454, -0.02360868826508522, -0.03876488283276558, 0.0408051423728466, -0.015811992809176445, -0.013494842685759068, -0.009086430072784424, 0.058234766125679016, 0.004335546400398016, -0.02634846232831478, -0.06651238352060318, 0.0739738941192627, -0.026275595650076866, 0.04917019605636597, -0.041096605360507965, 0.01514162216335535, -0.00729391910135746, -0.037977926433086395, 0.03555876389145851, -0.005669000092893839, 0.008845971897244453, -0.027966095134615898, -0.013349110260605812, 0.020081957802176476, -0.0002563983725849539, -0.01651150919497013, -0.08499127626419067, -0.018406033515930176, -0.0523180216550827, -0.014886589720845222, 0.014456678181886673, 0.06342285126447678, -0.01503960881382227, 0.03316875174641609, -0.009581921622157097, 0.013079505413770676, 0.011775197461247444, 0.016613522544503212, 0.018318593502044678, 0.04386552795767784, 0.07356584072113037, 0.02226794883608818, 0.009778660722076893, -0.02212221547961235, -0.03483010083436966, 0.003364602569490671, -0.034276317805051804, 0.0443318709731102, -0.018245726823806763, 0.005894885398447514, 0.01862463168799877, -0.002369977068156004, -0.002202384639531374, 0.02264685370028019, -0.0411548987030983, 0.035004980862140656, -0.020475436002016068, 0.02067946270108223, 0.023521248251199722, 0.020621169358491898, -0.007406861521303654, 0.004827393684536219, -0.03853171318769455, 0.0023535822983831167, 0.027324872091412544, 0.002858181484043598, 0.0010565617121756077, 0.02097092755138874, 0.0023590472992509604, -0.012941058725118637, 0.007344925310462713, -0.01603059098124504, -0.012008369900286198, -0.008751245215535164, 0.024104179814457893, -0.001809817273169756, -0.007854989729821682, -0.025838397443294525, -0.011665898375213146, -0.0002595862897578627, -0.012241542339324951, -0.020898060873150826, -0.12684570252895355, -0.0311867855489254, -0.036170843988657, 0.010521897114813328, -0.001200472703203559, 0.040134772658348083, 0.0005273700226098299, -0.04479821398854256, -0.008736671879887581, 2.721101736824494e-05, -0.030487269163131714, -0.012627733871340752, 0.0014327340759336948, 0.015811992809176445, 0.017342185601592064, 0.020621169358491898, -0.007927856408059597, 0.028578171506524086, 0.00047272027586586773, 0.06161576136946678, -0.012307122349739075, -0.01944073475897312, -0.005428540986031294, 0.03561705723404884, -0.006885867565870285, -0.015899430960416794, -0.019309574738144875, -0.018580911681056023, 0.014347379095852375, -0.03171142563223839, 0.012518434785306454, -0.014391099102795124, 0.0034793668892234564, 0.013808168470859528, -0.011920930817723274, -0.015768272802233696, 0.017240172252058983, -0.014194360002875328, 0.01827487349510193, 0.034567784518003464, -0.024060459807515144, 0.04188356176018715, 0.060100141912698746, -0.04074684903025627, 0.012627733871340752, 0.0271062720566988, -0.04060111567378044, -0.008161027915775776, -0.011454585939645767, 0.015287354588508606, -0.004729024600237608, 0.027470603585243225, -0.025794679298996925, -0.028009815141558647, 0.0007045262609608471, -0.0031004620250314474, -0.012722459621727467, -0.02768920361995697, 0.011308853514492512, 0.010274151340126991, -0.0003957552253268659, -0.020460862666368484, 0.0072574857622385025, 0.04127148538827896, -0.011935504153370857, 0.0033463858999311924, 0.002335365628823638, -0.012707887217402458, 0.017254745587706566, 0.0033573159016668797, -0.01760450378060341, -0.026858527213335037, -0.027601763606071472, -0.0031441817991435528, 0.019163843244314194, -0.007457868196070194, -0.051851674914360046, -0.039901599287986755, 0.06645409017801285, -0.013567709363996983, -0.006408593151718378, 0.028680184856057167, -0.016394922509789467, 0.010237718001008034, -0.014995889738202095, -0.019513601437211037, -0.009851526468992233, 0.006233714055269957, -0.02494942955672741, -0.011447299271821976, 0.003597774775698781, 0.04969483241438866, -0.03928952291607857, -0.036637187004089355, -0.04981141909956932, -0.009465334936976433, -0.01780852861702442, 0.03736585006117821, 0.017997981980443, 0.01862463168799877, -0.024541378021240234, 0.00021005995222367346, -7.337866554735228e-05, -0.058613669127225876, 0.02471625618636608, 0.0003852806694339961, -0.016628095880150795, 0.014864729717373848, -0.011789770796895027, -0.005705432966351509, 0.011928217485547066, -0.010259578004479408, -0.005887598730623722, 0.02126239240169525, 0.02321521006524563, 0.011316140182316303, -0.034043144434690475, 0.018872378394007683, 0.005009559914469719, 0.013815455138683319, -0.0070315999910235405, -0.002348117297515273, -0.04255393147468567, -0.03835683315992355, -0.02451223134994507, -0.009385182522237301, 0.004095087293535471, 0.033314481377601624, 0.005115215666592121, -0.026669073849916458, -0.009414329193532467, -0.03660804033279419, -0.010121132247149944, -0.03631657734513283, 0.03984330594539642, -0.021859897300601006, -0.001248746644705534, 0.004718094598501921, 0.0426996648311615, 0.026450475677847862, 0.04144636541604996, 0.023637834936380386, 0.021335259079933167, -0.0038254819810390472, 0.03905634954571724, 0.037161823362112045, 0.0071299695409834385, 0.014915736392140388, 0.018449753522872925, -0.016380349174141884, -0.041912708431482315, -0.019601041451096535, 0.02134983241558075, -0.009749514050781727, 0.011950076557695866, -0.021699590608477592, -0.03357680141925812, -0.002105836756527424, -0.019032683223485947, 0.04173782840371132, 0.011527452617883682, -0.008685666136443615, -0.01603059098124504, -0.01712358556687832, -0.00683850422501564, 0.024060459807515144, -0.032177768647670746, -0.008292187936604023, 0.0011603961465880275, -0.006328440271317959, 0.04019306227564812, -0.00562528008595109, -0.07409048080444336, 0.009246736764907837, -0.0032589463517069817, -0.00971308071166277, -0.03602511063218117, -0.03287728503346443, -0.006219140719622374, -0.01420164667069912, 0.0026213659439235926, 0.07205022126436234, -0.04147551208734512, 6.836910324636847e-05, 0.005512337200343609, -0.03902720287442207, 0.01732761226594448, 0.005475904326885939, -0.02288002520799637, -0.01655522920191288, -0.0032571246847510338, -0.010062838904559612, -0.011148547753691673, 0.006299293600022793, -0.033081311732530594, -0.0442444309592247, -0.017400477081537247, 0.008372340351343155, 0.008911550976336002, -0.07059289515018463, -5.59305954084266e-05, -0.016759254038333893, -0.006255574058741331, 0.007505231071263552, 0.04409869760274887, -0.004488565493375063, -0.030458122491836548, -0.004951266571879387, 0.036112550646066666, 0.010543757118284702, 0.045701757073402405, -0.023535821586847305, 0.013924754224717617, 0.03468437120318413, -0.02423533983528614, 0.003535838332027197, 0.009392469190061092, 0.012445568107068539, 0.020621169358491898, 0.03949354588985443, 0.02591126412153244, 0.0072720590978860855, -0.0062883635982871056, -0.03185715526342392, 0.01420164667069912, -0.009399755857884884, 0.011505592614412308, -0.0013607785804197192, -0.022369960322976112, 0.021626723930239677, -0.011782484129071236, 0.00883139856159687, -0.004375622607767582, 0.0391729362308979, 0.028519878163933754, -0.020708609372377396, 0.016147177666425705, -0.005013203248381615, 0.005876669194549322, -0.04100916534662247, -0.005031419452279806, -0.020358851179480553, -0.018070848658680916, -0.021480992436408997, 0.0063721598125994205, -0.007927856408059597, 0.02572181262075901, 0.07146728783845901, -0.006230070721358061, 0.011833490803837776, -0.02245740033686161, -0.005293738562613726, 0.0011521987617015839, -0.02417704649269581, -0.03465522453188896, 0.011614891700446606, -0.02174331061542034, -0.02038799785077572, -0.015243634581565857, 0.0027561686001718044, -0.008867831900715828, -0.019222136586904526, -0.01611803099513054, -0.02601327747106552, 0.043253447860479355, 0.001265141530893743, 0.002300754189491272, -0.010514610446989536, 0.047771163284778595, -0.04348662123084068, -0.11938418447971344, -0.03506327420473099, 0.01329081691801548, -0.012766179628670216, 0.029962632805109024, -0.016730107367038727, -0.017764810472726822, 0.01141815260052681, -0.025109734386205673, -0.0014700780156999826, 0.02509516105055809, -0.030195804312825203, -0.013458410277962685, 0.023390090093016624, 0.0004749973304569721, -0.020694036036729813, -0.012241542339324951, -0.012059376575052738, 0.019018109887838364, 0.00023146442254073918, -0.026596207171678543, -0.0069478037767112255, 0.023681554943323135, 0.05397937074303627, -0.007374071981757879, -0.014310945756733418, 0.013130511157214642, 0.010310584679245949, 0.003335455898195505, -0.012817186303436756, 0.0007446027593687177, -0.01678840070962906, 0.009086430072784424, -0.002411875408142805, -0.03421802446246147, -0.01592857763171196, -0.018099995329976082, -0.008911550976336002, -0.009064571000635624, -0.018639205023646355, 0.03777390345931053, -0.008547219447791576, 0.021583005785942078, -0.028155546635389328, 0.02423533983528614, -0.029190249741077423, 0.0013188804732635617, -0.016686387360095978, 0.04508968070149422, -0.00031970097916200757, 0.03733670338988304, 0.004521355498582125, 0.006168134044855833, -0.03386826813220978, 0.014048627577722073, 0.03104105405509472, 0.009560061618685722, 0.009290455840528011, -0.011090254411101341, 0.028199266642332077, -0.01751706376671791, 0.04281625151634216, 0.013472983613610268, -0.0039056348614394665, -0.03238179534673691, -0.02111666090786457, -0.04657615348696709, 0.0071044666692614555, -0.0016968745039775968, -0.0038072653114795685, -0.013647862710058689, 0.019324148073792458, 0.012511148117482662, 0.010398024693131447, -0.016467789188027382, 0.025546932592988014, 0.047333963215351105, 0.0072720590978860855, -0.0507732555270195, 0.03235264867544174, 0.023914726451039314, -0.05190996825695038, 0.03386826813220978, 0.012773466296494007, 0.002796245040372014, 0.00048410563613288105, 0.015345647931098938, -0.02159757912158966, -0.032935578376054764, 0.03535474091768265, 0.04654700681567192, -0.025984130799770355, 0.020854340866208076, -0.01482829637825489, 0.011279706843197346, -0.010645769536495209, -0.023011185228824615, 0.02038799785077572, 0.013137797825038433, 0.005443114321678877, 0.0019291358767077327, -0.0071445428766310215, 0.013574996031820774, -0.005865739192813635, 0.001298842253163457, 0.05351302772760391, 0.014580551534891129, -0.0038181953132152557, 0.021218672394752502, -0.0021331615280359983, 0.004892973694950342, 0.0016859445022419095, -0.032265208661556244, 0.012817186303436756, -0.010623909533023834, 0.007978862151503563, 0.04634298011660576, 0.03141995891928673, 0.013691581785678864, 0.011811630800366402, 0.005515980534255505, 0.011454585939645767, 0.023404663428664207, 0.027514323592185974, -0.019950799643993378, -0.008977130986750126, 0.005450400989502668, -0.006015114951878786, -0.002725200494751334, 0.008765818551182747, 0.014041340909898281, -0.013021212071180344, 0.0012860905844718218, 0.02153928577899933, 0.00981509406119585, 0.022442827001214027, 0.06488017737865448, 0.011155834421515465, -0.011753338389098644, 0.028344999998807907, -0.0021222317591309547, 0.010478177107870579, 0.017910541966557503, 0.04564346373081207, 0.0005706343799829483, 0.004637941252440214, 0.024395644664764404, -0.021145807579159737, 0.011228700168430805, -0.017473343759775162, 0.013531276024878025, -0.02825755998492241, 0.007195549551397562, 0.017444197088479996, 0.008168314583599567, 0.02289459854364395, 0.031303372234106064, -0.03993074595928192, -0.0007582652033306658, 0.017968835309147835, 0.007862276397645473, 0.02892792969942093, 3.839713826891966e-05, -0.014427532441914082, 0.030837027356028557, 0.011629465036094189, -0.03305216506123543, -0.034480344504117966, -0.010259578004479408, 0.011389005929231644, 0.01005555223673582, -0.061732348054647446, 0.020621169358491898, 0.01552052702754736, 0.01707986555993557, 0.03369338810443878, -0.02668364718556404, 0.017444197088479996, 4.303667083149776e-05, 0.03235264867544174, 0.012890052981674671, 6.609203410334885e-05, -0.014777290634810925, -0.014726283960044384, 0.0441569909453392, -0.02932140789926052, 0.022151362150907516, 0.01726931892335415, 1.2502551726356614e-05, 0.034859247505664825, -0.0007163670379668474, 0.027091698721051216, -0.0030294174794107676, 0.01584113948047161, 0.025984130799770355, 0.0011440012603998184, -0.003763545537367463, 0.018435180187225342, 0.012205109000205994, -0.04669274017214775, 0.020766902714967728, 0.005621636752039194, 0.027266578748822212, -0.012868192978203297, -0.023827288299798965, 0.027281152084469795, -0.028082681819796562, 0.002692410722374916, 0.009137436747550964, 0.018202006816864014, -0.008022582158446312, 0.016584375873208046, -0.012219682335853577, 0.012430994771420956, -0.01756078377366066, -0.008590939454734325, -0.015491380356252193, 0.03838597983121872, -0.04307857155799866, -0.012467428110539913, -0.028767624869942665, -0.03666633367538452, -0.0028308567125350237, -0.004011291079223156, -0.02591126412153244, -0.00844520702958107, 0.04319515824317932, -0.019178416579961777, 0.012124956585466862, 0.011221413500607014, -0.006543396040797234, 0.027179138734936714, -0.030312390998005867, 0.00417524017393589, -0.007490658201277256, -0.02484741620719433, -0.01617632433772087, 0.017823101952672005, 0.032265208661556244, -0.01910554990172386, 0.027149992063641548, -0.0019965372048318386, -0.007304849103093147, -0.002823570044711232, -0.002630474278703332, 3.022813871211838e-05, 0.02892792969942093, 0.049782272428274155, -0.03654974699020386, -0.02385643497109413, -0.014784577302634716, 0.010376164689660072, 0.011148547753691673, 0.007068033330142498, -0.007731116842478514, -0.0037854055408388376, -0.004320973064750433, 0.029933486133813858, 0.05634023994207382, 0.0006175420712679625, -0.0180854219943285, 0.030020924285054207, 0.0012778931995853782, -0.031886301934719086, -0.009953539818525314, -0.030924467369914055, 0.04701335355639458, 0.013166944496333599, -0.002018397208303213, -0.007978862151503563, -0.040280502289533615, -0.013574996031820774, 0.004663444589823484, 0.03013751097023487, -0.012037516571581364, -0.009924393147230148, 0.026465049013495445, -0.015097902156412601, 0.028053535148501396, -0.020213117823004723, -0.01958646811544895, -0.03742414340376854, -0.02777664177119732, -0.016569802537560463, 0.030837027356028557, -0.02629016898572445, 0.013021212071180344, 0.011257846839725971, 0.01420164667069912, 0.011556599289178848, 0.03503412753343582, 0.032556671649217606, 0.0021714165341109037, 0.018886951729655266, 0.022005628794431686, 0.007563524413853884, -0.00338828400708735, 0.06324797123670578, 0.01252572052180767, -0.03194459527730942, 0.014325519092381, -0.0019965372048318386, 0.02620272897183895, 0.0086127994582057, 0.033897414803504944, 0.014646130613982677, 0.008641946129500866, -0.012277975678443909, -0.021772457286715508, -0.02442479133605957, -0.0014409315772354603, -0.014995889738202095, 0.004167953506112099, 0.03561705723404884, -0.013239811174571514, 0.031740568578243256, 0.005475904326885939, -0.018974389880895615, -0.0015730017330497503, 0.013021212071180344, -0.023448383435606956, -0.01659894920885563, 0.03156569227576256, 0.02350667677819729, 0.0009235806646756828, -0.011913644149899483, 0.011294280178844929, 0.010427170433104038, 0.013684295117855072, 0.008416060358285904, 0.015083328820765018, 0.010718636214733124, 0.0072720590978860855, -0.02107294090092182, -0.043166011571884155, 0.02505144104361534, -0.04363235458731651, 0.012890052981674671, -0.03882317617535591, -0.009144723415374756, 0.022821731865406036, 0.007993435487151146, -0.014128779992461205, -0.03984330594539642, -0.006160847842693329, -0.009224876761436462, 0.001399033353663981, -0.0037070740945637226, 0.01996537297964096, -0.004685304593294859, 0.09361865371465683, -0.004612438380718231, -0.018843231722712517, 0.00015973664994817227, -0.0013061288045719266, 0.017021572217345238, -0.026115290820598602, -0.023054905235767365, -0.027630910277366638, 0.027805788442492485, -0.016613522544503212, 0.049403365701436996, 0.013691581785678864, 0.016380349174141884, 0.02164129726588726, 0.00249567162245512, 0.004182526841759682, 0.02783493511378765, 0.035529620945453644, 0.008532646112143993, 0.020621169358491898, 0.02610071748495102, -0.014019480906426907, 0.02164129726588726, 0.0003930227248929441, -0.0026723723858594894, -0.007913283072412014, -0.0030822453554719687, -0.005505050532519817, 0.03051641583442688, 0.016540655866265297, -0.018435180187225342, -0.034771811217069626, 0.011221413500607014, -0.012897339649498463, -0.026975112035870552, -0.04581834375858307, 0.01871207170188427, 0.003275341121479869, -0.00315511180087924, 0.017968835309147835, 0.011440012603998184, 0.015097902156412601, 0.020650316029787064, -0.031594838947057724, 0.026027850806713104, 0.008824111893773079, -0.010740496218204498, -0.01317423116415739, 0.011614891700446606, 0.0068494342267513275, -0.003796335542574525, -0.00016770639922469854, -0.014230793341994286, 0.014697137288749218, -0.015068755485117435, -0.007935142144560814, 0.04121319204568863, 0.01273703295737505, -0.006036974955350161, -0.026712793856859207, 0.00543218431994319, -0.005862095858901739, -0.00042103073792532086, 0.011440012603998184, -0.025066014379262924, -0.02620272897183895, 0.029335981234908104, -0.005344744771718979, 0.03681206703186035, -0.029350554570555687, 0.009421615861356258, -0.026508769020438194, -0.016249189153313637, -0.004459418822079897, 0.00872938521206379, -0.018595485016703606, 0.02586754411458969, 0.012656880542635918, 0.009618354961276054, -0.007344925310462713, -0.029816899448633194, 0.013349110260605812, -0.023142343387007713, -0.02337551675736904, 0.011425439268350601, 0.01664266735315323, -0.027470603585243225, -0.022005628794431686, 0.029015369713306427, -0.017721090465784073, 0.025750959292054176, 0.015418513678014278, -0.0027069838251918554, -0.022282522171735764, -0.03139081224799156, 0.01789596863090992, -0.0029019012581557035, 0.011928217485547066, 0.009632928296923637, -0.02764548361301422, -0.004320973064750433, 0.012547580525279045, 0.005862095858901739, 0.005494120996445417, 0.030458122491836548, -0.05345473438501358, -0.019542748108506203, 0.015855712816119194, 0.02432277798652649, 0.033518508076667786, -0.009873386472463608, 0.006138987839221954, 0.01607431098818779, -0.010390738025307655, 0.02725200541317463, 0.004055011086165905, 0.03194459527730942, -0.0019637474324554205, 0.004561431705951691, 0.007395931985229254, 0.020854340866208076, 7.850207475712523e-05, 0.013983047567307949, 0.0237107016146183, -0.011491019278764725, -0.014252652414143085, -0.0023080408573150635, -0.006015114951878786, 0.027762068435549736, -0.0006585294031538069, 0.01360414270311594, 0.008882405236363411, -0.001350759412162006, 0.027237432077527046, 0.011950076557695866, -0.0026996973901987076, -0.0006708255968987942, -0.026654500514268875, -1.4231703971745446e-05, 0.020985500887036324, -0.004011291079223156, 0.010784216225147247, 0.0029146529268473387, 0.00042831734754145145, -0.0077894097194075584, -0.014063199982047081, -0.02024226449429989, 0.009028137661516666, 0.002543034730479121, 0.013633289374411106, -0.004488565493375063, -0.01163675170391798, 0.03724926337599754, 0.00017362678772769868, -0.008044442161917686, 0.01202294323593378, -0.04712993651628494, 0.0016194540075957775, -0.0042007435113191605, 0.04304942488670349, -0.018099995329976082, -0.004947623237967491, 0.0032771627884358168, 0.0025849328376352787, -0.01986335963010788, -0.018872378394007683, -0.016059737652540207, 0.010929948650300503, 0.013881034217774868, -0.02255941368639469, 0.016001444309949875, 0.0009481730521656573, 0.0004563253605738282, -0.031070200726389885, -0.005180795677006245, -0.020621169358491898, 0.01525820791721344, -0.051560211926698685, 0.022996611893177032, 0.0041315206326544285, -0.027456030249595642, 0.034188877791166306, 0.0046087950468063354, -0.032410942018032074, -0.007505231071263552, 0.004255393054336309, 0.003045812249183655, 0.010281438007950783, -0.007833129726350307, -0.02490570954978466, -0.00012444201274774969, 0.013523989357054234, -0.004637941252440214, 0.013225237838923931, 0.03410143777728081, 0.007869563065469265, 0.009807807393372059, 0.010842508636415005, 0.032993871718645096, -0.028374146670103073, -0.016715534031391144, 0.010121132247149944, 0.005964108742773533, -0.0023116841912269592, 0.028155546635389328, -0.02884049154818058, -0.03185715526342392, -0.0011731478152796626, -0.007180976215749979, 0.020941780880093575, 0.005647140089422464, 0.015403940342366695, 0.016103457659482956, 0.00759267108514905, -0.009866099804639816, 0.01944073475897312, 0.017473343759775162, -0.019950799643993378, -0.011534739285707474, -0.010638482868671417, -0.007239269092679024, 0.025415774434804916, -0.001102103153243661, 0.0006403127918019891, 0.009530914947390556, 0.006306580267846584, 0.033664241433143616, 0.005115215666592121, 0.01745877042412758, 0.006368516478687525, -0.019805066287517548, -0.0007095358450897038, -0.02126239240169525, -0.008008008822798729, 0.016671814024448395, 0.006157204508781433, -0.04506053403019905, 0.012336268089711666, 0.007428721524775028, -0.033897414803504944, 0.014602411538362503, 0.009057284332811832, 0.005738222971558571, -0.009246736764907837, 0.049257636070251465, -0.004167953506112099, 0.028272133320569992, -0.03899805620312691, 0.0006444115424528718, -0.01137443259358406, 0.019061829894781113, -0.001495581236667931, -0.026785660535097122, 0.027383163571357727, -0.03891061618924141, -0.007716543506830931, 0.0011886318679898977, 0.0026505126152187586, -0.011338000185787678, -0.05759354308247566, -0.0076072439551353455, 0.05596133694052696, 0.005975038278847933, -0.00021529721561819315, 0.012773466296494007, -0.023448383435606956, 0.009268596768379211, -0.02835957333445549, -0.006259217392653227, -0.004182526841759682, 0.01894524320960045, 0.010929948650300503, -0.00332270422950387, 0.017167305573821068, 0.02725200541317463, 0.017444197088479996, -0.003335455898195505, -0.007213766220957041, -0.017473343759775162, 0.04902446269989014, -0.024920282885432243, 0.006306580267846584, -0.008073588833212852, 0.021131234243512154, 0.007428721524775028, -0.0295108612626791, 0.003730755764991045, -0.0006767459562979639, 0.005359318107366562, -0.04712993651628494, 0.02304033190011978, 0.013611429370939732, -0.01986335963010788, -0.020023666322231293, 0.02615901082754135, 0.018872378394007683, -0.048441532999277115, -0.02532833442091942, 0.02226794883608818, 0.007752976845949888, -0.0037216474302113056, 0.002395480405539274, 0.025940410792827606, 0.0345386378467083, 0.041096605360507965, 0.0007291186484508216, 0.036491453647613525, -0.009071857668459415, 0.0302832443267107, -0.01180434413254261, -0.009654787369072437, -0.0073267086409032345, 0.021131234243512154, -0.020985500887036324, 0.031653132289648056, -0.023346370086073875, 0.029933486133813858, -0.01552052702754736, 0.03162398561835289, -0.02984604611992836, 0.00911557674407959, -0.0022479260805994272, -0.032789845019578934, 0.021043794229626656, -0.011600318364799023, 0.005239088553935289, -0.0021258750930428505, 0.0016567980637773871, -0.030574709177017212, 0.029496287927031517, 0.00011510602053022012, 0.044069550931453705, -0.003876488422974944, 0.0329064317047596, 0.00014402484521269798, 0.008977130986750126, 0.024541378021240234, 0.017444197088479996, -0.032119475305080414, -0.015680832788348198, 0.018129142001271248, 0.005661713425070047, -0.02049000933766365, -0.013793595135211945, 0.002847251482307911, -0.007457868196070194, -0.01036159135401249, 0.008758531883358955, 0.013975760899484158, 0.027572616934776306, 0.012868192978203297, 0.0008475264185108244, 0.015054182149469852, 0.03465522453188896, 0.00894798431545496, -0.008532646112143993, -0.016322055831551552, -0.03704524040222168, 0.018988963216543198, -0.009866099804639816, -0.020081957802176476, 0.02528461441397667, 0.028097255155444145, -0.011760624125599861, 1.716343467705883e-05, 0.020169397816061974, -0.03885232284665108, 0.00813188124448061, -0.013844601809978485, 0.004663444589823484, 0.015316501259803772, 0.0016895878361538053, 0.029335981234908104, -0.011148547753691673, -0.050598375499248505, -0.0008302206988446414, -0.029875192791223526, 0.025692665949463844, -0.004550501704216003, 0.03905634954571724, -0.0378904864192009, -0.012890052981674671, -0.023914726451039314, 0.02601327747106552, 0.009195730090141296, -0.009538201615214348, 0.025313761085271835, -0.019877932965755463]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
"±0.03 0 .69±0.00
45
Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo
0 4 16 64 256 1024
Number of Gradient Updates1.01.52.02.53.03.54.04.5KL DivergenceTwisted Proposal (Contrastive, Exact ) DKL(q||)
Twisted Proposal (Contrastive, Exact ) DKL(||q)
Twisted Proposal (Contrastive) DKL(q||)
Twisted Proposal (Contrastive) DKL(||q)
Twisted Proposal (RL, Exact ) DKL(q||)
Twisted Proposal (RL, Exact ) DKL(||q)
Twisted Proposal (RL) DKL(q||)
Twisted Proposal (RL) DKL(||q)
Twisted Proposal (SIXO, Exact ) DKL(q||)
Twisted Proposal (SIXO, Exact ) DKL(||q)
Twisted Proposal (SIXO) DKL(q||)
Twisted Proposal (SIXO) DKL(||q)
DPG Proposal (Exact ) DKL(q||)
DPG Proposal (Exact ) DKL(||q)
DPG Proposal DKL(q||)
DPG Proposal DKL(||q)
(a) Toxicity (Sec. 7.2.1)
0 4 16 64 256 1024
Number of Gradient Updates12345678KL DivergenceTwisted Proposal (Contrastive, Exact ) DKL(q||)
Twisted Proposal (Contrastive, Exact ) DKL(||q)
Twisted Proposal (Contrastive) DKL(q||)
Twisted Proposal (Contrastive) DKL(||q)
Twisted Proposal (RL, Exact ) DKL(q||)
Twisted Proposal (RL, Exact ) DKL(||q)
Twisted Proposal (RL) DKL(q||)
Twisted Proposal (RL) DKL(||q)
Twisted Proposal (SIXO, Exact ) DKL(q||)
Twisted Proposal (SIXO, Exact ) DKL(||q)
Twisted Proposal (SIXO) DKL(q||)
Twisted Proposal (SIXO) DKL(||q)
DPG Proposal (Exact ) DKL(q||)
DPG Proposal (Exact ) DKL(||q)
DPG Proposal DKL(q||)
DPG Proposal DKL(||q)
 (b) Sentiment (Sec. 7.2.2)
Figure 5: Training comparison for Exact versus Approximate σ(positive) sampling, as described in App. H.3. Having
access to exact target samples makes learning lead to lower KL divergences in a more reliable manner.
46
","[-0.01988864131271839, -0.01614045351743698, 0.03803393989801407, 0.041665904223918915, -0.015690090134739876, 0.027922548353672028, 0.0175206009298563, -0.005048431921750307, -0.05363686382770538, 0.024813586845993996, 0.03690076619386673, -0.03440197557210922, -0.020324477925896645, 0.01906055398285389, 0.0293172225356102, -0.009777250699698925, 0.030508508905768394, -0.010685241781175137, -0.027472184970974922, 0.04291529953479767, -0.04364169389009476, -0.04375791549682617, 0.006813566666096449, 0.01539953239262104, 0.02225668355822563, -0.034169528633356094, 0.060319676995277405, -0.04637293145060539, 0.01189105398952961, -0.019816001877188683, 0.01759324036538601, -0.03286202251911163, -0.008607757277786732, -0.03722038120031357, -0.011629552580416203, 0.0521550215780735, 0.020004864782094955, 0.07839233428239822, -0.03608720749616623, -0.007372889667749405, -0.0018323264084756374, -0.06409692019224167, -0.029535140842199326, 0.037685271352529526, -0.01743343286216259, 0.042421355843544006, 0.005625914316624403, -0.006239716429263353, 0.006526641547679901, 0.020106559619307518, -0.04625670984387398, 0.029840227216482162, -0.01661987230181694, 0.03138018026947975, 0.03658115491271019, 0.0005706725642085075, 0.02379663661122322, -0.015995174646377563, 0.042392298579216, -0.05366591736674309, 0.04497825726866722, -0.04829061031341553, 0.012225194834172726, 0.010031487792730331, -0.024799058213829994, -0.03315258026123047, -0.038237329572439194, 0.02477000281214714, -0.03286202251911163, 0.018697356805205345, 0.012610183097422123, -0.006221556570380926, 0.03477969765663147, 0.009428582154214382, -0.030828120186924934, 0.02680390328168869, 0.00721308309584856, 0.04294435679912567, -0.021573873236775398, -0.040736123919487, 0.003132570069283247, 0.01022034976631403, 0.038411665707826614, -0.02289590798318386, -0.01709929294884205, -0.04741893708705902, -0.025147726759314537, 0.013104130513966084, -0.04277002438902855, -0.015748200938105583, -0.010924951173365116, 0.010401948355138302, -0.019263943657279015, -0.025975815951824188, 0.037859607487916946, -0.011389843188226223, 0.038818445056676865, 0.006664656102657318, 0.005978215020149946, -0.007547223940491676, 0.028736108914017677, 0.0016371083911508322, 0.028954027220606804, -0.018755467608571053, 0.06241169199347496, 0.014186455868184566, -0.030101727694272995, 0.000450817693490535, -0.017404377460479736, 0.0022064188960939646, 0.014716723002493382, 0.0027493976522237062, -0.04529787227511406, 0.02418888919055462, -0.006552065256983042, -0.04024217650294304, -0.03309446573257446, 0.010125919245183468, -0.006733663380146027, 0.005346253048628569, -0.025627147406339645, -0.04422280937433243, 0.01250122394412756, 0.015021808445453644, 0.013031491078436375, -0.015878951177001, 0.03722038120031357, -0.06793227791786194, -0.0350412018597126, 0.013111394830048084, -0.007707030046731234, 0.03071189858019352, -0.002598671242594719, 0.03634870797395706, 0.003506662556901574, -0.00431477464735508, 0.011854734271764755, 0.03771432861685753, -0.01946733333170414, 0.01564650610089302, 0.00016514092567376792, -0.034750644117593765, -0.012602919712662697, 0.021370483562350273, -0.0134382713586092, 0.00204661232419312, -0.02615015022456646, 0.03544798120856285, -0.02581600844860077, 0.033268801867961884, -0.029375335201621056, -0.012050860561430454, -0.061075128614902496, 0.008869258686900139, -0.01622762158513069, -0.04271190986037254, -0.04616954177618027, 0.05017923191189766, 0.020484283566474915, -0.050876569002866745, -0.011244564317166805, 0.042159851640462875, 0.0529395267367363, -0.028692524880170822, -0.01792738027870655, 0.00551695516332984, -0.030973399057984352, 0.023651357740163803, -0.04451336711645126, -0.07560298591852188, 0.029956448823213577, 0.008992745541036129, -0.007648918777704239, -0.059680454432964325, 0.005044799763709307, -0.03323974460363388, 0.015704616904258728, -0.09838267415761948, 0.011012118309736252, 0.029636835679411888, -0.0026386226527392864, 0.04018406197428703, 0.012167084030807018, 0.025554507970809937, 0.0037409241776913404, -0.013845051638782024, -0.013278464786708355, 0.021704623475670815, 0.02477000281214714, -0.017549656331539154, 0.011092022061347961, 0.028881387785077095, 0.09896378964185715, 0.015312365256249905, -0.011426162905991077, -0.03135112300515175, 0.08054246008396149, 0.06607270985841751, 0.0036573889665305614, -0.00034685267019085586, 0.0030853545758873224, 0.02549639530479908, -0.018464911729097366, -0.05686204880475998, -0.008600493893027306, 0.004608964081853628, 0.0003030420921277255, -0.015312365256249905, -0.07101218402385712, 0.009719138965010643, 0.03103151172399521, -0.025438284501433372, 0.02599034272134304, 0.011549649760127068, -0.035244591534137726, 0.011585969477891922, -0.06938506662845612, 0.0012720958329737186, 0.00204842840321362, 0.05288141220808029, -0.013895899057388306, -0.00019396963762119412, 0.025627147406339645, 0.02818405069410801, -0.04959811642765999, 0.028736108914017677, 0.049656227231025696, -0.029142888262867928, 0.026542402803897858, -0.034576307982206345, 0.042566630989313126, -0.001418282394297421, -0.013300256803631783, -0.03161262720823288, 0.0252494215965271, -0.03021795116364956, -0.03387897089123726, -0.0012784517602995038, -0.0063668349757790565, -0.03905089199542999, 0.023331744596362114, 0.018276048824191093, 0.017694935202598572, -0.0011113813379779458, 0.004162232391536236, 0.020513338968157768, -0.02551092393696308, -0.003404967486858368, 0.0065302737057209015, 0.025554507970809937, -0.027021821588277817, -0.020092030987143517, 0.00637773098424077, -0.03248429670929909, -0.03039228543639183, 0.0019031497649848461, -0.01510897558182478, -0.011418898589909077, -0.02760293520987034, -0.006762719247490168, 0.014920113608241081, -0.03998067229986191, -0.03527364507317543, 0.019016969949007034, -0.026033926755189896, -0.0008952794596552849, -0.00818644929677248, 0.021617457270622253, 0.005073855631053448, -0.04750610515475273, 0.005073855631053448, -0.03315258026123047, -0.0030236111488193274, 0.03942861407995224, -0.02753029577434063, -0.06374825537204742, 0.022111404687166214, 0.03835355117917061, -0.03472158685326576, 0.01311865821480751, 0.0146586112678051, -0.02100728638470173, 0.0018831739434972405, -0.006112597417086363, 0.014600500464439392, 0.021719152107834816, 0.03451819717884064, 0.010510907508432865, -0.019598083570599556, -0.06630516052246094, 0.010075071826577187, -0.028619885444641113, 0.032629575580358505, -0.015210670419037342, -0.025612618774175644, 0.03739471361041069, 0.03489592298865318, -0.02909930609166622, -0.027021821588277817, -0.006784511264413595, 0.03835355117917061, -0.015196142718195915, -0.0007036932511255145, 0.020469756796956062, -0.009428582154214382, 0.031002454459667206, 0.0325714647769928, 0.032222796231508255, -0.023418912664055824, 0.01189831830561161, -0.003795403754338622, 0.00046375655801966786, -0.021079925820231438, 0.039312392473220825, -0.012072652578353882, -0.019249415025115013, 0.03274579718708992, 0.016808735206723213, 0.022184044122695923, -0.030828120186924934, -0.02166104130446911, -0.018639246001839638, 0.009036329574882984, -0.009588387794792652, -0.029070250689983368, -0.0007014232687652111, -0.045326925814151764, -0.029506085440516472, 0.03120584599673748, 0.01417919248342514, 0.016561761498451233, -0.0016307523474097252, 0.0252494215965271, 0.014077497646212578, -0.002633174881339073, -0.016474593430757523, -0.044368088245391846, 0.07786933332681656, -0.018697356805205345, 0.02192254178225994, -0.08984029293060303, 0.006849886383861303, 0.013656189665198326, -0.0643874779343605, 0.019452806562185287, 0.006159813143312931, 0.007598071359097958, 0.04660537838935852, 0.10338025540113449, 0.020062975585460663, -0.012617447413504124, -0.03103151172399521, 0.017142875120043755, 0.0252639502286911, 0.016518177464604378, 0.008055699057877064, 0.016024230048060417, -0.012573863379657269, -0.04895889014005661, 0.0018087186617776752, -0.0033069043420255184, 0.014847474172711372, 0.005288141313940287, 0.009581124410033226, 0.0030998822767287493, -0.013539966195821762, -0.03794677183032036, -0.023273633792996407, 0.002137411618605256, -0.0019394694827497005, -0.04390319436788559, 0.005019376054406166, -0.005851096007972956, -0.0047215549275279045, -0.04099762439727783, -0.0203680619597435, 0.0012566599762067199, 0.008447950705885887, 0.03623248636722565, 0.009799041785299778, 0.007569015491753817, 0.007282090373337269, -0.029535140842199326, -0.013053283095359802, 0.0014328103279694915, 0.000545248796697706, -0.01736079342663288, -0.004365622065961361, -0.013583550229668617, 0.01824699342250824, 0.004409205634146929, 0.011012118309736252, -0.005255453754216433, 0.006421314552426338, 0.025191310793161392, 0.008593229576945305, 0.014615028165280819, 0.07874100655317307, 0.031147733330726624, 0.03884749859571457, -0.050469789654016495, -0.010096863843500614, -0.0464310422539711, -0.014738515019416809, -0.044774867594242096, 0.012130764313042164, -0.0011604129103943706, 0.03771432861685753, 0.03594192862510681, 0.051370516419410706, 0.059912897646427155, -0.031322069466114044, 0.030014561489224434, -0.040213119238615036, -0.011615024879574776, -0.058053333312273026, 0.02150123380124569, 0.02004844881594181, 0.04614048823714256, 0.056745823472738266, -0.005044799763709307, -0.035796649754047394, -0.016111398115754128, -0.014004858210682869, -0.018363216891884804, -0.02166104130446911, 0.041171956807374954, -0.01067071408033371, 0.027588408440351486, -0.036116261035203934, -0.011963693425059319, 0.0545957013964653, 0.010111391544342041, -0.03887655586004257, -0.025118671357631683, -0.013125922530889511, 0.03905089199542999, -0.022590823471546173, 0.00541889201849699, -0.037598103284835815, 0.0008961874409578741, -0.01238500140607357, -0.037917718291282654, -0.01882810704410076, -0.03169979155063629, 0.03451819717884064, -0.019670723006129265, -0.04253757745027542, 0.0439903624355793, -0.006617440842092037, -0.02957872487604618, 0.006457634270191193, 0.01978694647550583, -0.006246980279684067, -0.012210667133331299, -0.0415787398815155, 0.06363203376531601, -0.015937063843011856, 0.05465381219983101, -0.017157403752207756, 0.030450396239757538, 0.015007280744612217, -0.04898794740438461, -0.0146586112678051, -0.02084748074412346, 0.01840679906308651, 0.011593232862651348, -0.010866840369999409, 0.00745279248803854, 0.02998550422489643, -0.03079906478524208, -0.04628576338291168, 0.004598068073391914, -0.040939513593912125, 0.012421321123838425, 0.01775304600596428, 0.057966165244579315, -0.025598090142011642, 0.031409233808517456, 0.0091670798137784, -0.0011340811615809798, 0.02834385633468628, 0.010539962910115719, 0.01988864131271839, 0.024014554917812347, 0.06897828727960587, 0.03079906478524208, -0.0015780888497829437, -0.010075071826577187, -0.03323974460363388, -0.03815016150474548, -0.045501261949539185, 0.027719158679246902, -0.01760776713490486, 0.03297824412584305, 0.019670723006129265, 0.006486690137535334, 0.02556903474032879, -0.002921916078776121, -0.042566630989313126, 0.014920113608241081, -0.003315984271466732, 0.004623491782695055, 0.03518648073077202, 0.038498830050230026, 0.020716730505228043, 0.019699780270457268, -0.014062969014048576, -0.008200977928936481, 0.046721599996089935, -0.004841409623622894, 9.794955985853449e-05, -0.0018114426638931036, -0.013903163373470306, 0.002587775234133005, 0.02540922909975052, -0.03855694457888603, -0.015007280744612217, -0.021152565255761147, 0.01319129765033722, -0.0073692575097084045, -0.01866830140352249, -0.049656227231025696, -0.026019398123025894, 0.03071189858019352, -0.024014554917812347, 0.002006660681217909, -0.14795173704624176, -0.02109445445239544, -0.029840227216482162, 0.0342276394367218, -0.01792738027870655, 0.017317209392786026, 0.020644091069698334, -0.04285718873143196, -0.0007913144072517753, 0.013598077930510044, -0.02141406759619713, -0.032629575580358505, 0.009145288728177547, -0.0010650737676769495, 0.028692524880170822, 0.03184507042169571, -0.0017115636728703976, 0.009457637555897236, 0.005288141313940287, 0.03013078309595585, -0.0020665882620960474, -0.027806326746940613, 0.002987291431054473, 0.02445038966834545, 0.0010205822763964534, -0.01091768778860569, -0.005317197181284428, -0.013641661033034325, 0.00323789706453681, -0.006047222297638655, 0.011273619718849659, 0.007154971361160278, 0.011251828633248806, 0.03315258026123047, -0.02044069953262806, -0.012210667133331299, 0.010365628637373447, -0.004213079810142517, -0.007830517366528511, 0.033617470413446426, -0.053491584956645966, 0.040765177458524704, 0.017477016896009445, -0.059012170881032944, 0.015268782153725624, -0.004227607510983944, -0.001523609389550984, -0.002151939319446683, -0.027079932391643524, 0.018116243183612823, -0.02885233238339424, 0.01824699342250824, -0.047854773700237274, -0.01856660656630993, -0.00035570558975450695, 0.020309949293732643, -0.026019398123025894, -0.030421340838074684, 0.0016334763495251536, 0.019699780270457268, -0.010096863843500614, -0.021617457270622253, 0.023912860080599785, 0.043874140828847885, -0.015937063843011856, 0.0035030303988605738, 0.007874100469052792, -0.02915741689503193, 0.0013256673701107502, -0.00012677829363383353, -0.021123509854078293, -0.02909930609166622, 0.004514532629400492, 0.01392495445907116, -0.012523015961050987, -0.002871068427339196, -0.051864463835954666, -0.026949182152748108, 0.06124946102499962, -0.03730754554271698, 0.005872888024896383, 0.031176788732409477, -0.017157403752207756, 0.006323251407593489, -0.006802671123296022, -0.006145284976810217, -0.02508961595594883, -0.0001477755868108943, -0.008244561031460762, 0.013983066193759441, 0.0011268171947449446, 0.06671193987131119, -0.03428575024008751, -0.0005697645246982574, -0.04096856713294983, 0.021457649767398834, -0.005618650000542402, 0.0146586112678051, 0.013401951640844345, 0.01759324036538601, -0.02925911173224449, 0.006188868544995785, -0.01564650610089302, -0.03934144601225853, 0.0027003660798072815, -0.0023716732393950224, -0.010576282627880573, 0.006043590139597654, -0.002364409388974309, -0.03283296525478363, 0.004278454929590225, 0.01246490515768528, -0.016314787790179253, 0.00888378731906414, 0.011484273709356785, -0.00998064037412405, -0.05447947978973389, 0.03568042814731598, -0.011019382625818253, -0.017665879800915718, 0.0091670798137784, -0.01356175821274519, -0.016561761498451233, -0.04282813519239426, -0.04114290326833725, -0.0341985858976841, -0.004605331923812628, 0.02575789764523506, -0.03884749859571457, -0.007056908681988716, -0.012769989669322968, -0.020237309858202934, -0.01404844131320715, -0.02834385633468628, 0.018101714551448822, 0.00625424413010478, -0.005440684035420418, -0.013401951640844345, 0.034663476049900055, 0.03152545914053917, 0.025554507970809937, 0.021385012194514275, 0.00042970688082277775, -0.02126878872513771, 0.06310902535915375, 0.015370476990938187, -0.017215514555573463, 0.014767570421099663, 0.0012221563374623656, 0.007598071359097958, -0.06799039244651794, -0.002466104459017515, 0.015588394366204739, -0.036377765238285065, -0.006733663380146027, -0.05474098026752472, -0.015820840373635292, 0.011048438027501106, 0.0005275429575704038, 0.03541892394423485, 0.004474581219255924, -0.012254251167178154, 0.006802671123296022, -0.0358547605574131, -0.0020157406106591225, 0.018799051642417908, -0.012297834269702435, -0.021777262911200523, -0.02492981031537056, -0.035883817821741104, 0.0448329783976078, -0.00843342300504446, -0.03477969765663147, -0.008447950705885887, 0.028576303273439407, -0.040619898587465286, -0.019249415025115013, -0.04282813519239426, -0.009021801874041557, -0.02208234928548336, 0.0228087417781353, 0.046227652579545975, -0.02378210797905922, 0.011302676051855087, 0.00698790093883872, -0.022750630974769592, -0.024828113615512848, -0.004162232391536236, -0.005480635445564985, -0.026193734258413315, 0.016184037551283836, -0.013038755394518375, -0.03268768638372421, -0.015661034733057022, -0.029840227216482162, -0.03977728262543678, 0.009682819247245789, -0.004351094365119934, 0.0010414660209789872, -0.056978270411491394, -0.012297834269702435, 0.0012929795775562525, -0.028474608436226845, 0.007016956806182861, 0.038324497640132904, 0.006025430280715227, -0.023012131452560425, -0.007376521360129118, 0.04027123004198074, 0.00203571654856205, 0.04015500843524933, -0.010147711262106895, -0.00039134424878284335, 0.03448914363980293, -0.004282087087631226, -0.03187412768602371, 0.04474581032991409, 0.0561937652528286, 0.025714313611388206, 0.02469736337661743, 0.019423749297857285, 0.009159816429018974, -0.026251845061779022, -0.028721580281853676, 0.014811154454946518, -0.007376521360129118, -0.006203396711498499, 0.01579178497195244, -0.006573857273906469, 0.025031505152583122, -0.023433439433574677, 0.0015871687792241573, -0.011491538025438786, 0.01693948544561863, 0.008985482156276703, -0.0022608984727412462, 0.022954020649194717, 0.009987904690206051, -0.01560292299836874, -0.024377750232815742, 0.002753029577434063, -0.016590816900134087, 0.02802424319088459, -0.017854740843176842, 0.013016963377594948, -0.003940682392567396, 0.028823276981711388, 0.05482814833521843, -0.0022082349751144648, -0.01815982535481453, -0.00782325305044651, -0.017404377460479736, 0.009799041785299778, -0.02182084694504738, -0.01978694647550583, 0.018929803743958473, -0.02257629670202732, -0.013038755394518375, -0.012450376525521278, -0.01603875868022442, -0.01035110093653202, -0.014128345064818859, -0.008447950705885887, -0.005978215020149946, 0.03695887699723244, -0.023346273228526115, 0.014571444131433964, -0.01287168450653553, 0.025714313611388206, -0.03283296525478363, -0.10163691639900208, -0.02949155867099762, 0.027341434732079506, 0.013002435676753521, 0.034082360565662384, -0.037685271352529526, 0.005920103285461664, -0.00505206361413002, -0.02102181501686573, -0.0029745795764029026, -0.0021101718302816153, -0.017782101407647133, -0.007351097650825977, 0.009806306101381779, 0.015762729570269585, -0.024464918300509453, -0.019757891073822975, -0.019816001877188683, 0.012457640841603279, -0.017157403752207756, -0.0031997612677514553, 0.006613808684051037, 0.026847487315535545, 0.042363241314888, -0.02394191548228264, -0.008774828165769577, 0.0056658657267689705, 0.016590816900134087, 0.011731247417628765, 0.018755467608571053, -0.003132570069283247, -0.012595655396580696, 0.00948669295758009, 0.03640681877732277, -0.018276048824191093, -0.009515749290585518, -0.038324497640132904, -0.022852325811982155, -0.03167073801159859, -0.0016643480630591512, 0.02738501876592636, -0.02859083004295826, 0.06735116243362427, 0.0013202193658798933, 0.019598083570599556, -0.02516225539147854, 0.004870465490967035, -0.011607760563492775, 0.02590317651629448, -0.037859607487916946, -0.004518164787441492, 0.03169979155063629, 0.008106546476483345, -0.029375335201621056, 0.02673126384615898, 0.022532712668180466, 0.003748188028112054, 0.005251821596175432, 0.020339004695415497, 0.017317209392786026, -0.013271201401948929, -0.01405570562928915, 0.026019398123025894, 0.002903756219893694, -0.03771432861685753, -0.022954020649194717, -0.002943707862868905, 0.02867799811065197, 0.008665869012475014, -0.024377750232815742, -0.02484264224767685, 0.015021808445453644, -0.025554507970809937, 0.0007041472708806396, -0.026353539898991585, 0.0073983133770525455, 0.011949165724217892, 0.027995187789201736, -0.052416522055864334, 0.0358547605574131, 0.022692518308758736, -0.03937050327658653, 0.00324879284016788, 0.007525431923568249, 0.008150129579007626, 0.027312379330396652, 0.01882810704410076, -0.004322038497775793, -0.02998550422489643, 0.055525485426187515, 0.053724028170108795, -0.022213099524378777, 0.004776034504175186, -0.03047945164144039, 0.016997598111629486, -0.03193223848938942, -0.009719138965010643, 0.018769996240735054, 0.007238506805151701, 0.002558719599619508, 0.015864424407482147, 0.025133199989795685, 0.012116235680878162, -0.031060567125678062, 0.028460079804062843, 0.0293172225356102, -0.002941891783848405, 0.004601699765771627, 0.013227617368102074, 0.012043597176671028, 0.0093632061034441, 0.021849902346730232, -0.027762742713093758, 0.0004962172242812812, 0.003622885327786207, 0.017709461972117424, 0.053084805607795715, 0.04951094835996628, 0.03640681877732277, -0.002235474530607462, 0.007394681219011545, 0.01331478450447321, -0.010721561498939991, 0.014585972763597965, -0.019263943657279015, -0.020832952111959457, 0.006065382156521082, 0.014317207038402557, -0.009704611264169216, -0.014934641309082508, 0.026702208444476128, -0.00949395727366209, 0.011171924881637096, 0.014527861028909683, -0.004529060795903206, 0.012646502815186977, 0.04576276242733002, -0.0015444932505488396, -0.027268795296549797, 0.05142862722277641, 0.009457637555897236, 0.03111867792904377, 0.035070255398750305, 0.024421334266662598, 0.010133182629942894, -0.0010859576286748052, 0.007569015491753817, -0.019089609384536743, 0.02681843191385269, -0.019118664786219597, 0.02721068449318409, -0.014397109858691692, -0.027254266664385796, 0.003926154226064682, 0.02549639530479908, 0.013271201401948929, 0.031176788732409477, -0.016096869483590126, -0.004089592956006527, 0.025961287319660187, 0.003506662556901574, 0.02834385633468628, 0.007216714788228273, -0.008542382158339024, 0.022227628156542778, -0.003690076759085059, -0.02256176806986332, -0.003564773825928569, -0.022997604683041573, 0.03762716054916382, 0.023811163380742073, -0.04303152486681938, 0.011273619718849659, 0.023811163380742073, 0.013329312205314636, 0.039138056337833405, -0.021312372758984566, 0.011847470887005329, 0.005037535913288593, 0.020426172763109207, 0.005949159152805805, -0.0033795435447245836, -0.03184507042169571, 0.007046012673527002, 0.07339475303888321, -0.01275546196848154, 0.003070826642215252, -0.002235474530607462, -0.006555697415024042, 0.03370463848114014, -0.007707030046731234, 0.030566619709134102, -0.0019776050467044115, 0.041171956807374954, 0.016242148354649544, -0.007401945069432259, -0.007728822063654661, 0.02273610234260559, 0.02076031267642975, -0.041433461010456085, -0.03414047509431839, -0.005905575584620237, 0.006733663380146027, -0.020062975585460663, -0.011142869479954243, 0.03544798120856285, -0.04178212955594063, -0.005153758451342583, -0.0009996984153985977, 0.00941405352205038, -0.0010977614438161254, 0.009784514084458351, -0.015573866665363312, 0.008411631919443607, -0.01669251173734665, -0.02760293520987034, -0.001430086325854063, 0.03315258026123047, -0.049249447882175446, 0.005012112203985453, -0.018058130517601967, -0.025641674175858498, 0.0034921346232295036, 0.016024230048060417, -0.01720098778605461, 0.010627130046486855, 0.02599034272134304, -0.010866840369999409, -0.006809934973716736, -0.006392258685082197, 0.006399522535502911, 0.0068971021100878716, -0.02354966290295124, 0.0048268819227814674, -0.020920120179653168, -0.011585969477891922, -0.003510294482111931, -0.01091042347252369, 0.010852311737835407, -0.012428585439920425, 0.015050863847136497, -0.003755452111363411, -0.015748200938105583, 0.005048431921750307, 0.0015317813958972692, -0.01022034976631403, -0.00708959624171257, 0.05904122814536095, -0.027980661019682884, -0.03846977651119232, -0.011658607982099056, 0.010452795773744583, 0.026440706104040146, -0.0033341441303491592, -0.007162235677242279, -0.010067807510495186, -0.011963693425059319, 0.04282813519239426, 0.03079906478524208, 0.010082335211336613, -0.03437291830778122, 0.014389846473932266, -0.014600500464439392, -0.03071189858019352, 0.011375315487384796, -0.031641680747270584, 0.023244578391313553, 0.00040859609725885093, 0.003423127345740795, 0.00443826150149107, -0.026208261027932167, 0.00913076102733612, 0.01046732347458601, 0.040736123919487, 0.0019104137318208814, -0.014259095303714275, 0.04123006761074066, -0.022866852581501007, 0.013358368538320065, 0.015239725820720196, -0.03283296525478363, -0.034343864768743515, -0.01743343286216259, -0.037685271352529526, 0.036377765238285065, -0.003150729928165674, 0.028387440368533134, -0.008026642724871635, -0.002092011971399188, 0.007394681219011545, 0.020891064777970314, 0.05352063849568367, -0.023883802816271782, 0.013888634741306305, -0.010743353515863419, 0.011876526288688183, 0.0008521498530171812, 0.04654726758599281, 0.0029073881451040506, -0.03239712864160538, 0.011251828633248806, 0.015762729570269585, 0.011179189197719097, 0.003980633802711964, 0.010133182629942894, 0.012668294832110405, 0.01397580187767744, -0.00985715351998806, -0.033937081694602966, -0.026760319247841835, -0.021791791543364525, 0.009682819247245789, -0.0009134392603300512, 0.025394700467586517, 0.002981843426823616, 0.006813566666096449, 0.01442616619169712, -0.0022046028170734644, 0.0048305136151611805, 0.0009175252052955329, -0.027181627228856087, -0.01693948544561863, 0.03364652767777443, 0.006628336384892464, -0.0051937103271484375, -0.018537551164627075, -0.008920107036828995, -0.002320825820788741, 0.0010378340957686305, 0.013983066193759441, -0.0037627159617841244, 0.030276061967015266, 0.011869261972606182, -0.011629552580416203, -0.02819857746362686, 0.01067071408033371, -0.043786972761154175, 0.019278472289443016, -0.039138056337833405, -0.007983059622347355, 0.036116261035203934, 0.025133199989795685, 0.0034975826274603605, -0.021472178399562836, -0.008665869012475014, -0.011963693425059319, 0.0007554487674497068, 0.012079915963113308, 0.022227628156542778, -0.03138018026947975, 0.08600493520498276, -0.0028529088012874126, -0.028881387785077095, 0.0026894703041762114, -0.028169522061944008, 0.008375312201678753, -0.0187264122068882, -0.016663456335663795, -0.02500244788825512, 0.038731276988983154, -0.012493960559368134, 0.026615040376782417, 0.01720098778605461, 0.022910436615347862, 0.017331738024950027, 0.0018059946596622467, -0.008135601878166199, 0.03292013332247734, 0.012733669951558113, 0.006145284976810217, 0.015617450699210167, 0.021966125816106796, -0.03861505538225174, 0.02337532863020897, -0.028154995292425156, 0.014535125344991684, -0.021326899528503418, -0.0007300249999389052, 0.0162857323884964, 0.027079932391643524, 0.003998793661594391, -0.0006056302227079868, -0.04625670984387398, 0.02013561502099037, -0.0007908604457043111, -0.013496383093297482, -0.08170469105243683, 0.002800245303660631, -0.0022263946011662483, -0.009668291546404362, 0.020266365259885788, 0.00718765938654542, 0.0071694995276629925, -0.0053317248821258545, -0.03169979155063629, 0.005092015489935875, 0.00888378731906414, -0.025220366194844246, -0.00780146149918437, 0.03126395866274834, 0.01563197933137417, -0.01356175821274519, -0.016518177464604378, -0.0005606846534647048, 0.017811156809329987, -0.015690090134739876, -0.029215527698397636, 0.018915275111794472, 0.007990323938429356, -0.0006292379694059491, -0.035564202815294266, 0.020397117361426353, -0.007056908681988716, 0.012363209389150143, 0.030595675110816956, -0.036290597170591354, -0.01454965304583311, 0.039312392473220825, -0.0005021191900596023, 0.04088139906525612, -0.012406793422996998, 0.00929056666791439, -0.02875063754618168, -0.011259092018008232, 0.012799045071005821, 0.012000013142824173, 0.0073365699499845505, 0.030043616890907288, 0.008055699057877064, 0.03373369202017784, -0.0003316438233014196, -0.020673146471381187, 0.013757884502410889, -0.007467320654541254, 0.009029065258800983, 0.023186465725302696, 0.017128348350524902, -0.007728822063654661, -0.014142872765660286, 0.009036329574882984, -0.037685271352529526, -0.00434019835665822, -0.0014682220062240958, -0.005952790845185518, 0.001669796067290008, -0.024014554917812347, 0.03722038120031357, 0.003528454340994358, 0.0006505757919512689, 0.0132421450689435, -0.012246986851096153, -0.016256676986813545, -0.0014473381452262402, 0.014077497646212578, -0.010016960091888905, 0.03957389295101166, -0.03411141782999039, -0.008832939900457859, 0.0035556938964873552, 0.01417919248342514, 0.013169505633413792, -0.010946743190288544, 0.005139230750501156, 0.0018314184853807092, 3.107032898697071e-05, -0.003688260680064559, -0.012922531925141811, 0.026934653520584106, 0.007314777933061123, -0.008462479338049889, 0.0001852302229963243, 0.012486696243286133, -0.018944330513477325, -0.006940685678273439, 0.02019372768700123, 8.966414316091686e-05, -0.002407992957159877, 0.006065382156521082, -0.028547246009111404, 0.0028638045769184828, -0.0171138197183609, -0.0052227661944925785, 0.022692518308758736, 0.004619859624654055, 0.0415206253528595, 0.00312530598603189, 0.011142869479954243, -0.018464911729097366, -0.02606298215687275, 0.0042203436605632305, 0.008709453046321869, -0.0134382713586092, 0.007663446478545666, 0.020716730505228043, 0.00324879284016788, -0.012915268540382385, -0.021878957748413086, -0.013431007042527199, 0.013721564784646034, -0.025786953046917915, 0.0016007886733859777, -0.028082355856895447, -0.02818405069410801, 0.029201000928878784, 0.01046732347458601, 0.023912860080599785, -0.011615024879574776, -0.03242618590593338, 0.013547230511903763, 0.009886209852993488, 0.033036354929208755, -0.019510917365550995, -0.00684262253344059, 0.004078696947544813, 0.03899277746677399, 0.0011831127339974046, -0.0043293023481965065, -0.008331728167831898, 0.016924958676099777, -0.013329312205314636, -0.019598083570599556, 0.029869282618165016, -0.0031616257037967443, -0.00924698356539011, -0.00372639624401927, -0.01743343286216259, -0.006457634270191193, 0.006236084271222353, -0.01515255868434906, 0.019990336149930954, -0.0030399549286812544, -0.03347219154238701, 0.039225224405527115, 0.006246980279684067, -0.040765177458524704, -0.024958865717053413, -0.007401945069432259, 0.004688866902142763, -0.003332328051328659, -0.005357148591428995, 0.009043593890964985, 0.011665872298181057, 0.028082355856895447, -0.023520607501268387, 0.009232455864548683, 0.024217944592237473, 0.007598071359097958, 0.011295411735773087, -0.008905578404664993, 0.018377743661403656, -0.030363230034708977, 0.016808735206723213, 0.022372905164957047, 0.017302682623267174, 0.019757891073822975, 0.023331744596362114, -0.014121080748736858, -0.027559353038668633, -0.01006054412573576, 0.012530280277132988, 0.02885233238339424, 0.014811154454946518, -0.004746978636831045, 0.0012884396128356457, 0.024159831926226616, -0.018886219710111618, 0.012864421121776104, -0.007071436382830143, -0.007460056804120541, -0.020644091069698334, -0.019351111724972725, 0.0011250012321397662, 0.02272157371044159, -0.00043129586265422404, -0.01164408028125763, 0.023564189672470093, 0.0012221563374623656, 0.029956448823213577, -0.009755458682775497, 0.014317207038402557, 0.014731250703334808, -0.0244358628988266, -0.006461265962570906, -0.028256690129637718, 0.027312379330396652, -0.0028274848591536283, -0.015239725820720196, -0.03201940655708313, 0.012646502815186977, 0.026353539898991585, -0.04352547228336334, -0.005546011030673981, 0.014629555866122246, -0.012864421121776104, 0.009036329574882984, 0.06537537276744843, 0.005720345303416252, 0.026411650702357292, -0.03486686572432518, 0.025133199989795685, 0.004332934506237507, 0.012050860561430454, 0.0034412869717925787, -0.018145298585295677, 0.019525445997714996, -0.027007292956113815, -0.0018568421946838498, -0.019975809380412102, 0.016983069479465485, 0.004111384507268667, -0.04096856713294983, -0.008651341311633587, 0.03640681877732277, 0.0023680413141846657, 0.017171932384371758, 0.02029542252421379, -0.017564183101058006, 0.01605328544974327, -0.0071113877929747105, -0.023651357740163803, -0.017418906092643738, 0.025147726759314537, 0.00017626381304580718, -0.01980147510766983, 0.024639252573251724, 0.024886226281523705, 0.025452813133597374, -6.951808609301224e-05, 0.024944337084889412, -0.025975815951824188, 0.029636835679411888, -0.030363230034708977, -0.009065384976565838, -0.0228087417781353, 0.0011540569830685854, -0.009849890135228634, -0.008527854457497597, -0.0019503653747960925, -0.014469749294221401, 0.010634394362568855, -0.0326005183160305, 0.00493220891803503, 0.052997637540102005, -0.03623248636722565, -0.020382588729262352, 0.009283303283154964, -0.0036682849749922752, -0.03088623285293579, 0.014680403284728527, 0.03477969765663147, -0.01709929294884205, -0.012116235680878162, -0.01563197933137417, 0.01882810704410076, 0.025845063850283623, 0.04512353613972664, 0.010169502347707748, 0.028692524880170822, 0.001351999118924141, 0.008615021593868732, -0.016590816900134087, 0.007685238495469093, -0.007583543658256531, -0.0020175566896796227, -0.034256696701049805, 0.030595675110816956, -0.0067227678373456, 0.020222783088684082, 0.0041876561008393764, 0.03248429670929909, -0.02738501876592636, 0.006414050702005625, 0.0058619920164346695, -0.01727362722158432, -0.011346259154379368, -0.001519069424830377, -0.0005593226524069905, 0.025365645065903664, -0.0007381969480775297, -0.014346262440085411, 0.020571451634168625, 0.004104120656847954, 0.022038765251636505, -0.007314777933061123, 0.011368051171302795, -0.010285725817084312, 0.013082338497042656, 0.00028397428104653955, 0.04056178778409958, -0.03411141782999039, -0.004311142954975367, 0.004234871361404657, -0.017738517373800278, -0.035389870405197144, -0.015050863847136497, -0.0004980332450941205, -0.0004126820422243327, -0.015515755861997604, 0.017782101407647133, 0.0280968826264143, 0.012602919712662697, -0.010154974646866322, 0.014578708447515965, 0.0002737593895290047, 0.03527364507317543, 0.020426172763109207, 0.00017512882186565548, -0.012493960559368134, -0.04384508356451988, 0.006403154693543911, -0.01906055398285389, -0.01759324036538601, 0.043147746473550797, 0.02590317651629448, 0.04701215773820877, 0.0051610227674245834, 0.00912349671125412, -0.043699804693460464, 0.005338988732546568, -0.016096869483590126, 0.00863681361079216, 0.04186929389834404, -0.011912846006453037, 0.012392265722155571, 0.0043256706558167934, -0.01882810704410076, -0.02866346947848797, -0.03286202251911163, 0.0023389856796711683, -0.030014561489224434, 0.039399560540914536, -0.04442619904875755, -0.011230036616325378, -0.014222775585949421, 0.021530289202928543, 0.022852325811982155, -0.01775304600596428, 0.020920120179653168, -0.0034757908433675766]",Probabilistic Inference in Language Models via Twisted Sequential Monte Carlo.pdf
