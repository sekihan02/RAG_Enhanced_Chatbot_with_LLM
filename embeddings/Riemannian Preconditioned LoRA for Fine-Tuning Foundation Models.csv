text,embedding,file
"Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models
Fangzhao Zhang1Mert Pilanci1
Abstract
Low-Rank Adaptation (LoRA) emerges as a
popular parameter-efficient fine-tuning (PEFT)
method, which proposes to freeze pretrained
model weights and update an additive low-rank
trainable matrix. In this work, we study the en-
hancement of LoRA training by introducing an
r×rpreconditioner in each gradient step where r
is the LoRA rank. We theoretically verify that the
proposed preconditioner stabilizes feature learn-
ing with LoRA under infinite-width NN setting.
Empirically, the implementation of this new pre-
conditioner requires a small change to existing
optimizer code and creates virtually minuscule
storage and runtime overhead. Our experimen-
tal results with both large language models and
text-to-image diffusion models show that with this
new preconditioner, the convergence and reliabil-
ity of SGD and AdamW can be significantly en-
hanced. Moreover, the training process becomes
much more robust to hyperparameter choices such
as learning rate. The new preconditioner can
be derived from a novel Riemannian metric in
low-rank matrix field. Code can be accessed
athttps://github.com/pilancilab/
Riemannian_Preconditioned_LoRA .
1. Introduction
With the expanding scale of neural network models in both
vision and language domains, training a neural network
from scratch to match the performance of existing large
models has become almost infeasible. As a result, fine-
tuning has emerged as a prevalent approach for downstream
tasks. Traditional full parameter fine-tuning demands ex-
tensive storage, making it impractical for many applica-
tions. In contrast, recent advances in Parameter-Efficient
Fine-Tuning (PEFT) methods offer a more storage-efficient
1Department of Electrical Engineering, Stanford University.
Correspondence to: Fangzhao Zhang <zfzhao@stanford.edu >.
Proceedings of the 41stInternational Conference on Machine
Learning , Vienna, Austria. PMLR 235, 2024. Copyright 2024 by
the author(s).solution while still delivering strong performance in down-
stream tasks. A widely-used PEFT method is Low Rank
Adaptation, also known as LoRA (Hu et al., 2021), which
proposes to add low-rank matrices to existing model weights
and only train these additive components. Simply speaking,
for a pretrained model weight matrix Wof dimension m
byn, LoRA replaces WwithW+BA where B, A are
trainable weight matrices of dimension mbyrandrbyn
for some small rank r. In the fine-tuning procedure, Wis
frozen and we are only optimizing over A’s and B’s. Com-
pared to full fine-tuning, LoRA introduces fewer trainable
parameters. Effectiveness of LoRA has been empirically
verified in different fields. Here we note that optimizing
LoRA parameters falls into optimizing over low-rank ma-
trices which form a quotient manifold. This motivates the
idea of enhancing LoRA training via tools from the field of
Riemannian optimization.
Recent work such as LoRA+ (Hayou et al., 2024) has drawn
attention to the optimization paradigm of LoRA and reveals
that the learning rate of LoRA parameter Bshould be set
larger than that of Ato achieve stable feature learning un-
der the infinite-width NN setting, making the learning rate
tuning a joint hyperparameter search. More specifically, de-
note learning rates for AandBbyηAandηBrespectively,
LoRA+ proposes to use a heuristic ηB/ηA= 24in practice
and tune only ηA. In this work, we propose an improvement
of LoRA training with the introduction of an r×rprecon-
ditioner in its optimization step, and we show that with this
simple preconditioner, LoRA learns stable features without
the need of setting different learning rates for AandB. As
an illustration, we propose modifying the gradient updates
for the LoRA parameters as follows
At+1=At−α(BT
tBt)−1(∇AtL),
Bt+1=Bt−α(∇BtL)(AtAT
t)−1,(1)
where (AtAT
t)−1and(BT
tBt)−1are the preconditioners
we introduce and Lis the training loss objective. This
scaled gradient method (scaled GD) can be derived from a
novel Riemannian metric studied in (Mishra et al","[0.013979247771203518, 0.01245470903813839, 0.015439188107848167, -0.02583964541554451, -0.019922366365790367, -0.022299613803625107, -0.014496040530502796, 0.025529569014906883, -0.06826834380626678, 0.0640823170542717, -0.018061911687254906, -0.002277118619531393, -0.05937950313091278, -0.006230584345757961, 0.03498687967658043, -0.008533542975783348, 0.03664061427116394, -0.022545089945197105, -0.038216833025217056, 0.05255783721804619, 0.025736285373568535, -0.044418349862098694, 0.01904381811618805, 0.015142031945288181, 0.025064455345273018, -0.01753219962120056, 0.050283949822187424, 0.04108503460884094, 0.04105919599533081, -0.0020235672127455473, 0.02370787411928177, -0.014883635565638542, -0.04175686463713646, -0.03341066092252731, 0.016369415447115898, 0.006078776437789202, 0.013682091608643532, 0.0019266684539616108, 0.0013913033762946725, 0.005591053050011396, -0.010219579562544823, -0.07415977865457535, -0.0546250082552433, 0.03555535152554512, 0.006627868860960007, 0.024250507354736328, 0.053074631839990616, 0.0371832475066185, -0.006944404449313879, 0.027984336018562317, -0.06604613363742828, 0.027390023693442345, -0.031059252098202705, -0.02151150442659855, -0.028682004660367966, 0.0006185364909470081, 0.04439251124858856, 0.00893405731767416, 0.02198953740298748, 0.014534800313413143, 0.025129053741693497, -0.033255621790885925, 0.04033568501472473, -0.02434094436466694, -0.03038742206990719, -0.032506272196769714, -0.08485738933086395, -0.008288065902888775, 0.005949578247964382, 0.035296954214572906, -0.010729912668466568, -0.03219619765877724, 0.07633031159639359, -0.0201549232006073, -0.021123910322785378, -0.004334600176662207, 0.004389509558677673, 0.064495749771595, 0.020710475742816925, 0.0035400313790887594, 0.01705416478216648, -0.017002485692501068, 0.033436499536037445, -0.021976618096232414, -0.010251878760755062, -0.054521650075912476, -0.016524452716112137, -0.027209145948290825, -0.004848163109272718, 0.007241560611873865, 0.01614977791905403, -0.0026049590669572353, -0.020839672535657883, 0.027260825037956238, 0.03297138586640358, 0.02280348725616932, 0.04028400778770447, 0.010800971649587154, 0.06315208971500397, 0.02461226098239422, -0.0009843289153650403, -0.031033413484692574, 0.04801005870103836, -0.03240291401743889, 0.04067160189151764, -0.013811290264129639, 0.0013323567109182477, -0.002277118619531393, 0.007751893252134323, 0.012377189472317696, -0.012131713330745697, 0.041524309664964676, -0.029560552909970284, -0.01834614761173725, 0.011744118295609951, -0.11049032211303711, -0.06578773260116577, 0.015658823773264885, -0.0483718141913414, -0.0016416249563917518, -0.013029640540480614, -0.018565785139799118, 0.0021027009934186935, 0.00980614498257637, 0.03041326254606247, -0.03596878424286842, 0.06790658831596375, -0.04198942333459854, 0.02695074863731861, -0.014793196693062782, 0.0717308521270752, 0.06139499694108963, 0.031240129843354225, -0.04173102602362633, -0.04943123832345009, -0.012726024724543095, 0.012797083705663681, -0.0016892667626962066, -0.008378504775464535, -0.027803458273410797, 0.017893953248858452, -0.015284149907529354, -0.025167813524603844, -0.01897921971976757, -0.05886271223425865, 0.02968975156545639, -0.0016876517329365015, -0.009431470185518265, -0.004786794073879719, -0.005313276778906584, -0.011421122588217258, -0.01076867152005434, -0.054314933717250824, 0.029069600626826286, -0.02434094436466694, 0.005064570344984531, -0.009741545654833317, 0.004056824371218681, 0.04514186084270477, -0.00545862503349781, -0.0018782191909849644, 0.07224764674901962, 0.05201520398259163, -0.006873345468193293, 0.05258367583155632, 0.024806058034300804, -0.020710475742816925, 0.005801000166684389, -0.06821665912866592, -0.025167813524603844, 0.012687265872955322, -0.022454651072621346, -0.06676964461803436, -0.020167842507362366, 0.0456586517393589, 0.0013275117380544543, -0.005926968529820442, -0.007571015972644091, 0.023423638194799423, -0.03811347484588623, -0.01963813044130802, 0.028733685612678528, -0.029586393386125565, 0.0488627664744854, -0.04870773106813431, 0.038035955280065536, -0.013940487988293171, -0.02914711833000183, 0.027234984561800957, 0.03485767915844917, 0.005791310220956802, 0.009218293242156506, 0.08821654319763184, 0.020012805238366127, 0.003333314089104533, -0.042945489287376404, 0.04209278151392937, -0.0001224355073645711, -0.01355289388448, 0.0027196225710213184, -0.000658507167827338, 0.013178219087421894, 0.010846191085875034, -0.04692479595541954, -0.0014873945619910955, 0.009676947258412838, 0.0007287587504833937, -0.012112333439290524, -0.010691152885556221, -0.04338476434350014, 0.01355289388448, 0.012693725526332855, 0.03622718155384064, -0.013527054339647293, -0.023061882704496384, 0.0021608402021229267, -0.05421157553792, 0.02713162638247013, 0.02328152023255825, 0.038190994411706924, -0.0033688435796648264, -0.018423667177557945, -0.018552863970398903, 0.029276316985487938, -0.010755752213299274, -0.013875889591872692, 0.009295811876654625, -0.015012833289802074, 0.040594082325696945, -0.03614966198801994, 0.03775171935558319, -0.012590366415679455, -0.006427611690014601, 0.0047964840196073055, 0.07782901078462601, -0.050671543926000595, -0.008042589761316776, -0.0600513331592083, 0.03209283947944641, -0.013772530481219292, -0.009664027020335197, 0.010652393102645874, 0.008397884666919708, -0.027803458273410797, 0.007945690304040909, 0.02785513736307621, 0.006782906595617533, -0.013940487988293171, 0.02187325991690159, 0.0006661783554591238, 0.008210547268390656, -0.000256579602137208, -0.015516706742346287, -0.03020654432475567, -0.04015480726957321, 0.04943123832345009, 0.011589081026613712, -0.01448312122374773, -0.022118736058473587, -0.014819036237895489, -0.03612382337450981, 0.00551999406889081, 0.02746754139661789, 0.009043875150382519, -0.01403092686086893, -0.04519353806972504, -9.831177158048376e-05, 0.012881062924861908, 0.006611719261854887, 0.015426267869770527, -0.0001585706340847537, 0.009425010532140732, -0.04291965067386627, 0.012235071510076523, -0.017092924565076828, 0.023591594770550728, 0.08919845521450043, 0.015620064921677113, -0.02237713150680065, 0.005235758144408464, 0.013223438523709774, 0.05025810748338699, 0.09508989006280899, -0.00981906522065401, 0.0034592824522405863, -0.0237337127327919, -0.0174417607486248, -0.02189909853041172, -0.010975388810038567, -0.003071687649935484, 0.013695011846721172, -0.030645819380879402, 0.06439239531755447, 0.0012491852976381779, -0.0021123909391462803, 0.006020637229084969, 0.010968929156661034, -0.07121405750513077, 0.010800971649587154, 0.012493467889726162, 0.03219619765877724, 0.010219579562544823, 0.016175618395209312, 0.012487008236348629, -0.018604544922709465, 0.023359037935733795, 0.032712988555431366, -0.024134228006005287, -0.00561043294146657, 0.024134228006005287, 0.013003800995647907, 0.07788068801164627, -0.017725996673107147, 0.04227365925908089, -0.011815177276730537, -0.00564919225871563, 0.0380876362323761, -0.028113532811403275, -0.01230613049119711, -0.00783587247133255, -0.03697653114795685, -0.047028154134750366, -0.020930111408233643, 0.008300986140966415, 0.02801017463207245, -0.01639525406062603, -0.021769899874925613, 0.0030103186145424843, -0.011324224062263966, -0.00651159044355154, 0.028165211901068687, 0.00659556919708848, 0.015658823773264885, -0.0024273116141557693, -0.04819093644618988, 0.022855166345834732, -0.02839776873588562, 0.04707983136177063, 0.058552633970975876, 0.03167940303683281, -0.036563098430633545, -0.008275146596133709, 0.0042990706861019135, 0.025309931486845016, -0.02352699637413025, -0.010439216159284115, 0.00213177059777081, -0.01913425698876381, 0.027079947292804718, 0.029793109744787216, 0.015542546287178993, 0.019986964762210846, 0.057467371225357056, -0.04950875788927078, -0.012112333439290524, 0.01007746160030365, 0.02126602828502655, -0.04201526194810867, -0.020826753228902817, -0.015167871490120888, -0.02124018780887127, 0.0037532083224505186, 0.00228680856525898, -0.017467599362134933, -0.03002566657960415, 0.0012717950157821178, 0.023630354553461075, 0.02547788992524147, 0.020749235525727272, -0.020413318648934364, 0.0053681861609220505, 0.02003864385187626, -0.04046488180756569, 0.013346176594495773, -0.03961217403411865, 0.03384993597865105, 0.04069744050502777, 0.020012805238366127, 0.013811290264129639, 0.015232470817863941, 0.01111750677227974, 0.010361697524785995, 0.01639525406062603, -0.013229898177087307, 0.0009609117987565696, 0.059276144951581955, 0.023953350260853767, -0.048320136964321136, -0.05591699108481407, -0.013223438523709774, -0.0129779614508152, -0.00892113707959652, -0.009405630640685558, 0.028449447825551033, 0.0024741459637880325, 0.016989566385746002, -0.03594294562935829, 0.04284213110804558, 0.058914389461278915, 0.025710446760058403, -0.041498471051454544, 0.0034592824522405863, -0.05255783721804619, -0.008636901155114174, -0.017170444130897522, 0.031085092574357986, 0.03281635046005249, 0.09415966272354126, 0.003546491265296936, 0.05033562704920769, -0.00962526723742485, -0.03366905823349953, 0.019935285672545433, -0.007157581392675638, 0.04366900026798248, 0.015271229669451714, -0.008307445794343948, 0.0380876362323761, -0.0058946688659489155, 0.05974125862121582, 0.018578704446554184, 0.010936629958450794, -0.01558130607008934, -0.010607173666357994, -0.0289145614951849, 0.025516649708151817, 0.008120108395814896, -0.045348577201366425, -0.025284092873334885, -0.05472836643457413, 0.019353894516825676, -0.006156295537948608, -0.006430841516703367, -0.02950887382030487, -0.029224637895822525, -0.007131741847842932, -0.0038436471950262785, 0.05312630906701088, 0.02746754139661789, -0.038035955280065536, 0.033824093639850616, 0.017222123220562935, -0.034521766006946564, -0.017725996673107147, -0.014496040530502796, 0.01967689022421837, -0.03723492845892906, 0.03149852529168129, -0.02445722371339798, -0.012803544290363789, -0.0065987990237772465, 0.01807483099400997, 0.05126585438847542, -0.004983821418136358, 0.023694954812526703, -0.052144404500722885, 0.05338470637798309, 0.010096841491758823, 0.03961217403411865, -0.0012419179547578096, 0.03992225229740143, -0.02214457467198372, -0.03193780034780502, -0.010439216159284115, 0.005891439039260149, 0.04341060295701027, 0.02237713150680065, 0.008675660938024521, -0.006007717456668615, -0.03328146040439606, 0.010833270847797394, -0.02427634596824646, 0.00219959975220263, -0.000231547441217117, -0.025503728538751602, 0.022312533110380173, -0.020736314356327057, -0.03826851397752762, 0.011685979552567005, 0.014663998037576675, 0.021679461002349854, -0.015788022428750992, 0.022299613803625107, -0.04713151231408119, 0.02198953740298748, 0.06899185478687286, 0.03723492845892906, 0.01949601247906685, 0.012881062924861908, -0.005229298025369644, -0.027984336018562317, -0.017829354852437973, 0.020736314356327057, -0.01403092686086893, -0.02452182210981846, -0.04227365925908089, -0.02529701218008995, -0.00911493506282568, 0.023023122921586037, -0.001954123144969344, 0.02785513736307621, 0.0006653708405792713, 0.016795769333839417, 0.03131764754652977, 0.004780334420502186, 0.052893754094839096, 0.014534800313413143, 0.01934097334742546, 0.006469600833952427, 0.03961217403411865, 0.007170501165091991, 0.07602023333311081, -0.017105843871831894, 0.015529626049101353, -0.004735114984214306, 0.025503728538751602, -0.024741459637880325, 0.003892096458002925, -0.017235042527318, -0.0020494067575782537, 0.03478016331791878, 0.03237707540392876, -0.025891324505209923, -0.00797153078019619, 0.025736285373568535, 0.008184707723557949, -0.024418463930487633, -0.06883681565523148, -0.011136886663734913, -0.01315883919596672, 0.018811261281371117, -0.015981819480657578, -0.002634028671309352, 0.012874603271484375, -0.05235112085938454, -0.00756455585360527, -0.006905645132064819, -0.02713162638247013, -0.05555523559451103, 0.023320280015468597, 0.01822987012565136, 0.008682120591402054, 0.004848163109272718, 0.0348835214972496, 0.005025811027735472, -0.02135646715760231, 0.028526967391371727, -0.03240291401743889, 0.012945662252604961, 0.03956049680709839, 0.046847276389598846, -0.005859139375388622, -0.007260940037667751, -0.017893953248858452, -0.026330597698688507, -0.0060949260368943214, -0.000920537335332483, 0.0040535940788686275, 0.03824267536401749, 0.02749338187277317, -0.015090352855622768, 0.01125316508114338, -0.009502529166638851, -0.008217006921768188, -0.01538750808686018, 0.03322978317737579, -0.016369415447115898, -0.031576044857501984, -0.024896496906876564, -0.004909532610327005, -0.030516620725393295, -9.755475184647366e-05, 0.00857230182737112, -0.006172445137053728, 0.018449505791068077, 0.002369172405451536, 0.05550355836749077, 0.004237701650708914, 0.03353985771536827, 0.026369357481598854, -0.025051536038517952, -0.008016749285161495, -0.03387577459216118, -0.024444304406642914, -0.050283949822187424, -0.015658823773264885, -0.04439251124858856, 0.02271304838359356, -0.01940557360649109, 0.029043760150671005, 0.02384999208152294, -0.010083921253681183, 0.00870796013623476, -0.006259653717279434, -0.02676987089216709, -0.02087843231856823, -0.04798422008752823, 0.0058655994944274426, 0.004754494410008192, 0.018565785139799118, 0.0046866657212376595, 0.0028455909341573715, 0.02165362238883972, 0.001965428004041314, 0.0076614548452198505, -0.010426296852529049, -0.019961126148700714, 0.015658823773264885, 0.015865541994571686, -0.016472773626446724, -0.01538750808686018, -0.010051622055470943, -0.0014736672164872289, 0.001228190609253943, -0.02896624244749546, -0.006311333272606134, -0.014819036237895489, -0.03607214242219925, 0.06625284999608994, 0.013132999651134014, -0.0007501571672037244, -0.0007287587504833937, 0.009198913350701332, 0.003166971495375037, 0.01954769156873226, -0.006182135082781315, -0.012008975259959698, -0.03359153866767883, -0.00866274069994688, -0.01816526986658573, -0.023669114336371422, -0.03780340030789375, 0.0046479059383273125, 0.021524423733353615, -0.031989481300115585, 0.010652393102645874, 0.021924939006567, -0.022674288600683212, 0.021563183516263962, -0.034160010516643524, 0.02291976474225521, 0.03772588074207306, 0.004063284024596214, -0.029224637895822525, 0.049379561096429825, -0.016227297484874725, -0.011776418425142765, 0.031085092574357986, -0.014935314655303955, -0.019870687276124954, -0.02457350119948387, -0.048836927860975266, 0.030826695263385773, 0.04366900026798248, 0.005781620275229216, -0.005316507071256638, 0.005675031803548336, 0.0029037301428616047, 0.030723337084054947, 0.020258281379938126, -0.03793259710073471, -0.0326613113284111, -0.015813862904906273, 0.03950881585478783, 0.011724738404154778, 0.00020833213056903332, 0.008598141372203827, 0.036356378346681595, 0.00664078863337636, -0.01822987012565136, 0.04418579116463661, -0.0010683077853173018, 0.0035852505825459957, -0.02289392426609993, -0.011666599661111832, -0.04054240137338638, -0.02255800925195217, -0.035787906497716904, -0.04413411393761635, 0.013940487988293171, -0.026976589113473892, -0.0023933970369398594, -0.03131764754652977, -0.02751922234892845, -0.038216833025217056, 0.010568414814770222, 0.0031492067500948906, -0.004680205602198839, 0.0010448906105011702, -0.03524527698755264, -0.00992888305336237, -0.009295811876654625, 0.030852535739541054, -0.023953350260853767, 0.029405515640974045, 0.027777617797255516, -0.040232326835393906, 0.03061997890472412, 0.01931513473391533, -0.044805943965911865, 0.014095526188611984, 0.022092895582318306, -0.025968842208385468, -0.004935372155159712, -0.014056766405701637, -0.031007573008537292, -0.017454680055379868, 0.017364241182804108, 0.06284201890230179, -0.002740617375820875, 0.0033058596309274435, -0.00779065303504467, -0.0018265398684889078, 0.013888808898627758, -0.03715740889310837, 0.02237713150680065, 0.04875940829515457, 0.0331522636115551, -0.016291895881295204, 0.0026986279990524054, -0.03211867809295654, -0.003178276354447007, -0.029560552909970284, -0.013785450719296932, 0.027079947292804718, -0.011989595368504524, -0.0183849073946476, 0.041472628712654114, -0.005852679722011089, 0.05384982004761696, 0.009877203963696957, 0.002367557492107153, 0.02421174757182598, 0.024224666878581047, -0.03341066092252731, 0.01355289388448, -0.00040273508056998253, -0.0318344421684742, 0.005077490117400885, -0.005222838371992111, -0.006879805587232113, -0.010012862272560596, -0.020581277087330818, 0.020891353487968445, 0.030568299815058708, 0.010051622055470943, 0.02785513736307621, 0.03284218907356262, 0.009386250749230385, -0.0007142239483073354, -0.040413204580545425, 0.01090432982891798, 0.02049083821475506, -0.016627810895442963, 0.01103998813778162, -0.011285465210676193, 0.008714419789612293, 0.013811290264129639, -0.02764841914176941, -0.008365584537386894, 0.0005252715200185776, 0.02114974893629551, 0.001414720551110804, 0.002054251730442047, -0.002582349581643939, 0.0020558666437864304, -0.011660140007734299, -0.004153722897171974, 0.026640674099326134, 0.0019573529716581106, -0.0013880734331905842, 0.005329426843672991, 0.02334611862897873, 0.014780276454985142, 0.019030898809432983, 0.0007340073934756219, 0.02162778191268444, -0.005881749093532562, 0.014508960768580437, -0.01748051866889, -0.04465090483427048, -0.016356494277715683, 0.01315883919596672, 0.01249992847442627, -0.003905016230419278, -0.0028778903651982546, -0.04012896865606308, -0.007215720601379871, 0.03625302016735077, -0.013223438523709774, -0.01732548139989376, 0.012984421104192734, 0.019237615168094635, 0.00888883788138628, 0.04767414554953575, 0.08129151910543442, -0.02448306418955326, -0.08413388580083847, -0.007771273143589497, 0.005358496215194464, 0.01609809882938862, 0.018191110342741013, -0.008288065902888775, -0.004751264583319426, -0.0159172210842371, 0.033824093639850616, 0.009709246456623077, -0.005552293732762337, -0.03245459496974945, -0.01820402964949608, -0.008585222065448761, 0.018824180588126183, -0.04335892200469971, -0.02801017463207245, -0.0032848648261278868, 0.04286796972155571, 0.017558038234710693, -0.028862882405519485, -0.010135600343346596, 0.01820402964949608, 0.013759611174464226, -0.019211776554584503, 0.00010088564158650115, 0.010561955161392689, -0.0013404315104708076, -0.0011563240550458431, 0.04348812252283096, 0.009844904765486717, -0.02045207843184471, 0.015374588780105114, 0.037079889327287674, -0.0282168909907341, -0.004731884691864252, 0.0020009574946016073, 0.023061882704496384, 0.0017797055188566446, 0.02434094436466694, 0.006052936892956495, -0.04630464315414429, 0.048630211502313614, 0.002164070261642337, 0.017170444130897522, 0.005358496215194464, 0.054314933717250824, -0.029818950220942497, 0.0010618478991091251, 0.0006084428750909865, 0.038733627647161484, 0.005607202649116516, 0.004948291927576065, -0.0016779619036242366, -0.011375903151929379, -0.02894040197134018, -0.025193654000759125, 0.005652422085404396, -0.004131113179028034, 0.005959268193691969, 0.004324910696595907, 0.011556780897080898, -0.008288065902888775, -0.009386250749230385, -0.049198683351278305, -0.016459854319691658, 0.024198826402425766, 0.01870790310204029, -0.020348720252513885, -0.04198942333459854, -0.024147147312760353, -7.161417306633666e-05, -0.02409546822309494, 0.029586393386125565, 0.002155995462089777, -0.03387577459216118, -0.001054580439813435, 0.02027120068669319, -0.025710446760058403, -0.0010965699329972267, 0.04769998416304588, -0.02375955320894718, 0.016589051112532616, 0.006996084004640579, 0.018733741715550423, 0.024831898510456085, 0.030749177560210228, -0.015994740650057793, -0.03813931718468666, 0.008494783192873001, 0.039999768137931824, 0.003105602227151394, 0.026899069547653198, -0.010755752213299274, 0.0013743460876867175, -0.011498642154037952, -0.004373359959572554, 0.034547604620456696, 0.0016924967058002949, 0.00910201482474804, 0.02003864385187626, 0.03772588074207306, -0.014767357148230076, -0.02178282104432583, 0.01976732723414898, -0.013617492280900478, 0.04630464315414429, -0.0015342289116233587, 0.04418579116463661, -0.03111093118786812, 0.03925041854381561, -0.016382334753870964, 0.002490295795723796, 0.02334611862897873, -0.00226419884711504, 0.013036101125180721, 0.020167842507362366, 0.06816498190164566, 0.03702821210026741, 0.010820351541042328, 0.011272544972598553, -0.02436678484082222, 0.004040674306452274, 0.004211862105876207, -0.018010232597589493, -0.03025822341442108, -0.005507074296474457, 0.025322850793600082, 0.005203458480536938, 0.007751893252134323, 0.016111018136143684, 0.004893382545560598, 0.0014324852963909507, 0.028707845136523247, 0.003250950248911977, 0.02403086982667446, 0.018720822408795357, 0.023242760449647903, -0.017338400706648827, 0.03173108398914337, 0.001862069359049201, 0.0017361011123284698, 0.027725938707590103, 0.02379831299185753, 0.007577475626021624, 0.03408249095082283, -0.034160010516643524, -0.023307358846068382, 0.004802944138646126, 0.032532110810279846, 0.04173102602362633, -0.019030898809432983, 0.008695040829479694, 0.014870715327560902, 0.010613634251058102, 0.03353985771536827, 0.03188612312078476, -0.021756980568170547, -0.021550264209508896, 0.0020009574946016073, 0.015749262645840645, 0.04036152362823486, 0.00446702865883708, -0.028449447825551033, 0.02072339504957199, -0.018720822408795357, -0.02878536470234394, -0.018966298550367355, 0.01538750808686018, 0.0026001143269240856, -0.016886208206415176, -0.08046465367078781, 0.027803458273410797, 0.03335897997021675, 0.004844933282583952, 0.0008680505561642349, -0.009205373004078865, 0.0007586358115077019, 0.01218339242041111, 0.024831898510456085, 0.0015269614523276687, 0.016085179522633553, 0.0018814491340890527, -0.003468972397968173, -0.0032703299075365067, -0.00229811342433095, -0.03155020624399185, -0.023875830695033073, -0.003546491265296936, 0.021162668243050575, 0.010639473795890808, 0.007887551560997963, -0.007932770997285843, 0.01015498023480177, 0.029586393386125565, -0.014689837582409382, -0.0031023724004626274, 0.042635414749383926, -0.01684744842350483, -0.055813632905483246, -0.0519893653690815, 0.06304873526096344, 0.003116907086223364, -0.010406916961073875, -0.028862882405519485, 0.025736285373568535, 0.0032444903627038, -0.04496098309755325, -0.0042764609679579735, 0.009554208256304264, 0.03041326254606247, 0.012008975259959698, -0.00988366361707449, 0.012383650057017803, 0.05242864042520523, -0.05374646186828613, -0.0033300842624157667, -0.0069185649044811726, -0.013126539066433907, -0.006653708405792713, -0.028113532811403275, -0.024250507354736328, 0.003163741435855627, 0.02346239797770977, -0.00332362437620759, 0.03245459496974945, 0.03059413842856884, 0.018178189173340797, -0.004609146621078253, 0.022402971982955933, -0.00782295223325491, 0.026343517005443573, -0.02948303520679474, 0.015012833289802074, -0.007383678574115038, -0.00554260378703475, -0.01859162375330925, -0.0037758180405944586, 0.009483149275183678, 0.0019783477764576674, 0.02622723951935768, 0.005416635423898697, -0.017351321876049042, -0.0018007002072408795, 5.3546606068266556e-05, 0.01226091105490923, 0.028268571943044662, 0.038914505392313004, -0.03540031239390373, 0.01540042832493782, -0.0006568921962752938, 0.02210581675171852, 0.01113042701035738, -0.022661367431282997, -0.0055232238955795765, -0.0004966056440025568, 0.00020601060532499105, 0.04201526194810867, 0.03976721316576004, 0.02126602828502655, -0.0336432158946991, 0.038940344005823135, 0.019276374951004982, -0.0024289265275001526, -0.0027583821211010218, -0.028346089646220207, 0.010051622055470943, 0.009360411204397678, 0.003175046294927597, 0.022402971982955933, 0.010671772994101048, 0.007034843321889639, 0.020025724545121193, 0.015452107414603233, 0.005681491922587156, 0.006705387961119413, 0.06702803820371628, 0.003982535097748041, 0.03431504964828491, -0.00030018400866538286, -0.004289381206035614, -0.04780334234237671, -0.012021894566714764, 0.009166614152491093, 0.01952185109257698, -0.00664078863337636, 0.029017921537160873, -0.009554208256304264, 0.014663998037576675, 0.06346216797828674, -0.030749177560210228, 0.04855269193649292, -0.01419888436794281, -0.023139402270317078, 0.06273865699768066, -0.017092924565076828, -0.026343517005443573, 0.022183334454894066, 0.01573634333908558, -0.002356252633035183, 0.035451993346214294, 0.000490549486130476, -0.0044928682036697865, -0.009399170987308025, -0.009521909058094025, 0.026976589113473892, -0.029043760150671005, -0.0326613113284111, -0.015206631273031235, -0.028087694197893143, -0.01739008165895939, 0.005736401304602623, -0.0008397884666919708, 0.02436678484082222, 0.010322937741875648, 0.004764184355735779, -0.022751806303858757, -0.003533571492880583, 0.027183305472135544, -0.02554248832166195, 0.02984478883445263, 0.014612318947911263, 0.00770021416246891, 0.03408249095082283, -0.03351401910185814, -0.022661367431282997, -0.04126591235399246, -0.015245390124619007, -0.02391459047794342, 0.037286605685949326, 0.008565842173993587, 0.02151150442659855, -0.015012833289802074, 0.00219152495265007, -0.010536114685237408, 0.008507703430950642, 0.019392652437090874, -0.008178247138857841, -0.01870790310204029, -0.009592968039214611, 0.031007573008537292, 0.03372073546051979, -0.0034043730702251196, 0.016278976574540138, -0.02824273146688938, 0.02953471429646015, -0.004715735092759132, 0.012538687326014042, 0.02024536207318306, -0.025529569014906883, 0.06666628271341324, -0.007280319929122925, 0.005965727847069502, 0.00852708239108324, -0.006560039706528187, 0.044625066220760345, -0.0015834857476875186, -0.034160010516643524, -0.021756980568170547, 0.013720851391553879, 0.006866885349154472, 0.031007573008537292, -0.017428839579224586, -0.008475403301417828, 0.023901671171188354, 0.008255766704678535, -0.02520657330751419, 0.011459882371127605, 0.005704101640731096, 0.039405457675457, 0.001005323720164597, 0.0036563097964972258, -0.005804229993373156, -0.0331522636115551, -0.0048417034558951855, 0.008333285339176655, -0.002680863020941615, 0.03328146040439606, 0.020193682983517647, 0.021589023992419243, -0.005284207407385111, -0.018604544922709465, -0.046252962201833725, 0.022312533110380173, -0.021291866898536682, 0.027958495542407036, 0.009405630640685558, 0.005119479726999998, 0.002330412855371833, 0.0016198226949200034, 0.018087750300765038, 0.0038533369079232216, -0.01859162375330925, 0.009870744310319424, -0.03423753008246422, 0.00795861054211855, 0.011543861590325832, 0.009405630640685558, -0.01555546559393406, 0.021485663950443268, 0.019030898809432983, -0.001077190157957375, 0.01630481518805027, 0.005058110225945711, 0.0021172359120100737, 0.017131684347987175, -0.0010497355833649635, 0.03664061427116394, 0.003578790696337819, -0.009269972331821918, -0.007215720601379871, 0.008462483994662762, -0.02232545241713524, 0.03384993597865105, -0.01762263849377632, 0.012661425396800041, 0.004163412842899561, 0.02024536207318306, -0.015271229669451714, -0.004063284024596214, -0.04142095148563385, -0.023359037935733795, -0.008300986140966415, -0.015025753527879715, 0.010439216159284115, -0.010781591758131981, -0.02174406126141548, 0.031576044857501984, 0.014586479403078556, 0.003930856008082628, -0.020762154832482338, 0.01985776610672474, -0.029069600626826286, 0.019198855385184288, 0.0007477347389794886, 0.004835243336856365, 0.007157581392675638, -0.010413376614451408, -0.020413318648934364, 0.016886208206415176, -0.021291866898536682, 0.0237337127327919, 0.03245459496974945, 0.005038730800151825, -0.02291976474225521, -0.0032800198532640934, -0.017906874418258667, -0.0013945333193987608, -0.006324253045022488, 0.002613034099340439, -0.023061882704496384, 0.016201457008719444, 0.00887591764330864, -0.002209289697930217, -0.023359037935733795, -0.0061110761016607285, -0.018178189173340797, -0.022480491548776627, 0.0040988135151565075, 0.012965042144060135, 0.01301026064902544, -0.016679489985108376, 0.02968975156545639, 0.02499985694885254, -0.002863355679437518, 0.005358496215194464, 0.015064512379467487, 0.06170507147908211, 0.016459854319691658, -0.018539944663643837, 0.011589081026613712, -0.0002529459015931934, 0.027209145948290825, -0.004321680404245853, -0.010452136397361755, -0.0015826781746000051, -0.010704073123633862, -0.008423724211752415, 0.0033042444847524166, 0.01474151760339737, -0.021123910322785378, -0.010678233578801155, -0.006563269533216953, -0.008236386813223362, 0.00962526723742485, 0.013320337049663067, 0.015800943598151207, 0.009399170987308025, -0.01868206262588501, -0.02875952422618866, 0.029922308400273323, 0.001333971624262631, 0.001895983936265111, 0.01576218381524086, 0.010226039215922356, -0.0022044447250664234, 0.043178047984838486, -0.011330683715641499, -0.008307445794343948, -0.02746754139661789, -0.010490895248949528, 0.02207997627556324, -0.025516649708151817, 0.01762263849377632, -0.002601729240268469, 0.006379162427037954, -0.003175046294927597, -0.02126602828502655, 0.013630412518978119, -0.017558038234710693, 0.03131764754652977, -0.02493525668978691, 0.004634986165910959, 0.021033471450209618, 0.05144673213362694, -0.012558067217469215, 0.008210547268390656, -0.013333256356418133, 0.011614920571446419, -0.02671819180250168, 0.02099471166729927, 0.020297041162848473, -0.00857230182737112, 0.006627868860960007, -0.011001228354871273, -0.027338344603776932, -0.023397797718644142, 0.0019153637113049626, -0.004105273634195328, 0.03961217403411865, -0.025103215128183365, -0.00887591764330864, 0.022170415148139, 0.015658823773264885, 0.003633700078353286, 0.001065885298885405, -0.0027616119477897882, 0.0036595396231859922, 0.01711876504123211, -0.013656252063810825, 0.019173016771674156, -0.008940516971051693, 0.01988360658288002, 0.016589051112532616, 0.02839776873588562, 0.03607214242219925, 0.025245333090424538, -0.006149835418909788, 0.010439216159284115, -0.02033580094575882, 0.052480317652225494, 0.0046479059383273125, 0.016705330461263657, -0.002063941676169634, 0.0069702439941465855, -0.009218293242156506, 0.01976732723414898, 0.012422408908605576, 0.009302272461354733, -0.01678285002708435, 0.010484435595571995, -0.03648557886481285, 0.005132399499416351, 0.016834529116749763, 0.0021027009934186935, 0.0018556094728410244, -0.008675660938024521, 0.0044411891140043736, -0.027880975976586342, -0.028733685612678528, 0.04310052841901779, 0.00967048667371273, 0.02114974893629551, -0.005352036561816931, -0.008294525556266308, 0.014625239185988903, 0.00015150509716477245, 0.034366726875305176, -0.0025661997497081757, 0.011524481698870659, 0.00326387002132833, 0.006976704113185406, -0.009127854369580746, 0.0009399170521646738, -0.013081319630146027, -0.02189909853041172, -0.009567128494381905, -0.002937644487246871, -0.032325394451618195, -0.00971570611000061, 0.012202772311866283, -0.006718307733535767, 0.03511607646942139, -0.010129140689969063, 0.0022012146655470133, 0.01364333275705576, 0.02806185372173786, 0.008940516971051693, -0.03705405071377754, 0.010794511996209621, -0.01777767576277256, -0.011337144300341606, 0.010432756505906582, -0.02547788992524147, 0.0055458336137235165, -0.036718133836984634, 0.01306840032339096, 0.003704759059473872, 0.006472831126302481, 0.05338470637798309, 0.0201549232006073, -0.02454766258597374, 0.027958495542407036, -0.004925682209432125, -0.01456063985824585, 0.023901671171188354, -0.0024402313865721226, 0.02656315453350544, 0.009496069513261318, -0.03222203627228737, -0.0046414462849497795, 0.0434364415705204, 0.006660168524831533, -0.017519278451800346, -0.018307387828826904, 0.010684693232178688, 0.001480934675782919, 0.011324224062263966, 0.0027422322891652584, -0.031421009451150894, -0.0053229667246341705, 0.01630481518805027, -0.031627725809812546, -0.009502529166638851, -0.0019589681178331375, 0.04366900026798248, 0.00664078863337636, -0.0067635271698236465, -0.0020348720718175173, 0.03284218907356262, -0.012990881688892841, 0.013927568681538105, -0.0030442331917583942, -0.002629183931276202, 0.0018200799822807312, -0.0022109046112746, -0.00792631134390831, -0.02099471166729927, -0.003788737813010812, 0.03519359603524208, -0.009095555171370506, -0.012383650057017803, -0.014986993744969368, 0.03878530487418175, 0.024495983496308327, 0.038423553109169006, -0.020736314356327057, 0.018824180588126183, -0.007997370325028896, 0.003824267303571105, -0.000875317957252264, -0.0060949260368943214, -0.010303557850420475, 0.01329449750483036, 0.015775103121995926, 0.003162126522511244, -0.019625209271907806, 0.017558038234710693, -0.02298436313867569, 0.02819105237722397, -0.008591681718826294, 0.007054222747683525, -0.003691839287057519, -0.021860338747501373, -0.0030248533003032207, -0.0066020293161273, -0.023216919973492622, -0.01456063985824585, 0.03281635046005249, 0.007280319929122925, 0.029999827966094017, 0.013565813191235065, 0.038010116666555405, -0.01633065566420555, -0.03428920730948448, 0.03596878424286842, -0.0025209803134202957, 0.025232413783669472, 0.025167813524603844, -0.033048905432224274, -0.041705187410116196, 0.008992196060717106, -0.027338344603776932, -0.0015455337706953287, -0.01221569161862135, 0.020439159125089645, -0.03245459496974945, 0.006627868860960007, 0.0017296412261202931, 0.026666512712836266, 0.023501155897974968, 0.020193682983517647, -0.00888883788138628, -0.005316507071256638, -0.01573634333908558, 0.026098040863871574, -0.013720851391553879, -0.027209145948290825, -0.02950887382030487, -0.024379704147577286, -0.026240158826112747, 0.016718249768018723, 0.008365584537386894, 0.020103244110941887, 0.00033288728445768356, -0.030826695263385773, -0.001469629816710949, -0.006912104785442352, -0.01219631265848875, 0.003727368777617812, -0.014676918275654316, 0.015426267869770527, 0.00439919950440526, 0.022958524525165558, -0.030671657994389534, 0.01512911170721054, -0.027725938707590103, 0.019870687276124954, 0.005258367862552404, 0.00879839900881052, 0.0007356223650276661, -0.021201428025960922, -0.011937915347516537, -0.03330730274319649, -0.014250564388930798, 0.0060723163187503815, 0.002364327432587743, 0.008068429306149483, -0.01113042701035738]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"., 2012)
which takes into consideration both the objective function
and constraints and has been shown to have better conver-
gence rate for conventional low-rank matrix optimization
problems involving matrix sensing and robust PCA (Can-
des et al., 2009). Our work shows for the first time that
1arXiv:2402.02347v3  [cs.LG]  5 Jun 2024
Riemannian Preconditioned LoRA
Figure 1. Generation results for prompt “a blue ⟨Vvase⟩” after fine-tuning on 6red vase images of the Stable Diffusion V1.5 model. No
black images are observed for our method (scaled AdamW)’s generation and AdamW generates only black images for large learning rates.
Our method generates photos better capturing the prompt and is more robust to learning rate changes. See Section 6.4.1 for experimental
details.
this preconditioner enables LoRA to achieve stable feature
learning with Adam optimizer, revealing the superiority of
preconditioning in fine-tuning deep learning models. Em-
pirically, we verify the validity of this new preconditioner
for LoRA training via extensive fine-tuning tasks for both
language models and text-to-image diffusion models. The
experimental results show that the convergence of both SGD
and AdamW is significantly enhanced by preconditioning
(gradient scaling). Despite the accelerated convergence, the
optimization procedure also becomes more robust to learn-
ing rate changes with this new preconditioner. Figure 1
compares the generation results for diffusion model fine-
tuning with AdamW optimizer with and without gradient
scaling, from which it can be observed that gradient scal-
ing significantly improves the generation quality as well as
training robustness against learning rate changes, see Algo-
rithm 1 for the formal algorithm for scaled AdamW. Most
importantly, our preconditioner is only of dimension rbyr
thus the storage overhead is negligible for small LoRA rank
r. Also, unlike most second-order preconditioners based
on Hessian inverses, inverting an rbyrmatrix for small r
introduces negligible runtime overhead and runs as fast as
unpreconditioned optimizers. In practice, small values, e.g.,
r= 4, are usually used as default for LoRA fine-tuning, see
Figure 2 for runtime comparison when fine-tuning GPT-2
with both scaled and unscaled optimizers.
To summarize, we study the application of preconditioned
gradient updates (1) in LoRA training. Theoretically, we
show that the proposed preconditioner provides an elegant
solution to learning rate choices for stable feature learning
with LoRA under infinite-width NN setting. We also provide
a convergence guarantee for fine-tuning a reparameterized
model which is equivalent to a two-layer ReLU network via
convexification. See Section 4 and Section 7 respectively
for details. Empirically, we apply this method for LoRA
fine-tuning for both large language and diffusion models
and observe that scaled optimizers significantly improvethe performance of unscaled optimizers. See Section 6 for
the experimental details. To the best of our knowledge,
this is the first work to apply Riemannian optimization in
designing preconditioners for fine-tuning large foundation
models. This approach is particularly appropriate given the
matrix factorization characteristics of the LoRA model.
Next, we first provide some intuition on our method in Sec-
tion 3. We then show that LoRA training with the proposed
preconditioners achieves stable feature learning in Section 4.
We include an overview of basic Riemannian optimization
concepts as well as the derivation of this preconditioner by
introduction of a new Riemannian metric in Section 5. We
offer a pseudocode and present extensive experimental re-
sults in Section 6. Finally we state our convergence results
for related problems in Section 7 and review prior literature
in Section 8.
2. Notation
We adopt same notation convention as in LoRA+ (Hayou
et al., 2024). Specifically, for any sequence sn∈Rand any
given cn∈R+, we use sn=O(cn)andsn= Ω( cn)to
represent sn< κc nandsn> κc nrespectively for some
κ >0.We use sn= Θ( cn)when both sn=O(cn)and
sn= Ω(cn). For vector and matrix sequences, the notation
is applied entrywise. For a sequence that is a vector of
random variables, convergence in second moment, i.e., L2
convergence, is adopted.
3. Theoretical Insights
We first","[0.02079349011182785, 0.0062452442944049835, 0.023148952051997185, -0.028003819286823273, -0.01277837809175253, -0.0035560925025492907, -0.0020037780050188303, -0.00558767793700099, -0.05187249556183815, 0.057839661836624146, -0.004586606752127409, 0.0016815377166494727, -0.05103499814867973, -0.004822153132408857, 0.03868190944194794, -0.015663817524909973, 0.039885811507701874, -0.016763033345341682, -0.007229957729578018, 0.05155843496322632, 0.03648348152637482, -0.028946002945303917, 0.005803595297038555, 0.02167024463415146, 0.021500129252672195, -0.013988823629915714, 0.037504181265830994, 0.055013108998537064, 0.051165856420993805, -0.019131580367684364, 0.020819662138819695, -0.020544858649373055, -0.05260530486702919, -0.03857722505927086, -0.01886986382305622, 0.005649835802614689, 0.02174876071512699, -0.009336787275969982, -0.0365619957447052, 0.018163224682211876, -0.014250541105866432, -0.06275995820760727, -0.05155843496322632, 0.018359513953328133, 0.012320371344685555, 0.031694043427705765, 0.013727105222642422, 0.0260540209710598, 0.006503690499812365, 0.03234833851456642, -0.06166074424982071, 0.048234615474939346, -0.01905306614935398, -0.04794672504067421, -0.04054010659456253, -0.009336787275969982, 0.038786597549915314, 0.009650848805904388, 0.03687605634331703, -0.027585070580244064, 0.05082562193274498, -0.0370330885052681, 0.031641699373722076, -0.03588153049349785, -0.023096607998013496, -0.025582928210496902, -0.06511542201042175, 0.0029067047871649265, 0.015114210546016693, 0.03734714910387993, -0.037190116941928864, -0.025857731699943542, 0.07301930338144302, -0.014917922206223011, -0.031563181430101395, 0.003261659760028124, 0.006726150866597891, 0.06736619770526886, 0.035305749624967575, 0.011783850379288197, 0.02299191989004612, -0.013327986001968384, 0.05689748004078865, -0.02193196304142475, -0.009925652295351028, -0.06433026492595673, -0.010416373610496521, -0.012307286262512207, -0.003899597330018878, 0.01690697856247425, 0.001284053665585816, 0.007786108646541834, -0.013000838458538055, 0.04140377789735794, 0.032008104026317596, 0.009114326909184456, 0.027401868253946304, -0.005940997041761875, 0.06406854838132858, 0.03967643901705742, 0.010043425485491753, -0.03399715945124626, 0.061084967106580734, -0.05260530486702919, 0.044727593660354614, 0.0050184414722025394, 0.003857068018987775, 0.0033990617375820875, -0.01411968283355236, 0.015729248523712158, -0.014446830376982689, 0.03957175090909004, -0.0379491001367569, -0.0075047616846859455, 0.010337858460843563, -0.08704738318920135, -0.06192246451973915, 0.0009315522620454431, -0.03729480504989624, -0.013465387746691704, 0.00042774525354616344, -0.01254283171147108, -0.0075047616846859455, 0.01677612029016018, 0.019223181530833244, -0.03543660789728165, 0.07061149924993515, -0.05155843496322632, 0.028501082211732864, -0.0037752811331301928, 0.05174163728952408, 0.0534689724445343, 0.0237639881670475, -0.03917917609214783, -0.05773497745394707, -0.0051394859328866005, -0.0034383193124085665, -0.01056031882762909, 0.006896267645061016, -0.006016240920871496, -0.017705218866467476, -0.022651687264442444, 0.011044496670365334, -0.009997624903917313, -0.04231978952884674, 0.014459915459156036, -0.018346427008509636, 0.005172200500965118, -0.012372715398669243, -0.00011572839866857976, -0.018765175715088844, 0.010128484107553959, -0.046690478920936584, 0.028187021613121033, -0.020034508779644966, 0.0010885830270126462, -0.012163341045379639, 0.004586606752127409, 0.02774210087954998, -0.0027104164473712444, 0.0017420599469915032, 0.08155130594968796, 0.05359983444213867, -0.033709269016981125, 0.07134430855512619, 0.002528849523514509, -0.02486320398747921, 0.0075113046914339066, -0.05700216442346573, -0.016017137095332146, 0.022429227828979492, -0.010678092017769814, -0.06516776233911514, -0.030228421092033386, 0.0470830574631691, 0.00804128311574459, -0.019079238176345825, -0.01126695703715086, 0.031641699373722076, -0.03313349187374115, -0.017299555242061615, 0.026655972003936768, -0.045172516256570816, 0.047737352550029755, -0.02970498614013195, 0.02238996885716915, -0.022874146699905396, -0.038184646517038345, 0.01686772145330906, 0.04048776626586914, 0.012614804320037365, 0.0016815377166494727, 0.09165362268686295, 0.008538547903299332, 0.009297529235482216, -0.0566881038248539, 0.04046159237623215, 0.021696416661143303, -0.03007139079272747, 0.001428816351108253, 0.005466633476316929, 0.022599343210458755, 0.007746851071715355, -0.0308565441519022, 0.020767318084836006, -0.001689716475084424, -0.011299671605229378, -0.004360875114798546, -0.009009639732539654, -0.03339520841836929, 0.0023505541030317545, 0.0159909650683403, 0.03271474316716194, -0.021369269117712975, -0.02591007575392723, -0.004691293928772211, -0.045408062636852264, 0.04996195435523987, 0.012254942208528519, 0.02988818846642971, -0.005924639757722616, 0.01672377623617649, -0.006189628969877958, 0.02139544114470482, -0.0061929007060825825, -0.018542716279625893, 0.018215568736195564, -0.019641930237412453, 0.043994784355163574, -0.05333811417222023, 0.06485370546579361, -0.002903433283790946, -0.011646447703242302, -0.027532726526260376, 0.061399027705192566, -0.06302168220281601, 0.0036869514733552933, -0.0566881038248539, 0.020217711105942726, -0.021958135068416595, -0.0016259226249530911, 0.0028429110534489155, 0.0013192219194024801, -0.008257200941443443, 0.019079238176345825, 0.031249120831489563, -0.003804724430665374, 0.0037556523457169533, 0.03575066849589348, -0.002430705353617668, -0.013321442529559135, -0.029050691053271294, -0.014538431540131569, -0.0415869802236557, -0.04496314004063606, 0.049517031759023666, -0.0015179640613496304, -0.010671548545360565, -0.03614324703812599, 0.012608261778950691, -0.03190341591835022, -0.022088993340730667, 0.016488229855895042, 0.02002142183482647, 0.011855822056531906, -0.02167024463415146, -0.016435885801911354, -0.00029238799470476806, 0.02471925877034664, 0.002267131581902504, -0.005980254616588354, -0.009035811759531498, -0.060404498130083084, 0.004233287647366524, -0.03698074445128441, 0.004351060837507248, 0.0712919682264328, 0.023332154378294945, -0.03441590815782547, 0.0034514053259044886, 0.0032011375296860933, 0.04077565297484398, 0.09202002733945847, 0.005267073400318623, 0.006618192419409752, -0.0027202307246625423, -0.01235962938517332, -0.022232938557863235, -0.02464074268937111, -0.023096607998013496, 0.01745658554136753, -0.03342137858271599, 0.047423288226127625, -0.005195100791752338, -0.017286470159888268, -0.0063303024508059025, -0.004635679069906473, -0.04059245064854622, 0.013740191236138344, 0.010246257297694683, 0.03551512211561203, 0.010311686433851719, 0.008859151974320412, 0.010043425485491753, -0.047135401517152786, 0.033526066690683365, 0.023227466270327568, -0.008787179365754128, 0.017718303948640823, 0.03373544290661812, 0.008904952555894852, 0.0626029297709465, 0.0006718790391460061, 0.046454932540655136, -0.015389014966785908, -0.015009523369371891, 0.04116823151707649, -0.0383940227329731, 0.0010509610874578357, 0.006389189045876265, -0.020714974030852318, -0.03067334182560444, 0.001665180316194892, 0.006434989627450705, 0.026132535189390182, 0.007897338829934597, -0.0328979454934597, 0.012385801412165165, -0.002239324152469635, -0.026590542867779732, 0.0062223440036177635, -0.015362842939794064, 0.020505599677562714, 0.005767608992755413, -0.04917680099606514, 0.004354332108050585, -0.03399715945124626, 0.03339520841836929, 0.0388651117682457, 0.018765175715088844, -0.06574354320764542, -0.036719027906656265, -0.0011908166343346238, 0.018163224682211876, -0.012837264686822891, -0.014590774662792683, -0.014433744363486767, -0.01741732843220234, 0.029783500358462334, 0.020924348384141922, -0.0061241998337209225, -0.010723892599344254, 0.024850117042660713, -0.0021493586245924234, -0.01635737158358097, 0.020413998514413834, 0.013635504059493542, -0.04292174056172371, -0.06155605986714363, -0.002499406225979328, -0.03588153049349785, 0.009991082362830639, -0.004599692765623331, 0.0050315274856984615, -0.018084708601236343, -0.006994411814957857, -0.0006469340296462178, 0.05168929323554039, 0.026171794161200523, -0.02508566342294216, 0.007308473344892263, 0.03773972764611244, -0.02293957769870758, 0.00024249801936093718, -0.03760886564850807, 0.016252683475613594, 0.03991198539733887, 0.013341072015464306, 0.012202599085867405, 0.021735673770308495, -0.00463895034044981, -0.0018238468328490853, -0.0061471001245081425, -0.023659301921725273, 0.013020467013120651, 0.04231978952884674, 0.0051623862236738205, -0.03232216462492943, -0.05103499814867973, -0.01405425276607275, 0.006771951448172331, 0.0016733590746298432, -0.00941530242562294, 0.03295028954744339, -0.006552762817591429, 0.03287177160382271, -0.0338401272892952, 0.02865811437368393, 0.06668572872877121, 0.048601020127534866, -0.010403287597000599, 0.0005819134530611336, -0.040932685136795044, -0.002851089695468545, -0.011810021474957466, 0.030908888205885887, 0.0260540209710598, 0.06794197857379913, -0.0018058537971228361, 0.05412326753139496, -0.019641930237412453, -0.04048776626586914, 0.03130146488547325, -0.04030456021428108, 0.04854867607355118, 0.0115417605265975, 0.016213426366448402, 0.038420192897319794, -0.002105193678289652, 0.0731239914894104, 0.017430415377020836, -0.006974782794713974, -0.044910795986652374, -0.02440519817173481, -0.027349524199962616, 0.015415186062455177, 0.005944268777966499, -0.05106116831302643, -0.024706173688173294, -0.035855356603860855, 0.025111835449934006, 0.007563648279756308, -0.0040173702873289585, -0.023018091917037964, -0.0308565441519022, -0.0015613110736012459, 0.01659291796386242, 0.05142757296562195, 0.0365619957447052, -0.053495146334171295, 0.02526886574923992, 0.01791459321975708, -0.028317879885435104, -0.01126695703715086, -0.005198372527956963, 0.04765883460640907, -0.026852259412407875, 0.022599343210458755, -0.028788972645998, -0.00884606596082449, -0.009192842058837414, 0.02431359700858593, 0.0543849878013134, -0.018568888306617737, 0.005695636384189129, -0.07636929303407669, 0.04255533590912819, 0.006974782794713974, 0.0438639260828495, 0.022180594503879547, 0.0011188441421836615, -0.03185107186436653, -0.03643113747239113, -0.023384496569633484, 0.005659650545567274, 0.0379229299724102, -0.005378303583711386, 0.007733765058219433, -0.005414289887994528, -0.019772790372371674, 0.01179039292037487, -0.041482292115688324, 0.003402333240956068, -0.028396395966410637, -0.019733531400561333, 0.03593387082219124, -0.013844878412783146, -0.044675253331661224, 0.009362959302961826, 0.016370456665754318, 0.03349989652633667, -0.005993340630084276, 0.03295028954744339, -0.011803478933870792, 0.019903648644685745, 0.055274829268455505, 0.036640509963035583, 0.007491675671190023, 0.020453257486224174, 0.011810021474957466, -0.00715144257992506, -0.017443500459194183, 0.013249470852315426, -0.014394486322999, -0.015938622877001762, -0.03870808333158493, -0.008113255724310875, -0.0025648358277976513, 0.015820849686861038, -0.015022609382867813, 0.02779444493353367, 0.013184040784835815, 0.024823946878314018, 0.030149906873703003, 0.005869024898856878, 0.046690478920936584, 0.033473722636699677, 0.02312278002500534, 0.024143479764461517, 0.028213193640112877, 0.007629077881574631, 0.07752085477113724, -0.03213896229863167, 0.01126695703715086, -0.010763149708509445, 0.04025221988558769, -0.02202356420457363, -0.012523203156888485, -0.03614324703812599, 0.00671960785984993, 0.042110417038202286, 0.007871166802942753, -0.049831096082925797, -0.013988823629915714, 0.029835844412446022, 0.007033669389784336, -0.030228421092033386, -0.06474901735782623, -0.01837259903550148, -0.00023615953978151083, 0.02193196304142475, -0.02097669243812561, -0.025124922394752502, 0.017430415377020836, -0.042843226343393326, 2.9289916710695252e-05, 0.010625747963786125, -0.020819662138819695, -0.0379491001367569, 0.016147997230291367, 0.011855822056531906, -0.0029819486662745476, 0.01411968283355236, 0.001185909379273653, -0.0002694876748137176, -0.041299089789390564, 0.008859151974320412, -0.03229599446058273, 0.008060912601649761, 0.06197480857372284, 0.03551512211561203, -0.01580776274204254, 0.010822036303579807, -0.01943255588412285, -0.026067106053233147, 0.0093695018440485, -0.010442545637488365, 0.02299191989004612, 0.02975732833147049, 0.02504640631377697, -0.018673574551939964, 0.030542483553290367, -0.002591007621958852, -0.0020463070832192898, 0.0005986797623336315, 0.041429948061704636, -0.0017338813049718738, -0.03868190944194794, -0.011194984428584576, 0.00843386072665453, -0.020047593861818314, 0.012941951863467693, 0.029050691053271294, 0.008734836243093014, 0.03378778696060181, -0.02834405191242695, 0.043759237974882126, 0.004809067118912935, 0.020270053297281265, 0.03807995840907097, -0.021879618987441063, -0.025975504890084267, -0.015114210546016693, -0.02389484830200672, -0.055379513651132584, -0.0015498609282076359, -0.02453605644404888, 0.01003033947199583, 0.0001631647755857557, 0.009120870381593704, 0.028867488726973534, -0.01613491028547287, -0.01567690446972847, -0.004652036353945732, -0.05161077529191971, -0.01718178205192089, -0.031249120831489563, 0.0042300159111619, 0.009513447061181068, 0.011764220893383026, 0.02211516536772251, 0.003140615299344063, 0.01842494308948517, -0.010723892599344254, 0.0073281023651361465, -0.0014795241877436638, -0.027951475232839584, 0.017849164083600044, 0.01805853843688965, -0.030228421092033386, -0.019916735589504242, -0.006150371395051479, 0.013098983094096184, -0.005345589015632868, -0.017299555242061615, -0.015912450850009918, 0.007733765058219433, -0.02471925877034664, 0.07757319509983063, 0.0040926141664385796, 0.006870095618069172, -0.01851654425263405, 0.02988818846642971, 0.011253871023654938, 0.015284327790141106, 0.0194194708019495, -0.017116352915763855, -0.05480373650789261, -0.010370573028922081, -0.013144783675670624, -0.010259343311190605, -0.03925769031047821, 0.003250209614634514, 0.014616946689784527, -0.025517499074339867, 0.010998696088790894, 0.007445875089615583, -0.025164179503917694, 0.016030224040150642, -0.028998346999287605, 0.02755889855325222, 0.04313111677765846, -0.010187370702624321, -0.011482873931527138, 0.028134677559137344, -0.017037836834788322, 0.007118728011846542, 0.03321200609207153, -0.01640971377491951, -0.026682144030928612, -0.024326682090759277, -0.03216513246297836, 0.02093743532896042, 0.02244231291115284, 0.005672736093401909, -0.004020641557872295, 0.02897217497229576, 0.00023677294666413218, 0.027218665927648544, 0.029417095705866814, -0.030176077038049698, -0.02852725423872471, -0.010756607167422771, 0.027689756825566292, 0.012202599085867405, -0.004812338389456272, 0.017796820029616356, 0.04509400203824043, -0.014773976989090443, -0.018712831661105156, 0.038551051169633865, -0.009814422577619553, 0.011567932553589344, -0.009533075615763664, -0.020819662138819695, -0.024025706574320793, -0.023005006834864616, -0.02737569622695446, -0.020911263301968575, 0.030542483553290367, -0.024837031960487366, 0.01515346858650446, -0.03533191978931427, -0.01321021281182766, -0.01943255588412285, 0.0064742472022771835, 0.01411968283355236, -0.0002324791275896132, -0.014564602635800838, -0.03773972764611244, -0.003273109905421734, -0.0006052227108739316, 0.046952199190855026, -0.0005802777595818043, 0.01833334192633629, 0.027715928852558136, -0.030542483553290367, 0.026708316057920456, 0.025936247780919075, -0.05480373650789261, 0.0008743014768697321, 0.03208661824464798, -0.009349873289465904, -0.0037033087573945522, -0.02317512221634388, -0.019354041665792465, -0.01466928981244564, 0.00838806014508009, 0.06658104062080383, -0.023162037134170532, 0.01339341513812542, -0.002829825272783637, -0.03410184755921364, 0.025478240102529526, -0.032008104026317596, 0.001701166620478034, 0.06647635251283646, 0.02416965179145336, -0.023567700758576393, -0.0053063309751451015, -0.04027839004993439, 0.002602457767352462, -0.028867488726973534, -0.01586010679602623, 0.021958135068416595, -0.019707361236214638, -0.013792535290122032, 0.02975732833147049, -0.008832979947328568, 0.05689748004078865, 0.026446597650647163, 0.0002592643431853503, 0.016121825203299522, 0.025111835449934006, -0.01879134774208069, 0.020256968215107918, -0.007923510856926441, -0.02413039281964302, 0.001787860644981265, -0.003827624721452594, -0.031694043427705765, -0.008996553719043732, -0.033159662038087845, 0.008747922256588936, 0.042843226343393326, 0.01672377623617649, 0.01965501718223095, 0.004030456300824881, 0.011201527900993824, 0.026027848944067955, -0.030882716178894043, 0.011371644213795662, 0.02600167691707611, -0.019733531400561333, 0.008152513764798641, -0.007144899573177099, 0.022455397993326187, 0.01524506974965334, -0.005924639757722616, -0.015323584899306297, 0.013288727961480618, 0.015480616129934788, -0.009441474452614784, 0.005885382182896137, 0.008309544064104557, 0.016069481149315834, 0.015873191878199577, -0.011345472186803818, 0.009114326909184456, -0.000948727538343519, -0.010802407748997211, 0.010403287597000599, -0.0010002532508224249, 0.02203664928674698, 0.01892220601439476, 0.0041842153295874596, 0.015637647360563278, -0.012902693822979927, -0.005293245427310467, -0.0009454560349695385, -0.021539386361837387, -0.006402275059372187, 0.0226255152374506, 0.009814422577619553, -0.0012889608042314649, -0.020191539078950882, -0.008073998615145683, -0.008381516672670841, 0.026040934026241302, -0.02737569622695446, -0.021146809682250023, -0.010174284689128399, 0.027323352172970772, 0.008309544064104557, 0.018542716279625893, 0.060666218400001526, -0.032924115657806396, -0.09427080303430557, -0.006045684218406677, -0.008348802104592323, 0.019576501101255417, 0.017535101622343063, -0.011057582683861256, -0.010154656134545803, -0.008126341737806797, 0.00900309719145298, 0.001463984721340239, -0.010089226067066193, -0.02678683027625084, -0.022324539721012115, -0.020178452134132385, 0.03012373484671116, -0.044256504625082016, -0.020924348384141922, 0.005819952581077814, 0.042895570397377014, 0.029260065406560898, -0.010337858460843563, -0.014276713132858276, 0.014198197983205318, 0.019537243992090225, -0.022141337394714355, -0.029076863080263138, 0.025517499074339867, -0.012411973439157009, -0.0012423422886058688, 0.03514871746301651, 0.003003213321790099, -0.022429227828979492, 0.022704031318426132, 0.03253154084086418, -0.034023333340883255, -0.01663217507302761, 0.008630149066448212, -0.00889186654239893, -7.33014676370658e-05, 0.02902451902627945, 0.0013920122291892767, -0.05401858314871788, 0.0420580729842186, -0.0018434757366776466, 0.022730203345417976, -0.01804545149207115, 0.05174163728952408, -0.03313349187374115, 0.009362959302961826, -0.010017254389822483, 0.026577455922961235, 0.006006426643580198, 0.0002335014723939821, -0.010678092017769814, -0.02664288505911827, -0.022403055801987648, -0.032008104026317596, 0.00047763524344190955, -0.02618487924337387, 0.010390201583504677, 0.006663993000984192, 0.020597200840711594, 0.0130270104855299, 0.009362959302961826, -0.04601001366972923, -0.029626470059156418, 0.010017254389822483, 0.016488229855895042, -0.0009299165103584528, -0.050197500735521317, -0.0074131605215370655, 0.016893893480300903, -0.007262672763317823, 0.02724483795464039, -0.003359803929924965, -0.029181549325585365, 0.002435612492263317, 0.008885324001312256, -0.03771355375647545, -0.00012073784455424175, 0.03601238876581192, -0.011509045958518982, 0.01699857972562313, 0.005764337722212076, 0.026433510705828667, 0.027872959151864052, 0.010416373610496521, -0.0342850498855114, -0.04812992736697197, -0.0032420309726148844, 0.054594360291957855, -0.015689989551901817, 0.02988818846642971, -0.010684634558856487, 0.012163341045379639, -0.015454444102942944, -0.010141570121049881, 0.03857722505927086, 0.013386872597038746, 0.016252683475613594, 0.02468000166118145, 0.04807758331298828, -0.012078282423317432, -0.02093743532896042, 0.02167024463415146, 0.0017633246025070548, 0.03499168902635574, 0.004158043768256903, 0.030725685879588127, -0.016370456665754318, 0.032243650406599045, -0.010344401001930237, -0.001029696548357606, 0.019484899938106537, 0.00029525053105317056, 0.011777306906878948, 0.03313349187374115, 0.06087559089064598, 0.034572940319776535, 0.012523203156888485, 0.022599343210458755, -0.028762800619006157, -0.0012423422886058688, 0.013740191236138344, -0.018568888306617737, -0.036404963582754135, 0.001522053382359445, 0.007295387331396341, -0.023934105411171913, -0.004295445512980223, 0.005731622688472271, 0.006150371395051479, 0.0008166417246684432, 0.057577945291996, 0.008217942900955677, 0.023711644113063812, 0.029417095705866814, 0.009546161629259586, -0.03213896229863167, 0.001474616932682693, 0.002968862885609269, 0.018032366409897804, 0.019550329074263573, 0.016004052013158798, -0.009127412922680378, 0.031249120831489563, -0.03598621487617493, -0.022978834807872772, 0.0009552704868838191, 0.0438639260828495, 0.03577684238553047, -0.023646214976906776, 0.013740191236138344, 0.01003033947199583, -0.004586606752127409, 0.03331669420003891, 0.02915537729859352, -0.007472047116607428, -0.011548303999006748, -0.0019514343002811074, 0.020230796188116074, 0.03606473281979561, -0.0032289449591189623, -0.015140382573008537, 0.01558530330657959, -0.031824901700019836, -0.02816084958612919, -0.019275525584816933, -0.00035331922117620707, -0.010808950290083885, -0.006850467063486576, -0.07663100957870483, 0.020270053297281265, 0.023148952051997185, -0.004835238680243492, 0.0018025822937488556, -0.0010836757719516754, -0.003338539507240057, 0.013282185420393944, 0.015114210546016693, 0.002244231291115284, 0.029626470059156418, -0.01741732843220234, 0.0006121746264398098, -0.005685822106897831, 0.005532063078135252, -0.024915548041462898, -0.01705092377960682, -0.002469962928444147, 0.04415181651711464, 0.004580063745379448, 0.023803245276212692, -0.01561147440224886, 0.018137052655220032, 0.031458497047424316, -0.01855580136179924, 0.010750064626336098, 0.0319819301366806, -0.01740424335002899, -0.04258150979876518, -0.06888416409492493, 0.04941234737634659, -0.016435885801911354, -0.021552471444010735, -0.03232216462492943, 0.038551051169633865, 0.008590891025960445, -0.02774210087954998, -0.012856893241405487, 0.017744475975632668, 0.026485854759812355, 0.01580776274204254, -0.0021297296043485403, 0.0011810021242126822, 0.0525529608130455, -0.034206535667181015, -0.008381516672670841, 0.009866765700280666, -0.022913405671715736, -0.025111835449934006, -0.032793257385492325, -0.016187254339456558, -0.010841665789484978, 0.03221747651696205, 0.008172142319381237, 0.027637414634227753, 0.030699513852596283, 0.027846788987517357, -0.0011556482641026378, 0.013543902896344662, -0.0032076805364340544, 0.01414585392922163, -0.013465387746691704, 0.004759994801133871, -0.002741495380178094, -0.01923626847565174, -0.005734894424676895, 0.00029075227212160826, 0.018935292959213257, 0.013157868757843971, 0.025334296748042107, -0.002469962928444147, -0.014342143200337887, 0.004792709834873676, 0.014564602635800838, 0.026407340541481972, 0.014800149016082287, 0.060352154076099396, -0.03569832816720009, 0.024823946878314018, -0.00780573720112443, 0.022141337394714355, 0.019668102264404297, -0.016985494643449783, 0.006281230598688126, 0.020675716921687126, 0.017940765246748924, 0.048103757202625275, 0.037478007376194, 0.016579831019043922, -0.044622909277677536, 0.028082333505153656, 0.02920772135257721, -0.010475260205566883, 0.0040926141664385796, -0.03831550478935242, 0.024064963683485985, 0.018307169899344444, 0.004472105298191309, 0.02975732833147049, 0.005682550836354494, 0.0005295698647387326, 0.0022131523583084345, 0.03080420009791851, -0.009657391346991062, 0.0028592683374881744, 0.058572474867105484, 0.0009290986927226186, 0.03509637340903282, 0.0029819486662745476, -0.018673574551939964, -0.03284560143947601, -0.011849279515445232, -0.007439332082867622, 0.012353086844086647, -0.005885382182896137, 0.017836077138781548, -0.012294200249016285, 0.023227466270327568, 0.053364288061857224, -0.017430415377020836, 0.03949323669075966, -0.02957412600517273, -0.00780573720112443, 0.05480373650789261, -0.01263443287461996, -0.012156798504292965, 0.01855580136179924, 0.009873309172689915, 0.001174459233880043, 0.04839164763689041, -0.0012636069441214204, 0.006166728679090738, -0.013740191236138344, 0.013399958610534668, 0.03606473281979561, -0.015559131279587746, -0.042398303747177124, -0.023606957867741585, -0.03378778696060181, -0.024980977177619934, -0.008656321093440056, 0.001416548271663487, 0.04954320564866066, 0.008440403267741203, -0.0075113046914339066, -0.026747573167085648, -0.002018499653786421, 0.011626819148659706, -0.028788972645998, 0.03250536695122719, 0.011293129064142704, 0.010220085270702839, 0.029992874711751938, -0.03870808333158493, -0.021722588688135147, -0.04237213358283043, -0.007740308064967394, -0.025255780667066574, 0.022429227828979492, -0.008276829496026039, 0.004724008496850729, -0.006830838043242693, 0.00875446479767561, 0.007072926964610815, 0.014132768847048283, 0.011306215077638626, -0.007177614141255617, -0.019367126747965813, -0.010167742148041725, 0.03488700091838837, 0.007046755403280258, -0.0007283119484782219, 0.012771835550665855, -0.021408526226878166, 0.028003819286823273, 0.004779623821377754, 0.020400913432240486, 0.006909353658556938, -0.009068526327610016, 0.05684513598680496, 0.008060912601649761, 0.004043542314320803, 0.008087084628641605, -0.014721633866429329, 0.018856776878237724, -0.01126695703715086, -0.03815847635269165, -0.03049013949930668, 0.005414289887994528, 0.01359624695032835, 0.02724483795464039, -0.02011302299797535, 0.0005815045442432165, 0.023868676275014877, 0.00018228245608042926, -0.016710689291357994, -0.00026069561135955155, 0.0013445758959278464, 0.03802761435508728, 0.01112955529242754, 0.0075113046914339066, -0.009179756976664066, -0.04496314004063606, 0.016030224040150642, 0.02235071174800396, -0.013674762099981308, 0.030594825744628906, 0.02481085993349552, 0.01286997925490141, -0.0006898721330799162, -0.021316925063729286, -0.04286939650774002, 0.010599575936794281, -0.02115989476442337, 0.029076863080263138, 0.026904603466391563, 0.0009650848805904388, -0.004802524112164974, -0.0006894631660543382, 0.0039094118401408195, -0.010593033395707607, -0.03862956538796425, 0.006758865900337696, -0.03483465686440468, 0.015964794903993607, 0.012326914817094803, 0.009964910335838795, -0.009075069800019264, 0.008191771805286407, 0.03247919678688049, -0.0051558432169258595, 0.03012373484671116, 0.0028429110534489155, 0.00445574801415205, 0.0003518879530020058, -0.0027513098903000355, 0.05113968625664711, 0.0051558432169258595, -0.012385801412165165, -0.027506554499268532, 0.006385917775332928, -0.01258863229304552, 0.02453605644404888, -0.03012373484671116, -0.005322688724845648, 0.002301482018083334, 0.017391156405210495, -0.03404950350522995, 0.008872237987816334, -0.020544858649373055, -0.019798962399363518, -0.012045567855238914, -0.014237456023693085, 0.0032518452499061823, 0.00545027619227767, -0.008885324001312256, 0.014944094233214855, -0.002659708494320512, 0.0178229920566082, -0.021722588688135147, 0.0012660605134442449, -0.03488700091838837, -0.0028788973577320576, -0.011535217985510826, 0.0007487586699426174, 0.02130383998155594, -0.0006616556784138083, -0.031641699373722076, 0.016841549426317215, -0.013818707317113876, 0.02673448622226715, 0.027820616960525513, -0.014826321043074131, -0.031327635049819946, -0.012281114235520363, -0.0217095036059618, -0.008996553719043732, -0.016147997230291367, -7.115456537576392e-05, -0.004288902506232262, 0.010121941566467285, 0.01677612029016018, 0.0024683272931724787, -0.03575066849589348, 0.004269273951649666, -0.026629799976944923, -0.029992874711751938, -0.007000954821705818, 0.014813235029578209, 0.01311861164867878, -0.02167024463415146, 0.0338139571249485, 0.028003819286823273, -0.005015169735997915, 0.016985494643449783, -0.005554963368922472, 0.0858958289027214, 0.016187254339456558, -0.026616714894771576, 0.0061536431312561035, -0.00041445487295277417, 0.007131813559681177, 0.0041089714504778385, -0.009919109754264355, -0.0039257691241800785, -0.01206519640982151, -0.012490488588809967, -0.0007491675787605345, 0.008237572386860847, -0.021539386361837387, -0.015310498885810375, -0.013910308480262756, 0.005672736093401909, 0.0040860711596906185, 0.011410902254283428, 0.008139427751302719, -0.008119799196720123, -0.004894125275313854, -0.022834889590740204, 0.023803245276212692, -0.009153584949672222, -0.0019628845620900393, 0.022337626665830612, 0.016239598393440247, 0.0037621953524649143, 0.02609327808022499, -0.0166845191270113, -0.01421128399670124, -0.013380329124629498, -0.014473001472651958, 0.008211400359869003, -0.024326682090759277, 0.033290520310401917, -0.01804545149207115, -0.01305318158119917, 0.0018892763182520866, -0.04276471212506294, 0.02842256799340248, -0.01515346858650446, 0.019825134426355362, -0.011659533716738224, 0.002465055789798498, 0.009199385531246662, 0.03661433979868889, -0.013380329124629498, -0.007354273926466703, -0.011123011820018291, 0.00923210009932518, -0.025020234286785126, 0.02121223881840706, 0.02011302299797535, 0.005551691632717848, 0.009644306264817715, 0.0030179349705576897, -0.027506554499268532, -0.03308114781975746, 0.01003033947199583, 0.00046250465675257146, 0.03216513246297836, -0.03158935531973839, -0.021918877959251404, 0.030228421092033386, 0.004969369154423475, -0.020086850970983505, -0.004854867700487375, 0.024693086743354797, -0.002609000774100423, 0.01343921571969986, 0.008132885210216045, 0.015637647360563278, -0.004426304716616869, 0.012372715398669243, 0.01430288515985012, 0.02636808156967163, 0.02176184579730034, 0.03480848670005798, -0.005512434057891369, -0.0031095361337065697, -0.010239713825285435, 0.04629790410399437, -0.0029590483754873276, 0.01192779466509819, 0.0023276538122445345, 0.014826321043074131, -0.02129075489938259, 0.01745658554136753, 0.02152629941701889, 0.01448608748614788, -0.0063597457483410835, 0.003382704220712185, -0.028684286400675774, 0.01914466731250286, 0.0064219036139547825, -0.0017862248932942748, 0.0016398264560848475, 0.0007082741358317435, 0.001913812360726297, -0.029547953978180885, -0.030045218765735626, 0.01558530330657959, 0.015349756926298141, 0.021827274933457375, -0.0036640511825680733, -0.0315370112657547, 0.0281085055321455, -0.003788367146626115, 0.019812047481536865, -0.020780403167009354, 0.028736628592014313, 0.012254942208528519, -0.017338812351226807, -0.004786166828125715, -0.005865753162652254, -0.0033336321357637644, -0.02462765760719776, 0.00870866421610117, 0.00048049777979031205, -0.020165367051959038, -0.005751251708716154, -0.0007426246302202344, 0.007046755403280258, 0.03062099777162075, -0.01291577983647585, -0.0023521899711340666, 0.022965747863054276, 0.016422800719738007, 0.0011638269061222672, -0.04009518772363663, 0.013897222466766834, -0.019223181530833244, -0.0074197035282850266, -0.0011368372943252325, -0.0388651117682457, 0.01343921571969986, -0.031144434586167336, -0.005316145718097687, -0.023253638297319412, 0.02499406225979328, 0.046952199190855026, 0.01448608748614788, -0.029835844412446022, 0.02280871756374836, -0.011849279515445232, 0.001931805512867868, 0.023659301921725273, 0.005051156040281057, 0.016972407698631287, 0.006470975931733847, -0.029547953978180885, -0.008178685791790485, 0.03360458463430405, -0.0008628513314761221, -0.028736628592014313, -0.009991082362830639, 0.04305259883403778, 0.0028380039148032665, -0.006497147958725691, 0.0018843691796064377, -0.017286470159888268, -0.016710689291357994, 0.016763033345341682, -0.0328979454934597, -0.0061700004152953625, 0.023044263944029808, 0.04103737324476242, -0.010010710917413235, -0.021827274933457375, -0.006212529260665178, 0.028919830918312073, -0.012811092659831047, 0.015559131279587746, -0.0062288870103657246, -0.009899481199681759, -0.012418515980243683, 0.008558176457881927, -0.010802407748997211, -0.01877826265990734, -0.00157357903663069, 0.036221761256456375, -0.005309602711349726, -0.0034383193124085665, -0.015127296559512615, 0.03478231281042099, 0.02920772135257721, 0.04985726624727249, -0.010920180939137936, 0.02084583416581154, -0.006506962236016989, 0.011051040142774582, 0.0053292312659323215, 0.016880806535482407, 2.2363592506735586e-06, 0.013570074923336506, -0.011319301091134548, 0.016841549426317215, -0.02842256799340248, -0.0025991862639784813, -0.02156555838882923, 0.029050691053271294, -0.012876522727310658, 0.007851538248360157, -0.01663217507302761, -0.02129075489938259, 0.0038603395223617554, -0.0010018890025094151, -0.006454618647694588, 0.0001359706511721015, 0.03412801772356033, 0.0037262090481817722, 0.02165715955197811, -0.0038145389407873154, 0.053495146334171295, -0.011999767273664474, -0.03012373484671116, 0.030594825744628906, 0.00452444888651371, 0.01809779554605484, 0.03577684238553047, -0.03062099777162075, -0.025334296748042107, 0.024784687906503677, 0.009061983786523342, -0.017391156405210495, -0.02495480515062809, 0.048234615474939346, -0.0237639881670475, 0.0084600318223238, -0.007871166802942753, 0.012209141626954079, 0.03865573927760124, 0.025111835449934006, -0.006048955954611301, 0.02152629941701889, 0.025792302563786507, 0.023423755541443825, -0.03103974647819996, -0.018385684117674828, -0.039650268852710724, -0.004900668282061815, -0.02431359700858593, 0.01815013960003853, -0.0021657159086316824, 0.009199385531246662, -0.00024004442093428224, -0.019982164725661278, 0.002723502228036523, -0.0006219890201464295, -0.001822211081162095, 0.0020234067924320698, -0.0050020841881632805, 0.007138356566429138, 0.01833334192633629, 0.027846788987517357, -0.04391627013683319, 0.013609332963824272, -0.02952178381383419, 0.02088509127497673, -0.0023979905527085066, -0.0031847800128161907, 0.009945281781256199, -0.020086850970983505, 0.015532959252595901, -0.025111835449934006, -0.0012930501252412796, 0.005319416988641024, 0.011980138719081879, 0.004328160546720028, -0.014800149016082287]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" offer an intuitive explanation for the effectiveness
of the preconditioner (1) before we move on to its stable
learning properties and review its rigorous derivation from
a Riemannian metric formulation. Consider in the t-th it-
eration pretrained model weight Wand its additive low-
rank component BtAt. Let Xt=W+BtAtdenote the
2
Riemannian Preconditioned LoRA
whole weight matrix and let Ldenote the loss function, i.e.,
L(A, B) :=L(W+BA). For the plain gradient descent
method, when step size ηis small, the updated weight is
approximately given by
Xt+1=W+Bt+1At+1
≈W+BtAt−η∇BtLAt−ηBt∇AtL
=Xt−η∇XtL(AT
tAt)−η(BtBT
t)∇XtL,
where we ignore the second-order term in the second line
since when ηis small, η2is negligible. The derivation from
the second line to the third line comes from the simple
fact∇BtL= (∇XtL)AT
tand∇AtL=BT
t(∇XtL). Thus
the LoRA update in gradient descent step is approximately
constrained to the column space of Btand the row space of
At. If we scale ∇BtLright by (AtAT
t)−1and scale ∇AtL
left by (BT
tBt)−1, which is exactly the preconditioner (1),
the scaled update becomes
˜Xt+1≈Xt−η(∇XtL)AT
t(AtAT
t)−1At
−ηBt(BT
tBt)−1BT
t(∇XtL)
=Xt−ηProjrow(At)(∇XtL)−ηProjcol(Bt)(∇XtL)T,
where the update is done according to projection of the full
matrix gradient onto the row space of Atand the column
space of Bt, which better approximates full fine-tuning com-
pared to the unscaled gradient descent step. Therefore, our
preconditioner (1) effectively serves as a gradient projector.
4. Stable Feature Learning
Given the current trend of increasing model sizes, there has
been a focus on analyzing the asymptotic training behavior
of neural networks as the number of neurons approaches
infinity (Schoenholz et al., 2017; Hayou et al., 2019; Yang,
2020). Under this infinite-width NN setting, we naturally
expect that both the NN prediction ft(x)in the t-th iter-
ation and the increment ∆ft:=ft(x)−ft−1(x)to be
of constant magnitude, which ensures that neither the NN
predictions nor the increments explode or vanish as the NN
size increases, thereby leading to stable training dynamics.
We refer to this behavior as stable feature learning , formally
defined in Definition A.1 in the Appendix. The authors of
LoRA+ (Hayou et al., 2024) observe that the learning rate of
LoRA parameter Bshould be set to be larger than that of A
for asymptotic stable feature learning. Their analysis mostly
focuses on the order of magnitude of iterates and the con-
clusion that ηB≫ηAdoes not immediately offer practical
guidance. Here we show that our preconditioned updates (1)
introduce an elegant and practical solution to learning rate
choices for stable feature learning in the infinite-width NN
regime. Specifically, we will see that LoRA trained with
Adam optimizer scaled by our preconditioner as in (1)leads
to stable feature learning when the same learning rate is usedfor training AandB. In contrast, LoRA trained with the un-
preconditioned Adam optimizer requires different learning
rate settings for AandBto achieve stable feature learning.
We first illustrate our key point via a simple toy example
and we then proceed to our main theorem. Consider the
simple linear model
f(x) = (W+baT)x,
where W∈R1×nis the pretrained model weight and
b∈R, a∈Rnare trainable LoRA parameters. Con-
sider the quadratic loss function L(a, b) = (f(x)−y)2/2
with some scalar label y.We adopt Gaussian initialization
ai∼ N(0, σ2
a), b∼ N(0, σ2
b). Conventionally, baTis ini-
tialized at","[0.01966450922191143, -0.02215384505689144, 0.019439341500401497, -0.017287755385041237, -0.02037753351032734, -0.025894103571772575, -0.007555574644356966, -0.001384615316055715, -0.04373226687312126, 0.07965876907110214, -0.017050080001354218, -0.004165573511272669, -0.05619145929813385, -0.013897753320634365, 0.016512183472514153, -0.02018989622592926, 0.04210606589913368, 0.012540502473711967, -0.02362993359565735, 0.023767534643411636, 0.044382743537425995, -0.024680709466338158, 0.031848497688770294, 0.014122920110821724, 0.04403248801827431, -0.025556355714797974, 0.019264213740825653, 0.010682881809771061, 0.03855344280600548, -0.005913738161325455, 0.02504347637295723, -0.013622550293803215, -0.04518333449959755, -0.020652737468481064, 0.0013330146903172135, 0.006323415320366621, 0.02079033851623535, -0.0028771227225661278, -0.005285149440169334, 0.021728530526161194, -0.013172218576073647, -0.06504799425601959, -0.05714216083288193, 0.029746947810053825, 0.005269512999802828, 0.04325691610574722, -0.00013271509669721127, 0.029321633279323578, 0.019464360550045967, 0.05303913354873657, -0.035676322877407074, 0.047109756618738174, -0.030822740867733955, -0.009438213892281055, -0.03224879130721092, 0.014222993515431881, 0.06049463152885437, 0.009694652631878853, 0.01581166498363018, -0.012477955780923367, 0.04037979245185852, -0.031248055398464203, 0.02944672480225563, -0.02827085740864277, -0.022479085251688957, -0.054790422320365906, -0.05514068156480789, 0.016211960464715958, -0.013585022650659084, 0.030247315764427185, -0.02205377072095871, -0.03490075096487999, 0.06044459715485573, -0.009313121438026428, -0.011252051219344139, 0.026494547724723816, 0.014710853807628155, 0.041780825704336166, 0.018688788637518883, 0.02102801389992237, 0.005022455472499132, 0.0007177170482464135, 0.055340830236673355, -0.022066280245780945, 0.007486773654818535, -0.05714216083288193, -8.976348908618093e-05, -0.022266428917646408, -0.013447421602904797, 0.002662902232259512, 0.015136167407035828, -0.0038246968761086464, -0.005829300731420517, 0.030322371050715446, 0.03420023247599602, 0.0047660162672400475, 0.03945410996675491, -0.02050262689590454, 0.04213108494877815, -0.0030178516171872616, 0.0272701196372509, -0.02071528322994709, 0.04323189705610275, -0.03279919922351837, 0.04623411223292351, -0.02949676290154457, 0.0039060069248080254, 0.016462145373225212, -0.02320462092757225, 0.009800980798900127, -0.025243625044822693, 0.026969898492097855, -0.027895580977201462, -0.014673326164484024, 3.339866452733986e-05, -0.08896563947200775, -0.04901115968823433, 0.023554878309369087, -0.0015566172078251839, -0.02284185215830803, 0.0007055987371131778, -0.011733656749129295, -0.02606923319399357, -0.002253224840387702, 0.044407762587070465, -0.027570340782403946, 0.05994422733783722, -0.03530104458332062, 0.014172956347465515, -0.016737349331378937, 0.037377577275037766, 0.050462231040000916, 0.0217660591006279, -0.012759413570165634, -0.06214585155248642, -0.017287755385041237, 0.013147199526429176, 0.012997088953852654, 0.026444511488080025, 0.014435650780797005, 0.006098249461501837, -0.010839247144758701, -0.01612439565360546, -0.010388914495706558, -0.048235587775707245, 0.03332458809018135, 0.015536462888121605, -0.004174955189228058, -0.018413584679365158, -0.0017153280787169933, -0.01861373335123062, 0.022303955629467964, -0.03882864862680435, 0.010007383301854134, -0.019576944410800934, 0.00409051775932312, -0.014723362401127815, 0.011514745652675629, 0.03107292577624321, 0.00018754070333670825, 0.004665942396968603, 0.04996186122298241, 0.05959396809339523, 0.0023220255970954895, 0.04430769011378288, 0.039979495108127594, -0.02674473263323307, 0.001553489943034947, -0.05514068156480789, -0.05929374694824219, 0.030747685581445694, 0.0067549836821854115, -0.07475515455007553, -0.045533593744039536, 0.04345706105232239, -0.01058280747383833, -0.016824914142489433, -0.04408252239227295, 0.044858094304800034, -0.04783529415726662, 0.0030459973495453596, 0.03044746443629265, -0.02514355070888996, 0.027520304545760155, -0.03990444168448448, 0.04293167591094971, -0.03615167364478111, -0.029746947810053825, 0.017500411719083786, 0.012640575878322124, -0.00428128382191062, 0.003921643365174532, 0.07035190612077713, 0.00804968923330307, 0.008099725469946861, -0.06795012950897217, 0.029671892523765564, 0.031923551112413406, -0.022566650062799454, 0.0212156530469656, 0.001370542449876666, 0.002873995341360569, 0.020777828991413116, -0.027370193973183632, 0.013710115104913712, -0.005963774863630533, 0.006742474623024464, 0.009713416919112206, -0.02533118985593319, -0.024355469271540642, 0.0011391217121854424, -0.013660077936947346, 0.03267410770058632, -0.02719506435096264, -0.0608949288725853, 0.004737870767712593, -0.05554097890853882, 0.041080307215452194, 0.0111582325771451, 0.03312443941831589, 0.017312772572040558, -0.019889675080776215, 0.014635798521339893, 0.04575876146554947, -0.030097205191850662, -0.025443771854043007, 0.02428041398525238, -0.012315336614847183, 0.03597654402256012, -0.02724510058760643, 0.02260417677462101, -0.0022938798647373915, 0.01908908411860466, -0.03772783651947975, 0.0490361787378788, -0.0431068055331707, -0.009550796821713448, -0.06379707157611847, 0.015936758369207382, -0.02478078380227089, -0.027069972828030586, 0.030072186142206192, -0.012527992948889732, -0.0006227250560186803, 0.019551925361156464, 0.01940181478857994, 0.0057542454451322556, 0.014485687017440796, 0.03695226460695267, 0.007649393752217293, -0.009356903843581676, -0.03282421827316284, -0.012327845208346844, -0.03199860826134682, -0.05116274580359459, 0.030347390100359917, -0.001626199809834361, -0.01607435941696167, -0.013785170391201973, -0.02147834748029709, -0.02367997169494629, -0.01882638968527317, 0.015486425720155239, 0.0013494330924004316, -0.013134690932929516, 0.0023579897824674845, 0.010814229026436806, -0.014222993515431881, 0.024092774838209152, 0.03477565571665764, 0.005228857975453138, 0.03382495418190956, -0.05328931659460068, -0.008156017400324345, -0.01748790219426155, 0.0003848542692139745, 0.062396034598350525, 0.03114798106253147, -0.042856618762016296, 0.014936019666492939, -0.012984580360352993, 0.014047864824533463, 0.10257568210363388, -0.014760890044271946, 0.008944098837673664, -0.014911001548171043, -0.036301784217357635, 0.0050756195560097694, -0.023192111402750015, -0.024843329563736916, 0.004609650932252407, 0.002747339429333806, 0.038503408432006836, 0.018963990733027458, -0.004021717235445976, 0.006404725369066, 0.01753794029355049, -0.05303913354873657, 0.014748381450772285, 0.008881553076207638, 0.030822740867733955, 0.017663031816482544, -0.006498544476926327, -0.000752899213694036, -0.042281195521354675, 0.007993397302925587, 0.04418259859085083, 0.00012206271640025079, 0.03207366541028023, 0.031223036348819733, -0.01037015113979578, 0.08176032453775406, 0.006936367601156235, 0.04893610626459122, -0.039979495108127594, -0.013660077936947346, 0.03985440358519554, -0.0424313060939312, -0.0095070144161582, 0.011977586895227432, -0.03309942036867142, -0.025293661281466484, 0.006295269820839167, -0.009431959129869938, 0.05183824524283409, -0.011245797388255596, -0.02349233254790306, 0.025256134569644928, -0.023217128589749336, 0.0003490856906864792, 0.0072490982711315155, -0.004187464714050293, 0.01987716555595398, -0.008906571194529533, -0.049311380833387375, 0.027695434167981148, -0.011327107436954975, 0.03272414207458496, 0.045008204877376556, 0.03977935016155243, -0.06589861959218979, -0.03555122762918472, -0.02272927016019821, 0.017375320196151733, -0.028170784935355186, 0.009250574745237827, -1.1849563179566758e-06, -0.038903702050447464, 0.023379748687148094, 0.035225991159677505, -0.021515874192118645, 0.006661164574325085, 0.06754983961582184, -0.023930154740810394, -0.02571897581219673, 0.008581330999732018, 0.025531336665153503, -0.053639575839042664, -0.012096424587070942, -0.0028536678291857243, -0.03222377598285675, 0.027520304545760155, 0.013347347266972065, 0.02064022794365883, -0.056992046535015106, 0.03164834901690483, 0.021440818905830383, 0.02942170761525631, 0.015774138271808624, -0.006486035417765379, 0.017237717285752296, 0.011389653198421001, -0.021015504375100136, -0.012015114538371563, -0.04743499681353569, -0.003289927262812853, 0.05128784105181694, 0.0035557483788579702, -0.006511054001748562, 0.029796984046697617, 0.008725187741219997, 0.007649393752217293, 0.032448939979076385, -0.014748381450772285, 0.012027624063193798, 0.028070710599422455, 0.008055943995714188, -0.020877903327345848, -0.06289640814065933, -0.04160569608211517, 0.05053728446364403, 0.0005719063337892294, -0.029571818187832832, 0.023117056116461754, -0.007830777205526829, 0.016349563375115395, -0.04398244991898537, 0.010557789355516434, 0.062496110796928406, 0.03970429301261902, -0.04042983055114746, -0.01942683383822441, -0.05679190158843994, -0.026369454339146614, -0.008243582211434841, 0.010657863691449165, 0.037402596324682236, 0.0655483603477478, 0.020340006798505783, 0.05939381942152977, -0.006930112838745117, -0.029746947810053825, 0.01817590929567814, -0.008625113405287266, 0.06319662928581238, 0.03530104458332062, 0.005575988907366991, 0.035776395350694656, 0.007812013849616051, 0.05654171481728554, -0.0033524734899401665, -0.017325282096862793, -0.011821221560239792, 0.009469486773014069, -0.027019934728741646, 0.0029709418304264545, 0.007499282713979483, -0.02719506435096264, -0.04633418470621109, -0.019814619794487953, 0.027520304545760155, 0.016537200659513474, -0.03965425491333008, -0.03227381035685539, -0.025969160720705986, -0.001741910120472312, -0.029046429321169853, 0.028796246275305748, 0.005547842942178249, -0.037777870893478394, 0.057492416352033615, 0.010257568210363388, -0.0371774286031723, -0.01237788237631321, -0.01652469113469124, 0.035150934010744095, -0.048710938543081284, 0.020990487188100815, -0.01997723989188671, -0.023930154740810394, -0.006967640481889248, 0.009137991815805435, 0.0534394271671772, -0.014473178423941135, 0.012621812522411346, -0.05464031174778938, 0.04318185895681381, 0.016462145373225212, 0.015461407601833344, 0.01088302955031395, 0.0013142508687451482, -0.05629153177142143, -0.0382782407104969, -0.04543352127075195, -0.010101202875375748, 0.02391764707863331, 0.03865351900458336, -0.002845849609002471, 0.024355469271540642, -0.03282421827316284, 0.010576553642749786, -0.04308178648352623, 0.03274916112422943, -0.031823478639125824, -0.02315458282828331, 0.03392503038048744, -0.011270815506577492, -0.011464708484709263, 0.012809450738132, -0.01214020699262619, 0.026369454339146614, 0.010870520025491714, -0.001078921020962298, -0.043782301247119904, 0.017137644812464714, 0.06955131143331528, 0.04583381488919258, 0.012759413570165634, 0.025456281378865242, -0.0012626503594219685, -0.040104590356349945, -0.03329956904053688, 0.02102801389992237, -0.012609302997589111, -0.00875646062195301, -0.024367978796362877, -0.0190140288323164, -0.022779306396842003, 0.019501889124512672, 0.00966337975114584, 0.05228857696056366, 0.0008537548710592091, 0.006163922604173422, 0.035225991159677505, 0.011633583344519138, 0.015749119222164154, 0.03174842521548271, 0.030647611245512962, 0.006586109288036823, 0.011308343149721622, -0.011602310463786125, 0.06464769691228867, -0.019702035933732986, 0.024655690416693687, -0.015573990531265736, 0.01669982075691223, -0.011320852674543858, -0.0085750762373209, -0.021140597760677338, 0.031373146921396255, 0.033199492841959, 0.015323805622756481, -0.03765277937054634, -0.018788862973451614, 0.03940407186746597, 0.016349563375115395, -0.029296614229679108, -0.09471988677978516, -0.013960300013422966, 0.003396255662664771, 0.020277461037039757, 0.009532032534480095, -0.015198713168501854, 0.009369412437081337, -0.02609425224363804, 0.003371237311512232, 0.007317899260669947, -0.023617424070835114, -0.04700968414545059, 0.013985318131744862, 0.00424062879756093, 0.0038309514056891203, 0.04746001586318016, 0.019239194691181183, 0.004916127305477858, -0.03775285556912422, 0.00468157883733511, -0.03587646782398224, 0.016086868941783905, 0.05323927849531174, 0.05023706331849098, -0.008793988265097141, -0.016737349331378937, -0.002204751595854759, -0.021278198808431625, -0.021228162571787834, -0.007474264595657587, 0.003530730027705431, 0.016036832705140114, 0.026994917541742325, -0.011571036651730537, 0.007124005816876888, -0.028120746836066246, -0.022904397919774055, -0.01135212555527687, 0.04250635951757431, -0.014998565427958965, -0.024868348613381386, -0.001752855721861124, 0.000797854270786047, -0.025193586945533752, -0.000890500727109611, 0.01696251519024372, -0.03152325749397278, 0.027970636263489723, -0.009381921961903572, 0.03987942263484001, 0.02037753351032734, 0.03114798106253147, 0.022266428917646408, -0.029746947810053825, -0.03044746443629265, -0.044908132404088974, -0.023830082267522812, -0.04125543683767319, -0.0040123350918293, -0.03004716895520687, 0.021065542474389076, -0.00475976150482893, 0.008856534026563168, 0.017850670963525772, -0.015048602595925331, -0.0017200190341100097, -0.010570298880338669, -0.0305725559592247, -0.04130547493696213, -0.05106267333030701, -0.004969291388988495, -0.01222151704132557, 0.00911297369748354, 0.009750944562256336, -0.0038215694949030876, 0.02126568928360939, 0.002348607871681452, -0.0032930546440184116, 0.0009131737169809639, -0.045733742415905, 0.015749119222164154, 0.0171501524746418, -0.02289189025759697, -0.011151977814733982, -0.005044346675276756, -0.0007380445022135973, -0.0009225556277669966, -0.026369454339146614, -0.015611518174409866, -0.0019373669056221843, -0.025919122621417046, 0.06830038875341415, 0.016111887991428375, 0.0006106067448854446, 0.0046033961698412895, 0.009532032534480095, 0.004803543910384178, -0.0009421013528481126, 0.016587238758802414, -0.024367978796362877, -0.026369454339146614, 0.002236024709418416, -0.01932675950229168, -0.0217660591006279, -0.03557624667882919, 0.02344229631125927, 0.0014111974742263556, -0.015211222693324089, 0.006511054001748562, 0.011796203441917896, -0.013697605580091476, 0.015436388552188873, -0.030172260478138924, 0.027545323595404625, 0.029046429321169853, 0.003646440338343382, -0.010320113971829414, 0.02456812560558319, -0.008543803356587887, -0.007999652065336704, 0.02021491527557373, -0.016474654898047447, -0.036852188408374786, -0.01951439678668976, -0.037877947092056274, 0.04565868526697159, 0.014385613612830639, 0.01875133439898491, -0.010889284312725067, -0.0024987184442579746, -0.012646830640733242, 0.04811049625277519, 0.013897753320634365, -0.027570340782403946, -0.02942170761525631, 0.00091864651767537, 0.01657472923398018, 0.0027457757387310266, -0.00765564851462841, 0.015936758369207382, 0.026444511488080025, 0.007680666632950306, -0.018376057967543602, 0.008668895810842514, -0.026369454339146614, -0.0001494266471127048, -0.01906406506896019, -0.02571897581219673, -0.04460791125893593, -0.024080267176032066, -0.031248055398464203, -0.03199860826134682, 0.043782301247119904, -0.01861373335123062, 0.022779306396842003, -0.041155364364385605, -0.0404798649251461, -0.032473959028720856, 0.008512530475854874, -0.007937106303870678, -0.017187681049108505, 0.00110159395262599, -0.011233287863433361, -0.014810927212238312, -0.009619597345590591, 0.03485071286559105, 0.007543065119534731, -0.002586283255368471, 0.005760500207543373, -0.039604220539331436, 0.0305725559592247, 0.016437126323580742, -0.022979453206062317, -0.016224469989538193, 0.005000564269721508, -0.010745427571237087, -0.008650132454931736, -0.025393735617399216, -0.02887130156159401, -0.011439690366387367, 0.029621854424476624, 0.050512269139289856, -0.007968379184603691, -0.015936758369207382, 0.007699430454522371, -0.008906571194529533, 0.049386437982320786, -0.049811750650405884, -0.0012368500465527177, 0.06579854339361191, 0.03307440131902695, -0.019101593643426895, -0.00043469571392051876, -0.025256134569644928, -0.0027551576495170593, -0.02026495151221752, -0.002614428987726569, 0.04418259859085083, -0.01903904601931572, -0.025581372901797295, 0.03395004943013191, -0.00039677711902186275, 0.04188089817762375, 0.016261998564004898, 0.004231246653944254, 0.03772783651947975, 0.020340006798505783, -0.023217128589749336, 0.005863700993359089, -0.015223732218146324, -0.004756634589284658, -0.002398644806817174, -0.0020999868866056204, -0.019739564508199692, -0.010689136572182178, -0.04628414660692215, 0.029646873474121094, 0.05984415113925934, 0.02611927129328251, 0.006667419336736202, 0.01631203480064869, 0.017050080001354218, 0.017875688150525093, -0.01887642778456211, 0.009982365183532238, 0.007993397302925587, -0.011108195409178734, 0.008768970146775246, -0.003640185808762908, 0.026944879442453384, 0.015536462888121605, -0.0111582325771451, -0.01469834428280592, -5.765972673543729e-05, 0.005751118063926697, 0.007023932412266731, 0.005269512999802828, -0.0001812861009966582, 0.033975064754486084, 0.017425356432795525, -0.004059244878590107, 0.04628414660692215, -0.001971767283976078, -0.00798714254051447, 0.0042031011544167995, 0.010413933545351028, 0.03560126572847366, 0.01013247575610876, 0.002087477594614029, 0.020852884277701378, -0.03162332996726036, 0.020552663132548332, -0.01916413940489292, -0.03990444168448448, -0.008512530475854874, 0.008368674665689468, 0.022328974679112434, -0.018451113253831863, 0.005300785880535841, -0.016324544325470924, -0.013134690932929516, 0.008212309330701828, -0.020289970561861992, -0.01657472923398018, -0.0038497152272611856, 0.019226685166358948, 0.002536246320232749, 0.05253876373171806, 0.0641973614692688, -0.03442540019750595, -0.0840119868516922, -0.02887130156159401, -0.015961775556206703, 0.005366459488868713, 0.014172956347465515, 0.00011610128422034904, 0.011395907960832119, -0.022091299295425415, 0.012334099970757961, 0.006479780655354261, 0.002842722227796912, -0.008231072686612606, -0.022479085251688957, -0.0021562783513218164, 0.020415062084794044, -0.03117300011217594, -0.039979495108127594, -0.0010382659966126084, 0.02679476886987686, 0.009707162156701088, -0.03725248575210571, -0.01131459791213274, -0.006154540926218033, 0.0006883985479362309, -0.023579897359013557, -0.019214175641536713, 0.014398123137652874, -0.004396994132548571, 0.0015503625618293881, 0.028546061366796494, 0.012202752754092216, -0.017187681049108505, 0.031373146921396255, 0.04470798373222351, -0.034000083804130554, -0.02454310841858387, 0.0015972722321748734, 0.015886720269918442, 0.008475002832710743, 0.03600156307220459, 0.02260417677462101, -0.05984415113925934, 0.061345260590314865, -0.0239676833152771, 0.02423037774860859, -0.021203143522143364, 0.03597654402256012, -0.030272334814071655, -0.019501889124512672, 0.003114798106253147, 0.02205377072095871, -0.0008600095170550048, 0.01780063286423683, -0.012177734635770321, -0.055390868335962296, -0.028596097603440285, -0.047760237008333206, 0.0031413801480084658, -0.02126568928360939, 0.009188028983771801, 0.0010976848425343633, 0.012871996499598026, 0.0013150327140465379, 0.005222603213042021, -0.03159831464290619, -0.014610779471695423, 0.051237802952528, 0.03647691383957863, -0.022191371768712997, -0.02535620704293251, -0.00510689290240407, -0.005760500207543373, -0.005410241428762674, 0.030422445386648178, 0.00845623854547739, -0.00979472603648901, -0.018401077017188072, 0.01332232914865017, -0.02949676290154457, 0.013822698034346104, 0.04183086380362511, -0.03450045362114906, 0.015486425720155239, 0.010338878259062767, 0.0071677882224321365, 0.03837831690907478, 0.02674473263323307, -0.041205402463674545, -0.013434912078082561, -0.0150110749527812, 0.05076245218515396, 0.011702383868396282, 0.02404273860156536, -0.014235503040254116, 0.0036026579327881336, -0.013197236694395542, -0.015298787504434586, 0.010170003399252892, 0.027620378881692886, 0.008487512357532978, 0.0009139555622823536, 0.0369272455573082, 0.011577291414141655, -0.009206792339682579, 0.002275116043165326, -0.013822698034346104, 0.029596837237477303, 0.0062733786180615425, 0.030822740867733955, -0.03372488170862198, 0.03995447978377342, -0.0420059934258461, -0.010220040567219257, 0.028070710599422455, 0.008944098837673664, 0.015048602595925331, 0.01940181478857994, 0.06795012950897217, 0.04413256049156189, 0.013860225677490234, 0.026344437152147293, -0.01777561381459236, 0.0012477956479415298, 0.0025159188080579042, -0.012559265829622746, -0.04083012416958809, 0.00273013929836452, -0.0013447421370074153, -0.007955869659781456, -0.0035776395816355944, -0.0044313943944871426, 0.021253179758787155, -0.007793250028043985, 0.011646092869341373, 0.002595665166154504, 0.03415019437670708, 0.029121486470103264, 0.018763843923807144, -0.00981974508613348, 0.006917603779584169, -0.00844372995197773, 0.0085750762373209, 0.019576944410800934, -0.006041957531124353, -0.005363332107663155, 0.027670415118336678, -0.05018702894449234, -0.022854361683130264, 0.003993571270257235, 0.05213846638798714, 0.06214585155248642, -0.022491594776511192, 0.003099161433055997, 0.00679876608774066, -0.002567519200965762, 0.021778568625450134, 0.03995447978377342, -0.026319418102502823, 4.9865891924127936e-05, 0.04032975435256958, -0.00498805521056056, 0.024893365800380707, 0.019151629880070686, -0.016424618661403656, 0.019752072170376778, -0.03585145249962807, -0.014035355299711227, -0.02425539493560791, 0.011696129105985165, 0.00826234556734562, -0.03425027057528496, -0.08631367981433868, 0.027945617213845253, 0.007736958097666502, 0.005272639915347099, -0.007493028417229652, -0.003562002908438444, -0.0028755590319633484, 0.01229657232761383, 0.02152838371694088, 0.009344394318759441, 0.001584762940183282, 0.0008936280501075089, -0.007361681200563908, 0.0006625982350669801, -0.007574338465929031, -0.009750944562256336, -0.0023470441810786724, 0.004559614229947329, 0.03440038114786148, 0.0055697341449558735, -0.0026113016065210104, 0.012165225110948086, 0.005206966772675514, 0.03652694821357727, -0.0013189418241381645, 0.0019248576136305928, 0.0360766164958477, 0.011808712035417557, -0.06109507381916046, -0.04648429527878761, 0.032974328845739365, -0.02362993359565735, -0.022241409868001938, -0.032423920929431915, 0.03194857016205788, 0.029796984046697617, -0.046559352427721024, 0.004093645140528679, 0.011858749203383923, 0.024105284363031387, -0.0155614810064435, -0.008293619379401207, -0.004715979564934969, 0.01359753217548132, -0.008881553076207638, 0.02373000793159008, -0.01853867806494236, -0.018050817772746086, -0.0133598567917943, -0.04650931432843208, -0.028095729649066925, 0.004925508983433247, -0.004346956964582205, 0.023317202925682068, 0.0091254822909832, 0.03612665459513664, 0.02061520889401436, 0.0044657946564257145, 0.012671848759055138, -0.03099787048995495, 0.029596837237477303, -0.005529079120606184, 0.01765052229166031, -0.0190140288323164, -0.014485687017440796, -0.015198713168501854, 0.021778568625450134, -0.007474264595657587, 0.016749858856201172, 0.020415062084794044, -0.014373104088008404, -0.014335576444864273, -0.017850670963525772, -4.444196747499518e-05, 0.012922033667564392, 0.01367258746176958, 0.02717004530131817, -0.02772045135498047, 0.028646135702729225, -0.019051555544137955, 0.0165997464209795, 0.022091299295425415, -0.015924248844385147, -0.004928636364638805, -0.0058543193154037, 0.02079033851623535, 0.03712739050388336, 0.03580141440033913, 0.009075446054339409, -0.03880362957715988, 0.021590929478406906, 0.023117056116461754, -0.014235503040254116, -0.0008983190055005252, -0.03855344280600548, 0.0036870953626930714, 0.024392997846007347, 0.003427528776228428, 0.01741284690797329, -0.014635798521339893, 0.027620378881692886, 0.013797679916024208, 0.028445987030863762, 0.004803543910384178, 0.02784554474055767, 0.05614142119884491, 0.004672197159379721, 0.043407026678323746, 0.0026472655590623617, -0.011133214458823204, -0.05408990755677223, 0.0071928068064153194, -0.018376057967543602, 0.021803585812449455, -0.01832602173089981, 0.04926134645938873, -0.002387699205428362, 0.009144246578216553, 0.04138053208589554, -0.02621934376657009, 0.0398043692111969, -0.01832602173089981, -0.005585371050983667, 0.06164548173546791, -0.025769012048840523, -0.026844805106520653, 0.022516611963510513, 0.024918384850025177, -0.003837206168100238, 0.03715240955352783, -0.004106154665350914, -0.0029537416994571686, -0.013447421602904797, 0.005272639915347099, 0.03662702441215515, -0.018413584679365158, -0.04465794935822487, -0.023054510354995728, -0.027420230209827423, -0.021640965715050697, -0.008193545043468475, 0.0034025104250758886, 0.034700602293014526, 0.005529079120606184, 0.004997436888515949, -0.00526325823739171, -0.003827824257314205, 0.017850670963525772, -0.03377491980791092, 0.027670415118336678, -0.0032054900657385588, 0.013384874910116196, 0.03339964151382446, -0.006686183158308268, -0.02884628251194954, -0.04315683990716934, -0.017300264909863472, -0.019939711317420006, 0.04468296840786934, -0.021853623911738396, 0.006270251236855984, 0.002570646582171321, -0.0007994179031811655, -0.02351735159754753, 0.021378273144364357, -0.006654909811913967, -0.010507752187550068, -0.008793988265097141, 0.0133598567917943, 0.031798459589481354, 0.013209746219217777, 0.020565172657370567, 0.003890370251610875, -0.024893365800380707, 0.024705728515982628, -0.007899578660726547, -0.001626199809834361, -0.013722624629735947, -0.015136167407035828, 0.05018702894449234, -0.008625113405287266, 0.0020937323570251465, -0.0026926116552203894, -0.0133598567917943, 0.01798827201128006, -0.00789332389831543, -0.04020466282963753, -0.03795300051569939, 0.0071677882224321365, 0.002642574720084667, 0.03382495418190956, -0.030322371050715446, -0.0003307127335574478, 0.02882126346230507, 0.015599008649587631, -0.04098023474216461, 0.00110159395262599, 0.012215262278914452, 0.0358264334499836, -0.006736219860613346, -0.01531129702925682, -0.01851365901529789, -0.05116274580359459, 0.0012266862904652953, 0.025081004947423935, -0.008906571194529533, 0.030097205191850662, 0.016712330281734467, 0.012108934111893177, -0.021653475239872932, -0.014961037784814835, -0.029146503657102585, 0.003780914470553398, -0.026969898492097855, 0.012796941213309765, 0.0011172305094078183, 0.002240715781226754, -0.005866828374564648, 0.015298787504434586, 0.014635798521339893, 0.0065360721200704575, -0.04893610626459122, 0.012803195975720882, -0.027044953778386116, 0.012515483424067497, 0.004350084345787764, 0.022491594776511192, -0.009632106870412827, 0.006717456039041281, 0.031823478639125824, 0.0038215694949030876, 0.037852928042411804, 0.00954454205930233, 0.010270076803863049, 0.0008451548055745661, 0.013147199526429176, 0.02626938186585903, 0.008137254044413567, -0.011452198959887028, -0.005216348450630903, 0.021065542474389076, -0.036852188408374786, 0.02325465716421604, -0.0117086386308074, -0.009738435037434101, 0.01930174045264721, 0.031773440539836884, -0.03377491980791092, 0.017738087102770805, -0.02090292237699032, -0.007643138989806175, -0.015649044886231422, -0.0349758043885231, 0.005747990682721138, -0.005050601437687874, -0.021640965715050697, 0.014585761353373528, -0.004744125064462423, 0.006301524117588997, -0.02284185215830803, 0.007261607330292463, -0.018576204776763916, 0.013660077936947346, -0.0009061372838914394, -0.005150675307959318, 0.004472049418836832, -0.0029928330332040787, -0.02294192649424076, 0.00938817672431469, -0.03535108268260956, 0.029721928760409355, 0.04458289220929146, -0.017900707200169563, -0.0013142508687451482, -0.009463232010602951, -0.019702035933732986, -0.0028255220968276262, -0.016211960464715958, -0.018363548442721367, -0.001078921020962298, 0.02322963811457157, 0.012922033667564392, -0.0139102628454566, -0.03194857016205788, -8.121225982904434e-05, -0.033499717712402344, -0.03475064039230347, 0.0015605263179168105, 0.010589062236249447, -0.003640185808762908, -0.01877635344862938, 0.04951152950525284, 0.003727750387042761, 0.009131737053394318, 0.004997436888515949, -0.004900490399450064, 0.06259617954492569, 3.12486408802215e-05, -0.028696171939373016, -0.004362593870609999, -0.011414671316742897, -0.002190678846091032, -0.0031726532615721226, -0.019727054983377457, -0.000528124044649303, -0.014197975397109985, 0.006686183158308268, -0.003702731803059578, 0.00765564851462841, -0.033024366945028305, 0.0003639404021669179, -0.004906745161861181, -0.014498196542263031, -0.00936315767467022, 0.031298089772462845, -9.587151726009324e-05, 8.751574205234647e-05, -0.0188013706356287, 0.0043188114650547504, 0.022241409868001938, -0.0150110749527812, 0.004243756178766489, 0.005729226861149073, 0.024505579844117165, -0.006880076136440039, 0.02992207556962967, -0.02459314465522766, -0.01202136930078268, -0.018813880160450935, 0.00013447421952150762, 0.013147199526429176, -0.03500082343816757, 0.007130260579288006, -0.0025737739633768797, -0.0035494938492774963, 0.007530556060373783, -0.01058280747383833, 0.01872631534934044, -0.02349233254790306, 0.025268642231822014, -0.004049862734973431, 4.260956120560877e-05, 0.024030229076743126, 0.03334960341453552, -0.005957520566880703, 0.01025131344795227, -0.011395907960832119, 0.007862051017582417, -0.028496023267507553, 0.009525777772068977, 0.015223732218146324, 0.0008647004724480212, -0.003959171008318663, -0.020052295178174973, -0.03049750067293644, -0.006289015058428049, 0.006467271596193314, -0.007643138989806175, 0.0472598671913147, -0.021015504375100136, -0.010670372284948826, 0.0050881290808320045, 0.010770446620881557, -0.0028474132996052504, -0.021590929478406906, 0.006176432128995657, 0.009188028983771801, 0.006210832390934229, -0.002253224840387702, 0.023880118504166603, -0.009525777772068977, 0.010657863691449165, 0.009344394318759441, 0.012108934111893177, 0.025393735617399216, 0.023016981780529022, -0.0011891586473211646, -0.010770446620881557, -0.024380488321185112, 0.04205602779984474, -0.004362593870609999, 0.007442991249263287, -0.005804282147437334, 0.016899969428777695, -0.011602310463786125, 0.012077661231160164, 0.03527602553367615, -0.012546757236123085, 0.010545279830694199, -0.004271901678293943, -0.023667462170124054, -0.016211960464715958, 0.016950005665421486, 0.0009350648615509272, 0.005325804464519024, 0.006201450247317553, -0.002204751595854759, -0.020027276128530502, -0.03435034304857254, 0.04098023474216461, 0.007399209309369326, 0.03477565571665764, -0.01033262349665165, -0.016687311232089996, 0.015186204575002193, 0.013034616596996784, 0.017638012766838074, 0.00018978846492245793, 0.027970636263489723, 0.006310906261205673, -0.03262406960129738, 0.00844372995197773, 0.002881813794374466, -0.002426790539175272, -0.02217886410653591, -0.00883777067065239, -0.006961386185139418, -0.00829987321048975, 0.0017622376326471567, -0.0005488424212671816, -0.00656109070405364, 0.0042844112031161785, -0.01951439678668976, -0.005216348450630903, 0.015611518174409866, 0.019439341500401497, 0.00786830484867096, -0.03492576628923416, 0.0057073356583714485, -0.008987881243228912, -0.009525777772068977, -0.014135428704321384, -0.02619432657957077, 0.007155279163271189, -0.044983189553022385, 0.017888197675347328, -0.013247273862361908, 0.016462145373225212, 0.0468345545232296, 0.015198713168501854, -0.023905137553811073, 0.02050262689590454, 0.0015136167639866471, -0.0004554141196422279, 0.030347390100359917, 0.0020952958147972822, -0.0032680360600352287, 0.007436736952513456, -0.012947051785886288, -0.00300534232519567, 0.018401077017188072, 0.011677365750074387, -0.015473916195333004, -0.013897753320634365, 0.01875133439898491, -0.010270076803863049, 0.024605654180049896, 0.007824522443115711, -0.024005210027098656, -0.003283672733232379, 0.01414793822914362, -0.031223036348819733, -0.02939668856561184, 0.013472439721226692, 0.033624809235334396, -0.013072144240140915, -0.02079033851623535, -0.009982365183532238, 0.029196541756391525, -0.02378004416823387, 0.021728530526161194, 0.0019264213042333722, 0.0011086304439231753, 0.0077432128600776196, -0.008656386286020279, 0.005441514775156975, 0.004187464714050293, 0.000150306208524853, 0.03695226460695267, -0.01748790219426155, -0.00723033444955945, -0.02569395676255226, 0.02732015587389469, 0.041155364364385605, 0.0472598671913147, -0.02674473263323307, 0.032473959028720856, 0.0012204316444694996, 0.005507188383489847, -0.014385613612830639, 0.0040436084382236, -0.017713068053126335, 0.0031898533925414085, -0.025343697518110275, -0.011721148155629635, -0.019101593643426895, -0.007124005816876888, 0.001505798427388072, 0.03435034304857254, 0.00042492288048379123, -0.0004511140868999064, 0.0004960691439919174, -0.023542368784546852, -0.009144246578216553, -0.0029287233483046293, 0.008912825956940651, 0.01628701575100422, 0.02380506321787834, 0.016224469989538193, 0.008500020951032639, 0.0060638487339019775, 0.05779263749718666, -0.023242147639393806, -0.03109794296324253, 0.023479823023080826, -0.003174216952174902, 0.018401077017188072, 0.011202014982700348, -0.041105326265096664, -0.03527602553367615, 0.011508490890264511, -0.02669469453394413, -0.023955173790454865, -0.016111887991428375, 0.03500082343816757, -0.01253424771130085, 0.006073230877518654, -0.00015226077812258154, 0.019176648929715157, 0.03212369978427887, 0.02446805313229561, -0.022066280245780945, 0.017112625762820244, -0.008256091736257076, 0.014235503040254116, -0.0059168655425310135, -0.021703513339161873, -0.041730787605047226, -0.04906119778752327, -0.021128088235855103, 0.03162332996726036, -0.026544583961367607, 0.016562219709157944, -0.0009123919298872352, -0.016274508088827133, -0.0021500238217413425, -0.0063640703447163105, 0.00017112234490923584, -0.0033024365548044443, 0.011908786371350288, 0.01667480170726776, 0.03049750067293644, 0.03420023247599602, -0.04160569608211517, 0.008556312881410122, -0.009844763204455376, 0.011151977814733982, 0.027595359832048416, -0.0010578116634860635, -0.00020620682334993035, -0.021728530526161194, -0.0065360721200704575, -0.03427528962492943, 0.00011483081470942125, -0.008249836973845959, 0.013097163289785385, -0.017137644812464714, 0.02092793956398964]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" zero for LoRA, and we thus consider setting
σ2
a= 0, σ2
b= Θ(1) .
Analysis of unpreconditioned training. Assume the
model is trained with gradient descent with learning rate
η= Θ( nc)for some c∈R.Since the training procedure in-
volves only elementary algebraic operations, the quantities
there should be of powers of n.In iteration t, the feature
update without preconditioning is given by
∆ft:=ft(x)−ft−1(x)
=−ηb2
t−1(ft−1(x)−y)∥x∥2
−η(aT
t−1x)2(ft−1(x)−y)
+η2(ft−1(x)−y)2bt−1(aT
t−1x)∥x∥2.
We denote δ1
t=ηb2
t−1(ft−1(x)−y)∥x∥2, δ2
t=
η(aT
t−1x)2(ft−1(x)−y),andδ3
t=η2(ft−1(x)−
y)2bt−1(aT
t−1x)∥x∥2.For stable feature learning, we would
likeδ1
t, δ2
t, δ3
t∈Θ(1) and further ft−1(x)∈Θ(1).
Note that δ3
t∈Θ(1) is guaranteed as long as δ1
t, δ2
t∈
Θ(1).Thus for stable feature learning, it suffices to have
δ1
t, δ2
t, ft−1(x)∈Θ(1).For the sake of notational clarity,
we introduce new notation γsuch that v= Θ( nγ[v])cap-
tures the polynomial behavior for any v. We refer readers to
Section A.2 in (Hayou et al., 2024) for additional properties
ofγ[·].Stable feature learning is thus equal to the following
linear constraints


c+ 2γ[bt−1] + 1 = 0 ( forδ1
t= Θ(1)) ,
c+ 2γ[aT
t−1x] = 0 ( forδ2
t= Θ(1)) ,
γ[bt−1] +γ[aT
t−1x] = 0 ( forft−1(x) = Θ(1)) ,
from which we can derive c=−1/2and thus the learning
rate should be set to η= Θ( n−1/2).Withγ[b1] =γ[b0] = 0
andγ[aT
1x] =γ[ηb0y∥x∥2] = 1 /2,one can inductively
deduce that γ[bt] = 0 andγ[aT
tx] = 1/2for all tand thus
γ[ft] = 1 /2, contradicting to ft= Θ(1) .Instead, stable
feature learning requires to set separately ηa= Θ(1 /n)
andηb= Θ(1) as shown in Proposition 2 in (Hayou et al.,
2024).
3
Riemannian Preconditioned LoRA
Analysis of preconditioned training. We now proceed
to show that with our preconditoned parameter updates (1),
c=−1would generate stable feature learning. After the
injection of preconditioner (1), the training dynamics are
given by
∆ft:=ft(x)−ft−1(x)
= (bt−1−η(ft−1(x)−y)aT
t−1x∥at−1∥−2
|{z}
preconditioner)(aT
t−1
−η(ft−1(x)−y)bt−1xTb−2
t−1|{z}
preconditioner)x
=−η(ft−1(x)−y)∥x∥2
−η(aT
t−1x)2(ft−1(x)−y)∥at−1∥−2
+η2(ft−1(x)−y)2b−1
t−1∥at−1∥−2(aT
t−1x)∥x∥2.
We similarly define δ1scaled","[0.014726527035236359, -0.009025936014950275, 0.00928325392305851, -0.018817229196429253, -0.031142117455601692, 0.0014606114709749818, 0.02376565895974636, 0.009072121232748032, -0.026180490851402283, 0.0669291615486145, -0.0006193784647621214, -0.004974821116775274, -0.02631244994699955, 0.024610189720988274, 0.023251021280884743, -0.004460184369236231, 0.06835430860519409, -0.009745107032358646, -0.02232731506228447, 0.0722074881196022, 0.019727738574147224, -0.055897459387779236, 0.0390859954059124, 0.007983466610312462, 0.042068250477313995, -0.04098619148135185, 0.05457787960767746, 0.024465035647153854, 0.0338340625166893, -0.030640676617622375, 0.026813890784978867, -0.024240707978606224, -0.038241464644670486, -0.07537447661161423, 0.02000485174357891, -0.0049385325983166695, -0.000659378245472908, 0.034335505217313766, -0.02451781928539276, 0.017352493479847908, -0.018065067008137703, -0.06397330015897751, -0.08909812569618225, 0.011843241751194, -0.0023851431906223297, 0.003368231002241373, -0.011632108129560947, 0.017101772129535675, 0.014700135216116905, 0.04621173441410065, -0.028318213298916817, 0.029268311336636543, -0.031907472759485245, -0.005924919620156288, -0.02112649567425251, 0.0004733997629955411, 0.03655239939689636, -0.002327411435544491, 0.013710449449717999, -0.01909434050321579, 0.03774002194404602, -0.0518595427274704, 0.02338298037648201, -0.023198237642645836, -0.015267554670572281, -0.024623386561870575, -0.046053383499383926, -0.002047000452876091, 0.02083618752658367, 0.02879326231777668, -0.03916517272591591, -0.02284195087850094, 0.07912208884954453, -0.008696040138602257, -0.002815656363964081, 0.02421431615948677, 0.030403152108192444, 0.06281206756830215, 0.05294159799814224, 0.004602039698511362, 0.05389169603586197, -0.010622628964483738, 0.06170361861586571, -0.024610189720988274, 0.012074167840182781, -0.07009615749120712, -0.007501819171011448, -0.007468829862773418, 0.00021154536807443947, -0.013169420883059502, -0.005971105303615332, 0.01811785064637661, -0.017048990353941917, 0.015610646456480026, 0.046422868967056274, -0.003995032049715519, 0.035364776849746704, -0.03330622985959053, 0.022432880476117134, -0.020545879378914833, 0.00717852171510458, -0.04568390175700188, 0.06328711658716202, -0.03293674811720848, 0.03594539314508438, -0.021456390619277954, -0.03655239939689636, -0.004420597106218338, -0.021403606981039047, 0.020954949781298637, 0.004912141244858503, 0.010160775855183601, 0.018328983336687088, -0.012054374441504478, 0.011599118821322918, -0.08904533833265305, -0.045815858989953995, -0.004506370052695274, -0.045525550842285156, -0.02082299254834652, -0.006287804804742336, -0.02578461728990078, -0.04051114246249199, -0.025876987725496292, 0.005367396865040064, -0.027315331622958183, 0.05201789364218712, -0.04127649962902069, -0.011480356566607952, -0.022208552807569504, 0.03565508499741554, 0.034836944192647934, -0.007468829862773418, 0.0015686522237956524, -0.02850295417010784, -0.0044733802787959576, 0.037845589220523834, 0.0406167097389698, 0.021390412002801895, 0.0023884419351816177, -0.0011026751017197967, 0.006442855577915907, -0.03164355829358101, 0.006795843131840229, -0.029136354103684425, 0.021746698766946793, -0.010490670800209045, 0.003378127934411168, -0.009751705452799797, -0.02398998662829399, -0.014700135216116905, 0.015254358761012554, -0.02953222766518593, -0.005063892807811499, 0.007369861006736755, 0.006888214033097029, -0.01563703827559948, 0.019450627267360687, 0.02805429697036743, 0.004902244079858065, -0.0028634911868721247, 0.04225299134850502, 0.04689791798591614, -0.004790079779922962, 0.04336144030094147, 0.003760806517675519, -0.03789837285876274, -0.00240658619441092, -0.048903681337833405, -0.07336871325969696, 0.04481297731399536, 0.00358926085755229, -0.047716058790683746, -0.04700348526239395, 0.05172758549451828, -0.0013228801544755697, -0.02203700691461563, -0.05307355895638466, 0.006208629813045263, -0.026220079511404037, 0.004051114432513714, 0.03583982586860657, -0.01033891923725605, 0.05135810002684593, -0.01683785580098629, 0.04729378968477249, -0.015293946489691734, -0.028001513332128525, 0.01871166191995144, 0.029215527698397636, -0.02713059075176716, -0.006301000248640776, 0.07716911286115646, -0.0054234787821769714, -0.006967389024794102, -0.0654512271285057, 0.04127649962902069, 0.03399241343140602, -0.00599419791251421, 0.029347486793994904, 0.00868944264948368, 0.012674577534198761, -0.0007748415810056031, -0.006888214033097029, 0.011863035149872303, -0.007482025772333145, 0.01616487093269825, 0.00021814327919855714, -0.020110417157411575, 0.00018020531570073217, -0.030033668503165245, 0.030033668503165245, 0.012727361172437668, -0.001144736772403121, -0.055739112198352814, 0.02239329367876053, -0.05125253647565842, 0.0330687053501606, -0.012806535698473454, 0.023554524406790733, 0.0049352338537573814, -0.018144242465496063, 0.014159106649458408, 0.04338783025741577, -0.02186546102166176, -0.010220156982541084, 0.0488772876560688, 0.0028074090369045734, 0.03425632789731026, -0.021482782438397408, 0.0654512271285057, -0.0008527793688699603, -0.006881616078317165, -0.03488972783088684, 0.0511469691991806, -0.04291278123855591, -0.01338055357336998, -0.0706239864230156, -0.008874183520674706, -0.01089974120259285, -0.03660518303513527, 0.024399057030677795, -0.005311314482241869, -0.016864247620105743, 0.007877900265157223, 0.002485761186107993, -0.010959122329950333, -0.027011828497052193, 0.010437887161970139, 0.0039059603586792946, -0.030033668503165245, -0.014462610706686974, -0.015096009708940983, -0.024082357063889503, -0.04549916088581085, 0.04125010967254639, -0.00048535846872255206, -0.02789594791829586, -0.02789594791829586, -0.02435947023332119, -0.005063892807811499, -0.017787955701351166, -0.0009649437852203846, -0.014911267906427383, -0.006228423211723566, -0.002937717828899622, -0.01394797395914793, -0.015755800530314445, 0.03879568725824356, 0.014832093380391598, 0.0054432726465165615, 0.04816471412777901, -0.03855816274881363, 0.008082435466349125, -0.0420946404337883, -0.030614284798502922, 0.04684513434767723, 0.051833152770996094, -0.023501742631196976, 0.027473680675029755, -0.03515364229679108, 0.021324433386325836, 0.07410768419504166, 0.008801606483757496, 0.027552856132388115, -0.018170634284615517, -0.02231411822140217, -0.008577277883887291, -0.010286135599017143, -0.010780978947877884, 0.0443643219769001, -0.013215606100857258, 0.04623812809586525, 0.03246169909834862, -0.02525678463280201, 0.026668736711144447, 0.012074167840182781, -0.012014786712825298, -0.005944713484495878, -0.02474214881658554, 0.037555281072854996, 0.017167752608656883, -0.014159106649458408, -0.0036717348266392946, -0.022736385464668274, 0.02639162540435791, 0.039138779044151306, -0.01706218533217907, 0.032224174588918686, 0.005139769054949284, -0.01551827508956194, 0.05381252244114876, -0.025019260123372078, 0.04856058955192566, -0.029505835846066475, -0.01960897631943226, 0.024227511137723923, -0.02263081818819046, -0.01180365402251482, 0.0007542231469415128, -0.006287804804742336, -0.06080630421638489, 0.011526541784405708, -0.002512152772396803, 0.0466339997947216, 0.016653114929795265, -0.021034125238656998, 0.0054465713910758495, -0.010576443746685982, -0.006426360458135605, -0.008953358978033066, -0.02314545400440693, 0.017194142565131187, -0.004704307299107313, -0.03494251146912575, -0.0006614400772377849, -0.022881539538502693, 0.024768540635704994, 0.024319881573319435, 0.019067948684096336, -0.08286970108747482, -0.027922339737415314, -0.010807370766997337, 0.043862879276275635, -0.029796143993735313, -0.0030399851966649294, -0.005555436946451664, 0.0028832850512117147, 0.0338340625166893, 0.02932109497487545, -0.008135218173265457, -0.01586136594414711, 0.07928044348955154, -0.013222203589975834, -0.005647807847708464, 0.0014960751868784428, 0.004268845077604055, -0.03090459294617176, -0.03370210528373718, 0.009731912054121494, -0.012634990736842155, 0.025652660056948662, 0.012634990736842155, 0.012667980045080185, -0.031142117455601692, 0.04462823644280434, 0.012047776952385902, 0.026589561253786087, 0.01086675189435482, 0.013030864298343658, -0.0016387549694627523, 0.019371451810002327, -0.024926889687776566, -0.019833305850625038, -0.031062941998243332, -0.02127164974808693, 0.04098619148135185, 0.006713369395583868, 0.027711205184459686, 0.009474593214690685, 0.0011150460923090577, -0.010774380527436733, 0.02173350378870964, -0.015016834251582623, 0.010741391219198704, 0.0206646416336298, 0.00729068648070097, -0.03581343591213226, -0.05510571226477623, -0.02270999364554882, 0.029057178646326065, -0.00642965966835618, -0.012938493862748146, 0.03916517272591591, -0.008940163068473339, 0.021905047819018364, -0.02210298553109169, 0.04652843251824379, 0.02285514771938324, 0.03557591140270233, -0.042437732219696045, -0.047188226133584976, -0.06302320212125778, -0.029875319451093674, -0.03810950741171837, -0.00785150844603777, 0.010959122329950333, 0.085719995200634, 0.01992567628622055, 0.029453054070472717, 0.01916031911969185, -0.01037190854549408, 0.01850052922964096, -0.026259666308760643, 0.012324889190495014, 0.0019760727882385254, -0.016441982239484787, 0.06402608007192612, 0.020915362983942032, 0.08967874199151993, 0.017629604786634445, 0.0076535711996257305, -0.0236732866615057, -0.015003638342022896, -0.03209221735596657, 0.012582207098603249, -0.012608598917722702, -0.02278916724026203, -0.03737054020166397, -0.03280479088425636, 0.0037740024272352457, 0.032435305416584015, -0.026035338640213013, -0.0033946228213608265, -0.02684028260409832, -0.0020222582388669252, -0.01992567628622055, 0.006551720667630434, 0.02549430914223194, -0.04396844655275345, 0.029743360355496407, 0.017919912934303284, -0.01506961788982153, 0.0019579287618398666, -0.00469770934432745, 0.04594781994819641, -0.04172515869140625, 0.006802441086620092, -0.013776428066194057, -0.008729029446840286, -0.02133762836456299, 0.0154127087444067, 0.04320308938622475, 0.005961208138614893, 0.03256726637482643, -0.0668763741850853, 0.05452509596943855, -0.0025418433360755444, 0.04254329949617386, 0.014528589323163033, -0.009646139107644558, -0.008874183520674706, -0.010873349383473396, -0.05816714093089104, 0.0021806079894304276, 0.029347486793994904, 0.03871651366353035, -0.012918700464069843, -0.00017453523469157517, -0.0046152351424098015, 0.004720801953226328, -0.035892609506845474, 0.03148520737886429, -0.04196268320083618, -0.013499315828084946, 0.03723858296871185, -0.0016008169623091817, -0.04776884242892265, 0.001999165629968047, 0.01323539949953556, 0.024491427466273308, 0.007501819171011448, 0.0060304864309728146, -0.02773759700357914, 0.03858455643057823, 0.09115666896104813, 0.03196025639772415, -0.026721520349383354, 0.016270436346530914, -0.01871166191995144, 0.00532121118158102, -0.01722053438425064, 0.035602301359176636, -0.015399512834846973, -0.024451840668916702, -0.015953736379742622, -0.027420898899435997, -0.013591686263680458, -0.008557484485208988, -1.6520538338227198e-05, 0.03847898915410042, 0.031537991017103195, 0.013070452027022839, 0.01473972201347351, 0.03180190920829773, -0.00820119772106409, 0.003437509061768651, -0.0011958704562857747, -0.0007377283764071763, -0.0017220535082742572, 0.012648185715079308, 0.057850442826747894, -0.006644091568887234, -0.00588203314691782, -0.01033891923725605, 0.005192552227526903, -0.032883964478969574, -0.0010037064785137773, -0.026272863149642944, 0.020572271198034286, 0.012186332605779171, 0.015650233253836632, -0.03787198290228844, -0.033411797136068344, 0.026972239837050438, -0.01180365402251482, -0.019727738574147224, -0.0917372852563858, -0.027948729693889618, 0.006162444595247507, 0.016257241368293762, -0.0032923552207648754, -0.028318213298916817, 0.016877444460988045, -0.01925268955528736, 0.007105945143848658, -0.013209008611738682, -0.02164113149046898, -0.030271193012595177, 0.004618534352630377, -0.005268428009003401, -0.020097222179174423, 0.03525920957326889, 0.005271727219223976, 0.029136354103684425, -0.020163200795650482, 0.0040478152222931385, -0.015227967873215675, 0.0019727740436792374, 0.046264518052339554, 0.031379640102386475, -0.01933186501264572, -0.01669270172715187, -0.0017401977675035596, -0.02111329883337021, -0.013268389739096165, 0.0008643257315270603, 0.0047735851258039474, 0.0005336056347005069, 0.04272804036736488, -0.003457302926108241, -0.008676246739923954, -0.013466326519846916, -0.015227967873215675, -0.01744486391544342, 0.052070677280426025, -0.012634990736842155, -0.03721218928694725, 0.01026634220033884, 0.0009979333262890577, -0.011717881076037884, 0.005944713484495878, 0.008616865612566471, 0.009903457015752792, 0.021971028298139572, -0.03029758483171463, 0.04681874066591263, 0.015927346423268318, 0.029426662251353264, 0.0033039015252143145, -0.0206646416336298, -0.041461244225502014, -0.02195783145725727, -0.022987104952335358, -0.04441710561513901, -0.000405358849093318, 0.007594190072268248, 0.0008997894474305212, -0.03029758483171463, -0.005436674691736698, 0.03525920957326889, -0.0021938038989901543, 0.00019979284843429923, -0.006060176994651556, -0.024570602923631668, -0.025019260123372078, -0.03618291765451431, 0.0068420288152992725, -0.0008127795881591737, 0.01394797395914793, 0.022828755900263786, -0.004819770343601704, 0.04985377937555313, -0.0032346234656870365, 0.0007356665446422994, -0.007297284435480833, -0.04610616713762283, 0.02141680382192135, 0.012225920334458351, -0.028661305084824562, -0.00969892181456089, 0.007976868189871311, 0.021984223276376724, -0.004727399908006191, 0.0010037064785137773, -0.028608521446585655, 0.012879112735390663, -0.03370210528373718, 0.06381494551897049, 0.02314545400440693, 0.0012247363338246942, -0.03283118084073067, 0.010107992216944695, -0.009303047321736813, 0.010978915728628635, 0.0010103044332936406, -0.008471711538732052, -0.032514482736587524, 0.03090459294617176, -0.022868342697620392, -0.029189137741923332, -0.01458137296140194, 0.038742903620004654, 0.0022515354212373495, -0.01810465380549431, -0.005858940538018942, 0.012252312153577805, -0.014475805684924126, 0.009712117724120617, -0.0353383868932724, 0.036789923906326294, 0.020400725305080414, 0.012687773443758488, -0.034018803387880325, 0.056425292044878006, -0.010800772346556187, -0.015610646456480026, 0.03465220332145691, -0.03166994825005531, -0.03481055423617363, -0.006241619121283293, -0.032883964478969574, 0.04051114246249199, 0.02051948755979538, 0.029426662251353264, -0.017497647553682327, -0.025349155068397522, -0.01587456278502941, 0.02908357046544552, -0.0016503012739121914, -0.024768540635704994, -0.012338084168732166, 0.004404102452099323, 0.027104198932647705, 0.014911267906427383, -0.010015621781349182, 0.023792048916220665, 0.021073712036013603, -0.006726565305143595, -0.0187908373773098, 0.026642344892024994, 0.012971483170986176, -0.004130289424210787, -0.008498103357851505, -0.021918244659900665, -0.03858455643057823, -0.021522369235754013, -0.0406167097389698, -0.028476562350988388, 0.038531772792339325, -0.039508260786533356, 0.001538136857561767, -0.03211860731244087, -0.027948729693889618, -0.045208852738142014, -0.02008402720093727, -0.009639540687203407, -0.008253980427980423, -0.004770286381244659, -0.015650233253836632, -0.007963673211634159, -0.006277907639741898, 0.03729136660695076, -0.009910055436193943, 0.00988366361707449, -0.009745107032358646, -0.04993295297026634, 0.002903078682720661, 0.043651748448610306, -0.0010919534834101796, -0.019265886396169662, 0.018025480210781097, -0.01563703827559948, -0.007515015080571175, -0.038742903620004654, -0.02661595307290554, -0.0073104798793792725, 0.0004441215714905411, 0.061914753168821335, -0.01675868220627308, -0.01947701908648014, -0.007402850780636072, -0.003797095036134124, 0.016811465844511986, -0.0300600603222847, -0.0074886237271130085, 0.051833152770996094, 0.03903321176767349, -0.0067628538236021996, -0.0018144241767004132, -0.01939784362912178, -0.005044099409133196, -0.04254329949617386, -0.005565333645790815, 0.015848170965909958, -0.02797512151300907, -0.029954494908452034, 0.011605717241764069, 0.0032247265335172415, 0.010061806999146938, 0.025454722344875336, 0.0116584999486804, 0.03283118084073067, 0.052070677280426025, -0.018078263849020004, 0.02338298037648201, -0.025296371430158615, 0.0018424652516841888, 0.009758302941918373, -0.010985514149069786, -0.018381766974925995, -0.02022917941212654, -0.022762775421142578, 0.03602456673979759, 0.040036093443632126, 0.03742332383990288, 0.019529802724719048, 0.020176397636532784, -0.0036387452855706215, 0.0014193746028468013, -0.00650223670527339, 0.010780978947877884, 0.0037476106081157923, -0.01458137296140194, 0.02512482739984989, -0.015399512834846973, -0.01019376516342163, -0.008953358978033066, -0.045446377247571945, -0.0308254174888134, -0.0022977208718657494, -0.0018721559317782521, 0.0025171011220663786, -0.0022960712667554617, -0.012074167840182781, 0.03143242374062538, 0.003632147330790758, -0.009507582522928715, 0.04594781994819641, -0.0030152432154864073, -0.012239116244018078, 0.019516605883836746, 0.011665098369121552, 0.025441525503993034, 0.023501742631196976, 0.013439934700727463, 0.039798568934202194, -0.05204428359866142, 0.01871166191995144, 0.001388859236612916, -0.019529802724719048, 0.0011752520222216845, 0.017233731225132942, 0.029373878613114357, -0.02660275809466839, 0.0007014399161562324, -0.008352949284017086, -0.008900575339794159, -0.011698087677359581, -0.04030001163482666, 0.005730281583964825, -0.0011133967200294137, 0.020915362983942032, 0.02330380491912365, 0.04106536880135536, 0.04383648931980133, -0.034836944192647934, -0.10619989782571793, -0.012430455535650253, -0.004526163451373577, -0.010536856018006802, 0.017418472096323967, -0.004272144287824631, 0.002246587071567774, -0.0019067948451265693, -0.0009921601740643382, 0.014264672994613647, -0.02720976434648037, -0.014383435249328613, -0.016666311770677567, -0.008359546773135662, 0.02051948755979538, -0.041223715990781784, -0.029664186760783195, -0.010543454438447952, 0.02164113149046898, 0.02451781928539276, -0.05170119181275368, -0.013446533121168613, 0.008775215595960617, 0.0034210144076496363, -0.05302077531814575, -0.029347486793994904, 0.024478232488036156, -0.00511337723582983, 0.0006235021282918751, 0.018540116026997566, 0.03715940937399864, -0.032356131821870804, 0.04668678343296051, 0.05832549184560776, -0.036420442163944244, -0.0028882334008812904, -0.011566129513084888, 0.013222203589975834, 0.016178065910935402, 0.06112300232052803, 0.02533596009016037, -0.06661245971918106, 0.03921795263886452, -0.0012569010723382235, 0.021693915128707886, -0.017088577151298523, 0.05167480185627937, -0.037027448415756226, -0.004951728507876396, -0.012285301461815834, 0.029453054070472717, 0.0007414396968670189, 0.0073896548710763454, -0.014343848451972008, -0.03346458077430725, -0.02707780711352825, -0.051833152770996094, -0.011526541784405708, -0.006594607140868902, 0.0014729825779795647, -0.018394961953163147, 0.024253902956843376, 0.0021030826028436422, -0.0063339900225400925, -0.031300466507673264, -0.034836944192647934, 0.008280372247099876, 0.031854692846536636, -0.03209221735596657, -0.026338841766119003, -0.01728651486337185, 0.0009129852405749261, -0.022644013166427612, 0.021443195641040802, -0.009415212087333202, -0.01075458712875843, -0.049959346652030945, 0.013789623975753784, -0.051833152770996094, -0.0003907197678927332, 0.020849384367465973, -0.02600894682109356, 0.03277839720249176, 0.02136402018368244, -0.003886166727170348, 0.03372849524021149, 0.012575609609484673, -0.012133549898862839, -0.023435762152075768, -0.021007733419537544, 0.042886391282081604, 0.0061921351589262486, 0.03267282992601395, -0.00770635437220335, 0.0026078224182128906, -0.0047735851258039474, -0.028898829594254494, 0.00917768757790327, 0.0034342100843787193, 0.019952068105340004, -0.014145910739898682, 0.04262247309088707, 0.007838312536478043, 0.004865956027060747, 0.013195812702178955, 0.00038123526610434055, 0.039666611701250076, -0.002371947281062603, 0.047557707875967026, -0.045288026332855225, 0.04555194452404976, -0.04956347122788429, -0.02135082520544529, 0.0225648395717144, -0.016877444460988045, 0.0001846382801886648, 0.022723188623785973, 0.04460184648633003, 0.03293674811720848, -0.017682388424873352, 0.018698466941714287, -0.021984223276376724, 0.020717425271868706, -0.008465114049613476, -0.014462610706686974, -0.013030864298343658, 0.002627616049721837, 0.006881616078317165, -0.024491427466273308, -0.0033946228213608265, 0.007515015080571175, 0.02435947023332119, 0.012450248934328556, 0.02834460511803627, 0.04069588705897331, 0.031986650079488754, 0.014383435249328613, -0.006376876495778561, -0.027684815227985382, 0.00180452736094594, -0.01728651486337185, 0.015016834251582623, 0.02133762836456299, 0.00812202226370573, -0.01037190854549408, 0.02503245510160923, -0.012602000497281551, -0.0015472089871764183, -0.01640239544212818, 0.04351978749036789, 0.04336144030094147, -0.043123915791511536, 0.017853934317827225, 0.017418472096323967, 0.004664719570428133, -0.01435704343020916, 0.02045350894331932, -0.03993052989244461, 0.0028733881190419197, 0.03103655017912388, -0.006132753565907478, 0.02451781928539276, 0.0086498549208045, -0.032883964478969574, 0.01390838623046875, -0.015056421980261803, -0.02090216614305973, -0.03583982586860657, 0.002764522796496749, 0.029136354103684425, -0.04515606909990311, -0.06861822307109833, 0.0052024489268660545, 0.008260578848421574, 0.005581828765571117, -0.0004911316209472716, -0.0006655637989751995, -0.005763270892202854, 0.005664302501827478, 0.02684028260409832, 0.008478309027850628, -0.0005410283338278532, -0.0076535711996257305, 0.004740595817565918, 0.0017863831017166376, -0.005571931600570679, -0.005195850972086191, 0.0014399930369108915, 0.005090284626930952, 0.03465220332145691, 0.01233148667961359, 0.012153343297541142, 0.016376003623008728, 0.020638249814510345, 0.04710904881358147, -0.006264711730182171, -0.007072955369949341, 0.034599419683218, 0.0044733802787959576, -0.047927189618349075, -0.021561957895755768, 0.039798568934202194, -0.006208629813045263, -0.032435305416584015, -0.037185799330472946, 0.04623812809586525, -0.0036948274355381727, -0.02594296634197235, 0.006063475739210844, -0.00021082372404634953, 0.018394961953163147, 0.0040445164777338505, -0.02075701206922531, 0.0018028778722509742, 0.0030515315011143684, -0.011711283586919308, 0.018157437443733215, 0.012832927517592907, -0.013552099466323853, -0.0017847336130216718, -0.0323033481836319, -0.030614284798502922, 0.014515393413603306, -0.0015447348123416305, 0.004133588168770075, 0.017154555767774582, 0.040326401591300964, -0.001992567675188184, 0.013156224973499775, 0.01082056574523449, -0.031089333817362785, 0.02916274592280388, -0.006099764257669449, -0.010668814182281494, -0.01386879850178957, -0.01285931933671236, 0.010767783038318157, 0.006083269603550434, 0.00033504993189126253, 0.015175184234976768, 0.03634126856923103, 0.006475844886153936, -0.010965719819068909, 0.007336871698498726, -0.005934816785156727, 0.027011828497052193, 0.021443195641040802, 0.04080145061016083, -0.00969892181456089, 0.019345059990882874, -0.021773090586066246, 0.019806914031505585, 0.02728893980383873, -0.01677187718451023, -0.0023653493262827396, -0.0015571058029308915, 0.015333534218370914, 0.022802364081144333, 0.02863491326570511, 0.014792505651712418, -0.041698768734931946, 0.02757924795150757, 0.02435947023332119, -0.008385938592255116, -0.026074925437569618, -0.04919398948550224, -0.005987599957734346, -0.0024247304536402225, 0.013670861721038818, 0.019199907779693604, -0.00497812032699585, 0.01078757643699646, 0.012740557081997395, 0.016943423077464104, 0.013321172446012497, 0.0074886237271130085, 0.049141205847263336, -0.020057635381817818, 0.034625813364982605, -0.0023076175712049007, -0.008458515629172325, -0.047372967004776, 0.01345313061028719, -0.006663885433226824, 0.014937659725546837, -0.0031950359698385, 0.046502042561769485, -0.0012329836608842015, 0.00804944522678852, 0.02895161136984825, -0.012417259626090527, 0.007079553324729204, -0.01797269657254219, -0.011434171348810196, 0.04795358330011368, -0.022155769169330597, -0.009566963650286198, 0.028133472427725792, 0.006231722421944141, -0.008781813085079193, 0.023396175354719162, 0.005591725464910269, 0.006314196158200502, -0.014449414797127247, -0.02263081818819046, 0.04148763418197632, -0.016653114929795265, -0.036948274821043015, -0.02504565194249153, -0.030693460255861282, -0.015386316925287247, 0.018685270100831985, -0.014475805684924126, 0.04486576095223427, 0.004555854015052319, 0.008438722230494022, -0.010325723327696323, -0.0009278305806219578, 0.02610131725668907, -0.012489836663007736, 0.0064956387504935265, -0.0006210278952494264, 0.011711283586919308, 0.02226133458316326, 0.007792127318680286, -0.029057178646326065, -0.04309752210974693, -0.03066706843674183, -0.0022746282629668713, 0.023660091683268547, -0.006776049733161926, 0.008557484485208988, 0.025520700961351395, -0.013228802010416985, -0.02519080601632595, 0.036130134016275406, -0.02053268440067768, -0.012430455535650253, -0.006373577285557985, -0.0022828755900263786, 0.013281584717333317, 0.024940084666013718, -0.003404519520699978, 0.0027100900188088417, -0.03729136660695076, 0.019529802724719048, -0.016573939472436905, 0.006752957124263048, -0.022076593711972237, -0.0360773503780365, 0.06128135323524475, -0.010649020783603191, -0.007996662519872189, 0.023514937609434128, -0.007284088525921106, 0.025138022378087044, -0.006304299458861351, -0.0488508976995945, -0.03370210528373718, 0.020097222179174423, -0.0099562406539917, 0.04990656301379204, -0.01492446381598711, 0.010998710058629513, 0.026932653039693832, 0.009415212087333202, -0.02277597226202488, 0.011981797404587269, 0.003437509061768651, 0.020268768072128296, 0.013103441335260868, -0.026945848017930984, -0.02512482739984989, -0.057322610169649124, 0.00229277228936553, 0.02210298553109169, 0.007508417125791311, 0.021377215161919594, 0.006320794112980366, 0.014343848451972008, -0.014502197504043579, -0.020849384367465973, -0.03314787894487381, 0.0018523621838539839, -0.016125282272696495, 0.016415590420365334, -0.006284505594521761, -0.012615196406841278, -0.023567721247673035, 0.018460940569639206, 0.00018371045007370412, 0.0019001970067620277, -0.015214771963655949, 0.024465035647153854, -0.030719852074980736, 0.024187924340367317, -0.006769451778382063, 0.03826785460114479, -0.0018804032588377595, 0.005759972147643566, 0.026365233585238457, -0.0035133850760757923, 0.034599419683218, -0.011506748385727406, 0.007963673211634159, 0.010741391219198704, 0.014185498468577862, 0.023475350812077522, 0.023937202990055084, -0.0015076216077432036, -0.02195783145725727, 0.005825951229780912, -0.0405903197824955, 0.011830045841634274, -0.022195355966687202, -0.01327498722821474, 0.011058091185986996, 0.026879869401454926, -0.04750492423772812, 0.03750249743461609, -0.022432880476117134, -0.020427117124199867, -0.01863248646259308, -0.023686483502388, -0.024227511137723923, 0.010365311056375504, -0.015478688292205334, 0.018315788358449936, -0.007303881924599409, -0.009157894179224968, -0.022498860955238342, 0.004671317525207996, -0.030799025669693947, -0.0010218507377430797, 0.01616487093269825, -0.009606551378965378, 0.009131502360105515, -0.019186710938811302, -0.007904291152954102, -0.0056412098929286, -0.045235246419906616, 0.026272863149642944, 0.026497190818190575, -0.01600652001798153, -0.0037311159539967775, -0.03225056454539299, 0.007020172197371721, 0.0005286572268232703, -0.018592899665236473, -0.00033360664383508265, 0.001261849538423121, 0.003216479206457734, 0.01181025244295597, 0.0003334004431962967, -0.051463667303323746, -0.001030098064802587, -0.04710904881358147, -0.028925221413373947, -0.0005678323213942349, 0.013499315828084946, -0.002916274592280388, -0.006881616078317165, 0.012509630061686039, 0.011091080494225025, -0.002637512981891632, 0.0005938115646131337, -0.010510464198887348, 0.05932837352156639, 0.01714136078953743, -0.015927346423268318, 0.028318213298916817, -0.022063398733735085, 0.0024775138590484858, -0.00861026719212532, -0.023699678480625153, -0.013855602592229843, -0.0047966777347028255, 0.015016834251582623, -0.021443195641040802, 0.01425147708505392, -0.038742903620004654, -0.01071499940007925, 0.005812755320221186, 0.005759972147643566, 0.008188001811504364, 0.03343818709254265, -0.0036618378944694996, -0.0051793563179671764, -0.022287726402282715, 0.00016340127331204712, 0.01811785064637661, -0.017629604786634445, 0.005858940538018942, 0.022802364081144333, 0.03227695822715759, -0.014647351577877998, 0.01405354030430317, -0.024900497868657112, 0.009599953889846802, -0.015003638342022896, -0.007910889573395252, 0.015161988325417042, -0.028318213298916817, 0.02623327448964119, -0.012100559659302235, 0.01237107440829277, -0.012087363749742508, -0.009461397305130959, 0.032224174588918686, -0.010728195309638977, 0.03839981555938721, -0.0015109204687178135, 0.012727361172437668, 0.011183450929820538, 0.03752889111638069, -0.005139769054949284, 0.01811785064637661, 0.0038168886676430702, 0.0037904970813542604, -0.02549430914223194, 0.01454178523272276, 0.04066949337720871, 0.010589639656245708, -0.000914634729269892, -0.018909599632024765, -0.01601971685886383, 0.002475864253938198, 0.009791293181478977, 0.0007962848176248372, 0.04452266916632652, -0.02194463647902012, -0.01939784362912178, 0.0020404024980962276, 0.006007393356412649, -0.01425147708505392, -0.00036989510408602655, -0.0024329780135303736, 0.01190922036767006, -0.006046981085091829, -0.01113066729158163, 0.01685105264186859, -0.008366145193576813, 0.0069212038069963455, -0.003585962112993002, 0.020255571231245995, 0.009118306450545788, 0.02487410604953766, -0.01677187718451023, 0.006116258911788464, -0.022512055933475494, 0.051305320113897324, -0.028370996937155724, 0.029004395008087158, 0.004067609086632729, 0.009184285067021847, -0.012575609609484673, -0.007105945143848658, 0.021007733419537544, -0.047161832451820374, 0.01503003016114235, 0.012153343297541142, -0.024267099797725677, -0.008359546773135662, 0.03196025639772415, -0.0157821923494339, 0.0018705064430832863, 0.02211618237197399, -0.0014325703959912062, 0.010701803490519524, -0.02629925310611725, 0.04164598509669304, 0.009857271797955036, 0.03090459294617176, 0.001515044248662889, -0.02406916208565235, 0.02698543667793274, 0.006667184177786112, 0.008616865612566471, -0.012060972861945629, 0.027948729693889618, -0.0006762853590771556, -0.026655541732907295, 0.009349233470857143, -0.005865538492798805, 0.01691703125834465, -0.01570301689207554, 0.00018927743076346815, 0.009388820268213749, -0.016719093546271324, -0.00890717376023531, 0.011196646839380264, -0.01011458970606327, 0.016046108677983284, -0.023712875321507454, -0.011856437660753727, 0.01545229647308588, 0.020163200795650482, 0.014752917923033237, -0.019345059990882874, -0.0020882373210042715, -0.010048611089587212, -0.0056412098929286, 0.0029311198741197586, -0.03391323611140251, -0.004687812179327011, -0.0601201206445694, 0.00029999855905771255, -0.008366145193576813, 0.014211890287697315, 0.02406916208565235, 0.010840360075235367, -0.012034581042826176, 0.03578704223036766, -0.005453169345855713, -0.010365311056375504, 0.00642965966835618, 0.010622628964483738, -0.014898071996867657, 0.017260123044252396, -0.012324889190495014, -0.013829211704432964, 0.017458058893680573, 0.002533596009016037, -0.010609433054924011, -0.011025100946426392, 0.028608521446585655, 0.002894831355661154, 0.02088897116482258, 0.005657704547047615, -0.025283176451921463, 0.016521157696843147, 0.030930984765291214, -0.012179735116660595, -0.02594296634197235, 0.024412252008914948, 0.02610131725668907, -0.021825874224305153, -0.01082716416567564, 0.0045294626615941525, 0.027315331622958183, -0.022234944626688957, 0.01888320781290531, 0.007752539590001106, -0.001123293535783887, -0.0027133889961987734, -0.01068201009184122, 0.00770635437220335, 0.01214674487709999, 0.01537312101572752, 0.04985377937555313, -0.018065067008137703, -0.016376003623008728, -0.025586679577827454, 0.026734715327620506, 0.04423236474394798, 0.02314545400440693, -0.011849839240312576, 0.020691033452749252, 0.0046152351424098015, 0.02398998662829399, -0.011632108129560947, 0.025085238739848137, -0.018394961953163147, 0.013987560756504536, -0.028529345989227295, -0.010378506034612656, -0.014528589323163033, -0.002743079559877515, 0.0036717348266392946, 0.03599817678332329, -0.024715756997466087, 0.014489001594483852, 0.026853477582335472, -0.020334746688604355, 0.003998331259936094, -0.0082737747579813, 0.0009616448078304529, 0.006683678831905127, 0.02895161136984825, 0.008491504937410355, 0.021482782438397408, 0.016956618055701256, 0.04301834851503372, -0.02850295417010784, -0.016943423077464104, -0.00928985234349966, 0.010576443746685982, 0.0274472888559103, -0.006083269603550434, -0.03842620551586151, -0.034704986959695816, 0.007435840088874102, -0.004183072596788406, -0.03869011998176575, -0.041223715990781784, 0.03779280558228493, -0.002068443689495325, 0.00532121118158102, 0.006934399250894785, 0.03583982586860657, 0.017801150679588318, 0.013215606100857258, -0.027051415294408798, -0.013684057630598545, -0.01488487608730793, 0.01757682114839554, -0.004869254771620035, -0.023501742631196976, -0.04180433228611946, -0.042886391282081604, -0.008676246739923954, 0.025837400928139687, -0.009151295758783817, 0.018065067008137703, -0.0006490690284408629, -0.006195433903485537, -0.005987599957734346, -0.010305928997695446, -0.0013954571913927794, 0.005053996108472347, 0.011401182040572166, 0.019265886396169662, 0.03723858296871185, 0.03335901349782944, -0.008214393630623817, 0.031326860189437866, -0.01082056574523449, 0.020506292581558228, 0.013881994411349297, -0.007897693663835526, 7.731921505182981e-05, -0.03264643996953964, -0.005776466801762581, -0.04407401382923126, 0.012034581042826176, 0.0032659636344760656, -0.004321628715842962, 0.0031175105832517147, 0.014172302559018135]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"
t =η(ft−1(x)−y)∥x∥2,
δ2scaled
t =η(aT
t−1x)2(ft−1(x)−y)∥at−1∥−2, δ3scaled
t =
η2(ft−1(x)−y)2b−1
t−1∥at−1∥−2(aT
t−1x)∥x∥2as scaled ver-
sion of δ1
t, δ2
t, δ3
t.For stable feature learning, we thus have
the below modified linear constraints


c+ 1 = 0 ( forδ1scaled
t = Θ(1)) ,
c+ 2γ[aT
t−1x]−γ[∥at−1∥2] = 0 ( forδ1scaled
t = Θ(1)) ,
γ[bt−1] +γ[aT
t−1x] = 0 ( forft−1(x) = Θ(1)) ,
from which we can derive c=−1.With η= Θ( n−1),we
getγ[b1] =γ[b0] = 0 andγ[aT
1x] =γ[ηb−1
0y∥x∥2] = 0 .
One can recursively derive bt, aT
tx, δscaled
1, δscaled
2, δscaled
3∈
Θ(1) for all t, which preserves ft∈Θ(1) and∆ft∈Θ(1) ,
i.e., stability is achieved.
The above toy example illustrates that our preconditioned
LoRA updates achieve stable feature learning with learning
rates for AandBof same order of magnitude, while for un-
preconditioned LoRA, different learning rates are required
to obtain the same stability. Nevertheless, the toy example
is limited to linear model with LoRA rank r= 1and also
gradient updates without a momentum term. Indeed, the
stability persists for arbitrary LoRA ranks and for the Adam
optimizer when aided with our preconditioner (1), which
we formalize as our theorem below.
Theorem 4.1. [Stable Feature Learning (Informal)] Assume
LoRA parameters AandBare trained with Adam scaled
by our preconditioner as in (1). Further assume that BAx
has dimension Θ(n).Then the LoRA model achieves stable
feature learning with η= Θ(1) .While for unscaled Adam,
ηA= Θ( n−1)andηB= Θ(1) are required for stable
feature learning.
Note here we require η= Θ(1) instead of η= Θ( n−1)as
in the toy example, this discrepancy is due to our assumption
about vector output and Adam optimizer’s gradient process-
ing. See Section A for the detailed statement and the proofof Theorem 4.1 as well as an explanation of this difference.
Theorem 1 in (Hayou et al., 2024) shows that ηA= Θ( n−1)
andηB= Θ(1) are required for LoRA training with unpre-
conditioned Adam to obtain stability, revealing that without
preconditioning we need to tune ηAandηBseparately while
our preconditioner elegantly fixes this imbalance between
the learning rates.
5. A Riemannian Metric Formulation
After discussing the motivation and superiority for stabiliz-
ing feature learning of our proposed preconditioner in prior
sections, we now review how the proposed preconditioner
is derived from a new Riemannian metric. Optimization
over matrix with rank constraint is a common example for
optimization over Riemannian submanifolds. Specifically,
matrices with fixed rank form a quotient manifold of general
matrix field. Let Mdenote any Riemannian submanifold,
then Riemannian gradient descent usually takes form
Xt+1=R(Xt−η∇Mrf(Xt)),
whereRis a retraction operator that maps to M. Here, fis
the objective function and ∇Mrf(Xt)denotes Riemannian
gradient defined by
Df(x)[ηx] =gx(∇Mrf(x), ηx)for all ηx∈TxM,
where Df(x)[ηx]is the conventional Euclidean directional
derivative of fin the direction ηx.","[0.03306199610233307, 0.01087958738207817, 0.007991641759872437, -0.005679418332874775, -0.012217751704156399, 0.0035072353202849627, 0.008651387877762318, 0.011701158247888088, -0.03662213310599327, 0.050364769995212555, -0.013730188831686974, -0.01061817817389965, -0.04314490780234337, -0.006609909236431122, 0.0494685135781765, -0.004562206566333771, 0.054173871874809265, -0.021522661671042442, -0.01466379128396511, 0.0741405263543129, 0.05651410296559334, -0.04023206606507301, 0.03816569223999977, 0.02653922140598297, 0.031194789335131645, -0.008215706795454025, 0.03781714662909508, 0.008240602910518646, 0.04847266897559166, -0.0048111677169799805, 0.033460333943367004, -0.011558005586266518, -0.03415742143988609, -0.04142707958817482, 0.017601529136300087, -0.007331895641982555, 0.0013700624695047736, 0.017265431582927704, -0.008744748309254646, 0.03542712330818176, -0.0032396025490015745, -0.030696867033839226, -0.09161757677793503, 0.011558005586266518, -0.012572520412504673, 0.013319402933120728, 0.015348433516919613, 0.023103563115000725, 0.022120168432593346, 0.024037165567278862, -0.04018227383494377, 0.035750772804021835, -0.015696978196501732, -0.029377374798059464, -0.01689198985695839, 0.003261386649683118, 0.04894569516181946, 0.0011109876213595271, 0.03149354085326195, -0.01361815631389618, 0.0280578825622797, -0.03129437193274498, 0.016792407259345055, -0.021012291312217712, -0.028381532058119774, -0.028954142704606056, -0.061742279678583145, 0.005698090419173241, -0.019082846119999886, 0.014788271859288216, -0.026165781542658806, -0.039510078728199005, 0.07608242332935333, -0.00847711507230997, -0.017277879640460014, -0.011197011917829514, 0.014452175237238407, 0.07448907196521759, 0.04814901947975159, 0.01638162136077881, 0.019369151443243027, -0.017862938344478607, 0.07209905236959457, -0.008682508021593094, -0.004596438724547625, -0.05253073200583458, -0.013057994656264782, -0.04082957282662392, -0.01273434516042471, -0.008427323773503304, -0.004372374154627323, -0.0014945428119972348, -0.014053837396204472, 0.03189187869429588, 0.02957654371857643, 0.009167981334030628, 0.03034832328557968, -0.0070953830145299435, 0.028904350474476814, 0.01969279907643795, 0.004842287860810757, -0.027609754353761673, 0.05093738064169884, -0.02673839032649994, 0.04668015241622925, -0.03477982431650162, 0.0066783735528588295, 0.017252983525395393, -0.015472914092242718, 0.012740569189190865, -0.0011436636559665203, 0.030248738825321198, -0.017016470432281494, 0.00776135316118598, 0.004521750845015049, -0.08409895747900009, -0.057709116488695145, 0.01969279907643795, -0.05228177085518837, -0.005835019052028656, -0.014352590776979923, -0.01594593934714794, -0.013767533004283905, 0.006052859593182802, 0.028680285438895226, -0.05046435445547104, 0.041551560163497925, -0.05178384855389595, -0.007431480102241039, -0.016219796612858772, 0.035501811653375626, 0.043841999024152756, 0.016282036900520325, -0.03766776993870735, -0.03908684849739075, 0.020912708714604378, 0.048895902931690216, 0.028157467022538185, 0.030398115515708923, -0.015099473297595978, -0.024684464558959007, -0.012118167243897915, -0.013344299048185349, 0.006479205098003149, -0.020862916484475136, 0.034705135971307755, -0.014862960204482079, 0.005004112143069506, -0.010163825005292892, 0.0026654365938156843, 0.0043941582553088665, 0.01526129711419344, -0.04376731067895889, 0.020912708714604378, -0.023066218942403793, -0.016979126259684563, -0.006802854128181934, 0.006591237150132656, 0.03537733107805252, -0.0019932424183934927, 0.015385777689516544, 0.0632360428571701, 0.04366772621870041, -0.018995709717273712, 0.06004934757947922, 0.02499566599726677, -0.029402270913124084, 0.001638473360799253, -0.031393956393003464, -0.0666717067360878, 0.02653922140598297, -0.02475915290415287, -0.0539747029542923, -0.04618223011493683, 0.06443105638027191, -0.00396781275048852, -0.018311066552996635, -0.023302732035517693, 0.03403294086456299, -0.018311066552996635, -0.0021146107465028763, 0.015746770426630974, -0.019406495615839958, 0.06741859018802643, -0.03189187869429588, 0.07732722908258438, -0.06059706211090088, -0.027086935937404633, 0.027460377663373947, 0.046356502920389175, -0.0007861715275794268, 0.03619890287518501, 0.04720297083258629, 0.014813167974352837, 0.009273789823055267, -0.04921955242753029, 0.04048102721571922, 0.03209104761481285, -0.014676239341497421, 0.03052259422838688, -0.018871229141950607, -0.005903483368456364, -0.015348433516919613, -0.006815302185714245, -0.009099517948925495, 0.007655544672161341, -0.00744392815977335, 0.029227998107671738, -0.02554337866604328, -0.005467801820486784, -0.0009942871984094381, 0.003983372822403908, 0.017813146114349365, 0.015037233009934425, -0.04010758548974991, 0.02830684371292591, -0.046331606805324554, 0.0393855981528759, -0.022530952468514442, 0.03552670776844025, 0.002249983372166753, -0.0026218683924525976, 0.021124323830008507, 0.031717605888843536, -0.038016315549612045, -0.0025036120787262917, 0.024920977652072906, -0.017215639352798462, 0.04466356709599495, -0.037742458283901215, 0.04924444854259491, 0.0037095160223543644, -0.01363060437142849, -0.03639807179570198, 0.049119967967271805, -0.05103696510195732, -0.046580567955970764, -0.07344343513250351, 0.011558005586266518, -0.01846044324338436, -0.021908551454544067, 0.023663723841309547, -0.034680239856243134, -0.021124323830008507, 0.007213639561086893, 0.031120100989937782, 0.008203258737921715, 0.029103517532348633, 0.017028918489813805, 0.0241989903151989, -0.022804809734225273, -0.030622178688645363, -0.0076493206433951855, -0.04165114462375641, -0.050912484526634216, 0.03759308159351349, -0.015199057757854462, -0.00403316505253315, -0.010095360688865185, 0.0009623891091905534, -0.02932758256793022, -0.0017240536399185658, 0.004730255343019962, 0.018485339358448982, 0.018286170437932014, 0.002726120874285698, -0.02020316943526268, -0.005614066030830145, 0.022157512605190277, 0.015360881574451923, 0.025319313630461693, 0.01868450827896595, -0.09012380987405777, 0.012740569189190865, -0.013194922357797623, -0.005626514088362455, 0.06104518845677376, 0.061194565147161484, -0.038514237850904465, 0.005856803152710199, 0.01694178208708763, 0.0018780981190502644, 0.09286238253116608, -0.009199101477861404, 0.005841243080794811, -0.026688598096370697, -0.0018174138385802507, 0.0011288817040622234, -0.030398115515708923, -0.01893346942961216, 0.02950185537338257, -0.003124458249658346, 0.04929424077272415, 0.016568342223763466, 0.00442839041352272, -0.003473003162071109, -0.00037908172816969454, -0.04872163012623787, -0.0007624424761161208, 0.012404472567141056, 0.024634672328829765, 0.019891967996954918, -0.002063262742012739, 0.0004745815531350672, -0.052680108696222305, 0.01668037474155426, 0.04170093685388565, -0.014116077683866024, 0.022132616490125656, 0.022817257791757584, -0.0020119145046919584, 0.04892079904675484, 0.0146513432264328, 0.060497477650642395, -0.04065530002117157, -0.024547535926103592, 0.034207213670015335, -0.019580768421292305, -0.004313245881348848, 0.032937515527009964, -0.026887767016887665, -0.03435659036040306, 0.00605597160756588, 0.0026887767016887665, 0.03838975727558136, -0.006224020384252071, -0.043020427227020264, 0.020564163103699684, -0.0328628271818161, -0.02373841218650341, 0.009261341765522957, 4.279013955965638e-05, 0.01842309907078743, 0.007288327440619469, -0.026638805866241455, 0.02551848255097866, -0.014327694661915302, 0.05676306411623955, 0.019344255328178406, 0.02828194759786129, -0.05760953202843666, -0.04172583296895027, -0.014389934949576855, 0.019057950004935265, -0.013979149051010609, -0.010157600976526737, -0.022120168432593346, -0.0016151332529261708, 0.01793762668967247, 0.01970524713397026, -0.026215573772788048, -0.01745215244591236, 0.05686264857649803, 0.007114055100828409, -0.022394023835659027, 0.014613999053835869, -0.014489519409835339, -0.06602440774440765, -0.04578389227390289, -0.012392024509608746, -0.02274256944656372, -0.011844309978187084, 0.003292506793513894, 0.01666792668402195, -0.03654744476079941, 0.028132570907473564, 0.013418987393379211, 0.035476915538311005, 0.01429035048931837, -0.002089714864268899, 0.009317358024418354, 0.02221975289285183, -0.027958298102021217, -0.013580812141299248, -0.021833863109350204, -0.010717762634158134, 0.037742458283901215, 0.023402316495776176, 0.03004956990480423, 0.011670038104057312, 0.019630558788776398, 0.004353702068328857, 0.007219863589853048, -0.022929290309548378, 0.012441816739737988, 0.022381575778126717, 0.02224464900791645, -0.03816569223999977, -0.06253895163536072, -0.01223019976168871, 0.04244781658053398, -0.012535176239907742, -0.0003477671416476369, 0.02351434901356697, -0.028132570907473564, 0.013033098541200161, -0.03585035726428032, 0.023340076208114624, 0.04907017573714256, 0.030746659263968468, -0.02855580486357212, -0.020252961665391922, -0.06328583508729935, -0.03958476707339287, 0.0048516239039599895, 0.011601573787629604, 0.019792383536696434, 0.07160113006830215, -0.000510369660332799, 0.042298439890146255, -0.0020290305837988853, -0.04135239124298096, 0.01517416164278984, -0.02294173836708069, 0.021012291312217712, 0.033759087324142456, 0.01614510826766491, 0.041327495127916336, 0.026862870901823044, 0.06383354961872101, -0.019580768421292305, -0.0025129481218755245, -0.014701135456562042, 0.010076688602566719, -0.026638805866241455, 0.008296619169414043, -0.01211194321513176, -0.021833863109350204, -0.0423482321202755, -0.02221975289285183, 0.01717829518020153, 0.031941670924425125, -0.010636850260198116, -0.009977104142308235, -0.056962233036756516, -0.005909707397222519, 0.01187543012201786, 0.01173850242048502, 0.0214728694409132, -0.04680463299155235, 0.028182363137602806, 0.010786226950585842, -0.029352478682994843, -0.008906573057174683, 0.007201191503554583, 0.047601304948329926, -0.03729432821273804, 0.012504056096076965, -0.014165869913995266, -0.031219685450196266, -0.027933401986956596, 0.03789183497428894, 0.05865516513586044, -0.022555848583579063, 0.03077155537903309, -0.06652233004570007, 0.0555182583630085, 0.014116077683866024, 0.024920977652072906, 0.024136750027537346, -0.016879543662071228, -0.014377486892044544, -0.017850490286946297, -0.05482117086648941, -0.008601595647633076, 0.013543467968702316, 0.04548513889312744, -0.027933401986956596, -0.008744748309254646, -0.03263876214623451, -0.00037713671918027103, -0.04951830580830574, 0.021584901958703995, -0.0353524349629879, -0.03390846028923988, 0.054422833025455475, -0.022132616490125656, -0.04600795730948448, 0.012547624297440052, 0.019854623824357986, 0.04625691846013069, -0.01491275243461132, -0.010213617235422134, -0.011234356090426445, 0.011321492493152618, 0.08882921934127808, 0.043294284492731094, 0.010730210691690445, 0.006208460312336683, 0.0038246603216975927, -0.004593326710164547, -0.029701024293899536, 0.02524462528526783, -0.012883721850812435, -0.00784226506948471, -0.0342819020152092, -0.019630558788776398, -0.019593214616179466, -0.006877542473375797, 0.0015630070120096207, 0.028929246589541435, 0.024348367005586624, -0.009641007520258427, 0.02800809033215046, 0.02221975289285183, 0.009273789823055267, 0.047352343797683716, 0.010082912631332874, 0.002256207400932908, 0.02957654371857643, -0.011900326237082481, 0.05487096309661865, -0.02326538786292076, 0.02646453306078911, 0.003135350067168474, 0.025867028161883354, -0.010263409465551376, 0.004776935558766127, -0.036024630069732666, 0.024410607293248177, 0.022618088871240616, 4.947609795635799e-06, -0.03846444562077522, -0.024672016501426697, 0.029452063143253326, 0.002726120874285698, -0.03104541264474392, -0.05716140195727348, -0.013406539335846901, -0.0008666947833262384, -0.00042128836503252387, -0.008520683273673058, -0.018248826265335083, 0.02016582526266575, -0.009485406801104546, -0.00012195189628982916, -0.0085704755038023, -0.02221975289285183, -0.02673839032649994, 0.009603663347661495, 0.00712650315836072, -0.020377442240715027, 0.019344255328178406, 0.03435659036040306, 0.0189832616597414, -0.024696912616491318, -0.0004703025333583355, -0.012809033505618572, 0.018248826265335083, 0.044115856289863586, 0.03405783697962761, -0.01889612525701523, -0.009858847595751286, -0.003905572695657611, -0.017053814604878426, 0.008147242479026318, -0.018286170437932014, 0.022182408720254898, 0.02599150873720646, 0.053924910724163055, -0.03004956990480423, 0.004359926097095013, -0.024037165567278862, -0.006043523550033569, -0.03184208646416664, 0.0485224612057209, -0.008041433990001678, -0.020576611161231995, -0.0019621222745627165, -0.0016353613464161754, 0.003102674148976803, 0.0021690709982067347, 0.012068375013768673, -0.02957654371857643, 0.039534974843263626, -0.006323604378849268, 0.05327761173248291, -0.01645630970597267, 0.040256962180137634, 0.02858070097863674, -0.021136771887540817, -0.02706203982234001, -0.02451019175350666, -0.024908529594540596, -0.0393855981528759, -0.009995776228606701, -0.013219818472862244, 0.014116077683866024, -0.002609420567750931, 0.009721919894218445, 0.018062107264995575, -0.017028918489813805, -0.0037157400511205196, -0.01122813206166029, -0.026190677657723427, -0.03007446601986885, -0.04722786694765091, 0.013331850990653038, 0.0009499411098659039, 0.010014448314905167, 0.01425300631672144, 0.014041389338672161, 0.03316158056259155, -0.01765132136642933, 0.0005885589052923024, 0.0024367040023207664, -0.018236380070447922, 0.019755039364099503, 0.01822393201291561, -0.03211594372987747, -0.024161646142601967, -0.001672705402597785, 0.01997910439968109, 0.003370306920260191, -0.010780002921819687, -0.03184208646416664, 0.019755039364099503, -0.03007446601986885, 0.06373396515846252, -0.000457854475826025, 0.013929356820881367, -0.022369127720594406, 0.020912708714604378, 0.014539310708642006, -0.0011078756069764495, 0.01741480827331543, -0.014788271859288216, -0.056912440806627274, 0.008421099744737148, -0.006096427794545889, -0.027360793203115463, -0.023053770884871483, 0.010431458242237568, 0.02274256944656372, -0.01643141359090805, 0.007319447584450245, 0.010761330835521221, -0.036273591220378876, 0.020813124254345894, -0.03455575928092003, 0.036970678716897964, 0.016530998051166534, -0.00468046311289072, -0.00896258931607008, 0.03560139611363411, -0.013132683001458645, -0.004204325843602419, 0.01695423014461994, -0.03154333308339119, -0.016755063086748123, -0.024696912616491318, -0.018510235473513603, 0.021099427714943886, 0.009914863854646683, 0.013767533004283905, 0.011190787889063358, 0.02016582526266575, 0.0006620801286771894, 0.028431324288249016, 0.0038371083792299032, -0.017215639352798462, -0.02453508786857128, 0.009037277661263943, 0.02858070097863674, 0.004185653757303953, 0.008657611906528473, 0.020638851448893547, 0.028979038819670677, 7.930763240437955e-05, -0.011614021845161915, 0.03410762920975685, -0.004661791026592255, -0.007425256073474884, -0.016966678202152252, -0.008601595647633076, -0.05352657288312912, -0.02778402529656887, -0.03151843696832657, -0.031941670924425125, 0.02045213058590889, -0.02195834368467331, 0.010804899036884308, -0.02631515823304653, -0.03729432821273804, -0.02950185537338257, -0.019145086407661438, -0.014564206823706627, -0.001517882919870317, -0.022879498079419136, -0.01020739320665598, -0.005638962145894766, -0.01995420828461647, 0.03913664072751999, -0.010157600976526737, -0.006460533011704683, 0.009933535940945148, -0.04879631847143173, 0.016369173303246498, 0.04239802435040474, 0.0010930935386568308, 0.004447062499821186, 0.02294173836708069, -0.034182317554950714, -0.012466712854802608, -0.04361793398857117, -0.03480472043156624, 0.011022740043699741, 0.026837974786758423, 0.0718998834490776, -0.005638962145894766, -0.02371351607143879, -0.021385733038187027, -0.001932558254338801, 0.004403494298458099, -0.03224042430520058, -0.0036410517059266567, 0.06682108342647552, 0.031966567039489746, 0.002542512258514762, -0.005813234951347113, -0.018012315034866333, -0.021672038361430168, -0.02855580486357212, 0.0055051459930837154, 0.022418919950723648, -0.013145131058990955, -0.05123613402247429, 0.019842175766825676, -0.01689198985695839, 0.008670059964060783, 0.018298618495464325, 0.024908529594540596, 0.03189187869429588, 0.034705135971307755, 0.006161780096590519, 0.00960988737642765, -0.0007235423545353115, -0.010674194432795048, -0.0023682396858930588, -0.0010005112271755934, -0.03888767957687378, -0.015223952941596508, -0.040057793259620667, 0.0202280655503273, 0.04321959614753723, 0.022879498079419136, 0.02624046988785267, 0.01429035048931837, 0.027435481548309326, 0.030597282573580742, -0.034954097121953964, 0.009510302916169167, 0.011589125730097294, 0.005393113475292921, 0.014589102938771248, -0.009441838599741459, -0.0039771487936377525, 0.011657590046525002, -0.03779225051403046, -0.010730210691690445, 0.0008682507905177772, 0.01122813206166029, -0.0016166892601177096, 0.004960543941706419, -0.005729210563004017, 0.02601640485227108, 0.012697000987827778, -0.009485406801104546, 0.039061952382326126, -0.008738524280488491, 0.004640006925910711, 0.006392068695276976, 0.00516904890537262, 0.021311044692993164, 0.03463044762611389, 0.02347700484097004, 0.019991552457213402, -0.03619890287518501, -0.004658679012209177, -0.012933514080941677, -0.03530264273285866, -0.0006694711628369987, 0.014713583514094353, 0.010948051698505878, -0.008265499025583267, -0.003637939691543579, -0.005470913834869862, -0.02421143837273121, 0.02226954512298107, -0.02042723447084427, -0.02198323979973793, 0.0029315135907381773, 0.018821436911821365, 0.006684597581624985, 0.021572453901171684, 0.05596638843417168, -0.028630493208765984, -0.0616924874484539, -0.0032240424770861864, -0.0161326602101326, -0.003796652425080538, 0.03634827956557274, 0.006827750243246555, 0.013605708256363869, -0.01302065048366785, 0.010817347094416618, -0.003737524151802063, -0.017016470432281494, -0.00632049236446619, -0.011414852924644947, 0.013145131058990955, 0.028655389323830605, -0.029626335948705673, -0.028132570907473564, -0.008489563129842281, 0.02122390829026699, 0.02345210872590542, -0.026389844715595245, -0.018485339358448982, 0.002976637566462159, 0.010481249541044235, -0.03077155537903309, -0.016282036900520325, 0.0322653204202652, -0.010095360688865185, -0.0037157400511205196, 0.03201635926961899, 0.014128525741398335, -0.024896081537008286, 0.028879454359412193, 0.06238957867026329, -0.0362984873354435, -0.006927334237843752, 0.010045568458735943, 0.0030980061274021864, 0.011545557528734207, 0.05066352337598801, 0.01918243058025837, -0.05108675733208656, 0.03455575928092003, -0.008813212625682354, 0.018510235473513603, -0.032414697110652924, 0.06497877091169357, -0.04702869802713394, 0.0003160635242238641, -0.019257118925452232, 0.012336008250713348, 0.02045213058590889, -0.01490030437707901, -0.007344343699514866, -0.014327694661915302, -0.037468601018190384, -0.036970678716897964, -0.011209459975361824, -0.03540222719311714, 0.0033734189346432686, 0.0013062662910670042, 0.006090203765779734, 0.006684597581624985, 0.003376530949026346, -0.03390846028923988, -0.015460466034710407, 0.02020316943526268, 0.015360881574451923, -0.020302753895521164, -0.02631515823304653, 0.012068375013768673, 0.00523440120741725, -0.019082846119999886, 0.02224464900791645, -0.012659656815230846, -0.008676283992826939, -0.014352590776979923, 0.0017380575882270932, -0.03786693885922432, 0.010524817742407322, 0.03435659036040306, -0.023551693186163902, 0.039236221462488174, 0.020663747563958168, 0.0050632404163479805, 0.02775912918150425, -0.0037561962381005287, -0.03129437193274498, -0.015970835462212563, -0.0146513432264328, 0.059451840817928314, -0.004854735918343067, 0.033958252519369125, -0.015248849056661129, 0.007425256073474884, -0.02097494713962078, -0.022145064547657967, 0.01996665634214878, 0.02423633448779583, 0.02198323979973793, 0.0094916308298707, 0.03811590000987053, 0.004562206566333771, 0.005411785561591387, -0.011084980331361294, -0.013817325234413147, 0.027435481548309326, -0.005744770634919405, 0.04979216307401657, -0.029949985444545746, 0.034481070935726166, -0.03965945541858673, -0.01148954126983881, 0.018037211149930954, -0.004577766638249159, 0.0317922942340374, 0.012049702927470207, 0.05785849317908287, 0.041875209659338, 0.006827750243246555, 0.02345210872590542, -0.011421076953411102, 0.003949140664190054, 0.0015093248803168535, -0.0026576565578579903, -0.020277857780456543, 0.008153466507792473, 0.017987418919801712, -0.023775756359100342, -0.012192855589091778, 0.015087025240063667, 0.029701024293899536, -0.00758708082139492, 0.033958252519369125, 0.007344343699514866, 0.025817235931754112, 0.028854558244347572, -0.0016991575248539448, -0.007873385213315487, -0.010082912631332874, 0.0001656172826187685, 0.028879454359412193, 0.034232109785079956, 0.01919487863779068, -0.011396180838346481, 0.02653922140598297, -0.04222375154495239, -0.024323470890522003, 3.211691728211008e-05, 0.032414697110652924, 0.06179207190871239, 0.0001827333471737802, 0.0048516239039599895, 0.01889612525701523, 0.009273789823055267, 0.04824860394001007, 0.0495929941534996, -0.015323537401854992, -0.010848467238247395, 0.018833884969353676, 0.014999888837337494, 0.02320314757525921, -0.002724564867094159, -0.03993331268429756, 0.008558027446269989, -0.01765132136642933, -0.03403294086456299, -0.0169044379144907, 0.005825683008879423, -0.00041973235784098506, -0.019257118925452232, -0.09714450687170029, 0.007132727187126875, 0.022891946136951447, 0.010412786155939102, -0.0019496743334457278, 0.004935647826641798, 0.015821458771824837, -0.0035601395647972822, 0.01273434516042471, 0.02399982139468193, 0.015248849056661129, -0.015423121862113476, -0.010960499756038189, 0.003178918268531561, -0.00548647390678525, -0.021062083542346954, -0.02144797332584858, -0.005539378151297569, 0.05352657288312912, 0.018858781084418297, 0.009248893707990646, -0.0006601351196877658, 0.01738991215825081, 0.03617400676012039, 0.007406583987176418, 0.0018314179033041, 0.023364972323179245, 0.012192855589091778, -0.056464310735464096, -0.052431147545576096, 0.0530286505818367, -0.019319359213113785, -0.006429412867873907, -0.045808788388967514, 0.019145086407661438, 0.004198101814836264, -0.04668015241622925, 0.01618245244026184, 0.025356657803058624, 0.009765488095581532, 0.015809010714292526, 0.004885856062173843, 0.010506145656108856, 0.030622178688645363, -0.009472958743572235, 0.022020583972334862, -0.011701158247888088, 0.004272789694368839, 0.006441860925406218, -0.026837974786758423, -0.0342819020152092, -0.004599550738930702, 0.014116077683866024, -0.0031229022424668074, 0.020887812599539757, 0.037493497133255005, 0.018796540796756744, 0.005726098548620939, 0.02219485677778721, -0.015099473297595978, 0.04314490780234337, -0.01738991215825081, 0.00885678082704544, -0.025568274781107903, -0.006301820278167725, 0.000827794661745429, -0.0016260253032669425, -0.0024195879232138395, 0.013742636889219284, 0.011458421126008034, -0.009659679606556892, -0.008371307514607906, -0.015410673804581165, 0.0009328250307589769, 0.008253050968050957, 0.02571765147149563, 0.0676177516579628, -0.020850468426942825, 0.007798697333782911, -0.01867206022143364, 0.03527774661779404, 0.022891946136951447, -0.007481272332370281, -0.014091181568801403, 0.011545557528734207, 0.015746770426630974, 0.02447284758090973, 0.038812991231679916, -0.0010456354357302189, -0.032713450491428375, 0.012429368682205677, 0.022655433043837547, 0.0014501967234537005, -0.00908084586262703, -0.043344076722860336, 0.018759196624159813, 0.03032342717051506, 0.004114077426493168, 0.028655389323830605, -0.0014883187832310796, 0.001142885652370751, 0.0006815302185714245, 0.02646453306078911, 0.009977104142308235, 0.012466712854802608, 0.05805766209959984, 0.004527974873781204, 0.047103386372327805, -0.009136861190199852, -0.008931469172239304, -0.05835641175508499, 0.0044439504854381084, -0.025306865572929382, 0.012715673074126244, -0.015348433516919613, 0.04974237084388733, 0.0015155489090830088, 0.021609798073768616, 0.06353479623794556, -0.017078710719943047, 0.02855580486357212, -0.01299575436860323, -0.012933514080941677, 0.07802432030439377, -0.042298439890146255, -0.02528196945786476, 0.011757174506783485, 0.012821481563150883, -0.005492697935551405, 0.02698735147714615, -0.0014284126227721572, -0.002165958983823657, -0.008782092481851578, 0.008047658018767834, 0.026414740830659866, -0.01768866553902626, -0.019506080076098442, -0.029850400984287262, -0.03734412044286728, -0.004755151458084583, -0.013879564590752125, -0.011707382276654243, 0.05096227675676346, 0.006423188839107752, 0.0067032696679234505, -0.031219685450196266, 0.01274679321795702, 0.007518616504967213, -0.022319335490465164, 0.026115989312529564, 0.011109876446425915, 0.007170071359723806, 0.018074555322527885, -0.022518504410982132, -0.033510126173496246, -0.05123613402247429, -0.015759218484163284, -0.020763332024216652, 0.03502878546714783, -0.02631515823304653, 0.021659590303897858, -0.00936092622578144, -0.022792361676692963, -0.00038180474075488746, 0.015460466034710407, -0.024572432041168213, -0.014203214086592197, -0.017788249999284744, -8.66500340634957e-05, 0.020564163103699684, 0.0033827549777925014, 0.009392046369612217, -0.023389868438243866, -0.036024630069732666, 0.022842153906822205, -0.018248826265335083, 0.003513459349051118, -0.00832773931324482, -0.015809010714292526, 0.06328583508729935, 0.0023200034629553556, 0.005427345633506775, 0.014962544664740562, 0.0015155489090830088, 0.008906573057174683, -0.007848489098250866, -0.029227998107671738, -0.04374241456389427, 0.0009141529444605112, 0.003588147694244981, 0.04396647959947586, -0.005268632899969816, 0.00834018737077713, 0.015497810207307339, 0.010680418461561203, -0.046082645654678345, 0.008688732050359249, 0.004804943688213825, 0.04399137571454048, 0.012423144653439522, -0.03555160388350487, -0.00763064855709672, -0.025568274781107903, 0.006049747578799725, 0.027410585433244705, -0.00712650315836072, 0.016767511144280434, 0.011595349758863449, 0.007506168447434902, -0.012740569189190865, -0.026414740830659866, -0.00794807355850935, 0.011601573787629604, -0.018012315034866333, 0.043891791254282, 0.016294484958052635, -0.007711560931056738, 0.00021258919150568545, -0.004378598183393478, 0.026887767016887665, -0.0017878498183563352, -0.04219885542988777, 0.009074621833860874, -0.02678818255662918, 0.01552270632237196, -0.003513459349051118, 0.013344299048185349, -0.00379354041069746, 0.01466379128396511, 0.021373284980654716, 0.022107720375061035, 0.040530819445848465, -0.007879609242081642, 0.0054553537629544735, 0.0026249804068356752, 0.009242669679224491, 0.040754884481430054, 0.0017754017608240247, -0.01010158471763134, -0.03032342717051506, 0.016755063086748123, -0.04100384563207626, 0.02348945289850235, -0.017004022374749184, -0.00029525195714086294, 0.015833906829357147, 0.007524840533733368, -0.03741880878806114, 0.014701135456562042, -0.007182519417256117, -0.028107674792408943, -0.010138928890228271, -0.0322653204202652, -0.0021286148112267256, 0.003376530949026346, -0.0061244359239935875, 0.016506101936101913, -0.002886389382183552, -0.0019434503046795726, -0.011514437384903431, 0.007854713127017021, -0.02830684371292591, 0.007064262870699167, -0.010014448314905167, -6.175394810270518e-05, 0.012560072354972363, -0.007780025247484446, -0.01971769519150257, 0.011645141988992691, -0.018124347552657127, 0.04194989427924156, 0.026364948600530624, -0.014240558259189129, 0.0056420741602778435, -0.0089874854311347, -0.003890012623742223, 0.011259252205491066, 0.006528997328132391, 0.02250605635344982, 0.004839175846427679, 0.018298618495464325, 0.0260413009673357, 0.0025969725102186203, -0.03639807179570198, 0.008564251475036144, -0.026887767016887665, -0.012062150985002518, 0.01021984126418829, -0.007941849529743195, 0.013680396601557732, -0.022580744698643684, 0.017825594171881676, 0.0183857548981905, 0.002783693140372634, -0.006578789558261633, -0.004204325843602419, 0.062489163130521774, -0.0006527441437356174, -0.02980060875415802, 0.00909329392015934, -0.02197079174220562, -0.002774357097223401, 0.006364060565829277, -0.02473425678908825, -0.010823571123182774, -0.002716784831136465, 0.009460510686039925, 0.0022033031564205885, 0.021883655339479446, -0.03204125538468361, 0.015584946610033512, 0.015236400999128819, 0.015199057757854462, -0.007811145391315222, 0.03009936213493347, 0.002156622940674424, -0.001873430097475648, -0.021622246131300926, -0.018622267991304398, 0.023800652474164963, -0.024958321824669838, -0.007356791757047176, 0.010381666012108326, 0.0038246603216975927, -0.007114055100828409, 0.010163825005292892, -0.013269610702991486, -0.014452175237238407, -0.017252983525395393, -0.025394001975655556, 0.022655433043837547, -0.03609931841492653, 0.04065530002117157, -0.004238557536154985, 0.007213639561086893, -0.01644386164844036, -0.014377486892044544, 0.02073843590915203, -0.004686687141656876, 0.0285309087485075, -0.012703225016593933, -0.0003864727623295039, 0.006535221356898546, 0.05048925057053566, -0.009889967739582062, 0.009124413132667542, -0.011041412129998207, -0.005698090419173241, -0.041850313544273376, -0.017215639352798462, 0.030174050480127335, 0.005109920632094145, 0.00041545333806425333, -0.030248738825321198, -0.024572432041168213, -0.023937581107020378, -0.009516526944935322, 0.0012852601939812303, 0.042572297155857086, -0.03841465339064598, 0.005240624770522118, 0.018323514610528946, -0.004375486169010401, -0.004941871855407953, -0.0158961471170187, 0.011788294650614262, -0.0003131460107397288, 0.008495787158608437, 0.006398292724043131, 0.018771644681692123, -0.032215528190135956, 0.022792361676692963, 0.0012401359854266047, 0.01098539587110281, 0.017501944676041603, 0.029352478682994843, -0.011352612636983395, 0.009641007520258427, -0.011066308245062828, 0.03687109425663948, -0.0136430524289608, 0.012566296383738518, 0.005698090419173241, 0.0017613976961001754, -0.0016229132888838649, 0.00015083524340298027, 0.030373219400644302, -0.005965723190456629, 0.01638162136077881, -0.0028070330154150724, -0.028207259252667427, 0.006280036177486181, 0.00429768580943346, -0.009889967739582062, 0.0016602573450654745, -1.422285890839703e-06, 0.002718340838328004, 0.009921087883412838, -0.029925089329481125, 0.015423121862113476, 0.01997910439968109, 0.004008268937468529, -0.006597461178898811, -0.024871185421943665, 0.0333358533680439, 0.032962411642074585, 0.011794518679380417, -0.0035570275504142046, 0.023589037358760834, -0.0041825417429208755, -0.026091093197464943, -0.005554938223212957, -0.00548647390678525, 0.00637339660897851, -0.016008179634809494, -0.004213661886751652, 0.00010464133811183274, -0.028082778677344322, -0.00870118010789156, 0.006964678410440683, -0.013219818472862244, 0.025394001975655556, -0.022655433043837547, 0.007692888844758272, 0.01643141359090805, 0.024634672328829765, -0.0022375353146344423, -0.026962455362081528, 0.0015326649881899357, -0.007941849529743195, -0.011757174506783485, 0.007593304850161076, -0.019306911155581474, 0.02773423306643963, -0.03965945541858673, -0.00398026080802083, -0.004039389081299305, 0.01567208208143711, 0.05447262525558472, 0.005800786893814802, -0.024833841249346733, 0.02398737333714962, -0.010518593713641167, 0.014875408262014389, 0.008010313846170902, -0.007194967474788427, 0.007941849529743195, 0.004157645627856255, -0.025842132046818733, -0.011022740043699741, 0.019530976191163063, 0.007636872585862875, -0.020265409722924232, -0.014576654881238937, 0.022356679663062096, 0.01122813206166029, 0.01792517863214016, 0.005831907037645578, -0.007275879383087158, -0.0009180429624393582, 0.02348945289850235, -0.021896103397011757, -0.011402404867112637, 0.023140907287597656, 0.018584923818707466, -0.01943139173090458, -0.023402316495776176, 0.0005975059466436505, 0.020128481090068817, -0.0027043367736041546, 0.025294417515397072, -0.021821415051817894, 0.005467801820486784, -0.01592104323208332, -0.008906573057174683, 0.0015591171104460955, -0.02902883104979992, 0.013755084946751595, 0.015398225747048855, -0.019879519939422607, -0.0016229132888838649, -0.019605662673711777, 0.014974992722272873, 0.036945782601833344, 0.03709515929222107, -0.012740569189190865, 0.015223952941596508, 0.00036935671232640743, 0.027410585433244705, 0.020651299506425858, 0.012149287387728691, -0.014215662144124508, 0.007058038841933012, -0.027211416512727737, 0.006510325241833925, -0.028381532058119774, 0.007854713127017021, 0.0020196945406496525, 0.02067619562149048, -0.001621357281692326, 0.002926845569163561, 0.006560117471963167, -0.02043968252837658, 0.0027914729434996843, 0.007468824274837971, 0.008919021114706993, -0.005349545273929834, 0.009043501690030098, 0.021161668002605438, 0.02124880440533161, 0.013854668475687504, 0.03704536706209183, -0.009809055365622044, -0.03786693885922432, 0.013593260198831558, 0.003026429796591401, 0.016730166971683502, 0.014377486892044544, -0.036497652530670166, -0.030647074803709984, 0.022381575778126717, -0.015323537401854992, -0.02601640485227108, -0.035501811653375626, 0.03224042430520058, -0.008141018450260162, 0.004210549872368574, 0.013705292716622353, 0.005287304986268282, 0.034705135971307755, 0.007748905103653669, -0.021858759224414825, -0.021597350016236305, -0.005903483368456364, 0.013867116533219814, 0.0005348767153918743, -0.028854558244347572, -0.03811590000987053, -0.019394047558307648, -0.01771356165409088, 0.0328628271818161, -0.026066197082400322, 0.02576744370162487, -0.016294484958052635, -0.011744726449251175, 0.014103629626333714, 0.010008224286139011, 0.0035508035216480494, 0.01361815631389618, 0.015348433516919613, -0.000714984314981848, 0.0016789294313639402, 0.022331783547997475, -0.05073821172118187, 0.020364994183182716, -0.02676328644156456, 0.03480472043156624, 0.025456242263317108, -0.004170093685388565, 0.011047636158764362, -0.006672149524092674, -0.012684552930295467, -0.036497652530670166, 0.0004465734527911991, 0.0003127570089418441, 0.013531019911170006, -0.011302820406854153, 0.008284171111881733]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" In this definition, gxis a
Riemannian metric which maps two elements in the tangent
space TxMto a real number and might not be unique, we
will see that the innovative design of gxis the key to derive
our preconditioned updates (1). Before proceeding to the
derivation of our preconditioner, we need one more piece of
knowledge about quotient manifold.
When it comes to a quotient space M/∼where each ele-
ment [x] ={y∈ M :y∼x}represents an equivalence
class, for low-rank matrix problems where ABTare consid-
ered, each (A, B)pair is equivalent to (AO, BO−1)for any
O∈GL(r)in the sense that they obtain the same objective
value, where GL(r)stands for the general linear group over
r×rinvertible matrices. Tangent space T[x]Mrespects
the equivalence relation ∼by the introduction of horizontal
and vertical spaces at each element, i.e., we decompose
TxM=Vx⊕ H xwhere Vxis the tangent space of the
equivalence class [x]andHxis its complement. Then each
η[x]∈T[x]Mcorresponds to a unique element in Hxwhich
is called the horizontal lift of x.A Riemannian metric for
M/∼satisfies
g[x](η[x], ξ[x]) =gx(ηx, ξx),
where ηxandξxare horizontal lifts of η[x]andξ[x]atx.
Thus a Riemannian metric on quotient space is invariant
along equivalence classes of the quotient space.
4
Riemannian Preconditioned LoRA
Algorithm 1 Pseudocode of scaled AdamW in PyTorch.
# group trainable parameters into LoRA pairs in train.py.
for LoRA A, LoRA B in pairwise(trainable parameter):
param groups.append( {""params"": [LoRA A,LoRA B], ""lr"": learning rate})
# apply preconditioner in optimizer.py
for group in param_groups:
A, B = group[""params""]
dA, dB = group[""params""].grad
# update parameter A
dAscaled =inverse(B.T@B+delta *torch.eye(r)).mm(dA) # precondition gradient of A
A_m = beta1 *A_m+(1-beta1) *dA_scaled; A_m_hat = A_m/(1-beta1 **t) # update first momentum of A
A_v = beta2 *A_v+(1-beta2) *dA_scaled **2; A_v_hat = A_v/(1-beta2 **self.t) # update second momentum of A
A.add_(A_m_hat/(sqrt(A_v_hat)+eps), -group[’lr’]) # update A
# update parameter B similarly
# ...
pairwise : read every two elements in a list
In (Mishra & Sepulchre, 2016), Mishra et al. describe a new
Riemannian metric that draws motivation from regularized
Lagrangian and involves both objectives and constraints.
When specialized to least squares matrix decomposition
problem of form ∥ABT−Y∥2
F/2, following derivation
(33) in (Mishra & Sepulchre, 2016), we get the following
metric on quotient space [x] = (A, B),
g[x](η[x], ξ[x]) =⟨ηA, ξABTB⟩+⟨ηB, ξBATA⟩.(2)
Under this new metric, the Riemannian gradient descent
effectively replaces the gradient operators via the map
∂
∂A
→∂
∂A
(BTB)−1,∂
∂B
→∂
∂B
(ATA)−1,
which then corresponds to the preconditioned updates (1)
we propose in this work. For details in the design of the new
metric (2) and its connection with sequential quadratic pro-
gramming (SQP), we point readers to (Mishra & Sepulchre,
2016) and (Mishra et al., 2012) which include a thorough
explanation and visualization of Riemannian optimization
concepts.
6. Empirical Results
6.1. Algorithms and Simple Implementation
In this section, we describe the optimization algorithms and
the software implementation we use for accelerating LoRA
training in practice. Let Ldenote the loss function and
(A(t), B(t))denote the pair of","[0.008746413514018059, 0.01786614954471588, -0.002151604276150465, 0.00611982261762023, 0.006229819729924202, -0.02206602692604065, 0.008533086627721786, 0.006693139672279358, -0.0206927340477705, 0.015879539772868156, -0.005546506028622389, -0.02965247444808483, -0.0416521281003952, -0.0049798558466136456, 0.016439523547887802, 0.007353120483458042, 0.03442566841840744, -0.04458537697792053, -0.01253963727504015, 0.055625054985284805, 0.03439900279045105, -0.014906235039234161, 0.012692965567111969, 0.03818555921316147, -0.01163299661129713, -0.02033274434506893, 0.028345845639705658, 0.019746094942092896, 0.03135909140110016, -0.020839396864175797, 0.03527897968888283, -0.013559607788920403, -0.007613112684339285, -0.04735862836241722, -0.006129822693765163, 0.007799773942679167, -0.010959682986140251, 0.03669226914644241, 0.010333034209907055, 0.023839309811592102, -0.015466218814253807, -0.013339613564312458, -0.059678271412849426, 0.004936523735523224, -0.027892526239156723, 0.03725225478410721, 0.002419929951429367, 0.026572564616799355, 0.0216527059674263, 0.012266311794519424, -0.03141242265701294, 0.037732239812612534, -0.0036465611774474382, -0.0216527059674263, -0.024985942989587784, -0.03319903835654259, -0.0007141460082493722, -0.0027949190698564053, 0.05791832134127617, -0.05130518227815628, 0.005096518900245428, -0.04317208379507065, 0.040958814322948456, -0.0021632707212120295, -0.03365235775709152, 0.0020549404434859753, -0.031945742666721344, 0.026465900242328644, 0.015919538214802742, -0.025479262694716454, -0.03730558604001999, 0.011692994274199009, 0.04941190406680107, 0.0018449465278536081, -0.03167908266186714, -0.01835946924984455, -0.002904915949329734, 0.08063766360282898, 0.04634532332420349, 0.021946031600236893, 0.03058578073978424, 0.025665923953056335, 0.0644247978925705, 0.021452711895108223, -0.017386162653565407, -0.03730558604001999, -0.02546592988073826, -0.02019941434264183, -0.02962580882012844, -0.0031165764667093754, -0.01130633894354105, 0.01915944553911686, -0.01589287258684635, 0.0548250786960125, 0.05887829512357712, 0.0012824628502130508, 0.007746442221105099, 0.01853279583156109, 0.0356256365776062, 0.021279383450746536, -0.002958247670903802, -0.00831975881010294, 0.056531697511672974, -0.01931944116950035, 0.05983826890587807, -0.03338570147752762, -0.0022432683035731316, 0.016986174508929253, 0.0010074707679450512, 0.021972697228193283, -0.01913277991116047, 0.04501203075051308, 0.003613228676840663, -0.010273035615682602, 0.007593113463371992, -0.06095823645591736, -0.02554592676460743, -0.008213095366954803, -0.049785226583480835, -0.0003672810271382332, -0.018319468945264816, -0.02162604033946991, 0.00857975147664547, -0.03765224292874336, 0.015599547885358334, -0.03954552114009857, 0.05418509617447853, -0.09477058798074722, -0.024599287658929825, 0.017479494214057922, 0.04301208630204201, 0.018839454278349876, 0.020106084644794464, -0.0386388823390007, -0.03850555047392845, 0.00938639510422945, 0.021506043151021004, 0.016239529475569725, -0.013339613564312458, -0.005336512345820665, -0.011013014242053032, -0.01762615703046322, -0.01333294715732336, -0.028292514383792877, -0.025585925206542015, 0.013679604046046734, -0.03450566902756691, 0.005703167989850044, -0.015879539772868156, -0.013606272637844086, 0.008613083511590958, 0.019826091825962067, -0.025279268622398376, 0.009833049029111862, -0.011732993647456169, -0.009399727918207645, -0.022892670705914497, 0.01967943087220192, 0.019746094942092896, -0.021666038781404495, -0.013639604672789574, 0.04717196896672249, 0.05119851604104042, 0.01056636031717062, 0.04735862836241722, 0.0350923165678978, -0.03623894974589348, -0.008053099736571312, -0.041785456240177155, -0.06207820400595665, -0.002636590274050832, -0.052558477967977524, -0.08239761739969254, -0.022906003519892693, 0.044852033257484436, -0.007033129688352346, -0.04298542067408562, -0.028932495042681694, -0.006469812709838152, -0.03463899716734886, -0.02079939842224121, 0.019532768055796623, -0.015212892554700375, 0.029305817559361458, -0.04839859902858734, 0.048691924661397934, -0.031172430142760277, 0.010493029840290546, 0.021892698481678963, 0.04431871697306633, -0.0016649517929181457, 0.037812236696481705, 0.03277238458395004, 0.030239123851060867, -0.01902611553668976, -0.04786527901887894, 0.04215877875685692, 0.011426336131989956, 0.007153126411139965, 0.05530506372451782, 0.010339700616896152, 0.01661285199224949, 0.01522622536867857, -0.03442566841840744, -0.036932263523340225, 0.002596591366454959, -0.003863221500068903, 0.010053042322397232, -0.040692154318094254, -0.03970551863312721, -0.005463175009936094, -0.00871308147907257, 0.048691924661397934, 0.010453030467033386, 0.0012807962484657764, 0.015252891927957535, -0.04757195711135864, 0.06479812413454056, 0.0011549665359780192, 0.0674113780260086, -0.02770586498081684, 0.007873104885220528, -0.002026607980951667, 0.035812295973300934, -0.045758675783872604, 0.013439610600471497, 0.030319122597575188, -0.03818555921316147, 0.050691865384578705, -0.03642561286687851, 0.06090490147471428, 0.013986261561512947, -0.01638619229197502, -0.020626069977879524, 0.07157126069068909, -0.04535868763923645, -0.02373264543712139, -0.05775832757353783, -0.0021532708778977394, -0.028319180011749268, -0.011552998796105385, 0.026652561500668526, 0.039812181144952774, -0.02077273093163967, 0.01481290441006422, 0.023945972323417664, -0.00953972339630127, -0.01811947487294674, 0.011712994426488876, 0.015772877261042595, -0.034932322800159454, -0.018026145175099373, 0.0005312346038408577, -0.013839599676430225, -0.05594504624605179, 0.019666098058223724, -0.02463928610086441, 0.002569925505667925, -0.021119387820363045, 0.0018349469173699617, -0.028825832530856133, -0.04450537636876106, -0.00451653590425849, 0.015492884442210197, -0.00841308943927288, 0.027385873720049858, -0.02362598292529583, 0.006323150359094143, 0.033865686506032944, -0.008253094740211964, 0.008006434887647629, 0.030345788225531578, -0.04346540942788124, 0.0446653738617897, -0.020239414647221565, 0.009273065254092216, 0.027999188750982285, 0.031972408294677734, -0.036825601011514664, -0.03271905332803726, 0.037758905440568924, 0.014519579708576202, 0.0904507115483284, 0.006819802336394787, 0.004689864348620176, -0.015106229111552238, -0.014492914080619812, 0.033012378960847855, -0.02219935692846775, 0.019452769309282303, 0.034105680882930756, -0.012532969936728477, 0.03975884988903999, 0.015252891927957535, 0.018399467691779137, -0.0023099330719560385, 0.017986146733164787, -0.08437088876962662, -0.01814614050090313, 0.010526361875236034, 0.014092925004661083, 0.0312524288892746, -0.01811947487294674, 0.004313208628445864, -0.03807889670133591, 0.016786180436611176, 0.054718416184186935, 0.010519695468246937, 0.009786383248865604, 0.027999188750982285, 0.0007945602992549539, 0.05525173246860504, -0.011466334573924541, 0.04335874319076538, -0.03527897968888283, -0.02271934226155281, 0.01567954570055008, -0.011532999575138092, -0.006789803504943848, 0.010559693910181522, -0.014172922819852829, -0.04343874379992485, -0.026025913655757904, -0.015306223183870316, 0.015026231296360493, -0.020986059680581093, -0.060691576451063156, -0.013866265304386616, -0.014586244709789753, -0.02759920060634613, 0.03346569836139679, 0.004049882758408785, 0.026825889945030212, 0.03407901152968407, -0.014706240966916084, 0.040932148694992065, -0.028025854378938675, 0.055518392473459244, 0.016732849180698395, 0.030959103256464005, -0.08218428492546082, -0.04130547121167183, 0.01115301065146923, 0.0113730039447546, -0.0014107924653217196, 0.018479464575648308, 0.006753137800842524, 0.013652938418090343, 0.04701197147369385, 0.0019232776248827577, -0.005929828155785799, -0.01965276338160038, 0.012039651162922382, -0.02746587060391903, 0.009206400252878666, -7.307079795282334e-05, 0.012359642423689365, -0.05935828015208244, -0.06591808795928955, -0.004669864661991596, -0.04114547371864319, -0.03623894974589348, 0.008899742737412453, 0.010973015800118446, -0.007773108314722776, 0.033012378960847855, 0.04141213372349739, 0.03165241703391075, 0.012859627604484558, -0.010886351577937603, 0.0019882756751030684, 0.008093099109828472, -0.04119880869984627, -0.018079476431012154, -0.02743920497596264, -0.01589287258684635, 0.02266601100564003, 0.04207878187298775, -0.0014007927384227514, 0.015559549443423748, 0.026399236172437668, 0.004076548386365175, -0.014186255633831024, -0.0004683197767008096, 0.020399408414959908, 0.03215906769037247, 0.020159415900707245, -0.040852151811122894, -0.036905597895383835, 0.006753137800842524, 0.005963160656392574, 0.012146314606070518, -0.002726587699726224, 0.04047882929444313, -0.02050607278943062, -0.013012956827878952, 0.016012869775295258, 0.016012869775295258, 0.045838672667741776, 0.020906060934066772, -0.025319267064332962, -0.022799339145421982, -0.0342656746506691, -0.05989160016179085, -0.02759920060634613, 0.017146170139312744, 0.025692589581012726, 0.09482391923666, 0.008993073366582394, 0.05226515233516693, 0.014959567226469517, -0.032852381467819214, 0.003729891963303089, -0.00028603337705135345, 0.04733196273446083, 0.003288238076493144, 0.0239859726279974, 0.04053216055035591, 0.03429234027862549, 0.051571838557720184, -0.007773108314722776, 0.022052694112062454, -0.018439466133713722, 0.006356482394039631, -0.03639894723892212, 0.02277267351746559, -0.020239414647221565, -0.021906033158302307, -0.005129851400852203, -0.04239877313375473, 0.028825832530856133, 0.028319180011749268, 0.020359409973025322, -0.03914553299546242, -0.06426480412483215, -0.005023187957704067, -0.014132924377918243, 0.021066056564450264, 0.006966465152800083, -0.0055365064181387424, 0.005239848047494888, 0.006386481691151857, 0.013706269674003124, -0.00018436966638546437, -0.03730558604001999, 0.03733225166797638, -0.013839599676430225, -0.010233037173748016, 0.002233268693089485, -0.024385960772633553, -0.043705400079488754, 0.016399525105953217, 0.09461059421300888, -0.02959914319217205, -0.0013341280864551663, -0.06314484030008316, 0.05930494889616966, 0.0034232342150062323, 0.028319180011749268, 0.00028457510052248836, 0.0006458146381191909, -0.02349265292286873, -0.03738558292388916, -0.022812671959400177, -0.0006562310154549778, 0.011453001759946346, 0.01661285199224949, -0.01762615703046322, 0.0034465668722987175, -0.012359642423689365, -0.004789861384779215, -0.03613228723406792, 0.009979710914194584, -0.02941248193383217, -0.05845164135098457, 0.032905712723731995, -0.03466566279530525, -0.05407843366265297, 0.02149271033704281, 0.029305817559361458, 0.03229239955544472, -0.03871887922286987, -0.021772703155875206, -0.013146285898983479, 0.011246341280639172, 0.10394365340471268, 0.022599345073103905, -0.0013082954101264477, -0.0027332541067153215, -0.004893191624432802, -0.03053244948387146, -0.005376510787755251, 0.006249818950891495, -0.014772905968129635, 0.015479551628232002, -0.0009908046340569854, -0.030132461339235306, -0.008533086627721786, 0.0051431842148303986, -0.01345960982143879, 0.011353004723787308, 0.03741224855184555, -0.002409930108115077, 0.033092375844717026, 0.030719110742211342, 0.012272978201508522, 0.025719255208969116, 0.02173270471394062, -0.006343149580061436, 0.04418538883328438, 0.027385873720049858, 0.034105680882930756, -0.0250792745500803, 0.004429871682077646, 0.019466102123260498, 0.045812007039785385, -0.023839309811592102, -0.0018549462547525764, -0.011526333168148994, 0.017332831397652626, 0.0023999304976314306, 0.0034965653903782368, -0.054665084928274155, -0.034905657172203064, 0.004026549868285656, 0.0032065738923847675, -0.02025274746119976, -0.0649581179022789, -0.01718616858124733, -0.025385931134223938, 0.0021582709159702063, 0.001689117751084268, -0.03221239894628525, 0.021506043151021004, -0.02773253060877323, -0.008613083511590958, 0.008419755846261978, -0.035812295973300934, -0.02351931855082512, 0.011406335979700089, 0.01478623878210783, -0.0028049186803400517, 0.017772817984223366, 0.030825773254036903, 0.0034765659365803003, -0.029812470078468323, 0.0006041491869837046, -0.019799426198005676, 0.0049431901425123215, 0.0594649463891983, 0.03050578385591507, -0.021372715011239052, 0.004233210813254118, -0.013879598118364811, -0.026372570544481277, 0.012426306493580341, 0.013839599676430225, 0.01967943087220192, 0.04141213372349739, 0.015186226926743984, -0.008353091776371002, 0.0102797020226717, -0.027359208092093468, -0.020919393748044968, -0.014079592190682888, 0.05711834505200386, -0.009593055583536625, -0.030905772000551224, -0.01773281954228878, 0.0005833164323121309, 0.004576534032821655, -0.0011991319479420781, 0.0019732762593775988, -0.006126489024609327, 0.018426133319735527, -0.012126315385103226, 0.0405588261783123, -0.02941248193383217, -0.0008858076762408018, 0.023892641067504883, -0.03933219611644745, -0.03063911199569702, -0.009913045912981033, -0.012399640865623951, -0.04146546497941017, 0.015572882257401943, -0.03738558292388916, 0.023345990106463432, 0.009279731661081314, 0.04045216366648674, 0.01594620570540428, -0.025945914909243584, -0.0007283122395165265, 0.0009124735952354968, -0.04117213934659958, -0.013126286678016186, -0.029252486303448677, 0.009739718399941921, -0.031972408294677734, 0.02367931418120861, 0.04634532332420349, 0.005033187568187714, 0.04130547121167183, -0.008479754440486431, -0.008959740400314331, -0.021332714706659317, -0.0006224819808267057, 0.0021366048604249954, 0.00955305714160204, -0.013119620271027088, 0.002473261673003435, 0.0073264543898403645, 0.011886322870850563, -0.0018016145331785083, -0.016159532591700554, -0.006596475839614868, -0.0007253956864587963, -0.010106373578310013, 0.06373148411512375, 0.0057198344729840755, 0.007613112684339285, -0.01858612895011902, 0.021532710641622543, 0.01721283420920372, 0.005383177660405636, 0.03714559227228165, -0.014906235039234161, -0.04941190406680107, 0.012059650383889675, 0.006756471004337072, -0.008699747733771801, -0.011273006908595562, 0.0026899219956249, 0.037838906049728394, -0.021932698786258698, 0.03146575391292572, -0.011819657869637012, 0.00045207023504190147, 0.021359382197260857, -0.03807889670133591, 0.031172430142760277, 0.009499724954366684, 0.008506420068442822, -0.03418567776679993, 0.027145881205797195, -0.029145821928977966, -0.0016374526312574744, 0.02126605063676834, -0.049811892211437225, -0.02181270159780979, -0.006839802023023367, -0.026705892756581306, 0.026492565870285034, 0.00630981707945466, 0.020319411531090736, -0.004873192403465509, 0.012706298381090164, 0.003291571279987693, 0.005986493080854416, 0.007286455482244492, -0.013932930305600166, -0.03661227226257324, -0.004909857641905546, 0.026652561500668526, -0.016186198219656944, 0.02515927143394947, 0.0102797020226717, 0.024345962330698967, 0.0059064957313239574, 0.001389959710650146, 0.07333120703697205, 0.017399495467543602, 0.010333034209907055, -0.035945624113082886, 0.010199704207479954, -0.021066056564450264, -0.039865512400865555, -0.02837251126766205, -0.027012551203370094, 0.026625895872712135, -0.01710617169737816, -0.00805976614356041, -0.017852816730737686, 0.008699747733771801, -0.015066230669617653, -0.012959624640643597, 0.022426016628742218, 0.0009241399238817394, 0.01149966660887003, -0.04039882868528366, -0.0006533144041895866, -0.0034998985938727856, 0.061544883996248245, -0.018546130508184433, 0.012879626825451851, -0.014599577523767948, -0.034905657172203064, 0.027812527492642403, 0.020759398117661476, -0.028319180011749268, -0.0028265847358852625, 0.016346193850040436, 0.00831975881010294, -0.02754586935043335, -0.015026231296360493, -0.019772760570049286, 0.013092954643070698, 0.02299933321774006, 0.07242456823587418, -0.00036915598320774734, -0.0016224529827013612, -0.011393003165721893, -0.02562592551112175, -0.012099649757146835, -0.02565259113907814, 0.017172835767269135, 0.03829222545027733, 0.03237239643931389, -0.02162604033946991, -0.013946263119578362, -0.030905772000551224, -0.01882612146437168, -0.05541172996163368, -0.0021232718136161566, 0.022292688488960266, -0.01721283420920372, -0.04911857843399048, 0.0064931451342999935, -0.002223268849775195, 0.00861975084990263, 0.038798876106739044, 0.050798527896404266, 0.015546216629445553, 0.005086519289761782, -0.000842475623358041, 0.031172430142760277, 0.007579780649393797, -0.02523926831781864, 0.00815309677273035, 0.0018599461764097214, -0.03658560663461685, -0.010839685797691345, -0.029705805703997612, 0.029199155047535896, 0.04994522035121918, 0.025692589581012726, 0.015026231296360493, 0.0002829084696713835, 0.02458595484495163, 0.012679632753133774, -0.028239183127880096, 0.012026318348944187, 0.02746587060391903, -0.04421205446124077, -0.0023549317847937346, 0.007959769107401371, -9.760133980307728e-05, 0.0035898960195481777, -0.018346134573221207, -0.002846584189683199, 0.003403234761208296, 0.007093127816915512, -0.0026582563295960426, -0.009506391361355782, -0.010879685170948505, -0.019306108355522156, -0.008466421626508236, -0.013706269674003124, 0.044718705117702484, -0.021012725308537483, 0.006096490193158388, 0.004433204885572195, 0.024265963584184647, 0.006076490506529808, 0.04026550054550171, -0.00539984367787838, -0.0011024681152775884, -0.0394655242562294, -0.017199501395225525, -0.0024432626087218523, -0.026732558384537697, 0.0030315788462758064, -0.0013999594375491142, 0.004369873553514481, -0.016839511692523956, -0.01101968064904213, 0.008339758031070232, 0.005026521161198616, 0.012552970089018345, -0.016972841694951057, -0.020052753388881683, 0.017359497025609016, 0.01359293982386589, 0.006169821135699749, 0.024279296398162842, 0.04893191531300545, -0.027385873720049858, -0.10293035209178925, -0.011986319907009602, 0.01871945708990097, -0.004519869107753038, 0.024399293586611748, -0.004913190845400095, 0.008913075551390648, -0.006533144041895866, 0.01529289036989212, 0.0014282920164987445, -0.011952986940741539, -0.024959277361631393, -0.030159126967191696, -0.0010874684667214751, 0.018932785838842392, -0.02858583815395832, -0.005696501582860947, -0.0031515753362327814, 0.04533202201128006, 0.018186140805482864, -0.017639489844441414, -0.0012782963458448648, 0.019986087456345558, 0.0033215705770999193, -0.02762586623430252, -0.00805976614356041, 0.030212458223104477, 0.005746500100940466, 0.00014280836330726743, 0.0342656746506691, 0.02033274434506893, -0.02839917689561844, 0.02121271938085556, 0.042798761278390884, -0.041838787496089935, -0.009986377321183681, 0.011039679870009422, 0.0454920157790184, 0.029119156301021576, 0.027892526239156723, 0.026185909286141396, -0.05791832134127617, 0.03546563908457756, -0.012432972900569439, 0.020052753388881683, -0.015079563483595848, 0.02951914444565773, -0.04042549431324005, -3.67958091374021e-05, 0.0022716009989380836, 0.016452856361865997, 0.01806614361703396, 0.01581287570297718, -0.018959451466798782, -0.014159590005874634, -0.022786006331443787, -0.017532825469970703, -0.01523955911397934, -0.036958929151296616, 0.0157595444470644, -0.0042798761278390884, 0.0031699081882834435, 0.03357236087322235, -0.015852874144911766, -0.05407843366265297, -0.021199386566877365, 0.010166372172534466, 0.012846294790506363, -0.023332657292485237, -0.02110605500638485, -0.010259702801704407, 0.0026165908202528954, -0.009939712472259998, 0.014012927189469337, 0.003676560241729021, -0.01638619229197502, -0.018932785838842392, 0.007366453297436237, -0.03154575452208519, 0.004403206054121256, 0.029039159417152405, -0.014386249706149101, 0.02959914319217205, 0.03375902399420738, 0.012126315385103226, 0.015959538519382477, 0.016506189480423927, -0.028932495042681694, -0.005643169861286879, 0.02079939842224121, 0.025825919583439827, -0.017506159842014313, 0.02258601225912571, -0.004559868015348911, 0.017559491097927094, -0.021866032853722572, -0.0024349295999854803, 0.0011832991149276495, 0.003159908577799797, 0.03127909451723099, 0.003783223684877157, 0.03226573392748833, -0.005333178676664829, -0.008539753034710884, 0.0048998580314219, 0.007613112684339285, 0.05143851041793823, -0.022546013817191124, 0.021919365972280502, -0.03634561598300934, 0.015212892554700375, -0.018999449908733368, -0.026265906170010567, 0.0061231558211147785, -0.008426422253251076, 0.02598591335117817, 0.011732993647456169, 0.034772325307130814, 0.04359873756766319, -0.00383322243578732, 0.023639315739274025, -0.004816527012735605, 0.0013982928358018398, 0.003354902844876051, 0.00786643847823143, -0.026239240542054176, 0.009006406180560589, 0.02515927143394947, -0.01037303265184164, 0.012766296975314617, 0.031092433258891106, 0.03706559166312218, -0.010379699058830738, 0.013392945751547813, 0.006583142559975386, 0.033865686506032944, 0.00501652155071497, 0.005173183511942625, -0.0446653738617897, -0.009073070250451565, 0.000117496594612021, 0.020186081528663635, 0.019066113978624344, 0.010019710287451744, -0.016412857919931412, 0.01261963415890932, -0.026079244911670685, -0.003706559306010604, -0.010226370766758919, 0.018239472061395645, 0.03661227226257324, -0.00494652334600687, 0.012452973052859306, 0.003453233279287815, 0.00692646624520421, 0.04455871134996414, 0.010506362654268742, -0.02453262358903885, -0.014652908779680729, 0.014052926562726498, -0.0057531665079295635, 0.03733225166797638, -0.014732906594872475, -0.048771921545267105, 0.020546071231365204, -0.018626127392053604, -0.04506536200642586, -0.010479696094989777, 0.008479754440486431, -0.0023065998684614897, -0.012166314758360386, -0.05407843366265297, 0.005546506028622389, 0.024985942989587784, 0.010506362654268742, 0.01523955911397934, 0.011859656311571598, -0.021839367225766182, -0.005743166897445917, 0.0018749457085505128, 0.01483957003802061, -0.003234906354919076, 0.0060364920645952225, -0.006363149266690016, 0.0032599056139588356, -0.01663951762020588, -0.02255934663116932, -0.043865397572517395, -0.006466479506343603, 0.034052345901727676, 0.027865860611200333, 0.015879539772868156, 0.009926379658281803, 0.05114518478512764, 0.05487840995192528, 0.02523926831781864, 0.021332714706659317, 0.030292456969618797, -0.0048498595133423805, -0.058504972606897354, -0.032079070806503296, 0.04517202451825142, -0.010306368581950665, -0.015252891927957535, -0.027972523123025894, 0.01721283420920372, 0.010066375136375427, -0.038798876106739044, 0.0064764791168272495, 0.013172951526939869, 0.002214935841038823, 0.004133213777095079, -0.04125213995575905, -0.008219761773943901, 0.0364522784948349, -0.02214602567255497, 0.00019041115592699498, -0.02271934226155281, 4.546743366518058e-05, -0.026825889945030212, -0.044772036373615265, -0.037838906049728394, -0.026785891503095627, 0.030185792595148087, 0.005759833380579948, 0.020652735605835915, 0.011159677058458328, 0.022546013817191124, -0.034798990935087204, 0.03162575140595436, -0.0071397931315004826, 0.048798587173223495, -0.029945800080895424, -0.014759572222828865, -0.03842555359005928, 0.016106199473142624, -0.004976522643119097, -0.02619924210011959, -0.022399351000785828, 0.015586215071380138, 0.03575896471738815, -4.505077959038317e-05, -0.014279586263000965, -0.01690617762506008, -0.014319585636258125, -0.0135662741959095, 0.04530535638332367, 0.056691691279411316, -0.026105910539627075, 0.0011974653461948037, 0.0017499492969363928, 0.025812586769461632, 0.009519724175333977, -0.009139735251665115, 0.006579809356480837, -0.011439668945968151, 0.009526390582323074, 0.02754586935043335, 0.03541230782866478, -0.010926350019872189, -0.029039159417152405, 0.01609286665916443, 0.005836497526615858, 0.007559780962765217, -0.009566389955580235, -0.04223877564072609, 0.014146257191896439, 0.03911886736750603, -0.011959653347730637, 0.02206602692604065, -0.00819309614598751, -0.013199618086218834, -0.001804947736673057, 0.03239906206727028, -0.01261963415890932, 0.002476594876497984, 0.024372627958655357, 0.011972986161708832, 0.04621199518442154, -0.00302157923579216, -0.01163299661129713, -0.03429234027862549, -0.04298542067408562, -0.0074731167405843735, 0.014466247521340847, -0.011399669572710991, 0.036025624722242355, 0.012959624640643597, 0.02559925802052021, 0.04925190657377243, 0.008806412108242512, 0.028879163786768913, -0.02422596514225006, -0.006593142636120319, 0.05722501128911972, -0.016039535403251648, -0.03146575391292572, 0.002209936035797, 0.010973015800118446, 0.003983217757195234, 0.005136517807841301, 0.007273122668266296, 0.010046375915408134, -0.02425263077020645, 0.024799281731247902, 0.030319122597575188, -0.03517231345176697, 0.0007866438827477396, -0.04399872571229935, -0.00803310051560402, -0.01806614361703396, -0.014946233481168747, -0.010093040764331818, 0.03511898219585419, 0.018266137689352036, 0.006743138190358877, -0.004916524514555931, 0.015999536961317062, 0.009273065254092216, -0.0064931451342999935, 0.027785861864686012, 0.011119677685201168, 0.0007470616837963462, 0.04655865207314491, -0.012426306493580341, -0.017772817984223366, -0.029839135706424713, 0.010753021575510502, -0.015932871028780937, 1.2102514119760599e-05, -0.01474623940885067, 0.027012551203370094, -1.602818156243302e-05, -0.04101214557886124, 0.0006053991382941604, 0.007073128595948219, -0.016866177320480347, -0.004266543313860893, -0.01913277991116047, -0.01611953228712082, 0.017746152356266975, 0.01433291845023632, 0.004949856549501419, -0.031225763261318207, -0.013346279971301556, -0.006486478727310896, 0.0022482683416455984, -0.002901582745835185, 0.02477261610329151, -0.026025913655757904, 0.06095823645591736, 0.006839802023023367, -0.011166343465447426, 0.02858583815395832, 0.011706328019499779, 0.005949827842414379, -0.009273065254092216, -0.013032956048846245, -0.050718531012535095, -0.0034865657798945904, 0.00803310051560402, 0.024492623284459114, -0.00391988642513752, 0.00025999246281571686, 0.02694588713347912, 0.015106229111552238, -0.04490536451339722, 0.018506130203604698, 0.006203153636306524, 0.028079187497496605, 0.02741253934800625, -0.017932813614606857, 0.002638256875798106, 0.001572454464621842, -0.024652618914842606, 0.008846410550177097, 0.0004870692209806293, 0.03639894723892212, 0.00042707097600214183, 0.006563143339008093, -0.01034636702388525, -0.026359235867857933, -0.02951914444565773, 0.0048331934958696365, -0.01814614050090313, 0.050718531012535095, -0.007573114242404699, 0.004236544016748667, -0.003746558213606477, -0.004089881666004658, 0.041892118752002716, 0.006589808966964483, -0.04042549431324005, -0.02329265885055065, -0.0014891235623508692, -0.007386452984064817, 0.01105968002229929, 0.017386162653565407, -0.032052405178546906, -0.008286426775157452, 0.027252543717622757, 0.02318599447607994, 0.055625054985284805, 0.0004116547352168709, 0.017412828281521797, 0.01099301502108574, 0.00955305714160204, 0.056585028767585754, 0.021359382197260857, -0.002209936035797, -0.022932669147849083, -0.0156262144446373, -0.03714559227228165, 0.018372802063822746, -0.03335903212428093, -0.014906235039234161, 0.004339874256402254, -0.00367989344522357, -0.04359873756766319, 0.002124938415363431, -0.0029615808743983507, -0.013519608415663242, -0.006316483952105045, -0.03330570086836815, -0.011313005350530148, -0.00012614218576345593, -0.013586273416876793, 0.03461233153939247, 0.01861279457807541, 0.02126605063676834, 0.006696472875773907, 0.007559780962765217, -0.04359873756766319, 0.017199501395225525, -0.018906118348240852, -0.014932900667190552, 0.008639750070869923, -0.01918611116707325, -0.025825919583439827, 0.027039216831326485, -0.01822613924741745, 0.020266080275177956, 0.009013072587549686, -0.020759398117661476, -0.010879685170948505, -0.017172835767269135, -0.01682617887854576, 0.009546389803290367, 0.015746209770441055, 0.043678734451532364, 0.007019796874374151, 0.009546389803290367, 0.0471452996134758, 0.0312524288892746, -0.030265789479017258, 0.02375931106507778, -0.019746094942092896, -0.018986117094755173, 0.032905712723731995, -0.003264905419200659, 0.016319528222084045, -0.004486536607146263, 0.005173183511942625, 0.0022266022861003876, 0.007999768480658531, 0.0078797722235322, 0.014706240966916084, 0.06165154650807381, 0.008926408365368843, -0.015879539772868156, 0.014759572222828865, -0.016292860731482506, 0.001488290261477232, -0.010293034836649895, -0.007026463281363249, 0.009166400879621506, -0.016546187922358513, -0.009233065880835056, 0.0038965537678450346, 0.019586099311709404, -0.031172430142760277, 0.008613083511590958, 0.0367189384996891, -0.0018349469173699617, -0.012926292605698109, 0.013086287304759026, 0.008179763332009315, 0.005643169861286879, -0.024025971069931984, -0.014679575338959694, 0.010933016426861286, -0.013706269674003124, -0.0019949423149228096, 0.01965276338160038, -0.02167937159538269, -0.0009733051410876215, 0.006466479506343603, -0.017519492655992508, 0.01522622536867857, -0.04362540319561958, 0.006339816376566887, 0.017586156725883484, -0.03706559166312218, 0.003479899140074849, -0.001612453255802393, 0.009373062290251255, -0.0056865019723773, -0.008466421626508236, 0.02967914007604122, 0.0011932987254112959, 0.01060635969042778, -0.02853250689804554, -0.012139648199081421, -0.01879945583641529, 0.06202486902475357, 0.012246311642229557, 0.008266427554190159, -0.010859685949981213, -0.004889858420938253, -0.05034520849585533, 0.009819715283811092, 0.02767919935286045, 0.0006278984947130084, 0.021612707525491714, -0.045838672667741776, 0.000746228382922709, -0.010093040764331818, -0.00879974476993084, 0.016506189480423927, 0.024799281731247902, -0.02299933321774006, -0.020346077159047127, 0.029172489419579506, -0.02107938937842846, -0.013679604046046734, -0.02365264855325222, 0.013692936860024929, 0.013179617933928967, 0.02741253934800625, -0.00831975881010294, 0.030719110742211342, -0.02954581193625927, 0.01160633098334074, 0.0025949247647076845, 0.028159184381365776, 0.04917190968990326, 0.026279238983988762, -0.021972697228193283, -0.009759717620909214, 0.04519869014620781, 0.06074490770697594, -0.008886408992111683, 0.005263180937618017, 0.014706240966916084, 0.0027999188750982285, -0.004116547293961048, 0.02845251001417637, 0.012466305866837502, 0.016626184806227684, 0.0049431901425123215, -0.007806440815329552, -0.042772095650434494, -0.005823164712637663, 0.02266601100564003, -0.007713110186159611, 0.017959479242563248, -0.009313063696026802, 0.020319411531090736, 0.014506246894598007, -0.026652561500668526, 0.02450595609843731, 0.02206602692604065, 0.0020249413792043924, -0.009333062916994095, -0.028745833784341812, -0.0006337316590361297, -0.0015416219830513, 0.01326628215610981, -0.01978609338402748, 0.015852874144911766, -0.03039911948144436, -0.019959421828389168, 0.0030632445123046637, 0.006656473968178034, 0.01923944242298603, -0.014186255633831024, 0.0015457886038348079, -0.039865512400865555, -0.02422596514225006, 0.0010274702217429876, 0.010913017205893993, -0.014999565668404102, 0.020572736859321594, -0.037838906049728394, 0.0024132635444402695, 0.014172922819852829, 0.03362569212913513, -0.0066064754500985146, -0.020892728120088577, -0.006873134523630142, 0.005703167989850044, 0.010233037173748016, -0.007753108628094196, -0.018039477989077568, 0.014586244709789753, -0.00025457594892941415, -0.0028899163007736206, 0.0003658227506093681, 0.022866005077958107, 0.05045187100768089, -0.0032465725671499968, 0.011246341280639172, 0.02367931418120861, -0.030079128220677376, -0.0012732964241877198, 0.013632938265800476, -0.010806353762745857, 0.020319411531090736, -0.01237297523766756, -0.012699631974101067, -0.029145821928977966, -0.024945944547653198, 0.016572853550314903, -0.012559636496007442, -0.01478623878210783, 0.018866119906306267, -0.008226428180932999, 0.025812586769461632, 0.011053013615310192, -0.00021478545386344194, 0.024239297956228256, 0.015466218814253807, -0.005129851400852203, -0.010999681428074837, 0.03650560975074768, 0.0020999391563236713, -0.005549839232116938, -0.017692821100354195, 0.021426046267151833, 0.03325236961245537, -0.006446479819715023, 0.009179734624922276, -0.01187965553253889, 0.0064231473952531815, -0.03567896783351898, -0.013772934675216675, 0.0030199126340448856, -0.02855917252600193, 0.018986117094755173, 0.013632938265800476, -0.016266195103526115, 0.015426220372319221, -0.013479609973728657, 0.01825280487537384, 0.03271905332803726, 0.012912959791719913, -0.0205594040453434, 0.021012725308537483, 0.015826208516955376, 0.03047911822795868, 0.014826237224042416, -0.014679575338959694, -0.009879713878035545, 0.003119909670203924, 0.016986174508929253, -0.003626561723649502, -0.014679575338959694, -0.002244934905320406, -0.006383148487657309, 0.017999479547142982, -0.010793020948767662, 0.003493232186883688, 0.027919191867113113, -0.004583200439810753, 0.012179647572338581, 0.009333062916994095, 0.013406278565526009, 0.00542650930583477, 0.007539781741797924, 0.00938639510422945, 0.03221239894628525, 0.012052983976900578, 0.04295875504612923, -0.024879278615117073, -0.045598678290843964, 0.031039102002978325, -0.007426451425999403, 0.021466044709086418, 0.0071997917257249355, -0.03437233716249466, -0.019066113978624344, 0.03242572769522667, -0.0022049362305551767, -0.024465957656502724, -0.029065825045108795, 0.0361856184899807, 0.009546389803290367, 0.020626069977879524, -0.009759717620909214, -0.016466189175844193, 0.020479407161474228, 0.023279326036572456, 0.0036465611774474382, -0.029945800080895424, 0.014279586263000965, 0.016426190733909607, -0.014506246894598007, -0.028905829414725304, -0.007499782834202051, -0.007019796874374151, -0.03365235775709152, 0.004799860995262861, 0.007419785019010305, 0.024372627958655357, -0.020972726866602898, -0.016439523547887802, 0.00211327220313251, 0.020999392494559288, -0.0030765775591135025, -0.02362598292529583, 0.026985885575413704, -0.0026449235156178474, -6.494603439932689e-05, 0.018412800505757332, -0.03447900339961052, -0.0005349845159798861, -0.010973015800118446, 0.0315190888941288, 0.033999014645814896, -0.003746558213606477, 0.014666241593658924, -0.0029799137264490128, 0.0026899219956249, -0.0386388823390007, 0.020386075600981712, -0.00010431989358039573, 0.015986204147338867, -0.003456566482782364, -0.020132750272750854]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" LoRA parameters in the t-th
iteration.
Scaled GD. To apply gradient scaling to SGD, we follow
exactly (1) and use (B(t−1)TB(t−1)+δI)−1to scale gra-
dient∇A(t−1)Land vice versa. Note here a small δ >0
is used to tackle the case when either B(t−1)TB(t−1)or
A(t−1)A(t−1)Tis not invertible. See Appendix C for the
complete algorithm.
Scaled AdamW. The conventional scaled GD method stud-
ied for classic low-rank matrix optimization problems is1234567891011121326101418
Training
Steps
(×103/step)Runtime (×103/s)AdamW
scaled AdamW
SGD
scaled GD
Figure 2. Runtime for LoRA fine-tuning GPT-2 medium model
with different optimizers. Our scaled methods introduce negligible
runtime overhead and train as fast as unscaled methods. See
Section 6.2 for experimental details. Here we set r= 4.
only based on the gradient descent method. Our Theorem
4.1 introduces this preconditioner for Adam for the first time
and reveals its advantages for Adam and its variants. We
note that AdamW is more popular than SGD for fine-tuning
due to its fast convergence. To extend preconditioning to
AdamW, one could apply the preconditioner at each individ-
ual gradient computation step or apply the scaling to the pro-
cessed gradient. Though our proof of Theorem 4.1 adopts
the latter version and preconditions the processed gradient,
we empirically find that scaling the gradient in each single
iteration behaves better than scaling the processed gradient,
thus we scale each single gradient in AdamW algorithm
for our practical implementation and dub it scaled AdamW
method. We outline the pseudocode of our scaled AdamW
in Algorithm 1. Remarkably, our method only requires four
lines change of existing optimizer code, which is simple to
implement. We highlight the changed code in red color.
6.2. Runtime Comparison
A main concern of our method may arise from the common
stereotype about the cumbersomeness and heavy computa-
tion complexity of usual preconditioning methods. This is
likely due to Hessian-inverse type second-order precondi-
5
Riemannian Preconditioned LoRA
MethodE2E
BLEU NIST MET ROUGE-L CIDEr
SGD r=4 66.6 8.54 44.2 68.2 2.32
scaled GD (ours) r=4 69.2 8.71 46.3 70.9 2.48
AdamW r=4 68.9 8.69 46.5 71.3 2.51
scaled AdamW (ours) r=4 69.6 8.77 46.6 71.8 2.52
Table 1. Scores for LoRA fine-tuning of GPT-2 medium model on E2E Natural Language Generation challenge with different optimizers.
Our scaled optimizers outperform unscaled optimizers on all evaluation metrics and scaled GD closes the performance gap between SGD
and AdamW. See Section 6.3.1 for experimental details.
tioner usually involves large size preconditioners and com-
plex computation procedures, which is not the case for the
preconditioners we consider. In each iteration, we use cur-
rent value of (AAT)−1to precondition gradient of B. The
preconditioner is easily obtained and is of small size. We
present a runtime comparison between scaled optimizers
and their unscaled counterparts for fine-tuning a GPT-2
medium model on E2E NLG challenge, see Section 6.3.1
for experimental details. Figure 2 shows the runtime used
for different optimizers for the fine-tuning task trained on
NVIDIA A100 GPUs. Note there is little difference between
the scaled optimizers and unscaled ones, which verifies that
our preconditioner is practical. See runtime comprisons for
larger rank r= 256 in Appendix D.
6.3. LLM Fine-Tuning
In this section, we study the fine-tuning task for GPT-2
model and Mistral 7B model with our scaled optimizers.
Empirically, we observe that our scaled optimizers outper-
form unscaled optimizers by a large margin for various
tasks, datasets, LoRA ranks, model sizes, model types, and
benchmarks, which demonstrates the superiority of gradi-
ent scaling in training LoRA models. See below and","[0.025545138865709305, 0.03500484302639961, 0.05961844325065613, -0.03925580531358719, -0.023222854360938072, -0.003834394970908761, 0.0029159770347177982, -0.024338075891137123, -0.04429398477077484, 0.05583981052041054, 0.004027918446809053, 8.041282126214355e-05, -0.07457553595304489, -0.017318738624453545, 0.03277439996600151, -0.006330523639917374, 0.024692323058843613, -0.051116518676280975, -0.036395590752363205, 0.042798276990652084, 0.04597337916493416, -0.015639346092939377, 0.01818467490375042, 0.032879363745450974, 0.009000496007502079, -0.023065410554409027, 0.021149853244423866, 0.03739273175597191, 0.04767901077866554, 0.002763453871011734, 0.0171219352632761, -0.031068766489624977, -0.03783882036805153, -0.0537930503487587, 0.017095694318413734, 0.0029914183542132378, 0.04027918726205826, 0.014681566506624222, -0.008856172673404217, 0.01952294073998928, -0.02196330949664116, -0.05699439346790314, -0.06082550808787346, 0.024088790640234947, -0.00023493458866141737, 0.02259308099746704, 0.03211838752031326, 0.026739081367850304, 0.03028155118227005, 0.034322589635849, -0.04256211221218109, 0.07200396806001663, -0.024338075891137123, -0.04006926342844963, 0.0005289103137329221, 0.013231778517365456, 0.031016286462545395, 0.014025554060935974, 0.052454784512519836, -0.03983309864997864, 0.03282688185572624, -0.03161981701850891, 0.032354552298784256, -0.039780616760253906, -0.009597467258572578, -0.04250963032245636, -0.06570624560117722, 0.027053968980908394, -0.004316564183682203, 0.010443723760545254, -0.029678018763661385, -0.022999810054898262, 0.05030306428670883, -0.05888371169567108, -0.013592585921287537, -0.004559289198368788, 0.010063236579298973, 0.05290087312459946, 0.05872626602649689, -0.0006916834972798824, 0.0074391853995621204, -0.02142537757754326, 0.02583378367125988, 0.004844654817134142, -0.005956596229225397, -0.06150776147842407, 0.00871841050684452, -0.035818301141262054, -0.023459019139409065, 0.013435142114758492, 0.007793432101607323, -0.01641344092786312, -0.0014178076526150107, 0.04033166915178299, 0.042981959879398346, 0.02423311397433281, 0.03508356586098671, 0.02076936513185501, 0.04870239272713661, 0.050670430064201355, 0.011342461220920086, 0.00324562331661582, 0.059828367084264755, -0.03448003530502319, 0.04303444176912308, -0.03211838752031326, 0.02708020806312561, 0.015442541800439358, -0.012687288224697113, 0.0037031923420727253, -0.05615469813346863, 0.0240494292229414, -0.0444776676595211, -0.03534597158432007, 0.01663648523390293, -0.08229024708271027, -0.030071627348661423, 0.029048247262835503, -0.031147487461566925, -0.025807544589042664, -0.0070586977526545525, -0.012333041056990623, -0.015849269926548004, -0.005694191437214613, 0.02726389281451702, -0.0006998836761340499, 0.046970516443252563, -0.050224341452121735, -0.0031833022367209196, 0.010109157301485538, 0.008692169561982155, 0.03406018391251564, 0.03833738714456558, -0.023065410554409027, -0.03718280792236328, 0.009597467258572578, -0.04400533810257912, 0.004906975664198399, 0.00040119283949024975, 0.023327816277742386, -0.006881574634462595, -0.03726152703166008, -0.012588885612785816, 0.0011595026589930058, -0.0648665502667427, 0.01363194640725851, -0.019326137378811836, 0.02484976500272751, -0.06360699981451035, 0.02689652517437935, -0.006973416078835726, 0.015980472788214684, -0.04820382222533226, -0.0001480128848925233, 0.005704031325876713, 0.0001448353286832571, -0.03867851570248604, -0.0017253137193620205, 0.028602158650755882, -0.02134665660560131, 0.002097601071000099, 0.0676480382680893, 0.04948960617184639, 0.004339524544775486, 0.04510744288563728, 0.031095007434487343, -0.02374766394495964, 0.020887447521090508, -0.07935131341218948, -0.013015294447541237, 0.015954231843352318, -0.009525305591523647, -0.03828490898013115, -0.04180113598704338, 0.026122430339455605, 0.004346084780991077, -0.038389869034290314, -0.00806895736604929, 0.028785841539502144, -0.03458499535918236, -0.02886456437408924, 0.007950874976813793, -0.03442755341529846, 0.04264083132147789, -0.06397437304258347, 0.011152218095958233, -0.00982707180082798, -0.025269612669944763, 0.002571570221334696, 0.021687783300876617, 0.012378961779177189, -0.016885770484805107, 0.0765698179602623, 0.01238552201539278, -0.006166520528495312, -0.03398146480321884, 0.0674906000494957, 0.03285312280058861, -0.03823242709040642, 0.03211838752031326, 0.020572561770677567, 0.013330180197954178, 0.041643694043159485, -0.06323963403701782, 0.014379801228642464, -0.010955413803458214, -0.025623859837651253, -0.019824707880616188, 0.025951866060495377, -0.01494397222995758, 0.017817307263612747, 0.03156733512878418, 0.018866928294301033, -0.024036308750510216, -0.025951866060495377, 0.0007679450209252536, -0.06371196359395981, 0.029599297791719437, 0.03776009753346443, 0.04460887238383293, -0.004287043586373329, 0.03135741129517555, -0.043113160878419876, 0.006468286272138357, -0.017410580068826675, -0.007065257988870144, 0.01663648523390293, -0.019103093072772026, 0.03148861601948738, -0.030517715960741043, 0.025991227477788925, -0.011709828861057758, -0.010548685677349567, -0.00623540161177516, 0.059303559362888336, -0.04180113598704338, 0.02259308099746704, -0.06350204348564148, 0.014615965075790882, -0.03099004551768303, -0.013566344976425171, 0.008036157116293907, 0.011152218095958233, -0.03508356586098671, 0.0025568099226802588, 0.027893664315342903, -0.005454746540635824, -0.028208550065755844, 0.013868111185729504, -0.006776612251996994, -0.01867012493312359, -0.04883359372615814, -0.008324802853167057, -0.055997252464294434, -0.042037300765514374, 0.028024867177009583, -0.002278004540130496, 0.007084938231855631, -0.0165446437895298, 0.008895534090697765, -0.026306113228201866, -0.005684351082891226, 0.014825889840722084, 0.03917708620429039, -0.004487127531319857, 0.01414363645017147, -0.006287883035838604, 0.013198978267610073, 0.016479041427373886, 0.0006269022705964744, 0.01020755898207426, 0.005018497817218304, -0.04237842932343483, 0.010325641371309757, -0.015350699424743652, -0.0019057171884924173, 0.0456322506070137, 0.01703009195625782, -0.07331599295139313, -0.027158930897712708, 0.01667584665119648, 0.04206354171037674, 0.08407460153102875, 0.006419085431843996, 0.018328998237848282, 0.0022681644186377525, -0.023629581555724144, -0.004592089913785458, -0.011217819526791573, -0.0102731604129076, 0.018171554431319237, -0.037156566977500916, 0.07552019506692886, -0.012142797000706196, 0.002074640477076173, -0.0030767000280320644, 0.009033296257257462, -0.036133185029029846, -0.010063236579298973, -0.0067831724882125854, 0.016820168122649193, 0.04308691993355751, -0.01738433912396431, 0.007137419190257788, -0.03602822497487068, 0.026699721813201904, 0.02129417657852173, 6.611378921661526e-05, -0.010450283996760845, 0.031068766489624977, -0.021714024245738983, 0.055157557129859924, 0.007281742058694363, 0.040620312094688416, 0.007963995449244976, -0.007091498468071222, 0.02254060097038746, -0.02894328534603119, 0.02561073936522007, -0.013244898989796638, -0.014891491271555424, -0.040305428206920624, -0.011453983373939991, 0.01565246656537056, 0.042089782655239105, 0.016912009567022324, -0.03597574308514595, -0.0008585567702539265, -0.01449788361787796, -0.011998474597930908, 0.008449445478618145, 0.0066191693767905235, 0.010148517787456512, -0.0011914832284674048, -0.0031685419380664825, 0.05261222645640373, -0.023275334388017654, 0.039780616760253906, 0.06644097715616226, 0.03169853985309601, -0.07740951329469681, -0.04397910088300705, 0.004405125975608826, -0.029651779681444168, -0.012523284181952477, -0.008088638074696064, -0.012844731099903584, 0.004316564183682203, 0.06586368381977081, 0.018827566877007484, -0.020178955048322678, -0.022383157163858414, 0.01304809469729662, -0.011263740248978138, -0.01523261796683073, 0.022566840052604675, 0.03046523593366146, -0.0250859297811985, -0.04130256548523903, 0.0049692969769239426, -0.046183302998542786, 0.012575766071677208, 0.015560624189674854, -0.02668660134077072, -0.012549525126814842, 0.015468781813979149, 0.009571227245032787, 0.03232831135392189, 0.022304436191916466, -0.029625538736581802, 0.030176589265465736, 0.04739036411046982, -0.016925130039453506, -0.008757770992815495, -0.058044012635946274, 0.015888629481196404, 0.038389869034290314, 0.016479041427373886, -0.00015723807155154645, 0.024206873029470444, 0.006150119937956333, 0.02490224689245224, -0.01974598504602909, -0.003450627438724041, -0.004536328837275505, 0.04576345533132553, 0.006219001486897469, -0.021490979939699173, -0.05038178339600563, -0.02254060097038746, -0.00590411527082324, 0.012851291336119175, -0.039465729147195816, 0.03112124837934971, -0.005664670839905739, 0.0046019298024475574, 0.0037950340192764997, 0.0331680066883564, 0.0537143275141716, 0.03156733512878418, 0.003995118197053671, -6.995761941652745e-05, -0.04975201189517975, -0.019549181684851646, -0.025715703144669533, 0.01254296489059925, 0.008862732909619808, 0.058936189860105515, 0.006730691529810429, 0.032669439911842346, -0.011526145040988922, -0.016728326678276062, 0.029153209179639816, -0.05318951979279518, 0.042667072266340256, -0.0017941950354725122, 0.03468995913863182, 0.042089782655239105, 0.029651779681444168, 0.041774895042181015, -0.01003043632954359, -0.02006087265908718, -0.020073991268873215, -0.024784164503216743, -0.03707784414291382, 0.005248102359473705, 0.0009200579952448606, -0.013166177086532116, -0.032039664685726166, -0.01969350501894951, 0.017148174345493317, -0.00011931233166251332, 0.015731187537312508, -0.05646958202123642, -0.06119287386536598, -0.018840687349438667, -0.023708302527666092, 0.04489751532673836, 0.043769173324108124, -0.043428048491477966, 0.02836599387228489, 0.02449551783502102, -0.020205194130539894, -0.0060648382641375065, -0.04285075515508652, 0.02499408833682537, -0.017043212428689003, 0.01743682101368904, -0.020428238436579704, -0.029678018763661385, -0.006688050460070372, 0.0029766580555588007, 0.01619039662182331, -0.021635303273797035, -0.011342461220920086, -0.07000968605279922, 0.05221861973404884, -0.019313016906380653, 0.0537930503487587, -0.01924741640686989, 0.03253823518753052, -0.042667072266340256, -0.06198009103536606, -0.03001914545893669, -0.011867271736264229, 0.06308219581842422, 0.03503108397126198, 0.02587314508855343, 0.018657004460692406, -0.00026732523110695183, 0.029231930151581764, -0.03941325098276138, -0.02886456437408924, -0.0199296697974205, -0.024482397362589836, 0.011303100734949112, -0.003739272942766547, -0.03437507152557373, 0.010312521830201149, -0.028707120567560196, 0.015927990898489952, 0.014117395505309105, 0.027578778564929962, -0.020480720326304436, 0.03329921141266823, 0.0742606520652771, 0.045291125774383545, 0.015035813674330711, -0.013605705462396145, -0.01587551087141037, -0.04083023592829704, -0.01282505039125681, 0.028654640540480614, -0.014314199797809124, 0.007767191622406244, -0.02668660134077072, -0.034033942967653275, -0.009321941994130611, -0.013645066879689693, 0.003035699250176549, 0.018578283488750458, -0.015718067064881325, -0.009085777215659618, 0.022829245775938034, 0.026292992755770683, -0.0016941530629992485, 0.0037917541339993477, 0.021766504272818565, 0.03631686791777611, 0.015599984675645828, -0.01689889095723629, 0.04807261750102043, -0.030255310237407684, 0.003611350432038307, -0.0010734009556472301, 0.036972880363464355, -0.02484976500272751, 0.0047134519554674625, -0.015809908509254456, 0.01632159948348999, 0.009420343674719334, 0.014287958852946758, -0.0514838844537735, -0.02486288547515869, 0.003565429709851742, 0.0012095236452296376, 0.007268622051924467, -0.09079217165708542, -0.0018073152750730515, 0.010036995634436607, 0.01764674484729767, -0.023511499166488647, -0.0004505988035816699, -0.004454326815903187, -0.0444776676595211, -0.025505777448415756, 0.02765749953687191, -0.030386513099074364, -0.041696175932884216, 0.0194704607129097, 0.022960448637604713, 0.02579442411661148, 0.0002902856795117259, 0.014576604589819908, -0.0002576900296844542, -0.03489988297224045, 0.028838323429226875, -0.026161791756749153, 0.019365498796105385, 0.03356161713600159, 0.05500011518597603, -0.003991838078945875, 0.022028909996151924, -0.020441358909010887, -0.026647239923477173, -0.020848087966442108, -0.010857012122869492, 0.03343041241168976, 0.03085884265601635, 0.025308974087238312, 0.011827911250293255, -0.00018347857985645533, -0.003337465226650238, -0.030675159767270088, -0.002102521015331149, 0.04828254133462906, -0.004086959641426802, 0.00048093940131366253, 0.00018932120292447507, 0.012169037945568562, -0.015927990898489952, 0.021884586662054062, 0.011880392208695412, 0.019194934517145157, 0.003972157370299101, -0.017594262957572937, 0.05295335501432419, 0.024692323058843613, 0.008639688603579998, 0.03429634869098663, -0.03264319896697998, -0.03757641464471817, -0.020690644159913063, -0.02143849804997444, -0.06680834293365479, -0.0018368358723819256, -0.023852625861763954, 0.006061558611690998, -0.0160067118704319, 0.03521476686000824, 0.02302604913711548, -0.022107630968093872, 0.025860024616122246, -0.026804683730006218, -0.004746252670884132, -0.011644227430224419, -0.0029110568575561047, 0.005123460199683905, 0.003304664511233568, -0.01810595393180847, 0.03264319896697998, -0.01151302456855774, 0.018801327794790268, -0.004621610045433044, -0.0018712765304371715, 0.011821351014077663, -0.012077195569872856, 0.026030588895082474, 0.0159673523157835, -0.026135550811886787, -0.003275143913924694, -0.019050611183047295, -0.010502764955163002, 0.008042717352509499, -0.03222334757447243, -0.027552537620067596, 0.01071268878877163, 0.00048749952111393213, 0.059251077473163605, -0.018433960154652596, 0.0025682901032269, -0.011814790777862072, 0.011467103846371174, -0.0045822495594620705, 0.016662726178765297, 0.006629009265452623, -0.002200922928750515, -0.0320134237408638, -0.022881727665662766, 0.007754071615636349, -0.036001984030008316, -0.014104275032877922, 0.013710667379200459, -0.0065765283070504665, 0.008902094326913357, 0.0016580723458901048, -0.012529844418168068, -0.011677027679979801, -0.01472092792391777, -0.023459019139409065, 0.022842366248369217, 0.012595445849001408, 0.0022862046025693417, -0.040305428206920624, 0.014812769368290901, -0.023603340610861778, 0.010187879204750061, 0.016387199983000755, -0.005828673951327801, -0.01840771920979023, -0.025007208809256554, -0.045369844883680344, 0.0332467295229435, 0.037733856588602066, 0.003255463670939207, 0.00652404734864831, 0.0030931003857403994, -0.018302757292985916, 0.005599069409072399, 0.005589229054749012, -0.043690454214811325, -0.02645043656229973, -0.017777947708964348, 0.018709486350417137, 0.011526145040988922, 0.010640528053045273, 0.0009676188929006457, 0.014104275032877922, -0.017804188653826714, -0.025007208809256554, 0.042667072266340256, 0.004605209920555353, 0.0222781952470541, -0.012359281070530415, -0.001157042570412159, -0.020165834575891495, -0.029153209179639816, -0.0537930503487587, -0.009013616479933262, 0.029153209179639816, -0.048230063170194626, 0.012241198681294918, -0.045815933495759964, -0.008849612437188625, -0.005464586894959211, 0.01273976918309927, -0.005845074076205492, -0.009768030606210232, -0.0075507075525820255, -0.02726389281451702, -0.005372744984924793, 0.004749532788991928, 0.004598649684339762, -0.017804188653826714, 0.031147487461566925, 0.03198718652129173, -0.01472092792391777, 0.060143254697322845, 0.0027568938676267862, -0.06208505108952522, -0.005704031325876713, 0.028917044401168823, -0.01742370054125786, -0.01171638909727335, -0.01619039662182331, -0.014182996936142445, -0.010200999677181244, 0.010096036829054356, 0.03747145086526871, -0.036001984030008316, 0.015862390398979187, -0.00880369171500206, -0.0234327781945467, 0.007872154004871845, -0.04634074494242668, -0.002054960234090686, 0.04229970648884773, -0.00900705624371767, -0.007990236394107342, 0.005008657928556204, -0.024731682613492012, -0.019575422629714012, -0.011414622887969017, 0.018998131155967712, 0.025243373587727547, 0.0011472024489194155, -0.013658186420798302, 0.050539225339889526, -0.00782623328268528, 0.023459019139409065, 0.017095694318413734, 0.031095007434487343, 0.01890628971159458, 0.015048934146761894, -0.024351196363568306, 0.0365530326962471, -0.010568366385996342, -0.026922766119241714, 0.007839352823793888, 0.013041534461081028, 0.007668789941817522, -0.021766504272818565, -0.04261459410190582, 0.003276783972978592, 0.015508143231272697, -0.01729249767959118, 0.030307792127132416, 0.02449551783502102, 0.010109157301485538, 0.011185018345713615, -0.02449551783502102, 0.011637667194008827, 0.013041534461081028, -0.011906632222235203, 0.003178382059559226, -0.004631450399756432, 0.03227582946419716, 0.027893664315342903, -0.01123093906790018, -0.013894351199269295, 0.002932377392426133, 0.011145657859742641, -0.01978534646332264, 0.010653648525476456, 0.009118578396737576, 0.0016761127626523376, -0.01071268878877163, -0.010594607330858707, 0.008567526936531067, -0.003959037363529205, -0.01222807914018631, -0.0160067118704319, 0.030071627348661423, 0.02551889792084694, 0.020113352686166763, -0.0088692931458354, 0.02668660134077072, -0.019444219768047333, 0.02410191111266613, -0.009912353940308094, -0.03705160319805145, 0.0026060109958052635, 0.010778290219604969, -0.006724131293594837, -0.01123093906790018, 0.006015637423843145, -0.005084099248051643, 0.018158433958888054, 0.02200266905128956, -0.016124794259667397, -0.03513604775071144, 0.007511346600949764, 0.012602006085216999, 0.01853892207145691, 0.01876196637749672, 0.0537143275141716, -0.0234327781945467, -0.09115953743457794, -0.02254060097038746, 0.019129334017634392, -0.003230863017961383, 0.009682749398052692, -0.0003649071149993688, 0.021884586662054062, 0.009236660785973072, 0.021228574216365814, 0.008620008826255798, 0.009125138632953167, -0.0513264425098896, -0.024561120197176933, -0.015508143231272697, 0.015376940369606018, -0.0423259474337101, -0.004956176970154047, -0.0025256492663174868, 0.022383157163858414, -0.008154239505529404, -0.006028757896274328, -0.010043555870652199, 0.001573610701598227, -0.011132537387311459, -0.021359777078032494, -0.033587854355573654, 0.01756802387535572, 0.01725313626229763, 0.004237842746078968, 0.013553224503993988, -0.005631870124489069, 5.36085462954361e-05, 0.048938557505607605, 0.01363194640725851, -0.04597337916493416, -0.004405125975608826, -0.004041038919240236, 0.008462565019726753, 0.013776268810033798, 0.03783882036805153, -0.0020270796958357096, -0.05741424113512039, 0.035949502140283585, 0.0020910408347845078, 0.0018253556918352842, -0.006173080764710903, 0.030517715960741043, -0.024797284975647926, 0.0030422594863921404, 0.0020319996401667595, 0.03566085547208786, 0.04345428943634033, 0.009197299368679523, 0.003001258708536625, 0.007327663246542215, -0.042981959879398346, -0.018355239182710648, -0.020625043660402298, -0.00858064740896225, 0.0015317898942157626, 0.01583614945411682, 0.03046523593366146, -0.02391822636127472, -0.01129654049873352, -0.039282046258449554, -0.029730500653386116, 0.020336396992206573, 0.009997635148465633, -4.96109678351786e-05, -0.05164133012294769, -0.011453983373939991, 0.01823715679347515, 0.0005576108815148473, -0.004027918446809053, 0.007708150427788496, -0.03009786829352379, -0.014642206020653248, 0.02694900706410408, -0.050408024340867996, 0.014511003158986568, 0.036395590752363205, 0.0013382661854848266, -0.008593767881393433, -0.0007736851111985743, 0.03379778191447258, 0.035503413528203964, 0.03091132454574108, -0.03776009753346443, -0.03922956809401512, 0.009794271551072598, 0.05946100130677223, 0.00311278086155653, 0.026083068922162056, 0.015560624189674854, -0.0023944468703120947, -0.028051108121871948, 0.028654640540480614, 0.03657927364110947, 0.014615965075790882, 0.009440024383366108, 0.012464243918657303, 0.018355239182710648, -0.031278692185878754, -0.031908463686704636, 0.01238552201539278, 0.0002783954259939492, 0.016741447150707245, -0.0004098030040040612, 0.03133117035031319, -0.01792226918041706, 0.03615942597389221, 0.002194362925365567, -0.00069045351119712, 0.057256799191236496, -0.00772783113643527, 0.03468995913863182, 0.03471619635820389, 0.04201105982065201, 0.047154199331998825, -0.0057138716802001, 0.014314199797809124, -0.023288454860448837, 0.0007027537212707102, 0.021648423746228218, -0.013002173975110054, -0.0054121059365570545, -0.018840687349438667, 0.012877531349658966, -0.036841679364442825, 0.02382638491690159, 0.02244875766336918, 0.02045447938144207, 0.000729404273442924, 0.029861703515052795, -0.029599297791719437, 0.018486440181732178, 0.039859339594841, -0.006861893925815821, -0.0059434762224555016, 0.01890628971159458, 0.011998474597930908, -0.0018319158116355538, 0.03720904514193535, 0.002074640477076173, 0.0031357412226498127, 0.009682749398052692, -0.025860024616122246, -0.04269331321120262, 0.014117395505309105, 0.029205691069364548, 0.02957305684685707, -0.024876005947589874, 0.010804531164467335, 0.016295358538627625, 0.004998817574232817, 0.022750524803996086, 0.0057499525137245655, -0.00915793888270855, -0.009846752509474754, 0.01545566227287054, 0.028890803456306458, 0.02134665660560131, -0.0032981045078486204, 0.005025058053433895, 0.0034899881575256586, -0.03009786829352379, -0.025768183171749115, 0.0014711087569594383, -0.0012226438848301768, 0.0009741790127009153, -0.012077195569872856, -0.06869766116142273, 0.023406537249684334, 0.009643387980759144, 0.040803998708724976, -0.005090659484267235, 0.017502421513199806, 0.0017941950354725122, -0.019667264074087143, 0.02983546257019043, -0.01836835965514183, 0.008127998560667038, -0.006307563278824091, 0.0007617948576807976, 0.01809283345937729, -0.02938937395811081, -0.027605019509792328, 0.00276181404478848, -0.019667264074087143, 0.03526724874973297, 0.0037622335366904736, 0.02294732816517353, 0.0022238835226744413, -0.00011900482786586508, 0.042929477989673615, -0.02579442411661148, 0.0434018075466156, 0.02298668958246708, -0.004792173393070698, -0.03873099759221077, -0.043769173324108124, 0.03369281813502312, -0.004697051830589771, -0.01693825051188469, -0.04122384637594223, 0.011171897873282433, 0.007885274477303028, -0.015350699424743652, -0.018827566877007484, -0.00421160226687789, 0.022042030468583107, 0.03702536225318909, 0.002668332075700164, 0.003262023674324155, 0.04954208806157112, -0.02324909344315529, 0.005700751207768917, -0.007065257988870144, -0.02797238714993, -0.028261031955480576, -0.053740568459033966, -0.0188931692391634, 0.006478126626461744, 0.007360463961958885, -0.0020303595811128616, 0.04025294631719589, 0.011185018345713615, 0.004031198564916849, 0.01765986531972885, 0.014891491271555424, 0.007340783253312111, 0.007176780141890049, -0.0199690293520689, 0.007025897037237883, -0.00047642929712310433, -0.027132689952850342, -0.0025141690857708454, 0.01545566227287054, 0.0049397763796150684, 0.011421183124184608, 0.0364743135869503, 0.0010250200284644961, -0.013553224503993988, -0.0210842527449131, 0.02565010078251362, 0.026306113228201866, 0.01903749257326126, 0.0410139225423336, -0.028182310983538628, 0.014904610812664032, 0.010286280885338783, -0.005097219720482826, 0.01020755898207426, -0.023800143972039223, -0.002571570221334696, 0.014957091771066189, 0.012090316042304039, 0.047862693667411804, 0.029415614902973175, 0.01823715679347515, -0.03739273175597191, 0.033509135246276855, 0.022265074774622917, 0.002405927050858736, 0.00561546953395009, -0.01970662549138069, 0.0009233380551449955, -0.0036999122239649296, 0.011709828861057758, 0.015941111370921135, 0.002181242685765028, 0.022383157163858414, 0.011998474597930908, 0.02912696823477745, -0.01049620471894741, 0.0171612948179245, 0.06234745681285858, -0.004798733629286289, 0.02414127066731453, 0.0038081544917076826, -0.016334719955921173, -0.02179274521768093, -0.0069930967874825, -0.006986536551266909, 0.033325452357530594, -0.05442282184958458, 0.008987375535070896, -0.011289980262517929, 0.03681543841958046, 0.044398948550224304, -0.02218635380268097, 0.04508120194077492, -0.02441679686307907, -0.001107841613702476, 0.029494335874915123, 0.005959876347333193, 0.002310805022716522, 0.014891491271555424, 0.02143849804997444, -0.024206873029470444, 0.01903749257326126, -0.009151378646492958, -0.0053497846238315105, -0.036343108862638474, 0.019221175462007523, 0.035241007804870605, -0.005189061164855957, -0.04143377020955086, -0.01363194640725851, -0.00538258533924818, -0.01649216189980507, 0.016164155676960945, 0.004710171837359667, 0.05347816273570061, 0.0032046225387603045, -0.015101415105164051, -0.01136214192956686, 0.010456844232976437, -0.0020303595811128616, -0.010502764955163002, 0.046262022107839584, 0.004670811351388693, 0.03413890674710274, 0.024298714473843575, -0.01796163059771061, -0.019129334017634392, -0.03566085547208786, -0.006136999931186438, -0.02156970091164112, 0.039596933871507645, 0.011388382874429226, 0.009243220090866089, -0.02587314508855343, 0.019798466935753822, -0.028261031955480576, -0.004893855657428503, 0.006920935120433569, -0.015941111370921135, -0.013645066879689693, -0.005041458643972874, 0.019378619268536568, 0.021766504272818565, 0.0029126969166100025, -0.0029504175763577223, -0.02276364527642727, 0.03650055453181267, -0.0007507246918976307, 0.010732369497418404, 0.024167511612176895, 0.006907815113663673, 0.063869409263134, 0.016177276149392128, -0.010732369497418404, 0.019627902656793594, -0.009492505341768265, 0.04384789615869522, 0.006317403167486191, -0.04306068271398544, -0.020021511241793633, 0.015809908509254456, 0.009289141744375229, 0.01149334479123354, -0.03558213636279106, 0.0009610587731003761, 0.010555245913565159, -0.0036047904286533594, -0.039150845259428024, 0.018643883988261223, 0.013828749768435955, 0.01961478404700756, 0.01273976918309927, -0.004293603822588921, -0.007773751858621836, -0.03534597158432007, 0.0009216979960910976, 0.01983782835304737, 0.00849536620080471, 0.009748350828886032, 0.021543459966778755, 0.022160112857818604, -0.016242876648902893, -0.015586864203214645, -0.017528662458062172, 0.03224958851933479, -0.018027232959866524, 0.024915367364883423, -0.0032636637333780527, 0.015376940369606018, 0.00010998464858857915, 0.020113352686166763, 0.0019385179039090872, 0.008259201422333717, -0.0354771725833416, 0.0009823791915550828, -0.04476631432771683, 0.003243983257561922, 0.02938937395811081, -0.00349654839374125, -0.025007208809256554, 0.006307563278824091, 0.024889126420021057, -0.0004161581164225936, 0.02028391696512699, -0.0006879934226162732, 0.03015034832060337, 0.01334330067038536, -0.0070193372666835785, 0.03529348969459534, 0.03508356586098671, -0.002681452315300703, -0.013212097808718681, -0.008587207645177841, -0.013041534461081028, 0.03930828720331192, -0.023327816277742386, -0.022579960525035858, 0.00045879895333200693, 0.027500057592988014, -0.02382638491690159, -0.0004768393118865788, -0.03272191807627678, -0.0028060947079211473, -0.0003958627348765731, -0.010633967816829681, 0.025269612669944763, 0.003594950307160616, -0.040174223482608795, 0.0055826688185334206, 0.025335215032100677, 0.05993333086371422, -0.02931065298616886, 0.005520347971469164, -0.022868607193231583, 0.004444486927241087, -0.008679049089550972, -0.008600328117609024, 0.022829245775938034, 0.0049397763796150684, -0.04930592328310013, 0.004729852546006441, 0.004021358676254749, 0.0035818300675600767, 0.022488119080662727, -0.004759373143315315, -0.02899576723575592, 0.00030053587397560477, -0.02378702536225319, -0.0023255653213709593, 0.008016476407647133, -0.0004305084003135562, -0.0033161446917802095, 0.01881444826722145, 0.001908997306600213, 0.015665585175156593, 1.1268813977949321e-05, 0.003157061757519841, -0.0025108889676630497, -0.007583508267998695, 0.018224036321043968, -0.0028831763193011284, 0.024797284975647926, -0.01273976918309927, 0.03631686791777611, 0.015862390398979187, 0.008705290034413338, 0.015088294632732868, 0.019732864573597908, 0.08543910831212997, 0.024206873029470444, -0.013369540683925152, 0.007517906837165356, 0.016164155676960945, 0.010017315857112408, -0.0022911247797310352, -0.0061698006466031075, 0.02382638491690159, -0.006291162688285112, -0.0205069612711668, -0.016032952815294266, 0.0205069612711668, -0.00147602881770581, -0.01113909762352705, 0.010082917287945747, -0.010896372608840466, 0.007380144204944372, 0.03694664314389229, 0.025335215032100677, -0.0011291620321571827, -0.007189900614321232, -0.02868087962269783, 0.005474426783621311, 0.012562645599246025, -0.004208322148770094, 0.010096036829054356, 0.024692323058843613, -0.001524409744888544, 0.030202830210328102, -0.025689462199807167, -0.005864754784852266, -0.006360044237226248, 0.0014973492361605167, 0.012103436514735222, -0.01827651634812355, 0.011565505526959896, -0.021714024245738983, -0.012943132780492306, 0.0024092071689665318, -0.050539225339889526, 0.03503108397126198, -0.006327243521809578, 0.005585948936641216, 0.003098020562902093, -0.005376025103032589, 0.02097928896546364, 0.058988671749830246, -0.02365582250058651, 0.0027864144649356604, -0.009138258174061775, 0.013868111185729504, -0.023091651499271393, 0.028156070038676262, 0.0250859297811985, 0.01911621354520321, 0.03468995913863182, -0.016885770484805107, -0.0005666310898959637, -0.014760288409888744, 0.02107113227248192, -0.03175102174282074, 0.019313016906380653, -0.009020175784826279, -0.022907966747879982, -0.011952553875744343, -0.0055761090479791164, -0.00995827466249466, -0.020848087966442108, 0.0102534806355834, -0.0003977077722083777, 0.015153896063566208, 0.005599069409072399, 0.021267935633659363, -0.011119416914880276, 0.009184179827570915, 0.014274838380515575, 0.021766504272818565, 0.024206873029470444, 0.03245951235294342, 0.0055826688185334206, -0.00673725176602602, 0.0035588694736361504, 0.033194247633218765, -0.020336396992206573, -0.00011080466356361285, -0.002261604182422161, -0.00953842606395483, 0.014760288409888744, 0.016032952815294266, 0.008265761658549309, 0.041643694043159485, -0.005753232166171074, 0.0048774550668895245, -0.012411762028932571, 0.008062397129833698, 0.035503413528203964, 0.01827651634812355, -0.013422022573649883, -0.009623708203434944, 0.0048774550668895245, -0.009308821521699429, -0.029022006317973137, 0.018604522570967674, -0.01903749257326126, 0.027027728036046028, 0.010056676343083382, -0.021871468052268028, 0.011034135706722736, 0.0026863724924623966, 0.025190891698002815, 0.0016654524952173233, 0.030517715960741043, 0.0024485678877681494, -0.008508485741913319, 0.004828254226595163, -0.0050119380466639996, -0.008055836893618107, -0.015796788036823273, -0.010686448775231838, 0.0037491132970899343, -0.002068080473691225, -0.001059460686519742, -0.024652961641550064, -0.002776574343442917, 0.017843548208475113, 0.001266104751266539, -0.0028979366179555655, 0.03442755341529846, -0.0012292040046304464, -0.0011685228673741221, -0.0341651476919651, 0.011355581693351269, -0.008403523825109005, 0.0022517640609294176, -0.008679049089550972, -0.03757641464471817, 0.015718067064881325, -0.021622182801365852, 0.009833632037043571, -0.025204012170433998, 0.021910827606916428, 0.03996429964900017, 4.8995956603903323e-05, -0.02797238714993, 0.005694191437214613, -0.018486440181732178, 0.004638010635972023, 0.04660315066576004, -0.002410846995189786, 0.00011818480561487377, -0.0036802319809794426, -0.03448003530502319, -0.012549525126814842, 0.025453297421336174, 0.004260803107172251, -0.013487623073160648, -0.025007208809256554, 0.02449551783502102, -0.017777947708964348, 0.02770998142659664, -0.007537587080150843, -0.017174415290355682, -0.015508143231272697, 0.00822640024125576, -0.028890803456306458, -0.0057893129996955395, -0.008810251951217651, 0.04159121215343475, -0.006091078743338585, -0.026870284229516983, -0.009184179827570915, 0.01443228218704462, -0.021412258967757225, 0.013986193574965, -0.008993935771286488, -0.017358098179101944, -0.026083068922162056, 0.006061558611690998, -0.004165681544691324, -0.009912353940308094, -0.006340363994240761, 0.0423259474337101, -0.009262900799512863, 0.007944314740598202, -0.011158778332173824, 0.036080703139305115, 0.02471856214106083, 0.02259308099746704, -0.013402341865003109, 0.018158433958888054, -0.01907685212790966, 0.008980815298855305, 0.012169037945568562, 0.00545802665874362, -0.008331363089382648, 0.02770998142659664, 0.0025256492663174868, 0.001269384752959013, -0.03398146480321884, 0.016177276149392128, -0.022474998608231544, 0.029992906376719475, -0.021320415660738945, 0.004477287642657757, -0.022304436191916466, -0.03497860208153725, -0.006389564834535122, 0.02397070825099945, -0.015442541800439358, 0.013776268810033798, 0.02303916960954666, -0.004398565739393234, 0.022868607193231583, 0.001059460686519742, 0.050985317677259445, -0.01363194640725851, -0.0114474231377244, 0.032800640910863876, -0.0068946946412324905, 0.02209451235830784, 0.023196613416075706, -0.03285312280058861, -0.03534597158432007, 0.018171554431319237, 0.008895534090697765, -0.02609618939459324, -0.02765749953687191, 0.037104085087776184, -0.017581142485141754, -0.00996483489871025, -0.012661047279834747, 0.00539242522791028, 0.015101415105164051, 0.007465425878763199, 0.014419161714613438, 0.013789389282464981, 0.034322589635849, 0.024154391139745712, -0.0055826688185334206, -0.03311552852392197, -0.042483389377593994, -0.03962317481637001, -0.017528662458062172, 0.0001647207245696336, 0.036448072642087936, 0.019155574962496758, 0.0023878866340965033, -0.002404286991804838, 0.02326221391558647, -0.005297303665429354, 0.0013677866663783789, -0.0014670086093246937, 0.011099737137556076, 0.023905107751488686, 0.00550066726282239, 0.021622182801365852, -0.04358549043536186, 0.004765932913869619, -0.021149853244423866, 0.01840771920979023, 0.026844045147299767, 0.017200656235218048, 0.009289141744375229, -0.011841031722724438, -0.011440863832831383, -0.02441679686307907, 0.00820672046393156, 0.015311338938772678, 0.012398642487823963, 0.005310423672199249, 0.0036539912689477205]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" also
Appendix E for all our experiments.
6.3.1. GPT-2
We exploit the new preconditioner for LoRA fine-tuning of
GPT-2 models. We follow exactly the same experimental
setup as (Hu et al., 2021) except that here we tune learning
rate individually using grid search for different methods
being tested, see Appendix E.1 for experimental details and
training hyperparameters. Table 1 shows the final score for
fine-tuning GPT-2 medium model with LoRA rank 4on
E2E (Novikova et al., 2017) natural language generation
challenge. It can be observed that scaled GD method closes
the gap between SGD and AdamW and behaves compara-
ble to AdamW while demanding smaller optimizer storage.
Scaled AdamW method improves score of AdamW method
on all evaluation metrics, which reveals that the new pre-
conditioner is advantageous even for gradient computationnormalized by gradient variance in AdamW method. See
also Appendix E.1 for experimental results for different
LoRA ranks, different datasets, and different model sizes.
Our scaled optimizers show significant and uniform im-
provements over unscaled optimizers for almost all tests.
6.3.2. M ISTRAL 7B
Mistral 7B is a recent language model released by the Mis-
tral AI team (Jiang et al., 2023) which has been shown to
outperform Llama 2-13B on all benchmarks and Llama 1-
34B on many benchmarks (Mistral AI team, 2023), and thus
is considered the most powerful language models for its size
to date. We experiment our scaled optimizers with this new
language model on the GLUE (Wang et al., 2018) bench-
mark for natural language understanding problems. Table 2
shows the final fine-tuning results. Notably that our scaled
optimizers outperform unscaled optimizers on all evaluation
metrics, which demonstrates the effectiveness of gradient
scaling for fine-tuning Mistral 7B model. See Appendix E.2
for training hyperparameter selection.
6.4. Diffusion Model Fine-Tuning
Diffusion models are now used for various image genera-
tion tasks and LoRA has been widely used for fine-tuning
diffusion models. Here we start with the commonly used
Stable Diffusion V1.5 model and show the effectiveness of
applying our new preconditioner in LoRA fine-tuning for ob-
ject generation. Then, we experiment with the Mix-of-Show
model (Gu et al., 2023) which can generate high-quality face
images. We observe that with gradient scaling, image gener-
ation becomes much more robust to learning rate changes,
which is a reflection of the fact that our new preconditioner
stabilizes the training process against learning rate varia-
tions. This has important practical benefits since learning
rate choices can be crucial in image generation problems
where small difference in learning rate can produce images
of very different quality. This can be observed from Figures
1 and 3. Furthermore, it’s widely observed that training
loss is useless in monitoring image generation quality when
training diffusion models. Thus a better optimizer which is
6
Riemannian Preconditioned LoRA
MethodGLUE
MNLI SST-2 MRPC CoLA QNLI QQP RTE STS-B WNLI Avg.
SGD r=16 88.15 96.10 70.10 55.89 94.22 88.59 50.90 47.64 49.30 71.21
scaled GD (ours) r=16 90.21 96.90 81.62 68.17 94.40 91.15 54.15 90.31 56.34 80.36
AdamW r=16 89.86 96.79 88.48 71.05 94.42 91.24 90.61 90.42 81.69 88.28
scaled AdamW (ours) r=16 90.68 97.25 89.46 71.30 94.67 92.22 91.34 91.10 83.10 89.01
Table 2. Scores for LoRA fine-tuning of 4-bit quantized Mistral 7B model on GLUE benchmark for Natural Language Understanding
(NLU) challenges with different optimizers. Our scaled optimizers outperform unscaled optimizers on all evaluation metrics. See Section
6.3.2 for experimental details.
more robust to learning rate choices is very important. See
Append","[0.02087331935763359, 0.04037339240312576, 0.05833543464541435, -0.039164938032627106, -0.01860746555030346, 0.008163939230144024, 0.0066053071059286594, 0.0008162223384715617, -0.051359351724386215, 0.041197340935468674, 0.005383118987083435, 0.022768396884202957, -0.06487207859754562, -0.006447383668273687, 0.030321242287755013, 0.00410600146278739, 0.029991663992404938, -0.037791695445775986, -0.034138862043619156, 0.039247334003448486, 0.039110008627176285, -0.011803038418293, -0.01945887692272663, 0.023798329755663872, 0.013224346563220024, -0.0187173243612051, 0.008740702643990517, 0.009173274971544743, 0.025707140564918518, -0.003481175284832716, 0.032765619456768036, -0.024814531207084656, -0.038286060094833374, -0.047816380858421326, -0.025446224957704544, 0.011727510020136833, 0.04792623966932297, 0.02574833855032921, -0.047788914293050766, 0.0006286886055022478, -0.0014676552964374423, -0.07118900120258331, -0.05948895961046219, 0.02072226256132126, -0.0032374244183301926, 0.008067812770605087, 0.02949729561805725, 0.02952476032078266, 0.003996142186224461, 0.021134234964847565, -0.04592130333185196, 0.05597345530986786, -0.031859274953603745, -0.06734392046928406, 0.019939512014389038, -0.01715182699263096, 0.03897268325090408, -0.013759911991655827, -0.001740587642416358, -0.05256780609488487, -0.005314456764608622, -0.024182839319109917, 0.04951920360326767, -0.029909269884228706, -0.004167797509580851, -0.04218607768416405, -0.05861008167266846, -0.006704867351800203, 0.03713253512978554, 0.018071899190545082, -0.01735781319439411, -0.020502543076872826, 0.04169170930981636, -0.031062794849276543, -0.0288381390273571, -0.01290849968791008, 0.017522601410746574, 0.044163547456264496, 0.01803070306777954, -0.042680446058511734, 0.0012084553018212318, -0.016973303630948067, 0.021353954449295998, -0.015270480886101723, -0.022562410682439804, -0.03290294110774994, -0.00179036776535213, -0.0266546793282032, -0.02650362253189087, -0.01218068040907383, -0.009475388564169407, -0.02734130248427391, -0.02074972726404667, 0.02234269119799137, 0.05460020899772644, -0.006516045890748501, 0.036253660917282104, -0.005077572073787451, 0.04009874537587166, 0.033287450671195984, 0.011521522887051105, 0.009784368798136711, 0.03496281057596207, -0.02215043641626835, 0.06838758289813995, -0.013004627078771591, 0.03015645407140255, 0.018250422552227974, -0.03515506535768509, 0.01928035542368889, -0.012201279401779175, 0.028947997838258743, -0.01873105764389038, 0.003673429600894451, -0.0012548023369163275, -0.07102421671152115, -0.037571974098682404, 0.0009732871549203992, -0.014130688272416592, -0.011603917926549911, -0.016039498150348663, -0.0024031782522797585, 0.004936814773827791, -0.006358122918754816, 0.0358416847884655, -0.0060010794550180435, 0.04809102788567543, -0.04306495189666748, -0.005623436998575926, -0.007381190080195665, 0.01947261020541191, 0.02443002350628376, 0.05454527959227562, -0.01290849968791008, -0.022425085306167603, -0.0032236918341368437, -0.008809364400804043, 0.0016187122091650963, -0.004294822923839092, 0.026256438344717026, -0.009784368798136711, -0.03894522041082382, -0.008335595019161701, 0.021010642871260643, -0.05311710387468338, -0.010347398929297924, -0.025720873847603798, 0.004806356504559517, -0.04067550599575043, 0.039988886564970016, -0.0027052920777350664, -0.006698001176118851, -0.056248102337121964, 0.008713237941265106, -0.021285291761159897, -0.023262765258550644, -0.012455329298973083, 0.022782130166888237, 0.02364727295935154, -0.03315012529492378, 0.011789306066930294, 0.06882702559232712, 0.023180371150374413, -0.03650084510445595, 0.0486677922308445, 0.008321862667798996, -0.03345223888754845, 0.012963430024683475, -0.09118344634771347, -0.03501773998141289, 0.03021138347685337, -0.01543527003377676, -0.035539571195840836, -0.03358956426382065, -0.007278196979314089, 0.009056548587977886, -0.05394105240702629, -0.02938743680715561, 0.016767317429184914, -0.03152969852089882, -0.023180371150374413, 0.024100443348288536, -0.03792901709675789, 0.028508558869361877, -0.05226569250226021, -0.016012033447623253, -0.0171930231153965, 0.01041606068611145, 0.017399009317159653, 0.03152969852089882, -0.013759911991655827, -0.0044836439192295074, 0.10063137114048004, 0.010670111514627934, -0.021697266027331352, -0.03493534401059151, 0.05904952064156532, 0.03784662485122681, -0.035649433732032776, 0.023441286757588387, -0.002521620597690344, 0.04539946839213371, 0.01649266853928566, -0.09255669265985489, 0.030403638258576393, -0.006272295024245977, -0.014158152975142002, -0.02436136081814766, -0.014597591012716293, 0.018305351957678795, 0.024182839319109917, 0.06234530732035637, 0.009592114016413689, -0.012544590048491955, -0.05679740011692047, 0.021985648199915886, -0.07668198645114899, 0.03235364332795143, 0.035512108355760574, 0.04660792648792267, -0.009921693243086338, 0.02806912176311016, -0.015243016183376312, 0.008170805871486664, -0.022480014711618423, 0.007264464627951384, 0.011816770769655704, -0.027849402278661728, 0.004816655535250902, -0.036171264946460724, 0.0361163355410099, -0.016053229570388794, -0.020996911451220512, -0.02731383591890335, 0.04600369557738304, -0.06750871241092682, 0.03282054886221886, -0.028453629463911057, 0.01656133122742176, -0.040565647184848785, -0.0013440632028505206, 0.020433880388736725, 0.013993363827466965, -0.025405026972293854, -0.0014221664750948548, 0.019912047311663628, -0.024704672396183014, -0.03595154732465744, 0.041279736906290054, -0.008095277473330498, -0.018332816660404205, -0.04158185049891472, -0.022576142102479935, -0.05657768249511719, -0.019678596407175064, 0.021285291761159897, -0.024704672396183014, -0.008720103651285172, -0.07217773795127869, 0.031364910304546356, -0.029250111430883408, -0.012633850798010826, 0.0037283592391759157, 0.030348706990480423, -0.008726970292627811, 0.0006239680806174874, -0.03216139227151871, 0.02809658646583557, 0.00026821185019798577, -0.018154295161366463, 0.008122742176055908, -0.008816231042146683, -0.0171243604272604, -0.009125211276113987, -0.022672269493341446, -0.026160310953855515, 0.04037339240312576, 0.028343770653009415, -0.041938893496990204, 0.003711193799972534, -0.0012668182607740164, 0.016945838928222656, 0.05525936558842659, -0.006237964145839214, -0.009853030554950237, 0.021065574139356613, 0.021999379619956017, -0.01863493025302887, -0.02296065166592598, -0.026997990906238556, 0.015146888792514801, -0.04248819127678871, 0.053556542843580246, -0.034221258014440536, -0.017083164304494858, 0.026380030438303947, 0.007134006358683109, -0.006059442181140184, -0.012269941158592701, 0.00830813031643629, 0.03751704469323158, 0.01506449468433857, -0.0035738693550229073, 0.009420458227396011, -0.006265428848564625, 0.0244712196290493, 0.024553615599870682, -0.01793457567691803, -0.0024409424513578415, 0.023935655131936073, -0.019774723798036575, 0.0372973270714283, -0.02449868433177471, 0.030403638258576393, 0.0011209109798073769, -0.012743710540235043, 0.0332050547003746, -0.012091419659554958, -0.0011930062901228666, -0.01402769424021244, -0.023249031975865364, -0.02518530748784542, -0.010107080452144146, 0.03012898936867714, 0.022081773728132248, -0.008960421197116375, -0.039824094623327255, -0.00933806411921978, -0.011212542653083801, -0.009248803369700909, 0.004123167134821415, 0.01645147055387497, 0.020461345091462135, 0.007724501192569733, -0.009956023655831814, 0.011967827565968037, -0.049793850630521774, 0.039988886564970016, 0.05237555131316185, 0.03130997717380524, -0.10030179470777512, -0.03367196023464203, 0.014213082380592823, -0.0020478512160480022, 0.003628798993304372, -0.0171243604272604, -0.011954095214605331, -0.010196342132985592, 0.07360591739416122, 0.010113947093486786, -0.02087331935763359, -0.034029003232717514, -0.00504667405039072, 0.01873105764389038, -0.005698965396732092, 0.004545439966022968, 0.026187775656580925, -0.008445454761385918, -0.0371600016951561, 0.007223267108201981, -0.05756641551852226, 0.031035330146551132, -0.007978552021086216, -0.003371315775439143, 0.000984444748610258, 0.002130245789885521, 0.003900015028193593, 0.05806078389286995, -0.0051050372421741486, -0.03257336467504501, 0.0011887149885296822, 0.03455083817243576, -0.0017577531980350614, 0.008960421197116375, -0.04869525507092476, 0.006739198230206966, 0.03683042153716087, 0.014144420623779297, -0.003954944666475058, 0.02372966893017292, -0.007971685379743576, 0.03724239766597748, -0.011960960924625397, -0.017055699601769447, -0.016245484352111816, -0.0012771175242960453, 0.01262698508799076, -0.01998070999979973, -0.07811015844345093, 0.0038279194850474596, -0.018909579142928123, -0.0034502772614359856, -0.035429712384939194, 0.023537414148449898, -0.003464009612798691, 0.020461345091462135, -0.02588566206395626, 0.02864588424563408, 0.030568426474928856, 0.058445293456315994, -0.008047213777899742, 0.004150631837546825, -0.05190864950418472, -0.018813451752066612, -0.029140252619981766, 0.05363893881440163, 0.01361572090536356, 0.045646652579307556, 0.008912358433008194, 0.033397309482097626, -0.0034348282497376204, -0.024622276425361633, 0.040428321808576584, -0.037764228880405426, 0.0036425315774977207, -0.012352336198091507, 0.007532247342169285, 0.022425085306167603, 0.021038109436631203, 0.05542415380477905, -0.014055158942937851, -0.023523680865764618, -0.013567657209932804, -0.04688257351517677, -0.036912817507982254, -0.004377217497676611, -0.0008093561045825481, -0.03369942307472229, -0.01569618657231331, -0.030431102961301804, -0.009084013290703297, 0.0009312315378338099, 0.025432491675019264, -0.03092546947300434, -0.06102699413895607, -0.003831352572888136, -0.0208321213722229, 0.03394660726189613, 0.026297636330127716, -0.041334666311740875, 0.015366608276963234, 0.007024146616458893, 0.004607236012816429, 0.005791659466922283, -0.04171917214989662, 0.054243165999650955, -0.006546943914145231, 0.0043051219545304775, 0.0059255510568618774, -0.027615951374173164, -0.009063415229320526, 0.009873629547655582, 0.04111494496464729, -0.006873089820146561, -0.006722032558172941, -0.062125589698553085, 0.0891510471701622, -0.020543741062283516, 0.058665014803409576, -0.029579689726233482, 0.047074828296899796, -0.00895355548709631, -0.05528683215379715, -0.0244712196290493, -0.012249342165887356, 0.05160653591156006, 0.046415671706199646, 0.014638788066804409, 0.010017819702625275, -0.005980480462312698, 0.013148818165063858, -0.04951920360326767, -0.0357043631374836, -0.03812127187848091, -0.030431102961301804, 0.0033592998515814543, 0.013409734703600407, -0.021024376153945923, 0.024636009708046913, -0.014130688272416592, 0.03210645914077759, 0.0018950776429846883, 0.026174044236540794, -0.01070444192737341, 0.024924391880631447, 0.06261995434761047, 0.04023607075214386, 0.008088410831987858, -0.012427864596247673, -0.005012343171983957, -0.008534715510904789, -0.0244712196290493, 0.02578953467309475, -0.016218019649386406, 0.013931567780673504, -0.007971685379743576, -0.00277395430020988, -0.0022143570240586996, -0.0009878779528662562, -0.0061384038999676704, 0.023949386551976204, -0.00865830760449171, 0.0026280470192432404, 0.00789615698158741, 0.02216416969895363, -0.00045231246622279286, 0.005729863420128822, 0.025995522737503052, 0.025968056172132492, 0.0075391135178506374, 0.005520443432033062, 0.02643495984375477, -0.016835980117321014, 0.0025525186210870743, 0.014199350029230118, 0.023139173164963722, -0.01572365127503872, 0.04391636326909065, -0.0017800683854147792, 0.04144452512264252, -0.0014942619018256664, 0.0013638036325573921, -0.04594876617193222, -0.021285291761159897, 0.019898315891623497, -0.013869771733880043, -0.008404257707297802, -0.08695385605096817, -0.012022756971418858, -0.008740702643990517, 0.03806634247303009, -0.03921986743807793, -0.004929948598146439, -0.019733525812625885, -0.05177132412791252, -0.02226029708981514, 0.010491589084267616, -0.03748957812786102, -0.04523468017578125, 0.024278966709971428, 0.035539571195840836, 0.03221632167696953, 0.01218068040907383, 0.0038691170047968626, 0.010436659678816795, -0.03501773998141289, 0.02302931249141693, -0.0251990407705307, 0.0038519513327628374, 0.039906490594148636, 0.04674524813890457, -0.0022486881352961063, 0.01393843349069357, -0.008177672512829304, -0.02007683739066124, -0.0007587177096866071, -0.006656803656369448, 0.012043355964124203, 0.015339143574237823, 0.03520999476313591, 0.03680295869708061, -6.104501517256722e-05, 0.0016710670897737145, -0.024210304021835327, 0.00179036776535213, 0.04158185049891472, -0.0038897155318409204, -0.0028546324465423822, 0.005084438249468803, 0.023166637867689133, -0.03433111682534218, -0.0035498375073075294, 0.023880725726485252, 0.03386421501636505, 0.014954634942114353, -0.019788455218076706, 0.03820366784930229, 0.02145008184015751, 0.01728915050625801, 0.018895847722887993, -0.024841995909810066, -0.02651735581457615, -0.00701384712010622, -0.02081838995218277, -0.05734669789671898, 0.010917295701801777, -0.015627523884177208, -0.006694567855447531, -0.013052690774202347, 0.01860746555030346, 0.021697266027331352, -0.019033171236515045, 0.0029953899793326855, -0.020337752997875214, -0.00718893576413393, -0.015503932721912861, -0.004765158984810114, -0.016890909522771835, -0.00782749429345131, -0.020282823592424393, 0.01875852234661579, -0.01728915050625801, 0.00771763501688838, -0.0010119096841663122, -6.651654257439077e-05, 0.03446844220161438, -0.021738464012742043, 0.01329987496137619, -0.0077862972393631935, -0.03801141306757927, 0.004428714048117399, -0.019733525812625885, -0.021724730730056763, -0.008163939230144024, -0.016135625541210175, -0.01947261020541191, -0.0006698859506286681, -0.007800030056387186, 0.0642678514122963, -0.012002158910036087, -0.027602218091487885, -0.02861841954290867, 0.001977472333237529, -0.024567347019910812, 0.011569586582481861, -0.006739198230206966, -0.013437199406325817, -0.028893068432807922, -0.021779660135507584, 0.0052766925655305386, -0.028508558869361877, -0.017000768333673477, 0.004195262677967548, -0.00866517424583435, 0.006804427597671747, 0.010512188076972961, 0.006694567855447531, -0.01294283103197813, -0.02307051047682762, -0.050480473786592484, 0.024031782522797585, 0.016163090243935585, -0.015586326830089092, -0.02734130248427391, 0.03177688270807266, -0.039082542061805725, 0.007669571787118912, -0.006804427597671747, 0.003927479963749647, -0.03315012529492378, -0.03608886897563934, -0.03141983970999718, 0.029854338616132736, 0.05325442925095558, 0.008081545121967793, -0.007491049822419882, 0.006100639700889587, -0.01224247645586729, -0.011281205341219902, 0.011363599449396133, -0.03441351279616356, 0.005599405150860548, -0.0403459295630455, 0.02864588424563408, 0.01858000084757805, 0.02151874452829361, -0.0029627755284309387, 0.01879972033202648, -0.005537609104067087, -0.021656068041920662, 0.054929789155721664, -0.018250422552227974, 0.035429712384939194, -0.010196342132985592, -0.007006980944424868, -0.00046475749695673585, -0.007566578220576048, -0.057017117738723755, -0.009880495257675648, 0.0244712196290493, -0.04954667016863823, 0.02944236621260643, -0.06646504253149033, -0.004830388352274895, 0.0033129528164863586, 0.006474848836660385, -0.007099675014615059, -0.007999150082468987, -0.03531985357403755, -0.018387746065855026, 0.007765698712319136, 0.007676437962800264, 0.010910429060459137, -0.016753586009144783, 0.014858507551252842, 0.03856071084737778, -0.031859274953603745, 0.058500222861766815, -0.006780395749956369, -0.11013422161340714, 0.0005990780191496015, 0.026022987440228462, -0.016094427555799484, -0.02024162746965885, -0.014515195973217487, -0.012331737205386162, -0.00519429799169302, 0.006783828604966402, 0.06981576234102249, -0.03139237314462662, 0.0032254084944725037, 0.016698654741048813, -0.008829963393509388, -0.004645000211894512, -0.02878320775926113, -0.013698115944862366, 0.04029100015759468, 0.024649742990732193, -0.005482679232954979, -0.0074567184783518314, -0.02226029708981514, -0.014570126309990883, -0.018840916454792023, 0.025446224957704544, 0.017701124772429466, -0.010258138179779053, 0.002053000731393695, 0.03078814595937729, -0.009097745642066002, 0.021299025043845177, 0.016904642805457115, 0.006437084637582302, 0.023455020040273666, -0.004497376270592213, -0.024800799787044525, 0.03317759186029434, 0.00684219179674983, -0.024018049240112305, 0.015490200370550156, 0.0037043276242911816, -0.007477317471057177, -0.013512727804481983, -0.03817620128393173, -0.013121352531015873, 0.010436659678816795, -0.014528929255902767, 0.025281434878706932, 0.04210368171334267, 0.021120503544807434, 0.0045248414389789104, -0.034001536667346954, 0.012839837931096554, 0.019857117906212807, 0.001539750606752932, -0.007820628583431244, -0.004466478247195482, 0.03238110989332199, 0.011555854231119156, -0.0271765124052763, -0.007065344136208296, 0.026874398812651634, 0.01108895055949688, 0.0012831254862248898, 0.02285079099237919, 0.0021937584970146418, 0.007326260209083557, -0.0016676340019330382, 0.007875557988882065, 0.0032580229453742504, -0.009997221641242504, -0.01654759794473648, -0.004820088855922222, 0.024745868518948555, 0.02221909910440445, 0.02588566206395626, -0.01367751695215702, 0.023400088772177696, -0.012826105579733849, 0.01145286113023758, 0.010876097716391087, -0.020530007779598236, -0.02226029708981514, 0.0018967941869050264, -0.00901535153388977, 9.65026265475899e-05, -0.0021611438132822514, -0.026750806719064713, -0.0070310127921402454, -0.009056548587977886, -0.034111399203538895, -0.04526214674115181, -0.014041426591575146, 0.019788455218076706, 0.034111399203538895, -0.0015672155423089862, 0.03921986743807793, -0.031969137489795685, -0.12249342352151871, -0.013691249303519726, -0.0007415521540679038, -0.006416485644876957, 0.007559712044894695, 0.002283019246533513, 0.0060972063802182674, -0.004689630586653948, 0.012324871495366096, 0.007566578220576048, 0.021189166232943535, -0.04688257351517677, -0.013190015219151974, -0.010628913529217243, 0.012771175242960453, -0.06377348303794861, -0.003326685167849064, 0.006447383668273687, 0.03834099322557449, -0.022136704996228218, -0.015929637476801872, -0.014268012717366219, 0.0063855876214802265, -0.0017002485692501068, -0.030458567664027214, -0.034743089228868484, 0.02009057067334652, 0.011803038418293, 0.0025010218378156424, 0.02085958607494831, -0.017673658207058907, -0.007765698712319136, 0.039110008627176285, 0.017522601410746574, -0.03633605316281319, -0.008074678480625153, -0.003800454782322049, -0.011075218208134174, 0.0031344310846179724, -0.008047213777899742, 0.022589875385165215, -0.030650820583105087, 0.04281776770949364, 0.0017732022097334266, 0.015503932721912861, -0.0060972063802182674, 0.010862365365028381, -0.02006310410797596, -0.0011372182052582502, -0.02864588424563408, 0.029030391946434975, 0.01647893711924553, -0.0005784793174825609, 0.010059017688035965, -0.0049917446449398994, -0.03806634247303009, -0.01569618657231331, -0.018264153972268105, -0.02655855193734169, 0.01661626063287258, 0.013780510053038597, 0.03655577450990677, -0.0041300333105027676, -0.025597281754016876, -0.03433111682534218, -0.03441351279616356, 0.0063855876214802265, 0.016382809728384018, 0.008678906597197056, -0.05399598181247711, -0.01715182699263096, 0.039082542061805725, 0.01073877327144146, 0.004682764410972595, -0.014982099644839764, -0.016987036913633347, 0.0030005397275090218, 0.03078814595937729, -0.059159379452466965, -0.00046947802184149623, 0.02304304577410221, -0.021738464012742043, 0.0193764828145504, -0.006340957246720791, 0.020269092172384262, 0.039879024028778076, 0.01587470807135105, -0.03018391877412796, -0.020530007779598236, 0.03520999476313591, 0.057731207460165024, -0.010258138179779053, 0.020337752997875214, -0.005190865136682987, -0.02238388918340206, -0.029552225023508072, 0.013526460155844688, 0.05405091121792793, 0.008411123417317867, 0.002435792703181505, 0.02290572226047516, 0.018552536144852638, -0.031062794849276543, -0.01998070999979973, 0.034770555794239044, 0.012098285369575024, 0.025336364284157753, -0.014432801865041256, 0.033287450671195984, -0.008720103651285172, 0.020612401887774467, 0.017495136708021164, 0.0017817849293351173, 0.05943403020501137, -0.008610243909060955, 0.016863444820046425, 0.03820366784930229, 0.023866992443799973, 0.021958181634545326, -0.007868692278862, 0.028426164761185646, -0.01326554361730814, -0.009626445360481739, 0.01650640182197094, -0.03419379144906998, -0.016204288229346275, 0.006759796757251024, -0.009901094250380993, -0.022795861586928368, 0.022617340087890625, 0.007532247342169285, 0.0008883176487870514, -0.0034004971385002136, 0.0251303780823946, -0.0215599425137043, -0.009907959960401058, 0.03317759186029434, -0.0038176202215254307, 0.004706796258687973, 0.027643416076898575, -0.0041334666311740875, 0.012688781134784222, 0.047679055482149124, -0.003112115664407611, -0.005462080705910921, 0.012002158910036087, -0.005616570822894573, -0.038478314876556396, 0.007642106618732214, 0.019541271030902863, 0.049217090010643005, -0.01657506264746189, 0.005832856986671686, 0.02734130248427391, -0.0018727624556049705, 0.019706061109900475, -0.00035918931826017797, -0.02448495291173458, -0.0030674852896481752, -0.00519773131236434, 0.03369942307472229, 0.025597281754016876, -0.01115074660629034, -0.010635780170559883, 0.028206445276737213, -0.01947261020541191, -0.023908190429210663, -0.004761726129800081, -0.023303963243961334, 0.007099675014615059, -0.020269092172384262, -0.05663261190056801, 0.036226194351911545, 0.021738464012742043, -0.0016247201710939407, 0.007484183646738529, 0.01329300832003355, 0.004723961930721998, 0.004188396502286196, 0.03304026648402214, -0.018346549943089485, 0.025995522737503052, -0.024649742990732193, 0.012716245837509632, 0.04029100015759468, -0.034880414605140686, -0.0020735994912683964, 0.024045513942837715, -0.003163612447679043, 0.02664094604551792, -0.017399009317159653, 0.041389595717191696, -0.009729438461363316, 0.029936734586954117, 0.03869803622364998, -0.04592130333185196, 0.045564260333776474, 0.02946983091533184, -0.02507544867694378, -0.04652553051710129, -0.059104450047016144, 0.032655756920576096, -0.010477856732904911, -0.024800799787044525, -0.04221354052424431, 0.01509195938706398, -0.020447613671422005, -0.012681914493441582, -0.021930716931819916, -0.00627916119992733, 0.010113947093486786, 0.03496281057596207, 0.009626445360481739, 0.003989276010543108, 0.041279736906290054, -0.018181759864091873, 0.004912782926112413, 0.002272719983011484, -0.03076068125665188, -0.03092546947300434, -0.0371600016951561, -0.02445748820900917, -0.01189229916781187, 0.01650640182197094, -0.003429678501561284, 0.033424776047468185, 0.018374014645814896, -0.011267472989857197, 0.008768167346715927, 0.018140561878681183, 0.00032979328534565866, 0.0010779970325529575, -0.020694797858595848, 0.011899164877831936, -0.000529557466506958, -0.02872827835381031, -0.008823096752166748, 0.021093038842082024, -0.0015234433813020587, 0.011988426558673382, 0.037709299474954605, -0.0014041427057236433, -0.009056548587977886, -0.03724239766597748, 0.012276807799935341, 0.021669801324605942, 0.01867612823843956, 0.028920533135533333, -0.040648043155670166, 0.01879972033202648, 0.0013320473954081535, -0.014652520418167114, 0.017440207302570343, -0.020392684265971184, 0.012441596947610378, 0.022068042308092117, 0.016781050711870193, 0.05042554438114166, 0.034001536667346954, 0.026984257623553276, -0.04644313454627991, 0.030540961772203445, -0.00023044762201607227, -0.002614314667880535, 0.011082084849476814, -0.013883504085242748, 0.0066396379843354225, 0.013801109045743942, 0.01583351194858551, 0.026380030438303947, 0.005650901701301336, 0.02585819736123085, 0.01801696978509426, 0.023345159366726875, -0.022562410682439804, 0.003783289110288024, 0.05179879069328308, -0.013052690774202347, 0.02232895791530609, 0.006794128101319075, -0.012894767336547375, -0.019046904519200325, -0.012482794001698494, -0.0012264791876077652, 0.01947261020541191, -0.012517125345766544, -0.018126830458641052, -0.004006441216915846, 0.03015645407140255, 0.021024376153945923, -0.007223267108201981, 0.05690725892782211, -0.019747259095311165, -0.013787376694381237, 0.02573460526764393, 0.011288071051239967, 0.008754434995353222, 0.024979321286082268, 0.03460576757788658, -0.031886741518974304, 0.03076068125665188, 0.010265003889799118, 0.003745524911209941, -0.01929408870637417, 0.021271560341119766, 0.03150223195552826, 0.011102682910859585, -0.0431198850274086, -0.01432294212281704, 0.004353185649961233, -0.028865603730082512, 0.023523680865764618, -0.013917834497988224, 0.04306495189666748, -0.019609933719038963, -0.014515195973217487, -0.012194412760436535, 0.00929686613380909, -0.005829423666000366, -0.018497606739401817, 0.04537200555205345, -0.013698115944862366, 0.02290572226047516, 0.01572365127503872, -0.026407495141029358, -0.03644591569900513, -0.022054309025406837, -0.0002825880073942244, 0.00039416414801962674, 0.0265860166400671, 0.044877637177705765, 0.0016341612208634615, -0.02158740721642971, 0.019129298627376556, -0.025501154363155365, 0.006419918965548277, 0.00020534299255814403, -0.013066423125565052, -0.024718403816223145, -0.007731367368251085, 0.011370466090738773, 0.014062025584280491, -0.009145809337496758, -0.006550377234816551, -0.02290572226047516, 0.02013176679611206, -0.004246759228408337, 0.008850562386214733, 0.0345233716070652, -0.0045969365164637566, 0.07448479533195496, 0.023262765258550644, -0.016327878460288048, 0.02094198204576969, -0.01538034062832594, 0.033287450671195984, -0.01400022953748703, -0.02736876718699932, -0.03205152973532677, 0.017769785597920418, 0.002444375539198518, 0.02304304577410221, -0.02517157420516014, 0.0005256952135823667, 0.030568426474928856, -0.0060388436540961266, -0.020626135170459747, 0.0008136474643833935, 0.010793703608214855, 0.03243603929877281, 0.009949157945811749, 0.004164364654570818, -0.02302931249141693, -0.02791806496679783, -0.007676437962800264, 0.02728637121617794, -0.00466903205960989, 0.01722048781812191, 0.031941670924425125, 0.03232618048787117, -0.010573984123766422, -0.0022761530708521605, -0.02944236621260643, 0.030376171693205833, -0.01789337769150734, 0.007600909564644098, -0.0038759831804782152, 0.02797299437224865, 0.001540608936920762, 0.01713809370994568, 0.00431198813021183, 0.00828066561371088, -0.015737384557724, 0.01327241025865078, -0.03457830101251602, 0.0021868920885026455, 0.01786591298878193, 0.0032597396057099104, -0.01470745075494051, 0.008047213777899742, 0.024828264489769936, -0.013471530750393867, 0.008884892798960209, -0.0012110301759094, 0.024759601801633835, 0.0015097109135240316, -0.007168337237089872, 0.0404832549393177, 0.004542006645351648, -0.002040984807536006, -0.024690939113497734, -0.007264464627951384, -0.008912358433008194, 0.018978241831064224, -0.014240547083318233, -0.021903252229094505, 0.00019536551553755999, 0.024938123300671577, -0.019706061109900475, 0.03721493110060692, -0.019609933719038963, -0.019046904519200325, 0.0022778697311878204, -0.013038958422839642, 0.0006098064477555454, 0.002784253563731909, 0.0007162329275161028, 0.015490200370550156, 0.025459956377744675, 0.05531429499387741, -0.02151874452829361, -0.005506711080670357, -0.016053229570388794, -0.0075734443962574005, -0.013904102146625519, 0.006368422415107489, 0.020612401887774467, 0.0007715918472968042, -0.05295231565833092, 0.005911818239837885, 0.01327241025865078, 0.002094198251143098, 0.016163090243935585, -0.014062025584280491, -0.03825859725475311, -0.0054174503311514854, -0.01262698508799076, -0.007024146616458893, 0.008177672512829304, -0.0018264154205098748, -0.02160113863646984, 0.0061727347783744335, -0.01565498858690262, 0.007113407365977764, -0.007216400932520628, 0.01575111597776413, -0.033369846642017365, -0.014048293232917786, -0.009351796470582485, 0.014405337162315845, 0.005674933549016714, -0.008129608817398548, 0.03441351279616356, 0.017028234899044037, -0.007333126850426197, 0.03430365398526192, 0.0010376579593867064, 0.06355376541614532, -0.004830388352274895, -0.03573182597756386, -0.0013457797467708588, 0.033424776047468185, 0.02875574305653572, 0.008205137215554714, -0.013244944624602795, -0.010258138179779053, -0.036940280348062515, -0.024251502007246017, -0.022054309025406837, 0.010573984123766422, -0.017110629007220268, -0.011336134746670723, 0.008541582152247429, -0.0027670881245285273, 0.008239468559622765, 0.027506090700626373, 0.011974693275988102, -0.01570991985499859, -0.02094198204576969, -0.026380030438303947, 0.011047753505408764, 0.019211692735552788, 0.003076068125665188, 0.020502543076872826, 0.016245484352111816, -0.021656068041920662, 0.013409734703600407, -0.02221909910440445, -0.008363059721887112, 0.005462080705910921, -0.00965391006320715, -0.011336134746670723, -0.016657458618283272, -0.003179061459377408, -0.022109240293502808, -0.004147198982536793, 0.0060388436540961266, -0.058555152267217636, 0.015215551480650902, -0.006952051073312759, 0.004978011827915907, 0.0028203013353049755, 0.011459726840257645, 0.023853261023759842, 0.046992432326078415, -0.031474769115448, -0.008960421197116375, 0.01185796782374382, 0.024127909913659096, -0.017028234899044037, 0.019651131704449654, 0.010649512521922588, 0.0004759151197504252, 0.009949157945811749, -0.03169448673725128, 0.008472919464111328, -0.019706061109900475, 0.022740932181477547, -0.04754173010587692, 0.010189475491642952, 0.011075218208134174, -0.016973303630948067, 0.019156763330101967, 0.0006342674023471773, -0.027409963309764862, -0.0288381390273571, 0.008555314503610134, 0.001563782338052988, -0.0035258056595921516, -0.004651866387575865, 0.006742631550878286, -0.031941670924425125, -0.01397276483476162, 0.011974693275988102, 0.031282514333724976, 0.04517975077033043, 0.018442675471305847, 0.0229469183832407, 0.008060946129262447, 0.0005269826506264508, 0.01583351194858551, -0.007326260209083557, 0.0010179176460951567, 0.005626870319247246, -0.021916985511779785, 0.01297716237604618, -0.0035395382437855005, 0.00027057211264036596, -0.0054140170104801655, -0.030678287148475647, 0.007779431063681841, 0.0003857959236484021, 0.012963430024683475, 0.01945887692272663, 0.023386357352137566, -0.023386357352137566, 0.003669996513053775, -0.008239468559622765, -0.018250422552227974, -0.023331427946686745, 0.0008771600550971925, 0.007854959927499294, 0.023839527741074562, 0.001689090975560248, -0.018264153972268105, 0.011878566816449165, 0.01358825620263815, 0.022356422618031502, 0.0008303839131258428, 0.019252890720963478, 0.0015826645540073514, -0.0012951414100825787, 0.004205561708658934, -0.010965358465909958, 0.0016556180780753493, -0.0022521212231367826, 0.004974578972905874, 0.0038416520692408085, 0.006502313539385796, -0.011754974722862244, 0.009187007322907448, 0.021353954449295998, 0.00718893576413393, 0.006512613035738468, -0.014583858661353588, 0.049299485981464386, 0.019033171236515045, 0.007951086387038231, -0.024855729192495346, 0.0011140448041260242, 0.0018847783794626594, -0.011748108081519604, -0.0049505471251904964, -0.03658323734998703, 0.016121892258524895, -0.05446288362145424, -0.011294937692582607, -0.03595154732465744, 0.032600827515125275, 0.018882114440202713, -0.013244944624602795, -0.01584724336862564, 0.022589875385165215, 0.0012693930184468627, 0.010223806835711002, 0.04592130333185196, -0.014789844863116741, 0.0002774383465293795, 0.0026022987440228462, -0.01473491545766592, -0.011205676943063736, 0.010539652779698372, 0.004085402935743332, -0.018813451752066612, -0.010244405828416348, 0.043312136083841324, 0.013073289766907692, -0.00501920934766531, 0.0010179176460951567, -0.025968056172132492, 0.009118344634771347, -0.0077107688412070274, -0.007937354035675526, -0.022026844322681427, 0.008287531323730946, 0.026297636330127716, -0.03257336467504501, -0.02081838995218277, -0.019513806328177452, 0.017728589475154877, -0.0266546793282032, 0.009571515023708344, 0.020433880388736725, -0.015201819129288197, -0.02223283238708973, 0.010814301669597626, -0.006217365153133869, -0.019033171236515045, -0.023249031975865364, 0.03595154732465744, -0.011061485856771469, -0.02444375492632389, 0.0034090799745172262, 0.025995522737503052, 0.02797299437224865, 0.05006850138306618, -0.00830813031643629, 0.027506090700626373, -0.03369942307472229, 0.022521212697029114, -0.002020386280491948, 0.013533326797187328, -0.008390525355935097, 0.029662085697054863, 0.00505010737106204, 0.013746179640293121, -0.04397129639983177, 0.021656068041920662, -0.025459956377744675, 0.028371235355734825, -0.028865603730082512, 0.0007076501497067511, -0.0060388436540961266, -0.037022676318883896, 0.020365219563245773, 0.013959032483398914, -0.019884582608938217, 0.0042673577554523945, 0.02374340035021305, -0.009029083885252476, 0.03353463485836983, 0.004236459732055664, 0.03207899630069733, -0.014597591012716293, -0.012132616713643074, 0.017508869990706444, -0.00017980922712013125, 0.030705751851201057, 0.026022987440228462, -0.033479705452919006, -0.04114241153001785, 0.006052576005458832, 0.005513577256351709, -0.01722048781812191, -0.05168893188238144, 0.012022756971418858, -0.011521522887051105, -0.011274338699877262, -0.012269941158592701, -0.0008638567524030805, 0.04688257351517677, -0.0010968792485073209, 0.033287450671195984, -0.0024409424513578415, 0.059269241988658905, 0.03183181211352348, 0.005084438249468803, -0.03317759186029434, -0.021257827058434486, -0.007731367368251085, -0.015133156441152096, 0.007779431063681841, 0.031227584928274155, 0.008486651815474033, 0.006804427597671747, 0.016218019649386406, 0.023331427946686745, -0.026325101032853127, -0.002408327767625451, 0.0066018737852573395, -0.018319083377718925, 0.018978241831064224, 0.009413592517375946, 0.027561020106077194, -0.035539571195840836, 0.012366068549454212, 0.005122202914208174, -0.004184963181614876, 0.012688781134784222, -0.0021285293623805046, 0.010862365365028381, -0.018113097175955772, -0.013732447288930416, -0.018140561878681183, 0.014515195973217487, 0.021093038842082024, 0.010642645880579948, -0.004466478247195482, 0.007429253775626421]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"ix F for experimental details for diffusion model
fine-tuning tasks.
6.4.1. O BJECT GENERATION
We build our object generation experiments on a popular
stable diffusion fine-tuning repository (Ryu, 2023) with Sta-
ble Diffusion V1.5 as the base model. We follow the default
settings there and tune both the U-Net and the text encoder
where LoRA parameters are injected. For all experiments,
we fix the U-Net fine-tuning learning rate as default value
1e−4which we find important for generating recogniz-
able images. After fine-tuning on 6images of a red vase
titled “a photo of ⟨Vvase⟩”, Figure 1 shows the generation
results for prompt “a blue ⟨Vvase⟩”. With large learning rate
as1e−2for text encoder fine-tuning, AdamW produces
out-of-distribution results while our method produces satis-
factory images. With default learning rate setting, AdamW
still fails to capture the prompt information and generates
only red vases. Instead, scaled AdamW with default learn-
ing rate is able to produce the desired blue vase. AdamW
turns out to be able to generate the desired blue vase for
learning rate value such as 1e−6. See Appendix F.1 for
other target object generation including chairs and dogs.
Scaled AdamW improves AdamW for all experiments.
6.4.2. F ACE GENERATION
Face generation is a more challenging task compared to
object generation and we thus switch to Mix-of-Show (Gu
et al., 2023) variant of custom diffusion model which is orig-
inally designed for multi-concept LoRA and has been rec-
ognized to be able to generate high-quality face images. For
better visualization of differences between different LoRA
optimization methods, we turn off embedding fine-tuning
and tune only text-encoders and U-Nets where LoRA fac-
tors are injected. We use 14images of Potter provided in the
original project repository where the character name is re-
placed with ⟨Vpotter⟩in captions of the training images. Fig-
ure 3 shows generation results for prompt “a pencil sketch
of⟨Vpotter⟩” for various step sizes. Our method (scaled
AdamW) generates visually better images more resemble apencil sketch, which demonstrates its effectiveness in gen-
erating images of higher quality and also its robustness to
learning rate changes. See Appendix F.2.1 for generation
results for more prompts and also for the Hermoine charac-
ter with different LoRA parameter fusion coefficients. See
also Appendix F.2.2 for generation results including SGD
and scaled GD methods for varying learning rates. Our
observations are similar in all these generation results.
7. Convergence Theory
In this section, we further verify the superiority of scaled
GD method applied to a reparameterized two-layer ReLU
NN tuning problem, i.e., we show scaled GD method has
convergence rate independent of data condition number of
this specific problem and is thus advantageous compared to
plain gradient descent. When scaled GD is applied to deep
learning models, nonlinearities in such models typically
render theoretical analysis intractable. To tackle this, we
instead study an equivalent problem to the two-layer ReLU
neural network. We first introduce the concept of hyperplane
arrangement matrices. For a data matrix X∈Rn×dand any
arbitrary vector u∈Rd, We consider the set of diagonal
matrices
D:={diag( 1{Xu≥0})},
which takes value 1or0along the diagonals that indicate
the set of possible arrangement activation patterns for the
ReLU activation. Indeed, we can enumerate the set of sign
patterns as D={Di}P
i=1where Pis bounded by
P≤2re(n−1)
rr
forr=rank(X)(Pilanci & Ergen, 2020; Stanley et al.,
2004). The two-layer ReLU model is equivalent to the
problem below for squared loss through convexification
under mild conditions1(Mishkin et al., 2022),
min
Wi1
2∥PX
i=1DiXW i−Y∥2
F.
1The equivalence holds when the number of hidden neurons is
greater than or equal to 2Pd.
7
Riemannian Preconditioned LoRA
Figure 3. Generation results for prompt “a pencil sketch of ⟨Vpotter⟩” by Mix-of-Show model with different optimizers and various learning
rates. Our method (scaled AdamW)","[0.023338397964835167, -0.00781682226806879, 0.04987076297402382, -0.02675650641322136, -0.007186433300375938, -0.019486021250486374, 0.01350433100014925, 0.010471459478139877, -0.0485539510846138, 0.05155180022120476, -0.023716630414128304, -0.010975770652294159, -0.0603492297232151, -0.0037858353462070227, 0.02423495054244995, -0.01388956792652607, 0.01854744181036949, -0.024192923679947853, -0.03490953519940376, -0.003614229615777731, -0.005953672807663679, -0.024613182991743088, 0.02259593829512596, 0.04541601613163948, 0.0403168722987175, -0.01961209811270237, 0.020900893956422806, 0.03415307030081749, 0.05073929950594902, 0.00011524296860443428, 0.004577323794364929, -0.023814691230654716, -0.033004358410835266, -0.054325513541698456, -0.0006785435834899545, 0.0151293333619833, 0.03454530984163284, 0.03507763892412186, -0.048133693635463715, 0.019486021250486374, -0.007543653715401888, -0.05984491854906082, -0.026616418734192848, 0.034209102392196655, 0.00913363415747881, 0.021811455488204956, -0.003381335875019431, 0.011164887808263302, 0.01615196466445923, 0.01872955448925495, -0.05110352486371994, 0.0779440850019455, -0.006962295155972242, -0.07531046122312546, -0.017048517242074013, 0.0008610936929471791, 0.03479746729135513, -7.277927215909585e-05, 0.03331255167722702, -0.026560384780168533, 0.06567250937223434, -0.04236213117837906, 0.026994653046131134, -0.0029593256767839193, -0.002581092296168208, -0.01385454647243023, -0.0760389044880867, -0.007886865176260471, 0.013462305068969727, 0.04132549464702606, -0.0027754621114581823, -0.008370163850486279, 0.04905826225876808, -0.042922478169202805, -0.01454097032546997, 0.028129352256655693, 0.02416490763425827, 0.021153049543499947, 0.003764822380617261, -0.009539885446429253, 0.02147524803876877, -0.02168537676334381, 0.025243572890758514, -0.02810133621096611, -0.027330860495567322, -0.04261428862810135, -0.02216167189180851, -0.03888798877596855, -0.02682654932141304, -0.016137955710291862, -0.007991930469870567, -0.00018955444102175534, -0.021587317809462547, 0.031435392796993256, 0.020438607782125473, 0.03731902316212654, 0.030090562999248505, -0.006139287259429693, 0.05113154277205467, 0.04992679879069328, 0.018015112727880478, 0.016600240021944046, 0.0306509081274271, -0.028255430981516838, 0.033620741218328476, -0.031071167439222336, 0.004444241523742676, 0.02780715376138687, -0.02880176715552807, 0.01735670678317547, -0.061806127429008484, -0.005291764624416828, -0.024066846817731857, -0.008615314960479736, 0.0017528312746435404, -0.11251740902662277, -0.04042894020676613, -0.0024462591391056776, -0.022623956203460693, -0.004941548220813274, -0.021517273038625717, -0.006335408426821232, 0.00881844013929367, -0.013049050234258175, 0.04830179736018181, -0.013210149481892586, 0.04421127215027809, -0.03415307030081749, 0.00709887919947505, -0.0105134854093194, 0.025747884064912796, 0.019163822755217552, 0.03252806514501572, -0.038103505969047546, -0.07620701193809509, -0.003279773285612464, -0.025607796385884285, -0.01847739890217781, -0.028059309348464012, 0.02168537676334381, -0.009427815675735474, -0.026042064651846886, -0.01935994252562523, 0.022946154698729515, -0.02275003492832184, 0.01982222869992256, -0.029698319733142853, 0.05191602557897568, -0.05087938532233238, 0.041829805821180344, -0.012922972440719604, 0.022399818524718285, -0.038467731326818466, -0.040372904390096664, -0.01078665442764759, -0.021657360717654228, -0.02011640928685665, 0.028563620522618294, 0.02675650641322136, -0.0173847246915102, -0.01592782512307167, 0.05894836410880089, 0.02008839324116707, -0.032500047236680984, 0.02871771529316902, 0.03516169264912605, -0.028409525752067566, 0.03496557101607323, -0.06365526467561722, -0.012964998371899128, -0.0025600793305784464, -0.005011591594666243, -0.03193970397114754, -0.029446164146065712, 0.012005406431853771, 0.00960292387753725, -0.047657400369644165, 0.0045107826590538025, -0.02230175770819187, -0.035413846373558044, -0.013315213844180107, 0.013028036803007126, -0.048245761543512344, 0.006450979504734278, -0.04210997745394707, -0.018799597397446632, 0.00312042492441833, -0.03919617831707001, -0.004451246000826359, 0.005372314248234034, 0.009147643111646175, 0.002304421504959464, 0.08074580878019333, -0.013462305068969727, 0.023590553551912308, -0.053709134459495544, 0.10131049901247025, 0.010093226097524166, -0.0027246808167546988, -0.00648950319737196, -0.0013728468911722302, 0.031799618154764175, 0.014183749444782734, -0.06612078845500946, 0.014611013233661652, -0.016922438517212868, -0.01228557899594307, 0.00978503655642271, -0.0016976722981780767, -0.0178189929574728, 0.02723279967904091, 0.022904129698872566, 0.007396562956273556, -0.012439673766493797, -0.058892328292131424, 0.009273720905184746, -0.027765128761529922, 0.046564724296331406, 0.018197225406765938, 0.046536706387996674, -0.025929996743798256, 0.03521772474050522, 0.005365309771150351, -0.006629589945077896, -0.02919401042163372, -0.020354555919766426, 0.02496339939534664, -0.033116430044174194, 0.0055334134958684444, -0.017440758645534515, 0.053092751652002335, -0.007368545513600111, -0.011276956647634506, -0.04889015853404999, 0.0458642914891243, -0.06102164462208748, 0.01654420606791973, -0.041829805821180344, 0.02275003492832184, 0.0007630332256667316, -0.0015584613429382443, 0.02266598306596279, 0.0012292583705857396, -0.01899571903049946, 0.0032465027179569006, 0.05701517313718796, -0.019275890663266182, -0.019850244745612144, 0.015717696398496628, 0.007893869653344154, 0.0024392546620219946, -0.022399818524718285, -0.02438904531300068, -0.04659274220466614, -0.03933626785874367, 0.01053449884057045, 0.0016197492368519306, -0.005281257908791304, -0.01713256910443306, 0.02041059173643589, 0.00581358652561903, 0.012972001917660236, 0.008089990355074406, 0.041213423013687134, -0.023338397964835167, -0.006415958050638437, -0.06275871396064758, -0.008244086056947708, -0.00024033576482906938, 0.01797308772802353, -0.0023429454304277897, -0.05087938532233238, 8.0919062384055e-06, -0.0004846114607062191, -0.02500542625784874, -0.007424579933285713, 0.05522206425666809, 0.026406290009617805, -0.028269439935684204, -0.011206913739442825, -0.02015843614935875, 0.019710158929228783, 0.09111220389604568, 0.008678353391587734, -0.024108871817588806, 0.017650889232754707, -0.03003452718257904, -0.03401298075914383, -0.05101947486400604, -0.025944003835320473, -0.0007266983157023787, -0.08724582195281982, 0.03454530984163284, -0.04236213117837906, -0.004769942723214626, 0.02282007783651352, -0.028437543660402298, -0.01235562190413475, -0.014625022187829018, 0.02230175770819187, 0.049450505524873734, -0.002491787075996399, -0.020032357424497604, 0.02143322117626667, -0.03135133907198906, 0.01957007311284542, 0.029586251825094223, 0.014239784330129623, 0.021405205130577087, 0.00951186753809452, -0.018897658213973045, 0.03824359178543091, 0.007137402892112732, 0.01753881946206093, -0.0003799844125751406, 0.01957007311284542, 0.04225006327033043, -0.018421363085508347, 0.00860130600631237, -0.004321665968745947, -0.018393347039818764, -0.026840558275580406, 0.010359390638768673, -0.01410670205950737, -0.002805230440571904, 0.013994633220136166, -0.038075488060712814, 0.018533432856202126, -0.020494643598794937, -0.027022670954465866, -0.0006229467689990997, -0.006860732100903988, 0.01525541115552187, 0.02230175770819187, -0.002806981559842825, -0.02751297317445278, -0.04790955409407616, 0.02686857432126999, 0.04617248475551605, 0.019331926479935646, -0.05609060078859329, -0.03342461958527565, 0.0007792306714691222, -0.03272418677806854, 0.008125011809170246, 0.00922469049692154, 0.014905194751918316, 0.014582996256649494, 0.058556124567985535, 0.010324369184672832, -0.020578695461153984, -0.020802833139896393, 0.002388473367318511, -0.0025233065243810415, 0.021937532350420952, 0.02048063464462757, -0.0006474619149230421, -0.03622634708881378, -0.045359980314970016, 0.008089990355074406, -0.022217705845832825, 0.03135133907198906, 0.019808219745755196, 0.003670264035463333, -0.02293214574456215, 0.02791922353208065, -0.01585778221487999, 0.051299646496772766, 0.011094843968749046, -0.013154114596545696, -0.011907345615327358, 0.03874790295958519, -0.051159560680389404, 0.011578142642974854, -0.0586121566593647, 0.028311464935541153, 0.023156285285949707, 0.01574571430683136, -0.018421363085508347, 0.06018112599849701, 0.0005691010737791657, 0.014919203706085682, 0.00938578974455595, -0.022736025974154472, -0.0017388226697221398, 0.021125031635165215, 0.01013525202870369, -0.03146341070532799, -0.05048714578151703, -0.028227413073182106, 0.007767791859805584, -0.035553932189941406, -0.023464474827051163, 0.01779097504913807, 0.030538838356733322, 0.003132682526484132, -0.017370715737342834, 0.020788824185729027, 0.04676084592938423, 0.06892251968383789, -0.004440739285200834, -0.0023376920726150274, -0.05639879032969475, -0.025901978835463524, -0.017622871324419975, 0.0595647431910038, 0.012964998371899128, 0.04530394822359085, 0.012586764991283417, 0.017006490379571915, 0.0016801614547148347, -0.02780715376138687, 0.015451531857252121, -0.0412694588303566, 0.014849159866571426, -0.025019433349370956, 0.07009924203157425, 0.015801748260855675, 0.016320068389177322, 0.05597853288054466, -0.03919617831707001, -0.021279126405715942, -0.010436438024044037, -0.030734959989786148, -0.011045814491808414, 0.014211767353117466, 0.018603475764393806, 0.0019384458428248763, 0.00018594283028505743, -0.03182763233780861, -0.023058224469423294, 0.019766192883253098, 0.01489118579775095, -0.050935421139001846, -0.04477161914110184, -0.015941834077239037, 0.009140638634562492, 0.04639662057161331, 0.030931081622838974, -0.0630388855934143, 0.03653453662991524, 0.01222954411059618, -0.03499358892440796, -0.01731468178331852, -0.030090562999248505, 0.042446184903383255, -0.03328453376889229, 0.04496774077415466, 0.008902492001652718, -0.01797308772802353, -0.024879347532987595, -0.011648185551166534, 0.04003669694066048, -0.005337292328476906, 0.0027211785782128572, -0.05922853574156761, 0.08018546551465988, -0.006272369530051947, 0.04003669694066048, -0.011431051418185234, 0.03062289021909237, -0.031911686062812805, -0.035049621015787125, -0.013770494610071182, 0.0016328822821378708, 0.04059704393148422, 0.02573387511074543, 0.004815470427274704, 0.018645502626895905, -0.02525758184492588, -0.02157330885529518, -0.009007556363940239, 0.0004539675428532064, -0.0021223092917352915, -0.019808219745755196, 0.018603475764393806, 0.010023183189332485, -0.025565771386027336, 0.0224558524787426, -0.025831935927271843, 0.01804313063621521, 0.004297150764614344, 0.04524791240692139, -0.03706686571240425, 0.024977408349514008, 0.07116390019655228, 0.01288795005530119, -0.023674605414271355, -0.0048329816199839115, -0.004598336759954691, 0.0021906013134866953, -0.024487106129527092, 0.03087504580616951, -0.016614248976111412, 0.003659757785499096, -0.01888364925980568, -0.02343645691871643, -0.009182664565742016, 0.003922419622540474, -0.0071023814380168915, 0.04493972286581993, -0.01800110563635826, -0.002153828740119934, 0.01863149367272854, 0.02088688500225544, -0.005908144637942314, 0.028255430981516838, 0.03919617831707001, 0.004297150764614344, 0.03757117688655853, -0.007851843722164631, 0.06757768988609314, -0.03939229995012283, 0.022623956203460693, -0.014639031141996384, 0.04362291097640991, -0.00965895876288414, 0.020802833139896393, -0.02464120090007782, 0.021377187222242355, -0.024697234854102135, 0.00010812920663738623, -0.04709705337882042, -0.004073012620210648, 0.0021223092917352915, 0.016137955710291862, 0.004087021108716726, -0.10831481963396072, -0.04230609908699989, 0.01178827229887247, 0.02361856959760189, -0.016165971755981445, -0.002945316955447197, -0.0004215725639369339, -0.04404316842556, -0.034825485199689865, 0.010016178712248802, -0.010681589134037495, -0.0338168628513813, 0.015339463017880917, 0.02500542625784874, 0.017987096682190895, 0.0072074462659657, 0.017076535150408745, -0.008307124488055706, -0.025383658707141876, 0.030931081622838974, -0.02916599251329899, 0.01899571903049946, 0.02868969924747944, 0.02311425842344761, -0.019808219745755196, 0.00829311553388834, -0.033144447952508926, -0.03673065826296806, 0.02179744653403759, -0.014036659151315689, 0.01633407548069954, -0.007746778894215822, 0.002834998769685626, 0.0022273741196841, 0.018645502626895905, 0.013420279137790203, -0.008272103033959866, -0.007340528070926666, 0.03507763892412186, 0.0017073032213374972, -0.0060727461241185665, -0.014779116958379745, 0.023086242377758026, -0.042810410261154175, -0.0012108719674870372, 0.03647850453853607, -0.02642029896378517, 0.004006471484899521, -0.007123394403606653, 0.04129747673869133, 0.022469861432909966, -0.01975218579173088, 0.024809304624795914, -0.03897204250097275, -0.03412505239248276, -0.025607796385884285, -0.018057139590382576, -0.06785786151885986, 0.010184282436966896, -0.050683267414569855, -0.02632223814725876, -0.014625022187829018, 0.020200461149215698, 0.03252806514501572, -0.006650602910667658, -0.005302270874381065, -0.011767258867621422, -0.013868555426597595, -0.022679990157485008, 0.006279373541474342, -0.017776966094970703, 0.008216068148612976, -0.02384270913898945, 0.022539904341101646, 0.0020872876048088074, -0.008853461593389511, -0.010919736698269844, -0.001165343914180994, 0.01323116198182106, -0.04457549750804901, 0.01636209338903427, 0.007221454754471779, -0.024977408349514008, -0.026994653046131134, 0.005715525709092617, -0.016432136297225952, 0.008111003786325455, -0.019948305562138557, -0.013476313091814518, 0.002222120761871338, -0.003250004956498742, 0.060013022273778915, -0.0060272179543972015, -0.01434484962373972, -0.030342718586325645, -0.00032920308876782656, 0.00663309171795845, 0.032864272594451904, 0.03454530984163284, -0.00021264680253807455, -0.035301778465509415, -0.012299587950110435, -0.003929424099624157, -0.04676084592938423, -0.01150109525769949, 0.007655722554773092, -0.0183373112231493, -0.0005673500127159059, -0.0169504564255476, 0.0086923623457551, -0.05412939190864563, -0.01226456556469202, -0.029866423457860947, 0.006790689192712307, 0.01858946681022644, -0.018575459718704224, -0.027835171669721603, -0.004041492938995361, -0.0021888501942157745, -0.00661558099091053, -0.01993429660797119, -0.017847009003162384, -0.022497879341244698, -0.043286703526973724, -0.0320797897875309, 0.017650889232754707, 0.019093777984380722, 0.01658623106777668, 0.016824379563331604, -0.0072074462659657, -0.016572223976254463, -0.006804697681218386, 0.03244401514530182, -0.029222026467323303, -0.004591332282871008, -0.024375036358833313, 0.0006054359837435186, 0.020536668598651886, -0.005025600083172321, -0.02252589538693428, 0.03426513820886612, -0.006804697681218386, -0.03600221127271652, 0.037234969437122345, 0.005011591594666243, 0.02336641401052475, 0.0073335240595042706, -0.012565751560032368, -0.019668133929371834, -0.018323304131627083, -0.030538838356733322, -0.00794290006160736, 0.011851310729980469, -0.017580846324563026, 0.03037073463201523, -0.05519405007362366, -0.0028490074910223484, 0.008552275598049164, 0.012313595972955227, 0.024319002404808998, -0.03244401514530182, -0.024262968450784683, -0.022371800616383553, -0.00650701392441988, 0.01069559808820486, 0.027526980265975, 0.0016363845206797123, 0.01822524331510067, 0.032752204686403275, -0.01683838665485382, 0.039056092500686646, -0.026616418734192848, -0.05681905150413513, -0.005845105741173029, 0.03871988505125046, 0.010485468432307243, -0.0035704525653272867, 0.0022133653983473778, -0.01972416788339615, -0.015297437086701393, 0.010520489886403084, 0.04216601327061653, -0.025425685569643974, -0.00028323722654022276, -0.0054178424179553986, -0.022736025974154472, 0.006909762509167194, -0.03740307316184044, 0.015339463017880917, 0.04804963991045952, 0.0036072253715246916, -0.0018596472218632698, -0.003726298687979579, -0.026266204193234444, -0.02118106558918953, -0.038103505969047546, 0.007697748485952616, 0.0032622625585645437, -0.023632578551769257, -0.03866385295987129, 0.019107786938548088, -0.02004636637866497, 0.025201546028256416, 0.017987096682190895, 0.014302823692560196, 0.02300219051539898, -0.0008899865206331015, -0.017160587012767792, 0.03163151443004608, 0.001231884933076799, -0.0003440872533246875, -0.00900055281817913, -0.00816703774034977, -0.005354803521186113, -0.008300120010972023, -0.04000868275761604, 0.03401298075914383, 0.005011591594666243, 0.011052818037569523, 0.018393347039818764, 0.01178827229887247, -0.0005047488957643509, 0.007977921515703201, -0.012222539633512497, 0.013616399839520454, -0.011585147120058537, -0.01410670205950737, -0.009764023125171661, 0.003316545858979225, 0.04194187372922897, 0.008314128965139389, 0.011704220436513424, 0.01053449884057045, 0.01954205520451069, 0.0007669731276109815, 0.007277489639818668, 0.01319614052772522, 0.008916500955820084, -0.0019401968456804752, 0.0210269708186388, -0.01235562190413475, -0.0010016178712248802, 0.006804697681218386, -0.03123927116394043, -0.01026132982224226, 0.0061567979864776134, 0.031211253255605698, 0.05412939190864563, -0.02048063464462757, 0.036618590354919434, -0.016922438517212868, -0.0022799065336585045, 0.022245723754167557, -0.019640116021037102, 0.027162756770849228, -0.00865734089165926, 0.003169455099850893, 0.0028665182180702686, -0.023030206561088562, -0.01658623106777668, -0.006013209465891123, -0.001165343914180994, -0.042081959545612335, -0.024403054267168045, 0.006983308121562004, 0.024319002404808998, -0.0030608882661908865, 0.009175660088658333, 0.03782333433628082, -0.025089478120207787, -0.11868121474981308, -0.006682122126221657, 0.013497326523065567, -0.02748495526611805, 0.01476510800421238, -0.007991930469870567, 0.009035574272274971, -0.0112279262393713, -0.00872738379985094, 0.01454097032546997, -0.004258627071976662, -0.046340588480234146, -0.0210269708186388, -0.0006986809894442558, 0.05995698645710945, -0.03586212173104286, -0.01884162239730358, -0.0467328280210495, 0.02864767238497734, -0.015703687444329262, -0.016964465379714966, -0.021265117451548576, 0.00311166956089437, -0.0060412269085645676, -0.03037073463201523, -0.05222421512007713, -0.01101079210639, -0.006846723612397909, 0.02366059646010399, -0.005536915734410286, 0.013938598334789276, -0.03496557101607323, 0.035890139639377594, 0.025887969881296158, -0.03535781055688858, -0.009778032079339027, -0.004062505904585123, 0.020550677552819252, 0.03729100525379181, 0.02989444136619568, 0.01800110563635826, -0.033116430044174194, 0.038803938776254654, -0.014428901486098766, 0.013644416816532612, 0.014737091027200222, -0.006450979504734278, -0.009918118827044964, 0.012509716674685478, -0.02132115326821804, 0.02092891000211239, -0.0037928398232907057, -0.00931574683636427, -0.00829311553388834, -0.012684824876487255, -0.016978474333882332, -0.0074105714447796345, -0.012019414454698563, -0.012250557541847229, 0.005869620945304632, 0.011963380500674248, 0.035441864281892776, 0.010646567679941654, -0.008237081579864025, -0.0187715794891119, -0.023198310285806656, 0.008496241644024849, 0.013441291637718678, 0.014078685082495213, -0.03546988219022751, -0.0009490854572504759, 0.029754355549812317, -0.007613696623593569, 0.0013684692094102502, -0.00978503655642271, -0.037234969437122345, 0.025691848248243332, 0.03317246213555336, -0.024333011358976364, 0.022539904341101646, 0.04505179077386856, -0.021923525258898735, 0.001221378450281918, -0.012089458294212818, -0.014639031141996384, 0.05984491854906082, 0.011809284798800945, -0.017875026911497116, -0.014807133935391903, 0.025901978835463524, 0.04283842816948891, -0.038327645510435104, -0.00017324750660918653, 0.00481196865439415, -0.005067626014351845, -0.030566856265068054, -0.008054968900978565, 0.030538838356733322, 0.03462936356663704, 0.004689392633736134, 0.023128267377614975, 0.006016711704432964, -0.02712072990834713, -0.028339482843875885, 0.009273720905184746, 0.01253773458302021, 0.026798531413078308, -0.001035763998515904, 0.029810389503836632, -0.017776966094970703, 0.008082985877990723, -0.01031736470758915, -0.01895369216799736, 0.015157350338995457, -0.013385257683694363, 0.03532979637384415, 0.054913874715566635, 0.010954758152365685, 0.01836532913148403, -0.012488704174757004, 0.03684272617101669, -0.002162584103643894, -0.0033323056995868683, 0.0237586572766304, -0.03171556442975998, -0.033144447952508926, -0.005873123183846474, 0.006475494708865881, -0.024487106129527092, -0.0019384458428248763, 0.01040842104703188, 0.0016433887649327517, 0.012110470794141293, 0.028605647385120392, -0.031547460705041885, -0.0012747864238917828, 0.02248387038707733, 0.017762957140803337, -0.020788824185729027, 0.016922438517212868, -0.0010576524073258042, 0.01888364925980568, 0.02868969924747944, -0.020872876048088074, 0.01323116198182106, 0.0033305545803159475, -0.0021030474454164505, -0.045836277306079865, 0.020830851048231125, 0.029474182054400444, 0.02967030368745327, 0.006174308713525534, 0.013749482110142708, 0.005064124241471291, 0.040260836482048035, 0.022609947249293327, 0.006979805883020163, -0.027064695954322815, -0.007655722554773092, 0.013294201344251633, 0.03600221127271652, 0.03219185769557953, -0.004381202626973391, -0.008209063671529293, -0.00048067152965813875, -0.033592723309993744, -0.014148727990686893, -0.0030591371469199657, -0.03757117688655853, 0.003614229615777731, -0.013336227275431156, -0.04166170209646225, 0.020382573828101158, 0.012278574518859386, 0.01423277985304594, 0.005943166092038155, 0.006247854325920343, 0.0035722036845982075, -0.011907345615327358, 0.04550006985664368, -0.005445859394967556, 0.02518753707408905, -0.017258645966649055, -0.028115343302488327, 0.03247203305363655, -0.009091608226299286, -0.008307124488055706, -0.007053351029753685, 0.007242467720061541, 0.012831916101276875, -0.016866404563188553, 0.01615196466445923, 0.0005187575006857514, 0.027975257486104965, 0.048974212259054184, -0.007956908084452152, -0.004097527824342251, 0.028773751109838486, -0.011991397477686405, -0.031547460705041885, -0.030678926035761833, 0.013336227275431156, -0.00881844013929367, -0.020732790231704712, -0.05247637256979942, 0.03261211887001991, -0.00563147384673357, 0.009630940854549408, -0.01683838665485382, 0.024669218808412552, 0.0137634901329875, 0.04000868275761604, -0.005918651353567839, 0.018379338085651398, 0.0356379859149456, 0.0001915244065457955, 0.02532762475311756, 0.00609726132825017, -0.02992245927453041, -0.04096126928925514, -0.021965550258755684, -0.04964662715792656, -0.019710158929228783, 0.016432136297225952, -0.024290984496474266, 0.02095692791044712, 0.02577590011060238, 0.0007407069206237793, -0.0067871869541704655, 0.002955823438242078, 0.0007240716950036585, -0.014400883577764034, -0.023086242377758026, 0.01253773458302021, 0.008237081579864025, -0.019738176837563515, -0.025313615798950195, 0.0006964921485632658, 0.007809817790985107, 0.011346999555826187, 0.030790993943810463, 0.004713907837867737, -0.00035678260610438883, -0.04373497888445854, 0.0010305107571184635, -0.0012966749491170049, -0.015115324407815933, 0.023310380056500435, -0.04152161255478859, 0.02113904058933258, -0.011641181074082851, -0.0102963512763381, 0.03970048949122429, -0.017664898186922073, 0.004139553755521774, 0.02541167661547661, 0.017833001911640167, 0.0605173334479332, 0.029250044375658035, 0.030847029760479927, -0.02504745125770569, 0.019261881709098816, 0.023492492735385895, -0.023562535643577576, 0.0015427017351612449, -0.03235996142029762, 0.009343763813376427, 0.003176459576934576, 0.010555511340498924, 0.017104551196098328, 0.0004579074739012867, 0.020466625690460205, 0.017482785508036613, 0.023786673322319984, -0.0013080568751320243, 0.007158415857702494, 0.041101355105638504, -0.004349683411419392, 0.038327645510435104, 0.026742497459053993, -0.033844877034425735, -0.02730284258723259, -0.014281810261309147, -0.014849159866571426, 0.027975257486104965, -0.02682654932141304, -0.005498392041772604, -0.006906260270625353, 0.053849220275878906, 0.031155219301581383, -0.0015400750562548637, 0.020802833139896393, -0.02707870490849018, -0.0187715794891119, 0.02525758184492588, -0.0015829765470698476, -0.003691277001053095, -0.0030626393854618073, 0.03177160024642944, -0.015269419178366661, 0.019458003342151642, 0.001417499384842813, 0.026000039651989937, -0.05121559277176857, 0.033984966576099396, 0.0036072253715246916, 0.006622585467994213, -0.0548858568072319, -0.017622871324419975, -0.0073335240595042706, 0.0041955881752073765, 0.0077257659286260605, 0.021377187222242355, 0.042446184903383255, 0.005869620945304632, -0.0008260721224360168, -0.021657360717654228, 0.004339176695793867, -0.002980338642373681, -0.01047846395522356, 0.011122861877083778, 0.005379318259656429, 0.010247321799397469, 0.016193989664316177, -0.02864767238497734, -0.008054968900978565, -0.043762996792793274, 0.0014210016233846545, 0.014372866600751877, 0.041465580463409424, 0.026798531413078308, -0.011683207005262375, -0.012607777491211891, 0.016207998618483543, -0.0160819198936224, -0.0035722036845982075, -0.022539904341101646, -0.005270751658827066, -0.01870153658092022, -0.014877177774906158, 0.019289899617433548, 0.00717242481186986, 0.00475593376904726, 0.018813606351614, -0.014127715490758419, 0.01709054224193096, -0.0039259218610823154, 0.028493577614426613, 0.019696149975061417, 0.005701517220586538, 0.06483199447393417, -0.014961229637265205, 0.016502179205417633, 0.01334323175251484, -0.002497040433809161, 0.06152595579624176, -0.006202326156198978, -0.024361027404665947, -0.024150898680090904, -0.005680504254996777, 0.009806049056351185, 0.017720932140946388, -0.017959078773856163, -0.01990628056228161, 0.05827594920992851, 0.009778032079339027, -0.04905826225876808, 0.016488172113895416, 0.011760254390537739, 0.03353668749332428, 0.04140954464673996, 0.017720932140946388, -0.0169504564255476, -0.029866423457860947, 0.015773730352520943, 0.02989444136619568, 0.0027807154692709446, 0.0048715053126215935, 0.027330860495567322, 0.026406290009617805, -0.01935994252562523, -0.011346999555826187, -0.02398279495537281, 0.011900341138243675, -0.012558747082948685, 0.0028385010082274675, 0.0014096195809543133, -0.006769676227122545, 0.00481196865439415, -0.007291498128324747, -0.009834066964685917, -0.027036678045988083, -0.019415978342294693, 0.012173510156571865, -0.018141191452741623, 0.01760886237025261, 0.026126116514205933, 0.009651954285800457, 0.00781682226806879, 0.015353471040725708, 0.03919617831707001, 0.004839985631406307, 0.015549592673778534, -0.0030556349083781242, 0.013735473155975342, -0.018435372039675713, -0.01906576193869114, 0.03406901657581329, 0.011143874377012253, -0.008776414208114147, -0.021265117451548576, 0.011970384046435356, -0.02186748944222927, 0.024669218808412552, -0.02602805569767952, -0.03684272617101669, -0.024319002404808998, 0.012068444862961769, -0.02314227633178234, 0.011690211482346058, -0.014022650197148323, -0.04998283460736275, 0.024767279624938965, -0.025425685569643974, 0.008888483047485352, 0.028969870880246162, -0.02409486472606659, 0.015003255568444729, 0.017720932140946388, 0.05737939849495888, -0.016250023618340492, -0.02992245927453041, -0.027316851541399956, -0.0035634483210742474, -0.018561450764536858, -0.015185367316007614, 0.04194187372922897, 0.022035593166947365, -0.05653887987136841, 0.0265323668718338, -0.002675650641322136, 0.015773730352520943, 0.038187555968761444, -0.0023166791070252657, -0.037963420152664185, -0.007242467720061541, -0.020200461149215698, -0.010779649950563908, -0.0037578181363642216, -0.004251622594892979, -0.01040842104703188, 0.024501115083694458, 0.0086923623457551, 0.01188633218407631, -0.009238699451088905, 0.0033130438532680273, -0.03451729193329811, -0.03611427918076515, -0.007788804825395346, 0.014498944394290447, 0.0018719047075137496, -0.003440872533246875, 0.0365905724465847, 0.028045300394296646, -0.006104265805333853, 0.01968214102089405, -0.017048517242074013, 0.06965097039937973, -0.0038523764815181494, -0.05749146640300751, 0.011459069326519966, 0.026966635137796402, 0.009721997193992138, 0.008398180827498436, -0.021713394671678543, 0.012747864238917828, -0.00947684608399868, -0.03235996142029762, -0.024038828909397125, 0.022469861432909966, -0.023338397964835167, 0.0026791526470333338, 0.013329222798347473, -0.0019191838800907135, -0.01494722068309784, 0.02045261673629284, -0.015213385224342346, -0.010233312845230103, -0.018939683213829994, -0.019093777984380722, 0.027765128761529922, 0.013931593857705593, -0.0016845391364768147, -0.005992196500301361, 0.01150109525769949, -0.0008422695682384074, 0.021377187222242355, -0.0008606559131294489, -0.029025906696915627, 0.007361541036516428, -0.015703687444329262, -0.007746778894215822, -0.018785588443279266, 0.0169504564255476, -0.0063494169153273106, -0.013000019825994968, -0.012180513702332973, -0.0411854051053524, 0.007221454754471779, -0.015773730352520943, 0.014625022187829018, -0.007753783371299505, 0.017468776553869247, 0.028857802972197533, 0.04152161255478859, -0.0144148925319314, -0.02550973743200302, -0.0008895487408153713, 0.021657360717654228, -0.013154114596545696, 0.0007801062311045825, 0.009392794221639633, 0.006510516162961721, -0.0018596472218632698, -0.003929424099624157, -0.02821340411901474, -0.010212299413979053, 0.016376102343201637, -0.02172740362584591, 0.029362112283706665, -0.016250023618340492, -0.009539885446429253, 0.014428901486098766, -0.0141977583989501, -0.017552828416228294, -6.03575463173911e-05, 0.030594874173402786, 8.4954754129285e-06, -0.0013457051245495677, -0.026252195239067078, 0.011837302707135677, -0.025635814294219017, 0.011213918216526508, 0.010940749198198318, 0.022189687937498093, 0.036870744079351425, 0.013063058257102966, 0.009988161735236645, 0.002325434470549226, 0.015773730352520943, 0.00975001510232687, -0.030706942081451416, -0.004626353736966848, -0.013749482110142708, -0.014169741421937943, -0.00887447502464056, 0.006738156545907259, 0.02186748944222927, 0.038075488060712814, -0.006899256259202957, -0.0005909895990043879, -0.03221987560391426, 0.012936980463564396, 0.03401298075914383, 0.009539885446429253, -0.004507280420511961, 0.022315766662359238, 0.007683739997446537, -0.03174358233809471, -0.005599954631179571, -0.0016889169346541166, 0.006916766986250877, 0.02420693263411522, 0.004339176695793867, -0.0347694493830204, 0.01606791280210018, 0.017300672829151154, 0.013385257683694363, 0.003827861277386546, 0.041829805821180344, 0.022764042019844055, -0.02493538148701191, 0.005680504254996777, 0.00543885538354516, -0.025719866156578064, 0.0029137975070625544, -0.02118106558918953, 0.005627972073853016, -0.005561430938541889, -0.008433202281594276, -0.02084485813975334, 0.03560996800661087, -0.006174308713525534, 0.003440872533246875, -0.01239064335823059, 0.027064695954322815, 0.012964998371899128, 0.014639031141996384, -0.04709705337882042, 0.00975001510232687, -0.012838920578360558, -0.0019331926014274359, -0.009210681542754173, -0.03039875254034996, -0.00011524296860443428, -0.02955823391675949, 0.011171892285346985, -0.031099185347557068, -0.0007949903956614435, 0.047181107103824615, -0.014933211728930473, -0.006916766986250877, 0.011907345615327358, -0.002265897812321782, 0.006356421392410994, 0.01760886237025261, -0.028409525752067566, 0.005473876837641001, 0.0049100290052592754, -0.020942918956279755, 0.0013956109760329127, -0.001327318837866187, 0.002509298035874963, -0.012054435908794403, -0.003838367760181427, 0.02350650168955326, -0.004304155241698027, -0.0033568209037184715, 0.008279107511043549, -0.02420693263411522, 0.006244352087378502, 0.010688593611121178, -0.02880176715552807, -0.013938598334789276, 0.008237081579864025, 0.02664443664252758, -0.019920289516448975, -0.011613164097070694, -0.011031805537641048, 0.019892271608114243, -0.026014048606157303, 0.03283625468611717, 0.0057575516402721405, -0.00570501945912838, -0.02846555970609188, 0.01629205048084259, 0.010163269937038422, -0.0030223645735532045, 0.008433202281594276, 0.024627191945910454, -0.005515902768820524, -0.0005485258880071342, 0.005508898291736841, 0.023226328194141388, 0.029137974604964256, 0.059396639466285706, -0.013560364954173565, 0.04129747673869133, -0.012789890170097351, 0.022329775616526604, 0.02029852196574211, 0.006899256259202957, -0.00672414805740118, 0.03283625468611717, 0.0026423800736665726, 0.028059309348464012, -0.01599786803126335, 0.017300672829151154, -0.02894185483455658, 0.023212319239974022, -0.00841919332742691, 0.005319781601428986, -0.015549592673778534, 0.014043663628399372, 0.013973619788885117, 0.017692914232611656, -0.05460568517446518, -0.01314010564237833, 0.024304993450641632, -0.020214470103383064, 0.04070911183953285, 0.01935994252562523, 0.043875064700841904, -0.01232060045003891, 0.0006767925224266946, 0.02803129144012928, 0.008054968900978565, 0.014211767353117466, 0.036254364997148514, -0.021279126405715942, -0.020144427195191383, -0.018561450764536858, 0.007466605864465237, -0.01854744181036949, -0.025271588936448097, 0.027176765725016594, -0.030931081622838974, -0.011066826991736889, -0.019303908571600914, -0.0007236339151859283, 0.027526980265975, 0.025495728477835655, 0.002757951384410262, -0.015465540811419487, 0.03863583505153656, 0.01489118579775095, -0.005873123183846474, -0.027288833633065224, -0.027344869449734688, -0.0076487185433506966, -0.02660241164267063, -0.0008667847141623497, 0.04210997745394707, -0.0007192561752162874, 0.01514334138482809, 0.017300672829151154, -0.0014332591090351343, -0.0347694493830204, -0.020074384286999702, 0.016418127343058586, 0.01031736470758915, 0.035189706832170486, 0.024290984496474266, -0.00514817563816905, -0.02821340411901474, -0.01636209338903427, -0.03737505525350571, -0.03569401800632477, 0.01815520040690899, -0.006009707227349281, 0.006920269224792719, -0.03051082231104374, 0.005340794567018747, -0.025873960927128792, -0.00197696965187788, -0.004381202626973391, 0.0069903121329844, 0.0021310646552592516, 0.003001351607963443]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" generates photos better capturing the prompt, i.e., a pencil sketch, and is more robust to learning rate
choices. See Section 6.4.2 for experimental details.
Therefore, we base our analysis on fine-tuning the above
model and show that the convergence rate of problem below
with scaled GD method (Algorithm 2) has no dependence
on condition number of the data matrix X. We focus on
min
Ai,Bi1
2∥PX
i=1DiX(Wi+AiBT
i)−Y∥2
F, (3)
where X∈Rn×d, Ai∈Rd×r, Bi∈Rc×r, Y∈Rn×c.
We consider the response model Y=PP
i=1DiX(Wi+
Ai
⋆Bi
⋆T). Here, Xi
⋆=Ai
⋆Bi
⋆T=Ui
⋆Σi
⋆Vi
⋆Tare fixed and
unknown matrices with Ui
⋆Σi
⋆Vi
⋆Tbeing the singular value
decomposition of Xi
⋆. Denote Fi
⋆= [Ai
⋆, Bi
⋆]TandFi
t=
[Ai
t, Bi
t]TwithAi
tandBi
tdenote the value of (Ai, Bi)at
t-th iteration. Let σr(·)denote the r-th largest singular
value.
We first introduce the definition of Restricted Isometry Prop-
erty (RIP) and illustrate the assumptions required for our
theorem to hold,
Definition 7.1. (RIP (Recht et al., 2010)) The matrix A∈
Rn×dsatisfies rank- rRIP with a constant δr∈[0,1)if for
all matrices M∈Rd×cof rank at most r, the below holds,
(1−δr)∥M∥2
F≤ ∥AM∥2
F≤(1 +δr)∥M∥2
F.
Assumption 7.2. Suppose that DiXobeys the 2r-RIP
with a constant δi
2rfor each i, and∥XTDiTDjX∥2≤
min(δi
2r∥Xi
⋆∥F
P∥Xj
⋆∥F,0.12
7P(P+1))for any j̸=i.
Note for matrix Xwith i.i.d Gaussian entries
N(0,1/d∥Di∥0),DiXsatisfies RIP for a constant δ
when∥Di∥0is on the order of r(d+c)/(dδ2). See (Recht
et al., 2010) for other measurement ensembles satisfying
the RIP property. Note also ∥XTDiTDjX∥2≤ ∥XTX∥2
for all (i, j)’s. Thus bounding ∥XTDiTDjX∥2amounts
to bounding largest singular value of empirical covariancematrix. We consider a specific initialization strategy here
which is an extension of spectral initialization for multiple
terms as below,
Definition 7.3. (Extended Spectral Initialization) Let
Ai
0Bi
0Tbe the best rank- rapproximation of (DiX)T(Y−PP
j=1DjXW j)for each i.
Now, we are ready to state our main convergence result as
follows,
Theorem 7.4. Under Assumption 7.2 with δi
2r≤0.01for
each i. With extended spectral initialization described in
Definition 7.3, ∥Ai
tBi
tT−Xi
⋆∥F≤1.5dist(Fi
t, Fi
⋆). In
addition, if the step size 0< η≤2/3, then the (t+ 1) -th
iteration Fi
t+1satisfies
max
i(dist(Fi
t+1, Fi
⋆))≤(1−0.5η) max
i(dist(Fi
t, Fi
⋆)).
Proof. See Appendix B.
Our result mainly builds on results from (Tong et al., 2021b)
and can be viewed as an extension of matrix sensing to
ReLU neural networks.
","[-0.00591804925352335, -0.010705387219786644, 0.017628513276576996, 0.02425408363342285, -0.031210271641612053, 0.0015365438302978873, 0.0068834517151117325, 0.016861481592059135, -0.039753422141075134, 0.05665457621216774, -0.006903288885951042, 0.01892453245818615, -0.0487726591527462, 0.014256216585636139, 0.008457190357148647, -0.018567467108368874, 0.03763747215270996, -0.005081587471067905, -0.04316539317369461, -0.016068000346422195, -0.006863614544272423, -0.03946247696876526, 0.040520451962947845, 0.019281599670648575, 0.027956996113061905, -0.0034648689907044172, 0.04924875125288963, 0.03549507260322571, 0.0694560781121254, -0.010434281080961227, -0.020961135625839233, -0.024584701284766197, -0.038060661405324936, -0.08421483635902405, -0.03851030021905899, 0.0663350522518158, 0.027851199731230736, 0.03925088420510292, -0.040494002401828766, 0.027216413989663124, 0.019506419077515602, 0.024875644594430923, -0.0864894762635231, 0.03454289212822914, 0.0043277801014482975, -0.011769975535571575, -0.008873768150806427, -0.003888059174641967, 0.004992320667952299, 0.025814596563577652, -0.04789983108639717, 0.0550147145986557, -0.0243863295763731, -0.022653896361589432, -0.005329550709575415, 0.0047245207242667675, 0.02912076935172081, 0.014071071520447731, 0.0204850472509861, -0.05125890299677849, 0.060092996805906296, -0.0347280390560627, 0.028803376480937004, -0.03076063096523285, -0.01585640385746956, 0.004383984953165054, -0.05882342532277107, 0.03456934168934822, 0.04898425564169884, 0.027216413989663124, -0.06998506188392639, -0.0171656496822834, 0.05049186944961548, 0.0006232135929167271, -0.014838103204965591, 0.008133185096085072, -0.017602063715457916, 0.05260781943798065, 0.041261035948991776, -0.01735079474747181, 0.046021923422813416, -0.010454118251800537, 0.047555990517139435, -0.02192653715610504, -0.00025519522023387253, -0.06141546741127968, -0.014031397178769112, -0.041975170373916626, -0.05128535255789757, 0.028485985472798347, -0.00041389151010662317, 0.020815663039684296, 0.011650952510535717, 0.02135787531733513, 0.024135060608386993, -0.009667249396443367, 0.04223966225981712, 0.002020071493461728, -0.0023143209982663393, 0.011498868465423584, -0.0005517175886780024, 0.026290686801075935, 0.06734012812376022, -0.040626250207424164, 0.04300669580698013, 0.0012803154531866312, -0.019466744735836983, 0.009720147587358952, -0.023381253704428673, 0.008437353186309338, -0.0007505012326873839, 0.002805287716910243, -0.01138645876199007, 0.02585427090525627, -0.012166716158390045, -0.11098160594701767, -0.10050765424966812, 0.01344289816915989, -0.007888528518378735, 0.013581757433712482, -0.001097649335861206, 0.011968345381319523, 0.016782132908701897, 0.01450748648494482, 0.024915318936109543, -0.03126316890120506, 0.03568021580576897, -0.050042230635881424, 0.0017092913622036576, -0.013647881336510181, 0.027771851047873497, 0.02594684436917305, 0.03390810638666153, -0.01580350659787655, -0.031236721202731133, -0.01019623689353466, 0.005947805009782314, 0.042133867740631104, 0.01343628577888012, -0.02352672629058361, -0.024531802162528038, 0.011207926087081432, -0.0204189233481884, 0.004112878814339638, -0.008040612563490868, 0.03634145110845566, -0.04115523770451546, 0.04324473813176155, -0.0010414443677291274, 0.027295762673020363, -0.04583678022027016, 0.023235782980918884, -0.013118893839418888, 0.012841175310313702, -0.0089729530736804, -0.022627446800470352, -0.01978413760662079, 0.05919371917843819, 0.007419051602482796, -0.023923465982079506, 0.0005124567542225122, 0.053903840482234955, 0.001982050482183695, -0.0061362567357718945, 0.038774795830249786, 0.031157372519373894, -0.03308817744255066, -0.01955931819975376, -0.0520259365439415, -0.05485601723194122, 0.01893775723874569, 0.017059851437807083, -0.023010961711406708, -0.029253017157316208, 0.04869331419467926, 0.01725822128355503, -0.03203020244836807, -0.010751673951745033, 0.004043449182063341, -0.03158056363463402, -0.01649118959903717, -0.022653896361589432, 0.006116419564932585, 0.025021115317940712, -0.027824750170111656, 0.030496137216687202, 0.015552236698567867, 0.010110276751220226, 0.015010024420917034, -0.04157843068242073, 0.009878844022750854, 0.02679322473704815, 0.02668742649257183, 0.006754511035978794, 0.007266967557370663, -0.04078494757413864, 0.02363252267241478, -0.0027127147186547518, -0.002145706210285425, 0.005445266608148813, -0.009495328180491924, 0.028591781854629517, -0.001205099979415536, -0.018276523798704147, 0.0024432616773992777, 0.005309713538736105, 0.007756281178444624, 0.0044368840754032135, -0.050782814621925354, 0.008020775392651558, 0.009230834431946278, -0.029676206409931183, 0.023235782980918884, -0.01715242490172386, -0.0017175567336380482, 0.042080968618392944, -0.04398532211780548, 0.020656967535614967, 0.017853332683444023, 0.05168209224939346, -0.009435816667973995, 0.02057761885225773, 0.006817328277975321, -0.004255044274032116, -0.027322212234139442, 0.004367454443126917, 0.06056908518075943, -0.0011439358349889517, 0.024108611047267914, -0.03245339170098305, 0.05586109682917595, -0.02365897223353386, -0.003289641812443733, -0.012827950529754162, 0.02278614230453968, -0.042160313576459885, -0.024915318936109543, -0.03557441756129265, -0.008133185096085072, -0.020154429599642754, 0.007901753298938274, 0.03687043860554695, 0.015062923543155193, -0.02589394524693489, 0.0003047877980861813, 0.02428053319454193, -0.015935752540826797, 0.0068834517151117325, -0.010950043797492981, 0.040573351085186005, -0.036553047597408295, -0.01896420679986477, 0.008748132735490799, -0.042186763137578964, -0.047476641833782196, -0.012689091265201569, -0.012312187813222408, 0.006205686368048191, -0.044487860053777695, 0.014388464391231537, -0.01733756996691227, 0.016901155933737755, -0.024597926065325737, -0.007002473808825016, -0.0050749750807881355, -0.02361929789185524, -0.024174734950065613, 0.010864083655178547, 0.02688579633831978, -0.02433343231678009, 0.007366152945905924, 0.00631478987634182, -0.013846251182258129, 0.003997162915766239, -0.03070773370563984, 0.004321167711168528, 0.021794291213154793, 0.03676464036107063, -0.06495968252420425, 0.0008021601825021207, 0.024174734950065613, 0.023288680240511894, 0.06940317898988724, 0.03885414078831673, 0.00032462485251016915, -0.02585427090525627, -0.05612558871507645, 0.0036963012535125017, -0.030178744345903397, -0.02347382716834545, 0.002585427137091756, -0.07014375925064087, 0.020696641877293587, -0.011485644616186619, -0.00938953086733818, -0.005855232011526823, -0.025470755994319916, -0.02516658790409565, -0.001851456705480814, -0.009680474177002907, 0.026105539873242378, 0.012391535565257072, -0.036447249352931976, 0.04009726271033287, -0.04898425564169884, 0.039753422141075134, -0.008556375280022621, 0.03544217348098755, -0.012113817036151886, 0.034146152436733246, -0.0024234247393906116, 0.03245339170098305, -0.01651763916015625, 0.04424981772899628, -0.02922656759619713, -0.009488715790212154, 0.05676037445664406, -0.04311249405145645, 0.013323876075446606, -0.003326009726151824, -0.03361716493964195, -0.06432490050792694, -0.01450748648494482, -0.002605264075100422, 0.021847190335392952, 0.0188584104180336, -0.04015016183257103, -0.0020994197111576796, 0.011346785351634026, -0.024518577381968498, -0.0049890149384737015, 0.01729789562523365, 0.02838018722832203, -0.018369095399975777, -0.028935624286532402, -0.01810460165143013, -0.03557441756129265, 0.006060214713215828, 0.03311462700366974, 0.030099397525191307, -0.05340130254626274, -0.02906787022948265, -0.01145258266478777, 0.016927605494856834, 0.014229767955839634, 0.024756621569395065, -0.007452113553881645, 0.02609231509268284, 0.06913868337869644, 0.028724029660224915, -0.03533637523651123, -0.02363252267241478, -0.010024315677583218, 0.0085828248411417, -0.009654024615883827, -0.0008546456811018288, -0.006496629677712917, -0.017694637179374695, -0.02602619118988514, -0.040520451962947845, -0.03525702655315399, -0.016914380714297295, 0.06839810311794281, 0.013475960120558739, -0.012966809794306755, 0.031871505081653595, -0.06570026278495789, 0.020114755257964134, 0.02209845930337906, 0.019956059753894806, -0.029411712661385536, 0.05281941592693329, -0.033405568450689316, 0.012788276188075542, -0.04969839006662369, -0.018474893644452095, 0.001175344455987215, 0.027189964428544044, 0.04633931815624237, 0.02138432487845421, 0.0025027727242559195, 0.011935283429920673, 0.010374770499765873, -0.009085362777113914, -5.101321221445687e-05, 0.03232114389538765, -0.013310651294887066, -0.034225501120090485, -0.03361716493964195, 0.004608804825693369, -0.007723219692707062, -0.005901518277823925, -0.03618275374174118, 0.007518236991018057, 0.007372765336185694, -0.026621302589774132, -0.036658842116594315, 0.042028069496154785, 0.06369011104106903, 0.055437903851270676, -0.027666054666042328, -0.02986135333776474, -0.03753167390823364, -0.025682350620627403, -0.002124215941876173, 0.03708203509449959, 0.04144618287682533, 0.05422123521566391, 0.030072947964072227, 0.04067914932966232, -0.008007550612092018, -0.010546690784394741, 0.010348320938646793, -0.027348661795258522, 0.008430740796029568, -0.02670065127313137, 0.010943432338535786, 0.04030885919928551, -0.008642335422337055, 0.06950897723436356, -0.01097649335861206, -0.009449041448533535, -0.0567074753344059, -0.04824367165565491, -0.0469476543366909, 0.044567208737134933, -0.010097051970660686, -0.014295890927314758, 0.027930548414587975, -0.03467513993382454, 0.018289748579263687, 0.049830637872219086, 0.013535471633076668, -0.04633931815624237, -0.05268716812133789, -0.0013753678649663925, 0.0485081672668457, 0.006936350371688604, 0.014811653643846512, -0.04377372935414314, 0.02371187135577202, -0.008344779722392559, -0.017668187618255615, -0.01821039989590645, 0.010315258987247944, 0.0456516332924366, -0.04242480918765068, -0.007359540555626154, -0.015036473982036114, 0.024174734950065613, -0.011121965013444424, -0.019122904166579247, 0.07834307104349136, 0.008457190357148647, -0.004641866777092218, -0.07506334781646729, 0.04541359096765518, -0.008014163002371788, 0.049063604325056076, 0.003448338247835636, -0.006903288885951042, -0.03240049257874489, 0.003960794769227505, -0.030231643468141556, -0.0006124685169197619, 0.016213471069931984, 0.0004777419671881944, -0.007352928165346384, 0.0003996336308773607, -0.010077214799821377, -0.03213600069284439, -0.046841856092214584, 0.04789983108639717, -0.006585896015167236, -0.020789215341210365, 0.04104943946003914, 0.028142143040895462, -0.008496863767504692, 0.027771851047873497, 0.015102596953511238, 0.03607695922255516, -0.049222301691770554, -0.012074142694473267, 0.005359306000173092, 0.03208310157060623, 0.07093724608421326, 0.007419051602482796, -0.03909218683838844, -0.016782132908701897, 0.024743396788835526, 0.003254926996305585, -0.021701717749238014, 0.041261035948991776, -0.014441362582147121, 0.0030416790395975113, -0.02201911062002182, 0.0023606072645634413, 0.007776118349283934, 0.005799027159810066, 0.00014061566616874188, 0.03951537609100342, 0.042028069496154785, -0.007954651489853859, 0.028882725164294243, -0.007868691347539425, 0.019241925328969955, 0.030099397525191307, 0.01667633466422558, 0.00857621245086193, 0.057024866342544556, -0.0110558420419693, 0.05218463018536568, 0.008192696608603, 0.009078750386834145, 0.012867624871432781, 0.05586109682917595, -0.007987713441252708, -0.003000351833179593, -0.05009512975811958, 0.02519303746521473, 0.01892453245818615, -0.009521777741611004, -0.05586109682917595, -0.030284542590379715, 0.005570901092141867, -0.028512433171272278, -0.01450748648494482, -0.10674970597028732, -0.054644424468278885, -0.010897145606577396, -0.0008319157059304416, -0.020154429599642754, -0.024677272886037827, 0.016636662185192108, -0.004737745504826307, -0.017602063715457916, -0.016729233786463737, -0.03594471141695976, -0.03221534937620163, -0.0044798641465604305, 0.02286549098789692, -0.012503945268690586, 0.0010736796539276838, -0.0004413740534801036, 0.019294824451208115, -0.03946247696876526, 0.014375239610671997, -0.005190691445022821, -0.020088305696845055, 0.03557441756129265, 0.003474787576124072, -0.019903160631656647, 0.009475491009652615, -0.0035475234035402536, -0.040546901524066925, 0.024187959730625153, -0.003917814698070288, 0.0013761944137513638, 0.021701717749238014, 0.020313125103712082, 0.0016605253331363201, 0.02434665709733963, -0.011948508210480213, -0.001467940746806562, -0.0473443940281868, 0.05771255120635033, 0.0009505246998742223, -0.04964549094438553, -0.00026841991348192096, 0.012669254094362259, -0.04141973331570625, 0.006764429621398449, 0.01647796481847763, -0.010930207557976246, -0.002053133212029934, -0.012444434687495232, 0.029702655971050262, -0.004489782731980085, -0.014216543175280094, -0.0069297379814088345, -0.042900897562503815, 0.011591441929340363, -0.016253145411610603, -0.01096326857805252, -0.038060661405324936, 0.020220553502440453, -0.03935668244957924, 0.001753924647346139, 0.003643402364104986, 0.0243863295763731, 0.014203318394720554, -0.014282666146755219, -0.03076063096523285, 0.0002892901247832924, -0.01182948611676693, -0.0013654493959620595, -0.008463802747428417, 0.02840663678944111, 0.0005996570689603686, 0.014745530672371387, 0.03475448861718178, 0.009158098138868809, 0.03917153552174568, -0.04940744489431381, -0.018329421058297157, 0.022429076954722404, -0.006093276664614677, 0.03687043860554695, 0.004450108390301466, -0.008886992000043392, -0.03840450197458267, -0.002000234555453062, 0.005369224585592747, 0.01895098201930523, -0.00010786388884298503, -0.022561322897672653, -0.008205920457839966, -0.01892453245818615, 0.06786911189556122, -0.009587900713086128, 0.005613881163299084, -0.023275455459952354, 0.017906231805682182, 0.008543150499463081, 0.006248666439205408, 0.030310992151498795, -0.00029383611399680376, -0.07215391844511032, 0.0024564864579588175, -0.011340172961354256, -0.00940936803817749, 0.006156093906611204, 0.013872700743377209, -0.025510428473353386, -0.03470158949494362, -0.003686382668092847, 0.01815750077366829, 0.001437358558177948, -0.003491318551823497, -0.06485388427972794, 0.004142634570598602, 0.03393455594778061, -0.014242992736399174, -0.03951537609100342, -0.010044152848422527, -0.0019440295873209834, 0.0042814938351511955, -0.009210997261106968, -0.03710848465561867, -0.02516658790409565, -0.040414657443761826, -0.04784693196415901, 0.01736401952803135, 0.02205878496170044, 0.01667633466422558, -0.03946247696876526, -0.013621431775391102, 0.0072801923379302025, -0.017694637179374695, -0.008496863767504692, -0.009892068803310394, -0.001605973462574184, -0.0031441703904420137, -0.014031397178769112, 0.0007934814784675837, -0.004248431883752346, -0.004975790157914162, 0.03076063096523285, 0.02906787022948265, -0.0005703148199245334, 0.0567074753344059, 0.02991425059735775, -0.009316794574260712, 0.016848256811499596, 0.002195298671722412, -0.026330359280109406, -0.0236060731112957, -0.030178744345903397, -0.013647881336510181, -0.005772577598690987, -0.01880551129579544, 0.007716607302427292, -0.020127980038523674, -0.01737724430859089, -0.02914721891283989, 0.0006595814484171569, 0.004645172972232103, -0.007134720683097839, -0.022495198994874954, -0.05559660121798515, -0.010097051970660686, 0.006208992563188076, 0.03361716493964195, -0.011981570161879063, -0.000834808626677841, -0.017483042553067207, -0.030205193907022476, 0.01727144606411457, -0.003530992427840829, -0.00979949627071619, 0.0026846122927963734, 0.024981440976262093, -0.0069297379814088345, -0.023024186491966248, -0.030945777893066406, -0.011148414574563503, -0.014401688240468502, 0.01797235570847988, 0.06067488342523575, -0.030099397525191307, -0.011221150867640972, 0.018646813929080963, -0.01735079474747181, -0.009581288322806358, -0.04091719537973404, -0.02996714971959591, 0.0364207997918129, 0.034225501120090485, -0.00981272105127573, 0.004509619902819395, -0.029491061344742775, -0.02761315554380417, -0.06310822814702988, 0.010288809426128864, 0.011207926087081432, -0.020035406574606895, -0.034119702875614166, 0.024016039445996284, -0.00981272105127573, 0.02039247378706932, 0.02057761885225773, 0.003650014754384756, 0.017813658341765404, -0.03168635815382004, 0.003944264259189367, 0.0036929950583726168, 0.013145343400537968, 0.007214068900793791, -0.025722024962306023, 0.014163644053041935, -0.00981272105127573, -0.0066354889422655106, -0.03985922038555145, -0.0015803505666553974, 0.02585427090525627, 0.0106657138094306, 0.013780128210783005, 0.00765709625557065, 0.01662343740463257, 0.002003540750592947, 0.0075380741618573666, 0.011968345381319523, 0.01180303655564785, -0.012292350642383099, 0.013727229088544846, -0.011221150867640972, 0.0008401811355724931, 0.0005876722279936075, -0.0010852512205019593, 0.011928671039640903, 0.0013356937561184168, -0.0025325282476842403, 0.0029077790677547455, -0.0033210506662726402, 0.03517767786979675, -0.017707861959934235, -0.0085828248411417, -0.009687086567282677, 0.009052300825715065, -0.0077827307395637035, -0.019929610192775726, 0.004780726041644812, -0.012107204645872116, 0.019202250987291336, 0.0663350522518158, 0.010910370387136936, -0.013780128210783005, -0.020908236503601074, -0.009111812338232994, 0.007207456510514021, -0.05744805932044983, 0.006004009861499071, 0.016848256811499596, 0.039700523018836975, -0.02049827203154564, -0.010123500600457191, -0.014692631550133228, 0.015578686259686947, -0.0069297379814088345, -0.010758286342024803, -0.005048525985330343, 0.009244059212505817, -0.009634187445044518, 0.02838018722832203, 0.017681412398815155, 0.05728936195373535, -0.04311249405145645, -0.12494688481092453, -0.01806492730975151, 0.000257468200288713, 0.010130112990736961, 0.02114628069102764, 0.003078046953305602, 0.017602063715457916, -0.001993622165173292, -0.01875261217355728, 0.012510557658970356, -0.010487180203199387, -0.012008019722998142, -0.005927967838943005, -0.0028201653622090816, 0.0489049069583416, -0.020141204819083214, -0.004602192435413599, -0.005914743058383465, 0.021000809967517853, 0.006291646976023912, -0.019347723573446274, -0.005640330724418163, 0.03406680375337601, 0.018382320180535316, -0.02115950547158718, -0.03139541670680046, 0.00936969369649887, -0.045228444039821625, 0.027322212234139442, 0.012431209906935692, 0.008238982409238815, -0.011974957771599293, 0.03536282479763031, 0.05406253784894943, 0.0039740195497870445, -0.01095665618777275, -0.007412439212203026, 0.006169318221509457, 0.014970350079238415, 0.016782132908701897, -0.012074142694473267, -0.04012371227145195, 0.03245339170098305, -0.02425408363342285, 0.01899065636098385, -0.04247770830988884, 0.009475491009652615, -0.038933489471673965, -0.00040748578612692654, 0.008463802747428417, -0.017919456586241722, 0.021423999220132828, -0.019440295174717903, -0.026581628248095512, -0.008873768150806427, 0.020167654380202293, -0.028618231415748596, 0.029438162222504616, -0.016173796728253365, 0.02432020753622055, -0.025034340098500252, 0.005372530780732632, 0.05250202491879463, -0.004079817328602076, -0.05281941592693329, -0.009614350274205208, -0.0039277332834899426, 0.004423659294843674, 0.015248068608343601, -0.056919071823358536, 0.0032912949100136757, -0.005901518277823925, -0.02681967429816723, -0.009316794574260712, -0.015023249201476574, -0.005180772859603167, 0.002562284003943205, 0.017707861959934235, -0.058664727956056595, -0.012510557658970356, 0.042001619935035706, 0.0024928543716669083, -0.0006409842753782868, 0.020141204819083214, -0.02137110009789467, 0.029517510905861855, 0.01181626133620739, -0.023354804143309593, -0.006962799932807684, 0.019347723573446274, 0.03060193546116352, 0.00046038455911912024, -0.009865619242191315, 0.013766903430223465, -0.0027887567412108183, -0.03821935877203941, -0.007339703384786844, -0.007425663992762566, 0.040388207882642746, 0.004307942930608988, 0.03694978728890419, 0.02039247378706932, -0.03218889981508255, 0.004946034401655197, 0.0020961135160177946, -0.03240049257874489, 0.01225267630070448, -0.017006952315568924, 0.0033408876042813063, -0.021701717749238014, 0.009964805096387863, 0.001316683366894722, -0.011670789681375027, -0.011108740232884884, 0.015909302979707718, 0.019347723573446274, 0.017721086740493774, 0.02047182247042656, 0.03374941274523735, -0.006784266326576471, -0.020815663039684296, -0.030522586777806282, 0.002757348120212555, 0.01019623689353466, -0.016808582469820976, -0.013885925523936749, -0.012312187813222408, 0.027877649292349815, -0.02137110009789467, -0.0017324344953522086, 0.02359284833073616, 0.02039247378706932, 0.01897743158042431, 0.049301646649837494, -0.014071071520447731, 0.018514567986130714, 0.030945777893066406, -0.008040612563490868, -0.028750479221343994, 0.004549293778836727, -0.023169659078121185, -0.008192696608603, -0.0041261035948991776, -0.0007897620089352131, 0.00381862954236567, -0.0019440295873209834, -0.030310992151498795, -0.04234546050429344, 0.031210271641612053, 0.03216245025396347, 0.027666054666042328, -0.0037458937149494886, -0.010923595167696476, -0.026951920241117477, 0.011604666709899902, 0.01810460165143013, -0.020154429599642754, -0.0102094616740942, 0.0014819919597357512, 0.041313935071229935, 0.04020306095480919, 0.02365897223353386, 0.006066827103495598, -0.0037756492383778095, 0.01569770835340023, -0.03676464036107063, -0.040388207882642746, -0.004076511133462191, -0.01821039989590645, 0.03232114389538765, 0.001353051164187491, -0.045228444039821625, -0.010262359865009785, 0.04337698593735695, 0.02049827203154564, 0.026965145021677017, -0.02684612385928631, 0.018646813929080963, 0.005878375377506018, 0.013456122949719429, 0.005670086480677128, 0.019916385412216187, 0.004463333170861006, 0.004274881444871426, 0.025603001937270164, 0.0034615627955645323, -0.012768439017236233, 0.02667420171201229, 0.013859475962817669, 0.024783071130514145, 0.013608206994831562, 0.015472888946533203, 0.024174734950065613, 0.03610340505838394, 0.04424981772899628, -0.011088903062045574, -0.027718951925635338, 0.03536282479763031, -0.003221865277737379, -0.02912076935172081, -0.021080156788229942, 0.002461445750668645, -0.024597926065325737, -0.03142186626791954, -0.018223624676465988, 0.013158567249774933, 0.02347382716834545, 0.01060620229691267, -0.01065248902887106, 0.003246661741286516, 0.012550232000648975, 0.020828887820243835, -0.014004947617650032, 0.012689091265201569, 0.0316070131957531, -0.04022951051592827, 0.012940360233187675, 0.013727229088544846, -0.03150121495127678, -0.031950853765010834, -0.022191030904650688, -0.030998675152659416, -0.006430506240576506, 0.02898852340877056, -0.00938291847705841, 0.023910241201519966, 0.03382876142859459, -0.015023249201476574, -0.04022951051592827, 0.010837634094059467, 0.015578686259686947, 0.011340172961354256, -0.034913185983896255, -0.015010024420917034, -0.0061131133697927, 0.021543022245168686, -0.015049698762595654, -0.006037071347236633, 0.01889808289706707, 0.0071281082928180695, 0.05292521417140961, -0.004307942930608988, -0.040546901524066925, -0.00858943723142147, -0.017535939812660217, 0.0025060789193958044, 7.987765457073692e-06, 0.046815406531095505, -0.039700523018836975, -0.0018812123453244567, -0.014573609456419945, 0.02212490886449814, 0.004304636735469103, 0.003987244330346584, -0.0021804210264235735, 0.017033401876688004, 0.0056237997487187386, 0.020828887820243835, 0.02121240459382534, -0.001851456705480814, -0.03203020244836807, 0.012741989456117153, -0.009072137996554375, -0.002942493883892894, 0.012788276188075542, -0.04570453241467476, 0.006390831898897886, -0.012702316045761108, -0.0017820270732045174, 0.016041550785303116, -0.00043186882976442575, -0.006245360244065523, -0.02137110009789467, 0.0048336246982216835, -0.02196621149778366, 0.00026573362993076444, -0.0013224690919741988, 0.015591911040246487, 0.010295421816408634, 0.0003930212988052517, -0.03374941274523735, -0.03369651362299919, -0.03853674978017807, -0.014123969711363316, 0.024835970252752304, -0.0069231255911290646, 0.02138432487845421, -0.01961221732199192, 0.05199948698282242, 0.04943389445543289, 0.023844117298722267, 0.020709866657853127, -0.014626508578658104, -0.007690157741308212, 0.03713493421673775, -0.007266967557370663, -0.0020663579925894737, -0.013581757433712482, 0.01657053828239441, 0.008060448803007603, -0.014150419272482395, 0.0028433084953576326, 0.006744592450559139, -0.051496949046850204, 0.016689559444785118, 0.02980845421552658, 0.014269441366195679, -0.027189964428544044, -0.03692333772778511, -0.012345248833298683, -0.0047146026045084, -0.009978029876947403, 0.016782132908701897, 0.018302973359823227, -0.01645151525735855, -0.0032979073002934456, 0.009627575054764748, -0.019956059753894806, 0.01719209924340248, 0.01057975273579359, -0.007326479069888592, 0.020868562161922455, 0.02758670598268509, 0.011221150867640972, -0.029464611783623695, -0.030839979648590088, -0.014282666146755219, -0.013198241591453552, -0.011181476525962353, 0.05993429943919182, -0.013753678649663925, 0.0024085468612611294, -0.009085362777113914, -0.0158696286380291, -0.04715924710035324, 0.008245594799518585, -0.02527238428592682, -0.01225267630070448, -0.012451047077775002, -0.022204255685210228, 0.03144831582903862, 0.007868691347539425, -0.003735975129529834, 0.0017605370376259089, -0.016702784225344658, -0.003254926996305585, 0.02602619118988514, 0.028935624286532402, -0.002906125970184803, -0.012510557658970356, 0.0663350522518158, -0.025827821344137192, -0.010883920826017857, 0.019268374890089035, -0.01180964894592762, 0.03158056363463402, -0.006116419564932585, -0.011247599497437477, -0.0049261972308158875, 0.023817669600248337, -0.012325411662459373, 0.031130922958254814, -0.034225501120090485, -0.009210997261106968, -0.0068437778390944, -0.009230834431946278, -0.07072564959526062, -0.010057377628982067, 0.025378182530403137, 0.024597926065325737, 0.02291839011013508, -0.003059862880036235, -0.0002077722892863676, -0.009673861786723137, 0.01452071126550436, -0.0035177678801119328, 0.003950876649469137, 0.006218911148607731, 0.0007947213016450405, 0.035812463611364365, 0.000836874998640269, 0.0028201653622090816, -0.008034000173211098, 0.00764387147501111, -9.918518480844796e-05, 0.025325283408164978, -0.0211991798132658, 0.019810587167739868, 0.008358004502952099, 0.007419051602482796, 0.007220681291073561, -0.019413847476243973, -0.005121261812746525, 0.0030962307937443256, 0.0074785626493394375, -0.005177466664463282, -0.006976024713367224, 0.03314107656478882, 0.005719678942114115, 0.018329421058297157, 0.018276523798704147, -0.010368158109486103, 0.013528859242796898, -0.0013241221895441413, -0.007690157741308212, 0.013072607107460499, -0.0037525061052292585, 0.012900685891509056, 0.006648713257163763, 0.01970478892326355, -0.01577705703675747, 0.024597926065325737, -0.01881873607635498, 0.01450748648494482, -0.014176868833601475, -0.029305916279554367, 0.0033656838349997997, 0.012880848720669746, -0.025669125840067863, 0.023777995258569717, -0.011684014461934566, -0.03475448861718178, 0.0074785626493394375, -0.02512691356241703, -0.014335565268993378, -0.010354933328926563, -0.006784266326576471, 0.03993856534361839, -0.016279594972729683, 0.02681967429816723, -0.0053824493661522865, -0.01572415791451931, -0.017456592991948128, -0.01971801370382309, -0.009746597148478031, 0.012298963032662868, 0.03634145110845566, -0.000483114505186677, -0.02273324318230152, 0.032585639506578445, -0.01900388114154339, 0.011518705636262894, 0.011631116271018982, -0.030152296647429466, -0.008020775392651558, -0.05091506242752075, -0.008119960315525532, -0.011717076413333416, -0.017588838934898376, 0.00983255822211504, -0.02676677517592907, 0.012146878987550735, 0.04464655742049217, -0.0008091857889667153, -0.04001791402697563, 0.014362014830112457, -0.0377168208360672, -0.015935752540826797, -0.0034285010769963264, 0.0035574419889599085, 0.005746128503233194, 0.0013563573593273759, 0.02447890304028988, 0.0219794362783432, 0.01798558048903942, 0.018686488270759583, -0.02922656759619713, 0.07580392807722092, 0.006751204840838909, -0.01178319938480854, 0.028909174725413322, 0.00685039022937417, -0.007716607302427292, 0.01806492730975151, -0.01888485811650753, 8.658040314912796e-05, -0.009859006851911545, -0.017139200121164322, 0.007392602507025003, 0.016081225126981735, -0.028115693479776382, 0.005088199861347675, 0.014838103204965591, 0.012424597516655922, 0.00981272105127573, -0.009303569793701172, -0.006007316056638956, -0.027666054666042328, -0.02346060238778591, -0.02761315554380417, 0.01736401952803135, -0.03234759345650673, -0.010427668690681458, -0.0024945074692368507, 0.005210528150200844, -0.013621431775391102, -0.0010819450253620744, 0.007974488660693169, -0.007121496368199587, 0.008093510754406452, -0.025642676278948784, 0.013145343400537968, -0.03377586230635643, 0.03636790066957474, -0.008291881531476974, -0.011141802184283733, 0.006632182747125626, -0.023804444819688797, 0.0035541357938200235, 0.0007674453663639724, 0.024082163348793983, -0.00860266201198101, 0.009343244135379791, 0.028591781854629517, 0.0423983596265316, -0.014414913021028042, -0.02917366847395897, -0.002117603551596403, -0.0019010493997484446, -0.023301905021071434, -0.0034351134672760963, 0.0027358580846339464, 0.010553303174674511, 0.002734204987064004, -0.010328483767807484, -0.03874834626913071, -0.02514013834297657, -0.0153141925111413, -0.004311249125748873, 0.02603941597044468, -0.02742800861597061, 0.0030962307937443256, 0.012014632113277912, 0.01880551129579544, -0.014957125298678875, 0.0048799109645187855, 0.005746128503233194, 0.028618231415748596, -0.0008934931829571724, -0.04263640567660332, 0.024135060608386993, 0.02679322473704815, 0.016993727535009384, 0.0012869277270510793, 0.0026069171726703644, 0.05194658786058426, 0.019427070394158363, -0.00817947182804346, 0.027269313111901283, 0.0052733453921973705, 0.052211079746484756, -0.020881786942481995, -0.01565803401172161, -0.004655091091990471, 0.008906829170882702, -0.008272044360637665, 0.023844117298722267, 0.022402627393603325, 0.004982402548193932, 0.004863379988819361, 0.020842112600803375, -0.00650985399261117, 0.013899150304496288, 0.026303909718990326, -0.03464869037270546, 0.0004777419671881944, 0.014362014830112457, -0.006195767782628536, -0.016041550785303116, -0.007848854176700115, 0.010275584645569324, 0.024227634072303772, 0.008787807077169418, -0.013872700743377209, -0.030919328331947327, -0.007564523257315159, 0.016385393217206, 0.019387397915124893, -0.005438654217869043, 0.019889935851097107, -0.002481282688677311, -0.048402369022369385, 0.00857621245086193, -0.024928541854023933, 0.0025209567975252867, -0.025761697441339493, -0.003145823488011956, 0.008053837344050407, -0.024174734950065613, -0.013925599865615368, -0.026383258402347565, 0.004579049069434404, 0.02603941597044468, -0.03068128414452076, -0.0029887801501899958, 0.012556844390928745, 0.029464611783623695, 0.01661021262407303, -0.06078068166971207, 0.0009918517898768187, -0.02687257155776024, 0.0009455654071643949, -0.004093042109161615, -0.00899279024451971, -0.024148285388946533, -0.024518577381968498, 0.0031193739268928766, -0.014943900518119335, 0.01106245443224907, 0.013151954859495163, -0.01881873607635498, -0.002312667900696397, 0.006817328277975321, -0.017866557464003563, 0.0035838913172483444, 0.0003413623489905149, 0.013304038904607296, -0.01182948611676693, -0.020141204819083214, -0.016147347167134285, 0.02118595503270626, 0.000959616678301245, -0.013151954859495163, -0.020604068413376808, -0.004314555320888758, 0.021622369065880775, -0.0065296911634504795, 0.012675866484642029, 0.014388464391231537, -0.026475831866264343, 0.007147945463657379, -0.00037835014518350363, -0.012470883317291737, -0.016821807250380516, 0.037399426102638245, 0.008477026596665382, -0.008801031857728958, -0.013912375085055828, 0.00036264583468437195, -0.007399214897304773, -0.01635894365608692, 0.010044152848422527, 0.001501829014159739, -0.0044401902705430984, -0.012014632113277912, -0.03435774892568588, 0.0105995899066329, -0.01056652795523405, 0.029385263100266457, 0.034886736422777176, 0.0243863295763731, 0.016861481592059135, -0.004959259182214737, -0.01179642416536808, 0.026145214214920998, 0.012371698394417763, -0.011657564900815487, 0.045307792723178864, 0.014309115707874298, 0.023222558200359344, 0.014044621959328651, 0.011564992368221283, 0.0089729530736804, 0.031924404203891754, -0.004116185009479523, 0.02991425059735775, -0.01966511644423008, 0.03956827521324158, -0.008430740796029568, 0.030178744345903397, 0.00013286681496538222, 0.014454587362706661, -0.016689559444785118, -0.007524849381297827, 0.06252633780241013, -0.012014632113277912, -0.017721086740493774, -0.026951920241117477, 0.04184292256832123, 0.007002473808825016, 0.04501684755086899, 0.0014472771435976028, 0.012781663797795773, -0.04398532211780548, -0.018633589148521423, 0.0022812592796981335, -0.004251738078892231, 0.0106657138094306, -0.008543150499463081, -0.01740369386970997, 0.00015322044782806188, 0.015089372172951698, 3.585130980354734e-05, -0.05096795782446861, -0.019427070394158363, 0.024518577381968498, 0.016015101224184036, -0.005253508687019348, 0.011254211887717247, 0.0030813529156148434, 0.03721427917480469, 0.01491745188832283, 0.008886992000043392, -0.01969156600534916, -0.01263619214296341, 0.027692502364516258, -0.000658341683447361, -0.021569471806287766, -0.017787208780646324, -0.006737980060279369, -0.02346060238778591, -0.02369864657521248, 0.025378182530403137, -0.01409752108156681, 0.02135787531733513, -0.016689559444785118, 0.011994794942438602, -0.006456955336034298, 0.008040612563490868, -0.015618360601365566, 0.018435219302773476, 0.021410774439573288, -0.003225171472877264, 0.052343327552080154, -0.019479969516396523, -0.006189155392348766, -0.019506419077515602, 0.013495797291398048, 0.03874834626913071, 0.027877649292349815, 0.0009182894718833268, -0.03171280771493912, 0.0021804210264235735, -0.022481974214315414, -0.012027856893837452, -0.003987244330346584, 0.02290516532957554, 0.0009174629230983555, 0.01737724430859089]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"8. Literature Review
Our work is closely related to low-rank matrix optimization
and we briefly review some basic knowledge and related
work in Section 8.1. Our work applies preconditioners for
accelerating the LoRA fine-tuning process, which falls into
preconditioning methods for PEFT, and related prior work
there is discussed in Section 8.2 and Section 8.3.
8.1. Riemannian Optimization
Several recent studies have made theoretic contributions to
the convergence rate of scaled GD method which employs
the preconditioner (1). Specifically, in (Tong et al., 2021a;b),
8
Riemannian Preconditioned LoRA
the authors show local convergence of scaled GD method
with better convergence rate independent of data condition
number compared to plain gradient descent method for some
classic low-rank matrix optimization problem including ma-
trix sensing, robust PCA, etc. The authors of (Jia et al., 2023)
show global convergence of scaled GD method with rate in-
dependent of data condition number for least squares matrix
decomposition problem ∥ABT−Y∥2
F/2. Different variants
of scaled GD have been proposed and studied. In (Zhang
et al., 2023c), the authors suggest to use (ATA+λI)−1
and(BTB+λI)−1with some fixed λ >0in replace of
(1) for tackling overparametrization and ill-conditioness in
matrix sensing problems. In (Zhang et al., 2023b), the au-
thors suggest using (ATA+λtI)−1where λt+1=βλt
(similar change for B), i.e., using an exponentially decay
regularization term. (Zhang et al., 2023c) proposes precGD
method which sets λt=p
f(AtBT
t). (Tong et al., 2022;
Ma et al., 2023) present extension of scaled GD method
to tensor optimization problem. (Jia et al., 2023) analyzes
AltScaledGD method which updates AandBalternatively
and shows that such method has better convergence rate for
larger step size.
8.2. Preconditioners in Deep Learning
Current deep learning training is dominated by gradient-
based method which follows a descent direction to update
parameters for decreasing objective value. For accelerating
such training procedure, more advanced techniques such
as Adagrad (Duchi et al., 2011) proposes to scale gradient
based on their variance. Specifically, G−1/2
t is used as gra-
dient preconditioner where Gtis accumulated outer product
of historic subgradients. More practical optimizers such as
Adam (Kingma & Ba, 2017) and AdamW (Loshchilov &
Hutter, 2019) perform like a diagonal version of Adagrad
and are the main training tools for most deep learning mod-
els in various fields. More recently, Shampoo (Gupta et al.,
2018) has been proposed which uses a left preconditioner
and a right preconditioner for a weight matrix. Shampoo is
in spirit close to Adagrad but requires much less storage. In
contrast with the preconditioners designed for accelerating
optimization procedure for general deep learning models.
We study a specific preconditioner designed for LoRA fine-
tuning model which exploits its low rank matrix factoriza-
tion property and borrows from Riemannian optimization
knowledge.
8.3. PEFT Fine-Tuning Review
Current commonly-used deep learning models are growing
larger and larger, making full fine-tuning for downstream
tasks nearly impossible. A line of parameter-efficient fine-
tuning methods emerges and has been used in various fields.
These methods aim at achieving low fine-tuning loss with
fewer trainable parameters. One popular PEFT method isLoRA (Hu et al., 2021), which proposes to add a low-rank
adaptation to each existing weight matrix. By factorizing
the update into two low-rank matrices, LoRA is able to
achieve similar fine-tuning result as full fine-tuning with
10,000 times fewer parameters. LoRA has shown good per-
formance in both language model fine-tuning and vision
model fine-tuning. Variants of LoRA method involve Dy-
LoRA (Valipour et al., 2023), IncreLoRA (Zhang et al.,
2023a), and AdaLoRA (Zhang et al., 2023d), all focus on
dynamically adjusting the rank hyperparameter. GLoRA
(Chavan et al., ","[-0.011097087524831295, 0.019686434417963028, 0.022167352959513664, -0.02478237822651863, -0.00036208020173944533, -0.002430630847811699, -0.00838819146156311, 0.04009702801704407, -0.040043387562036514, 0.045675747096538544, 0.0021288974676281214, -0.0198607686907053, -0.046614471822977066, 0.0027826533187180758, 0.03787090629339218, -0.02998560294508934, 0.04656083136796951, -0.0583619624376297, -0.03180941566824913, 0.05331965908408165, 0.025050584226846695, -0.0366639718413353, 0.013893150724470615, 0.0238838829100132, 0.029127338901162148, -0.00925316009670496, 0.033525943756103516, 0.05007435008883476, 0.03006606549024582, -0.0018791290931403637, 0.03840732201933861, -0.017889443784952164, -0.0458366684615612, -0.04892105609178543, 0.007791429292410612, -0.0238838829100132, 0.008421717211604118, 0.01754077337682247, 0.003553749993443489, 0.0003237348864786327, -0.010962983593344688, -0.05562624707818031, -0.06276056915521622, 0.028108151629567146, 0.015770602971315384, 0.023682726547122, 0.061097677797079086, 0.02376318909227848, -0.011291537433862686, 0.025171278044581413, -0.05696728453040123, 0.03226536884903908, -0.025359023362398148, -0.030441556125879288, -0.032426293939352036, 0.005206578876823187, 0.018559962511062622, -0.02156388759613037, 0.03897055611014366, 0.009695703163743019, 0.026069773361086845, -0.028617745265364647, 0.034035537391901016, -0.0054278504103422165, -0.03121935762465, -0.03317727521061897, -0.07719013094902039, 0.006772240623831749, 0.0033224208746105433, 0.016534995287656784, -0.02207348123192787, -0.01412112731486559, 0.07541996240615845, -0.03752223402261734, -0.01126471720635891, -0.014711183495819569, 0.017634646967053413, 0.08491451293230057, 0.023454749956727028, 0.0007933076121844351, 0.023320646956562996, -0.026270929723978043, 0.021188396960496902, 0.004244384355843067, -0.0069733960554003716, -0.060668546706438065, -0.02541266568005085, -0.03591299057006836, -0.023226773366332054, 0.013772457838058472, -0.01128483284264803, -0.01156645081937313, -0.019807128235697746, 0.02274399995803833, 0.0377904437482357, 0.03690535947680473, 0.030039245262742043, 0.007100794930011034, 0.04167945310473442, 0.035859350115060806, -0.021040882915258408, 0.008079752326011658, 0.03730766847729683, -0.03256039693951607, 0.058093756437301636, -0.01699094846844673, -0.006373282056301832, 0.013014771044254303, 0.014818467199802399, 0.025104226544499397, -0.021282268688082695, 0.019109787419438362, -0.06356518715620041, 0.006708541419357061, 0.019109787419438362, -0.08523635566234589, -0.05557260289788246, 0.01909637823700905, -0.06517443060874939, -0.0006977586890570819, -0.028322717174887657, -0.014335693791508675, 0.016119273379445076, 0.00687281833961606, 0.03175577521324158, -0.023870471864938736, 0.04913562163710594, -0.050798509269952774, 0.014670953154563904, -0.008495474234223366, 0.05600173398852348, 0.05307827517390251, 0.04312777519226074, -0.048384640365839005, -0.02125544846057892, -0.0038219576235860586, -0.009333622641861439, 0.0032872187439352274, -0.010748417116701603, -0.013946792110800743, 0.02152365632355213, -0.030253810808062553, -0.00498866057023406, -0.003332478692755103, -0.036610331386327744, 0.013202516362071037, 0.01728597655892372, -0.012418009340763092, -0.010895931161940098, 0.016803203150629997, -0.013276273384690285, -0.005615595728158951, -0.04921608418226242, 0.018399037420749664, -0.02252943441271782, -0.0012220205971971154, -0.00021131821267772466, -0.00997732114046812, 0.034330565482378006, -0.029315084218978882, -0.0006260969676077366, 0.06356518715620041, 0.04733863100409508, 0.003317392198368907, 0.05798647180199623, 0.02633798122406006, -0.02723647654056549, -0.012122981250286102, -0.07000216841697693, -0.02519809827208519, 0.003000571858137846, -0.01774192973971367, -0.06115132197737694, -0.019726665690541267, 0.04613169655203819, 0.02358885295689106, -0.032426293939352036, -0.0009982349583879113, 0.01243141945451498, -0.04811643436551094, -0.024044806137681007, 0.005612242966890335, -0.05589445307850838, 0.04988660290837288, -0.05213954672217369, 0.022690357640385628, -0.0045695859007537365, -0.016253378242254257, 0.010761828161776066, 0.06694460660219193, 0.00987003743648529, 0.007938943803310394, 0.07874573767185211, 0.022556254640221596, -0.00798587966710329, -0.02706214226782322, 0.04918926581740379, 0.013095233589410782, -0.020732443779706955, -0.002542942762374878, -0.019257301464676857, 0.009729228913784027, 0.003189993556588888, -0.030468378216028214, 0.009501252323389053, 0.00836137030273676, -0.035001084208488464, -0.012645985931158066, 0.01285384688526392, -0.0468558594584465, 0.006289466749876738, 0.05498254671692848, 0.04294002801179886, -0.008073046803474426, -0.006601258181035519, 0.012739858590066433, -0.038058649748563766, 0.022288046777248383, 0.01909637823700905, 0.03344548121094704, 0.0005209093214944005, -0.017648056149482727, -0.00572958355769515, 0.03687853738665581, -0.02278423123061657, -0.025975901633501053, 0.002507740631699562, -0.014228410087525845, 0.051656775176525116, -0.032667677849531174, 0.027249887585639954, -0.034491490572690964, -0.018358806148171425, 0.007221488282084465, 0.061526812613010406, -0.0593811497092247, -0.004210858605802059, -0.061473168432712555, 0.028403179720044136, -0.03398189693689346, -0.006400102749466896, 0.012069339863955975, 0.002755832625553012, -0.03376733139157295, 0.003593981033191085, 0.022516023367643356, -0.02215394377708435, -0.03135346248745918, 0.021228628233075142, 0.002408839063718915, 0.0035001083742827177, -0.025600410997867584, -0.002502711722627282, -0.049993887543678284, -0.02223440632224083, 0.03234583139419556, 0.007436054293066263, -0.010057782754302025, -0.042028121650218964, 0.0015572800766676664, -0.04299366846680641, 0.03956061229109764, 0.007650620304048061, 0.01060760859400034, 0.003949356265366077, -0.02625751867890358, -0.0018891869112849236, 0.017420079559087753, -0.013624943792819977, 0.023092670366168022, 0.02447393909096718, 0.005937444511801004, -0.015381703153252602, 0.01090263668447733, -0.013987023383378983, 0.02613682486116886, 0.0766000747680664, 0.0006210681167431176, -0.023159721866250038, -0.010976393707096577, 0.0185867827385664, 0.03905101865530014, 0.09880766272544861, -0.0019964699167758226, 0.017353028059005737, -0.006359871476888657, -0.004194095730781555, -0.02007533423602581, -0.015287830494344234, 0.01404066476970911, 0.01748713292181492, -0.031487565487623215, 0.04570256546139717, -0.014214999973773956, 0.011915120296180248, -0.004650048445910215, -0.007335476577281952, -0.06394068151712418, 0.02778630144894123, -0.008622872643172741, 0.03368686884641647, 0.006477212067693472, -0.014617311768233776, -0.0024926539044827223, -0.027343759313225746, 0.025305382907390594, 0.02961011230945587, -0.0268878061324358, -0.018559962511062622, 0.03175577521324158, 0.02341451868414879, 0.049913424998521805, -0.013960203155875206, 0.044790659099817276, -0.003959414083510637, -0.008146803826093674, 0.028188612312078476, -0.019981462508440018, -0.018197882920503616, -0.030763406306505203, -0.049618396908044815, -0.05669907480478287, -0.029717396944761276, 0.02562723122537136, 0.021550476551055908, -0.006993511691689491, -0.03041473589837551, -0.006349813658744097, -0.023857060819864273, -0.012458240613341331, 0.027679018676280975, 0.03164849057793617, -0.0037448478396981955, -0.009682292118668556, -0.04272546246647835, 0.03596663102507591, -0.02731693908572197, 0.022395329549908638, 0.047714121639728546, 0.005360798444598913, -0.03977517783641815, -0.01982053741812706, 0.001144072855822742, 0.030682943761348724, -0.030334273353219032, -0.003074329113587737, -0.0015807482413947582, -0.002200978109613061, 0.041143037378787994, 0.023870471864938736, -0.0011641883756965399, 0.000460562645457685, 0.023159721866250038, -0.042296331375837326, -0.020678801462054253, 0.013014771044254303, 0.008140099234879017, -0.037924546748399734, -0.0376831591129303, -0.023481570184230804, -0.015864476561546326, -0.004562880843877792, 0.011030035093426704, 0.0038554833736270666, -0.01964620314538479, 0.018023546785116196, 0.005987733602523804, 0.009548189118504524, 0.017648056149482727, -0.007999289780855179, 0.019833948463201523, 0.029502829536795616, -0.013946792110800743, 0.022502612322568893, -0.05066440626978874, 0.041867196559906006, 0.05028891563415527, 0.016655689105391502, 0.010433273389935493, 0.03465241566300392, 0.008575936779379845, 0.02384365163743496, -0.003909124992787838, -0.022328278049826622, -0.0029318437445908785, 0.06361883133649826, 0.024286193773150444, -0.05739641562104225, -0.06930483132600784, -0.0008398249046877027, -0.007918828167021275, -0.015810834243893623, -0.031058434396982193, 0.01179442647844553, 0.01648135297000408, 0.01158656645566225, -0.05578716844320297, 0.053856074810028076, 0.04291320592164993, 0.0032084328122437, -0.011217780411243439, 0.0005825132830068469, -0.04387875646352768, -0.014764825813472271, -0.017889443784952164, 0.026673240587115288, 0.016400892287492752, 0.0815887376666069, 0.019284123554825783, 0.018962273374199867, 0.01054726168513298, -0.030253810808062553, 0.024165499955415726, -0.016280198469758034, 0.01880134828388691, -0.004928313661366701, 0.01499280147254467, 0.04709724709391594, -0.01444297656416893, 0.04554164037108421, 0.01673615165054798, -0.009172698482871056, -0.015502396039664745, -0.03502790629863739, -0.02380342036485672, 0.04484430328011513, 0.0023669316433370113, -0.06238507479429245, -0.029207801446318626, -0.058093756437301636, 0.004241032060235739, 0.005645768716931343, 0.0024473939556628466, -0.04095529392361641, -0.03811229392886162, -0.02859092503786087, -0.018734296783804893, 0.06308241188526154, 0.053131915628910065, -0.04344962164759636, 0.011076971888542175, 0.028403179720044136, -0.01567673124372959, -0.021925967186689377, -0.015515806153416634, 0.02507740631699562, -0.010922752320766449, 0.02460804209113121, -0.022583074867725372, -0.0003983301285188645, -0.007080679293721914, 0.02160411700606346, 0.06984124332666397, -0.006423570681363344, 0.040767546743154526, -0.05712820589542389, 0.05610901862382889, -0.017165282741189003, 0.0593811497092247, -0.0036073916126042604, 0.03738813102245331, -0.023106079548597336, -0.016588637605309486, -0.020638570189476013, 0.012424714863300323, 0.05213954672217369, 0.04336915910243988, 0.01617291569709778, -0.004304731264710426, -0.006188889034092426, 0.0019780306611210108, -0.03183623403310776, -0.023776598274707794, -0.012424714863300323, -0.022851282730698586, 0.02778630144894123, -0.013973613269627094, -0.018667245283722878, 0.001024217577651143, 0.005300451535731554, 0.011150728911161423, -0.040633443742990494, 0.017983315512537956, -0.03277496248483658, 0.03484015911817551, 0.07407892495393753, 0.027813123539090157, 0.03006606549024582, -0.00319837499409914, 0.0027943872846663, -0.029207801446318626, -0.018868401646614075, 0.04178673401474953, -0.014965981245040894, -0.03328455612063408, -0.017634646967053413, -0.036100734025239944, -0.0033928253687918186, 0.00718796206638217, 0.0007061401847749949, 0.02482260763645172, 0.018694065511226654, 0.004137101583182812, 0.02142978273332119, 0.02533220313489437, 0.036234840750694275, 0.025050584226846695, 0.021416373550891876, 0.017084820196032524, 0.04444199055433273, -0.013611532747745514, 0.06420888751745224, -0.016575226560235023, -0.006131894886493683, 0.0017106612212955952, 0.056859999895095825, -0.019418226554989815, -0.0005376723129302263, -0.01723233424127102, 0.025131046772003174, 0.02372295781970024, 0.01846608892083168, -0.02867138758301735, -0.00999743677675724, 0.014818467199802399, 0.003235253505408764, -0.03701264038681984, -0.0823933556675911, -0.024366656318306923, 0.010889226570725441, 0.01868065632879734, -0.02702191099524498, -0.0035202240105718374, 0.008267497643828392, -0.06978760659694672, -0.004680221900343895, -0.0042779105715453625, -0.036154378205537796, -0.05323919653892517, 0.02045082487165928, 0.02409844845533371, 0.01833198592066765, -0.011962056159973145, 0.02313290163874626, -0.0006164583028294146, -0.02486283890902996, 0.0223550982773304, -0.037414953112602234, -0.0021674521267414093, 0.026405032724142075, 0.06968031823635101, -0.017849212512373924, -0.004884730093181133, -0.015569448471069336, -0.017098231241106987, 0.001145749120041728, -0.009809691458940506, 0.017513953149318695, 0.033525943756103516, 0.027974046766757965, 0.004663458559662104, 0.005055712070316076, 0.010004141367971897, -0.005424497649073601, -0.03368686884641647, 0.045219793915748596, -0.0015044767642393708, -0.04009702801704407, -0.019914411008358, -0.005417792592197657, -0.027035320177674294, -0.0016938983462750912, 0.003942650742828846, 0.004395251162350178, -0.005561953876167536, -0.009105646051466465, 0.03939968720078468, 0.01593152806162834, 0.025184689089655876, 0.020276490598917007, -0.03100479207932949, -0.005655826535075903, -0.022328278049826622, -0.022301457822322845, -0.03553749993443489, -0.009601830504834652, -0.03317727521061897, 0.026445263996720314, -0.0065945531241595745, 0.03041473589837551, 0.0160924531519413, -0.005209931638091803, -0.005380914080888033, -0.016534995287656784, -0.007509811315685511, -0.01889522187411785, -0.0432886965572834, -0.0017006035195663571, 0.011251306161284447, 0.00046601062058471143, 0.00707397423684597, 0.012076044455170631, 0.022516023367643356, -0.006195594556629658, 0.0007115881307981908, -0.015462164767086506, -0.0023451396264135838, 0.019297532737255096, 0.004023113287985325, -0.022971976548433304, -0.0249030701816082, -0.012505176477134228, -0.009199518710374832, 0.0007425996591337025, -0.01697753742337227, -0.018573373556137085, -0.01022541243582964, 0.002165775978937745, 0.06624726206064224, 0.007281834725290537, 0.019109787419438362, -0.02066539227962494, 0.021121343597769737, 0.0023836945183575153, 0.03811229392886162, -0.026579366996884346, -0.010037667118012905, -0.04071390628814697, -0.012679511681199074, -0.014255231246352196, -0.026820754632353783, -0.021993018686771393, 0.006115132011473179, 0.03671761229634285, -0.02207348123192787, 0.00414045387879014, 0.02800086699426174, -0.03494744375348091, 0.01982053741812706, -0.02396434359252453, 0.02151024527847767, 0.02045082487165928, 0.02295856550335884, -0.035939812660217285, 0.03701264038681984, -0.015891296789050102, -0.009702407754957676, 0.04181355610489845, -0.010399747639894485, -0.021791862323880196, -0.0095750093460083, -0.04057980328798294, 0.032640859484672546, 0.03811229392886162, 0.009380558505654335, -0.010654544457793236, 0.006141952704638243, 0.0010971365263685584, 0.010641134344041348, 0.016374070197343826, -0.047580018639564514, -0.03162166848778725, -0.012612460181117058, 0.032640859484672546, 0.005863687489181757, 0.010661249980330467, 0.0243934765458107, 0.04146488755941391, 0.00596091290935874, -0.020477646961808205, 0.038434140384197235, 0.005136174615472555, -0.01770169846713543, -0.010775238275527954, -0.007060563657432795, -0.026780523359775543, -0.021027471870183945, -0.03744177520275116, -0.03773680329322815, 0.012981245294213295, -0.031058434396982193, -0.0010602580150589347, -0.04696314036846161, -0.006866113282740116, -0.02672688290476799, -0.010044372640550137, -0.015073264017701149, 0.0061788312159478664, -0.0031782593578100204, -0.02859092503786087, 0.005156290251761675, -0.009219634346663952, 0.01919024996459484, -0.023441338911652565, 0.006286114454269409, 0.018010137602686882, -0.042162224650382996, 0.028322717174887657, 0.023602264001965523, -0.04374464973807335, 0.006349813658744097, 0.019404815509915352, -0.02939554676413536, -0.010493620298802853, -0.022837873548269272, -0.015475575812160969, -0.009132467210292816, 0.03336501866579056, 0.059863924980163574, -0.006423570681363344, 0.007402528077363968, -0.005431202705949545, -0.012485061772167683, -0.010144950821995735, -0.03306999057531357, 0.016749560832977295, 0.0362616591155529, 0.019538920372724533, 0.0034012070391327143, -0.0034699351526796818, -0.03296270594000816, 0.010017551481723785, -0.024675093591213226, -0.014523439109325409, 0.03121935762465, -0.02074585296213627, -0.027424221858382225, 0.0392119437456131, -0.00273236446082592, 0.06581813097000122, 0.009045299142599106, 0.008877669461071491, 0.027370579540729523, 0.006051432806998491, -0.028134971857070923, 0.010681365616619587, -0.0010728301713243127, -0.04060662165284157, 0.0059273866936564445, 0.000692310743033886, -0.011680439114570618, -0.008710039779543877, -0.021027471870183945, -0.005515017546713352, 0.03247993439435959, -0.0010091308504343033, 0.03548385947942734, 0.024031396955251694, 0.014174768701195717, -0.009756049141287804, -0.04264499992132187, 0.012297316454350948, 0.043181415647268295, -0.011231191456317902, -0.0005196520942263305, -0.018854990601539612, 0.0030257164034992456, 0.01727256551384926, -0.007643915247172117, 0.003778373822569847, -0.0027021910063922405, 0.015247599221765995, 0.003473287681117654, 0.011841363273561, 0.0022076833993196487, 0.00573964137583971, -0.016146093606948853, -0.00670183589681983, 0.01664227806031704, -0.019673023372888565, -0.0053239199332892895, 0.013598122633993626, 0.015649911016225815, 0.012263789772987366, 0.01707141101360321, -0.0062324730679392815, 0.02574792504310608, -0.009246455505490303, 0.011030035093426704, -0.002531208796426654, -0.04956475645303726, -0.005159642547369003, 0.005682647228240967, 0.015328061766922474, -0.0053742085583508015, -0.00689293397590518, -0.03363322466611862, 0.005179758183658123, 0.030307453125715256, -0.006108426954597235, 0.003189993556588888, 0.02663300931453705, 0.02588202804327011, 0.022757411003112793, 0.028349537402391434, 0.07858481258153915, -0.021121343597769737, -0.09301437437534332, -0.017044588923454285, -0.0032872187439352274, 0.013162285089492798, 0.008314433507621288, -0.010808764025568962, 0.015502396039664745, 0.008039521053433418, 0.04304731264710426, 0.00416056951507926, -0.001949533587321639, -0.05128128454089165, 0.002745774807408452, 0.006041374988853931, 0.041572168469429016, -0.033525943756103516, -0.00963535625487566, -0.01638748124241829, 0.0337136872112751, 0.010279053822159767, -0.017044588923454285, -0.007301950361579657, 0.03848778456449509, 0.009058710187673569, -0.03186305612325668, -0.010238823480904102, 0.006752124987542629, -0.011579860933125019, 0.010507030412554741, 0.02515786699950695, -0.008435127325356007, -0.02015579678118229, 0.012485061772167683, 0.027625378221273422, -0.031782593578100204, 0.027330348268151283, -0.009119056165218353, 0.016883665695786476, 0.020651981234550476, 0.026056362316012383, -0.00414045387879014, -0.022516023367643356, 0.04261817783117294, -0.0069398703053593636, 0.007596978917717934, -0.007972469553351402, 0.0432886965572834, -0.02918098121881485, 0.012257085181772709, 0.009447610937058926, 0.026016132906079292, 0.028564102947711945, 0.010124835185706615, 0.0011759224580600858, -0.010299169458448887, -0.03376733139157295, -0.030200170353055, -0.00577987264841795, -0.004485771059989929, 0.012122981250286102, 0.001949533587321639, 0.023709546774625778, -0.0151000851765275, -0.009561599232256413, -0.06721281260251999, -0.029341906309127808, 0.012974539771676064, 0.01156645081937313, -0.017782161012291908, -0.05315873399376869, -0.01617291569709778, 0.010473504662513733, -0.00796576403081417, 0.014255231246352196, -0.01626678742468357, -0.03795136883854866, -0.00433155195787549, 0.023159721866250038, -0.028778670355677605, -0.0025781451258808374, 0.03926558420062065, -0.0224087405949831, 0.017299387603998184, 0.004214210901409388, 0.018667245283722878, 0.03867552801966667, 0.010500325821340084, -0.01672274060547352, -0.023092670366168022, 0.02185891568660736, 0.042537715286016464, 0.015958348289132118, 0.02236850932240486, -0.0030206874944269657, 0.003966119140386581, -0.005045654252171516, 0.01978030614554882, 0.03454513102769852, -0.010869110934436321, -0.0003865960461553186, 0.038353677839040756, 0.03296270594000816, -0.04232314974069595, -0.03400871530175209, 0.01566332019865513, 0.006648194510489702, 0.04353008419275284, -0.011291537433862686, 0.031782593578100204, -0.02982467971742153, 0.0422695092856884, -0.003104502335190773, 0.013222631998360157, 0.0417599156498909, -0.008401601575314999, 0.024554401636123657, 0.04342280328273773, 0.058683812618255615, 0.04503204673528671, -0.003536987118422985, -0.0027239827904850245, -0.009937089867889881, -0.0007484667003154755, -0.0016679157270118594, -0.030039245262742043, -0.014845287427306175, -0.014456386677920818, 0.0397215373814106, 0.00026946477009914815, 0.015207367949187756, 0.025560179725289345, 0.006121837068349123, 0.007442759349942207, 0.03977517783641815, -0.004472360946238041, 0.008730155415832996, 0.024996943771839142, 0.020437415689229965, -0.023857060819864273, 0.031192537397146225, 0.011043446138501167, 0.009688997641205788, 0.027223065495491028, 0.008153509348630905, 0.0166020467877388, 0.006812471896409988, -0.02020943909883499, -0.03913148120045662, 0.00864298827946186, 0.028054509311914444, 0.056055378168821335, -0.0014223381876945496, 0.004026465583592653, 0.03336501866579056, -0.006738714408129454, 0.04285956546664238, 0.023240184411406517, -0.000283084693364799, -0.027813123539090157, 0.0035872759763151407, 0.025265151634812355, 0.03239947184920311, -0.000913581985514611, -0.04141124710440636, 0.004935018718242645, -0.020947009325027466, -0.018479499965906143, -0.022985387593507767, 0.009239749982953072, -0.00705385860055685, -0.013725521042943, -0.04473701864480972, 0.02990514226257801, 0.032292187213897705, 0.021148165687918663, -7.202839333331212e-05, -0.009474431164562702, 0.010118129663169384, -0.004287968389689922, 0.042966850101947784, -0.007885301485657692, 0.021188396960496902, 0.005937444511801004, 0.012424714863300323, 0.013712110929191113, -0.0022277990356087685, -0.03787090629339218, -0.008193740621209145, -0.0002457870577927679, 0.01591811701655388, 0.00796576403081417, 0.018573373556137085, -0.010124835185706615, 0.014255231246352196, 0.02266353741288185, -0.023092670366168022, 0.007905417121946812, 0.046319443732500076, -0.015046443790197372, -0.03497426584362984, -0.03357958421111107, 0.06270692497491837, 0.010480210185050964, -0.016454532742500305, -0.05382925644516945, 0.014469796791672707, 0.005722878500819206, -0.04417378455400467, 0.0006763858837075531, 0.013410377316176891, 0.006440333556383848, 0.02007533423602581, 0.002539590233936906, 0.01567673124372959, 0.042966850101947784, -0.05399017781019211, -0.0019210365135222673, -0.00022127122792880982, -0.023857060819864273, -0.012270495295524597, -0.0513349249958992, -0.028322717174887657, -0.005907271057367325, 0.011050150729715824, -0.0073287710547447205, 0.027343759313225746, 0.03306999057531357, 0.004549470730125904, 0.009132467210292816, 0.019887588918209076, -0.014885518699884415, 0.028537282720208168, -0.031272999942302704, 0.02151024527847767, -0.021014060825109482, -0.01711164228618145, -0.022851282730698586, -0.006618021056056023, 0.01147928275167942, -0.0004492476291488856, 0.037334490567445755, 0.02070562355220318, 0.012102865613996983, -0.013906561769545078, 0.022676948457956314, 0.014751414768397808, 0.027759481221437454, 0.03006606549024582, -0.023186542093753815, 0.008381485939025879, -0.010721596889197826, 0.006373282056301832, 0.00043206560076214373, -0.02020943909883499, -0.010989803820848465, 0.007824955508112907, -0.003885656828060746, 0.05106671527028084, 0.03467923402786255, 0.011673733592033386, -0.04221586883068085, 0.03312363103032112, 0.01770169846713543, 0.0020283195190131664, 0.0016528289997950196, -0.018707476556301117, 0.0032687794882804155, -0.004395251162350178, 0.013946792110800743, 0.00891790073364973, -0.009192814119160175, -0.004539412911981344, 0.014590490609407425, 0.015515806153416634, 0.00872345082461834, 0.0032536927610635757, 0.05514347180724144, -0.0030642712954431772, 0.030012425035238266, -0.002177509944885969, -0.007362297270447016, -0.034115999937057495, -0.009514662437140942, 0.044871121644973755, 0.02151024527847767, -0.02680734358727932, 0.014657542109489441, -0.020383773371577263, 0.0198607686907053, 0.042028121650218964, -0.013685289770364761, 0.042671822011470795, -0.011988877318799496, -0.032131265848875046, 0.0332040935754776, -0.018627014011144638, -0.013906561769545078, 0.022945156320929527, 0.027464453130960464, -0.01642771251499653, 0.03532293438911438, 0.0011843038955703378, -0.006292819511145353, -0.007221488282084465, -0.003086063079535961, 0.015301240608096123, -0.029368726536631584, -0.034115999937057495, -0.002646873239427805, -0.0256674624979496, -0.014214999973773956, 0.02185891568660736, 0.01153962966054678, 0.025466306135058403, 0.014094306156039238, 0.006544264033436775, -0.03210444375872612, -0.006309582386165857, 0.01799672655761242, -0.008287613280117512, 0.02731693908572197, 0.02859092503786087, 0.014214999973773956, 0.025560179725289345, -0.02096042037010193, -0.02549312822520733, -0.03355276584625244, -0.00736900232732296, -0.01897568441927433, 0.025868616998195648, 0.0002060797851299867, 0.0114591671153903, -0.007496400736272335, 0.0027826533187180758, -0.013276273384690285, -0.004757331218570471, 0.008837439119815826, -0.006718599237501621, -0.021335911005735397, -0.01860019378364086, 0.035939812660217285, 0.028939593583345413, -0.01634724996984005, 0.013390261679887772, -0.03210444375872612, 0.029958782717585564, -0.006527501158416271, -0.00026904570404440165, 0.01889522187411785, -0.024326425045728683, 0.06356518715620041, 0.0017089849570766091, 0.008736860938370228, 0.014872108586132526, -0.01351095549762249, 0.045219793915748596, -0.0023283767513930798, -0.023494981229305267, -0.013457314111292362, 0.022690357640385628, -0.003815252333879471, 0.034411028027534485, -0.00808645784854889, -0.004938371479511261, 0.016575226560235023, -0.010895931161940098, -0.0276521984487772, 0.01593152806162834, 0.005981028079986572, 0.029502829536795616, -0.0009563275380060077, 0.007114205043762922, 0.002187567763030529, -0.04039205610752106, 0.0027239827904850245, 0.005635710898786783, 0.0022127123083919287, 0.015770602971315384, 0.009943794459104538, 0.027598556131124496, -0.0031715543009340763, -0.020464235916733742, -0.0357520654797554, 0.024487348273396492, -0.019579151645302773, 0.039533793926239014, 0.01503303274512291, 0.0013628295855596662, -0.007999289780855179, -0.0004496667243074626, 0.01668250933289528, -0.007918828167021275, -0.006980101577937603, 0.005320567172020674, -0.024259373545646667, 0.03226536884903908, 0.016280198469758034, 0.013021476566791534, -0.017299387603998184, 0.027115782722830772, 0.0115597452968359, -0.012780089862644672, 0.023575443774461746, 0.005629005841910839, -0.0017668171785771847, 0.0282154344022274, -0.0203703623265028, 0.030682943761348724, 0.007080679293721914, -0.008213856257498264, -0.012277200818061829, -0.00206519803032279, -0.01809059828519821, 0.04570256546139717, -0.021590707823634148, -0.005836866796016693, 0.0028044451028108597, 0.014965981245040894, -0.033016350120306015, -0.008488768711686134, -0.030468378216028214, -0.021738221868872643, -0.0039560613222420216, -0.006423570681363344, 0.004428776912391186, -0.007033742964267731, -0.014322282746434212, 0.02397775463759899, 0.013665174134075642, 0.008589346893131733, -0.019431637600064278, -0.0030257164034992456, -0.01923048123717308, -8.093372161965817e-05, 0.0027658904436975718, 0.01514031644910574, 0.01575719378888607, -0.002107105450704694, -0.030226990580558777, 0.021872324869036674, -0.014268641360104084, 0.02880549058318138, 0.030656123533844948, 0.006467154249548912, -0.036154378205537796, -0.021282268688082695, -0.021751632913947105, -0.000800012843683362, 0.00752992695197463, 0.018989093601703644, -0.020638570189476013, 0.01374563667923212, 0.0037280849646776915, 0.004438834730535746, -0.035215649753808975, -0.009923678822815418, -0.016615457832813263, -0.015180546790361404, -0.0014458063524216413, -0.012867256999015808, 0.032372649759054184, -0.013417082838714123, 0.031272999942302704, 0.00893801636993885, 0.0014047370059415698, 0.019686434417963028, 0.012324136681854725, 0.06662275642156601, 0.026110004633665085, -0.024420296773314476, 0.019297532737255096, -0.007027037907391787, 0.02346816100180149, -0.0033090105280280113, -0.00596091290935874, -0.0001929837162606418, -0.007114205043762922, -0.02527856081724167, -0.0035235765390098095, 0.008656398393213749, -0.03304316848516464, -0.012920898385345936, 0.004368430469185114, 0.0003176583268214017, 0.016199735924601555, 0.005913976579904556, 0.021121343597769737, 0.0021054293029010296, -0.009883448481559753, -0.02845682017505169, 0.017339617013931274, 0.00032562072738073766, -0.009863332845270634, 0.005981028079986572, -0.006530853919684887, -0.0069733960554003716, 0.022140532732009888, -0.01829175464808941, -0.016186324879527092, -0.024460528045892715, -0.028483642265200615, 0.024111857637763023, -0.015328061766922474, 0.009192814119160175, -0.0231731329113245, -0.003764963475987315, -0.003996292594820261, -0.023226773366332054, 0.008575936779379845, -0.00718796206638217, 0.020638570189476013, -0.02134932018816471, 0.008763681165874004, 0.037629518657922745, 0.045595284551382065, -0.005226694513112307, -0.005404382012784481, -0.00029251386877149343, 0.014188178814947605, -0.023441338911652565, 0.028859132900834084, 0.00864298827946186, -0.006480564828962088, 0.018734296783804893, -0.019404815509915352, -0.015381703153252602, -0.0261770561337471, -0.0031564675737172365, -0.0021121343597769737, 0.02663300931453705, -0.02714260295033455, -0.007831660099327564, 0.023387698456645012, 0.0022378566209226847, 0.007201372645795345, 0.014845287427306175, 0.0021640995983034372, 0.00806634221225977, 0.012042518705129623, -0.009434200823307037, 0.020558107644319534, -0.026284338906407356, 0.010299169458448887, 0.00874356646090746, 0.025385843589901924, 0.03489380329847336, 0.023736367002129555, 0.0092933913692832, 0.02523832954466343, -0.013142169453203678, 0.03545703738927841, 0.009025183506309986, 0.005085885524749756, -0.015542627312242985, -0.010379632003605366, -0.0006617183098569512, 0.033901434391736984, 0.02486283890902996, 0.025506537407636642, -0.006202299613505602, 0.011807837523519993, -0.02193937823176384, 0.010869110934436321, 0.027209656313061714, 0.011150728911161423, -0.00010450665286043659, -0.00987003743648529, 0.009621946141123772, -0.02702191099524498, -0.049403831362724304, 0.047284990549087524, 0.0036107441410422325, 0.015649911016225815, 0.0072080777026712894, -0.01842585764825344, 0.004157216753810644, 0.013799278065562248, 0.04513933137059212, 0.011506103910505772, 0.0198607686907053, 0.0019696492236107588, -0.008153509348630905, 0.00838819146156311, -0.0105673773214221, -0.022609896957874298, -0.030092887580394745, 0.0028295896481722593, 0.005665884353220463, -0.008401601575314999, -0.026619598269462585, 0.010151655413210392, -0.0023602263536304235, 0.026914628222584724, -0.0020182617008686066, -0.012310726568102837, 0.02719624526798725, 0.015006212517619133, 0.014013844542205334, -0.032426293939352036, 0.012625870294868946, -0.008535705506801605, -0.010232117958366871, 0.004217563662678003, -0.032667677849531174, 0.00804622657597065, -0.024380065500736237, -0.001253870315849781, -0.0033408603630959988, -0.006980101577937603, 0.055411677807569504, 0.00528368866071105, -0.030817046761512756, 0.014496617950499058, -0.000402730394853279, -0.008562525734305382, 0.037709981203079224, -0.010775238275527954, 0.023199953138828278, 0.005152937490493059, -0.03518883138895035, -0.010701481252908707, 0.023494981229305267, -0.0069130496121943, -0.025560179725289345, -0.01919024996459484, 0.017674878239631653, -0.01597175933420658, 0.01960597187280655, 0.0024423650465905666, -0.017983315512537956, -0.0016871930565685034, 0.00861616712063551, -0.028993235900998116, -0.007100794930011034, -0.008837439119815826, 0.04283274710178375, -0.0002847609866876155, -0.017822392284870148, -0.012357662431895733, 0.0376831591129303, -0.006980101577937603, 0.027008499950170517, -0.00367444334551692, -0.0032469877041876316, -0.011418936774134636, -0.0008641312015242875, -0.0050925905816257, -0.026860985904932022, 0.0028094740118831396, 0.03698582202196121, -0.003086063079535961, -0.018372217193245888, -0.013155580498278141, 0.045675747096538544, 0.019592560827732086, 0.02215394377708435, 0.008019405417144299, 0.020008282735943794, -0.013893150724470615, 0.01944504678249359, 0.012531997635960579, -0.00184225058183074, 0.0016964126843959093, 0.020424004644155502, 0.008207150734961033, 0.007791429292410612, -0.02969057485461235, 0.007127615623176098, -0.005300451535731554, 0.02176504209637642, -0.020021693781018257, 0.01833198592066765, 0.007858481258153915, -0.03363322466611862, 0.02096042037010193, 0.005344035569578409, -0.0231731329113245, -0.006708541419357061, 0.033525943756103516, -0.007516516372561455, 0.039453331381082535, 0.018814759328961372, 0.04285956546664238, -0.010540556162595749, -0.03121935762465, 0.015542627312242985, -0.000342174171237275, 0.026673240587115288, 0.015609678812325, -0.020933598279953003, -0.042591359466314316, -0.0030642712954431772, -0.024956712499260902, -0.01080205850303173, -0.031246179714798927, 0.0261770561337471, -0.03698582202196121, 0.004505886696279049, 0.007033742964267731, 0.03159485012292862, 0.02423255145549774, 0.01740667037665844, -0.004619874991476536, -0.0007317037088796496, -0.006799061316996813, 0.027920406311750412, -0.003007277147844434, -0.028108151629567146, -0.017943084239959717, -0.042081765830516815, -0.03363322466611862, 0.013001360930502415, 0.0035202240105718374, 0.01652158424258232, 0.0029553119093179703, -0.037844084203243256, -0.008160214871168137, -0.018010137602686882, -0.009239749982953072, -0.0018774528289213777, -0.0057195257395505905, 0.04041887819766998, 0.009072120301425457, 0.030736584216356277, -0.04556846246123314, 0.017165282741189003, -0.043771471828222275, 0.023857060819864273, 0.0063866921700537205, 0.00930009689182043, -0.0030894156079739332, -0.017782161012291908, -0.004267852753400803, -0.0238838829100132, -0.01347072422504425, -0.0006571084959432483, 0.007637209724634886, 0.00806634221225977, 0.00010214935900876299]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"2023) generalizes LoRA by introducing a
prompt module; Delta-LoRA (Zi et al., 2023) proposes to
simultaneously update pretrained model weights by differ-
ence of LoRA weights. QLoRA (Dettmers et al., 2023)
exploits quantized LoRA model which further reduces the
model size. Besides such additive methods, there are also
multiplicative PEFT methods such as the orthogonal fine-
tuning method (OFT) (Qiu et al., 2023) and its variant BOFT
(Liu et al., 2023).
Though LoRA has become very popular and different vari-
ants emerge, current LoRA training mainly exploits gradi-
ent based optimizers and we are unaware of any prior work
studying acceleration of LoRA training given its special
low-rank matrix factorization nature. Our work shows that
by regrouping trainable parameters and applying an r×r
preconditioner, the optimization procedure of LoRA can be
significantly enhanced with negligible storage and runtime
overhead.
9. Conclusion
In this work, we borrow tools from Riemannian optimiza-
tion to enhance LoRA fine-tuning. Specifically, we study
the application of a Riemannian gradient preconditioning
method which introduces a new r×rpreconditioner to
LoRA fine-tuning procedure. Empirically, we observe that
the gradient scaling boosts performance of both SGD and
AdamW methods and theoretically we show that LoRA
trained with preconditioned Adam method achieves stable
feature learning under infinite-width NN setting while un-
preconditioned training would require tuning learning rates
for LoRA parameters separately. Prior to our work, theo-
retic convergence for the proposed gradient scaling scheme
has only been established for classic low-rank matrix opti-
mization problems and only with gradient descent method,
we first time introduces it to deep learning regime consid-
ering the low-rank nature of LoRA model and reveals its
superiority beyond SGD.
Acknowledgements
This work was supported in part by the National Science
Foundation (NSF) under Grant DMS-2134248; in part by
the NSF CAREER Award under Grant CCF-2236829; in
9
Riemannian Preconditioned LoRA
part by the U.S. Army Research Office Early Career Award
under Grant W911NF-21-1-0242; and in part by the Office
of Naval Research under Grant N00014-24-1-2164.
Impact Statement
This paper aims to advance the field of machine learning
through innovative research. While our work holds signif-
icant potential for societal impact, we do not identify any
specific consequences that needs to be highlighted here.
References
Candes, E. J., Li, X., Ma, Y ., and Wright, J. Robust principal
component analysis?, 2009.
Chavan, A., Liu, Z., Gupta, D., Xing, E., and Shen, Z.
One-for-all: Generalized lora for parameter-efficient fine-
tuning, 2023.
Dettmers, T., Pagnoni, A., Holtzman, A., and Zettlemoyer,
L. Qlora: Efficient finetuning of quantized llms, 2023.
Duchi, J., Hazan, E., and Singer, Y . Adaptive subgradi-
ent methods for online learning and stochastic optimiza-
tion. Journal of Machine Learning Research , 12(61):
2121–2159, 2011.
Gal, R., Alaluf, Y ., Atzmon, Y ., Patashnik, O., Bermano,
A. H., Chechik, G., and Cohen-Or, D. An image is worth
one word: Personalizing text-to-image generation using
textual inversion, 2022.
Gardent, C., Shimorina, A., Narayan, S., and Perez-
Beltrachini, L. The WebNLG challenge: Generat-
ing text from RDF data. In Alonso, J. M., Bugar ´ın,
A., and Reiter, E. (eds.), Proceedings of the 10th In-
ternational Conference on Natural Language Gener-
ation , pp. 124–133, Santiago de Compostela, Spain,
September 2017. Association for Computational Lin-
guistics. doi: 10.18653/v1/W17-3518. URL https:
//aclanthology.org/W17-3518 .
Gu, Y ., Wang, X., Wu, J. Z., Shi, Y ., Chen, Y ., Fan, Z.,
Xiao, W.,","[0.0003462428867351264, 0.020551837980747223, 0.01996234618127346, -0.029179859906435013, -0.006367184687405825, -0.010517075657844543, -0.020993957296013832, 0.0016437117010354996, -0.06629107147455215, 0.028188440948724747, 0.005861427169293165, 0.010637653060257435, -0.05648406222462654, 0.008293082006275654, 0.034485287964344025, 0.006822701543569565, 0.018167074769735336, -0.04105008766055107, 0.00286540063098073, 0.06120000034570694, 0.024356741458177567, -0.03837057948112488, 0.008882574737071991, 0.0009805330773815513, 0.017457004636526108, -0.022789228707551956, 0.038129422813653946, 0.07722346484661102, 0.01272767037153244, -0.009492162615060806, 0.02396821416914463, -0.026446759700775146, -0.04906181991100311, -0.03740595281124115, -0.01450954470783472, 0.019640805199742317, 0.024879246950149536, -0.00780407153069973, -0.01831444911658764, 0.003344362834468484, -0.017912521958351135, -0.10198213905096054, -0.016532573848962784, 0.030841154977679253, 0.010731436312198639, 0.02441033348441124, 0.028965499252080917, 0.01639859937131405, -0.002887171693146229, 0.029796147719025612, -0.05953870341181755, 0.019064711406826973, -0.04335446655750275, -0.03633414953947067, -0.06018178537487984, -0.0045384191907942295, 0.029662171378731728, 0.031591419130563736, 0.037004027515649796, -0.003235507756471634, -0.011401313357055187, -0.04472101479768753, 0.05787740647792816, -0.01709527149796486, -0.02335192635655403, -0.03574465960264206, -0.06768441200256348, -0.025910858064889908, 0.003875240683555603, 0.022199736908078194, -0.015300000086426735, -0.0020448006689548492, 0.059485115110874176, -0.028643958270549774, -0.0016654826467856765, 0.01373248640447855, 0.01245971955358982, 0.09608721733093262, 0.0013539897045120597, -0.02013651467859745, 0.0007490066927857697, -0.004883406218141317, 0.02205236442387104, -0.0345388799905777, -0.030546410009264946, -0.033869002014398575, -0.007207880727946758, -0.004866659175604582, -0.03145744279026985, 0.035530298948287964, -0.01202429924160242, -0.01969439536333084, -0.02282942272722721, -0.0011848456924781203, 0.0360662005841732, 0.026299387216567993, 0.05428686365485191, 0.009036646224558353, 0.059163570404052734, 0.020163310691714287, -0.023164359852671623, -0.03461926430463791, 0.03461926430463791, -0.03879930078983307, 0.022266725078225136, -0.01943984255194664, 0.00967972818762064, -0.011997504159808159, 0.010510376654565334, 0.014844483695924282, -0.04348843917250633, 0.02859036810696125, -0.0442654974758625, -0.017242643982172012, 0.029608581215143204, -0.10305394232273102, -0.06596952676773071, -0.02179781161248684, -0.021985376253724098, 0.000865816546138376, -0.04506935179233551, -0.011006086133420467, 0.008266286924481392, 0.024276357144117355, 0.04177355393767357, -0.03636094555258751, 0.07004237920045853, -0.0519556924700737, 0.01373248640447855, -0.007027014158666134, 0.04857951030135155, 0.060288965702056885, 0.040487390011548996, -0.03625376522541046, -0.04046059399843216, -0.03598581254482269, 0.005804487504065037, -0.024718476459383965, -0.02762574329972267, -0.01682732068002224, 0.014482749626040459, -0.04139842465519905, -0.01752399280667305, 0.007897854782640934, -0.04322049021720886, 0.005717403721064329, -0.015313397161662579, 0.0045652142725884914, -0.01373248640447855, 0.007053809240460396, -0.003140050219371915, -0.017068475484848022, -0.05326865240931511, 0.018448423594236374, -0.025482136756181717, -0.002584052039310336, 0.006343739107251167, 0.005603524390608072, 0.02345910668373108, -0.009472066536545753, 0.017925919964909554, 0.06082486733794212, 0.040058668702840805, -0.016519175842404366, 0.0700959712266922, 0.0030244963709264994, -0.008293082006275654, 0.01534019224345684, -0.07893835008144379, -0.014898073859512806, 0.005848029628396034, -0.042845357209444046, -0.05018721520900726, -0.012647285126149654, 0.0075897108763456345, -0.003500109538435936, 0.004906851798295975, -0.02266865223646164, 0.015728721395134926, -0.029876532033085823, -0.00442454032599926, 0.009907486848533154, -0.0425238162279129, 0.01856900192797184, -0.04263099655508995, 0.009974474087357521, -0.010095052421092987, -0.014616725035011768, 0.019587215036153793, 0.056537654250860214, 0.010396497324109077, -0.004113047383725643, 0.08847741037607193, 0.020525043830275536, 0.01980157569050789, -0.036923643201589584, 0.034565672278404236, 0.009371585212647915, -0.01272767037153244, -0.027920490130782127, -0.003386230207979679, 0.06082486733794212, 0.013578414916992188, -0.05857408046722412, 0.014054028317332268, -0.017671365290880203, -0.004936996381729841, -0.02616541087627411, -0.0187565665692091, -0.05040157586336136, 0.030707180500030518, 0.04051418602466583, 0.059485115110874176, -0.023753853514790535, -0.02711663767695427, 0.007355253677815199, -0.05241120979189873, 0.04359562322497368, 0.01158887892961502, 0.043461646884679794, -0.001174797536805272, -0.0010224003344774246, -0.024035200476646423, 0.023861033841967583, -0.0013087729457765818, -0.010436689481139183, -0.007335157599300146, -0.029501400887966156, 0.051473379135131836, -0.04271138459444046, 0.06130718067288399, 0.0048767076805233955, -0.006109281908720732, 0.00675571383908391, 0.03938879072666168, -0.05168773978948593, 0.020350875332951546, -0.06082486733794212, 0.024638090282678604, -0.00636383518576622, -0.013390849344432354, -0.0013992064632475376, 0.00010670937626855448, -0.007288265973329544, -0.0016420369502156973, 0.031055515632033348, -0.017590980976819992, -0.026808492839336395, 0.03009089268743992, -0.020538441836833954, 0.007348555140197277, 0.006414076313376427, -0.009606041945517063, -0.03510157763957977, -0.026259195059537888, 0.023780647665262222, -0.011280735023319721, 0.0005170616204850376, -0.027759719640016556, -0.0057408493012189865, -0.026098422706127167, -0.02328493818640709, 0.03786147013306618, 0.03137705847620964, 0.0009395030792802572, -0.0039053852669894695, -0.021663835272192955, 0.03515516594052315, 0.010751532390713692, 0.029608581215143204, -0.0024283055681735277, -0.003694373881444335, -0.03469964861869812, 0.005174803081899881, -0.04439947381615639, 0.018877144902944565, 0.05230402946472168, 0.02439693547785282, -0.03912084177136421, -0.0021787763107568026, 0.022641856223344803, 0.07223957777023315, 0.09115691483020782, 0.008058625273406506, 0.001549928798340261, 0.0020565236918628216, -0.008159106597304344, -0.03566427156329155, -0.04134483262896538, 0.004863310139626265, 0.025066811591386795, -0.02328493818640709, 0.04611435905098915, -0.02990332804620266, -0.007053809240460396, -0.00738874776288867, 0.013973643071949482, -0.04399754852056503, 0.012754465453326702, -0.00623655878007412, 0.04113047197461128, 0.008272985927760601, 0.006661930587142706, 0.0007293290109373629, -0.035798247903585434, 0.042148686945438385, 0.022387303411960602, -0.019935552030801773, 0.00242998031899333, 0.014442556537687778, 0.018769964575767517, 0.0549299456179142, -0.005040827672928572, 0.037271980196237564, -0.02624579705297947, -0.03006409853696823, 0.0420147106051445, -0.01943984255194664, 0.003391254460439086, -0.03799544647336006, -0.016773730516433716, -0.02423616498708725, 0.0059719569981098175, 0.001436887076124549, 0.001183170941658318, -0.011568782851099968, -0.017765149474143982, 0.014790892601013184, -0.025307968258857727, -0.029340630397200584, 0.010805122554302216, -0.0002746497339103371, 0.03293117135763168, 0.007355253677815199, -0.039897896349430084, 0.009914185851812363, -0.050347983837127686, 0.03598581254482269, 0.057502277195453644, 0.011495096608996391, -0.06248616427183151, -0.005472898483276367, -0.010148642584681511, 0.005945161916315556, -0.02181120775640011, -0.006692075170576572, 0.0031450744718313217, -0.01377267949283123, 0.006765761878341436, 0.01736322231590748, -0.0016813923139125109, -0.004682443104684353, 0.03362784534692764, -0.03161821514368057, 0.005653765052556992, 0.019573817029595375, 0.017577582970261574, -0.04884745925664902, -0.025428546592593193, 0.007134194485843182, -0.025951050221920013, 0.03898686543107033, -0.0009009850909933448, 0.005315477028489113, -0.010671147145330906, -0.010731436312198639, 0.029769351705908775, 0.017457004636526108, 0.02686208300292492, -0.02859036810696125, 0.021476268768310547, 0.00985389668494463, -0.02936742454767227, -0.01576891355216503, -0.05005323886871338, 0.028108056634664536, 0.026366375386714935, 0.028724342584609985, -0.0017349824775010347, 0.041291244328022, -0.0107582313939929, -0.002162029268220067, -0.012439623475074768, -0.03051961399614811, -0.005054225213825703, 0.03920122608542442, -0.0052920314483344555, -0.021235113963484764, -0.03732556849718094, -0.01286164578050375, -0.029956918209791183, -0.005637018475681543, -0.027679333463311195, 0.014496146701276302, -0.007422241847962141, 0.008768695406615734, -0.025669701397418976, 0.02912626974284649, 0.044158317148685455, 0.018622592091560364, -0.006705472711473703, 0.02284281887114048, -0.018153676763176918, 0.01199080515652895, -0.010376401245594025, 0.028134850785136223, 0.01777854561805725, 0.07984938472509384, 0.007147592026740313, 0.03705761954188347, -0.006159522570669651, -0.04000507667660713, 0.030144482851028442, -0.016452189534902573, 0.025910858064889908, -0.01708187349140644, -0.013303765095770359, 0.02057863399386406, 0.007998336106538773, 0.06302206963300705, 0.03574465960264206, 0.0017148861661553383, -0.02065901830792427, -0.02781330980360508, -0.029769351705908775, 0.022347109392285347, 0.017135463654994965, -0.06666620075702667, 0.0075495182536542416, -0.06034255772829056, -0.01605026237666607, -0.022896409034729004, 0.011923817917704582, -0.027518562972545624, -0.014898073859512806, -0.044077932834625244, -0.009599342942237854, 0.061253588646650314, 0.03981751203536987, -0.0333063043653965, 0.01709527149796486, 0.03478003293275833, -0.03871891275048256, -0.0034934107679873705, 0.006749014835804701, 0.020632224157452583, -0.02423616498708725, 0.031109105795621872, -0.01547416765242815, -0.0420147106051445, -0.005670512095093727, 0.008574430830776691, 0.05589457228779793, -0.008621321991086006, -0.0028319067787379026, -0.06779159605503082, 0.07320420444011688, -0.025669701397418976, 0.03992469236254692, 0.005988704040646553, 0.012694177217781544, -0.00019039171456824988, -0.029179859906435013, -0.006598292384296656, -0.004521672613918781, 0.04062136635184288, 0.023258144035935402, 0.016840718686580658, 0.02615201473236084, 0.002841954817995429, -0.006554750259965658, -0.024021804332733154, -0.030037302523851395, -0.025910858064889908, -0.020297285169363022, 0.03306514769792557, 0.0065078590996563435, -0.04019264504313469, 0.004015915095806122, -0.011535288766026497, 0.03451208397746086, -0.009927582927048206, 0.03625376522541046, -0.015353590250015259, 0.02700945734977722, 0.03654851019382477, 0.042577408254146576, 0.049195796251297, 0.013149693608283997, 0.005288681946694851, -0.006085836328566074, -0.006554750259965658, 0.04715937003493309, -0.014871278777718544, -0.03017127886414528, -0.03759352117776871, -0.037620313465595245, 0.00823949184268713, 0.01682732068002224, -0.021771015599370003, 0.001119532622396946, -0.025428546592593193, 0.01587609387934208, 0.02047145366668701, 0.0006133564747869968, 0.022333713248372078, 0.016331611201167107, 0.03373502567410469, 0.02337872050702572, 0.04967810958623886, 0.015433975495398045, 0.0618966706097126, -0.002642666455358267, 0.010229027830064297, 0.0064207748509943485, 0.03890648111701012, -0.01752399280667305, -0.0006133564747869968, -0.016251225024461746, 0.007810770533978939, 0.013136295601725578, 0.023606479167938232, -0.02773292362689972, -0.011876926757395267, 0.015500962734222412, 0.002878798171877861, -0.022909807041287422, -0.0703103318810463, -0.0034934107679873705, -0.020417863503098488, 0.025240980088710785, -0.013424343429505825, -0.019024517387151718, 0.019493432715535164, -0.05707355588674545, -0.0026175458915531635, 0.002294330159202218, -0.025522328913211823, -0.04707898572087288, 0.022521277889609337, 0.012285551987588406, 0.02491943910717964, 0.013250174932181835, 0.019828371703624725, -0.017296234145760536, -0.022119352594017982, 0.02353949286043644, -0.04367600753903389, -0.008949561975896358, 0.037781085819005966, 0.061950262635946274, -0.013799474574625492, 0.0017006512498483062, -0.016452189534902573, -0.02467828430235386, 0.007274868432432413, -0.003272351110354066, 0.030305253341794014, 0.014496146701276302, 0.015675131231546402, 0.008172504603862762, -0.004896803759038448, -0.008916067890822887, -0.004712587688118219, -0.006417425349354744, 0.0237270575016737, 0.01473730243742466, -0.02599124237895012, -0.016612960025668144, 0.002090017544105649, -0.018810156732797623, -0.010691243223845959, 0.01551436074078083, 0.015822503715753555, 0.014576531946659088, -0.01785893179476261, 0.03863852843642235, 0.0016663200221955776, 0.022025568410754204, 0.04305971786379814, -0.02396821416914463, -0.027679333463311195, -0.01874317042529583, -0.03346707671880722, -0.05852048844099045, -0.016706742346286774, -0.022199736908078194, 0.017738353461027145, -0.017148861661553383, 0.02171742543578148, 0.052009280771017075, -0.021904991939663887, -0.014134413562715054, -0.05088388919830322, -0.021395884454250336, -0.024638090282678604, -0.0007397958543151617, -0.018783362582325935, -0.008802189491689205, 0.020082924515008926, -0.004792972933501005, -0.005677211098372936, -0.0007448199321515858, -0.005426006857305765, 0.01796611212193966, -0.00880888756364584, -0.007181085646152496, 0.0018304400146007538, 0.017564184963703156, -0.015433975495398045, -0.021851401776075363, -0.027518562972545624, 0.00170483801048249, -0.02337872050702572, -0.021985376253724098, 4.3620533688226715e-05, -0.00594851141795516, -0.02040446549654007, 0.0700959712266922, 0.0036240366753190756, -0.001957716653123498, -0.0292066540569067, 0.010363003239035606, 0.007603108417242765, 0.01804649643599987, 0.009907486848533154, -0.004002517554908991, -0.024959631264209747, -0.02181120775640011, -0.01146830152720213, -0.026259195059537888, -0.05032119154930115, -0.009083537384867668, 0.005432705860584974, -0.005807837005704641, 0.012506610713899136, 0.000933641626033932, -0.02380744367837906, 0.03558388724923134, -0.01891733705997467, 0.033091943711042404, 0.04831155762076378, 0.006779159419238567, -0.01891733705997467, 0.04035341367125511, -0.022454289719462395, -0.0050743212923407555, 0.02092697098851204, -0.01692110300064087, -0.004193432629108429, -0.026178808882832527, -0.022333713248372078, 0.02893870323896408, 0.0213690884411335, 0.0046589975245296955, -0.010945796966552734, 0.01421479880809784, 0.0043341065756976604, 0.024008406326174736, 0.006795906461775303, -0.06832749396562576, -0.03652171418070793, -0.003250580048188567, 0.040755342692136765, 0.01202429924160242, 0.02067241631448269, 0.021690629422664642, 0.021462872624397278, -0.012386033311486244, 0.000764078926295042, 0.018702976405620575, -0.007207880727946758, 0.021757617592811584, -0.02163703925907612, -0.022521277889609337, -0.044506654143333435, -0.016693344339728355, -0.03202014043927193, -0.017912521958351135, 0.018100086599588394, -0.042148686945438385, 0.015648335218429565, -0.04568563774228096, -0.013893256895244122, -0.025589317083358765, 0.0017081873957067728, 0.02005613036453724, -0.00307306251488626, 0.006380582228302956, -0.02337872050702572, -0.00045886600855737925, -0.011408012360334396, 0.02230691723525524, -0.011381217278540134, 0.005181501619517803, 0.0395495630800724, -0.007663397584110498, 0.031698599457740784, -0.001147165079601109, -0.07063187658786774, 0.017457004636526108, 0.027076445519924164, -0.010349606163799763, 0.006119329947978258, -0.02789369598031044, -0.009579246863722801, -0.027397986501455307, -0.0033979532308876514, 0.06966724991798401, 0.007462434470653534, 0.008761996403336525, -0.004679093603044748, -0.02501322142779827, 0.016773730516433716, -0.03775428980588913, 0.010825218632817268, 0.047748859971761703, 0.012875043787062168, 0.009873992763459682, -0.013424343429505825, -0.0462215393781662, 0.0029759304597973824, -0.027840103954076767, -0.02363327518105507, 0.011099868454039097, -0.013853064738214016, -0.023244746029376984, 0.021864797919988632, -0.009478765539824963, 0.04051418602466583, -0.0041029988788068295, 0.006749014835804701, 0.019480034708976746, 0.01263388805091381, -0.013551619835197926, 0.023057179525494576, -0.021838003769516945, -0.01390665490180254, 0.0011036230716854334, -0.013498029671609402, -0.008514141663908958, -0.026553940027952194, -0.0026761603076010942, 0.020886776968836784, 0.01960061304271221, 0.0006179619231261313, 0.021154727786779404, 0.01918528974056244, 0.0178857259452343, 0.01927907206118107, -0.017242643982172012, 0.01203099824488163, 0.02414238080382347, -0.022789228707551956, -0.006139426492154598, -0.017296234145760536, 0.017122065648436546, 0.015929684042930603, -0.01909150555729866, -0.00793804693967104, -0.005700656678527594, 0.008246190845966339, 0.009833800606429577, 0.03713800385594368, 0.012439623475074768, 0.017845533788204193, 0.0020180055871605873, -0.005630319472402334, 0.006782508920878172, 0.009103633463382721, -0.0015331818722188473, -0.008185901679098606, 0.01002136617898941, 0.021931786090135574, -0.001949343248270452, 0.010074956342577934, 0.013565017841756344, 0.0067255692556500435, 0.018542205914855003, -0.015326795168220997, -0.028402801603078842, -0.01477749552577734, 0.008333275094628334, -0.017925919964909554, 0.008701707236468792, -0.02127530612051487, -0.021931786090135574, -0.0019912105053663254, 0.02990332804620266, -0.043809983879327774, -0.0228562168776989, 0.008380166254937649, 0.03006409853696823, 0.0006229860009625554, 0.02676830068230629, 0.06286129355430603, -0.038852889090776443, -0.0745975449681282, -0.027491768822073936, 0.006260004360228777, 0.01055056881159544, 0.01570192724466324, -0.02912626974284649, 0.005184851121157408, 0.007221278268843889, 0.02292320504784584, -0.004277167376130819, 0.008380166254937649, -0.03829019144177437, -0.000319447775837034, -0.008118914440274239, 0.026728108525276184, -0.060717687010765076, -0.011434807442128658, -0.0027448227629065514, 0.04506935179233551, 0.018448423594236374, -0.029956918209791183, -0.011970709078013897, 0.005717403721064329, 0.030653590336441994, 0.0016420369502156973, -0.02877793274819851, 0.023941418156027794, -0.005921716336160898, 0.004119745921343565, 0.028215236961841583, 0.0019091506255790591, -0.04662346839904785, 0.011166856624186039, 0.01935945637524128, -0.04986567422747612, -0.004156589508056641, -0.011414711363613605, 0.0035570489708334208, -0.019413046538829803, 0.005821234546601772, 0.006745665334165096, -0.04871348291635513, 0.03772749379277229, 0.0011848456924781203, 0.024356741458177567, 0.004920249339193106, 0.038236603140830994, -0.03896006941795349, 0.008561032824218273, 0.0006501997704617679, 0.04705218970775604, 0.0016813923139125109, 0.01302911527454853, 0.0071609895676374435, -0.02127530612051487, -0.021838003769516945, -0.01038309931755066, 0.0004881731583736837, 0.0053657181560993195, -0.003490061266347766, 0.00514130899682641, 0.01864938624203205, -0.007964842021465302, -0.01952022686600685, -0.029447810724377632, -0.03126987814903259, -0.010677846148610115, 0.031591419130563736, -0.015594745986163616, -0.05878844112157822, -0.03625376522541046, 0.02912626974284649, -0.000600796309299767, 0.03590542823076248, 0.018193870782852173, -0.02867075242102146, 0.03917443007230759, 0.013189885765314102, -0.0272104199975729, -0.004521672613918781, 0.040326621383428574, -0.0390404537320137, 0.03242206573486328, 0.008862477727234364, 0.02781330980360508, 0.01611725054681301, 0.020538441836833954, -0.037271980196237564, -0.03708441182971001, 0.004665696062147617, 0.041961122304201126, -0.010584062896668911, 0.038316987454891205, -0.022119352594017982, 0.011019483208656311, -0.019547022879123688, -0.0023361975327134132, 0.025857267901301384, 0.0035101575776934624, 0.006283449940383434, 0.02292320504784584, 0.029179859906435013, -0.02904588356614113, -0.019828371703624725, 0.037191592156887054, 0.01363870408385992, 0.023137565702199936, 0.0036776268389075994, 0.05107145383954048, -0.03965674340724945, 0.015487565658986568, -0.015594745986163616, 0.0020548489410430193, 0.021864797919988632, -0.01246641855686903, 0.011917118914425373, 0.02178441360592842, 0.052866723388433456, 0.026446759700775146, 0.013712390325963497, 0.03153782710433006, -0.009961077012121677, -0.020283887162804604, 0.012211864814162254, -0.022467687726020813, -0.026125218719244003, 0.020082924515008926, -0.001795271411538124, -0.014522941783070564, 0.007181085646152496, 0.03512836992740631, -0.0038919877260923386, -0.015527757816016674, 0.028215236961841583, 0.0029039185028523207, 0.014134413562715054, 0.0161440446972847, 0.02361987717449665, -0.04335446655750275, 0.03411015868186951, 0.002905593253672123, 0.0015289952279999852, 0.03126987814903259, 0.017483800649642944, -0.00499393604695797, 0.0076500000432133675, -0.012104684486985207, -0.017845533788204193, -0.006980122532695532, 0.025843869894742966, 0.03941558673977852, -0.016773730516433716, 0.006745665334165096, 0.024370139464735985, 0.007944745942950249, 0.032582838088274, 0.0362805612385273, -0.011046278290450573, -0.01417460571974516, 0.011113266460597515, 0.017912521958351135, 0.042497023940086365, 0.001120369997806847, -0.03041243366897106, 0.03327950835227966, -0.04123765230178833, -0.011876926757395267, -0.044774606823921204, -0.011876926757395267, -0.004464732948690653, -0.021838003769516945, -0.0460071787238121, 0.033869002014398575, 0.02730420231819153, 0.002828557277098298, -0.0005564169259741902, 0.0015348566230386496, -0.01316978968679905, 0.024075394496321678, 0.02928704023361206, 0.00810551643371582, 0.017564184963703156, -0.025790279731154442, 0.003975722473114729, 0.012875043787062168, 0.024892644956707954, -0.0397639237344265, -0.018702976405620575, -0.0029441111255437136, 0.04230945557355881, 0.0006744827842339873, 0.0058145360089838505, -0.00697342399507761, 0.01856900192797184, 0.022869614884257317, -0.02832241728901863, 0.006457617972046137, 0.0327971987426281, -0.01893073506653309, -0.03890648111701012, -0.03855814412236214, 0.06629107147455215, 0.010992688126862049, -0.006939929910004139, -0.045042555779218674, 0.03250245004892349, 0.013116199523210526, -0.031591419130563736, 0.00041867338586598635, 0.016867512837052345, 0.011608975008130074, 0.02449071779847145, -0.011233843863010406, 0.010329509153962135, 0.0320737287402153, -0.019332662224769592, 0.0058145360089838505, 0.01477749552577734, -0.028295621275901794, -0.01334395818412304, -0.04115726798772812, -0.012392732314765453, -0.007502627093344927, 0.025937652215361595, -0.0076366025023162365, 0.03076077066361904, 0.02127530612051487, -0.00868161115795374, -0.016760332509875298, 0.011240542866289616, 0.004632202442735434, -0.0031835923437029123, -0.007871059700846672, 0.01071803830564022, -0.012185069732367992, -0.034646060317754745, -0.027759719640016556, -0.011669264174997807, -0.0024266308173537254, 0.014308581128716469, 0.018796760588884354, 0.012118082493543625, 0.008460551500320435, 0.009324693121016026, 0.0076232049614191055, 0.0333063043653965, 0.031698599457740784, 0.02442372962832451, -0.040755342692136765, 0.030841154977679253, -0.011662565171718597, 0.005868126172572374, 0.017323030158877373, -0.001196568482555449, 0.010651051066815853, 0.006353787146508694, 0.0061896671541035175, 0.05334903672337532, 0.047212958335876465, 0.03389579802751541, -0.03346707671880722, 0.03408336266875267, 0.008835682645440102, -0.007274868432432413, 0.023914624005556107, -0.03140385448932648, 0.007951444946229458, 0.0006841123104095459, -0.0028620511293411255, 0.011367819271981716, -0.0036508317571133375, 0.0020883427932858467, 0.012352539226412773, 0.019560420885682106, 0.002897219732403755, -0.006675328128039837, 0.06586234271526337, -0.001600169693119824, 0.03293117135763168, 0.012319045141339302, -0.02380744367837906, -0.034994397312402725, -0.007120796944946051, 0.023941418156027794, 0.0014636821579188108, -0.017992906272411346, 0.013377451337873936, -0.019131697714328766, 0.022159544751048088, 0.023686865344643593, -0.010778327472507954, 0.04855271428823471, -0.02119492180645466, -0.014321979135274887, 0.02171742543578148, -0.006159522570669651, -0.01692110300064087, 0.0189039409160614, 0.025040017440915108, -0.016693344339728355, 0.046328719705343246, 0.022280123084783554, 0.0016169166192412376, -0.00673561729490757, 0.00131882110144943, 0.029608581215143204, -0.03510157763957977, -0.04263099655508995, -0.004444636404514313, -0.024195970967411995, -0.023861033841967583, 0.015835901722311974, -0.0003223785024601966, 0.01185682974755764, 0.010630954056978226, -0.0002643922343850136, -0.019935552030801773, -0.004377648700028658, 0.007402145303785801, -0.01743021048605442, 0.026915673166513443, 0.017550788819789886, 0.011488397605717182, 0.024705078452825546, -0.037352364510297775, -0.02352609485387802, -0.0380222424864769, 0.003667578799650073, -0.014201400801539421, 0.033681437373161316, -0.00811221543699503, -0.016492381691932678, -0.010959194041788578, 0.021342294290661812, -0.011213747784495354, 0.005533187184482813, 0.014121015556156635, 0.009840498678386211, -0.02258826605975628, -0.015152626670897007, 0.030733974650502205, 0.012084588408470154, 0.006347088608890772, 0.010222328826785088, -0.025348160415887833, 0.026352977380156517, 0.0021904991008341312, 0.01242622546851635, 0.026366375386714935, -0.009733318351209164, 0.07347215712070465, 0.016679948195815086, -0.01386646181344986, -0.0041967821307480335, -0.0035235551185905933, 0.04957092925906181, -0.014295184053480625, -0.022695446386933327, -0.027786513790488243, 0.010215630754828453, 0.013625306077301502, 0.02904588356614113, -0.02370026335120201, -0.007556217256933451, 0.03585183992981911, -0.009626138024032116, -0.020726006478071213, 0.016961295157670975, -0.026996059343218803, 0.030144482851028442, 0.006390630267560482, 0.024798860773444176, 0.0022775831166654825, -0.04080893099308014, 0.021677233278751373, 0.017657969146966934, -0.0038517951034009457, 0.036414533853530884, 0.026219001039862633, 0.03121628612279892, -0.0004063225060235709, -0.016706742346286774, -0.05214325711131096, 0.008514141663908958, -0.028885113075375557, 0.017671365290880203, 0.002666112035512924, 0.00557672930881381, 0.003948927391320467, -0.012955429032444954, 0.028911909088492393, -0.006179619114845991, -0.007596409879624844, 0.031698599457740784, -0.03794185444712639, 0.009043345227837563, 0.010088353417813778, 0.011562083847820759, -0.011146759614348412, 0.008875875733792782, 0.01068454422056675, -0.01736322231590748, 0.027357792481780052, -0.0002886753063648939, -0.00638393172994256, 0.02520078793168068, -0.0007050459389574826, 0.05380455404520035, 0.02510700561106205, 0.002565630478784442, -0.017671365290880203, 0.007911251857876778, -0.01481768861413002, 0.035530298948287964, -0.026352977380156517, -0.02466488629579544, -0.0052049471996724606, 0.02834921143949032, -0.018341243267059326, -0.003808252979069948, -0.028697548434138298, -0.00199456000700593, -0.011997504159808159, -0.0006238233181647956, 0.012895139865577221, 0.014402364380657673, -0.023217950016260147, 0.02108774147927761, 0.023740455508232117, 0.024102188646793365, -0.03242206573486328, 0.01674693450331688, -0.0345388799905777, 0.003046267433091998, -0.0016378503059968352, -0.005807837005704641, 0.005586777348071337, -0.016505779698491096, -0.015889491885900497, 0.01333725918084383, -0.014375569298863411, 0.008293082006275654, 0.0360662005841732, 0.018167074769735336, -0.038397371768951416, -0.004240323789417744, -0.025843869894742966, 0.0021921738516539335, 0.003871891414746642, -0.0006707147695124149, -0.018769964575767517, 0.0020196803379803896, 0.0037546628154814243, -5.442753899842501e-05, -0.007750481367111206, -0.0009579246980138123, -0.02317775785923004, -0.033440280705690384, 0.008916067890822887, 0.007683493662625551, 0.009492162615060806, -0.00396902346983552, 0.020873378962278366, 0.028697548434138298, -0.0027783166151493788, 0.020109720528125763, 0.005348971113562584, 0.04935656860470772, 0.008654816076159477, -0.03145744279026985, 0.024102188646793365, 0.014201400801539421, 0.021382486447691917, 0.006692075170576572, -0.0012334117200225592, -0.0007427265518344939, -0.006196366157382727, -0.0189039409160614, 0.014201400801539421, -0.010061558336019516, -0.024557705968618393, -0.027947286143898964, -0.01698809117078781, 0.006531304679811001, 0.01744360849261284, 0.015233011916279793, 0.009733318351209164, -0.015179421752691269, -0.0018321146490052342, -0.02127530612051487, 0.030439229682087898, 0.02162364311516285, -0.0012334117200225592, 0.031189491972327232, -0.005660464055836201, -0.017296234145760536, 0.03148423880338669, -0.03510157763957977, 0.002133559435606003, -0.022708844393491745, -0.006544702220708132, 0.029447810724377632, -0.00023822515504434705, 0.016961295157670975, 0.0012091287644580007, 0.014522941783070564, 0.009384982287883759, -0.021141331642866135, -0.002738123992457986, -0.01046348549425602, 0.007810770533978939, -0.013451138511300087, -0.0017349824775010347, 0.020297285169363022, 0.034672852605581284, -0.021663835272192955, -0.011602276936173439, -0.0041498905047774315, 0.012808055616915226, -0.024624694138765335, 0.013310464099049568, 0.03060000017285347, -0.0046455999836325645, 0.019051313400268555, -0.014482749626040459, -0.029233450070023537, -0.045980386435985565, -0.0010985989356413484, 0.0050341286696493626, 0.026085026562213898, -0.02047145366668701, -0.02711663767695427, 0.022601664066314697, 0.005995402578264475, 0.00043542031198740005, -0.004933646880090237, 0.00362738617695868, 0.0026409917045384645, 0.001690603094175458, 0.0033627846278250217, 0.02936742454767227, -0.01464352011680603, 0.022789228707551956, 0.01864938624203205, 0.0315646231174469, 0.04482819512486458, 0.03593222424387932, 0.00872180424630642, 0.01795271411538124, -0.003386230207979679, 0.02274903655052185, 0.007783975452184677, 0.002267535077407956, 0.002977604977786541, 0.02885831892490387, -0.010269220918416977, 0.019238879904150963, 0.024289755150675774, 0.011843432672321796, -0.010791724547743797, -0.0067389667965471745, -0.042738176882267, 0.03113590180873871, 0.031966548413038254, -0.0036374342162162066, 0.0016537598567083478, -0.005164754576981068, 0.015032049268484116, -0.03459246829152107, -0.024651488289237022, 0.02667451836168766, -0.010523773729801178, 0.020726006478071213, 0.007489229552447796, 0.00032572788768447936, 0.014281786046922207, 0.006658581551164389, 0.03234168142080307, -0.005841331090778112, 0.014656917192041874, -0.0017969461623579264, 0.005241790786385536, 0.008989755064249039, -0.00220222189091146, -0.014121015556156635, -0.014750700443983078, -0.031430646777153015, -0.01805989444255829, -0.007288265973329544, -0.0180331002920866, 0.009532355703413486, 0.005670512095093727, 0.029179859906435013, 0.022038966417312622, -0.02718362584710121, 0.052947111427783966, 0.030573204159736633, 0.014054028317332268, -0.022427495568990707, 0.007442337926477194, -0.009646235033869743, -0.002012981567531824, 0.0015248084673658013, -0.06055691838264465, 0.007723686285316944, -0.020886776968836784, -0.01055056881159544, -0.003068038495257497, -0.011099868454039097, 0.028697548434138298, 0.003476663725450635, -0.02963537722826004, 0.018716374412178993, 0.009197416715323925, -0.017041681334376335, 0.04287215322256088, -0.012359238229691982, 0.03132346644997597, 0.012272153981029987, -0.023083975538611412, -0.022012172266840935, 0.02955499105155468, -0.008755297400057316, -0.034833624958992004, -0.00972662027925253, 0.028617162257432938, 0.006668629590421915, 0.021503064781427383, -0.006745665334165096, -0.014857880771160126, -0.0049169003032147884, 0.009230910800397396, -0.03244886174798012, -0.011474999599158764, 0.0075495182536542416, 0.0442654974758625, -0.020726006478071213, -0.022883012890815735, -0.007053809240460396, 0.04088931530714035, -0.026299387216567993, 0.029447810724377632, -0.001256020157597959, -0.030198073014616966, 0.0010131895542144775, 0.015916287899017334, -0.007864360697567463, -0.004357552621513605, -0.013042513281106949, 0.03684325888752937, -0.011608975008130074, -0.023593083024024963, -0.017470402643084526, 0.03295796737074852, 0.02031068317592144, 0.052598774433135986, -0.008339974097907543, 0.016358405351638794, -0.010738134384155273, 0.012379334308207035, -0.001726608956232667, -0.0007058833143673837, -0.013585113920271397, 0.006809304002672434, 0.00911703146994114, 0.02509360760450363, -0.018890542909502983, 0.013745884411036968, -0.025214185938239098, 0.01882355473935604, -0.028295621275901794, 0.00026606692699715495, -0.006219811737537384, -0.03799544647336006, 0.0023227999918162823, 0.0009629487758502364, -0.02493283711373806, 0.01796611212193966, 0.027518562972545624, -0.005770993884652853, 0.039442382752895355, 0.0021101138554513454, 0.02589746005833149, -0.010570665821433067, -0.024785464629530907, 0.0479632206261158, 0.006209763698279858, 0.031350262463092804, 0.023392118513584137, -0.019225481897592545, -0.037352364510297775, 0.011166856624186039, -0.003186941845342517, -0.019064711406826973, -0.024879246950149536, 0.034994397312402725, -0.014415761455893517, 0.003955625928938389, -0.002475196961313486, 0.02163703925907612, 0.03871891275048256, 0.035530298948287964, 0.004689141642302275, 0.025522328913211823, 0.029233450070023537, 0.0402730293571949, -0.01015534158796072, -0.012881742790341377, -0.03834378346800804, -0.017537390813231468, -0.033440280705690384, 0.008360070176422596, 0.009070140309631824, 0.020726006478071213, -0.0016386875649914145, -0.013920051977038383, -0.009706523269414902, -0.0025857267901301384, -0.009344790130853653, -0.0011262313928455114, -0.015326795168220997, 0.010825218632817268, 0.0274649728089571, 0.030573204159736633, -0.05080350115895271, -0.010711339302361012, -0.019466636702418327, 0.009833800606429577, -0.00442454032599926, -0.015313397161662579, 0.010771628469228745, 0.005268585868179798, 0.015902889892458916, -0.016854114830493927, 0.0014561460120603442, 0.01172955334186554, 0.006343739107251167, 0.02021690085530281, -0.02650034986436367]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" Zhao, R., Chang, S., Wu, W., Ge, Y ., Shan, Y .,
and Shou, M. Z. Mix-of-show: Decentralized low-rank
adaptation for multi-concept customization of diffusion
models, 2023.
Gupta, V ., Koren, T., and Singer, Y . Shampoo: Precondi-
tioned stochastic tensor optimization, 2018.
Hayou, S., Doucet, A., and Rousseau, J. On the impact of
the activation function on deep neural networks training,
2019.
Hayou, S., Ghosh, N., and Yu, B. Lora+: Efficient low rank
adaptation of large models, 2024.Hu, E. J., Shen, Y ., Wallis, P., Allen-Zhu, Z., Li, Y ., Wang,
S., Wang, L., and Chen, W. Lora: Low-rank adaptation
of large language models, 2021.
Jia, X., Wang, H., Peng, J., Feng, X., and Meng, D. Precon-
ditioning matters: Fast global convergence of non-convex
matrix factorization via scaled gradient descent. In Thirty-
seventh Conference on Neural Information Processing
Systems , 2023.
Jiang, A. Q., Sablayrolles, A., Mensch, A., Bamford, C.,
Chaplot, D. S., de las Casas, D., Bressand, F., Lengyel,
G., Lample, G., Saulnier, L., Lavaud, L. R., Lachaux, M.-
A., Stock, P., Scao, T. L., Lavril, T., Wang, T., Lacroix,
T., and Sayed, W. E. Mistral 7b, 2023.
Kingma, D. P. and Ba, J. Adam: A method for stochastic
optimization, 2017.
Labonne, M. Mistral fine-tuning example, 2024.
URL https://towardsdatascience.
com/fine-tune-a-mistral-7b-model\\
-with-direct-preference-optimization\\
-708042745aac . Accessed: 2024-01-25.
Liu, W., Qiu, Z., Feng, Y ., Xiu, Y ., Xue, Y ., Yu, L., Feng, H.,
Liu, Z., Heo, J., Peng, S., Wen, Y ., Black, M. J., Weller,
A., and Sch ¨olkopf, B. Parameter-efficient orthogonal
finetuning via butterfly factorization, 2023.
Loshchilov, I. and Hutter, F. Decoupled weight decay regu-
larization, 2019.
Lu, C., Zhou, Y ., Bao, F., Chen, J., Li, C., and Zhu, J. Dpm-
solver: A fast ode solver for diffusion probabilistic model
sampling in around 10 steps, 2022.
Ma, C., Xu, X., Tong, T., and Chi, Y . Provably accelerating
ill-conditioned low-rank estimation via scaled gradient
descent, even with overparameterization, 2023.
Mishkin, A., Sahiner, A., and Pilanci, M. Fast convex opti-
mization for two-layer relu networks: Equivalent model
classes and cone decompositions, 2022.
Mishra, B. and Sepulchre, R. Riemannian preconditioning.
SIAM Journal on Optimization , 26(1):635–660, January
2016. ISSN 1095-7189. doi: 10.1137/140970860. URL
http://dx.doi.org/10.1137/140970860 .
Mishra, B., Apuroop, K. A., and Sepulchre, R. A riemannian
geometry for low-rank matrix completion, 2012.
Mistral AI team. Mistral-7b announcement,
2023. URL https://mistral.ai/news/
announcing-mistral-7b . Accessed: 2024-01-25.
10
Riemannian Preconditioned LoRA
Nan, L., Radev, D., Zhang, R., Rau, A., Sivaprasad, A.,
Hsieh, C., Tang, X., Vyas, A., Verma, N., Krishna, P.,
Liu, Y ., Irwanto, N., Pan, J., Rahman, F., Zaidi,","[-0.0015682567609474063, 0.04240703955292702, 0.004531582351773977, 0.0016486310632899404, 0.006376365199685097, 0.004083782434463501, -0.039896298199892044, 0.016304511576890945, -0.06968839466571808, 0.0021911580115556717, -0.011397848837077618, -0.010563486255705357, -0.026424026116728783, 0.0059170834720134735, 0.018340662121772766, 0.02781718038022518, 0.025551389902830124, -0.03462986275553703, -0.007692973595112562, 0.06472814828157425, 0.0013634935021400452, -0.015921777114272118, -0.012798658572137356, 0.016335129737854004, 0.015493113547563553, -0.01145908609032631, 0.026010671630501747, 0.024694062769412994, 0.020591143518686295, -0.0004530625883489847, 0.03943701460957527, -0.025352368131279945, -0.020376812666654587, -0.027602849528193474, -0.013012990355491638, 0.017345551401376724, 0.02169342152774334, 0.03435429558157921, -0.028751054778695107, 0.0324559286236763, -0.021754657849669456, -0.06907601654529572, -0.048928845673799515, 0.022979410365223885, 0.006426121108233929, -0.00644908519461751, 0.028046822175383568, 0.03214973956346512, 0.015186925418674946, 0.06699393689632416, -0.038181643933057785, 0.028812291100621223, -0.029792092740535736, -0.018509065732359886, -0.0010477370815351605, 0.011803547851741314, 0.016825031489133835, 0.023698952049016953, 0.022275177761912346, -0.022765079513192177, -0.01589115709066391, -0.057104066014289856, 0.013388071209192276, 0.01494197454303503, -0.040723007172346115, -0.027771253138780594, -0.050827208906412125, -0.007742729503661394, 0.0044473810121417046, 0.02939404919743538, -0.042590752243995667, -0.01025729812681675, 0.04938812553882599, -0.035425953567028046, -0.022244559600949287, -0.010685961693525314, -0.012247520498931408, 0.08463037014007568, -0.0014008102007210255, -0.023653024807572365, -0.008603882975876331, -0.010027657262980938, 0.024678753688931465, -0.03211912140250206, -0.04846956208348274, -0.07973136007785797, -0.014314289204776287, -0.0061390697956085205, -0.06815744936466217, 0.019243916496634483, -0.012936443090438843, 0.005771643947809935, -0.026378097012639046, 0.03484419733285904, 0.03343573212623596, -0.022948792204260826, 0.03735493868589401, 0.007451850920915604, 0.04984740912914276, 0.03796731308102608, -0.030159519985318184, -0.03193540871143341, 0.05563436076045036, -0.009277496486902237, 0.04179466515779495, 0.004566028714179993, -0.029240954667329788, -0.017039362341165543, -0.0068050287663936615, 0.05930861830711365, -0.0738525465130806, -0.01673317514359951, -0.038181643933057785, 0.019596032798290253, -0.00584436347708106, -0.05358290299773216, -0.05431775376200676, 0.014903701841831207, -0.05857376754283905, -0.0036685150116682053, -0.025673864409327507, -0.014620477333664894, 0.03181293606758118, 0.027954965829849243, 0.02356116659939289, -0.019550103694200516, 0.06307473033666611, -0.05535879358649254, -0.023101884871721268, -0.006104623433202505, 0.011704036965966225, 0.03591585531830788, 0.040049392729997635, -0.04531582444906235, -0.007141835521906614, -0.016442297026515007, 0.026225002482533455, 0.011382539756596088, -0.02120351977646351, -0.02154032699763775, 0.03368068113923073, -0.0019203729461878538, -0.024158233776688576, 0.005882637109607458, -0.05692034959793091, 0.022229250520467758, -0.017896689474582672, 0.0013213925994932652, -0.011321301572024822, 0.004726777318865061, 0.014827154576778412, -0.006663416512310505, -0.01586053892970085, 0.010831400752067566, -0.024219471961259842, -0.04283570125699043, 0.01553138718008995, 0.028398938477039337, 0.013012990355491638, -0.05462394282221794, 0.019182678312063217, 0.06405453383922577, 0.014245397411286831, -0.020085932686924934, 0.07072942703962326, 0.013617712073028088, -0.05036792904138565, -0.009300461038947105, -0.058328814804553986, -0.05826757848262787, 0.023852046579122543, -0.00474591413512826, -0.04084547981619835, -0.01757519133388996, 0.04546891897916794, 0.0179119985550642, -0.02917971834540367, -0.026347478851675987, 0.016166726127266884, -0.03793669492006302, -0.00692367646843195, -0.0014859687071293592, 0.0246175155043602, 0.02542891353368759, -0.04736728593707085, -0.007084425073117018, -0.004964073188602924, 0.016993435099720955, 0.026010671630501747, 0.056644782423973083, 0.022780388593673706, 0.025000251829624176, 0.04675490781664848, 0.04151909425854683, -0.010586450807750225, -0.01621265523135662, 0.04317250847816467, -0.004156502429395914, 0.015921777114272118, 0.0011529892217367887, -0.024464422836899757, 0.044642213732004166, 0.012660874053835869, -0.03894711658358574, 0.010961530730128288, 0.02305595763027668, -0.017054671421647072, -0.018156949430704117, -0.02457158826291561, -0.007922614924609661, 0.03276211768388748, 0.032027266919612885, 0.05211320146918297, -0.004466517828404903, -0.026852687820792198, -0.005503729451447725, -0.06230926141142845, 0.0026274758856743574, 0.006835647393018007, 0.058481909334659576, -0.01654946245253086, 0.02475530095398426, 0.007754211314022541, 0.0014438678044825792, -0.020453359931707382, 0.01390859019011259, 0.036620087921619415, -0.018876491114497185, 0.060196563601493835, -0.02887352928519249, 0.07146428525447845, -0.010900293476879597, -0.018662158399820328, 0.008933035656809807, 0.016120798885822296, -0.04488716274499893, 0.00615437887609005, -0.05808386579155922, 0.03306830674409866, -0.03790607675909996, -0.001004679361358285, 0.00913971196860075, 0.007520743180066347, 0.0031326860189437866, 0.00388667406514287, 0.04525458812713623, -0.028827602043747902, -0.03257840499281883, 0.01109166070818901, -0.002780569950118661, 0.04899008199572563, -0.007547534536570311, 0.00887179747223854, -0.033741917461156845, -0.010096549987792969, 0.0014534362126141787, -0.0186468493193388, -0.0007200202671810985, -0.041090432554483414, -0.018539683893322945, -0.022765079513192177, -0.003768026130273938, -0.009017236530780792, 0.025505460798740387, 0.0038560552056878805, 0.0032283698674291372, -0.03383377566933632, 0.042590752243995667, 0.011252409778535366, -0.02663835696876049, -0.01152797881513834, 0.006261544767767191, -0.01212504506111145, 0.012836932204663754, -0.004719122778624296, 0.024464422836899757, 0.04650995880365372, 0.019779745489358902, -0.06096203252673149, 0.020116552710533142, 0.026867998763918877, 0.021463779732584953, 0.05783891677856445, -0.010502249002456665, 0.013770805671811104, 0.04580572620034218, 0.006380192469805479, -0.0026734040584415197, -0.04222332686185837, -0.012232211418449879, 0.009399971924722195, -0.03037385083734989, 0.011979606002569199, -0.01775890402495861, 0.019197989255189896, -0.002344252075999975, 0.012760384939610958, -0.01359474752098322, 0.012270484119653702, -0.02645464427769184, 0.0734851211309433, 0.0029910742305219173, 0.001906977267935872, -0.0031939237378537655, -0.013786115683615208, 0.05042916536331177, 0.036803800612688065, -0.02936343103647232, 0.016779102385044098, -0.006927503738552332, -0.01017309632152319, 0.034415531903505325, -0.02901131473481655, 0.016641318798065186, -0.03554842993617058, -0.02712825872004032, 0.04678552970290184, -0.009269841946661472, 0.019550103694200516, -0.029792092740535736, -0.023438692092895508, -0.04932688921689987, -0.0055152117274701595, 0.009568375535309315, -0.003917292691767216, -0.016136107966303825, -0.03294583037495613, -0.03496666997671127, 0.005201369058340788, -0.034446150064468384, 0.027220115065574646, 0.0015644293744117022, 0.02904193289577961, -0.005442491732537746, -0.024540968239307404, 0.0024303672835230827, -0.01179589331150055, 0.018524374812841415, 0.046540576964616776, 0.02764877676963806, -0.07881279289722443, -0.041029192507267, -0.008917725645005703, 0.0016945592360571027, -0.01605956070125103, -0.019274534657597542, -0.0069351582787930965, -0.02120351977646351, 0.04497901722788811, 0.031200557947158813, 0.027388516813516617, -0.004432071465998888, 0.025367677211761475, -0.034446150064468384, -0.01654946245253086, 0.024188853800296783, 0.017299622297286987, -0.0168862696737051, -0.0512864924967289, 0.009583684615790844, -0.01137488428503275, 0.009024892002344131, 0.0003248463326599449, -0.01774359494447708, 0.025367677211761475, 0.006705517414957285, -0.004466517828404903, 0.03285397216677666, -0.020254336297512054, -0.03472172096371651, -0.0027939656283706427, 0.03435429558157921, -0.04384612292051315, -0.031001536175608635, -0.010287917219102383, 0.0014553498476743698, 0.01117586251348257, 0.02134130522608757, 0.015401257202029228, 0.021387232467532158, 0.035977091640233994, 0.003463751869276166, -0.010196060873568058, -0.005492247641086578, -0.0015787819866091013, -0.005710406228899956, 0.01586053892970085, -0.019550103694200516, -0.028215225785970688, 0.02049928717315197, -0.001277378061786294, -0.021234137937426567, -0.02080547623336315, 0.03138427063822746, 0.020193099975585938, 0.02473999187350273, -0.014735298231244087, 0.02046866901218891, 0.042468275874853134, 0.006728481501340866, -0.014383181929588318, -0.030190138146281242, -0.0348748154938221, 0.0020112725906074047, 0.00121805421076715, 0.036987513303756714, 0.03671194240450859, 0.06534051895141602, -0.017697667703032494, 0.0031805280596017838, 0.006628970615565777, -0.10349154472351074, 0.010180751793086529, -0.019044894725084305, -0.01162748970091343, -0.03054225444793701, 0.006039558444172144, 0.027204804122447968, 0.02271915040910244, 0.05777767673134804, -0.016289202496409416, 0.010793127119541168, -0.02970023639500141, -0.018570302054286003, -0.06570794433355331, 0.031537365168333054, 0.040202487260103226, -0.0839567556977272, 0.019106131047010422, -0.043325603008270264, -0.020070623606443405, -0.013770805671811104, 0.02784780040383339, -0.02307126671075821, -0.04099857434630394, -0.04421354830265045, 0.013280904851853848, 0.04084547981619835, 0.029470596462488174, -0.0563385933637619, -0.005128649063408375, 0.030863750725984573, -0.03257840499281883, 0.037477411329746246, -0.026776142418384552, 0.0047650509513914585, -0.004971727728843689, -0.0011061042314395308, -0.015416566282510757, -0.006204134784638882, 0.009545410983264446, 0.005989803001284599, 0.041764043271541595, -0.0010228593600913882, 0.004248358774930239, -0.0802212581038475, 0.10049090534448624, 0.006743791047483683, 0.05863500386476517, 0.002602598164230585, 0.03649761155247688, 0.030511636286973953, -0.039559490978717804, -0.021923061460256577, 0.008802905678749084, 0.03726308047771454, 0.02682206965982914, -0.003528816858306527, 0.022168012335896492, -0.009093783795833588, 0.00018419123080093414, -0.024831848219037056, -0.029256263747811317, -0.01520988903939724, -0.02441849373281002, 0.013786115683615208, -0.005698924418538809, -0.018493756651878357, 0.015072104521095753, 0.03242531046271324, 0.028322391211986542, -0.014750607311725616, 0.014911356382071972, 0.012492470443248749, 0.05122525617480278, 0.06644279509782791, -0.0018256460316479206, 0.023622404783964157, -0.027725324034690857, 0.023025337606668472, 0.003218801459297538, 0.015340019017457962, 0.035946473479270935, -0.019718507304787636, 0.012775694951415062, -0.03879402205348015, -0.024709371849894524, 0.01076250895857811, 0.013097192160785198, -0.015539041720330715, 0.016610698774456978, 0.004167984239757061, -0.007616426795721054, 0.027924345806241035, 0.014321944676339626, -0.0009931973181664944, 0.0187540166079998, 0.01947355829179287, 0.005239642225205898, 0.06723888963460922, -0.010953876189887524, 0.04240703955292702, -0.00957603007555008, 0.008565609343349934, 0.017498644068837166, 0.046356864273548126, -0.052205055952072144, 0.012002569623291492, -0.017376169562339783, 0.03334387391805649, -0.004122056066989899, -0.0024035759270191193, -0.030970918014645576, -0.003446528920903802, 0.0014496088260784745, -0.020591143518686295, -0.008925380185246468, -0.07134180516004562, -0.01024198904633522, -0.014666405506432056, 0.023530548438429832, -0.032517168670892715, -0.026760831475257874, 0.042805083096027374, -0.059859756380319595, -0.015500768087804317, 0.0050291381776332855, -0.046877384185791016, -0.028597960248589516, 0.03796731308102608, 0.01452862098813057, 0.012768040411174297, -0.010816091671586037, 0.01893772929906845, -0.01658008061349392, -0.022657912224531174, 0.024510350078344345, -0.015952395275235176, -0.012339376844465733, 0.034599244594573975, 0.07391378283500671, -0.01708529144525528, 0.027112947776913643, 0.006223271135240793, 0.00844313483685255, -0.0005339153576642275, 0.0014964939327910542, -0.009920491836965084, 0.04436664283275604, 0.01898365654051304, 0.0276947058737278, -0.022504819557070732, -0.02235172502696514, 0.011168207973241806, -0.016350440680980682, 0.00966023188084364, -0.005048274993896484, -0.0058749825693666935, -0.028046822175383568, -0.004409107379615307, -0.01653415337204933, -0.0201471708714962, -0.0005846277344971895, -0.014620477333664894, 0.04409107193350792, -0.006609833799302578, -0.008045090362429619, -0.018049784004688263, 0.013104846701025963, -0.016013633459806442, -0.040906719863414764, -0.013487582094967365, -0.014643441885709763, -0.017314931377768517, -0.0594923309981823, 0.01451331190764904, -0.013770805671811104, 0.03959010913968086, -0.022290486842393875, 0.028062131255865097, 0.04647934064269066, -0.02816929668188095, -0.021249448880553246, -0.0227497685700655, -0.006621315609663725, -0.020254336297512054, 0.029332811012864113, -0.016151417046785355, -0.008917725645005703, 0.007999162189662457, 0.011535633355379105, -0.031215867027640343, 0.014046374708414078, -0.024862466380000114, 0.002036150312051177, 0.00230980571359396, 0.019580723717808723, 0.023959212005138397, -0.0003224542597308755, -0.008136946707963943, -0.02082078531384468, 0.0024341947864741087, -0.00717245414853096, 0.009315770119428635, -0.00982863549143076, -0.009484173730015755, -0.02150970697402954, -0.030128899961709976, 0.06705517321825027, -0.0020495459903031588, -0.010517558082938194, -0.021463779732584953, 0.04461159184575081, 0.02052990533411503, -0.0032589887268841267, -0.00023717610747553408, -0.01349523663520813, -0.03980443999171257, -0.03267025947570801, -0.011505014263093472, -0.019044894725084305, -0.02120351977646351, 0.01256136316806078, 0.027587540447711945, -0.009782707318663597, 0.0032666432671248913, 0.009675540961325169, 0.001721350708976388, 0.004814806394279003, -0.0675450786948204, 0.030281994491815567, 0.01570744439959526, -0.004485654179006815, -0.05425651744008064, 0.02905724197626114, -0.018998965620994568, 0.0038962424732744694, 0.026240313425660133, -0.005947702098637819, -0.003911552019417286, -0.03386439383029938, -0.03380315750837326, 0.02870512567460537, 0.04136599972844124, -0.0016773361712694168, -0.0031958373729139566, 0.02731197141110897, 0.0025930297560989857, 0.00043966685188934207, 0.00897130835801363, -0.05685911327600479, -0.018554992973804474, -0.005312362220138311, 0.024816539138555527, -0.012951753102242947, 0.027220115065574646, -0.007294929586350918, 0.028123369440436363, 0.013533510267734528, 0.001397939631715417, 0.059216760098934174, 0.0076470454223454, 0.026745522394776344, 0.0077389017678797245, 0.006816510576754808, -0.0481327548623085, 0.010808437131345272, -0.014750607311725616, -0.024357255548238754, 0.0036245007067918777, -0.03548718988895416, 0.03092498891055584, -0.059369854629039764, 6.320360625977628e-06, 0.00897130835801363, -0.009775051847100258, 0.011566252447664738, 0.011168207973241806, -0.010609414428472519, -0.016457606106996536, 0.016656627878546715, -0.02682206965982914, 0.01659538969397545, -0.016779102385044098, 0.018493756651878357, 0.026240313425660133, -0.027939656749367714, 0.044336024671792984, 0.012706802226603031, -0.0887945219874382, -0.0141765046864748, 0.040202487260103226, -0.026561809703707695, 0.0014457815559580922, -0.03481357544660568, -0.013043609447777271, 0.016472915187478065, 0.02666897512972355, 0.09038670361042023, -0.0037393211387097836, 0.008129292167723179, -0.02325497940182686, -0.033037684857845306, -0.009216259233653545, -0.06338091939687729, 0.020606452599167824, 0.04326436668634415, 0.038334738463163376, -0.005974493455141783, -0.016182037070393562, -0.046908002346754074, 0.010127168148756027, -0.04611191526055336, 0.02052990533411503, 0.023469310253858566, -0.024341946467757225, -0.030863750725984573, 0.009361698292195797, 0.013694258406758308, 0.02836831845343113, 0.004309596493840218, 0.01366364024579525, 0.017008744180202484, -0.008603882975876331, -0.009775051847100258, 0.0261178370565176, -0.008351277559995651, 0.005767816677689552, 0.002418885240331292, -0.001359666115604341, -0.011971951462328434, -0.011849476024508476, -0.0045009637251496315, 0.017299622297286987, 0.021264757961034775, 0.018371280282735825, 0.027893727645277977, 0.0007936967303976417, -0.0010305140167474747, 0.005710406228899956, -0.02974616549909115, 0.016013633459806442, 0.024464422836899757, -0.009889872744679451, -0.027618158608675003, -0.02186182327568531, 0.00644525745883584, 0.0024475904647260904, -0.03567090258002281, -0.014046374708414078, 0.02578102983534336, 0.018692778423428535, -0.0023825254756957293, 0.008986618369817734, -0.0029068724252283573, -0.02150970697402954, -0.014574549160897732, 0.006077832076698542, 0.015799300745129585, -0.001971085323020816, -4.28782805101946e-05, -0.021907752379775047, 0.026041289791464806, 0.008741667494177818, 0.028628578409552574, 0.0054731108248233795, -0.004324905574321747, 0.016993435099720955, -0.014245397411286831, 0.015225199051201344, -0.013900935649871826, -0.016855649650096893, 0.028597960248589516, -6.620119529543445e-05, -0.02562793716788292, -0.02526051178574562, -0.020606452599167824, -0.005775471217930317, 0.013097192160785198, -0.018662158399820328, -0.03668132424354553, 0.007275792770087719, 0.015156306326389313, 0.0026906272396445274, 0.009545410983264446, 0.04880636930465698, -0.004443553742021322, -0.08848833292722702, 0.009675540961325169, 0.009445900097489357, 0.004883698653429747, 0.005951529368758202, -0.01229344867169857, 0.013977482914924622, 0.00418712105602026, 0.026362787932157516, -0.011351920664310455, 0.019274534657597542, -0.0077886576764285564, -0.01162748970091343, 0.04096795618534088, 0.03515038266777992, -0.04369302839040756, 0.025153344497084618, -0.009331079199910164, 0.05073535442352295, 0.01503383181989193, -0.014742952771484852, 0.012622600421309471, 0.026776142418384552, 0.024525659158825874, -0.04145785793662071, -0.01075485348701477, 0.011818856932222843, 0.01137488428503275, 0.026087218895554543, 0.027373207733035088, -0.015255818143486977, -0.01673317514359951, -0.005955356638878584, 0.03720184415578842, -0.036620087921619415, 0.03263964131474495, -0.002057200763374567, 0.011397848837077618, -0.017682356759905815, -0.0039613074623048306, -0.009798016399145126, -0.05725715681910515, 0.03162922337651253, 0.015768682584166527, 0.026913926005363464, 0.003247506683692336, 0.03162922337651253, -0.05444023013114929, 0.000448278384283185, -0.006628970615565777, 0.03432367742061615, 0.021769966930150986, 0.013456963002681732, -0.01314312033355236, 0.00990518182516098, -0.015064449980854988, -0.01050990354269743, -0.0017146528698503971, 0.00567978760227561, 0.038855258375406265, -0.00929280649870634, 0.031154630705714226, 0.018662158399820328, -0.004795669578015804, -0.028766363859176636, -0.027710014954209328, -0.02357647754251957, 0.021249448880553246, -0.01743740774691105, -0.03380315750837326, -0.05278681218624115, 0.03193540871143341, 0.01847844570875168, 0.01590646803379059, -0.0045009637251496315, -0.036558847874403, -0.0024246263783425093, 0.04470345005393028, -0.02307126671075821, -0.007914960384368896, 0.03778360038995743, -0.024663444608449936, -0.004546891897916794, 0.0072069005109369755, -0.007409750018268824, 0.02991456910967827, 0.00721455505117774, -0.030450398102402687, 0.018310043960809708, 0.03536471351981163, 0.026347478851675987, 0.002200726419687271, 0.026378097012639046, -0.024831848219037056, 0.009155021980404854, 0.0005731456913053989, -0.024219471961259842, 0.03790607675909996, 0.007914960384368896, 0.019902219995856285, 0.03808978945016861, 0.027954965829849243, -0.036650706082582474, 0.014850118197500706, 0.025367677211761475, 0.006020421627908945, 0.023300908505916595, -0.030128899961709976, 0.014873082749545574, -0.019412320107221603, 0.029072551056742668, 0.006847129203379154, 0.008688084781169891, 0.03548718988895416, 0.009101438336074352, -0.0020457187201827765, 0.009935800917446613, 0.05156205967068672, 0.0002585853508207947, 0.018891800194978714, 0.010999804362654686, -0.02339276485145092, -0.00870339386165142, 0.0029929878655821085, -0.018156949430704117, -0.021494397893548012, 0.024158233776688576, 0.01289051491767168, -0.003140340792015195, -0.008611537516117096, 0.009300461038947105, 0.029623690992593765, -0.019366391003131866, 0.04026372358202934, -0.012944098562002182, 0.014520966447889805, -0.003301089396700263, 0.021754657849669456, -0.03864092752337456, 0.03634451702237129, -0.012216901406645775, -0.009361698292195797, 0.012270484119653702, -0.011045732535421848, 0.00017713455599732697, 0.01863154023885727, -0.0179119985550642, -0.019504176452755928, -0.0127297667786479, 0.02115759253501892, 0.04008001089096069, 0.016488224267959595, -0.012852242216467857, 0.03346635028719902, -0.021647492423653603, 0.03279273584485054, -0.0030331749003380537, -0.037477411329746246, 0.009606649167835712, 0.006609833799302578, -0.0013012990821152925, 0.04767347499728203, 0.004799497313797474, -0.05107216164469719, 0.021616874262690544, -0.02579634077847004, -0.04338684305548668, -0.02080547623336315, -0.015125688165426254, 0.017008744180202484, -0.030098281800746918, -0.02867450751364231, 0.015477803535759449, 0.03741617500782013, 0.0019318549893796444, 0.02507679909467697, -0.0027843972202390432, -0.021142281591892242, 0.01444441918283701, 0.009162676520645618, 0.00990518182516098, 0.006035731174051762, -0.023530548438429832, 0.026025980710983276, 0.03162922337651253, 0.004305768758058548, -0.016182037070393562, 0.01109166070818901, -0.026776142418384552, 0.04623439162969589, -0.009553065523505211, 0.023362144827842712, -0.004156502429395914, 0.0533379502594471, 0.034078724682331085, -0.022765079513192177, 0.017789524048566818, 0.036436375230550766, -0.0254595335572958, -0.03230283409357071, 0.00414502015337348, 0.026592429727315903, -0.003184355329722166, -0.0014783140504732728, -0.05349104478955269, 0.016626009717583656, 0.001422817469574511, -0.03704874962568283, -0.011535633355379105, -0.005821399390697479, -0.013977482914924622, 0.021295376121997833, -0.021647492423653603, 0.006854784209281206, 0.04733666777610779, -0.0399269163608551, 0.02186182327568531, 0.0037374075036495924, -0.03793669492006302, -0.02937874011695385, -0.026209693402051926, -0.032700881361961365, -0.028123369440436363, 0.041947755962610245, 0.004795669578015804, 0.004179466515779495, 0.01573806442320347, -0.00721455505117774, -0.018310043960809708, 0.02252012863755226, -0.0014467383734881878, 0.018692778423428535, 0.001158730243332684, -0.0007008835091255605, -0.0011931763729080558, -0.02786310948431492, -0.012500125914812088, -0.0056950971484184265, 0.004964073188602924, -0.02115759253501892, 0.02219863049685955, 0.0036895654629915953, -0.005618549883365631, -0.021142281591892242, -0.011987260542809963, 0.006429948378354311, 0.030970918014645576, 0.040539294481277466, -0.03515038266777992, -0.00922391377389431, -0.02542891353368759, 0.007846067659556866, 0.03417058289051056, 0.00998938363045454, -0.006958122365176678, 0.007229864597320557, -0.012921134009957314, 0.03965134918689728, 0.0254595335572958, 0.03515038266777992, -0.004030199721455574, 0.03127710521221161, 0.003771853633224964, 0.012148009613156319, 0.021111663430929184, -0.028965385630726814, 0.005710406228899956, 0.020223718136548996, -0.03395625203847885, 0.011068697087466717, -0.017376169562339783, -0.008565609343349934, 0.015753373503684998, 0.005901773925870657, -0.007356166839599609, -0.0004339258302934468, 0.021923061460256577, -0.020713619887828827, -0.0006970561225898564, 0.019106131047010422, -0.018049784004688263, -0.023270288482308388, -0.01759050041437149, 0.011994915083050728, 0.0191214419901371, -0.01494197454303503, -0.0069351582787930965, -0.015554350800812244, 0.04932688921689987, -0.010441010817885399, 0.003942170646041632, 0.02342338301241398, -0.01642698608338833, 0.00043847080087289214, 0.006870093289762735, -0.0011099315015599132, -0.03005235269665718, 0.01876932568848133, 0.02766408771276474, -0.016794413328170776, 0.029409358277916908, 0.012622600421309471, 0.01374784205108881, 0.012637910433113575, 0.012936443090438843, 0.023193741217255592, -0.011734655126929283, -0.02628624066710472, -0.03297644853591919, -0.020422739908099174, -0.005825227126479149, 0.014620477333664894, -0.025000251829624176, 0.012369995936751366, -0.011979606002569199, -0.003808213397860527, -0.03723246231675148, 0.0028915631119161844, 0.006916021928191185, 0.0008898589294403791, 0.005936220288276672, 0.013380415737628937, 0.03910020738840103, 0.020208409056067467, -0.022152703255414963, -0.007444195915013552, -0.020284956321120262, -0.01212504506111145, -0.005767816677689552, 0.02307126671075821, 0.005136304069310427, 0.010096549987792969, -0.031169939786195755, 0.01511037815362215, 0.01876932568848133, 0.02989926002919674, -0.0035996227525174618, 0.003810127032920718, 0.0010333845857530832, -0.017024053260684013, 0.011122279800474644, 0.015983013436198235, 0.012607291340827942, 0.0019280276028439403, -0.004967900458723307, 0.0065830424427986145, 0.0032570750918239355, 0.022611984983086586, 0.0273272804915905, -0.058696240186691284, 0.0846916064620018, 0.004190948326140642, 0.026408715173602104, -0.010884983465075493, -0.017636429518461227, 0.02475530095398426, -0.010196060873568058, 0.002516482723876834, -0.013234976679086685, -0.003482888685539365, 0.015049140900373459, 0.035762760788202286, -0.016013633459806442, -0.024663444608449936, 0.02646995335817337, -0.016090180724859238, -0.05119463428854942, 0.00897896382957697, -0.02203022688627243, 0.044121693819761276, 0.012079116888344288, 0.012247520498931408, 0.013770805671811104, -0.04507087543606758, 0.0032723844051361084, 0.018998965620994568, 0.014987902715802193, 0.005955356638878584, -0.014712333679199219, 0.042468275874853134, -0.008152255788445473, -0.02372957020998001, -0.034109342843294144, 0.02749568410217762, -0.018708087503910065, 0.03701813146471977, -0.023163123056292534, 0.008550300262868404, -0.008435479365289211, -0.0310627743601799, 0.0093770083039999, 0.02101980708539486, -0.018570302054286003, 0.012339376844465733, -0.01015778724104166, 0.0040034083649516106, -0.00905551016330719, 0.0065830424427986145, -0.00939231738448143, 0.016488224267959595, 0.02392859384417534, 0.010800781659781933, 0.01878463476896286, -0.0015462494920939207, -0.010333845391869545, 0.03291521221399307, 0.0031900962349027395, 0.06387081742286682, 0.003926861099898815, -0.0003777116071432829, -0.02718949504196644, -0.012875205837190151, -0.0049449363723397255, 0.018034473061561584, 0.001662026857957244, -0.02389797382056713, -0.007991506718099117, 0.001684990944340825, -0.03417058289051056, 0.023821426555514336, -0.02408168651163578, 0.005266433581709862, 0.023163123056292534, -0.018187567591667175, -0.006284508854150772, 0.009155021980404854, -0.002859030617401004, 0.030833132565021515, 0.01930515468120575, 0.0413966178894043, -0.025015560910105705, 0.01844782754778862, -0.017820142209529877, 0.02646995335817337, 0.010272608138620853, -0.012875205837190151, 0.011474396102130413, -0.019243916496634483, -0.0331907793879509, 0.012063807807862759, -0.01034149993211031, -0.00021947460481896996, 0.02530643902719021, 0.004799497313797474, -0.03075658529996872, 0.002575806574895978, -0.008381896652281284, 0.009698505513370037, 0.019106131047010422, -0.003831177484244108, -0.03530347719788551, -0.016656627878546715, 0.00014424325490836054, 0.008810560218989849, -0.03551780804991722, 0.027556920424103737, -0.01527878176420927, -0.013916244730353355, 0.001150118769146502, -0.008948344737291336, 0.01642698608338833, -0.0005587931373156607, 0.026439335197210312, 0.021632183343172073, -0.010953876189887524, 0.00470381323248148, 0.00033226184314116836, 0.03567090258002281, 0.006552423350512981, -0.039559490978717804, 0.03769174590706825, 0.01945824734866619, 0.042805083096027374, -0.018554992973804474, -0.011298337951302528, -0.014505657367408276, -0.003406341653317213, -0.01154328789561987, 0.011466740630567074, 0.0089559992775321, -0.015638552606105804, 0.008068053983151913, 0.023943902924656868, 0.0009573159622959793, 0.0042253946885466576, 0.0261178370565176, 0.012331722304224968, 0.012676184065639973, -0.01374018657952547, -0.010119513608515263, 0.0038196954410523176, 0.022076155990362167, 0.007279620040208101, 0.028812291100621223, 0.0015644293744117022, -0.0328233540058136, 0.004546891897916794, 0.004615784157067537, 0.014926665462553501, 0.014199469238519669, -0.026699595153331757, 0.000659739482216537, -0.0014170764479786158, 0.013035954907536507, -0.02103511616587639, 0.0014869255246594548, -0.011788238771259785, -0.03159860149025917, 0.004462690092623234, -0.016090180724859238, 0.02971554733812809, -0.014475038275122643, -0.0028858219739049673, -0.012683838605880737, 0.02766408771276474, -0.036803800612688065, -0.03380315750837326, 0.011474396102130413, 0.008512026630342007, -0.03214973956346512, -0.01451331190764904, 0.02323967032134533, 0.009461209177970886, 0.00982098001986742, -0.016457606106996536, 0.004443553742021322, -0.03686503693461418, -0.012951753102242947, -0.013893281109631062, 0.01812632940709591, -0.011512668803334236, -0.008779941126704216, 0.028138678520917892, -0.007352339569479227, 0.003247506683692336, -0.002017013495787978, -0.004929626826196909, 0.011941332370042801, -0.016120798885822296, -0.028996005654335022, 0.003226456232368946, -0.0022236905060708523, 0.028108060359954834, 0.008688084781169891, 0.010701270774006844, 0.03710998594760895, 0.013418689370155334, -0.000979323172941804, 0.018065093085169792, 0.00923922285437584, 0.04583634436130524, 0.007501606363803148, -0.00011338524927850813, -0.017636429518461227, 0.0023844391107559204, 0.0033527587074786425, 0.017529264092445374, 0.007907305844128132, -0.0033355357591062784, -0.010395082645118237, -0.005086548160761595, -0.0027576058637350798, 0.0005406131967902184, 0.010303226299583912, 0.017284313216805458, -0.0074633327312767506, 0.019167369231581688, 0.02665366604924202, -0.040018774569034576, -0.016488224267959595, 0.007930269464850426, 0.006384020205587149, 0.0020648553036153316, -0.008634502068161964, -0.019687889143824577, 0.009698505513370037, 0.018202876672148705, -0.00061955233104527, 0.0009391360217705369, 0.0038809331599622965, -0.014436764642596245, 0.019902219995856285, 0.005947702098637819, -0.026225002482533455, 0.012584327720105648, -0.01979505456984043, -0.0053047072142362595, 0.007413577288389206, -0.011857130564749241, -0.031996648758649826, 0.005143958609551191, 0.0011826511472463608, 0.02905724197626114, 0.02184651419520378, -0.014566894620656967, 0.06546299904584885, 0.03882464021444321, 0.015653861686587334, -0.037997931241989136, 0.022259868681430817, -0.03808978945016861, 0.011160553433001041, 0.002200726419687271, -0.021050425246357918, 0.01537829264998436, -0.039008352905511856, -0.013020644895732403, 0.003570917760953307, 0.010441010817885399, 0.011849476024508476, 0.017039362341165543, -0.03864092752337456, 0.0331907793879509, 0.015607933513820171, -0.021968990564346313, 0.04522396996617317, -0.03707936778664589, 0.022091465070843697, 0.004106746520847082, -0.03123117797076702, -0.006808856036514044, 0.013625366613268852, 0.02033088356256485, -0.024219471961259842, -0.02594943344593048, 0.03401748836040497, 0.01710060052573681, -0.0007697758264839649, 0.017896689474582672, -0.019228607416152954, -0.004336387850344181, 0.0070805978029966354, -0.006131414789706469, 0.00870339386165142, 0.01520988903939724, 0.02613314613699913, -0.0030082971788942814, -0.010731889866292477, -0.010670652613043785, 0.011665763333439827, 0.006961950100958347, 0.024678753688931465, 0.005327671300619841, -0.02576572075486183, -0.0054845926351845264, 0.010264952667057514, -0.013954518362879753, -0.05006173998117447, -0.001076442189514637, 0.02815398760139942, -0.021923061460256577, -0.021234137937426567, -0.002378698205575347, 0.026913926005363464, 0.023499930277466774, 0.025153344497084618, 0.0002676752919796854, 0.02221393957734108, -0.006039558444172144, 0.01409230288118124, -0.0019596032798290253, 0.004554546903818846, 0.00683947466313839, 0.016641318798065186, 0.007203072775155306, 0.03518100082874298, -0.03417058289051056, 0.02679145149886608, -0.016442297026515007, 0.03873278200626373, -0.001338615664280951, -0.002353820251300931, 0.02973085641860962, -0.018019163981080055, -0.015232853591442108, -0.010548177175223827, -0.04087609797716141, 0.02046866901218891, 0.023438692092895508, -0.002600684529170394, 0.027710014954209328, -0.002700195414945483, 0.019856292754411697, -0.01622796431183815, -0.013655985705554485, -0.00358622707426548, -0.01847844570875168, 0.0382428839802742, 0.03214973956346512, -0.022811006754636765, -0.028980694711208344, 0.007976197637617588, 0.00406081834807992, -0.032210979610681534, -0.03591585531830788, 0.026179075241088867, 0.011918368749320507, 0.014406145550310612, 0.01341103482991457, 0.02048397809267044, 0.04369302839040756, 0.024816539138555527, 0.020606452599167824, -0.04626500979065895, 0.006544768810272217, 0.022994719445705414, 0.01322732213884592, -0.025168655440211296, -0.04424416646361351, -0.00923922285437584, -0.023316217586398125, -0.005587931256741285, 0.003260902361944318, 0.025857577100396156, -0.0020820784848183393, 0.01777421496808529, 0.022152703255414963, -0.01322732213884592, -0.03279273584485054, 0.0011386367259547114, -0.0025356195401400328, 0.023285597562789917, 0.015845229849219322, 0.03796731308102608, -0.044121693819761276, 0.007203072775155306, -0.01654946245253086, 0.023959212005138397, -0.0009678411879576743, -0.010808437131345272, 0.016488224267959595, -0.006005112547427416, -0.00819052942097187, -0.020116552710533142, -0.00734085775911808, 0.027755944058299065, -0.008435479365289211, -0.008825869299471378, -0.011336611583828926]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" A., Mu-
tuma, M., Tarabar, Y ., Gupta, A., Yu, T., Tan, Y . C.,
Lin, X. V ., Xiong, C., Socher, R., and Rajani, N. F.
DART: Open-domain structured data record to text gen-
eration. In Toutanova, K., Rumshisky, A., Zettlemoyer,
L., Hakkani-Tur, D., Beltagy, I., Bethard, S., Cotterell,
R., Chakraborty, T., and Zhou, Y . (eds.), Proceedings
of the 2021 Conference of the North American Chap-
ter of the Association for Computational Linguistics:
Human Language Technologies , pp. 432–447, Online,
June 2021. Association for Computational Linguistics.
doi: 10.18653/v1/2021.naacl-main.37. URL https:
//aclanthology.org/2021.naacl-main.37 .
Novikova, J., Du ˇsek, O., and Rieser, V . The e2e dataset:
New challenges for end-to-end generation, 2017.
Pilanci, M. and Ergen, T. Neural networks are convex
regularizers: Exact polynomial-time convex optimization
formulations for two-layer networks, 2020.
Qiu, Z., Liu, W., Feng, H., Xue, Y ., Feng, Y ., Liu, Z., Zhang,
D., Weller, A., and Sch ¨olkopf, B. Controlling text-to-
image diffusion by orthogonal finetuning, 2023.
Radford, A., Wu, J., Child, R., Luan, D., Amodei,
D., and Sutskever, I. Language models are unsu-
pervised multitask learners. 2019. URL https:
//api.semanticscholar.org/CorpusID:
160025533 .
Recht, B., Fazel, M., and Parrilo, P. A. Guaranteed
minimum-rank solutions of linear matrix equations via
nuclear norm minimization. SIAM Review , 52(3):
471–501, January 2010. ISSN 1095-7200. doi: 10.
1137/070697835. URL http://dx.doi.org/10.
1137/070697835 .
Rombach, R., Blattmann, A., Lorenz, D., Esser, P., and
Ommer, B. High-resolution image synthesis with la-
tent diffusion models. In Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition
(CVPR) , pp. 10684–10695, June 2022.
Ryu, S. Low-rank adaptation for fast text-to-image
diffusion fine-tuning. https://github.com/
cloneofsimo/lora/tree/master , 2023.
Schoenholz, S. S., Gilmer, J., Ganguli, S., and Sohl-
Dickstein, J. Deep information propagation, 2017.
Stanley, R. P. et al. An introduction to hyperplane arrange-
ments. Geometric combinatorics , 13(389-496):24, 2004.Tong, T., Ma, C., and Chi, Y . Low-rank matrix recovery with
scaled subgradient methods: Fast and robust convergence
without the condition number. IEEE Transactions on
Signal Processing , 69:2396–2409, 2021a. ISSN 1941-
0476. doi: 10.1109/tsp.2021.3071560. URL http://
dx.doi.org/10.1109/TSP.2021.3071560 .
Tong, T., Ma, C., and Chi, Y . Accelerating ill-conditioned
low-rank matrix estimation via scaled gradient descent,
2021b.
Tong, T., Ma, C., Prater-Bennette, A., Tripp, E., and Chi,
Y . Scaling and scalability: Provable nonconvex low-rank
tensor estimation from incomplete measurements, 2022.
Valipour, M., Rezagholizadeh, M., Kobyzev, I., and Ghodsi,
A. Dylora: Parameter efficient tuning of pre-trained
models using dynamic search-free low-rank adaptation,
2023.
Wang, A., Singh, A., Michael, J., Hill, F., Levy, O., and
Bowman, S. GLUE: A multi-task benchmark and analysis
platform for natural language understanding. In Linzen,
T., Chrupała, G., and Alish","[-0.013155737891793251, 0.045009419322013855, 0.038963377475738525, -0.00523780332878232, 0.015367021784186363, 0.0074315923266112804, -0.015017135068774223, 0.00903407298028469, -0.0711529478430748, 0.010447615757584572, 0.010013756342232227, 0.006630352232605219, -0.032833363860845566, 0.029250524938106537, 0.02953043393790722, 0.01235799677670002, 0.03258144482970238, -0.041426580399274826, -0.00429660826921463, 0.0438058078289032, -0.011917139403522015, -0.034484829753637314, 0.004132161382585764, 0.0006730944733135402, 0.023288454860448837, 0.0101257199421525, 0.03496067598462105, 0.03515661135315895, 0.0015963579062372446, -0.02008349448442459, 0.004520535469055176, -0.03174171596765518, -0.026143530383706093, -0.03619227558374405, -0.025821635499596596, 0.04358188062906265, 0.030846007168293, 0.02961440570652485, 0.005815116222947836, 0.0019366226624697447, -0.004730467684566975, -0.05878095701336861, 0.012630907818675041, 0.015003140084445477, 0.013428649865090847, -0.009062063880264759, 0.034848712384700775, -0.012861832976341248, 0.0013881752965971828, 0.04067082330584526, -0.07669515162706375, 0.006679336074739695, -0.019929543137550354, -0.02103518508374691, -0.06437914073467255, 0.01988755725324154, 0.011105402372777462, 0.030734043568372726, 0.023008545860648155, -0.029222533106803894, 0.01511510368436575, -0.03893538564443588, 0.01848801039159298, 0.015269053168594837, -0.036948028951883316, -0.030846007168293, -0.058501049876213074, 0.014100432395935059, -0.006147508509457111, 0.014170409180223942, 0.00020205954206176102, -0.007865452207624912, 0.03241350129246712, -0.03672410175204277, -0.03216158226132393, -0.0095589030534029, -0.002087073866277933, 0.07871050387620926, 0.0056716627441346645, -0.043525900691747665, 0.019789589568972588, 0.013330681249499321, 0.006231481209397316, -0.01910381205379963, -0.05287487059831619, -0.04061484336853027, -0.00718667171895504, -0.001699574408121407, -0.05024372413754463, 0.006983737461268902, -0.04041890799999237, 0.011945130303502083, 0.003486620495095849, 0.030901988968253136, 0.04302206262946129, 0.025989580899477005, 0.01710245944559574, 0.0021780445240437984, 0.042546216398477554, 0.02891463227570057, -0.03820762410759926, 0.003554848488420248, 0.035996340215206146, -0.015325034968554974, 0.04514937475323677, -0.02253269962966442, -0.03140582516789436, -0.03174171596765518, 0.017648283392190933, 0.03190966323018074, -0.1053018867969513, -0.011168382130563259, -0.0357724130153656, 0.017200427129864693, 0.02296655997633934, -0.08906714618206024, -0.052986834198236465, -0.0024037212133407593, -0.031181897968053818, -0.002886564936488867, -0.034400854259729385, -0.0075295609422028065, 0.04534531012177467, 0.027990931645035744, 0.028466777876019478, -0.025401771068572998, 0.03339318186044693, -0.0335051454603672, -0.024701997637748718, -0.02603156678378582, 0.036248255521059036, 0.010832490399479866, 0.03148979693651199, -0.021175140514969826, -0.04109068959951401, -0.032133590430021286, 0.01857198402285576, -0.0029600411653518677, -0.024660011753439903, 0.0036248257383704185, -9.835095261223614e-05, -0.014611266553401947, -0.020993199199438095, 0.020545344799757004, -0.048956140875816345, 0.01265889871865511, -0.011154386214911938, 0.02769702672958374, 0.0004845930088777095, 0.04179046303033829, 0.0024037212133407593, 0.009355968795716763, -0.042826127260923386, 0.02558371238410473, -0.039915069937705994, -0.05405049026012421, 0.0044400617480278015, 0.05444236472249031, 0.025457752868533134, -0.04374982789158821, 0.010965447872877121, 0.059396758675575256, 0.025793643668293953, 0.0008209215593524277, 0.027501091361045837, 0.013421651907265186, -0.023722315207123756, -0.01472323015332222, -0.06432316452264786, -0.06790599972009659, 0.018865888938307762, -0.03722793981432915, -0.030818017199635506, -0.015660926699638367, -0.0031647246796637774, -0.000166086814715527, -0.03336519002914429, -0.0060250479727983475, 0.008929107338190079, -0.046492937952280045, -0.01130133867263794, 0.012057093903422356, -0.011707207188010216, 0.0130577702075243, -0.03672410175204277, -0.013337679207324982, 0.013512622565031052, 0.007942426949739456, -0.005335771478712559, 0.052902862429618835, -0.012274024076759815, 0.04251822456717491, 0.03305729106068611, 0.01910381205379963, 0.016234740614891052, -0.035380538552999496, 0.06320352852344513, -0.034484829753637314, 0.006875272840261459, -0.01638869009912014, 0.00145640317350626, 0.05558999255299568, -0.042210325598716736, -0.04346991702914238, -0.004349091090261936, -0.013995465822517872, -0.013904495164752007, 0.0038347577210515738, -0.025093870237469673, -0.03263742849230766, 0.03857150301337242, 0.024701997637748718, 0.033785056322813034, 0.019831575453281403, -0.03059408813714981, -0.0017354377778246999, -0.04845230281352997, 0.028522759675979614, 0.007522562984377146, 0.035632457584142685, -0.024072201922535896, 0.03591236472129822, 0.029026595875620842, -0.00029937177896499634, -0.03241350129246712, 0.010846486315131187, 0.020895231515169144, -0.029138561338186264, 0.062363795936107635, -0.03196564316749573, 0.0839168131351471, -0.005941075272858143, 0.0033291715662926435, -0.027850978076457977, 0.018907874822616577, -0.07417596876621246, 0.001831656671129167, -0.034848712384700775, 0.03051011636853218, -0.015381017699837685, -0.009523915126919746, -0.01011872198432684, 0.013932486064732075, 0.027291158214211464, 0.014212395995855331, 0.03820762410759926, -0.041734479367733, -0.04016698896884918, 0.028466777876019478, 0.01152526680380106, 0.027389127761125565, -0.006969742011278868, -0.006283964496105909, -0.03594035655260086, -0.013505624607205391, -0.022756628692150116, -0.02762705087661743, -0.005818615201860666, -0.020811257883906364, 0.017564309760928154, -0.01866995170712471, 0.028718696907162666, -0.017466342076659203, 0.03406496345996857, 0.007578544784337282, 0.006861277390271425, -0.04198639839887619, 0.04170648753643036, 0.005703152623027563, -0.024953916668891907, 0.00021190010011196136, -0.008327302522957325, 0.0026731339748948812, 0.0064903972670435905, -0.04814440384507179, 0.0006975865107960999, 0.012917814776301384, -0.012861832976341248, -0.021189136430621147, 0.0068017966113984585, 0.01970561593770981, 0.05670962855219841, 0.057717300951480865, 0.01657063141465187, -0.011322332546114922, 0.005101347342133522, -0.009495924226939678, -0.009726849384605885, -0.03451281785964966, -0.008880123496055603, 0.030706053599715233, -0.02542976103723049, 0.01605279929935932, -0.04095073416829109, 0.01833406090736389, 0.010622559115290642, 0.0015753646148368716, -0.015157089568674564, -0.00823633186519146, -0.03263742849230766, 0.02270064689218998, -0.012127071619033813, 0.0069417511112987995, 0.029138561338186264, -0.01556295808404684, 0.04179046303033829, 0.029054587706923485, 0.00836928840726614, 0.025037888437509537, -0.009013080038130283, -0.00990878976881504, 0.04909609630703926, -0.010216690599918365, 0.015506976284086704, -0.059116847813129425, -0.006053038872778416, 0.05284687876701355, -0.037032004445791245, 0.008950100280344486, -0.0629236176609993, -0.030118243768811226, -0.047108739614486694, 0.009663869626820087, 0.011812173761427402, -0.009313982911407948, 0.005727644544094801, -0.021608998998999596, -0.005843107122927904, -0.021091166883707047, -0.0487322136759758, 0.01578688621520996, -0.010237683542072773, 0.03120988979935646, 0.01077650859951973, -0.019327739253640175, -0.04383379966020584, -0.03235751762986183, 0.05662565678358078, 0.05063559487462044, 0.013624586164951324, -0.061747997999191284, -0.05133536830544472, -0.001898135058581829, 0.010937456972897053, 0.012868830934166908, 0.025107866153120995, -0.009153034538030624, 0.020405389368534088, 0.022770622745156288, 0.026885289698839188, 0.02761305496096611, -0.02041938528418541, 0.018180111423134804, 0.03112591616809368, 0.011056418530642986, 0.03795570507645607, -0.025401771068572998, -0.02698325924575329, -0.00270462385378778, -0.01008373312652111, -0.006231481209397316, -0.021091166883707047, 0.018809907138347626, 0.02263066917657852, 0.01841803267598152, -0.005132837221026421, -0.019943539053201675, 0.04355388879776001, 0.010965447872877121, -0.0049928827211260796, -0.002538427710533142, 0.032301533967256546, -0.030398152768611908, -0.011182377114892006, -0.03655615821480751, 0.026073552668094635, -0.012155062519013882, 0.03266541659832001, -0.00253317947499454, 0.044477593153715134, -0.009090055711567402, 0.005692655686289072, -0.017676273360848427, -0.0028848154470324516, -0.012267026118934155, 0.006014551501721144, 0.010720526799559593, -0.019257761538028717, -0.02674533613026142, 0.03336519002914429, -0.004576517269015312, -0.0004058685153722763, -0.05416245386004448, 0.01727040484547615, 0.029502442106604576, -0.0015657427720725536, -0.03406496345996857, 0.009712853468954563, 0.03288934379816055, 0.012546935118734837, 0.005342768970876932, 0.007543556392192841, -0.011322332546114922, 0.010398630984127522, -0.008873125538229942, 0.05934077501296997, 0.03806766867637634, 0.06566672772169113, 0.027403121814131737, 0.022644665092229843, 0.022490713745355606, -0.04878819361329079, 0.009523915126919746, -0.014156414195895195, -0.007963419891893864, -0.021608998998999596, 0.03129386156797409, 0.021874913945794106, -0.008341297507286072, 0.06801796704530716, -0.01866995170712471, 0.00389073952101171, -0.029586415737867355, -0.039831098169088364, -0.03154578059911728, 0.05435838922858238, 0.025709671899676323, -0.02446407452225685, 0.01920177973806858, -0.03980310633778572, -0.03666812181472778, -0.006217485759407282, 0.041510552167892456, -0.030202215537428856, -0.05133536830544472, -0.040194977074861526, 0.06057237833738327, 0.03162975236773491, 0.04109068959951401, -0.08453261852264404, -0.02453405223786831, -0.0029512939509004354, -0.06729020178318024, 0.00300202751532197, -0.011238358914852142, 0.014485307037830353, -0.005790624301880598, 0.026101544499397278, -0.002657389035448432, -0.030901988968253136, -0.0004981511156074703, 0.004489045590162277, 0.05782926455140114, -0.03174171596765518, 0.010678540915250778, -0.04696878418326378, 0.06980938464403152, -0.021259112283587456, 0.030286189168691635, -0.012120073661208153, 0.031685736030340195, 0.02689928561449051, -0.025527730584144592, -0.010699533857405186, 0.00994377862662077, 0.03272140026092529, 0.016934514045715332, -0.014639257453382015, 0.023596355691552162, -0.0017179434653371572, 0.009691860526800156, 0.015590948984026909, -0.02428213320672512, -0.026437435299158096, -0.0032609435729682446, 0.028886642307043076, 0.025975584983825684, -0.04411371052265167, -0.029082579538226128, -0.018543992191553116, 0.03148979693651199, -0.04775252938270569, 0.01235799677670002, -0.005678660236299038, 0.043329961597919464, 0.04822837561368942, 0.018991848453879356, 0.0015071367379277945, -0.0033291715662926435, 0.00906906183809042, 0.00911804661154747, 0.003519859630614519, 0.05329473316669464, -0.01665460504591465, -0.02769702672958374, -0.0058466061018407345, -0.04330197349190712, -0.005328773520886898, 0.018432028591632843, -0.044589556753635406, 0.008299311622977257, -0.0029233030509203672, -0.003505864180624485, -0.003108742879703641, -0.018432028591632843, -0.0425742082297802, 0.029166551306843758, 0.022910578176379204, 0.01813812367618084, 0.06342745572328568, 0.000664347258862108, 0.0464649461209774, 0.004597510676831007, 0.031069934368133545, 0.013869507238268852, 0.061580050736665726, -0.051755234599113464, 0.021329089999198914, -0.03750785067677498, 0.02997828833758831, 0.0030807519797235727, -0.014268377795815468, -0.01371555682271719, -0.015087112784385681, 0.002078326651826501, -0.006619855295866728, -0.026801317930221558, -0.08033397793769836, -0.017816228792071342, -0.013295692391693592, 0.02243473194539547, -0.014989144168794155, 0.0128478379920125, 0.014709235168993473, -0.06012452393770218, -0.01710245944559574, 0.004086676053702831, -0.024506060406565666, -0.05197916179895401, 0.03140582516789436, 0.005388254299759865, 0.03235751762986183, -0.004083177074790001, 0.032553452998399734, -0.0029233030509203672, -0.03218957036733627, 0.027319150045514107, -0.03132185339927673, -0.00871917512267828, 0.016696590930223465, 0.07148884236812592, -0.017830224707722664, 0.0171724371612072, -0.020447375252842903, -0.017718259245157242, 0.005734642036259174, 0.013211719691753387, 0.021413063630461693, 0.010062740184366703, 0.0004082739760633558, 0.020755276083946228, -0.01664060913026333, -0.0024597032461315393, 0.024869943037629128, -0.03985908627510071, 0.010692535899579525, 0.0010881475172936916, -0.03171372786164284, -0.01700449176132679, 0.007648522034287453, -0.007396603934466839, -0.035184603184461594, 0.030482124537229538, 0.0011520017869770527, 0.012959801591932774, -0.008033397607505322, 0.03552049398422241, 0.0011808674316853285, 0.005815116222947836, 0.011707207188010216, -0.054218437522649765, -0.022196808829903603, -0.031769707798957825, -0.008180350065231323, -0.04713673144578934, 0.026241498067975044, 0.009264998137950897, 0.00911804661154747, -0.035436518490314484, 0.02368032932281494, 0.06555476039648056, -0.01787221059203148, -0.034232910722494125, -0.0249819066375494, -0.03882342204451561, -0.002074827905744314, 0.033617109060287476, -0.029502442106604576, -0.026927277445793152, 0.019061824306845665, 0.013981470838189125, -0.012092082761228085, -0.02771102264523506, -0.02471599355340004, 0.016794558614492416, -0.0006866525509394705, 0.005017374642193317, 0.03112591616809368, 0.013960477896034718, -0.006938252132385969, -0.015199076384305954, 0.00026350838015787303, -0.016066795215010643, -0.01402345672249794, 0.006371436174958944, -0.0008795275934971869, -0.028452781960368156, -0.004380580969154835, 0.05581391975283623, -0.029502442106604576, -0.014107429422438145, -0.04117466136813164, -0.007179674226790667, 0.008635202422738075, 0.01594083569943905, 0.014625262469053268, -0.015003140084445477, -0.046408966183662415, -0.021692972630262375, -0.009705855511128902, -0.03367309272289276, -0.019495684653520584, 0.02927851490676403, 0.0298103429377079, 0.005958569701761007, -0.010944454930722713, 0.014639257453382015, -0.010678540915250778, 0.01980358548462391, -0.04235028102993965, 0.021497035399079323, 0.008635202422738075, -0.011854159645736217, -0.01183316670358181, 0.01875392533838749, -0.020097488537430763, -0.018879882991313934, 0.00841127522289753, -0.045373301953077316, -0.008852132596075535, -0.019663630053400993, -0.030398152768611908, 0.021455049514770508, 0.009369964711368084, 0.023274460807442665, -0.007802472449839115, -0.002632897114381194, 0.0007784977788105607, -0.005468728486448526, 0.0002455766953062266, -0.044309645891189575, 0.004317601211369038, -0.0201534703373909, 0.009230010211467743, -0.018823901191353798, 0.03901936113834381, 0.0031524787191301584, 0.03487670049071312, -0.012875828891992569, 0.0005821239319629967, 0.041734479367733, -0.0032434493768960238, 0.026157526299357414, 0.0017625540494918823, 0.016164762899279594, -0.024226151406764984, 0.011623234488070011, -0.03263742849230766, 0.0006857778644189239, 0.023596355691552162, -0.02103518508374691, 0.01701848767697811, -0.06040443107485771, -0.0037297916132956743, 0.004422567319124937, -0.02305053360760212, 0.02743111364543438, 0.01578688621520996, 0.011987117119133472, -0.0335051454603672, 0.0035286068450659513, -0.0011240108869969845, -0.0008541608112864196, -0.01936972513794899, 0.000481094146380201, 0.038683466613292694, -0.019173787906765938, 0.028032919391989708, -0.008663193322718143, -0.0896269679069519, 0.00941894855350256, 0.02822885476052761, -0.04934801533818245, -0.007001231890171766, -0.03199363499879837, -0.017130451276898384, -0.02453405223786831, 0.007858454249799252, 0.05528208985924721, -0.01727040484547615, -0.0016042302595451474, 0.007375610526651144, -0.02260267734527588, -0.002531429985538125, -0.04075479879975319, 0.0136735700070858, 0.02961440570652485, 0.00694525009021163, -0.0009079558658413589, -0.025611702352762222, -0.050719570368528366, -0.007389605976641178, -0.020727286115288734, -0.02183292806148529, 0.008005406707525253, -0.016276726499199867, -0.013435647822916508, -0.006252474617213011, -0.005472227465361357, 0.011917139403522015, 0.009202019311487675, 0.02481396123766899, 0.01419840008020401, -0.014807202853262424, 0.002786847297102213, 0.003042264375835657, -0.022224800661206245, 0.01998552493751049, 0.0037122974172234535, 0.007655519992113113, -0.03333720192313194, -0.027291158214211464, 0.010580572299659252, 0.033869028091430664, -0.005738141015172005, 0.009852807968854904, 0.02445007860660553, 0.00963587872684002, 0.008355293422937393, 0.024408092722296715, -0.028158877044916153, 0.013078763149678707, 0.015982821583747864, -0.0152130713686347, -0.005636673886328936, -0.027011249214410782, 0.02121712639927864, 0.001389924786053598, -0.022644665092229843, 0.0071656787768006325, 0.01963563822209835, 0.0219029039144516, -0.007634526584297419, 0.025835629552602768, 0.013652577064931393, -0.01200811006128788, -0.006088027730584145, 0.01135032344609499, -0.017116455361247063, 0.01060856319963932, -0.02068529836833477, -0.01165822334587574, 0.022154822945594788, 0.017564309760928154, 0.0485362783074379, -0.0018876384710893035, 0.0033326703123748302, 0.009859805926680565, -0.007858454249799252, 0.012302014976739883, -0.021455049514770508, 0.017760246992111206, 0.01798417419195175, 0.008922109380364418, 0.0064903972670435905, -0.03314126282930374, -0.049403995275497437, 0.005143333692103624, 0.02418416552245617, -0.0355764739215374, -0.03820762410759926, 0.01419840008020401, 0.028032919391989708, 0.002765853889286518, 0.00946093536913395, 0.049292031675577164, -0.008971094153821468, -0.08744367212057114, -0.016024809330701828, 0.009376962669193745, 0.013834518380463123, 0.04120265319943428, -0.013799529522657394, 0.016416681930422783, 0.009432944469153881, 0.01248395536094904, -0.02743111364543438, 0.01214106660336256, -0.00677380571141839, 0.0024037212133407593, -0.007109696976840496, 0.018460020422935486, -0.04856426641345024, 0.03591236472129822, -0.017228418961167336, 0.05427441745996475, -0.005591188557446003, -0.021231122314929962, 0.007452585734426975, 0.03059408813714981, 0.013904495164752007, -0.02174895443022251, -0.0005707525997422636, 0.02295256406068802, -0.010202694684267044, 0.009789828211069107, 0.013869507238268852, -0.008845134638249874, -0.03862748667597771, 0.017690269276499748, 0.039943061769008636, -0.04945997893810272, -0.001831656671129167, -0.01064355205744505, 0.01319072674959898, -0.012700885534286499, -0.004611506126821041, -0.019425706937909126, -0.05889292061328888, 0.013974472880363464, -0.022378750145435333, 0.04293809086084366, -0.00747357914224267, 0.014737226068973541, -0.035380538552999496, 0.007368613034486771, -0.007746490649878979, 0.021161144599318504, -0.004139158874750137, 0.006469404324889183, 0.012225039303302765, -0.008075383491814137, -0.016332708299160004, 0.0030335173942148685, -0.01568891666829586, 0.009586893953382969, 0.03137783333659172, -0.01099343877285719, 0.031853679567575455, 0.003803267842158675, -0.020559338852763176, -0.026689354330301285, -0.04321799799799919, -0.011742196045815945, 0.05181121453642845, -0.02271464094519615, -0.038263604044914246, -0.00523430434986949, 0.03636022284626961, 0.001817661221139133, 0.0068017966113984585, -0.0028690705075860023, -0.028074905276298523, 0.021343085914850235, 0.038515523076057434, -0.029418470337986946, -0.007578544784337282, 0.018390042707324028, -0.03224555402994156, 0.001978609012439847, 0.014177407138049603, -0.020545344799757004, 0.028004927560687065, 0.029334496706724167, 0.0015779888490214944, -0.019327739253640175, 0.04565320909023285, 0.06023648753762245, -0.0014494054485112429, 0.014044450595974922, -0.032469481229782104, 0.003876744071021676, -0.029222533106803894, 0.015884853899478912, 0.023778297007083893, 0.009537910111248493, 0.00011819608334917575, 0.04123064503073692, 0.017550313845276833, -0.03689204901456833, 0.004782950505614281, 0.02174895443022251, 0.018012164160609245, 0.027333145961165428, -0.0243661068379879, 0.012029103003442287, -0.027753008529543877, 0.0062979599460959435, 0.018977852538228035, -0.010356645099818707, -0.008782154880464077, 0.004957893863320351, 0.015101107768714428, 0.013911493122577667, 0.035996340215206146, -0.007970417849719524, 0.008607211522758007, 0.011714205145835876, 0.014163412153720856, 0.012966799549758434, 0.009684862568974495, -0.04738864675164223, -0.012420976534485817, 0.030202215537428856, -0.00871917512267828, -0.014086436480283737, -0.006130014080554247, 0.030258197337388992, -0.029698379337787628, -0.005024372134357691, 0.03955118730664253, 0.00044763623736798763, 0.014303366653621197, 0.007725497242063284, 0.04971189424395561, -0.0322735458612442, 0.04321799799799919, 0.009691860526800156, 0.005248299799859524, 0.01990155316889286, -0.024869943037629128, -0.007942426949739456, 0.014471312053501606, -0.019607648253440857, -0.038095660507678986, -0.007697506342083216, -0.028032919391989708, 0.04526133835315704, 0.02349838800728321, -0.019565662369132042, 0.02026543579995632, 0.004454057198017836, 0.02839680016040802, -0.0015543714398518205, -0.02321847900748253, -0.022756628692150116, 0.02927851490676403, 0.004901912063360214, 0.04674485698342323, -0.011882150545716286, -0.018781915307044983, 0.03717195987701416, -0.035100627690553665, -0.015758894383907318, -0.016948509961366653, -0.020461371168494225, 0.003574092173948884, -0.0008362291264347732, -0.0059480732306838036, 0.025401771068572998, 0.030957970768213272, 0.004412070848047733, 0.022280782461166382, 0.01823609322309494, -0.004524034447968006, 0.019089816138148308, 0.02428213320672512, 0.0004990258603356779, -0.00329943117685616, -0.030286189168691635, 0.02428213320672512, 0.020643312484025955, 0.012735874392092228, 0.00841127522289753, -0.014177407138049603, 0.015646930783987045, 0.02787896804511547, -0.020461371168494225, 0.015548963099718094, 0.011707207188010216, 0.06829787790775299, 0.0345408096909523, -0.029334496706724167, 0.009341973811388016, 0.020279429852962494, -0.014016459695994854, -0.0062139867804944515, -0.010405628941953182, 0.03837556764483452, 0.006875272840261459, -0.002610154449939728, -0.05967666581273079, 0.033085282891988754, -0.018040155991911888, -0.013932486064732075, 0.017298396676778793, 0.018543992191553116, -0.010944454930722713, 0.03490469232201576, -0.03199363499879837, 0.023442406207323074, 0.023638341575860977, -0.026927277445793152, 0.0010925211245194077, 0.03442884609103203, -0.03417692705988884, -0.050187740474939346, -0.037647802382707596, -0.027109218761324883, -0.021692972630262375, 0.011693212203681469, -0.026493417099118233, 0.016864536330103874, 0.02286859229207039, -0.01043361984193325, -0.00903407298028469, 0.014443321153521538, 0.0011686214711517096, -0.0015325035201385617, -0.0014336605090647936, 0.021063176915049553, 0.006137012038379908, -0.0024999401066452265, -0.006815792061388493, -0.016682595014572144, 0.005682159215211868, 0.013442644849419594, 0.021581009030342102, 0.018446024507284164, 0.003257444826886058, -0.012602916918694973, -0.017312390729784966, 0.017942188307642937, 0.014443321153521538, 0.04125863313674927, -0.028242850676178932, -0.0018491509836167097, -0.014142418280243874, 0.013869507238268852, 0.04120265319943428, 0.01910381205379963, 0.006784302182495594, -6.943063453945797e-06, 0.015143094584345818, 0.04531731829047203, 0.023456402122974396, 0.04338594526052475, -0.01630471833050251, 0.04680083692073822, 0.014891175553202629, -0.015926839783787727, 0.017312390729784966, -0.010846486315131187, 0.013904495164752007, -0.01183316670358181, -0.014485307037830353, 0.02295256406068802, -0.04335795342922211, 0.01631871424615383, 0.03252546489238739, 0.007543556392192841, 0.0009744343115016818, -0.006668839603662491, 0.033701080828905106, -0.01910381205379963, 0.02278461866080761, 0.026507413014769554, -0.037647802382707596, -0.013302690349519253, -0.0013199474196881056, -0.0007881196797825396, 0.03104194439947605, -0.005727644544094801, -0.019831575453281403, -0.02794894576072693, 0.02874668687582016, -0.003302929922938347, 0.0041881431825459, 0.03932726010680199, -0.01605279929935932, 0.0021308097057044506, -0.007837461307644844, 0.0004850303812418133, -0.012728876434266567, 0.0136735700070858, 0.022112837061285973, -0.006095025688409805, 0.014541289769113064, 0.010909466072916985, 0.036164283752441406, -0.023442406207323074, 0.03862748667597771, 0.02041938528418541, 0.004635998047888279, -0.043078046292066574, -0.034316882491111755, -0.01353361550718546, 0.007081706076860428, 0.023862270638346672, -0.009663869626820087, 0.003185718087479472, -0.01665460504591465, 0.005640172865241766, -0.013876504264771938, -0.018823901191353798, 0.008950100280344486, -0.007515565492212772, 0.00100242521148175, 0.015744898468255997, 0.027025245130062103, 0.011399307288229465, -0.03174171596765518, -0.006738816853612661, -0.014485307037830353, 0.00015515286941081285, 0.01830606907606125, 0.012581923976540565, 0.03899136930704117, -0.005405748728662729, -0.009649873711168766, 0.02743111364543438, -0.0136735700070858, 0.008131366223096848, 0.006913760211318731, 0.007683510892093182, -0.018278079107403755, -0.03857150301337242, 0.030622079968452454, 0.016094785183668137, 0.006269969046115875, 0.005339270457625389, -0.001037413952872157, 0.007753488142043352, -0.004968390334397554, 0.02883066050708294, 0.01708846352994442, -0.034148938953876495, 0.0740080252289772, -0.0062489756383001804, -0.02068529836833477, -0.0025594208855181932, -0.012497951276600361, 0.01962164416909218, -0.02646542713046074, -0.011448291130363941, -0.00792843196541071, 0.016360700130462646, -0.0066653406247496605, 0.02061532251536846, -0.017816228792071342, -0.02244872786104679, 0.021846922114491463, -0.016346704214811325, -0.02681531384587288, -0.0007089578430168331, -0.030873998999595642, 0.027892963960766792, 0.03006226196885109, 0.005507215857505798, -0.00876815989613533, -0.014527293853461742, 0.00039493455551564693, 0.005437238607555628, 0.005384755786508322, 0.012861832976341248, 0.03140582516789436, 0.05284687876701355, 0.011112400330603123, -0.020307421684265137, -0.03795570507645607, 0.010720526799559593, -0.031153907999396324, 0.029082579538226128, -0.027235176414251328, -0.002632897114381194, -0.012938808649778366, -0.025569716468453407, 0.023946242406964302, 0.006266470067203045, -0.003021271200850606, 0.02638145349919796, -0.009104050695896149, 0.003992206882685423, 0.001614726847037673, 0.02577964775264263, 0.005248299799859524, -0.01064355205744505, 0.014275375753641129, 0.009090055711567402, 0.020629316568374634, -0.023008545860648155, -0.013239710591733456, 0.012567928992211819, 0.004688481334596872, 0.05206313356757164, 0.00694525009021163, 0.0007089578430168331, -0.01866995170712471, -0.002328495727851987, -0.0302302073687315, 0.006980238948017359, -0.007095701526850462, -0.049320023506879807, -0.027011249214410782, -0.017158441245555878, -0.01525505818426609, 0.00341839250177145, -0.020993199199438095, -0.013981470838189125, -0.012980794534087181, -0.00582911167293787, 0.011364318430423737, 0.011049420572817326, -0.002431712346151471, 0.020741280168294907, 0.02551373466849327, 0.046576909720897675, -0.03582839295268059, -0.006955746561288834, -0.03140582516789436, 0.04050287976861, 0.0273471400141716, -0.025835629552602768, 0.028802668675780296, -0.019915549084544182, -0.009929783642292023, 0.03445683792233467, -0.023876264691352844, 0.005626177415251732, 0.05209112539887428, 0.04041890799999237, -0.028256846591830254, -0.003003777004778385, -0.0070782070979475975, 0.018697943538427353, 0.02418416552245617, 0.0022777621634304523, -0.0024929423816502094, 0.01883789710700512, -0.01340765692293644, 0.0030667565297335386, -0.00906906183809042, 0.004373583011329174, -0.04951595887541771, -0.030706053599715233, 0.0058501046150922775, 0.006546379067003727, 0.03322523832321167, 0.0041146669536828995, 0.035184603184461594, 0.01648665964603424, -0.019999520853161812, 0.0018876384710893035, -0.020993199199438095, 0.028116891160607338, -0.00872617308050394, -0.06941751390695572, 0.03092998079955578, 0.026605380699038506, 0.043245989829301834, 0.018474014475941658, 0.005661166273057461, -0.01612277701497078, -0.003115740604698658, -0.020671304315328598, 0.005185320042073727, -0.009188023395836353, -0.031237879768013954, -0.020923221483826637, 0.015744898468255997, 0.01568891666829586, 0.01511510368436575, 0.01797017827630043, -0.010188699699938297, -0.00217979378066957, -0.024757979437708855, -0.03479272872209549, 0.020881235599517822, 0.02769702672958374, -0.007242653518915176, 0.03479272872209549, 0.007207665126770735, -0.036696113646030426, 0.008250326849520206, -0.012448967434465885, 0.005318277049809694, -0.014527293853461742, -0.0076695154421031475, 0.005472227465361357, -0.02068529836833477, 0.019089816138148308, 0.010986440815031528, 0.007022225297987461, -0.0063889301382005215, -0.041734479367733, -0.004789948463439941, 0.0018596475711092353, 0.019145797938108444, -0.0025191837921738625, -0.011532263830304146, 0.012399982661008835, 0.028886642307043076, -0.043245989829301834, -0.046324994415044785, 0.009027075953781605, -0.0023319944739341736, 0.001661961548961699, -0.011595243588089943, 0.03328121826052666, -0.012434971518814564, 0.006906762719154358, -0.01161623653024435, -0.01683654636144638, -0.044925447553396225, -0.013393661007285118, -0.004272115882486105, 0.025877617299556732, -0.02874668687582016, 0.0027151203248649836, 0.025653690099716187, 0.0023249967489391565, -0.0059865606017410755, 0.01692051813006401, -0.009397955611348152, 0.0031402327585965395, -0.01165122538805008, -0.03568843752145767, 0.009579896926879883, -0.01511510368436575, 0.032749392092227936, 0.0031612259335815907, 0.002328495727851987, 0.03442884609103203, 0.017942188307642937, -0.013225715607404709, 0.03260943666100502, 0.04223831743001938, 0.02604556269943714, -0.02639544941484928, 0.009915787726640701, -0.03076203539967537, 0.0010155460331588984, 0.021161144599318504, 0.00778147904202342, 0.014919166453182697, 0.005713649094104767, -0.01875392533838749, 0.012281021103262901, -0.01797017827630043, 0.021804936230182648, 0.017074469476938248, 0.005342768970876932, -0.0048949141055345535, 0.011455289088189602, 0.020755276083946228, -0.03165774419903755, -0.017466342076659203, 0.011910141445696354, -0.0025471749249845743, 0.003094747429713607, -0.003687805263325572, -0.010755515657365322, 0.018949860706925392, 0.020713290199637413, 0.0012735874624922872, -0.012036100961267948, 0.040362924337387085, -0.008670191280543804, -0.004583515226840973, 0.021007195115089417, -0.010349647141993046, -0.005010376684367657, -0.018012164160609245, -0.007732495199888945, 0.0057486374862492085, 0.020727286115288734, -0.010867479257285595, 0.003479622770100832, 0.023610351607203484, 0.018627965822815895, 0.03420491889119148, -0.0304261427372694, 0.07036920636892319, 0.04209836199879646, 0.03202162683010101, -0.029838332906365395, 0.03154578059911728, -0.020993199199438095, 0.011945130303502083, 0.0012683391105383635, -0.04590512812137604, -0.009341973811388016, -0.044561564922332764, -0.018823901191353798, 0.004219633061438799, 0.007179674226790667, 0.008019401691854, 0.008859129622578621, -0.028452781960368156, -0.002914555836468935, -0.007221660576760769, -0.01813812367618084, 0.01710245944559574, -0.0073056332767009735, 0.03129386156797409, -0.02813088707625866, -0.0152130713686347, -0.01126634981483221, 0.01332368329167366, 0.015241062268614769, -0.011371316388249397, -0.01152526680380106, 0.02340041846036911, 0.022042859345674515, -0.009020077995955944, 0.013995465822517872, -0.015157089568674564, 0.006973240990191698, -0.012546935118734837, -0.007879447191953659, 0.0021518028806895018, 0.0152130713686347, 0.002256768988445401, -0.030034270137548447, -0.009544908069074154, 0.02051735296845436, 0.017200427129864693, -0.010146712884306908, 0.04327398166060448, 0.01511510368436575, -0.022406741976737976, -0.03171372786164284, -0.0017651781672611833, -0.002249771263450384, -0.017942188307642937, -0.006053038872778416, 0.027109218761324883, -0.010104726999998093, -0.03302929922938347, 0.008985089138150215, 0.023106515407562256, -0.0015263805398717523, 0.051223404705524445, -0.004649993497878313, 0.030706053599715233, -0.0008939604158513248, 0.011469284072518349, -0.009537910111248493, -0.003680807538330555, 0.0009560652542859316, 0.026843303814530373, 0.013470635749399662, 0.03451281785964966, -0.014100432395935059, 0.019691620022058487, -0.00872617308050394, 0.038431551307439804, -0.025989580899477005, 0.0014896424254402518, -0.007417596876621246, 0.02305053360760212, 0.0017433102475479245, -0.009216014295816422, -0.057717300951480865, 0.015143094584345818, 0.03258144482970238, 0.003855750896036625, 0.041342608630657196, -0.0019173788605257869, 0.012742872349917889, -0.009915787726640701, -0.007725497242063284, 0.0018229094566777349, 0.013120749033987522, 0.02306452766060829, 0.024226151406764984, -0.030118243768811226, -0.033001307398080826, 0.00903407298028469, 0.015129098668694496, -0.012288019061088562, -0.00035272949025966227, 0.015227067284286022, -0.006924256682395935, 0.010286667384207249, 0.004786449484527111, 0.010909466072916985, 0.04137059673666954, 0.010349647141993046, 0.04416969045996666, -0.020111484453082085, 0.036864057183265686, 0.02235076017677784, 0.0010933957528322935, -0.011560254730284214, -0.01988755725324154, 0.00012235098984092474, -0.030454134568572044, 0.006137012038379908, 0.015744898468255997, 0.012644903734326363, 0.002988032065331936, 0.028634723275899887, 0.019341733306646347, -0.020657308399677277, -0.017508327960968018, 0.004677984397858381, -0.012826845049858093, 0.01970561593770981, 0.013554609380662441, 0.033952999860048294, -0.023974234238266945, -0.012337003834545612, -0.022392746061086655, 0.0013251956552267075, 0.00820134300738573, -0.02849476970732212, 0.021427059546113014, -0.023428410291671753, -0.018893878906965256, -0.013743547722697258, -0.002162299584597349, 0.029502442106604576, 0.006784302182495594, 0.0003068068472202867, -0.009824817068874836]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"ahi, A. (eds.), Proceedings
of the 2018 EMNLP Workshop BlackboxNLP: Analyz-
ing and Interpreting Neural Networks for NLP , pp. 353–
355, Brussels, Belgium, November 2018. Association for
Computational Linguistics. doi: 10.18653/v1/W18-5446.
URL https://aclanthology.org/W18-5446 .
Yang, G. Scaling limits of wide neural networks with weight
sharing: Gaussian process behavior, gradient indepen-
dence, and neural tangent kernel derivation, 2020.
Zhang, F. F., Li, L., Chen, J.-C., Jiang, Z., Wang, B.,
and Qian, Y . Increlora: Incremental parameter al-
location method for parameter-efficient fine-tuning.
ArXiv , abs/2308.12043, 2023a. URL https:
//api.semanticscholar.org/CorpusID:
261076438 .
Zhang, G., Chiu, H.-M., and Zhang, R. Y . Fast and minimax
optimal estimation of low-rank matrices via non-convex
gradient descent, 2023b.
Zhang, G., Fattahi, S., and Zhang, R. Y . Preconditioned
gradient descent for overparameterized nonconvex burer–
monteiro factorization with global optimality certification,
2023c.
Zhang, Q., Chen, M., Bukharin, A., He, P., Cheng, Y .,
Chen, W., and Zhao, T. Adaptive budget allocation for
parameter-efficient fine-tuning, 2023d.
Zi, B., Qi, X., Wang, L., Wang, J., Wong, K.-F., and Zhang,
L. Delta-lora: Fine-tuning high-rank parameters with the
delta of low-rank matrices, 2023.
11
Riemannian Preconditioned LoRA
A. Details of Theorem 4.1
A.1. Assumptions and Technical Lemmas
Definition A.1. (Stable Feature Learning) Consider any general LoRA layer BAx withB∈Rm×randA∈Rr×nbeing
LoRA parameters. Denote ∆t=BtAtx−Bt−1At−1xfor fine-tuning step t. We say that LoRA model achieves Stable
Feature Learning when x, Ax, BAx ∈Θ(1) for all LoRA layers and ∆t∈Θ(1) for all fine-tuning step t.
Assumption A.2. We assume that the Adam gradient processing step satisfies gt
Ax= Θ( n)for all twhere gt
Ais the
normalized gradient of Aint-th iteration.
Explanation of Assumption A.2. We adopt the same assumption as Assumption 1 in (Hayou et al., 2024) where the authors
provide a proof for Adam with no momentum, i.e., for SignSGD method. This assumption should hold for general Adam
variants as long as the processed gradient preserves the sign( x) direction.
Lemma A.3. For any matrix A∈Rm×n, where mbeing powers of n, such that ATAis invertible and γ[Aij] =cfor all
(i, j), we have γ[(ATA)−1] =−γ[∥a∥2]withabeing any column of A.
Proof. First we note that (ATA)−1=adj(ATA)/det(ATA)anddet(ATA) = Θ(( mn2c)n).Furthermore, by property of
adjugate matrix,
det(adj(ATA)) = ( det(ATA))n−1= Θ(( mn2c)n(n−1)),
from which we deduce
adj(ATA) = Θ(( mn2c)n−1).
Therefore,
(ATA)−1= Θ(( mn2c)−1).
Note that ∥a∥2= Θ( mn2c),we thus conclude γ[(ATA)−1] =−γ[∥a∥2], as desired.
A.2. Statement and Proof of Theorem 4.1
Now, we state the formal version of our Theorem 4.1 below,
Theorem A.4. (Stable Feature Learning (Formal)) Let gAandgBdenote the processed gradient of AandBrespectively.
Consider LoRA parameters AandBtrained with Adam scaled by preconditioner (1). Assume Assumption A.2 is satisfied
with Adam gradient processing and gA, gB∈Θ","[0.013206565752625465, 0.014592601917684078, 0.024530215188860893, -0.005645480006933212, -0.011179815977811813, -0.023431848734617233, -0.01788770593702793, 0.002021846827119589, -0.07040014863014221, 0.049661919474601746, 0.006296001374721527, -0.007995856925845146, -0.07139391452074051, 0.014657980762422085, 0.024844035506248474, -0.008970004506409168, 0.027040770277380943, -0.02632160112261772, -0.009676097892224789, 0.03030972369015217, 0.023327240720391273, -0.037396810948848724, 0.029446719214320183, 0.03104196861386299, 0.02147047594189644, -0.044222380965948105, 0.03135578706860542, 0.03261106461286545, 0.03540928661823273, -0.00037715534563176334, 0.02691001258790493, -0.019862152636051178, -0.008610419929027557, -0.04832818731665611, -0.008460047654807568, 0.01775694638490677, 0.031878821551799774, 0.020659776404500008, -0.0015413109213113785, 0.0265961941331625, -0.007074011955410242, -0.06501291692256927, -0.07092317938804626, 0.047543637454509735, 0.016383986920118332, 0.015586363151669502, 0.013167338445782661, 0.009022307582199574, 0.018606875091791153, 0.04037809371948242, -0.052460141479969025, 0.019496029242873192, -0.028871383517980576, -0.01235010102391243, -0.031172726303339005, 0.036298442631959915, 0.05230323225259781, 0.004854393657296896, 0.03959354758262634, -0.01279467809945345, 0.013193489983677864, -0.042417921125888824, 0.022529616951942444, -0.027956077829003334, -0.01586095429956913, -0.05010649561882019, -0.06072405353188515, -0.0026135272346436977, 0.020228274166584015, 0.02179737202823162, -0.04377780482172966, -0.022006584331393242, 0.056801311671733856, -0.0361676849424839, 0.0011980709386989474, 0.014788738451898098, 0.019613711163401604, 0.06605897843837738, 0.031878821551799774, -0.01646244153380394, 0.002915905090048909, 0.006845185533165932, 0.028792928904294968, -0.02578549273312092, -0.01159170363098383, -0.07411368191242218, -0.0341017059981823, -0.03282027691602707, -0.03420631214976311, 0.012827367521822453, 0.009891849011182785, -0.005544142797589302, -0.009035383351147175, 0.024268699809908867, 0.05491839349269867, 0.023261861875653267, 0.052172474563121796, 0.01766541600227356, 0.041424158960580826, 0.023758742958307266, -0.0026216995902359486, 0.0021624118089675903, 0.05230323225259781, -0.0371614471077919, 0.044431596994400024, -0.05039416253566742, -0.021339718252420425, 0.017953084781765938, -0.0006276387721300125, 0.027668409049510956, -0.0411626435816288, 0.006387532223016024, -0.029368264600634575, 0.007577430922538042, 0.00016426484216935933, -0.11810069531202316, -0.08912470936775208, 0.010611018165946007, -0.02438638173043728, 0.012369714677333832, -0.015782499685883522, -0.01878993585705757, -0.0011220677988603711, -0.006528097204864025, 0.04090112820267677, -0.03621998801827431, 0.05905034765601158, -0.03621998801827431, -0.009558415971696377, 0.0033833652269095182, 0.04798821359872818, 0.04500693082809448, 0.02641313150525093, -0.044013168662786484, -0.023327240720391273, -0.014893345534801483, 0.004504615906625986, 0.0005336563917808235, -0.008616957813501358, -0.01194475032389164, 0.0015233316225931048, -0.01386035606265068, -0.02518400549888611, -0.02118280902504921, -0.04440544545650482, 0.04547765851020813, -0.00644964212551713, 0.025040172040462494, -0.018907617777585983, 0.03922742232680321, -0.004710559733211994, 0.029080597683787346, -0.04770054668188095, -0.003975045867264271, -0.0005017841467633843, -0.008022008463740349, -0.015233316458761692, 0.02641313150525093, 0.05491839349269867, -0.016214001923799515, 0.011042519472539425, 0.04798821359872818, 0.06370534002780914, -0.008270449005067348, 0.06543134152889252, 0.043333228677511215, -0.025131702423095703, -0.013023504987359047, -0.0722830668091774, -0.03839057311415672, 0.03289873152971268, -0.01826690323650837, -0.06951099634170532, -0.032375700771808624, 0.035801563411951065, -0.005880844779312611, -0.01808384247124195, -0.036899931728839874, 0.013768825680017471, -0.035984624177217484, 0.00047154631465673447, 0.0047138286754488945, -0.011781303212046623, 0.053375449031591415, -0.046340662986040115, 0.04024733603000641, -0.010630631819367409, -0.010970602743327618, 0.022869588807225227, 0.013317710720002651, 0.015246392227709293, 0.001608324353583157, 0.05128331854939461, 0.01340270321816206, 0.03023126721382141, -0.05570294335484505, 0.0341540090739727, 0.004435967653989792, 0.009754552505910397, 0.0035206612665206194, -0.007283225189894438, 0.017953084781765938, 0.01987522840499878, -0.04406547173857689, -0.0051910956390202045, -0.000331798626575619, -0.0002843988186214119, -0.0036056539975106716, -0.024334078654646873, -0.06553594768047333, -0.0062306225299835205, 0.01234356313943863, 0.004772670101374388, -0.007662423420697451, -0.04448390007019043, 0.022948043420910835, -0.053767722100019455, 0.03245415538549423, 0.01019259262830019, 0.04205179959535599, -0.010172978974878788, 0.0041973344050347805, -0.023941803723573685, 0.021836599335074425, -0.01997983455657959, -0.013781901448965073, 0.036089230328798294, -0.03336946293711662, 0.05842271074652672, -0.015076406300067902, 0.0351477712392807, -0.015259467996656895, 0.0032313589472323656, -0.018541496247053146, 0.05544142425060272, -0.04560841992497444, 0.008198531344532967, -0.054866090416908264, 0.02500094473361969, -0.02481788396835327, -0.01786155439913273, 0.021091278642416, 0.0030433943029493093, -0.01644936576485634, 0.018515344709157944, 0.029159052297472954, 0.01668473146855831, -0.004056769423186779, 0.021130505949258804, 0.008093925192952156, -0.015520984306931496, -0.015298695303499699, -0.015442529693245888, -0.04385625943541527, -0.03907051309943199, 0.017325446009635925, 0.004223485942929983, -0.019914455711841583, -0.028452958911657333, -0.026047009974718094, -0.027066921815276146, 0.01044757105410099, -0.017103156074881554, -0.004184258636087179, 0.006518290378153324, -0.01425263099372387, -0.003009070409461856, 0.03125118091702461, 0.020450564101338387, 0.007374755572527647, 0.014396464452147484, 0.019613711163401604, -0.024765580892562866, -0.010611018165946007, -0.023523379117250443, 0.0005761528154835105, 0.06375764310359955, 0.029655933380126953, -0.06297308951616287, 0.004050231538712978, -0.019862152636051178, 0.0351739227771759, 0.10057911276817322, -0.012879670597612858, 0.01460567768663168, -0.03752756863832474, -0.03873054310679436, -0.004874007310718298, -0.027276135981082916, -0.01916913501918316, 0.009323051199316978, -0.022228874266147614, 0.06365303695201874, -0.0027312093880027533, -0.005416653584688902, 0.01695932261645794, -0.0024876724928617477, -0.038992058485746384, 0.009663022123277187, -0.01667165569961071, 0.04283634573221207, 0.019809849560260773, -0.01818844862282276, 0.010630631819367409, -0.02581164427101612, 0.021967357024550438, 0.01365114375948906, 0.015808651223778725, 0.004154838155955076, 0.016344759613275528, -0.014474919065833092, 0.06511752307415009, -0.01324579305946827, 0.03540928661823273, -0.03436322510242462, -0.004462119657546282, 0.0371875986456871, -0.0411364920437336, 0.017011625692248344, -0.012323949486017227, -0.019836001098155975, -0.046445269137620926, 0.0014996316749602556, 0.01280775386840105, 0.018829163163900375, 0.012284721247851849, -0.022163495421409607, 0.027668409049510956, 0.004220217000693083, -0.01384728029370308, 0.01546868123114109, 0.011375952512025833, 0.020058289170265198, 0.008780404925346375, -0.049949586391448975, 0.011421718634665012, -0.05013264715671539, 0.045425355434417725, 0.03457243740558624, 0.015102557837963104, -0.0642283707857132, -0.028897535055875778, -0.037710629403591156, 0.001212781178764999, -0.007060936186462641, 0.007172080688178539, 0.01074177585542202, -0.008414282463490963, 0.038521330803632736, 0.028400655835866928, -0.017848478630185127, -0.02761610597372055, 0.04359474405646324, -0.027171529829502106, -0.012716223485767841, 0.01410879660397768, 0.019247589632868767, -0.0471775159239769, -0.023915652185678482, -0.013180414214730263, -0.0047138286754488945, 0.017848478630185127, 0.01646244153380394, -0.016998549923300743, -0.018345357850193977, 0.00827698688954115, 0.011702848598361015, 0.016436289995908737, 0.007387831341475248, 0.010271047241985798, 0.004520960617810488, 0.03896590694785118, -0.05554603412747383, -0.024543290957808495, -0.04158106818795204, 0.02772071212530136, 0.023039573803544044, 0.012467782944440842, 0.03203573077917099, 0.031800366938114166, -0.005325122736394405, -0.0007718813139945269, 0.028583716601133347, -0.007322452496737242, 0.010441032238304615, 0.03554004803299904, -0.002271921606734395, -0.046837545931339264, -0.04487617313861847, 0.004295403137803078, 0.00983954593539238, -0.021457400172948837, -0.02069900371134281, 0.04179028421640396, -0.006148898508399725, 0.007381293457001448, -0.03744911402463913, 0.012650844641029835, 0.05264320224523544, 0.061822421848773956, -0.037318356335163116, -0.027773017063736916, -0.058998044580221176, -0.027249984443187714, 0.013808052986860275, 0.02902829460799694, 0.005527797620743513, 0.0802854597568512, 0.02069900371134281, 0.02067285217344761, 0.0054820324294269085, -0.032794125378131866, 0.02209811471402645, -0.0391228161752224, 0.03190497308969498, 0.006018140818923712, -0.015011027455329895, 0.040299639105796814, 0.023013422265648842, 0.03540928661823273, -0.00888501200824976, 0.028740625828504562, -0.009721863083541393, -0.00610313331708312, -0.03083275444805622, 0.0008867032593116164, 0.013768825680017471, -0.017953084781765938, -0.004942655563354492, -0.04971422255039215, -0.022934967651963234, -0.0025040172040462494, -0.0030646424274891615, -0.04210410267114639, -0.04589608684182167, -0.01856764778494835, 0.02370643988251686, 0.026373904198408127, 0.009499574080109596, -0.07285840064287186, 0.021941205486655235, -0.006161974743008614, -0.04275789111852646, 0.007583968807011843, 0.0148018142208457, 0.0441700778901577, -0.035095468163490295, 0.014422615990042686, -0.025641659274697304, -0.021444324404001236, -0.010506412014365196, 0.000695469556376338, 0.061194781213998795, 0.0013222910929471254, -0.01220626663416624, -0.04505923390388489, 0.060096412897109985, -0.0021280876826494932, 0.039724305272102356, -0.0020578051917254925, 0.041188795119524, -0.027354590594768524, -0.02923750691115856, -0.03522622585296631, -0.003342503448948264, 0.021653538569808006, 0.02991744875907898, -0.006080250721424818, 0.01194475032389164, -0.017312370240688324, -0.01756080985069275, -0.02098667249083519, 0.028662171214818954, -0.022817285731434822, -0.017652340233325958, 0.020764382556080818, -0.0006084336782805622, -0.03164345398545265, 0.016789337620139122, -0.025327840819954872, 0.023458000272512436, 0.002345473039895296, -0.009918000549077988, -0.026073161512613297, 0.037318356335163116, 0.08394668996334076, 0.06177011877298355, 0.02962978184223175, 0.011983977630734444, -0.004161376040428877, -0.008754253387451172, -0.02409871481359005, 0.025484750047326088, -0.014788738451898098, -0.0038312117103487253, -0.025772416964173317, -0.029499022290110588, -0.006322153378278017, 0.021444324404001236, 0.006194664165377617, 0.04095343127846718, -0.008793480694293976, -0.012683534063398838, 0.0361415334045887, -0.011879371479153633, -0.014148023910820484, 0.018449965864419937, 0.005102834198623896, 0.0065019456669688225, 0.015690969303250313, -0.00575008662417531, 0.04469311237335205, -0.031094271689653397, -0.0049361176788806915, -0.013703446835279465, 0.029760539531707764, -0.01706392876803875, -0.005279357545077801, -0.015167937614023685, 0.01400419045239687, 0.0039031286723911762, 0.0010746680200099945, -0.047255970537662506, -0.02381104603409767, 0.02381104603409767, 0.005197633523494005, 0.007597044575959444, -0.10994139313697815, -0.01818844862282276, 0.004589608404785395, 0.025170929729938507, -0.03135578706860542, -0.016122471541166306, 0.014291858300566673, -0.03998582065105438, -0.03140809014439583, 0.008270449005067348, -0.03896590694785118, -0.0562259741127491, 0.02089514210820198, 0.004661525599658489, 0.010454108938574791, 0.023026498034596443, 0.022124266251921654, -0.006158705800771713, -0.04631451144814491, 0.023026498034596443, -0.022058887407183647, 0.006335229147225618, 0.04032579064369202, 0.05259089916944504, -0.03676917031407356, 0.01386035606265068, -0.018044615164399147, -0.044353142380714417, -0.014174175448715687, -0.0006415318348444998, 0.026543891057372093, 0.010611018165946007, 0.03104196861386299, 0.0010190957691520452, 5.884113488718867e-05, -0.006753654684871435, -0.026164691895246506, -0.022830361500382423, 0.03765832632780075, -0.014592601917684078, -0.042025648057460785, 0.0030237806495279074, 0.008015470579266548, -0.027668409049510956, 0.02361490949988365, 0.020241349935531616, -0.0029322500340640545, 0.02400718443095684, -0.005439536180347204, 0.068255715072155, -0.0002259663015138358, 0.0033474068623036146, 0.017953084781765938, -0.03540928661823273, -0.03585386648774147, -0.0411626435816288, -0.033578675240278244, -0.03684762865304947, -0.016619352623820305, -0.016436289995908737, 0.009643408469855785, -0.03305564448237419, 0.011480559594929218, 0.03475549817085266, -0.025746265426278114, -0.0009757821680977941, -0.0165539737790823, -0.00027071009390056133, -0.03878284618258476, -0.03104196861386299, -0.0016263036523014307, 0.003997928462922573, -0.002937153447419405, 0.014657980762422085, -0.008649647235870361, 0.011918598785996437, -0.022843437269330025, 0.0036579573061317205, 0.0037592947483062744, -0.033970948308706284, 0.0361415334045887, 0.024425609037280083, -0.010715624317526817, -0.015141786076128483, 0.0002533437800593674, -0.01140210498124361, -0.012840443290770054, -0.006050830241292715, -0.019116831943392754, -0.010002993047237396, -0.015194089151918888, 0.08174995332956314, -0.0025955478195101023, 0.0160701684653759, -0.004383664578199387, 0.005174750927835703, -0.010133751668035984, 0.009270748123526573, 0.025236308574676514, -0.007492437958717346, -0.020032137632369995, -0.005122447852045298, -0.037710629403591156, -0.02048979140818119, -0.016214001923799515, 0.020594397559762, -0.020228274166584015, -0.0072701494209468365, -0.019914455711841583, -0.017691567540168762, -0.03632459416985512, 0.009715325199067593, -0.033578675240278244, 0.03140809014439583, 0.0018126339418813586, 0.009623794816434383, -0.04458850622177124, 0.016514744609594345, -0.0072505357675254345, -0.009564953856170177, -0.008061235770583153, -0.043019410222768784, -0.01677626185119152, -0.021261263638734818, -0.023026498034596443, 0.0215750839561224, 0.020515942946076393, 0.009368816390633583, -0.022150419652462006, 0.010859458707273006, -0.028975989669561386, 0.023026498034596443, 0.005841617006808519, -0.035592351108789444, -0.02772071212530136, 0.006083519663661718, 0.03467704355716705, 0.006139091681689024, -0.010715624317526817, 0.005567025393247604, 0.03193112462759018, -0.005903727374970913, -0.018933769315481186, 0.020842837169766426, 0.011075209826231003, 0.009159603156149387, -0.019404498860239983, -0.016200926154851913, -0.0693017840385437, -0.015586363151669502, -0.009198831394314766, -0.02600778266787529, 0.014187252148985863, -0.01979677379131317, 0.021248187869787216, -0.030963514000177383, -0.026334676891565323, -0.022372707724571228, -0.004370588809251785, 0.02441253326833248, 0.0037952533457428217, -0.0057337419129908085, -0.04589608684182167, -0.019326044246554375, -0.013389627449214458, 0.015390225686132908, 0.001659810426644981, 0.007943552918732166, 0.02039826102554798, -0.032192640006542206, 0.04296710342168808, 0.006175050511956215, -0.07688575237989426, 0.006590207107365131, 0.028060683980584145, -0.010584866628050804, 0.00021697669581044465, -0.05175404995679855, -0.026452358812093735, -0.02038518525660038, 0.030963514000177383, 0.05852731689810753, -0.02279113419353962, -0.008852321654558182, -0.008695412427186966, -0.011003292165696621, 0.015194089151918888, -0.03948894143104553, -0.013036580756306648, 0.03708299249410629, 0.03692608326673508, -0.009022307582199574, 0.008675798773765564, -0.03504316508769989, -0.013768825680017471, -0.04385625943541527, 0.0014563180739060044, 0.008420820347964764, -0.006505214609205723, -0.04756978899240494, 0.022372707724571228, -0.01446184329688549, 0.011768227443099022, 0.01787463016808033, 0.021339718252420425, 0.02962978184223175, 0.015298695303499699, -0.0036677641328424215, 0.021915053948760033, -0.005691245663911104, -0.011094823479652405, -0.0046647945418953896, -0.017730794847011566, -0.010068371891975403, -0.013023504987359047, -0.0351739227771759, 0.0038835150189697742, 0.03653380647301674, 0.027956077829003334, 0.006567324511706829, 0.002915905090048909, 0.0271192267537117, 0.020123668015003204, -0.03506931662559509, 0.011127512902021408, 0.004020811058580875, -0.017613112926483154, 0.01280775386840105, -0.009833008050918579, 0.021117430180311203, -0.010924837552011013, -0.014121872372925282, -0.013611916452646255, -0.0003187228285241872, 0.027145378291606903, 0.004622298292815685, 0.035095468163490295, 0.002602085703983903, -0.005289164371788502, 0.014501071535050869, -0.00943419523537159, 0.03344791755080223, 0.013128111138939857, -0.005485301371663809, -0.0041973344050347805, 0.03352637216448784, 0.0401688814163208, 0.02541937120258808, 0.02348415181040764, 0.01616169884800911, -0.03697838634252548, 0.04197334498167038, -0.00908114854246378, -0.03655995801091194, 0.01796616055071354, 0.005759893450886011, 0.012428555637598038, -0.012382790446281433, -0.008120076730847359, -0.026177767664194107, -0.004550381097942591, 0.012055895291268826, -0.028348350897431374, -0.030885059386491776, 0.021091278642416, 0.0311204232275486, 0.008754253387451172, 0.041005734354257584, 0.07421828806400299, -0.034807801246643066, -0.09885311126708984, -0.023353392258286476, -0.02079053409397602, -0.0017488893354311585, 0.01688086800277233, 0.001578086637891829, 0.019404498860239983, 0.0165539737790823, 0.036193836480379105, -0.014631829224526882, -0.0031904971692711115, -0.013441930525004864, -0.010983678512275219, -0.004128686152398586, 0.01816229708492756, -0.024046411737799644, -0.0245825182646513, -0.008152766153216362, 0.04581763222813606, 0.006469256244599819, -0.028871383517980576, -0.03572310879826546, -0.0075251273810863495, 0.006622896529734135, -0.02077745832502842, -0.020032137632369995, 0.023471076041460037, -0.02230732887983322, 0.030100509524345398, 0.02250346541404724, 0.009421119466423988, -0.029472870752215385, 0.023667212575674057, 0.05470918118953705, -0.045137688517570496, -0.02942056767642498, 0.005168213043361902, 0.006622896529734135, -0.005514721851795912, 0.04278404265642166, -0.001431801007129252, -0.06271157413721085, 0.031381938606500626, 0.030963514000177383, 0.038416724652051926, -0.014553374610841274, 0.043934714049100876, -0.0331340990960598, 0.0014301665360108018, -0.006773268338292837, 0.03245415538549423, 0.005642211064696312, 0.012376252561807632, -0.0007645261357538402, -0.029080597683787346, -0.04592223837971687, -0.01637091115117073, -0.002186928875744343, 0.018894542008638382, 0.017613112926483154, 0.012755450792610645, 0.03878284618258476, -0.0062796566635370255, -0.015534060075879097, -0.03132963553071022, -0.034310922026634216, 0.03132963553071022, 0.022843437269330025, -0.004435967653989792, -0.04288864880800247, -0.017600037157535553, 0.008538502268493176, -0.011134050786495209, 0.017730794847011566, -0.009872235357761383, -0.022843437269330025, -0.016214001923799515, 0.0148018142208457, -0.04487617313861847, 0.018332282081246376, 0.02629544958472252, -0.026831557974219322, -0.010879072360694408, 0.02388950064778328, 0.0016737034311518073, 0.025523977354168892, 0.025863947346806526, -0.026936164125800133, -0.015638666227459908, 0.011323649436235428, 0.06788959354162216, 0.015887105837464333, 0.02871447429060936, -0.010172978974878788, 0.006858261302113533, -0.015377149917185307, -0.001204608823172748, 0.021208960562944412, 0.0296036284416914, 0.009309975430369377, 0.007845484651625156, 0.03263721615076065, 0.0031594422180205584, -0.00587430689483881, 0.0021934667602181435, -0.0072243837639689445, 0.0009275651536881924, -0.026452358812093735, 0.023013422265648842, -0.0482235811650753, 0.037292204797267914, -0.0022686526644974947, -0.031669605523347855, -0.0012103294720873237, -0.005808927584439516, 0.010120674967765808, 0.004553650040179491, 0.05151868239045143, 0.03959354758262634, 0.007165542803704739, 0.021810447797179222, -0.018711481243371964, -0.004377126693725586, -0.001328828977420926, -0.02540629543364048, -0.04084882512688637, 0.00934266485273838, 0.006498676724731922, -0.03104196861386299, -0.007204770110547543, 0.009054997004568577, 0.005756624508649111, -0.009636870585381985, 0.014788738451898098, -0.006812496110796928, 0.017743870615959167, 0.025981631129980087, 0.004877276252955198, -0.03833827003836632, 0.010349501855671406, 0.01817537285387516, 0.0025595894549041986, 0.02602085843682289, -0.005455880891531706, -0.006518290378153324, 0.019901379942893982, -0.041816435754299164, -0.031094271689653397, -0.00020012115419376642, 0.028139138594269753, 0.03893975540995598, 0.007348604034632444, -0.007557816803455353, 0.009309975430369377, 0.012428555637598038, 0.04338553175330162, 0.02732843905687332, -0.01707700453698635, -0.004998227581381798, 0.04335938021540642, -0.0002976789546664804, 0.03344791755080223, 0.02069900371134281, -0.014657980762422085, 0.016710883006453514, -0.028269896283745766, -0.005070144776254892, -0.017717719078063965, -0.022921891883015633, 0.025040172040462494, -0.022411935031414032, -0.07667654007673264, 0.022725753486156464, 0.02490941435098648, 0.006665393244475126, -0.004991689696907997, 0.002832546830177307, -0.004759594332426786, 0.008793480694293976, 0.025327840819954872, 0.025445522740483284, 0.00828352477401495, -0.01314772479236126, 0.0004092319286428392, -0.0030466632451862097, -0.014880269765853882, -0.027485348284244537, 0.008198531344532967, -0.002062708605080843, 0.015154861845076084, 0.011800916865468025, 0.00908114854246378, 0.012088584713637829, 0.015599438920617104, 0.04205179959535599, -0.016410138458013535, 0.004874007310718298, 0.04079652205109596, 0.013638067990541458, -0.030675845220685005, -0.03261106461286545, 0.05144022777676582, -0.02037210948765278, -0.00016855534340720624, -0.050054192543029785, 0.03674301877617836, 0.0013656046940013766, -0.029159052297472954, 0.01805769093334675, 0.004556918982416391, 0.011820530518889427, 0.02300034649670124, -0.027040770277380943, 0.009983379393815994, 0.03556619957089424, -0.0195875596255064, 0.02629544958472252, 0.005812196526676416, -0.028792928904294968, -0.017547734081745148, -0.031460393220186234, -0.0256024319678545, 0.0033899033442139626, -0.01546868123114109, -0.0011882639955729246, 0.028688322752714157, 0.034807801246643066, -0.002821105532348156, -0.014553374610841274, 0.012945050373673439, 0.0027655332814902067, 0.02259499579668045, -0.01906452886760235, -0.00045724466326646507, -0.02481788396835327, -0.03564465418457985, -0.014841042459011078, -0.0028586986009031534, -0.022778058424592018, 0.029159052297472954, 0.018698405474424362, 0.007322452496737242, -0.014906421303749084, -0.00828352477401495, -0.018436890095472336, 0.0010092889424413443, 0.021548932418227196, 0.0501849502325058, -0.021339718252420425, 0.011035981588065624, -0.028583716601133347, 0.006021409761160612, 0.030257420614361763, -0.006469256244599819, 0.004609222523868084, -0.003703722730278969, 0.03363097831606865, 0.04247022420167923, 0.02398103103041649, 0.013415778987109661, -0.02962978184223175, 0.009506111964583397, 0.03695223480463028, -0.012245493941009045, 0.020908217877149582, -0.043228622525930405, 0.010669859126210213, 0.007557816803455353, -0.00043926542275585234, 0.03433707356452942, -0.005465687718242407, 0.012886208482086658, 0.01114712655544281, 0.012925435788929462, 0.016331683844327927, 0.017325446009635925, 0.054970696568489075, 0.003684108844026923, 0.03344791755080223, 0.0032754899002611637, -0.018018463626503944, -0.03143424168229103, -0.004789014812558889, -0.01625322923064232, 0.025667810812592506, -0.04367319867014885, 0.01039526704698801, -0.013069270178675652, 0.020005986094474792, 0.022764982655644417, -0.003094063140451908, 0.042522527277469635, -0.007132853381335735, -0.023837197571992874, 0.05089104548096657, -0.009983379393815994, -0.03867824003100395, 0.033970948308706284, -0.0032003039959818125, -0.011833606287837029, 0.024752505123615265, -0.010055296123027802, -0.0075447410345077515, -0.01877686008810997, 0.020542094483971596, 0.019809849560260773, -0.02309187687933445, -0.03773678094148636, -0.019705243408679962, -0.02620391920208931, -0.0057631623931229115, 0.008558115921914577, 0.0004086190019734204, 0.028479110449552536, 0.013278483413159847, 0.008610419929027557, -0.011003292165696621, -0.012761988677084446, 0.011559014208614826, -0.021052051335573196, 0.023274937644600868, 0.025458598509430885, 0.008152766153216362, 0.011905523017048836, -0.024726353585720062, -0.030963514000177383, -0.05449996888637543, -0.024046411737799644, -0.03655995801091194, 0.0351477712392807, 0.012788140214979649, 0.0072897630743682384, -0.0032624141313135624, 0.0014947282616049051, -0.005952761508524418, 0.006675200071185827, 0.00823122076690197, -0.0033245242666453123, -0.014318009838461876, 0.006142360623925924, 0.014841042459011078, 0.02048979140818119, 0.005066875834017992, 0.011467483825981617, -0.0255893561989069, 0.015442529693245888, -0.004344437271356583, 0.011990515515208244, -0.004027348943054676, -0.019613711163401604, 0.0662681981921196, -0.003661226248368621, 0.005913534201681614, 0.0016998550854623318, -0.011670158244669437, 0.04539920389652252, -0.028766777366399765, -0.04043039679527283, -0.012219342403113842, 0.020058289170265198, 0.0003338417154736817, 0.043045561760663986, -0.03305564448237419, -0.007446672767400742, 0.029682084918022156, 0.010584866628050804, -0.048642005771398544, 0.004789014812558889, 0.0025661273393779993, 0.03922742232680321, 0.022621147334575653, 0.003641612594947219, -0.030571239069104195, -0.039515092968940735, 0.0107875419780612, 0.011859757825732231, -0.0010190957691520452, 0.02037210948765278, 0.017534658312797546, 0.030649693682789803, -0.02099974825978279, -0.005413384642452002, -0.03143424168229103, 0.020411336794495583, -0.02680540643632412, 0.009427657350897789, -0.008760791271924973, 0.008780404925346375, 0.007165542803704739, 0.007937015034258366, 0.008571191690862179, 0.00644964212551713, -0.01219972874969244, -0.0006419404526241124, -0.029185203835368156, -0.005792582873255014, -0.005586639046669006, 0.014671056531369686, -0.014187252148985863, 0.01366421952843666, 0.032977186143398285, -0.0020005987025797367, 0.028975989669561386, -0.009486498311161995, 0.010218744166195393, 0.008401206694543362, 0.009257672354578972, 0.04294095188379288, 0.002945325803011656, -0.012755450792610645, -0.016920095309615135, -0.014684132300317287, -0.022542692720890045, 0.022712677717208862, -0.017926933243870735, -0.020058289170265198, 0.00027745228726416826, 0.00454057427123189, -0.01637091115117073, -0.0007322452729567885, -0.028034532442688942, -0.0007559451623819768, -0.001992426346987486, -0.01575634814798832, 2.1350342649384402e-05, -0.0019286817405372858, -0.02029365487396717, 0.010362577624619007, 0.022228874266147614, 0.0341278575360775, -0.027276135981082916, 0.007217845879495144, -0.014291858300566673, 0.005478763487190008, 0.003038490889593959, -0.005151868332177401, 0.020202122628688812, -0.006668662186712027, -0.019299892708659172, 0.012637768872082233, -0.020934369415044785, 0.027982229366898537, 0.01927374117076397, -0.0012160501210018992, -0.02400718443095684, -0.010212206281721592, -0.013455006293952465, 0.001515976502560079, 0.006345035973936319, 0.02307880111038685, -0.009728400968015194, 0.009748014621436596, -0.0010117406491190195, -0.006864799186587334, -0.026988467201590538, 0.01200359221547842, -0.02629544958472252, -0.012775064446032047, 0.008754253387451172, 0.0017456203931942582, 0.02228117734193802, -0.014893345534801483, 0.03627229109406471, 0.020254425704479218, -0.01919528655707836, 0.0044588507153093815, 0.001576452050358057, 0.05002804100513458, 0.012493934482336044, -0.013624992221593857, 0.02913290075957775, -0.0019531988073140383, 0.016737034544348717, -0.005720666144043207, -0.013023504987359047, 0.012820829637348652, -0.013095421716570854, 0.028139138594269753, -0.01727314293384552, 0.0013198393862694502, -0.03904436156153679, 0.004952462390065193, 0.009466884657740593, -0.001607507118023932, 0.011290960013866425, 0.010002993047237396, 0.015194089151918888, -0.0007694295491091907, -0.03603692725300789, -0.01230433490127325, 0.015024103224277496, 0.00044376024743542075, 0.006495407782495022, 0.013585764914751053, 0.007642809767276049, -0.02147047594189644, 0.033081796020269394, -0.025877024978399277, 0.00010716033284552395, -0.007407445460557938, -0.012010130099952221, 0.016750110313296318, -0.020332882180809975, 0.0155602116137743, -0.002812933176755905, -0.008924239315092564, 0.02501402050256729, -0.013016967102885246, 0.004599415697157383, -0.02370643988251686, 0.030885059386491776, -0.005233592353761196, 0.013062732294201851, 0.027249984443187714, 0.043333228677511215, -0.02370643988251686, -0.003247703891247511, -0.002105205086991191, 0.0019221437396481633, -0.0401427298784256, 0.009715325199067593, 0.03465089201927185, 0.010526025667786598, 0.010081447660923004, -0.023052649572491646, -0.03627229109406471, -0.0007375573040917516, -0.01898607239127159, -0.01617477461695671, 0.0421564057469368, -0.0195614080876112, -0.01575634814798832, 0.008858859539031982, -0.010172978974878788, -0.015586363151669502, -0.006325422320514917, 0.021666614338755608, -0.006518290378153324, -0.010591404512524605, -0.013808052986860275, 0.01290582213550806, -0.010101061314344406, 0.028348350897431374, -0.015364074148237705, 0.019652940332889557, 0.022111190482974052, 0.004373857751488686, 0.0016361104790121317, 0.0072439974173903465, 0.002830912359058857, 0.038913603872060776, -0.015050254762172699, -0.0008205069461837411, 0.000997030409052968, 0.002688713138923049, -0.006044292356818914, 0.00847966130822897, 0.02130049094557762, -0.01019913051277399, 0.010597942396998405, 0.011552476324141026, -0.016619352623820305, 0.010532563552260399, 0.023222634568810463, 0.004808628465980291, 0.003156173275783658, -3.34556789312046e-05, -0.005213978234678507, -0.01219319086521864, -0.019522180780768394, 0.03193112462759018, -0.00802854634821415, 0.02047671563923359, -0.012029743753373623, -0.024844035506248474, 0.005272819660604, 0.0105391014367342, 0.028243744745850563, -0.0017668685177341104, 0.005047261714935303, -0.007773567922413349, -0.017325446009635925, 0.002896291436627507, -0.00968917366117239, -0.01565174199640751, -0.037318356335163116, -0.005485301371663809, -0.009911462664604187, -0.022346556186676025, -0.020450564101338387, -0.003031953005120158, -0.0010346233611926436, 0.010172978974878788, -0.011885909363627434, -0.013808052986860275, 0.028400655835866928, 0.014592601917684078, -0.00014608129276894033, -0.05408154055476189, 0.011820530518889427, -0.015573287382721901, 0.008911163546144962, -0.004092727787792683, -0.03370943292975426, 0.0013729598140344024, -0.03726605325937271, 0.0034487443044781685, -0.012487396597862244, -0.00036510106292553246, 0.025772416964173317, -0.004043693654239178, -0.02339262142777443, 0.006433297414332628, -0.009506111964583397, -0.0016156794736161828, 0.035696957260370255, -0.014671056531369686, 0.02116973325610161, 0.018816087394952774, -0.03101581707596779, -0.016933171078562737, 0.03624613955616951, 0.0049753449857234955, -0.02098667249083519, 0.0009937614668160677, 0.015050254762172699, -0.01365114375948906, 0.030780451372265816, -0.016619352623820305, -0.026740027591586113, 0.015102557837963104, 0.01410879660397768, -0.017142383381724358, -0.017011625692248344, 0.014919497072696686, 0.023732591420412064, -0.018502268940210342, -0.02330108918249607, 0.002946960274130106, 0.029499022290110588, -0.014370312914252281, 0.01948295347392559, -0.002373259048908949, -0.018502268940210342, -0.0020496328361332417, -0.00549510819837451, -0.0062698498368263245, -0.01644936576485634, 0.014553374610841274, 0.03833827003836632, -0.025275537744164467, -0.019522180780768394, -0.015573287382721901, 0.022451162338256836, 0.02790377475321293, 0.03967200219631195, -0.021954281255602837, 0.03472934663295746, 0.013481157831847668, 0.0003904354525730014, 0.005001496523618698, 0.012265107594430447, -0.020202122628688812, 0.006178319454193115, -0.009054997004568577, 0.008466585539281368, -0.020228274166584015, 0.004769401159137487, -0.002137894509360194, 0.03567080572247505, -0.004213679116219282, -0.005073413718491793, -0.012513548135757446, -0.02790377475321293, 0.026543891057372093, 0.00010511723667150363, -0.01888146623969078, 0.020058289170265198, 0.04335938021540642, 0.00730283884331584, 0.019718319177627563, 0.012657382525503635, 0.029655933380126953, -0.018920693546533585, -0.01616169884800911, 0.022934967651963234, 0.0025121895596385, 0.040116578340530396, 0.01099021639674902, -0.030571239069104195, -0.026256222277879715, 0.010251433588564396, -0.007708188612014055, -0.022451162338256836, -0.0027426506858319044, 0.0401688814163208, -0.003968507517129183, 0.011035981588065624, -0.0002770436694845557, 0.017704643309116364, 0.021052051335573196, 0.008649647235870361, -0.013611916452646255, 0.007328990381211042, 0.004739980213344097, 0.03556619957089424, -0.0019139713840559125, -0.026060085743665695, -0.032689519226551056, -0.02860986813902855, -0.00393908703699708, 0.016410138458013535, 0.012049357406795025, 0.007342066150158644, 0.00635157385841012, -0.01210819836705923, 0.007145929150283337, 0.00027071009390056133, -0.003131655976176262, -0.012493934482336044, -0.004775939043611288, 0.02220272272825241, 0.019822925329208374, 0.04649757221341133, -0.03661226108670235, 0.010578328743577003, -0.011460945941507816, -0.002409217646345496, 0.02449098788201809, 0.021431248635053635, 0.0044490438885986805, -0.013690371066331863, -0.03922742232680321, -0.03627229109406471, -0.013873432762920856, 0.020215198397636414, 0.021431248635053635, -0.01909068040549755, 0.012886208482086658]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"(1) after the gradient processing. Further assume BAx has dimension of
Θ(n).Then the LoRA model achieves stable feature learning with η= Θ(1) .While for unscaled Adam, ηA= Θ( n−1)and
ηB= Θ(1) are required for stable feature learning.
Proof. We consider Gaussian initialization with Aij∼ N(0, σ2
a)andBij∼ N(0, σ2
b).Conventionally, we want BAto
be initialized as zero and Axdoes not explode with NN width, thus we proceed with σ2
a= Θ( n−1)andσ2
b= 0.We first
decompose the LoRA increment as
∆t=BtAtx−Bt−1At−1x
= (Bt−1−ηgt−1
B(At−1AT
t−1)−1)(At−1−η(BT
t−1Bt−1)−1gt−1
A)x−Bt−1At−1x
=−ηBt−1(BT
t−1Bt−1)−1gt−1
Ax−ηgt−1
B(At−1AT
t−1)−1At−1x+η2gt−1
B(At−1AT
t−1)−1(BT
t−1Bt−1)−1gt−1
Ax.
We write 

δ1
t=ηBt−1(BT
t−1Bt−1)−1gt−1
Ax,
δ2
t=ηgt−1
B(At−1AT
t−1)−1At−1x,
δ3
t=η2gt−1
B(At−1AT
t−1)−1(BT
t−1Bt−1)−1gt−1
Ax.
Following Assumption A.2, we know gt−1
Ax∈Θ(n),thus having δ1
t, δ2
t, Bt−1At−1x∈Θ(1) equates to


γ[η] +γ[Bt−1] +γ[(BT
t−1Bt−1)−1] + 1 = 0 ,
γ[η] +γ[(At−1AT
t−1)−1] +γ[At−1x] = 0,
γ[Bt−1] +γ[At−1x] = 0.(4)
12
Riemannian Preconditioned LoRA
For gradient update, we have
Bt=Bt−1−ηgt−1
B(At−1AT
t−1)−1
Atx=At−1x−η(BT
t−1Bt−1)−1gt−1
Ax,
and thus
γ[Bt] = max( γ[Bt−1], γ[η] +γ[(At−1AT
t−1)−1])
γ[Atx] = max( γ[At−1x], γ[η] +γ[(BT
t−1Bt−1)−1] + 1) .
Note A1=A0and thus γ[A1x] =γ[A0x] = 0.Furthermore, γ[B1] =γ[η] +γ[(A0AT
0)−1].Since γ[∥a0∥2
2] = 0 for any
rowa0ofA0, γ[(A0AT
0)−1] = 0 by Lemma A.3. Therefore γ[B1] = 0 .Since γ(∥b1∥2
2) = 1 for any column b1ofB1,
γ[(BT
1B1)−1] =−1by Lemma A.3 and thus γ[A2x] = 0 by the above recursion. Since A2=A1−η(BT
1B1)−1g1
A=
A0−Θ(n−1), γ[∥a2∥2] = 0 for any row a2ofA2and again by Lemma A.3 we know γ[(A2AT
2)−1] = 0 .Therefore
γ[B2] = 0 .The recursion persists and we know γ[B","[0.017731351777911186, -0.035647403448820114, 0.027019202709197998, -0.021953102201223373, -0.005824696272611618, -0.012282654643058777, 0.009122938849031925, -0.029209235683083534, -0.03295603767037392, 0.05079293251037598, -0.02581864222884178, -0.011220620945096016, -0.04572683200240135, 0.0034400669392198324, 0.029921654611825943, -0.030739620327949524, 0.022823838517069817, -0.008047711104154587, -0.016741879284381866, 0.03638621047139168, 0.006101748440414667, -0.046096235513687134, 0.04577960446476936, 0.016689106822013855, -0.008733745664358139, -0.0454893596470356, 0.029974427074193954, 0.03126733750104904, 0.017230018973350525, -0.017533456906676292, 0.012764197774231434, -0.019446438178420067, -0.020462296903133392, -0.034301720559597015, 0.010402657091617584, 0.03635982424020767, 0.03804852440953255, 0.027678851038217545, 0.0027639272157102823, 0.03406424820423126, -0.01151086576282978, -0.040027469396591187, -0.05699362978339195, 0.016148194670677185, 0.016966158524155617, 0.012414584867656231, -0.020620612427592278, 0.010013463906943798, 0.033351827412843704, 0.042323045432567596, -0.0526927225291729, 0.014974020421504974, -0.009967288933694363, -0.026900464668869972, -0.0364917553961277, 0.02306131087243557, 0.03923589363694191, 0.014063705690205097, 0.032639406621456146, -0.009465956129133701, 0.037547193467617035, -0.0268081147223711, 0.05147896707057953, -0.04612262174487114, 0.01445949450135231, -0.05446057766675949, -0.04332571104168892, 0.015264266170561314, 0.008186237886548042, 0.014789318665862083, -0.06153200939297676, -0.030739620327949524, 0.06738968938589096, -0.020422717556357384, -0.00878651812672615, 0.013839425519108772, 0.037230562418699265, 0.040528804063797, 0.05319405347108841, 0.023668188601732254, 0.03126733750104904, 0.01873401738703251, 0.07936890423297882, -0.04121483862400055, 0.03395870327949524, -0.06517326831817627, -0.006171011831611395, -0.019565174356102943, -0.06253467500209808, 0.005494872108101845, 0.0004048592527396977, -0.008100483566522598, -0.017045317217707634, 0.03145204111933708, 0.037679120898246765, 0.020198436453938484, 0.020462296903133392, -0.013377671130001545, 0.06005439907312393, 0.013225952163338661, 0.01761261373758316, -0.046782270073890686, 0.08190195262432098, -0.03298242390155792, 0.018668051809072495, -0.051188722252845764, -0.0024901730939745903, -0.005244205705821514, -0.023549450561404228, 0.020739348605275154, -0.020660189911723137, 0.00504631083458662, -0.010805042460560799, -0.028760673478245735, 0.004142592661082745, -0.08797071874141693, -0.08221858739852905, 0.012882934883236885, -0.03345737233757973, -0.03203253075480461, -0.0004044469678774476, -0.009334025904536247, -0.02608250081539154, -0.013575566001236439, 0.03005358576774597, -0.03018551506102085, 0.06116260960698128, -0.0545133501291275, -0.005679573398083448, -0.0281537976115942, 0.06480386853218079, 0.016069037839770317, 0.005781819112598896, -0.015435774810612202, -0.06095151975750923, -0.012572900392115116, 0.020435910671949387, 0.030211901292204857, 0.005729047115892172, -0.01928812265396118, -0.012506935745477676, -0.027045587077736855, -0.048180725425481796, -0.014604617841541767, -0.03868178650736809, 0.05778520926833153, -0.027098359540104866, 0.03390593081712723, -0.006721817888319492, -0.025528395548462868, -0.007777255494147539, 0.005300275515764952, -0.041874486953020096, -0.013733881525695324, 0.012599285691976547, -0.009103149175643921, -0.013364478014409542, 0.02994804084300995, 0.04546297341585159, 0.0052046263590455055, 0.014670582488179207, 0.023615416139364243, 0.0648566409945488, -0.017691772431135178, 0.026966430246829987, 0.048576515167951584, -0.045568518340587616, -0.0037039262242615223, -0.05472443997859955, -0.06327348202466965, 0.027758007869124413, -0.0052705914713442326, -0.07277242094278336, -0.037230562418699265, 0.029657796025276184, -0.00753318564966321, -0.00964406132698059, -0.04351041465997696, 0.017137667164206505, -0.02063380554318428, 0.024697238579392433, 0.03810129687190056, 0.013984547927975655, 0.03150481358170509, -0.022995347157120705, 0.025053448975086212, -0.015884336084127426, -0.03522522747516632, -0.016675913706421852, -0.005277188029140234, 0.008324763737618923, 0.027810780331492424, 0.05005412548780441, 0.00031065320945344865, 0.020620612427592278, -0.06538435816764832, 0.023074503988027573, 0.005484977271407843, -0.002514909952878952, 0.031240953132510185, 0.03657091036438942, 0.0033196809235960245, 0.025383273139595985, -0.05139980837702751, -0.011141463182866573, -0.008549044840037823, -0.00426792586222291, 0.013681109994649887, -0.001543577411212027, -0.029314778745174408, -0.0010166831780225039, -0.0594739094376564, -0.0011428409488871694, -0.013476618565618992, -0.05836569890379906, 0.038444314152002335, -0.06506772339344025, 0.057046402245759964, 6.106901855673641e-05, 0.035964034497737885, -0.00806090421974659, -0.011761532165110111, 0.007348484359681606, 0.030739620327949524, -0.020924050360918045, 0.006210590712726116, 0.04195364564657211, -0.029288392513990402, 0.034565579146146774, -0.039209507405757904, 0.04205918684601784, 0.001424016198143363, -0.0010414200369268656, -0.017098089680075645, 0.0738806277513504, -0.04942086338996887, -0.0034532598219811916, -0.05651868134737015, 0.007915781810879707, -0.0024868748150765896, -0.033035196363925934, 0.008680974133312702, -0.019222157076001167, -0.01563366875052452, -0.002961821621283889, 0.021834364160895348, -0.0004708241031039506, 0.018799981102347374, 0.0017991912318393588, 0.012124339118599892, -0.02878705970942974, -0.009327429346740246, -0.0062930467538535595, -0.024736817926168442, -0.044882483780384064, 0.04810156673192978, -0.01964433118700981, -0.009973885491490364, -0.03129372373223305, -0.028839832171797752, -0.018681244924664497, -0.0058312928304076195, 0.013318303041160107, 0.011279989033937454, -0.03166312724351883, 0.013733881525695324, 0.02229611948132515, -5.0427035603206605e-05, 0.0294994805008173, 0.012645461596548557, 0.011517462320625782, 0.0034994352608919144, -0.04490887001156807, -0.008192834444344044, 0.007559571880847216, -0.011893462389707565, 0.027889937162399292, 0.03234916180372238, -0.03796936571598053, -0.0014075249200686812, 0.007770659402012825, 0.0062072924338281155, 0.082007497549057, 0.00250501511618495, 0.03427533432841301, -0.031953372061252594, -0.05562156066298485, 0.004904486704617739, -0.024472959339618683, -0.041373152285814285, 0.010719288140535355, -0.037362489849328995, 0.055252157151699066, 0.0086743775755167, 0.0033510143402963877, -0.007711290847510099, 0.006474449764937162, -0.053721774369478226, 0.0012887882767245173, -0.009083359502255917, 0.04847097024321556, 0.007843220606446266, -0.007487010210752487, -0.004416346549987793, -0.0391831211745739, 0.008885465562343597, 0.025554781779646873, 0.03725694492459297, 0.00026489008450880647, 0.026860887184739113, -0.004587855190038681, 0.07140035182237625, -0.007902588695287704, 0.041188452392816544, -0.05820738151669502, -0.009314236231148243, 0.027467763051390648, -0.05126788094639778, 0.004818732384592295, -0.008377536199986935, -0.0044526271522045135, -0.05820738151669502, 0.008694167248904705, -0.01218370720744133, -0.0016482966020703316, -0.0005116398679092526, -0.04625455290079117, 0.015488546341657639, -0.005178240593522787, -0.004192065913230181, -0.0034301721025258303, 0.0051848371513187885, 0.020699769258499146, 0.030924320220947266, -0.016636334359645844, 0.01506637129932642, -0.019802646711468697, 0.05248163267970085, 0.023034924641251564, 0.017005737870931625, -0.06343179941177368, -0.035119686275720596, -0.008720552548766136, -0.005623503588140011, -0.015409388579428196, -0.00590055575594306, 0.010554376058280468, -0.017005737870931625, 0.022916188463568687, 0.03031744435429573, -0.021821171045303345, -0.03657091036438942, 0.030528532341122627, 0.021148329600691795, -0.01585794985294342, 0.023589029908180237, 0.025027062743902206, -0.052085842937231064, -0.03095070645213127, 0.0024819273967295885, -0.04166339710354805, 0.009538517333567142, 0.033219896256923676, -0.0100200604647398, -0.012401391752064228, 0.018984682857990265, 0.03591126203536987, 0.018799981102347374, 0.031188180670142174, 0.014287985861301422, -0.003697329666465521, 0.020053314045071602, -0.04688781499862671, 0.0022856818977743387, -0.03187421336770058, -0.012091356329619884, 0.028945375233888626, 0.0015105950878933072, 0.019446438178420067, 0.016913387924432755, -0.04134676605463028, -0.009340622462332249, 0.017269598320126534, -0.03343098610639572, 0.023140469565987587, 0.01006623636931181, -0.023048117756843567, -0.03986915573477745, -0.050106897950172424, -0.03269217908382416, 0.0010496656177565455, -0.006210590712726116, 0.004845118150115013, 0.0635373443365097, -0.027889937162399292, -0.020066507160663605, -0.019578367471694946, 0.01828545518219471, 0.04248136281967163, 0.05556878820061684, -0.03931504860520363, -0.02918284945189953, -0.04266606271266937, -0.04337848350405693, -0.014235214330255985, -0.020435910671949387, -0.01572602055966854, 0.06390674412250519, 0.03414340689778328, 0.04456585273146629, 0.008872272446751595, -0.0014174196403473616, 0.03976361081004143, -0.05253440514206886, 0.02212461084127426, 0.014631003141403198, 0.008364343084394932, 0.050344374030828476, 0.015039985068142414, 0.04712528735399246, 0.004683504346758127, 0.029578637331724167, -0.01802159659564495, 0.005580626428127289, -0.0563075952231884, -0.009287850931286812, 0.020778927952051163, 0.0027936112601310015, -0.03406424820423126, 0.017599422484636307, 0.0002925128792412579, 0.016319703310728073, -0.022414855659008026, -0.017586229369044304, -0.04403813183307648, 0.0046373289078474045, 0.010646726936101913, 0.026689378544688225, -0.007599150761961937, -0.03852347284555435, 0.0504499152302742, 0.02986888401210308, -0.042006414383649826, 0.0043470836244523525, 0.004093118943274021, 0.03095070645213127, -0.04559490457177162, 0.014802511781454086, -0.04453946650028229, -0.0046802060678601265, -0.023773731663823128, -0.008318167179822922, 0.03543631732463837, 0.016148194670677185, -0.019947770982980728, -0.04744191840291023, 0.0364917553961277, 0.023325171321630478, 0.013615144416689873, 0.015699634328484535, 0.015923913568258286, -0.034117020666599274, -0.007856413722038269, -0.04095097631216049, 0.001166753238067031, 0.017507070675492287, 0.018404193222522736, -0.025330502539873123, 0.009175710380077362, -0.007223151158541441, -0.028681516647338867, -0.023668188601732254, 0.03374761715531349, -0.034486424177885056, -0.009037184529006481, 0.026504676789045334, 0.02306131087243557, -0.03527799993753433, 0.015409388579428196, 0.00250501511618495, 0.02671576291322708, 0.01684742234647274, -0.0032899968791753054, -0.03292965143918991, 0.007783852051943541, 0.08496272563934326, 0.05147896707057953, -0.004528487101197243, 0.0008002360700629652, -0.02531730942428112, -0.018298648297786713, -0.012955496087670326, 0.020330365747213364, -0.014974020421504974, -0.00017233316611964256, -0.009228481911122799, -0.0545133501291275, -0.02481597661972046, -0.0020548049360513687, -0.02494790591299534, 0.03654452785849571, -0.012249672785401344, -0.001513893250375986, 0.03414340689778328, 0.013061040081083775, -0.03453919664025307, 0.005181538872420788, 0.02936755120754242, 0.012210093438625336, 0.008509465493261814, 0.005567433312535286, 0.06965888291597366, -0.029789725318551064, -0.002745786914601922, -0.011312971822917461, 0.02265232987701893, -0.04174255579710007, 0.00040424082544632256, -0.03351014479994774, 0.014274793677031994, 0.00855564046651125, 0.008542448282241821, -0.04274522140622139, -0.03796936571598053, 0.02440699376165867, -0.023298785090446472, 0.002333506476134062, -0.07551655918359756, -0.03356291353702545, -0.0018997876904904842, 0.047046128660440445, -0.004792346153408289, -0.028364885598421097, 0.01720363274216652, -0.006814168766140938, -0.029393937438726425, 0.006728414446115494, -0.026768535375595093, -0.04994858428835869, 0.017309175804257393, 0.0014693669509142637, -0.007335291244089603, 0.028259340673685074, 0.015158722177147865, 0.01106230542063713, -0.02166285552084446, 0.012935706414282322, -0.00039537681732326746, 0.01554131880402565, 0.07150589674711227, 0.02923562005162239, -0.017770931124687195, -0.01936727948486805, -0.023140469565987587, -0.04153146967291832, -0.013944968581199646, 0.004314101301133633, 0.007968553341925144, 0.012084760703146458, 0.015409388579428196, 0.005419012159109116, 0.01679464988410473, -0.004878100473433733, -0.0200401209294796, 0.0024472959339618683, 0.046966973692178726, -0.026913657784461975, -0.04221750423312187, -0.0013291917275637388, 0.006391993723809719, -0.026676185429096222, 0.026478290557861328, -0.0046142409555613995, 0.04688781499862671, -0.009175710380077362, -0.005827994551509619, 0.03221723064780235, 0.0018041386501863599, -0.015923913568258286, -0.004640627186745405, -0.03841792792081833, -0.05174282565712929, -0.025963764637708664, -0.020871277898550034, -0.047230832278728485, -0.009822165593504906, -0.007856413722038269, 0.0034565581008791924, -0.01918257772922516, 0.002056454075500369, 0.04401174560189247, -0.03266579285264015, 0.010224551893770695, -0.0034862421452999115, 0.009089956060051918, -0.025515204295516014, -0.03630705177783966, 0.031372882425785065, 0.013199565932154655, -0.013747074641287327, 0.011748339980840683, 0.017216825857758522, 0.018034789711236954, 0.01130637526512146, 0.01382623240351677, -0.0225203987210989, -0.04147869721055031, 0.023180047050118446, 0.03171589970588684, -0.018773596733808517, -0.008298378437757492, 0.011167848482728004, 0.015237879939377308, -0.012084760703146458, -0.010593954473733902, -0.01986861228942871, -0.00896462332457304, -0.021517733111977577, 0.06506772339344025, -0.0019525595707818866, 0.00853585172444582, -0.004327293951064348, 0.018536122515797615, 0.003321330063045025, 0.009782587178051472, 0.023707766085863113, -0.008476482704281807, -0.019894998520612717, 0.03905119001865387, -0.013120408169925213, -0.013483215123414993, -0.047758549451828, 0.031135408207774162, 0.02733583375811577, -0.02063380554318428, 0.005095784552395344, -0.012493742629885674, -0.03211168944835663, -0.0059797135181725025, -0.02539646625518799, 0.02211141772568226, 0.014802511781454086, 0.01788966730237007, -0.057099174708127975, 0.0360431931912899, -0.01414286345243454, -0.005534450989216566, 0.002920593600720167, -0.05409117415547371, -0.04451308026909828, -0.029314778745174408, -0.023681379854679108, 0.035700175911188126, -0.0008649640949442983, 0.03670284152030945, -0.009426376782357693, -0.007374870125204325, -0.01662314124405384, 0.026676185429096222, -0.008615009486675262, -0.030739620327949524, -0.03802213817834854, 0.008595219813287258, 0.03150481358170509, 0.006368906237185001, -0.01832503452897072, -0.00920869316905737, 0.01471016090363264, -0.01990819163620472, -0.013865810818970203, 0.041109293699264526, 0.014644196256995201, 0.0035983824636787176, 0.011530655436217785, 0.007176975719630718, -0.01340405736118555, -0.04253413528203964, -0.03147842735052109, -0.02395843341946602, 0.02175520732998848, 0.0004716486728284508, 0.02270510047674179, -0.036412596702575684, -0.039578910917043686, -0.019657524302601814, 0.008885465562343597, 0.017467491328716278, -0.012487146072089672, -0.015475353226065636, -0.023351555690169334, -0.03773189336061478, -0.0005936836241744459, 0.036333438009023666, 0.007229747250676155, 0.02175520732998848, 0.007691501174122095, -0.025779062882065773, 0.029156463220715523, 0.005729047115892172, -0.04667672514915466, 0.0007280870340764523, 0.02283702977001667, 0.005484977271407843, -0.007902588695287704, -0.04498802870512009, -0.020924050360918045, -0.004940767306834459, 0.02112194523215294, 0.058629557490348816, -0.028180183842778206, -0.0002119120763381943, 0.0015369809698313475, -0.011068901978433132, 0.031109021976590157, -0.02337794192135334, -0.0005483328131958842, 0.04438114911317825, 0.04343125596642494, -0.020607419312000275, -0.012196900323033333, -6.271814345382154e-05, -0.0018981385510414839, -0.03285049647092819, -0.013799846172332764, 0.004168978426605463, -0.008443500846624374, -0.05504107102751732, 0.019749876111745834, -0.002831541234627366, 0.03031744435429573, 0.007289115805178881, 0.014974020421504974, 0.04712528735399246, 0.040106628090143204, -0.004907784517854452, 0.02288980223238468, 0.004709890112280846, -0.0105873579159379, 0.001239314558915794, -0.0034994352608919144, -0.010217955335974693, -0.044117290526628494, -0.050291601568460464, 0.012566303834319115, 0.02796909585595131, 0.02050187438726425, 0.0075265890918672085, 0.0252249576151371, 0.014367143623530865, 0.024156328290700912, -0.04116206616163254, 0.011174445040524006, 0.011748339980840683, -0.022678714245557785, 0.02752053551375866, -0.0008517710957676172, 0.030607689172029495, -0.018720824271440506, -0.0213989969342947, -0.019974155351519585, 0.01538300234824419, 0.002856277860701084, -0.009063569828867912, -0.016227353364229202, -0.00010090560681419447, 0.01554131880402565, 0.012381602078676224, -0.015277459286153316, 0.04269244894385338, -0.008595219813287258, -0.006095151882618666, 0.008140061981976032, 0.02180797979235649, 0.03630705177783966, 0.015831563621759415, 0.043853431940078735, 0.022269733250141144, -0.050476301461458206, 0.02328559197485447, -0.01658356375992298, -0.03292965143918991, 0.003717119339853525, 0.013681109994649887, 0.027177518233656883, 0.006952695082873106, 0.016926581040024757, -0.0094593595713377, 0.0022131206933408976, 0.0033971897792071104, -0.0297369547188282, -0.01315339095890522, 0.011200831271708012, 0.03237554803490639, 0.013423847034573555, 0.0495527945458889, 0.05957945063710213, -0.04606984928250313, -0.09710025787353516, -0.011273392476141453, -0.005841187201440334, 0.005333257839083672, 0.01779731549322605, 0.00909655261784792, 0.010409252718091011, -0.00903058797121048, 0.023800117895007133, 0.02595057152211666, -0.007203361485153437, -0.020963629707694054, -0.031636741012334824, -0.018628472462296486, 0.0028628744184970856, -0.0445922389626503, -0.02288980223238468, -0.015224686823785305, 0.00995409581810236, 0.01525107305496931, -0.04205918684601784, -0.011708760634064674, 0.018588894978165627, 0.004383364226669073, -0.03978999704122543, -0.03219084441661835, 0.011339357122778893, -0.004007364623248577, 0.02058103308081627, 0.02440699376165867, 0.017665386199951172, -0.0007940518553368747, 0.04306185245513916, 0.03928866237401962, -0.02248082123696804, -0.03657091036438942, 0.0037599962670356035, 0.008885465562343597, -0.002381331054493785, 0.05351068452000618, 0.004073329269886017, -0.047811321914196014, 0.021464962512254715, -0.010501603595912457, 0.03744164854288101, -0.017718158662319183, 0.04456585273146629, -0.023668188601732254, 0.009848551824688911, -0.015884336084127426, 0.02981611154973507, -0.007328694686293602, -0.003463154658675194, -0.008654587902128696, -0.027019202709197998, -0.049974970519542694, -0.05221777409315109, 0.018140332773327827, -0.007625536527484655, -0.012698233127593994, -0.0016095422906801105, 0.020937243476510048, -0.02778439410030842, -0.007579361088573933, -0.026597026735544205, -0.026056114584207535, 0.01996096409857273, 0.047046128660440445, -0.013522793538868427, -0.029341164976358414, -0.019208963960409164, 0.003690733341500163, -0.03348375856876373, 0.009307640604674816, 0.011999006383121014, -0.0039018208626657724, 0.0014330863486975431, 0.0306340754032135, -0.03295603767037392, 0.007460624445229769, 0.01186707615852356, -0.013681109994649887, 0.02414313517510891, -0.0011692269472405314, 0.00543880183249712, 0.016517598181962967, 0.024024397134780884, -0.02770523726940155, -0.027626078575849533, 0.00433718878775835, 0.0535898432135582, -0.004868205636739731, 0.015145529061555862, -0.01563366875052452, -0.007460624445229769, -0.0036445579025894403, 0.0005891485488973558, 0.008001536130905151, 0.01647801883518696, 0.01124041061848402, -0.014802511781454086, 0.025792255997657776, 0.0012351918267086148, 0.014301178976893425, -0.01563366875052452, -0.02125387452542782, 0.02080531418323517, -0.02288980223238468, 0.021293453872203827, -0.03886649012565613, 0.03031744435429573, -0.019697103649377823, -0.0014743143692612648, 0.001017507747747004, 0.001193139236420393, 0.03717778995633125, 0.010950164869427681, 0.036729227751493454, 0.04643925279378891, -0.00568616995587945, 0.02369457297027111, -0.017850087955594063, 0.012045181356370449, 0.010039850138127804, -0.008595219813287258, -0.02820657007396221, 0.007209958042949438, -0.003740206826478243, -0.03013274259865284, -0.007539782207459211, -0.013747074641287327, 0.0054058195091784, -0.014169249683618546, 0.012262864969670773, -0.016385668888688087, 0.025884605944156647, 0.013074233196675777, -0.025106221437454224, -0.033087968826293945, 0.02099001407623291, 0.02193990908563137, 0.007935571484267712, -0.009070166386663914, -0.02257317118346691, -0.02994804084300995, 0.043035466223955154, -0.028312113136053085, -0.012196900323033333, -0.013021460734307766, 0.02942032180726528, 0.0441436767578125, -0.012124339118599892, 0.005923643242567778, 0.027230288833379745, 0.0023186644539237022, 0.0200401209294796, 0.032771337777376175, -0.013588759116828442, -0.012810373678803444, 0.04757384955883026, 0.008634799160063267, 0.03013274259865284, 0.004957258235663176, -0.01779731549322605, 0.021451769396662712, -0.021768400445580482, -0.016741879284381866, -0.03337821364402771, 0.003591785905882716, 0.0005734818987548351, -0.03089793585240841, -0.06448723375797272, 0.0038160665426403284, 0.021992679685354233, 0.006596484687179327, -0.008271992206573486, 0.008700763806700706, -0.013159987516701221, -0.00959128886461258, 0.022098224610090256, -0.006326029077172279, 0.005676275119185448, -0.02558116801083088, 0.009835358709096909, -0.006121538113802671, -0.017757738009095192, -0.02981611154973507, 0.011253602802753448, 0.0075265890918672085, 0.021728821098804474, 0.00928125437349081, 0.01155044510960579, 0.032138075679540634, -0.002595716854557395, 0.06564822047948837, 0.002877716440707445, 0.023483486846089363, 0.020739348605275154, 0.0173487551510334, -0.05095124989748001, -0.019354086369276047, 0.0351460725069046, -0.0025165590923279524, -0.02477639727294445, -0.045885149389505386, 0.016372475773096085, -0.008298378437757492, -0.01679464988410473, 0.01856250874698162, -0.010541182942688465, 0.017150860279798508, 0.019024262204766273, -0.030343830585479736, 0.005267293192446232, 0.04306185245513916, -0.0017629106296226382, -0.005428906995803118, 0.003980978392064571, -0.007348484359681606, 0.012401391752064228, -0.01742791384458542, -0.04783770814538002, 0.007394659332931042, 0.009142727591097355, 0.000709946674760431, 0.023483486846089363, 0.015686441212892532, -0.005148556549102068, -0.03841792792081833, 0.0033196809235960245, -0.0066261691972613335, 0.02121429517865181, -0.009518727660179138, 0.010897393338382244, -0.007341887801885605, -0.023707766085863113, -0.003852347144857049, 0.0021834364160895348, -0.001115630497224629, 0.012513531371951103, 0.017467491328716278, -0.005349749233573675, -0.04316739737987518, 0.008271992206573486, -0.017190439626574516, 0.014670582488179207, 0.0013695951784029603, 0.04406451806426048, -0.0200401209294796, 0.01056097261607647, -0.024604888632893562, 0.02373415231704712, 0.014855284243822098, 0.002655085176229477, 0.0162141602486372, -0.00860181637108326, 0.008153255097568035, 0.024631274864077568, 0.026003343984484673, -0.0033196809235960245, -0.024354221299290657, 0.005296977236866951, 0.02581864222884178, -0.029288392513990402, -0.016636334359645844, -0.047758549451828, 0.0022543487139046192, 0.009789183735847473, 0.0027424886357039213, 0.04944724962115288, -0.007935571484267712, 0.009452763013541698, 0.01707170344889164, 0.010224551893770695, 0.014235214330255985, 0.0007491133292205632, 0.06089874729514122, -0.001210454967804253, 0.04087182134389877, 0.0022246644366532564, -0.004643925465643406, -0.031188180670142174, -0.009749604389071465, -0.034803055226802826, 0.011339357122778893, -0.018087562173604965, 0.038259610533714294, 0.0061842044815421104, 0.011187638156116009, 0.033035196363925934, -0.004485609941184521, 0.02778439410030842, 0.004597750026732683, -0.007256133481860161, 0.03910396248102188, -0.0023928747978061438, -0.018364613875746727, 0.03266579285264015, 0.00939339492470026, -0.00494406558573246, 0.016095422208309174, 0.004756065551191568, 0.0010109113063663244, -0.03269217908382416, 0.00853585172444582, 0.03728333115577698, -0.021385803818702698, -0.030792390927672386, -0.0281537976115942, -0.011603216640651226, -0.01779731549322605, 0.00045350834261626005, 0.00575213460251689, 0.0023747344966977835, -0.004967153072357178, 0.004521890543401241, -0.020937243476510048, 0.008067500777542591, -0.009367008693516254, -0.025647133588790894, 0.016596756875514984, -0.0020300683099776506, -0.002102629514411092, 0.03292965143918991, 0.005379433277994394, -0.017098089680075645, -0.0491042323410511, -0.0008748588152229786, -0.04158424213528633, 0.027494149282574654, 0.0023631907533854246, 0.0037204173859208822, 0.0065832920372486115, -0.011365743353962898, -0.016372475773096085, 0.027731621637940407, 0.0004477364127524197, 0.003280102042481303, -0.015356617048382759, 0.010666515678167343, 0.012196900323033333, -0.002399471355602145, 0.006662449799478054, -0.005174942314624786, -0.030792390927672386, 0.015752406790852547, -0.007157186046242714, 0.008252202533185482, -0.004380065947771072, 0.0032108391169458628, 0.07720525562763214, -0.025106221437454224, -0.020475488156080246, 0.013667916879057884, 0.010976551100611687, 0.03577933460474014, -0.008753535337746143, -0.03134649619460106, -0.027546921744942665, 0.0035654001403599977, 0.011946233920753002, 0.03496136888861656, -0.008469886146485806, -0.009934306144714355, 0.0337740033864975, 0.027019202709197998, -0.036016806960105896, 0.008654587902128696, 0.011682374402880669, 0.029024533927440643, 0.010593954473733902, -0.010303709656000137, -0.019987348467111588, -0.025515204295516014, 0.0011997356778010726, 0.02153092622756958, -0.003369154641404748, 0.01901106908917427, 0.02649148367345333, 0.02126706764101982, 0.0009094903361983597, 0.01006623636931181, -0.026135273277759552, 0.023892467841506004, -0.02580544911324978, 0.024077169597148895, -0.011873672716319561, 0.0037006279453635216, 0.010475218296051025, 1.7650751033215784e-05, 0.01286314520984888, 0.025871412828564644, -0.04292992502450943, 0.004350381903350353, -0.025436045601963997, 0.013575566001236439, 0.011860479600727558, 0.027863552793860435, -0.02054145373404026, -0.010653323493897915, 0.02617485262453556, 0.0148684773594141, 0.025251343846321106, -0.013667916879057884, -0.0030129444785416126, 0.00586757343262434, -0.005498169921338558, 0.004343785345554352, 0.017982017248868942, -0.009274657815694809, -0.01301486510783434, -0.01321935560554266, -0.017230018973350525, 0.022942574694752693, -0.023747345432639122, -0.008727149106562138, 0.0015749107114970684, 0.01914299838244915, -0.03852347284555435, 0.015791984274983406, -0.030739620327949524, -0.0033081371802836657, -0.013450232334434986, -0.024156328290700912, -0.0198158398270607, 0.011312971822917461, -0.026003343984484673, -0.001663138740696013, 0.031425654888153076, 0.03337821364402771, 0.00016759194841142744, 0.003924908582121134, -0.006326029077172279, 0.005920344963669777, 0.0019360682927072048, -0.03860262781381607, 0.008971219882369041, -0.02697962336242199, -0.017810508608818054, -0.009769394062459469, -0.0021751909516751766, 0.03973722457885742, 0.019710296764969826, -0.0268081147223711, -0.011286585591733456, 0.005399222951382399, 0.0009655604953877628, 0.00828518532216549, -0.013905390165746212, 0.024433379992842674, -0.0033625580836087465, 0.019987348467111588, 0.010805042460560799, -0.01684742234647274, -0.024248678237199783, 0.041056521236896515, -0.043352097272872925, -0.01056097261607647, 0.0059698186814785, 0.0021999278105795383, 0.04374788701534271, -0.014657389372587204, 0.007388063240796328, 0.01525107305496931, -0.01841738633811474, 0.01414286345243454, 0.01626693084836006, 0.05667699873447418, 0.008192834444344044, -0.03211168944835663, 0.03477666899561882, 0.0027045588940382004, 0.0012904372997581959, -0.018668051809072495, -0.0189187191426754, 0.0048088375478982925, -0.02891898900270462, 0.011497673578560352, 0.010112411342561245, -0.0065832920372486115, -0.028945375233888626, 0.010758866555988789, -0.003169611096382141, -0.031161794438958168, 0.009545113891363144, 0.009221886284649372, 0.01671549305319786, 0.012988478876650333, -0.01572602055966854, -0.001273946138098836, 0.015198301523923874, -0.026240816339850426, 0.029393937438726425, 0.003961189184337854, 0.011312971822917461, -0.0044526271522045135, 0.03095070645213127, -0.016860615462064743, -0.0052903806790709496, -0.009419780224561691, 0.006467853207141161, -0.002566032577306032, -0.036280665546655655, 0.0175730362534523, -0.017282789573073387, 0.004277820233255625, 0.022942574694752693, -0.0297369547188282, 0.017045317217707634, -0.008727149106562138, 0.03884010389447212, 0.006702028680592775, 0.012830163352191448, -0.00813346542418003, 0.053800929337739944, -0.0243278369307518, 0.011207427829504013, -0.006820765323936939, 0.00476266210898757, -0.047758549451828, -0.015712827444076538, 0.021187908947467804, 0.01126019936054945, 0.0011552093783393502, -0.014248407445847988, -0.03847070038318634, -0.007203361485153437, -0.011537251994013786, 0.014274793677031994, 0.054355036467313766, -0.012731215916574001, -0.035884879529476166, -0.008278588764369488, 0.00018408315372653306, -0.007012063637375832, -0.026742149144411087, -0.004861609544605017, 0.0026996114756911993, 0.010903989896178246, -0.003918312024325132, 0.028892604634165764, 0.00010276086686644703, 0.02013247273862362, -0.006101748440414667, 0.013628337532281876, 0.01531703770160675, 0.019156191498041153, -0.013140197843313217, 0.006800976116210222, -0.0065272217616438866, 0.05063461884856224, -0.0032487688586115837, 0.001504823099821806, 0.022665521129965782, 0.02369457297027111, -0.017269598320126534, 0.011405322700738907, 0.02095043659210205, -0.009518727660179138, 0.01905064843595028, 0.004363574553281069, -0.018773596733808517, 0.009828762151300907, 0.0355682447552681, -0.02796909585595131, 0.014551845379173756, 0.012460759840905666, 0.0076783085241913795, 0.014287985861301422, -0.008199431002140045, -0.00252150627784431, 0.007519992534071207, 0.02125387452542782, -0.004746170714497566, -0.00031024092459119856, 0.018984682857990265, 0.009367008693516254, 0.009261464700102806, -0.0008781570359133184, 0.01841738633811474, 0.00515845138579607, -0.00408652238547802, 0.008615009486675262, -0.00786301027983427, 0.005221117753535509, -0.03395870327949524, -0.04343125596642494, -0.03126733750104904, -0.014631003141403198, -0.016834229230880737, 0.0006650081486441195, -0.013351285830140114, 0.006141327321529388, -0.03884010389447212, 0.007519992534071207, -0.009136131964623928, -0.0025775765534490347, -0.0047428724355995655, -0.028945375233888626, 0.001073577906936407, -0.003275154856964946, 0.006932905409485102, -0.010692901909351349, -0.020303981378674507, 0.011748339980840683, -0.012948899529874325, -0.006728414446115494, -0.027045587077736855, 0.022322505712509155, 0.017361948266625404, 0.020475488156080246, -0.0011749988188967109, 0.038760945200920105, -0.007935571484267712, -0.017757738009095192, 0.03358929976820946, 0.011880269274115562, -0.004135996103286743, -0.005775222554802895, -0.0310826376080513, -0.018575701862573624, 0.02841765619814396, 0.007493606768548489, -0.016412055119872093, -0.0076123434118926525, 0.018219491466879845, -0.02044910378754139, 0.01792924664914608, -0.015026792883872986, -0.021201102063059807, 0.0032421723008155823, 0.013463425450026989, -0.007308905012905598, -0.025779062882065773, 0.033932317048311234, 0.029789725318551064, -0.017243212088942528, -0.029710568487644196, -0.011702164076268673, 0.038708172738552094, 0.0015996475704014301, 0.024090362712740898, 0.005781819112598896, -0.0159898791462183, -0.0026831203140318394, -0.0024736819323152304, -0.0017464193515479565, -0.0032685582991689444, 0.02414313517510891, 0.05388008803129196, -0.005132065154612064, -0.009973885491490364, -0.019749876111745834, 0.007704694289714098, 0.03324628248810768, 0.04174255579710007, -0.030106356367468834, 0.023311978206038475, 0.0007759115542285144, 0.011906655505299568, 0.02265232987701893, 0.01445949450135231, -0.03253386169672012, 0.012665251269936562, -0.009940902702510357, -0.0225203987210989, -0.017546650022268295, -0.02725667506456375, -0.0019822437316179276, 0.030027199536561966, -0.0027474360540509224, 0.010046446695923805, -0.003130031982436776, -0.02287660911679268, 0.013733881525695324, -0.018760403618216515, -0.0007408676901832223, 0.007909185253083706, 0.028232954442501068, 0.0041953641921281815, 0.026649799197912216, 0.0006571747944690287, 0.05815460905432701, -0.03973722457885742, -0.003637961344793439, 0.03789021074771881, 0.006203994154930115, 0.01315339095890522, 0.007361677009612322, -0.03192698583006859, -0.015277459286153316, 0.009538517333567142, -0.0038292594254016876, -0.017982017248868942, -0.034934982657432556, 0.04237581789493561, 0.01401093415915966, 0.003931505139917135, -0.007361677009612322, 0.005240907426923513, 0.022150997072458267, 0.00829178187996149, -0.005531152710318565, 0.0017546649323776364, -0.005992906633764505, 0.03606957942247391, 0.0018503139726817608, 0.006273257080465555, -0.03630705177783966, -0.033668458461761475, -0.015712827444076538, 0.015026792883872986, 0.020844891667366028, 0.0047230832278728485, 0.008766728453338146, -0.00710441404953599, -0.004980346187949181, -0.012968689203262329, -0.005478380713611841, -0.00529367895796895, 0.009386798366904259, 0.012968689203262329, 0.030554918572306633, 0.026108887046575546, -0.013113811612129211, 0.015699634328484535, -0.018536122515797615, -0.0001511007285444066, 0.027309447526931763, -0.007097817957401276, 0.008344553411006927, -0.019077034667134285, -0.013615144416689873, -0.018074369058012962, 0.00817964132875204, -0.007810238283127546, 0.02397162653505802, -0.00823900941759348, 0.015976686030626297]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"t] =γ[Atx] = 0 for all t.Since γ[(BT
t−1Bt−1)−1] =−1and
γ[(At−1AT
t−1)−1] = 0 , all equations in (4) are satisfied. One can check that δ3
t∈Θ(1) and therefore stable feature learning
is achieves with η= Θ(1) .Theorem 1 in (Hayou et al., 2024) shows that ηA= Θ( n−1)andηB= Θ(1) are required for
unpreconditioned LoRA training to achieve stable feature learning.
A.3. Explanation of Different Learning Rates
Here we note that learning rate η= Θ(1) is required for Theorem 4.1 while learning rate η= Θ( n−1)is used for our toy
example described in Section 4. This discrepancy arises from different settings being considered in these two regimes.
Specifically, Theorem 4.1 deals with vector output, i.e., we assume BAx is of dimension Θ(n). This is core to our
preconditioner since we then have γ[(BT
t−1Bt−1)−1] =−1from γ[Bt−1] = 0.For scalar output as considered in the toy
example, when γ[Bt−1] = 0 , we will have γ[(BT
t−1Bt−1)−1] = 0 and thus fail to scale the statics correctly. Then one
would wonder for scalar output, whether setting η= Θ( n−1)would be the correct choice as in the toy example. This is
no longer true due to our Assumption A.2. In the toy example, we have gt
a= (ft(x)−y)bxandgt
aTx= Θ( n)is not
guaranteed since it also scales with ft(x)andb. Instead, Theorem 4.1 would hold for scalar output with η1= Θ(1) and
ηt= Θ( n−1)fort >1which we do not include in the theorem statement for simplicity and one can deduce following our
proof technique of Theorem 4.1. The takeaway is that for scalar output, our preconditioner can still achieve stable feature
learning with same order of magnitude learning rate for both AandBthough one may need to tune learning rates across
iterations, which is the current convention of learning rate scheduling.
B. Proof of Theorem 7.4
Note problem (3) is equivalent to the problem below up to a change of labels,
min
Ai,Bi∥PX
i=1CiAiBT
i−Y∥2
F, (5)
where Ci∈Rn×d, Ai∈Rd×r, Bi∈Rc×r, Y∈Rn×c.Consider Y=PP
i=1CiAi
⋆Bi
⋆T. Denote Xi
⋆=Ai
⋆Bi
⋆T=
Ui
⋆Σi
⋆Vi
⋆Twhere Ui
⋆Σi
⋆Vi
⋆Tis the singular value decomposition of Xi
⋆. Denote Fi
⋆= [Ai
⋆, Bi
⋆]T.For any F= [A, B]T,
consider the following distance metric
dist2(F, Fi
⋆) = inf
Q∈GL(r)(AQ−Ai
⋆)Σi
⋆1/22
F+(BQ−T−Bi
⋆)Σi
⋆1/22
F, (6)
where GL(r)denotes the set of invertible matrix in Rr×r. Let σr(·)denote the rth largest singular value and κidenote
condition number of Xi
⋆. Consider the following scaled GD step:
Ai
t+1=Ai
t−ηCT
i(X
jCjAj
tBj
tT−Y)Bi
t(Bi
tTBi
t)−1,
Bi
t+1=Bi
t−η(CT
i(X
jCjAj
tBj
tT−Y))TAi
t(Ai
tTAi
t)−","[0.006675771437585354, -0.03695143759250641, 0.022282995283603668, -0.0027120320592075586, -0.044565990567207336, -0.01375573966652155, 0.0006727110594511032, -0.004765613935887814, -0.03974170237779617, 0.055075112730264664, -0.01318855956196785, -0.013429773971438408, -0.014186014421284199, 0.007653667591512203, 0.03434371575713158, 0.0022133050952106714, 0.06388922035694122, -0.007562397047877312, -0.028033023700118065, 0.028450259938836098, 0.03465664014220238, -0.03619519621133804, 0.060029786080121994, 0.021174712106585503, 0.043209973722696304, -0.03058859333395958, 0.03170991316437721, 0.004765613935887814, 0.04206257313489914, -0.015711532905697823, 0.04229727014899254, -0.012888671830296516, -0.033770013600587845, -0.05700482800602913, 0.017849864438176155, 0.013860048726201057, -0.02107040397822857, 0.04451383277773857, -0.017915058881044388, 0.008937970735132694, 0.005727211944758892, -0.04130633547902107, -0.10086673498153687, -0.005401246715337038, -0.011408789083361626, 0.015255180187523365, -0.006098812445998192, 0.027615787461400032, 0.023704202845692635, 0.04099340736865997, -0.034787025302648544, 0.047773487865924835, -0.053041089326143265, -0.01837140880525112, -0.03523033857345581, 0.006085773929953575, 0.04206257313489914, 0.009681172668933868, 0.04271450638771057, -0.029206499457359314, 0.04268842935562134, -0.03611696511507034, 0.028658878058195114, -0.003934402484446764, -0.02719855308532715, -0.008162173442542553, -0.05066806077957153, 0.02177448756992817, -0.0038985460996627808, -0.014407670125365257, -0.03726436570286751, -0.026833470910787582, 0.07327701896429062, -0.02099217101931572, 0.02363901026546955, 0.02792871557176113, 0.02336519956588745, 0.05617035552859306, 0.05497080460190773, -0.019883889704942703, 0.026703085750341415, 0.0005574008100666106, 0.06790511310100555, -0.012119393795728683, 0.01311032846570015, -0.07791876792907715, -0.03601265698671341, -0.01748478412628174, -0.04936419799923897, -0.022830616682767868, 0.004260367713868618, -0.0010088628623634577, -0.006173784378916025, 0.018697375431656837, 0.03901153802871704, 0.007542839273810387, 0.03494349122047424, -0.03538680449128151, 0.00016328829224221408, -0.014798829331994057, 0.00034593077725730836, -0.02165714092552662, 0.050537675619125366, -0.0248124860227108, 0.055700965225696564, -0.02001427486538887, -0.028737109154462814, 0.029050035402178764, -0.025334030389785767, 0.022908847779035568, -0.043366435915231705, 0.009348687715828419, -0.012908229604363441, 0.03301377594470978, 0.017080586403608322, -0.08730657398700714, -0.06305474787950516, -0.017380474135279655, -0.02157890982925892, -0.0010219014948233962, -0.020627090707421303, -0.009739845991134644, -0.024017130956053734, 0.0021497418638318777, 0.012282376177608967, 0.006701848469674587, 0.0518936924636364, -0.07192100584506989, -0.023000117391347885, -0.026468390598893166, 0.03554326668381691, 0.023899782449007034, -0.0033900400158017874, 0.005261081270873547, -0.023430392146110535, 0.006108591333031654, 0.02083570882678032, 0.035178184509277344, 0.02894572727382183, 0.005789145361632109, -0.009870232082903385, 0.01482490636408329, -0.029675889760255814, 0.021631063893437386, -0.02375635877251625, 0.02972804382443428, -0.009459516033530235, 0.012784362770617008, -0.010131004266440868, 0.015698492527008057, -0.01681981422007084, 0.007816649973392487, -0.021318137645721436, -0.014498940669000149, -0.014785789884626865, -0.0251645278185606, -0.027537556365132332, 0.054136332124471664, 0.017758594825863838, -0.012484475038945675, 0.0130516542121768, 0.030692901462316513, 0.03624735027551651, 0.012106354348361492, 0.03202284127473831, 0.04717371240258217, -0.035438958555459976, -0.00028033024864271283, -0.052728161215782166, -0.0543971061706543, 0.03285731002688408, -0.012693092226982117, -0.03908976912498474, -0.03984601050615311, 0.038959383964538574, -0.010874205268919468, -0.009694211184978485, -0.06780080497264862, 0.017354397103190422, -0.0511113740503788, 0.008520735427737236, 0.027798328548669815, -0.010300506837666035, 0.018827760592103004, -0.03783806413412094, 0.0446963757276535, -0.03160560503602028, -0.05356263369321823, 0.012432320043444633, 0.0250862967222929, 0.0009493742254562676, 0.00878150761127472, 0.0466521680355072, 0.005049203988164663, -0.006721406243741512, -0.06086425855755806, 0.02925865352153778, 0.04167141765356064, -0.008396868593990803, 0.038333531469106674, 0.009407361038029194, -0.0004490173305384815, 0.013651430606842041, -0.011069784872233868, -0.013097289949655533, -0.04143672063946724, 0.0026582477148622274, -0.011030669324100018, -0.032831232994794846, -0.0068583120591938496, -0.01412082090973854, -0.0072820670902729034, 0.005603345111012459, 0.00524804275482893, -0.053041089326143265, 0.028267718851566315, -0.07077360898256302, 0.01919284276664257, -0.01907549425959587, 0.0230522733181715, -0.00047387220547534525, -0.020966093987226486, -0.008540293201804161, 0.026637891307473183, -0.033300623297691345, 0.008149134926497936, 0.0511896051466465, 0.01615484431385994, 0.04693901538848877, -0.0461827777326107, 0.045583002269268036, -0.005994503386318684, 0.012093315832316875, -0.0452439971268177, 0.024864640086889267, -0.05757852643728256, -0.0489208847284317, -0.05851730704307556, -0.01133707631379366, -0.018892955034971237, -0.017967212945222855, 0.047069404274225235, -0.013494967482984066, -0.03460448607802391, 0.007927478291094303, -0.004759094677865505, -0.003807275788858533, 0.015489875338971615, 0.0280591007322073, 0.03272692486643791, -0.044226985424757004, -0.025034142658114433, -0.007458088453859091, -0.0521283857524395, -0.039507005363702774, 0.024721216410398483, -0.004306002985686064, -0.005133954808115959, -0.02539922297000885, -0.0006401145365089178, -0.028841417282819748, -0.04010678082704544, -0.016402577981352806, -0.005443621892482042, -0.011806466616690159, 0.012341049499809742, -0.0052219657227396965, 0.009029241278767586, 0.01709362491965294, 0.007725379895418882, 0.007079968228936195, 0.04146279767155647, -0.020900901407003403, -0.005443621892482042, -0.018892955034971237, -0.026298888027668, 0.025529609993100166, 0.04354897513985634, -0.03538680449128151, 0.025307953357696533, -0.02064012922346592, 0.024603867903351784, 0.08574193716049194, -0.011806466616690159, -0.00041010521817952394, -0.022869732230901718, -0.020001236349344254, 0.004537438508123159, -0.01674158312380314, -0.013573198579251766, 0.03556934371590614, 0.014055627398192883, 0.055805277079343796, 0.028215564787387848, -0.01226933766156435, 0.0059553878381848335, -0.011095861904323101, -0.03152737393975258, 0.016728544607758522, -0.006727925967425108, 0.02800694666802883, 0.012869114056229591, -0.026989934965968132, 0.01946665346622467, -0.048634037375450134, 0.032753001898527145, 0.00994846411049366, 0.019675271585583687, 0.027954792603850365, 0.015867995098233223, -0.013331985101103783, 0.0262206569314003, 0.012015084736049175, 0.04302743077278137, -0.052597776055336, -0.03948092833161354, 0.016167882829904556, -0.046965092420578, -0.005730471573770046, -0.005736990831792355, -0.009016202762722969, -0.05883023515343666, 0.019909966737031937, -0.006512788590043783, 0.0478256419301033, 0.005000309087336063, -0.04000247269868851, 0.008677198551595211, -0.0059553878381848335, -0.014446786604821682, -0.01950576901435852, -0.01782378740608692, 0.012986461631953716, -0.0014032809995114803, -0.037551213055849075, 0.017628207802772522, -0.007086487486958504, 0.047538794577121735, 0.0016371612437069416, 0.014798829331994057, -0.06900035589933395, -0.008722834289073944, -0.04167141765356064, 0.023573817685246468, -0.00859896745532751, 0.022061338648200035, 0.003267802996560931, -0.004459206480532885, 0.03687320649623871, 0.01774555630981922, -0.01102415006607771, -0.01049608550965786, 0.0542406402528286, 0.009922387078404427, -0.03332670032978058, -0.014212091453373432, 0.008579408749938011, -0.02680739387869835, -0.03246615454554558, 0.00013710919301956892, -0.031892452389001846, 0.013677507638931274, 0.027016011998057365, -0.0006576351588591933, -0.042427655309438705, 0.04795602709054947, -0.007849246263504028, 0.017615169286727905, 0.009902828373014927, 0.009120511822402477, 0.009172665886580944, 0.019375383853912354, -0.02052278071641922, -0.01721097342669964, -0.04214080795645714, -0.05747421830892563, 0.05679621174931526, 0.006571462377905846, 0.039976395666599274, 0.02356077916920185, 0.011780389584600925, -0.002063360996544361, 0.018945109099149704, -0.0240692850202322, 0.011232767254114151, 0.012490994296967983, 0.024369172751903534, -0.03635166212916374, -0.036143042147159576, -0.028997881338000298, 0.03549111261963844, 0.0013185300631448627, -0.024786408990621567, 0.016493849456310272, -0.014420708641409874, -0.011812985874712467, -0.010522162541747093, 0.028997881338000298, 0.03564757481217384, 0.034161172807216644, -0.03682105243206024, -0.029284730553627014, -0.058778081089258194, -0.0503290556371212, -0.011695638298988342, -0.0033737418707460165, 0.030406052246689796, 0.08031786978244781, 0.027094243094325066, 0.022282995283603668, 0.03280515596270561, 0.0020470626186579466, 0.013781816698610783, -0.027641866356134415, 0.018932070583105087, 0.014981369487941265, -0.026298888027668, 0.060499176383018494, 0.0271203201264143, 0.06905250996351242, -0.030301742255687714, 0.015828879550099373, -0.01603749766945839, -0.019570961594581604, -0.030171357095241547, 0.01100459136068821, -0.01747174561023712, 0.010235313326120377, -0.010443931445479393, -0.027485402300953865, 0.009726807475090027, 0.05856946110725403, -0.02328696846961975, -0.003129267832264304, -0.04912950471043587, -0.0023534700740128756, -0.009081396274268627, -0.0055283731780946255, -0.006734445225447416, -0.01728920452296734, 0.023417353630065918, 0.00882062315940857, -0.011780389584600925, -0.01805848255753517, 0.01938842236995697, 0.040393631905317307, -0.044565990567207336, 0.004935116041451693, 0.006049917545169592, -0.01564633846282959, -0.040315400809049606, 0.018514834344387054, 0.04135848954319954, 0.00441683130338788, -0.0039115846157073975, -0.056900519877672195, 0.043444667011499405, -0.0072690281085669994, 0.03303985297679901, 0.01069166511297226, 0.014172974973917007, -0.016480810940265656, -0.011715196073055267, -0.032909467816352844, 0.009296532720327377, 0.024721216410398483, 0.06258535385131836, -0.04028932377696037, -0.00045064714504405856, -0.020183777436614037, -0.0238737054169178, -0.04487891495227814, 0.03843783959746361, -0.05575311928987503, -0.03588227182626724, 0.05544019490480423, 0.01207375805824995, -0.04307958483695984, -0.018619142472743988, 0.01537252776324749, 0.0514243021607399, 0.0026647672057151794, -0.026364080607891083, 0.003329736413434148, 0.036690663546323776, 0.07484165579080582, 0.047304097563028336, -0.027016011998057365, -2.3670691007282585e-05, 0.008259963244199753, 0.006265054922550917, -0.022191723808646202, 0.028450259938836098, -0.01486402191221714, -0.016167882829904556, -0.006832234561443329, -0.025151489302515984, -0.03486526012420654, 0.0033085488248616457, -0.016480810940265656, 0.05051159858703613, 0.027094243094325066, 0.0032384661026299, 0.02680739387869835, 0.0074906847439706326, 0.00081572838826105, 0.02782440558075905, -0.031892452389001846, 0.007093007210642099, 0.011095861904323101, -0.0030184395145624876, 0.021239904686808586, -0.0013136405032128096, 0.016063574701547623, -0.002037283731624484, 0.0023991053458303213, -0.03502172231674194, -0.0041690971702337265, -0.0473562516272068, 0.04021109268069267, 0.031084060668945312, 0.0047264983877539635, -0.03199676424264908, -0.03835960850119591, 0.01887991651892662, 0.007203835062682629, -0.02324785105884075, -0.08297774940729141, -0.04920773580670357, -0.02606419287621975, 0.009029241278767586, -0.011500058695673943, -0.026116346940398216, 0.0028717550449073315, -0.011819505132734776, -0.016767660155892372, -0.02403016947209835, -0.03233576565980911, -0.030171357095241547, -0.0010219014948233962, 0.01856698840856552, -0.006838753819465637, 0.04448775574564934, 0.03066682443022728, 0.03924623504281044, -0.03538680449128151, -0.0008849960286170244, -0.008377310819923878, 0.009550785645842552, 0.05726560205221176, 0.02925865352153778, -0.03293554484844208, -0.00938128400593996, -0.011930333450436592, -0.01911461167037487, -0.004837326239794493, -0.020496703684329987, -0.002835898892953992, 0.006496490444988012, 0.03796844929456711, 0.010561279021203518, -0.002744628582149744, -0.018123675137758255, -0.023417353630065918, -0.011304480023682117, 0.06607970595359802, -0.006395441014319658, -0.04693901538848877, 0.013331985101103783, 0.014850983396172523, -0.010463489219546318, 0.0034421945456415415, 0.009179185144603252, -0.01505960151553154, 0.01997515931725502, -0.01751086115837097, 0.04764310270547867, -0.0024675580207258463, 0.024903755635023117, -0.009798519313335419, -0.03564757481217384, -0.03987208753824234, -0.02672916278243065, -0.01934930495917797, -0.027094243094325066, -0.004188655409961939, -0.008155654184520245, 0.0056978752836585045, -0.02138333022594452, -0.00951818935573101, 0.009492112323641777, -0.02688562497496605, 0.003103190567344427, -0.02410840056836605, -0.0012883782619610429, -0.026272810995578766, -0.04341858997941017, 0.013136405497789383, -0.023221774026751518, -0.0010227164020761847, 0.025894690304994583, -0.010541721247136593, 0.03520426154136658, -0.018071521073579788, -0.019649194553494453, -0.009981060400605202, -0.015789764001965523, 0.011193651705980301, 0.0246169064193964, -0.02800694666802883, -0.00817521195858717, -0.0038300934247672558, 0.009785480797290802, -0.013573198579251766, -0.00831211730837822, -0.023769397288560867, -0.016415616497397423, -0.024134477600455284, 0.060759950429201126, 0.000257716397754848, -0.0017536937957629561, -0.031266599893569946, 0.029623735696077347, -0.003996335901319981, 0.008572889491915703, 0.026637891307473183, 0.0008540293201804161, -0.04842541739344597, 0.018084559589624405, -0.018671298399567604, -0.034891337156295776, -0.01509871706366539, 0.015242141671478748, -0.0045081013813614845, -0.018358370289206505, -0.021983105689287186, 0.009224820882081985, 0.0015833768993616104, 0.003147195791825652, -0.02957157976925373, 0.029284730553627014, 0.00981155876070261, 0.008383830077946186, -0.027615787461400032, 0.03523033857345581, -0.004263627342879772, -0.005450141616165638, 0.019610079005360603, -0.027980869635939598, -0.043053507804870605, -0.030536437407135963, -0.03317023813724518, 0.047225866466760635, 0.01073078066110611, 0.04300135374069214, -0.0262206569314003, -0.02009250782430172, -0.006128149572759867, 0.006095552816987038, -0.008801065385341644, -0.007236431818455458, -0.01631130836904049, 0.01794113591313362, 0.004237550310790539, 0.01116105541586876, -0.00998757965862751, -7.582515536341816e-06, 0.03387432545423508, 0.005261081270873547, 0.0007216059020720422, 0.03043212927877903, 0.006317209452390671, -0.01923195831477642, -0.003290620632469654, -0.022830616682767868, -0.03687320649623871, -0.01689804531633854, -0.033926479518413544, -0.02894572727382183, 0.0126018226146698, -0.040524017065763474, 0.015020485036075115, -0.03619519621133804, -0.033457089215517044, -0.022908847779035568, -0.007738418411463499, -0.01513783261179924, -0.016767660155892372, -0.015085678547620773, -0.01934930495917797, -0.003592138644307852, -0.010385257191956043, 0.014877060428261757, -0.02324785105884075, 0.007392894942313433, -0.005081800278276205, -0.04120202735066414, 0.03648204728960991, 0.02383458986878395, -0.03395255655050278, -0.008709795773029327, 0.007366817910224199, -0.01635042391717434, -0.01650688797235489, -0.046104546636343, -0.03658635541796684, -0.02075747586786747, 0.0246169064193964, 0.07181669771671295, -0.02071836031973362, -0.0474344827234745, 0.008592448197305202, 0.0038007565308362246, 0.007581955287605524, -0.02418663166463375, -0.008853220380842686, 0.03027566522359848, 0.0465739369392395, 0.006600799039006233, 0.005570748820900917, -0.028450259938836098, -0.007405933924019337, -0.022217800840735435, 0.0031325274612754583, 0.01833229325711727, -0.021761449053883553, -0.046443548053503036, 0.01073078066110611, -0.02539922297000885, 0.00452765915542841, 0.03317023813724518, 0.014342477545142174, 0.04318389669060707, 0.013990434817969799, -0.007594993803650141, 0.0008564741001464427, -0.012901710346341133, 0.0061607458628714085, -0.0130516542121768, -0.008305598050355911, -0.0034161172807216644, -0.0235998947173357, -0.023652048781514168, 0.02847633697092533, 0.03233576565980911, 0.03262261673808098, 0.027798328548669815, 0.024330057203769684, 0.022426418960094452, 0.02134421467781067, -0.009270455688238144, 0.010404814966022968, 0.003500868333503604, -0.018319254741072655, 0.019218919798731804, 0.00445594685152173, 0.017458707094192505, 0.008188250474631786, -0.024877678602933884, -0.013071211986243725, 0.0007452383870258927, -0.006877869833260775, 0.005518594291061163, 0.0060922931879758835, -0.002584905596449971, 0.03775983303785324, 0.014172974973917007, -0.007914439775049686, 0.048086415976285934, 0.00569461565464735, -0.013240714557468891, -0.0020503222476691008, 0.0007073449087329209, 0.013534083031117916, 0.02371724136173725, 0.0269638579338789, 0.01848875731229782, -0.04440952464938164, 0.010326583869755268, -0.0032873610034585, -0.05340617150068283, 0.006516048219054937, -0.006095552816987038, 0.004361417144536972, -0.03783806413412094, -0.001323419506661594, 0.0009876751573756337, 0.00015167577657848597, 0.0068061575293540955, -0.03082328848540783, -0.0020438029896467924, -0.007119084242731333, 0.017680363729596138, 0.03160560503602028, 0.02571215108036995, 0.06743571907281876, -0.021161673590540886, -0.10868990421295166, -0.009909347631037235, -0.026507506147027016, -0.017928097397089005, 0.016363462433218956, 0.004729758016765118, 0.026911703869700432, -0.015124794095754623, 0.008729353547096252, 0.0048340666107833385, -0.01281695906072855, -0.006529086735099554, 0.012151990085840225, 0.013586238026618958, 0.017041470855474472, -0.016637273132801056, -0.00501334760338068, -0.00016501998470630497, 0.04357505217194557, 0.016180921345949173, -0.034161172807216644, -0.01505960151553154, 0.020470626652240753, 0.005150253418833017, -0.05497080460190773, -0.009179185144603252, 0.022700229659676552, -0.016167882829904556, 0.0007509427960030735, 0.015163910575211048, 0.014368554577231407, 0.009198743849992752, 0.047043327242136, 0.07259901612997055, -0.024629944935441017, 0.010985033586621284, -0.012608341872692108, 0.018736490979790688, 0.01989692822098732, 0.04323605075478554, 0.007340740878134966, -0.05622250959277153, 0.0509549118578434, -0.026155462488532066, 0.027876559644937515, -0.03194461017847061, 0.03191853314638138, -0.032596539705991745, 0.003618215909227729, -0.0025767565239220858, 0.006359584629535675, 0.01102415006607771, -0.015163910575211048, -0.00790140125900507, -0.024395249783992767, -0.019088532775640488, -0.03082328848540783, 0.005417544860392809, -0.01580280251801014, -0.010346141643822193, 0.00011266178626101464, 0.01592014916241169, 0.01705450937151909, -0.00548273790627718, -0.01584191806614399, -0.016167882829904556, 0.005375169217586517, 0.020614052191376686, -0.038098834455013275, -0.013873087242245674, 0.0066692521795630455, -0.0005508814938366413, -0.00891189370304346, 0.0014717337908223271, -0.0029516166541725397, 0.004931856412440538, -0.024682098999619484, 0.015229103155434132, -0.06764433532953262, 0.006956101395189762, 0.01408170536160469, -0.020314162597060204, 0.01152613665908575, 0.0259077288210392, -0.009844155050814152, 0.012647457420825958, 0.037785910069942474, -0.028450259938836098, -0.008266482502222061, 0.010580836795270443, 0.033378858119249344, 0.020418472588062286, 0.02871103212237358, -0.0023273928090929985, 0.0011914034839719534, 0.004191915038973093, 0.0017928096931427717, 0.011597848497331142, 0.028528491035103798, 0.00860548671334982, 0.014146897941827774, 0.04451383277773857, -0.002584905596449971, -0.0014464714331552386, -0.027094243094325066, -0.031501296907663345, 0.030875442549586296, -0.013032096438109875, 0.031162291765213013, -0.04373151808977127, 0.0486079603433609, -0.029389040544629097, -0.004987270571291447, 0.010365699417889118, 0.00558052770793438, 0.03199676424264908, 0.024669060483574867, 0.03955915942788124, 0.03285731002688408, -0.0113892313092947, 0.01073078066110611, -0.007699302397668362, 0.01615484431385994, -0.003386780386790633, -0.01805848255753517, -0.020418472588062286, -0.009348687715828419, 0.020392395555973053, -0.02941511757671833, 0.00786228571087122, -0.003023328958079219, 0.004583073314279318, 0.017184896394610405, -0.0005948868347331882, 0.020666206255555153, 0.029910584911704063, 0.008292559534311295, -0.01384701021015644, -0.024708176031708717, 0.005068761762231588, -0.014837944880127907, 0.017693402245640755, 0.0018743010004982352, 0.010254871100187302, -0.028215564787387848, 0.00406804820522666, -0.028450259938836098, -0.027302861213684082, 0.0025930546689778566, 0.03666458651423454, 0.058152224868535995, -0.013019057922065258, 0.007451568730175495, 0.01685892976820469, 0.01813671365380287, 0.006020580884069204, 0.027537556365132332, -0.03528249263763428, 0.00042701466009020805, 0.03317023813724518, 0.03343101218342781, 0.005235004238784313, 0.027615787461400032, -0.03562149778008461, 0.0006062956526875496, -0.018945109099149704, -0.03387432545423508, -0.024017130956053734, 0.014511979185044765, 0.014798829331994057, -0.04193218797445297, -0.07505027204751968, 0.015581145882606506, 0.02297404035925865, -0.0026566179003566504, -0.017589092254638672, -0.0005113582010380924, 0.014420708641409874, -0.006356325000524521, 0.03642989322543144, 0.003223797772079706, -0.001430173171684146, -0.009426918812096119, -0.0023062052205204964, 0.0029662849847227335, -0.005961907096207142, -0.007503723260015249, -0.00019242144480813295, 0.02056189626455307, 0.041410643607378006, 0.03335277736186981, 0.009531227871775627, 0.030718978494405746, 0.019284112378954887, 0.036534201353788376, 0.004449427593499422, 0.0013437923043966293, 0.012484475038945675, 0.0015939708100631833, -0.041567105799913406, -0.003500868333503604, 0.02197006717324257, -0.011826024390757084, -0.02251768857240677, -0.03632558509707451, 0.03233576565980911, 0.01950576901435852, -0.03285731002688408, 0.02336519956588745, 0.0033737418707460165, 0.009270455688238144, 0.029597658663988113, -0.006639915052801371, 0.008631563745439053, -0.0064997500739991665, -0.002413773676380515, 0.02271326817572117, -0.006740964483469725, 0.004970972426235676, -0.007888362742960453, -0.043992288410663605, -0.02745932526886463, -0.004599371924996376, -0.009466035291552544, 0.015972305089235306, 0.005238263867795467, 0.02894572727382183, -0.005456660874187946, 0.0048471055924892426, 0.0049840109422802925, -0.034004710614681244, 0.03301377594470978, -0.021487638354301453, -0.012067238800227642, -0.0245386753231287, 0.0013185300631448627, 0.011193651705980301, 0.019414499402046204, -0.026012038812041283, 0.004403792321681976, 0.05481434240937233, -0.010919841006398201, -0.006682290695607662, 0.0017080586403608322, -0.014681481756269932, 0.0028945726808160543, 0.019140688702464104, 0.05340617150068283, -0.024669060483574867, 0.01092636026442051, -0.0252818763256073, 0.015424682758748531, 0.029284730553627014, -0.010450450703501701, -0.014837944880127907, 0.012614861130714417, 0.023521663621068, 0.02598596177995205, 0.02048366516828537, 0.0009721918031573296, -0.032909467816352844, 0.0010952437296509743, 0.024877678602933884, -0.003663850948214531, -0.0012150360271334648, -0.05317147448658943, 0.0017585833556950092, 0.004540698137134314, 0.014472863636910915, 0.017576053738594055, -0.014472863636910915, 0.011871660128235817, 0.009733326733112335, 0.009231340140104294, 0.000419272982981056, 0.009133550338447094, 0.03473487123847008, -0.004706940148025751, 0.03371785953640938, -0.01931018941104412, -0.01170215755701065, -0.060916412621736526, -0.004394013434648514, -0.020470626652240753, 0.030797209590673447, -0.029545502737164497, 0.03486526012420654, -0.009276974946260452, 0.021161673590540886, 0.042818814516067505, -0.008755430579185486, 0.014329439029097557, -0.012562706135213375, -0.007601513061672449, 0.0510331429541111, -0.04221903905272484, -0.014772751368582249, 0.03217930346727371, 0.01809759810566902, 0.009407361038029194, 0.00406804820522666, 0.0037323038559406996, 0.001232149195857346, -0.015346450731158257, 0.01110238116234541, 0.032909467816352844, -0.007588474545627832, -0.013951319269835949, -0.030536437407135963, -0.01740655116736889, 0.001515739131718874, 0.01572457142174244, -0.008253443986177444, 0.03760336712002754, -0.013416735455393791, 0.016102690249681473, -0.008840181864798069, -0.0011685859644785523, -0.0033444049768149853, -0.01743263006210327, 0.015737609937787056, 0.008201288990676403, 0.027876559644937515, 0.00988978985697031, -0.0031781625002622604, -0.037629444152116776, -0.04159318283200264, -0.011252325028181076, 0.0023599895648658276, 0.01993604376912117, -0.018814722076058388, 0.022296033799648285, 0.02177448756992817, -0.02142244577407837, -0.034891337156295776, 0.0275897104293108, -0.03429155796766281, -0.019649194553494453, -0.00482754735276103, -0.0020715100690722466, 0.007575435563921928, 0.011252325028181076, 0.011669561266899109, -0.03528249263763428, -0.026233695447444916, 0.014381593093276024, -0.014407670125365257, -0.0040321918204426765, -0.013951319269835949, -0.033144161105155945, 0.07087791711091995, -0.02774617448449135, -0.015815841034054756, 0.009211782366037369, -0.01431640051305294, 0.012921268120408058, -0.012204144150018692, -0.01884079910814762, -0.032518308609724045, 0.015594184398651123, 0.002386066596955061, 0.031423065811395645, 0.0023110946640372276, 0.0077775344252586365, 0.024981988593935966, 0.024317018687725067, -0.0450875349342823, 0.00883366260677576, 0.01713274046778679, 0.017967212945222855, 0.015894072130322456, -0.014055627398192883, -0.020900901407003403, -0.012966903857886791, 0.0014725486980751157, 0.01860610395669937, 0.021370291709899902, 0.026233695447444916, 0.011858620680868626, 0.018267100676894188, -0.007712341379374266, -0.025334030389785767, -0.014837944880127907, 0.012386685237288475, -0.019010301679372787, 0.027381092309951782, -0.008631563745439053, -0.008559850975871086, 0.007875324226915836, 0.024669060483574867, -0.0007065300014801323, 0.005283899139612913, -0.03789021819829941, 0.03350924327969551, -0.008103500120341778, 0.008761949837207794, -0.005538152065128088, 0.020783552899956703, -0.019949082285165787, -0.009863712824881077, 0.010763376951217651, 0.005534892436116934, 0.013742701150476933, -0.02146156132221222, -0.006506269332021475, -0.009498631581664085, 0.01717185787856579, 0.01564633846282959, 0.011402269825339317, 0.01891903206706047, -0.023886743932962418, 0.015776725485920906, -0.038333531469106674, 0.018553949892520905, -0.02247857302427292, -0.03350924327969551, 0.012060719542205334, 0.014603249728679657, -0.041645340621471405, 0.03241400048136711, -0.02532099187374115, -0.01102415006607771, -0.0050198668614029884, -0.03734259679913521, -0.016089651733636856, 0.004791691433638334, -0.013084250502288342, 0.018892955034971237, -0.027537556365132332, 0.003569321008399129, -0.021239904686808586, -0.0028081918135285378, -0.01787594147026539, 0.005098098888993263, -0.00045879630488343537, -0.002395845716819167, 0.017915058881044388, -0.025412261486053467, -0.015242141671478748, 0.01226933766156435, -0.026755239814519882, 0.026663970202207565, 0.05867376923561096, -0.005502295680344105, 0.008625044487416744, -0.042975276708602905, -0.01459021121263504, 0.004074567463248968, 0.007549358531832695, 0.015111755579710007, 0.012536629103124142, 0.011304480023682117, 0.011030669324100018, -0.00071671640034765, -0.04214080795645714, -0.008540293201804161, -0.04717371240258217, -0.02161802537739277, -0.004495062865316868, 0.01035918015986681, 0.002821230562403798, -0.011969448998570442, 0.019923005253076553, 0.02863280102610588, 0.001918306341394782, 0.018658259883522987, -0.020666206255555153, 0.05716129019856453, 0.015828879550099373, -0.013508005999028683, 0.025764305144548416, -0.029545502737164497, -0.00359865790233016, 0.0028750146739184856, -0.016924124211072922, -0.007673225365579128, -0.013820933178067207, 0.02457779087126255, -0.017237050458788872, 0.005815222859382629, -0.04386190325021744, -0.00905531831085682, 0.017158817499876022, 0.03168383613228798, 0.01388612575829029, 0.02824164181947708, -0.0044070519506931305, 0.011297960765659809, -0.034161172807216644, -0.0009257417405024171, 0.02251768857240677, -0.04036755487322807, 0.006020580884069204, 0.0068061575293540955, 0.02146156132221222, -0.020848747342824936, 0.01872345246374607, -0.029050035402178764, -0.010430892929434776, -0.028111254796385765, -0.016259154304862022, 0.002263829577714205, -0.024447403848171234, 0.027094243094325066, -0.012608341872692108, 0.025073258206248283, -0.0035823597572743893, 0.006075995042920113, 0.01962311752140522, -0.005303456913679838, 0.03859430178999901, 0.003781198523938656, -0.002392586087808013, 0.023691164329648018, 0.03890722990036011, -0.011167574673891068, -0.012204144150018692, -0.0030445167794823647, -0.006173784378916025, -0.03113621473312378, -0.007920959033071995, 0.022921886295080185, -0.0021497418638318777, -0.0008792916778475046, -0.03238792344927788, -0.014798829331994057, 0.009087915532290936, 0.00015208323020488024, 0.009635536931455135, 0.031110137701034546, -0.023821551352739334, -0.013703585602343082, 0.009928906336426735, -0.004749315790832043, -0.018501795828342438, -0.013899164274334908, -0.0014130600029602647, 0.01012448500841856, 0.0026566179003566504, -0.02988450787961483, 0.01455109566450119, -0.0038235741667449474, 0.02871103212237358, -0.016024459153413773, 0.008162173442542553, 0.01513783261179924, 0.024864640086889267, -0.021096481010317802, 0.009746365249156952, -0.008018748834729195, 0.041801802814006805, -0.037238284945487976, 0.0006625246605835855, -0.0030282186344265938, -0.003148825606331229, -0.009765923023223877, -0.005903233308345079, 0.0254383385181427, -0.03502172231674194, 0.017993289977312088, 0.02839810587465763, -0.015946226194500923, -0.02107040397822857, 0.022074377164244652, -0.037551213055849075, -0.019909966737031937, 0.014616288244724274, -0.007053891196846962, 0.017628207802772522, -0.036768898367881775, 0.03429155796766281, 0.008422945626080036, 0.020157700404524803, -0.008807584643363953, -0.029858430847525597, 0.015933187678456306, 0.040237169712781906, 0.0057858857326209545, -0.004126721993088722, 0.01728920452296734, -0.004957933444529772, -0.05293678119778633, 0.0019346046028658748, -0.00566853815689683, -0.003712745849043131, -0.014042588882148266, -0.014186014421284199, 0.008220847696065903, 0.006714886985719204, 0.015463798306882381, -0.006157486233860254, -0.01572457142174244, -0.0020698802545666695, -0.04495714604854584, 0.001391872181557119, 0.010196197777986526, 0.03421332687139511, 0.007445049472153187, -0.021826643496751785, -0.008110019378364086, 0.0014203941682353616, -0.006235717795789242, -0.00203402410261333, -0.01997515931725502, 0.0043874941766262054, -0.041410643607378006, -0.004638487473130226, -0.030458206310868263, 0.000657227705232799, 0.018905993551015854, 0.01076989620923996, -0.004025672562420368, 0.01923195831477642, -0.014785789884626865, 0.018358370289206505, 0.001963941613212228, -0.006496490444988012, -0.01817583106458187, 0.00873587280511856, -0.020809629932045937, 0.00920526310801506, 0.020392395555973053, 0.011089342646300793, -0.0035888790152966976, -0.011826024390757084, 0.02661181427538395, -0.01069166511297226, 0.028372028842568398, 0.0012288895668461919, -0.024473482742905617, 0.04138456657528877, 0.005994503386318684, -0.007927478291094303, -0.035725805908441544, 0.02808517776429653, 0.02324785105884075, -0.022843655198812485, -0.0246169064193964, -0.0031064501963555813, 0.024682098999619484, -0.021904874593019485, 0.01876256801187992, 0.003543243743479252, -0.009733326733112335, -0.0015850067138671875, -0.0035660613793879747, -0.007712341379374266, 0.004126721993088722, 0.01997515931725502, 0.024199670180678368, -0.01662423461675644, -0.016402577981352806, -0.006304170936346054, 0.008677198551595211, 0.0502508245408535, 0.035725805908441544, -0.028658878058195114, 0.013768778182566166, -0.005499036051332951, 0.028919650241732597, -0.0007220133556984365, 0.013938279822468758, -0.024238787591457367, 0.030327821150422096, -0.030379975214600563, -0.0002552716468926519, -0.02114863507449627, 0.008383830077946186, 0.014172974973917007, 0.03658635541796684, -0.02064012922346592, -0.0016705726739019156, 0.010248351842164993, -0.03324846923351288, 0.04008070379495621, 0.019492730498313904, 0.009198743849992752, -0.016559042036533356, 0.018241023644804955, 0.019570961594581604, 0.0226611141115427, 0.01811063662171364, 0.04120202735066414, -0.03922015801072121, -0.028528491035103798, 0.004485283978283405, -0.001148213050328195, 0.02005339041352272, -0.004312522243708372, -0.030640747398138046, -0.04073263704776764, -0.00036935953539796174, -0.010313545353710651, -0.03530857339501381, -0.04386190325021744, 0.04190611094236374, 0.0036279947962611914, 0.016480810940265656, 0.013742701150476933, 0.0058543384075164795, 0.0252036452293396, -0.005365390330553055, -0.010561279021203518, -0.0275114793330431, -0.02013162337243557, 0.017354397103190422, 0.018201908096671104, -0.014968330971896648, -0.03567365184426308, -0.04159318283200264, -0.016519926488399506, 0.03343101218342781, -0.008188250474631786, 0.008774988353252411, -0.008794546127319336, -0.0047264983877539635, -0.00010471638233866543, -0.014616288244724274, -0.004863403737545013, -0.001452990691177547, 0.03147521987557411, 0.0008825513068586588, 0.038881152868270874, 0.040054626762866974, -0.03082328848540783, 0.008898855186998844, -0.0028701252304017544, 0.031266599893569946, 0.021761449053883553, 0.0018335552886128426, 0.022556805983185768, -0.021448522806167603, -0.009387803263962269, -0.038177065551280975, -0.0003237243799958378, 0.003383520757779479, 0.009316091425716877, 0.005743510089814663, 0.02808517776429653]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"1.
13
Riemannian Preconditioned LoRA
Before we begin the main proof, we need the following partial Frobenius norm which has been introduced in Section A.3 in
(Tong et al., 2021b) with some important properties studied there.
Definition B.1. (Partial Frobenius norm) For any matrix X, its partial Frobenius norm of order ris given by l2norm of
vectors composed by its top- rsingular values,
∥X∥F,r=vuutrX
i=1σ2
i(X).
Now we start the proof by first proving some useful lemmas.
Lemma B.2. Under Assumption 7.2, let Fi
0= [Ai
0, Bi
0]T, then the extented spectral initialization in Definition 7.3 satisfies
dist(Fi
0, Fi
⋆)≤10δi
2r√rκiσr(Xi
⋆).
Proof. According to Lemma 11 in (Tong et al., 2021b), since Ai
0Bi
0T−Xi
⋆has rank at most 2r,
dist(Fi
0, Fi
⋆)≤q√
2 + 1∥Ai
0Bi
0T−Xi
⋆∥F,
≤q
2(√
2 + 1)∥Ai
0Bi
0T−Xi
⋆∥F,r.
Since Ai
0Bi
0Tis the best rank rapproximation of CT
iY=PP
j=1CT
iCjXj
⋆. Then
∥Ai
0Bi
0T−Xi
⋆∥F,r≤ ∥PX
j=1CT
iCjXj
⋆−Ai
0Bi
0T∥F,r+∥PX
j=1CT
iCjXj
⋆−Xi
⋆∥F,r,
≤2∥(CT
iCi−I)Xi
⋆+X
j̸=iCT
iCjXj
⋆∥F,r,
≤2δi
2r∥Xi
⋆∥F+ 2X
j̸=i∥CT
iCjXj
⋆∥F,
where the last inequality follows Lemma 15 and inequality (50) in (Tong et al., 2021b). Therefore,
dist(Fi
0, Fi
⋆)≤5δi
2r∥Xi
⋆∥F+ 5X
j̸=i∥CT
iCjXj
⋆∥F,
≤10δi
2r∥Xi
⋆∥F≤10δi
2r√rκiσr(Xi
⋆).
Lemma B.3. (Contraction) Under assumption 7.2 with δi
2r≤0.01. If the t-th iterate satisfies dist(Fi
t, Fi
⋆)≤0.1σr(Xi
⋆)
where Fi
t= [Ai
t, Bi
t]T, then ∥Ai
tBi
tT−Xi
⋆∥F≤1.5dist(Fi
t, Fi
⋆). In addition, if the step size 0< η≤2/3, then the
(t+ 1) -th iteration Fi
t+1satisfies
max( dist(Fi
t+1, Fi
⋆))≤(1−0.5η) max( dist(Fi
t, Fi
⋆)).
Proof. We first show ∥Ai
tBi
tT−Xi
⋆∥F≤1.5dist(Fi
t, Fi
⋆).According to Lemma 9 in (Tong et al., 2021b), we know Qi
t,the
optimal alignment matrix between Fi
tandFi
⋆, i.e., the optimal value of problem (5) with Freplaced by Fi
tis attained at Qi
t,
exists, denote Ai=Ai
tQi
t, Bi=Bi
tQi
t−T,△i
A=Ai−Ai
⋆,△i
B=Bi−Bi","[-0.004434436559677124, -0.013412686064839363, 0.006462589837610722, 0.013787691481411457, -0.031225433573126793, -0.013987693935632706, -0.009006374515593052, -0.016937734559178352, -0.0664009228348732, 0.03440047800540924, 0.024887844920158386, 0.011137654073536396, -0.02531285025179386, -0.0006566497031599283, 0.040275558829307556, -0.016162723302841187, 0.024387838318943977, -0.03245044872164726, -0.03735051676630974, 0.034100472927093506, 0.0329754576086998, -0.02895040065050125, 0.03765052184462547, -0.0008468867163173854, -0.003800052683800459, -0.036300502717494965, 0.03867553547024727, 0.0004363341722637415, 0.047100652009248734, -0.03462548181414604, 0.011856414377689362, -0.02907540276646614, -0.010743899270892143, -0.04457561671733856, -0.05345074087381363, 0.04495062306523323, 0.001169547438621521, 0.030350420624017715, -0.012600175105035305, 0.023225322365760803, 0.010062639601528645, -0.003182856598868966, -0.07385102659463882, -0.0272503774613142, 0.01241267193108797, 0.018812760710716248, 0.030450422316789627, 0.021775301545858383, 0.0069188461638987064, 0.025875357910990715, -0.03197544440627098, 0.05255072936415672, -0.017425240948796272, -0.025125348940491676, -0.03802552819252014, 0.027600383386015892, 0.02630036510527134, 0.0368255116045475, 0.025137849152088165, -0.05220072343945503, 0.04375060647726059, 0.0019359643338248134, 0.03367546573281288, -0.01515020988881588, -0.049850691109895706, -0.007850108668208122, -0.05780080333352089, 0.019675273448228836, 0.060300834476947784, 0.030725426971912384, -0.09675133973360062, -0.0040781814604997635, 0.04655064642429352, 0.03270045295357704, 0.0086126197129488, -0.0043625603429973125, -0.01515020988881588, 0.055800773203372955, 0.08020111173391342, -0.038725536316633224, 0.027925387024879456, 0.011837664060294628, 0.07825108617544174, 0.009356379508972168, 0.03952554985880852, -0.04930068179965019, -0.030350420624017715, -0.0033625466749072075, -0.0676509365439415, -0.013725190423429012, 0.020037777721881866, -0.003073480213060975, 0.013875192031264305, 0.005778205115348101, 0.030950428918004036, -0.01114390417933464, 0.015250211581587791, 0.0011039215605705976, 0.03357546404004097, 0.02837539277970791, 0.0009711072198115289, 0.00944388099014759, 0.058600813150405884, -0.031550437211990356, 0.04180058091878891, 0.025512853637337685, 0.0017281490145251155, -0.008125112392008305, -0.017275240272283554, 0.017000235617160797, -0.005559451878070831, 0.03760052099823952, 0.009406380355358124, 0.010318893007934093, 0.009768885560333729, -0.058700814843177795, -0.07010097056627274, -0.024200335144996643, -0.024150334298610687, -0.01757524348795414, -0.001598459668457508, -0.00014101757551543415, 0.023562826216220856, 0.012431422248482704, -0.011243905872106552, -0.016287725418806076, 0.05380074679851532, -0.0574507974088192, -0.020037777721881866, -0.03210044652223587, 0.04617564007639885, 0.0332004614174366, 0.04252558946609497, 0.014687703922390938, -0.05185071751475334, 0.016525229439139366, 0.04297559708356857, 0.009906386956572533, 0.013012680225074291, -0.02700037509202957, 0.005071945488452911, -0.0030797303188592196, -0.008093861863017082, 0.014987708069384098, -0.023812830448150635, 0.020450282841920853, -0.05100070685148239, 0.01255017425864935, 0.005918832030147314, 0.018875261768698692, -0.0024047207552939653, -0.017412740737199783, -0.0014945520088076591, 0.024550341069698334, 0.004828191827982664, -0.020212780684232712, -0.006643841974437237, 0.027575382962822914, 0.03662550821900368, -0.0167127326130867, -0.008500117808580399, 0.0036875512450933456, -0.010806399397552013, 0.02121279388666153, 0.057750802487134933, 0.011206405237317085, -0.005946957506239414, 0.005237572826445103, -0.05755079910159111, -0.05645078420639038, 0.023775329813361168, -0.005381324794143438, -0.07270100712776184, -0.0009882949525490403, 0.03340046480298042, 0.022025305777788162, -0.03017541766166687, -0.023900331929326057, 0.038975540548563004, -0.044300615787506104, 0.030275419354438782, 0.020425282418727875, 0.01696273498237133, 0.037150513380765915, -0.03160043805837631, 0.04267559200525284, 0.0019031513947993517, -0.005918832030147314, 0.04750065878033638, 0.01695023477077484, 0.004896942991763353, 0.02496284618973732, 0.004128182306885719, 0.01805024966597557, -0.009193877689540386, -0.048300668597221375, 0.027675384655594826, 0.018225252628326416, -0.009012624621391296, 0.03990055248141289, 0.033125460147857666, 0.03437547758221626, -0.01332518458366394, 0.027225377038121223, -0.032900456339120865, -0.026600368320941925, 0.008712620474398136, 0.02195030450820923, -0.02352532558143139, -0.007118848618119955, 0.0048063164576888084, -0.000789464043918997, 0.02267531491816044, 0.04382560774683952, -0.012825177982449532, 0.04700065031647682, -0.051300711929798126, 0.03552549332380295, 0.021400297060608864, 0.05160071700811386, 0.001573459361679852, 0.003775052260607481, 0.0157502181828022, 0.003431297605857253, -0.02605036087334156, 0.017875248566269875, 0.046100638806819916, 0.005515701603144407, 0.04862567409873009, -0.05027569830417633, 0.055800773203372955, -0.00046406892943196, -0.011950165964663029, -0.024512840434908867, 0.03187544271349907, -0.06530090421438217, -0.034600481390953064, -0.05755079910159111, -0.014887706376612186, -0.03210044652223587, 0.012393921613693237, 0.04352560266852379, 0.004803191404789686, -0.04382560774683952, 0.013187683187425137, -0.0012406421592459083, -0.013950193300843239, 0.01828775368630886, 0.013100181706249714, 0.01048139575868845, 0.013462686911225319, 0.014262697659432888, 0.004112557042390108, -0.015775218605995178, -0.06645092368125916, 0.024387838318943977, 0.0027437880635261536, 0.008312615565955639, -0.040900565683841705, 0.03247544914484024, -0.04807566851377487, -0.025775358080863953, -0.041025567799806595, -0.0006968846428208053, 0.021300295367836952, 0.0077188569121062756, -0.013812691904604435, 0.03317546099424362, 0.013237684033811092, -0.013412686064839363, 0.011018902994692326, 0.04642564430832863, -0.002365657826885581, -0.0018219002522528172, -0.035950496792793274, 0.0056282030418515205, 0.015125209465622902, 0.014312698505818844, -0.037400517612695694, -0.010025138966739178, 0.031700439751148224, 0.03480048105120659, 0.030225418508052826, 0.018750259652733803, 0.007531354669481516, -0.04275059327483177, -0.03570049628615379, 0.00901887472718954, -0.02556285448372364, -0.013200183399021626, 0.04845067113637924, -0.03380046784877777, 0.042475588619709015, -0.0029203530866652727, -0.013000180013477802, -0.005378199741244316, -0.013075181283056736, -0.059450823813676834, 0.022450311109423637, 0.015212710946798325, 0.027800384908914566, 0.00017568602925166488, -0.003803177736699581, 0.03620050102472305, -0.04377560690045357, -0.002351595088839531, -0.0031641062814742327, 0.0241378340870142, -0.03080042637884617, 0.029375407844781876, 0.016937734559178352, 0.03917554393410683, -0.020062778145074844, -0.001264080055989325, -0.034850481897592545, -0.0272503774613142, 0.032775454223155975, -0.04470061883330345, -0.002615661360323429, 0.024300336837768555, -0.03330046311020851, -0.07125099003314972, -0.0053969500586390495, 0.004796941298991442, 0.0009039187571033835, 0.003418797394260764, -0.03222544863820076, -0.005578202195465565, -0.018925262615084648, -0.026850372552871704, -0.004421936348080635, -0.015837719663977623, 0.017712745815515518, -0.05005069449543953, -0.04977568984031677, 0.028450394049286842, -0.015187710523605347, 0.03695051372051239, 0.0329754576086998, 0.03505048528313637, -0.057250794023275375, -0.03635050356388092, 0.008856372907757759, 0.060550838708877563, -0.026100361719727516, 0.02263781428337097, 0.011437658220529556, -0.021137792617082596, 0.052300725132226944, 0.02423783577978611, -0.05055069923400879, -0.014075195416808128, 0.0062219612300395966, 0.00584695627912879, -0.03207544609904289, -0.00944388099014759, -0.013537688180804253, -0.04640064388513565, -0.04952568560838699, -0.020812788978219032, -0.011468908749520779, -0.009293878450989723, 0.036875512450933456, 0.009343879297375679, -0.0021828426979482174, 0.026700370013713837, 0.0003804740263149142, 0.017025236040353775, -0.0069500962272286415, 0.008350116200745106, -0.0193752683699131, 0.05820080637931824, -0.028875401243567467, -0.02496284618973732, -0.03827553242444992, -0.028300393372774124, 0.005890706554055214, 0.04205058142542839, 0.05075070261955261, -0.012543924152851105, 0.028500394895672798, -0.021987805142998695, 0.003356296569108963, 0.018225252628326416, -0.03260045126080513, 0.025775358080863953, -0.009856387041509151, -0.03190044313669205, -0.02167529985308647, 0.04012555629014969, 0.0078751090914011, -0.003218794707208872, -0.009818886406719685, 0.02907540276646614, -0.022725315764546394, -0.03017541766166687, 0.002885977504774928, 0.10360143333673477, 0.030225418508052826, 0.031675439327955246, -0.0015437713591381907, -0.031100431457161903, -0.05400075018405914, 0.007300101220607758, -0.046700648963451385, 0.006050083786249161, 0.008112612180411816, 0.08185113221406937, 0.005025069694966078, 0.00824386440217495, 0.007412602659314871, -0.010150141082704067, 0.036900512874126434, -0.013225183822214603, 0.04382560774683952, 0.010862650349736214, 0.002734412904828787, 0.040175557136535645, 0.004062556196004152, 0.020412782207131386, 0.018937762826681137, 0.039325546473264694, -0.018450256437063217, -0.020862789824604988, -0.052750732749700546, 0.027850385755300522, -0.004543812945485115, -0.012862678617238998, 0.03177544102072716, -0.06705092638731003, 0.011131403967738152, 0.03487548232078552, 0.031100431457161903, -0.005768829956650734, -0.05675078555941582, -0.0029937915969640017, 0.03405047208070755, 0.02397533319890499, 0.005243822932243347, -0.03080042637884617, -0.015912720933556557, 0.018750259652733803, -0.029525408521294594, -0.030375421047210693, 0.009518882259726524, 0.05310073494911194, -0.010775149799883366, -0.001820337725803256, -0.021375296637415886, 0.053250737488269806, -0.043225597590208054, -0.011062653735280037, 0.06680092960596085, -0.020212780684232712, 0.019937776029109955, -0.058350808918476105, 0.046475645154714584, -0.0010968901915475726, 0.024537840858101845, 0.0047906916588544846, 0.01830025389790535, -0.03237544745206833, -0.006981346756219864, -0.020750287920236588, -0.008650120347738266, 0.021650299429893494, 0.01745024137198925, -0.004493812099099159, -0.006581341382116079, -0.012525173835456371, -0.0015343963168561459, -0.06850095093250275, 0.04447561502456665, -0.0004230527556501329, -0.024437839165329933, 0.030625425279140472, 0.03450047969818115, -0.043325599282979965, 0.008556368760764599, 0.004603188950568438, 0.04232558608055115, -0.052650731056928635, -0.032525449991226196, 0.008043861947953701, 0.04867567494511604, 0.0523507259786129, 0.03600049763917923, 0.029525408521294594, 0.003428172552958131, 0.016325226053595543, 0.0022703439462929964, -0.01806274987757206, 0.0252128504216671, -0.013437686488032341, 0.008562618866562843, -0.039075542241334915, 0.0063000875525176525, -0.010868900455534458, -0.032550450414419174, 0.0235128253698349, 0.05710079148411751, 0.06240086629986763, 0.03480048105120659, 0.03990055248141289, -0.010981402359902859, 0.028675397858023643, 0.012681425549089909, -0.0201127789914608, -0.015050209127366543, 0.06945095956325531, 0.01126890629529953, 0.061000846326351166, 0.009856387041509151, 0.01109390426427126, -0.012775177136063576, 0.04787566512823105, -0.0192627664655447, 0.009225128218531609, -0.032525449991226196, 0.0006418057600967586, 0.0272503774613142, -0.012393921613693237, -0.024650340899825096, -0.026850372552871704, -0.00371255143545568, -0.007043847814202309, -0.05355074256658554, -0.08575119078159332, -0.03972554951906204, -0.0329754576086998, 0.029475409537553787, -0.0016453353455290198, -0.015325212851166725, -0.007550104521214962, -0.003403172129765153, -0.014612702652812004, -0.022112807258963585, -0.020575284957885742, -0.016687732189893723, -0.009112626314163208, -0.001979714957997203, -0.012325170449912548, 0.010525145567953587, -0.012587674893438816, 0.022700315341353416, -0.02920040488243103, 0.02617536298930645, 0.0011007965076714754, -0.011518909595906734, 0.032175447791814804, 0.0027531632222235203, -0.01012514065951109, -0.017725246027112007, -0.008425116539001465, -0.027200376614928246, 0.0052656978368759155, 0.011918915435671806, -0.005065695382654667, 0.04140057414770126, 0.019912775605916977, -0.005631328094750643, 0.008662620559334755, -0.009343879297375679, 0.0017234614351764321, -0.024637842550873756, 0.07090098410844803, -0.018437756225466728, -0.04055056348443031, 0.02001277729868889, 0.029400408267974854, -0.015675216913223267, -0.00584695627912879, -0.0017984624719247222, 0.0022125307004898787, 0.019850274547934532, -0.004928193520754576, 0.03987555205821991, -0.0025844108313322067, 0.012093917466700077, -0.0017531493213027716, -0.02058778516948223, -0.012456422671675682, -0.010762649588286877, 0.010931401513516903, -0.012012667022645473, -0.009562633000314236, -0.024387838318943977, -0.0037844274193048477, -0.006506340112537146, 0.020087778568267822, 0.007981360889971256, -0.008737620897591114, -0.019662773236632347, -0.0017390865832567215, -0.012381421402096748, -0.01091265119612217, -0.025500353425741196, 0.04712565243244171, 0.01757524348795414, 0.0052344477735459805, 0.019825274124741554, -0.0016140849329531193, 0.04520062729716301, -0.04325059801340103, -0.00517819682136178, -0.02146279811859131, -0.008006361313164234, 0.022587813436985016, 0.025150349363684654, 0.005759454797953367, 0.003221919760107994, 0.01768774539232254, 0.0018531506648287177, 0.03147543594241142, -0.0007750107324682176, -0.0058157057501375675, -0.005581327248364687, -0.01780024729669094, 0.0477006621658802, -0.0004765691119246185, 0.0025672230403870344, -0.01721273921430111, 0.015337713062763214, 0.024875344708561897, 0.010887650772929192, 0.02980041317641735, -0.006837594788521528, -0.022125307470560074, 0.004612564109265804, -0.022225307300686836, -0.00457818852737546, -0.01952527090907097, 0.021375296637415886, -0.005609452724456787, -0.03710051625967026, -0.01781274750828743, 0.04437561705708504, 0.03392546996474266, 0.021787801757454872, -0.03825053200125694, 0.04507562518119812, 0.023662827908992767, -0.012437672354280949, -0.034000471234321594, 0.04250058904290199, -0.016625231131911278, 0.005765704903751612, 0.021287795156240463, -0.05535076931118965, -0.02825039252638817, -0.03335046395659447, -0.026575367897748947, 0.04177558049559593, -0.021362796425819397, 0.03160043805837631, -0.04152557626366615, -0.008931374177336693, 0.014937707222998142, 0.011600160971283913, -0.040175557136535645, -0.023587826639413834, -0.03547549247741699, 0.014400199986994267, -0.0022359685972332954, 0.014612702652812004, -0.009675133973360062, 0.032050445675849915, 0.04620064049959183, 0.01683773286640644, -0.002131279557943344, 0.06505089998245239, 0.019800273701548576, -0.0006250086589716375, -0.00222815596498549, 0.00778135797008872, -0.030675426125526428, -0.025225350633263588, -0.02655036747455597, -0.018925262615084648, -0.013200183399021626, -0.03777552396059036, 0.01963777281343937, -0.01853775791823864, 0.005059445276856422, -0.01363768894225359, -0.014825205318629742, 0.011375158093869686, 0.006487589795142412, -0.01840025559067726, -0.042350586503744125, 0.01108140405267477, 0.005746954586356878, 0.044525615870952606, -0.04312559962272644, 0.02120029367506504, -0.006981346756219864, -0.013062681071460247, 0.011950165964663029, 0.008750121109187603, -0.034225475043058395, 0.017962748184800148, 0.03140043467283249, -0.017012735828757286, -0.03137543424963951, -0.049250684678554535, -0.014325198717415333, -0.012543924152851105, 0.014425200410187244, 0.07250100374221802, 0.0037313017528504133, 0.0024844093713909388, 0.005190697032958269, 0.009150126948952675, -0.014912706799805164, -0.00656884117051959, -0.0023953458294272423, 0.03257545083761215, 0.03245044872164726, -0.016300225630402565, -0.01235642097890377, -0.0157502181828022, -0.028275392949581146, -0.03257545083761215, 0.007250100374221802, 0.021362796425819397, -0.02727537788450718, -0.016625231131911278, 0.030600424855947495, -0.001153141027316451, 0.016762731596827507, -0.0027328503783792257, -0.005631328094750643, 0.01393769308924675, 0.008681369945406914, 0.005037569906562567, 0.007906359620392323, 0.015587716363370419, 0.021725300699472427, -0.02592535875737667, 0.008525118231773376, -0.01313768234103918, -0.05320073664188385, -0.017012735828757286, 0.017625244334340096, 0.03240044787526131, 0.004946943372488022, 0.034675482660532, 0.013500187546014786, -0.009893886744976044, 0.038475532084703445, -0.010812649503350258, 0.009450131095945835, -0.02218780852854252, -0.024012833833694458, 0.037000514566898346, -0.009975138120353222, -0.006178210489451885, 0.016275225207209587, -0.020800288766622543, 0.003531299065798521, -0.009025124832987785, 0.0006308681331574917, -0.0050281947478652, -0.0033469214104115963, 0.008031361736357212, 0.02337532490491867, -0.019412769004702568, -0.00136251887306571, 0.034100472927093506, -0.015550215728580952, -0.01721273921430111, 0.02001277729868889, 0.018487757071852684, -0.0056532034650444984, 0.033025458455085754, 0.02882540039718151, -0.036400504410266876, -0.014125196263194084, -0.026925373822450638, -0.01720023900270462, -0.0468006506562233, -0.015162710100412369, 0.002306282054632902, 0.029400408267974854, -0.02316282130777836, -0.005146946292370558, -0.008562618866562843, 0.017125237733125687, 0.03390046954154968, -0.0055875773541629314, 0.00021406546875368804, 0.0026578493416309357, -0.004831316880881786, 0.01192516554147005, 0.023700328543782234, 0.06770093739032745, -0.024662841111421585, -0.11930165439844131, -0.014275197871029377, 0.007450103294104338, 0.027775384485721588, 0.0005902425618842244, 0.014725204557180405, 0.03717551380395889, 0.03527548909187317, 0.016437727957963943, 0.008650120347738266, -0.011793913319706917, -0.021275294944643974, 0.0017797121545299888, 0.013000180013477802, 0.024387838318943977, -0.004918818362057209, 0.003681301139295101, 0.01901276409626007, 0.050475701689720154, 2.3755212168907747e-05, -0.012150168418884277, -0.006500090006738901, 0.02486284449696541, 0.045250628143548965, -0.01866275817155838, -0.02192530408501625, -0.003640675451606512, -0.05200072005391121, 0.003478173166513443, 0.03187544271349907, 0.009943887591362, 0.005603202618658543, 0.04485062137246132, 0.050350699573755264, 0.004312559962272644, 0.013987693935632706, 0.01780024729669094, 0.01272517628967762, 0.024325337260961533, 0.025362851098179817, -0.01793774962425232, -0.05480076000094414, 0.026950374245643616, -0.023000318557024002, 0.032900456339120865, -0.027575382962822914, 0.03755052015185356, -0.0536007434129715, 0.012256420217454433, 0.01902526430785656, 0.001101577770896256, 0.0021359671372920275, 0.0013007993111386895, 0.0013570500304922462, -0.004165682941675186, -0.011918915435671806, -0.02182530239224434, 0.008806372061371803, -0.011306406930088997, 0.01041264459490776, -0.019212765619158745, 0.010250141844153404, 0.07265100628137589, -0.027950387448072433, -0.029900414869189262, -0.026575367897748947, -0.02882540039718151, 0.017275240272283554, -0.02750038169324398, -0.030125418677926064, -0.0005195384728722274, -0.004893817938864231, -0.015687717124819756, -0.004350060131400824, 0.004450061824172735, -0.017775246873497963, -0.019550271332263947, 0.019050264731049538, -0.05170071870088577, -0.01065639778971672, 0.006103209685534239, 0.0018422130960971117, 0.017600243911147118, 0.02206280641257763, -0.02266281470656395, 0.004234433639794588, 0.007175099570304155, -0.037525519728660583, 0.02253781259059906, 0.00981263630092144, 0.02727537788450718, 0.026750370860099792, 0.008806372061371803, -0.01265642512589693, 0.004812566563487053, -0.012206419371068478, 0.024812843650579453, -0.020087778568267822, 0.011562660336494446, 0.0037500520702451468, 0.03360046446323395, 0.01865025795996189, -0.01496270764619112, -0.015287712216377258, -0.021650299429893494, -0.008568868972361088, 0.024437839165329933, -0.032675452530384064, 0.0035375491715967655, -0.043075598776340485, 0.010862650349736214, -0.010800150223076344, -0.017512742429971695, -0.01670023240149021, 0.017137737944722176, -0.014137696474790573, -0.006078209262341261, 0.03307545930147171, 0.012625175528228283, 0.0031547313556075096, -0.0016656480729579926, 0.01831275410950184, -0.003046917263418436, -0.009737635031342506, -0.022575313225388527, -0.025125348940491676, -0.013200183399021626, 0.03662550821900368, -0.019912775605916977, 0.0025812857784330845, 0.011043903417885303, -0.01853775791823864, 0.004493812099099159, 0.03522548824548721, 0.018450256437063217, 0.023925332352519035, 0.009806386195123196, -0.01363768894225359, -0.019487770274281502, 0.0017625244800001383, -0.0001510763104306534, -0.007050097920000553, 0.02337532490491867, 0.039825551211833954, -0.0018140876200050116, 0.0011859539663419127, -0.03692551329731941, -0.014950207434594631, 0.0007375102140940726, 0.037625521421432495, 0.027050375938415527, 0.020800288766622543, -0.00023867518757469952, -0.010768899694085121, -0.0038594284560531378, -0.0036000499967485666, -0.004225058481097221, 0.011018902994692326, -0.016437727957963943, 0.04302559792995453, 0.03850053250789642, 0.033025458455085754, 0.007812608033418655, -0.024037834256887436, 0.02680037170648575, -0.008768871426582336, -0.04480062052607536, -0.0241378340870142, 0.029900414869189262, 0.0030625425279140472, -0.013725190423429012, -0.06250086426734924, -0.009893886744976044, 0.04250058904290199, -0.013575187884271145, 0.01126890629529953, -0.013500187546014786, 0.015300212427973747, 0.008075111545622349, 0.021037790924310684, 0.0061250850558280945, 0.015612716786563396, -0.008343866094946861, -0.006087584421038628, 0.009675133973360062, -0.0015695530455559492, -0.0201127789914608, -0.010837649926543236, 0.01963777281343937, 0.027325378730893135, 0.03857553377747536, 0.029350407421588898, 0.021162793040275574, 0.010587646625936031, 0.02595035918056965, 0.0027547257486730814, 0.01852525770664215, 0.039775550365448, -0.011293906718492508, -0.04312559962272644, -0.03757552057504654, 0.054100751876831055, 0.008150112815201283, -0.042000580579042435, -0.007256350480020046, 0.0036313002929091454, 0.021062791347503662, -0.026925373822450638, 0.0034219224471598864, -0.02607536129653454, 0.029000401496887207, 0.009762635454535484, -0.02313782088458538, -0.006443839520215988, 0.036175500601530075, -0.04847567155957222, 0.001953152008354664, 0.021375296637415886, -0.015162710100412369, -0.0019469020189717412, -0.019537771120667458, -0.016175223514437675, -0.020212780684232712, 0.025525353848934174, 0.0055625769309699535, -0.0011312656570225954, 0.03345046564936638, -0.0287253987044096, -0.014450200833380222, -0.005690704099833965, -0.0317254401743412, 0.021787801757454872, -0.025137849152088165, -0.01332518458366394, -0.009518882259726524, 0.015687717124819756, 0.007143849041312933, -0.018562758341431618, -0.004384435713291168, -0.01758774369955063, 0.027075376361608505, 0.0007050879066810012, 0.0021734675392508507, 0.043700605630874634, -0.008068861439824104, 0.002176592592149973, 0.033500462770462036, 0.06460089236497879, -0.025250351056456566, 0.0005988364573568106, -0.03577549755573273, -0.010062639601528645, 0.011100154370069504, 0.0018781510880216956, 0.012643924914300442, 0.014450200833380222, 0.019575271755456924, 0.014975207857787609, 0.03177544102072716, 0.013075181283056736, -0.03905054181814194, 0.0278753861784935, -0.0012390796327963471, -0.002192217856645584, 0.010562646202743053, -0.044300615787506104, -0.007350102066993713, 0.01515020988881588, -0.012075167149305344, 0.0034375477116554976, -0.01333768479526043, -0.03220044821500778, 0.023075319826602936, -0.0023203447926789522, 0.005753204692155123, 0.00013281434075906873, 0.03792552649974823, 0.007343851961195469, 0.014787704683840275, -0.010887650772929192, -0.028750399127602577, -0.03765052184462547, -0.021837802603840828, -0.0029953541234135628, 0.025350350886583328, 0.004825066775083542, 0.015525215305387974, -0.03482548147439957, 0.020787788555026054, 0.055750772356987, 0.015425213612616062, 0.001906276447698474, -0.008400116115808487, -0.0028266017325222492, 0.04327559843659401, -0.016925234347581863, -0.01636272668838501, 0.01746274158358574, -0.01090015098452568, 0.014462700113654137, 0.014162695966660976, 0.007418852765113115, 0.0010125139961019158, -0.027450380846858025, 0.022812817245721817, 0.026350365951657295, 0.00956888310611248, -0.018137751147150993, -0.01950027048587799, -0.00688134552910924, 0.00681259436532855, -0.013412686064839363, 0.01987527497112751, 0.02630036510527134, 0.014987708069384098, -0.01313768234103918, -0.04025055840611458, -0.0053438241593539715, 0.023100320249795914, 0.0036344253458082676, 0.016200223937630653, 0.013887692242860794, 0.04592563584446907, 0.011956416070461273, -0.021150292828679085, 0.011012652888894081, -0.021300295367836952, -0.008500117808580399, -0.02885040082037449, 0.027650384232401848, -0.02386283129453659, 0.008937624283134937, 0.01855025812983513, -0.02352532558143139, -0.03427547588944435, 0.024200335144996643, -0.014337698929011822, -0.0029422282241284847, -0.02532535046339035, -0.008031361736357212, 0.02363782748579979, 0.030700426548719406, -0.001375019084662199, -0.03392546996474266, -0.02290031686425209, 0.01708773709833622, 0.02617536298930645, 0.015537715516984463, -0.019487770274281502, -0.012450172565877438, 0.07085098326206207, -0.01708773709833622, -0.010800150223076344, 0.05215072259306908, 0.01780024729669094, 0.013575187884271145, -0.004962568636983633, -0.022475311532616615, -0.00963138323277235, -0.005715704057365656, -0.025137849152088165, 0.017862748354673386, -0.01453770138323307, -0.0057500796392560005, -0.008650120347738266, 0.01853775791823864, -0.042575590312480927, -0.009468881413340569, -0.01888776198029518, 0.028675397858023643, 0.015975221991539, -0.022075306624174118, -0.00222815596498549, 0.018875261768698692, 0.015337713062763214, -0.00014795127208344638, -0.005193822085857391, 0.01647522859275341, -0.032300446182489395, 0.009131376631557941, 0.013362685218453407, 0.012568924576044083, -0.03225044906139374, -0.00527194794267416, -0.011037653312087059, 0.014675203710794449, -0.018762759864330292, 0.01363768894225359, -0.003443797817453742, 0.002390658250078559, -0.003456298029050231, -0.022150307893753052, -0.027725383639335632, 0.01565021649003029, 0.00542195001617074, -0.009943887591362, -0.02192530408501625, 0.025900358334183693, -0.01686273328959942, -0.005578202195465565, 0.0032281698659062386, 0.0035250489600002766, 0.025650355964899063, -0.008262614719569683, 0.0009812635835260153, -0.0030531673692166805, 0.012975179590284824, 0.022700315341353416, 0.02822539210319519, 0.011218905448913574, -0.018962763249874115, -0.014762704260647297, -0.019600272178649902, -0.006550090853124857, -0.01852525770664215, -0.018025249242782593, 0.0019750273786485195, -0.0009265753324143589, -0.04120057076215744, 0.01961277239024639, -0.02023778110742569, -0.013212683610618114, -0.02122529409825802, 0.004621939267963171, 0.023837830871343613, -0.006456339731812477, -0.0024594091810286045, 0.004275059327483177, -0.015000208280980587, -0.0043625603429973125, 0.010350143536925316, -0.001993777696043253, -0.010950151830911636, -0.0018625258235260844, -0.006643841974437237, 0.009718884713947773, 0.01952527090907097, -0.042600590735673904, -0.024387838318943977, 0.0317254401743412, -0.020537784323096275, 0.023175321519374847, 0.03330046311020851, -0.01683773286640644, 0.0038969290908426046, -0.01710023730993271, -0.004778191447257996, -0.013425186276435852, 0.014812705107033253, 0.015837719663977623, 0.009950137697160244, 0.013012680225074291, 0.056150779128074646, -0.012387671507894993, -0.025262849405407906, 0.016200223937630653, -0.043175600469112396, -0.01636272668838501, 0.00968763418495655, 0.0048469421453773975, 0.030625425279140472, -0.0209627915173769, 0.008218863978981972, 0.020450282841920853, -0.015012708492577076, 0.01878776028752327, -0.019950276240706444, 0.06485089659690857, 0.01661273092031479, 0.010831399820744991, 0.04580063372850418, -0.008400116115808487, 0.008050112053751945, 0.01483770553022623, 0.003009416628628969, -0.006109459791332483, 0.014887706376612186, 0.0038438031915575266, -0.005781330168247223, 0.0036906760651618242, -0.025275349617004395, -0.01406269520521164, 0.016800232231616974, 0.012900179252028465, 0.01406269520521164, -0.003900054143741727, 0.003606300102546811, -0.018725259229540825, -0.016400227323174477, -0.027650384232401848, 0.0005863362457603216, -0.017887748777866364, -0.01283767819404602, -0.0020109654869884253, 0.016437727957963943, -0.007450103294104338, 0.012256420217454433, -0.027300378307700157, -0.0037781773135066032, 0.015400213189423084, -0.01891276240348816, -0.015337713062763214, -0.029475409537553787, 0.03695051372051239, -0.022750316187739372, 0.017237739637494087, 0.005162571556866169, -0.016575230285525322, 0.029500409960746765, 0.01023139152675867, 0.03470047935843468, -0.0086126197129488, 0.008093861863017082, 0.011418907903134823, 0.039575546979904175, -0.01565021649003029, -0.03102543018758297, 0.020037777721881866, -0.01278142724186182, -0.010012638755142689, -0.007256350480020046, 0.008450116962194443, -0.011818913742899895, 0.01466270349919796, -0.036175500601530075, -0.01024389173835516, -0.03077542595565319, 0.00418443325906992, -0.0054407003335654736, 0.03292545676231384, -0.014387699775397778, -0.023600326851010323, 0.005718829110264778, 0.002103154081851244, -0.015337713062763214, 0.012418922036886215, 0.014600202441215515, 0.02582535892724991, 0.005243822932243347, -0.004890692885965109, 0.023087820038199425, 0.028925400227308273, 0.02050028368830681, -0.021350296214222908, 0.019912775605916977, 0.015387712977826595, 0.009250128641724586, -0.04050056263804436, 0.01283767819404602, 0.0021703424863517284, 0.06460089236497879, -0.015612716786563396, -0.012268920429050922, -0.006450089626014233, 0.008906373754143715, -0.02070028707385063, 0.01890026219189167, 0.009625133126974106, 0.0010757962008938193, 0.006687592715024948, 0.013437686488032341, -0.020625285804271698, 0.028750399127602577, 0.017025236040353775, -0.010681398212909698, 0.014562701806426048, 0.008975124917924404, 0.02170030027627945, 0.010068889707326889, -0.015787718817591667, 0.02155029959976673, -0.003381296992301941, 0.01673773303627968, -0.03442547842860222, -0.02375032939016819, 0.03437547758221626, 0.0007386821089312434, 0.026325365528464317, -0.022350309416651726, -0.011787663213908672, -0.015050209127366543, -0.030825426802039146, 0.006625091657042503, -0.009575133211910725, 7.480572821805254e-05, -0.014800204895436764, 0.007687606383115053, -0.019237766042351723, -0.05505076423287392, 0.012925179675221443, -0.02253781259059906, -0.025137849152088165, 0.03597549721598625, -0.02737537957727909, -0.0059500825591385365, 0.026350365951657295, 0.039925552904605865, 0.01696273498237133, -0.05175071582198143, -0.025225350633263588, -0.013800191693007946, 0.0031266058795154095, -0.014387699775397778, -0.011487659066915512, 0.005462575703859329, -0.017000235617160797, -0.013900192454457283, -0.01455020159482956, -0.000829698983579874, 0.019900275394320488, -0.012225169688463211, -0.0032625452149659395, -0.003628175240010023, -0.024900345131754875, 0.01115640439093113, -0.005740704480558634, 0.020037777721881866, 0.0013273621443659067, -0.012275170534849167, -0.009625133126974106, -0.009575133211910725, 0.007912609726190567, -0.001993777696043253, -0.009500131942331791, 1.7187738194479607e-05, 0.04167557880282402, -0.025175349786877632, -0.006375088356435299, -0.007837608456611633, -0.01121265534311533, 0.011712662875652313, 0.02312532067298889, 0.03147543594241142, -0.009293878450989723, 0.037150513380765915, 0.02133779600262642, 0.002873477293178439, -0.009837636724114418, 0.005353199318051338, -0.001979714957997203, 3.095746069448069e-05, -0.00794386025518179, 0.008268864825367928, 0.0030562924221158028, -0.012800177559256554, -0.03250044956803322, -0.006925095804035664, -0.008412616327404976, 0.007206350099295378, 0.01925026625394821, -0.005253197625279427, 0.011056403629481792, -0.021012790501117706, -0.009850136935710907, 0.030925428494811058, 0.0009031375520862639, -0.010393894277513027, 0.05015069618821144, 0.021975304931402206, 0.020037777721881866, 0.0022484685759991407, -0.013112681917846203, -0.002487534424290061, 0.016675231978297234, 0.006309462711215019, 0.029975416138768196, -0.02218780852854252, 0.0006879001739434898, -0.0013437686720862985, 0.026625368744134903, -0.029875414445996284, 0.025362851098179817, -0.01635022647678852, -0.02605036087334156, 0.038350529968738556, -0.002106279134750366, 0.016912734135985374, -0.01743774116039276, 0.03140043467283249, -0.00258909841068089, 0.02882540039718151, -0.0011679849121719599, 0.01345018669962883, -0.023675328120589256, -0.026875372976064682, 0.017237739637494087, -0.0287253987044096, 0.01938776858150959, 0.005565701983869076, -0.02035028301179409, -0.0038094278424978256, 0.019962776452302933, 0.0038063027895987034, -0.014912706799805164, -0.035675495862960815, 0.044300615787506104, 0.011018902994692326, 0.005796955432742834, 0.0007183693232946098, -0.015937721356749535, 0.039425548166036606, 0.016200223937630653, -0.001337518566288054, -0.012950179167091846, 0.0027328503783792257, 0.029750412330031395, 0.0038375533185899258, -0.007831358350813389, -0.018750259652733803, 0.009362629614770412, -0.006606341805309057, 0.013737690635025501, 0.02437533810734749, 0.004915693309158087, 0.0025203474797308445, -0.005521951708942652, 0.016212724149227142, 0.004103181883692741, -0.011493909172713757, -0.020575284957885742, 0.013212683610618114, 0.009950137697160244, 0.0017843997338786721, 0.033375464379787445, -0.017850248143076897, 0.006306337658315897, -0.01903776451945305, 0.03552549332380295, 0.03817553073167801, 0.017662744969129562, 0.0024062832817435265, -0.014700204133987427, -0.026825372129678726, -0.021287795156240463, 0.013375185430049896, 0.019575271755456924, 0.016687732189893723, 0.001008607679978013, 0.0065313405357301235]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"
⋆.By derivation (45) in (Tong et al., 2021b), we
further know for ϵ= 0.1,
∥△i
AΣi
⋆−1/2∥2∨ ∥△i
BΣi
⋆−1/2∥2≤ϵ,
14
Riemannian Preconditioned LoRA
where ∨denotes maximum. Note
∥Ai
tBi
tT−Xi
⋆∥F=∥AiBiT−Xi
⋆∥F
=∥△i
ABiT+Ai
⋆△i
BT∥F
=∥△i
A△i
BT+△i
ABi
⋆T+Ai
⋆△i
BT∥F
≤ ∥△i
A△i
BT∥F+∥△i
ABi
⋆T∥F+∥Ai
⋆△i
BT∥F
=∥△i
AΣi
⋆1/2∥F+∥△i
BΣi
⋆1/2∥F+∥△i
A△i
BT∥F
≤ ∥△i
AΣi
⋆1/2∥F+∥△i
BΣi
⋆1/2∥F+
1
2(∥△i
AΣi
⋆−1/2∥2∨ ∥△i
BΣi
⋆−1/2∥2)(∥△i
AΣi
⋆1/2∥F+∥△i
BΣi
⋆1/2∥F)
≤(1 +ϵ
2)(∥△i
AΣi
⋆1/2∥F+∥△i
BΣi
⋆1/2∥F)
≤(1 +ϵ
2)√
2dist(Fi
t, Fi
⋆)≤1.5dist(Fi
t, Fi
⋆).(7)
Note the second last inequality follows from dist(Fi
t, Fi
⋆) =q
∥△i
AΣi⋆1/2∥2
F+∥△i
BΣi⋆1/2∥2
F. We then proceed to show
the contraction of distance. By definition,
dist2(Fi
t+1, Fi
⋆)≤ ∥(Ai
t+1Qi
t−Ai
⋆)Σi
⋆1/2∥2
F+∥(Bi
t+1Qi
t−T−Bi
⋆)Σi
⋆1/2∥2
F.
Substitute the update rule for Li
t+1we get
(Ai
t+1Qi
t−Ai
⋆)Σi
⋆1/2= (Ai
tQi
t−ηCT
i(X
jCjAj
tBj
tT−Y)Bi
t(Bi
tTBi
t)−1Qi
t−Ai
⋆)Σi
⋆1/2
= (△i
A−ηCT
i(X
jCjAj
tBj
tT−Y)Bi
t(Bi
tTBi
t)−1Qi
t)Σi
⋆1/2
= (△i
A−ηCT
i(X
jCjAj
tBj
tT−Y)Bi(BiTBi)−1)Σi
⋆1/2
= (△i
A−ηCT
iCi(AiBiT−Xi
⋆)Bi(BiTBi)−1−ηCBi(BiTBi)−1)Σi
⋆1/2
where C=X
j̸=iCT
iCj(Aj
tBj
tT","[0.00692734494805336, -0.05021671578288078, 0.009090506471693516, 0.016965460032224655, -0.03596990928053856, 0.001955667743459344, -0.021239500492811203, -0.019187437370419502, -0.04334165155887604, 0.05369345843791962, -0.012998574413359165, -0.0067443582229316235, -0.050373561680316925, -0.0006649597198702395, 0.033643368631601334, 0.006437202449887991, 0.012423474341630936, -0.05311835557222366, -0.05270010232925415, 0.03936823084950447, -0.011913726106286049, -0.03304212912917137, 0.06587512791156769, 9.685416443971917e-05, -0.0010995526099577546, -0.038453299552202225, 0.03604833409190178, -0.014547424390912056, 0.04033544659614563, -0.03534252941608429, 0.03304212912917137, -0.02394508570432663, 0.02289944887161255, -0.07481532543897629, 0.008182109333574772, 0.08035720139741898, -0.006231342907994986, 0.04890966787934303, -0.003754490055143833, -0.003483277978375554, 0.012913616374135017, -0.016991600394248962, -0.0957280620932579, -0.040832120925188065, -0.04328937083482742, -0.017253009602427483, -0.004757648333907127, 0.03471514582633972, 0.022847168147563934, 0.019945524632930756, -0.02831062115728855, 0.038374874740839005, -0.012214346788823605, -0.025304414331912994, -0.03076786734163761, 0.00026814869488589466, 0.021631615236401558, 0.04527607932686806, 0.03563007712364197, -0.053196780383586884, 0.04998144507408142, -0.005875172559171915, 0.033277396112680435, -0.03076786734163761, -0.039080679416656494, -0.016704050824046135, -0.02245505340397358, 0.019945524632930756, 0.03881927207112312, 0.006420864257961512, -0.0543731227517128, 0.03220561891794205, 0.058973923325538635, -0.003159784246236086, 0.008724533021450043, 0.00821478571742773, 0.006639794446527958, 0.018233293667435646, 0.08061860501766205, -0.014599706046283245, 0.04752419888973236, 0.018664618954062462, 0.07544270902872086, 0.0030584880150854588, 0.028179915621876717, -0.044491853564977646, -0.04412587732076645, -0.0010358340805396438, -0.06943029165267944, -0.009515296667814255, 0.01653413474559784, 0.021213360130786896, 0.0221544336527586, -0.012286233715713024, 0.04185161739587784, -0.013933111913502216, 0.023304633796215057, -0.0010848483070731163, 0.019488058984279633, 0.013527927920222282, 0.02353990264236927, -0.027474110946059227, 0.03842715919017792, -0.018337858840823174, 0.018782254308462143, 0.014547424390912056, -0.025853373110294342, -0.026546107605099678, -0.04553749039769173, 0.029879076406359673, 0.003993025980889797, 0.017671264708042145, 0.008848702535033226, 0.0024049649946391582, 0.022520406171679497, -0.04224373400211334, -0.058189697563648224, -0.013671702705323696, -0.04890966787934303, -0.021422486752271652, 0.003496348625048995, -0.01495260838419199, 0.01876918412744999, -0.02901642583310604, 0.0029065439011901617, -0.0335126630961895, 0.022128291428089142, -0.05839882418513298, -0.0450669527053833, -0.05604613944888115, 0.07654062658548355, 0.014011534862220287, 0.027317265048623085, 0.0027415293734520674, 0.0002971487701870501, 0.02114800736308098, 0.0391068235039711, 0.05123621225357056, 0.014808833599090576, -0.035290248692035675, 0.01880839467048645, 0.02357911318540573, -0.013841618783771992, 0.009266957640647888, -0.022651109844446182, 0.03717239201068878, -0.03406162187457085, -0.028362901881337166, 0.010815807618200779, -0.015044101513922215, -0.0050125219859182835, 0.0022856970317661762, -0.03183964639902115, 0.005411171354353428, -0.0029816990718245506, -0.009247351437807083, -0.010874624364078045, 0.04111967235803604, 0.02275567315518856, -0.0013421730836853385, -0.04909265413880348, 0.040910545736551285, -0.025043005123734474, 0.012867869809269905, 0.03194420784711838, 0.014233732596039772, -0.012331980280578136, 0.019383495673537254, -0.0722535103559494, -0.0543731227517128, 0.01701774075627327, -0.019932454451918602, -0.062319960445165634, -0.02752639353275299, 0.027474110946059227, 0.010528257116675377, 0.013946183025836945, -0.04472712054848671, 0.0165733452886343, 0.021095724776387215, 0.04004789516329765, 0.04153792932629585, 0.0023853592574596405, 0.05369345843791962, -0.024755455553531647, 0.04935406520962715, 0.0022317813709378242, 0.04553749039769173, 0.016586415469646454, -0.0015276102349162102, 0.021422486752271652, 0.0350026972591877, 0.03832259401679039, 0.015031031332910061, -0.003774095792323351, -0.04553749039769173, 0.03411390632390976, 0.0027202898636460304, 0.03996947407722473, 0.028441324830055237, 0.05463453009724617, 0.02539590746164322, 0.005894778296351433, 0.0035551656037569046, -0.036780279129743576, -0.020389920100569725, -0.010044650174677372, -0.0014442860847339034, -0.035813067108392715, 0.0052347201853990555, -0.009371520951390266, 0.014874185435473919, 0.012704488821327686, 0.021422486752271652, -0.026454614475369453, 0.0424528606235981, -0.02875501662492752, 0.051968157291412354, -0.036074474453926086, 0.044230442494153976, -0.00280198035761714, -0.003666264470666647, 0.019723327830433846, 0.017226869240403175, -0.030637161806225777, 0.02964380756020546, 0.05076567456126213, -0.007182218600064516, 0.012933221645653248, -0.057039495557546616, 0.043184805661439896, 0.020193863660097122, -0.03719853609800339, -0.021461699157953262, 0.05463453009724617, -0.026350051164627075, -0.018651548773050308, -0.03440145403146744, -0.01963183283805847, -0.013697843998670578, 0.008077545091509819, 0.043367791920900345, 0.02398429811000824, -0.02789236605167389, -0.005038662813603878, -0.011417048051953316, -0.0006960020982660353, -0.0019458649912849069, 0.0051562972366809845, -0.0037054759450256824, -0.026637600734829903, 0.0010301157599315047, 0.024154214188456535, -0.02022000402212143, -0.07622693479061127, 0.04164249077439308, -0.018821464851498604, 0.01631193608045578, -0.007685431744903326, 0.04498852789402008, -0.042139168828725815, -0.016847824677824974, -0.03076786734163761, -0.032310180366039276, 0.025761879980564117, 0.011554288677871227, 0.015292440541088581, 0.04166863113641739, 0.026023289188742638, -0.0015169904800131917, 0.006492752116173506, 0.05557560548186302, -0.010142678394913673, -3.372281207703054e-05, -0.036257460713386536, 0.006567907053977251, -0.0062607512809336185, 0.04498852789402008, -0.018756112083792686, -0.0034767428878694773, 0.007358670234680176, 0.009214675985276699, 0.02804921194911003, 0.002922882093116641, 0.032414745539426804, -0.05515734851360321, -0.025526611134409904, 0.014665057882666588, -0.024598609656095505, -0.01903059333562851, 0.02998363971710205, -0.017671264708042145, 0.025539683178067207, 0.017004670575261116, -0.019671045243740082, -0.009802846238017082, -0.0152662992477417, -0.047759465873241425, -0.004048575647175312, 0.016181232407689095, 0.015031031332910061, -0.0006727203144691885, -0.0021566262003034353, 0.04451799392700195, -0.024010438472032547, 0.0017792165745049715, 0.002857529791072011, 0.024886159226298332, -0.012900546193122864, 0.005463453009724617, 0.029748370870947838, 0.06425438821315765, -0.033538803458213806, 0.0176843348890543, -0.04049229249358177, -0.02778780274093151, 0.003613982582464814, -0.037930481135845184, 0.021056514233350754, -0.0202984269708395, 0.008724533021450043, -0.038557861000299454, -0.032754577696323395, -0.017187656834721565, -0.01508331298828125, -0.008097151294350624, -0.013364546932280064, -0.004391675349324942, -0.02261189930140972, -0.039786484092473984, -0.010939976200461388, 0.009567578323185444, 0.04412587732076645, -0.022062938660383224, -0.016037456691265106, 0.025631176307797432, -0.03445373848080635, 0.04898809269070625, 0.01880839467048645, 0.03050645813345909, -0.054163992404937744, -0.016468781977891922, -0.004708633758127689, 0.04287111386656761, 0.014364437200129032, -0.003852518741041422, 0.044674839824438095, -0.02726498432457447, 0.060280971229076385, 0.04166863113641739, -0.027683237567543983, -0.0068881334736943245, 0.008129827678203583, 0.007495909929275513, -0.03552551567554474, -0.01772354543209076, 0.018573125824332237, -0.0491710789501667, -0.0606992244720459, -0.018873747438192368, -0.019710255786776543, -0.03312055021524429, 0.057666879147291183, 0.0152662992477417, -0.004885084927082062, 0.02815377525985241, 0.02130485326051712, 0.039080679416656494, 0.007718107663094997, -0.016037456691265106, -0.002153358655050397, 0.041093531996011734, -0.03745994344353676, -0.010384482331573963, -0.055993858724832535, -0.036884844303131104, 0.032231759279966354, 0.013998464681208134, 0.040021754801273346, 0.004502774216234684, -0.01933121308684349, -0.01846856251358986, -0.018560055643320084, 0.02614092454314232, -0.01891295798122883, 0.03434917330741882, -0.027604814618825912, -0.029173271730542183, -0.04093668609857559, -0.0009933550609275699, 0.04606030881404877, -0.0210434440523386, 0.003525756997987628, 0.0495370514690876, -0.021291783079504967, -0.04621715471148491, 0.019749468192458153, 0.08537625521421432, 0.018442422151565552, 0.0251344982534647, 0.0016076668398454785, -0.032754577696323395, -0.05395486578345299, -0.021069584414362907, -0.037224676460027695, 0.005685650743544102, 0.0312906838953495, 0.059758152812719345, 0.0012858066475018859, 0.04451799392700195, 3.8394482544390485e-05, -0.01642957143485546, 0.01806337758898735, -0.020246146246790886, 0.014965678565204144, -0.01977560855448246, 0.004159674514085054, 0.05181131139397621, 0.009646001271903515, 0.012286233715713024, -0.007522050756961107, 0.0547390952706337, -0.009567578323185444, -0.0006915091071277857, -0.0610651969909668, 0.037669070065021515, 0.013161955401301384, 0.02186688221991062, 0.025971008464694023, -0.06577056646347046, 0.007757319137454033, 0.03630974143743515, 0.005780411884188652, 0.02763095684349537, -0.038976117968559265, 0.013312265276908875, 0.008665716275572777, 0.004610605537891388, 0.0026451346930116415, -0.018115660175681114, -0.007711572572588921, -0.028728874400258064, -0.005724862217903137, 0.0052510579116642475, 0.009057830087840557, 0.0715215653181076, 0.016102809458971024, -0.014089957810938358, -0.0019638368394225836, 0.046949099749326706, -0.05311835557222366, -0.02442869357764721, 0.04867440089583397, 0.00960678979754448, -0.03414004668593407, -0.047393493354320526, 0.03296370431780815, 0.015227087773382664, 0.02797078900039196, -0.0046367463655769825, 0.028911860659718513, -0.026611460372805595, 0.011756880208849907, -0.03246702626347542, 0.000952509930357337, 0.015893680974841118, 0.03429689258337021, 0.007410951890051365, -0.011266738176345825, 0.011475865729153156, -0.014024605974555016, -0.0629473477602005, 0.030976993963122368, -0.01085501816123724, -0.022703392431139946, 0.04517151787877083, 0.015070242807269096, -0.03168280050158501, -0.009449943900108337, 0.027029715478420258, 0.04185161739587784, -0.05970586836338043, -0.020507555454969406, -0.005613763350993395, 0.019880171865224838, 0.10377946496009827, 0.035734642297029495, -0.014965678565204144, 0.02092580869793892, -0.02469010278582573, 0.0032316716387867928, -0.0028395578265190125, 0.03868856653571129, -0.01508331298828125, -0.004878549836575985, -0.004238097462803125, -0.02171003632247448, -0.018873747438192368, -0.02223285473883152, -0.02982679381966591, 0.0506611093878746, 0.03338196128606796, 0.036074474453926086, 0.02930397540330887, -0.020285356789827347, -0.026820586994290352, 0.023252351209521294, -0.025722669437527657, -0.014194521121680737, 0.017893461510539055, 0.005832693539559841, 0.032832998782396317, 0.04015246033668518, 0.0035224894527345896, -0.005875172559171915, 0.021592402830719948, -0.014547424390912056, 0.013540998101234436, -0.009502225555479527, 0.0055876225233078, 0.012822123244404793, -0.01765819452702999, 0.004682492930442095, -0.022651109844446182, 0.0077834599651396275, -0.0028297549579292536, -0.027395687997341156, -0.056987214833498, -0.04036158695816994, -0.018233293667435646, 0.03772135451436043, -0.003221868770197034, -0.035394810140132904, 0.04454413428902626, -0.016298865899443626, -0.00988780427724123, -0.014351367019116879, -0.03743380308151245, -0.013802407309412956, -0.007861882448196411, 0.028284478932619095, -0.0061953989788889885, 0.004388407338410616, 0.012763305567204952, 0.017906533554196358, -0.020167723298072815, 0.009482620283961296, -0.008031798526644707, -0.0011077215895056725, 0.030846290290355682, 0.004440689459443092, -0.004767450969666243, -0.028964143246412277, -0.001849470310844481, -0.02164468541741371, -0.005453650373965502, 0.02901642583310604, -0.011854908429086208, 0.011560823768377304, 0.021540120244026184, -0.010292988270521164, 0.009946621023118496, 0.009012083522975445, -0.022951731458306313, -0.03701554611325264, 0.08239619433879852, -0.02450711652636528, -0.030375752598047256, 0.017004670575261116, 0.017043882980942726, -0.029330115765333176, 0.008110221475362778, -0.005881707649677992, 0.015671484172344208, -0.0002873459307011217, -0.012501896359026432, 0.0681232437491417, 0.007705037482082844, -0.008966336958110332, -0.020938880741596222, -0.037041690200567245, -0.004221759270876646, -0.007789995055645704, 0.020246146246790886, -0.0454329252243042, 0.014129169285297394, -0.025709599256515503, 0.007620079442858696, -0.022821025922894478, 0.01253457274287939, 0.021801529452204704, -0.005760806147009134, -0.00039558569551445544, 0.002638599369674921, 0.0029686286579817533, 0.018298646435141563, -0.036518871784210205, 0.036335885524749756, 0.0022236122749745846, 0.007306388113647699, 0.022559616714715958, -0.018037237226963043, 0.02547433041036129, -0.01653413474559784, -0.02998363971710205, -0.013024714775383472, 0.00839777197688818, -0.010162283666431904, 0.0008414110052399337, -0.002076569711789489, 0.007077655289322138, 0.006512357387691736, 0.023226210847496986, 0.02138327620923519, 0.004166209604591131, -0.013763196766376495, 0.003676067339256406, -0.02063825912773609, 0.05374573916196823, -0.012560714036226273, 0.002400063443928957, -0.0342707522213459, 0.0076462202705442905, 0.0271865613758564, 0.007312923204153776, 0.049929164350032806, -0.026755236089229584, -0.023566043004393578, 0.013658632524311543, -0.014050746336579323, -0.024964582175016403, -0.009221211075782776, 0.008574223145842552, -0.02406272105872631, -0.053196780383586884, 0.01437750831246376, -2.284778020111844e-05, 0.05060882866382599, 0.015501568093895912, -0.04517151787877083, 0.043001819401979446, 0.037486083805561066, 0.00047094508772715926, -0.05635983124375343, 0.0447009801864624, -0.007744248490780592, 0.006067961920052767, 0.010181889869272709, -0.049327921122312546, -0.032048773020505905, -0.010423692874610424, -0.037747494876384735, 0.02633698098361492, 0.010221101343631744, 0.024637820199131966, -0.03233632072806358, -0.0149003267288208, -0.0065188929438591, -0.010083861649036407, -0.04901423305273056, -0.0023510493338108063, -0.001965470612049103, -0.008593828417360783, 0.010371411219239235, 0.008221320807933807, 0.0031205727718770504, 0.023958155885338783, 0.025631176307797432, 0.00571832712739706, 0.014743480831384659, 0.06969170272350311, 0.03095085360109806, -0.019840961322188377, 0.022141361609101295, 0.012782911770045757, -0.023226210847496986, -0.013841618783771992, -0.034767430275678635, -0.035813067108392715, 0.0029571920167654753, -0.02633698098361492, 0.003731616772711277, -0.012240487150847912, 0.006835851352661848, -0.00899247732013464, -0.025539683178067207, 0.01041062269359827, 0.006659400183707476, -0.020350709557533264, -0.017788898199796677, -0.01416838075965643, 0.002908177673816681, 0.053798019886016846, -0.03926366567611694, 0.015553849749267101, -0.001239243196323514, 0.0038917299825698137, 0.009907410480082035, 0.014207592234015465, -0.02201065793633461, -0.0046236757189035416, 0.020625188946723938, -0.015109454281628132, 0.0011943134013563395, -0.04420430213212967, -0.024860018864274025, 0.007456698454916477, 0.02744797058403492, 0.07031908631324768, -0.024219565093517303, -0.0023967958986759186, 0.000692734494805336, -0.008907519280910492, -0.010423692874610424, 0.012135923840105534, 0.013279588893055916, 0.025866443291306496, 0.05991499871015549, -0.0058490317314863205, -0.017867321148514748, 0.008312813937664032, -0.017004670575261116, -0.039315950125455856, -0.007463233545422554, 0.002014484954997897, -0.03393092006444931, -0.02368367649614811, 0.016403429210186005, 0.01316849049180746, -0.006316300481557846, 0.00957411341369152, 0.009789776057004929, 0.002618993865326047, 0.018442422151565552, -0.01616816036403179, 0.027552533894777298, -0.016037456691265106, 0.01612894982099533, -0.04033544659614563, 0.01539700385183096, 0.001980175031349063, -0.04673997312784195, -0.027840083464980125, 0.017070023342967033, 0.03596990928053856, 0.0028624311089515686, 0.024755455553531647, 0.03461058437824249, -0.001077496213838458, 0.0361267551779747, -0.019344283267855644, 0.01039101742208004, -0.0312906838953495, -0.03518568351864815, 0.005751003045588732, 0.01568455435335636, 0.005659509915858507, 0.011083751916885376, -0.016965460032224655, -0.016194302588701248, 0.010103466920554638, -0.009659071452915668, -0.0027644026558846235, -0.015200947411358356, -0.01041062269359827, 0.022585758939385414, -0.03458444029092789, -0.016926247626543045, 0.026899009943008423, -0.024820806458592415, -0.012475755997002125, 0.01104454044252634, 0.01669098064303398, 0.0075024450197815895, 0.04166863113641739, 0.01225355826318264, -0.022964801639318466, -0.019657975062727928, -0.0028379240538924932, -0.012338516302406788, -0.01791960373520851, 0.005708524025976658, 0.01230583991855383, 0.01735757291316986, -0.014442860148847103, -0.008613434620201588, -0.01180262677371502, 0.0026712757535278797, -0.011136033572256565, -0.0011559189297258854, -0.00815596804022789, -0.02841518446803093, 0.0027202898636460304, 0.0014736945740878582, 0.015671484172344208, 0.04645242169499397, -0.02110879495739937, -0.10336121171712875, 0.005401368252933025, 0.013658632524311543, 0.025683457031846046, -0.004502774216234684, 0.003829645225778222, -0.009358450770378113, -0.0034440667368471622, 0.04036158695816994, -0.012135923840105534, -0.011848373338580132, -0.0312906838953495, -0.022768745198845863, 0.002391894580796361, -0.0004901423235423863, 0.011848373338580132, 0.0011085385922342539, 0.023827452212572098, 0.04820386320352554, 0.0025814161635935307, -0.006901203654706478, 0.0028085154481232166, 0.025905655696988106, 0.0270035732537508, -0.06017640605568886, -0.01482190378010273, 0.017775828018784523, -0.0413287989795208, -0.013606350868940353, 0.012135923840105534, 0.01846856251358986, 0.002552007557824254, 0.05479137599468231, 0.03236246481537819, 0.006901203654706478, -0.003069924656301737, -0.0061953989788889885, 0.03050645813345909, 0.014848045073449612, 0.011129498481750488, -0.0011706232326105237, -0.05042584240436554, 0.03936823084950447, 0.002512796316295862, 0.02833676151931286, -0.033983200788497925, 0.01124713197350502, -0.05351047217845917, 0.02364446595311165, -0.004734774585813284, 0.00970481801778078, 0.01083541288971901, -0.000652297749184072, -0.015436215326189995, -0.017422925680875778, -0.00899247732013464, -0.030297329649329185, 0.015553849749267101, -0.013828548602759838, 0.008038333617150784, -0.02118721790611744, 0.023788239806890488, 0.05243869125843048, -0.01639035902917385, -0.013259983621537685, -0.01586754061281681, -0.021291783079504967, 0.028206055983901024, -0.019004451110959053, -0.00957411341369152, 0.010011973790824413, -0.022245926782488823, -0.039681922644376755, -0.006692076567560434, 0.0042348294518888, 0.0008626504568383098, -0.028127633035182953, -0.0042903791181743145, -0.030401894822716713, -0.008188644424080849, 0.022428913041949272, 0.010959582403302193, 0.024297988042235374, 0.02584030292928219, -0.0040224348194897175, -0.002553641563281417, 0.007038443814963102, -0.022559616714715958, 0.016730191186070442, 0.01597210392355919, 0.02289944887161255, 0.0413549430668354, 0.024088861420750618, -0.012443079613149166, 0.01717458665370941, -0.010123073123395443, 0.007025373168289661, -0.01828557625412941, -0.021919164806604385, 0.013423364609479904, 0.021540120244026184, 0.00510074757039547, 0.0210434440523386, -0.0009704817784950137, -0.027813943102955818, 0.005708524025976658, 0.029094848781824112, -0.02491229958832264, 0.022821025922894478, -0.050478123128414154, 0.013527927920222282, -0.007044978905469179, -0.0023249085061252117, 0.0001567434228491038, 0.015449285507202148, 0.008495800197124481, -0.009378056041896343, 0.013933111913502216, 0.006143116857856512, -0.013024714775383472, 0.014155310578644276, 0.0135017866268754, 0.01547542680054903, -0.004747845232486725, -0.002999671036377549, 0.006613653618842363, -0.010456369258463383, 0.03332967683672905, -0.020102370530366898, 0.022742602974176407, 0.019004451110959053, 0.0018445688765496016, -0.009260422550141811, -0.004862211644649506, 0.04647856205701828, 0.03795662149786949, 0.013253448531031609, -0.017422925680875778, 0.0060222153551876545, 0.011495471000671387, -0.013554069213569164, 0.00213211914524436, -0.03113383986055851, -0.0074501633644104, -0.012573784217238426, 0.013998464681208134, -0.030218908563256264, -0.0135017866268754, -0.023709816858172417, 0.05332748591899872, 0.04569433629512787, -0.0038557862862944603, 0.011554288677871227, 0.006757428869605064, 0.003234939416870475, 0.001795554650016129, 0.008776814676821232, -0.00988780427724123, -0.006966555956751108, 0.036100614815950394, 0.03173508122563362, 0.05630755051970482, -0.0018216955941170454, -0.010815807618200779, 0.04010017588734627, 0.0005930722109042108, -0.046687688678503036, -0.022860238328576088, 0.01940963603556156, -0.012508432380855083, -0.02182767167687416, -0.05829425901174545, -0.014312155544757843, 0.025082215666770935, -0.023330774158239365, 0.01403767615556717, 0.013410293497145176, -0.002630430506542325, 0.010325664654374123, 0.007672361098229885, -0.0007143824477680027, 0.008855237625539303, -0.006179060786962509, -0.00897287204861641, 0.009149323217570782, -0.012900546193122864, 0.015540779568254948, 0.009646001271903515, 0.02410193160176277, 0.03526410460472107, 0.05981043353676796, 0.023265421390533447, 0.024925371631979942, 0.033721789717674255, 0.06284277886152267, 0.017370643094182014, 0.0008013827027752995, 0.05202043801546097, -0.005270663648843765, -0.048020876944065094, -0.011809161864221096, 0.06430666893720627, 0.01828557625412941, -0.038557861000299454, 0.011449724435806274, 0.030898571014404297, 0.025931796059012413, -0.013893901370465755, 0.025304414331912994, -0.021906094625592232, 0.03147367388010025, 0.01245614979416132, -0.017632052302360535, -0.006561371963471174, 0.028179915621876717, -0.010253777727484703, 0.004793591797351837, 0.005721594672650099, -0.0026663742028176785, -0.0035976446233689785, -0.011959472671151161, -0.022036798298358917, 0.01631193608045578, 0.0142468037083745, -0.010495580732822418, -0.0068097105249762535, 0.01869076117873192, 0.000838960288092494, -0.019200507551431656, 0.0031320094130933285, -0.024860018864274025, 0.04119809716939926, -0.04229601472616196, -0.012168600223958492, -0.0003420785069465637, 0.021474769338965416, 0.010730849578976631, -0.014063816517591476, -0.018011096864938736, -0.010685103014111519, 0.036518871784210205, -0.0031205727718770504, 0.008247461169958115, 0.025225991383194923, -0.022115221247076988, -0.001450821291655302, 0.02144862711429596, 0.058085132390260696, -0.026232417672872543, -0.007750784046947956, -0.020873527973890305, 0.03191806748509407, -0.0017171319341287017, 0.012763305567204952, 0.009175464510917664, 0.01243654452264309, 0.00949569046497345, 0.004247900098562241, 0.0383487343788147, -0.011737274937331676, -0.012162065133452415, 0.003669532248750329, -0.005983003880828619, -0.007888023741543293, -0.01245614979416132, -0.05019057169556618, -0.019226649776101112, 0.005162832327187061, -0.010489045642316341, 0.012599925510585308, -0.018873747438192368, 0.009306169115006924, 0.011417048051953316, 0.01403767615556717, 0.009502225555479527, 0.0003700574452523142, 0.04488396644592285, 0.0165733452886343, 0.014076887629926205, -0.020128510892391205, -0.021357133984565735, -0.04211302846670151, -0.02316085807979107, -0.007561262231320143, 0.012874404899775982, 0.017253009602427483, 0.04551134631037712, 0.009717888198792934, 0.03615289926528931, 0.04234829545021057, -0.003796969074755907, -0.0030486851464957, -0.004581196699291468, -0.0052216495387256145, 0.013142349198460579, -0.014338296838104725, -0.009325774386525154, 0.019200507551431656, -0.021213360130786896, 0.007430557627230883, 0.003027445636689663, 0.02428491786122322, 0.011691528372466564, -0.05568016692996025, 0.020363779738545418, 0.027395687997341156, 0.0023837254848331213, -0.005483058746904135, -0.048099298030138016, -0.00813636276870966, -0.014233732596039772, 0.003852518741041422, 0.029931357130408287, 0.02152705006301403, 0.017070023342967033, 0.0054732561111450195, -0.028206055983901024, -0.0009451577789150178, 0.014808833599090576, 0.02833676151931286, 0.00045133937965147197, 0.0022464855574071407, 0.05390258505940437, 0.00462694326415658, -0.020978091284632683, -0.009822452440857887, -0.020233074203133583, 0.010103466920554638, -0.011273273266851902, 0.0027366280555725098, -0.022167503833770752, 0.008201714605093002, 0.015200947411358356, -0.0017220333684235811, -0.019187437370419502, 0.01667790859937668, -0.01059360895305872, -0.021330993622541428, -0.039420511573553085, 0.0025373033713549376, 0.006718217395246029, 0.01571069471538067, -0.006018947809934616, -0.03881927207112312, -0.047315072268247604, 0.0010725947795435786, 0.016887037083506584, 0.009508760645985603, -0.006633259356021881, -5.016300201532431e-05, 0.08338954299688339, -0.032676152884960175, -0.02118721790611744, 0.05609842389822006, 0.02982679381966591, -0.003842715872451663, -0.0007413402781821787, -0.009482620283961296, -0.02797078900039196, -0.005107283126562834, -0.026794446632266045, 0.014965678565204144, 0.00024037396360654384, 0.005708524025976658, 0.013998464681208134, 0.018573125824332237, -0.03769521042704582, 0.00686199264600873, -0.007214894983917475, 0.044779401272535324, 0.009293098002672195, -0.05557560548186302, -0.027683237567543983, 0.013893901370465755, -0.00536215677857399, 0.0011959472903981805, 0.02193223498761654, 0.01320116687566042, 0.003842715872451663, 0.0103321997448802, 0.005561481695622206, 0.002826487412676215, -0.04159021005034447, -0.002552007557824254, -0.005447114817798138, 0.02201065793633461, -0.014534353278577328, 0.015423145145177841, -0.004228294361382723, 0.0038035043980926275, -0.015854470431804657, -0.012148994021117687, -0.029486961662769318, 0.016298865899443626, 0.003050318919122219, 0.0006298328517004848, -0.017566701397299767, 0.006783569697290659, -0.004293646663427353, -0.006473146378993988, 0.008149432949721813, -0.0035453627351671457, 0.027134278789162636, -0.015593061223626137, -0.013828548602759838, 0.0025601766537874937, 0.010900764726102352, 0.008829097263514996, 0.03181350231170654, 0.015959033742547035, -0.0038035043980926275, -0.0117307398468256, -0.036335885524749756, -0.010489045642316341, -0.026232417672872543, -0.028441324830055237, -0.005342551507055759, 0.004600802436470985, -0.06488177180290222, 0.018599268049001694, -0.017253009602427483, -0.01810258999466896, -0.01307046227157116, -0.025056075304746628, 0.009423802606761456, 0.0068881334736943245, -0.04334165155887604, 0.014848045073449612, -0.023356914520263672, -0.011057610623538494, -0.013789337128400803, 0.01963183283805847, -0.00923428125679493, 0.009044759906828403, 0.010613215155899525, -0.023958155885338783, 0.030401894822716713, -0.02182767167687416, -0.003486545756459236, 0.014586635865271091, -0.031081559136509895, -0.002685979939997196, 0.004349196329712868, -0.056255266070365906, 0.009012083522975445, -0.03199649229645729, 0.013893901370465755, -0.010142678394913673, -0.002576514845713973, 0.0128482636064291, 0.01495260838419199, 0.013299195095896721, 0.04480554163455963, -0.02410193160176277, -0.043106384575366974, 0.023356914520263672, -0.016207372769713402, -0.008744139224290848, 0.016063597053289413, 0.03217947855591774, 0.013449504971504211, -0.009822452440857887, 0.021736178547143936, 0.020572906360030174, 0.002641867147758603, 0.030637161806225777, 0.014978749677538872, 0.02521292120218277, 0.0016591317253187299, 0.010096931830048561, 0.029513102024793625, 0.0005007620784454048, 0.01653413474559784, 0.007652755361050367, -0.008979407139122486, -0.003136910730972886, -0.007162612862884998, 0.004336125683039427, -0.005257593467831612, 0.012815588153898716, -0.020716682076454163, -0.005352354142814875, 0.009247351437807083, 0.03113383986055851, -0.0010129607981070876, -0.005643171723932028, 0.00619213143363595, -0.010920370928943157, -0.01547542680054903, -0.018703831359744072, 0.005110550671815872, -0.031708940863609314, 0.007332528941333294, 0.012260093353688717, 0.013312265276908875, -0.029408538714051247, -0.003796969074755907, -0.026088641956448555, 0.003140178509056568, -0.013514857739210129, -0.006724752485752106, -0.0016591317253187299, -0.024454833939671516, 0.027029715478420258, -0.02581416256725788, 0.0019965129904448986, 0.009587183594703674, 0.010168819688260555, 0.023788239806890488, 0.004535450134426355, 0.018220223486423492, -0.005205311346799135, 0.004692296031862497, -0.009240816347301006, 0.050634969025850296, 0.008221320807933807, 0.01818101294338703, -0.00100070727057755, 0.00042111394577659667, -0.01810258999466896, -0.020912738516926765, -0.011606570333242416, -0.0061953989788889885, 0.032048773020505905, -0.018612338230013847, -0.007535121403634548, -0.012109782546758652, -0.0005236353608779609, 0.023121647536754608, 0.028023069724440575, -0.026820586994290352, -0.03887155279517174, -0.01691317744553089, 0.020585976541042328, -0.006352244410663843, -0.007848812267184258, 0.016638698056340218, 0.01697853021323681, 0.0069534857757389545, -0.0054242415353655815, 0.03366950899362564, 0.02930397540330887, 0.01014921348541975, -5.6876931921578944e-05, 0.014861115254461765, 0.00668554101139307, -0.003604179946705699, -0.028911860659718513, 0.02710813842713833, 0.03207491338253021, 0.045720476657152176, -0.02055983617901802, -0.01977560855448246, 0.01411609910428524, 0.009796311147511005, -0.01111642736941576, 0.008737604133784771, 0.014063816517591476, -0.007561262231320143, 0.020285356789827347, -0.004466830287128687, -0.008436983451247215, -0.007214894983917475, 0.03751222416758537, -0.03236246481537819, -0.023526830598711967, 0.0009345380240119994, 0.011064145714044571, 0.018011096864938736, -0.021683895960450172, 0.0011036371579393744, -0.0026010219007730484, 0.00920160487294197, -0.030375752598047256, -0.0034048552624881268, 0.01469119917601347, -0.003081361297518015, 0.015057171694934368, 0.001612568274140358, 0.014717340469360352, -0.01188104972243309, -0.013018179684877396, -0.001191045856103301, -0.03403548151254654, 0.01933121308684349, -0.023526830598711967, -0.02376209944486618, -0.03251931071281433, -0.028781156986951828, 0.028023069724440575, -0.016743261367082596, -0.024376410990953445, 0.03691098466515541, -0.039603497833013535, 0.00839777197688818, 0.002099442994222045, 0.018860677257180214, 0.017148446291685104, -0.03236246481537819, -0.004669422283768654, -0.021853812038898468, 0.014848045073449612, 0.003427728544920683, -0.02040299028158188, -0.003993025980889797, 0.0024082325398921967, 0.0006641428335569799, -0.022664180025458336, -0.0018886817852035165, 0.022468123584985733, 0.001764512388035655, 0.012005219236016273, 0.021134937182068825, -0.027918506413698196, -0.025265201926231384, 0.008332419209182262, -0.0030682908836752176, -0.004408013075590134, -0.008953266777098179, -0.016115879639983177, -0.003123840317130089, -0.0002599796571303159, 0.0135932806879282, 0.0022677250672131777, 0.004836070816963911, -0.0015945963095873594, -0.013841618783771992, 0.0018756112549453974, 0.007129936944693327, -0.030114343389868736, 0.039080679416656494, 0.03406162187457085, 0.008698392659425735, -0.015893680974841118, 0.05013829097151756, -0.014469001442193985, -0.00686199264600873, -0.008123291656374931, 0.011828768067061901, 0.01616816036403179, 0.003633588319644332, -0.006339173763990402, 0.026977432891726494, -0.0006359596736729145, -0.010939976200461388, -0.024297988042235374, 0.004283844027668238, 0.009005548432469368, 0.033277396112680435, 0.03189192712306976, -0.009985832497477531, 0.01482190378010273, -0.01858619600534439, 0.0001581730175530538, 0.013959253206849098, 0.01806337758898735, -0.010136143304407597, 0.06017640605568886, 0.03913296386599541, 0.050033729523420334, -0.00503539526835084, 0.0019001184264197946, 0.004878549836575985, 0.021174147725105286, -0.0035420951899141073, 0.020193863660097122, -0.021801529452204704, 0.011959472671151161, -0.003148347605019808, 0.027578674256801605, -0.007371740415692329, 0.01232544519007206, 0.019710255786776543, -0.0357607826590538, 0.05019057169556618, -0.01333187147974968, 0.0040224348194897175, -0.018377069383859634, 0.005025592632591724, -0.00596666568890214, 0.01872997172176838, 0.0042348294518888, 0.03042803518474102, -0.04666154831647873, -0.0012768207816407084, 0.014011534862220287, 0.0007491008727811277, 0.01665176823735237, -0.000253035977948457, -0.027918506413698196, -0.013580209575593472, -0.005025592632591724, 0.015200947411358356, -0.024036578834056854, -0.03421846777200699, 0.04219144955277443, 0.027918506413698196, 0.010423692874610424, 0.004705366212874651, -0.014469001442193985, -0.0004856493615079671, 0.010809271596372128, -0.005283734295517206, -0.026271628215909004, -0.002962093334645033, 0.01709616370499134, 0.01437750831246376, -0.02096502110362053, -0.022285137325525284, 0.003427728544920683, -0.010763525031507015, 0.02122643031179905, 0.047916311770677567, -6.989633402554318e-05, -0.011136033572256565, 0.011809161864221096, 0.00839777197688818, 0.003591109300032258, -0.024520186707377434, -0.01772354543209076, 0.020416060462594032, 0.0005624383338727057, 0.020429132506251335, 0.02275567315518856, -0.00039129695505835116, 0.007260641548782587, -0.005767341237515211, 0.0342707522213459, -0.002486655255779624, 0.009090506471693516, 0.0027431631460785866, -0.039760343730449677, -0.013214237056672573, -0.02495151199400425, 0.010874624364078045, 0.004035505000501871, -0.0022432180121541023, 0.00032124744029715657, 0.021540120244026184]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"−Xj
⋆),
= (△i
A−η(AiBiT−Xi
⋆)Bi(BiTBi)−1−η(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1
−ηCBi(BiTBi)−1)Σi
⋆1/2
since AiBiT−Xi
⋆=△i
ABiT+Ai
⋆△i
BT,
= (△i
A−η△i
A−ηAi
⋆△i
BTBi(BiTBi)−1−η(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1
−ηCBi(BiTBi)−1)Σi
⋆1/2
= (1−η)△i
AΣi
⋆1/2−ηAi
⋆△i
BTBi(BiTBi)−1Σi
⋆1/2−
η(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2−ηCBi(BiTBi)−1Σi
⋆1/2.
Therefore,
∥(Ai
t+1Qi
t−Ai
⋆)Σi
⋆1/2∥2
F=∥(1−η)△i
AΣi
⋆1/2−ηAi
⋆△i
BTBi(BiTBi)−1Σi
⋆1/2∥2
F
+η2∥(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2+CBi(BiTBi)−1Σi
⋆1/2∥2
F
−2ηtr(((1−η)Σi
⋆1/2△i
AT−ηΣi
⋆1/2(BiTBi)−1BiT△i
BAi
⋆T)
((CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2+CBi(BiTBi)−1Σi
⋆1/2)).(8)
15
Riemannian Preconditioned LoRA
Follow derivation (46) in (Tong et al., 2021b), we can bound
∥(1−η)△i
AΣi
⋆1/2−ηAi
⋆△i
BTBi(BiTBi)−1Σi
⋆1/2∥2
F
≤
(1−η)2+2ϵη(1−η)
1−ϵ
∥△i
AΣi
⋆1/2∥2
F+η2(2ϵ+ϵ2)
(1−ϵ)2∥△i
BΣi
⋆1/2∥2
F.(9)
Next, we want to bound
∥(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2+CBi(BiTBi)−1Σi
⋆1/2∥2
F
=∥(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2∥2
F+∥CBi(BiTBi)−1Σi
⋆1/2∥2
F
+2tr(((CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2)TCBi(BiTBi)−1Σi
⋆1/2).
By the bound for S4in Lemma 1 in (Tong et al., 2021b","[0.004904712084680796, -0.05007239803671837, 0.010557600297033787, 0.034720927476882935, -0.02428802289068699, 0.0032853949815034866, -0.001877368544228375, 0.0026757698506116867, -0.006324861664324999, 0.041343674063682556, -0.0020574850495904684, 0.02366454154253006, -0.0400967113673687, -0.007862779311835766, 0.017388174310326576, -0.026435567066073418, 0.017457449808716774, -0.03904372453689575, -0.03208845481276512, 0.05057118088006973, 0.00033252284629270434, -0.009560031816363335, 0.03754737228155136, 0.017956234514713287, -0.008520897477865219, -0.004679566249251366, 0.015545442700386047, -0.009816351346671581, 0.029594533145427704, -0.03419443219900131, 0.03449924662709236, -0.03641125187277794, 0.008673303760588169, -0.09083415567874908, 0.01453401893377304, 0.10685067623853683, 0.0011300580808892846, 0.04768931865692139, 0.015697849914431572, 0.0067335874773561954, 0.03760279342532158, -0.00836849119514227, -0.08883901685476303, -0.013744277879595757, -0.00042388003203086555, -0.0035243958700448275, -0.005739483051002026, 0.020089922472834587, 0.012033170089125633, 0.024398863315582275, -0.01258737500756979, 0.05328678712248802, 0.002100782236084342, -0.02633858099579811, -0.028347572311758995, -0.004239666275680065, 0.009511538781225681, 0.03818470612168312, 0.05891196429729462, -0.02879093587398529, 0.043505072593688965, -0.015656283125281334, 0.046192966401576996, -0.03516428917646408, -0.04702427238225937, -0.025936782360076904, -0.025618113577365875, 0.029262010008096695, 0.029927056282758713, -0.005126393865793943, -0.0582469180226326, 0.017124926671385765, 0.04696885123848915, 0.010557600297033787, -0.005580149125307798, -0.0020696083083748817, 0.018316466361284256, 0.035967886447906494, 0.07143699377775192, -0.041399095207452774, 0.045056845992803574, -0.001089358702301979, 0.07359839230775833, -0.028624674305319786, 0.02784878760576248, -0.05614094063639641, -0.025244025513529778, 0.013578016310930252, -0.0789741724729538, 0.006764761637896299, -0.009809424169361591, 0.001892955624498427, 0.008991971611976624, 0.007973620668053627, 0.04918567091226578, -0.029234299436211586, -0.0017284260829910636, 0.0025510736741125584, 0.028056615963578224, 0.040207553654909134, 0.02518860623240471, -0.02640785649418831, 0.0625142976641655, -0.003560765413567424, 0.023456715047359467, 0.026615682989358902, -0.01756829023361206, -0.03300289064645767, -0.05364701896905899, 0.005878034047782421, 0.017221912741661072, 0.01512978971004486, 0.015836400911211967, 0.014159930869936943, 0.02245914749801159, -0.06401064991950989, -0.08085846900939941, -0.0024090586230158806, -0.05367472767829895, -0.006089324597269297, -0.004807726014405489, -0.015891820192337036, 0.026019912213087082, -0.0009326226427219808, -0.005188741721212864, -0.028957197442650795, 0.04766160622239113, -0.05517108365893364, -0.02299949713051319, -0.051928985863924026, 0.09709667414426804, 0.023525990545749664, 0.013972886838018894, -0.00439553614705801, -0.0032750037498772144, 0.015420746989548206, 0.048409782350063324, 0.05209524556994438, 0.031035466119647026, -0.04419782757759094, 0.031949903815984726, 0.018676700070500374, -0.013058449141681194, 0.003018683986738324, -0.029317431151866913, 0.032559528946876526, -0.030980044975876808, -0.020505575463175774, -0.0051229302771389484, -0.01668156310915947, 0.0025718563701957464, -0.009400698356330395, -0.040789470076560974, -0.009061247110366821, 0.009379914961755276, -0.018261047080159187, -0.0008161530713550746, 0.03940395638346672, 0.04635922610759735, -0.008673303760588169, -0.03358480706810951, 0.030758362263441086, 0.0069275591522455215, 0.006203629542142153, 0.05796981602907181, 0.01731889881193638, -0.00938684307038784, 0.005829541012644768, -0.06522990018129349, -0.06118420511484146, 0.02245914749801159, 0.016293618828058243, -0.053508467972278595, -0.018274901434779167, 0.019009223207831383, -0.004125361330807209, -0.011894619092345238, -0.03607872873544693, 0.028707806020975113, -0.006127426400780678, 0.009213653393089771, 0.046580906957387924, 0.022916365414857864, 0.03225471451878548, -0.03940395638346672, 0.02976079471409321, 0.028292151167988777, 0.014547874219715595, 0.02031160332262516, -0.011735285632312298, -0.017651421949267387, 0.03666064515709877, 0.05248318985104561, -0.012109373696148396, 0.011257283389568329, -0.05467229709029198, 0.030425840988755226, 0.03211616352200508, 0.02148928865790367, 0.042618345469236374, 0.050765153020620346, 0.033224575221538544, 0.021627839654684067, 0.01995137147605419, -0.013120797462761402, -0.018648989498615265, 0.001496352837421, 0.017789972946047783, -0.04677487909793854, -0.007724228780716658, 0.010328990407288074, -0.009684727527201176, -0.00015792669728398323, 0.008077533915638924, -0.020699547603726387, 0.06583952158689499, -0.026809655129909515, 0.04688572138547897, -0.037741344422101974, 0.05902280658483505, 0.011984677985310555, 0.02854154445230961, 0.003959100227802992, 0.0003439966239966452, -0.00538271339610219, 0.03477634862065315, 0.0606854185461998, -0.003316568909212947, 0.02119833044707775, -0.07819829136133194, 0.043255679309368134, 0.006498050410300493, -0.03868349269032478, -0.03131256625056267, 0.05070973560214043, -0.04616525396704674, -0.02035316824913025, -0.03585704788565636, -0.023401295766234398, -0.031340278685092926, 0.002977118594571948, 0.035025738179683685, 0.008458550088107586, -0.03341854736208916, 0.0020332385320216417, -0.01785924844443798, 0.011721430346369743, -0.01934174634516239, -0.015711704269051552, 0.020228473469614983, -0.00231034099124372, 0.0007897417526692152, 0.01409758348017931, -0.00164875912014395, -0.0738200694322586, 0.04921337962150574, 0.0023848123382776976, 0.019258614629507065, -0.016279764473438263, 0.039625637233257294, -0.05464458838105202, -0.034388404339551926, -0.0400967113673687, -0.027488555759191513, 0.014478598721325397, -0.0029130387119948864, 0.021904941648244858, 0.03239326551556587, 0.02514703944325447, -0.012774419039487839, 0.00866637658327818, 0.0294282715767622, 0.00863173883408308, -0.009726293385028839, -0.03793531283736229, -0.005947309546172619, 0.011381980031728745, 0.03355709835886955, -0.03599559888243675, 0.006141281221061945, -0.01422920636832714, 0.022528422996401787, 0.034111302345991135, 0.002467942889779806, 0.024939212948083878, -0.053148236125707626, -0.01848272792994976, 0.007253154646605253, -0.015711704269051552, -0.011866909451782703, 0.02308262698352337, -0.010806992650032043, 0.02854154445230961, 0.021627839654684067, -0.01726347766816616, 0.0033494748640805483, 0.002171789761632681, -0.039597928524017334, -0.009262146428227425, 0.017346607521176338, 0.03391733020544052, 0.0010399998864158988, -0.010107308626174927, 0.02574281021952629, -0.01000339537858963, -0.00836156401783228, 0.0026186173781752586, -0.0073847780004143715, 0.0008408324792981148, -0.004586044233292341, 0.01758214458823204, 0.02970537357032299, -0.054977111518383026, 0.0058191497810184956, -0.033529385924339294, -0.03178364038467407, 0.034416113048791885, -0.03943166881799698, 0.02579823136329651, -0.02909574843943119, -0.002945944666862488, -0.053508467972278595, -0.0023640296421945095, -0.020367024466395378, 0.03247639909386635, 0.0026549871545284986, -0.02208505943417549, -0.001509341993369162, -0.017388174310326576, -0.04162077605724335, -0.005223379470407963, 0.009934119880199432, 0.032614950090646744, -0.04799412935972214, -0.006331789307296276, -0.0055178008042275906, -0.021697115153074265, 0.028680095449090004, 0.02360912226140499, 0.040207553654909134, -0.05148562043905258, -0.018358031287789345, -0.03059210255742073, 0.03449924662709236, 0.01701408624649048, -0.006917167920619249, 0.024010920897126198, -0.052538610994815826, 0.06112878397107124, 0.05758187174797058, 0.001669541816227138, -0.01578097976744175, 0.030481260269880295, -0.0016530888387933373, -0.053757861256599426, -0.021350737661123276, 0.005874570459127426, -0.03663293272256851, -0.035053450614213943, -0.007994403131306171, -0.032614950090646744, -0.007765794172883034, 0.04092802107334137, 0.01000339537858963, -0.010328990407288074, 0.027460845187306404, 0.022057348862290382, 0.048631466925144196, 0.005036335438489914, -0.009282929822802544, 0.011354269459843636, 0.05087599530816078, -0.027737947180867195, -0.030702942982316017, -0.051402490586042404, -0.029040329158306122, 0.02665724791586399, 0.03391733020544052, 0.042923156172037125, -0.0038690418004989624, -0.027530120685696602, -0.02453741431236267, -0.009636234492063522, 0.01848272792994976, 0.005417351145297289, 0.012227142229676247, -0.0067751528695225716, -0.02430187724530697, -0.012448824010789394, -0.016543012112379074, 0.011562096886336803, -0.02183566614985466, 0.011783778667449951, 0.03671606257557869, -0.02392778918147087, -0.03724255785346031, 0.008340781554579735, 0.0933280810713768, 0.03577391430735588, 0.023124193772673607, -0.004703812766820192, -0.019535716623067856, -0.0671141967177391, -0.014298482798039913, -0.029788505285978317, 0.001943180337548256, 0.03250410780310631, 0.05126393958926201, 0.008798000402748585, 0.023803094401955605, 0.015448457561433315, -0.0014010989107191563, 0.020727258175611496, -0.03189448267221451, 0.023221177980303764, -0.017221912741661072, -0.025562694296240807, 0.05614094063639641, 0.017457449808716774, 0.03391733020544052, -0.006414920091629028, 0.014741846360266209, -0.0137996980920434, -0.015046658925712109, -0.05001697689294815, 0.01968812383711338, 0.019826674833893776, 0.01453401893377304, 0.0144093232229352, -0.05663972347974777, 0.008250722661614418, 0.03253181651234627, 0.045333947986364365, 0.017083361744880676, -0.06844428926706314, -0.003636968554928899, 0.006075469311326742, -0.00806367862969637, 0.009615452028810978, -0.015185209922492504, -0.0018046292243525386, -0.014852686785161495, -0.0018202161882072687, 0.004412855487316847, 0.010862412862479687, 0.041676197201013565, 0.003657751251012087, -0.02304106205701828, -0.01136812474578619, 0.030176447704434395, -0.022348307073116302, -0.0025718563701957464, 0.053259074687957764, 0.012053953483700752, -0.018247190862894058, -0.04040152579545975, 0.05251089856028557, 0.016820114105939865, 0.02970537357032299, -0.007641097996383905, 0.04813268035650253, -0.018565859645605087, 0.0061551365070044994, -0.02308262698352337, 0.009407625533640385, 0.022486858069896698, 0.03932082653045654, -0.013868973590433598, -0.013744277879595757, 0.021447723731398582, -0.015420746989548206, -0.05059889331459999, 0.03981960937380791, -0.024357298389077187, -0.005445061717182398, 0.03945937752723694, 0.02003450132906437, -0.03494260832667351, 0.00363350473344326, -0.00908203050494194, 0.028347572311758995, -0.03851722925901413, -0.025022344663739204, -0.013280130922794342, 0.03646667301654816, 0.10812534391880035, 0.04541707783937454, -0.014423178508877754, 0.021447723731398582, -0.009920264594256878, 0.008597101084887981, -0.006726659834384918, 0.0375196598470211, -0.01663999818265438, -0.004298550542443991, -0.022860946133732796, -0.02726687304675579, -0.01483883149921894, -0.009248292073607445, -0.03402817249298096, 0.06827802211046219, 0.05813607573509216, 0.03516428917646408, 0.021683260798454285, -0.011776850558817387, -0.034693215042352676, -0.006345644127577543, -0.02639400027692318, -0.012525027617812157, -0.0016375018749386072, 0.0037062442861497402, 0.024357298389077187, 0.019812818616628647, 0.012802129611372948, -0.026241594925522804, 0.015032803639769554, -0.04333880916237831, -0.009573887102305889, -0.015226774848997593, -0.0050952197052538395, 0.015088223852217197, -0.027488555759191513, -0.01636289432644844, -0.0333908349275589, 0.02121218666434288, -0.010793137364089489, -0.012822912074625492, -0.05730476975440979, -0.03449924662709236, -0.05603009834885597, 0.041094280779361725, -0.006830573547631502, -0.02301335148513317, 0.020380878821015358, -0.018981512635946274, 0.00877721793949604, -0.006373354699462652, -0.03253181651234627, -0.020076066255569458, -0.01820562593638897, 0.02365068718791008, -0.008707942441105843, 0.010654586367309093, 0.005282263737171888, 0.028278296813368797, -0.027156032621860504, -0.008576318621635437, -0.01724962331354618, 0.00926907453685999, 0.04029068350791931, 0.015309905633330345, -0.013661147095263004, 0.010211222805082798, -0.009864844381809235, -0.01849658414721489, -0.03031499870121479, 0.036826904863119125, -0.012497317045927048, 0.02004835568368435, 0.02608918771147728, 0.0022202827967703342, 0.008126026950776577, 0.005521264858543873, -0.02032545953989029, -0.03549681231379509, 0.06157214567065239, -0.03799073398113251, -0.026906639337539673, 0.028652384877204895, 0.02186337672173977, -0.012781347148120403, 0.00923443678766489, 0.01666770689189434, 0.029012618586421013, -0.0012279099319130182, -0.026269305497407913, 0.07614773511886597, -0.006750906351953745, -0.013127724640071392, -0.016750838607549667, -0.03707629814743996, 0.0020159196574240923, -0.008839565329253674, -6.380931881722063e-05, -0.05040492117404938, 0.02337358519434929, -0.02421874739229679, 0.005784512031823397, -0.009019682183861732, -0.0040630134753882885, 0.02635243535041809, -0.0035746206995099783, 0.012303344905376434, 0.017970088869333267, -0.010737717151641846, 0.009331421926617622, -0.03158967196941376, 0.042036429047584534, 0.00043167354306206107, 0.0037789836060255766, 0.03086920455098152, -0.006920631509274244, 0.018704410642385483, -0.020228473469614983, -0.02818131074309349, -0.012393403798341751, -0.010010323487222195, 0.007495619356632233, 0.002564928727224469, 0.012067807838320732, -0.0010876267915591598, 0.0340004600584507, 0.0025874434504657984, 0.026504842564463615, -0.0033304241951555014, -0.024052485823631287, 0.0002916069352068007, -0.025008488446474075, 0.053840991109609604, 0.0029476764611899853, 0.006092788185924292, -0.01815020479261875, 0.012947608716785908, 0.0023501745890825987, -0.007017617579549551, 0.018011653795838356, -0.03973647952079773, -0.006982979830354452, 0.01906464248895645, 0.0028784009627997875, -0.02216818928718567, -0.01334940642118454, 0.003924462478607893, -0.00926907453685999, -0.0521506667137146, 0.011153370141983032, 0.018718264997005463, 0.03449924662709236, -0.002315536607056856, -0.04455805942416191, 0.03674377501010895, 0.0074124885722994804, 0.0009118400048464537, -0.04339423030614853, 0.03358480706810951, 0.0075371842831373215, -0.005708308890461922, 0.018635135143995285, -0.04004129394888878, -0.04236895218491554, -0.010488324798643589, -0.033751070499420166, 0.04550020769238472, 0.0074124885722994804, 0.021669404581189156, -0.026892784982919693, -0.013100014999508858, 0.0029113066848367453, -0.006757833994925022, -0.03330770507454872, -0.014201496727764606, 0.007710373494774103, 0.0006546543445438147, 0.023484425619244576, 0.009345277212560177, -0.0008819648646749556, 0.02945598214864731, 0.037131719291210175, -0.0061967018991708755, -0.002066144486889243, 0.05059889331459999, 0.024121761322021484, 0.012261779978871346, 0.020200762897729874, 0.014727991074323654, -0.02426031231880188, -0.01913391798734665, -0.036494381725788116, -0.03641125187277794, -0.004603363107889891, -0.02876322530210018, -0.0030308072455227375, -0.00805675145238638, -0.01091090589761734, -0.013030738569796085, -0.023276599124073982, 0.008707942441105843, -0.00805675145238638, -0.034998029470443726, -0.01934174634516239, -0.0048215813003480434, 0.022514566779136658, 0.05785897374153137, -0.04164848476648331, 0.01662614196538925, -0.009359132498502731, -0.01760985516011715, 0.008389274589717388, 0.001711973105557263, -0.022791670635342598, -0.017429739236831665, 0.006418383680284023, -0.012822912074625492, -0.02308262698352337, -0.040734048932790756, -0.015448457561433315, 0.0022254784125834703, 0.036549802869558334, 0.05941074714064598, -0.018593568354845047, -0.00881878286600113, -0.019563427194952965, -0.009379914961755276, -0.00045721890637651086, 0.019244760274887085, 0.01273285411298275, 0.0288186464458704, 0.04555562883615494, -0.005985411349684, -0.0002535053645260632, -0.012365693226456642, -0.01909235306084156, -0.03061981126666069, -0.00847240537405014, 0.022569987922906876, -0.01729118824005127, -0.031063176691532135, 0.02733614854514599, 0.01409758348017931, 0.012047025375068188, 0.025257881730794907, 0.006515369284898043, 0.007495619356632233, 0.026227738708257675, -0.025410287082195282, 0.03616185858845711, -0.017720697447657585, 0.01942487619817257, -0.023886224254965782, 0.00863173883408308, -0.01075849961489439, -0.061405885964632034, -0.027183743193745613, 0.021627839654684067, 0.02457898110151291, 0.015296051278710365, 0.025271736085414886, 0.06024205684661865, -0.010564527474343777, 0.012137084268033504, -0.028402993455529213, 0.012240997515618801, -0.02789035439491272, -0.04065091907978058, 0.009456118568778038, -0.010945543646812439, 0.011610588990151882, -0.013141579926013947, -0.01425691694021225, -0.002050557639449835, -0.00029983342392370105, -0.012469606474041939, -0.010834702290594578, -0.03699316829442978, -0.020851952955126762, 0.011929256841540337, -0.04209185019135475, -0.007855852134525776, 0.04295086860656738, 0.0005355869070626795, -0.019923660904169083, 0.004004129208624363, 0.02906803786754608, -0.00591267179697752, 0.027959629893302917, 0.01816406100988388, -0.01791466772556305, -0.019604992121458054, -0.01453401893377304, -0.0375196598470211, -0.0055940039455890656, 0.006099715828895569, 0.02701748162508011, 0.022195899859070778, -0.03183906152844429, -0.013030738569796085, 0.0014946209266781807, 0.02186337672173977, 0.010890123434364796, -0.01075849961489439, -0.01995137147605419, -0.031063176691532135, 0.01379277091473341, 0.009172088466584682, 0.0027866107411682606, 0.05968784913420677, -0.025964492931962013, -0.11244814097881317, -0.006227875594049692, 0.016293618828058243, 0.019923660904169083, 0.0011066775768995285, -0.0026549871545284986, 0.012268707156181335, 0.022209754213690758, 0.023553701117634773, 0.001523197046481073, -0.021918797865509987, -0.023733818903565407, -0.022514566779136658, 0.00836849119514227, -0.009282929822802544, -0.018399598076939583, -0.00013844294880982488, 0.019286325201392174, 0.04112199321389198, 0.017817681655287743, -0.008798000402748585, 0.005763729102909565, 0.012822912074625492, 0.04901941120624542, -0.0369100347161293, -0.010010323487222195, 0.00984406191855669, -0.02606147713959217, -0.004703812766820192, 0.010377483442425728, 0.013307841494679451, 0.019771253690123558, 0.05251089856028557, 0.050820574164390564, -0.006698949728161097, 0.006203629542142153, 0.012850622646510601, 0.030093317851424217, 0.00863866601139307, 0.032614950090646744, -0.015005093067884445, -0.040734048932790756, 0.04054007679224014, -0.016265908256173134, 0.021683260798454285, -0.028652384877204895, 0.018926091492176056, -0.051707301288843155, 0.013571088202297688, 0.00022427973453886807, 0.020200762897729874, -0.0004589507880154997, 0.0141045106574893, -0.0321715846657753, -0.015199065208435059, -0.01030128076672554, -0.021766390651464462, 0.006931023206561804, -0.006158600095659494, 0.013266275636851788, -0.025244025513529778, 0.017041794955730438, 0.048077262938022614, -0.025050055235624313, -0.01663999818265438, -0.019286325201392174, -0.013882828876376152, 0.021378448233008385, -0.021932652220129967, -0.005483163055032492, 0.011402762494981289, -0.023844659328460693, -0.024980777874588966, -0.01907849870622158, -0.0022982177324593067, 0.011291922070086002, -0.035912469029426575, -0.011188007891178131, -0.035912469029426575, -0.003810157533735037, 0.03552452474832535, 0.0013456783490255475, 0.018067074939608574, 0.016861679032444954, -0.015864111483097076, 0.0002673605049494654, 0.025341011583805084, -0.0057741208001971245, 0.01934174634516239, 0.019577283412218094, 0.017208056524395943, 0.019175484776496887, 0.015157499350607395, -0.014991238713264465, 0.02819516696035862, -0.007170023862272501, 0.0027052119839936495, -0.0018496583215892315, -0.009511538781225681, 0.01612735725939274, 0.0021960362792015076, 0.01849658414721489, 0.006813254673033953, -0.013481030240654945, -0.04148222506046295, -0.0043366518802940845, 0.008375419303774834, -0.003268076106905937, 0.03330770507454872, -0.040152132511138916, 0.008604028262197971, -0.00043059111339971423, -0.015850255265831947, -0.0033910402562469244, 0.02155856415629387, -0.013079231604933739, 0.007966693490743637, 0.004360898397862911, 0.006297151558101177, -0.0006992504931986332, -0.00909588485956192, 0.0279042087495327, 0.011354269459843636, -0.005860715173184872, 0.00035655280225910246, 0.003997201565653086, -0.007855852134525776, 0.04417011886835098, -0.017083361744880676, 0.017997799441218376, 0.024662110954523087, -0.014700280502438545, -0.002178717404603958, 0.0009586010128259659, 0.0303427092730999, 0.01817791536450386, 0.011776850558817387, -0.02147543430328369, 0.0113611975684762, 0.005992338992655277, -0.01756829023361206, 0.0008616151753813028, -0.014014452695846558, -0.0010417316807433963, -0.01881525106728077, -0.00820223055779934, -0.03089691512286663, -0.031367987394332886, -0.01669541746377945, 0.031949903815984726, 0.04602670297026634, -0.0017284260829910636, -0.001656552660278976, 0.009144377894699574, 0.0012893920065835118, 0.00881185568869114, -0.003536518895998597, -0.011956967413425446, -0.018884526565670967, 0.047717027366161346, 0.01636289432644844, 0.07276707887649536, -0.021295316517353058, 0.0025354865938425064, 0.05115309730172157, -0.0032091918401420116, -0.04494600370526314, -0.03061981126666069, 0.022043494507670403, -0.012968391180038452, -0.02725301869213581, -0.06306850165128708, 0.004229275044053793, 0.033224575221538544, -0.02275010384619236, 0.013584943488240242, -0.004807726014405489, -0.0001597668306203559, 0.0047453781589865685, -0.006158600095659494, 0.008520897477865219, 0.03186677396297455, -0.007745011243969202, 0.01580869033932686, 0.008839565329253674, -0.020796533674001694, 0.028306007385253906, -0.018399598076939583, 0.020214617252349854, 0.03424985334277153, 0.044973716139793396, 0.025244025513529778, 0.012538881972432137, 0.025008488446474075, 0.038988303393125534, 0.01486654207110405, 0.011104877106845379, 0.04464119300246239, 0.0036958528216928244, -0.05331449583172798, -0.005344612058252096, 0.05913364514708519, 0.008153737522661686, -0.05553131550550461, -0.010834702290594578, 0.03267037123441696, 0.027446988970041275, -0.01762371137738228, 0.009636234492063522, -0.022334450855851173, 0.033806487917900085, 0.028333717957139015, -0.028596965596079826, -0.004080332349985838, 0.01758214458823204, -0.005372322164475918, 0.005372322164475918, 0.014700280502438545, 0.013751205056905746, -0.012407259084284306, -0.018344176933169365, -0.02450970560312271, 1.9443168639554642e-05, 0.03283663094043732, -0.0018791004549711943, -0.0022514567244797945, 0.014326192438602448, 0.008922696113586426, -0.02025618404150009, -0.006771689280867577, -0.02369225211441517, 0.031340278685092926, -0.03790760412812233, -0.008527825586497784, -0.004052622243762016, 0.020990503951907158, 0.009864844381809235, -0.022597698494791985, -0.010024177841842175, 0.001998600782826543, 0.03477634862065315, -0.00636989064514637, -0.010280498303472996, 0.005978483706712723, -0.010425976477563381, -0.0005594004178419709, 0.047162823379039764, 0.05126393958926201, -0.020713401958346367, 0.0038413316942751408, 0.004430174361914396, 0.024994634091854095, 0.009109740145504475, 0.014187641441822052, 0.02117062173783779, 0.003484562272205949, 0.00805675145238638, 0.006937950383871794, 0.038988303393125534, -0.005929990671575069, -0.008576318621635437, 0.005278800148516893, 0.012684361077845097, 0.006643529515713453, -0.015642428770661354, -0.043227970600128174, -0.026213884353637695, 0.00394870899617672, -0.02427416853606701, 0.017762262374162674, -0.017097216099500656, -0.010668441653251648, -0.003740882035344839, 0.008423912338912487, 0.0030567855574190617, 0.0013309572823345661, 0.03857265040278435, -0.009102812968194485, 0.01816406100988388, -0.005781048443168402, -0.04023526608943939, -0.03796302527189255, -0.03242097795009613, 0.008243795484304428, 0.026865074411034584, 0.010716933757066727, 0.03768592327833176, -0.019023077562451363, 0.03128485754132271, 0.05190127342939377, -0.0044855945743620396, -0.005715236533433199, 0.0069587333127856255, -0.012712071649730206, 0.024385008960962296, -0.016556866466999054, -0.023235034197568893, 0.010647658258676529, -0.018621278926730156, 0.0024350371677428484, -4.906119283987209e-05, 0.02970537357032299, 0.004295086953788996, -0.05070973560214043, 0.014755701646208763, 0.03059210255742073, 0.02004835568368435, 0.001656552660278976, -0.0338619090616703, -0.01727733202278614, -0.002966727362945676, -0.0053965686820447445, 0.021129054948687553, 0.011956967413425446, 0.0023276598658412695, 0.006996834650635719, -0.023221177980303764, -0.022334450855851173, 0.008590173907577991, 0.02791806310415268, 0.006768225226551294, 0.005036335438489914, 0.04286773502826691, 0.001977818086743355, -0.021045925095677376, -0.0018479264108464122, -0.01702794060111046, 0.005940381903201342, -0.00492549454793334, 0.01612735725939274, -0.020547140389680862, -0.006982979830354452, 0.03272578865289688, 0.006705877371132374, -0.012303344905376434, 0.030730653554201126, -0.004475203342735767, -0.022015783935785294, -0.04405927658081055, 0.006106643471866846, -0.0065049780532717705, 0.019494151696562767, -0.007654952816665173, -0.03754737228155136, -0.012317200191318989, 0.01787310279905796, 0.013418681919574738, 0.010384411551058292, -0.025008488446474075, 0.005261481273919344, 0.09427022933959961, -0.025313301011919975, -0.017942378297448158, 0.055586736649274826, 0.005348075646907091, 0.004322797060012817, -0.018579714000225067, -0.013314768671989441, -0.02214047871530056, 0.004648392088711262, -0.02608918771147728, 0.03424985334277153, -0.008874203078448772, -0.011541313491761684, 0.013862046413123608, 0.02002064697444439, -0.022916365414857864, 0.005424278788268566, 0.010439831763505936, 0.016543012112379074, 0.0059265270829200745, -0.04943506419658661, -0.020464010536670685, 0.00454101525247097, -0.012649723328649998, -0.0019449122482910752, 0.019771253690123558, 0.016764692962169647, 0.0012668773997575045, 0.017720697447657585, 0.012878332287073135, 0.00017189006030093879, -0.036577511578798294, 0.012164793908596039, 0.017499014735221863, 0.023429006338119507, -0.019009223207831383, 0.007502546533942223, 0.01167293731123209, -0.0031814815010875463, -0.013003028929233551, -0.011451255530118942, -0.03616185858845711, 0.010017250664532185, -0.0011863445397466421, 0.006401064805686474, -0.022500712424516678, 0.011243429034948349, -0.008243795484304428, -0.002249724930152297, -0.006993371061980724, 0.012795202434062958, 0.021323027089238167, -0.02572895586490631, -0.027156032621860504, 0.0022583843674510717, 0.03327999636530876, 0.011707575060427189, 0.01844116300344467, 0.045306239277124405, -0.01996522583067417, -0.010585310868918896, -0.02854154445230961, 0.007405560929328203, -0.023553701117634773, -0.01670927368104458, 0.0011456451611593366, 0.00865944940596819, -0.051374778151512146, 0.018080929294228554, -0.01939716562628746, -0.013882828876376152, -0.021420013159513474, -0.014298482798039913, -0.007041864097118378, 0.0147141357883811, -0.019466441124677658, 0.015199065208435059, -0.009657017886638641, -0.00408379640430212, -0.014464743435382843, 0.007751938886940479, -0.0014721063198521733, -0.005465844180434942, 0.005372322164475918, -0.006304078735411167, 0.016501445323228836, -0.020367024466395378, -0.017124926671385765, 0.0074609811417758465, -0.029345141723752022, 0.014464743435382843, -0.008444694802165031, -0.03782447427511215, 0.009220581501722336, -0.02937285043299198, 0.008292288519442081, -0.022805524989962578, 0.005864178761839867, 0.020450154319405556, 0.012746709398925304, 0.000582780921831727, 0.042313531041145325, -0.015670139342546463, -0.07160325348377228, 0.029511403292417526, -0.053536176681518555, -0.0043643624521791935, -0.002026311121881008, 0.022639263421297073, 0.01966041326522827, -0.00786970742046833, 0.010980181396007538, 0.01934174634516239, -0.017041794955730438, 0.01700023002922535, 0.006068542134016752, 0.015573153272271156, 0.005881497636437416, -0.008188375271856785, 0.0436159148812294, -0.002014187863096595, 0.013023811392486095, 0.0038205489981919527, -0.017069505527615547, -0.008008258417248726, -0.018039364367723465, 0.015005093067884445, -0.007370923180133104, 0.0005204328917898238, -0.01611350290477276, 0.0004476935137063265, 0.0032438295893371105, 0.017346607521176338, 0.007000298704952002, -0.00041587004670873284, -0.008707942441105843, -0.01665385253727436, -0.02270853891968727, -0.026878930628299713, 0.025063909590244293, -0.019480297341942787, 0.014062945730984211, 0.019494151696562767, -0.013896684162318707, -0.01151360385119915, -0.00802904088050127, -0.028957197442650795, -0.005195669364184141, -0.005185278132557869, 0.00455833412706852, 0.003363329917192459, -0.025701245293021202, 0.02452355995774269, -0.035579945892095566, -0.005677134729921818, 0.012455751188099384, -0.008590173907577991, 0.029012618586421013, -0.003830940229818225, 0.036244988441467285, 0.0024298413190990686, 0.013938249088823795, -0.00041305573540739715, 0.05600238963961601, 0.0045617977157235146, -0.007751938886940479, 0.026587972417473793, 0.014991238713264465, -0.007641097996383905, 0.00821608491241932, -0.006324861664324999, -0.01183227077126503, 0.02491150237619877, -0.03239326551556587, -0.009816351346671581, -0.005299582611769438, 0.0013292254880070686, 0.017789972946047783, 0.0291234590113163, -0.017041794955730438, -0.03001018613576889, -0.01698637567460537, 0.018981512635946274, -0.011423544958233833, 0.00027645291993394494, 0.015143644995987415, 0.01700023002922535, -0.0016193169867619872, -4.362197432783432e-05, 0.01938331127166748, 0.03242097795009613, 0.006532688159495592, -0.004454420413821936, 0.011049456894397736, 0.006096252240240574, 0.000666777603328228, -0.035302843898534775, 0.019175484776496887, 0.02182181179523468, 0.06462027132511139, -0.003323496552184224, -0.014852686785161495, 0.016764692962169647, -0.009705510921776295, -0.014450889080762863, 0.007370923180133104, 0.009109740145504475, -0.0029251619707792997, 0.013432537205517292, 0.014298482798039913, -0.0049428134225308895, -0.0070765018463134766, 0.03419443219900131, -0.014644860289990902, -0.0052441623993217945, 0.0031122060026973486, 0.01997908018529415, 0.0019501079805195332, -0.026144608855247498, -0.00042193164699710906, 0.006498050410300493, 0.010841630399227142, -0.009587742388248444, -0.022639263421297073, 0.021697115153074265, -0.004454420413821936, 0.006404528394341469, -0.006265977397561073, 0.012559665367007256, -0.005344612058252096, -0.024052485823631287, -0.009989540092647076, -0.0073778508231043816, 0.03480405732989311, -0.03599559888243675, -0.01874597556889057, -0.020962795242667198, -0.027530120685696602, 0.0285138338804245, -0.016515301540493965, -0.0338619090616703, 0.012109373696148396, -0.04023526608943939, -0.004250057507306337, 0.004579116590321064, 0.01758214458823204, 0.017208056524395943, -0.03943166881799698, 0.004402463790029287, -0.018025510013103485, 0.004870074335485697, 0.021766390651464462, -0.0442255400121212, -0.01785924844443798, -0.006099715828895569, -0.002050557639449835, -0.033751070499420166, 0.009504611603915691, 0.0025060444604605436, -0.006740515120327473, 0.017443593591451645, 0.009733220562338829, -0.024191036820411682, -0.02549341879785061, 0.001068576006218791, 0.002869741525501013, -0.005618250463157892, 0.00019602828251663595, -0.012026242911815643, -0.004076868761330843, 0.034748636186122894, 0.017443593591451645, -0.0059750196523964405, 0.019895950332283974, 0.02547956258058548, -0.009400698356330395, -0.011160298250615597, 0.020228473469614983, -0.018094785511493683, 0.015614718198776245, 0.04297857731580734, 0.01364036463201046, -0.013848191127181053, 0.042646054178476334, 0.003352938685566187, -0.0025995667092502117, -0.014852686785161495, 0.00492549454793334, 0.004232738632708788, 0.005881497636437416, -0.00791127234697342, 0.014520164579153061, -0.004572188947349787, -0.012040098197758198, -0.01995137147605419, 0.0033875764347612858, -0.012240997515618801, 0.019535716623067856, 0.042895447462797165, 0.011797633022069931, 0.04006900265812874, -0.012746709398925304, -0.013231637887656689, 0.008250722661614418, 0.013446392491459846, -0.015420746989548206, 0.044086989015340805, 0.028112035244703293, 0.02514703944325447, -0.0033858446404337883, 0.0014530555345118046, -0.010813919827342033, 0.020547140389680862, -0.012497317045927048, -0.002026311121881008, -0.010633803904056549, 0.0008131222566589713, 0.006144745275378227, 0.029566822573542595, -0.002192572457715869, 0.022292885929346085, 0.014631005004048347, -0.029816215857863426, 0.06146130710840225, -0.04234124347567558, 0.015947241336107254, 0.012566592544317245, 0.0147141357883811, -0.014547874219715595, 0.027710236608982086, -0.03120172768831253, 0.026781944558024406, -0.02909574843943119, 0.003733954392373562, 0.018926091492176056, 0.0070799654349684715, 0.008548608049750328, 0.01669541746377945, -0.030176447704434395, -0.002997901290655136, 0.010772354900836945, 0.0025025808718055487, -0.012067807838320732, -0.035607654601335526, 0.03627270087599754, 0.01784539222717285, -0.00820223055779934, 0.002514704130589962, -0.0013093086890876293, -0.004159999545663595, 0.02450970560312271, -0.004977451171725988, -0.022874800488352776, 0.004946277476847172, 0.015254485420882702, 0.012815984897315502, -0.02640785649418831, -0.018288755789399147, 0.0011153370141983032, -0.006536152213811874, 0.017748406156897545, 0.034388404339551926, 0.005060581956058741, -0.0012954536359757185, 0.023886224254965782, 0.017097216099500656, 0.008195302449166775, -0.007086893077939749, -0.020990503951907158, 0.028652384877204895, 0.007086893077939749, 0.004838900174945593, 0.022057348862290382, -0.005465844180434942, 0.031977612525224686, -0.002900915453210473, 0.020990503951907158, 0.014201496727764606, 0.009677800349891186, 0.008077533915638924, -0.0484929159283638, 0.003817085176706314, -0.007329357787966728, -0.005102147348225117, -0.0009698583162389696, 0.006650456693023443, 0.0024350371677428484, 0.015974951907992363]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"), we can bound
∥(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2∥2
F≤δi
2r2(2 +ϵ)2
2(1−ϵ)2(∥△i
AΣi
⋆1/2∥2
F+∥△i
BΣi
⋆1/2∥2
F)
We now proceed to bound ∥CBi(BiTBi)−1Σi
⋆1/2∥2
F. According to Lemma 9 in (Tong et al., 2021b), we know Qj
texists, the
optimal alignment matrix between Fj
tandFj
⋆exists. Denote Aj=Aj
tQj
t, Bj=Bj
tQj
t−T,△j
A=Aj−Aj
⋆,△j
B=Bj−Bj
⋆.
Since
∥CT
iCj(Aj
tBj
tT−Xj
⋆)Bi(BiTBi)−1Σi
⋆1/2∥F
=∥CT
iCj(△j
A△j
BT+△j
ABj
⋆T+Aj
⋆△j
BT)Bi(BiTBi)−1Σi
⋆1/2∥F
≤ ∥CT
iCj∥2(∥△j
A△j
BT∥F+∥△j
ABj
⋆T∥F+∥Aj
⋆△j
BT∥F)∥Bi(BiTBi)−1Σi
⋆1/2∥2
by Lemma 12 in (Tong et al., 2021b) and (7),
≤(2 +ϵ)∥CT
iCj∥2
2(1−ϵ)(∥△j
AΣj
⋆1/2∥F+∥△j
BΣj
⋆1/2∥F).(10)
Thus
∥CBi(BiTBi)−1Σi
⋆1/2∥2
F≤(P−1)X
j̸=i∥CT
iCj(Aj
tBj
tT−Xj
⋆)Bi(BiTBi)−1Σi
⋆1/2∥2
F
≤(P−1)X
j̸=i(2 +ϵ)2∥CT
iCj∥2
2
2(1−ϵ)2(∥△j
AΣj
⋆1/2∥2
F+∥△j
BΣj
⋆1/2∥2
F).
Next we bound
|tr(((CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2)TCBi(BiTBi)−1Σi
⋆1/2)|
≤ ∥Bi(BiTBi)−1Σi
⋆1/2∥2
2|tr(((CT
iCi−I)(AiBiT−Xi
⋆))TC)|
by Lemma 12 in (Tong et al., 2021b),
≤1
(1−ϵ)2|tr(((CT
iCi−I)(AiBiT−Xi
⋆))TC)|
by Lemma 17 in (Tong et al., 2021b), since Ciis2r-RIP,
≤δi
2r
(1−ϵ)2∥C∥F∥AiBiT−Xi
⋆∥F
by derivation in (10),
≤X
j̸=i(1 +ϵ
2)2δi
2r
(1−ϵ)2∥CT
iCj∥2(∥△j
AΣj
","[0.00136158789973706, -0.03149848431348801, 0.049167752265930176, 0.028587069362401962, -0.036066390573978424, -0.0013380581513047218, 0.002605526940897107, -0.005662824958562851, -0.03513775020837784, 0.022362668067216873, 0.015410413965582848, 0.046607717871665955, -0.007585989311337471, 0.009010323323309422, 0.02615252695977688, -0.018070843070745468, -0.000768246129155159, -0.04866578429937363, -0.02602703496813774, 0.031197303906083107, -0.01064799353480339, 0.007504419889301062, 0.04487592726945877, 0.03860132768750191, 0.010371911339461803, -0.00012794298527296633, 0.02753293700516224, -0.008031485602259636, 0.04439905658364296, -0.04505161568522453, 0.04349551722407341, -0.024521131068468094, 0.006127145141363144, -0.07579714804887772, -0.019752435386180878, 0.09356681257486343, 0.015046486631035805, 0.05396154522895813, 0.013590780086815357, 0.007623637095093727, 0.03373223915696144, 0.020969707518815994, -0.07715246081352234, -0.0212081428617239, -0.016928866505622864, -0.01952655054628849, -0.02179795503616333, 0.0288129560649395, -0.000335691001964733, 0.02228737436234951, -0.021659914404153824, 0.07072727382183075, -0.04249158129096031, -0.024634072557091713, -0.01311391033232212, 0.023165816441178322, 0.012913123704493046, 0.056571777909994125, 0.0556180402636528, -0.023943867534399033, 0.027357248589396477, 0.013954706490039825, 0.03403342142701149, -0.02713136374950409, -0.02309052273631096, -0.005298898555338383, -0.029917284846305847, 0.017317891120910645, 0.05295760929584503, -0.019802631810307503, -0.07233356684446335, 0.02743254415690899, 0.011382121592760086, 0.012059777975082397, 0.02642860822379589, -0.0006360874394886196, -0.0042479028925299644, 0.036342475563287735, 0.08076663315296173, -0.04901716113090515, 0.0578266978263855, 0.013226853683590889, 0.08578631281852722, -0.02563800849020481, 0.027457643300294876, -0.05451371148228645, -0.0167531780898571, 0.0009976611472666264, -0.07966230064630508, -0.004909873008728027, -0.01508413441479206, -0.007899719290435314, 0.019476354122161865, -0.01020877156406641, 0.017041809856891632, -0.02888825163245201, -0.006280872970819473, -0.0044832006096839905, 0.009393073618412018, 0.0033161251340061426, 0.015912381932139397, 0.012624491937458515, 0.06093889847397804, 0.012536647729575634, 0.042265694588422775, 0.022550906985998154, -0.0006815782398916781, -0.0511254258453846, -0.0566219761967659, 0.025625459849834442, 0.015184528194367886, 0.00524870166555047, 0.012900574132800102, 0.044926125556230545, -0.006243225187063217, -0.062394607812166214, -0.07439164072275162, 0.008420511148869991, -0.03699503093957901, 0.0003084357304032892, -0.009593861177563667, -0.017104554921388626, 0.05305800214409828, -0.00366122811101377, -0.0036926011089235544, 0.010698189958930016, 0.035564422607421875, -0.06259538978338242, -0.053208593279123306, -0.0570235513150692, 0.02662939578294754, 0.004351433832198381, 0.029038840904831886, 0.01666533388197422, -0.023341506719589233, 0.014569617807865143, 0.031197303906083107, 0.07589754462242126, 0.024395639076828957, -0.05426272749900818, 0.017506130039691925, 0.016000226140022278, -0.0205053873360157, 0.0024659172631800175, -0.024044260382652283, 0.011143687181174755, -0.04045861214399338, -0.017317891120910645, -0.007008726242929697, 0.0070777470245957375, -0.012793906033039093, -0.023943867534399033, -0.053810954093933105, -0.025098392739892006, 0.004313786514103413, -0.021935995668172836, -0.00402201758697629, 0.0574251227080822, 0.037823278456926346, -0.02022930607199669, -0.025399575009942055, 0.010930350050330162, -0.034284405410289764, 0.01912497542798519, 0.05117562413215637, 0.016991611570119858, 0.01434373203665018, 0.022751694545149803, -0.06570759415626526, -0.020593231543898582, 0.023416800424456596, 0.004128685686737299, -0.03172437101602554, -0.004097312688827515, -8.230508683482185e-05, 0.0021600304171442986, -0.011407219804823399, -0.01706690713763237, 0.0180582944303751, 0.0012964889174327254, 0.015184528194367886, 0.03365694731473923, 0.041562940925359726, 0.029741596430540085, -0.032979290932416916, 0.01915007457137108, 0.039705660194158554, -0.0071906899102032185, 0.01528492197394371, -0.010108377784490585, -0.008301293477416039, 0.03323027491569519, 0.0142056904733181, -0.013841764070093632, -0.014230788685381413, -0.03343106061220169, 0.00878443755209446, 0.04540299251675606, 0.0036016195081174374, 0.046808503568172455, 0.04879127815365791, 0.034987159073352814, 0.00019882633932866156, 0.03453538939356804, -0.045327696949243546, -0.02277679182589054, -0.004583593923598528, 0.025098392739892006, -0.041387252509593964, -0.007084021810442209, 0.013728821650147438, -0.021935995668172836, -0.015209626406431198, 0.02021675556898117, 0.019965771585702896, 0.05255603790283203, -0.020906962454319, 0.025901542976498604, -0.020957158878445625, 0.054212529212236404, -0.011175059713423252, 0.03548912703990936, 0.011896638199687004, 0.005910671781748533, -0.0509246401488781, 0.03777308389544487, 0.04294335097074509, 0.012568020261824131, 0.023943867534399033, -0.06575778871774673, 0.03461068496108055, 0.0075797149911522865, -0.023805826902389526, -0.01787005551159382, 0.025412123650312424, -0.03380753472447395, -0.012888025492429733, -0.030444351956248283, -0.03659345954656601, -0.028386283665895462, 0.0007117747445590794, 0.01543551217764616, 0.017907703295350075, -0.031322795897722244, 0.010397009551525116, -0.003156122984364629, -0.0065004839561879635, -0.02928982488811016, -0.014657462015748024, 0.039806053042411804, 0.006145969033241272, 0.021484224125742912, -0.02268894761800766, -0.010986821725964546, -0.055768631398677826, 0.0061302827671170235, -0.0028282753191888332, 0.018196335062384605, -0.0016847297083586454, 0.056069809943437576, -0.06435228139162064, 0.008445609360933304, -0.05270662531256676, -0.018798695877194405, 0.00325651653110981, 0.002291796961799264, 0.016803374513983727, 0.0281102005392313, 0.008458158932626247, -0.014670010656118393, 0.010867604054510593, 0.05958358570933342, 0.023416800424456596, 0.0032000450883060694, -0.03937938064336777, -0.009995435364544392, -0.0291141364723444, 0.01794535107910633, -0.03036905638873577, -0.012053503654897213, -0.015811987221240997, 0.03568991646170616, 0.018811246380209923, -0.005471449811011553, 0.012160171754658222, -0.06395070999860764, -0.03717071935534477, 0.012555471621453762, -0.01872340217232704, -0.009982885792851448, 0.015247274190187454, -0.015485708601772785, 0.021157946437597275, 0.007811875082552433, -0.03265301138162613, -0.0031451424583792686, -0.010986821725964546, -0.050146590918302536, -0.021346183493733406, 0.01302606612443924, 0.0009694254258647561, -0.002804745454341173, -0.011037018150091171, 0.05190347880125046, -0.007767952978610992, 0.0014219809090718627, -0.012825279496610165, 0.0006356952362693846, -0.030318859964609146, -0.0069648041389882565, 0.016652783378958702, 0.012097425758838654, -0.04869088530540466, -0.003341223578900099, -0.03686954081058502, -0.046607717871665955, 0.022450512275099754, -0.05285721644759178, 0.012975869700312614, -0.01278135646134615, 0.008075407706201077, -0.06897038221359253, -0.004536534659564495, -0.018221434205770493, 0.018196335062384605, 0.015272372402250767, 0.0049851685762405396, -0.01278135646134615, 0.019463803619146347, -0.03395812585949898, -0.017619071528315544, 0.018309278413653374, 0.03446009382605553, -0.03147338703274727, -0.025700755417346954, 0.018685754388570786, -0.004273001570254564, 0.031423188745975494, 0.010748387314379215, 0.034485191106796265, -0.04075979068875313, -0.0070024519227445126, -0.001334920758381486, 0.03267810866236687, 0.006751467939466238, 0.0026525864377617836, 0.02760823257267475, -0.02063087932765484, 0.07424104958772659, 0.05888083204627037, -0.02349209599196911, -0.02662939578294754, 0.010742112062871456, 0.02198619209229946, -0.04618104547262192, -0.022852087393403053, 0.013063713908195496, -0.033079683780670166, -0.032602813094854355, -0.019300663843750954, -0.016652783378958702, -0.028787856921553612, 0.03875191882252693, -0.006058124825358391, 0.0015011976938694715, 0.020154010504484177, -0.0066134268417954445, 0.03835034370422363, 0.024182302877306938, -0.012116249650716782, -0.012342135421931744, 0.0706268772482872, -0.04209000617265701, -0.025876443833112717, -0.032903995364904404, -0.03561462089419365, 0.0024172889534384012, 0.03767268732190132, 0.06405109912157059, -0.004407905507832766, -0.007924817502498627, -0.0357150137424469, 0.0006125576910562813, 0.012279389426112175, -0.0056973351165652275, 0.019777534529566765, -0.008520904928445816, -0.02612742781639099, -0.014895896427333355, 0.0006972647388465703, 0.02901374362409115, 0.006061261985450983, -0.004859676584601402, 0.020003419369459152, -0.0434202216565609, -0.04294335097074509, 0.042667269706726074, 0.08568591624498367, 0.01376646850258112, 0.02959100529551506, -0.011852716095745564, -0.041562940925359726, -0.06937196105718613, -0.0063969530165195465, -0.026604296639561653, -0.009982885792851448, 0.016062971204519272, 0.039705660194158554, 0.018761049956083298, 0.0042855506762862206, 0.023517195135354996, -0.004812616854906082, 0.0281102005392313, -0.032201237976551056, 0.021082650870084763, -0.01666533388197422, -0.06465346366167068, 0.026177624240517616, 0.01169585157185793, 0.01932576298713684, -0.01375391986221075, 0.017619071528315544, -0.010804858058691025, -0.023692883551120758, -0.05406193807721138, 0.040609199553728104, -0.0058291018940508366, 0.01596257835626602, 0.0552164651453495, -0.038802117109298706, 0.0075797149911522865, 0.05130111798644066, 0.046607717871665955, 0.011400945484638214, -0.0724339634180069, -0.004567907657474279, 0.019074779003858566, -0.009844845160841942, -0.0037271114997565746, -0.021471675485372543, -0.02543722093105316, -0.004649477545171976, -0.0018698303028941154, -0.011294277384877205, 0.02346699871122837, 0.046105749905109406, 0.020831666886806488, -0.014670010656118393, -0.010434657335281372, 0.030896121636033058, -0.03686954081058502, -0.016251210123300552, 0.059432994574308395, -0.006020477041602135, 0.004859676584601402, -0.01734299026429653, 0.04163823649287224, -0.009455819614231586, 0.028838053345680237, -0.03400832414627075, 0.03975585475564003, -0.03446009382605553, 0.02868746407330036, -0.011087215505540371, 0.0036831891629844904, 0.03777308389544487, 0.025575263425707817, 0.0008047172450460494, 0.009938963688910007, 0.013791567645967007, -0.019877927377820015, -0.04188922047615051, 0.07258455455303192, -0.00232944474555552, -0.007234612014144659, 0.011432318016886711, 0.04171352833509445, -0.046005357056856155, -0.01756887510418892, -0.019401058554649353, 0.018309278413653374, -0.06510522961616516, -0.01872340217232704, 0.02149677462875843, 0.0345102921128273, 0.0552164651453495, 0.05496548116207123, -0.02474701590836048, 0.02622782066464424, -0.0026431744918227196, 0.014933544211089611, -0.011118588037788868, 0.03649306297302246, -0.01301351748406887, -0.0061804791912436485, -0.029967481270432472, -0.013954706490039825, -0.003934173379093409, -0.03641776740550995, -0.024132104590535164, 0.06244480237364769, 0.0570235513150692, 0.0428178608417511, 0.013101361691951752, -0.027959611266851425, 0.015184528194367886, -0.005709884688258171, -0.034083619713783264, -0.0355142280459404, 0.04284295812249184, 0.02329130843281746, -0.01005818136036396, 0.03157377988100052, 0.010654267854988575, -0.0018572810804471374, 0.025725852698087692, -0.019099878147244453, 0.014958642423152924, -0.009782099165022373, -0.016627686098217964, 0.016339054331183434, -0.03737150877714157, -0.009355425834655762, -0.02544977143406868, 0.008891105651855469, -0.012806455604732037, -0.03312987834215164, -0.05777650326490402, -0.03789857402443886, -0.05170268937945366, 0.05049796774983406, -0.0065193078480660915, -0.009192286990582943, 0.03292909264564514, -0.0017662994796410203, -0.0065004839561879635, -0.007203239016234875, -0.03184986114501953, -0.006020477041602135, -0.013251951895654202, 0.014782954007387161, -0.026654493063688278, -0.0061208708211779594, 0.00304788607172668, 0.01915007457137108, -0.036166783422231674, -0.0007611872279085219, -0.006127145141363144, -0.010422107763588428, 0.021183043718338013, -0.006422051228582859, -0.009355425834655762, -0.00461182976141572, 0.0010282498551532626, -0.021546971052885056, -0.020543035119771957, 0.030745532363653183, -0.018095942214131355, 0.013427640311419964, 0.005402429029345512, 0.008966401219367981, 0.006092634983360767, -0.01814613863825798, -0.010114653035998344, -0.03727111592888832, 0.0479128323495388, -0.03804916515946388, -0.0202042069286108, 0.04259197413921356, 0.038124460726976395, -0.014168043620884418, 0.002996120834723115, 0.016602586954832077, -0.021546971052885056, 0.0072785341180861, -0.004887911956757307, 0.04585476592183113, -0.01079858373850584, -0.04188922047615051, -0.02514859102666378, -0.03860132768750191, 0.017292793840169907, 0.00210983376018703, 0.009041695855557919, -0.04525240510702133, 0.005609490908682346, -0.013691173866391182, -0.01726769469678402, -0.007454222999513149, -0.006048712879419327, 0.01647709496319294, -0.01410529762506485, -0.0019749298226088285, -0.0027388622984290123, -0.002969453576952219, 0.00941817183047533, -0.029766695573925972, 0.03963036462664604, 0.0014839424984529614, 0.0060173398815095425, 0.03285379707813263, -0.013954706490039825, 0.013741370290517807, -0.036643654108047485, -0.03523814305663109, -0.018422221764922142, 0.0037929946556687355, 0.002018851926550269, 0.005979692097753286, -0.005032227840274572, -0.013427640311419964, 0.03809935972094536, 0.0070024519227445126, 0.03975585475564003, 0.007491870317608118, -0.00902914721518755, -0.005207916721701622, -0.025286631658673286, 0.019953222945332527, -0.015636298805475235, 0.001050210907123983, -0.027256855741143227, 0.012706061825156212, 0.016138266772031784, -0.016941415145993233, 0.0282105952501297, -0.00385887804441154, -0.014569617807865143, -0.00048392839380539954, 0.018698303028941154, -0.022048939019441605, 0.014808052219450474, -0.0019184584962204099, -0.007824423722922802, -0.039002902805805206, -0.01579943858087063, 0.03049454838037491, 0.020568134263157845, -0.005891847889870405, -0.04369630292057991, 0.014808052219450474, -0.0033882830757647753, -0.01223546639084816, -0.056270599365234375, 0.024496031925082207, 0.018761049956083298, 0.012404881417751312, 0.005851062946021557, -0.04229079186916351, -0.0410107746720314, -0.01257429551333189, -0.025123491883277893, 0.04974501579999924, -0.0034165189135819674, 0.03225143626332283, -0.04487592726945877, -0.03217614069581032, -0.0016847297083586454, -0.009104441851377487, -0.041387252509593964, -0.01529747061431408, 0.01316410768777132, -0.00838913768529892, 0.0107546616345644, 0.010302890092134476, -0.0050792875699698925, 0.01514688041061163, 0.04339512065052986, -0.003962408751249313, -0.006550680845975876, 0.04944383352994919, 0.028185496106743813, 0.01567394658923149, -0.00326906586997211, -0.005684786010533571, -0.0253619272261858, 0.0007164807175286114, -0.028863152489066124, -0.029314924031496048, -0.024094458669424057, -0.04188922047615051, -0.0034824020694941282, 0.0009866806212812662, -0.0028502363711595535, -0.019865378737449646, -0.01843477040529251, -0.012762533500790596, -0.0070965709164738655, -0.030745532363653183, -0.017694367095828056, 0.009882492013275623, 0.029440416023135185, 0.044248469173908234, -0.05285721644759178, 0.025186238810420036, -0.013214304111897945, -0.014117846265435219, 0.017481030896306038, -0.01844731904566288, -0.02652900107204914, -0.012517823837697506, 0.013741370290517807, -0.021270887926220894, -0.028762759640812874, -0.03661855682730675, -0.038124460726976395, 0.002974159549921751, 0.013590780086815357, 0.04224059730768204, 0.00863384734839201, -0.0037082876078784466, 0.024044260382652283, 0.006807939149439335, -0.0054400768131017685, 0.03184986114501953, 0.0167531780898571, 0.014720208011567593, 0.03302948549389839, -0.00946836918592453, 0.0021537558641284704, -0.004059665370732546, -0.020555583760142326, -0.027859216555953026, 0.00021608147653751075, 0.016815923154354095, -0.013691173866391182, -0.015360216610133648, 0.00828246958553791, 0.014444125816226006, -0.0139045100659132, 0.008985225111246109, -0.004047115799039602, 0.0018792422488331795, 0.011206433176994324, 0.013289599679410458, 0.02317836694419384, 0.008345215581357479, 0.019601846113801003, -0.04309394210577011, 0.020869314670562744, 0.003072984516620636, -0.0432194322347641, -0.02497290074825287, 0.015184528194367886, -0.007309907115995884, 0.01903713122010231, 0.01685357093811035, 0.04648222401738167, 0.002321601379662752, 0.02378072775900364, -0.006638525053858757, 0.009280131198465824, -0.0511254258453846, -0.021534422412514687, 0.022513259202241898, -0.004523985553532839, 0.01079858373850584, -0.023253662511706352, -0.027934512123465538, -0.01667788252234459, 0.016916317865252495, -0.008558551780879498, -0.03521304577589035, -0.017882606014609337, -0.01717985048890114, 0.02434544265270233, -0.0584290586411953, -0.007855797186493874, 0.03473617509007454, -0.003814955707639456, -0.0060267518274486065, 0.007303632330149412, 0.0061647929251194, -0.00021431675122585148, 0.03456048667430878, 0.01514688041061163, -0.03789857402443886, -0.017593974247574806, -0.0026416059117764235, -0.0288129560649395, -0.01326450053602457, 0.01050995197147131, 0.014130395837128162, 0.03405851870775223, -0.012662139721214771, -0.02306542359292507, 0.015197076834738255, 0.00794991571456194, 0.003579658456146717, -0.009637783281505108, -0.0035043631214648485, -0.009198561310768127, -0.005239289719611406, 0.007786776404827833, -0.0042855506762862206, 0.03541383147239685, -0.02250071056187153, -0.12157661467790604, -0.013000967912375927, 0.025675656273961067, 0.0281102005392313, -0.024433286860585213, 0.0015098252333700657, 0.025424672290682793, 0.029716497287154198, 0.0036863265559077263, -0.0020439503714442253, -0.016941415145993233, -0.02001596800982952, -0.011225256137549877, 0.015711594372987747, -0.0018086530035361648, 0.00021784621640108526, -0.014431576244533062, 0.020555583760142326, 0.030444351956248283, 0.01981518231332302, -0.015071585774421692, 0.02268894761800766, 0.013415091671049595, 0.035940900444984436, -0.019162623211741447, -0.020844215527176857, 0.007855797186493874, -0.03671894967556, -0.0038808390963822603, 0.018284179270267487, 0.0142558878287673, 0.03669385239481926, 0.06625975668430328, 0.047988127917051315, 0.011369572021067142, 0.028285888954997063, 0.016828473657369614, 0.024533679708838463, 0.0028251379262655973, 0.03182476386427879, -0.02247561141848564, -0.031222401186823845, 0.03144828602671623, -0.014280986040830612, 0.01804574579000473, -0.01925046741962433, 0.00030196504667401314, -0.049067359417676926, 0.016590038314461708, -0.007159316912293434, -0.0023514057975262403, 0.0008305999799631536, 0.01440647803246975, -0.026779985055327415, -0.02188579924404621, -0.01992812380194664, 0.007655010093003511, 0.013427640311419964, 0.010660543106496334, 0.015422962605953217, -0.04143744707107544, 0.022149331867694855, 0.04705948755145073, -0.019175171852111816, -0.006324795074760914, -0.0076738339848816395, -0.04726027324795723, 0.026503903791308403, -0.020756371319293976, -0.014419026672840118, 0.01376646850258112, -0.040383316576480865, -0.0339079312980175, -0.02693057619035244, 0.00544635159894824, 0.00732245622202754, -0.02329130843281746, -0.005229877773672342, -0.029440416023135185, -0.0035984821151942015, 0.012066052295267582, -0.006393815856426954, 0.020768919959664345, 0.0402076281607151, -0.03993154317140579, 0.0037208369467407465, 0.013327246531844139, -0.006111458875238895, 0.038902509957551956, 0.01587473414838314, 0.01695396564900875, 0.034259308129549026, 0.005057326517999172, -0.012900574132800102, 0.011162510141730309, 0.0017506129806861281, 0.009926415048539639, -0.025474868714809418, 0.01252409815788269, 0.006202440708875656, 0.012693512253463268, -0.014582166448235512, 0.00941817183047533, -0.05165249481797218, -0.03533853963017464, -0.015937479212880135, 0.0021992467809468508, -0.015736693516373634, -0.00837658904492855, -0.03621698170900345, -0.010641719214618206, 0.007027550134807825, -0.015623750165104866, -0.0434202216565609, 0.01508413441479206, -0.03463578224182129, -0.0142056904733181, -0.01449432224035263, -0.0012211936991661787, -0.006826763041317463, -0.010898977518081665, 0.02652900107204914, 0.00561890285462141, -0.0005647138459607959, 0.010334263555705547, 0.008225998841226101, -0.012950771488249302, 0.042566876858472824, 0.002092578448355198, 0.015611200593411922, 0.029917284846305847, -0.010246419347822666, 0.011626831255853176, -0.015397864393889904, 0.04316923767328262, 0.00883463490754366, 0.024031711742281914, -0.03699503093957901, -0.0010313871316611767, 0.016740627586841583, -0.021484224125742912, -0.0033035760279744864, -0.006657348945736885, -0.011595457792282104, -0.013891960494220257, -0.012417430058121681, -0.026554100215435028, -0.023253662511706352, -0.01366607565432787, 0.023906219750642776, 0.03383263573050499, -0.0053365458734333515, 0.002864354057237506, 0.004445552825927734, -0.017619071528315544, 0.0016894355649128556, -0.012273114174604416, -0.005414978601038456, -0.025035647675395012, 0.054212529212236404, 0.02158461883664131, 0.04635673388838768, -0.0023372878786176443, 0.009311503730714321, 0.05406193807721138, 0.0031137694604694843, -0.059533391147851944, -0.028436480090022087, 0.03523814305663109, 0.0028486675582826138, -0.014657462015748024, -0.05727453529834747, 0.004445552825927734, 0.03227653354406357, -0.018409671261906624, 0.03067023679614067, 0.006531856954097748, -0.007975014857947826, -0.00732245622202754, 0.009882492013275623, -0.017681818455457687, 0.03493696451187134, -0.020053615793585777, -0.0030557294376194477, 0.013352345675230026, -0.03385773301124573, 0.018773598596453667, -0.005160856992006302, 0.039002902805805206, 0.007855797186493874, 0.06088870391249657, 0.01715475134551525, 0.012210368178784847, 0.010980547405779362, 0.036844443529844284, 0.009581311605870724, 0.011131137609481812, 0.044323764741420746, -0.00544635159894824, -0.03661855682730675, 0.027281953021883965, 0.024696819484233856, 0.004025154747068882, -0.04625634104013443, 0.008075407706201077, -0.0029616104438900948, 0.02928982488811016, -0.01618846319615841, 0.0025819973088800907, -0.03295418992638588, 0.026855280622839928, 0.025085844099521637, -0.040885284543037415, -0.008840909227728844, 0.013427640311419964, -0.0026212134398519993, 0.03355655074119568, 0.018510065972805023, 0.007046374026685953, -0.002713763853535056, -0.007655010093003511, -0.012938221916556358, 0.009399347938597202, 0.013791567645967007, -0.001739632454700768, -0.00976954959332943, 0.03107181191444397, 0.0034478919114917517, -0.020003419369459152, -0.014280986040830612, -0.03325537219643593, 0.044348862022161484, -0.050071295350790024, -0.01638925075531006, 0.008847183547914028, 0.034761276096105576, 0.02119559422135353, -0.0211077481508255, -0.015824537724256516, 0.015724143013358116, 0.030720433220267296, -0.0012133504496887326, -0.010911526158452034, 0.014419026672840118, -0.0034227934665977955, -0.027783920988440514, 0.01915007457137108, 0.062294211238622665, -0.02652900107204914, -0.024496031925082207, 0.006236950866878033, 0.021622266620397568, 0.0030086699407547712, 0.027959611266851425, 0.013678624294698238, 0.007378927897661924, 0.005320859607309103, 0.005669099744409323, 0.04055900499224663, -0.006764017045497894, -0.01252409815788269, 0.013239402323961258, 0.008420511148869991, 0.005468312650918961, -0.007366378325968981, -0.0430186465382576, -0.02534937672317028, -0.008859733119606972, 0.004771831911057234, 0.021647363901138306, -0.010108377784490585, -0.008125605061650276, -0.006177342031151056, 0.0011976639507338405, 0.01287547592073679, -0.010158575139939785, 0.010302890092134476, 0.0016847297083586454, 0.005863612052053213, -0.009901315905153751, -0.04143744707107544, -0.030645137652754784, -0.004420454613864422, 0.004210255574434996, 0.022149331867694855, 0.020643427968025208, 0.046231240034103394, -0.027181560173630714, 0.04663281515240669, 0.04994580149650574, 0.024245047941803932, -0.009895041584968567, 0.0054306648671627045, -0.011626831255853176, 0.02091951109468937, -0.011708400212228298, -0.02101990394294262, 0.0136033296585083, -0.023216014727950096, 0.010095829144120216, -0.0017615935066714883, 0.045227304100990295, -0.012210368178784847, -0.05451371148228645, 0.013628427870571613, 0.018510065972805023, 0.024684270843863487, 0.005035365000367165, -0.04188922047615051, -0.0031388679053634405, 0.016815923154354095, -0.012655865401029587, 0.00818207673728466, 0.006312245968729258, -0.004727909807115793, -0.001840026001445949, -0.026503903791308403, -0.014531970024108887, 0.009957787580788136, 0.024985451251268387, 0.004156921524554491, 0.0044926125556230545, 0.05275682359933853, 0.005452625919133425, -0.010610345751047134, 0.026202723383903503, 0.0015953166875988245, 0.012204093858599663, -0.008866007439792156, 0.011551535688340664, -0.019953222945332527, 0.0014102159766480327, 0.03676914796233177, -0.009851119481027126, -0.03245222195982933, 0.027558036148548126, -0.00154668849427253, -0.017970450222492218, -0.04183902218937874, 0.0015945322811603546, 0.011576633900403976, 0.016213562339544296, -0.00992013979703188, -0.03641776740550995, -0.004517710767686367, 0.018773598596453667, 0.032703205943107605, -0.003366322023794055, -0.02949061244726181, -0.005276937037706375, 0.08694083243608475, -0.03845074027776718, -0.0285117756575346, 0.07519478350877762, -0.0070777470245957375, -0.0025302318390458822, -0.022450512275099754, -0.014117846265435219, 0.005217328667640686, 0.011288002133369446, -0.04389708861708641, 0.01627630740404129, -0.0015066879568621516, -0.012793906033039093, 0.003830642206594348, 0.005734982900321484, -0.03177456557750702, 0.015272372402250767, -0.002880040556192398, 0.006619701161980629, 0.008012661710381508, -0.05968397855758667, -0.01223546639084816, 0.0177571140229702, -0.005866749677807093, -0.018070843070745468, 0.019990870729088783, -0.00500712962821126, -0.02277679182589054, 0.0058008660562336445, 0.01163310557603836, 0.0061302827671170235, -0.02198619209229946, -0.014732756651937962, 0.01656493917107582, 0.012888025492429733, -0.034987159073352814, 0.003689463948830962, 0.01725514605641365, -0.008326391689479351, -0.009838569909334183, -0.004712223540991545, -0.024019163101911545, 0.014720208011567593, 0.007818149402737617, 0.00897894985973835, -0.021070102229714394, 0.01114996150135994, -0.016313955187797546, 0.0025867032818496227, -0.009556213393807411, -0.01578688994050026, 0.015561004169285297, -0.034761276096105576, -0.014657462015748024, -0.004774969536811113, 0.017029259353876114, -0.007071472238749266, 0.022525807842612267, 0.03912839666008949, -0.013389992527663708, 0.005612628068774939, -0.007435399107635021, -0.008671495132148266, -0.012862926349043846, -0.03649306297302246, 0.013101361691951752, -0.012442528270184994, -0.015272372402250767, 0.025023099035024643, -0.031398091465234756, -0.01588728278875351, -0.007767952978610992, -0.016150815412402153, 0.0288129560649395, -0.000766677490901202, -0.022262275218963623, 0.010773485526442528, -0.03845074027776718, 0.020768919959664345, -0.008546003140509129, 0.015623750165104866, 0.004599280655384064, 0.005286348983645439, -0.009054245427250862, 0.003868289990350604, 0.02022930607199669, -0.0218105036765337, -0.017443383112549782, 0.012298212386667728, -0.007265985012054443, 0.0031937705352902412, 0.013979805633425713, -0.003654953557997942, 0.005273799877613783, -0.03581540659070015, 0.01252409815788269, -0.024132104590535164, 0.020756371319293976, 0.02179795503616333, 0.016903767362236977, -0.0022714047227054834, 0.03656835854053497, -0.026403509080410004, -0.056571777909994125, 0.031322795897722244, -0.042968448251485825, 0.02199874259531498, -0.0033255370799452066, 0.017920253798365593, 0.016627686098217964, -0.0007447163807228208, 0.0032533793710172176, 0.016928866505622864, -0.008081682957708836, 0.02277679182589054, 0.005499685648828745, 0.0030306309927254915, -0.010773485526442528, 0.014393928460776806, 0.05416233465075493, -0.002867491450160742, 0.004335747566074133, 0.013201754540205002, -0.008652671240270138, -0.010415833443403244, -0.008815811015665531, 0.01219154428690672, -0.005832239054143429, -0.005054188892245293, 0.00848325714468956, 0.008891105651855469, 0.016815923154354095, 0.02011636272072792, -0.006745193153619766, -0.028034904971718788, -0.014619814231991768, 0.0014157062396407127, -0.009022872895002365, -0.033380862325429916, -0.011946835555136204, -0.01577433943748474, -0.0025568988639861345, 0.013942157849669456, 0.005603216588497162, -0.01734299026429653, -0.016740627586841583, -0.028060004115104675, -0.0074479482136666775, 0.010415833443403244, 0.016000226140022278, 0.011576633900403976, -0.016439447179436684, 0.01208487618714571, -0.016251210123300552, -0.0002703959762584418, 0.024797212332487106, 0.005675374064594507, 0.012298212386667728, 0.0032941640820354223, 0.02179795503616333, 0.012568020261824131, 0.0067577422596514225, -0.010836231522262096, 0.05245564132928848, 0.00843933504074812, -0.007987563498318195, 0.02287718653678894, 0.0013004104839637876, -0.00021529715741053224, 0.00828246958553791, -0.0026557238306850195, -0.010108377784490585, 0.021145395934581757, -0.027181560173630714, 0.0006176557508297265, 0.00037196604534983635, 0.002393759321421385, -0.00043059431482106447, 0.015648847445845604, -0.010139751248061657, -0.0284113809466362, -0.01148251537233591, 0.013101361691951752, -0.01725514605641365, 0.012009581550955772, 0.019288115203380585, 0.021735208109021187, 0.005584392696619034, -0.007121669128537178, -0.0047498708590865135, 0.046406928449869156, 0.01587473414838314, 0.00022706203162670135, 0.011840167455375195, 0.003648679004982114, -0.0142056904733181, -0.03129769489169121, 0.020543035119771957, 0.024734467267990112, 0.045126911252737045, 0.0005349094863049686, -0.026278018951416016, 0.010597797110676765, -0.010146025568246841, -0.02129598706960678, 0.008225998841226101, 0.008508355356752872, -0.013703722506761551, 0.00907306931912899, 0.020003419369459152, -0.0022604239638894796, 0.019965771585702896, 0.04480063170194626, -0.02290228381752968, -0.005032227840274572, -0.014155494049191475, 0.007611087989062071, 0.005901259835809469, -0.0068706851452589035, 0.0070965709164738655, -0.009637783281505108, -0.0016564939869567752, -0.021823052316904068, -0.020367346704006195, 0.024496031925082207, -0.004624378867447376, 0.005713021848350763, -0.020693626254796982, -0.00769265741109848, -0.017192399129271507, -0.026077231392264366, -0.010767211206257343, 0.006324795074760914, 0.021082650870084763, -0.01835947483778, -0.006327932700514793, -0.024834860116243362, -0.024734467267990112, 0.03458558768033981, -0.054212529212236404, -0.018798695877194405, 0.01903713122010231, -0.031122008338570595, 0.006409502122551203, 0.016941415145993233, 0.027156461030244827, 0.005389879923313856, -0.03154867887496948, -0.017430834472179413, -0.025023099035024643, 0.02228737436234951, -0.0035922075621783733, -0.009236209094524384, -0.005217328667640686, -0.01951400190591812, -0.014030002057552338, -0.03458558768033981, -0.00837658904492855, -0.020944610238075256, -0.017732014879584312, 0.05386115238070488, -0.002988277468830347, -0.012492725625634193, -0.007272259332239628, -0.009531115181744099, 0.01361587829887867, -0.0007839326281100512, -0.01915007457137108, -0.03154867887496948, 0.01405510026961565, 0.006070673931390047, 0.00819462537765503, 0.010792309418320656, 0.03493696451187134, 0.040584102272987366, -0.009104441851377487, -0.010171123780310154, -0.004401630721986294, -0.026478804647922516, 0.025387024506926537, 0.028336087241768837, 0.025663107633590698, -0.015033937990665436, 0.04030802100896835, 0.0013082537334412336, -0.012699787504971027, -0.009725627489387989, -0.0017192399827763438, -0.0004415748699102551, 0.017819859087467194, -0.013791567645967007, 0.02218697965145111, 0.0009521702886559069, -0.007504419889301062, -0.022852087393403053, 0.004988305736333132, 0.011331924237310886, 0.031147105619311333, 0.033581651747226715, 0.021321086212992668, 0.03968055918812752, -0.0074667721055448055, -0.027834119275212288, 0.016351602971553802, 0.01016484946012497, -0.013440189883112907, 0.04698419198393822, 0.0412115603685379, 0.02743254415690899, 0.004131822846829891, 0.0016753177624195814, -0.004442415665835142, -0.005251838825643063, 0.01567394658923149, 0.016715530306100845, -0.010616620071232319, 0.0075608910992741585, 0.007065197918564081, 0.02612742781639099, -0.009750725701451302, 0.024408187717199326, -0.009687979705631733, -0.029766695573925972, 0.07168101519346237, -0.03757229447364807, 0.010127201676368713, 0.0014376674080267549, 0.013691173866391182, -0.009405623190104961, 0.018472418189048767, -0.01508413441479206, -0.0012957045109942555, -0.023253662511706352, 0.012963320128619671, 0.010861329734325409, -0.0252615325152874, 0.007033824920654297, 0.0038369169924408197, -0.02169756032526493, 0.02070617489516735, 0.00033020073897205293, 0.015648847445845604, -0.0034102441277354956, -0.03265301138162613, 0.045628879219293594, 0.021471675485372543, 0.025625459849834442, 0.01628885790705681, -0.00688323425129056, 0.007008726242929697, 0.00329102692194283, 0.016000226140022278, -0.02219952829182148, 0.0025270944461226463, 0.014331182464957237, 0.02723175659775734, -0.029666300863027573, -0.011507613584399223, 0.012586844153702259, -0.0009043265017680824, 0.022751694545149803, 0.02040499448776245, -0.02415720373392105, 0.008351490832865238, 0.02504819631576538, 0.00833266694098711, -0.0028172945603728294, -0.00985739380121231, -0.008928753435611725, 0.018710851669311523, 0.006280872970819473, -0.01902458257973194, 0.03087102435529232, 0.026905477046966553, 0.008665220811963081, -0.010284067131578922, 0.01287547592073679, 0.023354055359959602, 0.014632363803684711, 0.000774520740378648, -0.027357248589396477, -0.016539841890335083, -0.009506016969680786, -0.00554988207295537, 0.016715530306100845, -0.006563229952007532, 0.004530259873718023, 0.026754887774586678]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"⋆1/2∥F+∥△j
BΣj
⋆1/2∥F)(∥△i
AΣi
⋆1/2∥F+∥△i
BΣi
⋆1/2∥F).
16
Riemannian Preconditioned LoRA
To summarize,
∥(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2+CBi(BiTBi)−1Σi
⋆1/2∥2
F
≤δi
2r2(2 +ϵ)2
2(1−ϵ)2(∥△i
AΣi
⋆1/2∥2
F+∥△i
BΣi
⋆1/2∥2
F) + (P−1)X
j̸=i∥CT
iCj∥2
2(2 +ϵ)2
2(1−ϵ)2(∥△j
AΣj
⋆1/2∥2
F+∥△j
BΣj
⋆1/2∥2
F)
+X
j̸=i2(1 +ϵ
2)2σi
2r
(1−ϵ)2∥CT
iCj∥2(∥△j
AΣj
⋆1/2∥F+∥△j
BΣj
⋆1/2∥F)(∥△i
AΣi
⋆1/2∥F+∥△i
BΣi
⋆1/2∥F).
(11)
Finally, we move on to bound
|tr(((1−η)Σi
⋆1/2△i
AT−ηΣi
⋆1/2(BiTBi)−1BiT△i
BAi
⋆T)((CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2(12)
+CBi(BiTBi)−1Σi
⋆1/2))|
≤ |tr((1−η)Σi
⋆1/2△i
AT(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2)|
+|tr(ηΣi
⋆1/2(BiTBi)−1BiT△i
BAi
⋆T(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2)|
+|tr((1−η)Σi
⋆1/2△i
ATCBi(BiTBi)−1Σi
⋆1/2)|+|tr(ηΣi
⋆1/2(BiTBi)−1BiT△i
BAi
⋆TCBi(BiTBi)−1Σi
⋆1/2)|.
First notice by the bound for |S2|in Lemma 1 in (Tong et al., 2021b),
|tr((1−η)Σi
⋆1/2△i
AT(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2)|
≤(1−η)δi
2r(2 +ϵ)
2(1−ϵ)(3
2∥△i
AΣi
⋆1/2∥2
F+1
2∥△i
BΣi
⋆1/2∥2
F).(13)
Similarly, by the bound for |S3|in Lemma 1 in (Tong et al., 2021b),
|tr(ηΣi
⋆1/","[0.01945720799267292, -0.03946472331881523, 0.02869446948170662, 0.02913995459675789, -0.04255691170692444, 0.019535822793841362, -0.0013241710839793086, -0.007638756185770035, -0.029428208246827126, 0.027646269649267197, -0.002912030089646578, 0.01892000623047352, -0.0291923638433218, -0.003061071038246155, 0.023243829607963562, -0.007868049666285515, 0.023453470319509506, -0.023820340633392334, -0.021212942898273468, 0.04394577443599701, 0.004002812784165144, -0.004559669177979231, 0.04525602608919144, 0.018644854426383972, -0.005476844031363726, -0.004684142768383026, 0.026060868054628372, -0.0035638792905956507, 0.04575392231345177, -0.03338516503572464, 0.026715992018580437, -0.031236354261636734, -0.0028694469947367907, -0.09360424429178238, 0.01760975643992424, 0.10560613125562668, -0.009355182759463787, 0.06797575950622559, 0.004294343292713165, 0.006701927166432142, 0.04533464089035988, 0.006361262407153845, -0.07934872061014175, -0.01438654214143753, -0.006197481416165829, -0.0034525080118328333, -0.015408537350594997, 0.0054637412540614605, 0.0008598513668403029, 0.026218097656965256, -0.009656540118157864, 0.05592145770788193, -0.0038292049430310726, -0.022601807489991188, -0.014216209761798382, 0.00809079222381115, 0.018356598913669586, 0.05639315024018288, 0.05696965754032135, -0.03663458302617073, 0.03563879430294037, -0.00614179577678442, 0.03734211623668671, -0.02782970480620861, -0.03244178369641304, -0.012860100716352463, -0.015683690086007118, 0.023414162918925285, 0.0273056048899889, -0.010311665013432503, -0.054034698754549026, 0.01754424348473549, 0.04156112298369408, 0.017452526837587357, 0.004146940540522337, -0.007619102019816637, 0.0076649608090519905, 0.04344788193702698, 0.08469454199075699, -0.04669729992747307, 0.04622561112046242, 0.008352842181921005, 0.06891913712024689, -0.007579794619232416, 0.021160533651709557, -0.048007551580667496, -0.024436157196760178, 0.013914852403104305, -0.07892944663763046, 0.021068815141916275, -0.013731417246162891, -0.019313080236315727, 0.022444577887654305, 0.00923070963472128, 0.0341189019382, -0.03521951287984848, 0.01366590429097414, -0.014858231879770756, 0.006033699959516525, 0.026073969900608063, 0.013050087727606297, 0.002943148370832205, 0.0710679441690445, -0.009237260557711124, 0.026165686547756195, 0.0038783391937613487, -0.014923744834959507, -0.02138327620923519, -0.04350029304623604, 0.008267675526440144, 0.03859995678067207, 0.009813770651817322, 0.010488549247384071, 0.030292974784970284, 0.010527856647968292, -0.06320644915103912, -0.07651858776807785, 0.0037211093585938215, -0.04025087133049965, 0.004576047416776419, -0.003573706140741706, -0.032179731875658035, 0.04119425266981125, -0.014452054165303707, 0.005843713879585266, -0.015343024395406246, 0.03301829472184181, -0.05848954990506172, -0.04486295208334923, -0.047509655356407166, 0.05503048747777939, 0.022575603798031807, 0.022418372333049774, 0.0028497930616140366, 0.011032302863895893, 0.011477787978947163, 0.03516710177063942, 0.06304921954870224, 0.03621530160307884, -0.037787601351737976, 0.02591674029827118, 0.022798344492912292, -0.009971000254154205, -0.002127517946064472, -0.02459338679909706, 0.019365491345524788, -0.023754827678203583, -0.01204774621874094, -0.002078383695334196, -0.004605527967214584, 0.002368276473134756, -0.0027580757159739733, -0.041901785880327225, -0.007488077040761709, -0.0030725356191396713, -0.023309342563152313, 0.0076911658979952335, 0.05039220303297043, 0.04551807418465614, 0.002625413006171584, -0.043814752250909805, 0.012663563713431358, -0.01229669339954853, 0.009781014174222946, 0.05938051640987396, 0.01708565652370453, 0.008752468042075634, 0.01762285828590393, -0.06037630885839462, -0.054873257875442505, 0.01569679193198681, 0.012434270232915878, -0.04035569354891777, -0.005788028240203857, 0.024213414639234543, -0.007494628429412842, -0.010095474310219288, -0.03949092701077461, 0.022090811282396317, 0.011661222204566002, 0.008621443063020706, 0.05185968428850174, 0.005149281583726406, 0.027882114052772522, -0.0324941948056221, 0.03440715745091438, 0.025274718180298805, 0.005041185766458511, 0.013744520023465157, -0.011739837937057018, -0.010272357612848282, 0.03749934583902359, 0.04038189724087715, 0.0010580266825854778, 0.029559234157204628, -0.06734683364629745, 0.011471236124634743, 0.04069635644555092, 0.0024124972987920046, 0.043343059718608856, 0.05974738672375679, 0.02830139361321926, 0.013574187643826008, 0.030240563675761223, -0.0315508134663105, -0.01801593415439129, 0.011458134278655052, 0.025733305141329765, -0.032651424407958984, -0.008739366196095943, -0.0020636434201151133, -0.017033247277140617, -0.005905950907617807, 0.007442218717187643, -0.010947136208415031, 0.062315478920936584, -0.02782970480620861, 0.04593735560774803, -0.032153528183698654, 0.057231709361076355, 0.0008729539113119245, 0.037735193967819214, 0.005755271762609482, -0.010481998324394226, -0.02231355383992195, 0.024672001600265503, 0.06870949268341064, -0.0045400154776871204, 0.026964940130710602, -0.07463182508945465, 0.05885641649365425, 0.010455792769789696, -0.022431476041674614, -0.021160533651709557, 0.0426093228161335, -0.0443650558590889, -0.013849339447915554, -0.02506507746875286, -0.029847489669919014, -0.036870427429676056, 0.024370644241571426, 0.025654690340161324, 0.015343024395406246, -0.01992889866232872, 0.006380916107445955, -0.017452526837587357, 0.017478732392191887, -0.026073969900608063, -0.028039343655109406, 0.028013139963150024, -0.011621914803981781, 0.005535805132240057, -0.007199822459369898, -0.007605999708175659, -0.06074317917227745, 0.019666848704218864, 0.0007063064840622246, 0.017269091680645943, -0.0038619611877948046, 0.04994672164320946, -0.05104732885956764, -0.024789925664663315, -0.04431264474987984, -0.037289708852767944, 0.009165196679532528, -0.008280778303742409, 0.017491834238171577, 0.026165686547756195, 0.03194388747215271, -0.010160986334085464, 0.009486207738518715, 0.05183348059654236, 0.010691638104617596, -0.00683295214548707, -0.03422372415661812, -0.008817980997264385, 0.015054769814014435, 0.044731926172971725, -0.03375203162431717, -0.01508097443729639, -0.0019096890464425087, 0.028877904638648033, 0.027436628937721252, -0.006125417537987232, 0.033070702105760574, -0.06210583820939064, -0.027541449293494225, -0.000280270614894107, -0.0022716454695910215, -0.007822191342711449, 0.022850755602121353, -0.004343478009104729, 0.03372582793235779, 0.02085917629301548, -0.028956519439816475, 0.003540949895977974, -0.006384192034602165, -0.05005154013633728, -0.02274593524634838, 0.010829214006662369, 0.025798818096518517, 0.018251778557896614, 0.0005961636197753251, 0.0463828407227993, -0.018736571073532104, 0.002276558894664049, 0.006544697564095259, 0.0019129646243527532, -0.002573002828285098, -0.02231355383992195, 0.014884437434375286, 0.030817074701189995, -0.04785032197833061, 0.008490418083965778, -0.03763037174940109, -0.028537239879369736, 0.02405618503689766, -0.019758565351366997, 0.027908319607377052, -0.016980836167931557, 0.016561556607484818, -0.03784001246094704, 0.0036621480248868465, -0.022051503881812096, 0.017334604635834694, 0.013875545002520084, -0.02231355383992195, -0.00588957266882062, 0.008863839320838451, -0.0492129810154438, -0.020963996648788452, 0.006357986945658922, 0.01764906384050846, -0.03993641212582588, -0.010160986334085464, -0.00925036333501339, -0.00924381148070097, 0.03435474634170532, 0.010396831668913364, 0.05450638756155968, -0.034983668476343155, -0.008798327296972275, -0.008464213460683823, 0.048846110701560974, 0.010062717832624912, -0.006891913712024689, 0.025392640382051468, -0.05091630294919014, 0.07300711423158646, 0.05102112516760826, -0.01995510421693325, -0.037368323653936386, 0.022051503881812096, 0.013574187643826008, -0.052121736109256744, -0.011110917665064335, -0.00473000155761838, -0.03354239463806152, -0.023846544325351715, -0.018422111868858337, -0.04043430835008621, -0.02037438377737999, 0.03299208730459213, 0.005693035200238228, -0.002011233242228627, 0.035402946174144745, 0.009669642895460129, 0.04868888109922409, 0.012001887895166874, -0.0231259074062109, -0.0017426321282982826, 0.06855226308107376, -0.0351933091878891, -0.04108943045139313, -0.048426829278469086, -0.0315508134663105, 0.014176902361214161, 0.03516710177063942, 0.05319613963365555, -0.002821950474753976, -0.010206845588982105, -0.03354239463806152, -0.010927482508122921, 0.0071146562695503235, -0.02178945392370224, 0.014294824562966824, -0.009427246637642384, -0.031812865287065506, -0.004946192726492882, -0.01669258251786232, 0.020099230110645294, -0.00790080614387989, -0.004553117789328098, 0.039228878915309906, -0.030030924826860428, -0.03341136872768402, 0.019155850633978844, 0.09585787355899811, 0.02033507637679577, 0.025248512625694275, -0.0027859185356646776, -0.020544715225696564, -0.0729547068476677, -0.02824898436665535, -0.03199629858136177, 0.0087655708193779, 0.040015026926994324, 0.0436837263405323, 0.01365280244499445, 0.01947031170129776, 0.012689768336713314, 0.0004246027965564281, 0.023492777720093727, -0.028091754764318466, 0.024907847866415977, -0.007468423340469599, -0.0323631688952446, 0.05196450278162956, 0.011281250044703484, 0.029349593445658684, -0.015028564259409904, 0.016351915895938873, -0.02181565761566162, -0.005761823151260614, -0.05047082155942917, 0.0361366868019104, 0.01550025399774313, 0.005817508790642023, 0.021907376125454903, -0.045203614979982376, 0.014609284698963165, 0.0473262220621109, 0.037237297743558884, 0.017871806398034096, -0.074422188103199, -0.005378575064241886, 0.004012639634311199, -0.009722053073346615, 0.013154907152056694, -0.022352861240506172, -0.014897539280354977, -0.027489040046930313, 0.008981761522591114, -0.0038423072546720505, 0.027017349377274513, 0.04310721531510353, 0.016011251136660576, -0.010075820609927177, -0.010567164048552513, 0.02785590849816799, -0.02358449436724186, -0.022496987134218216, 0.04965846613049507, 0.015107179060578346, -0.014124492183327675, -0.043709930032491684, 0.05639315024018288, 0.00440243910998106, 0.03010953962802887, -0.016024354845285416, 0.05251481011509895, -0.02544504962861538, 0.0023781033232808113, -0.027620064094662666, 0.00660365866497159, 0.020138537511229515, 0.02313901111483574, -0.0003654368338175118, -0.0045170858502388, 0.01293216459453106, -0.002306039445102215, -0.06221065670251846, 0.049710873514413834, -0.011386070400476456, 0.0016591037856414914, 0.00996444933116436, 0.01810765080153942, -0.04169214516878128, 0.011196084320545197, -0.004461400210857391, 0.016836708411574364, -0.03558638319373131, -0.01991579681634903, 0.0010989719303324819, 0.03535053879022598, 0.07919149100780487, 0.05364162474870682, -0.014203106984496117, 0.018802084028720856, -0.005057564005255699, -0.008411803282797337, -0.007946664467453957, 0.048479240387678146, -0.014635489322245121, 0.0022896614391356707, -0.022798344492912292, -0.03390926495194435, -0.00511980103328824, -0.010396831668913364, -0.034485772252082825, 0.07824811339378357, 0.039595745503902435, 0.03328034281730652, 0.014923744834959507, -0.008608341217041016, -0.029926104471087456, -0.019653746858239174, -0.037263501435518265, -0.022994883358478546, 0.0070884511806070805, 0.0032543328125029802, 0.009853078052401543, 0.029008928686380386, 0.013200766406953335, -0.013351445086300373, 0.012034643441438675, -0.03257280960679054, 0.001845814287662506, -0.01293216459453106, -0.0037112822756171227, 0.0204267930239439, -0.03768278285861015, -0.018291085958480835, -0.03149840235710144, 0.023270035162568092, -0.014216209761798382, -0.014884437434375286, -0.07305952161550522, -0.03377823904156685, -0.0564979687333107, 0.027043554931879044, -0.02030887082219124, -0.023440368473529816, 0.032232142984867096, -0.006338333245366812, 0.007016387302428484, -0.0036949042696505785, -0.025182999670505524, -0.01851382851600647, -0.002507490338757634, 0.02271972969174385, -0.014399644918739796, 0.0039831590838730335, 0.008077689446508884, 0.029795078560709953, -0.03110532835125923, -0.002186479279771447, -0.0069443234242498875, 0.0023961192928254604, 0.030004719272255898, 0.0019326183246448636, -0.006659344304352999, 0.00602387310937047, -0.0014568339101970196, -0.016902221366763115, -0.0296640545129776, 0.03744693845510483, -0.008719711564481258, 0.014045877382159233, 0.013679007068276405, -0.007455321028828621, 0.0010383728658780456, 0.0010866883676499128, -0.019168954342603683, -0.028484828770160675, 0.07122517377138138, -0.03928128629922867, -0.015618177130818367, 0.039124056696891785, 0.03658217191696167, -0.026991143822669983, 0.010396831668913364, 0.0148320272564888, 0.037787601351737976, 0.004585874266922474, -0.020675741136074066, 0.06839503347873688, -0.014006569981575012, -0.035455357283353806, -0.011883964762091637, -0.035900842398405075, 0.007586346007883549, -0.00762565340846777, -0.00092700170353055, -0.03713247925043106, 0.007029489614069462, -0.019103441387414932, -0.0051689352840185165, -0.016889119520783424, -0.00646608229726553, 0.03841652348637581, -0.0015198896871879697, 0.0033329478465020657, 0.010396831668913364, -0.0053228894248604774, 0.0061581735499203205, -0.022942472249269485, 0.03354239463806152, 0.004775860346853733, 0.006384192034602165, 0.02827518992125988, -0.025287820026278496, 0.018802084028720856, -0.02045299857854843, -0.026493249461054802, -0.02226114273071289, -0.014648592099547386, -0.0037767947651445866, 0.008202163502573967, 0.009977552108466625, 0.002021060325205326, 0.03846893087029457, 0.0001730962685542181, 0.02963784895837307, -0.0007247318862937391, -0.0194179005920887, 0.0028481553308665752, -0.03624150902032852, 0.06173896789550781, -0.008962107822299004, -0.01573609933257103, -0.007940113544464111, 0.008988313376903534, 0.026257405057549477, -0.006449704524129629, 0.036372531205415726, -0.021527403965592384, -0.019168954342603683, 0.0246064905077219, 0.015343024395406246, -0.021671529859304428, -0.011464685201644897, 0.00727843726053834, -0.017858704552054405, -0.056288328021764755, 0.00419279932975769, 0.015329921618103981, 0.03734211623668671, -0.002961164340376854, -0.04082738235592842, 0.034380953758955, 0.01762285828590393, 0.003907819744199514, -0.055344950407743454, 0.02503887191414833, 0.019758565351366997, 7.431572885252535e-05, 0.025366434827446938, -0.055764228105545044, -0.04588494449853897, -0.01674499176442623, -0.02087227813899517, 0.042399682104587555, 0.005014980677515268, 0.018186265602707863, -0.02507817931473255, -0.02316521480679512, 0.005532529670745134, -0.008752468042075634, -0.037813808768987656, -0.00739635992795229, 0.027226990088820457, 0.003056157613173127, 0.018435213714838028, 0.0028350527863949537, -0.010960238985717297, 0.022012196481227875, 0.03705386072397232, -0.006977079901844263, -0.006479185074567795, 0.060009438544511795, 0.027620064094662666, 0.025838125497102737, 0.019365491345524788, 0.00693122111260891, -0.015225102193653584, -0.023741725832223892, -0.02176324836909771, -0.03320172801613808, 0.0031511506531387568, -0.03390926495194435, 0.009617232717573643, -0.012414616532623768, -0.0006006676121614873, -0.01809454895555973, -0.02171083725988865, -0.012611153535544872, -0.00025918378378264606, -0.03157701715826988, -0.012362206354737282, 0.006773991044610739, 0.02775109000504017, 0.05655037984251976, -0.036320123821496964, 0.026584967970848083, 0.005994392558932304, -0.022968677803874016, 0.008202163502573967, 0.0057487208396196365, -0.05047082155942917, -0.010095474310219288, 0.01612917333841324, -0.025759510695934296, -0.03270383179187775, -0.03008333407342434, -0.02357139252126217, 0.00486430199816823, 0.025248512625694275, 0.06126727908849716, -0.0198895912617445, -0.006872260011732578, 0.008582135662436485, -0.012375309132039547, -0.008496969938278198, 0.02401687763631344, 0.020610228180885315, 0.029349593445658684, 0.03967436030507088, -0.01848762296140194, -0.003377168672159314, -0.019627541303634644, -0.013888646848499775, -0.034459568560123444, 0.0012856825487688184, 0.013213868252933025, -0.014949949458241463, -0.03152460977435112, 0.014425849542021751, 0.015539562329649925, 0.0028252259362488985, 0.03063363954424858, -0.0043336511589586735, -0.0038685123436152935, 0.01042958814650774, -0.023767929524183273, 0.025772612541913986, -0.015067871659994125, 0.02313901111483574, -0.02738421969115734, 0.008745917119085789, -0.0010752236703410745, -0.05482085049152374, -0.03854754567146301, 0.015932636335492134, 0.013561084866523743, 0.02505197562277317, 0.023034190759062767, 0.051623839884996414, -0.007527384907007217, 0.015867123380303383, -0.02971646375954151, 0.010593368671834469, -0.024278927594423294, -0.03763037174940109, 0.01708565652370453, -0.01206739991903305, 0.0048217191360890865, -0.01810765080153942, -0.013600392267107964, -0.03149840235710144, 0.0055554588325321674, -0.01040993444621563, -0.01987648941576481, -0.018815185874700546, -0.026296712458133698, 0.013285932131111622, -0.04680212214589119, -0.0014036049833521247, 0.02549746073782444, 0.011870862916111946, -0.014268619939684868, -0.0022896614391356707, 0.015683690086007118, 0.007776332087814808, 0.026296712458133698, 0.02404308319091797, -0.02509128302335739, -0.013888646848499775, -0.012794588692486286, -0.04258311539888382, -0.002591018797829747, -0.0009736793581396341, 0.02365000732243061, 0.02785590849816799, -0.026100175455212593, -0.004294343292713165, -0.003992985934019089, 0.0036850774195045233, 0.011497441679239273, -0.006262993905693293, -0.004376234021037817, -0.022614911198616028, -0.00265489355660975, 0.0003457831044215709, 0.0037767947651445866, 0.03928128629922867, -0.028144164010882378, -0.11100436002016068, -0.010200293734669685, 0.0324941948056221, 0.02824898436665535, -0.016862913966178894, -0.011209186166524887, 0.016954632475972176, 0.02921856939792633, 0.008870391175150871, 0.009591028094291687, -0.019234465435147285, -0.022038400173187256, -0.032101117074489594, 0.01813385635614395, -0.017766986042261124, -0.015919534489512444, -0.01577540673315525, 0.01318766362965107, 0.034014083445072174, 0.012578397057950497, 0.0036457697860896587, 0.00836594495922327, 0.01844831556081772, 0.04777170717716217, -0.04412921145558357, -0.009414144791662693, 0.010292011313140392, -0.02551056258380413, -0.00836594495922327, 0.005978014320135117, 0.01713806577026844, 0.026204993948340416, 0.05571181699633598, 0.04737862944602966, -0.0003764920693356544, 0.0025533491279929876, 0.012755281291902065, 0.039202671498060226, 0.004851199686527252, 0.027698678895831108, -0.010632677003741264, -0.054873257875442505, 0.036424942314624786, -0.015303716994822025, 0.014661694876849651, -0.037080068141222, -0.0009794116485863924, -0.05476843938231468, 0.00614179577678442, -0.0074618724174797535, 0.022785242646932602, 0.006528319325298071, 0.014753412455320358, -0.02879928983747959, -0.01844831556081772, -0.018356598913669586, -0.012198424898087978, 0.014452054165303707, 0.004995326977223158, 0.015356127172708511, -0.024318234995007515, 0.018880698829889297, 0.04585874080657959, -0.01952272094786167, -0.014687899500131607, -0.0241347998380661, -0.034040287137031555, 0.007481526117771864, -0.020636433735489845, -0.016836708411574364, 0.009125889278948307, -0.027620064094662666, -0.021946683526039124, -0.017963523045182228, -0.006557799875736237, -0.0011546575697138906, -0.047037966549396515, -0.013181112706661224, -0.04122045636177063, -0.005201691295951605, 0.0416659414768219, -0.003432854311540723, 0.018906904384493828, 0.031210148707032204, -0.01623399369418621, -0.012218078598380089, 0.02645394206047058, -0.010010307654738426, 0.025156794115900993, 0.014714104123413563, 0.025641586631536484, 0.022798344492912292, 0.017387013882398605, -0.013351445086300373, 0.01991579681634903, -0.0038619611877948046, 0.007547038607299328, -0.0008295518928207457, -0.0013716677203774452, 0.01801593415439129, 0.0045400154776871204, 0.009794116951525211, 0.02594294399023056, -0.0036523211747407913, -0.027646269649267197, -0.0022307001054286957, 0.023479675874114037, -0.0037538656033575535, 0.02137017250061035, -0.032232142984867096, 0.0016279852716252208, 0.012578397057950497, -0.020963996648788452, -0.031760454177856445, 0.025379536673426628, -0.02592984214425087, 0.006105763837695122, 0.008981761522591114, 0.004438471049070358, -0.012270488776266575, -0.0078090885654091835, 0.027882114052772522, 0.01851382851600647, 0.010573714971542358, 0.001311068655923009, 0.02598225139081478, -0.0015018737176433206, 0.03005712851881981, -0.01339730340987444, 0.01943100430071354, 0.01754424348473549, 0.005571837071329355, 0.0038259292487055063, -0.021016405895352364, 0.030921893194317818, 0.01339730340987444, 0.01850072667002678, -0.02037438377737999, 0.00975480955094099, 0.005892848130315542, -0.021173635497689247, 0.00196865014731884, 0.0006608571857213974, 0.00403229333460331, -0.0015485513722524047, -0.010043064132332802, -0.03482643887400627, -0.05372023954987526, -0.012525987811386585, 0.03354239463806152, 0.04858405888080597, 0.00946000311523676, -0.015605074353516102, 0.0018359874375164509, 0.00419279932975769, 0.0061614494770765305, -0.007599448319524527, -0.007488077040761709, -0.031236354261636734, 0.05655037984251976, 0.025222307071089745, 0.04766688495874405, -0.019129646942019463, 0.007815639488399029, 0.043290652334690094, -0.009898936375975609, -0.04111563786864281, -0.03246798738837242, 0.02181565761566162, 0.007422564551234245, -0.017255989834666252, -0.07515592128038406, 0.0031986471731215715, 0.03514089807868004, -0.01249323133379221, 0.014203106984496117, 0.002374827628955245, -0.010488549247384071, -0.0021963061299175024, -0.002595932222902775, -0.00013184387353248894, 0.018435213714838028, -0.01576230488717556, 0.012552192434668541, 0.009584477171301842, -0.019077235832810402, 0.02507817931473255, -0.001688584336079657, 0.03490505367517471, 0.022352861240506172, 0.044234029948711395, 0.015211999416351318, 0.005712688900530338, 0.012211527675390244, 0.048872314393520355, 0.019326183944940567, 0.005326165352016687, 0.04046051204204559, 0.010783355683088303, -0.06173896789550781, 0.00855593103915453, 0.04483674466609955, 0.005846989341080189, -0.055764228105545044, -0.01042303629219532, 0.017504936084151268, 0.026519455015659332, -0.007265334948897362, 0.0005347456899471581, -0.026506351307034492, 0.041037023067474365, 0.030659843236207962, -0.026768401265144348, -0.0035540524404495955, 0.020295768976211548, -0.013017331250011921, 0.019666848704218864, 0.012788037769496441, 0.005011705216020346, -0.004454849287867546, -0.017360808327794075, -0.018291085958480835, -0.00022008101223036647, 0.03102671355009079, 0.007737024687230587, -0.005106698255985975, 0.017465628683567047, -0.0005388401914387941, -0.016784299165010452, -0.018212471157312393, -0.01369210984557867, 0.033149316906929016, -0.04538705199956894, -0.014006569981575012, 0.0011112556094303727, 0.024724412709474564, 0.017688371241092682, -0.017491834238171577, 0.013927954249083996, 0.007376706227660179, 0.030476408079266548, -0.004235382191836834, -0.0222480408847332, 0.018775878474116325, -0.0020882105454802513, -0.01529061421751976, 0.04082738235592842, 0.05639315024018288, -0.01894621178507805, 0.013757621869444847, -0.0004917531041428447, 0.03157701715826988, 0.003319845302030444, 0.02126535400748253, 0.020059922710061073, 0.00544408755376935, -0.007134309969842434, 0.00029255420668050647, 0.037263501435518265, -0.009374836459755898, 0.00017647426284383982, 0.019326183944940567, 0.011556402780115604, 0.008837634697556496, -0.014072082005441189, -0.047483451664447784, -0.019155850633978844, -0.0039209225215017796, -0.0020390760619193316, 0.019234465435147285, -0.01626019924879074, -0.004851199686527252, -0.0033476881217211485, 0.0017753883730620146, -0.0011669411323964596, 0.0011669411323964596, 0.034040287137031555, -0.003953678533434868, 0.015657484531402588, -0.008876942098140717, -0.03186527267098427, -0.03846893087029457, -0.010554061271250248, -0.009486207738518715, 0.03191768378019333, 0.010285460390150547, 0.041927993297576904, -0.024278927594423294, 0.03202250227332115, 0.043264444917440414, 0.005755271762609482, -0.007527384907007217, 0.004140389151871204, -0.0076649608090519905, 0.01990269310772419, -0.00906037725508213, -0.02091158553957939, 0.025680894032120705, -0.01228359155356884, 0.014976154081523418, -0.010979892686009407, 0.034931257367134094, -0.0028661713004112244, -0.058646779507398605, 0.02181565761566162, 0.03692283853888512, 0.02772488445043564, -0.004248484969139099, -0.028432419523596764, -0.016980836167931557, 0.002910392126068473, -0.01297147199511528, 0.022051503881812096, 0.019326183944940567, -0.010462343692779541, 0.0061581735499203205, -0.03244178369641304, -0.011595710180699825, 0.014976154081523418, 0.016849812120199203, 0.005483394954353571, -0.0022634563501924276, 0.04087979346513748, 0.0029153055511415005, -0.023453470319509506, 0.009597579017281532, -0.015159589238464832, 0.006659344304352999, -0.016024354845285416, 0.015565766952931881, -0.022051503881812096, -0.009211055934429169, 0.030266769230365753, -0.0028186747804284096, -0.021592915058135986, 0.02138327620923519, -0.006272820755839348, -0.031210148707032204, -0.04022466763854027, 0.000992514193058014, 0.008438007906079292, 0.02040058746933937, -0.014216209761798382, -0.02589053474366665, -0.008333188481628895, 0.016011251136660576, 0.0157098937779665, 0.004546566400676966, -0.02126535400748253, 0.00880487821996212, 0.08810119330883026, -0.021920477971434593, -0.03611048310995102, 0.055869050323963165, 0.007946664467453957, 0.004445022437721491, -0.018238676711916924, -0.00336079066619277, -0.017465628683567047, 0.004510534927248955, -0.018317291513085365, 0.035507768392562866, -0.008051484823226929, -0.025772612541913986, 0.012113259173929691, 0.018893800675868988, -0.016378121450543404, -0.0016558280913159251, 0.012624256312847137, 0.01531681977212429, 0.0029742668848484755, -0.05316993594169617, -0.02358449436724186, 0.006852606311440468, -0.0004684142768383026, -0.008831082843244076, 0.02493405155837536, 0.011661222204566002, -0.011733286082744598, 0.02869446948170662, 0.00838559865951538, 0.012198424898087978, -0.03663458302617073, 0.001770474947988987, 0.016089865937829018, 0.027698678895831108, -0.03010953962802887, 0.005123076494783163, 0.007212924771010876, 0.006990182213485241, -0.01852693036198616, 0.0005269660614430904, -0.018828289583325386, 0.013154907152056694, -0.0014814011519774795, 0.010816111229360104, -0.021160533651709557, 0.008503520861268044, -0.014045877382159233, -0.00018261605873703957, -0.00951896421611309, 0.012421167455613613, 0.03013574331998825, -0.03417131304740906, -0.038285497575998306, 0.0008021185058169067, 0.017819397151470184, -0.0034983668010681868, 0.015605074353516102, 0.037708986550569534, -0.034983668476343155, -0.004310721531510353, -0.01906413398683071, 0.016496043652296066, -0.016993939876556396, -0.026991143822669983, -0.004625181667506695, 0.0025173171889036894, -0.037787601351737976, 0.01950961910188198, -0.022876961156725883, -0.005578388459980488, -0.013954159803688526, -0.015985047444701195, 0.017924215644598007, 0.006082834210246801, -0.01937859319150448, 0.02045299857854843, -0.022549398243427277, 0.008451110683381557, -0.0198895912617445, 0.010128230787813663, 0.003054519649595022, -0.00352457189001143, -0.009722053073346615, -0.012650460936129093, 0.02222183533012867, -0.020557818934321404, -0.01156950555741787, -0.005250826012343168, -0.025562971830368042, 0.0078090885654091835, -0.003989710472524166, -0.03202250227332115, 0.016980836167931557, -0.02222183533012867, 0.00135610846336931, -0.0315508134663105, 0.012565295211970806, 0.01711186207830906, 0.017884908244013786, 0.0007329209474846721, 0.037315912544727325, -0.010783355683088303, -0.04963225871324539, 0.01808144710958004, -0.05128317326307297, 0.001451920485123992, -0.009564823471009731, 0.017780089750885963, 0.028013139963150024, -0.0019997686613351107, 0.010416485369205475, 0.00324286799877882, -0.008614892140030861, 0.023728622123599052, -0.016469839960336685, 0.008857288397848606, 0.0004565401468425989, -0.0076649608090519905, 0.052488602697849274, -0.00403556926175952, 0.012447372078895569, 0.01107816118746996, -0.016928426921367645, -0.012421167455613613, -0.0170594509691, 0.021212942898273468, -0.004130562301725149, -0.005162383895367384, -0.012021541595458984, -0.000661676109302789, 0.010632677003741264, 0.024383747950196266, -0.002993920585140586, -0.0038292049430310726, -0.0030430550687015057, -0.011189532466232777, -0.026676684617996216, -0.02733180858194828, 0.016325712203979492, -0.02131776325404644, 0.0027744537219405174, 0.015067871659994125, -0.012198424898087978, -0.018671058118343353, -0.021435685455799103, -0.028117958456277847, -0.013810032047331333, -0.014032774604856968, 0.0038586854934692383, 0.00486757792532444, -0.033594802021980286, 0.027436628937721252, -0.02135707065463066, -0.008857288397848606, 0.010285460390150547, -0.013836237601935863, 0.02456718310713768, -0.004952744115144014, 0.028537239879369736, 0.010861970484256744, 0.016587762162089348, 0.0010875072330236435, 0.05754616856575012, 0.011189532466232777, -0.0022225112188607454, 0.022588705644011497, -0.0006199118797667325, -0.006325230468064547, 0.010324767790734768, -0.013927954249083996, -0.003259246237576008, 0.029270978644490242, -0.031262557953596115, -0.0018277984345331788, 0.002979180309921503, 0.006050078198313713, 0.015945740044116974, 0.02958543971180916, -0.015015462413430214, -0.03375203162431717, -0.01320731732994318, 0.007363603450357914, -0.015211999416351318, -0.00579457962885499, 0.02137017250061035, 0.01943100430071354, 0.00021393921633716673, 0.0017786640673875809, 0.0019637367222458124, 0.027986934408545494, 0.014124492183327675, -0.007612551096826792, 0.018199369311332703, -0.0038095510099083185, -0.014019671827554703, -0.02686011977493763, 0.025314025580883026, 0.02634912170469761, 0.05094251036643982, -0.010816111229360104, -0.01894621178507805, 0.018330393359065056, -0.002045627450570464, -0.025641586631536484, 0.00614179577678442, 0.0031986471731215715, -0.0059026749804615974, 0.004196074791252613, 0.02725319378077984, -0.0019047755049541593, -0.004566220100969076, 0.03904544189572334, -0.038154471665620804, -0.00790080614387989, 0.0025533491279929876, 0.012165668420493603, 0.006308852694928646, -0.03668699413537979, 0.005014980677515268, 0.003426303155720234, 0.008470764383673668, -0.022916268557310104, -0.024881642311811447, 0.021422583609819412, -0.006767439655959606, 0.010344421491026878, -0.00878522451967001, 0.005565285682678223, -0.010187191888689995, -0.03228455409407616, -0.004061774350702763, -0.006754337344318628, 0.038678571581840515, -0.03288726881146431, 0.005044461693614721, -0.020636433735489845, -0.03147219866514206, 0.03100050799548626, -0.033175524324178696, -0.03194388747215271, 0.0170594509691, -0.030292974784970284, 0.010901277884840965, 0.009512413293123245, 0.014399644918739796, 0.017884908244013786, -0.03749934583902359, -0.00532944081351161, -0.015343024395406246, 0.012453923933207989, 0.00836594495922327, -0.03715868294239044, 0.005817508790642023, -0.008942454122006893, -0.005208242684602737, -0.02819657512009144, 0.00336079066619277, -0.014779617078602314, -0.01669258251786232, 0.015159589238464832, 0.02971646375954151, -0.023479675874114037, -0.01574920117855072, -0.003054519649595022, 0.011707081459462643, -0.003501642495393753, -0.006557799875736237, -0.006977079901844263, 0.008634545840322971, 0.025798818096518517, 0.00646935822442174, -0.002175014466047287, 0.0157098937779665, 0.03742073103785515, -0.012290142476558685, -0.021422583609819412, 0.007553589530289173, -0.019719257950782776, 0.03144599497318268, 0.043316856026649475, 0.005434260703623295, -0.019286876544356346, 0.03524571657180786, 0.0007165428251028061, -0.010973341763019562, -0.005643900949507952, 0.010547510348260403, 0.00463173259049654, 0.01390174962580204, -0.011962580494582653, 0.0111240204423666, -0.009407592937350273, -0.0006428412743844092, -0.02354518696665764, 0.0058633675798773766, -0.009453452192246914, 0.019273772835731506, 0.04397198185324669, 0.02135707065463066, 0.02916615828871727, -0.005663554649800062, -0.010364075191318989, 0.011458134278655052, 0.017858704552054405, -0.013023882173001766, 0.03597945719957352, 0.03553397208452225, 0.029323389753699303, 0.0011309093097224832, -0.0010711291106417775, -0.006787093821913004, 0.006439877673983574, -0.001894948654808104, 0.0053490945138037205, -0.008143202401697636, -0.0042681386694312096, 0.01527751237154007, 0.024789925664663315, 0.0025107660330832005, 0.022536294534802437, 0.009027620777487755, -0.027043554931879044, 0.06787093728780746, -0.03325413912534714, 0.003400098066776991, -0.0024599938187748194, 0.0074356673285365105, -0.01757044903934002, 0.021160533651709557, -0.015578869730234146, 0.029742669314146042, -0.02218252792954445, 0.010252703912556171, 0.02033507637679577, -0.008614892140030861, 0.022876961156725883, 0.007448769640177488, -0.030371589586138725, 0.00922415778040886, 0.006168000400066376, 0.022117014974355698, -0.011261596344411373, -0.030738458037376404, 0.048872314393520355, 0.02408239059150219, 0.01019374281167984, 0.0033706175163388252, -0.00854937918484211, 0.0026270507369190454, 0.024907847866415977, 0.001754096825607121, -0.034564387053251266, -0.006580729503184557, 0.011897067539393902, 0.0315508134663105, -0.018343497067689896, -0.019286876544356346, 0.00787460058927536, -0.0074356673285365105, 0.00387178803794086, 0.03369962424039841, 9.100094030145556e-05, 0.003999537322670221, 0.026991143822669983, 0.03063363954424858, 0.011667774058878422, 0.007173617370426655, -0.015133384615182877, 0.02216942608356476, -0.004264862742275, -0.010586817748844624, 0.03055502474308014, 0.01413759496062994, 0.02367621287703514, -0.002360087353736162, 0.014085184782743454, 0.027672475203871727, 0.019195158034563065, -0.006610210053622723, -0.04724760726094246, 0.00461207889020443, -0.007258783560246229, -0.00030340469675138593, 0.006348160095512867, 0.015421639196574688, 0.006452979985624552, 0.01952272094786167]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"2(BiTBi)−1BiT△i
BAi
⋆T(CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2)|
≤ηδi
2r(2 +ϵ)
2(1−ϵ)2(3
2∥△i
BΣi
⋆1/2∥2
F+1
2∥△i
AΣi
⋆1/2∥2
F).(14)
Next, consider bounding
|tr((1−η)Σi
⋆1/2△i
ATCBi(BiTBi)−1Σi
⋆1/2)|
≤(1−η)X
j̸=i|tr(Σi
⋆1/2△i
ATCT
iCj(Aj
tBj
tT−Xj
⋆)Bi(BiTBi)−1Σi
⋆1/2)|
≤(1−η)X
j̸=i∥CT
iCj∥2∥Aj
tBj
tT−Xj
⋆∥F∥Bi(BiTBi)−1Σi
⋆△i
AT∥F
by Lemma 12 in (Tong et al., 2021b),
≤1−η
1−ϵX
j̸=i∥CT
iCj∥2∥Aj
tBj
tT−Xj
⋆∥F∥△i
AΣi
⋆1/2∥F
by derivation in (7),
≤(2 +ϵ)(1−η)
2(1−ϵ)X
j̸=i∥CT
iCj∥2(∥△j
AΣj
⋆1/2∥F+∥△j
BΣj
⋆1/2∥F)∥△i
AΣi
⋆1/2∥F,(15)
17
Riemannian Preconditioned LoRA
and
|tr(ηΣi
⋆1/2(BiTBi)−1BiT△i
BAi
⋆TCBi(BiTBi)−1Σi
⋆1/2)|
=η|tr(X
j̸=iCT
iCj(Aj
tBj
tT−Xj
⋆)Bi(BiTBi)−1Σi
⋆(BiTBi)−1BiT△i
BAi
⋆T)|
≤ηX
j̸=i∥CT
iCj∥2∥Aj
tBj
tT−Xj
⋆∥F∥Bi(BiTBi)−1Σi
⋆(BiTBi)−1BiT△i
BAi
⋆T∥F
≤ηX
j̸=i∥CT
iCj∥2∥Aj
tBj
tT−Xj
⋆∥F∥Bi(BiTBi)−1Σi
⋆1/2∥2
2∥△i
BLi
⋆T∥F
by Lemma 12 in (Tong et al., 2021b),
≤η
(1−ϵ)2X
j̸=i∥CT
iCj∥2∥Aj
tBj
tT−Xj
⋆∥F∥△i
BAi
⋆T∥F
by derivation in (7),
≤η(2 +ϵ)
2(1−ϵ)2X
j̸=i∥CT
iCj∥2(∥△j
AΣj
⋆1/2∥F+∥△j
BΣj
⋆1/2∥F)∥△i
BAi
⋆T∥","[-0.0017490573227405548, -0.04482242465019226, 0.01488476898521185, 0.03426988422870636, -0.02548903599381447, 0.014031254686415195, 0.0038214155938476324, -0.01717373915016651, -0.011625897139310837, 0.03874436765909195, 0.005263336934149265, 0.01853160187602043, -0.027545228600502014, -0.00033926378819160163, 0.022643988952040672, -0.004940036218613386, 0.027027947828173637, -0.035330310463905334, -0.0297695379704237, 0.05369379743933678, -0.007810947485268116, -0.009097684174776077, 0.03512340039014816, 0.021868066862225533, -0.008360559120774269, -0.01656593382358551, 0.02824355848133564, -0.01599692367017269, 0.052116088569164276, -0.01970841735601425, 0.03739943727850914, -0.034373342990875244, 0.015298593789339066, -0.07635071873664856, 0.007125549949705601, 0.10154231637716293, 0.008470481261610985, 0.038640912622213364, 0.03147656470537186, 0.005392657592892647, 0.04342576488852501, -0.010015859268605709, -0.08317883312702179, -0.01111508160829544, -0.015505506657063961, -0.004881842061877251, -0.001952736871317029, 0.011050421744585037, 0.007468248717486858, 0.029950587078928947, -0.010196907445788383, 0.047977838665246964, -0.017432378605008125, -0.03406297415494919, -0.016630593687295914, 0.006744054611772299, 0.009175276383757591, 0.04125318303704262, 0.05803896114230156, -0.03357155621051788, 0.0346837118268013, 0.004328997805714607, 0.04104626923799515, -0.042960211634635925, -0.04539143294095993, -0.03512340039014816, -0.02451913245022297, 0.013119546696543694, 0.0463225394487381, -0.018945427611470222, -0.044874150305986404, 0.014393351972103119, 0.03173520788550377, 0.022049114108085632, 0.002082057064399123, -0.002106304746121168, 0.012835041619837284, 0.03877023234963417, 0.10154231637716293, -0.038071904331445694, 0.0591769777238369, 0.006834579166024923, 0.0717986449599266, -0.005712725222110748, 0.0401410274207592, -0.05431453511118889, -0.03114033304154873, 0.02710554003715515, -0.07143654674291611, 0.009802480228245258, -0.014923565089702606, 0.004952968098223209, 0.013927798718214035, 0.003260488621890545, 0.040063437074422836, -0.015233933925628662, 0.005770919378846884, -0.01372088585048914, 0.014251099899411201, 0.027596956118941307, 0.02842460758984089, -0.01422523520886898, 0.06528089940547943, 0.001695712679065764, 0.019346321001648903, 0.01717373915016651, -0.011218537576496601, -0.027778005227446556, -0.051728129386901855, 0.002933954820036888, 0.026355480775237083, 0.007985529489815235, 0.009045956656336784, 0.024105308577418327, 0.018182437866926193, -0.070091612637043, -0.05922870710492134, -0.0052795023657381535, -0.04290848225355148, -0.0018929261714220047, -0.003662998089566827, -0.02943330444395542, 0.03649419546127319, -0.02102748490869999, 0.009828343987464905, -0.027183132246136665, 0.0417187362909317, -0.05798723176121712, -0.0432964451611042, -0.05762513354420662, 0.07221246510744095, 0.020510202273726463, 0.01944977603852749, -0.002444154117256403, -0.0006591295241378248, 0.017264263704419136, 0.030079906806349754, 0.0672982931137085, 0.028967751190066338, -0.047615744173526764, 0.02590285986661911, 0.027778005227446556, -0.010203373618423939, 0.0027351249009370804, -0.03716665878891945, 0.023044880479574203, -0.025786472484469414, -0.00817951001226902, -0.003127935342490673, -0.008451082743704319, -0.013138944283127785, -0.003853745525702834, -0.04637426882982254, -0.028709111735224724, 0.0034884156193584204, -0.014289896003901958, -0.003866677638143301, 0.054831817746162415, 0.037709806114435196, -0.010752984322607517, -0.03620969131588936, 0.012763915583491325, -0.01306135207414627, 0.00372442533262074, 0.056176748126745224, 0.03018336370587349, -0.001007082057185471, 0.02515280246734619, -0.05591810867190361, -0.04968486726284027, 0.003546609776094556, -0.0017910865135490894, -0.03426988422870636, -0.029174664989113808, 0.026588257402181625, -0.01986360177397728, -0.00886490847915411, -0.039054736495018005, 0.034994080662727356, 0.016281427815556526, 0.017975524067878723, 0.04846925660967827, 0.0021289358846843243, 0.02845047041773796, -0.03677869960665703, 0.029303984716534615, 0.03057132475078106, 0.006433685775846243, 0.011755216866731644, 0.007125549949705601, 0.005088754463940859, 0.018156573176383972, 0.025838200002908707, 0.001732892356812954, 0.01489770133048296, -0.04146009683609009, 0.020691251382231712, 0.02881256677210331, 0.013539837673306465, 0.05907352268695831, 0.05824587121605873, 0.028295285999774933, 0.020898163318634033, 0.02162235789000988, -0.02179047465324402, -0.007403588388115168, -0.0016924797091633081, 0.013889002613723278, -0.039804793894290924, -0.010927567258477211, 0.0002208548685302958, -0.016436612233519554, -0.00646924925968051, 0.011548304930329323, -0.004060658160597086, 0.06140128895640373, -0.018182437866926193, 0.04942622780799866, -0.022695716470479965, 0.052504051476716995, -0.007933801971375942, 0.022333620116114616, -0.012136711739003658, 0.00044898397754877806, -0.03142483904957771, 0.030312683433294296, 0.06517744064331055, 0.003359095426276326, 0.02432515285909176, -0.06745348125696182, 0.043761998414993286, 0.007073821499943733, -0.033416371792554855, -0.012375954538583755, 0.04694327712059021, -0.0431671217083931, -0.016449544578790665, -0.026433072984218597, -0.024286355823278427, -0.014574400149285793, 0.01734185591340065, 0.024687249213457108, -0.0014508123276755214, -0.030105771496891975, 0.008037257939577103, -0.023691482841968536, 0.00934339314699173, -0.02826942317187786, -0.01613917574286461, 0.025864064693450928, -0.014794244430959225, -0.008017860352993011, -0.0076363650150597095, 0.0028515129815787077, -0.05710785463452339, 0.024299288168549538, -0.0035789399407804012, 0.022087911143898964, -0.009492111392319202, 0.036364875733852386, -0.05369379743933678, -0.022268960252404213, -0.039235785603523254, -0.03095928579568863, 0.02159649319946766, 0.00540558947250247, 0.006795783061534166, 0.03972720354795456, 0.004801016766577959, -0.018428144976496696, 0.011897469870746136, 0.042158424854278564, 0.017186671495437622, -0.002686629770323634, -0.028191830962896347, -0.011722886934876442, 0.015621894970536232, 0.04577939212322235, -0.04264984279870987, -0.01510461326688528, 0.0022469405084848404, 0.018854903057217598, 0.029303984716534615, -0.004927104339003563, 0.025062277913093567, -0.06015981361269951, -0.026821034029126167, -0.0018589795799925923, -0.01528566237539053, -0.01510461326688528, 0.01575121469795704, -0.010377955622971058, 0.02376907505095005, 0.017988456413149834, -0.03170934319496155, 0.0010644679423421621, -0.007616966962814331, -0.04288261756300926, -0.0027238093316555023, 0.00466523040086031, 0.03525272011756897, 0.014923565089702606, -0.0006591295241378248, 0.045262113213539124, -0.019786009564995766, 0.008936034515500069, 0.008341160602867603, 0.022514667361974716, 0.012932032346725464, 0.007681627292186022, 0.018208300694823265, 0.033778466284275055, -0.04640012979507446, -0.00452944403514266, -0.0491158589720726, -0.02671757899224758, 0.02454499714076519, -0.047434695065021515, 0.023911327123641968, -0.04805543273687363, 0.008270034566521645, -0.049555547535419464, -0.006614734418690205, -0.022915560752153397, 0.01598399132490158, 0.005289201159030199, -0.030933421105146408, 0.004160881508141756, 1.7806802134145983e-05, -0.04691741243004799, -0.014251099899411201, 0.008160112425684929, 0.048029568046331406, -0.03822708874940872, 0.004319298546761274, 0.007216074038296938, -0.010946964845061302, 0.026239093393087387, 0.007940268144011497, 0.05284028500318527, -0.04769333451986313, -0.022643988952040672, -0.006278501823544502, 0.03639073669910431, 0.0030050810892134905, -0.0030681246425956488, 0.03680456429719925, -0.04339990019798279, 0.06941914558410645, 0.05726303905248642, -0.023497503250837326, -0.031450703740119934, 0.025993384420871735, 0.014302827417850494, -0.05984944477677345, -0.016320224851369858, 0.01089523732662201, -0.028088374063372612, -0.029303984716534615, -0.010054655373096466, -0.031864527612924576, -0.007772151380777359, 0.047460559755563736, 0.00036088452907279134, -0.003908706828951836, 0.03370087593793869, 0.02492002584040165, 0.049581412225961685, 0.008024325594305992, -0.014729584567248821, -0.006162113510072231, 0.04999523609876633, -0.025670083239674568, -0.03959788382053375, -0.0452362485229969, -0.035744138062000275, 0.013707954436540604, 0.030079906806349754, 0.04833993688225746, -0.010856441222131252, -0.026407210156321526, -0.033959515392780304, -1.6670197510393336e-05, -0.0016973292222246528, -0.005104919895529747, 0.023626822978258133, -0.0047525218687951565, -0.028890158981084824, -0.02554076351225376, -0.008942500688135624, 0.02489416114985943, -0.0007581404061056674, 0.00041503741522319615, 0.028088374063372612, -0.024467404931783676, -0.029510896652936935, 0.022501736879348755, 0.10666339844465256, 0.027545228600502014, 0.022049114108085632, -0.01925579644739628, -0.024079443886876106, -0.05721130967140198, -0.008606267161667347, -0.031269654631614685, -0.00016508546832483262, 0.024234628304839134, 0.045287977904081345, 0.01344931311905384, 0.008806713856756687, -0.004047726280987263, 0.006404588930308819, 0.025618355721235275, -0.038459863513708115, 0.021389581263065338, 0.003234624629840255, -0.042727433145046234, 0.06419460475444794, -0.0017151107313111424, 0.030519595369696617, -0.003352629253640771, 0.020355017855763435, -0.020497271791100502, -0.012744517996907234, -0.06000462919473648, 0.025049345567822456, 0.02592872455716133, -0.0024797171354293823, 0.012518207542598248, -0.04968486726284027, 0.016979757696390152, 0.047408830374479294, 0.041356638073921204, 0.023523366078734398, -0.06072882190346718, -0.006107151973992586, 0.028476335108280182, -0.010177508927881718, 0.009175276383757591, -0.031217925250530243, -0.021273192018270493, -0.01906181499361992, 0.01374675054103136, -0.0013489725533872843, 0.010778849013149738, 0.04583112150430679, 0.01246647909283638, -0.02197152189910412, -0.02023863047361374, 0.031114470213651657, -0.03147656470537186, -0.01498822495341301, 0.049193449318408966, 0.014005390927195549, -0.017820339649915695, -0.04112386330962181, 0.05746994912624359, -0.0013408900704234838, 0.01579001173377037, -0.011483644135296345, 0.04045139625668526, -0.034554388374090195, 0.009783082641661167, -0.023419911041855812, 0.015815874561667442, 0.03253699466586113, 0.02492002584040165, -0.014354555867612362, 0.0044906483963131905, -0.010759450495243073, -0.019592028111219406, -0.05726303905248642, 0.04795197397470474, -0.017083214595913887, -0.0020157804246991873, 0.024829501286149025, 0.031036878004670143, -0.04575353115797043, 0.0017151107313111424, -0.0032022944651544094, 0.020949892699718475, -0.03057132475078106, -0.0171608068048954, -0.016436612233519554, 0.02964021824300289, 0.09104150533676147, 0.06326349824666977, -0.01872558332979679, 0.020419679582118988, -0.018221233040094376, -0.005185744725167751, -0.014393351972103119, 0.051133256405591965, -0.014445079490542412, -0.016708185896277428, -0.0274676363915205, -0.040063437074422836, -0.011645294725894928, -0.019747212529182434, -0.03158002346754074, 0.06362559646368027, 0.03375260531902313, 0.03235594555735588, 0.022695716470479965, -0.03000231459736824, -0.0218292698264122, -0.006281734444200993, -0.022876765578985214, -0.013552770018577576, 0.011612964794039726, -0.003478716593235731, 0.01730305887758732, 0.03967547416687012, 0.018971290439367294, -0.015298593789339066, 0.008069587871432304, -0.02938157692551613, 0.003352629253640771, -0.006404588930308819, -0.010668926872313023, 0.018984222784638405, -0.04153768718242645, -0.007203141693025827, -0.04533970355987549, 0.02573474310338497, -0.002427989151328802, -0.02123439684510231, -0.061039190739393234, -0.03530444949865341, -0.042960211634635925, 0.029459169134497643, -0.014639060012996197, -0.025036415085196495, 0.03178693354129791, -0.013093682937324047, 0.009737820364534855, 0.005418521352112293, -0.018260030075907707, -0.028295285999774933, -0.015712419524788857, 0.021467173472046852, -0.007351860404014587, -0.006242938339710236, 0.0029323382768779993, 0.022243095561861992, -0.038640912622213364, -0.004448619205504656, -0.011916867457330227, -0.007849743589758873, 0.02964021824300289, 0.006853977218270302, -0.014031254686415195, 0.000779559079091996, -0.004720191936939955, -0.011561236344277859, -0.018570398911833763, 0.035511359572410583, -0.00935632549226284, 0.002301901811733842, 0.021570630371570587, -0.0004546417621895671, 0.008056656457483768, 0.003208760404959321, -0.024609657004475594, -0.02436394803225994, 0.07190209627151489, -0.025838200002908707, -0.02705381065607071, 0.03858918324112892, 0.04202910512685776, -0.029872994869947433, 0.005670696031302214, 0.01654006913304329, 0.0323818102478981, -0.011464246548712254, -0.024674316868185997, 0.06797076016664505, -0.0076751611195504665, -0.020161038264632225, -0.02940744161605835, -0.03959788382053375, 0.0026591490022838116, 0.0035886389669030905, 0.014057119376957417, -0.04109799861907959, 0.005437919404357672, -0.01928165927529335, 0.0035757068544626236, -0.008696791715919971, 0.0041091530583798885, 0.03830467909574509, -0.014289896003901958, 0.016022788360714912, 0.005984297953546047, 0.003475483739748597, 0.01207851804792881, -0.026743441820144653, 0.052297137677669525, 0.0048689101822674274, 0.007681627292186022, 0.031864527612924576, -0.017083214595913887, 0.02533385157585144, -0.017367718741297722, -0.028398742899298668, -0.011173276230692863, -0.007461782544851303, 0.004736356902867556, 0.0004809099482372403, 0.0005326380487531424, 0.002769071375951171, 0.03657178580760956, 0.013526905328035355, 0.025178667157888412, -0.0077527533285319805, -0.022049114108085632, 0.0071190837770700455, -0.02958848886191845, 0.06036672741174698, -0.002174197928979993, -0.013113080523908138, -0.01694096252322197, 0.009550306014716625, 0.010352091863751411, -0.009149412624537945, 0.017393583431839943, -0.02728658728301525, -0.008554539643228054, 0.020148105919361115, 0.009181742556393147, -0.01886783540248871, -0.0018395815277472138, 0.010287432000041008, -0.0062138414941728115, -0.05312478914856911, 0.005738589446991682, 0.019967056810855865, 0.05175399407744408, -0.015130477957427502, -0.037890855222940445, 0.03858918324112892, 0.012615197338163853, 0.00028915214352309704, -0.04521038383245468, 0.033416371792554855, 0.028528062626719475, 0.001577707938849926, 0.012039721943438053, -0.05410762131214142, -0.045262113213539124, -0.01413471158593893, -0.018777310848236084, 0.04148595780134201, 0.00439042504876852, 0.023898394778370857, -0.026795171201229095, -0.029459169134497643, 0.0020238631404936314, -0.008315296843647957, -0.032019712030887604, -0.0117940129712224, 0.005783851258456707, -0.0006934802513569593, 0.018777310848236084, -0.009686091914772987, -0.0120655857026577, 0.016462476924061775, 0.028010781854391098, -0.009188208729028702, 0.00839288905262947, 0.06455670297145844, 0.0308041013777256, 0.0028757606633007526, 0.022527599707245827, 0.0042643374763429165, -0.02256639674305916, -0.007655763067305088, -0.030079906806349754, -0.0323818102478981, 0.004610269330441952, -0.03173520788550377, -0.007429452612996101, -0.004358094651252031, -0.004206143319606781, -0.02353629842400551, -0.01964375749230385, 0.0021030716598033905, 0.003352629253640771, -0.04189978539943695, -0.010901703499257565, -0.008160112425684929, 0.021337853744626045, 0.061815112829208374, -0.032252486795186996, 0.022437075152993202, 0.00035866184043698013, -0.019139407202601433, 0.015311526134610176, -0.0019624358974397182, -0.05224540829658508, -0.0028789937496185303, 0.019126474857330322, -0.012472945265471935, -0.03602864220738411, -0.02925225719809532, -0.022268960252404213, 0.0017878534272313118, 0.023665618151426315, 0.06647064536809921, -0.024195831269025803, -0.00467816274613142, 0.004286968614906073, -0.0034819496795535088, -0.005825880449265242, 0.010882304981350899, 0.02671757899224758, 0.03251112997531891, 0.04505519941449165, -0.006950967479497194, 0.003892541630193591, -0.003082673065364361, -0.006905705202370882, -0.04484828934073448, -0.00848341267555952, 0.023717347532510757, -0.006931569427251816, -0.03351982682943344, 0.01460026390850544, 0.013307061046361923, 0.005602803081274033, 0.025954589247703552, 0.0106107322499156, -0.0008551306091248989, 0.01791086420416832, -0.02105334773659706, 0.030545460060238838, -0.013565701432526112, 0.009711956605315208, -0.017432378605008125, 0.014820109121501446, 0.0002719768090173602, -0.058711424469947815, -0.021906862035393715, 0.005628666840493679, 0.024622589349746704, 0.01615210808813572, 0.027338316664099693, 0.06093573570251465, -0.02494589053094387, 0.030700644478201866, -0.019126474857330322, 0.009796014055609703, -0.03289908915758133, -0.04518451914191246, 0.003827881533652544, -0.00993180088698864, 0.007183743640780449, -0.0159451961517334, -0.017755679786205292, -0.011832809075713158, 0.00964729581028223, -0.0044906483963131905, -0.021143872290849686, -0.035149265080690384, -0.034580253064632416, 0.012110847979784012, -0.03602864220738411, -0.006692326627671719, 0.03695974871516228, -0.00598106486722827, -0.005809715483337641, -0.004985298495739698, 0.026200296357274055, -0.0025799404829740524, 0.02572181262075901, 0.0297695379704237, -0.015634827315807343, -0.02511400729417801, 0.008302364498376846, -0.04169287160038948, -0.012485876679420471, 0.009970596991479397, 0.019566165283322334, 0.02126026153564453, -0.01868678629398346, -0.007325996179133654, 0.009492111392319202, 0.00962789822369814, 0.0014580866554751992, -0.0038214155938476324, -0.001732892356812954, -0.017794476822018623, 0.006640598643571138, -0.0012835041852667928, 0.0020400281064212322, 0.044900014996528625, -0.024105308577418327, -0.0989559069275856, -0.00848341267555952, 0.026006316766142845, 0.02159649319946766, -0.018066048622131348, -0.006614734418690205, 0.002288969699293375, 0.020173970609903336, 0.027157267555594444, 0.005285968072712421, -0.009026558138430119, -0.015233933925628662, -0.02785559743642807, 0.011496576480567455, -0.007170811761170626, -0.007345394231379032, 0.007151413708925247, 0.00878085009753704, 0.04029621183872223, 0.015518439002335072, -0.015337389893829823, 0.007843277417123318, 0.012712188065052032, 0.045650072395801544, -0.02707967534661293, -0.007707491051405668, 0.008205374702811241, -0.031269654631614685, -0.0016528753330931067, 0.002924255793914199, 0.016320224851369858, 0.04055485129356384, 0.05586637929081917, 0.047408830374479294, -0.007028559688478708, 0.012492342852056026, 0.004788084886968136, 0.026252025738358498, 0.015427914448082447, 0.024195831269025803, -0.02124732919037342, -0.035925187170505524, 0.03460611775517464, -0.014845972880721092, 0.009970596991479397, -0.03509753569960594, 0.0025411443784832954, -0.044537920504808426, 0.011393120512366295, -0.00848341267555952, 0.013436381705105305, -0.0004970749723725021, 0.018777310848236084, -0.024648454040288925, -0.01333292480558157, -0.01315834280103445, -0.031062740832567215, 0.00991886854171753, -0.011354324407875538, 0.020536066964268684, -0.02710554003715515, 0.014639060012996197, 0.0405031256377697, -0.025411443784832954, -0.015440846793353558, -0.01654006913304329, -0.02826942317187786, 0.02883843146264553, -0.020148105919361115, -0.006595336366444826, 0.01792379654943943, -0.03470957279205322, -0.034218158572912216, -0.022049114108085632, -0.006647064350545406, 0.0034593185409903526, -0.039856523275375366, -0.007733355276286602, -0.03142483904957771, 0.0019850670360028744, 0.03809776529669762, -0.010442616418004036, 0.021738745272159576, 0.032640449702739716, -0.015828806906938553, -0.02123439684510231, 0.018596261739730835, -0.010694790631532669, 0.018363485112786293, 0.01373381819576025, -0.0007157071377150714, 0.02881256677210331, 0.008386422879993916, -0.0028159499634057283, 0.02532091923058033, 0.013669158332049847, -0.0031861294992268085, 0.006828112993389368, -0.008787316270172596, 0.01732892356812954, 0.009524441324174404, 0.002924255793914199, 0.022501736879348755, -0.015363254584372044, -0.04016689211130142, -0.005418521352112293, 0.01616504043340683, -0.017872069031000137, 0.015182205475866795, -0.03605450689792633, -0.002571858000010252, 0.0021709648426622152, -0.007494112476706505, -0.01674698106944561, 0.019514435902237892, -0.020355017855763435, 0.008030791766941547, 0.0070802876725792885, 0.008451082743704319, -0.01079824659973383, -0.010494343936443329, 0.017639292404055595, 0.012977294623851776, -0.006356094032526016, -0.00608128821477294, 0.0051631140522658825, -0.004493881016969681, 0.02726072445511818, -0.009640829637646675, 0.026976218447089195, 0.024648454040288925, 0.008961898274719715, 0.003766454290598631, -0.014755448326468468, 0.036339011043310165, 0.0006906513590365648, 0.010830576531589031, -0.020199833437800407, 0.004076823126524687, 0.014975293539464474, -0.026536529883742332, 0.0012333925114944577, 0.013268264941871166, -0.007358326110988855, -0.006356094032526016, -0.005838812328875065, -0.038071904331445694, -0.04425341263413429, -0.011140945367515087, 0.03804603964090347, 0.05201263353228569, 0.0005548649933189154, -0.0031489499378949404, 0.028010781854391098, -0.01756170019507408, 0.010927567258477211, -0.0010386038338765502, 0.0014572783838957548, -0.023678550496697426, 0.050564244389534, 0.03507167100906372, 0.058711424469947815, -0.004565007518976927, -0.006950967479497194, 0.045106928795576096, -0.005851744674146175, -0.044900014996528625, -0.030312683433294296, 0.03209730237722397, -0.004548842087388039, -0.014341623522341251, -0.07940267771482468, 0.009382189251482487, 0.027700413018465042, -0.020173970609903336, 0.012679857201874256, 0.00706088962033391, -0.008127782493829727, 0.0028822266031056643, 0.0002366157714277506, -0.0032928187865763903, 0.02123439684510231, -0.03297668322920799, 0.011347858235239983, 0.02065245620906353, -0.019527368247509003, 0.030907556414604187, -0.008677393198013306, 0.04076176509261131, 0.025644220411777496, 0.04347749054431915, 0.02063952386379242, 0.022695716470479965, 0.015414982102811337, 0.04655531421303749, 0.014199371449649334, 0.013798478059470654, 0.05390071123838425, 0.0008915019570849836, -0.0394168347120285, 0.0007747095660306513, 0.04262397810816765, 0.0002479313116054982, -0.050719428807497025, 0.004164114128798246, 0.03393365070223808, 0.019579097628593445, -0.008114850148558617, 0.0025831733364611864, -0.023484570905566216, 0.025579560548067093, 0.038252949714660645, -0.02824355848133564, -0.0027496733237057924, 0.014871836639940739, -0.0038699107244610786, 0.010086985304951668, 0.010494343936443329, 0.015544302761554718, -0.0032394740264862776, -0.012156110256910324, -0.022333620116114616, 0.005822647362947464, 0.029743673279881477, 0.016643526032567024, -0.005964899901300669, 0.023523366078734398, -0.002856362611055374, -0.023639755323529243, -0.008774383924901485, -0.015596031211316586, 0.04037380591034889, -0.05009869113564491, -0.005179279018193483, -0.014910632744431496, 0.036623515188694, 0.009537373669445515, -0.006120084319263697, -0.0008135056705214083, 4.6752327762078494e-05, 0.049555547535419464, 0.0052698031067848206, -0.015919331461191177, 0.018402282148599625, -0.014173507690429688, 0.005337696056813002, 0.05159880965948105, 0.05653884634375572, -0.02940744161605835, 0.004927104339003563, 0.011541838757693768, 0.028165966272354126, 0.00914294645190239, 0.01140605192631483, 0.01930752396583557, -0.005703025963157415, 0.007028559688478708, 0.0036274350713938475, 0.027803869917988777, -0.009563237428665161, -0.008632131852209568, 0.00962789822369814, 0.014005390927195549, 0.010397354140877724, -0.01150304265320301, -0.040425531566143036, -0.03434747830033302, 0.009860674850642681, -0.009065354242920876, 0.028579792007803917, -0.009505043737590313, -0.01906181499361992, -0.004012162797152996, 0.009640829637646675, 0.014328692108392715, 0.0005888115847483277, 0.03988238796591759, -0.004584405571222305, 0.024260492995381355, -0.010061120614409447, -0.03677869960665703, -0.022631056606769562, -0.02883843146264553, -0.007578170858323574, 0.0309851486235857, 0.015557235106825829, 0.030260955914855003, -0.02554076351225376, 0.03501994162797928, 0.04027034714818001, 0.00041180438711307943, -0.0028789937496185303, 0.001359479851089418, -0.0029969983734190464, 0.009272267110645771, -0.011341392062604427, -0.03251112997531891, 0.027338316664099693, -0.015660690143704414, 0.02023863047361374, -0.006892773322761059, 0.03543376922607422, -0.0064466181211173534, -0.06481534242630005, 0.027002083137631416, 0.03724425286054611, 0.018790243193507195, 0.000271572673227638, -0.02881256677210331, -0.011276732198894024, -0.013772614300251007, -0.00964729581028223, 0.02587699703872204, 0.017471175640821457, -0.006249404512345791, 0.006595336366444826, -0.018622126430273056, -0.008024325594305992, 0.007836811244487762, 0.02261812426149845, -0.000271572673227638, -0.0026494499761611223, 0.03354569151997566, 0.0058808415196835995, -0.023212997242808342, 0.007959665730595589, -0.022669851779937744, 0.004746055696159601, -0.010268033482134342, 0.007306598126888275, -0.014962361194193363, 0.001466977410018444, 0.030079906806349754, 0.014057119376957417, -0.017225466668605804, 0.035175126045942307, -0.01926872879266739, -0.022514667361974716, -0.04027034714818001, -0.008599800989031792, 0.005072589498013258, 0.01792379654943943, -0.012220770120620728, -0.03584759309887886, -0.0038084834814071655, 0.009589102119207382, 0.02084643580019474, 0.0059972298331558704, -0.042960211634635925, -0.0014677856815978885, 0.0904724970459938, -0.019747212529182434, -0.03483889624476433, 0.05726303905248642, 0.003811716567724943, 0.01528566237539053, -0.021868066862225533, -0.005525210872292519, -0.019566165283322334, 0.014820109121501446, -0.030648916959762573, 0.029510896652936935, 0.003672697115689516, -0.022113775834441185, 0.006194443441927433, 0.015052885748445988, -0.012802711687982082, -0.0021289358846843243, 0.016100380569696426, 0.018751446157693863, -0.001745824352838099, -0.055607739835977554, -0.01374675054103136, 0.007468248717486858, -0.001797552453354001, -0.007940268144011497, 0.03579586371779442, 0.01833762228488922, 0.0008135056705214083, 0.03114033304154873, 0.008677393198013306, 0.006533909123390913, -0.03814949467778206, 0.010009393095970154, 0.0037987844552844763, 0.023096609860658646, -0.021958591416478157, 0.005699793342500925, 0.009673160500824451, -0.00039281047065742314, -0.009220538660883904, -0.0018735281191766262, -0.023471638560295105, 0.009136480279266834, -0.006178278475999832, 0.012356556951999664, -0.02318713441491127, 0.00983481016010046, -0.01071418821811676, 0.0011832809541374445, -0.007144948001950979, 0.004506813362240791, 0.014393351972103119, -0.023885464295744896, -0.025230394676327705, 0.004978832323104143, 0.01717373915016651, 0.0063690259121358395, 0.020329155027866364, 0.045675937086343765, -0.03168347850441933, 0.0006393273361027241, -0.02744177170097828, -0.0027981684543192387, -0.02573474310338497, -0.01983773708343506, 0.0022954356390982866, 0.002389193046838045, -0.051340166479349136, 0.005499346647411585, -0.013863138854503632, -0.004403356928378344, -0.006443385034799576, -0.013488109223544598, 0.005256871227174997, 0.011871605180203915, -0.021156804636120796, 0.017613427713513374, -0.00935632549226284, -0.0008527058525942266, -0.00031077288440428674, 0.013164808973670006, -0.0016730816569179296, 0.005576938856393099, -0.021661153063178062, -0.009699024260044098, 0.023432841524481773, -0.022281890735030174, -0.021518900990486145, 0.005331230349838734, -0.008056656457483768, 0.0023099842946976423, 0.013953662477433681, -0.024389812722802162, 0.00608128821477294, -0.024014784023165703, 0.0021418677642941475, -0.027338316664099693, 0.021337853744626045, 0.02159649319946766, 0.013785546645522118, 0.003879609750583768, 0.030054042115807533, -0.013371720910072327, -0.05291787534952164, 0.030131634324789047, -0.04045139625668526, -0.0022307755425572395, -0.005887307692319155, 0.031269654631614685, 0.0212214644998312, -0.010494343936443329, 0.008166578598320484, 0.01654006913304329, -0.007578170858323574, 0.027752140536904335, -0.003144100308418274, 0.014755448326468468, -0.005887307692319155, 0.0014904167037457228, 0.05061597377061844, -0.008573937229812145, 0.006912171375006437, 0.017885001376271248, -0.005576938856393099, -0.007390656508505344, -0.026976218447089195, 0.0194627083837986, -0.007022093515843153, -0.006899239029735327, -0.016798710450530052, 0.0007007545209489763, 0.008237704634666443, 0.014005390927195549, -0.007138481829315424, 6.238694913918152e-05, -0.004274036735296249, -0.015621894970536232, -0.02627788856625557, -0.03142483904957771, 0.026381345465779305, -0.012880303896963596, 0.017613427713513374, 0.014419215731322765, -0.009563237428665161, -0.0257088802754879, -0.016216767951846123, -0.03214903175830841, 0.0005241514299996197, -0.009750752709805965, 0.008981296792626381, 0.013210071250796318, -0.032252486795186996, 0.012020324356853962, -0.023510433733463287, 0.002355246338993311, 0.014458011835813522, -0.007920869626104832, 0.009130015037953854, -0.009479179978370667, 0.03168347850441933, 0.017044417560100555, 0.02529505454003811, -0.0032022944651544094, 0.0482623428106308, 0.0029161733109503984, -0.004063891246914864, 0.022307755425572395, 0.012026789598166943, -0.003844046499580145, 0.005156647879630327, -0.008884306065738201, -0.004552075173705816, 0.029097072780132294, -0.030623052269220352, -0.0038763766642659903, 0.009621432051062584, -0.001616504043340683, 0.02432515285909176, 0.037864990532398224, -0.011173276230692863, -0.030131634324789047, -0.024997618049383163, 0.011367255821824074, -0.014742516912519932, 0.0005261720507405698, 0.01613917574286461, 0.014755448326468468, 0.005903472658246756, -0.007946733385324478, 0.011709955520927906, 0.03158002346754074, 0.01488476898521185, -0.003271804191172123, 0.024053579196333885, -0.010377955622971058, -0.004901240114122629, -0.026381345465779305, 0.024700181558728218, 0.02785559743642807, 0.058142416179180145, -0.018363485112786293, -0.01501408964395523, 0.014289896003901958, 0.0041382503695786, -0.021777542307972908, 0.008981296792626381, 0.01401832327246666, -0.009117082692682743, 0.004012162797152996, 0.02203618362545967, -0.007539374753832817, 0.009453315287828445, 0.041563551872968674, -0.02860565483570099, -0.021376648917794228, -0.0019737514667212963, 0.0159451961517334, -0.001957586267963052, -0.03584759309887886, 0.01189100369811058, 0.00962789822369814, 0.01677284575998783, -0.020161038264632225, -0.014483875595033169, 0.02239827997982502, -0.0044809491373598576, 0.003685629228129983, -0.01410884689539671, 0.0022922027856111526, -0.017484107986092567, -0.026368413120508194, -0.0024005083832889795, -0.004316065926104784, 0.029717810451984406, -0.032847363501787186, -0.012912633828818798, -0.024635521695017815, -0.024842433631420135, 0.0338301956653595, -0.03116619773209095, -0.027183132246136665, 0.010908168740570545, -0.04342576488852501, 0.0069251032546162605, 0.005363560281693935, 0.017277194187045097, 0.015841739252209663, -0.031243789941072464, -0.0012624895898625255, -0.009472713805735111, 0.013255332596600056, 0.01119913998991251, -0.02782973274588585, -0.002872527576982975, -0.010416751727461815, -0.009401587769389153, -0.031812798231840134, 0.006659996695816517, -0.015246866270899773, -0.012194906361401081, 0.027984917163848877, 0.023057812824845314, -0.020587794482707977, -0.020342087373137474, 0.0021095378324389458, 0.015932263806462288, 0.003283119760453701, -0.014251099899411201, -0.017005622386932373, -0.00408652238547802, 0.02552783116698265, 0.013759681954979897, -0.0027900859713554382, 0.0058355797082185745, 0.03838227316737175, -0.01872558332979679, -0.013979527167975903, 0.014470944181084633, -0.03755462169647217, 0.016126243397593498, 0.0382012240588665, 0.01081117894500494, -0.01460026390850544, 0.04252052307128906, 0.003866677638143301, -0.012214303947985172, -0.00515341479331255, 0.005137249827384949, 0.0037082601338624954, 0.010365024209022522, -0.004613502416759729, 0.0005892157205380499, -0.0032912022434175014, 0.0070802876725792885, -0.03158002346754074, 0.008360559120774269, -0.004545609466731548, 0.023691482841968536, 0.04146009683609009, 0.02009637840092182, 0.026174433529376984, -0.00878085009753704, -0.014341623522341251, 0.0123694883659482, 0.005929336883127689, -0.015143409371376038, 0.040787629783153534, 0.03920992091298103, 0.030312683433294296, -0.003131168195977807, -0.0005019244854338467, -0.0167340487241745, 0.012944963760674, -0.0024522366002202034, 0.012317760847508907, -0.014147642999887466, -0.005521977785974741, 0.006346394773572683, 0.027752140536904335, -0.013397585600614548, 0.014845972880721092, 0.01070772297680378, -0.040218621492385864, 0.061297833919525146, -0.0362614169716835, 0.007028559688478708, -3.4729578146652784e-06, 0.020548999309539795, -0.01501408964395523, 0.028890158981084824, -0.026174433529376984, 0.01654006913304329, -0.04037380591034889, 0.006375492084771395, 0.027234859764575958, 0.009485645219683647, 0.020393814891576767, 0.012375954538583755, -0.026381345465779305, 0.0034560856875032187, -0.00012568318925332278, 0.012615197338163853, -0.0011760066263377666, -0.029510896652936935, 0.04466724023222923, 0.018816106021404266, -0.0011743901995941997, 0.005298899952322245, 0.007267802022397518, -0.006116851232945919, 0.013811410404741764, 0.0031634983606636524, -0.030131634324789047, 0.0006280118250288069, 0.011664693243801594, 0.030442003160715103, -0.011600032448768616, -0.021764609962701797, 0.009989994578063488, -0.0062526375986635685, 0.01500115729868412, 0.03597691282629967, -0.002326149260625243, 0.0055704726837575436, 0.025269191712141037, 0.016462476924061775, 0.008431685157120228, -0.004177046474069357, -0.026381345465779305, 0.022837968543171883, 0.008405820466578007, 0.006705258507281542, 0.015570166520774364, 0.015867603942751884, 0.022747443988919258, -0.005816181655973196, 0.02803664654493332, 0.013255332596600056, 0.009401587769389153, -0.0024231395218521357, -0.050538383424282074, -0.0015566933434456587, -0.004506813362240791, -0.00914294645190239, 0.00837995670735836, 0.005822647362947464, 0.0025540762580931187, 0.028553927317261696]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"F.(16)
Combine (13), (14), (15), (16) to bound (12)
|tr(((1−η)Σi
⋆1/2△i
AT−ηΣi
⋆1/2(BiTBi)−1BiT△i
BAi
⋆T)((CT
iCi−I)(AiBiT−Xi
⋆)Bi(BiTBi)−1Σi
⋆1/2
+CBi(BiTBi)−1Σi
⋆1/2))|
≤(1−η)δi
2r(2 +ϵ)
2(1−ϵ)(3
2∥△i
AΣi
⋆1/2∥2
F+1
2∥△i
BΣi
⋆1/2∥2
F) +ηδi
2r(2 +ϵ)
2(1−ϵ)2(3
2∥△i
BΣi
⋆1/2∥2
F+1
2∥△i
AΣi
⋆1/2∥2
F)
+(2 +ϵ)(1−η)
2(1−ϵ)X
j̸=i∥CT
iCj∥2(∥△j
AΣj
⋆1/2∥F+∥△j
BΣj
⋆1/2∥F)∥△i
AΣi
⋆1/2∥F
+η(2 +ϵ)
2(1−ϵ)2X
j̸=i∥CT
iCj∥2(∥△j
AΣj
⋆1/2∥F+∥△j
BΣj
⋆1/2∥F)∥△i
BLi
⋆T∥F
≤(1−η)δi
2r(2 +ϵ)
2(1−ϵ)(3
2∥△i
AΣi
⋆1/2∥2
F+1
2∥△i
BΣi
⋆1/2∥2
F) +ηδi
2r(2 +ϵ)
2(1−ϵ)2(3
2∥△i
BΣi
⋆1/2∥2
F+1
2∥△i
AΣi
⋆1/2∥2
F)
+(2 +ϵ)(1−η)
2(1−ϵ)X
j̸=i∥CT
iCj∥2(1
2∥△j
AΣj
⋆1/2∥2
F+1
2∥△j
BΣj
⋆1/2∥2
F+∥△i
AΣi
⋆1/2∥2
F)
+η(2 +ϵ)
2(1−ϵ)2X
j̸=i∥CT
iCj∥2(1
2∥△j
AΣj
⋆1/2∥2
F+1
2∥△j
BΣj
⋆1/2∥2
F+∥△i
BLi
⋆T∥2
F).(17)
Substituting bounds (9), (11), (17), we derive bound for (8) as
∥(Ai
t+1Qi
t−Ai
⋆)Σi
⋆1/2∥2
F≤((1−η)2+2ϵη(1−η)
1−ϵ)∥△i
AΣi
⋆1/2∥2
F+η2(2ϵ+ϵ2)
(1−ϵ)2∥△i
BΣi
⋆1/2∥2
F
+η2(δi
2r2(2 +","[-0.007668765727430582, -0.014499189332127571, 0.02974051795899868, 0.01613464392721653, -0.04026789218187332, -0.006813244894146919, -0.0013511389261111617, -0.01128325518220663, -0.009798978455364704, 0.031802013516426086, 0.0001662081340327859, 0.0050025638192892075, -0.03108736127614975, 0.003569824155420065, 0.01731656678020954, -0.013585259206593037, 0.015282558277249336, -0.03358864411711693, -0.04142232984304428, 0.03746425732970238, -0.010431170463562012, -0.015681114047765732, 0.04513302072882652, 0.012815634720027447, 0.0043566287495195866, -0.014348013326525688, 0.023556029424071312, -0.026455868035554886, 0.047716762870550156, -0.021150950342416763, 0.044033557176589966, -0.02660704404115677, 0.015117638744413853, -0.08713257312774658, 0.019886566326022148, 0.09026604145765305, 0.003951200749725103, 0.0543685257434845, 0.030042869970202446, 0.005779061000794172, 0.04582018777728081, 0.0003891073865815997, -0.06327418982982635, -0.030482657253742218, -0.011358844116330147, 0.0019274988444522023, -0.012396463192999363, 0.007414514664560556, 0.022016778588294983, 0.026909396052360535, 0.0054182992316782475, 0.048898689448833466, -0.007785583846271038, -0.015255071222782135, 0.0005179509171284735, 0.03248918056488037, 0.0048788744024932384, 0.05065783113241196, 0.05805173143744469, -0.030372709035873413, 0.0350179485976696, -0.008589567616581917, 0.04301655292510986, -0.018800845369696617, -0.05010810121893883, -0.0023844637908041477, -0.015406248159706593, 0.011846731416881084, 0.03287399187684059, -0.01371582131832838, -0.05843654274940491, 0.030977414920926094, 0.05227954313158989, 0.002360413083806634, 0.013331008143723011, -0.013805152848362923, 0.012107853777706623, -0.001999651314690709, 0.07091546803712845, -0.025823675096035004, 0.05673237517476082, 0.007682508789002895, 0.0436762310564518, -0.011613095179200172, 0.035265326499938965, -0.0564025342464447, -0.03301142528653145, 0.027486614882946014, -0.0990617647767067, -0.012341490015387535, -0.02429816871881485, 0.006655196659266949, -0.0026782271452248096, 0.015901006758213043, 0.05563290789723396, -0.03378105163574219, 0.013502799905836582, 0.006067670416086912, 0.0009560188627801836, -0.015928493812680244, 0.01837480254471302, -0.009950154460966587, 0.05794178321957588, -0.013090500608086586, 0.03845377638936043, 0.026290947571396828, -0.02682693675160408, -0.010094459168612957, -0.06272445619106293, 0.012630099430680275, 0.019542982801795006, -0.008568951860070229, 0.010128817521035671, 0.04337387904524803, 0.021439559757709503, -0.06321921199560165, -0.06470349431037903, 0.0013751897495239973, -0.02077988162636757, 0.0008542324649170041, -0.020917315036058426, -0.00685103889554739, 0.028641052544116974, -0.02663453109562397, 0.014059403911232948, -0.005497322883456945, 0.048651307821273804, -0.06965108215808868, -0.04546286165714264, -0.07459867745637894, 0.05909622460603714, -0.015488707460463047, 0.01507640816271305, 0.006208539009094238, 0.003617925802245736, 0.009716518223285675, 0.03985559195280075, 0.07712744176387787, 0.03163709491491318, -0.03397345542907715, 0.031802013516426086, 0.02820126712322235, -0.004562777932733297, -0.0028225318528711796, -0.013722692616283894, 0.04004799947142601, -0.04843141511082649, -0.002233287552371621, 0.01543373428285122, -0.006686119362711906, -0.006909447722136974, -0.019611699506640434, -0.03534778580069542, -0.03685954958200455, 0.019776619970798492, -0.0437861792743206, -0.010293737053871155, 0.07025578618049622, 0.017082931473851204, 0.008362802676856518, -0.02427068166434765, 0.02295132353901863, -0.031802013516426086, 0.006589916069060564, 0.029603084549307823, 0.024669237434864044, -0.01926811784505844, 0.0023810281418263912, -0.0797661542892456, -0.02131587080657482, 0.00771686714142561, -0.005407991353422403, -0.032544150948524475, -0.014787798747420311, 0.028860945254564285, -0.0004599713138304651, -0.030675062909722328, -0.04678221791982651, 0.008287214674055576, 0.00846587773412466, 0.04007548466324806, 0.04582018777728081, 0.011008389294147491, 0.017948759719729424, -0.01882833056151867, 0.02413324825465679, 0.032956451177597046, 0.011805500835180283, 0.006916319485753775, -0.012925581075251102, -0.0036797705106437206, 0.04087259620428085, 0.04494061693549156, -0.0016277229879051447, -0.0072770812548696995, -0.04026789218187332, 0.01572234369814396, 0.03438575565814972, 0.030620088800787926, 0.035842545330524445, 0.04994317889213562, 0.022099237889051437, 0.025603782385587692, 0.022868864238262177, -0.016698118299245834, -0.004418473225086927, -0.008081064559519291, 0.03422083705663681, -0.03306639939546585, -0.008555209264159203, 0.010011999867856503, -0.032324258238077164, -0.004009610041975975, -0.007641279138624668, -0.02311624400317669, 0.062284670770168304, -0.029025865718722343, 0.0160109531134367, -0.03578757494688034, 0.061515044420957565, -0.030070357024669647, 0.056842319667339325, -0.002083829138427973, -0.0043909866362810135, -0.022580254822969437, 0.03806896135210991, 0.04606756567955017, 0.007483230903744698, 0.00408863415941596, -0.05370884761214256, 0.039525751024484634, -0.0041573503986001015, -0.038233883678913116, -0.031169822439551353, 0.035265326499938965, -0.01591474935412407, -0.02714303322136402, -0.012135340832173824, -0.023198703303933144, -0.014540419913828373, 0.005576347000896931, 0.03696949779987335, 0.02490287274122238, -0.034495703876018524, -0.01584603451192379, -0.02266271412372589, 0.008878177031874657, -0.010850341059267521, -0.03034522384405136, 0.013090500608086586, 0.007318311370909214, 0.0025579731445759535, 0.006875089835375547, -0.0024377191439270973, -0.049833234399557114, 0.002837992971763015, -0.009551598690450191, 0.04700211063027382, -0.006435303948819637, 0.046150028705596924, -0.05016307160258293, -0.006438739597797394, -0.05805173143744469, -0.03051014244556427, -0.0015401093987748027, -0.008630797266960144, 0.04048778489232063, 0.034523189067840576, 0.009730261750519276, -0.00102215853985399, -0.002649022499099374, 0.056622426956892014, 0.015832290053367615, -0.0031558070331811905, -0.029383191838860512, -0.043401364237070084, -0.0031987547408789396, 0.030812496319413185, -0.022580254822969437, -0.009599700570106506, -0.009730261750519276, -0.00568285770714283, 0.008459005504846573, 0.0070365737192332745, 0.03221431374549866, -0.06756210327148438, -0.026936883106827736, 0.00963405892252922, 0.007655022200196981, -0.020821111276745796, 0.008761358447372913, -0.0010530808940529823, 0.02932821772992611, -0.014925232157111168, -0.008046706207096577, -0.01223154366016388, -0.006012697238475084, -0.031224794685840607, -0.009592828340828419, 0.025590037927031517, 0.036254845559597015, 0.01658817194402218, -0.010568603873252869, 0.05068532004952431, 0.005064408760517836, 0.01390822697430849, 0.0025785882025957108, 0.011764271184802055, 0.018484748899936676, -0.011778014712035656, 0.011915448121726513, 0.009146171621978283, -0.04543537646532059, -0.01224528718739748, -0.05269184336066246, -0.03787655755877495, 0.025232713669538498, -0.014155606739223003, 0.01405253168195486, -0.03367110341787338, 0.017399027943611145, -0.024957846850156784, 0.01080224011093378, -0.03630981966853142, 0.017976246774196625, -0.002113033551722765, -0.006517763715237379, -0.006091720890253782, -0.0018725256668403745, -0.0437861792743206, -0.038756128400564194, 0.031004901975393295, 0.038206394761800766, -0.04098254442214966, -0.01507640816271305, 0.011681811884045601, -0.005974902771413326, 0.031197307631373405, 0.010087587870657444, 0.027679022401571274, -0.037904042750597, -0.004531855694949627, -0.02413324825465679, 0.031994421035051346, 0.02410576120018959, -0.00946226716041565, 0.018622182309627533, -0.014952718280255795, 0.09686283022165298, 0.05700724199414253, -0.026181001216173172, -0.03435827046632767, 0.02135710045695305, 0.004119556397199631, -0.028805973008275032, -0.03147217631340027, 0.026002338156104088, -0.050630345940589905, -0.05612766742706299, -0.006947242189198732, -0.039168428629636765, -0.019006993621587753, 0.03444072976708412, -0.00982646457850933, -0.019859079271554947, 0.029108325019478798, 0.01917191408574581, 0.018072448670864105, 0.0016534917522221804, -0.003995866514742374, 0.0015332377515733242, 0.050630345940589905, -0.046369921416044235, -0.030427683144807816, -0.028668539598584175, -0.05019056051969528, 0.02302004024386406, 0.0043566287495195866, 0.0640438124537468, -0.00976462010294199, -0.03559516742825508, -0.032983940094709396, -0.012561383657157421, 0.01902073808014393, -0.004628058988600969, -0.009352320805191994, -0.01885581761598587, -0.019927795976400375, -0.014251810498535633, -0.0008907381561584771, 0.021370843052864075, -0.017082931473851204, 0.00918740127235651, 0.020601218566298485, -0.03793152794241905, -0.03086746856570244, 0.05871140956878662, 0.08922155201435089, 0.028448646888136864, 0.02484790049493313, -0.018842075020074844, -0.038371313363313675, -0.06910134851932526, -0.02270394377410412, -0.03732682392001152, -0.00698847183957696, 0.03985559195280075, 0.026675760746002197, 0.008692641742527485, -0.006510891951620579, 0.00247723120264709, -0.0019738825503736734, 0.030620088800787926, -0.027514101937413216, 0.018003733828663826, -0.002463487908244133, -0.04843141511082649, 0.05486328527331352, -0.003466749330982566, 0.02673073299229145, -0.04202703386545181, 0.002552819438278675, -0.014114377088844776, -0.005899314768612385, -0.05054788663983345, 0.028888432309031487, 0.012623228132724762, 0.0276927649974823, 0.03801398724317551, -0.05019056051969528, 0.024765441194176674, 0.038591206073760986, 0.01094654481858015, 0.03424832224845886, -0.057227134704589844, -0.010465528815984726, 0.017330311238765717, -0.031362228095531464, -0.016890525817871094, -0.03729933872818947, 0.00494759064167738, -0.036612171679735184, 0.009063711389899254, 0.006909447722136974, -0.01355777308344841, 0.055495474487543106, 0.014622879214584827, -0.03243420645594597, -0.011805500835180283, 0.026675760746002197, -0.0321318544447422, -0.025425119325518608, 0.03595249354839325, 0.004634930286556482, -0.03378105163574219, -0.020793624222278595, 0.06107525900006294, -0.006864781957119703, 0.01427929662168026, -0.03182949870824814, 0.03647473827004433, -0.03328629210591316, 0.012458308599889278, -0.002611228497698903, 0.005153740290552378, 0.035650141537189484, 0.012808762490749359, -0.004703646991401911, 0.009242374449968338, 0.02836618758738041, -0.028915919363498688, -0.035265326499938965, 0.05931611731648445, -0.014829029329121113, 0.0007734905229881406, 0.027995117008686066, 0.03375356271862984, -0.01719287782907486, 0.014801542274653912, -0.009853951632976532, 0.009599700570106506, -0.05030050501227379, -0.008012348785996437, 0.0068544745445251465, 0.01770137995481491, 0.07443375140428543, 0.06657258421182632, -0.02855859324336052, -0.012698816135525703, -0.03980061784386635, -0.006531506776809692, 0.0035801315680146217, 0.058821357786655426, -0.015955980867147446, -0.0069644213654100895, -0.025727471336722374, -0.02087608352303505, -0.016285819932818413, -0.014911488629877567, -0.047744251787662506, 0.05577034130692482, 0.05403868481516838, 0.03466062247753143, 0.002492692321538925, -0.04238435998558998, -0.020944800227880478, 0.009180529974400997, -0.0524994358420372, -0.02631843462586403, 0.016670633107423782, -0.005466400645673275, -0.010554860346019268, 0.035100407898426056, 0.01827859878540039, -0.009833336807787418, -0.014265553094446659, -0.013516543433070183, 0.008500236086547375, -0.005524809472262859, -0.012891222722828388, 0.009249245747923851, -0.0257687009871006, -0.019982770085334778, -0.03166458010673523, 0.017055444419384003, -0.01094654481858015, -0.006998779252171516, -0.06932124495506287, -0.0359799787402153, -0.026648273691534996, 0.036667145788669586, -0.01712416112422943, -0.04274168610572815, 0.03754671663045883, 0.006373459007591009, 0.014128120616078377, -0.010939672589302063, -0.003837818745523691, -0.006806373130530119, -0.0014490600442513824, 0.01869089901447296, -0.021329613402485847, -0.00440129404887557, 0.02718426287174225, 0.015804802998900414, -0.015873519703745842, -0.0027916093822568655, -0.019542982801795006, 0.003002912737429142, 0.031582120805978775, 0.012616356834769249, 0.005215585231781006, -0.002667919499799609, 0.002886094618588686, -0.021920574828982353, -0.007971118204295635, 0.030180303379893303, -0.009991385042667389, -0.010685421526432037, -0.003800024511292577, 0.009613444097340107, 0.0076206643134355545, -0.003748487215489149, -0.029877951368689537, -0.0291907861828804, 0.05150991678237915, -0.016533199697732925, -0.021302126348018646, 0.028860945254564285, 0.036832064390182495, -0.033698588609695435, 0.004415037576109171, 0.000888161244802177, 0.01946052350103855, -0.0013897919561713934, -0.02148078940808773, 0.03749174252152443, 0.00043398787965998054, -0.03210436552762985, -0.043648745864629745, -0.045710239559412, 0.011633710004389286, -0.01668437570333481, 0.008081064559519291, -0.025397632271051407, 0.015928493812680244, -0.007077803369611502, 0.00335680297575891, -0.018361059948801994, 0.012300260365009308, 0.00889879185706377, -0.008218497969210148, -0.018072448670864105, 0.01087095681577921, 0.007517589256167412, 0.018787100911140442, -0.021906832233071327, 0.03628233075141907, 0.015323787927627563, -0.014141863211989403, 0.03540275990962982, -0.018553465604782104, 0.008445262908935547, -0.007600049022585154, -0.054313551634550095, -0.00934544950723648, 0.00480328593403101, 0.003116294974461198, 0.010431170463562012, 0.002259056083858013, 0.0017462590476498008, 0.03474308177828789, 0.008060449734330177, 0.024243194609880447, -0.01034183893352747, -0.00920114479959011, -0.0020803932566195726, -0.017687637358903885, 0.051619865000247955, -0.00947601068764925, -0.02275891788303852, -0.020766137167811394, 0.023129986599087715, 0.017783839255571365, -0.0020735214930027723, 0.03628233075141907, -0.010905314236879349, -0.0030355530325323343, 0.038591206073760986, 0.0009869412751868367, -0.01639576628804207, -0.009702775627374649, -0.0019498317269608378, -0.029383191838860512, -0.06310927122831345, -0.014128120616078377, 0.021618222817778587, 0.024188222363591194, -0.03639227896928787, -0.045600295066833496, 0.053571414202451706, 0.002260774141177535, 0.008823203854262829, -0.029108325019478798, 0.01591474935412407, 0.0407901369035244, -0.0013906509848311543, 0.017371540889143944, -0.047331951558589935, -0.03872863948345184, -0.023665975779294968, 0.0018330136081203818, 0.030565116554498672, -0.008603310212492943, 0.024023301899433136, -0.030042869970202446, -0.01731656678020954, -0.02612602710723877, -0.017467744648456573, -0.03716190531849861, 0.008039834909141064, 0.013014912605285645, 0.010795367881655693, -0.0071602631360292435, 0.022071752697229385, -0.005607269704341888, 0.00934544950723648, 0.03716190531849861, 0.007881786674261093, 0.018416032195091248, 0.049448419362306595, 0.041504789143800735, -0.0016586454585194588, 0.017880043014883995, 0.01298055425286293, -0.006751399952918291, -0.013942585326731205, -0.01974913291633129, -0.0369420126080513, 0.0023724385537207127, -0.04920104146003723, 0.010623577050864697, -0.0010642473353073, -0.0072976965457201, -0.0033464953303337097, -0.0038996634539216757, -0.0072908247821033, -0.010005127638578415, -0.028338700532913208, -0.0042398106306791306, -0.01123515423387289, 0.03925088793039322, 0.06525322794914246, -0.03647473827004433, -0.001353715779259801, -0.012334618717432022, -0.01238959189504385, -0.001776322489604354, -0.017591433599591255, -0.02641463652253151, -0.006744528189301491, 0.00962031539529562, -0.01731656678020954, -0.03262661397457123, -0.04911858215928078, -0.027156775817275047, 0.0010779907461255789, 0.054698362946510315, 0.06789194047451019, -0.01808619312942028, 0.0055419886484742165, 0.0031523711513727903, -0.005610705353319645, 0.007964246906340122, 0.020766137167811394, 0.020353838801383972, 0.033561158925294876, 0.03301142528653145, 0.0011570147471502423, -0.011564993299543858, -0.006071106065064669, -0.015681114047765732, -0.04818403720855713, -0.013406597077846527, 0.01254764012992382, -0.017261594533920288, -0.015612397342920303, 0.014155606739223003, 0.007208365015685558, -0.02023014798760414, 0.03342372551560402, 0.008685770444571972, 0.010541116818785667, 0.01687678135931492, -0.016409508883953094, 0.02634592168033123, -0.005590090528130531, 0.0248066708445549, -0.038783613592386246, 0.008816331624984741, 0.0035165688022971153, -0.0737190991640091, -0.03125227987766266, 0.017440257593989372, 0.012169699184596539, 0.019488010555505753, 0.0014971615746617317, 0.06365899741649628, -0.013585259206593037, 0.03845377638936043, -0.03133474290370941, 0.011530634947121143, -0.028256241232156754, -0.025315172970294952, 0.016382021829485893, -6.807232421124354e-05, 0.008170396089553833, -0.005377069115638733, -0.00408176239579916, -0.016560684889554977, -0.0002813083410728723, -0.009929539635777473, -0.020546244457364082, -0.03133474290370941, -0.02020266279578209, 0.025411376729607582, -0.04746938496828079, -0.01866341196000576, 0.03284650668501854, -0.01182611659169197, -0.007496974430978298, -0.005445785820484161, 0.02455929107964039, -0.0005883853300474584, 0.01834731549024582, 0.014066275209188461, -0.02990543656051159, -0.014622879214584827, -0.008115422911942005, -0.03166458010673523, -0.004964769817888737, -0.009833336807787418, 0.006321921478956938, 0.02612602710723877, -0.012362104840576649, -0.009929539635777473, 0.04002051055431366, -0.0034461345057934523, -0.009249245747923851, -0.005222456995397806, -0.0024291295558214188, -0.029575597494840622, -0.011056491173803806, 0.005919929593801498, 0.005552296061068773, 0.02471046708524227, -0.0066586327739059925, -0.11148571223020554, 0.003676334861665964, 0.0204225555062294, -0.007593177258968353, -0.021631965413689613, 0.002343233907595277, 0.007778712082654238, 0.02612602710723877, 0.017082931473851204, 0.004263861104846001, 0.0012772686313837767, -0.001659504370763898, -0.021054746583104134, 0.0013236523373052478, 0.0001909031270770356, 0.01049988716840744, -0.002726328559219837, 0.03647473827004433, 0.028531106188893318, 0.008197883144021034, -0.003473621094599366, 0.006466226186603308, 0.014238066971302032, 0.04213698208332062, -0.0389210470020771, -0.008245985023677349, 0.010974030941724777, -0.014025045558810234, -0.010809111408889294, 0.0033035476226359606, 0.027898915112018585, 0.00977836363017559, 0.049888208508491516, 0.033945970237255096, 0.00597146712243557, 0.016890525817871094, -0.004325706046074629, 0.020285122096538544, 0.024628007784485817, 0.03361612930893898, -0.003999302629381418, -0.04414350539445877, 0.04507805034518242, -0.011716170236468315, 0.01574983075261116, -0.013296649791300297, 0.014801542274653912, -0.04337387904524803, 0.03707944229245186, -0.024545546621084213, -0.00626007653772831, 0.006088285241276026, 0.00933170598000288, -0.035100407898426056, -0.03727184981107712, 0.0019292167853564024, -0.012891222722828388, 0.024256937205791473, 0.003690078156068921, 0.008074193261563778, -0.017495229840278625, 0.025273943319916725, 0.03809645026922226, -0.027775224298238754, -0.013619617559015751, -0.010176919400691986, -0.022511538118124008, 0.01815490983426571, -0.01869089901447296, 0.0004236804088577628, 0.020188918337225914, -0.031032389029860497, -0.049448419362306595, -0.012142212130129337, -0.003892791923135519, 0.009888309985399246, -0.02362474612891674, -0.007902401499450207, -0.0203950684517622, -0.01087095681577921, 0.03133474290370941, 0.01673934794962406, 0.008239112794399261, 0.019185656681656837, -0.041284896433353424, -0.03600746765732765, 0.021123463287949562, 0.0065486859530210495, 0.04804660379886627, 0.011290127411484718, -0.009785234928131104, 0.031802013516426086, 0.022965067997574806, -0.0073938993737101555, -0.0029084275010973215, -0.004926975816488266, 0.00019906321540474892, -0.010602962225675583, 0.0048788744024932384, 0.024256937205791473, 0.00626007653772831, -0.006459354422986507, 0.01965292915701866, -0.015323787927627563, -0.058271624147892, -0.01429304014891386, 0.015983466058969498, -0.022965067997574806, 0.017522716894745827, -0.022745173424482346, 0.0038824845105409622, 0.010183790698647499, -0.006528071127831936, -0.012904966250061989, 0.038151420652866364, -0.0048857457004487514, -0.01926811784505844, -0.01808619312942028, -0.008905663155019283, -0.00992266833782196, -0.013069885782897472, 0.024284424260258675, 0.009613444097340107, -0.0008718410972505808, 0.004071454983204603, 0.036089926958084106, -0.0071259052492678165, 0.016766835004091263, -0.0019412422552704811, 0.016574429348111153, 0.02227790094912052, -0.005562603939324617, 0.0030819368548691273, -0.01635453663766384, 0.045187994837760925, -0.003920278511941433, 0.02634592168033123, -0.026813194155693054, 0.014471703208982944, 0.016794322058558464, -0.02215421199798584, -0.01777009665966034, -0.001999651314690709, -0.0025442298501729965, -0.01448544580489397, 0.005645063705742359, -0.024408115074038506, -0.020669935271143913, -0.01863592490553856, 0.04466575011610985, 0.05016307160258293, 0.0001819914614316076, 0.016148386523127556, 0.010156304575502872, -0.010733523406088352, -0.003604182507842779, -0.01448544580489397, 0.0012944478075951338, -0.007545075844973326, 0.0738290473818779, 0.03441324084997177, 0.0407901369035244, 0.0002989169443026185, 0.00408863415941596, 0.02971303090453148, -0.010967159643769264, -0.03262661397457123, -0.03872863948345184, 0.03029024973511696, 0.013358495198190212, -0.026208488270640373, -0.05370884761214256, 0.02574121579527855, 0.03265409916639328, -0.01620336063206196, 0.024916617199778557, 0.012355233542621136, -0.016656888648867607, 0.00859643891453743, 0.020862340927124023, -0.01106336247175932, 0.017618920654058456, -0.01302865520119667, 0.01693175546824932, 0.01642325334250927, -0.03707944229245186, 0.039525751024484634, 0.014306783676147461, 0.04213698208332062, 0.03281901776790619, 0.05456092953681946, 0.03397345542907715, 0.03147217631340027, 0.02131587080657482, 0.044225964695215225, 0.03221431374549866, 0.0018416031962260604, 0.04037783667445183, -0.011001517996191978, -0.035072922706604004, 0.006531506776809692, 0.012197185307741165, -0.00018005880701821297, -0.05992082133889198, -0.0008155794348567724, 0.019542982801795006, 0.0175089742988348, -0.012705688364803791, -0.005442349705845118, -0.014677852392196655, 0.02302004024386406, 0.03210436552762985, -0.03985559195280075, -0.019089454784989357, 0.004604008048772812, 0.003992430865764618, 0.011448175646364689, 0.020697420462965965, 0.028146294876933098, -0.008424647152423859, 0.001281563425436616, -0.034715596586465836, 0.02974051795899868, 0.02839367277920246, 0.006799501366913319, 0.0042569893412292, 0.008459005504846573, -0.009654673747718334, -0.011853602714836597, 0.0017694508424028754, -0.01811368018388748, 0.04238435998558998, -0.03515538200736046, -0.02730795182287693, -0.01574983075261116, 0.02875099889934063, -0.0019000122556462884, -0.0042226314544677734, -0.017632663249969482, 0.00845213420689106, 0.03485302999615669, 0.0012154238065704703, -0.009098069742321968, 0.012788147665560246, -0.004944154992699623, -0.013592131435871124, 0.028888432309031487, 0.06371397525072098, -0.020546244457364082, -0.011290127411484718, 0.0021250590216368437, 0.02740415558218956, 0.012499538250267506, 0.021686939522624016, -0.003410058096051216, 0.010183790698647499, 0.024476831778883934, 0.006558993365615606, 0.026235973462462425, -0.0203950684517622, 0.017440257593989372, 0.004043968394398689, 0.002494410378858447, -0.0070159584283828735, 0.002202365081757307, -0.02602982521057129, -0.012506409548223019, -0.01034183893352747, -0.007950503379106522, 0.015887264162302017, -0.015131381340324879, -0.009860822930932045, 0.004940718878060579, 0.018127422779798508, -0.004655545577406883, 0.0037691020406782627, 0.0340559147298336, 0.000561328197363764, 0.0014963026624172926, -0.01974913291633129, -0.03727184981107712, -0.005373633466660976, -0.0262497179210186, -0.005239636171609163, 0.03281901776790619, 0.006538378540426493, 0.03086746856570244, -0.014073147438466549, 0.03765666112303734, 0.03152714669704437, 0.030839981511235237, -0.016093412414193153, 0.014141863211989403, -0.0064696623012423515, 0.014025045558810234, -0.01866341196000576, -0.01179862953722477, 0.011022132821381092, -0.025012819096446037, 0.005370197352021933, -0.015131381340324879, 0.0495583675801754, -0.005837469827383757, -0.03339623659849167, 0.025466348975896835, 0.03806896135210991, 0.029658058658242226, 0.002434283262118697, -0.02484790049493313, -0.004305091220885515, 0.009613444097340107, 0.010238763876259327, 0.017330311238765717, 0.003597310744225979, -0.0038103321567177773, 0.014348013326525688, -0.020120201632380486, -0.0061982315964996815, 0.006957549601793289, 0.02097228728234768, -0.0063597154803574085, -0.0017814763123169541, 0.04436339810490608, -0.0031266023870557547, -0.023872125893831253, 0.009448523633182049, -0.010623577050864697, -0.0008675463031977415, -0.0025854597333818674, 0.0017265030182898045, -0.027995117008686066, 0.014210579916834831, 0.0320768803358078, -0.007222108077257872, -0.021631965413689613, 0.03229677304625511, 0.0015538526931777596, -0.010561731643974781, -0.05030050501227379, 0.025590037927031517, -0.00102044059894979, 0.011819244362413883, 0.0059371087700128555, -0.020023999735713005, -0.012719430960714817, 0.021920574828982353, 0.020862340927124023, -0.01093280129134655, -0.03226928785443306, -0.00946226716041565, 0.10560357570648193, -0.02487538754940033, -0.025631269440054893, 0.042466819286346436, -0.0007172288605943322, -0.0010874392464756966, -0.003611054038628936, 0.0010659652762115002, -0.025686241686344147, 0.013812024146318436, -0.03713441640138626, 0.025617524981498718, -0.004576521459966898, 0.0005196687998250127, 0.014011302031576633, 0.006534942891448736, -0.017646407708525658, 0.0004908937844447792, 0.001999651314690709, 0.006349408067762852, 0.012210928834974766, -0.039525751024484634, -0.020628705620765686, 0.02350105531513691, 0.023171216249465942, -0.020216405391693115, 0.026716990396380424, -0.003006348619237542, 0.007167134899646044, 0.02077988162636757, -0.006758271716535091, 0.010740394704043865, -0.037601690739393234, 0.004820465110242367, 0.015584911219775677, 0.027074316516518593, -0.014952718280255795, 0.005641627591103315, 0.010417426936328411, 0.0067307851277291775, -0.03029024973511696, -0.0016345946351066232, -0.0070434450171887875, 0.01515886839479208, 0.018745871260762215, -0.0023982070852071047, -0.018910791724920273, 0.0051571764051914215, 0.0003785851877182722, -0.005961159709841013, -0.019391806796193123, 0.007187749724835157, 0.024092018604278564, -0.039965540170669556, -0.019927795976400375, -0.004727697931230068, 0.011097720824182034, 0.0029427858535200357, 0.016244590282440186, 0.038756128400564194, -0.024037044495344162, -0.019515497609972954, -0.01731656678020954, 0.002714303322136402, -0.011729912832379341, -0.01639576628804207, -0.003954636864364147, 0.01063044834882021, -0.038206394761800766, 0.02244282141327858, -0.01245143637061119, -0.005136561114341021, 0.011159566231071949, -0.013626489788293839, -0.002563126850873232, 0.005710344295948744, -0.02602982521057129, 0.022621484473347664, -0.021563250571489334, -0.0012042573653161526, -0.017302824184298515, -0.0011003235122188926, 0.004789542872458696, -0.0023277727887034416, 0.0018398852553218603, -0.02795388735830784, 0.010891571640968323, -0.01390822697430849, -0.01760517619550228, -0.003133474150672555, -0.016629401594400406, 0.002683380851522088, -0.005222456995397806, -0.020889827981591225, 0.021920574828982353, -0.03243420645594597, -0.00047027881373651326, -0.03342372551560402, 0.0039237141609191895, 0.020381325855851173, 0.004899489227682352, -0.020367581397294998, 0.017357798293232918, -0.00684416713193059, -0.0535164400935173, 0.025851162150502205, -0.0398281067609787, 0.0012429103953763843, -0.005834034178406, 0.028531106188893318, 0.010128817521035671, -0.004535291343927383, 0.010273122228682041, 0.007524461019784212, 0.00408176239579916, 0.03345121070742607, -0.006806373130530119, 0.0027538153808563948, -0.002226415788754821, -0.0021920576691627502, 0.05555044859647751, -0.000977492774836719, -0.0005699177854694426, 0.00612264359369874, -0.016024697571992874, 0.012314003892242908, -0.011564993299543858, 0.016079669818282127, -0.008115422911942005, 0.01632704958319664, -0.002740071853622794, 0.027321696281433105, 0.004298219457268715, 0.02490287274122238, 0.007057188544422388, -0.02429816871881485, -0.0015761855756863952, -0.0008340469794347882, -0.03240672126412392, -0.033341266214847565, -0.002738354029133916, -0.02839367277920246, 0.0025820238515734673, 0.016052182763814926, -0.0016260050470009446, -0.02023014798760414, -0.007792455609887838, -0.021755656227469444, 0.0027314824983477592, 0.0042741685174405575, 0.0007563114049844444, 0.014719082042574883, -0.028641052544116974, 0.03281901776790619, -0.025273943319916725, 0.006284127477556467, 0.04197205975651741, 0.0005243931082077324, 0.013440954498946667, -0.0003702103567775339, 0.027252979576587677, 0.008541465736925602, 0.009977641515433788, -0.010479272343218327, 0.03853623569011688, -0.004047404043376446, 0.001692144782282412, 0.02359725907444954, -0.0007228120812214911, 0.005603833589702845, 0.005662242881953716, -0.011461918242275715, 0.004373807460069656, 0.02208549529314041, -0.04076265171170235, -0.0028397110290825367, 0.02516399696469307, -0.001516058575361967, 0.0028122244402766228, 0.020793624222278595, -0.003377417800948024, -0.035100407898426056, -0.032544150948524475, 0.019323090091347694, -0.003758794628083706, -0.006689555011689663, 0.018017476424574852, 0.025809932500123978, -0.015268814750015736, -0.005710344295948744, 0.0031317563261836767, 0.024188222363591194, 0.012877479195594788, -0.001618274487555027, 0.014457959681749344, -0.01565362699329853, -0.019281860440969467, -0.037244364619255066, 0.03163709491491318, 0.04117494821548462, 0.04007548466324806, -0.020889827981591225, 0.002436001319438219, 0.010589218698441982, 0.00684416713193059, -0.030207790434360504, 0.009139299392700195, 0.01517261192202568, -0.012059752829372883, 0.013049270957708359, 0.032928965985774994, 0.012004779651761055, 0.011104592122137547, 0.03474308177828789, -0.032956451177597046, -0.014512932859361172, 0.014801542274653912, 0.00947601068764925, 0.0010547988349571824, -0.03595249354839325, -0.0029530932661145926, 0.013042398728430271, 0.003047578502446413, -0.012815634720027447, -0.01952924020588398, 0.023514799773693085, 0.023061269894242287, -0.013585259206593037, 0.0010041204513981938, 0.013152345083653927, -0.007187749724835157, -0.022387847304344177, -0.013131730258464813, -0.0022951324936002493, 0.02704682946205139, -0.03870115429162979, -0.012272773310542107, -0.02273143082857132, -0.015832290053367615, 0.03806896135210991, -0.04631494730710983, -0.002934196265414357, 0.003207344328984618, -0.03710693120956421, 4.1390976548427716e-05, 0.0048135933466255665, 0.025823675096035004, -0.009977641515433788, -0.035072922706604004, -0.010018871165812016, 0.001384638249874115, 0.006023004651069641, 0.005215585231781006, -0.034303296357393265, -0.021494533866643906, -0.00963405892252922, 0.000685447477735579, -0.031774528324604034, -0.015804802998900414, -0.03652971237897873, -0.02087608352303505, 0.0330389104783535, 0.007703124079853296, -0.025425119325518608, -0.023830896243453026, -0.011723041534423828, 0.005442349705845118, -0.00484107993543148, -0.004916668403893709, -0.0009800696279853582, 0.022717688232660294, 0.01642325334250927, 0.00047285566688515246, 0.0022075187880545855, 0.021975548937916756, 0.016698118299245834, -0.0018416031962260604, -0.023762179538607597, 0.00554542476311326, -0.02061496116220951, 0.02858608029782772, 0.02974051795899868, 0.003707257332280278, -0.010733523406088352, 0.04290660470724106, 0.0001316351117566228, -0.031169822439551353, -0.0006644030218012631, -0.012210928834974766, -0.009757748804986477, 0.03218682482838631, -0.01596972346305847, 0.026332177221775055, -0.034880515187978745, 0.013090500608086586, -0.007194621488451958, 0.008012348785996437, -0.009077454917132854, 0.025411376729607582, 0.027074316516518593, 0.020931057631969452, 0.03108736127614975, -0.007421385962516069, -0.019034480676054955, 0.006991907954216003, 0.008967508561909199, -0.014100633561611176, 0.04683719202876091, 0.04408853128552437, 0.02689565345644951, -0.009146171621978283, 0.001501456368714571, 0.001093451865017414, 0.0011046183062717319, -0.012032265774905682, 0.011296998709440231, -0.0025459476746618748, -0.0037553587462753057, 0.010279994457960129, 0.015571167692542076, -0.003006348619237542, 0.013475312851369381, 0.017467744648456573, -0.05599023401737213, 0.05893130227923393, -0.03149966150522232, 0.0015710318693891168, -0.01487025897949934, -0.01834731549024582, -0.014169350266456604, 0.00698847183957696, -0.016780579462647438, 0.011448175646364689, -0.031169822439551353, 0.006741092540323734, 0.008520850911736488, -0.016629401594400406, 0.017357798293232918, -0.009558470919728279, -0.03092244267463684, 0.02461426332592964, -0.02266271412372589, 0.01668437570333481, 0.0031540892086923122, -0.03551270812749863, 0.03562265262007713, 0.031747039407491684, 0.010231892578303814, 0.0005862379912286997, 0.004445959813892841, -0.003453006036579609, 0.005943980533629656, 0.0050918953493237495, -0.04290660470724106, -0.008568951860070229, -0.009372935630381107, 0.040707677602767944, -0.015557424165308475, -0.011083977296948433, 0.016079669818282127, -0.0033172909170389175, 0.01847100630402565, 0.03677709028124809, -0.002563126850873232, 0.02160448022186756, 0.042246926575899124, 0.011035876348614693, 0.002758969087153673, 0.0009439934510737658, -0.024284424260258675, 0.021370843052864075, -0.010912186466157436, 0.0029324782080948353, 0.02010645903646946, 0.006098592653870583, -0.0004361352766864002, -0.024188222363591194, 0.017948759719729424, 0.014334269799292088, 0.006383766420185566, 0.0030681933276355267, -0.04782671108841896, 0.012080367654561996, -0.01875961571931839, -0.00048316316679120064, -0.007613792549818754, -0.019776619970798492, 0.00816352479159832, 0.028998378664255142]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"ϵ)2
2(1−ϵ)2(∥△i
AΣi
⋆1/2∥2
F+∥△i
BΣi
⋆1/2∥2
F)
+ (P−1)X
j̸=i∥CT
iCj∥2
2(2 +ϵ)2
2(1−ϵ)2(∥△j
AΣj
⋆1/2∥2
F+∥△j
BΣj
⋆1/2∥2
F)
+X
j̸=i2(1 +ϵ
2)2δi
2r
(1−ϵ)2∥CT
iCj∥(∥△j
AΣj
⋆1/2∥F+∥△j
BΣj
⋆1/2∥F)(∥△i
AΣi
⋆1/2∥F
18
Riemannian Preconditioned LoRA
+∥△i
BΣi
⋆1/2∥F)) + 2 η((1−η)δi
2r(2 +ϵ)
2(1−ϵ)(3
2∥△i
AΣi
⋆1/2∥2
F+1
2∥△i
BΣi
⋆1/2∥2
F)
+ηδi
2r(2 +ϵ)
2(1−ϵ)2(3
2∥△i
BΣi
⋆1/2∥2
F+1
2∥△i
AΣi
⋆1/2∥2
F)
+(2 +ϵ)(1−η)
2(1−ϵ)X
j̸=i∥CT
iCj∥2(1
2∥△j
AΣj
⋆1/2∥2
F+1
2∥△j
BΣj
⋆1/2∥2
F+∥△i
AΣi
⋆1/2∥2
F)
+η(2 +ϵ)
2(1−ϵ)2X
j̸=i∥CT
iCj∥2(1
2∥△j
AΣj
⋆1/2∥2
F+1
2∥△j
BΣj
⋆1/2∥2
F+∥△i
BAi
⋆T∥2
F)).
We similarly derive bound for ∥(Bi
t+1Qi
t−T−Bi
⋆)Σi
⋆1/2∥2
F. Since dist2(Fi
t, Fi
⋆) =tr(△i
AΣi
⋆△i
AT) +tr(△i
BΣi
⋆△i
BT), we
thus get
∥(Ai
t+1Qi
t−Ai
⋆)Σi
⋆1/2∥2
F+∥(Bi
t+1Qi
t−T−Bi
⋆)Σi
⋆1/2∥2
F
≤((1−η)2+2ϵη(1−η)
1−ϵ)(∥△i
AΣi
⋆1/2∥2
F+∥△i
BΣi
⋆1/2∥2
F) +η2(2ϵ+ϵ2)
(1−ϵ)2(∥△i
BΣi
⋆1/2∥2
F+∥△i
AΣi
⋆1/2∥2
F)
+η2(δi
2r2(2 +ϵ)2
2(1−ϵ)2(2∥△i
AΣi","[0.014624418690800667, -0.03374866023659706, 0.0037272225599735975, 0.014572696760296822, -0.03392968699336052, 0.001621972187422216, -0.0008061371627263725, -0.02589983306825161, -0.020300917327404022, 0.03532618284225464, -0.011210761032998562, 0.0019476596498861909, -0.036489930003881454, 0.005191604141145945, 0.020818138495087624, -0.012859403155744076, 0.023042187094688416, -0.046110235154628754, -0.03465379402041435, 0.03905017301440239, -0.010913359001278877, -0.02358526922762394, 0.06651459634304047, 0.00187654176261276, -0.0008930140757001936, -0.019628530368208885, 0.04189488664269447, -0.016189012676477432, 0.05870456248521805, -0.017986353486776352, 0.030050529167056084, -0.0254860557615757, 0.016667440533638, -0.09113430976867676, 0.0121417585760355, 0.08942747861146927, -0.009956500492990017, 0.05192897096276283, 0.01957680843770504, 0.012917590327560902, 0.0317314974963665, -0.004490123130381107, -0.09046192467212677, -0.016990704461932182, -0.0207922775298357, -0.01560713816434145, 0.007603146135807037, 0.023818019777536392, 0.02520158514380455, 0.028033368289470673, -0.011359462514519691, 0.044222380965948105, -0.003193838521838188, -0.004031089600175619, -0.026869621127843857, 0.01737861894071102, 0.007745381910353899, 0.03341246396303177, 0.0389467291533947, -0.028654033318161964, 0.045230962336063385, 0.013758073560893536, 0.05875628441572189, -0.022111190482974052, -0.039696697145700455, -0.014236503280699253, -0.023624060675501823, 0.007861756719648838, 0.04595506936311722, -0.005443749018013477, -0.04429996386170387, 0.016538135707378387, 0.056583959609270096, 0.010544839315116405, 0.010312090627849102, -0.0111978305503726, -0.003201920073479414, 0.03002466820180416, 0.08120366930961609, -0.03475723788142204, 0.03592098504304886, 0.011566351167857647, 0.07453151792287827, 0.003119488013908267, 0.028033368289470673, -0.05896317586302757, -0.029972946271300316, 0.019408712163567543, -0.08415182679891586, 0.0073897927068173885, -0.003775712102651596, -0.008514747954905033, 0.015801096335053444, 0.010473721660673618, 0.05513574182987213, -0.01595626212656498, 0.03623132035136223, -0.0037886425852775574, -0.003775712102651596, 0.01160514261573553, 0.020456083118915558, -0.010124597698450089, 0.06191133335232735, 0.0008469491149298847, 0.03431760147213936, 0.012562001124024391, -0.00441900547593832, -0.0111978305503726, -0.049446310847997665, 0.019654391333460808, 0.017947562038898468, 0.019124239683151245, 0.038584671914577484, 0.007480306085199118, 0.012174084782600403, -0.0650663822889328, -0.05860111862421036, 0.005547193344682455, -0.05611845850944519, 0.0064361668191850185, -0.002363052684813738, -0.016887260600924492, 0.030490167438983917, -0.015025264583528042, 0.025835180655121803, -0.029662614688277245, 0.039179477840662, -0.059273507446050644, -0.04005875438451767, -0.057877011597156525, 0.053170301020145416, 0.019951794296503067, 0.014831307344138622, -0.0032487933058291674, -0.0016745023895055056, 0.022809438407421112, 0.03705887123942375, 0.058187343180179596, 0.026378262788057327, -0.061497557908296585, 0.020249195396900177, 0.022861160337924957, -0.013021034188568592, -0.013040429912507534, -0.005854293238371611, 0.03584340214729309, -0.0504031702876091, -0.028447145596146584, 0.00848888698965311, -0.03385210409760475, -0.011230156756937504, -0.0029077508952468634, -0.03023155778646469, -0.01003408432006836, 0.007907013408839703, -0.021361220628023148, 0.009646167978644371, 0.03522273898124695, 0.04264485836029053, 0.01997765526175499, -0.03281766176223755, 0.045024074614048004, -0.023339590057730675, 0.010021153837442398, 0.059170063585042953, 0.025783458724617958, -0.007583750411868095, 0.012238738127052784, -0.06615254282951355, -0.032791800796985626, 0.010544839315116405, 0.008534143678843975, -0.049135979264974594, -0.008501817472279072, 0.03853294998407364, -0.0185552965849638, 0.007868221960961819, -0.046549875289201736, 0.018335478380322456, 0.014598557725548744, 0.01868460327386856, 0.04497235268354416, 0.0029012856539338827, 0.027386842295527458, -0.03946394845843315, 0.054463353008031845, 0.02218877337872982, 0.0231973547488451, 0.022124120965600014, -0.006352118216454983, 0.010609492659568787, 0.048049814999103546, 0.042205218225717545, -0.0011629386572167277, -0.011417649686336517, -0.05513574182987213, 0.014003753662109375, 0.025240376591682434, 0.017598439007997513, 0.04706709459424019, 0.05394613370299339, 0.012380973435938358, 0.022447383031249046, 0.02741270326077938, -0.03263663500547409, -0.015982123091816902, 0.0072734178975224495, 0.0036884311120957136, -0.04409307613968849, -0.005990063771605492, -0.008049248717725277, -0.0138615183532238, -0.0016761186998337507, 0.006788523402065039, -0.010965081863105297, 0.05128244683146477, -0.04057597368955612, 0.05293755233287811, -0.040705278515815735, 0.05792873352766037, -0.010195715352892876, 0.03480895981192589, -0.007997526787221432, 0.009322904981672764, -0.030593611299991608, 0.03527446091175079, 0.05580812692642212, -0.001348006771877408, 0.009400488808751106, -0.06263544410467148, 0.046730902045965195, -0.0009140261681750417, -0.03806745260953903, -0.018542366102337837, 0.04285174608230591, -0.031188415363430977, -0.03033500164747238, -0.010331486351788044, -0.020740555599331856, -0.02800750732421875, 0.02318442426621914, 0.029766058549284935, 0.010661214590072632, -0.028964366763830185, -0.0026523731648921967, -0.03302454948425293, 0.012801215052604675, -0.005809036549180746, -0.013887379318475723, 0.010628888383507729, -0.019848348572850227, 0.023068048059940338, 0.02591276355087757, 0.0048392475582659245, -0.05663568153977394, 0.024270586669445038, -0.016822608187794685, 0.04308449476957321, -0.01003408432006836, 0.05182552710175514, -0.04949803277850151, -0.0045289150439202785, -0.056480515748262405, -0.033800382167100906, 0.012128828093409538, -0.015115778893232346, 0.033076271414756775, 0.03403313085436821, 0.010085806250572205, 0.0018797744996845722, -0.006814384367316961, 0.054670240730047226, 0.0005754081648774445, 0.003253642236813903, -0.025447264313697815, -0.0092776482924819, -0.00014516529336106032, 0.03835192322731018, -0.019434573128819466, -0.010906893759965897, 0.010085806250572205, 0.038584671914577484, 0.010370277799665928, 0.01110085193067789, 0.026236025616526604, -0.06072172522544861, -0.018594088032841682, 0.0010384824126958847, 0.001721375621855259, -0.02258962020277977, 0.017430342733860016, -0.007338070310652256, 0.03061947226524353, 0.011818495579063892, -0.01737861894071102, -0.011074990965425968, -0.005029972642660141, -0.051360029727220535, -0.0031162553932517767, 0.007325139828026295, 0.028783338144421577, 0.011715051718056202, -0.0012817378155887127, 0.047118816524744034, -0.020843999460339546, 0.0013245701557025313, 0.009491002187132835, -0.00013001234037801623, 0.0007087541744112968, 0.003607615362852812, 0.008792754262685776, 0.02489125169813633, -0.0570494569838047, -0.001732689794152975, -0.04701537266373634, -0.022809438407421112, 0.010441395454108715, -0.022822368890047073, 0.012232272885739803, -0.01616315171122551, 0.027929924428462982, -0.019447503611445427, -0.0013366925995796919, -0.0331021323800087, 0.007325139828026295, 0.0005455063655972481, -0.021852580830454826, 0.008521213196218014, -0.009206530638039112, -0.052161719650030136, -0.018723394721746445, 0.02300339564681053, 0.018348408862948418, -0.03400726988911629, -0.012820611707866192, 0.006859641056507826, -0.007415653672069311, 0.03985186293721199, 0.002631360897794366, 0.04155869409441948, -0.0514376126229763, -0.017611369490623474, -0.01637003943324089, 0.05037730932235718, 0.012885264120995998, -0.024761946871876717, 0.04287760704755783, -0.03555893152952194, 0.06899725645780563, 0.04378274455666542, -0.019150100648403168, -0.026080859825015068, 0.02570587582886219, -0.012801215052604675, -0.04380860552191734, -0.03082636184990406, 0.01696484349668026, -0.057463232427835464, -0.04225694015622139, -0.009820730425417423, -0.042205218225717545, -0.02289995178580284, 0.053066857159137726, 0.014585627242922783, -0.032869383692741394, 0.010189250111579895, 0.027231676504015923, 0.049135979264974594, 0.013783935457468033, -0.012251668609678745, -0.005411422811448574, 0.04569645971059799, -0.04587748646736145, -0.0046937791630625725, -0.04417065903544426, -0.033334881067276, 0.03111083246767521, 0.022770646959543228, 0.054463353008031845, -0.0150640569627285, -0.03700714930891991, -0.019848348572850227, -0.01516750082373619, 0.007195834536105394, -0.006177556235343218, 0.022460313513875008, -0.011469371616840363, -0.02692134492099285, -0.004745501093566418, -0.0077906385995447636, 0.02159396931529045, -0.005786408204585314, 0.012309855781495571, 0.043420687317848206, -0.028473006561398506, -0.0314987488090992, 0.02759373188018799, 0.08523799479007721, 0.009717286564409733, 0.015736443921923637, -0.010518978349864483, -0.03835192322731018, -0.04484304413199425, -0.02769717574119568, -0.03139530494809151, 0.018542366102337837, 0.03113669343292713, 0.045360267162323, 0.014753724448382854, 0.015891609713435173, 0.0009948419174179435, 0.003947041463106871, 0.02167155221104622, -0.029248837381601334, 0.03235216438770294, -0.012600792571902275, -0.021800857037305832, 0.05042903125286102, -0.005472843069583178, 0.027257537469267845, -0.005411422811448574, 0.028266118839383125, -0.03343832492828369, 0.005634474568068981, -0.042515553534030914, 0.023921463638544083, 0.021050887182354927, 0.004373748786747456, 0.02390853315591812, -0.05973900482058525, 0.00969142559915781, 0.05239446833729744, 0.025020558387041092, 0.04406721517443657, -0.035688236355781555, -0.0011936486698687077, 0.013014568947255611, 0.0022240495309233665, -0.0030208928510546684, -0.014120128937065601, -0.0028883551713079214, -0.03561065346002579, 0.009355232119560242, 0.00037720752879977226, -0.003546195337548852, 0.05896317586302757, 0.026119651272892952, -0.023740436881780624, -0.024761946871876717, 0.017430342733860016, -0.015839887782931328, -0.009012572467327118, 0.04556715488433838, -0.004506286233663559, -0.012335716746747494, -0.040912166237831116, 0.0445585735142231, 0.01596919260919094, 0.02057245932519436, -0.01898200437426567, 0.05112727731466293, -0.04086044430732727, 0.006271302700042725, -0.018490644171833992, -0.008876802399754524, 0.016900191083550453, 0.01767602190375328, 0.009665564633905888, -0.0013754841638728976, 0.0023711342364549637, -0.01315680518746376, -0.0677042081952095, 0.04841186851263046, -0.01024097204208374, -0.015076987445354462, 0.03465379402041435, 0.008954385295510292, -0.03561065346002579, 0.015684721991419792, 0.009348766878247261, 0.020740555599331856, -0.027748897671699524, -0.02558949962258339, -0.0022870858665555716, 0.021852580830454826, 0.09206530451774597, 0.06310094147920609, -0.016486413776874542, 0.024438684806227684, -0.03483482450246811, -0.007687194738537073, -0.013176200911402702, 0.045127518475055695, -0.014443391934037209, -0.013434810563921928, -0.02539554238319397, -0.019447503611445427, -0.012872333638370037, -0.017844118177890778, -0.03211941197514534, 0.06320438534021378, 0.03232630342245102, 0.04473960027098656, 0.005821967031806707, -0.015283875167369843, -0.01677088439464569, 0.006775592919439077, -0.03511929512023926, -0.030386723577976227, 0.0211931224912405, -0.003410424804314971, 0.02057245932519436, 0.03305041044950485, 0.0016745023895055056, -0.007189369294792414, -0.00894145481288433, -0.018128590658307076, 0.01109438668936491, -0.017391549423336983, -0.01515457034111023, 0.014753724448382854, -0.023249076679348946, -0.011786169372498989, -0.0138615183532238, 0.020042307674884796, -0.008172089233994484, -0.030593611299991608, -0.0538426898419857, -0.036696817725896835, -0.04256727546453476, 0.04344654828310013, 0.010881032794713974, -0.04023978114128113, 0.02518865466117859, 0.0012267831480130553, 0.0095362588763237, 0.0008930140757001936, -0.017443273216485977, -0.016809677705168724, -0.000865536741912365, 0.031369443982839584, -0.012018918991088867, -0.005466377828270197, 0.02399904653429985, 0.03349004685878754, -0.024231795221567154, -0.0064458646811544895, -0.007939339615404606, 0.010900428518652916, 0.029171254485845566, 0.005446981638669968, -0.0019056354649364948, -0.0027622825000435114, -0.006365048699080944, -0.023947324603796005, -0.0021933396346867085, 0.0349382683634758, -0.005223930347710848, -0.004228280391544104, 0.010454325936734676, -0.008359581232070923, 0.00868284422904253, 0.0014579162234440446, -0.019499225541949272, -0.039515670388936996, 0.0895826444029808, -0.018141521140933037, -0.01499940361827612, 0.028162673115730286, 0.027205815538764, -0.034395184367895126, 0.0027089440263807774, 0.009600911289453506, 0.020106960088014603, -0.0029837177135050297, -0.013460672460496426, 0.061083778738975525, 0.0010506048565730453, -0.018930282443761826, -0.022331008687615395, -0.044532712548971176, 0.0008792753797024488, -0.017313966527581215, 0.004457796923816204, -0.03811917454004288, 0.010551304556429386, -0.014960612170398235, -0.0003937747678719461, -0.01777946576476097, 0.012277529574930668, 0.028628172352910042, -0.01370635163038969, 0.0020058469381183386, 0.014068406075239182, 0.020727625116705894, 0.009258252568542957, -0.028886783868074417, 0.04334310442209244, 0.0042573739774525166, -0.0012340565444901586, 0.022861160337924957, -0.017844118177890778, 0.006794988643378019, -0.015335597097873688, -0.03633476421236992, -0.02490418218076229, 0.004661452490836382, 0.0016971308505162597, 0.0018813908100128174, 0.000907560926862061, 0.007266952656209469, 0.012658979743719101, 0.015839887782931328, 0.022408591583371162, -0.0007540109800174832, -0.022848229855298996, 0.011566351167857647, -0.011779704131186008, 0.05182552710175514, -0.015645930543541908, -0.02288702130317688, -0.0347055159509182, 0.01948629505932331, 0.035196878015995026, -0.010893963277339935, 0.030360862612724304, -0.019538016989827156, -0.016938982531428337, 0.02458092011511326, 0.014262364245951176, -0.027231676504015923, -0.012840007431805134, 0.01999058574438095, -0.016201943159103394, -0.06206649914383888, 0.0138615183532238, 0.012232272885739803, 0.028266118839383125, 0.004758431576192379, -0.040498390793800354, 0.049730781465768814, 0.008883267641067505, 0.004735803231596947, -0.04900667443871498, 0.0365416519343853, 0.005311211571097374, 0.004231513012200594, 0.03424001857638359, -0.04735156521201134, -0.04179144278168678, -0.013305505737662315, -0.006633357144892216, 0.024128351360559464, 0.002943309722468257, 0.019706113263964653, -0.03222285583615303, -0.02839542366564274, -0.0211931224912405, -0.020055238157510757, -0.028291979804635048, -0.01110085193067789, 0.015283875167369843, 8.25330862426199e-05, 0.0007960351649671793, 0.018904421478509903, -0.001824819715693593, 0.02118019200861454, 0.03801573067903519, -0.009982362389564514, 0.017145870253443718, 0.060876891016960144, 0.027774758636951447, -0.000861495966091752, 0.026843760162591934, -0.00333930691704154, -0.019525086507201195, -0.03713645413517952, -0.023649921640753746, -0.038481228053569794, 0.0025069047696888447, -0.027283398434519768, 0.0005394451436586678, -0.011113782413303852, -0.022912882268428802, -6.578907687071478e-06, -0.016033845022320747, -0.006898432970046997, -0.006112903822213411, -0.026378262788057327, -0.008566469885408878, -0.005081694573163986, 0.04440340772271156, 0.055652961134910583, -0.041920747607946396, 0.03475723788142204, -0.003620545845478773, -0.016434691846370697, -0.0050849271938204765, -0.000494996493216604, -0.018619948998093605, -0.005573054309934378, 0.017391549423336983, -0.02220170386135578, -0.028240257874131203, -0.047636039555072784, -0.026973066851496696, 0.004991181194782257, 0.04349827021360397, 0.07070408761501312, -0.012982242740690708, -0.004622661042958498, 0.0003333649947308004, -0.0024196237791329622, 0.0033425395376980305, 0.031472887843847275, 0.014921820722520351, 0.03323143720626831, 0.05079108476638794, -0.007687194738537073, 0.005133416503667831, 0.0015096382703632116, -0.010525443591177464, -0.04468787834048271, -0.018852699548006058, 0.024309378117322922, -0.021503455936908722, -0.033800382167100906, 0.006879036780446768, 0.012827076949179173, -0.00822381116449833, 0.023339590057730675, 0.01063535362482071, 0.003953506704419851, 0.024826599285006523, -0.005175441037863493, 0.029559170827269554, 0.006471725646406412, 0.015891609713435173, -0.028731616213917732, 0.0044028423726558685, 0.007195834536105394, -0.07137647271156311, -0.03061947226524353, 0.025072280317544937, 0.01956387795507908, 0.008669913746416569, 0.0185552965849638, 0.0592217855155468, -0.005159277934581041, 0.022770646959543228, -0.02377922832965851, 0.009762543253600597, -0.03801573067903519, -0.042618997395038605, 0.009756078012287617, 0.0010522211669012904, 0.014986473135650158, -0.012859403155744076, -0.008281998336315155, -0.022240495309233665, 0.0035720563028007746, -0.0018425992457196116, -0.023262007161974907, -0.03592098504304886, -0.029740197584033012, 0.018800977617502213, -0.035093434154987335, -0.004836014937609434, 0.032067690044641495, -0.025563638657331467, -0.01194780133664608, 0.004784292541444302, 0.02059832029044628, 0.004247676115483046, 0.04117077961564064, 0.005799338687211275, -0.01938285119831562, -0.01059656124562025, -0.006604263558983803, -0.03266249597072601, -0.011889614164829254, -0.001332651823759079, 0.016007984057068825, 0.027929924428462982, -0.017740674316883087, 0.005573054309934378, 0.013111547566950321, 0.0044416338205337524, 0.006626891903579235, -0.0036755003966391087, -0.00750616705045104, -0.03030914068222046, -0.004053718410432339, 0.012568466365337372, 0.01847771368920803, 0.05283410847187042, -0.029041949659585953, -0.08761721104383469, -0.00441577285528183, 0.02487832121551037, 0.017727743834257126, -0.011508163064718246, -0.0069307591766119, 0.011320671066641808, 0.017339827492833138, 0.022912882268428802, -0.0025570103898644447, -0.005327374674379826, -0.023830950260162354, -0.01567179150879383, -0.0017165265744552016, -0.010816380381584167, -0.007435049396008253, -0.019331129267811775, 0.032067690044641495, 0.035972706973552704, 0.0069307591766119, -0.012814145535230637, 0.010525443591177464, 0.023636991158127785, 0.034291740506887436, -0.03912775591015816, -0.008152693510055542, 0.011223691515624523, -0.03612787649035454, -0.014249433763325214, 0.002217584289610386, 0.031886663287878036, 0.012503813952207565, 0.05611845850944519, 0.048127397894859314, 0.004574171733111143, 0.014779585413634777, 0.004499820992350578, 0.0437568835914135, 0.019007865339517593, 0.03219699487090111, 0.0027315726038068533, -0.060773447155952454, 0.03411071375012398, 0.007176438812166452, 0.012814145535230637, -0.02026212587952614, 0.0178699791431427, -0.052653081715106964, 0.020145751535892487, -0.015089917927980423, 0.011921940371394157, 0.007913478650152683, 0.008385442197322845, -0.030179835855960846, -0.024942973628640175, -0.01249734777957201, -0.027852341532707214, 0.016098497435450554, 0.0011023269034922123, 0.015594207681715488, -0.03160219267010689, 0.005695894360542297, 0.03925706073641777, -0.030671194195747375, -0.010777588933706284, -0.014831307344138622, -0.01736568845808506, 0.023520616814494133, -0.01637003943324089, -0.004183023236691952, 0.02258962020277977, -0.019447503611445427, -0.02702478878200054, -0.012975777499377728, -0.003429820528253913, 0.006943689659237862, -0.019654391333460808, -0.007939339615404606, -0.032274577766656876, -0.011281879618763924, 0.03643820807337761, 0.010215111076831818, 0.009465141221880913, 0.02919711545109749, -0.00892852433025837, -0.019344059750437737, 0.000619452737737447, -0.005382329225540161, 0.029636753723025322, 0.008786289021372795, 0.0026814667508006096, 0.037808842957019806, 0.026740316301584244, -0.0038953192997723818, 0.014572696760296822, -0.0010231274645775557, -0.0035074036568403244, -0.008372511714696884, 0.011740912683308125, 0.007040668278932571, 0.018697533756494522, -0.009329370222985744, 0.02992122434079647, -0.006352118216454983, -0.02971433661878109, -0.0063100941479206085, 0.027283398434519768, -0.02469729445874691, 0.014029614627361298, -0.024141281843185425, 0.0012631502468138933, 0.0005010576569475234, -0.002880273386836052, -0.008508282713592052, 0.025822250172495842, -0.010900428518652916, -0.0277230367064476, -0.011217226274311543, -0.004580636974424124, -0.010506047867238522, 0.0011023269034922123, 0.011256018653512001, 0.030903944745659828, 0.012355112470686436, 0.0010150459129363298, 0.022654272615909576, -0.009710821323096752, 0.02571880631148815, -0.0075449589639902115, 0.029067810624837875, 0.00020850464352406561, -0.0028091557323932648, 0.0018183544743806124, -0.01969318278133869, 0.05513574182987213, 0.01898200437426567, 0.014572696760296822, -0.0293264202773571, 0.02420593425631523, 0.006106438580900431, -0.030981527641415596, -0.006976015865802765, -0.01014399342238903, -0.00044893150334246457, -0.015193361788988113, 0.0008029045420698822, -0.03030914068222046, -0.034989990293979645, -0.01159221213310957, 0.040989749133586884, 0.04717053845524788, -0.0013366925995796919, 0.002962705446407199, 0.008294928818941116, -0.002393762581050396, 0.01229046005755663, -0.00655254116281867, -0.00048125782632268965, -0.010021153837442398, 0.06646287441253662, 0.037291619926691055, 0.056066736578941345, -0.009678495116531849, -0.002715409267693758, 0.048722200095653534, -0.0024535662960261106, -0.04217935726046562, -0.042308662086725235, 0.03855881094932556, 0.002023626584559679, -0.014624418690800667, -0.07085925340652466, 0.00988538283854723, 0.036386486142873764, -0.020753486081957817, 0.03211941197514534, 0.00874103233218193, -0.009019037708640099, 0.004108672961592674, 0.007014807313680649, 0.003504171036183834, 0.009756078012287617, -0.0014789282577112317, 0.021645691245794296, 0.014779585413634777, -0.026261886581778526, 0.021451734006404877, -0.0030144276097416878, 0.03879156336188316, 0.027929924428462982, 0.06211822107434273, 0.02097330428659916, 0.0138615183532238, 0.01059656124562025, 0.05102383345365524, 0.01868460327386856, 0.017611369490623474, 0.04548957198858261, -0.010409069247543812, -0.04458443447947502, -0.007551424205303192, 0.044118937104940414, 0.002146466402336955, -0.05896317586302757, -0.009982362389564514, 0.02300339564681053, 0.020016446709632874, -0.012788284569978714, 0.03343832492828369, -0.029067810624837875, 0.029636753723025322, 0.01048665214329958, -0.022227564826607704, -0.010978012345731258, 0.028860922902822495, 0.0045386129058897495, 0.01541318092495203, 0.01736568845808506, 0.010822845622897148, 0.006814384367316961, -0.009471606463193893, -0.022744785994291306, 0.025473125278949738, 0.029352281242609024, 0.00489096948876977, -0.003119488013908267, -0.0006121793412603438, -0.0020979770924896, -0.008113902062177658, 0.0033425395376980305, -0.027438564226031303, 0.04083458334207535, -0.05270480364561081, -0.016667440533638, -0.0077906385995447636, 0.019240614026784897, 0.020236264914274216, -0.003934110980480909, -0.010279763489961624, 0.004881271626800299, 0.034886546432971954, 0.0035720563028007746, -0.005909247789531946, 0.025124002248048782, -0.012374508194625378, -0.012271064333617687, 0.03281766176223755, 0.052342746406793594, -0.037886425852775574, 0.00029315915890038013, -0.006190486717969179, 0.05141175165772438, -0.006235743407160044, 0.01646055281162262, 0.009413419291377068, 0.016408830881118774, 0.006743266712874174, -0.004328491631895304, 0.03266249597072601, -0.02300339564681053, 0.002696013543754816, 0.007596680894494057, 0.016486413776874542, 0.004612963180989027, 0.010939220897853374, -0.0405501127243042, -0.014133059419691563, 0.0015508543001487851, -0.013719282113015652, 0.026740316301584244, -0.01410719845443964, 0.001279313350096345, 0.008999641984701157, 0.00798459630459547, -0.0026879319921135902, 0.004312328528612852, 0.04750673472881317, -0.005217465106397867, 0.01230339054018259, -0.02641705423593521, -0.03755023330450058, -0.02710237167775631, -0.023714574053883553, -0.010706471279263496, 0.023145632818341255, 0.018516505137085915, 0.042024191468954086, -0.006138764787465334, 0.013667560182511806, 0.06429054588079453, -0.001855529728345573, -0.004506286233663559, 0.017288105562329292, -0.005860758479684591, 0.029248837381601334, -0.008243206888437271, -0.009969430975615978, 0.01516750082373619, -0.0325331911444664, -0.0028091557323932648, -0.009846591390669346, 0.04029150307178497, 0.0044416338205337524, -0.0570494569838047, 0.011876683682203293, 0.032765939831733704, 0.017417412251234055, 0.006368281319737434, -0.03700714930891991, -0.0250852108001709, 0.008340185508131981, 0.0036367089487612247, 0.015490763820707798, 0.014792515896260738, 0.0037078268360346556, 0.01310508232563734, -0.024516267701983452, 0.0014070023316890001, 0.009096621535718441, 0.01797342300415039, -0.004477192647755146, -0.013538255356252193, 0.03661923483014107, 0.0010198948439210653, -0.033800382167100906, 0.012930520810186863, -0.013396019116044044, 0.004338189493864775, -0.0095362588763237, -0.0057670120149850845, -0.021464664489030838, 0.010777588933706284, 0.027154093608260155, 0.003153430763632059, -0.031886663287878036, 0.02518865466117859, 0.0014684222405776381, -0.039101894944906235, -0.03700714930891991, 0.01384858787059784, 0.0035332648549228907, 0.007557889446616173, -0.0025424635969102383, -0.029972946271300316, -0.02940400317311287, 0.012594327330589294, 0.009206530638039112, 0.003256874857470393, -0.02067590318620205, 0.0019411944085732102, 0.08823787420988083, -0.017688952386379242, -0.028654033318161964, 0.04825670272111893, 0.004596800077706575, 0.004050485789775848, -0.02058538980782032, 0.004092509858310223, -0.03361935541033745, 0.005805803928524256, -0.030981527641415596, 0.03201596811413765, -0.004774594679474831, -0.006891967728734016, 0.019538016989827156, 0.007797103840857744, -0.018413061276078224, -0.0031598960049450397, 0.004406074993312359, 0.01865874044597149, 0.005004111677408218, -0.056583959609270096, -0.01905958727002144, 0.019744904711842537, 0.0023889136500656605, -0.007351000793278217, 0.03030914068222046, 0.0017278408631682396, 0.0029610891360789537, 0.014533905312418938, -0.006264837458729744, 0.008113902062177658, -0.034472767263650894, 0.015581277199089527, 0.008353115990757942, 0.028964366763830185, -0.017546717077493668, -0.0055019366554915905, 0.0148054463788867, 0.011113782413303852, -0.010441395454108715, -0.00197190442122519, -0.015581277199089527, 0.009801334701478481, 0.0035332648549228907, -0.0069824811071157455, -0.023455964401364326, 0.013900309801101685, -0.008398373611271381, -0.012277529574930668, -0.011553420685231686, 0.009943570010364056, 0.026740316301584244, -0.02468436397612095, -0.017831187695264816, 0.0009617074974812567, 0.01118490006774664, 0.011133178137242794, 0.026339471340179443, 0.027231676504015923, -0.03139530494809151, -0.01205124519765377, -0.025654153898358345, -0.00010394926357548684, -0.022007746621966362, -0.015645930543541908, -0.007008342072367668, 0.013021034188568592, -0.04435168579220772, 0.012329251505434513, -0.005928643513470888, -0.02088279090821743, -0.011359462514519691, -0.019615599885582924, 0.0038080383092164993, 0.007868221960961819, -0.03636062517762184, 0.01836133934557438, -0.02076641656458378, -0.0018442155560478568, -0.019356990233063698, 0.02297753468155861, 0.004347887355834246, -0.00429293280467391, 9.687788406154141e-05, -0.012368042953312397, 0.01604677550494671, -0.022654272615909576, -0.025615360587835312, -0.0034039595630019903, -0.022809438407421112, 0.013564116321504116, -0.014598557725548744, -0.02842128463089466, 0.00607411190867424, -0.015232153236865997, 0.01816738210618496, -0.01697777397930622, 0.004225047770887613, 0.032274577766656876, 0.018438922241330147, 0.0018716928316280246, 0.04236038401722908, 0.001430438831448555, -0.04825670272111893, 0.02631361037492752, -0.028136812150478363, -0.013486533425748348, 0.017301036044955254, 0.03817089647054672, 0.018232034519314766, -0.0023711342364549637, 0.015684721991419792, 0.017637230455875397, -0.014482183381915092, 0.02880920097231865, 0.008889732882380486, 0.014094267971813679, 0.012251668609678745, 0.011618073098361492, 0.03367107734084129, 0.0020559527911245823, 0.004208884667605162, 0.004842480178922415, -0.004868341144174337, -0.0018894723616540432, -0.021619830280542374, 0.020960373803973198, -0.014081336557865143, 0.011139643378555775, -0.028473006561398506, 0.0063391877338290215, 0.004596800077706575, 0.01788290962576866, 0.003575288923457265, -0.017701882869005203, 0.012574931606650352, -0.0015654012095183134, -0.02339131198823452, -0.035972706973552704, 0.006652752868831158, -0.03041258454322815, 0.008165623992681503, 0.01856822706758976, -0.003471844829618931, -0.0331021323800087, -0.003504171036183834, -0.012005988508462906, 0.0034783100709319115, -0.00762900710105896, 0.002519835252314806, 0.015219222754240036, -0.030852222815155983, 0.027981646358966827, -0.01776653528213501, 0.00043034390546381474, 0.02218877337872982, -0.009626772254705429, 0.017107078805565834, -0.001608233549632132, 0.026119651272892952, 0.008430699817836285, 0.004464262165129185, -0.018141521140933037, 0.04305863380432129, 0.007111786399036646, 0.015283875167369843, 0.0071376473642885685, 0.005799338687211275, -0.0009762542904354632, 0.015076987445354462, -0.016538135707378387, 0.008088041096925735, 0.03685198351740837, -0.03793814778327942, -0.011146108619868755, 0.014094267971813679, -0.0054825409315526485, 0.009245322085916996, 0.03354176878929138, -0.003885621437802911, -0.04003289341926575, -0.02057245932519436, 0.020029377192258835, -0.007473840843886137, -0.008029852993786335, 0.014120128937065601, 0.02190430276095867, 0.0025990346912294626, -0.004800455644726753, 0.012452091090381145, 0.029145393520593643, 0.010156923905014992, -0.015529555268585682, 0.011159039102494717, 0.0014659977750852704, -0.0028560287319123745, -0.01615022122859955, 0.019719043746590614, 0.032972827553749084, 0.043006911873817444, -0.01675795391201973, -0.004309095907956362, 0.010725867003202438, 0.0014183165039867163, -0.030464306473731995, 0.00387915619648993, 0.008314324542880058, -0.003140500281006098, 0.013434810563921928, 0.010939220897853374, -0.0033134459517896175, 0.012413299642503262, 0.043601714074611664, -0.02940400317311287, -0.011831426061689854, -0.0013795249396935105, 0.012238738127052784, 0.019408712163567543, -0.026042068377137184, 0.014611488208174706, 0.010661214590072632, 0.010156923905014992, -0.004325259011238813, -0.010971547104418278, 0.024063698947429657, -0.0004073113959748298, 0.0001275878748856485, -0.01004701480269432, 0.0016809676308184862, -0.001499132253229618, -0.02992122434079647, -0.0010756576666608453, -0.011889614164829254, 0.021425873041152954, -0.029947085306048393, -0.02761959284543991, -0.014068406075239182, -0.03222285583615303, 0.03977428004145622, -0.029895363375544548, -0.024930043146014214, 0.01038967352360487, -0.03030914068222046, -0.0007253214134834707, -0.0026071162428706884, 0.017120009288191795, 0.007687194738537073, -0.037601955235004425, -0.005576286930590868, -0.017132939770817757, 0.00893498957157135, 0.0066107288002967834, -0.030179835855960846, -0.004509518854320049, -0.01168919075280428, -0.0063100941479206085, -0.02511107176542282, -0.00034669958404265344, -0.014831307344138622, -0.020029377192258835, 0.027231676504015923, 0.014921820722520351, -0.03222285583615303, -0.02699892781674862, -0.0016971308505162597, 0.0016389434458687901, -0.004907132592052221, -0.0074091884307563305, -0.015736443921923637, 0.003785409964621067, 0.014676140621304512, 0.021632760763168335, 0.00017607733025215566, 0.006045018322765827, 0.00740272318944335, -0.015633000060915947, -0.015076987445354462, -0.0017472365871071815, -0.02398611605167389, 0.02671445533633232, 0.04029150307178497, 0.003953506704419851, -0.008605261333286762, 0.052963413298130035, -0.009607376530766487, -0.021516386419534683, -0.014883029274642467, -0.003077463945373893, 0.0017553181387484074, 0.008624657057225704, -0.01099094282835722, 0.018296686932444572, -0.009251787327229977, 0.0026394424494355917, -0.01627952605485916, -0.00609674071893096, -0.005466377828270197, 0.03255905210971832, 0.029843641445040703, 0.014223572798073292, 0.020662972703576088, -0.014236503280699253, -0.0011378858471289277, 0.007422118913382292, 0.005815501790493727, -0.021322429180145264, 0.049937669187784195, 0.026559289544820786, 0.030593611299991608, -0.0009043283062055707, -0.00753202848136425, 0.0015282259555533528, 0.010893963277339935, 0.001719759195111692, 0.004496588371694088, -0.006820849608629942, 0.003049986669793725, 0.0022450615651905537, 0.010376743040978909, -0.006762662436813116, 0.014482183381915092, 0.018710464239120483, -0.049937669187784195, 0.05710117891430855, -0.029688475653529167, -0.0006255139596760273, -0.00441900547593832, -0.00010920228669419885, -0.018529435619711876, 0.00667861383408308, -0.02140001207590103, 0.03594684600830078, -0.03480895981192589, 0.0053467703983187675, 0.01788290962576866, -0.02046901360154152, 0.019628530368208885, 0.005059066228568554, -0.023520616814494133, -0.007693659979850054, -0.003856527851894498, 0.0007681537535972893, -0.012859403155744076, -0.04277416318655014, 0.04846359044313431, 0.04367930069565773, -0.00251175370067358, 0.018956143409013748, -0.0013665944570675492, -0.0021480827126652002, 0.02129656821489334, -0.009626772254705429, -0.02710237167775631, -0.02220170386135578, -0.002717025578022003, 0.022628411650657654, -0.02190430276095867, -0.018813908100128174, 0.01024097204208374, -0.0045774043537676334, 0.0119413360953331, 0.048334285616874695, 0.007260487414896488, 0.011779704131186008, 0.02839542366564274, 0.010021153837442398, 0.00715057784691453, -0.010564235039055347, -0.012962847016751766, 0.028679894283413887, -0.017921701073646545, -0.003282735822722316, 0.016124358400702477, 0.014870098792016506, 0.014986473135650158, -0.005734685808420181, 0.029481587931513786, 0.03142116591334343, 0.02037850022315979, 0.0016938982298597693, -0.049730781465768814, -0.0046937791630625725, -0.01978369615972042, 0.0015468135243281722, -0.0065719373524188995, -0.00033639557659626007, 0.011146108619868755, 0.017740674316883087]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"
⋆1/2∥2
F+ 2∥△i
BΣi
⋆1/2∥2
F) + (P−1)X
j̸=i∥CT
iCj∥2
2(2 +ϵ)2
2(1−ϵ)2(2∥△j
AΣj
⋆1/2∥2
F
+ 2∥△j
BΣj
⋆1/2∥2
F) +X
j̸=i2(1 +ϵ
2)2δi
2r
(1−ϵ)2∥CT
iCj∥(2∥△j
AΣj
⋆1/2∥F+ 2∥△j
BΣj
⋆1/2∥F)(∥△i
AΣi
⋆1/2∥F
+∥△i
BΣi
⋆1/2∥F)) + 2 η((1−η)δi
2r(2 +ϵ)
2(1−ϵ)(2∥△i
AΣi
⋆1/2∥2
F+ 2∥△i
BΣi
⋆1/2∥2
F)
+ηδi
2r(2 +ϵ)
2(1−ϵ)2(2∥△i
BΣi
⋆1/2∥2
F+ 2∥△i
AΣi
⋆1/2∥2
F) +(2 +ϵ)(1−η)
2(1−ϵ)X
j̸=i∥CT
iCj∥2(∥△j
AΣj
⋆1/2∥2
F
+∥△j
BΣj
⋆1/2∥2
F+∥△i
AΣi
⋆1/2∥2
F+∥△i
BΣi
⋆1/2∥2
F) +η(2 +ϵ)
2(1−ϵ)2X
j̸=i∥CT
iCj∥2(∥△j
AΣj
⋆1/2∥2
F+
∥△j
BΣj
⋆1/2∥2
F+∥△i
BAi
⋆T∥2
F+∥△i
AAi
⋆T∥2
F))
≤((1−η)2+2ϵη(1−η)
1−ϵ+η2(2ϵ+ϵ2)
(1−ϵ)2+η2δi
2r2(2 +ϵ)2
(1−ϵ)2)dist2(Fi
t, Fi
⋆)
+X
j̸=i(P−1)η2(2 +ϵ)2∥CT
iCj∥2
2
(1−ϵ)2dist2(Fj
t, Fj
⋆)
+X
j̸=i8η2(1 +ϵ
2)2δi
2r
(1−ϵ)2∥CT
iCj∥dist(Fi
t, Fi
⋆)dist(Fj
t, Fj
⋆) +2η(1−η)δi
2r(2 +ϵ)
(1−ϵ)dist2(Fi
t, Fi
⋆)
+2η2δi
2r(2 +ϵ)
(1−ϵ)2dist2(Fi
t, Fi
⋆) +X
j̸=iη(2 +ϵ)(1−η)
1−ϵ∥CT
iCj∥2dist2(Fj
t, Fj
⋆)
+η(2 +ϵ)(1−η)P
j̸=i∥CT
iCj","[-0.007253433112055063, -0.03390761464834213, 0.03837126865983009, 0.023958513513207436, -0.019252857193350792, 0.000372040958609432, 0.005256890319287777, -0.012900221161544323, -0.00806011725217104, 0.0422164611518383, 0.0018015941604971886, 0.00673581101000309, -0.05560741573572159, 0.015219437889754772, 0.014762316830456257, -0.004870354663580656, 0.022506482899188995, -0.05528474226593971, -0.044824738055467606, 0.03998463600873947, -0.008234898559749126, -0.02296360395848751, 0.05861903354525566, -0.00034746230812743306, -0.004134255461394787, -0.003472102340310812, 0.044932298362255096, -0.00797944888472557, 0.054316721856594086, -0.031648900359869, 0.04426005855202675, -0.03535964712500572, 0.00425525801256299, -0.09061750024557114, 0.009471814148128033, 0.06507250666618347, -0.014937098138034344, 0.054047826677560806, 0.008080284111201763, 0.023582061752676964, 0.02748103439807892, 0.012806108221411705, -0.07303179055452347, -0.040468644350767136, -0.042324017733335495, -0.034552961587905884, 0.010991068556904793, 0.01595889776945114, 0.03818304091691971, 0.028368385508656502, -0.01504465565085411, 0.029497744515538216, -0.002322577638551593, 0.0006016517872922122, -0.03143378347158432, 0.02537021040916443, 0.002351147588342428, 0.0369999036192894, 0.04764813184738159, -0.030600212514400482, 0.05931816250085831, 0.016133679077029228, 0.044555842876434326, -0.00013339695578906685, -0.04861615225672722, 0.00759627390652895, -0.018419284373521805, 0.017397483810782433, 0.03896283730864525, 0.011549025774002075, -0.03275137022137642, 0.02098722755908966, 0.060393739491701126, -0.008234898559749126, 0.026566792279481888, -0.01042638998478651, 0.003915778361260891, -0.022748487070202827, 0.06103908643126488, -0.0002571305085439235, 0.052891578525304794, 0.0244290791451931, 0.05668299272656441, -0.01266493834555149, 0.04659944400191307, -0.0858849510550499, -0.0593719407916069, 0.01821761205792427, -0.08357246220111847, -0.011535580269992352, -0.02944396436214447, -0.013680015690624714, -0.016174012795090675, 0.006786228623241186, 0.03498319536447525, -0.025060981512069702, 0.011192739941179752, -0.00864496361464262, -0.005088831298053265, -0.018943628296256065, 0.029228849336504936, -0.007475271355360746, 0.035736098885536194, 0.004833381623029709, 0.026768462732434273, 0.0211216751486063, -0.051278211176395416, -0.013848074711859226, -0.05092864856123924, 0.030600212514400482, 0.014937098138034344, 0.022385479882359505, 0.00594257190823555, 0.036892347037792206, -0.009243253618478775, -0.040737539529800415, -0.04961106553673744, 0.01261115912348032, -0.012597714550793171, -0.0009260059450753033, -0.005905598867684603, 0.0158513393253088, 0.020113321021199226, -0.013243061490356922, 0.01326322928071022, -0.012853164225816727, 0.01941419392824173, -0.05385959893465042, -0.06007106602191925, -0.05872659385204315, 0.04923461005091667, 0.006873619742691517, 0.0007495438330806792, 0.005724094808101654, 0.0024855949450284243, 0.009922212921082973, 0.023313166573643684, 0.08093728870153427, 0.02785748615860939, -0.04649188742041588, 0.020274657756090164, 0.011589359492063522, -0.013901853933930397, 0.0128800543025136, 0.027696149423718452, 0.03199846297502518, -0.04149044677615166, -0.016066456213593483, -0.009283588267862797, -0.03670411929488182, -0.014157303608953953, -0.011098627001047134, -0.023084606975317, -0.02101411670446396, 0.009270142763853073, -0.030411984771490097, 0.026378566399216652, 0.05614520236849785, 0.019750311970710754, 0.013969077728688717, -0.03678479045629501, 0.031864017248153687, -0.050121963024139404, 0.0003842252481263131, 0.03842504695057869, 0.02535676583647728, -0.01691347360610962, 0.006016517989337444, -0.07609719038009644, -0.014963987283408642, -0.007320656906813383, -0.0040266974829137325, -0.042431578040122986, -0.009996159002184868, 0.03288581594824791, -0.010836455039680004, -0.01214731577783823, -0.0647498294711113, 0.011051570065319538, 0.010648228228092194, 0.011206184513866901, 0.047728803008794785, 0.008503793738782406, 0.01757226511836052, -0.02085277996957302, 0.01090367790311575, 0.024792086333036423, 0.02890617586672306, 0.013021223247051239, -0.002035196404904127, 0.024993758648633957, 0.03237491473555565, 0.05619898438453674, 0.013848074711859226, -0.01056083757430315, -0.01573033817112446, 0.023676173761487007, 0.015932008624076843, 0.022627485916018486, 0.07050418108701706, 0.04028042033314705, 0.023541726171970367, 0.01531355082988739, 0.021336790174245834, -0.04294247552752495, -0.016335349529981613, 0.010446557775139809, 0.00587534811347723, -0.036919236183166504, -0.0056703160516917706, 0.013807740993797779, -0.04657255485653877, 0.004581292625516653, 0.008927302435040474, -0.017330260947346687, 0.030304428189992905, -0.0064971670508384705, 0.02917506918311119, -0.03224046900868416, 0.05695188790559769, -0.007609718944877386, 0.04832036793231964, -0.005972822662442923, -0.004386343993246555, -0.027131469920277596, 0.06431960314512253, 0.05004129558801651, -0.010345721617341042, 0.002917506964877248, -0.047191012650728226, 0.04154422506690025, 0.003983002156019211, -0.03245558589696884, -0.015918564051389694, 0.030277539044618607, -0.006890425458550453, -0.04240468889474869, -0.0035594929940998554, -0.02164601907134056, -0.014184192754328251, -0.013222894631326199, 0.011965812183916569, 0.009431480430066586, -0.035440314561128616, 0.0009117209119722247, -0.03681167960166931, 0.00573753984645009, 0.0016192500479519367, -0.01504465565085411, 0.008167674764990807, 0.001580596435815096, 0.016442907974123955, 0.00018076863489113748, 0.01597234234213829, -0.05348314717411995, -0.019844425842165947, -0.005804763175547123, 0.03275137022137642, -0.0006256002234295011, 0.041275329887866974, -0.048024583607912064, 0.013001056388020515, -0.05060597509145737, -0.017249591648578644, 0.0070988186635077, -0.018822625279426575, 0.025034092366695404, 0.0422433502972126, 0.008329011499881744, -0.00970037467777729, 0.020839335396885872, 0.051439546048641205, 0.018459618091583252, 0.00806011725217104, -0.026472678408026695, -0.007508883252739906, -0.012517046183347702, 0.04380293935537338, -0.01929319091141224, -0.006944204680621624, -0.04068376123905182, 0.0031090944539755583, 0.017061365768313408, -0.007313934620469809, 0.025639105588197708, -0.04439450800418854, -0.019441083073616028, 0.0008814702741801739, 0.006897147744894028, -0.026728129014372826, 0.012638049200177193, -0.014856429770588875, 0.033074043691158295, -0.009673485532402992, -0.012496879324316978, -0.006587918847799301, -0.014157303608953953, -0.055230963975191116, 0.005787957459688187, 0.01833861507475376, 0.03049265407025814, 0.01069528516381979, 0.0014923653798177838, 0.04041486606001854, -0.02218380942940712, 0.01062806136906147, 0.011811197735369205, 0.0012251512380316854, 0.005922404583543539, -0.022640930488705635, 0.000735678942874074, 0.0019276385428383946, -0.04520118981599808, -0.003292278852313757, -0.048777490854263306, -0.01598578691482544, 0.01688658446073532, 0.006571113131940365, 0.01993853785097599, -0.022143475711345673, 0.019091520458459854, -0.028986843302845955, 0.014990877360105515, -0.02390473522245884, 0.008275233209133148, -0.015622779726982117, -0.007555939722806215, 0.018782291561365128, 0.0013301882427185774, -0.031380005180835724, -0.01929319091141224, 0.03008931130170822, 0.01691347360610962, -0.007206376641988754, 0.008765965700149536, -0.022640930488705635, -0.025060981512069702, 0.04541630670428276, -0.009975992143154144, 0.005801402032375336, -0.03950062394142151, -0.006184577010571957, -0.0004588015144690871, 0.030169980600476265, 0.023138385266065598, -0.04103332385420799, 0.034902527928352356, -0.005139248911291361, 0.08281955122947693, 0.05845769867300987, -0.018002497032284737, -0.008039950393140316, 0.000566779519431293, -0.004675406031310558, -0.04106021299958229, -0.027440698817372322, 0.02826082892715931, -0.0554460771381855, -0.027507923543453217, -0.0008213891414925456, -0.02917506918311119, -0.0035964660346508026, 0.04579275846481323, -0.0025561798829585314, -0.01161624863743782, 0.019481418654322624, 0.004329204093664885, 0.03089599497616291, 0.017491597682237625, -0.008886968716979027, -0.019508307799696922, 0.04565831273794174, -0.049584172666072845, -0.004961106460541487, -0.028583502396941185, -0.03952751308679581, 0.03272448107600212, 0.013048113323748112, 0.054047826677560806, -0.011777586303651333, -0.00804667267948389, -0.012698549777269363, -0.012490157037973404, 0.0270508024841547, 0.003362863790243864, 0.009868433699011803, -0.004382982850074768, -0.014439643360674381, -0.010460002347826958, -0.021054452285170555, 0.04213579371571541, -0.025262651965022087, 0.005609814543277025, 0.03818304091691971, -0.022667819634079933, -0.03786036744713783, 0.05205800384283066, 0.09465091675519943, 0.025114761665463448, 0.015797561034560204, -0.024240853264927864, -0.0382637083530426, -0.05695188790559769, -0.009021415375173092, -0.04181312024593353, 0.0038720830343663692, 0.05111687257885933, 0.03654278442263603, 0.015542111359536648, -0.001530178589746356, -0.0015654710587114096, -0.013619514182209969, 0.011152406223118305, -0.01345817744731903, 0.0007197133381851017, -0.025262651965022087, -0.02532987669110298, 0.03474118933081627, 0.014816095121204853, 0.03931239992380142, -0.015595889650285244, 0.014358974993228912, -0.0191318541765213, -0.010863344185054302, -0.05186977982521057, 0.015461442992091179, 0.033880725502967834, 0.023608950898051262, 0.04538941755890846, -0.04907327517867088, 0.010708729736506939, 0.059210602194070816, 0.01823105849325657, 0.050525303930044174, -0.0356554314494133, -0.011824642308056355, 0.020126765593886375, -0.028449054807424545, -0.0044233170337975025, -0.02655334770679474, 0.010318832471966743, -0.019320080056786537, -0.011522135697305202, 0.006678671110421419, -0.021188898012042046, 0.035467203706502914, 0.037806589156389236, -0.029282627627253532, -0.021444348618388176, 0.02273504249751568, -0.05442427843809128, -0.03234802559018135, 0.038640160113573074, -0.01281283050775528, -0.011273408308625221, -0.01809661090373993, 0.058027464896440506, 0.022640930488705635, 0.020234322175383568, -0.014574090018868446, 0.04202823340892792, -0.03129933774471283, 0.008631518110632896, 0.01142130047082901, 0.0014192595845088363, 0.015555555932223797, 0.0218073558062315, -0.0033393355552107096, 0.012194372713565826, 0.02809949219226837, -0.013485066592693329, -0.07109574973583221, 0.04065687209367752, -0.006355997174978256, -0.021605685353279114, 0.010816287249326706, 0.0034788246266543865, -0.023219052702188492, 0.00016879441682249308, 0.0014058148954063654, 0.025544991716742516, -0.048374149948358536, -0.022130029276013374, 0.021982137113809586, 0.030600212514400482, 0.07980793714523315, 0.06189955025911331, -0.0343647375702858, 0.01128685288131237, -0.014600980095565319, -0.0047728801146149635, -0.004487179685384035, 0.055230963975191116, -0.014990877360105515, -0.0030536348931491375, -0.03603188320994377, -0.042055122554302216, -0.002225103322416544, -0.026862576603889465, -0.0449054092168808, 0.05985594913363457, 0.03616633266210556, 0.03264380991458893, 0.01525977160781622, -0.023985402658581734, -0.013101891614496708, 0.014103524386882782, -0.04471718147397041, -0.029201960191130638, 0.016053011640906334, 0.009626428596675396, 0.027077691629529, 0.018459618091583252, 0.020960338413715363, 0.010137328878045082, -0.005774512887001038, -0.032805148512125015, -0.000986507278867066, 0.007710554171353579, -0.029148180037736893, 0.023393835872411728, -0.025665994733572006, -0.014587534591555595, -0.02352828159928322, 0.007945837453007698, -0.033450495451688766, -0.017209257930517197, -0.08039949834346771, -0.03390761464834213, -0.05310669541358948, 0.03812926262617111, -0.006910592783242464, -0.04116777330636978, 0.036139439791440964, 0.018311725929379463, 0.012006145901978016, -0.013888409361243248, -0.008557572029531002, 0.003539325902238488, -0.0038384711369872093, 0.03051954321563244, -0.024657640606164932, -0.03328915685415268, 0.022882934659719467, 0.028018822893500328, -0.0039225006476044655, 0.015205992385745049, 0.002604916924610734, 0.004961106460541487, 0.0178142711520195, 0.015205992385745049, -0.015878228470683098, -0.009088639169931412, 0.0035426870454102755, -0.028610391542315483, 0.010715452022850513, 0.02998175472021103, 0.00016711383068468422, -0.021874580532312393, -0.004201478790491819, 0.0007865168736316264, 0.012194372713565826, 0.005801402032375336, -0.01511187944561243, -0.0409526564180851, 0.06394314765930176, -0.003754441626369953, -0.005424949806183577, 0.028072601184248924, 0.04450206458568573, -0.0343378484249115, 0.0024032460059970617, 0.0023713146802037954, 0.0171554796397686, 0.008013060316443443, -0.003416642779484391, 0.04157111421227455, -0.009229809045791626, -0.029336407780647278, -0.02734658680856228, -0.046276770532131195, 0.021968692541122437, -0.02877172827720642, 0.013021223247051239, -0.0329933725297451, 0.010197829455137253, -0.008073561824858189, -0.013048113323748112, -0.014883318915963173, 0.018015941604971886, 0.033208489418029785, -0.012006145901978016, -0.000889032962732017, 0.022761931642889977, 0.02351483702659607, 0.02362239547073841, -0.01525977160781622, 0.030788438394665718, 0.01035916619002819, -0.011710362508893013, 0.033047154545784, -0.016940362751483917, -0.014130414463579655, -0.0016385768540203571, -0.036892347037792206, -0.015407663770020008, 0.013364064507186413, -0.005606453400105238, 0.016066456213593483, 0.0003890569496434182, -0.013706904835999012, 0.03285892680287361, 0.016980698332190514, 0.015784116461873055, -0.015084990300238132, -0.009209642186760902, 0.0053543648682534695, -0.01524632703512907, 0.036919236183166504, -0.03022375889122486, -0.038909055292606354, -0.02655334770679474, 0.03181023895740509, 0.020946893841028214, -0.011757418513298035, 0.03062710165977478, -0.009733986109495163, -0.007952559739351273, 0.037322577089071274, -0.001925957971252501, -0.02151157148182392, 0.0006865216419100761, 0.014090079814195633, -0.006335830315947533, -0.07061173766851425, 0.005102275870740414, 0.015461442992091179, 0.02456352673470974, -0.022385479882359505, -0.05609142407774925, 0.042162682861089706, 0.01836550422012806, 0.003157831495627761, -0.06480361521244049, 0.011414578184485435, 0.0343647375702858, 0.00016658863751217723, 0.01981753669679165, -0.04606165364384651, -0.04783635959029198, -0.00766349770128727, -0.006349274888634682, 0.022116584703326225, -0.010641505941748619, 0.026862576603889465, -0.028852395713329315, -0.01730337180197239, -0.012187650427222252, -0.032697588205337524, -0.024240853264927864, 0.00358302122913301, 0.032267358154058456, 0.010607894510030746, -0.0022603957913815975, 0.03116489015519619, -0.004268702585250139, 0.011864976957440376, 0.038075484335422516, 0.011515413410961628, 0.028153270483016968, 0.032294247299432755, 0.06410448253154755, -0.018836069852113724, 0.03708057105541229, 0.02559877187013626, -0.0031628734432160854, -0.00528714107349515, -0.04253913462162018, -0.0422164611518383, 0.007421492598950863, -0.030304428189992905, 0.015152214094996452, -0.022788822650909424, -0.007065207231789827, -0.015569000504910946, -0.017747046425938606, 0.0032267358619719744, -0.013969077728688717, -0.02391817979514599, -0.008685297332704067, -0.0008940747356973588, 0.027010468766093254, 0.060286182910203934, -0.046949006617069244, 0.023676173761487007, -0.004557764623314142, -0.005643426440656185, -0.005441755522042513, -0.016429463401436806, -0.01714203506708145, -0.016550466418266296, 0.00554595235735178, -0.026983577758073807, -0.015811005607247353, -0.05227312073111534, -0.037026792764663696, -0.008712186478078365, 0.039661962538957596, 0.06437338143587112, -0.01728992722928524, -0.007287045009434223, 0.013915298506617546, -0.012900221161544323, 0.00021438045951072127, 0.007542495150119066, 0.009545760229229927, 0.03578987717628479, 0.03632766753435135, -0.0032435418106615543, -0.0014394266763702035, 0.0035292422398924828, 0.004816575441509485, -0.029874196276068687, -0.0026906272396445274, 0.009337366558611393, -0.019857870414853096, -0.04875060170888901, 0.0008205488556995988, 0.006258523091673851, -0.021296456456184387, 0.031084222719073296, 0.011434745043516159, 0.01050705835223198, 0.029417075216770172, 0.0038552770856767893, 0.023071160539984703, 0.0005655190907418728, 0.009108806028962135, -0.04686833918094635, 0.019320080056786537, 0.019037742167711258, -0.05904926732182503, -0.03291270509362221, 0.0014335446758195758, 0.004540958441793919, 0.0014402669621631503, 0.0037746087182313204, 0.059479497373104095, 0.0006285412819124758, 0.019736867398023605, -0.015421108342707157, 0.011434745043516159, -0.02734658680856228, -0.01679247058928013, 0.011233074590563774, 0.0073946029879152775, 0.002203255658969283, -0.006097186356782913, 0.003737635677680373, -0.016348794102668762, 0.01716892421245575, -0.006413137540221214, -0.020288102328777313, -0.0283952746540308, -0.016684914007782936, 0.010789398103952408, -0.03788725659251213, -0.0025847498327493668, 0.02809949219226837, -0.029739748686552048, -0.009055027738213539, 0.009861711412668228, 0.005989628378301859, -0.004443484358489513, 0.02137712575495243, 0.0014150581555441022, -0.0283952746540308, -0.03880149871110916, -0.011011236347258091, -0.03460674360394478, 0.02022087760269642, 0.003265389474108815, -0.020099874585866928, 0.013182560913264751, -0.018311725929379463, -0.0048064920119941235, 0.03630077838897705, 0.0062518008053302765, 0.0021360318642109632, -0.007549217436462641, 0.009760876186192036, -0.017222702503204346, -0.01439930871129036, 0.002959521720185876, 0.005734178703278303, 0.022748487070202827, -0.02190146967768669, -0.08013060688972473, 0.006571113131940365, 0.04689522832632065, -0.0023612312506884336, -0.016859695315361023, 0.0005659392336383462, 0.030680879950523376, 0.03178334981203079, 0.019696533679962158, 0.013041391037404537, -0.005784596316516399, -0.007737443782389164, -0.01241621095687151, 0.022788822650909424, 0.0006461874581873417, 0.002786420751363039, -0.006026601418852806, 0.014022856019437313, 0.01599923148751259, 0.0015982425538823009, 0.0025024008937180042, 0.007461826782673597, 0.014049746096134186, 0.024267742410302162, -0.05609142407774925, -0.002862047404050827, -0.004514068830758333, -0.048777490854263306, 0.00011154927051393315, 0.0038283877074718475, 0.029901085421442986, 0.013942187651991844, 0.05100931599736214, 0.01029866561293602, 0.026728129014372826, 0.020556995645165443, -0.014345529489219189, 0.03767213970422745, 0.03283203765749931, 0.027037357911467552, -0.014896763488650322, -0.04794391617178917, 0.0270508024841547, 0.025249207392334938, 0.022291366010904312, -0.011925477534532547, -0.005068664439022541, -0.051547106355428696, 0.02695668861269951, -0.016873139888048172, -0.00818112026900053, -0.00047560743405483663, 0.0013629597378894687, -0.04017286002635956, -0.011428022757172585, -0.0013007778907194734, -0.01214731577783823, 0.04396427422761917, 0.016926918178796768, 0.008994526229798794, -0.047459907829761505, 0.013632958754897118, 0.033719390630722046, -0.02507442608475685, -0.0044569289311766624, -0.006840007845312357, -0.03686545789241791, 0.020664554089307785, -0.03390761464834213, -0.0011402814416214824, 0.022009028121829033, -0.03353116288781166, -0.019441083073616028, -0.011105349287390709, -0.007448381744325161, 0.0029612022917717695, -0.01082300953567028, -0.02680879645049572, -0.03051954321563244, -0.005391337908804417, 0.02507442608475685, 0.018069719895720482, -0.01624123752117157, 0.013377509079873562, -0.016402574256062508, -0.013283396139740944, 0.011468357406556606, 0.0008940747356973588, 0.03116489015519619, 0.018311725929379463, -0.0008079443941824138, 0.028852395713329315, 0.018809180706739426, -0.01625468209385872, 0.011172573082149029, 0.0011402814416214824, -0.01780082657933235, 0.017128588631749153, 0.0038821666967123747, 0.014479977078735828, 0.025423988699913025, -0.01017766259610653, 0.03444540500640869, -0.01968308910727501, -0.044582732021808624, 0.00403005862608552, 0.010520502924919128, -0.026862576603889465, 0.0021561989560723305, -0.018553731963038445, -0.008033228106796741, 0.007414770312607288, -0.0036300779320299625, 0.004648516420274973, 0.03468741104006767, -0.016416018828749657, -0.03872083127498627, -0.02044943906366825, -0.017854604870080948, -0.011307020671665668, -0.009673485532402992, 0.02363584004342556, 0.02165946364402771, 0.014439643360674381, -0.011602804064750671, 0.02879861742258072, -0.013249783776700497, 0.026230674237012863, 0.008685297332704067, 0.026728129014372826, 0.003801498096436262, -0.002504081465303898, 0.01307500246912241, -0.009128973819315434, 0.05372515320777893, 0.009068472310900688, 0.028287718072533607, -0.02480553276836872, 0.015528666786849499, 0.0007071089348755777, -0.00870546419173479, -0.026714684441685677, 0.0042115626856684685, -0.0026654182001948357, 0.004500624258071184, 0.004137616604566574, -0.012517046183347702, -0.02098722755908966, -0.0024973591789603233, 0.046438105404376984, 0.04915394261479378, -0.019212523475289345, 0.008597906678915024, -0.016577355563640594, -0.011105349287390709, -0.0016889945836737752, -0.02629789710044861, -0.0019141938537359238, -0.005270335357636213, 0.06362047791481018, 0.05256890505552292, 0.04555075615644455, 0.0017226063646376133, -0.005767790134996176, 0.04194756597280502, -0.013753961771726608, -0.03146067634224892, -0.04081820696592331, 0.04963795468211174, -0.019871314987540245, -0.018177278339862823, -0.03683856874704361, 0.01193892303854227, 0.03794103488326073, 0.006971093825995922, 0.027911264449357986, -0.0002909524191636592, -0.03390761464834213, -0.007287045009434223, -0.006366081070154905, -0.0034620186779648066, 0.00910208374261856, -0.008013060316443443, 0.012382598593831062, 0.013377509079873562, -0.033719390630722046, 0.04794391617178917, 0.006248439662158489, 0.02694324404001236, 0.024509748443961143, 0.07824834436178207, 0.026513012126088142, 0.01195236761122942, 0.014842985197901726, 0.06743878126144409, 0.023219052702188492, -0.0028939787298440933, 0.042834918946027756, -0.007932391948997974, -0.0038586382288485765, 0.024509748443961143, 0.03366561233997345, 0.033047154545784, -0.050121963024139404, -0.0010982665698975325, 0.01168347243219614, 0.022506482899188995, -0.0064030541107058525, 0.01862095482647419, -0.012463266961276531, -0.0021948525682091713, 0.0356823205947876, -0.022130029276013374, -0.003999807871878147, -0.011730529367923737, 0.0002718356845434755, 0.001394891063682735, 0.03799481317400932, 0.01836550422012806, -0.0019326803740113974, 0.010009603574872017, -0.03261692076921463, 0.017357150092720985, 0.011360798962414265, -0.0005344281089492142, -0.010211274959146976, -0.019306635484099388, 0.00608038017526269, -0.020503217354416847, 0.004198117647320032, -0.03210602328181267, 0.060823969542980194, -0.04649188742041588, -0.011394411325454712, 0.00630557956174016, 0.03353116288781166, 0.006453471723943949, 0.005310669541358948, -0.0017578988336026669, -0.004833381623029709, 0.04146355763077736, 0.01347162202000618, -2.3016227714833803e-05, 0.02035532519221306, -0.015515221282839775, -0.027776818722486496, 0.01076250895857811, 0.0488850474357605, -0.0158244501799345, -0.020933449268341064, -0.0033813503105193377, 0.040495533496141434, 8.166625048033893e-05, 0.004443484358489513, -0.007905502803623676, 0.022775378078222275, -0.0024855949450284243, -0.00142094015609473, 0.018647843971848488, -0.006826563272625208, 0.018957072868943214, 0.0015083309262990952, 0.005663593765348196, 0.0016889945836737752, -0.001104148686863482, -0.03971574082970619, -0.027104580774903297, -0.004346009809523821, 0.008134063333272934, 0.002949438290670514, 0.001808316563256085, -0.0069509269669651985, 0.00023402237275149673, 0.013330452144145966, 0.0211216751486063, 0.0008188682259060442, 0.03643522411584854, -0.0031712763011455536, 0.002588110975921154, -0.022896379232406616, -0.05125132203102112, -0.004477095790207386, -0.023582061752676964, 0.005421588663011789, 0.016940362751483917, -0.00608038017526269, 0.0343378484249115, -0.013982522301375866, 0.042969364672899246, 0.03328915685415268, 0.014923653565347195, -0.025961779057979584, 0.014762316830456257, 0.006456832867115736, 0.014708537608385086, -0.025047536939382553, -0.010964179411530495, 0.020946893841028214, -0.012523768469691277, 0.0035258810967206955, -0.020435994490981102, 0.04477095976471901, 0.0025561798829585314, -0.04197445511817932, 0.0042586191557347775, 0.029901085421442986, 0.02269470877945423, 0.013559012673795223, -0.044179391115903854, -0.017505042254924774, 0.0038586382288485765, 0.005387976765632629, 0.004443484358489513, 0.005266974214464426, -0.005028330255299807, 0.01965619996190071, -0.04329203814268112, -0.0001972594327526167, 0.001794871874153614, 0.016026120632886887, 0.0018217612523585558, -0.008396235294640064, 0.05165466293692589, -0.017505042254924774, -0.025571880862116814, 0.024079516530036926, -0.003801498096436262, -0.002668779343366623, 0.005317391827702522, -0.010076827369630337, -0.0211485642939806, 0.021820800378918648, 0.04780947044491768, -0.006234994623810053, -0.041382886469364166, 0.015165658667683601, -0.01011043880134821, -0.022493038326501846, -0.03062710165977478, -0.0018116777064278722, 0.006040045991539955, 0.002685585292056203, -0.0016486603999510407, -0.016698358580470085, -0.027642371132969856, 0.014278306625783443, 0.01848650723695755, -0.011723807081580162, -0.030573321506381035, -0.02733314223587513, 0.09567271918058395, -0.02335350029170513, -0.028207048773765564, 0.04081820696592331, 0.015004321932792664, -0.001083141309209168, -0.004887160379439592, -0.006729088723659515, -0.009377701207995415, 0.0015066503547132015, -0.056736771017313004, 0.02520887367427349, 0.016174012795090675, -0.00034031979157589376, 0.018136944621801376, -0.0014688370283693075, -0.0054148659110069275, -0.0008058436797000468, 0.008678575046360493, 0.025665994733572006, 0.005653510335832834, -0.04396427422761917, -0.012974167242646217, 0.009216364473104477, 0.019857870414853096, -0.007824834436178207, 0.029255738481879234, -0.009545760229229927, -0.011038125492632389, 0.029874196276068687, 0.0014982473803684115, 0.02428118698298931, -0.015434552915394306, -0.007898780517280102, 0.015891674906015396, 0.03471430018544197, -0.02532987669110298, 0.0076971095986664295, -0.01155574806034565, -0.0027578508015722036, -0.03659656271338463, 0.00030628780950792134, -0.01782771572470665, 0.014237971976399422, 0.0026452511083334684, -0.0026368482504040003, -0.025571880862116814, 0.0004296012339182198, -0.0035057140048593283, -0.017518486827611923, -0.016321904957294464, 0.01808316633105278, 0.011811197735369205, -0.038989726454019547, -0.01731681637465954, -0.023971958085894585, -0.0005735018639825284, -0.0014251417014747858, 0.01622779294848442, 0.02957841195166111, -0.05044463649392128, -0.00455104187130928, -0.01704792119562626, 0.008947469294071198, -0.0013335493858903646, -0.02285604551434517, 0.01107846014201641, 0.01743781752884388, -0.02877172827720642, 0.01312878169119358, -0.016483241692185402, -0.005539230071008205, 0.005986267235130072, -0.007280322723090649, 0.0002565002941992134, 0.011670027859508991, -0.049288392066955566, 0.03025064803659916, -0.027561701834201813, 0.013222894631326199, -0.010150773450732231, 0.022546816617250443, 0.015071545727550983, 0.01700758747756481, -0.004530875012278557, -0.019696533679962158, 0.024993758648633957, -0.019642755389213562, -0.030196869745850563, -0.0010276817483827472, -0.007710554171353579, 0.022425813600420952, -0.00528714107349515, -0.023998847231268883, 0.015609335154294968, -0.022103140130639076, 0.02772303856909275, -0.02299049310386181, 0.0074080475606024265, 0.02679535187780857, 0.024644196033477783, -0.008066839538514614, 0.03224046900868416, -0.006540862377732992, -0.030842216685414314, 0.016402574256062508, -0.025975223630666733, 0.0058551812544465065, 0.005492173135280609, 0.02612311579287052, 0.02627100795507431, -0.0037947758100926876, 0.02101411670446396, 0.0006230793078429997, -0.020946893841028214, 0.02968597039580345, 0.00489052152261138, -0.0007297968841157854, -0.015474887564778328, 0.0056568714790046215, 0.03837126865983009, 2.8307464162935503e-05, 0.009377701207995415, -0.01651013270020485, -0.009088639169931412, -0.0012864929158240557, -0.009028137661516666, 0.023219052702188492, -0.01532699540257454, 0.017478153109550476, -0.011307020671665668, 0.018056275323033333, 0.0011747335083782673, 0.008537405170500278, -0.0006281210808083415, -0.020126765593886375, 0.005233362317085266, -0.006352636031806469, -0.014116968959569931, -0.04528186097741127, 0.005438394378870726, -0.019320080056786537, 0.008557572029531002, 0.0024973591789603233, 0.0012066647177562118, -0.042082011699676514, -0.005129165481775999, -0.024980314075946808, 0.005085470154881477, -0.006840007845312357, 0.008597906678915024, 0.001453711767680943, -0.014116968959569931, 0.02730625309050083, -0.043507155030965805, -0.0016528618289157748, 0.030143091455101967, -0.021713243797421455, 0.013928743079304695, 0.012779218144714832, 0.03129933774471283, 0.017074810341000557, 0.0036300779320299625, -0.029632190242409706, 0.028556613251566887, 0.007313934620469809, 0.0012369153555482626, 0.016483241692185402, -0.013155670836567879, -0.006396331824362278, 0.001273048110306263, -0.02022087760269642, 0.009599539451301098, 0.035036973655223846, -0.03390761464834213, -0.0002035616635112092, 0.028422165662050247, -0.0007751728990115225, 0.009942379780113697, 0.039930857717990875, -0.016926918178796768, -0.041920676827430725, -0.027292806655168533, 0.01860751025378704, 0.004228368401527405, -0.00845673680305481, 0.013505234383046627, 0.01952175237238407, -0.00844329223036766, -0.014654758386313915, -0.005845097359269857, 0.025679439306259155, 0.022224143147468567, -0.010937290266156197, 0.013189283199608326, 0.0005835854099132121, -0.016442907974123955, -0.03178334981203079, 0.01524632703512907, 0.02809949219226837, 0.017773937433958054, -0.03277825936675072, -0.0014755594311282039, 0.0264189001172781, 0.012584269978106022, -0.028449054807424545, 0.0055526746436953545, 0.018983962014317513, -0.004386343993246555, 0.021041005849838257, 0.028717949986457825, 0.01887640543282032, 0.011098627001047134, 0.03893594443798065, -0.02124267816543579, -0.030573321506381035, 0.013438010588288307, 0.029363296926021576, 0.003312445944175124, -0.025276098400354385, 0.010614616796374321, 0.004554403014481068, 0.019037742167711258, -0.014937098138034344, -0.026970133185386658, 0.018688177689909935, 0.016684914007782936, -0.007945837453007698, -0.004369538277387619, 0.00141253718174994, 0.0067526171915233135, -0.0025696244556456804, -0.012248151935636997, -0.005777874030172825, 0.018405839800834656, -0.026862576603889465, -0.016147123649716377, -0.008080284111201763, -0.03089599497616291, 0.038102373480796814, -0.04382982850074768, -0.013148948550224304, 0.011905310675501823, -0.038344379514455795, 0.002571305027231574, 0.00956592708826065, 0.02194180339574814, -0.005394699051976204, -0.022761931642889977, -0.014076635241508484, 0.004534236155450344, 0.010742341168224812, 0.009942379780113697, -0.009740709327161312, -0.005922404583543539, -0.01875540241599083, -0.006369442213326693, -0.035198308527469635, -0.01228176336735487, -0.016416018828749657, -0.03197157382965088, 0.041678670793771744, 0.012711994349956512, -0.039688851684331894, -0.018419284373521805, -0.0038250265643000603, -0.0015352204209193587, -0.01929319091141224, -0.015757227316498756, -0.014681648463010788, 0.01076250895857811, 0.006581196561455727, 0.008201287128031254, 0.013888409361243248, 0.02483242191374302, 0.014654758386313915, -0.004793047439306974, -0.017451263964176178, 0.004917411133646965, -0.02679535187780857, 0.039393067359924316, 0.02612311579287052, 0.00597618380561471, -0.01730337180197239, 0.04065687209367752, 0.007959282025694847, -0.033477384597063065, -0.00017793264123611152, -0.007354268804192543, -0.011360798962414265, 0.02879861742258072, -0.017397483810782433, 0.017787382006645203, -0.023017382249236107, 0.020301546901464462, -0.008423125371336937, 0.012537213042378426, -0.004614904522895813, 0.03893594443798065, 0.017101699486374855, 0.021471237763762474, 0.005673677194863558, -0.022345146164298058, -0.012342264875769615, 0.01181792002171278, -0.009552482515573502, -0.010433112271130085, 0.024361856281757355, 0.03420339897274971, 0.03667723014950752, 0.004641794133931398, 0.011374243535101414, 0.019830981269478798, 0.004181311931461096, -0.0025343322195112705, 0.023461058735847473, 0.010170940309762955, -0.00356621528044343, -0.00045670077088288963, 0.008140785619616508, -0.00752905011177063, 0.017343705520033836, 0.019346971064805984, -0.05165466293692589, 0.07066551595926285, -0.028959954157471657, -0.00077979447087273, 0.010217997245490551, -0.01042638998478651, -0.01966964453458786, 0.007354268804192543, -0.02601555734872818, 0.01716892421245575, -0.032159801572561264, 0.019333526492118835, 0.009465091861784458, -0.020933449268341064, 0.018325170502066612, -0.0224527046084404, -0.018446173518896103, 0.003700662637129426, 0.0030200229957699776, 0.0204628836363554, 0.004477095790207386, -0.026781907305121422, 0.03933928906917572, 0.034902527928352356, -0.010876788757741451, 0.018271392211318016, 0.002004945883527398, -0.019441083073616028, -0.0076500531286001205, -0.017249591648578644, -0.04189378768205643, -0.021847691386938095, -0.01859406568109989, 0.04111399129033089, -0.0072668781504035, -0.024523193016648293, -0.004571209196001291, 0.001445308793336153, 0.008685297332704067, 0.031245559453964233, 0.0004296012339182198, 0.010883511044085026, 0.033208489418029785, 0.016133679077029228, -0.016321904957294464, 0.005266974214464426, -0.04547008499503136, 0.013666571117937565, -0.00883991178125143, 0.013706904835999012, 0.009612984023988247, 0.02481897734105587, 0.013182560913264751, -0.024066071957349777, 0.012685105204582214, 0.03474118933081627, 0.005145971663296223, -0.005878709256649017, -0.06060885637998581, -0.014063190668821335, -0.013720349408686161, 0.019078075885772705, 0.006876980885863304, -0.0135388458147645, -0.012254874221980572, 0.02444252371788025]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"∥2
(1−ϵ)dist2(Fi
t, Fi
⋆) +X
j̸=iη2(2 +ϵ)
(1−ϵ)2∥CT
iCj∥2dist2(Fj
t, Fj
⋆)
+X
j̸=iη2(2 +ϵ)∥CT
iCj∥2
(1−ϵ)2dist2(Fi
t, Fi
⋆)
= ((1−η)2+2ϵη(1−η)
1−ϵ+η2(2ϵ+ϵ2)
(1−ϵ)2+η2δi
2r2(2 +ϵ)2
(1−ϵ)2+2η(1−η)δi
2r(2 +ϵ)
(1−ϵ)+2η2δi
2r(2 +ϵ)
(1−ϵ)2
+η(2 +ϵ)(1−η)P
j̸=i∥CT
iCj∥2
(1−ϵ)+η2(2 +ϵ)P
j̸=i∥CT
iCj∥2
(1−ϵ)2)dist2(Fi
t, Fi
⋆)
19
Riemannian Preconditioned LoRA
+X
j̸=i((P−1)η2∥CT
iCj∥2(2 +ϵ)2
(1−ϵ)2+η(2 +ϵ)(1−η)∥CT
iCj∥2
(1−ϵ)+η2(2 +ϵ)∥CT
iCj∥2
(1−ϵ)2)dist2(Fj
t, Fj
⋆)
+X
j̸=i8η2(1 +ϵ
2)2δi
2r
(1−ϵ)2∥CT
iCj∥2dist(Fi
t, Fi
⋆)dist(Fj
t, Fj
⋆)
Letσijdenote ∥CT
iCj∥2,
≤((1−0.6η)2+7
3X
j̸=iσijη+7
27X
j̸=iσijη2)dist2(Fi
t, Fi
⋆) +X
j̸=i(7
3σijη+ (7
27σij+49
9(P−1)σ2
ij)η2)dist2(Fj
t, Fj
⋆)
+X
j̸=i0.3σijη2dist(Fi
t, Fi
⋆)dist(Fj
t, Fj
⋆)
Letσ= max( σij)over all j,when σ, η≤1,
≤((1−0.6η)2+ 3(P−1)ση)dist2(Fi
t, Fi
⋆) +X
j̸=i(3σ+ 6(P−1)σ2)ηdist2(Fj
t, Fj
⋆)
+X
j̸=i0.3σηdist(Fi
t, Fi
⋆)dist(Fj
t, Fj
⋆)
WLOG assume dist2(Fk
t, Fk
⋆)≥dist2(Fj
t, Fj
⋆)for any j̸=k.Then when σ≤min(1 ,0.12
7P(P+1)),
((1−0.6η)2+ 3(P−1)ση)dist2(Fk
t, Fk
⋆) +X
j̸=i(3σ+ 6(P−1)σ2)ηdist2(Fk
t, Fk
⋆) +X
j̸=i0.3σηdist2(Fk
t, Fk
⋆)
≤(1−0.5η)2dist2(Fk
t, Fk
⋆).
Therefore,
max
i(dist2(Fi
t+1, Fi
⋆))≤(1−0.5","[-0.011257421225309372, -0.03856222331523895, 0.016357282176613808, 0.017704669386148453, -0.0260180477052927, 0.0003899002040270716, -0.004557537380605936, -0.030208423733711243, -0.01599348708987236, 0.042658280581235886, 0.00028779348940588534, 0.0019031845731660724, -0.05939283221960068, 0.016047382727265358, 0.03266066685318947, 0.00033305727993138134, 0.01732739992439747, -0.0281873419880867, -0.0465657040476799, 0.04443683102726936, 0.0017667615320533514, -0.039963506162166595, 0.05502729490399361, -0.020844081416726112, 0.004106162581592798, -0.010543305426836014, 0.06230318918824196, -0.004843857139348984, 0.0532756932079792, -0.011998483911156654, 0.02080366015434265, -0.0288071408867836, 0.020965347066521645, -0.09318530559539795, 7.894847658462822e-05, 0.07389071583747864, -0.00797653291374445, 0.053787700831890106, -0.00916897039860487, 0.03018147498369217, 0.028160395100712776, 0.00982919055968523, -0.09474827349185944, -0.04104141518473625, -0.0070603094063699245, -0.023660121485590935, 0.01953711546957493, 0.010139089077711105, 0.01961795799434185, 0.036298613995313644, -0.020385969430208206, 0.03538239002227783, 0.004988701548427343, -0.006396721117198467, -0.022824740037322044, 0.01983354054391384, 0.013352608308196068, 0.03481648862361908, 0.06542912870645523, -0.01561621855944395, 0.043763138353824615, 0.0037221573293209076, 0.06305772811174393, -0.039478447288274765, -0.04494883865118027, -0.004304902162402868, -0.017286978662014008, 0.010678044520318508, 0.047697510570287704, 0.0057129221968352795, -0.058207131922245026, 0.0006880096043460071, 0.06542912870645523, 0.0014669678639620543, -0.012139959260821342, -0.011782901361584663, 0.018486153334379196, 0.00865696370601654, 0.0771244466304779, -0.01639770343899727, 0.041283946484327316, 0.015562322922050953, 0.07141152769327164, 7.900110358605161e-05, 0.03697230666875839, -0.0895204097032547, -0.054191917181015015, 0.010064982809126377, -0.0723816454410553, 0.000506533426232636, -0.004587853793054819, -0.012449858710169792, 0.011082260869443417, 0.014430518262088299, 0.04505662992596626, -0.013446925207972527, 0.04484104737639427, -0.01657286286354065, -0.023363696411252022, -0.005780291277915239, 0.03530154749751091, -0.022204943001270294, 0.05300621688365936, -0.012072590179741383, 0.01451136078685522, 0.039128128439188004, -0.034358374774456024, -0.008852334693074226, -0.04626927897334099, 0.005069544538855553, 0.009822453372180462, 0.015481479465961456, 0.0033634155988693237, 0.020251231268048286, 0.02301337569952011, -0.055997416377067566, -0.06833948194980621, -0.004277954809367657, -0.03244508430361748, -0.004850594326853752, -0.006939044687896967, -0.008865808136761189, -0.0033954158425331116, -0.009377815760672092, -0.006100296042859554, -0.04198458790779114, 0.024226022884249687, -0.04923352971673012, -0.0428469143807888, -0.06311161816120148, 0.04934132099151611, 0.008946651592850685, 0.026260579004883766, 0.020871028304100037, 0.011371948756277561, 0.020210810005664825, 0.039694029837846756, 0.05486560985445976, 0.027863968163728714, -0.05297926813364029, 0.0003484259359538555, -0.012166907079517841, -0.01723308302462101, 0.022636106237769127, 0.021773777902126312, 0.04449072852730751, -0.05262894555926323, -0.004042161628603935, -0.0064068264327943325, -0.01364903338253498, -0.013918510638177395, -0.0038939493242651224, -0.019254164770245552, 0.01754298247396946, -0.021234823390841484, -0.005807239096611738, 0.010320986621081829, 0.026705216616392136, 0.02677258476614952, 0.02320200949907303, -0.04882931336760521, 0.056051310151815414, -0.011634688824415207, -0.0038400536868721247, 0.03511291369795799, 0.011648163199424744, -0.00629566702991724, 0.012705862522125244, -0.07232774794101715, -0.017165714874863625, 0.026880376040935516, -0.01554884947836399, -0.034978173673152924, -0.016896236687898636, 0.04381703585386276, 0.001201701001264155, 0.0058981878682971, -0.0373765230178833, 0.031178541481494904, 0.007477999199181795, 0.02791786380112171, 0.060416847467422485, 0.004857331048697233, 0.035678815096616745, -0.02380833402276039, 0.04621538519859314, 0.005015649367123842, 0.011439317837357521, 0.02717680111527443, 0.019429324194788933, -0.015009894035756588, -0.00763294892385602, 0.05518898367881775, 0.014592204242944717, 0.0004766382626257837, -0.04502968490123749, 0.03228339925408363, 0.015319793485105038, -0.0014358095359057188, 0.0392359159886837, 0.03233729302883148, 0.04810172691941261, 0.011830060742795467, 0.010112141259014606, -0.020709343254566193, -0.031744442880153656, -0.00013231764023657888, 0.002177714603021741, -0.03344215080142021, -0.019564064219594002, -0.0071883113123476505, -0.0030349898152053356, 0.014012827537953854, 0.010873415507376194, 0.004658591467887163, 0.044032614678144455, -0.029184408485889435, 0.03390026465058327, -0.03681062161922455, 0.040583305060863495, -0.024764977395534515, 0.0466734953224659, 0.006568512879312038, 0.0017061291728168726, -0.021396510303020477, 0.052682843059301376, 0.05615910142660141, -0.015845274552702904, 0.0266378466039896, -0.05179356783628464, 0.0409875214099884, -0.00020052911713719368, -0.038104113191366196, -0.021800726652145386, 0.0324181392788887, -0.02159861847758293, -0.07308228313922882, -0.019644906744360924, -0.0226630549877882, -0.024185601621866226, 0.006696514785289764, 0.012402700260281563, -0.004257743712514639, -0.028618505224585533, 0.009721399284899235, -0.030208423733711243, -0.014241883531212807, 0.02999284118413925, -0.01979311928153038, -0.0028817246202379465, -0.006531459745019674, 0.015400636941194534, 0.01872868277132511, -0.013426714576780796, -0.05483866110444069, 0.01175595447421074, -0.005834186915308237, 0.01723308302462101, 0.00038653172669000924, 0.030208423733711243, -0.024670660495758057, -0.004550800658762455, -0.019079003483057022, -0.03462785482406616, 0.011547109112143517, -0.023794859647750854, 0.000813906139228493, 0.05249420925974846, 0.0260719433426857, 0.005409759934991598, 0.013534504920244217, 0.03662198781967163, 0.0008867492433637381, 0.006521354429423809, -0.031394124031066895, -0.011830060742795467, 0.012665440328419209, 0.04726634547114372, -0.037053149193525314, -0.027203749865293503, -0.022164521738886833, 0.007504947017878294, 0.02465718798339367, -0.011985009536147118, 0.04516442120075226, -0.042038481682538986, -0.03411584720015526, -0.017879828810691833, -0.012369015254080296, -0.029238304123282433, 0.024091284722089767, -0.035463232547044754, 0.02306726947426796, 0.022919056937098503, 0.006383247207850218, 0.0038838437758386135, -0.017354348674416542, -0.06036294996738434, 0.011095734313130379, 0.01816278137266636, 0.034897331148386, -0.006696514785289764, -0.012180381454527378, 0.032849300652742386, -0.04166121408343315, 0.0010088562266901135, 0.020668920129537582, -0.009182444773614407, -0.003772684372961521, -0.0032707825303077698, -0.0006951676332391798, 0.03220255672931671, -0.03247203305363655, 0.005463655572384596, -0.03274150937795639, -0.025128772482275963, 0.024023914709687233, 0.010792572051286697, 0.0272576455026865, -0.019415851682424545, 0.022770844399929047, -0.0454338975250721, 0.020439865067601204, -0.030612638220191002, -0.0038097375072538853, -0.01210627518594265, -0.045838113874197006, 0.01891731657087803, -0.0021086609922349453, -0.021989360451698303, -0.012867548502981663, 0.019591011106967926, 0.009135285392403603, -0.014484412968158722, -0.017246557399630547, 0.001239596283994615, -0.025573410093784332, 0.03193308040499687, 0.0037423681933432817, 0.0025381408631801605, -0.05562014877796173, -0.024845821782946587, -0.01622254215180874, 0.044382937252521515, 0.01405324973165989, -0.03565186634659767, 0.043628402054309845, -0.020695868879556656, 0.07151931524276733, 0.0386161208152771, -0.03565186634659767, -0.005531024653464556, -0.01488862931728363, 0.008266220800578594, -0.033253517001867294, -0.018540048971772194, 0.04379008710384369, -0.05376075208187103, -0.05411107465624809, 0.002378138480708003, -0.047347187995910645, -0.002984462771564722, 0.03101685456931591, 0.0006496933056041598, -0.01930806040763855, 0.01940237730741501, -0.005659026559442282, 0.02275737188756466, 0.0007911689463071525, 0.0039175283163785934, 0.0030770956072956324, 0.04758971929550171, -0.03524764999747276, 0.014524835161864758, -0.057021431624889374, -0.040852781385183334, 0.0275675430893898, 0.03462785482406616, 0.05206304416060448, -0.015090737491846085, -0.018715210258960724, -0.02810649946331978, -0.00019168689323123544, 0.015050316229462624, -0.019591011106967926, 0.03718788921833038, -0.027405858039855957, -0.02080366015434265, -0.010644359514117241, -0.003210150171071291, 0.023525381460785866, -0.011601004749536514, 0.017219608649611473, 0.040098246186971664, -0.019065530970692635, -0.03977487236261368, 0.022124098613858223, 0.07707054913043976, 0.005706185009330511, 0.02549256756901741, -0.02301337569952011, -0.04540695250034332, -0.053572118282318115, 0.0035672078374773264, -0.04664654657244682, 0.003290993394330144, 0.03476259112358093, 0.05505424365401268, 0.012382488697767258, 0.019025107845664024, -0.009371078573167324, -0.003944476135075092, 0.028645453974604607, -0.017906777560710907, -0.0012673861347138882, -0.002334348391741514, -0.0072017852216959, 0.03716094046831131, 0.010960995219647884, 0.021288719028234482, 0.009276761673390865, 0.048398151993751526, -0.034358374774456024, -0.023363696411252022, -0.03662198781967163, 0.0205476563423872, 0.026839954778552055, -0.006113769952207804, 0.03088211640715599, -0.06305772811174393, 0.005473760887980461, 0.03829274699091911, 0.03495122492313385, 0.026301000267267227, -0.03681062161922455, -0.016559390351176262, 0.045945905148983, -0.023956546559929848, -0.001845920574851334, -0.04379008710384369, -0.027810074388980865, -0.021261772140860558, -0.016734549775719643, 0.012914706952869892, 0.0004560063825920224, 0.03988266363739967, 0.028483767062425613, -0.018270570784807205, -0.01921374350786209, 0.057991549372673035, -0.04063719883561134, -0.010475936345756054, 0.07141152769327164, -0.004513747524470091, 0.012941654771566391, -0.0423349067568779, 0.039478447288274765, 0.012045642361044884, 0.03573271259665489, 0.02603152208030224, 0.041418686509132385, -0.03460090607404709, 0.009512553922832012, -0.006009347271174192, 0.011836796998977661, 0.010509620420634747, 0.011782901361584663, 0.00436216639354825, -0.010570253245532513, -0.002007607137784362, -0.0016261279815807939, -0.0747530460357666, 0.033334363251924515, -0.008515487425029278, -0.028968825936317444, 0.028079550713300705, 0.009627082385122776, -0.05006891116499901, -0.004695644602179527, 0.006069979630410671, 0.035624921321868896, -0.04826341196894646, -0.0030956221744418144, 0.02010301873087883, 0.0330379344522953, 0.09005936980247498, 0.05906945839524269, -0.003489732975140214, 0.0091891810297966, -0.019981753081083298, 0.011931114830076694, 0.010698255151510239, 0.045838113874197006, -0.015872221440076828, -0.01327850203961134, -0.03220255672931671, -0.03549018129706383, 0.013851141557097435, -0.024630239233374596, -0.019644906744360924, 0.0685550644993782, 0.026098892092704773, 0.04144563153386116, 0.03446616604924202, -0.026260579004883766, 0.023080743849277496, 0.0021120295859873295, -0.06532133370637894, -0.02112703211605549, 0.025034455582499504, 0.025196142494678497, 0.04476020485162735, 0.022730423137545586, 0.0024084546603262424, -0.0002903198474086821, -0.0005419023218564689, -0.029319146648049355, 0.006305772345513105, -0.02403738908469677, -0.003127622650936246, 0.027944812551140785, -0.016855815425515175, -0.02425297163426876, -0.01025361754000187, 0.0033617313019931316, -0.01230838242918253, -0.0331457257270813, -0.0833224281668663, -0.01969880238175392, -0.038508329540491104, 0.03357689082622528, 0.001141068642027676, -0.03244508430361748, 0.05235946923494339, 0.0038568961899727583, 0.003509943839162588, -0.002305716508999467, -0.022568736225366592, 0.015144633129239082, 0.0067268311977386475, 0.013177447952330112, -0.0021928728092461824, -0.026341421529650688, 0.00984940119087696, 0.019375428557395935, -0.02349843457341194, 0.017179187387228012, 0.004301534034311771, -0.0006677987985312939, 0.025694675743579865, 0.0022737160325050354, -0.010590463876724243, -0.014134092256426811, 0.002521298360079527, -0.01661328598856926, 0.012726073153316975, 0.023309800773859024, -0.004234164487570524, -0.006716725416481495, 0.020224282518029213, -0.009424974210560322, 0.016195595264434814, 0.006511249113827944, -0.01106878649443388, -0.040179088711738586, 0.06693819910287857, -0.004823646508157253, -0.017825933173298836, 0.02999284118413925, 0.02840292453765869, -0.04705076292157173, -0.0017532877391204238, -0.007242206484079361, 0.019564064219594002, 0.012476806528866291, -0.01647854596376419, 0.028834087774157524, 0.003735631238669157, -0.004557537380605936, -0.023579277098178864, -0.036514196544885635, 0.0036514196544885635, -0.002216452034190297, -0.0029069881420582533, -0.038508329540491104, -0.0030366741120815277, -0.016074329614639282, -0.019496694207191467, -0.009485606104135513, 0.019065530970692635, 0.04176900535821915, -0.0038265797775238752, 0.013217869214713573, 0.009438447654247284, 0.004153321497142315, 0.01265870314091444, -0.029238304123282433, 0.05421886593103409, 0.007835056632757187, -0.019779644906520844, 0.019873961806297302, -0.007040098775178194, 0.015333266928792, -0.023471485823392868, -0.03379247337579727, -0.01909247785806656, 0.0013558084610849619, -0.008576120249927044, 0.024104759097099304, 0.0028261449187994003, -0.013258290477097034, -0.004463220480829477, 0.014066723175346851, 0.012032167986035347, -0.0029591992497444153, -0.01872868277132511, 0.012065852992236614, -0.02611236646771431, 0.06160254776477814, -0.0054501816630363464, -0.04050246253609657, -0.032013922929763794, 0.028753245249390602, 0.029103565961122513, 0.01519852876663208, 0.03702620416879654, 0.01186374481767416, -0.02739238366484642, 0.01758340373635292, -0.0029878313653171062, -0.01732739992439747, -0.01701750047504902, 0.004877542145550251, -0.006881780456751585, -0.05359906703233719, 0.015077264048159122, 0.0012774915667250752, 0.038373589515686035, -0.021935464814305305, -0.05187441036105156, 0.031259384006261826, 0.023983493447303772, -0.009128549136221409, -0.06763884425163269, 0.048182569444179535, 0.03592134639620781, 0.0027335118502378464, 0.04317028820514679, -0.039613187313079834, -0.02859155833721161, -0.014390096068382263, -0.023296326398849487, 0.011978273279964924, -0.0008198009454645216, 0.039262864738702774, -0.014107144437730312, 0.003971423953771591, 0.008219062350690365, -0.015912644565105438, -0.019739223644137383, -0.008616541512310505, 0.021180927753448486, -0.0033229938708245754, 0.016047382727265358, 0.021895043551921844, -0.0027739335782825947, 0.038858648389577866, 0.029319146648049355, 0.011702058836817741, 0.009128549136221409, 0.06510575115680695, 0.04211932793259621, -0.01802804134786129, 0.02964252047240734, 0.01812235824763775, -0.0189981609582901, -0.02624710462987423, -0.020076069980859756, -0.04287386313080788, -0.004786593373864889, -0.025303933769464493, 0.02058807760477066, -0.019685328006744385, -0.0014349675038829446, -0.02473803050816059, -0.02438770979642868, -0.00036968939821235836, 0.0038501592352986336, -0.024845821782946587, -0.017650773748755455, -0.0018779210513457656, 0.023579277098178864, 0.06963297724723816, -0.04422125220298767, 0.03646029904484749, 0.015171580947935581, -0.01616864651441574, 0.0008400117512792349, 0.010388355702161789, 0.012665440328419209, -0.0012741230893880129, 0.014592204242944717, -0.030909065157175064, -0.022919056937098503, -0.04640401899814606, -0.032768458127975464, 0.002913725096732378, 0.017448665574193, 0.07523810863494873, -0.025250038132071495, 0.01810888573527336, 0.007080520037561655, -0.017448665574193, -0.01983354054391384, -0.003995003178715706, 0.00905444286763668, 0.04152647778391838, 0.03769989684224129, -0.01491557713598013, 0.0014408623101189733, 0.006521354429423809, -0.0027368804439902306, -0.03282235562801361, -0.004621538333594799, 0.0011478055967018008, -0.016155174002051353, -0.043331973254680634, 0.011857008561491966, 0.014120618812739849, -0.0017970778280869126, 0.03247203305363655, 0.000813906139228493, -0.0017347611719742417, 0.031124645844101906, -0.0005044281133450568, 0.0063024042174220085, -0.007639686111360788, 0.014484412968158722, -0.04454462230205536, 0.01364903338253498, 0.013265027664601803, -0.06289603561162949, -0.032013922929763794, 0.01488862931728363, 0.03718788921833038, 0.010644359514117241, 0.021086610853672028, 0.03648724779486656, 0.009714662097394466, 0.02178725227713585, -0.011473002843558788, 0.01139889657497406, -0.013837667182087898, -0.0018307624850422144, 0.019496694207191467, -0.00180886744055897, -0.00662577711045742, -0.015912644565105438, -0.0044362726621329784, -0.017448665574193, 0.009182444773614407, 0.00916897039860487, 0.00011810691648861393, -0.025263512507081032, 0.012800179421901703, 0.01338629238307476, -0.05020365118980408, 0.0038939493242651224, 0.014659573324024677, -0.030828220769762993, -0.01139889657497406, 0.0023191904183477163, 0.023525381460785866, 0.0020109754987061024, 0.03527459874749184, 0.006918833591043949, -0.043008603155612946, -0.03640640527009964, -0.019900910556316376, -0.011405633762478828, -0.011149629950523376, -0.011142892763018608, 0.024778451770544052, 0.01245659589767456, -0.03142107278108597, -0.0036143662873655558, 0.023983493447303772, 0.005642184056341648, 0.022649580612778664, -0.010832993313670158, 0.011041838675737381, -0.012247750535607338, -0.01416104007512331, -0.0018947633216157556, 4.915858153253794e-05, 0.02907661721110344, -0.04303554818034172, -0.0846698135137558, 0.009970665909349918, 0.02708248421549797, 0.013265027664601803, -0.008252747356891632, 0.009903296828269958, 0.014363148249685764, 0.010435514152050018, 0.02223188988864422, -0.002586983609944582, -0.016155174002051353, -0.007538632024079561, -0.005874608643352985, 0.021490827202796936, -0.005955451633781195, -2.390822919551283e-05, -0.014578730799257755, 0.018661314621567726, 0.015494953840970993, 0.0022855056449770927, 0.00021452932560350746, -0.012719335965812206, 0.042523544281721115, 0.050284493714571, -0.051497142761945724, -0.016559390351176262, 0.0033667839597910643, -0.052736736834049225, 0.0029591992497444153, 0.015629692003130913, 0.014430518262088299, -0.003183202352374792, 0.06828558444976807, 0.024185601621866226, 0.014902103692293167, 0.0007983269752003253, -0.011931114830076694, 0.03769989684224129, 0.013534504920244217, 0.02531740628182888, -0.006423668935894966, -0.04446377977728844, 0.01669412851333618, 0.026408791542053223, 0.02382180653512478, -0.0168288666754961, 0.028214288875460625, -0.04661960154771805, 0.031528864055871964, -0.005851029418408871, 0.01965838111937046, -0.0017886565765365958, 0.00020337126625236124, -0.013790508732199669, -0.0069323075003921986, 0.013130289502441883, -0.017879828810691833, 0.032229505479335785, 9.989613317884505e-05, 0.013891562819480896, -0.03627166524529457, -0.00495838513597846, 0.03462785482406616, -0.022878635674715042, -0.024010442197322845, -0.012779968790709972, -0.03584050014615059, 0.01647854596376419, -0.012234276160597801, -0.028834087774157524, 0.023714017122983932, -0.026395317167043686, -0.0272576455026865, 0.01626296527683735, -0.006373141892254353, 0.006844727322459221, -0.01670760288834572, -0.01451136078685522, -0.03349604830145836, 0.007296102121472359, 0.034088898450136185, 0.01785288192331791, 0.013244817033410072, 0.025640780106186867, 0.0028800403233617544, -0.01657286286354065, 0.0102468803524971, -0.016761498525738716, 0.024805400520563126, 0.0006597987376153469, 0.01075888704508543, 0.023431064561009407, 0.030450953170657158, 0.002287189941853285, 0.013069656677544117, 0.0005322179640643299, -0.00689188577234745, 0.005029122810810804, -0.005921767093241215, 0.015063789673149586, 0.019712276756763458, 0.0034476271830499172, 0.03266066685318947, 0.00036484721931628883, -0.037053149193525314, 0.01859394460916519, 0.034708697348833084, -0.011142892763018608, 0.02465718798339367, -0.02950778231024742, 0.00723546976223588, -0.010058245621621609, -0.023269377648830414, 0.00916897039860487, 0.02155819721519947, -0.01705792360007763, -0.024374235421419144, -0.01572400890290737, 0.003228676738217473, -0.006753778550773859, 0.0017297083977609873, 0.024495501071214676, 0.0319061316549778, 0.021005768328905106, -0.006918833591043949, 0.010873415507376194, -0.013729876838624477, 0.041283946484327316, 0.007013150956481695, 0.026799533516168594, 0.007740739732980728, 0.013460398651659489, 0.016451599076390266, 0.016909711062908173, 0.04174205660820007, 0.0317983403801918, 0.051497142761945724, -0.014039775356650352, 0.0251422468572855, 0.007417366839945316, -0.002667826833203435, -0.010745413601398468, 0.01806846261024475, 0.021059663966298103, -0.006090190727263689, 0.01798762008547783, -0.027729230001568794, -0.02859155833721161, -0.015131158754229546, 0.04123005270957947, 0.024145180359482765, -0.02337716892361641, 0.012092800810933113, -0.004715855699032545, -0.025479093194007874, 0.002986147068440914, -0.010698255151510239, 0.0010955942561849952, 0.008993810042738914, 0.0386161208152771, 0.048667628318071365, 0.051092926412820816, -0.016020433977246284, 0.000434532412327826, 0.03212171420454979, 0.00041411106940358877, -0.03530154749751091, -0.03619082272052765, 0.0324181392788887, -0.00804390199482441, -0.015104211866855621, -0.06602197885513306, -0.015670113265514374, 0.0440865121781826, -0.005760080646723509, 0.02805260382592678, -0.004136478994041681, -0.02186809480190277, -0.01292144414037466, 0.015171580947935581, 0.01634380780160427, 0.0037928952369838953, -0.009249813854694366, 0.009788768365979195, 0.02770228311419487, -0.012382488697767258, 0.025573410093784332, -0.005780291277915239, 0.0257620457559824, 0.03287624940276146, 0.05085039511322975, 0.023121165111660957, 0.015872221440076828, 0.007370208390057087, 0.028887983411550522, 0.012806915678083897, -0.003437521867454052, 0.031178541481494904, 0.004736066330224276, -0.012267961166799068, 0.004325113259255886, 0.0521438866853714, 0.013702929019927979, -0.051012083888053894, -0.010199721902608871, 0.019806593656539917, 0.008879282511770725, -0.018284045159816742, 0.014430518262088299, -0.031744442880153656, 0.005187441129237413, 0.02483234740793705, 0.007801372557878494, -0.0025179299991577864, 0.052602000534534454, 0.00037516315933316946, 0.014740416780114174, 0.020345548167824745, 0.013049446046352386, 0.011183314025402069, 0.005298600532114506, -0.01608780398964882, 0.005389549303799868, 0.03681062161922455, -0.004870804958045483, -0.0007183258421719074, -0.013056183233857155, -0.009229603223502636, -0.016114752739667892, 0.011493213474750519, -0.02231273427605629, 0.04144563153386116, -0.047913093119859695, -0.013878089375793934, -0.0049280691891908646, 0.008387485519051552, 0.004045530222356319, -0.004638380836695433, 0.01886342279613018, -0.011580794118344784, 0.037268731743097305, -0.0011857007630169392, 0.015535375103354454, 0.02735196240246296, -0.00870412215590477, -0.002125503495335579, 0.025546463206410408, 0.048532888293266296, -0.0235927514731884, -0.0006130611873231828, -0.015427584759891033, 0.03279540687799454, -0.0016985500697046518, 0.003173097036778927, -0.008798439055681229, 0.012793442234396935, -0.001546969055198133, 0.002016028156504035, 0.015750957652926445, -0.006403457839041948, 0.01065109670162201, 0.009782032109797001, 0.0032421506475657225, -0.012389225885272026, -0.010462461970746517, -0.03640640527009964, -0.010597201064229012, -0.0027924601454287767, -0.003718788968399167, -0.008912966586649418, -0.005049333907663822, -0.010118878446519375, -0.0025920362677425146, -0.0009558028541505337, 0.006986203137785196, 0.0031865709461271763, 0.04273912310600281, 0.010320986621081829, 0.01705792360007763, -0.024670660495758057, -0.041068363934755325, -0.03543628379702568, 0.004385745618492365, 0.004294796846807003, 0.014066723175346851, 0.00211539794690907, 0.0409875214099884, -0.013958931900560856, 0.039208970963954926, 0.041472580283880234, -0.004038793500512838, -0.024050863459706306, -0.001502336817793548, 0.0189981609582901, 0.027069009840488434, -0.023619698360562325, 0.001493073534220457, 0.022690001875162125, -0.020480286329984665, 0.0018964476184919477, 0.00982919055968523, 0.029750311747193336, 0.008070849813520908, -0.032984040677547455, 0.005045965313911438, 0.03619082272052765, 0.006393352523446083, 0.013123552314937115, -0.04123005270957947, -0.034223638474941254, 0.011129419319331646, -0.015602745115756989, 0.018391836434602737, 0.010260353796184063, 0.007006413768976927, 0.02638184279203415, -0.04166121408343315, 0.006036295089870691, 0.015468006022274494, 0.020574603229761124, -0.0009558028541505337, -2.0960820620530285e-05, 0.053976334631443024, -0.013271764852106571, -0.029453886672854424, 0.013110077939927578, -0.011823323555290699, 0.0020396076142787933, 0.0023916123900562525, 0.012800179421901703, -0.025815939530730247, 0.013958931900560856, 0.035894397646188736, -0.013163973577320576, -0.032768458127975464, 0.010112141259014606, -0.02252831496298313, -0.03115159459412098, -0.045622535049915314, -0.009323920123279095, 0.007895689457654953, 0.01055677980184555, -0.0024758242070674896, -0.029804207384586334, -0.03279540687799454, 0.0087243327870965, 0.005547867156565189, 0.013945458456873894, -0.031205490231513977, -0.0211135596036911, 0.08666394650936127, -0.014080197550356388, -0.02603152208030224, 0.035193756222724915, 0.02735196240246296, 0.028618505224585533, -0.00500554358586669, -0.0251422468572855, -0.018270570784807205, 0.014322726987302303, -0.050284493714571, 0.03454700857400894, -0.004672065377235413, -0.0001085278345271945, 0.013116815127432346, -0.011277631856501102, -0.012483542785048485, 0.010644359514117241, -0.0014324410585686564, 0.022743897512555122, 0.018620891496539116, -0.05381464958190918, -0.0006884306785650551, 0.010475936345756054, 0.014565256424248219, 0.0036244718357920647, 0.014996420592069626, 0.006999677047133446, -0.02448202669620514, 0.03328046575188637, 0.012315119616687298, 0.009755084291100502, -0.025088351219892502, -0.00236971746198833, 0.010846467688679695, 0.021895043551921844, -0.020439865067601204, 0.009883086197078228, 0.0005111650680191815, -0.009377815760672092, -0.03578660637140274, -0.020480286329984665, 7.626422302564606e-05, 0.013487346470355988, -0.013244817033410072, -0.006245139986276627, -0.028753245249390602, 0.000660640827845782, 6.400089478120208e-05, -0.011345000937581062, -0.015063789673149586, 0.015831800177693367, 0.018054990097880363, -0.04066414758563042, -0.01847267895936966, -0.003211834467947483, -0.001394545892253518, -0.006258613895624876, -0.0045710112899541855, 0.021369561553001404, -0.0507965013384819, -0.008609804324805737, -0.009734872728586197, 0.008198851719498634, -0.010832993313670158, -0.01612822525203228, -0.006595460698008537, 0.028214288875460625, -0.0428469143807888, 0.019119424745440483, -0.004237533081322908, -0.009526028297841549, -0.014807785861194134, -0.025869835168123245, 0.005463655572384596, 0.0009760136599652469, -0.04430209472775459, 0.03702620416879654, -0.03012757934629917, 0.0026577215176075697, -0.008434643968939781, 0.01829751953482628, -0.005874608643352985, 0.000858538318425417, 0.007262417580932379, 0.0030619376339018345, 0.015804853290319443, -0.020520707592368126, -0.010974469594657421, -0.004416062030941248, -0.01554884947836399, 0.032849300652742386, 0.0043082707561552525, -0.05130850896239281, -0.0017330768750980496, -0.015077264048159122, 0.025290459394454956, -0.02124829776585102, -0.008596330881118774, 0.027230696752667427, 0.006629145238548517, -0.0010568569414317608, 0.038104113191366196, 0.006299035623669624, -0.0220432560890913, 0.02399696782231331, -0.03012757934629917, 0.0009979087626561522, 0.017206136137247086, 0.011008153669536114, 0.01184353418648243, -0.015306319110095501, 0.03171749785542488, 0.01257112342864275, -0.019186794757843018, 0.022501368075609207, -0.010832993313670158, 0.021261772140860558, -0.004894384182989597, 0.009128549136221409, 0.04082583636045456, 0.021288719028234482, 0.008360537700355053, -0.007046835497021675, -0.0007899057818576694, 0.005581551697105169, -0.012719335965812206, 0.016990553587675095, -0.004874173551797867, 0.021450405940413475, -0.011499950662255287, 0.008219062350690365, 0.001708655501715839, 0.018230149522423744, 0.005382812116295099, -0.0016724445158615708, 0.007134415674954653, -0.020574603229761124, 0.001067804405465722, -0.04591896012425423, 0.022986426949501038, -0.018054990097880363, 0.002526351250708103, -0.002868250710889697, 0.015346741303801537, -0.01917332038283348, -0.00442953547462821, -0.029184408485889435, -0.005133545491844416, -0.0037693160120397806, -0.0034627853892743587, -0.0023292957339435816, -0.014107144437730312, 0.05041923373937607, -0.032094765454530716, -0.00323709798976779, 0.012746283784508705, -0.019766172394156456, 0.022191468626260757, -0.0016177068464457989, 0.03266066685318947, 0.008320116437971592, 0.002984462771564722, -0.013891562819480896, 0.03295709192752838, -0.012699125334620476, 0.0049617537297308445, 0.009438447654247284, -0.007053572218865156, -0.026044996455311775, 0.0019217111403122544, -0.02178725227713585, 0.0007296944386325777, 0.022420523688197136, -0.025829413905739784, -0.010563516058027744, 0.01622254215180874, -0.0018779210513457656, 0.009492343291640282, 0.043062496930360794, -0.03336130827665329, -0.03115159459412098, -0.001963817048817873, 0.016815394163131714, 0.003275835420936346, -0.001112436642870307, 0.003183202352374792, 0.016640232875943184, -0.008515487425029278, -0.004732697736471891, 0.0015200212365016341, 0.04117615520954132, 0.007417366839945316, -0.02076323889195919, -0.0029726731590926647, 0.016505494713783264, -0.02539825066924095, -0.021140506491065025, 0.017691195011138916, 0.005729764234274626, 0.035544075071811676, -0.024778451770544052, -0.002224873285740614, 0.011142892763018608, 0.022380102425813675, -0.029453886672854424, 0.0070939939469099045, 0.012672177515923977, 0.0004989543813280761, 0.02638184279203415, 0.024643713608384132, 0.008232536725699902, 0.020116491243243217, 0.04166121408343315, -0.01365577057003975, -0.0077811614610254765, 0.015454532578587532, 0.02134261466562748, 0.004752908833324909, -0.023700542747974396, 0.00440932484343648, 0.007376945577561855, 0.00010042246140073985, -0.02929219976067543, -0.0038265797775238752, 0.0199278574436903, 0.00255161477252841, -0.0006951676332391798, -0.01930806040763855, 0.01144605502486229, 0.003427416319027543, -0.001257280702702701, 0.0029187777545303106, -0.023983493447303772, 0.011526898480951786, -0.028079550713300705, -0.009317182935774326, -0.010570253245532513, -0.0441943034529686, 0.018324466422200203, -0.03263372182846069, -0.01810888573527336, 0.042927760630846024, -0.03813106194138527, 0.015414110384881496, 0.0031225699931383133, 0.03198697417974472, 0.008097797632217407, -0.03425058349967003, -0.010812782682478428, -0.021356089040637016, 0.01300902385264635, 0.021288719028234482, -0.006760515738278627, -0.00808432325720787, -0.003772684372961521, -0.009243076667189598, -0.024023914709687233, -0.02363317273557186, -0.01255091279745102, -0.0016766550252214074, 0.02638184279203415, 0.02306726947426796, -0.02566772699356079, 0.0022282416466623545, -0.025573410093784332, 0.010199721902608871, 0.00439585093408823, -0.007457788567990065, -0.02413170598447323, 0.0107386764138937, 0.020911451429128647, 0.021369561553001404, -0.006851464509963989, 0.01969880238175392, 0.010442251339554787, -0.0069659920409321785, -0.008421170525252819, 0.012820390053093433, -0.032498981803655624, 0.03813106194138527, 0.03732262924313545, 0.0069659920409321785, -0.007019887678325176, 0.026098892092704773, 0.0030063579324632883, -0.02619320899248123, 0.0003656893386505544, -0.002957515185698867, -0.004432904068380594, 0.01409367099404335, -0.012806915678083897, 0.017084870487451553, -0.011459528468549252, 0.003476259298622608, -0.014268831349909306, 0.013460398651659489, -0.028780192136764526, 0.032579824328422546, 0.02089797705411911, 0.018715210258960724, -0.004715855699032545, -0.027338488027453423, -0.00276719662360847, 0.021221349015831947, 0.005908293183892965, -0.005605130922049284, 0.026044996455311775, 0.027055537328124046, 0.03786158189177513, -0.006288930308073759, 0.005918398499488831, 0.004884278867393732, 0.010388355702161789, -0.005739870015531778, 0.016896236687898636, -0.013440188020467758, -0.0016859183087944984, 0.0007107467972673476, 0.017071396112442017, -0.014241883531212807, 0.013480610214173794, 0.009822453372180462, -0.037672948092222214, 0.047697510570287704, -0.02589678391814232, 0.001726339920423925, -0.00038042638334445655, 0.0028716190718114376, -0.006379878614097834, 0.019159847870469093, -0.023579277098178864, 0.018769104033708572, -0.014430518262088299, 0.009283497929573059, 0.01374335028231144, -0.007774424739181995, 0.024549396708607674, -0.005281758029013872, -0.0276214387267828, -0.005702816881239414, 0.013547979295253754, 0.01859394460916519, -0.003580681746825576, -0.04551474377512932, 0.03791547939181328, 0.006642619147896767, -0.002469087252393365, 0.021760305389761925, 0.0072219958528876305, -0.010482673533260822, 0.013958931900560856, -0.021019240841269493, -0.027500174939632416, -0.017704669386148453, 0.0018863421864807606, 0.032579824328422546, -0.017502561211586, -0.032714564353227615, -0.004624906927347183, -0.0122612239792943, 0.007895689457654953, 0.046862129122018814, 0.016465073451399803, 0.013460398651659489, 0.003627840196713805, -0.002814355306327343, -0.002650984562933445, -0.017745090648531914, -0.030154528096318245, 0.012436384335160255, 0.005120071582496166, 0.011688584461808205, 0.024495501071214676, 0.016801919788122177, 0.027863968163728714, -0.03632556274533272, 0.027554070577025414, 0.014578730799257755, 0.026570476591587067, -0.009835926815867424, -0.0552428774535656, -0.008070849813520908, -0.019981753081083298, 0.00885907094925642, 0.010550042614340782, 0.00865696370601654, -0.004557537380605936, 0.0029069881420582533]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"η)2max
i(dist2(Fi
t, Fi
⋆)).
The proof of Theorem 7.4 is a simple combination of Lemma B.2 and Lemma B.3. We build on (Tong et al., 2021b) for
our proof. Note in (Jia et al., 2023), the authors provide a proof for global convergence for scaled GD method for least
squares matrix decomposition problem. Since the proof detail there is closely tailed to the objective, we stick to the local
convergence proof in (Tong et al., 2021b) which more resembles the problem we are interested in.
C. SGD with Gradient Scaling
Algorithm 2 Pseudocode of scaled GD in PyTorch.
# group trainable parameters into LoRA pairs in train.py
for LoRA A, LoRA B in pairwise(trainable parameter):
param groups.append( {""params"": [LoRA A,LoRA B], ""lr"": learning rate})
# apply preconditioner in optimizer.py
for group in param_groups:
A, B = group[""params""]
dA, dB = group[""params""].grad
# precondition gradients
dAscaled =inverse(B.T@B+delta *torch.eye(r)).mm(dA)
dBscaled =dB.mm(inverse(A@A.T+delta *torch.eye(r)))
# update parameters
A.add_(dA_scaled, -group[’lr’])
B.add_(dB_scaled, -group[’lr’])
pairwise : read every two elements in a list
D. More on Runtime Comparison
Figure 4 shows runtime comparison for fine-tuning GPT-2 model with LoRA trained with differernt optimizers, r= 256 is
adopted. Note though the runtime gap between scaled optimizers and unscaled ones increases compared to r= 4shown in
Section 6.2, the increment is still marginal.
20
Riemannian Preconditioned LoRA
Figure 4. Runtime for LoRA fine-tuning GPT-2 medium model with rank r= 256 with different optimizers. Our scaled methods introduce
marginal runtime overhead and train as fast as unscaled methods. See Section 6.3.1 for experimental details.
E. Supplementary Experiments for Language Models
E.1. GPT-2
E.1.1. E XPERIMENTAL RESULTS FOR DIFFERENT LORA R ANKS
For experiments for varying LoRA ranks, we follow exact the same setting as in original LoRA project (Hu et al., 2021).
We experiment with medium-size GPT-2 (Radford et al., 2019) model with hyperparameters listed in Table 3, where the
learning rates for different methods are individually tuned by grid search except for AdamW, which we follow default setting
in LoRA report (Hu et al., 2021). We train with a linear learning rate schedule for 5 epochs. We note that we also tune
hyperparameters β1, β2for AdamW-type methods and find that lower β1, β2values are beneficial to scaled AdamW method.
See Table 4 for experimental results. We test with LoRA rank r= 1,4,8and method with scaled gradient always performs
better than its non-scaled gradient counterpart for all ranks and on most evaluation metrics. We set regularization factor to
beσ= 1e−6.
Method SGD scaled GD AdamW scaled AdamW
Rank 1 4 8 1 4 8 1 4 8 1 4 8
Training
Weight decay 0.01
Dropout Prob 0.1
Batch Size 8
#Epoch 5
Warmup Steps 500
LR Scheduler Linear
Label Smooth 0.1
LR (tuned, ×10−3) 60 90 20 30 0 .2 0 .5 0 .8 2
AdamW β1 / 0.9 0.7
AdamW β2 / 0.999 0.8
LoRA α 32
Inference
Beam Size 10
Length Penalty 0.8
No Repeat Ngram Size 4
Table 3. Hyperparameters for GPT-2 model fine-tuning
21
Riemannian Preconditioned LoRA
Method RankE2E
BLEU NIST MET ROUGE-L CIDEr
SGD 1 35.9 5.09 25.3 46.2 0.48
scaled GD (ours) 1 68.2 8.65 45.7 69.6 2.44
AdamW 1 69.9 8","[0.010909234173595905, 0.01058837492018938, 0.06201579049229622, -0.05323706567287445, -0.017839808017015457, -0.0003729995514731854, -0.01801948808133602, -0.01695423386991024, -0.040813371539115906, 0.03390846773982048, 1.0114605174749158e-05, 0.0276196151971817, -0.06802228838205338, -0.011602291837334633, 0.024808883666992188, -0.019777800887823105, 0.020586367696523666, -0.04651184380054474, -0.05857617408037186, 0.04037700220942497, 0.0038759869057685137, -0.030263500288128853, 0.020072991028428078, 0.02880037948489189, 0.023987481370568275, -0.019675126299262047, 0.03167528286576271, 0.03498655557632446, 0.03719407320022583, 0.002895760117098689, 0.011544536799192429, -0.026182163506746292, -0.03999197110533714, -0.05056751146912575, -0.003638550639152527, 0.0053102304227650166, 0.04443266987800598, 0.011794807389378548, -0.005932698491960764, 0.010761639103293419, -0.02867203578352928, -0.06350457668304443, -0.059346236288547516, 0.030597195029258728, -0.012763804756104946, 0.01373280119150877, 0.050387829542160034, 0.021240921691060066, 0.01867404207587242, 0.025168245658278465, -0.03388280048966408, 0.06258050352334976, -0.017826972529292107, -0.028287002816796303, 0.008919904008507729, 0.014438692480325699, 0.05544457957148552, 0.01719808764755726, 0.04314923286437988, -0.03886254504323006, 0.017133915796875954, -0.04286687448620796, 0.05452050268650055, -0.03524324670433998, -0.002700035460293293, -0.029493436217308044, -0.07454215735197067, 0.009234346449375153, 0.020855888724327087, 0.026336176320910454, -0.024629201740026474, 0.002619820646941662, 0.05375044047832489, -0.04281553626060486, -0.004501663614064455, -0.008701718412339687, 0.011409776285290718, 0.05441782996058464, 0.049977127462625504, -0.023294424638152122, 0.004992579109966755, -0.02285805530846119, 0.03616731986403465, -0.012532785534858704, 0.00778405973687768, -0.07028114050626755, 0.004299521911889315, -0.02800464630126953, -0.020008819177746773, -0.009215094149112701, -0.0017454775515943766, -0.021099742501974106, -0.003972244914621115, 0.00017737533198669553, 0.04430432617664337, 0.002621424850076437, 0.03960694000124931, 0.007373359054327011, 0.03881120681762695, 0.0460241362452507, 0.028569359332323074, 0.019610952585935593, 0.02797897718846798, -0.038297832012176514, 0.03914489969611168, 0.0006176551687531173, 0.020958565175533295, 0.00610917154699564, -0.022678373381495476, -0.004354068078100681, -0.05133757367730141, 0.051722604781389236, -0.032111652195453644, -0.019007736817002296, 0.00693057244643569, -0.08552839607000351, -0.04746158793568611, 0.0071551743894815445, -0.025129742920398712, -0.014554202556610107, -0.012333852238953114, -0.005515580531209707, -0.012641877867281437, -0.001872217166237533, 0.029236748814582825, 0.005521997809410095, 0.03270203620195389, -0.05033649131655693, 0.007193677593022585, 0.0184173546731472, 0.013758470304310322, 0.021497609093785286, 0.041070058941841125, -0.01656920276582241, -0.04681986942887306, 0.00021196802845224738, -0.0354742631316185, -0.006012913305312395, -0.022447355091571808, 0.019379934296011925, -0.01854569837450981, -0.0407106950879097, -0.003234267234802246, 0.02247302234172821, -0.05375044047832489, 0.009016161784529686, -0.03272770345211029, 0.02563028410077095, -0.04653751105070114, 0.03834916651248932, 0.010196926072239876, 0.001698952866718173, -0.04286687448620796, 0.010960572399199009, 0.004004330839961767, -0.011653629131615162, -0.02692655846476555, 0.03195764124393463, 0.02471904270350933, -0.016055826097726822, 0.010992658324539661, 0.047384582459926605, 0.037373755127191544, -0.003815023461356759, 0.028723372146487236, 0.03229133412241936, -0.01890506222844124, 0.02838967926800251, -0.08347489684820175, -0.025335092097520828, 0.005544458050280809, -0.006532706320285797, -0.030314838513731956, -0.03719407320022583, 0.0005875745555385947, -0.0025749001652002335, -0.03247101604938507, -0.008445031009614468, 0.022678373381495476, -0.025463437661528587, -0.016376685351133347, 0.001612320658750832, -0.058935534209012985, 0.035679616034030914, -0.0552392303943634, 0.005724139511585236, -0.011762721464037895, -0.023422768339514732, 0.013950985856354237, 0.034755539149045944, 0.028287002816796303, 0.004636424593627453, 0.1038045734167099, 0.007264266721904278, -0.01380980759859085, -0.03991496562957764, 0.06381260603666306, 0.02326875552535057, -0.055906619876623154, 0.02301206812262535, 0.008194760419428349, 0.02455219440162182, 0.018199170008301735, -0.086709164083004, 0.009799059480428696, -0.03668069839477539, -0.01786547526717186, -0.01486222818493843, 0.01222475990653038, -0.00997874140739441, 0.03508923202753067, 0.01985480636358261, 0.009414027445018291, -0.030391843989491463, -0.03393413498997688, 0.010735969990491867, -0.07905986160039902, 0.021921144798398018, 0.06032165139913559, 0.05136324465274811, 0.006936989724636078, 0.0354485958814621, -0.04194279760122299, 0.019662290811538696, -0.02391047589480877, 0.004280270077288151, 0.03259935975074768, -0.035551268607378006, 0.03308706730604172, -0.02851802296936512, 0.030982226133346558, -0.01386114489287138, -0.006170134525746107, -0.01880238577723503, 0.06797094643115997, -0.05621464550495148, 0.028209997341036797, -0.04127540811896324, -0.008907069452106953, -0.03403681144118309, -0.0042128898203372955, 0.02183130383491516, 0.0203681830316782, -0.029262417927384377, 0.009843979962170124, 0.015555284917354584, -0.006699553690850735, -0.016209838911890984, 0.02366662211716175, -0.009446113370358944, -0.017172418534755707, -0.023178914561867714, -0.0355256013572216, -0.06596878170967102, -0.032394010573625565, 0.014669711701571941, -0.0002811534213833511, 0.003657802240923047, -0.03914489969611168, 0.0007415873114950955, -0.01970079354941845, 0.00965788122266531, 0.0276196151971817, 0.04530540853738785, -0.00745678273960948, 0.0038086064159870148, -0.02573295868933201, -0.003131591947749257, 0.003744434332475066, -0.02193397842347622, 0.007187260314822197, -0.00680222874507308, -0.030391843989491463, 0.008329521864652634, -0.015144584700465202, -0.03298439085483551, 0.04635782912373543, 0.015683628618717194, -0.051029548048973083, -0.04140375554561615, 0.027362927794456482, 0.06160508841276169, 0.0827561691403389, 0.00472947396337986, 0.02035534754395485, -0.012840811163187027, -0.020072991028428078, 0.00407491996884346, -0.012654712423682213, -0.00660329544916749, 0.02208799123764038, -0.0407877042889595, 0.061451077461242676, -0.03755343705415726, -0.021253755316138268, 0.0118268933147192, 0.03021216206252575, -0.036347001791000366, -0.01759595423936844, 0.0053808195516467094, 0.014438692480325699, 0.011987323872745037, -0.01736493408679962, 0.01577346958220005, -0.033292416483163834, 0.021240921691060066, 0.013437610119581223, 0.016748882830142975, -0.024783214554190636, 0.016505030915141106, -0.021215252578258514, 0.037117067724466324, -0.006102754268795252, 0.03588496521115303, 0.007058916613459587, -0.020689042285084724, 0.039504263550043106, -0.016607705503702164, 0.02928808704018593, -0.03919623792171478, -0.00820117723196745, -0.05585528165102005, -0.001867404324002564, 0.014156335964798927, 0.022652704268693924, 0.020214170217514038, -0.030006812885403633, -0.0018545698840171099, -0.009927403181791306, 0.0008105721790343523, -0.003795771859586239, 0.006343399174511433, 0.03170095384120941, 0.019110411405563354, -0.009414027445018291, 0.04558776691555977, -0.042533181607723236, 0.0643773153424263, 0.06109171360731125, 0.03763044252991676, -0.05002846568822861, -0.02156178094446659, 0.010306018404662609, -0.010922068729996681, -0.013514616526663303, 0.003644967684522271, 0.0009457343840040267, -0.009843979962170124, 0.06211846321821213, 0.014631208963692188, -0.03655235469341278, -0.03788712993264198, -0.006866400595754385, 0.019367100670933723, -0.006782976910471916, -0.005708096548914909, 0.03090522065758705, -0.03295872360467911, -0.03827216103672981, 0.009311352856457233, -0.05441782996058464, 0.0236409530043602, -0.0010347729548811913, -0.010658963583409786, -0.01320659089833498, 0.015272928401827812, -0.002969557885080576, 0.01984197273850441, 0.033703118562698364, -0.04440700262784958, 0.00814342312514782, 0.03113623894751072, -0.04004330933094025, 0.006738056428730488, -0.04846267029643059, 0.024783214554190636, 0.04386795684695244, 0.04389362782239914, 0.0029535149224102497, 0.022768214344978333, 0.017429105937480927, 0.01137127261608839, -0.008971241302788258, 0.0053808195516467094, -0.015183087438344955, 0.047384582459926605, 0.0005386434495449066, 0.00427385326474905, -0.04350859299302101, -0.020843055099248886, -0.01406649500131607, 0.012789472937583923, -0.02311474271118641, 0.01814783178269863, -0.0121541703119874, 0.027157576754689217, 0.023461271077394485, 0.0276196151971817, 0.04481770098209381, 0.04399630054831505, -0.010999075137078762, -0.005175469443202019, -0.057241395115852356, -0.026310507208108902, -0.016620539128780365, 0.04628082364797592, 0.006680301856249571, 0.07839247584342957, 0.016351018100976944, 0.02708057127892971, -0.018840890377759933, -0.004809688776731491, 0.03960694000124931, -0.03385712951421738, 0.030930887907743454, -0.01787831075489521, 0.017775634303689003, 0.04060802236199379, 0.011871813796460629, 0.045793116092681885, -0.007007578853517771, -0.011307100765407085, -0.030468851327896118, -0.020663373172283173, -0.03334375470876694, 0.020573532208800316, -0.004723056685179472, -0.0020679417066276073, -0.012462195940315723, -0.005563709419220686, -0.0016716797836124897, -0.014964902773499489, 0.041609104722738266, -0.0552392303943634, -0.061759103089571, -0.004296313039958477, -0.010812976397573948, 0.041583433747291565, 0.023166080936789513, -0.02497573010623455, 0.03852884843945503, 0.026772545650601387, -0.035140570253133774, -0.009369106963276863, -0.013424775563180447, 0.02116391435265541, -0.013463279232382774, 0.02340993471443653, 0.007508120033890009, -0.020984234288334846, 0.0007913205772638321, -0.01406649500131607, -0.007315604481846094, -0.021240921691060066, -0.009645046666264534, -0.06083502620458603, 0.06807362288236618, -0.014323183335363865, 0.03965827450156212, -0.02092006243765354, 0.05677935853600502, -0.02851802296936512, -0.061194390058517456, -0.032265666872262955, -0.007995827123522758, 0.05033649131655693, 0.02604098431766033, 0.028620697557926178, -0.006622547283768654, 0.006821480114012957, 0.024603532627224922, -0.029390761628746986, -0.031726621091365814, -0.032907385379076004, -0.02616932801902294, 0.004488829057663679, 0.010909234173595905, -0.035551268607378006, 0.033574774861335754, -0.0177499670535326, 0.02813299000263214, 0.024128660559654236, 0.04065936058759689, -0.014271846041083336, 0.02995547465980053, 0.06776560097932816, 0.04923273250460625, 0.0031893467530608177, -0.020137162879109383, -0.01111458521336317, -0.03704005852341652, -0.025399265810847282, 0.03254802152514458, -0.013899648562073708, 0.00035394850419834256, -0.036321334540843964, -0.02903139777481556, -0.01433601789176464, -0.01719808764755726, -0.006025747861713171, 0.022280506789684296, -0.032111652195453644, 0.002292543649673462, 0.032394010573625565, 0.005704888142645359, 0.018455857411026955, -0.011486782692372799, 0.007482451386749744, 0.028980061411857605, 0.0164408590644598, 0.0031059233006089926, 0.05636865645647049, -0.021908309310674667, -0.011993740685284138, 0.01486222818493843, 0.019752131775021553, -0.009548788890242577, 0.020727545022964478, -0.004880278371274471, 0.009362690150737762, 0.00201820838265121, -0.0019171375315636396, -0.04104439169168472, -0.02561745047569275, 0.009433279745280743, 0.00021236910833977163, 0.01890506222844124, -0.07274534553289413, -0.018481526523828506, -0.0005109693156555295, 0.00986323133111, -0.027799297124147415, -0.0005077606765553355, -0.01970079354941845, -0.0368347093462944, -0.017660126090049744, 0.017929647117853165, -0.0289287231862545, -0.05177394300699234, 0.028595028445124626, 0.028209997341036797, 0.019392767921090126, 0.00749528594315052, -0.009908151812851429, 0.01352745108306408, -0.04083903878927231, 0.05007980391383171, -0.013424775563180447, 0.0076685501262545586, 0.040531013160943985, 0.06530139595270157, -0.017441941425204277, 0.01386114489287138, -0.013257928192615509, -0.035166237503290176, -0.016890062019228935, 0.001105362200178206, 0.02720891498029232, 0.02419283241033554, 0.033420760184526443, 0.021767131984233856, 0.0016387916402891278, 0.009702801704406738, -0.01524725928902626, -0.013488947413861752, 0.04769260808825493, 0.008130588568747044, -0.023101909086108208, 0.027901971712708473, 0.0308795515447855, -0.01642802357673645, 0.03275337070226669, 0.007450365461409092, 0.037399422377347946, 0.005342316348105669, -0.025335092097520828, 0.048282988369464874, 0.03347209841012955, 0.020188501104712486, 0.015144584700465202, -0.028312671929597855, -0.02062487043440342, -0.0052685183472931385, -0.020817385986447334, -0.06530139595270157, -0.008246097713708878, -0.015465443953871727, 0.0008165882900357246, -0.031084900721907616, 0.028826048597693443, 0.03460152447223663, -0.00423855846747756, 0.030314838513731956, -0.03275337070226669, 0.0022636661306023598, -0.020008819177746773, -0.01615850068628788, -0.00940761063247919, -0.0015329078305512667, -0.007065333891659975, 0.02718324586749077, 0.0003617694601416588, 0.007392610888928175, 0.009516702964901924, -0.0035936301574110985, 0.005967992823570967, -0.010960572399199009, 0.020547864958643913, 0.0223446786403656, -0.03390846773982048, -0.003632133360952139, -0.014810889959335327, -0.003946575801819563, -0.01587614417076111, -0.026644201949238777, -0.029647449031472206, 0.0005270122783258557, 0.004646050278097391, 0.0551878921687603, -0.02039385214447975, -0.012795890681445599, 0.0011575018288567662, -0.005236432421952486, -0.013694297522306442, 0.020060157403349876, -4.7094954425119795e-06, -0.0002466609876137227, -0.01894356496632099, -0.0108450623229146, 0.016197005286812782, -0.03670636564493179, -0.023756463080644608, 0.01433601789176464, -0.0014968111645430326, 0.012141336686909199, -0.0001688524935161695, -0.0011510846670717, -0.007001161575317383, -0.005175469443202019, -0.03326674923300743, 0.05010547116398811, 0.011377690359950066, -0.010877148248255253, -0.04104439169168472, 0.02288372442126274, -0.02720891498029232, 0.009908151812851429, -0.009035413153469563, -0.01511891558766365, -0.030699869617819786, -0.021497609093785286, -0.039350252598524094, 0.022408850491046906, 0.026464520022273064, 0.006705970503389835, 0.015555284917354584, -0.009837563149631023, -0.008451447822153568, -0.0074182795360684395, -0.007655715569853783, -0.05806279554963112, -0.019148916006088257, -0.010909234173595905, 0.015388437546789646, 0.016107164323329926, 0.0027561860624700785, -0.002631050767377019, 0.027799297124147415, 0.00015311030438169837, -0.028851717710494995, 0.04445834085345268, -0.009811894036829472, 0.02654152549803257, -0.017672959715127945, 0.0037540600169450045, -0.04312356188893318, -0.022550029680132866, -0.03701439127326012, -0.010325269773602486, 0.020021654665470123, -0.04320056736469269, 0.012821558862924576, -0.05364776402711868, -0.01425901148468256, 0.003975453320890665, 0.012635460123419762, 0.002459390787407756, -0.024359678849577904, -0.0074760341085493565, -0.02457786351442337, -0.012969154864549637, -0.004492037929594517, -0.005079211201518774, -0.011249345727264881, 0.010819394141435623, 0.03670636564493179, -0.031059231609106064, 0.048282988369464874, 0.0035326669458299875, -0.08645247668027878, 0.009388359263539314, 0.020727545022964478, 0.0025043110363185406, -0.004472786094993353, -0.015298597514629364, -0.0040075392462313175, -0.01917458325624466, 0.011557371355593204, 0.042789869010448456, -0.029108405113220215, 0.004167969338595867, -0.015324265696108341, -0.022922227159142494, 0.0197136290371418, -0.028980061411857605, -0.004116631578654051, 0.0282613355666399, -0.003741225693374872, 0.00716800894588232, 0.007071750704199076, -0.021510444581508636, -0.013950985856354237, -0.004861026536673307, 0.017711462453007698, 0.01300765760242939, 0.013745635747909546, -0.006744473706930876, 0.030828213319182396, -0.022267673164606094, -0.005197929218411446, 0.022691207006573677, 0.035679616034030914, 0.013046161271631718, 0.005303813144564629, -0.026387512683868408, 0.03308706730604172, -0.01655636727809906, -0.023820634931325912, 0.0014157940167933702, 0.01881522126495838, 0.029339423403143883, -0.017390603199601173, -0.043970633298158646, 0.005143383052200079, 0.0076172128319740295, -0.018032323569059372, 0.03763044252991676, 0.01438735518604517, 0.010074999183416367, 0.006917738355696201, -0.024000316858291626, 0.010575540363788605, -0.001949223573319614, -0.021754296496510506, 0.024205666035413742, -0.013694297522306442, 0.029390761628746986, 0.03863152489066124, -0.002898968756198883, 0.005435365717858076, 0.005361567717045546, 0.02049652673304081, -0.019251590594649315, 0.008380859158933163, 0.015863310545682907, 0.01071030180901289, -0.011275014840066433, -0.015824807807803154, -0.013642960228025913, 0.00814342312514782, -0.013142419047653675, -0.007520954590290785, 0.015195921994745731, 0.02090722694993019, 0.04258451983332634, 0.005464243236929178, 0.02406448870897293, -0.018340349197387695, 0.015696464106440544, -0.008566957898437977, -0.032368339598178864, -0.0062086377292871475, -0.004864235408604145, 0.0032390800770372152, -0.0033497768454253674, -0.004466368816792965, -0.005425740033388138, 0.013424775563180447, 0.009028996340930462, -0.021921144798398018, -0.025925474241375923, 0.005076002795249224, 0.005595795810222626, 0.018301844596862793, 0.026592863723635674, 0.05359642952680588, -0.037373755127191544, -0.09836279600858688, -0.027953309938311577, 0.00476476876065135, 0.008432196453213692, 0.01551678217947483, 0.003494163742288947, 0.02275538071990013, 0.0006798217655159533, 0.007110253907740116, -0.004026791080832481, 0.02534792758524418, -0.05503388121724129, -0.020663373172283173, -0.024205666035413742, 0.011608708649873734, -0.035268913954496384, 0.00252837548032403, 0.0014230133965611458, 0.0446636900305748, -0.019662290811538696, -0.00623751524835825, -0.012256845831871033, 0.008688884787261486, -0.001484778942540288, -0.012962737120687962, -0.016055826097726822, 0.019687959924340248, 0.00021156696311663836, 0.019662290811538696, 0.012860062532126904, 0.00640115374699235, -0.008335938677191734, 0.053031712770462036, 0.01785264164209366, -0.05713871866464615, 0.004293104633688927, -0.008015078492462635, 0.008419361896812916, 0.018751049414277077, 0.019649457186460495, 0.014079329557716846, -0.04897604510188103, 0.029801461845636368, 0.005820397287607193, 0.025809966027736664, -0.005156217608600855, 0.016261177137494087, -0.022383183240890503, -0.007270684000104666, 0.0057883113622665405, 0.025578945875167847, 0.03301006183028221, -0.005313438829034567, 0.007527371868491173, 0.007841814309358597, -0.031469933688640594, -0.027439933270215988, -0.031187577173113823, 0.0018866558093577623, -0.014656877145171165, 0.024667704477906227, 0.025861302390694618, -0.01696706749498844, -0.008047164417803288, -0.04417598247528076, -0.041198402643203735, 0.007386193610727787, -0.006016122177243233, 0.004979744553565979, -0.05161993205547333, 0.0043701110407710075, 0.0076685501262545586, -0.010235428810119629, -0.012904983013868332, -0.018725380301475525, -0.012462195940315723, 0.008913486264646053, 0.03655235469341278, -0.05703604593873024, 0.023435601964592934, 0.026387512683868408, -0.012391607277095318, 0.004610755946487188, 0.010408692993223667, 0.012693215161561966, 0.016659043729305267, 0.025681622326374054, -0.03565394505858421, -0.03837483748793602, 0.02314041182398796, 0.059346236288547516, 0.007610795553773642, 0.010434362106025219, 0.017531782388687134, -0.005191512405872345, -0.025424933061003685, 0.023551112040877342, 0.015452610328793526, 0.0164408590644598, 0.0018112538382411003, 3.115849904133938e-05, 0.024539360776543617, -0.03642400726675987, -0.015067578293383121, 0.013553119264543056, 0.002565274480730295, 0.024231335148215294, 0.0021722211968153715, 0.02772228978574276, -0.03952993080019951, 0.01881522126495838, 0.01235310360789299, -0.014169170521199703, 0.02325592190027237, -0.024269837886095047, 0.017801303416490555, 0.04412464424967766, 0.02918541058897972, 0.027388595044612885, -0.0021353221964091063, 0.005653550382703543, -0.0037701032124459743, 0.007848232053220272, 0.02076604962348938, -0.03272770345211029, -0.0015521594323217869, -0.007995827123522758, 0.0098568145185709, -0.052775025367736816, 0.0328817181289196, 0.012494281865656376, 0.0027337258215993643, 0.0042642271146178246, 0.024513691663742065, -0.024860220029950142, 0.014310348778963089, 0.031341589987277985, -0.0098568145185709, -0.03234267234802246, 0.024372514337301254, 0.025283755734562874, -0.003811814822256565, 0.02039385214447975, -0.004161552060395479, -0.00716800894588232, 0.019007736817002296, -0.023435601964592934, -0.04484337195754051, 0.00014649257354903966, 0.056060630828142166, 0.0216901246458292, -0.01275097019970417, 0.0057498081587255, 0.016453692689538002, 0.017903979867696762, 0.040556684136390686, 0.0076749674044549465, 0.003494163742288947, -0.017390603199601173, -0.007366941776126623, 0.01801948808133602, 0.03190630301833153, 0.016261177137494087, 0.0026294463314116, 0.011833311058580875, -0.029544774442911148, -0.01591464877128601, 0.0009553601848892868, -0.011210842989385128, 0.0004949262947775424, -0.02247302234172821, -0.051055219024419785, 0.012141336686909199, 0.01890506222844124, 0.02561745047569275, -0.0012778242817148566, 0.0062567670829594135, -0.014169170521199703, 0.0063722762279212475, 0.03129025176167488, -0.0013957403134554625, 0.016184169799089432, -0.004257810302078724, -0.00868246704339981, 0.025720125064253807, -0.045921459794044495, -0.02692655846476555, -0.0032888134010136127, -0.015234425663948059, 0.03321541100740433, 0.002717682858929038, 0.02695222571492195, -0.001346006989479065, -0.009510285221040249, 0.04456101357936859, -0.04032566398382187, 0.04797496274113655, 0.0289287231862545, -0.005262101534754038, -0.018853724002838135, -0.03768178075551987, 0.03865719214081764, 0.0027561860624700785, -0.01654353365302086, -0.0210355706512928, 0.02482171729207039, -0.007751973811537027, -0.01413066778331995, -0.01943127252161503, 0.00991456862539053, 0.031495600938797, 0.04150642827153206, -0.008015078492462635, 0.007219346240162849, 0.0210355706512928, -0.039119232445955276, 0.00036898881080560386, -0.004687762353569269, -0.03375445678830147, -0.025437768548727036, -0.036321334540843964, -0.002260457491502166, -0.000740785151720047, 0.007206512149423361, -0.00545782595872879, 0.05018248036503792, 0.0015296993078663945, -0.011910317465662956, -0.0032583316788077354, 0.012494281865656376, 0.009394776076078415, -0.012186257168650627, -0.02142060361802578, -0.006138048600405455, 0.004569044336676598, -0.02867203578352928, -0.016736049205064774, 0.011307100765407085, 0.003644967684522271, 0.00900332722812891, 0.03757910430431366, 0.004283478949218988, -0.01360445749014616, -0.004710222594439983, 0.0203810166567564, 0.029211079701781273, 0.0203810166567564, 0.056728020310401917, -0.03116190806031227, 0.029236748814582825, 0.017647290602326393, -0.004530541133135557, 0.0058877780102193356, -0.005557292606681585, 0.008990492671728134, 0.020201334729790688, 0.007039664778858423, 0.04612680897116661, 0.03670636564493179, 0.029390761628746986, -0.0407620333135128, 0.03447318077087402, 0.011935985647141933, 0.00030100662843324244, 0.0203810166567564, -0.024988563731312752, 0.006192594766616821, -0.006288853008300066, 0.009888900443911552, 0.01563229225575924, 0.0009040225995704532, 0.010107085108757019, 0.02785063348710537, 0.02708057127892971, -0.011287849396467209, 0.0018802386475726962, 0.06530139595270157, -0.003223037114366889, 0.031187577173113823, 0.023859137669205666, -0.027234584093093872, -0.02050936035811901, -0.012199090793728828, -0.009766973555088043, 0.025797130540013313, -0.03139292821288109, -0.00040087426896207035, -0.02628483809530735, 0.03532025218009949, 0.04507439211010933, -0.014605539850890636, 0.03760477155447006, -0.033420760184526443, -0.004963701590895653, 0.03272770345211029, 0.010132753290235996, 0.006381902378052473, 0.014323183335363865, 0.022319011390209198, -0.011332769878208637, 0.007559457793831825, -0.002627842128276825, -0.013232260011136532, -0.040685027837753296, 0.015414106659591198, 0.045408084988594055, 0.0013387877261266112, -0.03875986859202385, -0.013822642154991627, 0.0118268933147192, -0.017531782388687134, 0.002390405861660838, 0.016479361802339554, 0.050259485840797424, 0.009747722186148167, -0.015850476920604706, -0.002194681204855442, 0.005297395866364241, 0.00758512644097209, -0.008002244867384434, 0.03999197110533714, -0.0014976132661104202, 0.014117833226919174, 0.009824728593230247, -0.01577346958220005, -0.005903820972889662, -0.03034050576388836, -0.010684632696211338, -0.01918741874396801, 0.02537359669804573, 0.018083659932017326, -0.00036738452035933733, -0.012051495723426342, 0.006622547283768654, -0.032907385379076004, -0.0004736693517770618, -0.0037604772951453924, -0.011076081544160843, -0.024731876328587532, -0.007302769925445318, 0.030853882431983948, 0.014887896366417408, 0.00023643359600100666, -0.017005572095513344, -0.014194839634001255, 0.03763044252991676, 0.012167004868388176, 0.004934824537485838, 0.03904222697019577, 0.019354265183210373, 0.07002445310354233, 0.020278342068195343, -0.022306175902485847, 0.0236537866294384, 0.002104840474203229, 0.06335056573152542, 0.006661050487309694, -0.03968394547700882, -0.026079487055540085, 0.016376685351133347, 0.018866559490561485, 0.009953072294592857, -0.02402598410844803, 0.0020775673910975456, 0.01459270529448986, 0.012109250761568546, -0.01881522126495838, 0.020085826516151428, 0.010684632696211338, 0.03657802194356918, 0.01696706749498844, 0.015734966844320297, -0.004899529740214348, -0.01169213280081749, -0.007642881479114294, 0.01578630320727825, -0.0033658198080956936, 0.014284679666161537, 0.036475345492362976, 0.0354485958814621, -0.01446436159312725, -0.009093168191611767, -0.019238755106925964, 0.02797897718846798, -0.029544774442911148, 0.014849393628537655, -0.006336981896311045, 0.02720891498029232, 0.012012992054224014, 0.01745477505028248, 0.01242369320243597, 0.0004191231564618647, -0.01144186221063137, 0.02077888324856758, -0.03431916981935501, -0.0036802624817937613, 0.024205666035413742, -0.019790634512901306, -0.01853286474943161, 0.005040707997977734, 0.026875220239162445, -0.016877228394150734, 0.01157020591199398, -0.004620381630957127, 0.028466684743762016, 0.00997874140739441, -0.00170055718626827, 0.025655953213572502, 0.024924391880631447, 0.01260337419807911, -0.02692655846476555, -0.015375603921711445, -0.022524360567331314, 0.033420760184526443, -0.03034050576388836, -0.030160825699567795, -0.003795771859586239, 0.019123246893286705, -0.019277259707450867, -0.003718765452504158, -0.03850318118929863, -0.00014679337618872523, -0.011217259801924229, -0.01591464877128601, 0.026644201949238777, 0.006680301856249571, -0.03588496521115303, 0.014117833226919174, 0.023756463080644608, 0.04679419845342636, -0.023717958480119705, 0.012577706016600132, -0.017826972529292107, 0.007264266721904278, -0.026592863723635674, -0.01867404207587242, 0.035140570253133774, -0.003245497355237603, -0.03231700137257576, 0.002385593019425869, 0.00305458577349782, 0.0036674279253929853, 0.016094328835606575, -0.0045273322612047195, -0.022126493975520134, -0.00594553304836154, -0.0085477065294981, 0.013065412640571594, -0.005563709419220686, -0.0012818350223824382, -0.011153087951242924, 0.035140570253133774, 0.01124292891472578, 0.006452491506934166, 0.01255203690379858, -0.003248705994337797, -0.010235428810119629, -0.022421685978770256, 0.011852562427520752, 0.007700636051595211, 0.03324107825756073, -0.008868565782904625, 0.036449678242206573, 0.00627281004562974, 0.01031243521720171, 0.025039901956915855, 0.0223446786403656, 0.0814213901758194, 0.006301687099039555, -0.0016115185571834445, 0.015285762958228588, 0.022524360567331314, 0.018558533862233162, -0.0026551152113825083, -0.02022700384259224, 0.02654152549803257, -0.001237716875039041, -0.008939155377447605, -0.00925359781831503, 0.009163756854832172, -0.009689967148005962, -0.02100990153849125, 0.004020373802632093, -0.009471782483160496, 0.020291175693273544, 0.025861302390694618, 0.025720125064253807, -0.005239641293883324, -0.013309266418218613, -0.027824966236948967, 0.0124750304967165, 0.01373280119150877, -0.0020920061506330967, 0.009959489107131958, 0.0256046149879694, -0.011884648352861404, 0.03524324670433998, -0.027439933270215988, -0.01681305654346943, -0.015272928401827812, 0.011416193097829819, 0.012199090793728828, -0.024860220029950142, 0.029082736000418663, -0.004421448800712824, 0.006221472285687923, 0.000845465692691505, -0.0538531169295311, 0.01578630320727825, 0.005188303533941507, -0.0036128817591816187, -0.0020502943079918623, 0.007399027701467276, 0.03062286227941513, 0.054212477058172226, -0.013565953820943832, 0.0031845339108258486, 0.011916734278202057, 0.018622705712914467, -0.0021353221964091063, 0.03008381836116314, 0.02340993471443653, 0.010434362106025219, 0.02301206812262535, -0.016761718317866325, -0.018584201112389565, -0.007379776332527399, 0.019213087856769562, -0.031726621091365814, 0.020945729687809944, -0.0190719086676836, -0.016055826097726822, -0.007078167982399464, 0.0033529852516949177, -0.008650381118059158, -0.028723372146487236, 0.014374520629644394, -0.004992579109966755, 0.016723215579986572, -0.004671719390898943, 0.013136002235114574, -0.019213087856769562, 0.021741462871432304, 0.012321017682552338, 0.01828901097178459, 0.03231700137257576, 0.02261420153081417, 0.017313597723841667, -0.0008310269913636148, -0.0003002044977620244, 0.008355190046131611, -0.009138088673353195, 0.0029005729593336582, -0.0041198404505848885, -0.001779167796485126, 0.005114505998790264, 0.009446113370358944, 0.002032647142186761, 0.028158659115433693, -0.019482608884572983, 0.00840011052787304, -0.014708215370774269, 0.014746718108654022, 0.022550029680132866, 0.004418239928781986, -0.02511690743267536, -0.0009689967264421284, 0.006288853008300066, -0.011409776285290718, -0.009773390367627144, 0.023191750049591064, -0.011339186690747738, 0.03378012403845787, 0.008329521864652634, -0.020612036809325218, 0.00814983993768692, 0.007142339833080769, 0.02708057127892971, 0.004020373802632093, 0.03188063204288483, 0.0022283715661615133, -0.01762162335216999, 0.008611878380179405, 0.0011374481255188584, -0.0029390761628746986, -0.003227849956601858, -0.017031241208314896, -0.0014270241372287273, 0.0034203659743070602, -0.004350859206169844, -0.013014075346291065, 0.000357357639586553, 0.012827976606786251, -0.005810771603137255, -0.013565953820943832, 0.034370504319667816, 0.00807925034314394, 0.012288931757211685, -0.04517706483602524, -0.0054802861995995045, -0.0025732959620654583, -0.009189425967633724, 0.00039826726424507797, -0.046075474470853806, 0.010421527549624443, -0.025963978841900826, -0.008316687308251858, -0.03983795642852783, 0.01945694163441658, 0.02588697150349617, -0.009645046666264534, -0.01722375676035881, 0.015195921994745731, -0.021446270868182182, 0.01853286474943161, 0.02982713095843792, 0.0011615125695243478, 0.014695380814373493, 0.01031243521720171, -0.023281589150428772, -0.0018160666804760695, 0.02838967926800251, -0.009568040259182453, -0.01405366137623787, -0.011531702242791653, 0.019649457186460495, -0.010472864843904972, 0.010415110737085342, 0.005512372124940157, -0.03188063204288483, -0.006609712727367878, 0.0029214287642389536, -0.02601531520485878, -0.005679219029843807, 0.005929489620029926, 0.04101872071623802, -0.009484617039561272, -0.033061396330595016, 0.010415110737085342, 0.02288372442126274, -0.035422924906015396, 0.008226846344769001, -0.00016273610526695848, -0.015183087438344955, -0.01451569888740778, 0.007655715569853783, 0.005271727219223976, -0.014297514222562313, 0.0004921187646687031, 0.03398547321557999, -0.014310348778963089, -0.00745678273960948, -0.0236409530043602, 0.011608708649873734, 0.03221432864665985, 0.03126458451151848, -0.007559457793831825, 0.0367577038705349, -0.023063404485583305, 0.011743470095098019, 0.012449361383914948, 0.003229454392567277, -0.01591464877128601, 0.03655235469341278, 0.007264266721904278, 0.02469337359070778, -0.026875220239162445, 0.03267636522650719, -0.018366016447544098, 0.017185252159833908, -0.025181081146001816, -0.003972244914621115, -0.03840050473809242, -0.027388595044612885, 0.006205429323017597, 0.02455219440162182, -0.022832386195659637, 0.019405603408813477, 0.029005728662014008, 0.005207555368542671, 0.03575662150979042, 0.011615126393735409, 0.05600929260253906, -0.022267673164606094, -0.02985280007123947, 0.03755343705415726, -0.0001436850434402004, 0.010209759697318077, 0.022960729897022247, -0.030160825699567795, -0.038836874067783356, 0.010273932479321957, 0.013976654969155788, -0.015953151509165764, -0.03406248241662979, 0.02669553831219673, -0.028543692082166672, -0.023461271077394485, -0.004642841871827841, -0.0009272849420085549, 0.01405366137623787, 0.023705124855041504, 0.010626877658069134, 0.012109250761568546, 0.03562827780842781, 0.03824649378657341, -0.004649259150028229, -0.029750123620033264, -0.04271286353468895, -0.03378012403845787, -0.02219066582620144, 0.008008661679923534, 0.046717192977666855, 0.025925474241375923, -0.0015465443721041083, 0.0021738253999501467, 0.03203464671969414, -0.0016235507791861892, 0.005717722233384848, 0.0157478004693985, -0.0005065574659965932, 0.011384107172489166, 0.013437610119581223, 0.026207832619547844, -0.02221633493900299, 0.016710380092263222, -0.021844137459993362, 0.00011550954513950273, 0.021998150274157524, 0.011987323872745037, 0.014271846041083336, -0.0004207274760119617, -0.01642802357673645, -0.01772429794073105, 0.0007431916310451925, 0.009144505485892296, 0.002460994990542531, 0.017172418534755707, -0.0037636859342455864]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
".80 46.5 71.4 2.48
scaled AdamW (ours) 1 70.1 8.82 46.5 71.7 2.51
SGD 4 66.6 8.54 44.2 68.2 2.32
scaled GD (ours) 4 69.2 8.71 46.3 70.9 2.48
AdamW 4 68.9 8.69 46.5 71.3 2.51
scaled AdamW (ours) 4 69.6 8.77 46.6 71.8 2.52
SGD 8 65.8 8.46 43.5 68.7 2.33
scaled GD (ours) 8 69.6 8.78 46.4 70.8 2.48
AdamW 8 69.6 8.74 46.7 71.8 2.53
scaled AdamW (ours) 8 70.1 8.82 46.6 71.8 2.53
Table 4. Experiments for GPT-2 medium model on E2E NLG challenge with different LoRA ranks. Our scaled optimizers outperform
unscaled optimizers for all LoRA ranks being tested and on most evaluation metrics. Moreover, scaled GD method behaves close to
AdamW method. See Appendix E.1.1 for experimental details.
E.1.2. E XPERIMENTAL RESULTS FOR DIFFERENT MODEL SIZES
For GPT-2 model, we also experiment with different model sizes. LoRA rank ris fixed to be 4. We use the same training
hyperparameters as listed in Table 3. See Table 5 for final scores. Note our scaled gradient methods always outperform their
unscaled gradient counterparts for different model sizes and on most evaluation metrics, which shows the superiority of the
introduced preconditioner. Furthermore, there is usually significant performance gap between SGD method and AdamW
method while our scaled GD method is able to obtain scores comparable to AdamW without requiring momentum terms.
Our scaled GD method indeed closes the gap between SGD and AdamW.
Method Model #Trainable ParametersE2E
BLEU NIST MET ROUGE-L CIDEr
SGD GPT-2 S 0.15M 54.8 4.56 34.0 63.3 1.29
scaled GD (ours) GPT-2 S 0.15M 68.5 8.72 45.5 69.4 2.40
AdamW GPT-2 S 0.15M 69.1 8.75 46.0 70.5 2.47
scaled AdamW (ours) GPT-2 S 0.15M 69.5 8.80 46.2 70.9 2.48
SGD GPT-2 M 0.39M 66.6 8.54 44.2 68.2 2.32
scaled GD (ours) GPT-2 M 0.39M 69.2 8.71 46.3 70.9 2.48
AdamW GPT-2 M 0.39M 68.9 8.69 46.5 71.3 2.51
scaled AdamW (ours) GPT-2 M 0.39M 69.6 8.77 46.6 71.8 2.52
Table 5. Experiments for GPT-2 models with different sizes with LoRA rank r= 4on E2E NLG challenge. Our scaled optimizers behave
better than unscaled ones and scaled GD obtains scores comparable to AdamW. See Appendix E.1.2 for experimental details.
E.1.3. E XPERIMENTAL RESULTS FOR DIFFERENT DATASETS
We experiment with also WebNLG (Gardent et al., 2017) and DART (Nan et al., 2021) datasets with GPT-2 medium-size
model with LoRA rank r= 4. We use exactly the same training hyperparameters as listed in Table 3. WebNLG is a popular
dataset for data-to-text evaluation introduced by (Gardent et al., 2017) which includes 22K examples from 14 distinct
categories. Among these categories, five categories are presented only at test time and thus the evaluation is divided into
“seen” (S), “un","[0.007266325876116753, 0.023315543308854103, 0.07775364816188812, -0.059291109442710876, -0.008057577535510063, -8.412198076257482e-05, -0.013227087445557117, 0.008466390892863274, -0.02447604574263096, 0.04251657798886299, 0.009752174839377403, -0.0034452409017831087, -0.0550183542072773, -0.024106794968247414, 0.016880031675100327, -0.007457545027136803, 0.03800644725561142, -0.05132584646344185, -0.045760709792375565, 0.049453217536211014, 0.009745581075549126, -0.016721781343221664, 0.03143905848264694, 0.007279513403773308, 0.020691225305199623, -0.008189452812075615, 0.010286268778145313, 0.038454823195934296, 0.03637119382619858, -0.005443150643259287, 0.031729184091091156, -0.021996790543198586, -0.04291220381855965, -0.03602831810712814, 0.01928016170859337, 0.0019006519578397274, 0.038402073085308075, 0.021508852019906044, -0.011598427779972553, 0.019807662814855576, -0.03378643840551376, -0.030832432210445404, -0.044969458132982254, 0.02575523592531681, -0.021047288551926613, 0.010207143612205982, 0.0351579412817955, 0.009264236316084862, 0.0019303238950669765, 0.01678771898150444, -0.039852701127529144, 0.08070765435695648, -0.015192028135061264, -0.06556837260723114, 0.0052255564369261265, -0.020374726504087448, 0.021363789215683937, 0.013438087888062, 0.031650058925151825, -0.052433598786592484, -0.0018709800206124783, -0.04159345105290413, 0.06008236110210419, -0.021944040432572365, 0.004645305685698986, -0.05132584646344185, -0.0713181346654892, 0.018528472632169724, 0.011677552945911884, 0.010807176120579243, -0.004450789652764797, -0.0038375696167349815, 0.02200997807085514, -0.057761356234550476, -0.0007591068861074746, -0.011730303056538105, 0.002334191929548979, 0.0261112991720438, 0.004071648232638836, -0.02890705317258835, 0.0028089426923543215, -0.0052090720273554325, 0.0027100362349301577, -0.03652944415807724, -0.0011250607203692198, -0.05491285398602486, 0.02261660434305668, -0.044230956584215164, -0.03713607043027878, 0.015152465552091599, -0.013939213939011097, -0.03497331589460373, 0.009389517828822136, 0.010470894165337086, 0.039114199578762054, 0.009330173954367638, 0.04167257621884346, -0.000804439012426883, 0.04918946698307991, 0.0351579412817955, 0.013899651356041431, 0.01451946422457695, 0.02824767865240574, -0.014387588948011398, 0.028775177896022797, -0.019201036542654037, 0.05074559524655342, 0.0039002103731036186, -0.017513033002614975, -0.04148795083165169, -0.09099391847848892, 0.023882606998085976, -0.036212943494319916, -0.02471342124044895, 0.011248958297073841, -0.05791960656642914, -0.045839834958314896, 0.012871024198830128, -0.013635900802910328, -0.01122258324176073, -0.0115258963778615, 0.017565783113241196, 0.004625524394214153, -0.031650058925151825, 0.02644098736345768, 0.03373368829488754, 0.007925702258944511, -0.047343213111162186, 0.008921360597014427, 0.014413964003324509, 0.007694920524954796, 0.03447218984365463, 0.03972082585096359, -0.015983279794454575, -0.050376344472169876, 0.008294953033328056, -0.03494694083929062, -0.0008291656267829239, -0.02893342822790146, 0.0065047466196119785, 0.0007953725871630013, -0.03703057020902634, -0.01610196754336357, 0.049479592591524124, -0.07622389495372772, 0.01984722539782524, -0.017592158168554306, 0.0410131998360157, -0.06461887061595917, 0.027008051052689552, -0.01607559248805046, 0.016392093151807785, -0.04169895127415657, -0.029223553836345673, -0.014598589390516281, -0.014822777360677719, -0.029381804168224335, 0.02299904264509678, 0.03856032341718674, -0.03869219869375229, 0.02911805361509323, 0.04700033739209175, 0.01867353543639183, -0.004516727291047573, 0.017262469977140427, 0.048688340932130814, -0.021284664049744606, 0.01971535012125969, -0.06525187194347382, -0.042094577103853226, 0.018818598240613937, 0.004678274504840374, 0.0011687444057315588, -0.028643302619457245, -0.0038738353177905083, -0.008954329416155815, -0.05116759613156319, 0.004213414154946804, 0.01645803079009056, -0.031544558703899384, -0.018357034772634506, 0.02094178833067417, -0.04241107776761055, 0.024700233712792397, -0.05855260789394379, -0.02157478965818882, 0.00896751694381237, -0.011301708407700062, -0.010826957412064075, 0.005842073354870081, 0.022906729951500893, 0.01484915241599083, 0.11763271689414978, -0.0016863547498360276, -0.01415021438151598, -0.05135222151875496, 0.05596785619854927, 0.038454823195934296, -0.027720177546143532, 0.035500817000865936, 0.013345775194466114, 0.02674430049955845, 0.016009654849767685, -0.06810037791728973, 0.019069161266088486, -0.041936326771974564, -0.03816469758749008, -0.03518431633710861, -0.009316986426711082, -0.014690902084112167, 0.02483210898935795, 0.04911034181714058, 0.02241879142820835, -0.0077806394547224045, -0.03449856489896774, 0.010259893722832203, -0.09410617500543594, 0.022273728623986244, 0.06683437526226044, 0.04027470201253891, 0.0018891128711402416, 0.04860921576619148, -0.026124486699700356, -0.01597009226679802, -0.03333806246519089, 0.01417658943682909, 0.014994215220212936, -0.039140574634075165, -0.003389193909242749, -0.0496642179787159, 0.013952401466667652, -0.01635253056883812, -0.01938566192984581, 0.0036001941189169884, -0.005782729480415583, -0.04027470201253891, 0.04093407467007637, -0.020981350913643837, -0.021020913496613503, -0.00724654458463192, 0.00044466686085797846, 0.018607597798109055, 0.009145548567175865, -0.014242527075111866, -0.0009874159004539251, -0.0014893660554662347, 3.8300488085951656e-05, -0.027852052822709084, 0.026071736589074135, -0.014822777360677719, -0.005261822137981653, -0.03402381390333176, -0.024423295632004738, -0.05219622328877449, -0.034604065120220184, 0.018357034772634506, -0.009765362367033958, 0.025385985150933266, -0.04159345105290413, 0.0004998896038159728, -0.00965326838195324, 0.011835803277790546, 0.02132422663271427, 0.04030107706785202, -0.014018339104950428, 0.0060728550888597965, -0.022247353568673134, -0.0020539569668471813, 0.005555244628340006, -0.012211647816002369, 0.01248199213296175, -0.021350601688027382, -0.026625612750649452, 0.010635738261044025, -0.04040657728910446, -0.023275980725884438, 0.004546399228274822, 0.016523968428373337, -0.045787084847688675, -0.05517660453915596, 0.006943231914192438, 0.04251657798886299, 0.06298361718654633, 0.023697981610894203, 0.02157478965818882, 0.016260217875242233, -0.00956754945218563, -0.003880429081618786, -0.022049540653824806, -0.011176426894962788, 0.025662923231720924, -0.045787084847688675, 0.042041826993227005, -0.04697396233677864, -0.011163239367306232, -0.005565135274082422, 0.04264845326542854, -0.022537479177117348, -0.034762315452098846, -0.008242202922701836, 0.011822615750133991, 0.018119659274816513, -0.009771956130862236, 0.036239318549633026, -0.02277485467493534, 0.02491123415529728, 0.0174470953643322, 0.010906082578003407, -0.030252180993556976, 0.013457869179546833, -0.030199430882930756, 0.04987521842122078, 0.007905920967459679, 0.030779682099819183, -0.005809104535728693, -0.009099392220377922, 0.025056296959519386, -0.018093284219503403, 0.02766742743551731, -0.03528981655836105, -0.01869991049170494, -0.03212480992078781, -0.006593762431293726, 0.02299904264509678, 0.00765535794198513, 0.027298176661133766, -0.033153437077999115, 0.006333308760076761, -0.022537479177117348, -0.003006755607202649, -0.012587492354214191, 0.02433098293840885, 0.024212295189499855, 0.014334838837385178, 0.012607273645699024, 0.02485848404467106, -0.018119659274816513, 0.03903507441282272, 0.06440787017345428, 0.03328531235456467, -0.07274238765239716, -0.009804924950003624, -0.012607273645699024, 0.004816743545234203, -0.020981350913643837, 4.100495789316483e-05, -0.012224835343658924, 0.029935680329799652, 0.07274238765239716, 0.009824706241488457, -0.028880678117275238, -0.02414635755121708, -0.007279513403773308, 0.022761667147278786, -0.02346060611307621, -0.018686722964048386, 0.014005151577293873, -0.015983279794454575, -0.028115803375840187, 0.009580736979842186, -0.06773112714290619, 0.015152465552091599, -0.014427151530981064, 0.001086322357878089, -0.0017424017423763871, 0.030779682099819183, -0.02015053853392601, 0.039852701127529144, 0.022273728623986244, -0.043439704924821854, 0.013088618405163288, 0.034551315009593964, -0.04449470713734627, -0.004351883195340633, -0.0639331191778183, 0.010273081250488758, 0.02048022486269474, 0.05459635332226753, -0.012284179218113422, 0.033100686967372894, -0.0063135274685919285, 0.022115478292107582, -0.027245426550507545, -0.02745642699301243, -0.007424576207995415, 0.045101333409547806, 0.008360890671610832, 0.006630028132349253, -0.06187586486339569, -0.021587977185845375, -0.02376391924917698, -0.009099392220377922, -0.032441310584545135, 0.008743328973650932, -0.01902959868311882, 0.0170646570622921, 0.02239241637289524, 0.011347864754498005, 0.0351579412817955, 0.040564827620983124, -0.014941465109586716, 0.014057901687920094, -0.05417435243725777, -0.030674181878566742, 0.008479578420519829, 0.047237712889909744, -0.0008885095012374222, 0.05855260789394379, -0.0034782097209244967, -0.005031040869653225, -0.0298038050532341, 0.024898046627640724, 0.02843230403959751, -0.024383733049035072, 0.007055325899273157, -0.007978452369570732, 0.026295924559235573, 0.059818610548973083, 0.013860088773071766, 0.04607721045613289, -0.006475074682384729, -0.0379536971449852, -0.01648440584540367, -0.014110651798546314, -0.034735940396785736, -0.004796962253749371, 0.005617885384708643, -0.0010714863892644644, -0.018910910934209824, -0.0014753543073311448, -0.005548650864511728, 0.00032391856075264513, 0.02578161098062992, -0.05876360833644867, -0.05003346875309944, -0.003969444893300533, 0.013952401466667652, 0.06155936419963837, 0.015152465552091599, -0.015468966215848923, 0.030041180551052094, -0.012079772539436817, -0.011189614422619343, -0.02165391482412815, -0.038322947919368744, 0.02111322619020939, -0.0197417251765728, 0.005004665814340115, 0.009178517386317253, -0.038481198251247406, 0.02483210898935795, -0.027324551716446877, 0.0033479828853160143, -0.016115155071020126, -0.008868610486388206, -0.06794212758541107, 0.07453589141368866, -0.023592481389641762, 0.05649535730481148, -0.02452879585325718, 0.06024061143398285, -0.03732069581747055, -0.04336057975888252, -0.01681409403681755, -0.019121911376714706, 0.05140497162938118, 0.013266650028526783, 0.02654648758471012, 0.016985531896352768, -0.018080096691846848, 0.03964170068502426, -0.018225159496068954, -0.024818921461701393, -0.03492056578397751, -0.015046965330839157, 0.018277909606695175, 0.013068837113678455, -0.02261660434305668, 0.00688388803973794, -0.046472836285829544, 0.01226439792662859, 0.01892409846186638, 0.01709103211760521, -0.021376976743340492, 0.03431393951177597, 0.07838664948940277, 0.0410131998360157, 0.0011621506419032812, 0.00022604240803048015, -0.01412383932620287, -0.050191719084978104, -0.012950149364769459, 0.04818721488118172, -0.015073340386152267, 0.0079586710780859, -0.018792223185300827, 0.003992523066699505, -0.03365456312894821, -0.034551315009593964, -0.0008942789863795042, 0.004810149781405926, -0.034656815230846405, 0.006250886712223291, 0.012501773424446583, 0.003827678970992565, 0.0011085763107985258, -0.03492056578397751, 0.01686684414744377, 0.017302032560110092, 0.0008130933274514973, -0.015521716326475143, 0.0374525710940361, 0.004951915703713894, 0.002861692802980542, -0.0038243820890784264, 0.021917665377259254, 0.008472984656691551, 0.036925069987773895, -0.016589906066656113, 0.031623683869838715, -0.0079586710780859, -0.00803779624402523, -0.03410293906927109, -0.013121587224304676, -0.0008262808551080525, -0.012983118183910847, -0.002993568079546094, -0.09537217766046524, -0.0064421058632433414, -0.0065377154387533665, 0.023262793198227882, -0.014624964445829391, 0.00967964343726635, -0.0276410523802042, -0.04299132898449898, -0.02261660434305668, 0.03291606158018112, -0.005525572691112757, -0.04328145459294319, 0.0004739266587421298, 0.01670859381556511, 0.02830042876303196, -0.007688326761126518, -0.0009165329392999411, 0.013141368515789509, -0.005851964000612497, 0.0313335582613945, -0.012383085675537586, 0.002434746827930212, 0.015930529683828354, 0.05892185866832733, -0.037188820540905, 0.0359228178858757, -0.02004503831267357, -0.027772927656769753, -0.017644908279180527, 0.007582826539874077, 0.02545192278921604, -0.00970601849257946, 0.03784819692373276, 0.01910872384905815, -6.161046621855348e-05, 0.024673858657479286, -0.005855260882526636, -0.020823100581765175, 0.036845944821834564, 0.009442267939448357, 0.010174175724387169, 0.011453364975750446, 0.0189768485724926, -0.020348351448774338, 0.017288845032453537, 0.019728537648916245, 0.006676184479147196, -0.007615795359015465, -0.024027669802308083, 0.03587006777524948, 0.02394854463636875, 0.015244778245687485, 0.029249928891658783, -0.03062143176794052, -0.011394021101295948, -0.013899651356041431, -0.002314410638064146, -0.0672563761472702, 0.005258525256067514, 0.013154556043446064, -0.012369898147881031, -0.006267371121793985, 0.02692892588675022, 0.03449856489896774, -0.020598912611603737, 0.02967192977666855, -0.010095050558447838, -0.009666455909609795, -0.02570248581469059, 0.008868610486388206, -0.016853656619787216, -0.021350601688027382, -0.026889363303780556, 0.02843230403959751, -0.014216152019798756, -0.008070765063166618, -0.009171923622488976, -0.008624641224741936, 0.02078353799879551, -0.00422330480068922, 0.0226693544536829, 0.002955653937533498, -0.033153437077999115, 0.006557496730238199, -0.012831461615860462, -0.028115803375840187, -0.003916694782674313, -0.031096182763576508, -0.020651662722229958, -0.015851404517889023, 0.0037617413327097893, 0.03790094703435898, -0.02261660434305668, -0.007833389565348625, -0.019939538091421127, -0.01796140894293785, -0.021376976743340492, -0.0006123956991359591, -0.00022789690410718322, 0.015363465994596481, -0.015244778245687485, -0.016827281564474106, 0.025095859542489052, -0.029197178781032562, -0.018146034330129623, 0.01982085034251213, -0.01376777607947588, 0.012059991247951984, -0.0054332599975168705, -0.010286268778145313, 0.0011860530357807875, -0.0020539569668471813, -0.010477487929165363, 0.008901579305529594, 0.008057577535510063, -0.005153025034815073, -0.018475722521543503, 0.013701838441193104, -0.03557994216680527, 0.019557099789381027, -0.013899651356041431, 0.0016187686705961823, -0.01289080549031496, -0.02616404928267002, -0.0320984348654747, 0.022959480062127113, 0.036951445043087006, 0.001745698624290526, 0.017209719866514206, -0.013240274973213673, -0.008782891556620598, -0.02022966369986534, 0.01717015728354454, -0.059976860880851746, -0.00787295214831829, -0.00015155351138673723, -0.004536508582532406, 0.028168553486466408, 0.02392216958105564, 0.024423295632004738, 0.03734707087278366, -0.006564090494066477, -0.02149566449224949, 0.03892957419157028, -0.019992288202047348, 0.04607721045613289, -0.012462210841476917, 0.0219044778496027, -0.036872319877147675, -0.034735940396785736, -0.028854303061962128, -0.0020869257859885693, 0.0174470953643322, -0.0394834503531456, 0.0359228178858757, -0.048820216208696365, -0.022128665819764137, -0.002322652842849493, -0.00548930699005723, -0.0040782419964671135, -0.012257804162800312, -0.0035837097093462944, 0.003214459167793393, -0.01006208173930645, 0.002459473442286253, -0.008591672405600548, -0.0014349675038829446, 0.007714701816439629, 0.03937795013189316, -0.008618047460913658, 0.054754603654146194, -0.011051145382225513, -0.05570410564541817, -0.019596662372350693, 0.02455517090857029, -0.022933105006814003, 0.016853656619787216, -0.029645554721355438, -0.0008336988394148648, -0.018779035657644272, 0.0017391048604622483, 0.0417780764400959, -0.0504290945827961, 0.000522555666975677, 0.0026506923604756594, -0.008545516058802605, 0.010391768999397755, -0.03344356268644333, -0.0016014600405469537, 0.019557099789381027, 0.0024446374736726284, -0.013715025968849659, -0.001753940829075873, -0.031755559146404266, -0.00869717262685299, -0.008730141445994377, 0.011914928443729877, 0.006234402302652597, 0.0055618383921682835, -0.005697010550647974, 0.031017057597637177, -0.026506925001740456, -0.011407208628952503, 0.031043432652950287, 0.03895594924688339, 0.013978776521980762, 0.013154556043446064, -0.004536508582532406, 0.03059505671262741, -0.0025979422498494387, 0.004780477844178677, -0.001592393615283072, 0.023724356666207314, 0.020572537556290627, -0.037558071315288544, -0.03341718763113022, 0.0016698703402653337, -0.009851081296801567, -0.01422933954745531, 0.015192028135061264, 0.03405018895864487, -0.0031617090571671724, -0.0028204817790538073, -0.01763172075152397, 0.011202801950275898, -0.01752622053027153, 0.0001392932317685336, -0.007582826539874077, -0.019899975508451462, 0.023289168253540993, 0.021179163828492165, -0.006659700069576502, 0.01571952924132347, 0.016497593373060226, 0.01561402902007103, -0.024344170466065407, 0.010358800180256367, -0.00015495342086069286, -0.01749984547495842, -0.012791899032890797, -0.004084835760295391, -0.021944040432572365, 0.012600679881870747, -0.03402381390333176, -0.007160825654864311, 0.019649412482976913, 0.009607112035155296, 0.04853009060025215, -0.04003732651472092, 0.03571181744337082, -0.014730464667081833, 0.02017691358923912, 0.02015053853392601, -0.014374401420354843, -0.010826957412064075, 0.013174337334930897, -0.006722340825945139, 0.0126732112839818, 0.010859926231205463, -0.0021495665423572063, 0.007450951263308525, -0.013128180988132954, -0.03816469758749008, -0.03270506113767624, 0.009303798899054527, 0.0034518346656113863, 0.03478869050741196, 0.03254681080579758, 0.041197825223207474, -0.05211709812283516, -0.10423419624567032, -0.02580798603594303, 0.017684470862150192, -0.016721781343221664, 0.005265119019895792, -0.008400453254580498, 0.021561602130532265, 0.031069807708263397, -0.006877294275909662, 0.007839983329176903, 0.051035720854997635, -0.06820587813854218, -0.019557099789381027, -0.020612100139260292, 0.023117730394005775, -0.0580778568983078, -0.0009799979161471128, -0.02149566449224949, 0.03138630837202072, -0.011110489256680012, 0.003184787230566144, -0.0023506763391196728, -0.0040782419964671135, -0.012818274088203907, -0.020190101116895676, -0.012679805047810078, 0.020598912611603737, 0.014598589390516281, 0.030700556933879852, -0.0041112108156085014, -0.007233357056975365, 0.018831785768270493, 0.05755035579204559, 0.006943231914192438, -0.04984884336590767, -0.00565415108576417, -0.0036661317571997643, 0.006831137929111719, 0.013596338219940662, 0.009989550337195396, 0.017367970198392868, -0.0162997804582119, 0.011011582799255848, -0.01864716038107872, 0.018422972410917282, -0.013233681209385395, 0.005347541067749262, -0.018502097576856613, -7.227381865959615e-05, 0.0050870878621935844, 0.04156707599759102, 0.03710969537496567, -0.008815860375761986, -0.0011143458541482687, 0.019372474402189255, -0.027720177546143532, 0.0162997804582119, -0.027298176661133766, 0.00782020203769207, -0.013424900360405445, 0.01484915241599083, 0.01908234879374504, -0.019266974180936813, -0.015429403632879257, -0.03589644283056259, -0.021944040432572365, 0.018462534993886948, 0.002736411290243268, -0.005423369351774454, -0.04918946698307991, -0.002180886920541525, 0.029355429112911224, -0.0049585094675421715, -0.016247030347585678, -0.019886787980794907, -0.0037287725135684013, 0.009982956573367119, 0.03863944858312607, -0.04114507511258125, 0.020137351006269455, 0.022853979840874672, -0.005364025477319956, -0.012356710620224476, -0.005525572691112757, 0.017262469977140427, 0.01043133158236742, 0.028696052730083466, -0.04019557684659958, -0.011994053609669209, 0.011703928001224995, 0.04618271067738533, 0.005420072469860315, -0.00362327229231596, 0.02409360744059086, -0.026665175333619118, -0.017407532781362534, 0.0290389284491539, 0.01141380239278078, 0.011657771654427052, -0.006963013205677271, -0.008664203807711601, 0.01291718054562807, -0.04618271067738533, 0.001078080153092742, 0.011914928443729877, 0.0035968972370028496, 0.021772602573037148, 0.004154070280492306, 0.03513156622648239, -0.021587977185845375, 0.02761467732489109, 0.03128080815076828, 0.0070487321354448795, 0.01300289947539568, -0.020110975950956345, 0.015838216990232468, 0.05454360321164131, 0.016154717653989792, 0.025610173121094704, 0.0033826001454144716, 0.011453364975750446, -0.004229898564517498, 0.018581222742795944, 0.05306660011410713, -0.015350278466939926, 0.02583436109125614, 0.002156160306185484, 0.011545677669346333, -0.04053845256567001, 0.0041573671624064445, 0.020770350471138954, 0.026375049725174904, 0.012607273645699024, 0.020678037777543068, -0.02040109969675541, 0.01215230394154787, 0.05417435243725777, -0.015112902969121933, -0.018040534108877182, 0.010899488814175129, 0.020849475637078285, 0.0016385499620810151, 0.028089428320527077, -0.007905920967459679, 0.030252180993556976, 0.011446771211922169, -0.019319724291563034, -0.04744871333241463, 0.006524527911096811, 0.02409360744059086, 0.020598912611603737, -0.026599237695336342, -0.009468642994761467, 0.013279837556183338, 0.024739796295762062, 0.02906530350446701, -0.021640727296471596, 0.011512708850204945, -0.012402866967022419, 0.01417658943682909, 0.01785590872168541, 0.03505244106054306, 0.0018610893748700619, 0.02414635755121708, 0.041276950389146805, -0.031676433980464935, -0.014216152019798756, 0.0020045037381350994, -0.0060728550888597965, 0.02015053853392601, -0.031043432652950287, -0.018686722964048386, 0.03215118497610092, 0.03481506556272507, 0.027298176661133766, -0.0066662938334047794, 0.028854303061962128, 0.0002864165580831468, -0.0075234826654195786, 0.04038020223379135, -0.017262469977140427, 0.005502494517713785, 0.00033916663960553706, -0.010523644275963306, 0.02845867909491062, -0.04301770403981209, -0.007279513403773308, -0.018554847687482834, -0.005007962696254253, 0.045074958354234695, -0.00252211419865489, 0.02559698559343815, 0.020031850785017014, -0.0016739914426580071, 0.03631844371557236, -0.04615633562207222, 0.024845296517014503, -0.0015561279142275453, -0.0013665572041645646, -0.030252180993556976, -0.04088132455945015, 0.01637890562415123, 0.011967678554356098, -0.021640727296471596, -0.028089428320527077, 0.015956904739141464, 0.0023589185439050198, -0.022788042202591896, -0.029487304389476776, 0.007998233661055565, 0.02895980328321457, 0.04167257621884346, 0.01045770663768053, -0.010662113316357136, 0.018713098019361496, 0.005931089166551828, -0.0029408179689198732, 0.01684046909213066, -0.006250886712223291, -0.04325507953763008, -0.026282737031579018, 0.013926026411354542, 0.003206216963008046, 0.01422933954745531, -0.011255552060902119, 0.06810037791728973, 0.010200549848377705, -0.01492827758193016, 0.014282088726758957, 0.01872628554701805, 0.002670473651960492, -0.011341270990669727, -0.036186568439006805, 0.001289080479182303, 0.015046965330839157, -0.04093407467007637, -0.011136864311993122, 0.03499969094991684, 0.007938889786601067, 0.009910425171256065, 0.034762315452098846, -0.0025600281078368425, 0.004533211700618267, -0.017644908279180527, 0.020572537556290627, 0.02967192977666855, 0.017354782670736313, 0.023368293419480324, -0.029460929334163666, 0.01021373737603426, 0.015468966215848923, -0.012409460730850697, 0.010675300844013691, -0.02058572508394718, 0.026309112086892128, 0.02302541770040989, 0.030726931989192963, 0.03782182186841965, 0.03478869050741196, 0.031017057597637177, -0.02845867909491062, 0.03186105936765671, 0.022814417257905006, -0.02313091792166233, 0.02239241637289524, -0.027166301384568214, 0.02269572950899601, -0.00024170259712263942, 0.02373754419386387, 0.020796725526452065, -0.029170803725719452, 0.029935680329799652, 0.02020328864455223, 0.034551315009593964, 0.0034848034847527742, 0.0030496150720864534, 0.06488262116909027, -0.003956257365643978, 0.03927244991064072, -0.0006148683605715632, -0.019557099789381027, -0.016167905181646347, 0.02025603875517845, 0.006758606527000666, 0.03275781124830246, -0.03932520002126694, -0.015811841934919357, -0.0017011907184496522, 0.050218094140291214, 0.023908982053399086, 0.0018627378158271313, 0.04098682478070259, -0.024106794968247414, -0.00015248075942508876, 0.008716953918337822, 0.016563531011343002, 0.012805086560547352, 0.0005423369584605098, 0.037584446370601654, -0.03874494880437851, 0.01678771898150444, -0.01250836718827486, 0.002678715856745839, -0.056284356862306595, 0.027799302712082863, 0.015772279351949692, 0.008004827424883842, -0.05491285398602486, -0.008334515616297722, 0.01171711552888155, -0.008974110707640648, -0.004536508582532406, 0.014400776475667953, 0.031729184091091156, 0.0087235476821661, -0.007741076871752739, -0.010833551175892353, 0.011789646930992603, 0.0012264398392289877, -0.013391931541264057, 0.03254681080579758, 0.0007636400987394154, -0.0005806632107123733, 0.010207143612205982, -0.013101805932819843, 0.01185558456927538, -0.030937932431697845, -0.005739870015531778, 0.005782729480415583, 0.019240599125623703, 0.03146543353796005, -0.014163401909172535, -0.019372474402189255, 0.03858669847249985, -0.02157478965818882, -0.010958832688629627, -0.022814417257905006, -0.024067232385277748, -0.02220779098570347, -0.029276303946971893, 0.024647483602166176, 0.012706180103123188, 0.001447330811060965, -0.029935680329799652, -0.012633648701012135, 0.03299518674612045, 0.006613543722778559, 0.01157864648848772, 0.030726931989192963, 0.027720177546143532, 0.07163463532924652, 0.017565783113241196, -0.035474441945552826, 0.023882606998085976, -0.0018973550759255886, 0.048002589493989944, 0.00532446289435029, -0.04159345105290413, -0.023684794083237648, 0.027403676882386208, 0.022682541981339455, 0.004480461589992046, -0.04262207821011543, -0.004506836645305157, 0.007206982001662254, -0.0029012553859502077, -0.024106794968247414, 0.004490352235734463, 0.020137351006269455, 0.014598589390516281, 0.006897075567394495, 0.0030446697492152452, -0.015825029462575912, -0.0009560955222696066, -0.003985929302871227, 0.01823834702372551, 0.014387588948011398, 0.010398362763226032, 0.04148795083165169, 0.05865810811519623, -0.01971535012125969, -0.00264904391951859, -0.01892409846186638, 0.023777106776833534, -0.01484915241599083, 0.014427151530981064, -0.011710521765053272, 0.03724157065153122, 0.0027166299987584352, 0.008683985099196434, 0.007971858605742455, 0.013873276300728321, -0.000656903546769172, 0.021798977628350258, -0.021693477407097816, 0.00028435600688681006, 0.03631844371557236, -0.024185920134186745, -0.017236094921827316, -0.0023407856933772564, 0.004193632863461971, -0.013583150692284107, -0.006066261325031519, -0.0007393255946226418, 0.021640727296471596, 0.0026210204232484102, -0.011077520437538624, 0.029276303946971893, 0.013728213496506214, 0.011459958739578724, -0.01711740717291832, -0.0027792707551270723, -0.004098023287951946, 0.02154841460287571, -0.026243174448609352, -0.04454745724797249, -0.000540276407264173, 0.008083952590823174, -0.002197371330112219, -0.012027022428810596, -0.021759415045380592, -0.004899165593087673, -0.02050659991800785, -0.03352268785238266, 0.022484729066491127, 0.009455455467104912, -0.02506948448717594, 0.002268254291266203, 0.027430051937699318, 0.059080109000205994, -0.02392216958105564, -0.015350278466939926, -0.017302032560110092, 0.00614538649097085, -0.022273728623986244, -0.008103733882308006, 0.022141853347420692, -0.004889274947345257, -0.042885828763246536, -0.018581222742795944, 0.012007241137325764, 0.013325993902981281, 0.007952077314257622, 0.006752012763172388, -0.024924421682953835, 0.01176986563950777, -0.013009493239223957, -0.0007933120359666646, 0.013187524862587452, -0.00540688494220376, -0.007582826539874077, 0.008525734767317772, -0.023051792755723, 0.0207571629434824, 0.0032655608374625444, 0.022933105006814003, -0.012567711062729359, -0.023144105449318886, 0.011215989477932453, 0.015561278909444809, 0.014374401420354843, 0.0003035191330127418, 0.037004195153713226, 0.018884535878896713, -0.0010294511448591948, 0.03346993774175644, 0.01487552747130394, 0.06583212316036224, -0.0018891128711402416, -0.004378258250653744, 0.01645803079009056, 0.0364239439368248, 0.00762898288667202, 0.00932358019053936, -0.01111708302050829, 0.02830042876303196, 0.0020506600849330425, -0.020295601338148117, -0.017644908279180527, 0.01979447528719902, -0.002164402510970831, -0.01594371721148491, -0.004035382531583309, 0.009574143216013908, 0.029355429112911224, 0.0348941907286644, -0.00023964204592630267, -0.02050659991800785, -0.014057901687920094, -0.02562336064875126, 0.02901255339384079, 0.02545192278921604, -0.01384690124541521, 0.016392093151807785, 0.02025603875517845, -0.0226693544536829, 0.008486172184348106, -0.015521716326475143, -0.011150051839649677, -0.01763172075152397, -0.008862016722559929, -0.01223802287131548, -0.013873276300728321, 0.01422933954745531, -0.008782891556620598, -0.011466552503407001, 0.009593924507498741, -0.05575685575604439, 0.012660023756325245, -0.00760260783135891, 0.0046551963314414024, -0.004632118158042431, -0.0019913162104785442, 0.022181415930390358, 0.045787084847688675, -0.004609039984643459, 0.001907245721668005, 0.023302355781197548, 0.004091429524123669, 0.006468480918556452, 0.021864915266633034, 0.02348698116838932, 0.020823100581765175, 0.04618271067738533, -0.005532166454941034, -0.014717277139425278, -0.0013747994089499116, 0.02613767422735691, -0.019227411597967148, 0.017315220087766647, -0.0031089589465409517, -0.018106471747159958, -0.0023506763391196728, -0.006432215217500925, -0.024950796738266945, 0.013325993902981281, 0.022577041760087013, -0.011084114201366901, -0.015825029462575912, 0.0037386631593108177, 0.008281765505671501, -0.02463429607450962, 0.0005641788011416793, 0.004009007476270199, 0.006422324571758509, 0.05056096985936165, 0.036239318549633026, 0.015218403190374374, 0.018581222742795944, 0.006484965328127146, -0.019187849014997482, -0.011868772096931934, 0.0017720736796036363, -0.007266325876116753, -0.007549857720732689, 0.04011645168066025, 0.010081863030791283, 0.006949825678020716, 0.023803481832146645, -0.007239950820803642, 0.008829047903418541, -0.010879707522690296, 0.008624641224741936, 0.041382450610399246, 0.0036265691742300987, -0.03708332031965256, -0.003893616609275341, 0.005875042174011469, -0.006049776915460825, -0.011598427779972553, 0.028616927564144135, -0.011090707965195179, 0.019965913146734238, -0.00430572684854269, -0.017130594700574875, 0.00015248075942508876, 0.011183020658791065, 0.01910872384905815, 0.014888714998960495, 0.04525958374142647, 0.016774531453847885, -0.030832432210445404, -0.003748553805053234, 0.011394021101295948, 0.0021792384795844555, -7.361317693721503e-05, -0.006597059313207865, 0.0014440339291468263, 0.017183344811201096, -0.012851242907345295, -0.022761667147278786, 0.02353973127901554, 0.01457221433520317, 0.016603093594312668, -0.032414935529232025, 0.036951445043087006, -0.006517934147268534, 0.0034353502560406923, -0.029249928891658783, -0.0038540540263056755, 0.00046362390276044607, -0.022840792313218117, -0.005014556460082531, -0.045101333409547806, -0.013556775636970997, -0.0054662288166582584, -0.007688326761126518, -0.01637890562415123, 0.017262469977140427, 0.005921198520809412, -0.022431978955864906, -0.0298038050532341, 0.017486657947301865, -0.009277423843741417, 0.01815922185778618, 0.02427823282778263, -0.005525572691112757, 0.004859603010118008, -0.015904154628515244, -0.0048134466633200645, -0.005667338613420725, 0.026625612750649452, 0.00587174529209733, -0.02055935002863407, -0.021891290321946144, 0.016286592930555344, 0.0035441473592072725, 0.02824767865240574, -0.006630028132349253, -0.03059505671262741, -0.0126732112839818, -9.571258124196902e-05, -0.031544558703899384, -0.014888714998960495, -0.0011473146732896566, 0.030753307044506073, -0.03663494437932968, -0.010464300401508808, 0.012772117741405964, 0.011796240694820881, -0.049532342702150345, 0.012020428664982319, -0.004101320169866085, -0.022484729066491127, 0.003847460262477398, 0.03135993331670761, 0.0031501699704676867, -0.012488585896790028, -0.014717277139425278, 0.03671406954526901, -0.010556613095104694, -0.0018264721147716045, -0.012554523535072803, -0.007385013625025749, 0.025201359763741493, 0.020849475637078285, 0.011585240252315998, 0.02376391924917698, -0.016721781343221664, 0.00965326838195324, 0.014743652194738388, 0.0011662717442959547, 0.0022550667636096478, 0.04220007732510567, 0.005733276251703501, 0.017130594700574875, -0.009356549009680748, 0.04678933694958687, -0.023236418142914772, 0.024383733049035072, -0.03874494880437851, -0.005268415901809931, -0.02657286264002323, -0.009646674618124962, 0.022405603900551796, 0.03792732208967209, -0.027931177988648415, 0.015811841934919357, 0.018093284219503403, 0.005851964000612497, 0.03964170068502426, 0.0021924260072410107, 0.04552333429455757, -0.001745698624290526, 0.006250886712223291, 0.033258937299251556, -0.006686075124889612, 0.022458354011178017, 0.017236094921827316, -0.020954975858330727, -0.055545855313539505, 0.012798492796719074, 0.0174470953643322, -0.013926026411354542, -0.01905597373843193, 0.012528148479759693, -0.004325508140027523, -0.04169895127415657, -0.009633487090468407, -0.016471218317747116, 0.026124486699700356, 0.022049540653824806, 0.024726608768105507, -0.0027215753216296434, 0.022880354896187782, 0.032414935529232025, -0.003554038004949689, -0.026981675997376442, -0.048714715987443924, -0.02975105494260788, -0.012844649143517017, 0.009949987754225731, 0.042120952159166336, 0.024423295632004738, -0.004427711479365826, 0.003910101018846035, 0.014677714556455612, -0.003669428639113903, 0.0050541190430521965, 0.015956904739141464, 0.0003978923487011343, 0.02351335622370243, -0.0027891614008694887, 0.00839385949075222, -0.028142178431153297, 0.008578484877943993, -0.016207467764616013, -0.02748280204832554, 0.04523320868611336, 0.01561402902007103, 0.008921360597014427, 0.003097419859841466, -0.011321489699184895, -0.007352044805884361, -0.0075234826654195786, 0.01665584370493889, -0.004915650002658367, 0.024818921461701393, 0.00888839177787304]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
"seen” (U), “all” (A) three types depending on whether the five categories are included in test time or not.
DART is another data-to-text dataset introduced by (Nan et al., 2021) which involves 82K examples. The evaluation metrics
being used are BLEU, MET, and TER with higher scores being better for first two metrics and the lower the better for TER.
The experimental result is presented in Table 6 and we observe that scaled GD significantly improves SGD performance for
both datasets on all evaluation metrics, and so does scaled AdamW for AdamW.
22
Riemannian Preconditioned LoRA
MethodDART WebNLG
BLEU↑MET↑TER↓BLEU↑ MET↑ TER↓
U S A U S A U S A
SGD 43.2 .36 .50 45.5 58.1 52.4 .36 .42 .39 .45 .36 .40
scaled GD (ours) 46.1 .38 .48 46.3 61.7 54.8 .37 .44 .41 .45 .34 .39
AdamW 47.1 .38 .47 45.0 64.1 55.5 .38 .45 .42 .47 .32 .39
scaled AdamW (ours) 47.9 .39 .47 46.8 64.2 56.3 .38 .45 .42 .46 .32 .38
Table 6. Experiments for GPT-2 medium model on NLG challenge with DART dataset and WebNLG dataset. Our scaled optimizers
improve unscaled optimizers uniformly on all evaluation metrics for both datasets. See Appendix E.1.3 for experiment, datasets, and
metric details.
E.2. Mistral 7B
Mistral 7B is a pretty new model up-to-date and there is no well-established code base we can follow. For quicker training,
we use 4-bit quantized version of Mistral 7B V0.1 as our base model and LoRA factors are injected to each linear layer
with rank r= 16.We train for 5total epochs with batch size 8. For fine-tuning 4-bit quantized Mistral 7B V0.1 model for
GLUE benchmark, we exploit HuggingFace transformers trainer class. All training arguments are default there except for
the batch size, training epoch, and optimizer-related settings which are customized for our experiments. See Table 7 for
training hyperparameter choices. The β’s and ϵfor AdamW-type methods are defaultly used in original LoRA project (Hu
et al., 2021). For learning rate choices, we view that values ranging from 2e−5to2e−4have been empirically used for
fine-tuning Mistral 7B for other tasks. We follow (Labonne, 2024) and set lr= 5e−5for AdamW-type methods. For
larger datasets including mnli, qnli, and qqp, lr= 5e−5results in NaN loss thus we tune learning rate individually with
grid search for each method. Since SGD has never been used for training Mistral 7B, we empirically find lr= 5e−3to
be a reasonable learning rate. For larger datasets including mnli, qnli, and qqp, we still tune the learning rate with grid
search. Learning rate scheduler, warmup steps, warmup ratios, and max grad norm are all default in HuggingFace trainer
class. Weight decay value 0.01is what has been used in original LoRA project for GPT-2 fine-tuning. We use the same
LoRA-related parameters and model quantization configuration as in (Labonne, 2024).
Method SGD scaled GD AdamW scaled AdamW
train batch size 8
seed (default) 42
AdamW (β1, β2) / (0.9,0.999)
AdamW ϵ / 1e−6
lr 5e−3 5 e−5
lr (mnli) 5e−3 1 e−3 5 e−6 3 e−5
lr (qqp) 5e−3 4 e−3 5 e−6 3 e−5
lr (qnli) 5e−3 9 e−4 1 e−5
lr scheduler linear
num epoch 5
warmup steps &warmup ratios 0
weight decay 0.01
max grad norm 1
LoRA rank 16
LoRA α 16
LoRA dropout","[-0.01455453597009182, 0.02279609441757202, 0.08058412373065948, -0.04831162467598915, -0.0004708718624897301, -0.003272689413279295, -0.007457639090716839, 0.011210738681256771, -0.028470836579799652, 0.03715638443827629, 0.011890598572790623, 0.016802234575152397, -0.04631367325782776, -0.009226660244166851, 0.019077681005001068, 0.004949790891259909, 0.010905495844781399, -0.038432855159044266, -0.04686865955591202, 0.03837735578417778, 0.022671222686767578, -0.013784491457045078, -0.011876723729074001, 0.026958497241139412, -0.005234221927821636, -0.007887753657996655, 0.03210600093007088, 0.0178705845028162, 0.023004215210676193, -0.011120554059743881, 0.023295583203434944, -0.02371182292699814, -0.004668829031288624, -0.02078426629304886, 0.016025252640247345, 0.025460032746195793, 0.0361296571791172, 0.020159905776381493, -0.0469241589307785, 0.014485162682831287, -0.050059836357831955, -0.10433757305145264, -0.030552038922905922, 0.014304791577160358, -0.015858756378293037, 0.014526787213981152, 0.030191296711564064, 0.048727866262197495, -0.0002835637133102864, 0.017162974923849106, -0.02751348353922367, 0.05372275039553642, -0.040403060615062714, 0.00397162651643157, 0.03193950653076172, -0.017745712772011757, 0.029247818514704704, 0.01938292384147644, 0.012750827707350254, -0.0392930842936039, 0.0038398168981075287, -0.017162974923849106, 0.05438873544335365, -0.03665689751505852, 0.008664735592901707, -0.027541233226656914, -0.0797516405582428, 0.004759014118462801, 0.004318493418395519, 0.03787786886096001, -0.0017828959971666336, 0.0016380790621042252, 0.03249449282884598, -0.07952965050935745, -0.011550668627023697, -0.005747585091739893, 0.02174161933362484, 0.057441163808107376, -0.0022251512855291367, -0.01795383170247078, -0.004193621221929789, -0.016330495476722717, 0.013860802166163921, -0.041735026985406876, -0.029636310413479805, -0.06332402676343918, -0.033215977251529694, -0.03404845669865608, -0.00940009392797947, -0.008720234036445618, -0.008852044120430946, -0.02827659249305725, -0.027999097481369972, 0.008956103585660458, 0.049282852560281754, -0.02430843375623226, 0.056192442774772644, -0.018605941906571388, 0.04015331342816353, 0.023420454934239388, 0.025196412578225136, 0.003565791994333267, 0.016580238938331604, -0.009809396229684353, 0.030302293598651886, 0.00026643715682439506, 0.0038571602199226618, 0.01398567482829094, -0.0392930842936039, 0.02344820462167263, -0.06609895825386047, 0.015054024755954742, -0.05191904306411743, -0.009802459739148617, 0.007762881927192211, -0.05580395087599754, -0.04492620378732681, 0.007901628501713276, -0.009788584895431995, -0.011543731205165386, -0.036906640976667404, 0.002684749895706773, -0.0006620822241529822, -0.01333356462419033, 0.029913803562521935, 0.017939956858754158, 0.0353526771068573, -0.04981008917093277, 0.020631644874811172, 0.031051527708768845, 0.012480271980166435, 0.03848835453391075, 0.04426021873950958, -0.01567838527262211, -0.02570977620780468, -0.02059002034366131, -0.019341299310326576, 0.003314313478767872, -0.01795383170247078, -0.007478450890630484, 0.011259300634264946, -0.03371546417474747, -0.016774484887719154, 0.041540782898664474, -0.07625522464513779, 0.018592067062854767, -0.021908115595579147, 0.03216150030493736, -0.05227978155016899, 0.02079814113676548, -0.010600253008306026, -0.001798504963517189, -0.02011828124523163, -0.02844308689236641, 0.022532476112246513, -0.026445133611559868, -0.01816195249557495, 0.010385195724666119, 0.0051613799296319485, -0.02040964923799038, 0.01185591146349907, 0.055165715515613556, 0.007072616368532181, -0.027915850281715393, 0.03812761232256889, 0.038238611072301865, -0.04631367325782776, 0.003182504093274474, -0.08541250973939896, -0.03410395607352257, 0.022518601268529892, -0.015511889010667801, -0.01427704282104969, -0.04348323866724968, -0.013770616613328457, -0.026209264993667603, -0.0339929573237896, -0.0031998474150896072, 0.0015305503038689494, -0.028942575678229332, -0.008248495869338512, -0.003565791994333267, -0.03901559114456177, 0.014443539083003998, -0.06504448503255844, -0.02496054396033287, -0.022837718948721886, -0.009018540382385254, 0.006222792435437441, 0.042401012033224106, 0.037184134125709534, -0.0011828162241727114, 0.10816698521375656, -0.017232349142432213, -0.004564768634736538, -0.03268874064087868, 0.05888412892818451, 0.02003503404557705, -0.02125600539147854, 0.0032987045124173164, 0.006854090373963118, 0.03610191121697426, 0.02676425129175186, -0.08618949353694916, 0.013222566805779934, -0.006580065470188856, -0.02239372953772545, -0.04531469568610191, -0.005640055984258652, -0.005487434566020966, 0.033215977251529694, 0.0355469211935997, 0.0060979207046329975, -0.01682998239994049, -0.06393451243638992, 0.03840510547161102, -0.05955011397600174, 0.027069494128227234, 0.05030957981944084, 0.051586050540208817, -0.0035276366397738457, 0.03232799842953682, -0.01209178101271391, 0.01096793171018362, -0.033798713237047195, -0.002511316444724798, 0.037378378212451935, -0.03751712664961815, 0.0007500997162424028, -0.023573076352477074, -0.000920064514502883, 0.009663712233304977, -0.008290119469165802, -0.014804280363023281, 0.043344490230083466, -0.036157406866550446, 0.03196725621819496, -0.05444423109292984, -0.011737977154552937, 0.0017299987375736237, -0.008290119469165802, 0.007742069661617279, 0.0138469273224473, -0.028401464223861694, 0.01116217765957117, 0.011599229648709297, -0.023850569501519203, -0.05408349260687828, 0.030579788610339165, -0.012632893398404121, -0.00451620714738965, -0.03818311169743538, -0.012070968747138977, -0.03907109051942825, -0.03099602833390236, 0.021436376497149467, -0.013812241144478321, 0.017509842291474342, -0.04933835193514824, 0.004856137093156576, -0.017038103193044662, -0.00727726798504591, 0.03304947912693024, 0.05993860587477684, -0.015747757628560066, 0.009982829913496971, -0.03848835453391075, 0.00926828384399414, 0.006122201215475798, -0.02570977620780468, -0.013937112875282764, -0.015567387454211712, -0.01209871843457222, -0.003815536154434085, -0.012043219991028309, -0.025876272469758987, 0.046729911118745804, 0.009393156506121159, -0.040042318403720856, 0.0010449365945532918, -0.000979031901806593, 0.02163062058389187, 0.04997658729553223, 0.009892644360661507, 0.025099290534853935, 0.04056955501437187, -0.010045265778899193, 0.00987183302640915, -0.009344594553112984, 0.005660868249833584, 0.015442515723407269, -0.036074161529541016, 0.08147210627794266, -0.042012520134449005, -0.015137272886931896, 0.012077906168997288, 0.013867739588022232, -0.013506998308002949, -0.03224474936723709, -0.020923012867569923, 0.050059836357831955, 0.02478017285466194, -0.03185625746846199, 0.004748607985675335, 0.012299900874495506, 0.014471287839114666, 0.0465356670320034, 0.01936904899775982, -0.019452296197414398, 0.02977505698800087, -0.03213375061750412, 0.0402643121778965, -0.007700445596128702, 0.03565791994333267, 0.00522381579503417, -0.02099238708615303, 0.017717963084578514, 0.00941396877169609, 0.0345756933093071, -0.06021609902381897, -0.014485162682831287, -0.08546800911426544, -0.0013996080961078405, 0.005830833222717047, 0.010905495844781399, -0.006451725028455257, -0.03726738318800926, -0.031995005905628204, -0.018494945019483566, -0.020270902663469315, 0.005088537931442261, -0.0001524046529084444, 0.052307531237602234, 0.0009504153858870268, 0.0034426541533321142, 0.02097851224243641, -0.026694878935813904, 0.014152170158922672, 0.05466622859239578, 0.017523717135190964, -0.08380305022001266, -0.031079275533556938, 0.012827138416469097, -0.024141937494277954, -0.055720701813697815, -0.0030264139641076326, 0.003184238448739052, -0.030052550137043, 0.07053885608911514, 0.033326972275972366, -0.03696214035153389, -0.03207825496792793, -0.01616399921476841, -0.01451291237026453, -0.028040722012519836, -0.003430513897910714, 0.049754589796066284, -0.00413812231272459, -0.01757921651005745, 0.021699994802474976, -0.0663764551281929, 0.057330165058374405, -0.023087462410330772, -0.018078703433275223, 0.00926134642213583, 0.025598779320716858, 0.0018730814335867763, 0.020021159201860428, 0.021616747602820396, -0.06498898565769196, 0.015345392748713493, 0.033410221338272095, -0.02570977620780468, -0.009296033531427383, -0.040847048163414, 0.004755545407533646, 0.03995906934142113, 0.044759709388017654, 0.006628626957535744, 0.02977505698800087, 0.02128375507891178, 0.017537591978907585, 0.004276869352906942, -0.0169964786618948, -0.0023725698702037334, 0.009393156506121159, 0.02522416226565838, 0.017135225236415863, -0.028526335954666138, -0.03696214035153389, -0.009753897786140442, -0.010655752383172512, -0.036351654678583145, 0.01181428786367178, 0.009573526680469513, 0.02108950912952423, 0.002075998578220606, 0.020423524081707, 0.036434900015592575, 0.03524167835712433, -0.003957751672714949, -0.017704088240861893, -0.055526457726955414, -0.02533516101539135, -0.014693282544612885, 0.046729911118745804, -0.008609237149357796, 0.08308156579732895, 0.009844083338975906, -0.004894292447715998, -0.01728784665465355, -0.013978737406432629, 0.05072581768035889, -0.022546350955963135, 0.010177075862884521, -0.033965207636356354, 0.011411922052502632, 0.011189927347004414, 0.021477999165654182, 0.05699717253446579, -0.02779097855091095, -0.017801210284233093, -0.02504379115998745, -0.02447493001818657, -0.05502696707844734, 0.006479474250227213, 0.018009331077337265, -0.009649837389588356, -0.005123224575072527, 0.001444700756110251, -0.0026517976075410843, -0.008838169276714325, 0.03177301213145256, -0.04187377542257309, -0.044176969677209854, -0.008414991199970245, -0.01910543069243431, 0.05003208667039871, 0.023295583203434944, -0.013555559329688549, 0.03510293364524841, 0.006635564379394054, 0.005272377282381058, 0.028290465474128723, -0.03809986263513565, 0.019896287471055984, -0.01257739495486021, 0.0024905044119805098, -0.0025494717992842197, -0.08019563555717468, -0.015900379046797752, -0.030385542660951614, 0.04531469568610191, 0.0025546748656779528, 0.004852668382227421, -0.07786468416452408, 0.08591199666261673, -0.010461506433784962, 0.045508939772844315, -0.020423524081707, 0.043899476528167725, -0.04714615270495415, -0.047978632152080536, -0.0003080611932091415, -0.004648016765713692, 0.056941673159599304, 0.03402070701122284, 0.024696925655007362, 0.03033004328608513, -0.007818380370736122, -0.0001925111428136006, -0.03696214035153389, -0.03848835453391075, -0.02883157879114151, -0.03743387758731842, 0.01474878191947937, -0.006489880383014679, -0.023226208984851837, 0.055054716765880585, -0.022934840992093086, 0.031023778021335602, 0.017898334190249443, 0.024599801748991013, -0.001657156739383936, 0.029192321002483368, 0.09934268891811371, 0.038238611072301865, 0.00402018753811717, -0.0034114362206310034, -0.03177301213145256, -0.024988293647766113, -0.010246449150145054, 0.035685669630765915, -0.017079727724194527, 0.010690438561141491, -0.01674673520028591, -0.025654276832938194, -0.009136474691331387, -0.020687144249677658, -0.013007509522140026, 0.01383998990058899, -0.035297177731990814, -0.005948767531663179, 0.03604641184210777, 0.025793025270104408, 0.019438423216342926, -0.02373957261443138, 0.007977939210832119, 0.022254981100559235, 0.0025789556093513966, -0.009899581782519817, 0.02598726935684681, -0.00840805470943451, -0.0077143204398453236, 0.005442342255264521, 0.008005688898265362, -0.013541684485971928, 0.021242130547761917, -0.01823132485151291, 0.03363221883773804, -0.021810991689562798, 0.0052376906387507915, -0.04553668946027756, -0.008401117287576199, 0.00826236978173256, -0.014138296246528625, 0.0013042195932939649, -0.09651225060224533, -0.010461506433784962, -0.003902252996340394, 0.00041190447518602014, -0.019826913252472878, -0.020395774394273758, -0.016705110669136047, -0.06571047008037567, -0.020423524081707, 0.02958081103861332, -0.017232349142432213, -0.03563017025589943, -0.005737178958952427, 0.02380894497036934, 0.014929152093827724, 0.004262994509190321, -0.008852044120430946, -0.0046029239892959595, -0.015359267592430115, 0.017051978036761284, -0.01166860293596983, 0.002169652609154582, 0.03743387758731842, 0.06143707036972046, 0.0005354757886379957, 0.017468217760324478, -9.023959864862263e-05, 0.005848176311701536, -0.014186857268214226, -0.008664735592901707, 0.005154442507773638, -0.00036269272095523775, 0.02788810059428215, 0.03110702522099018, -0.005747585091739893, 0.0007097764173522592, -0.006573128048330545, -0.01682998239994049, 0.03443694859743118, -0.00826236978173256, -0.01899443194270134, -0.004460708703845739, 0.014943026937544346, -0.030579788610339165, 0.014429664239287376, 0.008123623207211494, 0.003284829668700695, -0.0090324142947793, -0.020867513492703438, 0.01111361663788557, 0.03812761232256889, -0.0004574307531584054, 0.022143984213471413, -0.042401012033224106, -0.019924035295844078, 0.0007288541528396308, -0.017606964334845543, -0.05805164948105812, 0.02146412618458271, -0.01209871843457222, 0.003508558962494135, -0.04120779037475586, 0.02561265416443348, 0.06659845262765884, -0.022643472999334335, 0.024322308599948883, -0.024544304236769676, -0.007318892050534487, -0.024447180330753326, 0.013271128758788109, -0.012077906168997288, -0.01209871843457222, -0.03119027428328991, 0.028387589380145073, -0.011522918939590454, 0.02164449542760849, -0.021061759442090988, -0.0102117620408535, 0.022948715835809708, 0.00046610244316980243, 0.0028096220921725035, 0.004200558643788099, -0.04081929847598076, -0.006392757408320904, -0.01238314900547266, -0.012251339852809906, -0.009386219084262848, -0.012424773536622524, -0.023031963035464287, -0.01832844875752926, 0.006861027795821428, 0.04753464460372925, -0.010836122557520866, -0.02240760251879692, -0.02307358756661415, -0.001468114205636084, -0.013895489275455475, -0.007818380370736122, 0.00013332697562873363, -0.01920255273580551, -0.01017013844102621, -0.0355469211935997, -0.0033160478342324495, -0.0644339993596077, -0.005612306762486696, 0.01986853778362274, -0.0008229417726397514, -0.01567838527262211, 0.0069061205722391605, 0.0003505523782223463, -0.01040600799024105, -0.007436826825141907, -0.035879913717508316, 0.03762812539935112, 0.011176052503287792, -0.0048491996712982655, -0.037961117923259735, 0.03260549157857895, -0.028498586267232895, 0.0101632010191679, -0.007665758952498436, -0.003860628930851817, -0.02210235968232155, -0.021894240751862526, -0.01900830678641796, 0.03762812539935112, 0.031023778021335602, 0.015900379046797752, -3.270846718805842e-05, -0.01702422834932804, -0.01427704282104969, -0.013728993013501167, 0.018453320488333702, -0.06265804171562195, -0.012022407725453377, -0.012632893398404121, 0.01067656371742487, 0.02089526318013668, 0.0114396708086133, -0.005768396891653538, 0.041457533836364746, -0.010926308110356331, -0.011217676103115082, 0.055526457726955414, -0.01682998239994049, 0.02693074755370617, -0.023517576977610588, 0.0014958636602386832, -0.02203298732638359, -0.009191973134875298, -0.022560223937034607, -0.00423177657648921, 0.022060737013816833, -0.04781213775277138, 0.03471444174647331, -0.04828387498855591, -0.009823271073400974, 0.011196864768862724, 0.0019199084490537643, 0.009851020760834217, -0.0007431624107994139, -0.001249588094651699, 0.0114396708086133, 0.00043206612463109195, -0.03488093614578247, 0.0037877866998314857, -0.013923238031566143, 0.0178705845028162, 0.03807211294770241, -0.010801436379551888, 0.04983783885836601, 0.007533949799835682, -0.08541250973939896, -0.023573076352477074, 0.019618792459368706, 0.0021679182536900043, -0.009538840502500534, -0.020021159201860428, -0.003957751672714949, 0.002377772703766823, -0.0035935414489358664, 0.06793041527271271, -0.009760835207998753, 0.005782271735370159, -0.007957126945257187, -0.02608439326286316, 0.007929378189146519, -0.050531573593616486, 0.002275447128340602, 0.037766870111227036, 0.024891169741749763, -0.026126015931367874, 0.007311954628676176, -0.017620839178562164, 0.005241159349679947, -0.013298877514898777, 0.027749354019761086, 0.00969146192073822, 0.0019060337217524648, -0.0017794272862374783, 0.003975094761699438, -0.011564543470740318, 0.016510864719748497, 0.025279661640524864, 0.039098840206861496, 0.015137272886931896, 0.011987720616161823, -0.02210235968232155, 0.030496539548039436, -0.014734907075762749, -0.02126988023519516, -0.008206871338188648, 0.006725749466568232, 0.00879654474556446, -0.027999097481369972, -0.03698989003896713, 0.009205847978591919, 0.0033836867660284042, 0.00012237898772582412, 0.01775958575308323, 0.016760610044002533, -0.00029136822558939457, 0.008102810941636562, -0.023975441232323647, 0.012736953794956207, -0.011550668627023697, -0.01040600799024105, -0.007832255214452744, -0.012279089540243149, 0.04681316018104553, -0.0006469067884609103, -0.041540782898664474, -0.009157286956906319, 0.036434900015592575, 0.020284777507185936, -0.012195841409265995, 0.023573076352477074, -0.005653930827975273, 0.0062713539227843285, -0.017135225236415863, 0.010517004877328873, 0.023129086941480637, 0.014166045002639294, -0.022532476112246513, -0.027166618034243584, 0.0036871954798698425, 0.03365996479988098, 0.04847812280058861, -0.04445446655154228, 0.01526214461773634, -0.01167554035782814, 0.008005688898265362, 0.008838169276714325, -0.018675316125154495, -0.010829185135662556, -0.011189927347004414, -0.011065054684877396, -0.015636760741472244, -0.009774710051715374, -0.012043219991028309, 0.005768396891653538, -0.004571706056594849, -0.022671222686767578, -0.02891482599079609, 0.006004266440868378, 0.0016597582725808024, 0.01964654214680195, 0.034076206386089325, 0.021311504766345024, -0.029442064464092255, -0.09889869391918182, -0.02591789700090885, -0.0035189648624509573, -0.015636760741472244, 0.017912207171320915, -0.013874677009880543, 0.005806552246212959, 0.019119305536150932, 0.01918867789208889, 0.00894222967326641, 0.03887684643268585, -0.0392930842936039, -0.027083368971943855, -0.008685547858476639, 0.03754487633705139, -0.04997658729553223, 0.014818155206739902, 0.003697601379826665, 0.03685114160180092, -0.014304791577160358, -0.0018592067062854767, 0.007762881927192211, 0.0013224300928413868, 0.009067101404070854, -0.020284777507185936, -0.028012972325086594, 0.01616399921476841, -0.002197402063757181, 0.028803829103708267, 0.018286824226379395, -0.003194644348695874, -0.008560676127672195, 0.025349033996462822, 0.012272152118384838, -0.0500875823199749, 0.025029918178915977, -0.00894222967326641, 0.005265439860522747, 0.020368026569485664, 0.015373142436146736, 0.024918919429183006, -0.02949756383895874, 0.03402070701122284, 0.007506200112402439, 0.007672696374356747, 0.0044294907711446285, -0.010371320880949497, -0.02693074755370617, -0.015442515723407269, -0.001214034273289144, 0.015844881534576416, 0.01655248925089836, 0.002376038348302245, -0.011959971860051155, -0.00027467525796964765, -0.015900379046797752, -0.012119530700147152, -0.027249865233898163, -0.02401706576347351, -0.008130560629069805, -0.002079467289149761, 0.033410221338272095, -0.030135799199342728, -0.02790197543799877, -0.035297177731990814, -0.009344594553112984, -0.0015678384806960821, 0.00029093463672325015, -0.0036871954798698425, -0.040042318403720856, -0.030191296711564064, 0.009802459739148617, 0.0089352922514081, -0.002192198997363448, 0.0007418616442009807, -0.004935916513204575, -0.0019285801099613309, 0.05624794214963913, -0.03241124376654625, -0.007783693727105856, 0.024516554549336433, -0.02891482599079609, -0.0036941326688975096, -0.02165837027132511, 0.017162974923849106, 0.01788445934653282, 0.020368026569485664, -0.049754589796066284, -0.027527358382940292, 0.040125567466020584, 0.035574670881032944, 0.0001668213080847636, 0.010926308110356331, 0.006507223471999168, -0.003555385861545801, -0.025931771844625473, -0.0047208587639033794, 0.044093724340200424, 0.002070795511826873, 0.01816195249557495, 0.002034374512732029, 0.011731039732694626, -0.014159107580780983, -0.0027333113830536604, 0.02034027688205242, 0.017731837928295135, 0.02239372953772545, -0.000636500830296427, 0.04667441174387932, -0.030108049511909485, 0.011946097016334534, 0.01766246370971203, -0.0039057214744389057, 0.0640455111861229, -0.017412720248103142, 0.03377096354961395, 0.04431571811437607, 0.027652231976389885, 0.029469814151525497, 0.0021505749318748713, 0.020284777507185936, -0.016677360981702805, 0.01167554035782814, 0.019910162314772606, -0.021242130547761917, -0.00926828384399414, 0.016122374683618546, -0.0006143880309537053, -0.02108950912952423, 0.0275967326015234, 0.012931198813021183, 0.011932222172617912, -0.008519051596522331, 0.02478017285466194, -0.01663573831319809, 0.01975754089653492, 0.041263289749622345, -0.005369499791413546, -0.029664060100913048, 0.011085866950452328, -0.00460986141115427, 0.004422553349286318, 0.017828959971666336, -0.01720459945499897, -0.008650860749185085, 0.0208120159804821, 0.00397162651643157, -0.020076656714081764, -0.003454794641584158, 0.03685114160180092, 0.019979534670710564, -0.018925059586763382, 0.005508246831595898, 0.019147053360939026, 0.0065176296047866344, 0.02655613236129284, -0.02136700227856636, -0.011848974041640759, -0.002630985574796796, -0.009247472509741783, 0.02380894497036934, 0.017454342916607857, 0.010107702575623989, 0.007957126945257187, 0.03413170576095581, -0.02333720587193966, -0.01956329494714737, -0.015831006690859795, -0.005914080888032913, 0.014832030050456524, -0.025501655414700508, -0.050809066742658615, 0.0280823465436697, 0.028776079416275024, 0.014096671715378761, -0.0020413119345903397, 0.020423524081707, -0.01635824330151081, -0.008727171458303928, 0.03410395607352257, -0.007964064367115498, 0.01508177351206541, -0.0089352922514081, 0.01769021339714527, 0.03765587508678436, -0.016954855993390083, -0.013597183860838413, -0.0028581833466887474, 0.009122599847614765, 0.04803413152694702, -0.0019025651272386312, 0.0410412959754467, 0.005608838051557541, -0.005001821089535952, 0.04348323866724968, -0.03551917150616646, 0.019258052110671997, 0.012820201925933361, -0.005157911218702793, -0.04783988744020462, -0.030885031446814537, 0.024627551436424255, -0.007658821530640125, -0.004769420251250267, -0.013208692893385887, -0.012306838296353817, 0.0059591736644506454, -0.016968730837106705, -0.015747757628560066, 0.0077698188833892345, 0.005064256954938173, 0.031523264944553375, -0.013354376889765263, -0.014818155206739902, 0.028248842805624008, 0.0012929465156048536, 0.0005424131522886455, 0.013888551853597164, -0.038321856409311295, -0.03130127117037773, -0.0353526771068573, -0.010412945412099361, 0.00974002294242382, -0.0014013423351570964, 0.020492898300290108, 0.022671222686767578, -0.01238314900547266, -0.012639830820262432, -0.003565791994333267, 0.022046862170100212, 0.013874677009880543, 0.004564768634736538, -0.02034027688205242, -0.019632667303085327, 0.014374165795743465, -0.031079275533556938, -0.006951213348656893, 0.023517576977610588, 0.006718812510371208, 0.012563520111143589, 0.040042318403720856, 0.0035692607052624226, -0.006652907468378544, -0.021297629922628403, 0.022365979850292206, 0.03698989003896713, 0.020368026569485664, 0.035019684582948685, -0.042012520134449005, 0.011800413019955158, 0.006541910115629435, -0.030191296711564064, 0.0339929573237896, 0.0007193152559921145, 0.01233458798378706, 0.0072078946977853775, 0.0041173105128109455, 0.04445446655154228, 0.04226226732134819, 0.013964862562716007, -0.02115888148546219, 0.01995178498327732, 0.012202778831124306, 0.007825317792594433, 0.000456997164292261, -0.019244177266955376, 0.003149551572278142, 0.026528382673859596, 0.00012909952783957124, 0.014623909257352352, -0.003950814250856638, 0.012279089540243149, 0.013999548740684986, 0.02393381856381893, -0.0059591736644506454, -0.0009556183940730989, 0.06021609902381897, -0.015248269774019718, 0.025099290534853935, 0.01205015741288662, -0.03610191121697426, -0.037961117923259735, -0.01577550731599331, -0.011689415201544762, 0.03990356996655464, -0.032660990953445435, -0.0037704433780163527, 0.005896737799048424, 0.040042318403720856, 0.024155812337994576, -0.003491215640679002, 0.023142961785197258, -0.019521670415997505, -0.005067725665867329, 0.0208120159804821, 0.013819178566336632, -0.00851211417466402, 0.012924261391162872, 0.03818311169743538, -0.021297629922628403, 0.03318822756409645, 0.011377234943211079, 0.002020499901846051, -0.04450996220111847, 0.02174161933362484, 0.01635824330151081, 0.03316047787666321, -0.036545898765325546, 0.00023478554794564843, 0.013340502046048641, -0.025113165378570557, 0.021880365908145905, -0.004790232051163912, 0.03460344299674034, -0.005598432384431362, 0.00851211417466402, -0.00949721597135067, 0.018855685368180275, -0.01964654214680195, -0.005185660440474749, 0.016205621883273125, -0.008303994312882423, 0.007284205406904221, 0.016899356618523598, -0.010607190430164337, -0.01284795068204403, -0.035685669630765915, -0.009712274186313152, 0.004068749025464058, 0.0275967326015234, 0.0006256612250581384, -0.00472779618576169, -0.018037080764770508, 0.030885031446814537, -0.023004215210676193, -0.009393156506121159, -0.028470836579799652, -0.0089352922514081, -0.00451620714738965, -0.011543731205165386, -0.0012053626123815775, 0.012397023849189281, 0.0014837232884019613, -0.001338039175607264, -0.005820427089929581, 0.033798713237047195, 0.0035189648624509573, -0.005910612177103758, 0.04345548897981644, -0.013701243326067924, 0.07403527945280075, 0.030302293598651886, -0.006625158246606588, -0.0033646090887486935, -0.01948004588484764, 0.042595259845256805, 0.011266238056123257, -0.02156124822795391, -0.03235574811697006, 0.012480271980166435, 0.015595137141644955, 0.0019944848027080297, -0.03252224251627922, -0.0005883730482310057, 0.02910907194018364, 0.0015539638698101044, -0.032466743141412735, 0.0006928666844032705, 0.016302745789289474, 0.007658821530640125, 0.004533550702035427, 0.002811356447637081, -0.012979760766029358, -0.011321736499667168, -0.018938934430480003, 0.014582285657525063, 0.0049255103804171085, 0.008560676127672195, 0.029414314776659012, 0.04473195970058441, -0.008643923327326775, -0.01308382023125887, -0.019147053360939026, 0.018689189106225967, -0.030968278646469116, 0.010274197906255722, -0.015595137141644955, 0.025127040222287178, -0.0021679182536900043, -0.012743891216814518, 0.005615775473415852, 0.02373957261443138, -0.002322274027392268, 0.018841810524463654, -0.04131878912448883, 0.005792677868157625, 0.02777710370719433, 0.002729842672124505, -0.015400891192257404, 0.007270330563187599, 0.0416240319609642, -0.010100765153765678, 0.016940981149673462, 0.0049046981148421764, 0.03288298472762108, 0.017468217760324478, -0.016372118145227432, 0.04262300953269005, 0.03168976306915283, -0.016427617520093918, -0.021145008504390717, -0.023281708359718323, -0.01682998239994049, 0.022199483588337898, -0.010766749270260334, -0.015109523199498653, -0.03876584768295288, 0.012438647449016571, -0.02618151530623436, 0.009913456626236439, -0.043899476528167725, 0.006156887859106064, 0.007742069661617279, -0.021200506016612053, 0.020687144249677658, 0.011966909281909466, -0.02486342191696167, 0.02297646552324295, 0.03629615530371666, 0.04648016765713692, -0.030302293598651886, 0.012875700369477272, -0.016483116894960403, 0.006018141284584999, -0.02154737338423729, -0.025016043335199356, 0.03443694859743118, -0.007083022501319647, -0.01720459945499897, -0.005678211338818073, 0.016663486137986183, 0.0018123796908184886, 0.027818728238344193, -0.009302970953285694, -0.04301149770617485, 0.0024558177683502436, -0.02421131171286106, 0.01682998239994049, 0.011189927347004414, -0.008532926440238953, -0.009462529793381691, 0.020007284358143806, -0.0004925510147586465, 0.00921972282230854, -0.009830208495259285, 0.03202275559306145, -0.010121576488018036, -0.02231048047542572, -0.007700445596128702, 0.0232678335160017, 0.0023014619946479797, -0.009851020760834217, 0.009087913669645786, 0.019715916365385056, 0.0046133301220834255, 0.01917480304837227, 0.020090531557798386, 0.07237031310796738, -0.003954282961785793, -0.008623111993074417, 0.015373142436146736, 0.03585216403007507, 0.01871693879365921, -0.014457412995398045, -0.01653861440718174, 0.010600253008306026, -0.03335472196340561, -0.009698399342596531, -0.03033004328608513, 0.0029899929650127888, -0.012397023849189281, -0.0010874278377741575, -0.002369101159274578, -0.004814513027667999, 0.024433305487036705, 0.03216150030493736, 0.019230302423238754, -0.005112818442285061, -0.014970776624977589, -0.031245771795511246, 0.014443539083003998, 0.01567838527262211, 0.020257027819752693, 0.013583309017121792, 0.02165837027132511, -0.02636188641190529, 0.012181966565549374, -0.023087462410330772, 0.015178896486759186, 0.007596385665237904, 0.00578920915722847, -0.010898558422923088, -0.005192597862333059, 0.004027124959975481, -0.006600877735763788, -0.01474878191947937, 0.006607814691960812, -0.040597304701805115, -0.000263835652731359, 0.004523144569247961, -0.0004977540229447186, -0.009330720640718937, -0.027055619284510612, 3.872443994623609e-05, 0.04095804691314697, -0.015151146799325943, 0.010073015466332436, -0.004443365149199963, 0.01522052101790905, -0.004745139740407467, 0.042761754244565964, 0.015289894305169582, 0.02260184846818447, 0.024516554549336433, -0.012563520111143589, -0.009240535087883472, -0.013812241144478321, 0.01938292384147644, -0.04814513027667999, 0.0114396708086133, -0.0035068246070295572, -0.022934840992093086, 0.002995195798575878, -0.009566590189933777, -0.005626181606203318, -0.022726720198988914, -0.012875700369477272, 0.002493973122909665, 0.012057093903422356, -0.015428640879690647, -0.00423177657648921, -0.03912658989429474, 0.013708180747926235, 0.0075200749561190605, 0.015165021643042564, 0.038599349558353424, 0.04206801950931549, 0.0024141937028616667, 0.006177700124680996, 0.010669626295566559, 0.020007284358143806, -0.0010544754331931472, 0.017842834815382957, 0.015733882784843445, -0.012299900874495506, 0.021408626809716225, -0.012639830820262432, -0.004970603156834841, 0.0044190846383571625, -0.030468789860606194, -0.007589448243379593, -0.0016675627557560802, 0.004346242640167475, 0.02797134965658188, 0.027069494128227234, -0.024225186556577682, -0.001279071788303554, 0.003137411316856742, -0.0032102533150464296, -0.0067014689557254314, 0.012286026030778885, -0.014526787213981152, 0.0345756933093071, -0.00029743838240392506, -0.009004665538668633, 0.01587263122200966, 0.020770391449332237, 0.01853656768798828, 0.0046133301220834255, 0.024502679705619812, -0.007471513468772173, -0.0015132069820538163, -0.006625158246606588, -0.015109523199498653, 0.00879654474556446, -0.006670251023024321, -0.019063806161284447, -0.0007167137810029089, 0.020270902663469315, -0.008879792876541615, -0.00642744405195117, 0.020825890824198723, -0.0004929846036247909, 0.022088484838604927, -0.022185608744621277, 0.0416240319609642, 0.0012313775951042771, 0.011925284750759602, -0.03957057744264603, 0.0012712673051282763, -0.015470264479517937, -0.014055048115551472, -0.009746960364282131, -0.034742191433906555, 0.015303769148886204, -0.008671673014760017, -0.011092804372310638, -0.029081322252750397, 0.0062713539227843285, 0.020173780620098114, 0.002046514768153429, -0.00874798372387886, 0.031523264944553375, -0.0009270018781535327, -0.011731039732694626, 0.04251201078295708, -0.013597183860838413, 0.0046653603203594685, -0.0063337902538478374, -0.003395827254280448, -0.01882793754339218, 0.010759811848402023, -0.015539637766778469, -0.0022355574183166027, -0.026070518419146538, 0.02059002034366131, -0.003614353248849511, 0.02541840821504593, 0.007048335857689381, -0.05000433698296547, -0.005501309409737587, 0.008963041007518768, -0.01588650606572628, -0.015012400224804878, 0.005324407480657101, 0.027249865233898163, -0.017523717135190964, -0.027346989139914513, -0.009337658062577248, 0.03149551525712013, -0.02883157879114151, 0.009559652768075466, 0.010662688873708248, -0.029913803562521935, -0.004262994509190321, 0.02172774448990822, 0.00973308552056551, -0.004360117018222809, -0.03174526244401932, 0.023670198395848274, -0.013451498933136463, -0.013305814936757088, -0.005924487020820379, 0.009622088633477688, 0.032466743141412735, 0.029664060100913048, -0.002906744834035635, 0.019049931317567825, -0.025876272469758987, 0.008081999607384205, 0.014818155206739902, 0.004453771281987429, -0.005307063926011324, 0.022532476112246513, 0.026403510943055153, 0.02239372953772545, -0.04001456871628761, 0.046563416719436646, -0.03213375061750412, 0.023420454934239388, -0.025002168491482735, -0.0030177421867847443, -0.003503355896100402, -0.027999097481369972, -0.014651658944785595, 0.01361799519509077, -0.03629615530371666, 0.007429889403283596, 0.01749596744775772, 0.007506200112402439, 0.025931771844625473, 0.011488232761621475, 0.05302901566028595, -0.011994658038020134, -0.011536793783307076, 0.024419430643320084, -0.01920255273580551, 0.033021729439496994, 0.022476976737380028, -0.03746162727475166, -0.043621983379125595, 0.003680258058011532, 0.01234152540564537, -0.0357411690056324, -0.04298374801874161, 0.016843857243657112, -0.018120327964425087, -0.02324008382856846, -0.0002373870520386845, 0.002936228411272168, 0.040208812803030014, 0.025182539597153664, 0.012126468122005463, -0.014623909257352352, 0.02733311429619789, 0.024724673479795456, -0.006958150304853916, -0.019729791209101677, -0.029358817264437675, -0.028526335954666138, -0.019549420103430748, 0.0011273175477981567, 0.0169964786618948, 0.020576145499944687, -0.0012660642387345433, 0.03146776556968689, 0.020465148612856865, -0.011099741794168949, 0.004474583547562361, 0.01881406269967556, -0.006677188444882631, 0.02478017285466194, 0.020923012867569923, 0.016302745789289474, -0.013194818049669266, 0.0036282280925661325, -0.008664735592901707, -0.016413742676377296, 0.009427842684090137, -0.0055914949625730515, 0.011453545652329922, -0.003277892479673028, -0.014818155206739902, -0.014734907075762749, 0.002369101159274578, 0.012043219991028309, -0.0197436660528183, 0.015373142436146736, -0.018023205921053886]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" 0.05
Load in 4-bit True
4bit quantization type nf4
4bit dtype bfloat 16
Table 7. Hyperparameters for Mistral 7B model fine-tuning
23
Riemannian Preconditioned LoRA
F. Supplementary Experiments for Diffusion Models
F.1. Stable Diffusion
For our object generation experiment, we follow the popular custom diffusion repository (Ryu, 2023). We follow all default
settings for both training and inference steps except for the optimizer component. We use “a photo of ⟨Vobject⟩” as all object
image captions. In the original repository, AdamW is used as default optimizer with learning rate 5e−5for text-encoder
tuning and 1e−4for U-Net tuning. The pretrained model being used is Stable Diffusion V1.5 (Rombach et al., 2022). For
training procedure, we use constant learning rate scheduler with zero learning rate warmup steps, which is the default setting.
Max training step is set to 4000 . For sampling procedure, we set number of inference steps to be 50and guidance scale to be
7, which is used as default in the experiment notebook provided. Figure 5 shows generation results for a yellow chair with
training images containing the target chair in color blue. AdamW is able to generate the target yellow chair only for learning
rate1e−6while our method generates desired images for all learning rates being tested. Figure 6 shows generation results
for dog object. Our method generates images better capturing the prompt, i.e, a dog wearing a hat. For large learning rate
1e−2, AdamW only generates black images while no black images are observed for scaled AdamW generation, which
again verifies the robustness of our scaled optimizers.
Figure 5. Generation results for prompt “a yellow ⟨Vchair⟩” after fine-tuning on 5blue chair images of the Stable Diffusion V1.5 model.
We vary text-encoder learning rates with U-Net learning rate fixed to default value 1e−4.No black images are observed for our method’s
generation and AdamW generates only black images for large learning rates. Our method (scaled AdamW) generates photos better
capturing the prompt and is more robust to learning rate changes. See Appendix F.1 for experimental details.
Figure 6. Generation results for prompt “ ⟨Vdog⟩wearing a hat” after fine-tuning on 5dog images of the Stable Diffusion V1.5 model. See
Appendix F.1 for experimental details. Our method (scaled AdamW) generates images better capturing the prompt, i.e., a dog wearing a
hat, and is more robust to learning rate changes.
F.2. Mix-of-Show
For our experiment for face generation tasks, we base our experiments on Mix-of-Show (Gu et al., 2023) repository which
we find able to generate high-quality face images and is better for visualization comparison between different optimization
24
Riemannian Preconditioned LoRA
methods we consider. We follow default settings for training and inference in (Gu et al., 2023) with the exception that we
turn off embedding tuning and only tune the text encoder and U-Net fraction where LoRA parameters are injected. The
reason is that we find with embedding tuning, the effect of LoRA parameter is restricted and thus does no good to our
comparison. In Mix-of-Show, Chilloutmix2is used as pretrained model. LoRA rank is set to 4. DMP-Solver (Lu et al.,
2022) is employed for sampling. See (Gu et al., 2023) for more discussion on experimental details. Here we first fix step
size5e−4for both text encoder tuning and U-Net tuning and compare AdamW versus scaled AdamW with different LoRA
parameter fusion coefficients. The default step size value used for Mix-of-Show is 1e−5and1e−4for text encoder tuning
and U-Net tuning respectively and default optimizer is AdamW. See Section F.2.1 for experimental results for different
LoRA parameter fusion coefficients. Our scaled AdamW optimizer generates visually better images compared to AdamW
optimizer. We then test with varying step size settings and demonstrate that our scaled gradient method is more robust to
step size changes in Section F.2.2.
F.2.1. A DAM WVS.SCALED ADAM WWITH VARYING LORA P ARAMETER FUSION COEFFICIENTS
We experiment with Potter character and Hermione character. For Potter character, we use 14 Potter images for training
LoRA parameters with the character name replace by","[0.041946060955524445, 0.02799304947257042, 0.036492493003606796, -0.029791565611958504, -0.03228628262877464, -0.037594810128211975, 0.02142265997827053, -0.00771621847525239, -0.04011853411793709, 0.02001575566828251, -0.0030440627597272396, -0.002019705716520548, -0.06033734977245331, -0.028616728261113167, 0.012343049049377441, 0.00843417551368475, 0.019957737997174263, -0.02104555070400238, -0.04499193653464317, 0.0037203195970505476, 0.007462395820766687, -0.0037348237819969654, -0.0006100816535763443, 0.03263438493013382, 0.023960890248417854, -0.022089852020144463, 0.011922428384423256, 0.011625092476606369, 0.05273716524243355, 0.011552571319043636, 0.01621566340327263, -0.032025206834077835, -0.014119809493422508, -0.04847293719649315, -0.02744189091026783, 0.028587719425559044, 0.022321918979287148, 0.009601760655641556, -0.04351251199841499, 0.007136052008718252, -0.01659277081489563, -0.08853345364332199, -0.0015718895010650158, 0.019043976441025734, 0.006729935295879841, 0.014119809493422508, 0.0008321767672896385, 0.009195644408464432, 0.03585430979728699, 0.005341160576790571, -0.04049564525485039, 0.0719987004995346, -0.0030766972340643406, -0.05256311222910881, 0.01298123225569725, -0.006378208752721548, 0.03866811841726303, 0.0031057053711265326, 0.01900046318769455, -0.03707265853881836, 0.050648562610149384, -0.026832714676856995, 0.03910324349999428, -0.03190917521715164, -0.006642910186201334, -0.02780449390411377, -0.08801130950450897, -0.026586145162582397, 0.01901496760547161, 0.04499193653464317, -0.0015646374085918069, 0.00456881383433938, 0.04003151133656502, -0.03942233696579933, -0.01741950772702694, 0.015562974847853184, 0.03979944437742233, 0.00931892916560173, -0.00917388778179884, -0.006302061956375837, 0.0008199388976208866, 0.00352270039729774, 0.025367794558405876, -0.030719833448529243, -0.029791565611958504, -0.031125949695706367, -0.0018927942728623748, -0.03330157697200775, -0.00788301695138216, -0.02114707976579666, 0.00456881383433938, 0.009609012864530087, -0.010928892530500889, 0.020160796120762825, 0.03208322450518608, 0.0006091751856729388, 0.03510009124875069, -0.02013178914785385, 0.05729147419333458, 0.039625395089387894, 0.02919689565896988, 0.00021212348656263202, 0.01799967512488365, -0.023293698206543922, 0.03681158274412155, -0.02789152041077614, 0.006914863362908363, 0.004209835547953844, -0.05172187089920044, 0.030922891572117805, -0.054013531655073166, -0.011625092476606369, -0.052418071776628494, -0.014852270483970642, 0.004068419802933931, -0.08922965824604034, -0.029414458200335503, 0.0037275718059390783, -0.013517886400222778, -0.02253948152065277, -0.027238832786679268, 0.023598285391926765, 0.00866624154150486, -0.006091751623898745, 0.07165060192346573, 0.0028573216404765844, 0.04438276216387749, -0.04623929411172867, -0.00028555086464621127, -0.0004525754484347999, 0.03402678295969963, 0.005134476348757744, 0.03457794338464737, -0.022742539644241333, -0.05218600481748581, -0.008107831701636314, -0.009949861094355583, -0.01543243695050478, -0.011393025517463684, 0.027789991348981857, -0.01094339694827795, -0.04522400349378586, -0.017506534233689308, 0.02132113091647625, -0.02993660792708397, 0.011791890487074852, -0.02123410627245903, 0.03272140771150589, -0.042323168367147446, 0.03927729278802872, -0.01283619087189436, -0.008412418887019157, -0.04673243686556816, -0.03510009124875069, -0.013300323858857155, -0.011697613634169102, -0.0018746639834716916, 0.011429286561906338, 0.015504958108067513, -0.01688285358250141, -0.003276129486039281, 0.05163484811782837, 0.014438902027904987, -0.04948822781443596, 0.03710166737437248, 0.004634082317352295, -0.0317351259291172, 0.03872613608837128, -0.07281093299388885, -0.019232530146837234, 0.02013178914785385, -0.0028736386448144913, -0.018188228830695152, -0.04609425365924835, 0.02390287257730961, -0.0033305201213806868, -0.03318554162979126, 0.00398502079769969, 0.009986121207475662, -0.023511260747909546, 0.002190129831433296, 0.025556348264217377, -0.06254198402166367, 0.03440389037132263, -0.047051530331373215, -0.023598285391926765, 0.0011431099846959114, -0.027557924389839172, 0.017753103747963905, 0.0259624645113945, 0.026020482182502747, 0.010914388112723827, 0.09189842641353607, -0.008963577449321747, 0.013031996786594391, -0.03617339953780174, 0.07397127151489258, 0.02001575566828251, -0.030168674886226654, 0.0003011881490238011, -0.0209440216422081, 0.04493391886353493, 0.021799767389893532, -0.06700927019119263, 0.012176251038908958, -0.005718269385397434, -0.01657826639711857, 7.399393507512286e-05, 0.0015129662351682782, 0.01614314131438732, 0.03977043554186821, 0.04513697698712349, 0.03402678295969963, -0.02374332770705223, -0.08534254133701324, 0.0003014147805515677, -0.07385523617267609, 0.04403465986251831, 0.03568026050925255, 0.04365755245089531, -0.020508896559476852, 0.04470185190439224, 0.02780449390411377, 0.006903985049575567, -0.02770296484231949, -0.0016154019394889474, 0.0017423134995624423, -0.04754466935992241, 0.002445765770971775, -0.015272891148924828, 0.0306037999689579, 0.0012954036938026547, -0.013387349434196949, -0.01543243695050478, 0.0326053760945797, -0.06944596767425537, 0.01103042159229517, -0.023032622411847115, 0.02317766472697258, -0.0033323331736028194, -0.006704552564769983, 0.015403429046273232, 0.01889893412590027, -0.011197219602763653, -0.00936969369649887, 0.05128674581646919, -0.013365592807531357, -0.03791389986872673, 0.024323493242263794, 0.004554309416562319, 0.024526551365852356, -0.02660064771771431, -0.03031371533870697, -0.04095977544784546, -0.044730860739946365, 0.03884216770529747, -0.0085284523665905, 0.008158596232533455, -0.04545607045292854, 0.046036235988140106, -0.012647636234760284, -0.01769508793950081, 0.013684684410691261, 0.04635532945394516, -0.023496756330132484, 0.010783851146697998, -0.05137377232313156, 2.872505683626514e-05, 0.005736399441957474, 0.010776598937809467, -0.013546895235776901, -0.028718257322907448, 0.005312152206897736, -0.008825787343084812, -0.03431686758995056, -0.016650788486003876, 0.0457751601934433, 0.021567702293395996, -0.03570926934480667, 0.006780699826776981, -0.023975392803549767, 0.015911074355244637, 0.05256311222910881, 0.008905560709536076, 0.004906035494059324, 0.01575152948498726, 0.005424559582024813, -0.030748840421438217, -0.019725671038031578, -0.006128012202680111, 0.018594346940517426, -0.04960426315665245, 0.03965440019965172, -0.027848007157444954, 0.00484076701104641, 0.027848007157444954, 0.005982970353215933, -0.017274467274546623, 0.0011703053023666143, 0.015911074355244637, 0.04832789674401283, -0.011262488551437855, 0.00021472970547620207, 0.013278568163514137, -0.0010850932449102402, 0.009144879877567291, 0.04487590491771698, 0.0016081498470157385, 0.01575152948498726, 0.003267064457759261, -0.03106793388724327, 0.027485402300953865, 0.007049026899039745, 0.01171936932951212, -0.013365592807531357, 0.007854008115828037, 0.046036235988140106, -0.0011449229205027223, 0.016462232917547226, -0.01723095402121544, -0.05395551398396492, -0.03655051067471504, -0.0041808271780610085, 0.007157808169722557, -0.012154494412243366, -0.0313580147922039, -0.043802592903375626, 0.005598609801381826, -0.0243960153311491, -0.019711168482899666, 0.0028917689342051744, -0.03420083224773407, 0.03765282779932022, -0.0005751809803768992, -0.0023442364763468504, -0.010588044300675392, -0.05415857210755348, 0.022844068706035614, 0.05531890690326691, 0.026745690032839775, -0.08012104034423828, -0.03866811841726303, -0.008999837562441826, -0.01799967512488365, -0.014301111921668053, -0.01478700153529644, 0.009601760655641556, -0.00792652927339077, 0.042613252997398376, -0.005446316208690405, 0.0065268767066299915, -0.013155282475054264, 0.008629981428384781, -0.0141415661200881, 0.01520037092268467, 0.00981932319700718, 0.0013760831207036972, -0.028979333117604256, -0.04589119553565979, 0.013082761317491531, -0.029994623735547066, 0.04919814690947533, 0.012444578111171722, -0.02976255677640438, 0.00517073692753911, 0.022321918979287148, 0.002694149734452367, 0.058915939182043076, 0.01872488483786583, -0.0356222428381443, -0.022408943623304367, 0.052244022488594055, -0.043077386915683746, 0.027833502739667892, -0.052795179188251495, 0.019783688709139824, 0.01788364164531231, 0.027050277218222618, -0.01966765522956848, 0.05555097386240959, -0.0005978437839075923, 0.023061631247401237, 0.0035970343742519617, -0.012219763360917568, -0.0027666704263538122, -0.002627067966386676, 0.020262325182557106, 0.003850857261568308, -0.06277404725551605, -0.029878590255975723, -0.00609537772834301, -0.027920527383685112, -0.035361167043447495, 0.02121960185468197, 0.0035861560609191656, 0.02735486626625061, 0.004898783750832081, 0.021944809705018997, 0.046964503824710846, 0.07565375417470932, 0.0034483664203435183, -0.016346199437975883, -0.05592808127403259, -0.013249559327960014, -0.026020482182502747, 0.044353753328323364, 0.010370481759309769, 0.036028359085321426, 0.01947910152375698, 0.016331695020198822, 0.011414782144129276, -0.049459222704172134, 0.029443465173244476, -0.0207554679363966, 0.018884429708123207, -0.006276679690927267, 0.05407154560089111, 0.0005334815359674394, 0.03791389986872673, 0.06074346601963043, -0.05830676481127739, -0.0352451354265213, -0.02429448626935482, -0.008122335188090801, -0.011915176175534725, -0.008390662260353565, 0.026441102847456932, -0.0232646893709898, -0.0024838391691446304, -0.010450255125761032, -0.03727571666240692, 0.010878127999603748, 0.03115495853126049, -0.02744189091026783, -0.04847293719649315, -0.034345876425504684, 0.00306037999689579, 0.05128674581646919, 0.026310564950108528, -0.06033734977245331, 0.029457969591021538, 0.0025418559089303017, -0.012778174132108688, 0.013982020318508148, -0.04449879378080368, 0.035187117755413055, 0.00797729380428791, 0.05671130493283272, 0.01400377694517374, -0.02559986151754856, -0.014612951315939426, -0.04316440969705582, 0.020813483744859695, 0.009202895686030388, 0.016099629923701286, -0.07037423551082611, 0.07002613693475723, -0.004347625188529491, 0.04487590491771698, -0.028399165719747543, 0.03974142670631409, -0.03362066671252251, -0.03504207730293274, -0.008608224801719189, -0.005290396045893431, 0.03979944437742233, 0.026034986600279808, 0.008260125294327736, 0.04586218670010567, -0.02010278031229973, 0.006874976679682732, -0.028442678973078728, -0.009768558666110039, -0.0012990297982469201, -0.014032784849405289, -0.00018107550567947328, 0.012096477672457695, -0.038697127252817154, 0.025657877326011658, -0.035187117755413055, 0.02503419853746891, 0.006309314165264368, 0.030893882736563683, -0.005685634911060333, 0.004057541489601135, 0.08540055900812149, 0.02725333534181118, -0.01219075545668602, -0.008173099718987942, 0.006813333835452795, -0.02568688616156578, -0.02214786782860756, 0.008593721315264702, -0.01788364164531231, 0.026760194450616837, -0.013982020318508148, -0.023018117994070053, -0.008122335188090801, 0.008687998168170452, -0.001273647416383028, 0.03779786825180054, -0.014330120757222176, 0.0011576140532270074, 0.01042124629020691, 0.018101204186677933, -0.022365430369973183, 0.015533966943621635, 0.027180815115571022, 0.019580630585551262, 0.009587256237864494, 0.0006699113873764873, 0.04980732128024101, -0.020160796120762825, 0.015925578773021698, -0.0034247972071170807, 0.02661515213549137, -0.013662928715348244, 0.021176088601350784, -0.019406579434871674, 0.04243920370936394, -0.026296060532331467, 0.011516311205923557, -0.04191705211997032, -0.006972880102694035, 0.026760194450616837, 0.008818536065518856, -0.0008634513942524791, -0.10953549295663834, -0.02039286307990551, 0.006646536290645599, 0.025802919641137123, -0.021118072792887688, -0.022104356437921524, -0.02262650616466999, -0.05775560811161995, -0.030284708365797997, 0.03356264904141426, -0.0012944971676915884, -0.01892794296145439, 0.02670217677950859, 0.022191381081938744, 0.011218976229429245, 0.006345574744045734, 0.005620365962386131, -0.0048951576463878155, -0.02123410627245903, 0.03483901545405388, -0.010276204906404018, 0.02327919378876686, 0.006642910186201334, 0.03463595733046532, -0.011436538770794868, 0.004256973974406719, -0.03457794338464737, -0.02893581986427307, 0.01302474457770586, -0.01891343854367733, 0.002558173146098852, -0.01353964302688837, -0.002190129831433296, 0.015519462525844574, 0.02152418904006481, 0.015548470430076122, -0.012009453028440475, -0.004405641928315163, 0.04563011974096298, 0.009405954740941525, 0.0027920526918023825, -0.012292284518480301, 0.03643447533249855, -0.032663390040397644, -0.020320342853665352, 0.03585430979728699, -0.014845018275082111, 0.002017892664298415, -0.01583855412900448, 0.03382372483611107, 0.021625718101859093, -0.004938669968396425, 0.014576691202819347, -0.04394763708114624, -0.0326053760945797, -0.022452455013990402, -0.0042932345531880856, -0.0500393882393837, -7.82573624746874e-06, -0.03927729278802872, -0.02864573709666729, -0.005471698474138975, 0.009964365512132645, 0.0526791475713253, -0.013691936619579792, 0.020233318209648132, -0.025425810366868973, 0.004365755245089531, -0.019072983413934708, 0.0016462233616039157, -0.025773910805583, 0.0037747102323919535, -0.029443465173244476, 0.03225727379322052, 0.007781487423926592, -0.01465646456927061, -0.00197075423784554, -0.0026578891556710005, 0.03246033191680908, -0.041481927037239075, 0.0012709279544651508, 0.011907923966646194, -0.027833502739667892, -0.020784476771950722, -0.009297173470258713, -0.027949536219239235, 0.013887743465602398, -0.017013391479849815, -0.01520037092268467, 0.0021683734375983477, -0.00496042612940073, 0.054187580943107605, -0.002908086171373725, -0.03106793388724327, -0.01641872152686119, -0.0040829237550497055, 0.009891844354569912, 0.02503419853746891, 0.03214124217629433, 0.0002290072588948533, -0.026542631909251213, -0.014438902027904987, -0.004126436542719603, -0.056508246809244156, -0.014569438993930817, 0.007078035268932581, 0.003995899111032486, 0.012756417505443096, -0.012538854964077473, -0.001166679197922349, -0.037594810128211975, -0.032953474670648575, -0.021393651142716408, 0.016389712691307068, 0.017840130254626274, -0.016389712691307068, -0.019421083852648735, 0.013380097225308418, -0.014997311867773533, 0.013264063745737076, -0.022829564288258553, -0.01232854463160038, -0.030429748818278313, -0.046123262494802475, -0.03588331863284111, 0.018231742084026337, 0.02826862782239914, 0.016737813130021095, 0.015359916724264622, -0.004547057207673788, 0.010363229550421238, -0.02103104628622532, 0.025991473346948624, -0.03948035091161728, -0.007306475657969713, -0.023757830262184143, 0.001146735972724855, 0.03539017587900162, 0.020552409812808037, -0.02697775699198246, 0.05070658028125763, -0.013757205568253994, -0.02178526483476162, 0.05311427265405655, -0.026034986600279808, 0.026209035888314247, 0.0031038925517350435, -0.009993373416364193, -0.024221964180469513, -0.013293072581291199, -0.033707693219184875, -0.000875689263921231, 0.03170611709356308, -0.021828776225447655, 0.03475199267268181, -0.06318016350269318, -0.024047914892435074, 0.023047126829624176, 0.003537204582244158, 0.030081650242209435, -0.02029133401811123, -0.02448303997516632, -0.026818210259079933, -0.00551883690059185, 0.006316566374152899, 0.005246883723884821, 0.003122022608295083, 0.005177988670766354, 0.038610100746154785, -0.011298748664557934, 0.04183002561330795, -0.010501019656658173, -0.06915588676929474, 0.003568026004359126, 0.028529703617095947, 0.017129424959421158, -0.0018746639834716916, -0.0141415661200881, -0.033707693219184875, -0.020450880751013756, 0.0054426901042461395, 0.03153206780552864, -0.023960890248417854, 0.010116659104824066, -0.004608700051903725, -0.030429748818278313, 0.018985958769917488, -0.03475199267268181, 0.020973030477762222, 0.04905310273170471, 0.007955537177622318, -0.017361491918563843, -0.0080570662394166, -0.03570926934480667, -0.004822636488825083, -0.020813483744859695, 0.004750115796923637, 0.006312940269708633, -0.008731510490179062, -0.00857196468859911, 0.028718257322907448, -0.027673957869410515, 0.02883429080247879, 0.015098840929567814, 0.01826075091958046, 0.01808669976890087, -0.0005416400963440537, -0.013844230212271214, 0.03463595733046532, -0.00366230309009552, -0.010725834406912327, -0.0044600325636565685, -0.020697450265288353, -0.008245620876550674, -0.00039999783621169627, -0.03095190040767193, 0.026354078203439713, 0.003988646902143955, 0.0037710843607783318, 0.01116821076720953, 0.010319717228412628, -0.0019308676710352302, 0.026180027052760124, -0.01566450484097004, 0.014612951315939426, -0.009289921261370182, -0.024149443954229355, -0.017927154898643494, -0.0037892144173383713, 0.06364429742097855, 0.00921740010380745, -0.026383085176348686, 0.009420458227396011, 0.025657877326011658, 0.010160171426832676, 0.0005615833215415478, 0.014678220264613628, -0.011900671757757664, 0.014308364130556583, 0.020450880751013756, -0.01538892462849617, -0.0014857709174975753, 0.003607912454754114, -0.02095852605998516, -0.01779661700129509, 0.011501806788146496, 0.031212974339723587, 0.04499193653464317, -0.015446941368281841, 0.032489340752363205, -0.002472961088642478, -0.008796779438853264, 0.015040825121104717, -0.0003127461823169142, 0.017753103747963905, -0.001581861055456102, -0.013568651862442493, -0.012314040213823318, -0.019812697544693947, -0.007513160351663828, 0.006345574744045734, -0.007103417534381151, -0.0453980527818203, -0.036840591579675674, -0.00020351163402665406, 0.024323493242263794, -0.02013178914785385, -0.00034470067475922406, 0.03939332813024521, -0.010798354633152485, -0.1185280829668045, -0.003441114444285631, 0.00981932319700718, -0.03086487390100956, -0.00021189686958678067, -0.0030096154659986496, 0.015287395566701889, -0.005105467978864908, -0.010044137947261333, 0.016186654567718506, 0.014504170045256615, -0.045020945370197296, -0.022844068706035614, -0.027557924389839172, 0.05073558911681175, -0.05044550448656082, -0.021915800869464874, -0.014337372034788132, 0.02465708926320076, -0.017840130254626274, -0.029153382405638695, -0.014939295127987862, -0.009957113303244114, -0.019131001085042953, -0.029124373570084572, -0.03228628262877464, -0.013800717890262604, 0.01228503230959177, 0.01159608457237482, 0.008107831701636314, 0.0036641161423176527, -0.010094902478158474, 0.04635532945394516, 0.021060055121779442, -0.04838591068983078, 0.00797729380428791, -0.0072738416492938995, 0.02530977688729763, 0.017869137227535248, 0.008441426791250706, 0.0168683510273695, -0.03608637675642967, 0.04513697698712349, -0.005895945243537426, 0.009478474967181683, 0.015113345347344875, -0.0002928029280155897, -0.002260837471112609, 0.008608224801719189, -0.022553984075784683, 0.003047688864171505, -0.008463183417916298, -0.0008058879757300019, -0.011509058997035027, -0.02615102007985115, -0.023714318871498108, -0.016056116670370102, -0.03460695222020149, -0.043802592903375626, 0.012110982090234756, 0.021828776225447655, 0.048356905579566956, 0.015055328607559204, -0.0195661261677742, -0.03069082461297512, -0.025701390579342842, -0.0010016942396759987, 0.022191381081938744, 0.01929054595530033, -0.02910986915230751, -0.0019888842944055796, 0.03376570716500282, 0.012944972142577171, 0.018971454352140427, -0.019812697544693947, -0.04183002561330795, 0.02976255677640438, 0.03399777412414551, -0.033881742507219315, 0.0072412071749567986, 0.030110657215118408, -0.03344661742448807, 0.009609012864530087, -0.022191381081938744, -0.014199582859873772, 0.041655976325273514, 0.01789814606308937, -0.042236145585775375, -0.026441102847456932, 0.036202408373355865, 0.04246821254491806, -0.03495505079627037, 0.00807157065719366, -0.005895945243537426, -0.024526551365852356, -0.03150305896997452, -0.002487465273588896, 0.030893882736563683, 0.029603011906147003, 0.02354026772081852, 0.013104517944157124, 0.013242307119071484, -0.012763669714331627, -0.028384661301970482, 0.04072771221399307, 0.022844068706035614, 0.02104555070400238, -0.01488127838820219, 0.03715968504548073, -0.023670805618166924, 0.00866624154150486, -0.03393976017832756, -0.026209035888314247, 0.04174300283193588, -0.020987534895539284, 0.02641209401190281, 0.04444077983498573, 0.01530189998447895, 0.024961676448583603, 0.0025382298044860363, 0.03646348416805267, 0.00292984233237803, 0.010696825571358204, 0.010189179331064224, -0.013133525848388672, -0.030719833448529243, -0.00908686313778162, -0.0116323446854949, -0.019725671038031578, 0.014489666558802128, 0.02541130594909191, 0.0036586769856512547, 0.012444578111171722, 0.018202733248472214, -0.025077709928154945, -0.021089063957333565, 0.028326645493507385, 0.013082761317491531, -0.008978081867098808, 0.021799767389893532, -0.008550208061933517, 0.011160959489643574, 0.026005977764725685, 0.0037457020953297615, 0.00618965458124876, 0.011973192915320396, -0.006682796403765678, -0.023293698206543922, 0.005972092039883137, 0.018942447379231453, 0.015417933464050293, -0.005159858614206314, 0.019682159647345543, 0.026658665388822556, 0.017085913568735123, 0.02689073234796524, -0.017782112583518028, -0.022104356437921524, -0.002726783975958824, 0.006951123476028442, 0.03463595733046532, 0.024323493242263794, 0.0016706991009414196, -0.0016852032858878374, 0.014583943411707878, -0.026832714676856995, -0.01469272468239069, -0.011494554579257965, -0.004206209443509579, 0.021205097436904907, -0.014772497117519379, -0.05337534844875336, 0.030632808804512024, -0.0008466809522360563, 0.02095852605998516, 0.007052653003484011, -0.0014939295360818505, -0.00931892916560173, 0.004920539911836386, 0.050184428691864014, -0.010972404852509499, 0.019986746832728386, -0.01873938739299774, 0.006700926925987005, 0.03892919421195984, -0.004851644858717918, 0.01223426777869463, 0.010268952697515488, 0.0018474686658009887, 0.021176088601350784, -0.02568688616156578, 0.017027895897626877, 0.00026062180404551327, 0.016563761979341507, 0.03782687708735466, -0.016244670376181602, 0.0038472311571240425, 0.033707693219184875, -0.01659277081489563, -0.04739962890744209, -0.036289434880018234, 0.020973030477762222, -0.009993373416364193, -0.0161141324788332, -0.0507936030626297, 0.034171827137470245, -0.00490966159850359, -0.01172662153840065, -0.009507483802735806, 0.01881190948188305, -0.003029558574780822, 0.015504958108067513, 0.02300361357629299, 0.005794416181743145, 0.03492604196071625, -0.0034973181318491697, 0.019435588270425797, -0.008738762699067593, -0.03568026050925255, -0.03530314937233925, -0.011204471811652184, -0.030922891572117805, -0.004753741901367903, 0.005486202426254749, -0.00036532379454001784, 0.026441102847456932, 0.013771709986031055, 0.007295597810298204, -0.016201158985495567, 0.02216237224638462, 0.0062803057953715324, -0.016288183629512787, -0.006276679690927267, 0.009674281813204288, 0.010305212810635567, -0.031300000846385956, -0.015287395566701889, 0.01163959689438343, 0.015548470430076122, -0.007549420464783907, 0.03002363257110119, -0.008891056291759014, -0.01781112141907215, -0.03605736792087555, 0.0011331383138895035, 0.0029914851766079664, 0.0010279830312356353, 0.030574791133403778, -0.04681946337223053, 0.02253948152065277, -0.013844230212271214, -0.021451668813824654, 0.04153994470834732, -0.023699814453721046, 0.027369368821382523, 0.029820574447512627, 0.018782900646328926, 0.07153456658124924, 0.03246033191680908, 0.03634745255112648, -0.03179313987493515, 0.010268952697515488, 0.014540431089699268, -0.01917451247572899, -0.010885380208492279, -0.01232854463160038, 5.7613001445133705e-06, 0.013815222308039665, -0.0026433849707245827, 0.0028464433271437883, 0.0026633283123373985, 0.02383035235106945, 0.0296610277146101, 0.0398864671587944, -0.007701714523136616, 0.014366380870342255, 0.03863910958170891, -0.009616265073418617, 0.0220753476023674, 0.02744189091026783, -0.025570852681994438, -0.01947910152375698, -0.0186233539134264, -0.006813333835452795, 0.024613577872514725, -0.03858109191060066, -0.023801343515515327, 0.008927317336201668, 0.032866451889276505, 0.033591657876968384, -0.008151344023644924, 0.014511422254145145, -0.0407567173242569, -0.02706478163599968, 0.028022056445479393, 0.007215824909508228, -0.01789814606308937, 0.010152919217944145, 0.02235092595219612, -0.026209035888314247, 0.013887743465602398, 0.00848494004458189, 0.03385273367166519, -0.04708053544163704, 0.028674744069576263, 0.009340685792267323, 0.007694462314248085, -0.047428637742996216, 0.0028736386448144913, -0.008260125294327736, -0.0016335322288796306, 0.03179313987493515, 0.005565975327044725, 0.044730860739946365, -0.006102629471570253, -0.006454356014728546, -0.022553984075784683, 0.0075421687215566635, 0.0038798656314611435, -0.0134816262871027, 0.022321918979287148, -0.010957900434732437, 0.0009536492289043963, 0.021393651142716408, -0.015591982752084732, -0.013474374078214169, -0.0469064861536026, -0.0016498493496328592, 0.003161909058690071, 0.034490916877985, 0.01604161225259304, -0.02197381854057312, -0.0045615616254508495, 0.016723308712244034, -0.021205097436904907, 0.01224151998758316, -0.026165522634983063, 0.00423884391784668, -0.0012500782031565905, -0.0032326169312000275, 0.013786214403808117, 0.016056116670370102, -0.009159383364021778, 0.02446853555738926, -0.001554665737785399, 0.0322282649576664, -0.017201945185661316, 0.02890681102871895, 0.005986596457660198, -0.0027521662414073944, 0.0652107521891594, 0.002686897525563836, 0.0018411230994388461, -0.003470122814178467, -0.004750115796923637, 0.028384661301970482, -0.01344536617398262, -0.023105142638087273, -0.04243920370936394, -0.01474348921328783, -0.00012305882410146296, 0.010218188166618347, -0.011276992037892342, -0.02121960185468197, 0.05610213056206703, 0.015708016231656075, -0.025193743407726288, 0.0079337814822793, -0.0015428811311721802, 0.032489340752363205, 0.019450092688202858, 0.011791890487074852, -0.01478700153529644, -0.027398377656936646, 0.0013842417392879725, 0.045746155083179474, -0.00987008772790432, 0.01585305854678154, 0.03228628262877464, 0.046036235988140106, 0.009949861094355583, -0.007607437204569578, -0.018681371584534645, -0.006193280685693026, -0.021901296451687813, -0.009057854302227497, -0.007527664303779602, 0.010058642365038395, 0.02095852605998516, -0.028674744069576263, 0.0011802768567577004, -0.0066284057684242725, -0.019319554790854454, 0.015577479265630245, -0.029733549803495407, 0.016549257561564445, 0.02604948915541172, 0.005819798447191715, -0.005119971930980682, 0.00861547701060772, 0.03431686758995056, 0.01094339694827795, 0.012502594850957394, 0.002233642153441906, 0.013242307119071484, -0.009514736011624336, -0.01034147385507822, 0.04951723664999008, 0.020421871915459633, -0.014344624243676662, -0.009094114415347576, -0.0026542632840573788, -0.019696664065122604, 0.017100416123867035, -0.008702502585947514, -0.02697775699198246, -0.01159608457237482, 0.012168998830020428, -0.015650000423192978, 0.009609012864530087, -0.015098840929567814, -0.029095366597175598, 0.011886167339980602, -0.02401890605688095, 0.009340685792267323, 0.010559036396443844, -0.024599073454737663, -0.007999050430953503, 0.02641209401190281, 0.0383780337870121, -0.017390500754117966, -0.025614364072680473, -0.021306626498699188, 0.0036187905352562666, -0.010232692584395409, -0.017753103747963905, 0.026281556114554405, 0.011617840267717838, -0.05035847797989845, 0.0067625693045556545, 0.011480051092803478, 0.012502594850957394, 0.03254735842347145, 0.005736399441957474, -0.036115385591983795, 0.019682159647345543, -0.007868512533605099, -0.005707391072064638, 0.009471223689615726, -0.006479738280177116, -0.014939295127987862, 0.008173099718987942, -0.001805769163183868, 0.0075784288346767426, -0.015316404402256012, 0.017854634672403336, -0.010820111259818077, -0.034810010343790054, -0.004873401485383511, 0.013097265735268593, -0.006040987093001604, -0.013771709986031055, 0.04522400349378586, 0.025614364072680473, -0.020044762641191483, 0.022670017555356026, 0.006320192478597164, 0.059467099606990814, -0.012009453028440475, -0.04580416902899742, 0.0050293211825191975, 0.04504995420575142, 0.01089263241738081, 0.009609012864530087, -0.004108306486159563, 0.0097830630838871, -0.03321455046534538, -0.02233642153441906, -0.024628080427646637, 0.01927604153752327, -0.01483051385730505, -0.005852432921528816, 0.008586469106376171, -0.008028058335185051, -0.012089226394891739, 0.010660565458238125, 0.0007682677824050188, 0.006733560934662819, -0.023337209597229958, -0.03161909058690071, 0.02976255677640438, 0.0296610277146101, 0.010015130043029785, -0.004260600078850985, 0.012683897279202938, -0.012306788936257362, 0.0030712580773979425, -0.0023025369737297297, -0.025918953120708466, 0.019798193126916885, -0.006711804773658514, -0.017375996336340904, 0.005497080739587545, 0.020610425621271133, -0.0033504634629935026, -0.013206047005951405, -0.009543743915855885, -0.031851157546043396, 0.026296060532331467, -0.006167898420244455, 0.021625718101859093, -0.011385773308575153, -0.00486614927649498, 0.04858897253870964, 0.033794716000556946, -0.0259624645113945, -0.029414458200335503, 0.0023496756330132484, 0.023844856768846512, -0.029138877987861633, 0.008724258281290531, 0.007103417534381151, 0.00401040306314826, 0.010754842311143875, -0.016476737335324287, -0.027470897883176804, -0.01889893412590027, 0.02420745976269245, -0.03634745255112648, 0.01621566340327263, -0.004753741901367903, -0.016346199437975883, 0.013264063745737076, 0.01927604153752327, -0.02457006461918354, -0.006806082092225552, 0.01929054595530033, -0.00021416314120870084, 0.004188079386949539, -0.011712118051946163, -0.00010730819485615939, -0.02864573709666729, -0.003649611957371235, 0.011211724020540714, 0.031764134764671326, 0.04174300283193588, -0.000519883877132088, 0.01394576020538807, -0.00641809543594718, 0.005856059025973082, 0.0023823098745197058, -0.022670017555356026, -8.504203287884593e-05, -0.01650574617087841, -0.001323505537584424, 0.003161909058690071, -0.010965152643620968, -0.004111932124942541, 0.010370481759309769, -0.018666867166757584, -0.0008090607589110732, -0.0070272707380354404, 0.005769033916294575, 0.014612951315939426, 0.02446853555738926, -0.02742738649249077, 0.011233479715883732, -0.0014386323746293783, -0.035361167043447495, 0.0026034985203295946, -0.0034791878424584866, -0.001052458886988461, 0.028442678973078728, 0.005794416181743145, -0.03272140771150589, 0.022379934787750244, 0.034868024289608, 0.011741125956177711, 0.013256811536848545, 0.03643447533249855, 0.016172150149941444, -0.001599991344846785, -0.012161746621131897, 0.006755317561328411, -0.0207554679363966, 0.00676619540899992, -0.020436376333236694, -0.009442214854061604, 0.002300723921507597, 0.008999837562441826, -0.028123585507273674, 0.017535541206598282, -0.0051634847186505795, 0.022974606603384018, -0.019783688709139824, 0.030168674886226654, 0.005112720187753439, 0.02159670926630497, -0.03977043554186821, 9.54669030761579e-06, -0.007774235215038061, -0.0017821999499574304, -0.00493504386395216, -0.03892919421195984, 0.014953799545764923, -0.01704240031540394, 0.013372845016419888, -0.03736274316906929, -0.011951436288654804, 0.05175087973475456, -0.006686422508209944, -0.022408943623304367, 0.006853220518678427, -0.012727409601211548, 0.01219800766557455, 0.024903660640120506, -0.03614439442753792, 0.0011875289492309093, -0.0005171642987988889, -0.02355477213859558, 8.249247184721753e-05, -0.01881190948188305, 0.005540593061596155, -0.010051390156149864, -0.024729611352086067, 0.03820398449897766, 0.008245620876550674, -0.009928104467689991, 0.008999837562441826, -0.04412168636918068, 0.016795828938484192, 0.0039487602189183235, -0.025889944285154343, -0.011429286561906338, 0.012103729881346226, 0.026455607265233994, -0.026441102847456932, -0.007803243584930897, -0.03127099201083183, 0.021756255999207497, -0.015359916724264622, 0.017013391479849815, 0.008840291760861874, -0.011284244246780872, -0.026063993573188782, 0.01779661700129509, 0.0097830630838871, -0.010508271865546703, -0.03214124217629433, 0.011654101312160492, -0.011494554579257965, -0.019885217770934105, -0.016157645732164383, 0.015925578773021698, 0.038610100746154785, 0.06387636810541153, -0.01631719246506691, 0.04162696748971939, -0.014148818328976631, 0.007890269160270691, 0.008361654356122017, 0.011922428384423256, -0.01534541230648756, 0.026861723512411118, 0.0007243020227178931, 0.014482414349913597, -0.034258849918842316, 0.03254735842347145, -0.024686098098754883, 0.021364642307162285, -0.020610425621271133, -0.004434650298207998, -0.018231742084026337, 0.00215386925265193, -0.009144879877567291, 0.020726459100842476, -0.03802993521094322, -0.00866624154150486, 0.025353290140628815, -0.016462232917547226, 0.035651251673698425, 0.00700188847258687, 0.053259313106536865, -0.014286607503890991, -0.002540042856708169, 0.02467159368097782, 0.0020287707448005676, 0.034171827137470245, 0.03498405963182449, -0.03251834958791733, -0.021016543731093407, -0.010588044300675392, 0.009050602093338966, -0.028297636657953262, -0.0246425848454237, 0.03318554162979126, -0.047979794442653656, -0.007658202201128006, -0.017854634672403336, 0.005301274359226227, 0.05450667068362236, 0.0271518062800169, 0.023612789809703827, -0.009333433583378792, 0.03959638625383377, 0.026034986600279808, -0.005899571347981691, -0.02066844329237938, -0.015374420210719109, -0.0008892869227565825, -0.012205258943140507, 0.004452780354768038, 0.03005264140665531, 0.013590407557785511, 0.006508746650069952, 0.02625254914164543, 0.001530189998447895, -0.013329332694411278, -0.001095064915716648, 0.013307576067745686, -0.00395963853225112, 0.03826200217008591, 0.014264851808547974, -0.001039767754264176, -0.0259624645113945, -0.003977768588811159, -0.017114920541644096, -0.026484614238142967, 0.007172312121838331, -0.00609537772834301, 0.01538892462849617, -0.023206673562526703, -0.019421083852648735, -0.017259962856769562, -0.01649124175310135, 0.005783537868410349, -0.013735448941588402, 0.013278568163514137, -0.00853570457547903]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" special token ⟨Vpotter⟩as what has been introduced in textual inversion
(Gal et al., 2022), then in the sampling procedure, we use prompt with special character ⟨Vpotter⟩for generating images
involving Potter character. Figure 7, 8 and 9 show the generation results for three different prompts. The above two
rows are for AdamW optimizer with the first row having LoRA parameter fusion coefficient 0.7and second row 1and
the third and fourth rows correspond to scaled AdamW generation. LoRA parameter fusion coefficient represents αin
W=W0+αABTwhen merging LoRA weights. We observe that our scaled AdamW method is able to generate higher
quality images compared to unscaled version for both α= 0.7andα= 1. For Hermione character, we train with 15photos
of Hermione following procedure described before. Figure 10 and 11 show the generation results. Still, our scaled AdamW
optimizer produces higher quality images compared to AdamW optimizer.
Figure 7. Generation results for prompt “a ⟨Vpotter⟩in front of eiffel tower” after fine-tuning on 14Potter images. The above two rows
are from AdamW optimizer and the bottom two rows are from our scaled AdamW optimizer. The first and third rows correspond to
LoRA parameter fusion coefficient 0.7and the second and fourth rows correspond to LoRA parameter fusion coefficient 1.0. Our scaled
AdamW method generates images of higher quality compared to AdamW. See Appendix F.2.1 for experimental details.
F.2.2. V ARYING STEPSIZES
Here we test with varying step sizes. Note the Mix-of-Show repository uses AdamW as default optimizer with learning rate
1e−5for text-encoder tuning and 1e−4for U-Net tuning. SGD method is not used in original repository. We emprically
observe that SGD requires larger learning rate compared to AdamW to generate sensible images. For this experiment,
we test with three groups of learning rates, with “Large” corresponds to 3e−1for SGD-type methods and 5e−4for
2https://civitai.com/models/6424/chilloutmix
25
Riemannian Preconditioned LoRA
Figure 8. Generation results for prompt “ ⟨Vpotter⟩eating an icecream ” after fine-tuning on 14Potter images. The above two rows are
from AdamW optimizer and the bottom two rows are from our scaled AdamW optimizer. The first and third rows correspond to LoRA
parameter fusion coefficient 0.7and the second and fourth rows correspond to LoRA parameter fusion coefficient 1.0. Our scaled AdamW
method generates images of higher quality compared to AdamW. See Appendix F.2.1 for experimental details.
Figure 9. Generation results for prompt “ ⟨Vpotter⟩” after fine-tuning on 14Potter images. The above two rows are from AdamW optimizer
and the bottom two rows are from our scaled AdamW optimizer. The first and third rows correspond to LoRA parameter fusion coefficient
0.7and the second and fourth rows correspond to LoRA parameter fusion coefficient 1.0. Our scaled AdamW method generates images
of higher quality compared to AdamW. See Appendix F.2.1 for experimental details.
AdamW-type methods; “Medium” corresponds to 1e−1for SGD-type methods and 1e−4for AdamW-type methods;
“Small” corresponds to 5e−2for SGD-type methods and 1e−5for AdamW-type methods. We don’t differentiate learning
rates for U-Net and text-encoder tuning and the same learning rate is used for both. Note the default learning rate for
AdamW falls between the “Medium” learning rate and the “Small” learning rate thus our learning rate choices are not
random. Figure 12, 13 and 14 show the generation results for three different prompts. It can be observed that our scaled
optimizers are more robust to learning rate changes.
26
Riemannian Preconditioned LoRA
Figure 10. Generation results for prompt “ ⟨Vhermione⟩wearing a red hat” after fine-tuning on 15Hermione images. The above two rows
are from AdamW optimizer and the bottom two rows are from our scaled AdamW optimizer. The first and third rows correspond to
LoRA parameter fusion coefficient 0.7and the second and fourth rows correspond to LoRA parameter fusion coefficient 1.0. Our scaled
AdamW method generates images of higher quality compared to AdamW. See Appendix F.2.1 for experimental details.
Figure","[0.025652995333075523, -0.0051568071357905865, 0.013473989441990852, -0.025622162967920303, -0.02372593805193901, -0.027194641530513763, 0.04785270243883133, 0.005179931875318289, -0.037770334631204605, 0.03684534877538681, -0.0033530809450894594, 0.011122978292405605, -0.051336824893951416, -0.0015522452304139733, 0.01828392595052719, 0.004254944156855345, -0.0007062667282298207, -0.008062810637056828, -0.05244680866599083, 0.0007852761191315949, 0.02750297077000141, -0.02088930830359459, 0.011346517130732536, 0.04143945500254631, 0.02381843701004982, 0.0026381423231214285, 0.012356295250356197, 0.0020195567049086094, 0.04967184737324715, -0.008656344376504421, 0.00811676774173975, -0.041994448751211166, -0.01792934723198414, -0.04307359829545021, -0.008586970157921314, 0.0069836582988500595, 0.017297271639108658, 0.008348015137016773, -0.01411377266049385, -0.0035380783956497908, -0.005334096495062113, -0.05525260418653488, -0.01825309358537197, -0.007037615869194269, -0.002892513992264867, 0.016372283920645714, -0.015169800259172916, -0.030478348955512047, 0.027348807081580162, -0.02236928977072239, -0.04560190066695213, 0.06030920520424843, 0.0150850098580122, -0.07517067342996597, -0.0007216832018457353, -0.024835923686623573, 0.025221334770321846, 0.02904461696743965, 0.05266264081001282, -0.042333610355854034, 0.040976960211992264, -0.026485484093427658, 0.02680923044681549, -0.006740848533809185, -0.0027055894024670124, 0.007827709428966045, -0.0682024359703064, -0.006193564273416996, 0.001514667528681457, 0.021043473854660988, 0.011624014005064964, 0.027425888925790787, 0.023710520938038826, -0.0282275453209877, -0.016665197908878326, 0.03200457990169525, 0.02369510382413864, -0.010452362708747387, -0.006097211502492428, -0.01540104765444994, 0.0016601604875177145, 0.002632361138239503, 0.04436858370900154, -0.026485484093427658, -0.017913930118083954, -0.02744130603969097, 0.001567661645822227, -0.025498831644654274, -0.03209707885980606, -0.015801874920725822, -0.008386556059122086, 0.006463352590799332, 0.01862308755517006, 0.005657842382788658, 0.03647535294294357, 0.012649208307266235, 0.018068095669150352, -0.05525260418653488, 0.0013518311316147447, 0.0505351684987545, 0.06653745472431183, 0.006447935942560434, -0.011785886250436306, 0.0221534576267004, 0.03007752075791359, -0.014437518082559109, 0.00873342715203762, 0.017605600878596306, -0.021845128387212753, 0.01003611832857132, -0.06370082497596741, 0.011986300349235535, -0.03055543079972267, -0.006829493213444948, -0.011254018172621727, -0.07264237850904465, -0.04261110723018646, -0.01543188001960516, -0.023371359333395958, -0.032898735255002975, -0.02460467629134655, -0.003740419400855899, 0.011146103031933308, -0.03505703806877136, 0.05432761833071709, -0.0028057964518666267, 0.021891377866268158, -0.045632731169462204, 0.0023086154833436012, -0.037677835673093796, 0.02714839205145836, 0.018422674387693405, 0.031449586153030396, -0.045293569564819336, -0.037492841482162476, 0.0057657575234770775, -0.006941262632608414, 0.007669690530747175, -0.0028886599466204643, 0.05688675120472908, -0.019609741866588593, -0.04125445708632469, 0.011331100948154926, 0.014267937280237675, -0.001413497026078403, 0.004871602635830641, -0.041994448751211166, 0.039373647421598434, -0.05204598233103752, 0.003871459513902664, -0.036012858152389526, 0.011146103031933308, -0.03949698060750961, -0.021058889105916023, -0.01533938106149435, -0.01301149558275938, -0.011215477250516415, 0.03829449415206909, -0.005746487062424421, 0.0006518273730762303, -0.05229264497756958, 0.013258159160614014, 0.022662201896309853, -0.04409108683466911, 0.016033122316002846, 0.0012728217989206314, -0.032929565757513046, 0.026593400165438652, -0.10008367896080017, -0.014745847322046757, -0.006270646583288908, 0.008378848433494568, -0.029368363320827484, -0.028088796883821487, 0.018792668357491493, -0.015971455723047256, -0.043998587876558304, -0.003395476145669818, -0.021505966782569885, -0.007507817819714546, 0.01184755191206932, 0.04772937297821045, -0.04039113596081734, 0.004794520325958729, -0.013350657187402248, 0.0005906432634219527, -0.016449367627501488, -0.04261110723018646, -0.000570890901144594, -0.011377350427210331, 0.03579702973365784, 0.009812579490244389, 0.09613706916570663, -0.006829493213444948, 0.025837993249297142, -0.060740865767002106, 0.10631193220615387, 0.016649780794978142, -0.015863541513681412, 0.011554639786481857, 0.009511957876384258, 0.05044266954064369, 0.04177861660718918, -0.05118266120553017, 0.025036336854100227, -0.028844203799962997, -0.012957537546753883, 0.015878956764936447, 0.030370432883501053, -0.00743458978831768, 0.040884461253881454, 0.015108134597539902, 0.021690964698791504, -0.014414393343031406, -0.06579747051000595, 0.004524732008576393, -0.05392678827047348, 0.043813589960336685, 0.012456502765417099, 0.04264193773269653, -0.006251376122236252, 0.06962075084447861, 0.04427608475089073, 0.03197374567389488, -0.04140862077474594, -0.019054749980568886, 0.009234461933374405, -0.03659868612885475, -0.02010306902229786, 0.002699808217585087, -0.0016987016424536705, 0.022785533219575882, -0.006871888879686594, -0.03271373733878136, 0.007365215569734573, -0.0626833438873291, 0.0047020213678479195, -0.002181429648771882, -0.010830066166818142, -0.02759546972811222, 0.014630223624408245, 0.006883451249450445, 0.083310566842556, -0.013643570244312286, -0.022076375782489777, 0.021228469908237457, 0.004258797969669104, -0.045231904834508896, 0.0016360721783712506, -0.0026978810783475637, 0.016279784962534904, -0.019609741866588593, -0.03826366364955902, -0.012656916864216328, -0.037801168859004974, 0.002248876728117466, -0.013003787025809288, 0.04609522596001625, -0.013165660202503204, -0.006324604153633118, 0.005045037716627121, 0.016541864722967148, 0.00811676774173975, 0.07233405113220215, -0.008232391439378262, 0.012055674567818642, -0.022508036345243454, 0.021290136501193047, 0.009442583657801151, 0.009758621454238892, -0.027795884758234024, -0.02687089703977108, 0.039281148463487625, -0.005503677763044834, -0.018453506752848625, -0.0014549287734553218, 0.021182220429182053, 0.027580054476857185, -0.04125445708632469, 0.025113418698310852, -0.023772187530994415, -0.006925846450030804, 0.03228207677602768, 0.042086947709321976, -0.010359863750636578, -0.0009534119162708521, -0.03851032629609108, -0.004027551040053368, -0.011015063151717186, -0.02025723271071911, -0.0018981520552188158, -0.0655508041381836, 0.05386512354016304, -0.02315552905201912, -0.02088930830359459, 0.023371359333395958, 0.03419371694326401, -0.003123760921880603, 0.02001057006418705, 0.033237896859645844, 0.07683565467596054, 0.004644209519028664, 0.02916795015335083, 0.03555036708712578, -0.006656058132648468, 0.017066026106476784, -0.006023983005434275, -0.007577192038297653, -0.01982557214796543, 0.00887217465788126, -0.027795884758234024, 0.02457384392619133, 0.004582543857395649, 0.008563845418393612, -0.0007626331644132733, -0.03243624046444893, 0.04116195812821388, -0.008016561158001423, 0.0059122140519320965, 0.0018345591379329562, -0.030277933925390244, -0.02744130603969097, -0.019116414710879326, -0.023710520938038826, -0.01749768666923046, -0.048438530415296555, -0.0286900382488966, 0.012317754328250885, 0.007261154241859913, -0.02778046764433384, -0.02067347802221775, -0.01072985865175724, 0.010144033469259739, 0.012009425088763237, -0.011978592723608017, -0.010074659250676632, -0.06505747884511948, 0.011439016088843346, 0.06481081247329712, 0.02747213840484619, -0.10748358815908432, -0.0221534576267004, 0.010876314714550972, -0.020750559866428375, -0.018222259357571602, -0.0019000791944563389, 0.023170944303274155, -0.03434788063168526, 0.03659868612885475, 0.026762980967760086, -0.008972382172942162, -0.011932343244552612, 0.020596396178007126, 0.027379639446735382, -0.010830066166818142, -0.013967316597700119, 0.01343544851988554, -0.024327179417014122, -0.05179931968450546, 0.03866448998451233, -0.029029201716184616, 0.03077126108109951, -0.0034764125011861324, -0.0005251233233138919, -0.011292560026049614, 0.012194423004984856, 0.0033627161756157875, 0.04415275156497955, 0.0025610600132495165, -0.015385630540549755, -0.022138042375445366, 0.04661938548088074, -0.009527374990284443, 0.013412323780357838, -0.07258071005344391, 0.024234680458903313, -0.0047636874951422215, 0.006239813752472401, -0.0023490835446864367, 0.057719241827726364, -0.009226753376424313, -0.002160232048481703, -5.699876055587083e-05, 0.015223758295178413, -0.01680394634604454, -0.02472800761461258, 0.011947759427130222, -0.0023394483141601086, -0.06474914401769638, -0.029568778350949287, 0.011662554927170277, -0.01979473978281021, -0.021567633375525475, 0.015786459669470787, 0.0014337311731651425, 0.028458792716264725, -0.0018788814777508378, 0.04180945083498955, 0.028674622997641563, 0.050011008977890015, 0.0059199221432209015, -0.004717438016086817, -0.06388582289218903, -0.023386774584650993, -0.01601770520210266, 0.012101924046874046, -0.001199593534693122, 0.03690701350569725, 0.03074042871594429, 0.016341451555490494, -0.008024269714951515, -0.019902653992176056, 0.033083729445934296, -0.039466146379709244, 0.008610094897449017, -0.01931682974100113, 0.0738140270113945, -0.010591110214591026, 0.009558207355439663, 0.062220849096775055, -0.08694885671138763, -0.03143417090177536, -0.006363145541399717, -0.03373122215270996, -0.003705732524394989, 0.02007223665714264, 0.014768972061574459, -0.046896882355213165, -0.0143450191244483, -0.05109016224741936, -0.031572919338941574, 0.04316609725356102, 0.04739020764827728, -0.02853587456047535, -0.04486190900206566, -0.051645152270793915, -0.005939192604273558, 0.048438530415296555, 0.03505703806877136, -0.012764832004904747, 0.05858256295323372, -0.0168964434415102, -0.0064517902210354805, -0.01913183182477951, -0.027610886842012405, 0.03049376606941223, 0.008463638834655285, 0.036043692380189896, 0.008340306580066681, -0.02995418943464756, -0.02711755968630314, -0.022693034261465073, 0.01006695069372654, 0.023386774584650993, 0.033145397901535034, -0.05250847712159157, 0.07930228859186172, -0.02472800761461258, 0.040730297565460205, -0.014846054837107658, 0.018700171262025833, -0.03721534460783005, -0.028921285644173622, -0.014267937280237675, 0.015478129498660564, 0.010113200172781944, -0.034594543278217316, 0.03524203598499298, 0.039034485816955566, -0.027194641530513763, 0.0058582560159265995, -0.028427958488464355, -0.0011668335646390915, -0.0033530809450894594, -0.004944830667227507, -0.006517310161143541, -0.014591682702302933, -0.031156674027442932, 0.01859225519001484, -0.05849006399512291, 0.03724617511034012, 0.010845482349395752, 0.014522308483719826, -0.023679688572883606, -0.021120555698871613, 0.07276570796966553, 0.043936923146247864, -0.013127119280397892, -0.012317754328250885, -0.0073844860307872295, -0.037862833589315414, -0.03194291144609451, 0.005006496794521809, -0.01994890347123146, 0.04560190066695213, -0.013003787025809288, -0.002337521407753229, -0.02973835915327072, -0.007839271798729897, -0.043967753648757935, 0.04973351210355759, -0.03687618300318718, 0.006694599520415068, 0.017251022160053253, 0.00224502244964242, -0.028181295841932297, 0.05519093945622444, 0.0403294675052166, -0.003183499677106738, 0.007288133259862661, -0.01686561107635498, 0.04436858370900154, -0.01919349655508995, 0.009827995672821999, -0.02898295223712921, 0.02832004427909851, 0.005075870547443628, 0.05229264497756958, -0.0065442887134850025, 0.026793813332915306, -0.032929565757513046, 0.0009394407388754189, -0.028643788769841194, -0.019717657938599586, 0.0006961497128941119, -0.00994361937046051, -0.00997445173561573, -0.08417389541864395, -0.01080694142729044, -0.006047107744961977, 0.015593753196299076, -0.03536536917090416, -0.0163877010345459, -0.015925206243991852, -0.054697614163160324, -0.012155882082879543, 0.029245031997561455, 0.01432960294187069, -0.042148612439632416, 0.010483195073902607, 0.027487555518746376, 0.002969596302136779, 0.010136324912309647, 0.01348169706761837, -0.009380917996168137, 0.008556137792766094, 0.045941062271595, -0.0013152171159163117, 0.021567633375525475, 0.010282780975103378, 0.018268508836627007, -0.028643788769841194, 0.00449004489928484, -0.053094301372766495, -0.030308768153190613, 0.013928774744272232, -0.028967535123229027, -0.006952825002372265, -0.0046866051852703094, 0.005889089312404394, 0.024743424728512764, 0.02092014066874981, 0.02765713632106781, -0.007253446150571108, 0.005993150174617767, 0.03255956992506981, 0.0269017294049263, 0.019594324752688408, -0.03228207677602768, 0.029969604685902596, -0.008317181840538979, -0.0015763334231451154, 0.04911685362458229, -0.042302776128053665, -0.019393911585211754, -0.03218957781791687, 0.017328105866909027, 0.02838170900940895, -0.021690964698791504, 0.005445865914225578, -0.03502620384097099, -0.01907016523182392, -0.00973549671471119, 0.02221512421965599, -0.025005504488945007, 0.01853058859705925, -0.03555036708712578, -0.01190921850502491, 0.0008666943176649511, 0.012865038588643074, 0.04017530381679535, -0.0055345105938613415, 0.017328105866909027, -0.009604456834495068, 0.017790598794817924, 0.0024435094092041254, -0.009681539610028267, -0.039034485816955566, -0.015578337013721466, -0.0131194107234478, 0.01828392595052719, -0.017513101920485497, -0.0012506606290116906, 0.013088577426970005, -0.027040477842092514, 0.01671144738793373, -0.062220849096775055, -0.0111538115888834, 0.014776680618524551, 0.019147247076034546, 0.0024088225327432156, -0.00931154377758503, -0.0214905496686697, 0.03191208094358444, -0.04671188443899155, 0.015863541513681412, 0.003185426816344261, -0.009982160292565823, 0.032991234213113785, 0.005195348057895899, -0.004971809685230255, -0.007712086196988821, -0.014036689884960651, 0.024404261261224747, 0.027487555518746376, 0.018792668357491493, 0.0011687607038766146, -0.04017530381679535, -0.0162335354834795, -0.005873672664165497, -0.043628592044115067, -0.015015635639429092, 0.018222259357571602, 0.006058670114725828, 0.015231465920805931, -0.0260846558958292, 0.008702593855559826, -0.034810375422239304, -0.006031691562384367, -0.016372283920645714, 0.011755053885281086, 0.01765185035765171, -0.0056193009950220585, -0.013250450603663921, 0.004031405318528414, -0.01626436971127987, 0.015270007774233818, -0.006289917044341564, -0.030940841883420944, -0.04116195812821388, -0.030601680278778076, -0.01533938106149435, 0.019609741866588593, 0.007053032051771879, 0.00501805916428566, -0.00843280553817749, -0.022353872656822205, -0.003243238665163517, -0.012733998708426952, 0.009666122496128082, -0.0038136476650834084, -0.008972382172942162, -0.011323392391204834, -0.011207768693566322, 0.07171738892793655, 0.011007355526089668, -0.0031295421067625284, 0.06037087365984917, -0.006328458432108164, -0.03866448998451233, 0.03977447748184204, -0.018376424908638, 0.03832532837986946, 0.012394837103784084, -0.0005675185821019113, -0.009997576475143433, -0.01849975623190403, -0.027287140488624573, 0.02252345345914364, 0.0058428398333489895, -0.01916266418993473, 0.029676692560315132, -0.034810375422239304, 0.00896467361599207, 0.02478967420756817, -0.0060047125443816185, 0.02696339413523674, -0.025683827698230743, -0.0026766834780573845, 0.010776108130812645, -0.014576266519725323, 0.009650706313550472, 0.022800950333476067, -0.04011363908648491, 0.0033453726209700108, 0.021058889105916023, -0.0021775756031274796, 0.04005197435617447, -0.022693034261465073, -0.08152226358652115, -0.016680613160133362, 0.021475134417414665, 0.023232610896229744, 0.013635862618684769, -0.012957537546753883, -0.03152666985988617, -0.011346517130732536, 0.025467997416853905, 0.03496453911066055, -0.029368363320827484, -0.015562919899821281, -0.012703166343271732, -0.02620798908174038, 0.018361007794737816, -0.0007867214153520763, 0.034625377506017685, 0.014229396358132362, -0.017235606908798218, -0.014136897400021553, -0.013211909681558609, -0.030247101560235023, -0.0047097294591367245, -0.019239746034145355, 0.0022334600798785686, 0.011030479334294796, -0.000999179552309215, -0.0029175658710300922, 0.02472800761461258, -0.022677619010210037, 0.04809936508536339, 0.036382853984832764, 0.025020919740200043, -0.004135466180741787, -0.0024820505641400814, -0.014614807441830635, 0.031696248799562454, -0.024681758135557175, 0.011238601990044117, -0.016063954681158066, -0.01234858762472868, 0.008802800439298153, -0.027950048446655273, -0.023371359333395958, 0.025283001363277435, -0.01036757230758667, 0.007365215569734573, 0.0007178290979936719, 0.028705455362796783, -0.007041469682008028, 0.009496541693806648, -0.023710520938038826, 0.016480199992656708, -0.0247588399797678, -0.01626436971127987, 0.01994890347123146, 0.015586044639348984, 0.045632731169462204, -0.00014007302524987608, -0.004100779537111521, 0.008710302412509918, 0.009149671532213688, 0.00876425951719284, -0.0038810947444289923, -0.0015801875852048397, -0.002374135423451662, 0.03555036708712578, 0.00874884333461523, -0.04128529131412506, -0.005141390487551689, 0.005838985554873943, 0.005838985554873943, -0.008903007954359055, -0.004374421667307615, 0.009658414870500565, 0.05503677576780319, -0.006363145541399717, 0.028813371434807777, -0.03243624046444893, -0.004466920159757137, 0.009866536594927311, -0.008556137792766094, 0.007777606137096882, -0.026500901207327843, -0.023371359333395958, 0.00022173210163600743, -0.00876425951719284, 0.008348015137016773, -0.021058889105916023, -0.0030736573971807957, -0.0597233809530735, -0.031449586153030396, -0.007881667464971542, 0.002246949588879943, -0.00797802023589611, -0.007611879147589207, 0.007908646017313004, -0.019085582345724106, -0.1161784678697586, -0.0034205277916043997, 0.03262123838067055, -0.0597233809530735, -0.02753380499780178, 0.015285423956811428, 0.021968461573123932, 0.005719508044421673, -0.008879883214831352, 0.008147601038217545, 0.0334845595061779, -0.015578337013721466, -0.034717876464128494, -0.03561203181743622, 0.03413205221295357, -0.03237457200884819, -0.01072985865175724, -0.019424743950366974, 0.0047713955864310265, -0.017035191878676414, -0.02593049220740795, -0.021105138584971428, -0.024913005530834198, -0.025036336854100227, -0.04822269827127457, -0.01843809150159359, -0.015801874920725822, 0.021074306219816208, 0.0007462531793862581, -0.012664624489843845, -0.02406509965658188, 0.0015801875852048397, 0.03832532837986946, -0.0017324250657111406, -0.054450951516628265, -0.0019636719953268766, -0.003405111376196146, 0.028705455362796783, 0.048376861959695816, 0.015863541513681412, 0.002092784969136119, -0.037585336714982986, -0.0023105423897504807, 0.015270007774233818, 0.005041183438152075, -0.0005983514711260796, 0.02539091557264328, 0.011762761510908604, 0.03545786812901497, -1.5687455743318424e-05, 0.019717657938599586, -0.004204840399324894, -0.0015946404309943318, -0.023772187530994415, -0.03810949996113777, -0.016819361597299576, -0.017251022160053253, -0.045632731169462204, -0.03992864117026329, 0.006093357224017382, 0.03064792975783348, 0.011022771708667278, 0.006286063231527805, -0.025560496374964714, -0.003299123141914606, -0.04140862077474594, -0.02161388285458088, 0.0008565772441215813, 0.023494690656661987, -0.014468351379036903, -0.02626965381205082, 0.03385455533862114, -0.004293485078960657, -0.0014886523131281137, -0.009018631651997566, -0.023402191698551178, 0.020719727501273155, 0.02526758424937725, -0.037523671984672546, 0.022230541333556175, 0.040606964379549026, -0.031218338757753372, 0.018083512783050537, 0.0024454365484416485, -0.019578909501433372, 0.021536799147725105, -0.0027942340821027756, -0.027641719207167625, -0.0397128090262413, 0.0054651363752782345, 0.03878782317042351, -0.02853587456047535, 0.006895013619214296, 0.0009953253902494907, -0.004717438016086817, -0.03363872319459915, 0.02938378043472767, 0.05479011312127113, 0.030216269195079803, 0.020411398261785507, 0.010498612187802792, -0.0041624451987445354, -0.02130555361509323, -0.03730784356594086, 0.01982557214796543, 0.01082235760986805, 0.014013565145432949, 0.0111538115888834, 0.048500195145606995, -0.0015936769777908921, -0.006721578072756529, -0.03564286231994629, -0.017790598794817924, 0.031064175069332123, -0.024080516770482063, 0.048407696187496185, 0.0524776428937912, -3.839060809696093e-05, 0.02381843701004982, -0.021829713135957718, 0.009565915912389755, 0.0069836582988500595, 0.006663766223937273, 0.006336166523396969, -0.016341451555490494, -0.037955332547426224, -0.007781459949910641, -0.009889661334455013, -0.033299561589956284, 0.007646565791219473, 0.001211155904456973, 0.034563712775707245, 0.01236400380730629, -0.0012757123913615942, 0.0019106779946014285, -0.013520238921046257, 0.015154384076595306, -0.003414746606722474, -0.02290886454284191, 0.013921067118644714, -0.0018528662621974945, 0.014244812540709972, 0.031727083027362823, -0.005646280013024807, -0.010113200172781944, 0.011007355526089668, -0.006525018252432346, -0.0031025633215904236, 0.01234858762472868, 0.015108134597539902, -0.024296347051858902, -0.0072149052284657955, 0.046958547085523605, 0.0386953242123127, 0.015817292034626007, 0.02161388285458088, 0.0013913358561694622, -0.006586683914065361, -0.006428665481507778, 0.017482269555330276, 0.048346031457185745, 0.03693784773349762, 0.0017719297902658582, -0.0201647337526083, -0.0043243179097771645, -0.019563492387533188, -0.005723362322896719, -0.007515525911003351, -0.0010579548543319106, 0.045941062271595, -0.013273575343191624, -0.04316609725356102, 0.019301412627100945, 0.023402191698551178, 0.043906088918447495, 0.006567413453012705, 0.010020701214671135, -0.00810135155916214, -0.013959608040750027, 0.05960004776716232, -0.00515295285731554, 0.014807512983679771, 0.002000286243855953, 0.0021949189249426126, 0.04353609308600426, -0.0020407543051987886, 0.011770470067858696, 0.007018344942480326, 3.4175169275840744e-05, -0.0017806015675887465, -0.022014711052179337, 0.028165878728032112, 0.014260228723287582, 0.011878385208547115, 0.04510857164859772, 0.00972008053213358, 0.0255759134888649, 0.015670835971832275, 0.0009953253902494907, -0.01565541885793209, -0.0429810993373394, -0.006424811203032732, 0.007511672098189592, -0.005642425734549761, -0.03564286231994629, 0.028212128207087517, -0.005187639966607094, 0.0006619443884119391, -0.019332244992256165, 0.015547503717243671, -0.0008652490214444697, 0.011508390307426453, 0.017605600878596306, 0.004274214617908001, 0.005865964572876692, 0.00840197317302227, 0.007877812720835209, -0.009581332094967365, -0.007638857699930668, -0.04005197435617447, 0.0035689114592969418, 6.043133180355653e-05, -0.018145177513360977, -0.012094215489923954, -0.006436373572796583, 0.04029863700270653, 0.03425538167357445, -0.004736708477139473, 0.016094788908958435, 0.013265866786241531, -0.012179005891084671, -0.00717250956222415, -0.0076003167778253555, 0.004698167089372873, 0.013897942379117012, -0.010390696115791798, -0.0075039635412395, 0.02457384392619133, 0.013242742046713829, -0.021444300189614296, 0.02290886454284191, -0.0064594983123242855, -0.014822930097579956, -0.022138042375445366, -0.002663194201886654, -0.010174865834414959, 0.018083512783050537, 0.030694179236888885, -0.040946125984191895, 0.007939478382468224, -0.008625511080026627, -0.015254590660333633, 0.02913711592555046, -0.018484339118003845, 0.026254238560795784, 0.0370611771941185, 0.02976919151842594, 0.03373122215270996, 0.011916926130652428, 0.045170240104198456, -0.03718451038002968, 0.0015666980762034655, 0.018376424908638, -0.017035191878676414, -0.0104909036308527, -0.005916067864745855, -0.015439588576555252, 0.013566488400101662, -0.0056886752136051655, 0.014915429055690765, 0.012464211322367191, 0.017328105866909027, 0.01258754264563322, 0.03502620384097099, -0.010467778891324997, -0.002645850647240877, 0.02825837768614292, -0.0046326471492648125, 0.027102142572402954, 0.019964320585131645, -0.024157598614692688, -0.007149384822696447, 0.014815221540629864, 0.0006181038334034383, 0.013790027238428593, -0.027071310207247734, -0.0031969891861081123, -0.01789851486682892, 0.015061885118484497, 0.01928599551320076, 0.012009425088763237, 0.0072996956296265125, -0.03339206054806709, -0.009442583657801151, 0.02904461696743965, -0.004100779537111521, 0.004482336807996035, 0.00436671357601881, 0.011323392391204834, -0.027950048446655273, 0.015578337013721466, 0.007954895496368408, 0.0386953242123127, -0.03974364325404167, 0.01919349655508995, 0.009319252334535122, 0.03407038375735283, -0.045941062271595, 0.008394264616072178, -0.014267937280237675, 0.015007927082479, 0.025128835812211037, 0.0076773990876972675, 0.036197856068611145, 0.002547570737078786, 0.0072380295023322105, -0.0031430316157639027, 0.0028713163919746876, 0.0073151118122041225, 0.015586044639348984, -0.001134073594585061, -0.010976522229611874, -0.003358862129971385, 0.031603749841451645, -0.01614103838801384, -0.04143945500254631, -0.056115929037332535, 0.0037462005857378244, 0.020334316417574883, 0.02589965984225273, 0.018160594627261162, -0.023325109854340553, 0.0017054462805390358, 0.03743117302656174, -0.01988723874092102, -0.008278640918433666, -0.03724617511034012, -0.001615838147699833, -0.0014115700032562017, -0.007426881231367588, 0.026470068842172623, -0.0026381423231214285, -0.011562347412109375, 0.012317754328250885, 0.016002289950847626, 0.025884242728352547, -0.022631369531154633, 0.02926044724881649, 0.010968813672661781, 0.00014368626580107957, 0.10020701587200165, -0.0008421243401244283, 0.0071378229185938835, 0.015478129498660564, 0.017574768513441086, 0.023325109854340553, 0.01752851903438568, -0.003397403284907341, -0.06487248092889786, -0.025190502405166626, -0.005172223784029484, 0.010567985475063324, 0.0044014002196490765, -0.008062810637056828, 0.04008280485868454, 0.007688961457461119, -0.03416288271546364, 0.018869752064347267, 0.02158304862678051, 0.03490287438035011, 0.0008662125328555703, 0.006532726343721151, -0.023772187530994415, -0.024959255009889603, -0.0004921224317513406, 0.03703034669160843, 0.001013632514514029, 0.021228469908237457, 0.043998587876558304, 0.03564286231994629, -0.0005487297312356532, -0.002983085811138153, -0.013882525265216827, -0.0007351725944317877, -0.031850412487983704, -0.024265514686703682, -0.026547150686383247, 0.003977447748184204, 0.026562567800283432, 0.008617803454399109, -0.01796017959713936, -0.011307976208627224, -0.006243668030947447, 0.014028982259333134, -0.007527088280767202, -0.0018846626626327634, 0.01674227975308895, 0.0007091573206707835, -0.0027422034181654453, 0.00970466434955597, 0.017328105866909027, 0.012895871885120869, 0.006116481963545084, 0.005827423185110092, 0.011724220588803291, -0.03989780694246292, -0.015570628456771374, 0.03888032212853432, 0.03681451454758644, -0.010020701214671135, -0.007554067298769951, 0.0010367571376264095, -0.019455576315522194, -0.0010406112996861339, -0.005792736075818539, -0.00964299775660038, -0.02095097489655018, 0.026547150686383247, -0.021629298105835915, 0.00618970999494195, -0.00578888226300478, -0.04113112390041351, 0.0341012179851532, -0.021860545501112938, -0.0014539652038365602, -0.0030659493058919907, -0.017574768513441086, -0.0004897136241197586, 0.0223076231777668, 0.03863365948200226, 0.005588468164205551, -0.05028850585222244, -0.028643788769841194, 0.01113839540630579, -0.02176804654300213, -0.01947099342942238, 0.02394176833331585, 0.01982557214796543, -0.040576133877038956, 0.0060124206356704235, -0.0035650571808218956, 0.013142535462975502, 0.03197374567389488, -0.004278068896383047, -0.03823282942175865, 0.010884023271501064, -0.014745847322046757, 0.003715367754921317, 0.0009905077749863267, 0.010652776807546616, 0.004601814318448305, 0.019239746034145355, 0.02388010174036026, 0.0013306335313245654, -0.007191780488938093, -0.0016938839107751846, -0.012502752244472504, -0.01786768063902855, 0.01260295882821083, 0.0018846626626327634, -0.011492974124848843, -0.02526758424937725, 0.060617536306381226, 0.0314958356320858, -0.021721797063946724, 0.013820859603583813, 0.02312469482421875, 0.054666779935359955, 0.01717394031584263, -0.03712284564971924, 0.006902721710503101, 0.031187506392598152, 0.0077621894888579845, 9.990591206587851e-05, -0.01607937179505825, 0.028335459530353546, -0.006671474780887365, -0.019424743950366974, -0.013111702166497707, 0.014738139696419239, -0.0162335354834795, 0.011122978292405605, 0.012325462885200977, -0.004166299477219582, 0.008425096981227398, 0.028751704841852188, -0.00025629872106947005, -0.008216975256800652, -0.021953044459223747, -0.014213979244232178, 0.017420604825019836, 0.030154602602124214, 0.005141390487551689, -0.020288066938519478, 0.008155309595167637, 0.001924167387187481, 0.0027653281576931477, 0.0017276074504479766, -0.019995152950286865, 0.0057040913961827755, -0.0038637511897832155, -0.02526758424937725, -0.010144033469259739, 0.018885167315602303, 0.0072149052284657955, -0.02944544516503811, -0.011970884166657925, 0.0006205126410350204, 0.007176363840699196, -0.02787296660244465, 0.015894373878836632, -0.016588114202022552, 0.024342596530914307, 0.027179226279258728, 0.040483634918928146, -0.010976522229611874, -0.015015635639429092, -0.011385058052837849, 0.022446371614933014, -0.017482269555330276, 0.006887305062264204, 0.008301765657961369, -0.005692529026418924, 0.0005101885762996972, -0.01354336366057396, 0.008802800439298153, -0.0069297002628445625, 0.04202527925372124, -0.03962031006813049, 0.006883451249450445, -0.008186141960322857, -0.03137250244617462, -0.0023876249324530363, 0.004544002469629049, -0.03259040415287018, -0.021058889105916023, 0.010976522229611874, -0.006598246283829212, 0.00377125246450305, -0.019640574231743813, -0.0019713803194463253, -0.008548429235816002, -0.010406113229691982, 0.00799343641847372, 0.0419636145234108, 0.03847949206829071, -0.007900937460362911, -0.005276284646242857, 0.009604456834495068, 0.014953969977796078, -0.02394176833331585, -0.024049682542681694, -0.007288133259862661, -0.05090516433119774, -0.003908073529601097, 0.023833852261304855, 0.00017186948389280587, 0.004671188537031412, 0.029877107590436935, -0.01257212646305561, 0.0007404719945043325, 0.003241311525925994, 0.02224595658481121, 0.03092542663216591, 0.007191780488938093, -0.0177135169506073, -0.013620445504784584, 0.0028501187916845083, -0.015894373878836632, 0.002692099893465638, -0.01260295882821083, -0.0014009710866957903, 0.06126502528786659, -0.01047548744827509, -0.013088577426970005, -0.004355151206254959, 0.021182220429182053, -0.005199202336370945, 0.005492115393280983, 0.056115929037332535, 0.008718010038137436, -0.01865392178297043, -0.025344666093587875, -0.0009962889598682523, -0.022107208147644997, -0.013019203208386898, -0.009242169559001923, -0.012888163328170776, 0.00501805916428566, -0.0008011743775568902, -0.05059683322906494, 0.00951966643333435, -0.012425669468939304, 0.027672551572322845, -0.02312469482421875, 0.029476279392838478, 0.016541864722967148, 0.011099853552877903, -0.03007752075791359, 0.005831277463585138, 0.014136897400021553, -0.0037654712796211243, 0.003291415050625801, -0.039342816919088364, 0.027271725237369537, -0.006366999354213476, 0.006848764140158892, -0.03400871902704239, -0.007592608220875263, 0.015532087534666061, -0.012302338145673275, -0.026855479925870895, 0.010544860735535622, -0.017883097752928734, -0.0014847981510683894, 0.021598465740680695, -0.03829449415206909, 0.0011649065418168902, 0.005075870547443628, -0.01301149558275938, -0.015616877935826778, 0.0017834921600297093, -0.02708672732114792, 0.004254944156855345, -0.020380565896630287, 0.02768796868622303, -0.004216402769088745, -0.026608817279338837, -0.0190393328666687, -0.023648856207728386, 0.0006450826767832041, 0.009542791172862053, -0.02668589912354946, 0.013127119280397892, 0.0150850098580122, 0.03234374150633812, -0.028150463476777077, -0.019239746034145355, 0.0035419324412941933, 0.0048407698050141335, -0.007295841351151466, -0.003908073529601097, 0.0008676578290760517, -0.018160594627261162, -0.03715367615222931, 0.025884242728352547, 0.014375852420926094, -0.030447516590356827, -0.04106945917010307, 0.016403118148446083, -0.012186714448034763, -0.02092014066874981, -0.012217547744512558, 0.009820287115871906, 0.023170944303274155, 0.0341012179851532, -0.027395056560635567, 0.04649605602025986, -0.014560850337147713, 0.006517310161143541, 0.02388010174036026, -0.0033511538058519363, -0.01786768063902855, 0.025714661926031113, -0.013936483301222324, 0.002990793902426958, -0.032467070966959, 0.0334845595061779, -0.024959255009889603, 0.014792096801102161, -0.006648350041359663, -0.009010923095047474, -0.007554067298769951, 0.02088930830359459, -0.018777253106236458, 0.013774610124528408, -0.027256308123469353, -0.0012073018588125706, -0.0006407467881217599, -0.010814649052917957, 0.03283706679940224, 0.02243095450103283, 0.054450951516628265, -0.020442230626940727, 0.006567413453012705, 0.01759018562734127, 0.0019020062172785401, 0.021089721471071243, 0.0429810993373394, -0.040606964379549026, -0.015023344196379185, 0.0012535512214526534, 0.028643788769841194, -0.019995152950286865, 0.005954609252512455, 0.042056113481521606, -0.025406332686543465, -0.01104589644819498, -0.018900584429502487, -0.01277254056185484, 0.027302557602524757, 0.02913711592555046, 0.015108134597539902, -0.0048561859875917435, 0.03228207677602768, 0.008440514095127583, 0.0014539652038365602, -0.013458573259413242, -0.030293351039290428, -0.00580429844558239, -0.004590251948684454, -0.0005810079746879637, 0.019486410543322563, -0.0052261813543736935, 0.00219106487929821, 0.00973549671471119, -0.013643570244312286, -0.026454651728272438, 0.0007780496380291879, -0.011254018172621727, -0.01919349655508995, 0.029460862278938293, -0.0075232344679534435, -0.014213979244232178, -0.025375498458743095, -0.007723648101091385, -0.031850412487983704, -0.039250317960977554, -0.017220189794898033, -0.015200633555650711, 0.014846054837107658, -0.02708672732114792, -0.017281856387853622, -0.011716512031853199, 0.008625511080026627, 0.003291415050625801, -0.024018850177526474, 0.015493545681238174, -0.0012959465384483337]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
" 11. Generation results for prompt “ ⟨Vhermione⟩” after fine-tuning on 15Hermione images. The above two rows are from AdamW
optimizer and the bottom two rows are from our scaled AdamW optimizer. The first and third rows correspond to LoRA parameter
fusion coefficient 0.7and the second and fourth rows correspond to LoRA parameter fusion coefficient 1.0. Our scaled AdamW method
generates images of higher quality compared to AdamW. See Appendix F.2.1 for experimental details.
27
Riemannian Preconditioned LoRA
Figure 12. Generation results for prompt “a pencil sketch of ⟨Vpotter⟩” with different optimizers and different learning rates. See Appendix
F.2.2 for experimental details. Default optimizer is AdamW with default learning rate 1e−4for U-Net tuning and 1e−5for text-encoder
tuning. Our scaled optimizers generate better quality images and are more robust to learning rate changes.
Figure 13. Generation results for prompt “ ⟨Vpotter⟩sit on the chair” with different optimizers and different learning rates. See Appendix
F.2.2 for experimental details. Default optimizer is AdamW with default learning rate 1e−4for U-Net tuning and 1e−5for text-encoder
tuning. Our scaled optimizers generate better quality images and are more robust to learning rate changes.
28
Riemannian Preconditioned LoRA
Figure 14. Generation results for prompt “a photo of ⟨Vpotter⟩” with different optimizers and different learning rates. See Appendix F.2.2
for experimental details. Default optimizer is AdamW with default learning rate 1e−4for U-Net tuning and 1e−5for text-encoder
tuning. Our scaled optimizers generate better quality images and are more robust to learning rate changes.
29
","[0.009051249362528324, -0.007232605945318937, 0.026804009452462196, -0.03707234933972359, -0.025684844702482224, -0.023978115990757942, 0.04700494185090065, 0.012835427187383175, -0.026650123298168182, 0.005116683896631002, -0.012184912338852882, 0.004196870140731335, -0.05970747023820877, -0.0191796962171793, 0.03237185627222061, -0.003228092333301902, 0.0191796962171793, -0.00297453161329031, -0.04311584308743477, 0.01361884269863367, 0.018186436966061592, -0.03961845114827156, 0.026034582406282425, 0.05282460153102875, 0.02890244498848915, -0.009729743003845215, 0.002168382750824094, 0.0022313357330858707, 0.06116238608956337, -0.01019839383661747, -0.03133662790060043, -0.03827545419335365, -0.010317305102944374, -0.03242781385779381, -0.03586924821138382, 0.00647716922685504, 0.021529942750930786, 0.00827482808381319, -0.037547994405031204, 0.005959555506706238, -0.015976084396243095, -0.0520971454679966, -0.005309040658175945, 0.002971034264191985, 0.011982063762843609, 0.01668955199420452, 0.005424454342573881, -0.030609171837568283, 0.038247473537921906, 0.010261346586048603, -0.050670210272073746, 0.062225591391325, 0.027867216616868973, -0.04496246576309204, -0.02029886096715927, -0.004798421170562506, 0.03917078673839569, 0.011086731217801571, 0.035505518317222595, -0.021222172304987907, 0.04748058691620827, -0.041157305240631104, 0.025656864047050476, -0.0027839236427098513, 0.011982063762843609, -0.026859967038035393, -0.08365760743618011, -0.008715500123798847, 0.0014216896379366517, 0.022802993655204773, 0.009736738167703152, 0.012604598887264729, 0.045494068413972855, -0.03889099508523941, 0.0020529688335955143, 0.04160496965050697, 0.016801469027996063, 0.014605107717216015, 0.0030147514771670103, -0.024090033024549484, 0.007211621385067701, -0.01361884269863367, 0.054167602211236954, -0.024048063904047012, -0.03771587088704109, -0.02550297975540161, -0.026929914951324463, -0.043283719569444656, -0.014535159803926945, -0.006977296434342861, -0.005137668456882238, 0.011569371446967125, 0.023250659927725792, 0.02487344853579998, 0.036904476583004, 0.03642883151769638, 0.03122471272945404, -0.043759364634752274, 0.04887954518198967, 0.040401868522167206, 0.01983720436692238, -0.003987026400864124, 0.01531857531517744, -0.0024027079343795776, 0.014262363314628601, -0.02590867690742016, -0.008358766324818134, -0.006305797025561333, -0.014717023819684982, 0.01308024488389492, -0.0868472307920456, 0.0049558039754629135, -0.05254480987787247, -0.010729997418820858, 0.01488489843904972, -0.1171766072511673, -0.04599769413471222, -0.009701764211058617, -0.029434047639369965, -0.027839237824082375, -0.029462026432156563, -0.02921021543443203, 0.024985365569591522, 0.00453611696138978, 0.05948363617062569, 0.01257662009447813, 0.05318833142518997, -0.03676458075642586, 0.024649616330862045, -0.01250667218118906, 0.03516976907849312, 0.019039800390601158, 0.020900411531329155, -0.04501842334866524, -0.03413454070687294, 0.00676395557820797, -0.0031179245561361313, -0.012828432023525238, -0.004067466594278812, 0.021655848249793053, -0.005511889234185219, -0.026104530319571495, -0.007159160450100899, 0.02015896514058113, -0.026174478232860565, 0.009533889591693878, -0.020942380651831627, 0.019095757976174355, -0.031000878661870956, 0.002568834228441119, -0.040261972695589066, 0.008974307216703892, -0.06300900876522064, -0.015220648609101772, -0.02893042378127575, -0.006673023104667664, -0.023362575098872185, 0.03206408768892288, -0.009191145189106464, 0.003808659501373768, -0.026174478232860565, 0.042864032089710236, 0.034917958080768585, -0.02637033350765705, 0.03494593873620033, 0.0025513472501188517, -0.04001016169786453, 0.023054804652929306, -0.06966803967952728, -0.020270882174372673, 0.009596842341125011, -0.0001737766433507204, -0.0339386872947216, -0.00193405756726861, 0.04479459300637245, -0.02733561210334301, -0.044906508177518845, 0.017263125628232956, -0.0038751098327338696, -0.01094683539122343, 0.007092710118740797, 0.03847130760550499, -0.0325397327542305, 0.027489498257637024, -0.03791172429919243, -0.00016754691023379564, -0.015724273398518562, -0.05022254213690758, -0.0151786794885993, -0.008855395950376987, 0.007491413038223982, -0.007687266916036606, 0.08550422638654709, -0.005148160271346569, 0.01938953995704651, -0.040150053799152374, 0.06899654120206833, 0.010191398672759533, -0.021180203184485435, -0.0019253140781074762, -0.007561360485851765, 0.03413454070687294, 0.05380387231707573, -0.04787229746580124, 0.032875481992959976, -0.02935010939836502, -0.020718548446893692, 0.005711240693926811, 0.016157949343323708, 0.010366268455982208, 0.04594173654913902, 0.061666008085012436, 0.03483401983976364, -0.016955355182290077, -0.05427951738238335, -0.011625329963862896, -0.03763193264603615, 0.057217326015233994, 0.009883628226816654, 0.03220398351550102, -0.018396280705928802, 0.02511127106845379, 0.044346924871206284, 0.01505277305841446, -0.014262363314628601, 0.010527148842811584, 0.008225864730775356, -0.02637033350765705, -0.007631308399140835, -0.01221289113163948, 0.012891385704278946, 0.020410778000950813, -0.008365760557353497, -0.012625583447515965, 0.007428459823131561, -0.05268470570445061, 0.015696292743086815, -0.019585393369197845, 0.014563138596713543, -0.01503878366202116, 0.0060364981181919575, 0.01779472827911377, 0.025894686579704285, 0.005431449040770531, -0.0020984350703656673, 0.03167237713932991, -0.004815908148884773, -0.04974689707159996, 0.020270882174372673, 0.008057990111410618, -0.002556593157351017, -0.010967819951474667, -0.037799809128046036, -0.02695789374411106, -0.02827291376888752, 0.028370840474963188, -0.01765483245253563, 0.03312729299068451, -0.012247865088284016, 0.0015624597435817122, 0.0066835153847932816, 0.011492428369820118, 0.03827545419335365, 0.06681416928768158, -0.015374533832073212, 0.018186436966061592, -0.0317842960357666, 0.015906136482954025, -0.0010334792314097285, -0.012961333617568016, 0.00107981963083148, -0.039702389389276505, -0.007645298261195421, -0.004878861363977194, -0.029238194227218628, 0.006753463298082352, 0.014982826076447964, 0.020662588998675346, -0.030133526772260666, 0.029909692704677582, -0.029685860499739647, 0.015150700695812702, 0.05612614005804062, 0.04812410846352577, 0.014689045026898384, 0.0040464820340275764, -0.026174478232860565, -0.006127430126070976, -0.008519645780324936, -0.009338035248219967, 0.011051757261157036, -0.06468775868415833, 0.05176139622926712, -0.015864169225096703, -0.030693108215928078, 0.0491873137652874, 0.021767765283584595, -0.01824239455163479, 0.03858322277665138, 0.0227890033274889, 0.06826908141374588, -0.017822707071900368, 0.0166475847363472, 0.026748051866889, -0.015416502021253109, 0.03049725480377674, 0.03581329062581062, -0.0017591880168765783, -0.0007187139708548784, 0.010813934728503227, -0.027797268703579903, 0.05595826730132103, 0.03125268965959549, -0.00038711752858944237, -0.021376056596636772, -0.0057741934433579445, 0.05724530667066574, -0.04305988550186157, 0.017472969368100166, -0.0020442253444343805, -0.021571911871433258, -0.04739665240049362, 0.002213848987594247, -0.006823411211371422, -0.02161388099193573, -0.0028136514592915773, -0.04672515019774437, 0.016591625288128853, -0.0036687636747956276, -0.030693108215928078, -0.00394505774602294, -0.023880189284682274, 0.012898379936814308, 0.011583360843360424, 0.005193626508116722, 0.0047144838608801365, -0.0491313561797142, 0.01526261679828167, 0.05338418483734131, 0.01315019279718399, -0.0881902277469635, -0.03919876366853714, -0.006379242055118084, -0.02379625290632248, -0.027139758691191673, 0.009023270569741726, 0.03746405988931656, -0.017892654985189438, 0.03242781385779381, 0.018760008737444878, 0.011009789071977139, -0.022047556936740875, 0.02764338254928589, 0.013835681602358818, 0.000350832095136866, 0.005085207521915436, 0.0007580596138723195, -0.01196807436645031, -0.05858830362558365, 0.022089526057243347, -0.0339946448802948, 0.012177917174994946, 0.017780739814043045, -0.018228404223918915, -0.02074652723968029, 0.030413316562771797, 0.01467505469918251, 0.060378968715667725, 0.021697817370295525, -0.01723514497280121, -0.022802993655204773, 0.03584126755595207, -0.019865185022354126, 0.024299876764416695, -0.0852244421839714, 0.022327348589897156, -0.005627302918583155, 0.00765928765758872, -0.011926105245947838, 0.06032301113009453, -0.010464196093380451, -0.01505277305841446, -0.01737504079937935, -0.02213149331510067, 0.0005342265940271318, -0.005735722370445728, 0.008106953464448452, -0.02185170352458954, -0.051985230296850204, -0.023362575098872185, 0.008974307216703892, -0.024621637538075447, -0.032176002860069275, -0.004962798673659563, 0.02480350062251091, 0.050418395549058914, -0.00965979602187872, 0.028818506747484207, 0.025838728994131088, 0.0664224624633789, 0.006088958587497473, -0.00034187003620900214, -0.049690939486026764, -0.009708759374916553, -0.02590867690742016, 0.0033470038324594498, 0.016675563529133797, 0.03556147962808609, 0.03849928826093674, 0.027909185737371445, -0.010023524053394794, -0.034190502017736435, 0.01070201862603426, -0.04885156452655792, 0.02004704810678959, -0.022327348589897156, 0.07240999490022659, 0.0031441550236195326, 0.020424766466021538, 0.05178937315940857, -0.07341724634170532, -0.03150450438261032, -0.017458979040384293, 0.0005093076615594327, -0.0057637011632323265, -0.011625329963862896, 0.024929407984018326, -0.05338418483734131, -0.010660049505531788, -0.05363599583506584, 0.005232098046690226, 0.04815208911895752, 0.0245936568826437, -0.02691592648625374, -0.046781111508607864, -0.04521428048610687, 0.009708759374916553, 0.06105046719312668, 0.02750348672270775, -0.025684844702482224, 0.0592598021030426, -0.02189367078244686, -0.03430241718888283, -0.020802484825253487, -0.03228791803121567, 0.02220144122838974, -0.012597604654729366, 0.0419686995446682, 0.0002071111521217972, -0.05436345562338829, -0.015136711299419403, -0.014003556221723557, 0.019683320075273514, -0.007918094284832478, 0.006081963889300823, -0.07000379264354706, 0.04644536226987839, -0.0022155975457280874, 0.028216956183314323, -0.01873202994465828, -0.02757343463599682, -0.04711686074733734, -0.033323146402835846, -0.013751743361353874, 0.012709520757198334, 0.03687649592757225, -0.006805924233049154, 0.011975068598985672, 0.024271897971630096, -0.017640843987464905, 0.0006190382991917431, -0.051705438643693924, -0.004522127564996481, -0.024775521829724312, 0.012737500481307507, 0.02557292766869068, -0.0007807926740497351, -0.03947855532169342, 0.032315898686647415, -0.05142564699053764, 0.0169973224401474, -0.007183642126619816, 0.0005460302927531302, -0.016004063189029694, -0.02306879498064518, 0.08332185447216034, 0.03989824280142784, 0.002497137524187565, -0.020270882174372673, -0.008673531003296375, -0.016801469027996063, -0.041129324585199356, 0.025656864047050476, -0.016423750668764114, 0.013017291203141212, -0.018746018409729004, -0.024159980937838554, -0.013360035605728626, 0.005232098046690226, -0.023600397631525993, 0.054167602211236954, -0.031308650970458984, 0.005018756724894047, 0.011548386886715889, 0.030888963490724564, 0.0003917078720405698, 0.03516976907849312, 0.04037388786673546, 0.011611340567469597, 0.02993767149746418, 0.011065746657550335, 0.05478314310312271, -0.02695789374411106, 0.010100467130541801, -0.02262112870812416, 0.034778062254190445, -0.008855395950376987, 0.02616048976778984, -0.03413454070687294, 0.029741818085312843, -0.012394756078720093, 0.0064177135936915874, -0.011331548914313316, -0.009191145189106464, 0.031196733936667442, 0.013276098296046257, -0.007099704816937447, -0.07979648560285568, -0.029853735119104385, -0.011408491060137749, 0.034498270601034164, -0.027489498257637024, -0.007834156975150108, 0.002497137524187565, -0.07106699794530869, -0.0017845440888777375, 0.03922674432396889, 0.005595826543867588, -0.05374791473150253, 0.024229928851127625, 0.00856860913336277, 0.012010042555630207, 0.009016275405883789, 0.018829956650733948, -0.01474500261247158, 0.011947089806199074, 0.04110134765505791, -0.0024674097076058388, 0.021110255271196365, 0.014367284253239632, 0.0270977895706892, -0.02876254916191101, 0.01675949990749359, -0.036792561411857605, -0.019921142607927322, 0.0038646177854388952, -0.04624950513243675, 0.024034075438976288, 0.003700240282341838, 0.005431449040770531, 0.011114710941910744, 0.031168753281235695, 0.021501963958144188, -0.013541900552809238, -0.010065493173897266, 0.062225591391325, 0.02511127106845379, 0.010380257852375507, -0.027321623638272285, 0.018760008737444878, 0.005242589861154556, -0.02379625290632248, 0.058644261211156845, -0.005816162098199129, -0.002110675908625126, -0.02292889915406704, 0.034638166427612305, 0.030721087008714676, -0.015570387244224548, 0.029741818085312843, -0.032903458923101425, -0.02306879498064518, -0.01352791115641594, 0.0018938375869765878, -0.03950653597712517, 0.017780739814043045, -0.04096145182847977, -0.019697310402989388, 0.011842167936265469, 0.01931959204375744, 0.0563499741256237, -0.02497137524187565, 0.005354506429284811, -0.03570137172937393, -0.014493190683424473, -0.010275336913764477, -0.005137668456882238, -0.029909692704677582, -0.008890369907021523, 0.006837400607764721, 0.03514179214835167, 0.008204881101846695, -5.885454447707161e-05, 0.006938824895769358, -0.012031027115881443, 0.004420702811330557, -0.06149813532829285, 0.007701256312429905, -0.0083237923681736, -0.00936601497232914, -0.013353041373193264, -0.017962602898478508, -0.035057853907346725, 0.04003813862800598, -0.02646826021373272, 0.011401496827602386, 0.012772474437952042, -0.007330532651394606, 0.06770949810743332, 0.013604853302240372, -0.0075333816930651665, -0.005609815940260887, -0.011653308756649494, 0.0383034311234951, 0.01866208203136921, 0.026062563061714172, -0.0034676636569201946, -0.04076559469103813, -0.013318067416548729, -0.0024027079343795776, -0.036232978105545044, -0.02123616263270378, 0.0045081377029418945, 0.01910974830389023, 0.007484417874366045, -0.005788183305412531, 0.013660811819136143, -0.0520971454679966, -0.006190383341163397, -0.0126465680077672, 0.004305289126932621, 0.043591488152742386, -0.026859967038035393, -0.010100467130541801, -0.0018641097703948617, -0.01915171556174755, 0.008897364139556885, 0.0042982944287359715, -0.021110255271196365, -0.044766612350940704, -0.054167602211236954, -0.02536308392882347, 0.0006806798628531396, 0.038695141673088074, 0.008561614900827408, 0.0027559446170926094, -0.011177663691341877, 0.011590356007218361, -0.018088510259985924, -0.005837146658450365, -0.03007756732404232, -0.009778707288205624, -0.0006846144096925855, -0.00468300748616457, 0.04742462933063507, 0.013758738525211811, -0.018256384879350662, 0.05150958523154259, -0.019823215901851654, -0.01526261679828167, 0.02581075020134449, -0.027307633310556412, 0.015066763386130333, 0.003661768976598978, -0.008435708470642567, -0.030329380184412003, -0.02754545584321022, -0.030301401391625404, -0.009037259966135025, -0.000633465067949146, 0.0029832751024514437, 0.0339386872947216, -0.0419686995446682, 0.0025163732934743166, 0.01633981429040432, 0.02518121898174286, 0.020620621740818024, -0.029126277193427086, -0.0024027079343795776, 0.002393964445218444, -0.015878157690167427, 0.02590867690742016, 0.02234133705496788, -0.011345538310706615, 0.0028975890018045902, 0.008736484684050083, -0.010778960771858692, 0.054139621555805206, 0.0014732761774212122, -0.029294151812791824, -0.016283854842185974, 0.036065101623535156, 0.005123678594827652, 0.007232605945318937, -0.025167230516672134, -0.0311127956956625, -0.008659541606903076, 0.0031161759980022907, 0.037827786058187485, -0.01880197785794735, 0.005417459644377232, 0.013849670998752117, -0.02618846856057644, 0.004410210996866226, -0.007365506608039141, 0.04194071888923645, 0.03640085086226463, -0.012982317246496677, -0.01821441575884819, -0.02147398516535759, -0.038555245846509933, 0.0030252437572926283, -0.037520017474889755, -0.008330786600708961, -0.008071979507803917, -0.010953830555081367, -0.0245656780898571, 0.03757597506046295, -0.032483771443367004, 0.06418412923812866, 0.018773997202515602, 0.002399210585281253, -0.01713721826672554, 0.0026422792579978704, -0.017850685864686966, 0.03267962858080864, -0.02965788170695305, -0.005767198745161295, -0.01758488453924656, -0.02716773748397827, -0.02213149331510067, -0.021585900336503983, -0.015416502021253109, 0.029098298400640488, 0.0070402491837739944, 0.015416502021253109, 0.0008577352855354548, 0.01966932974755764, -0.0035131298936903477, 0.013807701878249645, -0.01994912140071392, 0.013667806051671505, -0.007974052801728249, -0.016465719789266586, 0.004836892709136009, -0.005700748413801193, 0.06888462603092194, 0.007953068241477013, -0.0015869414201006293, 0.002110675908625126, -0.003429192351177335, 0.0020547176245599985, -0.021767765283584595, 0.012835427187383175, -0.0019760262221097946, 0.03586924821138382, 0.006421211175620556, -0.02508329227566719, -0.011401496827602386, 0.006634552031755447, 0.009324045851826668, -0.021152224391698837, 0.0005403470131568611, 0.028496745973825455, 0.03749203681945801, -0.012793458066880703, 0.03156046196818352, -0.02001906931400299, -0.029993630945682526, 0.010597096756100655, -0.0234884824603796, 0.004375237040221691, -0.012828432023525238, -0.0092121297493577, -0.0191796962171793, -0.017109239473938942, -0.003700240282341838, -0.018843945115804672, 0.007204626686871052, -0.0383034311234951, -0.010366268455982208, 0.005781188141554594, 0.013388015329837799, -0.015934115275740623, 0.013262108899652958, 0.014409253373742104, -0.04034591093659401, -0.08757468312978745, -0.0015913131646811962, 0.011793204583227634, -0.05909192934632301, 0.012835427187383175, -0.00983466487377882, -0.0009066987549886107, -0.0016944862436503172, 0.002512875944375992, 0.006589085794985294, 0.01859213411808014, -0.028160996735095978, -0.03877907991409302, -0.04426298663020134, 0.035645414143800735, -0.04826400429010391, -0.020242903381586075, -0.01915171556174755, 0.004217854235321283, -0.015808209776878357, -0.05089404433965683, -0.016074011102318764, 0.004717981442809105, -0.0033015375956892967, -0.05192926898598671, -0.020033059641718864, -0.011793204583227634, -0.00016798409342300147, -0.008624567650258541, -0.00013038712495472282, -0.02369832620024681, -0.009421972557902336, 0.018508195877075195, 0.026062563061714172, -0.03365889564156532, -0.008820421993732452, -0.011590356007218361, 0.022005587816238403, 0.03813555836677551, 0.01619991846382618, 0.0001469997368985787, -0.04398319497704506, 0.019515445455908775, -0.012415740638971329, -0.014926867559552193, -0.0022855454590171576, 0.021879682317376137, -0.0018133975099772215, 0.012569625861942768, -0.01526261679828167, 0.016913386061787605, -0.011086731217801571, -0.017025303095579147, -0.028119027614593506, -0.022467244416475296, -0.024831481277942657, -0.024369824677705765, -0.03788374736905098, -0.03237185627222061, -0.01831234246492386, 0.0260205939412117, 0.032735586166381836, 0.010513159446418285, -0.018480217084288597, -0.013744749128818512, -0.027881205081939697, -0.011751235462725163, 0.016913386061787605, 0.014507180079817772, -0.04208061471581459, -0.0227610245347023, 0.057357221841812134, -0.018606122583150864, -0.0008861516253091395, 0.013325061649084091, -0.02824493497610092, 0.03763193264603615, 0.00609595375135541, -0.0339946448802948, 0.017095251008868217, 0.030049588531255722, -0.028007112443447113, 0.028818506747484207, 0.0166475847363472, -0.008183896541595459, 0.027391571551561356, 0.022886930033564568, -0.046501319855451584, -0.033043354749679565, 0.003623297670856118, 0.019515445455908775, -0.013723764568567276, -0.0010719505371525884, 0.002600310603156686, -0.01033828966319561, -0.012807448394596577, 0.02497137524187565, 0.04367542639374733, -0.0003700677480082959, 0.022075535729527473, 0.03816353529691696, 0.008330786600708961, 0.0022016079165041447, -0.0390029102563858, 0.01110072061419487, 0.01287040114402771, 0.01831234246492386, 0.011478438973426819, 0.05746913701295853, -0.00827482808381319, 0.004515132401138544, -0.039142806082963943, -0.009345030412077904, 0.022802993655204773, -0.013828686438500881, 0.03225994110107422, 0.045605987310409546, 0.005316035356372595, 0.02761540375649929, -0.005291553679853678, 0.0339946448802948, 0.015080752782523632, 0.019305601716041565, -0.008365760557353497, -0.02320869080722332, -0.045773860067129135, -0.01668955199420452, 0.004049979615956545, -0.035085830837488174, 0.006795431952923536, 0.016675563529133797, 0.008155916817486286, 0.0058721206150949, 0.02564287558197975, -0.004550106357783079, -0.040709637105464935, 0.018270373344421387, 2.0110001059947535e-05, -0.007400480564683676, 0.015696292743086815, 0.011037767864763737, 0.010953830555081367, 0.029713839292526245, -0.004371739458292723, -0.022705066949129105, 0.005564350169152021, 0.008827416226267815, -0.012765479274094105, 0.02414599247276783, 0.014234383590519428, 0.014954846352338791, -0.021292120218276978, 0.019893163815140724, 0.030133526772260666, 0.020718548446893692, 0.013919618912041187, 0.03872311860322952, -0.010967819951474667, -0.009827670641243458, 0.0074774231761693954, 0.03967440873384476, 0.05164947733283043, -0.020634610205888748, -0.017738770693540573, 0.0034466793294996023, -0.03670862317085266, -0.014633086510002613, -0.025852719321846962, 0.005648287478834391, 0.01049217488616705, -0.006249838974326849, -0.06267325580120087, 0.01568230427801609, 0.018997831270098686, 0.031448546797037125, 0.00990461278706789, 0.008337781764566898, -0.005015259608626366, -0.010890877805650234, 0.05584634840488434, 0.0017600622959434986, 0.006784939672797918, -0.027111779898405075, 0.032315898686647415, 0.02951798588037491, 0.011639319360256195, 0.004119927529245615, -0.0004481032956391573, 0.00865254644304514, 0.01901182159781456, -0.008904359303414822, 0.019991090521216393, 0.013730759732425213, 0.017878666520118713, 0.03654074668884277, 0.002846876857802272, 0.00796006340533495, 0.015724273398518562, -0.014311326667666435, -0.027797268703579903, -0.030301401391625404, 0.0031231706961989403, 0.01512272097170353, -0.020928392186760902, -0.04087751358747482, 0.02879052795469761, -0.019417518749833107, -0.02327863872051239, -0.011156679131090641, 0.03382677212357521, 0.0013674801448360085, 0.008295812644064426, 0.020270882174372673, -0.002857368905097246, 0.016381781548261642, -0.00699128583073616, 0.03572935238480568, -0.010709012858569622, -0.013017291203141212, -0.024132002145051956, -0.008659541606903076, -0.012583615258336067, 0.005183134227991104, -0.0020302357152104378, -0.017431000247597694, 0.021222172304987907, 0.041996680200099945, -0.005018756724894047, 0.015514428727328777, 0.0191796962171793, -0.010667044669389725, -0.008064985275268555, -0.0008782824734225869, 0.0023519957903772593, 0.004599070176482201, -0.01901182159781456, -0.008351771160960197, 0.00313016539439559, 0.001310647465288639, -0.02255118079483509, 0.011681287549436092, -0.014241378754377365, 0.0034082080237567425, -0.014786971732974052, 0.00021618252503685653, 0.005284558515995741, 0.012485687620937824, 0.027447529137134552, -0.03746405988931656, 0.03396666795015335, -0.01647971011698246, 0.00275769317522645, 0.031896211206912994, -0.00706123374402523, 0.0001830665860325098, 0.015528419055044651, 0.024132002145051956, 0.03872311860322952, 0.02768535166978836, 0.040429845452308655, -0.041157305240631104, 0.008904359303414822, 0.010303315706551075, -0.019851194694638252, -0.0077082510106265545, -0.009687774814665318, 0.012331802397966385, 0.01474500261247158, 0.006767452694475651, 0.014758992940187454, -0.010037513449788094, 0.024327855557203293, 0.02362837828695774, 0.037520017474889755, -0.017081260681152344, -0.005959555506706238, 0.04003813862800598, -0.010086477734148502, 0.035057853907346725, 0.021446004509925842, -0.02921021543443203, -0.020130986347794533, 0.013674801215529442, -0.014367284253239632, 0.019627362489700317, -0.016605615615844727, -0.009890623390674591, 0.001801156671717763, 0.018927883356809616, 0.03239983692765236, -0.006543619558215141, 0.034078583121299744, -0.026426291093230247, -0.015360543504357338, 0.03514179214835167, -0.01117066852748394, -0.011037767864763737, 0.007344522513449192, 0.006116937845945358, -0.013436978682875633, 0.03740810230374336, 0.010834919288754463, 0.04152103140950203, -0.05830851197242737, 0.017458979040384293, 0.010170415043830872, 0.012653563171625137, -0.04457075893878937, -0.011926105245947838, -0.02965788170695305, 0.006543619558215141, 0.007624313700944185, 0.00766628235578537, 0.03497391566634178, 0.007792188320308924, -0.009023270569741726, -0.01505277305841446, -0.00379816722124815, -0.007351517211645842, 0.009044255129992962, 0.01668955199420452, -0.008974307216703892, -0.01526261679828167, 0.02844078838825226, -0.03225994110107422, -0.03284750133752823, -0.053999725729227066, 0.0024674097076058388, 0.03270760551095009, 0.02001906931400299, -0.01612997055053711, -0.025936655700206757, 0.0018728532595559955, 0.008540630340576172, -0.008120942860841751, 0.010716008022427559, -0.014353294856846333, -0.006435200572013855, -0.0045081377029418945, -0.005039741285145283, 0.02421593852341175, 0.013388015329837799, -0.0010938092600554228, 0.011639319360256195, 0.0013412496773526073, 0.020732536911964417, -0.024915417656302452, 0.03648478910326958, 0.008540630340576172, 0.005099196918308735, 0.06563904881477356, -0.016675563529133797, 0.02262112870812416, -0.003598815994337201, 0.004896348342299461, 0.0339946448802948, 0.0027472011279314756, -0.013269104063510895, -0.03872311860322952, -0.016983333975076675, 0.005018756724894047, 0.014563138596713543, -0.009624822065234184, -0.020690567791461945, 0.05542666092514992, 0.0057741934433579445, -0.02077450603246689, 0.00898829661309719, 0.0014592866646125913, 0.016395771875977516, 0.01412246748805046, 0.00884840078651905, -0.02518121898174286, -0.005179637111723423, 0.009240108542144299, 0.039058867841959, -0.0126465680077672, 0.018690060824155807, 0.029238194227218628, 0.03654074668884277, 0.014283346943557262, -0.01976725645363331, -0.018969852477312088, 0.002033733297139406, -0.005686758551746607, 0.003401213325560093, -0.018815966323018074, -0.006767452694475651, 0.007771204225718975, -0.01748695783317089, 0.007547371089458466, -0.007757214363664389, -0.01533256471157074, -0.002100183628499508, -0.007344522513449192, -0.00877845287322998, 0.027839237824082375, 0.028958402574062347, -0.0025356088299304247, 0.0005364124081097543, 0.0235164612531662, 0.016074011102318764, 0.007414470426738262, -0.0013884644722566009, 0.0006251587765291333, -0.011268596164882183, -0.011982063762843609, 0.041856784373521805, 0.029853735119104385, -0.010100467130541801, -0.013422989286482334, -0.0014015797059983015, -0.023362575098872185, 0.001335129258222878, -0.014493190683424473, -0.011051757261157036, -0.013395009562373161, 0.025768781080842018, -0.0346941240131855, -0.0060050212778151035, 0.012471698224544525, -0.045326195657253265, 0.008225864730775356, -0.02285895124077797, 0.010953830555081367, -0.006508645601570606, -0.02632836438715458, 0.011191653087735176, 0.011940094642341137, 0.02949000522494316, -0.027601415291428566, -0.03410656377673149, -0.04854379594326019, 0.01243672426789999, -0.00126605574041605, -0.0209843497723341, 0.020144974812865257, 0.022425275295972824, -0.04652929678559303, 0.000525045907124877, -0.01612997055053711, 0.020270882174372673, 0.06345667690038681, -0.005029249005019665, -0.035785309970378876, 0.024034075438976288, -0.010555127635598183, 0.00808596983551979, 0.02102631889283657, 0.007897110655903816, -0.00010120576916961, 0.025488989427685738, 0.01737504079937935, 0.009498915635049343, -0.004658525809645653, -0.025405053049325943, -0.00010912954894592986, -0.030161505565047264, -0.010653055272996426, 0.019305601716041565, -0.0013360035372897983, -0.012618589214980602, 0.06306496262550354, 0.010464196093380451, -0.007869130931794643, 0.008134933188557625, 0.028160996735095978, 0.053132373839616776, 0.002189367078244686, -0.044626716524362564, -0.0008717248565517366, 0.012548641301691532, 0.009386998601257801, -0.007386491168290377, 0.0007322663441300392, 0.011009789071977139, -0.011233622208237648, -0.04154901206493378, -0.018773997202515602, -0.0034781559370458126, -0.0234884824603796, 0.009491920471191406, 0.013422989286482334, 0.004843887407332659, 0.005312537774443626, 0.030916942283511162, -0.007911100052297115, -0.012303823605179787, -0.020075026899576187, -0.002857368905097246, 0.028566693887114525, 0.026790019124746323, -0.001879847957752645, 0.0040814559906721115, 0.019137727096676826, 0.01004450861364603, 0.00460606487467885, -0.022019578143954277, -0.004833395127207041, -0.005840643774718046, -0.015696292743086815, -0.01647971011698246, -0.011702272109687328, 0.024621637538075447, 0.002895840210840106, -0.021641859784722328, -0.01994912140071392, -0.020061038434505463, 0.017682811245322227, -0.02001906931400299, 0.01908176764845848, -0.014381274580955505, -0.005123678594827652, 0.034498270601034164, 0.03729618340730667, -0.007757214363664389, -0.0317842960357666, -0.013422989286482334, 0.009149176068603992, -0.024915417656302452, 0.015458471141755581, 0.01762685365974903, 0.003292794106528163, 0.0035131298936903477, -0.0038366385269910097, -0.002439430681988597, -0.021348077803850174, 0.03785576671361923, -0.026566186919808388, 0.007421465124934912, -0.016885407269001007, -0.016815459355711937, -0.017151208594441414, -0.0013027783716097474, -0.026692092418670654, -0.0030742071103304625, 0.012226881459355354, -0.006421211175620556, 0.00030186862568371, -0.02257915958762169, -0.004291299264878035, -0.017193177714943886, 0.018452238291502, 0.02466360479593277, 0.02311076410114765, 0.0542515367269516, 0.007155663333833218, 0.007344522513449192, 0.0117442412301898, 0.019613372161984444, -0.00816990714520216, -0.029098298400640488, 0.0005119306733831763, -0.03279154375195503, 0.013402004726231098, 0.028538715094327927, 0.01824239455163479, 0.01730509288609028, 0.033770814538002014, -0.0018343818373978138, 0.0013727261684834957, -0.027041831985116005, -0.0028398819267749786, 0.022705066949129105, 0.01838229037821293, -0.0007703005103394389, 0.0009757722727954388, 0.008456693030893803, -0.024719564244151115, 0.005721732508391142, 0.002797913271933794, -0.005221605766564608, 0.04065367951989174, 0.0012197153409942985, -0.0135628841817379, 0.008302807807922363, 0.03298739716410637, -0.0034134541638195515, -0.00477044191211462, 0.043451592326164246, 0.002287294017150998, -0.0245656780898571, -0.011268596164882183, 0.01983720436692238, -0.03239983692765236, -0.009051249362528324, -0.017472969368100166, -0.005036243703216314, 0.00758933974429965, 0.01931959204375744, -0.03816353529691696, 0.003731716889888048, -0.0034973917063325644, 0.042024657130241394, -0.02196361869573593, 0.030860982835292816, 0.031476523727178574, 0.019655341282486916, -0.04082155600190163, 0.004221351817250252, -0.01229682844132185, 0.003588323714211583, -0.009373009204864502, -0.04594173654913902, 0.03237185627222061, -0.015346554107964039, 0.007855141535401344, -0.03284750133752823, -0.011261601001024246, 0.021418025717139244, 0.0077642095275223255, -0.027797268703579903, -0.0004161896067671478, -0.020494714379310608, 0.01880197785794735, 0.021040307357907295, -0.024397803470492363, 0.003126668045297265, 0.01243672426789999, -0.01575225219130516, -0.006141419522464275, -0.003107432508841157, -0.01392661314457655, -0.010275336913764477, -0.020284870639443398, 0.031000878661870956, -0.0202568918466568, -0.009128192439675331, -0.016675563529133797, -0.028147008270025253, -0.013255113735795021, 0.016885407269001007, -0.02306879498064518, 0.00037815546966157854, -0.000608546135481447, 0.03374283388257027, -0.017095251008868217, -0.011128700338304043, -0.015164690092206001, 0.016941364854574203, -0.016451729461550713, 0.026971884071826935, -0.00773623026907444, -0.013290087692439556, -0.029266173020005226, 0.024341845884919167, -0.006777944974601269, -0.000193995947483927, -0.03142056614160538, 0.03374283388257027, -0.015080752782523632, -0.0012975322315469384, -0.0159201268106699, 0.032735586166381836, 0.03721224516630173, 0.03195216879248619, -0.021390046924352646, 0.03444231301546097, -0.0032123541459441185, 0.027139758691191673, 0.028230944648385048, 0.004001015797257423, -0.0031494011636823416, 0.023404544219374657, -0.006596080493181944, 0.014283346943557262, -0.013227134943008423, 0.028160996735095978, -0.032315898686647415, 0.010736992582678795, -0.014248372986912727, -0.027419550344347954, -0.017291104421019554, 0.02691592648625374, -0.02740556001663208, 0.022243410348892212, -0.013073249720036983, -0.0004288676427677274, 0.013520915992558002, -0.012114964425563812, 0.030888963490724564, 0.015766240656375885, 0.028846485540270805, -0.021837713196873665, -0.002094937488436699, 0.018298352137207985, -0.0022942889481782913, 0.005602821242064238, 0.04929923266172409, -0.03567339479923248, -0.02442578226327896, 0.0037876751739531755, 0.0278532262891531, -0.03749203681945801, -0.008540630340576172, 0.020075026899576187, -0.014024540781974792, -0.017389031127095222, -0.0005796926561743021, 0.003633789950981736, 0.029434047639369965, 0.037939704954624176, 0.002929065376520157, 0.0006784939905628562, 0.047928255051374435, 0.007134678773581982, -0.011723256669938564, -0.015864169225096703, -0.026272404938936234, 0.00580217270180583, -0.040261972695589066, -0.0014837683411315084, 0.017095251008868217, -0.012779468670487404, 0.007127684075385332, 0.012408745475113392, -0.015808209776878357, -0.014786971732974052, -0.0016743761952966452, -0.006522635463625193, -0.0014269357779994607, 0.03821949660778046, -0.005833649076521397, -0.0202289130538702, -0.039114829152822495, 0.0007235229131765664, -0.012926359660923481, -0.04236040636897087, -0.00032372731948271394, -0.008995290845632553, 0.018032550811767578, -0.018927883356809616, -0.016227897256612778, -0.025754792615771294, 0.017472969368100166, 0.0015065014595165849, -0.022257400676608086, 0.009393993765115738, -0.016311833634972572]",Riemannian Preconditioned LoRA for Fine-Tuning Foundation Models.pdf
