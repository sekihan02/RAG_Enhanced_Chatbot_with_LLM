text,embedding,file
"Optimizing Speculative Decoding for Serving Large
Language Models Using Goodput
Xiaoxuan Liu1Cade Daniel2Langxiang Hu3Woosuk Kwon1Zhuohan Li1Xiangxi Mo1
Alvin Cheung1Zhijie Deng4Ion Stoica1Hao Zhang3
1UC Berkeley2Anyscale Inc.3UCSD4SJTU
Abstract
Reducing the inference latency of large language models
(LLMs) is crucial, and speculative decoding (SD) stands out
as one of the most effective techniques. Rather than letting
the LLM generate all tokens directly, speculative decoding
employs effective proxies to predict potential outputs, which
the LLM then verifies without compromising the genera-
tion quality. Yet, deploying SD in real online LLM serving
systems (with continuous batching) does not always yield
improvement ‚Äì under higher request rates or low specula-
tion accuracy, it paradoxically increases latency. Furthermore,
there is no best speculation length work for all workloads
under different system loads. Based on the observations, we
develop a dynamic framework SmartSpec. SmartSpec dynam-
ically determines the best speculation length for each request
(from 0, i.e., no speculation, to many tokens) ‚Äì hence the
associated speculative execution costs ‚Äì based on a new met-
ric called goodput , which characterizes the current observed
load of the entire system and the speculation accuracy. We
show that SmartSpec consistently reduces average request
latency by up to 3.2 √ócompared to non-speculative decoding
baselines across different sizes of target models, draft mod-
els, request rates, and datasets. Moreover, SmartSpec can be
applied to different styles of speculative decoding, including
traditional, model-based approaches as well as model-free
methods like prompt lookup and tree-style decoding.
1 Introduction
Latency is critical when deploying Large Language Models
(LLMs) for online services such as search engines [ 25,32],
chatbots [ 30], and virtual assistants [ 27,38,39]. However,
LLM generation is inherently slow due to its autoregressive
nature, where each generated token depends on all preceding
tokens. This sequential data dependency restricts tokens to
be generated one by one, resulting in slow generation speeds.
Speculative decoding aims to solve the problem by employ-
ing lightweight proxies, such as a small draft model [18, 20,
24,26,46] or additional model heads [ 4,21,22,43], generat-
ing multiple tokens which are then verified by the main/target
LLM in parallel. Speculative Decoding can reduce the gen-
eration latency mainly for two reasons. First, the efficient
proxy is much faster to run compared with running a single
forward pass on the target model and hence it can generate
tokens much quicker. Moreover, the verification of the draft
4 8 12 16 20 24 28
Request rate (req/s)0.00.51.01.52.0Speedupvsd, k=1
vsd, k=3
vsd, k=5Figure 1. Speedup of vanilla speculative decoding (VSD)
with proposed length ùëò=1,3,5on a LLaMA-7B model with
fixed input/output length = 128. We also fix the token accep-
tance rate to 0.7. We use LLaMA-160M as the draft model and
conduct experiments on a single A100-80G. The red cross
indicates the setting runs out of GPU memory and triggers
swapping.
model is done in a single forward pass. Such verification is
only marginally slower compared to letting LLM generate
one new token, but it allows LLM to potentially generate
multiple new tokens (if the guessed tokens are correct), or at
least enable LLM to generate one new token (if all guessed
tokens are incorrect).
While SD has demonstrated promise in accelerating single-
request inference (i.e., batch size = 1), integrating it into
online serving systems poses significant challenges. In real-
world applications, systems batch multiple tokens to achieve
high GPU utilization and SD is less efficient or can even
increases the query latency as shown in Fig. 1. This increase
is primarily due to the additional computational overhead
of running the proxy models and verifying tokens that are
ultimately not accepted. Whether the extra computational
work translates into actual latency reduction depends on
two key factors: the speculation accuracy of each request
and the current load of the serving system.
First, when the majority of proposed tokens are accepted
(i.e., there is a high token acceptance rate), speculative de-
coding can provide significant speedup, provided that","[0.026156015694141388, 0.023816095665097237, 0.027164602652192116, 0.008774704299867153, -0.034668490290641785, 0.016688749194145203, 0.005251375027000904, 0.027756307274103165, 0.024878473952412605, -0.0015885240864008665, 0.02391023002564907, -0.0044714012183249, -0.07627605646848679, -0.003113171085715294, 0.021946847438812256, -0.05247340723872185, -0.015612922608852386, -0.01640634424984455, 1.3566017514676787e-05, 0.02017173543572426, 0.007685430813580751, -0.0009278997895307839, -0.008653674274682999, 0.0254970733076334, 0.04209168627858162, -0.016554269939661026, 0.028401803225278854, 0.03746563568711281, 0.04671773687005043, -0.07928836345672607, 0.00231470656581223, -0.021650996059179306, -0.03544846177101135, -0.041634462773799896, 0.0028660674579441547, 0.0369277223944664, -0.0022827680222690105, -0.00802835077047348, -0.002081050770357251, 0.0033216122537851334, -0.005516969598829746, -0.04765908420085907, -0.07471610605716705, 0.013636092655360699, 0.013797466643154621, 0.08117105811834335, 0.007961111143231392, -0.013299897313117981, -0.014120214618742466, 0.04591086879372597, -0.040477946400642395, 0.018773160874843597, -0.02596774697303772, 0.025591207668185234, -0.00013657945964951068, -0.015169144608080387, -0.009884149767458439, 0.039186958223581314, 0.02532225102186203, 0.008129209280014038, 0.03146790713071823, -0.04133860766887665, -0.013353688642382622, 0.023937124758958817, -0.04225306212902069, -0.02268647775053978, -0.019741404801607132, 0.042764078825712204, -0.04037036746740341, 0.012950253672897816, -0.00603471091017127, -0.017374588176608086, 0.04712117463350296, -0.017603199928998947, -0.05258098989725113, 0.011881152167916298, 0.032274775207042694, 0.05462505668401718, 0.02438090369105339, 0.0038359917234629393, -0.00015759168309159577, 0.0275411419570446, 0.00684494199231267, -0.034668490290641785, -0.0123047586530447, -0.03012312389910221, -0.0031619195360690355, 0.0199296735227108, -0.027675621211528778, -0.018020084127783775, -0.0047269100323319435, 0.009830358438193798, -0.029343150556087494, -0.0011060835095122457, 0.010832221247255802, 0.03439953178167343, 0.012203900143504143, -0.011007043533027172, 0.05322648584842682, 0.030634142458438873, 0.026424972340464592, -0.005688429344445467, 0.0468791127204895, -0.059170421212911606, 0.03967107832431793, -0.028912819921970367, -0.03130653128027916, 0.03816492110490799, 0.00042654815479181707, -0.020023809745907784, -0.04755150154232979, -0.012432512827217579, -0.06734669953584671, -0.002941711340099573, -0.01886729523539543, -0.043221306055784225, -0.07772842049598694, -0.02092481404542923, -0.007510609459131956, 0.04523847624659538, 0.0026021539233624935, 0.02778320387005806, 0.03345818445086479, -0.004505021031945944, -0.012109764851629734, 0.008754532784223557, 0.010415338911116123, -0.10058971494436264, 0.02724529057741165, -0.008203172124922276, 0.020037256181240082, 0.020642409101128578, 0.04061242565512657, -0.015868430957198143, -0.025887059047818184, -0.009480715729296207, -0.038541462272405624, -0.0216913390904665, -0.041768938302993774, 0.04472745954990387, 0.0049588847905397415, -0.02343955636024475, -0.004239426460117102, 0.0036611699033528566, -0.03856835886836052, 0.017374588176608086, 0.0034073421265929937, 0.0030728275887668133, -0.04262959957122803, 0.038595251739025116, -0.030257603153586388, -0.025133982300758362, -0.016433240845799446, 0.0016851803520694375, 0.024313664063811302, -0.018450412899255753, -0.027594933286309242, 0.025833267718553543, 0.020844126120209694, -0.025456730276346207, -0.023869886994361877, 0.06164482235908508, 0.015505339950323105, -0.01233837753534317, 0.009857254102826118, 0.056427065283060074, -0.0404510535299778, -0.011948390863835812, -0.06288202106952667, -0.057072561234235764, 0.011390306055545807, -0.015088457614183426, 0.013279725797474384, -0.05387198179960251, -0.028159741312265396, -0.02279406040906906, 0.0065154703333973885, -0.04483504220843315, 0.040477946400642395, -0.059116631746292114, -0.033216122537851334, 0.0398593470454216, -0.02701667696237564, 0.0033333792816847563, -0.04308682680130005, -0.030096229165792465, -0.03154859319329262, 0.02186616137623787, 0.028536280617117882, 0.04039726033806801, 0.0010548136197030544, 0.04357094690203667, 0.05239272117614746, -0.016164284199476242, -0.0032879929058253765, -0.004373904317617416, 0.04359784349799156, 0.015612922608852386, 0.010099315084517002, -0.01183408498764038, 0.0345878005027771, 0.03060724586248398, 0.0007795534911565483, -0.057933222502470016, 0.022646134719252586, 0.011296171694993973, -0.003970469813793898, 0.008075417950749397, 0.016460135579109192, 0.00023806850367691368, -0.0023432832676917315, -0.0027315891347825527, 0.047739773988723755, -0.001404457027092576, -0.007981283590197563, 5.977977707516402e-05, -0.003136704908683896, -0.002669392852112651, 0.026277046650648117, 0.030392080545425415, 0.008646950125694275, 0.02099205181002617, 0.020117944106459618, 0.021261008456349373, -0.02942383661866188, 0.07014384865760803, 0.006673482246696949, -0.0009489120566286147, 0.022309938445687294, -0.015276727266609669, 0.03604016825556755, -0.0008749489788897336, -0.001872609369456768, -0.019082460552453995, -0.0021936760749667883, -0.006414611823856831, 0.019095908850431442, 0.0005740539636462927, -0.026169463992118835, -0.062344107776880264, 0.02724529057741165, 0.0007656854577362537, 0.009191587567329407, -0.007988006807863712, -0.0351526103913784, 0.022430969402194023, -0.06535641849040985, -0.05615811049938202, 0.033377498388290405, 0.026102224364876747, -0.011000319384038448, -0.04144619032740593, -0.032624419778585434, -0.02162409946322441, -0.03418436646461487, 0.022404072806239128, -0.015626370906829834, -0.015801193192601204, -0.020736543461680412, 0.018625235185027122, -0.008418337441980839, -0.03170996904373169, 0.011423925869166851, 0.026478763669729233, -0.015599475242197514, -0.033081647008657455, -0.009319341741502285, 0.002311344724148512, 0.0059439376927912235, -0.02092481404542923, 0.009635365568101406, -0.006407887674868107, -0.02279406040906906, 0.006286857184022665, -0.017831813544034958, -0.0498376339673996, 0.014052974991500378, 0.014052974991500378, -0.0668625757098198, 0.018665578216314316, 0.0037922861520200968, -0.012869566679000854, 0.049676258116960526, 0.02982727251946926, -0.00026622487348504364, 0.012082869186997414, 0.021879607811570168, -0.05083277076482773, -0.03071482852101326, -0.015263279899954796, 0.029047299176454544, -0.020911365747451782, 0.010267413221299648, -0.044404711574316025, 0.03275889903306961, 0.01113479770720005, 0.016500478610396385, 0.013064560480415821, -0.0351526103913784, -0.0022037620656192303, 0.08466749638319016, 0.044700562953948975, 0.02109963446855545, -0.015007770620286465, -0.002624006476253271, 0.010038800537586212, -0.016688749194145203, 0.008593158796429634, -0.0058464412577450275, -0.00902348943054676, 0.0127485366538167, 0.010724639520049095, -0.02087102271616459, 0.01594911888241768, -0.021946847438812256, -0.04037036746740341, 0.045991554856300354, -0.05088656395673752, 0.01835627853870392, -0.03294716775417328, -0.0027315891347825527, 0.007544228807091713, -0.023600930348038673, -0.02602153830230236, 0.049030762165784836, -0.040182095021009445, 0.0023449643049389124, 0.007833356969058514, -0.00946726743131876, -0.008922630921006203, 0.03757321834564209, 0.05572777986526489, 0.00010422062769066542, 0.007013039663434029, -0.016204627230763435, -0.05841734632849693, -0.04736323282122612, 0.006444869562983513, 0.03781528025865555, 0.00688528548926115, -0.06471092253923416, 0.03792286291718483, 0.0284286979585886, -0.03746563568711281, 0.010879289358854294, -0.01022706925868988, 0.005486711859703064, 0.00993794109672308, 0.08590469509363174, 0.007900596596300602, -0.015196040272712708, -0.01928417943418026, 0.05072518810629845, -0.027621829882264137, 0.04106965288519859, 0.021677890792489052, 0.019660716876387596, -0.06352751702070236, -0.02408505231142044, -0.015787744894623756, -0.004155377391725779, 0.03482986241579056, 0.013414204120635986, 0.003822543891146779, -0.006027986761182547, 0.003372041741386056, -0.01664840616285801, 0.020723095163702965, 0.0003290514287073165, -0.022941986098885536, 0.02374885603785515, 0.09096107631921768, -0.016957705840468407, 0.016554269939661026, -0.025994641706347466, -0.0008051884360611439, -0.020467586815357208, 0.04722875729203224, -0.006757531315088272, 0.04496952146291733, 0.01017327792942524, 0.028939716517925262, -0.010643952526152134, -0.010240517556667328, 0.012735088355839252, 0.030150020495057106, 0.014012631960213184, -0.037250470370054245, -0.06008487567305565, -0.03846077620983124, -0.03181755170226097, -0.02408505231142044, 0.007503885310143232, 0.018369726836681366, 0.0005618668510578573, 0.0307686198502779, 0.015666713938117027, 0.027594933286309242, 0.030096229165792465, 0.02033310942351818, 0.013784019276499748, -0.025133982300758362, -0.020588617771863937, -0.038595251739025116, 0.002694607712328434, 0.02748735062777996, 0.031494803726673126, 0.018947983160614967, 0.02772941254079342, -0.002985416678711772, 0.03934833034873009, -0.039294540882110596, 0.0492459274828434, -0.025523968040943146, 0.02678806334733963, -0.003738494822755456, 0.039778660982847214, 0.01752251386642456, 0.07181137800216675, 0.07826633006334305, 0.01658116653561592, -0.03170996904373169, -0.0199296735227108, -0.024838129058480263, -0.031387221068143845, -0.0017431741580367088, -0.0006202808581292629, 0.017979739233851433, 0.04857353866100311, -0.06164482235908508, -0.043382678180933, 0.011820636689662933, 0.06003108248114586, -0.04556122422218323, -0.05739530920982361, -0.01353523414582014, -0.007033211644738913, -0.017535962164402008, -0.006656672339886427, -0.04244133085012436, -0.016097044572234154, 0.023237839341163635, -0.03181755170226097, 0.023896781727671623, -0.0054799881763756275, 0.01483294926583767, -0.03184444457292557, -0.013905049301683903, 0.021301351487636566, -0.023049568757414818, 0.041876520961523056, -0.0134814428165555, 0.021960295736789703, 0.03480296581983566, -0.013024216517806053, -0.04443160817027092, 0.07713671773672104, -0.03733115643262863, 0.03329681232571602, 0.02116687409579754, 0.04330199211835861, 0.022525103762745857, -0.05123620852828026, -0.037304263561964035, -0.02724529057741165, -0.01670219749212265, 0.04553433135151863, 0.03101067990064621, 0.013024216517806053, 0.05605052784085274, 0.040531739592552185, -0.02626359835267067, 0.010368271730840206, -0.00524465087801218, 0.000566489587072283, 0.0008867158321663737, 0.04588397219777107, -0.042522016912698746, 0.02590050734579563, -0.016957705840468407, 0.0011312981368973851, -0.020198630169034004, 0.06492608785629272, 0.01257371436804533, 0.03246304392814636, 0.043355781584978104, 0.029343150556087494, 0.009164691902697086, -0.007866976782679558, -0.0404510535299778, -0.015505339950323105, -0.041634462773799896, 0.06546400487422943, -0.015397757291793823, -0.002050793031230569, 0.009628641419112682, 0.020144838839769363, 0.0036914274096488953, -0.008673845790326595, 0.018853848800063133, 0.03329681232571602, -0.009164691902697086, -0.021852713078260422, -0.013004045002162457, -0.0076047442853450775, 0.005315252114087343, 0.014550545252859592, 0.002250829478725791, -0.01870592311024666, -0.002502976218238473, -0.010906185023486614, 0.013501614332199097, 0.0017532599158585072, 0.023170599713921547, -0.019970018416643143, -0.005120258778333664, -0.03375403583049774, 0.020884469151496887, -0.010186726227402687, -0.011538232676684856, 0.027272185310721397, -0.0034695384092628956, 0.008310754783451557, 0.011706329882144928, 0.025833267718553543, -0.012385445646941662, -0.03170996904373169, -0.10053592920303345, -0.029531419277191162, -0.015142248943448067, 0.0031014042906463146, -0.03945591300725937, -0.0008699060999788344, 0.022404072806239128, -0.02832111530005932, -0.010993595235049725, -0.025537416338920593, -0.0048916456289589405, -0.026922542601823807, -0.02052137814462185, 0.013757123611867428, 0.023426108062267303, 0.023049568757414818, 0.021946847438812256, -0.00024941511219367385, -0.02966589853167534, 0.0134814428165555, -0.010825498029589653, -0.0334043949842453, -0.0003939791931770742, 0.03006933256983757, -0.02444814331829548, 0.01260061003267765, -0.019243834540247917, -0.027057019993662834, 0.02338576503098011, -0.00788042414933443, 0.00589014682918787, -0.02508019097149372, -0.0012775432551279664, -0.012930082157254219, -0.025766029953956604, -0.015854984521865845, 0.005409386940300465, -0.0048244064673781395, -0.01483294926583767, -0.006404526066035032, -0.04373232275247574, 0.0018826952436938882, 0.03622843697667122, -0.050967250019311905, -0.018423518165946007, 0.015478444285690784, -0.005301804281771183, 0.01775112748146057, -0.013555405661463737, -0.005812821444123983, 0.00485130213201046, 0.03351197391748428, 0.014456409960985184, 0.002371859736740589, -0.0123047586530447, -0.012768708169460297, -0.027944575995206833, -0.04671773687005043, 0.02104584313929081, -0.016097044572234154, 0.005426196847110987, -0.012257690541446209, -0.013084731996059418, 0.01806042715907097, -0.007813185453414917, -0.0003513243864290416, 0.0015221255598589778, -0.02010449580848217, -0.009332789108157158, 0.04591086879372597, -0.04080069437623024, -0.03248994052410126, 0.00640116399154067, 0.009978285059332848, -0.014940531924366951, -0.004377266392111778, 0.006774341221898794, -0.0037015134003013372, 0.006979420315474272, -0.030284497886896133, 0.016285313293337822, 0.0492190346121788, -0.023883333429694176, 0.012499751523137093, 0.017845261842012405, 0.01541120558977127, -0.0334312878549099, -0.06083795428276062, 0.02420608140528202, -0.04655636474490166, -0.02848248928785324, 0.03563673049211502, -0.02818663790822029, 0.01999691314995289, -0.036847036331892014, 0.021543413400650024, 0.008492300286889076, 0.02544328197836876, -0.015438101254403591, -0.03786906972527504, -0.01183408498764038, -0.0007816547295078635, -0.001188451424241066, 0.000546738039702177, 0.010099315084517002, 0.004229340236634016, 0.01272164098918438, 0.0016288675833493471, 0.017455274239182472, -0.006162465084344149, -0.011497888714075089, 0.003124937880784273, -0.018087321892380714, 0.005295080598443747, 0.02249820902943611, 0.014093318954110146, -0.028213532641530037, 0.016500478610396385, -0.008250239305198193, -0.005923766177147627, 0.014792605303227901, 0.01869247481226921, 0.00219031423330307, -0.021261008456349373, -0.006075054407119751, 0.053656816482543945, 0.02291509136557579, 0.03106447122991085, -0.01588187925517559, 0.028294220566749573, -0.030445871874690056, 0.03474917635321617, -0.007759394124150276, -0.009171415120363235, -0.013494891114532948, -0.023816095665097237, -0.005106810946017504, 0.010072419419884682, 0.031225845217704773, 0.030849305912852287, 0.004239426460117102, 0.016729092225432396, -0.02052137814462185, -0.04133860766887665, 0.04330199211835861, 0.03205960988998413, -0.006300305016338825, -0.014429514296352863, -0.00236681685782969, -0.0007513971067965031, -0.043221306055784225, 0.002234019571915269, 0.04421644285321236, -0.04268339276313782, 0.00611203582957387, -0.02818663790822029, -0.005012676119804382, -0.0009472310775890946, 0.012560267001390457, 0.011242380365729332, 0.0284286979585886, 0.008451957255601883, 0.012667849659919739, -0.006612967234104872, -0.009339513257145882, 0.022673029452562332, -0.04184962809085846, -0.0007085321703925729, 0.008815048262476921, 0.006781064905226231, 0.002494571264833212, -0.006905457470566034, -0.014147110283374786, -0.0061658271588385105, 0.03200582042336464, 0.010011904872953892, -0.03275889903306961, 0.009917769581079483, -0.017979739233851433, -0.017616648226976395, -0.008068693801760674, 0.028859028592705727, -0.014200901612639427, 0.033619556576013565, 0.01806042715907097, -0.0052782706916332245, -0.004434419795870781, -0.027944575995206833, 0.007288720458745956, -0.007006315980106592, 0.002997183706611395, 0.011007043533027172, -0.02649221196770668, -0.062451690435409546, -0.03152169659733772, -0.03246304392814636, -0.02467675507068634, -0.0018255420727655292, -0.016540823504328728, -0.01722666248679161, 0.022605791687965393, 0.000715256086550653, 0.02490536868572235, 0.008371270261704922, 0.01752251386642456, 0.04650257155299187, -0.054302312433719635, -0.0038460774812847376, -0.02996174991130829, -0.02668048068881035, 0.001402776106260717, 0.001815456198528409, -0.02150307036936283, 0.023009225726127625, -0.017038391903042793, -0.04004761949181557, 0.04652946814894676, 0.03604016825556755, -0.03095688857138157, 0.0062633235938847065, 0.03539467230439186, 0.007732498459517956, -0.010025352239608765, -0.028240429237484932, 0.01198873482644558, -0.006320476997643709, 0.0034006182104349136, 0.010959976352751255, -0.015249831601977348, 0.026653585955500603, 0.03211340308189392, -0.0009278997895307839, -0.005140430293977261, -0.0009531144751235843, 0.007766117807477713, -0.004821044858545065, 0.026814959943294525, 0.023937124758958817, -0.00464286096394062, -0.04948798939585686, -0.018154561519622803, 0.03509881719946861, 0.005234565120190382, -0.00029438125784508884, -0.03246304392814636, -0.0003244287509005517, 0.03130653128027916, 0.035018131136894226, -0.011618919670581818, -0.012378721497952938, 0.039590392261743546, 0.0025853440165519714, 0.03060724586248398, -0.0035199676640331745, -0.0374925322830677, -0.010482578538358212, -0.003200581995770335, -0.018127666786313057, 0.022874748334288597, -0.01019345037639141, 0.005873336922377348, 0.0012851075734943151, -0.041930314153432846, -0.004552088212221861, 0.018800057470798492, -0.03547535836696625, 0.005516969598829746, -0.011538232676684856, -0.009137796238064766, -0.0011682796757668257, -0.10058971494436264, -0.0054631782695651054, 0.029235567897558212, -0.005432920530438423, -0.0007245015003718436, -0.0025214669294655323, 0.03614775091409683, 0.010986872017383575, 0.008451957255601883, -0.027124259620904922, 0.021005500108003616, -0.02490536868572235, -0.018652131780982018, -0.027339424937963486, -0.008425061590969563, -0.06476471573114395, -0.02010449580848217, -0.02643842063844204, 0.01958003081381321, -0.03676635026931763, 0.023049568757414818, -0.02210822142660618, -0.015155697241425514, -0.0019633821211755276, 0.018921086564660072, -0.0069189053028821945, -0.00946726743131876, -0.0001163026608992368, 0.01184080820530653, -0.013004045002162457, -0.006912181153893471, 0.009198310784995556, -0.010274137370288372, 0.03391541168093681, -0.050321754068136215, 0.00987742654979229, -0.0030644226353615522, -0.02708391658961773, 0.014133661985397339, 0.02685530297458172, 0.04800872877240181, -0.02631738968193531, 0.024488486349582672, 0.008465404622256756, 0.012029077857732773, -0.029692793264985085, 0.026707377284765244, -0.005937214009463787, -0.023896781727671623, -0.012640953995287418, -0.01485984493046999, 0.020776886492967606, 0.0020928175654262304, 0.021677890792489052, -0.024407800287008286, -0.001625505625270307, 0.018921086564660072, 0.01841006986796856, 0.009830358438193798, 0.020763440057635307, -0.018450412899255753, 0.016191178932785988, -0.004908455535769463, 0.00660960515961051, -0.0498376339673996, -0.0208037830889225, 0.02789078652858734, 0.03141411393880844, -0.02350679598748684, -0.04303303360939026, 0.010132934898138046, 0.02907419390976429, 0.023950573056936264, 0.02789078652858734, 0.022995777428150177, 0.022242700681090355, -0.01834283024072647, 0.03542156517505646, -0.038595251739025116, 0.005668257363140583, 0.05943937972187996, -0.020534826442599297, -0.012351825833320618, -0.02508019097149372, 0.031683072447776794, 0.0037822003941982985, 0.03335060179233551, 0.03259752318263054, -0.015787744894623756, 0.038541462272405624, 0.028939716517925262, -0.033377498388290405, -0.015034666284918785, 0.0010464087827131152, -0.032920271158218384, -0.03404988721013069, -0.022054430097341537, -0.0033384221605956554, 0.02912798523902893, 0.004115033894777298, 0.05696497857570648, 0.026814959943294525, -0.02577947825193405, -0.04706738144159317, 0.023237839341163635, -0.00873436126857996, -0.004555450286716223, -0.035609837621450424, 0.01793939620256424, 0.022188909351825714, 0.008808324113488197, 0.01724010892212391, 0.014563992619514465, 0.02678806334733963, -0.00788042414933443, 0.014469858258962631, 0.04978384077548981, 0.01424124464392662, 0.019472448155283928, -0.004989142529666424, -0.0035266915801912546, 0.040935173630714417, -0.03840698301792145, 0.03289337456226349, -0.04295234754681587, 0.00808886531740427, 0.024017812684178352, 0.02977348119020462, -0.02186616137623787, 0.013131799176335335, -0.033565767109394073, 0.042764078825712204, 0.023950573056936264, -0.002728227060288191, 0.0037687525618821383, 0.009823635220527649, 0.0023516882210969925, 0.023923678323626518, -0.0322209857404232, 0.03698151558637619, 0.0007144156261347234, 0.019472448155283928, 0.003380446694791317, 0.008875563740730286, -0.0007505566463805735, 0.010939803905785084, 0.009460543282330036, -0.03964418172836304, -0.004185635130852461, -0.0002552985097281635, 0.008599882945418358, -0.021382039412856102, -0.012358549982309341, 0.004054518882185221, 0.04373232275247574, 0.00603471091017127, -0.03746563568711281, -0.04227995499968529, -0.002121394034475088, 0.02701667696237564, 0.033969201147556305, 0.043355781584978104, -0.02661324292421341, -0.015142248943448067, 0.016540823504328728, -0.017159422859549522, -0.02719149924814701, -0.004948799032717943, -0.05954696238040924, -0.010475854389369488, -0.008270411752164364, -0.023130256682634354, 0.027124259620904922, 0.01874626614153385, 0.053199589252471924, 0.013797466643154621, -0.013367136009037495, 0.03716978430747986, -0.011074282228946686, 0.05177411809563637, 0.022484760731458664, -0.0034729004837572575, 0.00806196965277195, -0.004817682784050703, 0.04741702601313591, -0.020817231386899948, 0.00993121787905693, 0.021946847438812256, -0.01368988398462534, 0.023184048011898994, 0.004636137280613184, 0.030849305912852287, -0.005651447921991348, 0.035959478467702866, -0.02092481404542923, 0.003114852122962475, 0.02132824808359146, 0.03254373371601105, -0.010186726227402687, -0.026882199570536613, -0.07552297413349152, 0.025631550699472427, -0.02179892174899578, 0.015196040272712708, -0.009460543282330036, -0.005564036779105663, -0.005691791418939829, 0.03453401103615761, -0.030150020495057106, -0.0015120396856218576, -0.04096207022666931, 0.017186317592859268, -0.023426108062267303, 0.05680360645055771, -0.008283859118819237, -0.01711907982826233, 0.00808886531740427, 0.03628222644329071, -0.05346854403614998, -0.02010449580848217, -0.053145796060562134, -0.03391541168093681, 0.0033148883376270533, -0.01178029365837574, -0.050671398639678955, 0.0017087140586227179, 0.0017818366177380085, 0.018800057470798492, -0.029907958582043648, 0.0018574806163087487, 0.016419792547822, 0.016285313293337822, -0.0009169734548777342, -0.023358868435025215, -0.015491892583668232, -0.007732498459517956, -0.0066297766752541065, -0.004992504604160786, -0.011531508527696133, 0.029585210606455803, 0.024528829380869865, -0.014483305625617504, -0.03052655979990959, -0.02907419390976429, 0.007840081118047237, -0.012271138839423656, -0.003671255661174655, 0.014052974991500378, -0.0011170097859576344, 0.0034409617073833942, -0.010260689072310925, 0.026344286277890205, 0.012237519025802612, 0.0024441417772322893, 0.0030207172967493534, -0.005493436008691788, 0.010206897743046284, 0.027998367324471474, 0.03230167180299759, 0.03300095722079277, -0.015182592906057835, 0.00972949992865324, -0.0007925810641609132, -0.00826368760317564, 0.014254692941904068, -0.03052655979990959, -0.015438101254403591, 0.003239244455471635, 0.017267005518078804, -0.0002693767019081861, -0.028509385883808136, 0.023291630670428276, -0.003946936223655939, 0.03999382629990578, 0.024179186671972275, 0.005516969598829746, 0.0037048752419650555, -0.026344286277890205, 0.01676943525671959, -0.004306665621697903, -0.02209477312862873, -0.01485984493046999, -0.025281907990574837, -0.020561721175909042, 0.011901323683559895, -0.04392059147357941, -0.042226165533065796, -0.004931989125907421, 0.019795196130871773, -0.013723503798246384, 0.026411525905132294, 0.04978384077548981, 0.0011044024722650647, 0.006787789054214954, -0.06159102916717529, -0.018006635829806328, 0.021543413400650024, 0.004565536044538021, 0.012553542852401733, -0.02614256925880909, 0.02216201275587082, 0.017199765890836716, 0.011565128341317177, -0.013488166965544224, 0.05830976366996765, 0.007100450806319714, 0.010906185023486614, -0.022847851738333702, -0.026707377284765244, -0.019311074167490005, 0.002514743013307452, 0.023399213328957558, 0.034668490290641785, 0.02256544679403305, 0.010415338911116123, 0.008936078287661076, 0.006122121587395668, -0.0015448187477886677, 0.020265869796276093, -0.007483713794499636, 0.008572987280786037, 0.007631639949977398, -0.009151243604719639, -0.0024676756002008915, -0.006824770476669073, -0.022417521104216576, -0.0006917224382050335, -0.026761168614029884, 0.0011136478278785944, 0.013521786779165268, 0.031172053888440132, 0.0004942074883729219, -0.012963701970875263, 0.011766845360398293, -0.008835219778120518, 0.0034628144931048155, -0.006791150663048029, -0.014846396632492542, -0.0020104495342820883, -0.01605670154094696, 0.010643952526152134, 0.010213621892035007, -0.01769733615219593, 0.005261460784822702, -0.024865025654435158, -0.009722776710987091, 5.442166002467275e-05, -0.022229252383112907, -0.01389160193502903, -0.022955434396862984, 0.07482369244098663, -0.01134323887526989, -0.009500887244939804, -0.02239062637090683, 0.0007799737504683435, -0.011067559011280537, -0.005500159692019224, -0.022309938445687294, -0.04236064478754997, 0.009917769581079483, 0.0014313526917248964, 0.027756307274103165, 0.011645815335214138, 0.021839264780282974, 0.018329383805394173, -0.01374367531388998, 0.009110900573432446, 0.033619556576013565, 0.009137796238064766, 0.03294716775417328, 0.003620826406404376, -0.009117623791098595, -0.005688429344445467, -0.019001774489879608, -0.020736543461680412, 0.0005606061313301325, 0.016540823504328728, 0.011524784378707409, 0.010395167395472527, 0.011383582837879658, 0.0193379707634449, 0.0038393535651266575, -0.030687933787703514, 0.02678806334733963, -0.007550952956080437, -0.022552000358700752, -0.007228204980492592, 0.0205079298466444, -0.02743355929851532, -0.015169144608080387, -0.02643842063844204, -0.004874836187809706, -0.007228204980492592, 0.019001774489879608, -0.007860252633690834, 0.0363629125058651, 0.007100450806319714, 0.012943529523909092, 0.00855281576514244, 0.002561810426414013, 0.02538949064910412, -0.010556541383266449, 0.035071924328804016, -0.016957705840468407, 0.011692882515490055, -0.039240747690200806, -0.0047067380510270596, 0.0193379707634449, 0.012977149337530136, 0.015720505267381668, -0.05954696238040924, -0.00589014682918787, -0.049272824078798294, -0.007571124471724033, 0.010946528054773808, -0.0293162539601326, -0.003681341651827097, 0.0022188909351825714, 0.004965608939528465, 0.04367852956056595, -0.011363410390913486, 0.02937004528939724, 0.006370906252413988, 0.0012447641929611564, 0.004535278305411339, 0.026424972340464592, -0.023116808384656906, -0.00499586621299386, 0.02343955636024475, 0.008189724758267403, -0.008364546112716198, 0.016850123181939125, -0.0008379674982279539, 0.005281632766127586, -0.006646586582064629, 0.012533371336758137, 0.021489622071385384, 0.009568125940859318, 0.024340560659766197, -0.0020121305715292692, -0.02232338674366474, -0.023345421999692917, 0.016984600573778152, -0.019136251881718636, 0.014039527624845505, -0.025994641706347466, -0.004094862379133701, -0.035717420279979706, -0.0007665259181521833, 0.003202263033017516, -0.004195720888674259, -0.024811234325170517, 0.010213621892035007, -0.0041049481369555, 0.024582620710134506, 0.02848248928785324, -0.052150659263134, -0.032382357865571976, 0.0006925628986209631, -0.010058972053229809, -0.015787744894623756, 0.000607253285124898, 0.0023432832676917315, -0.0068516661413013935, -0.020561721175909042, 0.011040663346648216, -8.168502245098352e-05, 0.03797665238380432, -0.012768708169460297, -0.03394230455160141, 0.024313664063811302, 0.033969201147556305, 0.012950253672897816, 0.018194904550909996, -0.027218393981456757, -0.012795603834092617, -0.029504524543881416, 0.00040616627666167915, 0.004548726137727499, -0.01923038810491562, -0.005029486026614904, -0.032570626586675644, -0.010859116911888123, -0.003509881906211376, -0.004962246865034103, 0.030929993838071823, 0.03351197391748428, -0.018436966463923454, -0.018679026514291763, -0.010993595235049725, 0.006646586582064629, 0.012963701970875263, -0.007779565639793873, -0.013225934468209743, 0.00651883240789175, 0.029531419277191162, -0.0032795879524201155, 0.0025702151469886303, 0.024125395342707634, 0.026599794626235962, -0.005580846685916185, 0.016984600573778152, -0.0013985736295580864, -0.0169980488717556, -0.015075010247528553, -0.015438101254403591, 0.006081778090447187, -0.015854984521865845, 0.02832111530005932, 0.015101905912160873, -0.008667122572660446, 0.003563673235476017, -0.006633138749748468, 0.04184962809085846, 0.03843387961387634, -0.011665986850857735, -0.020077601075172424, 0.009884149767458439, 0.03714288771152496, 0.010381720028817654, -8.136983524309471e-05, -0.0001749267685227096, 0.024891920387744904, -0.00029585210722871125, -0.03071482852101326, -0.0041049481369555, -0.031333427876234055, 0.021234113723039627, -0.010670848190784454, 0.013057836331427097, 0.008478852920234203, -0.0022323387674987316, 0.042764078825712204, 0.030929993838071823, 0.008754532784223557, 0.01605670154094696, -0.0013086412800475955, 0.009245378896594048, -0.012345101684331894, 0.008821772411465645, 0.011067559011280537, 0.007678707130253315, -0.03843387961387634, -0.00659615732729435, 0.008640226908028126, 0.009971560910344124, 0.031387221068143845, 0.0060313488356769085, 0.0027030124329030514, 0.019324522465467453, -0.015626370906829834, -0.011457545682787895, 0.02867075987160206, -0.01939176209270954, 0.012143384665250778, 0.0053925770334899426, -0.017899053171277046, -0.01675598695874214, 0.041768938302993774, -0.012546819634735584, 0.02538949064910412, 0.0027080553118139505, 0.028401803225278854, 0.01180718932300806, 0.026519106701016426, -0.03170996904373169, -0.01108100637793541, -0.012533371336758137, -0.013232658617198467, -0.03464159369468689, 0.006310391239821911, 0.007322339806705713, 0.00036246085073798895, 0.026411525905132294, -0.017388036474585533, 0.012815775349736214, 0.006569261662662029, 0.020561721175909042, 0.0052110315300524235, 0.008465404622256756, 0.010092591866850853, 0.0034493666607886553, -9.639357449486852e-05, -0.027151156216859818, 0.0073357876390218735, -0.000872427539434284, 0.01418745331466198, -0.001803689287044108, 0.025591207668185234, 0.005116896703839302, -0.03604016825556755, -0.00414529163390398, 0.01576084829866886, 0.013589025475084782, 0.008149380795657635, 0.055942945182323456, 0.022780612111091614, 0.04273718222975731, -0.019781747832894325, -0.011181864887475967, -0.001874290406703949, 0.023412659764289856, 0.0047941491939127445, -0.04671773687005043, 0.002049111993983388, -0.04349026083946228, -0.006841579917818308, -0.012257690541446209, 0.04994521662592888, 0.04835837334394455, 0.00944037176668644, -0.015451548621058464, 0.013985736295580864, 0.009077280759811401, -0.010778430849313736, 0.01577429659664631, -0.01483294926583767, 0.0019818730652332306, -0.016487032175064087, -0.017011497169733047, -0.01764354482293129, 0.003560311160981655, -0.02127445675432682, 0.0018675664905458689, 0.015814639627933502, 0.003298078663647175, -0.0017003091052174568, -0.04330199211835861, 0.012022353708744049, 0.034372635185718536, 0.031978923827409744, 0.00811576098203659, -0.010058972053229809, 0.009971560910344124, -0.012123213149607182, -0.009628641419112682, -0.008122485131025314, 0.011881152167916298, 0.01594911888241768, 0.04085448756814003, 0.009534507058560848, 0.008929355069994926, -0.005019400268793106, -0.028536280617117882, 0.005527055356651545, 0.00735595915466547, 0.013784019276499748, -0.01222407165914774, -0.01588187925517559, 0.007490437477827072, -0.0322209857404232, -0.026156015694141388, -0.014147110283374786, 0.03345818445086479, -0.000564808608032763, 0.02982727251946926, -0.006377630401402712, 0.028859028592705727, 0.014066423289477825, -0.019297625869512558, 0.0016834994312375784, -0.004182273056358099, -0.010327928699553013, 0.026599794626235962, 0.01811421848833561, 0.010576712898910046, 0.023708513006567955, 0.008196447975933552, -0.02883213385939598, 0.07197275012731552, -0.011901323683559895, 0.015209488570690155, 0.013730227947235107, -0.008384717628359795, 0.030230706557631493, 0.0055304174311459064, 0.02443469502031803, -0.014563992619514465, 0.024219529703259468, 0.006075054407119751, 0.03348508104681969, -0.02542983368039131, 0.020588617771863937, 0.0021953571122139692, -0.0010648994939401746, 0.006310391239821911, 0.015922222286462784, 0.01952623948454857, 0.02813284657895565, -0.014698470942676067, -0.01781836524605751, 0.010018628090620041, -0.03335060179233551, -0.02438090369105339, -0.020548274740576744, 0.018611786887049675, -0.027594933286309242, -0.005335424095392227, -0.038541462272405624, 0.012062697671353817, 0.05034865066409111, 0.03192513436079025, -0.003694789484143257, -0.0067642549984157085, -0.004931989125907421, -0.004700014367699623, 0.012930082157254219, -0.021893056109547615, 0.0008014062186703086, -0.006276771426200867, -0.015196040272712708, -0.027863889932632446, 0.013985736295580864, 0.019472448155283928, 0.01776457391679287, 0.00218359031714499, -0.013548682443797588, -0.026519106701016426, 0.006646586582064629, 0.020265869796276093, -0.018423518165946007, 0.03940212354063988, -0.0017784746596589684, -0.01186770386993885, -0.0035972928162664175, 0.0076047442853450775, 0.0004185634898021817, 0.012190451845526695, 0.005237927194684744, 0.0012918314896523952, 0.025053294375538826, -0.03154859319329262, 0.049568675458431244, 0.005601018201559782, 0.005816183518618345, -0.02139548771083355, 0.009131072089076042, -0.00993121787905693, -0.004128481727093458]",Online Speculative Decoding.pdf
" the
proxy model operates efficiently. Conversely, if the token
acceptance rate is low, speculative decoding can introduce
additional overhead rather than accelerating the process. In
such cases, the main model ends up regenerating most of
the tokens, rendering the proxy model‚Äôs computations su-
perfluous and potentially slowing down the overall system.
1arXiv:2406.14066v2  [cs.AI]  25 Jun 2024
Second, due to the inherent imperfection in speculation accu-
racy, speculative decoding inevitably expends some compu-
tational resources on tokens that are not ultimately accepted.
Under low system load, this waste of compute is tolerable.
However, under high system load conditions‚Äîwhere the sys-
tem approaches its computational capacity and processes
large batch sizes‚Äîthe availability of surplus compute for
speculation is greatly reduced. In such scenarios, it is more
effective to allocate the limited computational resources di-
rectly to normal token generation rather than continuing to
speculate, thereby minimizing the risk and maximizing the
use of available compute.
Ideally, speculative decoding should be performed in an
adaptive and automatic way, which can be likened to the
adaptive streaming techniques used in video delivery sys-
tems. In scenarios with few users, the system can afford
to engage in ‚Äúhigh-resolution"" speculative decoding, akin
to streaming high-resolution video, where it utilizes abun-
dant computational resources to make more extensive pre-
dictions per request. Conversely, as user demand increases
and system resources become strained, the system shifts to
‚Äúlow-resolution"" speculative decoding. This strategy, much
like reducing video resolution during peak traffic, involves
making fewer predictions per request to conserve resources
while maintaining overall system functionality.
Despite its widespread recognition, speculative decoding
has not yet been effectively integrated into production-level
serving systems. Most prior research has explored specula-
tive decoding with a batch size of one [ 4,20]. Recent studies
have extended this investigation to larger batch sizes, but
these techniques have been tested primarily on relatively
small LLMs [35] or in offline settings [37].
In this work, we integrate speculative decoding into a
production-level serving system vLLM [ 19], marking the
first such integration to the best of our knowledge. We also
explore the trade-offs between speculation cost and decoding
accuracy under varying system loads. A key innovation in
our system is the introduction of a metric called ‚Äúgoodput,‚Äù,
defined as the rate of generated tokens per second. Unlike
throughput, goodput in the context of speculative decoding
measures only those tokens that are both verified and gener-
ated by the target model. This reflects a crucial distinction ‚Äì
not all output tokens qualify as generated tokens.
Goodput is an essential metric for determining the extent
of speculation. It is derived from two factors: the token accep-
tance rate and the batch size, with the latter indicating system
load. This metric adheres to two core principles. First, it lim-
its speculation under constrained computational resources
to maximize system efficiency. For example, under extremely
high system loads, goodput would automatically turn off
speculation to avoid wasting any compute resources. Sec-
ond, this metric increases the proposed length for requests
that are easy to predict, as indicated by the high token ac-
ceptance rate in previous generation steps. By leveragingthe predictability of these queries, the system can enhance
overall performance.
However, we cannot measure goodput directly because
the decision needs to be made before knowing the goodput.
We must determine the proposed length and which requests
to run (batch size) based on an estimate of goodput, as these
two factors influence its value. To estimate goodput, we
predict the accepted token length for all requests within a
single generation step using the token acceptance rate. A
simple linear model is then employed to estimate the batch
execution time. By combining the predicted token length
and execution time, we can approximate goodput.
Leveraging goodput, we developed the dynamic specula-
tive decoding framework SmartSpec. SmartSpec dynamically
modulates each request‚Äôs speculation length ‚Äì from no spec-
ulation (i.e., zero) to many tokens ‚Äì based on the estimated
goodput , adjusting speculation intensities to ensure consis-
tent reduction (instead of increase) of the request latency.
SmartSpec also accommodates various speculative decoding
methods, including draft model-based approaches and model-
free techniques such as prompt lookup [ 33] and tree-based
decoding [ 4]. Accommodating diverse SD methods is crucial
because different techniques are suited to different work-
loads. For instance, prompt lookup decoding is more benefi-
cial for summarization tasks, while tree-based approaches
like Medusa are more useful","[0.0393555611371994, 0.03266768530011177, 0.0098317451775074, 0.009667405858635902, -0.020063618198037148, 0.00800258293747902, 0.0004566205898299813, 0.029352331534028053, 0.013968794606626034, -0.01083206757903099, 0.028509201481938362, 0.004430001135915518, -0.08534183353185654, -0.0020917465444654226, 0.02483658865094185, -0.05470336973667145, -0.00646637286990881, -0.006670009810477495, -0.004712235182523727, 0.018548844382166862, -0.006259162910282612, 0.020549489185214043, -0.005662541836500168, 0.014633294194936752, 0.01240400318056345, -0.022578716278076172, 0.02567971684038639, 0.03635459020733833, 0.03638317063450813, -0.06013369560241699, -0.018205875530838966, -0.018963264301419258, -0.015576455742120743, -0.04430001229047775, 3.901929085259326e-05, 0.0029831056017428637, -0.015633616596460342, -0.02163555473089218, 0.005648251622915268, -0.010567696765065193, -0.015319230034947395, -0.039069753140211105, -0.07196608185768127, 0.03275343030691147, 0.003486839821562171, 0.07253769785165787, 0.013997375033795834, -0.044042788445949554, -0.004076315555721521, 0.05418891832232475, -0.05521782115101814, 0.00983889028429985, 0.003038480645045638, 0.026479976251721382, -0.012396858073771, -0.007873970083892345, -0.020149361342191696, 0.01889181137084961, 0.007023695390671492, -0.005959066096693277, 0.03129581734538078, -0.03538284823298454, 0.006945098750293255, 0.01289702020585537, -0.035154204815626144, -0.006123404949903488, -0.0147904884070158, 0.05518924072384834, -0.04164201393723488, 0.028194814920425415, -0.0005269558168947697, -0.029866782948374748, 0.039098333567380905, -0.02688010409474373, -0.04632923752069473, 0.008688518777489662, 0.02577975019812584, 0.05827595293521881, 0.02563684619963169, 0.012504035606980324, 0.007852534763514996, 0.02272162027657032, 0.0004689013585448265, -0.022278619930148125, -0.004219219088554382, -0.02856636233627796, -0.018077263608574867, 0.02183561958372593, -0.03581155836582184, -0.04344259202480316, -0.010224728845059872, 0.026079846546053886, -0.01766284368932247, 0.02483658865094185, 0.01880607008934021, -0.0014218875439837575, 0.008052598685026169, -0.03501129895448685, 0.04873001575469971, 0.019349101930856705, 0.0007029054686427116, -0.010253309272229671, 0.031038589775562286, -0.03586871922016144, 0.06293459981679916, -0.01776287704706192, -0.056046660989522934, 0.045900531113147736, -0.0001473689917474985, -0.007881115190684795, -0.047815434634685516, -0.02663716860115528, -0.0591047927737236, 0.015619327314198017, -0.02385055460035801, -0.06419214606285095, -0.08511318266391754, -6.55345429549925e-05, 0.005859034135937691, 0.041156139224767685, -0.005437469109892845, -0.00285449274815619, 0.03332504257559776, -0.011024987325072289, -0.0030063274316489697, -0.011039277538657188, 0.03535426780581474, -0.08379847556352615, 0.012575487606227398, -0.015047714114189148, 0.008417002856731415, 0.0039691380225121975, 0.029981104657053947, -0.006809340789914131, -0.026994427666068077, -0.016419585794210434, -0.040155816823244095, -0.0007533681346103549, -0.021478360518813133, 0.03281059116125107, 0.0077239214442670345, -0.0197921022772789, -0.015304939821362495, 0.01884894073009491, -0.057875823229551315, 0.002958097727969289, -0.0034493275452405214, 0.008245518431067467, -0.04575762525200844, 0.03489697724580765, -0.025393910706043243, -0.022078555077314377, -0.021049650385975838, 0.0009485204354859889, 0.015004843473434448, -0.013947359286248684, -0.03166736289858818, 0.02090674825012684, 0.018348779529333115, -0.020235102623701096, -0.04338543117046356, 0.08048312366008759, -0.0004818519519176334, -0.019291941076517105, 0.0037333478685468435, 0.06379202008247375, -0.038955431431531906, -0.00061984290368855, -0.0685935690999031, -0.018191585317254066, 0.009274422191083431, -0.012039599940180779, -0.0031706662848591805, -0.04584336653351784, -0.02862352505326271, -0.009381599724292755, -0.03686904162168503, -0.06436362862586975, 0.038240913301706314, -0.06562118232250214, -0.04387130215764046, 0.02285023219883442, -0.014540407806634903, 0.0015683633973821998, -0.019563456997275352, -0.04355691745877266, -0.06607846915721893, 0.028880750760436058, 0.026294201612472534, 0.028009040281176567, 0.007145163603127003, 0.06339188665151596, 0.05527498200535774, -0.01141797099262476, -0.001561218174174428, -0.019391972571611404, 0.03366801142692566, 0.03080994449555874, 0.029866782948374748, -0.00898861512541771, 0.03166736289858818, 0.02586549147963524, 0.01870603859424591, -0.013025633059442043, 0.04158484935760498, 0.027523169293999672, 0.011053567752242088, 0.007895405404269695, -0.005126654636114836, -0.004394275601953268, -0.0040548802353441715, -0.0123254070058465, 0.06001937389373779, -0.006505671422928572, -0.02167842537164688, 0.01694832742214203, -0.018548844382166862, 0.02770894393324852, 0.016462456434965134, 0.04221362620592117, 0.011768084019422531, 0.011139309965074062, 0.013425761833786964, 0.02679436281323433, -0.018005812540650368, 0.06024801731109619, -0.003701194655150175, 0.02087816782295704, 0.025994105264544487, -0.009260131977498531, 0.03764072060585022, 0.004894436802715063, -0.012711245566606522, -0.02660858817398548, 0.0025436782743781805, -0.0053945984691381454, 0.013118520379066467, -0.01294703595340252, 0.006591413170099258, -0.07236621528863907, 0.013968794606626034, -0.009688841179013252, 0.0070808567106723785, -0.017334166914224625, -0.04478588327765465, 0.03152446076273918, -0.07128015160560608, -0.05133085325360298, 0.02369336225092411, 0.04369981959462166, 0.007866824977099895, -0.05624672770500183, -0.009188679978251457, 0.00495159812271595, -0.04490020498633385, 0.013168536126613617, -0.01796294003725052, 0.007088002283126116, -0.03058129921555519, 0.004630065988749266, -0.012203939259052277, -0.02980962209403515, -0.020235102623701096, 0.023164618760347366, -0.022264329716563225, -0.03686904162168503, -0.004919445142149925, -0.006016227416694164, 0.01144655141979456, -0.029380911961197853, 0.014747616834938526, -0.005994792096316814, -0.009710277430713177, 0.0037047672085464, -0.05464620888233185, -0.024307845160365105, 0.016376715153455734, 0.019220490008592606, -0.06030517816543579, 0.024050619453191757, 0.004594339989125729, -0.028394879773259163, 0.05318859592080116, 0.018105844035744667, 0.007688195910304785, 0.02782326564192772, 0.017591392621397972, -0.017577102407813072, 0.007305929437279701, -0.016176650300621986, 0.030381234362721443, -0.004294243175536394, 0.018305908888578415, -0.034096717834472656, 0.05221685394644737, 0.020992489531636238, 0.0028062628116458654, -0.003399311564862728, -0.039212655276060104, -0.045871950685977936, 0.08231227844953537, 0.029409492388367653, 0.04058452695608139, -0.028366299346089363, -0.007280921563506126, -0.02879500761628151, -0.017134102061390877, 0.011839536018669605, 0.013818745501339436, -0.010889229364693165, 0.0058947596698999405, 0.012461164966225624, -0.03692620247602463, 0.009324437938630581, -0.02174987643957138, -0.048158399760723114, 0.06442078948020935, -0.051045048981904984, 0.016233811154961586, -0.03766930103302002, -0.020563779398798943, -0.0034421824384480715, -0.0297524593770504, -0.02197852171957493, 0.060933955013751984, -0.029209427535533905, -0.004905154462903738, 0.012696955353021622, 0.004755106288939714, -0.00888143852353096, 0.030438395217061043, 0.03349652513861656, 0.0198349729180336, 0.003581513185054064, -0.022049974650144577, -0.08168350905179977, -0.020063618198037148, 0.015062004327774048, 0.038212332874536514, -0.008066889829933643, -0.05524640157818794, 0.021564103662967682, 0.017048358917236328, -0.05144517496228218, -0.005358872469514608, -0.013540084473788738, 0.011296503245830536, 0.012682665139436722, 0.07985434681177139, 0.020549489185214043, -0.01596229523420334, -0.010189003311097622, 0.04218504577875137, -0.03341078385710716, 0.03752639889717102, 0.01580510102212429, 0.017034068703651428, -0.05764717981219292, -0.050873562693595886, -0.006505671422928572, -0.0072309053502976894, 0.050902143120765686, 0.03235330060124397, 0.0038548156153410673, 0.01579081080853939, -0.011703778058290482, -0.02978104166686535, 0.003183170221745968, -0.010403357446193695, -0.017491359263658524, 0.0066771553829312325, 0.09282996505498886, -0.023450426757335663, 0.011646616272628307, -0.01874890923500061, -0.022192876785993576, -0.023936297744512558, 0.04867285117506981, -0.0019220489775761962, 0.01683400571346283, 0.010739180259406567, 0.013182826340198517, -0.010782051831483841, -0.01766284368932247, 0.012203939259052277, 0.026337072253227234, 0.01872032880783081, -0.023078877478837967, -0.07396673411130905, -0.002204282907769084, -0.00838127639144659, -0.02166413515806198, -0.01690545678138733, 0.000968169653788209, 0.01043908391147852, 0.03766930103302002, -0.017434198409318924, 0.02555110491812229, 0.04364265874028206, 0.021078232675790787, 0.025008071213960648, -0.009317292831838131, -0.02263587713241577, -0.02880929782986641, -0.023236071690917015, 0.023964878171682358, 0.02863781526684761, 0.02686581388115883, 0.028952201828360558, 0.01600516587495804, 0.06356337666511536, -0.030952848494052887, 0.06459227949380875, -0.04738672450184822, 0.019377682358026505, -0.004558614455163479, 0.046900853514671326, 0.0148190688341856, 0.05636104941368103, 0.06453511863946915, 0.013590101152658463, -0.03152446076273918, -0.039098333567380905, -0.03161020204424858, -0.04269949719309807, -0.0012923814356327057, 0.0123254070058465, -0.005555364303290844, 0.0493873693048954, -0.07813950628042221, -0.03689762204885483, 0.008174067363142967, 0.04552898183465004, -0.0493873693048954, -0.03132439777255058, 0.019349101930856705, 0.014919101260602474, -0.015190617181360722, -0.009617390111088753, -0.05364588648080826, -0.023493297398090363, 0.004558614455163479, -0.04435717314481735, 0.013254278339445591, -0.024064909666776657, 0.02665145881474018, -0.031095750629901886, -0.026222748681902885, 0.012796987779438496, -0.03052413836121559, 0.023450426757335663, -0.004815840162336826, 0.02193565107882023, 0.01877748966217041, -0.015062004327774048, -0.026151297613978386, 0.08671370148658752, -0.018177295103669167, 0.02386484481394291, 0.005666114389896393, 0.02682294324040413, 0.004526461008936167, -0.052016790956258774, -0.03201033174991608, -0.016133779659867287, -0.014061681926250458, 0.013175681233406067, 0.033239301294088364, 0.007681050803512335, 0.04541466012597084, 0.04341401159763336, -0.047158077359199524, -0.006409211549907923, -0.01882036030292511, 0.006973679643124342, -0.023207491263747215, 0.04861569032073021, -0.016062326729297638, 0.040956076234579086, -0.006759324576705694, -0.0012111051473766565, -0.020978199318051338, 0.05024478957056999, 0.00836698617786169, 0.029466653242707253, 0.06527820974588394, 0.0296952985227108, -0.00224894005805254, -0.018291618674993515, -0.04244226962327957, 0.006709308363497257, -0.05570369213819504, 0.04538607597351074, -0.017505649477243423, 0.011896696873009205, -0.000937802717089653, -0.009417325258255005, -0.007012977730482817, -0.0098317451775074, 0.024393588304519653, 0.02675149217247963, 0.022364361211657524, -0.04750104621052742, -0.012396858073771, -0.015290649607777596, -0.004590767435729504, 0.01079634204506874, 0.013632971793413162, -0.018577424809336662, -0.011160745285451412, -0.020206522196531296, -0.01145369652658701, -0.01331143919378519, 0.020063618198037148, -0.02682294324040413, -3.246025517000817e-05, -0.027080168947577477, 0.02779468521475792, 0.0010610567405819893, -0.026151297613978386, 0.013504358939826488, -0.02980962209403515, 0.000269729905994609, 0.014661875553429127, 0.016391005367040634, -0.020349426195025444, -0.037069108337163925, -0.1091209352016449, -0.03498271852731705, -0.003020617878064513, 0.008452728390693665, -0.03198175132274628, 0.00795971229672432, 0.023221781477332115, -0.03881252929568291, -0.004279952961951494, -0.009410180151462555, -0.006737889256328344, -0.04127046465873718, -0.03338220342993736, 0.016562487930059433, -0.0030170453246682882, 0.009974648244678974, 0.003345722798258066, -0.01882036030292511, -0.008024018257856369, 0.008038308471441269, -0.012582632713019848, -0.02760891057550907, 0.005587517749518156, 0.03463975340127945, -0.02883788011968136, 0.011839536018669605, -0.02686581388115883, -0.02766607329249382, 0.021135393530130386, -0.0061555583961308, 0.003954847808927298, -0.026251330971717834, 0.0009011837537400424, -0.01696261763572693, -0.013082793913781643, -0.018534554168581963, 0.00028491340344771743, -0.001963133690878749, -0.004587194882333279, -0.0028687831945717335, -0.023064587265253067, 0.009024341590702534, 0.02186420001089573, -0.03281059116125107, -0.02487945929169655, 0.00833126064389944, -0.01541926246136427, 0.006319896783679724, -0.024050619453191757, -0.03178168833255768, -0.007198751904070377, 0.024064909666776657, 0.021292587742209435, -0.011639471165835857, -0.012725535780191422, -0.026279911398887634, -0.015147746540606022, -0.04161342978477478, 0.03481123596429825, -1.6271993445116095e-05, 0.02556539513170719, -0.012696955353021622, -0.007088002283126116, 0.0040977513417601585, -0.005616098642349243, -0.002722307341173291, 0.00743096973747015, -0.03192459046840668, 0.011153600178658962, 0.039155494421720505, -0.03189601004123688, -0.02680865302681923, 0.02169271558523178, 0.00521239684894681, -0.004626493435353041, -0.02683723345398903, 0.01138224545866251, -0.014890520833432674, 0.008860002271831036, -0.023521877825260162, 0.01780574768781662, 0.0493873693048954, -0.006759324576705694, 0.0247365552932024, 0.015533585101366043, 0.0014334984589368105, -0.023378973826766014, -0.0594477578997612, 0.012189649045467377, -0.04755820706486702, -0.01690545678138733, 0.01671968214213848, -0.0029295170679688454, 0.014454665593802929, -0.03669755905866623, 0.00046934792771935463, 0.0028419888112694025, 0.01566219888627529, -0.01236113253980875, -0.01686258614063263, -0.011039277538657188, 0.008281243965029716, 0.005451759789139032, 0.003050984814763069, 0.003708339761942625, 0.017591392621397972, 0.016562487930059433, -0.018434520810842514, 0.024493619799613953, 0.006173421163111925, -0.006780759897083044, 0.013032778166234493, -0.01700548827648163, 0.006016227416694164, 0.01886323094367981, 0.01596229523420334, -0.029895363375544548, 0.013697277754545212, -0.02076384425163269, 0.008788551203906536, 0.019363392144441605, 0.005826880689710379, -0.008181212469935417, -0.012796987779438496, -0.018305908888578415, 0.05733279138803482, 0.0197635218501091, 0.03243904188275337, -0.01670539192855358, 0.014461810700595379, -0.02270733006298542, 0.04058452695608139, -0.00417992053553462, -0.006302034016698599, -0.003138513071462512, -0.03060987964272499, 0.003708339761942625, 0.008109760470688343, 0.03692620247602463, 0.038955431431531906, 0.01796294003725052, 0.013983084820210934, 0.00223464984446764, -0.052988532930612564, 0.04218504577875137, 0.017362747341394424, -0.0031402993481606245, -0.0032439040951430798, 0.007645324803888798, -0.002870569471269846, -0.04032730311155319, -0.004551468882709742, 0.05075924098491669, -0.04481446370482445, 0.016276681795716286, -0.03692620247602463, -0.04029872268438339, 0.008195502683520317, -0.018148714676499367, 0.024407878518104553, 0.010960680432617664, 0.03786936402320862, 0.0019434844143688679, -0.0019809964578598738, 0.0015245992690324783, 0.03155304118990898, -0.04252801090478897, -0.022593006491661072, -0.00030344616970978677, 0.004712235182523727, -0.009610245004296303, -0.015605037100613117, -0.03349652513861656, -0.019406264647841454, 0.02563684619963169, 0.001281663659028709, -0.044128529727458954, -0.0071380180306732655, -0.00794542208313942, -0.0017282364424318075, 0.0001362046750728041, 0.029323751106858253, -0.015505004674196243, 0.027051588520407677, 0.03161020204424858, -0.01086779311299324, -0.008016873151063919, -0.02260729670524597, 0.02074955403804779, -0.003024190431460738, 0.017034068703651428, 0.012103906832635403, -0.04532891511917114, -0.05207395181059837, -0.010624857619404793, -0.044042788445949554, -0.009002906270325184, -0.0032706984784454107, -0.03358226642012596, 0.0053338645957410336, 0.023479007184505463, -0.024979490786790848, 0.034096717834472656, 0.020335134118795395, -0.005180243402719498, 0.018077263608574867, -0.05767576023936272, -0.0023543313145637512, -0.025022361427545547, 0.0018345207208767533, -0.01786290854215622, 0.006066243629902601, -0.015476424247026443, 0.006880792323499918, -0.0037226302083581686, -0.04147052764892578, 0.014383213594555855, 0.037040527909994125, -0.02980962209403515, 0.0022632305044680834, 0.03578297793865204, 0.005594662856310606, -0.016476746648550034, -0.039269816130399704, 0.013983084820210934, -0.0005564296152442694, 0.008774260990321636, 0.01687687635421753, -0.01676255278289318, 0.020363716408610344, 0.020206522196531296, -0.013997375033795834, 0.0016657161759212613, -0.012589777819812298, 0.024436458945274353, -0.006505671422928572, 0.029438072815537453, 0.017048358917236328, 0.008081180043518543, -0.04064168781042099, -0.012225374579429626, 0.02663716860115528, 0.011503713205456734, 0.0072309053502976894, -0.012532616965472698, 0.0035958033986389637, 0.03066704049706459, 0.036183107644319534, -0.01137510035187006, 0.005369590129703283, 0.020220812410116196, -0.0023275369312614202, 0.028909331187605858, -3.179039413225837e-05, -0.019277650862932205, -0.020320843905210495, 0.00224179495126009, -0.02369336225092411, 0.013775874860584736, -0.012246809899806976, 0.022264329716563225, -0.01579081080853939, -0.04049878567457199, -0.004844420589506626, 0.021306877955794334, -0.043156787753105164, 0.00832411553710699, -0.022064264863729477, 0.0005452652694657445, 0.00447644479572773, -0.11798093467950821, -0.006319896783679724, 0.026165587827563286, -0.008181212469935417, -0.0015013774391263723, 0.00023646025510970503, 0.03486839681863785, 0.0197349414229393, -0.0065878406167030334, -0.0297524593770504, 0.006448510102927685, -0.013718714006245136, 0.0023686217609792948, -0.030295493081212044, 0.010617712512612343, -0.05627530813217163, -0.03083852492272854, -0.03429678454995155, 0.01779145747423172, -0.028066201135516167, 0.0019809964578598738, -0.01887752115726471, -0.03658323734998703, -0.018505973741412163, -0.006695018149912357, 0.007938276045024395, -0.003511847695335746, 0.0147761981934309, -0.008266953751444817, -0.027165910229086876, 0.00285449274815619, 0.02373623289167881, -0.0016737545374780893, 0.0591619536280632, -0.03861246258020401, 0.019391972571611404, -0.005369590129703283, -0.017448488622903824, 0.02879500761628151, 0.032181814312934875, 0.04358549788594246, -0.020120780915021896, 0.022221457213163376, 0.018148714676499367, 0.0098460353910923, -0.019249070435762405, 0.018148714676499367, -0.020406587049365044, -0.019006134942173958, -0.01700548827648163, -0.008852857165038586, 0.008459873497486115, 0.01329000387340784, 0.013647262006998062, -0.00741667952388525, 0.029066525399684906, 0.010253309272229671, 0.0047443886287510395, -0.00795256718993187, 0.014761907979846, -0.010953535325825214, 0.019577747210860252, -9.768777817953378e-05, 0.0010038954205811024, -0.042156465351581573, -0.019020425155758858, 0.028980782255530357, 0.012161067686975002, -0.024264974519610405, -0.029895363375544548, 0.0011423330288380384, 0.025022361427545547, 0.018034392967820168, 0.035154204815626144, 0.008417002856731415, 0.00983889028429985, -0.007284494116902351, 0.034268204122781754, -0.04824414476752281, -0.00891001895070076, 0.05721846967935562, -0.02570829726755619, -0.014704746194183826, -0.018205875530838966, 0.008438438177108765, -0.0025418917648494244, 0.023421846330165863, 0.021264005452394485, -0.0039048318285495043, 0.03595446050167084, 0.04467156156897545, -0.03866962343454361, -0.006244872696697712, 0.004715807735919952, -0.03689762204885483, -0.023979168385267258, -0.015605037100613117, 0.0027115894481539726, 0.009588809683918953, 0.004962315782904625, 0.05570369213819504, 0.037297751754522324, -0.027408847585320473, -0.043128207325935364, 0.016476746648550034, -0.007495276164263487, -0.004783686716109514, -0.027137329801917076, 0.01693403720855713, 0.014947681687772274, 0.007845389656722546, 0.019606327638030052, 0.010517680086195469, 0.011875261552631855, 0.01084635779261589, 0.014976262114942074, 0.048101238906383514, 0.01428318116813898, 0.01384732685983181, -0.01079634204506874, 0.002265016781166196, 0.03569723665714264, -0.03472549468278885, 0.030438395217061043, -0.042956721037626266, 0.011782374233007431, 0.00492301769554615, 0.03189601004123688, 0.01589084416627884, 0.020492328330874443, -0.038955431431531906, 0.03501129895448685, 0.009788873605430126, 0.006973679643124342, -0.0033046379685401917, 0.0010423007188364863, 0.0038941139355301857, 0.03149588033556938, -0.03761214017868042, 0.012768407352268696, -0.0046550738625228405, 0.017205553129315376, -0.003577940631657839, 0.011760938912630081, -0.011275067925453186, -0.0038012268487364054, -0.0011351878056302667, -0.014904811047017574, -0.010789196938276291, -0.001970278797671199, 0.013232843019068241, -0.01872032880783081, 0.005626816302537918, -0.005105219315737486, 0.019592037424445152, 0.0039691380225121975, -0.03532568737864494, -0.02176416851580143, 0.01772000454366207, 0.02690868452191353, 0.026108426973223686, 0.0492444671690464, -0.018434520810842514, -0.03401097655296326, 0.018334489315748215, -0.04644356295466423, -0.005283848382532597, -0.009781728498637676, -0.03878394514322281, -0.004883719142526388, -0.028509201481938362, -0.012582632713019848, 0.03295349329710007, 0.01873461902141571, 0.04392846301198006, 0.005151662975549698, -0.01764855347573757, 0.030952848494052887, 0.011889551766216755, 0.05264556407928467, 0.03226755931973457, 0.0002829038130585104, 0.0031027873046696186, 0.007480985950678587, 0.03861246258020401, -0.03183884918689728, 0.00369762210175395, 0.031210074201226234, 0.004290670622140169, 0.009760293178260326, 0.00025387658388353884, 0.03735491260886192, -0.01681971549987793, 0.03486839681863785, -0.01783432811498642, 0.004222791641950607, 0.019020425155758858, 0.022392941638827324, -0.011932422406971455, -0.009545938111841679, -0.09168673306703568, 0.020549489185214043, -0.025036651641130447, 0.009124374017119408, -0.007359518203884363, -0.006084106396883726, 0.011953858658671379, 0.03784078359603882, -0.018020102754235268, 0.002816980704665184, -0.036125946789979935, 0.005959066096693277, -0.031267233192920685, 0.0497589185833931, -0.006384203676134348, -0.029923943802714348, 0.012639793567359447, 0.0246222335845232, -0.045128852128982544, -0.0040084365755319595, -0.05047343298792839, -0.038298074156045914, -0.011703778058290482, -0.04367123916745186, -0.04267091676592827, 0.006059098523110151, 0.015047714114189148, 0.03735491260886192, -0.017491359263658524, 0.009517357684671879, 0.0053874533623456955, 0.04172775521874428, 0.014197439886629581, -0.021449780091643333, 0.003443968715146184, -0.003000968601554632, -0.0006604810478165746, 0.004437146242707968, -0.007316647097468376, 0.011075003072619438, 0.019034715369343758, 0.005055203102529049, -0.020320843905210495, -0.035211365669965744, 0.012053890153765678, -0.03749781847000122, 0.002783041214570403, 0.0295523963868618, -0.00898147001862526, -0.012268245220184326, -0.0011566233588382602, 0.02782326564192772, 0.02163555473089218, 0.0040977513417601585, 0.010010373778641224, -0.005541074089705944, 0.016190940514206886, 0.02783755585551262, 0.028151944279670715, 0.022278619930148125, -0.01600516587495804, 0.00371191231533885, 0.0046050576493144035, -0.013997375033795834, 0.029466653242707253, -0.02064952254295349, -0.02070668339729309, -0.0018148714443668723, -0.0013691919157281518, -0.020535198971629143, -0.014947681687772274, 0.02365049161016941, -0.009374454617500305, 0.03289633244276047, 0.004819412715733051, -0.015047714114189148, 0.013175681233406067, -0.040184397250413895, 0.011217906139791012, -0.002043516840785742, -0.022593006491661072, -0.011532293632626534, -0.037126269191503525, -0.010989260859787464, 0.006998687516897917, -0.03675471991300583, -0.030009686946868896, -0.00444786436855793, 0.014733326621353626, -0.0010467664105817676, 0.03186742961406708, 0.038298074156045914, 0.003708339761942625, 0.004948025569319725, -0.04647214338183403, -0.005744711495935917, 0.0246222335845232, 0.010303325951099396, 0.010903519578278065, -0.029438072815537453, 0.011289358139038086, -0.0020810288842767477, 0.006312751676887274, -0.03395381569862366, 0.037897948175668716, 0.003161734901368618, 0.03369659185409546, -0.035268526524305344, -0.024650814011693, -0.025050941854715347, -0.013218551874160767, 0.04367123916745186, 0.016533907502889633, 0.023579038679599762, 0.02064952254295349, 0.017477069050073624, 0.0025240289978682995, -0.017591392621397972, 0.01772000454366207, -0.002391843358054757, 0.003252835711464286, 0.008266953751444817, -0.007909695617854595, 0.004715807735919952, -0.021235425025224686, -0.03243904188275337, 0.004515743348747492, -0.026208458468317986, -0.006302034016698599, 0.020192231982946396, 0.01671968214213848, 0.01867745630443096, 0.0013763371389359236, 0.016519617289304733, -0.01579081080853939, 0.0001532860769657418, -0.009474487043917179, -0.013518649153411388, -0.006691445596516132, -0.030152589082717896, 0.023036006838083267, -0.0031778113916516304, -0.003936985041946173, -0.00285449274815619, -0.01691974699497223, -0.002804476534947753, 0.019049005582928658, -0.012011019513010979, -0.02193565107882023, -0.01536210160702467, 0.0797400251030922, -0.006234155036509037, -0.013961649499833584, -0.01883465051651001, 0.009581663645803928, -0.013682987540960312, -0.006795050576329231, -0.035154204815626144, -0.04438575357198715, -0.004297815728932619, -0.015176326967775822, 0.03449684754014015, 0.019077586010098457, 0.02159268409013748, 0.01138224545866251, -0.025050941854715347, 0.003808372188359499, 0.015062004327774048, 0.005973356775939465, 0.02064952254295349, 0.0014147423207759857, 0.009767438285052776, -0.008252663537859917, -0.017148392274975777, -0.025322459638118744, 0.004304960835725069, 0.011589455418288708, 0.01194671355187893, 0.016276681795716286, 0.003954847808927298, 0.02685152366757393, 0.005866179242730141, -0.037926528602838516, 0.028537781909108162, -0.00568040506914258, -0.01766284368932247, -0.009281567297875881, 0.035097043961286545, -0.04521459341049194, -0.0036618963349610567, -0.023278942331671715, 0.00543389655649662, 0.01579081080853939, 0.0246222335845232, 0.0008784084930084646, 0.03381091356277466, 0.008588486351072788, 0.010146131739020348, -0.005448187235742807, -0.009781728498637676, 0.033096395432949066, -0.010103261098265648, 0.035211365669965744, -0.012046745046973228, 0.014719036407768726, -0.020306553691625595, -0.01789148896932602, 0.023922007530927658, 0.027037298306822777, -0.0026419241912662983, -0.04744388535618782, -0.007859679870307446, -0.03652607649564743, -0.006305606570094824, -0.0010038954205811024, -0.04558614268898964, 0.01687687635421753, -0.0008663510670885444, 0.02096390910446644, 0.05055917426943779, -0.014719036407768726, 0.024650814011693, 0.009888906031847, -0.0006140375044196844, 0.03075278364121914, 0.016333842650055885, -0.0197349414229393, -0.0032188959885388613, 0.024793716147542, 0.012525470927357674, 0.004033444914966822, 0.013154245913028717, -0.003065275028347969, -0.0017702141776680946, -0.013611536473035812, 0.017262713983654976, 0.03784078359603882, 0.027237363159656525, 0.012461164966225624, 0.02872355654835701, -0.010653438977897167, -0.008488453924655914, 0.018391650170087814, -0.01686258614063263, 0.02062094211578369, -0.023250361904501915, 0.00590904988348484, -0.03646891564130783, 0.0022739481646567583, 0.01564790867269039, 0.00046711505274288356, -0.02079242467880249, -0.005473195109516382, 0.007602453697472811, 0.0031778113916516304, 0.014504681341350079, -0.05353156477212906, -0.042956721037626266, 0.005594662856310606, -0.002223932184278965, -0.0024668676778674126, 0.005566082429140806, -0.007359518203884363, -0.006502098869532347, -0.03744065761566162, 0.02485087886452675, 0.0036869042087346315, 0.01686258614063263, -0.012096761725842953, -0.029380911961197853, 0.03266768530011177, 0.037297751754522324, 0.003594017121940851, 0.006316324230283499, -0.029266588389873505, -0.0037297753151506186, -0.012718390673398972, 0.009974648244678974, 0.009888906031847, -0.007931130938231945, 0.006327042356133461, -0.012289680540561676, -0.007588163483887911, -0.01329000387340784, -0.016262391582131386, 0.027223072946071625, 0.019206199795007706, -0.018348779529333115, -0.01882036030292511, -0.004805122502148151, -0.016290972009301186, 0.005698267836123705, -0.020978199318051338, -0.032067492604255676, 0.008795696310698986, 0.004283525515347719, -0.0039619929157197475, 0.01141797099262476, 0.014018810354173183, 0.03401097655296326, 0.00522668706253171, -0.0015210265992209315, -0.008266953751444817, -0.008166921325027943, -0.014933391474187374, -0.02485087886452675, 0.008824276737868786, -0.013254278339445591, 0.006791477557271719, 0.020549489185214043, 0.00891716405749321, -0.007609598804265261, -0.03161020204424858, 0.03266768530011177, 0.02082100696861744, -0.015533585101366043, -0.016491036862134933, 0.02570829726755619, 0.038126591593027115, 0.011539438739418983, 0.0028634241316467524, -0.002449004678055644, 0.027237363159656525, -0.00309921451844275, -0.026994427666068077, -0.01694832742214203, -0.023121748119592667, 0.018263038247823715, -0.006230582483112812, 0.02483658865094185, 0.011896696873009205, -0.010003228671848774, 0.039126913994550705, 0.029166556894779205, 0.006559260189533234, 0.021063942462205887, -0.0009235123870894313, 0.012411149218678474, -0.01670539192855358, 0.02072097361087799, 0.01992071606218815, -0.00013609303277917206, -0.034125301986932755, -0.006223437376320362, 0.013597246259450912, 0.011067857965826988, 0.010024663992226124, -0.002207855461165309, -0.029438072815537453, 0.021264005452394485, -0.027365975081920624, -0.0009610244887880981, 0.027494588866829872, -0.030095428228378296, 0.0016469601541757584, 0.005616098642349243, -0.01796294003725052, -0.021306877955794334, 0.02655142731964588, -0.0006091251852922142, 0.018277328461408615, -0.0018112988909706473, 0.0296952985227108, 0.027023008093237877, 0.03398239612579346, -0.03732633218169212, -0.011546583846211433, -0.003819089848548174, -0.012182503938674927, -0.03078136406838894, 0.024207813665270805, 0.012053890153765678, 0.013954504393041134, 0.019620617851614952, -0.026151297613978386, 0.018148714676499367, 0.010574841871857643, 0.014318907633423805, 0.010353341698646545, 0.001580867450684309, 0.024350717663764954, 0.008738534525036812, 0.00831697043031454, -0.01677684299647808, 0.0010896374005824327, -0.012625503353774548, 0.008224083110690117, -0.002888432238250971, 0.029923943802714348, -0.004772969055920839, -0.05113079026341438, -0.008152631111443043, 0.005037340335547924, 0.025351040065288544, 0.019206199795007706, 0.03495413810014725, 0.017219843342900276, 0.01288987509906292, -0.019206199795007706, -0.005712558049708605, -0.004351404495537281, 0.022150006145238876, -0.0012718391371890903, -0.047043755650520325, -0.0012905951589345932, -0.044014208018779755, -0.006055525969713926, -0.006334187462925911, 0.04358549788594246, 0.024279264733195305, 0.012161067686975002, -0.00797400251030922, 0.01700548827648163, 0.01331143919378519, -0.016133779659867287, 0.03172452375292778, -0.009988938458263874, -0.004333541728556156, -0.0034921986516565084, -0.02762320078909397, -0.011868116445839405, 0.00897432491183281, -0.024164943024516106, 0.004687227308750153, 0.019049005582928658, 0.024164943024516106, 0.00838842149823904, -0.04532891511917114, 0.01573364995419979, 0.022135715931653976, 0.049130141735076904, -0.003302851691842079, -0.014604713767766953, 0.010131841525435448, -0.0037226302083581686, 0.0013638330856338143, -0.020049327984452248, 0.013540084473788738, 0.013618681579828262, 0.037297751754522324, 0.024264974519610405, 0.010246164165437222, 0.005158808082342148, -0.03564007580280304, 0.006684300489723682, 0.0008551867213100195, 0.01146084163337946, -0.02159268409013748, 6.179449701448902e-05, 0.014504681341350079, -0.028294846415519714, -0.017176972702145576, -0.009531647898256779, 0.005326719488948584, 0.008602776564657688, -0.0007274669478647411, -0.013132810592651367, 0.038298074156045914, 0.03455400839447975, -0.007538147270679474, 0.012039599940180779, -0.011039277538657188, -0.013975939713418484, 0.014661875553429127, 0.011024987325072289, 0.00692009087651968, 0.021121103316545486, -0.01794864982366562, -0.030324073508381844, 0.042156465351581573, 0.00740238931030035, 0.036040205508470535, 0.00028580654179677367, -0.020235102623701096, 0.011860971339046955, -0.013682987540960312, 0.019049005582928658, -0.012425439432263374, 0.012182503938674927, -0.01145369652658701, 0.018091553822159767, -0.022021394222974777, 0.030438395217061043, 0.002713375724852085, 0.009088647551834583, -0.0029455935582518578, 0.006255590356886387, 0.02685152366757393, 0.03561149537563324, -0.012775552459061146, -0.02292168326675892, 0.008638502098619938, -0.03060987964272499, -0.018991844728589058, -0.007595308590680361, 0.029023652896285057, -0.02870926633477211, -0.006723598577082157, -0.027008717879652977, 0.004037017468363047, 0.03775504231452942, 0.03281059116125107, -0.0031938881147652864, -0.011746648699045181, 0.0010851717088371515, 0.003769073635339737, 0.017377037554979324, -0.0059447758831083775, 0.004072743002325296, -0.014397503808140755, -0.011968148872256279, -0.00572327570989728, 0.015290649607777596, -0.001316496403887868, 0.022564426064491272, 0.010760615579783916, -0.012825568206608295, -0.0395270437002182, 0.0016907242825254798, 0.026222748681902885, -0.015590746887028217, 0.01690545678138733, 0.001939911860972643, -0.023107457906007767, -0.003947702702134848, 0.004955170676112175, -0.012654084712266922, -0.009553083218634129, -0.005073065869510174, -0.009403035044670105, 0.021292587742209435, -0.0297238789498806, 0.046815112233161926, -0.007045131176710129, 0.009595954790711403, -0.03143871948122978, -0.014490391127765179, -0.00449073500931263, -0.002131044864654541]",Online Speculative Decoding.pdf
" for online chatting. For all SD
methods evaluated across all datasets, SmartSpec guarantees
improved performance without any degradation, which is a
crucial feature for making SD useful in a production-ready
online serving system.
In summary, the paper makes the following contributions:
‚Ä¢We perform the first study on speculative decoding within
a real-world, online serving system with continuous
batching scheduling (¬ß3).
‚Ä¢We define the goodput for speculative decoding, which
takes into account both system throughput and specula-
tion accuracy (¬ß4).
‚Ä¢We design and implement a speculative decoding sched-
uling framework that utilizes goodput as key metrics
to determine the optimal proposal length for different
request volumes (¬ß5, ¬ß6). Evaluation of SmartSpec on five
models across different tasks shows that SmartSpec con-
sistently reduces latency under different system loads,
bringing up to 3.2√ólatency reduction compared with
non-speculative decoding baseline (¬ß7).
2 Background
Given a list of tokens (ùë•1,...,ùë•ùëõ), a large language model
(LLM) [ 1,3] is trained to predict the conditional probability
distribution for the next token: ùëÉ(ùë•ùëõ+1|ùë•1,...,ùë•ùëõ).When
deployed as a service [ 19,31], the LLM takes in a list of
2
Draft Modelùë•!ùë•""ùë•#ùë•$Target Modelùë•!ùë•""ùë•#ùë•$Proposed TokensAccepted TokensBonus TokensRequest PoolR1R3R2R4ùë•$ùë•""ùë•!ùë•#Propose autoregressivelyScoring in a single forward passùë•!ùë•""ùë•#ùë•$
Accept TokensRejection SamplerFigure 2. A single generation step when combining continuous batching with speculative decoding. The draft model runs
in an autogressive manner. The proposed tokens are sent to the target model for scoring in a single forward pass. A single
generation step can generate more than one token for each request.
tokens from the user request and generates an output se-
quence(ùë•ùëõ+1,...,ùë•ùëõ+ùëá). The generation process requires se-
quentially evaluating the probability and samples the token
at every position for ùëátimes.
Due to the sequential data dependency, this computation
often suffers from low device utilization when running on
GPUs, which leads to high inference latency and low serving
throughput [ 31]. Therefore, many previous works propose
different algorithms to decrease the latency or increase the
throughput when serving LLMs. In this paper, we focus on
two categories of optimization algorithms, speculative decod-
ingandcontinuous batching .
2.1 Speculative Decoding
Although LLMs can only generate output tokens sequen-
tially, when facing a list of output tokens (ùë•ùëõ+1,...,ùë•ùëõ+ùëá),
LLMs can efficiently evaluate the probabilities for each token
ùëÉ(ùë•ùëõ+1|ùë•1,...,ùë•ùëõ),...,ùëÉ(ùë•ùëõ+ùëá|ùë•1,...,ùë•ùëõ+ùëá‚àí1)in parallel.
Speculative decoding [5,20] utilizes this property to reduce
the generation latency of LLMs.
Specifically, in speculative decoding, we turn the target
LLM into an evaluator. At every step, We use another more
efficient draft model to propose a list of candidate tokens
(ùë¶ùëõ+1,...,ùë¶ùëõ+ùëò),whereùëòis the number of proposed candi-
dates. Then, we feed these ùëòtokens to the target LLM to
evaluate the probabilities ùëÉ(ùë¶ùëõ+1|ùë•1,...,ùë•ùëõ),...,ùëÉ(ùë¶ùëõ+ùëò|
ùë•1,...,ùë•ùëõ,ùë¶ùëõ+1,...,ùë¶ùëõ+ùëò‚àí1)in parallel. Based on the proba-
bilities and sampling methods, we will accept a subset of
tokensùë¶1,...,ùë¶ùëö, whereùëöis the number of accepted tokens.
As an example, for greedy sampling, we check whether each
ùë¶ùëõ+ùëñis","[0.022147286683321, 0.01951039582490921, 0.016938451677560806, -0.005208834074437618, -0.013600122183561325, -0.001492181560024619, 0.004374251235276461, 0.029720230028033257, 0.01683453470468521, 0.0016253250651061535, 0.04387890547513962, -0.017938653007149696, -0.06177859008312225, 0.0050204843282699585, 0.014496405608952045, -0.03728018328547478, -0.010274781845510006, 0.0028853171970695257, -0.002399830613285303, 0.011060653254389763, 0.024576343595981598, 0.00920963380485773, 0.016808556392788887, 0.011716628447175026, 0.03333134204149246, -0.03078537806868553, 0.01592526212334633, 0.04387890547513962, 0.043593134731054306, -0.06385692954063416, 0.0028008848894387484, -0.013340329751372337, -0.029486415907740593, -0.04232015088200569, -0.007624901365488768, 0.028888894245028496, -0.015899283811450005, -0.009404477663338184, -0.004734713118523359, -0.029070748016238213, -0.009612311609089375, -0.0356694720685482, -0.04356715455651283, 0.005192596931010485, 0.03764389082789421, 0.08266588300466537, 0.013255897909402847, -0.03455236554145813, 0.010619007050991058, 0.0544004887342453, -0.0671822652220726, 0.016353920102119446, -0.0033772988244891167, -0.005377698689699173, 0.010982715524733067, -0.029356520622968674, -0.015132896602153778, 0.04273581877350807, 0.025511594489216805, -0.010683954693377018, 0.032188255339860916, -0.029772188514471054, 0.006735112983733416, -0.0021351673640310764, -0.05902479216456413, -0.028473226353526115, -0.01934153027832508, 0.05227019265294075, -0.022498006001114845, 0.027641890570521355, 0.009131696075201035, -0.02636891044676304, 0.04395684227347374, -0.03333134204149246, -0.04476219788193703, 0.019861115142703056, 0.04237211123108864, 0.04925660416483879, 0.003307479666545987, -0.006040168926119804, 0.015366709791123867, 0.026459837332367897, 0.0032084337435662746, -0.04902279004454613, -0.019770188257098198, -0.025433657690882683, 0.006170065142214298, 0.016237013041973114, -0.03242206946015358, -0.03455236554145813, -0.028057558462023735, 0.032993610948324203, -0.03525380417704582, 0.01297012623399496, 0.019835134968161583, 0.03569544851779938, 0.016094127669930458, -0.03564349189400673, 0.06042766943573952, 0.01926359347999096, 0.024680260568857193, -0.023290371522307396, 0.021484816446900368, -0.05777778849005699, 0.05720624700188637, -0.04621703550219536, -0.03782574459910393, 0.06957235187292099, -0.0027261944487690926, -0.03538369759917259, -0.06344126164913177, -0.03886491432785988, -0.07040368765592575, 0.0027537974528968334, -0.0053939358331263065, -0.03673461824655533, -0.06141487881541252, -0.01834133081138134, 0.004997752606868744, 0.031201044097542763, -0.01717226579785347, -0.00029510771855711937, 0.04455436393618584, -0.010476120747625828, -0.018523184582591057, 0.01658773235976696, 0.038501206785440445, -0.10505997389554977, 0.026264993473887444, 0.007943146862089634, 0.012125801295042038, 0.008384793996810913, 0.03722822293639183, -0.02456335350871086, -0.035071950405836105, -0.013093527406454086, -0.04047562554478645, -0.007131296209990978, -0.02465428039431572, 0.028005599975585938, -0.0034584838431328535, -0.03530576080083847, -0.008631596341729164, 0.005319245625287294, -0.03387690335512161, -0.012275181710720062, 0.0003902972093783319, -0.004286571405827999, -0.04611311852931976, 0.024849124252796173, -0.023381298407912254, -0.028005599975585938, -0.023965831845998764, 0.009638290852308273, 0.01696443185210228, -0.024420468136668205, -0.04507394880056381, 0.026511795818805695, 0.03091527335345745, -0.014899083413183689, -0.023965831845998764, 0.06375300884246826, 0.03117506578564644, 0.0025962984655052423, -0.004523632116615772, 0.03325340151786804, -0.03036971017718315, 0.011625701561570168, -0.058764997869729996, -0.023719029501080513, -0.003351319581270218, -0.008897882886230946, 0.0065954746678471565, -0.039592333137989044, -0.03117506578564644, -0.008527679368853569, -0.006248002871870995, -0.06432455033063889, 0.04073541983962059, -0.0630255937576294, -0.03226619213819504, 0.040423668920993805, -0.023537173867225647, -0.008488710969686508, -0.01671762950718403, -0.021043168380856514, -0.0141197070479393, 0.005325740203261375, 0.01800359971821308, 0.041306961327791214, -0.00015049682406242937, 0.03494205325841904, 0.055127907544374466, -0.022173264995217323, -0.0035981221590191126, -0.013963831588625908, 0.04208633676171303, 0.06676659733057022, 0.01792566291987896, -0.003507194807752967, 0.012937651947140694, 0.032655879855155945, -0.01251548994332552, -0.029486415907740593, 0.034994009882211685, 0.013781976886093616, 0.011041169054806232, -0.005309503525495529, 0.0032912425231188536, -0.021510794758796692, 0.004312550649046898, 0.010943747125566006, 0.05632295086979866, -0.010476120747625828, -0.03049960546195507, 0.018354319036006927, -0.013210434466600418, 0.015067948028445244, 0.014691249467432499, 0.03174660727381706, 0.009794166311621666, 0.007131296209990978, 0.013048063963651657, 0.03689049556851387, -0.0189258623868227, 0.07518386840820312, 0.018782977014780045, 0.01203487440943718, 0.025134896859526634, -0.03961831331253052, 0.018107516691088676, -0.008748502470552921, -0.001927333534695208, -0.028473226353526115, 9.823393338592723e-05, -0.0006584108923561871, 0.01535371970385313, -0.015600522048771381, -0.020731419324874878, -0.06484413892030716, 0.01634093001484871, 0.00920963380485773, 0.02305655926465988, -0.0050139897502958775, -0.03146083652973175, 0.011216528713703156, -0.06614309549331665, -0.03322742506861687, 0.012184254825115204, 0.03104516863822937, -0.009664270095527172, -0.05523182451725006, -0.02314748615026474, -0.004435951821506023, -0.04073541983962059, 0.031356919556856155, -0.006446094252169132, -0.004526879172772169, -0.025381699204444885, 0.02753797546029091, -0.01905575953423977, -0.05068546161055565, -0.009657775051891804, 0.019029779359698296, -0.03159073367714882, -0.03761791065335274, -0.015444647520780563, -0.007417067885398865, 0.020159875974059105, -0.03813749551773071, -0.01065797545015812, -2.882069929910358e-05, -0.02226419188082218, 0.019029779359698296, -0.031097127124667168, -0.05564749240875244, 0.010911272838711739, 0.02414768561720848, -0.06515588611364365, 0.014548364095389843, 0.00902777910232544, -0.03275979682803154, 0.04533373937010765, 0.019146686419844627, 0.027849724516272545, 0.00960581749677658, 0.030889295041561127, -0.04026779159903526, -0.014717228710651398, -0.011664669960737228, 0.013652080669999123, -0.003406525356695056, 0.02849920652806759, -0.05476420000195503, 0.02356315404176712, 0.017328141257166862, 0.02352418564260006, 0.008761492557823658, -0.030681461095809937, -0.014613311737775803, 0.06920864433050156, 0.02109512686729431, 0.010255297645926476, 0.006475321017205715, 0.004552858415991068, 0.0027537974528968334, -0.02109512686729431, 0.009820145554840565, -3.440217187744565e-05, -0.007170265074819326, 0.004546363838016987, -0.003331835148856044, -0.024602321907877922, 0.005478368140757084, -0.02803158015012741, -0.05637491121888161, 0.059856124222278595, -0.06427258998155594, 0.00035011061117984354, -0.040215834975242615, -0.010755397379398346, 0.0002794796018861234, -0.026914473623037338, 0.018705040216445923, 0.04504796862602234, -0.02222522348165512, -0.0006121353944763541, -0.001138214603997767, -0.003926109988242388, -0.029824145138263702, 0.034916073083877563, 0.04782774671912193, 0.029148686677217484, 0.01153477467596531, -0.03078537806868553, -0.04881495609879494, -0.03618905693292618, 0.016016189008951187, 0.03262990340590477, 0.0032766293734312057, -0.06235013157129288, 0.028005599975585938, 0.004202139098197222, -0.04091727361083031, -0.006423362530767918, 0.004656775388866663, 0.009053758345544338, 0.021926462650299072, 0.08552359789609909, 0.008670564740896225, -0.023095527663826942, -0.025459636002779007, 0.04432054981589317, -0.041255004703998566, 0.023550163954496384, 0.0014970526099205017, 0.013340329751372337, -0.03722822293639183, -0.03876099735498428, -0.0011625702027231455, -0.00967076513916254, 0.03439648821949959, 0.02030276134610176, -0.001139026484452188, 0.006916967686265707, 0.009222623892128468, -0.0042573451064527035, -0.0070338742807507515, 0.006147333420813084, -0.03213629499077797, 0.012320646084845066, 0.09726620465517044, -0.024394487962126732, 0.006657175254076719, -0.03592926263809204, -0.013405278325080872, -0.019575342535972595, 0.05263390392065048, 0.008930357173085213, 0.038085538893938065, -0.009566848166286945, 0.011359414085745811, -0.009164170362055302, -0.03639689087867737, 0.018575143069028854, 0.039800167083740234, -0.001333058811724186, -0.027693849056959152, -0.03878697752952576, -0.02273181825876236, -0.021251002326607704, -0.011651680804789066, 0.010437152348458767, 0.009781177155673504, 0.009755197912454605, 0.035955242812633514, -0.01934153027832508, 0.037539973855018616, 0.024472426623106003, 0.019692249596118927, 0.031356919556856155, -0.013678059913218021, 0.0017795766470953822, -0.03164269030094147, -0.01779576577246189, 0.047853726893663406, 0.02816147543489933, 0.028758997097611427, 0.050789378583431244, 0.011703639291226864, 0.04143685847520828, -0.00923561304807663, 0.04634692892432213, -0.053257402032613754, 0.028213433921337128, -0.0013087033294141293, 0.021991411224007607, 0.017860714346170425, 0.06931256502866745, 0.08308155089616776, 0.018458236008882523, -0.02920064516365528, -0.03556555509567261, -0.008813451044261456, -0.03790368512272835, -0.03333134204149246, 0.005829087924212217, 0.010248802602291107, 0.038942851126194, -0.04910072684288025, -0.04754197597503662, 0.008599122054874897, 0.04793166369199753, -0.06063550338149071, -0.028005599975585938, -0.003203562693670392, 0.027460036799311638, 0.009573343209922314, -0.01228167675435543, -0.059856124222278595, -0.038631100207567215, 0.007884693332016468, -0.011814051307737827, 0.02352418564260006, -0.023628102615475655, 0.027797766029834747, -0.03824141249060631, -0.023459237068891525, 0.014925062656402588, -0.015769386664032936, 0.041177064180374146, -0.02001699060201645, 0.03878697752952576, 0.014028779231011868, -0.02444644644856453, -0.06105117127299309, 0.09596724063158035, -0.053127508610486984, 0.04156675562262535, 0.005965478718280792, 0.030473627150058746, 0.0006904790061526, -0.04232015088200569, -0.03964429348707199, -0.010995705612003803, -0.011599722318351269, 0.024095727130770683, 0.029902083799242973, 0.021653680130839348, 0.046606723219156265, 0.043099526315927505, -0.01800359971821308, 0.012586932629346848, 0.007423562463372946, 0.0040592532604932785, 0.01510691735893488, 0.06754597276449203, -0.029486415907740593, 0.03990408405661583, -0.023251403123140335, -0.003083408810198307, -0.013444246724247932, 0.054920073598623276, 0.01113859098404646, 0.03899481147527695, 0.07201439887285233, 0.018899884074926376, -0.004890588577836752, -0.02335532009601593, -0.04013789817690849, -0.021069148555397987, -0.02740807831287384, 0.051906485110521317, -0.014951041899621487, -0.0076833548955619335, -0.010066947899758816, 0.0016902730567380786, 0.01583433523774147, 0.0013208810705691576, 0.02201738953590393, 0.027797766029834747, -0.011313950642943382, -0.021757597103714943, 0.01587330363690853, -0.0017730818362906575, 0.013898883014917374, -0.0027294419705867767, -0.0026709886733442545, -0.017873704433441162, -0.0025898036547005177, -0.005163370165973902, -0.007897683419287205, -0.014236613176763058, 0.011333434842526913, -0.02414768561720848, -0.010638491250574589, -0.026381898671388626, -0.0029210387729108334, -0.02740807831287384, -0.023796966299414635, 0.02109512686729431, -0.013190949335694313, 0.002700215205550194, 0.008215928450226784, 0.017782777547836304, -0.010190350003540516, -0.026732617989182472, -0.08796564489603043, -0.02527778223156929, -0.02380995638668537, 0.008722523227334023, -0.0183802992105484, 0.010300761088728905, 0.045853324234485626, -0.02297862060368061, -0.003715028753504157, -0.02686251513659954, 0.0024209385737776756, -0.04813949763774872, -0.03463030233979225, -0.0022066100500524044, 0.004234612919390202, 0.007365109398961067, 0.02648581564426422, -0.005695944186300039, -0.03091527335345745, 0.010937252081930637, -0.01535371970385313, -0.026174064725637436, 0.0013655328657478094, 0.014249603264033794, -0.024264592677354813, 0.012216729111969471, -0.022718828171491623, -0.018289372324943542, 0.006540269125252962, -0.0006640938227064908, 0.009040769189596176, -0.02870703861117363, -0.015548563562333584, -0.0034032780677080154, -0.018185455352067947, -0.015301761217415333, 0.00804056879132986, -0.014405477792024612, -0.0038189454935491085, -0.0005869680317118764, -0.034994009882211685, 0.02060152217745781, 0.024043768644332886, -0.03761791065335274, -0.01328837126493454, 0.01847122609615326, -0.019692249596118927, 0.0011033050250262022, -0.025628501549363136, -0.009073243476450443, -0.00730016129091382, 0.02610911801457405, 0.021289972588419914, -0.004640538245439529, -0.030525585636496544, -0.02173161879181862, -0.02001699060201645, -0.02427758276462555, 0.004991258028894663, 0.022082338109612465, 0.012755797244608402, -0.008573142811655998, -0.011391888372600079, 0.024719228968024254, -0.001129284268245101, -0.016600722447037697, -0.0025248555466532707, -0.013872903771698475, -0.004786671604961157, 0.04434652999043465, -0.008241907693445683, -0.04458034411072731, 0.008995305746793747, 0.011742607690393925, 0.01065797545015812, 0.002401454374194145, -0.006267487071454525, -0.021796567365527153, 0.003575390437617898, -0.029694249853491783, 0.005575790535658598, 0.041800566017627716, -0.013009094633162022, 0.022991610690951347, 0.02188749425113201, 0.02051059529185295, -0.03800760209560394, -0.048113517463207245, 0.007923662662506104, -0.05486811697483063, -0.012171264737844467, 0.03777378797531128, -0.005819345358759165, 0.011814051307737827, -0.022952642291784286, 0.010326740331947803, 0.0006137590971775353, 0.02686251513659954, -0.012203739024698734, -0.0213549192994833, -0.013048063963651657, 0.012106317095458508, -0.006670164875686169, -0.005738160572946072, -0.00462754862383008, 0.005962231196463108, 0.012625901959836483, -0.009053758345544338, 0.01224270835518837, 0.0055985222570598125, -0.00965128093957901, 0.01113859098404646, -0.001258368487469852, 0.018601123243570328, 0.02486211434006691, 0.004221623297780752, -0.028005599975585938, 0.001675659790635109, -0.00045666599180549383, -0.0024875104427337646, 0.014756198041141033, 0.01230765599757433, -0.003500699996948242, -0.03395484387874603, -0.01821143366396427, 0.04452838376164436, 0.0014199267607182264, 0.03143485635519028, -0.03278577700257301, 0.030265793204307556, -0.032188255339860916, 0.03579936549067497, -0.0013647209852933884, -0.01562650129199028, -0.0029194150120019913, -0.016782576218247414, -0.003922862466424704, -0.005806355737149715, 0.04044964909553528, 0.02940847910940647, 0.002334882505238056, 0.0043645091354846954, -0.011359414085745811, -0.05777778849005699, 0.03865708038210869, 0.038293372839689255, -0.03738410025835037, -0.008956336416304111, -0.004426209721714258, -0.020315751433372498, -0.03192846477031708, 0.0019224623683840036, 0.03343525901436806, -0.032655879855155945, -0.001407749019563198, -0.03366906940937042, -0.019614312797784805, -0.010606016963720322, 0.00016287753533106297, 0.032396089285612106, 0.013898883014917374, 0.026044169440865517, 0.02678457647562027, -0.01247002650052309, -0.00942396279424429, 0.03811151906847954, -0.03824141249060631, 0.009638290852308273, -0.004718475975096226, -0.0068000610917806625, 0.017652880400419235, -0.022510996088385582, -0.04930856078863144, -0.020458636805415154, 0.044268593192100525, 0.017224224284291267, -0.030057959258556366, -0.00730016129091382, -0.020484615117311478, -0.010898283682763577, 0.005436152219772339, 0.017055358737707138, -0.02088729478418827, 0.03543565794825554, 0.014444447122514248, -0.0058096032589674, -0.008618606254458427, -0.02836930938065052, 0.0098591148853302, -0.019198644906282425, -0.01621103473007679, 0.011768586933612823, -0.04975020885467529, -0.05808953940868378, -0.017276182770729065, -0.028109516948461533, -0.017185254022479057, -0.003861161880195141, -0.004231365863233805, 0.0021514042746275663, 0.023212434723973274, -0.027226224541664124, 0.021406877785921097, -0.004429457243531942, 0.0030217082239687443, 0.026550764217972755, -0.04710032790899277, -0.0036435858346521854, -0.025888293981552124, -0.007222223561257124, -0.017198244109749794, 0.00044408231042325497, -0.014925062656402588, 0.023472227156162262, -0.028758997097611427, -0.040839336812496185, 0.03535772114992142, 0.040293771773576736, -0.008748502470552921, -0.003268510801717639, 0.030941251665353775, -0.019185654819011688, -0.00948241539299488, -0.036994412541389465, 0.01011241227388382, 0.005640738643705845, 0.0021254250314086676, 0.004643785767257214, -0.01826339215040207, 0.020744407549500465, 0.013872903771698475, -0.02620004490017891, -0.025953242555260658, 0.00451388955116272, 0.029096728190779686, -0.006481815595179796, 0.016600722447037697, 0.01671762950718403, -0.0011974797816947103, -0.024836136028170586, -0.009937051683664322, 0.047983620315790176, 0.012872704304754734, 0.006111611612141132, -0.020783377811312675, -0.006670164875686169, 0.018367309123277664, 0.04174860939383507, -0.01082034595310688, -0.020653480663895607, 0.031694650650024414, -0.008079538121819496, 0.03496803343296051, -0.008657575584948063, -0.024212634190917015, -0.0032571449410170317, 0.0004972585593350232, -0.02665468119084835, 0.043229423463344574, -0.008761492557823658, 0.025771386921405792, -0.018601123243570328, -0.05084133520722389, -0.0027700343634933233, 0.018198445439338684, -0.015470625832676888, 0.01088529359549284, -0.01834133081138134, -0.011326940730214119, 0.00894334726035595, -0.1237650066614151, -0.017367109656333923, 0.025303762406110764, -0.004760692361742258, 0.005267287138849497, -0.02610911801457405, 0.02256295457482338, 0.01758793368935585, 0.003909872844815254, -0.035825345665216446, 0.020588532090187073, -0.024043768644332886, -0.004910072777420282, -0.03470823913812637, -0.006040168926119804, -0.04328138381242752, -0.022588932886719704, -0.025420667603611946, 0.012106317095458508, -0.024381499737501144, -0.006650680676102638, -0.013126001693308353, -0.03556555509567261, 0.012138791382312775, 0.009391488507390022, 0.015600522048771381, -0.004348271992057562, 0.006650680676102638, 0.0051536280661821365, -0.004724971018731594, 0.003945594187825918, 0.025563552975654602, -0.00754046905785799, 0.03868306055665016, -0.03818945586681366, 0.0037734818179160357, -0.004286571405827999, -0.028421267867088318, 0.016120105981826782, 0.02727818302810192, 0.035201843827962875, -0.02974620833992958, 0.021965431049466133, 0.007157275453209877, 0.02920064516365528, -0.03346123546361923, 0.019406478852033615, -0.013678059913218021, -0.030317751690745354, -0.009436951950192451, -0.01111261174082756, 0.017743807286024094, 0.013353319838643074, 0.004806155804544687, -0.022536974400281906, 0.01980915665626526, 0.016704639419913292, 0.0039033780340105295, 0.012047863565385342, 0.026888493448495865, -0.021835535764694214, 0.0282394140958786, 0.01514588575810194, 0.004176159854978323, -0.032863713800907135, -0.020406678318977356, 0.008306856267154217, 0.031772587448358536, -0.016146086156368256, -0.03985212370753288, 0.005760892294347286, 0.018990810960531235, 0.013678059913218021, 0.031201044097542763, 0.019614312797784805, 0.020666470751166344, -0.01617206446826458, 0.02995404228568077, -0.03941047936677933, -0.00036614463897421956, 0.05393286421895027, -0.02816147543489933, -0.0240307804197073, -0.010222823359072208, 0.013353319838643074, -0.0085471635684371, 0.03860512375831604, 0.012924662791192532, -0.008222423493862152, 0.041592732071876526, 0.013691050000488758, -0.022783776745200157, -0.002213104860857129, -0.0074430471286177635, -0.02599221095442772, -0.04034573212265968, -0.024303561076521873, 0.005033473949879408, 0.016743607819080353, 0.00468924967572093, 0.049698248505592346, 0.0410211905837059, -0.013652080669999123, -0.04484013468027115, 0.01675659790635109, -0.014860115014016628, -0.0005025355494581163, -0.02490108273923397, 0.008534174412488937, -0.00019596045603975654, 0.010807355865836143, 0.015691449865698814, -0.006176559720188379, 0.017497004941105843, -0.0073456247337162495, 0.014769187197089195, 0.04507394880056381, 0.0009490534430369735, 0.017458036541938782, -0.0011625702027231455, 0.004770434461534023, 0.03974820673465729, -0.04800960049033165, 0.047230225056409836, -0.051205046474933624, 0.014613311737775803, 0.02188749425113201, 0.03387690335512161, -0.0016772834351286292, 0.009320045821368694, -0.03972223028540611, 0.02273181825876236, 0.02616107650101185, 0.0009693496976979077, 0.009404477663338184, 0.010742408223450184, -0.002802508417516947, 0.022004401311278343, -0.049360521137714386, 0.02335532009601593, 0.0035396688617765903, 0.030759397894144058, 0.017600921913981438, 0.011651680804789066, -0.0066311960108578205, 0.0010505347745493054, -0.005952489096671343, -0.019900083541870117, -0.02423861436545849, 0.008865409530699253, 0.009105716831982136, -0.01809452846646309, -0.007495005149394274, 0.003287995234131813, 0.028966831043362617, 0.0067286184057593346, -0.03639689087867737, -0.04998402297496796, 0.005338729824870825, 0.010281276889145374, 0.03494205325841904, 0.03995604068040848, -0.013885893858969212, -0.02390088327229023, 0.024082738906145096, -0.023420268669724464, -0.012093327939510345, 0.007287171669304371, -0.03226619213819504, -0.009131696075201035, -0.023913873359560966, -0.024459436535835266, 0.022030379623174667, 0.020874304696917534, 0.04252798482775688, 0.02064049057662487, 0.019458437338471413, 0.03096723183989525, -0.004711981397122145, 0.055803366005420685, 0.020913273096084595, -0.00925509724766016, -0.010248802602291107, 0.010417668148875237, 0.029590332880616188, -0.03335731849074364, 0.007137791253626347, 0.04390488564968109, -0.006754597648978233, 0.024251602590084076, 0.015366709791123867, 0.03585132583975792, -0.010761892423033714, 0.03455236554145813, -0.016327939927577972, -0.004072242882102728, 0.014561353251338005, 0.013574142940342426, -0.025303762406110764, -0.015522584319114685, -0.06603918224573135, 0.027667870745062828, -0.020250802859663963, 0.014132696203887463, -0.007949641905725002, -0.007559953257441521, 0.0025297265965491533, 0.04491807520389557, -0.01462630182504654, 0.006813050713390112, -0.02393985167145729, 0.004400230478495359, -0.031149085611104965, 0.05356915295124054, 0.0001292872184421867, -0.0314088799059391, 0.013216928578913212, 0.03125300258398056, -0.04574940726161003, 0.00648506311699748, -0.04122902452945709, -0.03185052424669266, -0.01980915665626526, -0.019198644906282425, -0.037462037056684494, -0.010644986294209957, 0.018821945413947105, 0.00661171181127429, -0.03629297390580177, -0.0014150557108223438, 0.013548163697123528, 0.013522184453904629, 0.002924286061897874, -0.019029779359698296, -0.021822545677423477, -0.008696543984115124, -0.007988610304892063, -0.008806956000626087, -0.013294866308569908, 0.03213629499077797, 0.00205722963437438, -0.016483815386891365, 0.0002900336403399706, -0.023498205468058586, 0.029070748016238213, -0.01679556630551815, -0.0070338742807507515, 0.013281877152621746, -0.0066311960108578205, -0.004750950261950493, -0.005725170951336622, 0.02056255377829075, 0.03153877332806587, -0.0028771988581866026, 0.010774881578981876, -0.00231377431191504, 0.009865608997642994, 0.031071148812770844, 0.03842326998710632, 0.03351319581270218, -0.02056255377829075, -0.0058096032589674, 0.008742008358240128, 1.676979081821628e-05, 0.004403478000313044, -0.032525986433029175, -0.013457236811518669, 0.004806155804544687, 0.007469025906175375, -0.021367909386754036, -0.04377498850226402, 0.013820945285260677, -0.008495205081999302, 0.039254602044820786, 0.010748903267085552, -0.022835735231637955, 0.019120706245303154, -0.03608513996005058, 0.026602722704410553, -0.01583433523774147, -0.0226408913731575, -0.0049425470642745495, -0.027589932084083557, -0.021991411224007607, 0.010606016963720322, -0.03839728981256485, -0.024043768644332886, -0.002742431592196226, 0.02720024436712265, -0.007696344517171383, 0.04367107152938843, 0.0517246313393116, 0.004182654432952404, 0.003887140890583396, -0.04624301567673683, -0.020458636805415154, 0.006040168926119804, 0.022588932886719704, 0.008644585497677326, -0.022783776745200157, 0.015769386664032936, 0.003854667069390416, 0.010690449737012386, -0.021030180156230927, 0.04774980992078781, 0.017198244109749794, 0.008683554828166962, -0.0239788219332695, -0.023095527663826942, -0.028187455609440804, -0.005312750581651926, 0.028317350894212723, 0.04034573212265968, 0.008099022321403027, 0.024966031312942505, 0.004757444839924574, 0.009307055734097958, -0.0004428645479492843, 0.018484216183423996, -0.00870953407138586, 0.004916567821055651, 0.0058680567890405655, -0.021173065528273582, -0.00024274335009977221, -0.0066247014328837395, -0.016951441764831543, 0.007657375652343035, -0.02193945273756981, -0.01864009164273739, 0.020107917487621307, 0.027875704690814018, 0.00827438198029995, -0.0009945171186700463, 0.00040450459346175194, -0.005069195758551359, -0.004910072777420282, -0.01299610547721386, -0.010326740331947803, -0.0009855866665020585, -0.026550764217972755, 0.010859314352273941, -0.004380746278911829, -0.014535374008119106, -0.007085832767188549, -0.013872903771698475, -0.004013789817690849, 0.005419915076345205, -0.019614312797784805, -0.014769187197089195, -0.03133093938231468, 0.07783374935388565, -0.002045863773673773, -0.019276581704616547, -0.025121906772255898, -0.0021692649461328983, -1.07316509456723e-05, -0.0015408925246447325, -0.041462838649749756, -0.043229423463344574, 0.00520233903080225, -0.004591827280819416, 0.018146486952900887, 0.024472426623106003, 0.018445247784256935, 0.01462630182504654, -0.013294866308569908, -0.003029826795682311, 0.022861715406179428, 0.015301761217415333, 0.023433256894350052, 0.00555630587041378, 0.006663670297712088, -0.002947018016129732, -0.0070338742807507515, -0.025589533150196075, -0.003229541936889291, 0.012521984986960888, 0.009807156398892403, 0.013327340595424175, 0.011417867615818977, 0.02205635979771614, -0.005971973296254873, -0.041047170758247375, 0.0141197070479393, -0.0019484416116029024, -0.0071053169667720795, -0.013600122183561325, 0.03709832951426506, -0.01800359971821308, -0.01696443185210228, -0.022718828171491623, -0.00036025873851031065, 0.01136590912938118, 0.02623901329934597, 0.0031792072113603354, 0.03029177151620388, 0.007917167618870735, 0.011982915922999382, 0.003042816184461117, -0.0017812004080042243, 0.018016589805483818, -0.009449942037463188, 0.04774980992078781, -0.009930557571351528, 0.019159676507115364, -0.023043569177389145, 0.004159922711551189, 0.0013257521204650402, 0.04073541983962059, 0.017315151169896126, -0.061310961842536926, 0.004351519513875246, -0.034578341990709305, -0.0110476640984416, -0.00037406018236652017, -0.02727818302810192, 0.005023731850087643, -0.005143885966390371, -0.00939798355102539, 0.05606316030025482, -0.006514289882034063, 0.024381499737501144, -0.01592526212334633, 5.317621980793774e-05, 0.02047162689268589, 0.02469325065612793, -0.005199091508984566, 0.0027700343634933233, 0.020549563691020012, 0.020081937313079834, -0.01662670075893402, 0.0030525585170835257, -0.025433657690882683, 0.007157275453209877, 0.00460806442424655, 0.02126399241387844, 0.04143685847520828, 0.005134143400937319, 0.004221623297780752, 0.015444647520780563, -0.01608113758265972, -0.004945794120430946, 0.030031979084014893, -0.020042968913912773, 0.008592627011239529, -0.029798166826367378, 0.002081585116684437, -0.039254602044820786, -0.013171465136110783, -0.009917567484080791, 0.01858813315629959, -0.04658074304461479, 0.008767987601459026, 0.0183802992105484, -3.8512167520821095e-05, 0.031227024272084236, -0.045151885598897934, -0.012379098683595657, -0.0015571295516565442, 0.005991457961499691, -0.012112812139093876, 0.00577712943777442, -0.012963631190359592, -0.006618206854909658, -0.04265788197517395, 0.027979621663689613, -0.009157675318419933, 0.02946043759584427, -0.004484663251787424, -0.023511195555329323, 0.043800968676805496, 0.03728018328547478, 0.007111812010407448, 0.0197182297706604, -0.03130496293306351, -0.018159475177526474, -0.036033179610967636, -0.0019776681438088417, 0.00646557891741395, -0.022887693718075752, -0.004130696412175894, -0.014431457035243511, -0.013379299081861973, 0.00505620613694191, -0.0063908882439136505, 0.029486415907740593, 0.013216928578913212, -0.005871303845196962, -0.022991610690951347, -0.007917167618870735, -0.008410773240029812, -0.0003586350358091295, -0.00808603223413229, -0.004783424083143473, 0.009794166311621666, 0.020913273096084595, -0.007384593598544598, -0.0016983916284516454, 0.02712230756878853, 0.019744208082556725, -0.014002799987792969, 0.015522584319114685, -0.010859314352273941, 0.008280877023935318, -0.006413620430976152, -0.008112011477351189, 0.02761591225862503, -0.016016189008951187, 0.03660472109913826, 0.012086832895874977, -0.0029924814589321613, -0.009768187068402767, -0.043307360261678696, 0.03470823913812637, 0.03460432216525078, 0.007533974014222622, -0.005475121084600687, 0.023589132353663445, 0.032603923231363297, 0.007644386030733585, 0.008469225838780403, 0.004478168208152056, 0.038968831300735474, -0.0015676836483180523, -0.011177560314536095, -0.01784772425889969, -0.02665468119084835, 0.021614711731672287, 0.0010537821799516678, 0.026914473623037338, 0.00023868409334681928, -0.0165487639605999, 0.06037570908665657, 0.03826739266514778, 0.003974820952862501, 0.0038773987907916307, 0.014210633933544159, 0.005566047970205545, -0.012028379365801811, 0.019653281196951866, 0.01514588575810194, 0.007410572841763496, -0.02557654306292534, -0.01306105311959982, 0.018159475177526474, 0.009527879767119884, 0.01880895532667637, 0.0004936052137054503, -0.00633893022313714, 0.03450040519237518, -0.012651881203055382, -0.008345824666321278, 0.016224022954702377, -0.014132696203887463, 0.02616107650101185, 0.0033578143920749426, -0.037539973855018616, -0.015392689034342766, 0.015158875845372677, 0.015769386664032936, 0.02774580754339695, 0.004650280810892582, 0.013626101426780224, 0.03078537806868553, 0.03611111640930176, -0.03450040519237518, -0.0049847629852592945, -0.00468924967572093, -0.020406678318977356, -0.015093927271664143, 0.010560553520917892, -0.0035948746372014284, 0.0035981221590191126, 0.015249802730977535, -0.014795166440308094, 0.01508093811571598, 0.01324290782213211, 0.013807956129312515, -0.002601169515401125, -0.010274781845510006, 0.019900083541870117, -0.009333034977316856, -0.007202738896012306, -0.016951441764831543, 0.026940451934933662, -0.00846273172646761, 0.01830236054956913, -0.011599722318351269, 0.023576144129037857, -0.009488910436630249, -0.037669871002435684, -0.0035624008160084486, -0.001777953002601862, 0.013768987730145454, 0.0351758673787117, 0.04876299947500229, 0.00377672933973372, 0.03392886370420456, -0.0189258623868227, -0.014522384852170944, -0.012457036413252354, 0.022861715406179428, 0.006683154497295618, -0.060687460005283356, 0.007852219976484776, -0.025134896859526634, 0.005280276760458946, -0.006871504243463278, 0.0485551655292511, 0.03291567414999008, 0.006556505803018808, -0.025004999712109566, -0.008053558878600597, 0.010287771932780743, -0.025628501549363136, 0.01637989841401577, -0.024706238880753517, 0.00022204115521162748, -0.021900484338402748, -0.03182454779744148, -0.028187455609440804, 0.013730018399655819, -0.030187854543328285, 0.005630996078252792, 0.012749303132295609, 0.020406678318977356, -0.006923462264239788, -0.020952241495251656, 0.011469826102256775, 0.02946043759584427, 0.04185252636671066, -0.007839229889214039, -0.0017422315431758761, 0.014769187197089195, 0.002610911848023534, -0.021575743332505226, -0.02109512686729431, -0.004075490403920412, 0.024602321907877922, 0.03969625011086464, 0.029590332880616188, 0.009436951950192451, -0.0005707310047000647, -0.03242206946015358, 0.015769386664032936, 0.000122589452075772, 0.013366308994591236, -0.0178347360342741, -0.005676459986716509, 0.01996503211557865, -0.0335911326110363, -0.03483813628554344, -0.010203339159488678, 0.005971973296254873, 0.015158875845372677, 0.023926863446831703, 0.002805755939334631, 0.014769187197089195, 0.027693849056959152, -0.012411572970449924, 0.0009238860802724957, 0.018562152981758118, -0.005212081130594015, 0.011697144247591496, 0.013379299081861973, 0.018068548291921616, 0.021199043840169907, -0.012476520612835884, -0.024420468136668205, 0.046736620366573334, -0.022861715406179428, 0.026602722704410553, 0.02201738953590393, -0.03909872844815254, 0.029226623475551605, -0.003851419547572732, 0.008475720882415771, -0.010294266045093536, 0.01445743627846241, 0.007969126105308533, 0.023589132353663445, -0.018860913813114166, 0.011560753919184208, 8.828876161715016e-05, 0.0002754203451331705, 0.009488910436630249, 0.012340130284428596, 0.034370508044958115, 0.016990410163998604, -0.01800359971821308, -0.01483413577079773, 0.006040168926119804, -0.026836534962058067, -0.021341931074857712, -0.001572554698213935, 0.016405878588557243, -0.018406277522444725, 0.007027379237115383, -0.03242206946015358, 0.014990010298788548, 0.044060759246349335, 0.03790368512272835, 0.006254497449845076, -0.016990410163998604, -0.0063194455578923225, -0.002334882505238056, 0.01841926760971546, -0.016652680933475494, -0.0035526584833860397, -0.012885693460702896, -0.012457036413252354, -0.028810955584049225, 0.016094127669930458, 0.019900083541870117, 0.02310851775109768, -0.011898483149707317, -0.02188749425113201, -0.009268087334930897, 0.001341177267022431, 0.034032780677080154, -0.015899283811450005, 0.031071148812770844, -0.0029973527416586876, -0.001675659790635109, 0.011067148298025131, 0.007800261024385691, -0.02761591225862503, -0.014730218797922134, -0.0010821969481185079, -0.0013671565102413297, 0.010092927142977715, -0.03779976814985275, 0.042216233909130096, 0.01248951070010662, 0.016951441764831543, -0.015379698947072029, -0.0038286878261715174, 0.00201663700863719, -0.011872503906488419]",Online Speculative Decoding.pdf
" the token that maximizes the probability distribution
ùëÉ(¬∑|ùë•1,...,ùë•ùëõ,ùë¶ùëõ+1,...,ùë¶ùëõ+ùëñ‚àí1)and accept the first ùëöto-
kensùë¶1,...,ùë¶ùëöthat satisfy the condition. Note that for the
positionùëö+1, we can directly sample ùë¶ùëö+1from the dis-
tributionùëÉ(¬∑|ùë•1,...,ùë•ùëõ,ùë¶ùëõ+1,...,ùë¶ùëõ+ùëö‚àí1).Finally, we will
takeùëö+1tokensùë¶1,...,ùë¶ùëö+1as LLM outputs for this step.
Speculative decoding has two core properties: (1) Specu-
lative decoding does not change the behavior of the LLM
sampling process, and thus generates exactly the same out-
put as vanilla decoding algorithms without any accuracy loss.(2) The efficiency and the effective speedup of speculative
decoding algorithms depend on two factors: the accuracy of
the draft model matching the outputs of the target model
and the efficiency of the draft model.
Many previous work focuses on improving the accuracy
and efficiency of speculative decoding and can be categorized
into two parts: (1) Draft LLM-based speculative decoding,
which uses a small LLM as a draft model to propose candidate
tokens [ 6,24,26,40,46]. (2) Draft-model free speculative
decoding, which uses either a branch of the target model or
uses other sources (e.g., from a external database) to generate
the candidate tokens [ 4,10,21,22,33]. In this work, we study
the behavior of both types of speculative decoding method.
2.2 Continuous Batching
Due to the sequential dependency, when generating output
for a single output, LLMs severely under-utilize the GPUs. To
increase the GPU utilization, one can batch multiple requests
in one step and process them in parallel. However, batching
the requests to an LLM is non-trivial: First, the requests may
arrive at different times. A naive batching strategy would
either make earlier requests wait for later ones or delay
the incoming requests until earlier ones finish, leading to
significant queueing delays. Second, the requests may have
vastly different input and output lengths. A straightforward
batching technique would pad the inputs and outputs of the
requests to equalize their lengths, wasting GPU computation
and memory.
Continuous batching [ 11,41] is proposed to address this
problem. Instead of batching at the request level, continuous
batching batches at the step level. For each step, completed
requests from previous step are removed from the batch, and
newly received requests are added. Therefore, a new request
can immediately start to be processed after it is received. This
leads to a larger batch size at every step, which improves
GPU utilization and thus the serving throughput. Moreover,
with special GPU kernels, continuous batching can eliminate
the need to pad requests of different lengths, which further
improves the serving throughput. The technique has been
3
integrated in all popular LLM inference engines, such as
vLLM [19] and TensorRT-LLM [29].
3Speculative Decoding with Continuous Batch-
ing
Speculative decoding changes continuous batching by allow-
ing each generation step to produce multiple rather than a
single token per request. It utilizes a draft model to suggest a
range of possible tokens for a request at each generation step.
These proposed tokens for all requests are then collectively
processed in a batch by the target model for verification.
Figure 4 illustrates the three phases of speculative decod-
ing: proposal, scoring, and acceptance. In proposal, the draft
model examines the request pool and generates tokens in
an autoregressive manner. During scoring, all the proposed
tokens are evaluated collectively in a single forward pass.
After accepting the tokens with rejection sampling, each
request can yield multiple tokens in a single pass. The gen-
erated tokens comprise those proposed by the draft model
and subsequently accepted by the target model, plus a bonus
token. This bonus token either corrects a prediction made
by the draft model or is generated by the target model when
it accepts all proposed tokens.
3.1 Vanilla Speculative Decoding Latency
To understand the performance implication of vanilla spec-
ulative decoding in the context of continuous batching, we
conduct an analysis shown in Fig. 1, showcasing the speedup
achieved under varying request rates. In this analysis,","[0.02734760195016861, 0.014752964489161968, 0.025044506415724754, -0.012120856903493404, -0.027426565065979958, -0.006303898524492979, 0.01833263225853443, 0.019938217476010323, 0.019345993176102638, 0.007929225452244282, 0.0326644591987133, 0.02051728032529354, -0.0680663138628006, -0.008343782275915146, 0.019385475665330887, -0.019688166677951813, -0.016279587522149086, 0.009324242360889912, -0.012982872314751148, 0.023583685979247093, 0.011541793122887611, 0.007870002649724483, 0.009501909837126732, 0.017858851701021194, 0.014687161892652512, -0.0315326526761055, 0.004658830817788839, 0.029163755476474762, 0.026979105547070503, -0.04182419553399086, 0.004849658813327551, -0.013910690322518349, -0.030558772385120392, -0.037270646542310715, 0.003224332118406892, 0.04429837688803673, 0.007488347124308348, 0.004994424991309643, -0.0024248294066637754, -0.015503115952014923, 0.002490632003173232, -0.053142257034778595, -0.06148603931069374, 0.009521650150418282, 0.01647699624300003, 0.06611855328083038, 0.01909594237804413, -0.018924856558442116, -0.0005877003422938287, 0.056432392448186874, -0.034401651471853256, 0.015371509827673435, -0.013226342387497425, 0.02499186433851719, 0.010995631106197834, -0.02126743271946907, -0.015674201771616936, 0.027373922988772392, 0.04682520031929016, -0.011640497483313084, 0.02280721440911293, -0.05087864771485329, 0.0038461675867438316, -0.016398033127188683, -0.026623772457242012, -0.004369298927485943, -0.015582079067826271, 0.053458113223314285, -0.022794054821133614, 0.024833938106894493, -0.026979105547070503, -0.021570123732089996, 0.01976712979376316, -0.01966184563934803, -0.03571770340204239, 0.019214387983083725, 0.04519329220056534, 0.0402449294924736, -0.014239704236388206, -0.0008537900284864008, 0.025465644896030426, 0.007797619793564081, 0.0033625178039073944, -0.03484910726547241, 0.003081211354583502, -0.05748523771762848, 0.001117823296226561, 0.022333435714244843, -0.033796265721321106, -0.03255917504429817, -0.009672996588051319, 0.01279862504452467, -0.04632509872317314, 0.028163554146885872, 0.006698714569211006, 0.043061286211013794, 0.014055456034839153, -0.0504838302731514, 0.060538481920957565, 0.028163554146885872, 0.01242354977875948, -0.010785061866044998, 0.027163352817296982, -0.03663894161581993, 0.06364437192678452, -0.034480612725019455, -0.06406550854444504, 0.07585734874010086, -0.022833535447716713, -0.025781497359275818, -0.04950994998216629, -0.017042899504303932, -0.04750954732298851, 0.0015019465936347842, 0.010502110235393047, -0.035691384226083755, -0.055642761290073395, -0.002123782178387046, 0.00700798723846674, 0.004560126923024654, -0.020359354093670845, -0.0006271819584071636, 0.040560781955718994, -0.004484453704208136, -0.049457307904958725, 0.00856093131005764, 0.050457507371902466, -0.10549488663673401, 0.03745489567518234, 0.010008590295910835, -0.005428722593933344, 0.007481766864657402, 0.02216234803199768, -0.029111113399267197, -0.02634740062057972, -0.02599206566810608, -0.03732328861951828, -0.012739402242004871, -0.03313823789358139, 0.015897931531071663, 0.003964612726122141, -0.028821581974625587, -0.011179878376424313, 0.0003847401530947536, -0.03605987876653671, 0.018714286386966705, -0.009218958206474781, -0.010199418291449547, -0.014489754103124142, 0.02180701494216919, -0.039060480892658234, -0.027005426585674286, -0.025334037840366364, 0.005060227587819099, -0.008251658640801907, -0.021793853491544724, -0.06159132346510887, 0.04400884360074997, 0.031190479174256325, 0.005050356965512037, -0.008199016563594341, 0.059432998299598694, 0.0516156367957592, 0.005652451887726784, -0.004033705219626427, 0.02853205054998398, -0.04295600205659866, 0.02005666308104992, -0.05132610350847244, -0.022333435714244843, 0.00950848963111639, -0.011377286165952682, -0.008258238434791565, -0.0429823212325573, -0.005099709145724773, -0.0182273481041193, -0.02259664610028267, -0.08417481184005737, 0.05622182413935661, -0.06138075515627861, -0.04171891137957573, 0.041482020169496536, -0.023083586245775223, -0.01426602527499199, -0.009791441261768341, -0.027189673855900764, -0.013884369283914566, 0.015292546711862087, -0.003954742103815079, 0.03353305533528328, -0.014226543717086315, 0.048851922154426575, 0.07680490612983704, -0.000411266868468374, 0.008462226949632168, -0.01791149377822876, 0.04829917848110199, 0.055853329598903656, 0.033190879970788956, -0.03211171552538872, 0.029558571055531502, 0.04103456065058708, 0.011074594222009182, -0.031585294753313065, 0.04074503108859062, 0.05522162467241287, 0.0033987092319875956, -0.003941581584513187, -0.0020217879209667444, -0.01566104218363762, -9.726461576065049e-05, 0.010350764729082584, 0.03634941205382347, -0.014647680334746838, -0.046667274087667465, 0.001592425280250609, -0.03350673243403435, 0.013285564258694649, 0.0028953186701983213, 0.04098191857337952, 0.022320274263620377, 0.011910288594663143, -0.016345391049981117, 0.035875629633665085, -0.032690782099962234, 0.055432192981243134, 0.008350362069904804, -0.019030140712857246, 0.025478804484009743, -0.009804601781070232, 0.00310588744468987, -0.026228955015540123, -0.00631705904379487, -0.03413844108581543, 0.008606992661952972, -0.02005666308104992, 0.00010960261715808883, -0.02924271859228611, -0.0026633641682565212, -0.09738799184560776, 0.008350362069904804, -0.0035105738788843155, 0.005892631597816944, -0.018201027065515518, -0.04171891137957573, 0.01172604039311409, -0.03611252084374428, -0.03232228383421898, 0.011522052809596062, 0.04011332616209984, -0.01556891854852438, -0.04353506490588188, -0.04777275770902634, -0.007593631278723478, -0.05108921602368355, 0.03253285214304924, -0.031795863062143326, -0.006159132346510887, -0.0339541919529438, 0.009074191562831402, 0.018924856558442116, -0.037270646542310715, -0.016740206629037857, 0.03311191871762276, -0.0201224647462368, -0.007567310240119696, -0.021135825663805008, -1.3430433227767935e-06, 0.0404028557240963, -0.016713885590434074, -0.015740005299448967, -0.011482570320367813, -0.031980112195014954, 0.028268838301301003, -0.01402913499623537, -0.04958891123533249, 0.0416136272251606, 0.0006839368143118918, -0.03284870833158493, 0.010824543423950672, 0.022820375859737396, -0.018609002232551575, 0.047562189400196075, 0.006165712606161833, 0.0008768209372647107, 0.014621359296143055, 0.009179476648569107, -0.03234860673546791, -0.02041199617087841, -0.005274086259305477, 0.016187462955713272, -0.011548373848199844, 0.030242919921875, -0.0478253997862339, 0.04124513268470764, 0.03995539993047714, 0.019530240446329117, 0.010581073351204395, -0.007587051019072533, -0.005659032147377729, 0.03474382311105728, 0.022938819602131844, 0.010732419788837433, -0.01730610989034176, -0.009034710004925728, 0.002535048872232437, -0.017345590516924858, -0.01060081459581852, -0.001732256030663848, -0.006224935408681631, 0.015003015287220478, 0.018424754962325096, -0.019293351098895073, 0.009949367493391037, -0.021241111680865288, -0.04503536596894264, 0.048562392592430115, -0.06622383743524551, -0.006307188421487808, -0.02226763218641281, 0.002806485164910555, 0.0031124677043408155, -0.017345590516924858, 0.002645268337801099, 0.029716499149799347, -0.03345409035682678, -0.001464932574890554, -0.020938418805599213, -0.005547167267650366, -0.02599206566810608, 0.009771700948476791, 0.027610812336206436, 0.02087261527776718, 0.010666617192327976, -0.03113783709704876, -0.04279807582497597, -0.014094937592744827, -0.0036421793047338724, 0.04224533215165138, 0.015529436990618706, -0.08391159772872925, 0.042561184614896774, 0.0077120759524405, -0.02101738192141056, -0.0017158053815364838, 0.017569320276379585, 0.02803194895386696, 0.02784770168364048, 0.06374965608119965, 0.0005634356057271361, -0.03363833948969841, -0.026571128517389297, 0.04332449659705162, -0.023136228322982788, 0.021214790642261505, -0.0018737318459898233, 0.019543401896953583, -0.048167575150728226, -0.03350673243403435, 0.004250854253768921, -0.019569722935557365, 0.04682520031929016, 0.02259664610028267, 0.0017536418745294213, -0.015292546711862087, -0.0078107803128659725, -0.03795499727129936, -0.011074594222009182, 0.013779085129499435, -0.012147177942097187, 0.03216435760259628, 0.07727868854999542, -0.028400443494319916, 0.023715293034911156, -0.025005025789141655, -0.017687765881419182, 0.00848854798823595, 0.03374362364411354, 0.00673819612711668, 0.016213783994317055, 0.009469008073210716, -0.026531647890806198, -0.00021509257203433663, -0.01716134324669838, 0.0391131229698658, 0.03995539993047714, -0.01088376622647047, -0.03474382311105728, -0.033190879970788956, -0.012022152543067932, -0.02774241752922535, -0.015608400106430054, 0.004846368916332722, 0.0012305104173719883, -0.0026567839086055756, 0.03477014601230621, -0.02466285042464733, 0.05416877940297127, 0.05022061988711357, 0.018569521605968475, 0.0007719479035586119, -0.015187262557446957, -0.023860057815909386, -0.027663454413414, 0.00025704180006869137, 0.03929737210273743, 0.03211171552538872, 0.040087003260850906, 0.04793068394064903, 0.01033102348446846, 0.04092927649617195, -0.03850773721933365, 0.026689574122428894, -0.06474985182285309, 0.024294355884194374, -0.010008590295910835, 0.03195378929376602, 0.007962126284837723, 0.038586702197790146, 0.08106892555952072, 0.008508289232850075, -0.026979105547070503, -0.0258472990244627, -0.00044540202361531556, -0.030927268788218498, -0.02351788431406021, 0.020885776728391647, 0.002442925237119198, 0.03742857277393341, -0.04621981456875801, -0.041876837611198425, 0.015055657364428043, 0.03924473002552986, -0.031611617654561996, -0.014187061227858067, 0.000674477661959827, 0.008508289232850075, -0.00868595577776432, -0.006399312522262335, -0.05227366462349892, -0.008975488133728504, 0.005652451887726784, -0.029216397553682327, 0.010785061866044998, -0.04758851230144501, 0.03453325480222702, -0.033769942820072174, -0.04361402988433838, 0.007567310240119696, 0.011133816093206406, 0.023215191438794136, -0.023754773661494255, 0.047667473554611206, 0.0009105448261834681, -0.03192747011780739, -0.05848543718457222, 0.0933871865272522, -0.034270044416189194, 0.01991189643740654, 0.002207680605351925, 0.010581073351204395, -0.01597689464688301, -0.059538282454013824, -0.034875430166721344, -0.006655943114310503, -0.020175106823444366, 0.016779687255620956, 0.014081777073442936, 0.02638688124716282, 0.04998372867703438, 0.03445429354906082, -0.019043300300836563, -0.0055241365917027, 0.013272403739392757, -0.016213783994317055, 0.010837703943252563, 0.05422142148017883, -0.013035514391958714, 0.027426565065979958, -0.008199016563594341, 0.004227823112159967, 0.005820248741656542, 0.031611617654561996, 0.01262095756828785, 0.043456099927425385, 0.08817561715841293, 0.010857445187866688, 0.020425157621502876, -0.034085799008607864, -0.04629877954721451, -0.004586447961628437, -0.04424573481082916, 0.013410589657723904, -0.014542396180331707, 0.001880312105640769, -0.026926463469862938, -0.019714487716555595, 0.0163717120885849, 0.007889743894338608, 0.015990056097507477, 0.00751466816291213, 0.002235646592453122, 0.011739200912415981, 0.00012286596756894141, 0.02170172892510891, 0.01647699624300003, 0.02588678151369095, 0.010173097252845764, -0.020188268274068832, -0.004158730618655682, -0.023333637043833733, 0.011449669487774372, -0.020754171535372734, 0.01344349142163992, -0.03242756798863411, 0.010758740827441216, -0.0429033599793911, 0.004872689954936504, -0.019990859553217888, -0.013074995949864388, 0.020688368007540703, -0.014331827871501446, -0.011318064294755459, 0.010179677046835423, 0.013739603571593761, 0.00589921185746789, -0.026031548157334328, -0.12381435930728912, -0.02145167998969555, -0.02530771680176258, -0.0032161069102585316, -0.02251768298447132, -0.01310131698846817, 0.03840245306491852, -0.02145167998969555, -0.009080772288143635, -0.025860460475087166, -0.02051728032529354, -0.049457307904958725, -0.02774241752922535, 0.0019345993641763926, 0.014042295515537262, 0.029821783304214478, 0.022833535447716713, -0.013871208764612675, -0.025360358878970146, 0.010804803110659122, -0.016213783994317055, -0.014358148910105228, 0.024004824459552765, 0.023636329919099808, -0.014160740189254284, 0.01741139404475689, -0.0151214599609375, -0.028084591031074524, 0.013147379271686077, -0.014437112025916576, -0.010054652579128742, -0.022320274263620377, -0.021899137645959854, 0.01772724650800228, -0.007225136272609234, -0.03113783709704876, -0.021464839577674866, -0.00696192542091012, 0.0027883893344551325, 0.020398836582899094, -0.03192747011780739, 0.036402054131031036, 0.01179842371493578, -0.03461221978068352, -0.020254069939255714, 0.03590195253491402, -0.03534920886158943, -0.008021349087357521, -0.023030944168567657, 0.018345791846513748, -0.00911367405205965, 0.031190479174256325, 0.015924252569675446, -0.023294154554605484, -0.040376536548137665, -0.027215994894504547, -0.017385073006153107, -0.030848303809762, 0.03042716719210148, 0.0025301137939095497, 4.788688602275215e-05, -0.027768738567829132, -0.025649892166256905, 0.020227748900651932, -0.019596043974161148, -0.015621560625731945, 0.0007382240146398544, -0.03655998036265373, -0.010982470586895943, 0.024504924193024635, -0.01401597447693348, -0.038981519639492035, -0.0031239830423146486, 0.020859455689787865, 0.0007830521208234131, -0.020741010084748268, 0.003941581584513187, -0.019780291244387627, 0.007534408941864967, -0.04242958128452301, 0.014318667352199554, 0.029769141227006912, -0.017148183658719063, 0.019543401896953583, 0.02295198105275631, 0.004063316620886326, -0.017793050035834312, -0.04440366104245186, 0.005468204151839018, -0.04664095118641853, -0.014542396180331707, 0.04000804200768471, 0.002020142739638686, 0.03082198277115822, -0.0055340067483484745, 0.00345793180167675, 0.006471695378422737, 0.031295761466026306, -0.010923247784376144, -0.022530844435095787, -0.012864427641034126, 0.015108299441635609, 0.009784861467778683, -0.020293552428483963, -0.035375531762838364, 0.005099709145724773, 0.023649489507079124, -0.002839386463165283, 0.006922443863004446, 0.0023244803305715322, -0.019780291244387627, 0.00831088051199913, 0.020109305158257484, 0.012134017422795296, 0.032875027507543564, -0.001189383794553578, -0.026400042697787285, 0.0073304204270243645, -0.01816154457628727, 0.0027916794642806053, 0.006432213820517063, 0.009995429776608944, -0.0052477652207016945, -0.04819389432668686, -0.02545248344540596, 0.058643363416194916, -0.006514467298984528, 0.029163755476474762, -0.009574292227625847, 0.019280189648270607, -0.047167371958494186, 0.052142057567834854, 0.009903306141495705, -0.01217349898070097, -0.02745288610458374, -0.029190076515078545, 0.00401396444067359, 0.005425432231277227, 0.042666468769311905, 0.024004824459552765, 0.010791642591357231, -0.00507667800411582, -0.013015774078667164, -0.07359373569488525, 0.016200624406337738, 0.011107495054602623, -0.031006231904029846, -0.007264617830514908, 0.010383665561676025, -0.03500703349709511, -0.05416877940297127, 0.005063517484813929, 0.025320878252387047, -0.03634941205382347, 0.007527828682214022, -0.03713904321193695, -0.0379023551940918, 0.0073896427638828754, -0.0032226871699094772, 0.039771150797605515, 0.004586447961628437, 0.019675007089972496, 0.02291249856352806, -0.012555154971778393, 0.0015356704825535417, 0.02205706387758255, -0.0441930927336216, 0.004803596995770931, 0.010712679475545883, -0.008705697022378445, 0.007942385971546173, -0.032875027507543564, -0.00856093131005764, -0.026373721659183502, 0.03700743615627289, -0.0030828563030809164, -0.029558571055531502, 0.0016590504674240947, -0.013752764090895653, 0.00525434548035264, 0.01683232933282852, 0.025320878252387047, -0.00997568853199482, 0.009179476648569107, 0.008699116297066212, -0.004444972146302462, -0.016990257427096367, -0.03324352204799652, 0.018924856558442116, -0.0151214599609375, -0.01947759836912155, -0.01117329765111208, -0.042376939207315445, -0.07027728110551834, -0.015845289453864098, -0.029611213132739067, -0.02162276580929756, 0.015595239587128162, 0.002076075179502368, 0.0018095741979777813, 0.008784660138189793, -0.020280390977859497, 0.03434900939464569, 0.018201027065515518, 0.012686760164797306, 0.03461221978068352, -0.046877842396497726, -0.02449176460504532, 0.006823739968240261, -0.015529436990618706, 0.009107093326747417, -2.6372486900072545e-05, -0.009732219390571117, 0.02734760195016861, -0.029005829244852066, -0.05111553519964218, 0.0351649634540081, 0.04103456065058708, -0.006037397310137749, 0.014700322411954403, 0.03192747011780739, -0.0072711980901658535, -0.014423951506614685, -0.03500703349709511, 0.011403607204556465, -0.014160740189254284, -9.124983625952154e-05, 0.04069238901138306, -0.015621560625731945, 0.04772011563181877, 0.005655741784721613, -0.012956551276147366, -0.0326644591987133, -0.01208137534558773, 0.008199016563594341, -0.008712276816368103, 0.014305506832897663, 0.010324443690478802, -0.02945328690111637, -0.029716499149799347, 0.0005617905408143997, 0.021675407886505127, 0.003918550442904234, 0.007244877051562071, -0.017424553632736206, 0.01597689464688301, 0.010192837566137314, 0.04185051470994949, -0.004372589290142059, -0.01576632633805275, 0.025123469531536102, 0.007113271858543158, 0.033796265721321106, -0.02913743443787098, -0.02884790301322937, 0.0009697672794573009, 0.0009113673586398363, -0.03424372524023056, 0.031111516058444977, -0.026176312938332558, 0.031506333500146866, -0.006757936906069517, -0.03721800446510315, -0.018358953297138214, -0.003421740373596549, -0.012028733268380165, -0.00071478181052953, -0.013976492919027805, 0.014331827871501446, 0.01772724650800228, -0.1271834522485733, -0.00713959289714694, 0.017240306362509727, -0.008179275318980217, 0.008962327614426613, -0.012759143486618996, 0.03253285214304924, 0.005622840486466885, 0.018674805760383606, -0.018924856558442116, -0.006277577485889196, -0.01605585776269436, 0.0042574345134198666, -0.028084591031074524, -0.010745580308139324, -0.026623772457242012, -0.01531886775046587, -0.02520243264734745, -0.005761026404798031, -0.013989653438329697, -0.012344585731625557, -0.012338005937635899, -0.03045348823070526, -0.007527828682214022, 0.009357143193483353, -0.012581476010382175, -0.028926866129040718, 0.007521248422563076, 0.011574694886803627, 3.5548880987334996e-05, 0.01912226341664791, 0.008718857541680336, -0.01633222959935665, 0.020583083853125572, -0.037086401134729385, -0.0049746837466955185, -0.01372644305229187, -0.02680801972746849, 0.018780089914798737, 0.03929737210273743, 0.018714286386966705, -0.030400846153497696, 0.023175710812211037, 0.019569722935557365, 0.021280592307448387, -0.02066204696893692, 0.0010117164347320795, -0.014384469948709011, -0.025860460475087166, -0.021438518539071083, -0.013147379271686077, -0.01363431941717863, 0.014358148910105228, 0.005116159562021494, -0.014410790987312794, 0.03095358982682228, 0.005231314338743687, 0.007929225452244282, -0.0033115206751972437, 0.029927067458629608, -0.00041476261685602367, 0.0182668287307024, 0.00345793180167675, -0.01033102348446846, -0.02384689822793007, -0.03513864055275917, 0.0020859455689787865, 0.01984609290957451, -0.019030140712857246, -0.039876434952020645, 0.009186056442558765, 0.009705898351967335, 0.018069420009851456, 0.0404028557240963, -0.0026633641682565212, 0.015818968415260315, -0.009396625682711601, 0.038481418043375015, -0.04590396210551262, 0.0008472097106277943, 0.03863934427499771, -0.025544608011841774, -0.0284267645329237, 6.985110758250812e-06, 0.03003235161304474, -0.010383665561676025, 0.043456099927425385, -0.0007082015508785844, -0.042376939207315445, 0.051457710564136505, 0.021359555423259735, -0.02224131114780903, -0.006596720311790705, -0.011074594222009182, -0.020780492573976517, -0.03590195253491402, -0.026044707745313644, 0.012686760164797306, 0.005895921494811773, -0.004418651107698679, 0.04432469606399536, 0.03666526451706886, -0.00718565471470356, -0.05369500070810318, 0.016424354165792465, -0.00948874931782484, -0.004484453704208136, -0.025294557213783264, 0.02195177972316742, 0.004823337774723768, 0.01876693032681942, -0.003935001324862242, -0.0010849219979718328, 0.0326644591987133, 0.004290335811674595, 0.01722714677453041, 0.01666124351322651, 0.012792044319212437, 0.032980311661958694, -0.018043098971247673, 0.01501617580652237, 0.03334880620241165, -0.04629877954721451, 0.02966385707259178, -0.04624613747000694, 0.012166919186711311, 0.01812206208705902, 0.0364546962082386, 0.0015307352878153324, -0.006017656531184912, -0.034480612725019455, 0.02159644477069378, 0.0040106745436787605, -0.01991189643740654, 0.0009829277405515313, -0.007146173156797886, -0.006544078234583139, 0.031006231904029846, -0.030506130307912827, 0.02149116061627865, 0.023320475593209267, 0.0073106796480715275, 0.03195378929376602, 0.00911367405205965, -0.013239502906799316, -0.00019812780374195427, 0.006142681930214167, 0.0014632875099778175, -0.021175308153033257, 0.008304300718009472, 0.04006068408489227, -0.00441536121070385, -0.006007786374539137, -0.01987241394817829, 0.011114075779914856, -9.448856144445017e-05, -0.023636329919099808, -0.045772355049848557, 0.028900545090436935, 0.02755817025899887, 0.0491940975189209, 0.032295964658260345, -0.011791842989623547, -0.014134419150650501, 0.005603099707514048, -0.03003235161304474, -0.019188066944479942, -0.00654078833758831, -0.04772011563181877, 0.00487927021458745, -0.022280793637037277, -0.03816556558012962, 0.02374161407351494, 0.032401248812675476, 0.03255917504429817, 0.01941179670393467, -0.0005350582068786025, 0.03455957770347595, 0.02430751733481884, 0.03471750393509865, 0.018424754962325096, 0.004247564356774092, 0.007323840167373419, 0.009153155609965324, 0.003461221931502223, -0.008725437335669994, -0.003477672580629587, 0.038586702197790146, 0.004132409580051899, 0.013048674911260605, 0.0016384872142225504, 0.030374525114893913, -0.006254546344280243, 0.015371509827673435, -0.02251768298447132, -0.013088156469166279, 0.01601637713611126, 0.01941179670393467, -0.016042698174715042, -0.001959275221452117, -0.042587507516145706, 0.043850917369127274, -0.008528029546141624, 0.015555758029222488, -0.0024725364055484533, -0.009054451249539852, 0.012160338461399078, 0.03353305533528328, -0.00561297032982111, 0.012561734765768051, -0.023386279121041298, -0.00336087285540998, -0.04108720272779465, 0.054431989789009094, -0.006606590934097767, -0.02974282018840313, 0.02745288610458374, 0.009942787699401379, -0.05103657394647598, 0.01891169510781765, -0.0389551967382431, -0.026334239169955254, -0.002204390475526452, -0.0032588785979896784, -0.01876693032681942, -0.02051728032529354, 0.01830631121993065, 0.014752964489161968, -0.03961322456598282, 0.008725437335669994, 0.014739803969860077, 0.03313823789358139, 0.005280666518956423, -0.01299603283405304, -0.03295399248600006, -0.01984609290957451, -0.006432213820517063, -0.002454440575093031, -0.019385475665330887, 0.019359152764081955, 0.005968304816633463, -0.008613573387265205, -0.024583887308835983, -0.025360358878970146, 0.004872689954936504, -0.030927268788218498, -0.0013621158432215452, 0.02995338849723339, -0.02151748165488243, 0.0043166568502783775, 0.0012189949629828334, 0.02784770168364048, 0.0201224647462368, -0.013765924610197544, 0.009232118725776672, 0.011831325478851795, 0.014910891652107239, 0.039192087948322296, 0.03674422577023506, 0.031216800212860107, -0.025439323857426643, 0.005198413040488958, 0.011837905272841454, -0.012449870817363262, -0.005695223342627287, -0.03963954374194145, -0.0030647607054561377, 0.0060735889710485935, 0.0018095741979777813, -0.022794054821133614, -0.013594836927950382, 0.008903104811906815, -0.006817159708589315, 0.03416476026177406, -0.0007752380333840847, -0.01070609875023365, 0.024110108613967896, -0.030979910865426064, 0.011739200912415981, 0.013871208764612675, -0.009324242360889912, -0.010929828509688377, -0.0440351665019989, -0.031980112195014954, 0.013048674911260605, -0.030927268788218498, -0.017714086920022964, 0.006024236790835857, 0.02942696586251259, -0.015897931531071663, 0.045351218432188034, 0.031453687697649, 0.012048473581671715, 0.013127638027071953, -0.02387321926653385, -0.024189071729779243, 0.01755616068840027, 0.012877588160336018, -0.010041492059826851, -0.030558772385120392, 0.030321883037686348, 0.0227019302546978, 0.021333234384655952, -0.02501818537712097, 0.026018386706709862, 0.029190076515078545, 0.019043300300836563, -0.0073304204270243645, -0.03453325480222702, -0.02349156327545643, -0.0077120759524405, 0.03574402630329132, 0.010765321552753448, 0.023438921198248863, 0.03763914480805397, 0.002706135855987668, 0.012667018920183182, -0.0024264745879918337, 0.022254472598433495, -0.0044614230282604694, 0.0009401560528203845, -0.01593741402029991, -0.019543401896953583, -0.01426602527499199, 0.006777677685022354, -0.018714286386966705, 0.0119760911911726, -0.025189273059368134, -0.007455445826053619, 0.00733700068667531, 0.028584692627191544, 0.009166316129267216, 0.0007308212225325406, -0.014516075141727924, -0.006715165451169014, -0.012680179439485073, -0.004023835062980652, -0.010021750815212727, 0.006830320227891207, -0.011811584234237671, 0.015963735058903694, 0.0016894842265173793, 0.0008883363916538656, -0.007126432377845049, -0.004293626174330711, 0.0019461148185655475, 0.00778445927426219, -0.023728452622890472, 0.004497614223510027, -0.039481617510318756, 0.0780683234333992, -0.004773985594511032, -0.02824251726269722, -0.02330731600522995, -0.02624211646616459, -0.008778080344200134, -0.00026588403852656484, -0.013311886228621006, -0.047957006841897964, -0.011285162530839443, -0.0014048876473680139, 0.02845308743417263, 0.03182218596339226, 0.019398635253310204, 0.02734760195016861, -0.03187482804059982, -0.00507667800411582, 0.02691330388188362, 0.032980311661958694, 0.04229797422885895, 0.03324352204799652, 0.007198815234005451, -0.013594836927950382, -0.012219561263918877, -0.025465644896030426, 0.0034019993618130684, 0.012838106602430344, 0.000350193731719628, -0.0044022006914019585, 0.00718565471470356, 0.027531849220395088, -0.015647880733013153, -0.03455957770347595, 0.016240105032920837, 0.01263411808758974, -0.011193038895726204, 0.00461276900023222, 0.03990275412797928, -0.01808258146047592, 0.0047476645559072495, -0.009804601781070232, -6.909283547429368e-05, -0.00035636272514238954, 0.0029726368375122547, -0.0024495054967701435, 0.040876634418964386, 0.00018075178377330303, 0.0001830137480283156, 0.0035862470977008343, 0.006238095927983522, 0.04000804200768471, 0.004250854253768921, 0.048246536403894424, 0.0040896376594901085, 0.012107696384191513, -0.029769141227006912, 0.005659032147377729, 0.023478401824831963, 0.036086197942495346, 0.021043702960014343, -0.0627494528889656, 0.004507484845817089, -0.03834981098771095, -0.0007596099167130888, -0.0013061835197731853, -0.030216598883271217, 0.007119852118194103, 0.006669103633612394, -0.007777879014611244, 0.05590597167611122, 0.011410187929868698, 0.0024527956265956163, -0.014555556699633598, -0.0020020471420139074, 0.014397630468010902, 0.017240306362509727, -0.009251859039068222, 0.0009319307282567024, 0.028979508206248283, 0.030242919921875, -0.006488145794719458, 0.0027801638934761286, -0.014608198776841164, 0.008633313700556755, 0.008791240863502026, 0.031164158135652542, 0.03479646518826485, 0.00940320547670126, -0.0029759269673377275, 0.01492405217140913, -0.015753166750073433, 0.01670072413980961, 0.026623772457242012, -0.03842877596616745, 0.008409584872424603, -0.02187281660735607, -0.015463634394109249, -0.04450894519686699, -0.00940320547670126, -0.0053267283365130424, 0.0067908382043242455, -0.031901147216558456, -0.010916667990386486, 0.017398232594132423, -0.005978174973279238, 0.00904129073023796, -0.036402054131031036, -0.03205907344818115, 0.0110482731834054, 0.0015636365860700607, -0.0039909337647259235, -0.02305726520717144, -0.007179074455052614, -0.02430751733481884, -0.03163793683052063, 0.018279990181326866, -0.006869801785796881, 0.03521760553121567, -0.018714286386966705, -0.015845289453864098, 0.03063773550093174, 0.029716499149799347, 0.030611414462327957, 0.030479809269309044, -0.023320475593209267, -0.02866365574300289, -0.03713904321193695, 0.011397027410566807, 0.02287301793694496, -0.01870112679898739, -0.00538924103602767, -0.012949970550835133, -0.008205596357584, -0.0019016979495063424, -0.0039909337647259235, 0.024965543299913406, -0.0028673524502664804, -0.00534317921847105, -0.004800306633114815, 0.0033592276740819216, -0.0013349722139537334, 0.0059946258552372456, -0.017042899504303932, -0.004494324326515198, 0.01930651068687439, 0.024425961077213287, 0.004665411077439785, 0.003823136677965522, 0.04950994998216629, 0.020319873467087746, 0.0057412851601839066, 0.008067410439252853, -0.01363431941717863, 0.0021172016859054565, -0.012265622615814209, -0.0035072837490588427, 0.019530240446329117, -0.021688569337129593, 0.028716297820210457, 0.012206400744616985, 0.0030483100563287735, -0.016674403101205826, -0.03511232137680054, 0.03690215200185776, 0.022780893370509148, 0.004079767037183046, -0.011357545852661133, 0.009672996588051319, 0.03961322456598282, -0.004115958698093891, -0.005836699157953262, 0.012107696384191513, 0.03932369127869606, -0.00738306250423193, -0.027215994894504547, -0.023386279121041298, -0.017135022208094597, 0.02045147866010666, -0.01937231421470642, 0.03679686784744263, -0.003523734398186207, 0.007027728017419577, 0.049062490463256836, 0.043666671961545944, 0.003122338093817234, -0.010653456673026085, 0.006188743747770786, -0.0013604707783088088, -0.005665612407028675, 0.014502914622426033, 0.02370213158428669, -0.014858249574899673, -0.009172895923256874, -0.009409786202013493, 0.029927067458629608, 0.013871208764612675, 0.00452393526211381, 0.018464237451553345, -0.0015850224299356341, 0.040771350264549255, -0.006126231048256159, -0.016029536724090576, 0.0012338005471974611, 0.002773583633825183, 0.027426565065979958, 0.007777879014611244, -0.04074503108859062, -0.015582079067826271, 0.010159936733543873, 0.007587051019072533, 0.014173900708556175, -0.0013728088233619928, 0.020425157621502876, 0.020635725930333138, 0.0313747264444828, -0.02374161407351494, -0.006902703084051609, -0.009824343025684357, -0.019003819674253464, -0.022228151559829712, 0.0073699019849300385, 0.022583486512303352, 0.00811347272247076, 0.049562592059373856, -0.01726662740111351, 0.013331626541912556, 0.014937212690711021, 0.013976492919027805, -0.00044211186468601227, -0.002470891224220395, -0.010390246286988258, 0.004961523227393627, -0.009343982674181461, -0.002474181354045868, 0.023465242236852646, -0.011627336964011192, 0.013976492919027805, -0.02445228211581707, 0.006349960342049599, 0.01043630763888359, -0.02934800274670124, -0.0052082836627960205, 0.002280063461512327, 0.02316254936158657, 0.03126944229006767, 0.04808861017227173, 0.004339687991887331, 0.019253868609666824, -0.03821820765733719, -0.008251658640801907, -0.03334880620241165, 0.026650093495845795, 0.016490155830979347, -0.051247142255306244, 0.010554752312600613, -0.04753587022423744, -0.005116159562021494, -0.009903306141495705, 0.04071870818734169, 0.03721800446510315, 0.017464036121964455, -0.0019345993641763926, -0.005024035926908255, 0.01279862504452467, -0.011232520453631878, 0.023781094700098038, -0.021043702960014343, 0.008508289232850075, -0.021635927259922028, -0.0019510500133037567, -0.020793652161955833, 0.00802792888134718, -0.013114477507770061, -0.010567912831902504, 0.005951853934675455, 0.035401850938797, -0.005530716851353645, -0.040481820702552795, 0.019793450832366943, 0.019740808755159378, 0.0377444289624691, 0.004899010993540287, 0.001409822842106223, 0.010107294656336308, -0.010535011999309063, -0.029005829244852066, -0.02559725008904934, 0.000672421301715076, 0.009561131708323956, 0.007073789834976196, 0.024373319000005722, 0.022899338975548744, 0.03482278808951378, -0.045982927083969116, 0.0077120759524405, -0.006514467298984528, -0.0013563580578193069, -0.015884771943092346, -0.01945127733051777, 0.03863934427499771, -0.04587763920426369, -0.017253467813134193, -0.024399640038609505, 0.010462628677487373, 0.017898334190249443, 0.01976712979376316, -0.007047468796372414, 0.01984609290957451, 0.02605786919593811, -0.016674403101205826, 0.0013596481876447797, 0.006389441899955273, -0.003189785871654749, -0.00827797967940569, 0.016542797908186913, 0.005968304816633463, 0.0135685158893466, -0.03527024760842323, -0.012607797048985958, 0.032480210065841675, -0.00664936238899827, 0.021293753758072853, 0.001816154457628727, -0.024689171463251114, 0.009218958206474781, -0.017937814816832542, 0.019030140712857246, -0.017213985323905945, 0.015897931531071663, 0.010107294656336308, 0.02274141274392605, -0.025478804484009743, 0.013976492919027805, -4.207773963571526e-05, 0.011916868388652802, 0.03561241924762726, 0.020898936316370964, -0.005438592750579119, 0.03874462842941284, -0.027321280911564827, -0.018898535519838333, 0.01381856668740511, -0.0429823212325573, -0.03203275427222252, -0.013436910696327686, 0.037691786885261536, -0.040666066110134125, -0.005517556332051754, -0.03945529833436012, 0.022438719868659973, 0.040771350264549255, 0.04235061630606651, -0.011805004440248013, 0.00785026140511036, -0.008745178580284119, -0.013318466022610664, 0.029295360669493675, -0.01237090677022934, 0.0008118407567963004, 0.007409383542835712, -0.010363925248384476, -0.009034710004925728, 0.019280189648270607, 0.023438921198248863, 0.01972764916718006, 0.0031519492622464895, -0.014318667352199554, -0.022754572331905365, 0.0033789684530347586, 0.026334239169955254, -0.020991060882806778, 0.02351788431406021, -0.009988849982619286, 0.0058465697802603245, 0.007889743894338608, 0.008212177082896233, -0.022991463541984558, -0.02795298583805561, 0.007494927383959293, 0.011094334535300732, 0.01412125863134861, -0.03800763934850693, 0.027110710740089417, 0.00046843296149745584, 0.008054249919950962, -0.016503317281603813, -0.00041537953075021505, -0.00017602222214918584, 0.008179275318980217]",Online Speculative Decoding.pdf
" to
mitigate confounding variables, we set the token acceptance
rate (0.7) and standardize the input and output lengths across
all requests (input length=output length=128). The results
show that at a low request rate (specifically, a request rate
of 4), proposing 3 or 5 tokens results in the most significant
speedup. However, as the request rate increases, the advan-
tage of proposing more tokens diminishes rapidly: when the
request rate exceeds 12, proposing 5 tokens offers no per-
formance improvements. Likewise, at a request rate greater
than 16, proposing 3 tokens yields performance degradation.
Several insights emerged from this experiment. Firstly,
speculative decoding does not invariably lead to improved
performance; in fact, it may detrimentally affect performance
at higher request rates. Secondly, the optimal length for
speculation varies with the request rate. At lower request
rates, speculating more is better, but at higher request rates,
it may not even make sense to speculate at all.
3.2 Latency Analysis
To understand the phenomenon, we can approximate the
request latency as:
ùëüùëíùëûùë¢ùëíùë†ùë° ùëôùëéùë°ùëíùëõùëêùë¶‚âàùëèùëéùë°ùëê‚Ñéùëôùëéùë°ùëíùëõùëêùë¶√óùëîùëíùëõùëíùëüùëéùë°ùëñùëúùëõùë†ùë°ùëíùëùùë† (1)
where batch latency refers to the time required to process
a single batch and generation steps is the average number
5 10 15 20 25
Request rate (req/s)0200400600800Average number of batched tokens
w/o SD
vsd, k=1
vsd, k=3
vsd, k=5(a)Average batch size.
w/o SD vsd, k=1 vsd, k=3 vsd, k=5
Method020406080100120Number of generation steps (b)Average number of gen-
eration steps.
Figure 3. Latency analysis: batch size and generation step.
of iterations needed for the target model to complete a re-
quest. For simplicity, we exclude the latency associated with
the draft model, assume uniform latency across different
generation steps, and focus solely on the batch latency per
generation step incurred by the target model. Fig. 3a illus-
trates that proposing more tokens at each step leads to a
greater accumulation of tokens within the same batch and
hence higher batch latency . On the other hand, as shown
in Fig. 3b, generating more tokens in a single forward pass
of the target model reduces the number of generation steps .
Given the approximation presented in Eq. 1, the feasibility of
achieving a speedup is determined by the interplay between
these two factors.
3.3 Granularity of Proposed Lengths
Lastly, continuous batching enables flexible scheduling. As
shown in Fig. 4, there are three levels of granularity for pro-
posed lengths: (1) Global: This is the simplest way to imple-
ment speculative decoding with continuous batching, where
the proposed length for all requests across all generation
steps is uniform. However, this approach overlooks system
behavior; as previously mentioned, speculative decoding can
degrade performance. (2) Step Level: Here all requests within
the same batch have the same proposed length, although the
length can vary between steps. This allows proposed lengths
to adapt to different system loads. For instance, when the
number of requests is high, the proposed length for a given
step can be reduced to conserve computational resources. (3)
Request Level: This is the most fine-grain level of scheduling,
where each request can have its own proposed length. It al-
lows for the prioritization of ‚Äòeasier‚Äô requests by proposing a
higher number of tokens for them, based on the assumption
that it is more likely for more tokens to be generated in a
single step for these requests.
In this section, we analyze the performance characteris-
tics of naive speculative decoding with continuous batch-
ing across various request rates. We explore the reasons for
performance degradation and highlight the possibility of
implementing flexible scheduling. Determining the optimal
proposed length to achieve minimal latency across diverse
4
ùë•!ùë•""ùë•#ùë•$ùë•‚Ä≤!ùë•‚Ä≤""ùë•‚Ä≤#ùë•","[0.006125332321971655, -0.0006166906678117812, 0.049113523215055466, -0.011280588805675507, -0.022381020709872246, -0.009194927290081978, 0.004573212005198002, 0.01484215073287487, 0.016227973625063896, 0.0169901754707098, 0.020052840933203697, 0.009957129135727882, -0.06818243116140366, -0.007351784501224756, 0.021591102704405785, -0.04412456601858139, 0.0003076957364100963, -0.002657313132658601, 0.01017193216830492, 0.006288166157901287, 0.003942662850022316, 0.01563206873834133, -0.02457061968743801, 0.0006292496691457927, 0.03813781589269638, -0.0272868312895298, 0.044484879821538925, 0.03359232097864151, 0.06352607160806656, -0.04997273162007332, -0.0026642424054443836, -0.020704176276922226, -0.033232007175683975, -0.033481452614068985, 0.0013962154043838382, 0.029407138004899025, -0.029323987662792206, -0.010206577368080616, 0.00722013134509325, -0.035393886268138885, -0.007656665053218603, -0.04836517944931984, -0.06153048574924469, 0.015590494498610497, 0.0192213486880064, 0.059091441333293915, 0.018639301881194115, -0.03999481722712517, -0.015063882805407047, 0.05886970832943916, -0.053270988166332245, 0.043542519211769104, -0.012742631137371063, 0.004777620546519756, 0.03833182901144028, 0.002551644342020154, -0.0007193281198851764, -0.005993679165840149, 0.02307393215596676, -0.0060248603112995625, 0.03248366340994835, -0.061087023466825485, -0.0019990478176623583, 0.010788622312247753, -0.0059694270603358746, 0.0250556580722332, -0.013040582649409771, 0.00694643147289753, -0.020302288234233856, 0.04786628484725952, 0.013504832983016968, -0.009527524933218956, 0.0360867977142334, 0.00877225212752819, -0.053659018129110336, 0.01643584668636322, 0.029102256521582603, 0.038193248212337494, 0.012950504198670387, 0.013290030881762505, 0.020524021238088608, -3.0247183531173505e-06, 0.015909234061837196, -0.04542723670601845, -0.01643584668636322, -0.050083599984645844, -0.019207488745450974, -0.019332213327288628, -0.015271755866706371, -0.01789095811545849, -0.029019108042120934, 0.006863282527774572, -0.0560426339507103, 0.033010274171829224, 0.011121219955384731, 0.010781693272292614, 0.04939068853855133, -0.03805466741323471, 0.05498940870165825, 0.012022003531455994, 0.03486727550625801, -0.0038941591046750546, -0.0034662866964936256, -0.003831797279417515, 0.05194060131907463, -0.003956520929932594, -0.03126413747668266, 0.07012258470058441, -0.010192719288170338, -0.02178511768579483, -0.00016770609363447875, -0.00037806949694640934, -0.04110347479581833, 0.011675548739731312, 0.009901696816086769, -0.038498129695653915, -0.06186308339238167, 0.016796160489320755, 0.00666580256074667, 0.04016111418604851, 0.008696031756699085, 0.003338098293170333, -0.0060248603112995625, -0.0006816510576754808, -0.04085402563214302, -0.014357113279402256, 0.06247284635901451, -0.0985042080283165, 0.008113986812531948, -0.007739814464002848, 0.0099779162555933, -0.006222339812666178, 0.04634188115596771, -0.02026071399450302, -0.044484879821538925, -0.052300915122032166, -0.02059331163764, 0.005848167929798365, -0.019900400191545486, 0.03104240819811821, 0.0034801450092345476, -0.047921717166900635, -0.006894463207572699, 0.0019089694833382964, -0.04886407405138016, 0.025748567655682564, -0.0066865901462733746, 0.024556761607527733, -0.04268331080675125, 0.035726483911275864, -0.03860899433493614, -0.009756185114383698, -0.02082890085875988, -0.01683773472905159, 0.015271755866706371, -0.05288295820355415, -0.0430990569293499, 0.050721075385808945, 0.010705472901463509, 0.002082197228446603, -0.018071115016937256, 0.03669656068086624, 0.010629252530634403, -0.021882126107811928, 0.01603395864367485, 0.027494704350829124, -0.018473004922270775, -0.005796199664473534, -0.06025553122162819, -0.04079859331250191, 0.005934781860560179, -0.05133083835244179, -0.019747959449887276, -0.06396953016519547, 0.005931317340582609, -0.005862026009708643, -0.0692356526851654, -0.06951282173395157, 0.0671292096376419, -0.02529124729335308, -0.012015074491500854, 0.03273310884833336, -0.017932534217834473, -0.005162185989320278, -0.012444679625332355, -0.013511762022972107, -0.05529429018497467, 0.03561561927199364, 0.018057256937026978, 0.023808417841792107, -0.011550824157893658, 0.03669656068086624, 0.05681869387626648, -0.044734325259923935, -0.013996799476444721, -0.057428453117609024, 0.0503053292632103, 0.014745143242180347, -0.00493006082251668, 0.008363434113562107, 0.012867354787886143, 0.03112555667757988, 0.023572828620672226, -0.02017756551504135, 0.030820675194263458, -0.002891170559450984, -0.02002512477338314, -0.03583735227584839, 0.015465770848095417, 0.024279598146677017, -0.0044692750088870525, 0.005283445585519075, 0.05033304542303085, 0.0022259762044996023, -0.03295484185218811, -0.01653285324573517, -0.041463788598775864, 0.017655368894338608, 0.022630469873547554, 0.01820969767868519, 0.023822275921702385, -0.013109873980283737, 0.018708594143390656, 0.010442166589200497, -0.0072617060504853725, 0.0513862706720829, 0.01923520676791668, -0.0011909406166523695, 0.021119924262166023, -0.02874194271862507, 0.016227973625063896, 0.022214723750948906, 0.002539518289268017, -0.015742935240268707, 0.024376604706048965, 0.009111777879297733, 0.00011660390737233683, -0.02706509828567505, -0.016061674803495407, -0.09135337173938751, 0.0022381022572517395, 0.002220779424533248, -0.013241526670753956, 0.010248151607811451, -0.026455337181687355, 0.012292238883674145, -0.06507819145917892, -0.049446120858192444, 0.016075532883405685, 0.04151922091841698, -0.01796025037765503, -0.06186308339238167, -0.021438661962747574, -0.00716469855979085, -0.027342263609170914, -0.004791478626430035, 0.009998704306781292, 0.018958041444420815, -0.024459755048155785, 0.025360537692904472, 0.015479628928005695, -0.055516019463539124, 0.00158156908582896, 0.027175964787602425, -0.010067994706332684, -0.01488372590392828, -0.046563610434532166, -0.0013373179826885462, 0.031790751963853836, -0.024861643090844154, 0.00945130456238985, -0.016962459310889244, -0.0266493521630764, 0.01843142881989479, -0.013581053353846073, -0.017613794654607773, 0.05299382284283638, -0.01938764564692974, -0.07256162911653519, -0.0016690491465851665, -0.008522803895175457, -0.010352088138461113, 0.06940195709466934, 0.022852201014757156, -0.007192415185272694, -0.011356809176504612, 0.04124205559492111, 0.018805600702762604, 0.015770651400089264, -0.02912997268140316, 0.01747521199285984, -0.016020098701119423, 0.020953625440597534, -0.059645768254995346, 0.03325972333550453, 0.004060457926243544, 0.021743543446063995, -0.017835525795817375, 0.0038214034866541624, -0.0011225156486034393, 0.040022533386945724, 0.03750033676624298, 0.045205507427453995, -0.032843977212905884, -0.007573516108095646, -0.0037451833486557007, -0.008197135291993618, 0.00716469855979085, 0.0005933049251325428, -0.02552683651447296, 0.02985060028731823, 0.047201089560985565, -0.04096489027142525, -0.0035858137998729944, -0.028631078079342842, -0.0261088814586401, 0.06757266819477081, -0.06335977464914322, 0.00030314852483570576, -0.030820675194263458, 0.0017963714199140668, -0.005494783166795969, -0.0007738948334008455, 0.010365947149693966, 0.08375906944274902, -0.04717337340116501, 0.0007266902830451727, 0.0057892706245183945, -0.008751464076340199, -0.013969083316624165, 0.0012559009483084083, -0.009673035703599453, 0.02896367572247982, 0.012874283827841282, -0.0305712278932333, -0.037943799048662186, -0.027633285149931908, 0.013276172801852226, 0.05720672383904457, 0.06275001168251038, -0.06906935572624207, 0.007324067875742912, 0.025346679612994194, -0.043043624609708786, -0.005234941840171814, 0.014343255199491978, 0.03733403980731964, 0.011024212464690208, 0.05803821608424187, 0.015590494498610497, -0.021743543446063995, -0.01955394446849823, 0.033315155655145645, -0.013837430626153946, 0.03580963611602783, 0.011003424413502216, 0.04079859331250191, -0.08237324655056, -0.04021654650568962, -0.012008145451545715, -0.006295095197856426, 0.061641350388526917, 0.020565595477819443, 0.022325588390231133, -0.010844055563211441, -0.001794639159925282, -0.03278854116797447, -0.010234293527901173, -0.019664810970425606, -0.01572907716035843, -0.004386126063764095, 0.08569921553134918, -0.018084974959492683, 0.008605953305959702, -0.05992293357849121, -0.003426444251090288, -0.009527524933218956, 0.054213348776102066, -0.0013087354600429535, 0.020648743957281113, 0.033952634781599045, -0.0028703834395855665, -0.007233989425003529, -0.00598328560590744, 0.018528437241911888, 0.041214339435100555, -0.0006812179926782846, -0.00672123534604907, -0.07461264729499817, -0.03129185363650322, -0.0039461273699998856, 0.018847176805138588, 0.001184877590276301, 0.010656969621777534, 0.00271447841078043, 0.035477038472890854, -0.009846263565123081, 0.04958470165729523, 0.034423813223838806, 0.030598944053053856, 0.0005339744384400547, 0.019096624106168747, -0.03431294858455658, 0.0029812490101903677, -0.03453467786312103, 0.015410337597131729, 0.01994197443127632, 0.038830727338790894, 0.04351480305194855, 0.006690054666250944, 0.02824304811656475, -0.03356460481882095, 0.04659132659435272, -0.021355513483285904, 0.03542160615324974, 0.01308908686041832, 0.004257937427610159, 0.012132869102060795, 0.027466988191008568, 0.0764419287443161, -0.00424754386767745, -0.04287732392549515, -0.044263146817684174, -0.0010731457732617855, -0.04897494241595268, 0.01977567747235298, 0.0020423547830432653, 0.013809713535010815, 0.007206273265182972, -0.049473837018013, -0.032594528049230576, 0.013567195273935795, 0.04786628484725952, -0.035560186952352524, -0.019928116351366043, 0.008003120310604572, 0.012299167923629284, 0.01543805468827486, 0.0024511723313480616, -0.054795391857624054, -0.019456937909126282, -0.02170196920633316, 0.002322983695194125, 0.010663898661732674, -0.02753627859055996, 0.029739735648036003, -0.03173531964421272, -0.008578237146139145, 0.03167988732457161, 0.01595080830156803, -0.007580445148050785, -0.031097840517759323, 0.027965882793068886, 0.02849249541759491, -0.024529045447707176, -0.03569876775145531, 0.09185227006673813, -0.02107834815979004, 0.04459574446082115, 0.007552728522568941, 0.03772206977009773, -0.0163526963442564, -0.023836134001612663, -0.0039010883774608374, -0.007767531089484692, -0.009409729391336441, 0.016643719747662544, 0.015742935240268707, -0.0016811750829219818, 0.015978524461388588, 0.030515795573592186, -0.028991391882300377, 0.01780780963599682, -0.0007314540562219918, -0.007310209795832634, 0.034118931740522385, 0.03869214281439781, -0.0016266083111986518, 0.013033653609454632, -0.0001924992975546047, 0.016629861667752266, -0.01651899516582489, 0.0305712278932333, 0.02529124729335308, 0.01972024329006672, 0.055349722504615784, 0.06862589716911316, 0.0033640824258327484, -0.0183621384203434, -0.05601491406559944, 0.0059174587950110435, -0.033952634781599045, 0.03495042398571968, -0.016726868227124214, -0.021992990747094154, -0.012479324825108051, -0.021341655403375626, 0.025166522711515427, -0.001831016968935728, 0.003925340250134468, 0.02874194271862507, -0.015659786760807037, 0.007975404150784016, -0.006735093891620636, -0.011633973568677902, -0.016934741288423538, 0.042101263999938965, 0.006350528448820114, -0.012105152942240238, 0.022561177611351013, -0.026607777923345566, -0.01675458438694477, 0.004420771263539791, 0.004462345968931913, -0.031402722001075745, 0.005636829882860184, -0.03159673511981964, 0.012167515233159065, -0.022769052535295486, -0.014953017234802246, -0.0032965235877782106, -0.0010523584205657244, 0.0020042448304593563, 0.0019453472923487425, -0.0016958994092419744, -0.039606787264347076, -0.02082890085875988, -0.09196313470602036, -0.005477460566908121, -0.01754450425505638, 0.021119924262166023, -0.031097840517759323, -0.021480238065123558, 0.048947226256132126, -0.017031749710440636, -0.01320688147097826, -0.0017963714199140668, -0.00010718464909587055, -0.05465681105852127, 0.0069914706982672215, -0.017461353912949562, -5.689447789336555e-05, 0.009375084191560745, 0.014052232727408409, -0.014703569002449512, -0.03095925785601139, 0.024917075410485268, -0.003015894675627351, -0.024681486189365387, -0.005979821085929871, 0.012389246374368668, 0.012382317334413528, 0.018140407279133797, -0.017932534217834473, -0.03040492907166481, 0.00017885761917568743, 0.009305792860686779, -0.004957777447998524, -0.027148248627781868, 0.0009709413861855865, 0.018556153401732445, -0.005806593224406242, -0.006620763335376978, -0.0055259643122553825, -0.009867050684988499, 0.019664810970425606, 0.02242259681224823, -0.023586686700582504, 0.010144215077161789, 0.009825476445257664, -0.010636182501912117, -0.005688798148185015, 0.04165780171751976, -0.015299472026526928, -0.007802176754921675, -0.02131393924355507, 0.0006500370218418539, -0.013560266233980656, 0.02346196211874485, 0.012451608665287495, -0.00486769899725914, -0.013158377259969711, -0.02130008116364479, -0.0021792047191411257, -0.03431294858455658, 0.018320564180612564, 0.003817938966676593, 0.01428782194852829, -0.020773468539118767, 0.006083757616579533, -0.008030837401747704, 0.003655104897916317, 0.024695344269275665, 0.007725956384092569, -0.030931541696190834, -0.004711794201284647, 0.006617298815399408, -0.026760218665003777, -0.015147032216191292, -0.004909273702651262, 0.013165307231247425, -0.030072331428527832, -0.021244646981358528, -0.006308953743427992, -0.03614223003387451, 0.011516178958117962, -0.029240839183330536, 0.030044615268707275, 0.03048807941377163, -0.010504528880119324, 0.029490286484360695, 0.019193630665540695, -0.004348015878349543, -0.023254089057445526, -0.030848393216729164, -0.018251271918416023, -0.04553810507059097, -0.0096106743440032, 0.0354493223130703, -0.005900136195123196, 0.054795391857624054, -0.01747521199285984, 0.0017565290909260511, -0.002544715302065015, 0.02937942184507847, 0.015784509479999542, -0.011121219955384731, -0.038498129695653915, 0.020496303215622902, 0.019928116351366043, 0.006371315568685532, -0.008730676956474781, -0.02688494138419628, 0.011834917590022087, -0.023323379456996918, 0.025471404194831848, 0.016227973625063896, 0.02089819312095642, -0.021646536886692047, -0.032428231090307236, 0.017461353912949562, -0.009811618365347385, 0.014994591474533081, -0.017350489273667336, -0.0077051687985658646, -0.003727860515937209, -0.011550824157893658, 0.0011389722349122167, 0.005872419569641352, -0.012403104454278946, -0.049473837018013, -0.029712019488215446, 0.031485870480537415, -0.010622323490679264, 0.03278854116797447, -0.0183621384203434, -0.004268330987542868, -0.035643335431814194, 0.04556582123041153, -0.001969599165022373, 0.006021395791321993, -0.013269243761897087, -0.028769660741090775, 0.005837774369865656, 0.02379455976188183, 0.0462864488363266, 0.03558790311217308, 0.021923700347542763, -0.005460137967020273, -0.026302896440029144, -0.05401933193206787, 0.04867006093263626, 0.029795167967677116, 0.0163526963442564, -0.01181413047015667, 0.005688798148185015, -0.03192933276295662, -0.06613141298294067, 0.009118706919252872, 0.04235071316361427, -0.04905809089541435, -0.006683125626295805, -0.01360184047371149, -0.02921312302350998, 0.010262010619044304, -0.018861034885048866, 0.03389719873666763, 0.018722452223300934, 0.02538825385272503, 0.017863241955637932, 0.004399984143674374, 0.010109569877386093, 0.02656620368361473, -0.04506692290306091, 0.00958295725286007, 0.024556761607527733, -0.006776668597012758, 0.013629556633532047, -0.01543805468827486, -0.014086877927184105, -0.020094415172934532, 0.027827300131320953, 0.0034697512164711952, -0.016560569405555725, 0.005972891580313444, 0.004278724547475576, -0.0011268462985754013, 0.0092919347807765, 0.018473004922270775, -0.01528561394661665, 0.0014499160461127758, 0.0339803509414196, -0.008910833857953548, -0.010407521389424801, -0.030765242874622345, 0.009964058175683022, -0.004216362722218037, -0.008661385625600815, -0.0014629081124439836, -0.04135292023420334, -0.04772770032286644, -0.01908276602625847, -0.030183197930455208, 0.006451000459492207, 0.014786718413233757, 0.019664810970425606, 0.007518082857131958, 0.006814778316766024, -0.006215410772711039, 0.04254473000764847, 0.00789918377995491, 0.04140835255384445, 0.02289377525448799, -0.02840934693813324, -0.005661081988364458, 0.022602753713726997, -0.02416873164474964, 0.015465770848095417, -0.008592095226049423, 0.0068702115677297115, 0.033010274171829224, -0.024445895105600357, -0.03772206977009773, 0.03065437823534012, 0.035865068435668945, -0.03384176641702652, -0.0044969916343688965, 0.02416873164474964, 0.014856009744107723, -0.020690318197011948, -0.02034386433660984, 0.012257593683898449, -0.010324371978640556, -0.008238710463047028, 0.044956058263778687, -0.0031562091317027807, 0.04442944750189781, 0.00188991439063102, -0.006496039684861898, -0.01336625125259161, -0.02840934693813324, 0.004434629809111357, -0.025180380791425705, 0.013075228780508041, 0.03605908155441284, 0.0070261163637042046, -0.023877708241343498, 0.01772466115653515, 0.006998399738222361, 0.036031365394592285, 0.01722576469182968, -0.022519603371620178, -0.00744186295196414, 0.014869867824018002, 0.07804948091506958, -0.018570011481642723, -0.008689102716743946, 0.03431294858455658, 0.002284873742610216, 0.026704786345362663, -0.02935170568525791, -0.02562384493649006, -0.04307134076952934, 0.021036773920059204, -0.012659481726586819, 0.025332821533083916, -0.0071577695198357105, 0.018015682697296143, -0.0182651299983263, -0.036668844521045685, -0.029268555343151093, -0.007039974443614483, -0.01045602560043335, 0.001375428051687777, -0.009160282090306282, -0.011031141504645348, 0.00043610078864730895, -0.09645319730043411, -0.006852888502180576, 0.034756410866975784, -0.018001824617385864, -0.007462650071829557, -0.009700752794742584, 0.05338185280561447, 0.006832101382315159, -0.0012870819773525, 0.005338878370821476, 0.024473613128066063, -0.017419779673218727, 0.0004772423708345741, -0.03605908155441284, 0.0071577695198357105, -0.016061674803495407, -0.023406529799103737, -0.010740119032561779, 0.011959642171859741, -0.014343255199491978, 0.008813826367259026, -0.005439350381493568, -0.00805855356156826, 0.004084709566086531, 0.00458707008510828, -0.01707332395017147, -0.015493487007915974, -0.019179772585630417, -0.0038941591046750546, -0.014745143242180347, 0.02730068936944008, 0.019650952890515327, -0.0064163547940552235, 0.025665419176220894, -0.03392491862177849, -0.002646919572725892, -0.021729685366153717, -0.0027162106707692146, 0.025790143758058548, 0.012015074491500854, 0.025332821533083916, -0.03616994991898537, 0.040410563349723816, 0.011287517845630646, 0.005515570752322674, -0.045759834349155426, 0.01730891317129135, -0.019262922927737236, -0.01923520676791668, -0.004188646096736193, -0.02832619659602642, -0.0017729856772348285, 0.009375084191560745, -0.023420387879014015, -0.014994591474533081, 0.015299472026526928, -0.00033324683317914605, -0.009603744372725487, 0.018819458782672882, 0.0018743239343166351, 0.011516178958117962, 0.03561561927199364, 0.003405656898394227, -0.004202504642307758, 0.0012446411419659853, -0.042101263999938965, 0.029795167967677116, 0.025748567655682564, -0.019262922927737236, -0.02099519968032837, 0.02185440994799137, 0.0031215634662657976, 0.01221601851284504, 0.039385054260492325, 0.008266426622867584, 0.020787326619029045, -0.0009995239088311791, 0.020205281674861908, -0.04897494241595268, -0.004500456154346466, 0.046397313475608826, -0.036668844521045685, -0.009035557508468628, -0.007982333190739155, 0.014689710922539234, -0.0048365178517997265, 0.04922438785433769, 0.025568410754203796, -0.04359795153141022, 0.02299078367650509, 0.022602753713726997, -0.016006240621209145, -0.003589278319850564, -0.0004393488052301109, -0.024362746626138687, -0.042322997003793716, 0.0028357377741485834, 0.042905040085315704, 0.028062891215085983, 0.005110217723995447, 0.04415228217840195, 0.03791608288884163, -0.018292848020792007, -0.022769052535295486, 0.012146728113293648, 0.004885021597146988, 0.004919667262583971, -0.01224373560398817, 0.011322163976728916, 0.000770430313423276, 0.015548920258879662, 0.004212898202240467, 0.003897623624652624, 0.031236423179507256, -0.009285005740821362, 0.03104240819811821, 0.045039206743240356, 0.003405656898394227, 0.013539479114115238, -0.016241831704974174, 0.00688406964763999, 0.03711230680346489, -0.03095925785601139, 0.04404141753911972, -0.06291630864143372, 0.0034697512164711952, 0.005941710900515318, 0.04570440202951431, 0.005460137967020273, -0.01376121025532484, -0.005415098741650581, 0.03253909572958946, -0.021965274587273598, -0.007178556639701128, 0.021106066182255745, -0.0007600366370752454, 0.008259497582912445, -0.0009718075161799788, -0.025901008397340775, 0.02522195689380169, -0.006963754538446665, 0.016338838264346123, 0.026690926402807236, 0.0028270764742046595, -0.008543591015040874, -0.019900400191545486, -0.004299512133002281, -0.016020098701119423, -0.019359929487109184, -0.001837946125306189, 0.017863241955637932, -0.016879308968782425, -0.011564682237803936, -0.0005989348283037543, 0.00542549230158329, -0.008841542527079582, -0.016214115545153618, -0.026358330622315407, 0.025679277256131172, 0.031957048922777176, 0.04811573028564453, 0.05121997371315956, 0.005713050253689289, -0.002721407450735569, 0.023364955559372902, -0.04176866635680199, -0.026316754519939423, -0.013075228780508041, -0.017572220414876938, 0.008654456585645676, 0.0002017020306084305, -0.025402113795280457, 0.03702915832400322, 0.013788926415145397, 0.04850376024842262, -0.0004105496918782592, -0.025041799992322922, 0.027092816308140755, 0.017586078494787216, 0.043542519211769104, 0.01906890794634819, -0.012728773057460785, 0.002198259811848402, -0.026760218665003777, 0.015216322615742683, -0.026940375566482544, 0.00542895682156086, 0.05498940870165825, 0.009042487479746342, 0.01057382021099329, -0.007019187323749065, 0.02681565098464489, 0.019512370228767395, 0.03774978592991829, -0.011391455307602882, 0.005356200970709324, 0.01308215782046318, 0.010206577368080616, -0.016255689784884453, -0.0002934044459834695, -0.057262156158685684, 0.029157690703868866, -0.021203072741627693, 0.02329566329717636, -0.008834613487124443, 0.004427700769156218, -0.01851457916200161, 0.04939068853855133, -0.01628340594470501, 0.007954617030918598, -0.031957048922777176, 0.00917414017021656, -0.05870341137051582, 0.04620329663157463, -0.029074540361762047, 0.007078084629029036, 0.011710193939507008, 0.01809883303940296, -0.025263531133532524, -0.00375211238861084, -0.06801613420248032, -0.0030921148136258125, 0.011211298406124115, -0.011599328368902206, -0.029157690703868866, 0.0022450312972068787, 0.021577244624495506, 0.004095103126019239, -0.020149849355220795, 0.006302024703472853, 0.00492659630253911, 0.011710193939507008, -0.004756833426654339, -0.03519987314939499, -0.002743927063420415, 0.010961850173771381, -0.03325972333550453, 0.013816642574965954, -0.014467978850007057, 0.007372571621090174, 0.011232085525989532, 0.019581660628318787, 0.0005599586293101311, -0.01843142881989479, -0.007428004872053862, -0.03614223003387451, -0.01651899516582489, 0.008197135291993618, -0.0022311729844659567, 0.013109873980283737, 0.00396691495552659, 0.026053449138998985, 0.02976745180785656, -0.013428612612187862, 0.03691829368472099, 0.003991166595369577, 0.013303888961672783, 0.04684077575802803, 0.02075961045920849, 0.034340664744377136, -0.006627692375332117, -0.008820755407214165, 0.007130052894353867, -0.014551128260791302, 0.0002643888001330197, -0.034118931740522385, -0.005047855898737907, -0.010864842683076859, 0.0038491198793053627, -0.011086573824286461, -0.024127157405018806, 0.028132181614637375, 0.0018431429052725434, 0.042101263999938965, -0.002322983695194125, 0.00031462483457289636, 0.039385054260492325, -0.0305712278932333, 0.01563206873834133, -0.011142007075250149, -0.026053449138998985, 0.0005798797938041389, -0.026940375566482544, -0.036114513874053955, 0.019096624106168747, -0.027023524045944214, -0.015257897786796093, -0.009776972234249115, 0.009160282090306282, -0.001184877590276301, 0.060920726507902145, 0.019886542111635208, -0.00021566850773524493, 0.017378205433487892, -0.022921491414308548, -0.009028628468513489, 0.022685902193188667, 0.007358713541179895, 0.011717122979462147, -0.025249673053622246, 0.0091810692101717, 0.00902169942855835, 0.018639301881194115, -0.015701361000537872, 0.0320679172873497, 0.04157465323805809, 0.01794639229774475, 0.013934438116848469, -0.011987358331680298, -0.02529124729335308, 0.005564074497669935, 0.02809060737490654, 0.010795551352202892, 0.03519987314939499, 0.014620419591665268, -0.0035477036144584417, 0.014648135751485825, 0.0003174397861585021, 0.010712401941418648, 0.020413154736161232, 0.0007938160561025143, 0.0050028166733682156, -0.002413062145933509, 0.00660344073548913, -0.009513666853308678, -0.04118662327528, 0.0037313250359147787, -0.014190814457833767, -0.017378205433487892, 0.03486727550625801, 0.011287517845630646, 0.015022307634353638, 0.004902344662696123, -0.00042938822298310697, -0.023517394438385963, 0.0014066090807318687, -0.0012429088819772005, 0.0073656425811350346, 0.0005387382116168737, -0.0024234557058662176, -0.0036516403779387474, 0.004410377703607082, -0.012825780548155308, 0.01308215782046318, 0.0020423547830432653, -0.006464858539402485, -0.0035113259218633175, -0.00013111173757351935, -0.018334422260522842, -0.03597593307495117, 0.08775023370981216, -0.010144215077161789, -0.025998016819357872, 0.022852201014757156, -0.025998016819357872, 0.0004828722740057856, 0.03173531964421272, -0.022602753713726997, -0.0448174774646759, 0.008508945815265179, 0.0071577695198357105, 0.02671864442527294, 0.018140407279133797, 0.030626660212874413, 0.017101040109992027, 0.013421683572232723, 0.001423065783455968, 0.03996710106730461, 0.023655977100133896, 0.043459370732307434, 0.028367770835757256, 0.012257593683898449, -0.006766274571418762, -0.006956825032830238, -0.018556153401732445, 0.015992382541298866, 0.028464779257774353, 0.013996799476444721, 0.013199952431023121, 0.028714226558804512, 0.017336631193757057, -0.014731285162270069, -0.011273659765720367, 0.003338098293170333, 0.0011935390066355467, 0.005196831654757261, -0.02012213133275509, 0.027175964787602425, -0.010830197483301163, -0.015618211589753628, -0.017267338931560516, 0.014814434573054314, 0.026871083304286003, 0.019456937909126282, 0.014592703431844711, 0.042322997003793716, 0.025014081969857216, 0.015271755866706371, 0.030543511733412743, -0.013310818001627922, 0.04029969871044159, -0.013172236271202564, 0.008571307174861431, 0.0011571611976251006, 0.010601536370813847, -0.024861643090844154, 0.0211337823420763, 0.02193755842745304, 0.015853801742196083, -0.008418867364525795, -0.046896208077669144, 0.002002512337639928, -0.04315448924899101, -0.013567195273935795, -0.006762810051441193, -0.06097615882754326, -0.005609113723039627, 0.0125278290361166, -0.013962154276669025, 0.029074540361762047, -0.005529428832232952, -0.006845959462225437, -0.003551168367266655, -0.017502928152680397, 0.020454728975892067, 0.013844359666109085, -0.015826083719730377, 0.004403448663651943, 0.024154873564839363, 0.018292848020792007, -0.0036724277306348085, -0.015230181626975536, -0.01604781672358513, 0.0010142483515664935, 0.002809753641486168, 0.017849383875727654, 0.04176866635680199, 0.051358554512262344, 0.015895375981926918, 0.02448747120797634, -0.021882126107811928, -0.009077132679522038, 0.024044007062911987, -0.021577244624495506, 0.0017981037963181734, -0.03470097854733467, -0.002411329885944724, -0.053742166608572006, -0.02784116007387638, 0.0041574654169380665, 0.006437141913920641, -0.01556277833878994, 0.001992118777707219, 0.010372876189649105, -0.00961760338395834, -0.011356809176504612, -0.042821891605854034, -0.03095925785601139, 0.0016257421812042594, -0.001008185325190425, -0.00598675012588501, -0.020925909280776978, -0.0015373959904536605, -0.009437446482479572, -0.0062847016379237175, 0.03040492907166481, -0.006430212873965502, 0.03517215698957443, -0.01041445042937994, -0.01915205642580986, 0.04021654650568962, 0.029019108042120934, 0.0183621384203434, 0.004881557077169418, -0.03528302162885666, 0.0026521163526922464, -0.007085013668984175, 0.015133174136281013, -0.01336625125259161, -0.013435541652143002, 0.00212550419382751, -0.010705472901463509, 0.003237626049667597, 0.023434245958924294, 0.004441558849066496, 0.024764634668827057, -0.0018864498706534505, -0.013948296196758747, -0.00344030256383121, -0.004604392684996128, -0.007407217286527157, 0.00498895812779665, -0.03287169337272644, -0.03409121558070183, 0.014079948887228966, 0.02671864442527294, -0.0029206194449216127, -0.009368155151605606, 0.033786334097385406, 0.016408130526542664, -0.007005329243838787, 0.0011138542322441936, -0.021050631999969482, -0.0016984977992251515, -0.006804384756833315, 0.004767226986587048, 0.02498636581003666, -0.0022883382625877857, 0.026926517486572266, 0.0031232957262545824, 0.009160282090306282, -0.011086573824286461, -0.01755836233496666, 0.013816642574965954, 0.03112555667757988, -0.011072715744376183, -0.018389854580163956, -0.0009250360308215022, 0.040660008788108826, 0.022228581830859184, 0.005979821085929871, 0.01660214550793171, 0.01747521199285984, 0.018334422260522842, -0.006534149404615164, 0.014100736007094383, -0.02153567038476467, 0.04007796570658684, -0.01604781672358513, 0.020288430154323578, -0.023822275921702385, 0.010927204973995686, 0.023004641756415367, 0.04467889294028282, 0.0006127930828370154, -0.005273052025586367, 0.013518691062927246, 0.01571521908044815, -0.004046599380671978, 0.01794639229774475, -0.012832709588110447, -0.024792350828647614, -0.006627692375332117, -0.011086573824286461, 0.03575420007109642, 0.0034697512164711952, 0.010158073157072067, 0.003149279858916998, 0.005872419569641352, 0.01818198151886463, -0.019138198345899582, -0.0032393583096563816, 0.03190161660313606, 0.002080464968457818, 0.018611585721373558, 0.018570011481642723, -0.017142614349722862, -0.014800576493144035, -0.0010540906805545092, -0.012105152942240238, 0.019276781007647514, 0.005068643018603325, 0.03431294858455658, 0.0032861297950148582, 0.03639167919754982, -0.05482310801744461, 0.001459443592466414, -0.012659481726586819, -0.026552345603704453, -0.028603361919522285, -0.0035026646219193935, 0.014315539039671421, -0.00021274528990034014, 0.0133246760815382, -0.011627044528722763, 0.006554936990141869, -0.004992423113435507, 0.03669656068086624, -0.0004945651162415743, 0.009686893783509731, -0.002082197228446603, -0.007919971831142902, -0.008952409029006958, 0.002175740199163556, 0.004971635527908802, -0.011557753197848797, 0.002066606655716896, -0.012507040984928608, 0.023905426263809204, 0.0011502320412546396, -0.0373617559671402, 0.0016075532184913754, -0.010061065666377544, 0.0003068296064157039, 0.03234507888555527, 0.051275406032800674, 0.009375084191560745, 0.023018499836325645, -0.021022915840148926, 0.011620115488767624, -0.016616003587841988, -0.00028062891215085983, -0.017696943134069443, -0.04661904275417328, -0.0044173067435622215, -0.025166522711515427, -0.007469579111784697, 0.0017573952209204435, 0.03575420007109642, 0.057761050760746, 0.0014559789560735226, -0.023600544780492783, 0.01651899516582489, 0.005477460566908121, -0.012583261355757713, -0.0009423588053323328, -0.008536661975085735, -0.014800576493144035, -0.03470097854733467, 0.010684685781598091, -0.013941367156803608, 0.006738558411598206, -0.010504528880119324, -0.03126413747668266, 0.017904818058013916, 0.015105457045137882, 0.01764151081442833, -0.035560186952352524, 0.010372876189649105, 0.024154873564839363, 0.03112555667757988, -0.0009579493198543787, 0.0033294367603957653, 0.0076012322679162025, -0.019415363669395447, -0.004354944918304682, -0.018819458782672882, 0.006814778316766024, 0.010629252530634403, 0.0057615539990365505, 0.028062891215085983, 0.020080557093024254, 0.015507346019148827, -0.029407138004899025, -0.0024303849786520004, -0.008446583524346352, 0.017863241955637932, -0.01899961568415165, 0.017599936574697495, -0.002442510798573494, -0.026289038360118866, -0.006426748353987932, -0.009756185114383698, -0.020607169717550278, -0.00344030256383121, 0.042018115520477295, -0.004801872186362743, 0.034590110182762146, 0.0373617559671402, -0.031790751963853836, 0.008723747916519642, -0.002000780077651143, -0.011502320878207684, 0.012125940062105656, -0.008245639503002167, 0.01571521908044815, -0.009028628468513489, -0.011121219955384731, -0.02874194271862507, 0.047838568687438965, -0.016338838264346123, 0.018459146842360497, -0.025568410754203796, -0.04207354784011841, 0.035005856305360794, -0.011419171467423439, 0.015618211589753628, -0.008578237146139145, 0.0038803010247647762, -0.029795167967677116, 0.024321172386407852, 0.0037105376832187176, 0.02433503046631813, -0.031070124357938766, -0.012410033494234085, 0.03830411285161972, 0.020870475098490715, 0.0046806130558252335, 0.02193755842745304, -0.024376604706048965, -0.02624746412038803, 0.005110217723995447, -0.04595385119318962, -0.03192933276295662, -0.012777276337146759, 0.049917299300432205, -0.04284960776567459, 0.00822485238313675, -0.037056874483823776, 0.020413154736161232, 0.03320429101586342, 0.04941840469837189, 0.02538825385272503, -0.012112081982195377, -0.004923131782561541, 0.022381020709872246, 0.0202745720744133, -0.006759345531463623, -0.00458707008510828, -0.019595520570874214, 0.0010142483515664935, -0.004555888939648867, 0.012624836526811123, 0.008993983268737793, 0.031485870480537415, -0.017586078494787216, 0.00576501851901412, -0.016782302409410477, -0.003772899741306901, 0.030848393216729164, -0.01603395864367485, 0.026372188702225685, -0.02233944647014141, -0.015410337597131729, 0.014079948887228966, 0.005602184683084488, -0.008966267108917236, -0.014592703431844711, 0.003648175857961178, -0.009347368031740189, 0.014183885417878628, -0.035477038472890854, 0.029240839183330536, 0.004503920674324036, 0.024529045447707176, -0.021507954224944115, -0.02059331163764, 0.017918676137924194, 0.007039974443614483]",Online Speculative Decoding.pdf
"‚Ä≤$ùë•!ùë•""ùë•#ùë•$ùë•‚Ä≤!ùë•‚Ä≤""ùë•‚Ä≤#ùë•‚Ä≤$ùë•!ùë•""ùë•#ùë•$ùë•‚Ä≤!ùë•‚Ä≤""ùë•‚Ä≤#ùë•‚Ä≤$Step 1Step 2Step 1Step 2Step 1Step 2Global Propose LengthStep-level Propose LengthRequest-level Propose LengthFigure 4. Flexible proposed lengths.
workloads under different request volumes is a significant
challenge that we address in the following discussion.
4 The Goodput of Speculative Decoding
We now define the goodput of serving LLMs with specula-
tive decoding and elaborate on how it is connected to the
overall system efficiency. Then we describe how goodput
can be estimated given various prediction methods on the
acceptance of speculated tokens.
4.1 Defining Goodput
We define the per-step throughput of serving a request using
an LLM as:
ùëá‚Ñéùëüùëúùë¢ùëî‚Ñéùëùùë¢ùë° =ùëÅùë¢ùëöùëèùëíùëüùëúùëì Outputùëáùëúùëòùëíùëõùë†
ùê∏ùë•ùëíùëêùë¢ùë°ùëñùëúùëõùëáùëñùëöùëí(2)
Throughput refers to the output rate of tokens generated
by the model per unit of time. Existing systems such as
vLLM [ 19] and Orca [ 41] all aim to maximize the throughput,
as doing so enhances the overall efficiency of the system.
Goodput in speculative decoding. In speculative decoding,
not all tokens output by the target model in the scoring phase
(Fig. 4) are guaranteed to pass through the rejection sampling
mechanism. Consequently, these tokens might not represent
the actual tokens generated in a single step. To address this
discrepancy, we define goodput as:
ùê∫ùëúùëúùëëùëùùë¢ùë° =ùëÅùë¢ùëöùëèùëíùëüùëúùëì Generatedùëáùëúùëòùëíùëõùë†
ùê∏ùë•ùëíùëêùë¢ùë°ùëñùëúùëõùëáùëñùëöùëí(3)
Here, the goodput refers to the rate at which tokens are
generated, measured in tokens per second. This includes
both the proposed tokens that are subsequently accepted
and the bonus tokens that the target model produces during
verification.
Parameters of Goodput. While the above definition is
general across different speculative decoding algorithms, we
focus on three configuration parameters of particular impact
in the context of speculative decoding scheduling:
1.Proposed length: the number of tokens proposed by the
draft model in each step.
2. Requests to run: which request(s) to run in each step.
4.2 Understanding Goodput
Goodput, essentially defined as the ratio of expected gain to
costs, offers valuable insights into how batch size and pro-
posed length should interact to optimize system performance.
0
2
4
6
8
10Propose length
050100150200
Batch size1000200030004000
Goodput
Figure 5. Goodput as a function of proposed length and
batch size. We calculated the goodput using the coefficients
from the A100-7B model, as detailed in Sec. 4.3. We assumed
a uniform token acceptance rate of 0.7 and employed the
formula described in Section 4.4 to estimate the accepted
length.
KV CacheR1 KVR2 KVR3 KVContext token number = 8Batched token number = 3Input tokensR1 R2 R3 
Figure 6. An example of context token number and batched
token number used in modeling the forward execution time.
To demonstrate the intuition behind goodput, Fig. 5 shows
the goodput values across various batch sizes and proposed
lengths, assuming a uniform token acceptance rate.
Propose more for small batches. In Fig. 5, the red line
indicates the optimal proposed length for each batch size.
Notably, small batch sizes require proposing more than 4
tokens per per request to achieve the maximum goodput. As
batch size increases, the optimal proposal length decreases.
Propose less for large batches. For large","[0.017735423520207405, 0.0030297446064651012, 0.006986475549638271, -0.02126614935696125, -0.026064665988087654, -0.015131683088839054, 0.009576583281159401, 0.021170724183321, 0.02425158955156803, 0.0019834775011986494, 0.042723149061203, 0.018158020451664925, -0.09193520247936249, -0.03748840466141701, 0.023092856630682945, -0.058999933302402496, -0.001949397032149136, -0.01998472772538662, 1.935658474394586e-05, 0.07203226536512375, 0.011900864541530609, -0.005013222340494394, -0.024987725540995598, 0.03203554451465607, 0.034407541155815125, -0.036615949124097824, 0.029554495587944984, 0.04501334950327873, 0.04285947233438492, -0.041468992829322815, -0.017967170104384422, -0.02780958078801632, 0.001357250614091754, -0.05981786176562309, 0.009522054344415665, 0.03694311901926994, -0.02952723018825054, 0.02602376975119114, 0.014300121925771236, 0.003943098708987236, -0.004703090991824865, -0.04812147840857506, -0.08795461058616638, 0.010946613736450672, 0.021416103467345238, 0.057473134249448776, 0.004662194289267063, -0.02800043113529682, -0.011437371373176575, 0.03582528233528137, -0.0467582643032074, 0.05341075360774994, 0.006904682610183954, 0.03956048935651779, 0.0136934919282794, -0.013495825231075287, 0.015118051320314407, -0.02008015289902687, 0.03972407802939415, -0.0030876812525093555, 0.0403238907456398, -0.07552209496498108, 0.013666227459907532, -0.01751730963587761, -0.04340475797653198, -0.01778995245695114, -0.019766613841056824, 0.004440671764314175, -0.007061452139168978, 0.04700364172458649, 0.027850477024912834, 0.003270011395215988, 0.030154310166835785, -0.019930198788642883, -0.03972407802939415, 0.021797804161906242, 0.00604244926944375, 0.011846335604786873, 0.020230107009410858, -0.01500899437814951, 0.0021777355577796698, 0.01250749547034502, 0.038388125598430634, -0.019030477851629257, 0.010271823033690453, -0.06172636151313782, -0.018444295972585678, -0.028273073956370354, -0.031517524272203445, -0.030726859346032143, -0.011226072907447815, -0.01037406362593174, -0.016181359067559242, 0.0493483729660511, -0.00652979826554656, 0.01446370780467987, 0.017380988225340843, -0.029990723356604576, 0.020434588193893433, 0.024469703435897827, 0.025069518014788628, -0.007211405783891678, 0.03481650352478027, -0.04449532926082611, 0.03855171054601669, 0.0068978662602603436, -0.03446206822991371, 0.03991492837667465, 0.003990811295807362, -0.036452360451221466, -0.046076659113168716, 0.004239597823470831, -0.054228682070970535, 0.040542006492614746, -0.0029905522242188454, -0.05638255923986435, -0.062598817050457, -0.0017074263887479901, -0.014231961220502853, 0.02185233123600483, 0.026173721998929977, -0.017217401415109634, 0.0061787706799805164, -0.016740277409553528, -0.014218329451978207, 0.02346092462539673, 0.038142748177051544, -0.04948469251394272, 0.00544263469055295, 0.004931429401040077, 0.014899936504662037, -0.022411249577999115, 0.03563443198800087, 0.007020555902272463, -0.034243952482938766, -0.03353508189320564, -0.0229701679199934, 0.0030280407518148422, -0.02467418648302555, 0.024278854951262474, 0.020025623962283134, -0.030399687588214874, -0.03361687436699867, -0.014790879562497139, -0.04337749257683754, -3.0246326787164435e-05, -0.026596318930387497, 0.0114850839599967, -0.0665794089436531, 0.018253445625305176, -0.048775821924209595, -0.024892300367355347, -0.05610991641879082, -0.015540647320449352, 0.017885377630591393, -0.0336986668407917, -0.02952723018825054, 0.019752981141209602, 0.02134794183075428, -0.028191279619932175, -0.0053710658103227615, 0.018825994804501534, 0.019248591735959053, 0.014122904278337955, 0.024865036830306053, 0.06876055151224136, -0.034843768924474716, -0.01470908708870411, -0.056764259934425354, -0.039342377334833145, 0.01139647513628006, -0.0035852547734975815, -0.010333167389035225, -0.05621897429227829, -0.014899936504662037, -0.037379346787929535, -0.029200058430433273, -0.04722175747156143, 0.03664321079850197, -0.05191121622920036, -0.03538905456662178, 0.04654014855623245, -0.006499126087874174, -0.010387696325778961, -0.04076011851429939, 0.004587217699736357, -0.033807724714279175, 0.03549811244010925, 0.03045421652495861, 0.028518451377749443, 0.027864107862114906, 0.03258083015680313, 0.06837885081768036, -0.035170938819646835, -0.027509672567248344, -0.02534216083586216, 0.041877955198287964, 0.009774249978363514, 0.03410763293504715, -0.007715795189142227, 0.014899936504662037, 0.03795189782977104, 0.06674299389123917, -0.01641310565173626, 0.02626914717257023, -0.00013770598161499947, -0.0015285045374184847, -0.0065195742063224316, 0.00032589351758360863, 0.02066633477807045, 0.0022118159104138613, 0.03029063157737255, 0.028600243851542473, -0.0071364291943609715, -0.016031404957175255, 0.000574254197999835, -0.030154310166835785, 0.02509678341448307, 0.024128900840878487, 0.015240740962326527, 0.027877740561962128, 0.008908607997000217, 0.013666227459907532, 0.02108893170952797, -0.029827138409018517, 0.04542231559753418, 0.01589508354663849, -0.015036257915198803, 0.05163857340812683, -0.054719436913728714, -0.0072182221338152885, 0.0037658805958926678, -0.025492114946246147, -0.04670373722910881, 0.014095639809966087, -0.000673087255563587, -0.005326761398464441, 0.006243523210287094, -0.03258083015680313, -0.07552209496498108, -0.011055671609938145, -0.0041543967090547085, -0.03896067664027214, -0.029281852766871452, -0.017803583294153214, 0.017844481393694878, -0.06358033418655396, -0.044195421040058136, 0.020134681835770607, 0.07732153683900833, -0.025464851409196854, -0.05444679409265518, -0.010687603615224361, -0.00858825258910656, -0.04024209827184677, 0.020298266783356667, -0.019412176683545113, 0.002356657525524497, -0.02686896175146103, -0.009590215981006622, -0.005987920798361301, -0.02363814227283001, -0.013236815109848976, 0.03776104748249054, 0.008738206699490547, 0.006945578847080469, -0.01607230119407177, 0.004515648819506168, -0.015036257915198803, -0.030263366177678108, 0.005394922103732824, -0.03113582357764244, 0.019780244678258896, 0.02082992158830166, -0.026896227151155472, -0.027032548561692238, 0.00114850839599967, 0.022056814283132553, -0.06347128003835678, -0.002389033790677786, -0.018144387751817703, -0.03277168050408363, 0.04168710485100746, 0.039178792387247086, -0.007075084373354912, -0.016358576714992523, 0.010087789036333561, 0.014231961220502853, -0.00618558656424284, -0.015036257915198803, 0.027700522914528847, 0.03113582357764244, 0.01998472772538662, -0.06467090547084808, 0.015867820009589195, 0.020175578072667122, 0.021634217351675034, -0.015349797904491425, -0.017462780699133873, -0.01751730963587761, 0.05049347132444382, 0.05987238883972168, 0.03334423154592514, -0.018008066341280937, -0.007886197417974472, 0.019848406314849854, 0.01905774138867855, -0.009372101165354252, -0.006795625202357769, -0.016603955999016762, 0.035934340208768845, 0.04416815564036369, -0.039751339703798294, 0.01139647513628006, -0.035688962787389755, -0.010053708218038082, 0.07492227852344513, -0.027264295145869255, -0.0223703533411026, -0.033725932240486145, 0.002140247030183673, -0.024210693314671516, 0.006407109089195728, -0.024524232372641563, 0.05845464766025543, -0.030590537935495377, -0.015513383783400059, 0.01608593389391899, -0.01007415633648634, -0.021743275225162506, 0.020107416436076164, 0.005081383045762777, 0.004982549697160721, -0.00212491094134748, -0.0425322987139225, -0.03574348986148834, -0.0545831173658371, 0.017149241641163826, 0.05409235879778862, 0.04907573014497757, -0.0758492648601532, -0.013393584638834, 0.03045421652495861, -0.01761273480951786, -0.013066412881016731, 0.04866676405072212, 0.020775392651557922, -0.001069271587766707, 0.06946942210197449, 0.025042254477739334, 0.005728909745812416, -0.011123832315206528, 0.04430447891354561, -0.0251785758882761, 0.04923931509256363, -0.0006002404843457043, 0.027496041730046272, -0.07530397921800613, -0.030808651819825172, 0.03732481971383095, -0.04378645494580269, 0.019712084904313087, -0.0013257262762635946, -0.011730462312698364, -0.010040076449513435, 0.008833630941808224, 0.002017557853832841, -0.00012769487511832267, -0.04416815564036369, -0.018498823046684265, 0.015445223078131676, 0.057636719197034836, -0.032362718135118484, -0.023092856630682945, -0.01897594891488552, -0.03898794203996658, 0.007749875541776419, 0.02857298031449318, 0.004140764474868774, 0.01930312067270279, 0.013045964762568474, 0.018048962578177452, -0.02560117281973362, -0.0023839217610657215, 0.03337149694561958, 0.02542395517230034, 0.01665848307311535, -0.01547248661518097, -0.017558205872774124, -0.023161018267273903, -0.00629123579710722, 0.022602099925279617, -0.001375142834149301, 0.015322533436119556, 0.019016845151782036, 0.04948469251394272, 0.01428649015724659, 0.03579801693558693, 0.026732640340924263, 0.004018075298517942, 0.003581846598535776, -0.047167230397462845, -0.04645835608243942, -0.0167539082467556, -0.03511641174554825, -0.04539505019783974, 0.030808651819825172, 0.016467634588479996, 0.03999672085046768, 0.02415616437792778, 0.024769611656665802, 0.005214296281337738, 0.047685250639915466, -0.04803968593478203, 0.03947869688272476, -0.0031558419577777386, 0.05349254608154297, 0.021906860172748566, 0.043595608323812485, 0.0523747093975544, -0.017162872478365898, 0.00454972917214036, -0.04501334950327873, -0.010019628331065178, -0.027877740561962128, 2.3390315618598834e-05, 0.026500893756747246, -0.019943831488490105, 0.01237798947840929, -0.06265334784984589, -0.02620098739862442, 0.027005283161997795, 0.05433773994445801, -0.02977260947227478, -0.021579688414931297, 0.00232768920250237, -0.0030041844584047794, 0.0025594355538487434, 0.010142317041754723, -0.04190522059798241, 0.017653631046414375, -0.0006228187121450901, 0.021048035472631454, -0.00044560080277733505, -0.002182847587391734, 0.03438027575612068, 0.011341946199536324, -0.032280925661325455, 0.02626914717257023, -0.03707943856716156, 0.030808651819825172, 0.00978788174688816, 0.03947869688272476, 0.04602212831377983, -0.024769611656665802, -0.03097223863005638, 0.08620969951152802, -0.015540647320449352, 0.029390908777713776, -0.004941653460264206, 0.03819727525115013, -0.00024814766948111355, -0.037106703966856, -0.0008170768269337714, -0.013972951099276543, -0.006168546620756388, 0.01650853082537651, -0.0006505090277642012, -0.009113090112805367, 0.02670537680387497, 0.019521234557032585, -0.00257477187551558, 0.036370567977428436, -0.011212441138923168, -0.01778995245695114, 0.04983913153409958, 0.02508315071463585, -0.017735423520207405, 0.01770815998315811, 0.007231853902339935, 0.036888591945171356, -0.03549811244010925, 0.026814432814717293, -0.011457819491624832, 0.02348819002509117, 0.06587053835391998, 0.06107201799750328, -0.018676040694117546, -0.013032332994043827, -0.06308957934379578, -0.008411034941673279, -0.04228692129254341, 0.018307974562048912, -0.016045037657022476, 0.03675226867198944, 0.03487103059887886, 0.0032001466024667025, -0.002532171318307519, 0.018389767035841942, 0.015554280020296574, 0.01870330609381199, -0.015145315788686275, -0.004021483473479748, -0.019289487972855568, 0.019957464188337326, -0.003053600899875164, 0.016862966120243073, -0.010953430086374283, -0.007306830957531929, -0.004215741530060768, -0.013434480875730515, 0.0014296714216470718, -0.02527400106191635, -0.006424149498343468, -0.0403238907456398, 0.009167619049549103, -0.034407541155815125, 0.03735208138823509, -0.020216474309563637, 0.007000107783824205, -0.010224110446870327, -0.007565841544419527, -0.0036363753024488688, -0.0008388030692003667, 0.02347455732524395, -0.03735208138823509, -0.033889517188072205, -0.09128085523843765, -0.024905933067202568, -0.019780244678258896, 0.013127758167684078, -0.015336165204644203, -0.03334423154592514, 0.03378045931458473, -0.013229998759925365, -0.0012260412331670523, 0.0040453397668898106, 0.016304047778248787, -0.03519820421934128, -0.019712084904313087, 0.0012149651302024722, -0.011423739604651928, 0.014450076036155224, 0.002862751018255949, -0.01582692377269268, -0.023120122030377388, 0.042668621987104416, -0.0061276499181985855, -0.013379952870309353, -0.010087789036333561, 0.02314738556742668, -0.0006036485428921878, 0.01650853082537651, -0.030645066872239113, -0.040787383913993835, 0.018144387751817703, 0.0036602315958589315, 0.02108893170952797, -0.010149133391678333, 0.011635037139058113, 0.03514367714524269, -0.00829516164958477, -0.00800207071006298, -0.017326459288597107, 0.01370030827820301, 0.01949397101998329, 0.03416216000914574, -0.02960902452468872, 0.00990375503897667, 0.007668082602322102, -0.02271115779876709, -0.03560716658830643, 0.012050817720592022, -0.016290415078401566, -0.0019766613841056824, -0.029745345935225487, -0.016890229657292366, -0.010994326323270798, 0.007524945307523012, 0.014354650862514973, -0.014777247793972492, -0.028627509251236916, -0.03541631996631622, -0.03293526917695999, -0.022997431457042694, 0.036179717630147934, -0.011723646894097328, -0.00704100402072072, -0.016522161662578583, 0.015417958609759808, 0.010639891028404236, -0.0073409113101661205, 0.012943724170327187, 0.007620370481163263, -0.014954465441405773, 0.0009542502812109888, 0.02960902452468872, -0.0026940531097352505, -0.03555263951420784, -0.023801729083061218, 0.02220676839351654, 0.0009653264423832297, -0.009297124110162258, -0.004416815470904112, -0.03315338119864464, -0.0005026854341849685, -0.027755051851272583, 0.013264079578220844, 0.019016845151782036, 0.008826815523207188, -0.005647116806358099, 0.016372209414839745, -0.019603027030825615, -0.03383499011397362, -0.0605812631547451, -0.028736567124724388, -0.027768684551119804, 0.0023345050867646933, 0.03293526917695999, 0.004011259414255619, 0.024796875193715096, -0.03402584046125412, -0.007381807547062635, -0.0027622138150036335, 0.02092534676194191, 0.008642781525850296, -0.021634217351675034, -0.017912641167640686, 0.002714501228183508, 0.007668082602322102, -0.003060417016968131, 0.0245787613093853, -0.009256227873265743, 0.0049927737563848495, -0.015881450846791267, 0.02857298031449318, 0.0043554711155593395, -0.008567804470658302, -0.021211620420217514, 0.006154914386570454, 0.004696274641901255, 0.008513275533914566, 0.0016307455953210592, -0.04746713489294052, 0.01488630473613739, -0.030072515830397606, -0.006986475549638271, 0.004648562055081129, -0.00450542476028204, -0.015254372730851173, -0.027536937966942787, -0.029908930882811546, 0.023610878735780716, -0.008826815523207188, 0.016017772257328033, -0.01753094047307968, -0.02118435688316822, -0.01530890166759491, 0.012650632299482822, -0.004761027172207832, -0.01727193035185337, -0.0336986668407917, -0.03263536095619202, -0.005715277511626482, 0.0019613250624388456, 0.03290800377726555, 0.022165872156620026, 0.02262936346232891, -0.0229701679199934, -0.01228938065469265, -0.0613991916179657, 0.030672330409288406, 0.004089644178748131, -0.01727193035185337, -0.012473414652049541, 0.01547248661518097, -0.05452859029173851, -0.05251103267073631, 0.008990401402115822, 0.05501934513449669, -0.03225366026163101, -0.007893012836575508, -0.055346518754959106, -0.055401045829057693, 0.0008758654585108161, -0.015581544488668442, 0.03429848328232765, 0.016903862357139587, 0.015540647320449352, 0.0027298375498503447, -0.007422704249620438, 0.0012780138058587909, 0.038333598524332047, -0.06745186448097229, -0.01600414142012596, -0.0043009426444768906, -0.01119199302047491, 0.016290415078401566, -0.025546643882989883, -0.01847155950963497, -0.025042254477739334, -0.008458747528493404, -0.024115268141031265, -0.032362718135118484, -0.025737494230270386, -0.00459403358399868, -0.018267076462507248, 0.015404325909912586, 0.03301706165075302, -0.010612626560032368, 0.014531868509948254, 0.03399857506155968, -0.01408200804144144, -0.03217186778783798, -0.043840985745191574, 0.026909857988357544, 0.005728909745812416, -0.026732640340924263, -0.005159767810255289, -0.020366428419947624, -0.006505942437797785, 0.005088198930025101, -0.05411962419748306, -0.003249563043937087, 0.018239812925457954, 0.013748020865023136, -0.03097223863005638, 0.014777247793972492, -0.02202954888343811, 0.013857077807188034, 0.01897594891488552, 0.05801841989159584, 0.0080770468339324, -0.05052073672413826, -0.028382129967212677, 0.015499751083552837, -0.025832919403910637, -0.0086768614128232, -0.019344016909599304, -0.0015966652426868677, -0.002646340522915125, -0.03078138828277588, -0.049893658608198166, 0.02900920994579792, 0.00948115810751915, -0.0323081873357296, 0.0034881257452070713, 0.016140462830662727, -0.005074566695839167, -0.035170938819646835, -0.0029155754018574953, 0.01160777360200882, -0.014354650862514973, -0.008526908233761787, 0.027250662446022034, -0.014450076036155224, -0.00031779942219145596, -9.760830289451405e-05, 0.005139319691807032, -0.007197773549705744, -0.019548499956727028, 0.025396689772605896, -0.010033260099589825, 0.006355988793075085, 0.011873600073158741, 0.020052889361977577, -0.022165872156620026, 0.0037215761840343475, 0.028436658903956413, 0.0012038890272378922, 0.0018539719749242067, -0.03386225178837776, 0.020884448662400246, -0.0015651409048587084, 0.048530444502830505, -0.04073285683989525, -0.009263044223189354, 0.03113582357764244, -0.005193848162889481, 0.01624951884150505, 0.00043665472185239196, -0.028382129967212677, -0.011621405370533466, 0.004563361406326294, -0.023542718961834908, 0.01649489812552929, -0.0008251708932220936, 0.025151312351226807, 0.003680679714307189, -0.03165384754538536, -0.016126830130815506, -0.012425702065229416, -0.029499966651201248, 0.003527318127453327, 0.008929056115448475, -0.009426630102097988, -0.0018693081801757216, -0.10889358818531036, 0.003949914593249559, 0.03132667392492294, -0.033044323325157166, -0.01999836042523384, 0.010878453031182289, 0.022015918046236038, 0.01693112589418888, 0.020720863714814186, -0.006567286793142557, -0.008451931178569794, 0.0002447396400384605, 0.016726644709706306, -0.028273073956370354, -0.0105853620916605, -0.0381154827773571, -0.017994433641433716, 0.0010939798085018992, 0.016099566593766212, -0.01853971928358078, -0.002956471871584654, -0.027605097740888596, -0.02238398604094982, -0.008458747528493404, 0.005500571336597204, -0.01708108000457287, 0.0021641033235937357, -0.005762990098446608, 0.009672008454799652, -0.0014364875387400389, 0.01127378549426794, 0.03053600899875164, 0.0006526390207000077, 0.02933637984097004, -0.0515567809343338, -0.008935872465372086, -0.008670045994222164, -0.011682749725878239, 0.02626914717257023, 0.018158020451664925, 0.009535687044262886, -0.06848790496587753, 0.006601367145776749, 0.0019340608268976212, 0.027264295145869255, -0.034053102135658264, 0.04305031895637512, -0.012384805828332901, -0.0008285789517685771, -0.006120834033936262, -0.019248591735959053, 0.003067233134061098, -0.0016409697709605098, -0.002448674524202943, -0.010053708218038082, 0.030127044767141342, 0.01889415644109249, -0.02849118784070015, 0.0038135931827127934, -0.010783028788864613, 0.014681822620332241, 0.01631768047809601, 0.021811434999108315, -0.02542395517230034, -0.02230219356715679, -0.03846991807222366, 0.030127044767141342, 0.018989581614732742, -0.007981622591614723, -0.03018157370388508, 0.014054743573069572, 0.00828834529966116, 0.029990723356604576, 0.030045252293348312, 0.012180323712527752, 0.013618514873087406, -0.022261295467615128, 0.037297554314136505, -0.021838700398802757, 0.005527835804969072, 0.06368938833475113, -0.010067340917885303, -0.011055671609938145, 0.014041111804544926, 0.01751730963587761, -0.012364357709884644, 0.05807294696569443, 0.0009184658993035555, -0.0321173369884491, 0.01980751007795334, 0.02440154366195202, -0.0345165953040123, -0.009760617278516293, 0.026773536577820778, -0.028600243851542473, -0.02178417146205902, 0.03487103059887886, 0.014327386394143105, 0.013713940046727657, 0.008356506004929543, 0.04542231559753418, 0.017299193888902664, -0.019916566088795662, -0.03342602401971817, 0.00114850839599967, -0.03206280991435051, 0.003000776283442974, -0.02849118784070015, -0.008560988120734692, 0.008745022118091583, -0.028600243851542473, 0.0072591183707118034, -0.00618558656424284, 0.01957576349377632, 0.005906127858906984, 0.023610878735780716, 0.0722503811120987, 0.02543758600950241, 0.04378645494580269, -0.014395547099411488, 0.005244968459010124, 0.04703090712428093, -0.014518236741423607, 0.014654558151960373, -0.04397730529308319, 0.015758762136101723, 0.009004033170640469, 0.054392267018556595, 0.018389767035841942, -0.005268824752420187, -0.031108560040593147, 0.04264135658740997, -0.008172472007572651, -0.025655701756477356, -0.005060934461653233, -0.0034421172458678484, -0.003356916131451726, 0.028191279619932175, -0.03574348986148834, 0.03241724520921707, 0.008336057886481285, 0.017980802804231644, 0.02594197541475296, 0.010190029628574848, -0.0011348762782290578, 0.0037761046551167965, -0.026391837745904922, -0.006011777091771364, -0.01699928753077984, 0.005912943743169308, 0.040105778723955154, -0.025410322472453117, 0.012732425704598427, -0.005122279282659292, -0.005285865161567926, -0.006424149498343468, -0.01416380051523447, -0.024524232372641563, 0.023092856630682945, 0.03904246911406517, 0.041550785303115845, 0.04904846474528313, 0.011423739604651928, -0.01717650517821312, 0.03986039757728577, -0.026841698214411736, -0.01965755596756935, -0.02059817500412464, -0.009535687044262886, 0.009522054344415665, -0.02288837544620037, 0.0034489331301301718, 0.037542931735515594, 0.01870330609381199, 0.07219585031270981, 0.008479195646941662, 0.0047337631694972515, 0.01683570258319378, -0.011737278662621975, 0.04634930193424225, 0.026010137051343918, -0.0027093891985714436, -0.006420741323381662, 0.005152951460331678, 0.00113743229303509, -0.04531325772404671, 0.016713012009859085, 0.033398762345314026, 0.012255299836397171, -0.0005316537572070956, 0.0009891827357932925, 0.03846991807222366, 0.02652815915644169, 0.04378645494580269, -0.0044236318208277225, -0.0008221888565458357, -0.008008886128664017, 0.036452360451221466, -0.02620098739862442, -0.019371280446648598, -0.0449315570294857, 0.02524673566222191, -0.03241724520921707, 0.008819999173283577, 0.014777247793972492, 0.009835594333708286, 0.0011399883078411222, 0.026337308809161186, -0.020979873836040497, -0.0011723646894097328, -0.015172579325735569, -0.01803532987833023, -0.03887888416647911, 0.054065097123384476, -0.013366320170462132, -0.026241883635520935, -0.0017219105502590537, 0.020966242998838425, 0.013652595691382885, -0.01998472772538662, -0.02058454230427742, -0.01106248702853918, 0.007599921897053719, -0.01693112589418888, -0.008867711760103703, -0.0046144817024469376, 0.02466055378317833, 0.030127044767141342, 0.00040789940976537764, 0.01847155950963497, -0.007088716607540846, 0.02925458736717701, 0.003534134244546294, -0.04340475797653198, -0.0006108906236477196, -0.0007540281512774527, -0.024387910962104797, -0.022929271683096886, -0.04111455753445625, 0.005728909745812416, 0.038578975945711136, 0.0015498046996071935, 0.0014927200973033905, -0.01802169904112816, -0.009119906462728977, -0.02800043113529682, 0.007572657894343138, 0.02134794183075428, -0.0007510461146011949, 0.009842410683631897, -0.012527943588793278, 0.03427121788263321, 0.020352795720100403, 0.007122796960175037, 0.017585469409823418, 0.015867820009589195, 0.021647850051522255, 0.031163088977336884, 0.015963245183229446, 0.013523089699447155, -0.008097494952380657, 0.003926058299839497, -0.003152434015646577, -0.0323081873357296, 0.016972023993730545, -0.02313375286757946, -0.015431590378284454, -0.0034404131583869457, -0.002026077825576067, 0.019112270325422287, -0.031353939324617386, 0.03217186778783798, -0.01539069414138794, 0.037297554314136505, 0.007027371786534786, -0.007640818599611521, 0.02431975118815899, -0.03563443198800087, 0.012357541359961033, 0.00948797445744276, -0.03686132654547691, 0.010421776212751865, -0.019548499956727028, -0.010864821262657642, -0.004502016585320234, -0.009746985509991646, -0.0064343735575675964, -0.011934944428503513, -0.0009423221927136183, -0.003067233134061098, 0.05144772306084633, 0.03217186778783798, -0.005023446399718523, 0.023828992620110512, -0.022942904382944107, -0.014218329451978207, 0.021743275225162506, 0.012827850878238678, -0.0014756799209862947, -0.023011064156889915, 0.024101635441184044, 0.017721790820360184, 0.030645066872239113, -0.03132667392492294, 0.013877525925636292, 0.03154478967189789, 0.024142533540725708, 0.00495528569445014, -0.02313375286757946, -0.023828992620110512, 0.006533206440508366, 0.029363645240664482, 0.024019842967391014, 0.020434588193893433, 0.012766505591571331, 0.004890532698482275, -0.021579688414931297, -0.013045964762568474, 0.013945686630904675, 0.0034250770695507526, 0.00029884223476983607, -0.011082936078310013, -0.0117849912494421, 0.010987510904669762, -0.025914711877703667, -0.06597959250211716, -0.024197060614824295, 0.004583809524774551, 0.00020565371960401535, 0.01029227115213871, 0.017312826588749886, 0.03855171054601669, 0.0014867560239508748, -0.0014415995683521032, -0.02737335115671158, 0.019180431962013245, 0.0043588788248598576, -0.017844481393694878, -0.009651560336351395, -0.028545716777443886, 0.008690494112670422, 0.015840554609894753, -0.014027479104697704, -0.004256637766957283, -0.023447293788194656, 0.025219472125172615, -0.0035682145971804857, -0.008029334247112274, -0.02900920994579792, -0.016944758594036102, 0.09275312721729279, -0.011764543130993843, -0.015417958609759808, -0.005009814165532589, -0.0031848102807998657, 0.02603740058839321, 0.0065843272022902966, -0.04506788030266762, -0.02371993660926819, 0.0027110932860523462, -0.019289487972855568, 0.03928784653544426, 0.02610556222498417, 0.028954681009054184, 0.014054743573069572, 0.014300121925771236, 0.005030262283980846, 0.04144172742962837, 0.005855007097125053, 0.0004076863988302648, 0.008172472007572651, -0.02960902452468872, -0.012950539588928223, -0.007811220362782478, -0.02925458736717701, -0.00222203996963799, 0.02389715425670147, 0.010837556794285774, 0.014395547099411488, 0.0025406915228813887, 0.018580617383122444, -0.0223703533411026, -0.02876383066177368, -0.001526800449937582, 6.869323988212273e-05, -0.007477232720702887, -0.003953322768211365, 0.03871529921889305, -0.01699928753077984, -0.01599050872027874, -0.015295268967747688, 0.014818144030869007, 0.016862966120243073, 0.020093785598874092, 0.007777140010148287, 0.027250662446022034, 0.029036473482847214, 0.017571838572621346, 0.0223703533411026, -0.04918478801846504, 0.03146299719810486, -0.014041111804544926, 0.025805654004216194, 0.005902719683945179, 0.028518451377749443, -0.023924417793750763, 0.01130786631256342, 0.00888815987855196, 0.01743551529943943, 0.0011987769976258278, -0.03803369030356407, -0.012016737833619118, -0.051229607313871384, -0.00565393315628171, -0.020530013367533684, -0.04689458757638931, 0.011825887486338615, 0.022397616878151894, 0.007047819904983044, 0.017367355525493622, 0.0061276499181985855, 0.029063737019896507, -6.166416278574616e-05, -0.016903862357139587, 0.01071486808359623, 0.011539612896740437, -0.025710228830575943, -0.017626365646719933, 0.008486011996865273, 0.01548611931502819, -0.012548391707241535, -0.016563057899475098, -0.024960462003946304, -0.02065270207822323, 0.010060524567961693, 0.0031984425149858, 0.02960902452468872, 0.016549427062273026, 0.010817108675837517, 0.037052176892757416, -0.019793877378106117, -0.006086753681302071, 0.024510599672794342, -0.009549318812787533, 0.005081383045762777, -0.006495717912912369, -0.016031404957175255, -0.036970384418964386, -0.009385732933878899, 0.02084355242550373, 0.0041680289432406425, -0.04285947233438492, 0.01770815998315811, 0.026051033288240433, -0.0010351911187171936, -0.007790772244334221, -0.04662194475531578, -0.01398658286780119, 0.0157451294362545, 0.005071158520877361, -0.012398437596857548, -0.005647116806358099, -0.0010658635292202234, -0.021756906062364578, -0.024960462003946304, 0.028027694672346115, 0.014272858388721943, 0.020979873836040497, -0.013386768288910389, -0.014872672967612743, 0.01871693879365921, 0.029827138409018517, 0.03274441882967949, 0.01573149859905243, -0.017162872478365898, 0.015935979783535004, -0.022642996162176132, 0.0009934427216649055, 0.005401738453656435, -0.015404325909912586, 0.003929466474801302, -0.010012811981141567, -0.0014680118765681982, -0.01246659830212593, -0.011648669838905334, 0.023420028388500214, 0.016208622604608536, -0.03481650352478027, -0.017380988225340843, 0.012630184181034565, -0.011628221720457077, 0.02884562313556671, -0.03309885412454605, -0.04517693445086479, 0.0008758654585108161, 0.008349690586328506, -0.010605810210108757, -0.02339276485145092, 0.010830741375684738, 0.009017664939165115, 0.001410075230523944, -0.010046892799437046, -0.01972571760416031, -0.01050356961786747, 0.00121240911539644, -0.0021266150288283825, 0.031026767566800117, -0.001775587210431695, 0.04168710485100746, -0.001130616175942123, 0.04441353678703308, 0.003024632576853037, -0.001993701560422778, 0.03702491149306297, 0.04135993495583534, -0.006594551261514425, -0.018144387751817703, 0.019930198788642883, 0.028109487146139145, 0.01564970426261425, -0.003667047480121255, 0.013952502980828285, 0.04065106436610222, 0.008642781525850296, -0.034407541155815125, -0.008254265412688255, -0.022070446982979774, 0.04381372034549713, -0.0025952199939638376, 0.016549427062273026, -0.01020366232842207, -0.0030791612807661295, 0.004525872878730297, 0.018089858815073967, 0.0014790879795327783, 0.017626365646719933, 0.01220758818089962, 0.00580388680100441, 0.0019340608268976212, 0.010469488799571991, 0.00026497486396692693, -0.007640818599611521, -0.009760617278516293, -0.008547356352210045, 0.032280925661325455, 0.0016358576249331236, -0.002193071646615863, -0.009821961633861065, 0.0008102607680484653, 0.02262936346232891, -0.011437371373176575, -0.018485192209482193, 0.035934340208768845, -0.018989581614732742, 0.04888487979769707, -0.003334763925522566, -0.014790879562497139, -0.0273869838565588, 0.003067233134061098, 0.008261080831289291, 0.021716009825468063, -0.013216366991400719, 0.01216669101268053, 0.00414417264983058, 0.05504661053419113, -0.030317895114421844, -0.021756906062364578, -0.0004260046116542071, -0.025369426235556602, -0.033044323325157166, -0.010748947970569134, 0.0010351911187171936, 0.0034932377748191357, 0.009740169160068035, -0.008731390349566936, -0.00039575828122906387, -0.01904410868883133, 0.006090161856263876, -0.01509078685194254, 0.0030127044301480055, -0.00030906632309779525, -0.02399257943034172, -0.009194883517920971, 0.016822069883346558, 0.025151312351226807, -6.150441186036915e-05, 0.022929271683096886, -0.021811434999108315, -0.009276675991714, 0.012834666296839714, -0.028382129967212677, -0.013618514873087406, 0.0038272254168987274, 0.0013555466430261731, 0.037106703966856, 0.024047108367085457, -0.002992256311699748, 0.022561203688383102, -0.002118094824254513, -0.0066252234391868114, -0.00880636740475893, -0.024796875193715096, 0.006114018149673939, -0.05147498846054077, 0.018512455746531487, -0.03097223863005638, 9.525196219328791e-06, 0.008779102936387062, 0.037297554314136505, 0.0037897368893027306, -0.012875562533736229, -0.012023554183542728, -0.011007959023118019, -0.00888815987855196, -0.02058454230427742, 0.013877525925636292, -0.014490972273051739, -0.00629805214703083, -0.020025623962283134, -0.006938762962818146, 0.006979659199714661, 0.029745345935225487, -0.023283706977963448, 0.0019136127084493637, 0.0023021288216114044, 0.017585469409823418, 0.002930911723524332, -0.03650689125061035, 0.017626365646719933, 0.014136536978185177, 0.04337749257683754, -0.008111127652227879, -0.018594248220324516, 0.01438191533088684, -0.021729642525315285, 0.0014160393038764596, -0.016549427062273026, 0.005394922103732824, 0.011389658786356449, 0.022097710520029068, 0.03530726209282875, 0.004369103349745274, 0.009801513515412807, -0.018335238099098206, 0.0011272081173956394, 0.004127132706344128, 0.012555207125842571, -0.020298266783356667, 0.006526390556246042, 0.006751320790499449, -0.016822069883346558, 0.009528870694339275, 0.004498608410358429, -0.0010147430002689362, -0.004757619462907314, 0.018185283988714218, -0.0120848985388875, 0.014954465441405773, 0.024728715419769287, -0.020516380667686462, -0.012350725010037422, -0.005756174214184284, -0.015145315788686275, 0.015036257915198803, 0.0068262978456914425, -0.027168869972229004, -0.022002285346388817, -0.01237798947840929, -0.03206280991435051, 0.06641582399606705, -0.01021047867834568, 0.002245896263048053, 0.006856970023363829, -0.04321390762925148, 0.03538905456662178, 0.0012200771598145366, 0.02399257943034172, -0.015499751083552837, 0.0073954397812485695, -0.02892741560935974, 0.014041111804544926, 0.006850154139101505, -0.0017875152407214046, -0.022329457104206085, 0.0041680289432406425, 0.027414247393608093, -0.012187139131128788, 0.00544263469055295, 0.01949397101998329, -0.006240115500986576, -0.02220676839351654, 0.011253337375819683, -0.04135993495583534, 0.0015889971982687712, -0.0006441189325414598, 0.029390908777713776, -0.02729155868291855, 0.0054221865721046925, -0.02925458736717701, 0.024524232372641563, 0.02024373784661293, 0.05062979459762573, -0.009297124110162258, -0.0335078164935112, 0.015063522383570671, 0.01597687602043152, 0.02238398604094982, -0.017735423520207405, -0.0049757338128983974, -0.026091929525136948, -0.011457819491624832, -0.014395547099411488, 0.006393476855009794, 0.008063415065407753, 0.02230219356715679, -0.027264295145869255, 0.011505532078444958, -0.038333598524332047, 0.015840554609894753, 0.008520091883838177, -0.024033475667238235, 0.04122361168265343, 0.0009866266045719385, -0.006321908440440893, -0.004795107990503311, 0.012984620407223701, -0.013932053931057453, -0.0007041856297291815, 0.010994326323270798, -0.007620370481163263, 0.016603955999016762, -0.03001798875629902, 0.03781557455658913, -0.014559132978320122, 0.017421884462237358, -0.0026872369926422834, -0.016644852235913277, 0.029118265956640244, -0.003588662715628743]",Online Speculative Decoding.pdf
" batch sizes, not
speculate altogether can result in higher goodput. This oc-
curs as the cost of unsuccessful speculations increases sig-
nificantly with larger batch sizes, outpacing the potential
gains.
Prefer batching over speculating. Consider a scenario
where the acceptance of tokens is independent, with each
token having a 0.7 probability of acceptance. In this case,
the probability of accepting the first token is 0.7, while the
5
probability of accepting both the first and second tokens
is 0.7√ó0.7 = 0.49. Consequently, increasing the batch size
tends to produce more tokens at the same cost. Doubling the
batch size results in twice the number of generated tokens,
whereas doubling the proposed length does not necessarily
yield a proportional increase in output.
Optimizing goodput reduces request latency. Request
latency consists of the request‚Äôs queueing delay and total
execution time. When the request rate is low, improving
goodput effectively reduces the overall execution time by
utilizing speculative decoding with an optimal proposed
length. On the other hand, at high request rates, optimizing
goodput helps decrease queueing delays by increasing the
system‚Äôs capacity to process requests through large batch
sizes and moderate speculative decoding. Overall, strategi-
cally adjusting batch sizes and proposed lengths based on
goodput enables managing both high and low demand sce-
narios effectively.
4.3 Modeling Batch Execution Time
The batch execution time is defined as the total time required
to complete a speculative decoding step, incorporating both
the draft and target model execution times. This can be math-
ematically represented as:
ùëáùëèùëéùë°ùëê‚Ñé=ùëáùëëùëüùëéùëìùë°+ùëáùë°ùëéùëüùëîùëíùë° (4)
Modelingùëáùëëùëüùëéùëìùë° andùëáùë°ùëéùëüùëîùëíùë° .For draft-model-free specu-
lative decoding, we assign a small constant factor ùëáùëëùëüùëéùëìùë° =ùê∂.
For draft model-based speculative decoding, the draft model
operates in an autoregressive manner and supports continu-
ous batching. Consequently, the total execution time for the
draft model is the aggregate of the execution times across all
draft steps. Each step involves a single forward pass of the
draft model. Given the variability in propose lengths across
different requests, the execution time per step may differ.
The draft model execution time is a sum of the execution
time of each forward pass:
ùëáùëëùëüùëéùëìùë° =ùë†‚àëÔ∏Å
ùëñ=1ùëáùëìùë§ùëë(ùëÄ,ùëÅùëêùëúùëõùë°ùëíùë•ùë°(ùë†),ùëÅùëèùëéùë°ùëê‚Ñéùëíùëë(ùë†)) (5)
Here,ùë†the number of autogressive steps. Concretely, ùë†=
ùëöùëéùë•(ùë†1,ùë†2,...ùë†ùëõ), whereùë†ùëñis the proposed length of request ùëñ
in the batch. The forward execution time, ùëáùëìùë§ùëë, varies across
different steps due to different numbers of context tokens
(ùëÅùëêùëúùëõùë°ùëíùë•ùë° ) and batched tokens ( ùëÅùëèùëéùë°ùëê‚Ñéùëíùëë ) at each step. It also
depends on the model ùëÄthe forward pass is running on.
These variations directly influence the duration of the for-
ward execution time, as outlined in Modelingùëáùëìùë§ùëë.below.
The target model executes a single forward pass for its
operation:
ùëáùë°ùëéùëüùëîùëíùë° =ùëáùëìùë§ùëë(ùëÅùëêùëúùëõùë°ùëíùë•ùë°,ùëÅùëèùëéùë°ùëê‚Ñéùëíùëë)","[-0.0046463762409985065, 0.012413173913955688, 0.03438069298863411, -0.031067190691828728, -0.0537136010825634, -0.00862631481140852, 0.012394488789141178, 0.016393112018704414, -0.0030020822305232286, -0.0009085658239200711, 0.057500459253787994, 0.024427730590105057, -0.06098835915327072, -0.02021734230220318, 0.012818018905818462, -0.022708695381879807, -0.004562292713671923, -0.009722510352730751, 0.0016474081203341484, 0.03393224626779556, -0.0020942948758602142, -0.0028915281873196363, 0.00485191261395812, 0.023879632353782654, 0.021512845531105995, -0.011018015444278717, 0.02693154104053974, 0.020341908559203148, 0.048083141446113586, -0.049528125673532486, -0.02300765924155712, -0.020591044798493385, -0.010058843530714512, -0.05485962703824043, 0.004291357938200235, 0.03754471242427826, -0.018722528591752052, -0.00426333025097847, 0.0033166157081723213, -0.017439480870962143, 0.018473394215106964, -0.03933848813176155, -0.10483619570732117, 0.007766797672957182, 0.007243613246828318, 0.032437436282634735, 0.03198898956179619, -0.02373015135526657, 0.014462312683463097, 0.061137840151786804, -0.0312914103269577, 0.03756962716579437, -0.014860928989946842, 0.038765475153923035, 0.006782712414860725, -0.011634625494480133, -0.00016154877084773034, 0.015446397475898266, 0.04422154277563095, 0.01504778116941452, 0.050126053392887115, -0.06666864454746246, -0.00892527773976326, 0.01616889052093029, -0.03649834170937538, -0.006262642331421375, -0.01136680506169796, 0.022546757012605667, -0.02817721851170063, 0.026109395548701286, -0.007106588687747717, -0.014636707492172718, 0.03709626942873001, -0.004727344959974289, -0.02817721851170063, 0.006639459636062384, 0.0241412241011858, 0.044844381511211395, 0.016467852517962456, 0.028276873752474785, 0.010519743897020817, -0.0017750900005921721, 0.033882420510053635, -0.021712154150009155, 0.008588944561779499, -0.037968240678310394, -0.03913917765021324, 0.003078379901126027, -0.002629935974255204, -0.07195031642913818, -0.016754359006881714, 0.036847133189439774, 0.00041340914322063327, 0.031839508563280106, 0.03186442330479622, 0.020591044798493385, 0.011591026559472084, -0.04917933791875839, 0.016156433150172234, -0.014250547625124454, 0.039687275886535645, 0.005670945625752211, 0.04785891994833946, -0.01604432240128517, 0.03330940753221512, -0.02837652713060379, -0.04110734909772873, 0.06118766590952873, -0.020902464166283607, -0.022795893251895905, -0.01494812685996294, 0.013216635212302208, -0.04561670124530792, 0.0038398001343011856, -0.024477558210492134, -0.05675305426120758, -0.05000148341059685, 0.012027014046907425, 0.003304158803075552, 0.014325288124382496, 0.02982151322066784, 0.004976480733603239, -0.0049546812660992146, -0.015471311286091805, -0.01917097344994545, 0.017539136111736298, 0.036847133189439774, -0.09218011796474457, 0.031640201807022095, -0.01016472652554512, -0.004113849252462387, -0.014935670420527458, 0.02181180752813816, -0.030120475217700005, -0.004665061365813017, -0.07339530438184738, -0.009996559470891953, 0.013602795079350471, -0.016218718141317368, 0.006250185426324606, 0.011647081933915615, -0.03694678843021393, -0.04935373365879059, 0.010550886392593384, -0.04334956780076027, 0.03901461139321327, -0.01993083581328392, -0.007193786092102528, -0.04631428048014641, 0.014586880803108215, -0.03814263641834259, -0.0198062676936388, -0.02989625371992588, -0.0397869311273098, 0.04165544733405113, -0.03609972447156906, -0.04514334350824356, 0.019781354814767838, 0.02253430150449276, -0.009971646592020988, -0.006957107223570347, 0.028924625366926193, 0.006527348887175322, 0.020229797810316086, 0.007617316208779812, 0.06223403289914131, -0.050126053392887115, -0.0014107294846326113, -0.04579109326004982, -0.04359870404005051, 0.031764768064022064, -0.013864387758076191, -0.0226962398737669, -0.045566871762275696, -0.0012355560902506113, -0.02429070696234703, -0.08291227370500565, -0.07175100594758987, 0.060340605676174164, -0.03420629724860191, -0.034604914486408234, 0.025075482204556465, -0.009043616242706776, 0.01511006522923708, -0.03166511654853821, -0.018784813582897186, -0.015384113416075706, 0.02108931541442871, 0.005334612913429737, 0.015371656976640224, 0.03330940753221512, 0.03114193119108677, 0.03213847428560257, -0.061935070902109146, -0.014487226493656635, -0.022621499374508858, 0.04287621006369591, 0.017227716743946075, 0.040085893124341965, 0.013702449388802052, 0.035626370459795, 0.01853567734360695, 0.03973710536956787, -0.0254118163138628, 0.022085856646299362, -0.007959877140820026, 0.014362658374011517, -0.009031159803271294, -0.02373015135526657, 0.016031866893172264, 0.009822164662182331, -0.023045029491186142, -0.0017844326794147491, -0.02942289598286152, -0.03522775322198868, -0.008314895443618298, -0.024004200473427773, 0.025685865432024002, -0.0004990494344383478, 0.023904545232653618, 0.02153776027262211, 0.0370713546872139, -0.001782875508069992, 0.02041664905846119, -0.03649834170937538, 0.06263265013694763, 0.018921837210655212, -0.016866469755768776, 0.04481946676969528, -0.04581600800156593, -0.0275792945176363, 0.008420778438448906, -0.016716988757252693, -0.016555050387978554, 0.015496225096285343, -0.006072676740586758, -0.006720428820699453, -0.04135648533701897, -0.01600695215165615, -0.09138288348913193, -0.02153776027262211, -0.0022095199674367905, -0.0029195561073720455, -0.0170906912535429, -0.054610490798950195, 0.0168166421353817, -0.03971219062805176, -0.0718008354306221, 0.018697615712881088, 0.05974268168210983, -0.010706596076488495, -0.06342988461256027, -0.013640165328979492, 0.026881715282797813, -0.02962220460176468, 0.029647117480635643, 0.00250692549161613, 0.0027311472222208977, -0.025710778310894966, 9.396104724146426e-05, -0.007361952215433121, -0.008096901699900627, 0.014287917874753475, 0.03749488294124603, -0.0405094251036644, 0.023306621238589287, 0.008177870884537697, -0.005586862564086914, 0.004001738037914038, -0.043200086802244186, 0.019307997077703476, -0.004817656707018614, -0.003786858869716525, 0.0023154024966061115, -0.03425612300634384, -0.011784106492996216, 0.009479603730142117, 0.005783056374639273, -0.044520504772663116, -0.00972873903810978, 0.017028408125042915, -0.016555050387978554, 0.043449223041534424, 0.006178559269756079, -0.007006934378296137, -0.005621118471026421, 0.029921166598796844, 0.003030109917744994, 0.005487208254635334, -0.006695515010505915, 0.018261628225445747, 0.010824935510754585, 0.012917673215270042, -0.07623544335365295, 0.03515301272273064, -0.011161267757415771, 0.009080987423658371, -0.004154333379119635, -0.012512828223407269, -0.018274085596203804, 0.016791729256510735, 0.04043468460440636, 0.05059940740466118, 0.014674077741801739, -0.005708315875381231, -0.019270626828074455, -0.0064276945777237415, 0.005424924194812775, 0.013116980902850628, -0.013415943831205368, 0.029721857979893684, 0.04987691715359688, -0.04045959562063217, -0.0029086563736200333, -0.010052614845335484, -0.009423548355698586, 0.05142155662178993, -0.018074776977300644, -0.003908312413841486, 0.005708315875381231, -0.01584501378238201, -0.02678206004202366, -0.02718067727982998, 0.0033571000676602125, 0.06253299862146378, -0.01933290995657444, -0.026308702304959297, 0.024116311222314835, 0.010700367391109467, -0.022384820505976677, -0.004593434743583202, 0.00757371773943305, 0.012263691984117031, -0.019183428958058357, -0.014138436876237392, -0.023431189358234406, -0.02797790989279747, 0.026283789426088333, 0.06527348607778549, 0.037644367665052414, -0.0732458233833313, -0.0005971465143375099, 0.013353659771382809, -0.02313222549855709, -0.007748112548142672, 0.012712135910987854, 0.020877551287412643, 0.017701072618365288, 0.025785518810153008, 0.0034816679544746876, -0.003945682663470507, 0.0018342597177252173, 0.03453017398715019, -0.014387572184205055, 0.03271148353815079, 0.003020767355337739, 0.009573029354214668, -0.06452608108520508, -0.0383419468998909, -0.004923539236187935, -0.00750520545989275, 0.03776893392205238, 0.026632579043507576, 0.012818018905818462, -0.009485832415521145, -0.0034162697847932577, -0.006901051849126816, 0.008159185759723186, -0.046164799481630325, -0.016629790887236595, 0.017140518873929977, 0.07748112082481384, -0.050126053392887115, -0.002611250849440694, -0.05979250743985176, -0.027529466897249222, -0.008103130385279655, 0.03898969665169716, 0.013440857641398907, 0.030369611456990242, -0.007710742298513651, -0.0013352102832868695, -0.007928735576570034, -0.0019245713483542204, 0.03983675688505173, 0.035078272223472595, 0.005736343562602997, -0.024265792220830917, -0.036323949694633484, -0.03166511654853821, -0.025710778310894966, 0.036000072956085205, 0.024029113352298737, 0.029123933985829353, -0.0198062676936388, 0.02273361012339592, 0.025760605931282043, 0.047485217452049255, 0.023244336247444153, 0.0069321938790380955, 0.006907280068844557, -0.026034655049443245, -0.036074813455343246, -0.016480309888720512, -0.002036682330071926, 0.014113523066043854, 0.005811084061861038, 0.0043442994356155396, 0.047211166471242905, 0.006156759802252054, 0.03181459754705429, -0.00428201537579298, 0.05610530078411102, -0.022546757012605667, 0.024913543835282326, -0.006465064827352762, 0.040883127599954605, 0.019432565197348595, 0.03383259475231171, 0.07030602544546127, -0.011410403065383434, -0.03228795528411865, -0.037968240678310394, 0.0009249153663404286, -0.1016472652554512, 0.02077789604663849, 0.058497004210948944, 0.0046463762409985065, 0.02069069817662239, -0.04357378929853439, -0.022982744500041008, -0.002133222296833992, 0.05630461126565933, -0.028824971988797188, -0.022546757012605667, 0.006396552547812462, 0.00850797537714243, -0.007050533313304186, -0.008881678804755211, -0.025785518810153008, -0.01100555807352066, -0.006844996474683285, 0.006639459636062384, 0.024876173585653305, -0.03565128147602081, 0.05211913585662842, -0.03413155674934387, -0.048531584441661835, 0.027604207396507263, -0.02148793265223503, 0.05396273732185364, -0.0023231881204992533, -0.0022422189358621836, 0.013378573581576347, -0.010993101634085178, -0.02253430150449276, 0.08684861660003662, 0.031515635550022125, 0.03453017398715019, -0.0037245748098939657, 0.029871340841054916, -0.02049138955771923, -0.047011859714984894, -0.033957161009311676, -0.038890041410923004, -0.004992051515728235, 0.019469935446977615, 0.019033947959542274, -0.004120077472180128, 0.03547688573598862, 0.028550922870635986, -0.0009521645260974765, 0.017427025362849236, -0.02177443727850914, -0.009996559470891953, 0.02633361704647541, 0.022521844133734703, 0.0019681700505316257, 0.014561966992914677, -0.011397946625947952, 0.0034972387365996838, -0.011397946625947952, 0.03604989871382713, 0.012475457042455673, 0.008694826625287533, 0.08196555823087692, 0.04469490051269531, -0.034754395484924316, 0.022260252386331558, -0.07543821632862091, 0.021587586030364037, -0.05286654084920883, 0.04317517206072807, -0.013092068023979664, 0.027678947895765305, 0.008912820369005203, -0.0060259634628891945, 0.026358529925346375, 0.027753688395023346, 0.016143977642059326, 0.02473914995789528, 0.0016240517143160105, 0.02161250077188015, -0.024477558210492134, -0.0292983278632164, 0.008034618571400642, 0.009616628289222717, -0.0024415273219347, -0.013839473947882652, 0.03181459754705429, -0.0038211150094866753, -0.008613858371973038, 0.002058481564745307, 0.013988954946398735, -0.033433977514505386, 0.016754359006881714, -0.04217863082885742, 0.025710778310894966, -0.018946750089526176, -0.014985497109591961, -0.0035688653588294983, -0.011510057374835014, -0.0045404937118291855, -0.008395864628255367, 0.008669913746416569, -0.02377997897565365, -0.017240172252058983, -0.09507008641958237, -0.02725541777908802, -0.01002770196646452, 0.017987579107284546, 0.022322535514831543, -0.03353363275527954, 0.01665470376610756, -0.014325288124382496, 0.0007551918388344347, -0.022671325132250786, 0.0043007005006074905, -0.05311567708849907, -0.01252528466284275, -0.006558490451425314, -0.004453296307474375, -0.0035782079212367535, 0.004319385625422001, -0.0088629936799407, -0.019519763067364693, 0.009174413047730923, 0.006318697705864906, -0.00994673278182745, 0.0010798464063555002, -0.0014878057409077883, 0.028675489127635956, -0.002192392013967037, -0.009479603730142117, -0.02937306836247444, 0.021425647661089897, -0.0051072766073048115, 0.010276837274432182, 0.0006068783695809543, -0.013602795079350471, 0.028426354750990868, 0.006471293047070503, -0.03365819901227951, -0.04138139635324478, 0.007785482797771692, 0.025324618443846703, 0.007168872281908989, -0.050175879150629044, 0.01680418662726879, 0.008595173247158527, -0.027429813519120216, -0.011111441068351269, 0.007212471216917038, -0.010893447324633598, -0.013266462832689285, -0.025474099442362785, -0.006857453379780054, 0.009404863230884075, -0.01232597604393959, -0.014561966992914677, -0.007829081267118454, -0.014674077741801739, -0.03953779488801956, -0.03622429445385933, -0.0168166421353817, 0.042926035821437836, 0.00884430855512619, 0.0028852999676018953, -0.02021734230220318, 0.0005570512730628252, 0.010993101634085178, -0.0032200757414102554, 0.03061874583363533, 0.005247415509074926, -0.001979069784283638, -0.014051239006221294, 0.008358494378626347, -0.007611087989062071, -0.025237420573830605, -0.012867845594882965, 0.02204848639667034, 0.013677535578608513, -0.003159348852932453, 0.007922506891191006, -0.018112147226929665, -0.021724611520767212, -0.03114193119108677, 0.012008328922092915, 0.011155040003359318, -0.002671977737918496, 0.03333432227373123, 0.02989625371992588, -0.0052629862911999226, -0.02117651328444481, -0.04459524527192116, -0.014412485994398594, -0.02485126070678234, -0.023829804733395576, 0.02421596460044384, -0.004752258770167828, 0.02561112307012081, -0.03061874583363533, 0.03702152892947197, 0.0070380764082074165, 0.018037406727671623, 0.012805561535060406, -0.010606941767036915, -0.01250659953802824, 0.039762016385793686, 0.008881678804755211, 0.00952943041920662, -0.006508663762360811, -0.008813166059553623, 0.010843620635569096, -0.02280835062265396, 0.021425647661089897, 0.014188263565301895, 0.0028837427962571383, -0.020964747294783592, -0.03430595248937607, -0.00630312692373991, 0.02168724127113819, 0.005322156008332968, -0.04013571888208389, 0.01491075661033392, -0.00608513318002224, 0.0030129817314445972, -0.00882562343031168, -0.0146491639316082, -0.0075488039292395115, -0.03325958177447319, -0.010557114146649837, 0.03380768001079559, -0.004718002397567034, 0.025025656446814537, -0.023755064234137535, 0.0016193804331123829, -0.03542705997824669, 0.02922358736395836, 0.006337382830679417, 0.0023870288860052824, -0.03178968280553818, -0.03931357339024544, -0.006349839735776186, 0.017588961869478226, 0.02305748499929905, 0.022945374250411987, 0.010619398206472397, -0.004278901498764753, -0.010189639404416084, -0.07419253885746002, 0.02453984133899212, 0.0024866831954568624, 0.01692875288426876, -0.010133584029972553, 0.011155040003359318, -0.021512845531105995, -0.04165544733405113, -0.0010969744762405753, 0.05530807003378868, -0.04163053259253502, -0.00832735188305378, -0.027878256514668465, -0.02128862403333187, 0.02394191548228264, 0.005829769652336836, 0.04168035835027695, -0.007243613246828318, 0.017551591619849205, 0.0073245819658041, -0.016193803399801254, 0.004185475409030914, 0.026408357545733452, -0.04090803861618042, -0.002978725591674447, 0.018984120339155197, 0.01124846562743187, 0.012656080536544323, -0.043648529797792435, -0.03537723422050476, -0.016069237142801285, 0.03022013045847416, -0.030668573454022408, -0.058297693729400635, -0.010102442465722561, -0.00972873903810978, -0.011865075677633286, 0.05540772154927254, 0.02937306836247444, -0.04491912201046944, 0.010631855577230453, 0.03154054656624794, -0.0026268218643963337, -0.008071988821029663, -0.046762723475694656, 0.0064775217324495316, -0.012830475345253944, 0.011840161867439747, -0.019445020705461502, -0.03034469671547413, -0.026034655049443245, -0.013303833082318306, -0.028650576248764992, -0.0059699080884456635, 0.013266462832689285, -0.03306027501821518, -0.017638789489865303, 0.004004852380603552, -0.008040846325457096, 0.023680323734879494, 0.011510057374835014, 0.032636743038892746, 0.015795188024640083, -0.042128805071115494, 0.005991707555949688, 0.013017327524721622, 0.004070250317454338, 0.009411091916263103, 0.0074491496197879314, 0.021724611520767212, 0.01644293963909149, -0.035800762474536896, -0.05540772154927254, 0.01665470376610756, 0.017638789489865303, -0.030394524335861206, 0.006144302897155285, 0.05142155662178993, 0.0012487914646044374, -0.004297586623579264, -0.010276837274432182, 0.008750882931053638, -0.05251775309443474, -0.014125979505479336, 0.015745360404253006, -0.012867845594882965, 0.03378276526927948, 0.011534971185028553, -0.019631873816251755, -0.0009731853497214615, -0.0008455034112557769, -0.004811428487300873, -0.01653013750910759, 0.011497600935399532, 0.004369212780147791, -0.003134435275569558, -0.004886168986558914, 0.019357824698090553, 0.029049193486571312, 0.0015181691851466894, 0.00757371773943305, -0.010800021700561047, 0.012375803664326668, 0.007418008055537939, 0.057052016258239746, -0.010114898905158043, -0.011155040003359318, 0.032238125801086426, -0.013453314080834389, 0.005892053246498108, -0.017750900238752365, -0.03893987089395523, -0.027081023901700974, 0.031117016449570656, -0.019482392817735672, 0.013876844197511673, -0.008364723064005375, 0.025760605931282043, -0.017065778374671936, -0.030793141573667526, 0.005322156008332968, -0.021550215780735016, -0.04962778091430664, 0.026233961805701256, 0.004518694244325161, -0.021786894649267197, -0.002003983361646533, -0.10762651264667511, -0.003509695641696453, 0.024078940972685814, -0.017863010987639427, -0.024764062836766243, 0.0033726710826158524, 0.024303162470459938, 0.01741456799209118, 0.02982151322066784, -0.017177889123558998, -0.00022013451962266117, -0.007822852581739426, 0.009386178106069565, -0.015882384032011032, -0.024664409458637238, -0.04257724806666374, -0.013540511950850487, -0.00012719532242044806, 0.0006423023296520114, -0.014674077741801739, 0.0036498343106359243, -0.029397983103990555, -0.025237420573830605, 0.0025910085532814264, -0.017464395612478256, 0.007872680202126503, -0.007162644062191248, -0.010114898905158043, 0.014723904430866241, 0.0032418749760836363, 0.0055214641615748405, 0.026956455782055855, 0.01524708978831768, 0.034281037747859955, -0.05899527296423912, 0.018622875213623047, -0.0014893627958372235, -0.006022849585860968, 0.04898002743721008, 0.014026325196027756, -0.01000901684165001, -0.0591447539627552, 0.016081692650914192, 0.022908004000782967, 0.013029783964157104, -0.008134271949529648, 0.017115605995059013, -0.023867174983024597, -0.014038782566785812, -0.030568920075893402, -0.021923920139670372, 0.0032169613987207413, -0.01644293963909149, -0.015259546227753162, -0.002443084493279457, 0.004023537505418062, -0.007237384561449289, -0.011316977441310883, 0.005129076074808836, 0.01629345864057541, 0.012313519604504108, 0.03649834170937538, 0.025087939575314522, 0.009697597473859787, -0.02810247801244259, -0.041481051594018936, 0.030992450192570686, 0.0254118163138628, -0.02397928759455681, -0.03313501551747322, 0.02112668566405773, -0.006489978171885014, 0.017377197742462158, 0.001420850632712245, -0.0031795911490917206, 0.02000557631254196, -0.016231173649430275, 0.01217026636004448, -0.046887289732694626, 0.02300765924155712, 0.03597515821456909, -0.019320454448461533, -0.010775107890367508, 0.001176386489532888, 0.0063280402682721615, -0.013241549022495747, 0.01010867115110159, 0.02373015135526657, -0.023194510489702225, 0.029348155483603477, 0.027878256514668465, -0.024726692587137222, -0.006402780767530203, -0.01685401238501072, -0.03161528706550598, -0.020952291786670685, -0.012531513348221779, 0.013777189888060093, 0.021101772785186768, 0.016517680138349533, 0.03946305438876152, 0.014935670420527458, -0.0027373756747692823, -0.039487969130277634, -0.004148105159401894, -0.025025656446814537, -0.010426318272948265, -0.03642360121011734, 0.006038420367985964, -0.011472687125205994, -0.014873386360704899, 0.028999365866184235, 0.009006245993077755, 0.018872009590268135, 0.009467147290706635, 0.01685401238501072, 0.044570330530405045, 0.0011833934113383293, 0.04063399136066437, -0.02566095069050789, 0.002799659501761198, 0.03385750576853752, -0.010469917207956314, 0.017763357609510422, -0.03799315541982651, 0.0019915264565497637, 0.011852619238197803, 0.04374818503856659, 0.0070443046279251575, -0.007006934378296137, -0.02409139834344387, 0.034281037747859955, 0.0032013903837651014, -0.00894396286457777, 0.010893447324633598, 0.008688598871231079, 0.014287917874753475, 0.00561489025130868, -0.02204848639667034, 0.02349347248673439, -0.009678912349045277, 0.0101273562759161, 0.0005134525708854198, -0.01656750775873661, 0.0030160960741341114, 0.02392945997416973, 0.005309699103236198, -0.019195886328816414, 0.009298980236053467, 0.002010211581364274, 0.029522551223635674, -0.026632579043507576, 0.015944669023156166, -0.007617316208779812, 0.0290242787450552, -0.027355071157217026, -0.04770943894982338, -0.013229092583060265, -0.009168184362351894, 0.03455508500337601, 0.025959912687540054, 0.04696203023195267, -0.005135304294526577, -0.008402093313634396, 0.030793141573667526, -0.020665785297751427, -0.014836016111075878, -0.008875450119376183, -0.024527383968234062, 0.006116275209933519, 0.010121127590537071, 0.019021490588784218, 0.041082434356212616, -0.0005566620384342968, 0.06407763808965683, 0.018186887726187706, -0.01929553970694542, 0.007349495775997639, -0.017663702368736267, 0.05794890597462654, 0.01945747807621956, 0.006944650784134865, 0.008476833812892437, -0.007517661899328232, -0.00036513913073576987, -0.05356412008404732, -0.006701743695884943, 0.03861599415540695, 0.024664409458637238, -0.007517661899328232, 0.01808723248541355, 0.03159037604928017, -0.01134811993688345, 0.038890041410923004, -0.018797269091010094, 0.0038055439945310354, 0.005393782630562782, 0.02493845857679844, -0.0004994387272745371, -0.02302011474967003, -0.0689108669757843, 0.01008375734090805, -0.023343991488218307, -0.0023387589026242495, -0.013552968390285969, 0.009298980236053467, 0.009143270552158356, 0.038366857916116714, -0.028027737513184547, -0.004574749618768692, -0.01096818782389164, -0.002720247721299529, -0.0410575233399868, 0.0631309226155281, -0.041281744837760925, -0.05069906264543533, -0.013540511950850487, 0.04158070683479309, -0.029547464102506638, 0.002474226290360093, -0.049652695655822754, -0.02457721158862114, 0.02593499980866909, -0.012400716543197632, -0.013939128257334232, -0.022633954882621765, 0.016430482268333435, 0.01853567734360695, -0.01242563035339117, 0.013366117142140865, 0.01893429458141327, 0.012263691984117031, -0.006343611516058445, -0.017788270488381386, 0.005035649985074997, 0.00988444872200489, -0.0168166421353817, -0.005234958603978157, -0.02830178663134575, 0.023381361737847328, 0.014773732051253319, 0.020703155547380447, -0.020142599940299988, -0.009155727922916412, 0.0006166102248243988, -0.03941322863101959, 0.0018825297011062503, 0.03505335748195648, 0.015558508224785328, 0.005387553945183754, -0.002408828353509307, 0.03512809798121452, 0.0039020839612931013, -0.015222175978124142, 0.03557654097676277, 0.023593125864863396, 0.005860911216586828, 0.05162086337804794, -0.0030020822305232286, 0.019519763067364693, -0.020478934049606323, 0.01633082889020443, 0.00752389058470726, -0.0146491639316082, 0.021824264898896217, -0.034754395484924316, -0.023144682869315147, -0.013652622699737549, -0.007791711017489433, -0.008588944561779499, -0.02289554663002491, 0.026184136047959328, 0.011236008256673813, 0.0295723769813776, 0.012413173913955688, 0.021350907161831856, 0.017339827492833138, -0.030519092455506325, 0.003307273145765066, 0.00740555115044117, -0.01112389750778675, 0.013303833082318306, -0.0396125353872776, -0.03709626942873001, 0.011846390552818775, -0.013191722333431244, -0.012805561535060406, 0.0034193838946521282, 0.0016069236444309354, -0.018199345096945763, 0.05695236474275589, 0.04902985692024231, -0.008370950818061829, 0.005929423496127129, -0.023555755615234375, -0.006374753080308437, 0.015496225096285343, 0.02153776027262211, -0.011142582632601261, -0.03510318323969841, -0.010974416509270668, -0.000691350840497762, 0.015321830287575722, -0.044520504772663116, 0.020541217178106308, 0.03358345851302147, 0.04910459741950035, -0.0022811463568359613, -0.03502844274044037, -0.008757110685110092, -0.0025084824301302433, 0.02889971248805523, 0.021874092519283295, 0.04389766603708267, -0.01075019408017397, 0.005960565526038408, -0.01366507913917303, 0.007760568987578154, 0.030668573454022408, -0.01392667181789875, 0.017177889123558998, 0.0054093534126877785, -0.0060757906176149845, -0.004029765725135803, -0.021039487794041634, -0.06995723396539688, -0.014499682933092117, -0.021027032285928726, -0.0018218029290437698, 0.010195868089795113, 0.016866469755768776, 0.0008034618222154677, 0.019270626828074455, -0.0074989767745137215, -0.011790335178375244, -0.0011584798339754343, -0.0151474354788661, -0.0004920425126329064, -0.02085263654589653, -0.00747406342998147, -0.0032605601008981466, 0.012531513348221779, -0.03094262257218361, 0.008040846325457096, -0.006832539569586515, 0.012132896110415459, 0.002538067288696766, -0.024265792220830917, -0.028276873752474785, -0.01339103002101183, 0.08430743217468262, 0.0039301118813455105, -0.024502471089363098, -0.0028619433287531137, -0.0229702889919281, -0.0007201571715995669, 0.012755734845995903, -0.011977186426520348, -0.03811772167682648, 0.001066611148416996, -0.012680994346737862, 0.04038485512137413, 0.02056613191962242, 0.038441598415374756, 0.020603502169251442, -0.013092068023979664, -0.0006683836691081524, 0.03233778104186058, 0.025785518810153008, 0.01864778809249401, 0.023755064234137535, 9.089551167562604e-05, -0.01569553278386593, -0.003808658104389906, -0.01813706010580063, -0.00020495282660704106, 0.023717693984508514, -0.015371656976640224, 0.008333580568432808, 0.02132599428296089, 0.02358067035675049, 0.0018093461403623223, -0.02445264346897602, 0.002888414077460766, 0.015371656976640224, -0.000891437754034996, -0.009510745294392109, 0.04718625172972679, -0.05182017385959625, -0.02394191548228264, -0.02302011474967003, 0.015745360404253006, 0.004500009119510651, 0.010420089587569237, 0.026956455782055855, 0.027728775516152382, 0.029198674485087395, 0.015321830287575722, 0.02085263654589653, -0.015907298773527145, 0.027928084135055542, -0.016231173649430275, 0.019320454448461533, -0.003055023495107889, 0.01705332100391388, -0.03213847428560257, 0.004649490118026733, 0.007791711017489433, 0.049129508435726166, 0.018024949356913567, -0.034006986767053604, -0.006010392680764198, -0.047285906970500946, -5.498497193912044e-05, -0.007106588687747717, -0.06039043143391609, -0.0013336532283574343, 0.0003886902122758329, -0.014586880803108215, 0.03465474024415016, -0.0002865057613234967, 0.028426354750990868, -0.0045467219315469265, -0.03729557618498802, 0.008171642199158669, 0.016555050387978554, -0.038640908896923065, -0.017863010987639427, 0.028874797746539116, 0.02353084273636341, -0.0074927485547959805, -0.01797512173652649, -0.01197095774114132, -0.001954156206920743, 0.014325288124382496, -0.0023667868226766586, 0.030718401074409485, 0.01584501378238201, 0.006564719136804342, 0.027305245399475098, 0.003079937072470784, -0.0022235338110476732, 0.002564538037404418, -0.03682221844792366, 0.017800727859139442, -0.011422860436141491, 0.010139812715351582, -0.056653399020433426, 0.012276149354875088, 0.006676829885691404, 0.0006823975709266961, -0.03081805445253849, 0.015620792284607887, 0.008389635942876339, -0.00443149683997035, -0.014723904430866241, -0.04462016001343727, -0.025561297312378883, 0.015483767725527287, 0.022509386762976646, -0.0003700050583574921, -0.009921818971633911, -0.03061874583363533, -0.0016224945429712534, -0.02737998589873314, 0.02117651328444481, 0.025125309824943542, 0.04003606736660004, -0.01765124686062336, -0.034156471490859985, 0.028027737513184547, 0.033433977514505386, 0.014599337242543697, 0.007829081267118454, -0.03973710536956787, 0.014487226493656635, -0.014063696376979351, -0.011254693381488323, -0.020466476678848267, -0.007872680202126503, 0.00214100768789649, 0.0018622874049469829, -0.023879632353782654, -0.025237420573830605, -0.015521137975156307, 0.015832558274269104, 0.020067859441041946, -0.010613170452415943, -0.0195322185754776, 0.00490173976868391, -0.025312161073088646, 0.027728775516152382, -0.010843620635569096, -0.03293570503592491, 0.009510745294392109, 0.00550277903676033, 5.868307562195696e-05, -0.02605956792831421, 0.04265198856592178, 0.020877551287412643, 0.02989625371992588, -0.005368868820369244, -0.0173647403717041, -0.011634625494480133, -0.032636743038892746, -0.0025022542104125023, 0.03186442330479622, -0.04379801079630852, 0.0302948709577322, -0.01653013750910759, 0.02553638257086277, -0.014200720004737377, -0.009211783297359943, 0.01841110922396183, 0.012699679471552372, -0.009871992282569408, 0.0010136698838323355, 0.009049844928085804, 0.04334956780076027, -0.00185605906881392, 0.006957107223570347, 0.0038709419313818216, 0.04118208959698677, 0.00894396286457777, -0.04514334350824356, -0.0019199000671505928, -0.008894135244190693, 0.02081526629626751, -0.0038148865569382906, 0.02725541777908802, 0.007337038870900869, 0.003933225758373737, 0.02678206004202366, 0.024415273219347, -0.0018731871386989951, 0.03009556233882904, 0.021114228293299675, 0.009112128987908363, -0.017352283000946045, 0.022197967395186424, 0.004222845658659935, -0.006082019302994013, -0.011634625494480133, -0.017638789489865303, 0.02112668566405773, 0.01864778809249401, -0.013154351152479649, 0.007094131782650948, -0.019021490588784218, 0.016156433150172234, -0.010314207524061203, -0.01969415694475174, 0.020591044798493385, -0.01933290995657444, 0.02524987794458866, -0.0031453350093215704, -0.041007693856954575, -0.014624251052737236, 0.008090673945844173, 0.022197967395186424, 0.014325288124382496, -0.009492060169577599, 0.021587586030364037, 0.00010160054807784036, 0.03575093671679497, -0.04389766603708267, 0.0021192084532231092, -0.00247578346170485, -0.01785055547952652, -0.031092103570699692, -0.03266165778040886, -0.0010689467890188098, 0.033957161009311676, 0.012693450786173344, 0.001197407254949212, 0.015421484597027302, -0.005291013978421688, 0.034081727266311646, 0.005185131449252367, -0.010401404462754726, -0.0290242787450552, -0.017501765862107277, 0.014400028623640537, 0.010731508955359459, 0.03340906277298927, -0.024838803336024284, -0.015334286727011204, -0.027629120275378227, 0.028276873752474785, 0.0024228421971201897, -0.04103260859847069, 0.0013616809155791998, -0.013478227891027927, 0.0008361608488485217, 0.040683817118406296, 0.02150038816034794, -0.0011693794513121247, -0.0005181238520890474, -0.03161528706550598, 0.013615252450108528, -0.02625887654721737, -0.0017205916810780764, -0.0385163389146328, -0.05794890597462654, -0.01212666742503643, -0.0061692167073488235, -0.001335988868959248, -0.013191722333431244, 0.029746772721409798, 0.02101457491517067, -0.003967482130974531, -0.017800727859139442, -0.02257167175412178, 0.006066448055207729, -0.010787565261125565, 0.012780648656189442, -0.01600695215165615, -0.026956455782055855, -0.015035323798656464, -0.023555755615234375, -0.008190328255295753, 0.02533707581460476, -0.011155040003359318, -0.005885825026780367, 0.014537053182721138, 0.0043505276553332806, 0.01240694522857666, -0.02302011474967003, 0.00017819023923948407, 0.021188968792557716, 0.04058416560292244, -0.020267168059945107, 0.004549836274236441, 0.0010518187191337347, -0.0028541579376906157, -0.003500353079289198, -0.01837373897433281, -0.008713512681424618, 0.0019090003333985806, 0.011815248988568783, 0.014250547625124454, -0.009772337973117828, 0.03470456600189209, -0.017190346494317055, 0.013951584696769714, 0.012008328922092915, 0.011572341434657574, -0.0034380692522972822, 0.023717693984508514, 0.006368524860590696, -0.017800727859139442, -0.015608335845172405, -0.024701779708266258, -0.027305245399475098, 0.00486436951905489, 0.019918378442525864, 0.003307273145765066, 0.027753688395023346, 0.05735097825527191, -0.01960695907473564, 0.009809708222746849, -0.004823884926736355, -0.00034080949262715876, 0.018834639340639114, 0.011989643797278404, -0.005424924194812775, -0.020142599940299988, -0.021438105031847954, -0.023306621238589287, 0.04693711921572685, -0.02049138955771923, 0.01732737012207508, -0.009348807856440544, -0.04113226383924484, 0.03537723422050476, -0.02693154104053974, 0.008651228621602058, -0.0019650559406727552, 0.006150531116873026, -0.026508010923862457, 0.011634625494480133, -0.017501765862107277, 0.017676159739494324, -0.037046439945697784, 0.017788270488381386, 0.009442233480513096, 0.00210675154812634, 0.03438069298863411, 0.01461179368197918, 0.005390668287873268, -0.018473394215106964, -0.01359033863991499, -0.027803516015410423, -0.006645687855780125, -0.012712135910987854, 0.03829211741685867, -0.0015064908657222986, -0.010582027956843376, -0.025474099442362785, 0.0170906912535429, 0.02526233345270157, 0.03041943721473217, -0.00862631481140852, -0.04653850197792053, -0.0014543281868100166, 0.0025692093186080456, 0.03173985704779625, -0.0004067914851475507, 0.030020821839571, 0.004123191814869642, -0.00014276629372034222, 0.006409009452909231, 0.007330810651183128, -0.004275787156075239, 0.03350871801376343, -0.00745537830516696, 0.004730459302663803, -0.011883760802447796, 0.01965678669512272, 0.021475475281476974, -0.025760605931282043, 0.009236697107553482, -0.01491075661033392, -0.013278919272124767, 0.015384113416075706, 0.0016271659405902028, -0.008476833812892437, -0.005493436474353075, 0.019619416445493698, 0.00428201537579298, 0.014300374314188957, -0.04818279668688774, 0.00444395374506712, 0.027928084135055542, 0.017439480870962143, -0.010974416509270668, -0.006620774511247873, 0.017103148624300957, 0.00575191481038928]",Online Speculative Decoding.pdf
" (6)
Modelingùëáùëìùë§ùëë.We then define ùëáùëìùë§ùëë, the time for a for-
ward pass, which is applicable to both the draft and target
(a)7B, TP=1.
 (b)70B, TP=4.
Figure 7. Predicted versus profiled batch latency. TP: tensor
parallel. The x-axis represents the profiled time, while the
y-axis shows the predicted execution time using Formula 7.
The red line symbolizes perfect prediction, indicating where
the predicted time matches the profiled time exactly.
models:
ùëáùëìùë§ùëë(ùëÄ,ùëÅùëêùëúùëõùë°ùëíùë•ùë°,ùëÅùëèùëéùë°ùëê‚Ñéùëíùëë)=ùõºùëÄ¬∑ùëÅùëêùëúùëõùë°ùëíùë•ùë°+ùõæùëÄ¬∑ùëÅùëèùëéùë°ùëê‚Ñéùëíùëë+ùõøùëÄ
(7)
whereùëÅùëêùëúùëõùë°ùëíùë•ùë° represents the number of context tokens
within the batch and ùëÅùëèùëéùë°ùëê‚Ñéùëíùëë denotes the number of batched
tokens, as illustrated in Figure 7. The term ùõºùëÄ¬∑ùëÅùëêùëúùëõùë°ùëíùë•ùë° re-
flects the time required to load the key-value cache, scal-
ing linearly with the number of context tokens. The term
ùõæùëÄ¬∑ùëÅùëèùëéùë°ùëê‚Ñéùëíùëë accounts for the computation time, while ùõøùëÄ
represents the time to load the model parameters. The coef-
ficientsùõºùëÄ,ùõæùëÄ, andùõøùëÄare contingent upon the model and
hardware configuration, necessitating distinct sets of ( ùõºùëÄ,
ùõæùëÄ,ùõøùëÄ) for various models or hardware environments. In
practical terms, we systematically profile the batch execu-
tion time for each specific model and hardware combination,
and subsequently adjust the values of ùõºùëÄ,ùõæùëÄ, andùõøùëÄto
accurately reflect these profiles.
ModelingùëÅùëèùëéùë°ùëê‚Ñéùëíùëë . If at each position the proposal method
suggests only one token (top 1 candidate), the number of
tokens sent for verification is simply the sum of the proposed
lengths of each request. For top-k tree-style speculative de-
coding, assuming full tree verification, assume full tree verifi-
cation, there are ùêªheads and we propose ùëòùëñtokens for head
ùëñ, the number of batched tokens is√çùêª
‚Ñé=1√é‚Ñé
ùëñ=1ùëòùëñ[4]. Figure 8
illustrates an example of the number of batched tokens in
Medusa. As shown, one characteristic of full tree speculative
decoding is its high cost. In the example, even if a maximum
of four tokens can be accepted (three proposed tokens plus
one bonus token), a total of 27 tokens are sent for verification.
This can be problematic for large batch sizes. Smarter meth-
ods to construct the tree, such as those proposed by [ 6] and
SmartSpec, are needed to make topk candidate speculative
applicable in a real serving system.
Validating performance model. Figure 7 illustrates the
application of our ùëáfwdfunction, designed to estimate batch
6
execution times. This is demonstrated under a uniform work-
load condition, where each request maintains identical in-
put/output sizes (input length = output length = 128). Fur-
thermore, we adjust the request rates to evaluate the func-
tion‚Äôs performance across a spectrum of batch sizes, with
each data point representing an execution step. Our analysis
encompasses comparisons between models of 7B and 70B
parameters, employing tensor parallelism settings of 1 and 4,
respectively. Overall, the results demonstrate that our model
accurately captures the trends present","[-0.004187912214547396, 0.013765423558652401, 0.052097052335739136, -0.030855271965265274, -0.03425165265798569, -0.018392274156212807, 0.004691612906754017, 0.026811273768544197, -0.009498357772827148, 0.021990137174725533, 0.03940379247069359, 0.0110094603151083, -0.07402962446212769, -0.0333881676197052, -0.016147207468748093, -0.0406702421605587, 0.020982736721634865, 0.0011998872505500913, -0.02594778686761856, -0.009426400996744633, -0.0161616001278162, 0.004288652446120977, 0.019298935309052467, 0.0035510906018316746, 0.048614323139190674, -0.021687917411327362, 0.01843544840812683, 0.01768709346652031, 0.051866792142391205, -0.047463007271289825, 0.010109994560480118, -0.03597862645983696, -0.039720404893159866, -0.05273027718067169, 0.0026156462263315916, 0.011369246989488602, 0.0017377677140757442, 0.03877057135105133, 0.007166942581534386, 0.020982736721634865, -0.02353002317249775, 0.014564149081707, -0.08916943520307541, 0.025861438363790512, 0.011750619858503342, 0.030682574957609177, 0.00960629340261221, -0.033503297716379166, 0.006922287866473198, 0.057796068489551544, -0.042541131377220154, 0.029459301382303238, -0.02322780154645443, 0.0651644915342331, 0.007792971096932888, 0.006875515915453434, 0.007577098906040192, 0.006235096137970686, 0.0429728738963604, 0.01738487370312214, 0.0188240185379982, -0.040727805346250534, -0.016650909557938576, -0.0012106808135285974, -0.03027961403131485, -0.004151933826506138, -0.002896279562264681, 0.017341699451208115, -0.014600127004086971, 0.03102796897292137, -0.026120483875274658, 0.013276114128530025, 0.05100330337882042, -0.016492603346705437, -0.017327306792140007, -0.006317846942692995, 0.019773853942751884, 0.03701481223106384, 0.027574021369218826, 0.004026008304208517, 0.035086359828710556, -0.019946550950407982, 0.043001655489206314, -0.0080808000639081, -0.0031247439328581095, -0.02193257212638855, -0.01660773530602455, -0.041620075702667236, -0.03505757451057434, -0.033359382301568985, -0.017500005662441254, 0.019255761057138443, -0.013096220791339874, 0.032064154744148254, 0.022450663149356842, -0.006864722352474928, 0.004213097505271435, -0.07074837386608124, 0.019932160153985023, 0.03166119381785393, 0.0335608646273613, 0.026365138590335846, 0.03128701448440552, -0.0025382922030985355, 0.06798521429300308, 0.019155021756887436, -0.038194913417100906, 0.030308395624160767, -0.04228208214044571, 0.011131787672638893, -0.021212998777627945, -0.025904612615704536, -0.06424343585968018, -0.0011980882845818996, 0.00675318855792284, -0.04691613093018532, -0.038885701447725296, 0.00741879316046834, 0.0006026420160196722, 0.011743424460291862, -0.01366468332707882, 0.02328536845743656, 0.0014580339193344116, -0.04225330054759979, -0.021687917411327362, -0.013254527002573013, 0.03531662002205849, -0.06884869933128357, 0.007476359140127897, -0.010361844673752785, -0.029099514707922935, -0.0010289887432008982, 0.04415297135710716, -0.0019338512793183327, -0.0006044409819878638, -0.06867600232362747, -0.009397617541253567, 0.0012016862165182829, -0.016809215769171715, 0.028264811262488365, -0.01965872198343277, -0.02027755416929722, -0.029790304601192474, 0.016679691150784492, -0.045879945158958435, 0.024997951462864876, -0.050801824778318405, 0.03902961686253548, -0.037676818668842316, 0.032438330352306366, -0.007048213388770819, -0.024105681106448174, -0.022062094882130623, -0.011657075956463814, 0.03171875700354576, -0.05094573646783829, -0.029876653105020523, 0.036986030638217926, 0.02186061441898346, -0.01974507048726082, -0.026768099516630173, 0.0022072887513786554, -0.003921670373529196, 0.01974507048726082, -0.0034017793368548155, 0.03488487750291824, -0.042166952043771744, -0.0021910984069108963, -0.08830594271421432, -0.029416127130389214, 0.025904612615704536, -0.011290093883872032, -0.004608862102031708, -0.04061267524957657, -0.009009048342704773, -0.031603626906871796, -0.06654606759548187, -0.058630771934986115, 0.020291946828365326, -0.05143504589796066, -0.05917764827609062, 0.023328542709350586, 0.006717209704220295, 0.014024469070136547, -0.027487672865390778, -0.012765217572450638, -0.019183805212378502, 0.03379112854599953, 0.00017528337775729597, 0.027113493531942368, 0.02633635513484478, 0.07074837386608124, 0.06084705516695976, -0.012765217572450638, 0.014204362407326698, -0.04210938513278961, 0.0323232002556324, 0.008052016608417034, -0.010030841454863548, 0.01896793209016323, 0.018493015319108963, 0.037072379142045975, 0.03131579980254173, -0.033273033797740936, 0.035719580948352814, -0.016147207468748093, 0.018493015319108963, -0.011023852042853832, -0.01921258680522442, 0.009088201448321342, 0.006925886031240225, 0.028106505051255226, 0.028437508270144463, -0.020018508657813072, -0.02140008844435215, 0.013988490216434002, -0.041620075702667236, 0.009462378919124603, 0.014506583102047443, 0.04498767852783203, -0.022220401093363762, 0.02740132249891758, 0.007656252011656761, 0.04228208214044571, -0.032754942774772644, 0.09268094599246979, 0.006364619359374046, -0.008253497071564198, 0.031747542321681976, -0.028293592855334282, 0.02435033582150936, 0.02072368934750557, -2.9738584998995066e-05, -0.030625008046627045, -0.0015758639201521873, -0.003921670373529196, -0.03180510550737381, -0.03315790370106697, -0.018881583586335182, -0.08254936337471008, -0.02853824757039547, 0.0188240185379982, 0.008699632249772549, -0.02321341075003147, -0.026465879753232002, 0.0356907993555069, -0.029991785064339638, -0.05727797746658325, 0.01570107415318489, 0.05350741744041443, -0.004727591760456562, -0.06775495409965515, -0.033359382301568985, -0.025458477437496185, -0.03318668529391289, 0.01092311181128025, 0.008361433632671833, 0.026379529386758804, -0.02655222825706005, 0.003936062101274729, -0.010520150884985924, 0.004749178886413574, -0.020666124299168587, 0.03894326835870743, -0.045505769550800323, 0.002342208754271269, 0.023083887994289398, -0.010030841454863548, 0.005857320502400398, -0.05137748271226883, 0.030941620469093323, 0.0161616001278162, 0.02420642040669918, -0.010678457096219063, -0.041936688125133514, -0.012937914580106735, 0.017197784036397934, 0.02427837811410427, -0.028826076537370682, -0.013017067685723305, 0.022666536271572113, -0.018176402896642685, 0.06545232236385345, 0.0054687513038516045, 0.006271074991673231, 0.0024879220873117447, 0.03246711567044258, 0.010189147666096687, 0.004421773366630077, -0.012779608368873596, 0.022335533052682877, -0.0075483163818717, 0.03761925548315048, -0.06487666070461273, 0.026681751012802124, -0.007915298454463482, 0.011498769745230675, -0.00933285616338253, 0.01013877708464861, -0.028408724814653397, 0.047319091856479645, 0.043433401733636856, 0.0036914071533828974, 0.002241468522697687, -0.005914886482059956, -0.01449219137430191, -0.024465467780828476, 0.0019338512793183327, 0.007041017524898052, -0.014362668618559837, -0.005868114065378904, 0.041101984679698944, -0.0731661394238472, -0.0010011052945628762, -0.022493839263916016, -0.0625164657831192, 0.056587185710668564, -0.019457241520285606, 0.005033410154283047, -0.009685446508228779, -0.02314145304262638, -0.06936679780483246, -0.03548932075500488, 0.013952512294054031, 0.0532771535217762, -0.019068673253059387, -0.02596217766404152, 0.009707033634185791, 0.027487672865390778, -0.006281868554651737, 0.013420028612017632, -0.008584500290453434, 0.02558800019323826, -0.04645560309290886, -0.0029538453090935946, -0.023573197424411774, -0.02564556710422039, 0.009059418924152851, 0.03367599472403526, 0.046340472996234894, -0.06245889887213707, -0.035633232444524765, 0.01431229803711176, -0.011354855261743069, -0.027185451239347458, 0.04058389365673065, 0.05462994799017906, 0.035719580948352814, 0.0564720556139946, 0.014441821724176407, 0.007440380286425352, -0.011549139395356178, 0.045793596655130386, -0.017658310011029243, 0.049132414162158966, -0.023199019953608513, 0.01873767003417015, -0.05178043991327286, -0.03583471477031708, 0.005756580736488104, -0.010966286063194275, 0.05031251534819603, 0.027372540906071663, 0.012758021242916584, -0.0011720038019120693, 0.014139601029455662, -0.01624794863164425, -0.017269741743803024, -0.027358148247003555, -0.029876653105020523, 0.01767270267009735, 0.06976975500583649, -0.042224518954753876, -0.03531662002205849, -0.06205593794584274, -0.04567846655845642, -0.01183696836233139, 0.04334704950451851, 0.017269741743803024, 0.03318668529391289, 0.03741777315735817, -0.012815587222576141, -0.009325660765171051, -0.007454771548509598, 0.0193565022200346, 0.011398029513657093, 0.010455389507114887, -0.03459705039858818, -0.05146383121609688, -0.009692642837762833, -0.003936062101274729, 0.025386519730091095, 0.018233967944979668, 0.0028638988733291626, -0.004486534744501114, 0.03209293633699417, 0.03186267241835594, 0.03638158738613129, 0.05152139440178871, 0.005594676826149225, 0.006055203266441822, -0.018018096685409546, -0.05865955725312233, -0.0197162888944149, -0.028653379529714584, 0.02435033582150936, 0.019025499001145363, -0.004770766012370586, 0.03807977959513664, 0.034194089472293854, 0.042080603539943695, -0.02435033582150936, 0.03238076716661453, -0.034798528999090195, 0.033589646220207214, -0.0220189206302166, 0.013045850209891796, 0.05152139440178871, 0.024566207081079483, 0.08865133672952652, -0.04095806926488876, -0.023717110976576805, -0.03520148992538452, -0.006875515915453434, -0.07523851096630096, 0.00595446303486824, 0.027199842035770416, 0.0004337673308327794, -0.0029646388720721006, -0.05477386340498924, -0.03756168857216835, 0.011088613420724869, 0.04547698795795441, -0.015672290697693825, -0.023040713742375374, -0.015456418506801128, 0.016334297135472298, 0.01343441940844059, -0.0021910984069108963, -0.01529811229556799, -0.013995686545968056, -0.010030841454863548, -0.005155737511813641, -0.005252879578620195, -0.0488445870578289, 0.03750412166118622, 0.005609068088233471, -0.03618010878562927, 0.046254124492406845, -0.014952718280255795, 0.033647213131189346, -0.007224508561193943, -0.004454154055565596, 0.020810037851333618, -0.014002881944179535, -0.06125001609325409, 0.0790378525853157, 0.004943463485687971, 0.061595410108566284, -0.022134052589535713, 0.031603626906871796, 0.03065379150211811, -0.01601768471300602, -0.01039782352745533, -0.03413652256131172, 0.0271710604429245, 0.017255350947380066, 0.03649672120809555, 0.020853212103247643, 0.012110406532883644, 0.005375206936150789, -0.043001655489206314, 0.010800784453749657, -0.020004117861390114, -0.01202405709773302, 0.0018852801294997334, 0.008303867653012276, -0.006350228097289801, 0.041101984679698944, -0.004749178886413574, 0.0067963628098368645, -0.03416530415415764, 0.002662418410181999, 0.026451487094163895, 0.008778785355389118, 0.08629114180803299, 0.049074847251176834, -0.005986843723803759, 0.010901524685323238, -0.01981702819466591, -0.025141865015029907, -0.03816612809896469, 0.06435856968164444, -0.017715876922011375, 0.02253701351583004, -0.005486740730702877, 0.0010838562157005072, 0.008642066270112991, 0.009282486513257027, 0.0024699328932911158, 0.035777147859334946, 0.01875206083059311, 0.006850330624729395, 0.008440585806965828, -0.0027163864579051733, -0.01676604151725769, -0.013837380334734917, 0.01806127093732357, -0.018867192789912224, 0.05408307537436485, -0.02056538313627243, 0.011779403313994408, 0.005306847859174013, 0.0312582328915596, -0.019486024975776672, 0.0025328954216092825, -0.024120071902871132, 0.04069902375340462, -0.007361227180808783, 0.0004099314974155277, 0.0074835545383393764, 0.02040707878768444, -0.021342521533370018, 0.01571546494960785, 0.00940481387078762, -0.03949014097452164, -0.01350637711584568, -0.11593753099441528, -0.012578128837049007, -0.007742600981146097, 0.04038241133093834, 0.004051193594932556, -0.01518298126757145, 0.008483760990202427, -0.00576737429946661, -0.00396484462544322, -0.011153374798595905, -0.004511720035225153, -0.0356907993555069, 0.019097456708550453, -0.007692230865359306, -0.011160570196807384, 0.0038928876165300608, -0.01518298126757145, 0.0005797056364826858, -0.013017067685723305, 0.010944698937237263, -0.0011252316180616617, 0.001384277711622417, 0.010325866751372814, 0.02922903746366501, 0.011743424460291862, -0.001666709897108376, 0.0008882223628461361, -0.03520148992538452, 0.017183393239974976, 0.0006804458098486066, 0.01564350724220276, -0.012952306307852268, -0.025847045704722404, 0.00715255131945014, 0.010995068587362766, -0.008174343965947628, -0.030768923461437225, -0.006001234985888004, 0.015039066784083843, 0.00027950896765105426, -0.031143100932240486, 0.009016244672238827, 0.023083887994289398, -0.027689151465892792, -0.03900083154439926, 0.005004627164453268, -0.008512543514370918, 0.0012961301254108548, -0.021155433729290962, 0.002176706911996007, 0.010491368360817432, -0.002768555423244834, -0.014484995976090431, -0.030222047120332718, 0.01813322864472866, -0.022292358800768852, -0.006569697521626949, -0.02495477721095085, 0.03157484531402588, 0.025400912389159203, 0.022551404312253, -0.023789068683981895, 0.036842115223407745, 0.018636928871273994, -0.01745682954788208, 0.018090054392814636, 0.004130346700549126, -0.00827508419752121, -0.0023979756515473127, 0.013880554586648941, -0.021975746378302574, -0.02435033582150936, -0.001955438405275345, 0.0012988285161554813, -0.0012097813887521625, 0.008490956388413906, 0.0017629527719691396, -0.03393504396080971, 0.00898746121674776, -0.015758639201521873, 0.007041017524898052, 0.0209539532661438, 0.01430510263890028, 0.01607525162398815, 0.01118935365229845, -0.0404975451529026, -0.01827714405953884, -0.020694907754659653, -0.009311269037425518, -0.007728209253400564, -0.027228625491261482, 0.020824430510401726, 0.0015704671386629343, 0.01715460978448391, -0.018867192789912224, 0.014780020341277122, -0.018320318311452866, 0.024494249373674393, 0.014952718280255795, 0.011671466752886772, -0.009304073639214039, 0.002284643007442355, 0.028106505051255226, -0.022047704085707664, -0.004213097505271435, 0.003648232901468873, 0.006951070856302977, -0.017816616222262383, 0.02495477721095085, -0.0028315179515630007, 0.006073192227631807, -0.031546059995889664, -0.03295642510056496, 0.03330181911587715, 0.017643919214606285, -0.0014805205864831805, -0.03931744396686554, 0.0039000832475721836, -0.003322626231238246, -0.0010289887432008982, -0.0029826282989233732, -0.006404195912182331, -0.03318668529391289, -0.058630771934986115, -0.043001655489206314, 0.03520148992538452, 0.009958884678781033, 0.0056738294661045074, -0.03203536942601204, -0.004378599114716053, -0.030538659542798996, 0.03217928484082222, 0.00017292228585574776, 0.00497224647551775, -0.010628086514770985, -0.048297710716724396, -0.012247124686837196, 0.021990137174725533, 0.034453134983778, 0.018032489344477654, 0.028135286644101143, 0.016866780817508698, -0.005875309929251671, -0.05865955725312233, 0.03574836626648903, 0.046628303825855255, 0.01298108883202076, -0.022450663149356842, -0.015039066784083843, -0.03928866237401962, -0.06550988554954529, -0.015413244254887104, 0.06205593794584274, -0.0499095544219017, 0.007188529707491398, -0.04357731342315674, -0.01244860514998436, 0.019097456708550453, 0.004551296588033438, 0.013952512294054031, 0.00013806798961013556, 0.020435860380530357, -0.002491520019248128, -0.008577304892241955, -0.004831929691135883, 0.02740132249891758, -0.03212171792984009, -0.008490956388413906, -0.006152345333248377, -0.032524678856134415, 0.03367599472403526, -0.023026322945952415, -0.03695724532008171, -0.012139189057052135, 0.02928660251200199, -0.01404605619609356, -0.0385403074324131, -0.021515220403671265, -0.013261722400784492, -0.012700456194579601, 0.0479523167014122, 0.03315790370106697, -0.01339844148606062, -0.003421567613258958, 0.013974099420011044, -0.006875515915453434, 0.0030365961138159037, -0.0385403074324131, -0.0016460221959277987, -0.0020130041521042585, 0.030337179079651833, -0.0218462236225605, -0.01911184750497341, -0.039893101900815964, -0.006508533842861652, -0.02505551651120186, 0.0025346942711621523, 0.02442229352891445, -0.019385285675525665, 0.002414165996015072, 0.019313327968120575, 0.006123562343418598, 0.005594676826149225, 0.008706827647984028, 0.04061267524957657, 0.015053458511829376, -0.036093760281801224, 0.012837174348533154, -0.007756992243230343, -0.012311886996030807, 0.01077200099825859, -0.008145561441779137, -0.0039000832475721836, 0.007764188107103109, -0.018881583586335182, -0.030452311038970947, 0.035777147859334946, 0.009879731573164463, -0.005727797746658325, 0.01715460978448391, 0.03574836626648903, 0.013024263083934784, -0.0016361281741410494, -6.723505794070661e-05, 0.01431229803711176, -0.012470192275941372, 0.009217724204063416, 0.019701896235346794, -0.027156667783856392, 0.009347247891128063, -0.0028603009413927794, -0.015585942193865776, 0.01564350724220276, 0.002818925539031625, -0.0021785059943795204, -0.006285466253757477, 0.009102593176066875, 0.00027726031839847565, 0.025242606177926064, -0.012002469971776009, 0.0045153177343308926, 0.030768923461437225, -0.003522307612001896, -0.0048679085448384285, -0.014398647472262383, 0.018118837848305702, 0.032812509685754776, 0.07195725291967392, 0.012211146764457226, -0.0016208372544497252, 0.02626439929008484, -0.016650909557938576, 0.02884046919643879, -0.017888573929667473, -0.022249184548854828, -0.001937449094839394, 0.010016449727118015, -0.01821957714855671, 0.013297701254487038, -0.0010559727670624852, 0.011491573415696621, -0.015355678275227547, -0.028423115611076355, -0.014204362407326698, -0.0083470419049263, -0.03923109546303749, 0.0024015733506530523, 0.020853212103247643, -0.024537423625588417, 0.00967105571180582, -0.1342434585094452, -0.011613900773227215, 0.04415297135710716, 2.5733152142493054e-05, -0.008865133859217167, 0.0019752266816794872, 0.018176402896642685, 0.013643096201121807, -0.0014373462181538343, -0.01157072652131319, 0.013535159640014172, -0.0025958579499274492, 0.0016154403565451503, -0.025976570323109627, 0.011959295719861984, -0.052240967750549316, -0.015326895751059055, -0.009814970195293427, 0.011887338943779469, -0.02603413537144661, -0.0006453666719608009, -0.006828743498772383, -0.017586354166269302, 0.019831418991088867, -0.012189559638500214, 0.0005707109812647104, -0.0022018919698894024, -0.015384461730718613, 0.040037017315626144, -0.0032650604844093323, 0.011621097102761269, 0.022263575345277786, 0.030020566657185555, 0.03807977959513664, -0.04303044080734253, 0.017931748181581497, -0.019673114642500877, -0.016794823110103607, 0.03341694921255112, 0.010635282844305038, 0.0015317901270464063, -0.0367557667195797, 0.026278790086507797, 0.020666124299168587, 0.0333881676197052, -0.009476770646870136, 0.004536904860287905, -0.022493839263916016, -0.029646389186382294, -0.0396052747964859, -0.01859375461935997, 0.011376442387700081, -0.006155943498015404, -0.0025544825475662947, 0.007332444656640291, 0.009879731573164463, -0.010217930190265179, -0.01737048104405403, -0.006411391776055098, -0.0011036443756893277, -0.003727385774254799, 0.05083060637116432, 0.014722454361617565, -0.0011342262150719762, -0.03272616118192673, -0.024163246154785156, -0.0031301407143473625, 0.03750412166118622, 0.008433390408754349, -0.006922287866473198, 0.01593133620917797, 0.013254527002573013, 0.03120066598057747, 0.008555717766284943, 0.01199527457356453, 0.02299753949046135, -0.006972657982259989, 0.005893299356102943, -0.05273027718067169, -0.012203950434923172, 0.019313327968120575, -0.02702714502811432, 0.011750619858503342, -0.008965874090790749, 0.007742600981146097, 0.01259971596300602, -0.0026660163421183825, 0.0031463310588151217, 0.02299753949046135, 0.00715255131945014, 0.03905839845538139, -0.01646381989121437, 0.013391245156526566, 0.002137130592018366, -0.002376388292759657, -0.01964433118700981, -0.019083064049482346, 0.022565795108675957, 0.01715460978448391, 0.035546883940696716, 0.02807772159576416, 0.025746306404471397, -0.019932160153985023, -0.06245889887213707, 0.007005039136856794, -0.01731291599571705, 0.01911184750497341, -0.020205598324537277, 2.9260743758641183e-05, -0.022421881556510925, 0.01843544840812683, 0.033359382301568985, 0.0033388168085366488, 0.01013877708464861, -0.006195519585162401, 0.016046468168497086, 0.040727805346250534, -0.0038065388798713684, 0.041792772710323334, -0.024695729836821556, 0.0021623156499117613, 0.019414067268371582, -0.02542969398200512, 0.026912013068795204, -0.04467106610536575, 0.02534334547817707, -0.006271074991673231, 0.040785372257232666, 0.0030599823221564293, 0.0033640016335994005, -0.05428455397486687, 0.03822369500994682, -0.00496864877641201, 0.007163344882428646, 0.014420234598219395, -0.0012700455263257027, -0.0052636731415987015, 0.0018511004745960236, -0.019327718764543533, 0.011052634567022324, -0.012347864918410778, 0.025516042485833168, 0.002556281629949808, -0.004270663019269705, -0.0018672908190637827, 0.005400392226874828, -0.008886720985174179, 0.0035061172675341368, 0.00431023957207799, -0.010520150884985924, 0.00940481387078762, -0.03258224576711655, 0.004907485097646713, 0.01859375461935997, -0.009707033634185791, -0.012268711812794209, -0.03951892629265785, -0.014398647472262383, -0.0008405506960116327, 0.03203536942601204, 0.005817744415253401, 0.055752482265233994, -0.004774364177137613, -0.01164268422871828, 0.012110406532883644, -0.02846628986299038, -0.02875411882996559, 0.0009822165593504906, -0.029963001608848572, 0.05180922523140907, 0.010074015706777573, -0.017212174832820892, 0.03448191657662392, -0.011239723302423954, 0.06240133196115494, 0.021270565688610077, -0.028955599293112755, -0.005950865335762501, -0.009203333407640457, 0.0396052747964859, 0.0001151316100731492, 0.008224714547395706, 0.0008760796044953167, -0.029502475634217262, 0.031171884387731552, -0.019155021756887436, 5.101657006889582e-05, 0.04872945323586464, -0.010642478242516518, 0.01965872198343277, 0.03140214830636978, 0.03284129127860069, -0.017039477825164795, 0.053680114448070526, 0.026077309623360634, -0.010728826746344566, -0.003155325772240758, 0.02253701351583004, -0.02124178223311901, 0.003903681179508567, -0.030078133568167686, 0.011491573415696621, 0.006217107176780701, -0.008843546733260155, -0.01585937850177288, 0.024249594658613205, 0.0032848487608134747, 0.009987667202949524, -0.02990543656051159, 0.023270977661013603, -0.020968344062566757, 0.004580079577863216, -0.009160159155726433, 0.054975345730781555, -0.03589227795600891, -0.06378291547298431, -0.00800164695829153, 0.0014688274823129177, -0.02907073125243187, 0.007274878676980734, -0.054687514901161194, -0.012153580784797668, -0.017557570710778236, 0.011693053878843784, -0.006296259816735983, -0.007864927873015404, 0.025170648470520973, 0.004954257048666477, -0.0323232002556324, 0.006681231316179037, 0.0028531053103506565, -0.0037453752011060715, 0.005137748084962368, -0.016679691150784492, -0.004655634518712759, -0.00476357014849782, -0.006137954071164131, -0.027674760669469833, -0.03992188721895218, 0.020896386355161667, 0.008980265818536282, 0.0038713004905730486, -0.023630762472748756, -0.014182775281369686, -0.0008158154087141156, -0.030222047120332718, -0.0025256997905671597, 0.04947780817747116, 0.0025778687559068203, -0.01457134447991848, 0.007130964193493128, 0.0364103727042675, 0.0028315179515630007, -0.012391039170324802, 0.02732936665415764, 0.010153168812394142, 0.01866571232676506, 0.05503290891647339, 0.023429282009601593, 0.030394745990633965, -0.0077138179913163185, 0.017111435532569885, 0.018320318311452866, -0.0045153177343308926, 0.04461349919438362, -0.04855675622820854, -0.009930101223289967, 0.00436420738697052, 0.02161595970392227, -0.007749796379357576, -0.016291122883558273, 0.03307155519723892, -0.02345806546509266, 0.04349096491932869, 0.0042418804951012135, 0.007900906726717949, 0.023947374895215034, -0.0099444929510355, 0.0067495908588171005, 0.001827714266255498, -0.02034951187670231, -0.007425989024341106, -0.03525905683636665, -0.03217928484082222, 0.001966231968253851, -0.016118425875902176, 0.0076274690218269825, 0.0023727905936539173, 0.008937091566622257, -0.001971628749743104, 0.037676818668842316, 0.03687089681625366, 0.00017831908189691603, -0.005511926021426916, -0.0024213616270571947, -0.009390422143042088, -0.005256477743387222, 0.011678663082420826, -0.008570109494030476, -0.02745888940989971, -0.0013608916196972132, 0.016363080590963364, 0.015686681494116783, -0.03986432030797005, 0.011398029513657093, 0.01259971596300602, 0.005943669471889734, -0.034712180495262146, -0.0234436746686697, 0.002657021628692746, -1.845310180215165e-05, 0.009656663984060287, 0.04153372719883919, 0.041476164013147354, 0.003322626231238246, 0.013139395043253899, 0.004749178886413574, 0.013211352750658989, 0.02154400199651718, -0.000628276786301285, -0.0031625214032828808, -0.0007897308678366244, -0.008289475925266743, -0.0014904147246852517, -0.006238694302737713, -0.035633232444524765, 0.003032998414710164, -0.032064154744148254, -9.472497913520783e-05, 0.027041537687182426, -0.0016811013920232654, 0.016981912776827812, 0.018334709107875824, 0.0013806798961013556, -0.02527138777077198, -0.016204774379730225, 0.013729444704949856, -0.004954257048666477, -0.00913857202976942, -0.00986533984541893, 0.0013213150668889284, 0.021184217184782028, -0.03566201776266098, 0.002968236804008484, -0.00284590944647789, 0.012664477340877056, -0.010153168812394142, 0.010102799162268639, -0.024868428707122803, -0.039346229285001755, 0.08254936337471008, 0.01467928010970354, -0.016722867265343666, -0.009649467654526234, -0.03292763978242874, 0.01005242858082056, 0.015154197812080383, -0.02481086179614067, -0.02596217766404152, 0.013376854360103607, -0.009843752719461918, 0.029085123911499977, 0.006371815223246813, 0.036467935889959335, 0.035863496363162994, -0.011340463533997536, 0.0017242757603526115, 0.012045645155012608, 0.01843544840812683, 0.03220806643366814, 0.03626645728945732, 0.009994862601161003, -0.005177324637770653, -0.006684829015284777, -0.04242599755525589, -0.003720190143212676, 0.018780844286084175, -0.01396690309047699, 0.022436272352933884, 0.024782078340649605, -0.0073648253455758095, 0.006760384421795607, -0.03511514142155647, 0.012311886996030807, 0.010117189958691597, 0.012686064466834068, -0.010153168812394142, 0.05834294483065605, -0.03448191657662392, -0.014398647472262383, -0.019327718764543533, -0.0006633559823967516, 0.022062094882130623, 0.013808597810566425, 0.00012547546066343784, 0.026350747793912888, 0.0032686584163457155, 0.007404401898384094, -0.005357217974960804, 0.004813940264284611, 0.025688741356134415, -0.0023404096718877554, 0.006943875458091497, -0.0049866377376019955, 0.027948198840022087, -0.021299347281455994, 0.023199019953608513, 0.019414067268371582, 0.03505757451057434, 0.0066776336170732975, -0.026120483875274658, -0.015384461730718613, -0.03065379150211811, 0.00823910627514124, -0.002685804618522525, -0.061883240938186646, -0.021817440167069435, 0.005195314064621925, -0.01217516791075468, 0.0406702421605587, -0.004137542098760605, 0.008584500290453434, 0.009081006050109863, -0.02822163514792919, 0.01172903273254633, 0.02406250685453415, -0.017413655295968056, -0.015974510461091995, 0.023875417187809944, 0.02534334547817707, -0.01476562861353159, -0.0068683200515806675, -0.019486024975776672, 0.0033640016335994005, -0.005386000499129295, 0.016866780817508698, 0.03793586418032646, -0.0013770819641649723, -0.010325866751372814, 0.010635282844305038, 0.0005032510380260646, 0.010786392726004124, 0.009397617541253567, 0.010685652494430542, -0.004342620261013508, -0.01449938677251339, -0.02214844338595867, -0.05722041055560112, 0.0014049654128029943, 0.001521895988844335, -0.00563425337895751, -0.04645560309290886, 0.018622538074851036, 0.003435959108173847, -0.027516454458236694, 0.007235302124172449, -0.06527962535619736, -0.014125209301710129, 0.029315385967493057, 0.006799960508942604, -0.00033212770358659327, -0.0031625214032828808, -0.00502621429041028, -0.011016655713319778, -0.02535773627460003, 0.017514396458864212, 0.013974099420011044, 0.057796068489551544, -0.014938326552510262, -0.019903376698493958, 0.028739728033542633, 0.022709710523486137, -0.0018726876005530357, -0.017471222206950188, -0.03514392301440239, -6.587883490283275e-06, -0.011743424460291862, 0.0004951558657921851, -0.03258224576711655, -0.007908102124929428, 0.018233967944979668, -0.004353413823992014, -0.00986533984541893, -0.031747542321681976, 0.021961355581879616, 0.029013166204094887, 0.007533924654126167, -0.020061682909727097, -0.024537423625588417, 0.016564561054110527, -0.010678457096219063, 0.02891242504119873, -0.023501239717006683, -0.057709719985723495, -0.0017764447256922722, 0.012966698035597801, 0.010635282844305038, -0.0038137345109134912, 0.029963001608848572, 0.017025087028741837, 0.008512543514370918, -0.01005242858082056, 0.0003276303759776056, -0.004065584857016802, -0.012585324235260487, -0.010707239620387554, 0.025156257674098015, -0.021831830963492393, 0.010908720083534718, -0.0016046467935666442, 0.026811273768544197, -0.01218236330896616, -0.0017800426576286554, 0.027415715157985687, 0.027602802962064743, 0.007987255230545998, -0.0027541639283299446, 0.019399676471948624, 0.03618010878562927, -0.021284956485033035, 0.022436272352933884, 0.0076274690218269825, 0.021428871899843216, 0.003184108529239893, -0.03756168857216835, -0.012484584003686905, 0.004000823479145765, 0.026696141809225082, -0.048009879887104034, 0.01791735738515854, 0.01164268422871828, 0.009613489732146263, 0.010181951336562634, 0.021040301769971848, -0.0021928974892944098, -0.0034233664628118277, 0.02632196433842182, 0.011174961924552917, -0.005213303025811911, 0.023486848920583725, 0.0166940838098526, -0.010757610201835632, -0.016751648858189583, -0.0002112620131811127, 0.025775089859962463, 0.023242194205522537, -0.02701275423169136, 0.027300583198666573, -0.02207648567855358, 0.006407793611288071, -0.013405636884272099, -0.0011962894350290298, 0.012700456194579601, -0.017773441970348358, 0.00036023600841872394, 0.01483758632093668, -0.04472862929105759, -0.01958676613867283, 0.011426812037825584, 0.0025310965720564127, 0.015758639201521873, 0.010944698937237263, -0.009045027196407318, 0.013873359188437462, 0.02315584570169449, -0.02383224293589592, 0.021069085225462914, -0.009721425361931324, -0.04012336581945419, -0.033042773604393005, -0.0030797705985605717, 0.014398647472262383, 0.017500005662441254, 0.006209911312907934, -0.03298520669341087, 0.004684417508542538, 0.017097044736146927, 0.007922493852674961, -0.010642478242516518, 0.003182309679687023, 0.018018096685409546, -0.009131375700235367, 0.003932463936507702, 0.01729852519929409, 0.021875005215406418, -0.029617607593536377, -0.009635076858103275, 0.016737258061766624, 0.026840057224035263, 0.01670847460627556, -0.033589646220207214, -0.022522620856761932, -0.016953129321336746, 0.016578951850533485, 0.030826488509774208, 0.01608964242041111, 0.03027961403131485, 0.019788244739174843, -0.026696141809225082, 0.004849919117987156, -0.026523444801568985, 0.012945109978318214, -0.02427837811410427, -0.03189145773649216, 0.010009254328906536, -0.027660369873046875, 0.021946962922811508, -0.011362050659954548, 0.01806127093732357, -0.007116572465747595, -0.012160776183009148, -0.008857938461005688, -0.006634458899497986, -0.025156257674098015, 0.02990543656051159, 0.023659545928239822, -0.013463202863931656, -0.013038654811680317, -0.03189145773649216, -0.0005922981654293835, 0.008649262599647045, -0.0030635802540928125, -0.016046468168497086, -0.0005774569581262767, 0.012693259865045547, 0.026005351915955544, -0.010613695718348026, -0.030625008046627045, 0.001694593345746398, -0.0002849057491403073, 0.03816612809896469, -0.025775089859962463, -0.00826788879930973, -0.005868114065378904, -0.003426964394748211, 0.03666941821575165, -0.0051449439488351345, -0.005486740730702877, -0.0008374025928787887, 0.028279202058911324, 0.03151727840304375, -0.00390727911144495, 0.013520768843591213, -0.026883231475949287, 0.014909543097019196, 0.010074015706777573, 0.01813322864472866, -0.01791735738515854, 0.014067643322050571, 0.008066408336162567, -0.014722454361617565, -0.024249594658613205, -0.009836557321250439, -0.01980263739824295, 0.028926817700266838, 0.0376480370759964, 0.022565795108675957, 0.024753296747803688, 0.030020566657185555, -0.0099444929510355, 0.00377415819093585, 0.014780020341277122, -0.009994862601161003, -0.002773952204734087, -0.011326071806252003, -0.005242086015641689, -0.022954365238547325, 0.0037345816381275654, -0.02063734084367752, 0.05068669095635414, 0.0003141383931506425, 0.014923934824764729, 0.005051399581134319, -0.018881583586335182, 0.026077309623360634, -0.026998363435268402, 0.02816407009959221, 9.455632971366867e-05, -0.005601872224360704, -0.027976980432868004, -0.007649056147783995, -0.00959909800440073, 0.03209293633699417, -0.01852179691195488, 0.01092311181128025, 0.002423160709440708, 0.0025149062275886536, 0.025098690763115883, 0.020968344062566757, -0.0277035441249609, -0.031085534021258354, -0.013254527002573013, -0.02573191560804844, -0.017730267718434334, -0.026926405727863312, 0.030625008046627045, -0.025012342259287834, -0.021040301769971848, -0.01342722401022911, 0.029387343674898148, 0.032064154744148254, 0.03885691985487938, 0.014808803796768188, -0.004947061184793711, -0.015499592758715153, 0.022508230060338974, 0.023011930286884308, -0.0016793024260550737, -0.010858350433409214, -0.0010343855246901512, -0.01768709346652031, 0.008318258449435234, 0.02065173350274563, -0.0019464438082650304, 0.03822369500994682, -0.0008266089716926217, -0.007267682813107967, -0.04159129410982132, -0.02351563051342964, -0.0015794617356732488, -0.02786185033619404, 0.026998363435268402, -0.00797286443412304, -0.0005994939128868282, 0.009829360991716385, 0.0005576687399297953, -0.036237675696611404, -0.01660773530602455, -0.014967109076678753, 0.014938326552510262, 0.045189157128334045, -0.012117601931095123, 0.013117807917296886, -0.011815381236374378, -0.002414165996015072, -0.008469369262456894, -0.012031253427267075, 0.021198607981204987, -0.012038448825478554]",Online Speculative Decoding.pdf
" in the observed data,
effectively adapting to variations in request rates, model
sizes, and levels of parallelism.
4.4 Modeling Generated Length
To accurately predict goodput, as defined in Equation 3, our
methodology necessitates modeling the number of tokens
produced during each generation step. The capability to ac-
curately predict the length of generated content is crucial
for minimizing computational waste and enhancing the ef-
ficiency of scheduling, as the predictions directly influence
the determination of the proposed length for generation and
the subsequent scheduling decisions. SmartSpec explores
three methods to model the accepted length.
Top1 candidate generated length. SmartSpec employs a
moving average method to estimate the token acceptance
rate for specified pairs of draft and target on a given dataset.
Concretely, SmartSpec records the token acceptance rate
from previous generation steps. For predicting the rate in
the current step, it calculates the average from these past
rates. The moving average method used requires a window
size; however, we find that the performance is relatively in-
sensitive to the choice of this window size. This approach
presupposes uniform token acceptance behavior across di-
verse requests. The acceptance length is predicted using the
formula introduced in the original speculative decoding pa-
per [20].
ùëô(ùõº,ùëò)=1‚àíùõºùëò+1
1‚àíùõº(8)
In this context, ùëôrepresents the generated length for each
request, inclusive of the bonus token. The variable ùõºde-
notes the average token acceptance rate observed within
the calibrated dataset, while ùëòcorresponds to the number of
tokens proposed. We can then write out the total number of
generated tokens in a single batch:
ùëîùëíùëõùëíùëüùëéùë°ùëíùëëùë°ùëúùëòùëíùëõùë† =‚àëÔ∏Å
ùëñ‚ààùëÖ1‚àíùõºùëòùëñ+1
ùëñ
1‚àíùõºùëñ(9)
Here, we can have different granularity of token acceptance
rate. (1) Global token acceptance rate: it is assumed that each
request exhibits identical acceptance behavior. Consequently,
different requests within the same batch share the same
token acceptance rate and proposed length, ùëò1=ùëò2=....=
ùëòùëõ,ùõº1=ùõº2=....=ùõºùëõ. (2) Request level token acceptance
rate: individual requests exhibit distinct acceptance rates ( ùõºs)
Prompt: What is your name?LLM Head 1Head 2Head 3MyHiIisnameamareyouis
Figure 8. An example Medusa-style speculative decoding
utilizing three distinct heads. Each head is tasked with gen-
erating proposals for one position. In this scenario, the first
head proposes the top three most likely tokens, the second
head selects the top two, and the third head also chooses
the top three. During this forward run, three tokens [‚ÄôMy‚Äô,
‚Äôname‚Äô, ‚Äôis‚Äô] are generated ‚Äì two from the proposals plus one
bonus token. Collectively, this setup represents a total of 18
(3x2x3) possible continuations.
and proposed lengths ( ùëòs) due to varying levels of difficulty,
necessitating the proposal of a differing number of tokens
for each.
Topk tree-style generated length. In tree-style speculative
decoding, we can have multiple candidates for the same
position. In Medusa, each head is responsible for proposing
for a position. Figure 8 shows an example, where there are
three candidates for position 1, two candidates for position
2, and three candidates for position 3.
To estimate the accepted length, we make the following
assumptions: 1. The token acceptance rate for each proposed
token at head ùëñis denoted as ùõºùëñ. All tokens within the top-
k share the same token acceptance rate. 2. The acceptance
behavior is independent across different heads; that is, the
acceptance of a token at head ùëñdoes not influence the ac-
ceptance of a token at head ùëñ+1. Suppose there are ‚Ñéheads,
and we propose ùëò1,ùëò2,...,ùëò‚Ñétokens for heads 1,2,...,‚Ñé , re-
spectively. The token acceptance rates for these heads are
ùõº1,ùõº2,...,ùõº‚Ñé. For","[0.04392663389444351, 0.011175045743584633, 0.054507702589035034, -0.023068388924002647, -0.039478715509176254, -0.018040308728814125, -0.007514493074268103, 0.0003067007928621024, 0.024283969774842262, 0.026535553857684135, 0.04384375363588333, -0.014987546019256115, -0.07265851646661758, -0.012860281392931938, 0.038484152406454086, -0.04478306323289871, 0.013115829788148403, -0.008253510110080242, -0.018371831625699997, 0.021024005487561226, 0.009745358489453793, 0.027391985058784485, 0.008357111364603043, 0.0296711977571249, 0.04820878803730011, -0.016299819573760033, 0.02199094370007515, 0.028041215613484383, 0.038484152406454086, -0.021272646263241768, 0.0001439616025891155, -0.022723054513335228, -0.013806500472128391, -0.035417575389146805, -0.009234262630343437, 0.043871380388736725, -0.020209014415740967, 0.03552808240056038, 0.009206635877490044, -0.01886911317706108, 0.00524218799546361, -0.020126134157180786, -0.06497826427221298, 0.01210745144635439, 0.02105163224041462, 0.024698371067643166, 0.007341825868934393, -0.06729891896247864, 0.008522871881723404, 0.03356657922267914, -0.04039040207862854, 0.03177083656191826, -0.005905231460928917, 0.030969658866524696, 0.018178442493081093, -0.024325409904122353, -0.014448823407292366, 0.016161685809493065, 0.016631342470645905, -0.006492301356047392, 0.035196561366319656, -0.03809737414121628, 0.013509511947631836, 0.015553896315395832, -0.020609602332115173, 0.026052085682749748, -0.010014720261096954, 0.009462183341383934, 0.009337862953543663, 0.0439818874001503, -0.0003097224689554423, 0.02514040097594261, 0.041605982929468155, 0.003867753781378269, -0.03795924037694931, 0.00890274066478014, 0.04787726700305939, 0.029836958274245262, 0.008143003098666668, 0.009634851478040218, 0.026963770389556885, 0.00031900336034595966, 0.030472375452518463, -0.061165764927864075, 0.007915082387626171, -0.040749549865722656, -0.010684669949114323, -0.046302538365125656, -0.03961684927344322, -0.042766306549310684, -0.05917663499712944, 0.008398551493883133, -0.02997509203851223, 0.01686616986989975, -0.01660371571779251, 0.0011983130825683475, 0.049037594348192215, -0.04679982364177704, 0.017473960295319557, 5.456565304484684e-06, 0.040666669607162476, -0.00022641036775894463, 0.004544610623270273, -0.018164629116654396, 0.03428487479686737, 0.007776948157697916, -0.0409981906414032, 0.04458967596292496, -0.025347601622343063, -0.022004757076501846, -0.04627491161227226, -0.012860281392931938, -0.018689539283514023, 0.01635507307946682, 0.02370380610227585, -0.041440218687057495, -0.05729801207780838, 0.005470109172165394, 0.00743851950392127, 0.019946560263633728, -0.0037054463755339384, 0.0025330334901809692, 0.017322011291980743, -0.006198766175657511, -0.027682067826390266, 0.0029750624671578407, 0.036356884986162186, -0.07696830481290817, 0.025029893964529037, -0.00198049726895988, 0.026286913082003593, 0.00426834262907505, 0.01451789028942585, 0.001999490661546588, -0.03395335376262665, -0.039340581744909286, -0.015401948243379593, 0.0003133916761726141, -0.01093331165611744, 0.03265489265322685, -0.004465183708816767, -0.034312501549720764, -0.03320743143558502, 0.013309217058122158, -0.03655027598142624, -0.0013727073092013597, -0.044810689985752106, 0.02083061821758747, -0.06497826427221298, 0.01852377876639366, -0.019946560263633728, -0.025637682527303696, -0.03704755753278732, 6.750223110429943e-05, 0.018730979412794113, -0.06204982474446297, -0.03864991292357445, 0.003411911427974701, -0.005787817295640707, -0.025168027728796005, -0.04815353453159332, 0.023938633501529694, -0.017791667953133583, -0.017874548211693764, 0.00566695025190711, 0.043401725590229034, -0.009814425371587276, -0.01039458904415369, -0.06967482715845108, -0.013095109723508358, 0.015512456186115742, -0.05517074838280678, -0.0070068505592644215, -0.05199366435408592, -0.019186822697520256, -0.039174821227788925, -0.050833337008953094, -0.04627491161227226, 0.0422690249979496, -0.03953396901488304, -0.025085147470235825, 0.05611005797982216, 0.006464674603193998, 0.025168027728796005, -0.01886911317706108, -0.01605117879807949, -0.03773822635412216, 0.006288553588092327, 0.04044565558433533, 0.019946560263633728, 0.028372736647725105, 0.04445154219865799, 0.08812953531742096, -0.0345887690782547, -0.05367890000343323, -0.06177355349063873, 0.06011594459414482, 0.02147984690964222, 0.049120474606752396, 0.006975770462304354, 0.02485031820833683, 0.020609602332115173, 0.02693614363670349, -0.030969658866524696, 0.027571560814976692, 0.007258945144712925, -0.006347260437905788, -0.040279895067214966, -0.0025727469474077225, 0.0008818996720947325, 0.026148779317736626, -0.009862772189080715, 0.0474076122045517, -0.0043546766974031925, -0.015540082938969135, 0.0251956544816494, -0.03505842760205269, 0.022101450711488724, 0.007569747045636177, 0.0431254543364048, 0.005245641339570284, 0.012749774381518364, 0.01507042720913887, 0.03552808240056038, -0.011672329157590866, 0.052325185388326645, 0.016893796622753143, 0.014131114818155766, 0.029312049970030785, 0.0029681557789444923, 0.005414855666458607, 0.03632925823330879, -0.00788054894655943, -0.0499492771923542, -0.009918025694787502, 0.007832201197743416, 0.008419271558523178, -0.005142040550708771, -0.0251956544816494, -0.07995200157165527, -0.0054632024839520454, -0.003468891838565469, -0.0018544498598203063, -0.008661005645990372, -0.03911956772208214, 0.011810462921857834, -0.050529442727565765, -0.030278988182544708, 0.00804630946367979, 0.051247738301754, -0.02019520103931427, -0.06586232036352158, -0.013640739023685455, 0.02989221177995205, -0.04845743253827095, 0.02766825444996357, -0.024877944961190224, 0.010035440325737, -0.02950543724000454, 0.0024380662944167852, -0.024325409904122353, -0.024947011843323708, -0.029947465285658836, 0.0367160364985466, -0.03981023654341698, -0.039091940969228745, -0.009040874429047108, -0.02856612578034401, 0.02809646911919117, -0.03478216007351875, -0.01336447149515152, -0.03149456903338432, 0.007058650720864534, 0.009807518683373928, -0.044727809727191925, -0.01703193038702011, 0.010069973766803741, -0.0005080743576399982, -0.06597282737493515, -0.009096127934753895, 0.001529834815301001, -0.04467255622148514, 0.08288043737411499, 0.0047034649178385735, 0.003168450202792883, -0.00036454445216804743, 0.02997509203851223, 0.011402967385947704, 0.011941689997911453, -0.04210326448082924, 0.018454711884260178, -0.014628398232161999, 0.010967845097184181, -0.05790580064058304, 0.02677038311958313, 0.005995018407702446, -0.005249094683676958, 0.004133662208914757, -0.00975917186588049, -0.032129984349012375, 0.05627581849694252, 0.0262592863291502, 0.039893120527267456, -0.024712184444069862, -0.01989130489528179, -0.025941578671336174, 0.006803102791309357, 0.013875567354261875, 0.012749774381518364, -0.013695992529392242, 0.007970335893332958, 0.021148325875401497, -0.056082431226968765, 0.01588541828095913, -0.016507020220160484, -0.05028080195188522, 0.09404167532920837, -0.03851177915930748, -0.015954485163092613, -0.04265579953789711, -0.02817934937775135, -0.012950069271028042, 0.022184330970048904, 0.015899231657385826, 0.026148779317736626, -0.031245926395058632, -0.026328353211283684, -0.008930367417633533, 0.011451314203441143, -0.02215670421719551, 0.030196107923984528, -0.014890852384269238, 0.034229621291160583, -0.00674784928560257, -0.017197690904140472, -0.043235961347818375, -0.021700862795114517, 0.029394930228590965, 0.043650366365909576, 0.04265579953789711, -0.03450588881969452, 0.006150419358164072, 0.016838543117046356, -0.031273551285266876, -0.02958831749856472, 0.009938745759427547, 0.01398607436567545, 0.03099728561937809, 0.07227174192667007, 0.0035914857871830463, -0.0034395381808280945, -0.020802991464734077, 0.054038047790527344, -0.013917007483541965, 0.027682067826390266, 0.007742414716631174, 0.03804212063550949, -0.05019792169332504, -0.036909423768520355, 0.012860281392931938, -0.042296651750802994, 0.049811143428087234, -0.0012881001457571983, 0.0023310123942792416, -0.0053285215981304646, -0.02442210353910923, -0.022778308019042015, -0.016976676881313324, -0.029698824509978294, -0.010449842549860477, -0.029615944251418114, 0.09249456971883774, -0.046937957406044006, 0.0005076426896266639, -0.035196561366319656, -0.0054286690428853035, -0.04580525681376457, 0.03505842760205269, 0.012266305275261402, 0.03450588881969452, 0.0009341316181235015, 0.00877151358872652, -0.028455618768930435, -0.004140568897128105, -0.0030475829262286425, 0.032433878630399704, 0.005076427012681961, -0.003206436987966299, -0.047932520508766174, -0.035417575389146805, -0.013378284871578217, 0.01483559887856245, 0.01690760999917984, 0.029091034084558487, 0.015650589019060135, 0.03425724804401398, -0.010284081101417542, 0.044175274670124054, 0.020070880651474, 0.022640174254775047, 0.010042347013950348, -0.013758152723312378, -0.029477810487151146, 0.0007502406369894743, -0.016935236752033234, 0.01029098778963089, 0.032599639147520065, 0.022350091487169266, 0.035334695130586624, 0.003902287455275655, 0.028538499027490616, -0.002134171314537525, 0.05077808350324631, -0.03445063531398773, 0.026438860222697258, 0.034478262066841125, 0.03522418811917305, 0.02101019211113453, 0.03389810025691986, 0.056303445249795914, -0.025471922010183334, -0.06348641961812973, -0.034947920590639114, -0.01694905012845993, -0.04845743253827095, -0.01891055330634117, 0.03240625187754631, 0.010539629496634007, 0.023220336064696312, -0.04862319305539131, -0.02980933152139187, 0.04318070784211159, 0.02707427740097046, -0.04845743253827095, -0.0105672562494874, 0.013564765453338623, 0.03986549377441406, 0.01917300932109356, -0.021631795912981033, -0.05669021978974342, -0.01118885912001133, -0.020954938605427742, -0.0038781140465289354, 0.005425215698778629, -0.02027808129787445, 0.03591485694050789, 0.0009764351998455822, -0.030776269733905792, 0.03135643154382706, -0.021369339898228645, 0.0071967849507927895, 0.0034447184298187494, 0.022612547501921654, 0.035500455647706985, -0.003636379260569811, -0.03735145181417465, 0.10277174413204193, 0.016465580090880394, 0.039257701486349106, -0.022184330970048904, 0.02505752071738243, -0.0010653589852154255, -0.033842846751213074, -0.03632925823330879, -0.016838543117046356, -0.028068842366337776, 0.003947181161493063, 0.007069010753184557, 0.011271740309894085, 0.02241915836930275, 0.009054687805473804, -0.039727356284856796, 0.01326087024062872, 0.0013364470796659589, 0.02485031820833683, 0.02395244687795639, 0.023855753242969513, -0.016258379444479942, 0.028621379286050797, 0.007569747045636177, -0.006892890203744173, -0.028759513050317764, 0.05315398797392845, 0.01895199343562126, 0.01511186733841896, 0.07453714311122894, 0.06332065910100937, -0.017667347565293312, 0.012383718974888325, -0.01980842463672161, -0.000735563924536109, -0.0307486429810524, 0.043650366365909576, -0.01656227558851242, -0.011209579184651375, -0.0035189653281122446, -0.0014909845776855946, -0.013979167677462101, -0.05171739682555199, -0.00966938491910696, 0.04522509500384331, -0.010090693831443787, -0.008080842904746532, 0.03555570915341377, -0.011416780762374401, -0.016658969223499298, -0.026715129613876343, 0.021700862795114517, -0.03171558305621147, 0.03530706837773323, -0.0320194773375988, 0.002527853474020958, -0.020733922719955444, 0.00566695025190711, -0.016714222729206085, -0.00165156542789191, -0.058347828686237335, 0.03505842760205269, -0.011451314203441143, -0.012777401134371758, -0.020609602332115173, -0.0019269702024757862, -0.014697465114295483, -0.007514493074268103, 0.009517436847090721, -0.05086096376180649, -0.04146784543991089, -0.09801993519067764, -0.017308197915554047, 0.008357111364603043, 0.02842799201607704, -0.009489810094237328, -0.0034395381808280945, 0.058347828686237335, -0.019656477496027946, -0.006792742758989334, -0.004299422726035118, 0.012860281392931938, -0.03605299070477486, -0.0036087525077164173, -0.015222374349832535, -0.00561514962464571, 0.002657354110851884, -0.016037365421652794, -0.024242529645562172, -0.01295697595924139, 0.018081748858094215, -0.0249746385961771, -0.026245472952723503, -0.0009246349218301475, 0.019836051389575005, 2.4699558707652614e-05, 0.014628398232161999, -0.004955559503287077, -0.04450679570436478, -0.011244113557040691, 0.0010921225184574723, 0.010677763260900974, -0.013647645711898804, 0.0029353490099310875, 0.022170517593622208, 0.009061594493687153, -0.003360111266374588, 0.0007679390837438405, -0.012535667046904564, 0.01240443903952837, 0.0003610910789575428, 0.02697758376598358, 0.029615944251418114, 0.01389628741890192, -0.023344658315181732, -0.02578962966799736, 0.030113227665424347, -0.06635960936546326, -0.0010714023374021053, -0.013323030434548855, -0.004624038003385067, -0.00047354085836559534, -0.0016645154682919383, 0.012335372157394886, -0.008833673782646656, 0.0016869623214006424, -0.024173462763428688, -0.02881476655602455, -0.02826222963631153, 0.04063904285430908, 0.01158944796770811, 0.014172554947435856, -0.024283969774842262, 0.03853940591216087, 0.0019114301539957523, 0.0043546766974031925, 0.0069550503976643085, 0.012915534898638725, -0.019435463473200798, 0.015263814479112625, 0.028676632791757584, -0.008716260083019733, -0.017819294705986977, -0.005715297069400549, 0.010850431397557259, 0.003622565884143114, -0.02323414944112301, 0.014241622760891914, -0.03516893461346626, 0.023206522688269615, -0.014697465114295483, 0.02270924113690853, 0.02241915836930275, 0.010532722808420658, 0.0014270975952968001, 0.023206522688269615, -0.02787545509636402, -0.007182971574366093, -0.007272758521139622, -0.0047587184235453606, -0.040887683629989624, -0.02172848954796791, 0.03514130786061287, 0.007348732557147741, 0.031439315527677536, -0.02040240168571472, -0.00999400019645691, 0.012729054316878319, 0.01142368745058775, 0.01668659597635269, -0.01733582466840744, -0.026949957013130188, 0.004033514764159918, 0.00627474021166563, 0.0028593752067536116, -0.0010429122485220432, -0.0010826257057487965, 0.02386956661939621, -0.027737321332097054, 0.027516305446624756, 0.01232155878096819, 0.019711731001734734, -0.011796649545431137, -0.01214889157563448, 0.018606659024953842, 0.008999434299767017, 0.009897305630147457, -0.03505842760205269, -0.0021030912175774574, -0.009614131413400173, 0.009600318036973476, 0.019311143085360527, -0.006706409156322479, -0.019145382568240166, -0.031245926395058632, -0.02587251178920269, 0.04373324662446976, -0.0032565107103437185, 0.019545970484614372, -0.03751721233129501, -0.006067539099603891, -0.01588541828095913, 0.026065899059176445, -0.021189766004681587, -0.010422215797007084, -0.013882474042475224, -0.0473799854516983, -0.020761549472808838, 0.01670040935277939, 0.035251814872026443, 0.029643571004271507, 0.019697917625308037, -0.003432631492614746, -0.007949615828692913, -0.0726032629609108, 0.061165764927864075, 0.01929732970893383, -0.008267324417829514, -0.015940671786665916, -0.006333447061479092, -0.04892708733677864, -0.031052539125084877, -0.014013701118528843, 0.02638360671699047, -0.03950634226202965, 0.0014167375629767776, -0.030803896486759186, -0.022142890840768814, 0.023841939866542816, -0.01340591162443161, 0.030969658866524696, -0.009344769641757011, 0.033317938446998596, 0.004817425739020109, -0.0013822040054947138, -0.005528816021978855, 0.03116304613649845, -0.03583197668194771, -0.0125978272408247, -0.002621093997731805, -0.021286459639668465, 0.01792980171740055, 0.00015594041906297207, -0.0296711977571249, -0.0337323397397995, 0.017874548211693764, -0.006654608529061079, -0.003456805134192109, -0.008598845452070236, -0.010228827595710754, 0.016493206843733788, 0.048485059291124344, 0.03403623402118683, -0.014324503019452095, 0.00828113779425621, 0.031135419383645058, 0.004990093410015106, 0.004437556955963373, -0.013695992529392242, -0.0014193275710567832, 0.0052387346513569355, -0.020001813769340515, -0.004157835617661476, -0.048650819808244705, -0.02664606086909771, 0.0018976167775690556, -0.019490716978907585, 0.019587410613894463, 0.004375396762043238, 0.01668659597635269, -0.016852356493473053, 0.005311254877597094, -0.042296651750802994, 0.009952559135854244, -0.0012535667046904564, 0.02642504684627056, 0.015857791528105736, -0.030251361429691315, -0.02950543724000454, -0.0025779269635677338, -0.020526722073554993, 0.009835145436227322, -0.03489266708493233, 0.003356657922267914, 0.03061050921678543, -0.036826543509960175, -0.026245472952723503, 0.021424593403935432, 0.028317483142018318, 0.001762072672136128, 0.013626925647258759, 0.04757337272167206, 0.0006146965897642076, -0.010587976314127445, -0.003505151951685548, 0.012432065792381763, -0.0060226451605558395, -0.008474525064229965, 0.03552808240056038, 0.006620075087994337, 0.02023664116859436, -0.0005918181268498302, -0.007093184161931276, 0.022833561524748802, 0.005908684805035591, -0.006392153911292553, -0.006430140696465969, 0.012376812286674976, 0.006043365690857172, -0.010049253702163696, -0.010532722808420658, 0.004309782758355141, 0.011416780762374401, 0.014283062890172005, 0.007383265998214483, -0.021079258993268013, 0.01801268197596073, 0.018247511237859726, 0.04967300966382027, -0.03569384291768074, 0.009248076006770134, 0.018993433564901352, -0.019863678142428398, 0.016410326585173607, -0.0036432859487831593, -0.006067539099603891, -0.028925273567438126, 0.015401948243379593, -0.03044474869966507, -0.0013148636789992452, -0.009448369964957237, 0.01618931256234646, 0.008446898311376572, -0.040970563888549805, -0.014131114818155766, -0.005729110445827246, -0.01964266411960125, -0.008564312011003494, 0.0017042290419340134, -0.0015160214388743043, -0.011962410062551498, -0.12973551452159882, -0.021189766004681587, 0.02693614363670349, -0.023413725197315216, 0.00017374675371684134, 0.00907540787011385, 0.0251956544816494, -0.003584579098969698, -0.01639651320874691, 0.013150363229215145, 0.008488338440656662, -0.0027972147800028324, 0.012245585210621357, -0.020609602332115173, 0.022142890840768814, -0.04859556630253792, -0.03340081870555878, -0.01955978386104107, 0.023165082558989525, -0.028842393308877945, -0.00881986040621996, -0.010615603066980839, -0.01721150428056717, -0.005104053765535355, -0.005894871428608894, -0.03986549377441406, -0.005704937037080526, -0.020443841814994812, 0.011492754332721233, 0.010594883002340794, -0.00926879607141018, 0.008612658828496933, 0.0031788102351129055, 0.049894023686647415, -0.031908970326185226, 0.0107813635841012, -0.009234262630343437, -0.004772532265633345, 0.01933876983821392, -0.0015997651498764753, 0.02305457554757595, -0.04992165043950081, 0.027571560814976692, 0.005905231460928917, -0.00037101947236806154, -0.021369339898228645, -0.00958650466054678, 0.012963882647454739, -0.007300385273993015, -0.00016478962788823992, -0.0384288989007473, 0.0033134908881038427, 0.00369853968732059, -0.003108016448095441, -0.005107507109642029, 0.024173462763428688, 0.008868207223713398, -0.0067098625004291534, 0.01802649535238743, -0.001964957220479846, 0.01479415874928236, 0.04602627083659172, 0.016631342470645905, -0.013889380730688572, -0.013039856217801571, -0.03207473084330559, -0.002115177921950817, 0.010746830143034458, -0.02873188629746437, -0.011948596686124802, 0.009248076006770134, 0.007293478585779667, 0.03978260979056358, 0.024283969774842262, 0.001417600899003446, 0.008149909786880016, 0.009600318036973476, 0.01389628741890192, -0.01340591162443161, 0.01381340716034174, 0.04765625298023224, -0.04478306323289871, -0.008764606900513172, -0.01746014691889286, 0.013378284871578217, 0.0038573937490582466, 0.03945108875632286, 0.005988111719489098, -0.023206522688269615, 0.02599683217704296, 0.024449730291962624, -0.04947962239384651, -0.008122283034026623, 0.016893796622753143, -0.02019520103931427, -0.04052853584289551, -0.001982223941013217, 0.011762116104364395, 0.025775816291570663, 0.012867188081145287, 0.012245585210621357, 0.037379078567028046, -0.024187276139855385, -0.04588813707232475, -0.0030838430393487215, -0.00788054894655943, 0.0046516647562384605, -0.018772419542074203, 0.01768116094172001, -0.008149909786880016, -0.009185915812849998, 0.0012604733929038048, -0.012383718974888325, -0.007549026980996132, 0.005383775103837252, 0.03771059960126877, 0.06088949739933014, 0.005805084016174078, 0.031577449291944504, -0.006098619196563959, -0.0065924483351409435, 0.03898143395781517, -0.018330391496419907, 0.02207382395863533, -0.035804349929094315, 0.032820653170347214, -0.00021475530229508877, 0.05453532934188843, 0.021383153274655342, -0.009572691284120083, -0.01968410424888134, 0.03163270279765129, 0.007500679697841406, 0.005811990704387426, 0.005269814748317003, 0.001659335452131927, 0.017142437398433685, 0.00024561965255998075, -0.023593299090862274, 0.011023098602890968, -0.028068842366337776, 0.006240206304937601, 0.0516621395945549, 0.00224640523083508, -0.02181136980652809, -0.023980073630809784, -0.031826090067625046, -0.011023098602890968, -0.01073992345482111, -0.001959776971489191, 0.005846524611115456, -0.01938020996749401, 0.009676291607320309, -0.0047034649178385735, 0.015056613832712173, 0.013253963552415371, -0.01420018170028925, -0.018717166036367416, 0.015153307467699051, 0.03022373467683792, 0.05243569239974022, 0.04936911538243294, 0.018606659024953842, 0.007265851832926273, 0.007051744032651186, -0.02015376091003418, -0.015899231657385826, -0.008688632398843765, -0.010684669949114323, 0.013910100795328617, 0.0019701372366398573, -0.03812500089406967, 0.02591395191848278, 0.004541157279163599, 0.035196561366319656, 0.005770550575107336, -0.001186226261779666, 0.0022688519675284624, 0.00667187524959445, 0.056469205766916275, 0.030665762722492218, -0.013958447612822056, -0.01792980171740055, -0.013868660666048527, 0.022225771099328995, -0.034312501549720764, 0.00980061199516058, 0.05583379045128822, 0.0018423631554469466, -0.0017309925751760602, -0.007949615828692913, 0.047711506485939026, -0.011851903051137924, 0.03704755753278732, 0.009766078554093838, -0.01997418701648712, 0.002318925689905882, 0.008543591946363449, -0.01717006415128708, -0.018592845648527145, -0.02881476655602455, 0.024574050679802895, -0.02634216658771038, 0.03177083656191826, -0.01123029924929142, 0.0072865718975663185, -0.008522871881723404, 0.019103942438960075, -0.010864244773983955, 0.018855299800634384, -0.002075464464724064, 0.008736980147659779, -0.014642211608588696, 0.04649592563509941, -0.037461958825588226, -0.04069429636001587, 0.007410892751067877, 0.013868660666048527, -0.0032392439898103476, -0.024104394018650055, -0.03083152323961258, -0.009469090029597282, -0.013992981053888798, -0.025223281234502792, -0.005193841177970171, 0.0029198089614510536, 0.01635507307946682, 0.013026042841374874, -0.01451789028942585, -0.005677310284227133, 0.0022947522811591625, 0.008937274105846882, -0.004689651541411877, -0.034865040332078934, -0.0021980584133416414, 0.019697917625308037, -0.006271286867558956, -0.025941578671336174, -0.03378759324550629, 0.008757700212299824, 0.01609261892735958, 0.008723166771233082, 0.014849412254989147, 0.005684216972440481, -0.00966938491910696, -0.04514221474528313, 0.010339334607124329, 0.01955978386104107, -0.013606205582618713, -0.015692031010985374, -0.01447645016014576, 0.023800499737262726, 0.04072192311286926, -0.0011542828287929296, 0.033621832728385925, -0.010235734283924103, 0.01853759214282036, 0.04599864408373833, 0.023538045585155487, 0.02736435830593109, -0.005822350736707449, -0.008315671235322952, 0.0011965864105150104, -0.03561096265912056, 0.024062953889369965, -0.033621832728385925, -0.016493206843733788, -0.007314199116080999, 0.01997418701648712, -0.006081352476030588, -0.015360508114099503, 0.02225339785218239, -0.01750158704817295, 0.0670226514339447, 0.01232155878096819, -0.01882767304778099, 0.048015400767326355, -0.03351132571697235, 0.022046197205781937, -0.005214561242610216, -0.018509965389966965, -0.017266757786273956, -0.022861188277602196, -0.02407676726579666, 0.023731432855129242, -0.029394930228590965, 0.0010593156330287457, -0.0012622000649571419, 0.0007580107194371521, 0.003695086343213916, 0.05425906181335449, 0.01955978386104107, 0.004689651541411877, 0.011789742857217789, -0.009952559135854244, -0.00999400019645691, 0.013039856217801571, 0.021535100415349007, 0.014241622760891914, -0.04663406312465668, -0.008018682710826397, -0.002961249090731144, 0.008502151817083359, -0.04381612688302994, 0.01613405905663967, 0.02750249207019806, 0.04022464156150818, -0.02160416729748249, -0.021466033533215523, -0.01389628741890192, 0.008184443227946758, 0.03367708623409271, 0.019186822697520256, 0.037213318049907684, 0.033235058188438416, -0.011769022792577744, -0.010284081101417542, 0.0036294725723564625, 0.02646648697555065, -0.00042562559247016907, -0.01668659597635269, -0.002165251411497593, -0.015305254608392715, 0.0066442484967410564, -0.01631363295018673, -0.0016058085020631552, -0.0019338768906891346, -0.025029893964529037, -0.0022705786395817995, 0.027999775484204292, -0.0033825580030679703, 0.026535553857684135, 0.012756681069731712, -0.002828295109793544, -0.01980842463672161, -0.017612094059586525, 0.010774456895887852, 0.010422215797007084, -0.019697917625308037, -0.04224139824509621, 0.013965354301035404, -0.011216485872864723, -0.027695881202816963, 0.021314086392521858, 0.004023154731839895, 0.018385645002126694, -0.0006336900405585766, -0.005169667303562164, -0.012183425016701221, -0.036439765244722366, 0.07674729079008102, 0.0034637118224054575, -0.051081977784633636, -0.001233709859661758, -0.00309074972756207, 0.0051903873682022095, 0.020167574286460876, -0.049037594348192215, -0.015388134866952896, -0.0008693812997080386, -0.023151269182562828, 0.027378171682357788, 0.027999775484204292, 0.026507927104830742, 0.024574050679802895, 0.006706409156322479, -0.003432631492614746, 0.0067823827266693115, 0.019145382568240166, 0.010180480778217316, 0.043650366365909576, 0.0026694408152252436, -0.015263814479112625, -0.006620075087994337, -0.029698824509978294, 0.0034360848367214203, 0.0064370473846793175, 0.023800499737262726, 0.022833561524748802, 0.03787636011838913, 0.006226392928510904, -0.011775929480791092, -0.04599864408373833, 0.008377831429243088, 0.011078352108597755, -0.01048437599092722, -0.009918025694787502, 0.04307020083069801, -0.023772872984409332, -0.012031476944684982, -0.01668659597635269, 0.01699049025774002, 0.0474076122045517, 0.030638135969638824, 9.982344636227936e-05, 0.026825636625289917, 0.010132133960723877, 0.020954938605427742, 0.016493206843733788, -0.01623075269162655, 0.015360508114099503, -0.013806500472128391, -0.003187443595379591, -0.006720222532749176, 0.03116304613649845, -0.032129984349012375, -0.01101619191467762, 0.010180480778217316, 0.0204990953207016, -0.010111413896083832, -0.04146784543991089, -0.005183480679988861, -0.03232337161898613, -0.021590353921055794, -0.018261324614286423, -0.053734153509140015, 0.02002944052219391, 0.013557858765125275, 0.025112774223089218, 0.05019792169332504, -0.00962794478982687, 0.002514040097594261, 0.01150656770914793, -0.01447645016014576, 0.030196107923984528, -0.000711822125595063, -0.011306273750960827, -0.005515002645552158, 0.009379303082823753, 0.034229621291160583, 0.002147984690964222, -0.011416780762374401, -0.02736435830593109, -0.0071622515097260475, -0.005939764901995659, 0.010657043196260929, 0.04522509500384331, 0.005594429560005665, -0.0009583050850778818, 0.030776269733905792, -0.028676632791757584, 0.0025744736194610596, 0.016810916364192963, -0.007376359310001135, 0.012653080746531487, -0.01039458904415369, 0.023938633501529694, -0.041523098945617676, -0.027322918176651, -0.002804121468216181, 0.0013165903510525823, -0.03566621616482735, -0.004903759341686964, 0.022101450711488724, -0.03434012830257416, 0.00627474021166563, -0.06934329867362976, -0.009006340987980366, 0.011554914526641369, -0.0018527231877669692, -0.011575634591281414, -0.010284081101417542, -0.013281590305268764, -0.0025589335709810257, -0.03693705052137375, 0.03237862512469292, -0.0020495641510933638, 0.023980073630809784, 0.00317017687484622, -0.02672894299030304, 0.030113227665424347, 0.0375724658370018, 0.0075766537338495255, -0.013081296347081661, -0.017957428470253944, -0.0021220846101641655, -0.010995471850037575, 0.0022325918544083834, 0.008419271558523178, -0.016797102987766266, -0.0007800257881172001, -0.006357620470225811, -0.019918931648135185, 0.004475543741136789, 0.002928442321717739, 0.03574909642338753, -0.005501189269125462, -0.013972260989248753, -0.021245019510388374, 0.006537194829434156, -0.011078352108597755, 0.02058197557926178, -0.03121829964220524, -0.045363228768110275, 4.556805652100593e-05, 0.01891055330634117, 0.008419271558523178, 0.008357111364603043, 0.015636775642633438, 0.023344658315181732, -0.004838145803660154, -0.0012371632037684321, -0.013626925647258759, 0.0023448257707059383, -0.018164629116654396, -0.02258492074906826, 0.033621832728385925, -0.004088768269866705, 0.007618093863129616, 0.013564765453338623, 0.028538499027490616, -0.010726110078394413, -0.008467618376016617, 0.017874548211693764, 0.024311596527695656, -0.015153307467699051, -0.01721150428056717, 0.03337319195270538, 0.027391985058784485, 0.007528306916356087, 0.014241622760891914, -0.007065557409077883, 0.010629416443407536, 0.01007688045501709, -0.027170971035957336, -0.004724184982478619, -0.012881001457571983, 0.03997600078582764, -0.0036570995580404997, 0.027806388214230537, -0.0028939086478203535, -0.010498189367353916, 0.030030345544219017, 0.033925727009773254, -0.004375396762043238, -0.005404495168477297, 0.011520381085574627, 0.012791214510798454, -0.01882767304778099, 0.05041893571615219, 0.005870698019862175, -0.005131680518388748, -0.028538499027490616, -0.014241622760891914, 0.022184330970048904, -0.008039402775466442, 0.0052387346513569355, -0.019076315686106682, -0.005594429560005665, 0.009572691284120083, -0.008515965193510056, 0.0035776724107563496, 0.04602627083659172, -0.009027061052620411, 0.017667347565293312, -0.005090240389108658, -0.013274683617055416, -0.008364018052816391, 0.0035172386560589075, -0.0037710601463913918, 0.03304166719317436, -0.011810462921857834, 0.004078408237546682, 0.010546536184847355, 0.04768387973308563, -0.06144203245639801, 0.006029551848769188, -0.008205163292586803, -0.02270924113690853, -0.00858503207564354, -0.003493065247312188, 0.030389495193958282, 0.008992527611553669, 0.012452785857021809, -0.03809737414121628, -0.008681725710630417, 0.0014866678975522518, 0.013053669594228268, -0.01639651320874691, 0.02728147804737091, 0.03326268494129181, -0.05541938915848732, -0.002398352837190032, 0.025568615645170212, 0.02856612578034401, -0.022405344992876053, -0.013951540924608707, 0.005718750413507223, 0.037848733365535736, 0.001377887325361371, -0.016106432303786278, 0.0018630832200869918, -0.012162704952061176, 0.027654441073536873, 0.030721016228199005, 0.021535100415349007, 0.005000453442335129, 0.020015627145767212, -0.02331703156232834, -0.0007856375304982066, -0.00534924166277051, 0.003456805134192109, -0.014393569901585579, -0.03480978682637215, -0.006205672863870859, -0.0039920746348798275, -0.00377796683460474, -0.0010791723616421223, 0.026618434116244316, 0.03301404044032097, 0.014725091867148876, 0.006153872702270746, 0.005097147077322006, -0.020001813769340515, -0.011907156556844711, 0.010125227272510529, -0.03641213849186897, -0.004475543741136789, -0.023814313113689423, -0.015015172772109509, 0.004789798986166716, 0.025430481880903244, -0.019269702956080437, -0.014082768000662327, 0.03226811811327934, 0.011976223438978195, 0.006675328593701124, -0.04279393330216408, -0.011603261344134808, 0.02172848954796791, 0.03881567344069481, -0.010512002743780613, -0.019076315686106682, -0.0006686552078463137, -0.017625907436013222, -0.004934839438647032, -0.00780457491055131, -0.001958050299435854, 0.019145382568240166, 0.016534648835659027, 0.042379532009363174, -0.002206691773608327, 0.01326087024062872, -0.028510872274637222, -0.00499354675412178, 0.005331974942237139, 0.02552717551589012, -0.03375996649265289, 0.01451789028942585, 0.014124208129942417, -0.03141168877482414, -0.011983130127191544, 0.00041375469299964607, -0.028110282495617867, 0.004264889284968376, 0.02599683217704296, -0.016576088964939117, 0.02514040097594261, 0.024007700383663177, -0.01976698450744152, 0.015125680714845657, 0.01033242791891098, -0.008025589399039745, 0.015056613832712173, -0.0131296431645751, 0.009192822501063347, -0.0022360451985150576, -0.025692936033010483, -0.03478216007351875, 0.022405344992876053, -0.0055184559896588326, 0.017598280683159828, 0.005072973668575287, -0.02856612578034401, 0.018855299800634384, -0.03710281103849411, -0.003847033716738224, -0.0009643484372645617, -0.0012043564347550273, -0.021714676171541214, 0.008294951170682907, 0.001678328961133957, 0.023386098444461823, -0.03475452959537506, -0.004782892297953367, 0.009185915812849998, 0.015401948243379593, -0.012984602712094784, 0.047324731945991516, -0.018551405519247055, -0.015526269562542439, 0.0082189766690135, -0.049092847853899, -0.0052387346513569355, -0.0064681279473006725, 0.03188134357333183, -0.005860337987542152, -0.011368433944880962, -0.03566621616482735, 0.01792980171740055, 0.04334647208452225, 0.028193162754178047, 0.023676179349422455, -0.025333788245916367, 0.004641304723918438, 0.02958831749856472, 0.018095562234520912, -0.005628963466733694, -0.02335847169160843, -0.02989221177995205, 0.010401495732367039, -0.003864300437271595, 0.033925727009773254, 0.003373924642801285, 0.019532157108187675, 0.005811990704387426, -0.015443388372659683, -0.0034412648528814316, -0.0071967849507927895, 0.02544429525732994, -0.039340581744909286, 0.03804212063550949, -0.004596411250531673, -0.02305457554757595, 0.019946560263633728, -0.02117595262825489, -0.022267211228609085, -0.02881476655602455, 0.023413725197315216, -0.008384738117456436, 0.026673687621951103, -0.026949957013130188, 0.013771966099739075, -0.008067029528319836, 0.021783743053674698, -0.015056613832712173, -0.02754393219947815, 0.02293025515973568, 0.00233791908249259]",Online Speculative Decoding.pdf
" simplicity in the formula below, we define
ùõº‚Ñé+1=0. The expected accepted length given the structure
can be formulated as:
ùëô(ùõº1...ùõº‚Ñé,ùëò1...ùëò‚Ñé)=‚àëÔ∏Å
ùëñ=1..‚Ñé(ùëñ+1)√ó(1‚àíùõºùëñ+1)√óŒ†ùëó=1¬∑¬∑¬∑ùëñ[1‚àí(1‚àíùõºùëó)ùëòùëó]
(10)
Here,(1‚àíùõºùëñ+1)√ó√éùëñ
ùëó=1[1‚àí(1‚àíùõºùëó)ùëòùëó]represents the prob-
ability of accepting (ùëñ+1)tokens, where the ""+1"" accounts
for the bonus token. To understand this probability, it hinges
on two conditions: (1) At least one token is accepted from
heads 1 through ùëñ. (2) None of the proposed tokens at head
ùëñ+1are accepted. Thus, the probability is calculated as the
product of the probabilities of conditions (1) and (2).
Since SmartSpec is a versatile speculative decoding frame-
work, users can integrate various estimation methods, such
7
as the confidence-based method discussed in the Appendix.
Additionally, users may even employ machine learning mod-
els for predictions. We leave it as future work to develop an
accurate and efficient predictor for accepted length.
5 Serving Requests Using SmartSpec
We now describe the flow of a single decoding step outlined
in Algorithm 2. Initially, we enumerate potential requests
for a single batch (line 2). SmartSpec uses a first-come, first-
served strategy. Assuming ùëõrequests in the pending batch,
we construct candidate batches by selecting prefixes of in-
creasing length: batches with 1 request, 2 requests, etc., up
toùëõrequests. For each potential batch, we use goodput to
determine the optimal proposed length (line 4). Addition-
ally, we verify if there is sufficient space in the KV cache
(lines 5-7). For Top-1 candidate speculative decoding, Smart-
Spec will determine the optimal proposed length. For Top-k
tree-style speculative decoding, SmartSpec will identify the
optimal Top-k value for each proposal head. In both cases,
the token acceptance rate is factored into Eqn. 8 to calcu-
late the estimated generation length. SmartSpec then uses
this estimated length along with Eqn. 3 and a performance
model (elaborated in Sec. 4.3) to estimate goodput. After
identifying the optimal proposed lengths or Top-k value,
SmartSpec executes these steps sequentially. For draft-model
based speculative decoding, the proposal phase operates
in an autoregressive manner and incorporates continuous
batching (line 12). Then SmartSpec verifies the proposed
tokens and records the token acceptance rate of current step
(line 13).
To estimate the current token acceptance rate, SmartSpec
records the acceptance rate from previous scoring steps (line
13 in Alg. 2) and computes the moving average of these rates
(lines 5-8 in Alg. 1). Although moving average is an imperfect
estimator for token acceptance rate, goodput remains robust
and results in latency reduction to be discussed in Sec. 7.2.1.
Prefill disabling. In draft-model based speculative decoding,
the prefill phase of the running draft model can introduce
overhead, especially when request rate is high. By default,
speculative decoding is disabled during the prefill phase.
However, to synchronize the KV cache between the draft
and target models, the system still executes the draft model‚Äôs
prefill phase by default, even if no tokens are subsequently
proposed by SmartSpec. This can lead to the wasteful con-
sumption of memory and computational resources. To ad-
dress this issue, we use a feedback-based method that auto-
matically disables the draft model‚Äôs prefill run. For each gen-
eration step, SmartSpec records the proposed length. During
each prefill phase, SmartSpec checks the proposed length
from previous decoding steps. If the percentage of times
no tokens were proposed exceeds a predefined threshold,
SmartSpec will disable the draft model‚Äôs prefill run for the
current request and classify the request as non-speculative.
Since the draft model‚Äôs KV cache is not maintained for theseAlgorithm 1 Goodput Estimation for Step-level Proposed
Length
Require: Proposed length ùëòfor all requests in the batch for Top-1
candidate speculative decoding. Number","[0.03543141484260559, 0.038000062108039856, 0.027857884764671326, -0.022323381155729294, -0.04628857597708702, -0.025938021019101143, -0.014816051349043846, 0.016073893755674362, 0.01403486542403698, 0.02389899268746376, 0.04967812821269035, -0.006348790600895882, -0.06689070165157318, 0.015888527035713196, 0.061170827597379684, -0.03161817044019699, 0.010685034096240997, -0.017675986513495445, -0.017358215525746346, 0.017199330031871796, -0.0024081049486994743, 0.015888527035713196, -0.0017493930645287037, 0.028202135115861893, 0.026653004810214043, -0.030717819929122925, 0.008493741974234581, 0.024071117863059044, 0.05571576952934265, -0.04242236912250519, -0.019026510417461395, -0.027487151324748993, -0.013227199204266071, -0.04957220330834389, 0.030320605263113976, 0.012121622450649738, -0.023197250440716743, 0.0037635948974639177, -0.008209072053432465, -0.02111850120127201, -0.005133980419486761, -0.028175653889775276, -0.07928375154733658, 0.022217456251382828, 0.03553733974695206, 0.04692411795258522, 0.005799312610179186, -0.03169761225581169, -0.0053160362876951694, 0.04432899132370949, -0.04808927699923515, 0.03328646346926689, -0.00285827973857522, 0.014524761587381363, 0.02751363255083561, -0.00860628578811884, 0.012532075867056847, 0.0005772003787569702, 0.04517637938261032, 0.01541187148541212, 0.04091295599937439, -0.031194474548101425, 0.009334509260952473, 0.01786135323345661, -0.04448787495493889, 0.009241826832294464, -0.01725229248404503, 0.054100435227155685, 0.011697928421199322, 0.04083351418375969, 0.002280665561556816, -0.011016045697033405, 0.038079503923654556, -0.030585413798689842, -0.035961031913757324, 0.00773241650313139, 0.039191700518131256, 0.052273254841566086, 0.008513602428138256, -0.0025438193697482347, 0.004309763200581074, -0.0037304938305169344, 0.0029658584389835596, -0.05937013030052185, -2.561456130933948e-05, -0.04432899132370949, -0.02203209139406681, -0.02735474705696106, -0.018152642995119095, -0.06175340712070465, -0.03765580803155899, 0.01282336562871933, -0.02799028903245926, 0.02735474705696106, 0.001752703101374209, 0.007229279726743698, 0.030241163447499275, -0.02111850120127201, 0.014829291962087154, 0.009394091553986073, 0.03916521742939949, -0.0058655147440731525, 0.013743575662374496, -0.04750669747591019, 0.04819519817829132, 0.011254373006522655, -0.040859997272491455, 0.07255760580301285, 0.0050379871390759945, -0.04009205102920532, -0.06657292693853378, -0.021303866058588028, -0.032942213118076324, 0.03114151395857334, -0.003958891145884991, -0.040621668100357056, -0.07123356312513351, -0.0012810125481337309, -0.0016070583369582891, 0.042687177658081055, -0.0039688218384981155, 0.01387597993016243, 0.014829291962087154, -0.012591658160090446, -0.04607672989368439, -0.0016583650140091777, 0.044514358043670654, -0.09480154514312744, -0.002614986849948764, 0.0003146673261653632, -0.00480296928435564, -0.006454714108258486, 0.03662305325269699, 0.018669018521904945, -0.015835564583539963, -0.032703883945941925, -0.03593455255031586, -0.001288460218347609, 0.007328582927584648, 0.04231644421815872, 0.0057794516906142235, -0.03720563277602196, -0.0028483495116233826, 0.030320605263113976, -0.03760284557938576, 0.012181203812360764, -0.030664857476949692, -0.004640773870050907, -0.06932693719863892, 0.011366916820406914, -0.013650893233716488, -0.015239745378494263, -0.035007722675800323, -0.03180353343486786, 0.027460670098662376, -0.04178682714700699, -0.04509693756699562, 0.02385927177965641, 0.012459252960979939, -0.0027242202777415514, -0.031909458339214325, 0.03664953634142876, -0.0019628950394690037, -0.002752356231212616, 0.006762554403394461, 0.03312757983803749, -0.01590176671743393, -0.016921281814575195, -0.055133190006017685, -0.014259953051805496, 0.02997635491192341, -0.024269724264740944, -0.00358815910294652, -0.03410737216472626, -0.043878816068172455, -0.01087702065706253, -0.05523911118507385, -0.06027048081159592, 0.04631505534052849, -0.07393461465835571, -0.04048926383256912, 0.03680841997265816, -0.01123451255261898, 0.00936099048703909, -0.00910280179232359, -0.029393775388598442, -0.03527253121137619, 0.028678791597485542, 0.05110809579491615, 0.022204216569662094, 0.028599347919225693, 0.03537845239043236, 0.048963144421577454, -0.03866208344697952, -0.04501749202609062, -0.04679171368479729, 0.04970460757613182, 0.03458402678370476, 0.03680841997265816, 0.004220390226691961, 0.003166120033711195, 0.011737649329006672, 0.030903184786438942, -0.011856812983751297, 0.05518615245819092, -0.002747391117736697, 0.007858200930058956, -0.021608397364616394, -0.014498281292617321, -0.01302197203040123, 0.011505941860377789, -0.0030833673663437366, 0.057198695838451385, -0.004895652178674936, -0.01689480058848858, 0.03291573375463486, -0.012856466695666313, 0.033101096749305725, 0.007500709034502506, 0.03964187577366829, 0.009314648807048798, -0.0014696887228637934, 0.015080859884619713, 0.013472147285938263, -0.01877494342625141, 0.06127675250172615, 0.005273004993796349, 0.02254846878349781, 0.03535197302699089, -0.017066925764083862, -0.00773241650313139, 0.01825856603682041, -0.01645786687731743, -0.02838750183582306, -0.004465338308364153, -0.007652973756194115, 0.007897921837866306, -0.00946029368788004, -0.028811195865273476, -0.08007817715406418, 0.007454367354512215, 0.017119888216257095, -0.0041972193866968155, -0.013445666059851646, -0.03461050987243652, 0.007335203234106302, -0.055133190006017685, -0.051876042038202286, 0.017066925764083862, 0.055133190006017685, 0.00747422780841589, -0.05873458832502365, 0.003338245674967766, -0.0034027928486466408, -0.052591025829315186, 0.012790264561772346, 0.0010923362569883466, 0.01292266882956028, -0.03360423445701599, 0.006315689533948898, -0.02870527282357216, -0.04954572394490242, -0.022680873051285744, 0.01987389847636223, -0.01175088994204998, -0.023567982017993927, 0.00834809709340334, -0.023170769214630127, 0.023011883720755577, -0.05486838147044182, 0.0015855425735935569, 0.008136250078678131, -0.015557516366243362, 0.005769521463662386, -0.033816080540418625, -0.03744396194815636, -0.0009450363577343524, 0.012710821814835072, -0.07997225224971771, -0.004306452814489603, -0.00013395601126831025, -0.031830016523599625, 0.07059802114963531, 0.030638376250863075, 0.029526179656386375, 0.0017378076445311308, 0.01661675050854683, 0.008420919068157673, 0.004313073121011257, -0.008420919068157673, 0.02683836966753006, -0.0055014025419950485, 0.012690961360931396, -0.07028025388717651, 0.04295198619365692, -0.011022665537893772, 0.0031677749939262867, -0.0035318871960043907, -0.004107846412807703, -0.04374641180038452, 0.07176318019628525, 0.03283628821372986, 0.04520285874605179, -0.007408025674521923, -0.006633460056036711, -0.01582232490181923, -0.011260993778705597, 0.008354716934263706, -0.00023501779651269317, -0.035404935479164124, 0.01901327073574066, 0.007414645981043577, -0.050128303468227386, -0.0027655968442559242, -0.011486081406474113, -0.06085306033492088, 0.06244191154837608, -0.035802148282527924, -0.013068313710391521, -0.024759622290730476, -0.020191669464111328, -0.016947763040661812, 0.006554017309099436, 0.003948960918933153, 0.054100435227155685, -0.04176034405827522, -0.012975630350410938, 0.03352479264140129, 0.012068659998476505, -0.008440780453383923, 0.022852998226881027, 0.004558021202683449, 0.02600422315299511, -0.03479587286710739, -0.016193056479096413, -0.03585511073470116, -0.021224424242973328, 0.015491314232349396, 0.03757636621594429, 0.03821190819144249, -0.03450458496809006, -0.00179407955147326, 0.01602093130350113, -0.017278773710131645, -0.02298540249466896, 0.02421676367521286, 0.018788183107972145, 0.006610289216041565, 0.08367957919836044, 0.02187320590019226, 0.0011585383908823133, -0.018073199316859245, 0.04266069456934929, -0.028202135115861893, 0.018841145560145378, -0.006798965390771627, 0.015491314232349396, -0.061011943966150284, -0.05139938369393349, 0.007368304301053286, -0.027222342789173126, 0.041336651891469955, 0.02306484431028366, -0.01917215622961521, 0.005041297059506178, -0.0012446013279259205, -0.02981746941804886, -0.007321963086724281, -0.04353456571698189, -0.022058572620153427, -0.00308667728677392, 0.09093533456325531, -0.014471800066530704, -0.021383309736847878, -0.04758613929152489, -0.030347086489200592, -0.01697424240410328, 0.044832129031419754, -0.00132238888181746, 0.021224424242973328, 0.011863433755934238, 0.007103495765477419, -0.03961539268493652, -0.025117112323641777, 0.013505248352885246, 0.026891332119703293, 0.00854670349508524, 0.004720216616988182, -0.04303142800927162, -0.025236276909708977, -0.024031396955251694, 0.009883987717330456, 0.009473534300923347, 0.009268307127058506, 0.0017493930645287037, 0.03442514315247536, -0.015345669351518154, 0.028413983061909676, 0.03649064898490906, 0.021542195230722427, 0.02091989479959011, -0.02997635491192341, -0.02783140353858471, -0.007858200930058956, -0.024084359407424927, -0.01861605793237686, 0.035404935479164124, 0.0062925186939537525, 0.007765517570078373, 0.006838686764240265, 0.05383562669157982, -0.019701773300766945, 0.048565931618213654, -0.05571576952934265, 0.023793069645762444, 0.0013819708256050944, 0.03874152526259422, 0.03913873806595802, 0.03969483822584152, 0.05137290433049202, -0.014220232143998146, -0.033816080540418625, -0.03145928308367729, -0.015160302631556988, -0.06874436140060425, 0.009857507422566414, 0.05349137634038925, -0.0034491345286369324, 0.02822861634194851, -0.062494874000549316, -0.032386112958192825, 0.03426625579595566, 0.04533526301383972, -0.054815419018268585, -0.01594148948788643, 0.018285047262907028, 0.01941048353910446, -0.0034789254423230886, -0.012353329919278622, -0.047533176839351654, -0.028096212074160576, -0.03805302083492279, -0.0075271897949278355, 0.013730335049331188, -0.02111850120127201, 0.031247437000274658, -0.010095834732055664, -0.015478073619306087, 0.027698999270796776, -0.030797261744737625, 0.02453453466296196, 0.01984741911292076, 0.018536614254117012, 0.0011659861775115132, -0.018827904015779495, -0.028890637680888176, 0.09067052602767944, 0.0013621101388707757, 0.02965858392417431, 0.0032819737680256367, 0.047056522220373154, 0.011274234391748905, -0.02751363255083561, -0.03784117475152016, -0.031062070280313492, -0.013002111576497555, 0.0007890474516898394, 0.02389899268746376, 0.01028120145201683, 0.04999589920043945, 0.02552756667137146, -0.022680873051285744, 0.018232084810733795, 0.008639386855065823, 0.016404904425144196, 0.02330317348241806, 0.04255477339029312, -0.0006901578744873405, 0.022363102063536644, 0.00854670349508524, -0.007600012235343456, -0.03431921824812889, 0.05214085057377815, 0.008255413733422756, 0.04191923141479492, 0.08717504888772964, 0.05071088299155235, -0.017914313822984695, 0.003697392763569951, -0.04438195377588272, 0.005004886072129011, -0.04692411795258522, 0.030664857476949692, -0.014895494095981121, 0.0027755270712077618, 0.011995838023722172, 0.011347056366503239, 0.008659247308969498, -0.003899309318512678, 0.019423725083470345, 0.032306671142578125, -0.001041029579937458, 0.0018900727154687047, 0.01820560358464718, -0.008626146242022514, 0.013154376298189163, -0.03114151395857334, -0.009738342836499214, -0.01805995963513851, 0.01506762020289898, -0.022958921268582344, -0.017503861337900162, -0.025779135525226593, 0.017080167308449745, -0.029605621472001076, 0.015014657750725746, -0.04454083740711212, 0.013088174164295197, -0.01741117797791958, -0.01506762020289898, -0.027328265830874443, -0.01574288308620453, 0.001999306259676814, 0.005852274131029844, 0.012902808375656605, -0.04385233297944069, -0.03884745016694069, -0.10279876738786697, -0.011578763835132122, -0.008235553279519081, 0.016325460746884346, -0.018192363902926445, -0.004309763200581074, 0.05192900449037552, -0.023011883720755577, 0.010625452734529972, -0.014935215003788471, 0.023038364946842194, -0.014167269691824913, -0.01805995963513851, 0.008632766082882881, -0.017000723630189896, 0.0058787548914551735, -0.015491314232349396, -0.004369345027953386, -0.03630528599023819, 0.03201538324356079, -0.00824879389256239, -0.02822861634194851, 0.0003595606831368059, 0.0005312726134434342, -0.00225087464787066, 0.017623024061322212, -0.015319188125431538, -0.03344535082578659, 0.01697424240410328, -0.004644084256142378, 0.01474984921514988, -0.007639733608812094, -0.010274580679833889, 0.001414244412444532, -0.008301755413413048, -0.02425648458302021, -0.008924055844545364, -0.008394438773393631, 0.005723179783672094, 0.026454398408532143, -0.01439235731959343, 0.01896030828356743, 0.014485040679574013, -0.04334919899702072, -0.02441537007689476, 0.006318999454379082, -0.05404747277498245, 0.022098293527960777, -0.03296869248151779, -0.016908040270209312, -0.0030734369065612555, 0.006017779465764761, 0.002911241492256522, -0.015967968851327896, 0.0016699504340067506, -0.015279467217624187, -0.01129409484565258, -0.03794709965586662, 0.03892689198255539, 0.0038397274911403656, 0.02675892785191536, 0.001326526515185833, 0.011982597410678864, -0.00368746230378747, 0.005759591236710548, 0.018139401450753212, 0.024468332529067993, -0.0045447805896401405, 0.011221271939575672, -0.006279278080910444, -0.016603510826826096, -0.03691434487700462, -0.006640080362558365, 0.000980620039626956, 0.020906653255224228, -0.01594148948788643, 0.004948614165186882, -0.040859997272491455, 0.02667948417365551, -0.01586204580962658, 0.007096875458955765, 0.03519308567047119, -0.00011388846905902028, 0.01123451255261898, 0.025302479043602943, -0.024865545332431793, -0.02767251804471016, -0.04591784253716469, -0.019463445991277695, -0.045308783650398254, -0.02775195986032486, 0.02095961570739746, 0.009910468943417072, 0.03741748258471489, -0.02656032145023346, 0.002451136242598295, 0.012849845923483372, 0.008917436003684998, -0.007659594062715769, -0.006524226628243923, -0.006338860373944044, 0.004352794494479895, 0.0014581034192815423, 0.005047917366027832, 0.02095961570739746, 0.007467607501894236, 0.018867626786231995, -0.030029315501451492, 0.015094100497663021, 0.03450458496809006, -0.005127360112965107, 0.003998612519353628, -0.012618138454854488, 0.006792345549911261, -0.0030883324798196554, 0.015133822336792946, -0.042846061289310455, 0.01841745153069496, -0.014921975322067738, 0.0002569472708273679, 0.025779135525226593, -0.004342864267528057, -0.014763089828193188, -0.03122095577418804, -0.015650199726223946, 0.038873929530382156, -0.00538885872811079, 0.03045300953090191, -0.016193056479096413, -0.012174583971500397, -0.035961031913757324, 0.03792061656713486, -0.008626146242022514, -0.004452097695320845, -0.016351941972970963, -0.031035589054226875, 0.007977364584803581, 0.020019544288516045, 0.02838750183582306, 0.04242236912250519, 0.00019229669123888016, 0.016722675412893295, -0.0034491345286369324, -0.06620219349861145, 0.039430029690265656, 0.016246018931269646, -0.011638346128165722, -0.001356317545287311, -0.01749061979353428, -0.025461364537477493, -0.039509471505880356, -0.00132238888181746, 0.038105983287096024, -0.02663976326584816, -0.00493206363171339, -0.046818193048238754, -0.026666244491934776, 0.0023385926615446806, -0.014630685560405254, 0.043640486896038055, 0.010486427694559097, 0.03487531840801239, -0.0006036812555976212, -0.012816744856536388, -0.006325619760900736, 0.03855615854263306, -0.05661612004041672, -0.014485040679574013, 0.007520569488406181, -0.003409413155168295, 0.018192363902926445, -0.01996658183634281, -0.025871818885207176, -0.05171715468168259, 0.022601429373025894, -0.011439739726483822, -0.021740801632404327, -0.012644619680941105, -0.01042022556066513, -0.005514643155038357, 0.028758233413100243, 0.044514358043670654, -0.016431385651230812, 0.014114308170974255, 0.022958921268582344, -0.012796884402632713, -0.015835564583539963, -0.027381228283047676, -7.416714652208611e-05, 0.0045944321900606155, -0.008228933438658714, 0.015041138976812363, -0.04525582119822502, -0.02934081293642521, -0.02989691123366356, -0.03267740458250046, 0.006160114426165819, -0.0024412060156464577, -0.009639039635658264, -0.00564704742282629, 0.014312914572656155, -0.008593045175075531, 0.015848806127905846, 0.007209419272840023, 0.016471106559038162, 0.017239052802324295, -0.032465558499097824, -0.012373190373182297, 0.0014729988761246204, -0.027381228283047676, 0.011274234391748905, -0.012571796774864197, 0.003644431009888649, 0.00910942256450653, -0.029632102698087692, -0.017186090350151062, 0.03479587286710739, 0.02751363255083561, -0.030108759179711342, -0.0010584075935184956, 0.03969483822584152, -0.016921281814575195, -0.005362377967685461, -0.01792755536735058, 0.011486081406474113, -0.03384256362915039, -0.012790264561772346, 0.05661612004041672, -0.0002728771651163697, 0.011347056366503239, 0.016722675412893295, -0.005177011713385582, 0.013002111576497555, -0.020946374163031578, 0.015027898363769054, -0.007242520339787006, 0.021383309736847878, 0.015875287353992462, 0.008513602428138256, -0.006729453336447477, -0.007024053018540144, 0.02159515582025051, 0.012843226082623005, 0.01677563600242138, -0.016510827466845512, -0.003998612519353628, 0.02437564916908741, 0.061488598585128784, -0.019503166899085045, -0.024508053436875343, 0.005726490169763565, -0.013068313710391521, 0.015769362449645996, 0.007216039579361677, -0.035961031913757324, -0.024388888850808144, 0.024402130395174026, -0.04398474097251892, 0.013174236752092838, 0.010294441133737564, 0.04040982201695442, -0.007129976525902748, -0.03288925066590309, -0.0037139432970434427, -0.007335203234106302, -0.030161719769239426, -0.005739730317145586, -0.005362377967685461, -0.009797925129532814, -0.0001478170888731256, -0.1298622339963913, 0.013743575662374496, 0.01200907863676548, 0.001896692905575037, 0.0025620250962674618, 0.000710846099536866, 0.009857507422566414, 0.007785378489643335, 0.007977364584803581, -0.00990384817123413, 0.02302512340247631, 0.001524305553175509, 0.018232084810733795, -0.02342233620584011, -0.010850540362298489, -0.04154849797487259, 0.0007629803149029613, -0.010228238999843597, 0.007897921837866306, -0.02949969843029976, -0.006176664959639311, -0.027222342789173126, -0.040859997272491455, 0.0019314490491524339, -0.00886447448283434, -0.010691654868423939, -0.008553323335945606, -0.025593768805265427, 0.015583996661007404, 0.0017460829112678766, 0.01143311895430088, 0.017596542835235596, 0.001972825499251485, 0.04048926383256912, -0.03296869248151779, -0.0004439684853423387, -0.016841838136315346, -0.005935026798397303, 0.04954572394490242, 0.01933104172348976, 0.03156520798802376, -0.04552062973380089, 0.03220074996352196, 0.008884334936738014, 0.024521293118596077, -0.02894360013306141, 0.011128589510917664, -0.0035517478827387094, 0.007454367354512215, -0.005941647104918957, -0.009096181951463223, 0.01804671809077263, -0.002648087916895747, -0.005084328819066286, -0.003925790078938007, 0.01967529207468033, 0.018086440861225128, -0.01175088994204998, 0.002598436316475272, 0.03220074996352196, -0.001045167213305831, 0.03161817044019699, 0.032942213118076324, -0.011366916820406914, -0.03259796276688576, -0.025275997817516327, 0.011227892711758614, -0.0020737838931381702, 0.00018609024118632078, -0.012273887172341347, 0.008871094323694706, 0.013266920112073421, 0.021092019975185394, 0.014021624810993671, -0.000634713564068079, 0.02393871359527111, -0.01204879954457283, 0.004667254630476236, -0.04851296916604042, 0.015319188125431538, 0.04867185279726982, -0.016722675412893295, -0.008215692825615406, 0.0010253065265715122, -0.0056801484897732735, 0.00789130199700594, 0.02799028903245926, 0.01741117797791958, -0.01139339804649353, 0.010956463403999805, 0.03474291414022446, -0.030717819929122925, -0.0004522437520790845, -0.004548090975731611, -0.03265092149376869, -0.041972193866968155, 0.011572143994271755, -0.01071813516318798, 0.023236971348524094, 0.008427539840340614, 0.04168090224266052, 0.03447810560464859, -0.00858642440289259, -0.04096591845154762, -0.022800035774707794, -0.013266920112073421, 0.006501055788248777, -0.01836448907852173, 0.002360108308494091, 0.0041475677862763405, -0.013200717978179455, 0.005739730317145586, 0.00910280179232359, -0.0009077975992113352, 0.006398442201316357, 0.021846724674105644, 0.044196587055921555, -0.00288807088509202, 0.032862771302461624, -0.03858264163136482, 0.0005734765436500311, 0.05518615245819092, -0.022561708465218544, 0.027487151324748993, -0.043719928711652756, 0.01947668567299843, -4.4169279135530815e-05, 0.05018126592040062, 0.0033647266682237387, -0.0038397274911403656, -0.015875287353992462, 0.04326975718140602, 0.0013348017819225788, -0.008434159681200981, 0.013981903903186321, -0.0023236970882862806, 0.012260646559298038, -0.001954619772732258, -0.03913873806595802, 0.008010465651750565, -0.010539389215409756, 0.01629898138344288, 0.010274580679833889, 0.004898962564766407, -0.010433466173708439, -0.020827211439609528, -0.01308155432343483, -0.012115001678466797, -0.013458906672894955, -0.007950883358716965, 0.01852337457239628, -0.01892058737576008, -0.0067559340968728065, -0.02822861634194851, 0.014312914572656155, 0.002005926566198468, -0.039112258702516556, -0.0015723021933808923, 0.0039191702380776405, 0.02604394406080246, 0.03482235595583916, 0.04107184335589409, 0.020297592505812645, -0.0032472177408635616, 0.014246712438762188, -0.026547079905867577, -0.018298286944627762, -0.0021979128941893578, -0.005984678398817778, 0.0022591499146074057, 0.007950883358716965, -0.007063774392008781, 0.02997635491192341, 0.023038364946842194, 0.05555688217282295, 0.026772167533636093, -0.0051737017929553986, 0.01073799654841423, 0.0015574066201224923, 0.048009831458330154, 0.03204186260700226, 0.0037106331437826157, 0.005855584051460028, -0.006117083132266998, 0.02854638732969761, -0.04369344934821129, 0.02282651700079441, 0.04152201861143112, 0.0022144634276628494, -0.00012868051999248564, 0.013359603472054005, 0.040303897112607956, -0.006898269057273865, 0.024825824424624443, -0.004869171418249607, 0.005004886072129011, -0.0010741306468844414, 0.011082247830927372, -0.00860628578811884, -0.0016169886803254485, -0.02997635491192341, 0.02099933661520481, -0.04567951709032059, 0.014246712438762188, 0.00528955552726984, 0.007414645981043577, 0.002995649352669716, 0.02099933661520481, -0.00368746230378747, -0.016073893755674362, -0.022720593959093094, 0.00046838054549880326, -0.029870430007576942, 0.06275968253612518, -0.03646416962146759, -0.029870430007576942, 0.011731029488146305, 0.021264145150780678, -0.024666938930749893, -0.03217426687479019, -0.026454398408532143, -0.026388196274638176, -0.011903154663741589, -0.03336590528488159, -0.00531934667378664, -0.00561725627630949, 0.003512026509270072, 0.021489232778549194, -0.0022641150280833244, 0.017000723630189896, 0.0006897441344335675, 0.010128935799002647, -0.004392515867948532, -0.021846724674105644, -0.027222342789173126, 0.004101226106286049, -0.0023203869350254536, -0.017199330031871796, -0.030876703560352325, 0.020575642585754395, -0.000638437457382679, 0.014511520974338055, 0.010764476843178272, 0.010552629828453064, 0.017424417659640312, -0.019503166899085045, 0.0025140284560620785, 0.027381228283047676, 0.0011221271706745028, -0.011770750395953655, -0.013942182064056396, 0.017437659204006195, 0.022601429373025894, -0.012843226082623005, 0.007772137876600027, 0.002565335016697645, 0.02091989479959011, 0.03609343618154526, 0.013346362859010696, 0.014326155185699463, -0.024799343198537827, -0.018139401450753212, -0.005958197638392448, -0.008917436003684998, 0.021144980564713478, -0.03196242079138756, -0.002260805107653141, -0.010168657638132572, -0.003162809880450368, -0.0029162068385630846, -0.03328646346926689, 0.02091989479959011, -0.023157527670264244, 0.05351785570383072, 0.013213958591222763, -0.017225811257958412, 0.021621637046337128, -0.03529901057481766, 0.02568645216524601, -0.0024958227295428514, -0.011400017887353897, -0.018947068601846695, -0.01784811168909073, -0.012545316480100155, 0.016312221065163612, -0.032942213118076324, -0.0042468709871172905, -0.008553323335945606, -0.003452444449067116, 0.0030701267533004284, 0.05264398455619812, 0.027487151324748993, -0.005868824664503336, 0.011684687808156013, -0.02981746941804886, -0.028731754049658775, 0.005792692303657532, 0.03495476022362709, 0.003740424057468772, -0.03691434487700462, 0.0006115427822805941, -0.0007116736378520727, -0.0045447805896401405, -0.025818856433033943, 0.028970081359148026, 0.012174583971500397, 0.026666244491934776, -0.03156520798802376, -0.027328265830874443, -0.00920872576534748, -0.0009864127496257424, 0.02215125411748886, 0.02370038628578186, 0.03569622337818146, 0.02381955087184906, 0.012167963199317455, 0.000374249299056828, 0.004124396946281195, 0.03114151395857334, 0.01972825452685356, -0.0027507012709975243, 0.00747422780841589, -0.0074477470479905605, 0.009672140702605247, -0.024878785014152527, -0.018271805718541145, -0.008500361815094948, -0.013213958591222763, -0.0005871307221241295, 0.008142869919538498, 0.011625105515122414, 0.024825824424624443, 0.012022319249808788, 0.015319188125431538, -0.024124080315232277, -0.00665994081646204, -0.01941048353910446, -0.019251598045229912, -0.02350177988409996, -0.025977741926908493, 0.0015392010100185871, -0.004994955845177174, -0.028202135115861893, 0.005640427116304636, -0.02262791059911251, 0.006603668909519911, 0.009447053074836731, -0.028996562585234642, -0.01836448907852173, -0.022005610167980194, 0.07409349828958511, 0.017225811257958412, -0.022416064515709877, -0.014683647081255913, -0.013101414777338505, -0.012882946990430355, 0.00711673591285944, -0.03903281316161156, -0.03686138242483139, 0.003113158280029893, -0.018192363902926445, 0.029685065150260925, 0.024799343198537827, 0.03863560035824776, 0.012585037387907505, -0.01423347182571888, -0.011969356797635555, 0.011711168102920055, 0.027884364128112793, 0.015954729169607162, 0.027778441086411476, -0.005090948659926653, -0.012379811145365238, -0.0006818826077505946, -0.03604047745466232, -0.0024114151019603014, 0.016762396320700645, 0.011572143994271755, 0.03863560035824776, 0.019701773300766945, 0.01876170188188553, -0.011585384607315063, -0.03988020122051239, 0.0022674251813441515, 0.01685507968068123, -0.023157527670264244, -0.018351249396800995, 0.04430250823497772, -0.017424417659640312, -0.008778410963714123, -0.04684467241168022, 0.00906308088451624, 0.04009205102920532, 0.03535197302699089, 0.017503861337900162, 0.023554742336273193, 0.022614670917391777, 0.01840420998632908, 0.025103872641921043, -0.014127548784017563, 0.02294568158686161, 0.004915513098239899, 0.015173543244600296, -0.014670406468212605, 0.03169761225581169, -0.04080703482031822, 0.010671794414520264, 0.007235900033265352, 0.042448848485946655, -0.0031032280530780554, -0.056880928575992584, -0.012492354027926922, -0.019781216979026794, -0.02366066537797451, -0.001433277502655983, -0.04533526301383972, 0.011731029488146305, 0.023435577750205994, -0.011823711916804314, 0.04289902374148369, -0.008083288557827473, 0.026772167533636093, -0.0037602847442030907, -0.0023816239554435015, 0.029367294162511826, 0.00483276043087244, -0.010698274709284306, -0.008559944108128548, 0.009135902859270573, 0.03013524040579796, -0.011472840793430805, -0.007302102167159319, -0.004955234471708536, -0.00874530989676714, 0.015160302631556988, 0.03069133870303631, 0.03929762542247772, 0.0027722169179469347, 0.008924055844545364, 0.04239588603377342, -0.039191700518131256, -0.007798618637025356, -0.0010170312598347664, -0.01665647327899933, 0.008619526401162148, -0.015319188125431538, 0.024719899520277977, -0.04454083740711212, -0.008533462882041931, -0.006213075947016478, 0.006865167524665594, -0.029552660882472992, 0.01578260399401188, 0.01474984921514988, -0.02023139037191868, 0.015014657750725746, -0.05428580194711685, -0.03431921824812889, 0.014114308170974255, 0.001584715093486011, -0.0019628950394690037, -0.01415403001010418, -0.016643231734633446, -0.014498281292617321, -0.04168090224266052, 0.025434883311390877, -0.0017775290179997683, 0.02644115686416626, -0.01578260399401188, -0.018947068601846695, 0.03100910782814026, 0.041733864694833755, 0.005610635969787836, 0.0016020931070670485, -0.017834872007369995, -0.00010768201173050329, -0.013942182064056396, -0.00920210499316454, -0.008778410963714123, -0.01669619418680668, 0.0015003072330728173, -0.0018784872954711318, -0.008175970986485481, 0.01002301275730133, -0.0009624144295230508, 0.02799028903245926, 0.006017779465764761, -0.019238358363509178, -0.01967529207468033, -0.0010964738903567195, -0.021264145150780678, -0.0002494995133019984, -0.03355127200484276, -0.03463698923587799, 0.0013670753687620163, 0.00946029368788004, -0.012194444425404072, -0.0009557941812090576, 0.016802117228507996, 0.03948298841714859, -0.014921975322067738, -0.002075438853353262, -0.00355836795642972, 0.01383625902235508, -0.02342233620584011, -0.0042601111344993114, 0.02949969843029976, 0.012353329919278622, 0.023872511461377144, 0.023832790553569794, 0.013902461156249046, -0.010797577910125256, -0.013306641019880772, 0.01351848803460598, 0.03845023736357689, -0.024997949600219727, -0.0006715385243296623, 0.009711862541735172, 0.03789413720369339, 0.024666938930749893, 0.00946029368788004, 0.0019595851190388203, 0.027963807806372643, 0.008255413733422756, -0.03132687881588936, -0.002075438853353262, -0.016947763040661812, 0.03077078051865101, 0.005445130635052919, 0.02743419073522091, 0.013273539952933788, 0.004415686707943678, 0.033657196909189224, 0.014339395798742771, 0.011446359567344189, 0.009625799022614956, 0.021264145150780678, 0.00824879389256239, -0.018695499747991562, 0.051955483853816986, 0.007566911168396473, -0.0030817121732980013, -0.014524761587381363, -0.008096528239548206, 0.024004915729165077, 0.0026166418101638556, 0.01403486542403698, -0.022243937477469444, -0.020893413573503494, 0.026149867102503777, -0.02191292680799961, -0.016444625332951546, 0.03823838755488396, -0.025580529123544693, 0.016193056479096413, 0.003056886373087764, -0.019344281405210495, -0.034689951688051224, 0.0017642885213717818, 0.006034329999238253, 0.018430691212415695, -0.007136596832424402, 0.01733173429965973, 0.002527268836274743, 0.05240565910935402, -0.05184955894947052, -0.014988177455961704, 0.0018834525253623724, -0.0024759620428085327, -0.017477380111813545, -0.018377728760242462, 0.02481258288025856, 0.007659594062715769, 0.005425270181149244, -0.024878785014152527, -0.0019248288590461016, 0.00480296928435564, 0.020310834050178528, -0.022323381155729294, 0.001554096583276987, 0.01802023872733116, -0.030558934435248375, 0.01439235731959343, -0.0007940125651657581, 0.04115128517150879, -0.03355127200484276, 0.0026050563901662827, -0.005120739806443453, 0.02759307622909546, -0.010612212121486664, -0.04560007154941559, -0.010393745265901089, -0.0020092367194592953, 0.008824752643704414, 0.03172409161925316, 0.023726867511868477, 4.8177615099120885e-05, 0.016669712960720062, -0.021025817841291428, 6.402993312804028e-05, -0.015583996661007404, -5.694423452951014e-05, -0.012492354027926922, -0.058152008801698685, -0.016947763040661812, -0.030744299292564392, -0.009043220430612564, -0.01760978437960148, 0.04581192135810852, 0.02862582914531231, 0.0030618514865636826, -0.011572143994271755, -0.003995302598923445, -7.375338464044034e-05, -0.019026510417461395, 0.007758897263556719, -0.025342199951410294, -0.021449511870741844, 0.013809777796268463, -0.035087164491415024, -0.021528953686356544, 0.01083729974925518, -0.02381955087184906, 0.0070703946985304356, 0.012115001678466797, 0.028917118906974792, 0.013412564992904663, -0.03402793034911156, -0.0021681219805032015, 0.03455754742026329, 0.03680841997265816, -0.028281578794121742, -0.011446359567344189, 0.012313608080148697, -0.003162809880450368, 0.00253057898953557, -0.01582232490181923, 0.0013108034618198872, 0.02377982810139656, 0.012684340588748455, 0.04393177852034569, 0.008063427172601223, 0.01530594751238823, -0.03137984126806259, 0.0033994826953858137, -0.007765517570078373, 0.028016770258545876, -0.02632199227809906, -0.00019415862334426492, -0.002653053030371666, -0.03225370869040489, -0.03463698923587799, -0.008559944108128548, -0.01988714002072811, -0.004716906696557999, 0.008209072053432465, -0.0031214335467666388, 0.01617981679737568, 0.03559030219912529, -0.013823018409311771, 0.014538002200424671, 0.00332997040823102, -0.00017905625281855464, 0.01988714002072811, -0.004028403665870428, -0.013253679499030113, 0.009519875980913639, -0.03961539268493652, -0.026705965399742126, 0.03100910782814026, -0.016802117228507996, 0.027725480496883392, 0.014524761587381363, -0.041336651891469955, 0.023965194821357727, -0.028096212074160576, -0.004127706866711378, -0.005382238421589136, 0.0027755270712077618, -0.009215345606207848, 0.01379653811454773, -0.006911509204655886, 0.011711168102920055, -0.021290626376867294, 0.008255413733422756, -0.006990951951593161, 0.01557075697928667, 0.009519875980913639, 0.03458402678370476, -0.021939408034086227, -0.022243937477469444, 0.0033200401812791824, -0.040780551731586456, -0.030903184786438942, 0.0017543581780046225, 0.03498123958706856, -0.032703883945941925, 0.002523958683013916, -0.02473314106464386, 0.007997225038707256, 0.030744299292564392, 0.03169761225581169, 0.00737492460757494, -0.03265092149376869, -0.003793385811150074, 0.01825856603682041, 0.019423725083470345, -0.0020737838931381702, 0.002181362360715866, -0.016325460746884346, -0.0021383308339864016, -0.008162730373442173, 0.010949843563139439, 0.011227892711758614, 0.018496893346309662, -0.013584691099822521, -0.008990257978439331, 0.005441820714622736, 0.003538507502526045, -0.0037304938305169344, -0.01236657053232193, 0.042607732117176056, -0.00013395601126831025, -0.015994450077414513, 0.0043461741879582405, -0.008460640907287598, -0.037788212299346924, -0.01594148948788643, 0.01893382892012596, 0.011227892711758614, 0.02691781334578991, -0.04321679472923279, 0.02878471463918686, 0.007566911168396473, 0.026931053027510643, -0.0009169004042632878, -0.010214999318122864, 0.022177735343575478, -0.001581404940225184]",Online Speculative Decoding.pdf
" of sampled tokens
ùëò1...ùëò‚Ñéfor each head for Top-k tree-style speculative de-
coding. Estimation method ùëÄùëíùë°‚Ñéùëúùëë . Token acceptance rate
ùëùùëüùëíùë£_ùëéùëôùëù‚Ñéùëéùë† of previous steps. All requests in the batch ùëÖ.
1:ùëõ‚Üêùëôùëíùëõ(ùëÖ)
2:ifùëÄùëíùë°‚Ñéùëúùëë == Top-1 candidate speculative decoding then
3:ùõº‚ÜêùëÄùëúùë£ùëñùëõùëîùê¥ùë£ùëî(ùëùùëüùëíùë£_ùëéùëôùëù‚Ñéùëéùë†)
4:ùëîùëíùëõùëíùëüùëéùë°ùëíùëë _ùëôùëíùëõ=ùëõ√ó1‚àíùõºùëò+1
(1‚àíùõº)√óùëõ
5:ùëèùëéùë°ùëê‚Ñé _ùëíùë•ùëíùëêùë¢ùë°ùëñùëúùëõ _ùë°ùëñùëöùëí=ùëá(ùëÖ,[ùëò])
6:else ifùëÄùëíùë°‚Ñéùëúùëë == Top-k tree-style speculative decoding then
7:ùõº1,ùõº2...ùõº‚Ñé‚ÜêùëÄùëúùë£ùëñùëõùëîùê¥ùë£ùëî(ùëùùëüùëíùë£_ùëéùëôùëù‚Ñéùëéùë†)
8:ùëîùëíùëõùëíùëüùëéùë°ùëíùëë _ùëôùëíùëõ=ùëõ√ó√ç
ùëñ=1..‚Ñé(ùëñ+1)√ó(1‚àíùõºùëñ+1)√óŒ†ùëó=1¬∑¬∑¬∑ùëñ[1‚àí
(1‚àíùõºùëó)ùëòùëó]
9:ùëèùëéùë°ùëê‚Ñé _ùëíùë•ùëíùëêùë¢ùë°ùëñùëúùëõ _ùë°ùëñùëöùëí=ùëá(ùëÖ,[ùëò1,ùëò2....ùëò‚Ñé])
10:end if
11:returnùëîùëíùëõùëíùëüùëéùë°ùëíùëë _ùëôùëíùëõ
ùëèùëéùë°ùëê‚Ñé _ùëíùë•ùëíùëêùë¢ùë°ùëñùëúùëõ _ùë°ùëñùëöùëí
Algorithm 2 SmartSpec token acceptance rate based pro-
posal and verification.
Require: Pending requests ùëÖ. Max proposed length ùëâ. Token ac-
ceptance rates of previous decoding steps ùëùùëüùëíùë£_ùëéùëôùëù‚Ñéùëéùë† .
1:ùëèùëíùë†ùë°_ùëîùëúùëúùëëùëùùë¢ùë°,ùëèùëíùë†ùë° _ùëùùëüùëúùëùùëúùë†ùëíùëë _ùëôùëíùëõùë†‚Üê‚àí 1,[]
2:ùëèùëéùë°ùëê‚Ñé _ùëêùëéùëõùëëùëñùëëùëéùë°ùëíùë†‚ÜêGetBatchCandidates()
3:forùëèùëéùë°ùëê‚Ñé inùëèùëéùë°ùëê‚Ñé _ùëêùëéùëõùëëùëñùëëùëéùë°ùëíùë† do","[0.019730111584067345, 0.011530155315995216, 0.0050811972469091415, -0.0351785384118557, -0.021144123747944832, -0.01416656281799078, -0.012250376865267754, 0.020589090883731842, 0.009878270328044891, 0.0081008430570364, 0.05518616363406181, -0.01406084280461073, -0.08521082252264023, 0.003049379214644432, 0.0494508221745491, -0.024210022762417793, 0.0012760809622704983, 0.02144807018339634, -0.01908257231116295, 0.011847317218780518, -0.026403725147247314, -0.005603192839771509, 0.02057587541639805, 0.013902261853218079, 0.054049666970968246, -0.030024657025933266, 0.0057386476546525955, 0.020285144448280334, 0.03171618655323982, -0.033011265099048615, 0.004149534273892641, -0.025505099445581436, -0.02746093086898327, -0.001285166246816516, -0.023417117074131966, 0.013545454479753971, -0.04464053362607956, 0.01149050984531641, -0.016902083531022072, -0.04538057744503021, 0.009957561269402504, -0.019941551610827446, -0.03805942460894585, -0.011953038163483143, 0.022227760404348373, 0.040068116039037704, 0.023615343496203423, -0.035204965621232986, 0.005206740461289883, 0.02662838064134121, -0.05455183982849121, 0.07368727028369904, -0.002352283801883459, 0.03909020125865936, -0.008583192713558674, -0.03010394610464573, -0.016902083531022072, -0.005477649625390768, 0.05402323603630066, 0.01326133031398058, 0.03832372650504112, -0.013664389960467815, 0.015025543048977852, -1.6776953998487443e-05, -0.031240442767739296, 0.010545631870627403, -0.006577804684638977, 0.037107937037944794, 0.010149179957807064, 0.03221835941076279, 0.026483016088604927, 0.019809400662779808, 0.03409489989280701, -0.004096674267202616, -0.013049889355897903, 0.006462173070758581, 0.007684567477554083, 0.019412949681282043, 0.009878270328044891, -0.02820097655057907, 0.032694101333618164, -0.022016318514943123, 0.02965463511645794, -0.05962643027305603, 0.008490687236189842, -0.04300186410546303, -0.030500398948788643, -0.028967449441552162, -0.03126687556505203, -0.06004931405186653, -0.0522259883582592, 0.029496053233742714, -0.045803457498550415, 0.013783326372504234, 0.016069535166025162, 0.021950244903564453, 0.032799821346998215, -0.039222352206707, -0.019214723259210587, 0.016888869926333427, 0.026615167036652565, -0.01818394660949707, 0.020496586337685585, -0.0051472727209329605, 0.051195211708545685, 0.016280975192785263, -0.05687769502401352, 0.06882412731647491, -0.0065811085514724255, -0.018170731142163277, -0.09599432349205017, -0.033804167062044144, -0.05148594081401825, 0.03472922369837761, 0.0315576046705246, -0.02854456752538681, -0.03755725175142288, -0.0158845242112875, 0.0027949889190495014, -0.0038786253426223993, -0.03657933324575424, -0.02496328204870224, 0.0385880284011364, 0.01828966662287712, -0.047468557953834534, 0.017153169959783554, 0.02732877992093563, -0.0850522369146347, 0.0010819844901561737, -0.00582454539835453, 0.008021552115678787, 0.006386186461895704, 0.013598314486443996, -0.005864190869033337, -0.008252816274762154, -0.025320088490843773, -0.045697737485170364, 0.01707388088107109, -0.01724567636847496, 0.03364558890461922, 0.006984168663620949, -0.04429693892598152, -0.007155964616686106, 0.026707671582698822, -0.04064957797527313, 0.0016890520928427577, -0.019901907071471214, 0.0054446118883788586, -0.03216549754142761, 0.01814430207014084, -0.01616203971207142, -0.0009035809198394418, -0.03694935888051987, -0.0025505099911242723, -0.014563015662133694, -0.058252062648534775, -0.0055767628364264965, 0.024989711120724678, -0.014906607568264008, 0.009435565210878849, -0.07093853503465652, 0.016360266134142876, 0.03338128700852394, -0.007644922472536564, -0.001666751690208912, 0.0326148122549057, -0.004037206061184406, 0.036658626049757004, -0.05476328358054161, 0.022465631365776062, 0.027619512751698494, -0.036526475101709366, 0.011708558537065983, -0.016677428036928177, -0.011312106624245644, -0.015184124000370502, -0.05941499024629593, -0.04400620982050896, 0.029575344175100327, -0.07416301220655441, -0.036209311336278915, 0.020073702558875084, 0.007810110691934824, 0.0015808537136763334, -0.017298536375164986, -0.03938093036413193, -0.02200310491025448, -0.00011790326971095055, 0.018818270415067673, 0.01756283827126026, 0.043583326041698456, 0.05079875886440277, 0.05066660791635513, -0.03552212938666344, -0.025372948497533798, -0.06253375113010406, 0.05423467978835106, 0.029126031324267387, 0.02572975680232048, 0.00039252909482456744, 0.0026033702306449413, 0.0016328879864886403, 0.013360443525016308, 0.007783680688589811, 0.06734403222799301, -0.0011480598477646708, 0.00312041025608778, -0.029945366084575653, 0.02054944634437561, -0.04596203938126564, 0.04012097418308258, -0.015012328512966633, 0.03679077699780464, 0.004830110818147659, -0.02976035512983799, 0.025333303958177567, -0.007228647358715534, 0.0034788690973073244, 0.00659762741997838, 0.0695113092660904, -0.01262039877474308, -0.00621439004316926, 0.01784035563468933, 0.04662279412150383, -0.006078935693949461, 0.07548452168703079, 0.02541259489953518, 0.02530687302350998, 0.03161046653985977, 0.005249689798802137, -0.012270200066268444, 0.012210731394588947, 0.0036638802848756313, -0.02117055468261242, -0.0034920843318104744, 0.014047627337276936, -0.004737605340778828, -0.028941020369529724, -0.02944319322705269, -0.04913365840911865, -0.02822740562260151, 0.01568629778921604, 0.01946580968797207, -0.016849223524332047, -0.04387405887246132, -0.0067727272398769855, -0.04112531989812851, -0.02798953466117382, 0.0047739469446241856, 0.042156096547842026, 0.0014363137306645513, -0.055503327399492264, -0.01978297159075737, 0.00440722843632102, -0.03938093036413193, -0.004559201654046774, 0.016214899718761444, 0.007559024263173342, -0.03948665037751198, -0.0034854768309742212, 0.011695344001054764, -0.026403725147247314, -0.028253836557269096, 0.03755725175142288, -0.029707495123147964, -0.032033346593379974, 0.0008994512027129531, -0.03118758276104927, 0.020840177312493324, -0.03372487798333168, -0.047468557953834534, -0.009045721031725407, 0.0023836696054786444, 0.028967449441552162, -0.01399476733058691, -0.023099955171346664, 0.023232106119394302, 0.009666829369962215, -0.042367540299892426, -0.0015403825091198087, -0.007195609621703625, -0.018593614920973778, 0.05603192746639252, -0.0014007982099428773, 0.029601773247122765, -0.0038422837387770414, 0.03343414515256882, -0.006267250515520573, 0.005226563196629286, -0.006072327960282564, 0.02131592109799385, -0.017681773751974106, 0.013016851618885994, -0.05082518979907036, 0.007869578897953033, -0.026575520634651184, -0.004423747304826975, 0.007413658779114485, 0.009098581038415432, -0.037107937037944794, 0.0631152093410492, 0.0048499335534870625, 0.021223414689302444, -0.0015998503658920527, -0.021500932052731514, 0.00556354783475399, 0.01361152995377779, -0.014946253038942814, -0.0010200388496741652, -0.016426341608166695, 0.0105522396042943, -0.00225151889026165, -0.04308115318417549, -0.026258358731865883, -0.011166740208864212, -0.08045339584350586, 0.06126509979367256, -0.04376833885908127, -0.020139778032898903, -0.03314341604709625, -0.027143768966197968, -0.053177472203969955, 0.017285320907831192, 0.026416940614581108, 0.03491423651576042, -0.020919468253850937, -0.0326148122549057, -0.0007668875041417778, 0.0394337922334671, -0.02089303731918335, 0.029284611344337463, -0.011695344001054764, 0.03007751703262329, 0.012204124592244625, -0.033883459866046906, -0.027645941823720932, -0.010664567351341248, 0.03483494371175766, 0.01109405793249607, 0.07601312547922134, -0.04342474415898323, 0.007433481048792601, 0.014695166610181332, -0.02002084255218506, -0.025386163964867592, 0.028385987505316734, 0.021355565637350082, -0.006653791759163141, 0.07522021979093552, 0.014496940188109875, -0.031689755618572235, -0.004387405700981617, 0.04411192983388901, -0.008603015914559364, 0.013624745421111584, -0.020351219922304153, 0.013016851618885994, -0.02621871419250965, -0.052754588425159454, 0.018831485882401466, -0.05677197501063347, 0.042156096547842026, 0.036975786089897156, -0.0040504215285182, 0.012686474248766899, -0.02172558754682541, -0.06665685027837753, -0.059256408363580704, -0.010994944721460342, -0.01984904706478119, -0.005385144148021936, 0.08003050833940506, -0.03383059799671173, -0.00239523290656507, -0.013624745421111584, -0.006462173070758581, -0.016994589939713478, 0.0447726845741272, 0.038720179349184036, 0.02854456752538681, 0.023945720866322517, -0.009276984259486198, -0.031240442767739296, -0.020390864461660385, 0.01856718398630619, 0.009865055792033672, 0.023998580873012543, -0.009428957477211952, -0.021963458508253098, -0.02496328204870224, -0.017258891835808754, -0.04323973506689072, 0.02370784990489483, 0.016571708023548126, 0.02413073182106018, 0.03761010989546776, -0.0261129941791296, 0.06464815884828568, 0.01439121924340725, 0.0422089584171772, -0.00029940411332063377, -0.013677605427801609, -0.018990065902471542, -0.023800354450941086, -0.04442908987402916, 0.018131086602807045, 0.05050802603363991, 0.026324434205889702, 0.021844523027539253, -0.01074385829269886, 0.027249490842223167, -0.008404789492487907, 0.038508735597133636, -0.07294722646474838, 0.040728870779275894, 0.03835015371441841, 0.0030394678469747305, 0.031346164643764496, -0.011232815682888031, 0.029258182272315025, -0.007017206400632858, -0.002535643056035042, -0.03375130891799927, -0.02607334777712822, -0.08489365875720978, -0.008556762710213661, 0.06084221601486206, -0.00012750485620927066, 0.037425100803375244, -0.03684363514184952, -0.005722128786146641, 0.03673791512846947, 0.019518669694662094, -0.053415343165397644, -0.027038048952817917, 0.008351929485797882, 0.05103662982583046, 0.02479148656129837, 0.005461130756884813, -0.04218252748250961, -0.04979441314935684, -0.004810288082808256, -0.028597427532076836, -0.01581844873726368, -0.01229002233594656, 0.020417295396327972, -0.007862971164286137, -0.0364471860229969, 0.020985543727874756, -0.02193702943623066, 0.024989711120724678, -0.026126207783818245, -0.005619711708277464, 0.0025736363604664803, -0.003341762814670801, -0.05233170837163925, 0.09900736063718796, 0.014179778285324574, 0.01592416875064373, -0.015501285903155804, 0.03681720793247223, -0.0022961196955293417, 0.014681951142847538, -0.0214216411113739, -0.007248470094054937, -0.0199283380061388, 0.001029950100928545, 0.01856718398630619, 0.016109179705381393, 0.017113525420427322, 0.032456230372190475, -0.02683982253074646, 0.010479556396603584, -0.0008746729581616819, 0.026919113472104073, 0.0095941461622715, 0.07855042070150375, -0.013433126732707024, 0.018210377544164658, -0.010539024136960506, -0.003389667486771941, -0.011398004367947578, 0.022346695885062218, -0.0017311752308160067, 0.014787672087550163, 0.07791610062122345, 0.035310689359903336, 0.0347556546330452, -0.01225698459893465, -0.028597427532076836, 0.012884700670838356, -0.03076470084488392, 0.018871130421757698, -0.015897737815976143, -0.01297059841454029, 0.0007235254743136466, 0.006746297236531973, 0.01531627494841814, 0.0058741020038723946, -0.006220997776836157, 0.04384762793779373, -0.015051973052322865, 0.003967827185988426, 0.049212947487831116, -0.008860709145665169, 0.00808101985603571, -0.042605411261320114, -0.004529467783868313, 0.00032191103673540056, 0.03702864795923233, -0.01863325946033001, -0.006131796166300774, -0.013571884483098984, -0.00021866823954042047, -0.04049099609255791, 0.01784035563468933, -0.04191822558641434, 0.0020912860054522753, -0.02357569895684719, -0.038297295570373535, -0.028703149408102036, -0.009125011041760445, -0.00977255031466484, -0.01154337078332901, 0.009111796505749226, -0.021567007526755333, -0.00411980040371418, -0.0982673168182373, -0.016280975192785263, 0.02413073182106018, 0.015977028757333755, -0.019584745168685913, -0.013955121859908104, 0.05751201882958412, 0.002084678504616022, -0.001792294904589653, -0.0029502660036087036, 0.021183770149946213, -0.022967804223299026, -0.013955121859908104, 0.0030642461497336626, -0.0027057870756834745, -0.012005898170173168, -0.018382173031568527, -0.005358714144676924, -0.0026810087729245424, 0.01939973421394825, -0.013129179365932941, -0.02746093086898327, -0.012441995553672314, 0.01554093137383461, -0.02221454493701458, 0.045116275548934937, -0.01509161852300167, -0.027408070862293243, 0.00014299126632977277, -0.00014206208288669586, 0.007968692108988762, -0.003084068652242422, -0.013142394833266735, 0.0290996003895998, -0.01112709566950798, 0.011569800786674023, 0.0008408093126490712, 0.00884749460965395, -0.003315332578495145, 0.017919644713401794, -0.007783680688589811, 0.041601065546274185, 0.015263414941728115, -0.028835300356149673, -0.02830669656395912, 0.006911485455930233, -0.03845587745308876, 0.0013652826892212033, -0.03232407942414284, -0.0015618569450452924, -0.008906962350010872, 0.03129330277442932, -0.008616230450570583, -0.025478670373558998, 0.006392793729901314, 0.007453303784132004, 0.013637959957122803, -0.01773463375866413, 0.015303059481084347, 0.0027008315082639456, 0.025214368477463722, -0.018065011128783226, -0.01908257231116295, 0.02820097655057907, 0.02040407992899418, 0.00643904646858573, 0.0009655266185291111, 0.0019789577927440405, 0.013796540908515453, 0.01499911304563284, -0.008530332706868649, -0.009865055792033672, 0.0038654101081192493, 0.018197162076830864, 0.0046781376004219055, 0.0049457428976893425, 0.006283769384026527, -0.02801596373319626, 0.014298713766038418, -0.014536585658788681, 0.012204124592244625, 0.044032637029886246, 0.023840000852942467, 0.016175255179405212, 0.01416656281799078, -0.025716541334986687, -0.012210731394588947, 0.014285499230027199, 0.004526163917034864, -0.04630563035607338, -0.01602988876402378, 0.013479379005730152, 0.0001702473673503846, 0.03438563272356987, -0.03031538799405098, -0.008160310797393322, 0.007995122112333775, 0.013743680901825428, 0.0017509977333247662, 0.005438004620373249, -0.02711733989417553, 0.039935965090990067, 0.018923990428447723, -0.013234900310635567, 0.024183591827750206, -0.0019128824351355433, 0.016109179705381393, -0.027038048952817917, 0.04384762793779373, -0.0005612278473563492, -0.01439121924340725, 0.024157162755727768, -0.023496408015489578, 0.026826607063412666, 0.018923990428447723, 0.002930443501099944, -0.03316984325647354, -0.010453126393258572, -0.011371574364602566, -0.015448425896465778, -0.0021292793098837137, -0.02555795945227146, -0.018382173031568527, -0.027910243719816208, -0.009904700331389904, 0.03821800276637077, -0.021923813968896866, 0.011411219835281372, -0.022716717794537544, -0.029020311310887337, -0.026535876095294952, 0.030156807973980904, 0.007770465686917305, -0.0195054542273283, -0.018765410408377647, -0.03118758276104927, 0.001423098728992045, 0.00727490009739995, 0.021580221131443977, 0.012395743280649185, 0.01568629778921604, 0.010631529614329338, 0.0047739469446241856, -0.05145951360464096, 0.03414776176214218, 0.009270376525819302, -0.03383059799671173, 0.0006859451532363892, -0.009997205808758736, -0.021461285650730133, -0.05040230602025986, -0.024210022762417793, 0.012250376865267754, -0.018725765869021416, 0.019875476136803627, -0.045592017471790314, -0.02822740562260151, 0.011437649838626385, -0.013201862573623657, 0.03692292794585228, -0.031478315591812134, 0.025716541334986687, 0.0324033722281456, -0.016426341608166695, -0.0099113080650568, 0.020139778032898903, -0.05024372413754463, 0.003792727366089821, 0.009680044837296009, -0.02586190775036812, 0.015593791380524635, -0.016598137095570564, -0.04638492316007614, -0.03031538799405098, 0.03063254989683628, 0.011021374724805355, -0.008041374385356903, -0.01717960089445114, -0.006468780338764191, 0.025954412296414375, 0.03570713847875595, 0.04614705219864845, -0.01846146397292614, 0.009323237463831902, 0.01432514376938343, -0.005850975401699543, -0.014893392100930214, -0.024540400132536888, 0.008226386271417141, -0.01193982269614935, -0.0157788023352623, 0.008173525333404541, -0.03679077699780464, -0.030368248000741005, 0.010036851279437542, -0.023245321586728096, 0.010829756036400795, -0.01284505520015955, 0.0005170399090275168, 0.006353148724883795, 0.012904522940516472, -0.029945366084575653, 0.023840000852942467, -0.018990065902471542, 0.033328425139188766, 0.013941907323896885, -0.026575520634651184, -0.02360212802886963, -0.0001462950458517298, -0.026654811576008797, 0.0004542683018371463, -0.007228647358715534, -0.00839818175882101, 0.04086102172732353, -0.018540753051638603, 0.003944700583815575, 0.005725432187318802, 0.014523370191454887, -0.0036473614163696766, 0.011246031150221825, 0.02801596373319626, -0.0658639445900917, -0.01013596449047327, -0.020245498046278954, 0.009680044837296009, -0.005388448014855385, -0.022293835878372192, 0.027963103726506233, -3.6780245864065364e-05, 0.0022003103513270617, -0.009759334847331047, -0.030685409903526306, 0.011966252699494362, -0.017166385427117348, 0.02801596373319626, -0.017232460901141167, 0.017549622803926468, 0.003321940079331398, -0.0026397118344902992, -0.009058935567736626, -0.015607006847858429, 0.012983813881874084, 0.021302705630660057, 0.02315281517803669, -0.02649623155593872, 0.0018930599326267838, 0.030473969876766205, 0.058463502675294876, -0.014047627337276936, -0.018937205895781517, -0.0014800886856392026, -0.01400798186659813, 0.01477445662021637, -0.017192816361784935, 0.00334671838209033, -0.026588736101984978, 0.02033800445497036, -0.04654350504279137, 0.012574146501719952, -0.007063459139317274, 0.03129330277442932, 0.024593260139226913, -0.02050979994237423, -0.005322372540831566, -0.007387228310108185, -0.002137538744136691, 0.020470155403017998, -0.0055767628364264965, -0.0007701912545599043, -0.0024926939513534307, -0.10646066814661026, 0.0068784477189183235, 0.014655521139502525, 0.018659690394997597, -0.007644922472536564, -0.013598314486443996, 0.00808101985603571, -0.0015172561397776008, -0.011391396634280682, 0.027249490842223167, 0.004830110818147659, 0.0005765077657997608, 0.018408603966236115, -0.03946022316813469, 0.02189738303422928, -0.025333303958177567, 0.0036341464146971703, 0.009171264246106148, 0.024011796340346336, -0.013505809009075165, -0.0196111761033535, -0.022082393988966942, -0.025187937542796135, 0.016122395172715187, 0.0009539634338580072, -0.00072022172389552, -0.011120487935841084, -0.00746651878580451, 0.02127627469599247, 0.015567361377179623, 0.01880505494773388, -0.011701950803399086, -0.00785636343061924, 0.027196628972887993, 0.002514168620109558, -0.008887140080332756, -0.024976497516036034, -0.025227583944797516, 0.025055786594748497, 0.008470864966511726, 0.01514447946101427, -0.034649934619665146, 0.003150144126266241, -0.001202572020702064, -0.0002638885925989598, -0.032244790345430374, -0.016122395172715187, -0.018382173031568527, -0.011920000426471233, 0.004136319272220135, -0.033460576087236404, 0.006481995806097984, 0.017391042783856392, -0.02144807018339634, -0.006026075221598148, 0.03924877941608429, 0.0076317074708640575, 0.003938093315809965, 0.005289334803819656, 0.016954945400357246, 0.0018616740126162767, 0.04025312513113022, 0.03010394610464573, 0.006852017715573311, 0.013822970911860466, -0.02594119682908058, -0.024698980152606964, 0.03420061990618706, 0.006201175041496754, -0.0207873173058033, 0.011404612101614475, -0.008946607820689678, 0.039513081312179565, 0.010492771863937378, -0.020390864461660385, -0.0028247227892279625, -0.013889046385884285, 0.006746297236531973, -0.027408070862293243, 0.004585632123053074, 0.05920354649424553, -0.049767982214689255, -0.013472771272063255, -0.00569239491596818, -0.004265166353434324, -0.01602988876402378, 0.03766297176480293, 0.0007949694991111755, -0.010254899971187115, 0.024632904678583145, -0.0060062529519200325, -0.03689649701118469, -0.013433126732707024, -0.006280465517193079, -0.03893161937594414, -0.04049099609255791, -0.00903911329805851, 0.031689755618572235, 0.028385987505316734, 0.0035978048108518124, 0.04662279412150383, 0.0460413321852684, 0.00395461218431592, -0.025716541334986687, -0.028385987505316734, 0.014404434710741043, 0.03948665037751198, -0.028148114681243896, 0.021196983754634857, -0.003561463439837098, 0.004294900223612785, -0.018937205895781517, -0.021011972799897194, 0.002031818265095353, 0.0009151441045105457, 0.022016318514943123, 0.03338128700852394, -0.0009787416784092784, 0.033672016113996506, -0.02524079754948616, 0.0073079378344118595, 0.03591858223080635, -0.010228469967842102, 0.014364789240062237, -0.0518031045794487, 0.04984727129340172, 0.000803641916718334, 0.06359095126390457, 0.010763680562376976, -0.0003464828187134117, -0.006092150695621967, 0.0011265854118391871, -0.006128492299467325, -0.013598314486443996, 0.04495769366621971, -0.002464612014591694, 0.004291596356779337, 0.023073526099324226, -0.03779512271285057, 0.007935654371976852, -0.017509978264570236, 0.021527361124753952, 0.019862262532114983, 0.01679636351764202, -0.014734811149537563, -0.009495032951235771, -0.017087094485759735, -0.008147095330059528, -0.022267404943704605, 0.008266030810773373, -0.005986430216580629, 0.007955476641654968, -0.01643955707550049, 0.009904700331389904, 0.0012033979874104261, 0.004770643077790737, -0.04598847031593323, -0.0006710781599394977, 0.03909020125865936, 0.025703325867652893, 0.0664982721209526, 0.04009454697370529, 0.038191575556993484, -0.010400266386568546, 7.330238440772519e-05, -0.01888434588909149, -0.012362705543637276, -0.0033368070144206285, 0.015210554003715515, 0.004750820342451334, -0.010228469967842102, -0.0006297810468822718, 0.01493303757160902, 0.026298005133867264, 0.04234110936522484, 0.005325676407665014, -0.014748026616871357, 0.01842181757092476, 0.028967449441552162, 0.03491423651576042, 0.027196628972887993, -0.0029089690651744604, 0.009534678421914577, 0.0010340798180550337, 0.010988336987793446, -0.027645941823720932, 0.005517295096069574, 0.03227122128009796, -0.01338687352836132, 0.02865028753876686, 0.02023228444159031, 0.0449841246008873, -0.0009027550113387406, 0.02054944634437561, -0.021461285650730133, -0.005603192839771509, -0.02214846946299076, 0.01776106469333172, -0.0019459201721474528, 0.014496940188109875, -0.012891308404505253, 0.036103591322898865, -0.03359272703528404, 0.02364177443087101, -0.003383059985935688, 0.014615875668823719, 0.008702128194272518, 0.017166385427117348, -0.004364279564470053, 0.026152638718485832, -0.061899423599243164, 0.011986075900495052, -0.029231751337647438, 0.037980131804943085, -0.026258358731865883, -0.026998404413461685, 0.01963760517537594, 0.0211044792085886, -0.04012097418308258, 0.0011265854118391871, -0.02732877992093563, -0.006121884565800428, -0.03856159746646881, -0.0014916518703103065, 0.011867139488458633, 0.006951130926609039, 0.03018323704600334, 0.0034392238594591618, -0.025359734892845154, -0.004076851531863213, 0.01748354732990265, -4.333616379881278e-05, -0.009587538428604603, -0.025425808504223824, -0.024038225412368774, 0.01184070948511362, -0.02165951207280159, -0.002953569870442152, -0.006647184025496244, 0.027698803693056107, 0.016809578984975815, -0.003934789448976517, -0.0026760532055050135, 0.023205677047371864, 0.027249490842223167, -0.023826785385608673, 0.011364966630935669, 0.014576230198144913, -0.020668381825089455, -0.024566829204559326, 0.010208647698163986, 0.015078403986990452, 0.042816851288080215, 0.01277897972613573, 0.022716717794537544, -0.013340621255338192, 0.017324967309832573, 0.022967804223299026, 0.008721951395273209, 0.04297543317079544, -0.02200310491025448, -0.018976852297782898, 0.00331202894449234, -0.021633083000779152, -0.004575720522552729, -0.020562659949064255, -0.038958050310611725, -0.0007272422662936151, -0.004681441467255354, -0.016981374472379684, 8.76531339599751e-05, 0.023232106119394302, -0.006719866767525673, 0.05106306076049805, 0.006951130926609039, -0.006399401463568211, 0.024143947288393974, -0.039962396025657654, 0.02089303731918335, -0.012745941989123821, -0.0005661834729835391, -0.025980843231081963, -0.0028891463298350573, -0.012726119719445705, 0.010790110565721989, -0.02662838064134121, 0.00787618663161993, -0.00888053234666586, 0.004929224029183388, -0.004436962306499481, 0.039301641285419464, -0.005315764807164669, 0.008966430090367794, -0.003561463439837098, -0.032244790345430374, -0.012296630069613457, 0.013347228057682514, 0.010611707344651222, 0.007684567477554083, -0.025650465860962868, 0.003802638500928879, 0.01943937875330448, 0.018686119467020035, -0.04080815985798836, 0.0230206660926342, 0.029178891330957413, 0.020906252786517143, -0.028280265629291534, -0.016809578984975815, -0.034332770854234695, -0.006349844858050346, 0.026020487770438194, 0.042499691247940063, 0.044481951743364334, 0.0387994684278965, 0.010340798646211624, 0.007948868907988071, 0.00463188486173749, 0.027698803693056107, -0.005722128786146641, -0.024328958243131638, 0.010354013182222843, -0.03330199420452118, 0.0051175388507544994, -0.019531885161995888, 0.0261129941791296, 0.005513991229236126, -0.019069356843829155, 0.00205990020185709, 0.008371751755475998, -0.009858448058366776, 0.02033800445497036, 0.02677374705672264, 0.02809525467455387, -0.01850110851228237, 0.012679867446422577, -0.017932860180735588, 0.01093547698110342, -0.02065516635775566, -0.06570536643266678, 0.014272283762693405, 0.005606496706604958, -0.015844877809286118, -0.01016900222748518, -0.00907215103507042, 0.014285499230027199, 0.018104655668139458, -0.018646474927663803, 0.002315942430868745, -0.018316097557544708, 0.08938678354024887, -0.001524689607322216, -0.02976035512983799, 0.0028313302900642157, -0.013889046385884285, -0.012745941989123821, -0.019003281369805336, -0.016214899718761444, -0.03483494371175766, -0.009825410321354866, -0.009812194854021072, 0.021130908280611038, 0.026377294212579727, 0.013254722580313683, 0.008232993073761463, -0.010869401507079601, -0.0005170399090275168, 0.007070066407322884, 0.03020966798067093, 0.04244682937860489, 0.013822970911860466, 0.0324033722281456, 0.002428270410746336, 0.002007039962336421, -0.027619512751698494, -0.007625099737197161, 0.021289490163326263, 0.021183770149946213, 0.03293197229504585, -0.004139623139053583, -8.579475979786366e-05, -0.02886172942817211, -0.049080800265073776, -0.008761596865952015, -0.0018236807081848383, 0.0041429270058870316, -0.028280265629291534, 0.03869374841451645, -0.022782793268561363, -0.026892682537436485, -0.023906076326966286, 0.012171086855232716, 0.06004931405186653, 0.023271752521395683, -0.003918270580470562, 0.024698980152606964, -0.0022465630900114775, 0.022994235157966614, -0.005507383495569229, -0.01493303757160902, 0.014681951142847538, 0.0072682928293943405, 0.004479911178350449, -0.01568629778921604, 0.009746119379997253, -0.03327556699514389, 0.004625277128070593, 0.008801241405308247, 0.037319380789995193, -0.011358358897268772, -0.03956594318151474, -0.0020219068974256516, -0.021223414689302444, 0.011464079841971397, 0.005054767243564129, -0.044931262731552124, 0.00936948973685503, 0.0012413914082571864, -0.002363847102969885, 0.04958297312259674, -0.012177693657577038, 0.024077871814370155, -0.014047627337276936, -0.005077893380075693, 0.029284611344337463, -0.00489288242533803, -0.005071286112070084, -0.011583015322685242, 0.01939973421394825, 0.0227035041898489, -0.008325498551130295, -0.004209002014249563, 0.0006211086292751133, 0.003548248438164592, -0.02225419133901596, 0.026377294212579727, 0.049662262201309204, -0.025055786594748497, -0.00746651878580451, 0.02242598682641983, -0.03525782749056816, -0.0042486474849283695, 0.0016584922559559345, -0.0033962749876081944, 0.030791131779551506, -0.04805002361536026, 0.02468576468527317, -0.03396274894475937, -0.021395210176706314, -0.002763603115454316, 0.01971689611673355, -0.03073826991021633, 0.0067330822348594666, 0.016703858971595764, -0.042605411261320114, 0.01361152995377779, -0.04109889268875122, -0.014615875668823719, 0.004327937960624695, -0.01190678495913744, 0.005058071110397577, -0.012402350082993507, 0.013525632210075855, 0.0005521424463950098, -0.040068116039037704, 0.05193525552749634, 0.0019211418693885207, 0.0021821397822350264, -0.004304811358451843, -0.01724567636847496, 0.014074057340621948, 0.03824443370103836, 0.012785587459802628, -0.02148771658539772, -0.017853569239377975, 0.0014734811848029494, -0.009461995214223862, 0.014589445665478706, -0.00320300436578691, -0.026231929659843445, -0.014351574704051018, 0.004367582965642214, -0.00344252772629261, 0.004552594386041164, 0.00820656307041645, 0.04112531989812851, -0.011345144361257553, 0.0009680044604465365, -0.029918935149908066, -0.010862793773412704, -0.016941729933023453, -0.007525986526161432, -0.02151414565742016, -0.029469622299075127, -0.0026050221640616655, 0.015488071367144585, -0.0039810421876609325, 0.012408957816660404, -0.000810249475762248, 0.03171618655323982, -0.004331241827458143, 0.003013037610799074, 0.004962261766195297, 0.012765765190124512, -0.0026248448994010687, -0.01880505494773388, 0.008378359489142895, 0.006118581164628267, -0.015276629477739334, 0.017549622803926468, 0.032033346593379974, -0.011602838523685932, -0.02283565327525139, 0.02820097655057907, 0.015844877809286118, 0.03250909224152565, -0.014840532094240189, 0.029707495123147964, 0.045565586537122726, 0.0198226161301136, -0.0017245676135644317, -0.004298204090446234, 0.049873702228069305, -0.0022432594560086727, -0.02159343659877777, -0.004324634093791246, -0.013373658992350101, 0.023496408015489578, 0.014642305672168732, 0.012270200066268444, -0.001518081990070641, -0.00820656307041645, 0.04318687319755554, 0.03171618655323982, 0.03935449942946434, 0.027170199900865555, 0.008147095330059528, -0.005421485751867294, -0.025809045881032944, 0.03919592127203941, 0.0025505099911242723, 0.0315576046705246, -0.019809400662779808, 0.005794811528176069, 0.028703149408102036, 0.013532239943742752, -0.004166053142398596, -0.024038225412368774, -0.03248266130685806, 0.018818270415067673, -0.02854456752538681, -0.0014255765127018094, 0.03427991271018982, -0.025980843231081963, 0.027936674654483795, -0.00485984468832612, -0.012917738407850266, -0.022412771359086037, -0.00884749460965395, 0.005864190869033337, 0.02010013349354267, -0.023377472534775734, 0.009065543301403522, 0.012679867446422577, 0.031214013695716858, -0.04691352695226669, -0.0008639356819912791, -0.016280975192785263, -0.005708913318812847, -0.000422882498241961, -4.891127537121065e-05, 0.011596230790019035, 0.026575520634651184, 0.006356452126055956, -0.017668558284640312, 0.015104833990335464, -0.006805764976888895, 0.020073702558875084, -0.010486164130270481, -0.01713995635509491, 0.03285268321633339, -0.023337827995419502, 0.008246208541095257, 0.010862793773412704, 0.05037587508559227, -0.02732877992093563, -0.010228469967842102, -0.005850975401699543, 0.030262527987360954, -0.007089889142662287, -0.023337827995419502, -0.010367228649556637, 0.005157183855772018, 0.017747849225997925, 0.03084399178624153, 0.011530155315995216, -0.007248470094054937, 0.014734811149537563, -0.030130377039313316, -0.0010745510226115584, 0.0012306540738791227, 0.010155786760151386, -0.0195054542273283, -0.05249029025435448, 0.007644922472536564, -0.034570641815662384, -0.023113170638680458, -0.0023588913027197123, 0.02801596373319626, 0.010505986399948597, 0.009567716158926487, -0.0015189079567790031, -0.00197730609215796, -0.014074057340621948, -0.016571708023548126, 0.0034854768309742212, 0.00136858643963933, 0.017285320907831192, -0.032350510358810425, -0.022399555891752243, -0.03375130891799927, 0.022095609456300735, -0.03314341604709625, 0.010420088656246662, 0.0114574721083045, 0.04294900223612785, 0.006389489863067865, -0.02999822609126568, 0.0038257648702710867, -0.008517117239534855, 0.058252062648534775, 0.00018160407489631325, -0.007162571884691715, 0.022624213248491287, -0.010928869247436523, -0.02138199657201767, -0.00769117521122098, -0.021474501118063927, 0.03451778367161751, -0.000440640258602798, 0.05677197501063347, 0.008748381398618221, 0.006633969023823738, -0.037425100803375244, 0.002013647463172674, -0.01662456803023815, 0.01752319373190403, -0.04815574362874031, -0.023245321586728096, 0.029707495123147964, -0.019703680649399757, -0.025980843231081963, 0.016056319698691368, -0.031769048422575, 0.008107449859380722, 0.00784314889460802, -0.017813924700021744, 0.030711840838193893, 0.04783857986330986, -0.0008721951162442565, 0.012858270667493343, 0.005791507661342621, -0.0016584922559559345, -0.004909401293843985, 0.008199955336749554, 0.036870066076517105, 0.004512948915362358, -0.033777739852666855, -0.01784035563468933, 0.03750438988208771, -0.007592062000185251, 0.0324033722281456, 0.003660576418042183, -0.030368248000741005, 0.02235991135239601, -0.05169738456606865, 0.0010349057847633958, 0.003131973324343562, 0.030923280864953995, -0.0008251164108514786, 0.008669091388583183, -0.006911485455930233, 0.025320088490843773, -0.020258713513612747, 0.02364177443087101, 0.0023968846071511507, 0.0022432594560086727, -0.0013537195045500994, 0.039169490337371826, -0.022994235157966614, -0.03705507889389992, 0.0162016861140728, -0.02343033254146576, -0.029284611344337463, -0.0007169179734773934, 0.04162749648094177, -0.026707671582698822, -0.015910953283309937, -0.005196829326450825, 0.011279068887233734, -0.001256258343346417, 0.03776869177818298, 0.02649623155593872, -0.022584566846489906, -0.024328958243131638, 0.006825587712228298, 0.026786962524056435, 0.008252816274762154, -0.02200310491025448, -0.019452594220638275, 0.013730465434491634, -0.005193525459617376, 0.020496586337685585, 0.0007032899302430451, -0.006779334973543882, 0.008166917599737644, -0.02812168560922146, -0.01869933493435383, -0.03248266130685806, 0.018329313024878502, -0.014259069226682186, 0.030341818928718567, 0.0014007982099428773, -0.012111619114875793, 0.04395334795117378, 0.007393836043775082, -0.03800656273961067, -0.01967724971473217, -0.0028941018972545862, -0.0019905210938304663, 0.05040230602025986, -0.016743503510951996, 0.01297059841454029, 0.002560421358793974, 0.019690465182065964, -0.003614323679357767, -0.022716717794537544, 0.01071082055568695, -0.017404256388545036]",Online Speculative Decoding.pdf
"
4:ùëêùë¢ùëü_ùëîùëúùëúùëëùëùùë¢ùë°,ùëêùë¢ùëü _ùëùùëüùëúùëùùëúùë†ùëíùëë _ùëôùëíùëõùë† ‚Üê
ùê¥ùëüùëîùëöùëéùë•ùëò1,ùëò2...ùëòùëõ(Goodput(ùëò1,ùëò2...ùëòùëõ,ùëùùëüùëíùë£ _ùëéùëôùëù‚Ñéùëéùë†))
5: ifnot HasSlot( ùëèùëéùë°ùëê‚Ñé )then
6: continue.
7: end if
8: ifùëêùë¢ùëü_ùëîùëúùëúùëëùëùùë¢ùë° >ùëèùëíùë†ùë°_ùëîùëúùëúùëëùëùùë¢ùë° then
9:ùëèùëíùë†ùë°_ùëîùëúùëúùëëùëùùë¢ùë°,ùëèùëíùë†ùë° _ùëùùëüùëúùëùùëúùë†ùëíùëë _ùëôùëíùëõùë† ‚Üê
ùëêùë¢ùëü_ùëîùëúùëúùëëùëùùë¢ùë°,ùëêùë¢ùëü _ùëùùëüùëúùëùùëúùë†ùëíùëë _ùëôùëíùëõùë†
10: end if
11:end for
12:Propose(ùëÖ,ùëèùëíùë†ùë° _ùëùùëüùëúùëùùëúùë†ùëíùëë _ùëôùëíùëõùë†)
13:ùõºùëêùë¢ùëü= Score(ùëÖ,ùëèùëíùë†ùë° _ùëùùëüùëúùëùùëúùë†ùëíùëë _ùëôùëíùëõùë†)
14:ùëùùëüùëíùë£_ùëéùëôùëù‚Ñéùëéùë† .append(ùõºùëêùë¢ùëü)
requests, speculative decoding is also disabled for all subse-
quent decoding steps for these requests. The threshold for
disabling the prefill run is adjustable, allowing users to tailor
the level of conservative speculative decoding to their needs.
Empirically, setting this threshold to 0.7 has yielded good
performance, balancing resource efficiency with decoding
effectiveness.
Discussion and Complexity Analysis. For each batch,
the overhead of SmartSpec consists of three components:
accepted length estimation, batch execution time modeling,
and goodput-guided proposal length optimization. Comput-
ing accepted length and batch execution time are ùëÇ(1), as
8
they use moving average based token acceptance rate and
offline profiled model coefficients, as detailed in Secs. 4.4 and
4.3.
The complexity of goodput-guided optimization varies
depending on whether it utilizes request-level or global to-
ken acceptance rates. In this work, we empirically find that
both granularities yield similar performance gains. How-
ever, given that the request-level token acceptance rate in-
troduces significant engineering complexity, we opt to use
the global token acceptance rate to estimate the accepted
length. Since the maximum proposed length ùëâis typically
less than 10, we can efficiently enumerate all possible pro-
posed lengths to find the one that maximizes goodput. This
is a very small overhead in comparison with LLM forward
pass: letùë†be the sequence length, ‚Ñìbe number of decoder
layers in the model, ‚Ñébe the hidden dimension size, ùëõbe the
batch size, each forward pass‚Äôs complexity is at the order of
ùëÇ(‚Ñìùëõ(ùë†‚Ñé2+ùë†2‚Ñé))‚â´ùëÇ(ùëõùëâ).
6 System Design and Architecture
Lookahead SchedulerDraft WorkerSD Worker","[0.03279361501336098, 0.012301328592002392, 0.016530841588974, -0.021147562190890312, -0.018020106479525566, -0.024275019764900208, 0.021460307762026787, 0.021921981126070023, -0.0032987219747155905, -0.012167294509708881, 0.057813264429569244, 0.01075249258428812, -0.07607165724039078, 0.0034364787861704826, 0.012636412866413593, -0.05826004594564438, 0.0036505607422441244, -0.027417367324233055, 0.018541349098086357, 0.036576345562934875, -0.004929467104375362, 0.008287759497761726, -0.002885450841858983, 0.029487445950508118, 0.01627766527235508, -0.03487858548760414, 0.01807967573404312, 0.03425309434533119, 0.051707278937101364, -0.052749764174222946, -0.025347288697957993, -0.028936417773365974, 0.008235635235905647, -0.04440988227725029, 0.007625036407262087, 0.004456625320017338, -0.018809417262673378, 0.0052533820271492004, -0.012681091204285622, -0.013775700703263283, -0.010931205004453659, -0.024230340495705605, -0.07916932553052902, 0.0008218880975618958, 0.03064907342195511, 0.048281971365213394, 0.008220742456614971, 0.004289083182811737, -0.014751169830560684, 0.054924093186855316, -0.03994208574295044, 0.05510280281305313, -0.01284490991383791, 0.03532536327838898, 0.017766930162906647, -0.008146279491484165, -0.010194018483161926, -0.010059984400868416, 0.05263062193989754, 0.012949158437550068, 0.03157241642475128, -0.04265254735946655, 0.002070078393444419, 0.006374054122716188, -0.036963555961847305, -0.016381913796067238, -0.021460307762026787, 0.0496520921587944, -0.004244405310600996, 0.034044597297906876, -0.0011662805918604136, -0.007085178047418594, 0.05903446301817894, -0.0458097904920578, -0.04530344158411026, 0.017975427210330963, 0.024974973872303963, 0.043695032596588135, 0.02521325647830963, -0.005249659065157175, -0.007773963268846273, -0.002781202318146825, 0.020894387736916542, -0.038720887154340744, -0.007952675223350525, -0.05653249844908714, -0.03042568266391754, -0.0203433595597744, -0.04149092361330986, -0.06272783875465393, -0.03079799935221672, 0.01690315641462803, -0.02125181071460247, 0.047150127589702606, 0.007654821965843439, 0.021534770727157593, -0.0010490010026842356, -0.02327721193432808, 0.0171861182898283, 0.028653457760810852, 0.03553386032581329, -0.03000868856906891, 0.019434908404946327, -0.05945145711302757, 0.047507550567388535, -0.010514210909605026, -0.045750219374895096, 0.036963555961847305, -0.02050717920064926, -0.017081869766116142, -0.08179043233394623, -0.008563273586332798, -0.053256116807460785, 0.022919787093997, 0.01796053536236286, -0.02941298298537731, -0.0470607727766037, -0.006385223474353552, -0.021296488121151924, 0.03586149960756302, -0.009829148650169373, -0.005204981192946434, 0.01201836857944727, -0.027462046593427658, -0.038095396012067795, 0.013485293835401535, 0.044707734137773514, -0.09275142103433609, 0.0006999545148573816, 0.0030362389516085386, -0.01819881796836853, -0.009449386037886143, 0.056681424379348755, 0.0035053573083132505, -0.0066160596907138824, -0.03487858548760414, -0.03228726610541344, 0.010164232924580574, -0.0073793078772723675, 0.0406867191195488, 0.024632442742586136, -0.024006951600313187, -0.011549250222742558, 0.013462955132126808, -0.05549001321196556, 0.023634634912014008, -0.019360443577170372, 0.0021482647862285376, -0.05823025852441788, 0.020522071048617363, -0.04440988227725029, -0.019032806158065796, -0.05060522258281708, -0.034550946205854416, 0.02250279299914837, -0.049801021814346313, -0.04518429934978485, 0.025630250573158264, 0.03160220384597778, -0.02759607881307602, -0.03958466276526451, 0.029323626309633255, 0.014982005581259727, -0.005331568419933319, 0.015473462641239166, 0.06272783875465393, -0.013887396082282066, 0.0007474248413927853, -0.0673743486404419, -0.03711248189210892, 0.037618834525346756, -0.007967567071318626, -0.010238696821033955, -0.023589957505464554, 0.0016763538587838411, -0.009561081416904926, -0.04029950872063637, -0.06916146725416183, 0.021564556285738945, -0.06248955801129341, -0.031006496399641037, 0.02023911103606224, 0.011363091878592968, 3.696983912959695e-05, -0.04801390320062637, -0.010462086647748947, -0.00922599621117115, 0.0273726899176836, 0.03520622476935387, 0.05003930255770683, 0.02087949402630329, 0.050813719630241394, 0.07362926006317139, -0.022160261869430542, -0.027804575860500336, -0.051707278937101364, 0.06117900460958481, 0.011489679105579853, 0.03258511796593666, 0.0008288690005429089, 0.006314483471214771, 0.007937782444059849, 0.02685144729912281, -0.004050800576806068, 0.0330318957567215, -0.02991933375597, -0.007368138525635004, -0.01265130564570427, -0.022458115592598915, 0.008957928977906704, 0.016337236389517784, 0.0006450378568843007, 0.05760476738214493, 0.004799156449735165, -0.0012211973080411553, 0.024587765336036682, -0.029100237414240837, 0.020030613988637924, -0.0033880777191370726, 0.01895834319293499, 0.0039763376116752625, 0.005666653160005808, 0.022800646722316742, 0.027015266939997673, -0.01678401604294777, 0.05733669921755791, 0.0007781409658491611, -0.002058908808976412, 0.0286236722022295, -0.025779176503419876, 0.004806602839380503, 0.0032335666473954916, -0.020254002884030342, -0.018392423167824745, 0.0028668351005762815, 0.0034923262428492308, 0.0019565217662602663, -0.027283333241939545, -0.0008456232608295977, -0.06820833683013916, -0.009881272912025452, 0.007066562306135893, 0.025347288697957993, -0.039018742740154266, -0.031721342355012894, 0.02250279299914837, -0.05945145711302757, -0.04360567778348923, 0.002462871838361025, 0.06427667289972305, -0.001392462756484747, -0.05450709909200668, 0.001952798687852919, -0.007431432139128447, -0.05671120807528496, 0.027715221047401428, 0.01374591514468193, 0.022562364116311073, -0.02899598889052868, -0.004303975962102413, -0.01354486495256424, -0.02442394569516182, -0.011854548938572407, 0.03714226931333542, -0.01201836857944727, -0.016054276376962662, -0.010998222045600414, 0.017364829778671265, 0.010290821082890034, -0.024200554937124252, -0.00397261418402195, -0.016635090112686157, 0.006485749036073685, 0.024751583114266396, -0.036338064819574356, -0.026494024321436882, 0.013515079393982887, 0.025868533179163933, -0.05700906366109848, -0.007677160669118166, -0.026642950251698494, -0.03449137508869171, 0.060255661606788635, 0.02914491482079029, 0.031363919377326965, 0.006094817072153091, 0.004862450063228607, -0.006642121821641922, -0.006575104780495167, 0.012703429907560349, 0.013373599387705326, -0.010707815177738667, 0.024960080161690712, -0.050307370722293854, 0.009568527340888977, -0.011102470569312572, -0.007185703609138727, 0.001492988085374236, -0.021683698520064354, -0.015518140979111195, 0.06552765518426895, 0.012911926954984665, 0.018675383180379868, -0.003916766960173845, -0.015964919701218605, 0.005335291847586632, -0.0031739959958940744, 0.0067426469177007675, -0.016709553077816963, -0.0203433595597744, -0.009836595505475998, 0.03000868856906891, -0.05420924350619316, 0.010037645697593689, -0.02111777663230896, -0.0318107008934021, 0.09352584183216095, -0.038125183433294296, -0.014319282956421375, -0.053107187151908875, -0.026017459109425545, -0.02329210378229618, -0.0074798334389925, -0.02138584479689598, 0.04438009485602379, -0.03982294350862503, 0.005093286279588938, 0.003497911151498556, -0.0057820710353553295, -0.03014272265136242, 0.014870310202240944, 0.002187357982620597, 0.012450255453586578, 0.0026490299496799707, -0.031751129776239395, -0.05203491821885109, -0.032108552753925323, 0.014766061678528786, 0.044707734137773514, 0.03851239010691643, -0.07035287469625473, -0.0070553929544985294, -0.00941960047930479, -0.00451991893351078, -0.010104662738740444, 0.029829977080225945, 0.03216812387108803, 0.00489968154579401, 0.0864369347691536, 0.02850453183054924, -0.01743929274380207, -0.026494024321436882, 0.03332975134253502, -0.009553634561598301, 0.03195962682366371, -0.018660489469766617, 0.010298267006874084, -0.0546858087182045, -0.05099243298172951, 0.035295579582452774, -0.03091713972389698, 0.014073553495109081, 0.03335953503847122, 0.013023622334003448, -0.009873826988041401, 0.010097216814756393, 0.0070553929544985294, -0.006750093307346106, -0.0029208208434283733, -0.007487279362976551, 0.00152742734644562, 0.06922103464603424, -0.0241707693785429, -0.026791876181960106, -0.05036694183945656, -0.03145327419042587, 0.0049741449765861034, 0.03776776045560837, 0.007193149533122778, 0.018109461292624474, 0.029472554102540016, 0.02010507695376873, -0.023843131959438324, -0.03598064184188843, -9.092660911846906e-05, 0.018228603526949883, 0.024796262383461, -0.016009598970413208, -0.046137429773807526, -0.029964011162519455, -0.01703719049692154, -0.006076200865209103, 0.0070553929544985294, 0.008049476891756058, -0.0008107186295092106, 0.02431969717144966, -0.003252182388678193, 0.01947958581149578, 0.01872006058692932, 0.023068714886903763, 0.017096761614084244, -0.030112937092781067, -0.010476979427039623, -0.026047244668006897, -0.044082242995500565, -0.01742440089583397, 0.029710836708545685, 0.028221571817994118, 0.030619287863373756, 0.010141894221305847, 0.05123071372509003, -0.01796053536236286, 0.043575894087553024, -0.04086542874574661, 0.019539156928658485, -0.002224589465186, 0.01729036681354046, 0.02390270307660103, 0.021073099225759506, 0.07059115916490555, -0.0015497663989663124, -0.01545856986194849, -0.032614901661872864, -0.004646506626158953, -0.05334547162055969, -0.006995822302997112, 0.04003144055604935, -0.011541803367435932, 0.03335953503847122, -0.05188599228858948, -0.03663591668009758, 0.024781368672847748, 0.04351632297039032, -0.02597278170287609, -0.021043313667178154, 0.006779878865927458, -0.00397261418402195, 0.048133041709661484, -0.00859305914491415, -0.038125183433294296, -0.026494024321436882, 0.007148471660912037, -0.00332478410564363, 0.007677160669118166, -0.03318082168698311, 0.025287719443440437, 0.006768709048628807, -0.009330244734883308, 0.005111902020871639, -0.044618379324674606, 0.031095853075385094, 0.010320605710148811, 0.036844413727521896, 0.022875109687447548, -0.023500600829720497, -0.04259297624230385, 0.0941215455532074, -0.016501056030392647, 0.04149092361330986, -0.0006301452522166073, 0.04175898805260658, -0.009255781769752502, -0.04783518984913826, -0.003079055342823267, -0.012472594156861305, 0.0071894265711307526, 0.0007767447386868298, 0.02379845455288887, -0.003920489922165871, 0.06564679741859436, 0.03294254094362259, -0.012144955806434155, 0.0254515390843153, 0.003924213349819183, -0.01131841354072094, 0.023634634912014008, 0.03520622476935387, 0.006846895441412926, 0.013135316781699657, -0.041431352496147156, 0.015562818385660648, -0.03419352322816849, 0.04348653554916382, 0.011370537802577019, 0.018734952434897423, 0.0776800587773323, 0.05888553708791733, -0.020254002884030342, -0.00845902506262064, -0.0610598623752594, 0.003916766960173845, -0.027000373229384422, 0.03511686623096466, -0.01934555172920227, 0.0062288506887853146, 0.01807967573404312, -0.016218096017837524, -0.002384685445576906, 0.005074670538306236, 0.0008726161904633045, 0.022443223744630814, -0.004464071709662676, -0.022458115592598915, 0.00936003029346466, 0.002138956682756543, -0.0005119348061271012, -0.01566706784069538, -0.017245687544345856, -0.001327307429164648, -0.016575518995523453, -0.004181111231446266, -0.010156787000596523, -0.022443223744630814, 0.007818641141057014, -0.039763376116752625, 0.01406610757112503, -0.016262773424386978, 0.01740950718522072, -0.01666487567126751, -0.009136640466749668, -0.015950027853250504, -0.018913665786385536, -0.006321929860860109, -0.006750093307346106, 0.010417408309876919, -0.03752947598695755, -0.025898316875100136, -0.11729450523853302, -0.021698590368032455, -0.009211103431880474, 0.014267158694565296, -0.03767840191721916, -0.012115170247852802, 0.04607785865664482, -0.04783518984913826, 0.006180449388921261, -0.0041476027108728886, 0.0012286435812711716, -0.028191786259412766, -0.04083564504981041, -0.004162495490163565, -0.006098540034145117, 0.004356100223958492, -0.012353452853858471, -0.018154140561819077, -0.016367021948099136, 0.03192983940243721, 0.0029208208434283733, -0.022353867068886757, -0.009196211583912373, 0.018913665786385536, -0.007111240178346634, 0.0331212542951107, -0.030202293768525124, -0.04158027842640877, 0.008257973939180374, 0.002777479123324156, 0.02583874762058258, -0.010432301089167595, 0.0011113639920949936, 0.0028109876438975334, -0.006791048217564821, 0.012673644348978996, -0.022085798904299736, -0.000694835209287703, 0.005878873635083437, 0.029934225603938103, -0.02443883754312992, 0.020939065143465996, 0.002771894447505474, -0.03601042553782463, -0.0136863449588418, -0.003987506963312626, 0.004259297624230385, -0.0018308651633560658, -0.017647789791226387, -0.013232119381427765, -0.001721031847409904, 0.016635090112686157, -0.006913912482559681, -0.013269350863993168, -0.03216812387108803, -0.03079799935221672, -0.01087908074259758, -0.013038515113294125, 0.026762090623378754, 0.01706697605550289, 0.010774832218885422, -0.018883880227804184, 0.00354445050470531, 0.014833078719675541, 0.024021843448281288, 0.024200554937124252, 0.010968436487019062, -0.02354527823626995, -0.0010341083398088813, 0.002364208223298192, -0.01770736090838909, -0.03738055005669594, -0.009538741782307625, 0.014237373135983944, -0.015830885618925095, 0.005610805936157703, -0.009553634561598301, -0.017647789791226387, -0.006005460862070322, -0.019554048776626587, 0.022309189662337303, 0.055907007306814194, 0.002055185614153743, 0.003289413871243596, 0.034431807696819305, -0.012561949901282787, -0.0419674851000309, -0.05826004594564438, -0.015413892455399036, -0.044856660068035126, -0.008295205421745777, 0.04783518984913826, 0.014535225927829742, 0.030351219698786736, -0.03079799935221672, 0.00020512298215180635, 0.013142763637006283, 0.021728375926613808, 0.0039763376116752625, -0.01330658234655857, -0.0031330410856753588, -0.0025243042036890984, 0.019494477659463882, -0.015279858373105526, 0.016441484913229942, -0.008660076186060905, 0.018034998327493668, -0.016709553077816963, 0.015101146884262562, 0.011325860396027565, -0.0032838291954249144, -0.00916642602533102, -0.008734539151191711, 0.0011178795248270035, 0.014974558725953102, 0.003559343283995986, -0.036338064819574356, 0.009084516204893589, -0.009724900126457214, -0.0017024159897118807, 0.01679890789091587, -0.018779631704092026, -0.014043768867850304, -0.04572043567895889, -0.034938156604766846, 0.045243870466947556, 0.001198858255520463, 0.02049228549003601, -0.03160220384597778, -0.009784471243619919, -0.029621480032801628, 0.02174326777458191, -0.02697058767080307, -0.015577711164951324, -0.01362677477300167, -0.041282422840595245, 0.0049443598836660385, 0.006154387257993221, 0.054030533879995346, 0.021222025156021118, 0.02531750500202179, -0.0029878378845751286, -0.008600505068898201, -0.06576593965291977, 0.03907831385731697, 0.012331114150583744, -0.010424855165183544, -0.025347288697957993, -0.01553303375840187, -0.02725354954600334, -0.06397882103919983, -0.01742440089583397, 0.03767840191721916, -0.03571257367730141, 0.0018922972958534956, -0.05102221667766571, -0.028400283306837082, -0.015726637095212936, -0.020968850702047348, 0.016054276376962662, 0.00020058537484146655, 0.041788775473833084, 0.012390684336423874, -0.010052538476884365, -0.014982005581259727, 0.04417159780859947, -0.05572829395532608, 0.010856741108000278, -0.008503702469170094, 0.006768709048628807, 0.026866339147090912, -0.014170356094837189, -0.022353867068886757, -0.05182642117142677, 0.026106813922524452, -0.007982459850609303, -0.030976710841059685, -0.009531295858323574, -0.03279361501336098, -0.030857570469379425, 0.03800604119896889, 0.056800566613674164, -0.01629255898296833, 0.024960080161690712, 0.03324039280414581, -0.01729036681354046, -0.029829977080225945, -0.029695942997932434, 0.00020989327458664775, 0.0015953751280903816, -0.0006320067914202809, 0.014341621659696102, -0.05036694183945656, -0.03666570410132408, -0.005849088076502085, -0.03994208574295044, -0.0020756630692631006, -0.00194907549303025, -0.017081869766116142, -0.007595251314342022, 0.02813221514225006, -0.028400283306837082, 0.046643778681755066, 0.024379268288612366, 0.035176437348127365, 0.016203202307224274, -0.044707734137773514, -0.0139841977506876, 0.006534149870276451, -0.02236875891685486, 0.004363546147942543, -0.011817317456007004, -0.027923718094825745, 0.0028109876438975334, -0.04399288818240166, -0.03958466276526451, 0.0483117550611496, 0.017469078302383423, -0.013522526249289513, -0.0001460177736589685, 0.03830389305949211, -0.016575518995523453, -0.010045092552900314, -0.019241303205490112, 0.014944774098694324, -0.022324081510305405, -0.020953958854079247, 0.019137054681777954, -0.0031497953459620476, 0.011556696146726608, 0.012338560074567795, 0.003410416655242443, -0.02430480346083641, 0.0005580089637078345, 0.038214538246393204, -0.013433169573545456, 0.005674099549651146, 0.014766061678528786, 0.014833078719675541, -0.020819924771785736, -0.004434286616742611, 0.0356530025601387, 0.001921151764690876, 0.025526002049446106, -0.03452116250991821, 0.006374054122716188, 0.01335870660841465, 0.06463409960269928, -0.03985273092985153, -0.007706946227699518, -0.0008419001242145896, -0.012949158437550068, 0.028042858466506004, 0.007040500175207853, -0.012666198424994946, -0.020805031061172485, 0.02202622964978218, -0.036457207053899765, 0.012859802693128586, -0.0006194411544129252, 0.04059736430644989, 0.00807181652635336, -0.046494852751493454, -0.008228189311921597, 0.021013528108596802, -0.021698590368032455, 0.0030604396015405655, -0.01666487567126751, -0.011422662064433098, 0.018034998327493668, -0.12235800921916962, -0.012383238412439823, 0.03106606751680374, -0.00993339717388153, -0.022473007440567017, -0.012316221371293068, 0.014386299066245556, 0.01755843311548233, 0.01553303375840187, 0.008034584112465382, 0.01329913642257452, -0.01857113465666771, -0.006638398393988609, -0.03154263272881508, -0.0005761593929491937, -0.048550039529800415, 0.0020235388074070215, -0.004735862370580435, 0.012681091204285622, -0.026806769892573357, 0.002982252975925803, -0.023604849353432655, -0.023828240111470222, -0.01944980025291443, -0.014565011486411095, -0.012628966942429543, 0.0009801224805414677, -0.004389608278870583, 0.009866380132734776, 0.005126794800162315, 0.017483970150351524, 0.02683655545115471, 0.0025894595310091972, 0.04530344158411026, -0.028966203331947327, 0.007092624437063932, -0.008913250640034676, -0.015473462641239166, 0.029591694474220276, 0.02251768670976162, 0.019643405452370644, -0.05549001321196556, 0.02047739364206791, -0.000323217042023316, 0.007729284930974245, -0.016128739342093468, 0.027670543640851974, -0.02720887027680874, -0.006861788220703602, 0.0009345137514173985, 0.003927936311811209, 0.01872006058692932, -0.010700368322432041, -0.023113392293453217, -0.008801556192338467, 0.01449799444526434, 0.007036776747554541, -0.006727754604071379, 0.0033545694313943386, -0.0031665496062487364, -0.004765647929161787, 0.03589128702878952, 0.031185207888484, -0.005595913156867027, -0.0235601719468832, -0.024915402755141258, 0.03270426020026207, 0.016843587160110474, -0.011683283373713493, -0.02697058767080307, 0.0023344228975474834, -0.006083647254854441, 0.016307450830936432, 0.023768668994307518, 0.016635090112686157, 0.025243040174245834, -0.013693790882825851, 0.028832169249653816, -0.04241426661610603, 0.02443883754312992, 0.07416539639234543, -0.014959666877985, -0.004475241061300039, -0.0008088570320978761, -0.011996028944849968, -0.0063815005123615265, 0.03115542232990265, 0.004970422014594078, -0.020924173295497894, 0.012241758406162262, 0.027432261034846306, -0.017752038314938545, -0.001392462756484747, 0.011623713187873363, -0.050813719630241394, -0.028727920725941658, 0.00993339717388153, 0.019926365464925766, 0.02266661264002323, 0.01705208420753479, 0.06808919459581375, 0.03344888985157013, -0.028072644025087357, -0.057813264429569244, -0.025377074256539345, 0.009590866044163704, 0.004210896790027618, -0.034282878041267395, -0.005960782989859581, 0.006980929523706436, -0.007122409529983997, 0.012070492841303349, -0.0019016051664948463, 0.012993836775422096, -0.0004774955741595477, 0.018109461292624474, 0.03970380499958992, 0.002716046990826726, 0.04515451192855835, -0.03228726610541344, 0.02162412740290165, 0.0394059494137764, -0.017022298648953438, 0.01794564351439476, -0.04163984954357147, 0.006813387386500835, 0.024602657184004784, 0.06397882103919983, 0.012800232507288456, 0.01469159871339798, -0.01354486495256424, 0.03720184043049812, 0.0010517933405935764, -0.010015306994318962, 0.006925081834197044, 0.0076213134452700615, -0.014334174804389477, 0.0067054154351353645, -0.054268814623355865, 0.01806478388607502, -0.0021296488121151924, 0.01757332682609558, 0.019166840240359306, 0.0066160596907138824, -0.012152401730418205, 0.0008251458639279008, 0.003983783535659313, -0.01158648170530796, -0.021847516298294067, 0.002768171252682805, 0.015503248199820518, -0.03678484633564949, -0.0034774336963891983, -0.0045869359746575356, -0.011087577790021896, 0.02062631957232952, -0.03282339870929718, -0.02646423876285553, -0.0016856617294251919, 0.014185248874127865, 0.03749969229102135, 0.04158027842640877, 0.00036510260542854667, -0.014803294092416763, 0.015726637095212936, -0.023217640817165375, -0.02848963811993599, -0.013559757731854916, -0.004877342842519283, 0.002111033070832491, -0.017111653462052345, -0.02799818105995655, 0.01706697605550289, 0.012673644348978996, 0.0648128092288971, 0.03449137508869171, -0.004527365323156118, 0.02583874762058258, -0.023887809365987778, 0.056175075471401215, 0.011273736134171486, 0.016054276376962662, 0.00030460121342912316, 0.0022655443754047155, 0.020805031061172485, -0.00454598106443882, -0.003203781321644783, 0.027759898453950882, 0.001198858255520463, 0.030112937092781067, 0.013902287930250168, 0.04655442386865616, 0.012331114150583744, 0.01469159871339798, -0.003808795241639018, 0.018675383180379868, -0.007196872960776091, 0.01565217413008213, -0.015101146884262562, -0.016069168224930763, -0.03347867727279663, 0.023083606734871864, -0.01362677477300167, -0.003853473113849759, -0.004281636793166399, 0.022592149674892426, 0.011221611872315407, 0.012614074163138866, -0.026806769892573357, -0.01322467252612114, -0.034312665462493896, -0.0002971549110952765, -0.030261864885687828, 0.04935424029827118, -0.010700368322432041, -0.006608613301068544, 0.026940803974866867, 0.02722376398742199, -0.038095396012067795, -0.007252720184624195, -0.0209986362606287, -0.005275721196085215, -7.882632780820131e-05, -0.03827410936355591, -0.010149341076612473, 0.0007865180377848446, -0.013381045311689377, 0.006407562643289566, -0.012666198424994946, 0.02123691886663437, 0.01706697605550289, 0.019911471754312515, 0.01651594787836075, -0.022473007440567017, 0.0006804079166613519, -0.020968850702047348, -0.017007404938340187, -0.014602242968976498, -0.027506723999977112, 0.02175816148519516, 0.018764737993478775, -0.00451991893351078, -3.5079170629614964e-05, -0.002622967818751931, 0.006630952004343271, -0.014133124612271786, 0.009978075511753559, 0.024006951600313187, 0.014200141653418541, -0.005275721196085215, -0.008853680454194546, 0.02707483619451523, 0.026642950251698494, 0.0006701692473143339, 0.0031628264114260674, -0.0025969056878238916, 0.008161172270774841, 0.04226534068584442, 0.017603112384676933, 0.025660036131739616, -0.01860092021524906, 0.002356761833652854, 0.02431969717144966, -0.016188310459256172, 0.009523849003016949, -0.025540893897414207, -0.013366153463721275, -0.009873826988041401, -0.0035295579582452774, -0.01602449081838131, -0.015696853399276733, 0.014073553495109081, -0.014028876088559628, 0.036069996654987335, -0.0005082116695120931, -0.01553303375840187, 0.009084516204893589, -0.008779216557741165, 0.03067885898053646, -0.025511108338832855, -0.026300419121980667, -0.01691805012524128, -0.014810740016400814, -0.0133512606844306, 0.005666653160005808, -0.024468623101711273, -0.005283167585730553, -0.00572994677349925, 0.017007404938340187, 0.016873372718691826, 0.03142349049448967, 0.02086460217833519, 0.0013403384946286678, 0.0055475118570029736, -0.024766476824879646, -0.012457701377570629, 0.017647789791226387, 0.015503248199820518, 0.00537624629214406, -0.03142349049448967, 0.015309643931686878, 0.013321475125849247, 0.012852356769144535, -0.032525546848773956, 0.03526579588651657, 0.011430108919739723, 0.017111653462052345, -0.020566748455166817, -0.01869027502834797, -0.03779754415154457, -0.006240020040422678, 0.03246597573161125, 0.04250362142920494, 0.014453316107392311, 0.008868573233485222, 0.009829148650169373, 0.00259132101200521, -0.013239565305411816, 0.028281141072511673, 0.00832499098032713, -0.00903983786702156, 0.011348199099302292, -0.004378438927233219, 0.017483970150351524, -0.004169941879808903, -0.023977166041731834, -0.01793074980378151, -0.008890911936759949, -0.006906466092914343, 0.017618004232645035, 0.01405866164714098, 0.02277086116373539, 0.023962272331118584, -0.0124130230396986, -0.03803582862019539, 0.003200058126822114, -0.011407769285142422, -0.012040707282721996, -0.02457287162542343, -0.03228726610541344, 0.004076862707734108, 0.013098085299134254, -0.0045422581024467945, 0.008570719510316849, -0.018645597621798515, 0.011407769285142422, -0.003185165347531438, -0.025243040174245834, -0.017111653462052345, -0.0165457334369421, 0.08637736737728119, -0.009702561423182487, -0.0035723743494600058, 0.002235759049654007, -0.0018224880332127213, -0.0010983329266309738, 0.007230381481349468, -0.040716502815485, -0.010901419445872307, 0.014438423328101635, -0.015547926537692547, 0.022473007440567017, 0.007870765402913094, 0.023113392293453217, 0.02174326777458191, -0.0033359534572809935, 0.0008004799019545317, 0.028817277401685715, 0.015711745247244835, 0.012368345633149147, 0.008265420794487, -0.0011662805918604136, 0.007803748361766338, -0.014222480356693268, -0.033419106155633926, 0.009821702726185322, 0.019673191010951996, 0.009196211583912373, 0.02647913061082363, 0.015503248199820518, 0.02162412740290165, -0.021222025156021118, -0.019911471754312515, 0.01088652666658163, -0.008727092295885086, -0.001624229596927762, -0.013671452179551125, 0.03884002938866615, -0.03851239010691643, -0.011899227276444435, -0.03258511796593666, 0.01227154303342104, 0.014073553495109081, 0.028966203331947327, 0.02199644409120083, 0.024989865720272064, 0.01563728228211403, 0.019926365464925766, 0.02698548138141632, -0.03130434826016426, 0.029949117451906204, -0.02087949402630329, 0.01958383433520794, -0.015979813411831856, 0.022100692614912987, -0.036457207053899765, 0.018749846145510674, 0.01374591514468193, 0.03359781578183174, -0.00353141943924129, -0.04393331706523895, -0.005137964151799679, -0.026881232857704163, -3.548639142536558e-05, -0.012070492841303349, -0.049681879580020905, -0.0005635936977341771, 0.02187730185687542, -0.017111653462052345, 0.034163739532232285, -0.013768254779279232, 0.027670543640851974, -0.0014771646820008755, -0.01145244762301445, 0.029740620404481888, 0.015979813411831856, -0.004445455968379974, -0.01227154303342104, 0.021579449996352196, 0.02390270307660103, -0.012628966942429543, -0.013038515113294125, -0.009970628656446934, -0.007397923618555069, 0.0012165432563051581, 0.005450709722936153, 0.039257023483514786, 0.012010921724140644, -0.0010248004691675305, 0.04169942066073418, -0.022234726697206497, -0.00927812047302723, 0.01349274069070816, -0.0016400530003011227, 0.025377074256539345, -0.034908369183540344, -0.006731477566063404, -0.021668804809451103, 0.007632482796907425, 0.0011551111238077283, -0.002380962250754237, -0.028444960713386536, 0.008235635235905647, 0.019658297300338745, -0.028057752177119255, 0.015696853399276733, -0.047656480222940445, -0.011087577790021896, 0.021073099225759506, -0.006441071163862944, 0.0006645845132879913, -0.0030250693671405315, -0.00734579935669899, -0.01883920095860958, -0.03461051732301712, 0.028578994795680046, -0.000480287941172719, 0.02851942367851734, -0.0114598935469985, -0.05498366057872772, 0.02049228549003601, 0.011325860396027565, 0.023858023807406425, -0.013783147558569908, -0.025928102433681488, 0.011765193194150925, -0.022592149674892426, -0.020641211420297623, 0.008123940788209438, -0.024796262383461, 0.011340752243995667, 0.008339883759617805, 0.006076200865209103, 0.005945890210568905, -0.009151533246040344, 0.029457660391926765, 0.020834816619753838, -0.025406859815120697, -0.022949572652578354, -0.003023207886144519, -0.03091713972389698, 0.027640758082270622, -0.03627849370241165, -0.02595788799226284, -0.00046748958993703127, 0.008816448971629143, -0.006247466430068016, -0.02621106244623661, 0.019256195053458214, 0.017886072397232056, -0.004374715965241194, -0.009196211583912373, 0.005849088076502085, 0.006872957572340965, -0.019494477659463882, -0.011660944670438766, 0.033151037991046906, 0.006582551170140505, 0.02533239684998989, 0.006671906914561987, 0.017722252756357193, -0.007517064921557903, -0.02658337913453579, 0.022741075605154037, 0.03854217752814293, 0.01101311482489109, -0.009121747687458992, 0.004158772528171539, 0.043337609618902206, 0.013247012160718441, 0.013038515113294125, 0.003635668195784092, 0.033270180225372314, 0.014803294092416763, -0.009106854908168316, -0.011445000767707825, -0.024349482730031013, 0.03726140782237053, 0.0006883196765556931, 0.01387250330299139, -0.015093700028955936, -0.0069027431309223175, 0.022711290046572685, 0.011340752243995667, 0.0331212542951107, 0.010596119798719883, 0.011050346307456493, -0.003131179604679346, -0.005789517425000668, 0.03487858548760414, 0.007241550832986832, -0.013127870857715607, -0.022726183757185936, -0.0023064990527927876, 0.016367021948099136, 0.01545856986194849, 0.010655690915882587, -0.009322798810899258, 0.0006883196765556931, 0.023098500445485115, -0.0279683955013752, -0.012234311550855637, 0.03000868856906891, -0.01642659306526184, 0.0318107008934021, -0.0002764447999652475, -0.015235180966556072, -0.03458073362708092, -0.00807181652635336, 0.006630952004343271, 0.00783353392034769, 0.0008944897563196719, 0.023217640817165375, 0.0047023543156683445, 0.05748562887310982, -0.041669633239507675, -0.0054209246300160885, 0.00827286671847105, -0.005871427245438099, -0.037082698196172714, -0.0032745213247835636, -0.006932528223842382, 0.018645597621798515, -0.0010834402637556195, -0.03166177123785019, 0.002001199871301651, 0.008987713605165482, 0.020254002884030342, -0.006284697912633419, -0.003187027061358094, 0.01882430911064148, -0.015294751152396202, 0.011147147975862026, -0.012993836775422096, 0.023634634912014008, -0.009695114567875862, 0.011787531897425652, -0.01272576954215765, 0.025228148326277733, 0.002098002005368471, -0.04247383773326874, -0.0014222480822354555, 0.007960121147334576, 0.006575104780495167, 0.020447608083486557, 0.04533322528004646, 0.013693790882825851, 0.00541347824037075, -0.011541803367435932, 0.01858602650463581, -0.005592189729213715, 0.014706491492688656, -0.007766516879200935, -0.06469366699457169, 0.009769578464329243, -0.026881232857704163, -0.009084516204893589, -0.010722707957029343, 0.047388412058353424, 0.014215034432709217, 0.003497911151498556, -0.017766930162906647, -0.013045961037278175, -0.003095809603109956, -0.022696398198604584, 0.003669176483526826, -0.014870310202240944, -0.006694246083498001, -0.007360692135989666, -0.037231624126434326, -0.005517726764082909, 0.015041575767099857, -0.02175816148519516, 0.0025615356862545013, 0.011176933534443378, 0.013894842006266117, -0.013269350863993168, -0.030500145629048347, 0.015547926537692547, 0.01246514730155468, 0.04947338253259659, -0.0016465685330331326, -0.008257973939180374, -0.00042234623106196523, -0.007751624099910259, 0.007811194751411676, -0.006899019703269005, 0.007900550961494446, 0.005688992328941822, 0.01971786841750145, 0.024215448647737503, 0.01120671909302473, 0.02010507695376873, -0.03931659460067749, 0.024498408660292625, 0.0006441071163862944, 0.0248111542314291, -0.0070553929544985294, 0.01450544036924839, 0.00563314463943243, -0.0052533820271492004, -0.018154140561819077, -0.0045794895850121975, -0.004438009578734636, -0.004624167922884226, 0.009077070280909538, -0.01063335221260786, 0.02773011289536953, 0.03362760320305824, -0.005048608407378197, 0.0008609812939539552, 0.02266661264002323, -0.017632897943258286, 0.02162412740290165, 0.01455756463110447, 0.0008372461306862533, -0.01234600692987442, -0.012420469895005226, -0.01703719049692154, 0.05042651295661926, -0.00965788308531046, 0.0254515390843153, 0.005309229716658592, -0.029085345566272736, 0.025928102433681488, -0.011616266332566738, 0.024140985682606697, 0.0011914119822904468, 0.004434286616742611, -0.02597278170287609, 0.020715676248073578, -0.014267158694565296, 0.017335044220089912, -0.01642659306526184, 0.010372730903327465, 0.009650437161326408, 0.002299052895978093, 0.024498408660292625, 0.029368305578827858, -0.021192239597439766, -0.027566295117139816, 0.014416084624826908, -0.0369039848446846, -0.021668804809451103, -0.00420345040038228, 0.03681463003158569, -0.0432184673845768, 0.002287883311510086, -0.01973276026546955, 0.013671452179551125, 0.024900510907173157, 0.0406867191195488, 0.015294751152396202, -0.022443223744630814, 0.004140156786888838, 0.04366524890065193, 0.019941257312893867, -0.0015842055436223745, -0.010923758149147034, -0.02622595615684986, -0.025034543126821518, -0.026374882087111473, 0.02111777663230896, 0.004225789103657007, 0.02963637188076973, -0.008012245409190655, 0.006262359209358692, -0.01858602650463581, 0.0019397676223888993, 0.024096306413412094, -0.021073099225759506, 0.04131221026182175, -0.003131179604679346, -0.021445415914058685, 0.004274190403521061, -0.018228603526949883, -0.0330914668738842, -0.004251851234585047, 0.02253257855772972, 0.0013412692351266742, 0.025928102433681488, -0.031751129776239395, 0.03139370679855347, 0.014088446274399757, 0.02163901925086975, -0.01379803940653801, -0.023247426375746727, 0.02061142772436142, -0.006608613301068544]",Online Speculative Decoding.pdf
"DSDOnlineAdaptorTarget WorkerRejection SamplerDraft Model KVTarget Model KV
ProposeScoreAcceptSmall Draft Model,N-gram
DSD Offline Profiler
Figure 9. System architecture of SmartSpec in vLLM.
We implement SmartSpec within vllm [ 19] and illustrate
the system architecture in Figure 9. Initially, upon receiving
a request, the lookahead scheduler takes charge. This sched-
uler is tasked with dispatching requests for immediate execu-
tion and managing resource allocation within the key-value
(KV) cache. It is termed a ""lookahead"" scheduler because it
proactively reserves multiple KV cache spots for tokens that
have yet to be generated. Subsequently, the engine forwards
these active requests to the speculative decoding worker,
which, in turn, activates the draft worker. The draft worker
operates the draft model through several steps, each gen-
erating a proposed token. It offers a standardized interface
that supports various speculative decoding approaches, such
as a small draft model or an n-gram model. Subsequently,
the target worker utilizes the target model for scoring and
verification purposes. Note here both the draft and target
models interact with the KV cache during their forward.
For effective memory management within speculative de-
coding, it is essential to maintain the key-value (KV) cache
for both the draft and target workers. In scenarios where
draft-model-based speculative decoding is employed, we di-
vide the total memory allocated for the KV cache into twodistinct segments: one dedicated to the draft model and the
other to the target model. Our observations have consistently
shown that the number of required slots for both the draft
and target models remains constant both before and after
the execution step. Consequently, we allocate the KV cache
to provide an equal number of slots for each model, with
the scheduler assigning the same number of slots to both
models. This approach not only simplifies the system‚Äôs archi-
tecture but also reduces its complexity. On the other hand,
when carrying out draft-model free speculative decoding,
SmartSpec maintains the KV cache as it without speculative
decoding.
To dynamically adjust the proposed length, we employ the
online adaptor in conjunction with the offline profiler. The
offline profiler is responsible for analyzing both the draft (if
any) and target models to derive the performance coefficients
critical for the performance model, as detailed in Section 4.3.
These coefficients are subsequently utilized by the online
adaptor, which aggregates batch information. Based on this
data, the online adaptor adjusts the proposal length for the
draft worker and the verification length for the target model.
7 Evaluation
Model and server configurations. We test on two pop-
ular open source model families: Llama and Mistral. For
Llama, we use Vicuna-7B-v1.5, Vicuna-33B-v1.3 [ 44], and
Llama-2-70b-chat-hf [ 36]. For Mistral, we use Mistral-7B-
Instruct-v0.1 [ 13] and Mixtral-8x7B-Instruct-v0.1 [ 14]. We
use a single A100-80G [ 28] GPU for the 7B model, 4 √óA100-
80G GPUs for the 33B model, and 8 √óA100-80G GPUs for
the 70B model. For the draft model-based method, the draft
model operates with tensor parallelism set to 1, and only the
target model is sharded across multiple GPUs. We provide
detailed specifications of the setup in Table 1.
Evaluated methods and baselines. We test the efficiency
of SmartSpec on both standard speculative decoding, where a
draft model is used to make the proposal, and prompt lookup
decoding, where the proposal is made by looking up ngrams
in the prompt. Both mechanisms are detailed in Sec. 2.1. For
standard speculative decoding, we fine-tune Llama-160M
on the shareGPT dataset to improve its general proposal
capability and use it as the draft model for Vicuna-7B. For
Llama2-70B model, we use Vicuna-7B as the draft. For all
the settings, the draft model shares the same tensor parallel
degree as the target model.
We compared SmartSpec against two baselines: vanilla
auto-regressive inference, which does not incorporate specu-
lative decoding, and using speculative decoding with a fixed
proposed length of 1, 3, and 5 across all execution steps.
Workloads. In our study, we focus on four types of work-
loads, online chatting, text-to-SQL, summarization, and ques","[0.02552902325987816, 0.052399516105651855, 0.05209837108850479, -0.037369560450315475, -0.04013463482260704, 0.016138723120093346, -0.017288554459810257, 0.010512755252420902, -0.007145388517528772, -0.005957912653684616, 0.018191995099186897, -0.00482861278578639, -0.04832034930586815, 0.02940286323428154, 0.014550858177244663, -0.005759429652243853, 0.004534310195595026, -0.015002578496932983, -0.017972979694604874, 0.0082609998062253, -0.0008136092801578343, 0.027719179168343544, 0.010752304457128048, 0.02518681064248085, 0.04673248529434204, -0.033317770808935165, -0.014222335070371628, 0.033153507858514786, 0.05218049883842468, -0.06964700669050217, 0.004380315076559782, -0.02420124039053917, -0.02139510028064251, -0.03487825766205788, 2.3246360797202215e-05, 0.03367367014288902, 0.009609315544366837, 0.011861070990562439, -0.028389915823936462, -0.005567790940403938, -0.002898536389693618, -0.03498776629567146, -0.050346244126558304, 0.02956712432205677, 0.008671654388308525, 0.05072952061891556, 0.003935439046472311, 0.01337364874780178, -0.007822968997061253, 0.03698628395795822, -0.04500773549079895, 0.0010155143681913614, 0.002361263381317258, 0.010184232145547867, 0.026966312900185585, -0.021696247160434723, 0.0004371759423520416, 0.0005282899364829063, 0.03893004730343819, 0.002722297329455614, 0.023420995101332664, -0.020286332815885544, 0.000615553988609463, 0.023489437997341156, -0.040435779839754105, -0.014523481018841267, -0.03277023136615753, 0.04593855142593384, -0.01110820472240448, 0.028034014627337456, -0.0011284444481134415, 0.00020115655206609517, 0.041421353816986084, -0.045473143458366394, -0.017233802005648613, 0.006727889645844698, 0.04448757320642471, 0.05510983616113663, 0.006077686790376902, 0.003208238398656249, -0.006009244360029697, 0.022750260308384895, 0.008370507508516312, -0.032250069081783295, -0.023968534544110298, -0.022613374516367912, -0.00345976441167295, 0.010218453593552113, -0.005105804651975632, -0.04147610440850258, -0.03501514345407486, 0.03441284969449043, -0.022353293374180794, 0.0028797148261219263, 0.04881313443183899, 0.023174602538347244, 0.019341828301548958, -0.039751358330249786, 0.023585258051753044, 0.03772545978426933, 0.027554918080568314, 0.029430240392684937, 0.035234156996011734, -0.01908174715936184, 0.07085159420967102, -0.007692927960306406, -0.019861990585923195, 0.054124265909194946, -0.006782643962651491, 0.005769696086645126, -0.10063773393630981, -0.02567959576845169, -0.04180463030934334, 0.003791710129007697, -0.02421492710709572, -0.033810555934906006, -0.062309980392456055, -0.020874937996268272, -0.02247649058699608, 0.013510533608496189, -0.005382996518164873, 0.0338379330933094, 0.039450209587812424, -0.01313410047441721, -0.004931276198476553, 0.02253124490380287, 0.027472786605358124, -0.0900702252984047, -0.010991852730512619, 0.004185253754258156, -0.02088862657546997, 0.01168996561318636, 0.0553562305867672, 0.0012285414850339293, -0.016645196825265884, -0.00584498280659318, -0.04979870468378067, -0.0024930150248110294, -0.013154633343219757, 0.0276507381349802, -0.01383221335709095, -0.013791147619485855, -0.005040784366428852, 0.015385855920612812, -0.06570472568273544, 0.022189032286405563, -0.005927113350480795, 0.004804657772183418, -0.0404905341565609, 0.03575431928038597, -0.03676726669073105, -0.0301420409232378, -0.00834313128143549, -0.01873953454196453, 0.0044521791860461235, -0.027554918080568314, -0.044816095381975174, 0.010560665279626846, 0.01676839217543602, -0.015645937994122505, 0.001680261455476284, 0.035316288471221924, 0.011046606115996838, 0.015892330557107925, -0.0107317715883255, 0.020436907187104225, -0.048101332038640976, -0.006837397813796997, -0.0685519278049469, -0.03920381888747215, 0.03162039816379547, -0.007624485529959202, -0.008794850669801235, -0.024160174652934074, -0.014304465614259243, -0.030415810644626617, -0.005410373210906982, -0.07337027043104172, 0.014071761630475521, -0.04369363933801651, -0.06559521704912186, 0.031154990196228027, -0.03153826668858528, 0.004698572214692831, -0.04114758223295212, -0.03723267465829849, -0.02833516150712967, 0.02098444662988186, 0.014304465614259243, 0.012258036993443966, 0.0355353057384491, 0.04259856045246124, 0.04607543721795082, -0.004147610627114773, 0.018465764820575714, -0.02825303003191948, 0.017192736268043518, 0.023817962035536766, -0.012655002996325493, 0.011792629025876522, 0.009232882410287857, 0.01242914330214262, 0.005605434067547321, -0.05568475276231766, 0.019848302006721497, -0.0007147955475375056, 0.011943202465772629, 0.013017748482525349, -0.02016313746571541, -0.014509793370962143, 0.03490563482046127, 0.019711416214704514, 0.074355848133564, -0.009075464680790901, -0.025665907189249992, -0.007699772249907255, -0.038765788078308105, 0.011703654192388058, 0.03277023136615753, 0.04717051610350609, 0.012210127897560596, 0.00602635508403182, 0.002131981309503317, 0.019287073984742165, -0.023147225379943848, 0.07698403298854828, -0.014660365879535675, -0.021203462034463882, 0.022175343707203865, -0.032907113432884216, 0.012449676170945168, -0.017001096159219742, -0.0013389048399403691, -0.0013260719133540988, -0.00871272012591362, -0.03756120055913925, -0.006361722946166992, -0.014222335070371628, 0.0015185661613941193, -0.07161814719438553, 0.017699209973216057, 0.01724749058485031, 0.023325176909565926, -0.015440610237419605, -0.013585819862782955, 0.02172362431883812, -0.03156564384698868, -0.05253640189766884, 0.020108383148908615, 0.037451691925525665, -0.01110136043280363, -0.047033630311489105, -0.02948499470949173, -0.0044521791860461235, -0.045637406408786774, 0.022982964292168617, -0.03435809537768364, 0.01809617504477501, -0.059846051037311554, -0.0025717238895595074, -0.01490675937384367, -0.028034014627337456, -0.006019510794430971, 0.040764305740594864, -0.05902474373579025, -0.026897870004177094, 0.0012293969048187137, 0.002535791601985693, 0.020765429362654686, -0.06959225237369537, -0.0020276065915822983, -0.005602011922746897, -0.011594145558774471, -0.001349171157926321, -0.020957069471478462, -0.023927470669150352, 0.018520519137382507, 0.00018832359637599438, -0.021586738526821136, 0.002756518544629216, 0.017151670530438423, -0.016946343705058098, 0.04358413442969322, 0.02155936136841774, 0.0009102841722778976, 0.03969660401344299, 0.025583775714039803, -0.00789141096174717, -0.011703654192388058, 0.02674729749560356, 0.02247649058699608, -0.009889929555356503, 0.020874937996268272, -0.04908690229058266, 0.027034755796194077, 0.008500548079609871, 0.028143523260951042, -0.007740837521851063, -0.022230098024010658, -0.027773933485150337, 0.07802435755729675, 0.050510507076978683, 0.0495523102581501, -0.006255636923015118, 0.007111167535185814, -0.015358478762209415, -0.00741231394931674, 0.007556043099611998, -0.00668682437390089, -0.021778378635644913, 0.009499807842075825, 0.0006946905632503331, -0.03285236284136772, -0.0121827507391572, -0.02288714423775673, -0.08568990975618362, 0.03673988953232765, -0.026719920337200165, 0.036876775324344635, -0.022093212231993675, -0.02784237638115883, -0.023229356855154037, -0.03627448156476021, 0.019684039056301117, 0.01891748420894146, -0.020464284345507622, -0.0004209208709653467, 0.00400730362161994, 0.008938579820096493, -0.001462101237848401, 0.02073805220425129, 0.03767070919275284, 0.024885663762688637, -0.026706231757998466, 0.007282273378223181, -0.037698086351156235, -0.05327557772397995, 0.03739693760871887, 0.03435809537768364, 0.01490675937384367, -0.09297218173742294, -0.002905380679294467, -0.008979645557701588, -0.004921009764075279, -0.01275766734033823, 0.00555410236120224, 0.010512755252420902, 0.021121330559253693, 0.09275316447019577, 0.02129928022623062, -0.01053328812122345, -0.035398419946432114, 0.06044834479689598, -0.04585641995072365, 0.022421736270189285, -0.0355079285800457, 0.00277705118060112, -0.024475010111927986, -0.016152411699295044, -0.0021200040355324745, -0.010800213553011417, 0.04054528847336769, 0.03178466111421585, -0.002905380679294467, 0.0313740037381649, 0.01515315193682909, -0.012648158706724644, 0.0050989603623747826, 0.0031723061110824347, -0.057436879724264145, 0.009588782675564289, 0.0801597610116005, -0.030607450753450394, 0.015906019136309624, -0.037451691925525665, -0.012750823050737381, -0.00834313128143549, 0.06011982262134552, -0.012422299012541771, 0.03392006456851959, 0.027157951146364212, -0.003689046483486891, -0.03808136284351349, -0.031100235879421234, 0.021901573985815048, -0.007261740509420633, 0.012292258441448212, -0.017370685935020447, -0.037533823400735855, 0.00044145359424874187, -0.033564161509275436, 0.002934468677267432, -0.004633551929146051, 0.0011943202698603272, 0.007617641240358353, 0.048101332038640976, 0.00031055748695507646, 0.031072858721017838, 0.03641136735677719, 0.03170252963900566, 0.020929692313075066, -0.021039199084043503, -0.030032534152269363, -0.020286332815885544, -0.01865740306675434, 0.029183847829699516, 0.04402216523885727, 0.019848302006721497, 0.0276507381349802, 0.012518118135631084, 0.048347726464271545, -0.06389784067869186, 0.04336511716246605, -0.024064354598522186, 0.012579716742038727, -0.02500886097550392, 0.020833872258663177, 0.03238695114850998, 0.07879091054201126, 0.08760629594326019, -0.015221593901515007, -0.05516459047794342, -0.042817577719688416, -0.034303341060876846, -0.054480165243148804, -0.01850683055818081, 0.03268809989094734, -0.013017748482525349, 0.04054528847336769, -0.0462397001683712, -0.053713612258434296, 0.023147225379943848, 0.058093924075365067, -0.024748777970671654, -0.06006506830453873, -0.011162959039211273, 0.00656362809240818, 0.016042903065681458, -0.0033006356097757816, -0.018383633345365524, -0.030005156993865967, -0.002077227458357811, -0.023640012368559837, 0.041010696440935135, -0.008616901002824306, 0.03378317877650261, -0.011258778162300587, 0.007467067800462246, 0.037944477051496506, -0.051742468029260635, 0.023886404931545258, 0.004308450501412153, 0.017220113426446915, -0.014728808775544167, -0.005947646219283342, -0.06269325315952301, 0.11366917192935944, -0.013763770461082458, 0.033564161509275436, -0.002414306392893195, 0.045445766299963, 0.017302243039011955, -0.0545075424015522, -0.041339222341775894, -0.019369205459952354, -0.005728630349040031, 0.019026992842555046, 0.05543835833668709, 0.04254380613565445, 0.036383990198373795, 0.03255121409893036, -0.023475749418139458, -0.015728067606687546, -0.021655181422829628, 0.006584160961210728, 0.0025768571067601442, 0.04426855593919754, -0.0064370096661150455, 0.06428112089633942, -0.03698628395795822, 0.0028762926813215017, -0.010369026102125645, 0.059681788086891174, 0.024625582620501518, 0.01702847331762314, 0.09209612011909485, 0.011286155320703983, 0.004821768496185541, 0.0008863293332979083, 0.0022414892446249723, 0.00404494721442461, -0.03145613521337509, 0.033974818885326385, -0.015796510502696037, 0.02833516150712967, -0.0025255251675844193, 0.022585999220609665, 0.03537104278802872, -0.006365145090967417, 0.02032739855349064, -0.002350997179746628, -0.0033160352613776922, -0.007138544227927923, 0.017890848219394684, 0.00681686494499445, -0.007617641240358353, -0.01832887902855873, 0.016727326437830925, -0.018465764820575714, 0.006936639081686735, -0.016001837328076363, 0.009588782675564289, -0.009958372451364994, 0.007467067800462246, -0.0026675432454794645, -0.004767014645040035, -0.03537104278802872, 0.012819265015423298, -0.02239435911178589, -0.003100441535934806, -0.01967035047709942, -0.01568700186908245, -0.025816481560468674, 0.008883826434612274, 0.03178466111421585, -0.0138253690674901, -0.02948499470949173, -0.13754189014434814, -0.03591858223080635, -0.035973336547613144, -0.0019249430624768138, -0.02162780426442623, -0.009944683872163296, 0.013455779291689396, -0.03537104278802872, -0.007378092966973782, -0.0030645092483609915, 0.005300865508615971, -0.01883535459637642, -0.012791887857019901, -0.001735870842821896, 0.008247311227023602, 0.014112826436758041, 0.002183313248679042, 0.0024245725944638252, -0.011087671853601933, 0.017863471060991287, -0.000492357648909092, -0.01609765738248825, 0.024981483817100525, 0.03857414796948433, -0.025624841451644897, 0.022585999220609665, -0.03104548156261444, -0.008699031546711922, 0.017398063093423843, -0.022339604794979095, 0.013407870195806026, -0.02023157849907875, -0.002614500466734171, -0.0003864858008455485, -0.025748038664460182, -0.024146486073732376, -0.00765870651230216, -0.004992874339222908, -0.016960032284259796, 0.003637714544311166, -0.017617078498005867, -0.0056362333707511425, 0.02989564836025238, -0.028472047299146652, -0.01709691621363163, -0.005667032208293676, -0.01865740306675434, 0.018383633345365524, -0.03805398568511009, -0.015057331882417202, 0.006560205947607756, 0.005417217500507832, 0.0014184691244736314, -0.032496459782123566, -0.03255121409893036, -0.019437646493315697, -0.012086931616067886, -0.02064223401248455, 0.01502995565533638, 0.016289295628666878, 0.016398804262280464, -0.0049346983432769775, -0.005454860627651215, 0.03411170095205307, 0.005680720787495375, 0.011963735334575176, -0.00043289829045534134, -0.006532828789204359, -0.02428337000310421, 0.028389915823936462, -0.037451691925525665, -0.04807395488023758, -0.018301503732800484, 0.016891589388251305, 0.007864033803343773, -0.015878641977906227, 0.007439691107720137, -0.02279132604598999, 0.02180575393140316, -0.010252674110233784, 0.00043097336310893297, 0.023407308384776115, -0.01470143161714077, 0.02024526707828045, 0.02567959576845169, -0.014071761630475521, -0.02346206083893776, -0.05308394134044647, 0.010512755252420902, -0.03955971822142601, -0.04112020507454872, 0.018944861367344856, -0.012531806714832783, -0.001209719805046916, -0.014044384472072124, 0.0026795207522809505, 0.017315931618213654, 0.01085496786981821, -0.009711978957057, -0.023831650614738464, 0.00250841467641294, -0.03690415248274803, 0.0198209248483181, -0.033646292984485626, 0.005437750369310379, 0.03156564384698868, 0.0198346134275198, -0.011874759569764137, -0.004962075501680374, 0.011751563288271427, -0.02247649058699608, 0.00033109021023847163, -0.010793369263410568, 0.013483156450092793, 0.016494622454047203, 0.007295961957424879, -0.03690415248274803, 0.011457260698080063, -0.016056591644883156, 0.0029019585344940424, 0.011594145558774471, -0.001596419489942491, -0.01735699735581875, -0.05229000747203827, -0.011546236462891102, 0.02915647067129612, 0.019355516880750656, 0.03619235008955002, -0.006898995954543352, 0.010759148746728897, -0.038519393652677536, 0.020423218607902527, 0.005033940076828003, -0.014194957911968231, -0.0008414139738306403, -0.022024771198630333, -0.0007122289389371872, 0.007343871518969536, 0.035042520612478256, 0.026802051812410355, 0.02113501913845539, -0.0017846360569819808, -0.004287917632609606, -0.030497942119836807, -0.007699772249907255, 0.01965666376054287, -0.003572694258764386, 0.0009693157626315951, -0.004270806908607483, -0.0016255074879154563, -0.03561743348836899, 0.0016674284124746919, 0.03479612618684769, -0.004048368893563747, 0.0004087295674253255, -0.05543835833668709, -0.028964832425117493, 0.014496104791760445, 0.02195632830262184, 0.021928951144218445, 0.008226778358221054, 0.034577108919620514, -0.0011498326202854514, 0.0011823427630588412, -0.023516815155744553, 0.017206424847245216, -0.03235957771539688, 0.01148463785648346, 0.0062111495062708855, -0.006840819958597422, 0.04837510362267494, 0.00024147340445779264, -0.04993559047579765, -0.05152345448732376, 0.03780759125947952, -0.00825415551662445, -0.011669432744383812, -0.008753785863518715, -0.020751740783452988, -0.012141685001552105, 0.0017880582017824054, 0.04013463482260704, -0.004359782207757235, 0.004086012486368418, 0.008521080948412418, -0.025542711839079857, -0.023571569472551346, -0.024652959778904915, 0.012867175042629242, -0.003740378189831972, 0.006796332076191902, -0.0011780651984736323, -0.04177725315093994, -0.06953749805688858, -0.002037873025983572, -0.017206424847245216, -0.014728808775544167, 0.008480016142129898, -0.01585126481950283, 0.00644043181091547, 0.03509727120399475, -0.015166840516030788, 0.018616337329149246, 0.031675152480602264, 0.0034854302648454905, 0.023763207718729973, -0.018876418471336365, 0.013182009570300579, -0.019629286602139473, -0.027869753539562225, 0.004024414345622063, -0.015413233079016209, -0.01061541959643364, 0.016795769333839417, -0.02098444662988186, -0.04057266563177109, 0.052892301231622696, 0.017658144235610962, -0.0284994225949049, 0.001595563953742385, 0.05193410813808441, 0.009150751866400242, 0.012408610433340073, -0.028143523260951042, 0.013106723316013813, -0.009520340710878372, -0.0021696246694773436, 0.004465867765247822, -0.014742497354745865, 0.012285414151847363, 0.017726587131619453, -0.01619347557425499, -0.0023270421661436558, -0.00035183681757189333, 0.014838316477835178, 0.019588220864534378, 0.033317770808935165, 0.008288376964628696, 0.007905099540948868, -0.014728808775544167, 0.0016289296327158809, 0.03575431928038597, 0.014934135600924492, 0.0038156649097800255, -0.03433071821928024, -0.006327501498162746, 0.02592598833143711, 0.05461705103516579, -0.01750757172703743, -0.0027873176150023937, 0.011744718998670578, -0.005725208204239607, 0.04905952513217926, 0.031100235879421234, -0.030278926715254784, -0.010546976700425148, -0.017617078498005867, -0.018712157383561134, 0.00741231394931674, -0.014728808775544167, 0.00704272510483861, -0.026062874123454094, -0.021504608914256096, -0.011888448148965836, 0.014728808775544167, -0.04681461676955223, 0.0169326551258564, 0.0034135656896978617, -0.006330923642963171, 0.005444594658911228, -0.12735764682292938, -0.011669432744383812, 0.011703654192388058, 0.004000459332019091, 0.013435247354209423, -0.01760338991880417, 0.008445794694125652, 0.004089434631168842, -0.002670965390279889, -0.014660365879535675, 0.013448935002088547, -0.024748777970671654, 0.0029070917516946793, -0.03189416602253914, -0.008856449276208878, -0.06920897215604782, -0.023995911702513695, -0.02139510028064251, -0.00501682935282588, -0.018520519137382507, 0.004571953788399696, -0.004281073343008757, -0.024146486073732376, 0.00858952384442091, 0.005947646219283342, -0.006378833670169115, -0.02239435911178589, -0.00032745421049185097, 0.011573612689971924, 0.013154633343219757, -0.009691447019577026, 0.018588962033391, -0.020053628832101822, 0.0437757708132267, -0.041503481566905975, 0.019601909443736076, -0.017288554459810257, -0.015372167341411114, 0.020519036799669266, 0.0072138309478759766, 0.030853843316435814, -0.028472047299146652, 0.029046962037682533, 0.022900832816958427, 0.04185938462615013, -0.01676839217543602, 0.01470143161714077, 0.01292192842811346, -0.017781341448426247, -0.009848863817751408, 0.028608931228518486, 0.032660722732543945, -0.002311642747372389, 0.020464284345507622, -0.008692187257111073, 0.005119492765516043, 0.00019217348017264158, -0.011026074178516865, -0.009013867005705833, 0.04407691955566406, 0.010006281547248363, 0.029950402677059174, 0.007932476699352264, -0.00033451232593506575, -0.06318604201078415, -0.016782080754637718, 0.015481675043702126, -0.0013226497685536742, -0.0006865630275569856, -0.03454973176121712, -0.020108383148908615, 0.024406567215919495, 0.011642055585980415, 0.01263447105884552, 0.016549376770853996, 0.021244527772068977, -0.010341649875044823, 0.023571569472551346, -0.06827815622091293, 0.004606174770742655, 0.04717051610350609, -0.042735446244478226, -0.0036924686282873154, -0.03747906908392906, 0.008541613817214966, 0.029183847829699516, 0.03652087599039078, -0.007124855648726225, -0.012791887857019901, 0.023831650614738464, 0.02923860214650631, -0.020874937996268272, 0.010143166407942772, -0.01626191847026348, -0.03501514345407486, -0.020916003733873367, -0.01642618142068386, -0.002111448673531413, 0.0014903336996212602, 0.006936639081686735, 0.052399516105651855, 0.033892687410116196, -0.012976682744920254, -0.041257090866565704, 0.02180575393140316, 0.0035863828379660845, 0.0027291413862258196, -0.028061391785740852, 0.021080264821648598, 0.013661107048392296, 0.036383990198373795, 0.028034014627337456, 0.02544689178466797, 0.021354034543037415, -0.006289858371019363, 0.029539749026298523, 0.050428375601768494, -0.011758407577872276, 0.019779859110713005, -0.01255918387323618, 0.007234363816678524, 0.026637788861989975, -0.03660300746560097, 0.021463543176651, -0.03263334557414055, 0.006762111093848944, 0.01609765738248825, 0.009027555584907532, -0.0136337298899889, 0.01184738241136074, -0.024817220866680145, 0.033235639333724976, 0.00858952384442091, 0.007323339115828276, 0.0019848302472382784, 0.0084663275629282, -0.004551420919597149, 0.007104323245584965, -0.03096335008740425, 0.02387271635234356, 2.7016041713068262e-05, 0.033235639333724976, 0.023434683680534363, -0.004708838649094105, 0.006775799673050642, -0.003767755115404725, 0.009198660962283611, -0.00596817908808589, -0.0052632219158113, -0.009554562158882618, 0.028198277577757835, 8.929597242968157e-05, -0.01482462789863348, -0.0077271489426493645, 0.024078043177723885, 0.009944683872163296, -0.038437262177467346, -0.025624841451644897, 0.008753785863518715, 0.007029036525636911, -0.0020481394603848457, 0.024406567215919495, -0.019615598022937775, -0.00012971977412234992, 0.014359219931066036, -0.03594595938920975, -0.013524222187697887, -0.00023484305711463094, -0.024475010111927986, 0.019779859110713005, -0.006228260230273008, -0.014304465614259243, 0.029758764430880547, 0.03509727120399475, 0.057272616773843765, 0.042653314769268036, -0.007877722382545471, -0.016234541311860085, 0.010067880153656006, 0.04837510362267494, 0.0128055764362216, 0.0006703079561702907, -0.01457823533564806, 0.011915825307369232, 0.05127706006169319, -0.007350715808570385, -0.0018838775577023625, 0.03230482339859009, -0.002111448673531413, 0.03203105181455612, -0.013811680488288403, 0.022818703204393387, -0.030114663764834404, 0.02228485234081745, -0.025734350085258484, -0.01305196899920702, 0.01783609390258789, 0.014660365879535675, -0.021354034543037415, -0.008555302396416664, -0.04147610440850258, -0.0038943737745285034, -0.03482350334525108, 0.020382152870297432, -0.015604871325194836, -0.015207905322313309, -0.002705186605453491, 0.03569956496357918, -0.018588962033391, 0.019204942509531975, -0.016946343705058098, 0.036630384624004364, -0.025145744904875755, 0.03668513521552086, -0.006036621518433094, -0.03367367014288902, 0.02858155407011509, 0.0009376611560583115, -0.054972950369119644, -0.004852567333728075, -0.039942994713783264, -0.030443187803030014, -0.02659672498703003, -0.016795769333839417, -0.02411910891532898, 0.00953402929008007, -0.009280792437493801, 0.007905099540948868, -0.017206424847245216, 0.005064738914370537, -0.004599330481141806, -0.002232933882623911, 0.011265622451901436, -0.011594145558774471, -0.02444763295352459, -0.028691062703728676, -0.0040552131831645966, -0.01734330877661705, -0.027979260310530663, 0.019615598022937775, 0.0062967026606202126, -0.010642795823514462, -0.01350368931889534, -0.017548635601997375, 0.020094694569706917, -0.0033861887641251087, -0.01750757172703743, 0.032496459782123566, -0.002872870536521077, -0.008740097284317017, -0.009116530418395996, -0.005475393496453762, 0.02625451236963272, -0.022065836936235428, 0.0062967026606202126, 0.00431871647015214, 0.019177565351128578, 0.047197893261909485, 0.03214056044816971, 0.03830037638545036, -0.03758857771754265, 0.0004962075618095696, 0.004445335362106562, 0.0031842836178839207, 0.02065592259168625, -0.02940286323428154, -0.001964297378435731, 0.014742497354745865, 0.010546976700425148, -0.004034680780023336, -0.019451335072517395, -0.0031551956199109554, -0.01634404994547367, 0.0602840818464756, -0.009178128093481064, 0.0016896722372621298, 0.014372908510267735, -0.008972801268100739, 0.01123140100389719, 0.0077134608291089535, 0.0071522328071296215, -0.018397321924567223, -0.02023157849907875, -0.02717163972556591, 0.006433587521314621, -0.04440544173121452, -0.028964832425117493, 0.013736393302679062, 0.03567218780517578, -0.012860330753028393, 0.026117626577615738, 0.05130443722009659, 0.0042981840670108795, -0.004496667068451643, -0.027705490589141846, -0.013332583010196686, -0.003812242764979601, 0.03227744624018669, 0.01702847331762314, -0.051331814378499985, 0.024310747161507607, 0.019109124317765236, 0.00941083300858736, -0.01349684502929449, 0.04558265209197998, 0.011286155320703983, 0.01865740306675434, -0.05185197666287422, -0.02394115924835205, -0.005841560661792755, -0.009794110432267189, 0.03602809086441994, 0.027226394042372704, 0.014509793370962143, -0.006536250934004784, 0.0006733022746630013, 0.016905277967453003, 0.00098557083401829, 0.001404780661687255, -0.002949868328869343, 0.000817031366750598, 0.010136322118341923, -0.003124396549537778, -0.02013576030731201, 0.009862552396953106, -0.024338124319911003, 0.0012473630486056209, -0.025077302008867264, -0.002797583816573024, 0.00555410236120224, 0.014153892174363136, -0.013366804458200932, 0.006248793099075556, 0.01824674941599369, -0.026952624320983887, -0.024461321532726288, -0.021449854597449303, -0.0024365501012653112, -0.0024947260972112417, -0.008904358372092247, 0.011820006184279919, 0.005150292068719864, -0.018123552203178406, -0.007467067800462246, -0.010950786992907524, -0.002669254317879677, 0.001500600017607212, -0.016302984207868576, -0.007405469659715891, -0.027554918080568314, 0.07063257694244385, 0.011334064416587353, -0.0039046399760991335, -0.024844598025083542, -0.017110604792833328, 0.0072685847990214825, -0.006539673078805208, -0.026240823790431023, -0.0437483936548233, 0.008425261825323105, -0.008028295822441578, -0.003410143544897437, 0.016234541311860085, 0.026391396299004555, 0.022230098024010658, -0.02584385685622692, -0.006361722946166992, -0.0073301829397678375, 0.007206986658275127, 0.017233802005648613, 0.020683299750089645, -0.005824449937790632, -0.013791147619485855, -0.017534947022795677, -0.025159433484077454, 0.010458001866936684, 0.004777281079441309, 0.010334805585443974, 0.034467604011297226, 0.04112020507454872, 0.023434683680534363, -0.006745000369846821, -0.02379058487713337, 0.02014944888651371, 0.019971497356891632, -0.03194892033934593, 0.0024707713164389133, 0.043967410922050476, -0.02179206721484661, -0.01276451162993908, -0.019013304263353348, -0.012497586198151112, 0.01424971129745245, 0.006649181246757507, -0.010670172981917858, 0.008391040377318859, 0.021244527772068977, 0.015810199081897736, 0.009766733273863792, 0.0076107969507575035, 0.013941721059381962, -0.0033468343317508698, 0.01743912883102894, -0.007850345224142075, 0.028389915823936462, -0.02468033693730831, -0.0010617130901664495, 0.0115599250420928, 0.02500886097550392, 0.012463364750146866, -0.04651346802711487, -0.015481675043702126, -0.02361263521015644, -0.004127077758312225, 0.001108767231926322, -0.032332200556993484, 0.00464724050834775, 0.007994074374437332, -0.004383736755698919, 0.037533823400735855, -0.013797991909086704, 0.024652959778904915, 0.0009727379074320197, -0.008226778358221054, 0.027787622064352036, 0.024885663762688637, 0.013202542439103127, -0.014537169598042965, 0.03345465287566185, 0.03723267465829849, 0.001674272702075541, 0.011648899875581264, -0.001741004060022533, 0.010882345028221607, 0.008411573246121407, 0.021449854597449303, 0.03452235460281372, -0.017521260306239128, 0.004715682473033667, 0.024721402674913406, 0.0062727476470172405, -0.003713001264259219, 0.018055111169815063, 0.005584901198744774, 0.004127077758312225, -0.008986489847302437, 0.012607093900442123, -0.02164149284362793, 0.02121715061366558, -0.02791081927716732, -0.011799473315477371, -0.02220272086560726, 0.008788006380200386, 0.024146486073732376, 0.0035966490395367146, 0.02500886097550392, -0.049333296716213226, -0.02610393799841404, 0.008370507508516312, 0.006721045821905136, 0.005027095787227154, -0.009198660962283611, -0.02195632830262184, -0.019861990585923195, -0.041667744517326355, 0.009814643301069736, -0.01675470359623432, 0.040682174265384674, -0.02238067053258419, -0.014236023649573326, 0.0338653102517128, 0.02478984370827675, 0.004339249338954687, -0.0004046657995786518, -0.03186678886413574, -0.0181646179407835, -0.03649349883198738, -0.008753785863518715, 0.00025430636014789343, -0.008151492103934288, -0.012518118135631084, -0.006519140675663948, -0.010718083009123802, 0.004178409930318594, 0.00991046242415905, 0.03211318328976631, 0.025898611173033714, -0.02205214835703373, -0.016138723120093346, -0.00018778888625092804, 0.005670454353094101, 0.02088862657546997, -0.0115599250420928, -0.007905099540948868, -0.008480016142129898, 0.007056413218379021, -0.005273488350212574, 0.022900832816958427, 0.04246167838573456, 0.03643874451518059, -0.00543090607970953, 0.008192557841539383, 0.0012747400905936956, -0.007562887389212847, -0.018479453399777412, -0.0014201801968738437, 0.008322598412632942, -0.004924431908875704, 0.03657563030719757, 0.02421492710709572, -0.009315012954175472, -0.01601552590727806, -0.012702913023531437, 0.02997777983546257, 0.04120233654975891, -0.019684039056301117, -0.0005749163101427257, 0.009513496421277523, 0.05070214346051216, -0.008103582076728344, 0.020833872258663177, 0.002044717315584421, 0.024242304265499115, 0.006984549108892679, -0.0322226919233799, -0.01749388314783573, -0.02213427796959877, 0.02618606947362423, -0.011991111561655998, 0.03287973999977112, 0.019273385405540466, -0.005287176929414272, 0.038765788078308105, 0.021655181422829628, 0.01123140100389719, -0.01635773852467537, 0.005951068364083767, 0.003309190971776843, -0.029621878638863564, 0.007686083670705557, 0.02707582153379917, 0.007282273378223181, -0.015632249414920807, 0.011997955851256847, 0.02121715061366558, 0.03816349431872368, 0.026733608916401863, 0.028362538665533066, -0.012326479889452457, 0.04807395488023758, -0.008076205849647522, -0.01312725618481636, 0.02650090493261814, -0.008445794694125652, -0.0020515616051852703, 0.02948499470949173, -0.030415810644626617, -0.021614115685224533, 0.00472594890743494, 0.010512755252420902, 0.01824674941599369, 0.011162959039211273, 0.01412651501595974, 0.011772096157073975, 0.029265979304909706, -0.025310005992650986, -0.0008666521171107888, -0.0006352312047965825, -0.005047628656029701, -0.020957069471478462, -0.00033301513758488, 0.0003141934867016971, 0.015714379027485847, -0.0023270421661436558, -0.02098444662988186, -0.006546517368406057, 0.030607450753450394, 0.0056362333707511425, -0.00358296069316566, 0.008062517270445824, -0.009958372451364994, 0.0169189665466547, 0.014810939319431782, -0.02154567278921604, 0.02617238089442253, -0.01531741302460432, 0.01531741302460432, 0.007590264547616243, 0.02254493348300457, 0.0024605048820376396, -0.024748777970671654, 0.006057153921574354, 0.009766733273863792, 0.02303771860897541, 0.007138544227927923, 0.04990821331739426, 0.0016391959507018328, 0.030032534152269363, -0.028061391785740852, 0.005150292068719864, -0.016563065350055695, 0.03145613521337509, 0.008904358372092247, -0.046130191534757614, 0.004787547048181295, -0.039094310253858566, 0.008794850669801235, -0.016645196825265884, 0.03942283242940903, 0.025323694571852684, 0.018561584874987602, -0.03693152964115143, -0.0015023110900074244, 0.022312229499220848, 0.016220852732658386, 0.03652087599039078, -0.03682202100753784, -0.005543835926800966, -0.015563806518912315, -0.03394744172692299, -0.016138723120093346, 0.003040554467588663, -0.017726587131619453, 0.013305206783115864, -0.005687565077096224, 0.02179206721484661, -0.0075491988100111485, -0.02039584144949913, 0.007343871518969536, 0.02428337000310421, 0.022325918078422546, -0.026035496965050697, -0.002092626877129078, 0.01090287696570158, 0.006002400070428848, -0.0013645706931129098, -0.026240823790431023, -0.002185024321079254, 0.011340908706188202, 0.038847915828228, 0.024420255795121193, 0.0008965957094915211, 0.015974460169672966, -0.03416645526885986, 0.009267103858292103, 0.01494782418012619, 0.003979926463216543, -0.016056591644883156, -0.030935972929000854, 0.006987971253693104, -0.025132056325674057, -0.04202364385128021, -0.012826109305024147, 0.014181269332766533, 0.019533466547727585, 0.02328411117196083, 0.021668870002031326, 0.019040681421756744, -0.007829812355339527, -0.006060576066374779, -0.007439691107720137, 0.0036411366891115904, 0.01110136043280363, 0.024967795237898827, 0.016220852732658386, 0.007186454255133867, 0.014591923914849758, 0.003079908899962902, -0.024762466549873352, 0.02214796654880047, -0.00958193838596344, 0.03131924942135811, 0.018876418471336365, 0.00014886226563248783, 0.02907433919608593, -0.005003140773624182, -0.008548458106815815, 0.0025717238895595074, 0.009848863817751408, 0.024721402674913406, 0.02825303003191948, -0.018356256186962128, 0.03104548156261444, 0.00584498280659318, -0.0014920447720214725, -0.003363944822922349, 0.005270066205412149, 0.04007988050580025, 0.042324792593717575, -0.016289295628666878, -0.022079523652791977, -0.0007006792584434152, -0.021408788859844208, -0.019136499613523483, -0.0055883233435451984, 0.009260259568691254, -0.029046962037682533, 0.005068161059170961, -0.028389915823936462, 0.01085496786981821, 0.04804657772183418, 0.017795028164982796, 0.023393619805574417, -0.014359219931066036, 0.0029977778904139996, 0.00920550525188446, 0.004366626497358084, 0.0011746430536732078, -0.005249533802270889, -0.014797250740230083, -0.0005689276149496436, -0.01990305632352829, 0.012942461296916008, 0.04196889325976372, 0.024502385407686234, 0.005827872082591057, -0.01399647444486618, 0.006690246518701315, 0.004907321650534868, 0.005211890209466219, -0.029046962037682533, 0.023817962035536766, 0.00850739236921072, -0.009424521587789059, -0.00532824220135808, -0.008315754123032093, -0.03958709537982941, -0.021833131089806557, 0.006101641803979874, -0.01279873214662075, 0.03238695114850998, -0.008979645557701588, 0.01741175167262554, 0.008849604986608028, -0.014715120196342468, -0.0026914982590824366, 0.007309650536626577, 0.014961512759327888, -0.021326657384634018]",Online Speculative Decoding.pdf
"-
tion answering given context. For online chatting, we utilize
datasets from ShareGPT [ 2], Chatbot Arena [ 44]. For text-to-
SQL, we use the spider [ 42] dataset. For summarization and
9
Task Dataset SD Method Draft Model (TP) Target Model (TP) Hardware (Total Mem.)
Online ChattingArena[44]
VSD[20]Llama-160M(1) Vicuna-7B(1) A100 (80G)
Llama-160M(1) Vicuna-33B(4) 4√óA100 (320G)
TinyLlama-1.1B (1) Llama2-70B (8) 8√óA100 (640G)
ShareGPT[2]Llama-160M(1) Vicuna-7B(1) A100 (80G)
Llama-160M(1) Vicuna-33B(4) 4√óA100 (320G)
TinyLlama-1.1B (1) Llama2-70B (8) 8√óA100 (640G)
Tex-to-SQL Spider[42]Llama-160M(1) Vicuna-7B(1) A100 (80G)
Llama-160M(1) Vicuna-33B(4) 4√óA100 (320G)
Summarization CNN/Daily Mail[12, 34]
PTL[33] NoneMistral-7B (1) A100 (80G)
Mixture-8√ó7B (8) 8√óA100 (640G)
Context QA HAGRID[16]Mistral-7B (1) A100 (80G)
Mixture-8√ó7B(8) 8√óA100 (640G)
Table 1. Dataset, model and server configuration. VSD: Vanilla speculative decoding. PTL: Prompt lookup decoding.
0 500 1000 1500 2000 2500 3000
Input Length104
103
102
DensityDataset
Arena (Avg=31.34, Std=66.0)
ShareGPT (Avg=303.48, Std=349.28)
Spider (Avg=32.86, Std=5.44)
CNN (Avg=989.5, Std=459.41)
HAGRID (Avg=481.76, Std=394.16)
0 100 200 300 400 500
Output Length103
102
101
DensityDataset
Arena (Avg=359.34, Std=170.51)
ShareGPT (Avg=307.29, Std=205.97)
Spider (Avg=39.91, Std=27.88)
CNN (Avg=77.15, Std=29.43)
HAGRID (Avg=128.0, Std=0.0)
Figure 10. Input/Output length distributions.
question answering, we use the original dataset CNN/Daily
Mail [ 34] and HAGRID [ 16] from the prompt lookup decod-
ing work. We show the workload characteristics (average
input length and average output length) in Fig. 10. For online
chatting, the input is of medium length while the output
length is longer and show higher variance. For summariza-
tion and question answering, the input length is long and the
output is short. For the question answering, since we do not
have the ground truth in the dataset, we set a fixed output
length 128. For all workloads, we generate request arrival
times using Poisson distribution with different request rates.
We use greedy sampling for all served requests.
7.1 Latency Measurement
We first evaluate the effectiveness of SmartSpec in reducing
request latency for both draft model-based and draft model-
free speculative decoding.
7.1.1 Draft-model based speculative decoding. We eval-
uated the average request latency across different datasets,
focusing on the performance of SmartSpec in comparison to
baseline strategies in Figs. 11 and 12. In environments with
a low request rate, SmartSpec demonstrates performance
similar to that from greedily predicting a higher number of
tokens (e.g., ùëò=3or5) to maximize speedup. This similarity
suggests that SmartSpec predicts just enough tokens under
light loads to effectively reduce request latency through spec-
ulative decoding. However, on a few occasions when requestrates are low, there are slight performance differences be-
tween SmartSpec and standard SD. In those cases, standard
SD, which predicts a higher number of tokens, marginally
outperforms SmartSpec with a more pronounced speedup.
This discrepancy can be","[0.02909194491803646, 0.0179433636367321, 0.049990180879831314, -0.01675855927169323, -0.014153416268527508, 0.004036186262965202, 0.009778205305337906, 0.02870652638375759, 0.015231160447001457, -0.010977284051477909, 0.009578358381986618, 0.0015015254030004144, -0.051560401916503906, 0.018614275380969048, 0.02025587297976017, -0.012711666524410248, 0.011269916780292988, -0.01376086100935936, -0.026194170117378235, 0.02037006989121437, 0.010663239285349846, -0.0016407042276114225, -0.012090714648365974, 0.006052494514733553, 0.015359632670879364, -0.025894399732351303, 0.0032439373899251223, 0.03671466186642647, 0.059668462723493576, -0.05864068120718002, -0.01558802928775549, -0.0273646991699934, -0.023967308923602104, -0.024195704609155655, 0.013396854512393475, 0.042567308992147446, -0.007058864925056696, 0.005003300495445728, -0.0084577901288867, -0.0067091332748532295, -0.02325357124209404, -0.025551805272698402, -0.06680583953857422, 0.016744283959269524, 0.02041289582848549, 0.03440215066075325, -0.008472065441310406, -0.004917651880532503, 0.0051389108411967754, 0.0538158155977726, -0.07006048411130905, 0.022768229246139526, -0.016016270965337753, 0.011826631613075733, 0.009928089566528797, -0.02129792980849743, -0.021740447729825974, 0.026194170117378235, 0.02518066205084324, -0.009421336464583874, 0.014702994376420975, -0.021669073030352592, -0.010955872014164925, -1.7271891920245253e-05, -0.009585496038198471, -0.008921720087528229, -0.019899003207683563, 0.04059739410877228, -0.022811053320765495, 0.025765927508473396, -0.011755257844924927, 0.004671412520110607, 0.029263241216540337, -0.059211671352386475, -0.014610208570957184, 0.02114090695977211, 0.025580355897545815, 0.053644515573978424, -0.010563315823674202, -0.0010438412427902222, -0.0014274751301854849, 0.018856946378946304, -0.006477168761193752, -0.04964758828282356, -0.01547383051365614, -0.02302517369389534, -0.004271719604730606, 0.011576823890209198, -0.027878589928150177, -0.03106185980141163, -0.05307352542877197, 0.02263975702226162, -0.038998622447252274, -0.010477667674422264, 0.03848472982645035, -0.008443515747785568, 0.020241597667336464, -0.02420997805893421, 0.027535995468497276, 0.04636439308524132, 0.049761783331632614, 0.015844974666833878, 0.02706492878496647, -0.029605835676193237, 0.05704190954566002, -0.021883195266127586, -0.032118190079927444, 0.020241597667336464, -0.016972679644823074, -0.00866477470844984, -0.09232909232378006, -0.0456506572663784, -0.09798189252614975, 0.0023357062600553036, -0.003202897496521473, -0.02041289582848549, -0.06389378756284714, -0.030148275196552277, -0.00985671579837799, 0.01648733764886856, -0.002521278103813529, 0.034230854362249374, 0.0345163494348526, -0.015730775892734528, -0.006544973701238632, 0.014446048997342587, 0.013746585696935654, -0.1189943328499794, 0.0034419994335621595, -0.006933960597962141, 0.005695626139640808, 0.01137697696685791, 0.06012525409460068, -0.036771759390830994, 0.0013409345410764217, -0.0014649464283138514, -0.04893384873867035, -0.015359632670879364, -0.03582962602376938, 0.018657101318240166, -0.018314506858587265, -0.01162678562104702, -0.01032064575701952, 0.030576517805457115, -0.04236746206879616, 0.0034812551457434893, -0.0220259428024292, -0.01420337799936533, -0.05470084771513939, 0.04493691772222519, -0.032232388854026794, -0.005046124570071697, -0.033003225922584534, -0.005906178615987301, -0.007123101036995649, -0.0198704544454813, -0.02529486082494259, 0.019542135298252106, -0.007344359531998634, -0.04839140921831131, -0.019113892689347267, -0.0023589027114212513, 0.0032189565245062113, -0.013653799891471863, -0.011733845807611942, 0.03771389275789261, -0.02613707073032856, -0.008072372525930405, -0.08125188946723938, -0.05350176990032196, 0.015545204281806946, 0.008336454629898071, -0.012354797683656216, -0.013639525510370731, -0.021326478570699692, -0.03097621165215969, -0.018742749467492104, -0.040454644709825516, 0.025623179972171783, -0.03648626431822777, -0.05681351199746132, 0.0492764413356781, -0.004550077021121979, -0.006280890665948391, -0.0277072936296463, -0.059782661497592926, -0.028192633762955666, 0.02459539659321308, -0.0021037415135651827, 0.003864889033138752, 0.01909961737692356, 0.050989411771297455, 0.026965005323290825, -0.01168388407677412, -0.019199540838599205, -0.03794229030609131, 0.04490836709737778, 0.023781735450029373, -0.023382043465971947, 0.01398925669491291, 0.010563315823674202, 0.04704958200454712, -0.003549060085788369, -0.03851328045129776, 0.004471566062420607, -0.008215120062232018, 0.023781735450029373, 0.012219187803566456, -0.0097068315371871, -0.01653016172349453, 0.03483039513230324, -0.004496546927839518, 0.07137376070022583, -0.011983654461801052, -0.020070301368832588, 0.012947199866175652, -0.039912205189466476, 0.011676747351884842, -0.006730545312166214, 0.03628641739487648, 0.0031065428629517555, 0.03720000386238098, 0.02479524351656437, 0.02952018566429615, -0.03485894203186035, 0.06355119496583939, 0.0017968344036489725, 0.01184090692549944, 0.01560230366885662, -0.036143671721220016, 0.03494459390640259, 0.002619416918605566, -0.023853110149502754, -0.004225326701998711, 0.011034383438527584, -0.0303195733577013, 0.00023307993251364678, -0.01568795181810856, -0.00928572565317154, -0.06023945286870003, 0.016730008646845818, 0.009407061152160168, 0.036571912467479706, 0.02271112985908985, -0.011091481894254684, 0.01268311683088541, -0.04873400181531906, -0.0790250226855278, 0.03074781596660614, 0.028535228222608566, -0.0030191100668162107, -0.051217809319496155, -0.012019340880215168, -0.021583424881100655, -0.04182502254843712, 0.010656102560460567, -0.042995553463697433, 0.009392786771059036, -0.03654336556792259, -0.006905411370098591, 0.012076440267264843, -0.026622412726283073, -0.0032885458786040545, 0.04607889801263809, -0.03420230373740196, -0.027036380022764206, 0.009121566079556942, 0.0038327707443386316, -0.008086646907031536, -0.057898394763469696, -0.012890100479125977, 0.004225326701998711, -0.002485591219738126, 0.015702227130532265, -0.029805680736899376, -0.02318219654262066, 0.003192191245034337, -0.025823025032877922, -0.04662133753299713, -0.0024731007870286703, -0.0015309670707210898, -0.029891330748796463, 0.03274628147482872, 0.03317452222108841, 0.013882196508347988, 0.036457717418670654, 0.03954106196761131, -0.00984244141727686, 0.019784806296229362, -0.005217421799898148, 0.033460017293691635, -0.025280585512518883, 0.01543100643903017, -0.0358867272734642, 0.03254643455147743, 0.006859018001705408, 0.018285956233739853, 0.01285441406071186, -0.020170224830508232, -0.05090376362204552, 0.05330192297697067, 0.005178166087716818, 0.03762824460864067, -0.007587030529975891, 0.016201842576265335, 0.024124329909682274, -0.02018449828028679, 0.006023945286870003, -0.015145511366426945, -0.029777131974697113, -0.005206715781241655, 0.037456948310136795, -0.025551805272698402, -0.016972679644823074, -0.02382456138730049, -0.05318772420287132, 0.052445437759160995, -0.024152880534529686, 0.04593615233898163, -0.04153952747583389, -0.008307905867695808, -0.019941827282309532, -0.018114659935235977, 0.016387414187192917, 0.005945433862507343, -0.03817068785429001, 0.00815088301897049, 0.009135841391980648, -0.004278856795281172, -0.017729241400957108, -0.001248148619197309, 0.04436592757701874, 0.019841905683279037, 0.013639525510370731, 0.009771067649126053, -0.042909905314445496, -0.05669931322336197, -0.004789179190993309, 0.0060061016120016575, 0.023581890389323235, -0.08005280792713165, -0.005877628922462463, -0.018357330933213234, -0.03365986421704292, 0.009421336464583874, 0.007087414152920246, 0.03648626431822777, 0.0397409088909626, 0.07782594859600067, 0.017515121027827263, -0.006384382490068674, -0.017158251255750656, 0.052673835307359695, -0.05070391669869423, 0.01412486657500267, -0.022896701470017433, 0.01503131352365017, -0.06503576785326004, -0.03748549893498421, -0.00959263276308775, 0.002376746153458953, 0.017472296953201294, 0.01887122169137001, 0.008807522244751453, 0.02329639531672001, 0.012790177948772907, -0.018471527844667435, -0.00801527313888073, 0.0016853128327056766, -0.047991715371608734, 0.011134305968880653, 0.06395088881254196, -0.025780200958251953, -0.007280123420059681, -0.04516531527042389, -0.01189800538122654, -0.018328780308365822, 0.07000338286161423, -0.028192633762955666, 0.04470852389931679, 0.0031047584488987923, -0.003484823741018772, -0.015559479594230652, -0.05124635994434357, 0.03971235826611519, 0.038256336003541946, 0.023125097155570984, 0.003657905152067542, -0.06680583953857422, -0.031147507950663567, -0.023510515689849854, -0.0009305353742092848, 0.009649732150137424, -0.0007686061435379088, 0.00464286282658577, 0.0340595580637455, -0.0025409057270735502, 0.021269379183650017, 0.025337684899568558, 0.03925556689500809, 0.037685345858335495, -0.025765927508473396, -0.023153647780418396, -0.041568078100681305, -0.008472065441310406, 0.014802917838096619, 0.013489640317857265, 0.0009162606438621879, 0.032574985176324844, -0.015902074053883553, 0.04596469923853874, -0.053673066198825836, 0.028620876371860504, -0.020155949518084526, 0.00422889506444335, -0.025494705885648727, 0.015816424041986465, 0.046335842460393906, 0.05447245389223099, 0.0885605588555336, -0.005713469348847866, -0.04961903765797615, -0.033145975321531296, -0.005317344795912504, -0.06475027650594711, 0.0052923643961548805, 0.021669073030352592, 0.0038184961304068565, 0.026922181248664856, -0.041910670697689056, -0.02048426866531372, 0.019313739612698555, 0.06475027650594711, -0.035030242055654526, -0.04396623373031616, 0.009157253429293633, 0.034230854362249374, 0.022511282935738564, -0.014945665374398232, -0.03326017037034035, -0.03751404583454132, -0.0049890256486833096, -0.028007062152028084, 0.03308887407183647, -0.01821458339691162, 0.001544349710457027, 0.005674213636666536, 0.02048426866531372, 0.013389716856181622, -0.027122028172016144, 0.024952266365289688, -0.033145975321531296, 0.021326478570699692, 0.009999463334679604, -0.026850808411836624, -0.05681351199746132, 0.06663454324007034, -0.0022072335705161095, 0.03965526074171066, -0.010499079711735249, 0.03936976566910744, 0.014417499303817749, -0.013653799891471863, -0.020541368052363396, -0.018314506858587265, -0.011469762772321701, 0.03320307284593582, 0.027107752859592438, 0.02432417683303356, 0.04342379420995712, 0.009635457769036293, -0.03682886064052582, 0.008393554016947746, -0.006926823407411575, 0.011362702585756779, 0.0036436303053051233, 0.04919079318642616, -0.003504451597109437, 0.033802613615989685, -0.03959815949201584, 0.0202130489051342, -0.027050655335187912, 0.04742072522640228, 0.021968843415379524, 0.027279051020741463, 0.07736915349960327, 0.04913369566202164, -0.0005437788204289973, 0.0050818114541471004, -0.04704958200454712, -0.01702977903187275, -0.042024869471788406, 0.04562210664153099, -0.0177149660885334, 0.020955335348844528, 0.028078436851501465, 0.015630852431058884, 0.006826899945735931, -0.007144513074308634, -0.003429509000852704, 0.01145548839122057, -0.015345358289778233, -0.00636297045275569, 0.013653799891471863, -0.01641596481204033, -0.02986278012394905, -0.005799117963761091, -0.002796066924929619, -0.013325480744242668, 0.016430240124464035, 0.0026319073513150215, 0.01791481301188469, -0.001052762963809073, 0.01971343159675598, -0.014945665374398232, 0.013653799891471863, -0.026079971343278885, -0.01871419884264469, -0.018228858709335327, -0.0055314661003649235, -0.01821458339691162, -0.004050460644066334, -0.006141711957752705, 0.0006749281310476363, 0.0059811207465827465, -0.04282425343990326, -0.017886264249682426, -0.1403493583202362, -0.04419463127851486, -0.02086968719959259, -0.0024088644422590733, -0.03408810868859291, -0.006698427256196737, 0.028349656611680984, -0.04796316474676132, 0.0011464409762993455, -0.002469531958922744, -0.0015291827730834484, -0.03086201287806034, -0.015859249979257584, -0.009135841391980648, 0.00818657036870718, -0.0022161551751196384, 0.00409328518435359, 0.013496777974069118, -0.008329317905008793, 0.012433309108018875, -0.011434076353907585, -0.02359616383910179, 0.008793246932327747, 0.05530038848519325, -0.033345818519592285, 0.034002456814050674, -0.028106985613703728, -0.0009260745136998594, 0.02059846743941307, -0.005110361147671938, 0.0017281371401622891, -0.01245472114533186, -0.019270915538072586, 0.006819762755185366, -0.018956869840621948, -0.019328013062477112, -0.010734613053500652, -0.02302517369389534, -0.00505326222628355, -0.004057598300278187, -0.015302534215152264, -0.004186070989817381, 0.025194937363266945, -0.02786431461572647, -0.0014096316881477833, 0.010292096063494682, -0.03805648908019066, 0.0022268611937761307, -0.016273217275738716, -0.014874291606247425, -0.008579125627875328, -0.019285188987851143, -0.0037435535341501236, -0.01757221855223179, -0.01768641732633114, -0.007112395018339157, -0.0032689182553440332, -0.0342879518866539, 0.015388182364404202, 0.02298234961926937, 0.007951037026941776, -0.02037006989121437, 0.008821796625852585, 0.04048319533467293, -0.005795549135655165, 0.001605909550562501, -0.00018010722124017775, -0.018457254394888878, -0.019927553832530975, 0.033574216067790985, -0.05295933037996292, -0.053872913122177124, -0.0005776813486590981, 0.017229625955224037, 0.0038434769958257675, -0.021997392177581787, -0.002674731658771634, -0.026151346042752266, 0.004025479778647423, -0.02382456138730049, 0.001279374584555626, 0.0392841175198555, -0.015074137598276138, 0.023810286074876785, 0.012354797683656216, -0.00015356509538833052, -0.033688414841890335, -0.056213971227407455, 0.020427169278264046, -0.05038987472653389, -0.04562210664153099, 0.024552572518587112, -0.011983654461801052, 0.002317862818017602, -0.01714397594332695, 0.010135074146091938, 0.012868688441812992, 0.014089180156588554, 0.00979961734265089, -0.02697928063571453, -0.016187569126486778, -0.010613277554512024, 0.02002747729420662, -0.021883195266127586, 0.017286723479628563, 0.037228550761938095, 0.01607337035238743, -0.02048426866531372, 0.0077083660289645195, 0.00043493384146131575, 0.011555411852896214, 0.005238833837211132, -0.006263047456741333, 0.01306853536516428, 0.0336027666926384, -0.0030137570574879646, -0.04093998670578003, 0.023010900244116783, -0.01959923468530178, 0.0057598622515797615, 0.0009626535465940833, -0.00557429064065218, -0.01085594855248928, -0.027193402871489525, -0.022554107010364532, 0.042224716395139694, 0.0037399849388748407, 0.02191174402832985, -0.019899003207683563, 0.0018646394601091743, -0.042909905314445496, 0.009835303761065006, -0.003445568261668086, -0.015773599967360497, 0.005524328909814358, -0.01698695495724678, 0.004460860043764114, -0.004807022865861654, 0.03308887407183647, 0.03266063332557678, 0.016016270965337753, 0.01630176603794098, 0.0031172488816082478, -0.027735842391848564, 0.012911512516438961, 0.034230854362249374, -0.013197007589042187, 0.0005299501353874803, -0.007337222341448069, 0.012561781331896782, -0.03063361719250679, 0.016587261110544205, 0.030348122119903564, -0.03029102273285389, 0.009171527810394764, -0.06258051097393036, 0.005299501586705446, 0.009671144187450409, 0.006687721237540245, 0.028992021456360817, 0.020441444590687752, 0.01798618771135807, 0.007487107068300247, -0.004189639817923307, -0.008736148476600647, 0.014046356081962585, -0.02540905773639679, -0.003929125610738993, 0.016473064199090004, -0.01176239550113678, 0.05275948345661163, -0.010142210870981216, -0.02540905773639679, -0.045764852315187454, 0.018899770453572273, -0.0015702226664870977, -0.02863515168428421, -0.005924021825194359, -0.007929624989628792, -0.002460610354319215, -0.013268381357192993, 0.04847705736756325, -0.026222718879580498, 0.02079831250011921, 0.010056562721729279, -0.027949964627623558, -0.006994628347456455, -0.01595917157828808, 0.018343055620789528, -0.036229319870471954, -9.412414510734379e-05, -0.011341290548443794, -0.04196776822209358, -0.04151097685098648, -0.008300768211483955, -0.018514353781938553, -0.011198543012142181, 0.0015059863217175007, -0.031689949333667755, -0.009521258994936943, 0.00024891598150134087, -0.009785342030227184, 0.049676135182380676, 0.012361935339868069, 0.020327245816588402, 0.02802133746445179, -0.027464622631669044, 0.010656102560460567, -0.019556410610675812, -0.03508733958005905, 0.011112893931567669, -0.015616578049957752, -0.02609424665570259, 0.028892097994685173, -0.030119726434350014, -0.037685345858335495, 0.02886354736983776, 0.03166139870882034, -0.018699925392866135, -0.004625019617378712, 0.049875982105731964, 0.00135699356906116, -0.006163123995065689, -0.038256336003541946, 0.013946432620286942, -0.017586493864655495, 0.0015755756758153439, 0.011334152892231941, -0.009535534307360649, 0.011905143037438393, 0.014674444682896137, -0.0033688414841890335, 0.013910745270550251, 0.01821458339691162, 0.030605068430304527, 0.003238584380596876, 0.024952266365289688, 0.01193369273096323, -0.006020376458764076, -0.030547969043254852, -0.009742517955601215, 0.01814320869743824, 0.014503147453069687, 0.006098887883126736, -0.03528718650341034, -0.00409328518435359, 0.02245418354868889, 0.05892617627978325, 0.0011848043650388718, -0.01162678562104702, 0.02832110784947872, 0.005474367178976536, 0.04896239936351776, 0.0036347087007015944, -0.02379601076245308, -0.010384881868958473, -0.0020073868799954653, -0.026993555948138237, 0.028834998607635498, -0.018014736473560333, 0.01045625563710928, -0.028806449845433235, -0.01587352342903614, -0.0028745781164616346, 0.002223292598500848, -0.029691483825445175, -0.004667843692004681, 0.0220259428024292, -0.011041520163416862, 0.009499846957623959, -0.1435469090938568, -0.018057560548186302, 0.015316808596253395, -0.026936456561088562, 0.024952266365289688, -0.010327782481908798, 0.036657560616731644, 0.00810805894434452, 0.016587261110544205, -0.02725050039589405, 0.014631620608270168, -0.03231803700327873, -0.002912049414590001, -0.029605835676193237, -0.01737237349152565, -0.06400799006223679, -0.020469993352890015, -0.02906339429318905, 0.018086111173033714, -0.03354566544294357, -0.010984421707689762, -0.018200308084487915, -0.0247524194419384, 0.01648733764886856, 0.004903377033770084, -0.00918580312281847, -0.01630176603794098, 0.004657137673348188, 0.007465695030987263, -0.011691021732985973, -0.008564851246774197, 0.01229769829660654, -0.012154950760304928, 0.05869777873158455, -0.04205342009663582, -0.003004835220053792, -0.028963470831513405, -0.021426402032375336, 0.007965311408042908, 0.016787108033895493, 0.024952266365289688, -0.03594382479786873, 0.03240368515253067, 0.004828434903174639, 0.026965005323290825, -0.03171849995851517, 0.00924290157854557, -0.016901306807994843, -0.016044821590185165, -0.011805219575762749, 0.005906178615987301, 0.030605068430304527, 0.017386646941304207, 0.014531697146594524, -0.010791712440550327, -0.0064628939144313335, 0.016458788886666298, -0.0011955105001106858, 0.03562977910041809, 0.022696854546666145, -0.038256336003541946, 0.03965526074171066, 0.0014230143278837204, -0.01687275618314743, -0.04171082377433777, -0.028349656611680984, -0.006662740372121334, 0.012447583489120007, 3.1867268262431026e-05, -0.022554107010364532, -0.034145206212997437, 0.042881354689598083, 0.02920614182949066, 0.007290829438716173, 0.0004420712066348642, 0.04582195356488228, 0.006605641450732946, 0.036257870495319366, -0.061552729457616806, -0.014110592193901539, 0.04873400181531906, -0.04319540038704872, -0.022625481709837914, -0.01695840433239937, 0.008086646907031536, 0.0005049693281762302, 0.046221647411584854, -0.0036900232080370188, -0.007672679144889116, 0.036457717418670654, 0.04219616577029228, 0.005413699429482222, -0.005042556207627058, -0.026965005323290825, -0.041111286729574203, -0.00949271023273468, -0.02182609587907791, -0.012133538722991943, 0.01320414524525404, 0.014074904844164848, 0.04553645849227905, 0.005802686791867018, -0.018999693915247917, -0.0291775930672884, 0.016815656796097755, 0.011740983463823795, 0.00481416005641222, 0.0037150040734559298, 0.02352479100227356, 0.01137697696685791, 0.014931390061974525, 0.021854644641280174, 0.043994784355163574, -0.011833769269287586, -0.0014337203465402126, 0.027693018317222595, 0.040997087955474854, -0.008650499396026134, 0.02986278012394905, -0.025009365752339363, 0.01921381615102291, 0.03720000386238098, -0.027535995468497276, 0.02859232760965824, -0.030005527660250664, 0.016458788886666298, 0.01193369273096323, 0.020084574818611145, 0.0074942447245121, 0.010891635902225971, -0.01131987851113081, 0.04348089545965195, -0.0037328475154936314, 0.01914244145154953, 0.004910514689981937, 0.012083576992154121, 0.00762985460460186, 0.005667076446115971, -0.036343518644571304, 0.016544437035918236, -0.001957425381988287, 0.02286815270781517, 0.01653016172349453, 0.0022072335705161095, 0.009278588928282261, -0.005071105435490608, -0.0038720264565199614, -0.03585817664861679, -0.014396087266504765, -0.002116231946274638, -0.0015202610520645976, -0.014082042500376701, -0.005167460069060326, -0.002371393144130707, 0.03582962602376938, 0.011155718006193638, -0.04525096341967583, -0.035001691430807114, 0.0042859939858317375, -0.0013141693780198693, -0.011362702585756779, 0.023924482986330986, 0.0005152293015271425, -0.005899040959775448, 0.03294612839818001, -0.04102563485503197, -0.018071835860610008, -0.009514122270047665, -0.04153952747583389, 0.026579586789011955, -0.00405402947217226, 0.005270951893180609, 0.028435304760932922, 0.030547969043254852, 0.041882120072841644, 0.03648626431822777, 0.015331082977354527, 0.009756792336702347, -0.0047606294974684715, 0.05193154513835907, 0.005320913624018431, 0.011505450122058392, 0.0008252590778283775, 0.014017806388437748, 0.05572862923145294, -0.017814889550209045, -0.0016969110583886504, 0.036000922322273254, -0.0024177860468626022, 0.02559462934732437, -0.0077083660289645195, 0.013789409771561623, -0.01702977903187275, 0.03063361719250679, -0.015273984521627426, -0.016744283959269524, 0.024352725595235825, 0.0016514103626832366, -0.03294612839818001, -0.015359632670879364, -0.03660046309232712, 0.02443837560713291, -0.002485591219738126, 0.016016270965337753, -0.03363131359219551, 0.006491443142294884, -0.016615811735391617, 0.024738144129514694, -0.021940292790532112, 0.0077583277598023415, -0.03140445426106453, 0.016430240124464035, -0.016858480870723724, 0.035686880350112915, -0.006548542529344559, -0.017700692638754845, 0.034573446959257126, 0.044023334980010986, -0.05230269208550453, -0.023053724318742752, -0.04031189903616905, -0.03328872099518776, -0.03166139870882034, -0.0172581747174263, -0.035572681576013565, 0.020941060036420822, 0.002999482210725546, 0.010606140829622746, -0.03485894203186035, 0.009307137690484524, 0.02271112985908985, -0.004086147528141737, 0.021997392177581787, -0.019727706909179688, -0.009250039234757423, -0.0217975452542305, 0.000871205935254693, -0.0037399849388748407, 0.009728243574500084, 0.017286723479628563, 0.003907713107764721, -0.021397853270173073, -0.012697391211986542, -0.020355796441435814, -0.0014283673372119665, -0.03351711854338646, 0.0008810198050923645, 0.005517191719263792, -0.005003300495445728, 0.004889102652668953, 0.004157521296292543, 0.013910745270550251, 0.03171849995851517, 0.006170261651277542, 0.008985956199467182, -0.006059632170945406, 0.008093784563243389, 0.04176792502403259, 0.023967308923602104, 0.02014167420566082, -0.03540138527750969, -0.003417018800973892, 0.003736416343599558, -0.019456487149000168, 0.023995857685804367, -0.033802613615989685, -0.007865387946367264, 0.0015407809987664223, -0.0013926804531365633, -0.003750690957531333, -0.034002456814050674, 0.024609671905636787, -0.003222525119781494, 0.039798006415367126, 0.01583069935441017, -0.010356332175433636, 0.01028495840728283, -0.008828934282064438, -0.005613545887172222, -0.004418035503476858, -0.015116961672902107, -0.015902074053883553, -0.0026354759465903044, -0.03460199758410454, 0.02932034060359001, -0.03874167799949646, -0.021469226107001305, 0.010713201016187668, 0.03528718650341034, -0.009471298195421696, 0.05193154513835907, 0.043223947286605835, 0.018428703770041466, -0.012647430412471294, -0.032460786402225494, -0.014239064417779446, 0.008229394443333149, 0.03137590363621712, 0.02809271216392517, -0.027050655335187912, 0.007565618492662907, 0.010249271988868713, 0.017657868564128876, -0.036885958164930344, 0.057441599667072296, 0.02309654839336872, 0.017743516713380814, -0.04716378077864647, -0.021940292790532112, -0.015102687291800976, 0.004118266049772501, 0.02613707073032856, 0.03737130016088486, 0.015673676505684853, -0.00237317755818367, -0.001460485509596765, 0.004150384105741978, -0.018856946378946304, 0.000983173493295908, -0.0017665005289018154, 0.0007333653629757464, 0.012997161597013474, 0.010948734357953072, -0.007444282993674278, 0.012483270838856697, -0.0074371458031237125, 0.003418802982196212, -0.018000461161136627, 0.01964205875992775, 0.0016986954724416137, 0.004186070989817381, -0.009792479686439037, 0.00832218024879694, 0.030605068430304527, -0.01975625567138195, -0.02445264905691147, -0.016572987660765648, -0.010734613053500652, -0.013532464392483234, -0.013054260052740574, 0.001005477854050696, -0.006377245299518108, -0.016159018501639366, -0.0053601693361997604, -0.012768764980137348, -0.01285441406071186, -0.00199489644728601, -0.017443746328353882, -0.01254750695079565, -0.01695840433239937, 0.07565618306398392, -0.005142479203641415, -0.01653016172349453, -0.020883962512016296, -0.0020698390435427427, -0.00553503492847085, 0.01162678562104702, -0.02836393192410469, -0.032889027148485184, 0.01757221855223179, -0.010092249140143394, 0.0013587779831141233, 0.005071105435490608, 0.03525863587856293, 0.032346587628126144, -0.01682993210852146, -0.00457505788654089, 0.025009365752339363, 0.015174061059951782, 0.005474367178976536, 0.007636992260813713, 0.0012213834561407566, -0.004100422374904156, -0.010884498246014118, -0.023553339764475822, 0.005010437685996294, 0.010499079711735249, 0.0043430933728814125, 0.02994842827320099, 0.04396623373031616, 0.0354299321770668, -0.009300000965595245, -0.036457717418670654, 0.0202130489051342, -0.0120336152613163, -0.025109287351369858, -0.012618880718946457, 0.03774244338274002, -0.014617346227169037, -0.023267844691872597, -0.009164390154182911, -0.009028780274093151, -0.0030137570574879646, 0.017058327794075012, -0.010263546369969845, 0.03074781596660614, 0.006887567695230246, 0.0224827341735363, 0.012640292756259441, 0.001848580315709114, 0.01633031666278839, -0.005802686791867018, 0.01037774421274662, -0.00985671579837799, 0.017400922253727913, -0.03440215066075325, 0.001245472114533186, 0.017772065475583076, 0.020056026056408882, 0.020398620516061783, -0.04824865981936455, -0.0043609365820884705, -0.0299769788980484, -0.008172295056283474, 0.010584728792309761, -0.046678438782691956, -0.0019146010745316744, -0.010584728792309761, -0.008507751859724522, 0.008928856812417507, -0.01159109827131033, 0.022882426157593727, -0.002046642592176795, -0.016587261110544205, 0.008778972551226616, 0.040112052112817764, 0.009307137690484524, 0.005406562238931656, 0.035686880350112915, 0.024509748443961143, 0.008600537665188313, 0.015102687291800976, -0.01093445997685194, -0.015402456745505333, 0.017086878418922424, 0.015573753975331783, 0.031004760414361954, 0.0045393710024654865, 0.022168690338730812, 0.019556410610675812, -0.007315810304135084, -0.010556179098784924, 0.036571912467479706, 0.004029048606753349, -0.007051727268844843, -0.004232463892549276, 0.011776669882237911, -0.022953800857067108, 0.019784806296229362, -0.0136823495849967, 0.007212318480014801, -0.01971343159675598, -0.004542939830571413, -0.005438680294901133, -0.01925664022564888, 0.01798618771135807, -0.045764852315187454, -0.02786431461572647, 0.016430240124464035, -0.0008257051813416183, 0.006559248548001051, -0.008029547519981861, -0.0020734076388180256, -0.002801419934257865, -0.025694552809000015, 0.02014167420566082, -0.00588119775056839, 0.033231623470783234, -0.01902824454009533, -0.0454222597181797, 0.019970377907156944, 0.03954106196761131, 0.0028139103669673204, -0.0020091712940484285, -0.022125864401459694, -0.01975625567138195, -0.03240368515253067, -0.022996624931693077, 0.011419801041483879, -0.02018449828028679, 0.0017504413845017552, -0.009100154042243958, 0.0035865313839167356, 0.01710115186870098, 0.0009198292973451316, 0.029377438127994537, -0.0053351884707808495, -0.029805680736899376, -0.012690254487097263, -0.014845741912722588, 0.023810286074876785, 0.025580355897545815, -0.007686953991651535, -0.022882426157593727, 0.00907160434871912, 0.00022003191406838596, -0.018856946378946304, 0.010384881868958473, 0.04824865981936455, 0.0247524194419384, -0.006109593901783228, -0.024809518828988075, 0.012540369294583797, 0.01176239550113678, -0.024267077445983887, -0.003654336556792259, 0.00040147738764062524, -0.016501612961292267, 0.0390557199716568, 0.025723103433847427, -0.014046356081962585, -0.019884729757905006, -0.020812587812542915, 0.025965772569179535, 0.045993249863386154, -0.01124136708676815, -0.004218189045786858, 0.01159109827131033, 0.017672142013907433, 0.011419801041483879, 0.0030262472573667765, -0.006966078653931618, 0.009257176890969276, 0.0037328475154936314, -0.02186891995370388, 0.029263241216540337, -0.044794172048568726, 0.022339986637234688, -0.018899770453572273, 0.03631496801972389, 0.0052424026653170586, 0.005263814702630043, 0.02536623366177082, 0.025666004046797752, 0.0005995395476929843, 0.00173705886118114, -0.00031382148154079914, -0.005417268257588148, -0.020355796441435814, 0.0018521490273997188, 0.026151346042752266, -0.0016656850930303335, -0.022397086024284363, 0.005545740947127342, -0.0037542597856372595, 0.04259585961699486, 0.034801844507455826, 0.017886264249682426, -0.004000499378889799, 0.03283192962408066, -0.010834536515176296, -0.018343055620789528, 0.00949271023273468, -0.010420569218695164, -0.00932141300290823, 0.03574397787451744, -0.0067091332748532295, -0.02068411558866501, 0.006127437110990286, 0.00564209558069706, 0.0356583297252655, -0.0021340753883123398, 0.0015434575034305453, 0.027421798557043076, 0.04082579165697098, -0.02532340958714485, -0.004832003265619278, -0.0032849772833287716, -0.008165158331394196, -0.027264775708317757, -0.002564102178439498, 0.012133538722991943, -0.0005491318297572434, 0.0009796047816053033, -0.01389647088944912, -0.015816424041986465, 0.041111286729574203, 0.00039947000914253294, 0.0074300081469118595, -0.002262548077851534, -0.008671911433339119, -0.010920184664428234, 0.007786876987665892, -0.009978051297366619, 0.004350230563431978, 0.005328051280230284, 0.0026336917653679848, -0.016444513574242592, 0.029919879510998726, 0.004186070989817381, -0.04964758828282356, 0.015530929900705814, 0.023738911375403404, 0.026779433712363243, -0.0005063075805082917, 0.059554263949394226, 0.004571489058434963, 0.023781735450029373, -0.01515978667885065, 0.0010286743054166436, -0.0019163853721693158, 0.021968843415379524, -0.0072587113827466965, -0.05461519956588745, 0.00932141300290823, -0.04650714248418808, 0.005852648057043552, -0.004849846940487623, 0.03377406299114227, 0.03394535928964615, -0.005567152984440327, -0.03931266441941261, -0.00649501197040081, -0.002817479195073247, 0.01894259639084339, 0.03320307284593582, -0.04171082377433777, -0.013653799891471863, -0.004689255729317665, -0.012690254487097263, -0.0220259428024292, -0.0021822527050971985, -0.01172670815140009, 0.0010706064058467746, 0.0055136228911578655, 0.00949271023273468, 0.006330852396786213, -0.005724175367504358, 0.0060061016120016575, 0.026822257786989212, 0.0296343844383955, -0.009585496038198471, -0.014874291606247425, 0.016701459884643555, -0.0004563459660857916, 0.002258979482576251, -0.021198006346821785, 0.009192939847707748, 0.02745034731924534, 0.02779294177889824, 0.02602287195622921, 0.02079831250011921, 0.026551038026809692, -0.009564084000885487, 0.011234229430556297, 0.03397390991449356, -0.001622860785573721, -0.001778990961611271, -0.041682276874780655, 0.005096086300909519, -0.029691483825445175, -0.03203254193067551, 0.0018396585946902633, -0.011476900428533554, 0.006327283568680286, 0.0023642557207494974, 0.014096316881477833, 0.02920614182949066, 0.014845741912722588, 0.004186070989817381, 0.019542135298252106, 0.008900308050215244, 0.004182502161711454, 0.03936976566910744, 0.02391020953655243, 0.010584728792309761, 0.03431650251150131, 0.011169993318617344, -0.01979907974600792, 0.027578819543123245, -0.0195278599858284, 0.04071159288287163, 0.014438911341130733, -0.002462394768372178, 0.037000156939029694, -0.0007868956890888512, -0.00405402947217226, 8.893839549273252e-06, 0.009064467623829842, 0.010920184664428234, 0.02532340958714485, -0.022582657635211945, 0.02974858321249485, -0.0003856413532048464, 0.0016371356323361397, -0.023310668766498566, 0.022968076169490814, 0.03106185980141163, 0.019770530983805656, -0.024695320054888725, -0.02118373103439808, -0.0038791638799011707, -0.02009885013103485, -0.02420997805893421, -5.3809122618986294e-05, 0.012140676379203796, -0.03343147039413452, -0.007958173751831055, -0.025351958349347115, -0.012333385646343231, 0.025823025032877922, 0.0072943982668221, 0.016201842576265335, -0.008350729942321777, 0.011384114623069763, -0.0026872220914810896, 0.01625894196331501, 0.011576823890209198, 0.00042601212044246495, -0.005973983556032181, -0.005028281360864639, -0.026779433712363243, -0.0011928339954465628, 0.032346587628126144, 0.009371374733746052, 0.018014736473560333, -0.007108826190233231, 0.009685419499874115, 0.008093784563243389, 0.00275324285030365, -0.03777099400758743, 0.04605034738779068, 0.005995395593345165, -0.02318219654262066, 0.002337490674108267, -0.0009225058020092547, -0.021854644641280174, -0.02568027749657631, 0.026151346042752266, -0.010813124477863312, 0.022654030472040176, -0.014189103618264198, 0.008721873164176941, -0.009221489541232586, 0.009200077503919601, -0.032118190079927444, -0.00216619367711246, 0.017929088324308395, -0.019042517989873886]",Online Speculative Decoding.pdf
" attributed to our imperfect accep-
tance length predictor, resulting in standard SD with a longer
proposed length performing better as more tokens could po-
tentially be accepted.
Conversely, in scenarios with a high request rate, the sys-
tem‚Äôs performance mirrors situations where no tokens are
predicted, effectively indicating that speculative decoding is
disabled under conditions of high request volume. It is impor-
tant to note that in this regime, the latency associated with
using standard SD and proposing high numbers of tokens
escalates rapidly, leading to significant performance degra-
dation. This is exemplified in Fig. 11 (c) when the request
rate is at 32 and (f) when the request rate exceeds 5.
In cases such as Fig. 11 (d) and (e), the relative speedup
for these baselines rebounds after initially dropping when
the request rate exceeds 2. This rebound occurs because,
as the request rate continues to increase, it reaches a point
where even baseline decoding without speculation begins
to suffer from queuing delays. This phenomenon relatively
improves the speedup of standard SD baselines, despite them
experiencing higher overall latencies.
In general, speculative decoding is most effective when
the system has sufficient computational resources: the larger
the model, the smaller the request rate region where we see
speedup from speculation. This is expected as speculative
decoding requires additional computational power; when
the model is large and computational resources do not scale
proportionally, the system is likely to be compute-bound.
This underscores the importance of SmartSpec. It is crucial
for SmartSpec to consistently match or outperform the estab-
lished baseline across different scenarios. This characteristic
is vital for implementing speculative decoding techniques
in real production environments, as it ensures that adopting
10
DSDK=1K=3K=5
2 4 6 8 10
Request Rate0.00.51.01.52.02.5Speedup(a)Standard SD, Vicuna 7B, Arena
2 4 6 8 10
Request Rate0.00.40.81.21.62.0Speedup (b)Standard SD, Vicuna 7B, ShareGPT
4 8 12 16 20 24 28 32
Request Rate0.000.250.500.751.001.25Speedup (c)Standard SD, Vicuna 7B, Spider
0.5 1.0 1.5 2.0 2.5 3.0
Request Rate0.00.40.81.21.62.0Speedup
(d)Standard SD, Vicuna 33B, Arena
0.5 1.0 1.5 2.0 2.5 3.0
Request Rate0.00.30.60.91.21.5Speedup (e)Standard SD, Vicuna 33B, ShareGPT
1 2 3 4 5 6
Request Rate0.00.30.60.91.21.5Speedup (f)Standard SD, Vicuna 33B, Spider
0.5 1.0 1.5 2.0 2.5 3.0
Request Rate0.000.250.500.751.001.25Speedup
(g)Standard SD, Llama2-70B, Arena
0.5 1.0 1.5 2.0 2.5 3.0
Request Rate0.00.30.60.91.21.5Speedup (h)Standard SD, Llama2-70B, ShareGPT
Figure 11. Latency Measurement on standard SD: Speedup across different datasets. X-axis: request rate.
speculative decoding will not compromise system perfor-
mance.
7.1.2 Draft model free speculative decoding. We next
evaluate the efficiency of SmartSpec with prompt lookup
decoding. Like our tests with draft-model-based specula-
tive decoding, we compare SmartSpec using fixed proposal
lengths of 1, 3, and 5, against the baseline of no specula-
tive decoding. As shown in Fig. 12, SmartSpec consistently
achieves the best speedup. Notably, prompt lookup decod-
ing with Mistral-7B (Fig. 12 (a) and (b)) shows substantial
speedup even with a relatively low token acceptance rate
(the measured token acceptance rate on those two settings
is between 0.3 and 0.4). Unlike scenarios involving a draft
model, prompt lookup does not incur significant overhead
","[0.027980651706457138, 0.030014047399163246, 0.03465362265706062, -0.011240947991609573, -0.030414998531341553, 0.03473953902721405, -0.013059547170996666, 0.02941261976957321, 0.020863771438598633, -0.014348317869007587, 0.02461552806198597, 0.02062033675611019, -0.0574505515396595, 0.018830377608537674, 0.03611423075199127, -0.02702123299241066, 0.006490394473075867, -0.01695450022816658, -0.002951643895357847, 0.008563168346881866, -0.008627606555819511, 0.015365015715360641, -0.011513021774590015, 0.03399491682648659, 0.012164566665887833, -0.03227655589580536, 0.014126363210380077, 0.03127417713403702, 0.060772716999053955, -0.05713551864027977, -0.009508267045021057, -0.02689235657453537, -0.006819746922701597, -0.049460168927907944, -0.004736233968287706, 0.03158921003341675, -0.02094968967139721, -0.011190828867256641, -0.024028420448303223, -0.02348427288234234, -0.007256497163325548, -0.024257535114884377, -0.07726898789405823, 0.009443827904760838, 0.03416675329208374, 0.0498611219227314, 0.0174556877464056, -0.03130281716585159, -0.0204341821372509, 0.04605208709836006, -0.05750783160328865, 0.03757483884692192, -0.0030751510057598352, 0.005226682871580124, 0.04719766229391098, -0.011978411115705967, -0.016281474381685257, 0.010789877735078335, 0.031159620732069016, -0.003014292335137725, 0.029899489134550095, -0.022940125316381454, 0.0003640330978669226, -0.0017881698440760374, -0.001667347620241344, 3.0681028874823824e-05, -0.014749269001185894, 0.0631784200668335, -0.011341185308992863, 0.0377180352807045, -0.005022627301514149, 0.0010686060413718224, 0.05547443404793739, -0.019560681656003, -0.016295794397592545, 0.02019074745476246, 0.03986598551273346, 0.05607586354017258, 0.006665810476988554, -0.006977263372391462, -0.004643155727535486, 0.015049982815980911, 0.006622851360589266, -0.038806330412626266, -0.011312546208500862, -0.02683507837355137, -0.0018347088480368257, 0.00027162639889866114, 0.009114475920796394, -0.027035553008317947, -0.02835296466946602, -0.001890197629109025, -0.026548683643341064, -0.01669674552977085, -0.0007857923628762364, 0.005903287790715694, 0.013052387163043022, -0.03562736138701439, 0.023512912914156914, 0.03376580402255058, 0.05089213699102402, 0.02182319015264511, 0.016481950879096985, -0.031102342531085014, 0.057364631444215775, -0.018744459375739098, -0.02924078330397606, 0.062090128660202026, -0.009966496378183365, 0.0086705656722188, -0.03158921003341675, -0.044820595532655716, -0.05687776580452919, 0.028209766373038292, -0.026205012574791908, -0.028424562886357307, -0.08786554634571075, -0.024142978712916374, 0.0140118058770895, 0.0349113754928112, -0.00025327931507490575, 0.014949744567275047, 0.022367337718605995, -0.008735003881156445, -0.04456283897161484, 0.0020727734081447124, 0.025961577892303467, -0.11587484180927277, -0.001156314043328166, -0.025589266791939735, -0.009257672354578972, 0.01563708856701851, 0.060715436935424805, -0.002735058544203639, -0.0005624948535114527, 0.0140118058770895, -0.052667777985334396, -0.010933075100183487, -0.02600453607738018, 0.02829568460583687, -0.026104774326086044, -0.02576110139489174, 0.003214767901226878, 0.02891143225133419, -0.059455305337905884, 0.025961577892303467, -0.010281529277563095, -0.010983193293213844, -0.023512912914156914, 0.0421571359038353, -0.04453420266509056, 0.0025471127592027187, -0.025259913876652718, -0.031531933695077896, -0.0004273529048077762, -0.024916240945458412, -0.02898303046822548, 0.02278260886669159, 0.006257699802517891, -0.02543175034224987, -0.007052441593259573, 0.03044363670051098, -0.00669087003916502, -0.014076244086027145, 0.015021342784166336, 0.02924078330397606, -0.0379471480846405, -0.016367392614483833, -0.08626174181699753, -0.04384685680270195, 0.032992538064718246, 0.004929549526423216, -0.021880468353629112, -0.048371873795986176, -0.0035387505777180195, -0.013582215644419193, -0.03181832656264305, -0.046281203627586365, 0.0363147035241127, -0.0454220212996006, -0.04072516784071922, 0.02859639935195446, -0.009021397680044174, 0.016052359715104103, -0.02000459097325802, -0.011419943533837795, -0.055130764842033386, 0.04522154480218887, 0.03196152299642563, 0.013746891170740128, 0.024028420448303223, 0.04662487283349037, 0.04462011903524399, -0.021465199068188667, -0.006458174902945757, -0.03574191778898239, 0.025646544992923737, 0.030042685568332672, -0.014949744567275047, 0.0032988958992064, -0.00730661628767848, 0.011964092031121254, 0.01867286115884781, -0.02304036356508732, 0.025016479194164276, -0.007474872283637524, -0.013059547170996666, -0.017613204196095467, -0.02080649323761463, 0.009601344354450703, -0.007048862054944038, 0.0025148936547338963, 0.052410025149583817, -0.029641734436154366, -0.04035285487771034, -0.007338835392147303, -0.02024802565574646, 0.021565435454249382, 0.005953406449407339, 0.05057710409164429, 0.0165249090641737, -0.01987571455538273, 0.014512994326651096, 0.01941748522222042, -0.026018856093287468, 0.08116394281387329, -0.0070703416131436825, 0.0005293806316331029, -0.005652693100273609, -0.01923132874071598, 0.017570246011018753, 0.004388981498777866, 0.011649059131741524, 0.005480857100337744, -0.008248134516179562, -0.006085863336920738, 0.0013111456064507365, -0.019317246973514557, -0.0038233541417866945, -0.07749810069799423, 0.02568950317800045, 0.010618042200803757, 0.03055819496512413, 0.008305413648486137, -0.03854857385158539, 0.01891629584133625, -0.04745541512966156, -0.0528968945145607, 0.015035662800073624, 0.02892575040459633, -0.016625147312879562, -0.053813353180885315, -0.04456283897161484, -0.02316923998296261, -0.045336101204156876, 0.004231465049088001, -0.0227110106498003, 0.021407919004559517, -0.05518804118037224, 0.005452217534184456, -0.015307736583054066, -0.036028310656547546, -0.0003843938757199794, 0.03568463772535324, -0.0316464900970459, -0.04018101841211319, -0.001511621056124568, -0.003905692370608449, 0.01683994196355343, -0.045908890664577484, 0.0001679206034168601, 0.025847019627690315, -0.010424725711345673, 0.007918782532215118, -0.02056305855512619, -0.0516081228852272, 0.027379225939512253, 0.007897302508354187, -0.06220468506217003, 0.035197772085666656, 0.021035607904195786, -0.009171754121780396, 0.03302117809653282, 0.03156057372689247, -9.067265636986122e-05, 0.023956822231411934, 0.03161785006523132, -0.01114070974290371, 0.005559615325182676, -0.0053913588635623455, 0.0031199001241475344, -0.04072516784071922, 0.02384226582944393, -0.060829997062683105, 0.010768398642539978, 0.004922389518469572, 0.03554144129157066, -0.012544038705527782, -0.02853911928832531, -0.025102397426962852, 0.09187506139278412, 0.019030852243304253, 0.06105910986661911, 0.00496534863486886, 0.015092941001057625, -6.135506737336982e-06, -0.02892575040459633, -0.004750553518533707, -0.0011894282652065158, -0.01884469762444496, -0.0005821844679303467, 0.009637143462896347, -0.052295465022325516, -0.008169376291334629, -0.020133469253778458, -0.06501134485006332, 0.05939802899956703, -0.04218577221035957, 0.019675238057971, -0.010059574618935585, -0.015322056598961353, -0.012522558681666851, -0.03270614519715309, -0.004474899731576443, 0.05352696031332016, -0.040266938507556915, -0.011756456457078457, 0.014018965885043144, 0.012100128456950188, -0.020577378571033478, 0.005366299767047167, 0.038634493947029114, 0.008692044764757156, -0.0048686908558011055, -0.024243216961622238, -0.04003782197833061, -0.032992538064718246, 0.008276774547994137, 0.019532041624188423, 0.0286107175052166, -0.06438127905130386, 0.012236165814101696, 0.01802847534418106, -0.01682562194764614, 0.0038484137039631605, 0.00496534863486886, 0.014892466366291046, 0.0038161943666636944, 0.11112070828676224, 0.027064193040132523, -0.031474653631448746, -0.04112611711025238, 0.05535987764596939, -0.016925860196352005, 0.023183559998869896, 0.0015357855008915067, 0.008692044764757156, -0.046796709299087524, -0.07154111564159393, -0.014792228117585182, 0.012014210224151611, 0.0439041368663311, 0.013231383636593819, 0.002581122098490596, 0.011649059131741524, 0.00403456948697567, -0.018243269994854927, -0.012694395147264004, -0.01350345741957426, -0.03410947322845459, -0.024458011612296104, 0.09055764973163605, -0.02454392984509468, 0.016224196180701256, -0.02442937158048153, -0.01930292695760727, -0.01999027095735073, 0.055846747010946274, -0.0004034122102893889, 0.03829082101583481, 0.006493974477052689, 0.008541688323020935, -0.01747000776231289, -0.00804049987345934, 0.03087322786450386, 0.011183668859302998, 0.019374525174498558, -0.023083321750164032, -0.07618068903684616, -0.025016479194164276, -0.027379225939512253, -0.0043352828361094, 0.0022571394219994545, 0.0005589149659499526, -0.0018418687395751476, 0.030959146097302437, -0.002335897646844387, 0.03465362265706062, 0.033193014562129974, 0.04353182390332222, -0.002015494741499424, -0.007439073175191879, -0.03637198358774185, -0.02967037446796894, -0.029813570901751518, 0.014906785450875759, 0.009343590587377548, 0.03499729558825493, 0.03840537741780281, 0.01288055069744587, 0.04270128160715103, -0.0436750203371048, 0.044075969606637955, -0.0436750203371048, 0.014276719652116299, -0.00804049987345934, 0.0015814295038580894, 0.027164431288838387, 0.05547443404793739, 0.08351236581802368, 0.0025202634278684855, -0.047799088060855865, -0.03625742718577385, -0.019589319825172424, -0.05097805708646774, -0.008305413648486137, 0.005430737975984812, 0.011913972906768322, 0.05060574412345886, -0.058997076004743576, -0.0349113754928112, 0.019131090492010117, 0.06965091824531555, -0.01885901764035225, -0.04038149490952492, 0.01024573016911745, 0.013016588054597378, -0.004317383281886578, -0.003791135037317872, -0.03216199949383736, -0.022825567051768303, -0.007825704291462898, -0.017126336693763733, 0.019961632788181305, -0.015049982815980911, 0.01987571455538273, -0.030529554933309555, -0.004184925928711891, 0.030844587832689285, -0.01563708856701851, 0.014949744567275047, 0.01003093458712101, -0.005155084189027548, 0.007854343391954899, -0.032562948763370514, -0.048056840896606445, 0.10046686977148056, 0.00160917395260185, 0.019918672740459442, 0.004227885045111179, 0.027236029505729675, 0.019059492275118828, -0.05788014084100723, -0.030844587832689285, -0.03657246008515358, -0.012243324890732765, 0.0349113754928112, 0.07303036004304886, 0.02430049516260624, 0.04124067351222038, 0.00993069726973772, -0.036028310656547546, 0.006715929135680199, -0.012164566665887833, 0.003329325234517455, 0.021049927920103073, 0.05871068313717842, -0.007231437601149082, 0.046911269426345825, -0.024916240945458412, 0.01309534627944231, -0.023455634713172913, 0.05169403925538063, 0.004052469041198492, 0.018744459375739098, 0.07978925108909607, 0.05169403925538063, -0.0014615021646022797, -0.027751537039875984, -0.042414888739585876, -0.0005839744117110968, -0.0499756783246994, 0.05882523953914642, -0.0173984095454216, 0.007840024307370186, 0.0010516013717278838, 0.041670266538858414, 0.01569436863064766, 0.0003949099045712501, 0.027049873024225235, 0.018586942926049232, -0.001161683932878077, -0.011090591549873352, 0.009551226161420345, -0.001172423711977899, -0.023555871099233627, -0.008176536299288273, 0.007120460271835327, -0.024142978712916374, -0.0038484137039631605, -0.01568004861474037, 0.014376957900822163, -0.010560763068497181, 0.008806602098047733, -0.02031962387263775, -0.005477277096360922, -0.028395922854542732, 0.017384089529514313, -0.02302604354918003, -0.011484382674098015, 0.011362665332853794, -0.01771344244480133, -0.003458202350884676, 0.00042891912744380534, 0.019331566989421844, -0.030730031430721283, -0.014455716125667095, -0.1331157386302948, -0.02126472257077694, -0.02397114224731922, 0.006948624271899462, -0.05000431835651398, -0.007388954050838947, 0.03190424293279648, -0.013174104504287243, 0.010474844835698605, -0.004059629049152136, 0.003630038583651185, -0.027737217023968697, -0.002019074745476246, 0.010016615502536297, 0.01569436863064766, 0.02550334855914116, 0.004492799285799265, -0.013159784488379955, -0.02987084910273552, 0.023899544030427933, 0.007063181605190039, -0.018386468291282654, 0.006497554015368223, 0.03442450612783432, -0.012050009332597256, 0.02593293786048889, -0.014348317869007587, -0.012551198713481426, 0.023126281797885895, -0.0065834722481667995, 0.008949799463152885, -0.023899544030427933, 0.005423578433692455, -0.00430306326597929, -0.029784932732582092, -0.017312491312623024, -0.012035690248012543, -0.005609733983874321, 0.013009428046643734, 0.002038764301687479, -0.01024573016911745, 0.02107856795191765, 0.032305195927619934, -0.030271800234913826, 0.0035942394752055407, 0.009973656386137009, -0.009723061695694923, 0.01360369473695755, -0.035656001418828964, -0.007711146958172321, -0.008326893672347069, 0.022037984803318977, 0.014555953443050385, -0.002219550311565399, -0.01328866183757782, -0.008033339865505695, 0.006221900228410959, -0.028553439304232597, 0.023298118263483047, 0.00784718431532383, 0.013231383636593819, 0.0015760596143081784, -0.01012401282787323, 0.014734949916601181, 0.002888995222747326, 0.013446178287267685, 0.00020741159096360207, -0.010109692811965942, -0.005656273104250431, 0.016367392614483833, -0.03279206529259682, -0.03207607939839363, 0.006877025589346886, 0.0038126143626868725, -0.014598912559449673, -0.01569436863064766, -0.00776842562481761, -0.02106424793601036, 0.037803951650857925, -0.03574191778898239, 0.013954526744782925, 0.03562736138701439, -0.013553575612604618, 0.029727652668952942, 0.017255213111639023, 0.00016971056174952537, -0.030959146097302437, -0.04404733330011368, 0.006297078914940357, -0.042243052273988724, -0.037746671587228775, 0.02157975547015667, -0.0029838629998266697, 0.009515426121652126, -0.013374580070376396, 0.0034080834593623877, 0.013882928527891636, 0.007603749632835388, -0.013345940969884396, -0.026419807225465775, -0.00993069726973772, 0.017097696661949158, 0.005702812224626541, 0.006755308248102665, 0.024185936897993088, 0.008548848330974579, 0.01553685124963522, -0.012959308922290802, 0.0241143386811018, 0.0022839887533336878, 0.00699158338829875, 0.006418795790523291, -0.02543175034224987, -0.0015975391725078225, 0.03797578811645508, -0.015923483297228813, -0.043560463935136795, 0.007077501155436039, -0.018429426476359367, 0.005036946851760149, -0.006268439348787069, -0.00130130082834512, -0.02505943737924099, -0.03531232848763466, -0.011570300906896591, 0.04699718579649925, 0.030014047399163246, 0.02220982126891613, -0.02576110139489174, 0.009336430579423904, -0.015107261016964912, 0.01974683627486229, -0.022238461300730705, 0.007854343391954899, 0.004414041060954332, -0.03674429655075073, -0.014641871675848961, 0.014634711667895317, 0.03734572231769562, 0.04055333137512207, 0.021422239020466805, 0.026677561923861504, -0.018314870074391365, -0.037116605788469315, 0.030672751367092133, 0.04573705419898033, -0.013073866255581379, 0.0019098871853202581, -0.013546416535973549, -0.004310223273932934, -0.05031935125589371, -0.0028102369979023933, 0.04315951094031334, -0.03221927583217621, 0.016653787344694138, -0.04630983993411064, -0.015207499265670776, -8.144316961988807e-05, 0.010374607518315315, 0.01885901764035225, 0.03410947322845459, 0.02683507837355137, 0.00829109363257885, 0.004256524611264467, -0.003470732131972909, 0.033823080360889435, -0.04353182390332222, -0.003016082337126136, 0.008756483905017376, 0.002600811654701829, 0.021722951903939247, -0.0048686908558011055, -0.013689612969756126, -0.023498592898249626, 0.032047439366579056, 0.01873013935983181, -0.024458011612296104, 0.00024858067627064884, -0.019890034571290016, 0.0008556008106097579, 0.005509496200829744, 0.04499243199825287, -0.015178859233856201, 0.011119230650365353, 0.019517721608281136, -0.024071380496025085, -0.0011545241577550769, -0.0002859460946638137, 0.014849507249891758, -0.018014155328273773, 0.004066788591444492, -0.007825704291462898, -0.02165135368704796, -0.048629630357027054, -0.02246757596731186, -0.021909108385443687, 0.004374661948531866, -0.0008851351449266076, -0.002330527640879154, 0.0042457845993340015, 0.0249878391623497, -0.0038090345915406942, 0.030014047399163246, 0.028052249923348427, 0.007195638492703438, 0.02106424793601036, -0.04751269519329071, 0.00526606198400259, -0.005090645980089903, -0.01081851776689291, 0.016438990831375122, -0.011699177324771881, 0.004073948599398136, 0.047111742198467255, -0.009250512346625328, -0.03158921003341675, 0.021250402554869652, 0.00694504426792264, -0.035340968519449234, -0.01164189912378788, 0.04264400154352188, -0.004779192619025707, -0.004886590410023928, -0.03665837645530701, 0.014391276985406876, -0.012035690248012543, 0.00037164040259085596, 0.02537447027862072, -0.016983138397336006, 0.015665728598833084, 0.021107206121087074, -0.0071562593802809715, -0.017097696661949158, -0.006794687360525131, 0.010403246618807316, -0.004467739723622799, 0.022295739501714706, 0.0173984095454216, 0.013739732094109058, -0.027049873024225235, -0.002792337443679571, 0.023827945813536644, 0.01758456602692604, 0.02385658398270607, -0.03136009722948074, -0.015049982815980911, 0.03196152299642563, 0.06724521517753601, -0.001540260505862534, -0.0003186128451488912, 0.0241143386811018, 0.008455770090222359, 0.042615365236997604, -0.023555871099233627, -0.03929319977760315, -0.029469899833202362, -0.001881247851997614, -0.027823135256767273, 0.01758456602692604, -0.01483518723398447, 0.004789932630956173, -0.02050578035414219, -0.030214522033929825, -0.009372229687869549, -0.012844751589000225, -0.04605208709836006, 0.02397114224731922, 0.005967725999653339, -0.01569436863064766, -0.00037611532025039196, -0.1208580881357193, -0.014849507249891758, 0.014441396109759808, -0.011992731131613255, -0.0028567758854478598, -0.0016700325068086386, 0.033250294625759125, 0.010252890177071095, 0.002335897646844387, -0.009816139936447144, 0.030214522033929825, -0.015995081514120102, -0.009687262587249279, -0.026563003659248352, -0.006841226480901241, -0.04954608902335167, -0.017555925995111465, -0.02163703553378582, 0.01930292695760727, -0.033565327525138855, 0.004535758402198553, -0.017727762460708618, -0.006715929135680199, -0.006970103830099106, 0.012923509813845158, -0.01152018178254366, -0.03219063952565193, 0.0025023638736456633, 0.02019074745476246, -0.004789932630956173, -0.0007092715823091567, 0.027107151225209236, 0.0016995668411254883, 0.04588025063276291, -0.02872527576982975, -0.0024916240945458412, -0.023011723533272743, -0.035656001418828964, 0.024787364527583122, 0.012572677806019783, 0.04731221869587898, -0.015164540149271488, 0.032362472265958786, 0.021536797285079956, 0.010954554192721844, -0.0331643745303154, 0.004961768630892038, -0.01669674552977085, -0.024443691596388817, -0.008126418106257915, 0.01553685124963522, 0.03551280498504639, -0.0015787446172907948, -0.0008117468096315861, -0.005777990445494652, 0.01543661393225193, 0.0006640750798396766, -0.0015518951695412397, -0.011606100015342236, 0.02935534156858921, -0.004582297056913376, 0.02485896274447441, 0.016367392614483833, 0.003161069005727768, -0.0227110106498003, -0.021751591935753822, 0.027765857055783272, 0.01063236128538847, 0.022037984803318977, -0.0302431620657444, -0.004940289072692394, 0.030787309631705284, 0.022166863083839417, 0.008362692780792713, 0.010517803952097893, 0.030644113197922707, -0.01747000776231289, 0.0139831667765975, -0.06346481293439865, 0.005155084189027548, 0.07062465697526932, -0.03353668749332428, 0.0003398686239961535, -0.026462767273187637, 0.01954636164009571, 0.007804224733263254, 0.03453906625509262, 0.0042457845993340015, -0.011820894666016102, 0.021608395501971245, 0.026434127241373062, -0.021364960819482803, -0.021722951903939247, 0.0005598099669441581, -0.04169890284538269, -0.03674429655075073, -0.0051908837631344795, 0.0025148936547338963, -0.001299510826356709, 0.008649085648357868, 0.050834860652685165, 0.036228787153959274, -0.011176508851349354, -0.04799956455826759, 0.016782663762569427, 0.0024987838696688414, -0.013231383636593819, -0.015135900117456913, 0.03276342526078224, 0.032562948763370514, 0.0204914603382349, 0.021422239020466805, 0.013152625411748886, 0.0069951629266142845, 0.006204000674188137, 0.0067696282640099525, 0.055388517677783966, -0.0005812894669361413, 0.020233705639839172, -0.03594239428639412, 0.003959391266107559, 0.01835782825946808, -0.03133145719766617, 0.05066302418708801, -0.037803951650857925, 0.012114448472857475, 0.017555925995111465, 0.018386468291282654, -0.003916432149708271, -0.002187330974265933, -0.01777072064578533, 0.049259696155786514, -0.006207580678164959, 0.004471319727599621, 0.029312381520867348, -0.0033901839051395655, 0.010682480409741402, -0.0049581886269152164, -0.03402355685830116, 0.018873335793614388, -0.000394238653825596, 0.019217008724808693, 0.015393654815852642, 0.010367447510361671, 0.001524150837212801, -0.006877025589346886, -0.0002767725382000208, -0.008720684796571732, -0.008627606555819511, 0.0004635996010620147, 0.0012100128224119544, -0.01715497486293316, -0.014219441451132298, -0.006415216252207756, 0.019460443407297134, 0.015021342784166336, -0.03061547316610813, -0.03018588200211525, 0.022682370617985725, 0.011606100015342236, 0.018830377608537674, 0.03851993754506111, -0.002742218552157283, -0.013474817387759686, 0.02378498576581478, -0.032620228826999664, -0.02600453607738018, -0.0009379389812238514, -0.023426994681358337, 0.015608449466526508, -0.008484410122036934, -0.024314815178513527, 0.023426994681358337, 0.015508212149143219, 0.04315951094031334, 0.02468712627887726, -0.018372148275375366, 0.012229005806148052, 0.005573934875428677, 0.04765589162707329, 0.011999891139566898, -0.002033394295722246, 0.006619271356612444, -0.005735031329095364, 0.04676806926727295, -0.02727898769080639, 0.017054736614227295, 0.0437895767390728, -0.009945017285645008, 0.007277976721525192, 0.010489164851605892, 0.028238406404852867, -0.017885278910398483, 0.03442450612783432, -0.00889252033084631, 0.008484410122036934, 0.024014100432395935, 0.018057115375995636, -0.010968874208629131, -0.004517858847975731, -0.07474872469902039, 0.009479627013206482, -0.029441259801387787, 0.011312546208500862, -0.0038269341457635164, 0.0012798212701454759, 0.005609733983874321, 0.022123903036117554, -0.0331643745303154, 0.008398491889238358, -0.035025935620069504, 0.020992649719119072, -0.028023611754179, 0.041212037205696106, -0.013331620953977108, -0.009264832362532616, 0.01442707609385252, 0.019374525174498558, -0.059627141803503036, 0.0001028108163154684, -0.05238138511776924, -0.024887600913643837, -0.013625174760818481, -0.016109637916088104, -0.028567759320139885, 0.022639412432909012, 0.0010775558184832335, 0.016725385561585426, -0.03459634259343147, -0.0005249057430773973, 0.012551198713481426, 0.006440275348722935, 0.010711119510233402, -0.023570191115140915, -0.023956822231411934, -0.007582270074635744, -0.015193179249763489, 0.007983220741152763, -0.028696635738015175, 0.011513021774590015, 0.0022857787553220987, -0.005291121080517769, -0.022639412432909012, -0.011656218208372593, 0.005223102867603302, 9.026711268234067e-06, 0.006780367810279131, 0.014276719652116299, -0.0038161943666636944, -0.009508267045021057, -0.0011214098194614053, 0.014412757009267807, 0.013202743604779243, -0.01480654813349247, 0.00724575761705637, -0.007524991407990456, 0.015135900117456913, 0.017828000709414482, 0.04049605131149292, 0.042243052273988724, -0.013310141861438751, -0.005491596646606922, -0.007954581640660763, -0.0006327508017420769, 0.019245648756623268, -0.02518831565976143, -0.004793512634932995, 0.01493542455136776, -0.0021354220807552338, -0.004242205061018467, -0.015923483297228813, 0.014634711667895317, -0.006032164674252272, 0.051350366324186325, -0.0007916097529232502, 0.006547673139721155, 0.01082567684352398, -0.03897816687822342, 0.007360314950346947, -0.017870958894491196, 0.0038233541417866945, -0.01575164683163166, -0.015980761498212814, -0.030586833134293556, 0.02031962387263775, -0.04252944514155388, -0.01910245232284069, 0.0009835829259827733, 0.03410947322845459, 0.002033394295722246, 0.03568463772535324, 0.02803793177008629, 4.4944772525923327e-05, 0.006347197573632002, -0.041842103004455566, -0.018014155328273773, 0.009766020812094212, 0.009945017285645008, 0.019847074523568153, -0.03803306818008423, 0.015508212149143219, 0.016224196180701256, 0.003887792816385627, -0.028710955753922462, 0.05384199321269989, 0.025531986728310585, 0.03459634259343147, -0.0302431620657444, -0.02461552806198597, -0.021536797285079956, -0.0017738501774147153, 0.022639412432909012, 0.019818434491753578, 0.031846966594457626, 0.005287541542202234, 0.0007835549185983837, 0.018887655809521675, -0.004131227266043425, 0.018744459375739098, 0.008641926571726799, 0.0007043491932563484, 0.019403165206313133, 0.007890143431723118, -0.003338275011628866, -0.003193288343027234, -0.006579892244189978, -0.002778017660602927, -0.030329080298542976, -0.003363334573805332, 0.011992731131613255, 0.01084715686738491, -0.0017085166182368994, 0.01462039165198803, 0.021035607904195786, -0.019660918042063713, 0.0013326250482350588, -0.009651463478803635, 0.0034331430215388536, 0.010546443052589893, -0.017727762460708618, 0.014412757009267807, 0.002951643895357847, 0.003873473033308983, -0.015293416567146778, -0.015608449466526508, -0.01854398474097252, 0.01777072064578533, -0.01848670467734337, -0.010933075100183487, -0.02315491996705532, 0.08242407441139221, -0.011749296449124813, -0.013532096520066261, -0.010417566634714603, -0.002894364995881915, -0.0075679500587284565, -0.0032577270176261663, -0.02892575040459633, -0.04424780607223511, 0.010474844835698605, -0.002015494741499424, 0.0241716168820858, 0.023498592898249626, 0.03525504842400551, -0.0042959037236869335, -0.0009352540364488959, -0.002928374335169792, 0.036601100116968155, 0.027193069458007812, 0.026305250823497772, 0.018071435391902924, -0.008441451005637646, -0.014018965885043144, -0.014706309884786606, -0.0377180352807045, 0.005978466011583805, 0.01258699782192707, 0.018014155328273773, 0.03221927583217621, 0.022195501253008842, 0.027064193040132523, 0.003178968792781234, -0.014505834318697453, 0.026119094341993332, -0.004138387273997068, -0.03264886885881424, -0.01588052324950695, 0.04739813506603241, -0.018572622910141945, -0.010782717727124691, -0.03803306818008423, 0.00035060837399214506, 0.020577378571033478, 0.013689612969756126, -0.0025739623233675957, 0.03554144129157066, 0.015765966847538948, 0.003923592157661915, 0.025703823193907738, -0.01350345741957426, 0.029025988653302193, 0.0012243324890732765, 0.010081053711473942, -0.0032093978952616453, 0.019617959856987, -0.024816002696752548, 0.009923537261784077, 0.016481950879096985, 0.02987084910273552, -0.00230188830755651, -0.061975568532943726, -0.0022875687573105097, -0.025145355612039566, -0.010324488393962383, -0.0007168789161369205, -0.045021068304777145, 0.0027869674377143383, -0.003198658348992467, -0.010403246618807316, 0.034510426223278046, -0.02139360085129738, 0.019603639841079712, 0.004374661948531866, -0.011756456457078457, 0.015966441482305527, 0.02252485416829586, -0.011491541750729084, 0.0005924766883254051, 0.013245702721178532, 0.004217145498842001, 0.012293444015085697, 0.008398491889238358, -0.0016592927277088165, -0.0005893443012610078, -0.014734949916601181, 0.021493837237358093, 0.041784822940826416, 0.0010775558184832335, 0.022066624835133553, 0.020090509206056595, -0.013746891170740128, -0.02132200077176094, 0.0008882675901986659, -0.02594725787639618, 0.010324488393962383, -0.030014047399163246, 0.010560763068497181, -0.03966550901532173, 0.00689850514754653, 0.012092968448996544, -0.006053644232451916, -0.015407973900437355, -0.002026234520599246, 0.004059629049152136, 0.0002461194817442447, 0.02759402059018612, -0.04487787187099457, -0.03917863965034485, 0.006304238457232714, -0.00273684854619205, -0.010267209261655807, -0.002219550311565399, 0.01217888668179512, -0.010954554192721844, -0.02480168454349041, 0.008126418106257915, 0.00466463528573513, 0.021794551983475685, -0.012422321364283562, -0.015264777466654778, 0.0316464900970459, 0.04613800346851349, 0.00927199237048626, 0.011713497340679169, -0.02384226582944393, -0.00797606073319912, -0.02550334855914116, 0.003930751699954271, -0.013231383636593819, -0.006823326926678419, -0.007106140721589327, -0.00993069726973772, -0.006221900228410959, 0.010689640417695045, -0.009357909671962261, 0.044391002506017685, 0.028954390436410904, -0.016725385561585426, -0.007990380749106407, -0.012350723147392273, 0.010267209261655807, 0.010890115983784199, -0.02803793177008629, -0.025102397426962852, -0.006526193581521511, 0.018901975825428963, -0.011942612007260323, -0.00398803036659956, 0.014591752551496029, 0.03216199949383736, -0.013353100046515465, 3.845616811304353e-05, -0.0003870788204949349, -0.0021103627514094114, -0.02316923998296261, 0.0032738365698605776, 0.014061925001442432, -0.014577432535588741, 0.031732406467199326, 0.02587565965950489, -0.0013344150502234697, -0.013023748062551022, -0.010668160393834114, 0.03473953902721405, 0.013746891170740128, -0.006762468256056309, -0.002590071875602007, 0.0030107125639915466, 0.048114120960235596, 0.011376984417438507, 0.006486814469099045, 0.005656273104250431, 0.03136009722948074, 0.004417621064931154, -0.04424780607223511, -0.008326893672347069, -0.03499729558825493, 0.022725330665707588, -0.017112016677856445, 0.02398546226322651, 0.023885224014520645, -0.01066100038588047, 0.048887383192777634, 0.0317610464990139, 0.016983138397336006, -0.01116218976676464, 0.002013704739511013, 0.007116880267858505, -0.012458120472729206, 0.017412729561328888, 0.010260050185024738, 0.007789905183017254, -0.02474440447986126, -0.005291121080517769, 0.012680075131356716, 0.02594725787639618, 0.01357505563646555, 0.008556008338928223, -0.010310168378055096, 0.0318756066262722, -0.012665756046772003, -0.007113300263881683, 0.046281203627586365, -0.0028370863292366266, 0.0004318278224673122, 0.017699122428894043, -0.027479464188218117, -0.018572622910141945, 0.021436559036374092, -0.009157435037195683, 0.034882739186286926, 0.004693274851888418, 0.0235272329300642, 0.015923483297228813, 0.02739354595541954, -0.038434017449617386, -0.011319706216454506, -0.013102506287395954, -0.006816166918724775, -0.013839969411492348, -0.006490394473075867, 0.014405597001314163, 0.015336375683546066, 0.0069092451594769955, -0.03625742718577385, 0.007861503399908543, 0.01974683627486229, 0.030042685568332672, 0.006540513131767511, -0.0017711652908474207, -0.012672916054725647, 0.002151531632989645, 0.0017228364013135433, -0.005452217534184456, 0.029469899833202362, -0.012035690248012543, 0.004510698840022087, -0.0009719482040964067, 0.013553575612604618, -0.000610823801252991, -0.06529773771762848, -0.0002452245098538697, 0.003331115236505866, 0.00860612653195858, 0.010482004843652248, 0.07423321157693863, -0.00039244871004484594, 0.025675183162093163, -0.03705932945013046, 0.015379334799945354, -0.02841024287045002, 0.010396086610853672, -0.010252890177071095, -0.04613800346851349, -0.0023716967552900314, -0.052925534546375275, -0.005309021100401878, -0.017040418460965157, 0.02909758687019348, 0.03857721388339996, 0.007610909175127745, -0.024085700511932373, 0.0408683642745018, 0.010252890177071095, -0.0017138865077868104, 0.013209903612732887, -0.016940180212259293, -0.017885278910398483, -0.009071516804397106, -0.02126472257077694, -0.02885415218770504, 0.003791135037317872, -0.0022965185344219208, -0.003205818124115467, 0.008620446547865868, 0.024529609829187393, -0.0007338835275731981, -0.035913754254579544, -0.012701555155217648, 0.0204341821372509, 0.026419807225465775, -0.00637583713978529, 0.00040967707172967494, 0.02137928083539009, -0.002219550311565399, 0.009637143462896347, -0.02700691483914852, 0.013553575612604618, 0.01817167177796364, 0.01582324504852295, 0.011155029758810997, 0.014964064583182335, 0.010181291960179806, -0.04464875906705856, -0.008298253640532494, -0.0016924070660024881, 0.0032774165738373995, -0.028567759320139885, -0.0076395487412810326, 0.0031055803410708904, -0.013911567628383636, -0.02998540736734867, -0.014047604985535145, 0.0014776118332520127, 0.016152597963809967, 0.017627524212002754, 0.008147897198796272, 0.04347454383969307, 0.012629956938326359, -0.007789905183017254, 0.007825704291462898, -0.013732572086155415, -0.004392561502754688, 0.03273478522896767, -0.007517831400036812, 0.023956822231411934, 0.008198016323149204, 0.007940261624753475, -0.020921051502227783, 0.04576569423079491, -0.014212281443178654, 0.022252781316637993, 0.011276747100055218, -0.022238461300730705, 0.030901866033673286, -0.003862733254209161, 0.011806575581431389, -0.005777990445494652, 0.020777853205800056, -0.0007898198091425002, 0.023326756432652473, -0.022295739501714706, 0.038491297513246536, -0.00032666767947375774, 0.012307764030992985, -0.007797065190970898, 0.0025560627691447735, 0.01911677047610283, 0.04333134740591049, -0.018629902973771095, -0.014641871675848961, -0.00044816118315793574, -0.028897112235426903, -0.04149843007326126, -0.008899680338799953, 0.021493837237358093, -0.03373716399073601, 0.014434236101806164, -0.02082081325352192, 0.002269668970257044, 0.028066569939255714, 0.0028120269998908043, 0.013102506287395954, -0.014162162318825722, 0.018128713592886925, -0.0016664526192471385, 0.02050578035414219, 0.00204055430367589, 0.008663405664265156, -0.006780367810279131, -0.004145546816289425, -0.021178804337978363, -0.005641953554004431, 0.016625147312879562, 0.019446123391389847, 0.0005575724644586444, 0.006114502903074026, -0.010281529277563095, 0.0087278438732028, 0.014820867218077183, -0.029326701536774635, 0.0423862487077713, -0.0026813598815351725, -0.006178941577672958, 0.0023913863115012646, 0.015837565064430237, -0.009050036780536175, -0.00958702526986599, 0.008169376291334629, -0.008684884756803513, 0.012579837813973427, -0.02941261976957321, 0.023699067533016205, 0.0019188369624316692, 0.00724575761705637, -0.02304036356508732, -0.0038412539288401604, 0.008026179857552052, -0.003474312135949731]",Online Speculative Decoding.pdf
"for proposing tokens, leading to notable speed gains even
with lower speculative accuracy.
Like draft model-based speculative decoding, SmartSpec
does not compromise performance even when the request
rate is high. This is because SmartSpec adopts a conservative
approach under high request rates, minimizing the wasteful
computation of verifying incorrect tokens. This strategy en-
sures that SmartSpec maintains its efficiency across varying
system loads.
7.2 Simulation Experiments
We conduct the following experiments using a simulator for
several reasons. First, efficiently integrating speculative de-
coding into a real-world system poses a substantial engineer-
ing challenge. For instance, devising an effective verificationkernel for tree-structured speculative decoding proves diffi-
cult. The absence of such a kernel negates the advantages of
speculative decoding. Additionally, we aim to explore how
the system behaves under various models, workloads, and
resource configurations. In particular, we are interested in
assessing how the accuracy of token acceptance prediction
affects overall performance. Moreover, carrying out com-
prehensive experiments across all possible configurations
is both time-consuming and cost-prohibitive. Consequently,
we utilize a simulator for all subsequent experiments.
Simulator construction. The design of the simulator is
closely aligned with the operational flow of vLLM [ 19], ac-
curately replicating its model scheduling and control logic.
The primary distinction between the simulator and actual
hardware lies in its use of an event clock to simulate kernel
execution times, allowing it to operate efficiently on CPUs
without the need for real GPU hardware. Essentially, the
simulator employs an event clock to replace all kernel ex-
ecution times while preserving all other operational logic.
To ensure the event clock advances accurately and reflects
realistic execution times, we have profiled GPU execution
times across various hardware configurations and model set-
tings utilized in the experiments. This approach allows us to
simulate real-world operations with high fidelity.
Simulator fidelity. The data we have collected for each job
allows our simulator to accurately model several system ef-
fects. This includes the performance impact of various sched-
uling policies and system overheads such as slow sampling
and Python overhead, identified through profiling. However,
11
DSDK=1K=3K=5
1 2 3 4 5 6 7 8 9 10
Request Rate0.00.51.01.52.0Speedup(a)PTL, Mistral 7B, CNN Mail
1 2 3 4 5 6 7 8 9 10
Request Rate0.00.81.62.43.2Speedup (b)PTL, Mistral 7B, HAGRID
1 2 3 4 5
Request Rate0.000.250.500.751.001.25Speedup
(c)PTL, Mixtral 8X7B, HAGRID
1 2 3 4 5
Request Rate0.00.30.60.91.21.5Speedup (d)PTL, Mixtral 8X7B, CNN Mail
Figure 12. Latency Measurement on PTL: Speedup across different datasets. X-axis: request rate.
5 10 15 20
Request Rate246810Average Request Latency (s)
P-128
S-128
P-256
S-256
P-512
S-512
Figure 13. Simulator Fidelity. This experiment was con-
ducted on a single Azure NC24ads machine equipped with
an A100-80G GPU. The labels ‚ÄòP‚Äô and ‚ÄòS‚Äô indicate profiled
and simulated data, respectively. The figure demonstrates
that the simulated average request latency closely mirrors
the measured latency across various input/output lengths
and request rates.
our simulator does not account for network latency. After
calibration, as shown in Fig. 13, the simulator demonstrates
an error rate below 10% when the request rate is lower than
the service rate. This accuracy is consistent across various
input/output lengths and request rates. It is important to
note that the simulator tends to under-predict latency when
the request rate exceeds the service rate due to its limited
ability to simulate queuing delays. For the subsequent exper-
iments presented in this paper, we will focus exclusively on
scenarios where the request rate is less than the service rate.
Using the simulator, we initially identify the discrepancy
between the current speedup and the optimal speedup, where
""optimal"" implies foreknowledge of the accepted length. Sub-
sequently, we implement tree-style speculative decoding
Medusa with continuous batching to test SmartSpec‚Äôs gener-
ality.
7.2.1 Accepted Length Prediction","[0.02055361121892929, 0.04022533819079399, 0.01598772220313549, -0.02200445532798767, -0.0032803991343826056, -0.0035133163910359144, -0.026143625378608704, 0.022388501092791557, 0.03089442476630211, -0.0010810204548761249, 0.017879508435726166, 0.01373322680592537, -0.05427860468626022, -0.012808669358491898, 0.02637120895087719, -0.0399693064391613, 0.013711890205740929, -0.007979637943208218, -0.00427074171602726, -0.010909771546721458, 0.015233853831887245, 0.01640021800994873, -0.011770321056246758, 0.0070052966475486755, 0.013555427081882954, -0.04844678193330765, 0.03197544440627098, 0.023839345201849937, 0.07043701410293579, -0.06275607645511627, -0.00741067947819829, -0.024123823270201683, -0.0031932773999869823, -0.0333409458398819, -0.0007596479845233262, 0.03689693287014961, 0.0009601167985238135, -0.005629129242151976, -0.018619153648614883, -0.011350714601576328, -0.025219067931175232, -0.02253074198961258, -0.08477476239204407, 0.00926690548658371, 0.029215998947620392, 0.037096068263053894, 0.023483745753765106, -0.00901087373495102, 0.010959555394947529, 0.0585457906126976, -0.05809062346816063, 0.023014355450868607, -0.031207352876663208, 0.034706443548202515, 0.011457393877208233, -0.010241245850920677, 0.009586944244801998, 0.033653873950242996, 0.029244447126984596, -0.001682871370576322, 0.01520540565252304, -0.027324212715029716, 0.0015032939845696092, -0.016073066741228104, -0.025617338716983795, 0.00030159225570969284, -0.003363964846357703, 0.051007095724344254, -0.003716007573530078, 0.03991241008043289, 0.0013379405718296766, -0.012282383628189564, 0.05248638615012169, -0.0270539578050375, -0.027935843914747238, 0.011407610028982162, 0.029187550768256187, 0.0673646405339241, 0.03925811126828194, -0.0003467088390607387, 0.004889483563601971, 0.007993861101567745, 0.024721229448914528, -0.043582189828157425, -0.020624730736017227, -0.024408303201198578, -0.02834833785891533, -0.010148790664970875, -0.013078924268484116, -0.012894012965261936, 0.00583893246948719, 0.014316408894956112, -0.021719975396990776, 0.019373023882508278, 0.02325616218149662, -0.016286425292491913, 0.023938912898302078, -0.05626995861530304, 0.023810897022485733, 0.04608560726046562, 0.05376654118299484, 0.013427411206066608, 0.031378038227558136, -0.03134959191083908, 0.07544384896755219, -0.013598098419606686, -0.03931500390172005, 0.033824559301137924, -0.01947259157896042, -0.007303999736905098, -0.03726675733923912, -0.024621661752462387, -0.0478493757545948, -0.0009156669839285314, -0.0019220116082578897, -0.02319926768541336, -0.08329546451568604, -0.032515957951545715, 0.030069436877965927, 0.0387175977230072, -0.011955232359468937, 0.010013663209974766, 0.03894518315792084, -0.012481519021093845, -0.015319197438657284, -0.005209522787481546, 0.03328404948115349, -0.10662274807691574, 0.003543542232364416, -0.004284965805709362, -0.022815220057964325, 0.011350714601576328, 0.05052347853779793, -0.0036911156494170427, 0.012460182420909405, -0.006596358027309179, -0.050893303006887436, -0.02455054223537445, 0.008057869039475918, 0.015859708189964294, -0.025788025930523872, -0.007844509556889534, 0.01040482148528099, 0.028575921431183815, -0.04574423283338547, 0.010554173029959202, -0.008868634700775146, 0.013555427081882954, -0.04696749150753021, 0.04110722243785858, -0.011300930753350258, -0.009999439120292664, -0.04756489768624306, -0.027551796287298203, 0.003159495536237955, -0.010667964816093445, -0.039684828370809555, 0.021449720486998558, -0.019131217151880264, -0.010696412064135075, -0.04719507694244385, 0.033824559301137924, -0.008093428798019886, 0.008939754217863083, 0.012915349565446377, 0.022260485216975212, -0.025517771020531654, -0.0003831577196251601, -0.08477476239204407, -0.022089798003435135, 0.027964292094111443, -0.015162733383476734, -0.00382268731482327, -0.022672981023788452, -0.017666149884462357, -0.009892758913338184, 0.005248638801276684, -0.05575789511203766, 0.037039171904325485, -0.042643409222364426, -0.05809062346816063, 0.032515957951545715, 0.0012268159771338105, 0.007229323964565992, -0.03206079080700874, -0.0374658927321434, -0.04827609658241272, 0.048361439257860184, 0.02153506502509117, 0.017210982739925385, 0.013839906081557274, 0.05735097825527191, 0.0576070100069046, -0.02206135168671608, -0.030695289373397827, -0.052088115364313126, 0.023967361077666283, 0.03720986098051071, -0.01832045055925846, 0.02829144150018692, 0.021008778363466263, 0.02797851525247097, 0.056355301290750504, -0.01884673722088337, 0.03757968172430992, 0.0020144672598689795, -0.0010285695316269994, -0.028021186590194702, -0.007417791523039341, 0.013662106357514858, 0.00921712163835764, 0.012943796813488007, 0.05675357207655907, -0.024251839146018028, -0.026797927916049957, 0.011948120780289173, -0.03442196547985077, 0.010063447058200836, -0.013086036778986454, 0.029187550768256187, 0.005835376679897308, 0.01539031695574522, 0.02881772816181183, 0.014309296384453773, -0.02086653932929039, 0.07231457531452179, 0.021037226542830467, 0.018960529938340187, -0.012815781868994236, -0.035531435161828995, 0.027494899928569794, 0.038233984261751175, 0.0027345549315214157, -0.02004154957830906, 0.03379611298441887, -0.018818289041519165, 0.00788718182593584, -0.016627801582217216, -0.0292728953063488, -0.07345249503850937, -0.00854148343205452, 0.013121596537530422, 0.029528925195336342, -0.010504389181733131, -0.02506260573863983, 0.0016055286396294832, -0.05029589682817459, -0.048361439257860184, 0.028149202466011047, 0.03277198597788811, -0.04955625161528587, -0.06651120632886887, -0.05962681025266647, -0.022189365699887276, -0.04984072968363762, 0.016115738078951836, -0.0057464768178761005, 0.0048396997153759, -0.021520840004086494, -0.014963597990572453, 0.00769515847787261, -0.05393723025918007, -0.03607194498181343, 0.017139863222837448, -0.03078063391149044, -0.02149239182472229, -0.01665624789893627, -0.013939473778009415, 0.0013539425563067198, -0.027068182826042175, 0.029557373374700546, 0.025418203324079514, 0.004452097229659557, 0.01430218480527401, -0.036925382912158966, -0.047422658652067184, 0.00741067947819829, 0.017637701705098152, -0.0440373569726944, 0.023426849395036697, -0.011585409753024578, -0.013704778626561165, 0.026513447985053062, 0.017324773594737053, -0.0023736220318824053, 0.019429920241236687, 0.02969961427152157, -0.020283356308937073, 0.005245082546025515, -0.026399657130241394, 0.015248076990246773, -0.009871423244476318, 0.015262301079928875, -0.050381239503622055, 0.05134847015142441, 0.014494207687675953, 0.004537440836429596, 0.00010145678970729932, -0.027850499376654625, -0.03575901687145233, 0.08870057016611099, -0.0046014487743377686, 0.032885778695344925, -0.0038262433372437954, -0.018092868849635124, 0.017865285277366638, -0.014451536349952221, -0.003260841127485037, 0.00034426411730237305, -0.020539388060569763, -0.002087365137413144, 0.01770882122218609, -0.04540285840630531, 0.0047081285156309605, -0.017139863222837448, -0.07208698987960815, 0.047735586762428284, -0.05974060297012329, 0.030382363125681877, -0.027651363983750343, -0.013093148358166218, -0.0187329463660717, -0.02319926768541336, 0.00197179545648396, 0.04611405357718468, -0.028789279982447624, -0.019287679344415665, -0.007688046433031559, -0.01456532720476389, -0.012367727234959602, 0.01624375395476818, 0.020525163039565086, 0.015717467293143272, -0.01409593690186739, -0.028405234217643738, -0.033454738557338715, -0.02662723883986473, 0.0035915481857955456, 0.028006963431835175, 0.02989874966442585, -0.04713818058371544, 0.012830005027353764, -0.0044485414400696754, -0.012133032083511353, 0.0037622356321662664, 0.007133312523365021, 0.03359697759151459, -0.0054762219078838825, 0.10423312336206436, 0.02482079714536667, -0.0292728953063488, -0.013349180109798908, 0.07561453431844711, -0.016414441168308258, 0.018178211525082588, -0.010198574513196945, 0.006955512799322605, -0.045345962047576904, -0.07800415903329849, 0.0009076659916900098, -0.014060377143323421, 0.05319758504629135, 0.014835583046078682, 0.02480657398700714, 0.0004331638047005981, 0.01425240095704794, -0.027395332232117653, 0.010191462002694607, -0.026584567502141, -0.004295633640140295, 0.0043525295332074165, 0.09911250323057175, -0.0019166776910424232, -0.006614137906581163, -0.006642586085945368, -0.03732365369796753, -0.0019309015478938818, 0.04292789101600647, -0.0005329537088982761, 0.034336622804403305, 0.02211824618279934, 0.009693623520433903, 0.008392131887376308, -0.025972938165068626, 0.01800752431154251, 0.014074601233005524, -3.6115503462497145e-05, -0.0030154779087752104, -0.0755007416009903, -0.02713930234313011, -0.02492036484181881, -0.014152833260595798, -0.00712620047852397, 0.0025034158024936914, 0.005533117800951004, 0.029756508767604828, 0.0019326795591041446, 0.03171941637992859, 0.04696749150753021, 0.02190488763153553, 0.009487376548349857, -0.02294323593378067, -0.04386667162179947, -0.02501993253827095, -0.014849807135760784, 0.014259512536227703, 0.02200445532798767, 0.019060097634792328, 0.04506148397922516, 0.03413748741149902, 0.029756508767604828, -0.049243323504924774, 0.04511837661266327, -0.04719507694244385, 0.0038333553820848465, -0.01790795661509037, 0.007652486674487591, 0.03837622329592705, 0.041704628616571426, 0.05470532178878784, -0.019486814737319946, -0.042956337332725525, -0.022132471203804016, -0.023896241560578346, -0.05575789511203766, -0.022971684113144875, 0.0032092793844640255, -0.01539031695574522, 0.052969999611377716, -0.05996818467974663, -0.0427856482565403, 0.017879508435726166, 0.05405101925134659, -0.036100391298532486, -0.018661826848983765, 0.0165140088647604, 0.020098445937037468, -0.0050921752117574215, -0.008235668763518333, -0.03328404948115349, -0.02403848059475422, -0.01110890693962574, -0.016485560685396194, 0.027594467625021935, -0.020838091149926186, -0.0003993819118477404, -0.027893170714378357, -0.006062959786504507, 0.02501993253827095, -0.008633939549326897, 0.0110093392431736, -0.008534371852874756, 0.00626920722424984, -0.0021727087441831827, -0.04696749150753021, -0.05632685124874115, 0.08773334324359894, -0.03385300934314728, 0.04224513843655586, 0.003509760368615389, 0.013434523716568947, 0.009594055823981762, -0.049698490649461746, -0.03664090111851692, -0.0014561772113665938, -0.015191181562840939, 0.030439259484410286, 0.03627108037471771, 0.02284366823732853, 0.04688214883208275, 0.020311804488301277, -0.04221669211983681, 0.016272202134132385, -0.019643278792500496, 0.006375886965543032, 0.01827777922153473, 0.03191855177283287, 0.0036111059598624706, 0.04776403307914734, -0.03686848655343056, -0.011713424697518349, -0.029813405126333237, 0.041192568838596344, 0.02813497930765152, 0.037921059876680374, 0.07100597023963928, 0.04639853537082672, -0.00674926582723856, -0.03183320537209511, -0.033767662942409515, -0.0193587988615036, -0.04523216933012009, 0.06582845002412796, -0.018092868849635124, 0.016257978975772858, -0.004900151863694191, 0.013384739868342876, 0.011941008269786835, 0.00423162616789341, 0.02092343382537365, 0.02662723883986473, -0.030979769304394722, -0.006400778889656067, -0.0031097116880118847, 0.004544552881270647, -0.014622223563492298, -0.004939267411828041, -0.002677659038454294, -0.004960603546351194, 0.0105399489402771, -0.014451536349952221, 0.00018535587878432125, -0.0011912561021745205, 0.02501993253827095, -0.026186296716332436, -0.006962624844163656, -0.03467799723148346, -0.0015024050371721387, 0.0048539238050580025, -0.018647601827979088, -0.00926690548658371, -0.02066740393638611, -0.006333215162158012, 0.008370796218514442, 0.022516516968607903, -0.02964271791279316, -0.01812131516635418, -0.14019127190113068, -0.020226461812853813, -0.020169565454125404, 0.004331193398684263, -0.04329771175980568, 0.00021913777163717896, 0.010902659967541695, -0.02652767114341259, 0.015603676438331604, -0.007716494612395763, -0.006144747603684664, -0.03752278909087181, -0.014949374832212925, 0.012033464387059212, 0.0031488274689763784, 0.02809230610728264, -0.0006716372445225716, -0.0005969615303911269, -0.017509685829281807, 0.009942542761564255, -0.008207220584154129, -0.011144466698169708, -0.015191181562840939, 0.029813405126333237, -0.027907395735383034, 0.0478493757545948, 0.011123131029307842, -0.003908031154423952, 0.03385300934314728, 0.004491213243454695, 0.0004822809132747352, -0.033198706805706024, -0.01068930048495531, -0.009821639396250248, -0.018804065883159637, -0.010859987698495388, -0.01847691461443901, 0.0021389268804341555, 0.011044899001717567, 0.006013175938278437, -0.02901686355471611, 0.02891729585826397, 0.03649866208434105, -0.020838091149926186, -0.006290543358772993, 0.011727648787200451, -0.0017842170782387257, 0.030865978449583054, -0.0292728953063488, -0.015361868776381016, -0.015646347776055336, 0.0019842414185404778, 0.015162733383476734, -0.005355318076908588, -0.008029421791434288, 0.007432015147060156, 0.0024038481060415506, -0.03689693287014961, 0.027551796287298203, 0.00569669296965003, 0.02476390264928341, -0.002883906476199627, -0.002275832463055849, 0.028618592768907547, 0.0016393105033785105, 0.013370515778660774, -0.018363123759627342, -0.025560442358255386, -0.0033888567704707384, 0.024024255573749542, -0.02507682889699936, -0.04366753622889519, -0.006308323238044977, 0.02117946557700634, -0.002901686355471611, 0.001201034989207983, 0.019657501950860023, -0.02497726120054722, 0.004295633640140295, -0.018235107883810997, 0.004224514123052359, 0.03814864158630371, -0.024906141683459282, 0.006407890934497118, 0.015817034989595413, 0.0009405589080415666, -0.03445041552186012, -0.03954258933663368, 0.006190975662320852, -0.03046770766377449, -0.016528233885765076, 0.03373921662569046, 0.00546199781820178, 0.0031719414982944727, -0.03180475905537605, 0.003989818971604109, 0.003116823732852936, 0.020069997757673264, -0.0006014065002091229, -0.0023540642578154802, -0.012438846752047539, -0.005234414711594582, 0.01164941769093275, 0.012325054965913296, 0.02346952259540558, 0.024678558111190796, 0.016073066741228104, 0.003972038626670837, 0.02325616218149662, -0.002455409849062562, 0.006539462134242058, -0.023896241560578346, -0.018562259152531624, 0.0004898373736068606, 0.038746047765016556, -0.009053546003997326, -0.04164773225784302, -0.007524471264332533, -0.0182635560631752, 0.012709101662039757, 0.01800752431154251, 0.024792348966002464, -0.021207913756370544, -0.05112088471651077, -0.01951526291668415, 0.04198911041021347, 0.04068050533533096, 0.03109356015920639, -0.02098033018410206, -0.007133312523365021, -0.02605828084051609, 0.005188186652958393, -0.026499224826693535, -0.0037657914217561483, 0.005120622925460339, -0.05709494650363922, 0.019913533702492714, 0.00048094740486703813, 0.03510471433401108, 0.03001254051923752, 0.016314873471856117, 0.01978551782667637, -0.01357676275074482, -0.04161928594112396, 0.042273588478565216, 0.03740899637341499, -0.015376092866063118, 0.00437386566773057, -0.008712170645594597, -0.008086317218840122, -0.05200277268886566, -0.00569669296965003, 0.032572850584983826, -0.0472235232591629, 0.012801557779312134, -0.05171829089522362, -0.02049671672284603, 0.002519417554140091, 0.01520540565252304, 0.00901087373495102, 0.0302116759121418, 0.018932081758975983, -0.011898336932063103, -0.0028643484693020582, -0.0028625705745071173, 0.02196178399026394, -0.03988396376371384, 0.0012614867882803082, -0.008989538066089153, -0.0007289775530807674, 0.019757069647312164, 0.0017744380747899413, -0.030496153980493546, -0.02351219393312931, 0.05683891475200653, 0.020681627094745636, -0.025048380717635155, 0.00721509987488389, -0.021762648597359657, 0.001767326146364212, -0.010205686092376709, 0.06150437146425247, -0.02051093988120556, 0.003911586944013834, 0.020937658846378326, -0.030040988698601723, -0.001500627025961876, -0.03487713262438774, 0.010049222968518734, -0.028831953182816505, -0.019600607454776764, -0.011948120780289173, -0.04417959600687027, -0.03794950619339943, 0.010625292547047138, -0.03083753027021885, 0.012239711359143257, -0.007780502084642649, -0.015916602686047554, 0.012595309875905514, 0.04272875562310219, -0.007638262584805489, 0.037665028125047684, 0.023938912898302078, 0.010241245850920677, 0.018960529938340187, -0.032515957951545715, 0.006482566706836224, -0.01344163529574871, -0.02429451048374176, -0.011144466698169708, -0.006013175938278437, -0.013043364509940147, 0.030183227732777596, -0.02372555248439312, -0.024123823270201683, 0.017011847347021103, 0.010795979760587215, -0.01012034248560667, -0.02984185330569744, 0.022900564596056938, 0.003292845096439123, 0.010163013823330402, -0.021350152790546417, 0.013121596537530422, -0.005213078577071428, 0.002490969840437174, 0.0232988353818655, -0.022815220057964325, 0.018448466435074806, 0.03078063391149044, -0.010056334547698498, -0.021520840004086494, -0.002437629969790578, 0.02932978980243206, -0.012815781868994236, 0.04406580701470375, 0.004149838350713253, 0.016229530796408653, -0.02029758132994175, -0.003479534527286887, 0.04480545222759247, 0.017879508435726166, 0.013142932206392288, -0.03436506912112236, -0.0034439745359122753, 0.019757069647312164, 0.05368119850754738, 0.0006400778656825423, -0.011400498449802399, 0.00931668933480978, 0.018932081758975983, 0.0427856482565403, -0.023796673864126205, -0.04287099465727806, -0.02496303804218769, -0.0025994274765253067, -0.03328404948115349, 0.030609946697950363, -0.025660010054707527, 0.021933335810899734, -0.02668413519859314, -0.03214613348245621, -0.03191855177283287, 0.00034604209940880537, -0.0333409458398819, 0.0005365097313188016, 0.004821919836103916, -0.004210290033370256, -0.010667964816093445, -0.12005016207695007, -0.020183788612484932, 0.017410118132829666, -0.014892478473484516, 0.02253074198961258, -0.018149763345718384, 0.03482023626565933, -0.0025069715920835733, -0.012531302869319916, -0.01098089199513197, 0.04318391904234886, -0.0339667983353138, -0.020212236791849136, -0.03083753027021885, 0.007375119719654322, -0.04457786679267883, -0.021108346059918404, -0.021151017397642136, 0.029031088575720787, -0.029159102588891983, 0.0005445106653496623, -0.018092868849635124, -0.024778125807642937, 0.006923508830368519, 0.020880762487649918, -0.014287960715591908, -0.02378244884312153, 0.00480058416724205, 0.004142726305872202, -0.008833074942231178, 0.010013663209974766, 0.024792348966002464, 0.0062158675864338875, 0.03868915140628815, -0.033454738557338715, 0.002739888848736882, -0.013761674053966999, -0.02870393730700016, 0.02674103155732155, 0.009722071699798107, 0.019387247040867805, -0.02174842357635498, 0.02482079714536667, 0.0018971196841448545, 0.02601560950279236, -0.03160562366247177, -0.01696917600929737, -0.0002691438712645322, -0.018363123759627342, -0.00835657212883234, -0.01723943091928959, 0.006589245982468128, 0.0057180291041731834, -0.007844509556889534, -0.003854691283777356, 0.018491137772798538, 0.01686960831284523, -0.004014710895717144, -0.008626827038824558, 0.00884729903191328, -0.008114765398204327, 0.05134847015142441, 0.01718253456056118, -0.015120062045753002, -0.014679118990898132, -0.009387808851897717, 0.007069304585456848, 0.007311111781746149, 0.026356983929872513, -0.027864724397659302, -0.008079205639660358, 0.03206079080700874, 0.0242376159876585, 0.019060097634792328, 0.026399657130241394, 0.041135672479867935, -0.010447493754327297, 0.010760420002043247, -0.05939922854304314, -0.009473152458667755, 0.04068050533533096, -0.03629952669143677, -0.0014037262881174684, -0.022331606596708298, 0.017097191885113716, -0.012566862627863884, 0.050381239503622055, -0.007207988295704126, 0.0002079141850117594, 0.02787894755601883, 0.026342760771512985, -0.026456551626324654, -0.0019397916039451957, -0.009430481120944023, -0.023768225684762, -0.03152028098702431, -0.01030525378882885, -0.007538694888353348, -0.005785592831671238, 0.006365218665450811, 0.05092174932360649, 0.041192568838596344, 0.002071363152936101, -0.05527428165078163, 0.02102300152182579, 0.013384739868342876, 0.010760420002043247, -0.025261739268898964, 0.01706874370574951, 0.028063859790563583, 0.012033464387059212, 0.023213490843772888, 0.01110890693962574, 0.015518332831561565, 0.015859708189964294, -0.010497277602553368, 0.04110722243785858, -0.016428666189312935, 0.012566862627863884, -0.02025490812957287, 0.011272482573986053, 0.03843311965465546, -0.03567367419600487, 0.025660010054707527, -0.04870281368494034, 0.008655275218188763, 0.019842414185404778, 0.016798488795757294, -0.0059740603901445866, 0.006439894437789917, -0.03083753027021885, 0.06030955910682678, -0.015561004169285297, 0.007894293405115604, 0.003787127323448658, -0.0029941420070827007, -0.006162527482956648, 0.011571185663342476, -0.005213078577071428, 0.008833074942231178, 0.001849113847129047, 0.017936404794454575, -0.000825878232717514, 0.002178042661398649, -0.008164549246430397, 0.0017904400592669845, 0.0036555558908730745, 0.0011379162315279245, -0.0048325881361961365, -0.006752821616828442, -0.00398626271635294, -0.016883831471204758, -0.001991353463381529, -0.024493645876646042, 0.0192023366689682, 0.017523908987641335, -0.03971327468752861, -0.01894630491733551, -0.006087851710617542, 0.008399244397878647, 0.029870301485061646, 0.03681159019470215, -0.009003762155771255, 0.005124179180711508, 0.008577043190598488, -0.03447886183857918, -0.04173307865858078, 0.0025745355524122715, -0.014444423839449883, 0.008150325156748295, 0.01775149255990982, -0.029002640396356583, 0.03957103565335274, 0.01110890693962574, 0.043212369084358215, 0.019799742847681046, -0.0193587988615036, 0.019387247040867805, -0.0015246298862621188, 0.034080591052770615, 0.007652486674487591, -0.006589245982468128, -0.003054593922570348, -0.0027327770367264748, 0.061959538608789444, -0.03800640255212784, 0.0032981790136545897, 0.04656922072172165, 0.00016990955919027328, 0.016912279650568962, -0.007880070246756077, 0.038120195269584656, -0.01593082770705223, 0.0405951626598835, 0.009949655272066593, 0.0002546976611483842, 0.005394434090703726, 0.01300780475139618, -0.019657501950860023, -0.017196759581565857, -0.03863225504755974, 0.022203590720891953, -0.03513316437602043, 0.0005418437067419291, 0.004821919836103916, 0.004117834381759167, 0.012630869634449482, 0.022644532844424248, -0.029728060588240623, -0.0009423368610441685, -0.036669351160526276, 0.010995115153491497, -0.02506260573863983, 0.044350285083055496, -0.03248750790953636, -0.016442889347672462, 0.026954390108585358, 0.0027078851126134396, -0.03675469383597374, 0.004064494743943214, -0.044464077800512314, -0.0182635560631752, -0.027637140825390816, -0.02529018744826317, -0.03675469383597374, 0.020752746611833572, 0.0015593008138239384, 0.021819543093442917, -0.041505493223667145, 0.004523217212408781, 0.020212236791849136, 0.020738523453474045, 0.017168311402201653, -0.039997756481170654, 0.002160262782126665, -0.019330352544784546, 0.0040929424576461315, 0.0028341226279735565, -0.012851341627538204, 0.013839906081557274, -0.005344650242477655, -0.0019131216686218977, -0.02813497930765152, -0.011123131029307842, 0.02580225095152855, -0.013100260868668556, 0.017737269401550293, 0.026869047433137894, -0.015689019113779068, -0.008128989487886429, -0.0009218899649567902, 0.018178211525082588, 0.012189927510917187, -0.004619228653609753, 0.0005791815929114819, -0.021876439452171326, 0.0006400778656825423, 0.03763657808303833, 0.038120195269584656, 0.03800640255212784, -0.03126424923539162, -0.01529074925929308, 0.004046714399009943, -0.008349460549652576, 0.024408303201198578, -0.03695382922887802, -0.01058973278850317, 0.012509966269135475, 0.0035293183755129576, -0.0042387377470731735, -0.02601560950279236, 0.016101514920592308, -0.0006800827686674893, 0.04375287890434265, 0.006582133937627077, -0.0022278265096247196, 0.01025546994060278, -0.027694035321474075, 0.002242050599306822, -0.018448466435074806, -0.014892478473484516, -0.021990230306982994, -0.01630065031349659, -0.019344575703144073, 0.014906702563166618, -0.03373921662569046, -0.010881324298679829, -0.0041285022161901, 0.025603115558624268, 0.002919466234743595, 0.04526061937212944, 0.050324346870183945, 0.00579981692135334, -0.013349180109798908, -0.0324021652340889, -0.012573974207043648, 0.009935431182384491, 0.019842414185404778, 0.020596284419298172, -0.022971684113144875, 0.016898056492209435, 0.017794165760278702, -0.012431735172867775, -0.027068182826042175, 0.03723830729722977, 0.025261739268898964, 0.0210798978805542, -0.013754562474787235, -0.033568527549505234, -0.02829144150018692, -0.004348973743617535, 0.0243940781801939, 0.047365762293338776, 0.03738054633140564, 0.006578578148037195, 0.0003967149241361767, 0.0192023366689682, -0.006358107086271048, 0.011286706663668156, 0.0013770564692094922, -0.006884393282234669, 0.015162733383476734, -0.0024874138180166483, -0.00983586348593235, -0.010483053512871265, -0.008185884915292263, -0.0020304692443460226, -0.02600138634443283, -0.005518893711268902, 0.009323800913989544, -0.00451610516756773, 0.02071007527410984, 0.029415134340524673, -0.0016001947224140167, -0.024735454469919205, 0.0029141323175281286, -0.01211880799382925, -0.005053059197962284, -0.0007227546302601695, -0.009323800913989544, 0.003982706926763058, 0.021577736362814903, -0.00560779357329011, 0.007446239236742258, -0.024408303201198578, -0.003635997883975506, 0.007289775647222996, -0.014337744563817978, -0.013462970964610577, -0.03530384972691536, 0.0818161740899086, -0.0002811453305184841, -0.01206902414560318, -0.006564354058355093, -0.004861035849899054, 0.001727321301586926, -0.0007151981117203832, -0.026911718770861626, -0.02684059925377369, -0.0006116299773566425, -0.0010845763608813286, 0.028590144589543343, 0.013875465840101242, 0.019429920241236687, 0.027679812163114548, -0.011663640849292278, -0.0057180291041731834, 0.014323520474135876, 0.02678370289504528, 0.02829144150018692, 0.030609946697950363, 0.001893563661724329, 0.0073608956299722195, 0.010788868181407452, -0.04602871090173721, 0.005565121304243803, 0.004821919836103916, 0.006315434817224741, 0.02082386612892151, 0.023085474967956543, 0.013996369205415249, 0.01139338593930006, -0.039002079516649246, 0.018405795097351074, -0.014494207687675953, -0.017936404794454575, -0.024792348966002464, 0.024934589862823486, -0.024721229448914528, -0.007865846157073975, -0.01482135895639658, -0.02227471023797989, 0.025347083806991577, 0.027750931680202484, -0.0064967903308570385, 0.036726247519254684, 0.0027736707124859095, -0.0017833281308412552, 0.008228556253015995, 0.003266175277531147, 0.0509786456823349, -0.01134360209107399, 0.013797233812510967, -0.00898242648690939, 0.01154984999448061, -0.012317943386733532, 0.02304280363023281, 0.024365631863474846, 0.01915966533124447, -0.0076098148711025715, -0.029671166092157364, -0.013114484027028084, -0.039940860122442245, -0.016428666189312935, 0.003932923078536987, -0.03723830729722977, -0.004156950395554304, 0.003908031154423952, -0.00019880196487065405, 0.029728060588240623, -0.02129325643181801, 0.01492092665284872, 0.0040929424576461315, -0.012424622662365437, 0.01806442067027092, 0.01738166995346546, -0.006752821616828442, 0.008605491369962692, 0.026356983929872513, 0.00375156756490469, -0.01749546267092228, 0.02610095404088497, -0.023241939023137093, 0.0007329780492000282, -0.027864724397659302, 0.02870393730700016, 0.0396563820540905, -0.002565645379945636, 0.0039044751320034266, 0.016642024740576744, -0.027338437736034393, -0.015532556921243668, 0.01759503036737442, -0.03214613348245621, 0.010938219726085663, -0.020795419812202454, -0.005522449500858784, -0.03422283008694649, 0.005429993849247694, 0.013356291688978672, -0.014472872018814087, -0.022032903507351875, 0.006059403996914625, -0.007680934388190508, -0.011670753359794617, 0.022402726113796234, -0.053652748465538025, -0.05538807064294815, 0.02382512018084526, -0.012495742179453373, -0.023583313450217247, 0.0063616628758609295, 0.013868354260921478, -0.029301343485713005, -0.0024518538266420364, 0.02730998955667019, 0.0010756864212453365, 0.019031649455428123, -0.007467575371265411, -0.006450562737882137, 0.041078776121139526, 0.028049634769558907, 0.0041142781265079975, -0.011976568028330803, -0.03206079080700874, -0.025944489985704422, -0.024849245324730873, -9.716460226627532e-06, -0.0064754546619951725, -0.01780838891863823, 0.007368007674813271, -0.015376092866063118, -0.006432782858610153, 0.0029745842330157757, -0.008833074942231178, 0.049812283366918564, 0.009416257031261921, -0.013555427081882954, -0.0052166348323225975, -0.022985907271504402, 0.008413468487560749, 0.020752746611833572, -0.020838091149926186, -0.03152028098702431, -0.01315715629607439, 0.02049671672284603, 0.0006463008467108011, -0.007403567433357239, 0.025716906413435936, 0.023654432967305183, -0.005668245255947113, -0.00030092548695392907, 0.013654994778335094, -0.014465760439634323, -0.018035972490906715, 0.007019520737230778, 0.012481519021093845, -0.007545806933194399, 0.0215492881834507, 0.024522094056010246, -0.002274054568260908, -0.020596284419298172, -0.020013101398944855, 0.037807267159223557, 0.021193690598011017, -0.0028536806348711252, -0.011805880814790726, 0.008719283156096935, 0.04287099465727806, 0.0011325821978971362, 0.01869027316570282, 0.01738166995346546, 0.020951882004737854, 0.0187329463660717, -0.03390990197658539, -0.010177237913012505, -0.02139282412827015, 0.04193221405148506, -0.027338437736034393, 0.029984092339873314, 0.030382363125681877, -0.0005160627770237625, 0.01957215927541256, 0.027366885915398598, 0.00375156756490469, -0.005387322045862675, 0.006742153782397509, 0.0002064695581793785, 0.001817998941987753, 0.006567910313606262, 0.01661357656121254, 0.011400498449802399, -0.022758323699235916, -0.004313413519412279, 0.011585409753024578, 0.006222979165613651, 0.003996930550783873, 0.003427972551435232, -0.012033464387059212, 0.013121596537530422, -0.01164941769093275, -0.0026812150608748198, 0.030382363125681877, -0.008968202397227287, -0.006190975662320852, 0.03109356015920639, -0.024465199559926987, -0.02829144150018692, 0.005088618956506252, -0.0057180291041731834, 0.010049222968518734, 0.010056334547698498, -0.004939267411828041, 0.012474406510591507, 0.021008778363466263, -0.03305646777153015, 0.0007663154392503202, -0.018974753096699715, 0.002633209340274334, -0.012154367752373219, 0.013000693172216415, 0.023867793381214142, 0.010817316360771656, 0.010988003574311733, -0.023441074416041374, -0.0006418558768928051, 0.02637120895087719, 0.018306227400898933, 0.0005445106653496623, -0.009978102520108223, 0.0002204712654929608, 0.009771855548024178, 0.002627875190228224, -0.014992046169936657, 0.030240124091506004, -0.018420018255710602, -0.004078718367964029, -0.01529074925929308, 0.021478168666362762, -0.0014081713743507862, -0.048247646540403366, -0.004857480060309172, 0.011670753359794617, 0.03752278909087181, 0.01105912309139967, 0.04332616180181503, 0.016642024740576744, 0.019131217151880264, -0.023697106167674065, -0.006180307362228632, -0.021990230306982994, 0.011272482573986053, -0.006418558768928051, -0.06469053775072098, 0.01201924029737711, -0.035531435161828995, 0.012396174483001232, -0.005241526756435633, 0.03399524837732315, 0.03348318487405777, 0.020539388060569763, -0.01925923116505146, 0.04102187976241112, -0.010177237913012505, 0.014579551294445992, 0.0188894085586071, -0.015404541045427322, -0.011116019450128078, -0.008100541308522224, -0.025005709379911423, -0.011877000331878662, -0.008434804156422615, -0.00988564733415842, -0.00903221033513546, 0.035019371658563614, 0.0160446185618639, -0.010781756602227688, -0.026086729019880295, -0.01671314425766468, 0.006365218665450811, 0.0402822345495224, -0.01305758859962225, -0.015617900528013706, 0.007204432040452957, -0.017523908987641335, 0.0059847282245755196, -0.02335572987794876, -0.00036782253300771117, -0.0014748461544513702, 0.04033913090825081, 0.018505362793803215, 0.013462970964610577, 0.01209747139364481, -0.02958582155406475, 0.006909285206347704, -0.005053059197962284, 0.011585409753024578, -0.02169152721762657, -0.004562332760542631, 0.0025780913420021534, -0.026086729019880295, -0.02688327059149742, -0.003294622991234064, 0.008221444673836231, 0.019799742847681046, 0.0014019483933225274, -0.001473957090638578, 0.03317025676369667, 0.014764462597668171, -0.011421834118664265, 0.011414722539484501, 0.012787333689630032, 4.23662640969269e-05, 0.017111415043473244, 0.006887949071824551, 0.01822088286280632, 0.014124385081231594, -0.0017335442826151848, -0.010603956878185272, 0.06082162261009216, -0.004971271380782127, 0.018932081758975983, 0.023526417091488838, -0.03629952669143677, 0.013818570412695408, 0.0009441148722544312, 0.027295764535665512, -0.012154367752373219, 0.004711684305220842, 0.015461436472833157, 0.0058496007695794106, -0.01500627025961876, 0.041562389582395554, -0.0035239842254668474, 0.019600607454776764, 0.01440175250172615, -0.009117553941905499, 0.004775692243129015, 0.0402822345495224, -0.019017424434423447, -0.02408115193247795, 0.0036199958994984627, -0.018917856737971306, -0.03718141093850136, -0.01712564006447792, 0.014579551294445992, -0.02881772816181183, -0.002115813083946705, -0.018818289041519165, 0.013975033536553383, 0.035531435161828995, 0.010468829423189163, 0.007880070246756077, 0.01201924029737711, 0.004494769033044577, 0.005141959059983492, 0.026968615129590034, 0.007510247174650431, 0.010852876119315624, 0.0071013085544109344, 0.00934513658285141, -0.023128148168325424, 0.010625292547047138, 0.019131217151880264, 0.02002732641994953, -0.0019433475099503994, 0.0018242219230160117, -0.003189721377566457, -0.012943796813488007, 0.0070052966475486755, -0.03536074608564377, 0.033568527549505234, 0.0006458563730120659, -0.014835583046078682, -0.0002158040297217667, 0.006582133937627077, -0.006365218665450811, -0.02913065440952778, -0.001893563661724329, 0.0030297019984573126, 0.044520970433950424, -0.03416593372821808, 0.03800640255212784, -0.017879508435726166, 0.010362149216234684, -0.018491137772798538, -0.01708296686410904, 0.009665176272392273, -0.016073066741228104]",Online Speculative Decoding.pdf
" and Speedup In this
section, we explore how the accuracy of acceptance modeling
Rate = 1 Rate = 6 Rate = 110.00.51.01.52.0SpeedupRandom
DSD
OracleFigure 14. Optimal speedup vs SmartSpec speedup. Smart-
Spec means we use moving average to predict the goodput
and use goodput to guide the decision. Random all means we
randomly predict the accepted length without using good-
put.
impacts computational speedup. We keep the request rate
constant to ensure a controlled comparison of different ac-
ceptance prediction techniques. We assess the effectiveness
of SmartSpec‚Äôs accepted length prediction, which employs a
moving average based on historical token acceptance rates,
and compare it to an oracle. This oracle assumes access to a
perfect predictor and uses the actual accepted lengths to cal-
culate goodput and determine the optimal proposed length.
As shown in Figure 14, there is a noticeable performance
gap between SmartSpec‚Äôs speedup and that of the oracle. De-
veloping a more efficient accepted length predictor remains
an area for future research. However, it is important to note
that, even with the moving average approach, the speedup
achieved by SmartSpec is substantial and represents a sig-
nificant improvement over strategies that rely on random
proposals.
7.2.2 Tree-style Speculative Decoding In this section,
we evaluate the applicability of SmartSpec to Medusa [ 4],
a tree-style speculative decoding method. Prior to integrat-
ing SmartSpec, Medusa could only be implemented with a
12
2.5 5.0 7.5 10.0
Request Rate0246810Average Request Latency (s)
(a)ùõº=0.6
2.5 5.0 7.5 10.0
Request Rate0246810Average Request Latency (s)
 (b)ùõº=0.8
Figure 15. Average request latency of Medusa with fixed
top k values and SmartSpec: Simulating the performance
of Llama-7B with three fixed heads across 500 randomly
sampled requests of varying input/output Lengths under
different request rates. ùõº: token acceptance rate of candidate
tokens across all heads.
batch size of 1. To test the enhanced capabilities, we simulate
Medusa with continuous batching and assess its performance
both with and without SmartSpec integration. For our ex-
periments, we maintain a consistent token acceptance rate
across all Medusa heads and for all tokens within the top-k
selection. Additionally, we model Medusa with dense con-
nectivity, ensuring that each of the top-k nodes is linked to
the corresponding top-k tokens at the subsequent position.
We illustrate the average request latency across various
k-values under differing token acceptance rates in Fig. 16. As
demonstrated in the figure, the tree-style speculative decod-
ing method substantially increases request latency at high
request rates. This outcome aligns with expectations out-
lined in [ 4], which describes how dense connections among
different heads greatly increase the the number of batched to-
kens. As shown in Figs. 16a and 16b, fixed top2/top3 Medusa
quickly explode the batch size. Specifically, the number of
batched tokens per request is represented by√çùêª
‚Ñé=1Œ†‚Ñé
ùëñ=1ùë†ùëñ,
whereùë†ùëñdenotes the number of tokens sampled by head ùëñ.
For example, selecting 3, 2, and 2 tokens for heads 1, 2, and 3,
respectively, results in the addition of 21 tokens in the next
batch for verification (calculated as 3+3√ó2+3√ó2√ó2).
Conversely, with only three heads corresponding to three
positions, for each request, a maximum of 4 tokens (3 plus 1
bonus token) can be processed in a single forward pass. This
inefficiency underscores the need for future advancements
such as those proposed by sequoia [ 6], which aims to develop
a more structured verification tree to effectively prune less
likely candidates under high request volumes.
Finally, we show the performance of SmartSpec when
integrated with Medusa. We model the accepted token length
as outlined in Section 4.4 and evaluate performance using
goodput to decide the number of sampled tokens per head.
0 5 10
Request Rate102103Average Batch Size
(a)ùõº=0.8, average
batch token number.
0 5 10
Request Rate101102103Average Batch","[0.03493453562259674, 0.002576314378529787, 0.03852272033691406, 0.0004027733812108636, -0.01462542824447155, -0.018500665202736855, -0.018931247293949127, 0.0006647106492891908, 0.028174402192234993, -0.003950587939471006, 0.02108415588736534, 0.0009418976842425764, -0.06194636970758438, 0.017309388145804405, 0.046072252094745636, -0.03126023709774017, 0.0058307950384914875, -0.017510326579213142, -0.0025009626988321543, -0.0020344990771263838, 0.0037532381247729063, 0.028432751074433327, 0.005468389019370079, 0.004879927262663841, 0.034073375165462494, -0.022289784625172615, 0.04383322596549988, 0.03746061772108078, 0.07250997424125671, -0.045124974101781845, 0.008604459464550018, -0.028561925515532494, -0.00015799212269484997, -0.030255548655986786, -0.026509486138820648, 0.03568087890744209, -0.01926136016845703, 0.0033513617236167192, -0.01894559897482395, -0.013168626464903355, -0.013922144658863544, -0.0005211833631619811, -0.0695820227265358, 0.018055729568004608, 0.03436042740941048, 0.006555608008056879, 0.021213330328464508, -0.00653407908976078, 0.010936778038740158, 0.041020091623067856, -0.0465889498591423, 0.011740530841052532, -0.005873853340744972, 0.002409463981166482, 0.026078904047608376, -0.030255548655986786, -0.001655945903621614, 0.03347055986523628, 0.032178811728954315, 0.015988938510417938, 0.010333963669836521, -0.03367149829864502, 0.0024022876750677824, 0.0008468108717352152, -0.03481971472501755, 0.026222432032227516, -0.004237642511725426, 0.018572429195046425, 0.010534901171922684, 0.027686409652233124, 0.018371490761637688, 0.013168626464903355, 0.03883847966790199, -0.01518518477678299, -0.010377021506428719, -0.003048160346224904, 0.007384478114545345, 0.03967093676328659, 0.0010549253784120083, -0.013627913780510426, -0.009149863384664059, 0.007513652555644512, 0.016146818175911903, -0.05410977825522423, 0.004556990694254637, -0.0029548676684498787, -0.018457606434822083, -0.05089477077126503, -0.021385563537478447, -0.026667365804314613, -0.028002170845866203, 0.019175242632627487, -0.041020091623067856, -0.0033764790277928114, -0.002143938560038805, -0.018644191324710846, 0.04190996289253235, -0.05907582491636276, -0.008475285023450851, 0.03444654494524002, 0.04414898902177811, 0.0032365398947149515, 0.0073270672000944614, -0.027126653119921684, 0.06292235106229782, -0.019562765955924988, -0.027657704427838326, 0.02574879117310047, -0.00783658865839243, -0.016720926389098167, -0.04377581551671028, -0.03410207852721214, -0.0742897167801857, 0.01855807565152645, 0.01110183447599411, -0.04185255244374275, -0.07348596304655075, -0.011719001457095146, 0.010226317681372166, 0.03680039197206497, -0.04279983043670654, 0.001573417684994638, 0.024327872321009636, -0.015285653993487358, -0.035192884504795074, -0.011719001457095146, 0.02191661298274994, -0.06137226149439812, 0.002592461183667183, -0.009695267304778099, 0.00022527053079102188, 0.017668206244707108, 0.029480500146746635, -0.023581530898809433, 0.010183259844779968, -0.024887628853321075, -0.0418812558054924, -0.03829307481646538, -0.003441066248342395, 0.040216341614723206, -0.020782748237252235, -0.04495273903012276, -0.01982111483812332, 0.03301127254962921, -0.04997619614005089, -0.019318770617246628, -0.04076174274086952, 0.014402961358428001, -0.044349927455186844, 0.034704893827438354, -0.01778302900493145, -0.009695267304778099, -0.047478821128606796, -0.028633689507842064, 0.020466988906264305, -0.0378911979496479, -0.031403765082359314, -0.0026821657083928585, -0.006426433566957712, -0.03048519231379032, -0.0474214106798172, 0.0072481269016861916, -0.007043600548058748, -0.02244766429066658, 0.024528810754418373, 0.051468878984451294, -0.017280682921409607, -0.007061541546136141, -0.09587621688842773, -0.012034761719405651, 0.03826437145471573, -0.041680317372083664, 0.009659385308623314, -0.04486662521958351, -0.013147098012268543, -0.023940348997712135, -0.03588181734085083, -0.0394987054169178, 0.04888538643717766, -0.050177134573459625, -0.03536511957645416, 0.026495134457945824, -0.011374535970389843, 0.024241754785180092, -0.02594972960650921, -0.03180564194917679, -0.08175313472747803, 0.04833998531103134, 0.053506966680288315, -0.005820030812174082, 0.0292221512645483, 0.06280753016471863, 0.044493451714515686, -0.03774766996502876, -0.03461877629160881, -0.05867394804954529, 0.04320170730352402, 0.03903941810131073, 0.011317125521600246, 0.011245361529290676, 0.02038087137043476, 0.014912483282387257, 0.07245256751775742, -0.008145172148942947, 0.02638031169772148, -0.023624587804079056, -0.011826646514236927, -0.06401316076517105, -0.005640621762722731, 0.0007692164508625865, 0.028073932975530624, 0.02203143574297428, 0.06676888465881348, -0.013864734210073948, -0.024772806093096733, 0.011037247255444527, -0.02395470067858696, 0.015988938510417938, -0.010872190818190575, 0.03364279121160507, 0.007980115711688995, -8.376161713385954e-05, 0.019548414275050163, 0.034561365842819214, -0.03306868299841881, 0.07807883620262146, 0.00044762567267753184, 0.029595322906970978, -0.00040703435661271214, -0.009709619916975498, 0.018285373225808144, 0.0553441159427166, -0.009279037825763226, -0.012099348939955235, -0.012852867133915424, -0.013649443164467812, 0.007513652555644512, -0.00381423719227314, -0.022950010374188423, -0.06097038462758064, -0.003006896236911416, -0.0028346634935587645, 0.015314359217882156, 0.003911118023097515, -0.06137226149439812, 0.007018483243882656, -0.06051109731197357, -0.024858923628926277, -0.0035827993415296078, 0.06424280256032944, -0.024815864861011505, -0.06137226149439812, -0.019950291141867638, -0.04337393864989281, -0.03697262331843376, 0.029236504808068275, -0.013147098012268543, 0.022734718397259712, -0.017582090571522713, 0.01900300942361355, -0.021442973986268044, -0.016591751947999, -0.016089405864477158, 0.029968492686748505, -0.05152628943324089, -0.06774487346410751, -0.007685885298997164, -0.006157319992780685, 0.006573549006134272, -0.04885668307542801, -0.006056850776076317, 0.013778617605566978, 0.009745501913130283, 0.009637855924665928, -0.037230972200632095, -0.04767975956201553, 0.009271861054003239, -0.0058630891144275665, -0.059362877160310745, 0.012013232335448265, 0.014869424514472485, -0.027270181104540825, 0.06826157122850418, 0.016476931050419807, 0.003842942649498582, 0.020825807005167007, 0.02907862514257431, -0.002434581285342574, 0.02465798519551754, -0.024083875119686127, -0.005271038971841335, -0.02220366895198822, 0.002662430750206113, -0.04297206550836563, 0.01509906817227602, -0.00866187084466219, -0.0015698295319452882, -0.005820030812174082, -0.039900582283735275, -0.039269059896469116, 0.06435762345790863, 0.025619616732001305, 0.040560804307460785, -0.010549253784120083, 0.026782188564538956, 0.01887383498251438, -0.01651998795568943, -0.02472974732518196, 0.016606105491518974, -0.004513932392001152, 0.011991702951490879, -0.017940908670425415, -0.042914651334285736, 0.020754043012857437, -0.011209479533135891, -0.08198277652263641, 0.07624168694019318, -0.054770004004240036, -0.006236259825527668, -0.027155358344316483, -0.012307463213801384, -0.018845129758119583, -0.0013087892439216375, 0.0016030201222747564, 0.044177692383527756, -0.05703773722052574, -0.03148988261818886, 0.005163393449038267, 0.0009320302051492035, -0.02851886861026287, 0.012788279913365841, -0.0053571551106870174, 0.015228243544697762, -0.03728838264942169, -0.016921864822506905, -0.032006580382585526, -0.006186025217175484, 0.0012307462748140097, 0.03823566436767578, 0.06659664958715439, -0.0039649405516684055, 0.011647237464785576, 0.00414793798699975, -0.010520548559725285, 0.005550917237997055, 0.007858118042349815, 0.012501224875450134, 0.0012657310580834746, 0.08726458251476288, 0.03450395539402962, -0.010039732791483402, -0.006491020787507296, 0.059649933129549026, -0.002814928535372019, 0.02708359621465206, 0.017582090571522713, 0.00456057908013463, -0.05720996856689453, -0.07451935857534409, 0.0002008260489674285, -0.017280682921409607, 0.05344955623149872, -0.014725897461175919, 0.013240390457212925, 0.030542602762579918, -0.0037137679755687714, -0.0244857519865036, -0.017912203446030617, -0.05482741445302963, -0.04015893116593361, -0.011819470673799515, 0.08341804891824722, -0.00980291236191988, -0.015831056982278824, -0.03338444232940674, -0.01690751127898693, -0.029451794922351837, 0.04615836963057518, 0.004998337011784315, 0.04767975956201553, 0.005626268684864044, 0.013699677772819996, 0.0063941399566829205, 0.0009140892652794719, 0.012056290172040462, 0.009759854525327682, 0.016778336837887764, 0.012486872263252735, -0.06194636970758438, -0.03507806360721588, -0.012300286442041397, 0.012781103141605854, 0.007937057875096798, -0.0019286476308479905, 0.00598149886354804, 0.03952740877866745, 0.032810334116220474, 0.018400195986032486, 0.03510677069425583, 0.016850100830197334, 0.008984806947410107, -0.02907862514257431, -0.055430229753255844, -0.01749597303569317, -0.04486662521958351, -0.017424210906028748, 0.02648078091442585, 0.005726737901568413, 0.02711230143904686, 0.020782748237252235, 0.03306868299841881, -0.036599453538656235, 0.04079044982790947, -0.05324861779808998, 0.008719281293451786, 0.017194567248225212, -0.006699135061353445, 0.03588181734085083, 0.007506476249545813, 0.074347123503685, -0.031202828511595726, -0.021844850853085518, -0.014855071902275085, -0.023524118587374687, -0.041967373341321945, -0.007786354050040245, 0.02395470067858696, -0.006896485108882189, 0.03510677069425583, -0.04050339385867119, -0.051784638315439224, 0.028360988944768906, 0.04805292934179306, -0.044522158801555634, -0.02065357379615307, 0.008216936141252518, 0.016850100830197334, 0.007101011462509632, -0.02458622120320797, -0.05032065883278847, -0.041020091623067856, -0.015386123210191727, -0.0020506458822637796, 0.012601694092154503, -0.009221627376973629, 0.009013512171804905, 0.006760134361684322, -0.014374256134033203, 0.019232653081417084, -0.008080584928393364, 0.006254200823605061, -0.011719001457095146, 0.01231463998556137, 0.026179373264312744, -0.016218582168221474, -0.04300076887011528, 0.0820975974202156, -0.015414828434586525, 0.011288419365882874, -0.016993628814816475, 0.03410207852721214, 0.01957711949944496, -0.027944758534431458, -0.007040012627840042, -0.02553350105881691, -0.022993069142103195, 0.0014810219872742891, 0.02437092922627926, 0.043689701706171036, 0.039613526314496994, 0.0170079804956913, -0.0450388565659523, 0.0038788244128227234, 0.0012271581217646599, 0.018357137218117714, -0.01715150848031044, 0.027385002002120018, -0.003595357993617654, 0.0521291047334671, -0.00706871785223484, 0.006903661414980888, -0.02115591987967491, 0.024284813553094864, 0.0244857519865036, 0.026007140055298805, 0.06935237348079681, 0.06585031002759933, 0.005658562760800123, -0.006900073494762182, -0.01785479299724102, -0.02157214842736721, -0.028504515066742897, 0.04900021106004715, -0.017983967438340187, -0.0049193971790373325, 0.009113981388509274, 0.011367359198629856, -0.027643350884318352, -0.016491282731294632, -0.005529387854039669, 0.0458713136613369, -0.0427137166261673, -0.0010316022671759129, 0.018715955317020416, -0.0005162496236152947, -0.035824406892061234, -0.025519147515296936, -0.017122803255915642, -0.01026219967752695, 0.016362108290195465, -0.010427256114780903, -0.02234719507396221, 0.009953616186976433, 0.035652171820402145, -0.027141006663441658, -0.011252537369728088, -0.02465798519551754, 0.008547049015760422, -0.0037209445144981146, -0.011604179628193378, -0.018328431993722916, -0.011080305092036724, -0.014187670312821865, 0.020108170807361603, 0.029121682047843933, -0.0600518099963665, -0.01918959617614746, -0.11034376174211502, -0.008805397897958755, 0.004402698948979378, 0.0033190681133419275, -0.03576699644327164, 0.010161730460822582, 0.04216831177473068, -0.01775432378053665, 0.006580725312232971, 0.013527444563806057, 0.0011527034221217036, -0.03229363635182381, 0.01076454482972622, 0.00017111141642089933, -0.0024937863927334547, 0.016118112951517105, -0.006946719717234373, -0.003243716200813651, -0.0201368760317564, 0.02009381726384163, -0.008798221126198769, 0.0078940000385046, -0.002215702086687088, 0.028576279059052467, -0.011044423095881939, 0.020108170807361603, 0.016950570046901703, -0.017409857362508774, 0.010097143240272999, 0.00940103642642498, 0.026681719347834587, -0.015429181046783924, -0.0035810053814202547, 0.013527444563806057, -0.015012952499091625, -0.02115591987967491, -0.005188510753214359, 0.001948382705450058, -0.0015931526431813836, 0.007212245371192694, 0.009530210867524147, 0.023064831271767616, 0.029480500146746635, -0.03292515501379967, -0.025562206283211708, 0.018156198784708977, -0.031202828511595726, 0.0034303017891943455, -0.024715395644307137, -0.015386123210191727, -0.013505916111171246, -0.0054612127132713795, 0.01110183447599411, -0.026538191363215446, -0.010219141840934753, -0.010054085403680801, 0.015630118548870087, -0.03843660280108452, 0.031977877020835876, 0.01943359151482582, 0.01749597303569317, 0.008281523361802101, 0.03921164944767952, 0.008274346590042114, 0.013104039244353771, 0.010441608726978302, -0.003868059953674674, 0.0018999421736225486, 0.016649162396788597, 0.02385423146188259, -0.04457956925034523, -0.015443533658981323, -0.00859010685235262, -0.00782223604619503, 0.007057953625917435, -0.002574520418420434, 0.015056010335683823, -0.03553735092282295, 0.03858013078570366, -0.012587341479957104, 0.018084436655044556, 0.055573757737874985, 0.014123083092272282, 0.006598666310310364, 0.018500665202736855, 0.0014074642676860094, -0.0363411046564579, -0.02220366895198822, -0.0035397412721067667, -0.04236925020813942, -0.03906812146306038, -0.0063726105727255344, 0.0100827906280756, -0.004061821848154068, -0.02616502158343792, -0.01341262273490429, 0.007201480679214001, 0.0031378648709505796, 0.023653293028473854, -0.0022587603889405727, -0.03757543861865997, -0.011353006586432457, 0.0002881758555304259, 0.006907249800860882, 0.03941258788108826, -0.0008315611048601568, 0.008934572339057922, 0.0024112581741064787, 0.02903556637465954, 0.013857557438313961, 0.006264965049922466, -0.004492403473705053, 0.0001373600825900212, 0.03223622590303421, 0.03967093676328659, -0.0013724794844165444, -0.045928724110126495, -0.01718021370470524, -0.02342364937067032, 0.014424490742385387, 0.0007562093087472022, 0.0057697962038218975, -0.025720085948705673, -0.037230972200632095, -0.014869424514472485, 0.04455086216330528, 0.02609325759112835, 0.020883217453956604, -0.038809772580862045, -0.019318770617246628, -0.021471679210662842, 0.02104109711945057, -0.009752677753567696, -0.00025072420248761773, 0.018816424533724785, -0.05069383233785629, 0.0045067560859024525, 0.016677867621183395, 0.03545123338699341, 0.030887067317962646, 0.019447945058345795, 0.015515297651290894, -0.010886543430387974, -0.02441398799419403, 0.055401526391506195, 0.029824966564774513, -0.0005131099605932832, 0.0013949056155979633, -0.007520828861743212, -0.035192884504795074, -0.03370020166039467, -0.026078904047608376, 0.01015455462038517, -0.034532662481069565, 0.017983967438340187, -0.027298886328935623, -0.016606105491518974, 0.0070938351564109325, -0.013104039244353771, 0.031030595302581787, 0.020969333127141, 0.019376181066036224, -0.00012042834714520723, -0.003982881549745798, -0.015544002875685692, 0.03229363635182381, -0.035652171820402145, 0.0002040778344962746, -0.006315199658274651, -0.0008553328225389123, 0.024787159636616707, -0.007086658850312233, -0.03545123338699341, -0.005098806228488684, 0.008338933810591698, 0.009508681483566761, -0.00715483445674181, -0.0002520697598811239, -0.015587061643600464, 0.01213523093611002, 0.0038250016514211893, 0.04767975956201553, -0.026566896587610245, 0.01914653740823269, 0.019232653081417084, -0.004284288734197617, 0.001783326268196106, -0.0037675907369703054, 0.004718458745628595, -0.0015832851640880108, -0.021299446001648903, -0.011934292502701283, -0.013462857343256474, -0.025203388184309006, 0.003073277650400996, -0.03823566436767578, 0.02346670813858509, -0.01476895622909069, 0.0011814088793471456, 0.01960582472383976, 0.019634529948234558, -0.0122572286054492, 0.020266050472855568, 0.03605404868721962, -0.005332037806510925, 0.009867499582469463, -0.048454806208610535, -0.012106524780392647, -0.016476931050419807, -0.005335626192390919, -0.0014460372040048242, -0.03763284906744957, 0.002870545256882906, 0.02500244975090027, -0.028820276260375977, -0.028805922716856003, 0.01158982701599598, 0.0031988639384508133, -0.02002205327153206, -0.005134688224643469, 0.029308268800377846, -0.0008243847405537963, 0.02135685831308365, -0.030600013211369514, 0.013670972548425198, 0.005428919102996588, 0.015486592426896095, 0.041163619607686996, -0.02504550851881504, 0.0033818611409515142, 0.0380060188472271, -0.0012800837866961956, -0.000494272040668875, -0.024184344336390495, 0.02623678371310234, -0.017409857362508774, 0.038781069219112396, -0.0019681176636368036, 0.029451794922351837, -0.02023734524846077, 0.009379507042467594, 0.02164391241967678, 0.03002590499818325, 0.019806763157248497, -0.033413149416446686, -0.008898690342903137, 0.03734579682350159, 0.05609045550227165, 0.00476869335398078, -0.022576838731765747, 0.014230728149414062, 0.005622680764645338, 0.03206399083137512, -0.008166701532900333, -0.026078904047608376, -0.02798781730234623, 0.008712105453014374, -0.031174123287200928, 0.005640621762722731, 0.004994749091565609, 0.010922425426542759, -0.005579622462391853, -0.02774382010102272, -0.01715150848031044, -0.007305537816137075, -0.026782188564538956, -0.0003074623236898333, -0.01771126501262188, -0.01517083216458559, 0.010592312552034855, -0.10925295948982239, -0.024457046762108803, 0.002003999426960945, -0.01824231632053852, -0.002728812163695693, 0.00822411198168993, 0.039900582283735275, 0.0240982286632061, -0.0058415597304701805, 0.005120335146784782, 0.03685780242085457, -0.00414793798699975, -0.008948924951255322, -0.031116710975766182, 0.013742735609412193, -0.0450962670147419, -0.04931597039103508, 0.006200377829372883, 0.030284253880381584, -0.02310789003968239, 0.0007100114598870277, -0.023624587804079056, -0.018055729568004608, 0.013455681502819061, 0.015443533658981323, -0.03602534532546997, -0.016591751947999, -0.0006377992685884237, 0.020854512229561806, -0.005665739066898823, 0.0045282854698598385, 0.021098507568240166, 0.017668206244707108, 0.0514114685356617, -0.006907249800860882, -0.0032490985468029976, -0.008288700133562088, -0.015314359217882156, 0.01374991238117218, 0.007721766829490662, 0.028016522526741028, -0.02269166149199009, 0.006211142521351576, 0.01518518477678299, 0.003342391224578023, -0.02297871559858322, -0.010269376449286938, 0.008001645095646381, -0.02609325759112835, -0.004241230897605419, -0.038781069219112396, 0.008324581198394299, 0.0040582334622740746, -0.007158422376960516, -0.0027646939270198345, 0.01478330884128809, 0.0073988307267427444, 0.003954176325351, 0.010233494453132153, -0.016778336837887764, 0.0017824292881414294, 0.03918294236063957, 0.007420359645038843, -0.028719807043671608, -0.012752397917211056, -0.030427780002355576, -0.0002944551524706185, 0.003731708973646164, 0.017983967438340187, 0.0075423577800393105, 0.003760414430871606, 0.02349541336297989, 0.030600013211369514, 0.011087481863796711, 0.026638660579919815, 0.01862983964383602, -0.006139378994703293, 0.021701322868466377, -0.04489532858133316, -0.008869985118508339, 0.04320170730352402, -0.04346005618572235, -0.005536564160138369, -0.006555608008056879, 0.0063008470460772514, -0.028116991743445396, 0.030944479629397392, 0.0031522177159786224, -0.0058630891144275665, 0.026638660579919815, 0.016821395605802536, -0.025346916168928146, 0.015587061643600464, 0.015902820974588394, -0.017524680122733116, -0.045900020748376846, -0.010771721601486206, 0.002032704884186387, 0.019892878830432892, 0.013154273852705956, 0.04380452260375023, 0.014546488411724567, -0.006709899753332138, -0.059822164475917816, 0.0064551387913525105, 0.003990057855844498, 0.01792655512690544, 0.008145172148942947, 0.04882797598838806, 0.011259714141488075, 0.01907477341592312, 0.011927115730941296, 0.020825807005167007, 0.011754883453249931, 0.012300286442041397, 0.020567458122968674, 0.054138485342264175, -0.02118462510406971, 0.020423930138349533, -0.031403765082359314, -0.004664636217057705, 0.027829937636852264, -0.027341945096850395, 0.02206014096736908, -0.040847860276699066, 0.011927115730941296, 0.01245099026709795, 0.05749702453613281, 0.004944514483213425, 0.019548414275050163, -0.03809213638305664, 0.05568857863545418, -0.0016514606541022658, 0.039785757660865784, 0.005324861500412226, -0.008259993977844715, -0.009508681483566761, 0.013383917510509491, -0.01613246463239193, 0.02854757383465767, -0.021342504769563675, 0.009035041555762291, 0.011898410506546497, 0.005288979969918728, 0.0045067560859024525, -0.00953738670796156, -0.040704332292079926, -0.006003027781844139, -0.014352726750075817, -0.013592032715678215, -0.014675662852823734, -0.029293915256857872, 0.008338933810591698, 0.00632237596437335, 0.01729503646492958, 0.02283518761396408, -0.03387243673205376, -0.024012111127376556, -0.002188790822401643, 0.008618812076747417, 0.04412028193473816, 0.02497374452650547, 0.022777777165174484, -0.008410697802901268, -0.0036007403396070004, -0.02462927997112274, -0.045153677463531494, 0.0036150929518043995, -0.011948645114898682, 0.028102638199925423, 0.017381152138113976, -0.030456487089395523, 0.009939263574779034, 0.020466988906264305, 0.034245606511831284, 0.016563046723604202, 0.0036850625183433294, -0.008403521962463856, 0.015084715560078621, 0.048311278223991394, -0.002350259106606245, -0.02388293668627739, -0.007657179608941078, 0.0008436712087132037, 0.05072253569960594, -0.039441294968128204, 0.0036599452141672373, 0.055745989084243774, -0.016290344297885895, 0.000901979161426425, -0.013405446894466877, 0.03504936024546623, -0.016964923590421677, 0.016749631613492966, 0.0008746192906983197, -0.013455681502819061, 0.004115644376724958, 0.017524680122733116, -0.030083315446972847, 0.008475285023450851, 0.011726178228855133, 0.03126023709774017, -0.009838794358074665, 0.03622628375887871, -0.009379507042467594, 0.00632237596437335, -0.004653871525079012, 0.006020968779921532, -0.04113491624593735, 0.0029584558214992285, -0.011475005187094212, 0.01746726781129837, -0.008726458065211773, 0.03381502255797386, -0.015271301381289959, -0.026351606473326683, 0.008066232316195965, 0.0050844536162912846, -0.014546488411724567, -0.005281803663820028, -0.042254429310560226, -0.013182980008423328, -0.036312397569417953, -0.011195126920938492, -0.016706574708223343, 0.012565812095999718, 0.014668487012386322, 0.006386963650584221, -0.043861933052539825, 0.0042807008139789104, 0.020754043012857437, 0.013319330289959908, -0.00584873603656888, -0.04793810844421387, -0.018644191324710846, 0.0019322359003126621, 0.0038752362597733736, -0.008697752840816975, 0.008913042955100536, 0.009688090533018112, 0.007036424241960049, 0.0045892843045294285, -0.0023000244982540607, -0.015127774327993393, -0.0157880000770092, -0.03131765127182007, 0.011353006586432457, 0.027557235211133957, -0.01858678087592125, -0.03131765127182007, -0.010434431955218315, 0.0056872679851949215, 0.02455751597881317, -0.004804575350135565, 0.02002205327153206, -0.0201655812561512, -0.0002848119183909148, 0.028561925515532494, 0.035164181143045425, 0.04446474835276604, -0.020337814465165138, -0.0209406279027462, -0.008245641365647316, 0.008798221126198769, 0.017582090571522713, -0.01683574914932251, -0.00632237596437335, -0.00943691749125719, -0.0009634267771616578, 0.0028454281855374575, -0.02157214842736721, 0.03496324270963669, -0.006107085384428501, 0.05258839204907417, 0.018041377887129784, -0.007757648825645447, 0.02648078091442585, -0.009465623646974564, 0.013649443164467812, 0.0008678914746269584, -0.0007943336968310177, -0.005902559030801058, -0.029064271599054337, -0.026523839682340622, 0.005992263555526733, -0.04618707299232483, 0.008532696403563023, -0.012084996327757835, 0.01336238905787468, 0.003441066248342395, 0.05011972039937973, 0.03286774456501007, 0.02048134058713913, -0.014230728149414062, -0.014840719290077686, 0.003936235327273607, 0.011898410506546497, 0.011353006586432457, 0.02300742082297802, -0.024284813553094864, -0.0067027234472334385, -0.010197612456977367, 0.0012899512657895684, -0.031547293066978455, 0.024844570085406303, 0.04130714759230614, 0.019548414275050163, -0.033183503895998, -0.014302492141723633, -0.02160085365176201, 0.017438562586903572, 0.028633689507842064, 0.04564167186617851, 0.05118182301521301, 0.01101571787148714, -0.007528005167841911, 0.010384198278188705, 0.02381117455661297, 0.019519709050655365, 0.01644822396337986, 0.0009625297388993204, 0.010247847065329552, -0.015773646533489227, 0.009128334000706673, -0.026107609272003174, 0.017366798594594002, -0.013563326559960842, -0.04678988829255104, -0.008776692673563957, 0.03367149829864502, -0.008324581198394299, 0.015012952499091625, 0.010046908631920815, 0.018543722108006477, -0.023739410564303398, 0.0036079166457057, -0.0014325815718621016, -0.0029566616285592318, -0.007994469255208969, -0.03588181734085083, 0.004302229732275009, 0.0012388196773827076, -0.013132745400071144, 0.021758733317255974, -0.011439123190939426, 0.005902559030801058, 0.017036687582731247, 0.00224081939086318, -0.008432227186858654, -0.03433172404766083, 0.0710747018456459, -0.007829412817955017, -0.026437722146511078, 0.004718458745628595, -0.003563064383342862, 0.0031827171333134174, -0.008044702932238579, -0.02704053744673729, -0.022174963727593422, 0.0033764790277928114, -0.008554224856197834, 0.01075019221752882, 0.029336974024772644, 0.02157214842736721, 0.014740250073373318, 0.007406007032841444, -0.006175260525196791, 0.032982565462589264, 0.026222432032227516, 0.02521774172782898, 0.01654869318008423, -0.005278215277940035, -0.009745501913130283, 0.008460932411253452, -0.024213049560785294, -0.0018766190623864532, 0.021055450662970543, 0.026007140055298805, 0.02827487140893936, 0.05422460287809372, 0.0205243993550539, 0.007291185203939676, -0.040245044976472855, 0.016333403065800667, -0.024858923628926277, -0.026007140055298805, -0.01970629394054413, 0.03823566436767578, 0.007786354050040245, -0.006552019622176886, -0.00026911363238468766, -0.006494608707726002, 0.03941258788108826, 0.044349927455186844, 0.00735577242448926, 0.011073128320276737, 0.009092452004551888, 0.009250332601368427, 0.007721766829490662, -0.004452933557331562, 0.027198417112231255, -0.012659105472266674, 0.0031791289802640676, -0.02125638909637928, 0.035479940474033356, -0.006415668874979019, 0.0241269338876009, 0.01992158405482769, 0.015027305111289024, -0.0197493527084589, -0.05471259355545044, 0.020007701590657234, -0.028561925515532494, -0.007456241641193628, -0.005317685194313526, -0.05660715326666832, -0.006483844481408596, 0.015615766867995262, 0.011510887183248997, 0.02157214842736721, -0.008094937540590763, 0.016677867621183395, 0.0244857519865036, -0.00414793798699975, 0.008625988848507404, 0.03174823150038719, 0.008640341460704803, -0.012982041575014591, 0.036283694207668304, 0.009745501913130283, -0.012953336350619793, 0.00646949140354991, -0.0245144572108984, -0.014553665183484554, -0.017438562586903572, 0.042110901325941086, 0.04578519985079765, 0.0011150274658575654, 0.009860323742032051, 0.029595322906970978, -0.033441852778196335, -0.01799831911921501, 0.007650003302842379, -0.009838794358074665, 0.006767310667783022, -0.01603199541568756, -0.006512549705803394, -0.032953862100839615, -0.014603899791836739, 0.005931264255195856, -0.023581530898809433, -0.028030876070261, 0.006494608707726002, -0.0013213478960096836, -0.03037036955356598, 0.013240390457212925, -0.06722817569971085, -0.028533220291137695, 0.01281698513776064, -0.009580445475876331, -0.021930966526269913, 0.015328711830079556, 0.013721207156777382, 0.0013697883114218712, -0.019806763157248497, 0.01921830140054226, -0.01394367404282093, 0.011087481863796711, -0.01900300942361355, -0.013441328890621662, 0.03194916993379593, 0.04713435471057892, 0.004169466905295849, -0.015974584966897964, -0.02752852998673916, -0.00244713993743062, -0.02813134528696537, -0.0018362519331276417, -0.021686969324946404, -0.0016218581004068255, -0.005012689623981714, -0.02381117455661297, -0.00848963763564825, 5.323403820511885e-05, -0.004158702678978443, 0.06252047419548035, 0.009982321411371231, -0.012386403046548367, -0.012214170768857002, -0.01034831628203392, 0.005443271715193987, 0.01075019221752882, -0.03347055986523628, -0.05491353198885918, -0.014690015465021133, 0.01666351594030857, -0.0006068512448109686, -0.0013590238522738218, 0.006200377829372883, 0.03441783785820007, 0.01231463998556137, 0.004449345171451569, 0.012293110601603985, 0.007301949895918369, -0.028260519728064537, -0.008669046685099602, 0.023050479590892792, -0.004190996289253235, 0.0019430003594607115, 0.030140725895762444, 0.018744660541415215, -0.02230413816869259, -0.018213611096143723, 0.04044598340988159, 0.013520268723368645, -0.010125848464667797, -0.018357137218117714, 0.023337533697485924, 0.03886718302965164, 0.013075334019958973, 0.017553385347127914, 0.006038909777998924, 0.01725197769701481, 0.01169747207313776, -0.04917244240641594, -0.0070220716297626495, -0.02160085365176201, 0.041680317372083664, -0.019964642822742462, 0.026150668039917946, 0.011948645114898682, -0.010168907232582569, 0.02630854770541191, 0.027801232412457466, 0.0015958438161760569, -0.0032096286304295063, 0.02108415588736534, -0.0002603674365673214, -0.00762129807844758, 0.03490583226084709, 0.0060891443863511086, 0.013635090552270412, -0.031088005751371384, -0.018888188526034355, 0.030399074777960777, 0.01907477341592312, -0.009408212266862392, 0.0104703139513731, -0.0034159489441663027, 0.011202303692698479, -0.01637646183371544, -0.0033567440696060658, 0.033183503895998, -0.026251137256622314, 0.0005081762210465968, 0.00018243661907035857, -0.02682524546980858, -0.023725057020783424, 0.016189875081181526, -0.003295745002105832, 0.03481971472501755, 0.020079465582966805, 0.01413743570446968, 0.025447385385632515, 0.02708359621465206, -0.05425330623984337, -0.011065952479839325, -0.015902820974588394, 0.0007979219080880284, 0.0038250016514211893, -0.008166701532900333, 0.026107609272003174, 0.00565497437492013, 0.006659665144979954, -0.04268500953912735, -0.009515858255326748, 0.012027584947645664, 0.025375621393322945, -0.01690751127898693, -0.005134688224643469, 0.009422564879059792, 0.0144173139706254, -0.00019880769832525402, 0.007499299943447113, 0.023825526237487793, -0.022677307948470116, 0.0009302361286245286, -0.0017025922425091267, 0.024083875119686127, -0.00585591234266758, -0.044665686786174774, -0.011876881122589111, 0.0027234298177063465, 0.029652733355760574, 0.03338444232940674, 0.04073303937911987, 0.030255548655986786, 0.010635370388627052, -0.01634775660932064, -0.010176083073019981, -0.04159420356154442, 0.00913551077246666, -0.00224440754391253, -0.04934467375278473, 0.006336729042232037, -0.028145696967840195, 0.005518623627722263, -0.012142406776547432, 0.04018763452768326, 0.03585311025381088, 0.011446299962699413, -0.01718021370470524, 0.021773086860775948, -0.026997478678822517, 0.002242613583803177, 0.012192641384899616, -0.022074494510889053, -0.022462017834186554, 0.007079482544213533, -0.023653293028473854, -0.01756773702800274, 0.017108449712395668, -0.015701882541179657, 0.005263862665742636, 0.020739689469337463, 0.007492123171687126, -0.011955820955336094, -0.04383322596549988, -0.011597002856433392, 0.019978996366262436, 0.02662430889904499, -0.02507421374320984, -0.01450343057513237, -0.0012208787957206368, -0.020266050472855568, 0.00019712572975549847, -0.019935937598347664, 0.000897942460142076, 0.008403521962463856, 0.022562487050890923, 0.0379486083984375, 0.010326786898076534, -0.0071045998483896255, -0.04061821848154068, -0.0030122785829007626, 0.016677867621183395, 0.003399802139028907, -0.038350485265254974, -0.023280123248696327, -0.011259714141488075, -0.025791849941015244, -0.0284758098423481, -0.004180231597274542, -0.02195967175066471, -0.0006539461319334805, 0.022390253841876984, -0.012458167038857937, 0.03559476137161255, 0.02813134528696537, 6.09430244367104e-05, 0.017811734229326248, 0.023194005712866783, -0.011044423095881939, 0.014194847084581852, -0.018572429195046425, 0.011518063023686409, 0.017811734229326248, 0.017165862023830414, -0.013979556038975716, 0.042110901325941086, 0.0024309931322932243, 0.02538997307419777, 0.0046718125231564045, -0.04257018864154816, 0.0008930087205953896, -0.026279842481017113, 0.015974584966897964, -0.010635370388627052, 0.0044457572512328625, -0.008611636236310005, 0.005938440561294556, -0.00714765815064311, 0.021414268761873245, -0.02553350105881691, 0.018816424533724785, 0.013046628795564175, -0.005177746061235666, 0.028030876070261, 0.04572778567671776, -0.03272421658039093, -0.013843204826116562, -0.004083350766450167, -0.036455925554037094, -0.021127214655280113, -0.01771126501262188, 0.009178568609058857, 0.0049301618710160255, 0.00885563250631094, -0.023739410564303398, 0.007251715287566185, 0.033413149416446686, 0.023351887241005898, 0.006925190798938274, -0.012752397917211056, 0.009845970198512077, 0.01705103926360607, 0.03355667367577553, -0.01907477341592312, -0.008618812076747417, -0.0061214379966259, 0.008066232316195965, 0.0050844536162912846, 0.005332037806510925, 0.021299446001648903, 0.001134762424044311, 0.0007364742923527956, -0.0016945188399404287, 0.0027969875372946262, -0.004693341441452503, 0.019347475841641426, -0.04041728004813194, 0.04437863081693649, -0.013376741670072079, -0.008568577468395233, 0.003832177957519889, 0.008152348920702934, -0.016778336837887764, -0.02521774172782898, -0.0017582090804353356, 0.00991055741906166, 0.039929285645484924, -0.014654134400188923, 0.01415178831666708, -0.0038501189555972815, 0.011065952479839325, -0.016563046723604202, -0.004230466205626726, 0.01644822396337986, -0.014288139529526234]",Online Speculative Decoding.pdf
" Size
(b)ùõº=0.6, average
batch token number.
5 10
Request Rate468101214Average Batch Token
 Num per Request
alpha=0.6
alpha=0.8(c) Average token
number per request.
Figure 16. (a), (b) show the average batch token number
across batches with vanilla Medusa and SmartSpec Medusa.
(c) shows the average token number across requests with
SmartSpec.
As illustrated in Figure 16, SmartSpec effectively maintains
manageable request latencies even under high request rates.
Additionally, we depict the average number of tokens per
request in Figure 16c. In both scenarios ( ùõºis 0.6 or 0.8),
SmartSpec quickly reverts to top-1 sampling. It is noteworthy
that the average number of batched tokens approximates to
four; this consists of one input token plus one sampled token
per head. Given that there are three Medusa heads, the total
number of batched tokens per request remains four when
employing top-1 sampling for each head.
8 Related Work
Aside from speculative decoding (Sec 2.1) and continuous
batching (Sec 2.2), the system community has proposed many
orthogonal methods to improve LLM inference performance.
Quantization Methods . Works like (LLM.int8() [ 7], GPTQ
[9], Marlin [ 8], AWQ [ 23], SqueezeLLM [ 17]) bring down the
latency of the LLM inference by using lower precision data
types such as 2/3/4/6/8 bit integers. GPUs For example, a
single A100 GPU can support 624 Teraops of INT8 compu-
tation through its tensor core, while only able to support
312 TFLOPS for FLOAT16 . However, this class of method
trade off accuracy for performance and commonly requires
a calibration step. In the context of SmartSpec, quantization
optimizations can be applied to both draft and target models
to further improve our performance.
Prefix Caching techniques save compute of commonly
repeated prefixes across requests. Systems like SGLang [ 45],
Cascade Inference [ 40], and Hydragen [ 15] proposes efficient
GPU kernels to compute and cache the computation for
shared prefixes across request and deliver lower inference
latency. In the context of SmartSpec, prefix caching can be
applied to both draft and target workers.
13
9 Conclusion
Speculative decoding has recently emerged as a means to
reduce inference latency at the cost of increased compu-
tational overhead. To harness the benefits of speculative
decoding without compromising efficiency, we introduce an
adaptive decision-making framework SmartSpec guided by
the concept of goodput. Our evaluation across three distinct
datasets show that SmartSpec can reduce latency by a factor
of 1.2√óto 3.2√ówhen request rates are low, while sustaining
performance levels even under high request rates.References
[1]Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge
Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt,
Sam Altman, Shyamal Anadkat, et al .2023. Gpt-4 technical report.
arXiv preprint arXiv:2303.08774 (2023).
[2]anon8231489123. 2024. ShareGPT dataset .https://huggingface.co/
datasets/anon8231489123/ShareGPT_Vicuna_unfiltered
[3]Yoshua Bengio, R√©jean Ducharme, and Pascal Vincent. 2000. A neural
probabilistic language model. Advances in neural information process-
ing systems 13 (2000).
[4]Tianle Cai, Yuhong Li, Zhengyang Geng, Hongwu Peng, Jason D Lee,
Deming Chen, and Tri Dao. 2024. Medusa: Simple llm inference ac-
celeration framework with multiple decoding heads. arXiv preprint
arXiv:2401.10774 (2024).
[5]Charlie Chen, Sebastian Borgeaud, Geoffrey Irving, Jean-Baptiste
Lespiau, Laurent Sifre, and John Jumper. 2023. Accelerating large
language model decoding with speculative sampling. arXiv preprint
arXiv:2302.01318 (2023).
[6]Zhuoming Chen, Avner May, Ruslan Svirschevski, Yuhsun Huang,
Max Ryabinin, Zhihao Jia","[0.0331101268529892, 0.019781403243541718, 0.04551912471652031, -0.011576865799725056, -0.012255710549652576, -0.01908065937459469, -0.024058857932686806, 0.03716859966516495, 0.0004076264740433544, -0.0406431183218956, 0.022058818489313126, 0.011825045570731163, -0.05296452343463898, 0.008131543174386024, 0.01345281396061182, -0.03182543069124222, 0.010387061163783073, -0.020219366997480392, -0.017533184960484505, 0.019606217741966248, -0.012452795170247555, 0.002788374898955226, -0.008890681900084019, -0.0006948126829229295, 0.017168214544653893, -0.032876547425985336, 0.022598976269364357, 0.029475020244717598, 0.0566142313182354, -0.02208801731467247, 0.023664690554142, -0.020117176696658134, -0.00878119096159935, -0.034161243587732315, -0.03059913031756878, 0.014233850874006748, 0.00487600639462471, -0.0071753207594156265, -0.03865768015384674, -0.0027409286703914404, -0.005288423039019108, -0.03141666576266289, -0.06785532087087631, 0.004025625064969063, 0.03165024518966675, 0.03200061619281769, 0.04662863537669182, 0.003580360906198621, 0.0029927585273981094, 0.06464358419179916, -0.0181463360786438, 0.019533222541213036, -0.03229259327054024, 0.046424251049757004, 0.0022390943486243486, -0.03343130275607109, -0.009817707352340221, 0.03524155542254448, 0.044438812881708145, -0.011591464281082153, 0.01177394948899746, -0.04023435339331627, 0.017898155376315117, -0.0009256565244868398, -0.06295011937618256, 0.010292169637978077, -0.019401833415031433, 0.05646824091672897, 0.009876103140413761, 0.0032883845269680023, -0.016774045303463936, 0.012314106337726116, 0.034102845937013626, -0.042978931218385696, -0.028234120458364487, 0.01072283461689949, -0.00220259721390903, 0.06476037204265594, 0.007824968546628952, -0.022934747859835625, -0.0038942357059568167, 0.01080312766134739, 0.016233889386057854, -0.04870167002081871, -0.012649878859519958, -0.0020639083813875914, -0.004620526917278767, 0.011175397783517838, -0.048205308616161346, -0.020073380321264267, -0.027854550629854202, 0.0030840011313557625, -0.05997195839881897, 0.0032756105065345764, 0.03471599891781807, -0.0027956743724644184, 0.055241942405700684, -0.034102845937013626, 0.01767917349934578, 0.048847656697034836, 0.011766649782657623, 0.024832595139741898, 0.04227818548679352, -0.06172381713986397, 0.05089149251580238, -0.03471599891781807, -0.03600069507956505, 0.02826331928372383, 0.0018686491530388594, 0.008116944693028927, -0.10960794985294342, -0.010562247596681118, -0.06376764923334122, 0.018525904044508934, -0.02150406502187252, -0.035971496254205704, -0.08333007246255875, -0.0111024035140872, -0.017197411507368088, 0.01932884007692337, -0.0412270724773407, 0.02214641310274601, 0.03346049785614014, -0.020584339275956154, -0.0229201503098011, -0.022657370194792747, 0.02426324225962162, -0.11071746051311493, 0.004770164843648672, 0.002905165543779731, 0.00453658401966095, 0.02589830942451954, 0.04826370254158974, -0.02327052131295204, 0.01649666763842106, -0.04227818548679352, -0.014737510122358799, -0.025737721472978592, -0.03976719081401825, 0.006897943094372749, -0.011700955219566822, -0.020993106067180634, 0.003036554902791977, 0.02162085473537445, -0.043095722794532776, 0.003989127930253744, -0.03664304316043854, 0.010022090747952461, -0.025007780641317368, 0.055942684412002563, -0.023869073018431664, -0.005456309765577316, -0.01569373346865177, -0.026511460542678833, 0.007292111404240131, -0.028701283037662506, -0.03331451117992401, 0.033402103930711746, -0.0035274403635412455, -0.03743137791752815, -0.019693810492753983, 0.06166542321443558, 0.020160973072052002, -0.0008262020419351757, 0.03191302344202995, 0.07059989869594574, -0.05170902609825134, 0.013175436295568943, -0.06808890402317047, -0.0304823387414217, 0.015649937093257904, -0.015138978138566017, 0.003388751531019807, -0.03465760126709938, -0.01028486993163824, -0.021182889118790627, -0.023416509851813316, -0.04128546640276909, 0.02473040297627449, -0.06394283473491669, -0.04157744348049164, 0.03623427450656891, -0.03360648825764656, 0.019168252125382423, -0.05165063217282295, -0.016876237466931343, -0.03716859966516495, 0.03965039923787117, 0.02508077584207058, 0.044322021305561066, 0.025737721472978592, 0.06400123238563538, 0.05191341042518616, -0.004105918575078249, -0.006332238670438528, -0.045577522367239, 0.04735857620835304, 0.03246777877211571, 0.01773756742477417, -0.01608790084719658, 0.013562304899096489, 0.03036554902791977, 0.019693810492753983, -0.04654104262590408, 0.019299641251564026, -0.018102537840604782, -0.002552968915551901, -0.03013196773827076, -0.010613343678414822, 0.00023677463468629867, 0.031445860862731934, 0.027810754254460335, 0.05816170573234558, -0.008846885524690151, -0.030394745990633965, 0.011963734403252602, -0.03670143708586693, 0.010883421637117863, -0.0046460749581456184, 0.034453220665454865, -0.002945312298834324, 0.01880328170955181, 0.01597111113369465, 0.04353368654847145, -0.02900785766541958, 0.043154116719961166, -0.007230066228657961, 0.028161127120256424, 0.02208801731467247, 0.0038796367589384317, 0.02824871987104416, -0.015722930431365967, -0.0037591964937746525, -0.014460132457315922, 0.013343323022127151, -0.012394399382174015, 0.030628327280282974, -0.004470888990908861, -0.0059125227853655815, -0.07445398718118668, -0.01113160140812397, -0.013671796768903732, 0.02630707621574402, -0.014606120996177197, -0.023343516513705254, 0.018934670835733414, -0.06540272384881973, -0.06265813857316971, 0.03982558473944664, 0.03670143708586693, -0.027168406173586845, -0.04773814603686333, -0.02478879876434803, -0.027474982663989067, -0.043095722794532776, 0.020248565822839737, -0.015839722007513046, -0.0024562517646700144, -0.03725619241595268, 0.010168079286813736, -0.009372442960739136, -0.022511383518576622, -0.010606043972074986, 0.03378167375922203, -0.03716859966516495, -0.04475998505949974, -0.02754797600209713, 0.02162085473537445, 0.006715457886457443, -0.06470197439193726, 0.007463647518306971, -0.007890663109719753, 0.009941797703504562, 0.008956377394497395, -0.053957246243953705, -0.02813192829489708, 0.0274311862885952, 0.007751974277198315, -0.06189900264143944, 0.026832634583115578, -0.0043504489585757256, -0.010540349408984184, 0.0371394008398056, 0.02414645068347454, 0.0023303369525820017, 0.016993029043078423, 0.03842409700155258, -0.022759562358260155, -0.020525943487882614, -0.024336235597729683, 0.045781902968883514, -0.0003446690388955176, 0.02865748666226864, -0.024934787303209305, 0.03223419934511185, 0.02690562792122364, 0.014992989599704742, -0.009408940561115742, -0.036205075681209564, -0.03226339444518089, 0.06470197439193726, -0.004562131594866514, 0.029883787035942078, -0.025036979466676712, 0.014277647249400616, 0.03156265243887901, -0.026584453880786896, 0.005299372132867575, 0.015591541305184364, 0.010065887123346329, 0.0047409674152731895, -0.030219560489058495, -0.03784014657139778, 0.008562209084630013, -0.02360629476606846, -0.07789931446313858, 0.04303732514381409, -0.03833650425076485, -0.00034101936034858227, -0.036497052758932114, 0.014482030645012856, -0.012898058630526066, -0.014321443624794483, 0.0072848121635615826, 0.03202981501817703, -0.0018795982468873262, -0.004865057300776243, -0.03529994934797287, -0.002881442429497838, -0.02055514045059681, 0.035504333674907684, 0.049256425350904465, 0.019343437626957893, -0.004810311831533909, -0.019868995994329453, -0.03661384433507919, -0.04735857620835304, 0.011547667905688286, 0.03217580169439316, -0.0011916288640350103, -0.06610346585512161, 0.02630707621574402, -0.011408979073166847, -0.012963753193616867, -0.0015228395350277424, 0.017606178298592567, 0.00951843149960041, 0.029445823282003403, 0.08175340294837952, 0.00931404810398817, 0.0022062468342483044, -0.020890913903713226, 0.05967998132109642, -0.010116983205080032, 0.03264296427369118, 0.019168252125382423, 0.017883555963635445, -0.04548992961645126, -0.06516914069652557, 0.003651530249044299, -0.025212164968252182, 0.0362926721572876, 0.01597111113369465, 0.004511035978794098, 0.016759447753429413, -0.012357902713119984, -0.020584339275956154, -0.013992970809340477, -0.01767917349934578, -0.019168252125382423, 0.03159185126423836, 0.07766573131084442, -0.0058066812343895435, -0.00816804077476263, -0.013591502793133259, -0.010846924036741257, -0.016949232667684555, 0.04727098345756531, 0.005755585618317127, 0.044380418956279755, 0.011919938027858734, 0.019007666036486626, 0.026526058092713356, -0.034920379519462585, 0.019708409905433655, 0.01439443789422512, 0.0019982135854661465, -0.003321231808513403, -0.05728577449917793, 0.0036460557021200657, -0.017226610332727432, -0.0014799555065110326, -0.005317620933055878, 0.01042355876415968, -0.019066061824560165, 0.02391286939382553, 0.012905358336865902, 0.004087670240551233, 0.01673024892807007, 0.018117137253284454, 0.003414299339056015, -0.027854550629854202, -0.02760637179017067, -0.04753376170992851, -0.007525692693889141, 0.018336119130253792, 0.04274534806609154, 0.04811771586537361, 0.04475998505949974, 0.009262952022254467, 0.02550414204597473, -0.05786972865462303, 0.0365554504096508, -0.04271615296602249, 0.010817727074027061, -0.018890874460339546, 0.03118308261036873, 0.03089110553264618, 0.04105188697576523, 0.07795770466327667, -0.008854185231029987, -0.014314144849777222, -0.016350680962204933, -0.01826312579214573, -0.03673063591122627, -0.02162085473537445, 0.004084020387381315, -0.035562727600336075, 0.058424483984708786, -0.05281853675842285, -0.05062871426343918, -0.0008987399633042514, 0.049927968531847, -0.05313970893621445, -0.04070151597261429, -0.016759447753429413, 0.02008797787129879, 0.01602950692176819, -0.01832152158021927, -0.029825393110513687, -0.03731458634138107, -0.0068906438536942005, -0.0058942739851772785, 0.025518739596009254, -0.026117291301488876, 0.010197277180850506, -0.0148032046854496, -0.019956588745117188, 0.026000501587986946, -0.05620546266436577, 0.050132352858781815, 0.002686183201149106, 0.045957088470458984, -0.00014085581642575562, -0.005018345080316067, -0.0414898507297039, 0.08005993813276291, -0.03819051757454872, 0.01884707808494568, -0.022715765982866287, 0.021708447486162186, 0.015197372995316982, -0.0638260468840599, -0.022890951484441757, -0.026861831545829773, -0.008876083418726921, -0.006011064630001783, 0.01956242136657238, 0.031212279573082924, 0.04575270786881447, 0.014146258123219013, -0.03211740776896477, -0.01409516204148531, -0.009270251728594303, 0.008525711484253407, -0.010788529179990292, 0.020292362198233604, 0.0017034999327734113, 0.021285081282258034, -0.02566472813487053, 0.019898192957043648, -0.026832634583115578, 0.0313582681119442, 0.014941893517971039, 0.011861542239785194, 0.06756334751844406, 0.03100789710879326, 0.027620971202850342, -0.031329069286584854, -0.04475998505949974, -0.03170863911509514, -0.045314740389585495, 0.050365936011075974, -0.019124455749988556, 0.008730094879865646, 0.008905281312763691, 0.0031861928291618824, -0.034044452011585236, -0.012846962548792362, -0.010087785311043262, 0.03617588058114052, -0.017649974673986435, -0.01036516297608614, 0.006200849544256926, 1.5069291293912102e-05, -0.024248642846941948, 0.015825122594833374, 0.008175340481102467, -0.022657370194792747, 0.0256793275475502, -0.010781229473650455, -0.0012190015986561775, -0.00837242417037487, 0.02056973986327648, -0.01632148213684559, 0.01997118815779686, -0.018102537840604782, 0.016584260389208794, 0.0007053055451251566, -0.007861465215682983, 0.00898557435721159, -0.030336352065205574, -0.009759312495589256, -0.00022571146837435663, 0.033986058086156845, -0.03959200531244278, -0.004390595480799675, -0.09004553407430649, -0.012803166173398495, -0.010554947890341282, -0.009737414307892323, -0.022949347272515297, -0.00013469693658407778, 0.009912599809467793, -0.054657988250255585, -0.0016332431696355343, 0.011766649782657623, -0.02113909274339676, -0.04654104262590408, -0.0021989475935697556, -0.020117176696658134, 0.005657043308019638, 0.01113160140812397, 0.022774161770939827, -0.003261011792346835, -0.016890836879611015, 0.028088131919503212, -0.006850496865808964, -0.008241035044193268, 0.01897846721112728, 0.06744655221700668, -0.03328531235456467, 0.04000077024102211, -0.012241112068295479, 0.0036661289632320404, 0.010825025849044323, 0.01632148213684559, 0.029927583411335945, -0.012671777047216892, -0.016438273712992668, 0.01715361513197422, -0.023708486929535866, -0.00025730422930791974, -0.0017682822654023767, -0.014540426433086395, 0.0025766920298337936, 0.013992970809340477, -0.039737991988658905, 0.03319771960377693, 0.020248565822839737, -0.0319422222673893, -0.017109818756580353, 0.016190093010663986, -0.02502238005399704, 0.009496533311903477, -0.04227818548679352, -0.0024562517646700144, 0.012825064361095428, 0.021752243861556053, 0.00682859867811203, -0.03626347333192825, -0.0165550634264946, -0.008365124464035034, 0.006222747731953859, -0.03725619241595268, 0.021547861397266388, 0.007613285444676876, 0.018073340877890587, -0.007091377396136522, 0.009270251728594303, 0.034570008516311646, -0.010204575955867767, -0.012525788508355618, -0.03054073452949524, -0.01680324412882328, 0.004025625064969063, 0.027708563953638077, -0.03124147839844227, -0.05439520999789238, 0.025343554094433784, 0.0009699091897346079, 0.002268292009830475, -0.024102654308080673, 0.016701051965355873, -0.03229259327054024, 0.0053103212267160416, -0.01345281396061182, 0.01113160140812397, 0.04677462577819824, -0.012854262255132198, 0.0008394322358071804, 0.014759408310055733, -0.003872337518259883, -0.030161164700984955, -0.04694981127977371, 0.0044343918561935425, -0.048906050622463226, -0.03238018602132797, 0.014489330351352692, -0.0018476633122190833, 0.03363568335771561, -0.049022842198610306, 0.011299488134682178, 0.003062102710828185, 0.028102731332182884, 0.019474828615784645, -0.023693887516856194, -0.020248565822839737, -0.019343437626957893, -0.003441672073677182, -0.01592731475830078, 0.008058549836277962, 0.03343130275607109, 0.020482147112488747, 0.022657370194792747, 0.009810407646000385, -0.009686318226158619, -0.002837645821273327, 0.0213288776576519, -0.010642540641129017, 0.01703682541847229, 0.036321867257356644, 0.0009799458784982562, -0.044088441878557205, 0.011233793571591377, -0.02548954263329506, 0.014496630057692528, 0.0063066910952329636, -0.010686337016522884, -0.006175301503390074, -0.01956242136657238, -0.022817958146333694, 0.049139633774757385, 0.0304823387414217, 0.02820492349565029, -0.034978777170181274, 0.004726368468254805, -0.05340249091386795, 0.005408863537013531, -0.009036670438945293, -0.018788684159517288, 0.01527036726474762, -0.030803512781858444, 0.0019452929263934493, 0.016058703884482384, 0.04134386405348778, 0.03626347333192825, 0.012919956818223, 0.009036670438945293, -0.020175570622086525, -0.025051577016711235, 0.03494957834482193, 0.039037249982357025, -0.014927295036613941, 0.006200849544256926, -0.008219136856496334, -0.014306845143437386, -0.010730133391916752, 0.013000250793993473, 0.01483240257948637, -0.0313582681119442, 0.03816131874918938, -0.05106667801737785, -0.02614649012684822, 0.01406596414744854, 0.0072957612574100494, 0.02620488405227661, 0.023839876055717468, 0.03442402184009552, 0.009766611270606518, -0.00039325575926341116, -0.013168136589229107, 0.02550414204597473, -0.04227818548679352, 0.004317601677030325, -0.021942028775811195, -0.011737452819943428, 0.0377233549952507, -0.014270348474383354, -0.053840454667806625, -0.02690562792122364, 0.01802954450249672, 0.0018385391449555755, -0.018949270248413086, -0.013321424834430218, -0.01779596321284771, -0.01750398613512516, 0.009700916707515717, 0.049431610852479935, -0.018701089546084404, -0.007054880727082491, -0.006576769053936005, -0.008693598210811615, -0.006759254261851311, -0.01113160140812397, -0.001954417210072279, -0.004562131594866514, 0.0007878801552578807, -0.005084039643406868, -0.03176703676581383, -0.06575309485197067, -0.004952650051563978, -0.008087746798992157, 0.010613343678414822, 0.004521985072642565, -0.03436562418937683, 0.0064928256906569, 0.00978121068328619, -0.006835898384451866, 0.027153808623552322, 0.0230807363986969, 0.013175436295568943, 0.021533261984586716, -0.04668703302741051, 0.012146219611167908, 0.004803012125194073, -0.002746403217315674, 0.0060913581401109695, -0.025825316086411476, -0.022000424563884735, 0.006748305168002844, -0.028350912034511566, -0.02836550958454609, 0.027796156704425812, 0.02801513858139515, -0.011284888722002506, 0.01439443789422512, 0.028818074613809586, 0.01927044428884983, -0.013292226940393448, -0.03413204476237297, 0.013839682564139366, 0.002461726311594248, 0.004660673905164003, 0.02049674466252327, -0.025839913636446, 0.00471176952123642, 0.02649686112999916, -0.0021350777242332697, -0.01791275478899479, 0.005186231341212988, 0.022190209478139877, -0.004803012125194073, 0.02848230116069317, 0.001981789944693446, 0.0011277589946985245, -0.021635454148054123, -0.008365124464035034, 0.026292476803064346, 0.010321366600692272, 0.010985612869262695, -0.025577135384082794, -0.0023266870994120836, 0.013606101274490356, 0.04808851704001427, -0.002766476711258292, -0.01820473000407219, 0.014701013453304768, 0.0005547552136704326, 0.03670143708586693, -0.017357999458909035, -0.01967921108007431, -0.00605121161788702, -0.034219637513160706, -0.022365394979715347, 0.004219059366732836, -0.02649686112999916, 0.005120536778122187, -0.021912831813097, -0.03766496106982231, -0.026117291301488876, 0.011715554632246494, -0.03191302344202995, 0.000316155725158751, -0.004025625064969063, 0.018073340877890587, 0.011387080885469913, -0.13512669503688812, -0.010255672037601471, -0.0066972095519304276, -0.026000501587986946, 0.007547590881586075, -0.00824833381921053, 0.04738777503371239, 0.03646785765886307, 0.0213288776576519, -0.02461361326277256, 0.03784014657139778, -0.03182543069124222, 0.0031843679025769234, -0.01821932941675186, 0.012226512655615807, -0.04227818548679352, -0.010321366600692272, -0.02995678223669529, 0.0383073091506958, -0.012168117798864841, -0.007781171705573797, -0.014000269584357738, 8.308782707899809e-05, 0.012919956818223, 0.009474635124206543, -0.0012372501660138369, -0.0047373175621032715, 0.024628212675452232, 0.012525788508355618, -0.0029015156906098127, -0.02056973986327648, 0.008511113002896309, 0.007751974277198315, 0.049431610852479935, -0.03246777877211571, 0.03348969668149948, -0.00904397014528513, -0.03232179209589958, 0.026628250256180763, 0.022234005853533745, 0.021883632987737656, -0.033869266510009766, 0.0027172055561095476, 0.01459882128983736, 0.020058780908584595, -0.008897981606423855, 0.008219136856496334, -0.006532972678542137, 0.005222728475928307, -0.011489272117614746, -0.010686337016522884, 0.03500797227025032, 0.013803185895085335, 0.00998559407889843, 0.012562286108732224, -0.006149753462523222, 0.0025876411236822605, -0.0038285409100353718, 0.0025055226869881153, 0.012642579153180122, -0.015226570889353752, 0.0265552569180727, 0.00467162299901247, -0.01804414391517639, -0.03346049785614014, -0.019139055162668228, 0.008379723876714706, 0.010058588348329067, -0.0010456405580043793, -0.03643865883350372, -0.017080621793866158, 0.030511537566781044, 0.023285120725631714, 0.021489465609192848, 0.010124282911419868, 0.04248256981372833, 0.01169365644454956, 0.028117330744862556, -0.058658063411712646, -0.007449048571288586, 0.03226339444518089, -0.034278031438589096, -0.010241073556244373, -0.01544555276632309, 0.020993106067180634, -0.011795847676694393, 0.035270754247903824, -0.002242743968963623, -0.014292246662080288, 0.03518316149711609, 0.03153345361351967, -0.025839913636446, -0.0012664477108046412, 0.019416432827711105, -0.016073303297162056, -0.017941951751708984, -0.007445399183779955, 0.0182777252048254, -0.009022071957588196, 0.021869035437703133, 0.05608867108821869, 0.027766957879066467, -0.015956511721014977, -0.06960718333721161, 0.005890624597668648, 0.0077592735178768635, 0.009153461083769798, -0.008131543174386024, 0.03494957834482193, -0.0163944773375988, 0.02848230116069317, 0.014518528245389462, 0.0023230374790728092, 0.009868803434073925, 0.0021131793037056923, 0.02354789897799492, 0.03372327610850334, 0.012270309962332249, 0.019985787570476532, -0.026219483464956284, 0.0063030412420630455, 0.0027719512581825256, -0.03518316149711609, 0.001048377831466496, -0.033343710005283356, 0.003671603510156274, 0.027912946417927742, 0.05238057300448418, -0.00045142293674871325, 0.010000192560255527, -0.03378167375922203, 0.04017595574259758, 0.004120517522096634, 0.014175456017255783, 0.005620546173304319, -0.013467412441968918, -0.024890990927815437, 0.01832152158021927, -0.03848249465227127, 0.0313582681119442, -0.004441691562533379, 0.009131562896072865, 0.003744597779586911, -0.009124263189733028, -0.029183045029640198, 0.008051250129938126, -0.010065887123346329, -0.013175436295568943, -0.002448952291160822, -0.005514704622328281, 0.012722873128950596, -0.032701361924409866, -0.006445379927754402, 0.015197372995316982, 0.026292476803064346, 0.01826312579214573, -0.030920304358005524, -0.03042394481599331, -0.015664534643292427, 0.015883518382906914, 0.04823450744152069, 0.026745041832327843, -0.015606139786541462, -0.004897904582321644, 0.012627980671823025, -0.029504219070076942, -0.04773814603686333, -0.022350795567035675, -0.04198621213436127, 0.03424883633852005, -0.015547744929790497, -0.018292322754859924, 0.031621046364307404, 0.026774238795042038, 0.034861985594034195, 0.02877427637577057, 0.017693771049380302, 0.006620565429329872, 0.012657178565859795, 0.039913177490234375, 0.007569489069283009, -0.014182754792273045, -0.01048925332725048, 0.01529956515878439, 0.04330010339617729, -0.03588390350341797, -0.005934420973062515, 0.03013196773827076, -0.018657293170690536, 0.036321867257356644, -0.017518585547804832, 0.03202981501817703, -0.019898192957043648, 0.03331451117992401, 0.002994583221152425, -0.010073186829686165, 0.01506598386913538, 0.024934787303209305, -0.02550414204597473, -0.0020274112466722727, -0.005664342548698187, 0.02562093175947666, -0.011000212281942368, 0.019431032240390778, -0.029168445616960526, 0.01048925332725048, -0.008897981606423855, -0.006014714483171701, -0.01991279236972332, 0.010496553033590317, -0.01489079836755991, -0.004208110272884369, -0.01786895841360092, 0.04233658313751221, -0.022058818489313126, -0.028920264914631844, 0.018306922167539597, 0.02867208607494831, -0.05614706873893738, -0.011095104739069939, -0.02696402370929718, -0.00957682728767395, -0.03982558473944664, 0.0010812252294272184, -0.029810793697834015, 0.012124321423470974, 0.01626308634877205, 0.008591406047344208, -0.044789183884859085, 0.017898155376315117, 0.028569893911480904, 0.01902226358652115, 0.012204614467918873, -0.03071592003107071, -0.023285120725631714, -0.008292130194604397, -0.006463628262281418, -0.016584260389208794, -0.02443842776119709, 0.013766688294708729, 0.01832152158021927, 0.0050219944678246975, 0.0035128414165228605, -0.01797114871442318, 0.0068906438536942005, -0.04335850104689598, 0.008970975875854492, 0.028803475201129913, -0.014182754792273045, -0.016949232667684555, 0.011657158844172955, 0.007598686497658491, 0.008131543174386024, -0.012598782777786255, 0.004204460419714451, 0.0010958240600302815, 0.001453495118767023, 0.03728539124131203, 0.04189861938357353, 0.028219522908329964, -0.02591290883719921, -0.0012728347210213542, 0.015839722007513046, 0.0010465530212968588, 0.02125588431954384, -0.016248488798737526, -0.0006793013890273869, -0.005076740402728319, 0.0013394418638199568, -0.001498204073868692, -0.02878887578845024, 0.011788547970354557, 0.00537601625546813, 0.03816131874918938, 0.011350583285093307, -0.009890701621770859, 0.013255730271339417, -0.011474673636257648, 0.008438118733465672, 0.008518412709236145, -0.01633608154952526, 0.007722776383161545, -0.027796156704425812, -0.026350872591137886, 0.01159876398742199, -0.03722699359059334, -0.02665744721889496, -0.002737279050052166, 0.05997195839881897, -0.012241112068295479, 0.04111028090119362, 0.02865748666226864, 0.004653374198824167, -0.00709502724930644, -0.024307038635015488, -0.001655141357332468, 0.005850477609783411, 0.012219213880598545, 0.016759447753429413, -0.03728539124131203, 0.01845291070640087, 0.008598705753684044, 0.005952669307589531, -0.02626327984035015, 0.03883286565542221, 0.029241438955068588, 0.011022110469639301, -0.04151904955506325, -0.02102230302989483, -0.022365394979715347, 0.020423751324415207, 0.04505196213722229, 0.03112468682229519, 0.023869073018431664, 0.03591310232877731, 0.014255749061703682, 0.018774084746837616, -0.010810427367687225, 0.00857680756598711, 0.007357805967330933, 0.003136921674013138, 0.013036747463047504, -0.003740947926416993, 0.0042555565014481544, -0.00918995775282383, -0.01183964405208826, -0.0014124360168352723, -0.036321867257356644, -0.003100424772128463, 0.010700936429202557, 0.028102731332182884, 0.014686414040625095, 0.01524116937071085, 0.017401795834302902, -0.012657178565859795, -0.0010319541906937957, -0.011525769717991352, -0.004715419374406338, -0.013876180164515972, -0.022234005853533745, 0.017109818756580353, 0.007419851142913103, 0.010781229473650455, 0.006116906180977821, -0.012664477340877056, -0.007102326489984989, -0.0031734188087284565, -0.02067193202674389, 0.002489099046215415, -0.03766496106982231, 0.07813289016485214, -0.004708120133727789, -0.001275571994483471, -0.017314203083515167, -0.018525904044508934, 0.01579592563211918, 0.013087843544781208, -0.01956242136657238, -0.023124532774090767, 0.0021022302098572254, 0.0011341460049152374, 0.015138978138566017, 0.008080448023974895, 0.02208801731467247, 0.021869035437703133, -0.019985787570476532, -0.010321366600692272, 0.02284715510904789, 0.027401987463235855, 0.015372559428215027, 0.009387042373418808, 0.024000462144613266, 0.0038139421958476305, -0.02102230302989483, -0.021416470408439636, -0.0029891086742281914, 0.008533011190593243, 0.008584107272326946, 0.017197411507368088, 0.0333729051053524, 0.02449682168662548, 0.005135135259479284, -0.036497052758932114, 0.03611748293042183, -0.007905261591076851, 0.004361398052424192, -0.02113909274339676, 0.03743137791752815, -0.020233966410160065, 0.005883324891328812, 0.009832306765019894, -0.002479974878951907, 0.01169365644454956, 0.030394745990633965, -0.0012737471843138337, 0.017489388585090637, -0.007131524384021759, 0.010810427367687225, -0.0025201216340065002, 0.007708177901804447, 0.027518779039382935, 0.0022171959280967712, 0.016817841678857803, -0.01416085660457611, 0.03246777877211571, -0.012781267985701561, 0.005105937831103802, 0.022131813690066338, 0.010387061163783073, 0.007708177901804447, -0.05074550211429596, 0.016073303297162056, -0.03635106608271599, 0.010087785311043262, -0.009255653247237206, -0.05492076650261879, -0.016847040504217148, -1.0336079867556691e-06, 0.010022090747952461, 0.03430723026394844, 0.0036424060817807913, 0.0021442018914967775, -0.0019635416101664305, 0.021241284906864166, 0.009116964414715767, 0.031445860862731934, -0.0009037582785822451, 0.003916133660823107, 0.048614077270030975, 0.021869035437703133, -0.014051365666091442, 0.00518258148804307, -0.013620700687170029, -0.004354098346084356, -0.016701051965355873, 0.007350506726652384, 0.031329069286584854, -0.013416317291557789, 0.012576884590089321, 0.009970994666218758, -0.022540580481290817, 0.0020383603405207396, 0.01680324412882328, -0.010781229473650455, -0.002009162912145257, -0.030277956277132034, -0.0119783328846097, -0.015606139786541462, 0.016701051965355873, 0.020350757986307144, -0.013555006124079227, -0.0200295839458704, -0.011292188428342342, 0.007127874530851841, -0.0006122380727902055, 0.021985825151205063, -0.04689141362905502, -0.01732880063354969, 0.00032117406954057515, -0.014073263853788376, 0.00011439545050961897, 0.008182639256119728, -0.01181044615805149, -0.012051327154040337, -0.019650014117360115, 0.017255807295441628, -0.013832383789122105, 0.03124147839844227, -0.008000154048204422, -0.030569931492209435, 0.0327889546751976, 0.023212125524878502, 0.01610250025987625, 0.004573080688714981, -0.01732880063354969, -0.02185443602502346, -0.018890874460339546, -0.020482147112488747, -0.00014929576718714088, -0.017649974673986435, -0.014467432163655758, -0.02602969855070114, -0.006116906180977821, 0.015562343411147594, 0.0025255961809307337, 0.029329031705856323, 0.02696402370929718, -0.018409114331007004, -0.018598899245262146, 0.008160741068422794, 0.0022628172300755978, 0.01604410447180271, -0.012781267985701561, -0.012861561961472034, -0.01294915471225977, 0.009131562896072865, -0.013467412441968918, 0.00010213472705800086, 0.02708081342279911, 0.0033942260779440403, -0.009868803434073925, -0.01028486993163824, -0.010613343678414822, 0.003136921674013138, -0.027737760916352272, -0.023036940023303032, 0.004219059366732836, 0.007824968546628952, 0.0047227186150848866, 0.022234005853533745, -0.0041533648036420345, -0.009569527581334114, -0.027577172964811325, 0.031037094071507454, 0.015985708683729172, -0.004357748199254274, -0.01592731475830078, 0.017708370462059975, 0.02078872174024582, -0.011584164574742317, 0.013416317291557789, 0.01391997653990984, 0.02014637365937233, 0.003102249465882778, -0.030628327280282974, -0.020832518115639687, -0.03200061619281769, 0.007346856873482466, -0.0128396637737751, 0.018482107669115067, 0.0071753207594156265, -0.011963734403252602, 0.058249298483133316, 0.025124572217464447, -0.0007157984655350447, -0.001981789944693446, -0.01527036726474762, 0.003846789477393031, -0.014876198954880238, -0.01315353810787201, 0.01837991550564766, -0.004733667708933353, -0.023066138848662376, -0.01890547387301922, 0.015357960015535355, 0.0444096140563488, 0.0055220043286681175, 0.03699341416358948, 0.018817881122231483, 0.024890990927815437, -0.03191302344202995, 0.0023814328014850616, 0.017489388585090637, -0.024876391515135765, -0.009116964414715767, 0.013700993731617928, -0.005408863537013531, -0.012963753193616867, 0.004503736272454262, -0.009328646585345268, 0.01956242136657238, 0.010985612869262695, 0.0011487447191029787, 0.034102845937013626, 0.030861908569931984, -0.03816131874918938, -0.016876237466931343, -0.004248257260769606, -0.015372559428215027, -0.018365317955613136, 0.014774007722735405, 0.02566472813487053, 0.013401717878878117, 0.021358076483011246, -0.031796231865882874, 0.009160760790109634, 0.02237999252974987, 0.013284927234053612, -0.005379665642976761, 0.0043467991054058075, -0.0018513130489736795, 0.0036661289632320404, 0.01927044428884983, -0.014978391118347645, 0.016963830217719078, -0.018759485334157944, 0.0003955368301831186, -0.019109858199954033, 0.0191536545753479, -0.0038905858527868986, -0.03784014657139778, 0.005456309765577316, 0.016876237466931343, 0.044964369386434555, 0.014722911641001701, 0.04843888804316521, 0.021927429363131523, -0.001812078757211566, -0.01368639525026083, 0.0020383603405207396, -0.025635531172156334, 0.024745002388954163, -0.009255653247237206, -0.06405963003635406, 0.004613227676600218, -0.02643846534192562, -0.024686606600880623, -0.01845291070640087, 0.0227887611836195, 0.03208820894360542, 0.012190015986561775, -0.018890874460339546, 0.009065868332982063, 0.002764651784673333, -0.009970994666218758, 0.03506636992096901, -0.023416509851813316, 0.010116983205080032, 0.009153461083769798, -0.03459920734167099, -0.03173783794045448, 0.011423577554523945, -0.03007357195019722, -0.007379704155027866, 0.021927429363131523, 0.036029890179634094, 0.004806661978363991, -0.027854550629854202, 0.010576846078038216, 0.01820473000407219, 0.045577522367239, -0.004726368468254805, -0.01042355876415968, 0.012861561961472034, -0.017314203083515167, -0.0007390653481706977, -0.01637987792491913, -0.010554947890341282, 0.013773988001048565, 0.02121208794414997, 0.025299757719039917, 0.016540464013814926, 0.013839682564139366, -0.038978852331638336, 0.005456309765577316, -0.001426122384145856, -0.004653374198824167, -0.03316852077841759, -0.022467587143182755, 0.0036862024571746588, -0.0331101268529892, -0.03167944401502609, 0.00028809861396439373, 0.007781171705573797, 0.011613362468779087, 0.01697842963039875, -0.002852244768291712, 0.022102616727352142, 0.008350525982677937, 0.012387099675834179, 0.01281046587973833, 0.02284715510904789, -0.01163526065647602, 0.0038905858527868986, -0.005923471879214048, 0.014752109535038471, 0.02102230302989483, 0.027095412835478783, -0.008036651648581028, 0.038102924823760986, -0.004481838084757328, 0.005832229275256395, 0.02461361326277256, -0.02708081342279911, -0.00022023690689820796, 0.009876103140413761, 0.007591387256979942, 0.005386965349316597, 0.017941951751708984, 0.0038540889509022236, 0.0148032046854496, -0.027416586875915527, 0.02302234247326851, -0.017547784373164177, 0.008715496398508549, -0.003414299339056015, 0.017941951751708984, 0.022598976269364357, 0.03363568335771561, -0.019007666036486626, -0.03778174892067909, 0.00463877571746707, -0.02908085286617279, -0.040905896574258804, -0.01656966283917427, 0.013160837814211845, -0.010146181099116802, -0.0019635416101664305, -0.01251119002699852, 0.004401544574648142, 0.05515434592962265, 0.028686683624982834, 0.012467393651604652, 0.005963618401437998, 0.008642502129077911, 0.00456943130120635, 0.00750379404053092, -0.019109858199954033, -0.014825102873146534, -0.0075621893629431725, -0.01874488592147827, -0.01849670708179474, 0.01092721801251173, 0.03071592003107071, 0.003556637791916728, -0.012591484002768993, 0.003857738571241498, -0.006069459952414036, -0.0067848023027181625, 0.007817668840289116, -0.03124147839844227, 0.03141666576266289, 0.0009790334152057767, 0.002231794875115156, -0.01183964405208826, 0.011051308363676071, -0.012700974941253662, -0.026511460542678833, -0.0031752437353134155, 0.010241073556244373, 0.034686800092458725, -0.014876198954880238, 0.004835859406739473, -0.0001230635098181665, 0.006635164376348257, -0.01042355876415968, -0.0066935596987605095, 0.00024817997473292053, 0.004919802770018578]",Online Speculative Decoding.pdf
", and Beidi Chen. 2024. Sequoia: Scalable,
Robust, and Hardware-aware Speculative Decoding. arXiv preprint
arXiv:2402.12374 (2024).
[7]Tim Dettmers, Mike Lewis, Younes Belkada, and Luke Zettlemoyer.
2022. LLM.int8(): 8-bit Matrix Multiplication for Transformers at Scale.
arXiv:2208.07339 [cs.LG]
[8]Elias Frantar and Dan Alistarh. 2024. Marlin: a fast 4-bit inference
kernel for medium batchsizes. https://github.com/IST-DASLab/marlin .
[9]Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan Alistarh.
2023. GPTQ: Accurate Post-Training Quantization for Generative
Pre-trained Transformers. arXiv:2210.17323 [cs.LG]
[10] Yichao Fu, Peter Bailis, Ion Stoica, and Hao Zhang. 2024. Break the
sequential dependency of llm inference using lookahead decoding.
arXiv preprint arXiv:2402.02057 (2024).
[11] Pin Gao, Lingfan Yu, Yongwei Wu, and Jinyang Li. 2018. Low latency
rnn inference with cellular batching. In Proceedings of the Thirteenth
EuroSys Conference . 1‚Äì15.
[12] Karl Moritz Hermann, Tom√°s Kocisk√Ω, Edward Grefenstette, Lasse Es-
peholt, Will Kay, Mustafa Suleyman, and Phil Blunsom. 2015. Teaching
Machines to Read and Comprehend. In NIPS . 1693‚Äì1701. http://papers.
nips.cc/paper/5945-teaching-machines-to-read-and-comprehend
[13] Albert Q Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford,
Devendra Singh Chaplot, Diego de las Casas, Florian Bressand, Gianna
Lengyel, Guillaume Lample, Lucile Saulnier, et al .2023. Mistral 7B.
arXiv preprint arXiv:2310.06825 (2023).
[14] Albert Q Jiang, Alexandre Sablayrolles, Antoine Roux, Arthur Mensch,
Blanche Savary, Chris Bamford, Devendra Singh Chaplot, Diego de las
Casas, Emma Bou Hanna, Florian Bressand, et al .2024. Mixtral of
experts. arXiv preprint arXiv:2401.04088 (2024).
[15] Jordan Juravsky, Bradley Brown, Ryan Ehrlich, Daniel Y. Fu, Christo-
pher R√©, and Azalia Mirhoseini. 2024. Hydragen: High-Throughput
LLM Inference with Shared Prefixes. arXiv:2402.05099 [cs.LG]
[16] Ehsan Kamalloo, Aref Jafari, Xinyu Zhang, Nandan Thakur, and Jimmy
Lin. 2023. HAGRID: A Human-LLM Collaborative Dataset for Genera-
tive Information-Seeking with Attribution. arXiv:2307.16883 (2023).
[17] Sehoon Kim, Coleman Hooper, Amir Gholami, Zhen Dong,
Xiuyu Li, Sheng Shen, Michael W. Mahoney, and Kurt
Keutzer. 2024. SqueezeLLM: Dense-and-Sparse Quantization.
arXiv:2306.07629 [cs.CL]
[18] Sehoon Kim, Karttikeya Mangalam, Suhong Moon, Jitendra Malik,
Michael W Mahoney, Amir Gholami, and Kurt Keutzer. 2024. Specula-
tive decoding with big little decoder. Advances in Neural Information
Processing Systems 36 (2024).
[19] Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng, Lianmin
Zheng, Cody Hao Yu, Joseph Gonzalez, Hao Zhang, and Ion Stoica.
14
2023. Efficient memory management for large language model serving
with pagedattention. In Proceedings of the 29th Symposium on Operating
Systems Principles . 611‚Äì626.
[20] Yaniv Leviathan, Matan Kalman, and Yossi Matias. 2023. Fast inference
from transformers via speculative decoding. In International Conference
on Machine Learning . PMLR, ","[0.004565311595797539, 0.02042684331536293, 0.013417919166386127, -0.00746618676930666, 0.004338509403169155, 0.007550323382019997, 0.0005894117639400065, 0.042814429849386215, -0.06888937950134277, -0.017851538956165314, 0.04942828044295311, -0.0042909542098641396, -0.03980015218257904, 0.019446471706032753, -0.005198163446038961, -0.037634555250406265, 0.018773380666971207, -0.014376342296600342, 0.002125357510522008, 0.04351678490638733, -0.018553895875811577, -0.03725411370396614, 0.005915151443332434, 0.02518237568438053, 0.015803001821041107, -0.00846484862267971, -0.013249646872282028, 0.041234128177165985, 0.020251253619790077, -0.028650257736444473, 0.04067809879779816, -0.026396866887807846, -0.021831555292010307, -0.016432195901870728, -0.010447540320456028, 0.02657245472073555, 0.011566919274628162, 0.006130979396402836, -0.05861743167042732, 0.01684190332889557, -0.0036782219540327787, -0.07889795303344727, -0.047672390937805176, 0.010732872411608696, 0.005973680876195431, 0.03704925999045372, 0.009064777754247189, 0.0085745919495821, -0.015583516098558903, 0.07971736788749695, 0.00324107869528234, 0.010630445554852486, -0.03324483335018158, 0.04691150411963463, -0.03988794609904289, -0.009335476905107498, -0.02813812345266342, 0.03546895831823349, 0.03438616171479225, -0.024933625012636185, 0.008552643470466137, -0.054549623280763626, 0.004649448208510876, -0.006057817488908768, -0.04664812237024307, -0.014230018481612206, -0.03368380665779114, 0.05820772424340248, 0.00794539786875248, 0.02073412388563156, -0.024084946140646935, 0.01185225136578083, 0.047584593296051025, -0.04053177312016487, -0.021743759512901306, 0.008018560707569122, -0.005421307869255543, 0.09657390415668488, -0.015203073620796204, -0.026001790538430214, 0.003950750455260277, 0.011713244020938873, 0.03122556209564209, -0.03438616171479225, -0.004832352977246046, -0.022475380450487137, 0.01043290738016367, 0.023441119119524956, -0.05048181116580963, -0.01810028962790966, -0.012722879648208618, -0.0071918293833732605, -0.037517499178647995, 0.00677114725112915, 0.027069957926869392, -0.011237690225243568, 0.04571164771914482, -0.021655965596437454, 0.026952898129820824, 0.045038554817438126, -0.02213883586227894, 0.007960030809044838, 0.05835404992103577, -0.04173162952065468, 0.0227533970028162, -0.016754109412431717, -0.03301071375608444, -0.019241617992520332, -0.014610460959374905, 0.004232424311339855, -0.1100357174873352, -0.010257318615913391, -0.029059965163469315, 0.0011001742677763104, -0.005249376874417067, -0.040590304881334305, -0.06648966670036316, -0.027786945924162865, -0.03728337958455086, 0.022811926901340485, -0.022036409005522728, -0.011405963450670242, 0.015627413988113403, 0.033917926251888275, 0.011815670877695084, -0.007652750238776207, 0.027450399473309517, -0.07667382806539536, 0.002703337697312236, 0.0008239875314757228, -0.0005121343419887125, 0.010418275371193886, 0.05662742257118225, -0.005798092111945152, -0.009452536702156067, -0.037517499178647995, -0.019739119336009026, 0.002827713033184409, -0.04184868931770325, -0.007586904335767031, 0.037429701536893845, -0.0006945821805857122, -0.001658949418924749, 0.0024527576752007008, -0.034239836037158966, 0.03268880397081375, 0.005446914583444595, -0.023953253403306007, -0.023645972833037376, -0.000339974882081151, -0.017939332872629166, -0.019534265622496605, -0.011018204502761364, -0.008223414421081543, -0.02246074751019478, -0.04053177312016487, -0.016900433227419853, 0.05574947968125343, 0.03748823329806328, -0.05124269798398018, -0.003352650674059987, 0.06678231805562973, 0.022519277408719063, 0.023748399689793587, 0.03584940358996391, 0.04316560924053192, -0.03640543296933174, 0.01818808540701866, -0.06297788769006729, -0.03649323061108589, 0.009818346239626408, -0.017924701794981956, -0.012913101352751255, -0.029162392020225525, -0.004810404498130083, -0.01619807630777359, -0.022885087877511978, -0.04749679937958717, -0.0021015796810388565, -0.06725054979324341, -0.012730196118354797, 0.03526410460472107, -0.03143041580915451, 0.004653105977922678, -0.03930265083909035, -0.018246615305542946, -0.0036178631708025932, 0.010586547665297985, 0.018670953810214996, 0.05004284158349037, -0.026177380234003067, 0.04898930713534355, 0.06297788769006729, 0.0324254184961319, 0.00888918898999691, -0.022680234163999557, 0.04650179669260979, -0.022943617776036263, 0.0378686748445034, -0.05768095701932907, 0.012452180497348309, 0.051476817578077316, 0.00228814291767776, -0.03479586914181709, 0.04413134604692459, -0.01524697057902813, -0.01798323169350624, -0.00618950929492712, -0.016476092860102654, -0.01174250803887844, 0.054549623280763626, 0.019958605989813805, 0.042082808911800385, 0.022080305963754654, -0.029615996405482292, -0.002075972966849804, -0.0531449094414711, -0.0025844492483884096, 0.008523378521203995, 0.03845397010445595, -0.0008052397752180696, 0.0342983677983284, -0.020997507497668266, 0.019724488258361816, -0.014603144489228725, 0.03549822419881821, -0.003155113197863102, -0.013315492309629917, 0.03564454987645149, 0.006961368955671787, 0.052032846957445145, -0.045243408530950546, -0.020558534190058708, -0.03368380665779114, 0.014756784774363041, -0.021304788067936897, 0.0005217368598096073, -0.02942577563226223, 0.005278641823679209, -0.04623841494321823, 0.029381878674030304, 0.0009757988154888153, 0.01915382407605648, 0.0015400610864162445, 0.0006104458007030189, 0.025577452033758163, -0.03567381203174591, -0.05999287962913513, 0.03865882381796837, 0.009818346239626408, -0.015173808671534061, -0.032220564782619476, 0.0012455838732421398, -0.00021136972645763308, -0.05776875093579292, -0.0026704147458076477, -0.01444950420409441, -0.020236622542142868, -0.04893077537417412, 0.006423627492040396, -0.028855111449956894, -0.004777481779456139, -0.016476092860102654, 0.016915064305067062, -0.010813350789248943, 0.01619807630777359, -0.02562134899199009, 0.05220843479037285, 0.018451469019055367, -0.02560671605169773, 0.011105998419225216, -0.023104574531316757, 0.010630445554852486, 0.011281587183475494, -0.061982885003089905, -0.040180597454309464, 0.025109214708209038, 0.03813206031918526, -0.04776018485426903, 0.056481100618839264, 0.006098056677728891, 0.02423126995563507, 0.03734190762042999, 0.01174250803887844, 0.014734836295247078, 0.035088516771793365, 0.00836973823606968, -0.017851538956165314, -0.050774458795785904, -0.012152215465903282, 0.04383869841694832, -0.021963246166706085, -0.0035575046204030514, -0.03821985423564911, 0.024289799854159355, 0.029133126139640808, 0.019958605989813805, -0.005702981725335121, -0.0067638312466442585, -0.025460392236709595, 0.06274376809597015, -0.013827626593410969, 0.018714850768446922, -0.04477517306804657, -0.030611000955104828, 0.06648966670036316, -0.050950050354003906, 0.00677114725112915, 0.03479586914181709, 0.012664350681006908, -0.005007942207157612, -0.003670905716717243, -0.021773025393486023, 0.010674342513084412, -0.033596012741327286, -0.06151464954018593, 0.033391159027814865, -0.049603868275880814, 0.01671021059155464, -0.06514348834753036, 0.001927819917909801, -0.04793577268719673, 0.006120005156844854, -0.01053533423691988, -0.0002138846757588908, 0.019080661237239838, -0.020353680476546288, -0.02180228941142559, -0.0009287007269449532, -0.03450322151184082, 0.021407214924693108, 0.03163526952266693, 0.03459101542830467, -0.0036123760510236025, -0.04498002678155899, -0.039946477860212326, -0.02964526042342186, 0.019417207688093185, 0.01852462999522686, 0.011530338786542416, -0.08001001179218292, 0.02996717393398285, -0.024099577218294144, -0.03470807522535324, -0.019768385216593742, 0.01927088387310505, -0.0030490283388644457, 0.012210745364427567, 0.06356318295001984, 0.007967347279191017, -0.006035869009792805, -0.04538973420858383, 0.050423283129930496, -0.037751615047454834, 0.007513741962611675, 0.013454500585794449, 0.02191934920847416, -0.030347617343068123, -0.027860106900334358, 0.024392226710915565, -0.03219129890203476, 0.01747109740972519, 0.014310495927929878, 0.0056993234902620316, -0.028855111449956894, -0.0045836023055016994, -0.02000250294804573, -0.0047628493048250675, 0.04146824777126312, -0.007630801293998957, 0.026177380234003067, 0.04509708657860756, -0.002090605441480875, -0.00964275747537613, -0.0018574014538899064, -0.016549255698919296, -0.008003927767276764, 0.022051040083169937, 0.022914353758096695, 0.05958317220211029, 0.005681032780557871, 0.03189865127205849, -0.0001394651480950415, -0.007981979288160801, 0.006939420010894537, 0.020792653784155846, -0.01621270924806595, -0.0029484303668141365, -0.008764812722802162, 0.00648215739056468, -0.026718778535723686, -0.004492149688303471, -0.04781871289014816, 0.02149500884115696, -0.004700661636888981, -0.0025186033453792334, -0.003136822720989585, 0.014742152765393257, 0.020251253619790077, 0.020514637231826782, -0.0050481813959777355, -0.014193437062203884, -0.005366436205804348, -0.020602433010935783, 0.004887224640697241, 0.03980015218257904, 0.0533205009996891, 0.056364040821790695, 0.03511778265237808, 0.01905139721930027, 0.021568171679973602, -0.047379739582538605, 0.026601720601320267, -0.03611278533935547, 0.010506070218980312, -0.03397645428776741, 0.012283907271921635, 0.020704859867691994, 0.02584083564579487, 0.046209149062633514, -0.014332445338368416, -0.011259638704359531, -0.053496088832616806, -0.06660673022270203, -0.029703790321946144, -0.00868433527648449, 0.0359957255423069, -0.06742614507675171, 0.044716641306877136, -0.06356318295001984, -0.06034405529499054, 0.007286939769983292, 0.01079140231013298, -0.039010003209114075, -0.008318524807691574, -0.028650257736444473, 0.01979764923453331, 0.02426053397357464, 0.0143470773473382, -0.03058173507452011, -0.012027840130031109, 0.010001251474022865, -0.00013820767344441265, 0.010966991074383259, -0.01296431478112936, 0.0043129026889801025, -0.029147759079933167, -0.011215741746127605, 0.03239615261554718, -0.018700219690799713, 0.04591650143265724, -0.009020880796015263, 0.07444969564676285, -0.011991259641945362, -0.0049494123086333275, -0.043985024094581604, 0.06836261600255966, -0.03947823867201805, 0.044102080166339874, -0.013139903545379639, 0.00909404270350933, 0.00989150907844305, -0.05665668845176697, -0.0548422709107399, -0.0012400966370478272, -0.00012963400513399392, 0.013308175839483738, 0.0058639380149543285, 0.02582620270550251, 0.025138478726148605, 0.01956353150308132, -0.03579087182879448, -0.030640264973044395, -0.01565667800605297, 0.01407637819647789, 0.01673947647213936, 0.007872235961258411, -0.028942905366420746, 0.021319421008229256, -0.05264740809798241, 0.010813350789248943, -0.030347617343068123, 0.015846898779273033, 0.006873574107885361, 0.022051040083169937, 0.04670665040612221, -0.015276235528290272, 0.02129015512764454, 0.004707977641373873, -0.01777837797999382, -0.015042116865515709, -0.0012894810643047094, 0.041438981890678406, -0.01818808540701866, 0.005392042919993401, 0.008201465010643005, -0.0007156162755563855, -0.037751615047454834, -0.02626517415046692, -0.020778020843863487, 0.004129997454583645, -0.02030978351831436, 0.01371788326650858, 0.0021527931094169617, 0.007864920422434807, -0.010864564217627048, 0.035937197506427765, 0.0249628908932209, -0.009028196334838867, 0.03944897651672363, -0.007396683096885681, 0.011486440896987915, -0.017002860084176064, 0.0033965480979532003, -0.00457628583535552, 0.04544826224446297, -0.01216684840619564, 0.019841546192765236, -0.011003571562469006, 0.0326010063290596, -0.0012748487060889602, -0.045682381838560104, -0.015642045065760612, -0.02774304710328579, 0.026323704048991203, -0.0026923632249236107, -0.02753819338977337, -0.0752105861902237, -0.009657390415668488, -0.024172740057110786, -0.007835655473172665, -0.027289442718029022, -0.0058639380149543285, 0.004129997454583645, -0.05481300503015518, 0.006591900251805782, 0.005274983588606119, -0.02562134899199009, -0.04574090987443924, -0.018378306180238724, 0.007594220340251923, 0.03587866574525833, 0.0226656012237072, 0.027596723288297653, -0.02582620270550251, -0.012005891650915146, 0.003477026242762804, -0.01726624369621277, -0.026850471273064613, 0.03535190224647522, 0.05051107704639435, -0.03178159147500992, 0.017222344875335693, -0.010981623083353043, 0.004375090356916189, -0.012027840130031109, 0.040063537657260895, 0.004901857115328312, -0.01810028962790966, 0.000409250205848366, 0.01265703421086073, -0.021216994151473045, -0.0008454789058305323, 0.006851625628769398, -0.014786049723625183, -0.010966991074383259, 0.004814062733203173, -0.03122556209564209, 0.022841190919280052, 0.028840478509664536, -0.006057817488908768, -0.03798573464155197, 0.03137188404798508, -0.018919704481959343, 0.02486046403646469, -0.02878194861114025, 0.012400967068970203, 0.015378662385046482, 0.0193586777895689, 0.016973594203591347, -0.04644326865673065, -0.03315703943371773, -0.020251253619790077, -0.01903676427900791, -0.027479665353894234, 0.031049972400069237, -0.006515080109238625, 0.020500006154179573, -0.032015711069107056, -0.019402574747800827, 0.052442554384469986, -0.015832267701625824, -0.024743404239416122, -0.03833691403269768, -0.019856179133057594, -0.008750180713832378, 0.00637973053380847, -0.04743827134370804, -0.05378873646259308, 0.019841546192765236, -0.005735904444009066, 0.0013324638130143285, -0.016915064305067062, -0.016432195901870728, -0.016373666003346443, -0.01037437841296196, -0.010740188881754875, -0.0032666854094713926, 0.006957710720598698, -0.021875452250242233, -0.01915382407605648, -0.0016991884913295507, -0.008347789756953716, -0.026967531070113182, -0.04474590718746185, -0.0022241261322051287, -0.04647253081202507, -0.005062813404947519, 0.04255104809999466, -0.0022972882725298405, 0.026192013174295425, -0.048228420317173004, 0.009072094224393368, 0.019080661237239838, 0.01725161075592041, 0.017719848081469536, -0.007762493100017309, -0.0035593335051089525, -0.024523917585611343, -0.0037385805044323206, -0.016578519716858864, -0.03830764815211296, 0.016549255698919296, 0.03754676133394241, -0.005651768296957016, -0.002498483983799815, -0.00804782472550869, 0.014983586966991425, 0.046092089265584946, -0.00024372106418013573, 0.004225108306854963, 0.025050684809684753, -0.002467389917001128, 0.0010754821123555303, 0.03154747560620308, -0.0034550775308161974, -0.006061475723981857, 0.012986263260245323, -0.03058173507452011, -0.004722610116004944, -0.03189865127205849, -0.05030622333288193, 0.0444825254380703, 0.022285159677267075, 0.02974768728017807, -0.015437191352248192, 0.003438616171479225, -0.04085368663072586, -0.006262671202421188, -0.02200714312493801, -0.04565311595797539, -0.0020595116075128317, -0.027347972616553307, 0.01621270924806595, -0.015627413988113403, 0.03602499142289162, 0.027772312983870506, 0.029250185936689377, 0.02329479530453682, -0.011340117081999779, -0.026440763846039772, 0.005574948154389858, 0.02668951451778412, -0.011084049940109253, -0.003027079626917839, -0.03693220019340515, -0.013849575072526932, -0.0012858229456469417, 0.010484120808541775, 0.016168812289834023, -0.012466812506318092, 0.031284090131521225, -0.05343755707144737, -0.041000012308359146, 0.01064507756382227, -0.0030398829840123653, 0.028942905366420746, 0.004755532834678888, 0.019753752276301384, 0.011310852132737637, -0.012700931169092655, -0.006489473395049572, -0.003429470816627145, -0.031927917152643204, 0.003259369172155857, -0.030464675277471542, 0.007967347279191017, 0.022168099880218506, -0.010820666328072548, -0.08270237594842911, -0.02889900840818882, 0.011449860408902168, -0.025694509968161583, -0.001775094191543758, -0.009723235853016376, -0.024377593770623207, -0.02169986255466938, 0.009701287373900414, 0.055193446576595306, -0.009401323273777962, -0.0013626430882140994, -0.007960030809044838, -0.008976982906460762, 0.0034806844778358936, -0.041029274463653564, 0.012101002037525177, 0.023748399689793587, 0.009554963558912277, -0.01818808540701866, -0.030523205175995827, -0.048960041254758835, -0.011471808888018131, -0.02117309533059597, 0.00698697566986084, 0.021612068638205528, -0.02127552404999733, 0.009898824617266655, 0.01403248030692339, -0.007019898388534784, 0.015334764495491982, 0.005135975778102875, 0.017295507714152336, 0.031284090131521225, -0.04231692850589752, 0.004938438069075346, 0.003363625146448612, -0.04263884201645851, -0.0074991099536418915, -0.01512991078197956, -0.021553538739681244, -0.023587442934513092, -0.04325340315699577, -0.010352429933845997, 0.05367167666554451, 0.01555425114929676, 0.013791046105325222, 0.007210119627416134, 0.0031240193638950586, 0.0037788196932524443, -0.0037440676242113113, -0.0497501902282238, 0.014668989926576614, 0.004697003401815891, -0.011025520041584969, -0.0033782573882490396, -0.022094938904047012, 0.03982941806316376, 0.0030673188157379627, -0.025987159460783005, -0.00033540226286277175, 0.013666669838130474, 0.027260178700089455, -0.00958422850817442, 0.019314780831336975, 0.008757497183978558, -0.010242686606943607, -0.021319421008229256, -0.018378306180238724, -0.00031139596831053495, 0.027055324986577034, -0.015334764495491982, -0.020134195685386658, 0.025679878890514374, -0.0022460748441517353, 0.01789543591439724, -0.0014751297421753407, -0.001793384668417275, 0.018290512263774872, -0.01327891182154417, 0.0185099970549345, -0.03189865127205849, -0.010440223850309849, 0.040590304881334305, -0.027757680043578148, -0.046092089265584946, -0.007711279671639204, -0.05387653037905693, -0.007601536810398102, -0.0037495549768209457, -0.040502507239580154, -0.04995504394173622, 0.030523205175995827, 0.004729926120489836, 0.0011815670877695084, -0.01407637819647789, 0.043458256870508194, 0.010147576220333576, -0.13052108883857727, -0.04424840584397316, 0.017017491161823273, 0.001207173801958561, 0.016344401985406876, -0.025475025177001953, 0.0201195627450943, 0.03271806612610817, 0.0029502594843506813, -0.036463964730501175, 0.018978234380483627, -0.029484305530786514, 0.005633477587252855, -0.0034312999341636896, 0.008077089674770832, -0.03295218572020531, 0.006423627492040396, -0.033947188407182693, 0.0461798831820488, -0.0035776239819824696, -0.012766777537763119, -0.007960030809044838, 0.014325128868222237, -0.006251696962863207, -0.014983586966991425, -0.011032836511731148, 0.009459852240979671, 0.017324771732091904, -0.008911137469112873, 0.010250003077089787, -0.017061389982700348, -0.04225839674472809, -0.020587800070643425, 0.045770175755023956, -0.033800866454839706, -0.019109927117824554, -0.01820271648466587, -0.008816026151180267, -2.3992006390471943e-05, 0.006862599868327379, -0.005220111925154924, -0.057973604649305344, 0.018392939120531082, -0.018612423911690712, 0.030552471056580544, 0.007916133850812912, 0.02086581476032734, -0.012452180497348309, 0.021436478942632675, -0.004810404498130083, 0.008633121848106384, 0.025387229397892952, 0.016124915331602097, 0.011508390307426453, 0.010784085839986801, -0.006306568626314402, 0.011596184223890305, -0.020982874557375908, 0.02423126995563507, 0.02551892213523388, -0.00239422800950706, 0.0163882989436388, 0.01725161075592041, -0.0015245141694322228, -0.016768740490078926, -0.017514994367957115, 0.01057923212647438, 0.012569239363074303, 0.006196825299412012, -0.04252178221940994, -0.03210350498557091, 0.05241328850388527, 0.01725161075592041, 0.03178159147500992, -0.015203073620796204, 0.020061032846570015, 0.018275879323482513, 0.04184868931770325, -0.03189865127205849, -0.0005738647887483239, 0.03409351408481598, -0.02095361053943634, -0.029718423262238503, -0.020792653784155846, 0.014361709356307983, 0.0018766064895316958, 0.02475803717970848, -0.015627413988113403, 0.0006817788234911859, 0.037019994109869, 0.03620057925581932, -0.003330702194944024, 0.008003927767276764, -0.013220381923019886, 0.011918097734451294, 0.000401019467972219, 0.004404355306178331, 0.01981228217482567, 0.018334409222006798, 0.00023640485596843064, 0.029352612793445587, 0.0470285639166832, -0.04776018485426903, -0.04591650143265724, -0.006354123819619417, 0.03227909654378891, 0.0007412229897454381, -0.0009268716676160693, 0.00746252853423357, 0.00048378403880633414, 0.026118850335478783, 0.012452180497348309, -0.0008642266620881855, 0.016329769045114517, 0.05165240541100502, 0.019139191135764122, 0.013315492309629917, 0.032864391803741455, 0.03637617081403732, -0.00856727547943592, -0.0010434737196192145, -0.004722610116004944, -0.04764312505722046, -0.004733584355562925, -0.05267667397856712, -0.004100732505321503, 0.03462028130888939, 0.017339404672384262, -0.004938438069075346, -0.005384726449847221, -0.004100732505321503, 0.022065673023462296, -0.004825036972761154, -0.004031228832900524, 0.009115991182625294, -0.0019662301056087017, -0.004934779834002256, 0.04574090987443924, -0.03778088092803955, 0.0404147133231163, -0.003264856291934848, -0.003566649742424488, 0.01555425114929676, -0.0021491351071745157, -0.002866123104467988, 0.005560315679758787, -0.01968059130012989, -0.012364385649561882, -0.025460392236709595, -0.009591544046998024, 0.0349714569747448, -0.021319421008229256, -0.03210350498557091, 0.023967886343598366, 0.017617421224713326, 0.024714140221476555, -0.015086013823747635, -0.01831977628171444, -0.009459852240979671, 0.032659538090229034, 0.039331916719675064, 0.024289799854159355, -0.010601180605590343, -0.022782661020755768, 0.004258031025528908, -0.03189865127205849, -0.044072818011045456, -0.030025703832507133, -0.040180597454309464, 0.01512991078197956, -0.03163526952266693, -0.013110638596117496, 0.04603356122970581, 0.04454105347394943, 0.03295218572020531, -0.0015016510151326656, 0.010886512696743011, 0.013000895269215107, 0.037927206605672836, 0.02623591013252735, 0.016154179349541664, 0.0005670058890245855, 0.005022574681788683, 0.027860106900334358, 0.0016708382172510028, 0.017163816839456558, -0.015407927334308624, 0.014361709356307983, 0.004173894878476858, 0.0419364832341671, -0.0050701298750936985, 0.02866489067673683, -0.002125357510522008, 0.04656032472848892, -0.006467524915933609, -0.03280586004257202, 0.024626344442367554, 0.022270526736974716, -0.010571915656328201, -0.007908817380666733, 0.008479481562972069, 0.023850826546549797, -0.00815756805241108, 0.007140615954995155, -0.030523205175995827, 0.022387586534023285, -0.002200348535552621, -0.014061745256185532, -0.006423627492040396, 0.023265531286597252, -0.015320132486522198, -0.006954052485525608, -0.013154535554349422, 0.034883663058280945, -0.016856536269187927, 0.005468863062560558, 0.020500006154179573, 0.008135619573295116, -0.02478730119764805, 0.01254729088395834, -0.025548186153173447, -0.019183088093996048, -0.025109214708209038, -0.004547021351754665, -0.006869916338473558, 0.007166222669184208, 0.0196952223777771, 0.001233694958500564, -0.027128485962748528, -0.010096362791955471, 0.009240366518497467, 0.012430232018232346, 0.022329056635499, -0.006727250292897224, -0.010630445554852486, -0.026309071108698845, -0.003976357169449329, -0.00428729597479105, -0.013388654217123985, 0.0016434025019407272, 0.04910636693239212, 0.0003767845337279141, -0.006163902580738068, 0.007528374437242746, 0.01671021059155464, 0.0047409008257091045, 0.016651682555675507, 0.029030699282884598, -0.014581196010112762, 0.005713955964893103, -0.001296797301620245, 0.0045982347801327705, 0.023046044632792473, 0.010820666328072548, -0.003676392836496234, 0.006423627492040396, 0.009942722506821156, 0.024406857788562775, 0.04000500589609146, 0.02825518324971199, -0.004108048975467682, 0.02234368957579136, 0.010389010421931744, -0.013878840021789074, 0.01033048052340746, -0.01461777649819851, -0.010045149363577366, -0.013908104971051216, -0.004605550784617662, -0.0008043252746574581, -0.06057817488908768, 0.013081373646855354, 0.010074413381516933, 0.014815314672887325, -0.016359033063054085, -0.02316310442984104, -0.009935406036674976, -0.022680234163999557, 0.030874382704496384, -0.001909529441036284, -0.03944897651672363, -0.030142763629555702, -0.005812724586576223, 0.011793721467256546, 0.0018244785023853183, -0.014434872195124626, -0.04003427177667618, -0.01810028962790966, 0.03640543296933174, -0.02594326250255108, 0.004817720968276262, 0.01033048052340746, -0.009723235853016376, 0.007210119627416134, -0.03227909654378891, 0.0050920783542096615, -0.009672022424638271, 0.0009360169060528278, 0.02541649527847767, -0.02666025049984455, 0.016007855534553528, 0.030435411259531975, 0.015612781047821045, -0.023733768612146378, 0.019329411908984184, 0.010586547665297985, -0.010184156708419323, -0.04615061730146408, -0.0015007364563643932, -0.01244486402720213, -0.013425235636532307, 0.05452035740017891, 0.016432195901870728, 0.006829677149653435, 0.03892220929265022, 0.011559603735804558, 0.01253997441381216, -0.023133838549256325, 0.03178159147500992, -0.025694509968161583, -0.007894184440374374, 0.00958422850817442, 0.02486046403646469, 0.0003303723642602563, -0.006979659199714661, -0.006339491344988346, 0.00974518433213234, -0.00835510529577732, 0.010710923932492733, 0.020397579297423363, -0.0085745919495821, -0.003497145837172866, -0.002626517554745078, 0.015963958576321602, -0.002000981941819191, 0.004755532834678888, 0.0053993589244782925, 0.012788726016879082, -0.0014010531594976783, -0.01684190332889557, 0.03584940358996391, 0.021933982148766518, 0.002610055962577462, -0.007747860625386238, -0.020163459703326225, -0.004700661636888981, -0.016066385433077812, -0.011530338786542416, 0.0027143119368702173, -0.02433369681239128, 0.08469238132238388, -0.012591187842190266, -0.0036398118827492, -0.015159175731241703, -0.02888437546789646, 0.024304430931806564, -0.015305500477552414, 0.013739832676947117, -0.04225839674472809, -0.0059700231067836285, -0.005238402634859085, 0.015334764495491982, -0.013520346023142338, 0.006196825299412012, 0.020485373213887215, -0.02404104918241501, -0.005644451826810837, 0.02105603739619255, -0.005505444016307592, 0.03760529309511185, 0.017178447917103767, 0.018392939120531082, -0.012693614698946476, -0.03631763905286789, -0.013432552106678486, 0.004279979504644871, -0.008223414421081543, 0.011003571562469006, 0.02085118368268013, 0.020470740273594856, 0.012671666219830513, -0.017763745039701462, -0.03760529309511185, 0.03543969616293907, -0.0025131162256002426, 0.017076021060347557, -0.03558601811528206, 0.023850826546549797, -0.026396866887807846, 0.013988583348691463, -0.00024966549244709313, 0.0034111803397536278, -0.009218418039381504, 0.010301216505467892, -0.03058173507452011, 0.005304248537868261, -0.027904003858566284, -0.010776769369840622, -0.014961638487875462, 0.011318168602883816, -0.0034038641024380922, -0.009101358242332935, 0.03745896741747856, -0.0034989749547094107, -0.0017686925129964948, 0.0013022844213992357, 0.010601180605590343, 0.06549466401338577, 0.02742113545536995, 0.01821734942495823, -0.046092089265584946, 0.002829542150720954, -0.037195585668087006, 0.0031441389583051205, -0.02307530865073204, -0.04457031935453415, -0.015729840844869614, 0.002668585628271103, 0.010081729851663113, 0.028723418712615967, 0.009233050048351288, 0.004843327682465315, -0.00798929575830698, 0.01928551495075226, -0.0035209234338253736, 0.019841546192765236, 0.013249646872282028, 0.004481175448745489, 0.026206644251942635, 0.03737117350101471, -0.030201293528079987, 0.013286227360367775, -0.0004119937657378614, 0.02210956998169422, 0.00021994340931996703, -0.006438259966671467, 0.019022131338715553, -0.032015711069107056, -0.009803714230656624, 0.011727876029908657, -0.010484120808541775, -0.004331192933022976, 0.031401149928569794, 0.008238046430051327, 0.0014394632307812572, -0.02423126995563507, -0.03309851139783859, -0.012298540212213993, 0.030201293528079987, 0.018788013607263565, -0.006613849196583033, 0.0041482881642878056, -0.03628837689757347, 0.015305500477552414, -0.003131335601210594, 0.03321556746959686, -0.051710933446884155, -0.0031057288870215416, 0.00228814291767776, -0.006394363008439541, -0.0072723072953522205, -0.0015107962535694242, 0.015422559343278408, -0.0009986619697883725, 0.0025990817230194807, 0.019212353974580765, 0.008516062051057816, 0.005549341440200806, 0.006218773778527975, -0.03892220929265022, 0.020880447700619698, 0.01164008118212223, 0.02603105641901493, 0.013900788500905037, -0.011098682880401611, -0.037927206605672836, -0.0027234572917222977, 0.0008852607570588589, 0.014317812398076057, -0.012408283539116383, -0.002588107483461499, -0.012810674495995045, 0.002505799988284707, 0.017310140654444695, 0.027933269739151, 0.021465744823217392, 0.02941114269196987, -0.011501073837280273, -0.02784547582268715, 0.000535454717464745, 0.003822716884315014, 0.037019994109869, 0.017119918018579483, 0.03663955256342888, 0.013022844679653645, -0.0087867621332407, -0.013725199736654758, -0.02073412388563156, 0.028650257736444473, 0.002736260648816824, -0.017705215141177177, -0.018817277625203133, 0.001288566505536437, 0.016329769045114517, -0.005461546592414379, -0.005900518968701363, 0.007821022532880306, -0.019651325419545174, 0.028123490512371063, -0.0024820223916321993, -0.004729926120489836, -0.0016726673347875476, -0.028533197939395905, 0.011559603735804558, 0.042492516338825226, -0.027391869574785233, -0.024099577218294144, 0.009342793375253677, 0.0139666348695755, -0.014786049723625183, 0.003420325694605708, 0.011471808888018131, 0.000840906286612153, -0.0005706639494746923, -0.0015519498847424984, -0.026089586317539215, -0.03579087182879448, 0.0017348550027236342, -0.0019131875596940517, 0.000861025822814554, -0.0034111803397536278, -0.014083693735301495, 0.03804426267743111, 0.02105603739619255, -0.01243754755705595, 0.004038544837385416, -0.021963246166706085, 0.012086370028555393, -0.003193523269146681, -0.01174982450902462, 0.012847254984080791, 0.010542650707066059, 0.0022643653210252523, 0.003332531312480569, 0.009840295650064945, 0.0219047162681818, -0.004217791836708784, 0.047701653093099594, 0.035615283995866776, 0.032864391803741455, -0.009964670985937119, -0.002899046055972576, -1.4025106793269515e-05, -0.025357965379953384, 0.0032099848613142967, 0.01830514334142208, 0.01123037375509739, 0.004590918309986591, -0.0017796667525544763, -0.01798323169350624, -0.015100646764039993, -0.006361439824104309, 0.02210956998169422, 0.01127427164465189, 0.0261481162160635, 0.0011202938621863723, -0.021655965596437454, 0.017866171896457672, -0.03860029578208923, -0.03125482797622681, 0.00978176575154066, 0.006178535055369139, 0.010301216505467892, 0.026865104213356972, -0.020412210375070572, 0.017968598753213882, 0.01164008118212223, -0.009123307652771473, 0.014603144489228725, 0.017076021060347557, 0.0014065403956919909, -0.01981228217482567, 0.013198433443903923, -0.020982874557375908, 0.013791046105325222, -0.015934694558382034, 0.02604568935930729, -0.013937369920313358, 0.002308262512087822, 0.013374022208154202, -0.023733768612146378, 0.006730908062309027, 0.033917926251888275, 0.03857102990150452, -0.014793366193771362, 0.060168467462062836, 0.044833701103925705, 0.02263633720576763, -0.022928984835743904, 0.025694509968161583, -0.007261333055794239, 0.02655782364308834, 0.0008395345066674054, -0.04331193119287491, 0.0041117072105407715, -0.040795158594846725, -0.03172306343913078, 0.002558842534199357, 0.024523917585611343, 0.0031642585527151823, -0.0016534622991457582, -0.027128485962748528, -0.001009636209346354, 0.0359957255423069, -0.048638127744197845, 0.025753039866685867, -0.017822274938225746, 0.035937197506427765, 0.008962350897490978, -0.013461816124618053, -0.009240366518497467, 0.012313172221183777, -0.007864920422434807, -0.005179872736334801, 0.009723235853016376, 0.027289442718029022, 0.006650430150330067, -0.014039796777069569, 0.025255538523197174, -0.0041117072105407715, 0.0421120747923851, 0.00378247769549489, -0.018041761592030525, 0.0018985550850629807, 0.005007942207157612, -0.024684874340891838, -0.024816567078232765, -0.012583872303366661, 0.009481801651418209, 0.021129198372364044, -0.002324724104255438, 0.026967531070113182, 0.017617421224713326, -0.04664812237024307, -0.0056993234902620316, -0.005717613734304905, -0.00899161584675312, -0.037956468760967255, -0.00936474185436964, 0.045360468327999115, -0.021773025393486023, -0.01874411664903164, -0.018685586750507355, 0.03681514039635658, 0.013798361644148827, 0.037224847823381424, -0.013205748982727528, 0.03365454077720642, -4.995596100343391e-05, 0.007491793483495712, -0.009415955282747746, 0.025343332439661026, 0.0005071044433861971, 0.0014056258369237185, 0.010308532044291496, -0.0006712618051096797, 0.007762493100017309, 0.014917741529643536, -0.008413635194301605, 0.05408138409256935, 0.004382406361401081, -0.0074149733409285545, 0.02042684331536293, -0.0006703472463414073, -0.0056664003059268, -0.00038753022090531886, 0.018700219690799713, 0.032659538090229034, 0.02761135622859001, -0.012510710395872593, 0.029601363465189934, -0.02976232022047043, 0.01143522746860981, -0.01164008118212223, 0.0044775172136723995, 0.010074413381516933, 0.019768385216593742, 0.020719490945339203, 0.04076589271426201, -0.025987159460783005, -0.041438981890678406, 0.015466456301510334, -0.022270526736974716, -0.024801934137940407, -0.018451469019055367, 0.021758392453193665, -0.017061389982700348, -0.007703963667154312, -0.0036105469334870577, -0.01344718411564827, 0.06918203085660934, 0.018758749589323997, 0.0137544646859169, 0.0009474484832026064, 0.009869559668004513, 0.030347617343068123, 0.010564599186182022, -0.03224983066320419, -0.02178765833377838, 0.0030179345048964024, -0.026192013174295425, -0.01512991078197956, 0.02001713588833809, 0.026279807090759277, 0.004214134067296982, -0.010206105187535286, -0.00648581562563777, -0.010740188881754875, -0.029147759079933167, -0.02117309533059597, -0.013995899818837643, 0.015598148107528687, 0.006032210774719715, 0.027669886127114296, -0.022577807307243347, -0.011559603735804558, -0.012466812506318092, -0.013520346023142338, -0.00518718920648098, -0.004770165309309959, 0.023455752059817314, -0.00847216509282589, 0.022885087877511978, -0.008962350897490978, -0.003363625146448612, -0.013322808779776096, -0.008457532152533531, 0.0005253949202597141, -0.0008340473286807537]",Online Speculative Decoding.pdf
"19274‚Äì19286.
[21] Yuhui Li, Fangyun Wei, Chao Zhang, and Hongyang Zhang. 2024.
Eagle: Speculative sampling requires rethinking feature uncertainty.
arXiv preprint arXiv:2401.15077 (2024).
[22] Feng Lin, Hanling Yi, Hongbin Li, Yifan Yang, Xiaotian Yu, Guangming
Lu, and Rong Xiao. 2024. BiTA: Bi-Directional Tuning for Lossless Ac-
celeration in Large Language Models. arXiv preprint arXiv:2401.12522
(2024).
[23] Ji Lin, Jiaming Tang, Haotian Tang, Shang Yang, Xingyu Dang, Chuang
Gan, and Song Han. 2023. AWQ: Activation-aware Weight Quantiza-
tion for LLM Compression and Acceleration. arXiv:2306.00978 [cs.CL]
[24] Xiaoxuan Liu, Lanxiang Hu, Peter Bailis, Ion Stoica, Zhijie Deng, Alvin
Cheung, and Hao Zhang. 2023. Online speculative decoding. arXiv
preprint arXiv:2310.07177 (2023).
[25] Yusuf Mehdi. 2023. Reinventing search with a new AI-
powered Microsoft Bing and Edge, your copilot for the web .
https://blogs.microsoft.com/blog/2023/02/07/reinventing-search-
with-a-new-ai-powered-microsoft-bing-and-edge-your-copilot-for-
the-web/ Accessed: 2024-02-21.
[26] Xupeng Miao, Gabriele Oliaro, Zhihao Zhang, Xinhao Cheng, Zeyu
Wang, Rae Ying Yee Wong, Zhuoming Chen, Daiyaan Arfeen, Reyna
Abhyankar, and Zhihao Jia. 2023. Specinfer: Accelerating generative
llm serving with speculative inference and token tree verification.
arXiv preprint arXiv:2305.09781 (2023).
[27] Microsoft. 2023. Copilot .https://copilot.microsoft.com/ Accessed:
2024-02-21.
[28] Nvidia. 2024. A100 GPU Spec. https://www.nvidia.com/en-us/data-
center/a100/ Accessed: 2024-03-10.
[29] NVIDIA. 2024. TensorRT-LLM. https://github.com/NVIDIA/TensorRT-
LLM .
[30] OpenAI. 2022. ChatGPT .https://chat.openai.com/ Accessed: 2024-02-
21.
[31] Reiner Pope, Sholto Douglas, Aakanksha Chowdhery, Jacob Devlin,
James Bradbury, Jonathan Heek, Kefan Xiao, Shivani Agrawal, and
Jeff Dean. 2023. Efficiently scaling transformer inference. Proceedings
of Machine Learning and Systems 5 (2023).
[32] Elizabeth Reid. 2023. Supercharging Search with generative AI .https:
//blog.google/products/search/generative-ai-search/ Accessed: 2024-
02-21.
[33] Apoorv Saxena. 2023. Prompt Lookup Decoding. https://github.com/
apoorvumang/prompt-lookup-decoding/
[34] Abigail See, Peter J. Liu, and Christopher D. Manning. 2017. Get To The
Point: Summarization with Pointer-Generator Networks. In Proceed-
ings of the 55th Annual Meeting of the Association for Computational
Linguistics (Volume 1: Long Papers) . Association for Computational
Linguistics, Vancouver, Canada, 1073‚Äì1083. https://doi.org/10.18653/
v1/P17-1099
[35] Qidong Su, Christina Giannoula, and Gennady Pekhimenko. 2023.
The synergy of speculative decoding and batching in serving large
language models. arXiv preprint arXiv:2310.18813 (2023).
[36] Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Alma-
hairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal
Bhargava, Shruti Bhosale, et al .2023. Llama 2: Open foundation and
fine-tuned chat models. arXiv preprint arXiv:2307.09288 (2023).
[37] Siqi Wang,","[0.011236460879445076, 0.0203871987760067, 0.02251698635518551, -0.0049389018677175045, -0.0070723602548241615, -0.021929457783699036, -0.013469064608216286, 0.05578572303056717, -0.02977294847369194, -0.012036966159939766, 0.04600339010357857, -0.00824007112532854, -0.04233134537935257, 0.011456782929599285, -0.005306106526404619, -0.014416452497243881, -0.03219649940729141, -0.023838922381401062, 0.009238867089152336, 0.020240316167473793, -0.01834554225206375, -0.03090393915772438, -0.02001999504864216, 0.019594036042690277, 0.012066342867910862, -0.023692039772868156, 0.0012402335414662957, 0.062101639807224274, 0.01581917330622673, -0.05884086340665817, 0.021268490701913834, -0.033459682017564774, -0.01433566678315401, -0.014629431068897247, -0.0060148113407194614, 0.022370103746652603, 0.0017680900637060404, -0.01888900436460972, -0.017361432313919067, -0.010516739450395107, -0.003538016229867935, -0.07191334664821625, -0.0032773008570075035, 0.016171690076589584, 0.02001999504864216, 0.034223467111587524, -0.0031340911518782377, -0.00985577143728733, 0.002172015141695738, 0.045415863394737244, -0.02730533294379711, -0.003282808931544423, -0.030580798164010048, 0.01568697951734066, -0.029126668348908424, -0.03410596400499344, -0.04012811928987503, 0.02464677207171917, 0.03686733916401863, 0.005225321277976036, -0.00041126913856714964, -0.039746224880218506, -0.0007848998066037893, 0.008085845038294792, -0.04106816276907921, -0.025058040395379066, -0.020857220515608788, 0.036720458418130875, 0.0021885393653064966, 0.023339523002505302, -0.0072890110313892365, 0.012984354048967361, 0.03296028450131416, -0.04033375158905983, -0.01476896833628416, 0.01695016399025917, 0.013300150632858276, 0.10405109077692032, -0.015437280759215355, -0.05978090688586235, 0.01752300374209881, 0.022252598777413368, 0.006561946123838425, -0.05552133545279503, -0.02867133356630802, -0.025087418034672737, 0.024925848469138145, 0.0351635105907917, -0.06480426341295242, -0.010913320817053318, -0.023104513064026833, 0.0006256248452700675, -0.03237275779247284, 0.004344030283391476, 0.04086252674460411, 0.034223467111587524, 0.041743818670511246, -0.022399479523301125, 0.04562149941921234, 0.041978828608989716, -0.0186539925634861, -0.006205757614225149, 0.03392970561981201, -0.006102940067648888, 0.05129113793373108, -0.02607152611017227, -0.030345788225531578, -0.011309901252388954, -0.0035416882019490004, -0.0006972296978347003, -0.13442625105381012, 0.0009290276211686432, -0.03569228574633598, 0.005115159787237644, -0.031021444126963615, -0.032490260899066925, -0.05825333669781685, -0.039217449724674225, -0.030228281393647194, 0.037219855934381485, -0.017611132934689522, 0.01621575467288494, 0.01715579815208912, 0.014027215540409088, 0.010957385413348675, -0.016274508088827133, 0.028832904994487762, -0.07637855410575867, -0.006492177024483681, -0.024720212444663048, 0.01628919504582882, 0.027995677664875984, 0.0505567267537117, -0.01881556399166584, -0.0034370350185781717, -0.03137395903468132, -0.024132685735821724, -0.0031946799717843533, -0.04453457146883011, 4.1253140807384625e-05, 0.020108124241232872, -0.02717313915491104, -0.03360656276345253, 0.024661460891366005, -0.045709628611803055, -0.007116424851119518, -0.01758175529539585, -0.008218038827180862, -0.010450642555952072, 0.004219180904328823, -0.02257573790848255, -0.02088659629225731, -0.030228281393647194, -0.00015881597937550396, -0.014680839143693447, -0.032754648476839066, -0.04130317270755768, 0.06374672055244446, 0.011669761501252651, -0.05628512054681778, -0.02141537144780159, 0.07502724230289459, 0.012977010570466518, -0.0030918626580387354, 0.0319027341902256, 0.03392970561981201, -0.04192007705569267, 0.022972319275140762, -0.0661555826663971, -0.03586854413151741, -0.0032717930153012276, -0.033753447234630585, -0.014071280136704445, -0.007468941155821085, 0.00027448544278740883, -0.011199739761650562, -0.00288071995601058, -0.046414658427238464, 0.006224117707461119, -0.0570782832801342, -0.014372387900948524, 0.04600339010357857, -0.02404455654323101, 0.0019461843185126781, -0.04335951805114746, -0.014063935726881027, 0.00045395668712444603, 0.017332056537270546, 0.009136050008237362, 0.049234792590141296, -0.005706359166651964, 0.04441706836223602, 0.07109081000089645, 0.030052023008465767, 0.0039621377363801, -0.03442910313606262, 0.033753447234630585, -0.03466411307454109, 0.04638528451323509, -0.034252844750881195, 0.025983396917581558, 0.03016952984035015, -0.010076094418764114, -0.03954058885574341, 0.019990617409348488, -0.008761501871049404, 0.02217915654182434, -0.007292683236300945, -0.019931865856051445, -0.026321224868297577, 0.04315388202667236, 0.00632693525403738, 0.05334748327732086, 0.01602480746805668, -0.04089190438389778, -0.006448112428188324, -0.0457683801651001, 0.002250964054837823, -0.013373591005802155, 0.037014223635196686, -0.019094638526439667, 0.023486405611038208, 0.013285461813211441, 0.022605113685131073, -0.010619556531310081, 0.05607948452234268, 0.019638100638985634, -0.018007712438702583, 0.01338827982544899, 0.01852179877460003, 0.0555507093667984, -0.029552625492215157, -0.010560804046690464, -0.03768987953662872, 0.009385749697685242, -0.040921278297901154, 0.023471716791391373, -0.02131255529820919, 0.001935168169438839, -0.0405687615275383, 0.02091597393155098, -0.006517881527543068, 0.015275711193680763, 0.011669761501252651, 0.011243804357945919, 0.046473413705825806, -0.03463473543524742, -0.06298293173313141, 0.033724069595336914, 0.014710215851664543, -0.01287419255822897, -0.03810114786028862, -0.009914523921906948, 0.009473878890275955, -0.02491115964949131, -0.04338889569044113, -0.03760175034403801, -0.017640508711338043, -0.027951613068580627, -0.009099329821765423, -0.0004438585601747036, -0.005074767395853996, -0.035516027361154556, 0.019623413681983948, -0.01689141057431698, -0.011001449078321457, -0.02764316089451313, 0.034781619906425476, -0.0013017402961850166, -0.02830412983894348, -0.0117725795134902, -0.005926682148128748, 0.029831700026988983, 0.0017212715465575457, -0.04089190438389778, -0.020622210577130318, 0.0028990802820771933, 0.02654154784977436, -0.04691405966877937, 0.022032275795936584, 0.0026108245365321636, 0.009804362431168556, 0.05775393918156624, 0.01781676709651947, 0.003582080826163292, 0.022472921758890152, 0.01443848479539156, -0.042948249727487564, -0.047413457185029984, -0.017038293182849884, 0.045445241034030914, -0.015642914921045303, -0.004351374227553606, -0.03660295531153679, 0.041743818670511246, 0.032754648476839066, 0.04479895904660225, 0.004072298761457205, -0.0041714441031217575, -0.010054062120616436, 0.05437565594911575, -0.028098495677113533, 0.023133888840675354, -0.010046717710793018, 0.0011851527960970998, 0.0355747789144516, -0.0368967168033123, 0.01838960498571396, 0.015003979206085205, -0.0033158573787659407, 0.01457067858427763, 0.013094515539705753, -0.03357718884944916, -0.03160897269845009, -0.02943512052297592, -0.053700000047683716, 0.06127910315990448, -0.0590171217918396, 0.013079827651381493, -0.05696077644824982, -0.003073502331972122, -0.0038997128140181303, -0.0015275711193680763, 0.0020747059024870396, -0.011185051873326302, 0.02488178387284279, 0.007564414758235216, -0.0036114570684731007, 0.011611009016633034, -0.035486653447151184, 0.00809318944811821, 0.03287215530872345, 0.019124014303088188, 0.001467900350689888, -0.0340472087264061, -0.04218446463346481, -0.023794857785105705, 0.015775108709931374, 0.03851241618394852, 0.006719843950122595, -0.10299354046583176, 0.03892368823289871, -0.014196129515767097, -0.042478226125240326, -0.0004174657224211842, 0.005118831992149353, 0.0015661275247111917, 0.023354211822152138, 0.05126176029443741, 0.007887554354965687, -0.001982904737815261, -0.03240213170647621, 0.08037374168634415, -0.0043330141343176365, -0.0012842980213463306, 0.020930660888552666, 0.0027962629683315754, -0.02827475406229496, -0.055139441043138504, 0.015496034175157547, -0.01905057393014431, 0.01418878510594368, 0.02414737455546856, -0.01064158882945776, -0.021136296913027763, -0.01077378261834383, -0.024073932319879532, 0.007237602490931749, 0.03431159630417824, 0.00822538323700428, 0.011757890693843365, 0.06580306589603424, -0.020122811198234558, -0.010560804046690464, -0.031961485743522644, 0.00036881110281683505, -0.013799548149108887, 0.019975930452346802, 0.010215631686151028, 0.05719578638672829, -0.005232665222138166, -0.014012526720762253, -0.013615946285426617, -0.03011077642440796, -0.013395623303949833, 0.010685653425753117, 0.0007045738166198134, -0.0016074380837380886, -0.009943900629878044, -0.010729718022048473, -0.038248028606176376, -0.014761624857783318, -0.03066892735660076, 0.006466472987085581, 0.015731044113636017, 0.03610355406999588, -0.007872866466641426, 0.009965932928025723, 0.015745732933282852, 0.013050450943410397, -0.0024143701884895563, -0.02814256027340889, 0.00472225109115243, -0.012411515228450298, 0.005533772986382246, 0.04800098389387131, 0.044740207493305206, 0.05804770067334175, 0.03739611431956291, 0.010377202183008194, 0.03063955157995224, -0.035516027361154556, 0.023236706852912903, -0.050439223647117615, -0.0031579595524817705, -0.011155675165355206, 0.018169283866882324, 0.024470513686537743, 0.036221060901880264, 0.06503927707672119, -0.0013568209251388907, -0.02144474722445011, -0.027892861515283585, -0.037513621151447296, -0.039981234818696976, -0.009202146902680397, 0.04529835656285286, -0.042742613703012466, 0.0665668472647667, -0.06721312552690506, -0.054904431104660034, -0.0038446320686489344, 0.056637637317180634, -0.04288949444890022, -0.021562254056334496, -0.04288949444890022, 0.030962690711021423, 0.01565760374069214, 0.00842367298901081, -0.02840694785118103, -0.03757237270474434, 0.010318448767066002, -0.03833615779876709, 0.009863114915788174, -0.01396846305578947, -0.0045092725194990635, -0.025337116792798042, -0.0005241845501586795, 0.018492422997951508, -0.03290153294801712, 0.01592199131846428, 0.005629246588796377, 0.053964387625455856, -0.002976193092763424, -0.04086252674460411, -0.03777800872921944, 0.07643730938434601, -0.04153818264603615, 0.04612089693546295, 0.00619474146515131, 0.04335951805114746, 0.019594036042690277, -0.06304168701171875, -0.03354781121015549, -0.005842225160449743, -0.00620208540931344, 0.009400437586009502, 0.009238867089152336, 0.03014015220105648, 0.0269087515771389, 0.01747893914580345, -0.029023850336670876, -0.02480834163725376, -0.0176845733076334, -0.002203227486461401, 0.01295497827231884, 0.030815809965133667, -0.0027246579993516207, -0.004101675469428301, -0.050703611224889755, 0.003653685562312603, -0.01257308479398489, 0.04453457146883011, 0.0295085608959198, 0.011750547215342522, 0.07255962491035461, -0.01050939504057169, -0.0015174730215221643, 0.010428610257804394, -0.01852179877460003, -0.013983150944113731, -0.0013660010881721973, 0.048911649733781815, -0.018595241010189056, 0.004512944258749485, 0.04033375158905983, -0.023368900641798973, -0.015216957777738571, -0.01771394908428192, -0.01648014225065708, 5.754784433520399e-05, -0.02044595219194889, -0.008871663361787796, -0.00857789907604456, -0.003998857922852039, -0.036191683262586594, 0.022135091945528984, 0.030198905616998672, -0.004858116619288921, 0.02444113790988922, -0.010546116158366203, 0.00400620186701417, -0.01463677454739809, 0.010648933239281178, 0.005306106526404619, 0.04938167333602905, -0.012800752185285091, 0.023765482008457184, -0.001396295498125255, 0.014093312434852123, 0.0019443483324721456, -0.018800875172019005, 0.0014008855214342475, -0.010568148456513882, -0.0041861324571073055, -0.010384545661509037, -0.01828678883612156, -0.07138457149267197, -0.014203473925590515, -0.038718052208423615, 0.018198659643530846, -0.023133888840675354, 0.0006058875587768853, -0.005768784321844578, -0.06909321248531342, -0.01571635715663433, -0.0018984477501362562, -0.010847223922610283, -0.05437565594911575, -0.005809176713228226, -0.0025410556700080633, 0.046972811222076416, 0.005038047209382057, 0.025087418034672737, -0.018404293805360794, -0.016906099393963814, 0.00308819068595767, -0.015877926722168922, -0.024220814928412437, 0.01631857268512249, 0.06398172676563263, -0.03434097394347191, 0.01473959255963564, -0.013843612745404243, 0.005713703576475382, -0.000604969565756619, 0.03760175034403801, -0.008181318640708923, -0.02501397579908371, -0.009062609635293484, 0.022252598777413368, -0.015275711193680763, 0.002135294722393155, 0.006558273918926716, -0.019726229831576347, -0.009716233238577843, 0.020034682005643845, -0.018374918028712273, 0.011368653737008572, 0.01034048106521368, -0.02817193605005741, -0.027687225490808487, 0.03633856773376465, 0.015496034175157547, 0.024073932319879532, -0.030287034809589386, 0.004432159475982189, -0.0023776497691869736, 0.006598666310310364, 0.011280525475740433, -0.028362883254885674, -0.03410596400499344, -0.014144720509648323, 0.0016303884331136942, -0.031197702512145042, 0.01692078821361065, 0.017860831692814827, 0.029200108721852303, -0.016759216785430908, -0.01432097889482975, 0.06174912303686142, -0.023001695051789284, -0.034752242267131805, -0.025425245985388756, -0.021738512441515923, -0.006892430130392313, 0.029420431703329086, -0.04165568947792053, -0.04330076649785042, 0.03357718884944916, 0.012235256843268871, -0.011368653737008572, -0.03163834661245346, 0.01791958324611187, -0.028333505615592003, -0.004975622054189444, -0.02793692611157894, 0.0009850263595581055, 0.019535284489393234, -0.007237602490931749, 0.002238112036138773, 0.01991717703640461, -0.00648483308032155, -0.02341296523809433, -0.02974357269704342, 0.00972357764840126, -0.038835559040308, -0.013513129204511642, 0.05387625843286514, -0.022223221138119698, 0.03090393915772438, -0.057137034833431244, -0.004013546276837587, 0.015510722063481808, 0.017640508711338043, 0.009532631374895573, -0.012433547526597977, -0.009319652803242207, -0.018374918028712273, 0.000632509880233556, 0.005240009631961584, -0.02924417331814766, 0.019623413681983948, 0.026761870831251144, 0.001089679659344256, -0.0030331099405884743, -0.016010120511054993, -0.01197086926549673, 0.03257839009165764, -0.011860708706080914, 0.006110284477472305, 0.021562254056334496, 0.0019204800482839346, -0.021474124863743782, 0.014445828273892403, -0.004395438823848963, -0.023104513064026833, 0.014379731379449368, -0.016906099393963814, 0.007821457460522652, -0.020372509956359863, -0.026688430458307266, 0.050909243524074554, 0.016362637281417847, 0.023706728592514992, -0.024734901264309883, 0.008519146591424942, -0.050703611224889755, -0.006154349073767662, -0.0023152248468250036, -0.045474614948034286, 0.006249822210520506, -0.03166772425174713, 0.011023481376469135, -0.01655358262360096, 0.05164365470409393, 0.036485448479652405, 0.027085009962320328, 0.03181460499763489, -0.000900569255463779, -0.031227078288793564, 0.012198536656796932, 0.03510475903749466, -0.010274384170770645, 0.0009758461965247989, -0.030962690711021423, 0.001955364365130663, -0.01645076647400856, 0.03583916649222374, 0.027129074558615685, -0.02930292673408985, 0.03789551556110382, -0.07038577646017075, -0.034458477050065994, 0.03313654288649559, -0.009246211498975754, 0.010406577959656715, 0.017243927344679832, 0.024323632940649986, 0.00472959503531456, -0.014475204981863499, 0.01747893914580345, 0.005900977645069361, -0.027290645986795425, 0.004252229351550341, 0.0014669822994619608, -0.004362390376627445, 0.02554275095462799, -0.022972319275140762, -0.083781398832798, -0.026835311204195023, 0.030551422387361526, -0.013865645043551922, -0.019696854054927826, -0.02217915654182434, -0.019594036042690277, -0.01207368727773428, 0.013696731068193913, 0.0592227578163147, -0.02830412983894348, 0.0020471655298024416, -0.016201065853238106, -0.009958588518202305, -0.0017469758167862892, -0.03489912301301956, 0.009525286965072155, 0.022898878902196884, -0.0070356400683522224, -0.004997654352337122, -0.04732532799243927, -0.04803036153316498, -0.009525286965072155, -0.0037179465871304274, -0.016112936660647392, 0.0007403762429021299, -0.032284628599882126, -5.6888024118961766e-05, 0.0026420371141284704, -0.0012016770197078586, 0.02398580312728882, 0.008871663361787796, 0.02165038324892521, 0.03466411307454109, -0.031197702512145042, 0.005588853731751442, 0.010986761189997196, -0.05152614787220955, 0.0007848998066037893, -0.019505908712744713, -0.027701914310455322, 0.005618230439722538, -0.031197702512145042, -0.01505538821220398, 0.05475755035877228, 0.02068096213042736, 0.0018709073774516582, 0.013924398459494114, 0.009943900629878044, -0.003818927798420191, -0.0017093373462557793, -0.020534081384539604, 0.014276914298534393, 0.0008124401792883873, -0.013498440384864807, 0.01108957827091217, -0.00972357764840126, 0.030933314934372902, -0.002877047983929515, -0.015040700323879719, 0.016906099393963814, 0.006554601714015007, 0.004094331059604883, -0.012117751874029636, 0.0423019677400589, 0.022355414927005768, -0.014041903428733349, -0.011398030444979668, -0.011478815227746964, 0.004979294259101152, 0.023956427350640297, 0.00945919007062912, -0.02874477580189705, 0.011199739761650562, -0.003361758077517152, 0.022061651572585106, 0.0023537813685834408, 0.010487362742424011, 0.023897673934698105, -0.0031965160742402077, 0.015363840386271477, -0.018139906227588654, 0.005372202955186367, 0.02687937580049038, -0.01430629100650549, -0.0371023528277874, -0.007241274695843458, -0.03833615779876709, 0.0016762888990342617, -0.010847223922610283, -0.054875053465366364, -0.03272527456283569, 0.00927558820694685, 0.010421265847980976, 0.0118239875882864, -0.014791000634431839, 0.03513413667678833, -0.009172771126031876, -0.11392155289649963, -0.0226785559207201, 0.010928008705377579, -0.004795691929757595, 0.023236706852912903, -0.029346991330385208, 0.02674718201160431, 0.01944715529680252, 0.01370407547801733, -0.027026258409023285, 0.02554275095462799, -0.014533957466483116, 0.004520288668572903, -0.028083806857466698, 0.004017218016088009, -0.04233134537935257, 0.004534976556897163, -0.04538648575544357, 0.04018687084317207, -0.006448112428188324, -0.006393032148480415, -0.007028295658528805, -0.0002625512715894729, 0.020093435421586037, -0.0043477024883031845, -0.030463293194770813, 0.004244884941726923, 0.033753447234630585, -0.0024015179369598627, -0.002164670964702964, -0.020871909335255623, -0.025660255923867226, -0.0007270650821737945, 0.07279463857412338, -0.03836553543806076, -0.01195618137717247, -0.030228281393647194, -0.008746813051402569, 0.020460639148950577, 0.004344030283391476, 0.008049124851822853, -0.04773659631609917, 0.03616230934858322, -0.0017864503897726536, 0.03257839009165764, -0.0021206066012382507, 0.026703117415308952, -0.0031671395990997553, 0.013013730756938457, -0.014445828273892403, 0.015804486349225044, 0.024499889463186264, 0.008812909945845604, 0.006976887118071318, 0.01605418510735035, -0.00573573587462306, 0.022105716168880463, -0.009701545350253582, 0.04215508699417114, 0.026233095675706863, -0.005926682148128748, 0.001962708542123437, -0.005695343017578125, -0.021709134802222252, -0.025954021140933037, -0.02830412983894348, -0.013160612434148788, 0.0303751640021801, 0.009150738827884197, -0.04415268078446388, -0.03683796525001526, 0.056667011231184006, 0.01907994970679283, 0.03290153294801712, 0.004523960407823324, 0.008937759324908257, 0.02257573790848255, 0.02664436586201191, -0.026321224868297577, -0.011434750631451607, 0.04526898264884949, -0.042742613703012466, -0.027525655925273895, 0.0031744837760925293, -0.013549849390983582, 0.007366124074906111, 0.02780473232269287, 0.006128644570708275, -0.0072633069939911366, 0.024264879524707794, 0.04612089693546295, -0.022472921758890152, 0.005882617551833391, -0.03163834661245346, -0.0072486186400055885, -0.028862280771136284, -0.006356311496347189, 0.01325608603656292, 0.01805177703499794, -5.80642263230402e-05, 0.042243216186761856, 0.03745486959815025, -0.04133255034685135, -0.030698303133249283, 0.003594932844862342, 0.030757056549191475, -0.006286542396992445, -0.02467614784836769, 0.007997715845704079, 0.001278789946809411, 0.012448235414922237, 0.009730922058224678, -0.013975806534290314, 0.003231400391086936, 0.03272527456283569, 0.023794857785105705, 0.030522044748067856, 0.03454660624265671, 0.009062609635293484, 0.00021056887635495514, 0.021665070205926895, -0.0052620419301092625, -0.034223467111587524, 0.004953589756041765, -0.05910525098443031, -0.01122177205979824, 0.024191439151763916, 0.01240417081862688, -0.0072339302860200405, -0.016773905605077744, 0.0023592894431203604, 0.005265713669359684, -0.009686857461929321, 0.005016014911234379, -0.0034700834657996893, -0.00796099565923214, -0.009246211498975754, 0.02654154784977436, -0.022825436666607857, 0.04206695780158043, 0.0012292173923924565, -0.008401640690863132, 0.009451846592128277, 0.003940105438232422, -0.008643995970487595, -0.019432466477155685, -0.027320021763443947, -0.02611559070646763, -0.00442848727107048, -0.01473959255963564, 0.02980232425034046, -0.006617026869207621, -0.02467614784836769, 0.01671515218913555, 0.01225728914141655, 0.023104513064026833, -0.009921868331730366, -0.021532876417040825, -0.013432343490421772, 0.019902488216757774, 0.03290153294801712, 0.030287034809589386, 0.010281728580594063, -0.005467676557600498, -0.011309901252388954, -0.037954267114400864, -0.02388298697769642, -0.03334217518568039, -0.04982231929898262, 0.034517232328653336, -0.03063955157995224, 0.009187459014356136, 0.04303637892007828, 0.04782472550868988, 0.01195618137717247, 0.03290153294801712, 0.015466657467186451, -0.0014394420431926847, 0.023794857785105705, 0.03378282114863396, 0.02884759195148945, -0.005093127489089966, 0.0030257657635957003, 0.014783657155930996, 0.028216000646352768, 0.008820254355669022, -0.013248741626739502, 0.021062854677438736, 0.0016505846288055182, 0.027158452197909355, -0.020431263372302055, 0.015349151566624641, -0.0033599219750612974, 0.03839491307735443, -0.023354211822152138, -0.008879006840288639, 0.028597893193364143, 0.014460517093539238, -0.025763073936104774, -0.013050450943410397, -0.0032644488383084536, 0.023633288219571114, -0.023427652195096016, 0.009525286965072155, -0.03939370810985565, 0.015305086970329285, -0.010869256220757961, 0.00012003000301774591, -0.004028234165161848, 0.004689202643930912, -0.019329650327563286, -0.014460517093539238, -0.02961137890815735, 0.04051000997424126, -0.017229238525032997, -0.016406701877713203, 0.024529267102479935, 0.027863483875989914, -0.04676717519760132, -0.008666028268635273, -0.03915869817137718, -0.029420431703329086, -0.027980990707874298, 0.008695404976606369, -0.0185511764138937, 0.015099452808499336, 0.007300027180463076, -0.0023115528747439384, -0.02068096213042736, -0.0006669353460893035, 0.011831331998109818, 0.00822538323700428, 0.01791958324611187, -0.01473959255963564, -0.0008005059789866209, -0.035751037299633026, 0.004634121898561716, -0.006525225471705198, -0.018125219270586967, 0.00857789907604456, 0.03454660624265671, 0.006976887118071318, 0.012360106222331524, -0.007131113205105066, 0.00766723183915019, -0.020034682005643845, 0.027466902509331703, 0.028495077043771744, -0.019109327346086502, -0.01518758200109005, 0.0055301012471318245, 0.00852649100124836, 0.03163834661245346, 0.0054603321477770805, 0.0035563765559345484, -0.016759216785430908, 0.017596444115042686, 0.02984638884663582, 0.02480834163725376, 0.0384242869913578, -0.010406577959656715, 0.022766685113310814, 0.02307513728737831, -0.011111610569059849, 0.0186539925634861, -0.014071280136704445, 0.0006357229431159794, -0.007564414758235216, 0.00604418758302927, 0.007821457460522652, -0.03660295531153679, 0.022693242877721786, 0.01507007610052824, 0.028069118037819862, -0.009826394729316235, -0.034223467111587524, 0.0023978459648787975, -0.01752300374209881, 0.012264633551239967, 0.009033232927322388, -0.03419409319758415, -0.015143517404794693, 0.00020930661412421614, -0.003716110484674573, -0.007814113982021809, -0.022766685113310814, -0.03663232922554016, -0.0027760667726397514, 0.03131520748138428, -0.021635694429278374, 0.019829047843813896, 0.03434097394347191, -0.015745732933282852, -0.0055301012471318245, -0.042977623641490936, 0.003279136959463358, 0.007351435720920563, 0.012095719575881958, 0.03134458512067795, -0.02843632362782955, 0.015525409951806068, 0.02328077144920826, 0.014673495665192604, -0.025498686358332634, 0.0276725385338068, 0.014644118957221508, 0.014526613987982273, -0.050204209983348846, 0.00736979627981782, -0.009694200940430164, -0.01000999752432108, 0.04682593047618866, 0.02664436586201191, 0.011662418022751808, 0.04409392550587654, 0.002588792471215129, -0.008232726715505123, -0.010502051562070847, 0.012396827340126038, -0.023163266479969025, -0.0004599237581714988, 0.01808115467429161, 0.013549849390983582, 0.0037785351742058992, -0.0015532753895968199, -0.011420062743127346, 0.009069953113794327, 0.011662418022751808, 0.014724903739988804, 0.0010630573378875852, 0.017963647842407227, -0.018991820514202118, -0.0009299456141889095, 0.024867095053195953, -0.024602707475423813, 0.010112814605236053, -0.01443848479539156, 0.0026897736825048923, -0.018110530450940132, -0.020122811198234558, 0.030757056549191475, 0.01396846305578947, -0.010994105599820614, 0.0129696661606431, -0.009121362119913101, -0.006984231527894735, -0.012932945974171162, -0.006286542396992445, 0.027569720521569252, -0.03061017394065857, 0.09247680753469467, -0.008805566467344761, -0.013975806534290314, -0.0007412942941300571, -0.03616230934858322, 0.024499889463186264, -0.015540097840130329, 0.0005480528343468904, -0.045445241034030914, -0.01345437578856945, -0.005096799694001675, 0.002355617471039295, 0.005750423762947321, 0.0004888410912826657, 0.008196006529033184, -0.03246088698506355, -0.022472921758890152, 0.01165507361292839, 0.006830005440860987, 0.00942246988415718, 0.016098249703645706, 0.02861258201301098, -0.010142190381884575, -0.04280136525630951, 0.004997654352337122, 0.0066721076145768166, -0.0026144967414438725, -0.003774863202124834, 0.025601504370570183, 0.03296028450131416, 0.01884493976831436, -0.009437157772481441, -0.052936214953660965, 0.04277199134230614, -0.007689264137297869, 0.019226832315325737, -0.04003999009728432, 0.014203473925590515, -0.013498440384864807, 0.0010492871515452862, 0.007156817242503166, 8.886064279067796e-06, 0.004534976556897163, 0.018404293805360794, -0.0056916712783277035, 0.005816520657390356, -0.01490116212517023, -0.0025392198003828526, -0.01325608603656292, -0.005776128266006708, -0.006304902955889702, -0.012440891936421394, 0.013821580447256565, -0.004810380283743143, -0.0056769829243421555, -0.011096922680735588, -0.023501094430685043, 0.06944572925567627, 0.023295458406209946, 0.02984638884663582, -0.027922237291932106, 0.004002530127763748, -0.029817013069987297, 0.007109080906957388, -0.026717806234955788, -0.05026296526193619, -0.0014862605603411794, -0.00411269161850214, 0.004755299538373947, 0.04277199134230614, -0.008438361808657646, 0.006099268328398466, 0.004406454972922802, 0.00942246988415718, 0.01490116212517023, 0.004248557146638632, -0.006892430130392313, 0.006686795502901077, 0.04039250314235687, 0.035516027361154556, -0.03460536152124405, -0.0014660643646493554, -0.005508068948984146, 0.02884759195148945, 0.006998919416218996, -0.005093127489089966, 0.039981234818696976, -0.0068189892917871475, -0.013917054049670696, 0.015305086970329285, -0.018874315544962883, -0.012081030756235123, 0.031520843505859375, 0.033459682017564774, -0.002601644489914179, -0.014710215851664543, -0.008475081995129585, -0.006620698608458042, 0.013491096906363964, 0.004964605905115604, -0.004252229351550341, -0.006510537583380938, -0.01815459504723549, 0.007153145503252745, 0.0011319081531837583, 0.012910913676023483, -0.03392970561981201, -0.009304963983595371, 0.006113956216722727, 0.009598728269338608, -0.008599931374192238, 0.0002033395430771634, 0.030081400647759438, -0.004806708078831434, -0.022825436666607857, 0.03319529443979263, 0.006701483856886625, 0.010685653425753117, -0.015216957777738571, -0.04003999009728432, 0.03110957331955433, 0.02640935406088829, 0.02201758697628975, 0.019168078899383545, -0.013946430757641792, -0.02930292673408985, 0.009238867089152336, -0.022458232939243317, 0.011618353426456451, -0.015003979206085205, -0.021870706230401993, -0.01628919504582882, 0.003042289987206459, 0.009356372989714146, 0.025395870208740234, 0.026703117415308952, 0.02884759195148945, -0.01821334846317768, -0.019975930452346802, -0.0024162062909454107, -0.004237540997564793, 0.05108550190925598, 0.014526613987982273, 0.019990617409348488, 0.0006641813088208437, -0.01581917330622673, -0.008871663361787796, -0.0005218895385041833, 0.03563353419303894, -0.006525225471705198, -0.010964728891849518, -0.011530224233865738, 0.02953793667256832, 0.01671515218913555, -0.01287419255822897, -0.014350355602800846, 0.011177707463502884, -0.02964075468480587, 0.0029486529529094696, 0.009716233238577843, -0.0027173140551894903, 0.0025080074556171894, -0.019065262749791145, 0.006947510875761509, 0.018933068960905075, -0.02301638387143612, -0.02827475406229496, 0.0015872418880462646, 0.009877803735435009, -0.0033911343198269606, 0.002151818946003914, 0.016803281381726265, -0.004266917239874601, 0.007296355441212654, 0.0014421960804611444, -0.040686268359422684, -0.03719048202037811, 0.01578979752957821, 0.018595241010189056, 0.022898878902196884, -0.013513129204511642, -0.01568697951734066, 0.05496318265795708, 0.02001999504864216, -0.0026861014775931835, -0.01648014225065708, -0.003657357767224312, 0.010494707152247429, -0.0013421328039839864, -0.01405659131705761, 0.004164100158959627, -0.004755299538373947, 0.00457904115319252, 0.005111488047987223, 0.009180114604532719, 0.03113894909620285, 0.008864318951964378, 0.031227078288793564, 0.012022278271615505, 0.0295085608959198, -0.020754404366016388, -0.015642914921045303, 0.008085845038294792, -0.022840125486254692, 0.002058181678876281, 0.021253801882267, 0.0003121239133179188, 0.0033782823011279106, -0.0020398215856403112, -0.007277994882315397, 0.0034425430931150913, -0.005419939756393433, 0.006128644570708275, 0.022796060889959335, 0.020989414304494858, -0.022428857162594795, -0.01888900436460972, 0.010186254978179932, -0.026556236669421196, -0.02530774101614952, 0.019270896911621094, 0.02607152611017227, 0.009672168642282486, 0.02491115964949131, -0.0176845733076334, 0.024191439151763916, 0.007637855596840382, -0.0023299132008105516, 0.005390563514083624, 0.02947918511927128, 0.009525286965072155, -0.012617149390280247, 0.013322182931005955, -0.01605418510735035, 0.01668577641248703, -0.016171690076589584, 0.007230258546769619, -0.030992068350315094, 0.01330749411135912, 0.004340358078479767, -0.03933495655655861, 0.02344234101474285, 0.012646526098251343, 0.054199397563934326, -0.02044595219194889, 0.05925213173031807, 0.029185421764850616, 0.0031267469748854637, -0.02480834163725376, 0.014541301876306534, 0.004450519569218159, 0.04685530439019203, -0.005093127489089966, -0.05452253669500351, -0.0007793917320668697, -0.027922237291932106, -0.027569720521569252, -0.0047075627371668816, 0.00635263929143548, 0.012536364607512951, -0.012506987899541855, -0.028230689465999603, 0.007281667087227106, 0.014240194112062454, -0.032255250960588455, 0.03357718884944916, -0.03313654288649559, 0.049675438553094864, -0.0063746715895831585, -0.019138703122735023, -0.007520350161939859, 0.021900082007050514, -0.011574288830161095, -0.016744529828429222, 0.018360229209065437, 0.030433915555477142, 0.023765482008457184, -0.023721417412161827, 0.00765988789498806, -0.010832535102963448, 0.04139130190014839, 0.006158020813018084, -0.008284135721623898, -0.0004906771355308592, -0.0016928131226450205, -0.026027461513876915, -0.02754034474492073, -0.005217977333813906, 0.016112936660647392, 0.020592832937836647, 0.004736939445137978, 0.03266651928424835, 0.011728514917194843, -0.03454660624265671, 0.00455333711579442, 0.01265387050807476, -0.006139660719782114, -0.02018156461417675, -0.024235503748059273, 0.03968747332692146, -0.018668681383132935, -0.024867095053195953, -0.0040245624259114265, 0.0158485509455204, 0.0177873894572258, 0.053141847252845764, -0.008688060566782951, 0.040010612457990646, 0.003191007999703288, 0.011214428581297398, 0.019990617409348488, 0.011779922991991043, -0.0030551422387361526, 0.0075166779570281506, -0.0025557440239936113, 0.025219611823558807, 0.014555989764630795, 0.010729718022048473, -0.02764316089451313, 0.03745486959815025, 0.0022729963529855013, 0.0018038925481960177, 0.021297866478562355, -0.007953651249408722, 0.007887554354965687, 0.011163019575178623, -0.011163019575178623, 0.020563457161188126, 0.01505538821220398, -0.0069658709689974785, 0.026850000023841858, -0.019138703122735023, 0.02115098387002945, -0.002733838278800249, -0.0012879701098427176, 0.004604745656251907, 0.006297558546066284, 0.009642792865633965, 0.032989662140607834, -0.016112936660647392, -0.024397073313593864, -0.0004925131797790527, -0.022487608715891838, -0.02201758697628975, -0.011882741004228592, 0.022193845361471176, -0.02081315591931343, 0.008357576094567776, -0.009752954356372356, 0.003376446198672056, 0.054228775203228, 0.013880333863198757, 0.039481837302446365, 0.0015284890541806817, 0.01208837516605854, 0.023207329213619232, -0.0011787267867475748, -0.02480834163725376, -0.006991575472056866, 0.01794896088540554, -0.02367735281586647, -0.02220853418111801, 0.01689141057431698, 0.007208226248621941, 0.015540097840130329, 0.006084579974412918, -0.02101879008114338, -0.026717806234955788, -0.029655443504452705, -0.012940289452672005, -0.021635694429278374, 0.018330853432416916, 0.01000999752432108, 0.005897305905818939, -0.018125219270586967, -0.002763214521110058, -0.023736104369163513, -0.02214978076517582, -0.004894837271422148, -0.012602461501955986, 0.0245145782828331, -0.033518433570861816, 0.029934518039226532, -0.0008422755054198205, -0.003475591540336609, -0.018228035420179367, -0.005860585253685713, 0.007821457460522652, -0.007300027180463076]",Online Speculative Decoding.pdf
" Hailong Yang, Xuezhu Wang, Tongxuan Liu, Pengbo Wang,
Xuning Liang, Kejie Ma, Tianyu Feng, Xin You, Yongjun Bao, et al .2024.
Minions: Accelerating Large Language Model Inference with Adaptive
and Collective Speculative Decoding. arXiv preprint arXiv:2402.15678
(2024).[38] Qingyun Wu, Gagan Bansal, Jieyu Zhang, Yiran Wu, Beibin Li, Erkang
Zhu, Li Jiang, Xiaoyun Zhang, Shaokun Zhang, Jiale Liu, Ahmed Has-
san Awadallah, Ryen W White, Doug Burger, and Chi Wang. 2023.
AutoGen: Enabling Next-Gen LLM Applications via Multi-Agent Con-
versation. arXiv:2308.08155 [cs.AI]
[39] Yiran Wu, Feiran Jia, Shaokun Zhang, Hangyu Li, Erkang Zhu, Yue
Wang, Yin Tat Lee, Richard Peng, Qingyun Wu, and Chi Wang. 2023.
An Empirical Study on Challenging Math Problem Solving with GPT-4.
InArXiv preprint arXiv:2306.01337 .
[40] Zihao Ye, Ruihang Lai, Bo-Ru Lu, Chien-Yu Lin, Size Zheng, Lequn
Chen, Tianqi Chen, and Luis Ceze. 2024. Cascade Inference: Memory
Bandwidth Efficient Shared Prefix Batch Decoding. https://flashinfer.
ai/2024/02/02/cascade-inference.html
[41] Gyeong-In Yu, Joo Seong Jeong, Geon-Woo Kim, Soojeong Kim, and
Byung-Gon Chun. 2022. Orca: A distributed serving system for
{Transformer-Based }generative models. In 16th USENIX Symposium
on Operating Systems Design and Implementation (OSDI 22) . 521‚Äì538.
[42] Tao Yu, Rui Zhang, Kai Yang, Michihiro Yasunaga, Dongxu Wang,
Zifan Li, James Ma, Irene Li, Qingning Yao, Shanelle Roman, et al .
2018. Spider: A large-scale human-labeled dataset for complex and
cross-domain semantic parsing and text-to-sql task. arXiv preprint
arXiv:1809.08887 (2018).
[43] Jun Zhang, Jue Wang, Huan Li, Lidan Shou, Ke Chen, Gang Chen,
and Sharad Mehrotra. 2023. Draft & verify: Lossless large language
model acceleration via self-speculative decoding. arXiv preprint
arXiv:2309.08168 (2023).
[44] Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhang-
hao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric Xing,
et al.2024. Judging llm-as-a-judge with mt-bench and chatbot arena.
Advances in Neural Information Processing Systems 36 (2024).
[45] Lianmin Zheng, Liangsheng Yin, Zhiqiang Xie, Jeff Huang, Chuyue
Sun, Cody Hao Yu, Shiyi Cao, Christos Kozyrakis, Ion Stoica, Joseph E.
Gonzalez, Clark Barrett, and Ying Sheng. 2023. Efficiently Program-
ming Large Language Models using SGLang. arXiv:2312.07104 [cs.AI]
[46] Yongchao Zhou, Kaifeng Lyu, Ankit Singh Rawat, Aditya Krishna
Menon, Afshin Rostamizadeh, Sanjiv Kumar, Jean-Fran√ßois Kagy, and
Rishabh Agarwal. 2023. Distillspec: Improving speculative decoding
via knowledge distillation. arXiv preprint arXiv:2310.08461 (2023).
15
Algorithm 3 SmartSpec confidence based propose and ver-
ify.
Require: Pending requests ùëÖ. Confidence threshold ùëá. Max
propose length ùëÉ.
1:ùëèùëíùë†ùë°_ùëîùëúùëúùëëùëùùë¢ùë°,ùëèùëíùë†ùë° _ùë£ùëíùëüùëñùëìùë¶ _ùëôùëíùëõÔøΩ","[0.027521731331944466, 0.021616799756884575, 0.018842371180653572, -0.014339489862322807, -0.013300933875143528, -0.0003050758095923811, -0.015949251130223274, 0.03050387091934681, -0.04228406399488449, 0.009717916138470173, 0.024376390501856804, -0.011001274921000004, -0.054717060178518295, 0.0341239795088768, 0.003916839603334665, -0.012462670914828777, -0.011053202673792839, -0.00991079118102789, -0.014539782889187336, 0.027373366057872772, -0.008441976271569729, -0.016883952543139458, -0.016809768974781036, 0.021883856505155563, 0.012774237431585789, -0.03364921361207962, 0.0012342124246060848, 0.050414472818374634, 0.047031745314598083, -0.034925151616334915, 0.041512563824653625, -0.028204211965203285, -0.0398508757352829, -0.020326023921370506, -0.0386936254799366, 0.028144866228103638, 0.013553154654800892, 0.002690972527489066, -0.013886976055800915, -0.009421185590326786, -0.0009082728065550327, -0.05056283622980118, -0.043381962925195694, 3.0390222036658088e-06, 0.031305041164159775, 0.04979133978486061, 0.024079661816358566, 0.003683164482936263, -0.0057973675429821014, 0.04261046648025513, -0.008946417830884457, 0.021334905177354813, -0.023263651877641678, 0.04848572611808777, -0.019673217087984085, -0.023738421499729156, -0.0022625683341175318, 0.038604605942964554, 0.010073992423713207, -0.01992543786764145, 0.01471040304750204, -0.03623076528310776, -0.01743290387094021, 0.04065204784274101, -0.054509349167346954, -0.022002549842000008, -0.02071177214384079, 0.04026629775762558, 0.015044224448502064, 0.015251935459673405, -0.013397371396422386, 0.009658570401370525, 0.03575599566102028, -0.01753675937652588, -0.017076827585697174, 0.005441291257739067, -0.00169321708381176, 0.08747608214616776, -0.007826260291039944, -0.034925151616334915, -0.0007589804008603096, 0.0044175717048347, 0.0012564671924337745, -0.04575580731034279, -0.015978924930095673, -0.022358626127243042, -0.003838947741314769, 0.0306819099932909, -0.051304664462804794, -0.04163125529885292, -0.008612595498561859, 0.0059902421198785305, -0.042669810354709625, -0.019228121265769005, 0.03626043722033501, 0.013827630318701267, 0.03483613207936287, -0.008382629603147507, 0.033115096390247345, 0.044272154569625854, -0.011476042680442333, -0.0009699370712041855, 0.04510299861431122, -0.04056302830576897, 0.050829894840717316, -0.00017537221719976515, -0.05715024843811989, -0.0031564682722091675, -0.0016487075481563807, 0.029465315863490105, -0.13091738522052765, 0.0013315770775079727, -0.015444810502231121, 0.009206056594848633, -0.025771023705601692, -0.05442032963037491, -0.05952409282326698, -0.030563216656446457, -0.019302302971482277, 0.020800791680812836, 0.003429089207202196, 0.022610846906900406, 0.020044129341840744, -0.020073803141713142, 0.006487265229225159, 0.0027799915987998247, 0.013063549995422363, -0.07809940725564957, -0.006843341514468193, -0.006220208015292883, -0.001439141808077693, 0.007084434852004051, 0.056082021445035934, -0.03700226545333862, -0.015415137633681297, -0.03234359994530678, -0.04623057693243027, -0.0078040058724582195, -0.060621991753578186, 0.015919579192996025, 0.014228216372430325, -0.01948034204542637, -0.02050406113266945, 0.00039455853402614594, -0.03934643417596817, -0.01511840708553791, -0.022061895579099655, 0.0018990737153217196, -0.05204648897051811, 0.058366842567920685, -0.003375306725502014, 0.002837483072653413, -0.03738801181316376, 0.018812699243426323, 0.003137922612950206, -0.034717440605163574, -0.043560001999139786, 0.049257222563028336, 0.03593403473496437, -0.04943526163697243, 0.006383409723639488, 0.06623019278049469, 0.0024739885702729225, -0.0026075171772390604, 0.038367222994565964, 0.05127498880028725, -0.010252030566334724, 0.00231635058298707, -0.050859566777944565, -0.03252163529396057, -0.002570425858721137, -0.00036766735138371587, -0.014294980093836784, -0.030385179445147514, -0.010252030566334724, -0.013330606743693352, -0.019183611497282982, -0.03367888554930687, 0.013686683028936386, -0.06872273236513138, 0.0025463164784014225, 0.037209976464509964, -0.03091929294168949, -0.01907975599169731, -0.03504384309053421, -0.0011832119198516011, 0.0008377993362955749, 0.02488083206117153, 0.023426854982972145, 0.03462842106819153, 0.004450954031199217, 0.06640823185443878, 0.06534000486135483, 0.030444525182247162, 0.0187681894749403, -0.04489528760313988, 0.06848534196615219, 0.020459551364183426, 0.02551880292594433, -0.009146710857748985, -0.0011359205236658454, 0.04344131052494049, -0.012017576023936272, -0.05804044008255005, 0.02170581929385662, 0.004046658985316753, 0.01489585917443037, 0.00375363789498806, -0.02412416972219944, -0.014881023205816746, 0.03477678820490837, 0.006487265229225159, 0.07400453090667725, 0.017996691167354584, -0.018812699243426323, -0.0020882391836494207, -0.036764878779649734, -0.007744659669697285, 0.00761854974552989, 0.03157209977507591, -0.002188385697081685, 0.019613871350884438, 0.035607632249593735, 0.02283339388668537, -0.012818747200071812, 0.0659334659576416, 0.01982158236205578, 0.0023627146147191525, 0.040622372180223465, 0.018471458926796913, 0.03884199261665344, -0.03097863867878914, -0.0341833271086216, -0.06074068695306778, -0.008894490078091621, -0.03783310949802399, 0.008434557355940342, -0.005597074516117573, -6.0447200667113066e-05, -0.06023624539375305, 0.034658096730709076, 0.015919579192996025, 0.03634945675730705, 0.0029135202057659626, 0.01903524622321129, 0.01091967336833477, -0.036942917853593826, -0.04854506999254227, 0.03483613207936287, 0.0032899968791753054, 0.006205371581017971, -0.04231373593211174, -0.006832214538007975, -0.02808551862835884, -0.040859758853912354, -0.017180683091282845, -0.02459893934428692, -0.039939895272254944, -0.057446978986263275, -0.0028597379568964243, -0.02548912912607193, -0.005938314367085695, -0.0386936254799366, 0.01726970076560974, -0.02811519242823124, -0.0301626306027174, -0.01247008889913559, 0.033322807401418686, 0.004354516509920359, -0.036735206842422485, -0.002065984532237053, -0.018486294895410538, 0.021349743008613586, 0.0021679855417460203, -0.05637875199317932, -0.03551861271262169, 0.036052726209163666, 0.042195044457912445, -0.049464933574199677, 0.04967264458537102, 0.0012638855259865522, 0.00749985734000802, 0.04367869347333908, 0.01798185333609581, 0.011008692905306816, 0.03566697612404823, 0.006624503061175346, -0.04065204784274101, -0.014992296695709229, -0.013820212334394455, 0.06801057606935501, -0.007766914553940296, 0.010556179098784924, -0.0341239795088768, 0.0306819099932909, -0.014020505361258984, 0.022922413423657417, -0.016453692689538002, -0.0008943635621108115, -0.004450954031199217, 0.06011755019426346, -0.009755006991326809, 0.015355790965259075, -0.0068173776380717754, -0.001467887545004487, 0.05418294668197632, -0.02709147334098816, -0.021409088745713234, 0.016498202458024025, -0.014599128626286983, 0.027477221563458443, 0.007562912534922361, -0.041512563824653625, -0.0006704249535687268, -0.02409449778497219, -0.07139330357313156, 0.022225096821784973, -0.04097845032811165, -0.0007612985791638494, -0.03845624253153801, -0.01207692176103592, 0.006635630503296852, 0.0066912672482430935, -0.0018962918547913432, 0.008189755491912365, 0.02367907576262951, 0.012477507814764977, -0.008516158908605576, -0.0037944382056593895, -0.03391626849770546, 0.018041200935840607, 0.04160158336162567, 0.02002929337322712, -0.010496833361685276, 0.010207520797848701, -0.054509349167346954, -0.03661651536822319, 0.02795199118554592, 0.026943108066916466, 0.012944857589900494, -0.09667471796274185, 0.03433169052004814, -0.008189755491912365, -0.02310045063495636, -0.010800981894135475, 0.00830844696611166, 0.008508739992976189, 0.023130124434828758, 0.08379662781953812, 0.007544367108494043, 0.010563597083091736, -0.039435453712940216, 0.05952409282326698, 0.001104392926208675, 0.016097616404294968, 0.009858863428235054, -0.006090388633310795, -0.029539497569203377, -0.02453959360718727, 0.018412113189697266, -0.017521921545267105, 0.0059271869249641895, 0.025058871135115623, -0.002627917332574725, -0.017581267282366753, 0.015978924930095673, -0.032195232808589935, -0.021231049671769142, 0.005493219010531902, -0.0010367013746872544, 0.0038723298348486423, 0.06658627092838287, -0.02942080609500408, -0.020355695858597755, -0.016676241531968117, 0.0036609095986932516, -0.0034012706018984318, 0.03385692462325096, 0.0006110788672231138, 0.05845586210489273, 0.019673217087984085, 0.011357351206243038, 0.008701615035533905, -0.012573945336043835, -0.005667548161000013, 0.002583407796919346, -0.00415422348305583, -0.005459836684167385, -0.011817282997071743, -0.006717231590300798, -0.016290491446852684, -0.011127385310828686, -0.02091948315501213, 0.013056132011115551, 0.024999525398015976, 0.02764042466878891, 0.0019120556535199285, 0.023738421499729156, 0.029910409823060036, 0.008338120765984058, -0.004246952012181282, -0.028604798018932343, -0.027017289772629738, -0.01364959217607975, -0.0022291860077530146, 0.05029578134417534, 0.02784813567996025, 0.040592700242996216, 0.009332166984677315, -0.004220988135784864, 0.03504384309053421, -0.028486104682087898, 0.03477678820490837, -0.03738801181316376, 0.010793562978506088, -0.009665988385677338, 0.046764690428972244, 0.015073897317051888, 0.018100546672940254, 0.054479677230119705, -0.0027132274117320776, -0.014517528004944324, -0.0020975121296942234, -0.06522130966186523, -0.020429879426956177, -0.028753163293004036, 0.026082590222358704, -0.02856028825044632, 0.06124512478709221, -0.07020638138055801, -0.03299640491604805, 0.031750138849020004, 0.04050368070602417, -0.051987141370773315, -0.0147771667689085, -0.024079661816358566, 0.047684554010629654, 0.0038463659584522247, -0.008924162946641445, -0.054954443126916885, -0.015919579192996025, 0.009243147447705269, -0.030859947204589844, -0.002993266563862562, 0.008093317970633507, 0.009658570401370525, -0.043352290987968445, -0.002110494067892432, 0.0024721340741962194, -0.03807049244642258, 0.04418313503265381, -0.014784585684537888, 0.039020027965307236, -0.004310007207095623, -0.02706179954111576, -0.03498449921607971, 0.06480588763952255, -0.03510319069027901, 0.06860403716564178, 0.010400395840406418, 0.046052537858486176, 0.03258098289370537, -0.050622183829545975, -0.04370836913585663, -0.017447739839553833, -0.006235044449567795, 0.029257604852318764, 0.00977726187556982, 0.021038176491856575, 0.03738801181316376, 0.026898598298430443, -0.03593403473496437, 0.008575504645705223, -0.001943583250977099, 0.012314305640757084, 0.002299659652635455, 0.029569171369075775, -0.021201377734541893, 0.03305575251579285, -0.044450193643569946, 0.007295855320990086, -0.023219143971800804, 0.05842619016766548, -0.0057825311087071896, 0.036497823894023895, 0.05682384595274925, -0.012240123003721237, -0.010229775682091713, -0.013708937913179398, -0.02750689536333084, -0.013286097906529903, -0.027180492877960205, 0.04869343712925911, -0.019510013982653618, 0.011335096322000027, 0.019168775528669357, 0.02522207237780094, -0.032848041504621506, -0.025266582146286964, -0.0074850209057331085, 0.007585167419165373, -0.014102105982601643, -0.013249006122350693, 0.017967017367482185, -0.017225190997123718, -0.030859947204589844, 0.021512944251298904, 0.012989367358386517, -0.004462081473320723, 0.032432619482278824, -0.022002549842000008, 0.002375696785748005, -0.010800981894135475, 0.005834458861500025, 0.0031601772643625736, 0.04207635298371315, -0.011520552448928356, 0.04943526163697243, -0.0074850209057331085, -0.0021624218206852674, -0.018204402178525925, -0.015207425691187382, 0.002809664700180292, -0.011839537881314754, 0.03459874913096428, -0.0064353374764323235, -0.0008526358869858086, -0.06658627092838287, -0.0306819099932909, -0.011609571985900402, 0.009844026528298855, -0.011884046718478203, -0.006123770959675312, -0.0006500247400254011, -0.05317406356334686, -0.006924942601472139, -0.0006110788672231138, -0.0068655963987112045, -0.036705534905195236, -0.0014530509943142533, -0.007774333003908396, 0.029287276789546013, 0.012596199288964272, 0.013434463180601597, 0.005270671099424362, -0.012447834946215153, 0.02218058705329895, -0.01165408082306385, -0.011624407954514027, 0.012959694489836693, 0.05617103725671768, -0.040147606283426285, -0.0018406548770144582, -0.04269948601722717, 0.00830844696611166, 0.0008308447431772947, 0.012573945336043835, 0.02289273962378502, -0.018278583884239197, 0.011535389348864555, 0.007017670664936304, -0.025311091914772987, -0.005363399628549814, -0.010059155523777008, -0.008590341545641422, -0.01577121391892433, 0.01808570884168148, -0.0020845301914960146, 0.026082590222358704, 0.025949060916900635, -0.03664618730545044, -0.013159987516701221, 0.011505715548992157, -0.025311091914772987, 0.030533544719219208, -0.05394556373357773, 0.02320430614054203, 0.005678675603121519, 0.027150819078087807, -0.0018823826685547829, -0.017907671630382538, -0.028070682659745216, 0.02173549123108387, 0.0030377760995179415, -0.022714702412486076, -0.004803321324288845, -0.004250661004334688, 0.011824700981378555, -0.01955452375113964, -0.00948795024305582, 0.051512375473976135, -0.003564472310245037, -0.016780097037553787, -0.013345443643629551, -0.03795180097222328, -0.0045881918631494045, 0.02876799926161766, -0.028738325461745262, -0.05136400833725929, 0.02129039727151394, 0.011068038642406464, -0.0012036121916025877, -0.02446541003882885, -0.011164476163685322, -0.010125920176506042, -0.03795180097222328, -0.013478972017765045, 0.004224697127938271, 0.011535389348864555, -0.0063092270866036415, -0.005660129711031914, 0.010318795219063759, -0.006168280262500048, -0.03685389831662178, -0.044717252254486084, -0.0077224052511155605, -0.03519221022725105, -0.016127290204167366, 0.05703155696392059, -0.030830275267362595, 0.03228425234556198, -0.04323359951376915, 0.0049257222563028336, 0.0009829190094023943, 0.019836418330669403, 0.012047248892486095, -0.01903524622321129, 0.007922697812318802, -0.036527495831251144, -0.0007566621643491089, -0.022061895579099655, -0.0250143613666296, 0.018575314432382584, 0.006431628484278917, 0.0029710116796195507, 0.001464178436435759, -0.022032221779227257, -0.0053522721864283085, 0.022195423021912575, -0.005474673584103584, 0.01580088585615158, 0.031127003952860832, -0.009354421868920326, -0.02968786284327507, 0.0363791286945343, -0.031097332015633583, -0.00754065765067935, 0.013234170153737068, -0.028337739408016205, 0.007043634541332722, -0.018931390717625618, -0.02514789067208767, 0.026883762329816818, 0.0239164587110281, 0.025533638894557953, -0.042877521365880966, 0.012121431529521942, -0.02600840851664543, -0.013775702565908432, -0.011208985932171345, -0.05551823228597641, 0.009517623111605644, -0.013968577608466148, 0.005100051406770945, 0.003184286644682288, 0.030043939128518105, 0.013249006122350693, 0.010244612582027912, 0.02664637751877308, -0.010073992423713207, -0.03275902196764946, 0.011186731047928333, 0.02483632229268551, -0.015140661969780922, -0.014287562109529972, -0.026453502476215363, -0.009651151485741138, -0.019465506076812744, 0.026468340307474136, 0.028782835230231285, -0.027135983109474182, 0.047180112451314926, -0.04344131052494049, -0.03183915838599205, 0.032195232808589935, 0.004947977140545845, 0.03436136618256569, 0.023901622742414474, 0.01942099630832672, 0.004005858674645424, -0.013679265044629574, -0.017210355028510094, -0.007737241685390472, -0.038337551057338715, 0.0031991230789572, -0.012158522382378578, -0.004499172791838646, 0.025207236409187317, -0.01624598167836666, -0.07352975755929947, -0.027803625911474228, 0.019732562825083733, -0.028812509030103683, -0.0041764783672988415, -0.03091929294168949, -0.021958040073513985, -0.028397087007761, 0.011372187174856663, 0.06439046561717987, -0.021097522228956223, -0.004662374500185251, -0.002564862137660384, -0.0030377760995179415, -0.0011757937027141452, -0.03252163529396057, -0.012210450135171413, 0.03919806703925133, 0.0077224052511155605, -0.0008683996857143939, -0.04189831390976906, -0.0637376606464386, -0.029910409823060036, -0.026913434267044067, -0.02344169095158577, 0.009762425906956196, -0.004502881783992052, 0.014769748784601688, 0.021572289988398552, -0.011453787796199322, 0.0024239153135567904, -0.0014094687066972256, 0.017566431313753128, 0.015073897317051888, -0.04385673254728317, -0.01832309365272522, 0.006387118715792894, -0.03364921361207962, -0.003647927660495043, -0.031750138849020004, -0.024346718564629555, 0.006101516075432301, -0.0363791286945343, -0.0170619897544384, 0.04284784942865372, 0.03442071005702019, -0.002386823995038867, 0.022017385810613632, 0.03474711254239082, -0.019643543288111687, 0.0023515874054282904, -0.05845586210489273, 0.013352861627936363, -0.005059251096099615, -0.00702137965708971, 0.010585851967334747, -0.020326023921370506, 0.011283168569207191, 0.010548761114478111, -0.0375957228243351, 0.006631921511143446, 0.005930896382778883, 0.016661403700709343, -0.0027429002802819014, 0.03160177171230316, 0.0062610087916255, -0.0027707188855856657, -0.028070682659745216, -0.019228121265769005, 0.0017349447589367628, 0.015370627865195274, 0.012232705019414425, -0.023352671414613724, 0.022358626127243042, 0.008174918591976166, 0.0318688303232193, -0.00702879810705781, -0.006194244138896465, 0.02221026085317135, -0.0038649116177111864, 0.008338120765984058, -0.003746219677850604, 0.0009045636397786438, 0.016335001215338707, -0.024865996092557907, -0.015370627865195274, -0.007714986801147461, -0.034658096730709076, 0.004187605809420347, 0.004005858674645424, -0.04489528760313988, -0.03504384309053421, 0.022640518844127655, -0.01624598167836666, 0.008924162946641445, -0.010756472125649452, 0.02057824470102787, -0.0012666672701016068, -0.1408875286579132, -0.020385369658470154, 0.014243052341043949, -0.0008943635621108115, 0.02194320224225521, -0.024317044764757156, 0.009873699396848679, 0.032670002430677414, -0.007255055010318756, -0.014925532042980194, 0.045370057225227356, -0.015889905393123627, -0.0004029040574096143, -0.015608011744916439, 0.015059061348438263, -0.05225419998168945, 0.0012648127740249038, -0.0363197848200798, 0.031067658215761185, -0.003916839603334665, -0.015311281196773052, -0.010578433983027935, -0.031720466911792755, 0.04142354428768158, 0.0085458317771554, -0.0007501711952500045, -0.007332946639508009, 0.025533638894557953, -1.3068881344224792e-05, 0.004117132630199194, -0.01074905414134264, -0.012811329215765, 0.038100164383649826, 0.04658665135502815, -0.042640138417482376, 0.0008697906159795821, -0.027937155216932297, -0.029865901917219162, 0.0011591025395318866, -0.0006384337320923805, 0.013508644886314869, -0.03477678820490837, 0.017106499522924423, -0.004870085511356592, 0.014888441190123558, -0.016023434698581696, 0.02829323150217533, -0.010993856005370617, 0.006316645536571741, -0.031245697289705276, -0.010786144994199276, 0.05578529089689255, 0.016498202458024025, 0.023011431097984314, 0.016498202458024025, 0.007303273770958185, 0.012870674952864647, -0.012447834946215153, 0.010274285450577736, 0.033560194075107574, -0.022744374349713326, -0.0034828714560717344, 0.008249101229012012, -0.005708348471671343, -0.019257795065641403, -0.016883952543139458, 0.011105130426585674, 0.02712114527821541, -0.014821676537394524, -0.04542940482497215, -0.008849980309605598, 0.01805603690445423, 0.034895479679107666, 0.025325927883386612, 0.014532364904880524, 0.011646662838757038, 0.00688414229080081, 0.030043939128518105, -0.04026629775762558, 0.013330606743693352, 0.018515968695282936, -0.007407129276543856, -0.01272972859442234, -0.010667452588677406, -0.001567106693983078, 0.016676241531968117, 0.027417875826358795, 0.018604988232254982, -0.014658475294709206, 0.03614174574613571, 0.04691305384039879, -0.0318094827234745, -0.010682289488613605, -0.0073403650894761086, -0.010993856005370617, -0.01155022531747818, -0.008412303403019905, 0.013419626280665398, 0.03228425234556198, 0.006902687717229128, 0.026839252561330795, 0.05394556373357773, -0.044450193643569946, -0.027922317385673523, 0.0005424600094556808, 0.013159987516701221, 0.013582827523350716, -0.026913434267044067, 0.0068173776380717754, 0.0007538803038187325, 0.02866414375603199, 0.032195232808589935, -0.021409088745713234, -0.0007014888687990606, 0.013516063801944256, 0.01979190856218338, 0.04180929437279701, 0.03373822942376137, 0.033115096390247345, 0.0053077624179422855, 0.013797957450151443, 0.024302208796143532, -0.01664656773209572, -0.024272534996271133, -0.0306819099932909, 0.005574819631874561, 0.019836418330669403, 0.01583055965602398, -0.008352956734597683, -0.008664524182677269, -0.003136067884042859, 0.0176702868193388, -0.005649002268910408, -0.005763985216617584, 0.00893899891525507, -0.003512544557452202, 0.0031101040076464415, 0.016097616404294968, -0.009324749000370502, 0.03026648610830307, 0.006071843206882477, 0.010845490731298923, 0.025682004168629646, -0.02593422494828701, -0.0013853594427928329, 0.0002496707020327449, -0.022403134033083916, -0.04394575208425522, -0.007893024943768978, -0.0007752078236080706, 0.008605177514255047, -0.015578338876366615, -0.026943108066916466, 0.025266582146286964, 0.020637590438127518, 0.0038352387491613626, -0.03385692462325096, -0.025815533474087715, -0.011290586553514004, 0.023634565994143486, 0.043144579976797104, 0.01808570884168148, -0.0013297224650159478, 0.0020993666257709265, -0.007818842306733131, -0.03531090170145035, -0.028708653524518013, -0.017210355028510094, -0.04278850555419922, 0.01376828458160162, -0.03501417115330696, -0.003323378972709179, 0.03305575251579285, 0.027625586837530136, 0.012573945336043835, 0.02811519242823124, 0.0013733047526329756, 0.004106005188077688, 0.012477507814764977, 0.031720466911792755, 0.0187385156750679, 0.004866376519203186, -0.009302494116127491, 0.004091168288141489, 0.03931675851345062, -0.027833299711346626, 0.002379405777901411, 0.02556331269443035, -0.015786049887537956, 0.04207635298371315, -0.013990831561386585, 0.00478477543219924, -0.012596199288964272, 0.026423830538988113, -0.0009662279044277966, -0.034658096730709076, 0.005363399628549814, 0.04275882989168167, -0.028233883902430534, -0.03047419898211956, -0.010207520797848701, 0.023248815909028053, -0.04890114814043045, 0.017314210534095764, -0.04409411549568176, 0.00027262093499302864, 0.009740171022713184, 0.014495273120701313, -0.02528141811490059, -0.016023434698581696, -0.02091948315501213, 0.0019788199570029974, -0.023085614666342735, 0.051512375473976135, -0.009005763567984104, -0.044450193643569946, 0.026913434267044067, 0.02740303985774517, -0.03771441802382469, -0.0016041980125010014, -0.031750138849020004, -0.02753656916320324, -0.025578148663043976, 0.0010533924214541912, -0.0150813153013587, -8.780202188063413e-05, 0.002570425858721137, -0.006197953596711159, -0.01952485181391239, -0.0020270387176424265, 0.007811424322426319, 0.004884921945631504, 0.024450574070215225, -0.03450972959399223, -0.019064920023083687, -0.024079661816358566, 0.0014975605299696326, -0.02225477062165737, -0.032670002430677414, 0.02415384352207184, 0.02893120050430298, 0.010548761114478111, -0.0032974150963127613, -0.007013961672782898, 0.00934700295329094, -0.0069286515936255455, 0.00577511265873909, 0.03163144737482071, -0.028857018798589706, -0.01805603690445423, 0.0014919968089088798, 0.014665893279016018, 0.007796587888151407, -0.010496833361685276, 0.019183611497282982, -0.023634565994143486, 0.028159702196717262, 0.027284348383545876, 0.019020410254597664, 0.03531090170145035, -0.03999923914670944, 0.018412113189697266, 0.020489225164055824, -0.006858178414404392, 0.011728263460099697, -0.006457592360675335, 0.010274285450577736, -0.005712057463824749, 0.017566431313753128, 0.009933045133948326, -0.02286306768655777, 0.008278774097561836, -0.0026557359378784895, 0.035162534564733505, -0.012892929837107658, -0.026498012244701385, 0.006824796088039875, -0.015207425691187382, 0.019064920023083687, 0.01761094108223915, -0.02893120050430298, -0.016335001215338707, -0.00926540233194828, -0.014947786927223206, 0.014702984131872654, -0.02336750738322735, -0.029776882380247116, -0.009020600467920303, 0.02453959360718727, -0.009176383726298809, 0.023871948942542076, 0.04581515118479729, -0.01499971468001604, 0.008760960772633553, -0.043114908039569855, 0.01832309365272522, 0.020771117880940437, 0.005300344433635473, 0.01856047846376896, -0.03136438876390457, 0.02118654176592827, 0.022106405347585678, 0.000641215534415096, -0.0341239795088768, 0.011082875542342663, 0.015786049887537956, 0.01144636981189251, -0.04982101172208786, -0.004020695108920336, -0.013263843022286892, -0.002490679733455181, 0.046082209795713425, 0.05056283622980118, 0.012091758660972118, 0.04044433683156967, -0.016127290204167366, 0.005378236062824726, -0.0006398246041499078, 0.02026667632162571, -0.0001393241254845634, -0.006350027862936258, 0.007073307875543833, 0.004636410158127546, -0.018145056441426277, -0.014881023205816746, -0.010489414446055889, 0.017076827585697174, -0.020489225164055824, 0.0018972191028296947, 0.0145026920363307, 0.02777395211160183, 0.016008596867322922, 0.016260817646980286, 0.023664237931370735, -0.020044129341840744, -0.017240028828382492, -0.013412208296358585, 0.0006175698363222182, -0.01409468799829483, -0.03456907719373703, 0.030414851382374763, 0.021067848429083824, -0.005719475913792849, 0.010563597083091736, -0.013449299149215221, -0.008441976271569729, -0.010355886071920395, -0.0053077624179422855, -0.004792193882167339, -0.021334905177354813, 0.11038365960121155, -0.0021327487193048, -0.004209860693663359, -0.005318889860063791, -0.02795199118554592, 0.02511821687221527, -0.014332071878015995, -0.01497745979577303, -0.04020695015788078, -0.0027874098159372807, -0.004421281162649393, 0.015889905393123627, -0.004532554652541876, 0.01685427874326706, 0.0049071768298745155, -0.028916364535689354, -0.00338643416762352, -0.0027929735369980335, -0.008612595498561859, 0.03545926511287689, 0.01395374070852995, 0.022061895579099655, 0.00037462194450199604, -0.020459551364183426, -0.015978924930095673, -0.002125330502167344, 0.009576968848705292, -0.016735587269067764, 0.014421090483665466, 0.0353405736386776, 0.0027799915987998247, 0.0019510014681145549, -0.06124512478709221, 0.016527876257896423, -0.004209860693663359, 0.007922697812318802, -0.02890152856707573, 0.022952085360884666, -0.015608011744916439, -0.021794838830828667, 0.00926540233194828, -0.00636486429721117, 0.005059251096099615, 0.02661670558154583, -0.0009884827304631472, 0.003189850365743041, -0.009473113343119621, -0.0006263790419325233, -0.001224939594976604, 0.003994731232523918, 0.007017670664936304, -0.027447549626231194, 0.02115686796605587, -0.007069598417729139, -0.006350027862936258, -0.028753163293004036, -0.011661499738693237, 0.054924771189689636, 0.017729632556438446, 0.02078595571219921, -0.03442071005702019, 0.011394442059099674, -0.031512755900621414, 0.008249101229012012, -0.005411618389189243, -0.049049511551856995, -0.00916154682636261, -0.007321819197386503, -0.009154128842055798, 0.04465790465474129, -0.019361650571227074, 0.017462575808167458, -0.02283339388668537, 0.005749148782342672, 0.018308257684111595, 0.00846423115581274, 0.011750518344342709, 0.004966522566974163, 0.0233378354460001, 0.05531052127480507, -0.005274380557239056, 0.009858863428235054, -0.008390048518776894, 0.024272534996271133, 0.02241797186434269, -0.009257984347641468, 0.04370836913585663, -0.0006657885387539864, -0.007299564313143492, -0.008575504645705223, -0.013983413577079773, -0.017314210534095764, 0.0341239795088768, 0.018278583884239197, 0.0102223576977849, -0.017388394102454185, 0.0037777472753077745, -0.010674871504306793, 0.011119966395199299, 0.012106594629585743, 0.014747493900358677, -0.006583702750504017, -0.0144878551363945, 0.011980484239757061, 0.009020600467920303, 0.03679455444216728, -0.04145321622490883, -0.017492249608039856, -0.01178761012852192, 0.007907861843705177, -0.0040318225510418415, -0.019406158477067947, 0.015533829107880592, -0.008642269298434258, -0.017818652093410492, 0.033589866012334824, 0.0007756714476272464, 0.018486294895410538, 0.004310007207095623, -0.047180112451314926, 0.026735397055745125, 0.02040020562708378, 0.005979114677757025, 0.01931714080274105, -0.021245887503027916, -0.01784832589328289, 0.004428699146956205, -0.014213379472494125, 0.011194149032235146, -0.02299659512937069, -0.008998345583677292, -0.026082590222358704, -0.0064650108106434345, 0.02627546526491642, 0.018234074115753174, 0.020756281912326813, 0.023931296542286873, -0.027684934437274933, -0.030592890456318855, 0.0024795522913336754, -0.02514789067208767, 0.019465506076812744, -0.0010775018017739058, 0.014732657931745052, -0.013004204258322716, -0.014450764283537865, -0.01952485181391239, -0.014806840568780899, 0.00971049815416336, 0.010556179098784924, -0.03703193739056587, -0.008983508683741093, 0.0012054666876792908, -0.008575504645705223, -0.020251840353012085, 0.0020882391836494207, 0.007700150366872549, 0.003913130145519972, -0.001939874142408371, -0.0056082019582390785, 0.001136847771704197, -0.00033011240884661674, -0.01795218139886856, 0.0221509151160717, 0.031275369226932526, -0.005986533127725124, -0.027046963572502136, 0.02422802522778511, 0.02712114527821541, 0.013634755276143551, 0.012247541919350624, 0.004829285200685263, 0.01685427874326706, -0.014984878711402416, 0.000995900947600603, -0.03353051841259003, -0.02979171834886074, 0.014532364904880524, 0.011290586553514004, 0.00791527982801199, -0.006186826154589653, -0.019628707319498062, 0.051779430359601974, 0.02244764380156994, 0.0003048439684789628, 0.013701519928872585, 1.0888319593505003e-05, 0.012010157108306885, -0.02136457897722721, -0.021750329062342644, 0.008998345583677292, 0.013338025659322739, -0.026913434267044067, -0.00864968728274107, 0.0013668137835338712, 0.028515778481960297, 0.0009263547835871577, 0.03225458040833473, 0.015281608328223228, 0.03160177171230316, -0.042224716395139694, -0.019124265760183334, 0.010556179098784924, -0.01446560025215149, 0.0017024899134412408, 0.014732657931745052, 0.00012495125702116638, -0.008998345583677292, 0.0002642753825057298, -0.03249196335673332, 0.004610446281731129, -0.002138312440365553, 0.011713427491486073, 0.004825575742870569, 0.031097332015633583, -0.032640330493450165, -0.009287657216191292, -0.0024851160123944283, -0.039020027965307236, -0.020993666723370552, -3.0542352760676295e-05, 0.004569645971059799, 0.0025407529901713133, 0.015036806464195251, -0.019969947636127472, 0.025474293157458305, 0.0008832361781969666, 0.00562303839251399, -0.01126091368496418, 0.023738421499729156, 0.0011016110656782985, -0.011980484239757061, 0.01887204498052597, -0.023293325677514076, 0.014881023205816746, -0.016898788511753082, 0.02706179954111576, -0.013805375434458256, 0.022195423021912575, 0.011030947789549828, -0.034480057656764984, 0.01982158236205578, 0.02777395211160183, 0.026779906824231148, -0.024242863059043884, 0.05370817705988884, 0.020667262375354767, 0.018352767452597618, -0.027284348383545876, 0.026112264022231102, 0.0017933634808287024, 0.02968786284327507, -0.016290491446852684, -0.04824833944439888, -0.011505715548992157, -0.030251650139689445, -0.04658665135502815, -0.03272934630513191, 0.02221026085317135, 0.016765259206295013, -0.003946512471884489, -0.017759306356310844, -0.006576284300535917, 0.013560572639107704, -0.005022159777581692, 0.02381260320544243, -0.03367888554930687, 0.006153443828225136, 0.016216309741139412, -0.04068171977996826, -0.02252182736992836, 0.03278869390487671, -0.019880928099155426, -0.0010023919166997075, 0.006338900420814753, 0.035815343260765076, 0.03525155410170555, -0.017254864796996117, 0.01290034782141447, -0.004725429229438305, 0.03189850226044655, -0.010608106851577759, -0.00887223519384861, 0.017358720302581787, -0.008775797672569752, -0.020548570901155472, -0.014065014198422432, -0.019866090267896652, 0.0065280660055577755, 0.02927244082093239, 0.002507370663806796, 0.0001356150023639202, 0.010667452588677406, -0.04439084604382515, 0.015978924930095673, 0.017967017367482185, -0.0004747684288304299, -0.034034959971904755, -0.013093222863972187, 0.02307077869772911, -0.026156771928071976, -0.04177962243556976, -0.003184286644682288, 0.02108268439769745, 0.005100051406770945, 0.04002891108393669, 0.0011489024618640542, 0.027462385594844818, 0.002633481053635478, 0.018827535212039948, 0.017492249608039856, 0.009651151485741138, -0.006669012829661369, 0.00614231638610363, -0.0011349932756274939, 0.008642269298434258, 0.021438760682940483, 0.0003370670310687274, -0.025236908346414566, 0.04394575208425522, -0.006594830192625523, 0.002312641590833664, 0.006112643517553806, -0.004981359466910362, 0.050088070333004, 0.011565062217414379, -0.004966522566974163, 0.009102201089262962, 0.01897590048611164, 0.00169321708381176, 0.01743290387094021, -0.0193468127399683, 0.0049702320247888565, -0.015474483370780945, 0.006490974687039852, -0.013842467218637466, 0.012306887656450272, 0.021512944251298904, 0.03703193739056587, -0.018649498000741005, -0.03599338233470917, 0.0014317234745249152, -0.03685389831662178, -0.020800791680812836, -0.02876799926161766, 0.002455442911013961, -0.005534019321203232, 0.003063739975914359, -0.014539782889187336, 0.018931390717625618, 0.05480607971549034, 0.02703212760388851, 0.02651284821331501, -0.0049071768298745155, -0.0003876039118040353, 0.025266582146286964, -0.0024888250045478344, -0.035132862627506256, -0.04023662209510803, 0.005014741327613592, -0.035370249301195145, -0.017002644017338753, 0.02412416972219944, 0.03237327188253403, 0.012759401462972164, 0.006375991739332676, -0.005126015283167362, -0.0049702320247888565, -0.013308352790772915, -0.027076637372374535, 0.004870085511356592, 0.018278583884239197, 0.00220878585241735, 0.007737241685390472, -0.0066727218218147755, 0.005441291257739067, -0.010489414446055889, -0.022506991401314735, -0.013152568601071835, 0.009547295980155468, 0.02756624110043049, -0.018174728378653526, 0.03634945675730705, 0.002180967479944229, -0.008916744031012058, -0.0042654974386096, -0.007180872373282909, -0.003516253549605608, -0.0005656420835293829]",Online Speculative Decoding.pdf
"ÔøΩ‚Üê‚àí 1,0
2:foreachùëüinùëÖdo
3: // Initialize the confidence before proposing the first
token for each request
4:ùëü.ùëêùëúùëõùëì =1
5:end for
6:ùëùùëüùëúùëùùëúùë†ùëí _ùë†ùë°ùëíùëùùë†‚Üê0
7:whileùëôùëíùëõ(ùëÖ)>0andùëùùëüùëúùëùùëúùë†ùëí _ùë†ùë°ùëùùëíùë† <=ùëÉdo
8:ùëÖ‚Ä≤={ùëüforùëüinùëÖifùëü.ùëêùëúùëõùëì >ùëá}
9: // Propose will update the ùëêùëúùëõùëì attribute for each
requestùëüinùëÖ‚Ä≤
10:ùëÖ=Propose(ùëÖ‚Ä≤)
11:ùëùùëüùëúùëùùëúùë†ùëí _ùë†ùë°ùëíùëùùë†++
12:end while
13:ArgmaxGoodput( ùëÖ)
14:Score(ùëÖ)
10 Appendix
(a)7B, TP=1.
(b)70B, TP=4.
Figure 17. Confidence distribution.In this section, we explore the utilization of confidence as
a criterion for token acceptance. Confidence is defined as the
output probability of the proposed token generated by the
draft model As depicted in Figure 17, a discernible distinction
exists between the confidence distributions of accepted and
rejected tokens. This distinction intuitively suggests that
tokens proposed by the draft model, when accompanied by
high confidence levels, are likely to be accurate. Conversely,
proposals made with low confidence are less likely to be
accepted by the target model. In practice, we establish a
thresholdùëá. Tokens with a confidence level exceeding ùëáare
predicted to be accepted, while those below this threshold
are anticipated to be rejected.
Initially, SmartSpec sets the confidence level of each re-
quest to 1, adhering to the definition in Section 4.4 where
confidence is treated as a probability and thus cannot exceed
1. This ensures that the draft model will propose at least
one token, activating the procedure described in lines 7-12
at least once, provided that ùëÉ>0. During each proposal
step (lines 7-12), SmartSpec selectively processes only those
requests, denoted as ùëÖ‚Ä≤, whose confidence levels surpass
the specified threshold ùëáfrom the preceding proposal step.
Subsequently, SmartSpec batches these ùëÖ‚Ä≤requests for a for-
ward pass execution. Following the strategy outlined above,
SmartSpec also explores all potential lengths for verification
and opts for the length that maximizes goodput.
16
","[0.03892577067017555, -0.021349744871258736, 0.03850977122783661, -0.012688018381595612, -0.025896036997437477, -0.03026404418051243, -0.01237601786851883, 0.02937261387705803, 0.005400579422712326, 0.040203485637903214, 0.02720346860587597, -0.015674307942390442, -0.06275666505098343, 0.005326293408870697, 0.022374890744686127, -0.007031152956187725, 0.012331446632742882, -0.013839448802173138, -0.020636601373553276, 0.006841724272817373, -0.012093732133507729, 0.03901491314172745, 0.0010205014841631055, 0.014106878079473972, 0.009189155884087086, -0.0462949238717556, 0.0339931920170784, -0.031140616163611412, 0.0474240705370903, -0.02932804264128208, 0.005798008292913437, -0.03613262251019478, -0.010050871409475803, -0.0363406240940094, -0.009211442433297634, 0.04109491780400276, -0.014582307077944279, 0.033696047961711884, 0.015213736332952976, -0.0010622872505337, -0.009233728051185608, 0.012702875770628452, -0.06691666692495346, 0.009293156675994396, 0.01909145712852478, 0.04213491827249527, 0.012145732529461384, -0.0726812481880188, -0.01620916649699211, 0.025019465014338493, -0.04085720330476761, 0.03978748619556427, 0.03524119406938553, 0.029060613363981247, 0.032269760966300964, -0.027292611077427864, 0.01617945171892643, 0.0016185023123398423, 0.009293156675994396, 0.017501739785075188, 0.03054632991552353, -0.024737179279327393, -0.0050811502151191235, 0.03304233402013779, -0.02556918002665043, 0.002772718435153365, -0.03791548311710358, 0.014470878057181835, 0.006072866264730692, 0.04320463538169861, 0.018586313351988792, -0.002674289746209979, 0.03705376759171486, -0.035894908010959625, -0.012116017751395702, -0.012777161784470081, 0.0013204305432736874, 0.034617193043231964, -0.015867451205849648, -0.021557746455073357, -0.010793729685246944, -0.028436612337827682, -0.0019277171231806278, -0.06887781620025635, -0.012925732880830765, -0.05259436368942261, -0.03738062456250191, -0.035924624651670456, -0.040619488805532455, -0.035181764513254166, -0.036637768149375916, 0.038598913699388504, -0.014619450084865093, 0.026505181565880775, -0.0035044336691498756, 0.003030861495062709, 0.03874748572707176, 0.007499153725802898, -0.0092262988910079, 0.01909145712852478, 0.030457187443971634, -0.015585165470838547, -0.015050307847559452, 0.01941831409931183, 0.05948808789253235, 0.014567449688911438, -0.02478175051510334, 0.03562748059630394, -0.007681154180318117, 0.022835461422801018, -0.048909787088632584, 0.005920580122619867, -0.03895548731088638, 0.060854945331811905, -0.00673772394657135, -0.0357760526239872, -0.03744005411863327, 0.001770788338035345, 0.0010725015308707952, 0.0018079312285408378, -0.003690148238092661, -0.047453783452510834, 0.003495147917419672, -0.028986327350139618, -0.008750869892537594, 0.007933725602924824, 0.06465838104486465, -0.062102947384119034, -0.02399432100355625, -0.022805748507380486, -0.004609435331076384, 0.00626600906252861, 0.05699208378791809, 0.017902882769703865, -0.00010324568575015292, -0.04935549944639206, -0.019968029111623764, -0.0016472880961373448, -0.00041832204442471266, 0.01924002729356289, 0.018749741837382317, -0.04935549944639206, -0.034795477986335754, 0.007506582420319319, -0.02656461112201214, -0.01589716598391533, -0.05351550877094269, 0.011165158823132515, -0.07291896641254425, 0.07321611046791077, -0.018289169296622276, -0.015273164957761765, -0.04498749598860741, 0.002601861022412777, 0.016803452745079994, -0.06757038831710815, -0.048761215060949326, 0.04130291938781738, 0.010236586444079876, -0.02542060799896717, -0.03393376246094704, 0.01253201812505722, -0.01770973950624466, -0.016952024772763252, 0.011870874091982841, 0.04938521608710289, 0.0025665750727057457, -0.011766874231398106, -0.0591612309217453, -0.011187445372343063, 0.021840032190084457, -0.013884020037949085, -0.0013845020439475775, -0.03966863080859184, -0.026728039607405663, -0.019507456570863724, -0.06448009610176086, -0.04130291938781738, 0.025717752054333687, -0.03954977169632912, -0.008973727002739906, 0.017234310507774353, 0.013646305538713932, -0.03527090698480606, 0.007822297513484955, -0.01297773327678442, -0.033369190990924835, 0.008580012246966362, 0.03476576507091522, -0.0016547166742384434, 0.029640043154358864, 0.053842365741729736, 0.05366407707333565, -0.019581742584705353, 0.0023288605734705925, -0.05553608015179634, 0.04635435342788696, 0.05226750671863556, 0.0057497224770486355, 0.028600042685866356, -0.019329171627759933, 0.012613732367753983, 0.004468292463570833, -0.005222293548285961, 0.027649182826280594, -0.02715889737010002, 0.012821733020246029, -0.014983450062572956, -0.03960920125246048, -0.027470897883176804, 0.01380973495543003, 0.006574295461177826, 0.037142910063266754, -0.02531660906970501, -0.04614635184407234, 0.01296287588775158, -0.007807440124452114, 0.036845769733190536, 0.029283471405506134, 0.03996577113866806, 0.013014876283705235, -0.005642008036375046, 0.0702446773648262, -0.021453745663166046, -0.016848023980855942, 0.07636582851409912, 0.010080586187541485, -0.029996614903211594, 0.05140579119324684, -0.04284806177020073, -0.008461154997348785, 0.019358886405825615, -0.016788596287369728, -0.06406409293413162, -0.006893724203109741, -0.0167143102735281, 0.025078894570469856, 0.003732862649485469, -0.016432024538517, -0.06186523288488388, -0.014106878079473972, 0.021245745941996574, 0.009731442667543888, 0.017145168036222458, 0.007525153923779726, -0.001747573958709836, -0.035894908010959625, -0.0048211500979959965, 0.0047357212752103806, 0.05821036919951439, 0.03720233961939812, -0.05351550877094269, 0.005330007988959551, 0.003900005714967847, -0.02631203830242157, 0.004702292382717133, 0.0017039310187101364, -0.012546875514090061, -0.021944032981991768, 0.008788012899458408, -0.029357757419347763, -0.01855659857392311, -0.025480037555098534, 0.007398867979645729, -0.017858311533927917, -0.02475203573703766, -0.015674307942390442, -0.01237601786851883, 0.021424030885100365, -0.035360053181648254, -0.0013315733522176743, 0.013973163440823555, 8.342646395931297e-08, 0.018720027059316635, -0.02559889480471611, -0.026653753593564034, -0.01380973495543003, 0.04882064461708069, -0.02158745937049389, 0.03348805010318756, -0.0066114384680986404, -0.0356869101524353, 0.04944464564323425, 0.022345175966620445, 0.048374928534030914, -0.00435686344280839, 0.018437741324305534, -0.02001260034739971, 0.033904049545526505, -0.01093487348407507, 0.040233202278614044, -0.017576025798916817, 0.024648036807775497, -0.047453783452510834, 0.012688018381595612, -0.0269508957862854, 0.025197751820087433, -0.02378632128238678, -0.004457149188965559, -0.015689166262745857, 0.07565268129110336, 0.03556805104017258, 0.009412013925611973, 0.004706006962805986, 0.020384030416607857, -0.010994302108883858, 0.038628626614809036, -0.004780292510986328, 0.0231474619358778, -0.016833167523145676, 0.026787467300891876, 0.01424059271812439, -0.07612811028957367, 0.012569161131978035, -0.023340605199337006, -0.03470633551478386, 0.056516654789447784, -0.0024960036389529705, -0.01998288556933403, 0.0240388922393322, -0.03853948414325714, -0.022137174382805824, 0.0011551445350050926, 0.03295319154858589, 0.04442292079329491, -0.01937374286353588, 0.004156291950494051, 0.014493163675069809, 0.021483460441231728, -0.050187502056360245, 0.025792038068175316, 0.0009777871891856194, 0.03185376152396202, -0.004765435587614775, -0.012487446889281273, -0.03458748012781143, -0.012294303625822067, 0.014730879105627537, 0.01883888430893421, 0.07452353835105896, -0.035538338124752045, -0.03348805010318756, 0.006570580881088972, -0.0004916792968288064, 0.0027244326192885637, 0.010325729846954346, 0.028956614434719086, 0.026624038815498352, 0.09086641669273376, 0.04228349030017853, 0.0030587187502533197, -0.0018070026999339461, 0.05844808742403984, -0.014515450224280357, 0.01809602603316307, -0.018586313351988792, 0.011603445746004581, -0.047334928065538406, -0.021706316620111465, 0.023697176948189735, -0.0196263138204813, 0.027708612382411957, 0.02236003242433071, -0.011239444836974144, 0.0029324328061193228, -0.00031060760375112295, 0.0075214398093521595, -0.02317717671394348, -0.04888007044792175, -0.045136064291000366, -0.043858349323272705, 0.06893724203109741, -0.030962331220507622, -0.0057311514392495155, -0.06828352808952332, 0.009984014555811882, -0.007339439354836941, 0.036845769733190536, 0.015421736985445023, 0.016090309247374535, 0.04647321254014969, -0.030486902222037315, -0.03559776768088341, -0.008416583761572838, 0.013497734442353249, 0.011365731246769428, 0.03550862520933151, -0.040946345776319504, -0.011180016212165356, -0.02741146832704544, -0.0014569306513294578, -0.009077727794647217, 0.012985161505639553, 0.001775431213900447, 0.008067440241575241, 0.04971207305788994, -0.01646173931658268, 0.04391777887940407, 0.03292347863316536, 0.033398907631635666, -0.034082334488630295, -0.014872021973133087, -0.037707485258579254, -0.02322174794971943, -0.037172626703977585, -0.012123445980250835, 0.03232919052243233, 0.009924585931003094, -0.007164867594838142, 0.014775450341403484, 0.026832038536667824, -0.010073157958686352, 0.0392526276409626, -0.03937148675322533, 0.01674402505159378, 0.022270889952778816, 0.05223779007792473, 0.01326001901179552, 0.0005687508382834494, 0.0785052552819252, -0.026965754106640816, -0.005452579353004694, -0.012346304021775723, -0.02709946781396866, -0.024009177461266518, -0.004457149188965559, 0.0585966557264328, -0.016134880483150482, 0.05060350149869919, -0.0856366977095604, -0.001961145782843232, 0.030516617000102997, 0.03274518996477127, -0.02715889737010002, -0.026653753593564034, 0.011640588752925396, 0.04264006391167641, 0.0009281085222028196, -0.001096644438803196, -0.05449607968330383, -0.0254948940128088, -0.017323454841971397, -0.009389728307723999, -0.02332574874162674, -0.03345833346247673, 0.01983431540429592, -0.0057088653557002544, -0.03476576507091522, 0.014158877544105053, -0.003344719298183918, -0.031348615884780884, -0.01888345554471016, 0.026460610330104828, 0.04213491827249527, 0.006797153037041426, -0.057081226259469986, 0.09972129017114639, 0.02524232305586338, 0.04703778401017189, 0.03322061896324158, 0.02186974696815014, 0.019596600905060768, -0.0015683594392612576, 0.024945179000496864, 0.0024384320713579655, 0.007993154227733612, 0.016803452745079994, 0.017873169854283333, -0.0021041459403932095, 0.005772008560597897, -0.004405149258673191, -0.04469035193324089, 0.040441203862428665, 0.003933434374630451, 0.021320031955838203, 0.02236003242433071, 0.07945611327886581, -0.014842307195067406, 0.016016023233532906, -0.029610328376293182, 0.02649032510817051, -0.02883775718510151, 0.035538338124752045, 0.01356459129601717, 0.02983318641781807, 0.07767325639724731, 0.05654636770486832, -0.005983722861856222, -0.03524119406938553, -0.010177157819271088, 0.038093771785497665, -0.03708348423242569, 0.03158633038401604, -0.018942885100841522, 0.015808023512363434, -0.04201606288552284, 0.013839448802173138, 0.019893743097782135, -0.0009991442784667015, -0.0240388922393322, 0.033012621104717255, -0.005716294050216675, -0.033398907631635666, 0.06650067120790482, -0.01027372945100069, 0.01898745633661747, -0.00663000950589776, -0.024766894057393074, -0.008795441128313541, 0.02876347117125988, -0.038598913699388504, -0.04082748666405678, -0.005330007988959551, -0.011388016864657402, -0.021884603425860405, 0.006035723257809877, 0.0011941445991396904, 0.021572602912783623, -0.02588118053972721, -0.02005717158317566, -0.027812611311674118, -0.005857436917722225, -0.007135153282433748, -0.0021227174438536167, 0.012398303486406803, -0.024692608043551445, -0.020101742818951607, -0.07327553629875183, -0.01628345251083374, 0.0033038619440048933, 0.016476595774292946, -0.025123465806245804, -0.0184525977820158, 0.022523460909724236, -0.013802305795252323, 0.03491433709859848, -0.03583548218011856, 0.04145148769021034, -0.0034171477891504765, 0.007146296091377735, -0.01333430502563715, -0.02001260034739971, 0.009820586070418358, -0.006303152069449425, -0.017323454841971397, -0.03039775788784027, 0.03146747499704361, -0.00016923238581512123, -0.0033930048812180758, 0.011863445863127708, 0.006919724401086569, 0.01860116980969906, 0.0024235749151557684, -0.039312057197093964, -0.007491725031286478, 0.010303443297743797, -0.00045755424071103334, 0.02118631638586521, -0.00719086779281497, 0.0017568597104400396, 0.0046614352613687515, 0.0034617192577570677, -0.009984014555811882, -0.019789744168519974, -0.005801722873002291, 0.048048071563243866, 0.030056044459342957, 0.0047468640841543674, 0.004018863197416067, 0.011246873997151852, -0.04174863174557686, -0.004156291950494051, -0.005356007721275091, -0.04590863734483719, 0.012702875770628452, -0.032656047493219376, -0.021646888926625252, -0.03675662353634834, 0.003651148173958063, -0.005118293222039938, 0.0038220055866986513, -0.0016315024113282561, -0.01980460062623024, -0.022300604730844498, -0.017769169062376022, 0.02317717671394348, 0.023192033171653748, -0.003580576740205288, 0.011165158823132515, 0.039520058780908585, -0.006685724016278982, 0.0030401472467929125, -0.0009685014374554157, 0.03316119313240051, -0.03839091211557388, 0.030813759192824364, 0.00025489323888905346, -0.005998580250889063, -0.029803471639752388, -0.00011015194468200207, 0.016045738011598587, -0.0045351493172347546, -0.0016138595528900623, -0.012316589243710041, -0.05514979362487793, 0.01603087969124317, -0.022880032658576965, 0.006466581020504236, 0.009976586326956749, 0.019314313307404518, -0.000614715158008039, -0.004397720564156771, -0.018482312560081482, -0.04365035146474838, -0.042224060744047165, -0.038064055144786835, -0.011685159988701344, -0.022389747202396393, 0.04665149748325348, -0.011618303135037422, -0.005638293921947479, -0.005460008047521114, 0.00517400773242116, 0.012769732624292374, -0.016120024025440216, 0.04320463538169861, 0.010452015325427055, -0.019685743376612663, -0.006277151871472597, 0.023563463240861893, -0.019849171862006187, 0.02687661163508892, -0.005939151626080275, -0.010920016095042229, -0.03907434269785881, 0.019968029111623764, 0.018214883282780647, 0.035746339708566666, -0.016194310039281845, -0.03654862567782402, 0.04409606382250786, 0.008245726116001606, 0.018749741837382317, -0.02712918259203434, -0.01830402761697769, 0.010994302108883858, -0.03497376665472984, -0.0009072156390175223, -0.003287147730588913, -0.0065780095756053925, -0.04373949393630028, -0.019641172140836716, 0.009449156932532787, -0.025331465527415276, 0.008832584135234356, -0.027322325855493546, 0.006908581592142582, -0.003989148885011673, -0.0015646450920030475, -0.012769732624292374, -0.017130311578512192, 0.01724916882812977, -0.012457732111215591, -0.007558582350611687, -0.00578686548396945, 0.05788351222872734, 0.028362326323986053, 0.03437947854399681, 0.00014508949243463576, 0.0023715749848634005, -0.091282419860363, 0.04436349496245384, -0.011766874231398106, -0.002780146896839142, 0.015198878943920135, -0.009701728820800781, -0.05755665525794029, -0.0684618130326271, 0.015674307942390442, 0.04237263277173042, -0.014909164980053902, 0.0014058592496439815, -0.05158407613635063, -0.032804619520902634, 0.004148863255977631, -0.033755477517843246, 0.032982904464006424, 0.019745171070098877, 0.026549752801656723, 0.0019184313714504242, -0.011321159079670906, 0.005961437243968248, 0.033547475934028625, -0.029610328376293182, -0.03423090651631355, 0.01086058747023344, -0.002796861343085766, 0.03791548311710358, 0.0012517161667346954, -0.02585146576166153, -0.04088691622018814, 0.033696047961711884, -0.01883888430893421, -0.02452917955815792, -0.054169222712516785, -0.0028172899037599564, 0.004817435517907143, 0.034646909683942795, 0.028421755880117416, -0.007168581709265709, 0.01681831106543541, 0.022196603938937187, 0.01285144779831171, -0.02307317592203617, 0.004628006834536791, 0.01738288253545761, 0.02151317521929741, 0.03262633457779884, -0.003300147596746683, -0.039490342140197754, 0.000985215767286718, 0.004928864538669586, -0.04644349589943886, 0.016595453023910522, -0.009828014299273491, 0.002616718178614974, -0.018482312560081482, 0.005493436474353075, -0.028748612850904465, -0.005181435961276293, -0.009738871827721596, 0.021290317177772522, -0.003549005137756467, -0.012182874605059624, -0.01486459281295538, 0.00815658364444971, -0.014790307730436325, 0.026430895552039146, -0.02751546911895275, -0.011068587191402912, 0.01429259218275547, -0.03179433196783066, -0.02005717158317566, 0.028065184131264687, 0.02097831666469574, -0.0062845805659890175, -0.014983450062572956, 0.05191093310713768, -0.019032027572393417, 0.0019221457187086344, -0.024113178253173828, 0.015332593582570553, 0.0023734320420771837, 6.743759877281263e-05, 0.01328230556100607, -0.00848344061523676, -0.022657176479697227, -0.0031274331267923117, -0.0363406240940094, 0.01443373505026102, 0.0015052164671942592, 0.00944172777235508, -0.010288586840033531, 0.026178324595093727, 0.005296579096466303, 0.031021758913993835, -0.018972599878907204, 0.011566302739083767, 0.019849171862006187, 0.007239153608679771, -0.0033651478588581085, -0.014716021716594696, 0.014634307473897934, -0.005203722044825554, 0.06739209592342377, -0.007462010718882084, -0.01600116677582264, 0.02136460319161415, -0.01180401723831892, 0.008758298121392727, -0.0012080732267349958, -0.02179546095430851, -0.043501779437065125, 0.007785154040902853, -0.03785605728626251, -0.002588860923424363, 0.0021078602876514196, 0.010214300826191902, 0.007053439039736986, -0.03197261691093445, -0.009270871058106422, 0.009070298634469509, -0.011402874253690243, -0.017680026590824127, -0.0052705793641507626, -0.0035582908894866705, 0.0013650020118802786, -0.14464935660362244, -0.01970059983432293, 0.03182404488325119, 0.018081169575452805, -0.00016934846644289792, -0.027812611311674118, 0.015496022999286652, 0.009464014321565628, -0.005608579609543085, -0.0013826448703184724, 0.014300021342933178, 0.0018534313421696424, 0.01311887614428997, -0.036637768149375916, -0.0017940026009455323, -0.036281194537878036, -0.0017057881923392415, -0.002224860480055213, -0.01635773852467537, -0.0002901789848692715, -0.011016587726771832, -0.010667444206774235, -0.0184525977820158, 0.028392041102051735, -0.02634175308048725, 0.008386868983507156, -0.010154872201383114, 0.0023585748858749866, -0.007049724459648132, 0.005753437057137489, 0.03259661793708801, 0.027396611869335175, 0.0380343422293663, 0.014545164071023464, -0.03527090698480606, 0.0032425762619823217, -0.03316119313240051, -0.013973163440823555, -0.013668591156601906, 0.028065184131264687, 0.04825606942176819, -0.013898877426981926, 0.03310176357626915, 0.00236414629034698, 0.012383447028696537, -0.06560923904180527, -0.0005775722675025463, -0.008275440894067287, -0.01947774365544319, 0.0023734320420771837, -0.008609727025032043, 0.03414176404476166, -0.006236294750124216, -0.01018458604812622, -0.00437172083184123, 0.045106351375579834, 0.020488029345870018, -0.00990230031311512, -0.02059203013777733, 0.012688018381595612, -0.02108231745660305, 0.026728039607405663, 0.04136234521865845, -0.023518892005085945, -0.005263150669634342, -0.015956595540046692, 0.007480582222342491, 0.014032592065632343, -0.03304233402013779, -0.009768585674464703, 0.006288295146077871, -0.013958306051790714, 0.02172117494046688, 0.0045685782097280025, 0.007866868749260902, 0.012702875770628452, -0.029640043154358864, 0.004706006962805986, 0.0016732881776988506, 0.02250860445201397, 0.06180580332875252, -0.025153180584311485, -0.005419150926172733, 0.040797773748636246, -0.0039185769855976105, 0.016045738011598587, 0.00354157667607069, -0.013638877309858799, 0.016758881509304047, -0.0052817221730947495, 0.024232035502791405, -0.02360803447663784, -0.00295471865683794, -0.002809861209243536, -0.035538338124752045, -0.03782634064555168, -0.004082005936652422, 0.0018432169454172254, 0.0013547877315431833, 0.02123088762164116, 0.031200045719742775, 0.048939500004053116, -0.006384866312146187, -0.039906345307826996, -0.018482312560081482, 0.0007586439605802298, 0.014582307077944279, -0.03185376152396202, -0.009137156419456005, 0.0016407881630584598, 0.004650292452424765, -0.01891317032277584, -0.011454873718321323, -0.004639149643480778, 0.0033057192340493202, 0.032091476023197174, 0.054377224296331406, 0.005337436217814684, 0.015704022720456123, -0.012383447028696537, 0.017338311299681664, 0.0234297476708889, 0.011484588496387005, 0.02720346860587597, -0.022196603938937187, 0.0009058227296918631, 0.007120296359062195, 0.035211481153964996, -0.005772008560597897, -0.023845748975872993, 0.009716585278511047, 0.0468594953417778, -0.01860116980969906, -0.027114326134324074, 0.018185170367360115, -0.01004344318062067, 0.041510917246341705, -0.001816288335248828, -0.031734902411699295, 0.0044720065779984, -0.004750578198581934, 0.05093035846948624, 0.015436594374477863, -0.01357944868505001, -0.01607545278966427, -0.01407716330140829, -0.01555545162409544, -0.012710303999483585, 0.006466581020504236, 0.006384866312146187, 0.019581742584705353, -0.028288042172789574, -0.0092262988910079, 0.02097831666469574, -0.04326406493782997, 0.024989750236272812, -0.016981739550828934, -0.016699453815817833, 0.0004099648795090616, 0.010764015838503838, 0.0345577634871006, 0.03928234428167343, 0.018185170367360115, 0.010511443950235844, 0.032864049077034, -0.009969157166779041, -0.004598292522132397, -0.00895887054502964, -0.0016900025075301528, 0.009894872084259987, 0.007658868562430143, -0.0057831513695418835, 0.0012860733550041914, 0.015778308734297752, 0.04073834419250488, 0.03384461998939514, -0.017041167244315147, 0.0023845748510211706, -0.0155405942350626, 0.03538976609706879, 0.013341734185814857, 0.014582307077944279, -0.03328004851937294, -0.01210858952254057, 0.03304233402013779, -0.0451657809317112, 0.009248584508895874, 0.05571436882019043, -0.01217544637620449, 0.008089725859463215, 0.038628626614809036, 0.004743149969726801, -0.020562315359711647, 0.03360690549015999, -0.015510879456996918, -0.0036270052660256624, -0.00636629480868578, 0.02628232352435589, -0.013386305421590805, -0.013884020037949085, -0.030635474249720573, 0.011024015955626965, -0.0339931920170784, 0.01873488537967205, 0.03206175938248634, -0.010407444089651108, -0.003385576419532299, 0.000330804061377421, -0.01781374029815197, 0.0069531528279185295, -0.03185376152396202, 0.01745716854929924, -0.03200233355164528, 0.048196643590927124, -0.02620803751051426, -0.036994338035583496, -1.9804716430371627e-05, 0.005668008234351873, -0.0007191796321421862, 0.00306614744476974, -0.004928864538669586, -0.03530062362551689, 0.008082297630608082, -0.0043680062517523766, 0.007644011173397303, -0.02955090068280697, 0.02634175308048725, 0.019641172140836716, -0.013616591691970825, -0.002629718044772744, -0.002334431977942586, 0.01681831106543541, 0.0023474320769309998, -0.015377165749669075, -0.005396864842623472, -0.018006883561611176, -0.010868015699088573, -0.03527090698480606, -0.007636582478880882, 0.03360690549015999, 0.009776013903319836, 0.04885035753250122, 0.016788596287369728, -0.006942010018974543, 0.0014318592147901654, -0.026757754385471344, 0.008602297864854336, 0.018155455589294434, -0.024009177461266518, -0.01674402505159378, 0.005229721777141094, 0.0357760526239872, 0.01983431540429592, 0.015956595540046692, 0.020176028832793236, -0.012130875140428543, 0.0290160421282053, 0.02475203573703766, 0.013720591552555561, 0.04032234475016594, -0.017160024493932724, -0.004698578268289566, 0.0240388922393322, -0.015302879735827446, 0.008476012386381626, -0.038985200226306915, 0.0269508957862854, 0.0013993592001497746, 0.012086302973330021, -0.015028022229671478, -0.008208583109080791, 0.0096720140427351, -0.01320801954716444, 0.05514979362487793, 0.005110864527523518, -0.0012823590077459812, 0.017947454005479813, -0.03782634064555168, 0.005649436730891466, -0.014121734537184238, -0.037350911647081375, -0.0266686100512743, -0.021379459649324417, -0.01724916882812977, 0.007748011499643326, -0.011685159988701344, -0.006975438911467791, -0.0030958617571741343, 0.00579429417848587, 0.011974874883890152, 0.0708983913064003, 0.03509262204170227, -0.0033725763205438852, 0.01947774365544319, -0.015087450854480267, -0.01070458721369505, 0.009144584648311138, 0.016194310039281845, 0.0196263138204813, -0.020918887108564377, 0.021483460441231728, 0.007428582292050123, -0.013757734559476376, -0.005838865879923105, 0.013237733393907547, 0.024558892473578453, 0.022701747715473175, -0.030100615695118904, -0.0063254376873373985, -0.02539089508354664, 0.014196020551025867, 0.01333430502563715, 0.008260583505034447, 0.005456293933093548, -0.0016909310361370444, -0.015154307708144188, -0.01276230439543724, 0.0131931621581316, 0.03152690455317497, 0.01466402132064104, -0.031200045719742775, 0.015808023512363434, -0.016729166731238365, 0.030635474249720573, -0.01891317032277584, 0.009144584648311138, -0.0019072885625064373, -0.03414176404476166, -0.018289169296622276, 0.037172626703977585, -0.007536296732723713, 0.02506403625011444, 0.01661030948162079, 0.019596600905060768, -0.014886879362165928, -0.010377729311585426, -0.03883662819862366, -0.01061544381082058, -0.020220601931214333, -0.05984465777873993, 0.01429259218275547, -0.0011932160705327988, -0.018363455310463905, 0.012064017355442047, -0.01288858987390995, 0.022850319743156433, 0.015570308081805706, -0.017219454050064087, -0.008921727538108826, -0.03449833765625954, 0.07690068334341049, -0.00247186073102057, -0.024454893544316292, -0.0015367879532277584, 0.012234875001013279, 0.0115737309679389, -0.002713289577513933, -0.020205743610858917, -0.02858518436551094, 0.0010065728565678, -0.01555545162409544, 0.009144584648311138, 0.0048211500979959965, 0.03316119313240051, -0.01866059936583042, -0.02797604165971279, -0.008810298517346382, -0.020740602165460587, -0.0065668667666614056, 0.0092262988910079, 0.017605740576982498, 0.0012702875537797809, -0.014493163675069809, -0.0004935364122502506, -0.0060245804488658905, -0.004171148873865604, 0.00872858427464962, -0.014106878079473972, 0.027069753035902977, 0.038093771785497665, -0.0045277210883796215, -0.001131001627072692, -0.05173264816403389, 0.004758006893098354, 0.0005812865565530956, -0.007852011360228062, -0.028540613129734993, 0.041837774217128754, -0.0029732901602983475, -0.03776691108942032, -0.01980460062623024, -0.021736031398177147, 0.03586519509553909, 0.021929174661636353, 0.012472589500248432, -0.005809151567518711, 0.012554303742945194, 0.019299456849694252, 0.021958889439702034, -0.033012621104717255, 0.0398172028362751, 0.0024830035399645567, -0.004319720435887575, -0.005846294108778238, 0.012717733159661293, -0.003922291565686464, 0.02200346067547798, 0.0046948641538619995, 0.031556617468595505, -0.013557163067162037, -0.03274518996477127, -0.009449156932532787, -0.005036578979343176, -0.00553800817579031, 0.0017429310828447342, -0.040262915194034576, 0.009538299404084682, 0.014886879362165928, -0.024826321750879288, 0.04896921291947365, -0.015510879456996918, -0.0046540070325136185, -0.00718343909829855, -0.03170518949627876, 0.029521185904741287, -0.01333430502563715, 0.006384866312146187, 0.0028080041520297527, 0.021706316620111465, 0.0269508957862854, 0.0005088578909635544, -0.0003210540453437716, -0.03224004805088043, 0.0018200026825070381, 0.017397738993167877, -0.002464432269334793, 0.04174863174557686, 0.015146879479289055, -0.005237150471657515, 0.01427773479372263, -0.023741748183965683, -0.010548586957156658, 0.02005717158317566, -0.01130630262196064, -0.00917429942637682, -0.019938314333558083, 0.008401726372539997, -0.01802174001932144, -0.029357757419347763, -0.006299437955021858, 0.004438578151166439, -0.02968461439013481, 0.0012842161813750863, 0.01926974207162857, -0.024692608043551445, 0.013594306074082851, -0.025836609303951263, -0.03185376152396202, 0.015763452276587486, 0.012896019034087658, 0.0020131457131356, -0.006537152454257011, 0.020636601373553276, -0.020280029624700546, -0.031229760497808456, 0.029877757653594017, 0.0007563225226476789, 0.04376920685172081, -0.02189945988357067, -0.02958061546087265, 0.04397720843553543, 0.02840689942240715, -0.004832292906939983, 0.0022267175372689962, -0.01253201812505722, 0.038064055144786835, 0.005593722686171532, 0.010526301339268684, -0.017516596242785454, -0.012777161784470081, 0.0068602957762777805, 0.02243431843817234, -0.01702631078660488, 0.02158745937049389, -0.00033521477598696947, 0.016164595261216164, 0.004104291554540396, -0.01702631078660488, -0.026965754106640816, 0.009612585417926311, -0.02506403625011444, -0.012435446493327618, -0.02802061289548874, -0.028629755601286888, 0.007034867536276579, 0.008364583365619183, -0.01646173931658268, -0.0033094333484768867, -0.003229576162993908, 0.02513832226395607, 0.0037532912101596594, -0.01564459502696991, 0.030843473970890045, 0.007517725229263306, -0.006971724331378937, -0.022137174382805824, 0.027010325342416763, 0.006210295017808676, 0.028704041615128517, 0.0027077181730419397, 0.027827469632029533, -4.207595338812098e-05, -0.01707088202238083, 0.013312019407749176, 0.039490342140197754, -0.014426306821405888, -0.015406879596412182, 0.026014896109700203, 0.026861753314733505, 0.010593158192932606, 0.009724014438688755, -4.825676660402678e-05, 0.02421717904508114, 0.0051962933503091335, -0.010778873227536678, -0.015496022999286652, -0.012294303625822067, 0.023028604686260223, 0.004193434491753578, 0.04145148769021034, -0.015570308081805706, -0.008030297234654427, 0.03856920078396797, 0.030843473970890045, -0.002308432012796402, -0.0005162864690646529, 0.015258308500051498, -0.014604592695832253, -0.0257771797478199, 0.030486902222037315, -0.0049028643406927586, -0.005682865623384714, -0.015139450319111347, -0.023444605991244316, 0.029075471684336662, 0.04189720377326012, -0.006930867210030556, -0.01262116152793169, 0.006262294948101044, 0.01047430094331503, -0.013126305304467678, -0.020770316943526268, 0.01784345507621765, -0.011454873718321323, 0.00531515059992671, 0.012257160618901253, -0.025480037555098534, -0.03865834325551987, -0.0049028643406927586, 0.0025405751075595617, 0.03295319154858589, 0.017130311578512192, 0.01276230439543724, -0.007644011173397303, 0.03601376712322235, -0.040441203862428665, 0.00871372688561678, -0.019968029111623764, 0.0017661454621702433, -0.013096590526401997, -0.01239087525755167, -0.0038702914025634527, 0.02485603652894497, -0.008082297630608082, -0.0061582946218550205, -0.003036433132365346, 0.009278299286961555, 0.007837153971195221, 0.011068587191402912, 0.013624019920825958, 0.020785173401236534, -0.007536296732723713, -0.015302879735827446, 0.022672032937407494, 0.048196643590927124, -0.02276117540895939, -0.003255576128140092, 0.018779456615447998, 0.02958061546087265, -0.0027095754630863667, -0.06305380910634995, -0.01724916882812977, 0.0011254302226006985, 0.012101160362362862, 0.010816016234457493, 0.02787204086780548, -0.03206175938248634, 0.017412597313523293, -0.027797754853963852, 0.004193434491753578, -0.0022471460979431868, 0.00035308979568071663, -0.03366633504629135, -0.033369190990924835, -0.009404584765434265, -0.017680026590824127, -0.0123017318546772, -0.0017317882739007473, 0.03984691575169563, 0.013468019664287567, -0.004252863582223654, -0.025688037276268005, 0.01356459129601717, -0.0018571455730125308, -0.00022552711016032845, 0.0009731442551128566, -0.014418878592550755, -0.0108457300812006, -0.0025424323976039886, -0.028169184923171997, -0.01916574314236641, 0.011566302739083767, -0.0035880052018910646, -0.003313147695735097, -0.0010372158139944077, 0.03253719210624695, 0.022672032937407494, -0.01384687703102827, -0.009924585931003094, -0.01320801954716444, 0.0092262988910079, -0.02656461112201214, -0.00589457992464304, 0.022315461188554764, 0.000612393778283149, 0.014716021716594696, -0.01579316519200802, -0.0011922874255105853, 0.02751546911895275, -0.00027532182866707444, 0.041867490857839584, -0.007603154052048922, 0.008966298773884773, -0.013586876913905144, 0.029030900448560715, 0.0058982945047318935, 0.03524119406938553, -0.028213756158947945, -0.0040262914262712, 0.01260630413889885, 0.018185170367360115, -0.008245726116001606, 0.00022715212253388017, -0.02218174748122692, 0.022627461701631546, 0.03669719770550728, -0.013616591691970825, 0.029536042362451553, 0.04650292545557022, -0.009077727794647217, 0.009018299169838428, 0.000601715175434947, -0.0025610036682337523, -0.011700017377734184, -0.010994302108883858, 0.007644011173397303, -0.0035861481446772814, -0.026921182870864868, -0.04543320834636688, 0.02833261340856552, -0.02815432660281658, -0.001342716277576983, 0.0082160122692585, -0.03800462558865547, 0.04142177477478981, -0.007970868609845638, -0.003313147695735097, 0.006013437174260616, -0.0046614352613687515, -0.040411487221717834, 0.012970305047929287, 0.013371448032557964, 0.0055417222902178764, -0.0139211630448699, 0.02562860958278179, -0.0025572895538061857, -0.004312292207032442, 0.03158633038401604, 0.0008440726669505239, -0.016684595495462418, 0.000993572873994708, 0.005237150471657515, -0.019180599600076675, -0.011276587843894958, 0.006340295076370239, 0.01941831409931183, -0.007101724855601788, 0.0045277210883796215, -0.014017734676599503, 0.01585259474813938, 0.02421717904508114, 0.028986327350139618, 0.03598405420780182, -0.05069264397025108, -0.01416630670428276, 0.01666973903775215, 0.018586313351988792, -0.0029417185578495264, -0.035924624651670456, -0.024974893778562546, -0.01681831106543541, -0.03396347910165787, 0.027574896812438965, 0.0012071445817127824, 0.015273164957761765, 0.011209730990231037, -0.007242867723107338, -0.016268596053123474, 0.009360013529658318, -0.007566011045128107, -0.0006374652148224413, 0.0269508957862854, -0.0023140034172683954, 0.006514866836369038, 0.016090309247374535, 0.006559438072144985, -0.032477762550115585, -0.011313730850815773, -0.005935437045991421, 0.007283724844455719, 0.033755477517843246, -0.012331446632742882, 0.02620803751051426, -0.012806875631213188, 0.01674402505159378, 0.010244014672935009, -0.0034617192577570677, 0.0035471480805426836, -0.0034672908950597048]",Online Speculative Decoding.pdf
