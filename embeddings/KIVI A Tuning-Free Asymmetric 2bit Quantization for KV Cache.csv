text,embedding,file
"KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
Zirui Liu* 1Jiayi Yuan* 1Hongye Jin2Shaochen Zhong1
Zhaozhuo Xu3Vladimir Braverman1Beidi Chen4Xia Hu1
Abstract
Efficiently serving large language models (LLMs)
requires batching many requests together to re-
duce the cost per request. Yet, the key-value (KV)
cache, which stores attention keys and values
to avoid re-computations, significantly increases
memory demands and becomes the new bottle-
neck in speed and memory usage. This mem-
ory demand increases with larger batch sizes and
longer context lengths. Additionally, the infer-
ence speed is limited by the size of KV cache,
as the GPU’s SRAM must load the entire KV
cache from the main GPU memory for each to-
ken generated, causing the computational core
to be idle during this process. A straightforward
and effective solution to reduce KV cache size
is quantization, which decreases the total bytes
taken by KV cache. However, there is a lack of
in-depth studies that explore the element distri-
bution of KV cache to understand the hardness
and limitation of KV cache quantization. To fill
the gap, we conducted a comprehensive study on
the element distribution in KV cache of popular
LLMs. Our findings indicate that the key cache
should be quantized per-channel, i.e., group el-
ements along the channel dimension and quan-
tize them together. In contrast, the value cache
should be quantized per-token. From this anal-
ysis, we developed a tuning-free 2bit KV cache
quantization algorithm, named KIVI . With the
hardware-friendly implementation, KIVI can en-
able Llama (Llama-2), Falcon, and Mistral mod-
els to maintain almost the same quality while us-
ing2.6×less peak memory usage (including the
model weight). This reduction in memory us-
age enables up to 4×larger batch size, bringing
*Equal contribution. The order of authors is determined by
flipping a coin.1Department of Computer Science, Rice Uni-
versity2Department of Computer Science, Texas A&M Uni-
versity3Department of Computer Science, Stevens Institute of
Technology4Department of Electrical and Computer Engineer-
ing, Carnegie Mellon University. Correspondence to: Zirui Liu
<zl105@rice.edu>, Jiayi Yuan <jy101@rice.edu>.
Preliminary work.2.35× ∼3.47×throughput on real LLM infer-
ence workload. The source code is available at
https://github.com/jy-yuan/KIVI .
1. Introduction
Large Language Models (LLMs) have demonstrated strong
performance across a wide range of tasks (Brown et al.,
2020; Yuan et al., 2023; Chuang et al., 2023). However,
their deployment is very costly, requiring a large number of
hardware accelerators such as GPUs. Given these substan-
tial costs, one natural way to reduce the cost per request is to
combine a sufficient number of requests together for batch
processing. However, in this batch inference scenario, the
key-value cache (KV cache), which holds the attention keys
and values during generation to prevent re-computations, is
becoming the new memory and speed bottleneck. This bot-
tleneck becomes more pronounced with larger batch sizes
and longer context lengths. For instance, in 540B PaLM,
with a batch size of 512 and a context length of 2048, KV
cache alone can take 3TB. This is 3 times the size of the
model’s parameters (Pope et al., 2023). Also, the GPU
SRAM has to load the whole KV cache from the GPU de-
vice memory for every token generated, during which the
computational cores are idle. Thus, reducing KV cache size
in LLMs while maintaining accuracy is important.
Existing works towards this problem can be roughly divided
into three categories. First, some work suggests reducing
the number of heads in KV cache, such as multi-query
attention (Shazeer, 2019) and multi-group attention (Ainslie
et al., 2023). However, these methods require either training
the model from scratch or fine-tuning the existing model.
Second, another research line reduces KV cache size by
evicting unimportant tokens (Zhang et al., 2023). Third,
some other works try to solve this problem from the system
perspective, e.g., offloading KV cache (Sheng et al., 202","[-0.007291312795132399, 0.01756942830979824, 0.030462685972452164, -0.002556013874709606, -0.005355296656489372, 0.007940029725432396, 0.0019039178732782602, 0.029435548931360245, -0.05654652789235115, 0.027232613414525986, 0.014244752004742622, 0.014177177101373672, -0.049383606761693954, 0.03730124607682228, -0.0005114561645314097, -0.005875622387975454, 0.015528671443462372, -0.02025890164077282, -0.03178714960813522, 0.004993772134184837, -0.01838032528758049, -0.01717749424278736, 0.01992102898657322, 0.016420656815171242, 0.04276128485798836, -0.045112885534763336, -0.010420022532343864, -0.006041180342435837, 0.03276022523641586, -0.07833261787891388, 0.04230177775025368, -0.029813967645168304, -0.0634121224284172, -0.06162814795970917, -0.027408307418227196, 0.06492579728364944, 0.00920367706567049, -0.006304721813648939, -0.02092113345861435, 0.01043353695422411, 0.025827059522271156, -0.03932848945260048, -0.0396798774600029, 0.02106979861855507, 0.028813861310482025, 0.06108754873275757, 0.006953439209610224, -0.0077440631575882435, -0.0866578221321106, 0.026462262496352196, -0.012839197181165218, 0.030192386358976364, -0.05351918190717697, -0.02223208360373974, 0.013481156900525093, -0.013244645670056343, 0.03530103713274002, -0.003973393701016903, 0.03922037035226822, 0.0212590079754591, 0.01050111185759306, -0.06281746178865433, -0.001027980470098555, 0.02265104651451111, -0.030327536165714264, 0.0032554122153669596, -0.0066257016733288765, -0.013906878419220448, -0.013744698837399483, -0.011940453201532364, -0.02113737352192402, 0.02202935889363289, 0.025570275261998177, -0.01021054107695818, -0.006916272919625044, 0.006879106629639864, -0.01662338152527809, 0.0400853268802166, 0.031408730894327164, 0.007554854266345501, 0.023691697046160698, -0.001658959430642426, 0.046248141676187515, -0.025881119072437286, 0.014650199562311172, -0.03203041851520538, -0.03773372620344162, 0.02108331397175789, -0.028840892016887665, -0.015609760768711567, -0.024894528090953827, 0.030138326808810234, -0.045572392642498016, 0.00515933008864522, 0.05605999007821083, 0.025124281644821167, 0.05268125236034393, -0.03822026401758194, 0.03689580038189888, 0.02277268096804619, 0.012068845331668854, 0.0033584637567400932, 0.04970796778798103, -0.0331927053630352, 0.04530209302902222, -0.01838032528758049, -0.0074737644754350185, 0.023813331499695778, 0.005223526153713465, -0.0025881119072437286, -0.04389654099941254, 0.01081871334463358, -0.046491410583257675, -0.0036422775592654943, -0.03619302064180374, -0.05224877595901489, -0.06146596744656563, -0.00015774474013596773, -0.028165144845843315, 0.003605111502110958, -0.011372826062142849, -0.00015426042955368757, 0.0422477163374424, -0.01975884847342968, 0.015528671443462372, -0.039544727653265, 0.02081301435828209, -0.048410531133413315, -0.01700180023908615, -0.02021835744380951, 0.04046374559402466, 0.012291842140257359, 0.05468146502971649, 0.014596140012145042, -0.022840255871415138, -0.03327379375696182, -0.01986696943640709, 0.03622005134820938, -0.03889600932598114, -0.014488020911812782, 0.010041603818535805, -0.03478746861219406, 0.005081619136035442, 0.01766403205692768, -0.02151579223573208, -0.002510400954633951, -0.02094816416501999, 0.023205159232020378, -0.00540259899571538, 0.014123117551207542, -0.003821350634098053, -0.027502913028001785, -0.012014785781502724, -0.014879954047501087, -0.03822026401758194, -0.00840629544109106, 0.002632035408169031, 0.01604223996400833, 0.01811002567410469, -0.03803105279803276, 0.004902546294033527, 0.01725858449935913, 0.046329230070114136, -0.01601520925760269, 0.028840892016887665, 0.013758213259279728, -0.0861172303557396, -0.003034105058759451, -0.05316779389977455, -0.05473552644252777, -0.0018076238920912147, -0.030678924173116684, 0.002321191830560565, -0.03743639588356018, 0.013501429930329323, -0.011163344606757164, -0.03619302064180374, 0.0077170333825051785, -0.01002133172005415, -0.02143470197916031, -0.0434640608727932, 0.06352023780345917, -0.012852712534368038, 0.044869616627693176, -0.028624651953577995, 0.009602367877960205, 0.01766403205692768, 0.012629715725779533, -0.029489608481526375, 0.0354902446269989, -0.030597833916544914, 0.01006187591701746, 0.06162814795970917, 0.04276128485798836, 0.03567945212125778, -0.01105522457510233, 0.015096193179488182, 0.003861895529553294, -0.013460884802043438, -0.03357112407684326, -0.004091649316251278, 0.022624017670750618, 0.03308458626270294, -0.09233409911394119, 0.025691909715533257, -0.024367446079850197, -0.010710593312978745, 0.022732136771082878, -0.04370732977986336, -0.01979939453303814, -0.007798123173415661, 0.05892515927553177, 0.05005935579538345, 0.01006863359361887, 0.005149194039404392, 0.016123328357934952, -0.027840785682201385, 0.031111402437090874, -0.0196372140198946, 0.0406259223818779, 0.024353930726647377, -0.00473360950127244, 0.01765051856637001, 0.01606926880776882, -0.03867977112531662, 0.01797487586736679, -0.003439553314819932, -0.026205478236079216, 0.031381700187921524, -0.013312220573425293, 0.048005081713199615, 0.0049228183925151825, -0.024110661819577217, -0.02009672299027443, 0.0004003802314400673, -0.050735101103782654, -0.008919863030314445, -0.005426250398159027, -0.027529941871762276, -0.06135784834623337, 0.004155845381319523, -0.015069163404405117, -0.02039405144751072, -0.010156480595469475, -0.03316567465662956, 0.032111506909132004, -0.05438413843512535, -0.05308670178055763, 0.05332997068762779, -0.009798334911465645, -0.03640926256775856, -0.007912999950349331, -0.07033177465200424, -0.008568475022912025, -0.047167155891656876, -0.028138114139437675, 0.028029995039105415, 0.007825152948498726, 0.02101573906838894, 0.01858304813504219, -0.015555701218545437, -0.031111402437090874, -0.0158530306071043, -0.01073762308806181, -0.026692016050219536, -0.013751456514000893, -0.02147524617612362, 0.01765051856637001, -0.03438201919198036, -0.02136712707579136, 0.02073192596435547, -0.04300455376505852, 0.006186465732753277, -0.025543244555592537, 0.0206508357077837, 0.013318978250026703, 0.02178608998656273, -0.00841981079429388, 0.009068528190255165, 0.026570381596684456, -0.011926938779652119, 0.0011090701445937157, 0.06211468577384949, -0.014825894497334957, 0.008379265666007996, -0.00015067051572259516, 0.00510527053847909, -0.009683458134531975, -0.0024360688403248787, -0.02075895480811596, 0.0450858548283577, 0.001033893320709467, -0.015825999900698662, -0.01573139615356922, 0.004889031406491995, 0.0383283831179142, -0.03335488215088844, -0.01662338152527809, 0.004220041446387768, 0.007480521686375141, 0.044680405408144, 0.03378736227750778, 0.013798758387565613, -0.014528565108776093, -0.028894951567053795, 0.03194933012127876, 0.01763700321316719, 0.00971724558621645, -0.031219521537423134, 0.03689580038189888, 0.026286566630005836, -0.012116148136556149, 0.0021759059745818377, 0.03878789022564888, -0.049626875668764114, -0.04970796778798103, -0.000924084335565567, -0.025448640808463097, 0.06006041541695595, -0.005851970985531807, 0.0352199450135231, -0.0671963021159172, -0.01994805783033371, -0.01110928412526846, 0.026881225407123566, -0.015528671443462372, -0.007034528534859419, -0.0046221110969781876, -0.030760014429688454, -0.028111085295677185, 0.028597623109817505, 0.026516322046518326, 0.023110555484890938, -0.02097519487142563, -0.03989611566066742, -0.027381278574466705, -0.025151312351226807, 0.006108754780143499, 0.03362518176436424, -0.023759271949529648, -0.07216980308294296, 0.028435442596673965, 0.010055119171738625, 0.005054589360952377, -0.0032097992952913046, 0.03824729472398758, 0.046167049556970596, 0.01709640584886074, 0.05032965540885925, -0.026273053139448166, 0.011170101352036, -0.02032647654414177, 0.030219417065382004, -0.06768283993005753, 0.04240989685058594, 0.026867710053920746, 0.029462579637765884, -0.0413016714155674, -0.01854250393807888, -0.009784819558262825, 0.003397319233044982, 0.014298811554908752, 0.03478746861219406, 0.0037030947860330343, -0.003500370541587472, -0.013751456514000893, -0.02140767313539982, 0.003757154569029808, 0.007899485528469086, 0.002170837949961424, 0.024597199633717537, 0.005946575663983822, -0.026273053139448166, -0.04149087890982628, -0.01870468258857727, -0.02023187279701233, 0.045599423348903656, 0.05430304631590843, 0.01578545570373535, 0.0048383502289652824, 0.05511394515633583, 0.0065378546714782715, 0.006912894081324339, 0.02224559895694256, 0.048356473445892334, 0.0022485489025712013, 0.014798864722251892, 0.0031878375448286533, -0.08984734863042831, -0.0015685783000662923, -0.04235583543777466, 0.03181418031454086, 0.00872389692813158, 0.0326521061360836, 0.0381932333111763, 0.02096167951822281, 0.017204524949193, 0.023691697046160698, 0.03722015768289566, 0.04108543321490288, 0.0039227125234901905, 0.007548096589744091, -0.0371120385825634, 0.00829141866415739, 0.025259431451559067, -0.004155845381319523, 0.0399501770734787, 0.01796136051416397, 0.026367656886577606, -0.02092113345861435, 0.03135467320680618, -0.04284237325191498, 0.028462473303079605, -0.04219365864992142, 0.014528565108776093, -0.01969127357006073, 0.0007184037822298706, 0.024867497384548187, 0.030138326808810234, 0.05649247020483017, -0.006966954097151756, -0.006230389699339867, -0.04057186469435692, -0.05508691444993019, 0.01862359419465065, 0.028246235102415085, -0.01616387441754341, -0.05243798345327377, 0.010298388078808784, -0.06870997697114944, -0.06027665361762047, -0.013535217382013798, 0.014893469400703907, -0.01856953464448452, -0.022975405678153038, -0.02211044915020466, -0.04095028340816498, 0.028651682659983635, 0.009622640907764435, -0.0653042122721672, -0.025448640808463097, -0.01129849348217249, -0.03597678244113922, -0.004405871964991093, -0.00958209577947855, 0.03559836372733116, -0.024367446079850197, 0.012737835757434368, 0.06898027658462524, -0.046004872769117355, 0.01802893541753292, 0.0096496706828475, 0.05611405149102211, 0.01748833805322647, 0.03911225125193596, -0.06568262726068497, 0.08622534573078156, -0.023042980581521988, 0.025097252801060677, -0.008250873535871506, 0.03581460192799568, 0.04168009012937546, -0.01625847816467285, -0.008122481405735016, 0.03527400642633438, 0.009852394461631775, 0.029030101373791695, 0.01717749424278736, 0.014258266426622868, -0.006764229852706194, 0.003056066809222102, -0.0406259223818779, -0.012021543458104134, 0.0035172642674297094, -0.049518756568431854, -0.028543563559651375, 0.01685313507914543, -0.03578757494688034, -0.013947422616183758, -0.010771410539746284, 0.00915637519210577, -0.028624651953577995, 0.022880801931023598, 0.008271146565675735, -0.0021607016678899527, 0.04073404148221016, 0.047004979103803635, 0.003231761045753956, 0.0190290417522192, 0.008440082892775536, -0.03905818983912468, -0.012616200372576714, 0.04424792900681496, -0.014825894497334957, 0.008804986253380775, 0.026813650503754616, -0.008007604628801346, -0.006544611882418394, 0.025516215711832047, -0.029408520087599754, 0.028192173689603806, 0.011203888803720474, 0.03286834433674812, 0.02002914808690548, -0.01973181962966919, 0.03932848945260048, 0.045761603862047195, -0.02197529934346676, 0.0014275159919634461, 0.049356576055288315, 0.015258372761309147, 0.0021843528375029564, -0.005946575663983822, 0.024178236722946167, -0.00048146990593522787, 0.027705635875463486, 0.0008358148625120521, 0.0182857196778059, -0.007784608285874128, 0.02090761996805668, -0.009352341294288635, -0.01927231065928936, 0.0001374723215121776, -0.01974533498287201, 0.010284872725605965, -0.0010288251796737313, -0.048978161066770554, -0.11341741681098938, -0.014893469400703907, -0.03135467320680618, 0.028084054589271545, -0.03586866334080696, -0.02044811099767685, 0.01665041223168373, -0.01750185340642929, -0.014488020911812782, 0.006872349418699741, -0.03713906928896904, -0.013406825251877308, 0.01650174707174301, 0.013697396032512188, 0.0058316984213888645, 0.006014150567352772, 0.04257207736372948, -0.015474611893296242, -0.0076832459308207035, 0.023745758458971977, -0.05092431232333183, -0.007196708116680384, 0.02084004506468773, 0.02084004506468773, -0.03246289864182472, -0.0030391730833798647, -0.01775863766670227, 0.008379265666007996, -0.005966848228126764, 0.013785243965685368, 0.029219310730695724, -0.0325169563293457, 0.008392781019210815, 0.04073404148221016, 0.0010178443044424057, 0.0020965058356523514, -0.00553099112585187, -0.03705797716975212, -0.026421716436743736, 0.022867286577820778, -0.03159794211387634, -0.008433325216174126, 0.03405766189098358, -0.027611032128334045, -0.0338684506714344, 0.012798652984201908, -0.031543880701065063, 0.02144821733236313, -0.0034311064518988132, 0.00457480875775218, -0.0011073807254433632, 0.025610819458961487, 0.03330082446336746, -0.031300611793994904, -0.0077170333825051785, -0.008122481405735016, -0.025786513462662697, -0.0380580835044384, 0.011649882420897484, -0.002968219807371497, 0.012589170597493649, -0.04230177775025368, 0.012109390459954739, 0.02204287424683571, -0.01951557956635952, 0.0049532270058989525, -0.0035544303245842457, -0.01892092265188694, 0.005149194039404392, 0.028840892016887665, -0.030597833916544914, -0.03497667610645294, -0.0016547359991818666, 0.02012375183403492, 0.01833977922797203, -0.004993772134184837, -0.015866544097661972, -0.01566382125020027, 0.04376139119267464, -0.023475458845496178, -0.0007543028332293034, 0.0200426634401083, -0.01856953464448452, -0.006101997569203377, -0.014744804240763187, 0.006199980620294809, -0.022907830774784088, -0.047491516917943954, -0.031381700187921524, -0.012994619086384773, -0.05995229259133339, 0.02013726718723774, -0.02035350725054741, 0.0314357616007328, -0.03686876967549324, 0.006966954097151756, -0.0009916590061038733, 0.003214867552742362, 0.027732666581869125, -0.030354565009474754, -0.047275274991989136, -0.03451716899871826, -0.00507486192509532, -0.0417071208357811, -0.0049768784083426, -0.007054801099002361, 0.005480309948325157, 0.0017147086327895522, 0.004679549485445023, 0.02052920125424862, -0.0051964963786304, 0.012575656175613403, 0.004345054738223553, 0.04430198669433594, 0.004247071221470833, 0.007075073663145304, -0.0413016714155674, 0.02119143307209015, -0.01823166012763977, -0.004872137680649757, 0.026029784232378006, 0.005868864711374044, -0.01863710954785347, -0.022691592574119568, -0.050599951297044754, 0.045977842062711716, 0.02174554578959942, 0.01928582601249218, 0.002250238321721554, 0.0013261539861559868, -0.01931285671889782, 0.0067777447402477264, 0.008014362305402756, -0.048383500427007675, -0.02192123979330063, -0.03419281169772148, -0.0033871829509735107, 0.011163344606757164, 0.03959878906607628, 0.01919122226536274, 0.001954598817974329, -0.0038145931903272867, 0.011555277742445469, 0.007602156139910221, 0.009609125554561615, 0.03540915623307228, 0.005118785426020622, -0.01578545570373535, 0.024097146466374397, -0.007365644909441471, 0.0012864538002759218, -0.03786887601017952, 0.01709640584886074, -0.04308564215898514, 0.01798839122056961, -0.05514097586274147, -0.0375174880027771, -0.0011479256208986044, -0.00915637519210577, 0.024124175310134888, -0.00462886830791831, -0.004419386852532625, -0.026597410440444946, -0.001060923095792532, -0.00016777536075096577, -0.01988048292696476, -0.04397762939333916, -0.011555277742445469, 0.03594975173473358, -0.006321615539491177, 0.0400853268802166, -0.009987544268369675, -0.05595187097787857, -0.006064831279218197, 0.022759167477488518, -0.048113204538822174, 0.006041180342435837, -0.01628550887107849, -0.028976041823625565, -0.02044811099767685, 0.013082466088235378, 0.05422195792198181, -0.013785243965685368, 0.0020998844411224127, -0.009615883231163025, 0.007460249587893486, 0.010920075699687004, -0.02086707390844822, 0.005223526153713465, -0.008433325216174126, 0.01956963911652565, 0.011906665749847889, -0.01894795149564743, -0.04011235386133194, 0.02181312069296837, -0.01901552639901638, -0.029813967645168304, 0.004500476643443108, 0.007554854266345501, -0.014001482166349888, 0.025232400745153427, 0.026800135150551796, 0.027421822771430016, 0.007831910625100136, 0.030003177002072334, 0.03540915623307228, -0.0018735091434791684, -0.00447682524099946, -0.0014537011738866568, -0.046221110969781876, -0.02154282107949257, -0.032246656715869904, -0.004723472986370325, -0.03592272102832794, -0.025921663269400597, 0.02069137990474701, 0.04078810289502144, 0.011920181103050709, -0.009615883231163025, 0.007676488719880581, 0.0033838043455034494, 0.012413476593792439, -0.029868027195334435, -0.02074543945491314, 0.012812167406082153, 0.005990499164909124, 0.026164932176470757, 0.025543244555592537, -0.03327379375696182, 0.022569958120584488, -0.01816408522427082, -0.015069163404405117, -0.009622640907764435, 0.005726957693696022, -0.003189526963979006, -0.002806040458381176, 0.027556972578167915, 0.01739373430609703, -0.022691592574119568, -0.024813437834382057, -0.031543880701065063, 0.01846141368150711, -0.00484848627820611, -0.0007758422871120274, -0.025448640808463097, -0.02082652971148491, 0.0411665216088295, 0.013454127125442028, -0.047815874218940735, 0.028381383046507835, 0.003120262874290347, 0.010237570852041245, 0.03573351353406906, 0.02012375183403492, -0.01662338152527809, -0.0038585166912525892, -0.05578969046473503, 0.0010803508339449763, -0.02150227688252926, 0.0014537011738866568, -0.011818818747997284, -0.01682610623538494, -0.028273263946175575, -0.026881225407123566, -0.01658283732831478, -0.006352024152874947, 0.0030543773900717497, -0.0035206431057304144, 0.03592272102832794, -0.0034260384272783995, -0.09163132309913635, -0.023042980581521988, 0.028840892016887665, 0.02254292741417885, 0.012264812365174294, 0.0004052371659781784, -0.028516532853245735, -0.002662444021552801, 0.0387338325381279, -0.027678607031702995, 0.013413582928478718, -0.01678556203842163, 0.015163768082857132, -0.024610714986920357, -0.0034598258789628744, -0.04981608688831329, -0.027678607031702995, 0.0108660152181983, 0.029678817838430405, 0.00032245813054032624, 0.005514097400009632, 0.007615671493113041, -0.00798057485371828, 0.02134009823203087, 0.005608702078461647, -0.02144821733236313, -0.013974452391266823, 0.0019326370675116777, 0.011345796287059784, 0.00981184933334589, -0.03300349414348602, -0.00879147183150053, -0.028029995039105415, 0.029651788994669914, -0.047410424798727036, 0.009994301944971085, -0.007426462136209011, 0.01623144932091236, 0.007521066814661026, -0.02092113345861435, -0.007696760818362236, -0.03930145874619484, 0.009872667491436005, -0.00848062802106142, 0.027502913028001785, -0.029516639187932014, 0.046167049556970596, 0.023029465228319168, -0.006257419474422932, -0.023394368588924408, 0.0019478413742035627, 0.0007260059355758131, 0.013879847712814808, 0.01713695004582405, 0.011636367067694664, 0.001915743458084762, 0.015542185865342617, -0.00952803622931242, -0.007189950440078974, 0.029300399124622345, -0.01662338152527809, 0.013771728612482548, -0.012737835757434368, -0.010230813175439835, -0.045464273542165756, -0.026637956500053406, -0.015947634354233742, 0.04308564215898514, 0.023380855098366737, -0.04249098524451256, -0.0400853268802166, 0.022961890324950218, -0.02181312069296837, 0.027286672964692116, 0.027462366968393326, -0.006517582107335329, 0.012345901690423489, 0.03722015768289566, -0.05622217059135437, 0.0196372140198946, 0.030435655266046524, -0.03743639588356018, 0.009561823680996895, -0.0057168216444551945, 0.01725858449935913, 0.026029784232378006, 0.04268019646406174, -0.012075603008270264, -0.014609655365347862, 0.03276022523641586, 0.023718727752566338, -0.022380748763680458, 0.01848844438791275, 0.0005228593945503235, 0.03757154569029808, 0.014001482166349888, 0.008919863030314445, 0.0033229871187359095, -0.007615671493113041, -0.007967059500515461, 0.03605787083506584, 0.015880059450864792, 0.008142754435539246, -0.07352130115032196, 0.02163742668926716, -0.006632458884268999, 0.023232189938426018, -0.011582307517528534, 0.03594975173473358, -0.015812484547495842, 0.014636685140430927, 0.011724214069545269, 0.02124549262225628, 0.05276234447956085, -0.0036456563975661993, 0.05197847634553909, 0.0188938919454813, 0.011690427549183369, 0.025745969265699387, -0.01674501597881317, 0.006794638466089964, 0.01919122226536274, -0.022759167477488518, -0.01689368113875389, -0.010122693143785, -0.0003556119918357581, 0.028543563559651375, 0.050248563289642334, -0.0018059344729408622, 0.002983424114063382, 0.00030598678858950734, 0.05633028969168663, 0.032354775816202164, 0.0008206105558201671, -0.005875622387975454, -0.010947105474770069, -0.023394368588924408, 0.0008801607764326036, 0.0015466164331883192, 0.031165461987257004, 0.01785324141383171, 0.01951557956635952, 0.031895268708467484, 0.0032993359491229057, -0.013569004833698273, 0.005882379598915577, 0.03297646343708038, -0.03519291430711746, 0.00011139270645799115, -0.024137690663337708, 0.03513885661959648, -0.027192069217562675, 0.01804245077073574, 0.032354775816202164, 0.01087953057140112, 0.015771940350532532, -0.01044029463082552, -0.031192492693662643, 0.013792000710964203, 0.03935552015900612, 0.023205159232020378, 0.00933882687240839, -0.01956963911652565, 0.01823166012763977, 0.04067998379468918, 0.0017037277575582266, -0.015880059450864792, -0.01969127357006073, -0.02063732035458088, 0.0211238581687212, -0.0020390672143548727, -0.045329123735427856, 0.047086067497730255, 0.05605999007821083, 0.031300611793994904, 0.032003387808799744, -0.006649352610111237, -0.025705425068736076, 0.02000211738049984, 0.011339038610458374, 0.013663608580827713, 0.0015896953409537673, -0.026746075600385666, -0.006993983872234821, 0.01911013200879097, 0.024894528090953827, 0.027786726132035255, -0.013474400155246258, 0.03376033157110214, 0.00901446770876646, 0.026043297722935677, 0.007014256436377764, -0.03449013829231262, 0.007521066814661026, 0.013116253539919853, -0.012859470210969448, -0.015123222954571247, 0.04140979051589966, -0.030084267258644104, 0.015744909644126892, -0.030922193080186844, 0.030003177002072334, -0.007034528534859419, -0.012812167406082153, -0.014285296201705933, 0.015542185865342617, -0.012501323595643044, -0.006071588955819607, -0.0003866541082970798, 0.023880906403064728, -0.014961043372750282, 0.011656640097498894, -0.03146279230713844, 0.029030101373791695, 0.0022147614508867264, -0.003204731270670891, -0.004243692383170128, -0.00011456027277745306, -0.030354565009474754, -0.028002964332699776, -0.04040968418121338, 0.003219935577362776, -0.013555489480495453, 0.01782621257007122, -0.0403556264936924, -0.006882485467940569, 0.025029677897691727, -0.01779918186366558, -0.011717457324266434, 0.011845848523080349, -0.012021543458104134, 0.027867816388607025, -0.01092683244496584, -0.02033999189734459, -0.0361659936606884, 0.007054801099002361, -0.02043459564447403, -0.0391392782330513, -0.024516109377145767, -0.007967059500515461, 0.023597093299031258, 0.01697476953268051, 0.0005452435580082238, -0.012940559536218643, -0.0357605442404747, -0.011960726231336594, -0.011163344606757164, 0.030597833916544914, -0.01050786953419447, 0.00460521737113595, 0.013751456514000893, -0.0033449488691985607, 0.027732666581869125, -0.02209693379700184, 0.027665091678500175, -0.006706791464239359, 0.024908043444156647, 0.047518543899059296, 0.0425180159509182, 0.0013160177040845156, -0.03611193224787712, 0.0008869182202033699, 0.005351918283849955, -0.013089223764836788, -0.011089012026786804, -0.024448534473776817, -0.01992102898657322, 0.014177177101373672, 0.02023187279701233, -0.004405871964991093, -0.026543350890278816, 0.030895164236426353, 0.0018549261149019003, 0.03865274041891098, -0.002643861109390855, 0.024556653574109077, -0.02265104651451111, -0.00432478217408061, 0.00202555232681334, -0.011670154519379139, -0.02246183715760708, -0.014177177101373672, -0.011075496673583984, 0.009365856647491455, -2.1856199964531697e-05, -0.02174554578959942, -0.0399501770734787, -0.011487702839076519, 0.048653800040483475, -0.02129955217242241, 0.01129849348217249, 0.029165251180529594, 0.021840151399374008, 0.011082254350185394, -0.015555701218545437, -0.01709640584886074, -0.0049228183925151825, -0.011332280933856964, 0.02032647654414177, -0.030030207708477974, 0.012771622277796268, 0.011284979060292244, 0.03221962973475456, 0.031003283336758614, 0.0023904559202492237, 0.01043353695422411, -0.011129557155072689, -0.01000781636685133, 4.0096096199704334e-05, 0.01087277289479971, 0.0169342253357172, 0.044274959713220596, 0.03754451498389244, 0.011521490290760994, -0.013960937969386578, -0.0035578091628849506, 0.002583043882623315, -0.03892304003238678, 0.00534853944554925, -0.030219417065382004, -0.0033263657242059708, 0.02138064242899418, -0.01030514482408762, -0.03327379375696182, 0.0018245175015181303, -0.03713906928896904, -0.005125542636960745, 0.0015026929322630167, -0.0014984695008024573, 0.01589357480406761, 0.03662550076842308, 0.012109390459954739, 0.005997256841510534, 0.022515898570418358, -0.043734360486269, -0.012494565919041634, -0.008453598245978355, -0.006372296251356602, 0.009798334911465645, 0.010291630402207375, 0.015447582118213177, 0.0047133369371294975, -0.004067998379468918, -0.011453915387392044, -0.01135255303233862, 0.005071483086794615, -0.0027131251990795135, 0.027178553864359856, 0.003275684779509902, -0.00952127855271101, 0.06600698828697205, -0.029408520087599754, -0.008196813985705376, -0.009237464517354965, -0.0163260530680418, 0.03789590299129486, 0.0035882177762687206, 0.025962209329009056, -0.03132764250040054, 0.006882485467940569, -0.011555277742445469, 0.01775863766670227, -0.008379265666007996, 0.027529941871762276, 0.007642701268196106, -0.01804245077073574, -0.007750820834189653, 0.0369768887758255, 0.003250344190746546, 0.013933908194303513, 0.024556653574109077, -0.017204524949193, -0.014988073147833347, -0.027516426518559456, -0.0380580835044384, -0.006882485467940569, -0.01044705230742693, 0.047545574605464935, -0.0008290573605336249, 0.024840468540787697, 0.012075603008270264, -0.0330575555562973, -0.04154494032263756, -0.01863710954785347, 0.02169148623943329, 0.015258372761309147, -0.014866438694298267, 0.01771809160709381, 0.0021235356107354164, -0.01758294366300106, 0.014339356683194637, 0.01997508853673935, -0.01783972606062889, 0.011156586930155754, -0.03240883722901344, -0.0008108966867439449, 0.006250661797821522, 0.00230598752386868, 0.004132194444537163, 0.00841305311769247, -0.007318342570215464, -0.015758424997329712, 0.01874522864818573, -0.01076465379446745, 0.01897498220205307, -0.03759857639670372, -0.003655792446807027, 0.0434640608727932, 0.013947422616183758, 0.009555066004395485, -0.0215293075889349, -0.02009672299027443, -0.03973393887281418, 0.0020052799955010414, -0.006946681533008814, -0.030732983723282814, -0.02093464881181717, 0.026881225407123566, -0.00503769563511014, -0.010109178721904755, -0.029219310730695724, -0.0077710929326713085, -0.0024293113965541124, 0.024597199633717537, -0.0018566155340522528, 0.025624334812164307, -0.0028280022088438272, 0.024151206016540527, 0.01936691626906395, 0.025597305968403816, 0.010156480595469475, 0.024840468540787697, -0.0106970788910985, 0.014596140012145042, 0.004399114288389683, 0.01801542192697525, 0.030003177002072334, -0.0180829968303442, 0.006433113478124142, 0.03997720777988434, -0.022569958120584488, 2.6924304620479234e-05, 0.02071841061115265, -0.01006187591701746, -0.02129955217242241, -0.026570381596684456, 0.0022941618226468563, -0.02202935889363289, 0.026786619797348976, 0.0006964419735595584, -0.03813917189836502, -0.0007665507728233933, 0.0014190691290423274, -0.009007710963487625, 0.014852924272418022, -0.0025695287622511387, -0.050032325088977814, -0.0034108341205865145, 0.03862571343779564, 0.03403063118457794, 0.01892092265188694, -0.0199075136333704, -0.01025108527392149, 0.01861007884144783, -0.025502700358629227, 0.03297646343708038, -0.024421505630016327, 0.0007454336737282574, -0.023218674585223198, -0.01970478892326355, 0.013852817937731743, 0.006071588955819607, 0.00896040815860033, 0.006031043827533722, -0.011568792164325714, -0.00896040815860033, -0.0013117942726239562, -0.0068655917420983315, -0.01773160696029663, -0.030084267258644104, -0.02221856825053692, -0.026354141533374786, 0.00500052934512496, 0.0180829968303442, 0.02059677615761757, 0.0159881804138422, 0.005064725410193205, -0.013291948474943638, -0.005483688786625862, -0.01692070998251438, 0.0004050259885843843, 0.014758319593966007, -0.006034422665834427, 0.01989399828016758, -0.005483688786625862, 0.0016674062935635448, 0.006061452440917492, -0.0015347908483818173, 0.023543033748865128, -0.023488974198698997, -0.004470068030059338, 0.03530103713274002, -0.0007302293670363724, 0.0174072477966547, 0.0020390672143548727, 0.029435548931360245, -0.014569110237061977, -0.00858874712139368, 0.026773104444146156, 0.028057025745511055, 0.028084054589271545, 0.015298916958272457, 0.007291312795132399, 0.011872879229485989, 0.0650339126586914, -0.029003070667386055, -0.023299764841794968, 0.005206632427871227, 0.02008320763707161, 0.00982536468654871, 0.003655792446807027, 0.05124866962432861, -0.0019681137055158615, -0.014352871105074883, -0.014069057069718838, -0.005233662202954292, -0.01863710954785347, 0.012217509560286999, 0.016001693904399872, 0.012055330909788609, -0.03992314636707306, 0.004997150972485542, 0.011528247967362404, 0.01873171329498291, -0.023407883942127228, -0.01656932197511196, -0.0005853660404682159, 0.005321509670466185, 0.001875198562629521, -0.009419916197657585, 0.010406507179141045, -0.01123091857880354, 0.0364362895488739, 0.006020907778292894, 0.01940746046602726, 0.013318978250026703, 0.029840998351573944, 0.05530315265059471, 0.02240777760744095, 0.025448640808463097, -0.007480521686375141, -0.009109072387218475, -0.02127252332866192, -0.0373823381960392, 0.0199075136333704, 0.026935284957289696, 0.030570805072784424, 0.023083524778485298, 0.012332387268543243, -0.0006406928296200931, 0.01875874400138855, -0.01666392758488655, 0.024286355823278427, 0.04351812228560448, -0.014379900880157948, 0.00525055592879653, -0.024016056209802628, -0.012927044183015823, -0.023232189938426018, -0.031300611793994904, 0.01758294366300106, 0.02050217054784298, 0.01717749424278736, 0.0028263127896934748, 0.011210646480321884, -0.0034480001777410507, 0.01578545570373535, -0.006480415817350149, 0.00503769563511014, 0.00958209577947855, -0.01956963911652565, 0.007250767666846514, 0.01883983239531517, -0.014433960430324078, 0.0075075519271194935, 0.0006634992896579206, -0.006477036979049444, -0.0074129472486674786, 0.00417949678376317, 0.025475671514868736, 0.010278115049004555, 0.004084892105311155, 0.0106970788910985, 0.006500688381493092, -0.001817760057747364, 0.0398150272667408, 0.023786302655935287, 0.00216576992534101, 0.009845636785030365, 0.0027638061437755823, -0.04073404148221016, 0.010487597435712814, -0.006281070411205292, -0.023556549102067947, -0.005632353015244007, -0.045329123735427856, -0.00805490743368864, -0.011683669872581959, 0.027192069217562675, 0.027502913028001785, -0.004138951655477285, 0.002061028964817524, 0.004189632833003998, 0.01820463128387928, -0.00928476732224226, 0.0165963526815176, -0.013677123934030533, 0.05489770323038101, -0.015366491861641407, -0.0218671802431345, -0.00257966504432261, 0.007142648100852966, -0.0014756630407646298, -0.01719100959599018, 0.02016429789364338, 0.009419916197657585, 0.007845425046980381, -0.009433431550860405, -0.0047741541638970375, -0.003638898953795433, 0.02229965850710869, -0.0005220147431828082, -0.01135931070894003, -0.0345441997051239, -0.012636473402380943, 0.026516322046518326, -0.011737729422748089, 0.0008683351916261017, -0.015623276121914387, 0.029922086745500565, 0.025759484618902206, 0.014623169787228107, 0.023651152849197388, 0.003942985087633133, -0.023624124005436897, -0.012649987824261189, -0.005750609096139669, 3.2282769097946584e-05, -0.027665091678500175, 0.01012945082038641, -0.02144821733236313, -0.014217721298336983, -0.008696867153048515, 0.027408307418227196, 0.010426780208945274, 0.01908310130238533, 0.002204625401645899, 0.044166840612888336, 0.00227557891048491, 0.049005188047885895, -0.031408730894327164, -0.011940453201532364, -0.024394474923610687, 0.012008028104901314, -0.01742076314985752, -0.011217404156923294, -0.012670260854065418, 0.03578757494688034, -0.025800028815865517, 0.048545680940151215, 0.018150569871068, 0.002605005633085966, -0.0003254145267419517, -0.01728561334311962, 0.03622005134820938, -0.004753881599754095, -0.01031866017729044, -0.03316567465662956, 0.02155633643269539, 0.026624441146850586, 0.04349109157919884, -0.00962939765304327, 0.0052809645421803, -0.023516003042459488, 0.00970373023301363, 0.02182663604617119, 0.031489819288253784, 0.01954261027276516, 0.025516215711832047, -0.01681259088218212, -0.026056813076138496, -0.00470320088788867, 0.00021317713253665715, -0.025435125455260277, -0.022799711674451828, 0.01601520925760269, -0.027489397674798965, 0.03411171957850456, -0.03392251208424568, -0.0014047095319256186, 0.04297752305865288, 0.03876085951924324, -0.024083631113171577, 0.031138433143496513, 0.01874522864818573, 0.023529518395662308, 0.01671798713505268, -0.00883201602846384, -0.007439977023750544, -0.022259114310145378, -0.025759484618902206, 0.0018920922884717584, 0.0037740482948720455, 0.01816408522427082, 0.01825869083404541, -0.010109178721904755, -0.031192492693662643, -0.009318554773926735, -0.023394368588924408, -0.02212396450340748, 0.0009629398118704557, 0.03484152629971504, 0.005902652163058519, 0.024989131838083267, -0.027070434764027596, -0.00441600801423192, -0.01996157318353653, -0.006794638466089964, -0.022083420306444168, -0.011021437123417854, 0.026637956500053406, -0.01747482270002365, 0.00873065460473299, -0.01825869083404541, -0.03232774883508682, 0.01935340091586113, 0.007453491911292076, 0.02015078254044056, -0.0015964527847245336]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
"3)
or extending virtual memory and paging techniques into the
attention mechanism (Kwon et al., 2023a).
To reduce the size of KV cache, the most simple and ef-
fective way is to reduce the total bytes taken by KV cache,
namely, quantization. Unlike the well-studied weight quan-
tization (Lin et al., 2023; Xiao et al., 2023a), to the best of
our knowledge, only a few studies applied the vanilla 4bit
1arXiv:2402.02750v1  [cs.CL]  5 Feb 2024
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
per-token
quantizationper-channel
quantization
Figure 1: Definition of per-token and per-channel quantiza-
tion.X∈Rlprompt×dis key/value cache where lprompt is the
number of tokens and dis the number of channels. zXis
the zero-point, sXis the scaling factor.
round-to-nearest quantization to KV cache (Sheng et al.,
2023; Zhang et al., 2023) due to the streaming nature of KV
cache. There is a lack of in-depth studies that explore the
element distribution of KV cache to understand the hardness
and limitation of KV cache quantization.
To fill the gap, we study the element distribution of KV
cache. Our analysis suggests:
•For the key cache, there are a few fixed channels whose
magnitudes are very large, which is consistent with
previous finding (Lin et al., 2023; Xiao et al., 2023a).
Thus, as shown in Figure 1 right, key cache should be
quantized per-channel, i.e., group elements along the
channel dimension and quantize them together. In this
way, it can confine the error to each individual channel,
without impacting the other normal channels.
•For the value cache, there is no obvious outlier pat-
tern. Although value cache has no obvious outlier
pattern, we experimentally show that it can only be
quantized per-token because it is used to calculate the
attention output, which is essentially a value cache
mixer. As shown in Figure 1 left, the per-token quan-
tization can confine the error inside each individual
token and ensure that the quantization of one token
does not adversely impact the others.
Based on the above insights, we propose KIVI , a plug-and-
play extreme low-bit KV cache quantization method. KIVI
quantizes key cache per-channel and quantizes value cache
per-token. The per-token value cache quantization aligns
well with the streaming nature of auto-regressive inference,
allowing newly quantized tensors to be directly appended
to the existing quantized value cache by token dimension.
However, for per-channel key cache quantization, the quan-
tization process spans different tokens, which cannot be
directly implemented in this streaming setting. Since the
number of tokens in key cache can be arbitrary, our key
idea is to split key cache into two parts. The first part isthe grouped key cache, which contains several groups of
tokens and each group has a certain number of tokens. The
second part is the residual key cache, which does not have
a sufficient number of tokens to form a complete group.
Similarly, we split value cache into the grouped and residual
parts to maintain the model performance. We only apply
group-wise quantization to the grouped key cache and value
cache, while the residual key cache and value cache are kept
in full precision. The grouped and residual parts can be
combined when computing the attention score using tiled
matrix multiplication. Our contributions are summarized as
follows:
•Extensive analysis regarding the outlier patterns
and quantization error of KV cache in commonly-
used LLMs . Our observations suggest that key cache
should be quantized per-channel and value cache
should be quantized per-token. We also explain in-
depth why these caches require different quantization
approaches.
•A new plug-and-play 2bit KV cache quantization
algorithm without any fine-tuning, KIVI , with
hardware-friendly implementation. We conduct an
extensive evaluation for KIVI with Llama (Llama-2),
Mistral, and Falcon on popular generation tasks. KIVI
can efficiently compress KV cache to 2bit and bring
2.6×peak memory usage reduction for Llama-2-7B,
with little to no accuracy drop. With our efficient
system implementation, this memory reduction in re-
turn enables up to 4×larger batch size and brings
2.35× ∼3.47×throughput.
","[0.009272249415516853, 0.019350208342075348, -0.015215999446809292, -0.017263291403651237, 0.003328499849885702, 0.006594260223209858, 0.027420498430728912, 0.01660287380218506, -0.03413033112883568, 0.0019218124216422439, 0.04142133146524429, 0.04430074989795685, -0.05040299892425537, 0.0460442490875721, -0.0006624804227612913, -0.0064588747918605804, 0.013049832545220852, -0.018927540630102158, -0.03114524856209755, -0.012719624675810337, -0.038357000797986984, -0.049029331654310226, 0.01616699993610382, 0.021529583260416985, 0.048844415694475174, -0.06609449535608292, -0.02274474874138832, -0.013380041345953941, 0.012204499915242195, -0.06487932801246643, 0.0317264162003994, -0.024316541850566864, -0.05505233258008957, -0.08268416672945023, -0.00793160405009985, 0.0313301645219326, -0.007020229008048773, -0.010401561856269836, -0.026760082691907883, -0.008816562592983246, 0.03399824723601341, -0.03072258271276951, -0.0301678329706192, 0.019482290372252464, 0.04081374779343605, 0.045278165489435196, -0.0024088697973638773, -0.020789915695786476, -0.07708383351564407, 0.023418374359607697, -0.012851707637310028, 0.044855497777462006, -0.054682496935129166, -0.017051957547664642, 0.020763499662280083, 0.01253470778465271, 0.015876416116952896, -0.013492312282323837, 0.038700416684150696, -0.012752645649015903, 0.023669332265853882, -0.05896199867129326, -0.0017319426406174898, 0.008724103681743145, -0.01987854205071926, 0.027526166290044785, -0.018055791035294533, 0.0055904267355799675, 0.010936499573290348, -0.004206853918731213, -0.0031303749419748783, 0.040945831686258316, 0.006993812508881092, -0.007792916614562273, -0.014634832739830017, 0.004857364576309919, -0.021067291498184204, 0.023695750162005424, 0.032941583544015884, 0.00749572878703475, 0.02053895778954029, -0.0013455989537760615, 0.014251790940761566, -0.02170129120349884, 0.0174085833132267, -0.0045766872353851795, -0.018425624817609787, 0.006392833311110735, -0.027103498578071594, -0.010130790993571281, -0.04263649880886078, 0.0276582483202219, -0.044855497777462006, 0.005032374989241362, 0.04588574916124344, 0.0016650754259899259, 0.04482908174395561, -0.02723558247089386, 0.02460712380707264, 0.00697400001809001, 0.010546853765845299, 0.01098933257162571, 0.04213458299636841, -0.025967583060264587, 0.07243449985980988, -0.020565373823046684, -0.015268833376467228, 0.043719582259655, -0.007647624704986811, -0.026826124638319016, -0.018214290961623192, 0.008988270536065102, -0.05156533047556877, 0.021846583113074303, -0.010137395933270454, -0.04971616715192795, -0.0649849995970726, 0.0017220363952219486, -0.014463124796748161, 0.004708770662546158, -0.01710479147732258, -0.0012613957514986396, 0.03125091642141342, -0.0007780533633194864, 0.0077136666513979435, -0.05333524942398071, 0.037036165595054626, -0.047180164605379105, -0.022810790687799454, -0.021793749183416367, 0.027446916326880455, 0.008730707690119743, 0.05621466413140297, 0.014793332666158676, -0.013135687448084354, -0.02757899835705757, -0.012594145722687244, 0.06392832845449448, -0.033522747457027435, 0.0006777525995858014, -0.02112012356519699, -0.03349633142352104, 0.01561224926263094, -0.017580291256308556, -0.023959916085004807, 0.0020803124643862247, -0.03151508420705795, 0.027261998504400253, -0.0036917291581630707, -0.009754354134202003, -0.011042166501283646, -0.009860020130872726, -0.008869395591318607, -0.018636958673596382, -0.03671916574239731, -0.0120922289788723, -0.004982843529433012, 0.00038510546437464654, 0.02579587511718273, -0.01702554151415825, -0.015361291356384754, 0.02402595803141594, 0.06213199719786644, -0.010058145970106125, 0.007475916296243668, -0.0105402497574687, -0.07792916148900986, -0.001523911370895803, -0.05175025016069412, -0.026324206963181496, -0.007667437195777893, -0.01822749897837639, -0.0011945286532863975, -0.022506998851895332, 0.010936499573290348, -0.027711082249879837, -0.04012691602110863, -0.018636958673596382, -0.002326317597180605, -0.016008500009775162, -0.049504831433296204, 0.04691600054502487, 0.001372015569359064, 0.07100799679756165, -0.020512541756033897, -0.001231677015312016, -0.0017269895179197192, 0.006052718497812748, -0.03048483282327652, 0.04998033121228218, -0.03682483360171318, 0.019006790593266487, 0.06361132860183716, 0.053018249571323395, 0.02773750014603138, -0.018901124596595764, -0.005570614244788885, 0.01400083303451538, -0.01524241641163826, -0.02747333236038685, -0.0023956613149493933, 0.01752745732665062, 0.03199058398604393, -0.06905316561460495, 0.04163266718387604, -0.006967395544052124, -0.01116104144603014, 0.01239602081477642, -0.05278049781918526, -0.015757542103528976, -0.006323489360511303, 0.05341449752449989, 0.04908216372132301, 0.0053889998234808445, 0.0007470963173545897, 0.021833375096321106, -0.011629937216639519, 0.04200249910354614, -0.03500208258628845, 0.042187415063381195, -0.003244296880438924, -0.006406041327863932, 0.0012258983915671706, 0.0018920936854556203, -0.04538383334875107, 0.020948415622115135, -0.016233041882514954, -0.034790750592947006, 0.029956499114632607, -0.02797525003552437, 0.04414224997162819, 0.023999540135264397, -0.0189539585262537, -0.025835499167442322, -0.015955666080117226, -0.0367455817759037, -0.01961437426507473, -0.03708899766206741, -0.012805478647351265, -0.04142133146524429, -0.011484645307064056, -0.008757124654948711, -0.02023516595363617, -0.01578395813703537, -0.03428883105516434, 0.02715633250772953, -0.04208174720406532, -0.02332591637969017, 0.0653548315167427, -0.020631415769457817, -0.03257174789905548, -0.023656124249100685, -0.06281883269548416, 0.0013051483547315001, -0.04422149807214737, -0.03566249832510948, 0.06366416811943054, 0.028873415663838387, 0.004953125026077032, 0.030035749077796936, -0.010553457774221897, -0.04688958078622818, -0.03162074834108353, -0.027869582176208496, -0.0203144159168005, -0.03214908391237259, -0.013763083145022392, 0.020631415769457817, -0.023391958326101303, -0.027341248467564583, 0.00638292683288455, -0.035451166331768036, -0.0033450103364884853, -0.023656124249100685, 0.01822749897837639, 0.028609249740839005, 0.010725166648626328, -0.03376049920916557, -0.024475041776895523, 0.026548748835921288, -0.020301207900047302, -0.014925416558980942, 0.05690149962902069, -0.016457583755254745, 0.017659541219472885, -0.0006377148092724383, 0.02294287458062172, 0.021133333444595337, 0.005435228813439608, -0.03164716437458992, 0.03315291553735733, -0.005085207987576723, 0.004097885452210903, -0.022995708510279655, -0.019667208194732666, 0.03666633367538452, -0.03788149729371071, -0.0383041650056839, 0.011319541372358799, -0.008961853571236134, 0.04688958078622818, 0.025280749425292015, 0.008902416564524174, 0.0016807604115456343, -0.02170129120349884, 0.01670854166150093, 0.03629649803042412, 0.01806899905204773, -0.019521916285157204, 0.021265415474772453, 0.029771583154797554, 0.026958206668496132, -0.014212165959179401, 0.04514608159661293, -0.056848663836717606, -0.04031183198094368, 0.00329382810741663, -0.015057499520480633, 0.06044133007526398, -0.004068166483193636, 0.026258166879415512, -0.07613283395767212, -0.0037247498985379934, -0.007059853989630938, 0.021093707531690598, -0.020472915843129158, -0.018161457031965256, -0.013749874196946621, 0.00033557420829311013, -0.04416866600513458, 0.020301207900047302, 0.02422408200800419, 0.02673366665840149, -0.014898999594151974, -0.0723288282752037, -0.026007207110524178, -0.0075881872326135635, 0.009952479042112827, 0.006914562080055475, -0.02402595803141594, -0.06609449535608292, -0.0040351455099880695, 0.011207270435988903, -0.008407103829085827, 0.004078072961419821, 0.05116908252239227, 0.05927899852395058, 0.017765207216143608, 0.0541541650891304, -0.02747333236038685, -0.006633885204792023, -0.026905374601483345, 0.033945415169000626, -0.08035949617624283, 0.04200249910354614, 0.004579989239573479, 0.03241324797272682, -0.03782866522669792, -0.050429414957761765, -0.005091812461614609, -0.0016337056877091527, 0.024514665827155113, 0.04406299814581871, 0.017421791329979897, -0.002266880124807358, -0.02623174898326397, -0.02254662476480007, -0.019640790298581123, 0.012917749583721161, -0.006349905859678984, 0.010725166648626328, 0.014423499815165997, -0.026905374601483345, -0.0487387478351593, -0.0043191248551011086, -0.01991816610097885, 0.05381074920296669, 0.058433666825294495, 0.0317264162003994, 0.00630697887390852, 0.059331830590963364, 0.017923707142472267, 0.006861729081720114, 0.014304624870419502, 0.041368499398231506, 0.015638666227459908, 0.012792270630598068, 0.0006133619463071227, -0.07607999444007874, 0.034790750592947006, -0.04538383334875107, 0.014251790940761566, -0.020050249993801117, 0.021423915401101112, 0.04131566733121872, 0.030801832675933838, 0.00045898958342149854, -0.007092874962836504, 0.03679841384291649, 0.0472065806388855, 0.012963978573679924, 0.024593915790319443, -0.038858916610479355, -0.003209624905139208, -0.0054022083058953285, -0.006396135315299034, 0.058856330811977386, 0.012831895612180233, 0.03183208405971527, 0.010137395933270454, 0.008862791582942009, -0.04649333283305168, 0.0367455817759037, -0.061180997639894485, 0.016233041882514954, -0.02127862349152565, 0.00930527038872242, 0.0187690407037735, 0.03687766566872597, 0.07718949764966965, 3.1150511858868413e-06, -0.014634832739830017, -0.057852499186992645, -0.06910599768161774, 0.01822749897837639, 0.020261581987142563, -0.010038333013653755, -0.04054958373308182, 0.029771583154797554, -0.04747074842453003, -0.0371418334543705, -0.0239863321185112, -0.015850000083446503, -0.0034671875182539225, -0.00992606207728386, -0.004953125026077032, -0.05079924687743187, 0.01787087507545948, 0.0026664321776479483, -0.016180207952857018, -0.03265099972486496, -0.03555683419108391, -0.034605830907821655, 0.0030626822263002396, -0.03389258310198784, 0.03072258271276951, -0.004338937345892191, -0.014885791577398777, 0.06915882974863052, -0.03928158059716225, 0.004906895570456982, 0.001224247389473021, 0.052172914147377014, -0.007092874962836504, 0.03056408278644085, -0.09436032921075821, 0.08574850112199783, -0.017474625259637833, -0.0038502290844917297, -0.012125249952077866, 0.0028645573183894157, 0.023391958326101303, -0.04115716367959976, 0.01491220761090517, 0.0448819138109684, -0.00027345377020537853, 0.0066305832006037235, 0.033284999430179596, 0.010923291556537151, -0.02015591599047184, -0.002526093740016222, -0.06482649594545364, -0.01570470817387104, 0.007555166259407997, -0.05230499804019928, -0.031356584280729294, 0.03471149876713753, -0.013036624528467655, 0.008070291019976139, -0.02545245736837387, 0.0226258747279644, -0.02479204162955284, -0.022044707089662552, -0.00801085401326418, 0.014264999888837337, 0.057588331401348114, 0.04390449821949005, -0.0007759895524941385, 0.01620662398636341, -0.0026367134414613247, -0.040179748088121414, -0.0181746669113636, 0.022916458547115326, -0.01394800003618002, 0.023352332413196564, 0.0241844579577446, -0.012125249952077866, 0.016880249604582787, 0.04039108380675316, -0.011636541225016117, 0.037538081407547, 0.027341248467564583, 0.01829354092478752, 0.04591216519474983, -0.002037385245785117, 0.03196416422724724, 0.04253083094954491, 0.001052538980729878, -0.00211828644387424, 0.0421609990298748, 0.012429041787981987, 0.0019762967713177204, -0.014027249999344349, 0.01452916581183672, -0.011570499278604984, 0.021186165511608124, 0.013082853518426418, 0.01245545782148838, -0.021489957347512245, 0.020842749625444412, -0.017897291108965874, -0.03941366448998451, -0.007363645825535059, -0.013763083145022392, 0.007396666333079338, 0.006069228984415531, -0.046783916652202606, -0.11221799999475479, -0.0074164788238704205, -0.04670466482639313, 0.020261581987142563, -0.026429874822497368, -0.019508708268404007, 0.026099665090441704, -0.010659124702215195, -0.015546208247542381, 0.0026119479443877935, -0.0066437916830182076, 0.015638666227459908, 0.034447330981492996, 0.0029504112899303436, -0.01369704119861126, -0.001309275976382196, 0.034764330834150314, -0.023352332413196564, 9.158121247310191e-05, 0.04673108085989952, -0.04430074989795685, -0.012805478647351265, 0.03407749906182289, 0.014264999888837337, -0.03418316692113876, -0.0025326977483928204, -0.023775000125169754, 0.016800999641418457, 0.025082623586058617, 0.02948099933564663, 0.022348498925566673, -0.042610082775354385, 0.012376207858324051, 0.028794165700674057, 0.010143999941647053, 0.004817739594727755, -0.010797812603414059, -0.027922416105866432, -0.01825391687452793, 0.024593915790319443, -0.017051957547664642, 0.005653166677802801, 0.03838341683149338, -0.011352562345564365, -0.020565373823046684, 0.030458414927124977, -0.049187831580638885, 0.03391899913549423, 0.006049416493624449, -0.00019874413555953652, -0.0036851249169558287, 0.02990366518497467, 0.03373408317565918, -0.0210804995149374, -0.0009939270094037056, -0.00970812514424324, -0.021767333149909973, -0.037273917347192764, 0.015229207463562489, 0.008347666822373867, 0.017540665343403816, -0.020763499662280083, 0.0022751353681087494, 0.003903062315657735, -0.015599041245877743, -0.0024517967831343412, 0.0028529998380690813, -0.03571533411741257, 0.012230915948748589, 0.01949550025165081, -0.023814624175429344, -0.031013166531920433, -0.01017702091485262, 0.024699581786990166, 0.006531520746648312, -0.018927540630102158, -0.009371312335133553, -0.041368499398231506, 0.0719589963555336, -0.0270770825445652, 0.008228791877627373, 0.027261998504400253, -0.015757542103528976, 0.006363114342093468, -0.03312649950385094, -0.006313583347946405, -0.029216833412647247, -0.045780081301927567, -0.031118832528591156, -0.0234051663428545, -0.033179331570863724, 0.03809283301234245, -0.02576945722103119, 0.02471279166638851, -0.04171191528439522, -0.005712604150176048, -0.004685656167566776, -0.00211828644387424, 0.021503165364265442, -0.0066437916830182076, -0.048685915768146515, -0.028846999630331993, 0.007238166406750679, -0.0294017493724823, 0.005147947929799557, -0.007033437490463257, 0.026865748688578606, 0.008809957653284073, -0.0008700989419594407, 0.022890040650963783, 0.007634416688233614, 0.008308041840791702, 0.011894104070961475, 0.050112415105104446, 0.020591791719198227, 0.006013093516230583, -0.031118832528591156, 0.012884728610515594, -0.020287999883294106, 0.011801645159721375, 0.037617333233356476, -0.0008424439583905041, -0.027922416105866432, -0.019931374117732048, -0.03687766566872597, 0.0460442490875721, 0.03838341683149338, 0.02561095729470253, -0.018161457031965256, -0.00015313411131501198, -0.02715633250772953, -0.018901124596595764, -0.012878124602138996, -0.02162204124033451, -0.022639082744717598, -0.028265831992030144, -0.0011383931851014495, 0.001844213460572064, 0.047100916504859924, 0.012567728757858276, 0.0011986562749370933, -0.028503581881523132, 0.007674041669815779, 0.0003271126188337803, 0.004253083374351263, 0.025478873401880264, -0.011411999352276325, -0.0016122421948239207, 0.01245545782148838, -0.011583708226680756, -0.010124186985194683, -0.0276582483202219, 0.02831866592168808, -0.03798716515302658, 0.011233687400817871, -0.05669016391038895, -0.04506683349609375, -0.017117999494075775, -0.0070466455072164536, 0.03531908243894577, -0.0016147186979651451, 0.0023411770816892385, -0.04054958373308182, 3.60133453796152e-05, 0.01214506197720766, -0.0053460728377103806, -0.033707667142152786, -0.02308816649019718, 0.03376049920916557, 0.005834781099110842, 0.017672749236226082, -0.0007227434543892741, -0.018055791035294533, -0.0037775831297039986, 0.004355447832494974, -0.05098416656255722, -0.003500208258628845, -0.029375333338975906, -0.026178915053606033, -0.00661407271400094, 0.01491220761090517, 0.05061433091759682, -0.01444991584867239, 0.002522791502997279, -0.018082207068800926, 0.01293756254017353, 0.01028929091989994, -0.030299915000796318, 0.009582645259797573, -0.002938854042440653, 0.01849166676402092, 0.011867687106132507, -0.02065783366560936, -0.03138300031423569, 0.021635249257087708, -0.032096248120069504, -0.018425624817609787, 0.009509999305009842, 0.003049473976716399, -0.034869998693466187, 0.015506583265960217, 0.01338664535433054, 0.03516058251261711, 0.010692145675420761, 0.010494020767509937, 0.02557133324444294, -0.007337228860706091, 0.001527213491499424, 0.006980604026466608, -0.05307108163833618, -0.02015591599047184, -0.031171666458249092, -0.01452916581183672, -0.02908474951982498, -0.016959499567747116, 0.035186998546123505, 0.021529583260416985, 0.00878354161977768, 0.013214937411248684, 0.002217348897829652, -0.012897937558591366, 0.019469082355499268, -0.023761790245771408, 0.007839146070182323, 0.012310165911912918, -0.003219531150534749, 0.021833375096321106, 0.02290324866771698, -0.024131624028086662, 0.01674816571176052, -0.03428883105516434, -0.01652362383902073, 0.0033202446065843105, -0.01783124916255474, -0.005012562498450279, -0.002502979012206197, 0.03846266493201256, 0.016536833718419075, -0.022890040650963783, -0.017765207216143608, -0.019429458305239677, 0.023775000125169754, 0.0013711900683119893, -0.007112687453627586, -0.005405510310083628, -0.00830143690109253, 0.044274333864450455, 0.028371499851346016, -0.04567441716790199, 0.009727937169373035, -0.023616500198841095, -0.0071589164435863495, 0.03254533186554909, 0.017699165269732475, -0.01636512391269207, -0.006531520746648312, -0.03151508420705795, -0.008169353939592838, -0.007350437343120575, -0.013320603407919407, -0.006980604026466608, -0.024778831750154495, -0.028371499851346016, -0.02685254067182541, -0.010302499867975712, 0.01001852098852396, -0.011695979163050652, -0.02587512508034706, 0.031700000166893005, -0.008664666675031185, -0.08094066381454468, -0.021265415474772453, 0.016510415822267532, 0.01361779123544693, 0.005134739447385073, 0.019587958231568336, -0.024475041776895523, -0.01400083303451538, 0.006498499773442745, -0.025782665237784386, 0.006013093516230583, -0.007350437343120575, 0.016893457621335983, -0.023959916085004807, -0.01923133246600628, -0.03700974956154823, -0.02580908313393593, 0.01594245806336403, 0.021450333297252655, 0.004761604126542807, -0.020974833518266678, 0.010038333013653755, -0.0026169009506702423, 0.01222431194037199, -0.004229968413710594, -0.00839389581233263, 0.0010707004694268107, -0.016074541956186295, -0.007825937122106552, 0.005877708084881306, -0.01491220761090517, -0.01775199919939041, -0.015810374170541763, 0.028265831992030144, -0.02603362500667572, 0.0040912809781730175, -0.008942041546106339, 0.014225374907255173, 0.02282399870455265, -0.025597749277949333, -0.0017864269902929664, -0.045357413589954376, 0.009490187279880047, -0.016140582039952278, 0.033522747457027435, -0.037194665521383286, 0.023775000125169754, 0.0018210989655926824, 0.004550270736217499, -0.003381333313882351, 0.01561224926263094, 0.010427978821098804, 0.009252437390387058, 0.006835312116891146, 0.007357041351497173, 0.017514249309897423, 0.016840623691678047, -0.008862791582942009, -0.023220248520374298, 0.018055791035294533, -0.01744820736348629, 0.03022066503763199, -0.008677874691784382, -0.008308041840791702, -0.039519332349300385, -0.029771583154797554, 0.0025558124762028456, 0.02324666641652584, 0.029533833265304565, -0.04414224997162819, -0.04945199936628342, 0.01806899905204773, -0.01853129081428051, 0.01941625028848648, 0.004781416617333889, -0.007125895470380783, -0.005005958024412394, -0.004414885304868221, -0.06984566152095795, 0.019218124449253082, 0.040681663900613785, -0.03450016677379608, 0.020433291792869568, -0.001681585912592709, 0.0090873334556818, 0.026403456926345825, 0.038779664784669876, -0.019323790445923805, -0.01077139563858509, 0.018980374559760094, 0.034685082733631134, -0.038700416684150696, 0.007053249981254339, -0.012541311793029308, 0.046598996967077255, 0.004685656167566776, 0.012594145722687244, 0.004609708208590746, -0.014595207758247852, -0.0010071353754028678, 0.043191250413656235, 0.01100254151970148, 0.014014041051268578, -0.09356783330440521, 0.01606133207678795, 0.00961566623300314, 0.008724103681743145, -0.0027671458665281534, 0.036190833896398544, -0.014423499815165997, 0.01178183313459158, -0.0032806196250021458, 0.02541283331811428, 0.04591216519474983, -0.005864500068128109, 0.04070808365941048, 0.01239602081477642, 0.014674457721412182, 0.021872999146580696, -0.019944582134485245, 0.007053249981254339, 0.016233041882514954, -0.024924123659729958, -0.03275666758418083, -0.012719624675810337, 0.001080606714822352, 0.036190833896398544, 0.021503165364265442, -0.006029604002833366, -0.01452916581183672, -0.007925000041723251, 0.052754081785678864, 0.01945587433874607, 0.034368082880973816, -0.010315707884728909, -0.014595207758247852, -0.02147674933075905, -0.007297603879123926, 0.0006888970965519547, 0.01985212415456772, 0.0033202446065843105, 0.025175083428621292, 0.045859333127737045, 0.026786498725414276, -0.03970424830913544, 0.0066305832006037235, 0.01725008338689804, -0.009120353497564793, -0.008446728810667992, -0.02259945683181286, 0.03346991539001465, -0.014832957647740841, 0.019204916432499886, 0.027499748393893242, 0.0054022083058953285, 0.022916458547115326, 0.0016386588104069233, -0.025241123512387276, 0.025663791224360466, 0.0518294982612133, 0.016299081966280937, 0.012098832987248898, -0.004738489631563425, 0.009952479042112827, 0.03531908243894577, -0.03204341605305672, -0.004041749984025955, -0.027182748541235924, -0.01330739539116621, 0.03743241727352142, -0.0064027393236756325, -0.035028498619794846, 0.050852082669734955, 0.043772414326667786, 0.033020831644535065, 0.020340831950306892, -0.003860135329887271, -0.02948099933564663, 0.033522747457027435, -0.02282399870455265, 0.010546853765845299, -0.005058791488409042, -0.02100124955177307, -0.024778831750154495, 0.028028082102537155, 0.030511248856782913, 0.020472915843129158, -0.0098666250705719, 0.04395733028650284, 0.0022965988609939814, 0.009080728515982628, 0.002867859322577715, -0.048950083553791046, 0.003424260299652815, 0.002509583253413439, -0.0054583437740802765, -0.01871620863676071, 0.01678779162466526, -0.015916042029857635, 0.036930497735738754, -0.028767749667167664, 0.01100254151970148, -0.008724103681743145, -0.010434582829475403, -0.00984681211411953, 0.012561124749481678, -0.012336582876741886, -0.0007982786046341062, 0.015955666080117226, 0.020988041535019875, -0.004523854237049818, 0.005474853795021772, -0.01857091672718525, 0.03032633289694786, -0.0061319684609770775, -0.014317832887172699, 0.006155082955956459, -0.013419666327536106, -0.021608833223581314, -0.006439062301069498, -0.02298249863088131, -0.002265229122713208, -0.03270383179187775, 0.0004561002424452454, -0.048183999955654144, -0.013512124307453632, 0.028767749667167664, -0.023220248520374298, -0.0011796692851930857, 0.026971416547894478, -0.023854250088334084, 0.03238683193922043, -0.01092989556491375, -0.0035530414897948503, -0.0402325838804245, 0.0048837810754776, -0.022718332707881927, -0.03505491465330124, -0.012673395685851574, -0.019284166395664215, 0.016616083681583405, 0.028212999925017357, 0.016193415969610214, -0.011927125044167042, -0.05175025016069412, -0.005256916396319866, -0.008281624875962734, 0.04337616637349129, -0.018438832834362984, 0.012230915948748589, -0.003546437481418252, 0.0008098359103314579, 0.047180164605379105, -0.0226258747279644, 0.013630999252200127, -0.003424260299652815, 0.03928158059716225, 0.04208174720406532, 0.03072258271276951, -0.009430749341845512, -0.014832957647740841, -0.010500624775886536, 0.010956312529742718, -0.018636958673596382, -0.018161457031965256, -0.02259945683181286, -0.016761373728513718, 0.013736666180193424, 0.016880249604582787, 0.012930957600474358, -0.013644208200275898, 0.01977287419140339, -0.0006344127468764782, 0.04614991694688797, -0.006567843724042177, 0.02956024929881096, -0.01608774997293949, -0.02310137450695038, 0.010665728710591793, -0.016457583755254745, -0.028424331918358803, -0.014066874980926514, -0.011643145233392715, 0.004560176748782396, 0.00418704142794013, -0.02123899944126606, -0.0402325838804245, -0.005544197745621204, 0.030801832675933838, -0.012693207710981369, 0.012237520888447762, 0.022771166637539864, 0.015255624428391457, 0.0189539585262537, -0.0010880364570766687, -0.01444991584867239, -0.00884297862648964, 0.003353265579789877, 0.016259457916021347, -0.03310008347034454, 0.00878354161977768, 0.006392833311110735, 0.03856833279132843, 0.013895166106522083, 0.017421791329979897, 0.020221957936882973, -0.012369603849947453, -0.015215999446809292, -0.0019053020514547825, 0.006706531159579754, 0.024554291740059853, 0.038779664784669876, 0.012362999841570854, 0.0203144159168005, 0.00824199989438057, -0.011570499278604984, 0.008169353939592838, -0.04828966408967972, 0.021146541461348534, -0.03817208111286163, -0.015097124502062798, 0.015308458358049393, -0.012594145722687244, -0.0037181456573307514, 0.01628587394952774, -0.041685499250888824, -0.004154020920395851, -0.005147947929799557, -0.007211749907582998, 0.02530716545879841, 0.011643145233392715, 0.00516445841640234, 0.011167645454406738, 0.017699165269732475, -0.03341708332300186, 0.0017187342746183276, 0.009437354281544685, 0.007178728934377432, 0.006409343797713518, 0.003427562303841114, 0.01779162511229515, -0.002509583253413439, 0.0074164788238704205, -0.005355978850275278, -0.015282041393220425, -0.00485406257212162, -0.0046889581717550755, 0.02747333236038685, -0.013063041493296623, -0.027420498430728912, 0.06255466490983963, -0.024924123659729958, 0.010949707590043545, -0.006703229155391455, -0.014753707684576511, 0.031937748193740845, -0.0043059163726866245, 0.01216487493366003, -0.03233399987220764, 0.0043884688057005405, -0.027499748393893242, 0.017395375296473503, 0.008235395886003971, 0.025161873549222946, -0.004025239497423172, -0.029216833412647247, 0.0029355520382523537, 0.03687766566872597, 0.001875583315268159, 0.009840208105742931, 0.018478458747267723, -0.0034209582954645157, -0.010110978968441486, -0.03389258310198784, -0.03082824870944023, -0.003652104176580906, -0.01779162511229515, 0.043930914252996445, 0.011279916390776634, 0.022771166637539864, -0.004140812437981367, -0.02797525003552437, -0.02982441522181034, -0.01153087429702282, 0.02579587511718273, 0.015215999446809292, -0.01736895740032196, 0.02294287458062172, 0.010672332718968391, -0.007376853842288256, 0.015044291503727436, 0.01270641665905714, -0.02053895778954029, -0.00801085401326418, -0.014687666669487953, -0.004992750007659197, 0.0023246665950864553, -0.006498499773442745, -0.007456103805452585, 0.008710895664989948, 0.012045999988913536, 0.0037742811255156994, 0.03291516751050949, -0.001340645831078291, 0.019904958084225655, -0.03537191450595856, -0.0010038332547992468, 0.02410520799458027, 0.0052767288871109486, -0.007026833016425371, -0.02224283292889595, -0.026258166879415512, -0.03333783149719238, -0.014938624575734138, -0.012759249657392502, -0.029613083228468895, -0.011147833429276943, 0.0172104574739933, 0.0003768502501770854, -0.02182016521692276, -0.010890270583331585, 0.00726458290591836, -0.004137510433793068, 0.008829770609736443, -0.0044181873090565205, 0.006633885204792023, -0.0020604999735951424, 0.03531908243894577, 0.011332749389111996, 0.026548748835921288, -0.020486123859882355, 0.010223249904811382, -0.01009777095168829, 0.0006232681917026639, -0.0038568333256989717, 0.02282399870455265, 0.053942833095788956, -0.02310137450695038, 0.007951416075229645, 0.041764747351408005, -0.03056408278644085, -0.004636124707758427, 0.007641020696610212, -0.008717499673366547, -0.020565373823046684, -0.03032633289694786, 0.0076013957150280476, -0.016721749678254128, 0.0172104574739933, -0.002238812390714884, -0.04945199936628342, 0.0004317473794799298, -0.009754354134202003, 0.005630051717162132, 0.027922416105866432, 0.007403270807117224, -0.06207916513085365, -0.01702554151415825, 0.04747074842453003, 0.04263649880886078, 0.02882058173418045, -0.012230915948748589, -0.01787087507545948, 0.012673395685851574, -0.028345081955194473, 0.03439449891448021, -0.02823941595852375, 0.0015503281028941274, -0.007641020696610212, 0.005953656043857336, 0.004223364405333996, 0.0060758329927921295, 0.00783254113048315, 0.010170415975153446, -0.0003198893100488931, -0.003860135329887271, -0.007132499944418669, -0.009543020278215408, -0.027499748393893242, -0.029665915295481682, 0.0006930247182026505, -0.024633541703224182, 0.005497968755662441, 0.02089558355510235, 0.01408008299767971, 0.017236875370144844, 0.003163395682349801, -0.0179897490888834, -0.011676166206598282, 0.010811020620167255, -0.003001593751832843, 0.017131207510828972, -0.018306748941540718, 0.020420081913471222, 0.003490302013233304, 0.012270540930330753, -0.00697400001809001, 0.008909020572900772, 0.04562158137559891, -0.021252207458019257, -0.00808349996805191, 0.029005499556660652, -0.004144114442169666, 0.015519791282713413, 0.012178082950413227, 0.016312291845679283, -0.019561540335416794, -0.005719208158552647, 0.041262831538915634, 0.030511248856782913, 0.012818687595427036, 0.0026713854167610407, 0.003803999861702323, -0.0058182706125080585, 0.04504041373729706, -0.0164443738758564, -0.010447791777551174, -0.0007322369492612779, 0.014938624575734138, -0.012079020962119102, 0.0015362942358478904, 0.037115417420864105, 0.0119931660592556, 0.004593197721987963, -0.011260103434324265, 0.0016791092930361629, -0.011114812456071377, 0.0181878749281168, -0.0029471092857420444, 0.012290353886783123, -0.01822749897837639, -0.011742208153009415, 0.005385697819292545, 0.021595625206828117, -0.020869165658950806, -0.005983375012874603, -0.009912854060530663, 0.0018541197059676051, 0.006316885352134705, -0.014753707684576511, 0.007007020525634289, -0.021133333444595337, 0.04020616412162781, 0.02757899835705757, 0.03772299736738205, 0.010137395933270454, 0.01612737402319908, 0.06466799974441528, 0.004229968413710594, 0.043693166226148605, -0.012607353739440441, -0.005973468534648418, -0.02344479039311409, -0.04266291484236717, 0.03872683271765709, 0.018504874780774117, 0.015797166153788567, 0.018319956958293915, 0.011557291261851788, -0.00040471157990396023, 0.013274374417960644, -0.0156650822609663, 0.03167358413338661, 0.0348171666264534, -0.003909666556864977, -0.002892624819651246, -0.016721749678254128, -0.012693207710981369, -0.013630999252200127, -0.02576945722103119, 0.01728970743715763, 0.023074958473443985, 0.01394800003618002, 0.0018458645790815353, 0.012349790893495083, -0.015348083339631557, 0.026099665090441704, 0.004754999652504921, 0.008757124654948711, 0.0033978435676544905, -0.021384291350841522, 0.0017236873973160982, 0.02425049990415573, -0.008334457874298096, 0.016642499715089798, 0.0018706301925703883, -0.002498026005923748, 0.0017583593726158142, 0.005081905983388424, 0.03748524934053421, 0.007964625023305416, 0.002258624881505966, 0.004804531112313271, -0.0029900362715125084, 0.002839791588485241, 0.03745883330702782, 0.001320007722824812, -0.01822749897837639, 0.0098666250705719, -0.007707062177360058, -0.037353165447711945, 0.01744820736348629, -0.024039166048169136, -0.03362841531634331, -0.01717083342373371, -0.033601999282836914, 0.002547557232901454, -0.008942041546106339, 0.03341708332300186, 0.030511248856782913, -0.010797812603414059, 0.006082437466830015, 0.011986562050879002, 0.021846583113074303, -0.0062574478797614574, 0.007522145751863718, -0.003975708037614822, 0.062026333063840866, -0.02228245697915554, -0.021450333297252655, 0.003222833154723048, 0.01394800003618002, -0.00386343733407557, -0.030537666752934456, 0.03175283223390579, 0.021225791424512863, 0.0158632081001997, -0.019508708268404007, -0.018887916579842567, -0.016800999641418457, 0.01666891574859619, -0.0027473331429064274, -0.014172540977597237, -0.02599399909377098, -0.0077004581689834595, 0.02069745771586895, -0.019971000030636787, -0.002460052026435733, -0.014093291014432907, 0.0216616652905941, 0.03082824870944023, 0.012277145870029926, 0.002938854042440653, 0.0015982083277776837, -0.03803999722003937, -0.012495082803070545, -0.006505103781819344, -0.0004119348886888474, -0.002050593728199601, -0.0016485650558024645, -0.007971229031682014, -0.003998822998255491, -0.02579587511718273, 0.019284166395664215, 0.02502979151904583, 0.016312291845679283, -0.019720040261745453, 0.041685499250888824, 0.0023279685992747545, 0.03819849714636803, -0.024752415716648102, -0.010276082903146744, -0.008598624728620052, -0.028028082102537155, -0.03706258162856102, 0.005134739447385073, -0.010236457921564579, 0.027341248467564583, -0.01301681250333786, 0.03048483282327652, 0.003349963342770934, -0.004167228937149048, 0.008321249857544899, -0.02611287496984005, 0.02178054116666317, -0.016378333792090416, -0.005597031209617853, -0.03645499795675278, 0.02308816649019718, 0.026667624711990356, 0.04147416725754738, 0.005597031209617853, 0.010659124702215195, -0.03640216588973999, 0.010427978821098804, 0.01616699993610382, 0.01829354092478752, 0.01553299929946661, 0.018016166985034943, -0.017012333497405052, -0.02011629194021225, -0.021305041387677193, -0.0029850832652300596, -0.039440080523490906, -0.010137395933270454, 0.026218540966510773, -0.025901541113853455, 0.02747333236038685, -0.022467374801635742, 0.0020522447302937508, 0.043772414326667786, 0.029375333338975906, -0.025320373475551605, 0.024461831897497177, 0.03415675088763237, 0.003952593542635441, 0.01059968676418066, -0.0031799061689525843, 0.004593197721987963, -0.011411999352276325, -0.011643145233392715, -0.01040816679596901, -0.007436291314661503, 0.009417541325092316, -0.0011829712893813848, -0.01570470817387104, -0.031092416495084763, -0.006412645801901817, -0.0119931660592556, -0.020129499956965446, -0.005398906301707029, 0.003866739571094513, 0.00907412450760603, 0.025756249204277992, -0.0032013696618378162, -0.017923707142472267, -0.03341708332300186, -0.01507070753723383, -0.02266549877822399, -0.012250728905200958, 0.025241123512387276, -0.01702554151415825, 0.014383874833583832, -0.007905187085270882, -0.014727291651070118, 0.015519791282713413, -0.0038304165937006474, 3.472347088973038e-05, 0.008836374618113041]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
"2. Background: Attention Inference-Time
Workflow
The LLM attention inference-time workflow involves two
phases: i) the prefill phase, where the input prompt is used to
generate KV cache for each transformer layer of LLMs; and
ii) the decoding phase, where the model uses and updates
KV cache to generate the next token, one at a time.
Prefill Phase. LetX∈Rb×lprompt×dbe the input tensor,
where bis the batch size, lprompt is the length of the input
prompt, and dis the model hidden size. For convenience,
we ignore the layer index here. The key, value tensors can
be computed by
XK=XW K,XV=XW V,
whereWK,WV∈Rd×dare the key and value layer weight,
respectively. After obtaining XKandXV, they are cached
in the memory for the ease of decoding.
2
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
Decoding Phase. Lett∈Rb×1×dbe the current input
token embedding. Let tK=tWKandtV=tWVbe the
key and value layer output, respectively. We first update KV
cache:
XK←Concat (XK,tK),
XV←Concat (XV,tV),
then calculate the attention output as:
tQ=tWQ,
A=Softmax (tQX⊤
K),
tO=AXV, (1)
whereWQis the weight matrix of the query layer. For ease
of illustration, we ignore the attention output layer and the
other parts of the inference workflow.
Memory and Speed Analysis. The above process is re-
peated until a special token indicating the sentence’s con-
clusion is reached. Let lgenbe the number of generated
tokens. From the above analysis, the shape of KV cache is
b×(lprompt +lgen)×d. To get a sense of the scale, consider
the OPT-175B model with a batch size b512, a prompt
length lprompt 512, and an output length lgen32. The KV
cache requires 1.2TB, which is 3.8 times the model weights
(Sheng et al., 2023). Besides the memory, the inference
speed is also decided by the KV cache size. The GPU needs
to load KV cache from GPU main memory to GPU SRAM
once for every token generated during which the computa-
tional core of the chip is essentially idle (Pope et al., 2023;
Kwon et al., 2023a).
3. Methodology
In scenarios with long contexts or batched inferences, the
memory and speed bottlenecks are storing and loading KV
cache size. The most simple and effective way to alleviate
this problem is to reduce the total bytes occupied by KV
cache, specifically, quantization. Following this motivation,
we first evaluate the performance of the existing quantiza-
tion method in Section 3.1. Our observations suggest that
key and value cache should be quantized along different
dimensions. We analyze the rationale behind this observa-
tion in Section 3.2. Then based on the analysis, we propose
KIVI , a new KV cache quantization method along with its
streaming data structure, detailed in Section 3.3.
3.1. Preliminary Study of KV Cache Quantization
As we analyzed Section 2, KV cache functions as a stream-
ing data structure, where the new tensor arrives sequentially.
Thus, optimization-based methods like GPTQ (Frantar et al.,
2022) are unsuitable for quantizing KV cache due to theTable 1: The results of simulated KV cache group-wise
quantization with various configurations. The group size
is set as 32. Cstands for per-channel quantization and T
stands for per-token quantization. Please check the whole
evaluation in Table 3.
Llama-2-13B CoQA TruthfulQA
16bit 66.37 29.53
4bit (K - T, V -T) 66.48 29.51
2bit (K - T, V -T) 52.93 24.98
2bit (K - C, V -C) 2.88 0.74
2bit (K - T, V -C) 2.80 0.26
2bit (K - C, V -T) 63.53 28.60
overhead. To the best of our knowledge, the most flexible
way for quantizing KV cache is the round-to-nearest quan-
tization.","[-0.0025517288595438004, 0.02312977984547615, -0.0052392552606761456, -0.02037593349814415, -0.004910815041512251, 0.006562490947544575, 0.034839943051338196, 0.026123639196157455, -0.03259138762950897, 0.01816527731716633, 0.049190256744623184, 0.04825546592473984, -0.04110557213425636, 0.03542102873325348, -0.009417395107448101, -0.004598164930939674, 0.009581615217030048, -0.021588636562228203, -0.03029230609536171, -0.01033323910087347, -0.0285995751619339, -0.04944290593266487, 0.006777240429073572, 0.03554735332727432, 0.05093351751565933, -0.047042764723300934, -0.029357513412833214, -0.013200775720179081, 0.024721452966332436, -0.05846238136291504, 0.02283923700451851, -0.017091531306505203, -0.06568806618452072, -0.07538969069719315, -0.0037770639173686504, 0.03607790917158127, -0.014110302552580833, 0.005899293813854456, -0.024835143238306046, 0.00033949362114071846, 0.039160195738077164, -0.025870993733406067, -0.06427325308322906, 0.00816679559648037, 0.046587999910116196, 0.05070613697171211, -0.012903915718197823, -0.013415524736046791, -0.08367649465799332, 0.010465878061950207, -0.0038781226612627506, 0.050428226590156555, -0.08251432329416275, -0.015499858185648918, 0.02573203854262829, 0.003726534778252244, 0.00625615706667304, -0.02410246804356575, 0.04201510176062584, 0.00197380012832582, 0.03072180412709713, -0.067406065762043, -0.006859350483864546, 0.014072406105697155, -0.011855433695018291, 0.009190013632178307, -0.023167677223682404, 0.033627238124608994, -0.0031865029595792294, -0.01725575141608715, -0.0015593020943924785, 0.06503118574619293, 0.01076273713260889, -0.00429183105006814, -0.006420377176254988, 0.0364568792283535, 0.0025438335724174976, 0.02599731646478176, 0.04481947422027588, -0.016560973599553108, 0.027816370129585266, -0.0375937893986702, 0.027866899967193604, -0.017836837098002434, 0.020502256229519844, -0.010150070302188396, -0.02602258138358593, -0.011425934731960297, -0.02945857308804989, -0.03299562260508537, -0.04373309388756752, 0.04406153783202171, -0.048508111387491226, 0.005245571490377188, 0.036128439009189606, 0.010219547897577286, 0.03696217015385628, -0.03554735332727432, 0.002139599295333028, -0.0038718064315617085, 0.019137967377901077, 0.023635072633624077, 0.0635153129696846, -0.02983754314482212, 0.06482907384634018, -0.015285108238458633, -0.011343824677169323, 0.04216668754816055, -0.033349327743053436, -0.026275228708982468, -0.036760054528713226, 0.00498029263690114, -0.03587579354643822, 0.02444354072213173, 0.009568983688950539, -0.06346478313207626, -0.0524999275803566, -0.024140365421772003, -0.006764607969671488, -0.005397159140557051, -0.02794269472360611, 8.581096335547045e-05, 0.014388213865458965, 0.0015703553799539804, -0.010377451777458191, -0.03749272972345352, 0.03132815659046173, -0.050226107239723206, 0.0069540925323963165, -0.02582046389579773, 0.02304135449230671, 0.0021474945824593306, 0.052904162555933, 0.011154339648783207, -0.0030538635328412056, -0.025630978867411613, -0.012013337574899197, 0.06103937700390816, -0.015487225726246834, 0.008526816964149475, -0.028473252430558205, -0.02963542565703392, 0.036608465015888214, 0.0015435117529705167, -0.043808888643980026, 0.018392659723758698, -0.05396527424454689, 0.04004445672035217, 0.004279198590666056, -0.0035370499826967716, -0.01621990092098713, -0.010667995549738407, -0.013996611349284649, -0.0313534215092659, -0.03514311835169792, -0.008975263684988022, -0.02817007526755333, 0.024746717885136604, 0.030544951558113098, -0.007970994338393211, 0.006562490947544575, 0.000920580409001559, 0.06811347603797913, -0.02753845974802971, 0.0015048251952975988, -0.00608246261253953, -0.07346957921981812, -0.002528043230995536, -0.05361156910657883, -0.03499152883887291, 0.005574011709541082, -0.019011642783880234, -0.009846894070506096, -0.019479040056467056, -0.004932921379804611, -0.01440084632486105, -0.03941284120082855, -0.009107903577387333, -0.005362420342862606, -0.011748058721423149, -0.06811347603797913, 0.04643641412258148, 0.0014511379413306713, 0.06144360825419426, -0.016030415892601013, -0.009392131119966507, 0.0062624732963740826, 0.02814481221139431, -0.012594424188137054, 0.03617896884679794, -0.015563019551336765, 0.01147646363824606, 0.07872462272644043, 0.031176568940281868, 0.013428157195448875, -0.013087084516882896, -0.0002222499024355784, -0.010465878061950207, -0.01771051436662674, -0.015916723757982254, 0.020843328908085823, 0.0038686483167111874, 0.01375659741461277, -0.08953788876533508, 0.035471558570861816, -0.010491142980754375, -0.01779893971979618, -0.00792678166180849, -0.0520956926047802, -0.0019027433590963483, -0.006433009635657072, 0.028245870023965836, 0.0431014783680439, 0.004370782990008593, 5.828878784086555e-06, 0.023774027824401855, -0.04244459792971611, 0.014261890202760696, -0.033627238124608994, 0.032490331679582596, 0.010206915438175201, 0.023319264873862267, 0.013680803589522839, -0.003751799464225769, -0.07256004959344864, 0.04967028647661209, -0.026073111221194267, -0.025289906188845634, 0.02556781843304634, -0.02530253864824772, 0.03307141736149788, -0.0017890525050461292, 0.000959266908466816, -0.02877642773091793, 0.0021032814402133226, -0.033399857580661774, -0.003565472550690174, -0.031277626752853394, -0.01621990092098713, -0.046385884284973145, -0.020098023116588593, -0.004430786706507206, -0.005880345590412617, 0.0010990119772031903, -0.02794269472360611, 0.017723146826028824, -0.02733634226024151, -0.03665899485349655, 0.054723214358091354, -0.010844848118722439, -0.035294704139232635, -0.017419971525669098, -0.058361321687698364, -0.00510029960423708, -0.047649115324020386, -0.00730779767036438, 0.04438997805118561, 0.029306985437870026, -0.0004808177181985229, 0.03928652033209801, -0.000840049353428185, -0.04249512776732445, -0.00954371877014637, -0.008154163137078285, -0.022043399512767792, -0.01299865823239088, -0.01195017620921135, 0.004007603973150253, -0.03534523397684097, -0.055784329771995544, 0.009556351229548454, -0.03390514850616455, 0.0033980943262577057, -0.013150245882570744, -0.01086379587650299, 0.02109597623348236, 0.009537402540445328, -0.021765489131212234, -0.02516358345746994, 0.03261665254831314, -0.01312498189508915, -0.004096030257642269, 0.04631008952856064, 0.0008072842610999942, 0.0076804510317742825, -0.011602787300944328, 0.0012711272574961185, 0.024633025750517845, -0.004939237609505653, -0.025378333404660225, 0.04474367946386337, -0.01581566594541073, 0.020653845742344856, -0.018013689666986465, -0.017521029338240623, 0.019352715462446213, -0.03307141736149788, -0.028043752536177635, 0.015664078295230865, 0.0012261247029528022, 0.033399857580661774, 0.011438567191362381, 0.01886005513370037, 0.018304232507944107, -0.025441493839025497, 0.03448623791337013, 0.025630978867411613, 0.01676308922469616, -0.023483484983444214, 0.024089835584163666, 0.01592935621738434, 0.030039658769965172, 0.000997953349724412, 0.039968665689229965, -0.054318979382514954, -0.026502609252929688, 0.021790754050016403, -0.028195340186357498, 0.042318277060985565, 0.004936079494655132, 0.03026704117655754, -0.07650133967399597, -0.011912278831005096, 0.005128722172230482, 0.029332250356674194, -0.024544600397348404, -0.042798303067684174, 0.007149893790483475, 0.011242765933275223, -0.02688157930970192, 0.004339202307164669, 0.01567671075463295, 0.023180309683084488, -0.020199080929160118, -0.05906873196363449, -0.015045094303786755, -0.012341777794063091, 0.02450670301914215, 0.0066003878600895405, -0.013491318561136723, -0.06877035647630692, 0.004579216241836548, 0.007768877316266298, -0.008217324502766132, -0.014805080369114876, 0.0643237754702568, 0.061948902904987335, 0.01985800825059414, 0.06250472366809845, -0.028296399861574173, 8.516947855241597e-05, -0.020527521148324013, 0.024355115368962288, -0.06932617723941803, 0.03554735332727432, 0.0028264818247407675, 0.029079603031277657, -0.02726054936647415, -0.04992293193936348, -0.005523482337594032, -0.016068313270807266, 0.014426110312342644, 0.05649174004793167, 0.005321365315467119, -0.006853034254163504, -0.004313937854021788, -0.021828651428222656, -0.007219371385872364, 0.018923217430710793, -0.0046044811606407166, -0.008874205872416496, 0.01771051436662674, -0.011097494512796402, -0.04876076057553291, -0.021171770989894867, -0.057906560599803925, 0.03903387114405632, 0.060079317539930344, 0.027235284447669983, 0.02235920913517475, 0.05517797917127609, 0.01429978758096695, -0.008867889642715454, 0.006486696656793356, 0.04047395661473274, 0.002916487166658044, 0.006268789526075125, 0.01160910353064537, -0.07741086184978485, 0.01750839687883854, -0.025972051545977592, 0.009802681393921375, -0.0019216918153688312, 0.023167677223682404, 0.003953916486352682, 0.033399857580661774, 0.015803033486008644, 0.012322829104959965, 0.03307141736149788, 0.04335412755608559, 0.02455723285675049, 0.0048981825821101665, -0.04135821759700775, -0.0017369441920891404, 0.009284756146371365, -0.01793789677321911, 0.03943810611963272, 0.007566760294139385, 0.03072180412709713, 0.010737473145127296, 0.04272250831127167, -0.03908440098166466, 0.03476414829492569, -0.052146222442388535, 0.02078016847372055, -0.002678052056580782, 0.0056371730752289295, 0.023117147386074066, 0.022447634488344193, 0.07245899736881256, -0.018177909776568413, 0.0006675391923636198, -0.05901820585131645, -0.04843232035636902, -0.024241425096988678, 0.018190542235970497, -0.02945857308804989, -0.04797755554318428, 0.026098376139998436, -0.03428411856293678, -0.037846434861421585, -0.01255021058022976, -0.015171417966485023, -0.004326569847762585, -0.005460320971906185, -0.00038804911309853196, -0.03579999879002571, 0.026932109147310257, -0.015916723757982254, -0.04047395661473274, -0.03964022174477577, -0.04239406809210777, -0.009038425981998444, 0.00603193324059248, -0.03276824206113815, 0.036760054528713226, 0.0026433132588863373, -0.04300042241811752, 0.0643237754702568, -0.05146407708525658, 0.03213662654161453, 0.020312773063778877, 0.055329564958810806, -0.005450846627354622, 0.029711218550801277, -0.07084205746650696, 0.07190316915512085, -0.006973041221499443, 0.008501552045345306, -0.011110126040875912, 0.002027487615123391, 0.01928955502808094, -0.03516838327050209, 0.011583838611841202, 0.01920112781226635, 0.010604833252727985, -0.001705363392829895, 0.01757155917584896, 0.02504989318549633, 0.000759518297854811, -0.012916548177599907, -0.040019191801548004, 0.0017906315624713898, -0.02235920913517475, -0.0533083938062191, -0.028852220624685287, 0.035496823489665985, -0.01759682409465313, -0.008457339368760586, -0.018582144752144814, 0.04368256777524948, -0.02550465613603592, -0.013781862333416939, 0.011716477572917938, -0.003748641349375248, 0.06103937700390816, 0.05714862048625946, 0.0034012524411082268, 0.04006972163915634, -0.02945857308804989, -0.03622949868440628, -0.014527169056236744, 0.0087289335206151, -0.012499681673943996, 0.007427804637700319, 0.030620746314525604, -0.008861573413014412, 0.003407568670809269, 0.02966069057583809, -0.03183344751596451, 0.01856951229274273, 0.03163133189082146, 0.04209089279174805, 0.02940804325044155, -0.005112932063639164, 0.055380094796419144, 0.06093831732869148, 0.007535179611295462, -0.006199311465024948, 0.028523780405521393, 0.019213760271668434, 0.002706474857404828, -0.027210019528865814, 0.015247211791574955, -0.011905962601304054, 0.030873393639922142, 0.018190542235970497, 0.025870993733406067, -0.02012328803539276, 0.022447634488344193, -0.022548692300915718, -0.025744671002030373, 0.0021885496098548174, -0.022990824654698372, -0.004831862635910511, -0.0066003878600895405, -0.04865970090031624, -0.12116922438144684, -0.024607760831713676, -0.0520956926047802, 0.021689696237444878, -0.018076851963996887, -0.044667888432741165, 0.02078016847372055, -0.01642201654613018, -0.007585708983242512, 0.004197088535875082, -0.019276922568678856, -0.005678228102624416, 0.02796795964241028, -0.0061645726673305035, -0.004430786706507206, 0.011173288337886333, 0.03130289167165756, -0.006420377176254988, 0.00419077230617404, 0.04158560186624527, -0.03554735332727432, -0.017041001468896866, 0.02708369679749012, 0.011286978609859943, -0.030014395713806152, 0.0017337860772386193, -0.01491877157241106, -0.005551904905587435, 0.030165983363986015, 0.02708369679749012, 0.018152644857764244, -0.037644315510988235, -0.0005735863232985139, 0.035067323595285416, 0.002744371769949794, -0.001372185884974897, -0.033576708287000656, -0.027033166959881783, -0.0028959596529603004, 0.02080543339252472, -0.018733732402324677, 0.006129833869636059, 0.040221311151981354, -0.029685955494642258, -0.018923217430710793, 0.01653570868074894, -0.03046915866434574, 0.029104867950081825, 0.0007397803128696978, 0.0046960655599832535, 0.005213990341871977, 0.01199438888579607, 0.025037260726094246, -0.020729638636112213, -0.017836837098002434, -0.012171241454780102, -0.019074805080890656, -0.028624840080738068, 0.0018569511594250798, 0.007699399720877409, 0.01513352058827877, -0.018822157755494118, 0.0020306457299739122, 0.0003069259400945157, -0.029483838006854057, 0.017344176769256592, 0.0036002115812152624, -0.03562314435839653, 0.004225511569529772, 0.008261538110673428, -0.017862102016806602, -0.028043752536177635, -0.0009861105354502797, 0.01682625152170658, 0.008236273191869259, -0.004860285669565201, -0.004853969439864159, -0.029281720519065857, 0.06811347603797913, -0.022978192195296288, 0.012733379378914833, 0.02983754314482212, -0.01691467873752117, 0.0017006262205541134, -0.02491093799471855, -0.01206386648118496, -0.009531086310744286, -0.032742977142333984, -0.027892164885997772, -0.046209029853343964, -0.036760054528713226, 0.03112603910267353, -0.018354762345552444, 0.04080239683389664, -0.03153027221560478, -0.0007974152686074376, -0.001669045421294868, 0.011160655878484249, 0.02753845974802971, -0.016699928790330887, -0.03650740906596184, -0.02550465613603592, 0.0008613663958385587, -0.05153987184166908, -0.00026626564795151353, -0.012461785227060318, 0.029534365981817245, -0.0016232532216235995, 0.008451023139059544, 0.01702836900949478, 0.00370442820712924, 0.017521029338240623, 0.013996611349284649, 0.038882285356521606, 0.018064219504594803, -0.0037833801470696926, -0.03236400708556175, 0.017129426822066307, -0.011956491507589817, 0.012960761785507202, 0.030873393639922142, -0.01557565201073885, -0.02410246804356575, -0.028195340186357498, -0.05467268452048302, 0.050832461565732956, 0.02364770509302616, 0.01848108507692814, -0.021272828802466393, -0.01811474934220314, -0.032970357686281204, -0.0021364414133131504, -0.002104860497638583, -0.029509102925658226, -0.04183824732899666, -0.024430908262729645, -0.004127610940486193, 0.01322604063898325, 0.041914042085409164, 0.002728581428527832, -0.008223640732467175, -0.016055680811405182, 0.0003767984453588724, -0.02518884837627411, 0.014249257743358612, 0.029787013307213783, -0.010453245602548122, -0.0001311590167460963, 0.012556526809930801, -0.01067431177943945, -0.014236626215279102, -0.020476993173360825, 0.03193450719118118, -0.049190256744623184, 0.0013871868140995502, -0.046815380454063416, -0.02496146596968174, 0.0017922105034813285, -0.007648870348930359, 0.03610317409038544, -0.013213408179581165, 0.005068718921393156, -0.036583200097084045, -0.00583929056301713, 0.010535355657339096, -0.002442775061354041, -0.045299503952264786, -0.0407518669962883, 0.035698939114809036, 0.0006935934070497751, 0.030822863802313805, 0.00015484461619053036, -0.026831049472093582, -0.007181474473327398, 0.0006643811357207596, -0.04481947422027588, -0.002978069707751274, -0.02665419690310955, -0.036128439009189606, -0.021184401586651802, 0.017735779285430908, 0.06139308214187622, -0.025896258652210236, -0.018847422674298286, -0.01364290714263916, 0.010876428335905075, 0.012960761785507202, -0.02364770509302616, 0.014552433975040913, -0.016459913924336433, 0.035471558570861816, 0.0013627116568386555, -0.018291600048542023, -0.019971700385212898, 0.019870640709996223, -0.021335991099476814, -0.027159489691257477, 0.001366659183986485, -0.005735073704272509, -0.033576708287000656, 0.009088954888284206, 0.02353401482105255, 0.04411206394433975, 0.010099540464580059, 0.03731587529182434, 0.02071700617671013, -0.014047141186892986, -0.020565418526530266, 0.0025248851161450148, -0.05906873196363449, -0.003638108493760228, -0.02796795964241028, -0.024342482909560204, -0.025011995807290077, -0.021626533940434456, 0.033121947199106216, 0.03089865669608116, 0.011495412327349186, 0.004910815041512251, 0.005210832227021456, -0.0060256170108914375, 0.0040170783177018166, -0.028473252430558205, 0.0028043752536177635, 0.010870112106204033, 0.0007172789773903787, -0.007383591495454311, 0.03428411856293678, -0.013137614354491234, 0.029685955494642258, -0.03478941321372986, -0.0028359561692923307, 0.00895631592720747, -0.009215278550982475, -0.01309971697628498, 0.0010753263486549258, 0.016320958733558655, 0.014135567471385002, -0.015082991681993008, -0.020931756123900414, -0.02055278606712818, 0.022106561809778214, -0.005757180508226156, -0.010908009484410286, 0.00017991189088206738, -0.022599222138524055, 0.03504205867648125, 0.0396149605512619, -0.05568327009677887, 0.0020006438717246056, -0.022485531866550446, 0.00806573685258627, 0.029509102925658226, -0.001080852933228016, -0.016043048352003098, -0.0260478463023901, -0.03941284120082855, -0.008248905651271343, 0.008507868275046349, -0.0011163813760504127, 0.021045446395874023, -0.01894848234951496, -0.012505997903645039, -0.007326746359467506, -0.022763442248106003, 0.003963390830904245, -0.017558926716446877, -0.0050466121174395084, 0.04198983684182167, -0.007206739392131567, -0.09059900790452957, -0.02877642773091793, 0.02902907319366932, 0.017849469557404518, 0.019959067925810814, -0.004433944821357727, -0.017584191635251045, -0.023887719959020615, 0.012025970034301281, -0.02089385874569416, 0.012253351509571075, -0.010093224234879017, 0.023496117442846298, -0.029989130795001984, -0.014779815450310707, -0.04312674328684807, -0.018177909776568413, 0.013213408179581165, 0.019327450543642044, -0.006035091355443001, -0.012600740417838097, 0.012733379378914833, 0.006180363241583109, 0.0071435775607824326, -0.011343824677169323, -0.013946082442998886, -0.007749929092824459, -0.019441142678260803, 0.0021790754981338978, 0.0027901639696210623, -0.02568150870501995, -0.015424064360558987, -0.008526816964149475, 0.027159489691257477, -0.04865970090031624, -0.008943683467805386, -0.009366866201162338, 0.018531614914536476, 0.026527874171733856, -0.02902907319366932, 0.0075288633815944195, -0.05442003905773163, 0.01639675348997116, -0.010939589701592922, 0.04671432450413704, -0.03266718238592148, 0.015272475779056549, 0.009392131119966507, 0.008836308494210243, -0.016497811302542686, 0.00451289676129818, 0.0038433836307376623, 0.017584191635251045, 0.0006533278501592577, 0.01322604063898325, 0.023117147386074066, 0.01451453659683466, -0.010339554399251938, -0.01395871490240097, 0.004181298427283764, -0.01730627939105034, 0.026932109147310257, 0.008861573413014412, -0.004951870068907738, -0.0288016926497221, -0.0375937893986702, 0.016573606058955193, 0.039539165794849396, 0.030393363907933235, -0.0349157340824604, -0.04663852974772453, 0.017331544309854507, -0.023407690227031708, -0.003172291675582528, -0.00544453039765358, 0.0076236058957874775, 0.007882568053901196, 0.0037170604337006807, -0.055531684309244156, 0.024544600397348404, 0.049594491720199585, -0.026325756683945656, 0.023192942142486572, 0.02240973711013794, 0.02275080978870392, 0.026098376139998436, 0.04209089279174805, -0.02857431024312973, -0.02642681635916233, 0.014211361296474934, 0.026123639196157455, -0.04289936274290085, 0.0025659401435405016, 0.0013319203862920403, 0.04777543991804123, 0.0015229842392727733, 0.02421616017818451, 0.0016185161657631397, -0.002308556577190757, -0.0038875967729836702, 0.031176568940281868, 0.02066647820174694, 0.01662413403391838, -0.0968141108751297, 0.00851418450474739, 0.013011290691792965, 0.004361308645457029, -0.008760514669120312, 0.04037289693951607, -0.021045446395874023, 0.009966901503503323, 0.009790048934519291, 0.030797598883509636, 0.04929131641983986, -0.00578876119107008, 0.0426972471177578, 0.02536570094525814, 0.018632672727108, 0.039337046444416046, -0.02576993592083454, 0.011552257463335991, 0.024228792637586594, -0.007983626797795296, -0.037442199885845184, -0.01613147370517254, -0.008589978329837322, 0.025630978867411613, 0.022081296890974045, -0.01258179172873497, -0.002674893941730261, -0.007749929092824459, 0.04769964516162872, 0.022106561809778214, 0.026553139090538025, -0.0043581509962677956, 0.0025217270012944937, -0.019213760271668434, -0.0009766363073140383, -0.022397104650735855, 0.020224345847964287, -0.004639219958335161, 0.03453676402568817, 0.03153027221560478, 0.013364995829761028, -0.04365730285644531, 0.014072406105697155, 0.02306661754846573, -0.024254055693745613, -0.016030415892601013, 0.0013485002564266324, 0.02814481221139431, -0.03352617844939232, 0.021272828802466393, 0.015424064360558987, 0.007712032180279493, 0.02482251077890396, -0.0162830613553524, -0.01980748027563095, 0.03140395134687424, 0.05199463292956352, 0.0050497702322900295, 0.014388213865458965, 0.0027522670570760965, 0.01662413403391838, 0.02685631439089775, -0.007749929092824459, -0.013895553536713123, -0.010270076803863049, -0.0023053986951708794, 0.031176568940281868, -0.009158432483673096, -0.018986377865076065, 0.050680872052907944, 0.039968665689229965, 0.041055042296648026, 0.031227096915245056, -0.016030415892601013, -0.022738177329301834, 0.03236400708556175, -0.00011566469038370997, -0.0009008424240164459, 0.0041212947107851505, -0.02384982258081436, -0.017091531306505203, 0.012828121893107891, 0.019782215356826782, 0.015424064360558987, -0.007516230922192335, 0.042343541979789734, 0.0056845443323254585, 0.019074805080890656, 0.006347741466015577, -0.03367776796221733, 0.015954621136188507, 0.01354184839874506, -0.004579216241836548, 0.005858238786458969, 0.012746011838316917, -0.01719258911907673, 0.019390612840652466, -0.026932109147310257, 0.019731685519218445, -0.015600916929543018, -0.012322829104959965, -0.011602787300944328, 0.02983754314482212, -0.0029954391065984964, -0.020881226286292076, 0.009448976255953312, 0.014122935011982918, -0.01685151644051075, 0.0021917077247053385, -0.03739167004823685, 0.04140874743461609, -0.021651798859238625, 0.0012932338286191225, 0.00040541854104958475, -0.015184049494564533, -0.01599251851439476, -0.0024080362636595964, -0.03327353298664093, 0.007560444064438343, -0.027588989585638046, 0.0019453774439170957, -0.03724008426070213, -0.00982794538140297, 0.02943330816924572, -0.01762208715081215, -0.008488919585943222, 0.03299562260508537, -0.018380027264356613, 0.022536061704158783, -0.023635072633624077, -0.010958538390696049, -0.033627238124608994, 0.01109117828309536, -0.024633025750517845, -0.04734594002366066, -0.01633359119296074, -0.006518277805298567, 0.01816527731716633, 0.02046436071395874, 0.013794494792819023, 0.006581439170986414, -0.043429918587207794, -0.0070488350465893745, -0.008343648165464401, 0.05477374419569969, -0.0035023109521716833, 0.008293119259178638, 0.004133927170187235, 0.006865666713565588, 0.033399857580661774, -0.03193450719118118, 0.019213760271668434, -0.009202646091580391, 0.03590105473995209, 0.04143401235342026, 0.028018487617373466, -0.006840401794761419, -0.01278390921652317, 0.0008518921677023172, 0.011887013912200928, -0.015600916929543018, -0.0060256170108914375, -0.021803386509418488, -0.01836739480495453, 0.007440437097102404, 0.019617995247244835, 0.009676357731223106, -0.028624840080738068, 0.0313534215092659, 0.0017448393628001213, 0.03731587529182434, -0.005135038401931524, 0.014792447909712791, -0.015499858185648918, -0.010263760574162006, 0.03307141736149788, -0.021740224212408066, -0.03322300314903259, -0.011931227520108223, -0.007105680648237467, 0.004844495095312595, 0.001111644203774631, -0.01601778343319893, -0.020628580823540688, -0.006442483980208635, 0.03779590502381325, -0.005160303320735693, 0.0008787358528934419, 0.02206866443157196, 0.011457514949142933, 0.009682673960924149, 0.014464007690548897, -0.01491877157241106, -0.01416083239018917, 0.008008891716599464, 0.015941988676786423, -0.042520392686128616, -0.0018001057906076312, 0.020527521148324013, 0.03587579354643822, 0.0014558749971911311, 0.02961016073822975, 0.025719406083226204, -0.0016153580509126186, -0.01570197567343712, -0.010573253035545349, 0.014830345287919044, 0.018127379938960075, 0.03259138762950897, 0.016093576326966286, 0.023887719959020615, -0.00022935557353775948, 0.001428241841495037, 0.01570197567343712, -0.03365250304341316, 0.020742271095514297, -0.03173239156603813, -0.0014448217116296291, 0.00848260335624218, -0.011501728557050228, 0.0023938247468322515, 0.015714608132839203, -0.04812914505600929, -0.004680274985730648, -0.005204516462981701, -0.0011984914308413863, 0.016687296330928802, 0.01299865823239088, 0.025782566517591476, 0.008792095817625523, 0.013908185064792633, -0.039387576282024384, -0.00985952652990818, -0.007743612863123417, 0.003274929244071245, 0.0007468860130757093, 0.0027854267973452806, 0.024228792637586594, -0.006196153350174427, -0.01503246184438467, -0.012644953094422817, -0.010914325714111328, 0.002068542642518878, 0.0004914762685075402, 0.02220761962234974, 0.0044623673893511295, -0.02270028181374073, 0.055380094796419144, -0.014640860259532928, -0.017470499500632286, -0.011015384458005428, -0.01802632212638855, 0.018935849890112877, 0.01808948442339897, 0.008015207946300507, -0.03969075158238411, 0.003792854491621256, -0.010383768007159233, 0.017003104090690613, -0.008229956962168217, 0.02240973711013794, -0.003366513643413782, -0.022712912410497665, -0.007585708983242512, 0.022220252081751823, 0.01302392315119505, 0.002625943860039115, 0.02854904532432556, -0.004642378073185682, -0.01481771282851696, -0.01243652030825615, -0.0290038101375103, 0.011312243528664112, -0.012986025772988796, 0.034663088619709015, 0.016560973599553108, 0.0011882276739925146, -0.0039191776886582375, -0.037871699780225754, -0.0368611142039299, -0.023710867390036583, 0.02046436071395874, 0.011842801235616207, -0.019769582897424698, 0.035067323595285416, -0.007333062589168549, -4.591552715282887e-05, 0.011798587627708912, 0.016459913924336433, -0.018872687593102455, 0.008059420622885227, -0.023685602471232414, 0.0046486943028867245, 0.008173111826181412, -0.013807127252221107, 0.007756245322525501, -0.0021774964407086372, 0.02258658967912197, 0.012278616428375244, 0.020641213282942772, -0.004156033508479595, 0.027765842154622078, -0.0513630174100399, 0.0023969828616827726, 0.016093576326966286, 0.017533661797642708, 0.005630857311189175, -0.026578404009342194, -0.031100774183869362, -0.02186654694378376, -0.00806573685258627, -0.03393041342496872, -0.03749272972345352, -0.019327450543642044, 0.03504205867648125, -0.010636414401233196, -0.020843328908085823, -0.0018948481883853674, -0.0017195746768265963, -0.006161414552479982, -0.005952981300652027, -0.0019911695271730423, 0.014653492718935013, -0.0004425260121934116, 0.01836739480495453, 0.01268285047262907, 0.043202538043260574, -0.009139484725892544, 0.019125334918498993, -0.020426463335752487, -0.010358503088355064, 0.002891222480684519, 0.008867889642715454, 0.048053350299596786, -0.03180818632245064, 0.0063666896894574165, 0.02791742980480194, -0.025555185973644257, 0.011760691180825233, 0.009600563906133175, 0.0025659401435405016, -0.0029022758826613426, -0.024607760831713676, 0.006054040044546127, -0.037037964910268784, 0.007415172643959522, -0.004174982197582722, -0.04398574307560921, -0.00544453039765358, 0.004244459792971611, -0.0036949538625776768, 0.02642681635916233, 0.0056719123385846615, -0.056592799723148346, -0.021790754050016403, 0.05649174004793167, 0.028498515486717224, 0.012607056647539139, -0.02080543339252472, -0.023003457114100456, 0.01126171462237835, -0.030115453526377678, 0.036583200097084045, -0.01920112781226635, 0.01834212988615036, -0.0029370146803557873, 0.00546663673594594, 0.0030901816207915545, 0.0017290489049628377, 0.006145624443888664, 0.016523076221346855, -0.006796188652515411, -0.01630832627415657, 0.00419077230617404, -0.007124628871679306, -0.04216668754816055, -0.03691164404153824, -0.004484474193304777, -0.030039658769965172, 0.014678756706416607, 0.00821100827306509, 0.016182003542780876, 0.014085037633776665, -0.008949999697506428, -0.014337684027850628, -0.014034508727490902, 0.006909879855811596, 0.0023922459222376347, 0.01739470660686493, -0.016800986602902412, 0.02407720312476158, 0.015095624141395092, 0.01565144583582878, -0.004200246650725603, 0.0051918840035796165, 0.03875596076250076, -0.030014395713806152, -0.006947776768356562, 0.01642201654613018, -0.008545765653252602, 0.020565418526530266, 0.00888683833181858, 0.01581566594541073, -0.014527169056236744, -0.010484826751053333, 0.033778827637434006, 0.027007902041077614, 0.027159489691257477, 0.013908185064792633, -0.006038249470293522, 0.0042128791101276875, 0.04903867095708847, -0.014805080369114876, -0.010579569265246391, 0.004797123838216066, 0.01949167065322399, -0.016459913924336433, 0.00677092419937253, 0.032515592873096466, 0.00708673195913434, 0.00402023596689105, -0.013200775720179081, 0.004051817115396261, -0.014072406105697155, 0.022763442248106003, -0.016687296330928802, 0.0027175280265510082, -0.016560973599553108, -0.002120650839060545, -0.0017748411046341062, 0.015323005616664886, -0.016485178843140602, 0.001028744620271027, -0.0049550277180969715, 0.012120712548494339, -0.0002479093091096729, -0.0028659577947109938, 0.002678052056580782, -0.013516583479940891, 0.038907550275325775, 0.014868241734802723, 0.023079250007867813, 0.019731685519218445, 0.008848940953612328, 0.04845758527517319, 0.017761044204235077, 0.023458220064640045, -0.013996611349284649, -0.0038244351744651794, -0.01653570868074894, -0.0325661227107048, 0.03622949868440628, 0.018291600048542023, 0.00661933608353138, 0.021904444321990013, 0.014628227800130844, -0.006373005919158459, 0.012404939159750938, -0.01822843961417675, 0.014602962881326675, 0.022851869463920593, -0.014476640149950981, -0.006344583351165056, -0.011419618502259254, -0.0025296222884207964, -0.022422369569540024, -0.027159489691257477, 0.016295693814754486, 0.021879179403185844, 0.0225234292447567, -0.009360549971461296, 0.020855961367487907, -0.027134226635098457, 0.0066003878600895405, 0.011312243528664112, 0.0017448393628001213, -0.005757180508226156, -0.027134226635098457, -0.006960408762097359, 0.03617896884679794, -0.0069983056746423244, 0.016523076221346855, 0.00947424117475748, -0.017154691740870476, -0.004740278702229261, -0.007010938134044409, 0.037214819341897964, -0.0058234999887645245, 0.006644601002335548, -0.005359262228012085, -0.0044149961322546005, 0.002346453722566366, 0.029711218550801277, 0.0077309804037213326, -0.005905610043555498, 0.00816679559648037, 0.012423887848854065, -0.029963865876197815, 0.01728101447224617, -0.022258149459958076, -0.03668425977230072, -0.027993222698569298, -0.026351021602749825, -0.005403475370258093, -0.01126171462237835, 0.025416230782866478, 0.016927311196923256, -0.02602258138358593, 0.008545765653252602, 0.007604657206684351, 0.014805080369114876, -0.007004621904343367, 0.0041655078530311584, -0.020161183550953865, 0.043581508100032806, -0.013731333427131176, -0.00878577958792448, 0.010427980683743954, -0.00661933608353138, -0.017041001468896866, -0.016093576326966286, 0.026275228708982468, 0.02667946182191372, 0.0160809438675642, 0.004872917663305998, -0.021373886615037918, -0.0014156094985082746, 0.015638813376426697, -0.0016422017943114042, -0.015310373157262802, -0.025353068485856056, 0.006871982477605343, 0.03049442358314991, -0.01768524944782257, 0.006202469579875469, -0.02484777569770813, 0.01547459326684475, 0.019100069999694824, 0.01493140310049057, 0.01599251851439476, -0.008608927018940449, -0.030165983363986015, -0.01513352058827877, 0.0032591389026492834, -0.008034156635403633, 0.0044118380174040794, 0.011154339648783207, -0.014287155121564865, -0.0052360971458256245, -0.019479040056467056, 0.014325052499771118, 0.012746011838316917, 0.013074452057480812, -0.017647352069616318, 0.03900860622525215, 0.007592024747282267, 0.040600281208753586, -0.03291982784867287, 0.011444882489740849, -0.028751162812113762, -0.024607760831713676, -0.03554735332727432, -0.001155857346020639, -0.01395871490240097, 0.027386872097849846, -0.017761044204235077, 0.04378362372517586, -6.513540574815124e-05, 0.005264519713819027, 0.0058740293607115746, -0.03170712664723396, 0.041661396622657776, -0.025946786627173424, 0.01157752238214016, -0.018177909776568413, 0.017091531306505203, 0.010636414401233196, 0.037644315510988235, 0.011084862053394318, -0.0018364236457273364, -0.027437401935458183, -0.002703316742554307, 0.012145976535975933, 0.013478687033057213, 0.011931227520108223, 0.02421616017818451, -0.008747882209718227, -0.020742271095514297, -0.01557565201073885, -0.011065913364291191, -0.0435057133436203, -0.01639675348997116, 0.024178262799978256, -0.034865207970142365, 0.011526992544531822, -0.016384121030569077, 0.013188143260776997, 0.02943330816924572, 0.04100451245903969, -0.029483838006854057, 0.030620746314525604, 0.022308679297566414, 0.014792447909712791, 0.012708115391433239, 0.004339202307164669, -0.008128898218274117, -0.011975440196692944, -0.017495764419436455, -0.01220913790166378, 0.007648870348930359, 0.008621559478342533, 0.003495994955301285, -0.007175158243626356, -0.03284403309226036, -0.02326873503625393, -0.012417571619153023, -0.027614254504442215, -0.003110709134489298, 0.03600211441516876, 0.0213486235588789, 0.02012328803539276, -0.00625615706667304, -0.017634719610214233, -0.028928015381097794, -0.03648214414715767, -0.012840754352509975, -0.0037139023188501596, 0.027412137016654015, -0.01940324530005455, -0.0022611855529248714, -0.00219644489698112, -0.004816072527319193, 0.02396351285278797, 0.009505821391940117, 0.023622440174221992, 0.015436696819961071]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
" The B−bit integer quantization-dequantization
process can be expressed as:
Q(X) =⌊X−zX
sX⌉,X′=Q(X)·sX+zX,
where zX= min Xis the zero-point, sX= (max X−
minX)/(2B−1)is the scaling factor, and ⌊·⌉is the round-
ing operation. Here we ignore the batch size for ease of
understanding. As shown in Figure 1, Xis quantized along
either the token or channel dimension group-wisely.
Considering the streaming nature of KV cache, previous
studies often apply per-token quantization to both key and
value cache since the newly quantized KV cache can be
naively added to the existing quantized one along the token
dimension (Sheng et al., 2023). While per-channel quanti-
zation is non-trivial, we have designed a padding method to
implement per-channel quantization to explore its effect on
both key and value cache.
Setting. In Table 1, we show the results of fake KV cache
group-wise quantization with different configurations on the
Llama-2-13B model for the CoQA and TruthfulQA tasks.
We use a group size of 32 for all configurations. Here fake
quantization means we simulate the quantization process
by first quantizing KV cache into lower precision and then
dequantizing it in the attention layer. For per-channel quan-
tization, if the number of tokens is not divided evenly into
groups, we add zero-padding to ensure it can be grouped
perfectly. In this way, we ensure that all tokens in KV cache
are quantized for a fair comparison. The detailed experi-
mental setting can be found in Section 4.1. Specifically, we
observe that:
OB 1. When using the commonly used per-token quanti-
zation to both key and value caches, INT4 precision can
maintain accuracy. However, reducing it to INT2 results in
3
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
050100150200Token
0255075100125
Channel0.02.55.07.510.012.5Absolute ValueLlama-2-13B Layer 16
Head 0 Key Cache
050100150200Token
0255075100125
Channel0.51.01.52.0 Absolute ValueLlama-2-13B Layer 16
Head 0 Value Cache
050100150200Token
0255075100125
Channel0.02.55.07.510.012.5Llama-2-13B Layer 31
Head 0 Key Cache
050100150200Token
0255075100125
Channel0.51.01.52.02.5Llama-2-13B Layer 31
Head 0 Value Cache
050100150200Token
0204060
Channel0246810 Absolute ValueFalcon-7B Layer 16
Head 0 Key Cache
050100150200Token
0204060
Channel0.51.01.5 Absolute ValueFalcon-7B Layer 16
Head 0 Value Cache
050100150200Token
0204060
Channel0.02.55.07.510.0Falcon-7B Layer 20
Head 0 Key Cache
050100150200Token
0204060
Channel0.51.01.5Falcon-7B Layer 20
Head 0 Value Cache
Figure 2: Magnitude of key and value cache for Llama-2-13B and Falcon-7B. We observe (1) for key cache, there are a few
channels whose magnitudes are very large. (2) for value cache, there is no obvious outlier pattern.
a notable accuracy drop.
OB 2. When value cache is quantized per-channel, the
accuracy significantly worsens regardless of how key cache
is quantized.
OB 3. When using a lower numerical precision such as
INT2, the most accurate approach is to quantize key cache
per-channel and value cache per-token.
3.2. Why Key and Value Cache Should Quantize Along
Different Dimensions?
In Table 1, we observe that quantizing key cache per-channel
and value cache per-token to 2bit results in a very small accu-
racy drop. Here we analyze why this configuration delivers
better accuracy. In Figure 2 we visualize the original KV
cache distribution at different layers. We observe that in
key cache, some fixed channels exhibit very large mag-
nitudes, whereas in value cache","[0.01234505232423544, 0.02322060614824295, -0.0005847114371135831, -0.0063055409118533134, 0.006220031529664993, 0.021637095138430595, 0.02954198233783245, 0.03585068881511688, -0.03671212121844292, -0.007125799544155598, 0.03871367871761322, 0.04370490461587906, -0.06349246203899384, 0.04253944009542465, 0.0015399644616991282, 0.026501640677452087, 0.0031179331708699465, -0.018140703439712524, -0.025146154686808586, -0.029465973377227783, -0.0164811834692955, -0.049886930733919144, -0.0002486112352926284, 0.026298951357603073, 0.030403412878513336, -0.05857723951339722, 0.0009635664755478501, -0.008012565784156322, 0.022029805928468704, -0.04238742217421532, 0.019610200077295303, -0.027261726558208466, -0.030732782557606697, -0.07205608487129211, -0.0400564968585968, 0.03699081763625145, 0.002812315709888935, -0.0029294954147189856, -0.016354503110051155, -0.019610200077295303, 0.009469396434724331, -0.025627542287111282, -0.04319818317890167, 0.004677691496908665, 0.05138176679611206, 0.04730264097452164, -0.019078141078352928, -0.025488194078207016, -0.0829506441950798, 0.023423295468091965, -0.020902346819639206, 0.05046966299414635, -0.040309857577085495, -0.01620248518884182, 0.026628321036696434, -0.008721979334950447, 0.006530399434268475, -0.017849337309598923, 0.03351976349949837, -0.00571330776438117, 0.0017862004460766912, -0.06384716928005219, -0.011350607499480247, 0.017418621107935905, 0.011046573519706726, 0.0050704022869467735, -0.02847786247730255, -0.019217489287257195, 0.02076299674808979, 0.0029564150609076023, -0.010419502854347229, 0.05497950315475464, 0.0214470736682415, 0.018102698028087616, -0.003803593572229147, 0.015657756477594376, -0.014099582098424435, 0.041703347116708755, 0.03972712531685829, -0.0030134215485304594, 0.003870100947096944, 0.005190749187022448, 0.01719059608876705, -0.03767489641904831, 0.021320393308997154, 0.0012058436404913664, -0.030504757538437843, -0.0075311786495149136, -0.019103476777672768, -0.00879798736423254, -0.01356752309948206, 0.020851673558354378, -0.040715236216783524, 0.0067774271592497826, 0.04215939715504646, -0.003184440778568387, 0.04796138405799866, 0.0018479573773220181, -0.004218473564833403, -0.026501640677452087, 0.007385495584458113, 0.024145375937223434, 0.03954977169632912, -0.03169555589556694, 0.057563792914152145, -0.033621106296777725, -0.029415301978588104, 0.04621318727731705, -0.025855569168925285, -0.02294190786778927, -0.015923786908388138, 0.0073031531646847725, -0.06582339107990265, 0.02289123646914959, -0.013542186468839645, -0.03263299539685249, -0.059286653995513916, -0.021345729008316994, -0.0025985415559262037, 0.02675500325858593, -0.01511302962899208, -0.018115365877747536, 0.019926903769373894, -0.03346908837556839, -0.009678419679403305, -0.03668678551912308, 0.03653476759791374, -0.06055346131324768, -0.0175453033298254, -0.029364628717303276, 0.0393470823764801, 0.009957117959856987, 0.03458388149738312, 0.018584085628390312, -0.008975340984761715, -0.036104053258895874, -0.00812024436891079, 0.04497171565890312, -0.039980486035346985, -0.0024639430921524763, -0.03800426423549652, -0.059286653995513916, 0.025830231606960297, -0.036458756774663925, -0.04086725413799286, 0.014188258908689022, -0.032937031239271164, 0.03169555589556694, -0.010267485864460468, -0.00013885412772651762, -0.03633207827806473, -0.01426426786929369, -0.015531076118350029, -0.03987914323806763, -0.012851775623857975, 0.0004105252446606755, 0.010938894003629684, -0.002810732228681445, 0.032911695539951324, -0.014542965218424797, -0.011084577068686485, -0.0028899076860398054, 0.06744490563869476, -0.024766113609075546, 0.02006625197827816, -0.019610200077295303, -0.08158248662948608, 0.0032176945824176073, -0.05801984667778015, -0.04413561895489693, -0.01303546316921711, 0.010881887748837471, -0.00917803030461073, -0.057969171553850174, -0.00865230429917574, -0.025906240567564964, -0.0345078743994236, -0.03063143789768219, -0.009146359749138355, -0.005402939859777689, -0.03919506445527077, 0.024550754576921463, -0.007562848739326, 0.05660101771354675, -0.015265046618878841, -0.0038162616547197104, 0.0005617505521513522, 0.009912779554724693, -0.0112872663885355, 0.04476902633905411, -0.017532633617520332, 0.03486257791519165, 0.07119465619325638, 0.025944245979189873, 0.024905461817979813, -0.039600443094968796, -0.002609626157209277, 0.032582323998212814, -0.015594417229294777, -0.016734544187784195, 0.007638857234269381, 0.009792432188987732, 0.058931946754455566, -0.06318842619657516, 0.01056518591940403, -0.0015470903599634767, -0.01588578335940838, -0.0035058935172855854, -0.05599294975399971, -0.022308504208922386, -0.016772549599409103, 0.06019875779747963, 0.04215939715504646, -0.023347286507487297, -0.0235753133893013, 0.01621515303850174, -0.038561660796403885, 0.009152693673968315, -0.06318842619657516, 0.03131551295518875, 0.0179000087082386, 0.02078833244740963, 0.027185717597603798, 0.013909561559557915, -0.06800229847431183, 0.016658537089824677, -0.018229378387331963, -0.024487415328621864, 0.0387643501162529, -0.038891032338142395, 0.041323304176330566, 0.035724010318517685, 0.01904013752937317, -0.040284521877765656, -0.020522303879261017, -0.03729485347867012, -0.010514513589441776, -0.021041695028543472, -0.01658252812922001, -0.03810561075806618, -0.03810561075806618, 0.0066570802591741085, -0.010995901189744473, 0.0003143269568681717, -0.03795359283685684, 0.01442895270884037, -0.044211629778146744, -0.029313957318663597, 0.0619216151535511, -0.013643531128764153, -0.03336774557828903, 0.006308707874268293, -0.0541180744767189, 0.010280153714120388, -0.03590136393904686, -0.014656978659331799, 0.06845834851264954, 0.01966087333858013, 0.019888898357748985, 0.0359266996383667, -0.01057151984423399, -0.051635127514600754, -0.015974460169672966, -0.013820884749293327, -0.0457317978143692, -0.020699655637145042, -0.02394268661737442, -0.00308784656226635, -0.040715236216783524, -0.03455854579806328, 0.012294379994273186, -0.0037117500323802233, -0.0007937349146232009, -0.012896114028990269, 0.01901479996740818, 0.0019366340711712837, 0.016075804829597473, -0.033621106296777725, -0.020002910867333412, 0.01072353683412075, -0.020636316388845444, -0.003350709332153201, 0.045174404978752136, -0.009729092009365559, 0.017874673008918762, -0.019192153587937355, 0.045630455017089844, 0.022599870339035988, 0.013592858798801899, -0.006216864567250013, 0.022333839908242226, -0.003284201957285404, -0.0008986425236798823, -0.006745757069438696, -0.03410249575972557, 0.03164488449692726, -0.033646441996097565, -0.056144967675209045, 0.005371269304305315, -0.012357720173895359, 0.033241063356399536, 0.036078717559576035, -0.006150356959551573, 0.003372878534719348, -0.010672864504158497, 0.0015407562023028731, 0.03199959173798561, 0.04041120037436485, -0.020281609147787094, 0.0006417178665287793, 0.03648409619927406, 0.04507305845618248, -0.008500287309288979, 0.025830231606960297, -0.05503017455339432, -0.043780915439128876, 0.004212139640003443, -0.005260423757135868, 0.044845033437013626, 0.008335602469742298, 0.03146753087639809, -0.06227632239460945, -0.0267043299973011, -0.015227042138576508, 0.020851673558354378, -0.009216034784913063, -0.0508243702352047, 0.006264369934797287, 0.010957896709442139, -0.05533421039581299, 0.011559630744159222, 0.033899806439876556, -0.00029116810765117407, -0.0013950732536613941, -0.0647592693567276, -0.010489176958799362, 0.0029722503386437893, 0.0317969024181366, -0.004924719221889973, -0.00633087707683444, -0.04162734001874924, -0.02496880292892456, 0.01866009458899498, -0.009748093783855438, 0.0007323738536797464, 0.06597540527582169, 0.06425254791975021, 0.02178911305963993, 0.04190603643655777, -0.02075032889842987, -0.024804117158055305, -0.03554665669798851, 0.03425450995564461, -0.07778206467628479, 0.026552313938736916, 0.0027996476273983717, 0.042108725756406784, -0.024930797517299652, -0.04545310139656067, 0.0017925344873219728, -0.008563627488911152, 0.0013871557312086225, 0.03554665669798851, 0.014656978659331799, -0.002441774122416973, -0.02642563171684742, 0.01834339275956154, -0.04390759393572807, -0.029415301978588104, -0.003060926916077733, -0.016823220998048782, -0.03146753087639809, -0.0013206482399255037, -0.041019272059202194, 0.007132133934646845, -0.006992784794420004, 0.029085930436849594, 0.055131521075963974, 0.03156887739896774, 0.005159079097211361, 0.07352558523416519, 0.007803542539477348, 0.012560409493744373, 0.008031568489968777, 0.03704148903489113, 0.011743318289518356, 0.0034678892698138952, 0.006391050759702921, -0.09202099591493607, 0.010546183213591576, -0.0380549393594265, 0.02852853573858738, 0.0069357785396277905, 0.023816006258130074, 0.01583511009812355, 0.04129796847701073, 0.015265046618878841, 0.004604849964380264, 0.027996474876999855, 0.03881502151489258, 0.03906838595867157, 0.010818547569215298, -0.04474368691444397, -0.015974460169672966, -0.0032050262670964003, -0.006368881557136774, 0.03346908837556839, -0.008215255104005337, 0.022599870339035988, 0.010869219899177551, -0.00036598899168893695, -0.03519194945693016, 0.012877112254500389, -0.04550377279520035, 0.015049689449369907, -0.010976898483932018, -0.007417165674269199, 0.02781912311911583, 0.03101148083806038, 0.05584093555808067, 0.0007984854746609926, -0.01659519597887993, -0.043172843754291534, -0.0450223870575428, 0.0023689325898885727, 0.007727534044533968, -0.02817382849752903, -0.019280830398201942, 0.02248585782945156, -0.04897483065724373, -0.03939775377511978, -0.021637095138430595, -0.00824059173464775, -0.017862005159258842, -0.021269720047712326, -0.010957896709442139, -0.05239521339535713, -0.017418621107935905, -0.02353730797767639, -0.022599870339035988, -0.05067235231399536, -0.03334240987896919, -0.012129695154726505, -0.023461299017071724, -0.0522431954741478, 0.04015783965587616, 0.004706195089966059, -0.041678011417388916, 0.06242834031581879, -0.022739218547940254, 0.0023705160710960627, -0.029161939397454262, 0.024930797517299652, -0.0044718352146446705, 0.028249837458133698, -0.07859282195568085, 0.08041702210903168, -0.015581748448312283, 0.0026587150059640408, -0.020268941298127174, -0.004547843709588051, 0.010983232408761978, -0.026628321036696434, 0.039245739579200745, 0.02536151371896267, 0.011135249398648739, 0.020154928788542747, 0.018039358779788017, 0.009900110773742199, -0.015024352818727493, -0.023435963317751884, -0.051609791815280914, -0.0010593689512461424, 0.006147189997136593, -0.05254723131656647, -0.030074041336774826, 0.03835897147655487, -0.012782101519405842, 0.015721097588539124, -0.022675877436995506, 0.04266612231731415, -0.031898245215415955, -0.024424074217677116, 0.0028899076860398054, 0.019610200077295303, 0.04862012341618538, 0.03916972875595093, 0.01265542022883892, 0.017051247879862785, -0.008202587254345417, -0.051609791815280914, -0.0162531565874815, 0.029440637677907944, -0.012731429189443588, 0.03283568471670151, 0.016430510208010674, 0.006270703859627247, 0.013288824819028378, 0.05214185267686844, -0.014897672459483147, 0.03524262085556984, 0.00562779838219285, 0.035724010318517685, 0.033950477838516235, -0.006676082499325275, 0.030428748577833176, 0.045554447919130325, 0.007854214869439602, -0.007461504079401493, 0.044490326195955276, 0.03455854579806328, -0.005770314484834671, -0.030834127217531204, 0.0071828062646090984, -0.03526795655488968, -0.005054567474871874, 0.024550754576921463, 0.012433729134500027, -0.017747992649674416, 0.03349442407488823, -0.0067964293994009495, -0.04124729707837105, -0.0029880853835493326, -0.014669646508991718, 0.003186024259775877, 0.003860600059852004, -0.021941129118204117, -0.1153302788734436, -0.01650651916861534, -0.036078717559576035, 0.03134085237979889, -0.05219252407550812, -0.029668662697076797, 0.01871076598763466, -0.015442400239408016, -0.009836770594120026, 0.021345729008316994, 0.0010411585681140423, 0.0051939161494374275, 0.04324885457754135, 0.0026159603148698807, -0.014378280378878117, 0.018406732007861137, 0.03878968581557274, 0.01018514297902584, -0.0001596377114765346, 0.03868834301829338, -0.026831012219190598, -0.010432170704007149, 0.027261726558208466, 0.0011361691867932677, -0.009298376739025116, -0.004161466844379902, -0.017342614009976387, 0.008398942649364471, 0.015607085078954697, 0.0025257000233978033, 0.013643531128764153, -0.05072302743792534, 0.0037307520397007465, 0.027312397956848145, 0.010001455433666706, 0.006815431639552116, -0.010109134949743748, -0.039245739579200745, -0.017177928239107132, 0.029035259038209915, -0.015670426189899445, 0.02216915413737297, 0.03405182063579559, -0.015189037658274174, -0.006220031529664993, 0.021915793418884277, -0.03212627395987511, 0.01795068196952343, 0.02994736097753048, 0.0067774271592497826, -0.007417165674269199, 0.031822238117456436, 0.008449614979326725, -0.02045896276831627, -0.02285323105752468, -0.006707753054797649, -0.028781896457076073, -0.03767489641904831, 0.006229532416909933, 0.02885790541768074, 0.005586626939475536, -0.025272836908698082, 0.004253310617059469, -0.01181299239397049, -0.027388406917452812, -0.0017371115973219275, 0.019458184018731117, -0.019242826849222183, 0.024905461817979813, -0.013390169478952885, -0.015467735938727856, -0.013681535609066486, -0.006834433879703283, 0.03704148903489113, 0.010907224379479885, -0.015303051099181175, 0.00501972995698452, -0.04413561895489693, 0.06252968311309814, -0.028604542836546898, 0.01577177084982395, 0.01934417150914669, -0.0014845415716990829, 0.018862783908843994, -0.027717778459191322, -0.013238152489066124, -0.022802559658885002, -0.02951664663851261, -0.017089251428842545, -0.027945803478360176, -0.03341841697692871, 0.0343811921775341, -0.01180032454431057, 0.0003790529735852033, -0.0089500043541193, -0.0016017213929444551, -0.00755651481449604, 0.025260169059038162, 0.04215939715504646, -0.016088472679257393, -0.04096859693527222, -0.006986450869590044, -0.0009318962693214417, -0.026831012219190598, 0.01321281585842371, -0.013491514138877392, 0.011122581548988819, 0.011660975404083729, 0.01869809813797474, 0.022701214998960495, 0.02503214217722416, -0.006581071764230728, 0.005874826107174158, 0.06800229847431183, 0.013947565108537674, -0.003914439119398594, -0.04813873767852783, 0.0007834421121515334, -0.03192358464002609, 0.022435184568166733, 0.02645096927881241, -0.0016310163773596287, -0.035749346017837524, -0.0032588657923042774, -0.04532641917467117, 0.04720129817724228, 0.027591096237301826, 0.01059052161872387, -0.037066828459501266, -0.025640210136771202, -0.022397181019186974, -0.006109185516834259, -0.006954780779778957, -0.018457405269145966, -0.020243605598807335, -0.027743114158511162, 0.000636571436189115, 0.038485653698444366, 0.048113398253917694, 0.01656986027956009, -0.02218182198703289, -0.02429739385843277, 0.0003982530324719846, -0.028021812438964844, 0.017025910317897797, 0.01497368048876524, -0.011084577068686485, -0.0032192780636250973, 0.035419974476099014, -0.02147240936756134, -0.021738439798355103, -0.02537418156862259, 0.03458388149738312, -0.04712528735399246, 0.01055251806974411, -0.051179077476263046, -0.04466767981648445, -0.01497368048876524, -0.009558072313666344, 0.03635741397738457, -0.0007062459480948746, 0.0038827690295875072, -0.02951664663851261, -0.0059349993243813515, 0.0012224705424159765, -0.005149577744305134, -0.022333839908242226, -0.027667105197906494, 0.04152599349617958, 0.008443281054496765, 0.016012463718652725, -0.00564363319426775, -0.05381403863430023, -0.015936454758048058, -0.01578443869948387, -0.04889881983399391, -0.02001558057963848, -0.04720129817724228, -0.024778781458735466, -0.019901566207408905, 0.008525623939931393, 0.045301083475351334, -0.009995121508836746, 0.016721876338124275, -0.010938894003629684, 0.013402837328612804, -0.00625170161947608, -0.019787553697824478, 0.011382277123630047, -0.03022605925798416, 0.02042095921933651, 0.019622869789600372, -0.013390169478952885, -0.03810561075806618, 0.02318260259926319, -0.028249837458133698, -0.015417063608765602, 0.003005503909662366, 0.005434609949588776, -0.016139144077897072, -0.006745757069438696, 0.013782880268990993, 0.035343967378139496, 0.001172589953057468, 0.015632420778274536, 0.030910136178135872, 0.004022118169814348, -0.014226263388991356, 0.012421060353517532, -0.041323304176330566, 0.012972122989594936, -0.03161954879760742, -0.002451275009661913, -0.014847000129520893, -0.005545455496758223, 0.017823999747633934, 0.010957896709442139, 0.017659315839409828, 0.002590624149888754, -0.0075311786495149136, -0.018482740968465805, 0.022713882848620415, -0.0164811834692955, 0.007873216643929482, 0.010786877013742924, 0.0008598464773967862, -0.0021440740674734116, 0.024854790419340134, 0.004449666012078524, 0.01426426786929369, -0.03554665669798851, 0.0004964307299815118, -0.005605629179626703, -0.01371954008936882, -0.0028313177172094584, -0.005649967584758997, 0.051559120416641235, -0.007391829509288073, -0.015911119058728218, -0.027641769498586655, -0.020091587677598, 0.022574532777071, -0.0010981649393215775, -0.01828005164861679, -0.0006417178665287793, -0.00316227157600224, 0.05183781683444977, 0.05290193855762482, -0.0499882772564888, 0.00626120250672102, -0.011553296819329262, -0.013554854318499565, 0.01901479996740818, -0.012623750604689121, -0.02043362706899643, -0.0037877585273236036, -0.009032347239553928, -0.005402939859777689, 0.015353723429143429, -0.016734544187784195, -0.006001506932079792, -0.02672966755926609, -0.012541407719254494, -0.01459363754838705, -0.016367170959711075, 0.011217592284083366, 0.001746612717397511, -0.021763775497674942, 0.02640029601752758, 0.0033348742872476578, -0.09247704595327377, -0.012946786358952522, 0.018736103549599648, 0.016823220998048782, -0.0005609588115476072, 0.01617714948952198, -0.0059318323619663715, -0.009779764339327812, 0.0021108202636241913, -0.024398738518357277, 0.02043362706899643, -0.0035660669673234224, 0.002408520318567753, -0.029668662697076797, -0.022637873888015747, -0.04608650505542755, -0.02076299674808979, 0.02213115058839321, 0.02248585782945156, -0.008721979334950447, -0.008373606018722057, 0.007429833989590406, 0.0012422644067555666, 0.017165260389447212, -0.009222368709743023, 0.0029754173010587692, -0.0032651997171342373, -0.017076583579182625, 0.0063055409118533134, -0.0071764723397791386, 0.0037497542798519135, 0.005279425997287035, -0.0018764606211334467, 0.027743114158511162, -0.024132708087563515, -0.009197032079100609, 0.0007236645324155688, 0.014707650989294052, 0.022029805928468704, -0.036838799715042114, 0.005371269304305315, -0.0654686838388443, -0.007828878238797188, -0.0025035310536623, 0.0365094318985939, -0.045959826558828354, 0.0076451911590993404, 0.006682416889816523, -0.01321281585842371, -0.03937241807579994, 0.012902447953820229, -0.00431981822475791, 0.005770314484834671, 0.0010245316661894321, 0.012262709438800812, 0.010451173409819603, 0.01722859963774681, -0.015353723429143429, -0.008525623939931393, 0.008424279280006886, -0.013529518619179726, 0.030403412878513336, -0.02182711660861969, 0.001133002107962966, -0.02751508727669716, -0.03205026313662529, -0.008202587254345417, 0.009615079499781132, 0.04606116935610771, -0.032962366938591, -0.051559120416641235, 0.039600443094968796, -6.546828808495775e-05, 0.012889780104160309, -5.987651093164459e-06, 0.013681535609066486, 0.0003691560123115778, -0.026146935299038887, -0.06197229027748108, 0.013694203458726406, 0.02748975157737732, -0.03172089532017708, 0.026146935299038887, 0.0034773903898894787, 0.015974460169672966, 0.022321172058582306, 0.03448253497481346, -0.011768653988838196, -0.02285323105752468, -0.006463892292231321, 0.03136618807911873, -0.03172089532017708, -0.0022089979611337185, 0.009254038333892822, 0.05629698559641838, 0.010064796544611454, 0.01650651916861534, -0.0029548315797001123, -0.03417850285768509, -0.0025431187823414803, 0.038612332195043564, -0.0035407308023422956, 0.014694982208311558, -0.09425057470798492, 0.042083390057086945, 0.019876230508089066, 0.010330826044082642, -0.001006321283057332, 0.027337735518813133, -0.01588578335940838, 0.022409848868846893, 0.008386274799704552, 0.019952239468693733, 0.04469301551580429, -0.018508076667785645, 0.042032718658447266, 0.017823999747633934, 0.009634081274271011, 0.032227616757154465, -0.01579710654914379, 0.01651918701827526, -0.007233478594571352, -0.008373606018722057, -0.015531076118350029, -0.020610980689525604, -0.0011203340254724026, 0.04390759393572807, 0.02713504619896412, -0.02460142783820629, -0.012427395209670067, -0.01939484290778637, 0.054016727954149246, 0.006473393179476261, 0.03377312421798706, -0.00564046623185277, -0.0026238777209073305, -0.012098024599254131, -0.006954780779778957, -0.012547741644084454, -0.00023871428857091814, -0.00439582671970129, 0.038232289254665375, 0.0400564968585968, 0.010330826044082642, -0.049861595034599304, 0.011781321838498116, 0.011084577068686485, -0.014492292888462543, -0.009298376739025116, -0.028452526777982712, 0.02716038189828396, -0.022675877436995506, 0.014580969698727131, 0.03762422129511833, 0.005656301509588957, 0.016354503110051155, 0.002608042676001787, -0.023511972278356552, 0.034685228019952774, 0.05528353899717331, 0.005504284519702196, 0.009906445629894733, 0.002075982978567481, 0.0020934015046805143, 0.032886356115341187, -0.01757063902914524, -0.011154252104461193, -0.013820884749293327, -0.01826738379895687, 0.03488791733980179, 0.014885003678500652, -0.031518202275037766, 0.060401447117328644, 0.028047148138284683, 0.03770023211836815, 0.020953018218278885, -0.019445516169071198, -0.019825559109449387, 0.02119371108710766, -0.007689529564231634, 0.008506621234118938, -0.012896114028990269, -0.005146410781890154, -0.020889677107334137, 0.02819916419684887, 0.02956731803715229, 0.018900787457823753, -0.002756892703473568, 0.030403412878513336, 0.010463841259479523, 0.010900890454649925, 0.009450393728911877, -0.03488791733980179, 0.015341055579483509, -0.003149603493511677, -0.002403769874945283, -0.017165260389447212, 0.029389964416623116, -0.0024639430921524763, 0.00877898558974266, -0.0013048130786046386, 0.014010906219482422, -0.018052026629447937, -0.007607187144458294, -0.02214381843805313, 0.0066887508146464825, -0.012427395209670067, 0.001806786167435348, 0.01164197362959385, 0.018381396308541298, -0.003860600059852004, 0.01371954008936882, -0.046669237315654755, 0.018596753478050232, -0.020167596638202667, -0.02956731803715229, 0.0028962416108697653, -0.014568301849067211, -0.01655719242990017, 0.0019223823910579085, -0.030150050297379494, -0.0037655893247574568, -0.03901771083474159, -0.0035819020122289658, -0.04398360475897789, -0.007708531804382801, 0.03275967761874199, -0.020864341408014297, -0.011755986139178276, 0.024094704538583755, -0.02954198233783245, 0.03732018917798996, -0.014935676008462906, -0.004256477579474449, -0.044845033437013626, 0.012636418454349041, -0.03268366679549217, -0.04106994345784187, -0.012864443473517895, -0.01793801411986351, 0.014631642028689384, 0.021573754027485847, 0.012763098813593388, -0.008544625714421272, -0.055790260434150696, -0.011755986139178276, -0.023473968729376793, 0.03899237513542175, -0.031214170157909393, 0.00756918266415596, 0.0010134470649063587, -0.0025827065110206604, 0.025551535189151764, -0.0247027724981308, 0.010508179664611816, -0.011686312034726143, 0.01833072490990162, 0.032911695539951324, 0.028376517817378044, -0.004665023647248745, -0.01864742673933506, 0.008215255104005337, 0.01898946426808834, -0.011768653988838196, -0.021725771948695183, -0.02011692523956299, 0.006153523921966553, 0.02001558057963848, 0.011185921728610992, 0.008044236339628696, -0.025184160098433495, 0.034989260137081146, 0.018052026629447937, 0.04859478771686554, 0.024094704538583755, 0.02498147077858448, -0.014137586578726768, -0.028224501758813858, 0.010489176958799362, -0.019217489287257195, 0.0050894045270979404, -0.004547843709588051, -0.007512176409363747, 0.0005597711424343288, -0.0012660170905292034, -0.02461409568786621, -0.025209495797753334, -0.00827226135879755, 0.03975246101617813, -0.023511972278356552, 0.008721979334950447, 0.0164811834692955, 0.028097819536924362, 0.014086914248764515, 0.0179000087082386, -0.015746433287858963, -0.0037940924521535635, 0.0006753674824722111, 0.026881683617830276, -0.024221384897828102, -0.0017735323635861278, -0.019508855417370796, 0.045149065554142, 0.012984790839254856, 0.038586996495723724, 0.030682111158967018, -0.004693526774644852, -0.01496101263910532, -0.00950739998370409, 0.017443958669900894, 0.03139152377843857, 0.02431006170809269, 0.03093547187745571, 0.028781896457076073, 0.012858109548687935, 0.005421941634267569, 0.007911221124231815, -0.03975246101617813, 0.011698979884386063, -0.03547064587473869, 0.00026246695779263973, 0.015290382318198681, -0.019901566207408905, -0.014517629519104958, 0.010343493893742561, -0.04337553307414055, 0.000494055449962616, -0.020268941298127174, -0.007746536284685135, 0.02218182198703289, 0.019141482189297676, 0.0013824051711708307, 0.02751508727669716, 0.025133486837148666, -0.02672966755926609, 0.005858990829437971, 0.00950106605887413, 0.008981674909591675, -0.0014219928998500109, 0.0033538765273988247, 0.01427693571895361, -0.014162923209369183, 0.017367949709296227, -0.004696693737059832, -0.004883548244833946, 0.004098126664757729, 0.004813873674720526, 0.02609626203775406, 0.000718122289981693, -0.047327976673841476, 0.06126287579536438, -0.006004673894494772, 0.0030466753523796797, -0.008911999873816967, -0.005748145282268524, 0.010159807279706001, -0.001520962337963283, 0.019876230508089066, -0.021903125569224358, -0.003661077469587326, -0.01966087333858013, 0.032202281057834625, -0.014530297368764877, 0.01498634833842516, 0.0045763468369841576, -0.010850218124687672, 0.008988008834421635, 0.027033701539039612, 0.0067964293994009495, 0.010976898483932018, 0.021003691479563713, -0.007341157179325819, -0.0027838123496621847, -0.028072483837604523, -0.03141685947775841, 0.005437776912003756, -0.021219048649072647, 0.04618785157799721, 0.009684753604233265, 0.01684855856001377, -0.033975813537836075, -0.020851673558354378, -0.03410249575972557, -0.015265046618878841, 0.023448631167411804, -0.00028364642639644444, -0.02292924001812935, 0.02007891982793808, 0.0018447904149070382, -0.0005439360393211246, 0.0018622090574353933, 0.012573077343404293, -0.020965686067938805, 0.0009619829943403602, -0.023017916828393936, 0.0013261905405670404, -0.001935050473548472, -0.0033982146997004747, -0.010470175184309483, -0.0010031542042270303, 0.029136603698134422, -0.007816210389137268, 0.02574155665934086, -0.013415506109595299, 0.019584864377975464, -0.034330520778894424, 0.0013990320730954409, 0.01621515303850174, 0.020357618108391762, 0.0029865019023418427, 0.004265978932380676, -0.018128033727407455, -0.03813094645738602, -0.016316497698426247, -0.028705889359116554, -0.04084191843867302, -0.004126629792153835, 0.015543744899332523, -0.0015304634580388665, -0.026831012219190598, -0.00028760518762283027, 0.018394064158201218, -0.0009809851180762053, -0.010071130469441414, -0.006109185516834259, -0.0004402160702738911, -0.008291264064610004, 0.029871352016925812, 0.011496290564537048, 0.0236386526376009, -0.014162923209369183, 0.017684651538729668, -0.0247027724981308, -0.003825762774795294, -0.004367323592305183, 0.004880381282418966, 0.051939163357019424, -0.01578443869948387, 0.010153473354876041, 0.015379059128463268, -0.026856347918510437, 0.004763201344758272, 0.02011692523956299, -0.006476560141891241, -0.008899332024157047, -0.025450190529227257, 0.0075185103341937065, -0.017063915729522705, 0.02741374261677265, 0.004145632032305002, -0.04867079481482506, 0.010432170704007149, -0.014504961669445038, 0.009159027598798275, 0.03656010329723358, -0.0072904848493635654, -0.05867858603596687, -0.020230937749147415, 0.050165630877017975, 0.024804117158055305, 0.015151034109294415, -0.009944449178874493, -0.008075905963778496, 0.0031432693358510733, -0.02223249524831772, 0.027185717597603798, -0.02880723401904106, -0.0011567547917366028, 0.003841597819700837, 0.01971154473721981, -0.0012897697743028402, -0.00509890541434288, 0.014150254428386688, 0.016759881749749184, -0.015632420778274536, -0.00563096534460783, -0.01306079886853695, -0.014694982208311558, -0.030479419976472855, -0.03278501331806183, 0.003290535882115364, -0.021738439798355103, 0.019850894808769226, 0.009241370484232903, 0.011578632518649101, 0.010501845739781857, 0.005744978319853544, 0.001419617678038776, -0.02044629491865635, 0.026298951357603073, 0.003414049744606018, 0.011090910993516445, -0.005273091606795788, 0.01303546316921711, 0.016303829848766327, 0.015189037658274174, -0.0050894045270979404, -0.0089500043541193, 0.043831586837768555, -0.017380617558956146, -0.005757646169513464, 0.0005391855374909937, -0.008006231859326363, 0.006923110224306583, 0.004367323592305183, 0.01251607108861208, -0.003043508157134056, 0.006118686869740486, 0.046694573014974594, 0.030048705637454987, 0.02607092633843422, 0.005900162272155285, -0.013630863279104233, -0.000844011374283582, 0.017405953258275986, -0.021611759439110756, 0.0036959147546440363, -0.008487619459629059, 0.014732986688613892, -0.009912779554724693, 0.018558749929070473, 0.03932174667716026, 0.02285323105752468, 0.003471056232228875, -0.018495408818125725, -0.005605629179626703, -0.01621515303850174, 0.019546860828995705, -0.013478846289217472, -0.0003000753349624574, -0.007258814759552479, -0.01721593178808689, -0.013592858798801899, 0.03732018917798996, 0.0005617505521513522, -0.007233478594571352, 0.00030621144105680287, 0.009228702634572983, 0.015315718948841095, -0.0021741606760770082, 0.023524640128016472, -0.01622782088816166, 0.028376517817378044, 0.029719335958361626, 0.027185717597603798, 0.019990243017673492, 0.008202587254345417, 0.06065480783581734, -0.0014006155543029308, 0.02466476894915104, -0.009659417904913425, -0.011027570813894272, -0.02567821554839611, -0.03243030607700348, 0.043071500957012177, 0.01579710654914379, 0.0018669595010578632, 0.010292821563780308, 0.02460142783820629, 0.0025177826173603535, 0.023714661598205566, -0.005738643929362297, 0.02814849279820919, 0.0394737645983696, -0.004905717447400093, -0.013630863279104233, -0.017760660499334335, -0.008683974854648113, -0.016468515619635582, -0.025842901319265366, 0.015062357299029827, 0.015733765438199043, 0.029491309076547623, -0.010976898483932018, 0.03060610219836235, -0.014048909768462181, 0.018850116059184074, 0.008994342759251595, 0.01358019094914198, -0.016468515619635582, -0.035318631678819656, 0.0002721659548114985, 0.027920467779040337, 0.001521754078567028, 0.023524640128016472, -0.007170137949287891, -0.009190698154270649, -0.010780543088912964, -0.015049689449369907, 0.03136618807911873, 0.0017766994424164295, 0.0008701393380761147, -0.005678470712155104, -0.019559528678655624, 0.009684753604233265, 0.02045896276831627, 0.0055802930146455765, -0.018216710537672043, 0.005855823867022991, -0.015328386798501015, -0.02812315709888935, 0.023714661598205566, -0.020864341408014297, -0.04127263277769089, -0.006185194011777639, -0.04183002933859825, -0.004620685242116451, -0.014796326868236065, 0.015328386798501015, 0.013985569588840008, -0.018571417778730392, 0.006083849351853132, 0.0225111935287714, 0.013250820338726044, 0.0013523184461519122, 0.0022343341261148453, -0.01124926283955574, 0.05031764879822731, -0.017494630068540573, -0.0063023739494383335, -0.006726754829287529, 0.008284930139780045, -0.001499584992416203, -0.04233675077557564, 0.03638274967670441, 0.02043362706899643, 0.01833072490990162, 0.013250820338726044, -0.0291872750967741, -0.017063915729522705, 0.0208010021597147, 0.0010181976249441504, 0.009786098264157772, -0.023068588227033615, -0.005155912134796381, 0.023676658049225807, -0.008873996324837208, 0.001583511009812355, -0.014010906219482422, 0.009228702634572983, 0.012015681713819504, 0.00246869376860559, 0.014124918729066849, -0.002444941084831953, -0.02539951726794243, -0.00571330776438117, 0.003597737057134509, 0.005748145282268524, 0.001234346884302795, 0.007030789274722338, -0.004915218334645033, -0.009779764339327812, -0.03965111821889877, 0.010983232408761978, 0.018812110647559166, 0.021548418328166008, -0.007448836229741573, 0.040284521877765656, 0.023017916828393936, 0.03686413913965225, -0.022802559658885002, 0.012034684419631958, -0.010837549343705177, -0.03478657081723213, -0.030504757538437843, 0.00019061514467466623, -0.019787553697824478, 0.014466957189142704, -0.0009200199274346232, 0.04020851105451584, -0.019116144627332687, -0.014365612529218197, 0.009051349014043808, -0.03777623921632767, 0.001873293542303145, 0.003372878534719348, 0.003999948967248201, -0.04867079481482506, 0.007442501839250326, 0.006733089219778776, 0.0526992492377758, -0.00045684294309467077, 0.0017402786761522293, -0.031872909516096115, 0.03415316715836525, 0.02462676353752613, 0.02010425552725792, 0.014504961669445038, 0.013656198978424072, -0.028680551797151566, -0.03235429897904396, -0.019242826849222183, -0.004234308376908302, -0.02252386137843132, -0.003923940472304821, 0.03354509919881821, -0.015151034109294415, 0.027591096237301826, -0.015011684969067574, 0.00987477507442236, 0.03098614513874054, 0.027363071218132973, -0.033671777695417404, 0.036129388958215714, 0.02672966755926609, 0.0013903226936236024, 0.018482740968465805, 0.006815431639552116, 0.004367323592305183, -0.02602025307714939, -0.022359175607562065, -0.010900890454649925, -0.004459167364984751, 0.009070351719856262, 0.0009026012849062681, -0.016367170959711075, -0.021054362878203392, -0.0111099136993289, 0.00026741542387753725, -0.01835606060922146, -0.018926125019788742, 0.012085356749594212, 0.0074741723947227, 0.026831012219190598, -0.0023055921774357557, 0.004557344596832991, -0.020864341408014297, -0.013086135499179363, -0.028655216097831726, -0.012763098813593388, 0.04165267571806908, -0.0019255494698882103, 0.0026634656824171543, -0.024018695577979088, -0.0035755678545683622, 0.021561086177825928, 0.0009912779787555337, 0.002403769874945283, 0.022701214998960495]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
", there is no significant
pattern for outliers.
Analysis of Key Cache. The above observation for key
cache aligns with previous findings that certain fixed
columns in activations exhibit larger outliers (Dettmers et al.,
2022; Lin et al., 2023). The persistence of outliers within
each channel means that per-channel quantization can con-fine the quantization error to each individual channel, with-
out impacting the other normal channels. Thus, Figure 2
explains why key cache should be quantized per-channel.
In Table 2 we show key cache relative reconstruction error
∥XK−X′
K
XK∥F, along with the relative attention score error
∥A−A′
A∥FwhereA′=Softmax (tQX′⊤
K). We observe that
the per-token quantization can lead to almost 5×larger at-
tention score error than per-channel quantization, which is
consistent with Figure 2.
Table 2: The relative error statistics averaged over all layers
and all heads
Llama-2-13B K Per-Token K Per-Channel
Avg. ∥XK−X′
K
XK∥F 13.67 4.55
Avg. ∥A−A′
A∥F 47.0 9.6
Attention sparsity 84.3%
V Per-Token V Per-Channel
Avg. ∥XV−X′
V
XV∥F 4.57 3.73
Avg.∆ 3.55 49.89
Analysis of Value Cache. Unlike key cache, value cache
does not show the channel-wise outlier pattern. Furthermore,
4
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
Q_MatMulConcatQuantization by Channel
Quantization by TokenMatMulPrefill Phase Decoding Phase*
KVCache
* we omit the value cache and
 attention output calculationFull Precision Tensor
Low Precision Tensor
Figure 3: The overview of KIVI algorithm. For ease of illustration, we omit the value cache and attention output parts. The
detailed pseudo-code is provided in Algorithm 1. Here “Q_Matmul” is the mix-precision matrix multiplication which fuses
the dequantization with matrix multiplication at the tiling level.
Figure 2 alone cannot explain OB2 , which indicates value
cache should only be quantized per-token. This is because
Figure 2 implies that errors should be comparable for both
per-token and per-channel quantization, given the absence
of a clear pattern. As shown in Equation (1), value cache
is used to calculate the attention output tO. Instead of
analyzing the quantization error of value cache XV, in
Table 2 we analyze the relative error ∆ =∥AXV−AX′
V
AXV∥F
with different quantization configurations. Surprisingly, we
observe that the per-token quantization error is almost 15×
smaller than per-channel quantization, which explains why
OB2 happens. The intuition behind this observation stems
from the attention sparsity. Equation (1) can be written as:
[AXV]i∗=lpromptX
j=1Aij[XV]j∗, (2)
where [XV]j∗is the j-th row of XV. From Equation (2),
the attention output is the weighted summation of value
cache across various tokens, with the weights being the
attention scores. Since the attention score is highly sparse
(Tian et al., 2023), the output is just the combination of
value caches of a few important tokens. The per-token
quantization can confine the error to each individual token.
Thus, quantizing other tokens does not affect the accuracy
of important tokens. Thus, per-token quantization leads to a
much smaller relative error ∆.
3.3.KIVI : Algorithm and System Support
Algorithm. As we previously analyzed, key cache should
be quantized per-channel and value cache should be quan-
tized per-token. Recall that key and value cache of newly
generated tokens arrive sequentially. From the implemen-
tation perspective, per-token quantization aligns well with
streaming settings, allowing newly quantized tensors to be
directly appended to the existing quantized value cache
by token dimension. However, for per-channel quantiza-
tion, the quantization process spans across different tokens,which cannot be directly implemented in the streaming set-
ting. As shown in Figure 3, our key idea to solve this prob-
lem is to group key cache every Gtokens and","[0.029463723301887512, 0.02538200654089451, 0.010869928635656834, -0.012194917537271976, 0.0070959096774458885, -0.0017676978604868054, 0.053250718861818314, 0.024565663188695908, -0.028082219883799553, -0.009971951134502888, 0.047800056636333466, 0.028308283537626266, -0.06214258447289467, 0.05031188204884529, -0.009814961813390255, -0.01091388612985611, 0.013036379590630531, -0.027353789657354355, -0.02150123380124569, -0.02386235073208809, -0.04807635769248009, -0.046845562756061554, 0.009262359701097012, 0.039435673505067825, 0.03928496688604355, -0.06902498751878738, -0.010059865191578865, 0.0028210950549691916, 0.030619164928793907, -0.022732028737664223, 0.008640683256089687, -0.021250052377581596, -0.03893331065773964, -0.08489973098039627, -0.010254531167447567, 0.03617030009627342, -0.016000334173440933, -0.006813329178839922, -0.0118934977799654, -0.014053668826818466, 0.023937705904245377, -0.019177794456481934, -0.05269811674952507, 0.01900196634232998, 0.04840289428830147, 0.028760412707924843, 0.010675262659788132, -0.03961150348186493, -0.06857286393642426, 0.017494870349764824, -0.022606438025832176, 0.05631515011191368, -0.07023067027330399, -0.02269435115158558, 0.029966089874505997, 0.0037520406767725945, -0.010449198074638844, -0.010172897018492222, 0.03586888313293457, -0.02989073470234871, 0.011020638048648834, -0.052145518362522125, 0.004957717377692461, 0.0055793942883610725, 0.005227738991379738, 0.006342361681163311, -0.035416752099990845, -0.012169798836112022, 0.03355799987912178, -0.001292805653065443, -0.006656339857727289, 0.045187756419181824, 0.01591242104768753, -0.014493238180875778, -0.011968852952122688, 0.03184995800256729, -0.013802486471831799, 0.029313014820218086, 0.058877211064100266, -0.030644282698631287, 0.04486121982336044, -0.0001630724873393774, 0.014342528767883778, -0.019428977742791176, 0.01930338703095913, -0.005412986036390066, -0.03579352796077728, -0.021727299317717552, -0.025432242080569267, -0.0332314632833004, -0.04538870230317116, 0.030041445046663284, -0.043730899691581726, 0.009143047966063023, 0.041143715381622314, 0.00906769372522831, 0.03828023374080658, -0.030619164928793907, 0.00806296244263649, -0.013915518298745155, 0.0105622299015522, 0.0007955425535328686, 0.0253317691385746, -0.016691086813807487, 0.07123539596796036, -0.017519989982247353, -0.02047138474881649, 0.025080587714910507, -0.02655000612139702, -0.03647172078490257, -0.004392556380480528, 0.014706743881106377, -0.04830242320895195, 0.028584584593772888, 0.008690919727087021, -0.045187756419181824, -0.05088960379362106, -0.007278017234057188, 0.005080169066786766, 0.003120944369584322, -0.017557667568325996, -0.0035793527495115995, 0.018235860392451286, -0.00711474847048521, -0.0014913969207555056, -0.040741823613643646, 0.045815713703632355, -0.062343530356884, -0.033407293260097504, -0.028433876112103462, 0.04719721898436546, 0.006957759149372578, 0.03767739608883858, 0.0174320749938488, 0.0039938041009008884, -0.023987943306565285, 0.006568426266312599, 0.06736718863248825, -0.04272616654634476, 0.009544940665364265, -0.02479172684252262, -0.03785322606563568, 0.027630090713500977, -0.015560764819383621, -0.048855025321245193, 0.004273244645446539, -0.015862183645367622, 0.03124712035059929, 0.005519738420844078, -0.007422447204589844, -0.029790261760354042, -0.0066312216222286224, -0.015372377820312977, -0.02383723296225071, -0.026926780119538307, -0.00932515598833561, 0.00045212876284494996, 0.0026295683346688747, 0.025896931067109108, -0.010574789717793465, -0.035718172788619995, 0.0028587724082171917, 0.0631975531578064, 0.0002131127694156021, -0.01293590571731329, 0.003965545911341906, -0.06641268730163574, 0.012125842273235321, -0.06068572774529457, -0.044836100190877914, -0.02359860949218273, -0.011422530747950077, -0.01356386300176382, -0.02644953317940235, 0.0028838906437158585, -0.03928496688604355, -0.042173564434051514, -0.016716204583644867, -0.017695818096399307, -0.009727047756314278, -0.026298822835087776, 0.04292711243033409, 0.03082011081278324, 0.07289320230484009, -0.013890400528907776, 0.013815045356750488, 0.023711642250418663, -0.01012894045561552, -0.003629589220508933, 0.05264788120985031, -0.0268765427172184, 0.009689370170235634, 0.08163435757160187, 0.03903378173708916, 0.014292292296886444, -0.028132455423474312, -0.019454095512628555, 0.02435215748846531, -0.01762046292424202, 0.010430359281599522, 0.026298822835087776, 0.015849625691771507, 0.03566793352365494, -0.0711851641535759, 0.03519068658351898, -0.009180725552141666, -0.04521287605166435, 0.019039643928408623, -0.07007995992898941, -0.02346045896410942, -0.000905042455997318, 0.044484447687864304, 0.04830242320895195, 0.009777284227311611, -0.0008799242204986513, 0.020408589392900467, -0.0558127835392952, 0.03257839009165764, -0.017708376049995422, 0.04363042488694191, 0.005108426790684462, 0.020458826795220375, 0.025896931067109108, 0.023121362552046776, -0.06128856539726257, 0.018009794875979424, 0.0018870095955207944, -0.0268765427172184, 0.017306484282016754, -0.05932934209704399, 0.044760748744010925, 0.038782600313425064, 0.017695818096399307, -0.03483903408050537, -0.006957759149372578, -0.04056599736213684, -0.007284296676516533, -0.03554234281182289, 0.010851089842617512, -0.03662243112921715, -0.010939003899693489, 0.015711475163698196, -0.013475948944687843, 0.015334700234234333, -0.03928496688604355, 0.013664335943758488, -0.03491438925266266, -0.027981746941804886, 0.0516933873295784, -0.019780633971095085, -0.010329886339604855, -0.009356553666293621, -0.054556868970394135, 0.0292376596480608, -0.05239669978618622, 0.0008979779668152332, 0.07002972066402435, 0.04066646844148636, -0.013048938475549221, 0.03983756899833679, 0.0003194729215465486, -0.03225184977054596, -0.048779670149087906, -0.018713107332587242, -0.016979945823550224, -0.019479213282465935, -0.017633020877838135, 0.004973416216671467, -0.03986268490552902, -0.0125151751562953, 0.012873110361397266, -0.013526185415685177, 0.0003726530121639371, -0.016088249161839485, 0.00883534923195839, 0.015008162707090378, -0.0010926445247605443, -0.018524719402194023, -0.036094944924116135, 0.007378490176051855, -0.02881065011024475, -0.00023567996686324477, 0.058575794100761414, 0.00011813433957286179, 0.009387951344251633, -0.025394564494490623, 0.005786620080471039, 0.03456273302435875, -0.013086616061627865, -0.015698915347456932, 0.020898396149277687, -0.024992672726511955, -9.110276732826605e-05, 0.007290576118975878, -0.02275714837014675, 0.023799555376172066, -0.025432242080569267, -0.04496169462800026, -0.0019199773669242859, -0.0032465357799082994, 0.03162389621138573, 0.012678444385528564, -0.01745719462633133, 0.00924352090805769, -0.025896931067109108, -0.01563611999154091, 0.04498681053519249, 0.031397830694913864, -0.02427680231630802, 0.016088249161839485, 0.03230208903551102, 0.004493029322475195, 0.011554401367902756, 0.050487712025642395, -0.048151712864637375, -0.03802905231714249, 0.02449030801653862, -0.007007995620369911, 0.06179093196988106, 0.008314145728945732, -0.011931175366044044, -0.0723908394575119, -0.01615104451775551, -0.006568426266312599, 0.02280738390982151, -0.0094884242862463, -0.040063630789518356, 0.014154141768813133, 0.021212374791502953, -0.012885669246315956, 0.01696738786995411, -0.00840205978602171, 0.022656673565506935, -0.0008830639999359846, -0.07244107127189636, -0.020509062334895134, 0.011774186044931412, 0.017356719821691513, 0.014932808466255665, -0.027278434485197067, -0.0443086177110672, -0.023334868252277374, 0.017444634810090065, -0.02011973038315773, -0.013350357301533222, 0.047146983444690704, 0.048478249460458755, 0.008169715292751789, 0.03556746244430542, -0.01811026781797409, -0.024565663188695908, -0.025570392608642578, 0.017168333753943443, -0.07244107127189636, 0.03313099220395088, 0.0026531165931373835, 0.021187255159020424, -0.05410474166274071, -0.06606103479862213, 0.002874471480026841, 0.00020016117196064442, 0.00894838199019432, 0.05827437341213226, 0.01478209812194109, 0.02845899388194084, -0.03951102867722511, -0.011673713102936745, 0.006361200474202633, -0.0059404694475233555, -0.008697198703885078, -0.009563779458403587, -0.009312596172094345, -0.030292626470327377, -0.04199773818254471, -0.009212123230099678, -0.03179972246289253, 0.017067860811948776, 0.05636538565158844, 0.026248585432767868, 0.020207643508911133, 0.05041235685348511, 0.006499351002275944, 0.021978480741381645, 0.015472850762307644, 0.026977015659213066, 0.03227696940302849, 0.006593544501811266, 0.00269864359870553, -0.09374136477708817, 0.03024239093065262, -0.06802026182413101, 0.018386568874120712, -0.03689872846007347, 0.046795327216386795, 0.014003432355821133, 0.0166157316416502, -0.008207392878830433, 0.01843680627644062, 0.03687361255288124, 0.06807049363851547, 0.03988780453801155, 0.011114832013845444, -0.03664754703640938, 0.00857788696885109, -0.00039835995994508266, -0.03142295032739639, 0.034437138587236404, -0.003786578308790922, 0.027755681425333023, 0.013111733831465244, 0.005981286522001028, -0.03084522858262062, 0.020370911806821823, -0.04968392848968506, 0.009080252610147, -0.009877757169306278, -0.01672876439988613, 0.023385103791952133, 0.030393099412322044, 0.06580985337495804, 0.02182777225971222, -0.033758945763111115, -0.03890819102525711, -0.036421481519937515, -0.022166868671774864, -0.008113199844956398, -0.0037300621625036, -0.036094944924116135, 0.035065095871686935, -0.04031481593847275, -0.02619834989309311, -0.015573323704302311, -0.008056683465838432, -0.006367479916661978, -0.012113283388316631, -0.012722400948405266, -0.04360530525445938, 0.0029090088792145252, -0.005789760034531355, -0.021928245201706886, -0.0590781569480896, -0.05068865790963173, -0.02402561902999878, -0.01775861345231533, -0.03730062395334244, 0.03127223998308182, -0.008106919936835766, -0.0352911613881588, 0.03398501127958298, -0.010574789717793465, 0.003981244750320911, -0.009080252610147, 0.044810984283685684, 0.007121027912944555, 0.02685142494738102, -0.0892200767993927, 0.07485242933034897, 0.0033187507651746273, -0.02570854313671589, -0.01715577393770218, -0.011026917956769466, 0.015183990821242332, -0.023724200204014778, 0.018386568874120712, 0.015786828473210335, 0.0001690576900728047, 0.016163602471351624, 0.014216938056051731, -0.004351739306002855, -0.008916983380913734, 0.006157114636152983, -0.06314731389284134, 0.01276007853448391, -0.009425628930330276, -0.03662243112921715, -0.024427512660622597, 0.02587181143462658, -0.020056933164596558, -0.00028042186750099063, -0.02582157589495182, 0.04395696148276329, -0.044785864651203156, -0.03421107679605484, 0.003516556927934289, 0.00021507513883989304, 0.05576254799962044, 0.043128058314323425, -0.030292626470327377, 0.026248585432767868, -0.03024239093065262, -0.04129442572593689, -0.019780633971095085, 0.03785322606563568, -0.012301670387387276, 0.004634319804608822, 0.022706910967826843, -0.008056683465838432, 0.003000062657520175, 0.034010130912065506, -0.013362916186451912, 0.04300246760249138, 0.02845899388194084, 0.03154854103922844, 0.05390379577875137, -0.010857369750738144, 0.05091472342610359, 0.031372711062431335, 0.0037991374265402555, 0.01117134839296341, 0.046443670988082886, 0.029313014820218086, 0.010744337923824787, -0.0127726374194026, 0.02313392236828804, -0.03398501127958298, -0.00578348059207201, 0.0067191356793046, -0.009300037287175655, -0.024904759600758553, 0.035090215504169464, -0.0026468371506780386, -0.05101519450545311, -0.016703646630048752, -0.010499434545636177, 0.0067568132653832436, -0.012458658777177334, -0.02886088564991951, -0.09906643629074097, -0.011139949783682823, -0.04056599736213684, 0.03627077490091324, -0.03792857751250267, -0.029740024358034134, 0.031021056696772575, -0.0036641268525272608, -0.00920584425330162, 0.0114853261038661, -0.014066227711737156, 0.0021287729032337666, 0.026977015659213066, -0.0026091597974300385, -0.017381839454174042, -0.005689287092536688, 0.048101477324962616, 0.004053459968417883, 0.004072298761457205, 0.03330681845545769, -0.032025787979364395, -0.024754049256443977, 0.05465734377503395, -0.01409134641289711, -0.026072759181261063, -0.007893414236605167, -0.024578221142292023, -0.01525934599339962, 0.030116798356175423, 0.011673713102936745, 0.00010900934285018593, -0.039460793137550354, 0.0015125904465094209, 0.035416752099990845, 0.015033281408250332, 0.013802486471831799, -0.020647212862968445, -0.0473981648683548, 0.01900196634232998, 0.02292041666805744, -0.009708208963274956, 0.01783396676182747, 0.024527985602617264, -0.0054789213463664055, -0.024100974202156067, 0.03393477573990822, -0.0255452748388052, 0.01848704181611538, 0.01293590571731329, -0.012006530538201332, -0.006938920356333256, 0.03184995800256729, 0.014556034468114376, -0.01675388216972351, -0.009946832433342934, 0.004188470542430878, -0.026248585432767868, -0.05606396496295929, 0.015096076764166355, 0.012590530328452587, 0.01962992362678051, -0.03162389621138573, 0.0098965959623456, -0.0025432242546230555, -0.025972286239266396, -0.003149202326312661, 0.010430359281599522, -0.03210114315152168, 0.02147611603140831, 0.003883911529555917, -0.015447732992470264, 0.0060723405331373215, -0.007158705499023199, 0.02815757505595684, 0.014317410998046398, -0.02649976871907711, -0.006957759149372578, -0.042449865490198135, 0.08505044132471085, -0.02077280543744564, 0.017494870349764824, 0.021086782217025757, 0.007284296676516533, 0.00013402948388829827, -0.05410474166274071, -0.008891865611076355, -0.014656507410109043, -0.04136978089809418, -0.00906769372522831, -0.029313014820218086, -0.003676685970276594, 0.016251517459750175, 0.002621718915179372, 0.030669400468468666, -0.042801521718502045, 0.0019152676686644554, 0.002084815874695778, 0.0036735462490469217, 0.03825511783361435, -0.005174362566322088, -0.04935738816857338, -0.023196717724204063, 0.012458658777177334, -0.024578221142292023, 0.01726880669593811, -0.0036735462490469217, 0.01998157985508442, 0.027353789657354355, 0.005271695554256439, 0.007554317824542522, 0.00011381713557057083, -0.0041036964394152164, -0.0015455582179129124, 0.03730062395334244, 0.020207643508911133, -0.006025243550539017, -0.0091242091730237, 0.005299953743815422, -0.010053585283458233, 0.03566793352365494, 0.0412190705537796, -0.0114853261038661, -0.03428643196821213, -0.012471218593418598, -0.053552139550447464, 0.04875455051660538, 0.026977015659213066, 0.010122660547494888, -0.044459328055381775, -0.01799723692238331, 0.004361158702522516, -0.004405115731060505, -0.010122660547494888, -0.04558964818716049, -0.024176329374313354, -0.02690166048705578, -0.00990915484726429, 0.021953362971544266, 0.023560931906104088, 0.008332984521985054, -0.0037457612343132496, -0.015573323704302311, 0.0018634612206369638, -0.026725832372903824, 0.0422489196062088, 0.01925314962863922, -0.017519989982247353, -0.006737974472343922, 0.026600241661071777, -0.002759869210422039, -0.029438605532050133, -0.029790261760354042, 0.03378406539559364, -0.039058901369571686, 0.009664252400398254, -0.055159710347652435, -0.021061664447188377, -0.0292376596480608, -0.013526185415685177, 0.052145518362522125, -0.007949930615723133, 8.19777706055902e-05, -0.03765227645635605, 0.004954577423632145, -0.003293632296845317, 0.010216853581368923, -0.026977015659213066, -0.03493950515985489, 0.02275714837014675, 0.017859086394309998, 0.022543642669916153, -0.006219909992069006, 0.001161719672381878, -0.01407878752797842, -0.010662702843546867, -0.04159584641456604, -0.003340729046612978, -0.049508098512887955, -0.011121111921966076, -0.019177794456481934, 0.030744755640625954, 0.04795076698064804, -0.012596809305250645, 0.0006778006791137159, -0.002657826291397214, 0.009482144378125668, 0.009444467723369598, -0.038707245141267776, 0.007510361261665821, -0.012973583303391933, 0.005271695554256439, 0.011642315424978733, -0.016439903527498245, -0.025721102952957153, 0.03760204091668129, -0.02888600341975689, -0.00921840313822031, 0.014468120411038399, 0.003500858088955283, -0.046493906527757645, 0.015020722523331642, 0.002315589925274253, 0.04152049124240875, -0.008891865611076355, 0.006832167971879244, 0.018198182806372643, -0.021463556215167046, -0.009708208963274956, 0.012508895248174667, -0.03129735589027405, 0.005535437725484371, -0.032678861171007156, -0.0174320749938488, -0.01038640271872282, -0.01201280951499939, 0.017494870349764824, 0.004910620860755444, 0.010901326313614845, 0.027956627309322357, -0.0007959349895827472, 0.016653409227728844, 0.01808515004813671, -0.025319211184978485, 0.024289362132549286, 0.010493154637515545, -0.011020638048648834, 0.010763176716864109, 0.027353789657354355, -0.015686355531215668, 0.026750952005386353, -0.025118263438344002, -0.003962406422942877, -0.00814459752291441, -0.015497969463467598, -0.012873110361397266, -0.013312679715454578, 0.0453384667634964, 0.021865449845790863, -0.015284463763237, -0.024364717304706573, -0.015862183645367622, 0.029438605532050133, 0.005114706698805094, -0.012521455064415932, -0.0030769873410463333, 0.0033941054716706276, 0.030116798356175423, 0.03182484209537506, -0.05531041696667671, 0.023447899147868156, -0.031347595155239105, -0.01811026781797409, 0.03024239093065262, 0.008954660966992378, -0.015786828473210335, -0.01960480585694313, -0.0027677188627421856, -0.010229413397610188, 0.0200066976249218, -0.010618746280670166, 0.0012386443559080362, -0.015849625691771507, -0.032678861171007156, -0.039084021002054214, -0.02750450000166893, 0.0034192237071692944, -0.013136852532625198, -0.009011177346110344, 0.022078953683376312, -0.008910704404115677, -0.08399547636508942, -0.02881065011024475, 0.012847992591559887, -0.001817934331484139, 0.004398835822939873, 0.02033323422074318, 0.008232511579990387, -0.01848704181611538, -0.006025243550539017, -0.03227696940302849, -0.0028462132904678583, 0.002438041614368558, 0.009249800816178322, -0.03556746244430542, -0.006455393973737955, -0.048779670149087906, -0.01808515004813671, 0.030016325414180756, 0.023234395310282707, -0.001708041992969811, -0.01607568934559822, -0.005758361890912056, 0.009048854932188988, 0.018097709864377975, -0.019177794456481934, -0.024013061076402664, -0.001745719346217811, -0.04064135253429413, -0.0044333734549582005, -0.0005443599075078964, 8.340048952959478e-05, -0.009796123020350933, 0.007767823059111834, 0.03996315971016884, -0.017042743042111397, 0.006383178755640984, 0.010511993430554867, 0.02722819894552231, 0.02519361861050129, -0.03722526878118515, -0.003469460178166628, -0.07460124790668488, 0.005255996715277433, -0.017231129109859467, 0.015924979001283646, -0.045438941568136215, 0.010367563925683498, 0.0020644073374569416, 0.008697198703885078, -0.022242223843932152, -0.010901326313614845, 0.008150876499712467, 0.009934273548424244, 0.008609284646809101, 0.011679993011057377, 0.02579645812511444, 0.015209109522402287, -0.003968685865402222, -0.004307782277464867, 0.0029969229362905025, -0.01478209812194109, 0.021337965503335, 0.008006446994841099, -0.017821408808231354, -0.029714906588196754, -0.02418888919055462, -0.0014741281047463417, 0.015209109522402287, 0.0179469995200634, -0.03657219186425209, -0.037752751260995865, 0.0134382713586092, -0.009557499550282955, 0.02150123380124569, -0.0007880855700932443, 0.006725415121763945, -0.003767739748582244, -0.012176078744232655, -0.0576213002204895, 0.019717836752533913, 0.03127223998308182, -0.0208230409771204, 0.02091095596551895, 0.012540293857455254, 0.012238874100148678, 0.031774602830410004, 0.014066227711737156, -0.02981537953019142, -0.012791476212441921, 0.004533846862614155, 0.022053835913538933, -0.03127223998308182, 0.0009223112720064819, 0.0064020175486803055, 0.051492441445589066, -0.010675262659788132, 0.024854522198438644, 0.00625758757814765, -0.010493154637515545, 0.002704923041164875, 0.050161175429821014, 0.01293590571731329, -0.004659438040107489, -0.08143341541290283, 0.024440070614218712, 0.018449364230036736, -0.0007668919861316681, 0.00030750251607969403, 0.04096788913011551, -0.022882739081978798, -0.0014364507514983416, -0.010480595752596855, 0.021325405687093735, 0.037124793976545334, -0.013400593772530556, 0.042801521718502045, 0.011058315634727478, 0.00141368736512959, 0.0412190705537796, -0.018235860392451286, 0.017733493819832802, 0.008119478821754456, 0.0045558251440525055, -0.036923848092556, -0.013400593772530556, 0.002882320899516344, 0.017381839454174042, 0.0268765427172184, -0.009927993640303612, -0.02302088961005211, -0.0007146931020542979, 0.02231757715344429, 0.018901493400335312, 0.015246786177158356, 0.0015259345527738333, -0.0054914806969463825, -0.01121530495584011, -0.009846359491348267, -0.02883576788008213, 0.010417800396680832, -0.018851257860660553, 0.03566793352365494, 0.03310587257146835, 0.028107337653636932, -0.03152342140674591, -0.00046115563600324094, 0.00975844543427229, 0.0004376072611194104, -0.016201280057430267, -0.02210407331585884, 0.0449114553630352, -0.006084899418056011, 0.018047472462058067, 0.029036713764071465, -0.01345083024352789, 0.009997068904340267, 0.0007602199912071228, -0.028986476361751556, 0.02622346766293049, 0.04131954535841942, 0.02386235073208809, 0.01808515004813671, 0.007962489500641823, -0.0009803972207009792, 0.031699251383543015, -0.02460334077477455, 0.0011593649396672845, -0.016326872631907463, 0.014556034468114376, 0.042776405811309814, 0.003566793631762266, -0.046092014759778976, 0.053501904010772705, 0.03514045104384422, 0.022392932325601578, 0.014794657938182354, -0.025407124310731888, -0.017871644347906113, 0.018474483862519264, -0.010135219432413578, 6.971299444558099e-05, -0.010053585283458233, -0.0200066976249218, -0.024854522198438644, 0.024226566776633263, 0.023711642250418663, 0.031071292236447334, 0.004320341628044844, 0.019881106913089752, -0.009676811285316944, 0.03453761339187622, 0.006725415121763945, -0.046443670988082886, -3.5837678296957165e-05, 0.0016483861254528165, -0.012169798836112022, 0.0010282789589837193, 0.014166700653731823, -0.013224766589701176, 0.031046174466609955, -0.006329802796244621, -0.0006051931995898485, 0.012333068065345287, -0.022242223843932152, -0.008728597313165665, 0.023774437606334686, -0.015485409647226334, -0.016339430585503578, 0.018939170986413956, 0.020860718563199043, -0.0017190312501043081, 0.018386568874120712, -0.03996315971016884, 0.017231129109859467, -0.03599447384476662, -0.029991207644343376, 0.015108635649085045, -0.021463556215167046, -0.01672876439988613, 0.008433457463979721, -0.024100974202156067, -0.003915309440344572, -0.03559258207678795, -0.019027085974812508, -0.03622053563594818, 0.004700255114585161, 0.031096411868929863, -0.01291078794747591, -0.005921630654484034, 0.011146229691803455, -0.018637752160429955, 0.030769873410463333, -0.024904759600758553, -0.01525934599339962, -0.03358311951160431, -0.0008249779930338264, -0.027328671887516975, -0.014041109941899776, -0.005290534347295761, -0.017444634810090065, 0.025080587714910507, 0.03215137869119644, 0.0121509600430727, -0.002188428770750761, -0.04358018934726715, -0.017356719821691513, 0.005325071979314089, 0.05696822330355644, -0.019190354272723198, -0.0009113220148719847, -0.007949930615723133, 0.010788294486701488, 0.04408255219459534, -0.02243060991168022, 0.011749068275094032, -0.009011177346110344, 0.02612299472093582, 0.024402393028140068, 0.02065977267920971, -0.0008336124010384083, -0.0014270313549786806, -0.008270188234746456, 0.01306149736046791, -0.01264076679944992, -0.011127390898764133, -0.021677061915397644, -0.02411353401839733, 0.008477414026856422, 0.010524552315473557, 0.0068761250004172325, 0.003877632087096572, 0.025746220722794533, -0.004232427570968866, 0.03684849292039871, 0.01832377351820469, 0.027303554117679596, -0.008508811704814434, -0.015548205934464931, 0.01525934599339962, -0.0348641499876976, -0.006380039267241955, -0.015497969463467598, -0.023146480321884155, 0.0060629211366176605, 0.009155607782304287, -0.010355004109442234, -0.016012893989682198, 0.003350148443132639, 0.031372711062431335, -0.0021617405582219362, 0.011523003689944744, 0.0189768485724926, 0.019290827214717865, 0.0068635656498372555, 0.012414702214300632, -0.007133587263524532, 0.004530706908553839, 0.015623560175299644, 0.01525934599339962, -0.04287687689065933, 0.007321974262595177, 0.002438041614368558, 0.04219868406653404, 0.012251432985067368, 0.00493573909625411, 0.04908108711242676, -0.003959266468882561, -0.020107170566916466, -0.0046876962296664715, 0.0030769873410463333, 0.023397663608193398, 0.027303554117679596, 0.019315944984555244, 0.03051869198679924, 0.015975216403603554, -0.01475698035210371, 0.002502407180145383, -0.046142250299453735, 0.025243856012821198, -0.042173564434051514, -0.013111733831465244, 0.018763342872262, -0.004266965202987194, -0.003635868662968278, 0.0009183865622617304, -0.06651316583156586, 0.0006754458299838006, -0.010650143958628178, -0.0016687946626916528, 0.020760245621204376, 0.00526855606585741, 0.007937371730804443, 0.036094944924116135, 0.027680328115820885, -0.03325658291578293, 0.008276468142867088, 0.008640683256089687, 0.01759534329175949, -0.004188470542430878, -0.015975216403603554, 0.00030436270753853023, -0.005208900198340416, 0.01708042062819004, -0.008257629349827766, 0.0008948381873778999, -0.0032465357799082994, 0.012540293857455254, 0.040113866329193115, -0.020509062334895134, -0.015811948105692863, 0.06164022162556648, -0.025181060656905174, 0.00326851406134665, -0.0011648595100268722, 0.0026829445268958807, 0.02432703971862793, -0.004697115626186132, 0.009425628930330276, -0.029363250359892845, 0.0006208920967765152, -0.02712772600352764, 0.034713439643383026, -0.007121027912944555, 0.013325239531695843, 0.007987608201801777, -0.006310964003205299, 0.0021366223227232695, 0.043881606310606, 0.009827520698308945, 0.003447481896728277, 0.023925146088004112, 0.0011279670288786292, -0.028283165767788887, -0.032076023519039154, -0.03968685865402222, 0.011252982541918755, -0.029639551416039467, 0.03971197456121445, 0.008967220783233643, 0.022166868671774864, -0.021111901849508286, -0.03320634365081787, -0.03865700960159302, -0.019805751740932465, 0.02612299472093582, 0.012709842063486576, -0.02853434905409813, 0.021400760859251022, -0.0129233468323946, -0.006081759929656982, 0.013664335943758488, 0.00611629756167531, -0.015209109522402287, 0.0030518691055476665, -0.013676894828677177, 0.003990664146840572, -0.004053459968417883, 0.00921840313822031, -0.018286095932126045, -0.00289801973849535, 0.025896931067109108, 0.011296939104795456, 0.01778373122215271, -0.017633020877838135, 0.018713107332587242, -0.01941641792654991, -0.01252773404121399, 0.007560597732663155, 0.004496169276535511, 0.004182191099971533, -0.014455561526119709, -0.024427512660622597, -0.036321010440588, -0.023008329793810844, -0.01778373122215271, -0.0475739911198616, -0.0005184566834941506, -0.00493573909625411, 0.0013972034212201834, -0.016954828053712845, 0.004810147453099489, 0.0115920789539814, -0.0017943859566003084, -0.009657972492277622, -0.013312679715454578, -0.014204378239810467, -0.009343994781374931, 0.0292376596480608, 0.01171767059713602, 0.018801020458340645, -0.030694518238306046, 0.007190103176981211, -0.01394063699990511, -0.011749068275094032, -0.005755222402513027, 0.01740695722401142, 0.049784399569034576, -0.0237869955599308, 0.005604512523859739, 0.016552936285734177, -0.02855946682393551, -0.005629631225019693, 0.015196549706161022, -0.009840080514550209, -0.006144555285573006, -0.03363335505127907, 0.01834889128804207, -0.01925314962863922, 0.009789843112230301, 0.0055793942883610725, -0.036421481519937515, 0.0028116756584495306, -0.00803784467279911, 0.007171264383941889, 0.018022354692220688, -0.0029796541202813387, -0.05254741013050079, -0.01024825219064951, 0.03762716054916382, 0.02690166048705578, 0.03694896772503853, -0.014317410998046398, -0.011780465953052044, 0.004386276938021183, -0.022191986441612244, 0.03363335505127907, -0.01990622468292713, -0.0017284505302086473, -0.012810315005481243, 0.005070749670267105, 0.004772470332682133, -0.006894963793456554, 0.0016468161484226584, 0.00010420155012980103, -0.017369279637932777, 0.0203081164509058, -0.021915685385465622, -0.0012339347740635276, -0.03144806623458862, -0.04928203299641609, -0.006210491061210632, -0.021815212443470955, 0.008502532728016376, -2.912884610850597e-06, -0.001810084911994636, 0.02612299472093582, 0.002455310430377722, -0.006467952858656645, 0.0004627255257219076, -0.0024160631000995636, 0.01860007457435131, 0.01789676398038864, -0.023196717724204063, 0.03551722690463066, 0.028358520939946175, 0.019868547096848488, 0.0055009000934660435, 0.0038713524118065834, 0.03714991360902786, -0.027002133429050446, 0.006069200579077005, 0.014706743881106377, -0.010342445224523544, 0.019717836752533913, -0.020534181967377663, -0.005905931815505028, -0.006398878060281277, -0.00788713525980711, 0.03720014914870262, 0.021890567615628242, 0.03993804007768631, 0.004722233861684799, -0.02334742620587349, 0.007208941970020533, 0.021300287917256355, -0.010825972072780132, -0.022819943726062775, -0.0022590740118175745, 0.017419517040252686, -0.0038368147797882557, 0.0011146229226142168, 0.025997404009103775, 0.0005482846172526479, 0.010311047546565533, -0.021903127431869507, 0.013011260889470577, -0.018072592094540596, 0.029061831533908844, 0.013902959413826466, -0.008571607992053032, -0.0098965959623456, -0.020082052797079086, -0.006763092707842588, 0.009965671226382256, -0.00493573909625411, 0.010053585283458233, 0.004634319804608822, 0.0006440479774028063, 0.0013972034212201834, 0.001264547579921782, 0.0015008163172751665, -0.012647045776247978, 0.02956419624388218, 0.005243437830358744, 0.02388746850192547, 0.007190103176981211, 0.009187005460262299, 0.058877211064100266, 0.00678193150088191, 0.04832753911614418, 0.004072298761457205, -0.008081801235675812, -0.015359818935394287, -0.03893331065773964, 0.05234646424651146, 0.018034914508461952, 0.002279482549056411, 0.008194833993911743, 0.01895173080265522, 0.008747435174882412, 0.028308283537626266, -0.002937267068773508, 0.02538200654089451, 0.02280738390982151, -0.005755222402513027, -0.002124063204973936, 0.003325030207633972, -0.002379955491051078, -0.009708208963274956, -0.01778373122215271, 0.018047472462058067, 0.014832335524260998, 0.018939170986413956, -0.012107003480196, 0.00883534923195839, 0.008847909048199654, 0.0070833503268659115, 0.014895130880177021, 0.002318729879334569, -0.0067944903858006, -0.019341062754392624, -0.009513542987406254, 0.03082011081278324, -0.010355004109442234, 0.01932850480079651, 0.013551303185522556, -0.011252982541918755, 0.0013453970896080136, 0.0029121488332748413, 0.04232427477836609, 0.010800853371620178, 0.00920584425330162, 0.0018399128457531333, -0.008998618461191654, 0.0012158809695392847, 0.036748021841049194, -0.010901326313614845, -0.011290660127997398, -0.0045652445405721664, -0.025620630010962486, -0.01574915088713169, 0.021162137389183044, -0.03594423457980156, -0.053250718861818314, -0.021840330213308334, -0.0292376596480608, -0.00047999434173107147, -0.011529283598065376, 0.026323940604925156, 0.022706910967826843, -0.026575123891234398, 0.017683258280158043, 0.01914011687040329, 0.006505630444735289, 0.02145099826157093, 0.0017645580228418112, -0.018185622990131378, 0.040741823613643646, -0.027730563655495644, -0.03184995800256729, -0.005767781287431717, 0.003610750427469611, 0.019366182386875153, -0.02644953317940235, 0.03245279937982559, 0.010920165106654167, 0.01677899993956089, 0.0036170301027595997, -0.025620630010962486, -0.019868547096848488, 0.01881358027458191, 0.0025432242546230555, 0.004395696334540844, -0.023121362552046776, 0.007391049060970545, 0.0026546865701675415, -0.010273369960486889, 0.00352597632445395, -0.009978230111300945, -0.006147695239633322, 0.008684639818966389, 0.007478963118046522, -0.007359651383012533, -0.0120002506300807, -0.023359986022114754, 0.00611629756167531, -0.0036233095452189445, -0.00806296244263649, 0.010066144168376923, 0.00020879556541331112, -0.003416083985939622, -0.011083434335887432, -0.0243019200861454, -0.005786620080471039, 0.0149202486500144, 0.006288985256105661, -0.009011177346110344, 0.043881606310606, 0.005004814360290766, 0.013388034887611866, -0.024364717304706573, -0.004750491585582495, -0.011259262450039387, -0.03212625905871391, -0.041420016437768936, 0.0082011129707098, -0.019341062754392624, 0.007730145938694477, -0.008621844463050365, 0.04325365275144577, -0.001670364523306489, -0.010982961393892765, -0.012847992591559887, -0.04993510991334915, 0.031121529638767242, -0.015786828473210335, 0.007924812845885754, -0.035743288695812225, 0.026575123891234398, 0.02587181143462658, 0.031146647408604622, 0.0046657174825668335, 0.019617363810539246, -0.024402393028140068, -0.000549069547560066, 0.0036923848092556, 0.0056107924319803715, 0.007924812845885754, 0.010486875660717487, -0.03260350599884987, -0.032703980803489685, -0.021350525319576263, -0.0022229664027690887, -0.031347595155239105, -0.002546363975852728, 0.04365554451942444, -0.013312679715454578, 0.012797756120562553, -0.02565830759704113, 0.013877840712666512, 0.03524092584848404, 0.03903378173708916, -0.022593878209590912, 0.013827604241669178, 0.03355799987912178, 0.006650060415267944, 0.017394397407770157, -0.0003045589546673, 0.0001357956207357347, -0.030644282698631287, -0.00987147819250822, -0.0038368147797882557, 0.011384853161871433, -0.013877840712666512, -0.02951396070420742, -0.008841629140079021, -0.011830702424049377, -0.002742600394412875, -0.011516723781824112, -0.012069325894117355, -0.005183781962841749, 0.025369446724653244, 0.019014526158571243, 0.033708710223436356, 0.003026750870049, -0.0084146186709404, -0.02981537953019142, -0.015183990821242332, -0.013463390059769154, -0.012534013949334621, 0.029966089874505997, -0.02079792320728302, 0.0019042784115299582, -0.022656673565506935, -0.005990705918520689, 0.01757022552192211, -0.0073470924980938435, 0.02109934203326702, -0.0027017833199352026]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
" quantize them
separately. Because the number of tokens in XKcan be ar-
bitrary, we split XKinto two parts, namely, the grouped part
XKg=XK[:l−r]and residual part XKr=XK[l−r:],
where lis the number of tokens inside the current key cache
XK,ris the number of residual tokens, where l−rcan be
divisible by G.
SinceXKgcan be evenly divided into (l−r)/Ggroups,
we only store Q(XKg)with group-wise quantization, while
XKris kept in full precision. During the decoding process,
each newly arrived key cache tKis added to XKrand once
XKrreaches Rtokens, which is a hyperparameter - residual
length, we quantize and concatenate it with the previously
quantized Q(XKG). Then we reset XKrto an empty tensor.
We note that Rshould be divisible by G. With tiled matrix
multiplication, the raw attention logits is then calculated as:
Ag=tQQ(X⊤
Kg),
XKr=Concat ([XKr,tK]),
Ar=tQX⊤
Kr,
A=Concat ([Ag,Ar]). (3)
For value cache, similar to key cache, we also split it into
two parts and keep the most recent value cache in full pre-
cision, namely, XVgandXVr. Specifically, we maintain a
queue and each newly arrived value cache is pushed into
the queue. Once the queue reaches the predefined residual
length R, the most outdated value cache is poped. Then the
poped value cache is quantized per-token and concatenated
with the previously quantized value cache along the token
dimension.
As shown in Figure 3, we also emphasize that during the
prefill phase, the exact key and value tensors are passed to
the next layers, although only the quantized KV cache is
retained in memory. The whole algorithm can be found in
Appendix A Algorithm 1.
5
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
Analysis. InKIVI , the grouped key cache XKgand value
cacheXVgis quantized, while the residual key cache XKr
and value cache XVris kept in full precision. By design,
there are at most Rtokens inside XKrorXVr. In practice,
we set R≤128and the sequence length lprompt +lgenis
often much longer than R. Thus the memory overhead from
XKrandXVris negligible when considering the benefit
from extreme low-bit quantization, especially for the long
context scenarios. Also, since the newly arrived key and
value tensors are added to XKrandXVrin full precision,
KIVI maintains a full precision KV cache sliding window
for the local relevant tokens. This window size is expected
to beR
2for key cache, and Rfor value cache. Later in the
experiment section, we show that this full precision sliding
window is crucial for obtaining desirable performance on
hard tasks, such as GSM8K.
System Support. We provide a hardware-friendly imple-
mentation for running KIVI on GPUs. To minimize the
overhead, we have fused the dequantization process with
matrix multiplication, e.g., Q_MatMul in Figure 3, using
CUDA. We also implement the group-wise quantization ker-
nel in Triton. Our method is fully compatible with weight-
only quantization.
4. Experiments
4.1. Settings
Models. We evaluate KIVI using two popular recent
model families: Llama/Llama-2 (Touvron et al., 2023a;b)),
Falcon (Penedo et al., 2023) and Mistral (Jiang et al., 2023).
We note that the Llama and Mistral model is based on multi-
head attention, while Falcon is based on multi-query atten-
tion (Shazeer, 2019). We use the Hugging Face Transform-
ers codebase and implement the KIVI algorithm based on
it. Following previous work (Sheng et al., 2023), the group
sizeGin Algorithm 1 for quantization is set as 32 across all
experiments, the residual length Rfor key and value cache
is set to 128.
Tasks. As we analyzed in Section 2, the KV cache size
grows larger with longer context. Thus we evaluate KIVI
under the normal context length and long context setting,
respectively. Specifically, we adopt generation tasks from
LM-Eval (Gao et al., 2021) for normal context length eval-
uation and LongB","[0.005147949792444706, 0.04080895707011223, 0.0355907641351223, -0.029703568667173386, -0.0055928342044353485, -0.012289517559111118, 0.02119389735162258, 0.03425276651978493, -0.032486606389284134, 0.020832639187574387, 0.02203683741390705, 0.029489489272236824, -0.05881841853260994, 0.018089741468429565, -0.0009683765238150954, 0.0015997446607798338, 0.008228691294789314, -0.0017210007645189762, -0.040166717022657394, 0.019909419119358063, -0.015065864659845829, -0.05587482452392578, -0.003084086813032627, 0.033423203974962234, 0.030265528708696365, -0.06053105741739273, -0.03484148532152176, 0.0025304898153990507, 0.049398910254240036, -0.04765951260924339, 0.014048985205590725, -0.01713976263999939, -0.052556585520505905, -0.06465209275484085, -0.018959440290927887, 0.026331812143325806, 0.007285402622073889, 0.004017340950667858, -0.028178250417113304, 0.01760806143283844, 0.02887400984764099, -0.04642855376005173, -0.05785506218671799, 0.010737438686192036, 0.034948524087667465, 0.0336640439927578, 0.005288439802825451, 0.0018966130446642637, -0.07268008589744568, 0.036072444170713425, -0.019722100347280502, 0.05844378098845482, -0.07626592367887497, -0.011332848109304905, 0.021341077983379364, 0.02697405219078064, 0.011955018155276775, -0.026639552786946297, 0.04086247831583023, -0.030854247510433197, -0.004522435367107391, -0.0748744010925293, 0.011901497840881348, 0.011888117529451847, -0.006409013643860817, 0.03567104414105415, -0.02334807626903057, 0.006315353326499462, 0.01376800611615181, -0.011881427839398384, -0.014945444650948048, 0.03393164649605751, -0.011011729016900063, -0.026840252801775932, -0.025207893922924995, 0.035135842859745026, 0.008449461311101913, 0.01735384203493595, 0.03141620755195618, -0.011727557517588139, 0.027402210980653763, -0.01735384203493595, 0.03631328418850899, -0.022157257422804832, 0.01289161667227745, -0.02587689273059368, -0.0318978875875473, -0.011265948414802551, -0.03146972879767418, -0.014918684959411621, -0.04420747607946396, 0.031764086335897446, -0.05491146445274353, 0.001868180581368506, 0.03914983943104744, 0.0015972359105944633, 0.04420747607946396, -0.027014192193746567, 0.0033065290190279484, 0.023548776283860207, 0.011352918110787868, 0.013386676087975502, 0.04980031028389931, -0.0018012806540355086, 0.058336738497018814, -0.004853589925915003, -0.02247837744653225, 0.040594879537820816, -0.01910662092268467, 0.0049807000905275345, -0.04345819726586342, 0.005699874367564917, -0.03055988810956478, 0.007492792326956987, -0.011794458143413067, -0.04062163829803467, -0.07808560132980347, -0.026920532807707787, -0.025676194578409195, -0.02229105681180954, -0.018999580293893814, 0.0027512595988810062, 0.03698228299617767, -0.013286326080560684, 0.0016875508008524776, -0.025997312739491463, 0.045411672443151474, -0.05306502431631088, -0.010463149286806583, -0.022331196814775467, 0.021247418597340584, -0.001321273623034358, 0.06668584793806076, 0.01479826495051384, 0.004599370062351227, -0.033048566430807114, 0.002378292614594102, 0.06534785032272339, -0.050121430307626724, 0.019441120326519012, -0.02494029514491558, -0.033048566430807114, 0.016149643808603287, -0.016444003209471703, -0.029275409877300262, 0.009479720145463943, -0.040032919496297836, 0.026358572766184807, -0.018705220893025398, -0.007639972027391195, -0.021501637995243073, -0.010784269310534, -0.008630091324448586, -0.020190399140119553, -0.026545893400907516, 0.006315353326499462, -0.011546928435564041, 0.0007179199019446969, 0.03901603817939758, -0.020578419789671898, -0.020805878564715385, 0.01059694867581129, 0.04972003027796745, -0.02060517854988575, -0.023522015661001205, 0.006686648353934288, -0.06534785032272339, 0.012991966679692268, -0.05410866439342499, -0.02179599739611149, 0.003025549463927746, -0.01566796377301216, -0.021675577387213707, -0.030452849343419075, 0.015119384042918682, -0.024017075076699257, -0.0450102724134922, 0.013681036420166492, -0.006569573190063238, -0.04217371717095375, -0.039845600724220276, 0.035510484129190445, -0.0008027991862036288, 0.045277874916791916, -0.02863316982984543, -0.009011420421302319, -0.006539468187838793, 0.012476837262511253, -0.010061749257147312, 0.047338392585515976, 0.004231420811265707, 0.019280560314655304, 0.06604361534118652, 0.04482295364141464, 0.028338810428977013, -0.01412926521152258, -0.004368565510958433, -0.011446578428149223, -0.02465931512415409, 0.018036222085356712, 0.013420126400887966, 0.041477955877780914, 0.027147991582751274, -0.06871961057186127, 0.06074513867497444, -0.030640168115496635, -0.016845403239130974, 0.01564120315015316, -0.07171672582626343, -0.004351840354502201, -0.009767389856278896, 0.022772736847400665, 0.03931039944291115, 0.006194933783262968, -0.012423316948115826, 0.02184951677918434, -0.05544666200876236, 0.033075325191020966, 5.9635018260451034e-05, 0.058176178485155106, 0.013848286122083664, 0.0074660321697592735, 0.0029034570325165987, 0.005097774788737297, -0.04565251246094704, 0.048596110194921494, -0.00983428955078125, 0.00040286302100867033, 0.008737131021916866, -0.04972003027796745, 0.047472190111875534, 0.0007685129530727863, -0.01527994405478239, -0.015119384042918682, -0.019962940365076065, -0.05828322097659111, -0.014691225253045559, -0.03634004294872284, 0.0014508923050016165, -0.02391003631055355, 0.009707179851830006, 0.024405095726251602, 0.011888117529451847, -0.007178362458944321, -0.020966438576579094, 0.009439580142498016, -0.03799916058778763, -0.04305679723620415, 0.04629475250840187, -0.03331616520881653, -0.03695552051067352, -0.01657780259847641, -0.044100433588027954, 0.008014611899852753, -0.049398910254240036, -0.01451728492975235, 0.015266564674675465, 0.0402737595140934, -0.01954815909266472, 0.012162407860159874, -0.019775619730353355, -0.054429784417152405, -0.031576767563819885, -0.010650468990206718, -0.01695244200527668, -0.0025037298910319805, -0.021086858585476875, 0.034359805285930634, -0.02259879745543003, -0.051646746695041656, -0.00836918130517006, -0.03593864291906357, -0.006342113483697176, -0.011553618125617504, 0.017220042645931244, 0.02688039280474186, 0.018223540857434273, -0.015480644069612026, -0.05384106561541557, 0.011493408121168613, -0.0009215465397574008, 0.0029084745328873396, 0.03877520188689232, -0.00783398188650608, -0.0105501189827919, 0.01048990897834301, -0.0011916550574824214, 0.028900770470499992, -0.005954093765467405, -0.006402323488146067, 0.0637957751750946, 0.0011264275526627898, 0.02863316982984543, -0.01208212785422802, -0.008937831036746502, 0.023334696888923645, -0.025341693311929703, -0.006051098927855492, 0.00810158159583807, -0.03074720874428749, 0.03567104414105415, 0.028713449835777283, 0.009111770428717136, 0.001681696972809732, -0.036634404212236404, 0.03361052647233009, 0.022050216794013977, 0.02179599739611149, -0.027335312217473984, 0.019213659688830376, 0.04067515954375267, 0.01945449970662594, -0.0010411301627755165, 0.059674739837646484, -0.0327274464070797, -0.048435550183057785, 0.004706410225480795, -0.0023883276153355837, 0.07235896587371826, -0.004877004772424698, 0.0261980127543211, -0.07797855883836746, -0.01617640256881714, 0.03668792173266411, 0.024364955723285675, -0.015788383781909943, -0.024338195100426674, -0.010536739602684975, -0.004639510065317154, -0.01648414321243763, 0.0046595800668001175, 0.014503905549645424, 0.019400980323553085, -0.016724983230233192, -0.05325234681367874, -0.02681349217891693, -0.018210161477327347, -0.007245262619107962, 0.0047498950734734535, -0.02397693507373333, -0.0731617659330368, 0.0005042582051828504, 0.011232498101890087, 0.013433505780994892, -0.00778046203777194, 0.06144089624285698, 0.037571001797914505, 0.008462841622531414, 0.055553704500198364, -0.012838097289204597, 0.011653968133032322, -0.028526131063699722, 0.002652582246810198, -0.07160968333482742, 0.012316277250647545, -0.04364551603794098, 0.019253799691796303, -0.015882043167948723, -0.06454505026340485, 0.003202834166586399, -0.03786535933613777, 0.020658697932958603, 0.043752554804086685, 0.01212895754724741, -0.005014149937778711, -0.011901497840881348, -0.020685458555817604, 1.7508966720924946e-06, -0.011975088156759739, -0.003572456305846572, 0.01651090383529663, 0.0013965360121801496, -0.04343143478035927, -0.05662410333752632, -0.009673730470240116, -0.03824000060558319, 0.03128240630030632, 0.06336761265993118, 0.027616292238235474, 0.004649545066058636, 0.04463563486933708, -0.0062952833250164986, -0.002555577317252755, 0.007920951582491398, 0.037356920540332794, 0.01982913911342621, 0.012215927243232727, 0.011005038395524025, -0.07433920353651047, 0.03393164649605751, -0.03315560519695282, 0.013293016701936722, -0.016149643808603287, 0.007492792326956987, 0.009118461050093174, -0.0031125193927437067, 0.0038066061679273844, 0.00164490204770118, 0.047338392585515976, 0.05646354332566261, 0.016470763832330704, -0.017996082082390785, -0.024030454456806183, 0.0009274003095924854, -0.0020120153203606606, -0.0025455423165112734, 0.013941945508122444, 0.015065864659845829, 0.01570810377597809, 0.0022946675308048725, 0.0012108887312933803, -0.048034150153398514, 0.03898927941918373, -0.04624123126268387, -0.0032312667462974787, -0.011225808411836624, -0.011901497840881348, 0.014276444911956787, 0.047311630100011826, 0.08167143911123276, -0.02275935746729374, -0.01214233785867691, -0.07449976354837418, -0.05121858790516853, -0.008549811318516731, 0.010536739602684975, -0.006546158343553543, -0.05327910557389259, 0.011807837523519993, -0.03422600403428078, -0.01735384203493595, 0.0011640588054433465, 0.017179902642965317, 0.0016047621611505747, -0.04201315715909004, -0.020243918523192406, -0.010028299875557423, 0.03612596169114113, -0.03489500284194946, -0.009018111042678356, -0.01158037781715393, -0.056088902056217194, 0.011239188723266125, 0.003452036529779434, -0.029917649924755096, 0.032673925161361694, -0.02085939794778824, -0.023829756304621696, 0.038694921880960464, -0.04008644074201584, 0.028552889823913574, 0.006445808336138725, 0.05903249979019165, 0.0024267949629575014, 0.03733016178011894, -0.1050596535205841, 0.08391927182674408, 0.004241455812007189, 0.011286018416285515, -0.02388327568769455, 0.001812988193705678, 0.008329041302204132, -0.04046107828617096, 0.0026709798257797956, 0.028419090434908867, 0.02322765626013279, 0.0061012739315629005, 0.03502880409359932, 0.013373296707868576, 0.0024083976168185472, -0.018972819671034813, -0.05908602103590965, 0.008248761296272278, -0.014182785525918007, -0.033423203974962234, -0.026264913380146027, 0.021488258615136147, -0.025729713961482048, -0.0011782750952988863, 0.0022344577591866255, -0.0021508329082280397, -0.009914569556713104, -0.006843863055109978, 0.015962323173880577, 0.014584184624254704, 0.08300943672657013, 0.03031904809176922, -0.006639818195253611, 0.03650060296058655, -0.012008537538349628, -0.031202128157019615, 0.006766927894204855, 0.019494639709591866, -0.014731365256011486, 0.048087671399116516, 0.03141620755195618, 0.011172288097441196, -0.0201101191341877, -0.004873659927397966, -0.02962329052388668, 0.02887400984764099, 0.04784683138132095, 0.06090569868683815, 0.03698228299617767, -0.011433198116719723, 0.02868669107556343, 0.01917351968586445, -0.0016616270877420902, 0.004117690958082676, 0.029703568667173386, 0.011600447818636894, -0.001717655686661601, 0.002373275114223361, 0.019869279116392136, -0.011399748735129833, 0.021675577387213707, 0.014263065531849861, 0.005589489359408617, -0.014370105229318142, 0.03526964411139488, -0.020364338532090187, -0.017875662073493004, -0.011265948414802551, -0.005689839366823435, 0.021327698603272438, -0.01190818753093481, -0.02522127330303192, -0.11592420190572739, -0.01214233785867691, -0.0318443663418293, 0.027134612202644348, -0.017848901450634003, -0.02425791509449482, 0.017099622637033463, -0.03031904809176922, -0.011399748735129833, 0.015908803790807724, -0.014584184624254704, 0.02144811861217022, 0.029676809906959534, 0.006375563330948353, -0.014664464630186558, 0.01988266035914421, 0.03037256933748722, -0.019186900928616524, 0.014744744636118412, 0.01608274318277836, -0.04230751842260361, -0.014597564935684204, 0.035109084099531174, 0.011694108135998249, -0.02182275801897049, 0.00848960131406784, -0.018036222085356712, -0.00811496190726757, 0.03449360281229019, 0.037731561809778214, 0.006803723052144051, -0.0384540818631649, 0.02999792993068695, 0.0327274464070797, 0.01048990897834301, 0.004274905659258366, -0.01273774728178978, -0.04519759491086006, -0.007553002331405878, 0.0328344851732254, 0.007626592181622982, 0.006382253486663103, 0.03031904809176922, -0.013607446104288101, -0.040782198309898376, 0.02831205166876316, -0.02245161682367325, 0.03205844759941101, -0.010911379009485245, -0.002264562761411071, 0.0057567390613257885, 0.023334696888923645, 0.04867639020085335, -0.031068328768014908, -0.0042347656562924385, -0.00038425647653639317, -0.03601892292499542, -0.03770480304956436, 0.014236305840313435, 0.0012309587327763438, 0.017835522070527077, -0.020939677953720093, 0.01679188199341297, 0.021060097962617874, -0.019775619730353355, 0.011914878152310848, 0.01320604607462883, -0.03262040764093399, -0.0038467461708933115, 0.011493408121168613, -0.03497528284788132, -0.04385959357023239, -0.002523799892514944, 0.0243515744805336, 0.01141312811523676, -0.012510287575423717, -0.004943904932588339, -0.04107655957341194, 0.06283241510391235, -0.012256067246198654, 0.006208313629031181, 0.019561540335416794, -0.03125564754009247, 0.0018966130446642637, -0.020752359181642532, -0.027696572244167328, -0.004616095218807459, -0.04533139243721962, -0.024860015138983727, -0.021836137399077415, -0.029730329290032387, 0.04062163829803467, -0.022398097440600395, 0.01845100149512291, -0.046936992555856705, -0.009138531051576138, 0.0009541602921672165, 0.006706717889755964, 0.03505556285381317, -0.019213659688830376, -0.048060908913612366, -0.03609920293092728, 0.031978167593479156, -0.02884725108742714, 0.015775004401803017, -0.0063621834851801395, 0.02222415804862976, 2.4251225113403052e-05, -5.195197809371166e-05, 0.00880403071641922, 0.006455843336880207, 0.013627516105771065, 0.0013329811627045274, 0.0365808829665184, 0.006679958198219538, 0.0038601260166615248, -0.03334292396903038, 0.035697802901268005, -0.009105080738663673, 0.024579035118222237, 0.02962329052388668, 0.002568957395851612, -0.020846018567681313, -0.013045486994087696, -0.06197609752416611, 0.03128240630030632, 0.030399328097701073, 0.03256688639521599, -0.015507403761148453, -0.026746593415737152, 0.0007873285794630647, -0.012684226967394352, -0.004164520651102066, -0.029489489272236824, -0.023187516257166862, -0.01601584441959858, -0.011888117529451847, 0.023361455649137497, 0.044689152389764786, 0.014985584653913975, 0.009279020130634308, -0.011199048720300198, 0.02222415804862976, 0.015386984683573246, 0.01819678209722042, 0.02097981795668602, -0.012904996983706951, 0.0037698112428188324, 0.011339538730680943, -0.016256682574748993, -0.016818642616271973, -0.0020069980528205633, 0.031924646347761154, -0.04565251246094704, 0.00021763384575024247, -0.07910247892141342, -0.029462730512022972, -0.012316277250647545, -0.012590566650032997, 0.03387812525033951, -0.01453066524118185, 0.009359300136566162, -0.04779331013560295, 0.018879160284996033, -0.00554265920072794, -0.009794149547815323, -0.01347364578396082, -0.034547124058008194, 0.017955942079424858, 0.007854051887989044, 0.025823373347520828, -0.012496907263994217, -0.020404478535056114, -0.021394597366452217, 0.010737438686192036, -0.029168369248509407, 0.002783037256449461, -0.043939873576164246, -0.0154538843780756, -0.021434737369418144, 0.022464996203780174, 0.06293945759534836, -0.03524288535118103, -0.012904996983706951, -0.0037664661649614573, -0.01982913911342621, 0.025207893922924995, -0.035162605345249176, 0.020377719774842262, 0.0005778481718152761, 0.01800946146249771, -0.007211812771856785, -0.016898922622203827, -0.030586648732423782, 0.03350348398089409, -0.03165704756975174, 0.0022712526842951775, 0.023963555693626404, 0.0009282365208491683, -0.007954401895403862, 0.010637088678777218, 0.008222001604735851, 0.03692876175045967, 0.0168855432420969, 0.013018726371228695, 0.00783398188650608, -0.022679077461361885, -0.007573072332888842, 0.007994541898369789, -0.04088923707604408, -0.009151910431683064, -0.04222723841667175, 0.0015253184828907251, -0.028927531093358994, -0.022050216794013977, -0.009205430746078491, 0.0403272770345211, 0.002846592105925083, 0.014396864920854568, 0.019722100347280502, 0.01556092407554388, 0.013299706391990185, -0.03567104414105415, -0.007325542625039816, 0.012309587560594082, -0.006850552745163441, -0.002132435329258442, 0.038320280611515045, -0.0014701259788125753, 0.025582533329725266, -0.016965823248028755, -0.025047333911061287, -0.000623841886408627, -0.004920490086078644, -0.027776852250099182, 0.007479412481188774, 0.02863316982984543, 0.015989083796739578, 0.011995158158242702, -0.010483219288289547, 0.0040541356429457664, 0.025636054575443268, 0.010262449271976948, -0.0038668159395456314, -0.019989699125289917, -0.007486102171242237, 0.04739191010594368, 0.03821324184536934, -0.05472414568066597, -0.0009892827365547419, -0.0016474107978865504, -0.009392750449478626, 0.05731986090540886, 0.024699455127120018, -0.01760806143283844, -0.015306704677641392, -0.025488873943686485, -0.002734534675255418, -0.009861050173640251, -0.010576879605650902, 0.001649083336815238, -0.008603331632912159, -0.015975704416632652, -0.01814326085150242, -0.010302589274942875, -0.01412926521152258, 0.0023164101876318455, -0.015012344345450401, 0.024873394519090652, -0.015025724656879902, -0.08643471449613571, -0.0384005606174469, 0.014878544956445694, 0.016470763832330704, 0.008395940996706486, 0.018330581486225128, -0.00881741102784872, -0.025702953338623047, -0.01847776025533676, -0.014557424932718277, 0.0011791113065555692, -0.007553002331405878, 0.02391003631055355, -0.01779538206756115, -0.012530357576906681, -0.05121858790516853, -0.012550427578389645, 0.003749741241335869, 0.025863513350486755, -0.00016463655629195273, -0.02266569621860981, 0.0018748706206679344, 0.0024686073884367943, 0.022491756826639175, -0.02353539504110813, -0.04423423483967781, 0.0029920993838459253, -0.03240632638335228, 0.0077202520333230495, 0.028017690405249596, -0.022491756826639175, -0.03053312934935093, -0.006231728475540876, 0.029543010517954826, -0.020645318552851677, 0.009446270763874054, -0.010637088678777218, 0.034199245274066925, 0.03545696288347244, -0.030827488750219345, 0.005857089068740606, -0.04578631371259689, 0.010108579881489277, 0.0034921765327453613, 0.045251112431287766, -0.02494029514491558, 0.030613409355282784, 0.02753601223230362, 0.011393058113753796, -0.0010904688388109207, 0.019561540335416794, 0.03168380632996559, 0.02069883793592453, 0.0027144646737724543, 0.008957901038229465, 0.03286124765872955, 0.019869279116392136, -0.008074821904301643, -0.02231781743466854, 0.011961707845330238, 0.0030539818108081818, 0.016336962580680847, -0.00419128080829978, -0.01490530464798212, -0.050656627863645554, -0.031014807522296906, 1.684257949818857e-05, 0.03462740406394005, 0.01564120315015316, -0.05560722202062607, -0.048060908913612366, 0.006807067897170782, -0.009312470443546772, -0.007840671576559544, 0.007365682628005743, -0.010683919303119183, -0.00031233904883265495, 0.007251952774822712, -0.06984353065490723, 0.018156642094254494, 0.03620624169707298, -0.03593864291906357, 0.010121959261596203, 0.0070913927629590034, 0.014169405214488506, 0.033423203974962234, 0.04650883376598358, -0.04399339482188225, -0.0024987123906612396, 0.010202239267528057, 0.02369595505297184, -0.021595297381281853, 0.006847207900136709, 0.0008341585053130984, 0.03634004294872284, 0.0011005038395524025, 0.024900155141949654, 0.010108579881489277, -0.01885240152478218, 0.01453066524118185, 0.03973855823278427, 0.02166219800710678, 0.012276137247681618, -0.07364344596862793, 0.00917867012321949, 0.0005439800443127751, 0.0014249685918912292, -0.007593142334371805, 0.028900770470499992, -0.028766971081495285, -0.007164982613176107, 0.014035605825483799, 0.026010693982243538, 0.042039915919303894, -0.008061441592872143, 0.05017494782805443, 0.01676512323319912, 0.00016714529192540795, 0.02887400984764099, -0.02231781743466854, 0.003293149173259735, 0.018062980845570564, -0.004284940659999847, -0.012550427578389645, -0.004271560814231634, 0.00042397831566631794, 0.013754625804722309, 0.0225051362067461, 0.009151910431683064, 0.001285314909182489, 0.009064940735697746, 0.039845600724220276, 0.01894606091082096, 0.017648201435804367, -0.004575955215841532, -0.017554542049765587, -0.0018062981544062495, -0.019253799691796303, 0.0038601260166615248, 0.01148671843111515, -0.008837481029331684, 0.013995465822517872, 0.05475090444087982, 0.009011420421302319, -0.026144493371248245, 0.006529433187097311, 0.02460579387843609, -0.01679188199341297, -0.02510085515677929, -0.010262449271976948, 0.019842520356178284, -0.01147333811968565, 0.008583261631429195, 0.021019957959651947, 0.013754625804722309, 0.010971589013934135, -0.01798270083963871, -0.029650049284100533, 0.020056599751114845, 0.05116506665945053, 0.02035095915198326, 0.02241147682070732, -0.013012036681175232, -0.007619902025908232, 0.03885548189282417, -0.013901805505156517, -0.004268215503543615, -0.01707286201417446, 0.00040746238664723933, 0.03339644521474838, 0.0032914765179157257, -0.03425276651978493, 0.04645531252026558, 0.03160352632403374, 0.029890889301896095, 0.022157257422804832, -0.010061749257147312, -0.04383283481001854, 0.03237956762313843, -0.014115885831415653, -0.001717655686661601, 0.02245161682367325, -0.023187516257166862, -0.025702953338623047, 0.029462730512022972, 0.015052484348416328, 0.012095507234334946, 0.010369488969445229, 0.028526131063699722, 0.02831205166876316, 0.015507403761148453, 0.007185052614659071, -0.04268215596675873, 0.0051512946374714375, 4.586303839460015e-05, -0.004609405063092709, 0.0055025191977620125, 0.00942620076239109, -0.013400056399405003, 0.0327809676527977, -0.016470763832330704, 0.016564423218369484, -0.027643050998449326, -0.019615059718489647, -0.015132764354348183, 0.024900155141949654, -0.012577187269926071, -0.021421357989311218, 0.002428467618301511, 0.01651090383529663, -0.017835522070527077, -0.0038801960181444883, -0.03128240630030632, 0.01804960146546364, -0.005820293910801411, -0.007131532765924931, 0.006924143061041832, -0.013152526691555977, -0.03639356419444084, -0.024298055097460747, -0.03676820173859596, -0.0043250806629657745, -0.027964171022176743, -0.003960475791245699, -0.029489489272236824, 0.009111770428717136, 0.008884310722351074, -0.01945449970662594, -0.008556501008570194, 0.031576767563819885, -0.007680112030357122, 0.030988048762083054, -0.031389448791742325, -0.029543010517954826, -0.028740210458636284, 0.0001524063991382718, -0.013848286122083664, -0.025020575150847435, -0.01657780259847641, -0.010891309008002281, 0.03320912644267082, 0.03318236768245697, -0.009352610446512699, 0.009452960453927517, -0.026238152757287025, -0.0007430073455907404, 0.0058470540679991245, 0.04530463367700577, -0.029730329290032387, 0.01854466088116169, -0.003253009170293808, -0.017996082082390785, 0.03347672522068024, -0.0038935760967433453, 0.01387504581362009, 0.001106357667595148, 0.032513365149497986, 0.03858787938952446, 0.019962940365076065, -0.008462841622531414, -0.017527781426906586, 0.00017812107398640364, 0.006014303769916296, -0.03334292396903038, 0.0021876278333365917, -0.020966438576579094, -0.002301357686519623, 0.009533240459859371, 0.010142029263079166, 0.019989699125289917, -0.012302896939218044, 0.02484663389623165, -0.0009365990408696234, 0.03807944059371948, -0.007318852469325066, 0.01932070031762123, -0.019334079697728157, -0.007379062473773956, 0.014463765546679497, -0.026478992775082588, -0.020712219178676605, -0.013888426125049591, -0.02409735508263111, 0.01554754376411438, 0.0017761931521818042, -0.02756277099251747, -0.013580686412751675, -0.01657780259847641, 0.03430628404021263, -0.0091318404302001, 0.03395840525627136, 0.025060715153813362, 0.011821217834949493, -0.00494724977761507, 0.03302180767059326, -0.005632974207401276, -0.0036661161575466394, 0.00204044790007174, 0.011827907525002956, -0.04276243597269058, 0.0023532051127403975, 0.005559384357184172, 0.023522015661001205, -0.0013170924503356218, 0.01732708141207695, 0.020003080368041992, 0.0057567390613257885, -0.027214892208576202, -0.01206874754279852, 0.026331812143325806, 0.016256682574748993, 0.020752359181642532, 0.00555603951215744, 0.024405095726251602, 0.012496907263994217, -0.02020377852022648, -0.004833519924432039, -0.047124311327934265, -0.0013555599143728614, -0.03478796407580376, -0.013995465822517872, 0.030479608103632927, -0.00977407954633236, 0.0010001539485529065, 0.007425892166793346, -0.050308749079704285, -0.0010453114518895745, -0.0011138838017359376, -0.002843247028067708, 0.011419818736612797, 0.005104464944452047, 0.013714485801756382, 0.009466339834034443, 0.02847261168062687, -0.02241147682070732, -0.014610945247113705, -0.003435311373323202, -0.0004678813857026398, 0.005224884487688541, 0.0024585723876953125, 0.005248299799859524, 0.026425473392009735, 0.0027228272520005703, -0.015721483156085014, -0.004368565510958433, -0.0031593493185937405, 0.005589489359408617, 0.03339644521474838, 0.006221693474799395, -0.017220042645931244, 0.054215703159570694, -0.0036828413140028715, -0.009171980433166027, -0.015841903164982796, -0.006154793780297041, 0.018277062103152275, 0.004505710210651159, 0.017273562029004097, -0.033637285232543945, 0.008248761296272278, -0.026612792164087296, 0.0031994893215596676, 0.0004825157520826906, 0.02554239332675934, -0.0065996781922876835, -0.01776862144470215, -0.009279020130634308, 0.032299287617206573, -0.001904975506477058, -0.012229307554662228, 0.02348187565803528, -0.00445553520694375, 0.0001785391941666603, -0.024980435147881508, -0.030024688690900803, -0.006890692748129368, -0.015400364063680172, 0.03427952527999878, 0.036634404212236404, 0.02453889511525631, -0.0008115798118524253, -0.03181760758161545, -0.02924864925444126, -0.03171056881546974, 0.03430628404021263, 0.023107236251235008, -0.018504520878195763, 0.0318978875875473, 0.025997312739491463, -0.005157984793186188, 0.014570805244147778, 0.027803611010313034, -0.006168173626065254, 0.000619660597294569, -0.020779117941856384, -0.009305780753493309, 0.005094429943710566, 0.008175171911716461, -0.01415602583438158, 0.0028783695306628942, 0.023896655067801476, 0.004780000075697899, 0.03072044812142849, -0.0010143702384084463, 0.02378961630165577, -0.04289623722434044, 0.00044948392314836383, 0.03221900761127472, 0.013527166098356247, -0.006392288487404585, -0.022652316838502884, -0.030212009325623512, -0.020217159762978554, -0.0010896326275542378, 0.0030439468100667, -0.04886370897293091, -0.007499482482671738, 0.01017547957599163, -0.005321889650076628, -0.011854668147861958, -0.0022110426798462868, -0.007506172172725201, 0.002893422031775117, 0.00019986354163847864, 0.005719943903386593, 0.0066899931989610195, 0.012543736957013607, 0.04608067125082016, 0.015494024381041527, 0.06069161742925644, -0.018598180264234543, -0.005147949792444706, -0.01798270083963871, 0.000498822599183768, -0.005686494056135416, 0.017741862684488297, 0.051245346665382385, -0.013286326080560684, 0.003339979099109769, 0.04155823588371277, -0.02547549456357956, 0.01016209926456213, 0.03262040764093399, 0.0022863051854074, -0.009499790146946907, -0.024686073884367943, 0.01312576700001955, -0.02247837744653225, 0.006358838640153408, -0.003933716099709272, -0.03393164649605751, 0.0001290959626203403, 0.010530048981308937, -0.010008229874074459, 0.0009182015783153474, 0.009820910170674324, -0.05384106561541557, -0.024579035118222237, 0.02004322037100792, 0.029917649924755096, 0.024900155141949654, -0.020805878564715385, -0.031576767563819885, 0.012336347252130508, -0.02597055397927761, 0.013714485801756382, -0.017902420833706856, 0.012971896678209305, -0.018839020282030106, -0.0027679847553372383, 0.00984766986221075, -0.00032801873749122024, -0.017848901450634003, 0.00543896434828639, -0.001206707558594644, -0.0008458659867756069, -0.01424968522042036, -0.010369488969445229, -0.020618557929992676, -0.03205844759941101, -0.009325850754976273, -0.0049372147768735886, 0.0019534779712557793, 0.003960475791245699, 0.009586759842932224, 0.010710678994655609, 0.000833740399684757, -0.027776852250099182, -0.004274905659258366, 0.00012825970770791173, 0.007265332620590925, 0.012403246946632862, -0.023963555693626404, 0.00037443055771291256, 0.01414264552295208, -0.013446886092424393, -0.008643470704555511, 0.009218810126185417, 0.029543010517954826, -0.01306555699557066, -0.01645738258957863, 0.0017661581514403224, 0.0017761931521818042, 0.029168369248509407, 0.0025572499725967646, 0.011326158419251442, -0.010991659015417099, 0.011981777846813202, 0.03684848174452782, 0.029328929260373116, 0.020337579771876335, 0.0029452694579958916, -0.012971896678209305, 0.013012036681175232, 0.051272109150886536, -0.02004322037100792, -0.0043250806629657745, 0.020337579771876335, 0.014825024642050266, -0.009907879866659641, 0.0028131420258432627, 0.05785506218671799, 0.011934948153793812, 0.00712484261021018, -0.020658697932958603, 0.004141105804592371, -0.019561540335416794, 0.03526964411139488, 0.0028666621074080467, -0.0022578726056963205, -0.012423316948115826, -0.017715102061629295, 0.01137967873364687, 0.02419101446866989, -0.019922800362110138, -0.003038929309695959, -0.004261525813490152, 0.009948019869625568, -0.012998656369745731, -0.023080475628376007, 0.014222925528883934, -0.02179599739611149, 0.044100433588027954, 0.007111462764441967, 0.0168855432420969, 0.029489489272236824, 0.01770172268152237, 0.058176178485155106, 0.011092009022831917, 0.04784683138132095, -0.022023458033800125, 0.0013430161634460092, -0.0004946413682773709, -0.037169601768255234, 0.037196360528469086, 0.02662617340683937, 0.01732708141207695, 0.005509209353476763, 0.004592680372297764, -0.0075329323299229145, 0.01211557723581791, -0.019160140305757523, 0.014865164645016193, 0.027482490986585617, 0.006820448208600283, -0.0011648950167000294, -0.008201931603252888, -0.009486409835517406, -0.01592218317091465, -0.020391099154949188, 0.00356242130510509, 0.017434122040867805, 0.019467880949378014, -0.02460579387843609, 0.021688958629965782, -0.021180517971515656, 0.02144811861217022, 0.007599832024425268, -0.00712484261021018, -0.0014450384769588709, -0.021956557407975197, -0.0031543318182229996, 0.013192666694521904, -0.014677844941616058, 0.01957491971552372, -0.006793688051402569, -0.013480336405336857, 0.011540237814188004, -0.004883694928139448, 0.019561540335416794, -0.006730133201926947, -0.008797341026365757, 0.002167557831853628, -0.003990580793470144, 0.008549811318516731, 0.03690200299024582, 0.0013831560499966145, -0.020297439768910408, -0.015467263758182526, -0.005328579340130091, -0.03093452751636505, 0.023749476298689842, -0.02447199448943138, -0.03406544402241707, -0.011065248399972916, -0.05662410333752632, 0.0024117424618452787, 5.1167993660783395e-05, 0.02025729976594448, 0.01576162315905094, -0.02793741226196289, 0.005308509338647127, 0.009044870734214783, 0.006358838640153408, 0.01245676726102829, -0.0015069209039211273, -0.022812876850366592, 0.04482295364141464, -0.01573486439883709, -0.007372372318059206, -0.013078936375677586, -0.0025271449703723192, -0.013353226706385612, -0.01490530464798212, 0.028365571051836014, 0.048836950212717056, 0.016310203820466995, -0.008957901038229465, -0.008135031908750534, -0.015106004662811756, 0.015601064078509808, 0.001475979690439999, 0.001831385656259954, -0.01957491971552372, 0.018745360895991325, 0.023990316316485405, -0.003960475791245699, -0.011747627519071102, -0.002806452102959156, 0.02076573856174946, 0.02182275801897049, 0.0058470540679991245, 0.034359805285930634, -0.013179286383092403, -0.01573486439883709, 0.004030720796436071, 0.019400980323553085, -0.015106004662811756, 0.0021056754048913717, -0.011185668408870697, -0.0009081665775738657, -0.01601584441959858, -0.012603946961462498, -0.00407420564442873, 0.025060715153813362, 0.03369080647826195, -0.0076734223403036594, 0.042628634721040726, -0.009606829844415188, 0.029890889301896095, -0.01922704093158245, -0.016029223799705505, -0.0012292861938476562, -0.01716652326285839, -0.025515634566545486, 0.021528398618102074, -0.011272638104856014, 0.02540859393775463, -0.015106004662811756, 0.033449966460466385, -0.004391980357468128, -0.005117844790220261, -0.0026776697486639023, -0.02657265216112137, 0.04182583838701248, -0.007104772608727217, -0.006756892893463373, -0.017567921429872513, 0.030506368726491928, 0.029114849865436554, 0.03414572402834892, -0.00048460636753588915, 0.01903972029685974, -0.03767804056406021, -0.00451240036636591, -0.011118768714368343, 0.014169405214488506, 0.018531281501054764, 0.03181760758161545, -0.011620517820119858, -0.03668792173266411, 0.005709909368306398, 0.009586759842932224, -0.034761205315589905, -0.01424968522042036, 0.028606411069631577, -0.027643050998449326, 0.011025108397006989, -0.0309077687561512, 0.004040755797177553, 0.026144493371248245, 0.04634827375411987, 0.014236305840313435, 0.03171056881546974, 0.048060908913612366, 0.008650161325931549, 0.03141620755195618, -0.021903038024902344, -0.015908803790807724, -0.013647586107254028, -0.014236305840313435, 0.008462841622531414, 0.020832639187574387, 0.014102505519986153, -0.010811029002070427, -0.0037597762420773506, -0.02107347920536995, 0.006930832751095295, 0.005459034349769354, -0.038668159395456314, -0.010603639297187328, 0.0006460024742409587, 0.01580176316201687, 0.022585416212677956, -0.004589335061609745, -0.010315969586372375, -0.01673836261034012, -0.014544044621288776, -0.007874121889472008, -0.015132764354348183, 0.031737327575683594, -0.024057215079665184, 0.0211002379655838, -0.014637704938650131, -0.02076573856174946, 0.015132764354348183, 0.010630398988723755, 0.004177900496870279, -0.006372218485921621]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
"ench (Bai et al., 2023) for long context
evaluation, respectively1. For LM-eval, we adopt CoQA
(Exact match accuracy), TruthfulQA (BLEU score), and
GSM8K (Exact match accuracy). For LongBench, we chose
1The closed-end tasks such as MMLU are not ideal to evaluate
KIVI since they only involve one decoding step and directly fetch
the output logits, which is not suitable for studying the impact of
compressed KV cache.tasks from four subgroups. Specifically, Qasper (F1 score)
is a Single-Document QA task; QMSum (ROUGE score)
and MultiNews (ROUGE score) are Summarization tasks;
TREC (classification score), TriviaQA (F1 score), and SAM-
Sum (ROUGE score) are Few-shot Learning tasks; and LCC
(similarity score) and RepoBench-P (similarity score) is
Code Completion task. The maximum sequence length in
LongBench was set to 8192 for the Mistral model, and 4096
for other models.
4.2. Accuracy and Efficiency Analysis
4.2.1. C OMPARISON BETWEEN DIFFERENT
QUANTIZATION CONFIGURATIONS
We first utilize the fake quantization to demonstrate the
effectiveness of our asymmetric quantization, namely, quan-
tizing key cache per-channel and value cache per-token.
Here fake quantization is exactly the same as in Table 1.
The results are shown in Table 3. We observe that “2bit (K
per-channel, V per-token)” consistently achieves the best re-
sults compared to all other configurations. This is consistent
with our previous analysis. We also note that for hard gener-
ation tasks such as GSM8K, the fake “2bit (K per-channel,
V per-token)” quantization results are significantly worse
than the full precision counterparts. However for KIVI in
Table 3, we observe accuracy drop is only around 2%for
GSM8K across different models. As we analyzed in Section
3.3, the difference between fake “2bit (K per-channel, V
per-token)” quantization and KIVI is that KIVI maintains
a full precision key and value cache sliding window for
the local relevant tokens. This sliding window is crucial
to maintaining accuracy for hard generation tasks such as
mathematical reasoning.
4.2.2. A CCURACY COMPARISON ON GENERATION
TASKS
LM-Eval Results. We benchmark KIVI on CoQA, Truth-
fulQA, and GSM8K tasks using LM-Eval framework. All
dataset parameters were set to default. We compare the
standard 16bit configuration with our KIVI compression
techniques across Llama-2-7B, Llama-2-13B, Falcon-7B,
and Mistral-7B. As shown in Table 3, we observe that for
the Llama and Mistral model, KIVI only has up to 2% ac-
curacy drop despite the KV cache being stored in 2bit. For
instance, in the Llama-2-7B model, the transition from 16bit
to 2bit only slightly decreases accuracy. Similar trends are
observed in other Llama-family models. For Falcon-7B,
since it adopts multi-query attention and only has one head
for KV cache, it is already highly compressed compared to
Llama-based models. Thus in Table 3, 4bit KIVI is needed
to maintain the accuracy, while 2bit KIVI may have a large
accuracy drop in this case.
6
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
Table 3: Performance comparison between 16bit, four fake
2bit KV cache quantization similar to those in Table 1,
KIVI-2 (2bit) / KIVI-4 (4bit) across various models. We
emphasize that unlike KIVI , which preserves a small por-
tion of full precision key cache XKrand value cache XVr,
all tokens in fake KV cache quantization are quantized for a
fair comparison. Cstands for per-channel quantization and
Tstands for per-token quantization.
Model CoQA TruthfulQA GSM8K
Llama-2-7B16bit 63.88 30.76 13.50
2bit (K - C, V -T) 59.08 33.10 5.76
2bit (K - T, V -T) 39.88 18.29 0","[-0.0009990402031689882, 0.03629957512021065, 0.03418789058923721, -0.027879569679498672, -0.004971812013536692, 0.006732662208378315, 0.02865474484860897, -0.001139373634941876, 0.0017324493965134025, 0.016572706401348114, 0.05105463042855263, 0.02663661725819111, -0.034134432673454285, 0.04546802490949631, 0.005984217394143343, -0.005800447426736355, 0.0018193223513662815, -0.017067216336727142, -0.05057348683476448, 0.0017140723066404462, -0.019432835280895233, -0.043944403529167175, -0.012449578382074833, 0.018604200333356857, 0.050546757876873016, -0.06671851128339767, -0.02828052267432213, -0.02326861582696438, 0.019071977585554123, -0.0734010562300682, 0.013625705614686012, -0.015944547951221466, -0.025821346789598465, -0.08243585377931595, -0.009749830700457096, 0.03565805032849312, -0.0033245652448385954, 0.007818575948476791, -0.0014534532092511654, 0.011547435075044632, 0.024244267493486404, -0.03710148110985756, -0.05209710821509361, -0.006054384168237448, 0.03178217634558678, 0.03472249582409859, 0.01697365939617157, -0.014554578810930252, -0.058485619723796844, 0.0315416045486927, -0.023816583678126335, 0.07024689763784409, -0.04391767457127571, -0.016372231766581535, 0.03100700117647648, 0.013398499228060246, 0.012376070022583008, -0.009262004867196083, 0.027037570253014565, -0.03108719177544117, -0.009776560589671135, -0.06939152628183365, 0.0007033376605249941, 0.008720719255506992, -0.007638147100806236, 0.009983719326555729, -0.016345500946044922, 0.008941242471337318, 0.014046706259250641, -0.001414193189702928, -0.01034457702189684, 0.061425939202308655, 0.0020398462656885386, -0.009255322627723217, -0.009703053161501884, 0.015730706974864006, 0.01697365939617157, 0.016866739839315414, 0.033706746995449066, -0.03175544738769531, -0.005957487504929304, -0.007658194750547409, 0.026890553534030914, -0.027852840721607208, 0.036780718713998795, -0.019446201622486115, -0.03776973485946655, 0.014661500230431557, -0.03293157368898392, -0.002678029239177704, -0.06153285875916481, 0.018443819135427475, -0.023402266204357147, -0.010491592809557915, 0.036647066473960876, -0.022186044603586197, 0.02106337621808052, -0.03595208376646042, -0.024872425943613052, 0.01905861310660839, 0.0014718301827087998, 0.03547094017267227, 0.04544129595160484, -0.01741470769047737, 0.07468410581350327, 0.005887320730835199, -0.0015561972977593541, 0.017855755984783173, -0.019940709695219994, -0.0018744533881545067, -0.03525709733366966, 0.007016670424491167, -0.05666796863079071, 0.027131125330924988, -0.004818113520741463, -0.051402121782302856, -0.05864600092172623, -0.027532078325748444, -0.01911207288503647, -0.024752140045166016, -0.012115450575947762, 0.00012863895972259343, 0.032771192491054535, -0.0352303683757782, 0.00028171096346341074, -0.025674331933259964, 0.03694109991192818, -0.03603227436542511, 0.006709273438900709, -0.029055697843432426, 0.02421753667294979, 0.0010608537122607231, 0.07404258102178574, 0.01242953073233366, 0.012603276409208775, 0.00598087627440691, -0.019673407077789307, 0.042153481394052505, -0.05084078758955002, 0.01955312117934227, -0.05725603178143501, -0.032771192491054535, 0.0034749226178973913, -0.009509258903563023, -0.035497669130563736, 0.0013256495585665107, -0.03902605175971985, -0.008567020297050476, -0.02348245680332184, 0.002749866573140025, -0.019860519096255302, -0.008553655818104744, -0.03958738595247269, -0.027852840721607208, -0.041298117488622665, -0.0008562008733861148, -0.009008068591356277, -0.008587067946791649, 0.036914367228746414, -0.021878646686673164, -0.015062452293932438, 0.024885790422558784, 0.03073969855904579, -0.023896774277091026, -0.020167915150523186, -0.016920199617743492, -0.07372181862592697, 0.010611878708004951, -0.07067457586526871, -0.009542671963572502, 0.011534069664776325, -0.001160256564617157, -0.018323533236980438, -0.04335634037852287, -0.004169906955212355, -0.035845160484313965, -0.006629082839936018, 0.001667294534854591, -0.00870067160576582, -0.03501652553677559, -0.0512952022254467, 0.029536841437220573, 0.00037380476715043187, 0.06928461045026779, -0.018510645255446434, -0.024311091750860214, -0.023669568821787834, 0.013044324703514576, -0.012850530445575714, 0.03517690673470497, -0.004747947212308645, 0.022333059459924698, 0.0825427770614624, 0.049450818449258804, 0.01776220090687275, -0.018737850710749626, -0.0015236198669299483, 0.022092487663030624, -0.020809439942240715, 0.014019975438714027, 0.016706358641386032, 0.01239611767232418, 0.03376020863652229, -0.07297337055206299, 0.03359982743859291, -0.00845341756939888, 0.0013991574523970485, -0.012917356565594673, -0.07687597721815109, 0.015463405288755894, 0.014140261337161064, 0.04447900876402855, 0.02908242866396904, 0.006592329125851393, -0.02169153466820717, 0.003484946209937334, -0.025807982310652733, 0.025166457518935204, -0.03172871470451355, 0.03953392431139946, -0.0007425976218655705, 0.004808089695870876, -0.006862971931695938, 0.008587067946791649, -0.07190416753292084, 0.043089039623737335, -0.0034114383161067963, -0.017655279487371445, 0.009756512939929962, -0.05698872730135918, 0.04148522764444351, 0.008386591449379921, -0.02599509246647358, -0.011099704541265965, -0.013278213329613209, -0.038865670561790466, -0.0063350507989525795, -0.021544519811868668, -0.018751217052340508, -0.01569061167538166, 0.012576546519994736, 0.015262928791344166, 0.01998080499470234, 0.017935946583747864, -0.03889240324497223, 0.01598464325070381, -0.031140651553869247, -0.05768371373414993, 0.04397113621234894, -0.03218312934041023, -0.04319595918059349, -0.015142642892897129, -0.06420587748289108, -0.004517399240285158, -0.04012199118733406, -0.03237023949623108, 0.023295346647500992, 0.040496211498975754, -0.01725432649254799, 0.03322560340166092, -0.029964523389935493, -0.03734205290675163, -0.026249030604958534, -0.01682664453983307, -0.04113773629069328, -0.003996160812675953, -0.0032878112979233265, -0.003241033526137471, -0.03095353953540325, -0.05816485732793808, -0.02170490100979805, -0.013766039162874222, 0.020969821140170097, -0.025674331933259964, 0.03130103275179863, 0.0027264775708317757, -0.003444851143285632, -0.02542039379477501, -0.0233621709048748, 0.039640847593545914, -0.001301425276324153, -0.017722105607390404, 0.021611344069242477, 0.007765115238726139, -0.000802740512881428, -0.004263462498784065, 0.02035502716898918, 0.023963600397109985, 0.015476769767701626, -0.018029501661658287, 0.03945373371243477, -0.006157963536679745, 0.025901537388563156, -0.015049087814986706, -0.028628015890717506, 0.02921607904136181, -0.019539756700396538, -0.03779646381735802, -0.003618597285822034, -0.017668643966317177, 0.04757970944046974, 0.017722105607390404, 0.00970973540097475, 0.029028968885540962, -0.01848391443490982, 0.03803703561425209, 0.008580385707318783, 0.013552198186516762, -0.024591758847236633, -0.007825258187949657, 0.003199267666786909, 0.027091030031442642, -0.005102121736854315, 0.04413151741027832, -0.03210293874144554, -0.06265552341938019, 0.002203568583354354, -0.04512053355574608, 0.07783826440572739, -0.03057931736111641, 0.038785479962825775, -0.08035089820623398, -0.013044324703514576, 0.008192798122763634, 0.0038090497255325317, -0.001093431143090129, -0.015196103602647781, -0.006478725932538509, -0.013939784839749336, -0.019432835280895233, -0.00576369371265173, 0.039721038192510605, 0.01561042107641697, -0.014527848921716213, -0.07265260815620422, -0.01705384999513626, -0.003018838819116354, 0.02500607632100582, -0.020248105749487877, -0.02435118705034256, -0.07249222695827484, -0.009515942074358463, 0.008359861560165882, -0.00026208098279312253, -0.006264884490519762, 0.01704048551619053, 0.0564541257917881, 0.015663880854845047, 0.06805501878261566, -0.017534993588924408, 0.017895851284265518, -0.035711511969566345, 0.03747570142149925, -0.04814103990793228, 0.017641915008425713, -0.025473855435848236, 0.024725409224629402, -0.010678703896701336, -0.028815126046538353, 0.015289658680558205, -0.01748153381049633, 0.012476308271288872, 0.049958694726228714, 0.02113020233809948, -0.0017207548953592777, -0.024591758847236633, -0.01347200758755207, 0.007531226146966219, 0.015998007729649544, -0.007718337699770927, 0.002191874198615551, 0.014247181825339794, -0.028761666268110275, -0.03704801946878433, 0.002086624037474394, -0.03359982743859291, 0.03258408233523369, 0.059715207666158676, 0.029189348220825195, -0.0008161055739037693, 0.03672725707292557, 0.011119752191007137, -0.009502576664090157, 0.009155084379017353, 0.032797921448946, -6.244001269806176e-05, 0.0006908079376444221, 0.010658656246960163, -0.07409603893756866, 0.03565805032849312, -0.03760935366153717, 0.02600845880806446, -0.014835245907306671, -0.007872035726904869, 0.027304871007800102, 0.01689346879720688, 0.014354103244841099, -0.0038691924419254065, 0.03819741681218147, 0.05295247212052345, 0.014688230119645596, 0.002429104410111904, -0.07334759831428528, -0.006712614558637142, 0.00045441294787451625, -0.005914050620049238, 0.016866739839315414, -0.01740134321153164, 0.013645753264427185, 0.014113531447947025, 0.003331247717142105, -0.03966757655143738, 0.03052585758268833, -0.05843215808272362, 0.010585148818790913, -0.040656592696905136, 0.016880104318261147, 0.046082817018032074, 0.05768371373414993, 0.05471666529774666, -0.04528091475367546, -0.027451887726783752, -0.06848270446062088, -0.0780521035194397, 0.001197845907881856, -0.001689012860879302, -0.05495723709464073, -0.0376628153026104, 0.033840399235486984, -0.042661357671022415, -0.055331457406282425, 0.013598975725471973, -0.0073641627095639706, -0.0026546402368694544, -0.0528455525636673, -0.021170297637581825, -0.027024205774068832, 0.013953150250017643, -0.03335925564169884, -0.029697222635149956, -0.029242809861898422, -0.04135157912969589, -0.013993245549499989, -0.00667920196428895, -0.0512952022254467, 0.06196054071187973, 0.00328446994535625, -0.029349729418754578, 0.07062111794948578, -0.035364020615816116, 0.010665339417755604, -0.005419542547315359, 0.02694401517510414, -0.00714363856241107, -0.0013548856368288398, -0.08355852216482162, 0.10055891424417496, -0.001809298642911017, 0.013766039162874222, -0.013017593882977962, 0.01146724447607994, -0.0010282763978466392, -0.018951693549752235, -0.0007158674416132271, 0.01812305673956871, 0.032851383090019226, -0.0012838835828006268, 0.04105754569172859, 0.00866725854575634, -0.0037322004791349173, -0.02959030121564865, -0.08730074763298035, -0.008967973291873932, -0.00985006894916296, -0.03196928650140762, -0.0018443819135427475, 0.045655135065317154, -0.026743538677692413, -0.007083496078848839, -0.011888244189321995, 0.00018136840662918985, -0.02564760111272335, -0.013939784839749336, 0.005569899920374155, -0.009008068591356277, 0.06597007066011429, 0.05327323451638222, -0.006672519259154797, -0.00805914681404829, -0.022079123184084892, -0.03429481387138367, -0.02513972856104374, 0.024952616542577744, -0.014781786128878593, 0.036433227360248566, 0.03547094017267227, 0.018390359356999397, 0.007698290050029755, 0.01698702573776245, -0.026449507102370262, 0.012670101597905159, 0.027665728703141212, 0.036780718713998795, 0.027238046750426292, -0.004199978429824114, 0.039721038192510605, 0.02205239236354828, -0.006294955965131521, -0.00010509343701414764, 0.018390359356999397, 0.034268081188201904, -0.015196103602647781, 0.013271531090140343, 0.0006085290806367993, -0.007831940427422523, -0.007698290050029755, 0.03135449439287186, 0.030606048181653023, -0.0016405644128099084, 0.011179895140230656, -0.008861052803695202, -0.03822414577007294, 0.005058685317635536, -0.012710196897387505, 0.011754593811929226, -0.015316389501094818, -0.03290484473109245, -0.10029160976409912, -0.0047312406823039055, -0.04653723165392876, 0.01647915132343769, -0.023308711126446724, -0.010244338773190975, 0.005680161993950605, -0.02443137764930725, -0.0203416608273983, 0.0367005281150341, 0.0032827993854880333, 0.026489602401852608, 0.041004084050655365, 0.010698751546442509, -0.01899178884923458, 0.027331601828336716, 0.008052464574575424, -0.002465858357027173, 0.001800945377908647, 0.03143468499183655, -0.038651831448078156, -0.0071302736178040504, 0.01855074055492878, 0.013752673752605915, -0.03659360855817795, 0.02857455424964428, -0.008600433357059956, -0.008794226683676243, 0.03712821006774902, 0.02599509246647358, -0.0019496319582685828, -0.03472249582409859, 0.02364283800125122, 0.05442263185977936, -0.005773717537522316, 0.014487753622233868, -0.007711654994636774, -0.027451887726783752, -0.00689638452604413, 0.008112607523798943, 0.010504958219826221, 0.014674864709377289, 0.04971812292933464, -0.013051006942987442, -0.00527920899912715, 0.02849436365067959, -0.04234059527516365, 0.019646678119897842, -0.00030551751842722297, -0.0009990402031689882, 0.007972273975610733, 0.013224753551185131, 0.011413783766329288, -0.013993245549499989, -0.023188425227999687, 0.0019362668972462416, -0.018497278913855553, -0.036059003323316574, 0.009074893780052662, 0.021932106465101242, 0.003825756022706628, 0.0010291116777807474, 0.010538370348513126, 0.012696832418441772, -0.012249101884663105, -0.0015453380765393376, -0.007357480004429817, -0.016866739839315414, 0.01618511974811554, 0.0135789280757308, -0.01848391443490982, -0.03301176428794861, -0.026810362935066223, 0.033840399235486984, 0.0042434148490428925, -0.01855074055492878, -0.0071837338618934155, -0.049744851887226105, 0.07623445242643356, -0.01385959517210722, 0.02530010975897312, 0.012015213258564472, -0.04431862756609917, -0.0035384066868573427, -0.01963331177830696, -0.02564760111272335, -0.0033078589476644993, -0.028039950877428055, -0.023656202480196953, -0.021584615111351013, -0.03172871470451355, 0.02636931650340557, -0.04250097647309303, -0.0007755926926620305, -0.037582624703645706, -0.012636689469218254, -0.0066658370196819305, 0.012048625387251377, 0.023255251348018646, -0.014501119032502174, -0.042741548269987106, -0.043302878737449646, 0.010712116956710815, -0.011828101240098476, 0.033198874443769455, 0.0019980804063379765, 0.007644829340279102, 0.006963210180401802, 0.007297337055206299, 0.022747376933693886, 0.010043862275779247, 0.005302598234266043, -0.003621938405558467, 0.04640357941389084, 0.02270728163421154, -0.006117868237197399, -0.049958694726228714, 0.019593216478824615, -0.03517690673470497, 0.029911063611507416, 0.02099655009806156, -0.00596416974440217, -0.027906300500035286, -0.022546900436282158, -0.03819741681218147, 0.024257631972432137, 0.027638999745249748, 0.027558809146285057, -0.026476236060261726, -0.018791312351822853, -0.0013172962935641408, -0.02012781985104084, -0.014474389143288136, -0.02163807488977909, -0.02993779443204403, -0.025046171620488167, -0.021892011165618896, 0.01825670897960663, 0.04661742225289345, 0.005175629630684853, 0.007805210538208485, -0.011754593811929226, 0.008393274620175362, 0.008246258832514286, -0.0048381611704826355, 0.0194194708019495, -0.012162229046225548, 0.004724557977169752, 0.00830640085041523, -0.017494898289442062, -0.03258408233523369, -0.012743609957396984, 0.023081503808498383, -0.049023136496543884, -0.0020849534776061773, -0.05709565058350563, -0.030285285785794258, -0.018149787560105324, 0.006522162351757288, 0.03373347967863083, -0.013552198186516762, -0.007430987898260355, -0.04140503704547882, 0.011400419287383556, 0.0017942629056051373, -0.01231592707335949, -0.014728325419127941, -0.046376850455999374, 0.013258165679872036, 0.007638147100806236, 0.018029501661658287, -0.006298297084867954, -0.02556741051375866, -0.012770339846611023, 0.004206661134958267, -0.02178509160876274, -0.015022356994450092, -0.026128744706511497, -0.02615547366440296, -0.018016137182712555, 0.011674403212964535, 0.054903775453567505, -0.009636227041482925, -0.0180562324821949, -0.009001385420560837, -0.0031792200170457363, 0.011346958577632904, -0.018323533236980438, 0.011661037802696228, -0.00985006894916296, 0.016358865424990654, 0.008847687393426895, -0.012964134104549885, -0.022760743275284767, 0.03953392431139946, -0.027879569679498672, -0.007237194571644068, 0.015303024090826511, 0.020034264773130417, -0.021664805710315704, 0.016666263341903687, 0.010491592809557915, 0.028628015890717506, 0.014113531447947025, 0.004019549582153559, -0.007731702644377947, -0.014795150607824326, 0.0013615682255476713, 0.016158388927578926, -0.04060313478112221, -0.015530230477452278, -0.0379568450152874, 0.00292862462811172, -0.017080580815672874, -0.03346617519855499, 0.0070768133737146854, 0.01561042107641697, -0.009355560876429081, -0.004637685138732195, 0.000848683004733175, -0.0008077524253167212, 0.020461946725845337, -0.02278747223317623, 0.005803789012134075, 0.012275831773877144, -0.00021217075118329376, 0.0001605898723937571, 0.03009817562997341, -0.024524934589862823, 0.014300642535090446, -0.03998833894729614, -0.007851988077163696, 0.009074893780052662, 0.0017859096406027675, -0.0070233531296253204, 0.017494898289442062, 0.02658315747976303, 0.009823339059948921, -0.006465360522270203, -0.020007533952593803, -0.007537908852100372, 0.022453345358371735, -0.0029887675773352385, -0.02119702659547329, -0.02099655009806156, -0.0006548892124556005, 0.036566875874996185, 0.04963793233036995, -0.033118683844804764, -0.00012498443538788706, -0.011560799553990364, 0.0060744318179786205, 0.04255443438887596, 0.005442931316792965, -0.023228520527482033, -0.007424305658787489, -0.0292962696403265, -0.009094941429793835, -0.014902071096003056, -0.011427149176597595, -0.001151903416030109, -0.03445519134402275, -0.026663348078727722, -0.014982261694967747, -0.022105854004621506, -0.011373688466846943, -0.006909749936312437, -0.020221376791596413, 0.024591758847236633, -0.03223658725619316, -0.09029452502727509, -0.028120141476392746, 0.005650090519338846, 0.010879180394113064, 0.01869775541126728, 0.036780718713998795, -0.03410769999027252, -0.001430064206942916, -0.013478689827024937, -0.0180562324821949, -0.004778018221259117, -0.02226623333990574, 0.010525005869567394, -0.014661500230431557, -0.023535916581749916, -0.027852840721607208, -0.009535988792777061, 0.010591831058263779, 0.03881221264600754, -0.02542039379477501, -0.019325915724039078, 0.008720719255506992, 0.005700209643691778, 0.013592293485999107, -0.011260085739195347, -0.020956454798579216, -0.010351259261369705, -0.015570325776934624, -0.009175132028758526, -7.094981265254319e-05, -0.01307773683220148, -0.012335974723100662, 0.0019295844249427319, 0.022520171478390694, -0.02771919034421444, 0.001414193189702928, -0.01848391443490982, 0.004480645060539246, 0.0330919548869133, -0.016853373497724533, 0.0227741077542305, -0.05565221980214119, 0.0014217110583558679, 0.011534069664776325, 0.0349363349378109, -0.053193043917417526, 0.02564760111272335, 0.02663661725819111, 0.008119289763271809, -0.036486685276031494, 0.010164148174226284, 0.0038858989719301462, 0.007090178318321705, 0.005713574588298798, -0.0011794689344242215, 0.032049477100372314, 0.02378985472023487, -0.010418085381388664, -0.02844090387225151, 0.00017405937251169235, -0.0068763368763029575, 0.022012297064065933, -0.009856751188635826, -0.0039360178634524345, -0.022319694980978966, -0.02993779443204403, -0.014140261337161064, 0.02485906146466732, 0.0330919548869133, -0.04397113621234894, -0.04450573772192001, 0.028039950877428055, -0.01303095929324627, -0.02170490100979805, -0.002051540883257985, -0.0040362561121582985, -0.019753597676753998, 0.0009388973121531308, -0.08238239586353302, 0.02900223806500435, 0.02242661453783512, -0.03897259384393692, 0.025059537962079048, 0.003772295778617263, 0.014420928433537483, 0.023816583678126335, 0.03806376829743385, -0.02844090387225151, 0.010712116956710815, 0.013699213974177837, 0.0352303683757782, -0.02972395159304142, 0.008640528656542301, -0.012469626031816006, 0.0239903312176466, 0.010578465647995472, 0.03619265556335449, -0.010464862920343876, -0.04167234152555466, 0.018323533236980438, 0.03760935366153717, -0.002674687886610627, 0.01371257845312357, -0.08607115596532822, 0.022506805136799812, 0.008112607523798943, 0.0018376994412392378, -0.009014750830829144, 0.041592150926589966, -0.012636689469218254, 0.0026629935018718243, 0.012903991155326366, 0.02878839708864689, 0.059340983629226685, -0.023509187623858452, 0.042153481394052505, 0.026182204484939575, 0.0005692691775038838, 0.017521629109978676, -0.014207087457180023, 0.0030004619620740414, 0.03095353953540325, -0.02234642393887043, -0.02558077499270439, 0.0015453380765393376, -0.014594674110412598, 0.014193722046911716, 0.026556426659226418, 0.001654764753766358, 0.0039360178634524345, -0.015530230477452278, 0.043516721576452255, 0.0005291738780215383, 0.01558369118720293, -0.0030639460310339928, -0.029269538819789886, -9.475637489231303e-05, -0.03440173342823982, 0.017882484942674637, 0.01418035663664341, -0.0024407990276813507, 0.021892011165618896, 0.05613336339592934, 0.00619805883616209, -0.04677780345082283, -0.002952013397589326, 0.031701985746622086, -0.007905448786914349, -0.02729150652885437, -0.014474389143288136, 0.014487753622233868, -0.023549282923340797, 0.0033663311041891575, 0.014848611317574978, 0.010030497796833515, 0.015476769767701626, -0.020528772845864296, -0.028039950877428055, 0.037716273218393326, 0.049236979335546494, 0.005209042690694332, 0.02485906146466732, -0.016853373497724533, 0.003205950139090419, 0.03557785972952843, -0.0094157038256526, -0.005195677280426025, -0.009074893780052662, 0.0030589341185986996, 0.042447514832019806, -0.013846229761838913, -0.025046171620488167, 0.05172288417816162, 0.029483381658792496, 0.0358184315264225, 0.04124465584754944, -0.015543595887720585, -0.02407051995396614, 0.027171220630407333, -0.01641232706606388, -0.0020314932335168123, 0.01697365939617157, -0.014220451936125755, -0.008580385707318783, 0.03057931736111641, 0.00028275512158870697, 0.02349582128226757, 0.01385959517210722, 0.03645995631814003, 0.011894927360117435, -0.003618597285822034, 0.011587530374526978, -0.0412713885307312, 0.011179895140230656, 0.012556498870253563, -0.002183520933613181, 0.001750826369971037, 0.022667186334729195, -0.013819499872624874, 0.04453246667981148, 0.012082038447260857, 0.005539828445762396, -0.01762854866683483, -0.016572706401348114, -0.01675981841981411, 0.016278674826025963, -0.019299184903502464, -0.014581309631466866, 0.017575088888406754, 0.024377917870879173, -0.010819037444889545, 0.016639532521367073, -0.017387976869940758, 0.015423309989273548, -0.016225215047597885, -0.01798940636217594, -0.0025092950090765953, -0.022025663405656815, -0.02857455424964428, -0.011647673323750496, -0.027064301073551178, 0.003718835301697254, -0.02642277628183365, -0.005336010828614235, -0.021958837285637856, -0.024311091750860214, 0.02886858768761158, -0.040362562984228134, 0.011473926715552807, 0.027050934731960297, -0.029964523389935493, 0.035791702568531036, -0.021758360788226128, -0.011300181038677692, -0.029055697843432426, -0.0017324493965134025, -0.018216613680124283, -0.0385449081659317, -0.017882484942674637, -0.015062452293932438, 0.025620870292186737, 0.014848611317574978, 0.0006912255776114762, 0.008373226970434189, -0.025620870292186737, 0.0018326875288039446, -0.009535988792777061, 0.0630832090973854, -0.03122084215283394, 0.01589108817279339, -0.0068696546368300915, -0.011260085739195347, 0.03525709733366966, -0.025660965591669083, 0.023883409798145294, -0.006345074623823166, 0.020582232624292374, 0.02556741051375866, 0.04450573772192001, 0.006515479646623135, -0.018711121752858162, 0.009642910212278366, 0.011166529729962349, -0.021758360788226128, -0.013752673752605915, -0.022653821855783463, 0.005609995219856501, 0.015249563381075859, 0.019513025879859924, 0.012061990797519684, -0.02679699845612049, 0.0279330313205719, 0.030258556827902794, 0.02959030121564865, -0.012028577737510204, 0.0069765751250088215, -0.0005304268561303616, -0.020649058744311333, 0.012823800556361675, -0.022373154759407043, -0.019539756700396538, -0.015944547951221466, 0.008660576306283474, 0.004407137166708708, 0.0045808833092451096, -0.02663661725819111, -0.03509671613574028, -0.008139337413012981, 0.03199601545929909, -0.02558077499270439, 0.01963331177830696, 0.04071005433797836, 0.013097784481942654, -0.0016948600532487035, 0.014527848921716213, -0.004958447068929672, 0.005994241219013929, 0.01539658010005951, 0.011955070309340954, -0.031247572973370552, 0.013318308629095554, 0.03057931736111641, 0.03662033751606941, 0.009108306840062141, 0.014314007945358753, 0.025380298495292664, 0.014527848921716213, -0.011594212613999844, -0.02305477485060692, 0.005787082482129335, 0.007444353308528662, 0.024605125188827515, 0.01603810302913189, 0.02163807488977909, -0.0005174794350750744, -0.02878839708864689, -0.007150321267545223, -0.05094771087169647, 0.002866811119019985, -0.04362364113330841, -0.0076180994510650635, 0.01669299229979515, -0.0030906761530786753, -0.021744996309280396, 0.005205701105296612, -0.030205095186829567, -0.01371257845312357, -0.010966053232550621, -0.002180179813876748, 0.024177441373467445, 0.01818988285958767, 0.014968897216022015, 0.006578963715583086, 0.03333252668380737, -0.012703514657914639, -0.004647708963602781, 0.0029720610473304987, -0.0002650046080816537, -0.007424305658787489, 0.0033796962816268206, 0.013291578739881516, 0.008333131670951843, 0.0032577398233115673, -0.017735470086336136, -0.01812305673956871, 0.010104005225002766, 0.00632168585434556, 0.022186044603586197, -0.004230049904435873, -0.012977498583495617, 0.06939152628183365, -0.015236198902130127, -0.007083496078848839, -0.011774641461670399, -0.009462481364607811, 0.009622862562537193, 0.01314456295222044, 0.006746027618646622, -0.031835637986660004, 0.014487753622233868, -0.02908242866396904, 0.017080580815672874, 0.023014679551124573, 0.025313474237918854, -0.01804286614060402, -0.02750534750521183, 0.00043018872383981943, 0.025660965591669083, 0.0091016236692667, -0.012950768694281578, 0.02177172526717186, -0.02177172526717186, -0.0062749083153903484, -0.010899228043854237, -0.029670491814613342, -0.005011907313019037, -0.0058405427262187, 0.029349729418754578, 0.037422243505716324, 0.03838452696800232, -0.0032794580329209566, -0.026756903156638145, -0.030205095186829567, -0.018590835854411125, 0.029403191059827805, 0.007250559516251087, -0.0070300353690981865, 0.031327761709690094, 0.024885790422558784, -0.017067216336727142, 0.0062247891910374165, 0.030071444809436798, -0.006298297084867954, -0.013926420360803604, -0.008239575661718845, -0.008045782335102558, 0.01726769097149372, -0.006415241397917271, 0.001023264485411346, 0.00410308176651597, 0.03009817562997341, 0.001031617633998394, 0.019740233197808266, -0.010852450504899025, 0.02477887086570263, -0.0422336719930172, -0.0035651368089020252, 0.024752140045166016, 0.014193722046911716, -0.0005930757033638656, -0.03811722621321678, -0.029323000460863113, -5.5078773584682494e-05, -0.007631464395672083, -0.011594212613999844, -0.03539074957370758, -0.005810471251606941, 0.012155545875430107, 0.0008954607765190303, -0.014688230119645596, -0.002138413954526186, 0.00564006669446826, -0.00043937721056863666, -0.010251021012663841, 0.010545053519308567, 0.006525503471493721, 0.0008390768198296428, 0.014407563023269176, 0.022092487663030624, 0.05019926652312279, -0.023509187623858452, 0.007230511866509914, -0.015877723693847656, -0.010905910283327103, -0.01196175254881382, 0.013411864638328552, 0.051535774022340775, -0.018884867429733276, 0.000471954612294212, 0.022747376933693886, -0.014474389143288136, -0.019513025879859924, 0.03410769999027252, -0.004701169207692146, -0.005843884311616421, -0.0241373460739851, 0.020154550671577454, -0.01275697536766529, 0.02134404331445694, -0.009970354847609997, -0.025046171620488167, -0.014875341206789017, -0.016866739839315414, -0.003032203996554017, 0.00667920196428895, 0.008085877634584904, -0.04776681959629059, -0.0352303683757782, 0.027612268924713135, 0.039934877306222916, 0.006989940069615841, -0.020007533952593803, -0.021303948014974594, 0.02678363397717476, -0.015717342495918274, 0.00328614073805511, -0.013725943863391876, -0.011346958577632904, -0.004620978608727455, 0.014567944221198559, 0.0028133506420999765, 0.0271578561514616, -0.010912593454122543, 0.014875341206789017, 0.0004005349474027753, 0.010765577666461468, -0.03718167170882225, -0.00632502743974328, -0.026837093755602837, -0.03450865298509598, -0.004323605448007584, -0.021170297637581825, 0.015556960366666317, 0.013725943863391876, 0.0058138128370046616, 0.029055697843432426, -0.009255322627723217, -0.025901537388563156, -0.005543169565498829, 0.012462942861020565, -0.0013791099190711975, 0.008219528011977673, -0.02221277356147766, 0.0188314076513052, 0.002449152059853077, -0.004383748397231102, -0.00211168359965086, 0.013331674039363861, 0.02615547366440296, -0.008981337770819664, -0.0016372230602428317, 0.007103543728590012, 0.0007100202492438257, 0.027959760278463364, -0.0033913906663656235, 0.01740134321153164, -0.00608779676258564, -0.0005964169977232814, 0.027692459523677826, 0.03589862212538719, 0.019646678119897842, 0.011747910641133785, -0.017361247912049294, 0.011119752191007137, 0.03616592288017273, -0.012683467008173466, 0.004199978429824114, 0.009235274977982044, 0.009963671676814556, -0.016866739839315414, 0.013699213974177837, 0.05199018493294716, 0.015236198902130127, 0.01522283349186182, -0.019018517807126045, 0.015744071453809738, -0.00632502743974328, 0.036780718713998795, -0.02035502716898918, 0.0005462979315780103, 0.008673940785229206, -2.6260306185577065e-05, -0.005827177781611681, 0.03996160998940468, -0.016145024448633194, -0.017134040594100952, 0.012563181109726429, 0.004216684959828854, -0.0038959227968007326, -0.011059609241783619, 0.014327372424304485, -0.01804286614060402, 0.027959760278463364, 0.01869775541126728, 0.018884867429733276, 0.01876458153128624, 0.0076715596951544285, 0.06329704821109772, 0.013913054950535297, 0.03440173342823982, -0.026609886437654495, -0.014995627105236053, 0.0031591723673045635, -0.02916261926293373, 0.014033340848982334, 0.04397113621234894, 0.008707353845238686, 0.0027097712736576796, 0.024030426517128944, -0.017949311062693596, 0.0054329074919223785, 0.002674687886610627, 0.020167915150523186, 0.027612268924713135, 0.008620481006801128, -0.005837201606482267, -0.007972273975610733, -0.018229978159070015, -0.00035417478648014367, 0.0010633596684783697, 0.014514484442770481, 0.02062232792377472, 0.021464329212903976, -0.007711654994636774, 0.021143566817045212, -0.01662616804242134, 0.03231677785515785, 0.01597127877175808, -0.003177549224346876, -0.012710196897387505, -0.014113531447947025, 0.016278674826025963, 0.0054763443768024445, -0.0028300571721047163, 0.02178509160876274, 0.0006770251784473658, -0.007016670424491167, -0.0013649094616994262, -0.01379276905208826, 0.03891913220286369, -0.013739309273660183, -0.009395656175911427, 0.010337894782423973, -0.008820957504212856, 0.0074644009582698345, 0.02844090387225151, -0.0034214621409773827, -0.02162471041083336, -0.00863384548574686, -0.0007576333591714501, -0.040068529546260834, -0.0021567908115684986, -0.022506805136799812, -0.0018443819135427475, -0.004123129416257143, -0.06725311279296875, -0.010504958219826221, -0.0133584039285779, 0.0067192972637712955, 0.00845341756939888, -0.038010306656360626, 0.017708739265799522, 0.018163152039051056, -0.002591156167909503, 0.02392350509762764, 0.006956527475267649, -0.01733451709151268, 0.02477887086570263, -0.022333059459924698, -0.02435118705034256, -0.0024391282349824905, -0.004129811655730009, -0.007972273975610733, -0.01741470769047737, 0.03555113077163696, 0.03833106905221939, 0.010979418642818928, -0.019459566101431847, -0.03365328907966614, -0.02578125149011612, 0.003177549224346876, 0.008005687035620213, 0.003585184458643198, -0.01919226348400116, 0.01256986428052187, 0.014982261694967747, -0.017347881570458412, -0.009475846774876118, -0.01321807038038969, 0.015316389501094818, 0.003266093088313937, -0.0012421177234500647, 0.015169372782111168, -0.009388973005115986, -0.03948046639561653, 0.007444353308528662, -0.01149397436529398, 0.012108768336474895, 0.0036820813547819853, 0.004042938817292452, -0.013806134462356567, -0.02750534750521183, -0.014955531805753708, 0.006047701463103294, 0.018657660111784935, 0.010057227686047554, -0.01598464325070381, 0.04557494446635246, -0.008172750473022461, 0.038277607411146164, -0.03135449439287186, -0.0070768133737146854, -0.00960281491279602, -0.026409411802887917, -0.019285820424556732, 0.02894877828657627, -0.016358865424990654, 0.031915824860334396, -0.01825670897960663, 0.02828052267432213, -0.020796075463294983, -0.01661280170083046, 0.007651512045413256, -0.024257631972432137, 0.02119702659547329, 0.008907830342650414, -0.0063350507989525795, -0.027131125330924988, 0.010732164606451988, 0.023589378222823143, 0.029189348220825195, 0.005974193569272757, -0.00021070893853902817, -0.04664415121078491, 0.004022891167551279, -0.004263462498784065, 0.00524913752451539, 0.018310168758034706, 0.04140503704547882, -0.018243342638015747, -0.025674331933259964, -0.014902071096003056, 0.008647210896015167, -0.04020218178629875, -0.02900223806500435, 0.010832402855157852, -0.020087724551558495, 0.010585148818790913, -0.0005258326418697834, 0.0009013080270960927, 0.03616592288017273, 0.02801322191953659, 0.005392812192440033, 0.05316631495952606, 0.04177926108241081, 0.0001484777603764087, 0.033706746995449066, -0.011901609599590302, -0.009870116598904133, 0.0009890163782984018, -0.022025663405656815, -0.003879216266795993, 0.010738846845924854, 0.007912131026387215, 0.0070300353690981865, 0.005402836017310619, -0.013137879781425, -0.014140261337161064, -0.0023522551637142897, -0.022319694980978966, -0.005312622059136629, 0.019005153328180313, 0.01998080499470234, 0.018497278913855553, 0.002295453567057848, 0.009455799125134945, -0.0015060781734064221, -0.009789925999939442, -0.009883481077849865, -0.006067749112844467, 0.037636082619428635, -0.02020801045000553, 0.004203319549560547, -0.008266306482255459, -0.002450822852551937, 0.019005153328180313, 0.0014350761193782091, 0.0003880051663145423, 0.0253535695374012]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
".83
2bit (K - C, V -C) 3.60 0.27 0.00
2bit (K - T, V -C) 1.30 0.49 0.08
KIVI-2 63.05 33.95 12.74
Llama-2-13B16bit 66.37 29.53 22.67
2bit (K - C, V -T) 63.53 28.60 12.21
2bit (K - T, V -T) 52.93 24.98 4.55
2bit (K - C, V -C) 2.88 0.74 0.00
2bit (K - T, V -C) 2.80 0.26 0.08
KIVI-2 66.23 29.84 20.77
Falcon-7B16bit 59.83 23.20 4.55
2bit (K - C, V -T) 43.93 20.82 1.29
2bit (K - T, V -T) 25.72 0.91 0.53
2bit (K - C, V -C) 41.95 17.11 1.52
2bit (K - T, V -C) 19.53 0.94 0.15
KIVI-4 59.67 22.58 4.47
KIVI-2 57.48 24.98 3.41
Mistral-7B16bit 67.40 30.45 38.36
2bit (K - C, V -T) 61.65 29.64 26.46
2bit (K - T, V -T) 54.55 25.86 5.00
2bit (K - C, V -C) 24.40 24.86 2.27
2bit (K - T, V -C) 10.73 19.12 0.99
KIVI-2 66.35 32.17 36.01
LongBench Results. The performance of KIVI over vari-
ous models in the LongBench dataset is summarised in Table
4. We apply KIVI over Llama2-7B, Llama2-13B, Llama2-
7B-Chat, Llama2-13B-Chat, Falcon-7B and Mistral-7B. Ta-
ble 4 suggests that KIVI is an effective method for KV
cache compression with minimal impact on accuracy across
various hard long context generation tasks.
4.2.3. A BLATION
In this section, we benchmark KIVI on GSM8K, one of
the hardest generation tasks, to show the effect of hyperpa-
rameters group size Gand residual length Ron the model
performance. For full results of KIVI with a residual length
of 32, please refer to Appendix B.
The effect of group size. We fix the residual length at 128
and vary the group sizes to 32, 64, and 128. From Table 5,
we observe that group sizes 32 and 64 yield similar results,
whereas the performance significantly decreases when the
group size reaches 128.
Figure 4: Memory usage and throughput comparison be-
tween 2bit KIVI and 16bit baseline. KIVI can achieve
higher throughput by enabling a larger batch size.
The effect of residual length. We fix the group size at 32
and vary the residual length across 32, 64, 96, and 128. As
shown in Table 5, there is no consistent pattern between
residual lengths and model accuracy. Namely, while a resid-
ual length of 128 achieves good results, 32 and 96 yield
similar outcomes, but a residual length of 64 results in the
worst performance.
4.2.4. E FFICIENCY COMPARISON
To evaluate the wall-clock time efficiency of KIVI , follow-
ing vLLM (Kwon et al., 2023a), we synthesize workloads
based on ShareGPT (sha, 2023), which contain input and
output texts of real LLM services. In average, the dataset
features an input prompt length lprompt of 161 and an output
length lgenof 338 (Kwon et al., 2023a). We increase the
batch size until","[0.012629442848265171, 0.015795351937413216, 0.08035799115896225, -0.044828709214925766, -0.019323663786053658, -0.008171187713742256, 0.037854138761758804, -0.020595496520400047, 0.010441342368721962, 0.025094779208302498, 0.00616428954526782, 0.02319386601448059, -0.04223034158349037, 0.0115217175334692, -0.01877663843333721, -0.013997006230056286, 0.02597001940011978, -0.007193380501121283, -0.028500009328126907, 0.03068811073899269, -0.0037505412474274635, -0.03930375725030899, -0.020130524411797523, 0.035419877618551254, 0.040780723094940186, -0.049286965280771255, -0.045348383486270905, -0.002449647057801485, 0.038866136223077774, -0.09321308135986328, 0.013231170363724232, -0.02101944200694561, -0.02222289703786373, -0.06755760312080383, -0.02225024811923504, 0.0565624013543129, 0.03019578754901886, 0.006560883019119501, -0.008807105012238026, 0.03273945674300194, 0.007562622427940369, -0.018106533214449883, -0.053034089505672455, 0.002087242901325226, 0.014455139636993408, 0.023987052962183952, 0.006338654085993767, -0.007938702590763569, -0.011843094602227211, 0.035720743238925934, -0.0057266694493591785, 0.06586182862520218, -0.04504752159118652, -0.011473852209746838, 0.00038249025237746537, 0.01363460160791874, 0.030359895899891853, -0.014879084192216396, 0.014441464096307755, -0.009094293229281902, 0.009292589500546455, -0.054866623133420944, 0.018721936270594597, -0.010742206126451492, -0.025409318506717682, 0.008964374661445618, -0.008984887972474098, 0.028718819841742516, 0.003422326175495982, 0.0044548362493515015, -0.0224827341735363, 0.038155004382133484, -0.01600048504769802, -0.027980336919426918, -0.03758062794804573, 0.039467863738536835, 0.030469300225377083, -0.03101632557809353, 0.032274484634399414, -0.02577855996787548, 0.034599341452121735, 0.010085776448249817, 0.0337240993976593, -0.001740223728120327, 0.018790313974022865, -0.020486092194914818, -0.010407153517007828, -0.0003290698223281652, -0.046442434191703796, 0.003109496086835861, -0.062360867857933044, 0.026817908510565758, -0.02052711881697178, 0.024397321045398712, 0.033806152641773224, 0.007644676603376865, 0.029101736843585968, -0.04964253306388855, -0.0023316945880651474, 0.046962108463048935, -0.001868432736955583, 0.04075337201356888, 0.044582549482584, 0.006813881918787956, 0.056890614330768585, 0.014673949219286442, -0.023836620151996613, 0.00015331662143580616, -0.025942668318748474, 0.0038360138423740864, -0.051830630749464035, 0.01142598781734705, -0.051310960203409195, -0.008895996026694775, -0.004854848142713308, -0.033477939665317535, -0.03503695875406265, -0.010899475775659084, -0.015248325653374195, -0.030824866145849228, -0.012533714063465595, 0.014933786354959011, 0.02581958658993244, -0.03738917037844658, -0.006441221106797457, -0.024547753855586052, 0.04064396768808365, -0.022510085254907608, 0.023139163851737976, -0.03511901572346687, 0.023686189204454422, -0.0061574517749249935, 0.0790451318025589, 0.023330623283982277, 0.004834334831684828, -0.005641196854412556, -0.02457510493695736, 0.04370730742812157, -0.022304950281977654, 0.0029795775189995766, -0.03831911087036133, -0.01981598511338234, -0.01279355026781559, 0.0032599279657006264, -0.01453719288110733, 0.01630134880542755, -0.03413436934351921, -0.01682102307677269, -0.024301592260599136, 0.006362586282193661, -0.002646234119310975, -0.0032035158947110176, -0.022263923659920692, -0.024041755124926567, -0.03648657724261284, 0.01936469040811062, -0.035201068967580795, -0.00923788733780384, 0.02926584519445896, -0.021101495251059532, -0.016793671995401382, 0.0057608587667346, 0.022510085254907608, 0.004557403270155191, -0.03191891685128212, 0.0063523296266794205, -0.029539357870817184, 0.018598854541778564, -0.07707584649324417, -0.010270397178828716, 0.044527847319841385, -0.019802309572696686, -0.03498225659132004, -0.03944051265716553, 0.01602783612906933, -0.035419877618551254, -0.02659909799695015, 0.01742275059223175, 0.01397649198770523, -0.04521162807941437, -0.030633408576250076, 0.052432358264923096, 0.001737659564241767, 0.018297990784049034, -0.04165596514940262, -0.022756246849894524, 0.004041148349642754, 0.025532398372888565, -0.013060225173830986, 0.013388440012931824, 0.009347292594611645, 0.037854138761758804, 0.04611422121524811, 0.04605951905250549, 0.03766268119215965, 0.0014650017255917192, 0.012663631699979305, -0.024752886965870857, -0.04852113127708435, 0.019268961623311043, 0.0015179947949945927, 0.01212344504892826, 0.023617811501026154, -0.09261135756969452, 0.03615836054086685, -0.03511901572346687, -0.014263680204749107, 0.017709938809275627, -0.05442900210618973, 0.005101009272038937, 0.017545832321047783, 0.031645406037569046, 0.03492755442857742, -0.014879084192216396, 0.0026154639199376106, -0.012786712497472763, -0.04780999943614006, 0.02543666958808899, -0.01453719288110733, 0.039358459413051605, -0.015467136166989803, -0.007480568718165159, -0.03293091431260109, 0.014113248325884342, -0.022769922390580177, 0.06837814301252365, -0.0046121058985590935, -0.01963820308446884, 0.009388319216668606, -0.04455519840121269, 0.04704416170716286, 0.005285630468279123, -0.014564544893801212, -7.83677605795674e-05, -0.0029556453227996826, -0.05825817957520485, -0.026503367349505424, 0.0020633104722946882, -0.004266796167939901, -0.017805667594075203, 0.019843338057398796, 0.04026104882359505, 0.0017462067771703005, 0.020212579518556595, -0.05196738988161087, 0.015111569315195084, -0.03711565583944321, -0.08539062738418579, 0.019091177731752396, -0.012971334159374237, -0.045649249106645584, -0.04997074604034424, -0.05825817957520485, -0.016725294291973114, -0.035611335188150406, -0.02405543066561222, -0.00163680175319314, 0.0633455142378807, 0.02405543066561222, -0.0040650805458426476, -0.026845259591937065, -0.04627832770347595, -0.016916751861572266, 0.02356310747563839, -0.04704416170716286, 0.0016462038038298488, -0.00932677835226059, 0.03588484972715378, -0.03405231609940529, -0.060938600450754166, -0.012096093967556953, -0.05563245713710785, 0.02877352200448513, -0.029703466221690178, 0.0011735399020835757, -0.007480568718165159, 0.0006346346344798803, -0.031864214688539505, -0.04671594873070717, 0.02648969180881977, -0.01731334626674652, -0.0054360623471438885, 0.011268718168139458, 0.01835269294679165, -0.006335234735161066, 0.016315024346113205, 0.013114928267896175, 0.017477452754974365, 0.00587368244305253, -0.0166705921292305, 0.047782644629478455, 0.012089255265891552, 0.021265601739287376, -0.010277234949171543, -0.008759239688515663, 0.020554469898343086, 0.0024599037133157253, 0.006184802856296301, 0.0147970300167799, -0.0032189011108130217, 0.024561429396271706, 0.013196981512010098, 0.011234529316425323, 0.022263923659920692, -0.03952256590127945, 0.03990548476576805, -0.013586737215518951, 0.008089134469628334, -0.01656118594110012, 0.0010837935842573643, 0.01933733932673931, 0.022045113146305084, 0.0023846877738833427, 0.035310473293066025, -0.03878408297896385, -0.04162861406803131, 0.02989492379128933, -0.045758653432130814, 0.061759140342473984, -0.02659909799695015, 0.030824866145849228, -0.07324666529893875, 0.007870323956012726, 0.018571503460407257, 0.0074668931774795055, 0.004249701742082834, 0.0031248810701072216, 0.01286876667290926, -0.024534078314900398, -0.017409075051546097, -0.018927069380879402, 0.012355930171906948, 0.033368535339832306, -0.0035556633956730366, -0.050900690257549286, -0.02240067906677723, -0.030414598062634468, -0.015166272409260273, 0.032383888959884644, -0.009566102176904678, -0.09343189746141434, 0.0024120390880852938, 0.003719771048054099, 0.027665797621011734, 0.0023316945880651474, -0.0010205437429249287, 0.054237544536590576, 0.027173474431037903, 0.07477834075689316, -0.005330076441168785, 0.03194626793265343, -0.029129089787602425, 0.018968096002936363, -0.04212093725800514, 0.02772049978375435, -0.034189071506261826, 0.027638444676995277, -0.025012724101543427, -0.016656916588544846, 0.012697821483016014, -0.025231534615159035, 0.0294026006013155, 0.01828431524336338, 0.016123566776514053, 0.005877101328223944, 0.006991665344685316, -0.037635330110788345, 0.023289594799280167, -0.016287673264741898, -0.01626032218337059, 0.02281094901263714, 0.02356310747563839, -0.021812627092003822, -0.033696748316287994, -0.039249055087566376, -0.03049665130674839, 0.024670833721756935, 0.06728409230709076, 0.012273876927793026, 0.0220998153090477, 0.010400315746665001, 0.006082235835492611, -0.024711860343813896, -0.006629261188209057, 0.049916043877601624, -0.015056867152452469, 0.005036050453782082, 0.01918690651655197, -0.05437429994344711, 0.034079667180776596, -0.00990799255669117, 0.04184742271900177, 0.0032189011108130217, -0.012157633900642395, 0.01146701443940401, 0.011535393074154854, 0.019925391301512718, 0.010817422531545162, 0.01656118594110012, 0.048192914575338364, -0.007186542730778456, -0.009190022014081478, -0.03730711340904236, -0.003665068419650197, 0.0014923529233783484, -0.0234126765280962, 0.007747243624180555, -0.009347292594611645, 0.03284886106848717, 0.024739211425185204, 0.01805182918906212, -0.0498339906334877, 0.021484412252902985, -0.04942372068762779, 0.022619489580392838, -0.02629823423922062, -0.00998320896178484, 0.06099330261349678, 0.048274967819452286, 0.07264494150876999, -0.04592275992035866, -0.009032752364873886, -0.08101442456245422, -0.03758062794804573, 0.011856770142912865, 0.005695899482816458, -0.01921425759792328, -0.056070078164339066, 0.003328306134790182, -0.022578462958335876, -0.046551838517189026, 0.037143006920814514, 0.017395399510860443, 0.014988488517701626, -0.07587238401174545, -0.02472553588449955, 0.010831098072230816, 0.051529768854379654, -0.019022800028324127, -0.0037026763893663883, -0.005299306008964777, -0.021306630223989487, 0.00013355106057133526, 0.0052001578733325005, -0.03375145047903061, 0.009901154786348343, -0.005907871760427952, -0.008984887972474098, 0.04433638975024223, -0.06498658657073975, -0.009962695650756359, -0.010243046097457409, 0.028527360409498215, 0.014756003394722939, -0.0008778044139035046, -0.08725050836801529, 0.07877162098884583, -0.009996884502470493, 0.015562864951789379, -0.018831340596079826, 0.01251319982111454, 0.013689304701983929, -0.02315283939242363, -0.010721692815423012, -0.00201373640447855, 0.03301296755671501, 0.03194626793265343, 0.03771738335490227, 0.010742206126451492, 0.00914215762168169, -0.019460419192910194, -0.07587238401174545, -0.010762719437479973, -0.01832534186542034, -0.035720743238925934, 0.018161235377192497, 0.007364326156675816, -0.03068811073899269, -0.03323177620768547, -0.005408711265772581, -0.0025043494533747435, -0.01753215678036213, 0.03607630729675293, 0.015590216964483261, 0.011549068614840508, 0.10956913977861404, 0.04264061152935028, -0.013921789824962616, -0.006625841837376356, -0.022537436336278915, -0.011460176669061184, -0.004489025101065636, 0.04253120347857475, -0.015685945749282837, 0.045649249106645584, 0.033177074044942856, 0.008800267241895199, -0.02438364550471306, 0.020964737981557846, -0.03536517545580864, 0.016232971101999283, 0.054757218807935715, 0.04201153293251991, -0.005894195754081011, -0.005661710165441036, -0.005220671184360981, 0.013682466000318527, -0.02345370315015316, -0.004666808061301708, 0.011145637370646, 0.0067215715534985065, 0.005607007537037134, 0.030168436467647552, 0.037416521459817886, 0.010010560043156147, 0.009244725108146667, 0.008718213066458702, -0.0005739490152336657, 0.001065844320692122, 0.0046531325206160545, -0.013032874092459679, 0.012458497658371925, -0.021757924929261208, -0.020896360278129578, 0.005018955562263727, -0.029429953545331955, -0.033806152641773224, -0.09994149208068848, 0.0036548117641359568, -0.028089741244912148, 0.030414598062634468, -0.005425805691629648, -0.03604895621538162, 0.004400133620947599, -0.0472082681953907, -0.02255111187696457, 0.027378609403967857, -0.0007923317607492208, 0.019501445814967155, 0.019227933138608932, 0.008642997592687607, 0.003261637408286333, 0.017860371619462967, 0.018270639702677727, -0.01903647556900978, -0.008930185809731483, 0.02435629442334175, -0.04510222375392914, -0.0005312127177603543, 0.019392041489481926, 0.008882320486009121, -0.02214084193110466, 0.04305087774991989, -0.016424430534243584, -0.02899233251810074, 0.030168436467647552, 0.02480759099125862, 0.01528935320675373, -0.010065262205898762, 0.03038724698126316, 0.05483927205204964, 0.005952317267656326, 0.017586858943104744, -0.02653072029352188, -0.027583742514252663, -0.014181626960635185, 0.024930670857429504, 0.015015840530395508, -0.005299306008964777, 0.030961623415350914, -0.014673949219286442, -0.02300240658223629, 0.027255527675151825, -0.008759239688515663, 0.012581578455865383, -0.024260565638542175, 0.00022821205493528396, 0.039249055087566376, 0.007801946252584457, -0.002444518730044365, -0.03120778501033783, -0.007049786392599344, -0.002618882805109024, -0.03583014756441116, -0.007808784022927284, 0.00192484469152987, 0.0013051677960902452, -0.007138678338378668, 0.0068002063781023026, 0.02524521015584469, 0.02112884633243084, -0.026161476969718933, 0.019870689138770103, -0.018762962892651558, -0.007343812379986048, -0.010632800869643688, 0.019050151109695435, -0.04469195380806923, -0.06006336212158203, -0.03514636680483818, 0.0076241628266870975, 0.013887600973248482, -0.014906435273587704, -0.017655236646533012, -0.02491699531674385, 0.04510222375392914, -0.024069106206297874, 0.010537072084844112, 0.005401873495429754, -0.049068156629800797, 0.0016863759374246001, -0.017627885565161705, -0.03194626793265343, -0.010578098706901073, -0.04444579407572746, -0.0032941170502454042, 0.014359409920871258, -0.05177592858672142, 0.03142659366130829, -0.030961623415350914, 0.006560883019119501, -0.016424430534243584, -0.022277599200606346, -0.00739851500838995, 0.013443143106997013, 0.01309441402554512, -0.003921486437320709, -0.04953312501311302, -0.0382097065448761, 0.04050721228122711, -0.014154275879263878, 0.030852219089865685, -0.004099269863218069, 0.020650198683142662, -0.0069164494052529335, 0.0057095750235021114, 0.02607942372560501, 0.008348971605300903, 0.0005585639737546444, 0.0013718365225940943, 0.04105423763394356, 0.029812870547175407, 0.00951823778450489, -0.048274967819452286, 0.027146123349666595, -0.003613784909248352, 0.0102088563144207, 0.00026902524405159056, 0.004759118892252445, -0.027925632894039154, -0.041683316230773926, -0.03153599798679352, 0.029566708952188492, 0.0322197824716568, 0.03254799544811249, -0.023234892636537552, -0.010475531220436096, 0.0019043312640860677, -0.008266917429864407, -0.021894682198762894, -0.01489275973290205, -0.01589108072221279, -0.022687867283821106, -0.0166705921292305, 0.030168436467647552, 0.018010802567005157, -0.005415549036115408, 0.027898281812667847, 0.005230927839875221, 0.02308446168899536, 0.03476344794034958, -0.0027710243593901396, 0.029101736843585968, -0.017969775944948196, -0.024110132828354836, -0.0117063382640481, -0.03498225659132004, -0.03498225659132004, -0.0015744067495688796, 0.029211143031716347, -0.049068156629800797, 0.009449859149754047, -0.07970156520605087, -0.012711497023701668, -0.006499342620372772, 0.011856770142912865, 0.03323177620768547, -0.013087576255202293, -0.0015453459927812219, -0.0528152771294117, 0.01662956364452839, -0.0033112114761024714, -0.01124136708676815, -0.010632800869643688, -0.02618882805109024, -0.0014752583811059594, -0.0029812869615852833, 0.0483296699821949, -0.015932107344269753, -0.004321498796343803, -0.012458497658371925, 0.012561065144836903, -0.02416483499109745, 0.00220519513823092, -0.018120208755135536, -0.006848071236163378, -0.03487285226583481, 0.01154223084449768, 0.051228903234004974, -0.041300397366285324, -0.016725294291973114, 0.014181626960635185, -0.026216179132461548, 0.027036717161536217, -0.04026104882359505, 0.0166705921292305, 0.013238008134067059, -0.00031047951779328287, 0.006188221741467714, -0.027118772268295288, -0.0314812958240509, 0.027980336919426918, -0.020773280411958694, -0.006540369242429733, 0.030168436467647552, 0.027118772268295288, -0.01094050332903862, 0.01779199205338955, 0.029840221628546715, 0.03375145047903061, 0.041409801691770554, 0.013860249891877174, -0.0037949869874864817, -0.014318383298814297, -0.012041390873491764, 0.009053266607224941, -0.05555040389299393, -0.009367805905640125, -0.05585126578807831, 0.009285751730203629, -0.01459189597517252, -0.04389876872301102, -0.01723129115998745, 0.04285942018032074, -0.023658838123083115, -0.03717035800218582, 0.009737047366797924, 0.017750965431332588, 0.01483805663883686, -0.021552789956331253, -0.027337580919265747, 0.012752523645758629, 0.003938580863177776, 0.015467136166989803, 0.03060605749487877, -0.016438106074929237, 0.03678743913769722, -0.001088067190721631, -0.006919868290424347, 0.02147073671221733, 0.011808905750513077, -0.01258841622620821, 0.03443523123860359, -0.006242924369871616, 0.016232971101999283, 0.023289594799280167, -0.00940199475735426, -0.0011607189662754536, 0.008219053037464619, 0.008444700390100479, -0.00921737402677536, -0.025381967425346375, 0.010092614218592644, 0.02019890397787094, 0.027282878756523132, -0.036021605134010315, -0.01365511491894722, 0.004571078810840845, 0.00835580937564373, 0.06329081207513809, -0.00192484469152987, -0.032985616475343704, 0.006926706060767174, -0.006882260087877512, -0.0036172037944197655, -0.0279119573533535, -0.00757629843428731, 0.016424430534243584, -0.02640763856470585, -0.02244170568883419, -0.019323663786053658, -0.009374643675982952, -0.011836256831884384, 0.006003601010888815, -0.0032872792799025774, 0.00026261480525135994, -0.038537923246622086, -0.08828985691070557, -0.04039780795574188, 0.014277356676757336, -0.0029607736505568027, -0.0014376504113897681, 0.01813388429582119, -0.0036753250751644373, -0.0058292364701628685, -0.019474094733595848, -0.02127927727997303, -0.004639456979930401, -0.02614780142903328, 0.009531913325190544, -0.023631487041711807, -0.01662956364452839, -0.03525577113032341, 0.0010427667293697596, -0.013456818647682667, 0.04187477380037308, -0.01824328862130642, -0.03727976232767105, 0.01645178161561489, 0.007945540361106396, 0.004526633303612471, -0.027706824243068695, -0.05388197675347328, 0.0016017579473555088, -0.020321983844041824, 0.0027231595013290644, 0.0031419757287949324, -0.02168954722583294, 0.00036902830470353365, 0.023180190473794937, 0.010735368356108665, -0.035501930862665176, 0.012465335428714752, -0.03301296755671501, 0.009771236218512058, 0.03284886106848717, -0.009750722907483578, 0.002336823148652911, -0.03342323750257492, 0.002099208999425173, 0.013942303135991096, 0.03282150998711586, -0.013668790459632874, 0.05511278286576271, 0.031235136091709137, 0.011494365520775318, -0.005555724259465933, 0.015262001194059849, 0.0028428214136511087, 0.015549189411103725, 0.013320062309503555, -0.01545346062630415, 0.03777208551764488, 0.019829660654067993, -0.011056745424866676, -0.006225829944014549, 0.0015547480434179306, 0.018899718299508095, 0.0374712236225605, -0.017559507861733437, 0.00021186540834605694, -0.04387141764163971, -0.029019683599472046, 0.0047933077439665794, 0.020513443276286125, 0.015986809507012367, -0.03413436934351921, -0.03284886106848717, 0.035693392157554626, -0.0038394327275455, -0.02278359793126583, 0.031071027740836143, 0.014564544893801212, -0.0017145819729194045, 0.04715356603264809, -0.06870635598897934, 0.03391556069254875, 0.012089255265891552, -0.040589265525341034, 0.027036717161536217, 0.0010196890216320753, 0.00807545892894268, 0.032383888959884644, 0.05166652426123619, -0.03960461914539337, -0.00577111542224884, 0.02573753334581852, 0.0460868701338768, -0.023658838123083115, 0.020732253789901733, -0.008191701956093311, -0.009757560677826405, 0.019802309572696686, 0.03353264182806015, -0.003976189065724611, -0.02584693767130375, 0.022605814039707184, 0.023508405312895775, 0.010010560043156147, -0.0021453641820698977, -0.07062094658613205, -0.01172685157507658, -0.006742084864526987, 0.007234407588839531, -0.021826302632689476, 0.024711860343813896, -0.022769922390580177, -0.00895753689110279, 0.01989804022014141, 0.012273876927793026, 0.04225769266486168, -0.005784790962934494, 0.032383888959884644, 0.030223138630390167, -0.010147316381335258, 0.009477210231125355, -0.03172745928168297, -0.0029881249647587538, 0.0318368636071682, -0.003641136223450303, -0.02761109359562397, 0.0020718576852232218, -0.0008483163546770811, 0.009661831893026829, 0.024971697479486465, -0.006868584547191858, 0.01888604275882244, -0.024821266531944275, 0.03544722869992256, 0.013258522376418114, 0.006813881918787956, 0.0033214683644473553, -0.03796354681253433, -0.003408650401979685, -0.04285942018032074, 0.02825384959578514, 0.006540369242429733, 0.01645178161561489, 0.021853653714060783, 0.043324392288923264, -0.014851733110845089, -0.024588780477643013, -0.016738969832658768, 0.020335659384727478, -0.010031073354184628, -0.020814307034015656, -0.004666808061301708, -0.01772361434996128, -0.0279119573533535, -0.0008068620809353888, 0.010625963099300861, -0.021457061171531677, -0.008212215267121792, -0.028417956084012985, -0.006010438781231642, 0.025874288752675056, 0.04925961419939995, 0.008007080294191837, 0.03232918679714203, -0.02071857824921608, -0.007617325056344271, 0.03695154935121536, 0.0011863608378916979, -0.014222653582692146, -0.0013752554077655077, -0.0037026763893663883, 0.05248706415295601, -0.02855471335351467, -0.010229370556771755, 0.03413436934351921, 0.020253606140613556, 0.046360380947589874, 0.030633408576250076, 0.0045197950676083565, -0.038237057626247406, 0.014195302501320839, 0.01319014374166727, -0.002434261841699481, 0.01165163516998291, -0.0288555771112442, -0.0027334161568433046, 0.014455139636993408, -0.008882320486009121, 0.013121766038239002, 0.010222532786428928, 0.0228519756346941, 0.016014160588383675, -0.003832594957202673, 0.01660221256315708, -0.0200484711676836, 0.010612287558615208, -0.0015145759098231792, -0.019282637163996696, 0.012314903549849987, 0.020841658115386963, -0.021976735442876816, 0.028937630355358124, 0.0069164494052529335, 0.019009124487638474, -0.0159184318035841, -0.019583500921726227, -0.018297990784049034, 0.033778801560401917, -0.02188100665807724, -0.0005320674390532076, -0.004249701742082834, 0.023330623283982277, -0.005812142044305801, 0.004564241040498018, -0.004796726629137993, 0.023932350799441338, -0.022113490849733353, 0.0022137423511594534, -0.0058668446727097034, -0.017217615619301796, 0.0010171248577535152, -0.03506431356072426, -0.008772916160523891, -0.0023180190473794937, -0.004372782073915005, 0.014044870622456074, -0.020554469898343086, -0.020103173330426216, 0.0027385447174310684, -0.024602456018328667, 0.02498537302017212, 0.021634845063090324, -0.011391798965632915, 0.014195302501320839, -0.011788391508162022, -0.029129089787602425, -0.02315283939242363, -0.02689996175467968, -0.011002043262124062, -0.01104990765452385, -0.020335659384727478, -0.005466832313686609, 0.0472082681953907, 0.00025406753411516547, 0.009962695650756359, -0.0023453703615814447, -0.020773280411958694, -0.010701179504394531, -0.011220852844417095, 0.044226981699466705, -0.023221217095851898, 0.0031744553707540035, -0.003355657448992133, -0.021115170791745186, 0.01746377721428871, -0.01632869988679886, 0.03457199037075043, 0.012991847470402718, 0.036322470754384995, 0.04477400705218315, 0.010372964665293694, 0.022086139768362045, -0.01899544894695282, 0.0022872488480061293, -0.01936469040811062, -0.013012360781431198, 0.0007816476281732321, -0.00308214477263391, 0.0007483133231289685, 0.00024039190611802042, 0.02179895155131817, 0.018339017406105995, -0.018161235377192497, 0.0344625823199749, -0.0006777983508072793, 0.02356310747563839, -0.038155004382133484, 0.007207056507468224, 0.015877405181527138, 0.00884129386395216, 0.007542109116911888, -0.014373085461556911, -0.03588484972715378, -0.008526754565536976, 0.010988367721438408, -0.002059891587123275, -0.001789797912351787, -0.026626449078321457, -0.026544395834207535, -0.007658352144062519, 0.024848617613315582, -0.022209221497178078, 0.00023953718482516706, 0.0516938753426075, 0.007371163927018642, -0.000984645215794444, 0.010933664627373219, -0.005193320102989674, 0.013326900079846382, 0.0016889401013031602, 0.013381602242588997, -0.045238979160785675, 0.011309744790196419, 0.023029759526252747, 0.025600776076316833, -0.009484048001468182, 0.009976371191442013, 0.029621411114931107, 0.017600534483790398, -0.024233214557170868, -0.019829660654067993, 0.011624284088611603, 0.012417471036314964, 0.019788634032011032, -0.00037372930091805756, 0.01342946756631136, -0.017928749322891235, -0.02465715818107128, 0.002230837009847164, -0.045731302350759506, 0.012465335428714752, -0.023686189204454422, -0.010974692180752754, 0.0015273967292159796, -0.0005179644213058054, -0.0020684388000518084, 0.01753215678036213, -0.05196738988161087, -0.016533834859728813, 0.006420707795768976, -0.012321741320192814, 0.0057642776519060135, 0.025450345128774643, 0.0065643019042909145, -0.007713054772466421, 0.018571503460407257, -0.025600776076316833, -0.01154223084449768, -0.008813942782580853, -0.0064309644512832165, 0.0025487951934337616, -0.004499281756579876, 0.009538751095533371, 0.03457199037075043, 0.005757439881563187, -0.016998806968331337, -0.011432825587689877, 0.015836378559470177, -0.017750965431332588, 0.02997697703540325, 0.008068621158599854, -0.0037949869874864817, 0.07149618864059448, -0.009661831893026829, -0.019378365948796272, -0.01621929556131363, -0.023467378690838814, 0.021963059902191162, 0.02199041098356247, 0.007193380501121283, -0.041956827044487, 0.027105096727609634, 0.00211630342528224, -0.0018103113397955894, 0.026120450347661972, 0.02394602634012699, 0.006407031789422035, 0.00017254796694032848, 0.006875422317534685, 0.035912200808525085, -0.007644676603376865, -0.02435629442334175, 0.03749857470393181, -0.015166272409260273, -0.014564544893801212, -0.010919989086687565, -0.02349472977221012, -0.009251562878489494, -0.008731888607144356, 0.013511520810425282, 0.05265117064118385, 0.050408367067575455, 0.01221233606338501, -0.028117092326283455, -0.01326536014676094, -0.033177074044942856, 0.02019890397787094, 0.022428030148148537, 0.0024137485306710005, 0.03312237188220024, 0.017819344997406006, -0.014277356676757336, 0.013491007499396801, 0.02364516258239746, -0.002668457105755806, 0.005918128415942192, -0.010783232748508453, -0.024410996586084366, 0.0016803928883746266, -0.008711375296115875, 0.019720256328582764, -0.008314781822264194, -0.006222411058843136, -0.0037026763893663883, 0.006116424687206745, 0.0024086202029138803, 0.026667475700378418, -0.042914122343063354, 0.004714672919362783, 0.019980093464255333, 0.007029273081570864, -0.015179947949945927, -0.049505773931741714, -0.05292468145489693, -0.010065262205898762, 0.012554227374494076, 0.009060104377567768, -0.040069591253995895, -0.013408954255282879, 0.02442467212677002, -0.005678804591298103, -0.010612287558615208, 0.002126560313627124, 0.01144650112837553, -0.008472051471471786, -0.015412433072924614, 0.008478890173137188, 0.007350650150328875, 0.005422386806458235, 0.010331937111914158, 0.030141085386276245, 0.03615836054086685, -0.015508162789046764, -0.017217615619301796, -0.020404037088155746, 0.003059922019019723, 0.0009572940180078149, -0.0032428335398435593, 0.0460868701338768, -0.0009906283812597394, -0.0003818491823039949, 0.01839371956884861, -0.019624527543783188, 0.011323420330882072, 0.02997697703540325, 0.005330076441168785, -0.026311909779906273, -0.01891339384019375, 0.01738172397017479, -0.021648520603775978, 0.0035761769395321608, -0.0011684115743264556, -0.013819222338497639, -0.022168194875121117, -0.004516376182436943, -0.004875361453741789, -0.010338774882256985, -0.006947219371795654, -0.030879570171236992, -0.024069106206297874, 0.002488964470103383, 0.02121089957654476, 0.02194938436150551, -0.0023915255442261696, -0.0043385932222008705, 0.009914830327033997, -0.0005478798993863165, 0.0010837935842573643, 0.004714672919362783, -0.0037915681023150682, -0.010318261571228504, -0.009340453892946243, 0.024493051692843437, 0.03870202973484993, -0.000695320253726095, 0.019433068111538887, -0.004092432092875242, -0.0011085806181654334, -0.028937630355358124, -0.012164471670985222, -0.005651453509926796, -0.032356537878513336, -0.0013231170596554875, -0.014879084192216396, 0.0021573305130004883, 0.01989804022014141, 0.00921737402677536, 0.02278359793126583, -0.024110132828354836, -0.038975540548563004, -0.008383160457015038, -0.016547510400414467, 0.01288927998393774, 0.03599425405263901, -0.011220852844417095, -0.02685893513262272, -0.015234650112688541, -0.004482187330722809, -1.232676277140854e-05, 0.019077502191066742, 0.03689684718847275, -0.014167951419949532, -0.01888604275882244, -0.0051215230487287045, 0.008526754565536976, 0.02468450926244259, -0.00625659991055727, 0.032985616475343704, -0.015275676734745502, -0.01884501613676548, 0.0284726582467556, 0.031153082847595215, 0.03599425405263901, -0.005658291280269623, 0.011268718168139458, 0.017067184671759605, 0.03881143406033516, -0.027364932000637054, -0.006071979179978371, 0.015836378559470177, 0.002557342639192939, -0.016697943210601807, -0.004919807426631451, 0.04895875230431557, 0.026065748184919357, -0.01030458603054285, -0.006752341520041227, 0.016055187210440636, -0.007439542096108198, 0.05524953827261925, -0.020595496520400047, 0.001474403659813106, -0.004666808061301708, 0.006697638891637325, 0.0018667232943698764, 0.010612287558615208, -0.033587343990802765, -0.018598854541778564, 0.00020919437520205975, -0.0015615858137607574, -0.01165163516998291, -0.013552548363804817, 0.011043069884181023, -0.007849810644984245, 0.022236572578549385, -0.001998351188376546, 0.016916751861572266, 0.014441464096307755, 0.012355930171906948, 0.05590596795082092, 0.01602783612906933, 0.02547769621014595, -0.020964737981557846, -0.017108211293816566, -0.016356050968170166, -0.028445307165384293, 0.018065504729747772, 0.0363498218357563, 0.01600048504769802, -0.0017453520558774471, 0.007029273081570864, -0.02127927727997303, 0.009668669663369656, 0.0142363291233778, -0.0012837996473535895, 0.01944674365222454, 0.019282637163996696, 0.0031744553707540035, -0.005111266393214464, -0.0295940600335598, -0.024438347667455673, -0.00015726972196716815, -0.007658352144062519, 0.02364516258239746, 0.006396775133907795, -0.009374643675982952, 0.010783232748508453, -0.02000744454562664, 0.037854138761758804, -0.009641318581998348, -0.014277356676757336, 0.0015598763711750507, 0.006899354513734579, 0.012335416860878468, -0.008786591701209545, -0.0107695572078228, -0.0071523538790643215, 0.0014923529233783484, -0.021224575117230415, 0.007842972874641418, 0.015562864951789379, 0.03648657724261284, -0.01519362349063158, -0.004967672284692526, 0.005904452875256538, -0.00014006835408508778, 0.015275676734745502, 0.04223034158349037, 0.004389876965433359, 0.007726730313152075, -0.0069814082235097885, 0.0015487649943679571, -0.03665068373084068, -0.009087455458939075, -0.012622605077922344, -0.0003380444541107863, 0.007706216536462307, -0.07220731675624847, 0.01290979329496622, -0.002624011132866144, 0.01260892953723669, 0.012226011604070663, -0.035720743238925934, 0.004724929574877024, -0.0024821266997605562, -0.009716534055769444, 0.027706824243068695, 0.005439481232315302, -0.032165080308914185, 0.014003844000399113, -0.032165080308914185, -0.0013803837355226278, 0.010988367721438408, -0.009538751095533371, -0.006301045883446932, -0.003620622679591179, 0.01910485327243805, 0.02450672723352909, -0.004147134255617857, -0.028144443407654762, 0.02603839710354805, -0.01966555416584015, -0.001670990837737918, 0.01888604275882244, 0.0031300093978643417, -0.013408954255282879, 0.006140357349067926, 0.02263316512107849, -0.006977989338338375, 0.01182258129119873, -0.005607007537037134, 0.01787404716014862, 0.02521785907447338, 0.0048719425685703754, 0.03293091431260109, -0.017094535753130913, -0.01820226199924946, 0.01809285581111908, 0.003485575783997774, 0.021757924929261208, 0.006478828843683004, -0.002806922886520624, -0.016342375427484512, -0.00788399949669838, 0.007131840102374554, -0.0009461825829930604, 0.006796787492930889, 0.03799089789390564, 0.007631000597029924, 0.02825384959578514, -0.028910279273986816, 0.018639881163835526, -0.020691225305199623, -0.015781674534082413, -0.015371406450867653, 0.017901398241519928, -0.00020513443450909108, 0.024739211425185204, -0.008417349308729172, 0.0531981959939003, -0.008848131634294987, 0.05084598809480667, -0.014277356676757336, -0.008909672498703003, -0.01705350913107395, -0.022619489580392838, 0.02427424117922783, -0.0030137666035443544, -0.0006739520467817783, -0.0006837814580649137, 0.0318368636071682, 0.0226605162024498, 0.031453944742679596, -0.005418967921286821, 0.016287673264741898, -0.044719304889440536, -0.008403673768043518, -0.024944346398115158, 0.0015957748983055353, 0.016547510400414467, 0.04042515903711319, -0.024821266531944275, -0.02825384959578514, 0.0050839148461818695, 0.014455139636993408, -0.05109214782714844, -0.03867467865347862, 0.01783302053809166, -0.028746170923113823, 0.0059762499295175076, -0.03159070387482643, 0.018229613080620766, 0.02123825065791607, 0.04039780795574188, 0.014304707758128643, 0.030414598062634468, 0.05043571814894676, 0.0063523296266794205, 0.03342323750257492, -0.022086139768362045, -0.020472416654229164, 0.011200339533388615, -0.019843338057398796, -0.001046185614541173, 0.020253606140613556, 0.00833529606461525, 0.019173230975866318, 0.011439663358032703, -0.03057870641350746, -0.010673828423023224, -0.0026787137612700462, -0.004789888858795166, -0.0004136877541895956, 0.023016082122921944, 0.005401873495429754, 0.008198539726436138, 0.0010051587596535683, 0.005193320102989674, 0.004413809161633253, -0.005692480597645044, 0.012020877562463284, 0.014673949219286442, 0.03615836054086685, -0.013538871891796589, 0.008895996026694775, -0.01354571059346199, -0.011480689980089664, 0.013819222338497639, 0.0037573790177702904, -0.013962816447019577, 0.010721692815423012]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
" out of memory and report the peak memory
usage and throughput between KIVI (with residual length
32 and 128) and FP16 baseline for the Llama-2-7B model.
The hardware here is a single NVIDIA A100 GPU (80GB).
As shown in Figure 4, with similar maximum memory us-
age,KIVI enables up to 4×larger batch size and gives
2.35× ∼3.47×larger throughput. This throughput num-
ber can grow larger with longer context length and output
length. We also note that this speedup can be greatly in-
creased if we further fuse the KV cache quantization
process with previous operations. We leave it as one of
the future work.
7
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
Table 4: Performance evaluation of KIVI on various models across a range of benchmarks in LongBench. We highlight the
average performance of our method.
Model Qasper QMSum MultiNews TREC TriviaQA SAMSum LCC RepoBench-P Average
Llama2-7B16bit 9.52 21.28 3.51 66 87.72 41.69 66.66 59.82 44.52
KIVI-2 9.31 20.5 1.14 66 87.42 42.71 66.88 60.23 44.27
Llama2-13B16bit 9.32 21.38 3.71 70 87.87 43.55 66.61 56.42 44.85
KIVI-2 8.58 20.69 6.19 69.5 87.78 44.3 65.08 55.46 44.69
Llama2-7B-Chat16bit 19.65 20.54 26.36 63 84.28 41.12 59.75 52.93 45.95
KIVI-2 19.32 20.46 25.48 63 84.84 40.6 58.71 52.97 45.67
Llama2-13B-Chat16bit 24.18 20.37 25.69 67.5 86.9 42.18 50.23 50.64 45.96
KIVI-2 23.59 20.76 25.25 67.5 87.17 41.56 49.93 48.45 45.52
Falcon-7B16bit 1.48 2.35 11.09 13 5.84 2.44 23.86 9.69 8.71
KIVI-4 1.04 2.41 11.98 13 5.84 2.36 23.72 9.92 8.78
KIVI-2 1.98 3.61 6.78 10 6.24 2.73 22.18 10.12 7.95
Mistral-7B16bit 8.12 19.98 19.99 67.5 89.8 41.69 66.59 58.99 46.58
KIVI-2 6.92 19.71 17.92 66.5 89.63 41.66 65.52 58.99 45.85
Table 5: Ablation study of KIVI by changing group size G
and residual length R
Model Group Size GSM8K
Llama2-13B32 20.77
64 21.00
128 17.29
Model Residual Length GSM8K
Llama2-13B32 20.62
64 19.86
96 20.55
128 20.77
5. Related Work
Quantization techniques have been widely applied in Large
Language Models (Frantar et al., 2022; Lin et al., 2023;
Kim et al., 2023; Xu et al., 2023). A main branch of LLM
quantization is weight-only quantization, which involves
the quantization of model weights to lower precision. For
instance, AWQ (Lin et al., 2023) cleverly quantizes model
weights to INT4 and INT3 using an activation-aware manner.
GPTQ (Frantar et al., 202","[-0.002380739664658904, 0.017954381182789803, 0.04450111463665962, -0.03621663153171539, -0.022796325385570526, 0.009788845665752888, 0.00710548460483551, 0.014595805667340755, -0.019591685384511948, 0.024027803912758827, 0.018052339553833008, 0.026644693687558174, -0.050826430320739746, 0.028631849214434624, 0.006503739859908819, -0.014833705499768257, 0.023174166679382324, -0.009879807010293007, -0.03839970380067825, 0.050434596836566925, -0.013070453889667988, -0.02853389084339142, -0.014539829455316067, 0.021061062812805176, 0.05169406160712242, -0.058551155030727386, -0.041310470551252365, -0.013784150592982769, 0.03406154736876488, -0.08038189262151718, 0.02300623618066311, -0.030367113649845123, -0.03730816766619682, -0.07999005913734436, -0.03865159675478935, 0.027666259557008743, 0.015771307051181793, 0.014071028679609299, -0.021830735728144646, 0.022768337279558182, 0.012279788963496685, -0.055584412068128586, -0.05102234706282616, 0.015337491407990456, 0.043493542820215225, 0.0537651851773262, 0.00890722032636404, -0.008725297637283802, -0.0465722382068634, 0.033529769629240036, 0.005954473279416561, 0.06728344410657883, -0.043101709336042404, -0.004275185987353325, 0.02173277735710144, 0.017772458493709564, 0.030423089861869812, -0.010019748471677303, 0.038343727588653564, -0.01801035739481449, -0.00043906367500312626, -0.08513987064361572, 0.0064477636478841305, -0.01333634089678526, -0.034369416534900665, 0.019045917317271233, -0.036748405545949936, 0.005943977739661932, 0.0034810227807611227, -0.020109467208385468, -0.022782331332564354, 0.03355775773525238, -0.01182498224079609, -0.0151135865598917, 0.0022687872406095266, 0.02700853906571865, -0.011866964399814606, 0.030367113649845123, 0.028002116829156876, -0.03213036432862282, 0.01250369381159544, 0.01876603625714779, 0.02784818224608898, -0.009823830798268318, 0.0312347449362278, -0.0112792132422328, -0.0020868643186986446, -0.007423849776387215, -0.061629846692085266, -0.00288452603854239, -0.03991106152534485, 0.008648330345749855, -0.028659837320446968, 0.008389439433813095, 0.05715174600481987, 0.009397012181580067, 0.05765553191304207, -0.03870757296681404, 0.018933964893221855, 0.026014959439635277, -0.007703730836510658, 0.05771150812506676, 0.03890348970890045, -0.019591685384511948, 0.06470853835344315, 0.0013714180095121264, 0.001843717647716403, 0.026084929704666138, -0.018696065992116928, 0.0064127785153687, -0.01973162591457367, 0.006671668961644173, -0.06515634804964066, 0.004058277700096369, -0.022614402696490288, -0.03227030485868454, -0.06006251275539398, -0.00702501880005002, -0.00951596163213253, -0.011587083339691162, -0.017072755843400955, 0.001179874292574823, 0.0253992211073637, -0.02604294754564762, 0.003753907047212124, -0.03560089319944382, 0.027414366602897644, -0.027120491489768028, 0.0035265034530311823, -0.017968375235795975, 0.03168255463242531, -0.004100259859114885, 0.09185701608657837, 0.007689736783504486, 0.008613345213234425, -0.0171007439494133, -0.02822602167725563, 0.035069119185209274, -0.02861785516142845, -0.011817985214293003, -0.014609800651669502, -0.025749072432518005, 0.0030699472408741713, -0.002267037983983755, -0.01620512269437313, 0.019815590232610703, -0.0438573881983757, -0.009187101386487484, -0.023384077474474907, -0.008494395762681961, -0.01640103943645954, -0.005664096213877201, -0.045424722135066986, -0.016890831291675568, -0.0336976982653141, 0.01691882126033306, -0.018360208719968796, 0.003676939755678177, 0.0339495949447155, -0.019311804324388504, -0.028715813532471657, 0.0067346422001719475, 0.03974313288927078, -0.013777153566479683, -0.006325315684080124, -0.006643680855631828, -0.06812309473752975, 0.007689736783504486, -0.07719124108552933, -0.023384077474474907, 0.027554307132959366, -0.008025594055652618, -0.027176467701792717, -0.057319674640893936, 0.013014476746320724, -0.043241649866104126, -0.016345063224434853, -0.009788845665752888, -0.01182498224079609, -0.03235426917672157, -0.04357750713825226, 0.05398909002542496, -0.016540979966521263, 0.03921135887503624, -0.040414851158857346, -0.006321817170828581, -0.007864662446081638, 0.024083780124783516, 0.00580403720960021, 0.020599259063601494, -0.006230855826288462, 0.047159988433122635, 0.06325315684080124, 0.04550868645310402, 0.05446488782763481, -0.012237806804478168, 0.017954381182789803, 0.02159283682703972, -0.033585745841264725, -0.003753907047212124, -0.006801113951951265, 0.0076407575979828835, 0.029135635122656822, -0.08133348822593689, 0.0048629362136125565, -0.03557290509343147, -0.0022617902141064405, 0.024461619555950165, -0.05978263169527054, -0.00987280998378992, 0.009250074625015259, 0.06515634804964066, 0.032690126448869705, -0.007745712995529175, -0.00019012244592886418, 0.004121250938624144, -0.046656202524900436, 0.05163808539509773, -0.02289428375661373, 0.047747738659381866, 0.015575390309095383, -0.004803461488336325, -0.020403342321515083, 0.0371682271361351, -0.03515308350324631, 0.023607982322573662, 0.0066611734218895435, -0.004275185987353325, 0.014707759022712708, -0.029667410999536514, 0.043745435774326324, -0.007577784359455109, -0.006353303790092468, -0.01761852391064167, 0.00935503002256155, -0.048307500779628754, -0.026532741263508797, -0.014511841349303722, -0.0309828519821167, -0.029611434787511826, -0.0010084470268338919, 0.0001874985609902069, 0.020921122282743454, 0.01302147377282381, -0.03241024538874626, 0.022222569212317467, -0.04184224456548691, -0.062133632600307465, 0.032102376222610474, -0.02885575406253338, -0.053653232753276825, -0.036916334182024, -0.06263741850852966, -0.0015533408150076866, -0.05675991252064705, -0.04906317964196205, -0.0015148571692407131, 0.045536674559116364, -0.01090137381106615, -0.003690933808684349, -0.017016779631376266, -0.0478317029774189, -0.02450360171496868, 0.025567149743437767, -0.0344533808529377, 0.005779547616839409, 0.0005776923499070108, 0.04209413751959801, -0.006741639226675034, -0.03909940645098686, -0.0025381729938089848, -0.04892323911190033, 0.007822680287063122, -0.005548645276576281, 0.02430768497288227, 0.003946325276046991, 0.021522866562008858, -0.01933979243040085, -0.011678044684231281, 0.007675742730498314, 0.0034810227807611227, -0.00903316680341959, 0.02796013467013836, 0.013035467825829983, -0.0018856998067349195, 0.007297902833670378, 0.009418003261089325, 0.02320215478539467, 0.00915911328047514, -0.02437765523791313, 0.05547245964407921, 0.019773608073592186, 0.018724054098129272, -0.01788441091775894, -0.004138743504881859, 0.046124428510665894, -0.02191470004618168, 0.0016198125667870045, -0.004065274726599455, -0.029023682698607445, 0.04746785759925842, 0.013609224930405617, 0.020599259063601494, -0.005842520855367184, -0.02223656326532364, 0.046964071691036224, -0.0016915322048589587, 0.007262917701154947, -0.020277395844459534, 0.016107164323329926, 0.03688834607601166, 0.018863994628190994, -0.0005055354558862746, 0.04550868645310402, -0.044333186000585556, -0.0542689710855484, -0.0005282758502289653, -0.012188827618956566, 0.06381291896104813, -0.021201003342866898, 0.03543296456336975, -0.07752709835767746, -0.01670890860259533, 0.00951596163213253, 0.009173107333481312, 0.004656523931771517, -0.021900705993175507, 0.006265840958803892, -0.010726448148488998, -0.03839970380067825, -0.024223720654845238, 0.03797988221049309, 0.02185872383415699, -0.00919409841299057, -0.06258144229650497, 0.004523580428212881, -0.03053504228591919, 0.007213938515633345, -0.002092112088575959, -0.019171863794326782, -0.05939079821109772, 0.006878081243485212, 0.020305383950471878, 0.007063502445816994, -0.003092687577009201, 0.04430519789457321, 0.05491269752383232, 0.021103044971823692, 0.06011848896741867, -0.0220546405762434, 0.0049434020183980465, -0.043941352516412735, 0.015547402203083038, -0.046264369040727615, 0.03389361873269081, -0.028491908684372902, 0.043689459562301636, -0.0302271731197834, -0.05393311381340027, -0.005971965845674276, -0.042793840169906616, 0.03347379341721535, 0.023328101262450218, 0.017534559592604637, 0.014567817561328411, -0.010691463015973568, -0.007759707048535347, -0.004303174093365669, -0.013847123831510544, -0.01034860871732235, 0.02204064652323723, -0.0007569912704639137, -0.02167680114507675, -0.02128496766090393, -0.02474150061607361, -0.043437566608190536, 0.05183400213718414, 0.057179734110832214, 0.014889681711792946, 0.015477431938052177, 0.03588077425956726, 0.006647179368883371, 0.004827951081097126, 0.016960803419351578, 0.028561878949403763, 0.0008501392439939082, 0.017072755843400955, 0.02101908065378666, -0.07579183578491211, 0.030563030391931534, -0.024867447093129158, 0.022852301597595215, 0.003012221772223711, -0.0023684948682785034, 0.016932815313339233, 0.008438418619334698, 0.025791054591536522, 0.01340631116181612, 0.027596289291977882, 0.021522866562008858, -0.005314244888722897, -0.00029562454437837005, -0.03375367447733879, -0.014903675764799118, -0.007388864643871784, -0.02693856880068779, 0.036748405545949936, -0.011069302447140217, 0.036608465015888214, 0.00862034223973751, 0.0044815982691943645, -0.07707928866147995, 0.04049881547689438, -0.030395101755857468, 0.01192993763834238, -0.042010173201560974, 0.013910097070038319, 0.043101709336042404, 0.03604870289564133, 0.07310497760772705, -0.02121499739587307, -0.005006375722587109, -0.04598448425531387, -0.058551155030727386, 0.0033428315073251724, 0.009180104359984398, -0.039379287511110306, -0.06280534714460373, 0.02134094387292862, -0.03246622160077095, -0.04827951267361641, 0.0002720095799304545, 0.033445805311203, 0.0018961953464895487, -0.05149814486503601, -0.01960567943751812, -0.03439740464091301, 0.036916334182024, -0.019269822165369987, -0.011076299473643303, -0.03238225728273392, -0.016233110800385475, 0.0034740257542580366, 0.002064123982563615, -0.03431344032287598, 0.025231292471289635, -0.015995211899280548, -0.010642483830451965, 0.04142242297530174, -0.06017446517944336, 0.04268188774585724, 0.00628683203831315, 0.04231804236769676, 0.005345731507986784, 0.026070935651659966, -0.0837404653429985, 0.09426400065422058, -0.014679770916700363, 0.025679102167487144, -0.011419153772294521, 0.004649526905268431, 0.019619673490524292, -0.012902524322271347, 0.003970814868807793, -0.010404584929347038, 0.012153842486441135, 0.013910097070038319, 0.04184224456548691, 0.015785301104187965, 0.012209818698465824, -0.019325798377394676, -0.0673953965306282, 0.0072069414891302586, -0.018808018416166306, -0.03515308350324631, -0.028883742168545723, 0.045088864862918854, -0.015771307051181793, 0.0024524591863155365, -0.01491766981780529, -0.01115326676517725, -0.01652698591351509, 0.00841742753982544, 0.0104745551943779, 0.008655327372252941, 0.08933808654546738, 0.03683236986398697, 0.003904343117028475, 0.008641333319246769, -0.008879232220351696, -0.052617672830820084, -0.024993393570184708, 0.03845568001270294, -0.016806866973638535, 0.04727194085717201, 0.029975280165672302, 0.005888001527637243, -0.011356180533766747, 0.02507735788822174, -0.03607669100165367, 0.02558114379644394, 0.017254678532481194, 0.04525679349899292, -0.007633760571479797, 0.018752042204141617, 0.010922364890575409, 0.01878003031015396, -0.006164384074509144, -0.01838819682598114, 0.03825976327061653, 0.028645843267440796, 0.001339931390248239, 0.0021340944804251194, 0.003362073330208659, -0.004009298514574766, 0.026770640164613724, 0.016149146482348442, 0.004166731610894203, -0.004471102729439735, 0.027302414178848267, -0.019143875688314438, -0.025091351941227913, -0.015659354627132416, -0.007067000959068537, 0.027694247663021088, -0.0014116509119048715, -0.02808608114719391, -0.08094165474176407, -0.004974888637661934, -0.04178626835346222, 0.03137468546628952, -0.027876170352101326, -0.038595620542764664, -0.014287936501204967, -0.02977936342358589, -0.0025836536660790443, 0.015183556824922562, -0.02058526501059532, 0.014903675764799118, 0.016750890761613846, 0.0037154234014451504, -0.018052339553833008, 0.018094321712851524, 0.031598590314388275, 0.008242501877248287, 0.013105439022183418, 0.02551117353141308, -0.05200193077325821, -0.0020728702656924725, 0.01344129629433155, 0.011083296500146389, -0.014196975156664848, 0.020627247169613838, -0.015673348680138588, 0.009348032996058464, 0.040470827370882034, 0.011678044684231281, 0.03213036432862282, -0.030115220695734024, 0.027050521224737167, 0.044445138424634933, 0.0036349573638290167, 0.019143875688314438, -0.027400372549891472, -0.03602071478962898, -0.010313623584806919, 0.0151135865598917, -0.019311804324388504, 0.009005178697407246, 0.0384276919066906, -0.031094804406166077, -0.018863994628190994, 0.025763066485524178, 0.009578934870660305, -0.0017623770982027054, -0.014441871084272861, -0.0005011623143218458, 0.022796325385570526, 0.029611434787511826, 0.003834372851997614, -0.03453734517097473, -0.006619191262871027, -0.002522429684177041, -0.04145041108131409, -0.03171054273843765, 0.004205215256661177, 0.006080419756472111, 0.013707183301448822, -0.018850000575184822, 0.024321679025888443, 0.027232443913817406, -0.027680253610014915, 0.012447717599570751, -0.013434299267828465, -0.011055308394134045, -0.010852394625544548, 0.0050728474743664265, -0.044641055166721344, -0.029275577515363693, -0.01768849417567253, 0.026966556906700134, 0.01388910599052906, -0.005020369775593281, 0.00862034223973751, -0.03926733508706093, 0.0547727569937706, -0.03014320880174637, 0.011817985214293003, 0.0023160171695053577, -0.030059244483709335, -0.0007053881417959929, -0.018877988681197166, -0.012083872221410275, -0.017254678532481194, -0.0604543462395668, -0.026070935651659966, 0.0067346422001719475, -0.07047409564256668, 0.03162657842040062, -0.029975280165672302, 0.007927635684609413, -0.026126913726329803, -0.009704881347715855, -0.013987064361572266, 0.008263492956757545, 0.025301262736320496, -0.014078025706112385, -0.05258968472480774, -0.042457982897758484, 0.023817893117666245, -0.023426059633493423, -0.004813957028090954, 0.006097912322729826, 0.01922784000635147, -0.006605197209864855, -0.0017177710542455316, 0.03512509539723396, 0.004611043259501457, 0.011195248924195766, -0.006647179368883371, 0.06157387048006058, 0.02366395853459835, 0.01295150350779295, -0.0535132922232151, 0.03560089319944382, -0.012314774096012115, -0.008060579188168049, 0.014595805667340755, -0.015015628188848495, -0.02288028970360756, -0.030646994709968567, -0.0349571667611599, 0.013252376578748226, 0.03775597736239433, 0.026070935651659966, -0.020081479102373123, -0.010859391652047634, -0.01883600652217865, -0.017506571486592293, -0.01198591385036707, -0.017394619062542915, -0.014931663870811462, -0.04094662517309189, -0.012895527295768261, 0.0344533808529377, 0.03008723258972168, -0.0010976592311635613, 0.013105439022183418, -0.0002322139625903219, 0.0307309590280056, 0.0314866378903389, 0.0023894859477877617, 0.028128063306212425, -0.02397182770073414, 0.00836145132780075, 0.003991805948317051, -0.030507054179906845, -0.009306050837039948, 0.000854512385558337, 0.031038828194141388, -0.03915538266301155, 0.019773608073592186, -0.07092190533876419, -0.027918152511119843, -0.013091444969177246, -0.0071999444626271725, 0.02570709027349949, -0.009431997314095497, 0.007067000959068537, -0.04545271024107933, 0.013147421181201935, -0.0059019955806434155, -0.0017081501428037882, -0.013616221956908703, -0.02616889588534832, 0.016610950231552124, -0.005713075399398804, 0.041562363505363464, -0.022740349173545837, -0.045676615089178085, -0.005349230021238327, -0.013049461878836155, -0.02989131584763527, -0.017660506069660187, -0.028771789744496346, -0.0073328884318470955, -0.02430768497288227, 0.0309828519821167, 0.04917513206601143, -0.01987156644463539, -0.004026791080832481, -0.005265265703201294, -0.024545583873987198, 0.0055416482500731945, -0.02719046175479889, 0.01484769955277443, 0.002048380672931671, -0.0004897921462543309, 0.00025254907086491585, -0.029499482363462448, -0.03490119054913521, 0.029919303953647614, -0.02012346126139164, -0.004621538799256086, 0.02958344668149948, 0.021005086600780487, -0.00449909083545208, 0.013259373605251312, 0.021620824933052063, 0.049538977444171906, 0.022642390802502632, 0.01041857898235321, 0.01083140354603529, -0.0049434020183980465, 0.0009620917262509465, 0.013504269532859325, -0.036944322288036346, -0.010887379758059978, -0.0483354888856411, -0.005132322199642658, -0.01729666069149971, -0.03932331129908562, 0.010873385705053806, 0.032102376222610474, -0.004953897558152676, -0.023510023951530457, -0.004212212283164263, 0.019115887582302094, 0.011594080366194248, -0.0451168529689312, -0.011971919797360897, 0.013231385499238968, 0.01057951059192419, 0.013791147619485855, 0.03450935706496239, -0.018430178984999657, 0.016471009701490402, -0.020865146070718765, -0.011076299473643303, 0.005552143789827824, -0.010747439227998257, -0.0014623794704675674, 0.04839146509766579, 0.019017929211258888, 0.013868114911019802, 0.01122323703020811, -0.0012830805499106646, 0.01619112864136696, 0.020291389897465706, -0.007227932568639517, -0.006790618412196636, -0.014343912713229656, -0.010782424360513687, 0.042849816381931305, 0.03554491698741913, -0.05144216865301132, 0.003774898126721382, 0.006857090163975954, 0.0040337881073355675, 0.06700356304645538, 0.006696158554404974, -0.016694914549589157, 0.014819711446762085, -0.02223656326532364, -0.0110273202881217, 0.0031469145324081182, -0.003132920479401946, 0.006636683829128742, -0.029975280165672302, -0.0016364306211471558, -0.012062881141901016, -0.014252951368689537, -0.005632609594613314, -0.003314843401312828, -0.008151540532708168, 0.022488456219434738, -0.01824825629591942, -0.09129725396633148, -0.03182249516248703, 0.001960917841643095, 0.006342808250337839, 0.01099233515560627, 0.01889198273420334, -0.005611618515104055, 0.004569061100482941, -0.014707759022712708, -0.029947292059659958, 0.0053877136670053005, -0.013539254665374756, 0.02121499739587307, -0.023775910958647728, -0.01613515242934227, -0.042849816381931305, -0.0027848181780427694, -0.007752710022032261, 0.024125762283802032, -0.007437843829393387, -0.01999751478433609, 0.008669321425259113, 0.012720601633191109, 0.026952562853693962, -0.014889681711792946, -0.02885575406253338, -0.009732869453728199, 0.000825212337076664, 0.02334209531545639, 0.009334038943052292, -0.015827283263206482, -0.026840610429644585, 0.013161415234208107, 0.031038828194141388, -0.022600408643484116, 0.007885653525590897, -0.024195732548832893, 0.0059789628721773624, 0.03954721614718437, -0.012496696785092354, 0.00575505755841732, -0.03515308350324631, -0.0012279788497835398, 0.014036043547093868, 0.027050521224737167, -0.016163140535354614, 0.04688010737299919, 0.017632517963647842, -0.0037189219146966934, -0.017016779631376266, 0.020487306639552116, 0.012132851406931877, -0.009166110306978226, 0.004502589348703623, 0.003855363931506872, 0.009935783222317696, 0.009578934870660305, -0.021452896296977997, -0.016359057277441025, 0.018164291977882385, 0.006195870693773031, 0.021382926031947136, -0.02262839674949646, -0.011685041710734367, -0.04226206615567207, -0.02405579201877117, -0.005800538696348667, 0.0156173724681139, 0.024545583873987198, -0.06862688064575195, -0.0438573881983757, 0.04217810183763504, -0.02037535421550274, -0.012398738414049149, 0.008767279796302319, 0.0029072663746774197, 0.0020868643186986446, 0.023999815806746483, -0.05838322266936302, 0.01144014485180378, 0.018696065992116928, -0.02115902118384838, -0.001745759160257876, -0.01369318924844265, 0.009669896215200424, 0.022334521636366844, 0.03702828660607338, -0.03523704782128334, -0.00976785458624363, 0.04256993532180786, 0.052309803664684296, -0.01658296212553978, 0.0008645706111565232, -0.014343912713229656, 0.0304790660738945, 0.01074044220149517, 0.018052339553833008, 0.008340460248291492, -0.029807351529598236, 0.011915943585336208, 0.045732591301202774, -0.0027813196647912264, 0.008074573241174221, -0.0837404653429985, 0.008697309531271458, -0.01844417303800583, 0.011706032790243626, -0.00967689324170351, 0.03266213834285736, -0.016289087012410164, -0.0003583791549317539, 0.001460630213841796, 0.01973162591457367, 0.0629732757806778, -0.0007714226376265287, 0.03901544213294983, 0.027288420125842094, -0.007976614870131016, 0.0220546405762434, -0.0232861191034317, -0.010768430307507515, 0.015771307051181793, -0.02398582175374031, -0.01234276220202446, -0.008403433486819267, -0.009760857559740543, 0.012748589739203453, 0.03403355926275253, 0.013588233850896358, 0.02366395853459835, -0.02450360171496868, 0.03884751349687576, 0.007262917701154947, 0.021508872509002686, 0.0044046309776604176, -0.036804381757974625, 0.0009402260184288025, -0.031066816300153732, 0.009697884321212769, 0.007507814094424248, 0.017464589327573776, 0.017338642850518227, 0.04326963797211647, -0.011006329208612442, -0.01742260716855526, -0.02050130069255829, 0.030171196907758713, -0.014399888925254345, 0.01009671576321125, -0.02860386110842228, 0.0024052292574197054, -0.04480898380279541, 0.002924758940935135, 0.0037853936664760113, 0.019591685384511948, 0.0004154487105552107, -0.019899554550647736, -0.01729666069149971, 0.028575873002409935, 0.05771150812506676, 0.02418173849582672, 0.009970768354833126, -0.02797412872314453, -0.009725872427225113, 0.030758947134017944, 0.0015069855144247413, -0.002800561487674713, -0.008186525665223598, -0.010138697922229767, 0.052365779876708984, -0.013903100043535233, -0.02552516758441925, 0.031150780618190765, 0.03459332138299942, 0.032438233494758606, 0.03280207887291908, 0.003012221772223711, -0.03126273304224014, 0.02854788489639759, -0.005419200286269188, 0.002286279806867242, 0.007787695154547691, -0.012440720573067665, -0.004460607189685106, 0.016485003754496574, 0.00992878619581461, 0.02726043201982975, 0.00021909452334512025, 0.024461619555950165, 0.021704789251089096, 0.006696158554404974, 0.02905167080461979, -0.01985757239162922, -0.0001422365166945383, 0.017954381182789803, -0.021228991448879242, -0.014609800651669502, 0.038987454026937485, -0.013770156539976597, 0.031654566526412964, -0.008956199511885643, 0.02006748504936695, -0.005454185418784618, -0.009075148962438107, -0.01317540928721428, 0.02051529474556446, -0.0206972174346447, -0.007014523260295391, -0.0056396066211164, 0.04391336441040039, 0.0006594701553694904, 0.010404584929347038, -0.016610950231552124, 0.013833129778504372, -0.029471494257450104, -0.02602895349264145, 0.02958344668149948, 0.0017606278415769339, -0.03576882183551788, -0.02733040228486061, -0.02262839674949646, -0.0020798672921955585, -0.02493741735816002, 0.020095473155379295, -0.02437765523791313, -0.00836145132780075, 0.014483853243291378, -0.020081479102373123, -0.0034337928518652916, 0.013000482693314552, -0.011552098207175732, 0.02681262232363224, -0.018276244401931763, -0.016694914549589157, -0.03887550160288811, -0.016443021595478058, -0.01799636334180832, -0.021494878455996513, -0.011363177560269833, -0.01620512269437313, 0.027918152511119843, 0.011580086313188076, 0.011335189454257488, -0.0026151402853429317, -0.019297810271382332, -0.004611043259501457, 0.0011186503106728196, 0.044613067060709, -0.03257817402482033, 0.006699657067656517, -0.0029195111710578203, -0.02854788489639759, 0.018178286030888557, -0.021746771410107613, 0.02359398826956749, -0.011370174586772919, 0.024265702813863754, 0.0465722382068634, 0.03129072114825249, 0.01311943307518959, -0.02527327463030815, -0.0011571339564397931, 0.0022373006213456392, -0.005198793951421976, -1.4117055798124056e-05, -0.010754436254501343, 0.003038460621610284, 0.008235504850745201, 0.026182889938354492, 0.018234262242913246, -0.011580086313188076, 0.024601560086011887, 0.002525928197428584, 0.03926733508706093, -0.02602895349264145, 0.012356756255030632, 0.012272791936993599, -0.0002958432014565915, 0.012447717599570751, -0.0031469145324081182, -0.026630699634552002, -0.011971919797360897, 0.005489170551300049, 0.0034075540024787188, -0.01645701564848423, -0.026378806680440903, -0.033389829099178314, -0.013560245744884014, 0.029527470469474792, -0.014833705499768257, 0.004198218230158091, 0.0572357103228569, 0.022964254021644592, 0.01153810415416956, 0.01960567943751812, 0.0015139825409278274, -0.0027550808154046535, -0.010180680081248283, 0.016303081065416336, -0.040162958204746246, 0.024671530351042747, 0.01574331894516945, 0.03067498281598091, 0.013707183301448822, 0.008879232220351696, 0.020487306639552116, 0.012069878168404102, -0.0104745551943779, -0.022978248074650764, 0.011887955479323864, 0.00645825918763876, 0.03327787667512894, 0.013343337923288345, 0.007241926621645689, 0.0036349573638290167, -0.01479172334074974, -0.0069095678627491, -0.04450111463665962, 0.0011632563546299934, -0.028365962207317352, -0.0020973598584532738, 0.004142242018133402, -0.008046585135161877, -0.018822012469172478, 0.0189619529992342, -0.05569636449217796, -0.006013948004692793, 0.0004392823320813477, 0.009774851612746716, 0.022026652470231056, 0.021522866562008858, 0.011321195401251316, 0.0009174856822937727, 0.020753193646669388, -0.03143066167831421, -0.004590052179992199, 0.004198218230158091, -0.013882108964025974, 0.009704881347715855, 0.014399888925254345, 0.013091444969177246, 0.027694247663021088, 0.004639031365513802, -0.030059244483709335, -0.012832554057240486, 0.017982369288802147, -0.013644210062921047, 0.018626095727086067, 0.0010136947967112064, 0.001190369832329452, 0.07008226215839386, -0.00813054945319891, -0.0014728750102221966, -0.013770156539976597, -0.03196243569254875, 0.03246622160077095, 0.00855037197470665, 0.021900705993175507, -0.03946325182914734, 0.02861785516142845, -0.018024351447820663, 0.019143875688314438, 0.005247773136943579, 0.03537698835134506, -0.003974313382059336, -0.011671047657728195, 0.010768430307507515, 0.03632858395576477, 0.020165443420410156, -0.004541072994470596, 0.023621976375579834, -0.008991184644401073, -0.015841277316212654, -0.02346804179251194, -0.036552488803863525, -0.02314617857336998, -0.023314107209444046, 0.036748405545949936, 0.036748405545949936, 0.037504084408283234, 0.005604621488600969, -0.026518747210502625, -0.010614495724439621, -0.017534559592604637, 0.03322190046310425, 0.019759614020586014, -0.00906815193593502, 0.019759614020586014, 0.033585745841264725, -0.009501967579126358, 0.0047859689220786095, 0.02244647406041622, -0.00820051971822977, -0.009886804036796093, -0.03092687577009201, -0.02064124122262001, 0.0069655440747737885, -0.0012410982744768262, 0.009166110306978226, 0.01115326676517725, 0.012608649209141731, -0.009536952711641788, 0.027568301185965538, 0.004079268779605627, 0.033389829099178314, -0.0125736640766263, -0.013504269532859325, 0.0339495949447155, 0.00010101962834596634, 0.0024314681068062782, -0.04094662517309189, -0.036944322288036346, -0.01724068447947502, 0.01504361629486084, 0.003981310408562422, -0.01349727250635624, -0.014043040573596954, 0.02635081857442856, 0.0009367275051772594, -0.014357906766235828, -0.0028425436466932297, -0.0016189379384741187, -0.01966165564954281, -0.00412824796512723, -0.00353524973616004, 0.007220935542136431, -0.004387138411402702, 0.028827765956521034, 0.027428360655903816, 0.034369416534900665, -0.005853016395121813, -0.011880958452820778, -0.008788270875811577, -0.0033865629229694605, -0.005359725560992956, 0.01992754265666008, 0.036608465015888214, -0.0031818996649235487, -0.01192993763834238, 0.007983611896634102, -0.014833705499768257, 0.024545583873987198, 0.026728658005595207, 0.0017553800716996193, -0.02352401800453663, -0.0237899050116539, 0.010929361917078495, -0.008571363054215908, 0.0014326419914141297, 0.0005825028056278825, -0.033585745841264725, -0.012671622447669506, -0.002709600143134594, -0.007696733810007572, 0.007311897352337837, 0.0011510115582495928, -0.022978248074650764, -0.02661670558154583, 0.011069302447140217, 0.0314866378903389, 0.015351485460996628, -0.017408613115549088, 0.002713098656386137, 0.011412156745791435, -0.010964347049593925, 0.009494970552623272, -0.020109467208385468, -0.0041177524253726006, -0.0173526369035244, -0.006381291896104813, 0.009397012181580067, 0.019955530762672424, 0.005947476252913475, 0.010859391652047634, 0.004705503117293119, 0.006930558942258358, -0.011664050631225109, -0.011657053604722023, -0.005062351934611797, -0.021452896296977997, 0.0003739038365893066, -0.00018465601897332817, 0.007920638658106327, 0.025567149743437767, 0.003564987098798156, 0.01908789947628975, -0.0009699633810669184, -0.02983533963561058, -0.010299629531800747, 0.003690933808684349, -0.00601044949144125, 0.002183073665946722, 0.0012612148420885205, -0.0059089926071465015, -0.018696065992116928, -0.013063456863164902, -0.005790043156594038, 0.0056990813463926315, 0.021774759516119957, -0.008088567294180393, -0.02436366118490696, -0.00408276729285717, -0.0037399129942059517, 0.025986971333622932, -0.002267037983983755, 0.025413215160369873, -0.023048220202326775, -0.016568968072533607, 0.026532741263508797, 0.03316592425107956, 0.02810007520020008, 0.0007451837882399559, 0.002223306568339467, 0.013322346843779087, 0.04584454372525215, -0.036356572061777115, 0.006066425703465939, 0.014308927580714226, 0.011461135931313038, -0.016624944284558296, -0.0017754965228959918, 0.04494892433285713, 0.011454138904809952, -0.010460561141371727, -0.009753860533237457, -0.0010320619912818074, -0.014959651976823807, 0.03372568637132645, -0.01057951059192419, -0.0045515685342252254, -0.004198218230158091, -0.004264690447598696, 0.009522958658635616, 0.03033912554383278, -0.023566000163555145, -0.014665776863694191, -0.0005015996284782887, 0.005912491120398045, -0.0052337790839374065, -0.01645701564848423, 0.019969524815678596, 0.0008999930578283966, 0.029107647016644478, 0.0005671968101523817, 0.03568485751748085, 0.01063548680394888, 0.021830735728144646, 0.06913066655397415, 0.005989458411931992, 0.0223065335303545, -0.005275761242955923, 0.013504269532859325, -0.014959651976823807, -0.01742260716855526, 0.013014476746320724, 0.048307500779628754, 0.02847791463136673, 0.008053582161664963, 0.00894220545887947, -0.020543282851576805, 0.007416852749884129, 0.003928832709789276, 0.017310654744505882, 0.043549519032239914, -0.0037259189411997795, 0.0038798535242676735, -0.013630216009914875, -0.02507735788822174, -0.02128496766090393, -0.020347366109490395, 0.022992242127656937, 0.02373392879962921, 0.025609131902456284, -0.002041383646428585, 0.009949777275323868, -0.02166280709207058, 0.02327212505042553, 0.002735838992521167, 0.0021148526575416327, -0.008669321425259113, -0.03523704782128334, 0.024139756336808205, 0.002709600143134594, -0.005482173524796963, -0.0028652839828282595, -0.008424424566328526, -0.005566137842833996, -0.018989941105246544, 0.0036349573638290167, 0.021578842774033546, -0.0029772366397082806, -0.011552098207175732, 0.004184224177151918, -0.005051856394857168, 0.014735747128725052, 0.039827097207307816, -0.00013239694817457348, -0.032690126448869705, 0.0072769117541611195, 0.001792989089153707, -0.03895946592092514, 0.013609224930405617, -0.014525835402309895, -0.011664050631225109, 0.007500817067921162, -0.05225382745265961, 9.850507194641978e-05, -0.004548070020973682, 0.0022950260899960995, 0.018724054098129272, -0.023887863382697105, -0.0009445991599932313, 0.023300113156437874, 0.004429120570421219, 0.026588717475533485, 0.016345063224434853, -0.029667410999536514, 0.033333852887153625, -0.008774276822805405, -0.013616221956908703, 0.00011862153769470751, -0.006454760674387217, -0.016177134588360786, -0.01122323703020811, 0.010628489777445793, 0.016596956178545952, 0.017856422811746597, -0.011055308394134045, 0.0014991138596087694, -0.01947973296046257, 0.029135635122656822, 0.00028163049137219787, -0.0033970584627240896, -0.005373719613999128, 0.005163808818906546, 0.032438233494758606, -0.013308352790772915, 0.0034040554892271757, -0.005779547616839409, 0.02223656326532364, 0.015855271369218826, -0.0010897875763475895, 0.03758804872632027, -0.02121499739587307, -0.02963942289352417, 0.009900798089802265, 0.006248348392546177, 0.016764884814620018, -0.006283333525061607, -0.008123552426695824, 0.004177227150648832, -0.013028470799326897, -0.010215665213763714, 0.01761852391064167, 0.010838400572538376, 0.025315256789326668, 0.005069348961114883, 0.046908095479011536, -0.0171007439494133, 0.02661670558154583, -0.013189403340220451, -0.003048956161364913, -0.020431330427527428, -0.006419775541871786, -0.023356089368462563, 0.011034317314624786, 0.012300780043005943, 0.043689459562301636, -0.017520565539598465, 0.04576057940721512, -0.005891500040888786, -0.0005295877926982939, -0.0014728750102221966, -0.02212461084127426, 0.027624277397990227, -0.004044283647090197, -0.01857011951506138, -0.03126273304224014, 0.03173853084445, 0.01865408383309841, 0.018933964893221855, 0.0017151471693068743, 0.010838400572538376, -0.03190645948052406, 0.0003325776197016239, 0.01987156644463539, 0.003683936782181263, 0.019759614020586014, 0.03652450069785118, -0.029471494257450104, -0.03330586478114128, -0.012461711652576923, 0.006531728431582451, -0.03512509539723396, -0.029919303953647614, 0.01717071421444416, -0.023552006110548973, 0.008207516744732857, -0.02719046175479889, 0.009166110306978226, 0.018402190878987312, 0.04615241661667824, -0.016037194058299065, 0.04976288229227066, 0.05091039463877678, 0.00013316224794834852, 0.012972494587302208, -0.00241047702729702, -0.0007618017261847854, -0.007325891405344009, -0.03400557115674019, 0.001168504124507308, 0.020599259063601494, 0.0022005662322044373, 0.013413308188319206, -0.014889681711792946, -0.023328101262450218, -0.02076718769967556, -0.004803461488336325, -0.03954721614718437, -0.010250650346279144, 0.0314866378903389, 0.011908946558833122, 0.026014959439635277, -0.007577784359455109, -0.007857665419578552, -0.01799636334180832, 0.0009061154560185969, 0.001037309761159122, -0.005212788004428148, 0.05035063251852989, -0.004604046232998371, -0.002870531752705574, -0.010194674134254456, -0.026588717475533485, 0.0008348332485184073, 0.007500817067921162, 0.002263539470732212, 0.017772458493709564]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
"2) utilizes approximate second-
order information to quantize model weights both accurately
and efficiently. SqueezeLLM (Kim et al., 2023) adopts the
concept of sensitivity-based non-uniform quantization along
with Dense-and-Sparse decomposition. This line of work is
orthogonal to ours, as they can be combined together.
SmoothQuant (Xiao et al., 2023a) is a post-training quan-
tization method that is more closely related to our work.
This method uses equivalent transformations to balance
the quantization complexity for both activation and weight,
making the activation easier to quantize. SmoothQuant can
compress KV cache to 8bit with minor performance loss.However, it faces a significant accuracy drop when scaled
down to 4bit or less.
vLLM (Kwon et al., 2023b) and S3 (Jin et al., 2023) are
system-level works, which include memory management
through the use of PagedAttention or memory usage predic-
tion. These approaches can lower the memory requirements
of KV cache and simultaneously increase model throughput.
This research direction is orthogonal to our work, as such
system-level optimizations can also be applied to enhance
our algorithm.
Several other works also consider compressing KV cache
by evicting unimportant tokens. H2O (Zhang et al., 2023)
retains only a small portion of tokens that contribute signifi-
cantly to the attention scores. StreamingLLM (Xiao et al.,
2023b) is based on the observation of “attention sink” and
maintains only a few initial tokens to preserve performance.
Unlike these works, our KIVI retains all input tokens and
compresses them into lower precision. This line of work is
orthogonal to ours, as they also can be combined together.
6. Conclusion and Future Work
In this paper, we systematically analyze KV cache element
distribution in popular LLMs. We conclude that key cache
should be quantized per-channel and value cache should
be quantized per token. Based on these observations, we
propose KIVI , a plug-and-play 2bit KV cache quantization
algorithm without the need for any tuning. In real LLM
workload, KIVI allows up to 4×larger batch sizes and
3.47×throughput. In the future, we will further optimize
the implementation to reduce the overhead of quantization
process during the prefill and decoding phase.
8
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
7. Impact Statements
This paper presents work whose goal is to advance the field
of Machine Learning. There are many potential societal
consequences of our work, none which we feel must be
specifically highlighted here.
References
ShareGPT Team. https://sharegpt.com/ , 2023.
Joshua Ainslie, James Lee-Thorp, Michiel de Jong, Yury
Zemlyanskiy, Federico Lebrón, and Sumit Sanghai.
Gqa: Training generalized multi-query transformer
models from multi-head checkpoints. arXiv preprint
arXiv:2305.13245 , 2023.
Yushi Bai, Xin Lv, Jiajie Zhang, Hongchang Lyu, Jiankai
Tang, Zhidian Huang, Zhengxiao Du, Xiao Liu, Aohan
Zeng, Lei Hou, Yuxiao Dong, Jie Tang, and Juanzi Li.
Longbench: A bilingual, multitask benchmark for long
context understanding. arXiv preprint arXiv:2308.14508 ,
2023.
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah,
Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan,
Pranav Shyam, Girish Sastry, Amanda Askell, et al. Lan-
guage models are few-shot learners. Advances in neural
information processing systems , 33:1877–1901, 2020.
Yu-Neng Chuang, Ruixiang Tang, Xiaoqian Jiang, and Xia
Hu. Spec: A soft prompt-based calibration on mitigating
performance variability in clinical notes summarization.
arXiv preprint arXiv:2303.13035 , 2023.
Tim Dettmers, Mike Lewis, Younes Belkada, and Luke
Zettlemoyer. Llm. int8 (): 8-bit matrix multiplication for
transformers at scale. arXiv preprint arXiv:2208.07339 ,
2022.
Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan
Alistarh","[-0.011841366067528725, 0.02941378578543663, -6.556954758707434e-05, -0.02406199276447296, -0.00655629625543952, -0.00410163588821888, 0.01671557128429413, 0.03452678397297859, -0.03536958619952202, -0.002103493083268404, 0.03640903905034065, 0.02621113881468773, -0.055175427347421646, 0.040875889360904694, -0.009467474184930325, -0.0110828448086977, 0.020985767245292664, -0.033655889332294464, -0.012670121155679226, 0.005134067963808775, -0.033318765461444855, -0.026126857846975327, 0.01642058975994587, 0.015479461289942265, 0.04008927568793297, -0.06101885437965393, -0.01140591874718666, -0.015451367944478989, 0.0189911350607872, -0.06669372320175171, 0.027391061186790466, -0.024188414216041565, -0.045342739671468735, -0.059895120561122894, -0.012255744077265263, 0.03570670634508133, 0.015001873485744, 0.00854039192199707, -0.026435885578393936, 0.006823183503001928, 0.03601573407649994, -0.051663756370544434, -0.03379635512828827, 0.0075852167792618275, 0.022980397567152977, 0.031239856034517288, 0.021716194227337837, -0.010471813380718231, -0.06377200782299042, 0.03343114256858826, -0.003957657143473625, 0.03548195958137512, -0.05270320922136307, -0.018583782017230988, 0.004572200123220682, -0.001294929999858141, 0.014355725608766079, -0.002637267578393221, 0.02748938836157322, -0.0007150646997615695, 0.01518448069691658, -0.05950181186199188, 0.0029656090773642063, 0.005190254654735327, -0.037785615772008896, 0.0062613156624138355, -0.024258647114038467, 0.010282183066010475, 0.011932670138776302, -0.017193157225847244, -0.0018383616115897894, 0.03694281354546547, 0.02312086522579193, -0.00562219088897109, -0.0067529501393437386, 0.006893416866660118, -0.019833937287330627, 0.03978024795651436, 0.019047321751713753, -0.007493913173675537, -0.0020455503836274147, -0.0005741587956435978, 0.015353040769696236, -0.027433201670646667, -0.00821731798350811, -0.017136970534920692, -0.024722188711166382, 0.01262095756828785, -0.05087713897228241, -0.008371831849217415, -0.03261643275618553, 0.0221516415476799, -0.04888250678777695, 0.015943001955747604, 0.060513172298669815, 0.009734361432492733, 0.051354728639125824, -0.019679423421621323, 0.008329691365361214, 0.016645336523652077, -0.011658758856356144, 0.021238606423139572, 0.05542827025055885, -0.04989387094974518, 0.046944063156843185, -0.01925802230834961, -0.013428643345832825, -0.0004964629770256579, -0.008575509302318096, -0.0020350152626633644, -0.09034836292266846, 0.003992774058133364, -0.04840492084622383, 0.03753277659416199, -0.018738294020295143, -0.04607316851615906, -0.06680609285831451, -0.0110407043248415, -0.02372487261891365, -0.008435041643679142, -0.03225121647119522, -0.006127872038632631, 0.024848608300089836, -0.018569733947515488, 0.014180141501128674, -0.033936820924282074, 0.039724063128232956, -0.048826321959495544, -0.01996035687625408, -0.0035555704962462187, 0.019735610112547874, 0.015633974224328995, 0.06590710580348969, -0.0008147084736265242, -0.0007879319600760937, -0.028851917013525963, -0.02466600202023983, 0.03885316476225853, -0.04129729047417641, -0.0036977932322770357, 0.014397865161299706, -0.012979148887097836, -0.012915939092636108, 0.006531714461743832, -0.029498064890503883, 0.0072691659443080425, -0.022193782031536102, 0.009692221879959106, -0.012115276418626308, 0.007845080457627773, -0.010970471426844597, -0.02122456021606922, -0.019819891080260277, -0.011335684917867184, -0.054529279470443726, -0.033993009477853775, 0.0075571234337985516, 0.037111375480890274, 0.030874641612172127, -0.028233863413333893, 0.005214836448431015, 0.04273005574941635, 0.03764514997601509, -0.004340429790318012, 0.010710607282817364, 0.0073534464463591576, -0.058939944952726364, -0.0019524910021573305, -0.057310525327920914, -0.04480896517634392, -0.00018524083134252578, -0.029132850468158722, -0.011771133169531822, -0.024848608300089836, -0.011813272722065449, -0.02181452140212059, -0.027601761743426323, -0.02407604083418846, -0.023893432691693306, -0.025424523279070854, -0.03831939026713371, 0.045061808079481125, -0.013843020424246788, 0.04671931639313698, -0.04034211486577988, -0.022657323628664017, -0.005780216306447983, 0.014334655366837978, -0.008926676586270332, 0.05747908726334572, -0.0189911350607872, 0.03767324239015579, 0.06826695054769516, 0.04138157144188881, 0.02778436802327633, -0.006770508363842964, 0.009994225576519966, 0.015353040769696236, -0.007690567057579756, -0.02594425156712532, -0.004126217681914568, 0.032026469707489014, 0.016013234853744507, -0.0819765254855156, 0.024483393877744675, -0.022601136937737465, -0.028304096311330795, -0.0019121067598462105, -0.061187416315078735, -0.014734986238181591, 0.02052222564816475, 0.0601198673248291, 0.057057686150074005, 0.008947746828198433, -0.007620333693921566, 0.025719502940773964, -0.028851917013525963, 0.019721563905477524, -0.019482769072055817, 0.03612810745835304, 0.00766247371211648, 0.001956002553924918, 0.008744069375097752, 0.023261331021785736, -0.045342739671468735, 0.006724856793880463, -0.02175833471119404, -0.031436510384082794, 0.044387564063072205, -0.02659039944410324, 0.05596204474568367, -0.012775471433997154, -0.028514796867966652, -0.02372487261891365, -0.011651735752820969, -0.04778686538338661, -0.004066518973559141, -0.021027905866503716, -0.012087183073163033, -0.033627793192863464, 0.008140061050653458, -0.002138609765097499, -0.004080565646290779, -0.0158306285738945, -0.00882834941148758, 0.029469972476363182, -0.04368523135781288, -0.052590835839509964, 0.04927581548690796, -0.025382382795214653, -0.0316050685942173, -0.03317829966545105, -0.05096141993999481, -0.011567455716431141, -0.03944312781095505, -0.02376701310276985, 0.031155575066804886, 0.01963728293776512, -0.003357160836458206, 0.04677550494670868, -0.021379074081778526, -0.04905106872320175, -0.013871113769710064, -0.010584186762571335, -0.022868024185299873, 0.00805578101426363, -0.015619928017258644, 0.04244912043213844, -0.018176427111029625, -0.025396429002285004, -0.002867282135412097, -0.03666188195347786, -0.0033343348186463118, -0.013049382716417313, -0.01107582077383995, 0.0035380120389163494, 0.0205081794410944, -0.01091428380459547, -0.0205784123390913, 0.03815083205699921, -0.0010122401872649789, -0.007767823990434408, 0.0474497452378273, 0.003971703816205263, 0.007479866500943899, 0.006802113261073828, -0.014524285681545734, 0.010689537040889263, -0.021912848576903343, -0.003109587822109461, 0.042786240577697754, -0.0053728618659079075, -0.0012677144259214401, -0.023134911432862282, 0.00852634571492672, 0.02938569150865078, -0.01533899363130331, -0.019201835617423058, 0.004038425628095865, -0.015943001955747604, 0.05955800041556358, 0.02786864899098873, -0.0020929579623043537, -0.012979148887097836, -0.0348358117043972, 0.04464040696620941, 0.01229788362979889, 0.01930016279220581, -0.015072106383740902, 0.017277438193559647, 0.02746129408478737, -0.004895274061709642, -0.007655450142920017, 0.03382444754242897, -0.0630977675318718, -0.05402360111474991, -0.0025003121700137854, -0.005502793937921524, 0.03708328306674957, -0.01057716365903616, 0.0379822701215744, -0.07512173801660538, 0.0015547939110547304, -0.019033275544643402, 0.029891373589634895, 0.00561165576800704, -0.030172307044267654, -0.022924210876226425, -0.02025533840060234, -0.03595954552292824, 0.02022724412381649, 0.029301412403583527, 0.021730242297053337, -0.01991821825504303, -0.05216943472623825, -0.024441253393888474, -0.009909945540130138, 0.018106194213032722, 0.0057837278582155704, -0.004491431638598442, -0.07753777503967285, 0.0007734462851658463, 0.0006659012869931757, -0.010731677524745464, 0.005896101240068674, 0.035566240549087524, 0.05554064363241196, 0.024104133248329163, 0.05402360111474991, -0.013548039831221104, -0.004477384965866804, -0.050090525299310684, 0.03371207416057587, -0.05503496155142784, 0.03244787082076073, 0.0063701774924993515, 0.018274754285812378, -0.0379822701215744, -0.021744288504123688, 0.010485859587788582, -0.014383818954229355, 0.021575728431344032, 0.036465227603912354, 0.008793232962489128, -0.012276814319193363, -0.018443314358592033, -0.007543076761066914, -0.017811212688684464, 0.00775377731770277, 0.0018963041948154569, 0.03534149006009102, 0.016350356861948967, -0.001827826607041061, -0.03893744572997093, -0.032026469707489014, -0.001179922604933381, 0.04017355665564537, 0.04711262509226799, 0.02750343456864357, 0.020789112895727158, 0.03978024795651436, 0.031661257147789, 0.018415220081806183, -0.005846938118338585, 0.024132227525115013, 0.01577444188296795, 0.0006167378160171211, -0.005868007894605398, -0.05000624433159828, 0.024483393877744675, -0.027039892971515656, 0.010837027803063393, -0.018148332834243774, 0.015493507497012615, 0.013372456654906273, 0.015142340213060379, 0.014917593449354172, -0.001497729099355638, 0.05225371569395065, 0.021969035267829895, 0.0006079586455598474, 0.009025003761053085, -0.029132850468158722, 0.01199587993323803, 0.00383123685605824, -0.003743445035070181, 0.044387564063072205, 0.012227650731801987, 0.02501716837286949, 0.014215257950127125, 0.009305937215685844, -0.06191784515976906, 0.02181452140212059, -0.0505681112408638, 0.016280122101306915, -0.04081970453262329, 0.03281308710575104, 0.029329504817724228, 0.049219630658626556, 0.082088902592659, -0.017923586070537567, 0.011174147948622704, -0.05472593382000923, -0.07691971957683563, 0.000863871886394918, 0.0007848592358641326, -0.016209889203310013, -0.07843676209449768, 0.022643277421593666, -0.05938943848013878, -0.05983893200755119, -0.014306562021374702, -0.0036345829721540213, -0.03593145310878754, -0.015676114708185196, -0.018401173874735832, -0.02838837541639805, 0.035257212817668915, 0.01359720341861248, -0.0380103625357151, -0.033374954015016556, -0.01501591969281435, -0.02335965819656849, -0.0016144923865795135, -0.03213884308934212, 0.014362748712301254, -0.009488544426858425, -0.006517667789012194, 0.05528780072927475, -0.04553939402103424, 0.04340429604053497, 0.0007251607603393495, 0.06579473614692688, -0.0031394369434565306, 0.008182201534509659, -0.08478587120771408, 0.09585466235876083, -0.04045448824763298, 0.028669310733675957, -0.020732926204800606, 0.0046635037288069725, 0.021631915122270584, -0.030481334775686264, -0.004203474149107933, 0.031043201684951782, 0.02087339386343956, 0.0058785430155694485, 0.020142965018749237, 0.025157636031508446, 0.015521600842475891, -0.012908915057778358, -0.05899612978100777, -0.021280746906995773, 0.008231365121901035, -0.036240480840206146, -0.013955394737422466, 0.011026658117771149, -0.023163003847002983, 0.005808309651911259, -0.03666188195347786, 0.02088744007050991, -0.05416406691074371, -0.011785179376602173, -0.006535226013511419, 0.02469409443438053, 0.056102510541677475, 0.02400580607354641, 0.014706892892718315, 0.012908915057778358, -0.006050615105777979, -0.02997565269470215, -0.012550724670290947, 0.031661257147789, -0.01708078384399414, 0.02244662307202816, 0.026758959516882896, -0.011286521330475807, -0.0015618172474205494, 0.004150799009948969, -0.018836621195077896, 0.022699464112520218, 0.0012466444168239832, 0.01325305923819542, 0.026927519589662552, 0.016631290316581726, 0.006268338765949011, 0.06281683593988419, 0.002152656437829137, -0.0023317518644034863, 0.04084779694676399, 0.013505900278687477, 0.0005912781925871968, -0.021407168358564377, 0.015605880878865719, -0.008182201534509659, 0.03284117951989174, 0.021898802369832993, 0.021393120288848877, -0.0016943828668445349, 0.03126794844865799, -0.011419964954257011, -0.03138032183051109, -0.01609751582145691, -0.03317829966545105, -0.004175380803644657, 0.004930390976369381, -0.04590460658073425, -0.08102135360240936, -0.014777125790715218, -0.03286927193403244, 0.0047723655588924885, -0.02209545485675335, -0.025480709969997406, 0.011637689545750618, -0.03666188195347786, -0.012873798608779907, -0.00026183921727351844, -0.020718879997730255, -0.0025951273273676634, 0.0300318393856287, 0.0029761441983282566, 0.004779389128088951, 0.01010659895837307, 0.03829129785299301, -0.013196872547268867, -0.019482769072055817, 0.04688787832856178, -0.04551130160689354, -0.023781059309840202, 0.037504684180021286, 0.03340304642915726, -0.043095268309116364, 0.012719284743070602, -0.022320203483104706, 0.013674460351467133, 0.025143589824438095, 0.027292734012007713, 0.019524909555912018, -0.03382444754242897, 0.005717006046324968, 0.03677425533533096, -0.01124438177794218, 0.008133037947118282, -0.0027619318570941687, -0.0316893495619297, -0.019384443759918213, 0.02438506670296192, -0.020114870741963387, 0.016547009348869324, 0.02814958244562149, -0.039611686021089554, -0.021702148020267487, 0.02715226635336876, -0.05340554565191269, 0.016518916934728622, -0.019089462235569954, -0.006981208920478821, -0.010626327246427536, 0.02500312216579914, 0.024286741390824318, -0.026773005723953247, -0.021056000143289566, -0.0014529553009197116, -0.029301412403583527, -0.04961293563246727, 0.019103508442640305, 0.009383194148540497, 0.020451992750167847, -0.029217131435871124, 0.005509817041456699, 0.020648645237088203, -0.034330129623413086, -0.012698214501142502, -0.016223935410380363, -0.026730865240097046, 0.006050615105777979, 0.028880011290311813, -0.04497752711176872, -0.04334811121225357, -0.0019770727958530188, 0.0158306285738945, 0.01609751582145691, 0.001139538362622261, -0.01374469418078661, -0.022882070392370224, 0.04334811121225357, -0.03573479875922203, 0.010092552751302719, 0.02022724412381649, -0.015254713594913483, -0.01710887812077999, -0.018766388297080994, 0.00245466036722064, -0.023219192400574684, -0.06225496530532837, -0.015690160915255547, -0.03579098731279373, -0.03913410007953644, 0.045370832085609436, -0.015957048162817955, 0.02335965819656849, -0.03913410007953644, 0.006844253279268742, -7.41841213312e-05, 0.01646273024380207, 0.026801100000739098, -0.019047321751713753, -0.05127044767141342, -0.045398928225040436, 0.0065738544799387455, -0.04199962690472603, -0.011799226514995098, 0.009102259762585163, 0.009959109127521515, 0.020676739513874054, -0.002217622473835945, 0.01768479309976101, -0.0012940519955009222, 0.026716819033026695, 0.008919653482735157, 0.03536958619952202, 0.022011175751686096, 0.018738294020295143, -0.026969660073518753, 0.019805843010544777, -0.020100824534893036, 0.011335684917867184, 0.025719502940773964, -0.007950430735945702, -0.013604226522147655, -0.02312086522579193, -0.0537145733833313, 0.034891996532678604, 0.03756086900830269, 0.018232613801956177, -0.011981832794845104, -0.0036977932322770357, -0.025157636031508446, -0.014025627635419369, -0.018401173874735832, -0.036521416157484055, -0.01994631066918373, -0.015142340213060379, -0.01613965630531311, 0.010401579551398754, 0.05082095414400101, 0.01325305923819542, 0.001726865884847939, -0.010211949236690998, -0.00043500866740942, -0.014524285681545734, 0.006050615105777979, 0.03233549743890762, -0.0078801978379488, 0.00882834941148758, -0.0005153382080607116, -0.01609751582145691, -0.007859127596020699, -0.013000219129025936, 0.02401985414326191, -0.039976902306079865, 0.01771288551390171, -0.060513172298669815, -0.03868460655212402, -0.004501966759562492, 0.004235079512000084, 0.044415660202503204, 0.0017979773692786694, 0.015985142439603806, -0.028261955827474594, 0.003290439024567604, -0.00010633789497660473, -0.005415001884102821, -0.040875889360904694, -0.01455237902700901, 0.01642058975994587, -0.0006299066008068621, 0.029582345858216286, -0.01057716365903616, -0.08304407447576523, -0.010422649793326855, 0.006103290244936943, -0.042786240577697754, -0.007360469549894333, -0.03197028487920761, -0.01706673763692379, -0.022825883701443672, 0.018583782017230988, 0.058265700936317444, -0.01441191229969263, -0.016968410462141037, -0.01774097979068756, 0.005144603084772825, 0.010211949236690998, -0.033318765461444855, 0.009327007457613945, 0.016055375337600708, 0.007683543488383293, 0.004403639584779739, -0.01406776811927557, -0.04582032933831215, 0.014496192336082458, -0.024483393877744675, -0.012241696938872337, 0.019384443759918213, 0.003351893275976181, -0.03385253995656967, 0.015591834671795368, 0.022502809762954712, 0.04166250675916672, 0.016266075894236565, 0.024834562093019485, 0.011988856829702854, -0.018092146143317223, 0.00773270707577467, 0.011146054603159428, -0.050680484622716904, -0.008435041643679142, -0.030088026076555252, -0.016673430800437927, -0.044162817299366, -0.02782650850713253, 0.02938569150865078, 0.05399550497531891, 0.008631695993244648, 0.008694905787706375, 0.005569515749812126, 0.002105248859152198, 0.009341053664684296, -0.017811212688684464, -0.004017355386167765, 0.01309152226895094, 0.01420823484659195, 0.015142340213060379, 0.025677364319562912, -0.02684323862195015, 0.012901891954243183, -0.025691410526633263, -0.010815957561135292, -0.0031622627284377813, -0.016350356861948967, 0.0033905217424035072, -0.0007409633253701031, 0.0379541777074337, 0.009720315225422382, -0.0252419151365757, -0.016252029687166214, -0.022081408649683, 0.020044637843966484, 0.0018313382752239704, -0.015156387351453304, -0.02500312216579914, 0.006521179340779781, 0.02619709074497223, 0.026337558403611183, -0.044050443917512894, 0.007472843397408724, -0.0016223936108872294, 9.965748176909983e-06, 0.01677175797522068, 0.006675693206489086, -0.01250156108289957, 0.0102540897205472, -0.05399550497531891, -0.012241696938872337, -0.0253261961042881, -0.024567674845457077, 0.011188195087015629, -0.01734767109155655, -0.02338775247335434, -0.03351541981101036, 0.0026460466906428337, 0.023500125855207443, -0.0035906871780753136, -0.01124438177794218, 0.046635035425424576, -0.0014248619554564357, -0.09602322429418564, -0.029498064890503883, 0.009600917808711529, 0.004870692268013954, 0.0073674931190907955, 0.008231365121901035, -0.004733737092465162, 0.007149768993258476, 0.029526159167289734, -0.03595954552292824, 0.009277843870222569, -0.019033275544643402, 0.011124984361231327, -0.01201695017516613, -0.0049795545637607574, -0.04638219624757767, -0.001464368193410337, -0.006651111412793398, 0.03354351595044136, -0.002895375480875373, -0.018429268151521683, 0.01702459715306759, 0.010366463102400303, 0.021238606423139572, 0.0012958078878000379, -0.023148957639932632, 0.005228883121162653, -0.0032799039036035538, 0.01059823390096426, -0.006029544863849878, -0.022685416042804718, -0.025438569486141205, -0.022587090730667114, 0.02563522383570671, -0.05216943472623825, 0.006770508363842964, -0.011286521330475807, 0.011981832794845104, 0.02813553623855114, -0.004579223692417145, -0.007374516222625971, -0.049781497567892075, 0.016870083287358284, -0.018850669264793396, 0.03727993741631508, -0.03067798726260662, 0.028585029765963554, -0.010134692303836346, 0.014109907671809196, -0.015254713594913483, 0.007142745889723301, 0.013779810629785061, 0.0252559632062912, 0.004986577667295933, 0.0029638533014804125, 0.01167280599474907, 0.018892807886004448, -0.018485454842448235, -0.003313264809548855, 0.02556499093770981, -0.025340242311358452, 0.0316050685942173, -0.008737046271562576, -0.00887048989534378, -0.03345923498272896, -0.01613965630531311, -0.008821326307952404, 0.03567861393094063, 0.01311259251087904, -0.05343363806605339, -0.03551005199551582, 0.03677425533533096, -0.012635004706680775, 0.030762268230319023, 0.022839929908514023, -0.002570545766502619, 0.01706673763692379, 0.018204519525170326, -0.051326632499694824, 0.008891560137271881, 0.05084904655814171, -0.027714135125279427, 0.009446403943002224, -0.004013843834400177, 0.02593020349740982, 0.03062180057168007, 0.04461231082677841, -0.029273318126797676, -0.00965710449963808, 0.029554251581430435, 0.04997815191745758, -0.02438506670296192, 0.007191909477114677, -0.002138609765097499, 0.04244912043213844, 0.003999797161668539, 0.020634599030017853, 0.0110828448086977, -0.020283430814743042, -0.003852306865155697, 0.046269822865724564, 0.010647396557033062, -0.006977697368711233, -0.07759395986795425, 0.010029342025518417, 0.009959109127521515, 0.016252029687166214, -0.0014986071037128568, 0.026449931785464287, -0.023570358753204346, 0.0110828448086977, -0.008807279169559479, 0.01678580418229103, 0.055765390396118164, 0.005242929793894291, 0.03657760098576546, 0.010204926133155823, 0.02372487261891365, 0.03371207416057587, -0.01989012397825718, 0.007262142840772867, 0.024188414216041565, -0.026407791301608086, -0.025410477072000504, -0.02657635137438774, -0.012761425226926804, 0.04006118327379227, 0.028880011290311813, -0.012262767180800438, 0.0005623068427667022, 0.013730647042393684, 0.0348358117043972, 0.007402609568089247, 0.010345392860472202, -0.02431483380496502, -0.011293545365333557, -0.012726307846605778, 0.007416656240820885, -0.004579223692417145, 0.030003746971488, 0.013070452027022839, 0.015353040769696236, 0.03727993741631508, 0.00898988638073206, -0.03913410007953644, 0.0012194289593026042, 0.011019634082913399, -0.030425148084759712, -0.010787864215672016, -0.010380509309470654, 0.03138032183051109, -0.01743195205926895, 0.0050603230483829975, 0.02144930697977543, -0.0009823909495025873, 0.023008491843938828, -0.0060681733302772045, -0.04194343835115433, 0.004930390976369381, 0.052590835839509964, 0.022910164669156075, 0.024539580568671227, -0.026492072269320488, 0.011539362370967865, 0.026449931785464287, -0.026660632342100143, -0.023247284814715385, -0.017867399379611015, -0.031211761757731438, 0.04017355665564537, -0.014004557393491268, -0.027419153600931168, 0.04466849938035011, 0.038066551089286804, 0.039611686021089554, 0.022292109206318855, -0.008118991740047932, -0.025101449340581894, 0.03317829966545105, -0.015971096232533455, 0.004702132195234299, 0.005235906690359116, -0.03236359357833862, -0.0033483814913779497, 0.029947560280561447, 0.04166250675916672, 0.015732301399111748, -0.009207610040903091, 0.02112623304128647, 0.027952928096055984, 0.005102463066577911, 0.008533368818461895, -0.02247471734881401, 0.020915532484650612, 0.018457360565662384, -0.011103915050625801, -0.0034765577875077724, 0.03854413703083992, -0.01953895576298237, 0.017136970534920692, 0.007458796724677086, 0.026154952123761177, -0.014123954810202122, -0.006078708451241255, -0.0315207913517952, 0.012445374391973019, -0.006450945977121592, -0.002156168222427368, 0.01059120986610651, 0.015957048162817955, -0.01441191229969263, 0.016856037080287933, -0.026787051931023598, 0.034920088946819305, -0.008161131292581558, -0.027700088918209076, 0.007866150699555874, -0.009200586937367916, -0.0189209021627903, -0.02153358794748783, -0.02372487261891365, 0.004070030525326729, -0.026801100000739098, 0.014327631331980228, -0.04025783762335777, -0.013470782898366451, 0.02081720530986786, -0.019819891080260277, -0.007184885907918215, 0.027896741405129433, -0.015226620249450207, 0.027615807950496674, 0.0016144923865795135, -0.012164440006017685, -0.039049819111824036, -0.007332376204431057, -0.019173743203282356, -0.0505119264125824, -0.0036205362994223833, -0.005383396986871958, 0.030453240498900414, 0.02149144746363163, 0.020030591636896133, -0.0013449713587760925, -0.008575509302318096, 0.007704613730311394, 0.0014134489465504885, 0.03376826271414757, -0.020016543567180634, 0.005836402997374535, -0.002319460967555642, -0.005246441811323166, 0.039667874574661255, -0.010647396557033062, 0.007054953835904598, -0.00201043370179832, 0.033627793192863464, 0.039976902306079865, 0.04832063987851143, 0.010935354046523571, -0.02334561198949814, 0.016532963141798973, 0.0221516415476799, -0.02178642898797989, -0.005931218154728413, -0.020142965018749237, -0.009537708014249802, 0.006703786551952362, 0.018218567594885826, 0.005018182564526796, -0.045370832085609436, 0.02276969701051712, 0.005558980628848076, 0.022235922515392303, -0.0012571794213727117, 0.009081190451979637, -0.009600917808711529, -0.013892184011638165, 0.017895493656396866, -0.019159695133566856, -0.03359970077872276, -0.017909539863467216, 0.0005451874458231032, 0.0036591647658497095, -0.00032790261320769787, -0.033318765461444855, -0.04149394482374191, -0.002675896044820547, 0.04582032933831215, -0.020311525091528893, 0.009523660875856876, 0.04517418146133423, 0.012347047217190266, 0.0189630426466465, -0.014397865161299706, -0.00898988638073206, -4.399881163408281e-06, -0.0006277118227444589, 0.014917593449354172, -0.043460484594106674, 0.021631915122270584, 0.029919466003775597, 0.041887253522872925, 0.02122456021606922, 0.020648645237088203, 0.022292109206318855, -0.015535647980868816, -0.023457985371351242, -0.012796541675925255, 0.00016011040133889765, 0.013358409516513348, 0.04194343835115433, 0.019145648926496506, 0.013541016727685928, 0.0012080160668119788, -0.010977494530379772, -0.0015056304400786757, -0.04230865463614464, 0.015058060176670551, -0.03034086711704731, 0.0037188632413744926, 0.020157011225819588, 0.0015179213369265199, 0.004610828589648008, 0.004382569808512926, -0.0348077155649662, 0.009509614668786526, -0.014123954810202122, 0.005618679337203503, 0.02182856760919094, 0.028514796867966652, 0.011258427985012531, 6.480136653408408e-05, 0.019496817141771317, -0.040314022451639175, -0.003176309634000063, 0.00854741595685482, -0.0010008271783590317, -0.004926879424601793, -0.007887220941483974, 0.0134567366912961, 0.0061665005050599575, 0.0006588778924196959, -0.005232395138591528, -0.023851292207837105, 0.011553408578038216, -0.016209889203310013, 0.019735610112547874, 0.0028427005745470524, -0.02026938460767269, 0.07388562709093094, -0.022348295897245407, 0.008877512998878956, -0.02500312216579914, -0.020381757989525795, 0.03286927193403244, -0.012880821712315083, 0.012213603593409061, -0.028360283002257347, 0.0036170247476547956, -0.018078099936246872, 0.016659382730722427, -0.006440410856157541, 0.016027282923460007, 0.009039049968123436, -0.04081970453262329, -0.0026390233542770147, 0.028374329209327698, -0.0047723655588924885, 0.006580878049135208, 0.016308216378092766, -0.00019621480896603316, -0.009369147010147572, -0.03927456587553024, -0.019482769072055817, 0.0025231381878256798, -0.012220626696944237, 0.04582032933831215, 0.01994631066918373, 0.022671369835734367, 0.006342084147036076, -0.04025783762335777, -0.04003308713436127, -0.005871519912034273, 0.024118179455399513, 0.01501591969281435, -0.018794482573866844, 0.025508802384138107, 0.0048671807162463665, -0.0036064896266907454, 0.02496098168194294, 0.012354070320725441, -0.029498064890503883, 0.0003432661760598421, -0.01090023759752512, -0.013590180315077305, -0.00854741595685482, -0.011328661814332008, 0.008329691365361214, 0.0008910874021239579, -0.007241072598844767, -0.008484205231070518, 0.041522037237882614, -0.010865121148526669, 0.019384443759918213, -0.03199837729334831, 0.006061150226742029, 0.04303908348083496, 0.01219253335148096, 0.002826897893100977, -0.02498907595872879, -0.011946716345846653, -0.02777032181620598, -0.007002278696745634, -0.009439380839467049, -0.033655889332294464, -0.020283430814743042, 0.03140841796994209, -0.004860157612711191, 0.0009929259540513158, -0.006433387752622366, 0.007290236186236143, -0.0026794075965881348, 0.014650706201791763, -0.0003340480325277895, 0.025424523279070854, 0.0007444749935530126, 0.023303471505641937, 0.030509427189826965, 0.038403671234846115, -0.018836621195077896, 0.013632319867610931, -0.012452397495508194, 0.007529030088335276, -0.003943610470741987, 0.010303252376616001, 0.039611686021089554, -0.020803159102797508, -0.004407151602208614, 0.025536896660923958, -0.02275565080344677, 0.003838260192424059, 0.0410444512963295, 0.008856442756950855, -0.018246660009026527, -0.025438569486141205, 0.0016680454136803746, -0.011188195087015629, 0.029160944744944572, -0.001449443632736802, -0.0380384586751461, -0.014734986238181591, -0.009699244983494282, 0.0041578225791454315, 0.020297478884458542, 0.02723654732108116, -0.05127044767141342, -0.01250156108289957, 0.04267386719584465, 0.034976277500391006, 0.015928955748677254, -0.015563741326332092, -0.0007914436282590032, 0.014763079583644867, -0.008245411328971386, 0.03949931263923645, -0.025536896660923958, 0.01406074408441782, -0.011757086031138897, -0.011644712649285793, 0.01219253335148096, 0.00640529440715909, 0.011511269025504589, 0.02463790774345398, -0.0011623642640188336, -0.016603196039795876, -0.00044312942191027105, -0.01736171916127205, -0.01736171916127205, -0.024834562093019485, -0.011188195087015629, -0.02941378578543663, 0.007205956149846315, 0.015212574042379856, 0.0221656896173954, 0.021870708093047142, 0.00980459526181221, -0.02338775247335434, -0.009579847566783428, 0.00882834941148758, -0.007388562895357609, 0.029132850468158722, -0.005629213992506266, 0.042786240577697754, 0.00016910907288547605, 0.008252435363829136, -0.006696762982755899, 0.008027687668800354, 0.028233863413333893, -0.014123954810202122, -0.01670152321457863, 0.028585029765963554, 0.0014327631797641516, 0.02090148627758026, 0.018078099936246872, 0.006598436273634434, -0.010464790277183056, 0.005267511587589979, 0.034273941069841385, 0.031043201684951782, 0.014594518579542637, 0.00032878053025342524, -0.01866806112229824, 0.015732301399111748, 0.046972159296274185, -0.012635004706680775, -0.022853977978229523, 0.0020490619353950024, 0.008645742200314999, -0.002696966053918004, -0.003852306865155697, 0.04149394482374191, 0.00915844738483429, 0.004621363710612059, -0.010197903029620647, -0.014889500103890896, -0.021617867052555084, 0.010865121148526669, -0.004923367407172918, 0.0037048165686428547, -0.009874828159809113, -0.0023703803308308125, 0.006963650230318308, 0.029245225712656975, -0.012859751470386982, -0.0094955675303936, -0.0017523255664855242, 0.0013388259103521705, 0.0018488966161385179, -0.011026658117771149, 0.015226620249450207, -0.014123954810202122, 0.039611686021089554, 0.023907478898763657, 0.037139467895030975, 0.026646586135029793, 0.008856442756950855, 0.05509115010499954, 0.03095892257988453, 0.04767449200153351, -0.02303658425807953, -0.023261331021785736, -0.025227868929505348, -0.03739231079816818, 0.03317829966545105, 0.03629666566848755, 0.02056436613202095, 0.011483175680041313, 0.005618679337203503, -0.0004387398366816342, 0.010780840180814266, -0.008912629447877407, 0.02938569150865078, 0.027910789474844933, 0.015086153522133827, 0.01124438177794218, -0.023219192400574684, -0.009650081396102905, -0.020325571298599243, -0.03348732739686966, 0.015367086976766586, 0.011757086031138897, 0.013695530593395233, 0.011644712649285793, -0.0008032955229282379, -0.005014671012759209, 0.017839306965470314, -0.008189224638044834, 0.015072106383740902, 0.007838057354092598, -0.023022538051009178, -0.00047978252405300736, 0.026688726618885994, -0.014180141501128674, 0.007423679810017347, 0.006963650230318308, 0.003750468371436, -0.009453427977859974, 0.019510863348841667, 0.025733551010489464, -0.0031798211857676506, -0.007683543488383293, 0.01831689476966858, 0.02240448258817196, -0.0014731474220752716, 0.036212388426065445, 0.0173757653683424, 0.00021750433370471, -0.009762454777956009, 0.011602572165429592, -0.033037833869457245, 0.017263391986489296, -0.007697590626776218, -0.033009741455316544, -0.011181171052157879, -0.020634599030017853, -0.011721969582140446, -0.009846734814345837, 0.021954989060759544, 0.012838682159781456, -0.023247284814715385, -0.003283415688201785, 0.0007800306775607169, 0.01774097979068756, -0.020943626761436462, 0.03326258063316345, -0.006359642371535301, 0.048854414373636246, 0.001929665100760758, -0.02814958244562149, -0.01734767109155655, -0.0034642668906599283, -0.005474700592458248, -0.02619709074497223, 0.019440630450844765, 0.03579098731279373, 0.016237983480095863, -0.014222281984984875, 0.00033602333860471845, -0.0007901267381384969, 0.022207830101251602, -0.004340429790318012, -0.017839306965470314, -0.01611156202852726, -0.0016373181715607643, 0.020732926204800606, -0.024441253393888474, 0.005316675174981356, -0.01138484850525856, 0.01611156202852726, 0.007234049495309591, 0.006524691358208656, 0.00838587898761034, -0.01219955738633871, -0.03868460655212402, -0.007395586464554071, -0.018710201606154442, -0.0007953942404128611, -0.007458796724677086, 0.023570358753204346, -0.022587090730667114, 0.00260390667244792, -0.008027687668800354, 0.03455487638711929, 0.01679985038936138, 0.03309401869773865, -0.013835997320711613, 0.04862966760993004, -0.0010675489902496338, 0.03140841796994209, -0.030116120353341103, 0.01327412948012352, -0.013000219129025936, -0.01618179678916931, -0.029610438272356987, 0.009109283797442913, -0.004003308713436127, 0.029638532549142838, -0.00898988638073206, 0.039667874574661255, -0.003915517125278711, -0.014650706201791763, 0.00948152132332325, -0.022601136937737465, 0.02272755652666092, -0.003264101454988122, 0.001355506363324821, -0.018766388297080994, 0.03292546048760414, 0.023022538051009178, 0.03449869155883789, 0.003845283528789878, -0.006299944128841162, -0.022882070392370224, 0.004972530994564295, 0.008947746828198433, 0.022952303290367126, 0.025213822722434998, 0.019496817141771317, -0.013541016727685928, -0.04556748643517494, -0.010626327246427536, -0.0022422040347009897, -0.04233674705028534, -0.026112811639904976, 0.02153358794748783, -0.02272755652666092, 0.02239043638110161, -0.01550755463540554, -0.004526548553258181, 0.04924772307276726, 0.04989387094974518, -0.02396366558969021, 0.03668997436761856, 0.03197028487920761, 0.026000438258051872, 0.009207610040903091, -0.0173336248844862, 0.00038913742173463106, -0.006201616954058409, -0.040314022451639175, -0.014580472372472286, 0.005197278223931789, 0.013997534289956093, 0.002879573032259941, -0.014355725608766079, -0.021617867052555084, -0.020395806059241295, -0.017136970534920692, -0.04014546051621437, -0.002712768502533436, 0.02085934579372406, 0.01246644463390112, 0.03095892257988453, -0.01358315721154213, -0.005969846621155739, -0.024722188711166382, -0.009256773628294468, -0.00821731798350811, -0.005695935804396868, 0.028374329209327698, -0.006710809655487537, 0.02081720530986786, -0.008568485267460346, -0.0061524538323283195, 0.015900861471891403, -0.0018734782934188843, 0.002691698493435979, 0.008652766235172749]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
". Gptq: Accurate post-training quantization
for generative pre-trained transformers. arXiv preprint
arXiv:2210.17323 , 2022.
Leo Gao, Jonathan Tow, Stella Biderman, Sid Black, An-
thony DiPofi, Charles Foster, Laurence Golding, Jeffrey
Hsu, Kyle McDonell, Niklas Muennighoff, Jason Phang,
Laria Reynolds, Eric Tang, Anish Thite, Ben Wang, Kevin
Wang, and Andy Zou. A framework for few-shot lan-
guage model evaluation, September 2021. URL https:
//doi.org/10.5281/zenodo.5371628 .
Albert Q Jiang, Alexandre Sablayrolles, Arthur Mensch,
Chris Bamford, Devendra Singh Chaplot, Diego de las
Casas, Florian Bressand, Gianna Lengyel, Guillaume
Lample, Lucile Saulnier, et al. Mistral 7b. arXiv preprint
arXiv:2310.06825 , 2023.Yunho Jin, Chun-Feng Wu, David Brooks, and Gu-Yeon
Wei. S3: Increasing gpu utilization during genera-
tive inference for higher throughput. arXiv preprint
arXiv:2306.06000 , 2023.
Sehoon Kim, Coleman Hooper, Amir Gholami, Zhen Dong,
Xiuyu Li, Sheng Shen, Michael W Mahoney, and Kurt
Keutzer. Squeezellm: Dense-and-sparse quantization.
arXiv preprint arXiv:2306.07629 , 2023.
Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng,
Lianmin Zheng, Cody Hao Yu, Joseph Gonzalez, Hao
Zhang, and Ion Stoica. Efficient memory management
for large language model serving with pagedattention. In
Proceedings of the 29th Symposium on Operating Systems
Principles , pages 611–626, 2023a.
Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying Sheng,
Lianmin Zheng, Cody Hao Yu, Joseph E. Gonzalez, Hao
Zhang, and Ion Stoica. Efficient memory management
for large language model serving with pagedattention. In
Proceedings of the ACM SIGOPS 29th Symposium on
Operating Systems Principles , 2023b.
Ji Lin, Jiaming Tang, Haotian Tang, Shang Yang, Xingyu
Dang, and Song Han. Awq: Activation-aware weight
quantization for llm compression and acceleration. arXiv
preprint arXiv:2306.00978 , 2023.
Guilherme Penedo, Quentin Malartic, Daniel Hesslow,
Ruxandra Cojocaru, Alessandro Cappelli, Hamza Alobei-
dli, Baptiste Pannier, Ebtesam Almazrouei, and Julien
Launay. The refinedweb dataset for falcon llm: outper-
forming curated corpora with web data, and web data
only. arXiv preprint arXiv:2306.01116 , 2023.
Reiner Pope, Sholto Douglas, Aakanksha Chowdhery, Ja-
cob Devlin, James Bradbury, Jonathan Heek, Kefan Xiao,
Shivani Agrawal, and Jeff Dean. Efficiently scaling trans-
former inference. Proceedings of Machine Learning and
Systems , 5, 2023.
Noam Shazeer. Fast transformer decoding: One write-head
is all you need. arXiv preprint arXiv:1911.02150 , 2019.
Ying Sheng, Lianmin Zheng, Binhang Yuan, Zhuohan Li,
Max Ryabinin, Beidi Chen, Percy Liang, Christopher Ré,
Ion Stoica, and Ce Zhang. Flexgen: High-throughput
generative inference of large language models with a
single gpu. In International Conference on Machine
Learning , pages 31094–31116. PMLR, 2023.
Yuandong Tian, Yiping Wang, Beidi Chen, and Simon Du.
Scan and snap: Understanding training dynamics and
token composition in 1-layer transformer. arXiv preprint
arXiv:2305.16380 , 2023.
9
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Mar-
tinet, Marie-Anne Lachaux, Timothée L","[0.01452441606670618, 0.029328687116503716, 0.012257600203156471, -0.026362234726548195, 0.015154086984694004, -0.016805225983262062, -0.014230569824576378, 0.05098937451839447, -0.06537386775016785, -0.004523138515651226, 0.039123572409152985, 0.015895700082182884, -0.052640512585639954, 0.03666085749864578, -0.0011946262093260884, 0.0004068812995683402, 0.015853721648454666, -0.030699970200657845, 0.002662109909579158, 0.02571857161819935, -0.011676902882754803, -0.05563494935631752, 0.008955324068665504, 0.028405169025063515, 0.04105456545948982, -0.028713008388876915, -0.013593901880085468, 0.008059791289269924, 0.011299100704491138, -0.05406776815652847, 0.036017194390296936, -0.03724855184555054, -0.036520931869745255, -0.0613439716398716, -0.03828401118516922, 0.02710384875535965, 0.00754206208512187, 0.01390873733907938, -0.027229782193899155, 0.0026043900288641453, 0.013251081109046936, -0.05681033805012703, -0.031119750812649727, 0.027579599991440773, 0.02026141993701458, 0.024067433550953865, 0.017854677513241768, -0.013041190803050995, -0.05031772702932358, 0.05798572301864624, 0.002940214704722166, 0.048414722084999084, -0.060616347938776016, -0.008178729563951492, -0.01632947288453579, -0.002544921124354005, -0.01617555320262909, 0.02592846192419529, 0.02868502214550972, -0.02471109665930271, 0.004299255087971687, -0.0638066828250885, 0.00562856113538146, 0.02174464613199234, -0.024459227919578552, 0.012208625674247742, -0.04083067923784256, 0.02378758043050766, 0.004229291807860136, -0.009955802001059055, -0.022374317049980164, 0.01858229748904705, 0.03078392706811428, -0.03528957441449165, -0.01576976664364338, 0.010403567925095558, -0.02694992907345295, 0.07640010863542557, -0.01806456781923771, -0.031875357031822205, -0.01449643075466156, -0.012110676616430283, 0.0031308652833104134, -0.03951536864042282, -0.015224050730466843, -0.02598443254828453, -0.025172855705022812, -0.002467961283400655, -0.026656081900000572, 0.012992216274142265, -0.024459227919578552, -0.003321515629068017, -0.03954335302114487, -0.0031605996191501617, 0.02103101834654808, -0.007332171779125929, 0.057705868035554886, -0.003536653472110629, 0.017392918467521667, 0.028768979012966156, -0.0033180175814777613, 0.011138183996081352, 0.04950615018606186, -0.02797139436006546, 0.04418892785906792, -0.02236032485961914, -0.003921452444046736, -0.008780415169894695, -0.017938634380698204, 0.020583253353834152, -0.08809799700975418, -0.018400391563773155, -0.02444523572921753, 0.03363843634724617, -0.013237087987363338, -0.04497251659631729, -0.06033649668097496, -0.006859918124973774, -0.03822803869843483, 0.007013837806880474, -0.007318178657442331, -0.01097726821899414, -0.0008295043953694403, 0.019995559006929398, 0.017672771587967873, -0.016245517879724503, 0.007751952391117811, -0.05854542925953865, -0.02444523572921753, -0.0027408190071582794, 0.026166336610913277, 0.021156953647732735, 0.038759760558605194, -0.0119987353682518, -0.001313564134761691, -0.046119917184114456, -0.000629671209026128, 0.00987184513360262, -0.04656768590211868, 0.0002015822392422706, 0.028908904641866684, -0.0014447456924244761, -0.012495475821197033, 0.008045799098908901, -0.02862905152142048, 0.011550968512892723, -0.015294014476239681, 0.009703933261334896, -0.01760280877351761, 0.009717925451695919, -0.009647962637245655, -0.024515200406312943, -0.0284891240298748, -0.012733351439237595, -0.031063780188560486, -0.018974093720316887, -0.01613357663154602, 0.0774635523557663, 0.041278447955846786, -0.06156785413622856, 0.0017018613871186972, 0.0668850764632225, -0.0013284314190968871, -0.0009523777407594025, 0.04970204830169678, 0.006552078761160374, -0.04653970152139664, 0.008248693309724331, -0.056838322430849075, -0.03282685950398445, 0.004082368221133947, -0.042034052312374115, -0.012873277999460697, -0.03405821695923805, -0.011089209467172623, -0.02699190564453602, -0.01893211528658867, -0.03333059698343277, -0.0476871021091938, -0.037696316838264465, -0.012348552234470844, 0.054487548768520355, -0.02746765874326229, 0.03948738053441048, -0.026404213160276413, -0.020135486498475075, -0.011194154620170593, 0.02700589969754219, 0.015126101672649384, 0.05932902172207832, -0.014846248552203178, 0.034226130694150925, 0.06677313148975372, 0.0390116311609745, 0.01877819560468197, -0.032491035759449005, 0.04536431282758713, -0.000847869785502553, -0.01449643075466156, -0.031623486429452896, 0.0063806683756411076, 0.042090024799108505, -0.011858807876706123, -0.0551312156021595, 0.01729496940970421, -0.018540319055318832, -0.024823039770126343, -0.0016074107261374593, -0.04634380340576172, -0.018876144662499428, 0.03232312202453613, 0.05087743327021599, 0.03022421896457672, -0.0009926067432388663, -0.019519807770848274, 0.0219965148717165, -0.016469400376081467, 0.028139308094978333, 0.006562573369592428, 0.03959932178258896, -0.005880429409444332, 0.01618954725563526, 0.0121526550501585, 0.026124360039830208, -0.02438926510512829, 0.03159550204873085, -0.013188114389777184, -0.024879010394215584, 0.031679458916187286, -0.024739082902669907, 0.05121326074004173, -0.0044741639867424965, -0.026670074090361595, -0.039375439286231995, -0.004166324622929096, -0.033414553850889206, 0.02066720835864544, -0.02675403095781803, -0.0210729967802763, -0.04256577417254448, 0.007423124276101589, -0.011159173212945461, 0.01493020448833704, -0.009319134056568146, 0.00755605474114418, 0.0347018800675869, -0.055718906223773956, -0.055662937462329865, 0.05585883557796478, -0.004645574372261763, -0.014888226054608822, -0.029272714629769325, -0.045308344066143036, 0.00518079474568367, -0.04628783091902733, -0.02567659318447113, 0.006747976411134005, -0.00801781378686428, -0.025452710688114166, 0.03537353128194809, -0.013076172210276127, -0.020023545250296593, -0.018554311245679855, -0.0033250139094889164, 0.001017968519590795, 0.010725399479269981, -0.03475785255432129, 0.03948738053441048, 0.0019624752458184958, -0.0022965508978813887, 0.01163492538034916, -0.02097504772245884, 0.020989039912819862, 0.001562808989547193, -0.05725810304284096, 0.0002015822392422706, 0.0430695116519928, 0.01848434843122959, -0.05199684947729111, 0.04379713162779808, 0.01567181758582592, 0.014972181990742683, 0.023157907649874687, 0.021716661751270294, -0.004113852046430111, 0.01207569520920515, -0.0024067433550953865, -0.007430120371282101, -0.02434728667140007, -0.0005802595405839384, 0.06985152512788773, 0.008794408291578293, 0.008969317190349102, -0.053620003163814545, 0.020303398370742798, 0.02806934341788292, -0.025438716635107994, -0.013090165331959724, -0.0021741148084402084, -0.041978079825639725, 0.05093340575695038, -0.009584994986653328, 0.010893312282860279, -0.0027320734225213528, -0.018848158419132233, 0.05798572301864624, -0.01939387433230877, 0.006107810884714127, 0.019281931221485138, 0.02357768826186657, 0.0005824458785355091, 0.0045476253144443035, -0.02704787813127041, 0.019072040915489197, -0.04715537652373314, -0.0229200329631567, 0.011648917570710182, -0.002901734784245491, 0.021716661751270294, -0.039431411772966385, 0.005401179660111666, -0.052948351949453354, -0.012369541451334953, 0.006856420077383518, 0.014412474818527699, 0.0232278723269701, -0.030196232721209526, -0.018750209361314774, -0.0014027676079422235, -0.03822803869843483, 0.020331384614109993, 0.027397694066166878, 0.03445001319050789, -0.005761491600424051, -0.03523360192775726, -0.01996757462620735, -0.017113065347075462, 0.02729974500834942, 0.012579431757330894, 0.0041418373584747314, -0.07975835353136063, 0.020443325862288475, -0.006482115481048822, -0.04421691223978996, -0.03042011708021164, 0.03338656574487686, 0.03741646185517311, 0.041110534220933914, 0.07164259254932404, -0.024025455117225647, 0.009647962637245655, -0.0347018800675869, 0.035653382539749146, -0.03884371742606163, 0.023759594187140465, 0.002186358440667391, 0.014412474818527699, -0.027859453111886978, -0.05308828130364418, -0.0002861943212337792, -0.020597245544195175, 0.0322391651570797, 0.02822326309978962, -0.005467644892632961, -0.040494855493307114, -0.01979966089129448, -0.016413429751992226, 0.029468612745404243, 0.0216886755079031, -0.010711407288908958, 0.008129755035042763, 0.04656768590211868, -0.02485102415084839, -0.01416060607880354, 0.0072762006893754005, -0.03209923952817917, 0.025480695068836212, 0.03134363517165184, 0.034533970057964325, 0.04695948213338852, 0.03724855184555054, 0.027243774384260178, 0.008696459233760834, 0.0002855384082067758, 0.009305141866207123, 0.012642398476600647, -0.006163781508803368, 0.009605984203517437, -0.030028320848941803, 0.01761680096387863, -0.031175721436738968, -0.008997302502393723, -0.05932902172207832, 0.010242652148008347, 0.02010750025510788, 0.017798706889152527, -0.0057195136323571205, -0.0029437129851430655, 0.03022421896457672, 0.016987130045890808, -0.011383056640625, 0.008080780506134033, -0.017225006595253944, -0.019869625568389893, 0.006894899997860193, 0.01653936505317688, 0.04715537652373314, 0.03296678513288498, 0.023703623563051224, 0.016049619764089584, 0.00408586673438549, -0.048050910234451294, 0.00763301458209753, -0.02311593107879162, 0.0034631916787475348, -0.04175419732928276, 0.02469710446894169, 0.0010660684201866388, 0.0218425951898098, 0.07416127622127533, -0.03201528266072273, 0.0018680245848372579, -0.04656768590211868, -0.06475818902254105, -0.03752840310335159, -0.01192177552729845, -0.01592368632555008, -0.06201561912894249, 0.04013104736804962, -0.04248181730508804, -0.05983275920152664, -0.0390116311609745, 0.01775672845542431, -0.03481382131576538, 0.006044843699783087, -0.04883450269699097, -0.0034649407025426626, 0.0380881130695343, 0.036157120019197464, -0.024487214162945747, -0.031315647065639496, 0.003648594953119755, -0.017700757831335068, -0.011669906787574291, -0.020177464932203293, -0.010956279002130032, 0.004103357437998056, -0.01842837780714035, 0.026012416929006577, -0.04914234206080437, 0.032994773238897324, 0.008556532673537731, 0.05865737423300743, -0.04013104736804962, 0.012082691304385662, -0.0526685006916523, 0.07690384238958359, -0.01161393616348505, 0.05395582690834999, -0.003531406167894602, -0.002730324398726225, 0.020891092717647552, -0.06548580527305603, -0.00398092158138752, 0.013146135956048965, 0.01632947288453579, 0.017238998785614967, 0.018750209361314774, 0.02935667149722576, -0.0044531747698783875, -0.01935189589858055, -0.028964877128601074, -0.02986040897667408, -0.014986175112426281, -0.003554144175723195, 0.010011772625148296, 0.03680078312754631, -0.01700112223625183, 0.0007573545444756746, -0.042453832924366, 0.02515886351466179, -0.0768478736281395, 0.014706321060657501, 0.008640488609671593, 0.014790276996791363, 0.0669410452246666, 0.020121494308114052, 0.013314047828316689, 0.005502626765519381, -0.009298144839704037, -0.006702500395476818, -0.005901418626308441, 0.049282267689704895, -0.016623320057988167, 0.02382955700159073, 0.018946107476949692, -0.0056810337118804455, -0.020947063341736794, -0.02521483413875103, -0.03436605632305145, 0.018456364050507545, -0.01802258938550949, 0.017127057537436485, 0.007584040053188801, 0.026823993772268295, -0.016567349433898926, 0.05916110798716545, 0.021422814577817917, -0.0006677138735540211, 0.038675807416439056, 0.024529192596673965, -0.018302444368600845, -0.021478785201907158, 0.004788999445736408, -0.0011027992004528642, 0.05639055743813515, -0.006293213926255703, 0.019309917464852333, 0.005110831465572119, 0.033106714487075806, -0.01965973526239395, -0.045868050307035446, -0.004631581716239452, -0.03134363517165184, 0.006517097353935242, 0.014706321060657501, -0.017490867525339127, -0.10332205146551132, -0.008640488609671593, -0.03251902014017105, 0.013244085013866425, -0.020863106474280357, -0.023143915459513664, 0.0031763415317982435, -0.05490732938051224, -0.004463669378310442, -0.016777239739894867, -0.01613357663154602, -0.027859453111886978, 0.011725877411663532, -0.0026656081900000572, 0.01053649839013815, 0.012831300497055054, 0.034226130694150925, -0.010137706995010376, -0.011648917570710182, 0.02750963531434536, -0.046175889670848846, -0.024990951642394066, 0.01658134162425995, 0.040662769228219986, -0.04077471047639847, 0.02378758043050766, -0.01981365494430065, 0.00570552097633481, 0.005639055743813515, 0.053004324436187744, 0.023059958592057228, -0.015741780400276184, 0.0027932915836572647, 0.03895565867424011, -0.0068879034370183945, 0.012663387693464756, 0.0025099394842982292, -0.03649294376373291, 0.0016625069547444582, 0.01597965694963932, -0.029160773381590843, 0.019925596192479134, 0.014251559041440487, -0.022318346425890923, -0.017015116289258003, 0.029692497104406357, -0.018750209361314774, 0.01541994884610176, -0.023927506059408188, 0.022178418934345245, 0.01099825743585825, 0.02020544931292534, 0.030280189588665962, -0.03481382131576538, -0.02326985076069832, 0.002356019802391529, -0.020457318052649498, -0.042034052312374115, 0.02515886351466179, 0.010774374008178711, 0.02409541793167591, -0.026712052524089813, -0.0015112109249457717, 0.040242988616228104, -0.017700757831335068, -0.026879964396357536, -0.03722056746482849, -0.03951536864042282, -0.008318656124174595, 0.017826691269874573, -0.038060128688812256, -0.04684753715991974, 0.010326608084142208, 0.017378926277160645, -0.0057370043359696865, -0.022850068286061287, -0.0018260465003550053, -0.02006552368402481, 0.012474486604332924, -0.016917167231440544, -0.007521072868257761, 0.002364765154197812, -0.011781848035752773, -0.009857852943241596, -0.00017753230349626392, -0.020023545250296593, -0.014398481696844101, -0.028517110273241997, -0.021548748016357422, -0.030336160212755203, -0.00299968384206295, 0.03755639120936394, -0.01979966089129448, 0.03691272810101509, -0.057761840522289276, 0.001422882080078125, -0.00013446103548631072, -0.005848946049809456, 0.047547172755002975, -0.009550013579428196, -0.029272714629769325, -0.04911435395479202, -0.0005785104585811496, -0.04973003268241882, -0.023899521678686142, 0.013432986102998257, 0.02557864412665367, 0.0013432985870167613, 0.001540945377200842, 0.000614803982898593, -0.011313092894852161, 0.031063780188560486, -0.015028153546154499, 0.013363022357225418, 0.011725877411663532, 0.003569886088371277, -0.005590081214904785, 0.038619834929704666, -0.0006751474575139582, 0.005684531759470701, 0.024235345423221588, -0.01102624274790287, 0.0014666091883555055, -0.028503118082880974, -0.060672320425510406, 0.03951536864042282, 0.021856587380170822, 0.019631749019026756, -0.003492926247417927, 0.0005465896101668477, -0.04620387405157089, -0.01950581558048725, -0.009745911695063114, -0.055047258734703064, -0.0023822560906410217, -0.015252036042511463, 0.004460171330720186, -0.0034736862871795893, 0.05804169550538063, 0.01777072064578533, 0.021478785201907158, -0.014566394500434399, -0.0031413596589118242, 0.01097726821899414, 0.011264118365943432, 0.032491035759449005, -0.030280189588665962, 0.014258555136620998, -0.009312137961387634, -0.004246782511472702, -0.01628749631345272, 0.012131665833294392, 0.038759760558605194, -0.06302309036254883, 0.036520931869745255, -0.0743291899561882, -0.032742902636528015, 0.00011631426605163142, -0.014608372002840042, 0.014762291684746742, -0.009487046860158443, 0.027523629367351532, -0.007996824570000172, 0.0008574897656217217, 0.0034894279669970274, -0.0006357930251397192, -0.03321865573525429, -0.006023854482918978, -0.006705998443067074, -0.0027110844384878874, 0.03282685950398445, -0.01960376463830471, -0.1015869602560997, -0.012761336751282215, 0.012236610986292362, -0.02515886351466179, -0.015531890094280243, -0.048918455839157104, -0.021394828334450722, -0.015629839152097702, 0.014580386690795422, 0.06587760150432587, 0.004617589060217142, 0.0034072210546582937, -0.006768965627998114, -0.008983309380710125, 0.009417083114385605, -0.03411418944597244, 0.013377015478909016, 0.025816520676016808, 0.025508681312203407, -0.012866281904280186, -0.030140262097120285, -0.02935667149722576, -0.0037185584660619497, -0.036157120019197464, 0.0035628897603601217, 0.02608238160610199, -0.02704787813127041, -0.01817650906741619, -0.00745110958814621, -0.0018627773970365524, 0.029888393357396126, 0.01017968449741602, 0.009137229062616825, 0.026278279721736908, -0.029020847752690315, -0.00136866036336869, 0.009752907790243626, -0.03170744329690933, 0.004719036165624857, -0.026558132842183113, -0.028880920261144638, -0.03895565867424011, -0.015629839152097702, 0.011061224155128002, 0.041474346071481705, 0.005799971520900726, 0.03128766268491745, 0.003038163762539625, 0.010172688402235508, 0.015699801966547966, -0.017854677513241768, -0.003802514635026455, 0.013272070325911045, 0.011704888194799423, -0.0013118149945512414, 0.012425512075424194, -0.012677380815148354, 0.03618510812520981, -0.012817307375371456, -0.018036581575870514, 0.002389252418652177, -0.0074930875562131405, -0.006817940156906843, -0.0017683267360553145, 0.04354526475071907, 0.004089364781975746, -0.022570215165615082, -0.010760381817817688, -0.009731918573379517, -0.015755772590637207, 0.020275413990020752, -0.007849900983273983, -0.01750485971570015, 0.020863106474280357, 0.02700589969754219, 0.03758437559008598, -0.02066720835864544, -0.004393706098198891, 0.004946417175233364, -0.005555099342018366, 0.023395784199237823, -0.01367785781621933, 0.015713796019554138, 0.015503904782235622, -0.02710384875535965, -0.03375037759542465, -0.021674683317542076, -0.03165147453546524, 0.006768965627998114, 0.006548580713570118, -0.038619834929704666, -0.04511244595050812, 0.018764201551675797, 0.027873445302248, 0.003241057740524411, -0.029720481485128403, 0.051940880715847015, -0.0010783119359984994, -0.09470254927873611, -0.026404213160276413, 0.0022108457051217556, 0.0016869941027835011, 0.021912558004260063, -0.025032930076122284, 0.004673559684306383, 0.0008684215717948973, -0.000138068528030999, -0.0421459935605526, 0.02714582532644272, -0.013446979224681854, 0.014440460130572319, 0.00031461697653867304, 0.016763247549533844, -0.0476871021091938, 0.01171888131648302, -0.03674481436610222, 0.0607282929122448, 0.0013363022590056062, -0.027131833136081696, 0.0010844337521120906, 0.030895868316292763, 0.0151820732280612, -0.01446844544261694, -0.0022982999216765165, 0.013132142834365368, 0.013446979224681854, -0.008850378915667534, -0.003942441660910845, -0.015685809776186943, -0.052248720079660416, 0.002184609416872263, 0.04113851860165596, -0.035401515662670135, 0.006219752598553896, -0.015447934158146381, 0.01935189589858055, 0.030448101460933685, -0.001969471573829651, -0.006083323620259762, -0.06514998525381088, 0.014916211366653442, -0.012110676616430283, 0.04416094347834587, 0.013488956727087498, 0.025256812572479248, -0.010627451352775097, 0.0209190770983696, -0.005121326074004173, 0.025900475680828094, 0.03492576256394386, -0.009403089992702007, 0.01765877939760685, 0.014608372002840042, -0.009612980298697948, 0.03811609745025635, -0.025130877271294594, 0.0057579935528337955, 0.031259678304195404, -0.030196232721209526, 0.03411418944597244, 0.0009383850265294313, -0.012453497387468815, -0.026418205350637436, -0.03165147453546524, 0.006842427421361208, 0.017336947843432426, -0.003314519301056862, -0.06145591288805008, -0.039431411772966385, 0.059888727962970734, 0.024669120088219643, 0.009738914668560028, -0.00018026525503955781, 0.002224838361144066, 0.023353805765509605, 0.0022913035936653614, -0.051073331385850906, 0.0019414862617850304, 0.03576532378792763, -0.021059004589915276, -0.007290193345397711, -0.023619666695594788, 0.0066535258665680885, 0.03758437559008598, 0.0232278723269701, -0.020443325862288475, 0.0035506461281329393, 0.04743523150682449, 0.03864781931042671, -0.03957133740186691, 0.00845158752053976, -0.01143203116953373, 0.026166336610913277, 0.0036031187046319246, 0.006156785413622856, 0.02455717697739601, -0.00354714784771204, 0.01015869528055191, 0.04653970152139664, 0.02531278319656849, -0.02552267350256443, -0.07102691382169724, 0.0033267629332840443, 0.016777239739894867, 0.010907304473221302, -0.008584517985582352, 0.012411519885063171, -0.011082213371992111, 0.005310227163136005, -0.002107649575918913, -0.003617111360654235, 0.028293227776885033, 0.023927506059408188, 0.027089854702353477, 0.02041533961892128, 0.03934745490550995, 0.019002078101038933, -0.005376692395657301, 0.014916211366653442, 0.015531890094280243, -0.017238998785614967, -0.00012768333544954658, -0.03996313363313675, -0.017029108479619026, 0.03291081637144089, 0.018456364050507545, -0.009780893102288246, -0.005646051838994026, 0.01981365494430065, 0.01611958257853985, 0.016875188797712326, -0.010522506199777126, 0.00837462767958641, -0.008213710971176624, -0.017518851906061172, 0.008955324068665504, -0.026264285668730736, 0.02398347668349743, 0.005572590511292219, 0.006468122825026512, 0.03042011708021164, -0.0071432702243328094, -0.03128766268491745, -0.03179140016436577, 0.01817650906741619, -0.03271491825580597, -0.00019043181964661926, -0.020583253353834152, 0.02893689088523388, -0.0151820732280612, -0.02006552368402481, 0.02750963531434536, 0.036213092505931854, 0.022122448310256004, -0.0209190770983696, -0.01995358057320118, -0.004649072419852018, 0.037640348076820374, 0.046931494027376175, 0.025200841948390007, -0.006943874526768923, -0.015252036042511463, 0.0116908960044384, -0.029272714629769325, -0.02777549810707569, -0.020023545250296593, -0.03934745490550995, 0.027705533429980278, -0.009801882319152355, -0.018442369997501373, 0.0535920187830925, 0.044384825974702835, 0.017588816583156586, 0.018442369997501373, -0.00097948859911412, -0.004869457334280014, 0.04021500051021576, 0.00532072177156806, 0.01644141599535942, -0.002315790858119726, -0.009172210469841957, 0.003396726446226239, 0.010480527766048908, 0.026404213160276413, 0.013097161427140236, 0.005712517071515322, 0.01771475002169609, 0.033918291330337524, -0.010571479797363281, 0.02949659898877144, -0.03296678513288498, 0.026222309097647667, 0.014398481696844101, -0.019827647134661674, 0.00788488332182169, 0.026837985962629318, -0.01929592527449131, -0.00796184316277504, 0.0241513904184103, 0.021450798958539963, -0.0019117518095299602, -0.00760502927005291, -0.04119449108839035, 0.023927506059408188, -0.013230091892182827, -0.017029108479619026, -0.006191766820847988, 0.015601853840053082, -0.0219965148717165, 0.0030626507941633463, -0.016147568821907043, 0.02409541793167591, -0.02812531404197216, -0.03859185054898262, 0.02704787813127041, -0.0015050891088321805, -0.031175721436738968, -0.015196065418422222, -0.0421459935605526, -0.017700757831335068, -0.03436605632305145, -0.0031920832116156816, -0.022682156413793564, -0.000567578652407974, 0.01791064813733101, -0.002588648349046707, -0.008857375010848045, 0.013027197681367397, -0.014888226054608822, 0.01879218779504299, 0.0010442048078402877, -0.011040235869586468, -0.007027830462902784, -0.00581746269017458, -0.00354714784771204, -0.028615059331059456, -0.027481650933623314, 0.00760502927005291, 0.023647652938961983, 0.024767067283391953, 0.024221353232860565, 0.006803947500884533, -0.007101292256265879, -0.004372716881334782, 0.005534110590815544, 0.031175721436738968, -0.0031693452037870884, -0.00741612771525979, 0.00017162912990897894, -0.005901418626308441, 0.0216886755079031, 0.008766422979533672, 0.019841639325022697, -0.003055654466152191, 0.013586905784904957, 0.03680078312754631, 0.03923551365733147, 0.03265894576907158, -0.012992216274142265, 0.02675403095781803, 0.027733519673347473, -0.012551446445286274, 0.006705998443067074, -0.006422646343708038, -0.005380190908908844, -0.0017167286714538932, 0.009361112490296364, 0.011089209467172623, -0.0393194705247879, 0.011732873506844044, -0.00562856113538146, 0.021450798958539963, 0.006212756037712097, -0.016665298491716385, 0.0034544463269412518, -0.005848946049809456, 0.011704888194799423, 0.002635873621329665, -0.04648372903466225, -0.03419814258813858, 0.0006773338536731899, 0.005219274666160345, 0.007118782959878445, -0.019337903708219528, -0.03727653622627258, -0.007444113027304411, 0.0356253981590271, -0.013418992981314659, 0.006702500395476818, 0.024613147601485252, -0.004215299151837826, 0.004022899549454451, -0.011935767717659473, 0.00525775458663702, -0.018078560009598732, 0.006349185016006231, 0.023353805765509605, -0.0449165478348732, 0.0062477379105985165, 0.03786423057317734, 0.0393194705247879, -0.008605506271123886, 0.013020201586186886, 0.01179584115743637, -0.014538409188389778, -0.0443008691072464, 6.941687752259895e-05, 0.02573256380856037, 0.0029734475538134575, 0.045616183429956436, 0.006989350542426109, 0.023213878273963928, 0.029440628364682198, 0.0039459397085011005, -0.005100336857140064, -0.034030232578516006, 0.008892357349395752, -0.0063211992383003235, -0.001447369228117168, 0.011292103677988052, 0.004729530308395624, -0.002364765154197812, -0.022808091714978218, -0.018750209361314774, -0.006254734005779028, -0.0021968530490994453, 0.04083067923784256, 0.03352649509906769, 0.011851811781525612, 0.008206714875996113, -0.00185053376480937, 0.026516154408454895, -0.027803482487797737, 0.01110320258885622, 0.016987130045890808, -0.0024994448758661747, 0.009102247655391693, -0.027033884078264236, 0.01521005854010582, 0.015993649140000343, -0.01618954725563526, 0.002698840806260705, -0.027341723442077637, 0.008353638462722301, -0.021674683317542076, -0.0045301346108317375, 0.009214188903570175, -0.024459227919578552, 0.07214632630348206, -0.016469400376081467, 0.017211012542247772, -0.002623629989102483, -0.015154086984694004, 0.02930070087313652, -0.019072040915489197, 0.01413961686193943, -0.020905084908008575, -0.004712039604783058, -0.002364765154197812, 0.01883416622877121, -0.02332582138478756, -0.004946417175233364, 0.013943719677627087, -0.036269061267375946, -0.020303398370742798, 0.0075910366140306, -0.009661954827606678, 0.014195587486028671, 0.0071992408484220505, 0.02837718278169632, -0.009144225157797337, -0.034841809421777725, -0.015308006666600704, -0.00680044898763299, -0.004575611092150211, 0.029328687116503716, 0.02020544931292534, 0.027327731251716614, 0.0035261588636785746, -0.03598921000957489, -0.04343332350254059, -0.005240263883024454, 0.011774851940572262, 0.02766355499625206, -0.031371619552373886, 0.009745911695063114, -0.019379880279302597, 0.011005253531038761, 0.012299577705562115, -9.07885332708247e-05, -0.021828602999448776, 0.019100027158856392, -0.021254902705550194, -0.0004020713095087558, -0.01523804385215044, 0.0024224850349128246, -0.0016677541425451636, -0.02016347274184227, -0.003648594953119755, -0.005485136061906815, 0.028852934017777443, -0.031427592039108276, 0.023913513869047165, -0.027873445302248, -0.007381145842373371, 0.058265578001737595, 0.0236896313726902, 0.014972181990742683, -0.021632704883813858, -0.009941808879375458, -0.0221504345536232, 0.010144703090190887, -0.01490221917629242, -0.03456195443868637, -0.01674925535917282, -0.0031745925080031157, 0.025228826329112053, 0.0033005266450345516, 0.007062812335789204, 0.00801781378686428, -0.004358724225312471, -0.0047645121812820435, 0.0010748137719929218, 0.017938634380698204, 0.01893211528658867, 0.025592636317014694, 0.01372683234512806, 0.04362921789288521, -0.0331626832485199, -0.00010445327643537894, -0.019631749019026756, 0.03271491825580597, -0.008878364227712154, 0.005359201692044735, 0.026977913454174995, -0.022584207355976105, -0.022290362045168877, 0.018806179985404015, -0.009647962637245655, -0.004851966630667448, 0.038675807416439056, 0.015224050730466843, -0.008535543456673622, -0.021212924271821976, -0.020149478688836098, -0.007255211938172579, 0.02801337279379368, 0.019561786204576492, -0.018008597195148468, 0.0014910964528098702, -0.012768332846462727, 0.011453019455075264, 0.014944196678698063, 0.01576976664364338, -0.02797139436006546, -0.027327731251716614, 0.014069654047489166, 0.017672771587967873, -0.017015116289258003, 0.0005304105579853058, 0.015168080106377602, 0.006632537115365267, -0.008850378915667534, 0.02271014265716076, 0.0031903341878205538, 0.021604718640446663, -0.0018680245848372579, -0.035709355026483536, 0.021814608946442604, 0.008962320163846016, 0.008794408291578293, 0.010326608084142208, 0.00533471442759037, -0.019925596192479134, 0.013446979224681854, -0.021982522681355476, -0.0016476396704092622, -0.017840685322880745, 0.011362067423760891, -0.03873177617788315, 0.006457628216594458, 0.017518851906061172, 0.006580064073204994, 0.013887749053537846, 0.02598443254828453, -0.004484658595174551, -0.001353793079033494, 0.0012453497620299459, 0.004792497493326664, 0.021254902705550194, 0.004771508742123842, 0.04925428330898285, 0.0031536032911390066, -0.010417560115456581, -0.007318178657442331, -0.00502687506377697, 0.021884573623538017, -0.0233817920088768, -0.026810001581907272, -0.020793143659830093, 0.0067094964906573296, 0.02195453643798828, -0.009703933261334896, -0.011515987105667591, -0.010907304473221302, -0.01127811148762703, 0.02352171763777733, 0.019183984026312828, -0.0022825582418590784, 0.00786389410495758, -0.01688918098807335, 0.009878842160105705, 0.025200841948390007, -0.04150233045220375, -0.026782015338540077, 0.009752907790243626, 0.00801081769168377, 0.0009348868625238538, 0.0035681368317455053, 0.043153468519449234, -0.026320256292819977, 0.0021181439515203238, -0.0024154887069016695, -0.006643031258136034, -0.01462236512452364, 0.0063981590792536736, 0.0016345215262845159, 0.009773897007107735, -0.004313247743993998, -0.023185893893241882, 0.011711884289979935, 0.025690585374832153, -0.019128013402223587, 0.003102879971265793, -0.028852934017777443, 0.009060269221663475, -0.01064144354313612, -0.01893211528658867, 0.0020236934069544077, -0.021408822387456894, 0.018232479691505432, 0.01483225543051958, 0.03383433446288109, 0.02143680676817894, -0.007353160530328751, 0.050765492022037506, 0.026068389415740967, 0.02949659898877144, -0.018008597195148468, -0.0013634130591526628, 0.0022668163292109966, -0.02241629548370838, 0.020135486498475075, 0.016147568821907043, 0.011194154620170593, 0.014356504194438457, 0.001951980753801763, -0.012215621769428253, -0.0037220565136522055, -0.016861196607351303, 0.014300533570349216, 0.019533799961209297, 0.020751165226101875, -0.010277633555233479, -0.011166169308125973, 0.015573868528008461, -0.02704787813127041, -0.020555267110466957, 0.00829766783863306, 0.03198729828000069, 0.015797751024365425, 0.0020184461027383804, 0.001096677384339273, 0.012824303470551968, 0.022989995777606964, -0.001244475250132382, -0.0015610598493367434, 0.028153300285339355, -0.009445068426430225, -0.006016858387738466, 0.02373160794377327, -0.006506602745503187, 0.012390530668199062, -0.006107810884714127, 0.010228659026324749, 0.0035174135118722916, 0.01541994884610176, -0.0025606630370020866, -0.018092554062604904, 0.0035121662076562643, 0.019771676510572433, 0.03660488873720169, -0.01634346693754196, 0.054235681891441345, 0.03458993881940842, -0.0015671816654503345, -0.010963276028633118, 0.013251081109046936, -0.01974369026720524, 0.024571171030402184, -0.0063806683756411076, -0.036828771233558655, -0.0060483417473733425, -0.024431243538856506, -0.00811576284468174, -0.01618954725563526, 0.005901418626308441, 0.0017910648602992296, -0.028713008388876915, -0.018722224980592728, 0.01523804385215044, 0.012845292687416077, -0.034729864448308945, 0.03929148614406586, -0.021604718640446663, 0.03920752927660942, 0.020541274920105934, -0.020541274920105934, -0.006167280022054911, 0.00033341965172439814, -0.008136751130223274, -0.02629227191209793, 0.018708230927586555, 0.057593926787376404, 0.030280189588665962, -0.005824458785355091, 0.004579109139740467, 0.0008841633680276573, 0.05445956438779831, -0.0041593280620872974, -0.030028320848941803, -0.009591992013156414, -0.006272225175052881, 0.0068494235165417194, -0.017378926277160645, -0.018260465934872627, 0.0023595180828124285, 0.009046277031302452, 0.0034439517185091972, 0.0241513904184103, 0.013768810778856277, -0.038759760558605194, -0.01429353654384613, 0.0048414720222353935, -0.001454365672543645, -0.006915888749063015, -0.008157740347087383, 0.019337903708219528, -0.006933379918336868, -0.025956446304917336, -0.012285585515201092, 0.03934745490550995, 0.033414553850889206, 0.03612913563847542, -0.022220397368073463, 0.02429131604731083, 0.01744888909161091, 0.0215347558259964, -0.007395138498395681, 0.017336947843432426, -0.013342033140361309, -0.016777239739894867, -0.02047131024301052, 0.005275245755910873, 7.843560888431966e-05, 0.01771475002169609, -0.005177296698093414, 0.05042966827750206, -0.012754340656101704, -0.007118782959878445, 0.02068120241165161, -0.00788488332182169, 0.01868024654686451, 0.028908904641866684, -0.0016353960381820798, 0.01398569718003273, 0.037388477474451065, -0.0069473725743591785, 0.027341723442077637, -0.0026306265499442816, 0.014538409188389778, -0.0303641464561224, -0.01833042874932289, -0.014027675613760948, 0.013223095797002316, 0.021660689264535904, 0.03450598195195198, -0.036325033754110336, -0.031819384545087814, 0.008577520959079266, -0.0031221196986734867, -0.022724134847521782, -0.02721579000353813, 0.018974093720316887, -0.009564006701111794, 0.03282685950398445, -0.010193677619099617, -0.01036158949136734, 0.06677313148975372, 0.027187803760170937, 0.0071642594411969185, 0.01979966089129448, 0.032994773238897324, 0.03184737265110016, 0.005764989648014307, -0.014153609983623028, -0.013244085013866425, -0.005964385811239481, -0.04158628731966019, -0.013251081109046936, 0.038004156202077866, 0.006415650248527527, -0.0014587383484467864, 0.0024399759713560343, -0.02006552368402481, -0.011697892099618912, -0.02210845611989498, -0.05124124512076378, -0.020611237734556198, -0.0022493256255984306, 0.00738814240321517, 0.024920986965298653, -0.0380881130695343, -0.02388552762567997, -0.008976313285529613, -0.02373160794377327, 0.007346164435148239, 0.004956911783665419, 0.026977913454174995, 0.004827479366213083, 0.010739392600953579, -0.01960376463830471, -0.006751474924385548, 0.01898808591067791, -0.01781269907951355, 0.019869625568389893, 0.006209257990121841]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
"acroix, Baptiste
Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, et al.
Llama: Open and efficient foundation language models.
arXiv preprint arXiv:2302.13971 , 2023a.
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert,
Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov,
Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.
Llama 2: Open foundation and fine-tuned chat models.
arXiv preprint arXiv:2307.09288 , 2023b.
Guangxuan Xiao, Ji Lin, Mickael Seznec, Hao Wu, Julien
Demouth, and Song Han. Smoothquant: Accurate and ef-
ficient post-training quantization for large language mod-
els. In International Conference on Machine Learning ,
pages 38087–38099. PMLR, 2023a.
Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han,
and Mike Lewis. Efficient streaming language models
with attention sinks. arXiv preprint arXiv:2309.17453 ,
2023b.
Zhaozhuo Xu, Zirui Liu, Beidi Chen, Yuxin Tang, Jue Wang,
Kaixiong Zhou, Xia Hu, and Anshumali Shrivastava.
Compress, then prompt: Improving accuracy-efficiency
trade-off of llm inference with transferable prompt. arXiv
preprint arXiv:2305.11186 , 2023.
Jiayi Yuan, Ruixiang Tang, Xiaoqian Jiang, and Xia Hu.
Large language models for healthcare data augmentation:
An example on patient-trial matching. In AMIA Annual
Symposium Proceedings , volume 2023, page 1324. Amer-
ican Medical Informatics Association, 2023.
Zhenyu Zhang, Ying Sheng, Tianyi Zhou, Tianlong Chen,
Lianmin Zheng, Ruisi Cai, Zhao Song, Yuandong Tian,
Christopher Ré, Clark Barrett, et al. H _2o: Heavy-hitter
oracle for efficient generative inference of large language
models. arXiv preprint arXiv:2306.14048 , 2023.
10
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
A. Detailed Implementations
In this section, we present the algorithm for KIVI as dis-
cussed in Section 3.3. Specifically, we provide the pseu-
docode for KIVI when calculating the attention output in
the prefill and decoding phases.
Algorithm 1: TheKIVI Prefill & Decoding Algorithm
parameter: group size G, residual length R
procedure Prefill :
Input: X∈Rlprompt×d
XK=XW K,XV=XW V
XVg=XV[:lprompt−R],XVr=XV[lprompt−R:]
Q(XVg)←
GroupQuant (XVg,dim=token ,numGroup= d//G )
Q(XKg),XKr←KeyQuant (XK)
KV cache ←Q(XKg),XKr, Q(XVg),XVr
return XK,XV
end
procedure Decoding :
Input: KV cache ,t∈R1×d
tQ=tWQ,tK=tWK,tV=tWV
Q(XKg),XKr, Q(XVg),XVr←KV cache
XKr←Concat ([XKr,tK],dim=token )
XVr←Concat ([XVr,tV],dim=token )
iflen(XKr) =Rthen
Q(XKr),_←KeyQuant (XKr)
Q(XKg)←
Concat ([Q(XKg), Q(XKr)],dim=token )
XKr←empty tensor.
end
iflen(XVr)> R then
Q(XV′r)←GroupQuant (XVr[:
−R],dim=token ,numGroup =d//G )
Q(XVg)←
Concat ([Q(XVg), Q(XV′r)],dim=token )
XVr←XVr[−R:]
end
A←Concat ([tQQ(XKg)⊤,tQX⊤
Kr],dim=token )
Ag=Softmax (A)[:−R],Ar=
Softmax (A)[−R:]
tO←AgQ(XVg) +ArXVr
KV cache ←Q","[0.005141850560903549, 0.013423080556094646, 0.016212115064263344, -0.016692981123924255, -0.007439711596816778, 0.006076108198612928, 0.0037988554686307907, 0.011465261690318584, -0.05863839387893677, 0.015593855641782284, 0.0278765931725502, -0.012708649039268494, -0.050559815019369125, 0.043497927486896515, -0.007453450933098793, -0.023177826777100563, -0.0037301601842045784, -0.0193171463906765, -0.012791083194315434, 0.05259319767355919, -0.028879545629024506, -0.04621826484799385, -0.011822477914392948, 0.0361337810754776, 0.04852642863988876, -0.04687774181365967, -0.04352540522813797, 0.01135534979403019, 0.0464930459856987, -0.05289545655250549, 0.03242423012852669, -0.03624369204044342, -0.027574332430958748, -0.07012426108121872, -0.03981585428118706, 0.02593938261270523, 0.026296598836779594, 0.0036374214105308056, -0.033468399196863174, 0.009060923010110855, 0.0236724354326725, -0.06303489953279495, -0.026200424879789352, 0.0010106810368597507, 0.04160193353891373, 0.07292703539133072, 0.015415247529745102, -0.005691413767635822, -0.03506213054060936, 0.0389365516602993, -0.007913709618151188, 0.08364351838827133, -0.07644423842430115, 0.013574210926890373, 0.005310154519975185, 0.0030861408449709415, 0.011822477914392948, 0.01731124147772789, 0.02615920826792717, -0.0139382965862751, 0.009163966402411461, -0.071663036942482, -0.011300393380224705, 0.0031067493837326765, -0.029951194301247597, 0.007192408200353384, -0.04778451845049858, 0.030775539577007294, 0.007906840182840824, -0.014357338659465313, -0.03217692673206329, 0.027217118069529533, 0.020265143364667892, -0.020237663760781288, -0.027972767129540443, 0.030555713921785355, -0.004647243767976761, 0.05344501882791519, 0.031902141869068146, -0.029209284111857414, 0.02724459581077099, 0.0042316364124417305, 0.029676413163542747, -0.041492022573947906, 0.011795000173151493, -0.033798135817050934, -0.04566870257258415, 0.0380847305059433, -0.038167163729667664, -0.029676413163542747, -0.028412416577339172, 0.02168026752769947, -0.04745478183031082, -0.0003945691860280931, 0.03759012371301651, 0.02190009318292141, 0.03682073578238487, 0.0001441530039301142, 0.00967918150126934, 0.018135584890842438, 0.010585960932075977, 0.0025194038171321154, 0.06699175387620926, -0.029813803732395172, 0.039733417332172394, -0.006800844334065914, -0.017462370917201042, 0.02027888223528862, -0.025307385250926018, 0.017627239227294922, -0.05847352370619774, 0.01957818865776062, -0.01334751583635807, -0.012495692819356918, 0.005213981028646231, -0.04660296067595482, -0.04723495617508888, -0.029374152421951294, -0.038909073919057846, -0.0026980116963386536, -0.019825492054224014, 0.00392594188451767, 0.03269901126623154, -0.043717753142118454, 0.0015954506816342473, -0.023067915812134743, 0.02141922526061535, -0.06122133880853653, -0.012502562254667282, -0.009967702440917492, 0.047757040709257126, -0.0011154415551573038, 0.04250871390104294, -0.01828671619296074, -0.012145346961915493, -0.025898166000843048, -0.021597834303975105, 0.03495221957564354, -0.04162941128015518, 0.011011872440576553, 0.004836156032979488, -0.021542876958847046, -0.007721363101154566, -0.01318264752626419, -0.015071770176291466, 0.008401446975767612, -0.03860681504011154, -0.013910817913711071, -0.035089608281850815, -0.02615920826792717, -0.015676289796829224, -0.016899067908525467, -0.029676413163542747, 0.012488823384046555, -0.040365416556596756, -0.009473095647990704, -0.015717508271336555, 0.030665626749396324, 0.06435385346412659, -0.011149263009428978, -0.012468215078115463, 0.0355842150747776, 0.03574908524751663, -0.008435795083642006, 0.004015245940536261, -0.009534921497106552, -0.04550383239984512, 0.01661054790019989, -0.05102694407105446, -0.034759871661663055, 0.0038881595246493816, -0.0048705036751925945, -0.03478734940290451, -0.04586104676127434, -0.00207116617821157, -0.0417393259704113, -0.0010630612960085273, -0.027313290163874626, -0.023095393553376198, -0.05814378708600998, -0.007522146217525005, 0.06023212522268295, 0.0028680330142378807, 0.02929171733558178, -0.010984394699335098, -0.00590436952188611, -0.008703706786036491, 0.011959869414567947, -0.007075625937432051, 0.052290938794612885, -0.02890702337026596, 0.021817658096551895, 0.0963384285569191, 0.04407496750354767, 0.0313800573348999, -0.007474059239029884, 0.041766803711652756, 0.004121724050492048, 0.014151251874864101, -0.009850920177996159, 0.04138210788369179, 0.03802977129817009, -0.006677192635834217, -0.10502152889966965, 0.0341828316450119, -0.01709141582250595, -0.009218922816216946, 0.016473157331347466, -0.05586309731006622, -0.019289668649435043, 0.017723413184285164, 0.030555713921785355, 0.051796332001686096, 0.009122748859226704, -0.026791205629706383, 0.035309433937072754, -0.026090512052178383, 0.0198941882699728, -0.015374029986560345, 0.04044784978032112, -0.013423080556094646, -0.004952938295900822, 0.011314132250845432, 0.027093466371297836, -0.03294631466269493, 0.059902388602495193, 0.015992289409041405, -0.018025672063231468, 0.007645797915756702, -0.0027615551371127367, 0.06627731770277023, -0.015003074891865253, -0.02794528752565384, -0.03819464147090912, -0.009754747152328491, -0.04643809050321579, 0.004008376505225897, -0.016541851684451103, -0.00523115461692214, -0.030006149783730507, 0.0071305823512375355, 0.01459090318530798, 0.013876470737159252, 0.011108046397566795, 0.002148448722437024, 0.026777466759085655, -0.034595001488924026, -0.04838903993368149, 0.035941433161497116, -0.016802893951535225, -0.025307385250926018, -0.040805067867040634, -0.04558626562356949, 0.018836278468370438, -0.07083869725465775, -0.016253331676125526, 0.011733174324035645, 0.027491899207234383, -0.04553131014108658, 0.01963314600288868, -0.013869601301848888, -0.05448919162154198, -0.022202353924512863, 0.01596481166779995, -0.0025194038171321154, -0.010290570557117462, -0.04412992298603058, 0.041821759194135666, -0.019069842994213104, -0.022999219596385956, -0.018424106761813164, -0.0487462542951107, 0.02298548072576523, -0.01634950563311577, -0.0040289852768182755, -0.01601976715028286, 0.033633265644311905, 0.012207172811031342, -0.03539187088608742, 0.03170979768037796, -0.007171799894422293, -0.005069720558822155, 0.019124798476696014, 0.0050937640480697155, 0.017077676951885223, 0.0010252788197249174, -0.016308287158608437, -0.007638928480446339, -0.027052247896790504, -0.04256366938352585, 0.05836361274123192, 0.009603616781532764, 0.020897140726447105, -0.04245375841856003, -0.00046498197480104864, 0.03176475316286087, -0.03434769809246063, -0.011183611117303371, 0.006897018291056156, -0.021323051303625107, 0.05009268596768379, 0.011801869608461857, 0.006385237444192171, 0.016954025253653526, -0.032067012041807175, 0.04940573126077652, -0.01780584827065468, 0.006938235368579626, 0.01570376753807068, 0.01887749508023262, 0.05149407312273979, 0.028412416577339172, 0.0014700815081596375, 0.05091702938079834, -0.024661649018526077, -0.04308575391769409, 0.007783188950270414, -0.02442808449268341, 0.0253486018627882, -0.04311323165893555, 0.006388672161847353, -0.044679488986730576, -0.012722387909889221, 0.0017912324983626604, 0.030500756576657295, 0.0070412782952189445, -0.018781322985887527, -0.002725489903241396, -0.02190009318292141, -0.027752941474318504, 0.016363244503736496, 0.03338596224784851, 0.03399048373103142, 2.941021739388816e-05, -0.05748431012034416, -0.02475782111287117, -0.03926629200577736, 0.0018788191955536604, 0.010826394893229008, -0.016006028279662132, -0.0790271908044815, 0.020292621105909348, 0.011204219423234463, -8.01804126240313e-05, -0.016706721857190132, 0.02060861885547638, 0.05819874256849289, 0.021776441484689713, 0.06166099011898041, -0.020952096208930016, 0.008380838669836521, -0.05314275994896889, 0.023177826777100563, -0.033578310161828995, 0.019921666011214256, -0.006306237541139126, 0.019234711304306984, -0.014467251487076283, -0.044542096555233, 0.009452487342059612, -0.033578310161828995, 0.01764097809791565, 0.01672046072781086, -0.01215908583253622, -0.009280748665332794, -0.0068386271595954895, -0.005746370181441307, -0.0007934318855404854, 0.006316542159765959, -0.008387708105146885, 0.004403375089168549, 0.04979042708873749, -0.0324791856110096, -0.030171019956469536, -0.028220070526003838, -0.04272853955626488, 0.01564881205558777, 0.03522700071334839, 0.03344092145562172, 0.03154492750763893, 0.021226879209280014, 0.01180873904377222, 0.008428925648331642, 0.008971619419753551, 0.012653692625463009, 0.019495753571391106, 0.0018719496438279748, 0.012275868095457554, -0.028522329404950142, 0.013663514517247677, -0.02437312714755535, 0.0015499399742111564, -0.005121241789311171, 0.030171019956469536, 0.012763605453073978, 0.0019664058927446604, -0.01784706488251686, 0.03712299466133118, 0.03533691167831421, 0.06429889053106308, 0.01860271394252777, -0.009768486022949219, -0.005777283105999231, 0.003936246503144503, -0.01935836300253868, -0.002612142590805888, 0.03085797280073166, 0.03327605128288269, 0.014659598469734192, 0.008827358484268188, 0.015277856960892677, -0.03992576524615288, 0.03835951164364815, -0.05550588294863701, 0.01672046072781086, -0.020512446761131287, 0.025911904871463776, -0.017998194321990013, 0.040969934314489365, 0.07693884521722794, -0.012639953754842281, -0.014027600176632404, -0.05149407312273979, -0.06798096746206284, -0.02011401206254959, -0.009054053574800491, -0.022724438458681107, -0.06765122711658478, 0.018272975459694862, -0.037782467901706696, -0.03860681504011154, 3.662860035547055e-05, 0.027162160724401474, -0.010805786587297916, -0.01579994149506092, -0.0417393259704113, 0.006416150368750095, 0.040310461074113846, 0.005251763388514519, -0.04363531619310379, -0.023878520354628563, -0.01710515469312668, -0.03602386638522148, 0.008545707911252975, -0.0095967473462224, 0.027313290163874626, -0.011176741681993008, -0.008985358290374279, 0.040695153176784515, -0.045338962227106094, 0.03019849769771099, 0.02771172486245632, 0.048883646726608276, 0.012646823190152645, 0.034924741834402084, -0.062430378049612045, 0.0750703290104866, -0.00023077361402101815, 0.02038879506289959, -0.00390876829624176, 0.009459356777369976, 0.026200424879789352, -0.024950169026851654, -0.0029607717879116535, 0.017132632434368134, 0.030445801094174385, 0.01046230923384428, 0.018108107149600983, 0.012839170172810555, 0.016528112813830376, -0.03868924826383591, -0.06693679839372635, 0.005540283862501383, -0.02496390789747238, -0.01769593544304371, 0.004485809709876776, 0.0417393259704113, -0.03684821352362633, -0.015374029986560345, -0.009177705273032188, 0.015071770176291466, -0.024469301104545593, 0.016198374330997467, 0.003805725136771798, 0.014824466779828072, 0.06820078939199448, 0.011650740168988705, -0.029841281473636627, 0.03932124748826027, -0.0026791205164045095, 0.0011600935831665993, -0.010235614143311977, 0.01618463546037674, -0.01655559055507183, 0.028769632801413536, 0.02621416375041008, -0.011307262815535069, -0.011293523944914341, 0.015442726202309132, -0.040585242211818695, 0.032121967524290085, 0.004849895369261503, 0.03360578790307045, 0.020938357338309288, 0.0017422870732843876, 0.013505515642464161, 0.05863839387893677, 0.0031187711283564568, 0.020800966769456863, 0.04140958562493324, 0.025870688259601593, -0.012633084319531918, -0.010833264328539371, 0.005505936220288277, -3.405252573429607e-05, 0.04531148448586464, -0.0142886433750391, 0.012639953754842281, -0.014851945452392101, 0.01683037355542183, -0.017462370917201042, -0.00855257734656334, 0.01256438810378313, -0.0389365516602993, 0.01259186677634716, 0.021762702614068985, -0.03426526486873627, -0.08875445276498795, -0.016802893951535225, -0.03954107314348221, 0.034869786351919174, -0.01634950563311577, -0.024675387889146805, 0.005430371500551701, -0.026653815060853958, -0.021007053554058075, -0.011616392061114311, -0.018959930166602135, -0.009974571876227856, 0.010160049423575401, -0.008353360928595066, 0.01742115244269371, -0.005873456597328186, 0.03577656298875809, -0.0025880991015583277, -0.0013618862722069025, 0.02508755959570408, -0.03802977129817009, -0.011740043759346008, 0.0383869893848896, 0.02501886524260044, -0.032973792403936386, 0.0033866832964122295, -0.04168436676263809, -0.009589877910912037, 0.019729318097233772, 0.0030002715066075325, 0.026832422241568565, -0.029841281473636627, 0.0010768003994598985, 0.050285033881664276, 0.009095271117985249, 0.0018564931815490127, -0.013464298099279404, -0.03775499016046524, -0.01515420526266098, 0.01893245242536068, -0.002952184760943055, 0.015896115452051163, 0.033083703368902206, -0.02794528752565384, -0.024469301104545593, 0.029951194301247597, -0.0046232002787292, 0.018204281106591225, -0.023205306380987167, 0.01978427544236183, 0.02291678451001644, 0.017668455839157104, 0.032067012041807175, -0.03410039469599724, -0.01854775846004486, 0.001209039008244872, -0.03517204523086548, -0.0375351645052433, 0.019399581477046013, -0.0004113136965315789, 0.022669481113553047, -0.02789033204317093, 0.011527087539434433, 0.027258334681391716, -0.01757228374481201, -0.015360291115939617, 0.0007938612252473831, -0.05176885426044464, -0.009136487729847431, 0.003812594572082162, -0.04184923693537712, -0.040530286729335785, -0.008518229238688946, 0.02670877054333687, 0.019179755821824074, 0.0011059959651902318, 0.010956916026771069, -0.014096295461058617, 0.01909732073545456, -0.025801992043852806, 0.006392106879502535, 0.013368125073611736, -0.020897140726447105, 0.008744924329221249, -0.02383730374276638, 0.0012408106122165918, -0.02772546373307705, -0.050834596157073975, -0.023274000734090805, -0.03170979768037796, -0.03261657431721687, 0.03921133279800415, -0.039678461849689484, 0.022298526018857956, -0.04816921427845955, 0.0047983736731112, 0.0062753246165812016, 0.009383791126310825, 0.04162941128015518, -0.025870688259601593, -0.03596891090273857, -0.036271169781684875, 0.004527026787400246, -0.037617601454257965, -0.009521182626485825, 0.006124194711446762, 0.014893162995576859, -0.003881290089339018, -0.001683895941823721, 0.013787166215479374, -0.014261164702475071, 0.008580055087804794, -0.02064983732998371, 0.039458636194467545, 0.012406389228999615, 0.027409464120864868, -0.03434769809246063, 0.04902103543281555, 0.0034433568362146616, 0.011829347349703312, 0.03712299466133118, -0.012749865651130676, -0.011575174517929554, -0.017544804140925407, -0.03275396674871445, 0.021103227511048317, 0.02282061241567135, 0.03563917428255081, -0.02789033204317093, -0.014274903573095798, -0.0015499399742111564, -0.015195421874523163, 0.004911721218377352, -0.04750973731279373, -0.022779393941164017, -0.011753782629966736, -0.0037782469298690557, 0.015112987719476223, 0.028494851663708687, 0.005114372354000807, 0.0280002448707819, -0.009802833199501038, 0.0070412782952189445, 0.021336790174245834, 0.02092461846768856, 0.030830495059490204, -0.02027888223528862, 0.011540827341377735, -0.019674362614750862, -0.004389636218547821, -0.018080629408359528, 0.002155318157747388, 0.014027600176632404, -0.04077759012579918, 0.007508407346904278, -0.07050895690917969, -0.02221609279513359, 0.000889605435077101, -0.015470203943550587, 0.04709756746888161, -0.011664479039609432, -0.004647243767976761, -0.04146454483270645, 0.0022549263667315245, -0.009163966402411461, 0.00757710263133049, -0.023232784122228622, -0.0036442908458411694, 0.0014898314839228988, 0.003932811785489321, 0.03926629200577736, -0.019715579226613045, -0.056989703327417374, -0.01769593544304371, 0.0024249476846307516, -0.04303079843521118, -0.0030998799484223127, -0.050339989364147186, -0.014618380926549435, -0.046190787106752396, 0.034979697316884995, 0.053747281432151794, -0.024840256199240685, -0.012255258858203888, -0.0015559508465230465, -0.0038469424471259117, 0.03242423012852669, -0.02868719957768917, 0.016816632822155952, 0.03236927092075348, 0.011128654703497887, 0.015525160357356071, -0.018300455063581467, -0.04278349503874779, 0.010359265841543674, -0.03514456748962402, -0.009040314704179764, 0.021075747907161713, 0.0035481173545122147, -0.01854775846004486, 0.015071770176291466, 0.026076773181557655, 0.03143501654267311, 0.006893583107739687, 0.001317234244197607, 0.019427059218287468, -0.03748020902276039, -0.042426276952028275, 0.007267973385751247, -0.0355842150747776, -0.015222900547087193, -0.04396505653858185, -0.02103453129529953, -0.033688224852085114, -0.024345649406313896, 0.015209161676466465, 0.04239879921078682, 0.016954025253653526, 0.006739018484950066, 0.01385586243122816, 0.02636529505252838, -0.008380838669836521, -0.02103453129529953, -0.027766680344939232, 0.012083521112799644, -0.007017234805971384, -0.012310215272009373, 0.025211211293935776, -0.02249087393283844, 0.03467743843793869, -0.02433191053569317, -0.022408438846468925, 0.008044231683015823, 0.003008858533576131, -0.008999097160995007, 0.010606569238007069, 0.03231431543827057, 0.014013861306011677, -0.019069842994213104, -0.009926484897732735, -0.01135534979403019, -0.001368755823932588, -0.0006229814025573432, -0.023699913173913956, -0.009157096967101097, 0.013271951116621494, 0.0242219977080822, 0.01812184602022171, -0.040914978832006454, 0.0045819832012057304, -0.01644567772746086, -0.01952323317527771, 0.028934502974152565, 0.005554023198783398, -0.005873456597328186, -0.0073023210279643536, -0.05132920295000076, -0.007281712256371975, -0.014522206969559193, -0.02053992450237274, -0.0020213620737195015, -0.011554566211998463, -0.021666528657078743, -0.011616392061114311, -0.018863756209611893, -0.014219948090612888, 0.004169810563325882, 0.0002651213144417852, 0.01294221356511116, -0.007364146877080202, -0.08782019466161728, -0.041821759194135666, 0.013093343004584312, 0.03440265730023384, 0.027038509026169777, -0.004362158011645079, -0.02394721657037735, -0.014412295073270798, 0.01699524186551571, -0.036216214299201965, 0.005303284619003534, 0.0008745783125050366, 0.026447728276252747, -0.020636098459362984, 0.0014374512247741222, -0.053637366741895676, 0.00655354093760252, -0.010173788294196129, 0.04487183317542076, -0.009912746027112007, -0.027313290163874626, 0.006584453862160444, -0.0023734259884804487, 0.03943115845322609, -0.01655559055507183, -0.007419103290885687, 0.002935010939836502, 0.004513287916779518, 0.003056945279240608, 0.008209099993109703, -0.012021695263683796, -0.01534655224531889, 0.014535946771502495, 0.03866177052259445, -0.03877168148756027, 0.005454414524137974, -0.01823175884783268, 0.00672871433198452, 0.026406511664390564, -0.02260078676044941, 0.0031599884387105703, -0.06352950632572174, 0.004135462921112776, -0.01062030903995037, 0.03591395542025566, -0.004420549143105745, 0.03085797280073166, 0.007687014993280172, 0.008607533760368824, -0.028357461094856262, 0.0029745108913630247, 0.05286797881126404, 0.0011506479931995273, 0.030116062611341476, 0.008635011501610279, 0.009672312065958977, 0.026063034310936928, -0.0012854626402258873, -0.0012597019085660577, 0.013196386396884918, -0.015415247529745102, 0.012014824897050858, 0.003682073438540101, -0.01022187527269125, -0.039073944091796875, -0.042041584849357605, 0.006587888579815626, 0.04140958562493324, 0.007597710937261581, -0.062320467084646225, -0.017558544874191284, 0.03360578790307045, -0.02756059356033802, -0.005955891218036413, 0.022051222622394562, 0.0009677464258857071, 0.017723413184285164, 0.02670877054333687, -0.047702085226774216, 0.03673829883337021, 0.019124798476696014, -0.02433191053569317, 0.0060726734809577465, -0.001834167167544365, 0.00540632801130414, 0.03300127014517784, 0.04544887691736221, -0.01731124147772789, -0.01937210187315941, 0.046190787106752396, 0.0417393259704113, -0.037672556936740875, 0.005739500746130943, -0.01318264752626419, 0.04660296067595482, 0.000350775895640254, 0.006113890558481216, 0.025980599224567413, -0.0012931908713653684, 0.004399940371513367, 0.04718000069260597, 0.03951359540224075, 0.009459356777369976, -0.06754131615161896, -0.0025760773569345474, -0.0023545348085463047, -0.003077553818002343, -0.0004697047988884151, 0.03737029805779457, -0.04072263091802597, -0.009850920177996159, 0.021171921864151955, -0.0034261830151081085, 0.025692079216241837, -0.01596481166779995, 0.04380018636584282, 0.021913832053542137, 0.017888281494379044, 0.022559568285942078, -0.02551347203552723, -0.021130705252289772, 0.030830495059490204, -0.007151191122829914, -0.034540046006441116, -0.021913832053542137, -0.02636529505252838, 0.020251404494047165, 0.04542139917612076, -0.006206629332154989, 0.0036030737683176994, 0.005303284619003534, -0.00314796669408679, 0.015112987719476223, -0.004722808487713337, -0.007467189803719521, -0.013752819038927555, -0.024098346009850502, -0.0009230944560840726, -0.01823175884783268, -0.00394998537376523, 0.011973608285188675, 0.013127691112458706, 0.0498453825712204, -0.018726365640759468, -0.031050320714712143, 0.0023356436286121607, 0.023988433182239532, -0.04292088374495506, -0.014769511297345161, -0.006168846972286701, 0.01716011017560959, -0.013512385077774525, 0.014082556590437889, 0.013416211120784283, 0.007281712256371975, 0.012049173004925251, -0.02389225922524929, -0.043607838451862335, 0.01720132865011692, 0.04580609127879143, 0.05451666936278343, 0.03511708974838257, -0.005358241032809019, -0.008628142066299915, 0.030061107128858566, -0.01694028452038765, -0.001138626248575747, -0.01764097809791565, -0.013512385077774525, 0.02319156751036644, -0.009651703760027885, 0.014467251487076283, 0.032012056559324265, 0.02269696071743965, 0.0029659238643944263, 0.03871672600507736, 0.013168907724320889, -0.018479062244296074, 0.03726038336753845, 0.01563507318496704, 0.009562399238348007, 0.007968666031956673, -0.0005787587142549455, -0.004636939615011215, 0.02221609279513359, 0.01639072224497795, 0.014906901866197586, -0.008044231683015823, 0.02907189354300499, 0.03030841052532196, 0.026310337707400322, 0.019399581477046013, -0.02636529505252838, 0.023686174303293228, 0.03635360673069954, -0.01893245242536068, 0.004722808487713337, 0.029758846387267113, -0.002495360327884555, 0.01834167167544365, -0.007487798575311899, 0.021776441484689713, -0.025334862992167473, -0.014508468098938465, -0.034869786351919174, 0.020581141114234924, -0.013526123948395252, 0.0015954506816342473, 0.010956916026771069, 0.015717508271336555, -0.03731534257531166, -0.020842183381319046, -0.01612967997789383, 0.03572160750627518, -0.005323893390595913, -0.045009225606918335, 0.013100212439894676, 0.012605605646967888, -0.02907189354300499, -0.030665626749396324, -0.008944140747189522, -0.008497620932757854, -0.040420372039079666, 0.017022719606757164, -0.028302503749728203, -0.016899067908525467, 0.004046158865094185, -0.016583070158958435, 0.015978550538420677, 0.019138537347316742, -0.0062787593342363834, 0.027368247509002686, -0.0037645078264176846, -0.018575236201286316, -0.022738177329301834, -0.003554987022653222, -0.013086473569273949, -0.025224950164556503, -0.015923593193292618, 0.004042724147439003, 0.042206455022096634, 0.031627360731363297, 0.003919072449207306, 0.009342574514448643, -0.0030689670238643885, -0.006818018388003111, -0.005708587821573019, 0.04979042708873749, -0.00410111527889967, -0.007989275269210339, -0.008016753010451794, -0.016899067908525467, 0.020196447148919106, -0.009390661492943764, 0.014439772814512253, -0.011952999047935009, 0.03338596224784851, 0.0383869893848896, 0.019990360364317894, 0.018424106761813164, -0.01291473489254713, 0.02168026752769947, 0.02588442713022232, -0.018163062632083893, -0.002651642309501767, -0.02282061241567135, -0.009624225087463856, 0.00627188989892602, 0.014219948090612888, 0.018520278856158257, -0.01655559055507183, 0.019166016951203346, 0.009974571876227856, 0.04676782712340355, -0.002148448722437024, -0.0073435381054878235, -0.005983369424939156, -0.015291595831513405, 0.027478160336613655, -0.015951070934534073, -0.03344092145562172, -0.013526123948395252, -0.02664007619023323, -0.0032269663643091917, 0.01334751583635807, -0.005392588675022125, -0.031215189024806023, -0.01156830508261919, 0.03129762411117554, -0.003630551742389798, 0.018135584890842438, 0.04402001202106476, -0.008799880743026733, 0.007206147536635399, 0.01013944111764431, -0.0011609522625803947, 0.006302802823483944, -0.008291535079479218, 0.014714554883539677, -0.025705818086862564, 0.0285772867500782, 0.03135257959365845, 0.01534655224531889, 0.008614403195679188, 0.004396505653858185, 0.04028298333287239, 0.012495692819356918, -0.023590000346302986, -0.0051315464079380035, 0.02038879506289959, -0.006859235465526581, 0.036710821092128754, 0.030280932784080505, 0.01013944111764431, 0.011114915832877159, -0.010043267160654068, -0.009610486216843128, -0.04701513051986694, -0.00011721152259269729, -0.023603739216923714, -0.009095271117985249, 0.013952035456895828, -0.006601627916097641, -0.012584997341036797, -0.012234650552272797, -0.043662793934345245, 0.002157035516574979, 0.003381530987098813, 0.020622359588742256, 0.008834227919578552, 0.04580609127879143, 0.01834167167544365, 0.015717508271336555, 0.015978550538420677, -0.0352819561958313, 0.012117868289351463, -0.017627239227294922, -0.0029830976855009794, 0.010695873759686947, -0.0011180175933986902, 0.025224950164556503, 0.017558544874191284, -0.00981657300144434, -0.01757228374481201, -0.03030841052532196, -0.0038709857035428286, -0.005152154713869095, 0.01817680336534977, -0.00041668053017929196, -0.012681170366704464, 0.07237747311592102, -0.020787227898836136, -0.007006930653005838, -0.004022115841507912, -0.0076045808382332325, 0.042371321469545364, -0.00336435716599226, 0.006872974801808596, -0.039486113935709, 0.012495692819356918, -0.007075625937432051, 0.019674362614750862, -0.0070893652737140656, 0.02416704222559929, 0.009335705079138279, -0.04990033805370331, 0.007707623764872551, 0.026337815448641777, 0.015085509978234768, 0.00698632188141346, 0.01904236525297165, -0.0017482979455962777, -0.004499548580497503, -0.029374152421951294, -0.015016814693808556, 0.003579030279070139, -0.013416211120784283, 0.028412416577339172, 0.03833203390240669, 0.059572651982307434, 0.005492197349667549, -0.023397652432322502, -0.04946068674325943, -0.013498646207153797, 0.015071770176291466, 0.0324791856110096, -0.030225975438952446, 0.003261314006522298, 0.004338114522397518, -0.004015245940536261, -0.006010847631841898, 0.023232784122228622, -0.016692981123924255, 0.011389696970582008, -0.01526411809027195, -0.013581080362200737, -0.016431938856840134, 0.005361675750464201, 0.007735101971775293, 0.0015868637710809708, -0.00935631338506937, 0.004499548580497503, 0.03629864752292633, -0.028989458456635475, 0.011403435841202736, -0.055313535034656525, -0.01699524186551571, 0.038964029401540756, 0.005413197446614504, 0.020952096208930016, -0.04146454483270645, -0.017819587141275406, -0.01564881205558777, 0.00459915678948164, -0.004379331599920988, -0.028879545629024506, -0.0034141612704843283, 0.006811148952692747, -0.001024420140311122, 0.025609644129872322, -0.020457489416003227, 0.012303345836699009, 0.007048147730529308, 0.0005306719685904682, 0.007425972726196051, 0.017215067520737648, -0.0017027872381731868, 0.02643398940563202, 0.012282737530767918, 0.05446171388030052, -0.004211028106510639, 0.007274842821061611, -0.0236724354326725, 0.0020299491006881, 0.008779272437095642, 0.014302382245659828, 0.048306602984666824, -0.021487921476364136, -0.004121724050492048, 0.007453450933098793, -0.028824590146541595, 0.0023081654217094183, 0.037672556936740875, -0.0026739684399217367, -0.011740043759346008, -0.014783250167965889, 0.018025672063231468, -0.00038684095488861203, 0.022628264501690865, -0.004867068957537413, -0.02125435695052147, -0.010833264328539371, 0.018808800727128983, -0.009232661686837673, 0.019729318097233772, 0.015483942814171314, -0.05814378708600998, -0.007954927161335945, 0.025870688259601593, 0.022738177329301834, 0.003963724710047245, -0.04311323165893555, 0.006031455937772989, 0.01628080941736698, -0.0061997598968446255, 0.023960955440998077, -0.02685990184545517, 0.024730343371629715, 0.001962970942258835, -0.026873640716075897, 0.013196386396884918, 0.005691413767635822, 0.007494668010622263, 0.02372739091515541, -0.0031067493837326765, 0.00204197084531188, 0.005224285181611776, -0.005578066222369671, -0.00822283886373043, -0.02582946978509426, -0.0057738483883440495, -0.02809641882777214, 0.0008565457537770271, 0.012763605453073978, 0.021474182605743408, 0.019289668649435043, 0.019591927528381348, -0.03267153352499008, -0.005186502821743488, -0.004465200938284397, -0.0053067198023200035, 0.02108948677778244, 0.007838144898414612, 0.04459705203771591, 0.0051727634854614735, -0.007920579984784126, -0.004877373576164246, 0.010936307720839977, 0.02330148033797741, -0.02588442713022232, -0.01672046072781086, 0.0046232002787292, -0.015374029986560345, 0.008861706592142582, 0.009644834324717522, 0.005330762825906277, -0.015923593193292618, 0.005667370278388262, 0.015951070934534073, 0.011252306401729584, 0.02238096110522747, 0.02055366337299347, 0.017242545261979103, 0.0036580299492925406, 0.03926629200577736, -0.020636098459362984, -0.026255382224917412, 0.0038469424471259117, 0.010276831686496735, -5.393662286223844e-05, -0.0055128056555986404, 0.03536439314484596, -0.018918713554739952, -0.01024935394525528, 0.0016890481347218156, -0.0075564938597381115, -0.022037483751773834, 0.022848090156912804, 0.017283761873841286, -0.0014572012005373836, -0.025362340733408928, -0.02016896940767765, 0.009850920177996159, 0.014096295461058617, -0.015181683003902435, 0.006601627916097641, 0.0073435381054878235, 0.012145346961915493, -0.028439896181225777, -0.008277795277535915, 0.01397264376282692, 0.004801808390766382, 0.021323051303625107, 0.005213981028646231, 0.02151539921760559, 0.009239531122148037, 0.015181683003902435, 0.049323298037052155, 0.03844194486737251, 0.019399581477046013, -0.025389820337295532, -0.026186686009168625, 0.01270177960395813, -0.02374112978577614, 0.03338596224784851, 0.0063646286725997925, 0.005444110371172428, 0.009177705273032188, -0.0058116307482123375, -0.016033506020903587, 0.000952289963606745, -0.008806750178337097, 0.01570376753807068, 0.03289135545492172, 0.00015585268556606025, 0.0025039473548531532, -0.003572160843759775, 0.0004911721334792674, -0.024510517716407776, -0.0177921075373888, 0.0059868041425943375, 0.025417298078536987, 0.00876553263515234, -0.002382013015449047, 0.01747610978782177, 0.0002537436375860125, -0.006821453105658293, 0.010407352820038795, -0.002866315422579646, 0.022587047889828682, 0.0067424532026052475, 0.015483942814171314, 0.01683037355542183, -0.012550649233162403, 0.0007934318855404854, -0.003379813628271222, -0.0005740359192714095, -0.0013266799505800009, 0.003204640466719866, 0.0324791856110096, -0.002825098345056176, 0.012234650552272797, 0.005722326692193747, -0.008916663005948067, -0.012811691500246525, 0.033358484506607056, 0.0068283225409686565, 0.0008303556242026389, -0.013491776771843433, 0.026626337319612503, -0.003932811785489321, 0.017544804140925407, -0.00855257734656334, -0.03566665202379227, -0.008724316023290157, -0.04272853955626488, -0.03047327883541584, -0.015140466392040253, 0.009012836031615734, 0.023823564872145653, -0.02302669733762741, 0.009459356777369976, -0.004846460185945034, 0.00366833433508873, -0.010201266966760159, 0.022779393941164017, -0.020732272416353226, 0.03456752374768257, 0.01629454828798771, -0.015607594512403011, -0.005890630651265383, 0.009239531122148037, -0.020842183381319046, -0.01318264752626419, 0.034814827144145966, 0.03275396674871445, 0.02190009318292141, -0.016954025253653526, -0.0045785484835505486, -0.020292621105909348, 0.03014354035258293, -0.009837181307375431, -0.01656932942569256, -0.009390661492943764, 0.011444653384387493, 0.013450559228658676, -0.024235736578702927, -0.0024524256587028503, -0.020155230537056923, 0.022518351674079895, 0.018135584890842438, 0.010496657341718674, 0.023095393553376198, -0.02086966298520565, -0.005371980369091034, 0.02503260411322117, 0.017132632434368134, -0.0026585119776427746, 0.003702681977301836, 0.018300455063581467, -0.01994914375245571, -0.02940163016319275, -0.011066828854382038, 0.016692981123924255, 0.012791083194315434, 0.03877168148756027, -0.02179018035531044, 0.04572365805506706, -0.027862854301929474, 0.03797481581568718, -0.015003074891865253, -0.004496113862842321, -0.01579994149506092, -0.005571196787059307, -0.003240705467760563, 0.007364146877080202, -0.012227781116962433, -0.0024318171199411154, -0.0019904491491615772, 0.05572570860385895, -0.005629587918519974, -0.003330009523779154, 0.0025348602794110775, -0.016679242253303528, 0.03662838786840439, -0.01041422225534916, 0.012633084319531918, -0.0036339866928756237, 0.039128899574279785, 0.010235614143311977, 0.017558544874191284, -0.0050078947097063065, 0.024441823363304138, -0.019811753183603287, -0.012921604327857494, -0.009232661686837673, 0.0029075327329337597, 0.03253414109349251, 0.039403680711984634, -0.002507382072508335, -0.01618463546037674, -0.008353360928595066, -0.00733666867017746, -0.02567834034562111, -0.023919738829135895, 0.005069720558822155, -0.03737029805779457, 0.014494729228317738, -0.0191934946924448, -0.00475715659558773, 0.03635360673069954, 0.04000820219516754, -0.0007942905649542809, 0.024675387889146805, 0.047702085226774216, 0.018163062632083893, 0.005626153200864792, -0.012214042246341705, -0.01764097809791565, -0.011424045078456402, -0.020594879984855652, 0.0036236823070794344, 0.04682278260588646, 0.0007681004353798926, 0.013553602620959282, 0.0124613456428051, -0.04913095012307167, -0.017215067520737648, -0.01289412658661604, -0.043662793934345245, -0.01097752433270216, 0.017338719218969345, 0.02566460147500038, 0.030665626749396324, -0.013368125073611736, -0.019234711304306984, -0.012523171491920948, -0.0006534649874083698, -0.00844266451895237, 0.0001736705598887056, 0.033358484506607056, -0.028082679957151413, 0.021446703001856804, -0.02269696071743965, -0.0009926485363394022, 0.011204219423234463, 0.00820223055779934, 0.01248195394873619, -0.009218922816216946]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
"(XKg),XKr, Q(XVg),XVr
return tO
end
function KeyQuant (XK∈Rl×d):
r=l%R,
XKg=XK[:l−r],XKr=XK[l−r:]
Q(XKg)←
GroupQuant (XKg,dim=channel ,numGroup= l//G)
return Q(XKg),XKr
endB. More Experimental Results
In our efficiency evaluation, we observe that with a residual
length of 32, KIVI achieves a significantly higher memory
compression rate, which in turn leads to increased through-
put. Additionally, our ablation study reveals that changing
the residual length from 128 to 32 does not result in a sub-
stantial performance gap. We demonstrate KIVI with a
residual length of 32 across all benchmark datasets. As
shown in Tables 6 and 7, KIVI with a residual length of 32
also delivers performance comparable to that of the 16-bit
full model.
Table 6: Performance comparison between 16bit, KIVI-2
(2bit) / KIVI-4 (4bit) with residual length 128 and 32
across various models. R32stands for residual length 32.
Model CoQA TruthfulQA GSM8K
Llama-2-7B16bit 63.88 30.76 13.50
KIVI-2 R128 63.05 33.95 12.74
KIVI-2 R32 62.85 33.01 13.57
Llama-2-13B16bit 66.37 29.53 22.67
KIVI-2 R128 66.23 29.84 20.77
KIVI-2 R32 66.57 29.35 20.62
Falcon-7B16bit 59.83 23.20 4.55
KIVI-4 R128 59.67 22.58 4.47
KIVI-4 R32 59.73 22.96 3.94
KIVI-2 R128 57.48 24.98 3.41
KIVI-2 R32 57.50 25.70 2.20
Mistral-7B16bit 67.40 30.45 38.36
KIVI-2 R128 66.35 32.17 36.01
KIVI-2 R32 65.90 31.21 34.34
11
KIVI : A Tuning-Free Asymmetric 2bit Quantization for KV Cache
Table 7: Performance evaluation of KIVI with residual length 128 and 32 on various models across a range of benchmarks
in LongBench. R32stands for residual length 32.
Model Qasper QMSum MultiNews TREC TriviaQA SAMSum LCC RepoBench-P Average
Llama2-7B16bit 9.52 21.28 3.51 66 87.72 41.69 66.66 59.82 44.52
KIVI-2 R128 9.31 20.5 1.14 66 87.42 42.71 66.88 60.23 44.27
KIVI-2 R32 9.26 20.53 0.97 66 87.42 42.61 66.22 59.67 44.08
Llama2-13B16bit 9.32 21.38 3.71 70 87.87 43.55 66.61 56.42 44.85
KIVI-2 R128 8.58 20.69 6.19 69.5 87.78 44.3 65.08 55.46 44.69
KIVI-2 R32 8.38 20.74 7.01 69.5 87.78 44.43 64.89 55.31 44.75
Llama2-7B-Chat16bit 19.65 20.54 26.36 63 84.28 41.12 59.75 52.93 45.95
KIVI-2 R128 19.32 20.46 25.48 63 84.84 40.6 58.71 52.97 45.","[0.011596394702792168, 0.021786296740174294, 0.03536326438188553, -0.025115953758358955, 0.0021276799961924553, 0.004786383360624313, 0.014667716808617115, -0.01491170097142458, 0.0162320826202631, 0.025474753230810165, 0.029019691050052643, 0.021987223997712135, -0.044117968529462814, 0.03444473817944527, 0.02118351310491562, -0.01564365066587925, 0.01590198650956154, -0.014753828756511211, -0.04305592179298401, 0.05465231463313103, -0.0031843441538512707, -0.04739021509885788, 0.0051308306865394115, 0.015356611460447311, 0.03697068244218826, -0.0516384020447731, -0.04477815702557564, -0.019116828218102455, 0.04704577103257179, -0.08370070904493332, 0.013002888299524784, -0.02213074266910553, -0.019576091319322586, -0.0794525295495987, -0.02802940458059311, 0.03263638913631439, 0.0020325982477515936, -0.001366128446534276, -0.013598495163023472, 0.005755141377449036, 0.01997794769704342, -0.019217291846871376, -0.04624205827713013, -0.0011598188430070877, 0.04104664549231529, 0.001391244470141828, -0.02271917462348938, -0.03671234846115112, -0.005521921906620264, 0.05290137603878975, -0.02304926887154579, 0.07262098789215088, -0.037142906337976456, 0.017164960503578186, 0.013957294635474682, 0.019547387957572937, 0.014868644997477531, -0.007872057147324085, 0.04325684905052185, -0.0444624125957489, 0.013892710208892822, -0.060909777879714966, 0.015988098457455635, -0.02115480974316597, -0.027039118111133575, 0.017035793513059616, -0.023838628083467484, 0.02056637778878212, 0.015557539649307728, -0.024441411718726158, -0.027943292632699013, 0.049284677952528, 0.01851404644548893, 0.01028318889439106, 0.0013876564335078, 0.01961914822459221, 0.013218168169260025, 0.0033278639893978834, 0.022173799574375153, -0.04408926144242287, 0.010957731865346432, 0.006207228638231754, 0.03754476457834244, -6.615362508455291e-05, 0.04041515663266182, -0.011919314041733742, -0.02050897106528282, -0.015083923935890198, -0.044318895787000656, -0.01961914822459221, -0.060967184603214264, 0.017724687233567238, -0.022188151255249977, 0.00516671035438776, 0.042883697897195816, -0.018040431663393974, 0.03217712417244911, -0.030368776991963387, -0.030340071767568588, 0.0180547833442688, 0.005138006526976824, 0.036052156239748, 0.04397444799542427, -0.008094512857496738, 0.04512260481715202, 0.01584457978606224, -0.015327908098697662, 0.017724687233567238, -0.042682770639657974, -0.00978086981922388, -0.02718263864517212, -0.004398880060762167, -0.04371611028909683, 0.012557976879179478, -0.020652489736676216, -0.027785420417785645, -0.06205793470144272, -0.028990985825657845, -0.025890961289405823, -0.027584493160247803, -0.01874367706477642, -0.0019518684130162, 0.04173554107546806, -0.029034042730927467, 0.003037236398085952, -0.02630716748535633, 0.0349327027797699, -0.05069117248058319, -0.022058984264731407, -0.04833744838833809, 0.05379119887948036, -0.009457950480282307, 0.08329885452985764, 0.011144307442009449, 0.022302966564893723, 0.014280213974416256, -0.014624660834670067, 0.030368776991963387, -0.03157434239983559, -0.017222369089722633, -0.036913275718688965, -0.02731180563569069, -0.01746635138988495, 0.0046105715446174145, -0.009257023222744465, 0.034473441541194916, -0.03582252562046051, -0.012902424670755863, -0.01815524697303772, -0.01100078783929348, -0.00610317662358284, 0.00423024408519268, -0.054422684013843536, -0.01613161899149418, -0.03823365643620491, 0.008295441046357155, -0.003049794351682067, 0.014366325922310352, 0.03490399941802025, -0.00560803385451436, -0.008381552994251251, 0.009213967248797417, 0.03464566543698311, -0.009608645923435688, -0.03918088972568512, -0.009034567512571812, -0.035966046154499054, 0.0050913626328110695, -0.08915445953607559, -0.017581168562173843, 0.02848866768181324, -0.003943204879760742, -0.009156559593975544, -0.06590425968170166, 0.007943817414343357, -0.02261871099472046, -0.01013966929167509, 0.008955631405115128, 0.0028004287742078304, -0.013275575824081898, -0.025905312970280647, 0.040013302117586136, 0.013433447107672691, 0.03504751995205879, -0.009910037741065025, -0.03806143254041672, -0.017968671396374702, 0.022891398519277573, -0.004653627518564463, 0.007150870747864246, -0.015098276548087597, 0.048452261835336685, 0.0744580402970314, 0.06102459132671356, 0.035478077828884125, -0.000780837086495012, 0.009838277474045753, -0.0029600944835692644, -0.027168286964297295, 0.015112628228962421, 0.008245209231972694, 0.010828563943505287, 0.03387065604329109, -0.08054327964782715, 0.013849654234945774, -0.020752953365445137, 0.005285114515572786, 0.013146407902240753, -0.07956734299659729, 0.012041306123137474, 0.036884572356939316, 0.03573641553521156, 0.029651178047060966, -0.011022315360605717, -0.0015975540736690164, 0.010340596549212933, -0.0419938750565052, 0.03490399941802025, -0.022159447893500328, 0.04305592179298401, 0.012708672322332859, 0.0062682246789336205, -0.01085726823657751, 0.026264112442731857, -0.03800402581691742, 0.05330323055386543, 0.018026078119874, -0.0065696160309016705, -0.008295441046357155, -0.049198564141988754, 0.049600422382354736, -0.007240570615977049, -0.04164942726492882, -0.012701496481895447, 0.00524923438206315, -0.04733280837535858, 0.001126629882492125, -0.01643300987780094, -0.030856743454933167, -0.024886323139071465, 0.010735276155173779, 0.011574867181479931, 0.03260768577456474, 0.027598844841122627, -0.0373438335955143, 0.0009840071434155107, -0.025962719693779945, -0.06802835315465927, 0.016088562086224556, -0.04615594819188118, -0.04009941592812538, -0.022403430193662643, -0.03989848494529724, -0.020480265840888023, -0.05020320415496826, -0.034731775522232056, -0.002450599567964673, 0.048452261835336685, -0.016117267310619354, 0.004689507186412811, -0.016576530411839485, -0.057321783155202866, -0.023149734362959862, 0.01727977581322193, -0.03900866582989693, 0.008625536225736141, 0.02956506609916687, 0.050518948584795, -0.025646977126598358, -0.04710317775607109, -0.02438400313258171, -0.05720696598291397, 0.027010414749383926, 0.011739914305508137, 0.0009239083155989647, -0.004743327386677265, -0.007771593518555164, -0.011316531337797642, -0.043630000203847885, 0.011230419389903545, 0.0006543602794408798, -0.01992053911089897, -0.001930340426042676, 0.021987223997712135, 0.0014145664172247052, -0.010914675891399384, -0.0030103265307843685, 0.045352235436439514, 0.004976546857506037, -0.030713222920894623, 0.04337166249752045, 0.0036848692689090967, 0.03751605749130249, -0.022346023470163345, -0.00881928764283657, 0.028833115473389626, 0.0033458038233220577, -0.013763542287051678, 0.0039719087071716785, -0.014868644997477531, 0.07244876027107239, 0.028172925114631653, 0.018987661227583885, 0.024943729862570763, -0.03366972878575325, 0.021800648421049118, 0.0002711177512537688, 0.011237595230340958, -0.01992053911089897, -0.013254047371447086, 0.01838487759232521, 0.016605233773589134, 0.0067131356336176395, 0.04690225049853325, -0.052528224885463715, -0.06877465546131134, 0.027211342006921768, -0.037602171301841736, 0.060507919639348984, -0.0045746914111077785, 0.027354862540960312, -0.06670797616243362, -0.025919664651155472, 0.03056970424950123, 0.0031323181465268135, 0.01679180935025215, -0.026063183322548866, 0.003367331810295582, -0.010354949161410332, -0.046816136687994, -0.025675680488348007, 0.012299641035497189, 0.012909600511193275, -0.02500113844871521, -0.07308024913072586, -0.024197427555918694, -0.029091451317071915, 0.011890609748661518, -0.009249847382307053, -0.008273912593722343, -0.04664391279220581, -0.013742014765739441, -0.006465564016252756, 0.014983460307121277, 0.009020215831696987, 0.00040656450437381864, 0.040271639823913574, 0.026981709524989128, 0.07107097655534744, -0.01059175655245781, 0.0062108165584504604, -0.036626238375902176, 0.013081824406981468, -0.025632625445723534, 0.030971558764576912, -0.04262536019086838, 0.022575654089450836, -0.018915900960564613, -0.05138006433844566, 0.016892272979021072, -0.03633919730782509, 0.02320714108645916, 0.032119717448949814, 0.0031430821400135756, 0.01710755191743374, 0.0015697471098974347, -0.019777020439505577, -0.00464645167812705, 0.009723462164402008, -0.003378095803782344, 0.015112628228962421, 0.015729762613773346, -0.023838628083467484, -0.041936468333005905, -0.025862256065011024, -0.06355053931474686, 0.03275120258331299, 0.06159866973757744, 0.03648271784186363, 0.01838487759232521, 0.026651615276932716, 0.022274263203144073, -0.01851404644548893, -0.006006300915032625, 0.03338269144296646, -0.00888387206941843, -0.002773518906906247, 0.014610309153795242, -0.07818955183029175, 0.03504751995205879, -0.032091014087200165, 0.019576091319322586, -0.014926052652299404, -0.008647063747048378, 0.012113065458834171, 0.005805373191833496, 0.042883697897195816, 0.03731513023376465, 0.02310667745769024, 0.04064479097723961, -0.00583407748490572, -0.001193904783576727, -0.04997357353568077, -0.004495755769312382, -0.014839940704405308, -0.01630384288728237, 0.008022753521800041, -0.009809574112296104, 0.028072459623217583, 0.00891257543116808, 0.013397566974163055, -0.052729152143001556, 0.03889384865760803, -0.06429684162139893, -0.010118141770362854, -0.027598844841122627, 0.001786820706911385, 0.058756981045007706, 0.04739021509885788, 0.06182830408215523, -0.022346023470163345, -0.016633937135338783, -0.08433219790458679, -0.04983005300164223, -0.021269625052809715, -7.736610859865323e-05, -0.02376686781644821, -0.06280423700809479, 0.01779644750058651, -0.04383092746138573, -0.03989848494529724, 0.022159447893500328, 0.02128397673368454, 0.023709461092948914, -0.06464128941297531, 0.0008292749989777803, -0.012184825725853443, 0.02533123269677162, -0.0348178893327713, -7.16477443347685e-05, -0.01515568420290947, -0.03389936313033104, 0.003745865076780319, -0.000979522243142128, -0.0552838034927845, 0.02063813805580139, -0.007793121505528688, -0.02894793078303337, 0.03444473817944527, -0.05103561654686928, 0.005690557416528463, -0.027096526697278023, 0.0015015752287581563, 0.01887284591794014, -0.0111012514680624, -0.1056879311800003, 0.09202485531568527, -0.01429456565529108, 0.015241796150803566, -0.016877921298146248, 0.0024810973554849625, 0.0017715716967359185, -0.01848534122109413, 0.015758467838168144, 0.0180547833442688, 0.01525614783167839, -0.002079242141917348, 0.036425307393074036, 0.023752516135573387, 0.01130935549736023, -0.04116145893931389, -0.08536554127931595, -0.0028560427017509937, -0.014610309153795242, -0.020853416994214058, -0.009651701897382736, 0.04113275557756424, -0.01910247653722763, -0.02320714108645916, -0.0361095666885376, -0.011316531337797642, -0.020724250003695488, -0.0029457425698637962, 0.018241358920931816, -0.0009508182411082089, 0.10224346071481705, 0.05284396559000015, 0.0004996280767954886, -0.004872494842857122, -0.017380239441990852, -0.03220582753419876, -0.006652139592915773, 0.04896893352270126, -0.018040431663393974, 0.034272514283657074, 0.04038645327091217, 0.02858913131058216, 0.005615209694951773, 0.012715849094092846, -0.035449374467134476, 0.026981709524989128, 0.013311455957591534, 0.05703474208712578, 0.011725562624633312, 0.008209329098463058, 0.0090273916721344, 0.022044630721211433, 0.0019052245188504457, -0.004312768112868071, 0.012809136882424355, 0.0348752960562706, 0.010491292923688889, 0.02174323983490467, 0.007140106987208128, -0.01095055602490902, 0.023982148617506027, 0.030139144510030746, 0.016404306516051292, -0.006985823158174753, 0.023608997464179993, -0.01275890413671732, -0.017495056614279747, -0.0034606195986270905, -0.023910388350486755, 0.0007463026558980346, -0.00709705101326108, -0.02405390702188015, -0.10000455379486084, -0.004373764153569937, -0.042912401258945465, 0.029880808666348457, -0.021700184792280197, -0.020623786374926567, -0.00214382610283792, -0.03272249922156334, -0.009788045659661293, 0.019418220967054367, -0.021226568147540092, 0.019145533442497253, 0.021556664258241653, 0.009106326848268509, -0.01997794769704342, 0.028546076267957687, 0.02092517726123333, 0.011208891868591309, 0.0084102563560009, 0.03226323798298836, -0.0433429591357708, -0.017265424132347107, 0.012407281436026096, 0.027656253427267075, -0.021958518773317337, 0.04767725616693497, -0.015571891330182552, -0.004632099531590939, 0.027254397049546242, -0.00015955358685459942, 0.008790584281086922, -0.016174674034118652, 0.017322832718491554, 0.044605933129787445, -0.0013437034795060754, 0.01874367706477642, -0.026378927752375603, -0.03335398808121681, -0.014926052652299404, 0.019418220967054367, 0.005425046198070049, 0.008826463483273983, 0.048940230160951614, -0.026450688019394875, -0.017839502543210983, 0.017351536080241203, -0.01155333872884512, 0.007477378472685814, -0.016059858724474907, 0.002592325210571289, 0.01429456565529108, 0.03269379585981369, -0.013368863612413406, -0.025862256065011024, -0.010584580712020397, -0.0030031504575163126, -0.02728310227394104, -0.03105767071247101, 0.012428808957338333, 0.014689245261251926, 0.010311893187463284, -0.006612672004848719, 0.023135380819439888, 0.02513030543923378, -0.016935328021645546, 0.010017677210271358, -0.014689245261251926, -0.011201715096831322, -0.0026533210184425116, -0.0035234095994383097, -0.03989848494529724, -0.02695300616323948, -0.01786820776760578, 0.021226568147540092, 0.011029492132365704, -0.018887197598814964, -0.015098276548087597, -0.04325684905052185, 0.055915288627147675, -0.012407281436026096, 0.007541961967945099, -0.0007857705350033939, -0.03407158702611923, -0.003263280028477311, -0.020322395488619804, -0.028861818835139275, 0.010197076946496964, -0.03645401448011398, -0.014825589023530483, -0.0055326856672763824, -0.042883697897195816, 0.047964297235012054, -0.03407158702611923, -0.023652052506804466, -0.03625308722257614, -0.020681193098425865, 0.003222018014639616, 0.008984335698187351, 0.02956506609916687, 0.010799860581755638, -0.04873930290341377, -0.024441411718726158, 0.024828914552927017, -0.005299466196447611, 0.023608997464179993, 0.0015096482820808887, 0.011108427308499813, 0.0014558283146470785, -0.0009337752708233893, 0.028445612639188766, 0.0010360331507399678, 0.008632712066173553, -0.015916338190436363, 0.0504615381360054, 0.02731180563569069, 0.0144093818962574, -0.04429019242525101, 0.0209969375282526, -0.0084246089681983, 0.014395029284060001, 0.011474402621388435, -0.020164523273706436, -0.02812986820936203, -0.03797532245516777, -0.03031136840581894, 0.01489734835922718, 0.03349750488996506, 0.031086374074220657, -0.02082471363246441, -0.022905750200152397, 0.01733718439936638, -0.028503019362688065, -0.008647063747048378, -0.02438400313258171, -0.010261661373078823, -0.029478954151272774, -0.01574411429464817, 0.013928590342402458, 0.02731180563569069, 0.00019935787713620812, 0.0016343309544026852, 0.023479828611016273, 0.02213074266910553, 0.017222369089722633, -0.00010365937487222254, 0.03458825498819351, -0.014868644997477531, 0.009859805926680565, -0.009701933711767197, -0.020910825580358505, -0.02490067481994629, 0.004140544217079878, 0.030397480353713036, -0.024642338976264, 0.018140895292162895, -0.05333193391561508, -0.027814125642180443, -0.012809136882424355, 0.0019267525058239698, 0.04159202054142952, -0.01003920566290617, 0.0023608996998518705, -0.04828003793954849, 0.021815000101923943, 0.0054501621052622795, -0.0006027828785590827, -0.016059858724474907, -0.03912347927689552, 0.01201260183006525, -0.0037925089709460735, 0.021441848948597908, -0.012586681172251701, -0.03585122898221016, -0.01256515271961689, -0.005037542898207903, -0.030024329200387, -0.006217992398887873, -0.05224118381738663, -0.015672355890274048, -0.015227444469928741, 0.01191213820129633, 0.06280423700809479, -0.03886514529585838, -0.02040850557386875, -0.008482016623020172, -0.028890522196888924, 0.022302966564893723, -0.02438400313258171, 0.025761792436242104, 0.00016930843412410468, 0.007678305730223656, 0.016318194568157196, -0.0016558589413762093, -0.01897330954670906, 0.028058107942342758, -0.04139109328389168, -0.005285114515572786, 0.0372290201485157, 0.02102564089000225, -0.016533473506569862, 0.009917213581502438, 0.013024415820837021, 0.028244683519005775, 0.008725999854505062, 0.009457950480282307, -0.024958081543445587, 0.0004088070127181709, -0.013469327241182327, 0.024986786767840385, -0.04357259348034859, -0.00291703874245286, -0.03510492667555809, 0.0014181543374434114, -0.020236283540725708, -0.050863396376371384, 0.000892513373401016, 0.03300954028964043, -0.01551448367536068, -0.008725999854505062, 0.002556445309892297, 0.030454888939857483, 0.001034239074215293, -0.03102896735072136, -0.0029941804241389036, 0.013684607110917568, 0.0029583005234599113, 0.018270062282681465, 0.02985210530459881, -0.01626078598201275, 0.02923496998846531, -0.03820495307445526, 0.008776231668889523, 0.019533036276698112, -0.0004224862204864621, -0.0021635601297020912, 0.04865318909287453, 0.007707010023295879, 0.014854292385280132, 0.023709461092948914, -0.00992438942193985, 0.00228196382522583, 0.01733718439936638, -0.00610317662358284, -0.0014432703610509634, -0.0168205127120018, -0.018456637859344482, 0.029909513890743256, 0.04274017736315727, -0.026020128279924393, -0.0052707623690366745, -0.008991511538624763, -0.005202590487897396, 0.04492167755961418, 0.011452875100076199, -0.01574411429464817, -0.007965344935655594, -0.015485779382288456, -0.021929815411567688, 0.006576791871339083, 0.0039719087071716785, 0.005170298274606466, -0.03895125538110733, -0.0029905925039201975, -0.013081824406981468, -0.013892710208892822, -0.029737289994955063, -0.004402467980980873, -0.0027663428336381912, 0.0007552726310677826, -0.040730901062488556, -0.10367865860462189, -0.02210203930735588, -0.0044526997953653336, 0.003867856925353408, 0.022833989933133125, 0.029249321669340134, -0.012392928823828697, -0.004596219398081303, -0.009048919193446636, -0.03154563903808594, 5.676317596225999e-05, -0.03286601975560188, 0.023092325776815414, -0.013533910736441612, -0.027469677850604057, -0.016418658196926117, 0.023264549672603607, -0.005037542898207903, 0.021470552310347557, -0.018930252641439438, -0.023422421887516975, 0.013878358528017998, 0.0014262273907661438, 0.029450250789523125, -0.014258685521781445, -0.04162072390317917, 0.0034265336580574512, -0.020595083013176918, 0.016834864392876625, -0.0030246784444898367, 0.0009884921601042151, -0.019676554948091507, 0.008754704147577286, 0.03507622331380844, -0.019891835749149323, -0.007463026326149702, -0.021083049476146698, 0.0014208453940227628, 0.05172451213002205, -0.008015577681362629, 0.0007826310466043651, -0.050518948584795, 0.0018478166311979294, 0.007197514642030001, 0.032349348068237305, -0.03421510383486748, 0.034530848264694214, 0.019446924328804016, 0.003939616959542036, -0.017265424132347107, 4.328017166699283e-05, 0.010828563943505287, -0.0010602520778775215, 0.009328782558441162, -0.005823313258588314, 0.025187714025378227, 0.018944604322314262, -0.007498905993998051, -0.01946127600967884, -0.017136257141828537, 0.010390829294919968, 0.028115516528487206, -0.006393804214894772, -0.013519559055566788, -0.03154563903808594, -0.009831101633608341, -0.015586243011057377, 0.013340159319341183, 0.02197287231683731, -0.04414667189121246, -0.03573641553521156, 0.031832676380872726, -0.014768180437386036, -0.02502984181046486, 0.0075491382740437984, 0.007735713850706816, 0.0028111927676945925, 0.01069222018122673, -0.05559954419732094, 0.023020565509796143, 0.025302529335021973, -0.009020215831696987, 0.004423995967954397, 0.0014881202951073647, -0.006304104346781969, 0.0052887024357914925, 0.017609871923923492, -0.04030034318566322, 0.0034875296987593174, 0.017968671396374702, 0.06452647596597672, -0.025919664651155472, 0.015026516281068325, -0.013749190606176853, 0.011115603148937225, 0.0058914851397275925, 0.027613196521997452, -0.013419095426797867, -0.021527960896492004, 0.02323584444820881, 0.04526612535119057, -0.004000612534582615, 0.0324067547917366, -0.07313765585422516, -0.015686707571148872, -0.011488755233585835, 0.0017563228029757738, -0.01727977581322193, 0.04380222409963608, -0.027728013694286346, -0.01838487759232521, 0.0015338672092184424, 0.00978086981922388, 0.029536360874772072, 0.018241358920931816, 0.037860505282878876, 0.022676117718219757, -0.0006924827466718853, -0.012357049621641636, -0.03651142120361328, -0.009228318929672241, 0.02546040154993534, -0.013318631798028946, -0.04285499453544617, -0.008037105202674866, -0.003399623790755868, 0.011129955761134624, 0.019647851586341858, 0.011022315360605717, 0.026866894215345383, -0.021269625052809715, 0.022604359313845634, -0.008058633655309677, 0.02594836801290512, 0.015126979909837246, -0.024111315608024597, 0.001440579304471612, -0.02310667745769024, 0.02669467031955719, 0.0023286077193915844, 0.011940842494368553, 0.022116390988230705, 0.045811500400304794, -0.0013499825727194548, -0.04018552601337433, -0.00953688658773899, 0.008094512857496738, -0.0010952349985018373, -0.01215612143278122, -0.005956069100648165, 0.004187188111245632, -0.020623786374926567, 0.0028058108873665333, 0.008130392991006374, -0.0033224818762391806, 0.030914152041077614, -0.0012683556415140629, -0.023393716663122177, 0.04983005300164223, 0.034042879939079285, 0.01333298347890377, 0.032349348068237305, 0.003397829830646515, -0.027814125642180443, 0.02623540721833706, -0.0018128337105736136, 0.005381990224123001, -0.01661958545446396, 0.004022140521556139, 0.05582917854189873, -0.008618360385298729, -0.012608208693563938, 0.026407631114125252, 0.022934453561902046, 0.03289472311735153, 0.03843458369374275, 0.017983023077249527, -0.022661766037344933, 0.01884414069354534, -0.0078074736520648, 0.0010046381503343582, 0.008108865469694138, -0.009379014372825623, 0.008496368303894997, 0.026752078905701637, -0.014179750345647335, 0.034272514283657074, 0.0084246089681983, 0.021599721163511276, 0.009960269555449486, 0.0135267348960042, 0.03708549961447716, -0.0034175636246800423, 0.0026694671250879765, 0.032091014087200165, -0.011826026253402233, 0.020939528942108154, 0.017810799181461334, -0.003239958081394434, 0.03217712417244911, 0.03892255201935768, 0.020523322746157646, 0.009802398271858692, -0.018456637859344482, -0.00938619114458561, 0.018097838386893272, -0.024082612246274948, -0.007599370088428259, -0.008589656092226505, 0.03335398808121681, -0.006562439724802971, -0.0009911832166835666, -0.010225781239569187, 0.0076352497562766075, -0.053762491792440414, -0.007520433980971575, 0.012572328560054302, 0.005773081444203854, -0.024326594546437263, -0.015701059252023697, -0.006630611605942249, -0.014825589023530483, -0.030971558764576912, 0.017810799181461334, -0.031660452485084534, -0.03289472311735153, 0.013569790869951248, -0.033267874270677567, 0.007836177945137024, 0.01025448553264141, -0.007254922762513161, 0.032578978687524796, -0.035449374467134476, -0.019662203267216682, -0.03191879019141197, -0.02197287231683731, 0.003092850325629115, -0.013383215293288231, -0.0075132581405341625, -0.007864881306886673, 0.03174656629562378, 0.009529710747301579, -0.0036669292021542788, 0.0031681982800364494, -0.003900148905813694, 0.009709110483527184, 0.01460313331335783, 0.05964680388569832, -0.01750940829515457, 0.0077285380102694035, -0.02461363561451435, -0.02200157567858696, 0.029392842203378677, -0.007585017941892147, 0.0312298946082592, 0.006935591343790293, 0.02574744075536728, 0.03631049394607544, 0.027986347675323486, 0.02063813805580139, -0.015988098457455635, -0.0038355649448931217, 0.011223243549466133, -0.017064496874809265, 0.0102329570800066, -0.014201277866959572, 0.008367200382053852, 0.009981798008084297, 0.015758467838168144, 0.03418640047311783, -0.00618570065125823, 0.02379557304084301, 0.023250197991728783, 0.03194749355316162, -0.03585122898221016, -0.0034875296987593174, 0.027168286964297295, 0.004800735041499138, 0.032091014087200165, -0.02838820405304432, -0.03467436879873276, -0.005478865932673216, 0.004373764153569937, 0.009213967248797417, 0.0030139144510030746, -0.03949663043022156, -0.02731180563569069, -0.018427934497594833, 0.02623540721833706, -0.033066947013139725, 0.009981798008084297, 0.050863396376371384, 0.018011726438999176, -0.006418920122087002, 0.011007963679730892, -0.0055506257340312, 0.014768180437386036, -0.006167760584503412, 0.02297751046717167, -0.034530848264694214, 0.014811236411333084, 0.02461363561451435, 0.023149734362959862, 8.784977399045601e-05, 0.029450250789523125, 0.027971995994448662, 0.025962719693779945, -0.0092929033562541, -0.028703946620225906, 0.01129500288516283, 0.008345672860741615, 0.022661766037344933, 0.016633937135338783, 0.013777894899249077, -0.0019680142868310213, -0.015930689871311188, 0.002934978576377034, -0.04403185471892357, -0.003589787520468235, -0.000525192532222718, 0.0018585806246846914, 0.008969983085989952, -0.0008938588434830308, -0.002439835574477911, -0.006426095962524414, -0.04104664549231529, -0.00709705101326108, 0.0057515534572303295, -0.0006835127715021372, 0.00769983371719718, -0.001933928462676704, 0.011330883018672466, 0.0025654153432697058, 0.024240482598543167, -0.024096963927149773, 0.008108865469694138, -0.003222018014639616, -0.018212653696537018, -0.012945480644702911, 0.002759166993200779, 0.00881928764283657, 0.003910912666469812, 0.0022353199310600758, -0.032091014087200165, -0.014036229811608791, 0.010319069027900696, 0.005823313258588314, 0.01923164539039135, 0.0008911678451113403, 0.0005821519298478961, 0.084102563560009, -0.006479916162788868, -0.01130935549736023, -0.0033135118428617716, -0.015428371727466583, 0.014107990078628063, -0.0025169774889945984, 0.011675330810248852, -0.038377176970243454, 0.016992736607789993, -0.026378927752375603, 0.011660978198051453, 0.01825571060180664, 0.04055867716670036, -0.01316793542355299, -0.0014208453940227628, 0.0016657259548082948, 0.04839485511183739, 8.314053411595523e-05, 0.0011894197668880224, 0.012687144801020622, -0.011108427308499813, -0.008618360385298729, -0.002590531250461936, -0.016964033246040344, -0.012751728296279907, -0.028933579102158546, 0.02985210530459881, 0.042941104620695114, 0.03582252562046051, 0.0034606195986270905, -0.026450688019394875, -0.013541087508201599, -0.012105889618396759, 0.028115516528487206, 0.01564365066587925, -0.023092325776815414, 0.025273825973272324, 0.036166973412036896, -0.024943729862570763, 0.014423733577132225, 0.039754968136548996, -0.011237595230340958, 0.00819497648626566, -0.02138444036245346, -0.026034479960799217, 0.0031735801603645086, -0.005758729297667742, 0.006766955368220806, -0.007527610287070274, -0.007043231278657913, 0.0056116217747330666, 0.02379557304084301, -0.014402205124497414, 0.02053767442703247, -0.019504332914948463, 0.0045136958360672, 0.029478954151272774, 0.006698783487081528, -0.003745865076780319, -0.043859630823135376, -0.027971995994448662, -0.010268837213516235, 0.011940842494368553, 0.0051093026995658875, -0.02177194319665432, -0.00387503276579082, 0.012493393383920193, -0.0015527041396126151, -0.017624223604798317, -0.009522534906864166, 0.007994049228727818, -0.005575741641223431, -0.010534348897635937, -0.001801172737032175, 0.01600245013833046, 0.001050385064445436, 0.01871497370302677, 0.03194749355316162, 0.03897995874285698, -0.014057758264243603, -0.02454187534749508, -0.011883433908224106, -0.01220635324716568, -0.007021703291684389, 0.003241752041503787, 0.05700603872537613, -0.01028318889439106, 0.0049119628965854645, 0.013196639716625214, -0.029450250789523125, 0.017710335552692413, 0.03674105182290077, -0.003571847453713417, -0.02369510754942894, -0.022704822942614555, 0.019633499905467033, -0.0021886760368943214, -0.005381990224123001, 0.001456725294701755, -0.009881333447992802, -0.011567690409719944, -0.008417432196438313, -0.01584457978606224, -0.002208409830927849, 0.010326244868338108, -0.03645401448011398, -0.031861379742622375, 0.0012925745686516166, 0.03395676985383034, 0.013175112195312977, -0.006698783487081528, -0.00046419663704000413, 0.028302092105150223, -0.01633254624903202, 0.0036382253747433424, -0.008388728834688663, -0.0003877275448758155, -0.008941279724240303, -0.002283757785335183, 0.03444473817944527, 0.046988360583782196, -0.0008759188931435347, 0.008029929362237453, -0.009099151007831097, 0.007470202166587114, -0.010218605399131775, 0.003234575968235731, -0.006189288571476936, -0.025216417387127876, 0.0047540911473333836, -0.011280651204288006, 0.020164523273706436, 0.026809487491846085, 0.003706397255882621, 0.02956506609916687, -0.006996586918830872, -0.04586890712380409, -0.02923496998846531, 0.0009544062195345759, -0.0007826310466043651, 0.017251072451472282, 0.003274044021964073, -0.008632712066173553, 0.002918832702562213, -0.0038104490377008915, -0.014064934104681015, 0.0016881509218364954, 0.01085726823657751, -0.010799860581755638, -0.020839065313339233, -0.004944255109876394, 0.020035354420542717, 0.0384058803319931, 0.010067909955978394, 0.017064496874809265, -0.0028309267945587635, -0.01610291376709938, 0.01923164539039135, 0.02203027904033661, 0.03435862436890602, 0.0017150609055534005, -0.0096301743760705, 0.014323269948363304, 0.026048831641674042, -0.010878795757889748, -0.010060733184218407, 0.013397566974163055, 0.0005758729530498385, -0.024958081543445587, -0.0084246089681983, 0.049284677952528, 0.03074192814528942, 0.012880896218121052, -0.004050844348967075, 0.005030366592109203, -0.009314430877566338, 0.02428353950381279, -0.012644088827073574, 0.009450774639844894, 0.0076926578767597675, -0.012105889618396759, -0.0004565721610561013, 0.02118351310491562, -0.027369214221835136, -0.008288265205919743, 0.003604139434173703, -0.009902861900627613, -0.01551448367536068, -0.02274787798523903, 0.021858055144548416, 0.0026299990713596344, 0.03243546187877655, 0.020236283540725708, 0.031115079298615456, 0.025905312970280647, 0.008058633655309677, 0.04899763688445091, 0.00580178527161479, 0.03366972878575325, -0.01782515086233616, -0.006264636293053627, -0.010634812526404858, -0.019289052113890648, 0.03946792706847191, 0.025790495797991753, 0.017968671396374702, 0.0030031504575163126, 0.011173011735081673, -0.02027933858335018, 0.0312873013317585, 0.0072118667885661125, 0.0022048219107091427, 0.0349327027797699, -0.0021258860360831022, 0.0197913721203804, -0.009744989685714245, -0.014208453707396984, -0.018040431663393974, 0.004718211479485035, 0.0017787477700039744, 0.0222025029361248, 0.006601907778531313, -0.010821388103067875, 0.0168492179363966, -0.014581604860723019, 0.025374289602041245, 0.005665441509336233, -0.009242670610547066, -0.01303876843303442, -0.010491292923688889, 0.01694968156516552, -0.00428765220567584, -0.014882996678352356, 0.01841358281672001, -0.004022140521556139, -0.015299203805625439, -0.009070447646081448, 0.006383040454238653, 0.03372713923454285, -0.018040431663393974, 0.0008270324906334281, 0.015083923935890198, -0.004746915306895971, 0.014151046052575111, 0.02959376946091652, -0.013627198524773121, -0.018915900960564613, -0.019217291846871376, 0.003347597783431411, -0.02581920102238655, 0.0036633412819355726, 0.0036005512811243534, -0.018083486706018448, 0.006045768968760967, -0.07084134221076965, 0.0003825697931461036, -0.009120679460465908, 0.017581168562173843, -0.0042517720721662045, -0.0648135095834732, 0.015170035883784294, 0.029478954151272774, -0.013340159319341183, 0.02653679996728897, -0.013419095426797867, -0.03679845854640007, 0.023408068343997, -0.017911262810230255, 0.0026461451780050993, -0.01646171323955059, 1.777177931217011e-05, -0.007864881306886673, -0.009443598799407482, 0.0420512817800045, 0.014201277866959572, 0.0067490157671272755, -0.0020559201948344707, -0.027943292632699013, -0.01792561449110508, 0.015887634828686714, 0.0015284852124750614, -0.0013221756089478731, -0.031861379742622375, 0.013383215293288231, 0.033095650374889374, -0.02207333594560623, 0.002726875012740493, -0.001768880756571889, 0.015787171199917793, 0.012213530018925667, 0.01059175655245781, 0.015686707571148872, -0.02838820405304432, -0.022159447893500328, 0.012601032853126526, 0.005521921906620264, 0.0023824276868253946, 0.0034067996311932802, -0.002249671844765544, 0.011144307442009449, -0.014639013446867466, -0.01705014519393444, -0.003094644285738468, 0.009701933711767197, 0.023192789405584335, -0.00978086981922388, 0.03771698847413063, -0.011007963679730892, 0.03338269144296646, -0.008977159857749939, -0.00830979272723198, -0.02174323983490467, -0.006329220253974199, -0.008855167776346207, 0.021944167092442513, -0.007642426062375307, 0.04882541298866272, -0.013103351928293705, 0.03676975518465042, -0.026048831641674042, -0.004879671148955822, 0.0014827382983639836, -0.01769598387181759, 0.03536326438188553, -0.002567209303379059, -0.005970421247184277, -0.027656253427267075, 0.022604359313845634, 0.004352236166596413, 0.022173799574375153, 0.0023662815801799297, 0.019705260172486305, -0.04064479097723961, 0.00821650493890047, -0.0008584274328313768, -0.004323531873524189, 0.028058107942342758, 0.03286601975560188, -0.007405618205666542, -0.022633062675595284, -0.005737201310694218, 0.01033342070877552, -0.04018552601337433, -0.016834864392876625, 0.015227444469928741, -0.016476064920425415, 0.017121905460953712, -0.012809136882424355, -0.004739739466458559, 0.0031466702930629253, 0.02979469671845436, -0.0014988842885941267, 0.04406055808067322, 0.06205793470144272, -0.0017222368624061346, 0.009917213581502438, -0.011395467445254326, -0.010046381503343582, 0.011904962360858917, -0.005816137418150902, -0.004467051941901445, 0.02669467031955719, -0.001048591104336083, 0.013347335159778595, 0.011381114833056927, -0.020982585847377777, -0.007785945665091276, -0.00797252170741558, -0.030225256457924843, -0.01316793542355299, 0.027225693687796593, 0.025919664651155472, 0.03418640047311783, 0.013892710208892822, -0.00893410388380289, -0.007254922762513161, 0.0054322220385074615, 0.007337446324527264, 0.001518618199042976, 0.03897995874285698, -0.009752166457474232, 0.014969108626246452, -0.002400367520749569, -0.016016801819205284, 0.002124092075973749, 0.00021527960780076683, -0.0011652008397504687, 0.026838190853595734]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
"67
KIVI-2 R32 19.1 20.08 25.33 63 85.04 39.8 57.91 52.38 45.33
Llama2-13B-Chat16bit 24.18 20.37 25.69 67.5 86.9 42.18 50.23 50.64 45.96
KIVI-2 R128 23.59 20.76 25.25 67.5 87.17 41.56 49.93 48.45 45.52
KIVI-2 R32 23.56 20.9 25.45 67.5 87.42 41.4 48.93 48.81 45.49
Falcon-7B16bit 1.48 2.35 11.09 13 5.84 2.44 23.86 9.69 8.71
KIVI-4 R128 1.04 2.41 11.98 13 5.84 2.36 23.72 9.92 8.78
KIVI-4 R32 1.03 2.45 11.99 13.5 5.84 2.46 23.88 9.95 8.88
KIVI-2 R128 1.98 3.61 6.78 10 6.24 2.73 22.18 10.12 7.95
KIVI-2 R32 2.28 3.23 6.73 10 6.31 2.88 22.71 10.45 8.07
Mistral-7B16bit 8.12 19.98 19.99 67.5 89.8 41.69 66.59 58.99 46.58
KIVI-2 R128 6.92 19.71 17.92 66.5 89.63 41.66 65.52 58.99 45.85
KIVI-2 R32 6.84 19.81 17.2 66.5 89.63 42.82 65.13 58.06 45.74
12
","[-0.015418854542076588, 0.0074354130774736404, 0.03462947532534599, -0.049559544771909714, 0.026349801570177078, 0.014315391890704632, 0.01198256853967905, -0.04399039223790169, 0.03658460080623627, 0.009479410946369171, 0.009916353039443493, 0.01764059253036976, -0.01738879457116127, -0.00013341993326321244, 0.008775861002504826, -0.014241334050893784, 0.0002760970965027809, -0.016574157401919365, -0.03942842409014702, 0.039161816239356995, -0.0030474825762212276, -0.0069503337144851685, -0.013841421343386173, 0.02590545266866684, -0.010893916711211205, -0.029652783647179604, -0.03477758914232254, -0.03027486987411976, 0.02501675859093666, -0.05865385755896568, 0.03856935352087021, -0.020751023665070534, 0.0074354130774736404, -0.07121407985687256, -0.05050748586654663, -0.0006128291133791208, -0.015522535890340805, 0.02797907404601574, -0.04256848245859146, -0.0025068598333746195, 0.01907731406390667, -0.03267434611916542, -0.05539530888199806, -0.009353512898087502, 0.04197601601481438, -0.01744804158806801, -0.014744928106665611, -0.04322018846869469, 0.02236548624932766, 0.05966104567050934, -0.021995196118950844, 0.06262335926294327, -0.01987713947892189, 0.06463773548603058, 0.06517095118761063, 0.05581003427505493, 0.01722586713731289, 0.02600913494825363, 0.03273359313607216, -0.03898407891392708, 0.014796768315136433, -0.029208434745669365, 0.031252432614564896, -0.010901322588324547, -0.00589500879868865, 0.028675219044089317, -0.03057110123336315, 0.004676756449043751, 0.019032880663871765, -0.010916134342551231, -0.013678493909537792, 0.037502922117710114, 0.03065996989607811, -0.015833579003810883, -0.020217806100845337, 0.0011043883860111237, -0.002966018859297037, -0.03557741641998291, 0.0209287628531456, -0.05877234786748886, -0.03145979717373848, 0.0029123269487172365, -0.0019255053484812379, -0.006283812690526247, 0.052314501255750656, -0.035370051860809326, -0.039161816239356995, -0.01110127940773964, -0.007394681219011545, -0.004943364765495062, -0.08134520053863525, -0.010471787303686142, -0.015167057514190674, -0.00028072571149095893, 0.015715086832642555, -0.017151810228824615, 0.02067696489393711, -0.037947267293930054, -0.027905017137527466, 0.004821169190108776, 0.04028749838471413, 0.010338482446968555, 0.02861597202718258, 0.041561294347047806, 0.04878934472799301, 0.036703094840049744, 0.02012893743813038, -0.0013015675358474255, -0.055306438356637955, -0.007009580265730619, -0.02051403746008873, -0.003238181583583355, -0.045827027410268784, 0.010486598126590252, 0.010471787303686142, -0.007983441464602947, -0.026616409420967102, 0.005746893119066954, -0.04096883162856102, -0.04351642355322838, -0.0396357886493206, -0.04105769842863083, 0.04591589793562889, -0.007635369431227446, 0.01697407104074955, -0.016959259286522865, 0.007931601256132126, -0.03107469528913498, -0.022854268550872803, -0.020499225705862045, 0.032111506909132004, -0.014804174192249775, 0.08377429842948914, 0.006339356303215027, 0.02498713508248329, 0.019862329587340355, -0.0029641673900187016, 0.04384227842092514, 0.004499017260968685, -0.006024610251188278, -0.04766366258263588, -0.007872355170547962, -0.010886510834097862, 0.008242644369602203, -0.02341710776090622, 0.016070563346147537, -0.04016900435090065, -0.01136048138141632, -0.05886121839284897, -0.02236548624932766, 0.02004006691277027, 0.016663027927279472, -0.07056237012147903, -0.03362228721380234, -0.031193187460303307, 0.021965572610497475, 0.030778463929891586, 0.014204305596649647, -0.0026420154608786106, -0.005372900515794754, -0.03057110123336315, 0.009531252086162567, 0.010923540219664574, -0.019521662965416908, -0.025135250762104988, -0.01611499860882759, -0.031311679631471634, 0.017270302399992943, -0.09295747429132462, -0.041679784655570984, 0.03489608317613602, 0.03400738909840584, -0.029104754328727722, -0.04428662359714508, 0.0073095145635306835, -0.018084939569234848, 0.026660844683647156, -0.004891524091362953, 0.011005003936588764, 0.013737739995121956, -0.007257674355059862, 0.02322455681860447, 0.04979653283953667, 0.03646611049771309, -0.05663948133587837, -0.026083191856741905, -0.026053568348288536, 0.033740777522325516, 0.004750814288854599, -0.003751032520085573, 0.006565232761204243, 0.03818425163626671, 0.04846348986029625, 0.06368979066610336, 0.013293392956256866, -0.013500754721462727, 0.006505986675620079, 0.0033159423619508743, -0.03403700888156891, 0.030363738536834717, -0.01295272633433342, 0.005609885789453983, 0.03302982449531555, -0.08211539685726166, 0.0066207763738930225, -0.02421693317592144, -0.013345233164727688, 0.008220426738262177, -0.02137310989201069, 0.04019862785935402, 0.05586928129196167, 0.024527976289391518, -0.014056188985705376, -0.04233149439096451, -0.01658896915614605, 0.022632094100117683, -0.042449988424777985, 0.028245683759450912, -0.010375511832535267, 0.012774988077580929, -0.006624479312449694, 0.019980821758508682, -0.02820124849677086, 0.01466346438974142, -0.015359608456492424, 0.061497680842876434, 0.06004614382982254, -0.01035329420119524, -0.0019329112255945802, -0.049085576087236404, 0.022513601928949356, -0.011649307794868946, -0.007376166991889477, 0.0072058336809277534, 0.013678493909537792, -0.047426678240299225, -0.016766708344221115, -0.029786087572574615, -0.048315372318029404, -0.011108685284852982, -0.01764059253036976, 0.012737958692014217, 0.0252685546875, 0.04313132166862488, -0.008242644369602203, -0.01575952023267746, -0.0015913191018626094, -0.04197601601481438, -0.000341129198204726, -0.010094091296195984, 0.012323234230279922, 0.003110431833192706, -0.03608100861310959, -0.01075320690870285, -0.027386611327528954, -0.012449133209884167, -0.02355041168630123, 0.036258745938539505, -0.007842731662094593, -0.009842295199632645, -0.022054443135857582, -0.029697217047214508, -0.04274621978402138, 0.026557162404060364, -0.044582854956388474, -0.009368324652314186, 0.016055753454566002, 0.05018163099884987, -0.052432991564273834, -0.07690172642469406, -0.008109340444207191, -0.02686820551753044, 0.05127768963575363, -0.0062949215061962605, -0.009790454059839249, 0.0010627309093251824, 0.0009627526742406189, 0.012649089097976685, -0.009834889322519302, 0.044434741139411926, -0.03859897702932358, -0.018736649304628372, -0.023920701816678047, 0.02612762711942196, -0.019995633512735367, 0.015937259420752525, 0.0671260803937912, 0.03350379317998886, 0.0539141520857811, -0.046597231179475784, 0.03302982449531555, 0.019373547285795212, 0.03184489533305168, -0.01882551796734333, -0.006165320053696632, 0.020691776648163795, 0.01466346438974142, 0.013848827220499516, -0.028408611193299294, -0.023535599932074547, 0.06854799389839172, -0.004817466251552105, -0.0075390939600765705, 0.018321923911571503, -0.019032880663871765, 0.01285645179450512, 0.017433229833841324, 0.02086951583623886, -0.005902414675801992, 0.0005248853703960776, -0.0035196016542613506, -0.004125025123357773, 0.005702458322048187, 0.012789798900485039, -0.02612762711942196, -0.07103633880615234, 0.03682158887386322, -0.019195808097720146, 0.07731644809246063, -0.014041378162801266, 0.04724894091486931, -0.06262335926294327, 0.016603780910372734, 0.039191439747810364, 0.011686336249113083, 0.0005975546664558351, -0.02380220964550972, -0.007635369431227446, 0.0006507837679237127, -0.06203089654445648, -0.0471600703895092, -0.015655839815735817, 0.005306248553097248, -0.02498713508248329, -0.02476496249437332, -0.01578914374113083, -0.03759178891777992, 0.004258329048752785, -0.04230187088251114, -0.020410357043147087, -0.0188551414757967, -0.020558472722768784, -0.040791090577840805, 0.008042687550187111, -0.023535599932074547, -0.04019862785935402, 0.03566628322005272, -0.014870826154947281, 0.08247087895870209, -0.0017681323224678636, -0.006865167524665594, -0.003265953389927745, 0.01802569255232811, -0.008331513963639736, -0.007272485643625259, -0.034510981291532516, 0.027416234835982323, 0.01158265583217144, -0.059453681111335754, 0.03643648698925972, -0.04425700008869171, 0.036288369446992874, -0.013634059578180313, -0.020839892327785492, 0.05228487774729729, 0.001840338809415698, -0.03486645966768265, 0.030482230708003044, -0.007416898850351572, -0.029815711081027985, 0.022261803969740868, 0.005920928902924061, -0.02335786074399948, -0.026246119290590286, -0.0005003536934964359, -0.08359655737876892, 0.016159433871507645, 0.03347416967153549, 0.019477227702736855, 0.032170750200748444, 0.006517095025628805, -0.0036640146281570196, -0.019980821758508682, 0.005084075033664703, 0.00902765803039074, -0.05740968510508537, 0.01738879457116127, 0.01550772413611412, -0.060727477073669434, 0.04520494118332863, 0.015048565343022346, 0.014404261484742165, -0.02169896475970745, -0.028290117159485817, 0.03575515374541283, 0.015448478050529957, 0.03975427895784378, 0.05338093265891075, -0.018944010138511658, 0.02651272714138031, -0.0001323784963460639, -0.05344017967581749, -0.06416376680135727, -0.01410062424838543, -0.018455227836966515, -0.009531252086162567, -0.007887165993452072, -0.0026790446136146784, 0.024142874404788017, 0.005421038251370192, 0.020306676626205444, -0.054802846163511276, 0.03228924423456192, -0.07251749187707901, -0.002928989939391613, -0.00637268228456378, -0.009220208041369915, 0.0599869005382061, 0.022913513705134392, 0.04096883162856102, -0.01901806890964508, 0.009412758983671665, -0.06475622951984406, -0.027712466195225716, -0.0167815200984478, -0.006761486176401377, 0.007583528757095337, -0.04514569416642189, 0.05341055616736412, -0.010360700078308582, -0.01293791551142931, -0.014285768382251263, 0.01510781142860651, 0.05936481058597565, -0.03839161619544029, -0.004476800095289946, -0.0023106064181774855, 0.01570027507841587, -0.010397729463875294, 0.028053132817149162, 0.008805484510958195, -0.001840338809415698, 0.012330640107393265, 0.040376365184783936, -0.04668610170483589, 0.02026224136352539, -0.02540186047554016, -0.020277053117752075, 0.028675219044089317, -0.06428225338459015, -0.004254626110196114, -0.0028104973025619984, -0.056609857827425, 0.03057110123336315, -0.015478100627660751, -0.06653361767530441, 0.08809927850961685, 0.008538875728845596, 0.00850184727460146, -0.0031511636916548014, 0.0066207763738930225, 0.009064686484634876, -0.017892388626933098, -0.0031233918853104115, -0.006309733260422945, -0.007613152265548706, 0.0023383782245218754, 0.054476991295814514, 0.03554779291152954, -0.009583092294633389, -0.04218338057398796, -0.08324108272790909, -0.024557599797844887, 0.004443474113941193, -0.0018912536324933171, -0.03157828748226166, 0.04105769842863083, 0.0021180559415370226, 0.012278799898922443, -0.002168044913560152, -0.025535164400935173, 0.0343332439661026, -0.0007799222366884351, -0.0008183398167602718, 0.006309733260422945, 0.08898796886205673, 0.027460670098662376, 0.0039546918123960495, -0.06967367231845856, -0.017951635643839836, -0.028230872005224228, -0.0051211039535701275, 0.08312258869409561, -0.01888476498425007, 0.02449835278093815, 0.012686118483543396, -0.02498713508248329, 0.0069503337144851685, 0.010538439266383648, -0.057705916464328766, 0.005572856869548559, 0.014093218371272087, 0.04748592525720596, -0.002134718932211399, 0.03898407891392708, -0.0005313654546625912, 0.01655934564769268, -0.029075130820274353, -0.014367232099175453, 0.0167815200984478, 0.038332369178533554, -0.006554123945534229, 0.009901541285216808, -0.014522753655910492, -0.014411667361855507, 0.017892388626933098, 0.0028179031796753407, -0.0046360245905816555, -0.006902196444571018, 0.006302327383309603, -0.0051544299349188805, -0.025505540892481804, -0.019136561080813408, -0.03759178891777992, 0.014507942833006382, -0.03320756182074547, 0.0017857210477814078, -0.08081197738647461, -0.0011173485545441508, -0.021210182458162308, 0.030985824763774872, -0.023979946970939636, -0.02938617393374443, -0.0008794375462457538, -0.05213676020503044, -0.0014311688719317317, 0.03225962072610855, -0.018395982682704926, 0.0012774987844750285, 0.03350379317998886, 0.03323718532919884, -0.027356987819075584, 0.008657368831336498, -0.009412758983671665, 0.003358525689691305, 0.028852958232164383, 0.021610094234347343, -0.004750814288854599, -0.019640155136585236, 0.01962534338235855, 0.034540604799985886, 0.00615791417658329, 0.03646611049771309, -0.024172497913241386, -0.00955346878618002, 0.0044138506054878235, 0.011382699012756348, 0.0019125452963635325, 0.019521662965416908, 0.015626216307282448, 0.056609857827425, -0.002873446559533477, 0.022602470591664314, -0.026423858478665352, -0.008435194380581379, -0.005065560340881348, 0.007527985610067844, 0.004225003067404032, -0.005287733860313892, 0.04470134899020195, -0.02377258613705635, -0.00579132791608572, 0.0024457620456814766, 0.0023420811630785465, -0.006165320053696632, -0.019536474719643593, -0.03338530287146568, 0.03160791099071503, 0.014596812427043915, -0.05438812077045441, -0.026883017271757126, -0.019225431606173515, -0.002264320384711027, -0.029682405292987823, -0.012278799898922443, 0.014137652702629566, -0.0013367451028898358, -0.0038324962370097637, -0.0035510763991624117, 0.00974601972848177, 0.046123258769512177, 0.010679149068892002, 0.0025253742933273315, -0.00830929633229971, 0.027297742664813995, -0.021239805966615677, 0.020839892327785492, -0.02880852296948433, -0.014441290870308876, -0.051307313144207, 0.004239814821630716, 0.0011710405815392733, -0.027401423081755638, -0.011827046982944012, -0.02759397402405739, 0.020795458927750587, -0.009731207974255085, 0.01238248124718666, 0.01650010049343109, -0.0072761885821819305, -0.011019815690815449, -0.010975380428135395, -0.021935949102044106, -0.0009280380327254534, -0.02692745253443718, -0.0032159641850739717, -0.002830863231793046, -0.02443910762667656, 0.025801772251725197, -0.010094091296195984, -0.043249811977148056, -0.02045479230582714, 0.008983222767710686, 0.01043475791811943, 0.000999781652353704, 0.02855672687292099, -0.0015422557480633259, -0.030956201255321503, -0.014322797767817974, 0.009997816756367683, 0.000528125383425504, -0.0006406008033081889, 0.00891657080501318, 0.03181527182459831, -0.023565223440527916, 0.007135478779673576, 0.04253885895013809, 0.007724239025264978, 0.0008720317855477333, -0.05266997963190079, 0.05841686949133873, 0.040405988693237305, 0.007642775308340788, -0.05000389367341995, 0.030289681628346443, -0.0010710624046623707, 0.010442163795232773, 0.015100405551493168, -0.006902196444571018, -0.03302982449531555, -0.031282056123018265, -0.017122186720371246, 0.018647778779268265, 0.01898844540119171, -0.013730335049331188, -0.036614224314689636, -0.0027271821163594723, 0.013574812561273575, -0.02335786074399948, -0.01882551796734333, -0.010879105888307095, -0.0011053141206502914, -0.03060072474181652, 0.005428444128483534, 0.00011288043606327847, 0.010360700078308582, -0.016663027927279472, 0.03936918079853058, 0.00847222376614809, 0.01681114360690117, 0.03637723997235298, -0.003495532786473632, 0.014241334050893784, -0.0012062180321663618, 0.0250760056078434, -0.0013728482881560922, -0.004125025123357773, -0.006787406280636787, 0.01553734764456749, 0.01282682828605175, -0.037443675100803375, 0.017299925908446312, -0.06724457442760468, -0.0162038691341877, 0.011849263682961464, 0.012271394021809101, 0.03593289107084274, -0.009501628577709198, -0.0025901750195771456, -0.03143017366528511, 0.018336735665798187, 0.004128728061914444, 0.0066281817853450775, -0.015070782974362373, -0.018973633646965027, 0.02717924863100052, -0.00362513423897326, 0.03575515374541283, 0.003913959953933954, -0.05296621099114418, -0.02355041168630123, 0.016929635778069496, -0.04194639250636101, -0.013648871332406998, -0.042390741407871246, -0.027993885800242424, 0.008257456123828888, -0.006380088161677122, 0.04233149439096451, -0.020158560946583748, -0.0014043229166418314, -0.01183445192873478, -0.042390741407871246, 0.010308859869837761, -0.02131386287510395, 0.02817162498831749, -0.019832706078886986, -0.01199737936258316, 0.015448478050529957, -0.007820514030754566, -0.029489856213331223, 0.048670850694179535, -0.020469604060053825, 0.01086429413408041, 0.04253885895013809, 0.01592244766652584, -0.009012846276164055, 0.02383183129131794, 0.0016422339249402285, 0.03338530287146568, 0.016263114288449287, 0.01083467062562704, -0.017373982816934586, 0.01375255174934864, -0.03797689080238342, 0.019669778645038605, -0.026023946702480316, -0.018455227836966515, -0.03812500834465027, -0.001789423986338079, 0.014915261417627335, -0.05373641103506088, -0.00429906090721488, -0.009242425672709942, -0.031163563951849937, 0.00836113654077053, 0.003969503566622734, 0.022572847083210945, -0.00429906090721488, -0.027208872139453888, -0.004880415741354227, 0.014463507570326328, 0.03987277299165726, 0.007357652299106121, 0.010190366767346859, -0.02325418032705784, 0.04390152171254158, -0.04265734925866127, 0.003714003600180149, 0.013300798833370209, 0.010701366700232029, -0.008094528689980507, 0.047871027141809464, -0.002984533319249749, 0.02960834838449955, 0.01303419005125761, -0.014056188985705376, 0.018144184723496437, 0.03222999721765518, 0.0065578268840909, -0.019225431606173515, -0.0437830314040184, -0.008686991408467293, 0.013182305730879307, 0.023654093965888023, -0.018544098362326622, -0.007020689081400633, -0.0028234573546797037, -0.018766270950436592, 0.052403368055820465, 0.021136123687028885, -0.016648216173052788, 0.0028715950902551413, -0.0051544299349188805, -0.006276406813412905, 0.013471132144331932, -0.00695403665304184, -0.0061356970109045506, -0.03068959340453148, 0.009812671691179276, -0.02957872487604618, -0.018336735665798187, -0.01550772413611412, -0.010664337314665318, -0.004373118747025728, -0.004502720199525356, -0.027771713212132454, -0.09864512085914612, -0.009945975616574287, -0.0033844460267573595, 0.006435631308704615, 0.026720089837908745, 0.0215064138174057, -0.00194401980843395, 0.011353076435625553, -0.014611623249948025, -0.01907731406390667, 0.013056407682597637, -0.025949887931346893, -0.030808085575699806, -0.014781956560909748, -0.01611499860882759, -0.009331295266747475, 0.049026329070329666, 0.00907949823886156, 0.008168586529791355, -0.021876703947782516, -0.017018504440784454, 0.009523846209049225, 0.013774769380688667, 0.029682405292987823, -0.027134815230965614, -0.03593289107084274, -0.008768455125391483, -0.00403615552932024, 0.018914388492703438, 0.0256536565721035, -0.006128291133791208, -0.00830929633229971, -0.003969503566622734, 0.026083191856741905, 0.010197772644460201, 0.011967756785452366, -0.03972465917468071, -0.03557741641998291, 0.021461978554725647, -0.010664337314665318, -0.010175555013120174, -0.025668468326330185, 0.0016570454463362694, 0.02913437783718109, 0.039043325930833817, -0.0055802627466619015, 0.006468957755714655, 0.0064911749213933945, 0.00011559975246200338, -0.0414724238216877, 0.027297742664813995, -0.007746456190943718, -0.0028234573546797037, -0.024202121421694756, -0.016351984813809395, 0.058624234050512314, -0.0021087985951453447, 0.0058801970444619656, -0.02137310989201069, -0.012175118550658226, 0.012449133209884167, 0.031222810968756676, -0.010316265746951103, -0.02201000787317753, 0.008242644369602203, -0.00867958553135395, -0.02360965870320797, -0.013811797834932804, 0.02147679030895233, -0.03311869129538536, -0.03602176159620285, 0.024542788043618202, -0.0032437359914183617, -0.0351034440100193, -0.0067466748878359795, 0.012486161664128304, -0.008124151267111301, 0.008561093360185623, -0.03551816940307617, 0.008050093427300453, 0.024705715477466583, 0.0002338609629077837, -0.008405571803450584, -0.017314737662672997, 0.008635151199996471, -0.020854704082012177, 0.0235800351947546, -0.037947267293930054, 0.02532780170440674, 0.007390978280454874, 0.04277584329247475, -0.006765189114958048, 0.014485725201666355, -0.021965572610497475, 0.021802645176649094, 0.024172497913241386, 0.033266808837652206, 0.006172725930809975, -0.03679196536540985, 0.023654093965888023, 0.024646468460559845, -0.019388359040021896, 0.02303200587630272, -0.058535363525152206, -0.008590715937316418, -0.014359827153384686, -0.001962534384801984, -0.012967538088560104, 0.01719624362885952, -0.01611499860882759, -0.040405988693237305, 0.036199502646923065, 0.03436286374926567, 0.06600040197372437, 0.022409919649362564, 0.014011754654347897, 0.008213020861148834, -0.006335653364658356, -0.03557741641998291, -0.019891951233148575, -0.0009095235727727413, 0.016677839681506157, -0.008635151199996471, -0.0010358848376199603, -0.018899576738476753, 0.009160961955785751, 0.012982349842786789, 0.03726593405008316, 0.039132192730903625, 0.027401423081755638, -0.03391851857304573, 0.014722710475325584, -0.023654093965888023, 0.0068836817517876625, 0.03836199268698692, -0.03175602853298187, -0.0017551722703501582, -0.0048656039871275425, 0.058179885149002075, 0.01586320251226425, 0.016026129946112633, 0.02520930953323841, 0.010849482379853725, -0.004891524091362953, -0.028319740667939186, -0.0012423212174326181, -0.005035937298089266, 0.034984949976205826, -0.015818767249584198, 0.007261376827955246, 0.015655839815735817, -0.033711157739162445, 0.004554560873657465, 0.001504301093518734, 0.008686991408467293, 0.044938333332538605, -0.007150290068238974, -0.005717270076274872, 0.06250486522912979, 0.026557162404060364, 0.02386145479977131, 0.02313568815588951, 0.024098441004753113, -0.03300020098686218, 0.014167276211082935, 0.02750510349869728, 0.003760289866477251, -0.015833579003810883, 0.02195076085627079, 0.028823334723711014, -0.01652972400188446, -0.010338482446968555, 0.00687627587467432, 0.008257456123828888, 0.01863296702504158, 0.03981352597475052, 0.02201000787317753, -0.02692745253443718, 0.006435631308704615, 0.0024790882598608732, -0.011064250022172928, 0.018455227836966515, -0.009612715803086758, 0.03572553023695946, 0.024720527231693268, 0.008035281673073769, 0.01783314161002636, 0.022572847083210945, 0.007553905714303255, 0.0035658879205584526, 0.008716614916920662, 0.03836199268698692, 0.006528203841298819, 0.003950988873839378, 0.03948767110705376, -0.003593659494072199, 0.03175602853298187, 0.021521225571632385, -0.006676319520920515, 0.045797403901815414, 0.05261073261499405, -0.004017640836536884, 0.014811580069363117, 0.008427789434790611, -0.01239729207009077, 0.021299051120877266, -0.02906031906604767, -0.026468293741345406, 0.008605527691543102, 0.036229126155376434, -0.0024883453734219074, 0.008368542417883873, -0.0008326885290443897, 0.004132431000471115, -0.033296432346105576, 0.0047026765532791615, 0.0035899567883461714, -0.031163563951849937, -0.022232182323932648, -0.013930290937423706, -0.02686820551753044, -0.02258765883743763, -0.0055210161954164505, 0.00891657080501318, 0.0014922666596248746, -0.01598169468343258, -0.02095838636159897, -0.030896956101059914, 0.013737739995121956, 0.0015033753588795662, 0.014174682088196278, 0.02552035264670849, -0.0006697611534036696, -0.01767021417617798, -0.008013064973056316, -0.01713699847459793, 0.009390541352331638, 0.02294313721358776, 0.03474796563386917, -0.010360700078308582, 0.018973633646965027, -0.012515785172581673, -0.015374420210719109, 0.002368001267313957, -0.005624697543680668, -0.007431710138916969, 0.01904769241809845, 0.05838724970817566, -0.022039631381630898, 0.016485288739204407, -0.024542788043618202, -0.012278799898922443, 0.02220255881547928, -0.0026086894795298576, 0.021447166800498962, 0.005695052444934845, -0.0069762542843818665, 0.024972323328256607, -0.007324326317757368, 0.03480721265077591, -0.004213894717395306, -0.0017996069509536028, 0.009160961955785751, -0.007424304261803627, 0.012849045917391777, 0.005650617647916079, -0.025194497779011726, 0.019121749326586723, 0.01287126261740923, 0.01783314161002636, -0.004339792765676975, 0.014537565410137177, 0.005913523491472006, 0.013041595928370953, -0.04342755302786827, -0.0059061176143586636, 0.03984314948320389, -0.018321923911571503, -0.013219335116446018, -0.008242644369602203, -0.043190568685531616, -0.003917662892490625, 0.024587223306298256, 0.0017338806064799428, 0.006176428869366646, -0.02897145040333271, -0.02999345026910305, -0.03688083216547966, 0.025001946836709976, -0.003180786734446883, -0.006757783237844706, 0.024083629250526428, 0.025698091834783554, -0.018840329721570015, -0.018707025796175003, 0.024113252758979797, 0.01681114360690117, -0.02004006691277027, -0.008864730596542358, -0.0056135887280106544, 0.026616409420967102, 0.01218993030488491, 0.032970577478408813, -0.0031122833024710417, 0.0117900175973773, 0.04840424284338951, 0.03984314948320389, 0.004087996203452349, -0.020114125683903694, -0.0036714202724397182, -0.00020053490879945457, -0.009649744257330894, -0.0009335923823527992, 0.007465036120265722, -0.0012228810228407383, 0.009701584465801716, 0.011701148003339767, -0.025786960497498512, 0.0006674468168057501, -0.004706379491835833, 0.004158351104706526, 0.021224994212388992, 0.016485288739204407, -0.011330858804285526, 0.0006156063172966242, -0.02944542095065117, -0.018618155270814896, 0.013160089030861855, 0.0010247761383652687, -0.017507286742329597, 0.002238400047644973, 0.024068817496299744, 0.004769328515976667, 0.0003582550853025168, -0.005898711737245321, -0.013552595861256123, -0.007590934634208679, 0.0007114186882972717, -0.015685463324189186, -0.0035344131756573915, 0.00043370158527977765, 7.278502744156867e-05, 0.01946241594851017, -0.019610531628131866, 0.01669265143573284, 0.0036325398832559586, -0.022084064781665802, 0.01761096902191639, -0.011005003936588764, 0.010686554946005344, 0.10190366953611374, -0.004010235425084829, -0.00157928466796875, -0.0009507182985544205, -0.0018773677293211222, 0.026883017271757126, 0.004632321652024984, 0.00142006017267704, -0.02230623923242092, 0.020913951098918915, -0.014426479116082191, 0.0032289244700223207, 0.029475044459104538, 0.018203431740403175, -0.018618155270814896, -0.0034640582744032145, 0.0358736477792263, 0.03228924423456192, 0.007124369964003563, -0.007798296865075827, -0.018529286608099937, -0.03400738909840584, -0.013515566475689411, -0.0088721364736557, -0.021491602063179016, -0.005861682817339897, -0.03024524636566639, -0.005850574001669884, 0.04644911363720894, 0.030393362045288086, 0.01669265143573284, -0.0104643814265728, 0.01700369454920292, 0.02383183129131794, 0.01990676298737526, 0.007450224831700325, -0.03474796563386917, -0.0012497270945459604, 0.006306030321866274, -0.024320613592863083, -0.004691567737609148, 0.025920264422893524, 0.006642993539571762, 0.016514912247657776, -0.0246909037232399, -0.013767363503575325, 0.004869306925684214, -0.02750510349869728, 0.005235893651843071, -0.005713567137718201, 0.019669778645038605, 0.01011630892753601, -0.008894354104995728, 0.007176210638135672, 0.028512291610240936, -0.003227073000743985, 0.0009757128427736461, 0.03637723997235298, -0.00799084734171629, -0.0018468188354745507, -0.042864713817834854, -0.052699603140354156, -0.009205397218465805, 0.021743400022387505, 0.007709427271038294, 0.00919058546423912, 0.004917444661259651, 0.021861892193555832, -0.040791090577840805, 0.00931648351252079, -0.005398821085691452, 0.006909601856023073, -0.006483769044280052, -0.01261946652084589, 0.000812785467132926, 0.014174682088196278, 0.005165538284927607, 0.007235456723719835, 0.016100186854600906, 0.0396357886493206, -0.021595284342765808, -0.010886510834097862, -0.0005123880691826344, 0.015566970221698284, -0.01035329420119524, 0.010427352041006088, 0.03839161619544029, -0.0009664556127972901, -0.00931648351252079, 0.00695403665304184, 0.006987362634390593, -0.0008748089312575758, -0.004232408944517374, -0.02109169028699398, -0.02706075645983219, 0.006165320053696632, 0.013700711540877819, 0.0025624032132327557, -0.001013667555525899, -0.0007040129275992513, 0.003273359267041087, -0.00635046511888504, -0.013330422341823578, -0.005846871063113213, -0.003378891618922353, -0.0058690886944532394, 0.009227613918483257, -0.02169896475970745, -0.006276406813412905, 0.014108030125498772, 0.01623349077999592, -0.002247657161206007, 0.0033085367176681757, -0.0072761885821819305, -0.012863856740295887, -0.0026086894795298576, -0.0023661497980356216, -0.005439552944153547, 0.015329984948039055, 0.006939225364476442, 0.029475044459104538, 0.03652535751461983, 0.023061629384756088, -0.04399039223790169, -0.003352971514686942, 0.005854276940226555, -0.02023261785507202, 0.03237811475992203, -0.01783314161002636, -0.03193376585841179, 0.01675189658999443, 0.0031993011943995953, 0.03285208344459534, 0.002625352470204234, 0.011323452927172184, 0.02919362485408783, 0.0031548666302114725, -0.025194497779011726, -0.022869080305099487, 0.011797423474490643, 0.009049875661730766, 0.034155502915382385, 0.023950325325131416, -0.021847080439329147, 0.024335425347089767, -0.02820124849677086, 0.005583965685218573, 0.005913523491472006, 0.010168150067329407, 0.007627963554114103, -0.0133822625502944, -0.02322455681860447, 0.005506204906851053, 0.017344359308481216, 0.005872791633009911, 0.012375075370073318, -0.01990676298737526, -0.05127768963575363, 0.01965496689081192, 0.014145058579742908, 0.03797689080238342, -0.009805265814065933, 0.010967974551022053, 0.003115986241027713, 0.004158351104706526, -0.01531517319381237, 0.016070563346147537, 0.03305944800376892, -0.00467305351048708, -0.003371485974639654, 0.004295357968658209, 0.01921061985194683, 0.034510981291532516, 0.01907731406390667, 0.02670527808368206, 0.021743400022387505, 0.01250837929546833, 0.0426277257502079, -0.03184489533305168, 0.00963493250310421, 0.01921061985194683, -0.018084939569234848, 0.002493899781256914, 0.020173372700810432, -0.01783314161002636, -0.022483978420495987, -0.009849701076745987, -0.02501675859093666, 0.0021606392692774534, -0.05249223858118057, 0.028986262157559395, -0.0027919828426092863, 0.0198178943246603, -0.0044064451940357685, 0.04046523571014404, 0.022409919649362564, 7.643006392754614e-05, 0.04351642355322838, -0.008568499237298965, 0.024839019402861595, -0.014619029127061367, -0.000733173219487071, 0.003125243354588747, -0.0030345225241035223, 0.02258765883743763, 0.028319740667939186, -0.0063652764074504375, 0.001929208287037909, 0.004643430467694998, -0.014367232099175453, 0.009649744257330894, 0.023787397891283035, -0.02466128021478653, 0.007257674355059862, -0.005050748586654663, 0.040761467069387436, 0.027445858344435692, -0.018588533625006676, -0.009168367832899094, 0.013004567474126816, 0.004106510430574417, 0.027208872139453888, 0.013256363570690155, 9.158879402093589e-05, 0.014826391823589802, -0.007576123345643282, 0.018366359174251556, -0.003789912909269333, 0.01481898594647646, -0.04564929008483887, 0.010886510834097862, 0.0358736477792263, -0.006257892586290836, -0.002638312755152583, 0.02089913934469223, -0.03005269542336464, 0.004547154996544123, 0.024527976289391518, -0.004043561406433582, 0.012834234163165092, -0.0027864284347742796, -0.0014274660497903824, 0.007716833148151636, 0.006043124478310347, 0.015033753588795662, 0.03590327128767967, -0.011478974483907223, -0.0005984804010950029, -0.016011318191885948, 0.02501675859093666, -0.020810270681977272, -0.03465909883379936, -0.004006532486528158, 0.007572420407086611, 0.030422985553741455, -0.07547981292009354, -0.00621345778927207, -0.013248958624899387, 0.00677259499207139, -0.028912203386425972, -0.0033455656375736, 0.017107374966144562, 0.04259810224175453, 0.011005003936588764, 0.026808960363268852, 0.0003913497203029692, -0.030985824763774872, 0.01898844540119171, -0.015848390758037567, -0.008301890455186367, -0.004069481510668993, -0.009753425605595112, 0.015122623182833195, 0.0010062616784125566, 0.020795458927750587, 0.0194327924400568, -0.011397510766983032, -0.007461333181709051, -0.016040941700339317, -0.02775690145790577, -0.006672616582363844, 0.03175602853298187, 0.012056626379489899, -0.014759738929569721, 0.015018941834568977, 0.027164436876773834, -0.033414922654628754, 0.03347416967153549, -0.007002174388617277, 0.0036973406095057726, 0.020025255158543587, 0.016470476984977722, 0.015937259420752525, -0.022883890196681023, -0.004821169190108776, 0.019388359040021896, -0.002008820418268442, -0.0022994978353381157, 0.005450661294162273, 0.009583092294633389, 0.009657150134444237, -0.0018060869770124555, -0.01250837929546833, 0.01213809009641409, 0.016737084835767746, -0.005065560340881348, 0.012286205776035786, 0.006009798496961594, -0.022098876535892487, 0.029238058254122734, -0.01303419005125761, -0.013715523295104504, -0.03199301287531853, 0.0162038691341877, 0.016870388761162758, 0.016870388761162758, -0.014233928173780441, 0.01611499860882759, -0.003554779104888439, 0.04511607065796852, 0.0003626522666309029, -0.030422985553741455, 0.01805531606078148, -0.039546918123960495, 0.014485725201666355, -0.0029974933713674545, -0.00934610702097416, 0.014345015399158001, -0.000546639843378216, 0.0036269857082515955, -0.003171529620885849, -0.02239510975778103, 0.033800024539232254, -0.03424437344074249, 0.007709427271038294, -0.010205178521573544, -0.028690030798316002, 0.025387048721313477, 0.040376365184783936, -0.027653219178318977, -0.015596593730151653, -0.011316047050058842, 0.011478974483907223, -0.03889520838856697, -0.04105769842863083, 0.0032455874606966972, -0.010886510834097862, -0.021847080439329147, 0.009701584465801716, -0.0009849700145423412, -0.0028752980288118124, -0.00030016593518666923, -0.01346372626721859, 0.019032880663871765, 0.07257673889398575, -0.0027197764720767736, 0.024350237101316452, 0.018958821892738342, -0.018084939569234848, -0.0010164446430280805, -0.01263427734375, -0.017240678891539574, 0.020499225705862045, -0.0034140690695494413, 0.014937478117644787, 0.02004006691277027, -0.004499017260968685, -0.005761704407632351, -0.010856888256967068, -0.0037917643785476685, -0.008405571803450584, 0.046004768460989, 0.013611841946840286, 0.019610531628131866, 0.014715304598212242, 0.012900886125862598, -0.0022735774982720613, 0.024335425347089767, -0.018840329721570015, -0.013419291004538536, 0.03382964804768562, -0.006517095025628805, 0.007590934634208679, -0.0010775424307212234, -0.000425138627178967, -0.00229764636605978, 0.0022254399955272675, -0.03427399694919586, 0.03199301287531853]",KIVI: A Tuning-Free Asymmetric 2bit Quantization for KV Cache.pdf
