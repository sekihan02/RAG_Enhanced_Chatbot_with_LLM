text,embedding,file
"Break the Sequential Dependency of LLM Inference Using
LOOKAHEAD DECODING
Yichao Fu1Peter Bailis2Ion Stoica3Hao Zhang1
Abstract
Autoregressive decoding of large language mod-
els (LLMs) is memory bandwidth bounded, re-
sulting in high latency and significant wastes of
the parallel processing power of modern accel-
erators. Existing methods for accelerating LLM
decoding often require a draft model (e.g., spec-
ulative decoding), which is nontrivial to obtain
and unable to generalize. In this paper, we in-
troduce LOOKAHEAD DECODING , an exact, par-
allel decoding algorithm that accelerates LLM
decoding without needing auxiliary models or
data stores. It allows trading per-step log(FLOPs)
to reduce the number of total decoding steps, is
more parallelizable on single or multiple modern
accelerators, and is compatible with concurrent
memory-efficient attention (e.g., FlashAttention).
Our implementation of LOOKAHEAD DECODING
can speed up autoregressive decoding by up to
1.8x on MT-bench and 4x with strong scaling on
multiple GPUs in code completion tasks. Our
code is avialable at https://github.com
/hao-ai-lab/LookaheadDecoding
1. Introduction
Large language models (LLMs) are transforming the AI
industry. As they are increasingly integrated into diverse
applications such as search (Team et al., 2023) and chat-
bots (Ouyang et al., 2022), generating long sequences at
low-latency using LLMs is becoming one significant re-
quirement. However, current LLMs generate text based
on (Touvron et al., 2023a;b; Jiang et al., 2023; OpenAI,
2023) autoregressive decoding , which falls short in effi-
ciency, primarily for two reasons. First, autoregressive de-
coding generates only one token at a time. Hence, the overall
generation time is proportional to the number of decoding
steps. Second, each decoding step largely underutilizes the
parallel processing capabilities of modern accelerators (e.g.,
1UCSD2Google3UC Berkeley. Correspondence to: Hao Zhang
<haozhang@ucsd.edu >.GPUs). Given the pressing need for low latency in various
applications, improving autoregressive decoding remains a
central challenge.
Several approaches have been proposed – one such approach
isspeculative decoding (Chen et al., 2023; Leviathan et al.,
2023) and its variants (He et al., 2023; Stern et al., 2018;
Cai et al., 2024; Li et al., 2023; Liu et al., 2023; Miao
et al., 2023). These methods all follow a guess-and-verify
approach: they use a draft model to speculate several subse-
quent tokens and then use the original (base) LLM to verify
these tokens in parallel. Since the draft model requires much
fewer resources and the cost of verifying multiple tokens in
parallel is similar to the cost of generating a single token,
these methods can achieve considerable speedups. However,
their speedups are bounded by the token acceptance rate
(§4.1), i.e., the fraction of tokens generated by the draft
model that passes the verification test of the base model.
This is because every token that fails verification needs to
be regenerated by the base model. In the worst case, if most
proposed tokens fail verification, these methods may slow
down the decoding process. Therefore, achieving a high ac-
ceptance rate is essential for these methods. Unfortunately,
training a draft model to achieve a high acceptance rate is
non-trivial, and the trained draft model does not generalize
across base models and datasets.
To address these problems, this paper develops LOOKA -
HEAD DECODING . We build upon a key observation: autore-
gressive decoding can be equivalently formulated as solv-
ing a non-linear system via the fixed point Jacobi iteration
method ( §2), which we term as Jacobi decoding (Santilli
et al., 2023). Each Jacobi decoding step can generate multi-
ple tokens in parallel at different positions. Although these
tokens may appear at incorrect positions, we can leverage
this parallel generation approach to have the LLM generate
several disjoint n-grams in parallel in a single step. These
n-grams could potentially be integrated into future parts of
the generated sequence, pending verification by the base
model to maintain the output distribution.
LOOKAHEAD DECODING takes advantage of the partic-
ular characteristics of autoregressive","[0.02793744020164013, 0.016577044501900673, 0.022402534261345863, 0.02245788276195526, -0.0507550947368145, 0.015926694497466087, -0.00965841207653284, -0.008800501003861427, -0.018002282828092575, 0.026083247736096382, 0.03428874537348747, 0.0007606172584928572, -0.06409421563148499, 0.00606418214738369, -0.03138291835784912, -0.06309793144464493, 0.027204066514968872, -0.053079754114151, 0.014446105808019638, 0.04040481895208359, -0.014446105808019638, -0.017338095232844353, 0.0348975844681263, 0.029113609343767166, 0.018265191465616226, -0.0484304316341877, 0.0170751865953207, 0.048347409814596176, 0.027466973289847374, -0.07494263350963593, -0.0025754612870514393, -0.022070439532399178, -0.021682996302843094, -0.005998454988002777, -0.020949620753526688, 0.04856880381703377, 0.0265398770570755, -0.02622161991894245, -0.030165240168571472, 0.0008371546282432973, 0.008724396117031574, -0.03522967919707298, -0.04737880080938339, 0.012301329523324966, -0.012162957340478897, 0.0502292774617672, 0.044417623430490494, 0.012073014862835407, -0.013982557691633701, 0.05532139167189598, -0.04945439100265503, 0.02461649663746357, -0.019524382427334785, 0.022582419216632843, -0.05067206919193268, 0.0016916057793423533, -0.008378464728593826, 0.031106173992156982, 0.04513716325163841, 0.014598316513001919, 0.022969862446188927, -0.032213155180215836, -0.01744879223406315, -0.010883009992539883, -0.05905745178461075, -0.011360395699739456, -0.033790603280067444, 0.012315167114138603, -0.00658999802544713, 0.02501777745783329, -0.011471093632280827, 0.023108234629034996, 0.03146594390273094, -0.028892211616039276, -0.05330115184187889, -0.022942187264561653, -0.003985132556408644, 0.06287653744220734, 0.02730092592537403, 0.012315167114138603, 0.031853388994932175, 0.03957458212971687, 0.014916572719812393, -0.06160350888967514, 0.0156499482691288, -0.0443069264292717, 0.017863910645246506, 0.007555147632956505, -0.020008686929941177, -0.04256343096494675, -0.021143343299627304, 0.047406475991010666, -0.06105002015829086, 0.014238547533750534, 0.012827145867049694, 0.049841832369565964, 0.010447136126458645, -0.04065388813614845, 0.07588356733322144, 0.03030361421406269, 0.011533361859619617, -0.016826115548610687, 0.04851345717906952, -0.044500648975372314, 0.05313510447740555, -0.017379606142640114, -0.044500648975372314, 0.026664411649107933, -0.024768706411123276, -0.006662643980234861, -0.05482324957847595, 0.017421118915081024, -0.04474971815943718, -0.022250324487686157, 0.007894160225987434, -0.033292461186647415, -0.06641887873411179, -0.0022866083309054375, -0.01973194256424904, 0.005310051143169403, -0.019386010244488716, 0.012688773684203625, 0.014570641331374645, -0.00678026070818305, -0.022610092535614967, -0.018957054242491722, 0.03428874537348747, -0.06105002015829086, 0.008869688026607037, -0.017338095232844353, 0.0212540403008461, 0.03080175444483757, 0.012079933658242226, -0.04837508499622345, -0.044639021158218384, -0.022042766213417053, -0.019607406109571457, -0.0042238254100084305, -0.02689964510500431, 0.00023696318385191262, 0.03290501981973648, -0.01582983322441578, -0.028643140569329262, -0.017919259145855904, -0.041539475321769714, 0.018984729424118996, 0.009478527121245861, -0.016341811046004295, -0.030386637896299362, 0.00710543617606163, -0.03608759120106697, -0.05501697212457657, -0.018279029056429863, 0.004704670514911413, -0.031133849173784256, -0.013602033257484436, -0.03976830467581749, 0.005524528678506613, 0.02339881658554077, -0.02385544776916504, -0.015137969516217709, 0.020659038797020912, 0.022762302309274673, 0.032074782997369766, -0.005361940711736679, 0.05374394357204437, -0.06116071715950966, -0.002070401096716523, -0.0601644329726696, -0.010045855306088924, -0.019607406109571457, -0.037720389664173126, -0.03412269800901413, -0.025003939867019653, 0.016383323818445206, 0.00503330584615469, -0.032434552907943726, -0.04101365804672241, -0.017960771918296814, -0.06287653744220734, -0.03583851829171181, 0.0418715663254261, 0.004870717879384756, 0.009388585574924946, -0.041982267051935196, -0.010059692896902561, 0.006859824992716312, 0.02219497598707676, -0.011830862611532211, 0.028864538297057152, -0.015234829857945442, 0.053771618753671646, 0.05689883977174759, 0.028172673657536507, 0.017365768551826477, -0.01785007305443287, 0.07499798387289047, 0.00035782306804321706, 0.03052501007914543, -0.059112802147865295, 0.023966144770383835, -0.009098002687096596, -0.023800097405910492, -0.049841832369565964, 0.02227799966931343, 0.008710559457540512, -0.0006633239681832492, -0.0006909985095262527, -0.005797814577817917, -0.05341184884309769, 0.00557295884937048, -0.03666875511407852, 0.04339366778731346, 0.002485519042238593, 0.002936959732323885, -0.023205095902085304, -0.0007848324603401124, 0.02081124857068062, 0.008087881840765476, 0.017767049372196198, -0.000654675648547709, 0.009104921482503414, -0.023592539131641388, 0.062212347984313965, -0.02743929997086525, 0.014266221784055233, 0.026747435331344604, -0.026733599603176117, 0.04026644676923752, 0.006897877436131239, 0.037914108484983444, -0.039214812219142914, -0.0010671991622075438, -0.01257807482033968, 0.021987415850162506, -0.02761918306350708, 0.024810219183564186, -0.044362276792526245, -0.0033641853369772434, -0.02079741097986698, 0.003791410941630602, -0.009609981440007687, 0.015096457675099373, -0.02927965484559536, -0.04605042189359665, 0.022845325991511345, -0.054269757121801376, -0.033790603280067444, 0.053024403750896454, 0.009063409641385078, -0.02435358799993992, -0.0443069264292717, -0.03819085657596588, 0.015304016880691051, -0.0565667450428009, 0.010903766378760338, -0.021627647802233696, 0.021461600437760353, -0.04865182936191559, 0.006956685800105333, -0.02757767215371132, -0.014861224219202995, -0.0019683511927723885, 0.02251323312520981, -0.0030545764602720737, -0.012342841364443302, 0.0032828913535922766, 0.028615467250347137, -0.006199095398187637, -0.0005508961621671915, -0.01636948622763157, -0.03428874537348747, 0.01963508129119873, 0.03680712729692459, -0.01329761277884245, -0.04629949480295181, 0.04120738059282303, 0.002122290665283799, -0.01681227795779705, 0.036032240837812424, 0.007492879871279001, 0.004950282163918018, 0.06603143364191055, 0.019178451970219612, -0.002990579232573509, 0.01048864796757698, -0.028836863115429878, -0.04156714677810669, -0.04901159927248955, 0.0007792110554873943, -0.006915173958986998, -0.037415970116853714, 0.027674533426761627, -0.028172673657536507, 0.038273878395557404, 0.02600022405385971, 0.0023419572971761227, 0.0077972994185984135, -0.0013188644079491496, 0.013892615213990211, 0.047185078263282776, 0.0009556362056173384, -0.006116071715950966, -0.02474103309214115, -0.025432895869016647, 0.021599972620606422, -0.03403967618942261, 0.0010006072698161006, 0.00524432398378849, -0.009741435758769512, 0.025626616552472115, 0.022651605308055878, -0.00334515911526978, -0.007485961075872183, -0.03570014610886574, -0.05031229928135872, 0.046161118894815445, -0.06603143364191055, 0.030746405944228172, -0.07516402751207352, -0.04701903089880943, -0.012854820117354393, -0.010571671649813652, -0.021489275619387627, 0.0069359298795461655, 3.880920849042013e-05, 0.016438672319054604, -0.004915689118206501, 0.00513362605124712, -0.019967176020145416, 0.031991761177778244, 0.04101365804672241, 0.014321570284664631, 0.011311965063214302, -0.031410593539476395, -0.057452328503131866, -0.05031229928135872, -0.009091083891689777, 0.05576418340206146, 0.006192176602780819, -0.07250727713108063, 0.04093063250184059, 0.015165643766522408, 0.006340927444398403, -0.01398947648704052, -0.0009521768661215901, -0.007430612109601498, -0.013525927439332008, 0.04209296405315399, -0.0176563523709774, -0.01439075730741024, -0.01632797345519066, 0.038661323487758636, -0.016798442229628563, 0.05081044137477875, 0.02950105257332325, -0.014598316513001919, -0.03470386564731598, -0.005441504996269941, 0.006967063527554274, -0.01991182565689087, 0.035395726561546326, -0.008129393681883812, 0.026124758645892143, -0.01591285690665245, -0.002298715990036726, -0.049122296273708344, 0.01407941896468401, 0.020603690296411514, 0.00031068988027982414, 0.029556401073932648, 0.055127669125795364, -0.026415342465043068, 0.03102315217256546, -0.03960225731134415, -0.003265594830736518, 0.009250212460756302, 0.026664411649107933, 0.013373717665672302, 0.04397483170032501, 0.011014464311301708, 0.01493041031062603, -0.02151694893836975, -0.007818055339157581, 0.03464851528406143, 0.04939904063940048, -0.022485557943582535, -0.02753615938127041, -0.02415986731648445, -0.0006922957254573703, -0.044500648975372314, 0.0006257038912735879, 0.005123247858136892, 0.03713922202587128, 0.0059742396697402, 0.00986597128212452, 0.002167261904105544, 0.05545976385474205, 0.04214831441640854, 0.01951054483652115, 0.01963508129119873, -0.018957054242491722, -0.01569145917892456, -0.023730911314487457, 0.016618557274341583, 0.034012001007795334, 0.01481971237808466, 0.05601325258612633, 0.06846679747104645, 0.03340316191315651, 0.03622596338391304, -0.01185853686183691, 0.04743414744734764, -0.031770363450050354, 0.04380878433585167, -0.005355021916329861, 0.02327428199350834, 0.008399221114814281, 0.04129040241241455, 0.046105772256851196, 0.013366799801588058, -0.012951681390404701, -0.06625283509492874, -0.038273878395557404, -0.028615467250347137, 0.0037637364584952593, 0.031189197674393654, -0.02878151461482048, 0.027951277792453766, -0.06885423511266708, -0.02649836428463459, 0.010357193648815155, 0.05800582095980644, -0.05271998420357704, -0.04903927072882652, 0.022803815081715584, -0.007202296983450651, 0.031410593539476395, 0.007741950452327728, -0.07366960495710373, -0.007153866812586784, 0.031189197674393654, -0.049066945910453796, 0.018846357241272926, -0.014058662578463554, 0.01677076704800129, -0.06138211488723755, 0.01143650058656931, 0.017006000503897667, -0.009990505874156952, 0.036253638565540314, 0.004258418921381235, 0.04076458513736725, -0.008288522250950336, -0.009609981440007687, -0.04256343096494675, 0.09542179107666016, -0.03030361421406269, 0.01463982742279768, -0.034731537103652954, 0.006541567854583263, -0.030414311215281487, -0.026166271418333054, -0.02147543802857399, -0.014224709942936897, 0.0016414456767961383, 0.0307187307626009, 0.028172673657536507, 0.012737203389406204, 0.004251500125974417, 0.024713357910513878, -0.013830347917973995, -0.011969235725700855, 0.0033641853369772434, -0.02537754736840725, 0.0330987423658371, 0.03874434530735016, -0.04383645951747894, -0.018818682059645653, -0.017061349004507065, -0.03946388512849808, 0.006212932523339987, 0.050589047372341156, 0.0007247268222272396, -0.014667502604424953, 0.04524786025285721, 0.0032984584104269743, -0.004625106230378151, -0.03600456565618515, -0.018403563648462296, 0.02551591955125332, -0.016244951635599136, 0.03143826872110367, -0.016148090362548828, -0.023108234629034996, -0.006091856397688389, -0.00781113700941205, -0.015027271583676338, 0.032849669456481934, 0.015373202972114086, 0.018583448603749275, -0.0063063339330255985, -0.007714276202023029, 0.05097648873925209, -0.0010533619206398726, -0.0070639243349432945, 0.0125573193654418, 0.019759615883231163, -0.02027159556746483, 0.012017665430903435, 0.001304162316955626, 0.032296180725097656, -0.0026342696510255337, -0.008219336159527302, -0.028836863115429878, 0.02568196691572666, -0.05717558413743973, 0.009720679372549057, -0.00637897988781333, 0.0012799471151083708, 0.030746405944228172, -0.02285916358232498, 0.011464174836874008, 0.0013742134906351566, 0.02309439703822136, -0.016120415180921555, -0.026263130828738213, -0.10981254279613495, -0.022762302309274673, 0.00784572958946228, 0.017684025689959526, 0.0023315793368965387, -0.008904281072318554, 0.001625014003366232, -0.033735256642103195, -0.004870717879384756, -0.03769271448254585, -0.018099144101142883, -0.06702771782875061, -0.057009536772966385, 0.0028591251466423273, 0.01717204786837101, 0.008648291230201721, 0.010232658125460148, -0.005213190335780382, -0.007389100268483162, 0.01533169113099575, -0.037914108484983444, -0.006759504787623882, 0.041179705411195755, 0.018943218514323235, -0.0348975844681263, 0.01595436781644821, -0.03348618373274803, -0.015580762177705765, -0.004950282163918018, 0.0026256213895976543, 0.0032327312510460615, -0.005130166653543711, -0.02287300117313862, 0.012273655273020267, -0.0009815810481086373, -0.018707985058426857, 0.006330549251288176, -0.0033468888141214848, 0.013733486644923687, -0.0016466346569359303, -0.024588821455836296, 0.015137969516217709, 0.02493475377559662, -0.0018611123086884618, -0.01837589032948017, 0.014044824987649918, 0.0028210727032274008, -0.014252384193241596, -0.016507858410477638, 0.004587053786963224, 0.005379237234592438, 0.02362021431326866, 0.019289148971438408, -0.04818136245012283, -0.027826743200421333, -0.022969862446188927, -0.025003939867019653, -0.05233254283666611, 0.004296471364796162, -0.021821368485689163, 0.03340316191315651, -0.036558058112859726, 0.010108123533427715, 0.02519766241312027, -0.00010021207708632573, -0.016148090362548828, 0.001951054553501308, -0.04073691368103027, 0.013456741347908974, 0.006773341912776232, -0.005192434415221214, -0.024284401908516884, -0.014584478922188282, 0.009561550803482533, 0.011464174836874008, -0.014335407875478268, -0.012273655273020267, 0.011270453222095966, -0.01143650058656931, -0.04657623916864395, 0.02393847145140171, 0.055127669125795364, -0.023371143266558647, -0.0030044163577258587, 0.024408938363194466, 0.006143746431916952, -0.030995476990938187, -0.043476689606904984, 0.02255474403500557, -0.014888898469507694, -0.033015716820955276, 0.05150230601429939, -0.011173592880368233, 0.03171501308679581, -0.01937217265367508, 0.03766503930091858, 0.011540279723703861, 0.02977779693901539, 0.00018474912212695926, -0.03752666711807251, -0.011215104721486568, 0.0077004386112093925, -0.018458914011716843, -0.022361023351550102, -0.0250592902302742, 0.009506202302873135, 0.017919259145855904, 0.012571156956255436, 0.006610753946006298, -0.0026965371798723936, -0.0176563523709774, 0.015193318948149681, -0.020506829023361206, -0.0036149858497083187, 0.03456548973917961, 0.01671541854739189, -0.006586538627743721, 0.028449419885873795, 0.007299158256500959, 0.009208700619637966, -0.006759504787623882, -0.0029594453517347574, -0.007582821883261204, 0.007977183908224106, -0.017628677189350128, 0.08108638226985931, 0.03174268826842308, 0.047461822628974915, -0.004393332172185183, 0.03586619347333908, 0.0003450668300502002, 0.04148412495851517, 0.019386010244488716, -0.04331064224243164, -0.011173592880368233, -0.03888271749019623, -0.019939500838518143, -0.0018628420075401664, 0.028809187933802605, 0.00833695288747549, 0.020465316250920296, -0.0010775771224871278, -0.005040224175900221, -0.031631991267204285, 0.01815449260175228, 0.027743719518184662, -0.017019838094711304, -0.01851426251232624, -0.022319510579109192, -0.010343356989324093, -0.03204710781574249, -0.031853388994932175, -0.014612153172492981, -0.02963942475616932, 0.004600890912115574, -0.054048363119363785, -0.028449419885873795, 0.0038502193056046963, 0.008662128821015358, 0.04129040241241455, -0.017227396368980408, 0.02963942475616932, -0.016355648636817932, -0.008897362276911736, -0.02716255374252796, 0.0005145733593963087, -0.016397161409258842, 0.05291370674967766, -0.0013396203285083175, 0.005555662326514721, 0.03578317165374756, -0.026788948103785515, -0.05003555491566658, 0.0034178048372268677, 0.021406251937150955, 0.0016518236370757222, -0.022167300805449486, 0.009374747984111309, -0.033513858914375305, -0.01551157608628273, 0.026193944737315178, 0.024201378226280212, -0.010329519398510456, -0.006648806389421225, 0.008489162661135197, -0.009326317347586155, 0.002277960069477558, -0.038218528032302856, 0.018901705741882324, -0.0009158540633507073, -0.02739778719842434, -0.009907483123242855, -0.03672410547733307, -0.060053735971450806, 0.007977183908224106, -0.00811555702239275, -0.009907483123242855, -0.004348360933363438, -0.025294523686170578, -0.0034178048372268677, 0.03545107692480087, -0.009582307189702988, 0.029750123620033264, 0.012287492863833904, 0.020520666614174843, 0.041041333228349686, -0.040460165590047836, -0.012100689113140106, 0.016784604638814926, -0.051225561648607254, -0.02461649663746357, -0.0014650205848738551, 0.017158210277557373, 0.013546683825552464, -0.028131162747740746, -0.0068425280041992664, 0.040958307683467865, 0.017407281324267387, -0.018860194832086563, 0.029750123620033264, 0.03846760094165802, 0.007838811725378036, -0.0001343728363281116, -0.03639201074838638, 0.013062379322946072, -0.020548339933156967, -0.023384980857372284, 0.009270968846976757, 0.004230744205415249, 0.010931440629065037, 0.009423178620636463, -0.02223648689687252, -0.01901240460574627, 0.0033849412575364113, -0.0018939758883789182, 0.008821257390081882, -0.005638686008751392, 0.0016786333872005343, -0.019538220018148422, -0.028532443568110466, -0.029750123620033264, 0.031548965722322464, 0.019164614379405975, 0.014487617649137974, 0.018445076420903206, 0.05056137219071388, 0.030857104808092117, 0.01535936538130045, -0.004849961958825588, 0.02568196691572666, 0.04115203022956848, -0.002840098924934864, 0.029335005208849907, -0.03713922202587128, -0.021060319617390633, -0.012342841364443302, -0.01160946674644947, 0.003919405862689018, -0.011201267130672932, -0.018389727920293808, 0.0012756229843944311, -0.0024440072011202574, -0.02977779693901539, -0.003381481859833002, -0.0156499482691288, 0.006060722749680281, 0.004922607447952032, 0.013415229506790638, 0.039214812219142914, -0.0009980128379538655, -0.10804137587547302, -0.006956685800105333, 0.019109264016151428, 0.007679682690650225, -0.012135283090174198, -0.00939550343900919, 0.01636948622763157, 0.02425672858953476, 0.006313252728432417, -0.013885696418583393, -0.005123247858136892, -0.03260060027241707, -0.0008241821778938174, -0.010135797783732414, 0.0019527842523530126, -0.041179705411195755, -0.020548339933156967, -0.029888495802879333, 0.026110921055078506, -0.017476467415690422, -0.017199723049998283, -0.015899019315838814, 0.017601002007722855, 0.0203546192497015, -0.005621389485895634, 0.008212417364120483, -0.004573216661810875, 0.00853759329766035, -0.007354507222771645, 0.04220366105437279, -0.0016362566966563463, -0.003412615740671754, -0.000610136950854212, 0.006773341912776232, 0.0052477833814918995, -0.011069812811911106, -0.011879293248057365, -0.025322197005152702, 0.00698090111836791, 0.002002944238483906, -0.019801128655672073, -0.04223133623600006, 0.02842174470424652, -0.014148605056107044, 0.017877748236060143, -0.014999596402049065, 0.003791410941630602, -0.006212932523339987, -0.00793567206710577, -0.021959742531180382, -0.009755272418260574, -0.004881095606833696, -0.00017458738875575364, 0.011394988745450974, -0.001849004765972495, 0.0014044825220480561, -0.02475486882030964, 0.013733486644923687, -0.002542597707360983, 0.02483789250254631, -0.007112354971468449, 0.022610092535614967, 0.017517980188131332, 0.007430612109601498, -0.009264050051569939, -0.02811732515692711, -0.016784604638814926, 0.04245273396372795, -0.044639021158218384, -0.039297837764024734, 0.008461488410830498, -0.010336438193917274, 0.003466235240921378, 0.0336245559155941, 0.010966033674776554, -0.0014442646643146873, -0.004971038084477186, 0.03514665737748146, -0.04286785051226616, 0.018984729424118996, 0.04582902789115906, -0.040709238499403, -0.012598831206560135, -0.014625990763306618, 0.01378883607685566, 0.014162441715598106, 0.03841225057840347, 0.002250285353511572, -0.017476467415690422, 0.035035960376262665, 0.02605557255446911, -0.002229529432952404, 0.005870460066944361, -0.003576933406293392, -0.008731314912438393, -0.018099144101142883, -0.0032171644270420074, 0.02703801915049553, 0.031106173992156982, -0.01949670910835266, 0.04062621295452118, 0.03273897245526314, -0.02121252939105034, -0.038578297942876816, 0.0003746872243937105, -0.015013433992862701, 0.022319510579109192, -0.011166674084961414, 0.011159755289554596, -0.016355648636817932, -0.0063236309215426445, 0.004749641753733158, -0.03428874537348747, 0.03509130701422691, 0.008253929205238819, 0.04317227005958557, 0.019704267382621765, 0.018223680555820465, 0.040100399404764175, -0.01237743441015482, -0.024561148136854172, 0.0135605214163661, -0.02053450420498848, -0.004549001343548298, -0.022388696670532227, -0.009720679372549057, 0.01819600537419319, 0.023052886128425598, 0.015165643766522408, -0.025903362780809402, -0.013387555256485939, 0.013352962210774422, 0.023910796269774437, -0.00030485226307064295, -0.0024284401442855597, -0.009907483123242855, -0.022582419216632843, 0.028089649975299835, -0.03384595364332199, 0.034095022827386856, 0.024865567684173584, -0.007188459858298302, 0.048347409814596176, 0.011062894947826862, 0.024962428957223892, 0.013837266713380814, 0.005932727828621864, 0.00029620397253893316, -0.02465800940990448, 0.026484528556466103, 0.006372061092406511, 0.008060207590460777, -0.014487617649137974, 0.011090569198131561, 0.013228426687419415, 0.024491962045431137, -0.0027155636344105005, -0.0372222475707531, 0.015553086996078491, 0.022167300805449486, 0.0672491118311882, 0.038855042308568954, -0.0030147943180054426, -0.010447136126458645, 0.022789977490901947, -0.02249939553439617, -0.018126819282770157, -0.007070843130350113, -0.042840175330638885, -0.01843123883008957, -0.013449822552502155, -0.012764878571033478, 0.04184389486908913, 0.011311965063214302, 0.04173319414258003, 0.010350274853408337, 0.005503772757947445, 0.014114012010395527, 0.028532443568110466, 0.020659038797020912, -0.006655725184828043, 0.020465316250920296, 0.015982042998075485, 0.02067287638783455, 0.0002555570099502802, -0.006091856397688389, 0.007942590862512589, 0.004251500125974417, -0.008613698184490204, 0.0431445948779583, 0.021724509075284004, 0.028532443568110466, -0.01511029526591301, 0.02479638159275055, -0.016839953139424324, -0.023564863950014114, 0.02349567785859108, 0.04151180014014244, -0.005645604804158211, -0.010986789129674435, -0.03733294457197189, 0.04909462109208107, 0.014169360511004925, -0.008911199867725372, -0.015580762177705765, 0.00688058091327548, 0.01077923085540533, -0.003805248299613595, 0.002990579232573509, 0.030026867985725403, -0.00965841207653284, -0.006593457423150539, -0.04444529861211777, 0.057230934500694275, -0.011692490428686142, -0.04657623916864395, 0.008392302319407463, 0.007389100268483162, -0.036253638565540314, -0.010972952470183372, -0.006181798875331879, -0.04151180014014244, -0.02075590007007122, 0.023564863950014114, -0.028864538297057152, 0.04051551595330238, 0.018265191465616226, -0.004974497482180595, -0.036475032567977905, -0.01785007305443287, 0.012619586661458015, -0.009900564327836037, 0.007859567180275917, 0.00482920603826642, -0.022388696670532227, -0.015276341699063778, -0.02079741097986698, -0.008205498568713665, -0.015068783424794674, 0.0009539065649732947, 0.008087881840765476, 0.0030995476990938187, -0.03462084010243416, -0.010440217331051826, 0.0018074929248541594, -0.012910169549286366, 0.008288522250950336, 0.04331064224243164, -0.013283776119351387, 0.005237405188381672, 0.009637655690312386, 0.02891988679766655, 0.03796945884823799, -0.000773157284129411, -0.001880138530395925, 0.006621132139116526, 0.021849043667316437, 0.03570014610886574, 0.02551591955125332, 0.02914128266274929, -0.016701580956578255, 0.0348975844681263, 0.003154896665364504, -0.0238969586789608, -0.006257903762161732, -0.030386637896299362, -0.03376293182373047, 0.005994995590299368, 0.00037555204471573234, 0.005365400109440088, -0.0017236045096069574, 0.018957054242491722, 0.0008985574822872877, 0.023703237995505333, 0.009270968846976757, -0.005880838260054588, 0.0013456741580739617, -0.019289148971438408, -0.0016526884865015745, 0.006233688443899155, -0.01183778140693903, -0.00761049659922719, -0.04676996171474457, -0.019109264016151428, 0.009554632008075714, -0.03406735137104988, -0.03492525964975357, 0.005545284599065781, 0.04571832716464996, -0.030635707080364227, 0.02215346321463585, 0.029307330027222633, 0.0022831489332020283, 0.010419461876153946, -0.00012431919458322227, -0.032296180725097656, 0.014736688695847988, -0.018901705741882324, 0.023883121088147163, 0.0008682884508743882, 0.02179369516670704, 0.02353719063103199, 0.013325287960469723, -0.02994384430348873, 0.015082620084285736, 0.0076243337243795395, 0.008378464728593826, -0.03661340847611427, -0.01295860018581152, -0.008094800636172295, -0.028864538297057152, 0.02635999210178852, 0.019482871517539024, 0.010654695332050323, 0.036917828023433685, -0.016535533592104912, -0.02111566811800003, -0.014017150737345219, 0.030995476990938187, -0.028864538297057152, 0.01618960127234459, 0.008592942729592323, -0.00012367057206574827, 0.007568984758108854, 0.004382953979074955, -0.028172673657536507, 0.012273655273020267, -0.0026705923955887556, -0.001296378904953599, -0.004452140536159277, 0.018943218514323235, -0.012114526703953743, 0.0306633822619915, -0.0066695623099803925, -0.013664300553500652, 0.007534391712397337, -0.00608839699998498, 0.023772424086928368, 0.009153352119028568, -0.00945777166634798, 0.028726164251565933, 0.014197035692632198, 0.017767049372196198, 0.021226366981863976, -0.022347185760736465, 0.011132081039249897, 0.009817540645599365, -0.025211500003933907, 0.010952196083962917, -0.026166271418333054, 0.07427844405174255, -0.023329630494117737, -0.015207155607640743, 0.007043168414384127, -0.014722851105034351, -0.01347057893872261, -0.011339640244841576, -0.014030988328158855, -0.01645250990986824, -0.003563096048310399, 0.008523755706846714, 0.024049168452620506, 0.014446105808019638, -0.005237405188381672, 0.01631413772702217, -0.037498991936445236, 0.001985647715628147, 0.04403018206357956, 0.012252899818122387, 0.04771089553833008, 0.018680309876799583, 0.02761918306350708, -0.010820742696523666, -0.04231436178088188, -0.020506829023361206, -0.004376035649329424, 0.0066176727414131165, 0.01340831071138382, 0.020147059112787247, 0.018403563648462296, 0.0047842347994446754, -0.010191146284341812, -0.04021109640598297, 0.010371031239628792, -0.012481214478611946, 0.028587792068719864, -0.010115041397511959, 0.017241233959794044, -0.0312445480376482, -0.010931440629065037, 0.017808562144637108, 0.009174107573926449, -0.0011009274749085307, -0.006929011084139347, -0.01284098345786333, 0.021129505708813667, 0.008406138978898525, -0.011464174836874008, 0.003123762784525752, 0.004690833389759064, 0.004735804628580809, -0.0007718600099906325, 0.04361506551504135, -0.013927208259701729, -0.0030251722782850266, -0.026512201875448227, -0.010661614127457142, 0.03428874537348747, 0.03810783103108406, 0.014916572719812393, -0.04668693616986275, 0.03273897245526314, -0.064924456179142, -0.02501777745783329, 0.001854193746112287, -0.02721790224313736, 0.009187945164740086, 0.019206125289201736, -0.005621389485895634, 0.04032179340720177, -0.036834802478551865, 0.003964376635849476, -0.004130424000322819, 0.0017728997627273202, 0.002789938822388649, -0.0024042250588536263, -0.017407281324267387, 0.0031099256593734026, 0.023592539131641388, 0.030054543167352676, 0.008489162661135197, 6.680805381620303e-05, -0.00018301946693100035, 0.01347057893872261, -0.01481971237808466, -0.0017374417511746287, 0.016037391498684883, -0.008876606822013855, 0.020866597071290016, 0.023841610178351402, -0.025294523686170578, 0.01140882633626461, 0.02335730567574501, -0.004721967037767172, 0.01360895112156868, -0.022111952304840088, -0.018057633191347122, -0.02635999210178852, 0.040460165590047836, -0.0026014060713350773, -0.023841610178351402, -0.011249697767198086, -0.02169683389365673, -0.0011234130943194032, 0.0029957680962979794, -0.002421521581709385, -0.06658492237329483, -0.005227027460932732, 0.012771796435117722, 0.006140287034213543, 0.024588821455836296, -0.03752666711807251, 0.025253010913729668, -0.008807419799268246, 0.004002429079264402, 0.013830347917973995, 0.015027271583676338, 0.01767018996179104, 0.015290179289877415, -0.04223133623600006, 0.019469033926725388, 0.017199723049998283, 0.020921947434544563, 0.020299268886446953, -0.012245981022715569, -0.024201378226280212, -0.0059361872263252735, 0.018749495968222618, 0.006420491728931665, -0.023786261677742004, -0.024422775954008102, -0.017545653507113457, -0.014363082125782967, -0.0009331506444141269, -0.016895301640033722, 0.053771618753671646, 0.01605122908949852, -0.01151952426880598, 0.002321201376616955, -0.019136939197778702, 0.0277575571089983, 9.140162728726864e-05, -0.019469033926725388, 0.009983588010072708, -0.01481971237808466, 0.018306704238057137, 0.026844296604394913, 0.005002171732485294, 0.01703367568552494, 0.0064274100586771965, -0.0011943290010094643, 0.03345850855112076, -0.012052259407937527, -0.02523917332291603, -0.004244581330567598, 0.0071607851423323154, -0.003826004220172763, -0.01891554333269596, 0.03058035857975483, -0.007499798201024532, -0.0018023039447143674, -0.027854416519403458, -0.01578832045197487, 0.029694773256778717, 0.041677847504615784, -0.0007082950905896723, -0.028477095067501068, 0.006458544172346592, 0.025903362780809402, -0.004763478878885508, -0.0014840468065813184, 0.00010356328857596964, -0.01595436781644821, -0.015746809542179108, -0.016839953139424324, -0.03874434530735016, -0.03290501981973648, -0.006237147841602564, 0.009153352119028568, 0.04325529560446739, -0.01329069398343563, -0.01967659220099449, 0.04311692342162132, 0.009513121098279953, -0.007707357406616211, -0.010592427104711533, 0.013858022168278694, 0.009623819030821323, -0.015802158042788506, 0.013124647550284863, 0.018403563648462296, 0.022665442898869514, -0.005825489293783903, 0.004998712334781885, 0.01120818592607975, 0.022610092535614967, 0.002845287788659334, 0.004099290352314711, 0.019302986562252045, 0.03564479947090149, 0.009125676937401295, -0.014570641331374645, 0.002603135770186782, 0.016203438863158226, 0.015926694497466087, 0.011768595315515995, -0.03320943936705589, 0.006756045389920473, 0.02143392525613308, 0.010322600603103638, 0.0036011484917253256, -0.029307330027222633, 0.009326317347586155, 0.029224306344985962, 0.014695176854729652, 0.01735193282365799, 0.0024336292408406734, 0.012861738912761211, -0.03650270774960518, -0.03700084984302521, 0.010620102286338806, 0.010308763012290001, 0.005026387050747871, 0.01931682415306568, -0.023426491767168045, 0.03666875511407852, -0.01632797345519066, 0.01329069398343563, -0.013664300553500652, 0.020050199702382088, -0.011187429539859295, -0.014722851105034351, 0.009298643097281456, -0.0018991648685187101, 0.0040266443975269794, -0.007887241430580616, -0.012093771249055862, -0.023011373355984688, 0.011457256972789764, 0.016466347500681877, 0.003007875755429268, 0.018279029056429863, 0.02457498572766781, 0.0088558504357934, 0.006949767004698515, 0.04649321362376213, 0.01578832045197487, 0.026332318782806396, -0.025003939867019653, -0.0035008282866328955, -0.008689803071320057, 0.0484304316341877, 0.009471609257161617, -0.03102315217256546, 0.010454054921865463, -0.026166271418333054, -0.0036876315716654062, 0.00024063870660029352, -0.011450338177382946, 0.046520888805389404, 0.005994995590299368, -0.003981673624366522, 0.010052774101495743, 0.0271763913333416, -0.027466973289847374, 0.01645250990986824, -0.0044210064224898815, 0.012418946251273155, -0.024920916184782982, -0.000224855582928285, -0.00323965004645288, 0.01879100687801838, 0.007285320665687323, -0.012446621432900429, 0.03146594390273094, -0.0053688595071434975, -0.008904281072318554, -0.02833872102200985, -0.001425238442607224, -0.007402937393635511, 0.030414311215281487, 0.018749495968222618, -0.005569499917328358, -0.015165643766522408, 0.005929268430918455, -0.024063006043434143, -0.025128476321697235, 0.00019901880295947194, 0.010239576920866966, 0.009969750419259071, 0.0069428482092916965, 0.017504142597317696, -0.0026602144353091717, -0.008288522250950336, 0.00607455987483263, 0.007437530905008316, -0.022402534261345863, 0.004005888476967812, -0.008482243865728378, 0.02362021431326866, -0.014293896034359932, 0.0020237001590430737, -0.006050344556570053, 0.021060319617390633, 0.011706327088177204, 0.030691057443618774, -0.0063513051718473434, 0.0443069264292717, -0.007568984758108854, -0.011879293248057365, 0.009741435758769512, -0.018140656873583794, 0.0037118466570973396, 0.005230486858636141, 0.022084277123212814, 0.012813308276236057, -0.006206014193594456, -0.01578832045197487, -0.0076935202814638615, 0.06282118707895279, 0.0074513680301606655, 0.007202296983450651, -0.031272221356630325, -0.018237516283988953, 0.037858761847019196, -0.03581084683537483, -0.006977441720664501, 0.021060319617390633, 0.051308583468198776, -0.007859567180275917, 0.050146251916885376, -0.01865263469517231, 0.0471574030816555, -0.01407941896468401, 0.0009253671742044389, 0.024727195501327515, 0.012515807524323463, 0.0032725133933126926, 0.04245273396372795, -0.014722851105034351, -0.019067753106355667, 0.006309793330729008, -0.051585327833890915, -0.01663239486515522, -0.0004920877981930971, 0.029833145439624786, -0.02927965484559536, 0.010454054921865463, -0.03619828820228577, 0.0032621356658637524, 0.03617061302065849, 0.016438672319054604, -0.0010196336079388857, -0.0027051856741309166, 0.0015791780315339565, 0.02519766241312027, 0.018541937693953514, 0.011111324653029442, -0.02393847145140171, -0.015802158042788506, -0.0306633822619915, -0.016535533592104912, 0.021503111347556114, 0.0022814192343503237, 0.011270453222095966, -0.006873662117868662, -0.024768706411123276, -0.0016025283839553595, -0.004950282163918018, 0.020479153841733932, 0.002803776180371642, 0.02335730567574501, 0.019302986562252045, -0.0031099256593734026, -0.009333236142992973, -0.007582821883261204, -0.005849704146385193, 0.0022658524103462696, 0.009942076168954372, -0.021724509075284004, -0.005932727828621864, -0.03802480921149254, 0.02753615938127041, -0.007894160225987434, 0.007949509657919407, 0.004158098716288805, 0.010772312059998512, 0.0015765834832563996, 0.008184743113815784]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" decoding, which is
bounded by the memory bandwidth–as each generated to-
ken depends on all tokens before it–rather than compute, by
1arXiv:2402.02057v1  [cs.LG]  3 Feb 2024
Lookahead decoding
using the available cycles to generate and verify n-grams
(subsequent tokens) at virtually no additional cost. In a
nutshell, LOOKAHEAD DECODING consists of a lookahead
branch that generates n-grams and a verification branch that
verifies n-grams, both executing in a single step. To improve
efficiency, we use an n-gram pool to cache the historical
n-grams generated so far. This way, LOOKAHEAD DECOD -
INGcan significantly reduce the latency of LLM inference
just by exploiting the compute resources that autoregressive
decoding would leave unused. More importantly, LOOKA -
HEAD DECODING scales with the compute – we show that
it can linearly reduce the number of decoding steps relative
to the log(FLOPs) allocated per step.
We have implemented the algorithm in both Python and
CUDA, compatible with memory-efficient attention algo-
rithms (e.g., FlashAttention (Dao, 2023)), and supports vari-
ous sampling methods without changing the output distribu-
tion. We also scale it to multiple GPUs, resulting in Looka-
head Parallelism . We evaluate LOOKAHEAD DECODING
on the popular LLaMA-2 (Touvron et al., 2023b) models.
It achieves 1.8x speedup on the challenging multi-turn chat
dataset MT-Bench (Zheng et al., 2023) and up to 4x speedup
in code completion tasks with Lookahead Parallelism on 8
GPUs. LOOKAHEAD DECODING showed significant poten-
tial in lowering the latency for latency-sensitive tasks. Our
contributions are summarized as follows.
•We design LOOKAHEAD DECODING , a new lossless,
parallel decoding algorithm to accelerate LLM infer-
ence without needing any auxiliary component.
•We reveal LOOKAHEAD DECODING ’s scaling behav-
ior: it linearly reduces the number of decoding steps
according to per-step log(FLOPs ). This enables trade-
offs between the number of decoding steps and per-step
FLOPs, making it future-proof.
•We show it benefits from the latest memory-efficient
attentions and is easily parallelizable by developing its
distributed CUDA implementations.
•We evaluated LOOKAHEAD DECODING and demon-
strate its effectiveness under different settings.
2. Background
In this section, we formulate both autoregressive and Jacobi
decoding from the lens of solving nonlinear systems.
Causal Attention in Decoder Models. Most contemporary
LLMs are composed of two core components: token-wise
modules (including MLP and normalization (Ba et al., 2016;
Zhang & Sennrich, 2019)) and attention (Vaswani et al.,
2023) modules. Tokens interact with each other in the atten-
tion modules, while in other token-wise modules, they are
processed without exchanging information with each other.The attention layer encompasses three input elements: query
Q, keyK, and value V, with the i-th token in each denoted
asQi,Ki, andVi, respectively. The attention layer exe-
cutes the following operation: O=softmax 
QKT
V. A
lower triangular mask applied to QKTin causal attentions
(specific to decoder models) ensures that Oiis calculated
only from QiandKj,Vjwhere j≤i. Because all other
layers in the LLM perform token-wise operations, for any
given model input xand output o,oi(i-th token in o) is
exclusively influenced by xj(j-th token in x) where j≤i.
Autoregressive Decoding in LLMs. LLMs take discrete
integer sequences as inputs, where each integer represents
a token. We notate x= (x1, x2, ..., x s)∈Nsof length s
as the input of the model, and xt
1:m= (x1, x2, ..., x m)to
denote a slice of xof length mat step t. LLMs’ output char-
acterizes the probability distribution of the next token. The
probability for the s-th token (i.e., the output of the s−1-th
token) is decided by all previous input tokens, represented as
PM(xs|x1:s−1). Then, the next token input xsis obtained
by sampling from PM(xs|x1:s−1)using different methods
","[0.030666718259453773, -0.0038165857549756765, 0.01135928463190794, 0.008229617960751057, -0.020788496360182762, 0.008557997643947601, 0.012847049161791801, -0.012170183472335339, -0.009020411409437656, 0.03586719185113907, 0.03543828800320625, -0.00765997776761651, -0.050637613981962204, 0.0021964635234326124, -0.0398077592253685, -0.05136139318346977, 0.020252365618944168, -0.032650403678417206, 0.015038486570119858, 0.04675066098570824, -0.03074713796377182, -0.025278598070144653, 0.02635085955262184, 0.04889518767595291, 0.02295982837677002, -0.025586873292922974, 0.002420968608930707, 0.04093363508582115, 0.014971470460295677, -0.05758051574230194, -0.017343852669000626, -0.01891203597187996, -0.04492781311273575, -0.01531995553523302, -0.023415541276335716, 0.03774365410208702, 0.02003791183233261, -0.019327538087964058, -0.026243634521961212, 0.0007359241717495024, -0.0072712828405201435, -0.06052923947572708, -0.07457588613033295, -0.003957320004701614, -0.005746658891439438, 0.03235553205013275, 0.02052043005824089, 0.012217095121741295, -0.02830773964524269, 0.09033814817667007, -0.05412247031927109, 0.025613678619265556, -0.04396277666091919, 0.028334546834230423, -0.05806303396821022, 0.022128824144601822, -0.02480948157608509, 0.027530349791049957, 0.03511660918593407, -0.0035016085021197796, 0.028602611273527145, -0.027034427970647812, -0.008464175276458263, -0.004939110949635506, -0.03688584268093109, -0.02707463689148426, -0.03602803125977516, 0.027168460190296173, -0.009898326359689236, 0.03283805027604103, 0.0032854804303497076, 0.012371232733130455, 0.026779765263199806, -0.014850840903818607, -0.0398077592253685, 0.00930188037455082, 0.007867729291319847, 0.027289090678095818, 0.06235208734869957, 0.015949910506606102, 0.06203040853142738, 0.0285221915692091, 0.019126489758491516, -0.029674874618649483, 0.02803967334330082, -0.033856701105833054, 0.020734883844852448, 0.005421629175543785, -0.03160494938492775, -0.04018305242061615, -0.02817370742559433, 0.03195343539118767, -0.06755255907773972, 0.03023781254887581, 0.031202849000692368, 0.040987249463796616, 0.008437368087470531, -0.0592961385846138, 0.0476352795958519, 0.033749472349882126, -0.0020205453038215637, -0.0060415309853851795, 0.05189752206206322, -0.04543713852763176, 0.04801056906580925, -0.014850840903818607, -0.04004901647567749, 0.014060046523809433, -0.04077279567718506, -0.007760502398014069, -0.03482173755764961, -0.0009951939573511481, -0.04240799695253372, 0.007499138358980417, 0.037797264754772186, -0.03731474652886391, -0.05484624579548836, 0.0069764102809131145, -0.019314134493470192, -0.003575326409190893, -0.005227281711995602, -0.00837035197764635, 0.029942940920591354, -0.004449890926480293, -0.0036557463463395834, -0.01708918996155262, 0.01353731844574213, -0.07339639216661453, 0.03873549774289131, -0.016767511144280434, 0.023616589605808258, 0.00145006796810776, 0.005649485159665346, -0.05232642963528633, -0.06964347511529922, -0.013222341425716877, -0.008316738530993462, -0.007050128187984228, -0.03956649824976921, 0.016204573214054108, 0.012981082312762737, -0.02999655343592167, -0.01664688065648079, -0.01568184420466423, -0.04787653684616089, 0.04436487704515457, 0.008330142125487328, 0.007827519439160824, -0.037663232535123825, -0.01482403464615345, -0.04106766730546951, -0.03433921933174133, -0.016660284250974655, 0.00035644363379105926, -0.03629609942436218, -0.016593268141150475, -0.06074369326233864, -0.00014167692279443145, 0.030425459146499634, -0.03683222830295563, -0.014716807752847672, 0.024836288765072823, 0.049779802560806274, 0.0008586479816585779, -0.03037184663116932, 0.03945927321910858, -0.053318269550800323, 0.003685903735458851, -0.05945697799324989, -0.005783517844974995, -0.02793244831264019, -0.031149236485362053, -0.027583962306380272, -0.032141078263521194, 0.021900968626141548, 0.01763872429728508, -0.03541148081421852, -0.046482596546411514, -0.03324015066027641, -0.06465744972229004, -0.053693562746047974, 0.026203423738479614, 0.0163654126226902, 0.01818825863301754, -0.04203270375728607, -0.02148546651005745, -0.001682950067333877, 0.019032666459679604, -0.009951939806342125, 0.011252058669924736, -0.015722054988145828, 0.04216673597693443, 0.060582853853702545, 0.031068816781044006, 0.003189982147887349, -0.01684793084859848, 0.06733810901641846, 0.01671389676630497, 0.03372266888618469, -0.04884157329797745, 0.011319074779748917, -0.00639001652598381, 0.00027288252022117376, -0.04482058808207512, 0.044284455478191376, 0.007974955253303051, -0.025452839210629463, -0.006249282043427229, -0.007076934911310673, -0.03278443589806557, 0.009764294140040874, -0.040719181299209595, 0.045008234679698944, 0.003913759719580412, 0.003464749315753579, -0.010514877736568451, -0.015453988686203957, 0.027959253638982773, 0.005796920973807573, 0.030559491366147995, 0.004784972872585058, 0.027744801715016365, 0.005887393373996019, 0.05246046185493469, -0.03892314061522484, 0.008517787791788578, 0.014395128935575485, -0.024782676249742508, 0.030693525448441505, -0.0030961590819060802, 0.031792595982551575, -0.027905641123652458, 0.0019250469049438834, -0.011982537806034088, 0.01156703568994999, -0.04744763299822807, -0.003060975344851613, -0.050155095756053925, 0.012994485907256603, -0.012753226794302464, -0.019877072423696518, -0.0020624306052923203, 0.02474246546626091, -0.02447439916431904, -0.03819936513900757, 0.033856701105833054, -0.046857886016368866, -0.01549419853836298, 0.03013058751821518, 0.02113698236644268, -0.028629418462514877, -0.022329874336719513, -0.02988932840526104, 0.035465095192193985, -0.045732010155916214, 0.015092100016772747, -0.016874736174941063, 0.014421935193240643, -0.04554436728358269, 0.010226706974208355, -0.01783977448940277, -0.011453107930719852, -0.002231647027656436, 0.020238962024450302, 0.0013905909145250916, -0.018442921340465546, -0.008108988404273987, 0.004379523452371359, -0.006698292214423418, -0.022115422412753105, -0.03455366939306259, -0.04634856432676315, -0.002839821157976985, 0.04994064196944237, -0.02069467306137085, -0.023938268423080444, 0.036054838448762894, 0.004433136899024248, -0.017933595925569534, 0.05192432925105095, -0.003327365731820464, -0.010983992367982864, 0.08545935153961182, 0.013570827431976795, 0.006202370394021273, -0.004104756284505129, -0.0249435156583786, -0.03013058751821518, -0.06138705089688301, -0.010032359510660172, -0.004580573178827763, -0.048814766108989716, 0.021056562662124634, -0.010662313550710678, 0.008812660351395607, 0.031551335006952286, -0.019407957792282104, 0.015199325978755951, 0.004456592723727226, 0.0067619578912854195, 0.03407115116715431, -0.0025667292065918446, -0.008484279736876488, -0.024729061871767044, -0.05339869111776352, 0.04565159231424332, -0.024889901280403137, -0.00042094694799743593, 0.0022634798660874367, -0.011345881968736649, 0.007974955253303051, 0.01568184420466423, 0.016499444842338562, 0.001271636807359755, -0.03726113587617874, -0.026980815455317497, 0.058491941541433334, -0.06085091829299927, 0.049056027084589005, -0.06197679415345192, -0.026954008266329765, -0.027583962306380272, 0.014314709231257439, -0.044632941484451294, 0.010595297440886497, -0.012940872460603714, -0.01790679059922695, -0.008993605151772499, 0.016861334443092346, -0.030345039442181587, 0.021016351878643036, 0.04492781311273575, 0.024595029652118683, 0.01682112365961075, -0.038145750761032104, -0.06551526486873627, -0.03567954897880554, -0.0018295485060662031, 0.022115422412753105, 0.008557997643947601, -0.07425420731306076, 0.03222149983048439, 0.0012196990428492427, -0.00707023311406374, -0.024514609947800636, 0.026994217187166214, -0.03838701173663139, -0.01623137854039669, 0.04835905507206917, -0.00735170254483819, -0.014046643860638142, -0.023656800389289856, 0.0406387634575367, -0.042568836361169815, 0.041576992720365524, 0.021673113107681274, 0.004232087638229132, -0.011064412072300911, -0.014757017605006695, 0.01295427605509758, -0.04240799695253372, 0.004791674669831991, 0.006152108311653137, 0.04594646394252777, -0.014690001495182514, -0.013698157854378223, -0.02309386245906353, -0.007948148995637894, 0.027905641123652458, -0.014314709231257439, 0.023321717977523804, 0.02577451802790165, -0.03621567785739899, 0.028495386242866516, -0.03101520426571369, -0.014837437309324741, 0.009402405470609665, 0.02010492980480194, 0.005294297821819782, 0.035089801996946335, 0.006788764148950577, 0.00833684392273426, -0.00460737943649292, -0.0024796079378575087, 0.04181825369596481, 0.03530425578355789, -0.010012254118919373, -0.019381150603294373, -0.009750890545547009, -0.015467392280697823, -0.049082834273576736, -0.009891624562442303, -0.01867077685892582, 0.024152720347046852, 0.0018714338075369596, 0.0081827063113451, 0.0007154003833420575, 0.03283805027604103, 0.02806648053228855, 0.039861373603343964, 0.016284992918372154, -0.025211580097675323, -0.0032620246056467295, -0.03712710365653038, 0.016700495034456253, 0.0179469995200634, 0.011620649136602879, 0.058867231011390686, 0.0609581433236599, 0.05532876402139664, 0.03157814219594002, 0.0018261977238580585, 0.039995405822992325, -0.035947613418102264, 0.032409146428108215, 0.0038433922454714775, 0.001295930240303278, 0.008571401238441467, 0.04149657487869263, 0.0507984533905983, 0.014113659970462322, 0.011339180171489716, -0.07098380476236343, -0.036456938832998276, -0.04045111685991287, -0.01525293942540884, 0.020305978134274483, -0.04468655586242676, 0.020533833652734756, -0.03366905450820923, -0.009844713844358921, 0.018241873010993004, 0.050181902945041656, -0.03637651726603508, -0.02549304999411106, 0.0020691321697086096, 0.004604028537869453, 0.04189867153763771, -0.02501053176820278, -0.07446865737438202, 0.01020660251379013, 0.03232872486114502, -0.049538545310497284, 0.005971163976937532, -0.011332478374242783, 0.021364837884902954, -0.057151611894369125, -0.019273925572633743, 0.009690575301647186, -0.0336422473192215, 0.022423697635531425, 0.010749435052275658, 0.050530388951301575, -0.02111017517745495, -0.026538506150245667, -0.050664421170949936, 0.09017730504274368, -0.03173898160457611, 0.010427756235003471, -0.04093363508582115, -0.024581626057624817, -0.03578677400946617, -0.00902711320668459, -0.016244782134890556, -0.008953395299613476, 0.003421188797801733, 0.03500938415527344, 0.006929498631507158, 0.037421975284814835, 0.01310841366648674, 0.02817370742559433, -0.004878796171396971, -0.017652127891778946, -0.01556121464818716, -0.029808908700942993, 0.03798491135239601, 0.009616857394576073, -0.04101405665278435, 0.0008238832233473659, -0.02076168917119503, -0.013671351596713066, 0.019300730898976326, 0.03621567785739899, -0.003585378872230649, -0.02594876103103161, 0.051870714873075485, 0.005944357253611088, -0.005180370062589645, -0.009958641603589058, -0.020600849762558937, 0.00985141471028328, -0.017987210303544998, 0.019448168575763702, -0.015051890164613724, -0.027302494272589684, -0.024313559755682945, -0.021847356110811234, 0.0006973897106945515, 0.010079271160066128, 0.007365105673670769, 0.008571401238441467, 0.009482825174927711, -0.0003886953054461628, 0.046723853796720505, 0.015775667503476143, -0.0012171858688816428, 0.025988971814513206, 0.03720752149820328, -0.013490407727658749, 0.015467392280697823, -0.006989813409745693, 0.029942940920591354, -0.026055987924337387, -0.013121817260980606, -0.027503542602062225, 0.014622985385358334, -0.041201699525117874, 0.002471230924129486, -0.01667368784546852, 4.253972656442784e-05, 0.03088117018342018, -0.04313177242875099, 0.004315858241170645, 0.001995414262637496, 0.028254127129912376, -0.022329874336719513, -0.025452839210629463, -0.10561789572238922, -0.03305250406265259, -0.018040822818875313, 0.015480794943869114, -0.004389576148241758, -0.01549419853836298, 0.029567649587988853, -0.03479493036866188, -0.0013084957608953118, -0.028495386242866516, -0.023831041529774666, -0.055918507277965546, -0.03894994780421257, 0.010065867565572262, 0.022450504824519157, 0.00851108692586422, 0.010769540444016457, -0.010508175939321518, 3.238254794268869e-05, 0.011747980490326881, -0.03525064140558243, -0.014247693121433258, 0.030291426926851273, 0.015266343019902706, -0.04498142749071121, 0.017343852669000626, -0.036430131644010544, -0.03487534821033478, -0.011231953278183937, 0.012404740788042545, 0.0014483926352113485, -0.018657373264431953, -0.020734883844852448, 0.0163654126226902, 0.011922222562134266, 0.0012448302004486322, -0.003950618673115969, -0.010407651774585247, 0.011587141081690788, -0.0041181594133377075, -0.014690001495182514, 0.017169609665870667, 0.0016008549137040973, -0.008363650180399418, -0.017987210303544998, 0.00902711320668459, -0.02727568708360195, -0.03640332445502281, -0.030827557668089867, -0.004945812281221151, 0.02337533049285412, 0.002762752352282405, 0.03232872486114502, -0.031551335006952286, -0.02234327793121338, -0.01647263765335083, -0.04184505715966225, -0.04224715754389763, 0.007130547892302275, -0.023562977090477943, -0.0006542478804476559, -0.04112128168344498, 0.0034513461869210005, 0.033266954123973846, -0.003789779031649232, -0.019743040204048157, 0.0031145885586738586, -0.051012907177209854, -0.005012828856706619, 0.014743614941835403, -0.010494773276150227, -0.02267836034297943, -0.016325201839208603, 0.018134646117687225, 0.01691494695842266, -0.009630260989069939, -0.0029872574377804995, 0.024715660139918327, 0.0029420212376862764, -0.06036840006709099, 0.02625703625380993, 0.04862711951136589, -0.004764867946505547, -0.016941754147410393, 0.021056562662124634, -0.005837130825966597, -0.027959253638982773, -0.04101405665278435, 0.018161453306674957, -0.038521043956279755, -0.017410868778824806, 0.047688890248537064, 0.00041864326340146363, 0.028468579053878784, -0.01952858828008175, 0.04924367368221283, 0.007251177914440632, 0.03482173755764961, -0.003481503576040268, -0.01777275651693344, -0.01531995553523302, 0.003541818354278803, -0.012907364405691624, -0.0452226884663105, -0.039754144847393036, 0.011821698397397995, 0.02368360571563244, 0.007110442966222763, 0.0013805384514853358, 0.006644678767770529, -0.010608701035380363, 0.024554820731282234, -0.015212729573249817, -0.013182131573557854, 0.01117163896560669, -0.003238569013774395, -0.030907977372407913, 0.019622409716248512, 4.651882773032412e-05, 0.007854325696825981, -0.001502843457274139, -0.008759046904742718, -0.01561482809484005, -0.0012858777772635221, -0.033749472349882126, 0.06406770646572113, 0.016378816217184067, 0.03854785114526749, -0.019059471786022186, 0.03978095203638077, 0.0012331022880971432, 0.039003562182188034, 0.007532646879553795, -0.032650403678417206, -0.01805422641336918, -0.031792595982551575, -0.02779841423034668, -0.007928043603897095, 0.012940872460603714, -0.0015983418561518192, 0.015735458582639694, -0.017048979178071022, -0.009898326359689236, -0.03728794306516647, 0.020614253357052803, -0.003585378872230649, -0.01401983667165041, -0.03782407194375992, -0.024152720347046852, -0.010514877736568451, -0.0175314974039793, -0.026270439848303795, 0.003431241260841489, -0.04535672068595886, 0.00985141471028328, -0.05318423733115196, -0.034580476582050323, 0.004724658094346523, 0.021954583004117012, 0.047688890248537064, -0.011546931229531765, 0.028629418462514877, -0.014475548639893532, -0.004664343316107988, -0.03868188336491585, 0.01922031119465828, -0.011989239603281021, 0.047099146991968155, -0.005783517844974995, 0.01383219100534916, 0.030907977372407913, -0.008142496459186077, -0.021284418180584908, -0.0030157393775880337, 0.03061310574412346, 0.004516907501965761, -0.013631141744554043, 0.012853750959038734, -0.04238118976354599, -0.01141289807856083, 0.034473251551389694, 0.02556006610393524, -0.02841496653854847, -0.00543838320299983, 0.009355493821203709, -0.0023237946443259716, 0.010608701035380363, -0.036671388894319534, 0.008759046904742718, -0.012190288864076138, -0.0199440885335207, -0.020265769213438034, -0.03160494938492775, -0.05117374658584595, 0.01976984739303589, -0.01574886031448841, -0.007995059713721275, 0.002498037414625287, -0.01599011942744255, -0.013570827431976795, 0.038145750761032104, -0.004181825090199709, 0.04618772491812706, 0.015266343019902706, 0.027195267379283905, 0.03353502228856087, -0.04302454739809036, -0.00876574870198965, 0.016083942726254463, -0.04155018553137779, -0.02529199980199337, -0.00640006922185421, -0.003143070498481393, 0.011908819898962975, -0.0382261723279953, 0.002156253671273589, 0.03760962188243866, 0.02876345068216324, 0.004004231654107571, 0.037556007504463196, 0.0013193859485909343, -0.003974074497818947, -0.018107838928699493, -0.03433921933174133, 0.012083061970770359, -0.013939416967332363, -0.03125646337866783, 0.013289357535541058, -0.001536351628601551, 0.014207483269274235, -0.00747233210131526, -0.021766936406493187, -0.0328112430870533, 0.010226706974208355, -0.0150116803124547, 0.00046031910460442305, 0.021217402070760727, 0.007525945082306862, -0.0058270785957574844, -0.02258453704416752, -0.020051315426826477, 0.029219163581728935, 0.03128327056765556, 0.005696396343410015, 0.009187952615320683, 0.025090951472520828, 0.04240799695253372, 0.013202236965298653, -0.024930112063884735, 0.02954084239900112, 0.016110749915242195, -0.009375598281621933, 0.017102593556046486, -0.027476735413074493, -0.012049553915858269, -0.008591506630182266, -0.012109869159758091, -0.008008463308215141, -0.0006630438147112727, -0.02632405422627926, 0.0046945009380578995, 0.011258760467171669, -0.03549190238118172, 0.0001405250804964453, -0.022356681525707245, 0.008155899122357368, -0.014797227457165718, 0.012029449455440044, 0.048680733889341354, 0.0028079883195459843, -0.09779037535190582, -0.008772450499236584, 0.024340366944670677, -0.0010630481410771608, -0.006731800269335508, -0.0009390677441842854, 0.01939455419778824, 0.028683030977845192, -0.01060199923813343, -0.007244476117193699, -0.03026461973786354, -0.009328686632215977, -0.014596178196370602, -0.025171371176838875, -0.0032117622904479504, -0.03602803125977516, -0.030586298555135727, -0.013751771301031113, 0.010407651774585247, 0.006061635911464691, -0.016016926616430283, 0.0002607358037494123, 0.015963314101099968, 0.012759928591549397, -0.011861908249557018, -0.01175468135625124, 0.01099739596247673, 0.007787309121340513, -0.010816452093422413, 0.058009423315525055, 0.010186497122049332, -0.007157354615628719, -0.01783977448940277, 0.00691609550267458, 0.009295178577303886, -0.011071113869547844, -0.013912610709667206, -0.017933595925569534, 0.021833952516317368, 0.020051315426826477, -0.0124717578291893, -0.05047677457332611, 0.020600849762558937, -0.017276834696531296, 0.014596178196370602, -0.009020411409437656, 0.002250076737254858, -0.012934170663356781, -0.006075039505958557, -0.025265194475650787, -0.02889748476445675, -0.025385823100805283, 0.000980952987447381, -0.007170757744461298, -0.013530617579817772, 0.003675851272419095, -0.04964577034115791, 0.010146287269890308, 0.010937081649899483, 0.027155056595802307, -0.01783977448940277, 0.026927201077342033, 0.012893960811197758, 0.008001761510968208, -0.005270841997116804, -0.02645808644592762, 0.0060482327826321125, 0.028683030977845192, -0.025921955704689026, -0.03921801596879959, 0.006155459210276604, -0.029835714027285576, -0.0031648508738726377, 0.03417837992310524, 0.008745644241571426, -0.0032335426658391953, 0.0004913142183795571, 0.02766438201069832, -0.04532991349697113, 0.02491670846939087, 0.03567954897880554, -0.03492896258831024, -0.017786160111427307, -0.010883468203246593, 0.0265653133392334, 0.02141845040023327, 0.04254202917218208, 0.0011970809428021312, -0.037448782473802567, 0.018134646117687225, 0.03171217441558838, -0.009978746064007282, 0.0014215860283002257, -0.0011258759768679738, -0.008263126015663147, -0.007103741634637117, 0.004851989448070526, 0.04532991349697113, 0.036698196083307266, -0.0012088088551536202, 0.03691264986991882, 0.030076973140239716, -0.02219584211707115, -0.04704553261399269, -0.009074024856090546, -0.026994217187166214, 0.008356948383152485, 0.0020037912763655186, 0.01561482809484005, -0.007921341806650162, 0.004583923611789942, -0.020091526210308075, -0.0273158960044384, 0.04884157329797745, 0.019635813310742378, 0.040129438042640686, 0.022155631333589554, 0.030211007222533226, 0.04339984059333801, -0.012398039922118187, -0.02014513872563839, 0.015293149277567863, -0.029058324173092842, -0.018965650349855423, -0.026123004034161568, -0.013255849480628967, 0.023241298273205757, 0.017585111781954765, 0.022450504824519157, -0.02755715511739254, -0.02364339679479599, 0.0061923181638121605, 0.029433615505695343, 0.007566154934465885, 0.001834574737586081, 0.017933595925569534, -0.020372994244098663, 0.042890515178442, -0.048680733889341354, 0.028334546834230423, 0.018349098041653633, 0.005709799937903881, 0.06063646450638771, 0.01897905208170414, 0.010213304311037064, 0.01525293942540884, -0.004758166614919901, 0.011319074779748917, -0.01347030233591795, 0.032167885452508926, -0.0035217134281992912, -0.003364224685356021, 0.0015330008463934064, 0.019327538087964058, 0.00806207675486803, 0.03023781254887581, -0.012458354234695435, -0.04862711951136589, 0.039620112627744675, 0.043158579617738724, 0.05082526057958603, 0.02450120635330677, 0.007224371191114187, 0.005491996183991432, 0.029674874618649483, -0.005659537389874458, -0.025131160393357277, -0.00584383262321353, -0.03956649824976921, -0.010474667884409428, -0.02782522141933441, -0.02096273936331272, 0.03149772062897682, 0.008745644241571426, 0.03291847184300423, 0.005063091404736042, 0.013483705930411816, 0.024863095954060555, 0.027717994526028633, -0.014153869822621346, -0.006379964295774698, 0.046241335570812225, -0.010508175939321518, 0.023629993200302124, -0.0010731006041169167, 0.004469995852559805, 0.00599797023460269, -0.0002274370053783059, -0.015172519721090794, 0.04240799695253372, 0.020922528579831123, 0.03964691981673241, -0.002546624280512333, 0.02938000299036503, 0.0023304964415729046, -0.014958066865801811, 0.019609007984399796, 0.04192547872662544, 0.009965343400835991, -0.005431681405752897, -0.030398651957511902, 0.04889518767595291, 0.011895416304469109, -0.015172519721090794, -0.012793436646461487, 0.009536437690258026, 0.023911461234092712, 0.0038567956071347, 0.006299544591456652, 0.027771608904004097, 0.0019267223542556167, -0.014046643860638142, -0.03720752149820328, 0.03417837992310524, 0.02003791183233261, -0.028709838166832924, 0.01623137854039669, 0.002250076737254858, -0.0008502709679305553, 0.0017541550332680345, -0.021766936406493187, -0.014529162086546421, -0.04029027745127678, 0.007197564467787743, -0.025211580097675323, 0.02511775866150856, 0.005726553965359926, 0.00032607681350782514, -0.03809214010834694, -0.006463734433054924, 0.0026840080972760916, 0.008980201557278633, -0.0016050435369834304, 0.013396584428846836, -0.007653276436030865, -0.008035269565880299, -0.007237774319946766, -0.006942902226001024, 0.005435032304376364, -0.004037739709019661, 0.01588289439678192, -0.005089897662401199, -0.044901009649038315, 0.001517084427177906, 0.0023891357704997063, -0.01477042119950056, 0.003327365731820464, 0.0468042753636837, -0.0017759354086592793, 0.002834795042872429, 0.013001187704503536, 0.027771608904004097, 0.04784972965717316, -0.011607245542109013, -0.006121950689703226, 0.004593976307660341, 0.039378855377435684, 0.037180714309215546, 0.03573315963149071, 0.025854937732219696, -0.0048251827247440815, 0.040236663073301315, -0.0034345919266343117, -0.027530349791049957, -0.018764600157737732, -0.036054838448762894, -0.037448782473802567, 0.01334967277944088, -0.009710680693387985, 0.006416823249310255, -0.0011669235536828637, 0.025680696591734886, -0.001041267765685916, 0.007686784490942955, 0.011741278693079948, -0.004386225249618292, -0.0015120581956580281, -0.019609007984399796, 0.011955730617046356, -0.002647148910909891, -0.02175353281199932, -0.021163787692785263, -0.037046682089567184, -0.026645733043551445, 0.004875445272773504, -0.026578715071082115, -0.021565886214375496, 0.0032620246056467295, 0.06111898273229599, -0.030318232253193855, 0.01377857755869627, 0.02659211866557598, 0.00023853660968597978, 0.015092100016772747, 0.0042622447945177555, -0.02285260334610939, 0.009067323058843613, -0.034580476582050323, 0.030050167813897133, -0.003940565977245569, 0.02766438201069832, 0.022973231971263885, 0.018885230645537376, -0.030693525448441505, 0.010816452093422413, 0.02216903492808342, -0.010112779214978218, -0.024822885170578957, -0.03163175657391548, -0.01867077685892582, -0.02436717413365841, 0.01708918996155262, 0.01123865507543087, 0.006681538186967373, 0.04535672068595886, -0.007586259860545397, -0.0031966837123036385, -0.024889901280403137, 0.031310077756643295, -0.03538467362523079, 0.017384061589837074, 0.003055949229747057, -0.0032787788659334183, 0.00814919825643301, 0.028495386242866516, -0.029004711657762527, 0.019072875380516052, -0.013858997263014317, -0.009308582171797752, 0.01262589544057846, 0.013577528297901154, 0.0015397025272250175, 0.014783824793994427, -0.00778060732409358, -0.008115689270198345, 0.0034144870005548, -0.006909393705427647, 0.015507602132856846, 0.010575192980468273, -0.008383755572140217, 0.025680696591734886, 0.015199325978755951, 0.020989546552300453, 0.02155248448252678, -0.006929498631507158, 0.02062765695154667, 0.006195669062435627, -0.02124420739710331, 0.009509631432592869, -0.009737486951053143, 0.06680198013782501, -0.02399188093841076, -0.023804236203432083, 0.005381419323384762, -0.004939110949635506, -0.006028127856552601, -0.008899781852960587, -0.02498372457921505, -0.02058744803071022, -0.015708651393651962, 0.009355493821203709, 0.01829548552632332, 0.0028314441442489624, -0.0037998314946889877, 0.004942461848258972, -0.035947613418102264, -0.0028934343717992306, 0.03168536722660065, 0.0044901007786393166, 0.02876345068216324, 0.02377742901444435, 0.030076973140239716, -0.014073450118303299, -0.015092100016772747, -0.01712939888238907, 0.0064201741479337215, 0.00039476866368204355, 0.010937081649899483, 0.014877647161483765, 0.004875445272773504, 0.008651820942759514, -0.019997702911496162, -0.04163060709834099, 0.011982537806034088, 0.0030626507941633463, 0.019501781091094017, -0.00472800899296999, 0.029353195801377296, -0.04291732236742973, -0.016204573214054108, 0.027088040485978127, 0.0077135912142694, -0.008403860032558441, -0.0018479780992493033, -0.024273350834846497, 0.014341515488922596, -0.0048251827247440815, -0.013678053393959999, -0.002072483068332076, 0.00809558480978012, 0.010126182809472084, 0.006326350849121809, 0.04334622621536255, -0.006758606992661953, -0.011305672116577625, -0.03101520426571369, -0.007425420451909304, 0.029326390475034714, 0.017799563705921173, 0.005565714556723833, -0.0476352795958519, 0.02632405422627926, -0.05291617289185524, -0.02278558537364006, -0.017062382772564888, -0.039620112627744675, -0.0005486970185302198, 0.025519857183098793, -0.0035284149926155806, 0.042944129556417465, -0.017451077699661255, -0.002724217949435115, -0.011714471504092216, -0.0013369778171181679, -0.010856661945581436, 0.016794316470623016, -0.016204573214054108, 0.016660284250974655, 0.024380577728152275, 0.03736836090683937, -0.006627924740314484, -0.0033189887180924416, -0.009134339168667793, 0.0006973897106945515, -0.012759928591549397, -0.012357830069959164, 0.03696626424789429, -0.009355493821203709, 0.013403286226093769, 0.020533833652734756, -0.0343124121427536, 0.02124420739710331, 0.0336422473192215, -0.0003905801277142018, 0.01939455419778824, -0.016325201839208603, -0.012786734849214554, -0.024407383054494858, 0.04361429065465927, -0.011855206452310085, -0.008919887244701385, -0.019823459908366203, -0.02151227369904518, 0.0017725845100358129, -0.011788190342485905, 0.011654157191514969, -0.07205606251955032, 0.011794891208410263, 0.01581587828695774, -0.033132921904325485, 0.01401983667165041, -0.028817065060138702, 0.021083367988467216, -0.010923678055405617, 0.008866273798048496, 0.0167809147387743, 0.012692911550402641, 0.007277984172105789, 0.00152964994776994, -0.055918507277965546, 0.04074598848819733, -0.005746658891439438, 0.02491670846939087, 0.015802474692463875, -0.012210393324494362, -0.02021215483546257, -0.012451652437448502, 0.0253590177744627, 0.008041971363127232, -0.018778003752231598, -0.029353195801377296, -0.0019317485857754946, -0.011131429113447666, -0.014622985385358334, -0.016834527254104614, 0.035223834216594696, 0.00778060732409358, -0.01664688065648079, -0.015400375239551067, -0.008933289907872677, 0.03254317864775658, 0.014488952234387398, -0.003310611704364419, 0.0061320033855736256, 0.014060046523809433, 0.021445257589221, 0.023589782416820526, 0.006875885650515556, 0.02766438201069832, -5.7906385336536914e-05, -0.009831310249865055, 0.004121510311961174, -0.024139318615198135, -0.013409988023340702, 0.01414046622812748, 0.0007371807005256414, -0.009275074116885662, -0.016083942726254463, 0.030291426926851273, 0.00930188037455082, 0.01029372401535511, -0.027905641123652458, -0.032033853232860565, 0.018764600157737732, 0.0468042753636837, 0.011419599875807762, -0.022048404440283775, 0.0016368762589991093, 0.018040822818875313, -0.005498697981238365, -0.007458928506821394, -0.010595297440886497, 0.005776816047728062, -0.02017194591462612, -0.013048098422586918, -0.04827863723039627, -0.03468770533800125, -0.0003641924122348428, 0.009616857394576073, 0.02577451802790165, -0.02271856926381588, -0.00839045736938715, 0.03728794306516647, -0.007425420451909304, 0.008591506630182266, -0.008745644241571426, -0.009355493821203709, 0.0015011680079624057, -0.00560257351025939, 0.005830429494380951, 0.02938000299036503, 0.0163654126226902, -0.00548194395378232, 0.0015262991655617952, 0.004325910471379757, 0.0269406046718359, 0.004798376467078924, 0.006855780724436045, 0.031899821013212204, 0.04189867153763771, 0.021539080888032913, -0.008678627200424671, -0.00961015559732914, -0.0075460500083863735, 0.021847356110811234, 0.022879408672451973, -0.011734576895833015, 0.007003217004239559, 0.014247693121433258, 0.010005553252995014, -0.0001591640175320208, -0.029433615505695343, 0.0179469995200634, 0.02865622565150261, 0.027771608904004097, 0.01845632493495941, 0.015936506912112236, 0.014837437309324741, -0.02247731015086174, -0.04259564355015755, 0.010039061307907104, 0.017544900998473167, -0.0023020142689347267, 0.006634626537561417, -0.0343928299844265, 0.023495960980653763, -0.03994179144501686, -0.0025550012942403555, -0.0150116803124547, 0.013885804452002048, -0.0007979143410921097, -0.02161950059235096, 0.013952820561826229, 0.009905028156936169, 0.01860376074910164, 0.0024008636828511953, 0.0032620246056467295, -0.02673955447971821, 0.005381419323384762, 0.007083636708557606, -0.006524049211293459, 0.01887182705104351, 0.026310650631785393, 0.005384770222008228, 0.0085781030356884, 0.036698196083307266, 0.012451652437448502, 0.018550148233771324, -0.025814728811383247, -0.005512101110070944, -0.012136675417423248, 0.029701681807637215, 0.015668440610170364, -0.03959330543875694, 0.028602611273527145, -0.012156779877841473, 0.011044307611882687, 0.007680082693696022, 0.003481503576040268, 0.029674874618649483, 0.003927162848412991, 0.006540803704410791, 0.023053651675581932, 0.020614253357052803, -0.03047907166182995, 0.024380577728152275, -0.014274499379098415, 0.006644678767770529, -0.042810093611478806, 0.00014408532297238708, -0.007150652818381786, 0.005924252327531576, -0.011882012709975243, 0.0038065332919359207, 0.028441771864891052, 0.01080975029617548, -0.017585111781954765, -0.024769272655248642, -0.0031648508738726377, -0.018000613898038864, 0.02401868812739849, 0.017276834696531296, -0.017799563705921173, -0.01955539360642433, 0.010863362811505795, -0.017451077699661255, -0.009724084287881851, 0.003176578786224127, 0.0027761554811149836, 0.003789779031649232, 0.016003523021936417, 0.02518477477133274, -0.0010236760135740042, -0.01948837749660015, -0.00837035197764635, -0.003525064093992114, -0.03074713796377182, -0.010903572663664818, 0.006698292214423418, 0.032998889684677124, -0.003592080669477582, 0.016325201839208603, 0.012250603176653385, 0.032409146428108215, 0.014462145045399666, 0.026310650631785393, -0.017048979178071022, 0.05160265043377876, 0.0034128117840737104, -0.004101405385881662, -0.0005507912719622254, -0.001774259959347546, 0.007130547892302275, -0.008256424218416214, 0.027959253638982773, 0.01123865507543087, 0.007365105673670769, -0.01020660251379013, -0.020547237247228622, 0.05570405721664429, -0.009978746064007282, 0.024179527536034584, -0.02436717413365841, -0.006111898459494114, 0.03940565884113312, -0.04468655586242676, 0.00012596994929481298, 0.025372419506311417, 0.042434804141521454, -0.013396584428846836, 0.04474017024040222, -0.008980201557278633, 0.030907977372407913, 0.006379964295774698, -0.02769118919968605, 0.04291732236742973, 0.014984874054789543, -0.0011317399330437183, 0.04449890926480293, -0.030532686039805412, -0.029728488996624947, 0.0036892544012516737, -0.04348025843501091, -0.02027917094528675, 0.0034278903622180223, 0.005763412918895483, -0.03578677400946617, -0.003079405054450035, -0.02738291397690773, 0.00833684392273426, 0.025881744921207428, 0.02669934555888176, -0.011580439284443855, 0.008243020623922348, -0.004520258400589228, 0.019059471786022186, 0.0014869270380586386, 0.005435032304376364, -0.04230077192187309, -0.018898632377386093, -0.03396392613649368, -0.016807720065116882, 0.02672615274786949, 0.0010814776178449392, 0.016512848436832428, -0.022839199751615524, -0.02089572325348854, -0.03026461973786354, -0.01592310331761837, 0.019273925572633743, -0.007405315525829792, 0.028441771864891052, 0.03230191767215729, -0.0031464213971048594, 0.0025013883132487535, -0.0064804889261722565, -0.01087676640599966, -0.002094263443723321, 0.013738367706537247, -0.011774786747992039, -0.021043159067630768, -0.03626929223537445, 0.013155325315892696, -0.002846522955223918, 0.02161950059235096, 0.007666679564863443, 0.0009114234708249569, 0.016217976808547974, 0.019756443798542023]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"(e.g., greedy, top-K, and top-P (Kool et al., 2020; Holtzman
et al., 2020)). When using greedy sampling, the next token
is selected by applying an argmax function on PM.
We define x0as the prompt tokens given by the user. The
LLM needs to generate an output sequence (of length m)
fromx0. Denote yias the token generated at step i. The
autoregressive decoding process of mtokens can be seen
as solving the following mproblems one by one (assume
greedy sampling):


y1= argmax PM(y1|x0)
y2= argmax PM(y2|y1,x0)
...
ym= argmax PM(ym|y1:m−1,x0)(1)
Guess-And-Verify Paradigm. TheGuess-And-Verify de-
coding paradigm speculates multiple potential future tokens
and subsequently confirms the correctness of these spec-
ulations within a single decoding step. Take speculative
decoding with greedy sampling as an example: at step t,
with the prompt x0and tokens y1:t−1generated so far, we
can use a draft model to autoregressively generate a draft
sequence yt:t+n−1of length n. Because yt:t+n−1is known
a priori, we then use the LLM to solve Eqs 2 in parallel ,
obtaining y′
t:t+n. Then, we verify if yt+iis equal to y′
t+i
for each ifrom i= 0toi=n−1. If there is a match, we
accept this token and proceed; otherwise, we stop checking
and drop subsequent tokens. Finally, we update ywith all
accepted tokens.


y′
t= argmax PM(yt|y1:t−1,x0)
y′
t+1= argmax PM(yt+1|y1:t,x0)
...
y′
t+n= argmax PM(yt+n|y1:t+n−1,x0)(2)
2
Lookahead decoding
Figure 1: Workflow of LOOKAHEAD DECODING with
W= 5,N= 3, andG= 2. For each decoding step, we do
the following. (1) Generate one token at each position in the
lookahead branch; (2) Verify and accept 3-grams (searched
from the 3-gram pool) with the verification branch; (3) Col-
lect and cache newly generated 3-grams in the pool from
lookahead branch trajectories. (4) Update the lookahead
branch to maintain a fixed window size.
3-grams   and
are searched from LLM1: lookahead 
     branch2: verification
     branch3: collect 
n-grams4: update lookahead                      
  branch
1234 0
1234501212
0
1
2
1
2
 234562345
234561234
12345N-gram pool
1
2
32
3
43
4
54
5
6
n-gram pool
012012Input token  (step t)
Tokens from t-1 steps 
Tokens from t-2 steps Generated tokens
3-grams from poolUnwanted compute
Wanted compute
As stated in §1, these approaches depend on a good draft
model, which is hard to obtain and cannot generalize.
Jacobi Decoding. By notating f(yi,y1:i−1,x0) =yi−
argmax PM(yi|y1:i−1,x0), we can transform Eqs 1 into
the following non-linear system of equations (Song et al.,
2021; Santilli et al., 2023):


f(y1,x0) = 0
f(y2, y1,x0) = 0
...
f(ym,y1:m−1,x0) = 0(3)
We can solve this non-linear system using Jacobi iteration
by iteratively updating all yifrom a random initial guess y0,
along the trajectory y1, ...,yt, ..., until converging to the
fixed point solution ym. We detail this algorithm, termed
asJacobi decoding , in Appendix Algorithm 1. This process
guarantees to return the solution of all mvariables yiin
at most miterations, as the very first token of each","[0.01830584742128849, 0.009284810163080692, 0.009700252674520016, -0.009047415107488632, -0.041834402829408646, -0.005024875979870558, 0.02698398008942604, 0.030465783551335335, -0.025295833125710487, 0.03244408220052719, 0.05090819299221039, -0.02569149248301983, -0.06362204998731613, 0.008651754818856716, -0.04025176167488098, -0.05254358425736427, -0.011144409887492657, -0.03299800679087639, 0.005582096520811319, 0.03510819002985954, 0.005885435733944178, -0.005783223547041416, -0.006429467350244522, 0.06145911291241646, 0.022855931892991066, -0.005816195160150528, -0.012905094772577286, 0.047426387667655945, 0.015945078805088997, -0.03676996007561684, -0.016393493860960007, -0.03856361657381058, -0.007781303953379393, -0.04246745631098747, 0.010432222858071327, 0.04196628928184509, 0.014322875067591667, -0.012601756490767002, -0.046529561281204224, -0.02112821862101555, 0.004863315261900425, -0.04956294968724251, -0.07849884778261185, -0.0027795082423835993, 0.015826381742954254, 0.00720100337639451, -0.004978715907782316, -0.007926379330456257, 0.013182057067751884, 0.06900302320718765, -0.039143916219472885, 0.03107246197760105, -0.03922304883599281, 0.03157363086938858, -0.033156268298625946, -0.012799586169421673, -0.021365614607930183, -0.006683349143713713, 0.022262442857027054, 0.02062704972922802, 0.01810801774263382, -0.031336236745119095, 0.011955511756241322, 0.016947416588664055, 0.0008556137327104807, 0.005971161648631096, -0.02474190853536129, 0.009001254104077816, -0.014006347395479679, 0.0433906614780426, -0.01885977014899254, 0.017501339316368103, 0.016419870778918266, -0.04816495254635811, -0.04584375023841858, 0.01732988841831684, 0.029146919026970863, 0.039196670055389404, 0.03355192765593529, -0.017316699028015137, 0.05357230082154274, -0.020033560693264008, 0.029015032574534416, -0.07343441247940063, -0.015048250555992126, -0.04386545345187187, 0.0052325972355902195, -0.0018612483981996775, -0.021286481991410255, -0.04431386664509773, -0.04911453649401665, 0.02149750106036663, -0.04360168054699898, 0.006264609284698963, 0.012179719284176826, 0.004335768986493349, 0.004197288304567337, -0.0270103570073843, 0.028698503971099854, 0.01295784953981638, 0.002392091555520892, -0.024557268247008324, 0.03283974155783653, -0.03990885987877846, 0.05581437051296234, -0.030993329361081123, -0.03885376453399658, 0.05908515676856041, -0.034607019275426865, -0.03584675490856171, -0.052886489778757095, -0.006811938248574734, -0.021840406581759453, 0.031019708141684532, 0.013597499579191208, -0.0031323046423494816, -0.04476228356361389, 0.023383477702736855, 0.008968282490968704, -0.018846582621335983, -0.04014625400304794, 0.0010245933663100004, 0.005186437163501978, -0.014125045388936996, -0.016353927552700043, 0.0042599341832101345, 0.03334090858697891, -0.06378031522035599, 7.604081474710256e-05, 0.011052089743316174, 0.0023244996555149555, 0.016644077375531197, 0.012061021290719509, -0.010412439703941345, -0.02927880547940731, -0.007102088537067175, 0.022789988666772842, 0.017171623185276985, 0.003091090125963092, 0.03297162801027298, 0.02166895382106304, -0.03194291144609451, -0.032655101269483566, -0.0184773001819849, -0.03342004120349884, 0.009205678477883339, -0.02244708500802517, 0.051567625254392624, -0.06172288581728935, -0.039143916219472885, -0.013346915133297443, -0.04803306609392166, -0.015166948549449444, 0.02032371051609516, -0.02706311270594597, -0.032760608941316605, -0.04906178265810013, 0.02042922005057335, 0.025572793558239937, 0.014441573061048985, -0.060615040361881256, 0.02693122625350952, 0.031046085059642792, -0.0002305953239556402, -0.02563873678445816, 0.0383525975048542, -0.04908815771341324, 0.02703673392534256, -0.04771653935313225, -0.010801505297422409, -0.024135231971740723, -0.03608414903283119, -0.035451095551252365, -0.011718116700649261, 0.009746412746608257, -0.011592824012041092, -0.037825051695108414, -0.06145911291241646, -0.024675965309143066, -0.05998198688030243, -0.030755935236811638, 0.013083142228424549, 0.03706010803580284, 0.0023789028637111187, -0.03848448395729065, -0.01953239180147648, 0.014098668470978737, -0.027801675722002983, -0.0019502717768773437, 0.027669789269566536, 0.02376594953238964, 0.03444875776767731, 0.0657849907875061, -0.00028170133009552956, 0.018793826922774315, -0.03484441712498665, 0.09100168943405151, 0.009126546792685986, 0.04568548873066902, -0.00099904031958431, -0.007853841409087181, -0.019387317821383476, -0.023752760142087936, -0.041465118527412415, 0.01634073816239834, 0.0066866460256278515, 0.007392238825559616, -0.010043158195912838, -0.0014045913703739643, -0.014560271054506302, 0.011902757920324802, -0.028197336941957474, 0.019941240549087524, -0.002548706717789173, -0.0596127025783062, 0.04386545345187187, -0.022209689021110535, 0.022407518699765205, 0.00834182184189558, 0.04576461762189865, -0.018200337886810303, 0.03856361657381058, 0.022605348378419876, 0.03972421586513519, -0.0265883207321167, 0.037350259721279144, 0.025098003447055817, -0.003917029593139887, 0.015338401310145855, -0.0017474963096901774, 0.037350259721279144, -0.0242143627256155, 0.001524937804788351, -0.028645750135183334, 0.015628552064299583, 0.031784649938344955, -0.0013979970244690776, -0.02661469765007496, 0.0027003763243556023, -0.011592824012041092, -0.02927880547940731, 0.009489234536886215, 0.011065278202295303, -0.021180974319577217, -0.050565287470817566, 0.025876132771372795, -0.031388990581035614, -0.03384207934141159, 0.00745818205177784, 0.02972721867263317, -0.028672127053141594, -0.04995860904455185, -0.017039736732840538, 0.03764041140675545, -0.04046278074383736, 0.029410691931843758, -0.01928180828690529, 0.054337240755558014, -0.05797731131315231, 0.005193031392991543, -0.0006260487716645002, 0.00884299073368311, -0.025256266817450523, 0.05365143343806267, -0.02289549820125103, 0.006996579468250275, -0.0013798626605421305, 0.0027218079194426537, 0.01673639751970768, -0.010597080923616886, -0.05998198688030243, -0.041148591786623, -0.01583956927061081, 0.03128347918391228, -0.008599000051617622, -0.04133323207497597, 0.03529283031821251, 0.001244678976945579, -0.03661169484257698, 0.03539833799004555, -0.030993329361081123, -0.023502176627516747, 0.0722210556268692, 0.035055436193943024, 0.023014195263385773, -0.00188432855065912, 0.012061021290719509, -0.0027926969341933727, -0.036374300718307495, -0.004823748953640461, -0.0242143627256155, -0.028962276875972748, 0.006096453871577978, -0.027828054502606392, 0.01858280971646309, 0.0068449098616838455, -0.01721118949353695, 0.023053761571645737, -0.004411603789776564, -0.006462438963353634, 0.050169628113508224, -0.00011921304394491017, -0.002644324442371726, -0.015351589769124985, -0.04840235039591789, 0.0369546003639698, -0.0039565954357385635, 0.02373957261443138, 0.03107246197760105, -0.0058722468093037605, 0.013452423736453056, 0.008203340694308281, -0.008882556110620499, 0.003923623822629452, -0.021734897047281265, -0.034079473465681076, 0.08519868552684784, -0.05729150027036667, 0.03748214617371559, -0.07216829806566238, -0.0194532610476017, -0.014072290621697903, 0.007708766497671604, -0.021312860772013664, -0.021062275394797325, -0.02586294524371624, -0.003808222943916917, -0.020587483420968056, 0.022776801139116287, -0.002197558991611004, 0.008823207579553127, 0.04663506895303726, 0.02219649963080883, 0.022381141781806946, -0.01693422719836235, -0.03378932550549507, -0.021879972890019417, 0.008190152235329151, 0.040067121386528015, 0.029542578384280205, -0.09110720455646515, -0.004840234760195017, 0.03423773869872093, -0.028144581243395805, -0.03481803834438324, 0.013663442805409431, -0.010109101422131062, 0.02115459553897381, 0.04080568626523018, 0.005061144940555096, -0.004012647084891796, -0.040990326553583145, 0.02785443142056465, -0.025282643735408783, 0.03154725208878517, -0.01671002060174942, -0.001082293689250946, -0.010742156766355038, -0.031362611800432205, 0.0060502937994897366, -0.04397096112370491, 0.026575131341814995, 0.001960163237527013, 0.007774709723889828, -0.01900484599173069, 0.006726211868226528, -0.024728721007704735, -0.033235400915145874, -0.010913608595728874, -0.00399616127833724, -0.0027102679014205933, 0.03336728736758232, 0.0005044658901169896, 0.01922905258834362, -0.037297505885362625, -0.010979551821947098, -0.0013518367195501924, 0.01696060597896576, 0.031309857964515686, 0.06995260715484619, 0.0031718704849481583, -0.02740601636469364, 0.0008786938851699233, -0.019888486713171005, 0.010867448523640633, 0.027696168050169945, -0.019294995814561844, -0.049140915274620056, -0.020692992955446243, -0.031811024993658066, -0.04386545345187187, -0.02244708500802517, 0.011151004582643509, -0.0016353927785530686, -0.021405180916190147, 0.0046127308160066605, -0.04357530176639557, 0.0383525975048542, 0.024952927604317665, 0.05304475501179695, 0.006884475704282522, -0.025071626529097557, -0.0344223789870739, -0.021405180916190147, -0.01030033640563488, 0.028592996299266815, 0.017395831644535065, 0.05344041436910629, 0.050222381949424744, 0.008513274602591991, 0.03397396579384804, 0.0159582681953907, 0.041148591786623, -0.02877763658761978, 0.030966952443122864, 0.016156097874045372, 0.032285816967487335, 0.026179471984505653, 0.05267547070980072, 0.04945744201540947, 0.011276296339929104, -0.000919908401556313, -0.0596127025783062, -0.024926550686359406, -0.030017370358109474, -0.016894662752747536, 0.014705345965921879, -0.02079850248992443, 0.04220368340611458, -0.027194999158382416, -0.017290322110056877, 0.026166284456849098, 0.023502176627516747, -0.04998498782515526, -0.021853594109416008, 0.025493662804365158, 0.032233063131570816, 0.01397997047752142, -0.013821706175804138, -0.08234993368387222, -0.005938190035521984, 0.01808164082467556, -0.029911860823631287, 0.033182647079229355, 0.01783105544745922, 0.019664278253912926, -0.06293624639511108, -0.04679333418607712, 0.02144474722445011, 0.008625377900898457, 0.022631725296378136, -0.047452766448259354, 0.06399133801460266, 0.010240987874567509, 0.00470834830775857, -0.05628916248679161, 0.10920202732086182, -0.01973022148013115, 0.00733948452398181, -0.03795693814754486, -0.020943578332662582, -0.030966952443122864, 0.008091237396001816, -0.009086980484426022, 0.004925961140543222, 0.013313943520188332, -0.013406263664364815, 0.00815718062222004, 0.03700735419988632, 0.020244579762220383, 0.012832557782530785, -0.02970084175467491, -0.033657439053058624, 0.007754927035421133, -0.027274129912257195, 0.03360468149185181, 0.03199566900730133, -0.03297162801027298, 0.007431804668158293, 0.00031487905653193593, -0.010517949238419533, 0.007616445887833834, 0.007233974989503622, 0.00801869947463274, -0.01626160740852356, 0.06504642963409424, 0.00888915080577135, 0.00856602843850851, -0.008645161055028439, -0.03326177969574928, 0.011513692326843739, -0.02062704972922802, -0.020416032522916794, -0.014955930411815643, -0.024860607460141182, -0.029410691931843758, 0.012634728103876114, 0.02090401202440262, -0.0070229568518698215, 0.008335227146744728, 0.009185895323753357, 0.024834230542182922, -0.027115866541862488, 0.07654692977666855, 0.03326177969574928, -0.010597080923616886, 0.016222041100263596, 0.019413694739341736, 0.011223542504012585, 0.04336428642272949, -0.04457763954997063, 0.0029971208423376083, -0.045052431523799896, -0.006004133261740208, -0.02675977349281311, 0.000564639107324183, -0.045078810304403305, -0.0066767544485628605, -0.015404344536364079, 0.024728721007704735, -0.0013205136638134718, -0.031811024993658066, -0.02035008929669857, 0.0006066779606044292, 0.02429349534213543, -0.032707855105400085, -0.02157663367688656, -0.07649417966604233, -0.026746584102511406, 0.009818950667977333, 0.0233702901750803, -0.005011687520891428, -0.005489775910973549, 0.008025294169783592, -0.03062404692173004, -0.03062404692173004, -0.035029057413339615, -0.008486896753311157, -0.03326177969574928, -0.03152087703347206, -0.008823207579553127, -0.012225879356265068, -0.03149449825286865, 0.0011597770499065518, -0.013557933270931244, -0.023700006306171417, 0.018648752942681313, -0.001492790412157774, -0.02102270908653736, 0.021220538765192032, 0.02381870336830616, -0.019044412299990654, 0.004213774111121893, -0.00976619590073824, -0.03753490000963211, -0.007365861441940069, 0.003828005865216255, 0.0201522596180439, 0.011507097631692886, -0.02471553161740303, 0.012436898425221443, 0.012041238136589527, 0.013637064956128597, 0.00020792732539121062, -0.010768533684313297, 0.018793826922774315, -0.00122077448759228, -0.0013732683146372437, 0.02843473106622696, 0.010221204720437527, 0.01244349218904972, -0.012001672759652138, 0.025625549256801605, -0.012331388890743256, -0.021194161847233772, -0.02751152589917183, 0.016327550634741783, 0.005473290104418993, 0.006709726061671972, -0.004991904366761446, -0.03349917382001877, -0.021220538765192032, 0.0026822418440133333, -0.03112521581351757, -0.022156933322548866, 0.010069535113871098, -0.02129967138171196, 0.02970084175467491, -0.01835860311985016, -0.0007826639921404421, 0.03676996007561684, -0.0032196794636547565, -0.024333061650395393, 0.03146812319755554, -0.038220711052417755, 0.019796164706349373, 0.0013106222031638026, 0.015298835001885891, -0.012344577349722385, -0.005634851288050413, 0.054178979247808456, 0.02205142378807068, -0.007768115494400263, 0.011612607166171074, 0.0012669347925111651, 0.008440736681222916, -0.031811024993658066, 0.023383477702736855, 0.016301171854138374, -0.017303509637713432, 0.002148101571947336, 0.02795994095504284, -0.010142073035240173, -0.018741073086857796, -0.028619373217225075, 0.011731305159628391, -0.03207479789853096, -0.02745877206325531, 0.05739700794219971, 0.012786396779119968, 0.04800669103860855, -0.011962106451392174, 0.05111921206116676, -0.014138233847916126, 0.01099933497607708, 0.004210476763546467, 0.005690902937203646, -0.006624000146985054, -0.008209935389459133, -0.013742574490606785, -0.026746584102511406, -0.024280305951833725, 0.014586647972464561, 0.011164193041622639, 0.006574542727321386, -0.022974630817770958, 0.025981642305850983, -0.008955094031989574, -0.007576880045235157, -0.003669742261990905, -0.010016780346632004, -0.011269702576100826, -0.017527718096971512, -0.017620038241147995, 0.008295661769807339, 0.001999729312956333, 0.01210718136280775, 0.014639402739703655, -0.012905094772577286, -0.03748214617371559, -0.013439235277473927, -0.019519204273819923, 0.05618365481495857, -0.0263113584369421, 0.025348586961627007, -0.03175827115774155, 0.016050588339567184, -0.01490317564457655, 0.02272404544055462, -0.008816612884402275, -0.03207479789853096, -0.028513863682746887, -0.03062404692173004, -0.02675977349281311, 0.0001528028806205839, 0.04853423684835434, 0.020046750083565712, 0.03524007648229599, -0.00779449287801981, 0.006178882904350758, -0.02275042235851288, 0.026153095066547394, -0.0053908610716462135, -0.029173295944929123, -0.005351295229047537, -0.03771954029798508, -0.012845746241509914, -0.043311528861522675, -0.010537732392549515, -0.00488309795036912, -0.022908687591552734, -0.014520704746246338, -0.05135660618543625, -0.027617035433650017, -0.0001457964099245146, -0.011625795625150204, 0.04616027697920799, -0.0576607808470726, 0.0021596415899693966, -0.017316699028015137, -0.008935310877859592, -0.026021208614110947, 0.020059937611222267, -0.019914863631129265, 0.034158606082201004, -0.009805762208998203, -0.026680640876293182, 0.02077212557196617, -0.023264780640602112, -0.026430057361721992, -0.028144581243395805, 0.0347125306725502, 0.0012273688334971666, -0.02107546478509903, -0.00993764866143465, -0.017145246267318726, -0.015694495290517807, 0.04315326735377312, 0.03328815475106239, -0.008104425854980946, -0.005189734045416117, -0.02040284313261509, 0.018292659893631935, 0.018319036811590195, -0.043258775025606155, -0.005641445517539978, -0.009832139126956463, -0.02396377921104431, -0.010550920851528645, -0.0023904431145638227, -0.019123544916510582, 0.024702344089746475, -0.025256266817450523, 0.004151127766817808, -0.014942741952836514, -0.04769016057252884, 0.0010006888769567013, 0.011981889605522156, -0.01099933497607708, 0.021141408011317253, -0.0057436577044427395, 0.008875962346792221, -0.0027003763243556023, -0.040093500167131424, -0.015879135578870773, 0.026232227683067322, -0.024425381794571877, -0.01905760169029236, -0.012305011041462421, -0.0031224130652844906, 0.019374128431081772, -0.015628552064299583, -0.026496000587940216, 0.009654092602431774, 0.021339237689971924, 0.00188432855065912, 0.020732559263706207, 0.009634309448301792, -0.02331753447651863, -0.009865110740065575, -0.050064120441675186, 0.011058683507144451, -0.023884646594524384, -0.04038364812731743, 0.005265568848699331, 0.004935852717608213, 0.01760684885084629, -0.026271792128682137, -0.020864445716142654, -0.01347880158573389, 0.016499003395438194, 0.00815718062222004, -0.017699168995022774, -0.007517531048506498, -0.003224625252187252, -0.025111190974712372, -0.010794910602271557, -0.008058265782892704, 0.06509917974472046, 0.014758100733160973, -0.001943677430972457, -0.015061439946293831, 0.038167957216501236, 0.011098249815404415, 0.04223006218671799, -0.020416032522916794, 0.02284274436533451, -0.0046127308160066605, -0.03115159459412098, 0.027194999158382416, -0.043786320835351944, 0.0017903593834489584, -0.019189488142728806, -0.0029740408062934875, -0.029911860823631287, -0.004543490242213011, -0.028672127053141594, 0.018675129860639572, -0.0002514086663722992, -0.022038236260414124, 0.013966781087219715, -0.0071878149174153805, 0.0023508770391345024, 0.010029968805611134, -0.004151127766817808, 0.03204842284321785, -0.005483181681483984, -0.1290377676486969, -0.00941669661551714, 0.019782977178692818, 0.019519204273819923, 0.005433724261820316, 0.0019733519293367863, 0.027247752994298935, -0.0011762628564611077, -0.023937402293086052, 0.009957431815564632, -0.03028114326298237, 0.0003490871167741716, -9.484494512435049e-05, -0.020481975749135017, -0.005334809422492981, -0.042836736887693405, -0.010531137697398663, -0.024478135630488396, 0.01210718136280775, -0.0074647762812674046, -0.02925242856144905, -0.021339237689971924, -0.011573041789233685, 0.00280258827842772, -0.0321803092956543, -0.026232227683067322, -0.00016805226914584637, 0.006554759573191404, 0.008414359763264656, 0.02877763658761978, -0.008823207579553127, -0.020640239119529724, 0.006752589251846075, 0.03423773869872093, 0.0006656147306784987, -0.02695760317146778, -0.025572793558239937, -0.039143916219472885, 0.02396377921104431, 0.006271203514188528, 0.0019041114719584584, -0.056552935391664505, 0.03107246197760105, -0.03980334848165512, -0.009489234536886215, -0.020534729585051537, -0.0055458275601267815, -0.030070124194025993, -0.011474126018583775, -0.025823378935456276, -0.015615362673997879, 0.0033762946259230375, 0.013663442805409431, -0.024952927604317665, 0.00745818205177784, 0.01328097190707922, -0.026997169479727745, 0.01870150677859783, -0.013623876497149467, 0.026166284456849098, -0.007754927035421133, 0.017751924693584442, 0.04014625400304794, -0.00186454551294446, 0.0005588690983131528, -0.02304057404398918, 0.016472624614834785, 0.020587483420968056, -0.004503924399614334, -0.02074574865400791, -0.022513028234243393, -0.01822671666741371, -0.007748332340270281, 0.03109883889555931, -0.002838857239112258, 0.009851922281086445, 0.00038618018152192235, 0.05454825982451439, -0.03065042570233345, 0.012674293480813503, 0.02541453018784523, -0.037323880940675735, 0.007385644596070051, -0.00629098666831851, 0.012911689467728138, 0.004230259917676449, 0.03584675490856171, -0.011975294910371304, -0.011513692326843739, 0.02544090710580349, 0.021115031093358994, -0.010445411317050457, -0.007214192301034927, -0.0076692006550729275, 0.0024069289211183786, -0.02205142378807068, -0.009865110740065575, 0.05259634181857109, 0.024781474843621254, 0.004510518629103899, 0.023726383224129677, 0.04109583795070648, -0.03447513282299042, -0.05481203272938728, -0.008546246215701103, -0.023700006306171417, -0.008137397468090057, 0.00543042691424489, 0.027115866541862488, -0.023132894188165665, -0.014705345965921879, -0.014929552562534809, -0.037271127104759216, 0.018846582621335983, -0.018899336457252502, 0.04291586950421333, 0.02149750106036663, 0.007273541297763586, 0.0495365746319294, -0.014085479080677032, -0.014824043959379196, 0.02877763658761978, -0.02606077492237091, -0.004108265042304993, -0.03888014331459999, -0.03463339805603027, 0.019888486713171005, 0.024807851761579514, 0.023053761571645737, -0.02012588083744049, 0.015457099303603172, -0.0009718387154862285, 0.018121207132935524, -0.013940404169261456, 0.008269283920526505, 0.01370300818234682, -0.022104179486632347, 0.022183310240507126, -0.06135360524058342, 0.008196746930480003, -0.015549419447779655, -0.009687064215540886, 0.047347258776426315, 0.019189488142728806, -0.016841907054185867, -0.002731699263677001, 0.00849349144846201, 0.020706182345747948, -0.025876132771372795, 0.036400675773620605, 0.024821041151881218, -0.005720577202737331, 0.006370118353515863, -0.016617700457572937, -0.0035873129963874817, 0.005516153294593096, -0.010544326156377792, -0.02970084175467491, 0.04473590478301048, 0.025282643735408783, 0.054231733083724976, 0.03431687131524086, 0.0037785484455525875, 0.004273123107850552, 0.025427719578146935, -0.01262153871357441, -0.025651926174759865, -0.009278216399252415, -0.013531556352972984, 0.011995078064501286, -0.023409856483340263, 0.0018793827621266246, 0.038273464888334274, 0.008137397468090057, 0.036347921937704086, 0.002408577362075448, 0.03790418431162834, 0.03706010803580284, 0.0053809694945812225, 0.0205742958933115, 0.020785314962267876, 0.06014024838805199, -0.01763322576880455, 0.014283308759331703, 0.005387564189732075, -0.012008266523480415, -0.019585147500038147, 0.014006347395479679, -0.022803178057074547, 0.04230919107794762, 0.0002769616839941591, 0.03107246197760105, 0.009660687297582626, 0.032259441912174225, -0.020640239119529724, -0.015562607906758785, 0.03115159459412098, 0.01133564580231905, 0.017751924693584442, 0.020218202844262123, -0.044155605137348175, 0.029041409492492676, -0.008777047507464886, -0.0070295510813593864, -0.007405427750200033, 0.012727048248052597, 0.017699168995022774, -0.003267488209530711, 0.004550084471702576, 0.024623211473226547, -0.02785443142056465, 0.002764670876786113, -0.022565782070159912, 0.012463275343179703, -0.02329115755856037, -0.012898501008749008, 0.015523042529821396, 0.01118397619575262, -0.022987818345427513, -0.009462856687605381, -0.034105852246284485, -0.025032060220837593, -0.023449420928955078, -0.011401589028537273, -0.012753425166010857, 0.01256878487765789, 0.0005353767774067819, -0.007695578038692474, -0.022275632247328758, -0.00709549430757761, 0.02107546478509903, 0.007576880045235157, -0.017277132719755173, -0.0031240617390722036, -0.01397997047752142, 0.020864445716142654, -0.02259215898811817, 0.005090819206088781, 0.006208557635545731, 0.007497748360037804, 0.01663088984787464, -0.016367115080356598, -0.04629216715693474, 0.033631060272455215, 0.009733224287629128, -0.02970084175467491, -0.006258015055209398, 0.03421135991811752, -0.013650253415107727, -0.025546416640281677, 0.009555177763104439, 0.015021873638033867, 0.05776629224419594, -0.01668364368379116, 0.013399669900536537, 0.02501887083053589, 0.026456434279680252, 0.0270103570073843, 0.02426711842417717, 0.025098003447055817, -0.017039736732840538, 0.011645578779280186, 0.006943824701011181, -0.027115866541862488, 0.007181220687925816, -0.03898565098643303, -0.041834402829408646, 0.003396077547222376, 0.006904258858412504, -0.006970202084630728, -0.011480720713734627, 0.022156933322548866, -0.009370536543428898, 0.03856361657381058, 0.018569620326161385, -0.016353927552700043, -0.009779384359717369, -0.0333145335316658, 0.0038576803635805845, 0.009594744071364403, -0.02177446335554123, -0.01606377772986889, -0.046872466802597046, -0.025401342660188675, -0.0032608939800411463, -0.00453359866514802, -0.018411356955766678, 0.00010499402560526505, 0.04792755842208862, -0.0013642010744661093, 0.06567948311567307, 0.01399315893650055, -0.004497330170124769, 0.016604511067271233, -0.00488309795036912, -0.01914992183446884, 0.009805762208998203, -0.006897664628922939, 0.0030762527603656054, -0.023330723866820335, 0.004052212927490473, 0.029911860823631287, 0.011915946379303932, -0.03439600020647049, 0.021260105073451996, 0.021233728155493736, 0.043628059327602386, -0.01507462840527296, -0.013874460943043232, -0.005974458996206522, -0.016841907054185867, 0.022961441427469254, 0.009891488589346409, -0.00890233926475048, 0.04489417001605034, 0.0016007724916562438, 0.005209517199546099, -0.01858280971646309, 0.007860436104238033, -0.014969118870794773, 0.008836396038532257, -0.028461109846830368, -0.01397997047752142, 0.01721118949353695, 0.004180802498012781, 0.0005440318491309881, -0.0004144121485296637, -0.013188650831580162, -0.0038510861340910196, 0.013795329257845879, 0.004203882534056902, 0.00850667990744114, 0.04755827412009239, -0.019189488142728806, -0.004177505150437355, 0.011309267953038216, -0.01671002060174942, 0.019387317821383476, 0.0007830761605873704, -0.01813439466059208, 0.016499003395438194, 0.012179719284176826, 0.00111279240809381, 0.020165447145700455, -0.014362441375851631, 0.03072955645620823, 0.020033560693264008, -0.01984892040491104, 0.01281936839222908, -0.03062404692173004, 0.06219767779111862, -0.007299918215721846, -0.037297505885362625, -0.004675376694649458, 0.015272458083927631, -0.013096330687403679, -0.012647916562855244, -0.02147112414240837, -0.029674464836716652, 0.002077212557196617, 0.006515193730592728, 0.01030033640563488, 0.014283308759331703, -0.005588690750300884, 0.013175462372601032, -0.024425381794571877, -0.02205142378807068, 0.011355428956449032, 0.03524007648229599, 0.01965109072625637, 0.03384207934141159, 0.01083447691053152, 0.00532491784542799, -0.005071036517620087, -0.04291586950421333, 0.002166236052289605, 0.0037257939111441374, 0.014349251985549927, -0.005783223547041416, -0.003336728783324361, 0.0005580448196269572, 0.006063482258468866, -0.050565287470817566, 0.005911812651902437, 0.004296203143894672, 0.003066361416131258, -0.011915946379303932, 0.043786320835351944, -0.035925883799791336, -0.027828054502606392, 0.018437733873724937, 0.006096453871577978, 0.006680051796138287, 0.022658102214336395, 0.0034818039275705814, 0.003405969124287367, 0.016617700457572937, 0.007194409146904945, -0.006930636242032051, 0.012126964516937733, 0.031731896102428436, 0.014797666110098362, 0.019268618896603584, -0.015008685179054737, 0.014098668470978737, -0.051910530775785446, -0.017079303041100502, 0.0060469964519143105, 0.026918036863207817, 0.006970202084630728, -0.02342304401099682, 0.0070493342354893684, -0.038721878081560135, -0.03898565098643303, 0.019334562122821808, -0.05528682470321655, 0.025625549256801605, 0.023858269676566124, 0.0038444919046014547, 0.05866311863064766, -0.007128465920686722, -0.0008564380113966763, -0.011632390320301056, -0.010392657481133938, -0.006175586022436619, -0.0024844121653586626, 0.0018414653604850173, 0.00039339272188954055, 0.019268618896603584, 0.06399133801460266, -0.003913732245564461, -0.00720100337639451, -0.027221376076340675, -0.011823625303804874, -0.012153342366218567, 0.0023986860178411007, 0.029648087918758392, 0.014296498149633408, 0.012054427526891232, 0.02135242521762848, -0.024029722437262535, 0.009139735251665115, 0.015391156077384949, -0.0009256784687750041, 0.02040284313261509, -0.024702344089746475, 0.0159582681953907, -0.025032060220837593, 0.01259516179561615, 0.007451587822288275, 0.00434566056355834, -0.00972663052380085, 0.0047413199208676815, 0.019215865060687065, -0.03938131034374237, 0.009396913461387157, -0.07638866454362869, 0.007036145310848951, 0.0074845594353973866, 0.005624959710985422, 0.01153347548097372, -0.017198000103235245, 0.005974458996206522, -0.006360226776450872, -0.014283308759331703, 0.01256878487765789, -0.01008931826800108, 0.029120542109012604, 0.010491572320461273, -0.0638330727815628, 0.04542171582579613, 0.011243324726819992, 0.008104425854980946, 0.008908933959901333, -0.001383159775286913, -0.0034818039275705814, -0.009159518405795097, 0.0005312553257681429, 0.028250090777873993, -0.01791018806397915, -0.024451758712530136, 0.007471370976418257, -0.03067680262029171, -0.01049816608428955, 0.011777465231716633, 0.0021332642063498497, 0.005707388743758202, -0.018820205703377724, 0.007708766497671604, -0.020270956680178642, 0.023106517270207405, 0.006274500861763954, -0.037350259721279144, 0.01508781686425209, -0.0027696166653186083, 0.01101252343505621, 0.015628552064299583, 0.009917865507304668, 0.015285646542906761, 0.02269766852259636, -0.009100168943405151, 0.010735562071204185, -0.023976966738700867, 0.0010724022286012769, 0.006617405451834202, 0.010992740280926228, 0.00042141860467381775, -0.01204783283174038, 0.018635563552379608, 0.010359685868024826, 0.03065042570233345, -0.025084814056754112, -0.018068451434373856, 0.023409856483340263, 0.04961570352315903, 0.022658102214336395, -0.030544916167855263, 0.027748921886086464, 0.029964614659547806, -0.024425381794571877, -0.015127383172512054, -0.007055928464978933, -0.0060502937994897366, 0.0030597669538110495, -0.03146812319755554, -0.027564281597733498, -0.004193990956991911, 0.010142073035240173, 0.020363276824355125, 0.04133323207497597, -0.008875962346792221, -0.019941240549087524, 0.03566211089491844, -0.019440071657299995, 0.010432222858071327, -0.010900420136749744, 0.025506850332021713, 0.0191762987524271, -0.01189616322517395, -0.0009223812958225608, 0.026799339801073074, 0.006149208638817072, -0.003178464947268367, -0.0026591618079692125, 0.033182647079229355, 0.0065217879600822926, -0.00497541856020689, -0.02922605164349079, 0.030122879892587662, 0.035002678632736206, 0.014573459513485432, -0.00871769804507494, 3.781433406402357e-05, 0.008856179192662239, 0.02090401202440262, 0.014639402739703655, -0.02566511556506157, -0.010471789166331291, 0.0057238745503127575, 0.016327550634741783, 0.020389653742313385, -0.0389065220952034, 0.008592406287789345, 0.038748256862163544, 0.017026549205183983, -0.007847247645258904, 0.013379886746406555, -0.0005081752315163612, -0.03661169484257698, -0.03252321481704712, -0.0058920299634337425, -0.0008234663982875645, 0.010306931100785732, 0.008559434674680233, -0.032655101269483566, 0.02272404544055462, 0.006043699570000172, -0.00505784759297967, -0.004256637301295996, 0.009482639841735363, 0.03014925681054592, -0.03742939233779907, 0.0013815112179145217, 0.026298170909285545, 0.013017199002206326, -0.008440736681222916, -0.005361186806112528, -0.00996402557939291, 0.020481975749135017, -0.005285352002829313, -0.0585048571228981, 0.01833222433924675, 0.03964508697390556, -0.005793115124106407, -0.00011261871259193867, 0.046529561281204224, 0.014349251985549927, 0.0011366968974471092, -0.044656772166490555, 0.012126964516937733, 0.013353508897125721, 0.018147584050893784, 0.023713193833827972, -0.031019708141684532, 0.007728549651801586, -0.03893289715051651, -0.003712605219334364, -0.0005728820106014609, 0.00745818205177784, -0.004711645655333996, 0.0023014196194708347, 7.305276085389778e-05, 0.004573164973407984, 0.022987818345427513, -0.01578681543469429, 0.006897664628922939, -0.018635563552379608, -0.015206514857709408, -0.02594207599759102, -0.00993764866143465, -0.016551757231354713, -0.007787898648530245, -0.017896998673677444, -0.01785743422806263, 0.03808882459998131, 0.001309797866269946, -0.0028157769702374935, -0.03624241426587105, -0.00996402557939291, 0.006455844733864069, 0.05082906037569046, -0.005047956015914679, -0.019215865060687065, 0.00720100337639451, 0.0023113111965358257, -0.026153095066547394, -0.012093992903828621, 0.0032378139439970255, 0.009515611454844475, -0.01880701631307602, 0.04721537232398987, 0.01623522862792015, 0.003372997511178255, -0.01643306016921997, -0.010208016261458397, -0.02832922339439392, -0.011038901284337044, -0.03392121195793152, 0.014151422306895256, 0.03062404692173004, -0.016894662752747536, 0.0008580866269767284, -0.014573459513485432, -0.012225879356265068, 0.014454761520028114, 0.0007637053495272994, -0.01560217421501875, 0.048798009753227234, 0.02247346192598343, -0.007873624563217163, 0.01710567995905876, -0.010471789166331291, 0.014362441375851631, -0.0242143627256155, 0.017303509637713432, 0.008447331376373768, 0.004546787589788437, 0.0018414653604850173, -0.01102571189403534, 0.062039416283369064, 0.007412021979689598, 0.01688147336244583, -0.022789988666772842, -0.009410102851688862, 0.009278216399252415, -0.04906178265810013, -0.006445953156799078, 0.013234810903668404, 0.045606356114149094, -0.014758100733160973, 0.04660869389772415, 0.002174478955566883, 0.006633891724050045, 0.005275460425764322, -0.012311605736613274, 0.01347880158573389, 0.020561106503009796, -0.008579217828810215, 0.008387981913983822, -0.02331753447651863, -0.006749292369931936, 0.0010888880351558328, -0.03663807362318039, -0.030597670003771782, -0.012641321867704391, 0.038721878081560135, -0.02521670050919056, 0.006838315632194281, -0.0247682873159647, 0.0017293618293479085, 0.05444275215268135, 0.016604511067271233, -0.010168449953198433, -0.004724834114313126, 0.005413941107690334, 0.0037983315996825695, 0.02359449677169323, 0.01419098861515522, -0.03603139519691467, -0.01940050534904003, -0.022381141781806946, -0.03484441712498665, 0.03537196293473244, 0.02284274436533451, 0.018648752942681313, -0.0035675300750881433, -0.021616199985146523, -0.020363276824355125, 0.006709726061671972, 0.025454096496105194, -0.018925713375210762, 0.04125409945845604, 0.0026575131341814995, -0.01755409501492977, 0.00028520458727143705, 0.0008902339613996446, -0.029067786410450935, -0.013914027251303196, 0.007306512910872698, -0.014296498149633408, 0.0026838905178010464, -0.030887821689248085, -0.0070229568518698215, -0.025876132771372795, 0.0288303904235363, 0.01203464437276125, -0.011579635553061962, 0.019018035382032394, -0.008071454241871834]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" Jacobi
update matches autoregressive decoding. Sometimes, more
than one token might be correctly generated in a single
iteration, potentially reducing the number of decoding steps.
It is worth noting that, as ytis generated based on the past
valueyt−1on the trajectory, any two adjacent tokens from
yt−1andytcan form a meaningful 2-gram.
Limitations of Jacobi Decoding. Empirically, we observe
Jacobi decoding can hardly reduce decoding steps, even if
it can generate multiple tokens per step. This is because
the generated tokens are often put in the wrong positions
of the sequence, and correctly placed tokens are frequently
replaced by subsequent Jacobi iterations. These prevent it
from achieving wall-clock speedup.
3. L OOKAHEAD DECODING
LOOKAHEAD DECODING leverages Jacobi decoding’s abil-
ity to generate many tokens in one step but addresses itslimitation. Fig. 1 illustrates its workflow. The key design
inLOOKAHEAD DECODING is to keep track of the tra-
jectory of Jacobi decoding and generate n-gram from this
trajectory. This is achieved by maintaining a fixed-sized
2D window, with the two dimensions corresponding to the
sequence and the time axis, respectively, to generate mul-
tiple disjoint n-grams from the Jacobi iteration trajectory
in parallel. We call this process the lookahead branch . In
addition, LOOKAHEAD DECODING introduces an n-gram
pool to cache these n-grams generated along the trajec-
tory. Promising n-gram candidates are verified later by a
designed verification branch to preserve the LLM’s output
distribution; if passing verification, those disjoint n-grams
are integrated into the sequence. The detailed algorithm is
shown in Algorithm 2 in Appendix.
3.1. Lookahead Branch
LOOKAHEAD DECODING uses a fixed-sized 2D window
for efficient n-gram generation. In contrast to the original
Jacobi decoding, which only uses the history tokens from
the last step (or equivalently, it generates 2-grams), LOOKA -
HEAD DECODING generates many n-grams, with n≥2, in
parallel by using the n−1past steps’ history tokens, effec-
tively leveraging more information from the trajectory. The
fixed-sized 2D window in the lookahead branch is character-
ized by two parameters: (1) Wdefines the lookahead size
into future token positions to conduct parallel decoding; (2)
Ndefines the lookback steps into the past Jacobi trajectory
to retrieve n-grams. See Algorithm 2 for a detailed process.
An example of the lookahead branch with W= 5 and
N= 4is in Fig. 2 (b), in which we look back N−1 = 3
steps and look ahead 5tokens for each step. The blue token
with the digit 0 is the current step’s ( t) input, and the orange,
green, and red tokens were generated in previous lookahead
branches at steps t−3,t−2, and t−1, respectively. The
digit on each token shows its relative position to the current
input (i.e., the blue one labeled as 0). In the present stage,
we perform a modified Jacobi iteration to generate new
tokens for all 5 positions, following the trajectory formed
by the preceding 3 steps. Once generated, we collect and
cache them in the n-gram pool ( n= 4) – for instance, a
4-gram consists of the orange token at position 1, the green
token at position 2, the red token at position 3, and a newly
generated token.
The most outdated tokens in both dimensions (time and
sequence) will be removed, and newly generated tokens will
be appended to the lookahead branch to maintain a fixed
window size for each step. For example, we will remove
all orange and green tokens with position 1 in Fig. 2. We
then form a new lookahead branch with green tokens with
indices 2, 3, 4, 5, all red tokens, and all newly generated
tokens for the next step.
3
Lookahead decoding
3.2. Verification Branch
LOOKAHEAD DECODING preserves the output distribution
via its verification branch. We first discuss how to verify
in greedy sampling. Recall in speculative decoding: the
verification is performed by sending the draft tokens to the
LLM to get an output for each draft token, then progressively
checking if the last token’s corresponding output, generated
by the target LLM, exactly matches the draft token itself
(§2). The verification branch in LOOKAHEAD DE","[0.003259398741647601, 0.000906119414139539, 0.0339161641895771, 0.014537378214299679, -0.039573244750499725, 0.016116097569465637, 0.023693954572081566, -0.009748594835400581, 0.015458298847079277, 0.016773898154497147, 0.07256849110126495, -0.026811925694346428, -0.05425534024834633, 0.00907106138765812, -0.03065347671508789, -0.04017841815948486, 0.006456306204199791, -0.05578143522143364, -0.0062622553668916225, 0.03896806761622429, -0.03312680497765541, -0.007854131050407887, 0.03631055727601051, 0.06246468052268028, 0.02076016552746296, -0.047019537538290024, -0.02564104087650776, 0.03567906841635704, 0.03465289995074272, -0.07183175534009933, -0.009610457345843315, -0.027759157121181488, -0.01770797371864319, -0.012767896987497807, 0.012478465214371681, 0.011373360641300678, 0.03562644496560097, -0.03194276615977287, -0.010169587098062038, 0.018957793712615967, -0.0043842364102602005, 0.00891976710408926, -0.06914792954921722, 0.002646000124514103, 0.002244742354378104, 0.021944206207990646, 0.024233348667621613, 0.019615594297647476, -0.019405098631978035, 0.07972535490989685, -0.021812645718455315, 0.058360010385513306, -0.03631055727601051, 0.03175858035683632, -0.06467489153146744, 0.015918757766485214, -0.044888269156217575, 0.016642337664961815, 0.02535161003470421, 0.008538243360817432, 0.03452134132385254, -0.03007461316883564, 0.0173922311514616, -0.006726004183292389, -0.024864837527275085, -0.015839822590351105, -0.012379794381558895, -0.0016206545988097787, 0.005867575295269489, 0.012984970584511757, -0.009847264736890793, 0.04741422086954117, 0.008893455378711224, -0.044888269156217575, -0.04480933025479317, 0.01756325736641884, 0.03678417205810547, 0.03941537067294121, 0.07919911295175552, 0.001690545817837119, 0.06267517805099487, 0.02052335813641548, -0.01136020477861166, -0.04778258875012398, 0.006499063223600388, -0.052966050803661346, 0.012024582363665104, -0.04273068532347679, -0.02235204167664051, -0.013590146787464619, -0.005324890371412039, 0.06309617310762405, -0.04120458662509918, 0.01183382049202919, 0.000696034578140825, 0.018036874011158943, -0.0030817927327007055, -0.034468717873096466, 0.040020547807216644, 0.02206260897219181, -0.006249099504202604, -0.00568010238930583, 0.022154701873660088, -0.03183751553297043, 0.07472607493400574, -0.027785468846559525, -0.04157295450568199, 0.03631055727601051, -0.029969364404678345, -0.008544821292161942, -0.07025302946567535, -0.0026196881663054228, -0.01973399892449379, 0.016800209879875183, 0.02506217733025551, -0.007702837232500315, -0.03239006921648979, 0.0015277403872460127, -0.006518797483295202, -0.019694529473781586, -0.002835117746144533, -0.013826954178512096, 0.017865845933556557, -0.031074468046426773, -0.03741566091775894, -0.01197853684425354, 0.013261246494948864, -0.0655168741941452, -0.0025999541394412518, -0.006354347337037325, 0.03373198211193085, 0.017786910757422447, 0.0015746086137369275, -0.013655927032232285, -0.017458010464906693, -0.02191789448261261, 0.017931627109646797, -0.003136061131954193, 0.013274402357637882, 0.010662936605513096, 0.005795217584818602, -0.018549958243966103, -0.006854275241494179, -0.022878281772136688, -0.029258940368890762, 0.02286512590944767, -0.015379362739622593, 0.01616872288286686, -0.01674758642911911, -0.01037350483238697, -0.03667892515659332, -0.04720372334122658, -0.024075478315353394, -0.030916597694158554, -0.03917856514453888, -0.00018531458044890314, -0.04246756434440613, 0.005094660446047783, 0.013616458512842655, -0.0163792185485363, -0.07251586765050888, 0.018010562285780907, 0.038494452834129333, 0.02265463024377823, -0.024483313784003258, 0.043441109359264374, -0.046782732009887695, 0.005745882634073496, -0.05899149924516678, 0.008682958781719208, -0.01085369847714901, -0.0393364354968071, -0.023036153987050056, 0.01682652160525322, 0.003986267372965813, 0.011353626847267151, -0.03723147511482239, -0.06835857033729553, -0.021694241091609, -0.059096746146678925, -0.02671983279287815, 0.0068411193788051605, 0.02679876983165741, 0.003270910121500492, -0.05175570026040077, -0.0271539818495512, -0.018181590363383293, -0.012662649154663086, -0.00229407730512321, 0.05804426595568657, 0.018681518733501434, 0.05070322006940842, 0.027127670124173164, -0.002075358759611845, 0.02621990628540516, -0.06941104680299759, 0.06777970492839813, 0.006377370562404394, 0.009781485423445702, -0.010005136951804161, 0.011129975318908691, -0.03181120380759239, -0.01245873048901558, 0.0059530893340706825, -0.007492341101169586, 0.023904450237751007, 0.0020967372693121433, -0.024443846195936203, 0.005515652243047953, -0.05109789967536926, -0.005555120296776295, -0.039125941693782806, 0.03307418152689934, 0.019273538142442703, -0.030416669324040413, 0.007229221053421497, -0.016642337664961815, 0.015010994859039783, -0.027048733085393906, 0.020628605037927628, -0.02052335813641548, 0.013984826393425465, 0.005347913596779108, 0.0493876188993454, -0.03610005974769592, 0.02548316866159439, 0.029522061347961426, -0.017208047211170197, 0.047598402947187424, 0.013083640486001968, 0.05338704213500023, -0.005844552535563707, 0.014734718948602676, -0.016550246626138687, 0.026614585891366005, -0.013919047079980373, -0.019615594297647476, -0.06130695343017578, 0.0018714407924562693, 0.008031737059354782, -0.026627741754055023, 0.015458298847079277, 0.011550966650247574, -0.01748432219028473, -0.03720516338944435, 0.028232773765921593, -0.046203866600990295, -0.026680365204811096, 0.028048589825630188, 0.006193186156451702, -0.034994956105947495, -0.02322033792734146, -0.0261409692466259, 0.026246218010783195, -0.04073097184300423, 0.014471598900854588, -0.020076053217053413, 0.08335641026496887, -0.051071587949991226, 0.01110366266220808, -0.004502640571445227, -0.03546857088804245, -0.04104671627283096, 0.03983636572957039, -0.021431121975183487, 0.01616872288286686, 0.03967849165201187, -0.02424650639295578, 0.008636913262307644, -0.006002424284815788, -0.059886105358600616, -0.029627308249473572, 0.02600940875709057, 0.05667604133486748, -0.008439573459327221, -0.017142266035079956, 0.03007461316883564, -0.029074756428599358, -0.040231045335531235, 0.044467274099588394, 0.005693258251994848, 0.006525375414639711, 0.04957180470228195, 0.01777375489473343, 0.03399509936571121, -0.002351634670048952, -0.019260382279753685, -0.017800066620111465, -0.021523213014006615, 0.021654773503541946, -0.01085369847714901, -0.03283737227320671, 0.028153836727142334, 0.012761319056153297, 0.01161674689501524, 0.02118115872144699, 0.01827368140220642, -0.0009094084380194545, 0.016879146918654442, -0.014747874811291695, 0.03873125836253166, -0.0002372191083850339, 0.001889530336484313, -0.018181590363383293, -0.06141220033168793, 0.039204876869916916, 0.0018270392902195454, 0.018102653324604034, 0.024443846195936203, 0.0009250311413779855, -0.010722138918936253, 0.01893148198723793, -0.033968787640333176, 0.012057472951710224, -0.02896950952708721, -0.04854563623666763, 0.08740845322608948, -0.023917606100440025, 0.05525519326329231, -0.04025735706090927, -0.04712478816509247, -0.015116242691874504, 0.002762759802863002, -0.00024400265829171985, -0.0195235013961792, -0.02599625289440155, -0.015760885551571846, 0.01073529478162527, 0.03678417205810547, 0.016050318256020546, 0.024562248960137367, 0.022088922560214996, 0.02003658562898636, 0.018734142184257507, -0.04959811642765999, -0.06325404345989227, -0.02802227810025215, -0.021312717348337173, -0.0006224432145245373, 0.03431084379553795, -0.09119738638401031, 0.006278700195252895, 0.03373198211193085, -0.04362529143691063, -0.046493299305438995, 0.030258797109127045, -0.012833676300942898, 0.037836652249097824, 0.01551092229783535, -0.02047073468565941, -0.0031525061931461096, -0.049045562744140625, -0.0043546357192099094, -0.000788948789704591, 0.04465145990252495, -6.747588486177847e-05, -0.015668794512748718, 0.0007507141563110054, -0.012524510733783245, 0.002443726873025298, -0.027995964512228966, 0.02132587321102619, 0.014826810918748379, 0.04623017832636833, -0.014708406291902065, -0.006291856523603201, -0.045756563544273376, -0.01318231038749218, -0.014405818656086922, 0.010360348969697952, 0.007821241393685341, 0.028416957706212997, -0.0014471599133685231, 0.012379794381558895, -0.05504469946026802, -0.01343885250389576, -0.0016272326465696096, 0.025470012798905373, 0.019865557551383972, 0.049413930624723434, -0.0009135196451097727, -0.005739304237067699, -0.03399509936571121, -0.016510779038071632, 0.011439140886068344, 0.022181013599038124, -0.01987871341407299, -0.028311708942055702, -0.021681085228919983, -0.005933355540037155, -0.06104383245110512, -0.006219498347491026, 0.004986123647540808, 0.019484033808112144, -0.016984393820166588, 0.0021575838327407837, -0.017589570954442024, 0.030311420559883118, 0.04215181991457939, 0.01124837901443243, 0.025746289640665054, -0.03828395530581474, -0.01631343923509121, -0.058360010385513306, 0.008354059420526028, -0.011439140886068344, 0.004548686556518078, 0.06909530609846115, 0.05641292408108711, 0.04294117912650108, 0.022154701873660088, 0.016444997861981392, 0.03007461316883564, -0.040520474314689636, 0.04388841241598129, 0.010768185369670391, -0.009972247295081615, -0.010130118578672409, 0.03373198211193085, 0.052676618099212646, -0.003019301686435938, -0.001567208324559033, -0.08172506093978882, -0.06304354220628738, -0.04957180470228195, -0.012610024772584438, -0.0016889013350009918, -0.014774186536669731, 0.04494089260697365, -0.04680904373526573, -0.009847264736890793, 0.03728409856557846, 0.02411494590342045, -0.041757140308618546, -0.03815239667892456, 0.025285828858613968, 0.004081648774445057, 0.038415517657995224, -0.0036080325953662395, -0.05614980310201645, -0.02891688421368599, 0.03617899492383003, -0.028416957706212997, 0.00720948725938797, -0.03538963571190834, 0.034468717873096466, -0.04644067585468292, -0.052545059472322464, 0.016366062685847282, -0.006137273274362087, 0.018970949575304985, 0.0067687612026929855, 0.026483025401830673, -0.010149853304028511, 0.0011610168730840087, -0.036731548607349396, 0.07572592794895172, -0.03967849165201187, -0.005084793549031019, -0.03659998998045921, -0.03036404587328434, -0.0402047336101532, -0.014682094566524029, -0.0023664352484047413, 0.004532241728156805, 0.006051759235560894, 0.010070917196571827, 0.014326882548630238, 0.028706388548016548, -0.015195178799331188, 0.014839966781437397, -0.03786296397447586, -0.0033843806013464928, -0.026114657521247864, -0.007748883217573166, 0.0528608039021492, 0.010426129214465618, -0.08077783137559891, -0.0190893542021513, 0.0038218176923692226, -0.022338885813951492, 0.011675949208438396, 0.025956785306334496, -0.001215285388752818, -0.006337902508676052, 0.0430990532040596, -0.0020737142767757177, 0.0033136671409010887, -0.006305012386292219, -0.042125508189201355, 0.005390670616179705, -0.005341335665434599, 0.0037165696267038584, -0.014590002596378326, -0.00168396788649261, 0.008018581196665764, 0.010038026608526707, -0.00028429290978237987, 0.0003638455818872899, 0.028074901551008224, 0.017300138249993324, 0.033889852464199066, -0.009044748730957508, 0.10082757472991943, 0.0242596622556448, -0.020839102566242218, -0.01790531352162361, 0.03007461316883564, 0.004486195743083954, 0.018036874011158943, -0.014511066488921642, -0.005900465417653322, -0.012754741124808788, -0.03996792435646057, -0.03736303746700287, -0.0108471205458045, -0.041178274899721146, -0.0005583076854236424, -0.007413405459374189, -0.00629843445494771, 0.024483313784003258, -0.034626588225364685, -0.0038908866699784994, -0.015024150721728802, 0.02731185406446457, -0.01732644997537136, -0.024522781372070312, -0.09651240706443787, -0.02222048118710518, -0.0006002424634061754, 0.024154413491487503, -0.004637489560991526, -0.014103231020271778, -0.009636769071221352, -0.06814807653427124, -0.01343227457255125, -0.028890572488307953, 0.007248955313116312, -0.04638805240392685, -0.04209919646382332, -0.005403826478868723, -0.005022302269935608, -0.0022085632663220167, -0.016418686136603355, -0.010505065321922302, -0.013813798315823078, -0.002017801394686103, -0.017444854602217674, -0.005400537513196468, 0.04530926048755646, 0.007781773339956999, -0.04638805240392685, 0.02439122088253498, 0.0010089006973430514, -0.04980861023068428, -0.003946799784898758, 0.0054794736206531525, -0.004042180720716715, 0.013373072259128094, -0.04120458662509918, 0.02045757882297039, 0.010662936605513096, 0.009768328629434109, -0.003933643456548452, -0.011228645220398903, 0.03204801306128502, 0.004121116362512112, -0.020062897354364395, 0.040099482983350754, 0.023036153987050056, -0.015431986190378666, -0.019247226417064667, 0.022023141384124756, -0.020273394882678986, -0.020431265234947205, -0.028232773765921593, -0.006074782460927963, 0.00416716281324625, 0.011820664629340172, 0.02744341269135475, -0.027127670124173164, -0.011669371277093887, -0.004578287713229656, -0.016589714214205742, -0.0428096204996109, 0.013892734423279762, -0.013373072259128094, 0.0201023668050766, 0.0013509566197171807, -0.0010713916271924973, 0.023707110434770584, -0.00017740041948854923, -0.020707542076706886, 0.022167857736349106, -0.05441321060061455, 0.0032149972394108772, 0.00012868210615124553, 0.00989988911896944, 0.0006561554619111121, 0.0003052602696698159, 0.011327315121889114, 0.014340038411319256, -0.007492341101169586, -0.01835261844098568, 0.019339317455887794, -0.0021296273916959763, -0.028811637312173843, 0.02710135653614998, 0.04354635626077652, -0.01922091469168663, 0.0009595656301826239, 0.030127236619591713, 0.003328467719256878, 0.017234358936548233, -0.04775627702474594, 0.027759157121181488, -0.01878676563501358, -0.030679788440465927, 0.033968787640333176, 0.004492773674428463, 0.026838237419724464, 0.01016300916671753, 0.03704729303717613, 0.0009644991368986666, 0.004397392738610506, 0.02243097685277462, -0.014129542745649815, -0.015247802250087261, 0.0007922378135845065, -0.031495459377765656, -0.024785902351140976, -0.008090939372777939, -0.0019964228849858046, 0.006614178419113159, 0.013254668563604355, -0.000682878540828824, 0.02018130198121071, -0.00336793577298522, 0.014879434369504452, -0.007834397256374359, -0.014734718948602676, 0.010505065321922302, 0.00293049868196249, -0.00659115519374609, 0.00793964508920908, 0.002473327796906233, 0.019826089963316917, 0.0014397596241906285, 0.0012070628581568599, -0.024351753294467926, -0.003160728607326746, -0.02220732532441616, 0.0709371417760849, -0.004574998747557402, 0.04646698758006096, -0.014958370476961136, 0.006249099504202604, 0.004772338550537825, 0.06014922633767128, 0.01026167906820774, -0.021378498524427414, -0.007275267504155636, -0.03220588341355324, -0.03386354073882103, 0.016668651252985, 0.04188869893550873, -0.0022398086730390787, 0.013563835062086582, -0.011439140886068344, -0.016273969784379005, -0.000934898154810071, 0.022667786106467247, 0.02119431458413601, -0.015668794512748718, -0.034705523401498795, -0.013774330727756023, -0.019694529473781586, -0.038836508989334106, -0.02140481024980545, 0.018326306715607643, -0.017931627109646797, 0.0020671363454312086, -0.043862100690603256, -0.03794189915060997, 2.1314259356586263e-05, -0.008354059420526028, 0.041467707604169846, -0.03073241375386715, 0.03781034052371979, -0.042993802577257156, -0.00586099736392498, -0.013142842799425125, 0.026706676930189133, -0.012498199008405209, 0.043572667986154556, -0.0076567912474274635, 0.0017316583544015884, 0.018444709479808807, -0.012399529106914997, -0.0425201877951622, 0.0018451288342475891, 4.715089380624704e-05, 0.035573821514844894, -0.03365304321050644, -0.005729437340050936, -0.035652756690979004, 0.00841326080262661, 0.046782732009887695, 0.023983385413885117, -0.025377921760082245, -0.008235654793679714, 0.020773321390151978, -0.008959234692156315, -0.017589570954442024, -0.03073241375386715, 0.008729005232453346, -0.019247226417064667, -0.033100493252277374, 0.0004440149641595781, -0.023996541276574135, -0.02694348618388176, 0.005265688523650169, 0.0006606777897104621, -0.013761174865067005, 0.0012563979253172874, -0.042414940893650055, 0.007446295116096735, 0.013932202942669392, -0.016629181802272797, 0.030390357598662376, 0.010057761333882809, -0.0093999607488513, 0.012261390686035156, -0.05667604133486748, -0.0057787722907960415, 0.04017841815948486, -0.05878100171685219, -0.04296749085187912, -0.015668794512748718, 0.01183382049202919, 0.01995765045285225, -0.013359916396439075, -0.00017287804803345352, 0.007387093268334866, 0.0029847673140466213, -0.02535161003470421, 0.017365917563438416, 0.00555183133110404, 0.01922091469168663, -0.006252388469874859, -0.022299418225884438, 0.011222067289054394, -0.02220732532441616, -0.0534396655857563, 0.01052479911595583, 0.03294261917471886, 0.01958928257226944, 0.008255389519035816, -0.025233205407857895, -0.04130983725190163, 0.015129398554563522, -0.010419551283121109, -0.0029666777700185776, -0.005624189507216215, 0.00029847671976312995, 0.006157007534056902, -0.007327891420572996, -0.0010656359372660518, 0.047072164714336395, 0.011432562954723835, 0.011590435169637203, 0.0015746086137369275, 0.04872981831431389, 0.024575404822826385, 0.02132587321102619, -0.022009985521435738, 0.03181120380759239, -0.012300859205424786, -0.016326595097780228, 0.002333545358851552, -0.013892734423279762, -0.0019766888581216335, -0.011366782709956169, 0.016734430566430092, -0.01777375489473343, -0.017602726817131042, -0.006377370562404394, 0.03412666171789169, -0.0032972220797091722, -0.03765246644616127, 0.029969364404678345, -0.004956522490829229, 0.01827368140220642, 0.0049006096087396145, 0.020773321390151978, 0.026404090225696564, -0.0212600938975811, -0.10351140052080154, 0.011340470984578133, 0.010603735223412514, 0.014011139050126076, -0.022904593497514725, 0.01841839775443077, 0.026996109634637833, 0.03886282071471214, -0.03496864438056946, 0.0029864117968827486, -0.02607518993318081, -0.021720554679632187, -0.01307048462331295, -0.02731185406446457, -0.013188888318836689, -0.038915444165468216, 0.0032117082737386227, -0.022181013599038124, 0.0037757717072963715, -0.01052479911595583, -0.03257425129413605, -0.021023286506533623, 0.004088226705789566, -0.005331468302756548, -0.015603014267981052, 0.008163297548890114, 0.010807652957737446, -0.0037067027296870947, 0.0019240648252889514, 0.01248504314571619, -0.02190473861992359, 0.01732644997537136, 0.021746866405010223, 0.022023141384124756, 0.016800209879875183, -0.030627164989709854, -0.03341623768210411, -0.020720697939395905, 0.015392518602311611, 0.0037922165356576443, -0.0298641175031662, -0.06372765451669693, 0.014484754763543606, -0.014826810918748379, -9.944084922608454e-06, -0.0135769909247756, 0.00012909324141219258, -0.027206605300307274, -0.0026015988551080227, 0.0039796894416213036, -0.004002712666988373, -0.007229221053421497, -0.0009686104021966457, -0.0064595951698720455, -0.027048733085393906, 0.01528727076947689, -0.01136020477861166, -0.006143851205706596, -0.00746602937579155, 0.038547076284885406, 0.0012391306227073073, 0.029469437897205353, 0.039494309574365616, 0.0028219616506248713, 0.01503730658441782, -0.024141257628798485, -0.01870783045887947, 0.03154808655381203, -0.025233205407857895, -0.015050462447106838, -0.011156287044286728, -0.009307868778705597, 0.008380371145904064, 0.005726148374378681, -0.003624477656558156, 0.00635105837136507, -0.007913333363831043, 0.0012004849268123507, -0.03123234026134014, 0.008722427301108837, 0.04480933025479317, -0.043941035866737366, -0.010616891086101532, 0.012892878614366055, -0.00457170931622386, -0.006827963516116142, 0.03220588341355324, -0.011281268671154976, 0.008729005232453346, 0.003558697644621134, 0.007880442775785923, -0.00453553069382906, -0.006104383617639542, 0.008992125280201435, -0.01631343923509121, -0.03089028410613537, -0.006512219551950693, 0.022233637049794197, 0.03020617365837097, 0.010623469017446041, 0.02389129437506199, 0.030548229813575745, -0.008465885184705257, -0.05044009909033775, -0.01343227457255125, -0.011202332563698292, -0.012656070291996002, -0.005015724338591099, -0.00046292669139802456, -0.014287414960563183, -0.0015630971174687147, -0.02554894983768463, -0.03323205187916756, 0.030469292774796486, -0.0028104502707719803, 0.030021989718079567, 0.01936562918126583, 0.011149709112942219, 0.046940602362155914, -0.00841326080262661, -0.012688960880041122, 0.027259228751063347, -0.030179861932992935, 0.006318168248981237, -0.006653646472841501, -0.027338165789842606, 0.0198129341006279, -0.005292000249028206, 0.027048733085393906, -0.014945214614272118, -0.023391366004943848, -0.019023574888706207, 0.014905746094882488, -0.015010994859039783, 0.011965380981564522, -0.005107816308736801, -0.008025159128010273, 0.02577260136604309, -0.02978518046438694, 0.021575838327407837, -0.014024294912815094, -0.008636913262307644, 0.03825764358043671, 0.023654485121369362, 0.010893166996538639, -0.017089642584323883, -0.008090939372777939, 0.050940025597810745, -0.023693954572081566, 0.030969221144914627, 0.00542356027290225, -0.007275267504155636, 0.0011125041637569666, 0.015695106238126755, 0.001323822420090437, 0.05230825021862984, -0.014037450775504112, -0.03473183512687683, 0.025430545210838318, 0.04567762836813927, 0.04544081911444664, 0.04388841241598129, -0.01610294170677662, -0.011412829160690308, 0.017129110172390938, -0.005367647390812635, -0.04754577949643135, 0.007801507133990526, -0.017089642584323883, -0.010024870745837688, -0.009182887151837349, -0.0008756961906328797, 0.020207613706588745, -0.011044461280107498, 0.0548868253827095, 0.016734430566430092, 0.0023154558148235083, 0.04920343682169914, 0.03828395530581474, 0.008038314990699291, 0.010603735223412514, 0.05059796944260597, -0.0005451517063193023, -0.006522086448967457, 0.0023976806551218033, -0.003785638604313135, 0.010965525172650814, 0.004742737393826246, -0.028495892882347107, 0.03365304321050644, 0.013392806984484196, 0.028811637312173843, -0.021799489855766296, 0.010801075026392937, -0.02272040955722332, 0.016839677467942238, 0.025430545210838318, 0.01828683726489544, -0.002673956798389554, 0.02875901386141777, -0.011787774972617626, 0.03533701226115227, 0.0033630020916461945, -0.013787486590445042, 0.005324890371412039, 0.018615737557411194, 0.01724751479923725, -0.0008978968835435808, 0.01748432219028473, 0.03165333345532417, -0.007373937405645847, -0.005433427635580301, -0.045335572212934494, 0.024785902351140976, -0.03857338801026344, -0.023707110434770584, 0.011373360641300678, -0.019339317455887794, 0.006966101471334696, -0.007354203145951033, -0.021523213014006615, -0.015681950375437737, -0.02818014845252037, -0.0295746847987175, -0.012932347133755684, 0.029627308249473572, 0.021878425031900406, 0.002525951713323593, -0.02249675802886486, -0.010866855271160603, -0.010794497095048428, -0.0012802431592717767, -0.027548661455512047, 0.014011139050126076, -0.017379073426127434, 0.023707110434770584, -0.016300281509757042, -0.0014537378447130322, -0.032442692667245865, 0.015353050082921982, 0.01369539462029934, -0.02381235733628273, -0.030758725479245186, 0.011570700444281101, 0.004288855474442244, -0.007275267504155636, 0.0149320587515831, 0.05001910775899887, 0.005430138669908047, 0.004989412613213062, 0.0006693114410154521, 0.013024439103901386, 0.06530638039112091, -0.011222067289054394, 0.010564266704022884, -0.0007749705691821873, 0.021825801581144333, 0.014011139050126076, 0.013511210680007935, 0.03110078163444996, -0.011603591032326221, 0.02482536993920803, -0.003946799784898758, -0.02002342976629734, -0.03028510883450508, -0.015195178799331188, -0.03909962996840477, 0.016510779038071632, -0.004982834681868553, 0.009084217250347137, -0.002583509311079979, 0.014234790578484535, -0.0018467733170837164, 0.030916597694158554, 0.005347913596779108, -0.017747441306710243, -0.0006906899507157505, -0.029627308249473572, -0.004269121680408716, -0.002825250616297126, -0.015339894220232964, -0.03496864438056946, -0.056097179651260376, -0.015024150721728802, -0.014234790578484535, -0.031995389610528946, -0.03154808655381203, -0.004009290598332882, 0.05978085845708847, -0.020575981587171555, 0.04883506894111633, 0.0008271834230981767, -0.004403970669955015, 0.004157295450568199, 0.012866566888988018, -0.020957505330443382, -0.015997694805264473, -0.011261534877121449, 0.02504902146756649, -0.0063576363027095795, -0.0016987683484330773, 0.04362529143691063, -0.002575286664068699, -0.03646842762827873, 0.007295001298189163, 0.029232628643512726, 0.026193592697381973, -0.026483025401830673, -0.03036404587328434, -0.0005139061831869185, -0.021378498524427414, 0.015497766435146332, 0.007637057453393936, 0.0035258077550679445, 0.035494882613420486, -0.006436572410166264, -0.02868007682263851, -0.0313112773001194, 0.0407835952937603, -0.029232628643512726, -0.0008021047688089311, -0.0024667498655617237, -0.002840051194652915, 0.021641617640852928, 0.008630335330963135, -0.027548661455512047, -0.00024379709793720394, -0.016181878745555878, -0.015089930966496468, 0.01849733479321003, -0.006775339134037495, -0.005127550568431616, 0.04349373281002045, -0.025825224816799164, -0.025167426094412804, 0.025180581957101822, -0.027180293574929237, 0.0056537906639277935, -0.012353482656180859, -0.027838094159960747, 0.011820664629340172, 0.025733133777976036, 0.006005713250488043, 0.014208478853106499, -0.010958947241306305, 0.02076016552746296, 0.044467274099588394, -0.008400104939937592, 0.03167964518070221, -0.016431841999292374, 0.05904412269592285, -8.890577009879053e-05, -0.035073891282081604, -0.002764404285699129, -0.0034994955640286207, -0.04473039507865906, -0.011623324826359749, -0.012156142853200436, -0.014155854471027851, -0.011853555217385292, 0.009656502865254879, 0.009038170799612999, 0.01755010150372982, -0.015392518602311611, 0.018760453909635544, -0.038205020129680634, -0.02636462077498436, 0.023851824924349785, 0.03552119806408882, 0.022996686398983, 0.010360348969697952, 0.03283737227320671, 0.015813510864973068, -0.015931913629174232, -0.032074324786663055, -0.003025879617780447, 0.02031286247074604, 0.017944782972335815, 0.026811925694346428, 0.010682671330869198, 0.019036730751395226, -0.007248955313116312, -0.03959955647587776, -0.007479185238480568, -0.0032149972394108772, 0.029522061347961426, 0.0037099916953593493, 0.02264147438108921, -0.023036153987050056, -0.022733565419912338, 0.02032601833343506, 0.011708838865160942, 0.00637408159673214, 0.0044960626401007175, -0.009294712916016579, 0.026746144518256187, 0.02519373781979084, -0.0012802431592717767, -0.005430138669908047, -0.0028943198267370462, 0.031784892082214355, 0.01647130958735943, 0.02220732532441616, -0.008439573459327221, 0.010715560987591743, -0.054728955030441284, -0.027364477515220642, -0.006337902508676052, 0.035284388810396194, 0.0017694818088784814, -0.0339161641895771, 0.028943197801709175, -0.015931913629174232, -0.03231113404035568, -0.0014570268103852868, -0.04638805240392685, 0.00039303547237068415, 0.0422307550907135, 0.005722859408706427, 0.010439285077154636, -0.0018993973499163985, 0.012971814721822739, -0.015958227217197418, -0.004311878699809313, -0.010577422566711903, 0.0030998822767287493, -0.01074187271296978, 0.00403889175504446, 0.02331242896616459, 0.012498199008405209, -0.00574917159974575, 0.007821241393685341, -0.010097228921949863, 0.0010911256540566683, -0.017023861408233643, -0.013932202942669392, 0.022312574088573456, -0.013037594966590405, 0.022233637049794197, 0.016260813921689987, -0.027127670124173164, 0.00690032122656703, 0.01923407055437565, 0.0050979494117200375, 0.009163153357803822, -0.01452422235161066, -0.00818960927426815, -0.050071731209754944, 0.01893148198723793, 0.005338046699762344, 0.002999567659571767, -0.011912756599485874, -0.021720554679632187, 0.018747298046946526, -0.005196619313210249, 0.007788351271301508, -0.06541162729263306, -0.0010755029506981373, 0.008643491193652153, -0.0011059261159971356, 0.011452296748757362, -0.0045289527624845505, 0.001279420917853713, 0.010386660695075989, -0.013024439103901386, 0.004884164314717054, 0.003956666681915522, -0.011820664629340172, -0.00021070154616609216, -0.05951773747801781, 0.033968787640333176, 0.012432418763637543, -0.02074700966477394, 0.005555120296776295, 0.014300570823252201, -0.02235204167664051, -0.01623450219631195, 0.02098381705582142, 0.014984682202339172, -0.05033485218882561, -0.030100924894213676, 0.00016650560428388417, -0.023838669061660767, 0.009603879414498806, -0.024799058213829994, 0.032732125371694565, -0.005456450395286083, -0.009735438972711563, 0.005183463450521231, -0.021207470446825027, 0.03602112457156181, -0.017602726817131042, -0.014918902888894081, 0.0011231934186071157, -0.006311590317636728, 0.0344950295984745, 0.009353915229439735, -0.010945790447294712, 0.027180293574929237, -0.0003733014746103436, 0.006331324577331543, 0.012583713047206402, 0.004232942592352629, -0.011991692706942558, 0.0034370047505944967, 0.0012662648223340511, 0.0048808753490448, 0.013405962847173214, 0.03967849165201187, 0.009235511533915997, 0.01489259023219347, -0.022088922560214996, -0.029074756428599358, 0.015708262100815773, 0.044677771627902985, 0.014774186536669731, -0.023351898416876793, 0.006762183271348476, 0.034258220344781876, 0.0057787722907960415, 0.002780849114060402, -0.011018148623406887, 0.011116818524897099, -0.0011453941697254777, -0.01894463784992695, -0.03946799784898758, 0.0006318990490399301, 0.012978392653167248, -0.008604023605585098, 0.03573169186711311, -0.016800209879875183, -0.011649636551737785, 0.027706533670425415, -0.022628318518400192, 0.007952800951898098, 0.0066668023355305195, 0.027759157121181488, 0.025075333192944527, -0.015471454709768295, 0.010590579360723495, 0.04178345203399658, 0.027417100965976715, 0.0005480295512825251, -0.003339979099109769, 0.020918037742376328, 0.020299706608057022, -0.022194169461727142, -0.015826666727662086, 0.016405530273914337, 0.042204443365335464, -0.014971526339650154, -0.013228356838226318, -0.02606203407049179, 0.009334181435406208, 0.010649780742824078, 0.014063762500882149, -0.014182166196405888, -0.008630335330963135, 0.0029206317849457264, 0.023483457043766975, 0.012162720784544945, -0.0004088637651875615, -0.007623901125043631, 0.029311565682291985, 0.025443701073527336, -0.0173922311514616, 0.01551092229783535, 0.0007276911637745798, -0.022470446303486824, -0.03286368399858475, 0.00025201961398124695, -0.004255965352058411, 0.0028877416625618935, -0.0015902313170954585, -0.022707253694534302, 0.03328467532992363, -0.011097084730863571, 0.007906755432486534, -0.020918037742376328, -0.0011149708880111575, -0.004778916481882334, -0.01697123795747757, 0.031074468046426773, -0.011715416796505451, 0.007143707480281591, -0.01394535880535841, -0.020654918625950813, -0.00878162868320942, 0.007189753465354443, 0.012314015068113804, -0.014366350136697292, -0.001799082849174738, 0.03052191622555256, 0.02060229331254959, 0.02978518046438694, 0.022325729951262474, 0.002700268756598234, 0.004440149758011103, 0.00664377911016345, -0.0029979231767356396, -0.015905601903796196, 0.055886682122945786, 0.022259950637817383, -0.03378460556268692, -0.0011947291204705834, -0.031627021729946136, 0.021431121975183487, 0.009584144689142704, -0.019931338727474213, 0.0096893934533, -0.009985403157770634, 0.009768328629434109, 0.03044298104941845, 0.007452873047441244, -0.01380064245313406, 0.0016954793827608228, -0.019536657258868217, -0.0023286116775125265, -0.02199682965874672, 0.0023105223663151264, -0.006436572410166264, -0.017747441306710243, -0.010287990793585777, -0.009182887151837349, 0.03970480337738991, 0.03591587767004967, -0.009814375080168247, -0.002555552637204528, -0.01894463784992695, -0.020431265234947205, 0.03696835786104202, 0.02190473861992359, -0.008202765136957169, -0.004377658478915691, 0.013017861172556877, -0.02112853340804577, -0.016918614506721497, 0.0028515628073364496, 0.008110673166811466, 0.011077350936830044, 0.04141508415341377, 0.015458298847079277, -0.02104959823191166, -0.0033975366968661547, -0.001253108843229711, -0.005476184654980898, -0.01146545261144638, 0.008531665429472923, 0.015642482787370682, 0.01186671108007431, -0.012642914429306984, -0.00016146933194249868, -0.02176002226769924, -0.00684769731014967, 0.012360060587525368, 0.02278618887066841, -0.009163153357803822, 0.04804570600390434, 0.013629614375531673, -0.022154701873660088, 0.009834108874201775, -0.013353338465094566, 0.012116674333810806, -0.03541594743728638, 0.003463316708803177, 0.014958370476961136, 0.013241512700915337, -0.023943917825818062, -0.007525231223553419, 0.06383290886878967, 0.014853122644126415, 0.022404665127396584, -0.04120458662509918, -0.024154413491487503, -0.0004908831906504929, -0.03996792435646057, -0.007064771372824907, 0.016931770369410515, 0.04236231744289398, -0.02904844470322132, 0.045335572212934494, 0.004236231558024883, 0.03349517285823822, -0.009597301483154297, -0.008821097202599049, 0.012366638518869877, -0.0006931566749699414, -0.009255245327949524, 0.02402285300195217, -0.0268645491451025, -0.02802227810025215, -0.009603879414498806, -0.01147203054279089, -0.028443269431591034, 0.003650789614766836, 0.03402141109108925, -0.026680365204811096, -0.0008543176809325814, -0.012504776939749718, 0.019970806315541267, 0.029811492189764977, -0.0009422983857803047, -0.005252532660961151, 0.017286982387304306, 0.005124261602759361, 0.02089172601699829, -0.006110961548984051, 0.023101933300495148, -0.031705956906080246, -0.017655350267887115, -0.019707685336470604, -0.019681373611092567, 0.015918757766485214, -0.005811662413179874, 0.017273826524615288, -0.0005957200773991644, -0.005321601405739784, -0.010840542614459991, 0.003410692559555173, 0.020589137449860573, 0.0033054447267204523, 0.04412521794438362, 0.04025735706090927, -0.023917606100440025, -0.004380947444587946, -0.0068740095011889935, -0.003927065525203943, 0.0006068204529583454, 0.013280980288982391, -0.01770797371864319, 0.0013994693290442228, -0.03878388553857803, 0.0012136409059166908, -0.01343885250389576, 0.013011282309889793, 0.00531831244006753, -0.022562537342309952, 0.01878676563501358, 0.016142411157488823]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"CODING
resembles this process, despite verifying many draft n-gram
candidates in parallel. In particular, We first look up from
then-gram pool for “promising” n-grams – by checking if
an-gram starts with a token that exactly matches the last
token of the current ongoing sequence. We then use the
LLM to verify all these n-grams in parallel, following a
similar fashion as in speculative decoding. See Algorithm 3
in the Appendix for the detailed procedures.
We next discuss how to support more advanced sampling.
Previous research (Miao et al., 2023) has developed efficient
tree-based verification for speculative decoding with sam-
pling support, where multiple draft sequences derived from
a token tree can be verified in parallel. However, it does
not apply to LOOKAHEAD DECODING as our verification
works on disjoint n-grams instead of trees. We improve
it by progressively verifying along the n-gram length and
removing n-grams with mismatched prefixes. Besides, spec-
ulative decoding style verification requires the probability
distribution where the draft token is sampled to update the
probability distribution when the draft token is rejected. Be-
cause we store all n-grams in a pool instead of discarding
them each step, we would need huge memory to store the
probability distributions (each of vocabulary size) for the
entire n-gram pool. The key to overcome this is to leverage
the mechanism that the verification is indifferent to how
draft tokens were sampled – different sampling methods
(e.g., greedy sampling) only influence the acceptance rate
but keep the output distribution. We can force greedy sam-
pling at the n-gram generation (lookahead branch), in which
the probability distribution degenerates into a one-hot vector.
Hence we only need to store which token is selected. We
elaborate the approach in Algorithm 4, prove its correctness
in Appendix B, and verify its quality and speedups in §5.3.
It is expected to have an increasingly large n-gram cache
hence a growing verification branch as decoding progresses.
We set a cap of Gto limit the maximum number of promis-
ing candidates run in parallel in the verification branch to
manage the verification cost. Empirically we suggest to set
Gproportional to Wto balance generation and verification.
In practice, we simply set G=W.
01234
12345
23456123
123
Input 
token
Lookahead BranchVerification
 Branch0
1
2
3
4
1
2
3
4
5
2
3
4
5
6
1
2
3
1
2
30123456012345012340123012GPU0
GPU1
GPU2
GPU3123
123N-1=3W=5 G=2
Input token (step t)
Speculations
Tokens from t-1 step
Tokens from t-2 step
Tokens from t-3 step
(a) Causal Mask (b) Lookahead Decoding MaskUnwanted Token
  Interaction
Wanted Token
   InteractionFigure 2: (a) Causal mask for decoder models. (b) Attention
mask for LOOKAHEAD DECODING withW= 5,N= 4,
andG= 2. Digits on tokens indicate relative positions.
3.3. Decode, Predict, and Verify in The Same Step
At execution, the lookahead and verification branches can
be integrated into one decoding step to leverage parallel
processing. This requires a designated attention mask, as
shown in Fig. 2 (b). This attention mask is straightforwardly
derived following the principle that each token is only vis-
ible to the tokens with a larger position index than itself
(§2). For example, only the green token at position 5 and
all orange tokens are visible to the red token 6. The tokens
in the lookahead branch are not visible to the tokens in the
verification branch, and vice versa.
Integration with FlashAttention. FlashAttention (Dao
et al., 2022; Dao, 2023) can vastly accelerate the training
and inference of LLMs by saving memory I/O on the slow
memory hierarchy. It forces a causal mask (e.g., Fig. 2 (a))
to avoid all token interactions outside a lower triangular
scope, which is not suitable for LOOKAHEAD DECODING
as we take a more subtle attention mask (e.g., Fig. 2 (b)) for
different W,N, andG. To solve this, we hardcode LOOKA -
HEAD DECODING ’s attention pattern with adjustable W,
N, and Gin FlashAttention. Applying FlashAttention to
LOOKAHEAD DECODING brings about 20","[0.032119739800691605, 0.015951357781887054, 0.018257251009345055, 0.01520533300936222, -0.03740973025560379, 0.01657530479133129, 0.03130589425563812, 0.0027060338761657476, -0.019613659009337425, 0.02638213522732258, 0.08149299025535583, 0.02913564257323742, -0.05349672958254814, 0.010573199950158596, -0.006904116366058588, -0.041316185146570206, 0.0014411834999918938, -0.02132273279130459, 0.023845652118325233, 0.022475680336356163, -0.035293735563755035, 0.014635642059147358, 0.03502245247364044, 0.06722357869148254, -0.0009147276286967099, -0.054690368473529816, 0.005157741252332926, 0.03982413932681084, 0.04381197690963745, -0.05620954558253288, -0.014866231009364128, -0.021146399900317192, -0.023235268890857697, -0.01713143289089203, -0.00494410702958703, 0.03504958003759384, 0.03960711136460304, -0.02357437089085579, -0.02725023590028286, -0.00417095422744751, 0.026002340018749237, -0.021919552236795425, -0.05870533734560013, -0.0033164173364639282, 0.01458138506859541, 0.04020393267273903, 0.019505146890878677, 0.0005133156082592905, -0.03184846043586731, 0.06375117599964142, -0.04427315667271614, 0.0208208616822958, -0.03643311932682991, 0.074114128947258, -0.030573435127735138, 0.014717026613652706, -0.01665668934583664, 0.017253508791327477, 0.037599626928567886, 0.02361506223678589, -0.014188027009367943, -0.0184878408908844, -0.009542330168187618, 0.005574836861342192, -0.0065819695591926575, -0.020061273127794266, -0.025378393009305, 0.008769177831709385, 0.02729092724621296, 0.05729467049241066, 0.0016293850494548678, 0.03130589425563812, 0.029189899563789368, -0.03412722423672676, -0.04470720514655113, 0.011943171732127666, 0.022923294454813004, 0.023357344791293144, 0.05176052823662758, -0.006978719029575586, 0.022258654236793518, 0.0011368393898010254, 0.016019178554415703, -0.04864078760147095, 0.014445744454860687, -0.04481571912765503, 0.011373480781912804, -1.9471872292342596e-05, -0.031061742454767227, -0.04760991781949997, -0.02818615734577179, 0.04340505599975586, -0.04204864799976349, 0.0010003508068621159, -0.013292797841131687, 0.03651450201869011, 0.001914230757392943, -0.03589055314660072, 0.03005800023674965, 0.026531338691711426, 0.02685687690973282, -0.0022024675272405148, 0.038087934255599976, -0.0322011262178421, 0.07693546265363693, 0.006907507311552763, -0.03608044981956482, 0.02484939433634281, -0.06364265829324722, 0.0011181888403370976, -0.06337138265371323, -0.001990528777241707, -0.03925444558262825, 0.005252689588814974, 0.03895603492856026, -0.0035334427375346422, -0.04804397001862526, -0.017334893345832825, 0.02547334134578705, 0.0008918382227420807, -0.01991206966340542, -0.013272452168166637, 0.03092610090970993, -0.02680262178182602, -0.03103461302816868, -0.00555788166821003, 0.04332366958260536, -0.08236108720302582, 0.029868103563785553, -0.01198386400938034, -0.001817586598917842, -0.005211997777223587, 0.04671468958258629, -0.01802666112780571, -0.046823203563690186, -0.0162090752273798, -0.04337792471051216, 0.00472708186134696, -0.025758186355233192, 0.03914593532681465, -0.004594831727445126, -0.026232929900288582, 3.3274383895331994e-05, -0.025079982355237007, -0.051000937819480896, 0.031577177345752716, -0.01983068510890007, 0.02676192857325077, -0.03781665489077568, -0.0020956501830369234, -0.03499532490968704, -0.039851266890764236, -0.021797476336359978, -0.0230996273458004, 0.0035741350147873163, -0.0460364855825901, -0.0460907407104969, 0.006283559836447239, 0.009101497009396553, -0.010423995554447174, -0.032960712909698486, 0.0045304023660719395, 0.025676801800727844, 0.005890201311558485, -0.006114008836448193, 0.033394765108823776, -0.07530777156352997, 0.002366931876167655, -0.05371375381946564, 0.008606408722698689, 0.013740412890911102, -0.010668148286640644, -0.010688494890928268, -0.009345650672912598, 0.010478251613676548, -0.009420253336429596, -0.01945088990032673, -0.04194013401865959, 0.003055308945477009, -0.07205238938331604, -0.03410009667277336, 0.04020393267273903, 0.035239480435848236, 0.0011826182017102838, -0.06510758399963379, -0.009725444950163364, 0.0032553791534155607, 0.0011190365767106414, -0.01805379055440426, 0.033042099326848984, -0.00033592290128581226, 0.06109261512756348, 0.056046776473522186, 0.0023974510841071606, -0.013971001841127872, -0.054744623601436615, 0.05406641960144043, 0.004130262415856123, 0.04058372601866722, -0.038630496710538864, -0.0030773505568504333, -0.00830799899995327, 0.004883068613708019, -0.027128158137202263, 0.03589055314660072, -0.00335202319547534, 0.01549017895013094, -0.013889617286622524, 0.014852667227387428, -0.01105472445487976, 0.017226381227374077, -0.036297477781772614, 0.043594952672719955, 0.013957438059151173, -0.03816932067275047, 0.004872895777225494, -0.03098035790026188, 0.0034300165716558695, 8.594115934101865e-05, 0.03594481199979782, 0.009549112059175968, 0.014852667227387428, 0.04831525310873985, 0.055368572473526, -0.052899908274412155, 0.0689597800374031, 0.029678206890821457, -0.01988494023680687, 0.01664312556385994, -0.002038002945482731, 0.034371376037597656, -0.007460243534296751, 0.006798994727432728, -0.024103369563817978, 0.02216370590031147, -0.025093547999858856, 0.004211646504700184, -0.042319927364587784, 0.016833022236824036, -0.009854303672909737, -0.001802327111363411, 0.011305660009384155, 0.011380262672901154, -0.03955285623669624, -0.04112628847360611, 0.0162226390093565, -0.043649207800626755, -0.033421892672777176, 0.03464265912771225, 0.032526664435863495, -0.015029000118374825, -0.04061085358262062, -0.04788120090961456, -0.01844714768230915, -0.05178765580058098, -0.003584308084100485, 0.008240178227424622, 0.024103369563817978, -0.032608047127723694, 0.013882835395634174, 0.0046355240046978, -0.009847521781921387, -0.023899907246232033, 0.04533115401864052, -0.0009554198477417231, -0.005476497113704681, 0.008355473168194294, 0.018772685900330544, -0.013530169613659382, -0.005144177004694939, -0.026463519781827927, -0.022869037464261055, 0.010261226445436478, 0.01748409867286682, -0.016765201464295387, -0.039444342255592346, 0.041723109781742096, -0.001291130785830319, -0.03092610090970993, 0.025703931227326393, -0.021919552236795425, -0.0006926158093847334, 0.07476520538330078, 0.018202994018793106, 0.005215388722717762, 0.010091675445437431, -0.020590271800756454, -0.04259121045470238, -0.0460907407104969, 0.003987839445471764, -0.0012962173204869032, -0.045982230454683304, 0.027942003682255745, -0.01566651277244091, 0.02630075067281723, 0.010213752277195454, 0.03003087267279625, 0.01573433168232441, 0.01797240599989891, -0.015164640732109547, 0.03654162958264351, 0.014011694118380547, 0.008063845336437225, 0.004103133920580149, -0.039932649582624435, 0.018555661663413048, -0.007433115504682064, 0.022326475009322166, -0.01941019855439663, -0.006107226945459843, 0.00451683858409524, 0.016005612909793854, -0.011665108613669872, -0.007541628088802099, -0.015842845663428307, -0.029352668672800064, 0.07774930447340012, -0.028403183445334435, 0.0207937341183424, -0.040936391800642014, -0.015883537009358406, -0.009711881168186665, -6.591295095859095e-05, -0.005883419420570135, 0.026178672909736633, -0.0008490266045555472, -0.011034378781914711, -0.008877689950168133, 0.034452762454748154, -0.026422826573252678, 0.020183350890874863, 0.014120207168161869, 0.01987137645483017, -0.016521049663424492, -0.04885781556367874, -0.049644529819488525, -0.041668850928545, -0.01657530479133129, 0.030139384791254997, 0.04345931112766266, -0.07525351643562317, -0.0007456004968844354, 0.059790462255477905, -0.018826942890882492, -0.07731525599956512, 0.015598691068589687, -0.023696446791291237, -0.0005010231980122626, 0.07064172625541687, 0.012295838445425034, -0.01612769067287445, -0.028403183445334435, 0.042211417108774185, -0.027141723781824112, 0.0322011262178421, 0.01132600661367178, 0.0004514295142143965, -0.03372030332684517, 0.004014967475086451, 0.013706502504646778, -0.015029000118374825, 0.009752573445439339, 0.025486905127763748, 0.019111787900328636, -0.01435079611837864, -0.004883068613708019, -0.03955285623669624, -0.03494106978178024, 0.018365763127803802, -0.005893592722713947, 0.030220769345760345, 0.0368400402367115, 0.0035944811534136534, 0.007697615306824446, -0.04291674867272377, 0.005459541920572519, -0.009189663454890251, 0.024266138672828674, 0.005052619613707066, 0.027914876118302345, -0.0017395932227373123, -0.010369738563895226, -0.0017751989653334022, -0.006005496252328157, 0.008579280227422714, 0.04109916090965271, -0.02221796289086342, -0.02301824279129505, -0.05314406380057335, -0.05214032158255577, -0.05919364467263222, -0.020658092573285103, -0.004004794638603926, 0.021485501900315285, -0.0028857579454779625, 0.02719597890973091, -0.010457905009388924, 0.03930870071053505, 0.015951357781887054, 0.02681618556380272, 0.0276435948908329, -0.03781665489077568, -0.019301684573292732, -0.04676894471049309, 0.011224275454878807, 0.023398037999868393, 0.003379151225090027, 0.01714499667286873, 0.05778297781944275, 0.02395416423678398, 0.011868569999933243, 0.00026598310796543956, 0.054256316274404526, -0.03287933021783829, 0.03130589425563812, -0.005449369084089994, -0.009054022841155529, -0.0029671424999833107, 0.037626758217811584, 0.0689597800374031, 0.011278532445430756, -0.002378800418227911, -0.06890552490949631, -0.052845653146505356, -0.046416278928518295, -0.04069223999977112, 0.009176099672913551, -0.013516604900360107, 0.05306267738342285, -0.06228625401854515, -0.05433770269155502, 0.020061273127794266, 0.07427690178155899, -0.018637044355273247, -0.041858747601509094, 0.0033096354454755783, 0.004106524866074324, 0.029379796236753464, 0.002831501653417945, -0.054256316274404526, -0.039878394454717636, 0.001966791460290551, -0.01745697110891342, -0.012153415009379387, -0.010946212336421013, 0.04280823469161987, -0.06993639469146729, -0.04188587889075279, 0.023235268890857697, -0.021078579127788544, 0.04118054360151291, 0.020169787108898163, 0.026002340018749237, -0.00010305521573172882, 0.007236436475068331, -0.029813846573233604, 0.09125912934541702, -0.00437441561371088, 0.025703931227326393, -0.03279794380068779, -0.00026683087344281375, -0.02586670033633709, -0.035782042890787125, 0.004903414752334356, -0.011461647227406502, 0.009420253336429596, 0.01105472445487976, 0.01745697110891342, 0.05051263049244881, 0.026015903800725937, 0.027996260672807693, -0.02174321934580803, -0.004469364415854216, 0.012390786781907082, 0.012770581059157848, 0.024320393800735474, 0.025622546672821045, -0.050051454454660416, 0.004805075004696846, 0.003540224861353636, -0.03309635445475578, 0.013075772672891617, 0.03792516514658928, 0.010288354009389877, 0.018759122118353844, 0.05582975223660469, 0.005300164222717285, 0.007846820168197155, -0.004723690915852785, -0.04421889781951904, -0.006327643059194088, -0.03003087267279625, 0.03271656110882759, -0.015557998791337013, -0.021526195108890533, -0.01062067411839962, 0.020766606554389, 0.012770581059157848, 0.02578531578183174, 0.025242751464247704, 0.030302153900265694, 0.014296540059149265, -0.009542330168187618, 0.030736204236745834, 0.026639852672815323, -0.03518522158265114, -0.019600095227360725, 0.015029000118374825, -0.012445042841136456, 0.020237606018781662, -0.003007834544405341, 0.013774322345852852, -0.012777362950146198, 0.0007286454201675951, -0.023357344791293144, -0.004554139915853739, -0.005276427138596773, -0.005964803975075483, -0.019708607345819473, 0.010139149613678455, 0.008043498732149601, -0.00531711895018816, 0.003896281821653247, 0.018297942355275154, 0.032146867364645004, -0.017239945009350777, -0.05032273381948471, -0.1290215253829956, -0.014377924613654613, 0.002138037933036685, 0.0126891965046525, -0.017755379900336266, -0.012987606227397919, -0.017904585227370262, -0.04256408289074898, -0.0033655872102826834, -0.019966324791312218, -0.008633536286652088, -0.03377455845475197, -0.02121422067284584, 0.019681479781866074, 0.0009622019133530557, 0.006039406638592482, -0.043215155601501465, -0.015069692395627499, -0.019491583108901978, 0.01981711946427822, -0.003084132680669427, -0.012953695841133595, 0.014188027009367943, -0.007324602920562029, -0.031224511563777924, 0.017280638217926025, -0.02856595069169998, -0.04283536225557327, 0.025012163445353508, -0.016276895999908447, 6.898606079630554e-05, -0.017809636890888214, -0.034859683364629745, 0.018786249682307243, -0.0060936626978218555, -0.0019837466534227133, -0.022434987127780914, -0.007073667366057634, 0.027535080909729004, 0.019640786573290825, -0.01196351833641529, 0.04196726158261299, 0.013347053900361061, -0.01760617457330227, -0.05176052823662758, 0.010478251613676548, -0.03545650467276573, 0.004540575668215752, -0.012804491445422173, 0.016507484018802643, 0.0024177972227334976, -0.007433115504682064, 0.009759355336427689, -0.027860619127750397, -0.050621144473552704, 0.0045744855888187885, -0.02818615734577179, -0.02217726968228817, 0.017009355127811432, 0.006785430945456028, 0.036243218928575516, -0.006164873950183392, -0.029189899563789368, 0.038494858890771866, 0.005896983668208122, -0.019667915999889374, 0.014744154177606106, -0.026694107800722122, -0.0021651661954820156, -0.017809636890888214, -0.019193172454833984, -0.016059869900345802, -0.01084448117762804, 0.009054022841155529, 0.026097288355231285, 0.0004230297345202416, 0.003416452556848526, 0.0092710480093956, -0.004364242777228355, -0.03201122581958771, 0.00283489259891212, 0.07096726447343826, -0.004974626004695892, -0.01801309734582901, 0.03656875714659691, -0.011631198227405548, 0.00781969167292118, -0.043133772909641266, 0.01615481823682785, -0.02725023590028286, 0.0027704632375389338, 0.04001403599977493, -0.006263213697820902, 0.036704398691654205, -0.0055375355295836926, 0.039986904710531235, -0.00566300330683589, 0.038630496710538864, 0.0007044843514449894, -0.01662956178188324, 0.006459892727434635, -0.01653461344540119, -0.01550374273210764, -0.04194013401865959, -0.03184846043586731, 0.004971235059201717, 0.01435079611837864, 0.011210711672902107, -0.01563938334584236, 0.01458138506859541, -0.009542330168187618, 0.02219083346426487, -0.01574789546430111, -0.023899907246232033, 0.017212817445397377, -0.01247217133641243, -0.021607577800750732, 0.03133302554488182, -0.016276895999908447, 0.010491815395653248, 0.0018938846187666059, -0.023777831345796585, -0.03293358534574509, -0.007399205584079027, -0.04579233378171921, 0.0646192729473114, -0.0012775667710229754, 0.027467260137200356, -0.02867446467280388, -0.014893359504640102, -0.01706361211836338, 0.02730449289083481, 0.010017072781920433, -0.019681479781866074, -0.017321329563856125, -0.05349672958254814, -0.01197708211839199, -0.0162497665733099, 0.007772217504680157, 0.01890832744538784, 0.016466792672872543, 0.005123830866068602, -0.01653461344540119, -0.043160900473594666, 0.03434424847364426, 0.02900000289082527, -0.017307765781879425, -0.042672593146562576, -0.009983162395656109, -0.026572031900286674, -0.035836298018693924, -0.004354069475084543, 0.013733630068600178, -0.020536016672849655, 0.015842845663428307, -0.0322282537817955, -0.032038357108831406, -0.006253040861338377, 0.012960477732121944, 0.05032273381948471, -0.006107226945459843, 0.013509823009371758, -0.002383887069299817, -0.008674228563904762, -0.0162362027913332, 0.025012163445353508, -0.020630965009331703, 0.030736204236745834, 0.0021159963216632605, -0.002712815999984741, 0.006941417697817087, -0.00947450939565897, -0.04655192047357559, -0.019572967663407326, 0.024835828691720963, 5.054739085608162e-05, -0.025378393009305, 0.015897100791335106, -0.06320860981941223, -0.007467025890946388, 0.04023106023669243, 0.03450701758265495, -0.03504958003759384, -0.025649674236774445, 0.007216090336441994, -0.008830215781927109, 0.007541628088802099, -0.029434053227305412, 0.011170019395649433, -0.025025727227330208, -0.03754537180066109, -0.0026890786830335855, -0.012085595168173313, -0.06537885963916779, 0.010078110732138157, -0.0017183993477374315, 0.00351648754440248, -0.008572498336434364, -0.011705800890922546, 0.026151545345783234, 0.020169787108898163, -0.020522452890872955, 0.03637886047363281, -0.004852549638599157, 0.004706735722720623, 0.005924111697822809, -0.03510383889079094, -0.020251169800758362, 0.029352668672800064, -0.05032273381948471, -0.009311740286648273, 0.005066183861345053, -0.010423995554447174, 0.022923294454813004, -0.03456127643585205, -0.007778999395668507, 0.036270350217819214, -0.006565014366060495, -0.010105239227414131, 0.0055137984454631805, 0.005825771950185299, -0.02406267635524273, -0.0036453462671488523, -0.02545977756381035, 0.012655286118388176, -0.039037421345710754, -0.027942003682255745, 0.006734565366059542, 0.0028806712944060564, -0.0011707496596500278, 0.0054697152227163315, -0.005374766420572996, -0.019762864336371422, 0.03412722423672676, -0.004537184722721577, -0.0050797476433217525, -0.0004257849359419197, 0.00473386375233531, 0.008891253732144833, -0.03936295956373215, 0.009216791950166225, 0.044598694890737534, 0.03800655156373978, 0.023818524554371834, 0.000740937830414623, 0.05395790934562683, 0.02069878578186035, 0.04904771223664284, -0.035836298018693924, 0.007955332286655903, 0.00254665594547987, -0.005818990059196949, 0.0185420960187912, -0.03407296910881996, -0.030112257227301598, -0.019667915999889374, 0.0012640026398003101, -0.021417681127786636, 0.004272684920579195, -0.01500187162309885, 0.017809636890888214, 0.008870908059179783, -0.019572967663407326, -0.0076704868115484715, -0.0065819695591926575, 0.004577876999974251, 0.024293266236782074, 0.0017565482994541526, 0.026992518454790115, -0.011665108613669872, -0.11892984807491302, -0.003151952987536788, 0.023181011900305748, -0.00944738183170557, -0.039091676473617554, 0.007080449722707272, 0.011400609277188778, 0.00739242322742939, -0.00830121710896492, -0.00019625527784228325, -0.013387746177613735, -0.017918149009346962, -0.020210478454828262, -0.054229188710451126, 0.007351730950176716, -0.05686062201857567, -0.0023737139999866486, -0.017741816118359566, 0.020196914672851562, -0.0127027602866292, -0.012024556286633015, -0.019966324791312218, -0.00034651983878575265, -0.006829514168202877, 0.012634940445423126, -0.023764267563819885, -0.011434518732130527, -0.013903181068599224, 0.0008329192642122507, 0.033394765108823776, 0.0010707145556807518, -0.01657530479133129, 0.011732928454875946, 0.009535548277199268, -9.977016452467069e-05, -0.015856409445405006, -0.027630029246211052, -0.01614125445485115, 0.024347523227334023, -0.00990177784115076, 0.010132367722690105, -0.03182132914662361, 0.01665668934583664, -0.023750703781843185, -0.016914406791329384, -0.011034378781914711, -0.012573901563882828, -0.012994388118386269, -0.0045236204750835896, 0.00872848555445671, -0.014513565227389336, 0.00426251208409667, 0.0208072979003191, -0.018311507999897003, 0.011793967336416245, 0.024293266236782074, -0.03825070336461067, 0.0027942003216594458, -0.03146866336464882, 0.027535080909729004, -0.00014146910689305514, 0.038603369146585464, 0.035782042890787125, 0.0032858983613550663, 0.006320861168205738, -0.01981711946427822, 0.005941066890954971, 0.03369317203760147, -0.022475680336356163, -0.039037421345710754, -0.007806127890944481, -0.016385408118367195, 0.017199253663420677, 0.021417681127786636, -0.011861787177622318, 0.007846820168197155, 0.0002604727051220834, 0.00702619319781661, -0.05756595358252525, 0.006771866697818041, 0.03787091001868248, -0.04115341603755951, -0.019708607345819473, 0.007860383950173855, -0.002550046890974045, 0.0022804609034210443, 0.025690367445349693, -0.01946445368230343, -0.04706735536456108, -0.003625000361353159, 0.014160899445414543, -0.004296422004699707, -0.020888682454824448, 0.014486436732113361, 0.00225841929204762, -0.03542937710881233, -0.014228719286620617, 0.004493101499974728, 0.04213003069162369, 0.006751520559191704, 0.03423573821783066, 0.024564547464251518, -0.031088870018720627, -0.07216089963912964, 0.008009589277207851, -0.010763097554445267, 0.018325071781873703, -0.013035080395638943, 0.0005607898929156363, -0.0036216091830283403, -0.011251403950154781, 0.0057749068364501, -0.037219833582639694, 0.02579887956380844, -0.018609916791319847, 0.028023388236761093, 0.007433115504682064, 0.029895231127738953, 0.052872780710458755, -0.02956969290971756, -0.0003482153406366706, 0.035809170454740524, -0.015951357781887054, -0.015151076950132847, -0.027033209800720215, -0.02364218980073929, 0.00645650178194046, 0.008823433890938759, 0.010444341227412224, -0.022529935464262962, -0.00682273181155324, -0.004065833054482937, -0.007975678890943527, -0.013306361623108387, 0.007358513306826353, -0.0015776719665154815, -0.013971001841127872, 0.020074836909770966, -0.03087184578180313, 0.014093078672885895, 0.003716557752341032, -0.0015564780915156007, 0.022923294454813004, 0.029840974137187004, 0.017185688018798828, 0.014825538732111454, -0.016398971900343895, 0.005934284999966621, -0.010905520059168339, -0.0003369826008565724, 0.0008100298582576215, -0.0208072979003191, -0.012994388118386269, -0.033476147800683975, 0.008233396336436272, 0.024686625227332115, -0.01456782128661871, -0.04096351936459541, -0.00854536984115839, 0.034371376037597656, 0.05691487714648247, -0.0006777800736017525, -0.023886343464255333, 0.020101966336369514, -0.016059869900345802, 0.005374766420572996, -0.03646024689078331, 0.007317821029573679, -0.02360149845480919, -0.00578168872743845, -0.019640786573290825, -0.028837233781814575, 0.05119083449244499, 0.018365763127803802, 0.04798971489071846, 0.024130497127771378, -0.01084448117762804, 0.012763799168169498, 0.01343522034585476, 0.01795884035527706, -0.012831619009375572, 0.03882039710879326, 0.008497895672917366, 0.006978719029575586, 0.020454632118344307, -0.0075687565840780735, 0.009345650672912598, 0.009576240554451942, -0.006334424950182438, 0.04286248981952667, 0.012940132059156895, 0.037246961146593094, -0.0254190843552351, 0.009616932831704617, -0.00760266650468111, -0.007724743336439133, 0.01292656734585762, 0.02402198500931263, 0.01890832744538784, 0.002787418430671096, -0.0322553813457489, 0.013197849504649639, -0.023275960236787796, -0.01978999190032482, -0.01104794256389141, 0.0002960784186143428, -0.0013869270915165544, 0.019016839563846588, -0.016317587345838547, 0.021512629464268684, -0.02171609178185463, 0.004004794638603926, -0.033964455127716064, 0.03564640134572983, -0.03746398910880089, -0.01572076790034771, 0.039498601108789444, -0.0032875938341021538, -0.00760266650468111, 0.0019650959875434637, -0.025052854791283607, -0.012309402227401733, -0.03190271556377411, -0.03279794380068779, -0.011922826059162617, 0.029813846573233604, 0.0066023156978189945, -0.009196446277201176, -0.039010293781757355, -0.0028162419330328703, 0.014608513563871384, 0.0006298819207586348, -0.0024567937944084406, -0.0070872316136956215, -0.023181011900305748, -0.014486436732113361, -0.02585313469171524, 0.0029535782523453236, -0.010661366395652294, 0.012940132059156895, 0.013815014623105526, -0.008179140277206898, -0.0416145958006382, 0.02727736346423626, 0.038521986454725266, -0.024754445999860764, -0.003424930153414607, 0.03309635445475578, -0.004642306361347437, -0.0010546072153374553, -0.004591440781950951, 0.012560337781906128, 0.0601160004734993, -0.026463519781827927, 0.010735969059169292, 0.015585127286612988, 0.046796075999736786, 0.019939197227358818, 0.02455098368227482, 0.03827783092856407, -0.015585127286612988, 0.021417681127786636, -0.00021066711633466184, -0.028891488909721375, -0.022068757563829422, -0.028050515800714493, -0.04020393267273903, 0.020630965009331703, 0.016724510118365288, -0.0014335536397993565, 0.00483898539096117, 0.016086997464299202, 0.00030413208878599107, 0.03136015310883522, -0.0014284671051427722, -0.02118709310889244, -0.0035809169057756662, -0.009135407395660877, -0.00437441561371088, -0.004316768143326044, 0.00509331189095974, -0.04481571912765503, -0.01614125445485115, -0.013347053900361061, -0.02361506223678589, -0.01756548322737217, -0.04071936756372452, 0.0009020112920552492, 0.029732462018728256, -0.004238774999976158, 0.021037887781858444, 0.010641020722687244, 0.012160196900367737, 0.016480356454849243, -0.0024296657647937536, -0.016955099999904633, 0.005961413029581308, -0.009013330563902855, 0.014079514890909195, -0.015096820890903473, 0.028918618336319923, 0.04530402645468712, 0.023723574355244637, -0.04931899160146713, 0.042347054928541183, 0.018772685900330544, 0.035239480435848236, -0.04522264003753662, -0.016412535682320595, -0.004781337920576334, -0.005273035727441311, 0.02807764522731304, 0.024645932018756866, 0.017633303999900818, 0.03871188312768936, 0.01268241461366415, 0.01133957039564848, -0.024591676890850067, 0.029325539246201515, -0.040475212037563324, -0.011665108613669872, 0.0001091484518838115, -0.00832834467291832, 0.022367166355252266, -0.0005925807054154575, -0.029434053227305412, 0.006880379281938076, -0.012092377059161663, -0.002431361237540841, 0.012343312613666058, 0.024686625227332115, 0.004642306361347437, 0.03751824423670769, -0.021390553563833237, -0.005425631999969482, -0.0028450656682252884, -0.020942939445376396, -0.0007888359832577407, -0.000330836366629228, -0.004533793777227402, 0.03591768071055412, 0.02400842122733593, 0.009549112059175968, 0.03559214621782303, -0.010891956277191639, 0.02681618556380272, -0.002751812571659684, -0.007216090336441994, 0.006659963168203831, -0.014377924613654613, 0.07796633243560791, -0.008626754395663738, -0.028945745900273323, 0.016887279227375984, -0.004581267945468426, -0.02870159223675728, -0.012648504227399826, -0.020169787108898163, -0.04527689889073372, -0.013482695445418358, 0.0008121492573991418, 0.0054900613613426685, 0.0017599393613636494, 0.0025890436954796314, 0.012614593841135502, -0.02209588512778282, -0.018202994018793106, 0.01403882261365652, 0.03754537180066109, 0.024157626554369926, 0.027942003682255745, 0.02223152667284012, 0.0033011578489094973, -0.009230355732142925, -0.03447989001870155, 0.0008049433236010373, 0.005171305499970913, 0.02217726968228817, 0.03591768071055412, 0.008850561454892159, 0.00044210421037860215, 0.007270346395671368, -0.03464265912771225, 0.011888915672898293, -0.0162362027913332, 0.001193639007396996, 0.003102783113718033, 0.0462535098195076, -0.027087466791272163, -0.008565716445446014, 0.01060032844543457, -0.0030417449306696653, 0.017768943682312965, -0.0017234858823940158, -0.012411132454872131, 0.022000936791300774, 0.012872311286628246, 0.0024262748192995787, -0.006480238866060972, 0.014500001445412636, 0.03192984312772751, -0.001531893271021545, 0.017321329563856125, -0.0039200191386044025, 0.010423995554447174, -0.05254724249243736, -0.0017972405767068267, 0.029705334454774857, 0.044978488236665726, -0.005856291390955448, -0.015340973623096943, 0.007921422831714153, -0.029461180791258812, -0.033421892672777176, -0.018637044355273247, -0.02775210700929165, 0.010362956672906876, 0.025731058791279793, -0.015096820890903473, 0.0185149684548378, -0.014649205841124058, -0.006643007975071669, -0.010118803009390831, -0.012858747504651546, 0.003879326628521085, 0.012736670672893524, -0.02037324756383896, 0.020101966336369514, 0.02031899057328701, 0.05767446756362915, 0.0034571448341012, 0.006422591861337423, 0.006453110836446285, 0.009013330563902855, -0.006839687004685402, 0.02072591334581375, 0.02177034690976143, 0.0027823317795991898, 0.013815014623105526, 0.017768943682312965, -0.022014500573277473, 0.008002806454896927, 0.018718428909778595, 0.039471469819545746, 0.021485501900315285, -0.009182881563901901, -0.018216559663414955, -0.033530402928590775, 0.016290459781885147, -0.00017018681683111936, -0.002170252613723278, -0.007955332286655903, -0.006331034004688263, 0.014160899445414543, -0.011956736445426941, 0.00014093925710767508, -0.03917306289076805, -0.01291300356388092, 0.01497474405914545, -0.005330683197826147, -0.006944808643311262, -0.01668381690979004, 0.007399205584079027, 0.011787185445427895, -0.02352011390030384, 0.03730121999979019, 0.022529935464262962, 0.005442586727440357, 0.014323667623102665, -0.040936391800642014, 0.03553788736462593, -0.00031557679176330566, 0.010078110732138157, 0.009121843613684177, -0.014730590395629406, -0.023791395127773285, -0.010586763732135296, 0.020970067009329796, -0.0054900613613426685, -0.030247896909713745, 0.007853602059185505, -0.015368102118372917, -0.012445042841136456, -0.0017768944380804896, -0.026056597009301186, 0.04386623203754425, 0.013380964286625385, -0.027887746691703796, -0.010206969454884529, -0.011088634841144085, 0.03266230225563049, 0.006324252113699913, -0.001890493556857109, 0.006130964029580355, -0.0005442586843855679, 0.024673061445355415, 0.00738564133644104, 0.004293031059205532, 0.039091676473617554, 0.028294669464230537, 0.0032231644727289677, 0.0054934523068368435, 0.003201122861355543, -0.01709073968231678, -0.012763799168169498, -0.019586531445384026, 0.0035470067523419857, -0.018650609999895096, 0.014106642454862595, -0.0021651661954820156, 0.007460243534296751, -0.027399441227316856, -0.022814782336354256, 0.04326941445469856, 0.040827877819538116, 0.021051451563835144, -0.023818524554371834, -0.0011453169863671064, 0.056046776473522186, 0.0035029235295951366, 0.017796073108911514, -0.009433817118406296, 0.00623947661370039, 0.00853858795017004, -0.0413704439997673, -0.026626288890838623, -0.021485501900315285, 0.0024822265841066837, -0.01840645633637905, 0.02678905613720417, 0.005286599975079298, -0.011373480781912804, 0.03374743089079857, -0.008857344277203083, -0.0060224514454603195, -0.007677269168198109, -0.006826123222708702, 0.002319457707926631, -0.002338108140975237, 0.020156221464276314, 0.0368400402367115, 0.001802327111363411, -0.0138557069003582, -0.0016039523761719465, 0.017185688018798828, 0.01527315378189087, -0.008769177831709385, 0.0038115063216537237, 0.011441300623118877, 0.021566886454820633, -0.00020568654872477055, -0.008667446672916412, -0.005405285861343145, -0.013753976672887802, 0.019613659009337425, 0.019233865663409233, -0.032119739800691605, -0.022787652909755707, 0.014147334732115269, 0.0049169789999723434, -0.00041455216705799103, -0.006493803113698959, 0.022421423345804214, 0.011895697563886642, 0.034018710255622864, -0.011929607950150967, 0.008172357454895973, -0.01610056310892105, -0.020983630791306496, -0.028457438573241234, 0.00484576728194952, 0.002078695222735405, 0.03282507136464119, 0.0029535782523453236, -0.05599252134561539, 0.028728719800710678, -0.010220534168183804, -0.0013564079999923706, -0.01572076790034771, 0.016968663781881332, -0.008043498732149601, -0.019572967663407326, 0.01133278850466013, -0.013238541781902313, 0.010858045890927315, 0.004737254697829485, -0.010661366395652294, -0.018596353009343147, 0.0027094248216599226, -0.0044083259999752045, -0.030736204236745834, 0.0038216793909668922, 0.023398037999868393, 0.006934635806828737, -0.016426099464297295, 0.04025818780064583, -0.005771515890955925, 0.014920487068593502, -0.03496819734573364, 0.020929373800754547, -0.007012628950178623, 0.039471469819545746, -0.01795884035527706, -0.05626380071043968, 0.0103968670591712, -0.030709076672792435, -0.013062208890914917, -0.004296422004699707, 0.015910664573311806, 0.014852667227387428, -0.0022957203909754753, -0.006476847920566797, -0.0023160665296018124, 0.003584308084100485, -0.014147334732115269, 0.003733512945473194, -0.008504677563905716, 0.028240414336323738, -0.004889850504696369, -0.0001598018134245649, -0.011312441900372505, -0.008287652395665646, -0.00897942017763853, -0.003335068002343178, 0.023438729345798492, 0.036731526255607605, -0.01225514616817236, -0.017755379900336266, -0.007141487672924995, -0.0016175165073946118, 0.03911880403757095, 0.0022397686261683702, -0.013143593445420265, 0.0038420255295932293, 0.015178205445408821, 0.0049610622227191925, -0.01889476366341114, 0.002578870626166463, 0.01318428572267294, -0.014472872950136662, 0.021594014018774033, 0.01707717590034008, -0.011366698890924454, -0.014418616890907288, 0.006242867559194565, -0.0036182182375341654, 0.0017031397437676787, -0.012946913950145245, -0.016358280554413795, 0.018555661663413048, -0.021553322672843933, -0.00851824227720499, -0.0028857579454779625, 0.008185922168195248, 0.015029000118374825, 0.006130964029580355, 0.013604771345853806, 0.04560243710875511, 0.018691301345825195, -0.02130916900932789, -0.0021939899306744337, -0.008789523504674435, 0.0022804609034210443, -0.017443405464291573, 0.010688494890928268, 0.004835594445466995, -0.010518943890929222, -0.022285781800746918, -0.005381548777222633, 0.04798971489071846, -0.0005196738056838512, 0.03553788736462593, -0.02954256534576416, -0.003733512945473194, 0.04335079714655876, -0.037192706018686295, -0.011787185445427895, -0.0031858631409704685, 0.0555584691464901, -0.01570720411837101, 0.01576146110892296, -0.0007053321460261941, 0.04788120090961456, -0.0049847993068397045, 0.008185922168195248, 0.015585127286612988, 0.008945510722696781, -0.004594831727445126, 0.04025818780064583, -0.034371376037597656, -0.03450701758265495, -0.00022825802443549037, -0.0462535098195076, -0.0277114138007164, 0.009576240554451942, 0.032119739800691605, -0.03418147936463356, -0.0019617050420492887, -0.03819644823670387, 0.002282156376168132, 0.038060806691646576, 0.009210010059177876, 0.015408794395625591, 0.004947497975081205, -0.02592095546424389, 0.010702058672904968, 0.01111576333642006, 0.008823433890938759, -0.017673995345830917, -0.030790461227297783, -0.004343896638602018, -0.011278532445430756, 0.022991115227341652, 0.025079982355237007, 0.010478251613676548, 0.0057749068364501, -0.011061507277190685, -0.013014734722673893, 0.019071096554398537, 0.03797942399978638, -0.004510056227445602, 0.04969878867268562, 0.0022719833068549633, -0.004140435252338648, 0.013021516613662243, -0.008599626831710339, -0.012207671999931335, -0.008640319108963013, -0.005215388722717762, 0.002119387499988079, -0.0028688027523458004, -0.041804492473602295, 0.007460243534296751, -0.005852900445461273, 0.008213049732148647, -0.004994972143322229, -0.0045744855888187885, -0.0045473575592041016, -0.01798596978187561]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"% end-to-end
speedup compared to a straightforward implementation on
top of native PyTorch in our experiments (§5.2).
3.4. Lookahead Parallelism
LOOKAHEAD DECODING is easy to parallelize on multiple
GPUs for both lookahead and verification branches. Par-
allelizing the lookahead branch is achieved by noting that
the lookahead computation is composed of several disjoint
branches. For example, the branch with green 1 and red 2
tokens does not have interaction with the branch with the
tokens green 3 and red 4 in Fig. 2 (b). We can put these
4
Lookahead decoding
disjoint branches onto different GPUs without introducing
communication during the inference computation. Paral-
lelizing the verification branch is done by assigning multiple
n-gram candidates to different devices. Because the verifica-
tion of each candidate, by design, is independent of others,
this will not cause communication.
Fig. 3 shows an example of parallelizing the lookahead
branch and verification branch in Fig. 2 (b) to four GPUs.
This workload allocation will have the orange token 0,1,2,3
and the input token 0 be redundantly placed and computed.
However, it can essentially save communication volume
during the whole forward pass. We only need to synchronize
the generated tokens on each device after the forward pass.
We can further scale the W,N, andGwith multiple GPUs’
increased FLOPs to obtain a lower latency according to
LOOKAHEAD DECODING ’s scalability (§4).
01234
12345
23456123
123 Input 
token
Lookahead BranchVerification
 Branch0
1
2
3
4
1
2
3
4
5
2
3
4
5
6
1
2
3
1
2
30123456012345012340123012GPU0
GPU1
GPU2
GPU3123
123
Figure 3: Distribute the
workload of the looka-
head branch and verifica-
tion branch in Fig 2 (b) to 4
GPUs with lookahead par-
allelism, which can avoid
communication during the
forward pass.We name this new paral-
lelism as lookahead paral-
lelism (LP). Unlike previous
parallelism methods (includ-
ing pipeline and tensor paral-
lelisms) that shard the model
parameters or states across
different GPUs, LP main-
tains an entire copy of the
model for each GPU (thus
needing more memory) and
allows distributing tokens to
different GPUs. Hence, LP
is advantageous in inference
as it introduces near-zero communication per step while
existing model parallelism methods (Narayanan et al., 2021;
Shoeybi et al., 2019) involve a large communication over-
head on the critical path of each decoding step.
4. Scaling Law of L OOKAHEAD DECODING
Since LOOKAHEAD DECODING introduces flexible param-
eters WandNassociated with the cost of each parallel
decoding step. This section investigates the scaling law
between compute FLOPs and the theoretical speedup, and
compares it to speculative decoding.
4.1. Estimating Speedup for Speculative Decoding
Speculative decoding uses the draft model to speculate one
token sequence at each step. We represent the probability
of each token in the sequence passing the verification of
the LLM by β(acceptance rate) and notate its expectation
E(β) =α. If we use the draft model to guess γtokens per
step, the expectation of the number of accepted tokens isdenoted as (Leviathan et al., 2023):
E(#tokens ) =1−αγ+1
1−α. (4)
Instead of speculating one sequence every time, we would
speculate bsequences. We assume that bsequences, each
ofγtokens, are sampled as each token will have the same
acceptance rate of β. Under this setting, the expectation of
the number of accepted tokens is denoted as follows:
E(#tokens ) = (γ+ 1)−γX
i=1(1−αi)b. (5)
See derivations in Appendix C for Eq. 4 and Eq. 5. Note
that when b= 1, Eq. 5 falls back to Eq. 4.
4.2. Estimating Speedup for L OOKAHEAD DECODING
We define the S=step compression ratio as the number
of autoregressive steps divided by the number of LOOKA -
HEAD DECODING steps to generate the same length of the
sequence. As","[0.05353550240397453, -0.010008120909333229, -0.009213825687766075, 0.01069650985300541, -0.02875348925590515, 0.008863011375069618, -0.005791736766695976, 0.004408339038491249, 0.005450851749628782, 0.0031540142372250557, 0.04305080696940422, 0.023352282121777534, -0.07985315471887589, -0.001288247643969953, -0.010206694714725018, -0.05475342273712158, 0.005474018398672342, -0.04829315468668938, 0.013886929489672184, 0.01069650985300541, -0.01973823830485344, -0.03243372589349747, 0.038285031914711, 0.037464261054992676, -0.0023117302916944027, -0.05319130793213844, 0.020916443318128586, 0.011318707838654518, 0.04027077183127403, -0.06862711161375046, 0.0008344237576238811, -0.01842765137553215, -0.02077082172036171, -0.04320966452360153, -0.023127231746912003, 0.018732130527496338, 0.009319731965661049, -0.019844144582748413, -0.016666963696479797, 0.0033443141728639603, 0.023206660524010658, -0.032142482697963715, -0.10421154648065567, 0.004487768281251192, 0.01961909420788288, 0.03359869122505188, 0.029680168256163597, -0.028885873034596443, -0.01883803680539131, 0.050252415239810944, -0.0306862760335207, 0.05369436368346214, -0.04686342179775238, 0.034869562834501266, -0.014945990405976772, 0.01456208061426878, -0.008101812563836575, 0.012457198463380337, 0.03132171183824539, 0.0006441238219849765, 0.028832919895648956, -0.029918456450104713, 0.02721785195171833, -0.00445136334747076, -0.022571224719285965, -0.023577332496643066, -0.02177692949771881, 0.03362516686320305, 0.0029355830047279596, 0.04069439694285393, -0.024768775328993797, 0.03854979947209358, 0.02859463170170784, -0.0157005712389946, -0.028462247923016548, 0.019857382401823997, 0.007022894453257322, 0.0741342306137085, 0.06375543773174286, -0.02893882617354393, 0.026767751201987267, 0.006791224703192711, 0.029044732451438904, -0.03216895833611488, 0.02671479806303978, -0.03201010078191757, 0.009498448111116886, 0.0006408143090084195, -0.016825823113322258, -0.029865503311157227, -0.006417244207113981, 0.031083423644304276, -0.0387880876660347, 0.007453137543052435, 0.01592562161386013, 0.04305080696940422, 0.0028693918138742447, -0.038682181388139725, 0.04929926246404648, 0.04461291804909706, 0.04207117483019829, 0.009610973298549652, 0.038655705749988556, -0.04673103988170624, 0.08853744715452194, -0.01345006749033928, -0.03666996583342552, 0.04360681399703026, -0.027959194034337997, -0.0027717596385627985, -0.05613020062446594, 0.012781535275280476, -0.057083357125520706, 0.014456174336373806, 0.01585942879319191, -0.047287046909332275, -0.06015463173389435, -0.03526671230792999, 0.008922584354877472, -0.00639738654717803, -0.01464151032269001, -0.011100277304649353, 0.02127387560904026, 0.004034358076751232, -0.0029885361436754465, -0.012470436282455921, 0.02239912748336792, -0.0790059044957161, 0.03457832336425781, -0.02930949628353119, 0.0005233247647993267, -0.009213825687766075, 0.02978607453405857, -0.026635369285941124, -0.015501996502280235, -0.0028379508294165134, -0.02668832242488861, -0.02705899253487587, -0.004620151128619909, 0.04215060546994209, -0.023166947066783905, -0.013397114351391792, -0.027270805090665817, -0.003643829608336091, -0.061054833233356476, 0.03065979853272438, -0.029388926923274994, -0.000839388114400208, -0.04943164438009262, 0.0012170920381322503, -0.01585942879319191, -0.04305080696940422, -0.04755181074142456, -0.033651646226644516, -0.003081203904002905, -0.034340035170316696, -0.05835422873497009, 0.019605856388807297, 0.0238420981913805, -0.018096694722771645, -0.04397748410701752, 0.012980109080672264, 0.03208953142166138, 0.004649937152862549, 0.008578388951718807, 0.05049070343375206, -0.06121369078755379, -0.015210755169391632, -0.06290818750858307, -0.009253540076315403, 0.009842642582952976, -0.013979597017168999, -0.017342114821076393, -0.02543068863451481, 0.011431233026087284, -0.008353338576853275, -0.024106862023472786, -0.05432979762554169, -0.0010789177613332868, -0.07879409193992615, -0.0672503337264061, 0.03407526761293411, 0.015316661447286606, 0.024543724954128265, -0.03277792036533356, -0.0010739534627646208, -0.010358934290707111, 0.023193422704935074, -0.015356375835835934, 0.01829526759684086, 0.003690163604915142, 0.03664349019527435, 0.046439800411462784, -0.008783582597970963, -0.021631307899951935, -0.05290006846189499, 0.0427330881357193, -0.0078039513900876045, 0.029415402561426163, -0.029203590005636215, 0.014840084128081799, 0.012113003060221672, 0.009187349118292332, -0.038841038942337036, 0.05340312048792839, -0.012940394692122936, -0.023895051330327988, -0.02793271839618683, 0.003981405403465033, -0.006284861825406551, -0.004120406694710255, -0.012013716623187065, 0.023511141538619995, -0.0016101028304547071, -0.0095911156386137, -0.019499950110912323, -0.038841038942337036, 0.0319041945040226, 0.01063693780452013, 0.019407281652092934, 0.00292068999260664, 0.02402743324637413, 0.008472483605146408, 0.0353461392223835, -0.018321745097637177, 0.0378614105284214, 0.030977517366409302, -0.01296687126159668, 0.018996896222233772, -0.002702258760109544, -0.007307516876608133, -0.019380806013941765, -0.0005514560616575181, -0.023286091163754463, 0.03926466405391693, -0.03794083744287491, 0.022266745567321777, -0.050728991627693176, -0.020360436290502548, -0.05544181168079376, -0.011179706081748009, 0.02124739997088909, 0.01773926243185997, -0.034684229642152786, -0.05001412704586983, 0.018996896222233772, -0.04654570668935776, -0.018560033291578293, 0.01964556984603405, 0.023670000955462456, -0.04148869216442108, -0.04723409563302994, -0.033360403031110764, 0.001569560612551868, -0.046942852437496185, -0.008307005278766155, -0.0006288171280175447, -0.00874386727809906, -0.04977583885192871, 0.026767751201987267, -0.004236241802573204, -0.006281551904976368, -0.028197484090924263, 0.026052886620163918, -0.006768058054149151, -0.0017292470438405871, 0.015171040780842304, -0.012199051678180695, -0.021512163802981377, -0.013145587407052517, 0.03224838897585869, 0.004676413722336292, 0.009352827444672585, 0.03945000097155571, -0.02118120901286602, -0.024384865537285805, 0.04286547005176544, -0.014932751655578613, -0.05586543679237366, 0.027297282591462135, 0.022200554609298706, 0.006642294581979513, 0.0820242315530777, -0.008975536562502384, 0.015581426210701466, -0.017911359667778015, -0.006830939557403326, -0.014760654419660568, -0.046783994883298874, -0.0006023406167514622, 0.013992835767567158, -0.023656761273741722, 0.026675084605813026, -0.0006362636340782046, 0.024570200592279434, 0.020942918956279755, 0.02637060359120369, 0.012735201045870781, 0.020506057888269424, -0.012993346899747849, 0.05734812095761299, -0.019129278138279915, 0.013661879114806652, -0.013900168240070343, -0.03791436180472374, 0.016494866460561752, -0.04445406049489975, 0.019221946597099304, -0.03394288569688797, -0.01119956374168396, -0.0003168907423969358, 0.0319836251437664, -0.005728854797780514, 0.010358934290707111, 0.0010350660886615515, -0.020532533526420593, 0.05168214812874794, -0.048478491604328156, 0.04577788710594177, -0.06597946584224701, -0.035372618585824966, 0.0029322735499590635, 0.002962059574201703, -0.014707701280713081, 0.015568188391625881, -0.0009018561104312539, -0.008631342090666294, 0.021062063053250313, 0.02650298736989498, -0.013046300038695335, 0.007942953146994114, -0.0026261387392878532, 0.005169538781046867, 0.00503715593367815, -0.055388860404491425, -0.06031348928809166, -0.031109899282455444, -0.0007984322728589177, 0.022279983386397362, 0.012496912851929665, -0.08313624560832977, 0.026013171300292015, -0.006245146971195936, -0.01226524356752634, -0.04170050472021103, 0.045910269021987915, -0.0008460072567686439, 0.004828653763979673, 0.07058637589216232, 0.00013548527203965932, -0.003700092202052474, -0.03632577136158943, 0.047313522547483444, -0.026423556730151176, 0.04154164344072342, 0.019036611542105675, -0.0034386366605758667, -0.057083357125520706, -0.02978607453405857, 0.008009144105017185, -0.027985671535134315, 0.0077112833969295025, 0.007016275078058243, 0.02806510031223297, -0.02912416122853756, 0.005487256683409214, -0.03913228213787079, 0.03301620855927467, 0.0012005442986264825, 0.015488758683204651, 0.021790167316794395, 0.05618315562605858, -0.007936334237456322, 0.01799078844487667, -0.020386911928653717, -0.03529318794608116, -0.02637060359120369, 0.033836979418992996, -0.004203145857900381, 0.02462315373122692, -0.008896107785403728, 0.014787130989134312, -0.027270805090665817, 0.0029901908710598946, 0.018758608028292656, 0.020347198471426964, 0.012960251420736313, -0.02719137631356716, -0.06216684728860855, -0.04233593866229057, -0.024768775328993797, -0.011715855449438095, -0.0026046265847980976, 0.04164754971861839, -0.012913918122649193, 0.03945000097155571, -0.0038953565526753664, 0.04837258532643318, 0.03312211483716965, 0.027773858979344368, 0.015171040780842304, -0.027853289619088173, -0.007559043820947409, -0.023987717926502228, 0.0277473833411932, 0.016666963696479797, 0.024583440274000168, 0.05295301973819733, 0.04310375824570656, 0.06417906284332275, 0.02017510123550892, -0.03841741755604744, 0.03238077089190483, -0.056924495846033096, 0.053826745599508286, -0.02859463170170784, -0.004673104267567396, 0.01611095666885376, 0.027111945673823357, 0.06349067389965057, 0.014800368808209896, 0.0032748132944107056, -0.07138067483901978, -0.013264731504023075, -0.04175345599651337, -0.006377529352903366, 0.010458221659064293, -0.022941896691918373, 0.054541610181331635, -0.03330744802951813, -0.04175345599651337, -0.009048347361385822, 0.08562503755092621, -0.02825043722987175, -0.022094648331403732, -0.0017292470438405871, -0.01037217304110527, 0.017964312806725502, 0.008598246611654758, -0.05687154456973076, -0.031056946143507957, -0.0005282891215756536, 0.0010392030235379934, -0.006592650897800922, -0.024477533996105194, 0.0059704529121518135, -0.032830871641635895, -0.019566141068935394, 0.015938859432935715, -0.006331195589154959, 0.04236241802573204, 0.03960885852575302, 0.02643679454922676, 0.01617714762687683, -0.04583083838224411, -0.07238677889108658, 0.0731281191110611, -0.020903205499053, 0.03378402814269066, -0.030977517366409302, 0.014694463461637497, -0.01673315465450287, -0.05517704784870148, -0.033678121864795685, 0.00904172845184803, 0.00503715593367815, 0.03063332289457321, 0.014284077100455761, -0.004193217493593693, 0.03288382664322853, 0.019976526498794556, -0.0007454792503267527, 0.018785083666443825, -0.015780000016093254, -0.01059060450643301, 0.019036611542105675, 0.015118087641894817, -0.020903205499053, 0.004358695354312658, 0.015356375835835934, -0.023974480107426643, -0.0007479613996110857, 0.02292865701019764, 0.0191425159573555, 0.00954478234052658, 0.06820348650217056, 0.046572182327508926, -0.012549865990877151, -0.02455696277320385, -0.044718824326992035, -0.0014404876856133342, -0.03521375730633736, 0.06497335433959961, -0.015118087641894817, -0.03600805252790451, -0.012338053435087204, 0.010008120909333229, 0.009968406520783901, 0.014694463461637497, 0.022862466052174568, 0.015038657933473587, -0.008035620674490929, -0.014495889656245708, 0.051443859934806824, -0.0037166401743888855, -0.04561902582645416, 0.006890511605888605, 0.011530520394444466, -0.018533557653427124, 0.02271684631705284, 0.015846190974116325, 0.03272496536374092, 0.00741342268884182, -0.0008170485380105674, -0.0299714095890522, 0.006384148728102446, -0.012073288671672344, 0.0032566108275204897, -0.004994131624698639, -0.0022869084496051073, 0.030712751671671867, -0.039344094693660736, 0.022875703871250153, -0.005199324805289507, 0.03449889272451401, -0.02499382570385933, -0.041276879608631134, -0.153140127658844, -0.020281007513403893, 0.001015208661556244, 0.001793783507309854, -0.024662869051098824, -0.023537617176771164, 0.011907810345292091, -0.03015674464404583, 0.0003410919161979109, -0.013847215101122856, -0.02772090584039688, -0.0639672502875328, -0.03823208063840866, 0.019883859902620316, 0.008512197993695736, 0.008896107785403728, -0.01783192902803421, -0.004497697111219168, -0.0334133543074131, 0.036934733390808105, -0.017500972375273705, -0.010570746846497059, -0.014284077100455761, -0.005301921162754297, -0.02430543676018715, 0.011874714866280556, -0.03394288569688797, -0.04535426199436188, 0.016415435820817947, 0.01814964786171913, 0.014231123961508274, -0.0159520972520113, -0.010325838811695576, 0.02414657734334469, -0.011993858963251114, 0.0024970658123493195, -0.023193422704935074, -0.008710771799087524, 0.04119744896888733, -0.0006523977499455214, -0.012913918122649193, 0.03719949722290039, 0.016600772738456726, -0.023577332496643066, -0.011484186165034771, 0.005000750999897718, 0.008710771799087524, -0.016719916835427284, -0.03050093911588192, 0.029177114367485046, -0.0005783462547697127, -0.011583473533391953, 0.008280528709292412, -0.012020335532724857, -0.023047802969813347, -0.0028842848259955645, -0.01677286997437477, -0.05361493304371834, 0.02496734820306301, -0.01343682873994112, 0.03529318794608116, -0.013847215101122856, -0.007565662730485201, 0.028303388506174088, -0.005586543586105108, 0.0014065646100789309, -0.0013875346630811691, -0.03253963217139244, -0.00201055989600718, 0.017699547111988068, -0.017222970724105835, -0.019791191443800926, -0.018255554139614105, 0.007724521681666374, -0.02143273502588272, 0.01608447916805744, 0.013403733260929585, -0.028991779312491417, -0.019010134041309357, -0.04066792130470276, 0.01260943803936243, 0.06301409751176834, -0.004146883264183998, -0.015210755169391632, 0.019248422235250473, -0.009021870791912079, -0.02386857382953167, -0.036272820085287094, -0.004146883264183998, -0.02912416122853756, 0.008247433230280876, 0.051602717489004135, -0.023987717926502228, 0.01051117479801178, -0.026926610618829727, 0.021419497206807137, 0.001289902487769723, 0.032857347279787064, 0.0030464534647762775, -0.009266778826713562, 0.0069169881753623486, 0.011444471776485443, 0.00026497195358388126, -0.005235729739069939, -0.01877184584736824, -0.020810537040233612, 0.008968917652964592, 0.005682521034032106, 0.023603808134794235, -0.011934286914765835, 0.011113515123724937, 0.01670667715370655, -0.010948036797344685, 0.007770855911076069, 0.014959228225052357, -0.013953120447695255, -0.022915419191122055, 0.014615033753216267, 0.0018665939569473267, 0.0024490770883858204, -0.0034518749453127384, -0.008869631215929985, -0.026224983856081963, 0.002288563409820199, -0.02368323877453804, 0.060737114399671555, 0.02386857382953167, 0.02609260007739067, -0.013277970254421234, -0.016375722363591194, 7.330166681640549e-06, -0.008671057410538197, -0.013469924218952656, -0.03134818747639656, -0.01202695444226265, -0.04103859141469002, -0.007228087168186903, 0.00222568167373538, 0.012437340803444386, 0.022319698706269264, 0.03100399300456047, 0.0094454949721694, -0.03590214625000954, -0.03770254924893379, 0.038655705749988556, 0.022544749081134796, -0.01849384233355522, -0.026569178327918053, -0.010444982908666134, -0.028303388506174088, -0.029680168256163597, 0.008201099000871181, 0.027959194034337997, -0.043686240911483765, -0.004236241802573204, -0.05027889460325241, -0.027959194034337997, -0.01413845643401146, 0.013483162969350815, 0.020386911928653717, 0.01448265090584755, 0.0024242554791271687, -0.026516225188970566, -0.006728343199938536, 0.004970964975655079, 0.00437193363904953, -0.014707701280713081, 0.022015217691659927, -0.008856392465531826, 0.008876250125467777, 0.014019312337040901, -0.003488280111923814, -0.03529318794608116, 0.005523662082850933, 0.012834488414227962, 0.0038258556742221117, -0.05560067296028137, -0.003008393570780754, -0.03754369169473648, -0.016561057418584824, 0.038841038942337036, 0.020664915442466736, -0.0481872484087944, -0.03637872636318207, -0.001967535587027669, -0.019539665430784225, -0.0067084855400025845, -0.012841107323765755, 0.014323792420327663, -0.036087483167648315, -0.028515201061964035, -0.016402198001742363, -0.015501996502280235, -0.04027077183127403, -0.009749975055456161, -0.005378040950745344, -0.0013585758861154318, 0.009849261492490768, -0.016587533056735992, -0.013555972836911678, 0.030421510338783264, -0.013992835767567158, 0.05080842226743698, 0.011219421401619911, 0.016746392473578453, 0.021419497206807137, -0.054700471460819244, -0.00222568167373538, 0.005298611707985401, -0.03823208063840866, -0.019910335540771484, -0.01780545338988304, -0.004517554771155119, 0.02806510031223297, -0.025695452466607094, 0.014337030239403248, 0.03375754877924919, 0.010299362242221832, -0.03256610780954361, -0.005093418527394533, 0.027773858979344368, 0.004203145857900381, -0.004980893339961767, -0.019063087180256844, 0.011570234782993793, -0.03129523620009422, -0.03603453189134598, 0.0019989765714854, 0.023921526968479156, 0.015568188391625881, 0.016190385445952415, 0.005143062211573124, -0.01323163602501154, 0.0012369494652375579, -0.014615033753216267, -0.007942953146994114, 0.010974513366818428, 0.018030503764748573, 0.0036769253201782703, -0.021790167316794395, -0.003584257559850812, 0.022359412163496017, 0.02361704781651497, 0.016428673639893532, 0.007969429716467857, 0.023312566801905632, 0.03158647567033768, 0.04283899441361427, -0.0066522229462862015, 0.014787130989134312, 0.009842642582952976, 0.021234160289168358, -0.0018665939569473267, -0.07159247994422913, -0.019341090694069862, -0.014694463461637497, 0.007552424445748329, -0.019672047346830368, 0.024768775328993797, -0.016759630292654037, 0.037464261054992676, 0.003796069649979472, -0.03926466405391693, 0.00046623480739071965, -0.017222970724105835, -0.013767785392701626, 0.01842765137553215, 0.013132348656654358, 0.02517916075885296, -0.02790624089539051, -0.10876550525426865, -0.004146883264183998, 0.02893882617354393, -0.006562864873558283, -0.01670667715370655, -0.0031159543432295322, 0.016468388959765434, 0.01755392551422119, -0.02875348925590515, 0.01698468066751957, 0.0037894505076110363, -0.04723409563302994, -0.0314805693924427, -0.02737671136856079, -0.02040015161037445, -0.056447919458150864, 0.008909345604479313, 0.000896064389962703, 0.021790167316794395, -0.028118053451180458, -0.017778975889086723, -0.018785083666443825, 0.002407707739621401, -0.0005233247647993267, -0.009319731965661049, -0.013350780121982098, -0.0073141357861459255, -0.0010946382535621524, 0.01730239950120449, 0.0412239246070385, -0.009630830958485603, 0.0007802296313457191, 0.013397114351391792, 0.020572248846292496, -0.019658809527754784, -0.006407315377146006, -0.01345006749033928, -0.007095704786479473, 0.02271684631705284, -0.002475553657859564, -0.018917465582489967, -0.03688177838921547, 0.007777474820613861, -0.004517554771155119, 0.013966359198093414, -0.053138356655836105, -0.01611095666885376, 0.005808284506201744, 0.010378791950643063, -0.005934047978371382, 0.008406291715800762, -0.01877184584736824, -0.013430209830403328, 0.004808796104043722, -0.000896064389962703, -0.0189307052642107, -0.015184278599917889, 0.015237231738865376, 0.0069169881753623486, 0.01540932897478342, 0.009280016645789146, 0.04413634166121483, 0.03659053519368172, 0.009677164256572723, -0.01218581385910511, -0.024331912398338318, 0.005447541829198599, 0.039211712777614594, -0.018970418721437454, -0.03873513266444206, 0.024848204106092453, -0.005368112586438656, 0.029891980811953545, 0.005755331367254257, -0.018626224249601364, 0.017818691208958626, -0.028912348672747612, 0.0089622987434268, -0.07365765422582626, 0.014879798516631126, 0.03738483414053917, -0.03320154547691345, -0.02055901102721691, -0.004431505687534809, 0.00770466448739171, 0.007664949633181095, 0.029865503311157227, -0.013900168240070343, -0.03547852486371994, 0.014893037267029285, 0.0011045668506994843, -0.014310553669929504, -0.006883892696350813, 0.011133372783660889, -0.022293221205472946, -0.022452080622315407, 0.0018384626600891352, 0.012132860720157623, 0.02877996675670147, -0.009313112124800682, 0.03701416030526161, 0.03050093911588192, -0.01992357335984707, -0.05046422779560089, 0.002568221418187022, -0.025443926453590393, 0.013953120447695255, -0.03463127464056015, 0.017792215570807457, -0.012781535275280476, -0.0089622987434268, -0.0003805998421739787, -0.021909311413764954, 0.054170940071344376, -0.004702890291810036, 0.03103047050535679, 0.028727013617753983, 0.02061196230351925, 0.03219543769955635, -0.025377735495567322, -0.0024854824878275394, 0.014840084128081799, -0.02531154453754425, 0.00783704686909914, -0.03288382664322853, 0.009081442840397358, 0.012232148088514805, 0.034207649528980255, -0.015104848891496658, -0.013205159455537796, -0.036775872111320496, 0.024795250967144966, 0.003739807056263089, -0.011629806831479073, 0.019777953624725342, -0.02171073853969574, -0.006523150019347668, 0.0003073757397942245, -0.014429697766900063, 0.005483947228640318, 0.001402427675202489, 0.0033873384818434715, 0.034684229642152786, 0.022875703871250153, 0.010756081901490688, 0.0029504760168492794, -0.0020585486199706793, -0.009438876062631607, -0.018096694722771645, 0.004752533510327339, 0.003193729091435671, -0.011954144574701786, -0.0059141903184354305, -0.008340100757777691, -0.001618376700207591, 0.016825823113322258, -0.015263708308339119, -0.03561090677976608, -0.00627162354066968, 0.03582271933555603, 0.05613020062446594, 0.019698522984981537, 0.013211778365075588, 0.009471971541643143, -0.007863523438572884, 0.012549865990877151, -0.021882835775613785, 0.011305470019578934, -0.02531154453754425, -0.015290184877812862, -0.01670667715370655, -0.030924564227461815, 0.04347442835569382, 0.004176669288426638, 0.060366444289684296, 0.010305981151759624, -0.012582961469888687, 0.02159159444272518, -0.013330922462046146, 0.015118087641894817, 0.003293015994131565, 0.026066124439239502, 0.009836023673415184, -0.00039900929550640285, 0.001338718575425446, -0.030368557199835777, 0.0036140435840934515, 0.02343171089887619, -0.0017474496271461248, 0.030527416616678238, 0.008022382855415344, 0.03751721605658531, -0.01852031797170639, 0.03330744802951813, -0.0013320994330570102, 0.0011930977925658226, 0.010603842325508595, 0.018189363181591034, -0.0063444338738918304, -0.008915964514017105, -0.012781535275280476, 0.010524412617087364, -0.011848238296806812, -0.020069194957613945, -0.030395032837986946, 0.015806475654244423, 0.009074823930859566, -0.015078372322022915, -0.020598724484443665, 0.007532567251473665, -0.014178170822560787, -0.005642806179821491, -0.012126241810619831, 0.04757829010486603, -0.020029479637742043, -0.03526671230792999, 0.024014195427298546, 0.0018881061114370823, -0.0240936242043972, -0.010670033283531666, -0.0319041945040226, -0.02005595713853836, -0.031957149505615234, -0.02662213146686554, -0.0030878230463713408, 0.010676653124392033, 0.015131325460970402, -0.014734177850186825, -0.053853221237659454, -0.0038986660074442625, 0.01714354008436203, -0.010120646096765995, 0.005245658569037914, 0.013377256691455841, -0.01149742491543293, -0.00581159396097064, -0.019605856388807297, -0.006317957304418087, -0.034710705280303955, 0.011312088929116726, -0.0028859395533800125, -0.007393565494567156, -0.032116007059812546, 0.013503020629286766, 0.02359057031571865, -0.012132860720157623, 0.018374698236584663, 0.03926466405391693, -0.0021032278891652822, -0.007446518633514643, 0.0032863968517631292, 0.007890000008046627, 0.03817912936210632, -0.0169582050293684, 0.01829526759684086, -0.0018732130993157625, 0.03407526761293411, 0.035028424113988876, 0.02024129219353199, 0.029335973784327507, -0.0038788088131695986, 0.012582961469888687, -0.007949572056531906, -0.01629629172384739, 0.019658809527754784, -0.026661844924092293, -0.01939404383301735, 0.018745368346571922, 0.02120768465101719, 0.02074434608221054, -0.006480125710368156, 0.006225289311259985, -0.0001901964860735461, 0.03431355580687523, 0.004070763476192951, -0.006321266759186983, 0.022531509399414062, -0.018030503764748573, 0.0019245112780481577, 0.020784061402082443, -0.003736497601494193, -0.023219900205731392, -0.030712751671671867, -0.016494866460561752, -0.008763724938035011, -0.03698768466711044, -0.01895718090236187, 0.0018732130993157625, 0.03171885758638382, -0.007009656168520451, 0.0157005712389946, 0.02999788522720337, 0.006496673449873924, 0.025854311883449554, 0.01420464739203453, -0.017871644347906113, 0.01739506796002388, -0.002030417323112488, 0.018189363181591034, -0.02026776783168316, 0.024583440274000168, 0.02558954618871212, 0.0031573239248245955, -0.058460135012865067, 0.045036543160676956, 0.03614043816924095, 0.008234194479882717, -0.02280951291322708, -0.04482473060488701, -0.024755537509918213, -0.01579323783516884, 0.0077443793416023254, 0.011245897971093655, 0.028118053451180458, 0.04220355674624443, 0.007506090681999922, 0.020320720970630646, -0.0319836251437664, 0.02237265184521675, -0.00584137998521328, 0.00525558739900589, -0.00954478234052658, -0.009015251882374287, 0.0188909899443388, 0.008307005278766155, -0.0314011424779892, 0.03174533694982529, -0.015171040780842304, -0.007658330723643303, 0.00783704686909914, 0.027072232216596603, 0.018136410042643547, 0.025629261508584023, -0.002118120901286602, -0.04355385899543762, 0.010398649610579014, -0.01163642667233944, 0.005824832245707512, 0.0026046265847980976, -0.005546828731894493, 0.017024395987391472, 0.01648162677884102, 0.004914702381938696, 0.01908956468105316, -0.014363506808876991, 0.022518271580338478, -0.0011839964427053928, -0.015157802030444145, 0.011616569012403488, -0.009505067020654678, 0.07630529999732971, -0.026013171300292015, -0.024384865537285805, 0.020982634276151657, -0.0060068583115935326, -0.027800336480140686, -0.010749462991952896, -0.032830871641635895, -0.033995840698480606, -0.011993858963251114, -0.0040939305908977985, 0.04050906002521515, 0.009002013131976128, 0.007247944828122854, 0.016494866460561752, -0.013145587407052517, 0.006357672158628702, 0.025364495813846588, 0.03733187913894653, 0.031771812587976456, 0.026172030717134476, 0.027509093284606934, -0.002230646088719368, -0.0069500841200351715, -0.02740318886935711, -0.00882329698652029, 0.012159337289631367, 0.015554949641227722, 0.03235429525375366, 0.02662213146686554, 0.0006437101401388645, -0.0003787382156588137, -0.01654781959950924, 0.024861443787813187, -0.001620031427592039, 0.008915964514017105, 0.010127265006303787, 0.038285031914711, -0.024239245802164078, -0.021843120455741882, -0.012993346899747849, -0.013086015358567238, 0.006602579727768898, 0.00706922821700573, -0.02684718184173107, 0.028171006590127945, -0.005675901658833027, 0.0017077348893508315, -0.005282063968479633, 0.02258446253836155, 0.03426060453057289, 0.002306765876710415, 0.018162885680794716, -0.009286635555326939, -0.002118120901286602, -0.005030537024140358, -0.010683272033929825, 0.03243372589349747, 0.03028912842273712, 0.01760687865316868, -0.059678055346012115, 0.003640520153567195, -0.04241536930203438, -0.006824320647865534, -0.021062063053250313, -0.0334133543074131, -0.0023299329914152622, 0.00762523477897048, -0.0047194380313158035, 0.01836146041750908, -0.01746125891804695, 0.01071636751294136, -0.03860275074839592, 0.0007247944595292211, 0.014045788906514645, 0.006665461231023073, -0.014469413086771965, 0.008545293472707272, 0.022279983386397362, 0.04260070621967316, -0.015687331557273865, 0.0066886283457279205, -0.007870142348110676, 0.0010532686719670892, -0.009862500242888927, -0.0002078819670714438, 0.013489781878888607, 0.014866560697555542, 0.0130132045596838, 0.026145553216338158, -0.013701594434678555, -0.011206182651221752, 0.019539665430784225, -0.00584137998521328, 0.01592562161386013, -0.02724432945251465, -0.020201576873660088, -0.0238420981913805, 0.011285612359642982, 0.008412911556661129, 0.004593674559146166, 0.0025533284060657024, -0.006539698224514723, 0.012172575108706951, -8.310107659781352e-05, 0.0017739261966198683, -0.056236106902360916, -0.03261905908584595, 0.03600805252790451, -0.028727013617753983, 0.016283053904771805, -0.01829526759684086, 0.022544749081134796, -0.0038920470979064703, -0.0012617711909115314, 0.05030537024140358, 0.030553892254829407, 0.005354874301701784, 0.003961547743529081, -0.021353306248784065, 0.03238077089190483, 0.005861237645149231, 0.008690914139151573, -0.0013056228635832667, -0.030103791505098343, -0.018983658403158188, -0.017011158168315887, 0.017448021098971367, -0.0034816612023860216, -0.020439865067601204, 0.005222491454333067, -0.02124739997088909, 0.0058910236693918705, -0.013886929489672184, -0.011020847596228123, 0.05287358909845352, 0.01617714762687683, -0.02108854055404663, 0.0028296769596636295, 0.004408339038491249, 0.014575318433344364, 0.016190385445952415, -0.01998976431787014, 0.00852543581277132, -0.006983179599046707, 0.025788120925426483, 0.020069194957613945, -0.021604832261800766, 0.03272496536374092, -0.003686854150146246, 0.005808284506201744, 0.0024970658123493195, -0.008333481848239899, -0.03343983367085457, -0.008068716153502464, -0.022955134510993958, -0.0003452288801781833, -0.022253505885601044, 0.010385410860180855, 0.0076914262026548386, 0.013509639538824558, -0.009028489701449871, -0.01886451430618763, 0.0461750328540802, 0.019698522984981537, -0.004034358076751232, -0.018599748611450195, 0.0008629687363281846, 0.04249479994177818, 0.018282029777765274, 0.028118053451180458, 0.00736047001555562, -0.011206182651221752, -0.00010249305341858417, -0.0334133543074131, -0.0104516027495265, -0.0471811406314373, -0.004732676316052675, -0.005993620026856661, 0.014151694253087044, -0.004176669288426638, -0.0003547438536770642, 0.029230067506432533, 0.013344161212444305, 0.014072265475988388, -0.01016698032617569, 0.014442936517298222, -0.0008828261634334922, 0.007294278591871262, 0.023921526968479156, 0.03629929572343826, 0.00524896802380681, -0.016534579917788506, -0.017659831792116165, 0.010100788436830044, 0.015276946127414703, -0.00866443756967783, 0.008214336819946766, 0.012728582136332989, 0.024252483621239662, -0.00805547833442688, -0.006509911734610796, 0.0019311304204165936, -0.0033244567457586527, -0.006466887425631285, 0.012682247906923294, -0.025510117411613464, -0.008624723181128502, 0.016839060932397842, -0.0023795764427632093, 9.871808288153261e-05, -0.030024362727999687, 0.01274843979626894, 0.010828892700374126, 0.019168993458151817, -0.017381828278303146, -0.007684807293117046, -0.011153229512274265, -0.010127265006303787, -0.02877996675670147, 0.02168426103889942, 0.013145587407052517, 0.010411887429654598, 0.011047324165701866, -0.04148869216442108, 0.0201486237347126, -0.01670667715370655, 0.028171006590127945, -0.02202845737338066, 0.011523901484906673, -0.007274421397596598, -0.011219421401619911, 0.0074597569182515144, -0.011861476115882397, 0.016905251890420914, -0.010908322408795357, -0.006165717262774706, -0.01604476571083069, 0.008988775312900543, 0.005536900367587805, -0.03163943067193031, 0.0021429425105452538, 0.006963322404772043, 0.01168275997042656, -0.010709748603403568, 0.052132248878479004, 0.019698522984981537, 0.004636698868125677, -0.02333904430270195, 0.0029868814162909985, -0.027694430202245712, 0.03203657642006874, -0.016587533056735992, -0.04016486555337906, 0.009200586937367916, -0.02336551994085312, -0.006897130981087685, -0.012139479629695415, 0.0074862330220639706, 0.025126207619905472, 0.024504009634256363, -0.0026046265847980976, 0.02155187912285328, -0.012880822643637657, -0.014628271572291851, 0.008929203264415264, -0.025258591398596764, -0.004527483135461807, -0.034525368362665176, 0.016190385445952415, -0.008677676320075989, -0.005215872544795275, 0.015449043363332748, 0.004408339038491249, 0.03028912842273712, 0.015223992988467216, -0.01198062114417553, -0.02690013498067856, -0.021035587415099144, -0.004047596361488104, 0.04217708110809326, -0.0005675901775248349, -0.024914396926760674, -0.011616569012403488, 0.027853289619088173, 0.012146099470555782, -0.014879798516631126, 0.008988775312900543, -0.018573271110653877, 0.012947013601660728, 0.030077315866947174, 0.025324782356619835, -0.009213825687766075, -0.006109454669058323, -0.00517615769058466, -0.0011111859930679202, 0.010358934290707111, -0.012020335532724857, 0.0019145826809108257, 0.03719949722290039, -0.004735985770821571, -0.004385171923786402, -0.012258624657988548, 0.02630441263318062, 0.011861476115882397, 0.01814964786171913, 0.0004554787010420114, 0.05252939462661743, 0.008207717910408974, -0.013953120447695255, 0.027879765257239342, -0.020916443318128586, -0.012993346899747849, 0.004140264354646206, 0.0028032006230205297, 0.006864035036414862, -0.015157802030444145, -0.006109454669058323, -0.011265754699707031, 0.05491228029131889, -0.015051895752549171, 0.028674060478806496, -0.0005555929965339601, -0.02468934655189514, 0.05035832151770592, -0.02139301970601082, 0.01386045292019844, 0.005937357433140278, 0.039397045969963074, -0.028806442394852638, 0.01742154359817505, -0.00482534384354949, 0.04445406049489975, -0.005560067016631365, 0.01037217304110527, 0.049008019268512726, 0.0029306188225746155, -0.005973762832581997, 0.03531966358423233, -0.04032372683286667, -0.01626981608569622, 0.010736225172877312, -0.039344094693660736, -0.026450034230947495, -0.010398649610579014, 0.019777953624725342, -0.03065979853272438, -0.011801904067397118, -0.0311893280595541, 0.018348220735788345, 0.017620118334889412, 0.00527875404804945, -0.0011029121233150363, 0.02040015161037445, 0.011424614116549492, 0.01946023479104042, 0.017196493223309517, 0.00014934406499378383, -0.012622675858438015, -0.02233293652534485, -0.017593640834093094, -0.0023911597672849894, 0.017593640834093094, 0.011537139303982258, 0.005622948985546827, -0.015157802030444145, -0.005027227569371462, -0.02981255017220974, 0.015263708308339119, -0.0034485654905438423, -0.003408850636333227, 0.04397748410701752, -0.004060834646224976, -0.00025876652216538787, 0.0033774098847061396, -0.005103347357362509, 0.014323792420327663, 0.001795438351109624, -0.018652701750397682, -0.0023348971735686064, -0.002520232927054167, -0.05565362423658371, 0.026052886620163918, 0.008644580841064453, 0.016971442848443985, 0.004153502639383078, 0.014998942613601685, -0.0007359642186202109, 0.012225528247654438]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" the number of generated tokens equals the
autoregressive steps, it can be denoted as:
S=#generated tokens
#LOOKAHEAD DECODING steps(6)
LOOKAHEAD DECODING speculates bsequences every
time as in Eq. 5. In each step, we will search n-grams
in the pool starting with the current input token and have at
most Gspeculations of length N−1. As we set G=W
(§3.2), we have G=W=bandN−1 =γusing the
notations in Eq. 5. In practice, we cannot expect each step
to have equally good speculations (i.e., acceptance rate with
E(β) =α). We assume that, on average, for every fstep,
we have one good speculation with E(#tokens )tokens
accepted, and for the other f−1steps, we fall back to
autoregressive decoding due to bad speculations. We use
thisfto bridge SandE(#tokens )per step as follows:
S= (f−1 +E(#tokens ))/f. (7)
We can plot the curve indicated by our formulation with one
specific setting as in Fig. 4 (b). We find that the trend of our
empirical experiments (LLaMA-2-Chat-7B on MT-Bench
withG=Was in Fig. 4 (a)) align well with the formula-
tion to some extent. From this formulation, we conclude
that we can linearly reduce the number of decoding steps
according to per-step log(b)given a large enough γ. In
contrast to speculative decoding, LOOKAHEAD DECODING
will not meet an upper bound indicated in Eq. 4 by simulta-
neously increasing γandb. This reveals the scaling law of
LOOKAHEAD DECODING to linearly reduce decoding steps
according to per-step log(FLOPs )given a large enough N,
5
Lookahead decoding
since per-step FLOPs is roughly proportional to the number
of input tokens (i.e., (W+G)∗(N−1)). The scaling law
also suggests LOOKAHEAD DECODING ’s strong scaling
to multiple GPUs, in which we can obtain an even greater
per-token latency reduction by using more FLOPs, which is
advantageous for latency-sensitive tasks.
(a) (b)
Figure 4: (a) Relation of W, N, G andSfor LLaMA-2-
Chat-7B on MT-Bench. (b) When we assume a setting with
α= 0.425andf= 3.106, the trend of our formulation.
5. Evaluation Results
Model and testbed. We used various versions of the
LLaMA-2 (Touvron et al., 2023b) and CodeLlama (Roziere
et al., 2023) models, including the 7B, 13B, 34B, and 70B
sizes, on two GPU setups S1andS2.S1is equipped with
NVIDIA A100 GPUs with 80GB of memory. On S1, the 7B,
13B, and 34B models are deployed on a single A100, while
the 70B model utilizes 2 A100s with pipeline parallelism
supported by Accelerate (Gugger et al., 2022). S2is a DGX
machine with 8 NVIDIA A100 GPUs with 40GB memory
and NVLink. All models serve with FP16 precision and
batch of 1 if not specified (Cai et al., 2024; He et al., 2023).
Datasets. We benchmarked LOOKAHEAD DECODING ’s
performance across a broad spectrum of datasets and tasks.
MT-Bench (Zheng et al., 2023) is a diverse set of multi-turn
questions with many unique tokens . GSM8K (Cobbe et al.,
2021) contains a set of math questions, in which we use the
first 1k questions. HumanEval (Chen et al., 2021) covers
both code completion and infilling tasks. We also test on
MBPP (Austin et al., 2021) dataset for instruction-based
code generation, and on ClassEval (Du et al., 2023) for
class-level code completion. To control generation length in
code generation tasks, we set the maximum sequence length
to 512 and 2,048 on HumanEval and ClassEval, respectively,
aligned with prior setups (Ben Allal et al., 2022; Du et al.,
2023). Tab. 1 lists detailed","[0.03727100417017937, -0.009472677484154701, 0.07306651026010513, -0.021453697234392166, -0.03688737377524376, -0.017189515754580498, -0.010948172770440578, 0.010660450905561447, 0.013404871337115765, 0.0008096778765320778, 0.048278193920850754, -0.007584044244140387, -0.07046964019536972, -0.032372359186410904, -0.006606528535485268, -0.02381448820233345, 0.026986803859472275, -0.03889404609799385, -0.010107140988111496, 0.023342330008745193, 0.003950637765228748, -0.02374071441590786, 0.00821112934499979, 0.03133951127529144, -0.005551549606025219, -0.04007444158196449, -0.018694521859288216, 0.04556328430771828, 0.029982058331370354, -0.02971646934747696, -0.013264699839055538, -0.03001156821846962, -0.012608104385435581, -0.01984540745615959, -0.01625995524227619, 0.010579299181699753, 0.031014904379844666, -0.00873493030667305, -0.003567009000107646, -0.015168088488280773, -0.027208127081394196, -0.03756610304117203, -0.06928924471139908, -0.017425594851374626, -0.017602654173970222, 0.021320901811122894, 0.013913917355239391, 0.002869837684556842, -0.016023876145482063, 0.07471906393766403, -0.060495294630527496, 0.0435861200094223, -0.052291542291641235, -0.0016479433979839087, -0.009789909236133099, 0.015212353318929672, -0.029008230194449425, 0.016466524451971054, 0.02754749171435833, -0.01037272997200489, 0.024375176057219505, -0.017882999032735825, 0.004946596920490265, -0.02083398960530758, -0.011840847320854664, -0.02486209012567997, -0.03225431963801384, 0.02596871182322502, 0.015773041173815727, 0.04966516047716141, -0.027813080698251724, 0.022501299157738686, 0.011044079437851906, -0.030926374718546867, -0.055508121848106384, -0.00458878930658102, 0.03160510212182999, 0.03352324664592743, 0.02217668853700161, -0.022427523508667946, 0.02390301786363125, 0.006805720739066601, 0.00936201587319374, -0.03812678903341293, 0.033257655799388885, -0.02710484340786934, 0.026603173464536667, -0.024065323173999786, -0.054799884557724, -0.03712345287203789, -0.06309216469526291, -0.0049982392229139805, -0.04066464304924011, 0.053944095969200134, 0.030572256073355675, 0.01656980812549591, 0.015123823657631874, -0.037654630839824677, 0.020199526101350784, 0.03316912800073624, 0.038480907678604126, 0.01187035720795393, 0.03747757151722908, -0.05659998580813408, 0.06439059972763062, -0.010918662883341312, -0.049901239573955536, 0.031841181218624115, -0.03995640203356743, 0.004599855747073889, -0.07058767974376678, -0.009657114744186401, -0.06309216469526291, -0.004861755762249231, 0.021512717008590698, -0.02403581328690052, -0.05503596365451813, -0.0250096395611763, 0.007240991573780775, 0.0002927935274783522, -0.006835230626165867, 0.008720175363123417, 0.028713131323456764, -0.032874029129743576, -0.0014146307948976755, 0.009376770816743374, 0.019373249262571335, -0.08522459119558334, 0.0020933584310114384, -0.004953974392265081, -0.005322847981005907, -0.005735986866056919, 0.05615733936429024, -0.013441759161651134, -0.02837376855313778, -0.01702721230685711, -0.03083784505724907, -0.0003624184464570135, -0.022206198424100876, 0.026396604254841805, -0.0034415919799357653, -0.012763031758368015, -0.03337569534778595, 0.024817826226353645, -0.07707985490560532, 0.006329873576760292, -0.047363389283418655, 0.017366575077176094, -0.041992586106061935, 0.007628309074789286, -0.033700305968523026, -0.024389931932091713, -0.030129607766866684, -0.009295618161559105, 0.01033584214746952, -0.05329487845301628, -0.06651531159877777, 0.01986016146838665, 0.022294728085398674, -0.017942018806934357, -0.026972047984600067, 0.004773226100951433, 0.033405207097530365, -0.0016147447749972343, 0.014216394163668156, 0.034674130380153656, -0.05872470140457153, 0.00981204118579626, -0.06191176921129227, -0.01201790664345026, 0.005629013292491436, -0.009472677484154701, -0.010608809068799019, -0.03815630078315735, 0.010808000341057777, -0.018650256097316742, -0.03555942699313164, -0.028786906972527504, -0.01956506259739399, -0.08510655164718628, -0.055213022977113724, 0.010667828842997551, -0.015551717020571232, 0.035352859646081924, -0.05984607711434364, -0.03671031445264816, -0.0015833905199542642, 0.004422795958817005, 0.008262772113084793, -0.0023976792581379414, 0.0233570858836174, 0.048868391662836075, 0.10405190289020538, 0.0023183715529739857, 0.005322847981005907, -0.059609998017549515, 0.0595804862678051, -0.02596871182322502, -0.002626381115987897, -0.027414696291089058, 0.02313576079905033, -0.005614258348941803, 0.014437718316912651, -0.0389825776219368, 0.021970119327306747, -0.024876846000552177, -0.018605992197990417, -0.012099058367311954, 0.013021242804825306, -0.001420163898728788, 0.0014210861409083009, -0.013345851562917233, 0.04001542180776596, 0.005695410538464785, -0.038628458976745605, 0.0075692893005907536, -0.04748142883181572, 0.016392748802900314, 0.016171425580978394, 0.041402388364076614, 0.010402239859104156, 0.022855417802929878, 0.021394677460193634, 0.03216579183936119, -0.009044784121215343, 0.03470364212989807, 0.03910061717033386, -0.013493401929736137, 0.03612011671066284, -0.009789909236133099, 0.012106436304748058, -0.017676429823040962, -0.010321087203919888, -0.03558893874287605, 0.013249944895505905, -0.018650256097316742, 0.004821179900318384, -0.018783051520586014, -0.005765496753156185, -0.03192971274256706, -0.021261882036924362, 0.012431045062839985, 0.029391860589385033, -0.02651464380323887, -0.017587900161743164, 0.01620093546807766, -0.06167569011449814, -0.056629497557878494, 0.032578930258750916, 0.026913028210401535, -0.03432001173496246, -0.04771750792860985, -0.029996812343597412, -0.0037846446502953768, -0.03417246416211128, -0.0027647085953503847, -0.02545228786766529, 0.02793112024664879, -0.04529769718647003, -0.008144732564687729, -0.022737378254532814, -0.012549084611237049, -0.0342019721865654, 0.04429435729980469, -0.006300363689661026, -0.014209016226232052, -0.001015324960462749, -0.008978387340903282, -0.012084303423762321, -0.037743162363767624, -0.012416290119290352, -0.013692593201994896, 0.010571921244263649, 0.028491808101534843, -0.013899162411689758, -0.049074962735176086, 0.04107778146862984, -2.8746215321007185e-05, -0.05114065483212471, 0.013478646986186504, 0.00037901775795035064, 0.005584748461842537, 0.08038496226072311, 0.024832580238580704, 0.005854026414453983, 0.004994550254195929, 0.0072336141020059586, 0.0005496218800544739, -0.03777267038822174, 0.008948876522481441, 0.0079086534678936, -0.001988229574635625, 0.03372981399297714, -0.030926374718546867, 0.023386595770716667, 0.03069029562175274, 0.03859894722700119, 0.01918143406510353, -0.0010291577782481909, -0.02745896205306053, 0.012438423000276089, -0.0133310966193676, -0.0014635066036134958, -0.023829244077205658, -0.023917773738503456, 0.013316341675817966, -0.004566656891256571, 0.009620226919651031, -0.021984875202178955, -0.027636021375656128, 0.016171425580978394, 0.025776896625757217, -0.02747371606528759, 0.004714206326752901, -0.0027222882490605116, -0.048573292791843414, 0.04845525324344635, -0.04095974192023277, 0.0500192791223526, -0.08209653943777084, -0.034821681678295135, -0.012268740683794022, 0.002770241815596819, -0.0015123822959139943, 0.018414177000522614, 0.003980147652328014, -0.009900570847094059, 0.008948876522481441, 0.005695410538464785, -0.012379403226077557, 0.01067520584911108, 0.0546228252351284, 0.02030281163752079, -0.0013399338349699974, -0.03440854325890541, -0.037064433097839355, -0.028727887198328972, 0.005238007288426161, 0.009339882992208004, 0.049842219799757004, -0.08463439345359802, 0.008004560135304928, -0.0030690294224768877, -0.015359902754426003, -0.021217618137598038, 0.017514124512672424, -0.009989100508391857, 0.004135074559599161, 0.08410321176052094, -0.006554886233061552, -0.01956506259739399, -0.024980129674077034, 0.03927767649292946, -0.03532334789633751, 0.03815630078315735, -0.021247128024697304, -0.011744939722120762, -0.035116780549287796, 0.00649586645886302, 0.010439126752316952, -0.0413728803396225, 0.04001542180776596, -0.006802031770348549, 0.018605992197990417, 0.011730184778571129, 0.005949933547526598, -0.02254556305706501, 0.018989620730280876, 0.000673655653372407, -0.021748796105384827, 0.015404167585074902, 0.06338726729154587, -0.039012085646390915, 0.0053154705092310905, -0.050579968839883804, 0.006779899355024099, 0.006182324141263962, 0.03588403761386871, -0.012976977974176407, 0.02866886742413044, -0.0002145231410395354, 0.0016331884544342756, -0.023165270686149597, -0.012416290119290352, 0.030277157202363014, 0.04093023017048836, 0.014496738091111183, 0.004496571142226458, -0.0491044707596302, -0.029804999008774757, -0.01842893287539482, -0.018827315419912338, -0.01963883824646473, -0.007738971151411533, 0.020509380847215652, 0.03045421652495861, 0.009273486211895943, 0.04709779843688011, 0.04069415107369423, 0.04290739446878433, 0.024537481367588043, -0.039012085646390915, -0.016997702419757843, -0.040044933557510376, -0.004278935492038727, 0.005872469861060381, 0.004160895943641663, 0.034969229251146317, 0.04898643121123314, 0.04323200136423111, -0.003613118315115571, -0.0014718062011525035, 0.04630103334784508, -0.03582501783967018, 0.008668532595038414, -0.0011084655998274684, 0.008093089796602726, 0.03635619580745697, 0.048278193920850754, 0.06722354888916016, -0.016702603548765182, -0.01956506259739399, -0.0779651552438736, -0.03485118970274925, -0.04031052067875862, -0.028949210420250893, -0.0046478090807795525, -0.017823979258537292, 0.01910766027867794, -0.025658857077360153, -0.027060577645897865, 0.01807481423020363, 0.06568903475999832, -0.028167199343442917, -0.060731373727321625, -0.014548379927873611, 0.0170124564319849, 0.02210291475057602, -0.004090809728950262, -0.02732616662979126, -0.005411377642303705, 0.01283680647611618, -0.03352324664592743, 0.006197079084813595, -0.03895306587219238, 0.002121024066582322, -0.02911151573061943, -0.025216208770871162, 0.03555942699313164, -0.023725958541035652, 0.022634092718362808, -0.027208127081394196, 0.04255327582359314, -0.0071413954719901085, -0.009096426889300346, -0.05338340625166893, 0.0952579528093338, -0.02635234035551548, 0.012608104385435581, -0.029878772795200348, 0.023106250911951065, -0.016820643097162247, -0.025585083290934563, -0.007307388819754124, -0.027045823633670807, 0.003744068555533886, 0.032136280089616776, 0.024817826226353645, 0.026411360129714012, -0.003716402919963002, 0.02770979516208172, -0.016628827899694443, -0.022043894976377487, -0.03290353715419769, -0.03473315015435219, 0.015610736794769764, 0.006359383463859558, -0.03479216992855072, 0.004990861751139164, -0.005370801780372858, -0.021158598363399506, -0.010955549776554108, 0.035352859646081924, 0.012416290119290352, -0.012054793536663055, 0.09980247914791107, 0.021306147798895836, -0.007488137111067772, -0.03045421652495861, -0.030631275847554207, 0.007255746517330408, -0.02903774008154869, 0.050432417541742325, -0.01866501197218895, 0.0117228077724576, -0.015522207133471966, -0.011036702431738377, -0.01429754588752985, -0.027355676516890526, -0.006126992870122194, 0.012150701135396957, 0.007606176659464836, -0.022220954298973083, 0.04544524475932121, 0.011294914409518242, -0.039012085646390915, -0.00041313859401270747, 0.015418922528624535, -0.005470397416502237, 0.0013141126837581396, -0.011516238562762737, -0.009775154292583466, -0.010948172770440578, 0.0010411461116746068, -0.024817826226353645, 0.004548213444650173, -0.028624601662158966, 0.028270483016967773, -0.014924631454050541, 0.027488471940159798, 0.006451601628214121, -0.019373249262571335, 9.688699356047437e-05, -0.0035467210691422224, 0.03234285116195679, -0.04875035211443901, -0.013419626280665398, -0.1427098661661148, -0.02068644016981125, -0.009944835677742958, 0.01671735756099224, -0.006949581205844879, -0.006045840680599213, 0.012460554949939251, -0.05007829889655113, -0.01153099350631237, -0.0214241873472929, -0.001971630146726966, -0.020568400621414185, -0.03192971274256706, 0.011066212318837643, 0.025629347190260887, 0.02425713650882244, -0.01897486485540867, 0.005529417190700769, -0.02173404023051262, 0.01851746253669262, -0.018930600956082344, -0.004551901947706938, -0.012069548480212688, 0.03824482858181, -0.0342019721865654, 0.03372981399297714, -0.024434195831418037, -0.02120286226272583, -0.004253114107996225, 0.01433443371206522, -0.012401535175740719, -0.011184251867234707, -0.005732297897338867, 0.018679765984416008, -0.003626028774306178, 0.013537666760385036, 0.009789909236133099, -0.014659042470157146, 0.01519759837538004, -0.01048339158296585, -0.003074562642723322, 0.011302291415631771, 0.013427004218101501, -0.014245904050767422, -0.018768295645713806, 0.013065507635474205, -0.021158598363399506, -0.02723763696849346, -0.03473315015435219, 0.02934759482741356, 0.02793112024664879, 0.015655001625418663, 0.006045840680599213, -0.024891600012779236, -0.041608959436416626, -0.025289984419941902, -0.0194027591496706, -0.047953587025403976, 0.012726143933832645, 0.011693297885358334, 0.024168606847524643, -0.035116780549287796, -0.007432805839926004, 0.04066464304924011, -0.00010806848149513826, -0.013161415234208107, 0.00888247974216938, -0.02918529137969017, -0.006123303901404142, -0.0065032439306378365, -0.013773745857179165, -0.02611626125872135, -0.010453881695866585, 0.04618299379944801, -0.004577723331749439, -0.03234285116195679, -0.007466004695743322, -0.012490064837038517, 0.008218507282435894, -0.026219544932246208, 0.01612715981900692, 0.03966130316257477, 0.005817139055579901, -0.006765144411474466, 0.006027396768331528, -0.022235708311200142, -0.024212872609496117, -0.013891785405576229, 0.014991029165685177, -0.011435085907578468, -0.00324793322943151, 0.04659613221883774, -0.017809223383665085, 0.01835515722632408, -0.04458945617079735, 0.02664743922650814, -0.0010383796179667115, 0.03650374710559845, 0.0014404519461095333, -0.018915845081210136, -0.015536962077021599, 0.013235189951956272, 0.02179306000471115, -0.041904058307409286, 0.010808000341057777, 0.012726143933832645, 0.00455559091642499, -0.01216545607894659, 0.026440870016813278, 0.0017779713962227106, 0.02688351832330227, 0.0026356028392910957, -0.020022466778755188, 0.02208815887570381, 0.013013865798711777, -0.00032322562765330076, -0.01963883824646473, 0.01414999645203352, -0.005706476978957653, 0.01679113321006298, -0.019122414290905, -0.011479350738227367, -0.022707868367433548, -0.03216579183936119, -0.017528880387544632, 0.04674367979168892, 0.02762126550078392, 0.04830770567059517, -0.03260843828320503, -0.012335138395428658, -0.03544138744473457, 0.033257655799388885, -0.0016479433979839087, -0.0413728803396225, -0.0022132424637675285, -0.05270468071103096, -0.01634848490357399, 0.011848224326968193, 0.03372981399297714, -0.0071709053590893745, 0.01872403174638748, -0.0019660971593111753, -0.01656980812549591, -0.033552754670381546, 0.0006464512553066015, -0.0033309299033135176, 0.01206217147409916, -0.003174158511683345, -0.021984875202178955, -0.010424371808767319, -0.038097281008958817, -0.01777971349656582, 0.031221473589539528, -0.0540621355175972, 0.00801931507885456, -0.05955097824335098, -0.04574034363031387, 0.010748980566859245, -0.003109605750069022, 0.028683621436357498, 0.008034070022404194, 0.03142804279923439, 0.006481111515313387, -0.00041014148155227304, -0.012490064837038517, 0.006953270174562931, 0.004171961918473244, 0.02559983730316162, 0.005514662247151136, -0.011457218788564205, 0.01763216406106949, -0.021365167573094368, -0.0371529646217823, -0.023194780573248863, 0.028772151097655296, 0.019299473613500595, -0.02583591639995575, -0.006038463208824396, -0.0332871675491333, -0.02425713650882244, 0.02993779256939888, 0.03390687331557274, -0.03969081491231918, -0.026322830468416214, 0.00379939959384501, -0.02769504114985466, -0.0024898976553231478, -0.028550827875733376, -0.007761103566735983, -0.004396975040435791, -0.01926996372640133, -0.010601431131362915, -0.011914622038602829, -0.0468912310898304, 0.016097649931907654, -0.01866501197218895, -0.0035448765847831964, -0.001582468394190073, -0.012976977974176407, -0.0006874884129501879, 0.022043894976377487, -0.010896530002355576, 0.026558909565210342, 0.016628827899694443, 0.03783169016242027, 0.029539410024881363, -0.03204775229096413, 0.0033751947339624166, -0.0026337585877627134, -0.023312820121645927, -0.03786120191216469, -0.008852969855070114, -0.003306953003630042, 0.018414177000522614, -0.02471454069018364, -0.02284066192805767, 0.03136902302503586, 0.0075397794134914875, -0.03727100417017937, 0.029096759855747223, 0.016687847673892975, 0.012593349441885948, -0.022943947464227676, -0.0380677692592144, 0.015094313770532608, -0.014172129333019257, -0.0342019721865654, 0.007030733395367861, 0.02813768945634365, 0.009546452201902866, -0.015020539052784443, -0.031988732516765594, -0.0018674232997000217, 9.677172056399286e-05, -0.0026761789340525866, 0.006492177955806255, 0.0059093572199344635, 0.0050461930222809315, -0.0026282253675162792, -0.030247647315263748, 0.002799751702696085, 0.016215689480304718, 0.03417246416211128, -0.0017761270282790065, -0.0034729463513940573, 0.041845038533210754, 0.03620864823460579, 0.062147848308086395, -0.03381834551692009, 0.023725958541035652, 0.03700541332364082, 0.00526013970375061, 0.022338993847370148, -0.03913012519478798, -0.007495514582842588, 0.002696467097848654, 0.01589108072221279, -0.01574353128671646, 0.0171009860932827, -0.005138411186635494, 0.027488471940159798, -0.003943260293453932, -0.02596871182322502, -0.003788333386182785, -0.016437014564871788, -0.00129198026843369, 0.004234670661389828, 0.012600727379322052, 0.030808335170149803, 0.010276822373270988, -0.15380559861660004, -0.02948039025068283, 0.041166309267282486, -0.0029546786099672318, -0.01385489758104086, -0.0001382123737130314, 0.026071995496749878, 0.03673982620239258, -0.02269311249256134, 0.0037957108579576015, 0.027267146855592728, -0.04485504701733589, -0.010844888165593147, -0.02053889073431492, -0.006779899355024099, -0.05305879935622215, 0.012445800006389618, -0.00490602059289813, 0.015463187359273434, 0.0015169932739809155, 0.00835867878049612, -0.0018369912868365645, -0.00843983143568039, -0.003164936788380146, -0.017189515754580498, 0.001682064263150096, 0.004020723979920149, 0.010284200310707092, 0.007628309074789286, 0.027001557871699333, -0.0008530205232091248, 0.01496151927858591, 0.0052859606221318245, 0.028122933581471443, -0.013869652524590492, 0.009007897228002548, -0.026234300807118416, -0.02030281163752079, 0.02807866968214512, 0.0024419440887868404, -0.006602840032428503, -0.030277157202363014, 0.021320901811122894, -0.023327575996518135, 0.016540298238396645, -0.018561726436018944, 0.010166160762310028, -0.015566471964120865, 0.0030247645918279886, -0.000986737315542996, -0.00046132272109389305, 0.006525376345962286, -0.006484800484031439, 0.0014090976910665631, -0.0003799399419222027, -0.00608641654253006, -0.02784259058535099, -0.0071266405284404755, 0.01806005835533142, 0.01716000586748123, -0.00278868549503386, 0.04712731018662453, 0.018030548468232155, -0.012239230796694756, -0.025570327416062355, -0.030041078105568886, 0.010461259633302689, 0.017337065190076828, -0.028801660984754562, -0.028536072000861168, 0.0029860329814255238, -0.011169496923685074, 0.008181619457900524, 0.02164551056921482, 0.007377475034445524, 0.007997183129191399, 0.0015695578185841441, 0.009199711494147778, -0.051258694380521774, 0.014231149107217789, 0.033936385065317154, -0.05459331348538399, -0.015610736794769764, -0.01187035720795393, 0.008321791887283325, 0.006370449438691139, 0.04308445379137993, -0.007034422364085913, -0.017189515754580498, 0.01038010697811842, 0.01897486485540867, -0.020051976665854454, 0.0010549789294600487, 0.025644103065133095, -0.019078150391578674, -0.028565581887960434, -0.01317617017775774, 0.042140137404203415, 0.02232423797249794, -0.00275364238768816, 0.0294213704764843, 0.021601246669888496, -0.036769334226846695, -0.00959809496998787, 0.007255746517330408, -0.00307825137861073, 0.005780251696705818, -0.013788500800728798, -0.026293320581316948, -0.03588403761386871, 0.01687966287136078, 0.01807481423020363, -0.007063932251185179, 0.03181167319417, -0.004861755762249231, 0.05831156298518181, 0.054386746138334274, 0.012379403226077557, 0.04323200136423111, -0.032431378960609436, -0.0029657448176294565, 0.01366308331489563, -0.035500407218933105, 0.002683556405827403, -0.041313860565423965, 0.02815244346857071, 0.01298435591161251, 0.01656980812549591, 0.011405576020479202, -0.0036315619945526123, -0.016761623322963715, 0.02254556305706501, 0.008948876522481441, -0.016599318012595177, -0.0014533625217154622, -0.011921999044716358, -0.0027868410106748343, 0.018104324117302895, -0.014577890746295452, 0.015861570835113525, -0.006056906655430794, -0.017366575077176094, 0.05308830738067627, 0.0053339144214987755, 0.005842959973961115, -0.010741603560745716, -0.025644103065133095, 0.016628827899694443, -0.03455609083175659, 0.030631275847554207, -0.007178282830864191, -0.018620746210217476, -0.02008148655295372, 0.017558390274643898, 0.00371455866843462, 0.008152109570801258, -0.016437014564871788, -0.0428483746945858, 0.020258545875549316, 0.03269696980714798, 0.0546228252351284, 0.045651815831661224, -0.0055736820213496685, 0.021704530343413353, 0.013522911816835403, -0.014216394163668156, -0.02837376855313778, 0.009694001637399197, -0.019904427230358124, 0.006451601628214121, -0.016850152984261513, -0.017307555302977562, 0.04231719672679901, 0.007694706320762634, 0.04352710023522377, -0.005389245226979256, -0.004607233218848705, 0.022678358480334282, 0.0032848205883055925, 0.02083398960530758, 0.010653073899447918, 0.030203381553292274, 0.0011379754869267344, 0.015182843431830406, 0.015256618149578571, -0.01448936015367508, 0.016776377335190773, 0.02158649079501629, -0.010490769520401955, 0.04255327582359314, -0.016377994790673256, 0.05069800838828087, 0.011147364042699337, 0.041461408138275146, 0.0013565331464633346, -0.01485823467373848, 0.033552754670381546, 0.03190020099282265, -0.019432269036769867, -0.024139096960425377, -0.021763550117611885, 0.045504264533519745, -0.003093006322160363, -0.026972047984600067, -0.04574034363031387, -0.005448265001177788, 0.010276822373270988, 0.0062597873620688915, -0.011420330964028835, 0.03485118970274925, -0.028624601662158966, -0.003000787924975157, -0.01806005835533142, 0.022427523508667946, -0.006289297249168158, -0.027134353294968605, 0.01023255754262209, 0.018414177000522614, -0.02337183989584446, -0.029598429799079895, -0.0445009283721447, -0.02067168429493904, -0.009007897228002548, 0.014031956903636456, -0.012158078141510487, 0.01932898350059986, 0.005643768236041069, -0.013736858032643795, -0.031103434041142464, -0.002263040514662862, 0.01969785802066326, -0.02828523889183998, 0.006355694495141506, -0.0023478814400732517, 0.007292633876204491, -0.0069016278721392155, -0.012976977974176407, -0.013161415234208107, -0.023032477125525475, 0.0010273134103044868, 0.03792022168636322, -0.009302996098995209, -0.016289465129375458, 0.014245904050767422, 0.0028827483765780926, -0.003626028774306178, 0.005765496753156185, 0.04792407527565956, -0.019594572484493256, 0.027060577645897865, 0.02173404023051262, 0.005569993518292904, 0.03918914496898651, -0.005101523827761412, 0.02186683565378189, 0.01680588722229004, 0.03372981399297714, 0.029657449573278427, 0.03187069296836853, 0.020420851185917854, -0.004574034363031387, 0.00453345850110054, 0.005551549606025219, -0.026027731597423553, 0.0016885196091607213, -0.026234300807118416, -0.03157559409737587, 0.0040871212258934975, 0.011302291415631771, 0.0058946022763848305, 0.0012984356144443154, 0.028491808101534843, -0.009723511524498463, 0.033552754670381546, 0.006661859806627035, 0.0028827483765780926, 0.00156771345064044, -0.030572256073355675, -0.003928505349904299, 0.00805620290338993, -0.011058834381401539, -0.011103099212050438, -0.02276688814163208, -0.021232372149825096, -0.013102395460009575, -0.03570697829127312, -0.026263810694217682, -0.011405576020479202, 0.048720844089984894, -0.017809223383665085, 0.031546082347631454, 0.03626766800880432, 0.002727821236476302, 0.02598346583545208, 0.010778490453958511, -0.0062745423056185246, 0.011073589324951172, -0.013869652524590492, 0.03614962846040726, -0.013198302127420902, 0.010785868391394615, 0.010689960792660713, 0.0174698606133461, -0.04022199288010597, 0.025260474532842636, 0.011619523167610168, 0.020243791863322258, -0.023843998089432716, -0.015905836597085, 0.00019285180314909667, -0.007672573905438185, 0.01673211343586445, 0.00925873126834631, 0.004164584446698427, 0.041845038533210754, -0.01217283308506012, -0.0031667810399085283, -0.02447846159338951, 0.011036702431738377, -0.005226940847933292, 0.02046511508524418, -0.015013161115348339, -0.009421035647392273, 0.018679765984416008, 0.015536962077021599, -0.02216193452477455, 0.014902499504387379, -0.02254556305706501, 0.0004027640097774565, 0.016835397109389305, 0.017292801290750504, 0.009022652171552181, 0.008978387340903282, 0.01302862074226141, -0.025275228545069695, -0.0030266090761870146, -0.033110108226537704, 0.006462668068706989, 0.0011988396290689707, -0.0171009860932827, 0.011169496923685074, 0.026219544932246208, -0.0019402758916839957, -0.0009664492099545896, 0.0028366390615701675, 0.03552991896867752, -0.011331801302731037, -0.01097030472010374, 0.012608104385435581, -0.02723763696849346, 0.07643064111471176, 0.0016331884544342756, -0.03240187093615532, 0.006359383463859558, 0.002670645946636796, 0.00641840323805809, -0.00044310957309789956, -0.024980129674077034, -0.04332053288817406, 0.008956254459917545, -0.0020232724491506815, 0.017971528694033623, 0.004142452031373978, 0.0023995237424969673, 0.0132868317887187, -0.006370449438691139, 0.0019494977314025164, 0.01429754588752985, 0.019992956891655922, 0.025585083290934563, 0.009295618161559105, 0.03904159739613533, -0.0026208478957414627, -0.019063394516706467, -0.02291443757712841, 0.0056068808771669865, 0.005732297897338867, 0.015846816822886467, 0.024537481367588043, 0.031693633645772934, -0.006875806488096714, -0.0007428195094689727, -0.04461896792054176, 0.005005616694688797, -0.008454586379230022, -0.002595026744529605, -0.01018829271197319, 0.04270082339644432, -0.032283831387758255, -0.02561459317803383, -0.011272781528532505, 0.012091681361198425, 0.0095169423148036, 0.0037920221220701933, -0.029598429799079895, 0.011803959496319294, 0.0075692893005907536, 0.0005883536068722606, 0.00127814756706357, -0.001798259443603456, 0.024212872609496117, 0.004887577146291733, 0.03166412189602852, -0.004238359164446592, -0.006160191260278225, -0.03682835400104523, -0.015802551060914993, 0.03361177444458008, 0.017115741968154907, -0.0062782312743365765, -0.03986787423491478, 0.007731593679636717, -0.048632312566041946, -0.006986468564718962, -0.021409431472420692, -0.050638988614082336, -0.010763735510408878, 0.005562616046518087, -0.011353934183716774, 0.0413728803396225, -0.018104324117302895, -0.0049355304799973965, -0.0033881054259836674, -0.009826796129345894, 0.015581226907670498, -0.003218423342332244, 0.005824516527354717, -0.009081671945750713, 0.033110108226537704, 0.04739289730787277, 0.004467060789465904, -0.010660450905561447, 0.00040921929758042097, -0.007775858510285616, -0.013427004218101501, -0.011324424296617508, 0.03697590529918671, 0.007584044244140387, 0.009325128048658371, 0.01844368688762188, -0.019889671355485916, 0.007694706320762634, 0.03381834551692009, 0.02515718899667263, 0.0040686773136258125, -0.009229221381247044, -0.030572256073355675, -0.011811337433755398, 0.04556328430771828, -0.023947283625602722, 0.004544524475932121, -0.008727552369236946, -0.02053889073431492, 0.008085712790489197, -0.017558390274643898, 0.001234804862178862, -0.06356432288885117, -0.008609512820839882, 0.01231300551444292, -0.002454854780808091, 0.014570512808859348, -0.012305627577006817, 0.027975384145975113, -0.010933417826890945, 0.014592645689845085, 0.012084303423762321, 0.0008599369321018457, 0.012158078141510487, 0.009716134518384933, -0.042966414242982864, 0.04473700746893883, 0.028270483016967773, 0.0194027591496706, 0.011324424296617508, -0.02046511508524418, -0.011508860625326633, -0.0190338846296072, -0.010357975028455257, -0.006728257052600384, -0.02374071441590786, 0.0010955550242215395, -0.009325128048658371, -0.0005556160467676818, -0.0077832359820604324, -0.015138578601181507, 0.039218656718730927, 0.011184251867234707, -0.007281567435711622, -0.022265218198299408, 0.01317617017775774, 0.02934759482741356, 0.036474235355854034, -0.015728777274489403, -0.009738266468048096, 0.003902684198692441, 0.009199711494147778, -0.008779195137321949, -0.004832245875149965, 0.0048728222027421, 0.01298435591161251, -0.018915845081210136, -0.02701631374657154, -0.024094833061099052, -0.0056031919084489346, -0.00217451062053442, -0.023091496899724007, 0.01769118383526802, -0.014009824953973293, 0.03375932574272156, 0.008366056717932224, 0.017440350726246834, -0.014754950068891048, -0.03405442461371422, 0.03166412189602852, 0.03331667557358742, -0.013382739387452602, 0.0022279974073171616, 0.012526952661573887, 0.008188997395336628, -0.005086768884211779, 0.010557166300714016, -0.006123303901404142, 0.0022538185585290194, 0.013021242804825306, -0.028462298214435577, -0.02583591639995575, -0.02515718899667263, 0.004880199674516916, 0.0010614341590553522, 0.011125232093036175, -0.0004082971136085689, -0.010114517994225025, 0.03440854325890541, 0.012748276814818382, -0.01269663404673338, -0.01574353128671646, 0.006964336149394512, 0.012969600968062878, -0.01119900681078434, 0.007473382167518139, 0.023799734190106392, -0.0007229925249703228, -0.035647958517074585, -0.017661673948168755, -0.00026051708846352994, 0.013773745857179165, 0.017056722193956375, -0.0032719101291149855, 0.010062875226140022, 0.02313576079905033, -0.011176873929798603, -0.009863683953881264, 0.007536090444773436, 0.012305627577006817, -0.008602135814726353, 0.04473700746893883, -0.030070587992668152, 0.002654046518728137, 0.01279991865158081, 0.009753021411597729, 0.012261362746357918, -0.011044079437851906, 0.006842608097940683, 0.03942522406578064, 0.05376703664660454, -0.014356565661728382, 0.005304404534399509, 0.0010522123193368316, -0.014400830492377281, -0.034674130380153656, 0.026529399678111076, 0.012681879103183746, -0.0002047249290626496, 0.0048728222027421, -0.04703877866268158, 0.03738904371857643, 0.0033014200162142515, 0.01467379741370678, 0.0005496218800544739, -0.00301554286852479, -0.007432805839926004, -0.039159636944532394, -0.005518351215869188, 0.011176873929798603, 0.021970119327306747, -0.00559950340539217, -0.002405056729912758, -0.029096759855747223, 0.012925336137413979, 0.01716000586748123, -0.028270483016967773, 0.00617863517254591, -0.0023700138553977013, 0.013633573427796364, -0.005533106159418821, 0.053560465574264526, 0.015330392867326736, 0.02186683565378189, -0.004747405182570219, -0.010158782824873924, -0.010151405818760395, 0.031191963702440262, -0.013722103089094162, -0.04149091988801956, 0.013699971139431, -0.012003151699900627, 0.018945354968309402, 0.016377994790673256, 0.005994198378175497, 0.004433862399309874, 0.01842893287539482, 0.009775154292583466, 0.015168088488280773, -0.010077630169689655, 0.0037606677506119013, 0.01963883824646473, -0.011796582490205765, -0.0026466690469533205, -0.053648997098207474, 0.030114851891994476, -0.01343438122421503, -0.00018432160140946507, -0.022899681702256203, -0.016968192532658577, 0.016687847673892975, 0.0358545258641243, -0.014946764335036278, -0.028550827875733376, -0.007521335501223803, -0.021247128024697304, 0.05235056206583977, 0.00019504199735820293, -6.806872988818213e-05, -0.003334618639200926, 0.012608104385435581, -0.00591673469170928, -0.016245199367403984, -0.004411729983985424, 0.010011233389377594, 0.023607918992638588, 0.013751612976193428, 0.0246407650411129, -0.002449321560561657, -0.014703307300806046, -0.002713066292926669, 0.003190757939592004, -0.005872469861060381, -0.00970875658094883, -0.007805368397384882, 0.011781827546656132, -0.0019199878443032503, -0.012372025288641453, 0.0012956690043210983, 0.0075102695263922215, 0.03352324664592743, -0.00722254766151309, 0.0006492178072221577, 0.04996025934815407, 0.009686624631285667, -0.008432453498244286, -0.001133364625275135, -0.004544524475932121, 0.011324424296617508, 0.023947283625602722, 0.015581226907670498, 0.013117150403559208, -0.01732231117784977, 0.01187035720795393, -0.021468451246619225, 0.0514947734773159, -0.025585083290934563, -0.0002907186280936003, -0.0115383705124259, -0.007842255756258965, 0.039454735815525055, -0.025776896625757217, -0.011767072603106499, -0.004323200322687626, 0.03555942699313164, -0.019948691129684448, 0.02762126550078392, 0.003397327149286866, 0.035500407218933105, -0.009207088500261307, 0.014467228204011917, 0.03951375558972359, -0.002624536631628871, 0.00682785315439105, 0.050343889743089676, -0.02940661460161209, -0.030926374718546867, 0.01583206094801426, -0.02672121301293373, -0.020479870960116386, -0.00869066547602415, 0.01926996372640133, -0.028181953355669975, -0.007159839384257793, -0.023460369557142258, -0.013884407468140125, 0.027591755613684654, 0.03612011671066284, 0.03426099196076393, 0.007893898524343967, 0.008181619457900524, 0.022117668762803078, 0.02434566617012024, 0.010771113447844982, 0.0010319242719560862, -0.022191444411873817, -0.016894416883587837, -0.02897872030735016, 0.026012975722551346, 0.010490769520401955, 0.009620226919651031, 0.009694001637399197, 0.012674502097070217, -0.03160510212182999, 0.0170124564319849, 0.022235708311200142, -0.02322429046034813, 0.021778305992484093, 0.011479350738227367, -0.005156855098903179, 0.0007239147089421749, 0.01627470925450325, -0.010748980566859245, -0.011287536472082138, 0.017809223383665085, -0.01651078835129738, -0.006388893350958824, -0.03222481161355972, 0.011228516697883606, -0.01220972090959549, 0.013213057070970535, -0.010933417826890945, -0.012785163708031178, -0.002056471072137356, 0.00835867878049612]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" settings. In addition, we validate
the effectiveness of sampling ( §3.2) on XSum (Narayan
et al., 2018) and CNN/Daily Mail (See et al., 2017) datasets.
Baseline Settings. Our primary baseline is HuggingFace’s
implementation of greedy search (Wolf et al., 2020). Ad-
ditionally, we employ FlashAttention (Dao et al., 2022;Table 1: Experimental settings for §5.1 and §5.2.
SERVER PARALLEL . M ODEL MODEL SIZE DATASET
S1 W/OLPLLAMA-2- CHAT 7B, 13B, 70B MT-B ENCH
CODELLAMA 7B, 13B, 34B H UMAN EVAL
CODELLAMA-I NST 7B, 13B, 34B MBPP, GSM8K
S2 W/ LPLLAMA-2- CHAT 7B, 13B MT-B ENCH
CODELLAMA 7B, 13B H UMAN EVAL
CODELLAMA-P YTHON 7B, 13B C LASS EVAL
Dao, 2023) as a stronger baseline to assess the performance
of FlashAttention empowered LOOKAHEAD DECODING .
In distributed settings, we evaluate LP against TP (sup-
ported by deepspeed (Aminabadi et al., 2022)) and PP (sup-
ported by accelerate (Gugger et al., 2022)). We measure the
throughput of single batch inference against these baseline
settings (Cai et al., 2024; He et al., 2023).
5.1. End-to-end Performance
Fig. 5 shows the end-to-end performance of LOOKAHEAD
DECODING when compared with HuggingFace’s implemen-
tation of greedy search on S1. The used tasks and models
are shown in Tab. 1. Across various datasets, LOOKAHEAD
DECODING demonstrates a 1.5x-2.3x speedup. Generally,
our method exhibits better performance in code completion
tasks (e.g., 2.3x), given the higher occurrence of repetitive
tokens during code completions, making predictions easier.
Besides, smaller models also exhibit a higher speedup when
compared to larger models. This is because LOOKAHEAD
DECODING trades per-step FLOPs with a step compression
ratio ( §4). A larger model requires more FLOPs and quickly
hits the GPU FLOPs cap compared to a smaller model. So,
it shows a lower ability to compress decoding steps given
the same GPU setting.
5.2. Performance with LP and FlashAttention
We evaluated the performance of LOOKAHEAD DECODING
with LP and FlashAttention augmentation on S2with greedy
search. The used tasks and models are shown in Tab. 1. The
results for the 7B and 13B models are in Fig. 6 and Fig. 7,
respectively. FlashAttention speeds up the PyTorch imple-
mentation of LOOKAHEAD DECODING by 20%. Notably,
FlashAttention-integrated LOOKAHEAD DECODING shows
1.8x speedups for the 7B model on MT-Bench compared
with autoregressive decoding with FlashAttention (i.e., 1.9x
vs 1.07x in Fig. 6). We did a strong scaling of the workloads
to multiple GPUs for distributed settings (i.e., increasing
GPUs but not increasing workloads). The multiple GPU
settings of both TP (w/ DeepSpeed) and PP (w/ Acceler-
ate) bring slowdowns (i.e., 0.75x-0.82x). The results echos
DeepSpeed’s documentation (dee, 2023). However, with
LOOKAHEAD DECODING , we can further utilize the FLOPs
of multiple GPUs to reduce the inference latency (e.g., 4x
on ClassEval).
6
Lookahead decoding
7B 13B 70B
Model Config.050T okens/s1.64x
1.51x
1.45xMT-Bench
7B 13B 34B
Model Config.0501001.89x
1.72x
1.7xMath - GSM8K
7B 13B 34B
Model Config.0501001.87x
1.75x
1.76xInstruction - MBPP
7B 13B 34B
Model Config.050100 2.25x
2.26x
1.72xCompletion - HumanEval
7","[0.05304046720266342, -0.01872093416750431, 0.03096204623579979, -0.005803750827908516, -0.02581476978957653, 0.011026146821677685, 0.006623526569455862, 0.014462019316852093, 0.0018126514041796327, 0.012815935537219048, 0.03378390520811081, 0.041831422597169876, -0.037598636001348495, -0.012410947121679783, 0.0028888112865388393, -0.014030901715159416, 0.026703132316470146, -0.05398108810186386, -0.0032317452132701874, 0.034332599490880966, -0.034672267735004425, -0.03438485413789749, 0.025566549971699715, 0.05162953957915306, 0.00031353969825431705, -0.024194814264774323, -0.013260116800665855, 0.031223328784108162, 0.047919318079948425, -0.056855201721191406, 4.401497426442802e-05, -0.0337577760219574, -0.02931596338748932, -0.052152104675769806, -0.00547061488032341, 0.0322684608399868, 0.016486963257193565, 0.012567716650664806, -0.03574352711439133, 0.006545141339302063, 0.0009618483600206673, -0.0348290354013443, -0.07812364399433136, 0.009785051457583904, -0.00900773424655199, -0.006172813009470701, 0.021359892562031746, 0.005415092222392559, -0.006427564192563295, 0.08523054420948029, -0.046978700906038284, 0.0743611678481102, -0.03725896775722504, 0.031484611332416534, 0.008511296473443508, 0.026546362787485123, 0.0058494750410318375, 0.020798133686184883, 0.015650857239961624, -0.0033607538789510727, 0.022378897294402122, -0.040995318442583084, 0.020144926384091377, -0.026441849768161774, 0.002390740206465125, -0.014932328835129738, -0.04305945336818695, 0.026807645335793495, -0.0033999462611973286, 0.023606928065419197, -0.0221176128834486, 0.023685311898589134, 0.029054678976535797, -0.054033342748880386, -0.019922835752367973, 0.0015905607724562287, 0.03647511824965477, 0.05999059975147247, 0.03919246420264244, -0.032085563987493515, 0.009589089080691338, -0.009883033111691475, 0.02339790016412735, -0.007655594497919083, 0.016108103096485138, -0.030465608462691307, -0.0137304263189435, -0.021033288910984993, -0.02625895105302334, -0.027304083108901978, -0.047579649835824966, 0.009255953133106232, -0.012208452448248863, -0.0022258053068071604, 0.05570555478334427, 0.034097444266080856, 0.0027924629393965006, -0.034071315079927444, 0.04431361332535744, 0.08700726926326752, 0.0720096230506897, 0.024952534586191177, 0.044888436794281006, -0.02427319996058941, 0.061401527374982834, -0.012535056099295616, -0.0061434186063706875, 0.01694420911371708, -0.03545611724257469, 0.019217371940612793, -0.06573882699012756, -0.008321866393089294, -0.06573882699012756, 0.013808811083436012, 0.0059213279746472836, -0.023371772840619087, -0.03979341313242912, -0.005483679007738829, 0.008165096864104271, -0.02635039947926998, 0.0028790130745619535, 0.03273877128958702, 0.0012557918671518564, -0.01758435182273388, -0.007943006232380867, -0.0007324091857299209, 0.04420910030603409, -0.09500253200531006, 0.01754515990614891, -0.03639673441648483, -0.0110588064417243, 0.003729816060513258, 0.05408560112118721, -0.039950184524059296, -0.013704298064112663, 0.013625913299620152, -0.03592642396688461, -0.003097837558016181, -0.04201431944966316, 0.006963194347918034, -0.025893153622746468, -0.016447771340608597, -0.022235190495848656, 0.037363480776548386, -0.07383859902620316, 0.0226532444357872, -0.02991691417992115, -0.009406191296875477, -0.03362713381648064, -0.0018289816798642278, -0.01889076828956604, -0.02621975913643837, -0.06605236232280731, -0.0322684608399868, -0.012815935537219048, -0.019374141469597816, -0.023149682208895683, 0.012391350232064724, 0.007440036162734032, -0.02910693734884262, 0.009255953133106232, -0.012156195938587189, 0.008955477736890316, -0.01025536097586155, 0.006414500065147877, 0.03498580679297447, -0.0551307313144207, -0.002513216808438301, -0.0884704515337944, -0.028114059939980507, 0.012345626018941402, 0.026128308847546577, 0.02134682796895504, -0.0431639663875103, 0.010229232721030712, -0.01657841168344021, -0.03297392651438713, -0.008668066933751106, -0.04577679932117462, -0.055182989686727524, -0.06265568733215332, 0.02476963773369789, -0.017388390377163887, 0.02699054405093193, -0.03861764073371887, -0.021150866523385048, -0.023241130635142326, 0.04433974251151085, -0.012868192046880722, 0.014383634552359581, 0.024129493162035942, 0.027617622166872025, 0.05967705696821213, 0.010751799680292606, -0.017336133867502213, -0.018302880227565765, 0.04386943206191063, 0.0003451794618740678, -0.02931596338748932, -0.0031419291626662016, 0.047788675874471664, 0.00809977576136589, 0.0175190307199955, -0.03576965630054474, 0.046038080006837845, -0.04836349934339523, -0.024495290592312813, -0.007629466243088245, 0.013926388695836067, 0.022378897294402122, 0.008948945440351963, -0.00569923734292388, 0.04400007426738739, -0.005516339093446732, -0.03307843953371048, -0.012463203631341457, -0.05690745636820793, 0.01818530261516571, 0.010131251998245716, 0.046534519642591476, 0.034907419234514236, 0.02393353171646595, 0.028349215164780617, 0.034097444266080856, -0.0331306979060173, 0.06019962579011917, 0.015872947871685028, -0.016225680708885193, 0.012273773550987244, -0.050610534846782684, 0.016460834071040154, -0.018642548471689224, -0.011300493963062763, 0.0024478959385305643, 0.03341810777783394, -0.04888606816530228, 0.030439479276537895, -0.04347750544548035, 0.01579456217586994, -0.025305267423391342, -0.005725365597754717, 0.0074792285449802876, 0.037363480776548386, -0.02399885281920433, -0.014396698214113712, 0.0035207895562052727, -0.04595969617366791, -0.054503653198480606, 0.014148479327559471, 0.020497659221291542, 0.00576455844566226, -0.03075302019715309, -0.03762476518750191, -0.028558241203427315, -0.027852777391672134, -0.006234867963939905, -0.035952553153038025, 0.051551155745983124, -0.05455590784549713, 0.010046334937214851, -0.03940149024128914, 0.02816631644964218, 0.0009496007114648819, 0.030413351953029633, -0.013286245055496693, -0.017231618985533714, 0.02397272363305092, 0.005379165522754192, -0.03135397285223007, -0.028662756085395813, 0.008883625268936157, -0.006130354478955269, 0.056489404290914536, 0.04023759439587593, -0.012776743620634079, -0.034907419234514236, 0.017937084659934044, -0.003078241366893053, -0.02780052088201046, -0.014605725184082985, -0.0001450325216865167, 0.0048859938979148865, 0.04467940703034401, 0.017296940088272095, 0.003559982171282172, -0.0023368506226688623, -0.015154419466853142, -0.007838493213057518, -0.04577679932117462, 0.006564737763255835, -0.015350381843745708, -0.04473166540265083, 0.033862289041280746, -0.03451549634337425, 0.00993528962135315, 0.04290268197655678, 0.008119371719658375, 0.013769619166851044, 0.011150255799293518, -0.012332562357187271, 0.05371980369091034, 0.02709505707025528, -0.016513090580701828, -0.006319784559309483, 0.007818896323442459, 0.03294779732823372, -0.029420476406812668, 0.002750004641711712, -0.0005544100422412157, -0.0184857789427042, -0.006982790771871805, 0.02087651938199997, -0.005735164042562246, -0.003958438988775015, -0.011019614525139332, -0.05560104176402092, 0.05304046720266342, -0.03822571784257889, 0.04143949970602989, -0.03686704486608505, -0.04833737015724182, -0.0256449356675148, -0.03417582809925079, -0.0017407985869795084, 0.03083140403032303, 0.01825062371790409, 0.009954885579645634, 0.038434743881225586, 0.010464387945830822, -0.022235190495848656, 0.018472714349627495, 0.03663188964128494, 0.013534463942050934, 0.0007185285212472081, -0.02793116308748722, -0.012508927844464779, -0.04731836915016174, 0.015102162957191467, 0.010888973250985146, 0.04773642122745514, -0.06819488853216171, -0.014148479327559471, -0.006515746936202049, 0.003200717968866229, -0.020184118300676346, 0.013808811083436012, -0.001809385372325778, 0.002193144988268614, 0.09076974540948868, 0.0032480754889547825, -0.009739327244460583, -0.013214392587542534, 0.026481041684746742, -0.014684109948575497, 0.03250361606478691, 0.014187672175467014, 0.0020298429299145937, -0.015990525484085083, -0.01872093416750431, 0.015520215965807438, -0.03357487544417381, 0.02282307855784893, 0.005493476986885071, -0.022574858739972115, -0.019086729735136032, 0.01876012608408928, -0.0502186119556427, 0.01818530261516571, 0.02658555470407009, -0.034907419234514236, 0.033470362424850464, 0.06192409247159958, -0.010046334937214851, 0.005513073410838842, -0.04737062379717827, -0.03425421193242073, 0.012130067683756351, 0.047919318079948425, -0.018263688310980797, 0.025997668504714966, 0.0038441275246441364, 0.02719957008957863, -0.006695379037410021, -0.013266649097204208, 0.019138986244797707, 0.0001619750983081758, 0.026481041684746742, 0.0128224678337574, -0.046586774289608, -0.021960843354463577, -0.030543994158506393, 0.008779112249612808, -0.012776743620634079, -0.018446587026119232, -0.016277937218546867, 0.03428034111857414, 0.013109879568219185, 0.038068946450948715, 0.04133498668670654, 0.07404762506484985, 0.01714017055928707, -0.015872947871685028, -0.03498580679297447, -0.06552980095148087, -0.013155603781342506, 0.02094184048473835, -0.02047153003513813, 0.03352262079715729, 0.02608911693096161, 0.017976276576519012, 0.00611729035153985, -0.028009546920657158, 0.04151788353919983, -0.022731628268957138, 0.028323087841272354, -0.020353952422738075, -0.008426379412412643, 0.03927084803581238, 0.018394330516457558, 0.05549652874469757, -0.008811771869659424, -0.0210463535040617, -0.07556307315826416, 0.007910345681011677, -0.04906896501779556, 0.0046965633518993855, 0.008981605991721153, -0.05972931534051895, 0.041361112147569656, -0.01285512838512659, -0.02333258092403412, 0.02874113991856575, 0.09029943495988846, -0.005304046906530857, -0.051106974482536316, 0.004340565297752619, -0.012907384894788265, 0.033470362424850464, 0.00973279494792223, -0.028009546920657158, -0.010157380253076553, -0.019622359424829483, 0.0022617317736148834, 0.007616402115672827, -0.02611524425446987, -0.05560104176402092, -0.023646119982004166, 0.005973584484308958, 0.006982790771871805, -0.02121618762612343, 0.031719766557216644, 0.0013472409918904305, -0.011502987705171108, 0.03859151154756546, -0.015690049156546593, -0.04904283583164215, 0.07807138562202454, -0.017427582293748856, 0.03799056261777878, -0.046769674867391586, -0.0016444504726678133, -0.027251826599240303, -0.037363480776548386, -0.022470345720648766, 0.001647716504521668, 0.04912121966481209, 0.044653281569480896, 0.0300214271992445, 0.01650002785027027, 0.035848040133714676, 0.030073683708906174, 0.026245886459946632, -0.013149071484804153, -0.025840897113084793, -0.031014302745461464, 0.004552857950329781, 0.008080179803073406, -0.03320908173918724, -0.009151440113782883, -0.003426074516028166, -0.0017963212449103594, -0.004151135217398405, 0.0028087932150810957, 0.02837534435093403, -0.006515746936202049, 0.07707851380109787, 0.028584370389580727, -0.010242297314107418, -0.013534463942050934, -0.018172239884734154, -0.02185633033514023, -0.016277937218546867, 0.04993119835853577, -0.014618788845837116, -0.00808671209961176, -0.014161543920636177, -0.005666577257215977, 0.005431422498077154, 0.023437093943357468, -0.007943006232380867, 0.010242297314107418, -0.0023319516330957413, 0.013939453288912773, -0.0009520502644591033, 0.0173100046813488, -0.018433522433042526, -0.004624710883945227, 0.00129416782874614, -0.022431153804063797, -0.00862234178930521, 0.031484611332416534, 0.031223328784108162, 0.012744083069264889, 0.02510930597782135, -0.021555855870246887, 0.005970318801701069, -0.009713198989629745, 0.03273877128958702, 0.013403822667896748, 0.02669006772339344, 0.010823652148246765, -0.02803567610681057, 0.0010835083667188883, 0.012626505456864834, 0.03135397285223007, -0.0311972014605999, -0.01724468357861042, -0.13733039796352386, -0.029734015464782715, -0.02908080816268921, 0.013253584504127502, -0.021568918600678444, 0.0014493046328425407, -0.02367224730551243, -0.043817173689603806, 0.01135928276926279, -0.008628874085843563, -0.02497866377234459, -0.062342144548892975, -0.0034097442403435707, 0.03485516458749771, 0.043007198721170425, 0.0005491027259267867, -0.009994078427553177, 0.01831594482064247, -0.024351583793759346, 0.03529934585094452, -0.00033252357388846576, -0.00993528962135315, -0.01784563437104225, 0.03292166814208031, -0.04426135495305061, 0.02793116308748722, -0.015298125334084034, -0.00703504728153348, 0.0175190307199955, 0.003488129237666726, -0.014187672175467014, -0.004899058025330305, -0.002511583734303713, 0.04726611077785492, -0.00611729035153985, 0.00674110371619463, -0.003978034947067499, 3.0261890060501173e-05, 0.026441849768161774, -0.0007524136453866959, -0.009171036072075367, -0.0007560879457741976, 0.014958457089960575, -0.02598460391163826, -0.011646693572402, -0.0010451324051246047, -0.013057622127234936, -0.017937084659934044, 7.032189751043916e-05, -0.0009994078427553177, 0.01354752853512764, 0.017153235152363777, -0.013952516950666904, -0.03989792987704277, -0.0320594348013401, -0.008511296473443508, 0.009059990756213665, -0.04386943206191063, -0.0052289278246462345, 0.0010843247873708606, 0.02124231494963169, -0.042301733046770096, 0.027852777391672134, 0.06971032917499542, -0.014213800430297852, -0.0027059130370616913, -0.005839677061885595, -0.03720671311020851, 0.010301086120307446, 0.008602745831012726, -0.033261336386203766, -0.016852758824825287, -0.019387206062674522, -0.00647982070222497, -0.002330318558961153, -0.007910345681011677, -0.011777335777878761, 0.005127680487930775, 0.014880072325468063, -0.040551137179136276, 0.007498824968934059, 0.03626609221100807, 0.004840269219130278, 0.0007752759265713394, 0.0080671152099967, -0.020079605281352997, -0.014566532336175442, 0.00322358007542789, 0.009197165258228779, -0.0337577760219574, 0.002511583734303713, 0.03527321666479111, -0.022914526984095573, 0.0031468281522393227, -0.01980525813996792, 0.01593826897442341, 0.0021572185214608908, 0.05199533700942993, -0.0039159804582595825, -0.0322684608399868, -0.011287429369986057, 0.008883625268936157, 0.002106594853103161, -0.04172690957784653, -0.0056273844093084335, 0.021359892562031746, 0.011764271184802055, 0.010470920242369175, -0.018472714349627495, 0.0043634274043142796, -0.0043699597008526325, 0.006450426299124956, -0.021333765238523483, 0.013743490912020206, 0.02688603103160858, -0.013051090762019157, -0.06255117058753967, 0.004278510808944702, 0.005241991952061653, 0.027617622166872025, -0.006839084904640913, -0.012312965467572212, -0.03250361606478691, -0.014932328835129738, -0.046743545681238174, 0.04763190820813179, 0.043007198721170425, 0.03307843953371048, -0.012613440863788128, -0.013109879568219185, -0.002036374993622303, -0.012887788936495781, 0.011209044605493546, -0.040786292403936386, 0.0036318348720669746, -0.059206750243902206, -0.022614052519202232, 0.0007083221571519971, 0.022405024617910385, -0.0018747062422335148, 0.0348290354013443, 0.011450731195509434, -0.022026164457201958, -0.01936107687652111, 0.010065930895507336, 0.032216206192970276, -0.0023989053443074226, -0.007818896323442459, -0.018681740388274193, 0.006956662517040968, -0.027304083108901978, -0.002572005381807685, 0.04036823660135269, -0.04577679932117462, 0.019922835752367973, -0.05852741375565529, -0.02578864060342312, -1.5998486560420133e-05, 0.014370569959282875, 0.015676986426115036, 0.010372938588261604, -0.010608093813061714, -0.007969134487211704, 0.006623526569455862, -0.0013554060133174062, 0.0010843247873708606, -0.0005193001707084477, 0.011705482378602028, -0.008785643614828587, -0.00232705264352262, 0.035377729684114456, -0.008615809492766857, -0.06673169881105423, -0.024599803611636162, 0.024887215346097946, 0.024861086159944534, -0.022836143150925636, -0.012783274985849857, -0.03898343816399574, -0.021438278257846832, 0.012273773550987244, 0.04520197585225105, -0.038068946450948715, -0.02840147167444229, 0.007779703941196203, -0.04671741649508476, 0.019792193546891212, 0.023959659039974213, 0.018786253407597542, -0.005486945156008005, 0.01781950704753399, -0.010438259690999985, -0.018538035452365875, -0.03556063026189804, -0.002229071455076337, 0.0149062005802989, 0.008896688930690289, 0.0022878600284457207, -0.002011879812926054, 0.008583149872720242, 0.02128150872886181, 0.005506541114300489, 0.038434743881225586, 0.006009511183947325, 0.014867007732391357, 0.002198043977841735, -0.040760163217782974, -0.012110471725463867, 0.014501211233437061, -0.04972217231988907, 0.0007058726041577756, -0.003230112139135599, 0.012117003090679646, 0.024952534586191177, -0.0196615532040596, -0.022261319682002068, 0.012946576811373234, -0.016983401030302048, -0.04577679932117462, 0.013874132186174393, 0.01771499402821064, -0.015546344220638275, -0.03966277465224266, -0.029707888141274452, 0.011156788095831871, -0.016552284359931946, -0.032686516642570496, 0.004761884454637766, 0.01467104535549879, 0.017231618985533714, 0.007165689021348953, 0.0020788335241377354, -0.011489924043416977, 0.0122345807030797, -0.005052561871707439, -0.0029133064672350883, 0.0008328398689627647, -0.0029002423398196697, -0.004383023828268051, -0.054921705275774, -0.015167483128607273, 0.0006919919396750629, 0.029237577691674232, -0.013338501565158367, 0.006051969714462757, 0.009399659000337124, 0.04447038099169731, 0.04818060249090195, -0.0018159174360334873, 0.0240380447357893, 0.022849205881357193, 0.032320719212293625, 0.024691252037882805, -0.03600481152534485, -0.0028773800004273653, -0.00879217591136694, 0.002052705269306898, -0.005607788451015949, 0.0029851594008505344, -0.015481023117899895, 0.0014721669722348452, -0.03637060523033142, -0.007596805691719055, 0.0011447465512901545, -0.029054678976535797, -0.017793377861380577, 0.0013741857837885618, 0.02420787885785103, 0.027722135186195374, 0.0031158009078353643, -0.14182446897029877, -0.020967967808246613, 0.03532547503709793, -0.032555874437093735, -0.005486945156008005, -0.01589907705783844, 0.013403822667896748, 0.029133064672350883, 0.01081058755517006, 0.0078058321960270405, 0.02827083133161068, -0.04731836915016174, 0.0034195424523204565, -0.025462036952376366, -0.008968542329967022, -0.04266753047704697, -0.0010230866027995944, -0.020223312079906464, 0.03025658242404461, -0.032085563987493515, -0.017022592946887016, -0.012881256639957428, 0.018668677657842636, 0.026232821866869926, -0.017532095313072205, 0.0003143562062177807, -0.01734919659793377, 0.016186486929655075, 0.014096222817897797, 0.01467104535549879, -0.027042800560593605, 0.013318905606865883, 0.012417478486895561, 0.013364629819989204, -0.03480290621519089, 0.013534463942050934, -0.0344109833240509, -0.02158198319375515, 0.002180080860853195, 0.004843535367399454, -0.01936107687652111, -0.046769674867391586, 0.01312947552651167, -0.022078420966863632, 0.03132784366607666, -0.02047153003513813, -0.0009896097471937537, -0.010372938588261604, -0.007041579112410545, -0.008230417035520077, 0.027382468804717064, -0.012881256639957428, -0.020353952422738075, -0.005718833766877651, 0.008733387105166912, -0.018028533086180687, -0.04426135495305061, -0.0018616419984027743, 0.012900852598249912, -0.017636608332395554, -0.009419255889952183, 0.062237631529569626, 0.020327825099229813, -0.00742043973878026, -0.015650857239961624, -0.01344301551580429, 0.02013186179101467, 0.033601004630327225, -0.01828981563448906, -0.029760144650936127, 0.009249421767890453, 0.0007336339331232011, 0.038304101675748825, -0.015559407882392406, 0.004337299149483442, 0.01354752853512764, 0.0056339167058467865, 0.02121618762612343, -0.06307373940944672, 0.007838493213057518, 0.06427563726902008, -0.04567228630185127, 0.012476267293095589, -0.005842943210154772, 0.012626505456864834, -0.007505356799811125, 0.01811998151242733, -0.016748245805501938, -0.009118779562413692, 0.01455346867442131, 0.039584387093782425, -0.012188856489956379, 0.009954885579645634, 0.011738142929971218, -0.020562978461384773, -0.018368201330304146, 0.004869663622230291, 0.015154419466853142, 0.02756536565721035, 0.008426379412412643, 0.03532547503709793, 0.024900278076529503, -0.01925656385719776, -0.02793116308748722, -0.0045920503325760365, 0.015311188995838165, 0.014148479327559471, -0.012495864182710648, 0.021464405581355095, -0.023371772840619087, -0.009419255889952183, 0.015167483128607273, -0.00976545549929142, 0.05387657508254051, -0.01670905388891697, 0.02769600786268711, 0.026036860421299934, -0.0016509825363755226, 0.039688900113105774, -0.03135397285223007, -0.0040760161355137825, 0.017623543739318848, -0.015311188995838165, -0.028584370389580727, -0.005967052653431892, 0.001248443266376853, 0.03362713381648064, 0.012084342539310455, -0.008093243464827538, 0.0008234499837271869, 0.0039094481617212296, 0.012058214284479618, 0.008334930986166, 0.0009202063665725291, -0.004618178587406874, -0.009295145981013775, 0.018916895613074303, -0.014109287410974503, -0.020928775891661644, 0.017127105966210365, -0.0057449620217084885, -0.0101508479565382, 0.03435872495174408, 0.0034489368554204702, 0.012979237362742424, 0.01589907705783844, -0.005509807262569666, -0.028323087841272354, -0.01292698085308075, 0.029498860239982605, -0.0032840019557625055, -0.0037134860176593065, -0.03294779732823372, 0.01018350850790739, 0.0034032121766358614, 0.0222221277654171, -0.0258539617061615, -0.03263425827026367, 0.015324253588914871, 0.0034195424523204565, 0.02897629514336586, 0.04878155142068863, 0.023306451737880707, -0.005545733496546745, 0.034907419234514236, -0.0019187977304682136, -0.02444303408265114, 0.002694481983780861, -0.008289205841720104, 0.0013921490171924233, -0.02480882965028286, -0.006123822648078203, 0.041831422597169876, 0.02192165143787861, 0.04517584666609764, 0.019792193546891212, -0.0071591567248106, 0.009118779562413692, -0.00608462980017066, 0.01175120659172535, -0.011640162207186222, 0.031380098313093185, 0.010595029219985008, 0.024220943450927734, 0.027277953922748566, -0.005055828019976616, -0.00732899084687233, 0.028244702145457268, 0.009066523052752018, 0.04987894371151924, -0.011287429369986057, 0.037938304245471954, -0.009079587645828724, 0.034907419234514236, 0.008785643614828587, -0.01593826897442341, 0.03955826163291931, 0.030909789726138115, -0.02124231494963169, -0.013691234402358532, 0.012084342539310455, 0.042066577821969986, 0.01344301551580429, -0.022953718900680542, -0.034071315079927444, 0.015102162957191467, -0.009961417876183987, -0.01055583730340004, -0.020719749853014946, 0.04175303876399994, -0.01801546849310398, 0.003003122517839074, -0.017623543739318848, 0.03239910304546356, -0.014762494713068008, -0.024377712979912758, 0.01494539249688387, -0.010111656039953232, -0.02955111861228943, -0.011032678186893463, -0.029603375121951103, -0.010947761125862598, -0.029054678976535797, 0.005865805316716433, -0.0024887213949114084, 0.0023205203469842672, 0.021098610013723373, -0.01859029196202755, -0.012365221977233887, 0.004298106767237186, 0.02581476978957653, -0.007387779653072357, 0.010372938588261604, 0.016486963257193565, -0.012783274985849857, -0.019739937037229538, -0.012966173700988293, -0.007498824968934059, -0.004399354103952646, 0.007054643705487251, 0.0344109833240509, 0.0035142574924975634, -0.022195998579263687, -0.0032872678712010384, 0.02699054405093193, 0.008413315750658512, 0.005408559925854206, 0.034201957285404205, 0.0080671152099967, 0.0064308298751711845, 0.00885749701410532, -0.002998223528265953, 0.032320719212293625, -0.03252974525094032, 0.00621853768825531, 0.012489331886172295, 0.01818530261516571, 0.03365326300263405, 0.03519483283162117, 0.040159210562705994, -0.010516644455492496, 0.04682192951440811, -0.012103939428925514, -0.01862948387861252, 0.009406191296875477, -0.0034358727280050516, -0.03367939218878746, 0.015102162957191467, 0.011698950082063675, 0.01525893248617649, -0.02134682796895504, 0.029237577691674232, -0.014200735837221146, 0.024364648386836052, 0.004706361796706915, 0.004660637117922306, 0.020863454788923264, 0.008321866393089294, 0.023241130635142326, -0.012384818866848946, -0.010013674385845661, -0.0016052579740062356, -0.008080179803073406, 0.002694481983780861, 0.010719139128923416, -0.018943024799227715, -0.03872215375304222, -0.005490210838615894, 0.03890505060553551, -0.02000122144818306, -0.00030496635008603334, 0.038878925144672394, 0.006714975461363792, 0.02256179414689541, 0.018198367208242416, -0.00745310029014945, 0.022431153804063797, -0.022731628268957138, 0.03495967760682106, -0.011280897073447704, 0.02632427215576172, 0.018394330516457558, 0.00022372364765033126, -0.01507603470236063, 0.014161543920636177, 0.037363480776548386, 0.011444199830293655, -0.03785992041230202, -0.022065356373786926, -0.0006278959335759282, -0.03049173764884472, -0.0037984028458595276, 0.030570121482014656, 0.017100978642702103, 0.0092428894713521, 0.012195387855172157, 0.025292202830314636, -0.031223328784108162, 0.006734571885317564, -0.02429932728409767, 0.0337577760219574, -0.0001362550538033247, -0.007289798464626074, 0.016591476276516914, 0.004516931250691414, -0.02957724593579769, 0.003357487730681896, -0.005646980833262205, 0.008367590606212616, -0.0002508726029191166, -0.002536078914999962, 0.0007107716519385576, 0.0018861372955143452, 0.020380081608891487, -0.0493563748896122, 0.014814751222729683, -0.027513109147548676, 0.014723301865160465, 0.0015358546515926719, -0.005029699299484491, 0.027277953922748566, 0.0017310004914179444, -0.007609869819134474, 0.00041621580021455884, -0.0035142574924975634, 0.034907419234514236, -0.012966173700988293, -0.0020984297152608633, 0.011169851757586002, -0.004438546486198902, 0.07038966566324234, -0.02897629514336586, -0.022091485559940338, 0.04143949970602989, -0.0005715567385777831, 0.008668066933751106, 0.0024903544690459967, -0.022365832701325417, -0.015846818685531616, 0.003413010388612747, 0.006852149032056332, 0.028532113879919052, -0.006225069519132376, -0.0064994171261787415, 0.030674634501338005, 0.001611790037713945, 0.005797218531370163, 0.015859883278608322, 0.01122864056378603, 0.017871763557195663, 0.0029949573799967766, 0.03600481152534485, -0.01976606622338295, -0.0032578734681010246, -0.023410964757204056, 0.028793396428227425, 0.010653818026185036, 0.01371736265718937, 0.024586739018559456, 0.04619485139846802, 0.0021539523731917143, -0.017336133867502213, -0.01647389866411686, 0.00010430911061121151, -0.0018028533086180687, 0.00043234185432083905, -0.028009546920657158, 0.04491456225514412, -0.012691826559603214, -0.01299230195581913, -0.008445976302027702, -0.01331237331032753, 0.0067868283949792385, 0.00116352632176131, -0.04467940703034401, 0.02685990184545517, 0.009151440113782883, 0.0011708748061209917, 0.024730443954467773, 0.01902140863239765, 0.008524361066520214, 0.009255953133106232, 0.010359874926507473, -0.026912158355116844, -0.00847210455685854, -0.011241705156862736, -0.000531139550730586, 0.050506021827459335, 0.029002422466874123, 0.023580798879265785, -0.04177916795015335, 0.003396680112928152, -0.044522639364004135, -0.0006078914157114923, -0.009804648347198963, -0.022875335067510605, -0.009856904856860638, -0.008524361066520214, -0.014122351072728634, 0.01828981563448906, -0.02955111861228943, 0.020053477957844734, -0.0069697266444563866, -0.013456079177558422, 0.003935576416552067, 0.010529709048569202, -0.023084361106157303, -0.002002081600949168, 0.04332073777914047, 0.033470362424850464, -0.007348586805164814, 0.01572924293577671, -0.01596439629793167, -0.01390026044100523, -0.029133064672350883, -0.011875316500663757, 0.014057029969990253, -0.0036024407017976046, -0.016865823417901993, 0.018106918781995773, -0.011195980943739414, -0.004089080262929201, 0.036553505808115005, -0.01028802152723074, 0.009014266543090343, 0.004343831446021795, -0.0244691614061594, -0.00959562137722969, 0.03156299889087677, -0.007178753148764372, -0.004000897519290447, -0.023019040003418922, -0.01859029196202755, -0.0027630687691271305, -0.023345643654465675, 0.006688847206532955, -0.03908795118331909, -0.015716178342700005, 0.01754515990614891, -0.017401453107595444, 0.021372957155108452, -0.0022960251662880182, 0.03833023086190224, 0.005669842939823866, 0.018041597679257393, 0.013064154423773289, 0.028479857370257378, 0.02218293398618698, 0.0009438851848244667, -0.03260812908411026, 0.03563901409506798, 0.011744675226509571, 0.030570121482014656, -0.001835513743571937, -0.006009511183947325, -0.007773172110319138, -0.009249421767890453, -0.0013006998924538493, -0.010372938588261604, 0.003321561263874173, -0.010366406291723251, -0.007315926719456911, 0.012940045446157455, -0.007263669744133949, -0.013978645205497742, 0.041125956922769547, 0.02040620893239975, -0.021595047786831856, -0.018681740388274193, -0.019792193546891212, 0.0371805839240551, 0.04261527210474014, -0.022078420966863632, 0.0032431762665510178, -0.006646388676017523, 0.005281184334307909, 0.019857514649629593, -0.02162117511034012, 0.0001163526249001734, 0.022509537637233734, -0.003350955666974187, -0.018146110698580742, -0.002665087580680847, -0.006267528049647808, 0.0009618483600206673, -0.014736366458237171, 0.0015513683902099729, -0.008021390996873379, 0.02581476978957653, -0.001915531698614359, -0.0011235172860324383, -0.010190040804445744, 5.91459174756892e-05, 0.029472732916474342, 0.023280324414372444, -0.02861049771308899, -0.0036938898265361786, 0.012156195938587189, 0.03365326300263405, -0.011907977052032948, 0.018106918781995773, 0.01126130111515522, -0.018603356555104256, -0.0073028625920414925, -0.03258199989795685, -0.021791009232401848, -0.04413071274757385, 0.005862539168447256, -0.04091693088412285, 0.011215576902031898, 0.0021212920546531677, -0.010281489230692387, 0.01524586882442236, 0.024011915549635887, 0.0042589143849909306, -0.009125311858952045, 0.016852758824825287, 0.01129396166652441, -0.015637792646884918, -0.007374715059995651, 0.012704890221357346, -0.007877685129642487, 0.00338688213378191, 0.005986648611724377, -0.008942414075136185, 0.05126374214887619, 0.001389699405990541, 0.03412357345223427, 0.016722118481993675, 0.004683499224483967, -0.006074831821024418, 0.0005017452058382332, 0.00771438330411911, -0.0036024407017976046, -0.0018730731680989265, 0.026363464072346687, -0.013469143770635128, 0.003507725428789854, 0.015376510098576546, -0.006172813009470701, 0.023920467123389244, -0.015781499445438385, -0.010105123743414879, 0.016970336437225342, 0.01589907705783844, -0.00035803948412649333, 0.015180547721683979, 0.0036220368929207325, -0.03234684839844704, -0.02497866377234459, 0.017976276576519012, -0.01018350850790739, 0.024900278076529503, -0.004343831446021795, -0.02604992501437664, 0.024377712979912758, -0.0020102467387914658, 0.03647511824965477, -0.005434688180685043, 0.024247070774435997, -0.008491700515151024, -0.023437093943357468, 0.010451323352754116, -0.011156788095831871, 0.018237559124827385, -0.009869968518614769, 0.008713791146874428, -0.014331378042697906, 0.019909771159291267, 0.01334503386169672, -0.012678761966526508, -0.0027777659706771374, -0.0008769313571974635, -0.004010695498436689, -0.025083176791667938, 0.045907437801361084, 0.021791009232401848, 0.03987180069088936, -0.0418836809694767, 0.020523786544799805, -0.02420787885785103, 0.02111167460680008, 0.0036253028083592653, -0.027826650068163872, 0.018342072144150734, -0.04128272831439972, 0.005477146711200476, -0.01354752853512764, 0.0005564513267017901, 0.004004163201898336, -0.001238645170815289, -0.017022592946887016, 0.033365849405527115, -0.013429950922727585, -0.021464405581355095, 0.020824262872338295, -0.02034088782966137, -0.002648757304996252, -0.035142574459314346, 0.021973907947540283, 0.009353934787213802, 0.023515477776527405, 0.003462000982835889, -0.008811771869659424, 0.02410336583852768, 0.01413541566580534, -0.016016652807593346, -0.008615809492766857, -0.023450156673789024, -0.020589107647538185, 0.02476963773369789, 0.003726550145074725, -0.03681478649377823, -0.008557021617889404, 0.00618587713688612, 0.022953718900680542, 0.006852149032056332, 0.01600359007716179, -0.0104186637327075, -0.009053459390997887, 0.013201327994465828, 0.012273773550987244, 0.003866989864036441, -0.026572490110993385, -0.00882483646273613, -0.010483983904123306, -0.012861659750342369, -0.00602584145963192, -0.031118815764784813, 0.007825428619980812, 0.012391350232064724, -0.023985788226127625, 0.0003664086980279535, 0.027016671374440193, 0.027722135186195374, -0.02198697254061699, 0.005692705512046814, 0.049330249428749084, -0.011052275076508522, 0.012143131345510483, 0.00526812020689249, 0.007061175536364317, -0.03428034111857414, 0.030674634501338005, 0.011725078336894512, 0.014187672175467014, -0.0258539617061615, 0.018707869574427605, -0.0001387045776937157, 0.03318295255303383, -0.016682924702763557, 0.008315334096550941, -0.006649654824286699, -0.01942639797925949, 0.034541625529527664, -0.025057047605514526, -0.005320377182215452, 0.029263706877827644, 0.05486945062875748, -0.013874132186174393, 0.0309881754219532, 0.012953109107911587, 0.034097444266080856, -0.010921632871031761, -0.004337299149483442, 0.03083140403032303, 0.009954885579645634, 0.026781516149640083, 0.03668414428830147, -0.03260812908411026, -0.027722135186195374, 0.0009879766730591655, -0.021203123033046722, -0.037729278206825256, -0.003628568956628442, 0.016591476276516914, -0.04901670664548874, -0.002385841216892004, -0.03166751191020012, -0.018211431801319122, 0.025305267423391342, 0.0203016959130764, 0.026938287541270256, 0.018446587026119232, 0.017218556255102158, 0.021869394928216934, 0.044992949813604355, 0.015637792646884918, 0.00941272359341383, -0.02188245952129364, -0.0337577760219574, -0.014932328835129738, 0.029524989426136017, 0.019517846405506134, -0.002593234647065401, -0.0016550651052966714, 0.013495272025465965, -0.027852777391672134, 0.013508335687220097, 0.003994365222752094, -0.011907977052032948, 0.04096918925642967, 0.020210247486829758, 0.00036661283229477704, -0.011581373400986195, 0.006665985099971294, 0.00921022891998291, 0.014527339488267899, 0.018394330516457558, -0.0070807719603180885, -0.010483983904123306, -0.042275603860616684, -0.003357487730681896, -0.005725365597754717, -0.0062054735608398914, -0.0012655899627134204, -0.012038618326187134, 0.02303210459649563, -0.006564737763255835]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"B 13B
Model Config.0501.55x
1.4xInfill - HumanEvalw/o Lookahead w/ Lookahead
Figure 5: Throughput of L OOKAHEAD DECODING on various dataset without FlashAttention and distributed serving
1 4 8
The number of GPUs0255075T okens/s
xx xxxx xx1.0x1.07x1.73x1.9x
0.75x0.8x1.8x2.05x
0.75x0.79x
0.71x0.74x1.85x2.18x
0.74x0.78xMT-Bench1 4 8050100150T okens/s
xx xxxx xx1.0x1.07x2.42x2.65x
0.76x0.79x3.16x3.71x
0.75x0.81x0.71x0.75x3.32x3.87x
0.75x0.79xHumanEval1 4 8050100150T okens/s
xx xxxx xx1.0x1.05x2.34x2.76x
0.75x0.79x3.18x3.88x
0.75x0.8x0.72x0.75x3.27x3.99x
0.74x0.78xClassEval1 GPU w/o flash
1 GPU w/ flashTP w/o flash
TP w/ flashLP w/o flash
LP w/ flashPP w/o flash
PP w/ flash
Figure 6: Throughput of LOOKAHEAD DECODING with
multiple GPUs and FlashAttention for 7B models
1 4 8
The number of GPUs0204060T okens/s
xx xxxx xx1.0x1.09x1.53x1.67x
0.77x0.81x1.72x1.91x
0.75x0.8x0.74x0.77x1.79x1.97x
0.75x0.8xMT-Bench1 4 8050100T okens/s
xx xxxx xx1.0x1.1x2.25x2.44x
0.78x0.82x2.88x3.26x
0.75x0.79x0.74x0.79x2.99x3.42x
0.77x0.79xHumanEval1 4 8050100T okens/s
xx xxxx xx1.0x1.08x2.16x2.46x
0.76x0.82x2.83x3.52x
0.79x0.82x0.73x0.78x3.15x3.79x
0.75x0.8xClassEval1 GPU w/o flash
1 GPU w/ flashTP w/o flash
TP w/ flashLP w/o flash
LP w/ flashPP w/o flash
PP w/ flash
Figure 7: Throughput of LOOKAHEAD DECODING with
multiple GPUs and FlashAttention for 13B modelsTable 2: Sampling with LOOKAHEAD DECODING on
CNN/Daily Mail and XSum. A temperature (Temp.) of 0.0
equals greedy search. “AR.” is autoregressive and “LA.” is
LOOKAHEAD DECODING . Rouge scores, speedups against
autoregressive, and compression ratio ( S) are reported.
DATASET TEMP. M ETHOD ROUGE -1 R OUGE -2 R OUGE -L S PEEDUPS S
CNN.1.0AR. 36.55 13.20 22.68 1.00 X1.00 X
LA. 36.53 13.27 22.71 1.46 X1.64 X
0.0AR. 37.79 14.59 23.96 1.00 X1.00 X
LA. 37.79 14.59 23.96 1.57 X1.72 X
XSUM1.0AR. 19.15 4.53 12.84 1.00 X1.00 X
LA. 19.20 4.53 12.87 1.50 X1.67 X
0.0AR. 19.38 4.78 13.05 1.00 X1.00 X
LA. 19.","[0.02480546571314335, -0.004764108452945948, 0.022427059710025787, 0.010972770862281322, -0.0179474838078022, -0.021391067653894424, -0.001631506602279842, -0.028467919677495956, 0.013030165806412697, 0.0214348416775465, 0.02232491970062256, 0.0005389717407524586, -0.04193583130836487, -0.021420249715447426, 0.005351414438337088, 0.011410514824092388, 0.02874515764415264, -0.027329787611961365, -0.031605083495378494, 0.04354088753461838, -0.024878423660993576, -0.03361870348453522, 0.035165395587682724, 0.013942130841314793, 0.035457223653793335, -0.03248056769371033, -0.008849714882671833, 0.003664278192445636, 0.049815211445093155, -0.04053505137562752, -0.0055556949228048325, -0.029781151562929153, -0.010702828876674175, -0.029883291572332382, -0.021785035729408264, 0.03525294363498688, 0.0043956744484603405, 0.011271895840764046, -0.022864803671836853, -0.02306908369064331, 0.019333671778440475, -0.0332101434469223, -0.059533119201660156, -0.004085606429725885, -0.011038432829082012, -0.044328827410936356, -0.015335614793002605, -0.04785995930433273, 0.015364797785878181, 0.07599227875471115, -0.053959183394908905, 0.08661485463380814, -0.043190695345401764, 0.03624516353011131, -0.006496843416243792, 0.013059348799288273, 0.00026994184008799493, 0.044562291353940964, 0.05635218322277069, -0.027431927621364594, 0.03233465552330017, -0.06245141103863716, 0.014285030774772167, -0.02737356163561344, -0.0007573874900117517, -0.0359533354640007, -0.0633852630853653, 0.03122570551931858, 0.013219854794442654, -0.004702094942331314, 0.005515568424016237, 0.0186332818120718, 0.07511679083108902, -0.040155671536922455, 0.007251950912177563, 0.0057417359203100204, 0.008076367899775505, 0.04742221534252167, 0.006985656917095184, -0.011038432829082012, 0.01393483579158783, 0.012118199840188026, 0.031313251703977585, 0.009418781846761703, 0.027300603687763214, -0.056965023279190063, -0.009593878872692585, -0.02069067768752575, -0.021478615701198578, -0.012329775840044022, -0.07231523096561432, 0.022500017657876015, 0.0012001468567177653, 0.0011107742320746183, 0.04108952358365059, 0.009046699851751328, -0.014941645786166191, -0.0093020498752594, 0.044036999344825745, 0.05824907124042511, 0.04718875139951706, 0.006332689430564642, 0.05524323135614395, -0.005387893412262201, 0.04278213530778885, -0.01591927371919155, -0.007821017876267433, -0.013066643849015236, -0.018122581765055656, -0.012110903859138489, -0.03347278758883476, -0.003106155199930072, -0.06659538298845291, 0.026191653683781624, 0.028701383620500565, -0.018283087760210037, -0.07062262296676636, -0.00988570787012577, -0.020223751664161682, -0.016459155827760696, 0.004851657431572676, 0.02343386970460415, 0.006139352917671204, -0.008769461885094643, -0.010126466862857342, -0.003173640463501215, 0.0691051110625267, -0.06560315936803818, 0.021916359663009644, -0.043482523411512375, 0.0511576272547245, 0.009987847879529, 0.02336091361939907, -0.040768515318632126, -0.0017710373504087329, -0.004603602923452854, 0.01267997082322836, -0.0064384774304926395, -0.05687747523188591, 0.031313251703977585, -0.0051982044242322445, 0.0057417359203100204, -0.04578797146677971, 0.029941657558083534, -0.05906619131565094, 0.011271895840764046, -0.047072019428014755, 0.011840961873531342, -0.027256829664111137, -0.007966931909322739, 0.018837563693523407, 0.013278219848871231, -0.053142063319683075, -0.03291831165552139, -0.015408571809530258, -0.046546727418899536, -0.00030003671417944133, 0.019494177773594856, -0.022397877648472786, -0.029941657558083534, 0.012818589806556702, -0.013613823801279068, 0.029022395610809326, -0.015218882821500301, -0.021186785772442818, 0.052033115178346634, -0.039338551461696625, -0.008214986883103848, -0.0772763267159462, -0.02633756957948208, 0.00650049140676856, 0.027971811592578888, 0.00972520187497139, -0.07931912690401077, -0.009192613884806633, -0.02874515764415264, -0.016561295837163925, -0.004078310448676348, -0.009367711842060089, -0.035719871520996094, -0.03671209141612053, 0.03180936351418495, 0.022587565705180168, 0.021128421649336815, -0.010877926833927631, -0.03119652159512043, 0.01443824078887701, 0.01892511174082756, -0.006708419416099787, 0.007193585392087698, 0.0442412793636322, 0.025535039603710175, 0.05681911110877991, 0.021653713658452034, -0.022850211709737778, -0.04389108344912529, 0.04800587147474289, 0.005161725915968418, -0.005836580414324999, -0.004227872937917709, 0.03647862747311592, 0.03250975161790848, -0.0042242249473929405, -0.039630379527807236, -0.0030715004540979862, -0.02290857769548893, -0.019917329773306847, -0.015262657776474953, -0.025637179613113403, -0.0014299622271209955, 0.03901753947138786, -0.004322717431932688, 0.033793799579143524, -0.002017267979681492, -0.023667333647608757, -0.0032192387152463198, -0.07044752687215805, 0.00021978373115416616, -0.012993686832487583, 0.04333660751581192, 0.007777243386954069, 0.04470820352435112, 0.028467919677495956, 0.027913445606827736, -0.07704286277294159, 0.04858953133225441, 0.0456128753721714, -0.020836591720581055, 0.004103845451027155, -0.06863818317651749, 0.02336091361939907, 0.011957693845033646, -0.020282115787267685, -0.01216926984488964, 0.04520431533455849, -0.05772377923130989, 0.022791845723986626, -0.04249030351638794, -0.017641063779592514, -0.016853125765919685, -0.029285041615366936, 0.015685809776186943, 0.018954293802380562, -0.019829781726002693, -0.013424134813249111, 0.003013134701177478, -0.045145947486162186, -0.05982494726777077, -0.017247095704078674, 0.00944796483963728, -0.019917329773306847, -0.015496120788156986, -0.03539885953068733, -0.04038913547992706, -0.01720331981778145, -0.008922671899199486, -0.03703310340642929, 0.01762647181749344, -0.04307396337389946, -0.0044795754365623, -0.024367723613977432, -0.0186332818120718, -0.0011244537308812141, -0.010432886891067028, -0.006890812423080206, -0.0002315252786502242, 0.018647873774170876, 0.013810807839035988, -0.01847277581691742, -0.05051560327410698, -0.01150535885244608, 0.0029657124541699886, 0.033793799579143524, 0.04199419543147087, -0.046517543494701385, 0.008623547852039337, 0.005592173431068659, 0.007879383862018585, -0.045116767287254333, -0.029314225539565086, -0.014934349805116653, -0.013796216808259487, 0.028249049559235573, 0.04135217145085335, 0.0034618217032402754, -0.037091467529535294, 0.012110903859138489, -0.01182637084275484, -0.009586582891643047, -0.016794759780168533, 0.0005873058689758182, -0.06046697124838829, 0.06677047908306122, -0.03475683555006981, -0.0034308149479329586, -0.0033122592139989138, -0.008762165904045105, 0.0003511067770887166, -0.008463041856884956, -0.03787940740585327, 0.05404673516750336, -0.006956474389880896, -0.007131571415811777, 0.010965474881231785, -0.02016538567841053, 0.05821988731622696, -0.0200632456690073, -0.012993686832487583, 0.030700411647558212, -0.020282115787267685, -0.01810798980295658, 0.03840469941496849, 0.007923157885670662, -0.017641063779592514, -0.04339497536420822, -0.027534067630767822, 0.07698449492454529, -0.024265581741929054, 0.0524708554148674, -0.03011675365269184, -0.037704307585954666, -0.05048641934990883, -0.014759252779185772, 0.0007669631158933043, -0.006285267416387796, 0.013336585834622383, 0.003771889954805374, 0.004891783930361271, -0.012103608809411526, -0.04964011535048485, 0.01257783081382513, 0.007189937401562929, 0.023638149723410606, 0.01447471883147955, -0.01834145374596119, -0.028701383620500565, -0.0214348416775465, 0.003830255940556526, -0.014102636836469173, 0.0283511895686388, -0.07972768694162369, -0.032976679503917694, -0.022966943681240082, 0.021755853667855263, -0.0077845389023423195, -0.001574052730575204, 0.019961103796958923, -0.01326362881809473, 0.08095336705446243, 0.007135219406336546, -0.026322977617383003, 0.007044022902846336, 0.029606053605675697, -0.005639595910906792, -0.01807880774140358, 0.01905643381178379, -0.0019990287255495787, 0.005263865925371647, -0.024236399680376053, 0.02124515175819397, -0.0220330897718668, 0.008375492878258228, 0.01831226982176304, -0.027256829664111137, 0.02535994164645672, -0.027490293607115746, -0.03449419140815735, 0.02813231758773327, 0.0426945835351944, -0.015277248807251453, 0.0038849737029522657, 0.03201364353299141, -0.03674127161502838, 4.08674604841508e-05, -0.021872585639357567, -0.03443582355976105, 0.024630369618535042, 0.03198445960879326, 0.009520921856164932, 0.04397863149642944, -0.020573945716023445, 0.032422203570604324, -0.02652725763618946, -0.04219847545027733, 0.06163428723812103, 0.009097769856452942, 0.007310316897928715, -0.0011791716096922755, -0.04832688346505165, -0.03151753544807434, -0.05500977113842964, -0.009126952849328518, -0.008740278892219067, -0.02206227369606495, -0.00558122992515564, 0.04631326347589493, 0.03417317941784859, 0.059737399220466614, 0.004344604443758726, 0.053696539252996445, 0.007157106418162584, -0.012555943801999092, -0.04339497536420822, -0.06157592311501503, 0.0037974249571561813, 0.023769473657011986, -0.01421207282692194, 0.04176073148846626, 0.04327824339270592, 0.0385797955095768, 0.01958172768354416, -0.06105063110589981, 0.02966441959142685, -0.04085606336593628, 0.008674617856740952, 0.01443824078887701, -0.006617222912609577, 0.06280160695314407, 0.0029784799553453922, 0.043745171278715134, -0.006015325430780649, 0.0027431927155703306, -0.04975684732198715, 0.017801569774746895, -0.04853116348385811, -0.0030787962023168802, 0.014409057796001434, -0.031138155609369278, 0.04065178334712982, 0.0014409057330340147, -0.00023346321540884674, 0.012322479858994484, 0.052354127168655396, -0.003277604700997472, -0.047626495361328125, -0.0026884747203439474, 0.002064690226688981, 0.0186332818120718, -0.010987362824380398, -0.012563238851726055, -0.014299621805548668, 0.010877926833927631, -0.006686532404273748, 0.0013798041036352515, -0.0580739751458168, -0.04091442748904228, -0.01189203280955553, -0.016648845747113228, -0.006792320404201746, -0.019669275730848312, 0.03417317941784859, -0.012439211830496788, -0.016984447836875916, 0.03717901557683945, -0.03116733953356743, -0.02378406561911106, 0.0593288391828537, -0.021186785772442818, 0.02003406174480915, -0.00438837893307209, -0.010272380895912647, -0.02467414364218712, -0.012803997844457626, -0.0034016319550573826, -0.004001705441623926, 0.0344066396355629, 0.031313251703977585, 0.021040871739387512, 0.03035021759569645, 0.011031136848032475, -0.020894957706332207, 0.0021194082219153643, -0.013015573844313622, -0.0020993449725210667, -0.035486407577991486, -0.004931910429149866, 0.03671209141612053, -0.03195527568459511, -0.012949912808835506, -0.036303531378507614, -0.009214500896632671, -0.031108973547816277, -0.009834637865424156, 0.0318385474383831, -0.02636675164103508, 0.07599227875471115, 0.06180938705801964, -0.0024240047205239534, -0.03723738342523575, -0.04689692333340645, -0.019596317782998085, -0.006449421402066946, 0.04934828728437424, -0.018414411693811417, 0.007452583406120539, 0.023156631737947464, 0.012607013806700706, -0.000980363111011684, 0.023681923747062683, -0.05387163534760475, 0.013898356817662716, -0.002157710725441575, 0.026483483612537384, 0.0031937037128955126, 0.013570048846304417, -0.02430935762822628, 0.00871109589934349, -0.000984010985121131, -0.04146890342235565, 0.02646889165043831, 0.033822983503341675, 0.03998057544231415, 0.009250979870557785, 0.019362855702638626, -0.01615273579955101, 0.026571031659841537, -0.021974725648760796, 0.014744660817086697, -0.014525788836181164, 0.016108961775898933, 0.01797666773200035, -0.013431430794298649, -0.003131690202280879, -0.004530645441263914, 0.026191653683781624, -0.03609924763441086, 0.0015549014788120985, -0.15840478241443634, -0.0580739751458168, -0.025199435651302338, 0.01699903979897499, -0.018939703702926636, -0.013562753796577454, 0.025111887603998184, -0.023842429742217064, -0.013898356817662716, 0.0013889237307012081, -0.03005838952958584, -0.041585635393857956, 0.00752189289778471, 0.01612355373799801, 0.01720331981778145, 0.017174137756228447, -0.006445773411542177, 0.023565193638205528, -0.004545236937701702, 0.035165395587682724, -0.02219359576702118, -0.003936043940484524, -0.017743203788995743, 0.023390095680952072, -0.05363817140460014, 0.04065178334712982, -0.006194070912897587, -0.017932893708348274, 0.02858465164899826, -1.5460667782463133e-05, -0.013300107792019844, -6.691548333037645e-05, -0.037996139377355576, 0.03642025962471962, -0.010235902853310108, 0.028482511639595032, 0.0004158563388045877, 0.0011764357332140207, 0.014744660817086697, -0.008878897875547409, -0.03180936351418495, 0.002841684967279434, -0.003928747959434986, -0.01742219179868698, -0.013621118851006031, -0.005603116936981678, -0.026746129617094994, -0.027650799602270126, -0.00693458691239357, 0.016853125765919685, 0.006971065420657396, -0.008331718854606152, -0.021785035729408264, -0.018283087760210037, -0.02763620764017105, -0.009294753894209862, 0.0039032131899148226, -0.04648836329579353, 0.03417317941784859, 0.03253893554210663, 0.013679484836757183, -0.030496131628751755, 0.016167327761650085, 0.06974713504314423, -0.004574419930577278, 0.008981037884950638, -0.002938353456556797, -0.029591461643576622, 0.01961090974509716, -0.014314212836325169, -0.021916359663009644, -0.014824913814663887, 0.013066643849015236, 0.012490281835198402, 0.017247095704078674, -0.001885944977402687, 0.0030113107059150934, 0.004275294952094555, 0.0019406629726290703, -0.04605061933398247, 0.009520921856164932, 0.01781616173684597, -0.0021376474760472775, -0.00642753392457962, -0.021916359663009644, -0.02045721374452114, 0.019173165783286095, -0.011104093864560127, 0.04190664738416672, -0.021070055663585663, 0.002630108967423439, 0.050107043236494064, -0.032159555703401566, -0.012607013806700706, -0.02388620562851429, 0.03951364755630493, 0.008047184906899929, 0.027125507593154907, 0.020778225734829903, -0.007018487900495529, -0.020997097715735435, -0.007966931909322739, -0.012482985854148865, -0.05331715941429138, -0.009331232868134975, -0.0013907476095482707, 0.010155649855732918, 0.005223739426583052, 0.02121596969664097, -0.012665378861129284, -0.010432886891067028, -0.006442125421017408, -0.00871109589934349, 0.018458185717463493, 0.049289919435977936, 0.0015503416070714593, -0.04313232749700546, 0.015569077804684639, -0.004494166933000088, -0.010425591841340065, 0.0006921819294802845, -0.012461098842322826, -0.025739319622516632, -0.015802541747689247, -0.05057396739721298, 0.01696985773742199, 0.03169263154268265, 0.007996114902198315, -0.02026752568781376, -0.011344852857291698, 0.009046699851751328, -0.031342435628175735, -0.00817121285945177, -0.04666345939040184, 0.004319069441407919, -0.037704307585954666, -0.037470847368240356, -0.006573448423296213, 0.02868679165840149, 0.011906623840332031, 0.03265566751360893, 0.027169281616806984, 0.010338042862713337, -0.018735423684120178, 0.009265570901334286, 0.02048639766871929, 0.014649816788733006, -0.015379388816654682, -0.00946255587041378, 0.009192613884806633, -0.0009429724887013435, -0.01192851085215807, 0.021945541724562645, -0.0207490436732769, 0.02718387357890606, -0.06490277498960495, -0.0037208199501037598, -0.0041950419545173645, 0.013321994803845882, 0.04362843930721283, 0.02388620562851429, -0.014051566831767559, -0.022003907710313797, -0.005533807910978794, 0.03566150739789009, 0.005511920433491468, -0.012300592847168446, 0.007915861904621124, 0.002480546711012721, -0.014460127800703049, 0.03592415153980255, -0.003443582449108362, -0.049873579293489456, -0.014350691810250282, 0.024761691689491272, -0.012548647820949554, -0.020107019692659378, -0.011417809873819351, -0.029606053605675697, 0.0086162518709898, 0.005088768433779478, 0.03866734355688095, -0.02805935963988304, -0.0061721839010715485, 0.000865911424625665, -0.032422203570604324, 0.002329160226508975, -0.0004924614913761616, 0.011738821864128113, -0.0031900559552013874, 0.0012676322367042303, -0.011023840866982937, -0.03268485143780708, -0.01990273967385292, 0.02591441571712494, 0.0016269467305392027, -0.029970839619636536, 0.009535512886941433, -0.013307402841746807, -0.025666361674666405, -7.341323362197727e-05, -0.006307154428213835, 0.0496109314262867, 0.01778697781264782, 0.006821503397077322, -0.00465832045301795, -0.007631328888237476, -0.02085118368268013, 0.022952351719141006, -0.059212107211351395, 0.01683853380382061, -0.006566152907907963, -0.005719848908483982, 0.03831715136766434, -0.034610919654369354, -0.012183861806988716, 0.008120141923427582, 0.025345349684357643, -0.001632418599911034, 0.014241255819797516, 0.011935806833207607, -0.037908587604761124, -0.04552532732486725, -0.04342415928840637, 0.014058862812817097, 0.0016506578540429473, -0.021391067653894424, 0.02770916558802128, -0.021887175738811493, 0.012322479858994484, -0.005577581934630871, 0.03948446735739708, 0.0003187319962307811, 0.02137647569179535, 0.002894578967243433, -0.0006543353665620089, 0.014080749824643135, 0.008842418901622295, -0.013256332837045193, -0.0358949676156044, -0.03475683555006981, -0.018910519778728485, 0.020807409659028053, -0.032743215560913086, 0.021449431777000427, 0.012220339849591255, 0.031313251703977585, 0.044591475278139114, 0.0049246144481003284, 0.009207205846905708, 0.022981535643339157, 0.0002822533715516329, 0.014547676779329777, -0.03662453964352608, 0.008587068878114223, -0.01277481485158205, 0.00575267942622304, -0.012125495821237564, -0.00016996760678011924, -0.0043081259354949, 0.00785020086914301, -0.019683867692947388, -0.023127449676394463, 0.018574917688965797, -0.008703800849616528, 0.008360900916159153, -0.01057150587439537, 0.03420235961675644, 0.02649807371199131, -0.008375492878258228, -0.1328405737876892, -0.01641538180410862, 0.04231520742177963, -0.03776267543435097, -0.0026428764685988426, -0.012030650861561298, -0.0023145689629018307, 0.00735044339671731, 0.00938230287283659, 0.01455497182905674, -0.0020628664642572403, -0.039863843470811844, -0.013956722803413868, -0.05331715941429138, -0.004800587426871061, -0.02206227369606495, 0.019683867692947388, -0.02391538769006729, 0.0014162827283143997, -0.01562744379043579, -0.025753909721970558, 0.012570534832775593, 0.03151753544807434, 0.020967915654182434, -0.009703314863145351, 0.00889348890632391, -0.008937263861298561, 0.034961115568876266, 0.01651752181351185, 0.022397877648472786, -0.0024841944687068462, 0.0030186064541339874, 0.01409534178674221, 0.022179005667567253, -0.00809095986187458, -0.025301575660705566, -0.026381343603134155, -0.0018512903479859233, 0.028088543564081192, -0.013154192827641964, -0.005552046932280064, -0.039863843470811844, 0.00727748591452837, -0.029343407601118088, 0.00919990986585617, -0.019012659788131714, -0.005289400927722454, -0.0086162518709898, 0.017436783760786057, -0.014511197805404663, 0.0072118244133889675, 0.008660025894641876, -0.01647374778985977, -0.013227149844169617, -0.004056423436850309, 0.008251465857028961, -0.03700391948223114, 0.00431542145088315, 0.02633756957948208, -0.024294765666127205, -0.03674127161502838, 0.045437779277563095, 0.041001975536346436, -0.02489301562309265, 0.0011290134862065315, -0.005862115416675806, 0.001584996352903545, 0.021682895720005035, 0.0016077954787760973, -0.044591475278139114, -0.023521417751908302, -0.010870630852878094, 0.01667802780866623, -0.007375978399068117, -0.004990275949239731, 0.00531858392059803, -0.003689813194796443, -0.0017765091033652425, -0.04222765937447548, 0.0012968152295798063, 0.050924163311719894, -0.059766583144664764, 0.0012977271107956767, -0.0010460246121510863, 0.00616853591054678, 0.026293793693184853, 0.011074910871684551, -0.0290369875729084, -0.023871613666415215, 0.01269456185400486, 0.04768485948443413, -0.018487367779016495, 0.00995136983692646, 0.008054480887949467, -0.013394951820373535, -0.00667194090783596, 0.018618691712617874, -0.005807397421449423, 0.020238341763615608, 0.024455271661281586, 0.04745139926671982, -0.007335851900279522, -0.017480557784438133, -0.030554497614502907, -0.024776283651590347, -0.011519950814545155, 0.02633756957948208, -0.03195527568459511, 0.024163441732525826, -0.014956236816942692, 0.0012493929825723171, 0.01413181982934475, -0.01132296584546566, 0.017859935760498047, 0.021070055663585663, 0.023959161713719368, 0.04730548337101936, 0.020150793716311455, 0.03443582355976105, -0.021653713658452034, 0.007704285904765129, 0.019654683768749237, 0.0006525114295072854, -0.043219875544309616, -0.012147382833063602, 0.02301071770489216, 0.020077835768461227, 0.007616737391799688, -0.0016980801010504365, -0.006631814409047365, 0.006259732414036989, 0.008339013904333115, 0.0018129877280443907, 0.00919990986585617, -0.0022124287206679583, -0.016561295837163925, 0.005650539416819811, 0.0045671239495277405, -0.013577344827353954, 0.02055935375392437, -0.011417809873819351, 0.005701609421521425, 0.0663619190454483, -0.0015558134764432907, -0.021522389724850655, 0.011534541845321655, -0.012825884856283665, -0.0248638316988945, -0.011213529855012894, 0.020836591720581055, -0.020865773782134056, -0.017465965822339058, -0.014744660817086697, 0.04167318344116211, 0.036332711577415466, 0.019625501707196236, -0.022208187729120255, -0.0358366034924984, 0.021916359663009644, 0.014875983819365501, 0.045700423419475555, 0.03233465552330017, 0.0413229875266552, -0.021682895720005035, 0.04730548337101936, 0.0069163478910923, -0.03431909158825874, 0.003782833693549037, -0.032159555703401566, 0.021026279777288437, 0.003793777199462056, -0.002690298715606332, 0.00944796483963728, 0.026425117626786232, 0.03580741956830025, 0.01037452183663845, 0.0025389124639332294, 0.011198938824236393, -0.03528212755918503, 0.004446744453161955, -0.009776271879673004, 0.018574917688965797, 0.010965474881231785, 0.03913427144289017, 0.0077407644130289555, 0.000375729869119823, 0.0044394489377737045, 0.022864803671836853, -0.015525303781032562, 0.053404711186885834, -0.011571020819246769, 0.0186332818120718, 0.017451375722885132, 0.041264623403549194, 0.008594364859163761, -0.006989304907619953, 0.019012659788131714, 0.026191653683781624, -0.025374533608555794, -0.014365282841026783, 0.04768485948443413, 0.03895917534828186, 0.013110418803989887, -0.006245140917599201, 0.02411966770887375, 0.03892999142408371, -0.0007637712405994534, -0.025462081655859947, -0.013336585834622383, 0.02910994365811348, -0.030729595571756363, -0.008360900916159153, -0.04167318344116211, 0.018998069688677788, -0.022456243634223938, -0.01631324179470539, 0.014642520807683468, 0.011760708875954151, -0.006029916927218437, -0.004858952946960926, -0.01041099987924099, -0.044299643486738205, -0.039951391518116, 0.020209159702062607, 0.007696990389376879, 0.01625487580895424, 0.013088531792163849, -0.0038266079500317574, -0.00013428695092443377, 0.014350691810250282, 0.026439709588885307, 0.02114301174879074, -0.009739793837070465, 0.003091563703492284, 6.269763980526477e-05, -0.012176565825939178, 0.01752433180809021, -0.017349235713481903, 0.029912473633885384, -0.011957693845033646, 0.006401998922228813, -0.01686771772801876, -0.045145947486162186, -0.007160754408687353, -0.007587554398924112, 0.00609557842835784, 0.0074708228930830956, 0.03642025962471962, 0.02747570164501667, -0.0016880484763532877, -0.007653215900063515, 0.006245140917599201, 0.047042835503816605, 0.01207442581653595, 0.008900784887373447, 0.014204777777194977, -0.005902241915464401, 0.029883291572332382, 0.03361870348453522, 0.04856034740805626, -0.01882297173142433, 0.0427529513835907, 0.007219120394438505, -0.018297679722309113, -0.000192310762940906, -0.039075903594493866, -0.019012659788131714, 0.006923643406480551, 0.0008736631134524941, 0.04365761950612068, -0.0034764131996780634, 0.01807880774140358, 0.015583669766783714, 0.021449431777000427, 0.0027741994708776474, 0.00523833092302084, 0.03773349151015282, -0.021391067653894424, 0.022397877648472786, 0.010359929874539375, -0.018998069688677788, -0.02101168967783451, 0.01055691484361887, -0.024294765666127205, -0.005438963416963816, -0.014649816788733006, -0.033297691494226456, 0.01462063379585743, 0.05299614742398262, -0.03204282745718956, -0.010199423879384995, 0.028146907687187195, 0.005158077925443649, 0.009433372877538204, 0.02929963357746601, 0.0011317493626847863, 0.016065187752246857, -0.004942853935062885, 0.03636189550161362, 0.012949912808835506, 0.031371619552373886, 0.011716934852302074, 0.013394951820373535, -0.02317122370004654, 0.023273363709449768, 0.04450392350554466, -0.004709390923380852, -0.037412479519844055, -0.0276653915643692, -0.010338042862713337, -0.0061430009081959724, 0.009506329894065857, 0.021478615701198578, 0.03913427144289017, 0.01249757781624794, -0.005730792414397001, 0.0032721329480409622, -0.02330254763364792, -0.014423648826777935, -0.006040860433131456, 0.025870641693472862, 0.013905652798712254, 0.003928747959434986, 0.030554497614502907, 0.009170726872980595, -0.006650053896009922, 0.0015840843552723527, -0.016240283846855164, 0.009221796877682209, -0.01334388181567192, -0.012847772799432278, 0.00350741995498538, 0.004793291445821524, 0.010352633893489838, -0.017451375722885132, 0.023317137733101845, -0.02600196562707424, 0.012329775840044022, -0.008331718854606152, -0.006982009392231703, -0.0093020498752594, 0.0006830623024143279, -0.008725687861442566, 0.012110903859138489, -0.005716200917959213, 0.01971304975450039, -0.014613337814807892, 0.009075882844626904, -0.004129380453377962, -0.0021923654712736607, 0.09887167066335678, -0.02600196562707424, -0.02209145575761795, 0.019654683768749237, -0.008258760906755924, -0.0004211001505609602, -0.010447478853166103, -0.015423163771629333, -0.0009101417381316423, -0.009717905893921852, -0.009944073855876923, 0.033793799579143524, 0.012979095801711082, -0.008105550892651081, 0.027227647602558136, -0.0010597041109576821, 0.015714991837739944, 0.010804968886077404, 0.0020847534760832787, 0.01570040173828602, 0.010440182872116566, 0.02924126759171486, -0.02101168967783451, -0.0009593878639861941, -0.01915857568383217, 0.024075893685221672, -0.006496843416243792, 0.01921693980693817, 0.038842443376779556, 0.048998091369867325, -0.010965474881231785, -0.0061575924046337605, -0.0145184937864542, 0.005019458942115307, -0.006223253905773163, 0.013110418803989887, -0.02718387357890606, 0.014452831819653511, -0.035749055445194244, -0.018677057698369026, 0.001127189607359469, 5.588639760389924e-05, -0.014686294831335545, 0.018983477726578712, -0.03151753544807434, 0.03268485143780708, 0.010454774834215641, -0.0006365520530380309, -0.005209147930145264, -0.002719481708481908, 0.004818826448172331, 0.00014089870091993362, -0.006493195425719023, -0.03420235961675644, -0.01336576882749796, 0.002329160226508975, 0.0044248574413359165, 0.03706228360533714, 0.020763633772730827, 0.02225196175277233, -0.0248346496373415, -0.0069966004230082035, -0.02855546958744526, 0.013066643849015236, -0.006259732414036989, -0.032188739627599716, -0.01945040374994278, 0.0006219606148079038, -0.020792817696928978, -0.008076367899775505, -0.012599717825651169, 0.02013620175421238, -0.009075882844626904, -0.027971811592578888, 0.0038886216934770346, 0.021916359663009644, -0.012256818823516369, 0.0020409792196005583, 0.0316634476184845, 0.05859926715493202, -0.00871109589934349, -0.01502919476479292, -0.011687751859426498, -0.014737364836037159, -0.010724715888500214, -0.03983465954661369, 0.004249759949743748, -0.018968885764479637, -0.02320040762424469, 0.010323451831936836, -0.029022395610809326, -0.017115771770477295, 0.02979574166238308, -0.007653215900063515, -0.001674368977546692, 0.0276653915643692, -0.020209159702062607, -0.0034198712091892958, 0.013270924799144268, -0.02238328568637371, -0.005187260918319225, -0.012249522842466831, -0.036303531378507614, -0.019727641716599464, -0.02538912370800972, -0.001220210106112063, -0.027986401692032814, 0.002079281723126769, 0.007051318418234587, -0.007923157885670662, 0.013314698822796345, 0.0022598509676754475, 0.04053505137562752, 0.018545733764767647, 0.006405646912753582, 0.028964029625058174, 0.020092427730560303, 0.018677057698369026, 0.008623547852039337, -0.04508758336305618, 0.02515566162765026, 0.016036003828048706, 0.037908587604761124, -0.02013620175421238, -0.011921214871108532, -0.003906860947608948, 0.001807515975087881, -0.006730306893587112, -0.010403704829514027, -0.025564221665263176, 0.0021485912147909403, 0.007492709904909134, 0.023959161713719368, -0.021361883729696274, -0.006770433392375708, 0.04937747120857239, -0.0070549664087593555, -0.02114301174879074, -0.018545733764767647, -0.020705267786979675, 0.039893027395009995, 0.0040673669427633286, -0.0027960867155343294, -0.015496120788156986, -0.000665278930682689, -0.010856039822101593, 0.0089591508731246, 0.00497568491846323, 0.010877926833927631, -0.0024057654663920403, 0.014182889834046364, -0.03335605561733246, -0.02095332369208336, 0.008754870854318142, -0.004278942942619324, -0.00752189289778471, -0.014890575781464577, -0.026162471622228622, 0.014905166812241077, 0.01818094775080681, 0.0077407644130289555, -0.02473250962793827, 0.015933863818645477, 0.030787961557507515, 0.0207490436732769, -0.025214027613401413, -0.020355073735117912, 0.0040235924534499645, 0.025170251727104187, -0.011425105854868889, 0.002730425214394927, 0.017407601699233055, -0.003370625199750066, 0.014803026802837849, 0.0032830764539539814, -0.02362355962395668, -0.020544761791825294, -0.002859924454241991, -0.012636196799576283, 0.03449419140815735, 0.0036478627007454634, -0.002812502207234502, -0.019654683768749237, 0.03755839541554451, 0.0007614913629367948, -0.00032283584005199373, 0.000583202054258436, -0.001846730476245284, -3.3657233871053904e-05, -0.013555457815527916, 0.040768515318632126, -0.0026209894567728043, 0.020997097715735435, 0.018968885764479637, 0.004961093422025442, 0.044912487268447876, 0.005453554913401604, 0.02813231758773327, -0.00010499004565645009, 0.022572973743081093, -0.015773357823491096, 0.000823049049358815, -0.017042813822627068, 0.013030165806412697, 0.02665857970714569, 0.020107019692659378, -0.0038594387006014585, 0.011775300838053226, 0.015087559819221497, -0.001818459597416222, 0.036070067435503006, -0.03396889567375183, -0.03393971547484398, 0.00802529789507389, -0.00042930783820338547, 0.018385227769613266, -0.013030165806412697, -0.004778699949383736, -0.02042803168296814, -0.00889348890632391, 0.001534838229417801, 0.022470833733677864, 0.007828312925994396, -0.004377435427159071, -0.014919758774340153, 0.01130837481468916, 0.0027395449578762054, 0.029051577672362328, 0.004311773926019669, 0.013380360789597034, 0.014022383838891983, -0.0009593878639861941, -0.017903709784150124, -0.0021832457277923822, 0.037908587604761124, 0.009323936887085438, -0.010826856829226017, 0.002589982468634844, 0.026279203593730927, 0.0011436049826443195, -0.0158609077334404, 0.010804968886077404, -0.01098006684333086, -0.011461584828794003, -0.010082692839205265, 0.030729595571756363, 0.0028635722119361162, 0.008083663880825043, -0.02053017169237137, -0.006777728907763958, 0.0016415382269769907, 0.0034983002115041018, 0.006190422922372818, -0.035719871520996094, 0.018968885764479637, -0.03256811946630478, 0.0016296826070174575, -0.01360652782022953, -0.005708904936909676, -0.008441153913736343, -0.029737377539277077, -0.004184098448604345, 0.02473250962793827, -0.021843401715159416, -0.00944796483963728, 0.00465832045301795, -0.02557881362736225, -0.0007309404900297523, -0.038842443376779556, 0.017071997746825218, -0.008003410883247852, 0.021420249715447426, -0.011512654833495617, -0.0006497755530290306, 0.017144953832030296, 0.01109679788351059, -0.013548161834478378, -0.0072118244133889675, -0.03846306353807449, -0.01631324179470539, -0.0034089277032762766, -0.008703800849616528, -0.041001975536346436, -0.012935320846736431, 0.0038776779547333717, 0.027300603687763214, 0.01605059579014778, 0.014051566831767559, -0.008528702892363071, 0.0036952849477529526, 0.011600203812122345, 0.026425117626786232, -0.012687266804277897, -0.03922181949019432, 0.004399322438985109, 0.006526026409119368, -0.031575899571180344, -0.009389598853886127, -0.019304489716887474, 0.025826867669820786, 0.03233465552330017, -0.0035092439502477646, 0.0002911450283136219, 0.01285506784915924, 0.028336597606539726, -0.02956227958202362, -0.006744897924363613, 0.036040883511304855, 0.0022343159653246403, 0.026716945692896843, -0.004173154942691326, 0.009747088886797428, 0.003277604700997472, 0.01505837682634592, 0.01285506784915924, 0.014117228798568249, -0.00244771596044302, 0.021551573649048805, -0.004512405954301357, 0.039367735385894775, -0.02662939764559269, -0.004227872937917709, 0.009652244858443737, -0.02179962769150734, 0.04605061933398247, -0.028730565682053566, -0.01971304975450039, 0.01647374778985977, 0.051449455320835114, -0.026906635612249374, 0.03268485143780708, 0.009980551898479462, 0.036566175520420074, -0.008506815880537033, -0.0093166409060359, 0.024396905675530434, 0.012468394823372364, 0.036595359444618225, 0.012358958832919598, -0.03787940740585327, -0.03598251938819885, 0.006828798912465572, -0.006883516907691956, -0.02594359964132309, -0.022966943681240082, 0.01200876384973526, -0.005628651939332485, -0.017772387713193893, -0.02565176971256733, -0.016823941841721535, -0.0011654921108856797, 0.017276277765631676, 0.04832688346505165, 0.005081472918391228, 0.025958191603422165, 0.012818589806556702, 0.00710603641346097, 0.0344650074839592, -0.0022452594712376595, -0.008587068878114223, -0.008929967880249023, -0.03475683555006981, 0.028570061549544334, 0.007704285904765129, 0.0018877689726650715, -0.007248303387314081, -0.002708537969738245, -0.04219847545027733, 0.006923643406480551, -0.03750002756714821, -0.006485899910330772, 0.027140097692608833, 0.0010897989850491285, 0.010739307850599289, -0.014007792808115482, -0.0057563274167478085, -0.0051690214313566685, 0.018910519778728485, 0.00744893541559577, -0.012140086852014065, 0.013810807839035988, -0.02842414565384388, -0.008346309885382652, -0.002909170463681221, 0.02121596969664097, -0.0017637416021898389, -0.008295239880681038, 0.01037452183663845, -0.01605059579014778]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"39 4.79 13.06 1.60 X1.77 X
Table 3: Compare the effectiveness of both lookahead and
verification branch on MT-Bench on A100. FlashAttention
is activated. We show the speedups against autoregressive
decoding and the compression ratio ( S).
TAG SETTING (N, W, G) Prompt as Ref. SPEEDUPS S
① AUTOREGRESSIVE ✗ 1.00 X 1.00
② PROMPT LOOKUP ✓ 1.44 X 1.55
③ (10, 1, 3) ✓ 1.36 X 1.45
④ (5, 1, 10) ✓ 1.36 X 1.51
⑤ (5, 1, 30) ✗ 1.04 X 1.12
⑥ (5, 1, 30) ✓ 1.46 X 1.59
⑦ (5, 30, 1) ✗ 1.61 X 1.79
⑧ (5, 15, 15) ✗ 1.78 X 1.96
⑨ (5, 15, 15) ✓ 1.88 X 2.05
5.3. Generation Quality of L OOKAHEAD DECODING
We assess the generation quality of LOOKAHEAD DECOD -
INGon LLaMA-2-7B-Chat model with the prompts in Ap-
pendix D on summarization datasets (Chen et al., 2023;
Leviathan et al., 2023) in Tab. 2. Whether the sampling is
activated, LOOKAHEAD DECODING can reserve the output
distribution quality, which is evaluated in rouge-1, rouge-
2, and rouge-L (Lin, 2004), while achieving 1.46x-1.60x
speedups compared with autoregressive decoding. Using
sampling gives smaller speedups as the acceptance ratio is
lower according to the sampling verification algorithm 4,
which aligns with the results in the previous research (Chen
et al., 2023; Leviathan et al., 2023). We further verify that
using greedy sampling and advanced integrations will not
change the generation quality in Appendix E.
7
Lookahead decoding
5.4. Ablation Study
In this section, we study the importance of the lookahead
and verification branch in achieving a high speedup. We
experiment on LLaMA-2-7B-Chat and MT-Bench on S1
with various settings. The results are shown in Tab. 3.
We ablate the importance of lookahead branch by com-
paring the performance of using a lookahead branch to
the recent methods of using prompts as reference (Yang
et al., 2023; Saxena, 2023). This comparison assumes
that LOOKAHEAD DECODING does not use the prompt
to build the n-gram pool. We use the implementation in
transformers v4.37 of prompt lookup as a baseline ( ②, with
prompt lookup num tokens=10). We also use prompt to
build n-gram pool to augment LOOKAHEAD DECODING
(③④⑥⑨ ). The results show that although using a mini-
mal lookahead branch ( W= 1) with various N, G settings
(③④⑤⑥ ) can obtain a decent speedup on MT-Bench, it is
still not as good as using balanced branches ( ⑧). We can
find that prompt lookup can surpass prompt as reference
implementation in LOOKAHEAD DECODING . This is be-
cause our method checks if n-gram starts with onetoken
that exactly matches the last generated token while prompt
lookup in transformers v4.37 checks several starting tokens
for a better speculation.
We ablate the importance of verification branch by reporting
the speedup of using a tiny verification branch and a large
lookahead branch ( ⑦,G= 1) . It shows lower performance
due to lower potential in accepting speculations compared
with a balanced branches ( ⑧).
Besides, our evaluation shows that using prompt as reference
can further boost LOOKAHEAD DECODING (⑧and⑨). We
have integrated them in our implementation.
5.5. Discussion and Limitation
Table 4: Good Config. of
LOOKAHEAD DECODING on
A100 GPUs with G=W.
MODEL WINDOW SIZE(W) N- GRAM SIZE(N)
7B 15 5
13B 10 5
34B 7 5The main limitation of
LOOK","[0.021789003163576126, 0.01834038458764553, 0.04054740443825722, -0.0018729007570073009, -0.04566808044910431, 0.01598905399441719, 0.01892821677029133, 0.024297090247273445, -0.005894657224416733, 0.013049889355897903, 0.048228420317173004, 0.013912043534219265, -0.04835904762148857, 0.03393755108118057, -0.031168203800916672, -0.026713736355304718, 0.0206525269895792, -0.0497959740459919, 0.0210444163531065, 0.039554618299007416, -0.004408746492117643, -0.006805798038840294, 0.012220392003655434, 0.05679771676659584, 0.013964295387268066, -0.01796155981719494, -0.01938542164862156, 0.009712304919958115, 0.05222568288445473, -0.051729291677474976, -0.016550760716199875, -0.033467281609773636, 0.005852202419191599, -0.03456456959247589, -0.005806481931358576, 0.021802067756652832, 0.05721573159098625, -0.005852202419191599, -0.02161918580532074, -0.003438822226598859, 0.014447624795138836, -0.007641826756298542, -0.035243842750787735, 0.007596106734126806, -0.01075080968439579, 0.030619559809565544, 0.010999005287885666, -0.0001806361397029832, -0.03884921967983246, 0.0476275235414505, -0.0553346648812294, 0.06432197242975235, -0.041331179440021515, 0.013017231598496437, -0.012782098725438118, -0.0034290249459445477, -0.02381376177072525, -0.009163660928606987, 0.04893381893634796, 0.018562454730272293, 0.012644937261939049, -0.032657381147146225, -0.016864271834492683, 0.006720888894051313, -0.0015585734508931637, -0.05311396345496178, -0.014081861823797226, 0.021253423765301704, -0.008255785331130028, 0.014917891472578049, -0.028842998668551445, 0.02300385758280754, 0.016550760716199875, -0.0484112985432148, -0.03929335996508598, 0.037699680775403976, 0.05502115562558174, 0.05097163841128349, 0.032970890402793884, -0.03226549178361893, 0.008138218894600868, 0.004702662583440542, -0.007053994107991457, -0.039136603474617004, 0.012442462146282196, -0.033049266785383224, 0.011103508993983269, -0.012057105079293251, -0.00744588254019618, -0.02438853122293949, -0.039241109043359756, 0.030645685270428658, -0.007798582315444946, 0.029391642659902573, 0.03234386816620827, 0.030070915818214417, -0.00878483522683382, -0.028529487550258636, 0.00789655465632677, 0.059096794575452805, 0.05037074163556099, 0.00789655465632677, 0.0316123440861702, -0.046190597116947174, 0.0778551921248436, -0.008758709765970707, 0.013977359049022198, 0.005502768326550722, -0.04480592533946037, 0.013533217832446098, -0.06191839277744293, -0.02197188511490822, -0.06562826782464981, 0.023643942549824715, 0.027771836146712303, -0.023447999730706215, -0.05206892639398575, -0.022337647154927254, 0.015675542876124382, -0.008863212540745735, 0.0073609733954072, 0.031272705644369125, 0.014774198643863201, -0.01212241966277361, 0.007942275144159794, 0.0008135769749060273, 0.0393194854259491, -0.056902218610048294, 0.019411547109484673, 0.0019643413834273815, 0.009104877710342407, -0.001735739759169519, 0.04093929007649422, -0.02886912412941456, -0.02928713895380497, -0.0058456710539758205, -0.03850958123803139, 0.0188759658485651, -0.0038437736220657825, 0.03631500527262688, -0.019202539697289467, -0.031533967703580856, -0.028999753296375275, 0.007890023291110992, -0.07242100685834885, 0.006296342704445124, -0.04083478823304176, 0.0056627895683050156, -0.012951917015016079, 0.005946909077465534, -0.024479972198605537, -0.045720331370830536, -0.06604628264904022, -0.05972381681203842, -0.012109356932342052, -0.02855561301112175, -0.03783030807971954, 0.0187714621424675, -0.00795533787459135, -0.029313264414668083, 0.008791366592049599, -0.011547649279236794, 0.019359294325113297, -0.02636103704571724, -0.009353073313832283, 0.022912418469786644, -0.07205524295568466, 0.0033931017387658358, -0.06693456321954727, -0.010972879827022552, 0.026648422703146935, -0.00644330121576786, 0.015505723655223846, -0.03236999362707138, 0.016511570662260056, -0.014643569476902485, -0.03696815297007561, -0.02655698172748089, -0.006394315045326948, -0.04538069665431976, -0.030854692682623863, 0.04890769347548485, 0.030541181564331055, 0.019202539697289467, -0.05857427790760994, -0.015701668336987495, -0.00020655793196056038, 0.026465540751814842, -0.01419942919164896, -0.008046778850257397, 0.004673270974308252, 0.03534834831953049, 0.05491665005683899, -0.012964979745447636, 0.00510434852913022, -0.0571112260222435, 0.054812148213386536, -0.006825392600148916, 0.009973564185202122, -0.04713113233447075, 0.030358299612998962, -0.012925790622830391, 0.013859791681170464, -0.040286142379045486, 0.01691652275621891, -0.0258907712996006, -0.0069560217671096325, -0.01764804869890213, -0.009784150868654251, -0.007439351174980402, 0.009261633269488811, -0.017177781090140343, 0.016550760716199875, 0.02262503281235695, -0.027615079656243324, 0.01448681391775608, -0.04075641185045242, 0.016080493107438087, -0.02157999761402607, 0.020717842504382133, 0.0016508306143805385, -0.013173987157642841, 0.017674174159765244, 0.02489798702299595, -0.017621921375393867, 0.08046778291463852, 0.011423551477491856, -0.03746454790234566, 0.009111409075558186, -0.0210444163531065, 0.035583481192588806, -0.006988679524511099, 0.0037262069527059793, -0.019568301737308502, 0.03555735573172569, -0.028686242178082466, 0.02790246531367302, -0.020717842504382133, 0.01695571094751358, -0.04454466700553894, -0.004794103559106588, 0.030384426936507225, 0.014447624795138836, -0.035505104809999466, -0.004150752909481525, 0.019894875586032867, -0.04916895180940628, -0.05904454365372658, 0.019568301737308502, 0.045145563781261444, -0.026465540751814842, -0.02813759818673134, -0.05799950659275055, -0.05149415507912636, -0.05784275010228157, -0.020365141332149506, 0.014695821329951286, 0.06792735308408737, -0.050161734223365784, 0.01626337505877018, -0.023683132603764534, 0.01881065033376217, -0.012853944674134254, 0.039554618299007416, 0.004428340587764978, -0.008229659870266914, 0.022207017987966537, 0.008105562068521976, -0.01741291582584381, -0.0253943782299757, -0.008908933028578758, -0.02080928161740303, 0.03699427843093872, 0.020900722593069077, 0.0011879121884703636, -0.04313386604189873, 0.019973253831267357, -0.025498881936073303, -0.05387161299586296, 0.04381313920021057, -0.0322132408618927, 0.001957810018211603, 0.05523015931248665, 0.0484112985432148, 0.01217467151582241, -0.0008588890777900815, -0.0002804452378768474, -0.0034551508724689484, -0.00830150581896305, 0.0276673324406147, -0.01883677765727043, -0.024179523810744286, 0.013598533347249031, -0.024558350443840027, 0.041331179440021515, -0.0032918639481067657, 0.02350025065243244, 0.019620554521679878, 0.020548023283481598, 0.00510761421173811, 0.04504105821251869, 0.009124471805989742, -0.0007184623391367495, -0.00890240166336298, -0.0010107458801940084, 0.03474745154380798, -0.019202539697289467, 0.024688979610800743, -0.008895870298147202, 0.00890240166336298, -0.014983206056058407, 0.03529609739780426, -0.026465540751814842, -0.013977359049022198, -0.00915059819817543, -0.021841255947947502, 0.0727345198392868, -0.04396989569067955, 0.04237621650099754, -0.035818614065647125, -0.03641951084136963, -0.02126648649573326, -0.0264786034822464, -0.0046438793651759624, -0.009046094492077827, -0.005313355941325426, -0.003277168143540621, 0.007452413905411959, 0.0135854696854949, -0.005610537715256214, 0.013572406955063343, -0.0015275490004569292, 0.011573775671422482, 0.005888125393539667, -0.02677905187010765, -0.01857551746070385, -0.025368252769112587, 0.0271709393709898, -0.008739114739000797, 0.037516798824071884, -0.06714357435703278, -0.0003167765971738845, -0.0069690849632024765, 0.0006400846759788692, -0.041984327137470245, 0.026883555576205254, 0.006430238019675016, 0.028895249590277672, 0.07299577444791794, 0.004033186472952366, 0.0047516487538814545, -0.03033217415213585, 0.03315377235412598, -0.044414035975933075, 0.028686242178082466, 0.013781414367258549, -0.04104379564523697, -0.03968524932861328, -0.020874597132205963, 0.030123166739940643, -0.013271959498524666, 0.000487003184389323, -0.012396741658449173, -0.004385886248201132, -0.0014352918369695544, 0.04438791051506996, -0.03594924509525299, 0.019280917942523956, -0.0030730594880878925, -0.0049671875312924385, 0.020639464259147644, 0.03255287557840347, -0.014251681044697762, -0.02157999761402607, -0.03934561088681221, -0.035165466368198395, -0.008223128505051136, 0.01796155981719494, -0.018052998930215836, 0.051154520362615585, -0.013794477097690105, -0.023408809676766396, -0.014277806505560875, -0.005159866064786911, 0.02189350686967373, 0.006495553068816662, 0.005398265086114407, -0.012266111560165882, -0.03746454790234566, -0.02423177659511566, -0.057790499180555344, -0.012769035995006561, -0.024924112483859062, -0.009646990336477757, 0.020717842504382133, 0.05867877975106239, 0.006890707183629274, 0.022794852033257484, 0.025485819205641747, 0.0626499205827713, 0.024767357856035233, -0.01734760031104088, -0.05193829536437988, -0.034433942288160324, 0.005375404842197895, 0.002592995995655656, -0.009274695999920368, 0.011475803330540657, 0.04958696663379669, 0.03114207834005356, 0.039868131279945374, -0.022324584424495697, 0.011815439909696579, -0.032004233449697495, 0.04088703915476799, -0.041174422949552536, -0.02879074588418007, 0.018248943611979485, 0.026713736355304718, 0.06348595023155212, -0.0018124845810234547, -0.012651468627154827, -0.09368748962879181, -0.021566933020949364, -0.026308786123991013, -0.0033767730928957462, 0.006342063192278147, -0.02191963419318199, 0.03294476494193077, -0.024924112483859062, -0.050919387489557266, 0.018666958436369896, 0.0786389708518982, -0.006377986166626215, -0.043029364198446274, -0.013611596077680588, -0.017595795914530754, 0.05272207409143448, 0.013507092371582985, -0.03989425674080849, -0.04715725779533386, -0.012155076488852501, -0.014526003040373325, -0.01602824218571186, -0.011828502640128136, 0.01614580862224102, -0.005999160930514336, 0.0038470393046736717, 0.04096541926264763, -0.023565566167235374, 0.012272643856704235, 0.007667952682822943, 0.02280791476368904, 0.004513249732553959, -0.029078131541609764, -0.011619496159255505, 0.07419756799936295, -0.02043045684695244, 0.010607116855680943, -0.03148171305656433, 0.014735009521245956, -0.010300138033926487, -0.00901996809989214, 0.027719583362340927, -0.010274011641740799, 0.05627519637346268, 0.012337958440184593, 0.0224290881305933, 0.047026626765728, 0.0032461434602737427, 0.010313200764358044, 0.0001610417093615979, 0.004310774151235819, -0.01098594255745411, 0.00365109508857131, 0.027040310204029083, 0.018523266538977623, -0.02235071174800396, 0.0009307353175245225, -0.01733453758060932, -0.0039809346199035645, -0.023056110367178917, 0.028921375051140785, 0.006864581257104874, -0.018196692690253258, 0.09818115085363388, 0.04511943459510803, -0.00664904247969389, -0.04436178505420685, -0.04261134937405586, -0.008445198647677898, -0.015557975508272648, 0.040782537311315536, -0.01419942919164896, 0.018680021166801453, 0.0003516791621223092, 0.03487808257341385, -0.003683752380311489, 0.024963300675153732, -0.005110879894345999, -0.021828193217515945, 0.024911049753427505, -0.0024966567289084196, 0.03976362571120262, 0.015153024345636368, -0.040521275252103806, 0.005509300157427788, -0.011312516406178474, -0.00041107478318735957, 0.027040310204029083, -0.01679895631968975, -0.00140426738653332, -0.008510513231158257, 0.020286764949560165, -0.018980469554662704, 0.023016922175884247, -0.010202165693044662, 0.028451109305024147, -0.008641142398118973, 0.04083478823304176, 0.010371983982622623, -0.028529487550258636, 0.01144314557313919, -0.0019529113778844476, 0.02201107330620289, -0.026230407878756523, -0.022259270772337914, -0.14996269345283508, -0.035322222858667374, -0.00813168752938509, 0.031089825555682182, -0.020665589720010757, 0.0044740610755980015, -0.010254417546093464, -0.03850958123803139, -0.021057479083538055, 0.00830150581896305, -0.00218151300214231, -0.04705275222659111, -0.0036543607711791992, 0.01895434409379959, 0.011782783083617687, -0.017360663041472435, -0.030462803319096565, -0.010992473922669888, -0.03195197880268097, 0.027197066694498062, 0.0018565719947218895, 0.016785893589258194, -0.006211433559656143, 0.001063814153894782, -0.05815626308321953, 0.023291243240237236, -0.015218338929116726, -0.007994526997208595, 0.015780046582221985, 0.004245459567755461, 0.01830119639635086, 0.007922680117189884, -0.0318213514983654, 0.039789751172065735, -0.0029848844278603792, 0.012109356932342052, -0.014708884060382843, -0.004235662054270506, 0.026073651388287544, 0.0036935496609658003, -0.0025260483380407095, 0.004604690708220005, 0.00593384588137269, -0.011723999865353107, -0.029888033866882324, 0.015322842635214329, 0.00453937565907836, 0.004170347470790148, -0.026909681037068367, 0.035165466368198395, 0.0012989472597837448, -0.027223192155361176, -0.018627770245075226, -0.017556607723236084, -0.03665464371442795, -0.006319202948361635, -0.0042421938851475716, -0.040129389613866806, 0.005159866064786911, -0.001972505822777748, 0.013637721538543701, -0.01015644520521164, 0.022102514281868935, 0.03137721121311188, -0.01873227395117283, -0.004604690708220005, 0.0027954718098044395, -0.020521897822618484, -5.013418103771983e-06, -0.029261011630296707, -0.03195197880268097, -0.022611970081925392, -0.03291863948106766, 0.028451109305024147, 0.0039188857190310955, 0.0016785893822088838, -0.01175012532621622, 0.0012328161392360926, 0.0027236253954470158, -0.041905950754880905, 0.0014116152888163924, 0.05826076492667198, -0.0025619715452194214, 0.001066263415850699, 0.02493717521429062, -0.01965974271297455, -0.014930954203009605, -0.015531850047409534, 0.0211489200592041, -0.006942959036678076, -0.019751183688640594, 0.052382439374923706, -0.0020035302732139826, 0.022442150861024857, -0.01853632926940918, 0.040599655359983444, -0.0008050044416449964, 0.026191219687461853, 0.006766608916223049, -0.014055736362934113, -0.038666337728500366, 0.0002071702474495396, 0.007413225248456001, -0.02077009342610836, -0.004738586023449898, 0.003837242256850004, 0.010881438851356506, 0.017556607723236084, -0.00043475136044435203, 0.021762877702713013, 0.007413225248456001, 0.009666584432125092, -0.021514682099223137, -0.017817866057157516, 0.019437672570347786, -0.03579248860478401, -0.020260637626051903, -0.0059077199548482895, -0.007818176411092281, -0.00525130657479167, 0.012187734246253967, -0.0044609978795051575, -0.04715725779533386, -0.022533591836690903, -0.028842998668551445, 0.06740482896566391, 0.01780480332672596, 0.0322132408618927, -0.00907875131815672, -0.0258907712996006, -0.011952601373195648, 0.021802067756652832, 0.005721572786569595, -0.0357663631439209, 0.02100522629916668, -0.06108236312866211, -0.0025309468619525433, -0.01656382344663143, 0.03762130066752434, -0.01221385970711708, 0.04253297299146652, 0.0025293140206485987, -0.02023451216518879, -0.02126648649573326, 0.009784150868654251, 0.04313386604189873, 0.0014744807267561555, -0.03252675011754036, -0.0031236784998327494, -0.01038504671305418, -0.04240234196186066, 0.00024186872178688645, 0.015074647031724453, -0.03430331125855446, 0.011671748012304306, -0.06359045207500458, -0.01895434409379959, -0.00938573107123375, 0.03158621862530708, 0.034355562180280685, -0.0009201216744259, 0.0033000281546264887, -0.022180892527103424, -0.00644656689837575, 0.007256469689309597, 0.022651158273220062, -0.009816808626055717, 0.006084070075303316, 0.0024068488273769617, -0.00010736113472376019, 0.04135730490088463, -0.006580462213605642, -0.04007713496685028, -0.01630256325006485, 0.021802067756652832, 0.022677285596728325, -0.008647673763334751, 0.0053198873065412045, -0.04867256060242653, -0.007968400605022907, 0.030279923230409622, 0.03843120485544205, -0.0422978401184082, -0.033310528844594955, 0.018392635509371758, -0.03466907516121864, 0.019489923492074013, -0.0037751931231468916, 0.006071006879210472, -0.01803993619978428, -0.021632248535752296, 0.003233080729842186, -0.009516360238194466, -0.047418516129255295, 0.005127208773046732, 0.014917891472578049, 0.0026125903241336346, -0.02454528771340847, -0.007772456388920546, 0.03495645895600319, 0.04389151930809021, -0.007080120034515858, 0.06045534089207649, 0.018288133665919304, 0.018196692690253258, 0.018941279500722885, -0.046112220734357834, -0.013990421779453754, 0.03785643354058266, -0.04739239066839218, -0.006093867123126984, -0.006456363946199417, -0.023134488612413406, 0.02312142588198185, -0.023225927725434303, 0.011952601373195648, 0.029078131541609764, -0.014878702349960804, -0.0194637980312109, 0.002542376983910799, 0.022298458963632584, -0.005525628570467234, -0.029888033866882324, -0.02543356828391552, 0.01163909025490284, -0.01845795102417469, -0.03702040761709213, 0.008007589727640152, 0.011364768259227276, 0.01562329102307558, -0.02543356828391552, -0.008654206059873104, 0.005264369770884514, 0.011710936203598976, -0.003402899019420147, -0.020012442022562027, 0.0009405325399711728, 0.0084974505007267, 0.001637767651118338, -0.050083357840776443, -0.03534834831953049, 0.016942648217082024, 0.022259270772337914, 0.013898980803787708, -0.0044609978795051575, 0.05159866064786911, 0.022912418469786644, 0.05329684540629387, -0.03503483906388283, 0.024362405762076378, -0.006335531827062368, -0.002491758204996586, 0.033624038100242615, -0.0434735044836998, 0.015348969027400017, -0.02323899231851101, 0.0015577570302411914, -0.02207638882100582, 0.016015179455280304, -0.002401950303465128, 0.01969893090426922, -0.01135170552879572, -0.014029610902071, 0.008229659870266914, -0.03284026309847832, -0.005313355941325426, 0.0176872368901968, 0.01695571094751358, 0.022220080718398094, -0.019254790619015694, -0.15247078239917755, -0.008647673763334751, 0.03827444836497307, -0.03634113073348999, -0.01602824218571186, -3.513219780870713e-05, 0.015819234773516655, 0.023408809676766396, -0.023225927725434303, 0.010032347403466702, 0.01525752805173397, -0.027615079656243324, -0.02555113472044468, -0.028816871345043182, 0.0009601269848644733, -0.06547151505947113, 0.010737746953964233, 0.0035694516263902187, 0.045955464243888855, -0.012906196527183056, -0.01738678850233555, -0.007909617386758327, 0.0040887040086090565, 0.031429462134838104, 0.007863896898925304, -0.02146242931485176, -0.01419942919164896, -0.001161786261945963, -0.0004804717027582228, 0.013650785200297832, -0.016315627843141556, 0.01958136446774006, 0.009842934086918831, 0.021161982789635658, -0.030933070927858353, -0.016655264422297478, -0.031272705644369125, -0.02189350686967373, 0.02636103704571724, -0.03244837373495102, -0.01849713921546936, -0.0210444163531065, 0.0224290881305933, -0.03607987239956856, 0.016733640804886818, -0.008915464393794537, 0.00986252911388874, -0.012762503698468208, 0.01169787347316742, -0.01999937929213047, 0.012017915956676006, 0.006214699242264032, -0.016472382470965385, -0.009242038242518902, 0.005146802868694067, -0.00920938141644001, -0.003025706158950925, -0.0024427720345556736, 0.018719209358096123, 0.00967311579734087, 0.013324211351573467, 0.04598158970475197, 0.04869868606328964, -0.019398484379053116, 0.006929895840585232, -0.02404889464378357, -0.00125485984608531, 0.03171684592962265, -0.004294445272535086, -0.02201107330620289, -0.015597164630889893, -0.012383678928017616, -0.017700299620628357, 0.01656382344663143, 0.0014630506047978997, 0.028033094480633736, -0.00564646115526557, 0.017256159335374832, -0.04958696663379669, 0.016746703535318375, 0.04535457119345665, -0.05752924084663391, 0.00943798292428255, 0.008229659870266914, -0.01163909025490284, 0.01525752805173397, 0.010770403780043125, -0.01930704340338707, -0.015048520639538765, 0.004833292216062546, 0.017478229478001595, 0.005924048833549023, -0.008033715188503265, 0.01668138988316059, -0.0037849904038012028, -0.022834040224552155, -0.0013805907219648361, 0.02266422100365162, 0.028764620423316956, 0.010783466510474682, 0.022860165685415268, 0.030149294063448906, -0.022442150861024857, -0.04966534301638603, 0.006351860240101814, -0.008484387770295143, -0.0016598113579675555, -0.015557975508272648, 0.009568612091243267, -0.004212801810353994, 0.0020655791740864515, 0.011704404838383198, -0.004154018592089415, 0.038091566413640976, -0.0008401111117564142, 0.03317989781498909, 0.024336280301213264, -0.00450998404994607, 0.027223192155361176, -0.03425106033682823, -0.004170347470790148, 0.021684499457478523, -0.03555735573172569, -0.02485879696905613, -0.018092188984155655, -0.0025293140206485987, 0.03918885439634323, -0.001503055915236473, 0.008993842639029026, -0.009202850051224232, -3.656095577753149e-05, 0.004621019121259451, -0.01080959290266037, -0.007374036591500044, -0.01443456206470728, -0.013030294328927994, -0.013859791681170464, 0.010594054125249386, -0.01500933151692152, 0.010176039300858974, 0.00730219017714262, 0.0005057811504229903, 0.01800074800848961, 0.005303558427840471, -0.007837771438062191, -0.008053310215473175, -0.022180892527103424, -0.016772830858826637, -0.03850958123803139, 0.009170192293822765, 0.01780480332672596, -0.0049214670434594154, -0.013794477097690105, 0.01235102117061615, 0.006544538773596287, 0.022794852033257484, -0.008373351767659187, -0.05003110691905022, -0.012357552535831928, 0.006681699771434069, 0.04297711327672005, 0.03025379590690136, 0.001168317743577063, 0.02142324112355709, 0.010992473922669888, 0.005326418671756983, -0.060716599225997925, 0.014369247481226921, -0.024153398349881172, 0.009176723659038544, -0.032970890402793884, 0.0039809346199035645, 0.053662605583667755, 0.027797961607575417, 0.03592311963438988, 0.027536703273653984, 0.007870428264141083, 0.013402588665485382, 0.010783466510474682, 0.007374036591500044, -0.01792236976325512, 0.03009704127907753, 0.018941279500722885, -0.000902160129044205, 0.010371983982622623, -0.0035955775529146194, 0.01726922206580639, 0.007615700829774141, -0.004441403783857822, 0.016367878764867783, 0.0010760606965050101, 0.019098035991191864, -0.005297027062624693, 0.037203285843133926, -0.011567244306206703, 0.00596323749050498, 0.010358921252191067, 0.009111409075558186, -0.01803993619978428, 0.010509144514799118, -0.008281911723315716, 0.02150161936879158, -0.00907221995294094, -0.024140335619449615, -0.03041055239737034, 0.01695571094751358, -0.009006905369460583, -0.023147551342844963, -0.007289127446711063, 0.04488430172204971, -0.014264743775129318, 0.011299453675746918, -0.03114207834005356, 0.018092188984155655, -0.025146182626485825, 0.009451045654714108, 0.013755288906395435, -0.0019431140972301364, 0.002736688358709216, -0.009215912781655788, -0.04561582952737808, -0.019777309149503708, -0.015466535463929176, -0.0006804981385357678, 0.012723315507173538, 0.027406074106693268, 0.026909681037068367, -0.021318737417459488, -0.016198061406612396, 0.011939537711441517, 0.012860476039350033, -0.02201107330620289, -0.0050292364321649075, -0.010228291153907776, -0.03210873529314995, -0.010358921252191067, -0.009588207118213177, -0.008138218894600868, -0.01764804869890213, -0.01092715933918953, 0.03683752566576004, -0.012377146631479263, -0.019790371879935265, 0.0035694516263902187, 0.018170565366744995, 0.0077071418054401875, 0.00715849781408906, 0.033075395971536636, -0.0038633679505437613, 0.011972195468842983, -0.017974622547626495, 0.006626182235777378, 0.05517790839076042, -0.02272953651845455, 0.011364768259227276, 0.01572779379785061, 0.022899355739355087, 0.027641206979751587, 0.02743219956755638, 0.04099154472351074, -0.02077009342610836, 0.01749129220843315, -0.013572406955063343, -0.030279923230409622, -0.022990794852375984, 0.0033473814837634563, -0.021449366584420204, 0.012938854284584522, 0.01103819441050291, 0.009242038242518902, 0.006407377775758505, 0.034512318670749664, 0.0005780356004834175, 0.042454592883586884, -0.01764804869890213, -0.012050572782754898, 0.007850834168493748, -0.02416646108031273, -0.015819234773516655, 0.009940906427800655, -0.013598533347249031, -0.013389525935053825, -0.021449366584420204, -0.01999937929213047, -0.031115951016545296, -0.031925853341817856, -0.03665464371442795, -0.002650146372616291, 0.04540682211518288, -0.007112777326256037, 0.01738678850233555, 0.02962677553296089, -0.01123413909226656, 0.006897238548845053, 0.013938169926404953, -0.01930704340338707, -0.008386415429413319, 0.0050618937239050865, 0.012703720480203629, -0.010783466510474682, 0.0013912044232711196, 0.04415277764201164, 0.012749440968036652, -0.05413287132978439, 0.03406817838549614, 0.02832048013806343, 0.008582359179854393, -0.03090694360435009, -0.003546591382473707, -0.01883677765727043, -0.03166459500789642, 0.047732025384902954, 0.02501555345952511, 0.006038349587470293, -0.00011746451491490006, 0.001721043954603374, 0.02389214001595974, -0.035243842750787735, 0.026961933821439743, -0.009653521701693535, 0.025485819205641747, 0.0023268384393304586, -0.009000374004244804, 0.02150161936879158, 0.0053525445982813835, -0.01626337505877018, -0.004983516409993172, 0.01001928374171257, 0.00784430280327797, 0.0019463798962533474, 0.001944746938534081, 0.009000374004244804, 0.010600585490465164, -0.0035563886631280184, -0.010136851109564304, 0.01271678414195776, -0.02732769586145878, 0.027379946783185005, 0.01129292231053114, -0.0009209380950778723, 0.00035453669261187315, 0.021867381408810616, -0.012396741658449173, 0.02316061407327652, -0.0032102204859256744, 0.02832048013806343, -0.0003761721891351044, -0.00647269282490015, 0.006492286920547485, -0.0026811708230525255, 0.06609853357076645, -0.034198809415102005, -0.028842998668551445, 0.030959196388721466, -0.008406009525060654, -0.001499790232628584, -0.014865639619529247, -0.02612590417265892, -0.0385357066988945, 0.005394999403506517, -0.008824024349451065, 0.02913038246333599, 0.002632184885442257, 0.003363710129633546, 0.025577260181307793, -0.002357862889766693, -0.016942648217082024, 0.01907191053032875, 0.04605996981263161, 0.014408435672521591, 0.025263749063014984, 0.024558350443840027, -0.00365109508857131, 0.03406817838549614, -0.0294438935816288, 0.014016547240316868, 0.02369619533419609, 0.01661607436835766, 0.04164469242095947, 0.039789751172065735, 0.018784524872899055, -0.008549702353775501, -0.013023762963712215, 0.01252737082540989, -0.02701418474316597, -0.0016549127176404, -0.009758025407791138, 0.03391142189502716, -0.0121028246358037, -0.0399203822016716, 0.010829186998307705, -0.0040756408125162125, 0.020260637626051903, 0.002762814285233617, -0.014225554652512074, 0.015192213468253613, 0.006348594557493925, -0.014957079663872719, -0.007674484513700008, 0.004542641341686249, 0.019320106133818626, -0.004996579140424728, 0.014735009521245956, -0.012507776729762554, -0.0009225709945894778, -0.03895372152328491, 0.004010326229035854, 0.04201045259833336, 0.006910301744937897, 0.01642013154923916, -0.03764742612838745, 0.018079126253724098, -0.028451109305024147, -0.027693457901477814, -0.01907191053032875, -0.04846355319023132, -0.010842249728739262, 0.030306048691272736, -0.013781414367258549, 0.017295347526669502, -0.0013258896069601178, 0.005016173701733351, 0.0010229924228042364, -0.019176414236426353, 0.0023529641330242157, -0.006916833110153675, -0.02423177659511566, -0.025289874523878098, 0.05191216990351677, 0.04692212492227554, -0.006747014820575714, -0.020404331386089325, -0.003837242256850004, -0.012971511110663414, -0.022363774478435516, 0.01661607436835766, 0.014957079663872719, 0.011547649279236794, 0.004098501056432724, 0.016446257010102272, -0.006005692295730114, -0.01092715933918953, 0.036706894636154175, 0.041905950754880905, 0.01960749179124832, -0.0014989736955612898, -0.03699427843093872, 0.004781040363013744, 0.033702414482831955, -0.01140395738184452, -0.02077009342610836, -0.017870118841528893, -0.011541117914021015, -0.011560712940990925, -0.02088765986263752, -0.009660053066909313, -0.038901470601558685, -0.011959132738411427, 0.024453846737742424, 0.012200796976685524, -0.023252055048942566, -0.027850214391946793, 0.028372731059789658, 0.01525752805173397, 0.014225554652512074, 0.02142324112355709, 0.010803061537444592, 0.019254790619015694, 0.006048146635293961, -0.03788255900144577, 0.03607987239956856, 0.018366510048508644, 0.022533591836690903, 0.009313885122537613, -0.01622418686747551, -0.012285706587135792, -0.013036825694143772, 0.006557601969689131, -0.014552128501236439, -0.008262316696345806, -0.015335905365645885, -0.005009641870856285, 0.02808534726500511, -0.004490389954298735, -0.015701668336987495, 0.04459691792726517, 0.00943798292428255, -0.011051257140934467, -0.017556607723236084, -0.01050261314958334, 0.038326703011989594, 0.04590321332216263, -0.006942959036678076, -0.015714731067419052, -0.006374720484018326, 0.011279858648777008, -0.003572717308998108, -0.009117940440773964, 0.01525752805173397, -0.0007658155518583953, -0.02304304763674736, -0.007080120034515858, 0.012566559948027134, -0.027223192155361176, -0.03137721121311188, -0.0034518849570304155, 0.021227296441793442, -0.024035831913352013, 0.03357178717851639, -0.025133119896054268, 0.036942027509212494, -0.01568860560655594, -0.011286390945315361, 0.042794231325387955, 0.04402214661240578, -0.018275069072842598, -0.012155076488852501, 0.011423551477491856, 0.020561086013913155, 0.005359075963497162, 0.023748446255922318, 0.016707515344023705, -0.025211498141288757, -0.0009968664962798357, -0.023709258064627647, -0.002939164172858, -0.006224496755748987, 0.005496236961334944, -0.027771836146712303, 0.011194949969649315, 0.019829561933875084, -0.009281227365136147, 0.004284648224711418, -0.02015613578259945, 0.00730219017714262, -0.00907875131815672, 0.010332794860005379, -0.0014924422139301896, 0.02262503281235695, 0.00667516840621829, 0.021175045520067215, -0.013859791681170464, -0.009836402721703053, 0.015923738479614258, -0.008928528055548668, 0.03195197880268097, -0.008562765084207058, 0.0159106757491827, 0.030880818143486977, 0.0371510349214077, 0.010744278319180012, -0.0031416399870067835, 0.0009780885884538293, 0.028607865795493126, 0.009758025407791138, 0.026465540751814842, -0.0240097064524889, 0.011181887239217758, 0.024440784007310867, 0.00605141231790185, 0.005381936207413673, -0.01021522842347622, -0.005773824639618397, 0.008621548302471638, 0.025093931704759598, -0.007916148751974106, 0.01810525171458721, -0.018640832975506783, -0.02847723476588726, -0.02235071174800396, 0.002844457747414708, 0.010946753434836864, 0.00023268382938113064, 0.0015871486393734813, -0.04224558547139168, 0.02559032291173935, 0.006851518526673317, 0.013324211351573467, -0.010358921252191067, 0.020143071189522743, 0.0002692192792892456, -0.018941279500722885, 0.005741167347878218, -0.008399478159844875, 0.0020982366986572742, 0.00536560732871294, -0.02424483932554722, -0.02211557701230049, 0.004562235902994871, 0.020247574895620346, -0.04666086286306381, 0.030697938054800034, 0.006923364475369453, -0.0063061402179300785, -0.007622232660651207, 0.05653645470738411, 0.030488930642604828, -0.001132394652813673, -0.02377457171678543, 0.03730779141187668, 0.005590943619608879, 0.026099778711795807, -0.0038698995485901833, -0.028268227353692055, -0.0004535293555818498, -0.044832050800323486, -0.00867380015552044, -0.023800699040293694, 0.013265428133308887, 0.018941279500722885, -0.013049889355897903, -0.025903834030032158, 0.010371983982622623, 0.01448681391775608, -0.004911669995635748, 0.015283653512597084, -0.024767357856035233, -0.0031596014741808176, -0.03163846954703331, 0.032082609832286835, 0.019124161452054977, -0.009999689646065235, -0.009411856532096863, 0.0030012133065611124, 0.0367591455578804, 0.031194329261779785, -0.02596914768218994, -0.018471013754606247, -0.02108360454440117, 7.035368980723433e-06, 0.038587961345911026, 0.02446690946817398, -0.01753048226237297, -0.0033604444470256567, -0.0106201795861125, 0.01568860560655594, -0.0013601798564195633, 0.000279424712061882, -0.012801692821085453, -0.0011046358849853277, 0.012109356932342052, 0.009451045654714108, -0.0036543607711791992, -0.018562454730272293, -0.011652152985334396, -0.0010858578607439995, -0.002664842177182436, -0.005003110505640507, -0.023944390937685966, -0.00017339027544949204, 0.0027121955063194036, -0.0038796968292444944, 0.004843089263886213, 0.001894128043204546, 0.010162976570427418, 0.009424920193850994, -0.0010238088434562087, 0.05961931124329567, 0.021606123074889183, 0.0015634720912203193, -0.0004269952478352934, -0.0028493565041571856, 0.01800074800848961, 0.0017928901361301541, -0.004346697125583887, -0.007818176411092281, -0.007060525473207235, 0.024571413174271584, -0.029156509786844254, 0.04566808044910431, -0.016276437789201736, 0.005734635982662439, -0.03388529643416405, -0.00519252335652709, 0.05742473527789116, -0.004741851706057787, -0.013356868177652359, 0.011906880885362625, 0.032814133912324905, -0.038326703011989594, 0.03542672470211983, 0.012612280435860157, 0.036393385380506516, -0.011240670457482338, -0.0015977623406797647, 0.046843744814395905, -0.015048520639538765, 0.0010205431608483195, 0.04877706244587898, -0.040286142379045486, -0.030541181564331055, -0.026034463196992874, -0.025342127308249474, -0.018484076485037804, 0.000464551238110289, 0.026413289830088615, -0.04577258229255676, 0.011632558889687061, -0.050161734223365784, 0.002473796484991908, 0.053009457886219025, 0.009085282683372498, 0.018209755420684814, 0.004340165760368109, 0.00519252335652709, 0.02905200608074665, 0.00012501653691288084, 0.017478229478001595, 0.020626401528716087, -0.004327103029936552, -0.035165466368198395, -0.034277185797691345, -0.005101082846522331, 0.0294438935816288, 0.0075242603197693825, 0.016211124137043953, -0.002449303399771452, -0.009307353757321835, 0.0018826979212462902, -0.022912418469786644, -0.02913038246333599, 0.06092560663819313, 0.0073217847384512424, -0.011763188056647778, -0.025106994435191154, -0.011397426016628742, -0.009967032819986343, -0.02057414874434471, 0.0003010602085851133, -0.028895249590277672, 0.006345328874886036, -0.02782408706843853, 0.01895434409379959, 0.003107349621132016, 0.017700299620628357, 0.0002116606483468786, -0.017321474850177765, 0.004029920790344477, -0.02316061407327652]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"AHEAD DECOD -
INGis that it requires ex-
tra computations. Our ex-
perimental results show
that on A100, the config-
uration in Tab. 4 works
near optimally in most cases for single batch serving. Be-
cause the per-step FLOPs are roughly proportional to the
number of per-step input tokens, which is (W+G)∗(N−1).
If we ignore the attention cost’s increase with sequence
length, the 7B, 13B, and 34B models require 120x, 80x,
and 56x extra FLOPs per step, respectively. Since the LLM
decoding is memory bandwidth-bound rather than compute-
bound, these extra FLOPs only turn into a limited wall-clock
slowdown for each step.
Given this, LOOKAHEAD DECODING needs large surplus
W=G=2W=G=5W=G=10W=G=15W=G=301.01.52.0Compression Ratio
Comp. Ratio - RTX3090
Comp. Ratio - A100
Speedups - RTX3090
Speedups - A100
1.01.52.0
SpeedupsFigure 8: Compression ratio( S) and speedups of LOOKA -
HEAD DECODING on RTX 3090 and A100 with N= 5,
all with FlashAttention. The blue and orange curves of S
overlap as the device does not affect the ratio.
FLOPs to obtain high speedups. Running in compute-bound
environments (e.g., serving with a large batch size) may
cause slowdowns. Another example is shown in Fig. 8,
where lower speedup is observed when the GPU’s cap
FLOPs is smaller (e.g., on RTX 3090 GPUs).
Based on §4, we need to exponentially increase the per-step
FLOPs to obtain a linear reduction in decoding steps. Hence,
the setting in Tab. 4 faces a diminishing return. However,
when FLOPs are not rich, we see that a gentle speedup (e.g.,
30% on RTX 3090 and >50% on A100) on MT-Bench
easily achievable, as in Fig. 8, which is a free lunch that
requires no extra model, training, or changing the output
distribution.
6. Related Work
Speculative decoding (Chen et al., 2023; Leviathan et al.,
2023) pioneer in speedup autoregressive decoding with a
draft model. Different methods for obtaining speculations
are researched. Specinfer (Miao et al., 2023) uses many draft
models obtained from distillation, quantization, and pruning
to conduct speculations together. Medusa (Cai et al., 2024),
OSD (Liu et al., 2023), and EAGLE (Li et al., 2023) use
training to obtain a draft model. REST (He et al., 2023) uses
the finetuning dataset itself as a datastore to lookup specula-
tions, while other works (Yang et al., 2023; Saxena, 2023)
uses prompt as a reference for speculations. Different from
these methods, LOOKAHEAD DECODING uses LLM’s par-
allel generation ability for speculations. Sampling methods
are also researched. Specinfer maintains output distribution
by a tree-based sampling algorithm. Medusa uses a typical
acceptance scheme to accelerate when the temperature is
large but does not persist on an exact output distribution.
LOOKAHEAD DECODING follows Specinfer to maintain
output distribution but with multiple disjoint n-grams.
7. Conclusion
In this paper, we present LOOKAHEAD DECODING to paral-
lelize the autoregressive decoding of LLMs without chang-
ing the output distribution. It shows notable speedup without
a draft model and can linearly decrease the decoding steps
with exponential investment in per-step FLOPs.
8
Lookahead decoding
References
Automatic tensor parallelism for huggingface models, 2023.
URL https://www.deepspeed.ai/tutoria
ls/automatic-tensor-parallelism .
Aminabadi, R. Y ., Rajbhandari, S., Awan, A. A., Li, C.,
Li, D., Zheng, E., Ruwase, O., Smith, S., Zhang, M.,
Rasley, J., et al. Deepspeed-inference: enabling efficient
inference of transformer models at unprecedented scale.
InSC22: International Conference for High Performance
Computing, Networking, Storage and Analysis , pp. 1–15.
IEEE, 2022.
Austin, J.,","[0.046456627547740936, 0.005458514206111431, 0.015420476906001568, 0.0034263853449374437, -0.029251502826809883, 0.009480944834649563, -0.02043979987502098, 0.019198913127183914, -0.012137003242969513, -0.012492538429796696, 0.027201944962143898, 0.007710238453000784, -0.0735052078962326, 0.0007058423943817616, -0.009822537191212177, -0.03312753513455391, 0.03259771689772606, -0.04545276239514351, 0.0005764379166066647, 0.05443177372217178, -0.020872021093964577, -0.0356929674744606, 0.01569932885468006, 0.02076048031449318, 0.019240740686655045, -0.012820188887417316, 0.03287656977772713, 0.055212557315826416, 0.027160117402672768, -0.07774374634027481, -0.019561419263482094, -0.02672789804637432, -0.005430629011243582, -0.041102681308984756, -0.02141578122973442, 0.022238392382860184, 0.01569932885468006, -0.012025462463498116, -0.043612346053123474, -0.004203683231025934, 0.02972554974257946, -0.04877109453082085, -0.0690435841679573, 0.003360158298164606, -0.007034024223685265, 0.024957191199064255, 0.04804607853293419, 0.0018648181576281786, -0.013942565768957138, 0.07467637956142426, -0.027843302115797997, 0.029837090522050858, -0.058503005653619766, 0.04364022985100746, -0.030115941539406776, 0.018069565296173096, -0.008344625122845173, 0.03190058842301369, 0.031203461810946465, 0.0021088130306452513, 0.024706225842237473, -0.04946822300553322, 0.007117679808288813, -0.016312802210450172, -0.030729414895176888, -0.012590136379003525, -0.024441316723823547, 0.03192847594618797, -0.019031601026654243, 0.03814685717225075, -0.017260896041989326, 0.007250133901834488, 0.03499583899974823, -0.03045056201517582, -0.025821631774306297, -0.015378649346530437, 0.013224523514509201, 0.039513230323791504, 0.02628173492848873, -0.025570664554834366, 0.020467685535550117, 0.023535050451755524, 0.0059465039521455765, -0.036362212151288986, 0.01878063566982746, -0.03474487364292145, 0.010415096767246723, 0.017734942957758904, -0.04071228951215744, -0.030227482318878174, -0.026658184826374054, 0.010247785598039627, -0.06000880151987076, -0.005409715231508017, 0.014834889210760593, 0.04863166809082031, 0.01950564980506897, -0.04497871547937393, 0.04341714829206467, 0.06078958511352539, 0.01346154697239399, 0.012157917022705078, 0.05130863934755325, -0.053344253450632095, 0.05225673317909241, -0.013733427040278912, -0.05161537602543831, 0.002473062602803111, -0.02745291031897068, 0.01816716231405735, -0.07802259922027588, -0.03371312469244003, -0.05749914050102234, -0.009494886733591557, 0.019575361162424088, -0.04698644578456879, -0.06000880151987076, -0.005629310850054026, 0.0059465039521455765, 0.006162614095956087, -0.02267061173915863, 0.005068122409284115, 0.03159385174512863, -0.0019432450644671917, -0.0019432450644671917, -0.01812533475458622, 0.032792914658784866, -0.1141059547662735, 0.025068731978535652, -0.025556722655892372, 0.0054863994009792805, 0.027062518522143364, 0.03876033052802086, -0.04667970910668373, 0.004458135459572077, -0.036027587950229645, -0.028861111029982567, -0.01661953702569008, -0.008958098478615284, 0.017707057297229767, 0.03616701439023018, -0.028373120352625847, -0.026449047029018402, 0.017748884856700897, -0.03686414286494255, 0.028414947912096977, -0.019003717228770256, -0.02275426685810089, -0.02598894201219082, 0.007438358385115862, -0.0582241527736187, -0.046902790665626526, -0.03836993873119354, -0.005367887672036886, -0.010331440716981888, -0.0223081037402153, -0.038258399814367294, -0.010547550395131111, 0.029390927404165268, -0.03393620252609253, -0.013112982735037804, 0.01910131424665451, 0.014047134667634964, -0.003841176861897111, 0.011551415547728539, 0.03546988591551781, -0.0792495384812355, -0.022433588281273842, -0.06530697643756866, -0.008219142444431782, 0.006479807198047638, -0.011007655411958694, -0.0017253924161195755, -0.027425026521086693, 0.010066532529890537, -0.014988257549703121, -0.028163982555270195, -0.036473751068115234, -0.020788364112377167, -0.08131304383277893, -0.04115845263004303, 0.03407562896609306, -0.0015798669774085283, 0.018153220415115356, -0.06279731541872025, -0.013294235803186893, 0.001929302467033267, 0.03098038025200367, -0.005245890002697706, 0.04603835195302963, 0.008783816359937191, 0.057889532297849655, 0.04436524212360382, -0.005883762612938881, -0.0021680688951164484, -0.017916196957230568, 0.054515428841114044, 0.0023162085562944412, 0.028205810114741325, -0.05677412450313568, 0.03443813696503639, 0.011683870106935501, -0.022810036316514015, -0.03466121852397919, 0.025779804214835167, -0.028861111029982567, -0.01638251356780529, -0.014346899464726448, -0.0024242636281996965, -0.009027810767292976, 0.02201531082391739, 0.018864290788769722, 0.0384535938501358, 0.009731910191476345, -0.006744715850800276, -0.00331484479829669, -0.015392592176795006, 0.021136928349733353, 0.004102599807083607, 0.03586027771234512, -0.007786922622472048, 0.0195474773645401, -0.0018683037487789989, 0.057889532297849655, -0.03340638801455498, 0.023214371874928474, 0.0013768282951787114, -0.01755368895828724, 0.03078518435359001, 0.017330609261989594, 0.016717135906219482, -0.040740177035331726, -0.01358702965080738, 0.004147913306951523, 0.011446845717728138, -0.003917860798537731, 0.021708574146032333, -0.04603835195302963, 0.005740851163864136, -0.055045247077941895, -0.0047160726971924305, -0.0057199373841285706, 0.027843302115797997, -0.015755098313093185, -0.038537248969078064, 0.027118289843201637, -0.03937380388379097, -0.0614030584692955, 0.03178904950618744, 0.042803674936294556, -0.012213687412440777, -0.013022355735301971, -0.036111243069171906, -0.04469986632466316, -0.04299887269735336, -0.003663409035652876, -0.04534122347831726, 0.001168561284430325, -0.04380754008889198, 0.004723044112324715, -0.048073966056108475, -0.01028264220803976, -0.005915133282542229, 0.013607943430542946, -0.0011058197123929858, -0.014486324973404408, 0.009236949495971203, 0.013308178633451462, -0.014514210633933544, 0.00504720862954855, -0.0045417905785143375, -0.006162614095956087, 0.038704562932252884, 0.037895891815423965, -0.037366073578596115, -0.003236417891457677, 0.026253851130604744, 0.0036041531711816788, -0.05273078382015228, 0.020216720178723335, 0.01271561998873949, -0.011697812005877495, 0.06051073223352432, 0.004691673442721367, -0.01740032061934471, 0.034577563405036926, -0.00812851544469595, -0.043863311409950256, -0.05404138192534447, 0.005873305723071098, 0.011774496175348759, -0.023325912654399872, 0.027787532657384872, -0.02347927913069725, 0.05337214097380638, 0.028233693912625313, 0.01833447255194187, 0.01816716231405735, 0.002896568039432168, -0.032012131065130234, 0.04734895005822182, -0.010436010546982288, 0.02059316821396351, -0.012597107328474522, -0.025417296215891838, 0.022043196484446526, -0.044950831681489944, 0.009501858614385128, 0.008992955088615417, -0.010596349835395813, -0.002236038912087679, 0.020174892619252205, -0.011697812005877495, 0.00833068322390318, -0.03198424354195595, -0.04294310137629509, 0.04436524212360382, -0.04595469683408737, 0.008477079682052135, -0.06045496463775635, -0.055658720433712006, -0.022782152518630028, -0.011844209395349026, -0.006211413070559502, 0.022559070959687233, 0.001565053011290729, -0.02530575543642044, -0.002162840450182557, -0.0017175497487187386, -0.03000440075993538, 0.006472835782915354, 0.04364022985100746, 0.027480795979499817, -0.02664424292743206, -0.016229145228862762, -0.03683625906705856, -0.0335736982524395, -0.004060772247612476, 0.028331292793154716, 0.012541337870061398, -0.07328212261199951, 0.03265348821878433, -0.021875884383916855, 0.006727288011461496, -0.02396726980805397, 0.022168679162859917, -0.02120664156973362, -0.002642116043716669, 0.051113445311784744, 0.008323711343109608, -0.01885034888982773, -0.014388727024197578, 0.053260598331689835, -0.030060170218348503, 0.04528545215725899, 0.021708574146032333, -0.03106403537094593, -0.031036149710416794, -0.023242255672812462, -0.0014552552020177245, -0.03814685717225075, 0.03597182035446167, 0.003053421853110194, 0.009899221360683441, -0.008149429224431515, 0.015197396278381348, -0.03686414286494255, 0.043166182935237885, 0.018097449094057083, -0.028805339708924294, 0.040572866797447205, 0.07885915040969849, -0.034493908286094666, 0.0051238927990198135, -0.030311137437820435, -0.025361526757478714, 0.02271243929862976, 0.028693798929452896, -0.014876716770231724, 0.04124210774898529, -0.009083581157028675, 0.01687050424516201, -0.0018630753038451076, -0.005542169790714979, 0.026630299165844917, 0.017944080755114555, -0.007009624503552914, -0.036027587950229645, -0.03850936517119408, -0.010826402343809605, -0.04840858653187752, -0.02250329963862896, -0.024232178926467896, 0.016521940007805824, -0.008428281173110008, 0.027118289843201637, 0.014918545261025429, 0.022656667977571487, 0.03139865770936012, 0.033796779811382294, 0.010770631954073906, -0.019003717228770256, -0.02209896594285965, -0.050025925040245056, 0.002527090022340417, 0.02900053560733795, 0.02802455611526966, 0.048798978328704834, 0.05211731046438217, 0.02992074564099312, 0.018710922449827194, -0.061458829790353775, 0.045564305037260056, -0.03443813696503639, 0.020634997636079788, -0.01950564980506897, 0.0016391228418797255, 0.014918545261025429, 0.0192267969250679, 0.06274154037237167, -0.003949231468141079, -0.008016974665224552, -0.06831856817007065, -0.023744188249111176, -0.0490778312087059, -0.008051831275224686, 0.022573012858629227, -0.04545276239514351, 0.06993591040372849, -0.03661317750811577, -0.02721588686108589, -0.009418202564120293, 0.06536274403333664, -0.019840270280838013, -0.0490778312087059, 0.007375617045909166, -0.01508585549890995, 0.03970842435956001, 0.0070200818590819836, -0.062351152300834656, -0.01115405187010765, 0.005775707773864269, -0.03098038025200367, 0.00168792181648314, -0.014765176922082901, 0.007264076732099056, -0.01574115641415119, 0.0032329324167221785, 0.006953854579478502, -0.04001516103744507, 0.050025925040245056, 0.0003932239196728915, 0.012708648107945919, -0.009585513733327389, -0.00752201396971941, -0.05041631683707237, 0.0828746110200882, -0.014709406532347202, 0.02201531082391739, -0.0329323410987854, 0.019408050924539566, -0.010547550395131111, -0.04587104171514511, -0.013356977142393589, -0.02149943634867668, 0.006723802071064711, 0.040935371071100235, 0.026588471606373787, 0.031008265912532806, 0.016647422686219215, 0.01995181106030941, 0.0015763812698423862, -0.0171075277030468, -0.008665304630994797, 0.008930212818086147, -0.002992423018440604, 0.031816933304071426, -0.01654982566833496, 0.011732668615877628, -0.014528153464198112, -0.013440633192658424, -0.03301599621772766, 0.02891688048839569, 0.010387211106717587, 0.009578542783856392, 0.06207229942083359, 0.02205713838338852, -0.02955823764204979, -0.02294946275651455, -0.028484661132097244, 0.01060332078486681, -0.02339562401175499, 0.05827992409467697, -0.01657770946621895, 0.0012461168225854635, -0.012785332277417183, -0.01873880811035633, -0.010261728428304195, 0.02234993316233158, 0.0010265213204547763, 0.01419353112578392, 0.006535577587783337, 0.009752824902534485, 0.022977348417043686, 0.019686901941895485, -0.019798442721366882, 0.004660302307456732, 0.00821217056363821, -0.02851254679262638, 0.010080474428832531, 0.0044058505445718765, 0.03170539438724518, 0.007037509698420763, 0.03349004313349724, -0.016772905364632607, 0.01938016526401043, -0.0390949547290802, 0.027689935639500618, -0.0063403816893696785, 0.015964237973093987, 0.019798442721366882, -0.03494006767868996, 0.004423278849571943, 0.021220585331320763, 0.03204001486301422, -0.02237781696021557, -0.026212023571133614, -0.12436768412590027, -0.014332957565784454, 0.010610292665660381, -0.0033880434930324554, -0.0192267969250679, -0.001299272757023573, 0.016229145228862762, -0.04096325859427452, 0.002429492073133588, -0.012171859852969646, -0.021401837468147278, -0.054515428841114044, -0.02526392787694931, -0.0021645831875503063, 0.031454429030418396, 0.01914314180612564, -0.0007058423943817616, 0.0034751843195408583, -0.027675991877913475, 0.019087372347712517, -0.02307494543492794, -0.014737291261553764, -0.004984467290341854, 0.037170879542827606, -0.03482852876186371, 0.032904453575611115, -0.02246147207915783, -0.01325937919318676, 0.015155568718910217, 0.019965752959251404, 0.010798516683280468, -0.013844967819750309, -0.005406229756772518, 0.025375468656420708, -0.014200503006577492, -0.012171859852969646, -0.0057966215535998344, -0.0042699105106294155, 0.023953327909111977, -0.023228313773870468, -0.01965901628136635, 0.01873880811035633, -0.002602031221613288, -0.0047300150617957115, -0.017163297161459923, 0.009320604614913464, -0.017302723601460457, -0.020621053874492645, -0.008240056224167347, 0.010045618750154972, -0.00474395789206028, 0.0032259610015898943, 0.0031963330693542957, -0.040656521916389465, -0.029753433540463448, -0.026658184826374054, 0.0037540358025580645, -0.04957976192235947, 0.006451922003179789, -4.4550852180691436e-05, 0.011593243107199669, -0.021834056824445724, 0.008428281173110008, 0.033434271812438965, 0.0100386468693614, -0.014123818837106228, -0.03407562896609306, -0.04698644578456879, 0.005671138409525156, 0.005151777993887663, -0.012520424090325832, -0.01759551838040352, -0.0026351448614150286, -0.005360916256904602, 0.007417444605380297, -0.024887479841709137, -0.0072222487069666386, -0.006012731231749058, -0.016354629769921303, -0.04177192598581314, 0.02992074564099312, 0.04957976192235947, -0.02335379645228386, -0.00670985970646143, 0.026825495064258575, -0.0041723125614225864, -0.028038498014211655, -0.040210358798503876, 0.03114769048988819, -0.036641061305999756, -0.006155642680823803, 0.04305464029312134, 0.005099493078887463, 0.015518074855208397, -0.04899417608976364, 0.03770069777965546, 0.01836235821247101, 0.03823051601648331, 0.0003470391675364226, -0.023702360689640045, 0.004113056696951389, -0.002706600585952401, -0.01336394902318716, -0.02498507685959339, -0.026853380724787712, -2.35008483286947e-05, 0.030060170218348503, 0.007047966588288546, -0.003590210573747754, -0.006193984765559435, -0.016410399228334427, 0.015838753432035446, -0.013573087751865387, -0.0025880886241793633, 0.048882633447647095, 0.0052145193330943584, -0.0005097750690765679, 0.015308937057852745, -0.01905948668718338, 0.004175798501819372, 0.015057970769703388, -0.029418813064694405, -0.019073428586125374, 0.0019049029797315598, -0.036194898188114166, 0.06508389860391617, 0.04957976192235947, 0.026225965470075607, -0.009027810767292976, 0.014486324973404408, -0.03125923126935959, 0.016284916549921036, -0.002471319632604718, -0.03429871052503586, 0.027229830622673035, -0.046568166464567184, -0.015322878956794739, -0.008010003715753555, 0.03892764076590538, 0.026184137910604477, 0.02636539191007614, 0.022168679162859917, -0.01098674163222313, -0.024483144283294678, -0.0011110481573268771, 0.014500267803668976, 0.0018822463462129235, -0.010763660073280334, -0.04104691371321678, 0.00944608822464943, -0.006971282884478569, -0.013691599480807781, 0.006183527875691652, -0.04553641751408577, 0.03742184489965439, -0.06257423013448715, -0.026532702147960663, 0.0007284990279003978, 0.013273322023451328, 0.027871187776327133, 0.012778361327946186, 0.014653636142611504, 0.003199818776920438, -0.006322953384369612, 0.0025880886241793633, 0.027034634724259377, -0.007703267503529787, 0.038983412086963654, -0.004339623264968395, -0.0063787237741053104, 0.015071913599967957, -0.0021488978527486324, -0.030868839472532272, -0.011662956327199936, 0.03162173926830292, 0.01321755163371563, -0.0318727046251297, -0.016605595126748085, -0.05811261385679245, -0.0072222487069666386, 0.02364659123122692, 0.04330560937523842, -0.02766204997897148, -0.02773176319897175, 0.009662197902798653, -0.018306588754057884, 0.020453743636608124, -0.041019026190042496, -0.0014474125346168876, 0.013015384785830975, 0.0008112830109894276, -0.006148671265691519, -0.035497769713401794, -0.06636661291122437, 0.011837237514555454, -0.004538305103778839, -0.011363190598785877, 0.001120633678510785, -0.025640377774834633, -0.0073965308256447315, 0.0352746918797493, -0.01597817987203598, 0.04456043988466263, 0.03954111412167549, 0.008985983207821846, 0.03170539438724518, -0.03962476924061775, -0.004897326231002808, 0.0012809731997549534, -0.037198763340711594, 0.00013376148126553744, -0.017623402178287506, -0.021025389432907104, 0.0023249227087944746, -0.02579374611377716, -0.011035540141165257, 0.05038842931389809, -0.0006897212588228285, -0.024106696248054504, 0.0032259610015898943, 0.032458290457725525, -8.153133239829913e-05, -0.008567706681787968, -0.032792914658784866, 0.01321755163371563, -0.008602562360465527, -0.027466854080557823, 0.006061530206352472, 0.012339170090854168, 0.008037889376282692, 0.005949989892542362, -0.006730773486196995, -0.02039797231554985, 0.007082823198288679, -0.0033305303659290075, 0.0004736115224659443, 0.016006065532565117, -0.018320530652999878, 0.0020164435263723135, -0.05086247995495796, -0.01196272112429142, 0.005692052189260721, 0.023061003535985947, 0.0209277905523777, 0.01674502156674862, 0.04062863439321518, 0.029864974319934845, 0.029781319200992584, -0.01405410561710596, 0.006573919672518969, 0.029586123302578926, -0.002314465818926692, 0.021109044551849365, -0.049942269921302795, -0.011802381835877895, -0.008895357139408588, 0.00408517150208354, -0.016884446144104004, 0.011000684462487698, -0.02286580763757229, -0.0014491553883999586, 0.008588620461523533, -0.023786015808582306, -0.005381830036640167, -0.006103357765823603, -0.0023650075308978558, -0.00691551249474287, 0.011983634904026985, 0.04447678476572037, 0.004395393654704094, -0.10356537252664566, -0.029669778421521187, 0.02866591513156891, -0.01914314180612564, 0.013168753124773502, -0.02481776662170887, 0.02696492150425911, 0.032904453575611115, 0.014360842294991016, 0.000724142009858042, 0.002603774191811681, -0.02866591513156891, -0.008937184698879719, -0.017246954143047333, 0.01576904207468033, -0.04411427676677704, 0.0008470108732581139, -0.03873244673013687, 0.028317350894212723, -0.008930212818086147, -0.014876716770231724, -0.008539821021258831, 0.020690767094492912, 0.02076048031449318, -0.010143216699361801, -0.0005986589239910245, -0.021875884383916855, 0.010498751886188984, 0.003515269374474883, 0.031733278185129166, -0.019198913127183914, 0.0003056471759919077, -0.005685081239789724, 0.028944766148924828, -0.02883322536945343, 0.023172544315457344, -0.02071865275502205, -0.024873536080121994, 0.02173645980656147, 0.021597033366560936, -0.014653636142611504, -0.04723741114139557, 0.030283251777291298, -0.0018212476279586554, 0.013287264853715897, 0.00017297494923695922, -0.014500267803668976, -0.0107845738530159, 0.0012731305323541164, -0.027313485741615295, -0.00041740553569979966, 0.009752824902534485, -0.002330151153728366, 0.019700845703482628, -0.014681520871818066, -0.013112982735037804, -0.033629465848207474, 0.009899221360683441, 0.004653331357985735, 0.00874198880046606, -0.009041753597557545, 0.03929014876484871, 0.03139865770936012, -0.002734485547989607, 0.006891112774610519, -0.008985983207821846, 0.007626583334058523, 0.030199596658349037, -0.03114769048988819, -0.05939532816410065, 0.00883958674967289, 0.007173449732363224, 0.016758963465690613, 0.019324395805597305, 0.002776313340291381, 0.005050694104284048, -0.000528946053236723, 0.018013793975114822, -0.07707449793815613, 0.009369404055178165, 0.05811261385679245, -0.0386766754090786, -0.03401985764503479, -0.0255009513348341, 0.011439874768257141, -0.005343487951904535, 0.01585269719362259, -0.004018944688141346, -0.014374785125255585, 0.03474487364292145, 0.034577563405036926, -0.006978253833949566, -0.00873501691967249, 0.012778361327946186, -0.01691233180463314, 0.0003080435562878847, -0.009920135140419006, 0.011906950734555721, 0.025012962520122528, -0.012269457802176476, 0.03892764076590538, 0.02700674906373024, -0.028456775471568108, -0.05487793684005737, 0.0010491780703887343, 0.0012504737824201584, 0.012032434344291687, -0.011300449259579182, 0.028638029471039772, -0.01569932885468006, -0.0039457459934055805, -0.016494054347276688, -0.01804167963564396, 0.02798272855579853, 0.013796168379485607, 0.03036690689623356, 0.020049408078193665, 0.01836235821247101, 0.019268624484539032, -0.007738123647868633, -0.014834889210760593, 0.014033191837370396, -0.031565967947244644, -0.0036111243534833193, -0.024831708520650864, 0.0013637571828439832, 0.02290763519704342, 0.019645074382424355, -0.0009838222758844495, 0.0008430894813500345, -0.013064183294773102, 0.02112298645079136, 0.02067682519555092, 0.0057059950195252895, 0.014974314719438553, -0.005660681519657373, -0.018752750009298325, 0.02145760878920555, -0.0490778312087059, 0.017734942957758904, 0.014388727024197578, 0.0006779572577215731, 0.03507949411869049, 0.009592484682798386, 0.01218580175191164, 0.0029976514633744955, -0.015016143210232258, -0.004709101282060146, -0.0010465638479217887, 0.02764810621738434, 0.0037540358025580645, -0.018264761194586754, -0.0169959869235754, 0.011460788547992706, 0.01799985207617283, 0.027801474556326866, -0.028972649946808815, -0.03309965133666992, -0.003593696281313896, 0.03139865770936012, 0.07049360871315002, 0.03970842435956001, -0.0055700549855828285, -0.006277639884501696, 0.019031601026654243, -0.023465337231755257, -0.03747761622071266, -0.009278777055442333, -0.041019026190042496, -0.010192015208303928, -0.026212023571133614, 0.003126620315015316, 0.024399489164352417, 0.025026904419064522, 0.032541949301958084, 0.028638029471039772, -0.0007633554632775486, 0.01325937919318676, 0.012799275107681751, 0.02883322536945343, 0.0014857546193525195, 0.022768208757042885, 0.007375617045909166, 0.01661953702569008, 0.005925590172410011, 0.01364280004054308, -0.0017654773546382785, 0.011858152225613594, -0.006110329180955887, 0.03070152923464775, -0.011237707920372486, 0.03413140028715134, -0.02927938662469387, 0.032012131065130234, -0.006085929926484823, -0.01938016526401043, 0.012645906768739223, 0.03070152923464775, -0.03510737791657448, 0.00024290563305839896, -0.01518345344811678, 0.047544147819280624, 0.003607638878747821, -0.010108360089361668, -0.036641061305999756, 0.015322878956794739, 0.007445329800248146, -0.011126167140901089, -0.009055696427822113, 0.03488430008292198, -0.016368571668863297, -0.005953475367277861, 0.0007215277291834354, 0.04179980978369713, 0.0023894072510302067, -0.02152732014656067, 0.0339919738471508, 0.009076610207557678, -0.03786800801753998, -0.02161097712814808, -0.0301717109978199, -0.024134580045938492, -0.031008265912532806, 0.004262939561158419, -0.013858909718692303, 0.012499509379267693, 0.01340577658265829, -0.012792304158210754, -0.028289465233683586, -0.0040956283919513226, 0.02900053560733795, 0.010171101428568363, 0.01999363861978054, -0.01695415936410427, -0.01610366255044937, -0.02218262106180191, -0.007368645630776882, -0.008079716935753822, -0.012666820548474789, -0.012360083870589733, 0.018264761194586754, 0.005793136078864336, -0.008714103139936924, -0.0072083063423633575, 0.00863741897046566, -0.011934836395084858, 0.020133065059781075, 0.05462697148323059, 0.00420716917142272, 0.007250133901834488, 0.005671138409525156, -0.001816019183024764, 0.03390831872820854, -0.005604911129921675, 0.006615747231990099, 0.01788831129670143, 0.003241646336391568, 0.03577662259340286, 0.041548844426870346, 0.03142654150724411, -0.02286580763757229, 0.03273714333772659, 0.005120407324284315, -0.03139865770936012, 0.004517391324043274, -0.020063351839780807, -0.029837090522050858, 0.005510799121111631, -0.006842313800007105, 0.006493750028312206, 0.008860500529408455, 0.005057665519416332, 0.0010770631488412619, 0.020425857976078987, 0.008016974665224552, 0.009097523987293243, 0.011844209395349026, -0.013594001531600952, 0.008135487325489521, 0.008504964411258698, 0.0029035392217338085, -0.024845652282238007, -0.02911207638680935, -0.016856562346220016, -0.0010857773013412952, -0.04372388496994972, -0.05320483073592186, 0.0021541262976825237, 0.0673704743385315, -0.017330609261989594, 0.006783057935535908, 0.02060711197555065, -0.007257105316966772, 0.010854287073016167, -0.014542095363140106, -0.0209277905523777, 0.012541337870061398, -0.01772100105881691, 0.02664424292743206, -0.017302723601460457, 0.031091921031475067, 0.024218235164880753, 0.02011912129819393, -0.034856412559747696, 0.030952494591474533, 0.03524680435657501, 0.006033645011484623, -0.047460492700338364, -0.022977348417043686, -0.009250892326235771, -0.004018944688141346, 0.02855437435209751, 0.027313485741615295, 0.016201261430978775, 0.03546988591551781, 0.004196712281554937, -0.0027501711156219244, -0.013350006192922592, 0.020732594653964043, -0.011432903818786144, 0.01812533475458622, 0.019073428586125374, 0.005301660392433405, 0.004050315357744694, 0.006019702646881342, -0.023214371874928474, 0.016089720651507378, -0.01942199282348156, 0.014277187176048756, 0.02197348326444626, 0.011181937530636787, -0.0005054179928265512, 0.011300449259579182, 0.009334547445178032, -0.009836480021476746, 0.005535198375582695, -0.006835342850536108, 0.025975000113248825, 0.00015641815843991935, -0.01744215004146099, 0.004531333688646555, 0.002781541785225272, 0.011265592649579048, 0.016940217465162277, -0.0184878408908844, 0.014500267803668976, -0.005768736358731985, -0.015294994227588177, 0.01070789061486721, -0.025961056351661682, 0.07071669399738312, -0.014200503006577492, 0.0004949610447511077, -0.007215277757495642, -0.015559903346002102, -0.00920209288597107, -0.007438358385115862, -0.012799275107681751, -0.025194214656949043, -0.014263244345784187, 0.014597865752875805, 0.018459957093000412, -0.00632643885910511, 0.0073825884610414505, 0.023061003535985947, -0.01861332543194294, -0.009439116343855858, 0.028693798929452896, 0.010157158598303795, 0.041827697306871414, 0.034159284085035324, 0.03903918340802193, -0.02011912129819393, -0.025166330859065056, -0.011997577734291553, 0.010115331038832664, 0.012555279769003391, 0.0004479049239307642, 0.012771389447152615, 0.045229680836200714, 0.011140109971165657, -0.009550657123327255, -0.021583091467618942, 0.016270974650979042, -0.0037749495822936296, 0.01429112907499075, 0.007152535952627659, 0.03195635974407196, -0.04517391324043274, -0.02432977594435215, 0.0026578016113489866, -0.007731152698397636, -0.006239297799766064, 0.007793894037604332, -0.012834131717681885, 0.03326696157455444, -0.0019554446917027235, -0.02031431719660759, 0.0009977648733183742, 0.012701677158474922, 0.010596349835395813, 0.007047966588288546, 0.033071763813495636, -0.004841555841267109, -0.010059560649096966, -0.023590819910168648, -0.0020338718313723803, 0.055575065314769745, 0.0359160490334034, 0.021471550688147545, -0.04991438239812851, 0.019700845703482628, -0.05089036375284195, -0.01825081743299961, -0.025514895096421242, -0.03374100849032402, -0.00798908993601799, 0.01500220037996769, -0.00023462723765987903, 0.04196712002158165, 0.003593696281313896, 0.014346899464726448, -0.002835569204762578, -0.012074261903762817, 0.0064763217233121395, 0.01763734593987465, -0.025737974792718887, -0.001659165252931416, 0.036919914186000824, 0.05038842931389809, -0.0007568198489025235, -0.004423278849571943, -0.007549899164587259, 0.012868987396359444, -0.025975000113248825, 0.0017192926025018096, 0.02116481401026249, -0.0028686828445643187, 0.016033949330449104, 0.012422826141119003, -0.008651361800730228, -0.0010300070280209184, 0.021262412890791893, 0.008337654173374176, 0.01897583156824112, 0.00227612373419106, -0.03365735337138176, -0.02764810621738434, 0.04974707216024399, 0.00977373868227005, -0.008477079682052135, -0.027926959097385406, -0.012178830802440643, 0.010122301988303661, -0.012931729666888714, 0.010812459513545036, -0.0486595518887043, -0.01918496936559677, 0.01889217644929886, -0.014834889210760593, 0.02874957025051117, -0.020258547738194466, 0.011732668615877628, 0.0084979934617877, -0.0036912942305207253, 0.022573012858629227, 0.014583922922611237, 0.012380997650325298, -0.002511404687538743, -0.04617777466773987, 0.049245141446590424, 0.019979696720838547, 0.026086539030075073, -0.00759172672405839, -0.0085537638515234, -0.024218235164880753, -0.019645074382424355, 0.005995302926748991, 0.008323711343109608, -0.018641209229826927, -0.02307494543492794, -0.016480112448334694, -0.0027553995605558157, 4.5013788621872663e-05, -0.011195880360901356, 0.04684701934456825, 0.02485959418118, -0.01354520209133625, -0.009111466817557812, -0.010610292665660381, 0.02713223174214363, 0.03000440075993538, -0.017916196957230568, 0.008888385258615017, 0.00025771959917619824, 0.014653636142611504, 0.006462378893047571, 0.0009141094633378088, 0.030115941539406776, 0.002291809068992734, -0.013245437294244766, -0.0009027810883708298, -8.038760279305279e-05, -0.02339562401175499, -0.030757298693060875, -0.006270668935030699, 0.006281125824898481, -0.04046132415533066, 0.011997577734291553, -0.0004130484885536134, 0.00551428459584713, -0.014667578972876072, -0.026867322623729706, 0.02902842126786709, 0.020997503772377968, -0.023772073909640312, -0.0232701413333416, 0.014040163718163967, 0.030311137437820435, -0.0038795187138020992, 0.004029401578009129, -0.002628173679113388, -0.0028285980224609375, -0.0024992048274725676, -0.03775646537542343, -0.04570372775197029, -0.02810821123421192, -0.008665304630994797, -0.0054341149516403675, 0.04581527039408684, -4.724678001366556e-05, -0.0027519138529896736, 0.035414114594459534, 0.0255009513348341, 0.007215277757495642, -0.004280367400497198, -0.0013733427040278912, 0.005960446782410145, -0.010212928988039494, 0.0024678341578692198, 0.022001368924975395, 0.020202776417136192, -0.009968934580683708, 0.01383102498948574, 0.0017707057995721698, 0.03488430008292198, 0.003201561514288187, 0.0363343246281147, 0.019352281466126442, 0.034326594322919846, 0.005008866544812918, -0.01060332078486681, 0.005963932257145643, -0.0069887107238173485, 0.0009480944718234241, 0.008609534241259098, -0.021806173026561737, 0.012360083870589733, 0.022879749536514282, 7.619394455105066e-05, -0.000695385446306318, -0.03884398564696312, 0.005845420528203249, 0.019087372347712517, 0.03410351648926735, 0.0031597339548170567, 0.00378192076459527, 0.009034782648086548, -0.027954842895269394, -0.039485346525907516, 0.0017558918334543705, 0.023507164791226387, 0.008184285834431648, 0.021848000586032867, -0.048966288566589355, 0.026212023571133614, 0.00019051208801101893, 0.022489357739686966, 0.0020391002763062716, 0.035581428557634354, -0.0039701457135379314, -0.0031370772048830986, 0.012604079209268093, -0.02258695662021637, 0.016229145228862762, -0.018264761194586754, -0.011655984446406364, -0.007584755774587393, 0.014346899464726448, 0.011439874768257141, -0.005726908799260855, 0.006152156740427017, 0.0131199536845088, 0.016494054347276688, -0.010087446309626102, 0.05577026307582855, 0.015364707447588444, 0.030840953812003136, -0.02388361468911171, 0.011976663954555988, -0.032374635338783264, 0.03658528998494148, -0.00036642805207520723, -0.0369756817817688, 0.003334015840664506, -0.03892764076590538, -0.004245511256158352, -0.004723044112324715, -0.001283587422221899, 0.034577563405036926, 0.02059316821396351, -0.01638251356780529, 0.009829508140683174, -0.00037427074857987463, -0.02460862696170807, 0.040294013917446136, -0.017874369397759438, 0.01074274629354477, -0.027606278657913208, 0.001986815594136715, -0.00670985970646143, 0.007647497113794088, -0.009536714293062687, -0.0108891436830163, 0.02607259713113308, 0.027313485741615295, -0.014793061651289463, -0.029530353844165802, -0.010937942191958427, -0.012604079209268093, 0.04152096062898636, 0.005158749409019947, -0.012109117582440376, -0.005287718027830124, 0.006790029350668192, -0.0072083063423633575, -0.004011973273009062, 0.0011232479009777308, 0.004803213756531477, 0.008511936292052269, 0.022531185299158096, 0.02664424292743206, -0.007271047681570053, -0.03683625906705856, 0.010171101428568363, 0.014374785125255585, -0.011851180344820023, -0.011983634904026985, -0.023855729028582573, 0.022168679162859917, 0.00859559141099453, -0.013851938769221306, -0.004782299976795912, 0.024873536080121994, 0.025361526757478714, 0.00863741897046566, 0.013266351073980331, 0.04626143351197243, 0.004956582095474005, -0.007891491986811161, 0.012206715531647205, -0.0033897862304002047, 0.010226871818304062, 0.00920209288597107, 0.011927864514291286, 0.023047059774398804, -0.00018321402603760362, 0.019366223365068436, 0.0021140414755791426, 0.03828628361225128, 0.005357430782169104, 0.01735849305987358, 0.004576647188514471, -0.015378649346530437, 0.016410399228334427, -0.025514895096421242, -0.008365538902580738, 0.01946382038295269, 0.04087959975004196, 0.0011807610280811787, 0.03190058842301369, -0.007877549156546593, 0.03374100849032402, 0.005629310850054026, -0.0018473898526281118, 0.012604079209268093, 0.013872852548956871, 0.007996060885488987, 0.05889339745044708, -0.028638029471039772, -0.02048162929713726, -0.013796168379485607, -0.030199596658349037, -0.04034978523850441, -0.012513452209532261, 0.02120664156973362, -0.021834056824445724, -0.014472383074462414, -0.021987425163388252, 0.006880655884742737, 0.04188346490263939, 0.017135413363575935, 0.02352110855281353, -0.010066532529890537, 0.006364780943840742, 0.01752580516040325, 0.027020690962672234, 0.0011659470619633794, -0.006880655884742737, -0.010798516683280468, -0.02112298645079136, -0.0028599686920642853, 0.021053273230791092, 0.018501784652471542, -0.005901190917938948, -0.007319846656173468, -0.007180421147495508, -0.01518345344811678, 0.0010282641742378473, 0.0026072596665471792, -0.02636539191007614, 0.03678048774600029, -0.000554652651771903, -0.015838753432035446, -0.024218235164880753, -0.01747003383934498, -0.012227630242705345, 0.008644390851259232, 0.015671443194150925, -0.010547550395131111, -0.009069638326764107, -0.044950831681489944, 0.018683036789298058, 0.0164661705493927, 0.014807004481554031, 0.004538305103778839, 0.012882930226624012, 0.0014317271998152137, -0.0015624386724084616]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" Odena, A., Nye, M., Bosma, M., Michalewski,
H., Dohan, D., Jiang, E., Cai, C., Terry, M., Le, Q., and
Sutton, C. Program synthesis with large language models,
2021.
Ba, J. L., Kiros, J. R., and Hinton, G. E. Layer normalization.
arXiv preprint arXiv:1607.06450 , 2016.
Ben Allal, L., Muennighoff, N., Kumar Umapathi, L., Lip-
kin, B., and von Werra, L. A framework for the evaluation
of code generation models. https://github.com
/bigcode-project/bigcode-evaluation-h
arness , 2022.
Cai, T., Li, Y ., Geng, Z., Peng, H., Lee, J. D., Chen, D.,
and Dao, T. Medusa: Simple llm inference acceleration
framework with multiple decoding heads, 2024.
Chen, C., Borgeaud, S., Irving, G., Lespiau, J.-B., Sifre,
L., and Jumper, J. Accelerating large language model
decoding with speculative sampling. arXiv preprint
arXiv:2302.01318 , 2023.
Chen, M., Tworek, J., Jun, H., Yuan, Q., de Oliveira Pinto,
H. P., Kaplan, J., Edwards, H., Burda, Y ., Joseph, N.,
Brockman, G., Ray, A., Puri, R., Krueger, G., Petrov,
M., Khlaaf, H., Sastry, G., Mishkin, P., Chan, B., Gray,
S., Ryder, N., Pavlov, M., Power, A., Kaiser, L., Bavar-
ian, M., Winter, C., Tillet, P., Such, F. P., Cummings, D.,
Plappert, M., Chantzis, F., Barnes, E., Herbert-V oss, A.,
Guss, W. H., Nichol, A., Paino, A., Tezak, N., Tang,
J., Babuschkin, I., Balaji, S., Jain, S., Saunders, W.,
Hesse, C., Carr, A. N., Leike, J., Achiam, J., Misra,
V ., Morikawa, E., Radford, A., Knight, M., Brundage,
M., Murati, M., Mayer, K., Welinder, P., McGrew, B.,
Amodei, D., McCandlish, S., Sutskever, I., and Zaremba,
W. Evaluating large language models trained on code,
2021.
Cobbe, K., Kosaraju, V ., Bavarian, M., Chen, M., Jun, H.,
Kaiser, L., Plappert, M., Tworek, J., Hilton, J., Nakano,
R., Hesse, C., and Schulman, J. Training verifiers to solve
math word problems. arXiv preprint arXiv:2110.14168 ,
2021.Dao, T. FlashAttention-2: Faster attention with better paral-
lelism and work partitioning. 2023.
Dao, T., Fu, D. Y ., Ermon, S., Rudra, A., and R ´e, C. FlashAt-
tention: Fast and memory-efficient exact attention with
IO-awareness. In Advances in Neural Information Pro-
cessing Systems , 2022.
Du, X., Liu, M., Wang, K., Wang, H., Liu, J., Chen, Y ., Feng,
J., Sha, C., Peng, X., and Lou, Y . Classeval: A manually-
crafted benchmark for evaluating llms on class-level code
generation, 2023.
Gugger, S., Debut, L., Wolf, T., Schmid, P., Mueller, Z.,
Mangrulkar, S., Sun, M., and Bossan, B. Accelerate:
Training and inference at scale made simple, efficient and
adaptable. https://github.com/huggingface
/accelerate , 2022.
He, Z., Zhong, Z., Cai, T., Lee, J. D., and He, D. Rest:
Retrieval-based speculative decoding. arXiv preprint
arXiv:2311.08252 , 2023.
Holtzman, A., Buys, J., Du, L., Forbes, M., and Choi,","[-0.0007293981034308672, 0.0395667739212513, 0.03101787529885769, -0.0020018902141600847, -0.0024166805669665337, 0.022665826603770256, -0.011389155872166157, 0.0008449594024568796, -0.017449311912059784, -0.0005628668586723506, 0.03340819105505943, -0.031636543571949005, -0.025281114503741264, 0.028444768860936165, -0.004685723688453436, -0.002123163780197501, 0.02059890702366829, -0.04465674236416817, 0.0038807494565844536, 0.02758706733584404, -0.03605160117149353, -0.018349196761846542, 0.010826729238033295, 0.01780083030462265, 0.05104029178619385, -0.040944721549749374, -0.00807083398103714, 0.051546476781368256, 0.037063971161842346, -0.038807496428489685, 0.029161864891648293, -0.03228333592414856, -0.020022418349981308, -0.017843011766672134, -0.0461471751332283, 0.027755795046687126, 0.004049477633088827, 0.015058995224535465, -0.025787299498915672, -0.0037682640831917524, 0.008816050365567207, -0.049774833023548126, -0.02391722798347473, 0.009441751055419445, -0.011586005799472332, 0.049774833023548126, 0.030005505308508873, -0.016999369487166405, -0.00941362977027893, 0.07812117785215378, -0.03053981252014637, 0.00829580519348383, -0.023354800418019295, 0.009160537272691727, -0.05188393592834473, -0.001367401797324419, -0.001959708286449313, 0.03664214909076691, 0.01803986169397831, -0.005778942257165909, 0.004429116379469633, -0.02692621573805809, -0.010890002362430096, 0.04173211753368378, -0.06344182044267654, -0.023411042988300323, -0.02719336748123169, 0.005705123767256737, 0.018897563219070435, 0.030652297660708427, -0.0022760736756026745, 0.03532044589519501, 0.04924052581191063, -0.03520796075463295, -0.02803700976073742, -0.0028314709197729826, -0.0022409220691770315, 0.08987590670585632, -0.019431868568062782, -0.017491495236754417, 0.00951908528804779, 0.010784546844661236, 0.029780535027384758, -0.03568602353334427, -0.025463903322815895, -0.02246897667646408, -0.009645631536841393, 0.03551729395985603, -0.03748578950762749, -0.024943659082055092, 0.0016073122387751937, 0.007339678704738617, -0.04161963239312172, 0.007438103202730417, 0.05134962871670723, 0.040916599333286285, 0.021105090156197548, -0.015621422789990902, 0.04499419778585434, 0.03101787529885769, -0.016858763992786407, -0.0062675513327121735, 0.04153526946902275, -0.035882871598005295, 0.034195590764284134, -0.018475743010640144, -0.027601128444075584, -0.029499320313334465, -0.020528603345155716, 0.007276405580341816, -0.1202469915151596, -0.00892853643745184, -0.01936156488955021, -0.02616693824529648, 0.01650724560022354, -0.040972840040922165, -0.03816070407629013, 0.0019632233306765556, -0.03478613868355751, 0.003450141055509448, -0.023003283888101578, 0.04041041433811188, 0.021119151264429092, -0.011860189028084278, 0.010186967439949512, -0.015382391400635242, 0.043250672519207, -0.0508996844291687, -0.0037085062358528376, -0.010327574796974659, -0.019192837178707123, -0.012809285894036293, 0.04361625015735626, -0.035432931035757065, -0.03141157329082489, -0.002204012591391802, -0.028360405936837196, -0.003010744461789727, -0.032845765352249146, 0.025618571788072586, 0.03307073563337326, -0.011403216980397701, -0.002530923578888178, 0.020739512518048286, -0.056186504662036896, 0.004165478516370058, -0.021794063970446587, -0.013484198600053787, -0.012232797220349312, 0.01851792447268963, 0.009905753657221794, -0.019642779603600502, -0.020683269947767258, 0.0014579175040125847, -0.02123163640499115, -0.04074786975979805, -0.03011799044907093, 0.05514601245522499, 0.0143067492172122, -0.048115670680999756, 0.03239582106471062, 0.0762089192867279, 4.838853419641964e-05, 0.01484808512032032, 0.02289079874753952, 0.035461053252220154, -0.039341799914836884, 0.009287083521485329, -0.04971858859062195, -0.04623153805732727, 0.02611069567501545, 0.010840789414942265, -0.0019456475274637341, -0.022004975005984306, 0.033773768693208694, -0.04212581738829613, -0.02521081082522869, -0.0356016606092453, -0.03096163272857666, -0.04758136346936226, -0.005680517293512821, 0.016577549278736115, -0.04041041433811188, 0.0461471751332283, -0.03512359410524368, -0.03830131143331528, 0.010840789414942265, 0.0384981594979763, 0.007599801290780306, 0.045191045850515366, -0.019628718495368958, 0.04187272489070892, 0.06445419043302536, 0.03619220852851868, -0.004014326259493828, -0.06113586574792862, 0.06439794600009918, -0.010805637575685978, 0.006144520360976458, -0.019980235025286674, 0.011206367053091526, 0.027080882340669632, -0.014862146228551865, -0.07255314290523529, 0.03467365354299545, -0.010531454347074032, -0.008176289498806, -0.02123163640499115, -0.02201903611421585, -0.009258962236344814, 0.027727674692869186, 0.01933344453573227, 0.0685599073767662, 0.01819452829658985, -0.013442016206681728, -0.0013814624398946762, -0.026518454775214195, 0.005388758145272732, 0.005662941839545965, 0.036248449236154556, -8.502321725245565e-05, 0.02402971312403679, 0.01848980225622654, 0.01126261055469513, -0.02020520716905594, 0.06715384125709534, 0.018574167042970657, -0.015522997826337814, 0.05899864062666893, 0.00584221538156271, 0.08267683535814285, -0.015115238726139069, -0.019052229821681976, -0.020247388631105423, -0.008675443939864635, -0.024620262905955315, 0.02927435003221035, -0.03720457851886749, 0.0026240756269544363, -0.04963422566652298, 0.02014896459877491, -0.004893118981271982, 0.011290731839835644, 0.01017993688583374, -0.007473255041986704, 0.05911112576723099, -0.049859195947647095, -0.06664765626192093, 0.04111344739794731, 0.013020195998251438, 0.005701608490198851, -0.009392539039254189, -0.02499990165233612, 0.006721008103340864, -0.032452065497636795, -0.009097264148294926, -0.027094943448901176, 0.0023006799165159464, -0.031158482655882835, 0.004439661744982004, -0.043475642800331116, 0.02114727348089218, -0.01316080242395401, 0.007923197001218796, -0.0026416515465825796, 0.009153506718575954, -0.03273328021168709, 0.03917307406663895, -0.011550853960216045, -0.009476902894675732, 0.02246897667646408, -0.028725983574986458, 0.013526380993425846, 0.002005405491217971, -0.04274448752403259, -0.04980295151472092, 0.03619220852851868, 0.050281014293432236, -0.025309236720204353, 0.007163919974118471, 0.022778311744332314, 0.04583783820271492, 0.06186702102422714, 0.02289079874753952, 0.0051743327639997005, 0.03532044589519501, -0.014890267513692379, -0.0340268611907959, -0.05989852547645569, -0.017702404409646988, 0.02671530470252037, -0.026490334421396255, 0.00519542396068573, -0.06816621124744415, 0.034645531326532364, 0.019347505643963814, 0.01975526474416256, -0.006840524263679981, 0.0032409883569926023, 0.0073185875080525875, 0.06608522683382034, 0.01261946652084589, 0.00423929700627923, -0.03318322077393532, -0.02225806750357151, 0.047272030264139175, -0.01806798204779625, 0.004879058338701725, 0.012703830376267433, 0.0011872492032125592, 0.026026330888271332, -0.03366128355264664, -0.03312697634100914, 0.0032181397546082735, -0.028051070868968964, -0.059673555195331573, 0.043531887233257294, -0.02933059260249138, 0.020373934879899025, -0.044347405433654785, 0.00508996844291687, -0.031636543571949005, -0.004759542644023895, -0.017519615590572357, 0.004882573615759611, 0.051096536219120026, 0.017702404409646988, 0.005378212779760361, 0.02099260501563549, -0.03222709521651268, 0.011571945622563362, 0.0363890565931797, 0.01969902217388153, 0.010679091326892376, -0.004151417873799801, -0.02975241281092167, -0.05047786608338356, 0.032705157995224, 0.03425183147192001, 0.02764330990612507, -0.08076458424329758, 0.025492025539278984, -0.017871132120490074, -0.00012116357538616285, -0.012345283292233944, 0.005054817069321871, 0.0007148980512283742, 0.012338252738118172, 0.06912233680486679, 0.00176197977270931, 0.007606831379234791, -0.02505614422261715, 0.04485359042882919, 0.008787929080426693, 0.0225533414632082, 0.019713083282113075, -0.027432400733232498, -0.04069162905216217, -0.0017154037486761808, 0.013231106102466583, -0.01132588367909193, 0.033323828130960464, 0.02231431007385254, -0.012000796385109425, 0.02294704131782055, 0.00841532088816166, -0.026912154629826546, -0.000498714973218739, 0.0012109766248613596, -0.004014326259493828, 0.008457503281533718, 0.07069713622331619, -0.026307545602321625, -0.010201028548181057, -0.015115238726139069, 0.006580401211977005, -0.022567402571439743, 0.033267583698034286, 0.007993500679731369, 0.03565790131688118, 0.004664632957428694, 0.01653536781668663, 0.00449590478092432, -0.010011209174990654, 0.026940274983644485, 0.01251401100307703, 0.0024500747676938772, 0.009392539039254189, -0.0056980932131409645, 0.006253490224480629, -0.0031952911522239447, -0.0010167633881792426, -0.041788361966609955, 0.03335195034742355, 0.015143360011279583, 0.008787929080426693, 0.0017180402064695954, 0.01611354760825634, 0.017336826771497726, 0.017702404409646988, -0.005135665647685528, 0.005416879430413246, 0.005093483719974756, 0.006868645548820496, 0.004524026066064835, 0.02758706733584404, 0.023382922634482384, 0.06068592518568039, 0.02647627331316471, 0.0016907976241782308, 0.011698491871356964, -0.03177715092897415, 0.02879628725349903, -0.03309885784983635, 0.009223810397088528, -0.030342962592840195, 0.0029035317711532116, 0.008028652518987656, 0.03101787529885769, 0.06074216589331627, -0.005473122466355562, -0.037935733795166016, -0.04890307039022446, -0.06141708046197891, -0.044797349721193314, -0.008007560856640339, 0.017702404409646988, -0.053318124264478683, 0.035432931035757065, -0.04845312610268593, -0.054921042174100876, 0.01861634850502014, 0.05390867218375206, -0.03343631327152252, -0.02315795049071312, -0.050337258726358414, 0.023172011598944664, 0.026420030742883682, 0.03430807590484619, -0.032845765352249146, -0.03526420146226883, 0.03821694850921631, -0.04839688539505005, 0.019713083282113075, -0.025702934712171555, -0.010559575632214546, -0.023846924304962158, -0.017491495236754417, 0.023467285558581352, -0.04212581738829613, 0.04071974754333496, 0.001943890005350113, 0.03450492396950722, 0.014355961233377457, -0.0066050076857209206, -0.019220959395170212, 0.08250810950994492, -0.023256376385688782, 0.038470037281513214, -0.010805637575685978, 0.028444768860936165, 0.036220330744981766, -0.05984228476881981, -0.04364437237381935, -0.019291263073682785, 0.025351418182253838, 0.010433029383420944, 0.01571984775364399, 0.041394662111997604, 0.009786237962543964, 0.006907312199473381, -0.0037647488061338663, -0.02180812507867813, -0.04119781404733658, -0.01827889308333397, -0.004808754660189152, 0.0034044438507407904, -0.055427227169275284, 0.007557619363069534, -0.019684961065649986, 0.004070568829774857, -0.014180202968418598, 0.05087156593799591, 0.023537589237093925, 0.015888575464487076, 0.0384981594979763, -0.018110165372490883, -0.019952114671468735, 0.010158846154808998, 0.01746337302029133, -0.0037682640831917524, -0.018321074545383453, 0.04108532518148422, -0.016465064138174057, -0.020050538703799248, 0.014412203803658485, -0.0064749461598694324, -0.016338517889380455, -0.001723312889225781, -0.034561168402433395, -0.000874838384333998, -0.016971249133348465, 0.010348665527999401, -0.004966937471181154, -0.00012709542352240533, -0.02553420700132847, 0.029499320313334465, 0.03737330436706543, 0.004604875110089779, 0.04662523791193962, 0.014327839948236942, -0.0043869344517588615, 0.021358182653784752, 0.023720378056168556, 0.008113016374409199, 0.0236078929156065, -0.006292157340794802, 0.011086851358413696, -0.019417809322476387, 0.03346443548798561, -0.002646924229338765, -0.008049743250012398, -0.011375095695257187, -0.018560105934739113, 0.027446459978818893, -0.00645385542884469, -0.015185541473329067, -0.03987610712647438, -0.01801173947751522, -0.021526912227272987, 0.013948201201856136, -0.00835907831788063, -0.0036663240753114223, -0.014721538871526718, -0.06439794600009918, -0.0007069889106787741, 0.011586005799472332, -0.0032568066380918026, -0.05866118520498276, -0.010875941254198551, 0.0010009451070800424, 0.045219168066978455, 0.004253357648849487, -0.005118090193718672, 0.0047208755277097225, 0.010348665527999401, 0.002346377121284604, -0.015368330292403698, -0.022384613752365112, 0.04066350683569908, 0.0524744838476181, -0.0672663226723671, 0.005684032570570707, -0.008232532069087029, 0.0073818606324493885, 0.016254153102636337, 0.01803986169397831, 0.0005795639590360224, -0.020430177450180054, -0.010538484901189804, 0.018995987251400948, -0.01909441314637661, 0.010074482299387455, 0.005181363318115473, -0.01039084792137146, 0.0033798376098275185, -0.011389155872166157, -0.03700772672891617, 0.022693948820233345, 0.029471199959516525, -0.01531208772212267, -0.03664214909076691, 0.017955496907234192, -0.013090499676764011, 0.02840258739888668, -0.025070205330848694, -0.022061217576265335, 0.02439529076218605, -0.003198806196451187, -0.00195795064792037, -0.03017423301935196, -0.05047786608338356, -0.0034395954571664333, -0.018110165372490883, -0.04468486085534096, 0.029049379751086235, 0.013427956029772758, 0.014194263145327568, -0.04707517847418785, 0.003362261690199375, 0.05061847344040871, -0.01616979017853737, -0.04547226056456566, -0.018602289259433746, -0.02505614422261715, 0.007360769435763359, 0.03318322077393532, -0.047328270971775055, -0.052052661776542664, 0.006636644247919321, 0.00805677380412817, -0.010798607021570206, 0.0017004642868414521, -0.007227193098515272, 0.005764881614595652, 0.0021741336677223444, -0.03475801646709442, 0.015790151432156563, -0.007417012471705675, 0.001007975428365171, -0.020275510847568512, 0.035826630890369415, -0.008260653354227543, -0.023396983742713928, -0.020036479458212852, 0.009041021578013897, -0.02924622781574726, -0.021948732435703278, 0.03818882629275322, -0.02924622781574726, 0.028754103928804398, -0.05314939469099045, 0.014341900125145912, 0.003919416572898626, 0.03450492396950722, 0.009188658557832241, -0.002782258437946439, -0.009737025946378708, -0.016943126916885376, -0.009329265914857388, -0.03053981252014637, -0.035854753106832504, 0.033323828130960464, 0.01221170648932457, 0.025042083114385605, 0.0027031670324504375, -0.03444868326187134, 0.00531493965536356, 0.018082043156027794, -0.04502232000231743, 0.023115769028663635, 0.021273819729685783, 0.008879323489964008, -0.011691461317241192, 0.020795755088329315, -0.007578710094094276, -0.0027295309118926525, 0.01893974468111992, -0.02592790685594082, -0.002307710237801075, -0.02334073930978775, -0.04836876317858696, 0.026391908526420593, 0.021034788340330124, 0.03352067619562149, -0.024465594440698624, 0.01016587670892477, -0.043531887233257294, 0.000545730406884104, -0.00461542047560215, -0.04834064096212387, 0.006408158224076033, -0.029527442529797554, -0.0017004642868414521, 0.013596683740615845, 0.03343631327152252, 0.016451003029942513, 0.037963856011629105, 0.024929597973823547, -0.022398674860596657, -0.006559310480952263, -0.00420766044408083, 0.022159641608595848, -0.009392539039254189, 0.0018472226802259684, -0.013195954263210297, 0.012000796385109425, -0.0007421406335197389, -0.007979439571499825, 0.012415586039423943, -0.05638335272669792, 0.03790761157870293, -0.06760378181934357, -0.020219268277287483, 0.013378743082284927, -0.009926845319569111, 0.01999429613351822, -0.0007377466536127031, 0.009294114075601101, -0.013104559853672981, -0.0003991916892118752, -0.008626230992376804, -0.00111606705468148, -0.0027857734821736813, -0.013941170647740364, -0.004270933568477631, -0.0035028685815632343, 0.03177715092897415, -0.01764616183936596, -0.10635503381490707, -0.008323926478624344, 0.015424573794007301, -0.02376256138086319, 0.01238043513149023, -0.022356491535902023, -0.026377849280834198, -0.03526420146226883, 0.028740044683218002, 0.05053410679101944, -0.019600598141551018, -0.012724921107292175, -0.002320013241842389, -0.02286267653107643, 0.028599437326192856, -0.019867749884724617, 0.008380169048905373, 0.02370631881058216, 0.009898723103106022, 0.00888635404407978, -0.04505044221878052, -0.06867239624261856, 0.006035550031810999, -0.021301940083503723, -0.044375527650117874, 0.00558560760691762, -0.005360636860132217, 0.0029492289759218693, 0.010397877544164658, 0.011874250136315823, 0.025857603177428246, -0.012296070344746113, 0.04339127987623215, 0.014187232591211796, -0.03768264129757881, -0.026152877137064934, 0.007536528166383505, -0.04319442808628082, -0.0015730393351987004, -0.0071533746086061, -0.012942861765623093, -0.014313778840005398, -0.008014591410756111, 0.004949361551553011, 0.034139346331357956, 0.008900415152311325, -0.006580401211977005, 0.01861634850502014, -0.00847859401255846, 0.004021356347948313, 0.008077864535152912, -0.01292177103459835, 0.013561532832682133, -0.0006160338525660336, 0.008619201369583607, -0.002242679474875331, -0.021189454942941666, 0.026546576991677284, 0.004429116379469633, -0.027446459978818893, -0.0017338584875687957, -0.00010336801642552018, -0.017238402739167213, -0.011607096530497074, 0.007480285596102476, 0.0020880119409412146, -0.017674284055829048, -0.007719316985458136, -0.01638069935142994, -0.01650724560022354, 0.04102908447384834, -0.01882725954055786, -0.020050538703799248, 0.011902371421456337, 0.01735088787972927, 0.03177715092897415, -0.02054266259074211, -7.596066279802471e-05, 0.027151186019182205, -0.010636909864842892, 0.02207527868449688, -0.0340268611907959, -0.014805903658270836, 0.015171481296420097, 0.00267328810878098, -0.018995987251400948, -0.024718686938285828, -0.029021257534623146, 0.0020106781739741564, 0.003371049650013447, -0.061698295176029205, -0.028782226145267487, -0.007431073114275932, 0.012190615758299828, 0.02035987377166748, 0.003207594156265259, -0.00016224714636337012, 0.008794959634542465, -0.08689504116773605, -0.01619791053235531, 0.02402971312403679, -9.584335202816874e-05, -0.011375095695257187, -0.028965014964342117, 0.017575858160853386, 0.03951052948832512, 0.006049610674381256, -0.037935733795166016, 0.032086487859487534, -0.026420030742883682, 0.013097529299557209, -0.009357387199997902, 0.015410512685775757, -0.06422922015190125, 0.013090499676764011, -0.04960610345005989, 0.04654087498784065, 0.0029492289759218693, 0.003740142798051238, -0.009195689111948013, 0.02273613028228283, 0.009933874942362309, 0.0007676256354898214, 0.011002487502992153, 0.00669288681820035, 0.009202719666063786, -0.01064393948763609, 0.012935832142829895, -0.039623014628887177, -0.010665031149983406, 0.0027523795142769814, 0.053261879831552505, -0.05126526579260826, 0.01743525080382824, -0.008668413385748863, -0.013062378391623497, 0.009722964838147163, -0.010433029383420944, -0.00939956959336996, -0.06237320601940155, -0.009729995392262936, -0.011466490104794502, 0.04420679807662964, 0.02824791893362999, 0.035798508673906326, -0.016788460314273834, 0.01420129369944334, -0.006555795203894377, -0.01653536781668663, -0.011881280690431595, 0.02220182493329048, 0.033295705914497375, 0.005944155156612396, -0.011698491871356964, 0.007417012471705675, -0.008204410783946514, 0.03484238311648369, 0.019431868568062782, 0.001956193009391427, 0.016858763992786407, 0.01157897524535656, -0.010025269351899624, -0.0057543362490832806, -0.02566075325012207, 0.005800033453851938, 0.04550038278102875, -0.017097795382142067, -0.025801360607147217, -0.020247388631105423, 0.05261509120464325, 0.008541867136955261, 0.0216253362596035, -0.0026047423016279936, -0.0017654949333518744, 0.0524744838476181, 0.026884032413363457, -0.025196751579642296, -0.005645365919917822, 0.01851792447268963, -0.03996047005057335, 0.002557287458330393, -0.006759675219655037, 0.0016881611663848162, 0.02963992767035961, 0.014566871337592602, 0.01906629092991352, -0.02144254744052887, 0.03731706365942955, 0.04333503544330597, -0.026251303032040596, 0.01221170648932457, 0.008626230992376804, 0.016943126916885376, -0.00870356522500515, 0.0010940971551463008, 0.02821979857981205, 0.03816070407629013, 0.010496302507817745, 0.038441918790340424, 0.06203575059771538, -0.039229314774274826, -0.02147066965699196, -0.0015660090139135718, 0.030005505308508873, -0.0031952911522239447, -0.029949262738227844, -0.013287348672747612, -0.004949361551553011, 0.010531454347074032, 0.03172091022133827, -0.02180812507867813, 0.01816640794277191, -0.014194263145327568, 0.023172011598944664, 0.029780535027384758, 0.004524026066064835, 0.015354270115494728, 0.005220029968768358, 0.008773868903517723, 0.00403541699051857, -0.00953314546495676, -0.012542132288217545, -0.02885252982378006, -0.016577549278736115, 0.03383001312613487, 0.008366108871996403, -0.032030243426561356, -0.019558414816856384, 0.009371447376906872, 0.01377947349101305, -0.005441485904157162, -0.015058995224535465, 0.012464798986911774, -0.0025168629363179207, -0.01698531024158001, 0.03515171632170677, -0.04046665504574776, 0.04122593253850937, -0.004689238965511322, -0.0237344391644001, 0.021358182653784752, -0.02370631881058216, 0.0011635217815637589, -0.0001295121037401259, -0.0034395954571664333, -0.0363890565931797, -0.015522997826337814, -0.009884662926197052, 0.011150124482810497, -0.013870867900550365, -0.01870071329176426, 0.02381880395114422, 0.012246858328580856, 0.015213662758469582, -0.019530294463038445, -0.052052661776542664, 0.004144387319684029, 0.002634621225297451, 0.03602347895503044, 0.04358812794089317, -0.009483933448791504, -0.014974631369113922, -0.001058945432305336, -0.0321708507835865, -0.04277260974049568, -0.03101787529885769, -0.030708540230989456, 0.015101177617907524, -0.026223180815577507, -0.012731951661407948, 0.036360934376716614, 0.03489862382411957, 0.015677666291594505, 0.017294645309448242, -0.02611069567501545, -0.009497993625700474, 0.03492674604058266, 0.014749660156667233, 0.024353109300136566, -0.002181163989007473, -0.009610479697585106, -0.0062851267866790295, 0.02866974100470543, 0.011923462152481079, 0.014180202968418598, 0.001559857395477593, -0.020908242091536522, 0.03562977910041809, 0.0002662742626853287, 0.034139346331357956, -0.0072201625443995, 0.023846924304962158, 0.004137357231229544, -0.040551021695137024, 0.02921810746192932, 0.030736660584807396, -0.014510628767311573, -0.027657371014356613, 0.0027066823095083237, 0.018658531829714775, -0.010475211776793003, -0.007297496311366558, -0.0503653809428215, 0.01843355968594551, 0.005290333181619644, -0.016408821567893028, -0.022483037784695625, 0.04760948568582535, -0.027713613584637642, -0.002520378213375807, -0.031158482655882835, 0.0485374890267849, -0.011304792016744614, -0.017238402739167213, 0.005357121583074331, -0.00038271432276815176, -0.03276139870285988, -0.02827604115009308, -0.03278952091932297, -0.0057543362490832806, -0.0143067492172122, 0.011079820804297924, -0.004126811400055885, 0.005606698803603649, -0.003163654590025544, 0.0018841320415958762, -0.013202984817326069, 0.0062780966982245445, 0.01653536781668663, 0.00396862905472517, 0.009666722267866135, -0.02051454223692417, 0.010362726636230946, -0.010172907263040543, -0.016183851286768913, -0.009294114075601101, -0.02729179337620735, -0.019024109467864037, 0.03143969550728798, 0.014876206405460835, 0.005002089310437441, 0.02753082476556301, -0.004165478516370058, 0.012064069509506226, 0.026405969634652138, 0.02297516167163849, -0.010545515455305576, -0.011030608788132668, 0.001717161387205124, -0.023565711453557014, 0.029021257534623146, -0.014918388798832893, -5.066790618002415e-05, -0.0009042778983712196, 0.012064069509506226, 0.02592790685594082, 0.040888477116823196, 0.055399104952812195, -0.014482507482171059, 0.029836777597665787, 0.002799834357574582, -0.023537589237093925, 0.008506715297698975, -0.012717891484498978, -0.014384082518517971, 0.00039457803359255195, 0.00911132525652647, -0.004829845856875181, -0.03984798491001129, 0.01735088787972927, 0.022609584033489227, 0.01978338696062565, -0.0013304924359545112, -0.006302702706307173, -0.007438103202730417, -0.007824772037565708, 0.004397479817271233, -0.005975791718810797, -0.03835755214095116, -0.0092308409512043, -0.004538086708635092, 0.0012355828657746315, 0.017814889550209045, -0.02933059260249138, -0.04471298307180405, -0.01156491506844759, 0.027910463511943817, -0.029499320313334465, 0.006334339268505573, 0.019502172246575356, -0.03180527314543724, -0.007529497612267733, -0.038385674357414246, 0.010130724869668484, -0.009251931682229042, 0.003081047907471657, 0.03731706365942955, -0.026040391996502876, 0.025070205330848694, 0.03987610712647438, 0.03835755214095116, -0.0123944953083992, -0.0025783784221857786, 0.02885252982378006, 0.011354004964232445, -0.06192326545715332, -0.008049743250012398, 0.007311556953936815, -0.018025800585746765, 0.03101787529885769, -0.00958938803523779, 0.01930532231926918, 0.016338517889380455, -0.006091792602092028, -0.005272757727652788, -0.022848615422844887, 0.00958938803523779, -0.026040391996502876, 0.004337721969932318, 0.015916697680950165, 0.008963688276708126, -0.0005096999229863286, -0.02328449673950672, -0.007641983218491077, -0.00011556126992218196, -0.021034788340330124, 0.017758646979928017, 0.00939956959336996, 0.02183624729514122, -0.00911132525652647, 0.017955496907234192, 0.012949892319738865, -0.015241784043610096, 0.013104559853672981, -0.01677439920604229, -0.004439661744982004, 0.0037085062358528376, -0.030455447733402252, 0.04251951724290848, 0.017632100731134415, -0.017575858160853386, -0.011832067742943764, 0.003648748155683279, 0.0014579175040125847, -0.007719316985458136, 0.02059890702366829, -0.009462841786444187, -0.025070205330848694, 0.07182198762893677, -0.02225806750357151, -0.0022514674346894026, 0.009076173417270184, -0.013906018808484077, 0.02882440760731697, -0.03011799044907093, -0.0028806831687688828, -0.02924622781574726, -0.013941170647740364, 0.008471563458442688, 0.009526114910840988, -0.019347505643963814, -0.014904327690601349, 0.0061515504494309425, -0.017702404409646988, 0.010004178620874882, 0.010067451745271683, -0.018180467188358307, 0.02033175341784954, 0.021976852789521217, 0.03779512643814087, -0.014749660156667233, -0.0309897530823946, -0.01432080939412117, 0.0071814958937466145, 0.00882308091968298, 0.0305960550904274, 0.004791179206222296, 0.0384981594979763, 0.0076349531300365925, -0.019530294463038445, -0.044347405433654785, 0.03129908815026283, -0.02178000472486019, 0.045612867921590805, -0.029021257534623146, 0.03309885784983635, -0.0225533414632082, -0.012528072111308575, 0.0019351020455360413, 0.008197380229830742, -0.0038807494565844536, 0.013624805957078934, 0.0019755265675485134, -0.018995987251400948, -0.02701057866215706, 0.0010501575889065862, 0.009083203971385956, -0.017927376553416252, -0.013990383595228195, -0.013842746615409851, 0.02975241281092167, -0.013716200366616249, 0.005901973228901625, -0.017083734273910522, -0.005082938354462385, 0.0757027342915535, 0.015466755256056786, 0.012535102665424347, -0.03908871114253998, -0.008626230992376804, -0.02210339903831482, -0.012387464754283428, -0.027460521087050438, -0.06586025655269623, -0.031102240085601807, -0.019825568422675133, 0.010130724869668484, 0.04999980330467224, -0.021709701046347618, 0.0008453988120891154, 0.007213132455945015, -0.004007295705378056, 0.02439529076218605, 0.011958613991737366, 0.011368065141141415, 0.0017874648328870535, 0.03697960451245308, 0.04412243515253067, -0.023031404241919518, 0.005603183526545763, -0.03383001312613487, 0.022033095359802246, 0.009744055569171906, 0.00022178536164574325, 0.03470177575945854, -0.015987001359462738, -0.015157420188188553, 0.002344619482755661, -0.006945979315787554, 0.005325485020875931, 0.035404808819293976, 0.02864161878824234, -0.0005756093887612224, -0.005469607189297676, 0.002021223772317171, -0.005582092795521021, 0.032058365643024445, -0.0020264964550733566, 0.0004793815314769745, -0.01006042119115591, -0.021119151264429092, 0.011508672498166561, -0.01917877607047558, -0.005947670433670282, -0.026574697345495224, -0.007775560021400452, -0.01590263657271862, 0.010243210010230541, -0.015832332894206047, -0.000768504396546632, 0.014510628767311573, 0.006974100600928068, 0.009990117512643337, 0.027783917263150215, 0.011916432529687881, 0.010313513688743114, -0.003351716324687004, -0.0461471751332283, 0.032086487859487534, 0.0205707848072052, 0.03436432033777237, 0.013378743082284927, -0.014222384430468082, -0.005838700104504824, 0.008675443939864635, -0.013055347837507725, -0.01349122915416956, -0.02249709889292717, -0.010974366217851639, -0.0342799536883831, 0.008155198767781258, 0.0029421986546367407, -0.014215354807674885, 0.045191045850515366, 0.025970088317990303, -0.0008133228402584791, -0.008837142027914524, -0.012640557251870632, -0.008555928245186806, 0.03512359410524368, -0.004193599801510572, 0.03911682963371277, 0.0022338915150612593, -0.011410247534513474, 0.00042204029159620404, -0.017336826771497726, 0.024859294295310974, 0.013603714294731617, -0.0005958215915597975, 0.010067451745271683, 0.004154933150857687, -2.8395996196195483e-05, -0.016366640105843544, -0.0059617310762405396, 0.009645631536841393, -0.015382391400635242, -0.001929829246364534, 0.004116266034543514, 0.0013401592150330544, 0.007459194399416447, -0.02297516167163849, 0.009694843553006649, 0.006253490224480629, -0.032845765352249146, -0.046034689992666245, 0.021667517721652985, 0.011016547679901123, 0.011529763229191303, -0.004341237246990204, 0.005923064425587654, -0.008049743250012398, -0.005170817486941814, -0.01722434163093567, -0.030258597806096077, -0.037542033940553665, -0.010376786813139915, 0.0009288841392844915, 0.007107677403837442, -0.011431338265538216, -0.022033095359802246, 0.02658875845372677, 0.00466814823448658, -0.011832067742943764, 0.007072525564581156, 0.018531985580921173, 0.01577609032392502, -0.010847819969058037, -0.010552545078098774, 0.013420925475656986, 0.004105720669031143, 0.011058730073273182, 0.00994090549647808, 0.008352047763764858, 0.016732217743992805, 0.004812269937247038, 0.034083105623722076, 0.03222709521651268, 0.01285849791020155, -0.01548081636428833, -0.031636543571949005, 0.017927376553416252, -0.017632100731134415, 0.011150124482810497, 0.01503087393939495, 0.005079423077404499, 0.01822265051305294, 0.012267949059605598, -0.002819167682901025, 0.000460926879895851, -0.016732217743992805, 0.0175336766988039, 0.008183320052921772, 0.028290102258324623, -0.00519542396068573, 0.024142200127243996, 0.0134490467607975, -0.03776700422167778, -0.0074451337568461895, 0.012162494473159313, 0.010229149833321571, 0.01906629092991352, 0.00578948762267828, -0.04125405475497246, 0.05337436869740486, 0.0029140773694962263, -0.005395788699388504, 0.0031285027507692575, 0.03529232367873192, -6.843599840067327e-05, -0.005483667831867933, -0.007515436969697475, -0.01632445678114891, 0.018264831975102425, -0.01123448833823204, 0.001866556121967733, -0.006492522079497576, -0.002079223981127143, 0.009680782444775105, -0.012795224785804749, 0.016394760459661484, -0.004903664346784353, 0.025970088317990303, -0.041366539895534515, 0.06799747794866562, 0.026124756783246994, 0.04372873529791832, -0.03492674604058266, 0.01674627885222435, -0.006967070512473583, 0.03574226424098015, -0.023636015132069588, -0.0445723757147789, -0.0011810977011919022, -0.046906452625989914, 0.000991278444416821, -0.00764901377260685, -0.003181230276823044, 0.008907444775104523, -0.0051426962018013, -0.01584639400243759, -0.002096799900755286, 0.009294114075601101, -0.037513911724090576, 0.04057914391160011, 0.00624997541308403, 0.023143891245126724, 0.014932448975741863, -0.007227193098515272, -0.0011890068417415023, 0.02144254744052887, -0.006172641646116972, -0.024985840544104576, 0.028472891077399254, 0.03562977910041809, 0.014749660156667233, -0.008021621964871883, 0.008591080084443092, -0.0013199469540268183, 0.03810445964336395, -0.002548499498516321, -0.018785078078508377, -0.010728304274380207, 0.010517394170165062, -0.003947537858039141, -0.002972077578306198, -0.0041303266771137714, -0.005455546546727419, 0.00829580519348383, 0.0007957469788379967, 0.006126944441348314, 0.007810711394995451, -0.019136594608426094, 0.0015361300902441144, 0.015818271785974503, -0.006766705308109522, -0.019558414816856384, 0.006580401211977005, 0.03335195034742355, -0.029443077743053436, -0.020402057096362114, 0.005845730658620596, 0.023509468883275986, 0.006478461436927319, 0.03422371298074722, 0.0003335019282530993, 0.030230477452278137, -0.027418339625000954, 0.007501376327127218, -0.010988426394760609, 0.022384613752365112, -0.02201903611421585, 0.010397877544164658, 0.0013955231988802552, 0.024803051725029945, -0.03155218064785004, 0.020008357241749763, -0.003673354396596551, 0.05210890620946884, -0.00951908528804779, -0.013301409780979156, 0.004843906499445438, -0.0032023214735090733, -0.01263352669775486, -0.029358714818954468, -0.032873887568712234, 0.037935733795166016, 0.04471298307180405, 0.00935035664588213, 0.034139346331357956, -0.01803986169397831, 0.03948240727186203, 0.0039053556974977255, -0.008710595779120922, -0.0016336760018020868, -0.003775294404476881, 0.020472360774874687, 0.036754634231328964, -0.017927376553416252, -0.026659062132239342, 0.01483402494341135, -0.011178245767951012, -0.009631570428609848, -0.02719336748123169, 0.023467285558581352, 0.004640026483684778, 0.008787929080426693, -0.013020195998251438, -0.014651235193014145, 0.03430807590484619, 0.029611807316541672, 0.03346443548798561, -0.0048474217765033245, 0.030708540230989456, 0.0300617478787899, 0.02009272202849388, -0.005677002482116222, -0.028965014964342117, -0.0020880119409412146, -0.04057914391160011, -0.007213132455945015, 0.029977384954690933, 0.03380189090967178, -0.001755828270688653, 0.029836777597665787, -0.0006331703043542802, -0.013716200366616249, -0.01145945955067873, -0.008014591410756111, 0.0038491131272166967, 0.017210280522704124, 0.025351418182253838, 0.025365479290485382, -0.0164791252464056, -0.005736760329455137, -0.022665826603770256, -0.01157897524535656, -0.007086586207151413, -0.018377317115664482, 0.012851467356085777, -0.02969617024064064, 0.023115769028663635, -0.019642779603600502, -0.005940640345215797, 0.010222119279205799, -0.02078169584274292, 0.013280319049954414, -0.030033627524971962]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" Y .
The curious case of neural text degeneration, 2020.
Jiang, A. Q., Sablayrolles, A., Mensch, A., Bamford, C.,
Chaplot, D. S., Casas, D. d. l., Bressand, F., Lengyel, G.,
Lample, G., Saulnier, L., et al. Mistral 7b. arXiv preprint
arXiv:2310.06825 , 2023.
Kool, W., van Hoof, H., and Welling, M. Ancestral gumbel-
top-k sampling for sampling without replacement. Jour-
nal of Machine Learning Research , 21(47):1–36, 2020.
URL http://jmlr.org/papers/v21/19-985
.html .
Leviathan, Y ., Kalman, M., and Matias, Y . Fast inference
from transformers via speculative decoding. In Inter-
national Conference on Machine Learning , pp. 19274–
19286. PMLR, 2023.
Li, Y ., Zhang, C., and Zhang, H. Eagle: Lossless accelera-
tion of llm decoding by feature extrapolation, December
2023. URL https://sites.google.com/vie
w/eagle-llm .
Lin, C.-Y . ROUGE: A package for automatic evaluation
of summaries. In Text Summarization Branches Out ,
pp. 74–81, Barcelona, Spain, July 2004. Association for
Computational Linguistics. URL https://www.ac
lweb.org/anthology/W04-1013 .
Liu, X., Hu, L., Bailis, P., Stoica, I., Deng, Z., Cheung, A.,
and Zhang, H. Online speculative decoding, 2023.
Miao, X., Oliaro, G., Zhang, Z., Cheng, X., Wang, Z., Wong,
R. Y . Y ., Zhu, A., Yang, L., Shi, X., Shi, C., Chen, Z.,
9
Lookahead decoding
Arfeen, D., Abhyankar, R., and Jia, Z. Specinfer: Ac-
celerating generative large language model serving with
speculative inference and token tree verification, 2023.
Narayan, S., Cohen, S. B., and Lapata, M. Don’t give me
the details, just the summary! Topic-aware convolutional
neural networks for extreme summarization. In Proceed-
ings of the 2018 Conference on Empirical Methods in
Natural Language Processing , Brussels, Belgium, 2018.
Narayanan, D., Shoeybi, M., Casper, J., LeGresley, P., Pat-
wary, M., Korthikanti, V . A., Vainbrand, D., Kashinkunti,
P., Bernauer, J., Catanzaro, B., Phanishayee, A., and Za-
haria, M. Efficient large-scale language model training
on gpu clusters using megatron-lm, 2021.
OpenAI. Gpt-4 technical report, 2023.
Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright, C.,
Mishkin, P., Zhang, C., Agarwal, S., Slama, K., Ray, A.,
et al. Training language models to follow instructions
with human feedback. Advances in Neural Information
Processing Systems , 35:27730–27744, 2022.
Roziere, B., Gehring, J., Gloeckle, F., Sootla, S., Gat, I.,
Tan, X. E., Adi, Y ., Liu, J., Remez, T., Rapin, J., et al.
Code llama: Open foundation models for code. arXiv
preprint arXiv:2308.12950 , 2023.
Ruan, J. T., Sabir, F., and Chopra, P. Best prompting prac-
tices for using the llama 2 chat llm through amazon
sagemaker jumpstart, November 2023. URL https:
//aws.amazon.com/cn/blogs/machine-lea
rning/best-prompting-practices-for-u
sing-the-llama-2-chat-llm-through-a
mazon-sagemaker-jumpstart/ .
Santilli, A., Severino, S., Postolache, E., Maiorca, V ., Man-
cusi, M., Marin, R., and Rodola, E. Acceler","[-0.0027079349383711815, 0.04702309891581535, 0.013339834287762642, -0.008631657809019089, 0.02500760555267334, -0.004202157724648714, -0.012276461347937584, 0.043913647532463074, -0.03282523155212402, 0.0032927903812378645, 0.0354359969496727, -0.038428109139204025, -0.056703463196754456, 0.01564992032945156, -0.0066479165107011795, -0.00014059903332963586, -0.001180710969492793, -0.02335021086037159, 0.0010606232099235058, 0.0573488213121891, -0.01046505942940712, -0.01377985067665577, -0.02403957024216652, 0.035729341208934784, 0.023584885522723198, -0.022015493363142014, 0.0031387845519930124, 0.05118858814239502, -0.0030581147875636816, -0.03505465015769005, 0.028029052540659904, -0.04089220240712166, -0.02852773852646351, -0.015312574803829193, -0.03217987343668938, 0.029921123757958412, 0.0223088376224041, -0.013442505151033401, -0.025960974395275116, -0.0022184166591614485, -0.029451772570610046, -0.08853132277727127, -0.008726994507014751, 0.022044828161597252, 0.0014777221949771047, 0.026327654719352722, 0.009592359885573387, 0.0027427696622908115, 0.015488581731915474, 0.05312466248869896, -0.041713565587997437, 0.024948935955762863, -0.034907978028059006, 0.011205754242837429, -0.04743378236889839, -0.008455650880932808, -0.013061157427728176, 0.038662783801555634, 0.016881966963410378, -0.04062819108366966, -0.02411290630698204, -0.04276960715651512, -0.016207275912165642, 0.016559287905693054, -0.039220139384269714, -0.02949577383697033, -0.05978357791900635, 0.007993633858859539, -0.00734094250947237, 0.026312988251447678, -0.006453575566411018, 0.004744844976812601, 0.01792334020137787, -0.04470567777752876, -0.022118164226412773, 0.01768866367638111, -0.013222496956586838, 0.09791834652423859, -0.01633927971124649, -0.03132917732000351, 0.02335021086037159, 0.02469959482550621, 0.013200495392084122, -0.04417765885591507, -0.03819343447685242, -0.014476543292403221, -0.004715510178357363, 0.015459246933460236, -0.028967754915356636, -0.023790227249264717, -0.029217097908258438, -0.005522207356989384, -0.05083657428622246, 0.005338867194950581, 0.07497881352901459, 0.04335629567503929, 0.013024489395320415, -0.012943819165229797, 0.04429499804973602, 0.0435909703373909, -0.010538395494222641, 0.002409090520814061, 0.03012646548449993, -0.03872145339846611, 0.04452967271208763, -0.010098379105329514, -0.031006498262286186, -0.034350622445344925, -0.019492732360959053, 0.02518361248075962, -0.10583864152431488, -0.01661795750260353, -0.04086286947131157, -0.020856782793998718, -0.006072227843105793, -0.03854544833302498, -0.03349992632865906, -0.01886204071342945, -0.0159285981208086, 0.002935276832431555, -0.03244388476014137, -0.007076932583004236, 0.025726299732923508, -0.02082744799554348, 0.006431574933230877, -0.046201735734939575, 0.021634146571159363, -0.05509006977081299, -0.002464092569425702, -0.02857173979282379, 0.01449121069163084, -0.005199528764933348, 0.048929836601018906, -0.03399860858917236, -0.023130202665925026, -0.018495360389351845, -0.025403620675206184, -0.018114013597369194, -0.05315399542450905, 0.01779133453965187, 0.014828557148575783, -0.010670401155948639, -0.0542980395257473, 0.008822331205010414, -0.06312770396471024, 0.004451500717550516, -0.021194128319621086, -0.026136981323361397, -0.03367593139410019, -0.009746366180479527, 0.006402240600436926, 0.0065965810790658, -0.035876013338565826, 0.0054232035763561726, -0.05995958670973778, -0.021267464384436607, -0.030595814809203148, 0.03534799441695213, 0.025638295337557793, -0.058698203414678574, -0.006266568787395954, 0.061954326927661896, 0.025154277682304382, -0.012980487197637558, 0.017806002870202065, 0.027589036151766777, -0.049927208572626114, 0.009643695317208767, -0.06776254624128342, -0.038222767412662506, 0.015063232742249966, -0.008800330571830273, -0.012349797412753105, -0.036902718245983124, -0.007164935581386089, -0.02172214910387993, -0.006171231623739004, -0.05467938631772995, -0.0021157460287213326, -0.029334435239434242, -0.004293827805668116, 0.02469959482550621, -0.03320658206939697, 0.009035006165504456, -0.031827863305807114, -0.018422024324536324, -0.02279285527765751, 0.03699072077870369, -0.0075682844035327435, 0.039572153240442276, -0.017395319417119026, 0.031065165996551514, 0.08266443759202957, 0.024919603019952774, 0.023262206465005875, -1.183117365144426e-05, 0.0693466067314148, -0.04062819108366966, 0.02666500210762024, -0.01924338936805725, 0.0021927489433437586, 0.05268464609980583, -0.0035898014903068542, -0.04878316447138786, 0.0042608268558979034, -0.015048565343022346, 0.004176490008831024, -0.003465130226686597, -0.04966319724917412, -0.02248484455049038, 0.05101258307695389, 0.010560396127402782, 0.07116533815860748, 0.016691293567419052, -0.06107429414987564, -0.001044122502207756, -0.08389648050069809, 0.012848482467234135, -0.011007746681571007, 0.022572847083210945, -0.004059152211993933, 0.021634146571159363, -0.002467759419232607, 0.024098237976431847, -0.022616850212216377, 0.04320962354540825, 0.033147912472486496, -0.03077182173728943, 0.022851524874567986, 0.011873112991452217, 0.07738424092531204, -0.02245550975203514, -0.009570359252393246, -0.025256948545575142, 0.0028711077757179737, -0.05104191601276398, 0.006996262818574905, -0.030302470549941063, -9.241492807632312e-05, -0.019082050770521164, 0.03329458460211754, 0.002399923512712121, 0.02704634889960289, 0.020563438534736633, 0.0003455963160376996, 0.04112687706947327, -0.029818452894687653, -0.08154972642660141, 0.05280198156833649, 0.02421557530760765, 0.004715510178357363, -0.02597564272582531, 0.013354501686990261, -0.014938561245799065, -0.03347058966755867, -0.03731340169906616, -0.0502205528318882, -0.009577693417668343, -0.034350622445344925, -0.017365984618663788, -0.008558321744203568, 0.0006031893426552415, -0.008800330571830273, 0.04755111783742905, 0.015473914332687855, -0.015576585195958614, -0.041361551731824875, 0.02051943726837635, 0.007014596834778786, -0.018700702115893364, -0.016251277178525925, -0.037665415555238724, 0.0032451217994093895, 0.036462701857089996, -0.05063123628497124, -0.023834228515625, 0.009431020356714725, 0.026855675503611565, -0.021062124520540237, 0.027545034885406494, 0.008242975920438766, 0.00594022311270237, 0.04024684429168701, 0.02227950282394886, 0.013420503586530685, 0.03787075728178024, 0.019082050770521164, -0.027002347633242607, -0.02780904434621334, -0.003250621957704425, 0.023467548191547394, -0.008998338133096695, 0.006112562958151102, -0.02610764652490616, 0.045409705489873886, 0.03132917732000351, 0.043678972870111465, 0.01817268319427967, -0.02161947824060917, 0.008726994507014751, 0.03540666401386261, 0.0020607439801096916, 0.0064389086328446865, -0.012188457883894444, -0.005525873973965645, 0.0486951619386673, -0.03129984065890312, -0.009702363982796669, 0.032209210097789764, -0.018436692655086517, 0.0033092908561229706, 0.02483159862458706, -0.016456618905067444, -0.009673030115664005, -0.025124942883849144, -0.07474414259195328, 0.051657941192388535, -0.04335629567503929, 0.0446176752448082, -0.05412203073501587, -0.015209904871881008, -0.0009185344679281116, -0.0011962949065491557, 0.0041654896922409534, -0.04221225157380104, 0.023188870400190353, -0.009460355155169964, -0.007590285036712885, 0.0017527324380353093, -0.02770637348294258, 0.010120379738509655, 0.02469959482550621, 0.01996208354830742, 0.019126052036881447, -0.025711631402373314, -0.05013255029916763, -0.03156385198235512, 0.03094782866537571, 0.023496882990002632, 0.004990520887076855, -0.08671259135007858, 0.016397949308156967, -0.032414551824331284, -0.008660991676151752, -0.003430295502766967, -0.002757436828687787, -0.00037470157258212566, 0.02870374545454979, 0.05013255029916763, 0.028161058202385902, -0.0074472795240581036, -0.03660937398672104, 0.045820388942956924, -0.03235588222742081, 0.016573956236243248, 0.015429913066327572, 0.005129859317094088, -0.023115534335374832, 0.013347167521715164, 0.01937539502978325, -0.023570219054818153, 0.006266568787395954, 0.015209904871881008, 0.016104605048894882, 0.01796734146773815, 0.020050086081027985, -0.015473914332687855, -0.012907151132822037, 0.022044828161597252, -0.030273137614130974, -0.004961186088621616, 0.008037635125219822, -0.03305990993976593, -0.0039014797657728195, -0.03672671318054199, 0.005122525617480278, -0.03675604611635208, 0.018612699583172798, -0.01328116562217474, 0.06917059421539307, 0.01001770980656147, -0.001095457817427814, 0.0029334435239434242, -0.017659330740571022, -0.001879237242974341, 0.013325166888535023, 0.009350351057946682, -0.0016418116865679622, 0.009709698148071766, 0.00014266160724218935, -0.006185899022966623, -0.025124942883849144, -0.06083961948752403, 0.01535657700151205, 0.03349992632865906, 0.026019643992185593, -0.008074303157627583, 0.015224571339786053, 0.02804371900856495, 0.03652137145400047, 0.007934964261949062, -0.014703885652124882, 0.00044597507803700864, 0.003274456365033984, -0.013310499489307404, 0.04033484682440758, 0.03347058966755867, 0.049340520054101944, 0.01837802305817604, 0.0105163948610425, 0.03625736013054848, -0.07638686895370483, 0.017556659877300262, -0.056146107614040375, -0.004700843244791031, -0.030273137614130974, 0.01799667626619339, 0.007135601248592138, 0.024376915767788887, 0.06189565733075142, -0.0004821847833227366, -0.015312574803829193, -0.03367593139410019, -0.032385215163230896, -0.05423936992883682, 0.026092980057001114, 0.029891788959503174, -0.06430108100175858, 0.02684100717306137, -0.04596706107258797, -0.028205059468746185, 0.00016156856145244092, 0.04784446209669113, -0.017659330740571022, -0.00927701499313116, -0.04922318086028099, 0.014755221083760262, 0.04470567777752876, 0.0044038319028913975, -0.03995350003242493, -0.011924447491765022, 0.009394352324306965, -0.058668870478868484, 0.020328763872385025, -0.003256122348830104, 0.014821222983300686, -0.019771408289670944, 0.013237163424491882, -0.008800330571830273, -0.05315399542450905, 0.015239238739013672, -0.016573956236243248, 0.05758349597454071, 0.022983530536293983, 0.0021707480773329735, -0.05115925520658493, 0.08178440481424332, -0.032971903681755066, 0.04420699179172516, 0.009035006165504456, 0.021194128319621086, 0.004275493789464235, -0.028249060735106468, -0.004396498203277588, -0.023012863472104073, 0.008873666636645794, 0.03523065522313118, 0.018627366051077843, 0.04772712662816048, 0.0196247361600399, 0.010927077382802963, -0.02518361248075962, -0.01985941268503666, -0.019639404490590096, -0.008880999870598316, 0.010839073918759823, 0.010670401155948639, -0.045233700424432755, 0.00463850749656558, -0.022778188809752464, 0.018598031252622604, 0.004422165919095278, 0.031035831198096275, 0.014718553051352501, 0.02541828714311123, 0.05247930437326431, 0.002880274783819914, 0.0033789603039622307, 0.004378164187073708, 0.0022605848498642445, 0.0022385839838534594, -0.010905075818300247, 0.03291323781013489, -0.018026011064648628, 0.01937539502978325, 0.004297494888305664, -0.008785663172602654, -0.028131723403930664, -0.0036943054292351007, -0.02462625876069069, -0.030625149607658386, -0.018451359122991562, -0.023922231048345566, 0.02946643903851509, -0.025579627603292465, -0.017424654215574265, 0.01937539502978325, -0.005617544054985046, -0.0080303018912673, 0.02780904434621334, -0.010670401155948639, 0.006768920924514532, 0.0022184166591614485, 0.015987267717719078, 0.0003105324867647141, 0.03349992632865906, -0.046612415462732315, 0.01917005330324173, -0.009321016259491444, 0.010457726195454597, 0.006281235720962286, -0.015869928523898125, 0.007032930850982666, -0.023878229781985283, 0.007648953702300787, 0.007560950703918934, -0.020182091742753983, -0.07791225612163544, -0.010751070454716682, -0.008044968359172344, 0.007102599833160639, -0.021472806110978127, -0.001380551839247346, 0.008998338133096695, -0.057847507297992706, -0.008983670733869076, 0.013442505151033401, -0.004994187504053116, -0.044060319662094116, -0.014703885652124882, 0.009570359252393246, 0.046231068670749664, 0.022924860939383507, 0.0005445204442366958, -0.0001526307314634323, -0.02414223924279213, 0.00031465766369365156, -0.022880859673023224, -0.008888334035873413, 0.030009126290678978, 0.0792616456747055, -0.0361986942589283, 0.018026011064648628, -0.0196247361600399, 0.00047576785436831415, -0.012921818532049656, 0.0052398634143173695, 0.007619619369506836, -0.012863149866461754, 0.010010375641286373, 0.017747333273291588, -0.026635667309165, -0.01115441881120205, 0.029275765642523766, -0.02967178076505661, -0.023100867867469788, 0.010237718001008034, 0.007109933532774448, -0.005987891461700201, 0.022602181881666183, -0.010582397691905499, -0.021678147837519646, 0.013772517442703247, -0.008631657809019089, 0.015371243469417095, -0.03423328697681427, 0.013589177280664444, 0.002629098715260625, -0.011066415347158909, 0.015209904871881008, -0.053007323294878006, -0.027471698820590973, -0.027647705748677254, -0.0070952665992081165, -0.03731340169906616, 0.012122455053031445, -0.0035109652671962976, 0.030419809743762016, -0.05247930437326431, 0.0006517744623124599, 0.06840790063142776, -0.025476956740021706, -0.04508702829480171, -0.03173985704779625, -0.019874079152941704, -0.018040677532553673, 0.026753004640340805, -0.05274331569671631, -0.04033484682440758, 0.014711218886077404, 0.015121901407837868, -0.012261793948709965, -0.02829306200146675, 0.00789096299558878, 0.0011174586834385991, 0.001760066137649119, -0.03294257074594498, 0.018700702115893364, 0.014608548954129219, -0.007912963628768921, -0.009049673564732075, 0.009049673564732075, -0.0002857815707102418, -0.05978357791900635, -0.02304219827055931, 0.0015758092049509287, -0.004913517739623785, -0.03443862497806549, 0.04819647595286369, -0.020402099937200546, 0.004491835366934538, -0.031827863305807114, 0.0005518540856428444, 0.00874166190624237, 0.001729814917780459, 0.001470388495363295, -0.014131863601505756, -0.015107234008610249, -0.03173985704779625, -0.020915452390909195, -0.028351731598377228, -0.015532582998275757, 0.04508702829480171, 0.01305382326245308, 0.0030837825033813715, -0.0011880446691066027, -0.012239793315529823, -0.022748854011297226, 0.01613393984735012, -0.023570219054818153, 0.012584473006427288, 0.02666500210762024, -0.004143489059060812, -0.033763933926820755, 0.016881966963410378, -0.016969971358776093, -0.0028527737595140934, 0.004011483862996101, -0.014095195569097996, -0.013112492859363556, -0.02480226382613182, -0.03502531349658966, 0.014667217619717121, 0.001100041321478784, 0.035142652690410614, -0.028073053807020187, 0.006310570519417524, -0.02873307839035988, 0.01827535219490528, -0.01240113191306591, -0.06629582494497299, -0.00594022311270237, -0.03546533361077309, 0.010223050601780415, -0.028073053807020187, 0.03907346725463867, 0.00662224879488349, 0.019698072224855423, 0.026312988251447678, 0.0023119200486689806, -0.009460355155169964, 0.01255513820797205, 0.015503249131143093, -0.02034343034029007, 0.0024879267439246178, -0.036668043583631516, 0.01689663529396057, -0.037489406764507294, 0.011667771264910698, 0.016837965697050095, -0.03077182173728943, 0.03743073716759682, -0.0685839056968689, -0.009621694684028625, 0.016001934185624123, -0.00228441902436316, 0.04452967271208763, 0.011990450322628021, 0.010765737853944302, -0.003047114470973611, 0.0037309734616428614, -0.010039710439741611, 0.011081082746386528, -0.022543514147400856, 0.0017802334623411298, 0.008433650247752666, -0.005584543105214834, 0.04804980382323265, -0.018818039447069168, -0.08483518660068512, -0.016485951840877533, -0.006772587541490793, -0.017013972625136375, 0.0015226404648274183, -0.01692596822977066, -0.024376915767788887, -0.015840595588088036, -0.0027336026541888714, 0.04570304974913597, -0.007986299693584442, -0.00401515094563365, -0.0221768319606781, -0.023306207731366158, 0.010670401155948639, -0.04244692623615265, 0.01193178165704012, 0.02024075947701931, -0.02207416296005249, 0.000769570586271584, -0.04804980382323265, -0.043062951415777206, 0.01985941268503666, -0.037812087684869766, -0.012481802143156528, 0.0062849028035998344, -0.013413170352578163, -0.006911926437169313, 0.0117264399304986, -0.0032799565233290195, 0.010685067623853683, -0.010941743850708008, 0.009753699414432049, 0.03751874342560768, -0.030390474945306778, -0.022748854011297226, -0.0005486456211656332, -0.04241759330034256, -0.006310570519417524, -0.02794105000793934, -0.019668739289045334, -0.00030136547866277397, -0.009746366180479527, -0.010787738487124443, 0.043502967804670334, 0.01516590267419815, -0.024288911372423172, 0.020299429073929787, 0.0071796029806137085, 0.009753699414432049, 0.007494948338717222, -0.04341496527194977, 0.014916560612618923, -0.008631657809019089, -0.005404869560152292, -0.01380185130983591, -0.016148606315255165, 0.002007575472816825, -0.006237233988940716, -0.011455097235739231, 0.01993274874985218, 0.017732666805386543, 0.01564992032945156, -0.006838589906692505, 0.04318028688430786, 0.019918080419301987, -0.027750374749302864, 0.010611731559038162, 0.011389094404876232, 0.0048621827736496925, 0.032561223953962326, -0.010098379105329514, -0.04244692623615265, 0.01065573375672102, 0.019184719771146774, 0.03429195284843445, -0.018026011064648628, -0.0038134765345603228, 0.03640403226017952, -0.002893108641728759, 0.026034310460090637, -0.02279285527765751, 0.0008341979701071978, 0.019434062764048576, -0.02559429407119751, -0.01385318674147129, -0.020856782793998718, -0.05004454776644707, -0.014410541392862797, -0.013376502320170403, -0.024450251832604408, -0.03634536638855934, -0.014388540759682655, 0.010751070454716682, -0.00326345581561327, 0.011198420077562332, 0.02832239679992199, -0.006270235404372215, -0.10255318135023117, -0.04828447848558426, 0.010025043040513992, -0.0019800744485110044, 0.014483877457678318, -0.03417461737990379, 0.00855098757892847, 0.03481997549533844, -0.0014034693595021963, -0.03886812552809715, 0.02518361248075962, -0.002471426036208868, -0.0019580735825002193, -0.003384460462257266, 0.005742215551435947, -0.06817322969436646, 0.010245051234960556, -0.04379631206393242, 0.03171052411198616, 0.0009900372242555022, -0.015136568807065487, -0.0031296175438910723, 0.005610210821032524, 0.03091849386692047, -0.006688251160085201, -0.021326133981347084, 0.003523798892274499, 0.023966234177350998, 0.0053205331787467, 0.02148747444152832, -0.01651528663933277, -0.025036940351128578, -0.005496539641171694, 0.05054323002696037, -0.043913647532463074, -0.007307941094040871, -0.02449425309896469, -0.030889159068465233, -0.030419809743762016, -0.02138480357825756, 0.0011779608903452754, -0.061778318136930466, 0.031006498262286186, -0.006625915411859751, 0.0303318053483963, 0.02172214910387993, 0.008279643952846527, -0.002792271552607417, 0.0017811502330005169, -0.018730036914348602, 0.0184806939214468, 0.012122455053031445, -0.017292648553848267, 0.02283685840666294, -0.010076378472149372, -0.008264977484941483, -7.809147064108402e-05, -0.0059365564957261086, 0.042476262897253036, 0.039777494966983795, -0.017600661143660545, -0.0022917527239769697, -0.006226233672350645, -0.01575259119272232, -0.04024684429168701, -0.01507789921015501, -0.024054236710071564, 0.02238217368721962, 0.0022917527239769697, -0.03966015577316284, -0.05104191601276398, 0.05394602566957474, 0.005437870975583792, 0.022880859673023224, 0.00457617174834013, 0.0038794788997620344, 0.025036940351128578, 0.04546837508678436, -0.019258055835962296, -0.0053095328621566296, 0.020328763872385025, -0.05288998782634735, -0.014769887551665306, -0.0051555270329117775, -0.0025759299751371145, 0.012877817265689373, 0.04318028688430786, -0.0039858161471784115, -0.0384867787361145, 0.0288064144551754, 0.032971903681755066, -0.012980487197637558, 0.0173366516828537, -0.01526857353746891, 0.0025135944597423077, -0.004191157408058643, -0.01947806403040886, 0.02179548516869545, 0.025036940351128578, 0.007905630394816399, 0.04112687706947327, 0.04051085561513901, -0.041566893458366394, 0.00394548149779439, 0.028234394267201424, 0.02735435962677002, 0.006713918875902891, 0.0033092908561229706, 0.027677038684487343, -0.002608931390568614, 0.015708589926362038, 0.026635667309165, -0.014087862335145473, 0.0027042683213949203, 0.00913767609745264, 0.01868603564798832, 0.022132830694317818, 0.04400165379047394, 0.014894559048116207, 0.006787254940718412, 0.011169086210429668, 0.01464521698653698, -0.03487864136695862, -0.022910194471478462, -0.047169771045446396, -0.02908509224653244, 0.030683819204568863, 0.009687697514891624, -0.013574509881436825, 0.002539261942729354, -0.002212916500866413, -0.0011440429370850325, -0.005500206723809242, 0.006156564690172672, -0.008022967725992203, -0.006152897607535124, -0.007069598883390427, 0.026224985718727112, -0.037460073828697205, 0.023306207731366158, 0.02266085147857666, 0.0013273832155391574, 0.02214749902486801, 0.0002431549655739218, -0.003197453450411558, -0.012848482467234135, -0.0184806939214468, -0.020094087347388268, -0.0303318053483963, 0.009937039576470852, 0.00913767609745264, -0.017938006669282913, -0.010787738487124443, 0.03176919370889664, 0.012951153330504894, 0.008052302524447441, 0.00014357830514200032, -0.0466417521238327, -0.003916147165000439, 0.012041785754263401, 0.02376089245080948, 0.04778579622507095, -0.006567246746271849, -0.02207416296005249, 0.0012027118355035782, -0.01914071850478649, -0.029246430844068527, -0.007285940460860729, -0.03933747857809067, 0.019316725432872772, -0.03347058966755867, 0.00019903872453141958, 0.036902718245983124, 0.022778188809752464, 0.008169639855623245, 0.0065232450142502785, 0.0251102764159441, -0.005954890511929989, 0.01730731688439846, 0.02365822158753872, 0.01682329922914505, 0.002255084691569209, -0.00401515094563365, 0.031798526644706726, 0.025432955473661423, 0.003558633616194129, 0.013699181377887726, 0.0005083107389509678, -0.0002656141296029091, 0.058111514896154404, -0.028542404994368553, 0.009570359252393246, 0.009599694050848484, 0.06641316413879395, -0.004986853804439306, -0.01761532761156559, 0.01965407095849514, 0.036492038518190384, -0.03443862497806549, -0.010355055332183838, 0.004895183723419905, 0.044089656323194504, -0.008184307254850864, 0.01771799847483635, -0.033763933926820755, 0.022602181881666183, -0.015987267717719078, -0.005485539324581623, -0.0042608268558979034, 0.016984637826681137, -0.024464918300509453, 0.0006448992062360048, -0.021854154765605927, 0.025022273883223534, -0.007949631661176682, -0.012863149866461754, 0.029583778232336044, 0.022264836356043816, -0.037225399166345596, -0.029055757448077202, -0.026885010302066803, -0.0247289277613163, -0.03282523155212402, 0.01305382326245308, -0.01314182672649622, 0.02214749902486801, -0.005712881218641996, -0.002564929658547044, -0.026415659114718437, -0.00398948322981596, 0.012914485298097134, 0.0156792551279068, 0.006534245330840349, -0.01830468699336052, -0.003452296368777752, -0.020578106865286827, -0.0031736192759126425, -0.017747333273291588, -0.00262543186545372, -0.0021615810692310333, 0.04819647595286369, -0.004158155992627144, -0.003102116519585252, 0.0008658241713419557, -0.0075976187363266945, 0.00906434003263712, 0.030243802815675735, 0.03367593139410019, -0.03523065522313118, -0.02079811505973339, 0.006013559177517891, -0.008675659075379372, 0.046407077461481094, 0.006937593687325716, -0.006409573834389448, -0.0026969346217811108, 0.017043307423591614, 0.048900503665208817, 0.025051606819033623, 0.037636078894138336, -0.014960561878979206, 0.02238217368721962, 0.00391248008236289, -0.009526357986032963, 0.02021142654120922, -0.03053714707493782, -0.0070549314841628075, 0.004755845293402672, 0.0017866503912955523, -0.0008071553311310709, -0.023922231048345566, 0.026019643992185593, 0.006578247062861919, 0.035876013338565826, -0.010267051868140697, -0.02635698951780796, -0.00044597507803700864, -0.02131146751344204, -0.0010422891937196255, 0.018348688259720802, -0.015415245667099953, -0.02062210813164711, -0.006933927070349455, -0.02541828714311123, 0.0037053057458251715, -0.010479726828634739, -0.019668739289045334, -0.007670954801142216, 0.0443536639213562, -0.036110688000917435, 0.01820201613008976, 0.03270789608359337, -0.010626398958265781, -0.009225679561495781, -0.019668739289045334, 0.0005637711728923023, 0.008954335935413837, -0.0013484673108905554, 0.03408661484718323, -0.014293203130364418, 0.010091045871376991, 0.009269681759178638, 0.018260685727000237, -0.013361834920942783, 0.017703332006931305, 0.02411290630698204, 0.016661958768963814, -0.04262293502688408, 0.0019525733077898622, -0.008382314816117287, -0.018627366051077843, 0.041537560522556305, 0.02016742341220379, -0.0006123563507571816, 0.022367507219314575, -0.025550292804837227, 0.0021285798866301775, -0.025784967467188835, 0.009519023820757866, -0.025124942883849144, 0.005063856951892376, 0.006801921874284744, 0.013061157427728176, 0.0006577330059371889, 0.0052691977471113205, -0.009181678295135498, -0.0032982905395329, -0.01792334020137787, 0.0184806939214468, -0.004150822758674622, 0.014549879357218742, -0.011015079915523529, -0.016309944912791252, 0.01134509313851595, -0.009409019723534584, 0.0035274657420814037, -0.027574369683861732, -0.000839698186609894, 0.004048151895403862, -0.03267855942249298, 0.04552704468369484, 0.010267051868140697, -0.0002805105468723923, 0.008272310718894005, -0.0009194511803798378, -0.01397052500396967, -0.01516590267419815, 0.0015501414891332388, 0.012481802143156528, -0.023687556385993958, 0.07908563315868378, -0.00665891682729125, -0.00852898694574833, -0.0038758122827857733, -0.009321016259491444, 0.03344125673174858, -0.016676627099514008, 0.01454254612326622, -0.028645075857639313, -0.010428391396999359, -0.0015675588510930538, 0.018026011064648628, 0.004876849707216024, -0.007744290865957737, 0.014997229911386967, -0.03018513321876526, 9.911830420605838e-05, 0.015253906138241291, -0.009167010895907879, 0.017160644754767418, 0.016104605048894882, 0.018876709043979645, -0.007810293231159449, -0.022719519212841988, -0.00973903201520443, 0.006893592420965433, 0.005753215868026018, 0.01065573375672102, 0.01182911079376936, 0.060780949890613556, 0.010406390763819218, -0.02390756458044052, -0.04479368031024933, 0.020079420879483223, -0.03282523155212402, 0.013449838384985924, -0.03188652917742729, 0.030449142679572105, -0.011858445592224598, -0.01952206715941429, 0.013750516809523106, -0.0035274657420814037, 0.00403348496183753, 0.006237233988940716, -0.019404727965593338, 0.007619619369506836, -0.011022414080798626, 0.0058962213806807995, -0.004572505131363869, 0.008389648050069809, 0.0059255557134747505, -0.014227201230823994, 0.03229721263051033, 0.00028257310623303056, -0.025960974395275116, -0.011447763070464134, -0.026899676769971848, 0.06694117933511734, 0.019595403224229813, 0.015327242203056812, -0.04840181767940521, 0.004477167967706919, -0.033969275653362274, 0.018950045108795166, -0.027545034885406494, -0.027339693158864975, -0.009035006165504456, -0.010259718634188175, -0.004176490008831024, 0.03916146978735924, -0.011565101332962513, 0.025828970596194267, 0.006361905485391617, 0.022616850212216377, 0.004590839147567749, 0.01993274874985218, 0.007494948338717222, 0.0030361139215528965, 0.04458834230899811, 0.04238825663924217, -0.014769887551665306, 0.013200495392084122, -0.006262901704758406, 0.0037658081855624914, 0.025066275149583817, -0.0119171142578125, 0.037049390375614166, -0.020094087347388268, -0.005709214601665735, -0.0011247922666370869, -0.0014548046747222543, -0.0010257884860038757, 0.045409705489873886, 0.018319355323910713, -0.008969003334641457, 0.0006265651900321245, -0.0007264856249094009, 0.02041676640510559, 0.022499511018395424, 0.0046531748957931995, -0.004095820244401693, -0.007524282671511173, -0.023834228515625, 0.01782066933810711, -0.019742075353860855, -0.00725293904542923, -0.03963082283735275, -0.009651029482483864, -0.0012897984124720097, 0.012291127815842628, 0.014080529101192951, -0.002366922330111265, 0.04887116700410843, 0.004513836000114679, 0.0015409744810312986, 0.004411165602505207, -0.003023280296474695, 0.01336916908621788, -0.026444993913173676, -0.05060189962387085, 0.029642445966601372, 0.0172046460211277, 0.04109754413366318, 0.02317420393228531, -0.028938420116901398, -0.010252385400235653, 0.0036888052709400654, -0.023980900645256042, 0.012298461981117725, -0.0033037906978279352, -0.014293203130364418, -0.013581843115389347, -0.0003061781753785908, -0.014102529734373093, 0.012716477736830711, 0.039220139384269714, 0.004308495204895735, -0.014021859504282475, -0.0328839011490345, 0.0015400578267872334, 0.020739445462822914, 0.039014797657728195, 0.017776668071746826, 0.024274244904518127, -0.005877887364476919, -0.013391169719398022, -0.0030581147875636816, -0.013200495392084122, 0.021942157298326492, -0.019360726699233055, -0.012782479636371136, 0.004480835050344467, 0.014051194302737713, 0.019184719771146774, -0.004730177577584982, -0.012621141038835049, -0.009013005532324314, -0.03349992632865906, -0.0028326064348220825, 0.00849965214729309, 0.0006604831432923675, -0.002194582484662533, -0.01613393984735012, 0.016764629632234573, 0.024655591696500778, -0.019214054569602013, -0.010142381303012371, 0.016192607581615448, 0.004128821659833193, -0.019228722900152206, -0.011946449056267738, 0.013794518075883389, 0.007736957166343927, -0.011836444027721882, 0.0009607027168385684, -0.03564133867621422, -0.033734600991010666, 0.008235642686486244, 0.010171715170145035, 0.023995567113161087, -0.009431020356714725, -0.010861074551939964, 0.0262543186545372, -0.007509615272283554, -0.010179049335420132, -4.6608522097812966e-05, 0.014381206594407558, 0.0047375112771987915, -0.0032451217994093895, -0.015121901407837868, 0.0032121206168085337, -0.006306903436779976, -0.009313683025538921, 0.013552509248256683, -0.012987821362912655, 0.019082050770521164, 0.013083158060908318, 0.012723810970783234, 0.043268293142318726, 0.013603843748569489, -0.00473384466022253, -0.022499511018395424, -0.007117267232388258, -0.00398214953020215, 0.006809255573898554, 0.027794377878308296, 0.010186382569372654, 0.004106821026653051, -0.009724365547299385, 0.0078396275639534, -0.004286494106054306, 0.0007315274560824037, 0.002027742797508836, 0.018231350928544998, 0.03270789608359337, -0.039425481110811234, -0.008162306621670723, 0.0002688225940801203, -0.030801156535744667, -0.000539478613063693, 0.011631103232502937, 0.00296644470654428, -0.009607027284801006, -0.0022734187077730894, -0.005316866096109152, 0.00593288941308856, 0.015107234008610249, -0.02289552614092827, -0.00661491509526968, 0.020094087347388268, 0.013809185475111008, 0.00984170287847519, -0.0004051818687003106, 0.0012971319956704974, 0.009717031382024288, -0.009680363349616528, 0.013119826093316078, -0.021076790988445282, 0.01827535219490528, -0.00537186861038208, -0.018040677532553673, 0.03974815830588341, 0.017087308689951897, 0.03769474849104881, -0.05368201434612274, 0.07914430648088455, 0.0307131540030241, 0.029275765642523766, -0.03417461737990379, 0.019800743088126183, 0.0023889229632914066, 0.030977163463830948, 0.0051261927001178265, -0.038985464721918106, 0.013017155230045319, -0.04998587816953659, -0.01585526205599308, 0.0025337617844343185, 0.0017050639726221561, 0.012943819165229797, -0.005177527666091919, -0.01896471157670021, 0.015693923458456993, 0.0058632199652493, -0.04071619734168053, 0.024538254365324974, -0.031651854515075684, 0.021428804844617844, -0.0022954195737838745, 0.012408466078341007, -0.01754199154675007, 0.022250168025493622, -0.014241867698729038, -0.00981236808001995, -0.0002129038330167532, 0.013515841215848923, 0.003069115336984396, -0.005045522935688496, 0.02645966038107872, -0.01924338936805725, 0.02411290630698204, 0.0019379061413928866, -0.010721735656261444, -0.000635273871012032, -0.00782496016472578, -0.011389094404876232, -0.032561223953962326, -0.01445454265922308, 0.007102599833160639, 0.020460767671465874, 0.01138176117092371, 0.02065144293010235, 0.023878229781985283, -0.02594630792737007, -0.0023797559551894665, 0.016119271516799927, -0.006820255890488625, -0.026679668575525284, -0.021780818700790405, 0.031827863305807114, -0.006369239185005426, -0.04837248474359512, -0.0062849028035998344, 0.025682298466563225, 0.019419396296143532, 0.05136459693312645, -0.008286978118121624, 0.048548489809036255, -0.014887225814163685, 0.021810151636600494, -0.003857478266581893, 0.024846266955137253, 0.0033001238480210304, 0.008286978118121624, 0.017453989014029503, 0.02610764652490616, 0.014953228645026684, 0.006559913046658039, -0.01820201613008976, 0.034731969237327576, 0.009145010262727737, -0.0013933856971561909, 0.020636774599552155, 0.005489205941557884, -0.001866403385065496, -0.0013411337276920676, -0.02552095800638199, 0.02949577383697033, 0.031446512788534164, 0.00856565497815609, 0.03681471571326256, -0.017776668071746826, 0.012584473006427288, 0.008330979384481907, -0.006530578713864088, 0.0263863243162632, 0.010208383202552795, 0.020387431606650352, 0.03643336892127991, -0.03176919370889664, -0.041156213730573654, 0.0012421299470588565, 0.0025685965083539486, -0.019947415217757225, -0.008360314182937145, 0.011601769365370274, -0.017292648553848267, 0.0019030714174732566, -0.01133042573928833, -0.002198249101638794, 0.044089656323194504, 0.026620998978614807, 0.021267464384436607, -0.011645770631730556, 0.01377985067665577, 0.012379131279885769, 0.0044148326851427555, -0.008191640488803387, -0.02335021086037159, 0.0028784414753317833, -0.044852349907159805, -0.007223604712635279, 0.02406890317797661, 0.019918080419301987, 0.002016742480918765, 0.01996208354830742, -0.004869516007602215, -0.012914485298097134, -0.0092403469607234, -0.016529954969882965, -0.026268986985087395, 0.036316029727458954, 0.025256948545575142, 0.014373873360455036, -0.01682329922914505, -0.010215717367827892, -0.02352621592581272, -0.014843223616480827, -0.01679396443068981, -0.03913213685154915, 0.01812868006527424, -0.013794518075883389, 0.02186882123351097, -0.024024901911616325, 0.02750103361904621, -0.004359830170869827, -0.0018939044093713164, -0.008594989776611328, -0.006471909582614899]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"ating trans-
former inference for translation via parallel decoding. In
Proceedings of the 61st Annual Meeting of the Associ-
ation for Computational Linguistics (Volume 1: Long
Papers) , pp. 12336–12355, Toronto, Canada, July 2023.
Association for Computational Linguistics. URL https:
//aclanthology.org/2023.acl-long.689 .
Saxena, A. Prompt lookup decoding, November 2023. URL
https://github.com/apoorvumang/promp
t-lookup-decoding/ .
See, A., Liu, P. J., and Manning, C. D. Get to the point:
Summarization with pointer-generator networks. In Pro-
ceedings of the 55th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers) ,
pp. 1073–1083, 2017.Shoeybi, M., Patwary, M., Puri, R., LeGresley, P., Casper,
J., and Catanzaro, B. Megatron-lm: Training multi-
billion parameter language models using model paral-
lelism. arXiv preprint arXiv:1909.08053 , 2019.
Song, Y ., Meng, C., Liao, R., and Ermon, S. Accelerating
feedforward computation via parallel nonlinear equation
solving, 2021.
Stern, M., Shazeer, N., and Uszkoreit, J. Blockwise parallel
decoding for deep autoregressive models, 2018.
Team, G., Anil, R., Borgeaud, S., Wu, Y ., Alayrac, J.-B., Yu,
J., Soricut, R., Schalkwyk, J., Dai, A. M., Hauth, A., et al.
Gemini: a family of highly capable multimodal models.
arXiv preprint arXiv:2312.11805 , 2023.
Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux,
M.-A., Lacroix, T., Rozi `ere, B., Goyal, N., Hambro, E.,
Azhar, F., et al. Llama: Open and efficient foundation lan-
guage models. arXiv preprint arXiv:2302.13971 , 2023a.
Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi,
A., Babaei, Y ., Bashlykov, N., Batra, S., Bhargava, P.,
Bhosale, S., et al. Llama 2: Open foundation and fine-
tuned chat models. arXiv preprint arXiv:2307.09288 ,
2023b.
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones,
L., Gomez, A. N., Kaiser, L., and Polosukhin, I. Attention
is all you need, 2023.
Wolf, T., Debut, L., Sanh, V ., Chaumond, J., Delangue, C.,
Moi, A., Cistac, P., Rault, T., Louf, R., Funtowicz, M.,
Davison, J., Shleifer, S., von Platen, P., Ma, C., Jernite,
Y ., Plu, J., Xu, C., Scao, T. L., Gugger, S., Drame, M.,
Lhoest, Q., and Rush, A. M. Transformers: State-of-
the-art natural language processing. In Proceedings of
the 2020 Conference on Empirical Methods in Natural
Language Processing: System Demonstrations , pp. 38–
45, Online, October 2020. Association for Computational
Linguistics. URL https://www.aclweb.org/a
nthology/2020.emnlp-demos.6 .
Yang, N., Ge, T., Wang, L., Jiao, B., Jiang, D., Yang, L.,
Majumder, R., and Wei, F. Inference with reference:
Lossless acceleration of large language models, 2023.
Zhang, B. and Sennrich, R. Root mean square layer normal-
ization, 2019.
Zheng, L., Chiang, W.-L., Sheng, Y ., Zhuang, S., Wu, Z.,
Zhuang, Y ., Lin, Z., Li, Z","[-0.007801623083651066, 0.02265316992998123, 0.019398236647248268, -0.0049809240736067295, -0.009064187295734882, 0.010341347195208073, -0.009954550303518772, 0.026608716696500778, -0.05251682177186012, 0.010552991181612015, 0.03173195198178291, -0.00903499498963356, -0.036081597208976746, 0.0182743351906538, -0.0177780669182539, -0.032023876905441284, 0.028170501813292503, -0.00846574641764164, 0.010472712107002735, 0.0711122676730156, 0.007371037732809782, -0.027323925867676735, -0.00799867045134306, 0.0245506651699543, 0.013355445116758347, 0.0010545692639425397, 0.007115605752915144, 0.06077822297811508, 0.03424248471856117, -0.06077822297811508, 0.01227533258497715, -0.03313317894935608, 0.006761650089174509, -0.024258742108941078, -0.025981083512306213, 0.026433562859892845, 0.014114443212747574, -0.014253105968236923, -0.028082923963665962, 0.0015453636879101396, 0.00428395951166749, -0.07817678898572922, -0.031060531735420227, 0.03532259911298752, 0.00017720594769343734, 0.033571064472198486, 0.007071817759424448, -0.025776738300919533, -9.892288653645664e-05, 0.05701242387294769, -0.012538062408566475, 0.013983078300952911, -0.03508906066417694, 0.004586828872561455, -0.0480504110455513, 0.0030597106087952852, 0.013318954966962337, 0.01685851253569126, 0.032344989478588104, -0.047174643725156784, -0.014048760756850243, -0.04513118788599968, -0.008713880553841591, 0.041949234902858734, -0.05076528713107109, -0.012392101809382439, -0.048751022666692734, 0.030681032687425613, -0.008670092560350895, 0.007031678222119808, 0.009370706044137478, 0.01429689396172762, 0.04209519550204277, -0.024886375293135643, -0.02001127414405346, 0.02208392135798931, -0.03126487880945206, 0.09855296462774277, -0.00341366627253592, -0.009808588773012161, 0.006039142608642578, 0.012136668898165226, 0.0164498221129179, -0.04740818217396736, -0.024171166121959686, -0.016303859651088715, 0.003004975151270628, 0.006104825064539909, -0.03313317894935608, -0.0056742397136986256, -0.009232042357325554, 0.002193066291511059, -0.019660966470837593, 0.006885717157274485, 0.05210812762379646, 0.04399269074201584, 0.003645379561930895, 0.0008128211484290659, 0.051232364028692245, 0.03681140020489693, -0.02033238857984543, -0.005754518322646618, 0.034621983766555786, -0.038592126220464706, 0.041744887828826904, -0.02601027674973011, -0.027396908029913902, -0.029192229732871056, -0.023324592038989067, 0.002446673810482025, -0.10252311080694199, -0.012421293184161186, -0.02605406381189823, -0.022550996392965317, 0.0063748531974852085, -0.06194591149687767, -0.042854193598032, -0.016026534140110016, -0.034943100064992905, 0.017763471230864525, -0.015705419704318047, 0.0013163870899006724, 0.025470219552516937, 0.004054070916026831, 0.000603458087425679, -0.027280138805508614, 0.0375995896756649, -0.05006467178463936, 0.01337004080414772, -0.019106313586235046, 0.009472878649830818, -0.0014021393144503236, 0.020726483315229416, -0.042883384972810745, -0.044751688838005066, -0.03418410196900368, -0.006024546455591917, 0.00691855838522315, -0.042795807123184204, 0.01525293942540884, 0.027163369581103325, 0.007845412008464336, -0.041248619556427, 0.01259644702076912, -0.05371370166540146, 0.02806832827627659, -0.02503233589231968, 0.0029922034591436386, -0.032549336552619934, 0.010093213059008121, -0.021646037697792053, -0.025411834940314293, -0.024360915645956993, 0.014508537948131561, -0.05870557203888893, -0.03488471359014511, -0.03505986928939819, 0.051232364028692245, 0.044051073491573334, -0.06737566739320755, -0.014815056696534157, 0.029600920155644417, 0.0061559113673865795, 0.011873939074575901, 0.013713049702346325, 0.021324923262000084, -0.03094376251101494, 0.006418641656637192, -0.0636974424123764, -0.07286380231380463, -0.018814392387866974, -0.025820527225732803, -0.03564371168613434, -0.01633305288851261, -0.008859841153025627, -0.034213293343782425, -0.04043123871088028, -0.05756707489490509, -0.030155573040246964, -0.037453629076480865, 0.0010408854577690363, 0.03748282417654991, -0.002804278628900647, 0.03940951079130173, -0.034534405916929245, -0.021003808826208115, 0.006889366079121828, 0.06031114608049393, 0.018084585666656494, 0.038621317595243454, -0.017267202958464622, 0.040051739662885666, 0.07852710038423538, 0.016260072588920593, 0.0035121901892125607, -0.019982080906629562, 0.07712586969137192, -0.02617083303630352, 0.019996676594018936, -0.025295067578554153, 0.04408026486635208, 0.018901968374848366, -0.02787857875227928, -0.027688829228281975, 0.009056889452040195, -0.0017770769773051143, 0.015106978826224804, -0.0050320103764534, -0.02094542421400547, -0.020069656893610954, 0.02973228506743908, -0.003346159355714917, 0.034125715494155884, 0.020113445818424225, -0.021967152133584023, -0.02085784822702408, -0.06422290205955505, 0.016230879351496696, 0.004488305188715458, 0.023076457902789116, -0.005812902469187975, 0.018697623163461685, 0.025543199852108955, 0.031060531735420227, -0.03529340401291847, 0.030476687476038933, 0.020025869831442833, -0.028666770085692406, 0.046006955206394196, -0.015647035092115402, 0.07870224863290787, -0.020595118403434753, -0.003614362794905901, -0.02046375349164009, 0.011114940978586674, -0.04273742437362671, 0.016697954386472702, -0.0433504618704319, 0.009772098623216152, -0.034738752990961075, -0.007823517546057701, -0.004021229688078165, 0.03146922215819359, 0.02265316992998123, 0.004287608899176121, 0.04726221784949303, -0.028301866725087166, -0.06649989634752274, 0.046444837003946304, 0.028944095596671104, 0.0021967152133584023, -0.00549908634275198, -0.019952889531850815, 0.012873773463070393, -0.0475541427731514, -0.032958026975393295, -0.022259075194597244, -0.005148779600858688, -0.038504552096128464, 0.025864314287900925, -0.04694110527634621, 0.022273670881986618, 0.0004342344182077795, 0.03573128953576088, 0.005334879737347364, 0.00399933522567153, -0.009166359901428223, 0.028491616249084473, -0.0008990294300019741, -0.03082699328660965, 0.0047254920937120914, -0.006228892132639885, 0.0128007922321558, 0.02252180501818657, -0.0700029656291008, -0.019675562158226967, 0.014720181934535503, 0.02892949990928173, -0.02151467278599739, 0.02151467278599739, 0.004013931378722191, 0.023397572338581085, 0.04667837545275688, 0.031381648033857346, -0.013574386946856976, 0.011363075114786625, -0.019310658797621727, 0.010282962583005428, -0.040402043610811234, -0.003959196154028177, 0.03876728191971779, -0.008195718750357628, 0.022434229031205177, -0.02779100276529789, 0.037249285727739334, 0.03152760863304138, 0.04451815038919449, 0.02078486792743206, 0.012611042708158493, -0.03792070597410202, 0.0627049058675766, -0.017281800508499146, 0.008728476241230965, 0.004028527531772852, -0.01563243940472603, 0.04656160622835159, -0.07175450026988983, -0.0030779556836932898, 0.027440695092082024, -0.017763471230864525, -0.005247303284704685, 0.023426763713359833, -0.014216615818440914, 0.00545894680544734, -0.029440363869071007, -0.027849387377500534, 0.04772929474711418, -0.06252975761890411, 0.04086912050843239, -0.05853042006492615, -0.009991040453314781, -0.018099181354045868, -0.006057387683540583, 0.022215286269783974, 0.0022405036725103855, 0.05190378427505493, -0.018332719802856445, -0.022580189630389214, 0.004345993045717478, -0.009750204160809517, -0.0024393757339566946, 0.024054396897554398, 0.026681696996092796, 0.015603246167302132, -0.024944759905338287, -0.026112448424100876, -0.057917382568120956, 0.04291257634758949, 0.02735311910510063, 0.0037584996316581964, -0.09995419532060623, 0.01486614253371954, -0.030972955748438835, 0.016420628875494003, -0.03173195198178291, 0.035672903060913086, -0.0014267702354118228, 0.0219233650714159, 0.05607827380299568, 0.022959688678383827, -0.004097859375178814, -0.018624642863869667, 0.040489621460437775, -0.006601092871278524, 0.043613191694021225, 0.04139458015561104, -0.014902632683515549, -0.016216283664107323, -0.009305022656917572, 0.01734018512070179, -0.026141641661524773, 0.015369708649814129, 0.00846574641764164, 0.008662793785333633, -0.01170608401298523, 0.00757538340985775, -0.03844616562128067, 0.01697528176009655, -0.001001658383756876, -0.021295731887221336, -0.006550006568431854, 0.0580049604177475, -0.03257852792739868, 0.022127710282802582, -0.01007131952792406, 0.002039806917309761, -0.02276993915438652, 0.018405700102448463, 0.008538726717233658, 0.04513118788599968, 0.0201280415058136, 0.001016254536807537, -0.021806595847010612, -0.02131032757461071, -0.018741412088274956, 0.02495935559272766, 0.003276827745139599, -0.015486477874219418, -0.00889633223414421, -0.002692983252927661, -0.017238011583685875, -0.005572066642343998, -0.037570398300886154, 0.030447496101260185, 0.012158563360571861, 0.007356441579759121, -0.015121574513614178, 0.03961385414004326, 0.031907107681035995, 0.022142305970191956, 0.021295731887221336, -0.007341845892369747, -0.008254102431237698, -0.02110598236322403, 0.026900639757514, 0.046649184077978134, 0.011516334488987923, 0.04472249373793602, 0.03278287500143051, 0.018405700102448463, 0.05073609575629234, -0.044255420565605164, 0.030885377898812294, -0.024988548830151558, 0.00796218030154705, -0.030885377898812294, 0.017165031284093857, 0.017325587570667267, 0.03403813764452934, 0.037657976150512695, 0.01923767849802971, -0.0014687340008094907, -0.06439805775880814, -0.030535072088241577, -0.04186165705323219, 0.0027002813294529915, 0.03322075679898262, -0.04410945996642113, 0.04691191390156746, -0.05190378427505493, -0.032753679901361465, -0.019193891435861588, 0.06626635789871216, -0.013983078300952911, -0.019456621259450912, -0.023791667073965073, 0.03541017323732376, 0.05245843529701233, 0.012406697496771812, -0.05543604493141174, -0.024360915645956993, 0.015574054792523384, -0.03319156542420387, -0.016639571636915207, -0.02876894176006317, -0.004123402293771505, -0.0324033759534359, -0.006553655490279198, 0.012333717197179794, -0.02827267348766327, 0.04311692342162132, -0.014150933362543583, 0.03281206637620926, 0.008859841153025627, -0.01294675376266241, -0.032549336552619934, 0.08407361805438995, -0.011859343387186527, 0.06293844431638718, -0.0206243097782135, 0.010472712107002735, 0.01685851253569126, -0.04171569645404816, -0.033395908772945404, -0.010662461631000042, 0.028754346072673798, 0.02806832827627659, 0.02624381333589554, 0.04046043008565903, 0.016639571636915207, 0.008049757219851017, -0.005517331417649984, -0.025981083512306213, -0.030681032687425613, 0.004455463960766792, 0.02336837910115719, 0.030213957652449608, -0.027659637853503227, -0.008925524540245533, -0.02414197288453579, -0.006024546455591917, -0.03657786175608635, 0.04974355921149254, -0.005079447757452726, 0.009232042357325554, 0.05707080662250519, 0.022550996392965317, 0.0031874265987426043, 0.011319287121295929, 0.015209151431918144, 0.01823054812848568, -0.012143967673182487, 0.046240489929914474, -0.018376508727669716, -0.0013501406647264957, -0.010684356093406677, -0.04159892722964287, -0.009545858949422836, 0.010742740705609322, -0.030272342264652252, -0.013450319878757, -0.009399897418916225, 0.00549908634275198, 0.031381648033857346, -0.0018537065479904413, -0.005261899437755346, 0.04095669835805893, 0.03278287500143051, -0.024900970980525017, 0.04060639068484306, 0.004995520226657391, 0.011516334488987923, -1.8772541807265952e-05, 0.007079115603119135, 6.435689101635944e-06, 0.05806334316730499, -0.03701574727892876, 0.010844913311302662, 0.0040467726066708565, 0.026389775797724724, 0.013158397749066353, -0.026915235444903374, 0.01223154366016388, -0.016303859651088715, 0.024696625769138336, -0.015690824016928673, 0.004411675501614809, -0.07047004252672195, -0.02357272431254387, -0.002689334098249674, 0.022098517045378685, -0.018420295789837837, 0.002718526404350996, -0.009567753411829472, -0.04764171689748764, -0.012392101809382439, -0.0009825009619817138, -0.012406697496771812, -0.059085071086883545, -0.005207163747400045, -0.004123402293771505, 0.04337965324521065, 0.0043022045865654945, -0.0016329403733834624, -0.008057055063545704, -0.019777735695242882, 0.014420961029827595, -0.04209519550204277, -0.018084585666656494, 0.022025536745786667, 0.028812730684876442, -0.047787681221961975, 0.015603246167302132, -0.025222085416316986, -0.015690824016928673, -0.008619005791842937, 0.028389442712068558, -0.008356275968253613, -0.010757336392998695, -0.028447827324271202, 0.013866309076547623, -0.010137001983821392, 0.006513515952974558, 0.002085419837385416, -0.030301533639431, -0.00409056106582284, -0.0011540052946656942, -0.04659079760313034, 0.011881236918270588, -0.01024647243320942, -0.008451150730252266, -0.02706119604408741, 0.020069656893610954, -0.019952889531850815, -0.007126552984118462, -0.017267202958464622, 0.00036125382757745683, 0.007830815389752388, -0.00597710907459259, 0.012392101809382439, -0.03564371168613434, -0.010750038549304008, -0.01170608401298523, -0.014939123764634132, -0.01868302747607231, 0.018653834238648415, -0.0026948077138513327, 0.008794158697128296, -0.04848829284310341, 0.0062690312042832375, 0.05858880281448364, -0.007641065865755081, -0.017281800508499146, -0.025265874341130257, -0.026681696996092796, 0.0002978519769385457, 0.02710498496890068, -0.04530633985996246, -0.043817535042762756, 0.014895334839820862, 0.016143303364515305, -0.006042791530489922, -0.026681696996092796, -0.007787027396261692, 0.002984905382618308, -0.008297891356050968, -0.027250945568084717, 0.004075964912772179, 0.01850787363946438, -0.0130635229870677, -0.009618839249014854, -0.002718526404350996, -0.007013433147221804, -0.024214955046772957, -0.007192235440015793, 0.011195220053195953, -0.014486643485724926, -0.02770342491567135, 0.04501441866159439, -0.007633768022060394, 0.001114778220653534, -0.026929831132292747, 0.01519455574452877, 0.005951565690338612, 0.011494440026581287, 0.013143801130354404, -0.01572001539170742, -0.016508204862475395, -0.006170507520437241, -0.009531263262033463, -0.036519479006528854, -0.027922367677092552, 0.025659969076514244, 0.01868302747607231, 0.02309105359017849, 0.017924029380083084, 0.0038606722373515368, -0.0018619168549776077, 0.029834458604454994, -0.05558200553059578, -0.007947584614157677, 0.009429089725017548, -0.001665781601332128, -0.012552659027278423, 0.02183578722178936, -0.013537896797060966, -0.005655994638800621, 0.0030067996121942997, -0.017573721706867218, -0.006130367983132601, -0.006112122908234596, -0.04548149183392525, 0.04448895901441574, 0.007119255140423775, 0.021543866023421288, -0.028856519609689713, 0.007706748321652412, -0.003424613503739238, 0.003787691704928875, -0.031498417258262634, -0.05940618738532066, -0.007655662018805742, -0.013377338647842407, 0.0026856851764023304, -0.009932655841112137, 0.02288670837879181, 0.040051739662885666, 0.03940951079130173, 0.029834458604454994, -0.001323685166426003, -0.016946088522672653, 0.011713381856679916, 0.042474694550037384, 0.0011768117547035217, 0.0006568251410499215, -0.04294176772236824, 0.020230215042829514, -0.02519289404153824, 0.010523798875510693, 0.010304857045412064, -0.0486050620675087, 0.02920682542026043, -0.06860174238681793, -0.024127377197146416, 0.007779729086905718, 0.013457617722451687, 0.024477684870362282, 0.003981090150773525, 0.034621983766555786, 0.0008835210464894772, 0.00030674648587591946, -0.005364072043448687, 0.019836120307445526, -0.02398141659796238, 0.012224245816469193, -0.004451815038919449, -0.009852377697825432, 0.04761252552270889, -0.008356275968253613, -0.06328875571489334, -0.013384637422859669, -0.004798472858965397, -0.037774745374917984, -0.010487308725714684, -0.03103134036064148, -0.02916303649544716, -0.015355112962424755, 0.017559126019477844, 0.04845910146832466, -0.03342510387301445, -0.026710890233516693, 0.0008748546242713928, -0.007312653586268425, 0.005714378785341978, -0.039351124316453934, 0.02406899258494377, 0.005907777231186628, 0.0027878580149263144, 0.004856857005506754, -0.05251682177186012, -0.04358399659395218, 0.013705751858651638, -0.019223082810640335, -0.0013245973968878388, 0.010947085916996002, -0.02082865498960018, -0.029265210032463074, 0.01620168797671795, -0.014676393009722233, 0.013457617722451687, -0.0014541379641741514, 0.021543866023421288, 0.004108806140720844, -0.03602321073412895, -0.012771599926054478, 0.020930828526616096, -0.02430253103375435, 0.0007763308240100741, -0.02694442681968212, -0.00775783509016037, -0.002545197494328022, -0.03929274156689644, -0.00011790923599619418, 0.04399269074201584, 0.016391437500715256, 0.009699118323624134, 0.0018254265887662768, 0.011166027747094631, 0.00312904198653996, -0.016216283664107323, -0.02284291945397854, 0.01434068288654089, -0.009567753411829472, -0.01847868040204048, 0.002428428502753377, -0.020755674690008163, 0.010093213059008121, -0.0047035980969667435, -0.0047181942500174046, 0.01217315997928381, -0.004291257821023464, 0.0016703428700566292, -0.009246638976037502, 0.04136538878083229, 0.008516833186149597, -0.017486145719885826, -0.0025233032647520304, -0.025455623865127563, -0.009575051255524158, 0.03237418085336685, 0.008633601479232311, -0.0042657144367694855, 0.020814059302210808, 0.028622981160879135, 0.043613191694021225, 0.0012534413253888488, 0.012224245816469193, 0.03470956161618233, -0.018580853939056396, 0.011654997244477272, -0.04647402837872505, 0.00743307126685977, -0.010574884712696075, -0.01717962697148323, -0.011560122482478619, -0.013924693688750267, -0.05984406918287277, -0.009224744513630867, 0.009443686343729496, -0.04022689163684845, -0.0491013303399086, -0.006622986868023872, 0.009443686343729496, 0.007772431243211031, 0.019821524620056152, 0.04621129855513573, -0.0001051376384566538, -0.121206134557724, -0.026594121009111404, 0.025163700804114342, -0.0013318954734131694, 0.011260902509093285, -0.03319156542420387, 0.02085784822702408, 0.033687833696603775, -0.003112621372565627, -0.02126653864979744, 0.015136171132326126, -0.017413165420293808, -0.004072315990924835, 0.0050940439105033875, 0.004809419624507427, -0.05204974487423897, 0.004229224286973476, -0.04694110527634621, 0.04889698326587677, -0.01007131952792406, -0.018887372687458992, -0.006805438548326492, 0.0279515590518713, 0.015121574513614178, -0.03476794436573982, 0.006809087470173836, 0.009093379601836205, 0.01774887554347515, -0.022054729983210564, 0.024214955046772957, -0.02535345032811165, -0.027046600356698036, -0.012202352285385132, 0.043408844619989395, -0.04051881283521652, 0.00597710907459259, -0.02268236130475998, -0.01397577952593565, 0.006644881330430508, -0.011859343387186527, -0.010443519800901413, -0.07052842527627945, 0.028097521513700485, -0.016683358699083328, 0.04857587069272995, 0.01039243396371603, 0.006692318711429834, -0.019091717898845673, 0.028126712888479233, -0.021076789125800133, 0.006597443949431181, -0.002054403070360422, 0.01251616794615984, 0.028506211936473846, 0.007568085566163063, -0.013428425416350365, 0.02450687624514103, -0.0151507668197155, 0.04930567368865013, 0.03981820121407509, 0.0015070488443598151, 0.004108806140720844, 0.0012461432488635182, -0.01444285549223423, -0.010691653937101364, -0.012932157143950462, -0.008035161532461643, 0.033892177045345306, -0.011596613563597202, -0.05505654588341713, -0.0253242589533329, 0.035351790487766266, 0.007604575715959072, 0.013764136470854282, 0.01081572100520134, -0.006590145640075207, 0.03342510387301445, 0.03205306828022003, -0.0491013303399086, -0.005714378785341978, 0.04603614658117294, -0.023397572338581085, -0.028754346072673798, -0.00757538340985775, -0.008677390404045582, 0.008217612281441689, 0.0043022045865654945, -0.006108473986387253, -0.023514341562986374, 0.026886044070124626, 0.054677046835422516, -0.020726483315229416, 0.003618011949583888, -0.013647367246448994, 0.01615789905190468, 0.00220766244456172, 0.013005138374865055, 0.021397903561592102, 0.01599734090268612, -0.01685851253569126, 0.036840591579675674, 0.028798134997487068, -0.06288006156682968, -0.038387782871723175, 0.018610045313835144, 0.008254102431237698, -0.0019558793865144253, 0.0012844580924138427, 0.012625639326870441, -0.02434631995856762, -0.009399897418916225, 0.003183777444064617, -0.026623312383890152, -0.007319951429963112, 0.01444285549223423, 0.01884358376264572, 0.03657786175608635, 0.045802608132362366, 0.008421958424150944, 0.00588588323444128, 0.007287110202014446, 0.0172234158962965, -0.027236349880695343, -0.013180291280150414, -0.05193297564983368, -0.006261733360588551, 0.00786000769585371, 0.022623978555202484, -0.029352786019444466, -0.024696625769138336, 0.0224780160933733, -0.01850787363946438, -0.01847868040204048, -0.0032257414422929287, 0.0028790836222469807, 0.019354447722434998, -0.015690824016928673, 0.052078936249017715, -0.049364060163497925, 0.02519289404153824, 0.011633103713393211, -0.003178304061293602, 0.01561784278601408, -0.01091789361089468, -0.006061036605387926, -0.009312321431934834, -0.009728310629725456, -0.02001127414405346, -0.032228220254182816, 0.007538893260061741, 0.0276742335408926, -0.009779396466910839, -0.03111891634762287, 0.017734279856085777, 0.005973460152745247, 0.003663624869659543, -0.01405605860054493, -0.031702760607004166, -0.006061036605387926, 0.023382974788546562, 0.013574386946856976, 0.03926355019211769, 0.009553156793117523, -0.012056390754878521, 0.011932323686778545, -0.03208225965499878, -0.015661630779504776, -0.021500077098608017, -0.05651615560054779, 0.010764634236693382, -0.030797801911830902, -0.016070323064923286, 0.04072315990924835, 0.03310398757457733, 0.01191042922437191, 0.004929837770760059, 0.005849393084645271, 0.001364736701361835, 0.012063688598573208, 0.01298324391245842, 0.023485148325562477, -0.002692983252927661, -0.004809419624507427, 0.013844414614140987, 0.012122073210775852, 0.012070986442267895, -0.0056961337104439735, 0.011041960678994656, 0.0003489383670967072, 0.050823669880628586, 0.008976610377430916, 0.03532259911298752, 0.004167190752923489, 0.05975649505853653, 0.008524131029844284, -0.019179293885827065, 0.01042892411351204, 0.026112448424100876, -0.014676393009722233, -0.03374621644616127, -0.021616846323013306, 0.02584971860051155, 0.00047163694398477674, -0.003090727375820279, -0.03897162526845932, 0.03208225965499878, -0.012589149177074432, -0.024944759905338287, 0.019018737599253654, 0.02304726466536522, -0.012049092911183834, -0.0006007213378325105, -0.04311692342162132, 0.05566957965493202, -0.004013931378722191, -0.0256015844643116, 0.01377143431454897, 0.015486477874219418, -0.02329539880156517, -0.005396913271397352, -0.0229742843657732, -0.02706119604408741, -0.02272615022957325, 0.015588650479912758, -0.008137334138154984, 0.027805598452687263, 0.012472379952669144, -0.012443187646567822, -0.02005506120622158, -0.005064851604402065, -0.007338196504861116, 0.01365466509014368, 0.0004456376191228628, 0.004145296756178141, 0.010655163787305355, -0.011749872006475925, 0.01563243940472603, -0.012757004238665104, -0.002618178026750684, -0.005013765301555395, 0.03730766847729683, 0.017997009679675102, -0.0012096529826521873, 0.0021529269870370626, -0.008677390404045582, -0.001609221682883799, 0.020755674690008163, 0.039643049240112305, 0.008976610377430916, 0.0066156890243291855, -0.0009879744611680508, -0.006042791530489922, 0.02803913690149784, 0.0025123562663793564, 0.009896165691316128, -0.006477025803178549, 0.007984074763953686, 0.0407523512840271, 0.025908103212714195, 0.041248619556427, -0.02617083303630352, 0.032023876905441284, 0.008414659649133682, -0.027192560955882072, 0.01806998997926712, -0.011560122482478619, -0.022988880053162575, -0.00014778565673623234, -0.00230983505025506, 0.005648696329444647, -0.033366717398166656, 0.02904626727104187, 0.009808588773012161, 0.013581684790551662, 0.01059677917510271, -0.024492280557751656, 0.009575051255524158, -0.011647699400782585, 0.007633768022060394, 0.00796218030154705, -0.013464915566146374, -0.027075793594121933, 0.004765631631016731, 0.0020617011468857527, 0.004805770702660084, -0.022332055494189262, -0.0276742335408926, -0.022945092990994453, 0.02892949990928173, -0.030009612441062927, 0.0022879410535097122, 0.019471216946840286, -0.01444285549223423, -0.0038497252389788628, -0.0182743351906538, 0.0023645705077797174, 7.229638140415773e-05, -0.0042438204400241375, 0.0029721339233219624, -0.028506211936473846, 0.020565925166010857, 0.030272342264652252, 0.02981986291706562, -0.03392137214541435, 0.016989877447485924, 0.009947252459824085, 0.005156077444553375, -0.04734979569911957, -0.02276993915438652, -0.0017186924815177917, -0.01688770391047001, 0.042474694550037384, -0.0025689161848276854, 0.0031545853707939386, 0.02495935559272766, -0.016011938452720642, -0.0018555311253294349, -0.0318487212061882, 0.016522802412509918, 0.00854602549225092, -0.01123900804668665, -0.0056596435606479645, 0.016376839950680733, 0.016026534140110016, -0.003875268390402198, -0.01912091113626957, 0.019223082810640335, -0.006670424249023199, 0.035672903060913086, 0.006217944901436567, 0.012552659027278423, 0.007283461280167103, 0.004170839674770832, 0.003249460132792592, -0.02053673379123211, 0.015778400003910065, 0.003962845075875521, 0.00287178554572165, 0.003275003284215927, -0.02965930476784706, 0.03508906066417694, 0.011552824638783932, -0.0013318954734131694, 0.019909100607037544, -0.014267701655626297, 0.0034063681960105896, -0.007115605752915144, 0.009677223861217499, 0.02301807329058647, -0.023222418501973152, 0.07846871018409729, -0.026448160409927368, 0.009027697145938873, 0.028258077800273895, -0.016230879351496696, 0.013501405715942383, -0.03249095007777214, -0.027484484016895294, -0.02624381333589554, 0.0006458780844695866, -0.0035815215669572353, 0.04918890818953514, -0.02041996456682682, -0.0345052145421505, 0.02158765308558941, -0.016143303364515305, -0.013720347546041012, 0.012720514088869095, -0.0035395578015595675, 0.04209519550204277, 0.026754677295684814, 0.043525613844394684, -0.012085583060979843, -0.021456288173794746, -0.012757004238665104, 0.004824015777558088, -0.0035121901892125607, -0.0007722256705164909, 0.022507209330797195, 0.06031114608049393, -0.0013820696622133255, -0.02819969318807125, -0.030213957652449608, 0.005170673597604036, -0.010888701304793358, 0.038913242518901825, -0.045072801411151886, 0.02819969318807125, -0.03602321073412895, -0.0068784188479185104, 0.017588317394256592, 0.0005231794784776866, -0.004524795338511467, -0.0022003643680363894, -0.008626303635537624, 0.004200031980872154, -0.027090389281511307, 0.004079613834619522, -0.013275166042149067, -0.008159227669239044, 0.0017716033617034554, 0.0029155740048736334, 0.016070323064923286, -0.017719682306051254, -0.0050320103764534, -0.0229742843657732, -0.00041576119838282466, 0.0658576712012291, 0.012917561456561089, 0.006809087470173836, -0.034008946269750595, 0.009888867847621441, -0.03298721835017204, -0.006101176142692566, -0.007268865127116442, -0.041628118604421616, -0.033600255846977234, -0.003535908879712224, -0.0076848543249070644, 0.028228886425495148, -0.019952889531850815, 0.007451316341757774, -0.006568251643329859, 0.003174654906615615, 0.02746988832950592, 0.021529268473386765, -0.015077786520123482, 0.01774887554347515, 0.024156570434570312, 0.04807960242033005, -0.004539391491562128, -0.0039883884601294994, -0.03141083940863609, 0.012611042708158493, -5.780004357802682e-06, -0.008998504839837551, 0.02763044461607933, -0.030301533639431, 0.008531428873538971, 0.022127710282802582, -0.01063326932489872, -0.004291257821023464, 0.03564371168613434, 0.021485481411218643, 0.02131032757461071, -0.013282464817166328, -0.01912091113626957, 0.006841928698122501, 0.02746988832950592, -0.0023846402764320374, 0.0008876261999830604, -0.007246971130371094, -0.021967152133584023, -0.0036052402574568987, -0.014858844690024853, 0.010377837345004082, -0.05526088923215866, -0.0070754666812717915, 0.003249460132792592, 0.014450153335928917, 0.014450153335928917, -0.02625841088593006, 0.053334202617406845, 0.011406864039599895, -0.0072031826712191105, 0.008217612281441689, -0.001661220332607627, 0.005736273247748613, 0.0009368881001137197, -0.05056094005703926, 0.031615182757377625, 0.006677722558379173, 0.023309994488954544, 0.009684521704912186, -0.00854602549225092, -0.006506218109279871, 0.016347648575901985, -0.018580853939056396, 0.00446641119197011, -0.01969015784561634, -0.02657952532172203, -0.02811211720108986, 0.013698454014956951, 0.0003724289999809116, 0.019091717898845673, 0.028185097500681877, 0.010647865943610668, -0.013705751858651638, -0.018172163516283035, 0.011071152985095978, 0.013275166042149067, 0.02528047002851963, 0.02320782281458378, 0.04656160622835159, 0.010202684439718723, -0.01831812411546707, 0.006845577619969845, -0.00921744666993618, 0.00895471591502428, -0.00950207095593214, -0.0006522638723254204, -0.011114940978586674, -0.01031215488910675, 0.004097859375178814, -0.011071152985095978, -0.0177780669182539, -0.013238675892353058, -0.025105318054556847, -0.00923934020102024, -0.006553655490279198, 0.0034428585786372423, -0.006630285177379847, -0.011319287121295929, 0.015457285568118095, 0.010720846243202686, -0.026345986872911453, -0.030447496101260185, 0.005739922169595957, 0.01912091113626957, -0.0011156905675306916, -0.014756672084331512, 0.01774887554347515, -0.007502403110265732, -0.003669098252430558, -0.01504859421402216, -0.024244146421551704, -0.029761478304862976, -0.0031454626005142927, 0.026871446520090103, 0.000452251493697986, 0.0007270689820870757, -0.018741412088274956, 0.03103134036064148, 0.008560621179640293, -0.015705419704318047, -0.0016475364100188017, -0.0056961337104439735, 0.00691855838522315, -0.0026236516423523426, -0.007648364175111055, 0.013384637422859669, -0.00029830809216946363, 0.0022715204395353794, 0.019982080906629562, 0.010012934915721416, 0.034008946269750595, 0.006695967633277178, 0.029717689380049706, 0.02981986291706562, 0.017106646671891212, 0.010910595767199993, -0.014202019199728966, 0.013610877096652985, -0.004754684399813414, -0.0074440184980630875, 0.021500077098608017, 0.00663393409922719, 0.009086081758141518, -0.014742075465619564, -0.009020399302244186, -0.008385468274354935, -0.045393917709589005, 0.02281372807919979, 0.01504859421402216, 0.014472047798335552, 0.0019795980770140886, -0.010888701304793358, 0.0064879730343818665, -0.036315131932497025, -0.026798466220498085, -0.000214608502574265, 0.025995681062340736, 0.00329142389819026, 0.0015654333401471376, -0.02771802246570587, 0.04816718026995659, -0.0018436717800796032, -0.005725326016545296, -0.0015152591513469815, 0.04031446948647499, -0.010217280127108097, -0.028871115297079086, 0.002780559938400984, -0.01936904340982437, 0.000751243787817657, -0.02014263905584812, 0.0007293496164493263, -0.02066809870302677, 0.006363905966281891, 0.008275996893644333, -0.03958466276526451, 0.026360582560300827, 0.005754518322646618, 0.033279143273830414, -0.04139458015561104, 0.059902455657720566, 0.023587321862578392, 0.021120578050613403, -0.05193297564983368, 0.027776407077908516, 0.0159243606030941, 0.02714877389371395, -0.0073308986611664295, -0.028214288875460625, -0.0014039637753739953, -0.034738752990961075, -0.0073527926579117775, -0.004470060113817453, 0.008918225765228271, 0.016011938452720642, 0.006462429650127888, -0.028973286971449852, 0.004163541831076145, -0.00931961927562952, -0.023528937250375748, 0.039964161813259125, -0.0007298057316802442, 0.013443022035062313, -0.004054070916026831, -0.009567753411829472, -0.0016484487568959594, 0.020317791029810905, -0.012720514088869095, -0.004404377657920122, 0.009151764214038849, 0.030739417299628258, 0.0190771222114563, 0.006002651993185282, 0.029236016795039177, -0.024171166121959686, 0.03211145102977753, 0.010231876745820045, -0.007560787256807089, -0.014129038900136948, -0.0010126054985448718, -0.010304857045412064, -0.024638241156935692, -0.014771267771720886, 0.005557470489293337, 0.01923767849802971, 0.006444184575229883, 0.015574054792523384, 0.012056390754878521, -0.026988215744495392, 0.004845910239964724, 0.007619171869009733, -0.01482965238392353, -0.0177780669182539, 0.012581850402057171, 0.06363905966281891, -0.010538394562900066, -0.022507209330797195, 0.023718686774373055, 0.023397572338581085, 0.00030993937980383635, 0.04641564562916756, 0.0030943762976676226, 0.034213293343782425, -0.004364238120615482, 0.006973293609917164, -0.007991372607648373, 0.004159892909228802, -0.014333385042846203, 0.022536400705575943, 0.0016885880613699555, 0.01429689396172762, 0.003984739538282156, 0.008991206996142864, -0.02276993915438652, 0.04848829284310341, 0.003444683039560914, 0.0031545853707939386, -0.005280144512653351, 0.009626138024032116, 0.013764136470854282, -0.012246140278875828, -0.0206243097782135, 0.04825475439429283, 0.03646109625697136, -0.012654831632971764, 0.03491390496492386, 0.00629822351038456, 0.020887039601802826, 0.00935610942542553, 0.0008119088597595692, -0.013581684790551662, 0.01863923855125904, 0.0007161218672990799, 0.04501441866159439, -0.036198362708091736, -0.041744887828826904, 2.1124455088283867e-05, -0.012180457822978497, -0.014990209601819515, 0.010253770276904106, -0.001651185448281467, -0.016785532236099243, 0.010158895514905453, -0.015267536044120789, 0.0024156570434570312, 0.04641564562916756, 0.007838113233447075, 0.008509534411132336, -0.015019401907920837, -0.00025383554748259485, 0.04317530617117882, 0.0033516327384859324, -0.0029009778518229723, -0.03330833464860916, -0.0034118418116122484, -0.022127710282802582, -0.022025536745786667, 0.012735109776258469, 0.009779396466910839, 0.012873773463070393, 0.0224780160933733, -0.013384637422859669, -0.024054396897554398, -0.02555779740214348, -0.0018208653200417757, -0.02158765308558941, 0.022755343466997147, 0.028287271037697792, 0.0055903117172420025, -0.03602321073412895, -0.01525293942540884, -0.012530764564871788, -0.02694442681968212, -0.01604112982749939, -0.03958466276526451, 0.02357272431254387, -0.007360090967267752, 0.023076457902789116, -0.012070986442267895, 0.017807260155677795, 0.025995681062340736, 0.004444516729563475, -0.005342178046703339, 0.00432409904897213]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"., Li, D., Xing, E. P., Zhang,
H., Gonzalez, J. E., and Stoica, I. Judging llm-as-a-judge
with mt-bench and chatbot arena, 2023.
10
Lookahead decoding
A. Algorithms
Algorithm 1 Jacobi decoding
1:Input: prompt x0, model pM, generation length m
2:Initialize y0= (y0
1, y0
2, ..., y0
m)
3:Initialize youtput←()
4:fori= 1tomdo
5:yi
1:m←argmax( PM(yi
1:m|yi−1
1:m,x0))
6:o←yi
7: stop←STOPCONDITION (yi,yi−1)
8: ifstop then
9: break
10: end if
11:end for
12:Output: o= (y1, y2, ..., y m)
Algorithm 2 Lookahead decoding
1:Input: prompt x0= (x1, x2, ...x n), model PM, n-gram size N, window size W, max #speculations G, max steps m.
2:Initialize n-gram pool C← ∅
3:Initialize o← ∅
4:Randomly initialize 2D window w2−N:0
1:W
5:Seto0←xn
6:fori= 1tomdo
7: ifsize(o)>=ithen
8: Randomly set wi
1:W
9: continue
10: end if
11:{Lookahead Branch }
12: forj= 1toWdo
13: ifj= 1then
14: wi
j←argmax PM(wi
j|wi+2−N:i−1
j ,o1:i,x0)
15: else
16: wi
j←argmax PM(wi
j|wi+2−N:i−1
j ,wi+1−N
2:j,o1:i,x0)
17: end if
18: end for
19: wi
1:W= (wi
1, wi
2, ..., wi
W)
20:{Verification Branch }
21: g← ∅
22: forj= 1toGdo
23: gi←n-gram from Cstarting with oi−1
24: end for
25:{Verification Algorithm in Algo. 3 and Algo. 4. }
26: o.append(V ERIFICATION ((x0,o1:i), PM,g))
27:{Update n-gram pool }
28: forj= 1toWdo
29: add n-gram wi−N+1:i
j toC
30: end for
31:end for
32:Output: o1:m= (y1, y2, ..., y m)
11
Lookahead decoding
Algorithm 3 Greedy Verification with L OOKAHEAD DECODING
1:input prefill x0, model PM, n-grams giwithi∈[1, G]
2:output o{accepted tokens of length 1 to N }
3:function GreedyVerification( x0,PM,g)
4:V,D,o← ∅,∅,∅
5: fori= 1toGdo
6: V.append( gi
2:){each is a n-1 gram }
7: D.append( PM(gi′
2:,xnext|gi
2:,x0))
8: {obtain last token of x0and all gi
2:’s outputs – totally N probability distributions }
9: end for
10: fori= 1toN−1do
11: j←1
12: isaccept ←0
13: P ←D[j]i{D[j] is a series of N probability distributions;all D[j]ishould be the same as different distributions
are removed; size( D)>0is guaranteed }
14: while j≤size(V)do
15: sj←V[j]i
16: ifsj= argmax Pthen
17: {accepted, update all potential speculations and probabilities }
18: o.append( sj)
19: isaccept ←1
20: Vnew,Dnew← ∅,∅
21: fork=jto size( V)do
22: ifsj=V[k]ithen
23: Vnew.append( V[k])
24: Dnew.append( D[k])
25: end if
26: end for
27: V,D←Vnew,Dnew
28: break
29: else
30: {rejected, go to next speculation }
31:","[0.002818665700033307, -0.003067266196012497, -0.006674657575786114, -0.009879637509584427, -0.04807470366358757, 0.011782594956457615, 0.022663788869976997, 0.011961444281041622, -0.021061299368739128, 0.011889904737472534, 0.0742296352982521, -0.039289623498916626, -0.0451272651553154, 0.03597018122673035, -0.03416737914085388, -0.006621002685278654, -0.0360560268163681, 0.005887720268219709, 0.02023143693804741, 0.046672523021698, 0.0005517502431757748, -0.023994427174329758, 0.04132135212421417, 0.0545705109834671, 0.013377930968999863, -0.0501350462436676, 0.015123500488698483, 0.04424017295241356, 0.053425874561071396, -0.056888397783041, 0.009951177053153515, -0.03370952606201172, -0.020646369084715843, -0.016940610483288765, -0.011911366134881973, 0.04092073068022728, 0.013542472384870052, -0.0018832836067304015, -0.034625232219696045, 0.002657701261341572, 0.007640443742275238, -0.035455092787742615, -0.03665696084499359, 0.0013565722620114684, 0.025267835706472397, 0.04309553653001785, 0.013342160731554031, -0.0001790729002095759, -0.015352427959442139, 0.04836086183786392, -0.032793816179037094, 0.011746824719011784, 0.009085546247661114, 0.04441186785697937, 0.005887720268219709, 0.0005995924002490938, -0.012934384867548943, 0.011968597769737244, 0.04701591655611992, 0.009078392758965492, -0.005995030049234629, -0.015595662407577038, 0.03516893461346626, 0.02217731811106205, -0.03039008006453514, -0.05139414593577385, -0.01901526190340519, -0.002001324202865362, 0.026641398668289185, 0.048647020012140274, -0.04097796231508255, 0.0378015972673893, 0.0217910036444664, -0.0399191752076149, -0.028086500242352486, 0.013292083516716957, 0.03848838061094284, 0.05468497425317764, 0.025253526866436005, -0.022821176797151566, 0.019387269392609596, 0.013771399855613708, 0.043839551508426666, -0.05210954323410988, 0.03016115352511406, -0.029188212007284164, -0.0007842544000595808, 0.015838898718357086, -0.04335308074951172, -0.06358452141284943, -0.05811888352036476, 0.027528490871191025, -0.020503288134932518, 0.029130980372428894, 0.03382398933172226, 0.0034142339136451483, 0.009486169554293156, -0.03631357103586197, 0.03247904032468796, 0.002768587786704302, 0.01186844240874052, -0.035397861152887344, 0.05751794949173927, 0.002001324202865362, 0.05354033783078194, -0.015652894973754883, -0.05551483482122421, 0.04114965721964836, -0.048875950276851654, -0.010387569665908813, -0.08630553632974625, -0.009636403061449528, -0.04152166470885277, 0.02861589565873146, 0.016325367614626884, -0.009085546247661114, -0.025639841333031654, -0.025968924164772034, 0.024409359320998192, -0.014536874368786812, -0.0406918041408062, 0.0114248963072896, 0.01845725253224373, -0.0397188626229763, -0.0028669550083577633, 0.0016945975366979837, 0.027714494615793228, -0.03748682141304016, 0.01807093806564808, 0.00832007173448801, 0.022806867957115173, 0.002947437111288309, 0.059921685606241226, -0.035083089023828506, -0.04524172842502594, 0.017942165955901146, -0.02007405087351799, 0.011904212646186352, -0.04572819918394089, 0.04481249302625656, 0.010358953848481178, -0.036456651985645294, -0.0511079877614975, 0.011839826591312885, -0.03800190985202789, 0.004764546640217304, -0.03222149610519409, 0.01807093806564808, -0.040062252432107925, -0.024080276489257812, -0.017169537022709846, -0.01995958760380745, -0.04650082811713219, 0.022205933928489685, 0.016382599249482155, -0.03963301330804825, -0.051766153424978256, 0.04143581539392471, 0.03926100954413414, 0.024538129568099976, -0.02933129295706749, 0.0020138435065746307, 0.02173377200961113, -0.020875295624136925, -0.017255384474992752, 0.05737486854195595, -0.03691450506448746, 0.027313871309161186, -0.05974998697638512, 0.018671872094273567, 0.03265073522925377, -0.00859192293137312, -0.01791355013847351, -0.0008812801679596305, -0.001450468203984201, -0.007279168348759413, -0.026526935398578644, -0.04309553653001785, -0.009815252386033535, -0.0987248346209526, -0.01675460673868656, 0.042952459305524826, 0.03176364302635193, -0.025825845077633858, -0.024423666298389435, -0.004439040552824736, 0.03419599309563637, -0.016997842118144035, -0.010702344588935375, 0.010573573410511017, 0.0028526470996439457, 0.03688588738441467, 0.05628746375441551, 0.04409709572792053, 0.009851021692156792, -0.06638887524604797, 0.07611828297376633, 0.02306441217660904, 0.05119383707642555, -0.013141850009560585, 0.008384456858038902, 0.0021354611963033676, -0.011167353019118309, -0.04286660999059677, 0.03576986864209175, -0.014708570204675198, 0.004889741074293852, 0.021862544119358063, 0.0036038141697645187, -0.033137205988168716, 0.04979165643453598, -0.0509076789021492, 0.025382298976182938, 0.009192856028676033, -0.03860284388065338, 0.03419599309563637, -0.0015533065889030695, 0.03333751857280731, -0.02123299427330494, 0.07228375226259232, -0.014823033474385738, 0.033022742718458176, 0.0341387614607811, 0.033623676747083664, -0.027099251747131348, 0.06644611060619354, 0.038345299661159515, -0.0010265952441841364, 0.03233596310019493, 0.0008168944041244686, 0.029731914401054382, -0.015495507046580315, -0.042008135467767715, -0.04037702828645706, 0.014765801839530468, -0.00887092761695385, -0.008956775069236755, -0.012176062911748886, -0.003246115520596504, 0.014043250121176243, 0.016325367614626884, 0.04175059124827385, 0.012054446153342724, -0.030475927516818047, -0.015667201951146126, 0.0010400089668110013, -0.03222149610519409, -0.061009086668491364, -0.01252660807222128, 0.03943270444869995, -0.008956775069236755, -0.04701591655611992, -0.030847935006022453, -0.008756463415920734, -0.04375370219349861, -0.008735002018511295, -0.0018117438303306699, 0.027700185775756836, -0.06072292849421501, -0.008613384328782558, -0.021547768265008926, -0.0038917616475373507, -0.05788995698094368, 0.04486972466111183, -0.014279332011938095, -0.0006881228764541447, 0.010652267374098301, -0.01067372877150774, -0.019186956807971, -0.025711381807923317, -0.05651639401912689, -0.03866007551550865, 0.00225886725820601, 0.03694311901926994, -0.001091875252313912, -0.03825945034623146, 0.030962398275732994, 0.015896130353212357, -0.010251644067466259, 0.03957578167319298, -0.023822732269763947, -0.012054446153342724, 0.057804107666015625, 0.035283397883176804, 0.044497717171907425, 0.02638385444879532, -0.0008222598698921502, -0.0354837104678154, -0.01718384586274624, -0.0026559126563370228, 0.007525980472564697, -0.030075306072831154, 0.028129424899816513, -0.0041063809767365456, 0.019558964297175407, -0.016954917460680008, 0.019172649830579758, -0.006624579895287752, 0.027972036972641945, 0.02167654037475586, 0.07085295766592026, -0.0070645492523908615, -6.337973900372162e-05, 0.011167353019118309, -0.052596013993024826, 0.048647020012140274, 0.004235152620822191, 0.0056194462813436985, -0.0022052123676985502, -0.030304232612252235, 0.017770471051335335, -0.005866258405148983, -0.01779908686876297, -0.024867212399840355, -0.02472413331270218, -0.04246598854660988, 0.06427130103111267, -0.024738440290093422, 0.03127717226743698, -0.05311110243201256, 0.00010809207014972344, -0.029474372044205666, 0.016926301643252373, 0.002918821293860674, -0.05617300048470497, -0.0007771003874950111, 0.009285857900977135, -0.007683367934077978, 0.03791606053709984, 0.0038810307160019875, 0.007232667412608862, 0.029359908774495125, 0.01941588521003723, -0.005669524427503347, -0.04057734087109566, -0.030590392649173737, -0.03831668198108673, 0.007983834482729435, 0.001636471482925117, 0.049104876816272736, -0.08727847784757614, -0.004667968023568392, 0.02134745754301548, -0.010051333345472813, -0.04509865120053291, -0.011968597769737244, -0.011525051668286324, 0.020145589485764503, 0.04120688885450363, 0.04630051925778389, 0.0016087498515844345, -0.021361766383051872, 0.03966163098812103, -0.012827075086534023, 0.004388962872326374, -0.014894573017954826, 0.007314938120543957, 0.01078819204121828, -0.002278540749102831, 0.02296425588428974, -0.036513883620500565, 0.009021161124110222, 0.0024287740234285593, 0.03348059579730034, 0.004814624320715666, -0.002725664060562849, -0.019888047128915787, -0.04552789032459259, -0.010773884132504463, 0.005079321563243866, -0.021891159936785698, 0.07503087818622589, -0.0443546362221241, 0.0002365282562095672, -0.04489833861589432, -0.026927556842565536, -0.022864099591970444, 0.014908880926668644, 0.023550881072878838, 0.03963301330804825, -0.021862544119358063, -0.004542773123830557, 0.00047797488514333963, -0.0006358094397000968, 0.017284000292420387, 0.014765801839530468, -0.011102966964244843, -0.02190546691417694, -0.0015559892635792494, -0.022434862330555916, -0.0295029878616333, -0.03439630568027496, -0.021633615717291832, 0.012827075086534023, -0.00044332281686365604, 4.845699368161149e-05, -0.015094884671270847, 0.03986194357275963, 0.0010391146643087268, 0.029646066948771477, 0.012469376437366009, -0.020703600719571114, -0.05740348622202873, -0.010695191100239754, -0.02329333871603012, 0.018171092495322227, -0.008978237397968769, 0.03714343160390854, 0.026569858193397522, 0.02562553435564041, 0.005708870943635702, 0.025582609698176384, 0.04541342705488205, -0.05660223960876465, 0.032250113785266876, 0.02566845715045929, 0.02068929187953472, 0.02628370001912117, 0.046157438308000565, 0.03153471648693085, 0.0087278475984931, 0.0008481930126436055, -0.041550278663635254, -0.024380741640925407, -0.059864453971385956, -0.01935865357518196, 0.0038738767616450787, -0.030676240101456642, 0.05645916238427162, -0.06930769979953766, -0.047874391078948975, 0.025682765990495682, 0.038116373121738434, -0.01552412286400795, -0.015051960945129395, -0.01912972517311573, 0.04120688885450363, 0.004925510846078396, -0.008570460602641106, -0.05637331306934357, -0.033137205988168716, -0.007962373085319996, -0.03665696084499359, 0.004542773123830557, -0.03785882890224457, 0.028429891914129257, -0.044612180441617966, -0.043009690940380096, 0.03250765800476074, -0.030704855918884277, 0.037229280918836594, -0.019229881465435028, 0.06415683776140213, -0.013292083516716957, -0.02412319928407669, -0.05116521939635277, 0.09878206998109818, 0.005630177445709705, 0.031191324815154076, -0.021390382200479507, 0.006538731977343559, -0.004439040552824736, -0.005340441595762968, -0.0010936637409031391, 0.01581028290092945, 0.011889904737472534, -0.033852603286504745, 0.03179226070642471, 0.02522491104900837, -0.002360811224207282, -0.004825355485081673, -0.04152166470885277, 0.0022982140071690083, -0.01674029789865017, 0.0040670339949429035, 0.03476831316947937, 0.010959887877106667, -0.05239570513367653, -0.004109957721084356, -0.033079974353313446, -0.005183054134249687, -0.012218987569212914, 0.023493649438023567, 0.013063156045973301, -0.005662370007485151, 0.07903710007667542, -0.010330338031053543, -0.0023232530802488327, -0.01366409007459879, -0.025739997625350952, 0.0004187310114502907, -0.013141850009560585, 0.004195805639028549, -0.017698930576443672, 0.011997213587164879, -0.027456950396299362, 0.0008727848180569708, 0.010852578096091747, -0.025253526866436005, 0.0060737235471606255, 0.013928786851465702, -0.007855063304305077, -0.012269064784049988, 0.05574376508593559, 0.008906696923077106, -0.017813393846154213, -0.009915407747030258, -0.0037129123229533434, 0.008248532190918922, 0.019272806122899055, -0.021032683551311493, -0.006982278544455767, -0.03319443762302399, -0.013714167289435863, -0.018600331619381905, 0.008656308054924011, -0.010795346461236477, 0.017670314759016037, -0.01885787397623062, 0.009085546247661114, -0.00011960550182266161, -0.006703273393213749, -0.004245883319526911, -0.0031405945774167776, 0.04258045181632042, -0.022048547863960266, -0.01935865357518196, -0.05974998697638512, -0.03016115352511406, -0.011124429292976856, 0.025654150173068047, -0.018442943692207336, -0.009200010448694229, 0.005755371879786253, -0.04215121269226074, -0.024294894188642502, -0.021418998017907143, -0.022921331226825714, -0.006817737128585577, -0.027428334578871727, 0.011947136372327805, -0.006817737128585577, 0.0038524148985743523, -0.00647434638813138, -0.01469426229596138, -0.005562214646488428, 0.023980120196938515, 0.009936869144439697, -0.014014634303748608, 0.025639841333031654, -0.003255058079957962, -0.04220844432711601, 0.019587580114603043, -0.025267835706472397, -0.035455092787742615, 0.029531603679060936, -0.0044497717171907425, 0.0033337518107146025, -0.03187810629606247, -0.010215874761343002, 0.03204980120062828, -0.012383528985083103, -0.011582283303141594, -0.030905166640877724, -0.004081341903656721, 0.0036878734827041626, -0.009164240211248398, 0.010158643126487732, 0.024881521239876747, 0.012834228575229645, 0.009386013261973858, -0.012133139185607433, -0.011167353019118309, -0.0325935035943985, 0.00784790888428688, -0.04856117442250252, 0.026412470266222954, 0.0035447939299046993, -0.011324740014970303, -0.015009037218987942, -0.03210703283548355, -0.04298107326030731, -0.016554296016693115, -0.022048547863960266, -0.015896130353212357, 0.01394309476017952, 0.010416185483336449, 0.007418670691549778, -0.01751292683184147, 0.007361439056694508, 0.03754405304789543, -0.010459109209477901, -0.03170641139149666, 0.01675460673868656, -0.02832973562180996, 0.001268936088308692, -0.015881821513175964, -0.009629248641431332, -0.01963050477206707, -0.005751794669777155, 0.04421155899763107, -0.005365480203181505, 0.019487423822283745, 0.001297552022151649, -0.003941839560866356, -0.02933129295706749, -0.034682463854551315, 0.0012340605026111007, 0.011110121384263039, -0.0059664142318069935, -0.01164666935801506, 0.02040313370525837, -0.010459109209477901, -0.013621166348457336, -0.044726643711328506, 0.00040129321860149503, -0.022878408432006836, 0.0005884143174625933, 0.051537226885557175, -0.016539987176656723, 0.016497064381837845, -0.014708570204675198, 0.037057582288980484, -3.1410414521815255e-05, 0.04163612797856331, -0.0019279959378764033, 0.0072469753213226795, 0.01801370643079281, 0.019473116844892502, -0.014980421401560307, -0.0318208746612072, -0.024108892306685448, 0.006964393425732851, 0.013292083516716957, 0.0006684494437649846, -0.02738541178405285, 0.010416185483336449, -0.0067175813019275665, 0.024151815101504326, 0.00962209515273571, 0.0024895828682929277, -0.003206768771633506, -0.014465334825217724, -0.04315276816487312, 0.04856117442250252, 0.000709584797732532, 0.004614313133060932, 0.017698930576443672, -0.0443546362221241, -0.023250414058566093, -0.01747000403702259, -0.030561774969100952, 0.035912949591875076, -0.026641398668289185, 0.02904513292014599, -0.042551834136247635, -0.02533937431871891, -0.012347758747637272, 0.0017795509193092585, -0.004760969430208206, -0.04547065868973732, -0.018643256276845932, -0.008699231781065464, 0.001552412286400795, -0.016067825257778168, 0.02007405087351799, -0.0019011684926226735, 0.031191324815154076, 0.011131582781672478, 0.0217910036444664, -0.041607510298490524, 0.013871555216610432, 1.9855071514029987e-05, -0.04318138584494591, 0.007189743686467409, -0.021748080849647522, -0.017713239416480064, -0.035083089023828506, -0.00236438843421638, 0.013792861253023148, -0.014780109748244286, 0.020388824865221977, -0.052538782358169556, -0.022191626951098442, -0.010931272059679031, -0.0016525678802281618, 0.056316081434488297, -0.04592851176857948, 0.0129701541736722, -0.014372332952916622, -0.00839876476675272, -0.02549676224589348, -0.007561750244349241, -0.01679752953350544, 0.005955683067440987, 0.0011365875834599137, -0.009879637509584427, 0.022434862330555916, -0.017040764912962914, -0.07823585718870163, -0.04578543081879616, 0.015996284782886505, 0.0010239124530926347, -0.04137858375906944, -0.014365179464221, -0.01706938073039055, -0.017040764912962914, 0.047216225415468216, 0.03671419247984886, -0.036284953355789185, -0.019144034013152122, -0.004886163864284754, 0.005937798414379358, 0.03943270444869995, -0.028372660279273987, 0.01862894743680954, 0.015939053148031235, -0.02790049836039543, 0.011052889749407768, -0.029231136664748192, -0.04009087011218071, 0.02063206024467945, -0.023965811356902122, -0.015309504233300686, -0.0067533510737121105, -0.037515439093112946, 0.015767358243465424, 0.015939053148031235, -0.032192882150411606, 0.012505145743489265, -0.02339349500834942, 0.0040670339949429035, 0.0005665053031407297, -0.026641398668289185, 0.0016767126508057117, 0.02549676224589348, -0.04232290759682655, -0.019716352224349976, -0.023879963904619217, -0.012877152301371098, -0.010423339903354645, -0.033795371651649475, 0.00533686438575387, 0.004564235452562571, 0.011997213587164879, 0.011317586526274681, -0.006849929690361023, 0.02422335557639599, -0.04117827117443085, 0.024309203028678894, -0.03957578167319298, 0.013678397983312607, -0.025425221771001816, -0.02129022590816021, 0.009500477463006973, 0.004918356891721487, 0.03021838515996933, -0.03903207927942276, -0.024767057970166206, -0.01361401192843914, 0.03339475020766258, 0.01231198851019144, -0.009607786312699318, 0.014823033474385738, 0.0025897384621202946, 0.007125357631593943, -0.00903546903282404, -0.0007945381803438067, 0.059692755341529846, 0.01968773640692234, 0.02367965318262577, -0.003543005557730794, 0.029145289212465286, 0.008978237397968769, 0.04034841060638428, -0.00975801981985569, 0.006778390146791935, -0.03453938663005829, -0.040176715701818466, -0.006248996127396822, -0.034739695489406586, -0.005780410952866077, -0.014522566460072994, -0.011990060098469257, -0.028730358928442, -0.006939354352653027, -0.025325067341327667, 0.02063206024467945, 0.004514157306402922, -0.024051658809185028, -0.0001754959230311215, 0.014422411099076271, -0.028730358928442, 0.018543099984526634, 0.0037701441906392574, 0.01183267217129469, -0.026827402412891388, -0.1307174116373062, -0.01968773640692234, 0.04735930636525154, 0.024581054225564003, -0.03099101409316063, -0.002992149442434311, -0.0017616660334169865, 0.02811511605978012, 0.0005271584377624094, 0.006238264963030815, -0.01073096040636301, -0.009521938860416412, -0.008584768511354923, -0.027371102944016457, 0.009879637509584427, -0.05654500797390938, 0.014522566460072994, -0.0030010920017957687, 0.009500477463006973, 0.01679752953350544, -0.0243950504809618, -0.019444501027464867, -0.005193784832954407, 0.0054727899841964245, -0.026326622813940048, -0.0032693659886717796, 0.011253200471401215, 0.005572945345193148, -0.010974195785820484, 0.01618228852748871, 0.002239193767309189, 0.006488654296845198, 0.021218685433268547, 0.028630202636122704, -0.0024699093773961067, -0.02655555121600628, -0.01945880800485611, 0.001087403972633183, 0.016396908089518547, -0.01191852055490017, 0.022191626951098442, -0.0561157688498497, 0.015266579575836658, -0.024080276489257812, 0.0022105779498815536, -0.04034841060638428, 0.0029510140884667635, -0.021705156192183495, 0.010659420862793922, -0.0005168745992705226, -0.02229178138077259, 0.012283372692763805, -0.006316958926618099, -0.03222149610519409, 0.004789585247635841, 0.03691450506448746, -0.015037653036415577, 0.015953361988067627, 0.009944023564457893, 0.0076690600253641605, -0.012354912236332893, 0.012912922538816929, 0.02917390502989292, -0.0006738149095326662, -0.002083594910800457, -0.013656935654580593, 0.006027223076671362, 0.029846377670764923, -0.012326296418905258, -0.024080276489257812, -0.0443546362221241, -0.012018675915896893, -0.022706713527441025, 0.015896130353212357, -0.014780109748244286, -0.001696386025287211, 0.009157086722552776, 0.0451272651553154, -0.033795371651649475, 0.02466690167784691, 0.028630202636122704, -0.023021487519145012, 0.0075188265182077885, 0.008205607533454895, -0.007189743686467409, 0.012347758747637272, 0.023608112707734108, -0.03459661826491356, -0.005190208088606596, 0.00576610304415226, 0.03688588738441467, -0.001640942762605846, -0.005665947217494249, 0.009972639381885529, -0.0044140019454061985, -0.036399416625499725, -0.0013681974960491061, 0.007332823239266872, 0.028630202636122704, 0.00990109983831644, 0.01252660807222128, 0.046329133212566376, -0.028701743111014366, -0.03957578167319298, -0.027070635929703712, 0.0015103827463462949, -0.005640908144414425, -0.02788618952035904, 0.005286786705255508, 0.005780410952866077, 0.007454440463334322, 0.018557408824563026, -0.03980470821261406, 0.00773344561457634, -0.0127269197255373, 0.040062252432107925, 0.03133440390229225, 0.013242005370557308, 0.03476831316947937, -0.010251644067466259, 0.00038899731589481235, 0.03888900205492973, -0.017255384474992752, -0.009715096093714237, -0.035626787692308426, 0.008828003890812397, -0.0039060695562511683, -0.0014477854128926992, 0.0021229416597634554, -0.02811511605978012, 0.01095273345708847, -0.012211833149194717, 0.008255685679614544, 0.008191299624741077, 0.010294567793607712, 0.012176062911748886, 0.014465334825217724, 0.0036503151059150696, -0.03897484764456749, 0.009944023564457893, -0.009264395572245121, -0.0014057558728381991, 0.02938852459192276, 0.03164917975664139, -0.017398463562130928, 0.004081341903656721, -0.03282243013381958, -0.019115418195724487, -0.034739695489406586, 0.023307645693421364, 0.022606557235121727, -0.009250087663531303, -0.014837341383099556, -0.0065673477947711945, -0.01209021545946598, -0.004642928950488567, 0.0019673428032547235, -0.032965511083602905, 0.023193182423710823, 0.03516893461346626, 0.05717455968260765, 0.024981675669550896, -0.0008696549339219928, -0.019773583859205246, 0.009436091408133507, 0.005909182131290436, -0.02423766255378723, -0.023436417803168297, 0.00375583628192544, 0.007039510179311037, -0.029302677139639854, 0.0015747684519737959, 0.03159194812178612, 0.012590994127094746, 0.027199408039450645, 0.021533461287617683, 0.0422370620071888, 0.016454139724373817, 0.02201993204653263, 0.025253526866436005, 0.016883378848433495, 0.05528590828180313, -0.0028687433805316687, -0.013141850009560585, 0.014486797153949738, -0.02961745113134384, 0.012469376437366009, 0.022306090220808983, 0.011331894434988499, 0.03150609880685806, 0.023693960160017014, 0.03525478392839432, 0.009214318357408047, 0.03322305530309677, -0.027185101062059402, -0.0027113561518490314, 0.044383253902196884, 0.02794342115521431, 0.02107560634613037, 0.0004348274669609964, 0.0022427707444876432, 0.03408152982592583, -0.03820221871137619, -0.022034239023923874, 0.005029243417084217, 0.005755371879786253, 0.03247904032468796, -0.01623952016234398, -0.021376073360443115, 0.009822405874729156, -0.017713239416480064, -0.022105779498815536, -0.0017241076566278934, 0.018271248787641525, -0.020417440682649612, -0.00809829868376255, 0.025525378063321114, 0.03270796686410904, 0.010795346461236477, -0.016282444819808006, -0.005565791390836239, -0.022821176797151566, -0.0441543273627758, 0.007883679121732712, 0.006671080365777016, 0.01039472408592701, 0.004439040552824736, 0.012655379250645638, -0.03004669025540352, -0.01581028290092945, 0.011782594956457615, 0.004095649812370539, -0.01100281160324812, -0.013127542100846767, -0.007676213979721069, 0.014071865938603878, -0.002267809584736824, 0.0005691880360245705, -0.010916964150965214, 0.007461594417691231, 0.02738541178405285, -0.012540915980935097, -0.030733471736311913, 0.024981675669550896, 0.03144886717200279, -0.01985943131148815, 0.02601184882223606, 0.059578292071819305, -0.01430794782936573, -0.008269993588328362, -0.0014567278558388352, 0.01847155950963497, 0.04352477565407753, 0.0008821744122542441, 0.02067498490214348, 0.0024860058911144733, 0.03611325845122337, -0.0056587932631373405, 0.015538430772721767, 0.03771574795246124, 0.0003031496307812631, 0.014322255738079548, 0.007447286508977413, 0.002918821293860674, -0.01405755802989006, -0.03416737914085388, -0.03333751857280731, 0.004843240138143301, 0.04232290759682655, 0.013649782165884972, 0.014737186022102833, 0.0331658236682415, -0.011195968836545944, 0.024437975138425827, -0.015309504233300686, -0.03250765800476074, 0.018342789262533188, -0.024995984509587288, 0.02273532934486866, 0.007432978600263596, -0.0070967418141663074, -0.003188883885741234, -0.01416486781090498, -0.02300717867910862, -0.030189769342541695, -0.012977308593690395, -0.01679752953350544, -0.004274499136954546, 0.011131582781672478, -0.014837341383099556, 0.023994427174329758, 0.02778603322803974, -0.024194739758968353, 0.00042364938417449594, -0.004642928950488567, 0.00011440768867032602, 0.012598147615790367, 0.025525378063321114, -0.003170998767018318, -0.008413072675466537, 0.021275917068123817, 0.03250765800476074, 0.0017464638222008944, -0.05923490226268768, 0.02123299427330494, 0.016668759286403656, 0.03439630568027496, -0.033566445112228394, -0.022191626951098442, -0.008999698795378208, -0.008856619708240032, 0.02938852459192276, 0.022778252139687538, -0.006095185410231352, 0.050707366317510605, 0.015409659594297409, -0.011968597769737244, -0.014350871555507183, 0.018943723291158676, -0.020059742033481598, 0.007214782293885946, -0.0027667994145303965, -0.011997213587164879, 0.022921331226825714, -0.006470769178122282, -0.017312616109848022, 0.004714468494057655, 0.001942303846590221, -0.007032356224954128, 0.0008915640064515173, 0.011432049795985222, 0.000756085617467761, 0.03805914148688316, -0.02040313370525837, -0.03010392189025879, -0.006942931562662125, -0.03960439935326576, 0.008362995460629463, -0.019759275019168854, -0.009808097966015339, 0.028515739366412163, 0.025153372436761856, 0.0059306444600224495, 0.007661906071007252, -0.008112606592476368, 0.014508258551359177, 0.011682438664138317, 0.001552412286400795, -0.011024273931980133, -0.03866007551550865, 0.09059792011976242, -0.019945278763771057, -0.029474372044205666, 0.012555223889648914, 0.02611200325191021, -0.02223454974591732, -0.005297517403960228, -0.03559817373752594, -0.03791606053709984, 0.011467820033431053, 0.004235152620822191, 0.009908253327012062, -0.005809026770293713, 0.011632361449301243, 0.004392540082335472, -0.03582710027694702, -0.0005821546074002981, 0.0036145453341305256, 0.011911366134881973, 0.020031126216053963, 0.016554296016693115, 0.008949621580541134, 0.0022731751669198275, 0.005179476924240589, -0.019759275019168854, -0.002917032688856125, 0.02551107108592987, 0.0016355772968381643, 0.033022742718458176, 0.0464722141623497, -0.006739043164998293, -0.00436392379924655, -0.05482805520296097, 0.03293689340353012, -0.00680700596421957, 0.001530056120827794, -0.013521010056138039, 0.039003465324640274, -0.0084846131503582, -0.03482554480433464, 0.008162683807313442, 0.017384156584739685, 0.0045213112607598305, 0.0045213112607598305, 0.008570460602641106, -0.0034696771763265133, -0.0047073145397007465, -0.0027220870833843946, -0.042008135467767715, -0.0022713865619152784, 0.012991616502404213, -0.00826284009963274, 0.022363321855664253, -0.018328480422496796, 0.00043415676918812096, -0.039776094257831573, -0.024037351831793785, 0.011839826591312885, 0.00734713114798069, 0.012648225761950016, -0.03153471648693085, 0.005347595550119877, -0.013964557088911533, -0.020703600719571114, -0.002632662421092391, -0.040777649730443954, 0.006907161790877581, 0.006163148209452629, -0.010974195785820484, 0.06037953868508339, -0.021805312484502792, 0.009064084850251675, -0.004857548046857119, -0.005444174166768789, 0.011947136372327805, -0.0035626788157969713, -0.0003185753885190934, 0.004328154027462006, 0.0302756167948246, 0.0590059757232666, -0.01902957074344158, -0.0166830662637949, -0.002899147802963853, 0.010165796615183353, -0.004163612611591816, 0.0038381069898605347, 0.02998945862054825, -0.019058186560869217, 0.007086011115461588, -0.008405919186770916, -0.02479567378759384, 0.010130026377737522, 0.00909270066767931, 0.016611527651548386, 0.035283397883176804, -0.01629675179719925, -0.015438275411725044, -0.013206235133111477, 0.010001255199313164, 0.004321000073105097, 0.02373688481748104, -0.011897058226168156, -0.003235384589061141, 0.0108955018222332, -0.027142176404595375, 0.029674682766199112, -0.052252624183893204, 0.013950249180197716, 0.015180732123553753, 0.0014808725100010633, -0.012934384867548943, -0.003571621375158429, 0.042551834136247635, 0.0021783849224448204, -0.006091608665883541, 0.013256313279271126, -0.007318515330553055, 0.023636728525161743, 0.01596766896545887, -0.025911692529916763, 0.03322305530309677, 0.01569581776857376, -0.018142476677894592, 0.001558672054670751, -0.01785631850361824, -0.0031101901549845934, -0.011796902865171432, 0.03408152982592583, 0.02938852459192276, -0.03986194357275963, -0.019587580114603043, -0.0025325065944343805, -0.020088357850909233, 0.013385084457695484, 0.018943723291158676, 0.016425523906946182, 0.006667503621429205, -0.0325935035943985, -0.03476831316947937, -0.024581054225564003, 0.011339048855006695, 0.011632361449301243, -0.008670615963637829, -0.005866258405148983, 0.0014808725100010633, 0.00942893698811531, -0.00751167256385088, 0.0006541414768435061, 0.0049398187547922134, 0.038459762930870056, -0.010273106396198273, 0.01256237830966711, -0.01006564125418663, -0.002294637029990554, -0.00017113646026700735, -0.020145589485764503, 0.010773884132504463, -0.0019440923351794481, 0.003848837921395898, -0.022477785125374794, 0.0184143278747797, -0.030676240101456642, -0.032250113785266876, 0.023922888562083244, 0.030361464247107506, 0.03133440390229225, -0.027914805337786674, 0.008749309927225113, 0.04552789032459259, -0.00832007173448801, 0.017441388219594955, -0.024523822590708733, 0.018214017152786255, -0.0069178924895823, -0.01679752953350544, -0.03033284842967987, -0.0023107335437089205, -0.019186956807971, 0.008684923872351646, 0.017341231927275658, -0.0012295892229303718, -0.006352728698402643, 0.03891761600971222, -0.005515713710337877, 0.008534690365195274, -0.012676841579377651, 0.019544655457139015, -0.009572017006576061, -0.017842009663581848, 0.007046664133667946, 0.040777649730443954, 0.02157638408243656, 0.003160267835482955, -0.0050900522619485855, 0.018814951181411743, 0.003646738128736615, -0.02167654037475586, -0.01361401192843914, 0.02595461718738079, 0.015939053148031235, 0.002845493145287037, -0.025811538100242615, 0.015338120050728321, -0.0016570391599088907, 0.01679752953350544, 0.007089587859809399, -0.007583212107419968, -0.0041421507485210896, 0.0062990738078951836, 0.03342336416244507, 0.03159194812178612, -0.012605302035808563, 0.02335057035088539, 0.03099101409316063, 0.021533461287617683, 0.0014558336697518826, -0.003487562295049429, -0.01302738580852747, -0.01675460673868656, -0.009851021692156792, 0.00038586746086366475, 0.006760505028069019, 0.009436091408133507, 6.421808939194307e-05, -0.04713037982583046, 0.012412144802510738, -0.01392163336277008, -0.02063206024467945, 0.011961444281041622, 0.011954289861023426, 0.031134093180298805, -0.023636728525161743, 0.011145890690386295, 0.009400321170687675, 0.019616195932030678, -0.004607159178704023, -0.0004989896551705897, -0.0017330500995740294, 0.0028222426772117615, -0.0071754357777535915, -0.04684422165155411, 0.02472413331270218, 0.014737186022102833, -0.00014553865185007453, -0.014951805584132671, 0.026326622813940048, 0.004181497730314732, -0.017784778028726578, -0.021504845470190048, 0.0026630668435245752, 0.020031126216053963, 0.03256488963961601, 0.0064600384794175625, -0.0501350462436676, 0.004195805639028549, -0.023922888562083244, -0.027628647163510323, -0.017985090613365173, 0.00909270066767931, -0.0017723969649523497, 0.004861125256866217, -0.010723806917667389, 0.008327225223183632, 0.00359666021540761, 0.008141222409904003, 0.0006899113650433719, -0.013964557088911533, -0.004800316412001848, -0.01519504003226757, -0.02289271540939808, -0.042380139231681824, 0.001023018267005682, -0.022148702293634415, 0.02987499348819256, 0.031134093180298805, 0.025582609698176384, -0.0032854625023901463, -0.036342184990644455, -0.006506538949906826, 0.012791304849088192, 0.04464079439640045, -0.01252660807222128, -0.02478136494755745, 0.02157638408243656, 0.021190069615840912, 0.009056930430233479, -0.039947789162397385, -0.026655705645680428, 0.004514157306402922, 0.008713539689779282, 0.017927858978509903, 0.025353683158755302, -0.009464707225561142, -0.02096114307641983, 0.02828681282699108, 0.0021336725912988186, -0.011947136372327805, -0.03267935290932655, -0.005776833742856979, 0.035741254687309265, -0.025911692529916763, -0.01405755802989006, 0.023693960160017014, -0.015767358243465424, 0.01691199466586113, 0.004968434572219849, -0.01280561275780201, 0.044326022267341614, 0.023107334971427917, 0.012841382995247841, 0.02894497849047184, 0.0025646996218711138, 0.008720694109797478, -0.002473486354574561, -0.00031008003861643374, -0.013013077899813652, -0.004571389406919479, -0.0005817075143568218, -0.021719465032219887, 0.04695868492126465, -0.010494879446923733, 0.02998945862054825, -0.028959285467863083, -0.021776696667075157, 0.04209398105740547, -0.03800190985202789, -0.011897058226168156, 0.01880064234137535, 0.04031979665160179, -0.012061599642038345, 0.019487423822283745, -0.021833928301930428, 0.02956021949648857, -0.023922888562083244, -0.005487097892910242, 0.021333150565624237, -0.016497064381837845, -0.009357397444546223, 0.03642803430557251, -0.0076261358335614204, -0.0041421507485210896, -0.015924746170639992, -0.013377930968999863, -0.016282444819808006, -0.01586751453578472, 0.027871882542967796, -0.0069894324988126755, 0.008413072675466537, -0.008248532190918922, -0.014579798094928265, 0.027986345812678337, 0.0007082434021867812, -0.010258798487484455, 0.005733910016715527, -0.01344231702387333, 0.006009337957948446, 0.018528791144490242, 0.016167981550097466, -0.03854561224579811, -0.020217129960656166, -0.04031979665160179, -0.029703298583626747, 0.0302756167948246, 0.00951478537172079, 0.004321000073105097, 0.04014810174703598, -0.01008710265159607, 0.007905141450464725, -0.0174556951969862, 8.472987974528223e-05, 0.005665947217494249, 0.04052010551095009, 0.008162683807313442, 0.00942178349941969, 0.01126035489141941, 0.01455118227750063, -0.014250715263187885, -0.026856018230319023, -0.013256313279271126, 0.010215874761343002, 0.01701214909553528, -0.0323931947350502, 0.03439630568027496, -0.014157714322209358, 0.04836086183786392, 0.006288343109190464, -0.011968597769737244, 0.0277717262506485, -0.027428334578871727]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" j←j+ 1
32: end if
33: end while
34: ifisaccept then
35: continue
36: else
37: {guarantee one step movement }
38: o.append( argmax P)
39: break
40: end if
41: end for
42: ifisaccept then
43: o.append( argmax D[1]N)
44: end if
45: return o
46:end function
12
Lookahead decoding
Algorithm 4 Sample Verification with L OOKAHEAD DECODING
1:input prefill x0, model PM, n-grams giwithi∈[1, G]
2:output o{accepted tokens of length 1 to N }
3:function SampleVerification( x0,PM,g)
4:V,D,o← ∅,∅,∅
5: fori= 1toGdo
6: V.append( gi
2:){each is a n-1 gram }
7: D.append( PM(gi′
2:,xnext|gi
2:,x0))
8: {obtain last token of x0and all gi
2:’s outputs – totally N probability distributions }
9: end for
10: fori= 1toN−1do
11: j←1
12: isaccept ←0
13: Pj←D[j]i{D[j] is a series of N probability distributions;all D[j]ishould be the same; size( D)>0is
guaranteed }
14: while j≤size(V)do
15: sj←V[j]i
16: sample r∼U(0,1)
17: ifr≤ Pj(sj)then
18: {accepted, update all potential speculations and probabilities }
19: o.append( sj)
20: isaccept ←1
21: Vnew,Dnew← ∅,∅
22: fork=jto size( V)do
23: ifsj=V[k]ithen
24: Vnew.append( V[k])
25: Dnew.append( D[k])
26: end if
27: end for
28: V,D←Vnew,Dnew
29: break
30: else
31: {rejected, go to next speculation }
32: Pj(sj) = 0
33: Pj+1=norm (Pj)
34: j←j+ 1
35: end if
36: end while
37: ifisaccept then
38: continue
39: else
40: {guarantee one step movement }
41: sample xnext∼ Pj
42: o.append( xnext)
43: break
44: end if
45: end for
46: ifisaccept then
47: o.append(sample xnext∼D[1]N)
48: end if
49: return o
50:end function
13
Lookahead decoding
B. Proof: Output distribution preserved disjoint n-gram verification
The sampling verification in LOOKAHEAD DECODING is adapted from the algorithm in Specinfer but with all speculations
generated by the greedy sample. It does not change the output distribution from a fundamental point that how the draft
model generates speculations is unimportant.
Theorem A For a given LLM, prompt and previously generated tokens x= (x1, x2, ..., x i), and Gspeculations s=
(s1, s2, ..., s G)of next token xi+1. Each speculation token is sampled by a greedy sample (i.e., probability of 1). We
useP(v|x)to represent the probability of xi+1=vsampled by the LLM and use Q(v|x)to represent the probability of
xi+1=vsampled by our proposed algorithm 4. We use P(v)andQ(v)for short. We need to prove P(v) =Q(v)for any
G, and any vandsjfrom the full vocabulary V.
Proof. The proof of this part corresponds to line 14 to line 44 in algorithm 4. Given speculations s, we use aj(v)to represent
the probability that the token vis accepted by the j-th speculation (line 18-line 30), and rj(sj)is the probability that the
token sjis rejected by the j-th speculation (line 30-line 35), where sjis the j-th speculation’s token. Moreover, a′
G+1(v)is
the probability of being accepted by the sampling at line 41. For simplicity, we use ajto represent aj(v),a′
jto represent
a′
j(v),","[0.057164862751960754, -0.006348343100398779, 0.004389917477965355, 0.013735446147620678, -0.053380336612463, -0.014966078102588654, -0.005570927634835243, -0.015760034322738647, 0.014952845871448517, 0.006225941702723503, 0.07055626064538956, -0.03443124517798424, -0.06563372910022736, 0.04128573462367058, -0.030276205390691757, -0.01902848854660988, -0.010506689548492432, -0.018737372010946274, 0.008819532580673695, 0.031361278146505356, 0.0038341479375958443, -0.017083296552300453, 0.027629682794213295, 0.056582625955343246, 0.012604057788848877, -0.06515735387802124, 0.010572852566838264, 0.04200029373168945, 0.057006072252988815, -0.06219325214624405, -0.01705683022737503, -0.03556924685835838, -0.02148975431919098, -0.029349923133850098, -0.01744057610630989, 0.038559816777706146, 0.029349923133850098, -0.011929195374250412, -0.03064671717584133, -0.0206825640052557, -0.008978324010968208, -0.02622702717781067, -0.04528198018670082, 0.0036786647979170084, 0.035251665860414505, 0.045917145907878876, 0.009666419588029385, -0.02229694277048111, -0.008746753446757793, 0.06219325214624405, -0.013100281357765198, 0.010804424062371254, -0.016183478757739067, 0.03945963457226753, 0.009018021635711193, -0.0030219967011362314, -0.016646619886159897, 0.018115438520908356, 0.035331059247255325, 0.009567175060510635, -0.0016499407356604934, -0.009924455545842648, 0.017890485003590584, 0.020933983847498894, -0.023209992796182632, -0.022773316130042076, -0.030831973999738693, 0.010943366214632988, 0.022746851667761803, 0.05253345146775246, -0.032790400087833405, 0.03130834922194481, 0.0006252406747080386, -0.045917145907878876, -0.058435194194316864, 0.015032241120934486, 0.030170343816280365, 0.02911173552274704, 0.04893418028950691, -0.01818160153925419, 0.03310798108577728, 0.012729767709970474, 0.03107016161084175, -0.04866952821612358, 0.019571024924516678, -0.03324030712246895, -0.0004195149813313037, 0.006417814176529646, -0.027179773896932602, -0.016739247366786003, -0.042185552418231964, 0.01186303235590458, -0.025327209383249283, 0.01748027466237545, 0.025697723031044006, 0.016527526080608368, 0.016527526080608368, -0.03189058229327202, 0.03739534690976143, 0.00932237133383751, 0.008574729785323143, -0.02868829108774662, 0.056159183382987976, -0.027391497045755386, 0.07198537886142731, -0.017586134374141693, -0.059440869837999344, 0.026319654658436775, -0.050389766693115234, 0.0006140756886452436, -0.06108171492815018, -0.01729501783847809, -0.03429891914129257, 0.05324801057577133, 0.003804374486207962, 0.0026845652610063553, -0.05078674480319023, -0.04575835540890694, 0.009057719260454178, -0.0007348232320509851, -0.06198153272271156, -0.011221250519156456, 0.024903766810894012, -0.022971805185079575, -0.005534538067877293, -0.0012149186804890633, 0.056582625955343246, -0.06346358358860016, 0.028291312977671623, 0.006229249760508537, 0.024506788700819016, 0.02086782082915306, 0.01380160916596651, -0.018459485843777657, -0.04054470732808113, 0.011538833379745483, -0.024692045524716377, -0.009891374036669731, -0.013563422486186028, 0.04882831871509552, 0.0028284697327762842, -0.036019157618284225, -0.06330478936433792, -0.011902729980647564, -0.016699550673365593, 0.004535476211458445, -0.0270342156291008, -0.0008051214390434325, -0.034272450953722, -0.020245889201760292, -0.022164616733789444, -0.013947167433798313, -0.05552401766180992, 0.017003899440169334, 0.012266626581549644, -0.032446350902318954, -0.04848427325487137, 0.022363105788826942, 0.011168320663273335, 0.02298503927886486, -0.029482249170541763, 0.020695798099040985, 0.02530074492096901, -0.02032528445124626, -0.02098691463470459, 0.032022908329963684, -0.05332740768790245, 0.006483977660536766, -0.045493703335523605, 0.0015705450205132365, 0.011949043720960617, 0.003711746307089925, -0.011366809718310833, 0.0057793413288891315, -0.00347025110386312, -0.00868059042841196, 0.007013281807303429, -0.051421910524368286, 0.019160814583301544, -0.10453759878873825, -0.03760707005858421, 0.03885093331336975, 0.05684727802872658, -0.03707776591181755, -0.039644889533519745, -0.01751997135579586, 0.012101219035685062, -0.0160511527210474, -0.006497209891676903, 0.005220263265073299, 0.02475820854306221, 0.03893033042550087, 0.02044437825679779, 0.010142792947590351, -0.026491679251194, -0.06838611513376236, 0.06192860007286072, 0.03207584097981453, 0.06790973991155624, -0.01729501783847809, -0.019610723480582237, 0.009613488800823689, -0.021661777049303055, -0.00887246336787939, 0.025830049067735672, -0.0017698612064123154, 0.0227997824549675, -0.0022048831451684237, -0.0040160962380468845, -0.03858628123998642, 0.02102661319077015, -0.04567895829677582, 0.03715715929865837, 0.008707055822014809, -0.02391132153570652, 0.03935377299785614, -0.015415986999869347, 0.0321023054420948, -0.017705228179693222, 0.07627274841070175, 0.00831669382750988, 0.013642817735671997, 0.037210091948509216, 0.05102493241429329, -0.018975557759404182, 0.05510057508945465, 0.03477529063820839, 0.006265639327466488, 0.009739198721945286, -0.008409321308135986, 0.020245889201760292, -0.01081765629351139, -0.014145656488835812, -0.04967520758509636, 0.009964153170585632, -0.0160511527210474, -0.006828024983406067, -0.018115438520908356, -0.026862192898988724, -0.021542685106396675, -0.024056879803538322, 0.016739247366786003, 0.017758158966898918, -0.012312941253185272, -0.014780822210013866, 0.0017318174941465259, -0.024744974449276924, -0.012173998169600964, -0.004207969177514315, 0.04213261976838112, -0.012663604691624641, -0.03366375342011452, -0.021053077653050423, -0.017467040568590164, -0.06002310663461685, 0.004681034944951534, -0.022892409935593605, 0.009725966490805149, -0.05626504495739937, 0.012412185780704021, -0.001458067912608385, -0.030064482241868973, -0.04088875651359558, 0.06129343435168266, -0.017228854820132256, 0.003900310955941677, 0.01721562258899212, 0.005018466152250767, 0.005157408770173788, -0.00785355269908905, -0.052930429577827454, -0.018221300095319748, -0.010420678183436394, 0.020510541275143623, -0.03435184806585312, -0.032790400087833405, 0.011029377579689026, 0.008323309943079948, -0.011300646699965, 0.0438263937830925, -0.01951809599995613, -0.015045474283397198, 0.06309307366609573, 0.03022327460348606, 0.044646814465522766, 0.009984002448618412, -0.0060803829692304134, -0.022363105788826942, -0.022045522928237915, 0.002409988548606634, 0.02141035720705986, -0.03734241798520088, 0.021741174161434174, -0.00979874562472105, 0.02576388604938984, -0.006894188467413187, 0.0101692583411932, 0.0028235074132680893, 0.011604996398091316, -0.012021823786199093, 0.05933500826358795, -0.002299165353178978, 0.017321482300758362, 0.013411247171461582, -0.022191081196069717, 0.013907469809055328, 0.0017103144200518727, 0.015363057143986225, -0.021092776209115982, -0.005673480220139027, 0.025658024474978447, -0.018896162509918213, -0.03437831252813339, 0.001291006221435964, -0.015892360359430313, -0.013384781777858734, 0.07531999796628952, -0.016884805634617805, -0.02125156670808792, -0.017758158966898918, -0.007714610081166029, -0.010288352146744728, 0.033875472843647, 0.008382856845855713, 0.009395151399075985, -0.02110600844025612, -0.01636873558163643, -0.027470892295241356, 0.02199259214103222, 0.007390411105006933, 0.02199259214103222, 0.014767589047551155, -0.010255270637571812, -0.005789265502244234, -0.03477529063820839, -0.018896162509918213, -0.015151334926486015, 0.004161654971539974, 0.009209894575178623, 0.03562217950820923, -0.08511212468147278, 0.017586134374141693, 0.023037968203425407, -0.029985086992383003, -0.05213647335767746, 0.005461758468300104, -0.0019071494461968541, 0.01955779269337654, 0.05441248044371605, 0.047954969108104706, -0.012663604691624641, -0.023977484554052353, 0.047002218663692474, -0.015839431434869766, 0.01463526301085949, -0.03297565504908562, 0.015071939677000046, -0.019306372851133347, -0.010784574784338474, 0.01463526301085949, -0.041523922234773636, 0.010248654522001743, 0.0027556903660297394, 0.01540275476872921, 0.007542585954070091, -0.01511163730174303, -0.022667456418275833, -0.07404966652393341, 0.03054085746407509, -0.012299708090722561, 0.0011917616939172149, 0.07325571030378342, -0.007926331833004951, 0.004350219387561083, -0.050733815878629684, -0.006980200298130512, -0.03268453851342201, 0.005792573560029268, 0.033399101346731186, 0.05525936558842659, -0.0169377364218235, -0.018896162509918213, 0.006351651158183813, -0.009845059365034103, 0.025499233976006508, 0.009858292527496815, -0.025433070957660675, -0.03927437588572502, -0.004770354833453894, -0.047505058348178864, -0.05179242417216301, -0.044885002076625824, 0.002568779746070504, 0.016964202746748924, -0.012392336502671242, 0.02491699904203415, 0.003963165916502476, 0.04779617488384247, 0.02884708344936371, 0.04213261976838112, -0.005782649386674166, -0.005147484131157398, -0.030567321926355362, -0.030064482241868973, -0.030699647963047028, 0.003237026510760188, -0.0003060040471609682, 0.05896449834108353, 0.022998271510004997, 0.0353575274348259, -0.0173347145318985, 0.01472789142280817, 0.03935377299785614, -0.08050718158483505, 0.041338663548231125, 0.021132472902536392, 0.04575835540890694, 0.022005826234817505, 0.050575025379657745, 0.06378116458654404, 0.014714659191668034, -0.03691897168755531, -0.03818930312991142, -0.006745321210473776, -0.047849107533693314, -0.040491778403520584, 0.010116328485310078, -0.00017388472042512149, 0.04808729514479637, -0.07230296730995178, -0.044461559504270554, 0.004929146263748407, 0.02903234027326107, -0.013331851921975613, -0.026015305891633034, -0.026253491640090942, 0.038215767592191696, -0.0015498690772801638, -0.0015465609030798078, -0.062404975295066833, -0.017705228179693222, -0.0028731299098581076, -0.005240112543106079, 0.015177800320088863, -0.04202675819396973, 0.004462696611881256, -0.04866952821612358, -0.07214417308568954, 0.044990863651037216, -0.02911173552274704, 0.026359353214502335, -0.00010182904952671379, 0.04496439918875694, -0.006953734904527664, -0.009018021635711193, -0.06796266883611679, 0.04054470732808113, 0.013735446147620678, 0.00583227165043354, -0.02552569843828678, -0.011075692251324654, -0.023818692192435265, -0.017149459570646286, 0.013603120110929012, 0.007198538165539503, -0.0008208351791836321, -0.01751997135579586, 0.010500073432922363, 0.03480175510048866, 0.02903234027326107, 0.004373376723378897, -0.048193152993917465, 0.022627757862210274, -0.003466943046078086, -0.00926282536238432, 0.02183380164206028, 0.025168418884277344, -0.03747474402189255, -0.0007869265973567963, -0.017572902143001556, -0.0003436342522036284, -0.006490593776106834, 0.023752529174089432, 0.02622702717781067, -0.005680096335709095, 0.05626504495739937, 0.015389521606266499, -0.00027602390036918223, -0.00291613582521677, -0.04541430622339249, -0.018657976761460304, -0.038559816777706146, 0.002380215097218752, -0.014913148246705532, 3.6053683288628235e-05, 0.006530291400849819, 0.038295164704322815, -0.014317681081593037, -0.002586974762380123, 0.03519873321056366, 0.026200562715530396, 0.01971658505499363, -0.004456080496311188, 0.08844674378633499, 0.005081321112811565, -0.02330262027680874, -0.006457512266933918, 0.004211277235299349, 0.0018360242247581482, 0.028926478698849678, -0.0318111889064312, 0.005018466152250767, -0.02209845371544361, -0.005339357070624828, -0.01729501783847809, -0.007430108729749918, -0.028741221874952316, -0.0063284942880272865, -0.020510541275143623, 0.0019071494461968541, 0.007972645573318005, -0.0024430700577795506, -0.026081468909978867, 0.021780870854854584, 0.021476522088050842, 0.0014158888952806592, -0.02514195255935192, -0.07759600877761841, -0.02679602988064289, -0.02183380164206028, 0.024546485394239426, -0.01717592403292656, -0.011055842973291874, -0.002132103778421879, -0.013682515360414982, -0.023342318832874298, -0.016845108941197395, -0.019425466656684875, 0.004346911329776049, -0.04292657598853111, 0.010314817540347576, 0.01332523487508297, 0.007926331833004951, -0.016342269256711006, -0.011452821083366871, -0.027179773896932602, 0.044885002076625824, -0.01875060424208641, -0.026716632768511772, 0.01609084941446781, 0.0023537499364465475, -0.023289388045668602, 0.013748678378760815, -0.026981284841895103, -0.04374700039625168, 0.03760707005858421, -0.009573791176080704, 0.02691512182354927, -0.0052599613554775715, -0.018168369308114052, 0.022005826234817505, 0.004135189577937126, -0.008965090848505497, -0.014145656488835812, -0.010076629929244518, 0.04266192391514778, 0.00031324062729254365, 0.006490593776106834, 0.05451834201812744, 0.020034167915582657, 0.002894632751122117, -0.014330913312733173, 0.011022761464118958, -0.0684390440583229, 0.007350713014602661, -0.04901357740163803, 0.017996344715356827, -0.012829012237489223, 0.0049324543215334415, -0.0003035229165107012, -0.029641039669513702, -0.013973632827401161, -0.017122993245720863, -0.017149459570646286, -0.013841306790709496, 0.004231126047670841, -0.001817829441279173, 0.02645198069512844, -0.016117315739393234, -0.008912160992622375, 0.0385068878531456, 0.005875277332961559, -0.04054470732808113, 0.014622030779719353, -0.04880185425281525, 0.012987803667783737, -0.009077568538486958, 0.006331802345812321, -0.020589936524629593, -0.007886634208261967, 0.03805697709321976, 0.021860266104340553, 0.009084184654057026, 0.01220707967877388, -0.024520020931959152, -0.026491679251194, -0.05218940228223801, 0.011102157644927502, 0.04051824286580086, -0.0060803829692304134, -0.005994371138513088, 0.015932058915495872, -0.03374314680695534, -0.01341786328703165, -0.039724286645650864, 0.0012686762493103743, -0.031255416572093964, -0.009904606267809868, 0.04170917719602585, -0.008177750743925571, 0.03064671717584133, -0.0072316196747124195, 0.04327062517404556, -0.0027656147722154856, 0.0229453407227993, 0.0004714116221293807, 0.007105909753590822, 0.012637139298021793, 0.0019369228975847363, -0.015958523377776146, -0.01828746311366558, -0.035092875361442566, 0.006966967601329088, -0.003400780027732253, 0.009567175060510635, -0.02641228400170803, 0.0017070062458515167, -0.01594529114663601, 0.03149360418319702, 0.010784574784338474, 0.004528859630227089, 0.01472789142280817, -0.002914481796324253, -0.04745212942361832, 0.03255221247673035, -0.008429170586168766, 0.01840655691921711, 0.01798311248421669, -0.01848595216870308, -0.008005727082490921, -0.027629682794213295, -0.03728948533535004, 0.026981284841895103, -0.03022327460348606, 0.03154653683304787, -0.026729866862297058, -0.001328222919255495, -0.016342269256711006, 0.028026660904288292, -0.0011743939248844981, -0.033134449273347855, -0.022918876260519028, -0.0028499728068709373, -0.00924297608435154, -0.010142792947590351, 0.017030365765094757, 0.02209845371544361, 0.027709079906344414, 0.01463526301085949, 0.004502394702285528, -0.06086999177932739, 0.022667456418275833, -0.0005417098291218281, -0.05271870642900467, -0.018459485843777657, -0.022508664056658745, -0.03543692082166672, -0.04922529682517052, 0.002405026229098439, 0.008918777108192444, -0.010566236451268196, 0.005365821998566389, -0.04993985965847969, -0.02145005576312542, -0.020417911931872368, -0.009739198721945286, 0.04814022406935692, -0.025313977152109146, 0.009084184654057026, -0.015071939677000046, -0.011512367986142635, -0.02090751938521862, 0.010605934076011181, -0.051580701023340225, 0.013146595098078251, -0.02356727235019207, -0.009507628157734871, 0.005862045101821423, -0.010374363511800766, -0.014198587276041508, -0.03816283866763115, 0.011783636175096035, 0.010050165466964245, -0.0480608269572258, -0.025499233976006508, -0.015124869532883167, -0.014066261239349842, 0.03842749074101448, 0.025830049067735672, -0.027060681954026222, -0.006199476309120655, 0.006986816413700581, -0.017387645319104195, 0.03435184806585312, -0.017162691801786423, 0.0006153162103146315, -0.010976447723805904, -0.03453710302710533, -0.005435293540358543, -0.010672097094357014, -0.04266192391514778, 0.016381967812776566, -0.021899964660406113, 0.004796820227056742, -0.007099293638020754, -0.01261067483574152, 0.005719794426113367, -0.00014597219706047326, -0.024599416181445122, 0.012981187552213669, -0.0005433639162220061, -0.0054816072806715965, 0.011419739574193954, -0.024467090144753456, 0.008793067187070847, 0.027867870405316353, -0.03670725226402283, 0.002340517472475767, -0.017228854820132256, -0.023924553766846657, 0.012961338274180889, -0.045070260763168335, 0.013312002643942833, 0.035675108432769775, 0.013854539953172207, -0.0009701154776848853, 0.006040684878826141, 0.03469589725136757, -0.04128573462367058, 0.01917404681444168, -0.04573189094662666, 0.011366809718310833, -0.029058804735541344, -0.010400828905403614, 0.016726015135645866, 0.021304497495293617, 0.011247715912759304, -0.027126844972372055, -0.01898879185318947, -0.009944303892552853, 0.055894531309604645, -0.011267565190792084, -0.005911667365580797, 0.03268453851342201, 0.011148471385240555, -0.006560064852237701, -0.010103095322847366, -0.002244581002742052, 0.059705521911382675, 0.017070062458515167, 0.022813014686107635, -0.001912111765705049, 0.024003949016332626, 0.027365030720829964, 0.04454095661640167, -0.015151334926486015, 0.013841306790709496, -0.02545953541994095, -0.025049325078725815, -0.007330864202231169, -0.032446350902318954, -0.010275118984282017, -0.004886140115559101, -0.019782748073339462, -0.03046146221458912, -0.014066261239349842, -0.01159176416695118, 0.03408719599246979, 0.00217014760710299, -0.025697723031044006, 0.0025224657729268074, -0.004846442490816116, -0.02584328129887581, 0.028926478698849678, -0.008806300349533558, 0.028555965051054955, -0.0164481308311224, -0.11231836676597595, -0.0018376782536506653, 0.03596622496843338, 0.022574827075004578, -0.025962375104427338, 0.016183478757739067, 0.014370610937476158, 0.013748678378760815, -0.004022712353616953, -0.005101169925183058, -0.018340393900871277, -0.023673133924603462, 0.0027011060155928135, -0.05316861346364021, -0.005021774210035801, -0.05332740768790245, 0.002715992508456111, -0.007198538165539503, 0.004462696611881256, 0.012901791371405125, -1.2011433682346251e-05, -0.013470794074237347, -0.01205490529537201, 0.008905544877052307, 0.005296350922435522, -0.02171470783650875, -0.008111587725579739, -0.013106897473335266, -0.0006289623561315238, 0.023514343425631523, 0.020431146025657654, -0.008581345900893211, 0.012842245399951935, 0.0335843563079834, 0.00593151617795229, -0.022958572953939438, -0.0206825640052557, -0.015085171908140182, 0.002401718171313405, -0.0016582111129537225, 0.030011553317308426, -0.05578866973519325, 0.02602853812277317, -0.027126844972372055, -0.001961733913049102, -0.043799929320812225, 0.0005549424677155912, -0.009818593971431255, 0.01093675009906292, -0.0026084776036441326, -0.014357378706336021, 0.019306372851133347, 0.014992543496191502, -0.016765713691711426, 0.014674961566925049, 0.03477529063820839, -0.013113513588905334, 0.02340848185122013, -0.011452821083366871, 0.02133096195757389, -0.02410981059074402, 0.042450204491615295, 0.03927437588572502, 0.0008940279949456453, -0.01081765629351139, -0.013735446147620678, 0.003536414122208953, 0.04072996601462364, -0.024387694895267487, -0.036945439875125885, -0.03996247425675392, -0.019544560462236404, 0.008164518512785435, 0.04186796769499779, -0.006368191912770271, 0.02715330943465233, -0.004879523999989033, 0.02340848185122013, -0.04361467435956001, -0.006007603369653225, 0.016990667209029198, -0.027391497045755386, 0.0005814076866954565, 0.00793294794857502, -0.014158889651298523, 0.011644694022834301, 0.05348619818687439, -0.02834424376487732, -0.027444427832961082, 0.008594578132033348, 0.02371283248066902, -0.011578531004488468, -0.0014928034506738186, 0.017533203586935997, -0.016580456867814064, -0.050575025379657745, -0.017890485003590584, -0.011750554665923119, 0.025710955262184143, 0.009818593971431255, 0.01941223442554474, 0.042873647063970566, -0.005111094564199448, -0.0572177916765213, -0.02741796150803566, -0.01540275476872921, 0.01139989122748375, -0.02818545326590538, 0.01166454330086708, 0.023249691352248192, -0.003069964936003089, -0.0005259961471892893, -0.035410456359386444, 0.0019154198234900832, 0.008945242501795292, 0.03554278239607811, 0.0148469852283597, 0.0033693525474518538, 0.03154653683304787, -0.016699550673365593, -0.005461758468300104, 0.046499382704496384, -0.0031758255790919065, 0.007734458893537521, -0.02040467970073223, -0.01820806786417961, 0.0015333283226937056, 0.003655507694929838, -0.0035827283281832933, -0.012604057788848877, -0.008131437003612518, -0.008263763040304184, 0.009474546648561954, -0.0028698216192424297, 0.011882880702614784, -0.004588406533002853, 0.0016383621841669083, 0.0006868549971841276, -0.028582431375980377, -0.01455586776137352, -0.015932058915495872, -0.0007410260150209069, 0.03824223577976227, 0.04417044296860695, -0.009944303892552853, -0.0002919443941209465, -0.004350219387561083, -0.015204265713691711, -0.014780822210013866, 0.01871090568602085, 0.007264701183885336, -0.02260129339993, 0.0023653286043554544, -0.013391397893428802, 0.009944303892552853, 0.013775143772363663, -0.0061498540453612804, -0.035754505544900894, -0.01176378782838583, 0.03157300129532814, 0.0670628547668457, 0.013735446147620678, 0.00696035148575902, 0.006560064852237701, 0.0024215669836848974, 0.022389570251107216, -0.0335843563079834, 0.009104033932089806, -0.008945242501795292, 0.010347899049520493, -0.023673133924603462, -0.027100378647446632, 0.022574827075004578, 0.019571024924516678, 0.03342556580901146, 0.014674961566925049, 0.007694760803133249, 0.0206825640052557, -0.0003339165705256164, 0.005981138441711664, 0.012531278654932976, 0.057323653250932693, -0.007899866439402103, -0.008409321308135986, 0.011214634403586388, -0.021211868152022362, -0.0014622031012549996, 0.00820421613752842, 0.016421664506196976, 0.03620441257953644, 0.01463526301085949, 0.03162593021988869, -0.011889497749507427, 0.008138053119182587, -0.033293239772319794, 0.0006037377170287073, 0.012147532775998116, 0.019279908388853073, 0.027126844972372055, 0.010619167238473892, -0.034642964601516724, 0.050892606377601624, -0.0512101873755455, -0.018380090594291687, -0.0033395790960639715, 0.01270991936326027, 0.00256547168828547, -0.019531328231096268, -0.027206240221858025, 0.013159827329218388, -0.01509840413928032, -0.020166493952274323, -0.017070062458515167, 0.02760321833193302, -0.012915024533867836, -0.028238384053111076, 0.03866567835211754, 0.041523922234773636, 0.0022545054089277983, -0.008898927830159664, 0.0038473804015666246, -0.02455971948802471, -0.0636223778128624, -0.01259082555770874, -0.012392336502671242, -0.00018060441652778536, -0.015071939677000046, -0.009937687776982784, -0.0335843563079834, -0.003294919151812792, 0.01963718794286251, 0.03342556580901146, -0.023011503741145134, -0.0057396432384848595, -0.027391497045755386, -0.00848871748894453, -0.014225052669644356, -0.014701426029205322, -0.010222189128398895, 0.005617241840809584, 0.009818593971431255, -0.008541648276150227, -0.0321023054420948, 0.02217784896492958, 0.03522520139813423, -0.034907616674900055, 0.013159827329218388, 0.050151579082012177, -0.0008439922239631414, -0.019848911091685295, -0.003731595119461417, 0.0032585295848548412, 0.0469757542014122, -0.01689803972840309, 0.0015515232225880027, 0.0012546165380626917, 0.04798143357038498, 0.00868059042841196, 0.022191081196069717, 0.018578579649329185, -0.03019680827856064, 0.0025935908779501915, 0.006229249760508537, -0.01697743497788906, 0.0026961436960846186, -0.030382065102458, -0.019703350961208344, 0.005326124373823404, 0.025115488097071648, 0.0040028635412454605, 0.025737419724464417, 0.023209992796182632, -0.00847548432648182, 0.03885093331336975, -0.012021823786199093, -0.02475820854306221, 0.02461264841258526, -0.012795930728316307, -0.009196661412715912, 0.02733856625854969, -0.0008592923986725509, -0.013788376934826374, -0.02487730048596859, -0.035172268748283386, -0.027232704684138298, -0.005865353159606457, -0.02283947914838791, 0.0053558978252112865, 0.037951115518808365, -0.008402705192565918, 0.038374561816453934, 0.039062656462192535, -0.010486841201782227, 0.003549646819010377, 0.02209845371544361, -0.006689082831144333, 0.00912388227880001, 0.02598883956670761, -0.022654222324490547, -0.008733520284295082, 0.02622702717781067, 0.02495669759809971, 0.011783636175096035, -0.05748244374990463, 0.029164666309952736, 0.0318111889064312, 0.04377346485853195, -0.018221300095319748, -0.016805410385131836, -0.026544610038399696, 0.013761911541223526, 0.024347996339201927, 0.011287413537502289, 0.016461363062262535, 0.03638966754078865, 0.005455142352730036, -0.003048461861908436, -0.008673974312841892, 0.0146484961733222, -0.007006665226072073, 0.010321433655917645, -0.009269441477954388, -0.003711746307089925, 0.02379222773015499, -0.003817607183009386, -0.008065273985266685, 0.023011503741145134, -0.0165936890989542, -0.015389521606266499, -0.0076418304815888405, 0.003056732239201665, 0.023196760565042496, 0.027087146416306496, -0.0296939704567194, -0.019266676157712936, 0.001529193134047091, -0.04054470732808113, 0.011525601148605347, -0.014211819507181644, -0.00644097151234746, 0.015045474283397198, 0.013186292722821236, 0.0013985211262479424, 0.007575667463243008, -0.014251518063247204, 0.024189205840229988, 0.01701713353395462, -0.01856534741818905, -0.00019538770720828325, -0.023117365315556526, 0.0755317211151123, -0.0076682958751916885, -0.03445770964026451, 0.009501012042164803, -0.0019104576203972101, -0.019187280908226967, 0.0021718016359955072, -0.018036043271422386, -0.031361278146505356, 0.004373376723378897, -0.00630533741787076, 0.01602468639612198, 0.013378165662288666, 0.015071939677000046, 0.020153259858489037, -0.03620441257953644, -6.926442438270897e-05, -0.01165131013840437, 0.012326173484325409, 0.021608848124742508, 0.020616400986909866, 0.03165239468216896, 0.009831827133893967, 0.0012223620433360338, -0.03366375342011452, -0.015376289375126362, 0.0169377364218235, 0.015535080805420876, 0.03530459478497505, 0.02395101822912693, 0.018975557759404182, 0.030064482241868973, -0.05044269934296608, 0.03316091373562813, -0.014741124585270882, -0.021238334476947784, 0.005613933317363262, 0.04282071441411972, -0.027126844972372055, -0.023157062008976936, -0.004065718501806259, 0.019306372851133347, -0.0015854317462071776, 0.023673133924603462, 0.001650767750106752, -0.0005441909888759255, 0.0010834196582436562, 0.014516170136630535, -0.02725917100906372, 0.00102800817694515, 0.023805459961295128, -0.0009304176783189178, 0.02040467970073223, -0.010394212789833546, 0.01871090568602085, -0.030937835574150085, -0.02114570513367653, 0.007926331833004951, 0.010156026110053062, -0.007893250323832035, -0.023739296942949295, 0.011691008694469929, -0.03893033042550087, -0.05105139687657356, 0.01193581148982048, -0.03366375342011452, 0.035410456359386444, 0.020695798099040985, -0.0011553720105439425, 0.05054855719208717, 0.010017083957791328, 0.013159827329218388, -0.00526657747104764, 0.005144176073372364, 0.007304399274289608, 0.0009850021451711655, -0.0160511527210474, 0.0067949434742331505, 0.025274278596043587, 0.06415168195962906, -0.01276284921914339, -0.004244358744472265, -0.001991507364436984, -0.006523675285279751, -0.010500073432922363, 0.015918826684355736, 0.0043998416513204575, -0.003146052360534668, 0.006867723073810339, 0.003728287061676383, -0.02371283248066902, -0.011949043720960617, -0.0008915468933992088, 0.011022761464118958, 0.03022327460348606, -0.007476422935724258, 0.0148469852283597, -0.018075741827487946, -0.008793067187070847, -0.0006992605631239712, -0.002641559112817049, -0.004211277235299349, 0.009553941898047924, 0.020166493952274323, -0.02356727235019207, -0.0009006443433463573, -0.05922915041446686, -0.012220312841236591, 0.019610723480582237, -0.012068137526512146, -0.015191032551229, -0.007694760803133249, 0.006828024983406067, 0.0025026167277246714, -0.01771846041083336, 0.015958523377776146, -0.024969929829239845, 0.023421714082360268, -0.0029459090437740088, -0.030487926676869392, 0.03924791142344475, 0.018221300095319748, -0.024969929829239845, 0.022654222324490547, -0.0008183540194295347, -0.013503875583410263, -0.0008026403374969959, 0.014450007118284702, 0.03234049305319786, -0.030011553317308426, -0.022588059306144714, -0.01018249150365591, -0.01648782752454281, 0.007906482554972172, 0.007264701183885336, 0.020087096840143204, 0.004628104157745838, -0.0268357265740633, -0.019240209832787514, -0.0024579567834734917, 0.0013960400829091668, -0.0024381077382713556, -0.0192534439265728, 0.004522243514657021, 0.008462252095341682, 0.02691512182354927, -0.007119142450392246, 0.0017103144200518727, 0.012888559140264988, 0.02810605801641941, -0.012868709862232208, 0.01949162967503071, -5.494633296621032e-05, 0.0009378610411658883, -0.018036043271422386, -0.030434995889663696, 0.0009395150700584054, -0.008786451071500778, -0.00895185861736536, -0.016355501487851143, 0.024546485394239426, -0.022693920880556107, -0.011386658065021038, 0.03631027415394783, 0.04901357740163803, 0.008535031229257584, -0.046261195093393326, 0.017043597996234894, 0.027814939618110657, 0.003648891346529126, -0.014198587276041508, -0.01983567699790001, 0.012683453969657421, -0.003079889342188835, -0.03866567835211754, -0.02945578284561634, -0.016606921330094337, 0.020629635080695152, -0.006457512266933918, 0.038877397775650024, 0.01259082555770874, -0.02040467970073223, 0.02264099009335041, -0.010983063839375973, 0.004889448173344135, -0.01185641624033451, 0.029561644420027733, -0.0009072606335394084, -0.020166493952274323, 0.01863151043653488, 0.04427630454301834, 0.0031890582758933306, 0.009666419588029385, -0.011174936778843403, 0.012134300544857979, 0.019623955711722374, 0.012061521410942078, -0.025075789541006088, 0.015032241120934486, -0.00012250499275978655, -0.0026101316325366497, -0.01898879185318947, 0.003926776349544525, -0.006335110403597355, 0.021158939227461815, 0.003817607183009386, -0.012696686200797558, -0.021211868152022362, 0.00912388227880001, 0.04755799099802971, 0.031096626073122025, -0.009831827133893967, 0.011227866634726524, 0.01269007008522749, 0.01882999949157238, -0.011783636175096035, 0.019002024084329605, -0.017136225476861, 0.00595798110589385, -0.023170294240117073, 0.013027501292526722, 0.026968052610754967, 0.020192958414554596, -0.005723102483898401, -0.044143978506326675, 0.010639015585184097, 0.022971805185079575, -0.006427738815546036, -0.023805459961295128, 0.011294029653072357, 0.01863151043653488, -0.009904606267809868, -0.0076815285719931126, -0.011684391647577286, 0.02248219959437847, 0.008495333604514599, -0.00577603280544281, 0.008382856845855713, 0.009461314417421818, -0.015892360359430313, -0.047954969108104706, 0.0014655112754553556, 0.024242136627435684, -0.0014977656537666917, 0.01118816900998354, 0.038798004388809204, -0.0008038808591663837, -0.022998271510004997, -0.03260514512658119, 0.009891374036669731, -0.011697624810039997, 0.024546485394239426, -0.0023620203137397766, -0.059440869837999344, 0.011346960440278053, -0.03451063856482506, -0.018274230882525444, -0.012518046423792839, 0.01586589589715004, 0.019081419333815575, -0.007284549996256828, -0.014952845871448517, -0.0037679849192500114, -0.013907469809055328, 0.008793067187070847, -0.011234483681619167, -0.015508615411818027, 0.014370610937476158, -0.018657976761460304, -0.02687542513012886, -0.03265807405114174, 0.014701426029205322, -0.019584259018301964, -3.5045733966398984e-05, 0.03683957830071449, 0.021476522088050842, -0.006900804582983255, -0.047266870737075806, -0.027814939618110657, 0.013973632827401161, 0.056317973881959915, -0.029985086992383003, -0.017003899440169334, 0.02340848185122013, 0.019147582352161407, 0.010890435427427292, -0.015455684624612331, 0.001201686100102961, 0.00943484902381897, 0.023355551064014435, 0.03353142738342285, 0.009944303892552853, -0.004472621250897646, -0.024056879803538322, 0.006222633644938469, 0.010003850795328617, 0.01093675009906292, -0.04340295121073723, -0.023196760565042496, 0.019081419333815575, -0.023752529174089432, -0.013576654717326164, -0.007714610081166029, -0.0009634991874918342, 0.020272353664040565, 0.0067949434742331505, -0.01879030279815197, 0.03183765336871147, 0.016236409544944763, -0.001319952541962266, 0.04239727184176445, -0.008323309943079948, 0.00265644583851099, -0.011598380282521248, 0.005180565640330315, -0.009580407291650772, 0.010771342553198338, -0.016077617183327675, -0.026743099093437195, 0.049542881548404694, -0.020709030330181122, 0.03654846176505089, -0.011254332028329372, -0.0367337167263031, 0.04043884575366974, -0.011849799193441868, 0.0013340121367946267, -0.004628104157745838, 0.032022908329963684, -0.02260129339993, 0.000621105486061424, -0.026676936075091362, 0.03641613572835922, -0.004211277235299349, -0.007350713014602661, 0.018009578809142113, 0.013278921134769917, -0.01269007008522749, 0.02052377350628376, -0.013563422486186028, -0.009520860388875008, -0.011075692251324654, -0.024969929829239845, -0.030911369249224663, -0.012504813261330128, 0.024228902533650398, -0.013854539953172207, -0.0043998416513204575, -0.022349873557686806, -0.0060572256334125996, 0.029932156205177307, 0.009871524758636951, -0.017612600699067116, 0.010202339850366116, -0.0024397619999945164, -0.02056347206234932, 0.004829901736229658, -0.021502986550331116, -0.024400927126407623, -0.02082812413573265, -0.0076550631783902645, -0.02175440639257431, 0.020616400986909866, 0.02610793337225914, 0.02953517809510231, 0.002580358413979411, -0.029561644420027733, 0.0011537178652361035, 0.00708606094121933, -0.014211819507181644, -0.006775094661861658, 0.0318111889064312, -0.0013679207768291235, -0.006229249760508537, 0.0015796424122527242, -0.019107883796095848, -0.016606921330094337, -0.03384900838136673, 0.01548215001821518, 0.00628548813983798, 0.016474595293402672, -0.043879326432943344, 0.01709652878344059, -0.017242087051272392, 0.04297950863838196, -0.007284549996256828, 0.001730163348838687, 0.018234532326459885, -0.021357428282499313]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" and use rjto represent rj(sj). We use P1to represent the probability distribution obtained in line 13 and Pjto
present the updated probability before the j-th speculation. We have P1(v) =P(v)asP1(v)is never updated. We define
QG(v)is the probability of xi+1=vsampled by algorithm 4 when we have Gspeculations. Then we should have:
QG(v) =a1+r1a2+r1r2a3+...+aGG−1Q
k=1rk+a′
G+1GQ
k=1rk
We use induction to prove QG(v) =P(v)for any G≥1, anyv∈V, and any sj∈Vwith1≤j≤G:
1) When G= 1, we have QG(v) =a1+r1a′
2. The initial guess s1can be either the same at vor be different from v.
(1)When s1=v,a1equals P1(v)at line 17, which is the same as P(v)as it is never updated. Upon this, we have
r1= 1−a1= 1− P 1(v) = 1−P(v). And, a′
2is the updated probability P2(v)at line 42. Since P2(v)is set to
zero once rejected at line 32, a′
2= 0. In this case, QG(v) =P(v) + (1 −P(v))∗0 =P(v).
(2)When s1̸=v,a1should be 0even if siis accepted. Moreover, we have r1= 1− P 1(s1). Then P2(v)is updated to
P1(v)
1−P1(s1)at lines 32 and 33. Then a′
2=P2(v). In this case, QG(v) = 0 + r1∗P(v)
r1=P(v).
2)When G=gholds, which means Qg(v) =a1+r1a2+...+agg−1Q
k=1rk+a′
g+1gQ
k=1rk=P(v)for any sj, v∈V,
1≤j≤g.
We prove Qg+1(v) =Qg(v)−a′
g+1gQ
k=1rk+ag+1gQ
k=1rk+a′
g+2g+1Q
k=1rk=P(v)for the same sj, v∈V,1≤j≤g,
and any sg+1∈V.
(1)When sg̸=v, we have ag= 0. IfPg(v) = 0 , we have all a′
g+1= 0,ag+1= 0 anda′
g+2= 0. It ensures that
Qg+1(v) =Qg(v)−0 + 0 + 0 = Qg(v) =P(v).
IfPg(v)̸= 0,Pg+1(v) =Pg(v)
rg=P1(v)
gQ
k=1rksince sg̸=vby observation.
Then we have Qg+1(v) =Qg(v)− Pg+1(v)gQ
k=1rk+ag+1(v)gQ
k=1rk+a′
g+2g+1Q
k=1rk=Qg(v)−P1(v)
gQ
k=1rkgQ
k=1rk+
ag+1gQ
k=1rk+a′
g+2g+1Q
k=1rk=Qg(v)−P(v) +ag+1(v)gQ
k=1rk+a′
g+2g+1Q
k=1rk. Here we have another two cases:
➀Ifsg+1=v,ag+1gQ
k=1rk=P1(vi=v)
gQ
k=1rkgQ
k=1rk=P(v)anda′
g+2=Pg+2(v) = 0 . We have Qg+1(v) =
Qg(v)−P(v) +P(v) + 0 = Qg(v) =P(v).
14
Lookahead decoding
➁Ifsg+1̸=v,ag+1= 0.a′
g+2g+1Q
","[0.027110539376735687, -0.021545078605413437, 0.02768676169216633, 0.019338570535182953, -0.04247177392244339, -0.024046724662184715, 0.004514909815043211, -0.004606261849403381, 0.015150420367717743, 0.0005384513060562313, 0.059308696538209915, 0.012002280913293362, -0.058296795934438705, 0.022599143907427788, -0.008074133656919003, -0.05256268382072449, -0.0288954209536314, -0.015572045929729939, -0.0020255607087165117, 0.022402383387088776, -0.0323527529835701, -0.008889277465641499, 0.03474196791648865, 0.02656242623925209, -0.01898721605539322, -0.0679098591208458, 0.026646750047802925, 0.03578197583556175, 0.03384249657392502, -0.045844778418540955, -0.004314637277275324, -0.022781847044825554, 0.00750493910163641, -0.03193112835288048, -0.0015740696107968688, 0.04235933721065521, -0.0064684427343308926, 0.02698405086994171, -0.021812107414007187, 0.03696252778172493, 0.025887824594974518, -0.03086300939321518, -0.060320597141981125, 0.010062802582979202, 0.05722867697477341, 0.024215376004576683, -0.0172304417937994, -0.0482621006667614, -0.021559132263064384, 0.02009749598801136, -0.023793749511241913, -0.0036997664719820023, -0.00450788252055645, 0.027714869007468224, -0.0007286220788955688, -0.04221879690885544, 0.008797924965620041, 0.012775261886417866, 0.05126969888806343, -0.022205624729394913, 0.022416438907384872, -0.01818612590432167, 0.030413273721933365, 0.0032096265349537134, -0.002159075578674674, 0.0015327854780480266, -0.03165004402399063, 0.048430752009153366, 0.01872018538415432, 0.0259721502661705, -0.061051417142152786, 0.016626110300421715, 0.04725020006299019, -0.00430761044844985, -0.05582325533032417, 0.03581008315086365, 0.03313978761434555, 0.02646404691040516, 0.04649127274751663, -0.023779695853590965, 0.050932396203279495, -0.023301852867007256, 0.04368043318390846, -0.013681757263839245, 0.02736351452767849, -0.06077033281326294, -0.002159075578674674, -0.004265447612851858, -0.052675116807222366, -0.02231805957853794, -0.04646316170692444, 0.018481263890862465, -0.018790457397699356, 0.021994812414050102, 0.03156571835279465, 0.0010856864973902702, 0.03786199539899826, 0.007441695313900709, 0.03482628986239433, -0.03701874613761902, 0.04646316170692444, -0.03207166865468025, 0.04587288573384285, -0.0020905612036585808, 0.036569010466337204, -0.0059097884222865105, -0.056076232343912125, 0.053743235766887665, -0.06234440207481384, -0.0028863800689578056, -0.0188326183706522, -0.041010137647390366, -0.039801474660634995, 0.06065789982676506, -0.01486933697015047, 0.023358069360256195, -0.07032718509435654, -0.04365232586860657, 0.037299830466508865, 0.009711448103189468, -0.0286424458026886, -0.028347307816147804, 0.011594709940254688, -0.055120546370744705, 0.0036857121158391237, -0.005178970284759998, 0.02778514102101326, -0.08837276697158813, 0.008762789890170097, 0.017623959109187126, 0.0038719302974641323, 0.006514118518680334, -0.0006399049889296293, -0.012023362331092358, 0.001124335452914238, -0.014785011298954487, 0.002213535364717245, 0.045310720801353455, 0.013196887448430061, 0.018959106877446175, -0.014841227792203426, -0.020645610988140106, -0.08291973918676376, 0.008945493958890438, 0.009880097582936287, 0.027967844158411026, -0.041122570633888245, -0.010111992247402668, -0.005980059504508972, -0.012128768488764763, -0.023681316524744034, -0.009971450082957745, -0.05419297143816948, -0.0016610299935564399, 0.04056040197610855, -0.0023224554024636745, -0.0408414863049984, 0.04120689630508423, 0.0062646567821502686, 0.01585312932729721, -0.02656242623925209, 0.03468574956059456, 0.017694229260087013, -0.02583160810172558, 0.0018446128815412521, 0.002594755496829748, -0.044523686170578, -0.026168908923864365, -0.04120689630508423, -0.02375158667564392, 0.0015187312383204699, -0.006914663128554821, -0.024805651977658272, -0.036400359123945236, 0.011988227255642414, 0.010547672398388386, -0.027911627665162086, -0.04528260976076126, 0.03277437761425972, -0.06779742985963821, -0.002643945161253214, 0.03434844687581062, 0.053630802780389786, -0.03462953120470047, 0.012030389159917831, 0.015684479847550392, 0.01606394350528717, -0.00458869431167841, -0.0007233517826534808, -0.0077368333004415035, 0.021306157112121582, 0.02258508838713169, 0.024622946977615356, 0.006914663128554821, -0.027560273185372353, -0.062288183718919754, 0.048121556639671326, 0.06341251730918884, 0.04216257855296135, 0.014405548572540283, 0.0188326183706522, 0.017370983958244324, 0.020673718303442, -0.01929640769958496, -0.003536386415362358, -0.011601736769080162, 0.025634849444031715, 0.016077997162938118, -0.0196196548640728, -0.024889975786209106, 0.017581796273589134, -0.03895822539925575, 0.010624970309436321, 0.03811497241258621, -0.005185997579246759, 0.03918309137225151, -0.03887389972805977, 0.05483946204185486, -0.03252140432596207, 0.055008113384246826, -0.013295266777276993, 0.0312846340239048, -0.013000128790736198, 0.04390529915690422, 0.007090340368449688, 0.04415827617049217, 0.07347532361745834, -0.027742978185415268, 0.017469363287091255, -0.032155994325876236, 0.024215376004576683, 0.022346166893839836, -0.008088188245892525, -0.06566119194030762, 0.034601423889398575, 0.005864112172275782, -0.0020238037686794996, 0.0014010274317115545, -0.034067366272211075, -0.006183844991028309, -0.025269439443945885, 0.04025121033191681, 0.03437655791640282, 0.000415477086789906, 0.02285211905837059, -0.0033273303415626287, -0.014574198983609676, -0.012156877666711807, 0.012627692893147469, 0.03159382566809654, -0.01174930576235056, -0.03462953120470047, -0.007441695313900709, 0.002605296205729246, -0.060320597141981125, 0.004925994668155909, -0.01999911665916443, 0.0022258327808231115, -0.0185515359044075, -0.022767793387174606, -0.003794632153585553, -0.04829020798206329, -0.037187397480010986, 0.02512889727950096, -0.015290962532162666, -0.0012314986670389771, 0.013309321366250515, -0.0014835958136245608, 0.011447140946984291, -0.004725722596049309, -0.0288954209536314, 0.01410338282585144, -0.018284505233168602, 0.06425577402114868, -0.03398304060101509, -0.011988227255642414, -0.004005445167422295, 0.030047865584492683, -0.05391188710927963, 0.03001975640654564, -0.021137507632374763, -0.023400232195854187, 0.01770828291773796, 0.06374981999397278, 0.06571740657091141, -0.013590404763817787, -0.006324387155473232, 0.01692124828696251, -0.017989367246627808, -0.024482404813170433, 0.0349949412047863, -0.02990732342004776, 0.038789574056863785, 0.00885414145886898, 0.031621936708688736, 0.0011269706301391125, 0.01999911665916443, -0.034236013889312744, -0.008551976643502712, 0.01755368709564209, 0.04969562962651253, -0.01680881530046463, 0.006194385699927807, 0.03780578076839447, -0.03971714898943901, -0.0026369180995970964, 0.024637000635266304, 0.0029197586700320244, -0.04300583153963089, 0.02789757400751114, 0.04497341811656952, 0.023133201524615288, -0.0440177321434021, -0.00604681670665741, -0.009191442281007767, -0.04443936049938202, 0.05953356251120567, -0.03510737419128418, -0.016092050820589066, -0.00470815459266305, 0.002390969544649124, -0.0026632696390151978, 0.018973160535097122, 0.006672228220850229, -0.013077426701784134, -0.013716892339289188, -0.03350519761443138, -0.05388377606868744, 0.016092050820589066, 0.02535376511514187, 0.003931660670787096, 0.03398304060101509, 0.0008024066337384284, 0.007301153615117073, -0.05020157992839813, -0.010519564151763916, -0.016836924478411674, 0.029822997748851776, -3.189643030054867e-05, -0.03482628986239433, -0.08415651321411133, 0.01718827895820141, 0.022866172716021538, -0.05706002563238144, -0.013267158530652523, -0.00011594709212658927, 0.008566031232476234, 0.011166056618094444, 0.05964599549770355, 0.05638542398810387, 0.012494177557528019, 0.009767664596438408, 0.04803723469376564, 0.013997976668179035, 0.02862839214503765, -0.039576608687639236, 0.02656242623925209, -0.009613067843019962, -0.05587947368621826, 0.012234175577759743, -0.040757160633802414, 0.011622818186879158, 0.013484998606145382, 0.0021661026403307915, -0.012922830879688263, 0.036569010466337204, -0.03611927852034569, -0.02285211905837059, 0.02444024197757244, 0.010083884000778198, -0.029935432597994804, 0.06858446449041367, -0.021179668605327606, -0.015881238505244255, -0.034011147916316986, -0.05818435922265053, -0.02332996018230915, 0.023793749511241913, 0.04353989288210869, 0.05295620113611221, -0.03642847016453743, 0.003392330836504698, 0.0020554258953779936, -0.003430980024859309, 0.022402383387088776, -0.002076507080346346, -0.0001559137017466128, -0.024524567648768425, -0.009324957616627216, -0.02900785580277443, -0.011137948371469975, -0.015319070778787136, -0.01315472461283207, 0.023554828017950058, -0.019436949864029884, 0.00639114435762167, -0.0031639502849429846, 0.05011725425720215, 0.019479112699627876, 0.025634849444031715, -0.020954802632331848, -0.03344897925853729, -0.06886554509401321, -0.031846802681684494, -0.03738415613770485, 0.02799595333635807, -0.028347307816147804, 0.04682857170701027, 0.03336465358734131, 0.024538621306419373, -0.0010057531762868166, 0.008896304294466972, 0.049920495599508286, -0.05700380727648735, 0.007919537834823132, -0.016049887984991074, 0.016162322834134102, 0.01872018538415432, 0.05377134308218956, 0.06009573116898537, 0.004718695301562548, -0.03150949999690056, 0.011812550015747547, 0.006401685066521168, -0.034713856875896454, -0.014939608052372932, 0.007441695313900709, -0.0013263644650578499, 0.06330008804798126, -0.06864067912101746, -0.016836924478411674, 0.02396239899098873, -0.003966796211898327, -0.0071957469917833805, -0.005045455414801836, 0.0115314656868577, 0.05171943083405495, -0.031256526708602905, 0.00306908437050879, -0.032633837312459946, -0.010765512473881245, 0.0032359780743718147, 0.0035820624325424433, 0.044298816472291946, -0.0334208719432354, 0.017244495451450348, -0.028670554980635643, -0.06740391254425049, 0.02051912248134613, -0.017511524260044098, -0.04528260976076126, 0.006117087788879871, 0.04921778663992882, -0.01680881530046463, -0.013435808941721916, -0.03853659704327583, 0.08342569321393967, 0.003090165788307786, -0.013653649017214775, -0.04266853258013725, -0.002176643116399646, -0.01654178649187088, -0.01492555346339941, 0.002527998061850667, 0.013239050284028053, 0.0006825067684985697, 0.012620666064321995, -0.01600772701203823, -0.010379021987318993, 0.012107688002288342, -0.02788352034986019, -0.049808062613010406, 0.03344897925853729, -0.014574198983609676, 0.005881679710000753, 0.024693217128515244, 0.02831920050084591, -0.03564143553376198, 0.00639114435762167, -0.0007931835134513676, 0.006942771375179291, -0.023779695853590965, 0.02206508442759514, 0.019127756357192993, 0.008755762130022049, 0.06909041851758957, 0.04989238828420639, -0.01834072172641754, 0.015150420367717743, -0.06909041851758957, -0.03769334778189659, -0.016204485669732094, 0.015768805518746376, -0.016626110300421715, 0.006805743090808392, 0.03325222060084343, 0.05391188710927963, -0.022093191742897034, -0.011067677289247513, 0.01304229162633419, 0.05587947368621826, 0.04646316170692444, 0.007687643636018038, 0.022205624729394913, -0.003966796211898327, 0.012733099050819874, 0.004648424685001373, -0.006348981987684965, -0.00018160653416998684, 0.03193112835288048, -0.027265135198831558, -0.019380733370780945, -0.027504056692123413, -0.03201545402407646, -0.001434406149201095, -0.015557992272078991, -0.023582937195897102, -0.003959768917411566, 0.0004442442732397467, -0.01602178066968918, -0.006858446169644594, -0.020322363823652267, -0.015782859176397324, 0.014883390627801418, 0.021488862112164497, -0.014243924990296364, 0.009346039034426212, -0.07555534690618515, -0.004448152147233486, -0.06543632596731186, 0.012121741659939289, -0.013562296517193317, -0.008973602205514908, 0.026323504745960236, -0.017103953287005424, -0.011566600762307644, -0.019872630015015602, -0.015557992272078991, 0.023034822195768356, -0.020701827481389046, -0.014644469134509563, -0.025466198101639748, 0.015867184847593307, -0.006394657772034407, -0.00705169141292572, -0.011967145837843418, 0.02900785580277443, -0.007596291601657867, -0.03075057454407215, 0.02788352034986019, 0.026576479896903038, -0.003018137998878956, 0.0057060024701058865, -0.01397689525038004, -0.033477090299129486, 0.013477971777319908, -0.019226135686039925, 0.0201537124812603, -0.01717422343790531, -0.01052659098058939, 0.032324645668268204, 0.006029249168932438, -0.024524567648768425, 0.00016129383584484458, 0.003430980024859309, 0.041122570633888245, -0.014096355997025967, -0.014328249730169773, 0.03800253942608833, 0.011946064420044422, -0.01084281038492918, 0.029260830953717232, -0.007540074642747641, 0.01068118680268526, 0.009381174109876156, -0.04168473929166794, 0.01543150469660759, -0.009212523698806763, -0.0037067935336381197, -0.009627122431993484, -0.022304004058241844, -0.018200179561972618, -0.025803498923778534, -0.02295049838721752, -0.0026790807023644447, 0.00927576795220375, -0.0029513805638998747, 0.008783871307969093, -0.002719486365094781, -0.0119320098310709, 0.00917036086320877, -0.016260702162981033, -0.02853001281619072, 0.02556457743048668, -0.04637883976101875, -0.0016759625868871808, -0.03811497241258621, 0.023034822195768356, -0.03859281539916992, 0.023625100031495094, 0.028445687144994736, 0.016893140971660614, -0.006517632398754358, -0.003575035370886326, -0.05638542398810387, -0.003483683103695512, -0.04157230257987976, -0.008467651903629303, 0.02937326394021511, -0.02577539160847664, 0.024299699813127518, 0.009324957616627216, -0.030722467228770256, -0.008341163396835327, -0.04730641469359398, -0.008439542725682259, -0.003931660670787096, -0.013484998606145382, 0.04210636392235756, -0.013492025434970856, 0.011798495426774025, -0.012255256995558739, 0.0493302196264267, -0.01713206246495247, 0.03457331657409668, 0.018678022548556328, 0.009795772843062878, -0.0035873327869921923, 0.03378628194332123, -0.01423689816147089, 0.007518993690609932, -0.03142517805099487, -0.013175806030631065, -0.002867055358365178, -0.014257979579269886, -0.025142952799797058, -0.011798495426774025, -0.014813119545578957, 0.03800253942608833, -0.04730641469359398, 0.021980758756399155, 0.01690719462931156, 0.000845886766910553, -0.02407483384013176, 0.05334971845149994, -0.0005599717842414975, 0.007701697759330273, 0.03257761895656586, -0.007975754328072071, -0.015023932792246342, -0.034601423889398575, -0.013119589537382126, 0.043343134224414825, -0.021516969427466393, 0.03808686509728432, -0.03201545402407646, -0.004999779164791107, -0.012634719721972942, 0.014546089805662632, -0.010884973220527172, -0.02768676169216633, -0.01814396306872368, 0.006956825964152813, -0.0037911187391728163, -0.0026211070362478495, 0.030638141557574272, 0.026168908923864365, 0.029092179611325264, 0.015473666600883007, 0.01680881530046463, -0.034601423889398575, 0.020125605165958405, 0.024791596457362175, -0.0035838193725794554, -0.0018604238284751773, -0.002563133602961898, -0.02789757400751114, -0.04798101633787155, 0.01288769580423832, 0.010877945460379124, -0.009880097582936287, 0.005639245267957449, -0.031790584325790405, -0.017216386273503304, -0.025958094745874405, -0.018326668068766594, 0.010505509562790394, -0.030075974762439728, -0.012051470577716827, -0.02300671488046646, -0.040532294660806656, 0.01904343254864216, 0.0482339933514595, -0.024777542799711227, 0.0064508747309446335, -0.022191571071743965, -0.01394878700375557, -0.019057486206293106, -0.024693217128515244, -0.03685009479522705, -0.016162322834134102, 0.01115902978926897, 0.03420790657401085, -0.04314637556672096, -0.03328033164143562, -0.006524659227579832, -0.014644469134509563, 0.048599399626255035, 0.014841227792203426, -0.04337124153971672, 0.014194735325872898, -0.0017743419157341123, -0.0036400360986590385, 0.012395798228681087, -0.00750493910163641, 0.03038516640663147, -0.019324515014886856, -0.026702968403697014, 0.025157006457448006, -0.0167104359716177, 0.00544951343908906, 0.022388329729437828, -0.06234440207481384, -0.02583160810172558, -0.004845183342695236, -0.05138213187456131, -0.04323069751262665, 0.0028424605261534452, -0.03558521717786789, 0.0009952125838026404, 0.012079578824341297, 0.0053476206958293915, 0.0333927646279335, -0.0009750096942298114, 0.021221831440925598, 0.03575386852025986, -0.020772097632288933, 0.015501775778830051, -0.010055775754153728, -0.010357940569519997, 0.005618163850158453, -0.03715928643941879, -0.02948569692671299, 0.022177517414093018, 0.0030427328310906887, 0.030075974762439728, 0.02057533897459507, 0.03280248865485191, -0.02858622930943966, 0.015403395518660545, -0.01956343650817871, 0.013147697784006596, -0.013379592448472977, -0.012979047372937202, 0.020223984494805336, 0.028459740802645683, 0.030075974762439728, -0.02449645847082138, -0.03027273342013359, -0.015052041038870811, 0.023048877716064453, -0.01341472752392292, -0.00850981380790472, 0.009191442281007767, 0.014152572490274906, 0.02009749598801136, 0.0011515654623508453, -0.000850717886351049, 0.05121348053216934, 0.013224995695054531, 0.006194385699927807, 0.03356141224503517, 0.014616360887885094, 0.004265447612851858, 0.03701874613761902, 0.019703978672623634, 0.00269664847292006, -0.02772892266511917, -0.031144091859459877, 0.0071641248650848866, -0.00835521798580885, -0.0033115192782133818, -0.006693309638649225, -0.014461765065789223, -0.026393774896860123, 0.0027511082589626312, 0.005871139466762543, 0.03623171150684357, -0.02137642726302147, -0.03280248865485191, 0.03257761895656586, -0.004465720150619745, -0.03620360046625137, 0.023470502346754074, 0.009086036123335361, 0.020392633974552155, -0.027349460870027542, -0.09939125925302505, 0.019914792850613594, -0.001534542185254395, -0.004525450058281422, 0.008664410561323166, -0.006770607549697161, 0.02562079392373562, -0.007427641190588474, 0.03850848972797394, -0.00405463483184576, -0.005850058048963547, -0.02269752323627472, -0.008636302314698696, -0.013695811852812767, -0.005786814261227846, -0.04427070915699005, 0.003917606547474861, -0.005115726497024298, -0.00037770645576529205, -0.03898633271455765, -0.010147127322852612, -0.02942948043346405, -0.0025543496012687683, 0.012121741659939289, -0.018916944041848183, 0.0011533222859725356, 0.01845315657556057, -0.01839694008231163, 0.016190430149435997, 0.015361233614385128, 0.018748294562101364, -0.008790898136794567, 0.04126311093568802, 0.03600684180855751, -0.014785011298954487, -0.016246648505330086, 7.565108535345644e-05, 0.005614650435745716, 0.03988580033183098, 0.0003019455471076071, 0.018172072246670723, -0.034601423889398575, 0.038789574056863785, -0.0011638628784567118, 0.024004561826586723, -0.015895292162895203, 0.02741973102092743, -0.022416438907384872, 0.012473097071051598, -0.0068268245086073875, 0.007107908371835947, 0.02191048674285412, -0.006106547079980373, -0.017314765602350235, 0.009528743103146553, 0.012964993715286255, -0.0068197972141206264, 0.006552767474204302, -0.016569893807172775, -0.0115314656868577, -0.030525708571076393, 0.03685009479522705, 0.036512795835733414, -0.02470727264881134, -0.0027282703667879105, -0.04120689630508423, 0.007617373019456863, 0.016794761642813683, -0.0010268344776704907, -0.022444546222686768, -0.02868460863828659, -0.02258508838713169, -0.0201537124812603, 0.02084236964583397, -0.011861739680171013, 0.03482628986239433, -0.004142473451793194, 0.0027581355534493923, -0.025958094745874405, -0.0017646796768531203, 0.0064297933131456375, -0.0031639502849429846, -0.009268740192055702, 0.0017602876760065556, -0.010301724076271057, -0.0225429255515337, 0.04418638348579407, -0.031003551557660103, 0.004089770372956991, 0.0038578761741518974, 0.028811097145080566, -0.02698405086994171, -0.008994683623313904, 0.0021151560358703136, -0.004490314982831478, -0.03139706701040268, -0.02566295675933361, -0.015670426189899445, 0.002780973445624113, 0.023878075182437897, 0.0060608708299696445, 0.042921505868434906, 0.03437655791640282, -0.04311826452612877, -0.05953356251120567, -0.017666121944785118, 0.010983352549374104, -0.014489873312413692, 0.037046853452920914, 0.02072993479669094, 0.009289821609854698, 0.021938595920801163, -0.034179799258708954, -0.029401373118162155, 0.014475819654762745, 0.032690055668354034, -0.006015194579958916, 0.026379721239209175, -0.023048877716064453, -0.023105094209313393, 0.013653649017214775, 0.011116866953670979, 0.013021210208535194, 0.019802358001470566, -0.021924542263150215, -0.025634849444031715, -0.010175235569477081, 0.007898456417024136, -0.004065175540745258, 0.007673589512705803, 0.01818612590432167, 0.006338441278785467, 0.0004071324074175209, -0.0021502915769815445, 0.02900785580277443, -0.0055092438124120235, 0.013534188270568848, -0.009008738212287426, -0.005628704559057951, -0.00810926966369152, 0.007336289156228304, 0.015262854285538197, 0.0070235831663012505, 0.021039128303527832, -0.05118537321686745, 0.0002314549928996712, -0.0037173342425376177, 0.0015002851141616702, -0.01055469922721386, 0.012662827968597412, 0.028867313638329506, -0.026534317061305046, 0.03907065838575363, -0.01344283577054739, 0.012346608564257622, 0.018537480384111404, -0.013843380846083164, -0.015712589025497437, 0.02942948043346405, 0.006517632398754358, 0.03760902211070061, 0.04368043318390846, 0.0013966354308649898, -0.012367689982056618, 0.01701962761580944, 0.002436645794659853, -0.008629274554550648, -0.023428339511156082, -0.01357635110616684, 0.017413144931197166, -0.03367384895682335, -0.010631997138261795, -0.0009346038568764925, 0.0408133789896965, 0.020013172179460526, 0.02036452665925026, 0.004697614349424839, 0.00556546077132225, 0.009760637767612934, 0.007364397402852774, 0.008313055150210857, 0.04098202660679817, -0.005470594856888056, 0.009479553438723087, 0.03668144345283508, -0.04342745617032051, 0.009240631945431232, -0.012086606584489346, 0.015923401340842247, 0.011383896693587303, 0.002461240626871586, 0.010133073665201664, 0.01288769580423832, 0.03381438925862312, 0.004845183342695236, 0.044467467814683914, -0.008425489068031311, -0.006475469563156366, 0.01739909127354622, -0.020968856289982796, 0.0007211557822301984, 0.011004433035850525, -0.03001975640654564, -0.01278228871524334, -0.0006421009893529117, 0.015052041038870811, -0.004532477352768183, -0.019816413521766663, -0.018228288739919662, -0.019422896206378937, 0.0053159985691308975, -0.024524567648768425, 0.002780973445624113, 0.018846673890948296, -0.02439807914197445, -0.016162322834134102, 0.010653078556060791, 0.047278307378292084, -0.013934732414782047, -0.02185427024960518, 0.0009811583440750837, -0.030525708571076393, -0.04809344932436943, -0.010695241391658783, -0.024102941155433655, 0.007659535389393568, -0.024412134662270546, -0.009430363774299622, -0.04174095392227173, -0.0006302427500486374, 0.007526020519435406, 0.021390482783317566, -0.026070529595017433, -0.025789445266127586, -0.017370983958244324, 0.007617373019456863, -0.014166627079248428, 0.005751678720116615, 0.004058148246258497, 0.0023681316524744034, 0.016077997162938118, -0.017146116122603416, 0.005319511983543634, 0.007961700670421124, 0.030947333201766014, -0.04157230257987976, 0.030104082077741623, 0.039689041674137115, -0.01441960223019123, -0.030947333201766014, -0.019479112699627876, 0.02327374368906021, 0.029626239091157913, 0.000597742386162281, 0.0018165045185014606, 0.010646051727235317, 0.012473097071051598, -0.0025104302912950516, -0.011180111207067966, 0.002364618005231023, -0.00967631209641695, -0.028094332665205002, 0.03134085237979889, -0.03229653462767601, 0.00016612495528534055, -0.04230312258005142, -0.0016908951802179217, 0.011306598782539368, 0.010442265309393406, -0.021081289276480675, 0.012346608564257622, 0.011025514453649521, 0.008488732390105724, 0.02571917325258255, -0.02025209181010723, -0.019493166357278824, 0.007638453971594572, -0.034123580902814865, 0.017750445753335953, -0.0034116555470973253, -0.035079266875982285, 0.001686503179371357, -0.04862751066684723, -0.005927355960011482, -0.0007035880698822439, -0.016822868958115578, 0.002060696016997099, 0.02216346375644207, 0.04972373694181442, 0.016260702162981033, 0.043989624828100204, 0.009367119520902634, -0.024833759292960167, 0.01659800298511982, 0.001763801323249936, -0.009205496869981289, -0.018172072246670723, 0.03907065838575363, -0.00556546077132225, -0.01341472752392292, 0.023835912346839905, 0.004430584609508514, 0.0016355568077415228, -0.028305144980549812, 0.0461258627474308, 0.04196581989526749, 0.03530413284897804, 0.0055303252302110195, -0.008811979554593563, -0.03909876570105553, 0.015305016189813614, 0.019113702699542046, -0.01278228871524334, 0.018410993739962578, 0.04868372529745102, 0.04820588231086731, 0.010856864042580128, 0.0123255280777812, -0.008559003472328186, 0.0033044922165572643, -0.012163904495537281, 0.005059509538114071, 0.004999779164791107, 0.015417450107634068, -0.02063155546784401, -0.03982958570122719, -0.007420613896101713, 0.005403837189078331, -0.0057235704734921455, 0.009339011274278164, 0.005017347168177366, 0.035023048520088196, 0.03907065838575363, -0.018256397917866707, -0.023878075182437897, 0.02179805375635624, -0.0355290025472641, -0.002450699917972088, -0.0035574676003307104, -0.0031165173277258873, -0.009458472020924091, -0.012297418899834156, 0.01344283577054739, -0.023526718840003014, -0.025367818772792816, -0.004514909815043211, 0.024791596457362175, -0.021348319947719574, -0.022514818236231804, -0.02200886607170105, 0.09427552670240402, -0.0018621806520968676, -0.0078000775538384914, 0.02162940427660942, 0.006731958594173193, -0.01786288060247898, 0.012072551995515823, -0.03038516640663147, -0.0546145960688591, -0.01734287478029728, -0.03305546194314957, 0.0007136894855648279, 0.010920108295977116, 0.02602836675941944, -0.004648424685001373, -0.014145545661449432, -0.010688213631510735, -0.004483287688344717, 0.013766082003712654, 0.008158459328114986, -0.0024700243957340717, -0.008369272574782372, 0.0016504892846569419, 0.02985110692679882, -0.01602178066968918, -0.019844520837068558, 0.012206067331135273, -0.009128198958933353, 0.023133201524615288, 0.01335851103067398, 0.03302735462784767, 0.0288954209536314, -0.018593698740005493, 0.01728665828704834, -0.024833759292960167, -0.002802054863423109, -0.017722338438034058, 0.03760902211070061, -0.0018815051298588514, -0.00986604392528534, -0.0027177296578884125, 0.007596291601657867, -0.005301944445818663, 0.04314637556672096, 0.022767793387174606, 0.004834642633795738, 0.015361233614385128, 0.02497430145740509, -0.02137642726302147, -0.023793749511241913, 0.023835912346839905, -0.0002938204852398485, 0.006886554881930351, -0.021067235618829727, 0.008650355972349644, -0.025466198101639748, -0.025142952799797058, 0.01397689525038004, 0.0049576167948544025, 0.002508673584088683, -0.03676576912403107, -0.0131266163662076, -0.017033683136105537, -0.015782859176397324, 0.00621898053213954, -0.03170625865459442, 0.027827303856611252, 0.019858574494719505, -0.010140100494027138, 0.037721455097198486, -0.017216386273503304, 0.012142823077738285, -0.0024700243957340717, 0.01174930576235056, -0.001211295835673809, 0.03038516640663147, -0.026492154225707054, 0.010892000049352646, 0.008819006383419037, 0.06622336059808731, 0.002253941260278225, -0.011854711920022964, -0.006426279898732901, -0.02571917325258255, -0.013105534948408604, 0.01812990941107273, 0.017890987917780876, 0.008601166307926178, 0.004339232109487057, -0.0025754310190677643, -0.04050418362021446, -0.005948437377810478, 0.008362244814634323, -0.012943912297487259, 0.0073714242316782475, -0.02900785580277443, 0.026702968403697014, -0.02740567736327648, -0.030104082077741623, 0.04755939170718193, -0.02300671488046646, 0.005927355960011482, 0.03032894991338253, 0.007209801115095615, -0.0007923051598481834, 0.03224031999707222, -0.045788563787937164, -0.021390482783317566, 0.009296849370002747, -0.0033044922165572643, 0.00810926966369152, -0.001261363853700459, -0.030947333201766014, -0.006556281354278326, -0.03243707865476608, 0.013871489092707634, -0.008488732390105724, 0.0114049781113863, 0.011018487624824047, -0.025269439443945885, 0.037890106439590454, 0.034545209258794785, -0.044523686170578, -0.008896304294466972, -0.042977724224328995, -0.008783871307969093, -0.025747282430529594, 0.011777414008975029, 0.024777542799711227, -0.017047736793756485, 0.01150335744023323, 0.017947204411029816, 0.0037911187391728163, 0.0029707050416618586, 0.016626110300421715, 0.013351484201848507, -0.006731958594173193, -0.012817424722015858, -0.007687643636018038, -0.003007597289979458, -0.004511395934969187, -0.0015635290183126926, -0.002503403229638934, -0.017047736793756485, 0.011524438858032227, 0.01115902978926897, -0.012683909386396408, -0.0071957469917833805, 0.005583028309047222, 0.0006008167401887476, -0.002390969544649124, 0.0062646567821502686, -0.017118006944656372, 0.01627475582063198, -0.003490710398182273, -0.04443936049938202, 0.039042551070451736, -0.005836003925651312, 0.03044138289988041, -0.022655360400676727, 0.017806662246584892, -0.009929287247359753, 0.0005204443586990237, 0.03336465358734131, 0.0036857121158391237, 0.018003420904278755, 0.004869778174906969, 0.007687643636018038, 0.012487150728702545, -0.010491454973816872, -0.00342570967040956, -0.012972020544111729, 0.02004127949476242, -0.0018024502787739038, -0.014089329168200493, -0.0028811097145080566, -0.011517411097884178, 0.008636302314698696, 0.008341163396835327, 0.05534541234374046, 0.012416879646480083, -0.0312846340239048, 0.023639153689146042, 0.01007685624063015, -0.00016074483573902398, -0.003520575352013111, 0.014187708497047424, 0.00813737791031599, -0.01633097231388092, 0.013632567599415779, 0.03209977596998215, -0.01697746478021145, 0.03451709821820259, -0.024679163470864296, 0.00885414145886898, 0.03195923566818237, 0.007301153615117073, -0.04803723469376564, -0.004989238455891609, 0.031678151339292526, 0.002628134097903967, -0.004068688955157995, 0.0032605729065835476, -0.003364222589880228, 0.021488862112164497, -0.003278140677139163, -0.011116866953670979, -0.024510513991117477, 0.01489744521677494, 0.047952909022569656, 0.018368830904364586, -0.01500987820327282, -0.012550394982099533, 0.015529884025454521, -0.00895954854786396, -0.0012991344556212425, 0.03055381588637829, -0.010273615829646587, 0.025409981608390808, -0.0035030078142881393, -0.00996442325413227, 0.010006586089730263, 0.010962271131575108, -0.006384117528796196, -0.0005898369126953185, 0.02529754862189293, 0.028291091322898865, -0.0008731167763471603, 0.00436382694169879, 0.015726642683148384, 0.011447140946984291, -0.034966833889484406, -0.01543150469660759, -0.021460752934217453, 0.04126311093568802, 0.006774121429771185, 0.005881679710000753, -0.0012622422073036432, -0.028445687144994736, 0.006436820607632399, -0.023301852867007256, 0.012550394982099533, 0.022416438907384872, -0.030047865584492683, 0.011229300871491432, 0.02110939845442772, 0.0025596199557185173, -0.04047607630491257, -0.027068376541137695, 0.0060643842443823814, 0.008769816718995571, 0.05160699784755707, -0.005013833288103342, -0.059308696538209915, -0.0062857381999492645, -0.00869954563677311, -0.0011840658262372017, -0.023161310702562332, 0.01675259880721569, 0.010962271131575108, 0.01115902978926897, 0.0046132891438901424, 0.02380780316889286, -0.011292544193565845, -0.007645481266081333, -0.0029355697333812714, -0.018467210233211517, -0.0031481392215937376, -0.01998506300151348, -0.025325655937194824, -0.01665421947836876, 0.007280072197318077, -0.008418462239205837, -0.006812770385295153, 0.050876181572675705, 0.021727783605456352, 0.006401685066521168, -0.007258990779519081, -0.0026843510568141937, 0.0033571955282241106, 0.03049759939312935, -0.019127756357192993, -0.004247880075126886, 0.016345027834177017, 0.05292809382081032, 0.008938467130064964, -0.04404584318399429, -0.012585530057549477, 0.022739684209227562, 0.03139706701040268, 0.029345156624913216, -0.021516969427466393, -0.0037454424891620874, -0.03139706701040268, 0.009739556349813938, -0.008067106828093529, 0.016668273136019707, -0.04036364331841469, -0.0035153052303940058, 0.027124593034386635, -0.0042022038251161575, 0.00798278208822012, -0.02120777778327465, -0.027616489678621292, 0.03193112835288048, 0.008608193136751652, -0.023779695853590965, 0.0007536561461165547, -0.002022047061473131, -0.003084895433858037, 0.05298430845141411, -0.011011460795998573, 0.015220691449940205, -0.00154069100972265, 0.0012200797209516168, 0.010603888891637325, -0.0077789961360394955, -0.003590846434235573, -0.0196196548640728, 0.03541656583547592, 0.019113702699542046, 0.015052041038870811, 0.009479553438723087, -0.031678151339292526, 0.025578631088137627, -0.015923401340842247, 0.01791909709572792, -0.017146116122603416, 0.01095524337142706, -0.031256526708602905, -0.011967145837843418, -0.004240852780640125, 0.033926822245121, -0.025494307279586792, 0.007392505649477243, 0.008214675821363926, 0.004124905914068222, 0.010224426165223122, 0.02243049256503582, 0.0023171850480139256, -0.0015582586638629436, -0.012964993715286255, -0.022135354578495026, -0.03513548523187637, -0.024243483319878578, 0.014883390627801418, 0.02307698503136635, -0.01872018538415432, -0.00046027483767829835, 0.015150420367717743, -0.02486186847090721, -0.016345027834177017, -0.04373665153980255, 0.005583028309047222, 0.024088887497782707, -0.039267417043447495, -0.003308005863800645, -0.01174930576235056, -0.00747683085501194, -0.004971670918166637, 0.00524924136698246, -0.008685491979122162, 0.0018586671212688088, 0.0033554385881870985, 0.03578197583556175, -0.012662827968597412, -0.02099696546792984, -0.010617943480610847, 0.004121392033994198, -0.026604587212204933, 0.03027273342013359, 0.04868372529745102, 0.016949357464909554, 0.02571917325258255, -0.003928147256374359, -0.005263295490294695, -0.01561420876532793, -0.037777673453092575, 0.026225125417113304, 0.0262532327324152, 0.020673718303442, -0.045254502445459366, 0.035922519862651825, -0.016822868958115578, 0.02466510981321335, -0.010168208740651608, -0.02210724540054798, 0.026506207883358, 0.01081470213830471]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
"k=1rk=Pg+2(v)g+1Q
k=1rk=P1(v)
g+1Q
k=1rkg+1Q
k=1rk=P(v). SoQg+1(v) =Qg(v)−
P(v) + 0 + P(v) =Qg(v) =P(v)
(2)When sg=v,Pg+1(v)is set to zero at line 32 after this step. In this case, we have a′
g+1=Pg+1(v) = 0 ,
ag+1=Pg+1(v) = 0 anda′
g+2= 0. It makes that Qg+1(v) =Qg(v)−0 + 0 + 0 = Qg(v) =P(v)
This part of the proof guarantees that from line 14 to line 44 in Algorithm 4, any new token appended to ocan follow the
original distribution of the LLM. Line 21 to line 28 guarantees that sequences in Vshare the same prefix of length i−1in
every iteration. This further guarantees that PfromD[j]iis the same for all j, follows the wanted distribution. Thus, the
correctness of the whole sampling algorithm is proved.
C. Derivation of Expectation of The Number of Accepted Tokens
We first start with single-candidate speculation. We need to obtain the probability of accepting itokens as
P(#accepted tokens =i)for all possible i. Since the speculation’s length is γ, the probability of accepting ito-
kens with i≥γ+ 2 is 0. P(#accepted tokens = 1) is the probability of the first token being rejected, which is
1−α. The probability P(#accepted tokens =i) =P(#accepted tokens =i−1)∗α, for all i≤γ. The probability
P(#accepted tokens =γ+ 1) is accepting all tokens, which is αγ. Thus we have the following, which is Eq. 4:
E(#tokens ) =γ+1X
i=1i∗P(#accepted tokens =i)
= 1∗(1−α) + 2∗(1−α)∗α+...+ (γ+ 1)∗αγ
= (1 −α) + (2 α−2α2) + (3 α2−3α3) +...+ (γ+ 1)αγ
= 1 + ( −α+ 2α) + (−2α2+ 3α2) + (−3α3+ 4α3) +...+ (γ+ 1)αγ
= 1 + α+α2+α3+...+αγ
=1−αγ+1
1−α(8)
We then investigate the case of speculations with a batch size of b. We need to obtain the probability of accepting itokens as
P(#accepted tokens =i). Since all speculations’ length is γ, the probability of accepting atokens with a≥γ+ 2is 0.
We use pito denote (1−αi)b, which is the probability that at most itokens are accepted in all bspeculations. For all i≤γ,
we should have P(#accepted tokens =i) =pi−pi−1. And, the probability P(#accepted tokens =γ+ 1) should be
(1−pγ). Thus we have the following, which is Eq. 5:
E(#tokens ) =γ+1X
i=1i∗P(#accepted tokens =i)
=γX
i=1i(pi−pi−1) + (γ+ 1)∗(1−pγ)
= (p1−p0) + (2 p2−2p1) + (3 p3−3p2) +...+ (γ+ 1)(1 −pγ)
=−p0+ (p1−2p1) + (2 p2−3p2) + (3 p3−4p3)...+ (γ+ 1)
=−p0−p1−p2−...−pγ+ (γ+ 1)
= (γ+ 1)−γX
i=1(1−αi)b(9)
15
Lookahead decoding
D. Prompt for LLaMA-2-Chat on Summarization Tasks
We use the following as the prompt for summarization task, modified from (Ruan et al., 2023).
➤Prompt:
[INST","[0.0433465912938118, -0.022943850606679916, 0.045178551226854324, 0.006452496163547039, -0.018629875034093857, -0.02527812495827675, -0.0034921779297292233, 0.0362846702337265, -0.0072761401534080505, 0.027065765112638474, 0.045976344496011734, -0.001985241426154971, -0.033654920756816864, 0.022234702482819557, -0.00522626331076026, -0.03188205137848854, 0.008221669122576714, -0.012794188223779202, -0.01601489633321762, 0.037230201065540314, 0.0009732299367897213, -0.005828299093991518, 0.006578074302524328, 0.024894002825021744, 0.000627428584266454, -0.05492931976914406, 0.009964988566935062, -0.0010434059659019113, 0.01945721171796322, -0.04562177136540413, -0.0005997275584377348, -0.040923673659563065, -0.005514353979378939, -0.03270938992500305, -0.006441415753215551, 0.07351487129926682, -0.0018088780343532562, 0.027243051677942276, -0.018304849043488503, -0.028809083625674248, -0.0030231070704758167, -0.04562177136540413, -0.050349414348602295, 0.015423940494656563, 0.03185250610113144, 0.07174200564622879, -0.025647470727562904, -0.04718780145049095, -0.01116906013339758, 0.022234702482819557, -0.040273621678352356, 0.022751789540052414, -0.019309472292661667, -0.017566153779625893, -0.0018153416458517313, -0.05744088068604469, 0.01552735734730959, 0.025750888511538506, 0.043287493288517, -0.04269653931260109, 0.02316545881330967, -0.022293798625469208, 0.005639932118356228, 0.007002823520451784, -0.011294637806713581, -0.014988110400736332, -0.05422017350792885, 0.016206955537199974, 0.035250499844551086, 0.04118960350751877, -0.04042135924100876, -0.00012880984286312014, 0.025603149086236954, -0.002164374804124236, -0.05859324336051941, 0.03377310931682587, 0.00433983001857996, 0.020712992176413536, 0.0020369498524814844, -0.04290337488055229, 0.0433465912938118, -0.0036823919508606195, 0.056229423731565475, -0.03557552397251129, 0.037200652062892914, -0.05342238396406174, -0.008871720172464848, 0.004125608596950769, -0.045917246490716934, -0.04272608831524849, -0.060454752296209335, 0.02099369652569294, -0.02966596931219101, 0.026578227058053017, 0.046862777322530746, 0.00689940620213747, 0.01734454557299614, -0.012099815532565117, 0.028424963355064392, 0.009935440495610237, 0.04003724083304405, -0.05531344190239906, 0.013990872539579868, -0.03409813717007637, 0.01088835671544075, 0.015748966485261917, -0.038146182894706726, 0.01743318885564804, -0.07032371312379837, -0.008930816315114498, -0.029104560613632202, 0.008864333853125572, -0.03994859755039215, 0.048310618847608566, 0.006947421468794346, 0.005558675620704889, -0.04786740243434906, -0.019841333851218224, 0.007519909646362066, 0.0016602157847955823, -0.05658399686217308, -0.04113050550222397, 0.0031671524047851562, -0.030877428129315376, -0.0180389191955328, -0.029931899160146713, 0.03983040526509285, -0.08066543191671371, -0.03244346007704735, -0.006463576573878527, 0.018541229888796806, 0.010688908398151398, 0.030183054506778717, -0.01192991528660059, -0.0090046850964427, -0.021569877862930298, 0.004598373081535101, 0.04136689007282257, -0.014493185095489025, 0.02600204572081566, 0.0019427663646638393, -0.040864575654268265, -0.05232911556959152, 0.01888103038072586, -0.024347368627786636, -0.029444361105561256, -0.07570140808820724, 0.020387966185808182, -0.060632042586803436, -0.006230887491255999, -0.0027497902046889067, -0.023652996867895126, -0.038618944585323334, 0.024820134043693542, 0.0005152393714524806, -0.06317315250635147, -0.05495886877179146, 0.030005767941474915, -0.0027128553483635187, 0.0028218128718435764, -0.006216113921254873, 0.008199508301913738, 0.05135403946042061, -0.04565131664276123, -0.0006195799796842039, 0.02455420419573784, -0.028720440343022346, 0.028469284996390343, -0.07623326778411865, -0.05191544443368912, -0.0001533945178380236, -0.010223531164228916, -0.0253963153809309, -0.04721735045313835, -0.0063379984349012375, -0.02691802568733692, -0.02090505324304104, -0.03164567053318024, 0.024406464770436287, -0.05357012152671814, -0.008583629503846169, 0.04051000252366066, 0.046153631061315536, -0.02688847854733467, -0.0005964957526884973, -0.02671119198203087, 0.030611498281359673, -0.012136749923229218, 0.011361120268702507, -0.023431388661265373, 0.01441931538283825, 0.0361369326710701, 0.07097376137971878, -0.015320522710680962, -0.006094229407608509, -0.07723788917064667, 0.07794703543186188, 0.039446283131837845, 0.05735223740339279, 0.01877761259675026, -0.007139482069760561, 0.05625896900892258, 0.010696295648813248, -0.04157372564077377, 0.03235481679439545, -0.026297522708773613, 0.021451687440276146, -0.013326047919690609, -0.02309158816933632, -0.03270938992500305, 0.04157372564077377, -0.040953218936920166, 0.04500126466155052, 0.015497809275984764, -0.028469284996390343, 0.03832346946001053, -0.05915465205907822, 0.031586576253175735, -0.022101737558841705, 0.029385264962911606, -0.001887364313006401, 0.014116451144218445, 0.02108233980834484, 0.04792649671435356, -0.004805207252502441, 0.046685490757226944, 0.07044190168380737, 0.003952015191316605, 0.003178232815116644, -0.022958623245358467, 0.027745364233851433, 0.011494086124002934, -0.04074638709425926, -0.08409297466278076, 0.006829230114817619, -0.028617022559046745, -0.0013111826265230775, -0.01155318133533001, -0.051885899156332016, 0.0021809954196214676, -0.01154579408466816, 0.008406342938542366, 0.06642340868711472, -0.0010230918414890766, 0.014832984656095505, 0.009662123396992683, -0.016487659886479378, -0.033004868775606155, 0.0363733135163784, 0.010260465554893017, 0.015542130917310715, -0.042371515184640884, -0.03129109740257263, -0.010733230039477348, -0.06654159724712372, 0.00044575592619366944, -0.016088765114545822, -0.022234702482819557, -0.002382289618253708, -0.002422917867079377, 0.0020258694421499968, -0.02242676354944706, -0.04260789602994919, 0.037968896329402924, -0.0019002915360033512, -0.03191160038113594, -0.0013499640626832843, -0.011434989981353283, 0.02533721923828125, -0.02830677106976509, -0.03761432319879532, -0.006511591840535402, -0.005451565142720938, 0.04774921014904976, -0.03560507297515869, -0.039387188851833344, 0.0008993605151772499, 0.026592999696731567, -0.04053955152630806, 0.038057539612054825, -0.038618944585323334, -0.020136810839176178, 0.05442700907588005, 0.024761037901043892, 0.05995244160294533, -0.017093390226364136, 0.022884754464030266, 0.02891250140964985, -0.0038670655339956284, -0.007734131067991257, 0.024258725345134735, -0.04441031068563461, 0.01879238709807396, -0.026607774198055267, 0.019398115575313568, -0.010607652366161346, 0.027981745079159737, 0.004590985830873251, 0.012941926717758179, 0.010799712501466274, 0.052624594420194626, -0.019028769806027412, -0.003734100377187133, -0.005758123472332954, -0.025071289390325546, 0.020550480112433434, 0.005008348263800144, 0.032886676490306854, -0.037318844348192215, -0.0024413850624114275, 0.056170325726270676, 0.0030101798474788666, -0.05578620359301567, 0.03912125900387764, -0.004406312480568886, -0.03327079862356186, 0.045917246490716934, -0.023682544007897377, -0.006312143988907337, -0.014345446601510048, 0.0038633719086647034, -0.010134887881577015, 0.01950153335928917, 0.0029732452239841223, 0.02106756530702114, 0.00839156936854124, -0.003723019966855645, -0.04207603633403778, -0.0008707360830157995, -0.0015272507444024086, 0.009374032728374004, 0.0035272659733891487, 0.020048167556524277, 0.03247300907969475, -0.03554597869515419, -0.023490482941269875, -0.001230849651619792, 0.022101737558841705, 0.013326047919690609, 0.04420347511768341, -0.05877052992582321, 0.006877245381474495, 0.017034294083714485, -0.011146899312734604, -0.009669510647654533, -0.0020129424519836903, 0.032857127487659454, 0.040155429393053055, 0.05599303916096687, 0.039475832134485245, 0.004517116583883762, -0.02687370404601097, 0.03164567053318024, -0.031025167554616928, 0.02103801816701889, -0.02040274068713188, 0.02965119481086731, -0.051767706871032715, -0.0036842385306954384, 0.027331694960594177, -0.028661344200372696, 0.016295598819851875, -0.0033721402287483215, -0.011804337613284588, 0.018511682748794556, -0.011058256030082703, -0.031025167554616928, -0.049019765108823776, -0.0005290898843668401, 0.008325086906552315, -0.016251277178525925, 0.056820377707481384, -0.024332595989108086, -0.023327970877289772, -0.03980085626244545, -0.028631797060370445, -0.02746465988457203, 0.014943788759410381, 0.01379881240427494, 0.019782237708568573, -0.009684284217655659, -0.04048045724630356, -0.00872398167848587, 0.009898506104946136, -0.0056842537596821785, 0.02610546164214611, -0.022205155342817307, -0.016251277178525925, -0.00671103922650218, -0.026592999696731567, -0.003266876330599189, -0.002838433487340808, -0.009898506104946136, 0.024332595989108086, 0.029946673661470413, 0.03232526779174805, -0.015630774199962616, 0.0646505355834961, 0.025219028815627098, 0.05442700907588005, -0.018526457250118256, -0.00361590925604105, -0.01966404728591442, -0.001419216743670404, -0.03711200878024101, 0.030094411224126816, 0.0036380700767040253, 0.03424587473273277, 0.037377938628196716, 0.021318722516298294, 0.010570717975497246, -0.019678819924592972, 0.04751282557845116, -0.06595063954591751, 0.012912378646433353, 0.012210619635879993, 0.00491231819614768, 0.032266173511743546, 0.05439746007323265, 0.03167521953582764, 0.008694433607161045, 0.0011015781201422215, -0.011102577671408653, -0.014264189638197422, -0.04133734107017517, -0.007593778893351555, 0.01876283995807171, -0.010578104294836521, 0.011124738492071629, -0.05132449045777321, -0.040303170680999756, 0.024465560913085938, 0.049669813364744186, -0.03539823740720749, -0.0004704560269601643, -0.02888295240700245, 0.02471671625971794, 0.003665771335363388, -0.012949313968420029, -0.04133734107017517, -0.014205094426870346, -0.0017691731918603182, -0.02604636736214161, 0.001929839258082211, -0.046774134039878845, 0.00791880488395691, -0.04585815221071243, -0.03250255435705185, 0.030847880989313126, -0.0033869140315800905, -0.022677918896079063, -0.052476853132247925, 0.0728057250380516, 0.031468383967876434, -0.02105279266834259, -0.07611507922410965, 0.09478927403688431, 0.004073899704962969, 0.019944749772548676, -0.017669571563601494, 0.023387067019939423, -0.017846858128905296, -0.020786862820386887, -0.0012585506774485111, 0.0015115535352379084, 0.010437753051519394, -0.0011237389408051968, -0.010917903855443, 0.027183955535292625, 0.017196806147694588, -0.007080386392772198, -0.03111381083726883, 0.007652874570339918, 0.010312174446880817, -0.008435891009867191, -0.011420216411352158, 0.03194114938378334, -0.02827722392976284, 0.0012022252194583416, -0.009233680553734303, 0.005813525523990393, 0.00839156936854124, 0.0218505822122097, 0.030729688704013824, 0.02818858064711094, 0.0869295597076416, 0.07410582900047302, -0.005237343721091747, 0.016916103661060333, -0.034541353583335876, 0.006057294551283121, -0.002819966059178114, 0.012040719389915466, -0.018541229888796806, 0.0012724011903628707, 0.010844034142792225, 0.024820134043693542, -0.0039040001574903727, -0.0007072999142110348, 0.008952977135777473, 0.005484806373715401, 0.007176416460424662, 0.007741517852991819, 0.03273893892765045, 0.0031357579864561558, -0.021496009081602097, 0.013953938148915768, -0.040184978395700455, -0.029119335114955902, 0.015364844352006912, -0.030581951141357422, -0.03457089886069298, -0.02622365392744541, -0.016354694962501526, -0.011782176792621613, 0.007039758376777172, -0.03758477419614792, -0.016147861257195473, -0.03858939930796623, 0.005532821640372276, -0.001717464649118483, -0.003708246164023876, -0.00800744816660881, -0.004036965314298868, 0.005048976745456457, -0.030995618551969528, -0.01877761259675026, -0.0651233047246933, -0.006330611649900675, -0.03418678045272827, 0.032236624509096146, -0.010016696527600288, -0.007191190496087074, 0.027376016601920128, -0.01303795725107193, 0.00742757273837924, 0.016266051679849625, 0.0010323255555704236, 0.013968711718916893, -0.03335944190621376, 0.0009630728745833039, -0.006463576573878527, -0.0030711221043020487, -0.03752567991614342, 0.004565131850540638, -0.032147981226444244, 0.04257834702730179, -0.015305749140679836, -0.007837547920644283, 0.0216437466442585, 0.03392085060477257, -0.0011828345013782382, -0.00435829721391201, -0.04157372564077377, -0.028424963355064392, -0.014234642498195171, -0.006127470638602972, 0.0015327909495681524, -0.0252928975969553, 0.0018882877193391323, 0.035191405564546585, -0.006031440105289221, -0.014707406982779503, -8.968212205218151e-05, -0.02028455026447773, 0.018659422174096107, 0.008561468683183193, 0.019058316946029663, 0.03983040526509285, 0.028631797060370445, -0.026504356414079666, 0.008893880993127823, 0.022027868777513504, 0.03046375885605812, -0.0020498770754784346, -0.04925614595413208, 0.01667972095310688, 0.004328749608248472, -0.012195845134556293, -0.00839156936854124, -0.023564353585243225, -0.0127055449411273, -0.035811908543109894, -0.040864575654268265, -0.004118221811950207, 0.02026977576315403, -0.01480343658477068, 0.02251540683209896, -0.03132064640522003, -0.007748904637992382, 0.035930097103118896, -0.019368568435311317, -0.026415713131427765, 0.036521054804325104, -0.05200409144163132, 0.013946550898253918, 0.00582460593432188, -0.0016094305319711566, -0.041012316942214966, -0.02908978797495365, 0.029311396181583405, 0.029252300038933754, -0.015734191983938217, -0.012831122614443302, -0.05200409144163132, 0.02601681835949421, -0.03705291450023651, 0.008103477768599987, 0.04003724083304405, -0.0015844996087253094, 0.006478350143879652, -0.005913249216973782, -0.023387067019939423, -0.026519130915403366, -0.035280048847198486, -0.00262605887837708, -0.03486637771129608, -0.029148882254958153, 0.05711585655808449, 0.006227194331586361, 0.00972121860831976, -0.0363733135163784, 0.004801514092832804, 0.0010295554529875517, 0.006485737394541502, 0.025071289390325546, 0.011612276546657085, -0.02399279549717903, 0.03108426183462143, 0.03046375885605812, -0.021244851872324944, -0.013340821489691734, -0.0040184976533055305, -0.012757252901792526, -0.006005586124956608, 0.0006422025035135448, -0.005300132557749748, 0.045326292514801025, 0.02595772221684456, -0.03530959412455559, 0.038027990609407425, 0.012144137173891068, 0.0004972337046638131, -0.0436420701444149, 0.03403903916478157, 0.0066297827288508415, -0.017167259007692337, -0.005200408864766359, -0.008059156127274036, -0.027183955535292625, -0.033832207322120667, -0.027139633893966675, 0.04181010648608208, -0.036550600081682205, 0.02393370121717453, -0.041632819920778275, -0.024273499846458435, -0.008421116508543491, 0.029163656756281853, -0.03262074664235115, -0.022825658321380615, -0.022988172248005867, 0.008864333853125572, 0.005189328454434872, -0.003303810954093933, 0.03471864014863968, 0.020033393055200577, 0.013355595991015434, 0.0050305090844631195, -0.002847667085006833, -0.016945650801062584, 0.02609068900346756, 0.029414813965559006, -0.016369469463825226, 0.00033841439289972186, -0.021215304732322693, -0.044558048248291016, -0.04987664893269539, 0.015098914504051208, -0.008162573911249638, -0.018511682748794556, -0.011826498433947563, -0.033595822751522064, -0.014736954122781754, -0.01667972095310688, -0.004827368073165417, 0.05741133168339729, -0.022175608202815056, -0.0033481325954198837, 0.012860670685768127, -0.02542586252093315, -0.024509882554411888, 0.03386175259947777, -0.023313196375966072, 0.03132064640522003, -0.00906378123909235, 0.0012169991387054324, 0.01379881240427494, 0.0016565222758799791, -0.003774728626012802, -0.031468383967876434, 0.019013995304703712, -0.0007299224380403757, -0.024332595989108086, -0.026977121829986572, 0.005193022079765797, -0.0073537034913897514, 0.03687562793493271, 0.046655941754579544, -0.01879238709807396, 0.004956639837473631, -0.00599450571462512, -0.006145937833935022, 0.024155309423804283, -0.02397802285850048, 0.00582460593432188, 0.001072953687980771, -0.042312417179346085, -0.012616901658475399, -0.016251277178525925, 0.0011985317105427384, 0.010903130285441875, -0.04565131664276123, 0.006437722127884626, 0.003130217781290412, -0.02028455026447773, -0.016384242102503777, -0.009595640935003757, -0.026962347328662872, 0.017728667706251144, 0.007822774350643158, 0.01380619965493679, 0.03764386847615242, -0.008162573911249638, -0.010341722518205643, 0.004757192451506853, -0.018556004390120506, 0.014736954122781754, -0.030729688704013824, -0.018600326031446457, 0.022855207324028015, -0.049640268087387085, 0.01957540214061737, 0.030316021293401718, 0.014884693548083305, 0.03708245977759361, -0.004136689007282257, 0.028454510495066643, -0.03250255435705185, 0.006057294551283121, -0.05995244160294533, 0.014980723150074482, -0.02542586252093315, -0.005532821640372276, 0.029917124658823013, 2.8422422474250197e-05, 0.016236504539847374, -0.03312306106090546, -0.03471864014863968, 0.011065643280744553, 0.012838509865105152, 0.0015604920918121934, -0.014293737709522247, 0.03421632573008537, 0.016989972442388535, 0.005204102490097284, -0.03040466457605362, -0.005658399313688278, 0.03994859755039215, 0.00527058495208621, 0.0016491353744640946, 0.0012169991387054324, 0.024096213281154633, 0.02094937488436699, 0.05930238962173462, 0.003470017109066248, -0.014005647040903568, 0.0036399168893694878, -0.01116906013339758, 0.005093298386782408, -0.019870880991220474, 0.00544048473238945, -0.014736954122781754, -0.022929076105356216, -0.028099937364459038, -0.017891179770231247, -0.009470063261687756, 0.024820134043693542, -0.009957601316273212, -0.03117290511727333, -0.01552735734730959, -0.009322323836386204, -0.01730022393167019, -0.002391523215919733, 0.004221638664603233, 0.02024022862315178, 0.001075723790563643, -0.11919573694467545, -0.03105471469461918, 0.013399917632341385, 0.01523187942802906, 0.017196806147694588, -0.015098914504051208, 0.0432283990085125, 0.0060166665352880955, -0.013813585974276066, -0.013067505322396755, 0.03117290511727333, -0.024775812402367592, -0.004668549168854952, -0.0218505822122097, -0.021289173513650894, -0.05625896900892258, 0.015276201069355011, 0.009255841374397278, 0.0031893132254481316, -0.021894903853535652, -0.018378717824816704, -0.025809984654188156, -0.012195845134556293, 0.03968266770243645, -0.016502434387803078, -0.035930097103118896, 0.003529112786054611, 0.0006011126097291708, 0.00649681780487299, 0.01591147854924202, 0.01728544943034649, -0.017167259007692337, 0.03332989290356636, 0.0289420485496521, -0.016236504539847374, -0.013813585974276066, -0.024332595989108086, -0.003143145004287362, -0.0017470123711973429, -0.00830292608588934, 0.024775812402367592, -0.04266699030995369, 0.02677028626203537, -0.03471864014863968, 0.008753529749810696, -0.058238670229911804, 0.019856106489896774, -0.0007742441375739872, 0.00037581080687232316, -0.01375449076294899, -0.010422978550195694, -0.016369469463825226, 0.009536545723676682, -0.0037451807875186205, -0.017891179770231247, 0.005156087223440409, 0.00944051519036293, 0.029340943321585655, 0.02832154557108879, 0.024894002825021744, -0.03817572817206383, 0.031025167554616928, 0.007800613529980183, -0.024480333551764488, -0.026356618851423264, -0.03486637771129608, 0.008635338395833969, 0.03191160038113594, -0.012491323053836823, -0.015039819292724133, -0.04124869778752327, -0.0005175478290766478, -0.0015097068389877677, 0.021170983090996742, 0.002367515815421939, 0.017580928280949593, -0.003436775878071785, 0.03841211274266243, -0.03241391107439995, 0.010674134828150272, 0.009159810841083527, -0.05159042030572891, -0.000648666056804359, 0.006829230114817619, -0.007593778893351555, -0.008265990763902664, 0.037230201065540314, -0.04151462763547897, -0.019294699653983116, -0.0017756368033587933, 0.04275563359260559, -0.020506158471107483, -0.01413861196488142, 0.0010369423544034362, 0.009994535706937313, -0.027715815231204033, -0.02313590981066227, 0.01963449828326702, 0.012025945819914341, -0.004103447776287794, 0.018659422174096107, 0.026533905416727066, -0.022072190418839455, -0.04222377389669418, -0.016192182898521423, -0.02239721640944481, 0.029533004388213158, -0.02465762011706829, 0.0362551249563694, 0.0072835274040699005, 0.00486060930415988, -0.008494986221194267, -0.03241391107439995, 0.008930816315114498, 0.0017303917557001114, 0.039357639849185944, -0.0003273339825682342, 0.013887455686926842, 0.0027460965793579817, -0.02034364454448223, 0.011737855151295662, 0.02758285030722618, -0.0010193983325734735, 0.007859708741307259, -0.040066786110401154, -0.006097922567278147, -0.014714793302118778, 0.04284427687525749, 0.02255972847342491, 0.001273324596695602, 0.005026815924793482, 0.017566153779625893, -0.0005207795766182244, -0.006079455371946096, 0.003130217781290412, 0.005248424131423235, 0.01552735734730959, -0.002838433487340808, -0.002397063421085477, -0.00031256009242497385, 0.00342754228040576, 0.009684284217655659, 0.008952977135777473, 0.022751789540052414, -0.033625371754169464, -0.004653775133192539, -0.02029932290315628, -0.012136749923229218, -0.030035316944122314, -0.0020369498524814844, 0.01489207986742258, -0.0015872697113081813, 0.02614978328347206, -0.008258604444563389, -0.015098914504051208, -0.005159780848771334, -0.0009473756654188037, -0.030641045421361923, 0.01725590229034424, 0.029503457248210907, 0.0363142192363739, 0.05481112748384476, 0.00976554024964571, 0.0034570901188999414, 0.015763739123940468, -0.005676866974681616, -0.012941926717758179, -0.022101737558841705, -0.016989972442388535, 0.024155309423804283, -0.022131286561489105, -0.020742541179060936, 0.0016158941434696317, 0.032207079231739044, 0.004376764874905348, -0.010895743034780025, 0.01589670404791832, 0.01738886721432209, -0.010895743034780025, 0.007874483242630959, 0.005953877232968807, 0.02390415221452713, -0.0180980134755373, -0.012114589102566242, 0.01659107767045498, -0.04000769183039665, 0.019841333851218224, 0.007815387099981308, -0.0024653926957398653, 0.00833986047655344, 0.02962164767086506, 0.03140928968787193, 0.025484958663582802, 0.03918035328388214, 0.022264251485466957, 0.013163534924387932, 0.007431266363710165, 0.018482135608792305, -0.004177317023277283, -0.016487659886479378, 0.03965311869978905, 0.04999484121799469, -0.01666494645178318, -0.018600326031446457, -0.024982646107673645, 0.009514384903013706, -0.009211519733071327, 0.006718426011502743, -0.03672788664698601, -0.004325055982917547, -0.024746263399720192, -0.018496908247470856, -0.05410198122262955, 0.02091982774436474, -0.00800744816660881, -0.03817572817206383, -0.007867095991969109, 0.04500126466155052, -0.018423039466142654, -0.027893101796507835, -0.0144784115254879, -0.019944749772548676, -0.03929854556918144, 0.022086964920163155, -0.0009113642736338079, 0.00415146304294467, -0.01192991528660059, -0.022205155342817307, -0.03389130160212517, -0.017965048551559448, 0.021407365798950195, 0.011242929846048355, -0.026297522708773613, -0.0108809694647789, -0.01724112778902054, -0.014559667557477951, -0.002509714337065816, -0.018423039466142654, 0.023505257442593575, -0.005455258768051863, 0.022899528965353966, 0.018629875034093857, -0.00200001522898674, 0.006493124179542065, 0.007482974790036678, -0.021525556221604347, 0.01601489633321762, 0.02385983057320118, -0.027760136872529984, -0.011737855151295662, -0.012853283435106277, -0.0020037086214870214, 0.028070388361811638, -0.011117351241409779, 0.0253963153809309, 0.0004081286897417158, 0.015025044791400433, 0.014323285780847073, 0.03191160038113594, 0.003859678516164422, -0.00978031475096941, -0.013060118071734905, 0.019427664577960968, -0.019353793933987617, -0.0017977976240217686, -0.051826801151037216, -0.0036269896663725376, 0.007586392108350992, -0.00596126401796937, -0.0018799774115905166, -0.016295598819851875, 0.009662123396992683, 0.00281442585401237, 0.036550600081682205, 0.0010507928673177958, -0.050349414348602295, 0.03465954214334488, -0.031468383967876434, -0.007734131067991257, 0.014552280306816101, -0.037407487630844116, -0.022146059200167656, -0.04579905793070793, -0.014603989198803902, -0.010851421393454075, -0.006578074302524328, 0.007771065458655357, -0.01020137034356594, 0.013813585974276066, -0.017713893204927444, 0.04863564297556877, 0.02979893423616886, 0.013052730821073055, 0.02600204572081566, 0.0020591109059751034, -0.007985287345945835, 0.003859678516164422, 0.035959646105766296, -0.009455288760364056, -0.023313196375966072, 0.010467300191521645, 0.006234581116586924, 0.025130385532975197, -0.05241775885224342, 0.023726865649223328, 0.04263744503259659, 0.03773251175880432, 0.02161419950425625, -0.0024857069365680218, -0.03997814282774925, 0.02453942969441414, 0.004993574693799019, 0.006116390228271484, -0.004402618855237961, 0.02818858064711094, -0.014301124960184097, 0.0033444392029196024, -0.009278002195060253, 0.00398156326264143, 0.027789685875177383, -0.019220829010009766, -0.0039040001574903727, -0.01192991528660059, 0.011087804101407528, 0.005588223692029715, -0.0004976954078301787, 0.014914240688085556, 0.0017054608324542642, 0.0009441438596695662, 0.013473786413669586, 0.038678042590618134, 0.02031409740447998, 0.015630774199962616, 0.0037858090363442898, -0.041721463203430176, -0.013392530381679535, -0.03194114938378334, 0.0053296806290745735, -0.0046759359538555145, -0.022766562178730965, 0.01738886721432209, 0.0047461120411753654, 0.005008348263800144, 0.0016574456822127104, -0.013695395551621914, 0.03690517321228981, 0.0017423955723643303, -0.03202979266643524, -0.02603159286081791, -0.017093390226364136, 0.08781599998474121, -0.020506158471107483, -0.019220829010009766, 0.026415713131427765, 0.010363883338868618, 0.01125770341604948, -0.0047461120411753654, -0.004897544160485268, -0.03897351771593094, 0.00041136046638712287, -0.011833884753286839, 0.03451180458068848, 0.007560537662357092, -0.001990781631320715, -0.006821843329817057, -0.009684284217655659, 0.003680545138195157, 0.013274339027702808, 0.040273621678352356, 0.007464507594704628, 0.033595822751522064, 0.008487598970532417, -0.010703682899475098, 0.008554081432521343, -0.02542586252093315, -0.016280826181173325, -0.015453487634658813, 0.025809984654188156, 0.02685892954468727, 0.02668164297938347, 0.028646571561694145, 0.0069215670228004456, -0.054752033203840256, 0.014264189638197422, -0.022973397746682167, -0.01656153053045273, -0.028572700917720795, 0.05014257878065109, 0.008155186660587788, -0.027213504537940025, 0.0024690863210707903, 0.02182103507220745, 0.004897544160485268, 0.027316920459270477, 0.0033462857827544212, -0.00795573927462101, -0.015121075324714184, 0.020062942057847977, -0.0003781192353926599, -0.011516246944665909, 0.01669449545443058, -0.012254941277205944, 0.004114528186619282, -0.007652874570339918, -0.001373971696011722, -0.024170082062482834, -0.003577127819880843, 0.006282596383243799, 0.0012354664504528046, 0.015128462575376034, -0.04721735045313835, 0.00431397557258606, -0.023682544007897377, -0.021363044157624245, 0.005085911136120558, -0.022648371756076813, 0.005732269026339054, 0.01379881240427494, -0.009861570782959461, 0.049610719084739685, -0.021274400874972343, 0.005806138273328543, -0.022308573126792908, -0.013525495305657387, 0.004816287662833929, 0.009846797212958336, 0.006618702318519354, 0.011021321639418602, 0.03244346007704735, 0.06967365741729736, -0.004007417242974043, -0.017004746943712234, -0.0008878184016793966, -0.02524857595562935, -0.00672950642183423, 0.026977121829986572, 0.029917124658823013, -0.0010387890506535769, -0.001662062481045723, 0.006474656984210014, -0.038796231150627136, 0.011811723932623863, 0.019383342936635017, 0.018659422174096107, 0.004240106325596571, -0.02889772690832615, 0.023697318509221077, -0.01054116990417242, -0.025706566870212555, 0.00342754228040576, -0.011132125742733479, 0.0026648403145372868, 0.015017658472061157, -0.002832893282175064, -0.021525556221604347, 0.0056214649230241776, -0.06015927717089653, -0.008059156127274036, 0.01010533981025219, 0.0182162057608366, 0.017610475420951843, -0.004476488567888737, 0.00685508456081152, -0.01600012183189392, -0.02907501347362995, 0.03412768244743347, -0.015290975570678711, -0.003263182705268264, 0.008613177575170994, -0.037909798324108124, 0.04290337488055229, 0.04999484121799469, -0.006426641717553139, 0.022234702482819557, -0.025071289390325546, 0.001595580019056797, 0.017965048551559448, -0.005551288835704327, 0.02827722392976284, -0.001847659470513463, -0.00778583949431777, 0.006829230114817619, 0.017137711867690086, -0.01724112778902054, 0.011087804101407528, 0.03477773442864418, -0.017832083627581596, -0.021880129352211952, -0.011368507519364357, 0.012875444255769253, -0.0053555346094071865, 0.001437684055417776, -0.01374710351228714, 0.009115489199757576, 0.017905954271554947, 0.027346469461917877, -0.010260465554893017, -0.019811784848570824, 0.025677019730210304, 0.0036750049330294132, -0.0014478411758318543, -0.021894903853535652, -0.02041751518845558, 0.030729688704013824, 0.012033333070576191, -0.03708245977759361, 0.023032493889331818, -0.009041620418429375, 0.020683445036411285, -0.0003208704001735896, 0.049728911370038986, -0.0217767134308815, -0.004524503368884325, 0.01154579408466816, 0.032857127487659454, 0.009078554809093475, -0.011294637806713581, 0.023076815530657768, 0.01485514547675848, -0.004077593330293894, -0.00527058495208621, -0.00018940588051918894, 0.0090194595977664, 0.0007687039324082434, -0.01418293360620737, -0.009204132482409477, -0.016502434387803078, 0.030641045421361923, 0.02182103507220745, 0.020461836829781532, -0.01014966145157814, -0.025706566870212555, 0.021274400874972343, -0.004690709989517927, -0.0029400039929896593, -0.004070206545293331, 0.02818858064711094, -0.0010277086403220892, -0.02244153805077076, 0.03474818542599678, 0.022766562178730965, 0.0013241098495200276, 0.0029677050188183784, -0.01663539931178093, 0.016886554658412933, 0.0025632698088884354, -0.0029030691366642714, -0.021466460078954697, 0.029518229886889458, 0.025603149086236954, -0.015143236145377159, -0.03389130160212517, -0.007926191203296185, 0.023387067019939423, 0.019959524273872375, -0.00038596783997491, -0.0066593303345143795, -0.01957540214061737, -0.014456250704824924, 0.027376016601920128, 0.040244072675704956, -0.013769264332950115, -0.0018347323639318347, 0.01882193423807621, 0.019811784848570824, -0.015010271221399307, 0.009950214065611362, 0.005595610477030277, -0.00837679486721754, -0.01970836892724037, 0.010592878796160221, 0.015660323202610016, 0.007697196211665869, -0.01744796335697174, -0.020387966185808182, 0.013865294866263866, 0.020003845915198326, -0.008945589885115623, -0.005170861259102821, 0.015217105858027935, 0.01959017664194107, -0.03205933794379234, -0.011723080649971962, 0.0017765602096915245, 0.04116005450487137, 0.0019649271853268147, -0.0004679167759604752, -0.02458375133574009, -0.0006934494012966752, -0.003610369050875306, -0.04107141122221947, 0.006995436269789934, 0.0180093701928854, -0.016413791105151176, -0.0056473189033567905, 0.040244072675704956, 0.0009321400430053473, -0.002291799522936344, -0.03891442343592644, 0.01732977107167244, 0.0034053814597427845, 0.03397994488477707, -0.010607652366161346, -0.06890542060136795, 0.019102638587355614, -0.003553120419383049, -0.01588193140923977, 0.009506997652351856, 0.033034417778253555, 0.012439614161849022, -0.004720257595181465, 0.01951630786061287, 0.0012511637760326266, 0.010651974007487297, -0.0011431296588853002, 0.00982463639229536, -0.004487568978220224, -0.009159810841083527, -0.018319621682167053, 0.01557167898863554, -0.017891179770231247, 0.019176507368683815, -0.002284412505105138, -0.015556905418634415, 0.0001644749427214265, 0.008967750705778599, 0.0020960455294698477, -0.033004868775606155, -0.004125608596950769, -0.01741841435432434, 0.02824767678976059, 0.0040258849039673805, 0.00026639169664122164, 0.010681522078812122, 0.019737916067242622, 0.008856946602463722, -0.014773889444768429, -0.002328734379261732, 0.018644647672772408, 0.003747027600184083, 0.01945721171796322, 0.003407228272408247, -0.013990872539579868, -0.02325410209596157, 0.003940934780985117, -0.005023122299462557, 0.027966972440481186, -0.04065774381160736, -0.02235289476811886, 0.029459135606884956, -0.03185250610113144, -0.011279864236712456, -0.000582183594815433, -0.009026845917105675, 0.024495108053088188, 0.008768303319811821, -0.00029940210515633225, 0.025189481675624847, 0.018334396183490753, 0.005133926402777433, 0.010999160818755627, -0.010592878796160221, 0.002489400329068303, 0.01489946711808443, 0.014301124960184097, 0.004805207252502441, -0.02524857595562935, -0.013060118071734905, -0.0436420701444149, 0.058297764509916306, -0.022086964920163155, 0.02254495397210121, 0.0005041589611209929, -0.0070212907157838345, 0.04470578953623772, -0.036521054804325104, -0.00020568023319356143, -0.0008638108265586197, 0.019146960228681564, -0.019235603511333466, 0.018556004390120506, 0.007859708741307259, 0.020845957100391388, -0.0008832015446387231, -0.00839156936854124, 0.01675358973443508, 0.0017553226789459586, 0.006072068586945534, 0.024347368627786636, -0.02402234449982643, -0.03785070404410362, 0.008916041813790798, -0.014042581431567669, -0.01303795725107193, -0.028011294081807137, 0.024243952706456184, -0.014781275764107704, -0.011449764482676983, -0.006094229407608509, 0.01116167288273573, 0.02820335514843464, 0.032147981226444244, -0.024376917630434036, 0.007494055200368166, 0.008081316947937012, -0.001966773997992277, 0.006714732386171818, -0.02028455026447773, -0.027021443471312523, -0.02465762011706829, -0.03120245411992073, -0.021259626373648643, 0.008147799409925938, -0.0014238335425034165, 0.0070212907157838345, 0.0075716180726885796, -0.02533721923828125, -0.008517147041857243, -0.001777483499608934, -0.010666747577488422, 0.0015475648688152432, 0.043021563440561295, 0.006592847872525454, 0.015217105858027935, -0.0006569763645529747, 0.0050342027097940445, -0.02678506076335907, -0.03205933794379234, -0.002884601941332221, -0.005880007985979319, 0.027686268091201782, -0.03468909114599228, 0.03200024366378784, -0.025809984654188156, 0.040273621678352356, -0.00472395122051239, -0.023564353585243225, 0.030670594424009323, -0.005167167633771896]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
" ]<<SYS>>
You are an intelligent chatbot. Answer the questions only using the following context:
{Original Text }
Here are some rules you always follow:
- Generate human readable output, avoid creating output with gibberish text.
- Generate only the requested output, don’t include any other language before or after the requested output.
- Never say thank you, that you are happy to help, that you are an AI agent, etc. Just answer directly.
- Generate professional language typically used in business documents in North America.
- Never generate offensive or foul language.
<< / SYS>>
Briefly summarize the given context. [/INST ]
Summary:
E. Verification of Generation Quality for Greedy Sampling and Advanced Supports
Generation Quality with Greedy Search is not changed. Theoretically, LOOKAHEAD DECODING does not change the
output generation of greedy search due to the verification mechanism. However, LOOKAHEAD DECODING ’s output does
not perfectly align with the huggingface’s implementation of greedy search in practice. We attribute this discrepancy to
numerical accuracy issues. To substantiate this claim, we compared the output results as follows. We use the LLaMA-2-7b-
Chat model’s single precision (FP32) inference with huggingface’s greedy search on 160 turns on the MT-Bench dataset
as a baseline. With single precision inference, the outputs of LOOKAHEAD DECODING (on 1GPU, 4GPUs, and 8GPUs)
are the same as the output of the baseline. With half-precision (FP16) inference, huggingface’s greedy search has 35 out
of 160 (w/o FlashAttention) and 42 out of 160 (w/ FlashAttention) answers not perfectly aligned with the baseline output.
In contrast, LOOKAHEAD DECODING and its integration with FlashAttention and multi-GPU inference has 35-44 results
different from the baseline output under different settings. We claim this result can show that LOOKAHEAD DECODING
can retain the output distribution using a greedy search within the numerical error range (not worse than huggingface’s
half-precision inference). Besides, Tab. 2 also strengthens the statements for greedy search.
Generation Quality with LP and FlashAttention Augmentation is not changed. We verify that FlashAttention and LP
Support will not change the compression ratio ( S) of vanilla LOOKAHEAD DECODING . We compared each 18 generations
ofLOOKAHEAD DECODING w/ FlashAttention and w/o FlashAttention (7B and 13B model on MT-Bench, HumanEval, and
ClassEval); the average Sw/ FlashAttention is 3.267 while w/o FlashAttention is 3.259, with less than 0.3% differences.
We also compared 6 generations of LOOKAHEAD DECODING on a single GPU and 12 generations with LP (7B model on
MT-Bench, HumanEval, and ClassEval, both with N= 5,W= 15 , andG= 15 ). The average Son a single GPU is 2.558,
while on multiple GPUs, it is 2.557, with less than 0.1% differences. We claim that our advanced support does not change S.
16
","[0.047988660633563995, -0.0034945507068187, 0.055976204574108124, 0.006252155639231205, -0.0034073852002620697, -0.007508133538067341, 0.020428461953997612, 0.019445868209004402, 0.0012094236444681883, 0.01408914104104042, 0.08589780330657959, -1.5151844309002627e-05, -0.04725963994860649, 0.012092255055904388, 4.093628831469687e-06, -0.011315688490867615, -0.009485209360718727, -0.06979592889547348, -0.01866930164396763, 0.004231496714055538, -0.008264889940619469, -0.014295169152319431, 0.03343991935253143, 0.0635833889245987, 0.02524634636938572, -0.04250514879822731, 0.012646946124732494, 0.016038483008742332, 0.037211816757917404, -0.04161764308810234, -0.017433132976293564, -0.05296503007411957, 0.010689680464565754, -0.04421676695346832, -0.01271826308220625, 0.0415225550532341, 0.031379640102386475, 0.002060279482975602, -0.01852666586637497, -0.02188650704920292, -0.005309181287884712, -0.02803564816713333, -0.02393093705177307, 0.0012767788721248507, 0.00351634225808084, 0.0020820708014070988, 0.022916646674275398, -0.019794531166553497, 0.0005849014269188046, 0.059748101979494095, -0.06897181272506714, 0.0561663843691349, -0.01576906070113182, 0.036229219287633896, -0.021569540724158287, 0.0032964469864964485, -0.020919760689139366, 0.014429880306124687, 0.009223712608218193, 0.012361676432192326, 0.028447704389691353, -0.022282714024186134, 0.0024188472889363766, -0.006406676489859819, 0.0007874625734984875, -0.02618139609694481, -0.03168075904250145, 0.007825099863111973, 0.01782934181392193, -0.00219300901517272, -0.0289231538772583, 0.022853253409266472, 0.0004308757488615811, -0.0528065450489521, -0.054898522794246674, 0.03160151466727257, 0.06561197340488434, 0.03667297214269638, 0.02118918113410473, -0.019746985286474228, 0.006466107442975044, 0.020127344876527786, -0.020507704466581345, -0.02071373164653778, -0.027274928987026215, -0.02342379093170166, -0.015689820051193237, -0.05803648382425308, -0.023312853649258614, -0.01600678637623787, -0.039589062333106995, 0.020983153954148293, 0.006581007968634367, -0.005966885946691036, 0.014049520716071129, 0.019905468448996544, 0.013233332894742489, -0.02505616657435894, 0.02313852310180664, 0.036229219287633896, 0.03882834315299988, -0.02342379093170166, 0.029826506972312927, -0.008015279658138752, 0.06542179733514786, -0.02215592749416828, -0.05340878292918205, 0.0054003093391656876, -0.027274928987026215, 0.016815049573779106, -0.05077796429395676, -0.0009687275160104036, -0.05661013722419739, 0.053757444024086, 0.0035480388905853033, 0.005788592621684074, -0.045104268938302994, -0.0068662771955132484, -0.007381347008049488, 0.021854810416698456, -0.01706862263381481, 0.001845336752012372, 4.708060441771522e-05, -0.014326865784823895, 0.002519880188629031, 0.00533295376226306, 0.09851305186748505, -0.07252183556556702, 0.005198243539780378, -0.036229219287633896, 0.027972254902124405, 0.01814630627632141, 0.009350499138236046, -0.03645109757781029, -0.06038203462958336, 0.003137964056804776, -0.03252071887254715, -0.015222295187413692, -0.03546850383281708, 0.017464829608798027, -0.031744152307510376, -0.05505700409412384, -0.04351944103837013, 0.010586666874587536, -0.043931495398283005, -0.006442334968596697, -0.023693213239312172, 0.006426486652344465, -0.04063504934310913, 0.02757604792714119, 0.0029299550224095583, -0.027274928987026215, -0.1051059439778328, -0.005301257129758596, -0.0074447402730584145, -0.02313852310180664, -0.021823113784193993, 0.011070040054619312, -0.02347133681178093, -0.018907025456428528, -0.006196686532348394, 0.033059559762477875, 0.031664907932281494, -0.011759440414607525, 0.002274231519550085, 0.028637884184718132, -0.047291334718465805, 0.007048532832413912, -0.05930434912443161, 0.007920189760625362, 0.015238143503665924, 0.009255409240722656, -0.008344131521880627, -0.024517325684428215, 0.013368044048547745, -0.015309460461139679, -0.03290107846260071, -0.046689100563526154, -0.030222713947296143, -0.06567537039518356, -0.03578546643257141, 0.034264031797647476, 0.012329979799687862, 0.005812365096062422, -0.03261580690741539, -0.0427270233631134, -0.004100748337805271, -0.02085636742413044, 0.033059559762477875, 0.024105269461870193, 0.0038016117177903652, -0.007008912041783333, 0.06764055788516998, 0.0027219459880143404, 0.003534171497449279, -0.04218818247318268, 0.09483624249696732, -0.01778179593384266, -0.004615818150341511, -0.04900295287370682, 0.02370906062424183, -0.00574104767292738, 0.0046514770947396755, -0.0393671840429306, 0.0019374550320208073, -0.02342379093170166, 0.0014877594076097012, -0.0031340019777417183, -0.00099448102992028, 0.026371575891971588, 0.025595009326934814, -0.028209978714585304, 0.02724323235452175, 0.012353751808404922, -0.05166546627879143, 0.008661097846925259, -0.023645667359232903, 0.0196835920214653, -0.009968582540750504, 0.04339265450835228, 0.011458323337137699, 0.0006403704755939543, 0.040381476283073425, 0.04202970117330551, -0.0151192806661129, 0.029604630544781685, 0.029620477929711342, -0.025087863206863403, -0.007702275179326534, -0.01437441073358059, 0.04500918090343475, 0.02351888082921505, -0.011973393149673939, -0.022076686844229698, 0.0407935306429863, -0.02911333180963993, 0.00533295376226306, -0.015475868247449398, 0.02966802380979061, -0.007936038076877594, -0.0167992003262043, -0.0067474148236215115, 0.012979759834706783, -0.04291720315814018, -0.034232333302497864, 0.017655009403824806, -0.053915925323963165, -0.05622977763414383, 0.020412614569067955, 0.011323612183332443, -0.005657844245433807, -0.056198082864284515, -0.0002540681161917746, -0.048400718718767166, -0.028431855142116547, -0.014414031989872456, -0.021268421784043312, 0.0360073447227478, -0.017433132976293564, -0.006283852271735668, -0.028637884184718132, -0.0012163572246208787, -0.02584858238697052, -0.01107796374708414, -0.027354171499609947, 0.0069970255717635155, 0.03033365122973919, 0.0010212250053882599, -0.035912252962589264, -0.018130458891391754, -0.010317245498299599, -0.01210810337215662, 0.027750378474593163, 0.026482515037059784, -0.01437441073358059, -0.04161764308810234, -0.014834011904895306, 0.0029141067061573267, -0.048971258103847504, -0.002349511021748185, -0.0626324936747551, -0.009104849770665169, 0.04494578763842583, 0.037497084587812424, 0.019208142533898354, 0.01694183610379696, -0.007369461003690958, -0.011125508695840836, -0.01782934181392193, -0.010483652353286743, 0.014398183673620224, -0.06700662523508072, 0.04256854206323624, -0.030349500477313995, -0.020539401099085808, 0.04120558872818947, 0.013898962177336216, 0.03619752451777458, -0.003607470076531172, -0.012742036022245884, 0.047703392803668976, 0.010285548865795135, -0.03347161412239075, -0.01563435047864914, -0.01033309381455183, 0.05042929947376251, -0.03164906054735184, 0.03175999969244003, -0.00919201597571373, 0.008054899983108044, -0.009849720634520054, 0.01749652624130249, -0.00395613256841898, -0.00046405813191086054, -0.03965245559811592, -0.026942115277051926, 0.06802091747522354, -0.01301938109099865, -0.005095229484140873, -0.031284548342227936, -0.023217763751745224, -0.01763916201889515, 0.030206864699721336, -0.010919480584561825, -0.008542235009372234, -0.006993063725531101, -0.010864011943340302, 0.004599969834089279, 0.002523842267692089, 0.008748263120651245, 0.029366904869675636, 0.003888777457177639, 0.004039336461573839, -0.0022088573314249516, -0.025214649736881256, -0.02323361299932003, -0.03990602865815163, 0.05128511041402817, 0.030824949964880943, 0.016973532736301422, -0.08057276904582977, -0.00481788394972682, 0.014239700511097908, -0.03225129842758179, -0.03578546643257141, -0.02141105756163597, -0.006073862314224243, 0.024438083171844482, 0.09052550792694092, 0.013581995852291584, 0.022140080109238625, -0.025167105719447136, 0.04380470886826515, -0.011394930072128773, 0.02873297408223152, 0.000573015189729631, -0.0032647503539919853, -0.03822610527276993, -0.027259081602096558, 0.02640327252447605, -0.014667604118585587, -0.004667325410991907, 0.013922734186053276, -0.015460019931197166, -0.01927153579890728, 0.010729300789535046, -0.03546850383281708, -0.005027873907238245, 0.0448823943734169, -0.016070179641246796, 0.031284548342227936, 0.0391136109828949, -0.011799061670899391, -0.00991311389952898, -0.0532819963991642, -0.011133433319628239, 0.01064213551580906, 0.022900797426700592, -0.02738586813211441, 0.06320302933454514, -0.03372518718242645, 0.015206446871161461, -0.000516060390509665, -0.04022299125790596, 0.051538679748773575, 0.02332870289683342, 0.003940284252166748, -0.0032548452727496624, -0.06732358783483505, -0.02678363211452961, -0.04665740579366684, -0.013011456467211246, -0.03559529036283493, -0.01580868288874626, 0.005515209399163723, 0.026878722012043, 0.010119141079485416, 0.003395498963072896, 0.030761556699872017, 0.06789413094520569, 0.029826506972312927, -0.01912890188395977, -0.0025218611117452383, -0.06488294899463654, -0.04332926124334335, 0.019604351371526718, -0.024976925924420357, 0.044628821313381195, 0.0600016750395298, 0.037528783082962036, 0.011624730192124844, 0.013336347416043282, 0.056293170899152756, -0.030317803844809532, 0.016450539231300354, -0.020792974159121513, 0.022853253409266472, 0.007100039627403021, 0.04691097512841225, 0.06088918074965477, -0.023946786299347878, -0.018827784806489944, -0.047798480838537216, -0.028986547142267227, -0.030809100717306137, -0.003841232508420944, 0.011648503132164478, -0.024232055991888046, 0.016735807061195374, -0.04301229491829872, -0.0528065450489521, 0.027845468372106552, 0.04989045858383179, -0.012757884338498116, -0.03372518718242645, 0.010483652353286743, -0.01717955991625786, 0.02402602694928646, -0.008684869855642319, -0.036831457167863846, 0.008455069735646248, -0.01446157693862915, -0.009152394719421864, -0.02454902045428753, -0.04050826281309128, -0.009968582540750504, -0.021205028519034386, -0.003302390221506357, 0.0163237527012825, -0.0393671840429306, -0.006925708614289761, -0.0007859767647460103, 0.011030418798327446, 0.030175168067216873, -0.02935105748474598, -0.015143053606152534, 0.06681644916534424, -0.03052383102476597, 0.005820289254188538, -0.03765556961297989, -0.003817460034042597, -0.02440638653934002, -0.05061947926878929, 0.04716454818844795, -0.0009499076404608786, 0.012266586534678936, 0.03363009914755821, 0.02318606711924076, 0.027465108782052994, 0.010103292763233185, 0.033059559762477875, -0.0018146306974813342, -0.008661097846925259, -0.002777415094897151, 0.017718402668833733, -0.0017304365755990148, 0.011442475020885468, -0.027782075107097626, -0.0020127345342189074, -0.0348028726875782, 0.0022960228379815817, -0.009104849770665169, 0.042061395943164825, 0.03334483131766319, -0.0035936026833951473, 0.07283879816532135, 0.047988660633563995, -0.011466247029602528, -0.02529389224946499, -0.03638770431280136, -0.035626985132694244, -0.05584941804409027, 0.06060390919446945, -0.021379360929131508, 0.015333233401179314, 0.015285688452422619, 0.014738922007381916, 0.025357285514473915, -0.008431296795606613, -0.006184800062328577, 0.020000558346509933, 0.003651052713394165, -0.013265029527246952, 0.028384311124682426, 0.03215620666742325, -0.04073013737797737, 0.0094218160957098, -0.006917784456163645, -0.017512375488877296, -0.013066926039755344, 0.022472893819212914, 0.011410778388381004, -0.0331229530274868, 0.01871684566140175, -0.011046267114579678, 0.006897973828017712, 0.014738922007381916, 0.025325588881969452, -0.0020503741689026356, 0.012916366569697857, 0.013637464493513107, -0.027132295072078705, -0.0031696606893092394, 0.014477425254881382, -0.0018968437798321247, -0.0470377616584301, -0.0323939323425293, -0.10485237091779709, -0.03218790516257286, -0.03470778465270996, 0.03686315193772316, -0.012250738218426704, 0.007500209379941225, -0.011070040054619312, -0.04763999953866005, -0.012005089782178402, 0.017575768753886223, -0.03318634629249573, -0.055025309324264526, 0.0012391392374411225, 0.004920898005366325, 0.024834290146827698, 0.01847912184894085, 0.0037421805318444967, 0.005590488668531179, -0.011846606619656086, 0.027053052559494972, 0.0011915942886844277, -0.01190207526087761, -0.006509690545499325, 0.0262764859944582, -0.05486682429909706, 0.016482235863804817, 0.0013381910976022482, -0.02710059843957424, 0.033249739557504654, 0.008146028034389019, -0.010317245498299599, 0.012417145073413849, 0.0029081637039780617, 0.05306011810898781, -0.009358422830700874, 0.028843911364674568, 0.003653033869341016, -0.019984710961580276, 0.0243588425219059, 0.005562754347920418, 0.0002664495841600001, 0.02561085857450962, -0.0020523553248494864, -0.013637464493513107, -0.03974754363298416, 0.012147724628448486, -0.03664127737283707, 0.015143053606152534, -0.00973085779696703, 0.011355308815836906, 0.004536576569080353, 0.003595583839341998, -0.0010727320332080126, -0.010515348985791206, -0.04380470886826515, -0.016878442838788033, 0.0002522108843550086, -0.044723909348249435, 0.0013976221671327949, 0.006291776429861784, 0.04228327423334122, -0.004988253582268953, 0.009548602625727654, 0.03050798363983631, -0.004318662453442812, -0.019953014329075813, -0.012242814525961876, -0.023011736571788788, 0.007207015994936228, 0.00877203606069088, -0.024232055991888046, -0.015848303213715553, -0.007892454974353313, 0.01490532886236906, -0.002611008007079363, -0.004865428898483515, -0.011466247029602528, 0.0017928392626345158, 0.01066590752452612, -0.04428016021847725, -0.0005957971443422139, 0.04865429177880287, -0.004944670479744673, -0.012781656347215176, 0.007417005952447653, -0.025880279019474983, -0.013677085749804974, -0.015063812024891376, 0.016062255948781967, -0.04168103635311127, -0.00738530931994319, 0.04830562695860863, -0.02332870289683342, 0.013233332894742489, -0.023677363991737366, 0.028384311124682426, 0.001963208429515362, 0.05210921913385391, -0.0019196256762370467, -0.01941417157649994, -0.03350331261754036, 0.019002115353941917, 0.010610438883304596, -0.031189460307359695, -0.0017700573662295938, -0.003395498963072896, -0.002155369147658348, 0.013478981330990791, -0.00688212551176548, -0.0017670857487246394, -0.0008785902755334973, -0.001448138733394444, -0.04260023683309555, 0.010721377097070217, 0.020729580894112587, 0.015872076153755188, -0.03930379077792168, -0.00013087231491226703, 0.005546906031668186, 0.015150977298617363, -0.02179141715168953, -0.004568273201584816, -0.029414450749754906, -0.01684674620628357, -0.05493021756410599, 0.04003281518816948, 0.024675806984305382, 0.03350331261754036, -0.019588502123951912, -0.02304343320429325, -0.015206446871161461, 0.010467804037034512, 0.01383556891232729, -0.029414450749754906, -0.018257245421409607, -0.016355449333786964, -0.024184510111808777, -0.013708782382309437, 0.029604630544781685, 0.001435261918231845, 0.009199939668178558, 0.0006601808709092438, -0.006200648378580809, -0.043551135808229446, 0.03182339295744896, 0.04599177464842796, -0.010230079293251038, -0.023439640179276466, -0.011577185243368149, -0.004489031620323658, -0.03797253221273422, -0.021490298211574554, 0.010903632268309593, -0.027924709022045135, 0.016640719026327133, -0.050746265798807144, -0.02486598677933216, 0.010436107404530048, 0.0279564056545496, 0.028526945039629936, -0.01346313301473856, -0.0006572093116119504, -0.0010519310599192977, -0.011767365038394928, 0.0157769862562418, 0.011648503132164478, -0.01096702553331852, 0.008653173223137856, 0.0006715718191117048, -0.00712777441367507, 0.022853253409266472, -0.003888777457177639, -0.06111105531454086, -0.019065508618950844, 0.006684022024273872, 0.028431855142116547, -0.020555248484015465, -0.026625148952007294, -0.055786024779081345, -0.014239700511097908, 0.028479401022195816, 0.053123511373996735, -0.03505644574761391, -0.02001640759408474, 0.021918203681707382, -0.013257105834782124, 0.02123672515153885, 0.01595131680369377, 0.028431855142116547, -0.015071735717356205, -0.017528222873806953, -0.0020979191176593304, -0.028400158509612083, -0.04000111669301987, 0.008550159633159637, -0.014881556853652, 0.0005745009984821081, -0.009239560924470425, -0.021585388109087944, -0.02380415052175522, 0.01759161613881588, -0.017861036583781242, 0.041871216148138046, -0.013352195732295513, 0.001660109730437398, 0.0033538970164954662, -0.03214035928249359, -0.0037441616877913475, 0.027370018884539604, -0.04095201566815376, -0.008550159633159637, -0.00919201597571373, -0.00553898187354207, 0.018368182703852654, -0.007967734709382057, 0.006129331421107054, -0.005443891976028681, -0.0006686002598144114, -0.025531616061925888, 0.009176167659461498, 0.01012706570327282, 0.00195132230874151, -0.060920875519514084, -0.016973532736301422, 0.0167992003262043, -0.017290499061346054, -0.03185508772730827, 0.03363009914755821, 0.0012014994863420725, 0.027274928987026215, 0.001433280878700316, 0.005368612706661224, 0.011624730192124844, 0.015158901922404766, -0.0029319359455257654, -0.02020658552646637, 0.019762834534049034, 0.020190738141536713, -0.016133572906255722, -0.04396319389343262, -0.02299588732421398, 0.011394930072128773, 0.013542374595999718, 0.013447284698486328, 0.0023079090751707554, 0.04180782288312912, 0.04744981974363327, 0.035817164927721024, -0.018970418721437454, 0.043836407363414764, -0.025927823036909103, 0.0021712174639105797, 0.013581995852291584, -0.004786187317222357, -0.003948208410292864, -0.024675806984305382, 0.014120837673544884, -0.03363009914755821, -0.0012827219907194376, 0.009207864291965961, 0.01232205517590046, -0.028003951534628868, -0.014334790408611298, 0.011117585003376007, -0.00704457052052021, 0.00677514960989356, 0.02049185521900654, -0.01852666586637497, 0.052648063749074936, -0.00825696624815464, -0.16114553809165955, 0.001635346794500947, 0.03158566728234291, -0.03014347143471241, 0.013898962177336216, 0.01068175584077835, 0.0315539725124836, 0.033566705882549286, -0.0007102020899765193, -0.008906746283173561, 0.0027972254902124405, -0.03065061755478382, 0.03050798363983631, -0.04478730261325836, 0.007468512747436762, -0.03337652608752251, 0.005665768403559923, -0.009810099378228188, 0.02114163711667061, -0.044153373688459396, -0.027877165004611015, -0.007072305306792259, 0.015380778349936008, -0.014540817588567734, -0.0035143611021339893, 0.01159303355962038, 0.011608881875872612, 0.002017687074840069, -0.005614261142909527, 0.013494829647243023, -0.035722073167562485, -0.00594707578420639, 0.0013807833893224597, 0.020983153954148293, -0.018178002908825874, -0.036514490842819214, -0.047196246683597565, -0.00538842286914587, 0.007730009965598583, 0.019334929063916206, 0.0018809954635798931, -0.05537397041916847, 0.020285828039050102, -0.012195269577205181, -0.016402993351221085, 0.0022068761754781008, 0.020238282158970833, 0.0035579439718276262, -0.005883682519197464, 0.0068266564048826694, 0.02299588732421398, -0.007666616700589657, 0.01955680549144745, -0.03350331261754036, 0.00028824101900681853, -0.012234889902174473, -0.03340822458267212, -0.003320219460874796, 0.008201496675610542, 0.0073258779011666775, -0.03293277323246002, 0.033059559762477875, 0.027639441192150116, -0.02234610728919506, 0.012361676432192326, -0.03448590636253357, 0.011466247029602528, 0.03215620666742325, -0.019477564841508865, -0.014493273571133614, -0.04164934158325195, 0.007531906012445688, 0.005780668463557959, 0.02500862255692482, -0.011941696517169476, 0.013003532774746418, 0.036926545202732086, 0.005931227467954159, -0.0262764859944582, 0.005725199356675148, 0.05790970101952553, -0.07746650278568268, 0.01670411229133606, 0.02104654721915722, 0.0003459387517068535, 0.03141133487224579, 0.029525388032197952, -0.008669021539390087, -0.017987823113799095, 0.01852666586637497, 0.04624534770846367, -0.024057723581790924, 0.001219328842125833, 0.012631097808480263, -0.047291334718465805, -0.019857924431562424, 0.029319360852241516, -0.014104989357292652, 0.022615527734160423, 0.01180698536336422, 0.018209699541330338, 0.030682314187288284, -0.008954291231930256, -0.05350387096405029, -0.02491353265941143, 0.02095145732164383, -0.009445589035749435, -0.0031260778196156025, 0.0151192806661129, 0.004144331440329552, -0.0037619909271597862, 0.025769339874386787, -0.002252439968287945, 0.02645081840455532, 0.004445448983460665, 0.027544351294636726, 0.030587224289774895, -0.028003951534628868, 0.02649836242198944, -0.02380415052175522, 0.018320638686418533, 0.03372518718242645, -0.021157484501600266, -0.0285586416721344, -0.010895708575844765, -0.018162155523896217, 0.003952170722186565, -0.004342434927821159, -0.001998867141082883, 0.016482235863804817, 0.0020107533782720566, -0.007341726217418909, -0.0009409929625689983, -0.004069051705300808, 0.0037481237668544054, -0.009810099378228188, -0.006176875904202461, -0.025547465309500694, -0.013288802467286587, 0.02006395161151886, -0.010689680464565754, -0.020285828039050102, 0.05191903933882713, 0.012211117893457413, -0.04006450995802879, -0.02966802380979061, 0.003966037649661303, -0.012686566449701786, -0.019889621064066887, -0.004877315368503332, -0.005352764390408993, -0.02388339303433895, -0.010832315310835838, 0.022361954674124718, 0.03149057924747467, 0.04012790322303772, 0.014572514221072197, -0.026054609566926956, -0.0019968862179666758, 0.009619919583201408, 0.031157763674855232, 0.03489796444773674, 0.02299588732421398, 0.0036252993158996105, 0.02117333374917507, -0.021347664296627045, -0.013526526279747486, 0.010111217387020588, -0.019699441269040108, -0.0007547754212282598, -0.029731417074799538, -0.01749652624130249, 0.05109493061900139, 0.009794251061975956, 0.03321804478764534, 0.01754407212138176, 0.012211117893457413, 0.03657788410782814, 0.0014095084043219686, 0.02388339303433895, 0.016173193231225014, 0.04041317105293274, -0.0027100597508251667, 0.033661793917417526, 0.01436648704111576, 0.0003310809552203864, 0.013621616177260876, 0.03321804478764534, 0.011727743782103062, 0.03248902037739754, -0.008835429325699806, 0.040096208453178406, 0.01045195572078228, 0.021379360929131508, 0.0019037773599848151, -0.006145179271697998, 0.05369405075907707, 0.018447425216436386, -0.012884669937193394, -0.0015164845390245318, -0.007991506718099117, 0.034232333302497864, 0.0021415019873529673, -0.013843492604792118, -0.0021692365407943726, 0.04447034001350403, -0.021759720519185066, -0.006236307322978973, -0.017132015898823738, 0.043836407363414764, -0.01322540920227766, 0.002198952017351985, -0.03088834322988987, 0.009445589035749435, -0.032314691692590714, 0.006715718191117048, 0.019715288653969765, 0.01269449107348919, -0.017750099301338196, -0.021918203681707382, -0.012337903492152691, -0.026862872764468193, -0.014414031989872456, -0.006664211396127939, -0.0171637125313282, 0.000620064849499613, 0.028257524594664574, -0.013169939629733562, -0.014287245459854603, 0.0027793962508440018, 0.004584121517837048, -0.006604780443012714, 0.01833648607134819, 0.0033737074118107557, -0.017971975728869438, -0.006755338981747627, -0.011735668405890465, -0.008391676470637321, -0.00993688590824604, 0.001968161202967167, 0.018907025456428528, -0.011117585003376007, -0.0026327993255108595, -0.01168812345713377, 0.005780668463557959, -0.005677654407918453, -0.02047600783407688, 0.03391536697745323, 0.018859481438994408, -0.010578742250800133, -0.020174888893961906, 0.0007245645974762738, 0.037211816757917404, -0.024850139394402504, 0.006260079797357321, 0.0134393610060215, 0.022171776741743088, 0.022472893819212914, 0.030872493982315063, 0.01852666586637497, -0.028162434697151184, 0.010515348985791206, 0.01665656641125679, -0.03895512968301773, -0.0051903193816542625, -0.007345688529312611, -0.042948901653289795, 0.012536007910966873, -0.012757884338498116, 0.01725880242884159, 0.0022960228379815817, 0.042853809893131256, -0.011719820089638233, 0.03508814424276352, -0.001960237044841051, -0.008241117931902409, 0.019905468448996544, 0.0014402145752683282, 0.024342993274331093, -0.002652609720826149, -0.018114609643816948, -0.004675249569118023, -0.01843157596886158, -0.0013163996627554297, -0.017892733216285706, -0.02486598677933216, -0.052045825868844986, 0.011323612183332443, 0.04982706531882286, -0.013304650783538818, 0.02128427103161812, 0.029984990134835243, -0.01460421085357666, 0.020602794364094734, 0.007226826157420874, 0.009239560924470425, 0.012068483047187328, 0.007785479072481394, 0.02496107667684555, 0.0012530065141618252, 0.01973113790154457, 0.03413724526762962, 0.011212673969566822, -0.038194410502910614, 0.0213635116815567, 0.025135409086942673, 0.015436246991157532, -0.03930379077792168, 0.007040608674287796, -0.012337903492152691, -0.011640578508377075, 0.04646722599864006, 0.004096786491572857, 0.008209421299397945, 0.021680478006601334, 0.01539662666618824, -0.006588932126760483, -0.010895708575844765, 0.015079660341143608, -0.017290499061346054, 0.02613385207951069, -0.002159331226721406, -0.007413043640553951, 0.019715288653969765, 0.014176307246088982, -0.04301229491829872, 0.014501197263598442, 0.005895568523555994, 0.004813922103494406, 0.009041456505656242, 0.007294181268662214, 0.011632654815912247, 0.006842504721134901, -0.0012450823560357094, -0.0374336913228035, -0.00014808258856646717, -0.05157037824392319, 0.005745009984821081, -0.008819581009447575, -0.020729580894112587, 0.04133237525820732, -0.00860562827438116, -0.0068266564048826694, 0.017940279096364975, -0.011260218918323517, 0.01558680646121502, -0.027496805414557457, -0.00211772951297462, 0.007088153623044491, -0.022171776741743088, 0.10098538547754288, -0.021664630621671677, -0.012393373064696789, 0.012591476552188396, -0.022171776741743088, 0.012028861790895462, -0.01106211543083191, -0.023740757256746292, -0.017575768753886223, 0.00835205614566803, -0.008217344991862774, 0.02762359194457531, 0.01539662666618824, 0.009089001454412937, 0.03363009914755821, -0.021997444331645966, -0.01114928163588047, 0.01292429119348526, 0.01519059855490923, -0.005336916074156761, 0.01521437056362629, 0.03112606704235077, -0.007424930110573769, -0.0032865419052541256, -0.02397848293185234, 0.019002115353941917, 0.005420119501650333, 0.020143192261457443, 0.023645667359232903, 0.034264031797647476, 0.02757604792714119, -0.0028289221227169037, -0.020000558346509933, 0.013162015937268734, 0.00412848312407732, -0.01717955991625786, -0.017116166651248932, 0.045421235263347626, -0.007373422849923372, -0.04279041662812233, 0.01539662666618824, -0.006434410810470581, -0.010935328900814056, 0.009802175685763359, 0.0008221307070925832, 0.014968722127377987, 0.005356726236641407, 0.009247484616935253, 0.018748542293906212, -0.020048104226589203, -0.0008815618348307908, 0.010768922045826912, 0.013241257518529892, -0.008209421299397945, 0.012092255055904388, -0.03924039751291275, -0.016173193231225014, 0.047101154923439026, 0.0302385613322258, 0.011608881875872612, -0.03302786499261856, 0.026751935482025146, -0.04209309443831444, -0.00931087788194418, -0.018685149028897285, -0.049351613968610764, 0.0020275921560823917, 0.032964471727609634, -0.012726187705993652, 0.015150977298617363, -0.026482515037059784, -0.013518602587282658, 0.012639021500945091, -0.008946366608142853, -0.004556387197226286, 0.0077339718118309975, -0.02347133681178093, 0.017195409163832664, 0.02538898214697838, 0.043741315603256226, -0.012583552859723568, -0.017116166651248932, -0.0424734503030777, -0.024881836026906967, -0.0254365261644125, 0.006838542874902487, 0.014564590528607368, 0.01950926147401333, -0.03565868362784386, 0.02356642670929432, -0.016672415658831596, -0.012369600124657154, 0.0633615180850029, 0.026767782866954803, -0.012955987825989723, 0.016910139471292496, 0.001801753998734057, -0.009453512728214264, 0.01852666586637497, 0.0064581832848489285, -0.010713452473282814, -0.008534311316907406, -0.041966307908296585, -0.004544500727206469, -0.020079798996448517, -0.0013302669394761324, -0.018162155523896217, 0.0011628692736849189, 0.016593173146247864, 0.0043345107696950436, 0.00015377806266769767, 0.018954571336507797, -0.007369461003690958, 0.034042153507471085, 0.0011272105621173978, 0.028019798919558525, 0.02174387127161026, 0.0033895557280629873, 0.01600678637623787, -0.06707001477479935, 0.04263193532824516, 0.034549299627542496, 0.007682465016841888, 0.006212534848600626, -0.009168243035674095, -0.0070762671530246735, -0.029509540647268295, -0.00093009730335325, -0.0006562187918461859, -0.014437803998589516, -0.014691377058625221, -0.02510371245443821, 0.016529779881238937, 0.011204750277101994, -0.012290358543395996, 0.02873297408223152, -0.000899886479601264, -0.03206111863255501, -0.026324031874537468, -0.025262195616960526, 0.037306904792785645, 0.0025436526630073786, -0.014889480546116829, 0.01509550865739584, -0.00377387716434896, 0.012512234970927238, 0.006374979857355356, -0.01773425191640854, 0.005142774432897568, 0.010911556892096996, -0.0004368188383523375, -0.02776622772216797, 0.013891037553548813, -0.004053203389048576, -0.02104654721915722, 0.013122394680976868, 0.00289231538772583, -0.014730997383594513, 0.021268421784043312, -0.00046034366823732853, 0.008970139548182487, -0.01987377181649208, 0.001310456544160843, 0.023455487564206123, 0.04133237525820732, -0.021997444331645966, -0.017670858651399612, 0.005939151626080275, 0.022853253409266472, -0.0020919758826494217, 0.009295029565691948, -0.008558083325624466, 6.747910083504394e-05, 0.010039899498224258, -0.02836846187710762, -0.008094520308077335, -0.03857477009296417, 0.008851277641952038, -0.02589612640440464, 0.014952873811125755, 0.016640719026327133, -0.01749652624130249, 0.019525108858942986, -0.0016095932805910707, -0.016545629128813744, -0.015983013436198235, 0.0010350922821089625, 0.015317385084927082, -0.0054399301297962666, -0.003851137589663267, 0.03518323227763176, -0.023392096161842346, 0.0042037623934447765, 0.004132444970309734, 0.006307624746114016, 0.045706506818532944, 0.0037619909271597862, 0.013241257518529892, 0.023122673854231834, 0.027829620987176895, -0.010507425293326378, -0.0006765244179405272, -0.0037144459784030914, 0.004869391210377216, 0.009477285668253899, 0.013518602587282658, -0.0013144186232239008, 0.0009206873364746571, 0.010705528780817986, 0.0026288372464478016, 0.03201357275247574, 0.0016987399430945516, -0.001279750489629805, 0.013399739749729633, 0.027988102287054062, 0.008645249530673027, 0.01624451018869877, -0.0037124650552868843, -0.006961367093026638, -0.028067344799637794, 0.008272814564406872, 0.01744898222386837, 0.007848871871829033, -0.00036971119698137045, -0.005895568523555994, 0.026054609566926956, 0.013867265544831753, 0.027702834457159042, -0.0017066641012206674, 0.030539680272340775, 0.002444600686430931, -0.009699161164462566, -0.006157065741717815, 0.0009231636649928987, 0.007634920068085194, -7.076019392115995e-05, -0.026070458814501762, -0.03042874112725258, 0.008550159633159637, -0.0020582983270287514, -0.023455487564206123, 0.011180977337062359, 0.00805093813687563, -0.004584121517837048, -0.014049520716071129, 0.028447704389691353, 0.017655009403824806, -0.011220598593354225, -0.009390119463205338, 0.016125649213790894, 0.010404410772025585, 0.01539662666618824, 0.0040849000215530396, -0.028939001262187958, 0.020032254979014397, -0.05512039735913277, -0.012337903492152691, -0.017274649813771248, -0.006687983870506287, -0.0019503318471834064, -0.042758721858263016, -0.01838403195142746, 0.0003256330965086818, -0.01448534894734621, -0.029747264459729195, 0.010063672438263893, -0.04485069587826729, 0.010475728660821915, -0.01435063872486353, 0.0025575198233127594, -0.004659401252865791, 0.0007498228223994374, -0.015230218879878521, -0.014746845699846745, 0.03718011826276779, 0.01857421174645424, -0.005689540877938271, -0.004552424885332584, -0.020507704466581345, -0.0023019660729914904, 0.03382027894258499, 0.031427185982465744, -0.013336347416043282, -0.003488607704639435, -0.0006745433784089983, -0.006850428879261017, -0.0032548452727496624, 0.005982734262943268, 0.01871684566140175, 0.0030052345246076584, 0.015040040016174316, 0.015261915512382984, -0.0075358678586781025, -0.01075307372957468, -0.023312853649258614, 0.001995895756408572, 0.005233902018517256, -0.01005574781447649, -0.02020658552646637, -0.012512234970927238, -0.0030507983174175024, -0.034739479422569275, -0.0019542938098311424, 0.03160151466727257, 0.023740757256746292, -0.021680478006601334, 0.010016127489507198, 0.0376872643828392, 0.019239839166402817, 0.02565840259194374, 0.01931908167898655, -0.00739719532430172, -0.0174014363437891, 0.022552134469151497, 0.003106267424300313, 0.007591336965560913, -0.0011410778388381004, -0.004520728252828121, -0.025040319189429283, 0.008637324906885624, -0.0260387621819973, -0.0009499076404608786, -0.014041596092283726, -0.024390539154410362, 0.0407935306429863, -0.03331313282251358, -0.01706862263381481, 0.0022900798358023167, 0.04221988096833229, -0.03584885969758034, 0.029984990134835243, -0.024564869701862335, 0.02971556782722473, -0.023503033444285393, 0.013082774356007576, 0.012060558423399925, 0.03372518718242645, 0.013827644288539886, 0.01828894205391407, -0.01416045892983675, -0.006244231481105089, -0.0010766941122710705, -0.007516057696193457, -0.022219320759177208, -0.01866930164396763, 0.001537285395897925, -0.025499919429421425, 0.00506353285163641, -0.018257245421409607, -0.029652174562215805, 0.05229939892888069, 0.012345828115940094, 0.003185509005561471, 0.005887644365429878, 0.0145804388448596, -0.013011456467211246, 0.0034153093583881855, 0.006561197340488434, 0.01208433136343956, -0.009897265583276749, -0.036229219287633896, -0.014944950118660927, 0.029525388032197952, 0.017417285591363907, -0.010198382660746574, 0.027988102287054062, -0.007789440918713808, -0.024992773309350014, 0.008094520308077335, 0.01703692600131035, -0.004326586611568928, 0.052838243544101715, 0.011719820089638233, -0.021062394604086876, -0.0007433844730257988, -0.016735807061195374, -0.013280877843499184, -0.01509550865739584, 0.038511376827955246, -0.02313852310180664, -0.007357574533671141, -0.041078802198171616, -0.0055191717110574245, -0.017971975728869438, 0.02911333180963993, -0.019350778311491013, -0.018320638686418533, 0.011323612183332443, -0.0021038621198385954]",Break the Sequential Dependency of LLM Inference Using Lookahead Decoding.pdf
