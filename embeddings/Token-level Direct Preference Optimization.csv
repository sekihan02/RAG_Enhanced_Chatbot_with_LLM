text,embedding,file
"Direct Preference Optimization with an Offset
Afra Amini Tim Vieira Ryan Cotterell
{afra.amini, ryan.cotterell }@inf.ethz.ch tim.f.vieira@gmail.com
Abstract
Direct preference optimization (DPO) is a
successful fine-tuning strategy for aligning
large language models with human preferences
without the need to train a reward model or
employ reinforcement learning. DPO, as
originally formulated, relies on binary prefer-
ence data and fine-tunes a language model to
increase the likelihood of a preferred response
over a dispreferred response. However, not
all preference pairs are equal. Sometimes,
the preferred response is only slightly better
than the dispreferred one. In other cases, the
preference is much stronger. For instance, if
a response contains harmful or toxic content,
the annotator will have a strong preference
for that response. In this paper, we propose
a generalization of DPO, termed DPO with
an offset (ODPO) , that does not treat every
preference pair equally during fine-tuning.
Intuitively, ODPO requires the difference
between the likelihood of the preferred and
dispreferred response to be greater than an
offset value. The offset is determined based on
the extent to which one response is preferred
over another. Our experiments on various tasks
suggest that ODPO significantly outperforms
DPO in aligning language models, especially
when the number of preference pairs is limited.
https://github.com/rycolab/odpo
1 Introduction
Reinforcement learning from human feedback
(RLHF) is a key building block in training the most
modern large language models. The algorithm
aligns the language model’s responses to human
preferences (Ouyang et al., 2022; Touvron et al.,
2023; Anil et al., 2023; OpenAI et al., 2023). A typ-
ical implementation of RLHF is as follows. First,
humans compare paired responses from a language
model, i.e., they determine which of the responses
is better, e.g., more helpful or less toxic. Second,
a reward model is trained to give higher rewards
to the responses preferred by humans. Lastly, a
reinforcement learning algorithm is used to updatethe model’s parameters to maximize the expected
reward, while not diverging too much from the
model’s initial parameters.
The aforementioned implementation of RLHF,
however, is tedious for two reasons. First, the
reward model is usually a model as large as the
language model itself, which is expensive to
train and store. Second, reinforcement learning
algorithms are known to be very sensitive to the
choice of hyperparameters (Zheng et al., 2023),
and, thus, hard to tune. Therefore, a fruitful line
of work attempts to design alternative simpler
implementations of RLHF (Welleck et al., 2020;
Lu et al., 2022; Zhao et al., 2023).
A highly successful and straightforward alter-
native to RLHF is direct preference optimiza-
tion (DPO; Rafailov et al., 2023). Unlike the con-
ventional implementation of RLHF, DPO does not
train a reward model and sidesteps the use of any
reinforcement learning algorithm. Instead, it fine-
tunes the language model’s weights to maximize
the likelihood of the preference data directly us-
ing the Bradley–Terry model (Bradley and Terry,
1952). Intuitively, each DPO gradient update to the
model’s parameters increases the likelihood of the
preferred response and decreases the likelihood of
the dispreferred response.
However, DPO only takes the ordering between
the model’s responses into account and not the ex-
tent to which one response is preferred over another.
In many settings, the difference in quality between
the two responses is known—either by asking hu-
mans (Stiennon et al., 2020; Touvron et al., 2023)1
or through point-wise scores, e.g., toxicity scores,
sentiment scores, code-based execution scores, etc.
In that context, a natural question is the following:
how can we make use of this information to better
align language models with human preferences?
To answer this question, we propose a new
method, which we term DPO with an offset
1For example, Touvron et al. (2023) ask humans to specify
the extent to which they prefer one output over another, i.e.,
by choosing from: significantly better, better, slightly better,
negligibly better / unsure.arXiv:2402.10571v2  [cs.CL]  6 Jun 2024","[0.012114391662180424, 0.01004591304808855, 0.047437116503715515, 0.013893283903598785, 0.02489069662988186, 0.024090884253382683, 0.011569691821932793, 0.02351170964539051, -0.02857258915901184, 0.019733289256691933, 0.024008145555853844, -0.04136957973241806, -0.017444172874093056, -0.01683741807937622, 0.03811517357826233, -0.04227970913052559, 0.06039958447217941, -0.046692464500665665, 0.009259890764951706, 0.034447070211172104, -0.022877376526594162, -0.021457022055983543, -0.0011393871391192079, 0.039825115352869034, 0.02727634273469448, -0.022380942478775978, 0.01825777441263199, 0.010962937958538532, 0.012038547545671463, -0.06001346930861473, 0.016313403844833374, -0.03599153459072113, -0.054111409932374954, -0.029510298743844032, 0.010818145237863064, -0.003957689739763737, 0.04092830419540405, 0.022946326062083244, -0.0038646082393825054, -0.004285198636353016, -0.0204089917242527, -0.03171667829155922, -0.012603932060301304, 0.013748490251600742, -0.021525971591472626, 0.06244048476219177, 0.0652536153793335, -0.01621687412261963, 0.017733760178089142, 0.009590847417712212, -0.044375769793987274, 0.039466578513383865, -0.04109378159046173, -0.007349994964897633, -0.003616390749812126, 0.007763690780848265, 0.04189359396696091, -0.010266550816595554, 0.04694068059325218, -0.002594217425212264, -0.006657054647803307, -0.03814275190234184, 0.024035725742578506, 0.023966776207089424, -0.005240146536380053, 0.010569927282631397, -0.10750574618577957, 0.0009308155276812613, 0.023332443088293076, 0.012376398779451847, 0.04429302737116814, 0.03527446091175079, 0.04360353574156761, -0.01199028268456459, 0.0030337690841406584, -0.023580659180879593, 0.024904485791921616, 0.08500069379806519, 0.010190705768764019, 0.006688081659376621, -0.020146984606981277, 0.024904485791921616, 0.0035405464004725218, -0.05204293131828308, -0.02657306008040905, -0.021139854565262794, -0.03265438601374626, -0.01723732426762581, -0.0416729561984539, -0.012121286243200302, -0.006956984288990498, -0.028407109901309013, -0.016396142542362213, -0.011486953124403954, 0.024366682395339012, -0.030089473351836205, -0.010790565051138401, 0.0011402489617466927, 0.014534511603415012, 0.009956278838217258, -0.04034912958741188, -0.0456995964050293, -0.0043334634974598885, -0.005012613721191883, 0.05386319011449814, -0.025414710864424706, 0.023332443088293076, 0.025773247703909874, 0.02091921679675579, 0.025525029748678207, -0.02912418358027935, 0.010156231932342052, -0.06701871752738953, 0.016423722729086876, -0.008797930553555489, -0.052732422947883606, -0.07771965116262436, 0.02002287656068802, -0.009494318626821041, -0.018243983387947083, -0.04674762487411499, -0.03717746213078499, 0.02347034029662609, 0.015458432957530022, 0.0037611841689795256, -0.01860252022743225, 0.0017366604879498482, -0.06839770078659058, -0.004323121160268784, -0.024187413975596428, 0.014603461138904095, 0.041231680661439896, 0.0036681026685982943, -0.03450222685933113, -0.06177857145667076, 0.027455611154437065, -0.01621687412261963, 0.012141970917582512, -0.02072615921497345, -0.025924935936927795, -0.019829818978905678, -0.08180144429206848, -0.03588121384382248, 0.006619132589548826, -0.06039958447217941, -0.01730627380311489, -0.004609260708093643, 0.004850583150982857, -0.03665344789624214, 0.06613616645336151, -0.009315050207078457, -0.026076624169945717, -0.01915411464869976, 0.035467520356178284, -0.02444942109286785, -0.0329577662050724, -0.004478256683796644, 0.013348584063351154, -0.0011402489617466927, -0.04090072214603424, -0.016313403844833374, 0.026324842125177383, -0.010893989354372025, -0.003637075424194336, 0.05140859633684158, 0.029372401535511017, -0.03461254760622978, 0.012128181755542755, -0.05005719140172005, -0.03237859159708023, -0.0062743863090872765, 0.0035991533659398556, -0.06161309406161308, -0.008108437061309814, -0.008218755945563316, -0.0031957998871803284, -0.023015275597572327, -0.00162375601939857, 0.0008786726393736899, -0.016161715611815453, 0.01754070073366165, 0.029537878930568695, -0.02032625302672386, 0.026049043983221054, 0.022325782105326653, 0.005653842352330685, -0.025855986401438713, -0.0214708112180233, -0.014493142254650593, 0.032130371779203415, 0.03097202442586422, 0.037591155618429184, 0.08527649194002151, -0.013507167808711529, -0.024187413975596428, -0.03629491105675697, 0.08466973900794983, 0.027758987620472908, -0.03552267700433731, -0.027703827247023582, 0.026642007753252983, 0.017568280920386314, -0.014562091790139675, -0.0729207769036293, -0.005795188248157501, 0.014162185601890087, -0.014906838536262512, 0.02653168886899948, -0.009004778228700161, -0.052732422947883606, 0.009259890764951706, 0.013734700158238411, 0.056262627243995667, 0.03328872099518776, -0.006170962005853653, -0.04605812951922417, -0.009239206090569496, 0.017085636034607887, 0.03196489438414574, 0.020188353955745697, 0.0007886075763963163, -0.007970538921654224, 0.020933005958795547, 0.026476530358195305, -0.04090072214603424, -0.01656162180006504, 0.012073022313416004, -0.03588121384382248, 0.032681968063116074, -0.04550653696060181, 0.040293969213962555, 0.004019744228571653, 0.00959774199873209, -0.008018803782761097, 0.020243514329195023, 0.002442528959363699, 0.006519156042486429, -0.016658149659633636, 0.021015746518969536, -0.039383839815855026, -0.011549007147550583, -0.011080152355134487, 0.026642007753252983, -0.02312559448182583, -0.0214708112180233, 0.023070435971021652, -0.039742376655340195, -0.020284883677959442, -0.013003837317228317, -0.016630571335554123, 0.05242904648184776, -0.013693330809473991, -0.01832672394812107, -0.07402396947145462, -0.051050059497356415, -0.027758987620472908, 0.017526911571621895, 0.008722086437046528, -0.021126065403223038, 0.03811517357826233, -0.014824098907411098, -0.004019744228571653, 0.02233957313001156, 0.032130371779203415, -0.007970538921654224, -0.009315050207078457, -0.01813366450369358, 0.006884587462991476, -0.02751076966524124, 0.020822687074542046, 0.02429773285984993, -0.005546971224248409, -0.014217345044016838, 0.02948272041976452, -0.0297585166990757, -0.03108234331011772, 0.014989577233791351, 0.042334869503974915, -0.016658149659633636, -0.029179342091083527, -0.023566870018839836, -0.0011316303862258792, 0.06541909277439117, -0.0202986728399992, -0.0007502545486204326, -0.005278068594634533, -0.015251584351062775, -0.009721850976347923, -0.013865703716874123, -0.0015858338447287679, -0.009452948346734047, -0.04147989675402641, 0.04625118896365166, -0.07038344442844391, 0.010335499420762062, 0.0018426700262352824, 0.0005197053542360663, -0.048264507204294205, 0.020078035071492195, 0.012872833758592606, 0.06883897632360458, -0.020284883677959442, 0.016892578452825546, -0.0036026008892804384, 0.03411611169576645, -0.029813677072525024, 0.011576587334275246, 0.02406330406665802, 0.01994013600051403, -0.01372091006487608, 0.019733289256691933, 0.011445583775639534, -0.010700930841267109, 0.017871657386422157, -0.011231840588152409, 0.0060192737728357315, 0.0686734989285469, 0.0018254326423630118, -0.01258324645459652, -0.028324371203780174, -0.05107764154672623, -0.03588121384382248, -0.016465092077851295, -0.014410403557121754, 0.042141810059547424, -0.00041800510371103883, 0.006295070983469486, -0.008570397272706032, -0.030723806470632553, -0.015210215002298355, 0.01079745963215828, 0.018519781529903412, 0.012210920453071594, 0.03108234331011772, -0.0025752561632543802, -0.017292484641075134, -0.04291404411196709, 0.032985344529151917, 0.04432060942053795, 0.01955402083694935, -0.06834254413843155, -0.00038870167918503284, -0.007343100383877754, -0.027883095666766167, -0.017761338502168655, -0.022325782105326653, -0.01256256178021431, 0.037618737667798996, -0.004216249566525221, 0.06293691694736481, -0.014410403557121754, 0.010900883935391903, 0.02928966097533703, 0.00503329886123538, 0.0019271328346803784, 0.037232622504234314, 0.009825275279581547, -0.03458496928215027, -0.023622028529644012, -0.005443546921014786, -0.01955402083694935, 0.007322415243834257, -0.01316931564360857, 0.027097074314951897, 0.007929169572889805, -0.039632055908441544, -0.018712839111685753, -6.383196887327358e-05, -0.005060878582298756, -0.018933476880192757, 0.0013600249076262116, 0.05276000127196312, -0.03031011112034321, 0.029896415770053864, -0.07198306918144226, 0.04239002987742424, 0.027924465015530586, 0.009728745557367802, 0.0101493364199996, 0.011769644916057587, 0.009301260113716125, -0.003438846208155155, -0.02708328329026699, -0.01063887681812048, -0.008267020806670189, 0.02406330406665802, -0.017085636034607887, -0.02480795793235302, -0.05416656658053398, -0.026435161009430885, -0.0029027655255049467, -0.006846665404736996, 0.0030458352994173765, 0.03819791227579117, -0.03858402743935585, 0.029262082651257515, -0.04092830419540405, 0.059958308935165405, 0.053008221089839935, 0.032681968063116074, -0.03171667829155922, 0.006315755657851696, -0.061061497777700424, 0.02563534863293171, -0.04881610348820686, -0.00955637264996767, -0.019485071301460266, 0.03968721628189087, 0.013962232507765293, 0.03960447758436203, 0.05924123525619507, -0.029069023206830025, 0.034640125930309296, -0.01817503571510315, 0.01738901250064373, -0.02127775363624096, 0.03152361884713173, -0.00314581161364913, 0.04269340634346008, 0.04914705827832222, 0.012631511315703392, -0.005219461861997843, 0.010314814746379852, -0.06062022224068642, -0.008218755945563316, 0.05562829226255417, -0.029151763767004013, -0.0017702732002362609, 0.02142944186925888, -0.07198306918144226, -0.04407238960266113, 0.056538425385951996, 0.06514329463243484, -0.024863116443157196, -0.05604198947548866, -0.0003171667631249875, -0.013307214714586735, 0.02021593414247036, 0.038060013204813004, -0.02045036107301712, 0.01020449586212635, 0.015720440074801445, -0.008977198973298073, -0.034640125930309296, -0.024311522021889687, 0.008391129784286022, -0.01585833914577961, 0.01864388957619667, 0.0046471827663481236, -0.021291542798280716, -0.02535955235362053, 0.050029609352350235, 0.02723497338593006, 0.008191176690161228, 0.019167905673384666, -0.01621687412261963, 0.04881610348820686, 0.014410403557121754, 0.05138101801276207, 7.85375596024096e-05, 0.02213272452354431, -0.021167434751987457, -0.006322650704532862, -0.019305802881717682, 0.007577527780085802, 0.016892578452825546, 0.008825509808957577, 0.01849220134317875, -0.04707857966423035, 0.0037508418317884207, -0.006033063400536776, -0.01845083199441433, 0.00769474171102047, -0.037784215062856674, -0.03218553215265274, -0.003892187960445881, 0.051325857639312744, -0.0027476295363157988, -0.0033440408296883106, 0.014906838536262512, 0.024463210254907608, -0.040404289960861206, 0.012017862871289253, -0.0009851130889728665, 0.058855120092630386, 0.04448608681559563, 0.04611328989267349, 0.0009109926177188754, -0.04283130541443825, -0.007667161989957094, -0.020795108750462532, -0.05209808796644211, 0.06183373183012009, -0.01617550477385521, -0.005950324237346649, 0.008480763994157314, 0.030585909262299538, 0.012665986083447933, 0.007929169572889805, -0.02920692227780819, 0.038446128368377686, -0.018478412181138992, -0.00901167280972004, 0.04153505712747574, 0.009721850976347923, 0.016616780310869217, 0.059682510793209076, -0.01849220134317875, -0.0071914116851985455, 0.02214651368558407, -0.01310726162046194, -0.006836323067545891, -0.014851679094135761, 0.007963644340634346, -0.0075913178734481335, 0.023690978065133095, -0.047712914645671844, -0.027290131896734238, -0.02735908143222332, -0.0019064480438828468, -0.025483660399913788, -0.006312308367341757, -0.03607427328824997, 0.02795204520225525, 0.00442654499784112, -0.012976258061826229, -0.04757501557469368, -0.0901305228471756, -0.0408179834485054, -0.01295557338744402, 0.028034783899784088, 0.0023770269472151995, 0.007363785058259964, 0.02127775363624096, -0.024504579603672028, -0.030006734654307365, -0.002776932902634144, -0.022008616477251053, -0.030117053538560867, -0.008701401762664318, 0.028517428785562515, 0.0021236382890492678, -0.0020736500155180693, 0.025456080213189125, -0.004112825728952885, -0.017416592687368393, 0.01585833914577961, -0.005098800640553236, -0.005898612551391125, 0.01821640506386757, 0.018230194225907326, -0.012245395220816135, -0.05424930900335312, -0.028034783899784088, -0.015761809423565865, 0.022201674059033394, -0.009252996183931828, -0.004991929046809673, 0.027138443663716316, -0.04263824597001076, -0.0007338791037909687, -0.015610121190547943, -0.011011202819645405, 0.04117652028799057, -0.0007618897361680865, 0.040487028658390045, 0.024008145555853844, -0.0261455737054348, 0.010335499420762062, 0.02567671798169613, -0.022463681176304817, 0.00959774199873209, 0.022601580247282982, -0.02978609688580036, 0.01836809329688549, 0.012865939177572727, 0.006198541726917028, -0.014258714392781258, 0.012803884223103523, 0.0023235913831740618, -0.0026097309309989214, 0.0036026008892804384, 0.011114627122879028, -0.02085026726126671, -0.049946870654821396, -0.007218991406261921, 0.004309331066906452, 0.018919687718153, -0.03155119717121124, 0.017995767295360565, 0.014058762229979038, -0.03069622814655304, 0.01692015677690506, -0.0082394415512681, -0.027248762547969818, 0.025773247703909874, 0.011024992913007736, 0.0006364881992340088, 0.04258308559656143, 0.005808978341519833, 0.013438218273222446, -0.01621687412261963, 0.003947347402572632, -0.049009159207344055, 0.001695290906354785, 0.03254406899213791, -0.0014410403091460466, -0.03168909624218941, 0.012652195990085602, -0.0020529653411358595, -0.002339104888960719, -0.032323431223630905, 0.008411814458668232, -0.03182699531316757, -0.0350814014673233, -0.03179941698908806, -0.026076624169945717, -0.017830288037657738, 0.02166386879980564, -0.029813677072525024, 0.005922744516283274, -0.02214651368558407, 0.02151218056678772, 0.009714956395328045, -0.014313873834908009, -0.03014463372528553, 0.014051866717636585, 0.001446211477741599, 0.006370915099978447, -0.027414239943027496, -0.03428158909082413, -0.01377606950700283, -0.012900413945317268, 0.012879729270935059, 0.014382823370397091, 0.016671940684318542, 0.010514767840504646, -0.005502154119312763, 0.0033992002718150616, -0.03207521513104439, -0.005167749710381031, 0.02472521737217903, 0.026117993518710136, -0.006195094436407089, 0.03803243115544319, -0.022546419873833656, 0.020602049306035042, 0.011783435009419918, -0.0064433119259774685, -0.022325782105326653, -0.01534811407327652, 0.0033405935391783714, 0.0046023656614124775, 0.01743038184940815, 0.028682908043265343, 0.007646477315574884, 0.014658620581030846, -0.008253230713307858, -0.014341454021632671, -0.0010480292839929461, -0.037894535809755325, -0.033978212624788284, -0.01754070073366165, 0.023070435971021652, 0.021677659824490547, 0.0486782044172287, 0.012865939177572727, 0.05209808796644211, 0.009335734881460667, -0.00897030346095562, -0.024587320163846016, 0.00950121320784092, 0.059130918234586716, 0.013438218273222446, -0.019609181210398674, -0.022229254245758057, 0.01675467938184738, -0.024904485791921616, -0.017251113429665565, -0.002730392152443528, -0.024642478674650192, 0.00777058582752943, -0.020795108750462532, -0.05052604526281357, 0.00014727139205206186, -0.0342264324426651, 0.042334869503974915, -0.01179722510278225, -0.017182165756821632, 0.007563738152384758, -0.009259890764951706, -0.011542112566530704, 0.02300148643553257, -0.04672004282474518, 0.022436100989580154, 0.028545008972287178, 0.00832218024879694, 0.06889414042234421, -0.03155119717121124, -0.06370915472507477, 0.0040094018913805485, 0.0062881759367883205, -0.04561685398221016, 0.020629629492759705, -0.037591155618429184, -0.02440805174410343, -0.010825039818882942, 0.03615701198577881, 0.03276470676064491, -0.019967716187238693, -0.004674762487411499, -0.006081328261643648, -0.02068478986620903, 0.027938256040215492, 0.010893989354372025, -0.0029165553860366344, 0.016989106312394142, 0.03670860454440117, 0.014713780023157597, -0.027896886691451073, -0.03734293952584267, -0.0009084069752134383, -0.015872128307819366, 0.014644830487668514, 0.015113686211407185, -0.006260596215724945, -0.026242103427648544, 0.004754053894430399, -0.01954023167490959, 0.014589671045541763, 0.006636369973421097, -0.0025838748551905155, -0.00843939371407032, -0.02442184090614319, -0.009659796953201294, 0.028324371203780174, -0.009528793394565582, 0.007667161989957094, -0.02638000063598156, 0.0049953768029809, 0.01624445430934429, 0.01860252022743225, -0.003038940252736211, -0.004112825728952885, -0.005216014571487904, -0.005557313561439514, 0.002180521609261632, 0.036791346967220306, -0.008859984576702118, 0.023718558251857758, -0.04164537414908409, 0.012665986083447933, -0.006374362390488386, -0.00024046067846938968, 0.01915411464869976, -0.010569927282631397, 0.00104544369969517, -0.0034147140104323626, -0.01692015677690506, 0.0035543362610042095, 0.004423097241669893, 0.014699989929795265, -0.016340984031558037, 0.02182934805750847, -0.005502154119312763, -0.007212096359580755, -0.05278758332133293, -0.027110863476991653, 0.01001143828034401, -0.007108672522008419, -0.007577527780085802, 0.013996707275509834, -0.00255629513412714, 0.019181694835424423, 0.05267726257443428, -0.0065881055779755116, 0.008563502691686153, -0.01798197627067566, 0.002383921993896365, -0.00783263985067606, -0.025566399097442627, -0.02449079044163227, 0.02653168886899948, -0.03527446091175079, 0.01071472093462944, 0.0005024680285714567, 0.003943899646401405, -0.04255550727248192, 0.03905288130044937, -0.029510298743844032, -0.031413301825523376, 0.028682908043265343, -0.01258324645459652, 0.007274150848388672, 0.008708296343684196, 0.03182699531316757, -0.03080654703080654, -0.0920611023902893, -0.026352422311902046, 0.030723806470632553, -0.0018461174331605434, -0.02261536940932274, -0.019016215577721596, 0.057090017944574356, 0.004064561333507299, -0.013969128020107746, -0.033619675785303116, -0.00018928736972156912, -0.020105615258216858, -0.00010633274359861389, -0.05786225199699402, -0.00904614757746458, -0.03637764975428581, -0.0023149726912379265, 0.0035888110287487507, 0.012073022313416004, -0.02072615921497345, -0.045782335102558136, 0.003637075424194336, -0.015720440074801445, -0.0015841100830584764, -0.024987226352095604, 0.03897014260292053, 0.018740419298410416, -0.023291071876883507, -0.009128887206315994, 0.014961997978389263, -0.022394731640815735, -0.021401861682534218, -0.0021184671204537153, 0.016230665147304535, -0.015113686211407185, -0.018864527344703674, -0.000324277178151533, -0.007639582268893719, -0.010556137189269066, 0.016933947801589966, 0.02300148643553257, -0.02421499416232109, 0.03190973401069641, -0.03199247270822525, 0.01020449586212635, -0.04396207258105278, 0.013789859600365162, -0.018299143761396408, -0.0069121671840548515, -0.012838358990848064, 0.03243374824523926, 0.009956278838217258, -0.0070673031732439995, -0.012252289801836014, 0.018781788647174835, 0.004047323949635029, 0.01840946264564991, 0.01418976578861475, 0.0010488912230357528, -0.022477470338344574, -0.008163596503436565, 0.019774658605456352, 0.010004542768001556, 0.006908719427883625, -0.032323431223630905, -0.004381727892905474, 0.010356184095144272, 0.01664436049759388, -0.013569221831858158, -0.051243118941783905, -0.021484600380063057, 0.027055704966187477, -0.012838358990848064, 0.047244057059288025, -0.021139854565262794, -0.025028595700860023, 0.05033298581838608, 0.00718451663851738, -0.042996782809495926, 0.03386789560317993, 0.05946187302470207, -0.009225415997207165, 0.0239116158336401, 0.03466770797967911, 0.02072615921497345, 0.03042043000459671, -0.01656162180006504, 0.011349054053425789, -0.02166386879980564, 0.02806236408650875, 0.03293018415570259, -0.01798197627067566, 0.008060173131525517, -0.012700460851192474, -0.02829679101705551, -0.023442761972546577, -0.014493142254650593, 0.01428629457950592, 0.03116508200764656, -0.019333383068442345, 0.052346307784318924, 0.02598009631037712, -0.039825115352869034, -0.014755149371922016, 0.014562091790139675, 0.0019564363174140453, 0.00013822178880218416, -0.01083193439990282, 0.027538349851965904, -0.005116038024425507, 0.0007804198539815843, 0.02202240563929081, -0.016106555238366127, 0.017651019617915154, -0.02818647213280201, 0.04189359396696091, 0.03367483615875244, 0.0276348777115345, 0.0335920974612236, 0.015306743793189526, -0.0010178639786317945, 0.030282530933618546, -0.009687376208603382, 0.01911274529993534, -0.004088693298399448, -0.018202614039182663, -0.0020822687074542046, 0.0029458587523549795, -0.04098346084356308, -0.010790565051138401, 0.03428158909082413, 0.009059937670826912, 0.018740419298410416, 0.0013436494627967477, 0.0042024594731628895, 0.012397083453834057, 0.04534105956554413, 0.008087752386927605, -0.04820935055613518, 0.0408179834485054, 0.014003602787852287, 0.028048574924468994, 0.02708328329026699, 0.011852384544909, -0.00885308999568224, 0.01828535459935665, 0.025966305285692215, -0.0437965951859951, -0.0050401934422552586, 0.01489304844290018, 0.01660299114882946, 0.0002572670637164265, 0.011755854822695255, -0.002449423773214221, 0.02931724116206169, 0.02723497338593006, 0.02025730349123478, -0.009997648186981678, 0.00470923725515604, -0.01896105706691742, 0.00941847451031208, 0.00017075725190807134, -0.012693565338850021, -0.01613413542509079, 0.0580277293920517, -0.01802334561944008, 0.0044644670560956, -0.0033405935391783714, -0.008901353925466537, -0.010914674028754234, 0.009053043089807034, -0.007212096359580755, -0.011183575727045536, 0.009073727764189243, 0.014300084672868252, 0.0401836521923542, -0.0032216559629887342, 0.04393449425697327, -0.013417533598840237, 0.03990785405039787, 0.0177475493401289, 0.030006734654307365, -0.005939981900155544, -0.01868525892496109, 0.03304050490260124, -0.014272504486143589, -0.01063887681812048, -0.0050401934422552586, 0.006450206972658634, 0.02442184090614319, 0.026986755430698395, 0.029648197814822197, 0.0016677111852914095, 0.035660576075315475, 0.003899082774296403, -0.027538349851965904, -0.003231998300179839, 0.04368627443909645, 0.01605139672756195, -0.037039563059806824, -0.05306337773799896, 0.04870578274130821, 0.013838124461472034, -0.01003212295472622, -0.04125925898551941, 0.026076624169945717, 0.0005412519676610827, -0.016492672264575958, 0.0010014885338023305, 0.04026639088988304, -0.005029851105064154, 0.03731536120176315, -0.04266582429409027, 0.008018803782761097, 0.014038076624274254, -0.05808288976550102, -0.017251113429665565, 0.03042043000459671, -0.028820807114243507, -0.00040443072794005275, -0.004019744228571653, -0.018423251807689667, 0.020009085536003113, 0.0399630144238472, -0.021167434751987457, -0.016492672264575958, 0.04917464032769203, 0.02104332484304905, 0.01628582365810871, 0.009632216766476631, -0.03552267700433731, 0.017002897337079048, -0.021263962611556053, 0.01544464286416769, 0.0018512886017560959, -0.02995157428085804, -0.0021822452545166016, 0.011928228661417961, -0.018464621156454086, 0.005419414956122637, 0.027979625388979912, 0.02582840621471405, -0.002644205465912819, -0.002740734489634633, -0.002992399502545595, 0.0029027655255049467, -0.0009989029495045543, 0.03309566155076027, -0.006570868194103241, -0.01860252022743225, 0.004288646392524242, -0.005529733840376139, 0.01487925834953785, 0.0053952825255692005, 0.012486717663705349, -0.02072615921497345, 0.008735875599086285, 0.04090072214603424, 0.039273519068956375, 0.006657054647803307, -0.042169392108917236, 0.024504579603672028, 0.01305210217833519, -0.016272034496068954, -0.024201203137636185, -0.01672709919512272, -0.0018168139504268765, 0.024973435327410698, 0.038446128368377686, -0.007729216478765011, -0.01911274529993534, 0.016809837892651558, -0.009866644628345966, 0.044761884957551956, 0.026090415194630623, 0.014589671045541763, 0.035936374217271805, -0.0035146905574947596, 0.018919687718153, -0.008163596503436565, 0.0016711585922166705, 0.001132492208853364, -0.028089944273233414, -0.004071455914527178, 0.011886859312653542, -0.015789389610290527, 0.005491811782121658, -0.00020889482402708381, -0.010583717375993729, 0.03237859159708023, 0.032875023782253265, 0.05306337773799896, -0.03133055940270424, 0.006605342961847782, 0.005019508767873049, -0.0006334716454148293, -0.00625025387853384, -0.004261066671460867, 0.005912402179092169, -0.016230665147304535, 0.030751386657357216, 0.016423722729086876, 0.01738901250064373, 0.011659326031804085, 0.038170330226421356, 0.008591082878410816, -0.0030854810029268265, -0.007743006106466055, -0.015927288681268692, -0.028269212692975998, 0.006284728646278381, -0.0029975706711411476, 0.04101104289293289, 0.015030946582555771, 0.00558489328250289, -0.010976728051900864, -0.018230194225907326, -0.010218285955488682, -0.028627747669816017, 0.02076752856373787, 0.023884037509560585, 0.005998589098453522, 0.013555431738495827, 0.03877708688378334, -0.01915411464869976, -0.0125418771058321, 0.004592023324221373, 0.010101072490215302, -0.008005013689398766, -0.0005636605201289058, -0.01006659772247076, 0.024821747094392776, -0.0035336515866219997, -0.014134606346487999, -0.042059071362018585, 0.003238893346861005, -0.05262210592627525, 0.0013358925934880972, -0.014920627698302269, -0.026904016733169556, 0.06001346930861473, 0.014272504486143589, 0.01872663013637066, -0.015844548121094704, -0.02111227437853813, 0.0075361584313213825, 0.021305333822965622, 0.020436571910977364, 0.004998824093490839, -0.010707826353609562, 0.07898831367492676, -0.04429302737116814, -0.005088458303362131, 0.0068811397068202496, -0.021415652707219124, 0.02857258915901184, -0.03458496928215027, -0.005312543362379074, -0.00826012622565031, 0.02225683256983757, 0.01116978656500578, 0.015610121190547943, -0.01919548399746418, 0.0004960040096193552, 0.003968032076954842, -0.017002897337079048, -0.013162421062588692, 0.04393449425697327, 0.029069023206830025, 0.0021339808590710163, -0.005291858687996864, 0.051877450197935104, -0.020974377170205116, 0.00570210674777627, 0.021208804100751877, 0.009866644628345966, -0.015072316862642765, -0.006732898764312267, 0.017733760178089142, 0.0235944502055645, -0.021801767870783806, -0.042417608201503754, -0.03270954638719559, 0.022201674059033394, -0.036129433661699295, 0.0015349837485700846, -0.013058996759355068, 0.016671940684318542, -0.003671550191938877, -0.023622028529644012, 0.0017995766829699278, -0.006905272137373686, -0.0020495178177952766, 0.014465562999248505, 0.002018490806221962, 0.02327728271484375, 0.0028476060833781958, 0.0015634252922609448, 0.013231370598077774, 0.01372091006487608, 0.01703047566115856, 0.016078976914286613, 0.02123638428747654, -0.010190705768764019, -0.00828081090003252, -0.017320062965154648, -0.0163685642182827, 0.023966776207089424, 0.035577837377786636, 0.02928966097533703, -0.008018803782761097, 0.053173698484897614, -0.03690166398882866, 0.007398259826004505, 0.026076624169945717, -0.009949383325874805, 0.00448515173047781, 0.023180752992630005, -0.021870717406272888, 0.0130727868527174, -0.019995296373963356, -0.010880199261009693, -0.025180283933877945, -0.015017157420516014, 0.018188824877142906, 0.0006395047530531883, -0.01589970849454403, 0.00788779929280281, 0.00344918854534626, -0.005733134225010872, 0.00019295030506327748, -0.01692015677690506, -0.014699989929795265, 0.019609181210398674, -0.011376634240150452, -0.011452478356659412, -0.01081124972552061, 0.0048712678253650665, -0.030392849817872047, 0.04277614504098892, -0.009997648186981678, 0.017926817759871483, 0.026986755430698395, -0.00957705732434988, -0.013576116412878036, -0.029069023206830025, 0.0029562010895460844, 0.025662928819656372, 0.0034767682664096355, 0.03190973401069641, -0.022505050525069237, 0.006460549309849739, -0.023208333179354668, 0.02425636351108551, 0.008839299902319908, -0.005591787863522768, -0.028172682970762253, 0.001899553113617003, -0.0011755855521187186, 0.0058744801208376884, 0.008198071271181107, -0.0372050404548645, 0.04291404411196709, 0.011438688263297081, -0.026035254821181297, 0.0200918260961771, -0.001818537712097168, 0.054580263793468475, 0.01683741807937622, -0.0014324216172099113, -0.009694271720945835, -0.004850583150982857, 0.0005261693149805069, 0.009887329302728176, -0.0040783509612083435, 0.00470923725515604, -0.000999764772132039, -0.0022236148361116648, -0.029344821348786354, 0.014162185601890087, 0.0011316303862258792, -0.008735875599086285, 0.013955337926745415, -0.011804119683802128, -0.009804590605199337, 0.0251940730959177, 0.017719969153404236, -0.040955882519483566, -0.01762344129383564, -0.01927822455763817, 0.0034681495744735003, -0.0031113370787352324, -0.019678128883242607, 0.010487188585102558, -0.012155761010944843, -0.028765646740794182, 0.013672646135091782, -0.02857258915901184, 0.03248890861868858, 0.03505382314324379, 0.017485542222857475, -0.003799106227234006, -0.02442184090614319, 0.003688787342980504, -0.0013289976632222533, -0.024201203137636185, -0.019485071301460266, -0.02472521737217903, -0.027193602174520493, 0.018988637253642082, 0.020050454884767532, -0.012790095061063766, 0.017085636034607887, 0.012148866429924965, 0.0348607636988163, -0.01832672394812107, -0.02025730349123478, -0.041866011917591095, 0.0050401934422552586, 0.0239116158336401, -0.020284883677959442, 0.005367702804505825, 0.0246562696993351, -0.007894694805145264, -0.022739479318261147, -0.015458432957530022, -0.032792285084724426, -0.00011215034464839846, -0.00031996783218346536, 0.015058526769280434, -0.020160773769021034, 0.012534982524812222, 0.015789389610290527, 0.014313873834908009, -0.023456551134586334, 0.025759458541870117, 0.013941547833383083, 0.013527852483093739, 0.008211861364543438, 0.02672474831342697, 0.01083193439990282, -0.021015746518969536, 0.016396142542362213, 0.0031492591369897127, 0.0369844026863575, 0.036212172359228134, 0.025456080213189125, 0.0009066832717508078, 0.013845019042491913, 0.0010592335602268577, -0.024559739977121353, -0.0008842747192829847, 0.011349054053425789, -0.0020564128644764423, 0.004654077813029289, -0.012728040106594563, 0.01126631535589695, -0.010969833470880985, 0.02378750778734684, -0.027690038084983826, 0.00841870903968811, -0.03262680768966675, 0.04454124718904495, 0.0021391520276665688, 0.022505050525069237, 0.007232781499624252, -0.003778421552851796, 0.023056644946336746, -0.05209808796644211, -0.013431322760879993, -0.013017627410590649, -0.03348178043961525, 0.032213110476732254, 0.014727570116519928, -0.024477001279592514, 0.02472521737217903, 0.007205201778560877, 0.03988027200102806, -0.00904614757746458, 0.012914203107357025, -0.0030027418397367, 0.009901119396090508, -0.013803649693727493, 0.01497578714042902, -0.003083757357671857, -0.005057430826127529, -0.0059192972257733345, -0.007322415243834257, 0.00897030346095562, 0.003213037271052599, -0.03748083859682083, 0.03364725783467293, -0.01683741807937622, -0.028489850461483, -0.03144088014960289, 0.06790126860141754, 0.0013626104919239879, 0.009390894323587418, -0.007156936917454004, 0.024242572486400604, 0.009156466461718082, -0.007639582268893719, -0.02735908143222332, -0.018119875341653824, 0.032047633081674576, -0.012610826641321182, -0.023856457322835922, -0.007729216478765011, -0.016547830775380135, 0.05248420685529709, -0.00686045503243804, -0.01006659772247076, 0.004609260708093643, 0.01016312651336193, -0.02657306008040905, 0.026393791660666466, -0.0033285273239016533, 0.010273445397615433, 0.0071914116851985455, -0.020229723304510117, 0.01594107784330845, 0.015127476304769516, -0.011824804358184338, -0.02865532785654068, 0.0012402255088090897, 0.02527681179344654, 0.041397158056497574, -0.008115332573652267, 0.0070810928009450436, -0.02414604462683201, 0.026200734078884125, -0.014272504486143589, -0.02602146565914154, -0.0034026477951556444, -0.019650550559163094, 0.013734700158238411, 0.0003141502384096384, 0.001213507610373199, -0.02967577800154686, 0.015251584351062775, -0.020202144980430603, 0.011528322473168373, 0.015279164537787437, -0.017361432313919067, -0.01743038184940815, 0.03632248938083649, 0.01487925834953785, -0.014072551392018795, -0.04801629111170769, 0.004230039194226265, -0.0057193441316485405, -0.003747394308447838, 0.015610121190547943, 0.019995296373963356, 0.01548601221293211, 0.04346563667058945, -0.007046618033200502, 0.042610667645931244, -0.03618459030985832, 0.004261066671460867, 0.014865468256175518, 0.0053952825255692005, -0.02032625302672386, 0.037149880081415176, 0.013279634527862072, 0.026517899706959724, -0.008866880089044571, 0.02045036107301712, -0.011928228661417961, 0.00040550806443206966, -0.020974377170205116, -0.010176916606724262, -0.01794060692191124, 0.011762750335037708, 0.03135814145207405, 0.012914203107357025, 0.008715190924704075, 0.01656162180006504, 0.012059232220053673, -0.029372401535511017, 0.03968721628189087, 0.02312559448182583, 0.023622028529644012, 0.032406169921159744, 0.02068478986620903, 0.017913026735186577, 0.0015539447776973248, 0.009411578997969627, 0.007177622057497501, -0.017223535105586052, -0.015417062677443027, 0.0001869172410806641, 0.01802334561944008, 0.02661442942917347, 0.009935594163835049, 0.008391129784286022, -0.0002221460163127631, 0.01743038184940815, -0.007549948059022427, 0.020353833213448524, 0.008480763994157314, 0.0335920974612236, 0.013314109295606613, -0.012914203107357025, -0.007998118177056313, 0.013948443345725536, -0.02104332484304905, -0.03905288130044937, -0.02123638428747654, 0.0017357985489070415, -0.02336002141237259, -0.026117993518710136, 0.0030716911423951387, 0.02049173042178154, -0.015803178772330284, -0.01018381118774414, -0.03088928572833538, -0.02189829759299755, 0.004850583150982857, -0.009570162743330002, 0.02995157428085804, 0.06475718319416046, 0.020905427634716034, -0.0009265061817131937, -0.015913497656583786, 0.003981822170317173, -0.009177151136100292, 0.0031940762419253588, 0.03428158909082413, -0.010721615515649319, -3.493251642794348e-05, -0.016037607565522194, -0.010287235490977764, -0.019360963255167007, 0.0054504419676959515, 0.008453183807432652, -0.01246603298932314, 0.026173153892159462, -0.00955637264996767]",Token-level Direct Preference Optimization.pdf
"
  
!
""
""
!
""
""Figure 1: ODPO takes into account the extent to which one output should be preferred over another. The model
has to put more probability mass on the preferred output compared to the dispreferred output by an offset that is
determined based on how much the winning output is preferred over the losing output.
(ODPO). ODPO is a generalization of DPO that in-
corporates the difference between responses when
modeling preference data. The intuition behind
ODPO is simple; it requires the language model to
increase the likelihood of the preferred responses
compared to the dispreferred responses by an
offset that is determined based on the difference
between their associated reward values. Therefore,
the larger the reward of the preferred response in
comparison to the dispreferred response, the higher
the likelihood needs to be over the likelihood of
the dispreferred response. We further show that
when the offset is set to zero, ODPO is equivalent
to DPO. This process is illustrated in Fig. 1.
In our experiments, we fine-tune language
models of various sizes with DPO and ODPO
and compare the two methods. In cases where a
ground-truth reward function is given, we measure
two competing metrics: (i) the average reward
associated with the generations from the fine-tuned
model, and (ii) the KL divergence between the
language model before and after the fine-tuning.
Based on the results of sentiment and toxicity
control tasks, we observe that ODPO more often
appears on the Pareto frontier of reward and KL
compared to DPO. We then apply ODPO to a
summarization task, where we use the scores
given by humans on a Likert scale to define an
offset between the two summaries. We observe
that on average and across different sampling
temperatures, ODPO results in a higher win rate
over human-written summaries compared to DPO.
2 Preliminaries
Given a prompt x∈Σ∗, a language model πθis
a distribution over the responses y∈Σ∗, where Σ
is the alphabet.2As is standard, we parameterize
the conditional distribution over responses given a
2An alphabet is a finite, non-empty set.prompt as an autoregressive language model πθ(y|
x)parameterized by θas,
πθ(y|x) =
πθ(EOS|y,x)TY
t=1πθ(yt|y<t,x),(1)
where EOS/∈Σis a distinguished end-of-sequence
token. To deploy a language model to a down-
stream task, it is usually necessary to additionally
fine-tune it on high-quality data. Given a dataset of
prompts and desired responses (x,y)∼ D SFT, the
standard fine-tuning objective (to be maximized) is
simply the log-likelihood of DSFT
JML(θ) = E
(x,y)∼D SFTh
logπθ(y|x)i
.(2)
We use πSFTto refer to the language model fine-
tuned with this objective on DSFT.
Such a fine-tuning approach can be effective
for solving downstream tasks with language mod-
els. However, there is a disparity between the
maximum-likelihood objective and the goal of the
downstream task, which is to leverage the lan-
guage model to generate high-quality responses, as
judged by humans. This misalignment arises partly
because the maximum-likelihood objective, Eq. (2),
fails to distinguish between major and minor er-
rors. For instance, when fine-tuning a language
model to perform summarization, a significant er-
ror might involve hallucination, while a minor one
might involve a failure to employ the appropriate
synonyms (Stiennon et al., 2020). Training with
the maximum-likelihood objective encourages the
model to assign nonzero probability mass to all
responses in DSFT, even those of lower quality.
To address this issue, one can optimize the ex-
pected reward of language model generations in-
stead of using the maximum-likelihood objective.
Consider a reward function r(x,y), estimated from
quality assessments performed by humans. The
reward function assigns real values to prompt–
response pairs; we will discuss in §3 how such a
reward model can be learned from human feedback.
Our objective is to make sure that the responses
generated by the language model have high quality.
Therefore, we can directly optimize the expected
reward of the responses generated by the language
model,
JRL(θ) = E
x∼D,y∼πθ(·|x)h
r(x,y)i
,","[0.018709175288677216, 0.009334934875369072, 0.034771814942359924, -0.0029265841003507376, 0.0027071312069892883, 0.027854135259985924, 0.019678698852658272, 0.03149639815092087, -0.015315844677388668, 0.02693701907992363, 0.04968150705099106, -0.015826808288693428, -0.026019902899861336, -0.009321833029389381, 0.02153913490474224, -0.044598061591386795, 0.047506630420684814, -0.02858782932162285, 0.01442493125796318, 0.032439716160297394, -0.021866675466299057, -0.03841407597064972, -0.016665315255522728, 0.028980879113078117, 0.02774932235479355, 0.003661914961412549, 0.0007545739063061774, 0.0334092415869236, 0.023451976478099823, -0.027723118662834167, 0.008928783237934113, -0.03254453092813492, -0.03964563459157944, -0.036841876804828644, 0.011883208528161049, -0.01690114475786686, 0.028718845918774605, 0.03757556900382042, -0.013140968047082424, 0.0007267328910529613, -0.021263999864459038, -0.05138472467660904, -0.0338284932076931, 0.019259445369243622, -0.013494713231921196, 0.039121564477682114, 0.051017876714468, -0.017241789028048515, 0.014385625720024109, 0.021788066253066063, -0.04617026075720787, 0.05696603283286095, -0.0010448576649650931, 0.003298343624919653, 0.023962941020727158, -0.012636554427444935, 0.03862370178103447, 0.005116199608892202, 0.023320959880948067, -0.038964346051216125, 0.01835543103516102, -0.04074617102742195, 0.018630564212799072, 0.02419877238571644, -0.018630564212799072, 0.005869545042514801, -0.09726674854755402, -0.004749353043735027, 0.005407711490988731, 0.027068035677075386, 0.052747294306755066, 0.017896872013807297, 0.04014349728822708, -0.007762735243886709, -0.014241508208215237, -0.021368812769651413, 0.032675549387931824, 0.04155847430229187, 0.03346164897084236, -0.016966653987765312, 0.002905293833464384, 0.00021515387925319374, 0.025102786719799042, -0.04881679639220238, -0.022036997601389885, -0.05028418451547623, -0.030553078278899193, -0.027827933430671692, -0.027906542643904686, -0.01336369663476944, -0.028116168454289436, -0.022823097184300423, 0.0010342125315219164, -0.002811944345012307, 0.04402158781886101, -0.02278379164636135, -0.0031591386068612337, -0.004841064568608999, 0.013979475013911724, -0.000614959339145571, -0.011575319804251194, -0.06063449755311012, -0.012813426554203033, -0.014752472750842571, 0.016652213409543037, 0.003946876153349876, 0.004634713288396597, 0.009125308133661747, -0.00019662729755509645, -0.006446018349379301, -0.05361200496554375, 0.016455689445137978, -0.05248526111245155, 0.022076303139328957, -0.005951430648565292, -0.06875752657651901, -0.049838725477457047, 0.023085130378603935, 0.006446018349379301, -0.015735097229480743, -0.03091992437839508, 0.012924790382385254, 0.003494868753477931, 0.011450853198766708, -0.01484418474137783, -0.003110007382929325, 0.015787504613399506, -0.057542502880096436, 0.004235112573951483, 0.003065789118409157, 0.017503822222352028, 0.01014723815023899, -0.004601959139108658, -0.05822379142045975, -0.06985806673765182, 0.01838163286447525, -0.01982281729578972, -0.0036357115022838116, 0.0026236081030219793, -0.006085722707211971, 0.00552890170365572, -0.04590822756290436, -0.05990080535411835, 0.012394173070788383, -0.0518563836812973, -0.040405530482530594, -0.006917678285390139, -0.012053529731929302, -0.05175156891345978, 0.04902642220258713, 0.022050099447369576, -0.027696916833519936, -0.026190225034952164, 0.05272109434008598, 0.002325545297935605, -0.037680383771657944, -0.019272547215223312, 0.041794303804636, 0.0013371885288506746, -0.028325796127319336, -0.008227844722568989, 0.028325796127319336, -0.0030363104306161404, -0.024618025869131088, 0.0204779002815485, 0.034771814942359924, -0.04619646444916725, 0.007179711479693651, -0.050467606633901596, -0.026832206174731255, -0.009158062748610973, -0.0014231681125238538, -0.05028418451547623, -0.02864023484289646, -0.004497145768254995, -0.03587235510349274, -0.03880712762475014, -0.011516361497342587, -0.0037929315585643053, -0.006747356615960598, -0.013835356570780277, 0.017844464629888535, -0.02987179160118103, 0.008299903944134712, 0.011660479940474033, 0.007749633863568306, -0.023674705997109413, -0.011483607813715935, -0.008699504658579826, 0.013704339973628521, 0.04247559234499931, -0.0011242864420637488, 0.09139720350503922, -0.019259445369243622, -0.009983466938138008, -0.014948997646570206, 0.0886196494102478, 0.038099635392427444, -0.0287974551320076, 0.0003869085048791021, 0.02566615864634514, 0.04113922268152237, -0.005237389821559191, -0.09150201827287674, -0.013127866201102734, 0.03401191905140877, -0.012289360165596008, 0.011372243985533714, -0.022809995338320732, -0.02840440534055233, 0.02005864679813385, 0.03891193866729736, 0.0722687765955925, 0.025849580764770508, -0.00805752258747816, -0.01632467284798622, -0.022299030795693398, 0.036239199340343475, 0.030133824795484543, 0.03547930344939232, -0.01253829151391983, 0.0350862555205822, 0.04737561568617821, 0.020988864824175835, -0.03450978174805641, 0.000188541118404828, 0.029714571312069893, -0.02151293121278286, 0.025011075660586357, -0.043340303003787994, 0.06000561639666557, 0.005961256567388773, -0.02210250496864319, -0.023058926686644554, 0.006832517217844725, -0.017451414838433266, 0.003160776337608695, -0.021028168499469757, 0.005502698477357626, -0.03283276781439781, -0.0004548733704723418, 0.02691081538796425, 0.03094612807035446, 0.00479520857334137, 0.027094239369034767, 0.03361886739730835, -0.03230870142579079, -0.025561345741152763, -0.004700221586972475, -0.02043859474360943, 0.04693015664815903, -0.02924291230738163, -0.0022616744972765446, -0.037103909999132156, -0.05279970169067383, -0.014018779620528221, 0.005961256567388773, -0.01589231751859188, -0.026766696944832802, 0.024552516639232635, -0.001776913064531982, 0.003168964758515358, 0.00889602955430746, 0.043366506695747375, -0.006701500620692968, -0.0225741658359766, -0.03503384813666344, -0.009557663463056087, 0.007939607836306095, -0.0038158593233674765, 0.014293914660811424, -0.03031724877655506, -0.03825685754418373, 0.020766135305166245, -0.01940356381237507, -0.051279909908771515, 0.02064822055399418, 0.02966216579079628, -0.029295319691300392, -0.030369656160473824, -0.01836853101849556, 0.001948872348293662, 0.05638955906033516, -0.003072340041399002, -0.0017932901391759515, -0.014307016506791115, -0.006439467426389456, -0.003182066371664405, -0.009701781906187534, -0.031077144667506218, -0.018656767904758453, -0.03492903336882591, 0.0219452865421772, -0.062154289335012436, 0.01117571908980608, -0.0007091275183483958, 0.0011046340223401785, -0.02984558790922165, 0.028771251440048218, 0.02211560681462288, 0.06870511919260025, 0.013717440888285637, 0.0014280813047662377, -0.004700221586972475, 0.006121752317994833, -0.013809152878820896, 0.023884331807494164, 0.011752191931009293, 0.004218735732138157, -0.0246704313904047, 0.02882365882396698, 0.009623171761631966, -0.0018538853619247675, 0.026688087731599808, 0.008155785501003265, 0.014660760760307312, 0.07499392330646515, 0.01583991013467312, -0.0009425008902326226, -0.016455689445137978, -0.041008204221725464, -0.014791777357459068, -0.01515862438827753, -0.004218735732138157, 0.030369656160473824, 0.004559378605335951, -0.01042892411351204, 0.01652119681239128, -0.019914528355002403, -0.014307016506791115, -0.010081729851663113, 0.02567926049232483, -0.01252518966794014, 0.053166549652814865, -0.0037470755632966757, -0.02463112585246563, -0.05112269148230553, 0.04803069680929184, 0.03403812274336815, 0.022665876895189285, -0.06535109877586365, 0.005545279011130333, -0.01838163286447525, -0.011902861297130585, -0.013226129114627838, -0.015774402767419815, -0.002245297422632575, 0.044991109520196915, 0.02444770373404026, 0.036344014108181, -0.0007234574877656996, -0.01513242069631815, 0.024526312947273254, 0.018735378980636597, 0.017385907471179962, 0.03361886739730835, 0.00928907934576273, -0.03152260184288025, -0.02068752609193325, -0.018538853153586388, -0.029950402677059174, -0.026779798790812492, 0.010821973904967308, 0.03899054974317551, -0.006341204978525639, -0.018525751307606697, 0.004572480451315641, -0.009531459771096706, -0.005591134540736675, -0.005021212622523308, -0.019167732447385788, 0.019966933876276016, -0.05659918487071991, 0.04071996733546257, -0.06498424708843231, 0.03571513295173645, 0.012708613649010658, 0.0034097079187631607, 0.005234114360064268, 0.01473937090486288, 0.017621736973524094, 0.020818542689085007, -0.02440839819610119, -0.004261315800249577, -0.008273700252175331, 0.025417227298021317, 0.004723149351775646, -0.03390710428357124, -0.03453598544001579, -0.011516361497342587, -0.009695230983197689, -0.0032737781293690205, -0.012905138544738293, 0.0443098247051239, -0.027068035677075386, 0.020962661132216454, -0.060215242207050323, 0.07850516587495804, 0.060686904937028885, 0.05555105209350586, -0.03524347394704819, 0.007998565211892128, -0.04755903780460358, 0.014162898063659668, -0.03068409487605095, -0.025220701470971107, 0.0181720070540905, 0.020635118708014488, 0.02339957095682621, 0.03849268704652786, 0.04486009478569031, -0.027670713141560555, 0.021224694326519966, -0.02446080558001995, 0.022456251084804535, -0.03241351619362831, 0.04674673452973366, 0.008856724016368389, 0.03778519481420517, 0.048528559505939484, -0.003933774307370186, -0.03212527930736542, -0.007127304561436176, -0.03954081982374191, -0.014346321113407612, 0.05570827051997185, -0.020556509494781494, -0.0077758370898664, 0.02443460188806057, -0.06781420856714249, -0.027094239369034767, 0.06377889961004257, 0.06267835944890976, -0.04470287635922432, -0.04192532226443291, -0.027251459658145905, 0.01857815869152546, -0.022849300876259804, 0.013121315278112888, -0.047952085733413696, 0.019377360120415688, 0.0003953017294406891, -0.02507658302783966, -0.007585863117128611, -0.026150919497013092, 0.028483016416430473, 0.022718284279108047, 0.015080014243721962, 0.023307858034968376, -0.008823970332741737, -0.0049393270164728165, 0.03301618993282318, 0.0538216307759285, 0.0075203548185527325, 0.006911127362400293, -0.046903952956199646, 0.06781420856714249, -0.0013519278727471828, 0.04037932679057121, 0.018303023651242256, 0.003360576694831252, 0.009721433743834496, 0.00300191855058074, -0.03487662598490715, -0.004886920563876629, 0.03450978174805641, 0.01692734844982624, 0.006665471009910107, -0.03867610916495323, 0.03613438829779625, -0.0143987275660038, -0.023910535499453545, 0.016861841082572937, -0.046903952956199646, -0.022023895755410194, -0.003452288219705224, 0.03817824646830559, -0.02170945517718792, 0.013330942019820213, -0.010258601978421211, 0.009852450340986252, -0.029714571312069893, 0.01056649163365364, -0.010468228720128536, 0.04632747918367386, 0.0584334172308445, 0.06079171597957611, -0.019390461966395378, -0.04134884849190712, -0.00791995506733656, 0.006655645091086626, -0.0617874450981617, 0.03597716614603996, -0.01450354140251875, 0.006619615480303764, -0.004755903501063585, 0.020412391051650047, 0.0334092415869236, 0.006115201395004988, -0.009721433743834496, 0.030579281970858574, -0.019796613603830338, -0.02526000700891018, 0.03702529892325401, 0.016861841082572937, 0.025377921760082245, 0.0538216307759285, -0.009433197788894176, -0.006488598883152008, 0.011319836601614952, -0.01838163286447525, -0.0003699172812048346, -0.013029604218900204, 0.022823097184300423, -0.024565618485212326, 0.005853168200701475, -0.051515739411115646, -0.010671304538846016, -0.024984871968626976, 0.012138690799474716, -0.01316062081605196, -0.005604236386716366, -0.031260568648576736, 0.009308732114732265, 0.014909693039953709, -0.007847895845770836, -0.022927910089492798, -0.10607106238603592, -0.0152372345328331, -0.012924790382385254, 0.04237077757716179, -0.005705774296075106, 0.003193530486896634, 0.00794615875929594, -0.018696073442697525, -0.020150357857346535, -0.01451664324849844, -0.007481049746274948, -0.038125839084386826, -0.005047415848821402, 0.02066132239997387, 0.016429485753178596, -0.019167732447385788, 0.03160121291875839, 0.020608916878700256, -0.013651932589709759, 0.023111334070563316, -0.010880931280553341, -0.012597248889505863, -0.003432635683566332, 0.013520915992558002, -0.016783230006694794, -0.05728046968579292, -0.04569860175251961, -0.027618305757641792, 0.02653086744248867, -0.028351999819278717, 0.018106497824192047, 0.0051063732244074345, -0.012754469178617, -0.0011029962915927172, -0.007743082940578461, -0.018420938402414322, 0.00845057237893343, -0.014372524805366993, -0.011444303207099438, 0.014778676442801952, -0.019377360120415688, 0.011372243985533714, 0.022678978741168976, -0.05534142628312111, 0.003149312222376466, 0.02193218469619751, -0.055026985704898834, -0.001665548887103796, -5.517028330359608e-05, 0.041034407913684845, -0.017490720376372337, 0.023517485707998276, -0.015066912397742271, -0.006459119729697704, -0.0042711421847343445, 0.006288798525929451, -0.03744455426931381, -0.047297004610300064, 0.030972331762313843, 0.0077692861668765545, -0.0035243474412709475, -0.03964563459157944, 0.023072028532624245, 0.014175999909639359, -0.05075584352016449, -0.0006215101457200944, 0.009531459771096706, -0.015328945592045784, 0.01557787787169218, 0.03461459279060364, -0.0043038963340222836, 0.01589231751859188, 0.013265433721244335, 0.005964532028883696, -0.00918426550924778, 0.007756184786558151, -0.02822098322212696, -0.01472626905888319, 0.017896872013807297, -0.02296721562743187, -0.02028137445449829, -8.557023829780519e-05, -0.0046478151343762875, 0.00972798466682434, -0.03807343170046806, 0.00048312381841242313, -0.0422135591506958, -0.04863337427377701, -0.025587547570466995, 0.008142683655023575, -0.027461085468530655, 0.0392787866294384, -0.021198490634560585, -0.014935895800590515, -0.028666438534855843, 0.0342477485537529, -0.025967495515942574, 0.008411267772316933, -0.015381352975964546, -0.02025517076253891, -0.01064510177820921, 0.006062794476747513, -0.019888324663043022, -0.029819386079907417, -0.020818542689085007, -0.008293353021144867, -0.019272547215223312, 0.01525033637881279, 0.00413029920309782, 0.013940169475972652, -0.008385064080357552, 0.0164949931204319, -0.03899054974317551, 0.002222369657829404, 0.02924291230738163, 0.00558785954490304, 0.0013445582007989287, 0.033933307975530624, -0.01711077243089676, -0.001301158918067813, 0.027644509449601173, 0.004159777890890837, -0.020320679992437363, -0.011811149306595325, 0.002450010972097516, 4.35016154369805e-05, -0.003196805715560913, 0.03199426084756851, 0.0024156190920621157, 0.0001747229543980211, 0.00014309473044704646, -0.015001404099166393, -0.0014739370672032237, -0.04391677677631378, -0.014988302253186703, -0.012597248889505863, 0.005574757698923349, 0.03975044563412666, 0.04155847430229187, 0.01902361400425434, 0.04108681529760361, 0.009990017861127853, -0.005227563437074423, -0.05853823199868202, 0.01669151894748211, 0.03445737436413765, -0.009223571047186852, -0.015276539139449596, -0.012793773785233498, 0.004601959139108658, -0.034326355904340744, -0.011850453913211823, 0.01442493125796318, -0.03883333131670952, -0.004041863139718771, -0.029924198985099792, -0.03526967763900757, -0.02191908285021782, -0.008745360188186169, 0.04944567754864693, -0.02296721562743187, -0.004163053352385759, 0.00127823103684932, -0.016337774693965912, -0.02507658302783966, 0.0016213308554142714, -0.04071996733546257, -0.0020094676874578, 0.019783511757850647, 0.011267430149018764, 0.06650403887033463, -0.006629441399127245, -0.07043454051017761, -0.014778676442801952, 0.015446861274540424, -0.03555791452527046, -0.004035312216728926, -0.02650466375052929, -0.01882709003984928, -0.031837042421102524, 0.04677293822169304, 0.01252518966794014, -0.02127710171043873, 0.004185981582850218, 0.00622001476585865, -0.003943600691854954, 0.024958668276667595, -0.009249773807823658, 0.017241789028048515, 0.02864023484289646, 0.006930779665708542, 0.0025597375351935625, -0.01628536731004715, -0.022036997601389885, -0.014136694371700287, -0.023766417056322098, -0.007605515420436859, -0.0016852014232426882, -0.00805752258747816, -0.025810277089476585, -0.009642824530601501, -0.027487289160490036, 0.021853573620319366, 0.010016221553087234, 0.004926225170493126, -0.02279689349234104, -0.05790935084223747, -0.029138099402189255, 0.03440496698021889, 0.012459681369364262, 0.0143987275660038, -0.02447390742599964, 0.006288798525929451, 0.010828524827957153, 0.018905699253082275, -0.021395016461610794, -0.007350033149123192, 0.020373085513710976, -0.02819477953016758, 0.008902580477297306, 0.05701843649148941, 0.008378513157367706, 0.0018800887046381831, -0.0342477485537529, 0.011097108945250511, -0.011634277179837227, 0.00856848806142807, 0.039357397705316544, -0.00919736735522747, -0.0010497707407921553, 0.01713697612285614, -0.011031600646674633, -0.012132139876484871, -0.020530305802822113, 0.007454846519976854, -0.011673581786453724, 0.033749885857105255, 0.023320959880948067, -0.02256106398999691, -0.02007174864411354, -0.0037175968755036592, 0.004628162365406752, -0.007441744673997164, 0.0006468946230597794, -0.014123592525720596, -0.02443460188806057, 0.02654396928846836, 0.04664191976189613, -0.0020471347961574793, 0.005031038541346788, -0.017281094565987587, 0.003432635683566332, -0.012793773785233498, -0.03178463503718376, -0.026570172980427742, 0.015604080632328987, -0.033959511667490005, -0.017870668321847916, -0.010507534258067608, -0.014621456153690815, -0.023098232224583626, 0.030186232179403305, -0.040615156292915344, -0.009904857724905014, 0.0030133824329823256, -0.022678978741168976, 0.009308732114732265, 0.018447142094373703, -0.007277973927557468, -0.04433602839708328, -0.09763359278440475, -0.03948841243982315, 0.00423183711245656, -0.005659918300807476, -0.02210250496864319, -0.026635680347681046, 0.03052687458693981, -0.014464235864579678, 0.0015484527684748173, -0.012597248889505863, 0.0011734176659956574, -0.03849268704652786, 0.0023599371779710054, -0.015171726234257221, -0.01779205910861492, -0.06760457903146744, -0.023661604151129723, 0.0007369685336016119, -0.008502979762852192, -0.037051502615213394, -0.04910503327846527, -0.017241789028048515, -0.012898587621748447, 0.0434713177382946, -0.04003868252038956, 0.00725832162424922, 0.009524908848106861, -0.0056402659974992275, 4.385986540000886e-05, -0.009406994096934795, -0.02279689349234104, -0.01545996218919754, 0.010795770213007927, 0.016652213409543037, -0.03650123253464699, -0.011627726256847382, -0.006989737506955862, -0.009479053318500519, 0.00040656098281033337, 0.011077456176280975, 0.0338284932076931, -0.05279970169067383, 0.05576067790389061, -0.02759210206568241, 0.018722277134656906, -0.05518420413136482, 0.011051252484321594, -0.04423121362924576, -0.02337336726486683, -0.03752316161990166, -0.0005027762963436544, 0.0008958262042142451, -0.001596765243448317, -0.00329015520401299, 0.013180273585021496, -0.007441744673997164, 0.006046417634934187, 0.009367689490318298, 0.005319275427609682, -0.006301899906247854, -0.022718284279108047, 0.01753002591431141, 0.00407461728900671, -0.012492435984313488, -0.02947874180972576, -0.009334934875369072, 0.007743082940578461, 0.01358642429113388, -0.01881398819386959, -0.056703999638557434, -0.002097903750836849, 0.03259693831205368, -0.0036782920360565186, 0.0304744690656662, -0.010900584049522877, -0.005401160567998886, 0.031024739146232605, 0.0066425432451069355, -0.03503384813666344, 0.029531149193644524, 0.04058895260095596, -0.024735940620303154, 0.032465919852256775, 0.03440496698021889, 0.03175843134522438, 0.040615156292915344, -0.0019570610020309687, 0.023517485707998276, -0.01882709003984928, 0.022888606414198875, 0.02942633628845215, -0.029190504923462868, -0.006629441399127245, -0.0263474453240633, -0.021408118307590485, -0.025220701470971107, -0.011634277179837227, 0.007317278999835253, 0.03862370178103447, -0.003966528456658125, 0.021997692063450813, 0.026858409866690636, -0.04299965873360634, -0.009596968069672585, 0.0325707346200943, 0.011319836601614952, 0.002538447268307209, 0.010573042556643486, 0.019482173025608063, -0.016128147020936012, -0.001447733724489808, 0.020923355594277382, -0.02864023484289646, 0.026570172980427742, -0.03422154486179352, 0.01337679848074913, 0.04161088168621063, 0.018080295994877815, 0.03304239362478256, 0.005738528445363045, -0.009236672893166542, 0.04195152595639229, -0.009695230983197689, 0.02989799529314041, -0.014529744163155556, -0.017058365046977997, -0.018656767904758453, 0.02174876071512699, -0.046406090259552, -0.004258040338754654, 0.023936739191412926, -0.01399257592856884, 0.01295754499733448, 0.01202077604830265, -0.01223695371299982, 0.02921670861542225, 0.05581308528780937, 0.02630813978612423, -0.030002808198332787, 0.0258626826107502, 0.011536014266312122, 0.03283276781439781, 0.026674985885620117, 0.013140968047082424, 0.015053810551762581, 0.007002838887274265, 0.0392787866294384, -0.05429329350590706, -0.006223290227353573, -0.008404716849327087, 0.023032722994685173, -0.0011054528877139091, 0.0031804286409169436, 0.0042285616509616375, 0.028771251440048218, 0.005679571069777012, 0.008607792668044567, -0.0281685758382082, 0.0061839851550757885, -0.002956062788143754, 0.006344480440020561, 0.029373928904533386, 0.001994728110730648, -0.011667030863463879, 0.05243285745382309, -0.025849580764770508, -0.015761300921440125, 0.0017376081086695194, -0.011411548592150211, -0.00930218119174242, 0.0027218705508857965, -0.016874942928552628, 0.01076956745237112, -0.015040709637105465, 0.02279689349234104, 0.018067194148898125, 0.014359422959387302, 0.04349752143025398, -0.021630845963954926, 0.032911378890275955, 0.009701781906187534, 0.02945253811776638, -0.010166890919208527, -0.036344014108181, 0.045855820178985596, -0.005116199608892202, 0.013245781883597374, -0.004867267794907093, -0.0006771922344341874, 0.021447421982884407, 0.010920235887169838, 0.02966216579079628, 0.008267149329185486, 0.043523725122213364, 0.007638269569724798, -0.01821131259202957, 0.012485885061323643, 0.04404779151082039, 0.013743644580245018, -0.03870231285691261, -0.04009108990430832, 0.03202046453952789, 0.00037298796814866364, -0.0008335933089256287, -0.048187918961048126, 0.024696635082364082, -0.015748199075460434, -0.005712325219064951, 0.01032411027699709, 0.0334092415869236, 0.01775275357067585, 0.037261128425598145, -0.03883333131670952, 0.01556477602571249, 0.0035800293553620577, -0.07908163964748383, -0.009223571047186852, 0.00590229919180274, -0.022010793909430504, -0.020111052319407463, -0.008090277202427387, -0.01054028794169426, 0.018486447632312775, 0.03762797638773918, -0.006613064557313919, 0.0052734194323420525, 0.04451945051550865, 0.0022518483456224203, 0.004565929528325796, 0.014634557999670506, -0.027644509449601173, 0.007723430637270212, -0.02400224655866623, 0.01606263965368271, 0.010821973904967308, -0.011712887324392796, -0.004035312216728926, 7.221268606372178e-05, -0.0009572402923367918, 0.014909693039953709, 0.02945253811776638, 0.025810277089476585, -0.013036155141890049, -0.019377360120415688, 0.003336010966449976, 0.024277381598949432, -0.006403437815606594, 0.06608478724956512, -0.00875846203416586, -0.017189381644129753, 0.0028758151456713676, 0.025233803316950798, 0.01815890520811081, -0.015027607791125774, 0.011306735686957836, -0.0030412236228585243, 0.014438033103942871, 0.06204947829246521, 0.05028418451547623, 0.010900584049522877, -0.039121564477682114, 0.014215304516255856, 0.006298624444752932, -0.004778831731528044, -0.015931623056530952, -0.020569611340761185, -0.003933774307370186, 0.022285928949713707, 0.03990766778588295, -9.201871580444276e-05, -0.0027955672703683376, 0.026661884039640427, 0.008804317563772202, 0.031732227653265, 0.04014349728822708, 0.016232959926128387, 0.02546963281929493, -5.19460481882561e-05, 0.03838787227869034, -0.005093271378427744, -0.014765574596822262, 0.011824251152575016, -0.02318994328379631, -0.0068849241361021996, 0.027068035677075386, -0.007402439601719379, 0.006459119729697704, 0.005132576450705528, 0.005885922349989414, 0.039173971861600876, 0.030186232179403305, 0.05806657299399376, -0.0290070828050375, -0.00029151199851185083, 0.013940169475972652, -0.01756932958960533, -0.006629441399127245, 0.008548835292458534, 0.011424650438129902, -0.03364507108926773, 0.011234676465392113, 0.00590229919180274, 0.0033212716225534678, 0.005414262413978577, 0.014254609122872353, 0.014700066298246384, 0.02252175845205784, -0.00033777725184336305, -0.01566958986222744, -0.018434040248394012, -0.013848458416759968, -0.025954395532608032, 0.01451664324849844, 0.031208161264657974, -0.012302462011575699, -0.004860716871917248, -0.012197648175060749, -0.010507534258067608, -0.004248214419931173, 0.018945004791021347, 0.03631781041622162, -0.02861403301358223, 0.02294101193547249, 0.006652369629591703, -0.038571298122406006, -0.017254890874028206, 0.026190225034952164, 0.0024107061326503754, 0.015984028577804565, 0.006658920086920261, 0.024604924023151398, 0.0064001623541116714, 0.010874380357563496, -0.03152260184288025, -0.04884300008416176, 0.0016246062004938722, -0.04048413783311844, 0.0023730387911200523, -0.022639673203229904, -0.03757556900382042, 0.030841315165162086, 0.030002808198332787, -0.001735970377922058, -0.024906260892748833, -0.017412111163139343, 0.008968088775873184, 0.015066912397742271, 0.013108214363455772, -0.005889197811484337, -0.010795770213007927, 0.05518420413136482, -0.02356989122927189, -0.026583274826407433, -0.002333733718842268, -0.026478461921215057, 0.02654396928846836, -0.01252518966794014, -0.014123592525720596, -0.026386748999357224, 0.017661042511463165, -0.008483326993882656, 0.04051034152507782, -0.030186232179403305, -0.00077586411498487, 0.026426054537296295, -0.020792338997125626, 0.005853168200701475, 0.041479866951704025, 0.024355992674827576, 0.008706055581569672, 0.00856848806142807, 0.013494713231921196, -0.033121004700660706, 0.03259693831205368, 0.020831644535064697, 0.008286802098155022, -0.0346670001745224, -0.010841626673936844, 0.03388090059161186, 0.034798018634319305, -0.003740524873137474, -0.02714664675295353, -0.04368094354867935, 0.017870668321847916, -0.010048975236713886, -0.0019980035722255707, -0.0047297002747654915, 0.026884613558650017, -0.029819386079907417, -0.01987522281706333, -0.010697508230805397, -0.01170633640140295, 0.0005650092498399317, 0.00496553024277091, 0.00221745646558702, 0.03513865917921066, 0.0016761940205469728, 0.011830802075564861, 0.015761300921440125, 0.0038911940064281225, 0.012033877894282341, -0.01919393613934517, 0.027225255966186523, -0.028063762933015823, 0.00833920855075121, -0.03443117067217827, -0.026688087731599808, -0.0024844028521329165, 0.011280531994998455, 0.030369656160473824, -0.02191908285021782, 0.026609478518366814, -0.04829273000359535, 0.013193374499678612, 0.023072028532624245, -0.012977197766304016, -0.006747356615960598, 0.021657049655914307, 0.01941666565835476, 0.042894843965768814, -0.03744455426931381, -0.004051689524203539, -0.031732227653265, -0.011332938447594643, -0.007756184786558151, -0.0029495118651539087, -0.012826528400182724, -0.005240665283054113, 0.006298624444752932, 0.01168013270944357, 0.001819493481889367, 0.001113641425035894, -0.0140842879191041, 0.004991733469069004, 0.005207911133766174, -0.000432764325523749, -0.006052968557924032, -0.012826528400182724, -0.029164303094148636, 0.03338303789496422, -0.0067342547699809074, 0.01628536731004715, 0.0367632657289505, -0.0005932596977800131, -0.01513242069631815, -0.0029577005188912153, 0.008542284369468689, -0.005361855495721102, -0.001589395571500063, 0.020949559286236763, -0.02612471580505371, -0.018682971596717834, -0.004487319849431515, 0.020622018724679947, 0.015328945592045784, -0.015984028577804565, -0.04672053083777428, 0.011863555759191513, -0.0004124976694583893, 0.003131297416985035, 0.0034915932919830084, -0.03820445016026497, 0.04716598615050316, 0.00469367066398263, -0.016154350712895393, 0.009269426576793194, -0.014975201338529587, 0.04926225170493126, -0.0038027577102184296, -0.018067194148898125, -0.028063762933015823, -0.008123030886054039, 0.028718845918774605, 0.01253829151391983, -0.009800043888390064, 0.02840440534055233, -0.01878778450191021, -0.015748199075460434, -0.027487289160490036, 0.0037241477984935045, -0.009230121970176697, 0.01565648801624775, 0.007965811528265476, -0.02650466375052929, -0.006622890941798687, 0.02359609492123127, 0.02127710171043873, -0.03170602396130562, -0.014202202670276165, -0.008221293799579144, 0.0016745562897995114, 0.016337774693965912, -0.016010232269763947, 0.024290483444929123, 0.0060169389471411705, -0.019285649061203003, 0.007467947900295258, -0.048580966889858246, 0.017032161355018616, 0.04281623661518097, 0.013383348472416401, 0.004497145768254995, -0.011948716826736927, 0.018067194148898125, 0.0022846024949103594, -0.016770128160715103, -0.025168294087052345, -0.03445737436413765, -0.025613751262426376, 0.014948997646570206, 0.029557352885603905, 0.003619334427639842, 0.01272826548665762, 0.021054372191429138, 0.0329899862408638, -0.02650466375052929, -0.011739090085029602, -0.003694669110700488, -0.007540007121860981, 0.020949559286236763, -0.02152603305876255, -0.01861746422946453, 0.004710047971457243, -0.01316062081605196, -0.017464516684412956, -0.02691081538796425, -0.02275758981704712, 0.008109929040074348, -0.02337336726486683, -0.004677293822169304, -0.005695947911590338, 0.01773965172469616, 0.018093395978212357, 0.0032541255932301283, -0.016599807888269424, 0.04087718948721886, 0.02984558790922165, 0.02212870866060257, 9.954193228622898e-05, 0.0304744690656662, 0.003819134784862399, -0.008064073510468006, -0.0011725988006219268, 0.004569204989820719, 0.01587921567261219, 0.030972331762313843, 0.025587547570466995, 0.003933774307370186, 0.026465360075235367, -0.0020078299567103386, -0.01611504517495632, -0.024788346141576767, 0.012361419387161732, 0.005578033160418272, 0.0012028964702039957, -0.0008720794576220214, -0.004765729885548353, -0.004585582297295332, 0.00668184831738472, -0.004520073998719454, 0.0342477485537529, -0.02942633628845215, 0.02155223675072193, 0.02861403301358223, 0.02336026541888714, -0.016861841082572937, -0.0027873788494616747, 0.009747637435793877, -0.04362853989005089, -0.026072310283780098, -0.02043859474360943, -0.018316125497221947, 0.0329899862408638, 0.00783479493111372, -0.018237514421343803, 0.030343452468514442, 0.020595815032720566, 0.025155194103717804, -0.007959260605275631, 0.030186232179403305, 0.02594129368662834, -0.008647097274661064, -0.013416103087365627, 0.011968369595706463, 0.0017523474525660276, -0.010998846031725407, -0.000752936233766377, -0.01366503443568945, -0.0039010201580822468, 0.017176279798150063, -0.04279003292322159, 0.02549583651125431, -0.01673082448542118, -0.02444770373404026, -0.03830926492810249, 0.05707084387540817, 0.012479334138333797, 0.03406432271003723, -0.012924790382385254, 0.021643947809934616, 0.029609758406877518, -0.02926911599934101, -0.02864023484289646, -0.04713978245854378, 0.034824222326278687, -0.03804722800850868, -0.027068035677075386, -0.01898431032896042, -0.0020536857191473246, 0.024107059463858604, -0.028745049610733986, -0.016246061772108078, 0.00845057237893343, 0.00349814398214221, 0.01378295011818409, 0.027225255966186523, -0.018905699253082275, -0.015590978786349297, 0.007854446768760681, -0.014621456153690815, -0.004140125587582588, 0.025613751262426376, -0.011942165903747082, -0.03031724877655506, 0.03160121291875839, 0.009125308133661747, 0.05749009922146797, -0.006406713277101517, 0.008437471464276314, -0.015590978786349297, 0.013396450318396091, -0.0155516741797328, -0.03233490511775017, -0.0038125840947031975, 0.003373678307980299, 0.017923075705766678, 0.005568206775933504, 0.012977197766304016, -0.016154350712895393, -0.00427769310772419, -0.021565336734056473, 0.0006309269811026752, 0.0038387873210012913, -0.023294758051633835, -0.0078020403161644936, 0.026819104328751564, 0.030631689354777336, -0.010389618575572968, -0.02837820164859295, 0.010140687227249146, 0.0014649296645075083, -0.021827369928359985, 0.018931902945041656, 0.011450853198766708, 0.01547306403517723, 0.04310447350144386, -0.002474576700478792, 0.009518357925117016, -0.04030071571469307, 0.019272547215223312, 0.018879497423768044, 0.0020536857191473246, -0.012374521233141422, 0.02277068980038166, 0.0016000405885279179, 0.024526312947273254, -0.005938328802585602, 0.011215023696422577, -0.030657891184091568, 0.0033835044596344233, -0.043733350932598114, 0.007094550412148237, -0.01966559700667858, 0.01409738976508379, 0.037916213274002075, 0.0018817263189703226, -0.02339957095682621, 0.017045263200998306, -0.0009621533681638539, -0.039986275136470795, 0.023897433653473854, 0.017923075705766678, 0.009642824530601501, 0.027513492852449417, 0.0007885563536547124, -0.0028053936548531055, -0.0101341363042593, 0.017831362783908844, 0.02172255702316761, -0.0020913530606776476, -0.012950994074344635, -0.007893752306699753, 0.01044202595949173, 0.01147705689072609, -0.014123592525720596, -0.0014362698420882225, 0.013730542734265327, 0.01366503443568945, -0.020962661132216454, 0.009433197788894176, 0.005237389821559191, 0.011097108945250511, -0.012590697966516018, -0.01794927939772606, 0.009800043888390064, 0.012276258319616318, -0.028299592435359955, -0.0225741658359766, -0.03073650225996971, -0.008254047483205795, -0.025587547570466995, -0.018879497423768044, 0.016796331852674484, 0.03112955205142498, 0.017228687182068825, 0.002186340047046542, -0.020215867087244987, -0.039173971861600876, 0.004870543256402016, -0.005119475070387125, -0.0035112458281219006, 0.044178809970617294, 0.022718284279108047, 0.004628162365406752, -0.02005864679813385, -0.007513803895562887, 0.0018915525870397687, -0.02905948832631111, 0.02653086744248867, -0.017281094565987587, 0.009551112540066242, -0.015512369573116302, -0.01775275357067585, -0.028561625629663467, 0.03453598544001579, 0.005997286178171635, -0.005492872092872858, 0.043733350932598114, -0.01032411027699709]",Token-level Direct Preference Optimization.pdf
" (3)
whereD={x(n)}N
n=1is a multiset of prompts. To
prevent reward hacking (Amodei et al., 2016) and
to make sure that we do not diverge too much from
the supervised fine-tuned model πSFT, a regulariza-
tion term is often added to the objective (Stiennon
et al., 2020),
JRL(θ) = E
x∼D,y∼πθ(·|x)h
r(x,y)i
−β D KLh
πθ(y|x)∥πSFT(y|x)i
.(4)
The above objective is optimized using proximal
policy optimization (PPO; Schulman et al., 2017)
or another actor–critic algorithm (Mnih et al., 2016;
Glaese et al., 2022).
3 Reward Modeling
Pointwise Rewards. A key component in
Eq. (4) is the task-dependent reward function
that assigns pointwise real-valued rewards to
each output. In many tasks, learning such reward
functions is straightforward. For example, in
open-ended text generation, a desired attribute
could be the presence of indicators of positive
sentiment in the generated text, while an undesired
attribute could be toxicity. In such cases, the
reward model might take the form of a classifier
that assesses responses based on their sentiment
or toxicity. Similarly, in code generation tasks, the
quality of the code can be automatically evaluated,
providing another straightforward example.
Pairwise Preferences. Learning a point-wise re-
ward function for tasks like summarization or dia-
logue generation is more complex. Judging the ab-
solute quality of a summary can depend on several
factors, e.g., coherence, faithfulness, and concise-
ness, which makes it hard to collect human feed-
back datasets for reward model training. An effec-tive strategy in such cases is to collect human pref-
erences instead of point-wise judgments (Ziegler
et al., 2020; Wu et al., 2021; Ouyang et al., 2022).
In this setup, humans are shown two (or more) re-
sponses to a prompt xand are asked to select the
response they prefer. Therefore, a datapoint in a hu-
man feedback dataset is a triple (x,yw,yl)∼ D HF,
where ywis preferred over yl. Given such a dataset,
one needs to learn the point-wise reward function.
It is common to assume that the preference data
can be modeled by a Bradley–Terry model (Bradley
and Terry, 1952),
pBT(yw≻yl|x)
=exp 
r(x,yw)
exp 
r(x,yw)
+ exp 
r(x,yl)(5a)
=σ 
r(x,yw)−r(x,yl)
, (5b)
where σ(x) =1
1+exp( −x)is the sigmoid function.
Assuming that DHF∼pBT, we can train a reward
model rϕ, parameterized by ϕ, as a binary clas-
sifier that maximizes the following log-likelihood
Eh
logσ 
rϕ(x,yw)−rϕ(x,yl)i
, (6)
where the expectation is over (x,yw,yl)∼ D HF.
Intuitively, the reward function should assign
higher reward values to the responses that are
preferred by humans. The estimated reward
function is then plugged into Eq. (4) to enable
policy estimation.
It is often the case that directly optimizing Eq. (4)
is complex and resource-intensive. Next, we will
elaborate on an alternative method to using RLHF
that has demonstrated comparable or even superior
effectiveness to PPO.
4 Direct Preference Optimization
Rafailov et al. (2023) introduce a method to
avoid reward model training and, thus, to directly
optimize the language model. Their method,
termed direct preference optimization (DPO)
works as follows. The critical observation is that
the optimal solution that maximizes the Eq. (4) is,
π⋆
θ(y|x) = (8)
1
Z(x)πSFT(y|x) exp1
βr(x,y)
,
where
Z(x) =X
y∈Σ∗πSFT(y|x) exp1
βr(x,y)
,(9)
LDPO(θ) =− E
(x,yw,yl)∼D HF","[-0.023190747946500778, -0.017340712249279022, 0.03572840988636017, -0.018649443984031677, -0.001288283965550363, -0.006612373515963554, 0.00878814235329628, 0.05962587520480156, -0.0051400489173829556, 0.02223537303507328, 0.022824302315711975, -0.016149764880537987, -0.005787871778011322, -0.003504132619127631, 0.02923709526658058, -0.05596142262220383, 0.04666941612958908, -0.04420899972319603, 0.008873209357261658, 0.029708238318562508, -0.026227008551359177, 0.0057845995761454105, -0.02465652860701084, 0.022785041481256485, 0.0304934773594141, 0.01939542219042778, -0.011143861338496208, 0.014239015057682991, 0.0032440219074487686, -0.02625318430364132, 0.027823662385344505, -0.03326799347996712, -0.024250822141766548, -0.03868614509701729, 0.0017635177355259657, 0.014762507751584053, 0.012550748884677887, 0.03973313421010971, -0.01113731786608696, 0.016372250393033028, -0.011536480858922005, -0.05742720142006874, -0.020704155787825584, 0.024983711540699005, -0.006746518425643444, 0.04905131086707115, 0.038398224860429764, 0.011196210980415344, 0.011883295141160488, 0.035100217908620834, -0.0507526658475399, 0.06538429856300354, -0.023439407348632812, -0.01643768697977066, 0.0010617095977067947, -0.0028284990694373846, 0.02625318430364132, 0.009102237410843372, 0.012033799663186073, -0.005529396701604128, 0.01917293854057789, -0.03279684856534004, -0.008114144206047058, 0.04064924642443657, 0.003088609781116247, -0.026279358193278313, -0.0920301005244255, 0.01787729188799858, -0.02549411915242672, 0.03685392066836357, 0.045700956135988235, 0.010489494539797306, 0.061458099633455276, 0.00451840041205287, -0.005071340128779411, -0.032299529761075974, 0.03829352557659149, 0.05774129927158356, 0.007531758397817612, -0.02091355249285698, 0.009030257351696491, -0.03201160952448845, 0.0033896183595061302, -0.024486394599080086, -0.025206197053194046, -0.054233893752098083, -0.061615146696567535, -0.01567862182855606, -0.014068879187107086, -0.023531019687652588, -0.015233651734888554, -0.02905387245118618, -0.018924279138445854, -0.007531758397817612, 0.03829352557659149, -0.02159409411251545, -0.04719291254878044, 0.011019531637430191, 0.02287665195763111, 0.011425239033997059, -0.014278276823461056, -0.07334139198064804, 0.011431782506406307, 0.0004556026542559266, 0.03923581540584564, 0.0025274904910475016, 0.01179822813719511, 0.05248019099235535, -0.018963539972901344, -0.009691167622804642, -0.08040855079889297, 0.005863123573362827, -0.0628715306520462, 0.021384697407484055, -0.00905643217265606, -0.08019915968179703, -0.059835270047187805, 0.007466321811079979, 0.010954095050692558, 0.010698892176151276, -0.01705279015004635, 0.0026403688825666904, 0.02065180614590645, -0.008186125196516514, -0.014762507751584053, -0.004165042657405138, 0.00574860954657197, -0.06700712442398071, 0.0059874532744288445, -0.017680982127785683, 0.00258965534158051, 0.013335988856852055, -0.017602458596229553, -0.0625050887465477, -0.06936284899711609, 0.001693173311650753, 0.00296918791718781, -0.014631634578108788, -0.011320539750158787, -0.005156408064067364, -0.005071340128779411, -0.03245657682418823, -0.05279428884387016, -0.009822040796279907, -0.07967565953731537, -0.02931561879813671, -0.019002802670001984, -0.005018990952521563, -0.051694951951503754, 0.037037141621112823, 0.02207832597196102, -0.006798867601901293, -0.01225628424435854, 0.05028152093291283, -0.01837461069226265, -0.07035748660564423, -0.024159209802746773, 0.025402506813406944, -0.003356900066137314, -0.030467303469777107, -0.01617593877017498, 0.041800931096076965, -0.023190747946500778, -0.013990355655550957, 0.03690626844763756, 0.005585018079727888, -0.021528657525777817, 0.023059874773025513, -0.04855399206280708, -0.01461854763329029, -0.035780757665634155, -0.004551118705421686, -0.05496678501367569, -0.006088880356401205, -0.015861842781305313, -0.006897022947669029, -0.021410871297121048, -0.009625731036067009, -0.0021299629006534815, -0.03133106604218483, -0.011202754452824593, 0.030545827001333237, -0.04491571709513664, -0.003922927193343639, 0.034184105694293976, 0.02595217525959015, -0.01787729188799858, -0.021567920222878456, -0.0003073477710131556, 0.014723245985805988, 0.017759505659341812, 0.04012575373053551, 0.07946626842021942, -0.018819579854607582, -0.030938446521759033, 0.0033078226260840893, 0.041643884032964706, 0.03913111612200737, -0.018610183149576187, -0.0015263098757714033, 0.0070671578869223595, 0.023282360285520554, -0.021044425666332245, -0.04708821326494217, 0.005159679800271988, 0.01667325757443905, -0.023347796872258186, 0.010797047056257725, -0.0662742406129837, -0.01524673867970705, -0.009442508220672607, 0.015155128203332424, 0.0742313340306282, 0.010155768133699894, -0.03811030462384224, 0.01943468488752842, -0.018819579854607582, 0.018688706681132317, 0.012603098526597023, 0.03944521024823189, -0.007198031526058912, 0.010999900288879871, 0.04758553206920624, 0.02965588867664337, -0.07396958768367767, 0.02427699603140354, 0.025219283998012543, -0.021986713632941246, 0.0017406148836016655, -0.031985435634851456, 0.06763532012701035, 0.011359802447259426, -0.024918274953961372, -0.03091227263212204, -0.0013741696020588279, -0.0014796862378716469, -0.0019189297454431653, -0.014854119159281254, 0.03667069599032402, -0.03609485551714897, -0.015390699729323387, 0.013754783198237419, 0.034786123782396317, -0.011713160201907158, 0.030859922990202904, 0.0499936006963253, -0.01773333176970482, -0.0026174660306423903, 0.026344794780015945, -0.0074074286967515945, 0.02311222441494465, -0.02947266586124897, -0.01635916158556938, -0.011575743556022644, -0.050098296254873276, -0.00019692341447807848, -0.00802907720208168, 0.01985347829759121, -0.012779777869582176, -0.020442409440875053, -0.01498499233275652, -0.0022624721750617027, 0.027666615322232246, 0.053160734474658966, -0.011870208196341991, -0.03928816318511963, -0.055699676275253296, -0.018806492909789085, -0.014814857393503189, -0.002979003358632326, 0.0038018692284822464, -0.0013324538012966514, -0.010731610469520092, 0.02853037789463997, -0.022641079500317574, -0.05174730345606804, 0.053317781537771225, 0.026580367237329483, -0.04337140917778015, -0.012544205412268639, -0.023269271478056908, -0.01591419242322445, 0.05674666166305542, 0.006020171567797661, 0.01122892927378416, -0.008722704835236073, -0.03345121443271637, 0.019408509135246277, -0.013283639214932919, -0.011366345919668674, -0.025049148127436638, -0.052558716386556625, 0.020808855071663857, -0.06538429856300354, 0.036618348211050034, 0.02261490561068058, 0.00438425550237298, -0.018152127042412758, 0.03698479384183884, 0.01921219937503338, 0.043162014335393906, -0.005624279845505953, -0.014474586583673954, 0.012779777869582176, 0.02235315926373005, 0.008493676781654358, 0.002763062482699752, 0.003474686061963439, 0.01931689865887165, -0.01685648038983345, 0.020324623212218285, 0.022889738902449608, -0.015181302092969418, 0.020167574286460876, -0.015626272186636925, -0.015940368175506592, 0.07454542815685272, 0.0017357070464640856, 0.012766689993441105, -0.03148811683058739, -0.024002162739634514, -0.010659630410373211, -0.01587493158876896, -0.018819579854607582, 0.02989146113395691, -0.006455325521528721, 0.020560195669531822, 0.010973726399242878, -0.026737414300441742, 0.002494772197678685, 0.011150404810905457, 0.019382335245609283, -0.001297281589359045, 0.022588731721043587, -0.008801229298114777, -0.05664196237921715, -0.0541815459728241, 0.03742976114153862, 0.03237805515527725, 0.018283000215888023, -0.06171984598040581, -0.013493036851286888, -0.034079406410455704, -0.01773333176970482, -0.04640766978263855, 0.0067792367190122604, 0.016751781105995178, 0.040178101509809494, 0.032744500786066055, 0.03099079616367817, -0.015600097365677357, -0.01367625966668129, 0.03083374910056591, 0.0009103873744606972, -0.011242016218602657, 0.02133234776556492, -0.006798867601901293, -0.05690370872616768, -0.048396944999694824, -0.013859482482075691, -0.028739776462316513, -0.009233111515641212, 0.008761967532336712, -0.0008138683042488992, -0.017065877094864845, 0.0055097658187150955, 0.0001591951004229486, 0.012334808707237244, -0.009763147681951523, -0.019264549016952515, -0.016267551109194756, 0.025180023163557053, -0.05716545507311821, 0.028504204005002975, -0.022562555968761444, 0.00793746579438448, 0.03481229767203331, 0.0061215986497700214, 0.014971905387938023, 0.010227748192846775, 0.0027336159255355597, 0.028608903288841248, -0.050778839737176895, -0.034341152757406235, 0.004551118705421686, 0.014134315773844719, 0.006259015295654535, -0.029786761850118637, -0.03580693528056145, -0.016162851825356483, 0.011804771609604359, -0.012197391130030155, -0.018871929496526718, 0.030127033591270447, -0.010227748192846775, -0.016463860869407654, -0.05208757147192955, 0.055699676275253296, 0.06810646504163742, 0.0454653836786747, -0.06130105257034302, 0.013394881971180439, -0.04564860463142395, 0.006389888934791088, -0.021659530699253082, -0.002378622069954872, -0.0051138740964233875, 0.03965460881590843, -0.013506123796105385, 0.04488953948020935, 0.030336430296301842, -0.020311536267399788, 0.009822040796279907, -0.02113603800535202, 0.01669943332672119, -0.04004722833633423, 0.033503562211990356, 0.008192668668925762, 0.03614720329642296, 0.04402577877044678, 0.01045677624642849, -0.025284720584750175, 0.0023115496151149273, -0.024290084838867188, -0.011111143045127392, 0.040596894919872284, 0.017000440508127213, -0.02167261764407158, -0.003175313351675868, -0.011837489902973175, -0.020259186625480652, 0.05310838297009468, 0.03633042797446251, -0.042062677443027496, -0.04604122415184975, -0.007649544160813093, 0.04148683696985245, -0.0050746118649840355, -0.0035892000887542963, -0.04342376068234444, 0.04038750007748604, -0.005689716432243586, -0.06737357378005981, 0.016804130747914314, -0.01871488057076931, 0.020965902134776115, 0.01327709574252367, 0.01329672709107399, 0.008356260135769844, -0.006052889861166477, -0.049077484756708145, 0.050438567996025085, 0.054233893752098083, 0.014068879187107086, 0.014919555746018887, -0.04190563037991524, 0.08527704328298569, 0.014958817511796951, 0.006982090417295694, 0.01961790770292282, 0.025939088314771652, 0.001478050253354013, 0.01935616135597229, -0.028425680473446846, 0.014827944338321686, 0.015822581946849823, 0.02701224759221077, 0.004816137254238129, -0.037325065582990646, 0.01448767352849245, -0.0341055803000927, -0.025323983281850815, 0.008683443069458008, -0.024748140946030617, -0.020743418484926224, -0.02753574214875698, 0.01757628470659256, -0.01879340596497059, 0.027326343581080437, -0.0019189297454431653, 0.010581105947494507, -0.006370257586240768, -0.015168215148150921, -0.00922656711190939, 0.03397470712661743, 0.05046474188566208, 0.07564476877450943, -0.037482112646102905, -0.01901588961482048, -0.010764328762888908, 0.006903566420078278, -0.050019774585962296, 0.02709077298641205, -0.014579284936189651, -0.008094513788819313, -0.011150404810905457, 0.01969643123447895, 0.010332446545362473, 0.005696260370314121, -0.022667255252599716, 0.0304934773594141, -0.019002802670001984, -0.025520293042063713, 0.040623072534799576, -0.0034125212114304304, 0.027247820049524307, 0.05690370872616768, -0.002776149893179536, -0.04457544535398483, 0.03271832317113876, -0.031461939215660095, 0.0007005811203271151, -0.030519653111696243, 0.037325065582990646, 0.0023180933203548193, 0.012341352179646492, -0.037482112646102905, -0.02279812842607498, -0.02383202686905861, 0.027561916038393974, -0.012642360292375088, -0.0022346614859998226, -0.015063516795635223, -0.011366345919668674, -0.010823221877217293, -0.0025291263591498137, -0.026423318311572075, -0.10051069408655167, -0.023020612075924873, -0.017301449552178383, 0.029106222093105316, -0.0028055962175130844, 0.009331266395747662, 0.01985347829759121, -0.015600097365677357, -0.008794685825705528, -0.03834587708115578, -0.03936668857932091, -0.01849239692091942, -0.0028219553641974926, 0.020821942016482353, -0.0010249015176668763, -0.02023301087319851, 0.020808855071663857, 0.012295546010136604, -0.03640894964337349, 0.016189027577638626, 0.010653086006641388, -0.007590651046484709, -0.01469707116484642, 0.03852909803390503, -0.04981037601828575, -0.05350100249052048, -0.014540023170411587, -0.033425040543079376, 0.00580423092469573, -0.021947452798485756, 0.019460858777165413, 0.00599399721249938, -0.0055653867311775684, -0.008892840705811977, -0.0013299998827278614, -0.019081326201558113, 0.017262188717722893, -0.02871360071003437, 0.011844033375382423, 0.019644081592559814, -0.0013512667501345277, 0.010620367713272572, 0.009285460226237774, -0.03235187754034996, 0.012079604901373386, 0.03507404401898384, -0.060934606939554214, 0.002867761068046093, 0.00039261989877559245, 0.02201288938522339, -0.008284280076622963, 0.015050428919494152, 0.027745138853788376, -0.025729689747095108, -0.007191487587988377, -0.005473775789141655, -0.03677539527416229, -0.02571660280227661, 0.013028436340391636, -0.003873849520459771, 0.008002902381122112, -0.05261106416583061, 0.022091412916779518, 0.031645163893699646, -0.02923709526658058, -0.009946370497345924, 0.0018175028963014483, -0.04965332895517349, -0.003592472057789564, 0.0033012789208441973, 0.007813136093318462, 0.0018633086001500487, 0.015416874550282955, 0.0355975367128849, -0.009233111515641212, -0.0010338990250602365, -0.025965262204408646, -0.043921079486608505, 0.02553337998688221, -0.011111143045127392, 0.015770232304930687, 0.013623910024762154, -0.009455596096813679, -0.0031049689278006554, -0.04193180426955223, 0.007243836764246225, -0.02057328261435032, -0.02955119125545025, -0.03065052628517151, 0.014801769517362118, -0.022025976330041885, 0.04172240570187569, -0.01056801900267601, -0.017563195899128914, 0.0005206303321756423, 0.035780757665634155, -0.012014168314635754, -0.024839751422405243, -0.0007803320186212659, -0.030284080654382706, 0.0007598830852657557, 0.012197391130030155, -0.019500121474266052, -0.04397342726588249, 0.008971364237368107, -0.0014412421733140945, 0.004083246923983097, -0.010037981905043125, -0.007636456750333309, 0.011006444692611694, -0.02503606118261814, 0.014199752360582352, -0.028687426820397377, 0.024708878248929977, 0.021149124950170517, -0.0029430133290588856, -0.03656600043177605, 0.019002802670001984, 0.008251561783254147, 0.002303370041772723, 0.014134315773844719, -0.005477047525346279, -0.03387000784277916, -0.012838670052587986, -0.006628732662647963, 0.01633298769593239, -0.008153405971825123, 0.032299529761075974, 0.005038621835410595, 0.01571788266301155, 0.00874887965619564, 0.0005967004108242691, -0.03279684856534004, -0.03428880497813225, -0.017824942246079445, -0.020481670275330544, -0.01113731786608696, 0.018440047279000282, 0.036880094558000565, 0.022444769740104675, 0.06507020443677902, -0.008264648728072643, -0.015194389969110489, -0.06088225916028023, -0.009468683041632175, 0.02845185436308384, 0.008631094358861446, -0.01579640619456768, -0.02719547040760517, 0.012675078585743904, -0.046119749546051025, -0.008480589836835861, 0.016084328293800354, -0.036304254084825516, -0.0038084129337221384, -0.03894789144396782, -0.03305859491229057, 0.0031213280744850636, -0.0027450674679130316, 0.01625446416437626, -0.04117273911833763, 0.01121584139764309, 0.015626272186636925, -0.018269911408424377, -0.00922656711190939, 0.012812496162950993, -0.02205215021967888, 0.020507846027612686, 0.017929641529917717, 0.009115325286984444, 0.055594976991415024, -0.02231389656662941, -0.07365549355745316, -0.03685392066836357, 0.029708238318562508, -0.005990725010633469, -0.011595373973250389, -0.029603539034724236, -0.027221646159887314, -0.04360698163509369, 0.05216609686613083, 0.04572713002562523, -0.04041367396712303, -0.011902926489710808, -0.01187675166875124, -0.00461982749402523, 0.021842753514647484, 0.010149223729968071, 0.0341055803000927, 0.04334523528814316, 0.026410231366753578, 0.006982090417295694, -0.01272742822766304, -0.044601619243621826, -0.00400472292676568, -0.0002997816482093185, 0.018963539972901344, -0.021188387647271156, -0.02121456153690815, -0.03546666353940964, -0.015037341974675655, -0.024119948968291283, 0.03462907299399376, 0.00855911336839199, -0.004410430323332548, -0.010823221877217293, -0.01715748943388462, -0.022222286090254784, 0.03031025640666485, -0.020704155787825584, 0.0013471769634634256, -0.008173037320375443, -0.0027597907464951277, 0.014762507751584053, -5.94042066950351e-05, -0.031304892152547836, 0.008120687678456306, 0.018662532791495323, -0.002576567931100726, 0.03235187754034996, 0.03745593875646591, 0.0027516111731529236, -0.0020121769048273563, -0.02485283836722374, 0.011235472746193409, -0.010424057953059673, 0.00931817851960659, 0.02685520052909851, -0.005342902150005102, -0.0018518571741878986, 0.004681992344558239, -0.009311635047197342, -0.015861842781305313, -0.013833307661116123, 0.009782779030501842, -0.0006024261238053441, 0.0024587821681052446, -0.006079064682126045, -0.02163335680961609, -0.014160490594804287, -0.003677539760246873, 0.028268631547689438, -0.019107501953840256, -0.01669943332672119, -0.009298548102378845, -0.016764869913458824, 0.025062236934900284, 0.06643128395080566, -0.0030117216520011425, 0.013623910024762154, 0.004845583811402321, -0.006438966374844313, -0.017026616260409355, -0.017785681411623955, -0.02405451238155365, 0.016385337337851524, -0.03633042797446251, 0.0004408794338814914, -0.03329416736960411, -0.010253923013806343, -0.02065180614590645, 0.010273553431034088, -0.059468824416399, -0.019487034529447556, 0.019971264526247978, -0.014029617421329021, -0.013244377449154854, 0.023439407348632812, 0.04588417708873749, -0.018741056323051453, -0.09449052065610886, -0.02317766100168228, 0.03525726497173309, -0.014160490594804287, 0.0051825824193656445, -0.025297807529568672, 0.016908830031752586, -0.004560934379696846, 0.0012113959528505802, -0.02545485645532608, -0.00200236146338284, -0.021463220939040184, 0.02049475908279419, -0.009193848818540573, 0.00456420611590147, -0.04478484392166138, -0.015744058415293694, -0.03216865658760071, 0.02171188034117222, -0.026056872680783272, -0.017092052847146988, -0.018348436802625656, 0.016450773924589157, 0.017903467640280724, -0.046800289303064346, 0.0005476229707710445, -0.004495497792959213, 0.021489394828677177, -0.009730429388582706, -0.0025994707830250263, -0.038502924144268036, -0.023517930880188942, 0.020821942016482353, 0.016306811943650246, -0.03742976114153862, 0.013623910024762154, -0.012930281460285187, 0.011451413854956627, 0.002288646763190627, 0.03834587708115578, 0.030598176643252373, -0.05124998465180397, 0.03235187754034996, -0.01889810338616371, 0.011183123104274273, -0.031304892152547836, 0.011124229989945889, -0.025899825617671013, -0.014382975175976753, -0.022706517949700356, 0.007446690462529659, 0.0007136684725992382, -0.010155768133699894, -0.02999616041779518, -0.003481229767203331, -0.006448781583458185, -0.01461854763329029, 0.025166934356093407, 0.00859837606549263, -0.008532938547432423, -0.04292644187808037, 0.012439507059752941, 0.019761867821216583, -0.0037168015260249376, -0.04085864499211311, 0.0034354240633547306, 0.007446690462529659, 0.00017340711201541126, -0.029943810775876045, -0.06318562477827072, -0.007485952693969011, -0.0037004423793405294, -0.012714340351521969, 0.0289753470569849, -0.01232826430350542, -0.002787601202726364, 0.01158883050084114, 0.04227207601070404, -0.02913239598274231, 0.02753574214875698, 0.065174899995327, -0.04918218404054642, 0.015181302092969418, 0.01741923578083515, 0.0019058423349633813, 0.03387000784277916, 0.03394853323698044, 0.02735251933336258, -0.021659530699253082, 0.028242457658052444, 0.027902187779545784, -0.020965902134776115, 0.008552569895982742, -0.020010527223348618, 0.0065763830207288265, -0.03564988449215889, -0.022379333153367043, -0.0009488313808105886, 0.030859922990202904, -0.01054838765412569, 0.02587365172803402, 0.038581449538469315, -0.048737216740846634, 0.004469322971999645, 0.02719547040760517, 0.004848855547606945, 0.010260466486215591, 0.02777131274342537, 0.02387128956615925, -0.010914833284914494, -0.01308732945472002, 0.02105751261115074, -0.036880094558000565, 0.0017193478997796774, -0.03656600043177605, 0.009017170406877995, 0.05310838297009468, 0.018767230212688446, 0.017680982127785683, -0.004776875488460064, 0.004914292134344578, 0.034759946167469025, 0.010816678404808044, 0.03360826149582863, -0.004894661251455545, -0.01753702200949192, -0.026410231366753578, 0.03109549544751644, -0.01583566889166832, -0.004446420352905989, 0.030545827001333237, -0.003962188959121704, 0.02603069879114628, -0.007132594473659992, -0.024303171783685684, 0.03326799347996712, 0.05742720142006874, 0.014265188947319984, -0.04617210105061531, 0.01338833849877119, 0.023243097588419914, 0.03753446042537689, 0.0390264168381691, 0.021162211894989014, 0.002882484346628189, 0.029341792687773705, 0.04860634356737137, -0.03745593875646591, -0.02125382423400879, 0.024669617414474487, 0.02205215021967888, -0.029786761850118637, 0.005002631805837154, -0.01274705957621336, 0.007224205881357193, 0.023779677227139473, 0.01669943332672119, -0.03962843492627144, -0.004089790396392345, 0.008474046364426613, -0.009292003698647022, 0.03897406905889511, -0.0031638620421290398, -0.006200122646987438, 0.036382775753736496, -0.0431881882250309, 0.004911020398139954, -0.0040341694839298725, 0.0076102823950350285, -0.011104599572718143, -0.02379276603460312, -0.014081967063248158, 0.015783319249749184, -0.006321180146187544, 0.030781399458646774, -0.01177859678864479, 0.010293184779584408, 0.030598176643252373, -0.0052218446508049965, 0.041957978159189224, 0.015508485957980156, 0.03886936977505684, -0.0038116846699267626, -0.03894789144396782, 0.04580565541982651, -0.012661991640925407, 0.007204574998468161, -0.018505483865737915, 0.011006444692611694, 0.01921219937503338, 0.012243197299540043, 0.012714340351521969, 0.0027287083212286234, 0.028949173167347908, 0.02745721861720085, -0.012766689993441105, 0.010044525377452374, 0.028268631547689438, -0.01633298769593239, -0.04266469553112984, -0.055699676275253296, 0.04439222067594528, 0.01431753858923912, -0.01955247111618519, -0.04769022762775421, 0.02939414232969284, -0.0019140220247209072, -0.015508485957980156, 0.017209839075803757, 0.02041623368859291, 0.006520762108266354, 0.001691537327133119, -0.022300809621810913, 0.027980711311101913, -0.021868927404284477, -0.056118469685316086, 0.002494772197678685, -0.002273923484608531, -0.03973313421010971, -0.028163934126496315, -0.027509566396474838, -0.026881374418735504, -0.00470816669985652, 0.023046787828207016, -0.011490675620734692, -0.01461854763329029, 0.03159281238913536, 0.005306912120431662, 0.005225116387009621, 0.0054017952643334866, -0.021109862253069878, 0.023648804053664207, -0.004688535816967487, -0.005944919306784868, -0.0044300612062215805, -0.014893380925059319, -0.006340811029076576, -9.038436837727204e-05, -0.00903680082410574, 0.015181302092969418, 0.042821742594242096, 0.04159153252840042, -0.009233111515641212, -0.007858941331505775, 0.019146762788295746, 0.025350157171487808, 0.02549411915242672, 0.0375082865357399, -0.028844473883509636, -0.021803490817546844, 0.013218202628195286, 0.015063516795635223, 0.011726247146725655, -0.0020579826086759567, 0.0037004423793405294, -0.01490646880120039, 0.007335448171943426, 0.039419036358594894, 0.04363315552473068, -0.00537889264523983, -0.04088481888175011, 0.01329672709107399, -0.002983911195769906, -0.01289756316691637, 0.0007144864066503942, -0.02033771015703678, -0.006435694172978401, 0.024669617414474487, 0.009959457442164421, 0.006478228140622377, -0.01460545975714922, -0.000447832077043131, -0.0035303072072565556, 0.025559555739164352, 0.04567478224635124, 0.024879014119505882, 0.007845854386687279, -0.002787601202726364, 0.034759946167469025, -0.005820590071380138, -0.017811855301260948, -0.0032047599088400602, -0.01422592718154192, -0.0023426320403814316, 0.02367497980594635, -0.005944919306784868, 0.027902187779545784, 0.006667994428426027, 0.014396063052117825, 0.050778839737176895, 0.04981037601828575, 0.026357881724834442, 0.001184403314255178, 0.0029953625053167343, -0.009455596096813679, -0.022667255252599716, -0.004446420352905989, 0.004793234635144472, 0.020808855071663857, -0.023923639208078384, 0.014801769517362118, -0.005787871778011322, 0.006232840940356255, -0.0047179823741316795, 0.016149764880537987, 0.024041425436735153, 0.016372250393033028, -0.0068184989504516125, -0.010711979120969772, -0.020664893090724945, -0.023583367466926575, -0.023949813097715378, -0.0008596739498898387, 0.014356800355017185, 0.005771512631326914, -0.019042065367102623, -0.0015557563165202737, -0.02499680034816265, -0.018911192193627357, 0.00536907697096467, 0.004364624619483948, -0.015181302092969418, 0.007328904699534178, 0.03473377227783203, -0.03575458377599716, -0.004780147224664688, 0.020167574286460876, 0.0005292188725434244, 0.008604919537901878, 0.016948092728853226, -0.004560934379696846, 0.019068239256739616, 0.008951733820140362, -0.007525214459747076, -0.02307296171784401, -0.024368608370423317, -0.045517731457948685, -0.012079604901373386, -0.005817317869514227, -0.014513848349452019, 0.0363566018640995, 0.008035620674490929, 0.008434783667325974, -0.015940368175506592, -0.018322261050343513, 0.012930281460285187, -0.006281918380409479, -0.008637637831270695, -0.009089150466024876, -0.004325362388044596, 0.05774129927158356, -0.0013152766041457653, -0.025323983281850815, -0.005601377226412296, -0.03209013119339943, 0.029027696698904037, -0.011863664723932743, -0.0061215986497700214, -0.017262188717722893, 0.011392520740628242, -0.00480959378182888, 0.020730329677462578, -0.02709077298641205, -0.006713800132274628, 0.01308732945472002, -0.0074205161072313786, 0.006936284713447094, 0.024761227890849113, 0.032901547849178314, 0.024381695315241814, 0.01989274099469185, -0.005833677016198635, 0.008212299086153507, 0.0021250550635159016, 0.015927279368042946, 0.0021070600487291813, -0.03507404401898384, 0.00514332065358758, 0.014278276823461056, 0.018741056323051453, 0.0022395693231374025, -0.035623710602521896, -0.038319703191518784, 0.022183023393154144, -0.021384697407484055, 0.0011606825282797217, -0.018230650573968887, 0.019840391352772713, -0.016346074640750885, 0.0007496586185880005, -0.02379276603460312, -0.0005198123981244862, 0.009710798971354961, 0.01179822813719511, 0.004884846042841673, 0.04347610846161842, 0.006667994428426027, 0.011693528853356838, 0.02787601202726364, 0.036723047494888306, 0.012838670052587986, 0.0017389788990840316, 0.014212840236723423, -0.028478030115365982, 0.009769692085683346, -0.01859709620475769, -0.03339886665344238, -0.0014641450252383947, 0.020390059798955917, 0.03931433707475662, -0.027797488495707512, 0.01524673867970705, -0.04250764846801758, 0.00715876929461956, 0.010960638523101807, -0.01528600137680769, 0.012145042419433594, 0.02553337998688221, -0.002478413050994277, 0.03845057636499405, -0.03693244606256485, -0.013794045895338058, -0.012590011581778526, -0.0018191388808190823, 0.008735792711377144, 0.005447600968182087, -0.027588091790676117, 0.007139138411730528, -0.0022101227659732103, 0.011163492687046528, 0.009082606993615627, 0.020062876865267754, -0.014814857393503189, 0.013715521432459354, 0.01215812936425209, 0.0013798953732475638, 0.010031438432633877, 0.02829480729997158, -0.03868614509701729, 0.05245401710271835, -0.022968264296650887, 0.02625318430364132, 0.04004722833633423, -0.01009687501937151, -0.018204474821686745, -0.012393700890243053, 0.0016359161818400025, 0.015390699729323387, 0.0024964080657809973, 0.017170576378703117, -0.014880293980240822, -0.0053887078538537025, 0.015050428919494152, 0.011006444692611694, -0.01939542219042778, 0.0014616911066696048, -0.032901547849178314, 0.007309273816645145, 0.02545485645532608, 0.002411340596154332, 0.018361523747444153, -0.04117273911833763, 0.021829666569828987, 0.002373714465647936, 0.0001853697613114491, 0.018623270094394684, -0.008519851602613926, 0.031200194731354713, 0.020808855071663857, -0.018780319020152092, -0.006501131225377321, -0.022169936448335648, 0.024002162739634514, 0.009959457442164421, -0.003168769646435976, 0.01959173195064068, -0.0016326443292200565, -0.02493136376142502, -0.01337525062263012, 0.01263581681996584, -0.011883295141160488, 0.03203778341412544, 0.004096334334462881, -0.027561916038393974, 0.007446690462529659, 0.01301534939557314, -0.01291719451546669, -0.02143704518675804, -0.004397342912852764, -0.009933283552527428, 0.002998634474352002, 0.016804130747914314, -0.009593012742698193, 0.02185584045946598, -0.007361622992902994, -0.034184105694293976, 0.025768952444195747, -0.01951320841908455, 0.018426960334181786, 0.025886738672852516, 0.004237023182213306, 0.01955247111618519, -0.00437443982809782, 0.021764229983091354, 0.02753574214875698, 0.0005263560451567173, -0.015142040327191353, -0.01524673867970705, -0.026161571964621544, -0.0023279087617993355, 0.021803490817546844, -0.024303171783685684, 0.01989274099469185, 0.00979586597532034, 0.03151429072022438, 0.009612644091248512, -0.01841387338936329, -0.0009766420116648078, -0.007571020163595676, 0.007989814504981041, -3.276944698882289e-05, 0.002267379779368639, -0.004580565262585878, -0.033006247133016586, -0.003847674932330847, -0.009141500107944012, -0.01132708415389061, -0.0076102823950350285, -0.027404868975281715, 0.004855399485677481, -0.021423958241939545, -0.0007647908059880137, 0.026907550171017647, 0.016071241348981857, 0.012596555054187775, 0.009292003698647022, -0.0037102580536156893, 0.017379973083734512, -0.008716161362826824, 0.015037341974675655, 0.017131313681602478, -0.02477431483566761, 0.005856580100953579, 0.019788041710853577, 0.0008735792362131178, 0.047376133501529694, 0.01121584139764309, 0.007714980747550726, 0.04784727841615677, 0.00014641450252383947, -0.028242457658052444, 0.009586469270288944, 0.017641721293330193, 0.011739335022866726, -0.023243097588419914, -0.028478030115365982, 0.011902926489710808, 0.002695990027859807, 0.0024129764642566442, -0.012452594004571438, 0.014945730566978455, -0.016542384400963783, 0.008375890552997589, 0.02405451238155365, 0.017746418714523315, 0.02579512633383274, 0.0017520663095638156, 0.01863635703921318, -0.025310896337032318, -0.015704795718193054, -0.02541559375822544, -0.004161770921200514, 0.006628732662647963, -0.0004658271500375122, -0.007675718981772661, 0.020704155787825584, 0.038319703191518784, 0.00579441525042057, 0.009442508220672607, 0.02249711938202381, 0.016228288412094116, -0.034759946167469025, -0.008336628787219524, 0.025624992325901985, 0.008395521901547909, 0.0012776505900546908, 0.0022248460445553064, -0.01655547134578228, -0.0009578289464116096, 0.020102137699723244, -0.04740230739116669, 0.039602261036634445, -0.025363244116306305, -0.024800490587949753, -0.04172240570187569, 0.08511999249458313, 0.002601106883957982, 0.03227335587143898, -0.03656600043177605, 0.03235187754034996, 0.02913239598274231, 0.012073061428964138, -0.035204917192459106, -0.04504659026861191, 0.04690498858690262, -0.053579527884721756, 0.001995817758142948, -0.030100857838988304, -0.0005059071118012071, 0.034262627363204956, -0.019146762788295746, -0.019722605124115944, -0.010685804300010204, -0.0017242557369172573, -0.01141869556158781, 0.013911831192672253, -0.025939088314771652, 0.0038247720804065466, -0.00789820309728384, -0.00793746579438448, 0.014958817511796951, 0.025559555739164352, -0.0025242187548428774, -0.015613184310495853, 0.01951320841908455, 0.012400245293974876, 0.03007468394935131, 0.005326543003320694, 0.008460958488285542, -0.02511458657681942, 0.01655547134578228, -0.005774784367531538, -0.029498841613531113, -0.005319999530911446, 0.006517490372061729, 0.022588731721043587, -0.007283098995685577, -0.00376915093511343, 0.0014567833859473467, 0.0058663953095674515, -0.03473377227783203, -0.005660269875079393, 0.0033372691832482815, -0.0541815459728241, -0.0046787201426923275, 0.023439407348632812, 0.022169936448335648, -0.00859837606549263, -0.017707157880067825, 0.02307296171784401, 0.01667325757443905, -0.007054070942103863, 0.01064654253423214, 0.022929001599550247, 0.026528017595410347, 0.00878814235329628, -0.004659089259803295, 0.03159281238913536, -0.013807132840156555, 0.02193436399102211, 0.02863507717847824, -0.010195029899477959, -0.007034439593553543, 0.04159153252840042, 0.014880293980240822, 0.04787345230579376, 0.02057328261435032, -0.00827773567289114, -0.027745138853788376, 0.01629372499883175, 0.001594200381077826, 0.010731610469520092, 0.0014420601073652506, 0.03962843492627144, 0.03949756175279617, -0.006530577316880226, -0.027221646159887314, 0.022366246208548546, 0.007139138411730528, -0.022104499861598015, 0.009560294449329376, 0.027509566396474838, 0.0023311804980039597, 0.02829480729997158, -0.015272913500666618, -0.0027385237626731396, -0.009350896812975407, 0.01659473404288292, 0.017484672367572784, -0.008101057261228561, -0.010973726399242878, 0.004567477852106094, -0.009913652203977108, 0.014252102002501488, 0.01498499233275652, 0.007970184087753296, 0.008362803608179092, 0.02007596381008625, -0.0006449599750339985, -0.0012809224426746368, 0.02913239598274231, 0.012524574063718319, -0.002097244607284665, -0.026645803824067116, -0.002910295035690069, 0.020848115906119347, -0.01745849847793579, -0.02447330579161644, -0.028268631547689438, -0.02041623368859291, -0.04478484392166138, 0.004940466955304146, 0.010234291665256023, 0.009566837921738625, 0.014356800355017185, -0.010960638523101807, -0.02727399580180645, -0.004721254110336304, 0.005274193827062845, -0.011817858554422855, 0.025166934356093407, 0.04488953948020935, 0.019945090636610985, 0.019866567105054855, -0.03572840988636017, -0.008729249238967896, -0.022039063274860382, -0.033503562211990356, 0.015102778561413288, -0.02887064963579178, -0.01291719451546669, -0.02393672615289688, -0.0036906269378960133, -0.04088481888175011, 0.027561916038393974, -0.02557264268398285, -0.023439407348632812, 0.026069961488246918, -0.0008850306621752679]",Token-level Direct Preference Optimization.pdf
"h
logσ
βlogπθ(yw|x)
πSFT(yw|x)−βlogπθ(yl|x)
πSFT(yl|x)i
(7a)
=− E
(x,yw,yl)∼D HFh
logσ
brθ(x,yw)−brθ(x,yl)i
(7b)
LODPO(θ) =− E
(x,yw,yl)∼D HFh
logσ
brθ(x,yw)−brθ(x,yl)−∆ri
(7c)
Note that Z(x)is, in general, difficult to compute
as it involves a sum over a countably infinite set.
Nevertheless, we can write the reward as a function
ofπ⋆
θby rearranging the terms,
r(x,y) =βlogπ⋆
θ(y|x)
πSFT(y|x)+βlogZ(x).(10)
Under the assumption that the preference data
is well-modeled by the Bradley–Terry model
(Eq. (5a)), we substitute the reward in Eq. (6) with
Eq. (10), and formulate the loss function in terms
of the language model parameters. Therefore, we
directly optimize the language model by maximiz-
ing the likelihood of the preference data in Eq. (7b).
In this equation, brθ(x,y) = βlogπθ(y|x)
πSFT(y|x)is
called the estimated reward . Note that the
intractable normalization factor Z(x)cancels out.
Simply put, Eq. (7b) requires the estimated re-
ward for the preferred response to be larger than
the estimated reward for the dispreferred response.
A strong assumption behind the DPO’s loss is that
the preference data is well-modeled by a Bradley–
Terry model. However, the Bradley–Terry model
only tells us the probability that one response is
preferred over another, and not the extent to which
this preference will hold. To enhance DPO, we will
introduce our modification to DPO, which gener-
alizes DPO and introduces an offset between the
responses in its loss function.
5 DPO with an Offset
The intuition behind ODPO is simple: we want the
estimated reward for the preferred response to be
larger than the estimated reward for the dispreferred
response, by an offset that is a function of the actual
reward differences assigned to the two responses.
To begin our exposition of ODPO, we first discuss
the connection between the Bradley–Terry model
and Gumbel random variables, which we then use
to construct the loss function for ODPO.
Theorem 1. Letywandylbe two responses
to a prompt x, and let brθ(x,yw)andbrθ(x,yl)be their associated estimated rewards. Finally,
letRw∼Gumbel( brθ(x,yw),1)andRl∼
Gumbel( brθ(x,yl),1)be Gumbel random vari-
ables. Then, we have,
P(Rw−Rl>0) = pBT(yw≻yl|x)
=σ(∆brθ), (11)
where pBT(yw≻yl|x)is a Bradley–Terry
model Eq. (5a) parameterized by brθ(x,yw)and
brθ(x,yl), and ∆brθdef=brθ(x,yw)−brθ(x,yl)is
the difference between the estimated rewards.
Proof. The proof is simple and follows directly
from the Gumbel-max trick (Maddison and Tarlow,
2017). See App. A for details. ■
Theorem 2. Letywandylbe two responses for a
prompt x. Given a desired offset ∆rbetween the
responses’ reward values,
P 
Rw−Rl>∆r
=σ(∆brθ−∆r). (12)
where ∆brθdef=brθ(x,yw)−brθ(x,yl).
Proof. The difference between two independent
Gumbel variables Rw∼Gumbel( brθ(x,yw),1)
andRl∼Gumbel( brθ(x,yl),1)follows the lo-
gistic distribution. Therefore, the probability of
the difference between the noisy estimated rewards
being greater than ∆ris,
P 
Rw−Rl>∆r
= 1− F 
∆r
, (13)
whereF(·)is the","[0.024803288280963898, 0.008530694991350174, 0.029448427259922028, 0.014044972136616707, 0.010312792845070362, 0.027403397485613823, 0.01217523030936718, 0.0261909868568182, 0.0027370532043278217, 0.01577594317495823, 0.03149345889687538, -0.0030091151129454374, -0.023108836263418198, -0.008545302785933018, 0.03082151897251606, -0.019661499187350273, 0.0761919617652893, -0.010590332560241222, 0.0028666933067142963, 0.035116080194711685, -0.03672289103269577, -0.008216637186706066, -0.013416855596005917, 0.013212352059781551, 0.018405267968773842, -0.003686531214043498, 0.011371825821697712, -0.008691376075148582, 0.030208010226488113, -0.03686896339058876, 0.0275786854326725, -0.0284259133040905, -0.02294815517961979, -0.06392178684473038, 0.017923224717378616, -0.0014086967566981912, 0.009071167558431625, 0.07554923743009567, 0.023474019020795822, 0.010203237645328045, -0.00831158459186554, -0.028352875262498856, -0.059189002960920334, -0.010152111761271954, -0.007062655873596668, 0.04741547256708145, 0.057056326419115067, -0.00808517076075077, 0.031026022508740425, 0.003153362777084112, -0.04852563142776489, 0.06310377269983292, -0.017134428024291992, -0.019208671525120735, 0.005558098666369915, 0.007573913317173719, 0.008961612358689308, 0.025387583300471306, 0.03645995631814003, -0.0270382147282362, -0.012408947572112083, -0.008209333755075932, 0.0254606194794178, 0.012781435623764992, 0.002470468869432807, -0.013489891774952412, -0.08203490823507309, 0.041601747274398804, 0.012898294255137444, 0.04724018648266792, 0.0270382147282362, 0.01605348289012909, 0.07227718830108643, -0.001651544007472694, -0.005006670951843262, -0.012503895908594131, 0.05071673542261124, 0.024993184953927994, 0.023999884724617004, -0.038212839514017105, 0.004115622024983168, -0.0010188630549237132, 0.00915150810033083, -0.03450257331132889, -0.029623715206980705, -0.038475774228572845, -0.06660953909158707, -0.02126830816268921, -0.031055236235260963, -0.009158811531960964, -0.01576133631169796, -0.021034590899944305, 0.013971935026347637, 0.01513321977108717, 0.02630784548819065, -0.03832969814538956, 0.013533714227378368, 0.0008367275586351752, 0.021984068676829338, -0.024817895144224167, -0.013774735853075981, -0.045224372297525406, 0.008815539069473743, -0.030996806919574738, 0.03368455916643143, -0.012562325224280357, -0.02421899512410164, 0.009326796047389507, -0.02886413410305977, 0.018755843862891197, -0.0168714951723814, 0.004272651392966509, -0.05658889189362526, 0.0318148173391819, 0.010670673102140427, -0.0335092730820179, -0.06053287908434868, 0.0028612157329916954, 0.00815820787101984, -0.030879948288202286, -0.05106731131672859, -0.015016361139714718, 0.00320448842830956, 0.003911119420081377, -0.011612847447395325, 0.002362739760428667, 0.00039736571488901973, -0.07852914184331894, 0.004940937738865614, -0.022626793012022972, 0.03134738281369209, 0.026117950677871704, 0.0045063691213727, -0.0549236536026001, -0.05761140584945679, 0.018346836790442467, 0.013592143543064594, 0.025504441931843758, -0.005850245710462332, -0.008516088128089905, -0.0013073582667857409, -0.030733874067664146, -0.043675992637872696, -0.006558702327311039, -0.0916757583618164, -0.0024759466759860516, 0.007194122299551964, -0.009889178909361362, -0.05731926113367081, 0.04487379267811775, 0.0018341359682381153, -0.0021454552188515663, 0.011006642132997513, 0.007610431872308254, -0.00034966354724019766, -0.06105874478816986, 0.011853868141770363, 0.05133024603128433, 0.015673691406846046, -0.020026683807373047, -0.027359575033187866, 0.02591344714164734, -0.02671685256063938, -0.02221778593957424, 0.0328957624733448, 0.05378428101539612, -0.029360784217715263, 0.018931131809949875, -0.05951036512851715, -0.014607354998588562, -0.015513011254370213, 0.031142881140112877, -0.062285762280225754, -0.045370444655418396, -0.014877591282129288, 0.013394944369792938, -0.019632285460829735, -0.0301203653216362, 0.0027753973845392466, -0.05363820865750313, -0.0042215255089104176, 0.019456997513771057, 0.030763089656829834, -0.0033889063633978367, 0.0003829865891020745, 0.010568421334028244, 0.0025708945468068123, -0.009268366731703281, 0.0008422053069807589, -0.0030876295641064644, 0.046217672526836395, 0.03818362578749657, 0.08916329592466354, -0.0428287647664547, -0.03648917376995087, -0.03523293882608414, 0.07180975377559662, 0.038358915597200394, -0.0051235295832157135, 0.018755843862891197, 0.035262156277894974, 0.0362846702337265, 0.039060067385435104, -0.0596272237598896, -0.028367483988404274, 0.027228109538555145, -0.006215429399162531, 0.011773527599871159, -0.03207775205373764, -0.013504499569535255, 0.016009660437703133, -0.02097616158425808, 0.05743611976504326, -0.001511861220933497, -0.02350323460996151, 0.008742501959204674, -0.027680937200784683, 0.058896854519844055, 0.04055001586675644, 0.053112342953681946, -0.007095522712916136, 0.03683974966406822, 0.03219461068511009, 0.005485061556100845, -0.024131350219249725, 0.0003985069051850587, 0.05758219212293625, -0.025928054004907608, 0.015104005113244057, -0.019734537228941917, 0.04347148910164833, 0.020581763237714767, -0.00028210453456267715, -0.015469188801944256, 0.03409356623888016, -0.0013082711957395077, 0.005580009426921606, -0.015717513859272003, 0.0013210526667535305, -0.035963308066129684, -0.002523420611396432, 0.04233211278915405, 0.002970770699903369, -0.04078373312950134, 0.0016131997108459473, 0.019471604377031326, -0.03161031752824783, -0.004612272139638662, -0.01590740866959095, -0.02180878072977066, 0.03359691798686981, 0.005335336551070213, 0.011422951705753803, -0.01827380061149597, -0.05489443987607956, -0.0024960318114608526, 0.0189895611256361, -0.017660291865468025, -0.022714436054229736, 0.001302793505601585, 0.01869741454720497, -0.025811195373535156, 0.008757108822464943, 0.02788544073700905, 0.005054144654422998, -0.027666330337524414, -0.018405267968773842, -0.031435027718544006, -0.012430858798325062, 0.016287200152873993, 0.017645685002207756, -0.018755843862891197, -0.02351784147322178, 0.034677859395742416, -0.03830048441886902, -0.051301028579473495, 0.01885809563100338, 0.029506856575608253, -0.03993650898337364, -0.03310026600956917, -0.00030218964093364775, -0.002154584741219878, 0.03824205324053764, 0.004090059548616409, 0.018069297075271606, -0.03470707684755325, -0.028498949483036995, 0.022290823981165886, -0.021180665120482445, -0.014220260083675385, -0.027359575033187866, -0.04671432077884674, 0.014870286919176579, -0.04192310944199562, 0.0008983523002825677, -0.0006208125851117074, 0.003215444041416049, -0.06357120722532272, 0.00942174345254898, 0.024715645238757133, 0.04884699359536171, 0.01589280180633068, -0.026775281876325607, 0.016272593289613724, -0.010539206676185131, -0.02378077432513237, 0.04014101251959801, 0.018931131809949875, -0.02250993438065052, -0.03809598088264465, 0.0012964027700945735, 0.003936682362109423, -0.011276878416538239, 0.03719032555818558, -0.021633492782711983, 0.0033268250990659, 0.06812870502471924, 0.007990223355591297, -0.01787940226495266, -0.039322998374700546, -0.004195962566882372, -0.0211076270788908, -0.012927508912980556, -0.04443557187914848, 0.007373062428086996, -0.001007907441817224, -0.013183137401938438, -0.006222733296453953, -0.005185611080378294, -0.028221409767866135, -0.009545906446874142, 0.019953647628426552, -0.0066536501981318, 0.040170226246118546, 0.011101589538156986, -0.0309675931930542, -0.03575880452990532, 0.0653240904211998, 0.05489443987607956, -0.004908071365207434, -0.06105874478816986, 0.02589884027838707, -0.016243377700448036, -0.035408228635787964, 0.016666991636157036, -0.0023207433987408876, 0.044260285794734955, 0.04277033358812332, 0.030500156804919243, 0.05840020626783371, -0.016842279583215714, -0.0008367275586351752, 0.03108445182442665, 0.01704678311944008, 0.015936624258756638, 0.01912102662026882, 0.0107656205072999, -0.05150553211569786, -0.025942662730813026, 0.01871202141046524, -0.029945077374577522, -0.012394340708851814, 0.007654253859072924, 0.024262815713882446, 0.001253493595868349, -0.0010097334161400795, -0.0027973083779215813, -0.03140581399202347, 0.0015995053108781576, -0.03082151897251606, -0.034970007836818695, 0.05246961861848831, -0.05711475759744644, 0.020055897533893585, -0.051184169948101044, 0.004743738565593958, -0.004057192709296942, 0.021589670330286026, 0.03169795870780945, 0.005926934070885181, 0.0022623140830546618, -0.01321965642273426, -0.016155734658241272, -0.013336515054106712, -0.0004993889597244561, 0.006832590326666832, 0.01286907959729433, -0.0008723329519852996, -0.025124650448560715, -0.03476550430059433, 0.006887367926537991, 0.0035568908788263798, -0.002379172947257757, 0.011926905252039433, -0.05977329611778259, 0.007051700726151466, -0.012365126051008701, 0.069180428981781, 0.04972343519330025, 0.051593177020549774, -0.06351277977228165, -0.001027992577292025, -0.08448894321918488, -0.024306638166308403, -0.03897242248058319, -0.02350323460996151, 0.02674606628715992, 0.04279955103993416, 0.018215371295809746, 0.030733874067664146, 0.05556637793779373, -0.02547522634267807, 0.034531787037849426, -0.03093837760388851, 0.005901371594518423, -0.031464241445064545, 0.02337176725268364, 0.023736951872706413, 0.033421628177165985, 0.04236133024096489, 0.018200764432549477, -0.021604277193546295, -0.007931794039905071, -0.010429651476442814, -0.03447335585951805, 0.04090059548616409, -0.0240729209035635, 0.020581763237714767, 0.04761997610330582, -0.06777812540531158, -0.006730338558554649, 0.040053367614746094, 0.056647323071956635, -0.013847772032022476, -0.03873870521783829, -0.02296276204288006, 0.029901254922151566, -0.016506310552358627, 0.009991430677473545, -0.03429806977510452, 0.013672484084963799, 0.02435046061873436, -0.0008485960424877703, 0.023824594914913177, -0.006912930868566036, 0.0280022993683815, 0.020581763237714767, -0.008187422528862953, 0.026979783549904823, -0.005021278280764818, -0.010604939423501492, 0.033567700535058975, 0.02857198566198349, -0.025986485183238983, -0.02940460480749607, -0.045253586024045944, 0.04373442009091377, 0.014789946377277374, 0.0006253774045035243, -0.010305488482117653, 0.016097305342555046, -0.03494079411029816, 0.02236386016011238, -0.024963969364762306, -0.009889178909361362, 0.012576932087540627, -0.010159415192902088, -0.016652384772896767, -0.05921821668744087, 0.03219461068511009, -0.024292031303048134, -0.03225303813815117, 0.022889725863933563, -0.03199010714888573, -0.023050405085086823, 0.009867268614470959, 0.02280208095908165, 0.0038417342584580183, 0.010568421334028244, -0.01265727262943983, 0.039322998374700546, -0.00703709339722991, -0.003043807577341795, -0.03701503574848175, 0.05696868523955345, 0.046246886253356934, 0.08764412999153137, -0.007953704334795475, -0.040462374687194824, -0.03193167597055435, 0.004239784553647041, -0.04420185461640358, 0.06795341521501541, -0.01830301620066166, -0.008793627843260765, -0.007033441215753555, 0.03952750191092491, -0.0004893463919870555, 0.023897632956504822, -0.014285992830991745, 0.04811662808060646, -0.001933648600243032, -0.018083905801177025, 0.028177587315440178, 0.027344968169927597, -0.0072890701703727245, 0.01520625688135624, 0.0029981594998389482, -0.015732120722532272, 0.02534376084804535, -0.02418977953493595, 0.004557494539767504, -0.027651723474264145, 0.012007245793938637, -0.01758725568652153, 0.008187422528862953, -0.0636296346783638, -0.027768582105636597, -0.02687753364443779, -0.009472869336605072, -0.02351784147322178, -0.02040647529065609, -0.0441434271633625, -0.005784512497484684, 0.004042585380375385, -0.019091812893748283, -0.03219461068511009, -0.0689467117190361, -0.008304281160235405, -0.020625585690140724, 0.03856341540813446, -0.00873519852757454, 0.0003763676213566214, 0.019237887114286423, 0.010232452303171158, -0.0020304222125560045, -0.0127303097397089, -0.010539206676185131, -0.015819765627384186, -0.011766224168241024, 0.016783850267529488, -0.01145946979522705, -0.0057005202397704124, 0.013416855596005917, 0.0019062598003074527, -0.012094889767467976, 0.014862983487546444, -0.0032501365058124065, -0.013599446974694729, 0.0036901829298585653, 0.024131350219249725, -0.01021054107695818, -0.03348005563020706, -0.02490554004907608, -0.03625545650720596, 0.02943382039666176, -0.013701698742806911, 0.009392528794705868, 0.017923224717378616, -0.017660291865468025, -0.008150904439389706, -0.014329815283417702, -0.0021454552188515663, 0.018405267968773842, -0.01140834391117096, 0.030295653268694878, 0.017806366086006165, 0.011335307732224464, 0.017280500382184982, 0.03269125893712044, -0.024569571018218994, 0.00760312844067812, 0.012635362334549427, -0.061701465398073196, 0.00011902712139999494, -0.003502113278955221, 0.033275555819272995, -0.020201971754431725, -0.0030785000417381525, -0.010597635991871357, -0.022685222327709198, 0.007398625370115042, -0.008231244049966335, -0.02659999392926693, -0.05667653679847717, 0.02816298045217991, 0.0036098426207900047, 0.011912297457456589, -0.0360509529709816, 0.009436351247131824, 0.024686429649591446, -0.054952867329120636, -0.016228770837187767, 0.014300600625574589, -0.010867872275412083, 0.019588463008403778, 0.021078413352370262, 0.01533772237598896, 0.025153864175081253, -0.0004706307081505656, 0.04352991655468941, -0.023386375978589058, -0.002412039553746581, -0.04151410236954689, -0.021721135824918747, 0.005291514098644257, -0.009575121104717255, 5.313710857990372e-07, 0.008830145932734013, 0.019895216450095177, 0.00026909486041404307, 0.00032090532477013767, -0.0109774274751544, -0.03310026600956917, -0.05121338739991188, -0.03508686646819115, -0.0164478812366724, -0.019062597304582596, 0.06403864175081253, -0.012401644140481949, -0.0030584149062633514, -0.01730971597135067, 0.044698506593704224, -0.018113119527697563, -0.016944531351327896, 0.005090663209557533, -0.022407682612538338, -0.01869741454720497, 0.024379676207900047, -0.016272593289613724, -0.03529137000441551, -0.024861717596650124, 0.00985996425151825, 0.018098512664437294, 0.010948212817311287, -0.00499936705455184, -0.005338988266885281, 0.011233055964112282, -0.0006742207333445549, -0.05533266067504883, 0.010035253129899502, 0.02040647529065609, 0.01618494838476181, -0.013672484084963799, 0.022305430844426155, -0.019047990441322327, -0.0052221291698515415, 0.03236989676952362, -0.028922563418745995, -0.025533655658364296, -0.004740086849778891, 0.015381544828414917, 0.01316853053867817, -0.018390659242868423, 0.030178794637322426, -0.002339002676308155, -0.005393765866756439, 0.015527618117630482, -0.02040647529065609, -0.02252454124391079, -0.022889725863933563, -0.0337429903447628, 0.0025215945206582546, 0.0020760702900588512, 0.028498949483036995, 0.037073466926813126, 0.018083905801177025, 0.03929378464818001, 0.010517295449972153, -0.012752220965921879, -0.02928774617612362, 0.020800873637199402, 0.0343564972281456, 0.007216033525764942, -0.033713776618242264, 0.01730971597135067, -0.0084357475861907, -0.03388906270265579, -0.03394749388098717, 0.017280500382184982, -0.013570232316851616, -0.013891594484448433, -0.00660982821136713, -0.03470707684755325, -0.0037047904916107655, -0.005324380937963724, 0.06281162798404694, -0.025986485183238983, -0.0059159789234399796, -0.0008230331586673856, -0.01657934859395027, 0.0004338840954005718, 0.03207775205373764, -0.0464513897895813, 0.006733990740031004, 0.026760675013065338, -0.00660982821136713, 0.04534123092889786, -0.005342639982700348, -0.0687129944562912, -0.008983523584902287, 0.020187364891171455, -0.03643074259161949, -0.0060437931679189205, -0.04253661632537842, -0.03444414213299751, -0.013051671907305717, 0.05781590938568115, 0.028966384008526802, -0.02632245421409607, 0.011364522390067577, -0.0016570218140259385, -0.015571440570056438, 0.03546665608882904, 0.011247662827372551, 0.03219461068511009, 0.029200103133916855, 0.01672542095184326, -0.00138861162122339, -0.006891019642353058, -0.018200764432549477, -0.00421787379309535, -0.0337429903447628, -0.006153348367661238, -0.0003930291277356446, -0.020216578617691994, -0.03421042487025261, -0.019588463008403778, -0.03485314920544624, 0.00866216141730547, -0.006284814327955246, 0.014636569656431675, 0.00035491306334733963, -0.04166017472743988, -0.023751558735966682, 0.033976707607507706, 0.015220863744616508, 0.029740573838353157, 0.0013593969633802772, -0.007982918992638588, 0.014797250740230083, -0.0036153204273432493, -0.04811662808060646, -0.006679213140159845, 0.011488684453070164, -0.010027948766946793, 0.01300784945487976, 0.056004598736763, 0.006456451024860144, 0.03251597285270691, -0.01657934859395027, 0.013891594484448433, -0.03809598088264465, -0.011284181848168373, 0.04224447160959244, -0.021443596109747887, 0.014841072261333466, 0.002552635269239545, -0.017543433234095573, -0.015805158764123917, -0.008326192386448383, -0.0005664915079250932, -0.018770450726151466, 0.014760731719434261, 0.00436759926378727, -0.049051497131586075, -0.05208982899785042, -0.024525748565793037, 0.03719032555818558, 0.0070151821710169315, 0.009341403841972351, -0.030324868857860565, -0.018799666315317154, 0.014578140340745449, 0.06497351080179214, 0.0071904705837368965, 0.010254363529384136, -0.04364677518606186, -0.005419328808784485, -0.04274111986160278, -0.043968137353658676, -0.018507517874240875, 0.004345688037574291, -0.03502843528985977, -0.01944238878786564, 0.003051111241802573, 0.0037869566585868597, -0.028250623494386673, 0.03908928111195564, -0.048467203974723816, -0.017265893518924713, -0.008165511302649975, -0.030032722279429436, -0.008705983869731426, 0.04718175530433655, 0.01462926622480154, -0.051038097590208054, -0.12340293079614639, -0.016418667510151863, 0.005455846898257732, 0.009604335762560368, -0.027929263189435005, 0.012540413998067379, 0.07069959491491318, -0.012255570851266384, -0.016097305342555046, -0.007194122299551964, -0.0004537409695331007, -0.020640192553400993, 0.012701095081865788, -0.027797795832157135, 0.0005473193014040589, -0.03897242248058319, -0.011152715422213078, 0.006562354043126106, -0.010371222160756588, -0.029638323932886124, -0.030996806919574738, -0.0062482962384819984, -0.015805158764123917, 0.003474724479019642, -0.040608447045087814, 0.02138516679406166, 0.03123052418231964, -0.023547055199742317, 0.009304884821176529, -0.011605543084442616, 0.006942145526409149, -0.011517899110913277, 0.021560456603765488, 0.003624449949711561, -0.024686429649591446, -0.006303073838353157, 0.00506144855171442, -3.0755330953979865e-05, -0.004597664810717106, 0.03818362578749657, 0.037073466926813126, -0.03938142955303192, 0.039907295256853104, -0.0006477449205704033, 0.0017209290526807308, -0.05442700535058975, -0.010393133386969566, -0.04218604043126106, -0.009085774421691895, -0.04531201347708702, 0.013380337506532669, 9.728726581670344e-05, -0.005130833480507135, -0.009947608225047588, 0.0023444804828613997, -0.017382752150297165, 0.026410097256302834, 0.011474077589809895, -0.017002960667014122, -0.028937170282006264, -0.018098512664437294, 0.017353538423776627, 0.027973083779215813, -0.019237887114286423, -0.032983407378196716, -0.01954464055597782, 0.009458262473344803, -0.006971360184252262, -0.02182338759303093, -0.03207775205373764, -0.027082035318017006, 0.00935601070523262, -0.005952497012913227, 0.023956062272191048, -0.02196946181356907, -0.012649969197809696, 0.018945738673210144, 0.011919601820409298, -0.036664459854364395, 0.029316961765289307, 0.03421042487025261, -0.02773936651647091, 0.024014491587877274, 0.03345084190368652, 0.0222616083920002, 0.03499922156333923, 0.012686487287282944, 0.006204473786056042, -0.0360509529709816, 0.012116800993680954, 0.027534864842891693, -0.017631078138947487, 0.0024394283536821604, -0.00668651657178998, -0.01830301620066166, -0.03388906270265579, -0.004469850566238165, -0.004940937738865614, 0.02309422753751278, 0.00928297359496355, 0.005539839155972004, 0.004882508423179388, -0.03853420168161392, 0.017338929697871208, 0.015264686197042465, -0.036226239055395126, 0.0040243263356387615, 0.022203179076313972, 0.008844753727316856, -0.029667537659406662, -0.004615924321115017, -0.005653046537190676, -0.026965176686644554, -0.007953704334795475, -0.0135191073641181, 0.010656065307557583, 0.051417890936136246, 0.01587819494307041, 0.018931131809949875, -0.003900163806974888, -0.00829697772860527, 0.03093837760388851, 0.014373636804521084, 0.03236989676952362, 0.014914109371602535, -0.006255599670112133, -0.009472869336605072, 0.0085891243070364, -0.03093837760388851, 0.003354213899001479, 0.008209333755075932, 0.0011046811705455184, 0.0059159789234399796, 0.007281766273081303, 0.0002793656603898853, 0.031318169087171555, 0.025942662730813026, 0.021618885919451714, -0.02601569890975952, 0.030733874067664146, -0.007500876672565937, 0.01929631642997265, 0.0065733096562325954, 0.012927508912980556, -0.0006847197655588388, 0.015074790455400944, 0.028104551136493683, -0.03768697381019592, -0.01771872118115425, 0.011868475936353207, 0.027973083779215813, -0.0052769067697227, -0.018332229927182198, -0.03505765274167061, 0.03307105228304863, 0.015936624258756638, 0.017645685002207756, -0.013628661632537842, -0.0014653003308922052, -0.0012014548992738128, 0.008428444154560566, 0.03418121114373207, -0.002548983320593834, -0.006434539798647165, 0.038651060312986374, -0.030500156804919243, -0.026424704119563103, -0.016637777909636497, 0.007858756929636002, -0.008822842501103878, -0.015995053574442863, -0.022173965349793434, -0.002187451347708702, 0.01801086775958538, 0.014607354998588562, 0.010772923938930035, 0.002580024069175124, 0.025533655658364296, -0.004765649326145649, 0.013840468600392342, 0.024175172671675682, 0.02475946582853794, 0.003261091886088252, -0.013621358200907707, 0.02911245822906494, -0.0030182446353137493, 0.03794990852475166, -0.010736405849456787, 0.00780763104557991, 0.03082151897251606, 0.01590740866959095, 0.02405831404030323, -0.002077896147966385, 0.05121338739991188, 0.010195933282375336, 0.01926710084080696, 0.01265727262943983, 0.04811662808060646, 0.018244586884975433, -0.05095045268535614, -0.013942720368504524, 0.01308088656514883, 0.0154837965965271, -0.01027627382427454, -0.03757011517882347, 0.03254518657922745, 0.008238548412919044, 0.003929378464818001, 0.015279293060302734, 0.02461339347064495, 0.015819765627384186, 0.018113119527697563, -0.0362846702337265, 0.0011156367836520076, -0.012752220965921879, -0.051447104662656784, -0.026293238624930382, 0.015848979353904724, -0.030003506690263748, -0.00138861162122339, 0.004557494539767504, -0.018244586884975433, 0.03663524612784386, 0.03038329817354679, 0.0003090368409175426, -0.034005921334028244, 0.006157000083476305, 0.006697472184896469, -0.004115622024983168, 0.017002960667014122, -0.022495325654745102, 0.024861717596650124, -0.04037472978234291, 0.0002439884701743722, -0.009158811531960964, -0.008837449364364147, -0.01379664707928896, -0.008202029392123222, -0.00481677521020174, -0.005609224084764719, 0.0354374423623085, 0.009093078784644604, -0.012043763883411884, 0.0127303097397089, 0.003547761356458068, 0.007552002556622028, 0.006255599670112133, 0.04913914203643799, -0.015965837985277176, -0.008640250191092491, 0.012481984682381153, 0.041455674916505814, -0.008625643327832222, 0.0077126831747591496, 0.006164303980767727, 0.01034931093454361, 0.004345688037574291, 0.029740573838353157, 0.03365534543991089, -0.009874572046101093, -0.037073466926813126, 0.014585443772375584, 0.008779020048677921, -0.021355953067541122, -0.008048652671277523, -0.022027891129255295, 0.0015301203820854425, 0.035671159625053406, 0.006335940212011337, -0.004929982125759125, 0.001937300432473421, 0.012635362334549427, -0.023707736283540726, 0.013431462459266186, 0.034561000764369965, 0.008428444154560566, 0.022758258506655693, 0.021633492782711983, 0.0180254764854908, 0.005203870125114918, -0.008267763070762157, 0.0050249299965798855, -0.02984282560646534, -0.009509388357400894, 0.024701036512851715, -0.0015063834143802524, 0.03093837760388851, 0.006540443282574415, 0.015688298270106316, 0.07180975377559662, 0.032720476388931274, 0.04461086168885231, -0.014746124856173992, 0.010546510107815266, 0.026789888739585876, -0.021575063467025757, -0.007829542271792889, 0.0011485032737255096, -0.007095522712916136, -0.009034648537635803, 0.018492911010980606, 0.009648158214986324, 0.020026683807373047, -0.03339241445064545, 0.024730252102017403, 0.03444414213299751, 0.020757051184773445, 0.022831296548247337, -0.02785622514784336, -0.009253758937120438, -0.002625672146677971, -0.008983523584902287, 0.021355953067541122, 0.03488236293196678, 0.007321936544030905, -0.000550971191842109, -0.0064674061723053455, 0.008077867329120636, -0.010984730906784534, 0.025592084974050522, -0.006357851438224316, -0.024102134630084038, 0.033713776618242264, 0.02716968022286892, -0.014475888572633266, 0.006832590326666832, 0.02928774617612362, -0.00963355042040348, -0.011612847447395325, 0.015965837985277176, 0.004093711264431477, 0.013489891774952412, 0.013489891774952412, -0.04738625884056091, -0.02616177313029766, 0.01745578832924366, -0.0261909868568182, 0.01435172650963068, -0.02337176725268364, -0.03803755342960358, 0.042302899062633514, 0.00801943801343441, 0.01675463654100895, -0.02715507335960865, -0.01286907959729433, 0.020888516679406166, 0.01774793677031994, 0.019091812893748283, -0.00042589567601680756, -0.007982918992638588, 0.09769398719072342, -0.034005921334028244, -0.019223278388381004, 0.01145946979522705, 0.0030182446353137493, 0.008581820875406265, 0.002141803503036499, -0.024043705314397812, -0.030733874067664146, 0.005963452626019716, 0.006222733296453953, 0.029872041195631027, -0.03584644943475723, -0.006339591927826405, 0.030061936005949974, 0.018682807683944702, -0.019383959472179413, 0.03733639791607857, 0.013416855596005917, 0.0072708106599748135, -0.010743709281086922, -0.004323776811361313, -0.022495325654745102, -0.0017583603039383888, 0.019661499187350273, -0.004334732424467802, -0.011590936221182346, -0.010641458444297314, 0.012423555366694927, 0.027929263189435005, -0.014030364342033863, -0.012847168371081352, -0.03634309768676758, 0.003244658699259162, -0.017105212435126305, -0.013891594484448433, -0.012284785509109497, 0.03952750191092491, -0.018682807683944702, -0.03155188634991646, -0.031873248517513275, -0.007559305988252163, -0.01365057285875082, 0.014198348857462406, 0.006799723487347364, 0.020085113123059273, -0.00878632441163063, 0.007851453498005867, 0.012167926877737045, -0.010312792845070362, 0.03476550430059433, -0.005422980524599552, 0.02461339347064495, -0.02562130056321621, -0.003827126929536462, -0.01126957405358553, -0.008326192386448383, -0.006438191514462233, -0.006131437141448259, 0.029360784217715263, -0.0236493069678545, 0.017835579812526703, -0.050190869718790054, 0.02223239466547966, 0.03125973790884018, -0.01747039705514908, 0.005247692111879587, 0.021341346204280853, 0.0022477067541331053, 0.023430196568369865, -0.02477407455444336, -0.0048971157521009445, -0.028192194178700447, -0.019500818103551865, -0.012146015651524067, -0.004849642049521208, -0.04408499598503113, 0.015965837985277176, 0.003547761356458068, 0.019953647628426552, -0.005441239569336176, -0.01815694198012352, 0.015498403459787369, 0.015279293060302734, -0.02337176725268364, -0.006562354043126106, -0.01387698668986559, -0.002003033645451069, -0.029331568628549576, 0.007073611486703157, 0.007212381344288588, 0.021487418562173843, 0.025022398680448532, -0.019749144092202187, -0.011517899110913277, -0.01602426916360855, 0.027140464633703232, 0.0017017568461596966, 0.0007641472620889544, 0.021297523751854897, -0.0008353581069968641, -0.009925697930157185, 0.006872760597616434, 0.03631388396024704, 0.01729510724544525, 0.0010453388094902039, -0.03993650898337364, -0.0019519077613949776, 0.006098570767790079, 0.006065703928470612, 0.026658423244953156, -0.0422152541577816, 0.025256115943193436, -0.0018131379038095474, -0.01048808079212904, 0.010130200535058975, 0.0002604217443149537, 0.024569571018218994, 0.006482013501226902, -0.0054266322404146194, 0.0034272505436092615, -0.009297581389546394, 0.014285992830991745, 0.019077206030488014, -0.014285992830991745, 0.038358915597200394, -0.0005395591724663973, 0.03336319699883461, -0.021078413352370262, 0.019909825176000595, 0.014987146481871605, 0.009107685647904873, 0.011357218027114868, -0.016564739868044853, -0.024175172671675682, 0.028878740966320038, 0.026249416172504425, -0.0368981771171093, -0.029200103133916855, -0.009020041674375534, 0.01701756753027439, 0.00633228849619627, -0.011715098284184933, 0.022889725863933563, -0.006244644057005644, -0.02239307574927807, -0.007022486068308353, -0.044815365225076675, 0.02911245822906494, 0.003677401691675186, 0.030441727489233017, 0.011883082799613476, -0.04011179506778717, 0.02306501381099224, 0.023999884724617004, -0.01827380061149597, 0.008406532928347588, -0.0266146007925272, -0.018814273178577423, -0.011013945564627647, 0.02898099273443222, -0.012211748398840427, 0.0059671043418347836, 0.041864678263664246, 0.01660856232047081, 0.005422980524599552, -0.015469188801944256, -0.01083135325461626, -0.001531946356408298, 0.0261909868568182, -0.00935601070523262, -0.01785018853843212, 0.017411967739462852, -0.0022239696700125933, -0.025402190163731575, -0.013292692601680756, -0.01379664707928896, -0.02169192209839821, -0.002490554004907608, 0.007230640854686499, -0.011999942362308502, -0.001085509080439806, 0.0068398937582969666, 0.004086407367140055, -0.017835579812526703, 0.033830635249614716, 0.03125973790884018, 0.016009660437703133, 0.005678609013557434, 0.02252454124391079, 0.04195232316851616, -0.01887270249426365, 0.03394749388098717, -0.012277482077479362, 0.025942662730813026, 0.031172094866633415, 0.02575276605784893, -0.010342007502913475, 0.02027500793337822, 0.0013749172212556005, 0.00562748359516263, -0.012927508912980556, 0.010933605022728443, 0.01592201739549637, 0.02137055993080139, -0.029360784217715263, 0.02715507335960865, -0.017105212435126305, -0.0010745535837486386, 0.00725255161523819, 0.028805702924728394, -0.018931131809949875, 0.028820311650633812, 0.03473629057407379, 0.00866216141730547, 0.0038490379229187965, 0.009341403841972351, 0.014600051566958427, -0.03926457092165947, -0.011554418131709099, -0.011751617304980755, -0.020333437249064445, 0.030061936005949974, 0.01885809563100338, -0.014680392108857632, 0.005715127568691969, 0.02264139987528324, 0.03818362578749657, 0.0004085494438186288, 0.010962819680571556, 0.009640853852033615, -0.012408947572112083, -0.01589280180633068, -0.005894067697227001, -0.0019756448455154896, 0.000702522462233901, 0.0022057106252759695, -0.02066940627992153, -0.015673691406846046, 0.006146044470369816, -0.04981108009815216, 0.01830301620066166, -0.026497742161154747, -0.020362652838230133, -0.014884894713759422, 0.038212839514017105, 0.009808838367462158, -0.002695057075470686, -0.021443596109747887, 0.013460677117109299, 0.01533772237598896, -0.021487418562173843, -0.01830301620066166, -0.049314431846141815, 0.030704660341143608, -0.010268970392644405, -0.02027500793337822, -0.02826523222029209, 0.0038490379229187965, 0.0447569340467453, -0.02689214050769806, -0.007829542271792889, 0.025592084974050522, 0.00407910393550992, -0.0032921326346695423, 0.021282916888594627, -0.019924432039260864, -0.012124104425311089, -0.0058685047551989555, -0.007953704334795475, -0.010568421334028244, 0.016550133004784584, -0.008669464848935604, -0.03421042487025261, 0.015469188801944256, 0.017704114317893982, 0.03155188634991646, -0.003372472943738103, 0.006631738971918821, -0.02956528589129448, 0.02448192611336708, -0.015279293060302734, -0.027213502675294876, 0.00038116067298687994, 0.006649998482316732, 0.026526955887675285, -0.013248871080577374, 0.005645742639899254, -0.008684072643518448, 0.007059004157781601, -0.02756407856941223, -0.0070151821710169315, -0.008128993213176727, -0.04992793872952461, -0.002306136069819331, 0.023663915693759918, 0.009816142730414867, -0.015454581007361412, -0.03418121114373207, 0.017791757360100746, 0.008947004564106464, 0.0024229949340224266, 0.016374845057725906, -0.011415648274123669, 0.0030383297707885504, 0.016506310552358627, -0.011057768017053604, 0.013548322021961212, -0.022685222327709198, 0.01913563534617424, 0.025840410962700844, -0.0018697414780035615, -0.0046524424105882645, 0.04507829621434212, 0.026979783549904823, 0.023693129420280457, 0.0007102826493792236, -0.002552635269239545, -0.008720590732991695, -0.002421169076114893, -0.027491042390465736, -0.012642665766179562, -0.00985996425151825, 0.007909882813692093, 0.03280811756849289, -0.006726686842739582, -0.01589280180633068, 0.013855076394975185, -0.02012893557548523, -0.03184403479099274, 0.00045990344369784, -0.003083977848291397, 0.024701036512851715, 0.012562325224280357, -0.005616527982056141, 0.03683974966406822, 0.005379158537834883, 0.004619576036930084, 0.013146619312465191, -0.016783850267529488, -0.0026494089979678392, 0.0027151419781148434, 0.02492014691233635, -0.0011001164093613625, -0.01153250690549612, 0.00277722324244678, 0.040170226246118546, 0.003202662570402026, -0.011934208683669567, -0.009450959041714668, -0.0025508094113320112, 0.008632946759462357, -0.030441727489233017, -0.030792303383350372, -0.008618338964879513, 0.0007417797460220754, -0.01844908855855465, -0.019909825176000595, -0.0026439311914145947, 0.000776472210418433, -0.028075335547327995, -0.002191103296354413, 0.004878856707364321, 0.027768582105636597, -0.0009440003195777535, 0.012912902049720287, -0.016550133004784584, -0.033012621104717255, -0.000287810544250533, 0.009969519451260567, 0.016404058784246445, 0.06608367711305618, 0.019500818103551865, 0.01110889296978712, 0.0017419271171092987, 0.017514217644929886, -0.012211748398840427, -0.025971876457333565, 0.06041602045297623, -0.002510639140382409, 0.008903183043003082, -0.02421899512410164, 0.006456451024860144, -0.012365126051008701, 0.02012893557548523, 0.00407910393550992, -0.017952438443899155, 0.0377454049885273, -0.0024631652049720287]",Token-level Direct Preference Optimization.pdf
" CDF for logistic distribution. The
mean of this distribution is ∆brθ, and the variance
is1. Substituting the CDF in Eq. (13) with its
definition,
P 
Rw−Rl>∆r
= 1− F(∆r) (14a)
=1
2−1
2tanh1
2(∆r−∆brθ)
(14b)
=1
2−1
2
2σ(∆r−∆brθ)−1
(14c)
= 1−σ(∆r−∆brθ) (14d)
=σ(∆brθ−∆r). (14e)
■
0.2 0.40.60.650.70.750.8DPO ODPO
SFT Sentiment(a)|D HF|= 5000 ,100% of the points
on the Pareto front belong to ODPO.
0 10 200.650.70.750.80.850.9DPO ODPO
SFT Sentiment(b)|D HF|= 7500 ,66% of the points
on the Pareto front belong to ODPO.
0 100 200 3000.650.70.750.80.850.90.95DPO ODPO
SFT Sentiment(c)|D HF|= 10000 ,100% of the points
on the Pareto front belong to ODPO.
Figure 2: Steering generated movie reviews towards positive sentiment. Points on the Pareto front are highlighted
with a black border. We observe that in all 3settings, most (if not all) points on the Pareto front belong to ODPO.
Similar to DPO, we then maximize the likeli-
hood of the preference data, as shown in Eq. (7c).
Intuitively, minimizing the above loss function en-
forces the estimated reward for the preferred re-
sponse ywto be higher than ylby the offset ∆r.
Comparing Eq. (7b) and Eq. (7c), when ∆r= 0,
ODPO will be equivalent to DPO.
Designing ∆r.We choose to model the offset
as a monotonically increasing function f(·)of the
difference between the scores associated with the
responses:
∆r=αf 
score( x,yw)−score( x,yl)
.(15)
where αis a hyperparameter that controls the ex-
tent to which an offset should be enforced. When
α= 0, ODPO becomes equivalent to DPO. In tasks
where a ground-truth reward model r(·)is given
we set score(·) =r(·). In other tasks, one can use
the quality scores given by humans to responses as
score (see §6.3), or ask humans directly for the dif-
ference between the quality of the responses (Tou-
vron et al., 2023). We ablate fin §7.1 and αin §7.2.
Connection to Softmax Margin. We now show
how ODPO is connected to softmax margin (Gim-
pel and Smith, 2010). The idea behind the softmax
margin is to augment the softmax with a cost func-
tion, such that high-cost responses get penalized
more heavily. For two responses per prompt, we
maximize
E
(x,yw,yl)h
logσ
∆brθ−cost(yw,yl)i
.(16)
Importantly, the cost function is by definition a non-
negative function. Therefore, ODPO loss Eq. (7c)
is only equivalent to softmax-margin loss if we
restrict ∆r≥0.6 Experiments
In this section, we empirically compare the perfor-
mance of ODPO with DPO across different tasks.
We refer the reader to App. C for the computational
budget used for conducting the experiments.
6.1 Sentiment Control
In this experiment, we steer generations of
GPT2-Large (Radford et al., 2019) model towards
positive sentiment. Following the experimen-
tal setup in (Rafailov et al., 2023), we fine-tune
GPT2-Large on the train split of IMDB dataset
(Maas et al., 2011) until convergence. This gives
us the SFT checkpoint πSFT.
Reward Model. We use a state-of-the-art binary
sentiment classifier3with sentiments {POS,NEG}
as the reward model. Concretely if the","[0.01279564667493105, 0.015564295463263988, 0.01843770407140255, 0.0154296038672328, 0.011067111976444721, 0.007991666905581951, -0.015414638444781303, 0.052319977432489395, 0.011725600808858871, 0.004856359213590622, 0.04771054908633232, -0.009443337097764015, -0.024334177374839783, -0.02705792896449566, 0.03148776665329933, -0.02487294003367424, 0.07405012845993042, -0.036665886640548706, 0.009637890383601189, 0.030245615169405937, -0.0244539026170969, -0.005806679371744394, -0.034181587398052216, 0.027896005660295486, 0.019634956493973732, 0.0016097447369247675, 0.012780681252479553, 0.017749283462762833, 0.026968134567141533, -0.03030547872185707, 0.033104058355093, -0.04935677349567413, -0.027267448604106903, -0.06043136864900589, 0.020428137853741646, 0.009188920259475708, -0.00114393827971071, 0.06076061353087425, -0.0033822411205619574, -0.006940328516066074, -0.04175421595573425, -0.02749193273484707, -0.023376373574137688, 0.0009348865714855492, -0.021131522953510284, 0.000989604857750237, 0.0389406681060791, -0.02387024089694023, 0.02295733615756035, 0.007037605624645948, -0.06255649030208588, 0.055223315954208374, -0.0067831892520189285, -0.011703153140842915, 0.024962734431028366, -0.0003226972185075283, 0.001078463508747518, 0.0087025361135602, 0.04980574548244476, -0.036665886640548706, -0.019530197605490685, -0.03756382688879967, 0.026564061641693115, -0.017509831115603447, 0.012241916730999947, 0.001577942632138729, -0.12547215819358826, 0.030500032007694244, 0.029317744076251984, 0.020248549059033394, 0.03262515738606453, 0.015863608568906784, 0.04669288545846939, -0.042203184217214584, 0.018497565761208534, -0.028270147740840912, 0.04259229078888893, 0.03777334839105606, 0.030066028237342834, -0.05477434769272804, -0.004149231594055891, 0.017614591866731644, -0.006229459308087826, -0.017464935779571533, -0.02211925759911537, -0.05426551401615143, -0.01580374501645565, -0.020697519183158875, -0.058186519891023636, 0.009308645501732826, -0.02327161468565464, -0.01713569089770317, -0.02018868736922741, 0.01988937333226204, 0.008081461302936077, -0.05106285959482193, 0.009600476361811161, 0.005802937783300877, 0.01668672077357769, 0.003034289227798581, -0.0255912933498621, -0.025875641033053398, -0.0007997279171831906, 0.01507791131734848, 0.01623775064945221, 0.02063765749335289, 0.004515890497714281, 0.010273931547999382, 0.008313428610563278, -0.002706915372982621, -0.05300839617848396, 0.0015461406437680125, -0.05998240038752556, 0.04010799154639244, -0.0012505686609074473, -0.06279594451189041, -0.05893480032682419, 0.03466048836708069, -0.02693820372223854, -0.023092025890946388, -0.055223315954208374, 0.004568270407617092, -0.0032774813007563353, -0.010056928731501102, -0.01522008515894413, -0.011209285818040371, -0.020413171499967575, -0.07440930604934692, -0.002890244824811816, -0.03864135593175888, 0.003546863328665495, 0.010154206305742264, 0.015848642215132713, -0.037833210080862045, -0.04582487791776657, 0.02837490662932396, -0.014382007531821728, 0.021909737959504128, -0.012638507410883904, -0.011733083985745907, -0.002097064396366477, -0.05618111789226532, -0.03828217834234238, 0.010842626914381981, -0.08039557188749313, -0.050284646451473236, -0.015893539413809776, -0.007149848155677319, -0.056689951568841934, 0.054355308413505554, 0.01047596801072359, -0.03495980054140091, -0.03115852177143097, 0.015257499180734158, 0.029183052480220795, -0.04399906471371651, -0.0033111541997641325, 0.014726217836141586, -0.008238600566983223, -0.016462234780192375, -0.0030735740438103676, 0.018677154555916786, -0.00582164479419589, -0.02005399577319622, 0.04253242909908295, 0.05369681864976883, -0.0176894199103117, 0.0031951703131198883, -0.07303246110677719, -0.03190680593252182, 0.010041963309049606, 0.00819370336830616, -0.05692940205335617, -0.0436398908495903, -0.0023346443194895983, -0.03178707882761955, -0.04606432840228081, 0.01902136392891407, -0.017464935779571533, -0.021445803344249725, -0.025052528828382492, 0.00460568442940712, -0.018991433084011078, 0.0035113198682665825, -0.0007122723036445677, -0.015272464603185654, 0.010573244653642178, 0.012443953193724155, 0.0075426967814564705, 0.042203184217214584, 0.05674981325864792, 0.023765482008457184, 0.09386467188596725, -0.005997491534799337, -0.030559895560145378, -0.03717472031712532, 0.06740537285804749, 0.041514765471220016, -0.02928781323134899, -0.010558279231190681, 0.010154206305742264, 0.049386706203222275, 0.01580374501645565, -0.08907565474510193, -0.04010799154639244, -0.001964244060218334, -0.02255326136946678, -0.004325078334659338, -0.02062269113957882, 0.0045645288191735744, 0.03786314278841019, 0.014232350513339043, 0.06237690523266792, 3.0106715712463483e-05, -0.011388873681426048, 0.011890223249793053, -0.05249956622719765, 0.048668354749679565, 0.02047303505241871, 0.050823409110307693, 0.0063716331496834755, 0.05471448227763176, 0.024783147498965263, -0.010296380147337914, -0.0474112369120121, 0.033463235944509506, 0.04331064596772194, -0.02560625784099102, 0.014471800997853279, -0.025785846635699272, 0.04259229078888893, -0.0034290088806301355, -0.014172487892210484, -0.01870708540081978, 0.001797750941477716, -0.01728534698486328, 0.019245849922299385, -0.04597453400492668, 0.011755532585084438, -0.044837143272161484, 0.006446461658924818, 0.038431838154792786, 0.04681261256337166, -0.024379074573516846, 0.01272081770002842, 0.024843009188771248, -0.003543121973052621, -0.019694820046424866, -0.014135073870420456, -0.026369508355855942, 0.016761548817157745, 0.003541251178830862, -0.007449161261320114, -0.050045195966959, -0.04845883324742317, -0.01652209833264351, -0.015324844047427177, -0.013237133622169495, 0.003698390908539295, -0.011598393321037292, 0.009061711840331554, -0.007999150082468987, 0.010947386734187603, 0.0065549626015126705, 0.0028079336043447256, -0.010595693252980709, -0.03965901955962181, -0.011254183016717434, -0.023496098816394806, -0.0151452561840415, -0.0025572585873305798, 0.0027611658442765474, 0.006046129856258631, 0.0658489391207695, -0.0412154495716095, -0.024184519425034523, 0.01530239637941122, 0.023915138095617294, -0.042053528130054474, -0.020981866866350174, -0.002428179606795311, -0.011890223249793053, 0.03058982640504837, 0.022717883810400963, 0.02645930089056492, 0.010977317579090595, -0.012900406494736671, -0.00864267349243164, -0.005125741474330425, -0.006517548579722643, 0.009533130563795567, -0.055223315954208374, 0.004946153610944748, -0.06267622113227844, 0.03130817785859108, 0.020832210779190063, 0.04034744203090668, -0.03555842861533165, 0.01948530040681362, 0.034929871559143066, 0.06399320065975189, 0.0004812397819478065, 0.007954252883791924, -0.007056312635540962, 0.024064794182777405, -0.010992283001542091, 0.015564295463263988, 0.008253565989434719, 0.0002920643601100892, -0.04160455986857414, -0.014456835575401783, -0.001113071572035551, -0.01581871137022972, 0.03439110517501831, -0.01530239637941122, -0.0010522735537961125, 0.0714760348200798, -0.010296380147337914, -0.0037414170801639557, -0.03816245496273041, -0.03663595765829086, -0.04783027619123459, -0.006985225714743137, 0.006375374738126993, 0.026219850406050682, -0.017345210537314415, -0.00666346400976181, 0.018826810643076897, -0.008305946364998817, -0.01625271514058113, -0.00847805105149746, 0.011725600808858871, 0.012032397091388702, 0.03627678006887436, -0.02354099601507187, -0.005671988241374493, -0.02707289345562458, 0.06070075184106827, 0.02705792896449566, 0.005219276994466782, -0.06501086056232452, -0.004890032112598419, 0.0005158478743396699, -0.013446653261780739, -0.008552879095077515, -0.008680087514221668, -0.01257864385843277, 0.05067375302314758, 0.048039793968200684, 0.014845943078398705, -0.0327448807656765, -0.014898322522640228, 0.02415458858013153, 0.020757382735610008, 0.028868773952126503, 0.0044410619884729385, -0.007669905200600624, -0.013094959780573845, -0.032864607870578766, -0.014748666435480118, -0.030649688094854355, -0.018332943320274353, 0.023032164201140404, 0.015190153382718563, 0.03956922888755798, 0.0007183520938269794, -0.010872557759284973, -0.012900406494736671, 0.046154122799634933, -0.04130524396896362, -0.016043197363615036, 0.022164154797792435, -0.04519631713628769, 0.013925554230809212, -0.055402904748916626, 0.020293446257710457, 0.02382534369826317, 0.031966667622327805, -0.005092068575322628, 0.03397206589579582, 0.021281180903315544, 0.0011925767175853252, -0.03337344154715538, -0.0035674411337822676, -0.02442396990954876, 0.004781531170010567, 0.021864840760827065, -0.007168555166572332, -0.019634956493973732, 0.0009119703900068998, -0.02080227993428707, -0.005956335924565792, -0.02238864079117775, 0.04522624984383583, -0.044418103992938995, 0.022358708083629608, -0.013738483190536499, 0.057468168437480927, 0.05501379817724228, 0.04786020889878273, -0.0526791512966156, -0.021101592108607292, -0.059623222798109055, -0.007265831809490919, -0.028793945908546448, -0.017045896500349045, 0.030978932976722717, 0.02592053823173046, 0.011650772765278816, 0.039599157869815826, 0.0526791512966156, -0.03849169984459877, 0.017195552587509155, -0.011156905442476273, 0.001116813044063747, -0.01171811856329441, 0.02574094943702221, 0.014584043994545937, 0.027776280418038368, 0.036785613745450974, -0.012421504594385624, -0.006820603273808956, -0.005454986356198788, -0.019634956493973732, -0.014980633743107319, 0.025815777480602264, -0.004175421316176653, 0.007363108918070793, 0.06201773136854172, -0.050404369831085205, -0.029527263715863228, 0.030559895560145378, 0.03822231665253639, -0.057737547904253006, -0.058186519891023636, -0.019111158326268196, -0.011650772765278816, -0.016716651618480682, -0.002974426606670022, -0.024064794182777405, 0.01860232651233673, -0.008268531411886215, -0.0014105142327025533, -0.0009568674140609801, -0.016058161854743958, -0.01857239380478859, 0.030395273119211197, 0.017225483432412148, -0.001261792960576713, -0.0023795412853360176, -0.027866074815392494, 0.03070955164730549, 0.02592053823173046, -0.011568461544811726, -0.03935970738530159, -0.05351722985506058, 0.05148189887404442, 0.006715843919664621, 0.037384238094091415, 0.00556348729878664, 0.03247550129890442, -0.014973151497542858, -0.017464935779571533, -0.004568270407617092, -0.01132901106029749, 0.009592993184924126, -0.016566995531320572, -0.023092025890946388, -0.03247550129890442, 0.02797083370387554, -0.034480899572372437, -0.006858017761260271, 0.023496098816394806, -0.022628091275691986, -0.03115852177143097, -0.018228184431791306, 0.026249783113598824, -0.020113857463002205, 0.03819238394498825, -0.008201186545193195, 0.0336727537214756, -0.021131522953510284, -0.007849493063986301, -0.013124891556799412, 0.05791713669896126, 0.08985387533903122, 0.04283174127340317, -0.035049594938755035, -0.042951468378305435, 0.007864458486437798, -0.0006505388882942498, -0.03208639472723007, 0.05193087086081505, -0.018976466730237007, -0.00621823500841856, -0.022792713716626167, 0.03379248082637787, 0.0021400905679911375, 0.007729767821729183, -0.02369065396487713, 0.036665886640548706, 0.012017431668937206, -0.019964201375842094, 0.009548095986247063, 0.03552849590778351, -0.0068617588840425014, 0.029617058113217354, -0.014277247712016106, -0.020383240655064583, 0.0014750537229701877, -0.020263515412807465, 0.016162922605872154, -0.026728684082627296, 0.012855509296059608, 0.010730383917689323, 0.020981866866350174, -0.037234582006931305, -0.008507982827723026, -0.02208932675421238, 0.01932067796587944, -0.026878340169787407, -0.011448736302554607, -0.011620841920375824, 0.006412788759917021, -0.02105669490993023, -0.012137156911194324, -0.022283880040049553, -0.1072140485048294, -0.03639650717377663, -0.017045896500349045, 0.03663595765829086, -0.03307412564754486, 0.024094726890325546, 0.023675687611103058, -0.00827601458877325, 0.0044410619884729385, -0.01860232651233673, -0.038850873708724976, -0.036336641758680344, -0.012024914845824242, 0.031397972255945206, -0.014419421553611755, 0.005264173727482557, 0.0033018006943166256, 0.012241916730999947, -0.019395506009459496, 0.005331519525498152, -0.001732276170514524, -0.019814545288681984, -0.008545396849513054, 0.009218852035701275, -0.03247550129890442, -0.025681087747216225, -0.0009096320136450231, -0.03510945662856102, 0.0013861950719729066, -0.004115558695048094, -0.0271926186978817, 0.017629558220505714, 0.01112697459757328, 0.0009970876853913069, -0.018332943320274353, -0.007011415436863899, 0.02384031005203724, -0.03130817785859108, 0.009795029647648335, 0.020383240655064583, 0.0036179502494633198, 0.03190680593252182, 0.0351693220436573, -0.049087394028902054, 0.03002113103866577, 0.027896005660295486, -0.04112565517425537, 0.00760255940258503, 0.0024637230671942234, 0.01742003858089447, -0.028434770181775093, 0.03045513480901718, -0.027312343940138817, -0.014232350513339043, -0.02223898284137249, 0.005724368151277304, -0.012309262529015541, -0.02898849919438362, 0.016911204904317856, 0.0069590359926223755, 0.006712102331221104, -0.02382534369826317, 0.02339133992791176, 0.010019514709711075, -0.050105057656764984, 0.021445803344249725, -0.002353351330384612, -0.02650419808924198, -0.00011662698670988902, 0.02093696966767311, -0.006379116326570511, 0.014816011302173138, 0.002772390143945813, 0.01513777393847704, -0.06465169042348862, -0.01682141050696373, -0.01944040320813656, 0.007759699132293463, 0.03639650717377663, -0.021415870636701584, -0.0013553283642977476, 0.014606492593884468, 0.01367113832384348, -0.022029463201761246, -0.018467634916305542, 0.0004012669960502535, -0.03340337052941322, -0.028584426268935204, -0.028943601995706558, -0.014299696311354637, 0.004123041871935129, 0.050404369831085205, -0.020847175270318985, -0.02033834345638752, -0.0043101124465465546, 0.012219468131661415, -0.012526264414191246, -0.007378074340522289, 0.018692119047045708, -0.011837843805551529, -0.003849918255582452, 0.0029632023070007563, -0.021445803344249725, -0.03157756105065346, 0.012159605510532856, 0.014007865451276302, -0.018542462959885597, -0.003269998589530587, -0.007931804284453392, 0.009346059523522854, 0.0128854401409626, 0.0012318615335971117, -0.045585427433252335, 0.0126534728333354, 0.021984566003084183, 0.02340630628168583, -0.014194936491549015, 0.023466167971491814, -0.011037180200219154, -0.008507982827723026, 0.014950702898204327, -0.0018435833044350147, -0.026968134567141533, -0.02047303505241871, -0.024034863337874413, 0.0019492782885208726, 0.008403223007917404, 0.015728916972875595, 0.007939287461340427, -0.010296380147337914, 0.008799812756478786, -0.03436117619276047, -0.012249399907886982, -0.04181407764554024, -0.004534597508609295, -0.01352896448224783, -0.003913522232323885, 0.013790863566100597, 0.05968308448791504, 0.018497565761208534, 0.05791713669896126, -0.001365617266856134, -0.00757262809202075, -0.015579260885715485, 0.020697519183158875, 0.040766481310129166, -0.008201186545193195, -0.02927284687757492, -0.020278479903936386, -0.0057355924509465694, -0.06429251283407211, -0.0143445935100317, 0.035648223012685776, -0.015624158084392548, -3.7764930311823264e-05, -0.019964201375842094, -0.01471125241369009, 0.017449969425797462, -0.034750282764434814, 0.03642643615603447, -0.019395506009459496, 0.008695052936673164, -0.018766948953270912, -0.013214685022830963, -0.0003374290536157787, -0.0011214897967875004, -0.023481134325265884, 0.01595340296626091, 0.0016574477776885033, 0.005425054579973221, 0.05543283745646477, 0.020832210779190063, -0.028449736535549164, -0.015848642215132713, -0.004706702660769224, -0.020128823816776276, 0.02150566503405571, -0.036665886640548706, -0.012967751361429691, -0.0065923770889639854, 0.03370268642902374, 0.033104058355093, -0.024663422256708145, -0.012503815814852715, -0.012466401793062687, -0.010835143737494946, 0.02632461115717888, -0.006843051873147488, 0.008044046349823475, 0.034181587398052216, 0.011912671849131584, 0.0047478582710027695, -0.02310699224472046, -0.028270147740840912, -0.0007422036142088473, -0.027716418728232384, 0.004714185371994972, -0.002413213951513171, -0.005758041050285101, -0.037833210080862045, -0.0321761853992939, -0.03882094472646713, 0.006487617269158363, 0.021745115518569946, 0.0026994324289262295, -0.024962734431028366, -0.014905805699527264, -0.014419421553611755, 0.0336727537214756, -0.009390956722199917, 0.029931336641311646, -0.00460568442940712, -0.009061711840331554, 0.02544163540005684, 0.026100125163793564, -0.01286299154162407, 0.0020053996704518795, -0.0033990773372352123, -0.02149070054292679, 0.002476818161085248, 0.0570191964507103, -0.010865075513720512, -0.005533555988222361, 0.00833587720990181, 0.01536974124610424, 0.003670330159366131, -0.008201186545193195, 0.03250543028116226, -0.0038125040009617805, -0.015773814171552658, 0.007576369680464268, -0.011471184901893139, 0.009832444600760937, -0.0039359708316624165, 0.006525031290948391, -0.0003739078820217401, 0.0030062287114560604, -0.016881274059414864, -0.011882741004228592, -0.03831211104989052, -0.012541229836642742, 0.005282880738377571, -0.006128441076725721, 0.007262090686708689, 0.007767181843519211, -0.013828277587890625, 0.0007220935076475143, 0.07452902942895889, -0.02342127077281475, 0.029796645045280457, -0.024498799815773964, -0.021834909915924072, -0.009548095986247063, -0.011239216662943363, -0.017599625512957573, 0.014606492593884468, -0.028614357113838196, -0.014052762649953365, -0.0070899855345487595, 0.01361875794827938, 0.0005111711216159165, 0.025516465306282043, -0.03409179300069809, 0.007086243946105242, 0.012975234538316727, -0.0348101444542408, -0.021041730418801308, 0.040018197149038315, 0.02093696966767311, -0.03002113103866577, -0.11505606025457382, -0.03705499321222305, 0.02795586921274662, -0.01973971724510193, -0.02723751589655876, -0.002300971420481801, 0.043520163744688034, -0.0004064114182256162, 0.014524181373417377, 0.0023290321696549654, 0.012631024233996868, -0.044986799359321594, -0.016507131978869438, -0.006349185016006231, -0.009323611855506897, -0.06830330938100815, 0.007924321107566357, -0.016911204904317856, -0.019066261127591133, -0.048219382762908936, -0.03639650717377663, -0.0295422300696373, -0.0040407306514680386, 0.011590910144150257, -0.05935383960604668, -0.0031334368977695704, 0.011508598923683167, 0.012900406494736671, 0.01622278429567814, -0.014030314050614834, 0.005709402728825808, -0.00629680510610342, 0.04022771492600441, -0.008029080927371979, -0.03657609224319458, 0.013042580336332321, -0.01322965044528246, -0.0005948853213340044, 0.020083926618099213, 0.05498386546969414, 0.04989553987979889, -0.02093696966767311, 0.04109572619199753, -0.02503756247460842, 0.008874641731381416, -0.05309819057583809, 0.027132757008075714, -0.021909737959504128, -0.018901638686656952, 0.0012683403911069036, 0.028584426268935204, -0.011306562460958958, -0.0023047130089253187, -0.014898322522640228, -0.0013132373569533229, -0.016297612339258194, 0.0106780044734478, -0.02515728771686554, -0.0006842116708867252, -0.01870708540081978, -0.03956922888755798, 0.04241270571947098, 0.017360175028443336, -0.006682171020656824, -0.024798111990094185, -0.01988937333226204, 0.0036104675382375717, 0.01420241966843605, -0.019949236884713173, -0.026953168213367462, -0.016192853450775146, 0.0013721646973863244, 0.008747433312237263, 0.022014498710632324, -0.049237050116062164, -0.01520511880517006, 0.031248316168785095, 0.005619608331471682, -0.034929871559143066, 0.02882387675344944, 0.0620775930583477, -0.01595340296626091, 0.03391220420598984, 0.024753214791417122, 0.01025148294866085, 0.029961267486214638, -0.004227801226079464, 0.014950702898204327, 0.0038237283006310463, 0.017060862854123116, 0.035049594938755035, -0.047770414501428604, -0.0023832826409488916, -0.019994132220745087, -0.03118845261633396, -0.03834204375743866, 0.0025778363924473524, -0.0063267364166677, 0.04268208518624306, -0.007449161261320114, 0.016716651618480682, -0.002353351330384612, -0.05761782452464104, 0.007243383675813675, 0.03100886568427086, 0.008088943548500538, -0.001020471565425396, 0.0020596501417458057, 0.0060236817225813866, -0.02942250482738018, 0.00494241202250123, 0.003713356563821435, -0.004650581628084183, 0.01625271514058113, -0.017045896500349045, 0.018811844289302826, 0.034001998603343964, 0.021700218319892883, 0.029512297362089157, 0.02850959822535515, -0.001643417519517243, 0.03349316492676735, 0.01272081770002842, 0.030230650678277016, 6.676091288682073e-05, -0.001178546342998743, -0.035618290305137634, 0.023062095046043396, -0.02532191015779972, -0.009039264172315598, 0.014516698196530342, 0.002658276818692684, 0.0271926186978817, 0.005623349919915199, 0.01485342625528574, 0.03938964009284973, 0.05022478476166725, 0.01960502564907074, -0.034600626677274704, 0.021730151027441025, 0.003726451424881816, 0.028195319697260857, 0.014651389792561531, 0.012690886855125427, 0.007576369680464268, 0.024768181145191193, 0.027462001889944077, -0.019215919077396393, -0.01961999200284481, 0.010483450256288052, 0.020847175270318985, -0.007370591629296541, -0.0020278480369597673, -0.006356667727231979, 0.02167028747498989, 0.030230650678277016, -0.020697519183158875, -0.022583194077014923, -0.004583235830068588, -0.0009030845249071717, 0.01771935075521469, 0.024977700784802437, -0.010842626914381981, -0.02518722042441368, 0.03831211104989052, -0.031966667622327805, -0.014165004715323448, -0.009555579163134098, 0.009495716542005539, -0.009158989414572716, -0.023735549300909042, -0.0368754081428051, -0.00010768265929073095, 0.009952169843018055, 0.03642643615603447, 0.008635190315544605, -0.005683212541043758, 0.026145022362470627, -0.014576560817658901, 0.00864267349243164, 0.02063765749335289, 0.0014675708953291178, -0.02122131735086441, -0.0024637230671942234, 0.05058395862579346, -0.011104525998234749, 8.511723717674613e-05, -0.008904572576284409, -0.031996600329875946, 0.026818478479981422, -0.01566905528306961, 0.020009098574519157, -0.0062855808064341545, 0.06501086056232452, -0.01186029240489006, 0.009473267942667007, -0.0002424905978841707, 0.0336727537214756, -0.0202186182141304, -0.05486414209008217, -0.002471206011250615, 0.03045513480901718, 0.0030623499769717455, -0.0027836142107844353, -0.026309644803404808, 0.034480899572372437, 0.005432537756860256, -0.0074903168715536594, -0.006843051873147488, 0.013379307463765144, 0.007834527641534805, 0.021834909915924072, -0.03906039521098137, 0.003038030583411455, -0.012316744774580002, -0.03888080641627312, -0.004908739123493433, 0.01559422630816698, -0.026085160672664642, -0.023585893213748932, -0.020577793940901756, -0.01885674148797989, 0.03070955164730549, 0.01783907599747181, -0.008530431427061558, -0.007153589278459549, 0.025082459673285484, 0.0043550096452236176, 0.011231734417378902, 0.02430424466729164, -0.02865925431251526, 0.01828804612159729, -0.007363108918070793, 0.011845326982438564, 0.014988116919994354, -0.016716651618480682, -0.013648689724504948, 0.0025871898978948593, 0.01973971724510193, -0.006221976596862078, 0.02749193273484707, 0.031966667622327805, 0.013446653261780739, -0.016312578693032265, 0.018168320879340172, 0.007482834160327911, -0.0013300738064572215, 0.04845883324742317, -0.023047128692269325, 0.004018282052129507, 0.0005527943721972406, 0.03277481347322464, 0.02457362785935402, -0.009428370743989944, 0.01581871137022972, -0.002368316985666752, -0.0008474309579469264, 0.0269082710146904, 0.04184401035308838, 0.02060772478580475, -0.04346030205488205, 0.007161072455346584, 0.0009049552609212697, -0.031248316168785095, -0.006704619619995356, -0.018946535885334015, 0.009757615625858307, 0.009570544585585594, 0.010782764293253422, 0.005387640558183193, -0.010767798870801926, 0.019380539655685425, -0.01455411221832037, 0.0327448807656765, 0.028883740305900574, 0.0020053996704518795, 0.015519398264586926, -0.011852809228003025, 0.03100886568427086, -0.0047927554696798325, -0.019350608810782433, 0.004598201718181372, -0.007434195838868618, 0.0034533280413597822, 0.025531429797410965, -0.021191386505961418, 0.012967751361429691, 0.0003598775656428188, 0.02545660175383091, 0.052619289606809616, 0.017464935779571533, 0.02865925431251526, -0.022493399679660797, -0.004822686780244112, -0.010258966125547886, -0.006405306048691273, -0.0018042983720079064, -0.010408622212707996, 0.0056906952522695065, -0.033732615411281586, 0.010880040936172009, -0.002983780112117529, 0.01667175441980362, -0.023226717486977577, 0.03376254811882973, 0.035947535187006, 0.015773814171552658, -0.0271926186978817, -0.02515728771686554, -0.01680644601583481, -0.000726302620023489, -0.016192853450775146, -0.0011027826694771647, 0.032685019075870514, -0.010056928731501102, -0.00025558556080795825, -0.006539997179061174, -0.00471792696043849, -0.021011797711253166, 0.03732437640428543, 0.006019940134137869, -0.028180353343486786, 0.022628091275691986, 0.03888080641627312, -0.012443953193724155, 0.004852618090808392, 0.03244556859135628, 0.0004087498236913234, 0.012458918616175652, 0.01382079441100359, 0.01918598636984825, 0.002156927017495036, 0.01287795789539814, -0.013828277587890625, -0.046483367681503296, 0.008103909902274609, -0.024049829691648483, -0.007598818279802799, -0.02457362785935402, -0.04010799154639244, 0.026264747604727745, 0.003947195131331682, -0.0028677962254732847, -0.013192236423492432, -0.009585510939359665, 0.026983100920915604, 0.01149363350123167, 0.024349141865968704, 0.02867422066628933, 0.0012982717016711831, 0.07117672264575958, -0.024962734431028366, -0.03876107931137085, 0.01905129663646221, -0.017824111506342888, 0.01376093178987503, -0.003950936254113913, -0.01667175441980362, -0.018692119047045708, 0.02005399577319622, -0.0022654279600828886, 0.02193967066705227, -0.05558249354362488, -0.013012648560106754, 0.03060479275882244, -0.010790246538817883, -0.019066261127591133, 0.04166442155838013, 0.0131697878241539, 0.0028285114094614983, 0.006308029405772686, 0.0066859121434390545, -0.008081461302936077, 0.011306562460958958, 0.0062406836077570915, -0.0016649306053295732, -0.010161688551306725, -0.010296380147337914, 0.018198253586888313, 0.040586892515420914, 0.0017004740657284856, -0.04681261256337166, -0.04334057494997978, 0.0065998598001897335, 0.000840883469209075, -0.008044046349823475, -0.0030773156322538853, 0.041634488850831985, -0.015579260885715485, -0.016791479662060738, -0.019694820046424866, -0.01742003858089447, -0.0032157478854060173, -0.002918305341154337, 0.013865691609680653, 0.03478021174669266, -0.021026764065027237, 0.021685253828763962, 0.01622278429567814, -0.022298846393823624, 0.04525618255138397, 6.0096510424045846e-05, 0.022598158568143845, -0.027611657977104187, 0.002974426606670022, 0.0014600880676880479, 0.0013431687839329243, 0.007752216421067715, 0.03232584521174431, 0.03115852177143097, -0.022643055766820908, 0.02809055894613266, -0.04687247425317764, 0.026219850406050682, 0.020024064928293228, -0.02970685251057148, 0.00017350821872241795, 0.019350608810782433, 0.0023757999297231436, 0.03232584521174431, -0.04375961422920227, 0.004979826044291258, -0.025127356871962547, -0.02750689908862114, 0.0017275993013754487, -0.007954252883791924, -0.002057779347524047, 0.022613124921917915, -0.004268956836313009, 0.03232584521174431, -0.021984566003084183, -0.0060423887334764, 0.008373291231691837, 0.015317361801862717, -0.012204502709209919, 0.001338491914793849, 0.006816862151026726, 0.011658255942165852, -0.0491173230111599, 0.021775048226118088, 0.0011317786993458867, 0.01990433968603611, 0.018407771363854408, 0.009390956722199917, -0.02355596236884594, 0.005533555988222361, 0.00765119818970561, 0.006704619619995356, 0.027162687852978706, 0.010079377330839634, -0.021849876269698143, -0.03202652931213379, -0.016147956252098083, 0.053936269134283066, 0.0035711827222257853, -0.002433791756629944, -0.0436398908495903, 0.012197019532322884, -0.00581790367141366, -0.004470993299037218, 0.008919537998735905, -0.02752186357975006, 0.039269912987947464, 0.0060049742460250854, -0.01483845990151167, 0.015609191730618477, 0.0031914287246763706, 0.04875814914703369, -0.009390956722199917, -0.0007440743502229452, 0.002422567456960678, 0.021999532356858253, 0.0213560089468956, 0.006899172905832529, -0.010303862392902374, 0.02885380946099758, -0.001238409080542624, 0.00023465701087843627, -0.023496098816394806, 0.025995366275310516, 0.030245615169405937, 0.03304419666528702, 0.017674453556537628, -0.0171207245439291, -0.010827661491930485, 0.028015730902552605, 0.036785613745450974, -0.02138593979179859, -0.022463468834757805, 0.007123657967895269, -0.003393465420231223, 0.016731617972254753, -0.005668247118592262, 0.012122191488742828, -0.007149848155677319, -0.029512297362089157, 0.00024506280897185206, -0.019634956493973732, 0.02208932675421238, 0.034929871559143066, 0.01353644672781229, -0.008201186545193195, 0.0012982717016711831, 0.02807559445500374, 0.0078045958653092384, -0.00012463596067391336, -0.016641823574900627, -0.027027996256947517, -0.018108459189534187, 0.008448120206594467, 0.03627678006887436, -0.00720222806558013, -0.0034963542129844427, 0.0048788078129291534, -0.0008385450928471982, -0.014314661733806133, -0.015294913202524185, 0.0009830573108047247, -0.011112009175121784, 0.026683786883950233, -0.01141132228076458, -0.01273578405380249, 0.001049467478878796, 0.0036291745491325855, -0.034750282764434814, -0.020517932251095772, -0.02108662761747837, -0.0033616633154451847, -0.043520163744688034, -0.019290747120976448, -0.0024917838163673878, 0.0033728876151144505, 0.003962160553783178, -0.014456835575401783, -0.008597776293754578, 0.03612712398171425, 0.0485486276447773, 0.019964201375842094, -0.007213452365249395, 0.030919071286916733, 0.004347526468336582, -0.01171811856329441, -0.01353644672781229, -0.016013264656066895, 0.005750557873398066, 0.058186519891023636, 0.012122191488742828, -0.011733083985745907, 0.005324036348611116, 0.015564295463263988, -0.02065262198448181, 0.0009765098802745342, 0.006453944370150566, 0.013304479420185089, -0.01815335638821125, -0.025486532598733902, -0.0020315893925726414, -0.047201719135046005, 0.024798111990094185, 0.005417571868747473, 0.03804272785782814, -0.012009948492050171, 0.023765482008457184, 0.04507659375667572, 0.020158754661679268, -0.00915150623768568, 0.008747433312237263, 0.026279713958501816, -0.03816245496273041, 0.0011542271822690964, -0.006132182665169239, -0.01728534698486328, 0.028135456144809723, 0.021116558462381363, -0.028150422498583794, 0.005896473303437233, 0.019380539655685425, 0.023077061399817467, 0.01294530276209116, 0.018168320879340172, 0.004673029761761427, -0.014015348628163338, -0.010333794169127941, -0.0013525222893804312, 0.00753895565867424, 0.009615441784262657, 0.0030286770779639482, -0.02328657917678356, -0.012219468131661415, 0.009114092215895653, -0.06255649030208588, 0.014651389792561531, -0.034001998603343964, -0.0027574244886636734, -0.030949002131819725, 0.04914725571870804, 0.0017023447435349226, 0.016162922605872154, -0.023930104449391365, 0.015564295463263988, 0.021041730418801308, -0.010880040936172009, -0.022717883810400963, -0.03292446956038475, 0.025800812989473343, -0.02560625784099102, -0.02529197931289673, 0.004070661962032318, -0.018258115276694298, 0.01800369843840599, -0.049087394028902054, -0.018677154555916786, 0.030036097392439842, -0.01192015502601862, -0.014763631857931614, 0.01061814185231924, -0.018617291003465652, -0.026414405554533005, -0.007580111268907785, -0.015489466488361359, -0.009173954837024212, 0.008650156669318676, -0.012780681252479553, -0.024783147498965263, 0.007157330866903067, 0.04669288545846939, 0.051721349358558655, -0.0042951470240950584, 0.002665759762749076, -0.03807266056537628, 0.02372058480978012, 0.004751599859446287, -0.016357475891709328, -0.01025148294866085, 0.007127399556338787, 0.0038686252664774656, -0.0023383856751024723, -0.008163772523403168, 0.001643417519517243, 0.0009119703900068998, -0.05073361471295357, 0.01243647001683712, -0.0015592356212437153, -0.02737220749258995, -0.010954868979752064, 0.020083926618099213, 0.018766948953270912, -0.026998065412044525, -0.03355303034186363, 0.012982717715203762, 0.020532896742224693, -0.013813312165439129, 0.02207436040043831, -0.0003128760145045817, 0.03319385275244713, 0.019111158326268196, 0.002660147612914443, 0.009495716542005539, -0.014845943078398705, 0.006061095744371414, 0.01516022253781557, 0.0024487574119120836, -0.0054287961684167385, 0.036516230553388596, 0.021685253828763962, 0.03223605081439018, -0.01390310563147068, 0.009114092215895653, -0.022448502480983734, -0.015833677724003792, -0.0462738461792469, 0.0006767288432456553, 0.0028303819708526134, 0.024513764306902885, 0.043849408626556396, -0.004998533055186272, -0.02047303505241871, 0.013132373802363873, -0.013237133622169495, -0.03295440226793289, 0.023660721257328987, 0.02167028747498989, 0.018078528344631195, 0.029093259945511818, -0.008582810871303082, 0.009652855806052685, 0.010401139967143536, 0.022927403450012207, 0.010992283001542091, -0.011807912029325962, -0.026145022362470627, 0.009690269827842712, 0.010214068926870823, 0.007931804284453392, -0.0143445935100317, 0.00204842584207654, -0.0061022513546049595, -0.0034795179963111877, -0.012698370032012463, -0.002340256469324231, 0.015167704783380032, 0.029212985187768936, -0.010064411908388138, 0.00446351058781147, 0.005982526112347841, 0.0014984376030042768, -0.009967135265469551, -0.02193967066705227, -0.02707289345562458, -0.017734317108988762, -0.023211751133203506, -0.03118845261633396, 0.008507982827723026, 0.0174050722271204, -0.019230883568525314, 0.009480751119554043, 0.0038237283006310463, -0.029602091759443283, 0.011022214777767658, -0.020787313580513, -0.0005532620707526803, 0.028030697256326675, 0.046483367681503296, -0.01563912257552147, -0.00669339532032609, -0.0016256456729024649, -0.01325209904462099, -0.026983100920915604, 0.040018197149038315, -0.007557662669569254, 0.013035097159445286, -0.00018765544518828392, -0.01279564667493105, -0.014666355215013027, 0.024498799815773964, 0.01469628605991602, -0.013633724302053452, 0.042352840304374695, -0.026743648573756218]",Token-level Direct Preference Optimization.pdf
" sentiment
of the response is negative, we set r(x,y)to
1−p(NEG| ·), and if the sentiment is positive
r(x,y) = 1 + p(POS| ·), where pis given by the
classifier. For notational ease, we show r(x,y)
withr(y).
Bootstraping the Preference Data. DPO, as
opposed to RLHF, only works on top of preference
data. Therefore, in tasks that a ground-truth reward
model is given, the preference data needs to be
bootstraped. We follow Rafailov et al. (2023)
to bootstrap the preference dataset ( DHF) from
point-wise rewards. Given the reward function,
which in this experiment is given by the sentiment
classifier, and a dataset of prompts that are prefixes
of movie reviews, we proceed as follows. First,
3Specifically, we use https://huggingface.co/
lvwerra/distilbert-imdb .
10 20 300.0450.050.0550.060.0650.070.075DPO ODPO
SFT T oxicity(a)|D HF|= 8000 ,100% of the points
on the Pareto front belong to ODPO.
0 20 400.040.0450.050.0550.060.0650.07DPO ODPO
SFT T oxicity(b)|D HF|= 9000 ,100% of the points
on the Pareto front belong to ODPO.
5 10 150.020.040.060.08DPO ODPO
SFT T oxicity(c)|D HF|= 10000 ,57% of the points
on the Pareto front belong to ODPO.
Figure 3: Steering generations away from toxic content. We highlight points on the Pareto front with a black border.
We observe that, especially when the size of the dataset is small, ODPO manages to reduce the toxicity better than
DPO while not diverging too far from the SFT model.
for each prompt x∈ D,Mresponses are sampled
from the language model πSFT(· |x)4to form a
multiset Yx={yi}M
m=1,5where ymis the mth
response generated for prompt x. Next, for each
i̸=j∈ {1, . . . , M }a tuple (x,yw,yl)is added
toDHFifr(yi)̸=r(yj), where
(yw,yl) =(
(yi,yj)ifr(yi)> r(yj)
(yj,yi)ifr(yi)< r(yj).(17)
While DPO only uses the order of responses’
rewards, with ODPO we further use the reward
model to determine the offset between the two
responses and set ∆r= log 
r(yw)−r(yl)
.
Following Eq. (15), this is equivalent to choosing
f(·)as the logfunction and setting α= 1.
We vary the KL regularization term βin
{0.1,0.2, . . . , 1}∪{1,2,3,4,5}6and sample from
the fine-tuned language model πθtwo times with
two different random seeds. This gives us 28differ-
ent samples for each method. We use these samples
to approximate the average probability of the gen-
erations having positive sentiment as well as the
KL divergence between the fine-tuned model πθ
and the initial model πSFT. Ideally, we want not to
diverge too much from the SFT policy, while gen-
erating movie reviews with a positive sentiment.
To capture the tradeoff between the KL diver-
gence and achieved reward, we evaluate the two
4One can also compare the responses generated by the
model with human written responses (Stiennon et al., 2020).
5In this experiment, we generate two responses per prompt.
6Within the range of 0 to 1, increased resolution is neces-
sary due to considerable variance in results. However, within
the range of 1 to 5, the points are closely clustered, therefore,
we increase the step size when covering this range.methods based on the Pareto frontier of achieved re-
ward and KL divergence. Concretely, we report the
percentage of points on the Pareto set that belong
to each method. We compare the performance of
ODPO and DPO in 3different settings by varying
the number of data points in the preference dataset,
i.e.,|DHF|. As depicted in Fig. ","[-0.00014009491133037955, 0.00881333090364933, 0.014113548211753368, 0.011616183444857597, 0.04560936614871025, 0.013571307063102722, -0.006556537467986345, 0.054224129766225815, 0.00422337232157588, 0.014457222074270248, 0.03180130571126938, -0.03513112664222717, -0.035528261214494705, -0.02424047701060772, 0.01810016669332981, -0.015358411706984043, 0.06959018111228943, -0.03540606424212456, -0.0113717932254076, 0.028517309576272964, -0.02786051109433174, -0.006415249314159155, 6.83171529090032e-05, 0.0017269621603190899, 0.003425284754484892, 0.002063953783363104, 0.011211412027478218, 0.023140721023082733, 0.022163158282637596, -0.03189295157790184, 0.014419035986065865, -0.036902956664562225, -0.023843342438340187, -0.036597467958927155, 0.022163158282637596, 0.0149841895326972, -0.0006095441640354693, 0.04933632165193558, -4.850816185353324e-05, -0.011509262956678867, -0.0276008453220129, -0.061830781400203705, -0.039866190403699875, -0.01246391236782074, -0.02162855491042137, 0.012945055961608887, 0.035528261214494705, -0.040813203901052475, 0.044937293976545334, 0.016756020486354828, -0.07838823646306992, 0.0514136403799057, -0.012257708236575127, -0.003925521392375231, 0.035100579261779785, -0.004150819033384323, -0.004624325316399336, 0.01753501407802105, 0.049580711871385574, -0.03580319881439209, 0.021720200777053833, -0.04062991216778755, 0.028165999799966812, 0.0009785164147615433, -0.004299744497984648, 0.00797323789447546, -0.10441581904888153, 0.0017336447490379214, 0.02092593163251877, 0.034917283803224564, 0.049702905118465424, 0.01710733212530613, 0.044295769184827805, -0.02862423099577427, 0.004441032651811838, -0.00921810232102871, 0.05300217866897583, 0.03503948077559471, 0.00704913679510355, -0.02210206165909767, 0.00969160906970501, 0.03485618904232979, -0.013403288088738918, -0.0023980813566595316, -0.015977025032043457, -0.0542546771466732, -0.011035756208002567, -0.02196459099650383, -0.061403099447488785, -0.00810307078063488, -0.024209927767515182, 0.003432922065258026, -0.029937829822301865, 0.0010911651188507676, 0.020910657942295074, -0.043654244393110275, 0.004708334803581238, -0.003623852040618658, -0.005594249814748764, 0.00314843631349504, -0.01018802635371685, -0.01515220757573843, -0.023919714614748955, 0.010134566575288773, 0.014968914911150932, 0.035222772508859634, -0.0017632389208301902, 0.045242782682180405, 0.004555590450763702, 0.010600435547530651, -0.03112923353910446, -0.0025794648099690676, -0.05504894629120827, 0.041454728692770004, -0.0034634708426892757, -0.046281442046165466, -0.07166749984025955, 0.01240281481295824, -0.010883011855185032, 0.000772789295297116, -0.05043607950210571, -0.014953640289604664, -0.0019131189910694957, 0.007209517993032932, -0.005197115708142519, -0.013090163469314575, 0.002254883758723736, -0.07716628164052963, 0.002512639155611396, -0.030716823413968086, -0.007770852651447058, 0.005991384387016296, 0.005670621991157532, -0.04435686767101288, -0.048083819448947906, 0.04594540223479271, -0.005017641466110945, 0.03259557485580444, -0.012883958406746387, -0.01422810647636652, -0.03082374483346939, -0.04838930815458298, -0.0369640551507473, 0.007835769094526768, -0.042829424142837524, -0.05679022893309593, -0.021781299263238907, -0.003837693715468049, -0.04594540223479271, 0.06366371363401413, 0.0008596624829806387, -0.000573267403524369, -0.03418411314487457, 0.03253447636961937, -0.00029236162663437426, -0.03013639710843563, 0.012601382099092007, 0.00966869667172432, -0.007182788103818893, -0.013441474176943302, -0.02798270620405674, 0.017657209187746048, -0.013624767772853374, -0.04732010141015053, 0.021857669577002525, 0.02665383368730545, -0.010684444569051266, -0.012005680240690708, -0.07679969817399979, -0.029464323073625565, -0.011440527625381947, 0.0018949805526062846, -0.04337930306792259, -0.047136805951595306, -0.01108921691775322, -0.005227664485573769, -0.02210206165909767, -0.005869189277291298, 0.0048381672240793705, -0.004910720512270927, -0.006052481941878796, 0.02213260903954506, -0.01287632156163454, 0.007205699570477009, 0.007980875670909882, -0.005407138727605343, -0.00838564708828926, 0.007904503494501114, 0.015915928408503532, 0.035955943167209625, 0.04961125925183296, 0.01883333921432495, 0.06910140067338943, -0.009149366989731789, -0.020788462832570076, -0.057370658963918686, 0.06879591196775436, 0.04780888184905052, -0.050619371235370636, 0.02033022977411747, 0.01027203630656004, 0.05208571255207062, 0.0038835168816149235, -0.09085214883089066, -0.03274831920862198, 0.008026698604226112, -0.02364477515220642, -0.03216789290308952, -0.01474743615835905, 0.0020945025607943535, 0.02217843383550644, 0.021261969581246376, 0.06708517670631409, 0.017504464834928513, -0.01926102116703987, 0.013296367600560188, -0.052116263657808304, 0.04903083294630051, 0.02566099725663662, 0.04802272096276283, 0.0017918783705681562, 0.03409246727824211, 0.04896973446011543, -0.017229527235031128, -0.025202764198184013, 0.011150314472615719, 0.044937293976545334, -0.031236153095960617, -0.007373718079179525, -0.04826711118221283, 0.04997784644365311, 0.019490137696266174, -0.004876353312283754, -0.005055827554315329, 0.010218575596809387, -0.03262612596154213, -0.0007126463460735977, -0.0386136919260025, -0.0007622881676070392, -0.044937293976545334, 0.014800895936787128, 0.032565027475357056, 0.03213734179735184, -0.01942904107272625, 0.018191814422607422, 0.025767916813492775, -0.007159876171499491, -0.011593271978199482, -0.03180130571126938, -0.021292516961693764, 0.002428630134090781, -0.020223310217261314, -0.024912551045417786, -0.058134377002716064, -0.05446851998567581, -0.027066241949796677, -0.010310221463441849, -0.008064884692430496, -0.010027645155787468, 0.01947486400604248, -0.03335929661989212, 0.01100520696491003, 0.00850784219801426, 0.006743649020791054, -0.0035035661421716213, 0.006785653531551361, -0.02385861799120903, -0.015472969971597195, -0.03705570101737976, -0.0009221920627169311, 0.0016878214664757252, 4.5554712414741516e-05, 0.013288730755448341, 0.04707571119070053, -0.03177075833082199, -0.0291435606777668, 0.04160747304558754, 0.04634253680706024, -0.04276832938194275, -0.027325905859470367, 0.007392811123281717, -0.004754157736897469, 0.05636254698038101, -0.026577461510896683, 0.023751696571707726, 0.004005711991339922, -0.0033851894550025463, 0.006869662553071976, 0.01658800058066845, 0.003933158703148365, -0.014655789360404015, -0.042707230895757675, 0.017825227230787277, -0.06427468359470367, 0.014350301586091518, -0.000832454941701144, 0.007828131318092346, -0.04838930815458298, 0.0009575141011737287, 0.01351784635335207, 0.05850096419453621, 0.0039293402805924416, 0.0047732507809996605, 0.0043455674313008785, 0.03513112664222717, -0.026546912267804146, 0.02682185173034668, 0.007125508971512318, -0.012082052417099476, -0.024301575496792793, -0.014663427136838436, -0.0052543943747878075, -0.0024725438561290503, 0.058348219841718674, -0.02677602879703045, 0.02402663603425026, 0.07062883675098419, -0.0016419983003288507, -0.025080569088459015, -0.04939742013812065, -0.058775901794433594, -0.053918641060590744, -0.0021002304274588823, -0.009134093299508095, 0.01018802635371685, -0.037116799503564835, -0.013823334127664566, -0.014197557233273983, -0.007358443457633257, -0.024683434516191483, -0.024790355935692787, -0.01240281481295824, 0.006182314362376928, 0.03170965984463692, 0.002020039828494191, -0.014197557233273983, -0.014021901413798332, 0.02201041392982006, 0.032901063561439514, 0.030411336570978165, -0.07716628164052963, -0.01253264769911766, -0.009897813200950623, -0.020253857597708702, -0.003767049638554454, -0.019016630947589874, -0.009714520536363125, 0.04826711118221283, 0.03259557485580444, 0.03439795598387718, -0.028349291533231735, -0.011623820289969444, 0.019276296719908714, 0.03283996507525444, 0.020192760974168777, -0.0009102589683607221, -0.008714047260582447, -0.011119765229523182, -0.03229008615016937, -0.020146938040852547, -0.02042187750339508, -0.014220468699932098, 0.006487802602350712, 0.02071209065616131, 0.03788051754236221, 0.012624293565750122, -0.016053397208452225, -0.04695351421833038, 0.03112923353910446, -0.027050968259572983, -0.026684381067752838, 0.017351722344756126, -0.027524473145604134, 0.02518749050796032, -0.06745176017284393, 0.02708151564002037, 0.02033022977411747, 0.014770347625017166, -0.0024839998222887516, 0.022972701117396355, 0.01603812351822853, 0.014357938431203365, -0.05810382962226868, -0.013311642222106457, -0.01525912806391716, 0.023018525913357735, 0.015534067526459694, -0.011150314472615719, -0.050619371235370636, -0.004166093189269304, -0.0031694385688751936, -0.014113548211753368, -0.01341092586517334, 0.020574619993567467, -0.03534496948122978, -0.010172752663493156, -0.03360368683934212, 0.07948799431324005, 0.05987565964460373, 0.05504894629120827, -0.041974060237407684, 0.0013183718547224998, -0.06131145358085632, 0.01930684596300125, -0.03503948077559471, 0.0012324533890932798, 0.003037696937099099, 0.01433502696454525, 0.03047243319451809, 0.03959125280380249, 0.04182131588459015, -0.04224899783730507, 0.02634834498167038, -0.032901063561439514, 0.0042386469431221485, -0.01883333921432495, 0.021353615447878838, 0.005655347835272551, 0.023064348846673965, 0.0604255385696888, -0.017825227230787277, -0.03607814013957977, -0.025935936719179153, -0.0219187680631876, -0.0158701054751873, 0.03366478532552719, 0.0008906886214390397, 0.004189005121588707, 0.04252393916249275, -0.03983564302325249, -0.029601791873574257, 0.05565992370247841, 0.0454871729016304, -0.010997570119798183, -0.04585375636816025, -0.007759396452456713, 0.01655745320022106, -0.035008929669857025, 0.015052923932671547, -0.031526368111371994, 0.025263862684369087, -0.014831445179879665, 0.006823839619755745, -0.011784201487898827, -0.032565027475357056, -0.014755073003470898, 0.026027582585811615, 0.012051504105329514, 0.012318805791437626, -0.014594691805541515, -0.037238992750644684, 0.03830820322036743, 0.03433685749769211, -0.008584214374423027, -0.014495408162474632, -0.05312437191605568, 0.047778330743312836, 0.015809006989002228, 0.034459054470062256, 0.017290623858571053, 0.02836456522345543, 0.014304478652775288, -0.02042187750339508, 0.0023885348346084356, -0.0036792217288166285, 0.006193770561367273, -0.02312544547021389, -0.01655745320022106, -0.02518749050796032, 0.01164673175662756, -0.025691546499729156, -0.06934578716754913, 0.006419067736715078, -0.028043802827596664, -0.028211822733283043, -0.023110171779990196, 0.04411247372627258, -0.004418121185153723, 0.03167911246418953, 0.029586518183350563, 0.03381752967834473, -0.020192760974168777, -0.020834285765886307, 0.004387572407722473, 0.031954050064086914, 0.0717896968126297, 0.0634804219007492, -0.003030059626325965, -0.04948906600475311, -0.005853915121406317, 0.014533594250679016, -0.03580319881439209, 0.04496784135699272, -0.019749803468585014, -0.018039070069789886, -0.02256029285490513, 0.017260074615478516, 0.012662479653954506, -0.009584687650203705, -0.03400082141160965, 0.05257449299097061, -0.0025699182879179716, -0.009042446501553059, 0.030411336570978165, 0.023064348846673965, 0.002020039828494191, 0.04331820830702782, -0.03103758580982685, -0.025691546499729156, 0.013624767772853374, -0.013197083957493305, 0.014357938431203365, -0.016526903957128525, 0.013914980925619602, -0.006399974692612886, 0.028395114466547966, -0.03781942278146744, -0.031175056472420692, -0.03167911246418953, 0.034153565764427185, -0.009752706624567509, -0.006594723556190729, -0.027325905859470367, -0.001212405739352107, -0.01031785923987627, -0.020513523370027542, -0.01399135310202837, -0.12573888897895813, -0.04276832938194275, -0.024515416473150253, 0.028731152415275574, -0.009248650632798672, 0.016740744933485985, 0.039743997156620026, -0.009225739166140556, -0.004589958116412163, 8.669417002238333e-05, -0.026455266401171684, -0.02618032693862915, -0.011982768774032593, 0.03455070033669472, 0.0026940228417515755, 0.00024092983221635222, 0.008927888236939907, 0.007331713568419218, -0.010875375010073185, 0.027188437059521675, 0.0006782789714634418, -0.023308739066123962, -0.011081579141318798, 0.005002366844564676, -0.03650582209229469, -0.046098146587610245, -0.009615236893296242, -0.032870516180992126, 0.028425663709640503, -0.016908764839172363, -0.031526368111371994, 0.020009467378258705, -0.0035933032631874084, -0.0016410436946898699, 0.004368479363620281, 0.010783728212118149, 0.03537551686167717, -0.01646580547094345, 0.014716886915266514, 0.02905191481113434, 0.013685865327715874, -0.0017059599049389362, 0.062014076858758926, -0.04790052771568298, 0.010386593639850616, 0.02677602879703045, -0.06167803704738617, 0.009286836721003056, -0.0016973679885268211, 0.020819010213017464, -0.028486762195825577, 0.02630252204835415, -0.035314418375492096, -0.0025737369433045387, -0.019154101610183716, 0.001921710791066289, -0.018894435837864876, -0.016969861462712288, 0.03108341060578823, 0.006747467443346977, 0.019062453880906105, -0.026363618671894073, 0.006968946196138859, 0.022239530459046364, -0.029846183955669403, 0.019703980535268784, 0.009279199875891209, -0.008950799703598022, 0.015121659263968468, 0.030808471143245697, -0.021429987624287605, 0.014472496695816517, -0.0108982864767313, 0.020177485421299934, -0.04909193143248558, -0.007828131318092346, -0.04866424575448036, -0.015526430681347847, 0.036811310797929764, -0.010501151904463768, 0.0005584703758358955, 0.01055461261421442, 0.019077729433774948, -0.013762236572802067, -0.03164856135845184, 0.0032324455678462982, -0.027417553588747978, -0.04237119480967522, -0.038369301706552505, 0.004215735010802746, 0.015541705302894115, 0.05223845690488815, -0.01654217764735222, -0.03280941769480705, -0.011791839264333248, -0.0032133525237441063, 0.008859153836965561, 0.007247704081237316, -0.0031828037463128567, 0.0017603749874979258, -0.014884905889630318, 0.0016162227839231491, -0.018634771928191185, -0.035436615347862244, -0.00014522616402246058, -0.005704989656805992, -0.014342664740979671, -0.005578975658863783, 0.03433685749769211, 0.01637415960431099, 0.010844825766980648, -0.0069613088853657246, -0.04695351421833038, 0.005930286832153797, 0.03305380791425705, 0.02492782473564148, -0.03797216713428497, 0.023155994713306427, -0.00538422679528594, 0.0034844730980694294, 0.0025756461545825005, 0.009179916232824326, -0.031052861362695694, -0.01637415960431099, -0.016985135152935982, -0.017779404297471046, 0.006965127773582935, 0.020177485421299934, 0.03155691549181938, -0.01386152021586895, 0.009951273910701275, -0.04023277759552002, -0.0071636950597167015, -0.03568100556731224, -0.00538422679528594, -0.01701568439602852, -0.011173225939273834, 0.0203760527074337, 0.05144418776035309, 0.015809006989002228, 0.0611281618475914, 0.017611386254429817, 0.001749873743392527, 0.00019200402311980724, 0.035742104053497314, 0.03693350777029991, 0.005536971148103476, -0.021811846643686295, 0.011791839264333248, 0.0056858966127038, -0.04285997524857521, -0.014785622246563435, 0.02416410483419895, -0.010684444569051266, -0.00997418537735939, -0.029418500140309334, -0.014060087502002716, 0.01486963126808405, -0.03283996507525444, 0.04020222648978233, -0.012731214985251427, -0.004456306807696819, 0.0013250544434413314, -0.026103954762220383, -0.004185186233371496, -0.003146527102217078, -0.021720200777053833, 0.01018802635371685, 0.005640073213726282, -0.00759901525452733, 0.05049717426300049, 0.010799002833664417, -0.0386136919260025, -0.012104963883757591, 0.0027894878294318914, -0.00401716772466898, 0.01680184341967106, -0.01525912806391716, -0.02042187750339508, -0.03120560571551323, 0.04964181035757065, 0.035100579261779785, -0.031175056472420692, -0.012387541122734547, -0.018298733979463577, -0.025630448013544083, 0.048939187079668045, 0.0023999905679374933, 0.01085246354341507, 0.02347675710916519, 0.010867737233638763, 0.006113579962402582, -0.025508252903819084, -0.01921519823372364, -0.013151261024177074, -0.03323709964752197, 0.015060560777783394, -0.008225265890359879, 0.011807112954556942, -0.023110171779990196, -0.022987976670265198, -0.019352668896317482, 0.012471550144255161, 0.008469656109809875, 0.018252911046147346, -0.019673431292176247, -0.019490137696266174, -0.04337930306792259, 0.013502571731805801, -0.006976583506911993, 0.0447845496237278, 0.00241717416793108, 0.0026863855309784412, 0.03537551686167717, 0.004704515915364027, 0.007304983213543892, -2.641696119098924e-05, -0.00816416833549738, -0.027356455102562904, -0.0014004717813804746, 0.05324656888842583, -0.006117398384958506, 0.018772240728139877, -0.0073011647909879684, 0.016343610361218452, -0.0005684942007064819, 0.007201881147921085, 0.024866728112101555, -0.00827108882367611, -0.017046233639121056, 0.006800927687436342, 0.003049152670428157, 0.0031694385688751936, 0.01680184341967106, 0.016969861462712288, -0.004738883581012487, -0.00620140740647912, -0.00211168616078794, -0.00990545004606247, -0.034489601850509644, -0.014800895936787128, 0.0017861505039036274, -0.008698772639036179, 0.002806671429425478, -0.00791214033961296, -0.004658692982047796, 0.005235301796346903, 0.09072995185852051, -0.024637611582875252, 0.016603276133537292, -0.01857367344200611, -0.006407612003386021, 0.00043699113302864134, -0.022621391341090202, -0.022682487964630127, 0.009821441024541855, -0.013777511194348335, -0.011173225939273834, -0.0017451004823669791, 0.009920724667608738, -0.0037403192836791277, 0.03219844028353691, -0.026852400973439217, -0.0008964165463112295, 0.017916874960064888, -0.023446207866072655, -0.01037895679473877, 0.019444314762949944, 0.01625196449458599, -0.039530154317617416, -0.1286715716123581, -0.04258503392338753, 0.03940796107053757, -0.015587528236210346, -0.025508252903819084, 0.0037632309831678867, 0.03143472224473953, -0.0010424780193716288, -0.011203774251043797, -0.004376116208732128, 0.026149777695536613, -0.03519222512841225, -0.011631458066403866, -0.013151261024177074, -0.018451478332281113, -0.035314418375492096, -0.003133161924779415, -0.005960835609585047, -0.010157478041946888, -0.03461179509758949, -0.06155584380030632, -0.012967968359589577, -0.0038396029267460108, 0.010333133861422539, -0.04997784644365311, 0.014144097454845905, -0.0005527424509637058, -0.0051474738866090775, 0.001497846096754074, -0.005777542944997549, 0.0003890199586749077, -0.010294947773218155, 0.017733581364154816, -0.015014737844467163, -0.05361315235495567, -0.01205914095044136, -0.02381279319524765, -0.006915485952049494, 0.006289235316216946, 0.03916356712579727, 0.04337930306792259, -0.014044813811779022, 0.02454596571624279, -0.02888389490544796, 0.020605169236660004, -0.06555774062871933, 0.016435258090496063, -0.014411399140954018, 0.004379935096949339, 0.01663382537662983, 0.01952068693935871, -0.00950067862868309, -0.0012868684716522694, -0.024820905178785324, -0.0018100166926160455, 0.0027856691740453243, -0.004280651453882456, -0.0021479628048837185, -0.009072995744645596, -0.020620442926883698, -0.028089627623558044, 0.034581247717142105, 0.019719254225492477, 0.0015532157849520445, -0.03400082141160965, -0.007064411416649818, -0.029281029477715492, 0.0017823318485170603, -0.01805434376001358, -0.027539748698472977, -0.002344620879739523, 0.008515479974448681, 0.013250544667243958, 0.009790891781449318, -0.026195600628852844, -0.016954587772488594, 0.041760217398405075, -0.0075073689222335815, -0.04062991216778755, 0.029387950897216797, 0.04826711118221283, -0.025905387476086617, 0.04802272096276283, 0.032259538769721985, 0.011043393053114414, 0.034795090556144714, 0.001046296558342874, 0.004181367810815573, -0.016389435157179832, 0.017596112564206123, 0.012219522148370743, -0.02947959676384926, -0.013242906890809536, -0.013265819288790226, -0.03030441515147686, -0.03177075833082199, -0.005239120218902826, 0.021200871095061302, 0.043470948934555054, -0.008187079802155495, 0.013769874349236488, 0.010462965816259384, -0.033939722925424576, 0.013571307063102722, 0.019780350849032402, 0.02123142033815384, -0.009363208897411823, 0.004708334803581238, 0.014205195009708405, -0.00187302369158715, -0.017611386254429817, -0.007259159814566374, -0.007851042784750462, 0.022667214274406433, -0.012043866328895092, 0.03366478532552719, 0.04084375500679016, 0.015366049483418465, 0.019703980535268784, 0.014892542734742165, 0.0015446239849552512, 0.036383628845214844, -0.0015961751341819763, 0.03610868752002716, 0.0005799499922432005, 0.005788998678326607, -0.03687240928411484, 0.006128854118287563, -0.027432827278971672, -0.0033088175114244223, 0.0064992583356797695, 0.0021899675484746695, 0.019719254225492477, 0.007159876171499491, 0.024087732657790184, 0.03338984400033951, 0.06366371363401413, 0.017183702439069748, -0.0312667042016983, 0.018879162147641182, 0.016756020486354828, 0.03757503256201744, 0.042065706104040146, 0.019566509872674942, 0.007060592528432608, 0.017596112564206123, 0.040477167814970016, -0.02660800889134407, -0.013724051415920258, 0.02092593163251877, -0.009638148359954357, -0.016969861462712288, 0.0031369805801659822, 0.00446012569591403, 0.030594628304243088, 0.03013639710843563, 0.0028983179945498705, -0.025859564542770386, 0.011348881758749485, -0.02139943838119507, 0.0006190906278789043, 0.024469593539834023, -0.0026902041863650084, -0.040507715195417404, 0.045670464634895325, -0.018772240728139877, -0.008607125841081142, -0.012410452589392662, 0.01985672302544117, -0.0018606132362037897, -0.011333607137203217, -0.05291053280234337, 9.08707661437802e-05, -0.013464386574923992, 0.03607814013957977, 0.022636665031313896, -0.008332186378538609, 0.043990280479192734, -0.004960362333804369, 0.021460536867380142, -0.00010966543777612969, 0.011051030829548836, -0.003058699192479253, -0.0024572694674134254, 0.05034443363547325, -0.01248682476580143, 0.021521633490920067, 0.012204247526824474, -0.026424717158079147, 0.013540757820010185, 0.00015536931459791958, 0.022193707525730133, -0.011753653176128864, 0.047564491629600525, 0.008003787137567997, -0.002657746197655797, 0.009767980314791203, 0.03519222512841225, 0.004418121185153723, -0.03809436038136482, -0.012311168946325779, 0.028990816324949265, 0.017596112564206123, -0.005876826588064432, -0.025111118331551552, 0.023201817646622658, 0.006694007199257612, -0.0008176578558050096, 0.006923123262822628, 0.04014113172888756, -0.023828068748116493, 0.03403136879205704, -0.036475274711847305, 0.010814277455210686, 0.0019083457300439477, -0.03730009123682976, -0.020880108699202538, 0.02139943838119507, -0.009164641611278057, -0.025370782241225243, -0.01341092586517334, -0.035833749920129776, 0.02295742742717266, 0.01603812351822853, -0.015373686328530312, -0.02260611578822136, 0.04237119480967522, 0.006804746575653553, 0.01106630451977253, 0.015129296109080315, -0.026241423562169075, 0.019413765519857407, -0.01317417249083519, 0.00609448691830039, -0.00571644539013505, -0.02210206165909767, -0.026684381067752838, 0.013250544667243958, 0.024103008210659027, -0.013815697282552719, 0.029754536226391792, 0.003551298752427101, -0.024958373978734016, -0.0029804178047925234, -0.00024057184054981917, -0.000273507263045758, 0.015503519214689732, 0.026638558134436607, -0.03442850336432457, -0.006590904667973518, -0.008500205352902412, 0.028227096423506737, 0.012547922320663929, 0.005785180255770683, 0.010577524080872536, -0.009554139338433743, -0.004826711490750313, 0.020987030118703842, 0.03558935970067978, 0.022835232317447662, -0.04273777827620506, 0.004872534424066544, 0.0034940196201205254, -0.030976489186286926, -0.003390917321667075, -0.02738700434565544, 0.01248682476580143, 0.010172752663493156, 0.01212023850530386, 0.005433868616819382, -0.01590065285563469, 0.018894435837864876, -0.020391328260302544, 0.06210572272539139, 0.015159844420850277, 0.01767248474061489, 0.016969861462712288, -0.00507110171020031, 0.027906334027647972, -0.018924985080957413, -0.00010250556078972295, -0.016572726890444756, -0.014587054960429668, -0.01973452791571617, 0.011264871805906296, -0.02201041392982006, 0.0049450877122581005, -0.0019369851797819138, 0.0033088175114244223, 0.0533076673746109, 0.024897277355194092, 0.016817117109894753, -0.013494934886693954, -0.004624325316399336, -0.011738378554582596, -0.01444194745272398, -0.010325496084988117, 0.012922144494950771, 0.017504464834928513, -0.026333071291446686, 0.012097327038645744, 0.01428920403122902, 0.029296305030584335, -0.01753501407802105, 0.028608957305550575, 0.018558399751782417, 0.0006906894268468022, -0.021857669577002525, -0.021811846643686295, -0.022942153736948967, -0.01270066574215889, -0.025202764198184013, -0.0010720721911638975, 0.02329346351325512, -0.007950326427817345, -0.0002789965074043721, 0.006197588983923197, -0.01496127713471651, -0.022850506007671356, 0.01947486400604248, -0.005930286832153797, -0.015266765840351582, 0.024133555591106415, 0.04823656380176544, -0.01968870498239994, -0.01684766635298729, 0.02720371074974537, 0.014991826377809048, -0.008782781660556793, 0.018756967037916183, 0.003623852040618658, 0.019749803468585014, 0.009890175424516201, -0.025202764198184013, -0.04487619549036026, -0.0003976117877755314, -0.05202461779117584, -0.007392811123281717, -0.006167040206491947, -0.027784138917922974, 0.03158746659755707, 0.011738378554582596, -0.010623347014188766, -0.026638558134436607, -0.022896330803632736, 0.0029174110386520624, 0.013548395596444607, 0.014900179579854012, 0.007243885658681393, -0.009080632589757442, 0.07551664859056473, -0.03809436038136482, -0.046281442046165466, 0.01534313801676035, -0.028303468599915504, -0.0022186071146279573, -0.0053193108178675175, -0.00990545004606247, -0.020223310217261314, 0.030166946351528168, -0.00932502280920744, 0.02373642288148403, -0.021674377843737602, -0.00402098661288619, 0.023629501461982727, -0.0019150282023474574, -0.009989459067583084, 0.027325905859470367, 0.01784050278365612, -0.0028601319063454866, 0.011318332515656948, 0.01528204046189785, 0.0025050020776689053, 0.006709281355142593, 0.017000410705804825, 0.002212879015132785, -0.016526903957128525, -0.00489926477894187, 0.021567456424236298, 0.042065706104040146, 0.0032018967904150486, -0.042096253484487534, -0.03736118972301483, -0.008225265890359879, -0.016099220141768456, -0.01796269789338112, -0.007621927186846733, 0.04084375500679016, -0.018084893003106117, -0.024423770606517792, -0.012341717258095741, -0.017229527235031128, 0.0010587070137262344, -0.003723135683685541, 0.010646258480846882, 0.03907192125916481, -0.008553666062653065, 0.021674377843737602, 0.009416669607162476, 0.004169912077486515, 0.026501089334487915, 0.0015780366957187653, 0.018191814422607422, -0.014877268113195896, -0.006594723556190729, -0.022239530459046364, -0.012746489606797695, 0.012647205963730812, 0.03013639710843563, 0.018863888457417488, -0.03216789290308952, 0.016603276133537292, -0.03047243319451809, 0.01796269789338112, 0.02905191481113434, -0.0407521054148674, 0.014357938431203365, 0.01474743615835905, -0.010157478041946888, 0.035833749920129776, -0.04637308791279793, -0.005521696526557207, -0.01119613740593195, -0.027050968259572983, 0.0020811373833566904, -0.0046472372487187386, -0.003272540867328644, 0.02381279319524765, 0.009622873738408089, -0.005758449900895357, 0.006304509937763214, -0.006487802602350712, -0.005258213263005018, 0.009279199875891209, -0.024148831143975258, -0.02094120718538761, 0.0026081043761223555, -0.005678259301930666, -0.03968289867043495, 0.02983090840280056, -0.0025412787217646837, 0.029372677206993103, 0.02278940938413143, -0.007534099277108908, -0.03186240419745445, -0.0044104838743805885, 0.007156057748943567, 0.02033022977411747, 0.030839018523693085, 0.009554139338433743, -0.024469593539834023, -0.004567046649754047, -0.003016694448888302, 0.02767721749842167, 0.0012343627167865634, -0.01240281481295824, -0.04707571119070053, -0.00793505273759365, 0.0027073880191892385, -0.0060906680300831795, 0.01900135725736618, -0.02523331344127655, 0.03540606424212456, 0.01632833667099476, -0.013777511194348335, 0.01767248474061489, -0.0003675403131637722, 0.038063813000917435, 0.00762956403195858, 0.00402098661288619, -0.009072995744645596, 0.01201331801712513, 0.005743175279349089, 0.00571644539013505, -0.004433395341038704, 0.03155691549181938, -0.009775618091225624, -0.01216606143862009, -0.0319846011698246, 0.023919714614748955, 0.0109593840315938, 0.023094896227121353, 0.017351722344756126, -0.01655745320022106, -0.030319688841700554, 0.017458641901612282, 0.02231590263545513, -0.029204659163951874, -0.02165910415351391, -0.0026004670653492212, 0.00010256523091811687, 0.005873007699847221, -0.0038453310262411833, 0.012822860851883888, 0.0031732572242617607, -0.019413765519857407, -0.0035207499749958515, -0.012883958406746387, 0.012135513126850128, 0.03323709964752197, 0.024041909724473953, 0.01246391236782074, -0.0068085649982094765, 0.03473399206995964, 0.009577050805091858, -0.011211412027478218, -0.01874169148504734, -0.023675324395298958, -0.023583678528666496, 0.02553880214691162, 0.0338786244392395, -0.0011264871573075652, -0.01568681187927723, 0.010020008310675621, 0.010921197943389416, -0.0028276739176362753, -0.018802789971232414, -0.01748919114470482, -0.011524536646902561, 0.011654369533061981, -0.009126455523073673, -0.02440849505364895, -0.00012016659457003698, -0.017428094521164894, -0.012135513126850128, 0.010226212441921234, -0.0281965471804142, 0.010172752663493156, -0.01835983246564865, -0.005170385353267193, -0.005968472920358181, -0.0018606132362037897, 0.044723451137542725, 0.0018510667141526937, -0.01616031862795353, 0.009126455523073673, 0.026577461510896683, 0.01805434376001358, 0.015518792904913425, 0.01952068693935871, -0.006365607492625713, -0.008568939752876759, -0.013548395596444607, -0.01473979838192463, 0.03418411314487457, 0.05080266296863556, 0.0061364914290606976, -0.01259374525398016, 0.011127402074635029, 0.026470540091395378, -0.027799412608146667, -0.011471076868474483, 0.009645785205066204, 0.011402341537177563, -0.0007976102060638368, -0.028272919356822968, -0.023324012756347656, -0.04649528115987778, 0.028135450556874275, 0.0010529791470617056, 0.03705570101737976, -0.0017240982269868255, 0.022682487964630127, 0.01895553432404995, 0.02161327935755253, 0.0007465364178642631, 0.002644381020218134, 0.041760217398405075, -0.03375643119215965, 6.402123108273372e-05, -0.003224808257073164, -0.01276940107345581, 0.025584625080227852, -0.0070453183725476265, 0.0038052357267588377, 0.005502603482455015, 0.034886736422777176, 0.046678576618433, 0.013097800314426422, 0.007156057748943567, 0.009806166402995586, -0.012204247526824474, -0.023324012756347656, -0.005483510438352823, 0.0028028530068695545, 0.0023083442356437445, 0.0006878254353068769, -0.03280941769480705, -0.0036028497852385044, 0.015068198554217815, -0.0561487041413784, 0.01826818659901619, -0.026638558134436607, -0.01577845774590969, -0.028899170458316803, 0.044937293976545334, 0.004280651453882456, 0.023965537548065186, -0.020513523370027542, 0.0067894719541072845, 0.016022847965359688, -0.009997096844017506, -0.029647616669535637, -0.04169911891222, 0.03409246727824211, -0.03241228312253952, -0.02338511124253273, -0.011318332515656948, -0.003243901301175356, 0.02016221173107624, -0.038491494953632355, -0.020101113244891167, 0.035222772508859634, -0.0023140721023082733, -0.017336446791887283, 0.011768927797675133, -0.027310632169246674, -0.01727535016834736, -0.020528797060251236, 0.0019198014633730054, -0.0066825514659285545, 0.021506359800696373, -0.025095844641327858, -0.01762666180729866, 0.0014042904367670417, 0.038705337792634964, 0.05303272604942322, -0.0010424780193716288, 0.003467289498075843, -0.01701568439602852, 0.018634771928191185, -0.0016324517782777548, -0.02717316336929798, -0.012761763297021389, 0.011173225939273834, 0.021475810557603836, 0.007767033763229847, -0.004605232272297144, -0.003914065659046173, 0.009057721123099327, -0.04117979109287262, 0.016526903957128525, 0.005884463898837566, -0.026149777695536613, 0.006128854118287563, 0.011020481586456299, 0.04298216849565506, -0.03864423930644989, -0.043959733098745346, -0.0045823208056390285, 0.0075722853653132915, -0.009508315473794937, 0.007205699570477009, -0.003452015109360218, 0.018756967037916183, 0.005937924142926931, 0.0033317292109131813, 0.0019493956351652741, -0.023782245814800262, 0.008232902735471725, 0.025981759652495384, 0.004047716967761517, -0.018207088112831116, 0.042921073734760284, 0.011119765229523182, 0.039438508450984955, -0.02691349759697914, 0.016099220141768456, -0.02523331344127655, -0.015014737844467163, -0.04117979109287262, 0.008500205352902412, 0.0026711111422628164, 0.02042187750339508, 0.04200460761785507, 0.005116925109177828, -0.02424047701060772, -0.006770378910005093, -0.008706409484148026, -0.04194350913167, 0.024683434516191483, 0.01637415960431099, 0.028990816324949265, 0.0317402109503746, -0.0004212393832858652, 0.015411872416734695, -0.0017890144372358918, 0.007740303874015808, 0.02326291613280773, -0.024041909724473953, -0.0075531923212111, 0.022590842097997665, 0.015350774861872196, 0.015312588773667812, 0.002168965293094516, 0.016007574275135994, 0.012998516671359539, 0.008691134862601757, -0.009577050805091858, 0.004685422871261835, 0.012861046940088272, 0.026363618671894073, 0.00431883754208684, -0.0013412835542112589, -0.006312146782875061, 0.00562098016962409, 0.005827184766530991, -0.010776091367006302, -0.038186006247997284, -0.007129327394068241, -0.007484457455575466, -0.0348256379365921, 0.001993309473618865, 0.018329283222556114, -0.020528797060251236, 0.009897813200950623, -0.003719317028298974, -0.021414712071418762, 0.01300615444779396, -0.028181273490190506, 0.002459178911522031, 0.027478650212287903, 0.024423770606517792, -0.005109287798404694, -0.010180389508605003, -0.02604285627603531, -0.012265345081686974, -0.032687220722436905, 0.02437794767320156, -0.03210679441690445, 0.0011073942296206951, -0.016603276133537292, -0.00386251462623477, -0.005659166257828474, 0.01651163026690483, -0.005349859595298767, -0.0072706155478954315, 0.019963644444942474, -0.038705337792634964]",Token-level Direct Preference Optimization.pdf
"2, in all experimen-
tal setups, ODPO is more effective in generating
more samples with positive sentiment, while not di-
verging too far from πSFT.7The difference between
the two methods is more pronounced with smaller
datasets, i.e., when |DHF|= 5000 .8
6.2 Toxicity Control
In this task, our goal is to reduce the toxicity of
the generations. We use GPT-neo-2.7b (Black
et al., 2021)9as the SFT checkpoint, πSFT. We
adversarially sample the prompts from REALTOXI-
CITY PROMPTS (Gehman et al., 2020), where we
sample 10000 prompts that have toxicity scores of
more than 0.3. We generate two preference pairs
from πSFTfor each prompt and compute their re-
wards using a toxicity classifier.10Similar to the
previous experiment, we choose the offset as the
logscaled differences between the rewards of pre-
ferred and dispreferred responses.
7Further experiments comparing SLiC-HF and ODPO
show the same trends App. D.
8When using more data, e.g., |D HF|= 10000 , we observe
the positive sentiment probability gets closer to the maximum
value 1., while this comes at the cost of diverging too much
from πSFT; we see an order of magnitude larger DKLwith
|D HF|= 10000 compared to |D HF|= 7500 .
9Specifically, we use https://huggingface.co/
EleutherAI/gpt-neo-2.7B .
10We use https://huggingface.co/facebook/
roberta-hate-speech-dynabench-r4-target .
0 0.2 0.4 0.6 0.8 10.660.680.70.720.740.760.780.8DPO ODPO
SFT Sentiment(a)∆r= log 
r(yw)−r(yl)
,100%
of points on Pareto front belong to
ODPO.
0 0.2 0.4 0.6 0.8 10.660.680.70.720.740.760.780.8DPO ODPO
SFT Sentiment(b)∆r= log r(yw)−logr(yl),63%
of points on Pareto front belong to
ODPO.
0 0.2 0.4 0.6 0.8 10.660.680.70.720.740.760.780.8DPO ODPO
SFT Sentiment(c)∆r=r(yw)−r(yl),91%
of points on Pareto front belong to
ODPO.
Figure 4: Investigating the effect of the offset formulation on the performance of ODPO. Scaling the offset with a
logfunction helps achieve the highest reward values without diverging too much from the SFT model.
We vary the KL regularization term β∈
{0.05,0.1,0.2,0.3,0.4,0.5}11and sample from
the fine-tuned model πθ. We evaluate the sam-
ples based on their average toxicity probabilities
and the KL divergence between πθandπSFT.
We observe that ODPO significantly outper-
forms DPO when using a dataset of size 8000 or
9000 , where all the points on the Pareto front are
from ODPO in Fig. 3. Concretely, in those two
setups, DPO fails to meaningfully reduce the toxic-
ity of the generations, as the toxicity scores are all
close to the toxicity scores of generations from πSFT
(shown with a dashed horizontal line). However,
ODPO manages to significantly reduce the toxicity
of the generations, cutting it almost by half. As we
increase the size of the dataset, the performance of
DPO gets closer to ODPO.
6.3 Summarization
Next, we test our method on a summarization task,
where we directly use the scores given by humans
to the pair of summaries for designing the offset.
We use REDDIT TL ;DRdataset collected by Stien-
non et al. (2020). We take the subset of this dataset
that is assessed by humans for quality using a 7-
point Likert scale.12For each of the two summaries
of a given Reddit post, we add a datapoint to DHF
if the overall quality score of one is greater than
the other. Moreover, we set the offset between","[0.03265486657619476, -0.016282331198453903, 0.03752603754401207, 0.016507847234606743, 0.007058683317154646, 0.019289223477244377, -0.00965964701026678, 0.040322445333004, -0.0018257483607158065, 0.0016725846799090505, 0.03590231388807297, -0.0319632813334465, -0.03442893549799919, -0.00400668615475297, 0.03878892958164215, -0.013380677439272404, 0.03845817223191261, -0.05734146758913994, -0.023589082062244415, 0.048471130430698395, -0.01548550371080637, 0.00017113455396611243, 0.011569024063646793, 0.018597638234496117, 0.02799418196082115, -0.031632523983716965, 0.02821969985961914, 0.009389026090502739, 0.02579914964735508, -0.04119444638490677, 0.03313596919178963, -0.048350851982831955, -0.025242874398827553, -0.03551141545176506, 0.00488244416192174, 0.033647142350673676, 0.008727509528398514, 0.055657606571912766, -0.028249768540263176, 0.005675512365996838, -0.00305387657135725, -0.03454921022057533, -0.03376741707324982, -0.01907874085009098, -0.03250452131032944, 0.028460251167416573, 0.05132767930626869, -0.024686599150300026, 0.05872463807463646, 0.02288246341049671, -0.05574781447649002, 0.04143499955534935, -0.010411370545625687, -0.006498649250715971, 0.018432259559631348, -0.009419094771146774, 0.025543563067913055, 0.02614494226872921, 0.031572386622428894, -0.046456512063741684, 0.005145546980202198, -0.031241627410054207, 0.043690167367458344, -0.009794957004487514, -0.01671832986176014, 0.025408253073692322, -0.08058475703001022, -7.364540942944586e-05, 0.02115349844098091, 0.015771158039569855, 0.031001076102256775, 0.03442893549799919, 0.06302449852228165, -0.03436879813671112, 0.011877231299877167, -0.003623307216912508, 0.03966093063354492, 0.022912532091140747, 0.018372122198343277, -0.04958368092775345, 0.01602674461901188, 0.044622305780649185, 0.019334327429533005, -0.013395712710916996, -0.005972443148493767, -0.039961621165275574, -0.00620547728613019, -0.025949494913220406, -0.05977705121040344, 0.002086032647639513, -0.018868260085582733, -0.011351024731993675, -0.01261391956359148, 0.00673920102417469, 0.011877231299877167, -0.04844105988740921, 0.003987892996519804, -0.014816469512879848, -0.0014057229273021221, 0.018582604825496674, 0.003946548327803612, -0.012779299169778824, -0.027092114090919495, -0.0009838180849328637, 0.005077891983091831, 0.0133881950750947, 0.017785778269171715, 0.018823156133294106, 0.009637095034122467, 0.023574048653244972, -0.0267763901501894, -0.012689092196524143, -0.06428739428520203, 0.03978120535612106, -0.02355901338160038, -0.04384051263332367, -0.06933896988630295, 0.026731286197900772, 0.019153913483023643, -0.010990196838974953, -0.04603554680943489, -0.00787054467946291, 0.004972650669515133, 0.04402092471718788, -0.004683237057179213, -0.025483425706624985, 0.015711020678281784, -0.08611743897199631, -0.03193321451544762, -0.025603702291846275, 0.025318047031760216, -0.00455168541520834, 0.00561537453904748, -0.008825233206152916, -0.02787390723824501, 0.03656382858753204, -0.022957634180784225, 0.02494218572974205, -0.01494426280260086, -0.0382777601480484, -0.029632939025759697, -0.05842394754290581, -0.034278590232133865, -0.001965756993740797, -0.05201926454901695, -0.03199335187673569, -0.003961582668125629, -0.0014508262975141406, -0.02044687792658806, 0.08852295577526093, 0.024175425991415977, -0.025137633085250854, -0.017455019056797028, 0.014267711900174618, 0.01129088643938303, -0.024912115186452866, 0.00971226766705513, 0.011223231442272663, -0.0007164864218793809, -0.010411370545625687, -0.026731286197900772, 0.0024487392511218786, -0.018582604825496674, -0.03193321451544762, 0.029437491670250893, 0.03659389913082123, -0.012072678655385971, -0.018296949565410614, -0.06867745518684387, -0.055537331849336624, -0.0023059118539094925, -0.009366474114358425, -0.02948259375989437, -0.01759032905101776, -0.009313853457570076, -0.009464198723435402, -0.029858456924557686, 0.02482190914452076, -0.0022213428746908903, 0.0017815845785662532, 0.005051581654697657, 0.01480143517255783, -0.02573901228606701, 0.06107001379132271, -0.016973916441202164, -0.026761354878544807, 0.013921918347477913, -0.0003718681982718408, 0.02062729187309742, 0.017620397731661797, 0.04871167987585068, 0.01850743219256401, 0.06218256428837776, -0.016973916441202164, -0.006073925644159317, -0.05003471300005913, 0.07679606974124908, 0.056980639696121216, -0.034910038113594055, -0.012170403264462948, 0.0030238076578825712, 0.04504327103495598, -0.02205556631088257, -0.07890089601278305, -0.028806043788790703, -0.011396127752959728, -0.007742751855403185, -0.03265486657619476, -0.0002976355026476085, -0.008261441253125668, 0.030008800327777863, 0.05304160714149475, 0.05586808919906616, 0.014545849524438381, -0.004198375623673201, 0.00513051263988018, -0.053071677684783936, 0.03190314397215843, 0.02861059457063675, 0.0429685153067112, -0.007588648237287998, 0.038879137486219406, 0.028775975108146667, 0.021394049748778343, -0.035150591284036636, 0.019063707441091537, 0.03202341869473457, -0.004431409761309624, 0.010215922258794308, -0.024115288630127907, 0.050936780869960785, 0.010080611333251, -0.01407978031784296, 0.00041039404459297657, -0.0027719803620129824, -0.043419547379016876, 0.011268334463238716, -0.04808023199439049, -0.030940938740968704, -0.03250452131032944, 0.026626044884324074, 0.01590646803379059, 0.039691001176834106, 0.0046343752183020115, -0.0035556519869714975, 0.01942453533411026, -0.019965775310993195, -0.04495306313037872, -0.007712682709097862, -0.014981849119067192, 0.016192123293876648, -0.009486749768257141, -0.014440608210861683, -0.06488876789808273, -0.06278394162654877, -0.04672713205218315, 0.022777222096920013, -0.01688370853662491, -0.00596116716042161, 0.030294455587863922, -0.03340659290552139, -0.01849239692091942, -0.005017754156142473, 0.0021969119552522898, -0.022311152890324593, -0.005690546706318855, -0.016868675127625465, 0.009531853720545769, -0.032203834503889084, -0.004040513653308153, 0.024806873872876167, 0.029617905616760254, -0.0040743411518633366, 0.030880799517035484, -0.033015694469213486, -0.0348198302090168, 0.002787014702335, 0.055026158690452576, -0.05027526617050171, -0.040202170610427856, 0.023303426802158356, -0.008780130185186863, 0.038819000124931335, -0.026280252262949944, 0.01665819250047207, 0.0023021530359983444, -0.0046381340362131596, 0.012816885486245155, 0.030309490859508514, -0.006630200892686844, -0.003643979551270604, -0.01834205351769924, 0.04161541163921356, -0.05057595670223236, 0.007096269633620977, 0.020837774500250816, 0.020206326618790627, -0.011298404075205326, -0.021168533712625504, 0.0031797902192920446, 0.05475553870201111, -0.005946132820099592, 0.015117159113287926, -0.007893096655607224, 0.07192490249872208, -0.03707500174641609, 0.013485918752849102, 0.029287146404385567, -0.006934648845344782, -0.003734186291694641, -0.0029129283502697945, -0.023408668115735054, -0.011102955788373947, 0.03193321451544762, 0.018552536144852638, 0.029557766392827034, 0.08677896112203598, -0.014320332556962967, -0.008509509265422821, -0.02522783912718296, -0.03247445449233055, -0.06100987643003464, 0.01826688088476658, 0.02213073894381523, 0.025934459641575813, -0.02274715155363083, -0.008787647821009159, 0.0006093658157624304, -0.0006737321382388473, -0.005780753679573536, -0.030099008232355118, -0.0069158561527729034, 0.023574048653244972, 0.027843836694955826, -0.024400943890213966, -0.03214369714260101, -0.027212388813495636, 0.04606561362743378, 0.026746321469545364, 0.03905955329537392, -0.08617758005857468, -0.002352894516661763, 0.006506166886538267, -0.010952611453831196, -0.011944886296987534, -0.00048086809692904353, -0.016793502494692802, 0.03911969065666199, 0.03557155653834343, 0.03355693444609642, -0.014846538193523884, -0.016868675127625465, -0.008411785587668419, 0.015726055949926376, 0.026190046221017838, -0.0017430587904527783, -0.01255378220230341, -0.01510964147746563, -0.014718745835125446, -0.018702879548072815, -0.01427522860467434, -0.0008602535235695541, 0.010899990797042847, 0.02298770472407341, 0.06585097312927246, 0.0035124279092997313, -0.014515779912471771, -0.011456266045570374, -0.00844937190413475, -0.014154952950775623, -0.010674472898244858, 0.0062806494534015656, -0.01695888116955757, 0.015049504116177559, -0.06182174012064934, 0.043239135295152664, 0.03821762278676033, 0.01694384776055813, -0.006491132080554962, 0.025708943605422974, -0.007810406852513552, 0.01883818954229355, -0.037556104362010956, -0.009208612143993378, -0.009509301744401455, 0.03872879222035408, 0.011614128015935421, -0.0004381138423923403, -0.057040777057409286, -0.01117812842130661, 0.0003930104139726609, -0.01734977774322033, -0.0005088228499516845, 0.026641080155968666, -0.020762601867318153, 0.011080403812229633, -0.048230577260255814, 0.0765555202960968, 0.042036376893520355, 0.04221678897738457, -0.005870960187166929, -0.013343092054128647, -0.06982007622718811, 0.005566512234508991, -0.03385762497782707, 0.02011612057685852, 0.03109128214418888, 0.04149513691663742, 0.047599129378795624, 0.024686599150300026, 0.03394783288240433, -0.043419547379016876, 0.02327335812151432, -0.029693076387047768, 0.0069647179916501045, -0.02115349844098091, 0.0013314902316778898, 0.02867073379456997, 0.025829218327999115, 0.04940326511859894, -0.016928812488913536, -0.035481348633766174, -0.004183341283351183, -0.02608480490744114, -0.0015795589424669743, 0.036744244396686554, -0.003155359299853444, -0.01494426280260086, 0.06440766900777817, -0.04176575690507889, -0.029061630368232727, 0.06016794592142105, 0.06549014896154404, -0.02086784318089485, -0.07583386451005936, -0.00036035742959938943, 0.013718953356146812, -0.010494059883058071, 0.000721654505468905, -0.01736481301486492, 0.006953442003577948, 0.007216545287519693, -0.012110264971852303, -0.01462102122604847, -0.030730456113815308, -0.025363149121403694, 0.03839803487062454, -0.0032512040343135595, 0.011734403669834137, 0.005145546980202198, -0.020326603204011917, 0.0013540418585762382, 0.05785263702273369, -0.002749428618699312, -0.021348945796489716, -0.05487581342458725, 0.027077078819274902, -0.013237850740551949, 0.060017600655555725, -0.021333912387490273, 0.033707279711961746, 0.00400668615475297, -0.0417356863617897, 0.029753215610980988, -0.0001255613169632852, 0.013891849666833878, 0.003643979551270604, -0.0024788081645965576, -0.016868675127625465, 0.030610179528594017, -0.01598164066672325, -0.05328216031193733, 0.003232410876080394, -0.027092114090919495, -0.0435698926448822, -0.034278590232133865, 0.0722857266664505, -0.017379846423864365, 0.02425059862434864, 0.017274605110287666, 0.008862819522619247, -0.043058719485998154, 0.006513684056699276, 0.020672395825386047, 0.050245195627212524, 0.06416711211204529, 0.07192490249872208, -0.012373368255794048, -0.024280667304992676, 0.01891336217522621, 0.002696807961910963, -0.03454921022057533, 0.04068327322602272, -0.019409500062465668, -0.01643267460167408, -0.023754462599754333, 0.015605779364705086, 0.015192331746220589, 0.0037999621126800776, -0.03154231607913971, 0.06645235419273376, -0.0031609972938895226, -0.01592150330543518, 0.03313596919178963, 0.03590231388807297, -0.014418056234717369, 0.03451914340257645, -0.03905955329537392, -0.015951571986079216, -0.009065785445272923, -0.007750269025564194, 0.013681367039680481, 1.9101411453448236e-05, 0.028926318511366844, -0.015771158039569855, 0.008922957815229893, -0.015267503447830677, -0.026280252262949944, -0.01548550371080637, 0.00482982350513339, -0.02011612057685852, 0.0028753422666341066, -0.04871167987585068, 0.01592150330543518, 0.004780961200594902, -0.020582187920808792, -0.007968268357217312, -0.11227741837501526, -0.03265486657619476, -0.01883818954229355, 0.018026329576969147, -0.017800811678171158, 0.012816885486245155, 0.01834205351769924, -0.03442893549799919, -0.02758825197815895, -0.006524959579110146, -0.03671417385339737, -0.033015694469213486, -0.006430994253605604, 0.03313596919178963, 0.002452497836202383, 0.010847370140254498, -0.007517234887927771, 0.012734195217490196, -0.02918190509080887, 0.023634186014533043, -0.0053635467775166035, -0.03872879222035408, -0.015530606731772423, 0.005649202037602663, -0.04302865266799927, -0.013147643767297268, -0.003070790320634842, -0.03214369714260101, 0.02506246045231819, 0.000584934838116169, -0.013027368113398552, 0.01255378220230341, -0.002582170069217682, 0.01040385290980339, -0.008659854531288147, -0.007592407055199146, 0.03596245124936104, -0.007923165336251259, 0.00919357780367136, 0.03130176663398743, 0.009524336084723473, 0.017424950376152992, 0.06022808328270912, -0.040532927960157394, -0.004517857916653156, 0.04218672215938568, -0.052259813994169235, 0.003476721001788974, 0.008637302555143833, 0.012628953903913498, -0.02948259375989437, 0.022281084209680557, -0.040021758526563644, -0.011614128015935421, -0.0033808762673288584, 0.0049989609979093075, -0.014876607805490494, -0.03575196862220764, 0.015951571986079216, 0.02050701715052128, 0.011508886702358723, -0.01958991400897503, 0.00242054951377213, -0.006149097811430693, -0.03109128214418888, 0.021409085020422935, -0.0022739635314792395, 0.01747005432844162, 0.020086051896214485, 0.050816506147384644, -0.04308879002928734, 0.008464406244456768, -0.011298404075205326, 0.015177296474575996, -0.03821762278676033, -0.0008922017877921462, -0.049854300916194916, -0.029452525079250336, 0.03731555491685867, -0.02373942732810974, -0.0007178959203884006, 0.024972254410386086, -0.006359580438584089, -0.001658489927649498, -0.021273775026202202, -0.015590745024383068, -0.03361707553267479, -0.02862562984228134, -0.010396335273981094, -0.006908338516950607, 0.012335781939327717, 0.03235417976975441, -0.018868260085582733, -0.01655295118689537, -0.04098396375775337, -0.018808120861649513, -0.017455019056797028, 0.01508709043264389, 0.01068950816988945, -0.0045103407464921474, -0.021739842370152473, -0.008840268477797508, -0.016162054613232613, -0.024461081251502037, -0.0033132212702184916, -0.0001255613169632852, -0.02781376801431179, 0.0033000661060214043, 0.01620715856552124, 0.011313438415527344, 0.035541485995054245, -0.007656303700059652, -0.048350851982831955, 0.032083556056022644, 0.04182589426636696, 0.03385762497782707, -0.01168929971754551, 0.023123014718294144, -0.01011068094521761, -0.009855094365775585, 0.0009819387923926115, 0.014245159924030304, -0.034849900752305984, -0.017575295642018318, -0.020491981878876686, -0.01665819250047207, 0.03304576501250267, 0.021228671073913574, 0.014147435314953327, -0.0023134290240705013, -0.006701614707708359, -0.028144527226686478, -0.01759032905101776, -0.04005182534456253, -0.006866993848234415, -0.015222400426864624, 0.010952611453831196, 0.03181293606758118, 0.04101403430104256, 0.025468390434980392, 0.035421211272478104, 0.0007634691428393126, 0.00577323604375124, -0.0036853242199867964, 0.020642327144742012, 0.05235002189874649, 0.0053710644133389, 0.0024581358302384615, 3.062685937038623e-05, -0.008742543868720531, -0.055717743933200836, -0.017951156944036484, 0.03966093063354492, -0.025934459641575813, 0.00268741138279438, -0.02999376691877842, -0.015816261991858482, 0.005645443219691515, -0.02337859943509102, 0.031572386622428894, -0.011606610380113125, -0.00933640543371439, -0.019063707441091537, -0.019680120050907135, 0.005239512771368027, 0.006446028593927622, -0.012350816279649734, 0.013440815731883049, 0.009855094365775585, 0.007423269096761942, 0.0623028427362442, -0.017049089074134827, -0.043118856847286224, -0.009524336084723473, 0.00012838027032557875, -0.00856212992221117, -0.007690131198614836, -0.03506038337945938, -0.013463367708027363, -0.022897496819496155, 0.041104238480329514, 0.01172688603401184, -0.04877181723713875, -0.007795372512191534, -0.006299442611634731, -0.02223598025739193, 0.032203834503889084, -0.016417641192674637, 0.0022438946180045605, 0.011298404075205326, 0.0046343752183020115, 0.009343923069536686, -0.030324524268507957, -0.024731703102588654, -0.02252163551747799, -0.026054736226797104, 0.021183567121624947, -0.011253300122916698, 0.013095023110508919, -0.02303280681371689, -0.031752798706293106, -0.011914816685020924, 0.0019037396414205432, 0.012110264971852303, 0.010899990797042847, -0.0168987438082695, -0.00410816865041852, -0.022837359458208084, 0.011080403812229633, -0.006957200821489096, 0.033526867628097534, 0.00016808067448437214, 0.011644196696579456, 0.0364435538649559, -0.00026333812274970114, -0.006021304987370968, 0.014643573202192783, -0.016237227246165276, -0.02603970095515251, -0.009088336490094662, 0.054274436086416245, 0.016282331198453903, -0.00017219166329596192, -0.010704542510211468, 0.015470469370484352, -0.0168987438082695, -7.72278435761109e-05, 0.015267503447830677, 0.020672395825386047, -0.0196500513702631, 0.032203834503889084, 0.012628953903913498, 0.020071016624569893, -0.01011068094521761, 0.00873502716422081, -0.0006154736038297415, 0.004604306071996689, 0.014418056234717369, 0.02040177583694458, -0.047899819910526276, 0.00787054467946291, -0.025408253073692322, -0.008456888608634472, -0.000773335515987128, -0.0329856276512146, 0.006321994587779045, 0.011974954977631569, 0.06260353326797485, -0.02683652751147747, 0.00577323604375124, 0.0012187316315248609, -0.002300273859873414, 0.004141996148973703, -0.02706204541027546, -0.023228256031870842, 0.029347283765673637, -0.009110888466238976, -0.01080226618796587, -0.00875757820904255, 0.013425781391561031, 0.008968060836195946, 0.005408650264143944, -0.03424851968884468, -0.0009363655699416995, 0.009832543320953846, -0.01608688198029995, 0.01930425874888897, 0.014846538193523884, 0.02107832580804825, -0.034338727593421936, -0.13699407875537872, -0.0175151564180851, 0.024746736511588097, -0.019048672169446945, -0.016417641192674637, 0.009945301339030266, 0.02862562984228134, 0.015665916725993156, 0.005168098956346512, -0.015560676343739033, 0.020491981878876686, -0.05349264293909073, -0.022506600245833397, -0.011674265377223492, -0.0272875614464283, -0.039510585367679596, -0.00013049450353719294, -0.008915440179407597, -0.008058475330471992, -0.03647362440824509, -0.0637461468577385, 0.010088128969073296, 0.027047010138630867, 0.008953026495873928, -0.037616241723299026, 0.010975162498652935, 0.003384634852409363, 0.006502408068627119, 0.003773651784285903, 0.0010232835775241256, 0.005194409284740686, -0.005382339935749769, 0.012621437199413776, -0.018357086926698685, -0.036744244396686554, -0.003826272441074252, -0.01568095199763775, 0.018823156133294106, 0.002941118087619543, 0.03361707553267479, 0.03638341650366783, -0.017154330387711525, 0.021739842370152473, -0.026190046221017838, 0.0427580326795578, -0.05325208976864815, 0.012027575634419918, -0.005465029738843441, -0.011989989317953587, 0.02195032499730587, 0.016988949850201607, 0.009148474782705307, 0.00036106217885389924, -0.006998545490205288, 0.000844749272800982, -0.007667579222470522, 0.03109128214418888, -0.016988949850201607, 0.006513684056699276, -0.00048392199096269906, -0.03050493821501732, 0.04970395565032959, 0.02264191024005413, -0.0047584096901118755, -0.030595146119594574, -0.002758825197815895, -0.03130176663398743, 0.004826064687222242, -0.021679705008864403, -0.023769496008753777, 0.013989574275910854, 0.03211362659931183, 0.01826688088476658, 0.0005464089917950332, -0.02080770581960678, 0.0007164864218793809, 0.05033540353178978, -0.018131570890545845, -0.052139539271593094, 0.026626044884324074, 0.049162715673446655, -0.0366540364921093, 0.039961621165275574, 0.027362734079360962, 0.007663820870220661, 0.033587004989385605, 0.0005102322902530432, 0.008599716238677502, 0.007043648976832628, 0.017424950376152992, 0.030670316889882088, -0.024972254410386086, -0.0029561526607722044, -0.014042194932699203, -0.02730259671807289, -0.0411343090236187, -0.007152648642659187, 0.0200559813529253, 0.03527086600661278, 0.008930474519729614, 0.01625226065516472, -0.0013446453958749771, -0.035661760717630386, -0.005348512437194586, -0.0018473603995516896, 0.03752603754401207, 0.003012531902641058, 0.0057920292019844055, 0.004235961940139532, -0.02722742408514023, -0.0009161629714071751, 0.0019300499698147178, -0.017214467748999596, 0.011952403001487255, -0.02694176882505417, 0.0327751450240612, 0.023934874683618546, 0.0095694400370121, 0.008336612954735756, 0.012042609974741936, 0.006987269502133131, 0.029632939025759697, -0.01677846722304821, 0.045825064182281494, 0.002973066410049796, 0.024521220475435257, -0.027678458020091057, -0.006224270444363356, -0.03575196862220764, 0.01952977664768696, 0.0076337517239153385, 0.009208612143993378, 0.037736520171165466, 0.008998129516839981, 0.016628123819828033, 0.028309905901551247, 0.05725125968456268, -0.022687014192342758, -0.00908081978559494, 0.046636924147605896, 0.009997921995818615, 0.02113846316933632, 0.014906676486134529, 0.015500538051128387, -0.01907874085009098, 0.009065785445272923, 0.02367928996682167, -0.037886861711740494, -0.009088336490094662, 0.0022833601105958223, -0.015560676343739033, -0.007893096655607224, 0.0012544385390356183, -0.0004998961230739951, 0.0409238263964653, 0.03509045019745827, -0.00014717335579916835, -0.022326186299324036, 0.011832127347588539, -0.009892680682241917, 0.003446652088314295, 0.024897081777453423, -0.010050542652606964, -0.03719527646899223, 0.05021512880921364, -0.03385762497782707, -0.026851562783122063, -0.014042194932699203, 0.009471715427935123, -0.007735234685242176, 0.00561537453904748, -0.036233071237802505, 0.015275021083652973, -0.006487373728305101, 0.03638341650366783, 0.029121767729520798, 0.004442685749381781, 0.027708526700735092, -0.027031976729631424, 0.00601754616945982, 0.010306129232048988, 0.012290678918361664, 0.004303616937249899, -0.006461063399910927, 0.061340633779764175, -0.028415147215127945, 0.01637253724038601, 0.011125507764518261, -0.028144527226686478, 0.023574048653244972, -0.009509301744401455, 0.027107149362564087, 0.0010712059447541833, 0.04579499363899231, 0.008351648226380348, -0.004172065295279026, -0.0009504603804089129, 0.02769349329173565, -0.017049089074134827, -0.04820051044225693, 0.010697024874389172, 0.05388353765010834, 0.012350816279649734, -0.029467560350894928, -0.02419046126306057, 0.04811030253767967, -0.004668202716857195, 0.0013399471063166857, -0.016056813299655914, 0.021183567121624947, -0.016913777217268944, 0.03957072272896767, -0.024220529943704605, 0.016973916441202164, -0.010621852241456509, -0.02987349033355713, -0.015891434624791145, 0.019289223477244377, -0.02826480194926262, -0.038758862763643265, -0.032203834503889084, -0.02781376801431179, 0.03172273188829422, 0.02569390833377838, -0.04062313586473465, -0.004901236854493618, 0.045253753662109375, 0.01977032795548439, 0.015147227793931961, 0.014485711231827736, -0.012441023252904415, 0.007103786803781986, -0.018357086926698685, 0.0027118425350636244, 0.0068406835198402405, -0.00962206069380045, -0.006246821954846382, -0.007246614433825016, 0.01989060267806053, -0.01065943855792284, 0.023483840748667717, 0.003581962315365672, -0.0072203041054308414, -0.019394464790821075, -0.0013878694735467434, 0.01763543300330639, 0.0036496175453066826, 0.030474869534373283, -0.015936536714434624, 0.00610399479046464, -0.013230333104729652, -0.006273132283240557, 0.030324524268507957, -0.015650883316993713, 0.010163301602005959, -0.0034447729121893644, 0.003931513987481594, 0.05096685141324997, 0.04326920211315155, 0.013771574012935162, -0.040142033249139786, 0.0028715836815536022, -0.00036881433334201574, -0.013959504663944244, -0.008043440990149975, -0.034038037061691284, 0.0034259797539561987, -0.009531853720545769, 0.020040947943925858, -0.011734403669834137, -0.022100670263171196, 0.019514741376042366, -0.009073302149772644, 0.03758617490530014, -0.0067204078659415245, 0.0008691802504472435, 0.016041778028011322, 0.0006093658157624304, 0.019559845328330994, -0.019093776121735573, -0.0006065468769520521, 0.004750892519950867, -0.01602674461901188, 0.00024689416750334203, -0.0074533382430672646, -0.03545127809047699, -0.024280667304992676, -0.008832750841975212, 0.001567343482747674, 0.04465237259864807, 0.03286534920334816, 0.024957219138741493, -0.02722742408514023, -0.004021720495074987, -0.025017356500029564, 0.008524544537067413, 0.003439134918153286, 0.003093342063948512, 0.0012694729957729578, -0.0321737639605999, -0.0018858863040804863, 0.0016303003067150712, 0.02476177178323269, -0.007953234016895294, 0.013380677439272404, 0.006028822157531977, 0.01832701824605465, -0.029497629031538963, -0.018296949565410614, -0.020371705293655396, 0.014004608616232872, -0.016462743282318115, 0.01269660983234644, 0.02591942623257637, -0.0024562564212828875, 3.0303852327051573e-05, 0.009922750294208527, -0.024220529943704605, -0.015951571986079216, 0.015094607137143612, 0.006682821549475193, -0.017079157754778862, 0.018928397446870804, 0.04426147788763046, -0.014590952545404434, -0.005239512771368027, 0.029332250356674194, -0.003704117378219962, -0.026565907523036003, 0.014500745572149754, -0.0017552743665874004, -0.0014517660019919276, 0.012343299575150013, -0.012298195622861385, -0.04429154843091965, 0.005931098014116287, -0.030294455587863922, -0.0062317876145243645, -0.004529133904725313, -0.022777222096920013, 0.011839644983410835, 0.011839644983410835, -0.009328888729214668, -0.02522783912718296, -0.0016227830201387405, 0.006949683651328087, -0.0052432711236178875, 0.02176991105079651, 0.0021292567253112793, 0.005949891172349453, 0.0796225517988205, -0.041916102170944214, -0.019845500588417053, 0.022611841559410095, -0.014027159661054611, 0.012831919826567173, -0.0346093475818634, 0.0025483425706624985, -0.023589082062244415, 0.022852392867207527, -0.005506374407559633, 0.0163875725120306, -0.011050335131585598, -0.0002941118145827204, 0.026475701481103897, 0.011441231705248356, -0.01736481301486492, 0.03740575909614563, 0.005822098348289728, -0.016793502494692802, 0.0012459816643968225, 0.017785778269171715, -0.012801851145923138, 0.008374199271202087, 0.018357086926698685, 0.0061115119606256485, -0.007968268357217312, 0.01849239692091942, 0.022536668926477432, 0.006430994253605604, 0.010554197244346142, -0.0535527803003788, -0.030444800853729248, -0.004750892519950867, -0.010877438820898533, -0.02241639420390129, -0.010501576587557793, 0.028700802475214005, -0.015079572796821594, -0.024957219138741493, -0.029001491144299507, -0.009178543463349342, -0.0022570497822016478, 0.0014536452945321798, -0.0009828784968703985, 0.03268493711948395, -0.005577788222581148, 0.010012956336140633, 0.015132193453609943, 0.007036131806671619, 0.03572189807891846, -0.0020071016624569893, 0.023664254695177078, -0.02321322076022625, 0.020777637138962746, -0.014583434909582138, -0.0018680328503251076, 0.024566322565078735, 0.03608272597193718, 0.024851977825164795, -0.02838507853448391, 0.005089167971163988, -0.03292548656463623, 0.00018147075024899095, 0.010388818569481373, -0.04302865266799927, -0.0027813769411295652, 0.010719576850533485, 0.005408650264143944, 0.01586136594414711, -0.02815956063568592, -0.016703296452760696, -0.011839644983410835, -0.011832127347588539, 0.018883293494582176, -0.0009039474534802139, -0.010043025948107243, 0.017725639045238495, 0.021409085020422935, 0.0033357730135321617, -0.0036251863930374384, 0.004908754490315914, -0.007077476475387812, -0.007111303973942995, -0.013959504663944244, -0.029151836410164833, 0.0023942391853779554, 0.006333270110189915, -0.035481348633766174, 0.025814184918999672, -0.01688370853662491, 0.009937784634530544, 0.014914194121956825, -0.009471715427935123, -0.02820466458797455, -0.015951571986079216, 0.001956360414624214, 0.010080611333251, 0.028084389865398407, 0.021213635802268982, -0.018552536144852638, 0.0021893945522606373, -0.010163301602005959, 0.016237227246165276, 0.00899061281234026, -0.004442685749381781, -0.03842810541391373, 0.0002941118145827204, -0.014004608616232872, 0.004179582465440035, 0.01056923158466816, -0.0015382141573354602, 0.009486749768257141, 0.02510756440460682, -0.024867013096809387, 0.03130176663398743, 0.009253716096282005, 0.05367305502295494, -0.0032530834432691336, 0.0007498441846109927, -0.001945084542967379, 0.002606601221486926, 0.018432259559631348, 0.0024261875078082085, 0.004243479110300541, 0.02907666377723217, -0.011959920637309551, -0.03836796432733536, -0.03978120535612106, 0.0035876003094017506, 0.02264191024005413, 0.009892680682241917, 0.024972254410386086, -0.012914609163999557, -0.018973499536514282, 0.017079157754778862, 0.011854679323732853, -0.021409085020422935, -0.020071016624569893, 0.011080403812229633, -0.001303300610743463, 0.0038826516829431057, -0.002553980564698577, 0.002108584390953183, -0.009629577398300171, -0.022446462884545326, -0.0022626875434070826, -0.009787439368665218, 0.025152666494250298, 0.02797914855182171, 0.0063558220863342285, -0.006212994456291199, 0.0024374632630497217, 0.04038258641958237, -0.020086051896214485, -0.009892680682241917, -0.0032737557776272297, -0.03500024601817131, -0.005141788627952337, 0.04119444638490677, 0.019454604014754295, -0.007885579019784927, -0.003536858828738332, 0.02011612057685852, 0.016507847234606743, -0.029693076387047768, -0.03385762497782707, -0.013177712447941303, 0.003632703796029091, 0.010794749483466148, -0.01989060267806053, -0.024551289156079292, 0.014966814778745174, -0.022732118144631386, -0.022311152890324593, 0.005209443625062704, -0.03340659290552139, 0.012343299575150013, -0.023709358647465706, 0.008299027569591999, -0.004284823779016733, -0.005589064210653305, 0.016537915915250778, 0.0123207475990057, -0.025543563067913055, 0.011463782750070095, 0.03439886495471001, 0.009148474782705307, -0.0028227216098457575, 0.01040385290980339, -0.01045647356659174, -0.014185021631419659, -0.032083556056022644, -0.010794749483466148, 0.040472790598869324, 0.04402092471718788, 0.014658607542514801, -0.020491981878876686, -0.014087297953665257, 0.020822741091251373, -0.030595146119594574, -0.034158315509557724, -0.0008391113369725645, 0.01324536744505167, -0.0007113183382898569, -0.009434130042791367, -0.014884124509990215, -0.05021512880921364, 0.009637095034122467, -0.00019227676966693252, 0.048531267791986465, -0.001433912548236549, 0.024040115997195244, 0.03265486657619476, 0.02062729187309742, -0.0036195486318320036, 0.0040743411518633366, 0.027663424611091614, -0.02913680113852024, -0.005675512365996838, -0.022566739469766617, -0.02310797944664955, 0.024145357310771942, -0.002901652595028281, -0.01958991400897503, -0.004168306477367878, 0.014951779507100582, 0.028866181150078773, 0.013839229010045528, 0.008035924285650253, 0.0024769287556409836, -0.017710605636239052, -0.02062729187309742, -0.0007080295472405851, -0.008840268477797508, -0.003247445449233055, 0.01465109083801508, -0.029227009043097496, -0.004311134107410908, 0.010020473971962929, -0.05929594859480858, 0.0012215506285429, -0.02022136189043522, -0.015891434624791145, -0.042427271604537964, 0.052831124514341354, 0.0020503257401287556, 0.06107001379132271, -0.003692841622978449, 0.006570063065737486, -0.00640468392521143, 0.00013378328003454953, -0.020958051085472107, -0.04233706742525101, 0.013079988770186901, -0.0036778070498257875, -0.010343714617192745, -0.0027249976992607117, -0.010321163572371006, 0.014974331483244896, -0.03581210598349571, -0.007832958362996578, 0.007058683317154646, -0.01804136298596859, -0.012884540483355522, -0.013079988770186901, -0.013403229415416718, -0.021123429760336876, -0.028941353783011436, 0.01632743328809738, -0.004773444030433893, 0.017785778269171715, -0.012779299169778824, -0.021875152364373207, 0.012674057856202126, 0.01568095199763775, 0.0429685153067112, 0.0034541692584753036, 0.0042697894386947155, -0.033346451818943024, 0.04152520373463631, -0.0037266691215336323, -0.013726470991969109, 0.00012967230577487499, 0.024235565215349197, 0.0071451314724981785, 0.007675096858292818, -0.004344961605966091, -0.012583850882947445, 0.003890169085934758, -0.02803928591310978, 0.010268542915582657, 0.013470884412527084, -0.01665819250047207, -0.010719576850533485, 0.021108394488692284, 0.030038870871067047, -0.016537915915250778, -0.038758862763643265, 0.009607026353478432, 0.022656945511698723, 0.000549697782844305, 0.011771989986300468, 0.011223231442272663, 0.008035924285650253, 0.021454187110066414, 0.002228860044851899, 0.02545335702598095, -0.012223023921251297, 0.01431281492114067, 0.011621644720435143, 0.013764056377112865, -0.02068742923438549, 0.03103114478290081, 0.021063292399048805, 0.05198919400572777, -0.020702464506030083, 0.03527086600661278, -0.01011068094521761, 0.0022438946180045605, -0.02960287034511566, -0.0043900650925934315, 0.007618717383593321, 0.016071848571300507, 0.04372023791074753, 0.008223854936659336, -0.00434120325371623, -0.003459807252511382, 0.0017139294650405645, -0.04534396156668663, 0.04666699469089508, 0.021213635802268982, 0.017169363796710968, 0.04994450882077217, 0.02533308044075966, -0.012929643504321575, 0.0015758003573864698, 0.017034053802490234, -0.000783671741373837, -0.03656382858753204, -0.025814184918999672, 0.02809942327439785, 0.020296534523367882, -0.0035255830734968185, -0.01051661092787981, 0.005250788293778896, 0.00203153258189559, -0.014500745572149754, -0.012967229820787907, -0.009343923069536686, 0.01867281086742878, 0.03385762497782707, 0.02022136189043522, -0.003856341354548931, 0.008336612954735756, 0.012576333247125149, -0.0010975162731483579, -0.02757321670651436, -0.015440399758517742, -0.010448955930769444, 0.0001463511580368504, -0.037375692278146744, 0.0013239729451015592, 0.032324109226465225, -0.01722950115799904, 0.0022438946180045605, 0.015620813705027103, -0.02074756845831871, 0.026791425421833992, -0.0005191590171307325, 0.01017081830650568, 0.03253459185361862, 0.01918398216366768, -0.006055132485926151, -0.013448333367705345, -0.018597638234496117, -0.016222191974520683, -0.016583019867539406, 0.029467560350894928, -0.024145357310771942, 0.013921918347477913, -0.003905203426256776, -0.0030181696638464928, -0.0038018415216356516, 0.018071431666612625, -0.002553980564698577, 0.00561913289129734, 0.029121767729520798, -0.009073302149772644]",Token-level Direct Preference Optimization.pdf
" the
two summaries as the logdifference between their
11Forβ >0.5, we observe that no toxicity reduction com-
pared to the SFT model; therefore, for this experiment we only
testβ≤0.5.
12More specifically, we take the posts under
relationships and relationship_advice subreddits.
For more details regarding the datasets used refer to App. B.
0 0.25 0.5 0.75 10.30.40.50.6ODPO DPO SFT
Sampling temperatureW in rateFigure 5: Win rates of generations from models
fine-tuned with DPO and ODPO against human-written
summaries. On average, ODPO achieves a higher win
rate—significantly so in temperatures 0and0.5.
associated scores by humans.
The supervised fine-tuned model ( πSFT) is a
GPTJ-6B (Wang and Komatsuzaki, 2021) model
that is fine-tuned on human-written forum post
summaries.13We further fine-tune this model
with DPO and ODPO on DHF.14We use GPT-4
to compare the generations from the fine-tuned
models against the reference summary written by
humans, as GPT-4 judgments have been shown to
strongly correlate with human judgments (Rafailov
et al., 2023). See App. E for the prompt used for
the evaluation.
We use 100test prompts and sample from the
fine-tuned models with different temperatures. The
13Specifically, we use https://huggingface.co/
CarperAI/openai_summarize_tldr_sft
14Following Rafailov et al. (2023), we set β= 0.5for both
methods.
win rates of different methods against human writ-
ten summaries are reported in Fig. 5. We observe
that both DPO and ODPO improve upon the SFT
model. At lower temperatures, i.e., 0,0.25,0.5,
both methods are on average preferred over human-
written summaries. These results are consistent
with the results reported in (Rafailov et al., 2023).
Importantly, across all sampling temperatures,
the average win rate of ODPO is higher than DPO.
Specifically, in temperatures 0and0.5ODPO
significantly outperforms DPO. We further per-
form a head-to-head comparison between DPO and
ODPO and observe that the win rate of ODPO
over DPO is [51,50,62,48,57]at temperatures
[0,0.25,0.5,0.75,1.]respectively. For qualitative
results refer to App. F.
7 Ablation Studies
In this section, we investigate and ablate certain
design decisions that were made in the experiments.
Specifically, we investigate the effect of the offset
hyperparameter α, and the scaling function f(·)on
the performance of ODPO.
7.1 Ablating the Scaling Function
In our experiments, we scaled the reward difference
between the preferred and dispreferred responses
with a logfunction. To better understand the effect
of this scaling function, we compare it to two other
alternatives, (i) using the reward difference without
scaling, i.e., setting f(·)to the identity function,
and (ii) using the difference between logof reward
values as the offset.
We repeat the movie review generation experi-
ment, where the goal is to generate movie reviews
with a positive sentiment. For computational effi-
ciency, we choose |DHF|= 5000 . We vary βbe-
tween{0.1,0.2, . . . , 0.9} ∪ {1,2,3,4,5}and fine-
tuneπθwith the aforementioned offsets.
The results are depicted in Fig. 4. Overall,
ODPO outperforms DPO with all three choices
of the offset. However, there exist some notable
differences between the three offsets. Scaling the
offset with the logfunction makes the model not
diverge too far from πSFT, while achieving high re-
wards: While the models trained with logscaled
offset (left plot) achieve high rewards (around 0.8)
with KL of 0.4, models without logscaling reach to
0.8rewards only when the KL between πθandπSFT
is around 1(right plot). Scaling each reward value
separately lies somewhere in between (middle plot).
3 4 50.820.830.840","[0.017456911504268646, -0.006207575090229511, 0.048509929329156876, -0.01239243894815445, -0.0020212470553815365, -0.0020098916720598936, 0.01559463981539011, 0.017214665189385414, 0.007782179396599531, 0.01657876744866371, 0.0455121248960495, -0.01766887865960598, -0.06649675220251083, 0.016639329493045807, 0.041151680052280426, -0.007903303019702435, 0.04608745872974396, -0.05720053240656853, -0.03230967000126839, 0.019304044544696808, 0.0009898054413497448, -0.04741981625556946, 0.013959473930299282, 0.01915263943374157, 0.03149208799004555, 0.0002812807506415993, 0.00032622888102196157, -0.007994145154953003, 0.034611016511917114, -0.045330438762903214, 0.020908929407596588, -0.03945595398545265, -0.027207346633076668, -0.050811272114515305, -0.012808800674974918, 0.004542128182947636, 0.0075285774655640125, 0.03291528671979904, -0.009318932890892029, -0.011060081422328949, -0.0029769863467663527, -0.03053824044764042, -0.03827499970793724, 0.021378282457590103, -0.0234222412109375, 0.02116631716489792, 0.03948623314499855, -0.011612707749009132, 0.03270332142710686, 0.041303083300590515, -0.03912286460399628, 0.0628630518913269, -0.01418657973408699, -0.013270583935081959, 0.023937014862895012, 0.010386332869529724, 0.0347624197602272, 0.011552145704627037, 0.049751441925764084, -0.025011984631419182, 0.0009685141849331558, -0.018849831074476242, 0.02796436846256256, -0.010272779501974583, -0.023861313238739967, 0.013974614441394806, -0.10386332869529724, 0.019379746168851852, 0.026798555627465248, 0.0052726538851857185, 0.03361174836754799, 0.0019067474640905857, 0.06280249357223511, -0.028282318264245987, 0.020045924931764603, -0.016836155205965042, 0.04193898290395737, 0.01727522723376751, 0.008107698522508144, -0.032339952886104584, -0.0013323575258255005, 0.02155996859073639, 0.020833227783441544, -0.03455045446753502, 0.010386332869529724, -0.04327134042978287, -0.007895732298493385, -0.01779000088572502, -0.051447171717882156, -0.028342878445982933, -0.0207423847168684, 0.005147745367139578, -0.0022123949602246284, -0.002810441656038165, 0.04199954494833946, -0.03788134828209877, 0.018153371289372444, -0.020984631031751633, -0.01498902216553688, 0.0214388445019722, -0.008917711675167084, -0.02905447967350483, -0.02022761106491089, 0.009016124531626701, 0.029826641082763672, 0.03243079409003258, 0.0013105932157486677, 0.02152968756854534, -0.016503065824508667, 0.03052310086786747, -0.017229806631803513, 0.006362764164805412, -0.07709505409002304, 0.029508691281080246, -0.03258219733834267, -0.0588659793138504, -0.049721162766218185, 0.006741275079548359, -0.014020035043358803, -0.013157030567526817, -0.05399076268076897, 0.015700623393058777, 0.007134926039725542, 0.025208810344338417, -0.0002491073391865939, -0.019606852903962135, 0.014360695146024227, -0.06310530006885529, -0.02265007793903351, -0.03014458902180195, 0.02263493835926056, -0.006143228150904179, 0.028872793540358543, -0.06413485109806061, -0.03452017158269882, 0.04109111800789833, -0.04045522212982178, 0.04242347553372383, -0.00639304518699646, 0.013149460777640343, -0.02062126062810421, -0.040909431874752045, -0.02757071703672409, 0.006018319632858038, -0.0348532609641552, -0.01673017255961895, -0.00404627900570631, 0.01292235404253006, -0.018501602113246918, 0.06225743517279625, 0.023800751194357872, -0.010227357968688011, -0.021590249612927437, 0.011574856005609035, 0.012301596812903881, -0.010537737049162388, -0.01384592056274414, 0.02731332927942276, -0.0077254027128219604, -0.003985717426985502, -0.031158998608589172, 0.010757273063063622, -0.019909661263227463, -0.01821393333375454, 0.005015266593545675, 0.036367304623126984, -0.028706248849630356, -0.00924323033541441, -0.09417345374822617, -0.0334906242787838, 0.020515277981758118, 0.0025833353865891695, -0.03524691238999367, -0.024572912603616714, -0.010393902659416199, 0.00374725554138422, -0.01567034237086773, 0.004727598279714584, -0.017244946211576462, 0.0054959747940301895, -0.00445128558203578, 0.036367304623126984, -0.03336950019001961, 0.045330438762903214, -0.019364606589078903, -0.0160488523542881, 0.019606852903962135, -0.02744959481060505, 0.024739457294344902, 0.011870094574987888, 0.05250700190663338, -0.004977415315806866, 0.052022505551576614, -0.03106815554201603, -0.005673875100910664, -0.021211737766861916, 0.0763683095574379, 0.029357288032770157, -0.04581493139266968, 0.030311133712530136, 0.018698427826166153, 0.024073278531432152, 0.003304398152977228, -0.05774558708071709, -0.029554113745689392, -0.002515203319489956, -0.009084256365895271, -0.01352797169238329, -0.03391455486416817, -0.02290746569633484, 0.04938807338476181, 0.04642054811120033, 0.04433117061853409, -0.00709707522764802, -0.017578035593032837, -0.012460571713745594, -0.03912286460399628, 0.025375355035066605, 0.043301619589328766, 0.0321582667529583, -0.015549218282103539, 0.0361553393304348, 0.04218123108148575, 0.039153143763542175, -0.019031517207622528, 0.009689873084425926, 0.0375179760158062, 0.0016001538606360555, 0.004144691862165928, -0.0160639937967062, 0.05529283732175827, 0.007926013320684433, -0.026843976229429245, -0.011627848260104656, 0.013997324742376804, -0.03321809694170952, -0.004394508898258209, -0.0308107677847147, -0.03237023204565048, -0.0428474098443985, 0.011090362444519997, 0.01671503111720085, 0.021090615540742874, -0.012165333144366741, -0.009583890438079834, 0.03306669369339943, -0.02755557745695114, -0.037790507078170776, -0.004663251340389252, 0.007203057873994112, 0.02370990812778473, -0.019485728815197945, -0.01339170802384615, -0.0334603451192379, -0.03866865113377571, -0.025920411571860313, 0.009879128076136112, -0.013346286490559578, -0.018395619466900826, 0.010340911336243153, -0.03158292919397354, -0.021999040618538857, -0.008614903315901756, 0.016139695420861244, -0.02835801988840103, -0.0007887216052040458, -0.019364606589078903, 0.006041030399501324, -0.015609780326485634, -0.003151101293042302, 0.032854724675416946, 0.028887934982776642, -0.0013635846553370357, 0.037003204226493835, -0.03009916841983795, -0.018153371289372444, 0.027267908677458763, 0.06813192367553711, -0.06053142622113228, -0.0722501203417778, 0.047843750566244125, -0.01794140599668026, 0.04542127996683121, -0.03330893814563751, -0.004299881402403116, -0.0008606386254541576, -0.014519669115543365, 0.018683286383748055, 0.016896717250347137, -0.000581013853661716, 0.0060221049934625626, -0.04539100080728531, 0.06034974008798599, -0.05974412336945534, 0.0014222539030015469, 0.03118927963078022, 0.008130408823490143, -0.011794392950832844, -0.01023492868989706, 0.0032646544277668, 0.0482373982667923, -0.00011905343126272783, 0.004103055689483881, 0.016911856830120087, 0.038486965000629425, -0.009523328393697739, 0.0032570844050496817, 0.03373287245631218, -0.0065330942161381245, 0.011718690395355225, 0.0007352569955401123, 0.01016679685562849, -0.023513082414865494, 0.03691235929727554, 0.010931388475000858, 0.021105755120515823, 0.10337883234024048, -0.022150443866848946, 0.0031529939733445644, -0.039304547011852264, -0.029084760695695877, -0.06101591885089874, -0.02675313502550125, 0.04399808123707771, 0.034065961837768555, 0.02021246962249279, 0.010318201035261154, 0.0034898684825748205, -0.0004409649409353733, -0.0015802819980308414, -0.024527492001652718, -0.011832243762910366, 0.0010815942659974098, 0.004693532362580299, -0.0414847694337368, -0.006786696147173643, -0.05111408233642578, 0.06249968335032463, 0.019319184124469757, 0.04884301871061325, -0.10156198590993881, -0.03427792713046074, -0.023195134475827217, 0.014292563311755657, -0.035549722611904144, -0.0054959747940301895, -0.006820762529969215, 0.031401246786117554, 0.02934214659035206, 0.02728305011987686, -0.0006988253444433212, 0.003917585592716932, 0.01862272433936596, -0.00655580498278141, 0.04442201182246208, 0.005280223675072193, 0.018819550052285194, -0.011423451825976372, -0.03464129567146301, -0.008471068926155567, -0.003804032225161791, 0.012937494553625584, 0.01685129478573799, -0.009803426451981068, 0.04251432046294212, 0.0005076774396002293, 0.0012027176562696695, 0.00374725554138422, 0.0021007342729717493, -0.020515277981758118, -0.0187589880079031, 0.03924398496747017, -0.035428598523139954, 0.03200686350464821, -0.07703448832035065, 0.03630674257874489, 0.0414544902741909, 0.014898180030286312, -0.01779000088572502, 0.04381639510393143, -0.009886698797345161, 0.03791162744164467, -0.019213201478123665, -0.03321809694170952, -0.01659390702843666, 0.0064384667202830315, 0.013883771374821663, 0.012082060799002647, -0.04635998606681824, -0.021923338994383812, -0.01953115127980709, -0.0028123343363404274, -0.029236163944005966, 0.02823689579963684, -0.014572660438716412, 0.033551186323165894, -0.02584470808506012, 0.05956244096159935, 0.04457341507077217, 0.06843473017215729, -0.03224910795688629, -0.002000428969040513, -0.06897978484630585, 0.0033308938145637512, -0.03827499970793724, 0.012876933440566063, 0.03009916841983795, 0.031219560652971268, 0.03663983196020126, 0.01726008579134941, 0.028857653960585594, -0.06601226329803467, 0.03506522998213768, -0.0374876968562603, -0.0032173406798392534, -0.028887934982776642, 0.00924323033541441, 0.02596583217382431, 0.02383103221654892, 0.058835700154304504, -0.06195462495088577, -0.03536803647875786, -0.018895253539085388, -0.03430820629000664, -0.023376818746328354, 0.028736529871821404, 0.0046859621070325375, -0.020288171246647835, 0.04993312805891037, -0.06050114706158638, -0.014065456576645374, 0.059895530343055725, 0.02304372936487198, -0.023921875283122063, -0.05795755237340927, -0.03197658061981201, 0.009470337070524693, -0.01567034237086773, -0.017487192526459694, -0.03388427570462227, 0.011044941842556, 0.01158999651670456, -0.010870826430618763, -0.04363470897078514, -0.039698198437690735, -0.006067526061087847, 0.0334603451192379, 0.018698427826166153, 0.0027006736490875483, 0.0021650809794664383, -0.003866486484184861, -0.002079916186630726, 0.03297584876418114, -0.009084256365895271, -0.008849579840898514, -0.046269144862890244, 0.04835852235555649, -0.006975951604545116, 0.05205278843641281, -0.024285243824124336, 0.01191551610827446, -0.03134068474173546, -0.044785384088754654, -0.005912336520850658, -0.0016512528527528048, 0.031158998608589172, 0.029811499640345573, 0.032461076974868774, -0.03264275938272476, 0.005056902766227722, -0.0012102879118174314, -0.02825203724205494, -0.014337983913719654, -0.05389992147684097, -0.036094777286052704, -0.037941910326480865, 0.051992226392030716, -0.03297584876418114, -0.0007537093479186296, -0.010636149905622005, -0.001384402741678059, -0.047995153814554214, 0.027237627655267715, 0.009659592062234879, 0.03418708220124245, 0.06352923065423965, 0.05765474587678909, -0.0180776696652174, -0.03467157855629921, 0.01190794538706541, -0.015761183574795723, -0.04844936728477478, 0.04118196293711662, -0.019485728815197945, 0.0062454259023070335, -0.022392692044377327, 0.00864518340677023, 0.013210022822022438, 0.0009614170994609594, 0.004375583492219448, 0.05153801292181015, -0.010416613891720772, -0.018774129450321198, 0.03373287245631218, 0.009265941567718983, 0.018955813720822334, 0.0167453121393919, -0.021635670214891434, -0.02661687135696411, 0.011272047646343708, -0.015882307663559914, 0.00699109211564064, 0.006271922029554844, 0.03276388347148895, -0.007104645483195782, 0.024194402620196342, -0.023513082414865494, -0.00784274097532034, -0.022968027740716934, 0.007471800781786442, -0.03173433616757393, 0.0016768022906035185, -0.009152388200163841, 0.018380478024482727, 0.018516741693019867, -0.007441519759595394, -0.0107194222509861, -0.10083524137735367, -0.0468747615814209, -0.022862045094370842, 0.018395619466900826, -0.018516741693019867, 0.012263746000826359, 0.014663503505289555, -0.04006157070398331, -0.025193670764565468, 0.008546770550310612, -0.03064422309398651, -0.02929672598838806, -0.004988770466297865, 0.03894117847084999, 0.01345226913690567, 0.007195488084107637, -0.013936762697994709, 0.014292563311755657, -0.016154835000634193, 0.038244716823101044, -0.02261979691684246, -0.022044461220502853, -0.020530419424176216, 0.020409295335412025, -0.029554113745689392, -0.013088898733258247, -0.0016351661179214716, -0.0321279875934124, 0.008175830356776714, -0.015284260734915733, -0.00391001533716917, -0.00144874956458807, -0.0026949960738420486, 0.03050795942544937, 0.0034841906744986773, 0.007081934716552496, 0.011075221933424473, -0.01700269989669323, 0.02127229981124401, 0.016109414398670197, -0.005446768365800381, 0.0030659365002065897, 0.03400539979338646, -0.041515052318573, 0.00349554605782032, 0.015958009287714958, -0.04218123108148575, -0.029387569054961205, 0.0032476214691996574, 0.02265007793903351, -0.018895253539085388, 0.019879380241036415, -0.02183249592781067, -0.008539200760424137, -0.014443967491388321, -0.00672991992905736, -0.03064422309398651, -0.019304044544696808, 0.01197607722133398, 0.01915263943374157, 0.024073278531432152, -0.01993994228541851, 0.007903303019702435, 0.019334325566887856, -0.02423982322216034, 8.025608985917643e-05, -0.0153902443125844, 0.0026060459204018116, 0.02635948359966278, 0.0030583662446588278, -0.017699159681797028, 0.02343738079071045, -0.01540538389235735, 0.014898180030286312, -0.037820786237716675, -0.00559060275554657, -0.03134068474173546, -0.035822249948978424, 0.04778318852186203, -0.030038606375455856, -0.016291098669171333, 0.014633222483098507, -0.010613439604640007, 0.007873021997511387, -0.022422973066568375, -0.03757853806018829, -0.03079562820494175, -0.05047818273305893, -0.01304347813129425, 0.007274975068867207, 0.004640541039407253, 0.04393751919269562, -0.009682303294539452, -0.03197658061981201, -0.02772212214767933, 0.006385474931448698, -0.003166241804137826, 0.02099977247416973, 0.008410506881773472, -0.00319652259349823, -0.018259353935718536, -0.012157762423157692, -0.004284740891307592, -0.0347624197602272, 0.004443715326488018, -0.002520881127566099, -0.02437608689069748, 0.011862524785101414, 0.003571248147636652, 0.025617601349949837, 0.014156298711895943, -0.006835902575403452, -0.04381639510393143, 0.017214665189385414, 0.04390723630785942, 0.019758256152272224, -0.029251305386424065, 0.009985111653804779, -0.003319538664072752, 0.002634434262290597, 0.011468873359262943, -0.004103055689483881, -0.04057634249329567, -0.004386938642710447, -0.02422468364238739, -0.0017014055047184229, 0.05832092463970184, 0.023361679166555405, 0.001693835249170661, -0.006673143245279789, -0.03237023204565048, -0.01633652113378048, -0.029402708634734154, -0.03624618053436279, 0.0020477427169680595, -0.028418581932783127, -0.011332609690725803, 0.03591309115290642, 0.024588054046034813, -0.01540538389235735, 0.03415680304169655, -0.002863433212041855, -0.006695854011923075, 0.011832243762910366, 0.013921622186899185, 0.028464002534747124, 0.010613439604640007, 0.00742637924849987, 0.010522596538066864, 0.0012500315206125379, -0.05592873692512512, -0.024845439940690994, 0.06940371543169022, -0.029084760695695877, 0.0017184384632855654, -0.026707712560892105, -0.0401826910674572, -0.01085568591952324, -0.024027857929468155, 0.04251432046294212, -0.0348532609641552, 0.003088647034019232, -0.02598097175359726, -0.028176333755254745, 0.022014180198311806, -0.006453606765717268, -0.012203183956444263, -0.005624668672680855, 0.012354588136076927, 0.0024830300826579332, 0.07406696677207947, 0.0009576319716870785, -0.05329430103302002, 0.007047868799418211, -0.009871558286249638, -0.009727723896503448, -0.00534835597500205, -0.03164349123835564, -0.009674732573330402, -0.0042090388014912605, 0.05947159603238106, 0.01331600546836853, -0.054021041840314865, -0.0037377928383648396, 0.009629311040043831, -0.023588785901665688, 0.042756564915180206, -0.005424058064818382, 0.0026060459204018116, 0.015291831456124783, 0.01835019700229168, 0.004322591703385115, -0.031916018575429916, -0.010484745725989342, -0.0153902443125844, -0.007918443530797958, 0.007380958180874586, 0.007748113479465246, -0.004784374963492155, -0.0028123343363404274, -0.03064422309398651, -0.025814427062869072, 0.015496226958930492, 0.011741400696337223, -0.0043453024700284, -0.009932120330631733, -0.01698755845427513, -0.02290746569633484, 0.02516338974237442, -0.012937494553625584, -0.0011582426959648728, -0.0022653862833976746, 0.009008553810417652, 0.02728305011987686, -0.003245729021728039, -0.005548966582864523, 0.007070579566061497, 0.00169005012139678, -0.03494410589337349, 0.007206843234598637, 0.041817858815193176, 0.014368264935910702, 0.0013370889937505126, -0.020772665739059448, 0.015624920837581158, -0.01648792438209057, -0.011007090099155903, 0.027782684192061424, 0.0070365131832659245, -0.005670089740306139, 0.019743116572499275, -0.000889026967342943, 0.010772413574159145, 0.00033072370570153, 0.007850311696529388, 0.017744580283761024, 0.00588962621986866, 0.001697620376944542, 0.00040382356382906437, -0.03279416635632515, -0.0002656671858858317, 0.0023391959257423878, 0.0022616011556237936, 0.009008553810417652, -0.04311993718147278, -0.0026363269425928593, 0.025814427062869072, 0.06897978484630585, -0.02769184112548828, 0.017456911504268646, -0.003751040669158101, 0.0009661485091783106, 0.0029145320877432823, -0.031401246786117554, 0.0006448875647038221, 0.01551893725991249, -0.019258622080087662, -0.021453984081745148, -0.012596835382282734, 0.013936762697994709, -0.0013645309954881668, -0.005079613067209721, -0.03657926991581917, 0.006972166709601879, 0.017714299261569977, -0.02596583217382431, 0.007971434853971004, 0.008493779227137566, 0.0006037245038896799, -0.03118927963078022, -0.1310555338859558, -0.029357288032770157, 0.029811499640345573, -0.016124553978443146, -0.024027857929468155, -0.012347018346190453, 0.029766079038381577, 0.006548234727233648, -0.0009898054413497448, 0.009523328393697739, 0.025511618703603745, -0.03588281199336052, 0.0034974385052919388, -0.0207575261592865, -0.0080319968983531, -0.03685179725289345, -0.013800499029457569, -0.018895253539085388, -0.009447626769542694, -0.03227939084172249, -0.04875217378139496, 0.010916247963905334, 0.013876201584935188, 0.005533826071768999, -0.05459637939929962, -0.000617445504758507, 0.009515758603811264, -0.0047124577686190605, 0.014027605764567852, -0.01085568591952324, 0.005995608866214752, 0.012528703548014164, 0.019031517207622528, -0.009281082078814507, -0.02840344049036503, -0.0018670038552954793, -0.022422973066568375, 0.026041533797979355, 0.03467157855629921, 0.04172701761126518, 0.04084886983036995, -0.035156071186065674, 0.033278658986091614, 0.005541396327316761, 0.043301619589328766, -0.04354386776685715, 0.013164601288735867, -0.010999520309269428, -0.0123772993683815, -0.0009377601672895253, 0.021105755120515823, -0.01118120551109314, -0.00876630749553442, -0.0012869363417848945, 0.008251532912254333, -0.008751166984438896, 0.008387796580791473, -0.028418581932783127, 0.006385474931448698, 0.002753665205091238, -0.016412222757935524, 0.03391455486416817, 0.0068548284471035, 0.0016105629038065672, -0.03194630146026611, -0.011332609690725803, -0.009485477581620216, 0.0037037269212305546, -0.012907213531434536, -0.0442100465297699, -0.009470337070524693, 0.03037169575691223, 0.023210274055600166, 0.004462640732526779, -0.011203915812075138, -0.006832117680460215, 0.03718488663434982, -0.002931565046310425, -0.04436144977807999, 0.03079562820494175, 0.05399076268076897, -0.027131645008921623, 0.029629815369844437, 0.018562164157629013, 0.019258622080087662, 0.032461076974868774, -0.0045837643556296825, 0.0068472581915557384, -0.014557520858943462, -0.0073090409860014915, 0.04802543297410011, -0.032339952886104584, 0.0033138608559966087, -0.0038551311008632183, -0.040606625378131866, -0.013717226684093475, 0.001418468775227666, 0.025799287483096123, 0.04206010699272156, 0.019652273505926132, 0.006975951604545116, 0.005533826071768999, -0.039001740515232086, -0.012505992315709591, 0.005522470921278, 0.017623456194996834, 0.007933584041893482, -0.0027631279081106186, 0.008773877285420895, -0.027510154992341995, 0.010817835107445717, 0.005613313056528568, -0.007804890163242817, 0.014390976168215275, -0.032067425549030304, 0.013573392294347286, 0.04542127996683121, 0.014565090648829937, 0.03291528671979904, -0.0050947535783052444, -0.0002867218281608075, 0.020545559003949165, -0.011415882036089897, 0.04327134042978287, 0.0072560496628284454, 0.03400539979338646, -0.021363142877817154, -0.004610260017216206, -0.035670846700668335, 0.04315021634101868, -0.003944081254303455, 0.010038102976977825, 0.018274495378136635, 0.014633222483098507, -0.001276527182199061, 0.01580660603940487, 0.05502030998468399, -0.013891342096030712, 0.02743445336818695, 0.04563324525952339, -0.00956874992698431, 0.02168109081685543, 0.011332609690725803, 0.0003444447065703571, -0.01324787363409996, 0.018107950687408447, 0.0036374875344336033, -0.04299881309270859, -0.0028445078060030937, 0.023740189149975777, -0.012551413848996162, -0.018395619466900826, -0.014012465253472328, 0.008993413299322128, 0.039970725774765015, 0.015897449105978012, -0.009265941567718983, -0.025950690731406212, 0.021590249612927437, 0.003728330135345459, 0.03161321207880974, 0.024466929957270622, 0.015465945936739445, -0.03026571311056614, 0.035670846700668335, -0.03143152594566345, -0.03536803647875786, -0.010795124806463718, -0.0019417597213760018, -0.0039365109987556934, -0.004504276905208826, -0.019879380241036415, 0.01969769597053528, -0.004595119506120682, 0.04408892244100571, 0.011991217732429504, -0.0034349842462688684, 0.039819322526454926, -0.03857780620455742, 0.022695500403642654, 0.02705594338476658, 0.010590728372335434, -0.008743596263229847, -0.015011733397841454, 0.054687220603227615, -0.0234222412109375, 0.0022540311329066753, 0.0267682746052742, -0.016109414398670197, 0.033551186323165894, -0.016548486426472664, 0.027812963351607323, 0.010545307770371437, 0.03530747443437576, -0.011378031224012375, 0.01565520092844963, 0.009326502680778503, 0.04269600287079811, -0.028464002534747124, -0.057624462991952896, 0.002562517300248146, 0.037669382989406586, -0.001778053934685886, -0.007267404813319445, -0.007986575365066528, 0.038729213178157806, -0.01928890310227871, -0.0039630066603422165, -0.0006770609761588275, 0.01218804344534874, 0.0036772312596440315, 0.039274267852306366, -0.007305256091058254, 0.007774609141051769, -0.008410506881773472, -0.04914582520723343, -0.00565873458981514, 0.019879380241036415, -0.031158998608589172, -0.020273031666874886, -0.021590249612927437, -0.039001740515232086, 0.028176333755254745, 0.019788537174463272, -0.019167780876159668, -0.006408185698091984, 0.045179035514593124, 0.0033782077953219414, 0.0261172354221344, 0.01366423536092043, -0.02623835951089859, 0.009667162783443928, -0.016518205404281616, 0.012369728647172451, 0.014814907684922218, -0.012884503230452538, -0.015004162676632404, 0.0005606689373962581, 0.017032980918884277, -0.01809280924499035, 0.029690377414226532, 0.014527239836752415, -0.014095737598836422, -0.03333922103047371, 0.016139695420861244, 0.01339170802384615, 0.009152388200163841, 0.04345302656292915, -0.015836887061595917, -0.0014761915663257241, -0.009682303294539452, 0.001540538389235735, 0.013429558835923672, -0.0022275352384895086, -0.007547502871602774, 0.0009666216210462153, 0.004477781243622303, 0.04766206443309784, 0.049751441925764084, 0.020182188600301743, -0.026420045644044876, 0.020424434915184975, 0.012021498754620552, -0.025738725438714027, 0.003544752486050129, -0.019349465146660805, -0.015852026641368866, -0.0023032373283058405, 0.018698427826166153, -0.0026703928597271442, -0.009515758603811264, 0.03243079409003258, 0.003529611974954605, 0.043695271015167236, -0.002553054364398122, 0.0024603193160146475, 0.01460294146090746, -0.009788285940885544, 0.033793434500694275, -0.00451941741630435, 0.0028823588509112597, -0.00837265606969595, 0.005673875100910664, -0.009114537388086319, 0.009281082078814507, -0.04227207228541374, -0.028146052733063698, -0.000506731157656759, 0.016669610515236855, 0.039546795189380646, 0.014232001267373562, 0.0348229818046093, -0.015314541757106781, -0.00555275147780776, 0.0030981097370386124, 0.005128819495439529, 0.008213681168854237, 0.0001924490206874907, -0.005454338621348143, -0.038608089089393616, 0.008993413299322128, -0.0019436522852629423, 0.04254459962248802, -0.01582174561917782, 0.02420954219996929, 0.008993413299322128, 0.01657876744866371, -0.022725781425833702, -0.00705922394990921, -0.007362032774835825, -0.009387064725160599, -0.02127229981124401, 0.017699159681797028, 0.04911554604768753, -0.02060612104833126, -0.006938100792467594, 0.006646647583693266, -0.023785609751939774, 0.0030129449442029, 0.02517852932214737, 0.013414418324828148, -0.018577303737401962, 0.017184384167194366, 0.039940446615219116, -0.020651541650295258, -0.03364202752709389, 0.03361174836754799, -0.018047388643026352, -0.020318452268838882, 0.023346537724137306, 0.00349554605782032, 0.02354336343705654, 0.03164349123835564, -0.020439576357603073, -0.04675363749265671, -0.002299452433362603, -0.03309697285294533, 0.0050606876611709595, -0.012157762423157692, -0.01426228228956461, 0.02702566236257553, 0.01939488761126995, -0.011499154381453991, -0.007252264302223921, 0.006480102892965078, 0.023346537724137306, 0.0039970725774765015, 0.030568521469831467, -0.0173963513225317, -0.0031794896349310875, 0.091024249792099, -0.027616139501333237, 0.0009869665373116732, 0.006400615442544222, -0.013944333419203758, 0.006241641007363796, -0.00766862602904439, -0.010772413574159145, -0.027146784588694572, 0.03276388347148895, -0.003620454575866461, 0.036609552800655365, -0.017244946211576462, -0.0003295408678241074, 0.023134572431445122, 0.0053067198023200035, -0.011166064999997616, 0.020833227783441544, 0.021060334518551826, 0.003552322741597891, 0.01492846105247736, 0.009356783702969551, -0.004882787819951773, 0.0010721314465627074, 0.026813695207238197, 0.018501602113246918, -0.019076937809586525, 0.007274975068867207, 0.025663023814558983, 0.02813091315329075, -0.005518685560673475, -0.05129576474428177, -0.03585252910852432, 0.012331877835094929, -0.012808800674974918, -0.014572660438716412, -0.011756541207432747, 0.04660223424434662, -0.030613943934440613, -0.007521007210016251, -0.03697292134165764, -0.019606852903962135, 0.014777056872844696, -0.0035352897830307484, 0.006203789729624987, 0.024436648935079575, -0.00032599232508800924, 0.006010749377310276, 0.014936030842363834, 0.0008710476686246693, 0.024436648935079575, -0.004125766456127167, 0.013762648217380047, -0.010083524510264397, 0.014830048196017742, -0.009197809733450413, 0.000772161758504808, 0.012763380073010921, 0.02637462317943573, 0.023391960188746452, -0.016503065824508667, 0.0010787553619593382, -0.04990284517407417, 0.019349465146660805, 0.003469050396233797, -0.05396047979593277, -0.0065671601332724094, 0.010530167259275913, -0.003701834473758936, 0.012468141503632069, -0.03128012269735336, -0.01594286970794201, 0.007237124256789684, -0.023513082414865494, 0.029750939458608627, -0.005170455668121576, -0.013005626387894154, 0.03376315161585808, 0.017729440703988075, 0.016245678067207336, -0.013618813827633858, -0.017623456194996834, -0.008879859931766987, -0.010348482057452202, -0.018804410472512245, -0.0028804661706089973, -0.002553054364398122, 0.004053849261254072, -0.021348001435399055, 0.02152968756854534, -0.01577632501721382, 0.020182188600301743, 0.04039466008543968, 0.01183981355279684, -0.024042997509241104, -0.008251532912254333, -0.002324055414646864, 0.008486209437251091, 0.005617098417133093, 0.024860581383109093, -0.00829695351421833, -0.014300133101642132, -0.004322591703385115, 0.012528703548014164, 0.0017638597637414932, -0.016154835000634193, -0.027934087440371513, -0.014406115747988224, 0.016260817646980286, 0.0017884629778563976, 0.009561179205775261, -0.01551893725991249, 0.03442933037877083, 0.013792929239571095, -0.012831511907279491, 0.030220292508602142, -0.0016909964615479112, 0.06322642415761948, 6.097570440033451e-05, 0.0037756438832730055, -0.0031719193793833256, 0.0028199045918881893, 0.01928890310227871, -0.001958792796358466, 0.003052688669413328, 0.029690377414226532, -0.0023884023539721966, -0.00040335042285732925, -0.05277952924370766, 0.0018452395452186465, 0.01953115127980709, 0.004663251340389252, 0.012808800674974918, -0.016654469072818756, -0.0075285774655640125, 0.028812231495976448, 0.011264477856457233, -0.02785838581621647, -0.024678895249962807, -0.0012982916086912155, -0.017063261941075325, 0.004038708750158548, 0.0010011607082560658, -0.027086224406957626, 0.0008559072739444673, -0.02782810479402542, -0.002821797039359808, -0.02180221490561962, 0.014557520858943462, 0.028706248849630356, -0.0010674000950530171, -0.009470337070524693, 0.022059602662920952, 0.022150443866848946, -0.001958792796358466, -0.007857881486415863, -0.0014847081620246172, -0.05462665855884552, -0.01345983985811472, 0.017199525609612465, 0.022014180198311806, -0.0010787553619593382, -0.011998788453638554, 0.019304044544696808, 0.02193847857415676, -0.01580660603940487, -0.029826641082763672, -0.010522596538066864, 0.022165585309267044, 0.011044941842556, 0.008554341271519661, -0.01698755845427513, -0.011612707749009132, -0.010878397151827812, -0.034217365086078644, -0.00896313227713108, -0.013429558835923672, 0.00609402172267437, -0.03869893029332161, 0.0003068302175961435, 0.006544449366629124, 0.0026476820930838585, 0.007293900474905968, 0.012801230885088444, -0.007676196284592152, 0.012082060799002647, 0.031128717586398125, 0.01311160996556282, -0.003866486484184861, 0.012248605489730835, -0.004943349398672581, -0.01848646067082882, -0.022937746718525887, 0.007873021997511387, 0.018970955163240433, 0.056140702217817307, 0.010128945112228394, 0.0015140427276492119, -0.0064990282990038395, 6.056170605006628e-05, -0.03894117847084999, -0.029644954949617386, -0.007702691946178675, -0.0010853793937712908, -0.02316485345363617, -0.00816826056689024, -0.014769486151635647, -0.02716192603111267, 0.021090615540742874, 0.020681822672486305, 0.038638368248939514, -0.010250069200992584, -0.001184738357551396, 0.030765347182750702, 0.029145320877432823, -0.01792626455426216, 0.005310504697263241, 0.015223699621856213, -0.03442933037877083, -0.0018840368138626218, 0.0010920033091679215, -0.010492315515875816, 0.026965100318193436, -0.020515277981758118, -0.02089378982782364, -0.00984884798526764, 0.03370258957147598, 0.012316737323999405, 0.01062858011573553, 0.020394155755639076, 0.027267908677458763, -0.027510154992341995, -0.026344342157244682, -0.002180221490561962, -0.020288171246647835, -0.004837366286665201, 0.013550681993365288, -0.01874384842813015, -0.005545181222259998, 0.019061798229813576, -0.041303083300590515, -0.011196346022188663, -0.03276388347148895, -0.01311160996556282, -0.050780992954969406, 0.051053520292043686, 0.0030583662446588278, 0.0294329896569252, -0.013255443423986435, 0.011491583660244942, 0.011718690395355225, 0.0025606246199458838, -0.018001968041062355, -0.03670039400458336, 0.0007035566959530115, -0.018986094743013382, 0.001319109695032239, -0.030417118221521378, -0.018047388643026352, 0.015973150730133057, -0.016942137852311134, -0.008607332594692707, -0.010477175004780293, -0.028176333755254745, 0.016109414398670197, -0.0004608367453329265, -0.014481818303465843, -0.030568521469831467, -0.03318781405687332, 0.006366549525409937, -0.012475711293518543, 0.018516741693019867, -0.0025644097477197647, -0.007452874910086393, 0.006979736965149641, -0.0036261321511119604, 0.04321077838540077, -0.004897927865386009, -0.0050531174056231976, -0.031098436564207077, 0.022725781425833702, -0.019909661263227463, -0.032461076974868774, -0.017729440703988075, 0.00415226211771369, 0.02274092100560665, 0.03158292919397354, -0.004072774667292833, -0.028146052733063698, 0.00586313009262085, -0.027131645008921623, -0.0022918821778148413, 0.01279366109520197, -0.015428095124661922, -0.009440056048333645, 0.02838830091059208, 0.021469125524163246, 0.001789409201592207, -0.02249867469072342, 0.006589870899915695, 0.009182669222354889, 0.023513082414865494, 0.0140578867867589, 0.017048120498657227, 0.00038371520349755883, 0.02770698070526123, -0.004629185423254967, 0.021620528772473335, -0.023074010387063026, 0.017714299261569977, 0.016775593161582947, 0.011877665296196938, -0.020908929407596588, 0.041151680052280426, 0.007013802882283926, 0.0562315471470356, -0.008705745451152325, 0.03137096390128136, -0.03455045446753502, -0.00043505069334059954, -0.026329202577471733, -0.011998788453638554, 0.01345226913690567, 0.010711852461099625, 0.02744959481060505, 0.021726513281464577, -0.023134572431445122, 0.020045924931764603, -0.025087688118219376, -0.05741249769926071, 0.029902342706918716, 0.008728455752134323, 0.026980239897966385, 0.0227712020277977, 0.007320396602153778, -0.007157636806368828, -0.01580660603940487, 0.015140427276492119, 0.0040311384946107864, -0.024603193625807762, -0.024148980155587196, 0.002329733222723007, 0.0041825431399047375, -0.001869842759333551, -0.011476443149149418, 0.013437128625810146, 0.008872290141880512, -0.00535971112549305, -0.02772212214767933, -0.012316737323999405, 0.02920588292181492, 0.030962172895669937, -0.0042431047186255455, -0.003682908834889531, 0.008804158307611942, 0.01831991598010063, -0.005617098417133093, -0.01486032921820879, -0.017774861305952072, -0.013808069750666618, -0.0009122107294388115, -0.033399783074855804, 0.021650809794664383, 0.03561028465628624, -2.001966640818864e-05, 0.013202452100813389, -0.0013825101777911186, -0.030856190249323845, 0.01124933734536171, -0.01365666463971138, 0.006782911252230406, 0.0375179760158062, 0.016518205404281616, -0.01915263943374157, -0.01644250378012657, -0.009076685644686222, -0.02437608689069748, -0.0028388299979269505, 0.028342878445982933, 0.002335410797968507, 0.018501602113246918, 0.007880591787397861, -0.021650809794664383, -0.01968255452811718, 0.011801962740719318, -0.015034443698823452, -0.006938100792467594, 0.04763178154826164, -0.009424915537238121]",Token-level Direct Preference Optimization.pdf
".850.860.870.880.89
0.20.40.60.81αFigure 6: Ablating alpha values for movie review gener-
ation. The offset is set to ∆r=αlog 
r(yw)−r(yl)
.
The highest rewards are associated with models trained
withα= 1, while smaller αleads to lower DKL.
7.2 Ablating the Offset Hyperparameter
In the previous experiment, we set α= 1. To
understand the effect of enforcing an offset in the
loss function we experiment with different values
ofα. Repeating the movie review experiment, we
varyα∈ {0.0,0.1,0.2,0.3,0.5,0.8,1.0}and set
the offset to ∆r=αlog 
r(yw)−r(yl)
. Note
that when α= 0 ODPO loss is exactly equal to
DPO loss. After fine-tuning πθon a dataset of size
7500 with the ODPO loss Eq. (7c) (with β= 0.5),
we sample from the models two times with two dif-
ferent random seeds and report the results in Fig. 6.
We observe that higher values of αcan lead to
higher reward values at the expense of diverging
from the SFT model. Lower values of αon average
lead to lower reward values. On the Pareto front
of the Fig. 6, points with the highest rewards are
associated with models trained with α= 1, while
points with lower DKLare fine-tuned with smaller
αvalues.
8 Related Work
In this section, we review alternative methods to
RLHF for aligning language models to human pref-
erences.
Sequence-Level Contrastive Methods. The in-
tuition that is shared by these methods is simple:
they encourage the language model πθto assign
more probability mass to the preferred response
compared to the dispreferred response(s). Zhao
et al. ( SLIC;2023) employ a rank calibration loss
that requires logπθ(yw|x)to be greater than
logπθ(yl|x), by an offset δ. Importantly, in their
formulation δis a hyperparameter and does not de-
pend on the the responses yw,yl. Similarly, Yuan
et al. ( RRHF ;2023) uses a ranking loss without
the offset. While intuitive, the objective that con-
trastive losses are optimizing for, and its connection
to the RLHF objective (maximizing the expected
reward) is unclear.
DPO and Variants. DPO proposes an alterna-
tive method to optimize the regularized expected
rewards without using RL algorithms. Importantly,
DPO shares the objective with conventional meth-
ods for RLHF (Stiennon et al., 2020), but the op-
timization is done without training a separate re-
ward model nor using RL algorithms. Since the
introduction of DPO, several follow-up studies at-
tempted to improve DPO along different dimen-
sions. To prevent DPO from overfitting to the pref-
erence dataset, Azar et al. (2023) introduce Iden-
tity Preference Optimization (IPO). IPO replaces
the unbounded function of preference probabilities
in DPO loss formulation with the bounded iden-
tity function. Ethayarajh et al. (2023) propose a
method called Kahneman-Tversky Optimisation
(KTO) that dispenses the need for paired prefer-
ence data altogether. KTO’s loss function relies on
unpaired examples that are labeled either as “good”
or “bad”. Zhou et al. (2024) suggest another variant
of DPO specifically for multi-objective alignment.
Our Approach. ODPO attempts to solve another
shortcoming of DPO, which is to treat every pref-
erence pair equally and not take into account the
extent to which the two responses differ from each
other. ODPO’s loss requires the estimated reward
for the preferred response to be larger than the dis-
preferred response by an offset that depends on the
difference between the quality of the responses.
9 Conclusion
We propose ODPO, a generalization of DPO for
aligning language models with human preferences.
Just as with DPO, ODPO does not rely on a pre-
trained reward model and does not require an RL
algorithm. However, in contrast to DPO, ODPO
does not treat every preference pair equally and in-
corporates the extent to which one response should
be preferred over another","[-0.008070962503552437, 0.012337642721831799, 0.04587557539343834, 0.010032654739916325, 0.027239497750997543, 0.021914904937148094, 0.0012567091034725308, 0.032928407192230225, -0.023063896223902702, 0.022279219701886177, 0.029369335621595383, -0.03163929283618927, -0.012561836279928684, 0.0026132543571293354, 0.02942538447678089, -0.03329272195696831, 0.05543182045221329, -0.03968223184347153, 0.014642631635069847, 0.0396542064845562, -0.04382980987429619, -0.03205965831875801, -0.02205502614378929, 0.032900381833314896, 0.008694500662386417, -0.01294716913253069, 0.0369919128715992, 0.017837388440966606, 0.024815406650304794, -0.06221367046236992, 0.04845380038022995, -0.03306852653622627, -0.023932645097374916, -0.01828577369451523, 0.02403073012828827, 0.014404426328837872, 0.015357248485088348, 0.050835855305194855, 0.004077517427504063, 0.02583828940987587, -0.004431322682648897, -0.03805683180689812, -0.017543133348226547, -0.005815016571432352, -0.029257239773869514, 0.05304976552724838, 0.07566527277231216, -0.003205265151336789, 0.01450251042842865, 0.00818305928260088, -0.040382836014032364, 0.060364075005054474, -0.03637538105249405, 0.0007128649740479887, 0.02222317084670067, 0.0005407790304161608, 0.04371771216392517, -0.004722073674201965, 0.04654815420508385, -0.008603421971201897, -0.01867811195552349, -0.036123160272836685, 0.02772992104291916, 0.0009703370742499828, -0.015329224057495594, 0.007874793373048306, -0.11220879852771759, 0.011503923684358597, 0.017977507784962654, 0.008386234752833843, 0.029369335621595383, 0.008330185897648335, 0.053526174277067184, -0.022769642993807793, -0.008014914579689503, -0.017781339585781097, 0.01888829469680786, 0.061372943222522736, 0.024941515177488327, -0.009962594136595726, -0.011104579083621502, 0.0335729606449604, 0.012295606546103954, -0.045623358339071274, 0.007629581727087498, -0.036739692091941833, -0.05644068866968155, -0.028780827298760414, -0.04727678373456001, 0.003518785582855344, 0.01287710852921009, -0.025431938469409943, -0.012372673489153385, -0.014628619886934757, 0.018061580136418343, -0.02903304621577263, 0.0010684216395020485, 0.007188200950622559, 0.040298763662576675, 0.02394665777683258, -0.0343296155333519, -0.03892558068037033, -0.006396518088877201, -0.002509915269911289, 0.04127961024641991, 0.0034136949107050896, -0.007566527463495731, 0.018005533143877983, 0.02711338922381401, 0.024899479001760483, -0.04066307842731476, 0.013885978609323502, -0.06748221069574356, 0.020107345655560493, -0.0035170339979231358, -0.0715176984667778, -0.06596890836954117, 0.02178879640996456, -0.01822972670197487, -0.0034960159100592136, -0.0468844436109066, -0.023554319515824318, 0.0232040174305439, 0.008330185897648335, 0.000603833410423249, -0.008246113546192646, 0.01905643939971924, -0.06070036441087723, -0.028696754947304726, -0.015651501715183258, 0.0031579742208123207, 0.03802880644798279, -0.01188225019723177, -0.043493520468473434, -0.06624914705753326, 0.04164392501115799, -0.015343235805630684, -6.174076406750828e-05, -0.005776483099907637, -0.021116215735673904, -0.019630935043096542, -0.07504874467849731, -0.045118920505046844, -0.0006222242373041809, -0.05475923791527748, -0.02602044679224491, 0.015133054926991463, -0.02897699736058712, -0.02847256138920784, 0.06518422812223434, 0.008484318852424622, -0.023021860048174858, -0.026244640350341797, 0.030406229197978973, -0.02397468127310276, -0.020906034857034683, -0.0008805721299722791, 0.02948143146932125, -0.0017769078258424997, -0.02134040929377079, 0.0001391356490785256, 0.029929818585515022, 0.003601106582209468, 0.005282557103782892, 0.02737961895763874, 0.014243287034332752, -0.02403073012828827, -0.009542231447994709, -0.05730943754315376, -0.022839702665805817, -0.010193794034421444, 0.004750097636133432, -0.06344673037528992, -0.02136843279004097, -0.003849821165204048, 0.014642631635069847, 0.0015404538717120886, 0.009836485609412193, -0.002303236862644553, -0.03833707049489021, 0.013928014785051346, 0.010158763267099857, -0.008547373116016388, 0.014047117903828621, 0.002147352322936058, 0.006939486600458622, -0.016464203596115112, -0.029313286766409874, 0.008785579353570938, 0.04478263109922409, 0.052377182990312576, 0.042344529181718826, 0.059803590178489685, -0.024703310802578926, -0.013094295747578144, -0.025445951148867607, 0.07437615841627121, 0.049238476902246475, -0.04601569473743439, -0.016996663063764572, 0.029621552675962448, 0.02285371534526348, -0.010600144043564796, -0.07034067809581757, -0.023358149453997612, 0.01385094877332449, -0.013262441381812096, 0.00919192936271429, -0.040859248489141464, -0.027449680492281914, 0.019196560606360435, 0.027267523109912872, 0.05523565039038658, 0.02906106971204281, -0.0016840777825564146, -0.03892558068037033, -0.031359050422906876, 0.032928407192230225, 0.011265718378126621, 0.012001353316009045, 0.005429683718830347, 0.020878011360764503, 0.003723712172359228, 0.032928407192230225, -0.04329735040664673, -0.027828006073832512, 0.02583828940987587, -0.02311994507908821, 0.03281630948185921, -0.02666500210762024, 0.04259674623608589, 0.01528718788176775, -0.01134979072958231, -0.001483529806137085, 0.014173226431012154, -0.03727215155959129, -0.004736085422337055, -0.03584292158484459, 0.008246113546192646, -0.041335657238960266, -0.014726703986525536, 0.02903304621577263, 0.017627205699682236, -0.02604847028851509, -0.0034119433257728815, 0.032928407192230225, -0.045034848153591156, -0.016674384474754333, -0.018958354368805885, -0.030266109853982925, 0.02477337047457695, -0.010558107867836952, -0.007944853976368904, -0.043017107993364334, -0.0442221499979496, -0.015721561387181282, 0.010579125955700874, -0.00621436070650816, -0.028640707954764366, 0.027253510430455208, -0.011419851332902908, -0.01062816847115755, 0.02405875362455845, 0.03968223184347153, -0.005187975242733955, -0.00971037708222866, -0.030378205701708794, -0.0037902696058154106, -0.014250293374061584, 0.009640316478908062, 0.017122771590948105, -0.0073283216916024685, -0.015189102850854397, 0.036039087921381, -0.027743933722376823, -0.033376794308423996, 0.03326469659805298, 0.030658448114991188, -0.025263793766498566, -0.039261870086193085, 0.003079156158491969, -0.010158763267099857, 0.053918514400720596, -0.010081697255373001, 0.02447911724448204, -0.008435276336967945, -0.021508553996682167, -0.020667828619480133, -0.03278828412294388, -0.0028584657702594995, -0.014866825193166733, -0.0565808080136776, 0.04752900078892708, -0.06221367046236992, 0.0064315483905375, 0.014390413649380207, 0.020793937146663666, -0.057673752307891846, 0.029901795089244843, 0.028080223128199577, 0.062381815165281296, 0.020555732771754265, 0.019518837332725525, 0.002077291952446103, 0.010046666488051414, -0.0261045191437006, 0.009079832583665848, 0.024549176916480064, -0.005363126751035452, -0.003681675996631384, 0.01413119025528431, 0.013780888170003891, -0.01503496989607811, 0.022251194342970848, -0.00874354224652052, -0.007762696593999863, 0.06546447426080704, 0.009584267623722553, -0.003937396686524153, -0.02107417955994606, -0.04495077580213547, -0.04702456668019295, -0.018818233162164688, -0.010410981252789497, 0.026594942435622215, -0.01277201808989048, 0.009871515445411205, -0.011763148009777069, -0.03222780302166939, -0.013136331923305988, -0.005152945406734943, -0.005506750661879778, 0.0139560392126441, 0.013395555317401886, -0.017389001324772835, -0.008232101798057556, -0.05383444204926491, 0.05845842882990837, 0.04814553260803223, 0.004925248678773642, -0.06731406599283218, -0.009128875099122524, -0.011048531159758568, -0.001207666820846498, -0.042344529181718826, 0.001136730657890439, 0.0012961181346327066, 0.016001803800463676, 0.005825525615364313, 0.04993908107280731, -0.030125988647341728, -0.013682803139090538, 0.017501097172498703, 0.03219977766275406, 0.01846793107688427, 0.03435763716697693, 0.003182495478540659, -0.03469393029808998, -0.029229214414954185, -0.007671617902815342, -0.019196560606360435, 0.013360525481402874, -0.014978921972215176, 0.012141473591327667, 0.016954626888036728, -0.03410542011260986, 0.0015281933592632413, -0.0042071291245520115, -0.0017164807068184018, -0.040831223130226135, 0.008764561265707016, 0.040298763662576675, -0.052489280700683594, 0.037160057574510574, -0.06098060682415962, 0.03634735569357872, 0.031415101140737534, 0.004448837600648403, -0.0027183450292795897, 0.02450714074075222, 0.007531497161835432, 0.006799365393817425, -0.03169534355401993, -0.027099376544356346, -0.008042938075959682, 0.02341419830918312, -0.023456234484910965, -0.01796349696815014, -0.06378301978111267, -0.0032087680883705616, 0.01681450568139553, 0.019252607598900795, -0.021060166880488396, 0.04702456668019295, -0.049210451543331146, 0.00871551875025034, -0.04214835911989212, 0.06070036441087723, 0.054450973868370056, 0.05918705835938454, -0.04957476630806923, 0.004431322682648897, -0.052909642457962036, 0.005927112884819508, -0.041924167424440384, -0.022125085815787315, -0.0012313121696934104, 0.04111146554350853, 0.010039661079645157, 0.035534653812646866, 0.05257335305213928, -0.035058245062828064, 0.033040501177310944, -0.02658092975616455, 0.02823435701429844, -0.013731845654547215, 0.013465615920722485, -0.006519123911857605, 0.039289895445108414, 0.0420362614095211, 0.02767387218773365, -0.026174578815698624, -0.012057401239871979, -0.04674432426691055, -0.023778513073921204, 0.05700117349624634, -0.0030020896811038256, 0.007149667479097843, 0.02059776894748211, -0.07667414098978043, -0.02216712199151516, 0.056160446256399155, 0.05857052654027939, -0.04514694586396217, -0.07112535834312439, 0.014390413649380207, -0.01170709915459156, -0.0024328487925231457, -0.0031229439191520214, -0.010530083440244198, 0.02942538447678089, 0.018509967252612114, -0.03539453446865082, -0.033404815942049026, -0.033937275409698486, 0.02450714074075222, 0.024226900190114975, 0.017290916293859482, -0.006848407909274101, -0.0036886821035295725, -0.020415611565113068, 0.03497416898608208, 0.045090898871421814, 0.00382529990747571, 0.02258748561143875, -0.061428993940353394, 0.06120479851961136, -0.008953724056482315, 0.013921009376645088, -0.0003735097125172615, -0.002988077700138092, -0.03233989700675011, -3.300503522041254e-05, -0.009030790068209171, 0.02213909849524498, 0.02447911724448204, 0.005237017758190632, 0.002425842685624957, -0.07572132349014282, 0.005293066147714853, -0.021494543179869652, -0.01745906099677086, 0.025768229737877846, -0.025852302089333534, -0.03690784052014351, -4.8385489208158106e-05, 0.038673363626003265, -0.03514231741428375, 0.002035255776718259, -0.005366629455238581, 0.00660669943317771, -0.025375891476869583, 0.015062994323670864, -0.027561776340007782, 0.05380641669034958, 0.03466590493917465, 0.041447754949331284, -0.009409116581082344, -0.027183450758457184, 0.007601557299494743, 0.011545959860086441, -0.04113949090242386, 0.044558439403772354, -0.01681450568139553, -0.0176412183791399, -0.0073283216916024685, 0.03256409242749214, 0.023512283340096474, 0.017571158707141876, -0.02033153921365738, 0.06221367046236992, -0.01731893979012966, -0.008218089118599892, 0.03738424926996231, 0.009731395170092583, 0.015917731449007988, 0.014628619886934757, -0.038281023502349854, -0.03379715606570244, 0.015959767624735832, -0.017150795087218285, -0.0032805800437927246, -0.01852397993206978, 0.016057852655649185, -0.0130522595718503, 0.031443122774362564, -0.05806609243154526, -0.026650991290807724, -0.019084462895989418, 0.016268033534288406, -0.016506239771842957, -0.008470307104289532, -0.026777099817991257, 0.016408154740929604, 0.014026099815964699, 0.02246137708425522, -0.0526854507625103, -0.09102252125740051, -0.027043329551815987, -0.0012295607011765242, 0.027043329551815987, -0.004329734947532415, 0.024142827838659286, 0.03418949246406555, -0.018818233162164688, -0.028220344334840775, -0.00014187238411977887, -0.02770189754664898, -0.02554403617978096, -0.01793547160923481, 0.02906106971204281, -0.00585354957729578, 0.009969600476324558, 0.0198271032422781, 0.013220404274761677, -0.00891168788075447, 0.015987791121006012, -0.008014914579689503, 0.00952821969985962, 0.021410468965768814, 0.00435775937512517, -0.020023273304104805, -0.052489280700683594, -0.03900965303182602, -0.04220440611243248, 0.006928977556526661, 0.004287698771804571, -0.002567715011537075, 0.035086266696453094, -0.009682352654635906, -0.004935757722705603, -0.014908861368894577, -0.04200823977589607, 0.04542718827724457, -0.005422677844762802, 0.026440808549523354, 0.023512283340096474, -0.011237693950533867, 0.009892533533275127, 0.023246053606271744, -0.053442101925611496, -0.011931292712688446, 0.033488888293504715, -0.04486670345067978, 0.005208993796259165, 0.01915452443063259, 0.01902841590344906, -0.012498782016336918, 0.04284896329045296, -0.011195657774806023, -0.013311482965946198, -0.009240971878170967, -0.0009738400694914162, -0.02519373409450054, -0.05901891365647316, 0.008722524158656597, 0.016183961182832718, 0.0198271032422781, -0.04055098071694374, 0.03278828412294388, 0.0268191359937191, -0.031246954575181007, 0.018818233162164688, -0.01475472841411829, -0.028752803802490234, 0.02314796857535839, 0.02368042804300785, 0.0056293560191988945, 0.04164392501115799, -0.012912138365209103, 0.018608052283525467, -0.017290916293859482, -0.008778573013842106, -0.04223243147134781, -0.009030790068209171, 0.018860269337892532, -0.008799591101706028, -0.0198271032422781, 0.020976094529032707, -0.013991069048643112, 0.012267583049833775, -0.002105316147208214, 0.00865946989506483, -0.023834561929106712, -0.04273686558008194, -0.020135369151830673, -0.02746369130909443, 0.00035730822128243744, 0.04464251175522804, -0.02897699736058712, -0.010277866385877132, -0.013486634008586407, 0.015651501715183258, -0.006224869750440121, 0.011356797069311142, -0.010186787694692612, -0.019644947722554207, -0.011595002375543118, -0.0005972652579657733, -0.0183558352291584, -0.04217638447880745, -0.01639414206147194, 0.002303236862644553, 0.00015993484703358263, 0.02652488276362419, 0.029257239773869514, 0.005706422496587038, -0.007335328031331301, 0.029789697378873825, -0.04834170266985893, -0.004837673157453537, 0.023428210988640785, 0.01612791232764721, -0.0007575284689664841, 0.04472658410668373, -0.016940614208579063, 0.007846768945455551, 0.011363803409039974, -0.006634723395109177, -0.029341312125325203, -0.01240069791674614, 0.0009948582155629992, 0.012982198968529701, 0.01825775019824505, 0.027225486934185028, 0.014796764589846134, 0.0010307641932740808, 0.01358471903949976, 0.006088252179324627, -0.009878521785140038, -0.04520299285650253, -0.018958354368805885, 0.000260975124547258, 0.005037345457822084, 0.03205965831875801, 0.0326201394200325, 0.010544096119701862, 0.051284242421388626, 0.0002259449101984501, -0.021298373118042946, -0.01953285001218319, 0.019616922363638878, 0.05624451860785484, 0.008610427379608154, -0.026987280696630478, -0.01843990758061409, 5.615781992673874e-05, -0.011489911936223507, -0.0352824367582798, 0.0076155695132911205, -0.017767326906323433, 0.007839762605726719, -0.026006434112787247, -0.034946147352457047, -0.0006068985676392913, -0.01081733126193285, 0.04063505306839943, -0.01843990758061409, -0.0005736198509112, 0.00290400511585176, -0.008946717716753483, -0.007286285515874624, -0.0006765211001038551, -0.03410542011260986, 0.02379252389073372, 0.03589896857738495, 0.017066722735762596, 0.06731406599283218, -0.016197973862290382, -0.03589896857738495, 0.006273912265896797, 0.0027306056581437588, -0.031387075781822205, 0.016954626888036728, -0.0420362614095211, -0.027982138097286224, -0.003510027891024947, 0.05167657881975174, 0.031863488256931305, -0.008694500662386417, -0.0009589522378519177, -0.013255435042083263, -0.02142448164522648, 0.033404815942049026, 0.00574845913797617, 0.031443122774362564, 0.01918254792690277, 0.027127401903271675, -0.00018938211724162102, -0.032508041709661484, -0.016352105885744095, -0.015441320836544037, -0.013059265911579132, 0.004778122063726187, -0.00044466485269367695, 0.005387647543102503, -0.03570279851555824, -0.01312932651489973, -0.019392728805541992, 0.0221110749989748, 0.016183961182832718, 0.0014975419035181403, -0.016380131244659424, -0.022209158167243004, -0.014614607207477093, 0.025109661743044853, 0.0016236506635323167, 0.01601581647992134, -0.020457647740840912, 0.0165482759475708, 0.03054635040462017, 0.013549688272178173, -0.005005818326026201, 0.01016576960682869, -0.006456069182604551, -0.014992933720350266, 0.02817830815911293, 0.04427819699048996, -0.008267131634056568, 0.015497368760406971, -0.020555732771754265, 0.013150344602763653, -0.01333250105381012, -0.0040389844216406345, 0.02637074887752533, -0.006368493661284447, 0.003898863447830081, 0.027421655133366585, -0.011994346976280212, -0.012316624633967876, -0.009612292051315308, 0.011104579083621502, -0.004939260892570019, 0.024759359657764435, -0.019140511751174927, -0.016954626888036728, -0.04324130341410637, -0.01687055267393589, 0.013255435042083263, -0.017515109851956367, 0.014418438076972961, -0.010214812122285366, -0.0121484799310565, 0.02240532822906971, 0.0531618595123291, -0.017571158707141876, 0.018818233162164688, -0.021032143384218216, -0.010410981252789497, -0.01250578835606575, -0.017150795087218285, -0.03906570002436638, 0.03570279851555824, -0.032311875373125076, 0.004175601992756128, -0.003527543041855097, -0.004410304594784975, -0.03424554318189621, 0.03755239397287369, -0.025642121210694313, -0.007216224912554026, 0.0141452020034194, -0.008428270928561687, 0.010831343941390514, 0.017837388440966606, 0.020920047536492348, -0.05304976552724838, -0.09802856296300888, -0.02376450039446354, 0.012050394900143147, 0.025417927652597427, -0.016183961182832718, 0.0027568782679736614, 0.050359442830085754, 0.007874793373048306, -0.005426181014627218, -0.007874793373048306, 0.0074614365585148335, -0.023484257981181145, -0.000624851556494832, -0.04150380194187164, -0.004820158239454031, -0.048734039068222046, 0.007230237126350403, 0.00971037708222866, -0.006904456298798323, -0.02820633165538311, -0.04366166517138481, -0.013220404274761677, 0.007797726895660162, 0.006519123911857605, -0.04001852124929428, 0.025530023500323296, 0.023077908903360367, -0.041924167424440384, -0.004319225903600454, -0.003047629026696086, -0.004000450950115919, -0.037636466324329376, -0.007601557299494743, 0.010228823870420456, -0.037664491683244705, -0.010691222734749317, -0.0018320804229006171, 0.0027691388968378305, -0.0007062967633828521, 0.037748564034700394, 0.026202604174613953, -0.02815028466284275, 0.04836972802877426, -0.021214300766587257, 0.031331028789281845, -0.04528706893324852, 0.012659921310842037, -0.023834561929106712, -0.008701506070792675, -0.0007645345176570117, 0.011658056639134884, -0.006417536176741123, -0.0015281933592632413, -0.0022629520390182734, 0.0030248593538999557, 0.005152945406734943, 0.002453866880387068, -0.011545959860086441, -0.006617208477109671, -0.015721561387181282, -0.0010465277591720223, 0.033460866659879684, 0.011559972539544106, -0.008028926327824593, -0.04733283072710037, -0.009822473861277103, 0.00945815909653902, 0.016141925007104874, -0.02232125587761402, -0.037468321621418, -0.005545283667743206, 0.021200288087129593, -0.005258035846054554, 0.030714496970176697, -0.025908349081873894, -0.009801454842090607, 0.04957476630806923, -0.0027358601801097393, -0.036543525755405426, 0.035002194344997406, 0.053386054933071136, -0.024997564032673836, 0.04601569473743439, 0.027926091104745865, 0.021144241094589233, 0.03973827883601189, -0.009212947450578213, 0.0075875455513596535, -0.02450714074075222, 0.015427308157086372, 0.02405875362455845, -0.022783653810620308, 0.025151697918772697, -0.03421751782298088, -0.026412785053253174, -0.03940198943018913, -0.002189388731494546, -0.0034434704575687647, 0.04069110378623009, -0.01197332888841629, 0.013731845654547215, 0.007107631303369999, -0.04273686558008194, 0.0011122094001621008, 0.01734696514904499, 0.005475223064422607, 0.007881799712777138, 0.01953285001218319, 0.02184484526515007, -0.016954626888036728, -0.015987791121006012, -0.007293291389942169, -0.02080794982612133, 0.017543133348226547, -0.029789697378873825, 0.02187286876142025, 0.04276489093899727, 0.011244700290262699, 0.02625865302979946, 0.014096160419285297, -0.020976094529032707, 0.03200360760092735, -0.010670204646885395, 0.027043329551815987, 0.0038533241022378206, -0.014880836941301823, -0.0007991268648765981, 0.004413807764649391, -0.040354810655117035, -0.0005762471118941903, 0.025137685239315033, -0.005758968181908131, 0.0074614365585148335, 0.01294716913253069, 0.00971037708222866, 0.03519836440682411, 0.04436226934194565, 0.023400185629725456, -0.0252497810870409, 0.04486670345067978, 0.013346513733267784, 0.032367922365665436, 0.026510870084166527, 0.018874282017350197, -0.0054787262342870235, 0.02761782519519329, 0.012008358724415302, -0.033909253776073456, -0.020107345655560493, -0.001923158997669816, 0.026735063642263412, 0.01223955862224102, -0.01660432294011116, 0.012722975574433804, 0.028164295479655266, 0.02536187879741192, 0.024605225771665573, -0.012358661741018295, 0.009682352654635906, -0.0025291817728430033, 0.01666037179529667, 0.01956087350845337, 0.005559295881539583, -0.018930330872535706, 0.05470319092273712, -0.02349827066063881, -0.016155937686562538, 0.005804507061839104, -0.0017331200651824474, -0.021998977288603783, -0.015889707952737808, -0.026146555319428444, -0.004259674809873104, 0.004070511553436518, 0.029789697378873825, 0.029257239773869514, -0.005636362358927727, 0.0526854507625103, -0.012582854367792606, 0.04971488565206528, 0.023091919720172882, 0.026959257200360298, 0.015413296408951283, -0.03679574280977249, 0.042344529181718826, -0.00951420795172453, 0.01170709915459156, -0.013605737127363682, 0.010228823870420456, 0.04968686401844025, 0.006781850475817919, 0.024338996037840843, 0.00716367969289422, 0.019462790340185165, 0.005615344271063805, -0.003285834565758705, 0.002853211248293519, 0.04385783523321152, 0.007489460986107588, -0.05377839133143425, -0.021354421973228455, 0.04581952467560768, -0.001994970953091979, -0.011223682202398777, -0.04099936783313751, 0.02639877237379551, 0.010740265250205994, -0.014376401901245117, 0.005499744322150946, 0.03704795986413956, 0.004473358858376741, 0.015987791121006012, -0.019925188273191452, 0.0019669467583298683, 0.003026610938832164, -0.050303395837545395, -1.9458191673038527e-05, 0.009332050569355488, -0.01713678240776062, -0.0023592852521687746, -0.006364990957081318, -0.024549176916480064, 0.0205417200922966, 0.024577202275395393, -0.01502095814794302, -0.01953285001218319, 0.04915440455079079, 0.01142685767263174, 0.016828516498208046, 0.019729020074009895, -0.03371308371424675, 0.024226900190114975, -0.014712692238390446, 0.005044351331889629, -0.03060239925980568, -0.027295546606183052, 0.002096558688208461, 0.005874567665159702, -0.006350978743284941, -0.017809363082051277, 0.023456234484910965, 0.01865008845925331, -0.02264353446662426, -0.003007344203069806, -0.007468442898243666, 0.006284421309828758, 0.003895360277965665, 0.06271810084581375, -0.025978410616517067, 0.010018642991781235, -0.0036571549717336893, 0.0008538615657016635, 0.008533361367881298, 0.012617885135114193, -0.008344198577105999, -0.013928014785051346, 0.013276453129947186, 0.041812069714069366, 0.0459316223859787, 0.009962594136595726, -0.04495077580213547, 0.04226045683026314, 0.020415611565113068, -0.006473584566265345, -0.01268093939870596, -0.010389963164925575, 0.004368268419057131, 0.03256409242749214, 0.03334876894950867, 0.002918017329648137, -0.008589409291744232, 0.004981297068297863, -0.0038182938005775213, 0.030910665169358253, 0.020471660420298576, 0.013010223396122456, 0.033460866659879684, 0.014096160419285297, 0.04158787429332733, -0.003562573343515396, -0.002364539774134755, -0.0021648674737662077, -0.04789331555366516, -0.020317526534199715, 0.021116215735673904, -0.012309619225561619, 0.003098422894254327, 0.0019494317239150405, 8.86702400748618e-05, 0.05389048904180527, 0.03943001478910446, 0.04262477159500122, -0.02400270663201809, 0.003089665435254574, 0.01530119962990284, -0.017248880118131638, -0.008792584761977196, -0.02426893636584282, -0.002882987027987838, -0.007783714681863785, 0.033040501177310944, 0.008932705968618393, 0.006123282480984926, 0.013094295747578144, 0.02959352917969227, 0.007881799712777138, -0.0005000563687644899, -0.01269495114684105, -0.012736987322568893, -0.03996247425675392, -0.00017931094043888152, -0.014516523107886314, 0.026482844725251198, 0.02086399868130684, -0.006953498348593712, -0.0051914784125983715, -0.021088192239403725, -0.0038918573409318924, -0.0050583635456860065, 0.0008831993909552693, 0.003905869321897626, 0.0034364645835012197, 0.020948071032762527, 0.03948606178164482, -0.01825775019824505, -0.019140511751174927, 0.019308656454086304, 0.0056223501451313496, -0.0035310459788888693, 0.014376401901245117, -0.019757043570280075, 0.017949484288692474, 0.0194487776607275, -0.01555341761559248, -0.04570743069052696, 0.016085876151919365, -0.037720538675785065, 0.011938299052417278, -0.024367019534111023, -0.03777658939361572, 0.042905014008283615, 0.002947792876511812, 0.019308656454086304, -0.017389001324772835, -0.01879020966589451, 0.01628204621374607, 0.005258035846054554, 0.02631470002233982, 0.01188225019723177, -0.0041615902446210384, 0.06938786059617996, -0.03786066174507141, -0.014936885796487331, -0.010453017428517342, -0.012078419327735901, 0.02459121309220791, -0.01502095814794302, 0.010207805782556534, -0.022307243198156357, 0.006315948441624641, 0.003415446262806654, 0.025852302089333534, -0.018327809870243073, -0.0023084913846105337, 0.011272724717855453, -0.020163394510746002, -0.010845355689525604, 0.04514694586396217, 0.01609988883137703, 0.0015789871104061604, 0.005443695932626724, 0.02296581119298935, -0.02027549035847187, 0.006315948441624641, 0.021466517820954323, -0.002965308027341962, -0.035562679171562195, 0.020976094529032707, 0.01657629944384098, 0.025207744911313057, -0.006694274954497814, -0.043437469750642776, -0.04175602272152901, 0.015917731449007988, -0.028808852657675743, -0.00030957956914789975, -0.018313799053430557, 0.028276393190026283, -0.011300748214125633, -0.013696815818548203, -0.015413296408951283, -0.009626303799450397, 0.008771566674113274, 0.008512343280017376, -0.011041524820029736, 0.015497368760406971, 4.3568834371399134e-05, 0.0011104579316452146, 0.02908909320831299, 0.02735159546136856, 0.023848572745919228, -0.0009326795698143542, 0.024871455505490303, -0.0119593171402812, -0.012435727752745152, -0.0066137053072452545, -0.00738437008112669, 0.02157861553132534, 0.01370382122695446, 0.017683254554867744, -0.005422677844762802, 0.03205965831875801, -0.03570279851555824, 0.022923775017261505, 0.018636075779795647, -0.01198734063655138, 0.018804222345352173, 0.028304416686296463, -0.023161981254816055, 0.03248002007603645, -0.03727215155959129, -0.004021469037979841, -0.021830832585692406, -0.020499683916568756, 0.004473358858376741, -0.009402111172676086, -0.04590360075235367, 0.023526296019554138, -0.002007231581956148, 0.0034242039546370506, 0.006592687219381332, -0.012456745840609074, -0.009521213360130787, 0.028486574068665504, -0.007762696593999863, 0.001986213494092226, 0.006403523962944746, -0.000971212808508426, -0.046604204922914505, 0.039850376546382904, -0.014992933720350266, 0.03861731290817261, 0.04621186479926109, 0.006921971216797829, -0.014348377473652363, -0.014558559283614159, -0.011538954451680183, 0.03110683523118496, 0.01929464377462864, 0.025586072355508804, -0.03519836440682411, 0.000818393484223634, -0.0019651951733976603, 0.03063042275607586, 0.007580539211630821, -0.01043199934065342, -0.018327809870243073, 0.0037727546878159046, -0.004312220029532909, 0.011580990627408028, 0.025964397937059402, -0.025796253234148026, 0.03920581936836243, 0.011237693950533867, -0.010887391865253448, 0.0014546298189088702, 0.010221817530691624, 0.06311044096946716, 0.005976155400276184, -0.0035433066077530384, -0.015273175202310085, 0.009766425006091595, 0.012211534194648266, -0.00505486037582159, -0.012736987322568893, 0.0216346625238657, -0.011679074726998806, 0.01088038645684719, -0.029705625027418137, 0.0026763086207211018, 0.00286372029222548, 0.00790281780064106, 0.013220404274761677, -0.019070452079176903, -0.005282557103782892, 0.023820549249649048, 0.02142448164522648, -0.036655619740486145, -0.01719283126294613, 0.0036046095192432404, 0.008631446398794651, 0.0012733484618365765, -0.00802191998809576, 0.006235378794372082, -0.014656643383204937, -0.021592626348137856, 0.007433412596583366, -0.029677601531147957, 0.03797275573015213, 0.01862206496298313, 0.012793036177754402, 0.0176412183791399, -0.012309619225561619, 0.016268033534288406, -0.0017777836183086038, -0.01915452443063259, -0.013745858334004879, -0.017417024821043015, -0.011258712038397789, -0.0006388635956682265, 0.024128815159201622, -0.015062994323670864, -0.0008091980707831681, 0.022783653810620308, 0.024086778983473778, -0.0069009531289339066, -0.02903304621577263, -0.028864899650216103, 0.0008310919511131942, 0.015637489035725594, -0.007517484948039055, 0.006522626616060734, 0.01926662027835846, 0.0011209669755771756, -0.02572619356215, -0.009773431345820427, -0.032844334840774536, -0.006105767097324133, -0.008855639025568962, 0.006508614867925644, -0.01713678240776062, 0.0041896142065525055, 0.016982650384306908, 0.009107857011258602, -0.010018642991781235, 0.03301247954368591, 0.033376794308423996, 0.014173226431012154, 0.009346062317490578, 0.028598669916391373, 0.003716706298291683, -0.0036991911474615335, 0.018692124634981155, 0.01315735001116991, 0.025025589391589165, 0.03438566252589226, 0.0300979632884264, -0.009332050569355488, 0.012617885135114193, 0.017473073676228523, -0.03063042275607586, 0.00039759298670105636, 0.011489911936223507, 0.003755239536985755, -0.010663198307156563, -0.022657545283436775, 0.005366629455238581, -0.020135369151830673, 0.008687494322657585, -0.005850046407431364, 0.010277866385877132, -0.01947680115699768, 0.03514231741428375, 0.012386685237288475, 0.020934058353304863, 0.010621162131428719, -0.004879709333181381, 0.016520250588655472, -0.03833707049489021, -0.0007378240115940571, -0.022489400580525398, -0.010214812122285366, 0.03105078637599945, 0.0051914784125983715, -0.0026745572686195374, 0.016996663063764572, 0.010999488644301891, 0.03430159017443657, 0.002975817071273923, 0.026805123314261436, -0.008134016767144203, -0.02000926062464714, -0.008771566674113274, -0.01577761024236679, -0.022447364404797554, 0.003408440388739109, -0.006280918139964342, -0.005152945406734943, -0.002392563968896866, 0.017248880118131638, -0.028248367831110954, 0.006368493661284447, 0.0009572007111273706, -0.0205417200922966, -0.031891509890556335, 0.05251730605959892, 0.01681450568139553, 0.025137685239315033, -0.009402111172676086, 0.0030248593538999557, 0.01876218616962433, -0.01278602983802557, -0.022293230518698692, -0.05159250646829605, 0.036011066287755966, -0.037075985223054886, -0.018397871404886246, -0.019785067066550255, -0.016085876151919365, 0.06473584473133087, -0.024170851334929466, -0.018636075779795647, 0.007678624242544174, 0.009416122920811176, -0.006081245839595795, 0.0290050208568573, -0.02403073012828827, 0.0032455497421324253, 0.00472907954826951, -0.03522638976573944, -0.0026237634010612965, 0.019672971218824387, 0.005096897017210722, -0.025698168203234673, 0.008813602849841118, 0.02024746686220169, 0.04265279322862625, 0.004469856154173613, -0.005475223064422607, -0.021004119887948036, 0.041896142065525055, -0.015217127278447151, -0.023568332195281982, -0.003692185040563345, -0.0032105196733027697, 0.019813092425465584, -0.006347475573420525, -0.008505336940288544, -0.03110683523118496, 0.007965872064232826, -0.02370845153927803, 0.01240069791674614, -0.00010634955833666027, -0.01528718788176775, -0.010719247162342072, 0.022825689986348152, 0.021704724058508873, -0.008792584761977196, -0.012863096781075, 0.001432735938578844, -0.009023784659802914, -0.010509065352380276, 0.019672971218824387, 0.024296959862113, 0.015889707952737808, 0.04307315871119499, 0.0001474553282605484, 0.022657545283436775, -0.032451994717121124, 0.007720660418272018, 0.016324082389473915, 0.006035706959664822, -0.012393691577017307, 0.04685642197728157, 0.024310972541570663, 0.03376913070678711, -0.00486920028924942, 0.008799591101706028, -0.011202664114534855, 0.003765748580917716, -0.01775331422686577, -0.017304928973317146, -0.00508989067748189, 0.01977105624973774, 0.02758979983627796, 0.014586582779884338, -0.0012864847667515278, 0.03693586215376854, -0.007909823209047318, -0.02426893636584282, 0.02788405492901802, 0.015721561387181282, 0.03006993979215622, 0.033432841300964355, -0.0022857217118144035, 0.002352279145270586, -0.008253119885921478, 0.0005889455787837505, 0.01475472841411829, -0.007888805121183395, -0.006610202137380838, -0.007223231252282858, 0.0029215202666819096, 0.02323204092681408, -0.015189102850854397, 0.0001796393480617553, 0.010691222734749317, 0.012996211647987366, -0.010312896221876144, 0.006788856349885464, 0.028108248487114906, 0.033432841300964355, -0.007734672166407108, -0.010677210986614227, 0.0015010448405519128, 0.004133565817028284, -0.022181134670972824, -0.024465104565024376, -0.00973840057849884, -0.007839762605726719, -0.012919144704937935, -0.02157861553132534, -0.011637038551270962, 0.007370357867330313, -0.021676698699593544, 0.0009230462601408362, -0.026959257200360298, -0.025137685239315033, 0.0018548500956967473, 0.006249391008168459, 0.029257239773869514, 0.05386246368288994, 0.02607649564743042, 0.009016778320074081, -0.014124183915555477, -0.021914904937148094, -0.012533812783658504, -0.007405388168990612, 0.048257630318403244, -0.001381942187435925, -0.009339055977761745, 0.004813151899725199, -0.003007344203069806, -0.002713090507313609, -0.002509915269911289, 0.0030336170457303524, -0.014138196595013142, 0.029369335621595383, -0.0286266952753067]",Token-level Direct Preference Optimization.pdf
" in its loss function. Ex-
periments on a variety of tasks suggest that ODPO
is more effective than DPO in aligning language
models to human preferences.Limitations
Human Preference Data. Not all datasets with
human feedback contain judgments regarding the
extent to which one response is preferred over an-
other. In our experiments, we focused on tasks and
datasets where we had either access to such infor-
mation or point-wise reward functions. The results
presented in the paper provide strong motivation to
ask humans to indicate their degree of preference
when collecting human feedback data.
Offset values. Deciding how to scale offset val-
ues can depend on the task. In this study, we ex-
perimented with offsets based on Likert scores and
classifier probabilities. We defer extending ODPO
to different tasks for future work.
Ethical Considerations
We foresee two main ethical concerns regarding
the use of direct preference optimization and, in
general, any RLHF method for aligning language
models with human preferences. First, as with
DPO and other RLHF methods, malicious actors
can use ODPO to steer the responses to generate
harmful or toxic content. However, we must note
that we foresee no particular reason for DPO to be
more suitable for malicious use cases compared
to DPO or other RLHF methods. Second, reward
functions might inherit unwanted biases from
the datasets that they were trained on. Therefore,
fine-tuning to increase the expected reward can
then inject such biases into the language models’
generations. We view ODPO as a fine-tuning
strategy that can work with any given reward
function or preference dataset. Therefore, as we
develop more accurate and less biased reward
functions, or find more inclusive ways of collecting
human feedback, less unwanted bias will propagate
to the fine-tuning process.
Acknowledgements
We thank Alizée Pace for her feedback on an early
version of this paper. Afra Amini is supported by
ETH AI Center doctoral fellowship.
References
Dario Amodei, Chris Olah, Jacob Steinhardt, Paul Chris-
tiano, John Schulman, and Dan Mané. 2016. Con-
crete problems in AI safety. Computing Research
Repository , arXiv:1606.06565.
Rohan Anil, Andrew M. Dai, Orhan Firat, Melvin John-
son, Dmitry Lepikhin, Alexandre Passos, Siamak
Shakeri, Emanuel Taropa, Paige Bailey, Zhifeng
Chen, Eric Chu, Jonathan H. Clark, Laurent El
Shafey, Yanping Huang, Kathy Meier-Hellstern, Gau-
rav Mishra, Erica Moreira, Mark Omernick, Kevin
Robinson, Sebastian Ruder, Yi Tay, Kefan Xiao,
Yuanzhong Xu, Yujing Zhang, Gustavo Hernandez
Abrego, Junwhan Ahn, Jacob Austin, Paul Barham,
Jan Botha, James Bradbury, Siddhartha Brahma,
Kevin Brooks, Michele Catasta, Yong Cheng, Colin
Cherry, Christopher A. Choquette-Choo, Aakanksha
Chowdhery, Clément Crepy, Shachi Dave, Mostafa
Dehghani, Sunipa Dev, Jacob Devlin, Mark Díaz,
Nan Du, Ethan Dyer, Vlad Feinberg, Fangxiaoyu
Feng, Vlad Fienber, Markus Freitag, Xavier Gar-
cia, Sebastian Gehrmann, Lucas Gonzalez, Guy Gur-
Ari, Steven Hand, Hadi Hashemi, Le Hou, Joshua
Howland, Andrea Hu, Jeffrey Hui, Jeremy Hur-
witz, Michael Isard, Abe Ittycheriah, Matthew Jagiel-
ski, Wenhao Jia, Kathleen Kenealy, Maxim Krikun,
Sneha Kudugunta, Chang Lan, Katherine Lee, Ben-
jamin Lee, Eric Li, Music Li, Wei Li, YaGuang Li,
Jian Li, Hyeontaek Lim, Hanzhao Lin, Zhongtao Liu,
Frederick Liu, Marcello Maggioni, Aroma Mahendru,
Joshua Maynez, Vedant Misra, Maysam Moussalem,
Zachary Nado, John Nham, Eric Ni, Andrew Nys-
trom, Alicia Parrish, Marie Pellat, Martin Polacek,
Alex Polozov, Reiner Pope, Siyuan Qiao, Emily Reif,
Bryan Richter, Parker Riley, Alex Castro Ros, Au-
rko Roy, Brennan Saeta, Rajkumar Samuel, Renee
Shelby, Ambrose Slone, Daniel Smilkov, David","[0.043203506618738174, 0.01689695380628109, 0.021225368604063988, 0.013207046315073967, 0.027287840843200684, -0.001261894591152668, -0.0076150549575686455, 0.04868796095252037, -0.008744207210838795, -0.024464961141347885, 0.03909016773104668, -0.041160278022289276, -0.004358661361038685, -0.0002598141727503389, 0.011822490021586418, -0.0076150549575686455, 0.04624146223068237, -0.058393288403749466, 0.021561427041888237, 0.03720824792981148, -0.025083305314183235, -0.003031235421076417, 0.005101347342133522, 0.006415330804884434, 0.01607697457075119, -0.01638614572584629, 0.01794545166194439, -7.976106280693784e-05, 0.0035286000929772854, -0.05411864444613457, 0.03150871768593788, -0.022623367607593536, -0.015068802051246166, 0.0005780183128081262, -0.01650712639093399, -0.00829389039427042, 0.0027556687127798796, 0.015485513024032116, -0.021937809884548187, -0.01700449176132679, -0.014060631394386292, -0.05282818526029587, 0.003004350932314992, 0.024303652346134186, -0.010236300528049469, 0.028175031766295433, 0.026172131299972534, -0.012467720545828342, 0.03855247423052788, 0.028443876653909683, -0.06823304295539856, 0.06559835374355316, 0.0018399128457531333, -0.05003218725323677, 0.03204641118645668, -0.00443931482732296, 0.03852559253573418, 0.01774381659924984, 0.04726307839155197, -0.0028665673453360796, -0.027059322223067284, -0.06645866483449936, 0.04677915573120117, 0.01587533950805664, -0.026642611250281334, -0.0050374967977404594, -0.10140860825777054, -0.010458098724484444, 0.029089106246829033, 0.01855035498738289, 0.03449290618300438, 0.058608368039131165, 0.06258728355169296, 0.006677455268800259, -0.010780713520944118, -0.03828363120555878, 0.03882132098078728, 0.05651136860251427, -0.020795216783881187, -0.005454207304865122, -0.03494994342327118, 0.012971805408596992, 0.020768331363797188, -0.06500689685344696, -0.029653683304786682, -0.01692383736371994, -0.09226784855127335, -0.04965580254793167, -0.056833986192941666, 0.00882486067712307, -0.021359791979193687, -0.013260815292596817, -0.03669743984937668, 0.011882980354130268, 0.03586401790380478, -0.028981568291783333, 0.011291519738733768, 0.0056726448237895966, 0.03494994342327118, 0.01849658600986004, -0.03282606229186058, -0.03478863462805748, -0.0006397687830030918, -0.011096606962382793, 0.00918108131736517, 0.0017088506137952209, 0.01965262182056904, 0.006418691482394934, 0.0009476811392232776, 0.05108068510890007, -0.10511867702007294, -0.020069332793354988, -0.08119140565395355, 0.01591566577553749, -0.03734267130494118, -0.03516501933336258, -0.07549187541007996, 0.0026061232201755047, -0.013845554552972317, -0.03839116916060448, -0.04602638632059097, 0.01650712639093399, 0.010216137394309044, 0.013536381535232067, 0.000526349525898695, -0.012790335342288017, -0.00840814970433712, -0.05164526402950287, -0.012319855391979218, -0.012911316007375717, -0.011372174136340618, 0.03680497780442238, 0.024384306743741035, -0.03548763319849968, -0.026427533477544785, 0.03430471196770668, -0.015404859557747841, 0.011486433446407318, -0.013885881751775742, -0.044843465089797974, 0.010350559838116169, -0.03317556157708168, -0.03833739832043648, 0.03449290618300438, -0.05177968367934227, -0.00834765937179327, -0.026588842272758484, 0.005605433136224747, -0.008152746595442295, 0.060436517000198364, 0.01704481802880764, 0.007514237891882658, -0.014289150014519691, 0.003542042337357998, -0.03511125221848488, -0.026346880942583084, 0.00479889614507556, 0.03839116916060448, -0.01599632017314434, -0.03137429431080818, 0.022475501522421837, 0.023806288838386536, -0.01739431731402874, -0.012615585699677467, 0.04909122735261917, 0.03406275063753128, -0.01935689151287079, 0.015189782716333866, -0.05285506695508957, 0.0007582289399579167, -0.012030845507979393, 0.007104248274117708, -0.058500826358795166, -0.006509426981210709, 0.002644769847393036, -0.0040494888089597225, 0.020701119676232338, 0.009214687161147594, -0.015445186756551266, -0.005833952222019434, 0.022771231830120087, 0.014584880322217941, -0.020029006525874138, 0.025392478331923485, 0.005292899906635284, -0.029949413612484932, -0.012783613987267017, -0.03234213963150978, -0.014033745974302292, 0.031024795025587082, 0.05608121678233147, 0.04573065787553787, 0.06629735231399536, -0.0029203365556895733, -0.011714952066540718, -0.060167670249938965, 0.06247974559664726, 0.0010300151770934463, -0.03126675635576248, -0.021292580291628838, 0.023523999378085136, 0.01689695380628109, 0.002794315107166767, -0.06532950699329376, -0.006001980509608984, 0.0018953622784465551, -0.028739606961607933, 0.0038209697231650352, -0.024290209636092186, -0.03852559253573418, 0.038875091820955276, 0.03761151432991028, 0.05175280198454857, 0.015230109915137291, 0.004409069661051035, -0.01810675859451294, -0.03255721554160118, 0.024827901273965836, 0.01958541013300419, 0.01900739222764969, 0.005501255393028259, 0.03771905228495598, 0.039896704256534576, 0.013328026048839092, -0.020176870748400688, -0.014504226855933666, -0.025029536336660385, -0.01904771849513054, 0.03575647994875908, -0.04680604115128517, 0.04874172806739807, -0.00953730195760727, 0.006791715044528246, 0.03632105514407158, 0.002434734022244811, -0.0011669584782794118, 0.01935689151287079, -0.023470230400562286, 0.015364532358944416, -0.005296260584145784, -0.0003646220138762146, 0.005460928659886122, 0.01742120273411274, -0.006143124774098396, 0.021090947091579437, 0.05395733565092087, -0.03417029231786728, -0.025634439662098885, -0.022058790549635887, -0.03594467416405678, 0.03317556157708168, -0.020526370033621788, 0.0033387276344001293, -0.029546143487095833, -0.041079625487327576, -0.021655522286891937, -0.009201244451105595, 0.014316034503281116, -0.006536311469972134, 0.03430471196770668, -0.023416461423039436, -0.012817219831049442, 0.030809719115495682, 0.061942052096128464, -0.00828716903924942, 0.021453889086842537, -0.03680497780442238, 0.024518730118870735, 0.012931479141116142, -0.006502705626189709, 0.005598712246865034, 0.026696380227804184, -0.00485266512259841, 0.028578300029039383, -0.03285294771194458, -0.001471930299885571, 0.024075133726000786, 0.04661784693598747, -0.03954720497131348, -0.024760691449046135, -0.008737485855817795, 0.024948881939053535, 0.043794967234134674, -0.006217057351022959, -0.01547207124531269, 0.010747107677161694, -0.002172609558328986, -0.005780182778835297, -0.04021931812167168, 0.022072233259677887, -0.01607697457075119, -0.04925253614783287, 0.026494745165109634, -0.04965580254793167, 0.024680037051439285, 0.01895362325012684, 0.00854257307946682, -0.040058013051748276, 0.03382079303264618, -0.007467189803719521, 0.07662102580070496, 0.008387986570596695, 0.021010292693972588, -0.003034596098586917, 0.015498955734074116, 6.442845915444195e-05, 0.006989988498389721, 0.03486929088830948, -0.002520428504794836, 0.007272276561707258, 0.0040763732977211475, -0.00421079620718956, -0.0067144217900931835, 0.01876543089747429, -0.03779970854520798, -0.03188510239124298, 0.07258834689855576, -0.0031085286755114794, 0.00030854245414957404, -0.03137429431080818, -0.05393045023083687, -0.03446602076292038, -0.00959107093513012, -0.015149456448853016, 0.009866638109087944, -0.0001245511812157929, 0.014154726639389992, -0.0018079874571412802, -0.026709821075201035, -0.03564894199371338, 0.008435034193098545, -0.012783613987267017, 0.0027758320793509483, 0.029089106246829033, 0.022811559960246086, -0.022784674540162086, -0.05242491513490677, 0.06285613030195236, 0.025567227974534035, 0.014920936897397041, -0.06737273931503296, -0.01666843518614769, -0.026440976187586784, -0.008845023810863495, -0.024007922038435936, -0.0005200484301894903, -0.01744808629155159, 0.01750185526907444, 0.011600692756474018, 0.03820297494530678, -0.006791715044528246, 0.00806537177413702, 0.013435564935207367, 0.029653683304786682, -0.022488944232463837, 0.03236902505159378, -0.006815238855779171, -0.03382079303264618, -0.021534541621804237, 0.01582157053053379, -0.00952385924756527, 0.03075595013797283, 0.005975096020847559, 0.01699104905128479, 0.03384767472743988, -0.03446602076292038, -0.03427783027291298, -0.013381795957684517, 0.0038612966891378164, -0.042020585387945175, 0.005907884798943996, 0.021064061671495438, -0.030809719115495682, 0.024935441091656685, -0.06312497705221176, 0.05352718383073807, 0.011110049672424793, 0.013778342865407467, -0.01713891513645649, 0.01653401181101799, -0.01754218339920044, 0.0017508576856926084, -0.01559305191040039, -0.014020304195582867, -0.00905337929725647, 0.015028475783765316, -0.014208496548235416, 0.006996709853410721, -0.029169760644435883, -0.01803954690694809, 0.012171990238130093, -0.002829601289704442, -0.028820261359214783, 0.03199264034628868, -0.05022038146853447, -0.002767430618405342, -0.041079625487327576, 0.06221089884638786, 0.05527468025684357, 0.026185572147369385, -0.0060759130865335464, -0.01974671706557274, -0.06661996990442276, 0.043714314699172974, -0.07194311171770096, 0.005155116785317659, -0.011889701709151268, 0.030272027477622032, 0.00901305302977562, 0.03914393484592438, 0.03914393484592438, -0.07672856748104095, 0.023954153060913086, -0.014181611128151417, 0.01703137531876564, -0.03277229145169258, 0.010908414609730244, -0.005975096020847559, 0.01871166191995144, 0.03661678731441498, 0.01797233708202839, -0.0009569227113388479, -0.024142345413565636, -0.07129788398742676, -0.021158158779144287, 0.06382397562265396, 0.0041032577864825726, -0.05126887932419777, 0.024559056386351585, -0.060490287840366364, -0.06549081951379776, 0.03559517115354538, 0.07662102580070496, -0.05457568168640137, -0.05548975616693497, -0.01860412396490574, 0.03599844127893448, 0.009503696113824844, -0.0038881811778992414, -0.058769673109054565, 0.011224308982491493, -0.015324206091463566, -0.03255721554160118, -0.004355300683528185, -0.01658778078854084, -0.01646680012345314, 0.009315503761172295, 0.020365063101053238, -0.01648024283349514, -0.03156248852610588, 0.005407159682363272, 0.028712723404169083, 0.03607909381389618, 0.0008468640153296292, 0.01627860777080059, -0.03691251575946808, 0.058500826358795166, 0.010935299098491669, 0.005810427945107222, 0.014705860987305641, -0.005692807957530022, -0.0075276801362633705, -0.024518730118870735, -0.00917435996234417, 0.01783791370689869, 0.010216137394309044, -0.020674236118793488, -0.006227138917893171, -0.01691039651632309, 0.004701439291238785, -0.013173440471291542, -0.01703137531876564, -0.03962785750627518, -0.021789945662021637, -0.05366160348057747, -0.01725989580154419, 0.006176730152219534, -0.030782833695411682, -0.014020304195582867, -0.0020785133820027113, 0.011997240595519543, -0.01977360248565674, -0.004778732545673847, 0.007016872987151146, 0.07602956891059875, 0.014652092009782791, 0.03244967758655548, 0.00122744869440794, -0.028685837984085083, 0.042208775877952576, 0.01942410320043564, -0.01744808629155159, 0.06683504581451416, -0.014665533788502216, -0.041671086102724075, -0.015310763381421566, 0.03825674578547478, 0.01696416549384594, -0.009449927136301994, -0.03731578588485718, 0.014168169349431992, -0.03325621411204338, -0.03105168044567108, 0.03594467416405678, 0.0074134208261966705, 0.0031673386693000793, 0.023362692445516586, -0.006364922504872084, 0.0041872719302773476, 0.027933070436120033, 0.00028270806069485843, 0.008905514143407345, 0.003992358688265085, 0.027314724400639534, 0.01587533950805664, 0.03099791146814823, -0.04868796095252037, -0.03172379359602928, -0.03914393484592438, 0.01770349033176899, -0.022179771214723587, -0.0020297851879149675, -0.01731366477906704, -0.0009745657444000244, -0.014356361702084541, -0.014799957163631916, -0.014450456947088242, -0.06844811886548996, -0.027018994092941284, -0.00029278980218805373, 0.015136013738811016, 0.014557995833456516, 0.01794545166194439, 0.007339488249272108, -0.010175810195505619, -0.011761999689042568, 0.01568714715540409, -0.04761257767677307, -0.015028475783765316, -0.0016063532093539834, 0.015230109915137291, 0.0035857297480106354, 0.0068555655889213085, 0.01638614572584629, 0.006929498165845871, -0.03589090332388878, -0.00432841619476676, -0.009429763071238995, -0.0037134315352886915, 0.00456029549241066, 0.026172131299972534, -0.03465421125292778, -0.014168169349431992, -0.0031387738417834044, -0.010948741808533669, 0.01685662567615509, 0.0002793474995996803, -0.01906116120517254, 0.020445717498660088, -0.02016342803835869, 0.013099507428705692, -0.014208496548235416, -0.026777032762765884, 0.04801584407687187, -0.014584880322217941, 0.011089885607361794, 0.022851886227726936, -0.024021364748477936, 0.023214828222990036, 0.03965474292635918, -0.023537442088127136, -0.0022667055018246174, 0.013953092508018017, -0.059146057814359665, 0.030782833695411682, -0.00045493736979551613, -0.030352681875228882, -0.007507516536861658, 0.0010728624183684587, 0.019840814173221588, -0.01791856624186039, -0.0014198414282873273, -0.0012770171742886305, 0.01846970058977604, -0.05212918296456337, 0.0007288239430636168, 0.007278997916728258, 0.022018464282155037, -0.03301425278186798, 0.014248822815716267, 0.03817609325051308, -0.022072233259677887, -0.012615585699677467, -0.03822986036539078, -0.010780713520944118, 0.015552724711596966, 0.022166328504681587, 0.002790954662486911, 0.03503059595823288, 0.028981568291783333, 0.00965156126767397, 0.011755279265344143, 0.000901473278645426, -0.021722733974456787, 0.0008199794101528823, 0.04008489474654198, 0.006025504786521196, -0.020808657631278038, 0.03664367273449898, -0.00864338967949152, -0.003945311065763235, -0.024088576436042786, 0.019854256883263588, -0.028416993096470833, -0.03634794056415558, -0.03648236393928528, -0.012198874726891518, -0.01982737146317959, 0.012010682374238968, -0.021480772644281387, -0.029115991666913033, -0.03312179073691368, 0.027260955423116684, 0.011372174136340618, -0.030218258500099182, 0.0003062320756725967, 0.021736176684498787, -0.0074134208261966705, -0.01892673783004284, -0.03118610382080078, -0.03559517115354538, -0.00787045806646347, -0.0030177931766957045, -0.006153206340968609, 0.022878769785165787, 0.012118220329284668, -0.005860836710780859, -0.0067110611125826836, -0.000692277739290148, -0.026252783834934235, 0.020607024431228638, 0.025137074291706085, 0.000988007988780737, -0.011459548957645893, 0.01697760634124279, -0.01727333664894104, 0.027691109105944633, 0.013361631892621517, -0.00865011103451252, -0.026360321789979935, -0.021642079576849937, -0.021131273359060287, 0.005380274727940559, -0.006173369940370321, 0.008851745165884495, 0.01740776002407074, 0.008629947900772095, -0.009503696113824844, 0.014383246190845966, -0.004469559993594885, -0.04511231184005737, -0.011116770096123219, 0.005413880571722984, 0.008549293503165245, 0.00830733310431242, 0.03798789903521538, 0.005161837674677372, 0.05234426259994507, -0.004580459091812372, -0.0008426632848568261, -0.025123631581664085, 0.005716332234442234, 0.03685874864459038, 0.009853195399045944, -0.01842937432229519, -0.023295480757951736, 0.03357883170247078, -0.01680285669863224, -0.011856095865368843, 0.015041917562484741, -0.005155116785317659, -0.002192772924900055, -0.03527255728840828, -0.058877211064100266, 0.011990519240498543, -0.01764972135424614, 0.024290209636092186, -0.012212316505610943, 0.021978138014674187, -0.002609483664855361, -0.01547207124531269, -0.0014904134441167116, 0.023685308173298836, -0.03451979160308838, 0.0007552884635515511, 0.04642965644598007, -0.001892001717351377, 0.03476175293326378, -0.01622483879327774, -0.10759205371141434, -0.01700449176132679, 0.020902754738926888, -0.03239591047167778, 0.013005411252379417, -0.04478969797492027, -0.023268597200512886, -0.00910714827477932, 0.028309453278779984, 0.027113091200590134, -0.006781633011996746, -0.01742120273411274, -0.006452297326177359, -0.021373234689235687, 0.03696628659963608, -0.00934910960495472, 0.005491173826158047, 0.002728783991187811, 0.025741977617144585, 0.015377975068986416, -0.028793375939130783, -0.042423855513334274, 0.012427393347024918, -0.002133962931111455, 0.029546143487095833, 0.0022667055018246174, -0.00799143873155117, -0.020969966426491737, 0.011157097294926643, 0.01524355262517929, 0.006284268572926521, 0.0008771091233938932, 0.010303512215614319, -0.03747709468007088, -0.03199264034628868, 0.020943081006407738, 0.010841203853487968, -0.021131273359060287, 0.01736743375658989, -0.026212457567453384, 0.009382715448737144, 0.010841203853487968, -0.004698079079389572, 0.0020617106929421425, 0.013254093937575817, -0.020230639725923538, -0.024814460426568985, 0.026938341557979584, 0.03602532669901848, -0.015377975068986416, 0.03529944270849228, -0.03384767472743988, 0.012514768168330193, -0.00408309418708086, -0.00805865041911602, 0.011842654086649418, -0.005575187969952822, 0.014531111344695091, 0.021265696734189987, -0.023981038480997086, 0.005380274727940559, 0.013153276406228542, 0.042531393468379974, -0.03142806515097618, 0.013993419706821442, 0.0034949942491948605, -0.0076688239350914955, -0.007910785265266895, -0.03562205657362938, 0.029922528192400932, 0.007453747559338808, 0.009160918183624744, -0.01732710562646389, -0.0013853955315425992, -0.001444205641746521, 0.058393288403749466, -0.010377444326877594, -0.0014526069862768054, -0.006250662729144096, -0.0024498566053807735, 0.01786479726433754, -0.0030245142988860607, -0.009281898848712444, 0.01665499247610569, -0.04465527459979057, -0.01739431731402874, -0.01915525645017624, -0.008629947900772095, -0.022126002237200737, 0.028524531051516533, -0.024706920608878136, -0.020015563815832138, 0.022623367607593536, -0.013764901086688042, -0.01806643232703209, 0.01712547242641449, 0.03852559253573418, -0.01949131488800049, -0.06764158606529236, -0.026279669255018234, 0.023779403418302536, -0.02005589008331299, 0.01609041541814804, -0.0024801017716526985, 0.05331210419535637, 0.030003182590007782, 0.026844244450330734, -0.019840814173221588, 0.059576209634542465, -0.005198804195970297, 0.003538681659847498, -0.020096218213438988, 0.012145104818046093, -0.03962785750627518, 0.012400508858263493, -0.015552724711596966, 0.020714562386274338, -0.0012207275722175837, -0.03519190475344658, -0.0007330246735364199, 0.012010682374238968, 0.01738087646663189, -0.03333687037229538, 0.021884040907025337, 0.0021272418089210987, -0.007205065339803696, 0.006667373701930046, -0.003639498958364129, -0.043311044573783875, -0.04680604115128517, 0.006052389275282621, 0.025056421756744385, -0.03871378302574158, 0.005501255393028259, -0.0004540972295217216, -0.009738936088979244, -0.005652481224387884, 0.012541652657091618, 0.011782163754105568, -0.03357883170247078, 0.059414904564619064, -0.01837560534477234, 0.024370864033699036, -0.043203506618738174, 0.028900913894176483, -0.024222999811172485, 0.012003961019217968, -0.00239944807253778, 0.01790512539446354, -0.014047188684344292, -0.005124871619045734, -0.006250662729144096, -0.0018651171121746302, -0.00462414650246501, 0.013979976996779442, 0.0032043049577623606, -0.0026027625426650047, -0.008327496238052845, -0.012225759215652943, 0.03132052719593048, 0.01684318482875824, -0.015256994403898716, -0.023134173825383186, -0.010491704568266869, -0.010760549455881119, 0.021131273359060287, -0.038767553865909576, -0.05143018439412117, -0.027234071865677834, 0.04941384121775627, 0.005699529312551022, 0.040837664157152176, 0.0011509957257658243, -0.03521879017353058, 0.04694046080112457, 0.010431214235723019, -0.042450737208127975, 0.0019088046392425895, 0.06661996990442276, -0.01988114044070244, 0.026252783834934235, 0.04887615144252777, -0.0068891714327037334, 0.013496055267751217, -0.0010636209044605494, 0.00893239863216877, -0.019666064530611038, 0.01566026359796524, 0.03172379359602928, -0.01748841442167759, 0.01841593161225319, -0.011654461733996868, -0.00830733310431242, -0.03519190475344658, -0.009443205781280994, 0.00840142834931612, 0.027260955423116684, -0.01782447099685669, 0.00834765937179327, 0.010921857319772243, -0.056565139442682266, 0.028040608391165733, 0.0038780993781983852, -0.0004339338047429919, -0.011392337270081043, -0.012823940254747868, -0.0010468179825693369, -0.010646290145814419, -0.013845554552972317, 0.029277298599481583, -0.009086985141038895, 0.024343980476260185, -0.0019424102501943707, 0.04992464929819107, 0.008918956853449345, 0.025553785264492035, 0.030567757785320282, 0.03123987279832363, -0.005235770251601934, 0.042558278888463974, -0.044574618339538574, 0.03833739832043648, 0.0018785594729706645, -0.005343308672308922, 0.006838763132691383, -0.007628497201949358, -0.03430471196770668, 0.0007040397031232715, 0.03344440832734108, 0.010552193969488144, 0.005494534503668547, 0.006139764096587896, -0.014450456947088242, 0.015404859557747841, 0.05296260491013527, -0.00994057022035122, -0.026696380227804184, 0.03352506086230278, 0.00858962070196867, 0.025943610817193985, 0.0009485213086009026, 0.012037566863000393, 0.00881813932210207, 0.00824684277176857, 0.010256463661789894, -0.026602283120155334, -0.01767660677433014, 0.014047188684344292, 0.0007838532910682261, -0.000154061199282296, 0.007285718806087971, 0.01934344880282879, 0.021857157349586487, 0.03806855529546738, -0.00043183343950659037, -0.00848208274692297, 0.00829389039427042, -0.010720223188400269, 0.01976015977561474, 0.012844104319810867, -0.014665533788502216, -0.025862958282232285, 0.021090947091579437, -0.044278889894485474, -0.03849870711565018, 0.013979976996779442, 0.027664223685860634, 0.001141754211857915, -0.027664223685860634, -0.03874066844582558, 0.00013736335677094758, 0.019612295553088188, 0.01575435884296894, 0.01755562610924244, -0.0035554845817387104, 0.013112950138747692, -0.025311823934316635, 0.026333438232541084, 0.022905655205249786, 0.007379814982414246, -0.004395627416670322, -0.025849515572190285, 0.03457355871796608, 0.008199794217944145, -0.00409317621961236, -0.0051786405965685844, -0.015176340937614441, 0.043095968663692474, 0.020862428471446037, 0.026440976187586784, 0.0003780642873607576, 0.01840248890221119, 0.005235770251601934, -0.01611730083823204, 0.009194523096084595, 0.026199014857411385, 0.008441755548119545, -0.038767553865909576, 0.021077504381537437, 0.039896704256534576, 0.0037436767015606165, 0.010256463661789894, -0.04812338203191757, 0.04833846166729927, 0.00982631091028452, -0.03661678731441498, -0.011170540004968643, 0.042370084673166275, -0.008428312838077545, 0.027180302888154984, -0.03406275063753128, 0.021937809884548187, -0.0005893601919524372, -0.03298737108707428, -0.014786514453589916, -0.013294421136379242, -0.03382079303264618, -0.0007489873678423464, 0.012649190612137318, -0.0016071932623162866, -0.0019037637393921614, 0.042423855513334274, -0.00907354336231947, 0.014181611128151417, 0.021897483617067337, 0.005158476997166872, -0.004940039943903685, 0.01877887360751629, -0.01805298961699009, 0.0058507551439106464, -0.009039937518537045, 0.0008502245764248073, 0.0008540052222087979, -0.024680037051439285, -0.011856095865368843, 0.0012576938606798649, -0.011345289647579193, 0.006213696673512459, 0.030621526762843132, 0.03618663176894188, -0.0027422262355685234, 0.0067480276338756084, 0.019719833508133888, 0.030460219830274582, 0.014410130679607391, 0.03226148709654808, -0.01535109058022499, 0.010532030835747719, -0.00239776773378253, -0.012380345724523067, 0.00881813932210207, 0.012192153371870518, 0.013858996331691742, -0.03497682884335518, -0.013556545600295067, 0.03368636965751648, 0.01599632017314434, 0.023066962137818336, -0.043929390609264374, 0.029277298599481583, 0.0010980666847899556, -0.028148146346211433, -0.0006863967282697558, -0.013832111842930317, 0.0019709751941263676, 0.025809189304709435, 0.012924757786095142, -0.007225228473544121, -0.03392833098769188, -0.00432841619476676, 0.015391416847705841, 0.01594255119562149, 0.01709858700633049, 0.01899394951760769, 0.026777032762765884, 0.007957832887768745, 0.00887190829962492, -0.028578300029039383, -0.022825000807642937, 0.007312603294849396, 0.0009947291109710932, -0.0030732424929738045, -0.010269906371831894, -0.03712759539484978, 0.006079273764044046, -0.021816829219460487, 0.006909335032105446, 0.040891434997320175, 0.03215394914150238, 0.03747709468007088, -0.020916197448968887, 0.0011232710676267743, -0.004896352533251047, -0.010679895989596844, -0.022126002237200737, -0.011378894560039043, 0.028416993096470833, 0.0033454489894211292, 0.05134953185915947, 0.030917257070541382, 0.030056951567530632, 0.023026635870337486, 0.03196575492620468, -0.0069160559214651585, -0.01732710562646389, -0.01764972135424614, 2.330083771084901e-05, -0.005323145072907209, 0.002312073251232505, -0.024854786694049835, 0.029115991666913033, -0.01953164115548134, -0.00800488144159317, -0.021346349269151688, -0.005756658967584372, -0.01935689151287079, -0.039466552436351776, 0.006082634441554546, 0.003153896424919367, 0.00859634205698967, 0.01685662567615509, 0.022152887657284737, -0.03158937022089958, 0.025580670684576035, 0.012897873297333717, 0.004687997046858072, -0.020916197448968887, -0.020499486476182938, -0.005198804195970297, 0.011768721044063568, 0.010478261858224869, 0.01703137531876564, -0.014356361702084541, 0.01664154976606369, -0.04384873807430267, 0.0030362762045115232, -0.023443346843123436, -0.023497115820646286, 0.04707488417625427, -0.006375004071742296, 0.01998867839574814, -0.01623828150331974, -0.011183981783688068, 0.014100957661867142, -0.002792635001242161, 0.000870388001203537, 0.00900633167475462, -0.024007922038435936, 0.06661996990442276, -0.013475891202688217, 0.00025624356931075454, 0.003699989290907979, -0.01730022206902504, 0.012319855391979218, -0.012870988808572292, 0.024559056386351585, -0.001776062068529427, 0.007453747559338808, 0.010296790860593319, 0.007312603294849396, -0.013536381535232067, 0.003568926826119423, 0.013233930803835392, -0.025620996952056885, -0.012198874726891518, 0.026884572580456734, -0.020351620391011238, -0.008898792788386345, -0.01666843518614769, 0.040138665586709976, 0.01807987503707409, -0.012870988808572292, 0.03242279216647148, 0.022193213924765587, -0.01631893590092659, 0.0005654161213897169, 0.00403268588706851, 0.025741977617144585, -0.007688987534493208, -0.03710070997476578, -0.029062222689390182, 0.008381265215575695, -0.03376702219247818, -0.007151295896619558, -0.00840814970433712, 0.03099791146814823, -0.0017273337580263615, -0.03513813391327858, 0.00019711852655746043, 0.0077024297788739204, 0.0075007956475019455, 0.005013972520828247, -0.006331316661089659, 0.01875198818743229, 0.006489263381808996, -0.0013089425629004836, -0.0034361842554062605, 0.007218507584184408, 0.015512397512793541, -0.003212706418707967, 0.001828150823712349, -0.022327637299895287, -0.014988148584961891, 0.005017333198338747, -0.008199794217944145, 0.043230392038822174, 0.03357883170247078, 0.03516501933336258, -0.020365063101053238, 0.03320244699716568, -0.027906185016036034, 0.013159997761249542, 0.02004244737327099, -0.025365592911839485, -0.005050939042121172, 0.004778732545673847, 0.013267535716295242, 0.012460999190807343, -0.023981038480997086, 0.0026918177027255297, -0.01005482953041792, 0.005235770251601934, 0.006848844699561596, 0.008072092197835445, -0.01637270487844944, 0.022327637299895287, 0.029788104817271233, 0.01974671706557274, -0.013368353247642517, -0.003031235421076417, -0.0059549324214458466, 0.03828363120555878, -0.020889312028884888, -0.03070218116044998, 0.01626516506075859, 0.007386535871773958, -0.028578300029039383, 0.022260425612330437, -0.010901694186031818, 0.023658422753214836, 0.03314867615699768, 0.03150871768593788, -0.03761151432991028, -0.030298912897706032, 0.0005364312091842294, 0.03745020925998688, 0.023026635870337486, 0.01842937432229519, -0.004540131893008947, -0.00432169483974576, -0.004657751880586147, 0.03226148709654808, -0.012830661609768867, -0.006879089865833521, -0.026266226544976234, 0.00858289934694767, -0.0034395449329167604, -0.0010535391047596931, 0.029788104817271233, -0.00865683238953352, 0.024021364748477936, 0.027986839413642883, -0.013731295242905617, 0.01763627864420414, 0.014799957163631916, 0.06430789828300476, -0.003518518293276429, -0.00437546381726861, -0.00870388001203537, -0.006845484022051096, 0.01916869916021824, -0.0014551274944096804, -0.014557995833456516, 0.023981038480997086, 0.012373624369502068, -0.024142345413565636, -0.013469170778989792, 0.011257914826273918, -0.014383246190845966, -0.013670804910361767, 0.03148183226585388, -0.007191623095422983, -0.01922246813774109, 0.029680566862225533, 0.03360571339726448, -0.03917082026600838, -0.011036116629838943, -0.027099648490548134, 0.009900243952870369, 0.020607024431228638, -0.015337647870182991, 0.03473486751317978, -0.03411652147769928, -0.04659096151590347, 0.00928861927241087, -0.029169760644435883, 0.029626797884702682, 0.03408963605761528, 0.002372563350945711, 0.003992358688265085, -0.010760549455881119, 0.028900913894176483, 0.0033689728006720543, -0.023268597200512886, 0.012118220329284668, -0.03677809238433838, -0.01782447099685669, 0.01779758557677269, 0.027422262355685234, -0.01611730083823204, -0.0004297330742701888, 0.008260284550487995, 0.022704020142555237, -0.02010965906083584, -0.028632069006562233, -0.029411721974611282, 0.0032883191015571356, 0.01715235598385334, -0.014450456947088242, -0.0007762919995002449, 0.01648024283349514, 0.0059347692877054214, -0.010619405657052994, -0.03314867615699768, -0.03322933241724968, -0.009631398133933544, -0.0015475432155653834, 0.015364532358944416, -0.012803777121007442, -0.0059045241214334965, 0.007312603294849396, 0.022542713209986687, 0.010128762573003769, 0.022569598630070686, 0.022502386942505836, 0.014114400371909142, 0.010706780478358269, 0.012340018525719643, 0.0011946831364184618, 0.0028363224118947983, 0.014208496548235416, 0.00012570637045428157, 0.028040608391165733, 0.05618875473737717, 0.008724043145775795, -0.006983267609030008, 0.013079344294965267, 0.019787045195698738, -0.030863488093018532, 0.004956842865794897, -0.005413880571722984, 0.008569457568228245, 0.003237910568714142, -0.024841343984007835, 0.014826841652393341, -0.023792846128344536, 0.007164738141000271, -0.0011081484844908118, 0.013502775691449642, -0.015068802051246166, 0.043418582528829575, 0.005255933851003647, 0.014463899657130241, 0.014463899657130241, -0.010276627726852894, 0.03390144556760788, -0.05202164500951767, 0.012629027478396893, -0.012306412681937218, -0.028954682871699333, 0.043445467948913574, -0.01665499247610569, -0.020660793408751488, 0.03750397637486458, 0.0051483954302966595, 0.006378364749252796, -0.00918780267238617, 0.03309490904211998, -0.008925678208470345, -0.009954012930393219, -0.006220417562872171, -0.01682974211871624, -0.007924227975308895, -0.01791856624186039, 0.00221797707490623, -0.0016693638172000647, -0.011540202423930168, -0.015606493689119816, -0.05008595809340477, 0.013993419706821442, 0.014410130679607391, 0.01547207124531269, -0.021319465711712837, 0.07979340851306915, 0.009691888466477394, 0.01672220416367054, -0.010142204351723194, 0.01857723854482174, -0.010673174634575844, 0.020445717498660088, -0.022811559960246086, -0.03774593770503998, 0.040488164871931076, -0.025110190734267235, -0.01807987503707409, -0.01622483879327774, -0.023994481191039085, 0.023739077150821686, -0.020029006525874138, -0.022475501522421837, 0.007534401025623083, 0.015391416847705841, -0.01841593161225319, 0.012669354677200317, -0.006674095056951046, 0.007312603294849396, 0.013449006713926792, -0.03218083083629608, -0.01915525645017624, 0.025647880509495735, -2.653013689268846e-05, -0.029922528192400932, 0.012924757786095142, 0.03723513334989548, 0.04659096151590347, -0.004886270966380835, -0.0021507658530026674, -0.023833172395825386, 0.03199264034628868, -0.0010955462930724025, -0.027852416038513184, 0.013926208019256592, -0.0009048338397406042, 0.020297851413488388, -0.010989069007337093, -0.0030850046314299107, 0.0023507196456193924, 0.011681346222758293, -0.014329476282000542, 0.020230639725923538, 0.0058507551439106464, -0.03266475349664688, -0.007971275597810745, 0.01731366477906704, 0.014262265525758266, -0.008260284550487995, -0.01861756667494774, 0.00842159241437912, -0.02021719701588154, -0.040165551006793976, 0.027328167110681534, 0.014356361702084541, 0.03613286465406418, 0.04917187988758087, -0.013590151444077492, 0.012340018525719643, -0.010787433944642544, 0.022300751879811287, 0.00924829300493002, 0.025983938947319984, -0.022260425612330437, 0.030083835124969482, 0.022421732544898987, 0.05059676244854927, -0.01779758557677269, 0.020499486476182938, -0.009967454709112644, -0.006821960210800171, -0.022583039477467537, -0.006838763132691383, -0.012776892632246017, 0.013993419706821442, -0.024007922038435936, 0.03884820640087128, -0.00904665794223547, 0.03064841218292713, 0.013953092508018017, -0.021198485046625137, 0.025849515572190285, 0.010390887036919594, 0.026427533477544785, 0.04731684550642967, 0.010579079389572144, 0.023066962137818336, -0.006196893751621246, -0.006314513739198446, 0.019733276218175888, 0.0010098516941070557, -0.023456789553165436, 0.022246982902288437, 0.009389436803758144, 0.03538009524345398, 0.01703137531876564, 0.0041066184639930725, 0.025755420327186584, 0.00941632129251957, 6.542612391058356e-05, 0.008025044575333595, 0.03468109667301178, 0.041294701397418976, 0.005131592508405447, 0.012756729498505592, -0.01639958843588829, 0.027717992663383484, 0.005326505750417709, -0.03879443556070328, -0.014302591793239117, 0.004489723592996597, -0.027959953993558884, -0.045058540999889374, 0.01579468511044979, 0.011930028907954693, -0.01742120273411274, 0.005360111594200134, -0.011318405158817768, -0.008139303885400295, 4.0116821764968336e-05, -0.012272806838154793, 0.01609041541814804, 0.05081184208393097, 0.010041387751698494, -0.01598287746310234, -0.04798896238207817, -0.0025439525488764048, -0.00793094839900732, -0.0021104388870298862, 0.021615196019411087, -0.020566698163747787, 0.006697618868201971, 0.01571403257548809, 0.003985637798905373, -0.01559305191040039, -0.005723053123801947, 0.0043082525953650475, -0.026400649920105934, 0.039896704256534576, -0.024249883368611336]",Token-level Direct Preference Optimization.pdf
" R.
So, Daniel Sohn, Simon Tokumine, Dasha Valter,
Vijay Vasudevan, Kiran V odrahalli, Xuezhi Wang,
Pidong Wang, Zirui Wang, Tao Wang, John Wiet-
ing, Yuhuai Wu, Kelvin Xu, Yunhan Xu, Linting
Xue, Pengcheng Yin, Jiahui Yu, Qiao Zhang, Steven
Zheng, Ce Zheng, Weikang Zhou, Denny Zhou, Slav
Petrov, and Yonghui Wu. 2023. PaLM 2 technical
report. Technical report, Google.
Mohammad Gheshlaghi Azar, Mark Rowland, Bilal
Piot, Daniel Guo, Daniele Calandriello, Michal
Valko, and Rémi Munos. 2023. A general theo-
retical paradigm to understand learning from hu-
man preferences. Computing Research Repository ,
arXiv:2310.12036.
Sid Black, Leo Gao, Phil Wang, Connor Leahy,
and Stella Biderman. 2021. GPT-Neo: Large
Scale Autoregressive Language Modeling with Mesh-
Tensorflow.
Ralph Allan Bradley and Milton E. Terry. 1952. Rank
analysis of incomplete block designs: I. the method
of paired comparisons. Biometrika , 39(3/4):324–
345.
Kawin Ethayarajh, Winnie Xu, Dan Jurafsky, and
Douwe Kiela. 2023. Human-centered loss functions
(HALOs). Technical report, Contextual AI.
Samuel Gehman, Suchin Gururangan, Maarten Sap,
Yejin Choi, and Noah A. Smith. 2020. RealToxi-
cityPrompts: Evaluating neural toxic degenerationin language models. In Findings of the Association
for Computational Linguistics: EMNLP 2020 , pages
3356–3369, Online. Association for Computational
Linguistics.
Kevin Gimpel and Noah A. Smith. 2010. Softmax-
margin CRFs: Training log-linear models with cost
functions. In Human Language Technologies: The
2010 Annual Conference of the North American
Chapter of the Association for Computational Lin-
guistics , pages 733–736, Los Angeles, California.
Association for Computational Linguistics.
Amelia Glaese, Nat McAleese, Maja Tr˛ ebacz, John
Aslanides, Vlad Firoiu, Timo Ewalds, Maribeth Rauh,
Laura Weidinger, Martin Chadwick, Phoebe Thacker,
Lucy Campbell-Gillingham, Jonathan Uesato, Po-
Sen Huang, Ramona Comanescu, Fan Yang, Abigail
See, Sumanth Dathathri, Rory Greig, Charlie Chen,
Doug Fritz, Jaume Sanchez Elias, Richard Green,
Soˇna Mokrá, Nicholas Fernando, Boxi Wu, Rachel
Foley, Susannah Young, Iason Gabriel, William Isaac,
John Mellor, Demis Hassabis, Koray Kavukcuoglu,
Lisa Anne Hendricks, and Geoffrey Irving. 2022.
Improving alignment of dialogue agents via targeted
human judgements. Computing Research Repository ,
arXiv:2209.14375.
Ximing Lu, Sean Welleck, Jack Hessel, Liwei Jiang,
Lianhui Qin, Peter West, Prithviraj Ammanabrolu,
and Yejin Choi. 2022. QUARK: Controllable Text
generation with Reinforced Unlearning. In Ad-
vances in Neural Information Processing Systems ,
volume 35, pages 27591–27609. Curran Associates,
Inc.
Andrew L. Maas, Raymond E. Daly, Peter T. Pham,
Dan Huang, Andrew Y . Ng, and Christopher Potts.
2011. Learning word vectors for sentiment analysis.
InProceedings of the 49th Annual Meeting of the
Association for Computational Linguistics: Human
Language Technologies , pages 142–150, Portland,
Oregon, USA. Association for Computational Lin-
guistics.
Chris J. Maddison and Danny Tarlow. Gumbel machin-
ery [online]. 2017.
V olodymyr Mnih, Adria Puigdomenech Badia, Mehdi
Mirza, Alex Graves, Timothy Lillicrap, Tim Harley,
David Silver, and Koray Kavukcuoglu. 2016. Asyn-
chronous methods for deep reinforcement learning.
InProceedings of The 33rd International Conference
on Machine Learning , volume 48 of Proceedings of
Machine Learning Research , pages 1928–","[-0.007457932457327843, 0.018986498937010765, 0.04561462625861168, 0.005808369722217321, 0.02451198175549507, -0.01737000234425068, 0.008721739985048771, 0.06871584802865982, -0.05296234041452408, 0.0024596480652689934, 0.014298656024038792, -0.0219108909368515, -0.00857478566467762, 0.017384696751832962, 0.021690459921956062, 0.012086994014680386, -0.007884100079536438, -0.009743072092533112, 0.009853287599980831, 0.028082972392439842, -0.004478433169424534, -0.02529084123671055, 0.010786447674036026, 0.03088979981839657, 0.0057128495536744595, -0.013372844085097313, 0.017987210303544998, 0.05863477662205696, -0.02965538389980793, -0.02342452108860016, 0.022572185844182968, -0.03221238777041435, -0.022601576521992683, -0.013123021461069584, -0.022719139233231544, 0.014643998816609383, -0.0006888484349474311, 0.004390260670334101, -0.02642238885164261, -0.0007131877355277538, -0.012667463161051273, -0.06871584802865982, 0.015239164233207703, 0.05936954915523529, -0.030419547110795975, 0.021866803988814354, -0.01499668974429369, -0.003554457798600197, -0.00717137148603797, 0.05681254342198372, -0.04755442216992378, 0.011168529279530048, -0.028082972392439842, -0.0036481411661952734, -0.018810154870152473, -0.016444189473986626, 0.0025404728949069977, 0.013512451201677322, 0.0379142165184021, -0.015709418803453445, -0.010272108018398285, -0.02598152495920658, -0.006568858399987221, 0.029743555933237076, -0.04505619779229164, -0.045144371688365936, -0.08488082140684128, 0.0035911963786929846, 0.018927717581391335, 0.015577158890664577, 0.021646372973918915, 0.02251340262591839, 0.03147761896252632, -0.025261448696255684, 0.00123809021897614, 0.0027737629134207964, 0.00605819234624505, 0.07341838628053665, -0.025952134281396866, -0.03374071419239044, -0.0007081361836753786, 0.0023824970703572035, 0.021029165014624596, -0.04752502962946892, -0.0638369619846344, -0.044968023896217346, -0.0332704596221447, 0.005110336933284998, -0.03136005252599716, -0.0036426305305212736, -0.04502680525183678, -0.019780052825808525, -0.03712066262960434, 0.016341321170330048, 0.04755442216992378, 0.019500840455293655, 0.02942025661468506, -0.0021767609287053347, 0.02574639953672886, 0.02947903797030449, -0.041735030710697174, -0.02715715952217579, 0.01613558642566204, -0.010654188692569733, 0.01378431636840105, 0.012924632988870144, -0.018251728266477585, -0.03315289691090584, 0.0013923923252150416, -0.0016284376615658402, -0.1414288431406021, 0.007641625124961138, -0.04464472457766533, 0.001075522042810917, -0.027039596810936928, -0.03388766944408417, -0.0544612742960453, -0.022043149918317795, -0.0252467542886734, -0.003008889965713024, -0.017752083018422127, 0.017134875059127808, 0.012696853838860989, -0.018016600981354713, 0.006708465050905943, -0.02133776806294918, -0.0008518758695572615, -0.06812802702188492, -0.030595891177654266, -0.018766067922115326, -0.01151387207210064, 0.009669595398008823, 0.022675054147839546, -0.02360086515545845, -0.02842096798121929, -0.02072056010365486, -0.015929849818348885, 0.017796169966459274, -0.03829629719257355, -0.04358665645122528, 0.028553226962685585, 0.006947265937924385, -0.06718751788139343, 0.014026790857315063, -0.04161746799945831, 0.004258001688867807, -0.019941702485084534, 0.0009317822987213731, -0.029346780851483345, 0.016267843544483185, 0.004191872198134661, 0.016796879470348358, -0.01440152432769537, 0.0004821938928216696, -0.026863250881433487, -0.06125056371092796, -0.011212615296244621, 0.07700406759977341, -0.004221263341605663, -0.055372390896081924, 0.020867515355348587, 0.04470350593328476, 0.013071587309241295, -0.007028090767562389, 0.05343259498476982, 0.025041017681360245, -0.022557489573955536, 0.03403462469577789, -0.06266132742166519, -0.04482107236981392, 0.014680737629532814, -0.02870018035173416, -0.017869647592306137, -0.027686195448040962, -0.01911875791847706, -0.029464343562722206, -0.028905916959047318, -0.011286092922091484, -0.04011853411793709, -0.03914863243699074, 0.021029165014624596, 0.022616270929574966, -0.006161060184240341, 0.0014364785747602582, -0.03841386362910271, -0.02439441904425621, 0.01623845286667347, 0.00933894794434309, 0.00025900700711645186, 0.04746624827384949, 0.04082391411066055, 0.06183838099241257, 0.06836315244436264, 0.02224888652563095, -0.007972272112965584, -0.04232284799218178, 0.0705968588590622, -0.027068987488746643, 0.021661069244146347, -0.03570990264415741, 0.0149452555924654, 0.037385180592536926, -0.03306472301483154, -0.03688553720712662, 0.013674100860953331, -0.013519798405468464, 0.014695432968437672, -0.017355306074023247, -0.058487825095653534, -0.008523351512849331, 0.06213229149580002, 0.012902590446174145, 0.05654802545905113, 0.01335080061107874, -0.03767909109592438, -0.00922873243689537, -0.038355082273483276, -0.0058120437897741795, 0.015709418803453445, 0.040383052080869675, 0.0010130663868039846, 0.04582035914063454, 0.033417414873838425, 0.008302919566631317, -0.035504166036844254, 0.005775305442512035, 0.042411018162965775, -0.01525385957211256, 0.05419675633311272, 0.010110458359122276, 0.07471158355474472, -0.009316904470324516, -0.011866562068462372, -0.031771525740623474, -0.0007049215491861105, -0.026275433599948883, 0.012593986466526985, -0.009713681414723396, -0.003982462454587221, -0.01579759083688259, 0.01941266655921936, -0.004827449563890696, 0.02993459813296795, 0.04746624827384949, 0.01152121927589178, 0.054696403443813324, -0.03570990264415741, -0.06083909422159195, 0.014129659160971642, -0.003262386191636324, 0.009948807768523693, -0.019838834181427956, 0.02999337948858738, 0.007773884106427431, -0.022057844325900078, -0.027260027825832367, -0.025041017681360245, -0.022792616859078407, -0.01256459578871727, -0.017164265736937523, -0.021808022633194923, 0.003616913454607129, -0.013505103066563606, 0.0332704596221447, 0.01075705699622631, -0.0021969673689454794, -0.018633808940649033, 0.04420386254787445, 0.010639493353664875, -0.023512693122029305, -0.0012785026337951422, 0.00939772929996252, 0.010676232166588306, 0.02897939458489418, -0.0646011233329773, -0.01941266655921936, 0.012344163842499256, 0.038119953125715256, -0.03979523107409477, 0.0325944721698761, 0.007898795418441296, 0.03988340497016907, 0.06125056371092796, 0.011337527073919773, 0.004757646471261978, 0.03100736439228058, -0.004438020754605532, 0.004096352029591799, -0.04702538624405861, 0.003387297270819545, 0.03523964807391167, -0.03332924097776413, 0.004250654019415379, -0.039354369044303894, 0.05737097188830376, 0.006127995438873768, 0.037150055170059204, -0.003240342950448394, -0.016047412529587746, -0.02002987451851368, 0.0352984294295311, -0.021352464333176613, 0.004085330292582512, -0.017781473696231842, 0.017237743362784386, 0.05631290003657341, -0.009934112429618835, -0.0024890389759093523, 0.03532782196998596, -0.008354353718459606, -0.026642819866538048, 0.009184645488858223, -0.02270444482564926, -0.011411003768444061, -0.032682642340660095, -0.0638369619846344, 0.061720818281173706, -0.004081656690686941, 0.02981703355908394, -0.05134584382176399, -0.03903106972575188, -0.03697371110320091, 0.025055713951587677, 0.015885762870311737, -0.012344163842499256, 0.028141753748059273, 0.01434274297207594, 0.007134632673114538, 0.00519483583047986, -0.045467671006917953, -0.0039677671156823635, 0.022116627544164658, 0.043204572051763535, 0.019368581473827362, 0.0052352482452988625, -0.03450487554073334, -0.017693301662802696, 0.04220528528094292, 0.018354596570134163, 0.002055523684248328, -0.08352883905172348, -0.0077591887675225735, -0.03244751691818237, -0.0203090887516737, -0.00043030065717175603, 0.01152121927589178, -0.019045282155275345, 0.024996932595968246, 0.0219108909368515, 0.019059976562857628, -0.00995615590363741, -0.04076513275504112, 0.02320408821105957, 0.008332310244441032, -0.008082488551735878, 0.002301672240719199, -3.6939498386345804e-05, -0.017384696751832962, 0.0015999652678146958, 0.019677184522151947, -0.017120178788900375, 0.015026080422103405, 0.021176118403673172, -0.01242498867213726, 0.023689039051532745, 0.00914055947214365, -0.04805406555533409, -0.012219252996146679, -0.0013299366692081094, 0.002937249606475234, -0.015400813892483711, -0.011998821049928665, -0.03826690837740898, 0.013461017049849033, -0.04843614622950554, 0.0062418850138783455, 0.0017386534018442035, 0.00778123177587986, 0.015011385083198547, 0.04493863508105278, -0.00029804176301695406, -0.00933894794434309, 0.022792616859078407, -0.0392661988735199, -0.0009809201583266258, 0.04217589274048805, -0.02183741331100464, 0.005801022052764893, -0.009654899127781391, 0.0073624118231236935, -0.007134632673114538, -0.004515171982347965, -0.04714294895529747, 0.022381145507097244, -0.00018369291501585394, 0.0038869420532137156, -0.007972272112965584, 0.016267843544483185, 0.031036755070090294, 0.025775790214538574, -0.025908049196004868, 0.01782556064426899, 0.00524994358420372, 0.008560089394450188, 0.015048123896121979, 0.018486855551600456, 0.026672210544347763, 0.04311640188097954, 0.012064950540661812, 0.023497996851801872, 0.041852593421936035, -0.047789547592401505, -0.0022134995087981224, -0.00268007954582572, 0.012726245447993279, -0.042411018162965775, 0.01335080061107874, 0.017472870647907257, 0.038590207695961, 0.049935080111026764, 0.003304635640233755, 0.013674100860953331, -0.032124217599630356, -0.05025838315486908, -0.024820586666464806, 0.023924164474010468, 0.03644467517733574, -0.05795878916978836, 0.02490875869989395, -0.04817162826657295, -0.06336671113967896, 0.019089367240667343, 0.05178670585155487, -0.051698531955480576, -0.02286609448492527, -0.048583101481199265, 0.05998675897717476, 0.047348685562610626, 0.0012417640537023544, -0.04532071575522423, -0.0018791785696521401, -0.002663547173142433, -0.02122020535171032, 0.016458885744214058, 0.004074309021234512, -0.013799011707305908, -0.024365028366446495, 0.022101931273937225, 0.02105855569243431, -0.04770137742161751, 0.021132033318281174, 0.005481396336108446, 0.0630728006362915, -0.021425941959023476, -0.012902590446174145, -0.018486855551600456, 0.09616691619157791, -0.0008353435550816357, 0.05046411603689194, 0.011300788260996342, 0.013666752725839615, 0.006289645563811064, -0.042587365955114365, -0.0195890124887228, -0.020220916718244553, 0.017752083018422127, -0.005521809216588736, 0.0015117926523089409, 0.03168335556983948, -0.0030033790972083807, 0.01369614340364933, -0.017472870647907257, -0.03632711246609688, -0.061544474214315414, -0.015444899909198284, -0.002219010377302766, -0.01304219663143158, -0.026304826140403748, -0.00995615590363741, -0.02864139899611473, 0.03459304943680763, -0.01776677928864956, 0.01415170170366764, 0.022851398214697838, 0.0325944721698761, 0.05172792449593544, 0.0011480806861072779, -0.015150991268455982, -0.0020591975189745426, 0.007788579445332289, 0.008721739985048771, -0.0009515293058939278, 0.0485537126660347, -0.018383987247943878, 0.006300666835159063, -0.006671726703643799, 0.006903179921209812, -0.0076636685989797115, -0.0014162723673507571, -0.03606259450316429, -0.018751373514533043, -0.006767246872186661, -0.009419772773981094, 0.006958287674933672, 0.002861935645341873, -0.015048123896121979, 0.016370711848139763, 0.013086283579468727, 0.01986822485923767, 0.06554163247346878, -0.016943834722042084, -0.006186777260154486, -0.004768668208271265, 0.02824462205171585, 0.03088979981839657, 0.04840675741434097, -0.0169732253998518, -0.02127898670732975, -0.014563173986971378, 0.026187261566519737, -0.019956398755311966, -0.023894773796200752, -0.03156578913331032, -0.031771525740623474, 0.008640914224088192, -0.003018074668943882, -0.0008096265373751521, -0.05416736751794815, -0.01714957132935524, -0.03444609418511391, 0.016047412529587746, -0.0004803569754585624, 0.013909227214753628, -0.00652109831571579, -0.053961630910634995, 0.0042984141036868095, -0.00808983575552702, -0.036532845348119736, -0.015327337197959423, -0.009897374548017979, -0.0020812407601624727, 0.014937907457351685, -0.0025882332120090723, 0.019059976562857628, -0.004728255793452263, -0.007553452625870705, 0.02229297161102295, -0.019030585885047913, -0.0055658952333033085, 0.025511272251605988, 0.04358665645122528, -0.029449647292494774, 0.010264759883284569, -0.0372382290661335, -0.002230031881481409, -0.010367628186941147, 0.02304243855178356, 0.0009689801372587681, -0.01236620731651783, -0.010367628186941147, 0.023233478888869286, -0.02116142399609089, 0.0058157178573310375, -0.0026855904143303633, -0.030155029147863388, -0.004963382612913847, 0.02451198175549507, -0.009581422433257103, 0.024864673614501953, 0.03644467517733574, -0.018824849277734756, -0.02919982559978962, 0.02914104424417019, -0.018134163692593575, 0.010690927505493164, -0.02008865773677826, 0.02410051040351391, 0.02268974855542183, -0.01035293284803629, 0.014768910594284534, -0.048024676740169525, -0.03294716030359268, 0.0013317735865712166, 0.002661710372194648, -0.03582746535539627, 0.020294392481446266, -0.007035438437014818, 0.004390260670334101, -0.032800205051898956, 0.02602561190724373, 0.05983980372548103, -0.02943495288491249, -0.02070586569607258, -0.02490875869989395, -0.02343921549618244, -0.019206931814551353, 0.02648117020726204, -0.057253409177064896, -0.03162457048892975, 0.037091273814439774, 0.004893579054623842, -0.01579759083688259, -0.03271203488111496, -0.04170563817024231, -0.0031025733333081007, 0.013380192220211029, -0.005676111206412315, 0.0002274347934871912, 0.007832665927708149, -0.005393223837018013, -0.012402945198118687, -0.007546104956418276, 0.0042469799518585205, -0.02608439326286316, -0.03165396302938461, -0.00249822367914021, -0.03265325352549553, -0.00828822422772646, 0.04535010829567909, -0.011396308429539204, 0.01737000234425068, -0.025717008858919144, 0.0070831989869475365, 0.00595899811014533, 0.009698986075818539, 0.02462954632937908, -8.886144496500492e-05, -0.0039053114596754313, -0.02467363141477108, -0.01810477301478386, -0.017781473696231842, -0.013505103066563606, 0.030742846429347992, -0.006903179921209812, -0.0004886231618002057, 0.004463737830519676, 0.01867789588868618, 0.0015669005224481225, 0.028318099677562714, -0.026613429188728333, 0.001689974800683558, 0.00908177811652422, -0.0014814833411946893, 0.0028821418527513742, 0.02693672850728035, -0.013776968233287334, -0.023674342781305313, -0.00874378252774477, -0.032800205051898956, -0.002004089765250683, -0.032565079629421234, -0.05925198644399643, 0.021969672292470932, -0.0013317735865712166, 0.014041486196219921, -0.013123021461069584, 5.6169847084674984e-05, -0.018428072333335876, 0.005363833159208298, -0.017561042681336403, -0.048759445548057556, 0.0006557836895808578, 0.0030970624648034573, 0.002997868461534381, -0.02484997734427452, 0.035504166036844254, 0.023747820407152176, 0.05660680681467056, 0.010095763020217419, 0.0010654189391061664, 0.001021332573145628, 0.008824607357382774, 0.03227117285132408, 0.006715812720358372, 0.012895242311060429, -0.029346780851483345, -0.004511497914791107, -0.027598023414611816, 0.008912780322134495, 0.01986822485923767, -0.0203090887516737, 0.04202893748879433, -0.06004554033279419, -0.003638956695795059, 0.03632711246609688, -0.010786447674036026, 0.04487985372543335, -0.009728376753628254, 0.02852383628487587, -0.004581301473081112, -0.0009451000369153917, -0.021176118403673172, -0.0064402734860777855, -0.01764921471476555, -0.017928428947925568, 0.017120178788900375, -0.0018773415358737111, 0.030860409140586853, -0.020808733999729156, -0.13049544394016266, -0.026907337829470634, 0.001945307943969965, -0.014901169575750828, 0.008229442872107029, -0.030081551522016525, -0.009515292942523956, 0.0032715708948671818, 0.005819391459226608, 0.04085330292582512, -0.0008904514252208173, -0.022263580933213234, -0.016458885744214058, -0.006385165732353926, 0.019206931814551353, -0.03735579177737236, -0.008104531094431877, 0.035621728748083115, 0.012571942992508411, -0.011124443262815475, -0.03509269282221794, -0.03435792401432991, 0.01429130882024765, -0.007424867711961269, 0.023409824818372726, -0.012329468503594398, -0.03538660332560539, -0.0005180140142329037, -0.0022373797837644815, 0.012527856975793839, 0.0017827397678047419, 0.008369049057364464, 0.011418351903557777, 0.014585217460989952, -0.021381855010986328, -0.002714981324970722, -0.005587938241660595, -0.04408629983663559, 0.005621002987027168, -0.021249596029520035, -0.00034488344681449234, -0.011947386898100376, -0.030419547110795975, 0.0007641625124961138, 0.04152929410338402, 0.009544683620333672, 0.012153123505413532, 0.022278277203440666, 0.009603465907275677, 0.0007857464370317757, 0.01171226054430008, -0.02427685633301735, 0.01474686712026596, 0.0002748505212366581, -0.012006169185042381, 0.007803274784237146, -0.01590045914053917, 0.002880304818972945, 0.016826270148158073, -0.01036028005182743, 0.025672921910881996, 0.020338479429483414, 0.027877235785126686, -0.003488328540697694, 0.03197726234793663, 0.02693672850728035, -0.02461485005915165, 0.010779100470244884, -0.002465158933773637, -0.017913732677698135, 0.02830340340733528, -0.01845746487379074, -0.026172567158937454, 0.011095051653683186, 0.01873667724430561, 0.052374523133039474, -0.0059112380258738995, -0.0009060652810148895, 0.019221626222133636, -0.007127285003662109, 0.019221626222133636, -0.01764921471476555, 0.0015448573976755142, 0.030831018462777138, -0.03747335448861122, -0.04217589274048805, -0.043204572051763535, -0.016209062188863754, -0.009390382096171379, 0.007505692541599274, -0.042646147310733795, -0.06101543828845024, 0.015371423214673996, -0.003978788387030363, 0.004676821641623974, 0.004404956009238958, 0.04367482662200928, 0.006102278828620911, -0.09446224570274353, -0.03703249245882034, 0.0001137173967435956, -0.012645420618355274, 0.022968962788581848, -0.011219963431358337, 0.017913732677698135, 0.020191526040434837, 0.033476196229457855, -0.024747109040617943, 0.038002390414476395, 0.00671948678791523, -0.0037767263129353523, 0.0046915169805288315, 0.0010892989812418818, -0.0406181775033474, 0.007178719155490398, -0.0379142165184021, 0.051757317036390305, 0.0036720214411616325, -0.041000258177518845, -0.011903300881385803, -0.0051360540091991425, 0.02507040835916996, -0.02908226288855076, -0.019030585885047913, 0.022733835503458977, 0.03368193283677101, 0.009875331073999405, 0.017957819625735283, -0.016605839133262634, -0.06101543828845024, -0.012748287990689278, 0.05019959807395935, -0.060016147792339325, 0.00031732951174490154, -0.016708707436919212, -0.012520508840680122, -0.001330855186097324, -0.010690927505493164, -0.008053096942603588, -0.0690685361623764, 0.03606259450316429, -0.009434468112885952, 0.023556780070066452, -0.023630255833268166, 0.017561042681336403, -0.026348911225795746, 0.02620195783674717, -0.011565306223928928, 0.024600155651569366, -0.0055695693008601665, -0.0026874274481087923, 0.006649683695286512, -0.013674100860953331, -0.009434468112885952, 0.038795944303274155, 0.0032770815305411816, 0.05281538516283035, 0.03062528185546398, -0.024365028366446495, 0.01016189157962799, 0.010419062338769436, 0.001371267600916326, -0.02993459813296795, -0.027362896129488945, -0.023865383118391037, 0.0379142165184021, -0.025952134281396866, -0.02332165278494358, -0.040206704288721085, 0.049552999436855316, 0.0016973224701359868, 0.038560815155506134, 0.011778390035033226, -0.02251340262591839, 0.03944254294037819, 0.032741423696279526, -0.02291017957031727, 0.0006534875137731433, 0.022146018221974373, -0.037884827703237534, -0.016106193885207176, -0.0068370504304766655, -0.04837736487388611, 0.03197726234793663, 0.012086994014680386, 0.003242179984226823, -0.01947144977748394, 0.023233478888869286, 0.04831858351826668, -0.02377721108496189, 0.003725292393937707, -0.01844276860356331, 0.017472870647907257, -0.010169239714741707, -0.016400102525949478, 0.01669401116669178, 0.038590207695961, 0.01816355623304844, 0.024379722774028778, 0.016458885744214058, -0.06219107285141945, -0.0004927562549710274, -0.0003200849168933928, 0.011477133259177208, 0.01810477301478386, -0.010286803357303143, 0.009544683620333672, -0.011043618433177471, -0.0004348929796833545, 0.02304243855178356, -0.04079452157020569, -0.012917285785079002, 0.015694722533226013, 0.019339190796017647, 0.01188125740736723, 0.042587365955114365, 0.020397260785102844, 0.019706575199961662, 0.012307425029575825, 0.020470738410949707, -0.025672921910881996, 0.003056650049984455, -0.04155868664383888, -0.02336573787033558, 0.02421807311475277, 0.014306004159152508, -0.01352714654058218, -0.012638072483241558, 0.03403462469577789, -0.0054042455740273, 0.00031870719976723194, -0.0010194956557825208, -0.015929849818348885, 0.0249528456479311, 0.02201375924050808, 0.023409824818372726, -0.02711307443678379, 0.027803760021924973, 0.008207399398088455, -0.012579291127622128, 0.0006635906756855547, -0.007002373691648245, 0.01010311022400856, -0.006153712514787912, -0.014570522122085094, -0.021749241277575493, -0.0050735981203615665, -0.022043149918317795, 0.016282539814710617, -0.019427362829446793, -0.020808733999729156, 0.04244041070342064, -0.012909937649965286, 0.0019526557298377156, 0.010735013522207737, -0.03379949554800987, -0.013446321710944176, 0.04396873712539673, 0.023174697533249855, 0.02564353123307228, -0.01590045914053917, 0.001420864718966186, -0.005609981715679169, -0.04978812858462334, -0.02840627171099186, -0.034210968762636185, -0.03823751583695412, 0.027362896129488945, -0.020132742822170258, -0.008596828207373619, 0.01641479879617691, 0.036415282636880875, 0.007884100079536438, 0.03973644971847534, 0.0005616410635411739, -0.030081551522016525, 0.007094220258295536, 0.02111733704805374, 0.04076513275504112, -0.0023218784481287003, -0.011763693764805794, -0.003589359577745199, 0.03265325352549553, -0.017854951322078705, -0.00510666286572814, 0.0026708950754255056, -0.030066857114434242, 0.037091273814439774, 0.009331599809229374, 0.01182982325553894, 0.003471796168014407, 0.05143401771783829, 0.016547057777643204, -0.04158807545900345, 0.03368193283677101, 0.03162457048892975, -0.029699470847845078, -0.044674117118120193, 0.006576206535100937, 0.041117820888757706, -4.885083399130963e-05, 0.003975114785134792, -0.034769393503665924, 0.03688553720712662, 0.00015464647731278092, -0.02665751613676548, 7.433822611346841e-05, 0.00857478566467762, -0.020676475018262863, 0.02399764209985733, -0.031947869807481766, 0.038119953125715256, -0.012652767822146416, 0.0004918377962894738, 0.02564353123307228, 0.016664620488882065, -0.023968251422047615, -0.017472870647907257, -0.035562947392463684, -0.017340611666440964, -0.03033137321472168, 0.020059267058968544, 0.009728376753628254, 0.012998110614717007, 0.00037427429924719036, -0.00778123177587986, -0.014283960685133934, 0.003212789073586464, 0.00469886464998126, -0.017752083018422127, 0.0012509487569332123, -0.007222805172204971, 0.018545636907219887, -0.02094099298119545, -0.00687378877773881, -0.026113783940672874, 0.0035709901712834835, 0.0005368425627239048, 0.027024902403354645, 0.02077934332191944, 0.0036573258694261312, -0.012777678668498993, 0.0024706698022782803, 0.010859925299882889, -0.00017955982184503227, 0.024717718362808228, -0.019001195207238197, -0.009743072092533112, 0.01171960774809122, -0.016032718122005463, 0.04749564081430435, 0.028832439333200455, 0.005826739128679037, -0.009529988281428814, 0.019838834181427956, 0.029640689492225647, 0.02026500180363655, 0.029978683218359947, -0.012814417481422424, 0.02614317461848259, 0.009676942601799965, -0.017414087429642677, 0.01358592789620161, -0.014607260935008526, -0.005951650440692902, 0.005529156886041164, 0.0039163329638540745, 0.006161060184240341, -0.04555584117770195, 0.008479264564812183, 0.004122069105505943, -0.004434347152709961, -0.007432215381413698, -0.018648505210876465, -0.005415267311036587, -0.017516955733299255, 0.024526678025722504, 0.01516568660736084, -0.029126347973942757, -0.016826270148158073, 0.0019085693638771772, 0.00185713532846421, 0.009853287599980831, -0.027318811044096947, -0.007825317792594433, -0.01657644845545292, 0.02761271968483925, -0.008045749738812447, 0.01810477301478386, 0.032682642340660095, -0.017061397433280945, 0.010580711998045444, -0.016664620488882065, -0.002121653174981475, -0.0017166102770715952, -0.0065431417897343636, 0.03362315148115158, -0.02094099298119545, 0.03027259185910225, 0.021969672292470932, 0.013174455612897873, -0.01106566097587347, 0.019559621810913086, -0.0016660947585478425, 0.003471796168014407, -0.05660680681467056, -0.004919296130537987, 0.003716107690706849, -0.004129416774958372, 0.03141883760690689, 0.010066371411085129, 0.004573953337967396, 0.023556780070066452, -0.0026378303300589323, -0.00975776743143797, -0.01895710825920105, -0.0034846544731408358, 0.002252075122669339, -0.00854539405554533, -0.010073719546198845, 0.02370373345911503, 0.009191993623971939, -0.005529156886041164, 0.0008165150065906346, 0.012292729690670967, -0.006741529796272516, 0.02149941958487034, 0.03232995420694351, 0.014364785514771938, -0.004228611011058092, 0.013416930101811886, 0.00524994358420372, -0.014776257798075676, 0.002672731876373291, -0.022822007536888123, 0.004371891263872385, -0.010507234372198582, -0.03136005252599716, 0.021073251962661743, 0.008582132868468761, 0.012050255201756954, -0.002002252731472254, -0.010367628186941147, 0.010624798014760017, -0.006653357297182083, 0.007057481911033392, 0.02489406429231167, -0.02270444482564926, 0.07917899638414383, 0.009155254811048508, 0.0005373017629608512, -0.0033138201106339693, -0.03247690573334694, 0.026466475799679756, -0.01253520417958498, 0.011940039694309235, -0.030977973714470863, -0.005352811422199011, -0.0006493544788099825, 0.013255280442535877, -0.023130612447857857, -0.00012686291302088648, 0.00914055947214365, -0.020749950781464577, -0.011624087579548359, 0.017076093703508377, 0.0026212979573756456, 0.008427831344306469, 0.007406498305499554, 0.03197726234793663, -0.00027783552650362253, -0.03447548672556877, 0.0027370243333280087, 0.021719850599765778, -0.016106193885207176, 0.005767957307398319, 0.015856372192502022, 0.053168077021837234, 0.00803840160369873, -0.057253409177064896, -0.051816098392009735, 0.024203378707170486, -0.031271882355213165, 0.011219963431358337, -0.02902347967028618, 0.024541372433304787, -0.013578579761087894, -0.02943495288491249, 0.04176441952586174, 0.005576916970312595, 0.0007122692768462002, 0.0031484966166317463, 0.008751130662858486, 0.005621002987027168, -0.006903179921209812, 0.009691637940704823, 0.0032715708948671818, -0.004728255793452263, -0.019603706896305084, 0.0029335757717490196, 0.0016100683715194464, -0.01816355623304844, -0.003174213459715247, 0.0022575859911739826, -0.01550368219614029, 0.07306569069623947, 0.024041729047894478, 0.026907337829470634, -0.02842096798121929, 0.013718186877667904, -0.041176602244377136, 0.0030235853046178818, 0.008640914224088192, -0.07823848724365234, -0.026730993762612343, 0.0005758772604167461, 0.008795216679573059, 0.03767909109592438, -0.018237031996250153, 0.002869283314794302, 0.002413724781945348, 0.00701706949621439, 0.030742846429347992, 0.026451779529452324, -0.0006498136790469289, 0.018589721992611885, 0.035063304007053375, 0.0465257428586483, -0.012131080031394958, -0.009236079640686512, -0.013659405522048473, 0.011271397583186626, 0.015929849818348885, -0.020985078066587448, 0.025158582255244255, -0.004963382612913847, -0.029464343562722206, 0.012285382486879826, -0.004463737830519676, -0.007568147964775562, 0.038061171770095825, 0.02507040835916996, -0.011433047242462635, -0.004665799904614687, -0.01913345418870449, 0.025320231914520264, 0.020000483840703964, 0.014666042290627956, -0.005896542686969042, -0.0032219737768173218, 0.002336573787033558, 0.00424330634996295, -0.027024902403354645, 0.01227803435176611, -0.0445859432220459, 7.496967009501532e-05, 0.011418351903557777, 0.028435662388801575, 0.018589721992611885, 0.0006250151200219989, 0.02761271968483925, 0.01806068792939186, 0.002252075122669339, -0.0013418766902759671, 0.007766536436975002, -0.011866562068462372, -0.01556246355175972, -0.04361604526638985, 0.0182811189442873, 0.008420483209192753, 0.022425230592489243, -0.0030144008342176676, -0.009552031755447388, -0.012006169185042381, 0.032682642340660095, -0.004140438511967659, 0.007531409617513418, -0.02127898670732975, -0.019794749096035957, -0.0015053633833304048, -4.4689040805678815e-05, -0.0005464864079840481, 0.02433563768863678, 0.02761271968483925, 0.0019269386539235711, -0.03039015643298626, 7.158283551689237e-05, -0.00662029255181551, 0.004967056214809418, 0.018942413851618767, -0.0016045576194301248, 0.03429914265871048, -0.01766391098499298, -0.05119888857007027, 0.011234658770263195, -0.00368671678006649, 0.03232995420694351, -0.008876041509211063, -0.0070831989869475365, -0.0004679576959460974, 0.008170660585165024, 0.02338043414056301, 0.0005988389020785689, -0.013269975781440735, 0.006065540015697479, -0.03118370845913887, -0.009603465907275677, 0.002911532763391733, 0.016223758459091187, -0.02155820094048977, -0.014386828988790512, -0.002160228556022048, 0.020573606714606285, -0.03162457048892975, -0.03033137321472168, -0.010514582507312298, 0.0031815613619983196, 0.019780052825808525, 0.003960419446229935, 0.00806779321283102, 0.0021932933013886213, 0.0014089246978983283, 0.00975776743143797, -0.03541599214076996, -0.025041017681360245, -0.007457932457327843, 0.007009721826761961, 0.016164977103471756, -0.0216169822961092, -0.0021657394245266914, 0.008317614905536175, -0.0073624118231236935, -0.020632388070225716, 0.01072031818330288, -0.008273528888821602, 0.010147196240723133, -0.0014181092847138643, -0.02586396224796772, -0.012638072483241558, -0.006135343108326197, 0.01957431621849537, 0.009838592261075974, 0.020749950781464577, 0.039354369044303894, 0.0030235853046178818, 0.005257291253656149, 0.03747335448861122, 0.03230056166648865, -0.019662490114569664, -0.01619436778128147, -0.018428072333335876, 0.010911359451711178, 0.002005926566198468, 0.009405077435076237, 0.0032385061495006084, -0.0065872278064489365, -0.019647793844342232, 0.004313109442591667, -0.022954266518354416, -0.00591491162776947, 0.03712066262960434, 0.01889832690358162, 0.03156578913331032, -0.009427119977772236, 0.0024504633620381355, 0.03106614574790001, -0.039765842258930206, -0.020235611125826836, 0.010294150561094284, -0.0006213412852957845, 0.007766536436975002, 0.008861346170306206, -0.007479975465685129, 0.03911924362182617, 0.020926296710968018, -0.028450358659029007, -0.001897547859698534, 0.024526678025722504, -0.011925344355404377, -0.013630013912916183, 0.009287513792514801, 0.014724823646247387, -0.0017074256902560592, -0.009265470318496227, 0.008677653037011623, -0.029346780851483345, 0.005889195017516613, -0.00403389660641551, -0.03039015643298626, 0.029361475259065628, 0.022851398214697838, 0.04003036022186279, -0.052315741777420044, 0.07318325340747833, 0.03882533311843872, 0.01647358015179634, -0.02449728734791279, 0.014526436105370522, -0.006840724032372236, 0.028538530692458153, -0.016958529129624367, -0.06066274642944336, 0.008398439735174179, -0.026304826140403748, -0.006021453533321619, 0.0065872278064489365, -0.007505692541599274, -0.003106247168034315, -0.017502261325716972, -0.024409115314483643, 0.003920006565749645, 0.006903179921209812, -0.004489454906433821, 0.025055713951587677, -0.017634520307183266, 0.026760384440422058, 0.001617416157387197, -0.021190814673900604, -0.01061010267585516, 0.012579291127622128, -0.014974646270275116, -0.0141443544998765, -0.004562932066619396, 0.038619596511125565, 0.043880563229322433, 0.004985425621271133, 0.02552596665918827, -0.02213132195174694, 0.04623183235526085, -0.02405642345547676, -0.0034313835203647614, 0.0017974351067095995, 0.0054189409129321575, -0.020059267058968544, -0.03235934302210808, -0.013336105272173882, 0.03215360641479492, 0.016209062188863754, -0.015768200159072876, 0.022337058559060097, 0.024085814133286476, -0.02999337948858738, -0.0038795943837612867, 0.011455089785158634, 0.0033064724411815405, -0.02592274360358715, -0.013931270688772202, 0.023630255833268166, -0.005720197223126888, -0.023850688710808754, 0.036767974495887756, 0.005393223837018013, 0.013718186877667904, 0.047965895384550095, 0.004430673085153103, 0.036415282636880875, 7.514188473578542e-05, 0.02715715952217579, -0.004294740501791239, 0.0068223546259105206, -0.009456511586904526, 0.014923212118446827, 0.012233948335051537, 0.01435009017586708, 0.01692913845181465, 0.015856372192502022, -0.03288837894797325, 0.02812705934047699, -0.00717137148603797, -0.015371423214673996, 0.020250307396054268, -0.007825317792594433, 0.011704912409186363, -0.0051360540091991425, -0.03356437012553215, 0.048700664192438126, 0.021602286025881767, -0.005521809216588736, 0.03362315148115158, 0.0018654015148058534, 0.016738098114728928, -0.00707217724993825, -0.0015301619423553348, 0.008060445077717304, 0.004305761773139238, -0.0008394765900447965, 0.057753052562475204, -0.013769621029496193, -0.038854725658893585, 0.013152413070201874, -0.008802564814686775, -0.00450047617778182, -0.0065872278064489365, 0.015077514573931694, -0.006315362174063921, 0.020617691799998283, -0.0015889437636360526, -0.0010589896701276302, 0.0275686327368021, 0.02308652549982071, 0.026980815455317497, -0.002365964697673917, 0.01216781884431839, 0.025276144966483116, 0.003420362016186118, -0.004537214990705252, -0.029699470847845078, 0.015209773555397987, -0.05631290003657341, -0.022954266518354416, 0.011028922162950039, 0.022660357877612114, -0.009618161246180534, 0.030537109822034836, 0.013512451201677322, -0.014482349157333374, -0.002770089078694582, -0.041911374777555466, 0.005587938241660595, 0.005477722734212875, 0.011653478257358074, 0.00023788232647348195, -0.03456365689635277, -0.01770799607038498, -0.032917771488428116, -0.019339190796017647, 0.0022924875374883413, -0.01691444404423237, 0.016003327444195747, -0.009118515998125076, 0.013674100860953331, -0.021205509081482887, 0.0035305777564644814, 0.01969188079237938, -0.01822233758866787, 0.022763226181268692, -0.011109746992588043]",Token-level Direct Preference Optimization.pdf
"1937, New
York, New York, USA. PMLR.
OpenAI, :, Josh Achiam, Steven Adler, Sandhini Agar-
wal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Ale-
man, Diogo Almeida, Janko Altenschmidt, Sam Alt-
man, Shyamal Anadkat, Red Avila, Igor Babuschkin,
Suchir Balaji, Valerie Balcom, Paul Baltescu, Haim-
ing Bao, Mo Bavarian, Jeff Belgum, Irwan Bello,
Jake Berdine, Gabriel Bernadett-Shapiro, Christo-
pher Berner, Lenny Bogdonoff, Oleg Boiko, Made-
laine Boyd, Anna-Luisa Brakman, Greg Brockman,
Tim Brooks, Miles Brundage, Kevin Button, Trevor
Cai, Rosie Campbell, Andrew Cann, Brittany Carey,
Chelsea Carlson, Rory Carmichael, Brooke Chan,
Che Chang, Fotis Chantzis, Derek Chen, Sully Chen,
Ruby Chen, Jason Chen, Mark Chen, Ben Chess,
Chester Cho, Casey Chu, Hyung Won Chung, Dave
Cummings, Jeremiah Currier, Yunxing Dai, Cory
Decareaux, Thomas Degry, Noah Deutsch, Damien
Deville, Arka Dhar, David Dohan, Steve Dowl-
ing, Sheila Dunning, Adrien Ecoffet, Atty Eleti,
Tyna Eloundou, David Farhi, Liam Fedus, Niko
Felix, Simón Posada Fishman, Juston Forte, Is-
abella Fulford, Leo Gao, Elie Georges, Christian
Gibson, Vik Goel, Tarun Gogineni, Gabriel Goh,
Rapha Gontijo-Lopes, Jonathan Gordon, Morgan
Grafstein, Scott Gray, Ryan Greene, Joshua Gross,
Shixiang Shane Gu, Yufei Guo, Chris Hallacy, Jesse
Han, Jeff Harris, Yuchen He, Mike Heaton, Jo-
hannes Heidecke, Chris Hesse, Alan Hickey, Wade
Hickey, Peter Hoeschele, Brandon Houghton, Kenny
Hsu, Shengli Hu, Xin Hu, Joost Huizinga, Shantanu
Jain, Shawn Jain, Joanne Jang, Angela Jiang, Roger
Jiang, Haozhun Jin, Denny Jin, Shino Jomoto, Billie
Jonn, Heewoo Jun, Tomer Kaftan, Łukasz Kaiser,
Ali Kamali, Ingmar Kanitscheider, Nitish Shirish
Keskar, Tabarak Khan, Logan Kilpatrick, Jong Wook
Kim, Christina Kim, Yongjik Kim, Hendrik Kirch-
ner, Jamie Kiros, Matt Knight, Daniel Kokotajlo,
Łukasz Kondraciuk, Andrew Kondrich, Aris Kon-
stantinidis, Kyle Kosic, Gretchen Krueger, Vishal
Kuo, Michael Lampe, Ikai Lan, Teddy Lee, Jan
Leike, Jade Leung, Daniel Levy, Chak Ming Li,
Rachel Lim, Molly Lin, Stephanie Lin, Mateusz
Litwin, Theresa Lopez, Ryan Lowe, Patricia Lue,
Anna Makanju, Kim Malfacini, Sam Manning, Todor
Markov, Yaniv Markovski, Bianca Martin, Katie
Mayer, Andrew Mayne, Bob McGrew, Scott Mayer
McKinney, Christine McLeavey, Paul McMillan,
Jake McNeil, David Medina, Aalok Mehta, Jacob
Menick, Luke Metz, Andrey Mishchenko, Pamela
Mishkin, Vinnie Monaco, Evan Morikawa, Daniel
Mossing, Tong Mu, Mira Murati, Oleg Murk, David
Mély, Ashvin Nair, Reiichiro Nakano, Rajeev Nayak,
Arvind Neelakantan, Richard Ngo, Hyeonwoo Noh,
Long Ouyang, Cullen O’Keefe, Jakub Pachocki, Alex
Paino, Joe Palermo, Ashley Pantuliano, Giambat-
tista Parascandolo, Joel Parish, Emy Parparita, Alex
Passos, Mikhail Pavlov, Andrew Peng, Adam Perel-
man, Filipe de Avila Belbute Peres, Michael Petrov,
Henrique Ponde de Oliveira Pinto, Michael, Poko-
rny, Michelle Pokrass, Vitchyr Pong, Tolly Pow-
ell, Alethea Power, Boris Power, Elizabeth Proehl,
Raul Puri,","[0.01040753722190857, 0.017718501389026642, 0.004745531361550093, 0.07092954963445663, 0.010962976142764091, -0.024050505831837654, -0.013448565267026424, 0.07159607857465744, -0.021523259580135345, -0.08287148922681808, 0.018759949132800102, -0.00560299027711153, 0.0052766697481274605, 0.0019648652523756027, -0.0031364941969513893, 0.04640692472457886, -0.01975974068045616, -0.054377470165491104, 0.0033916491083800793, 0.046990133821964264, 0.007574798539280891, -0.048239871859550476, 0.007033245638012886, -0.008935623802244663, -0.012601520866155624, -0.019843056797981262, 0.0046309721656143665, 0.020273521542549133, 0.01950979232788086, -0.04182455316185951, 0.033131930977106094, -0.007921948097646236, 0.01832948438823223, 0.00829686876386404, -0.025175269693136215, 0.004072061739861965, -0.05112815275788307, 0.01358048152178526, -0.032048825174570084, -0.00938691757619381, -0.010817172937095165, -0.05626596510410309, 0.019801398739218712, 0.06854116171598434, 0.03449275717139244, 0.0016385448398068547, -0.03249317780137062, 0.004957292694598436, 0.04054704308509827, 0.03654788061976433, -0.021106678992509842, 0.041769009083509445, 0.02402273379266262, -0.04010269045829773, 0.0046656872145831585, -0.03704777732491493, -0.0011508000316098332, 0.029271632432937622, 0.0506560318171978, 0.023731129243969917, 0.003676311345770955, -0.07220706343650818, 0.026813814416527748, 0.02167600393295288, -0.05590492859482765, -0.015038508921861649, -0.06781909614801407, -0.007151276338845491, 0.03402063623070717, 0.04612920433282852, 0.023703357204794884, 0.07998320460319519, 0.01902378350496292, 0.00871344842016697, 0.01327499095350504, -0.012462660670280457, -0.02141217142343521, 0.00956049282103777, -0.05112815275788307, 0.0017860833322629333, 0.005238483659923077, 0.02198149636387825, 0.04860090836882591, -0.03713109344244003, -0.033215247094631195, -0.023217348381876945, -0.07798362523317337, -0.05168359354138374, -0.03926953300833702, 0.03763098642230034, -0.023661699146032333, -0.013997061178088188, -0.06831898540258408, 0.014913535676896572, 0.027258165180683136, 0.015371772460639477, 0.0218565221875906, 0.010831058956682682, 0.04265771061182022, 0.01520514115691185, 0.009025882929563522, -0.016135500743985176, 0.03713109344244003, -0.027383139356970787, -0.03704777732491493, 0.02298128604888916, -0.025772366672754288, -0.030160333961248398, -0.01144898496568203, 0.04904525727033615, -0.1348605751991272, -0.023425636813044548, -0.03446498513221741, 0.015052394941449165, -0.037908706814050674, 0.0010162796825170517, -0.026911016553640366, -0.015135711058974266, -0.03296530246734619, -0.02302294410765171, -0.025522418320178986, 0.06548625230789185, 0.02979929931461811, -0.004804546944797039, -0.014101206324994564, 0.0017860833322629333, -0.010664427652955055, -0.03302084654569626, -0.03924176096916199, -0.0475178025662899, 0.015788352116942406, -0.023647813126444817, 0.008366298861801624, -0.019148757681250572, 0.0019266788149252534, 0.011261524632573128, -0.03218768537044525, 0.004926049150526524, -0.018190626055002213, -0.043768588453531265, 0.0538775771856308, 0.008456557989120483, -0.0023536724038422108, 0.03293753042817116, 0.014524728059768677, 0.03479824960231781, -0.05029499530792236, -0.003499265294522047, 0.019787512719631195, 0.014198407530784607, 0.045157186686992645, 0.015663377940654755, -0.010692199692130089, -0.025952884927392006, -0.012233542278409004, -0.014982964843511581, 0.04626806452870369, 0.04043595492839813, -0.00938691757619381, -0.02775806002318859, 0.03679782897233963, 0.014052605256438255, -0.03888072445988655, 0.009588264860212803, 0.04935074970126152, 0.036075759679079056, -0.02071787230670452, 0.007234591990709305, -0.05687694624066353, -0.005342628341168165, -0.025175269693136215, -0.031076807528734207, -0.020051345229148865, -0.01642710715532303, 0.035075969994068146, -0.01064359862357378, 0.031215667724609375, -0.0064708637073636055, -0.050156135112047195, -0.0236339271068573, -0.007901119068264961, 0.02189818024635315, 0.02514749765396118, 0.040991391986608505, 0.010102045722305775, -0.008532931096851826, 0.04510164260864258, 0.012969499453902245, -0.013281933963298798, 0.0303269661962986, 0.0679301843047142, 0.026300033554434776, 0.03527037054300308, 0.032048825174570084, -0.01168504636734724, -0.0948689728975296, 0.020342951640486717, -0.04149128869175911, -0.018759949132800102, -0.0025966770481318235, -0.01362213958054781, 0.027480341494083405, 0.0029820126947015524, 0.003995688632130623, 0.013677683658897877, -0.03801979497075081, -0.00715821934863925, -0.007838631980121136, -0.021106678992509842, -0.012844525277614594, 0.08370465040206909, 0.018801607191562653, 0.03296530246734619, -0.015080166980624199, 0.026508323848247528, 0.02002357318997383, -0.005370400380343199, 0.029743755236268044, 0.016579851508140564, 0.016524307429790497, -0.044462885707616806, 0.058321088552474976, 0.027785832062363625, -0.0030688000842928886, 0.016218816861510277, -0.0001822533959057182, -0.01322638988494873, -0.009206400252878666, 0.0038325286004692316, -0.020440151914954185, 0.034770477563142776, -0.0019666010048240423, 0.014385868795216084, 0.029299404472112656, 0.0009780932450667024, -0.0168575718998909, 0.016440993174910545, -0.04543490335345268, 0.018273940309882164, 0.011837792582809925, 0.018565546721220016, 0.010282563045620918, -0.026661068201065063, 0.02675827033817768, 0.04401853680610657, 0.035909127444028854, -0.019093213602900505, -0.009900699369609356, -0.0287995096296072, 0.00886619370430708, 0.03993605822324753, -0.006738168653100729, -0.01520514115691185, 0.021800978109240532, -0.023272890597581863, -0.010261734016239643, -0.02028740756213665, -0.01920430175960064, 0.018746064975857735, 0.01539954449981451, 0.012080796994268894, -0.0003499699232634157, 0.0010423158528283238, -0.004075533244758844, 0.004252579528838396, 0.03663119673728943, -0.032048825174570084, 0.051766909658908844, 0.05035053938627243, -0.006797183770686388, -0.012983385473489761, 0.02602231502532959, 0.0029715984128415585, 0.03141007199883461, -0.031687792390584946, 0.023883873596787453, 0.03235431760549545, 0.028521789237856865, -0.051072608679533005, 0.021662117913365364, -0.010351993143558502, 0.041852325201034546, 0.014385868795216084, -0.03263203799724579, -0.016524307429790497, 0.034298352897167206, 0.020926162600517273, 0.005498845595866442, -0.03227100148797035, 0.0220231544226408, 0.012184941209852695, -0.022300872951745987, 0.028271840885281563, -0.03188219666481018, 0.04226890206336975, -0.0016480914782732725, 0.007456767838448286, -0.04374081641435623, 0.018107309937477112, -0.032909758388996124, 0.034603845328092575, -0.024439312517642975, 0.03424280881881714, -0.004526827484369278, 0.010629712603986263, 0.032382089644670486, 0.011796134524047375, -0.02271745167672634, 0.0287995096296072, -0.020315179601311684, -0.011087949387729168, -0.017496326938271523, -0.03018810600042343, -0.026883244514465332, -0.03538145869970322, -0.031160123646259308, 0.0005237615550868213, 0.0303269661962986, -0.03835305944085121, -0.014524728059768677, -0.06698593497276306, -0.036159075796604156, -0.01322638988494873, -0.021925952285528183, -0.00014688755618408322, 0.02654998190701008, 0.008046921342611313, -0.02584179677069187, 0.03774207457900047, -0.03340965136885643, 0.022384189069271088, -0.0439629927277565, 0.00513781001791358, 0.014941307716071606, 0.009498005732893944, 0.027341481298208237, 0.0018728706054389477, 0.04826764389872551, 0.01003955863416195, 0.0008301208727061749, -0.06315340846776962, -0.01581612415611744, -0.015330114401876926, 0.014212293550372124, 0.020703986287117004, -0.00942857563495636, 0.027049876749515533, -0.014899649657309055, 0.02441154047846794, 0.0007871611160226166, 0.0014771204441785812, 0.04093584790825844, 0.04324091970920563, 0.015455088578164577, -0.001451084273867309, -0.003159058978781104, -0.008678733371198177, -0.04832318797707558, -0.044601745903491974, 0.0407414473593235, 0.006338946986943483, 0.052155714482069016, 0.005262783728539944, -0.029577123001217842, 0.008345469832420349, -0.034076180309057236, -0.06481972336769104, -0.02306460216641426, 0.028216298669576645, -0.04318537563085556, -0.029216088354587555, 0.03307638689875603, -0.012184941209852695, 0.03457607328891754, -0.037214409559965134, 0.023883873596787453, -0.03749212995171547, 0.00011005718988599256, 0.005481488071382046, 0.033215247094631195, 0.01539954449981451, -0.00938691757619381, -0.010456138290464878, 0.030826861038804054, -0.00020731324912048876, 0.02071787230670452, 0.03002147376537323, -0.0005328742554411292, -0.005339156836271286, 0.024883665144443512, 0.027952464297413826, 0.012275200337171555, -0.01594109833240509, 0.034076180309057236, -0.01242794655263424, 0.01707974635064602, 0.007553969509899616, 0.057543475180864334, 0.023606155067682266, -0.013004214502871037, -0.02885505184531212, -0.021745434030890465, -0.01637156307697296, 0.02071787230670452, -0.04590702801942825, -0.0006031719967722893, 0.027147077023983, 0.016663167625665665, -0.0009208135888911784, 0.012219656258821487, -0.009241115301847458, -0.0738733783364296, 0.019454248249530792, 0.03835305944085121, 0.03588135540485382, -0.021148337051272392, 0.018621090799570084, -0.01567726396024227, 0.001416369341313839, 0.014524728059768677, 0.02828572690486908, -0.006731225643306971, -0.03974165394902229, -0.0023397866170853376, -0.04140797257423401, 0.0340484082698822, 0.037603214383125305, -0.056543681770563126, -0.005228069145232439, -0.060154035687446594, -0.030299194157123566, -0.014857991598546505, 0.04796215146780014, -0.03385400399565697, -0.024342112243175507, -0.04901748523116112, 0.035825811326503754, 0.040380410850048065, -0.017926791682839394, -0.038464147597551346, -0.02836904302239418, -0.026813814416527748, -0.019454248249530792, 0.053016647696495056, -0.028827279806137085, -0.06237579137086868, 0.03585358336567879, -0.0028709250036627054, -0.02484200708568096, -0.016579851508140564, 0.0253280159085989, 0.020731758326292038, 0.05210017040371895, 0.005516203120350838, 0.02075953036546707, 0.019606994464993477, 0.0373532697558403, 0.04690681770443916, 0.013136130757629871, 0.005471073556691408, -0.00772060127928853, -0.0008722126949578524, -0.04812878370285034, -0.012893126346170902, -0.011476757004857063, -0.00012063439498888329, -0.030743544921278954, -0.0067832982167601585, 0.049461837857961655, -0.006165372207760811, 0.012407117523252964, -0.013906802050769329, -0.1077551543712616, -0.022398075088858604, -0.05737684294581413, -0.006144543178379536, -0.02602231502532959, -0.022273100912570953, -0.02993815951049328, -0.0066756815649569035, 0.025577962398529053, -0.018273940309882164, 0.007769201882183552, 0.03288198634982109, 0.01985694281756878, 0.03688114508986473, 0.009782668203115463, 0.044157397001981735, -0.026133401319384575, 0.025744594633579254, -0.010706085711717606, 0.020703986287117004, 0.07331793755292892, -0.016010526567697525, -0.04204672574996948, -0.005780036561191082, 0.02506418153643608, -0.01773238740861416, 0.01539954449981451, -0.02441154047846794, -0.042602166533470154, -0.011435098946094513, -0.029688211157917976, 0.026383349671959877, -0.008720391429960728, -0.014927421696484089, -0.029382720589637756, 0.042685482650995255, 0.056849174201488495, 0.043990764766931534, 0.0303269661962986, -0.01916264370083809, 0.009498005732893944, 0.020037459209561348, 0.03265981003642082, 0.04332423582673073, -0.034992653876543045, -0.009095313027501106, -0.0168575718998909, 0.021314969286322594, -0.004079004749655724, -0.002063802909106016, -0.025911226868629456, -0.01785736158490181, 0.00758174154907465, -0.016885343939065933, -0.007310965098440647, 0.00758174154907465, -0.006283402908593416, 0.0003120004548691213, 0.023439522832632065, -0.011469813995063305, -0.001985694281756878, 0.019579222425818443, -0.0068770283833146095, 0.011712818406522274, -0.009484119713306427, -0.059154246002435684, -0.008345469832420349, -0.02759142965078354, -0.014094263315200806, 0.02216201275587082, -0.010088159702718258, 0.03393732011318207, 0.0046830447390675545, -0.009963185526430607, 0.023994961753487587, -1.6584517652518116e-05, -0.01594109833240509, 0.024175480008125305, 0.03510374203324318, -0.0371866375207901, 0.046156976372003555, -0.047767747193574905, 0.007547026500105858, 0.010608883574604988, 0.027397025376558304, 0.010414480231702328, 0.023050716146826744, -0.004349781200289726, 0.0184683445841074, 0.004443511366844177, 0.01112266443669796, 0.007366508711129427, -0.011747533455491066, 0.02263413742184639, 0.025994542986154556, -0.05798782408237457, -0.00022955250460654497, 0.02614728733897209, 0.002233905950561166, -0.009136970154941082, -0.028882823884487152, 0.010747743770480156, 0.046073660254478455, -0.022606365382671356, -0.04932297766208649, -0.018398914486169815, -0.024564286693930626, -0.014580272138118744, -0.03310415893793106, 0.009116141125559807, -0.01083800196647644, 0.027994122356176376, -0.01867663487792015, 0.02171766199171543, -0.01898212544620037, 0.014128978364169598, -0.01573280803859234, 0.011629502288997173, 0.01767684333026409, -0.012462660670280457, -0.03602021560072899, -0.012511261738836765, 0.0010778986616060138, 0.0019041141495108604, 0.028966140002012253, -0.044462885707616806, -0.017829589545726776, 0.029299404472112656, -6.351748015731573e-05, -0.008401013910770416, -2.9121217721694848e-06, 0.011629502288997173, 0.008546816185116768, -0.03240986168384552, 0.01763518527150154, 0.022953514009714127, 0.0019648652523756027, -0.016343791037797928, -0.016649281606078148, -0.00626604538410902, 0.04401853680610657, -0.0151634830981493, -0.0187182929366827, 0.003874186659231782, -0.006456977687776089, -0.014302552677690983, 0.015080166980624199, 0.018273940309882164, -0.006706925109028816, -0.007387337740510702, 0.04787883535027504, 0.03402063623070717, 0.0027789303567260504, 0.02420325204730034, 0.013108358718454838, -0.011455927975475788, -0.02893836796283722, -0.028660649433732033, -0.0028396814595907927, -0.026702726259827614, 0.034826021641492844, -0.014413639903068542, 0.02137051336467266, 0.007491482421755791, 0.004624029155820608, 0.0030427640303969383, 0.01577446609735489, -0.036075759679079056, 0.021384399384260178, 0.010719971731305122, -0.001297470647841692, -0.02659163810312748, 0.005287084262818098, 0.006897857412695885, -0.0304102823138237, 0.010393651202321053, 0.01981528475880623, -0.014760789461433887, 0.0014727810630574822, -0.03054914064705372, 0.04487946629524231, -0.04296320304274559, -0.02614728733897209, -0.022578593343496323, -0.0037978137843310833, -0.033909548074007034, 0.0016524308593943715, 0.005592575762420893, -0.022842425853013992, -0.00045910500921308994, 0.0019579222425818443, 0.004762888886034489, -0.00640837661921978, 0.008088579401373863, 0.010553339496254921, 0.03154893219470978, -0.029965929687023163, -0.0029143185820430517, 0.019259845837950706, 0.044379569590091705, 0.043990764766931534, 0.006321589462459087, 0.001280113123357296, -0.0012610199628397822, -0.005516203120350838, 0.009768782183527946, 0.0186349768191576, -0.0014450091402977705, -0.00165850599296391, 0.003964445553719997, -0.03851969167590141, 0.020273521542549133, 0.0186349768191576, -0.00794972013682127, 0.019357046112418175, -0.011108778417110443, 0.040991391986608505, -0.0034662859980016947, 0.005957082379609346, -0.010067330673336983, 0.0370200052857399, -0.030965721234679222, 0.010546396486461163, -0.015496746636927128, -0.009373032487928867, -0.031437844038009644, -0.002537661697715521, -0.11058789491653442, -0.016385449096560478, 0.008928680792450905, -0.009921528398990631, 0.004679573234170675, -0.049378521740436554, 0.013476337306201458, -0.02398107573390007, -0.0093174884095788, 0.024925321340560913, 0.0009546606452204287, -0.01794067770242691, -2.3744472855469212e-05, -0.01998191513121128, 0.043601956218481064, -0.032215457409620285, 0.02259247936308384, -0.004637915175408125, 0.03557586297392845, -0.011247638612985611, -0.011934993788599968, -0.01581612415611744, 0.037381041795015335, 0.023231232538819313, 0.021662117913365364, 0.008921737782657146, -0.05029499530792236, -0.012559862807393074, 0.01567726396024227, 0.008956452831625938, 0.0007168633746914566, -0.012025252915918827, 0.030993493273854256, -0.010831058956682682, -0.031298983842134476, 0.02632780559360981, -0.02528635784983635, -0.02728593721985817, 0.011504529044032097, -0.017649071291089058, 0.022050926461815834, 0.003155587473884225, -0.034909337759017944, -0.015260684303939342, 0.02341175079345703, -0.016968660056591034, -0.008442671969532967, 0.005016307812184095, 0.008602360263466835, 0.02893836796283722, 0.03885295242071152, 0.009352203458547592, 0.013358306139707565, -0.0030375567730516195, 0.0007125239935703576, -0.015760580077767372, -0.02659163810312748, 0.014385868795216084, 0.034215036779642105, -0.04712899401783943, 0.024994751438498497, 0.03179888054728508, 0.027397025376558304, -0.008026092313230038, -0.01225437130779028, 0.032298773527145386, -0.006949929520487785, 0.03688114508986473, -0.0304935984313488, 0.047156766057014465, -0.01985694281756878, 0.014177578501403332, -0.009324431419372559, 0.011962765827775002, -0.005540503188967705, 0.0004938199417665601, -0.0002811909653246403, -0.00794972013682127, 0.01755187101662159, 0.00024973053950816393, 0.03696446120738983, -0.004846204537898302, 0.007699772249907255, 0.017662957310676575, 0.010678313672542572, -0.027563657611608505, -0.046379152685403824, 0.009046711958944798, 0.014857991598546505, -0.008359355852007866, 0.0027476870454847813, -0.03454830124974251, 0.024008847773075104, -0.004780246410518885, 0.0028587747365236282, 0.04679572954773903, 0.024119935929775238, 0.007067960221320391, -0.02545299008488655, -0.008532931096851826, 0.0003684122348204255, -0.007595627568662167, 0.04171346500515938, 0.02498086541891098, 0.0539608933031559, 0.030215878039598465, 0.033048614859580994, 0.016454879194498062, 0.08009429275989532, 0.0072831930592656136, 0.0006357172387652099, 0.008345469832420349, 0.0026001485530287027, -0.023036830127239227, 0.024605944752693176, -0.0405748151242733, 0.02849401719868183, 0.015996640548110008, -0.009324431419372559, -0.016940888017416, 0.02275910973548889, 0.008845364674925804, -0.032437633723020554, 0.0032354318536818027, 0.007880290038883686, 0.01237934548407793, 0.015149597078561783, 0.026133401319384575, -0.0012558127054944634, -0.035770267248153687, -0.002454345813021064, 0.045379359275102615, -0.04612920433282852, 0.013240275904536247, -0.0027598373126238585, 0.006699982099235058, 0.02963266707956791, -0.04665686935186386, -0.025314129889011383, -0.04762888699769974, 0.026522209867835045, 0.004110248293727636, 0.03885295242071152, -0.012879240326583385, 0.02567516453564167, 0.003711026394739747, 0.03307638689875603, 0.027466455474495888, 0.011414269916713238, -0.022870197892189026, -0.021870408207178116, 0.009130027145147324, -0.007179048378020525, -0.004058175720274448, 0.02155102975666523, 0.02181486412882805, 0.024231024086475372, 0.002039502374827862, -0.005474545061588287, 0.0050371368415653706, 0.01563560590147972, -0.025355787947773933, -0.019176529720425606, -0.013399964198470116, -0.044990554451942444, 0.027744174003601074, -0.016149386763572693, -0.009456347674131393, -0.02493920736014843, 0.0804831013083458, 0.009872927330434322, 0.020162433385849, -0.015135711058974266, -0.016066070646047592, 0.0014146335888653994, -0.0013616932556033134, -0.0065298788249492645, -0.04051927104592323, 0.031160123646259308, 0.016940888017416, 0.024397654458880424, 0.03454830124974251, -0.010789400897920132, -0.009539663791656494, -0.007338737137615681, 0.01314307376742363, -0.005668948404490948, 0.000587116286624223, 0.02675827033817768, -0.024355996400117874, 0.011962765827775002, -0.004322009161114693, 0.03765875846147537, -0.016579851508140564, -0.024661488831043243, 0.012601520866155624, 0.022953514009714127, 0.00748453987762332, 0.019037669524550438, 0.040991391986608505, -0.030743544921278954, 0.010858830995857716, -0.00918557122349739, -0.0073595657013356686, 0.0023814444430172443, -0.032520949840545654, -0.01673259772360325, 0.016829799860715866, -0.030771316960453987, 0.020093003287911415, -0.024703146889805794, 0.0008847968420013785, 0.011393440887331963, 0.02580013871192932, -0.00772060127928853, 0.020745644345879555, 0.004072061739861965, 0.00032870701397769153, -0.00268346443772316, 0.05304441973567009, -0.005210711620748043, 0.02724427916109562, -0.0014658380532637239, -0.013712398707866669, 0.009164742194116116, 0.016565965488553047, 0.007796973921358585, 0.004596257116645575, 0.021787092089653015, 0.021967610344290733, -0.011768362484872341, 0.004481697920709848, 0.006720811128616333, 0.0046483296900987625, 0.019051555544137955, 0.0018520416924729943, -0.02216201275587082, 0.02393941767513752, -0.0024387240409851074, 0.008123294450342655, -0.02736925333738327, 0.028632877394557, 0.018996011465787888, 0.010143703781068325, -7.192500197561458e-05, 0.011691989377140999, -0.005307913292199373, -0.009831269271671772, 0.01242100354284048, 0.014621930196881294, -0.028355157002806664, 0.025078067556023598, -0.029965929687023163, 0.018051765859127045, -0.02954935096204281, 0.005290555767714977, -0.01798233576118946, 0.01266400795429945, 0.03271535411477089, 0.0003265373525209725, 0.01746855489909649, -0.047684431076049805, -0.013129187747836113, -0.04971178621053696, -0.0574323870241642, -0.040213778614997864, 0.00971323810517788, 0.00598485441878438, -0.004589314106851816, -0.04896194115281105, 0.0370200052857399, 0.004054704215377569, 0.014212293550372124, -0.004946878179907799, 0.023036830127239227, -0.029827071353793144, -0.048628680408000946, 0.012073853984475136, 0.041074708104133606, -0.003860300639644265, 0.008505159057676792, -0.014247008599340916, 0.007338737137615681, 0.01916264370083809, -0.00705754617229104, -0.03310415893793106, -0.03557586297392845, 0.011372611857950687, 0.02636946365237236, -0.007588684558868408, 0.006738168653100729, 0.007547026500105858, 0.01233768742531538, 0.020884504541754723, 0.034687161445617676, 0.021787092089653015, -0.004998950287699699, -0.011837792582809925, 0.09492451697587967, -0.0035548091400414705, 0.02159268781542778, 0.00513781001791358, -0.018912695348262787, 0.016454879194498062, 0.036908917129039764, -0.044379569590091705, -0.018051765859127045, 0.03588135540485382, -0.02341175079345703, 0.005273198243230581, -0.012212713249027729, 0.026952674612402916, -0.023689471185207367, 0.006099413614720106, -0.016357677057385445, 0.016607623547315598, -0.028577333316206932, -0.005075323395431042, 0.006429205648601055, -0.023883873596787453, -0.025883454829454422, 0.040602587163448334, -0.0004157113144174218, -0.00077674665953964, -0.017565757036209106, 0.00806080736219883, -0.04218558594584465, 0.017232492566108704, -0.016232702881097794, 0.029216088354587555, 0.007672000210732222, -0.0035929956939071417, 0.01842668652534485, -0.009338317438960075, -0.0183850284665823, -0.002395330462604761, 0.01144898496568203, -0.014059548266232014, 0.0037144978996366262, 0.038464147597551346, 0.004186620935797691, 0.028271840885281563, 0.003943616524338722, 0.008845364674925804, 0.018537774682044983, 0.010775514878332615, -0.005151696037501097, 0.0005398172070272267, -0.00829686876386404, -0.013066700659692287, 0.0009069276275113225, 0.00299242720939219, -0.010942147113382816, 0.002166211837902665, -0.012976442463696003, 0.006220916286110878, 0.0008639679290354252, 0.015024622902274132, -0.006699982099235058, 0.007345680147409439, 0.007803916931152344, -0.04210226982831955, 0.025411332026124, -0.0007507104310207069, 0.014802447520196438, 0.020537354052066803, 0.02359226904809475, 0.013330534100532532, -0.00983821228146553, -0.0287161935120821, 0.0061237141489982605, -0.014830219559371471, -9.655090980231762e-05, -0.005481488071382046, 0.009859041310846806, -0.003856829134747386, -0.04157460480928421, -0.004238693509250879, -0.05687694624066353, -0.02246750518679619, 0.013136130757629871, 0.009331374429166317, -0.02932717651128769, -0.02436988241970539, -0.005085737910121679, -0.03554809093475342, 0.022745223715901375, 0.00975489616394043, 0.005856409203261137, -0.03002147376537323, -0.016274360939860344, -0.005346099846065044, -0.003419420914724469, -0.016107728704810143, -0.008887022733688354, 0.01531622838228941, 0.014608044177293777, -0.0009893756359815598, 0.043463096022605896, 0.023009058088064194, 0.018343370407819748, 0.025425218045711517, 0.0251613836735487, -0.008269096724689007, 0.02828572690486908, -0.02089839056134224, -0.01585778221487999, 0.008012206293642521, -0.0039887456223368645, -0.0005636837449856102, 0.004672630224376917, -0.02050958201289177, -0.007304022088646889, 0.00578697957098484, -0.008546816185116768, -0.009567435830831528, -0.02580013871192932, 0.012268257327377796, -0.027730287984013557, 0.012983385473489761, 0.009581321850419044, -0.0029195258393883705, -0.01383737288415432, 0.05965414270758629, 0.013636025600135326, 0.016024412587285042, 0.0066756815649569035, -0.02102336287498474, 0.002029087860137224, -0.015760580077767372, 0.00020199752179905772, 0.022731337696313858, -0.0013026779051870108, 0.023175690323114395, -0.004210921470075846, 0.021662117913365364, -0.011310125701129436, -0.01698254607617855, -0.006554179359227419, 0.006908271927386522, 0.0073942807503044605, -0.020926162600517273, -0.01920430175960064, 0.030604684725403786, -0.017621301114559174, -0.006207030266523361, 0.0033742915838956833, -0.06182035431265831, 0.06798572838306427, 0.0026886716950684786, -0.0011620824225246906, 0.014663588255643845, 0.008220496587455273, -0.013698512688279152, 0.021703775972127914, 0.0083871278911829, -0.008178838528692722, -0.013136130757629871, -0.015496746636927128, -0.021189995110034943, 0.023703357204794884, -0.009310545399785042, 0.002272092504426837, 0.0023102788254618645, 0.001831212779507041, -0.012927841395139694, -0.04821209982037544, -0.007658114191144705, -0.003192038042470813, 0.010199247859418392, 0.05026722326874733, -0.025091953575611115, -0.010088159702718258, 0.018621090799570084, -0.006755526177585125, 0.017010318115353584, -0.029382720589637756, 0.03949170932173729, 0.004016517661511898, -0.01612161472439766, -0.00947023369371891, 0.013615196570754051, -0.019148757681250572, 0.0008487800951115787, -0.034215036779642105, -0.001527457032352686, 0.0336318276822567, -0.028688421472907066, -0.005932782310992479, 0.00036906314198859036, 0.005203768610954285, -0.009498005732893944, 0.018232282251119614, 0.014566386118531227, 0.018093423917889595, 0.0024352525360882282, -0.026772156357765198, -0.02528635784983635, -0.02028740756213665, 0.010935204103589058, -0.007803916931152344, 0.000688223575707525, -0.010539453476667404, 0.028299612924456596, -0.014038719236850739, 0.07570632547140121, 0.038214199244976044, 0.013497166335582733, -0.01789901964366436, 0.014760789461433887, -0.021620459854602814, 0.0034888507798314095, -0.012719552032649517, -0.024730918928980827, -0.011129607446491718, -0.022189784795045853, 0.017301922664046288, 0.019009897485375404, -0.00705754617229104, -0.000971150235272944, 0.03532591462135315, 0.019218187779188156, 0.01266400795429945, -0.007526197470724583, 0.00485661905258894, 0.04163014888763428, 0.03993605822324753, 0.02432822622358799, -0.01963476650416851, 0.01362213958054781, -0.0019874300342053175, 0.014608044177293777, -0.014483070001006126, -0.04196341335773468, 0.013323591090738773, -0.008768992498517036, -0.00564811984077096, -0.024092163890600204, 0.012372402474284172, -0.005061437375843525, -0.012629292905330658, 0.00801914930343628, -0.0074637108482420444, -0.02963266707956791, 0.01535788644105196, 0.0077067152597010136, 0.00659236591309309, 0.04124134033918381, 0.005064908880740404, -0.012927841395139694, 0.02684158645570278, 0.013997061178088188, -0.02885505184531212, -0.022925741970539093, -0.007366508711129427, 0.012157170102000237, -0.0017895548371598125, -0.007345680147409439, 0.04871199280023575, 0.012059967964887619, 0.040463726967573166, 0.019745854660868645, 0.0028310029301792383, 0.0012610199628397822, 0.012261314317584038, 0.0023883874528110027, -0.01698254607617855, -0.006456977687776089, 0.024953093379735947, 0.004880919586867094, 0.020926162600517273, -0.004488640930503607, -0.0023640869185328484, 0.03474270552396774, 0.044379569590091705, -0.023522838950157166, 0.011747533455491066, 0.008560702204704285, -0.008220496587455273, -0.05157250538468361, 0.015135711058974266, 0.0004024762602057308, 0.012851468287408352, 0.024050505831837654, 0.03796425089240074, -0.010338107123970985, 0.006515992805361748, -0.02993815951049328, 0.015191255137324333, 0.0011108778417110443, 0.0009876398835331202, 0.012761209160089493, -0.01366379763931036, -0.03435389697551727, 0.00112910324241966, 0.0026591639034450054, -0.00951189175248146, -0.009900699369609356, -0.01928761787712574, 0.014163692481815815, 0.012837582267820835, 0.019009897485375404, -0.023994961753487587, -0.014413639903068542, 0.010553339496254921, -0.01258069183677435, 0.0031712092459201813, 0.0037040833849459887, 0.032993074506521225, -0.011386497877538204, -0.004068590234965086, -0.0012670950964093208, 0.019495906308293343, -0.032909758388996124, -0.04013046249747276, -0.012483489699661732, 0.023314548656344414, 0.029854843392968178, -0.009379974566400051, -0.004162320401519537, -0.02555019035935402, 0.00794972013682127, -0.005835580173879862, -0.015344000421464443, -0.02753588557243347, 0.0009077955037355423, 0.01407343428581953, 0.019620880484580994, -0.02810521051287651, -0.013656854629516602, 0.016385449096560478, 0.01842668652534485, 0.027744174003601074, -0.0034923222847282887, 0.0027025574818253517, 0.005373871885240078, 0.025577962398529053, -0.021384399384260178, 0.0134693942964077, 0.014219236560165882, 0.023259004577994347, 0.011018520221114159, 0.04079699143767357, 0.03965834155678749, -0.01706586219370365, -0.024661488831043243, 0.0035010010469704866, 0.004946878179907799, -0.005939725320786238, -0.014371982775628567, 0.010442252270877361, 0.01867663487792015, 0.030660228803753853, -0.016885343939065933, 0.00018247036496177316, -0.04135242849588394, -0.009803497232496738, 0.0019405648345127702, -0.03232654556632042, 0.01794067770242691, 0.01087966002523899, 0.0022790352813899517, 0.0037526842206716537, -0.015871668234467506, 0.012698723003268242, 0.050156135112047195, -0.013038928620517254, 0.004422682337462902, -0.02341175079345703, 0.00033000882831402123, 0.02910500019788742, -0.027730287984013557, 0.002105460735037923, 0.03254872187972069, 0.023967189714312553, -0.012545976787805557, -0.048156555742025375, 0.009588264860212803, -0.03774207457900047, 0.00964380893856287, 0.00027077647973783314, -0.014524728059768677, 0.021398285403847694, -0.01759352907538414, 0.020315179601311684, -0.033131930977106094, -0.04504609853029251, -0.017274150624871254, -0.055766068398952484, -0.0036207675002515316, 0.04482392221689224, 0.013851258903741837, -0.04987841472029686, 0.024730918928980827, 0.03574249520897865, 0.007574798539280891, 0.01555228978395462, -0.003565223654732108, -0.012282143346965313, 0.04282434284687042, 0.00045172806130722165, -0.032993074506521225, 0.0032024525571614504, -0.02137051336467266, -0.0014085584552958608, -0.0017591792857274413, -0.020523468032479286, -0.022842425853013992, 0.0038464146200567484, 0.001320035313256085, 0.01777404546737671, -0.0025741122663021088, -0.019704196602106094, 0.010699142701923847, 0.017440782859921455, 0.005422472488135099, -0.00207421719096601, -0.007050603162497282, -0.032909758388996124, 0.04343532398343086, 0.029910387471318245, -0.01394846010953188, -0.01612161472439766, 0.02689713053405285, 0.014156749472022057, -0.01837114244699478, -0.0029195258393883705, -0.0251613836735487, 0.030438054352998734, 0.018454458564519882, -0.02398107573390007, 0.040380410850048065, 0.018523888662457466, -0.0025914697907865047, -0.028688421472907066, 0.016913115978240967, -0.00014677907165605575, -0.006109828129410744, 0.01802399381995201, 0.011060177348554134, -0.004578899592161179, -0.02241196110844612, -0.00942857563495636, 0.02341175079345703, -0.008331583812832832, -0.04665686935186386, -0.005113509483635426, 0.014788561500608921, -0.0337151437997818, -0.022231442853808403, 0.003613824490457773, 0.019343160092830658, 0.02094004862010479, 0.03663119673728943, 0.005033665336668491, -0.010476967319846153, -0.014774675481021404, 0.0034402499441057444, 0.0217732060700655, 0.018107309937477112, -0.024703146889805794, -0.010594997555017471, 0.00919251423329115, 0.015913326293230057, 0.003915844485163689, 0.012351573444902897, -0.02463371679186821, 0.038908496499061584, -0.011178208515048027, 0.007644228171557188, -0.001668052515015006, 0.0036728400737047195, -0.06332004070281982, 0.022786881774663925, -0.004568485077470541, 0.019176529720425606, 0.03940839320421219, -0.013399964198470116, 0.01981528475880623, -0.002183569362387061, 0.015538403764367104, 0.011678103357553482, 0.03093794919550419, 0.0017730651888996363, -0.017274150624871254, -0.009074483998119831, 0.03713109344244003, -0.0034055348951369524, -0.03793647885322571, 0.022009268403053284, -0.003469757502898574, -0.018621090799570084, -0.009491062723100185, 0.01585778221487999, 0.01728803664445877, 0.007220705971121788, 0.011941936798393726, 0.01767684333026409, 0.017926791682839394, 0.03563140705227852, 0.0057349069975316525, -0.0038533576298505068, -0.008081636391580105, 0.038603007793426514, 0.007588684558868408, -0.024189366027712822, -0.012455717660486698, 0.04001937434077263, -0.012080796994268894, -0.025411332026124, -0.020009687170386314, 0.02328677661716938, -0.0183850284665823, 0.022786881774663925, 0.024133821949362755, 0.007790030911564827, -0.016357677057385445, -0.0056064617820084095, -0.005526617635041475, -0.016316018998622894, 0.010456138290464878, -0.02636946365237236, -0.05859880894422531, 0.005044079851359129, -0.040213778614997864, -0.006543764844536781, 0.00362771051004529, -0.009803497232496738, -0.0020152018405497074, 0.010345050133764744, 0.034909337759017944, 0.009845155291259289, -0.008644018322229385, 0.011462870985269547, -0.025925112888216972, 0.031049037352204323, -0.014733017422258854]",Token-level Direct Preference Optimization.pdf
" Alec Radford, Jack Rae, Aditya Ramesh,
Cameron Raymond, Francis Real, Kendra Rimbach,
Carl Ross, Bob Rotsted, Henri Roussez, Nick Ry-
der, Mario Saltarelli, Ted Sanders, Shibani Santurkar,
Girish Sastry, Heather Schmidt, David Schnurr, John
Schulman, Daniel Selsam, Kyla Sheppard, Toki
Sherbakov, Jessica Shieh, Sarah Shoker, Pranav
Shyam, Szymon Sidor, Eric Sigler, Maddie Simens,
Jordan Sitkin, Katarina Slama, Ian Sohl, Benjamin
Sokolowsky, Yang Song, Natalie Staudacher, Fe-
lipe Petroski Such, Natalie Summers, Ilya Sutskever,
Jie Tang, Nikolas Tezak, Madeleine Thompson, PhilTillet, Amin Tootoonchian, Elizabeth Tseng, Pre-
ston Tuggle, Nick Turley, Jerry Tworek, Juan Fe-
lipe Cerón Uribe, Andrea Vallone, Arun Vijayvergiya,
Chelsea V oss, Carroll Wainwright, Justin Jay Wang,
Alvin Wang, Ben Wang, Jonathan Ward, Jason Wei,
CJ Weinmann, Akila Welihinda, Peter Welinder, Ji-
ayi Weng, Lilian Weng, Matt Wiethoff, Dave Willner,
Clemens Winter, Samuel Wolrich, Hannah Wong,
Lauren Workman, Sherwin Wu, Jeff Wu, Michael
Wu, Kai Xiao, Tao Xu, Sarah Yoo, Kevin Yu, Qim-
ing Yuan, Wojciech Zaremba, Rowan Zellers, Chong
Zhang, Marvin Zhang, Shengjia Zhao, Tianhao
Zheng, Juntang Zhuang, William Zhuk, and Barret
Zoph. 2023. GPT-4 technical report. Technical re-
port, OpenAI.
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida,
Carroll Wainwright, Pamela Mishkin, Chong Zhang,
Sandhini Agarwal, Katarina Slama, Alex Ray, John
Schulman, Jacob Hilton, Fraser Kelton, Luke Miller,
Maddie Simens, Amanda Askell, Peter Welinder,
Paul F Christiano, Jan Leike, and Ryan Lowe. 2022.
Training language models to follow instructions with
human feedback. In Advances in Neural Information
Processing Systems , volume 35, pages 27730–27744.
Curran Associates, Inc.
Alec Radford, Jeff Wu, Rewon Child, David Luan,
Dario Amodei, and Ilya Sutskever. 2019. Language
models are unsupervised multitask learners.
Rafael Rafailov, Archit Sharma, Eric Mitchell, Stefano
Ermon, Christopher D. Manning, and Chelsea Finn.
2023. Direct preference optimization: Your language
model is secretly a reward model. In Advances in
Neural Information Processing Systems , volume 36.
Curran Associates, Inc.
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec
Radford, and Oleg Klimov. 2017. Proximal pol-
icy optimization algorithms. Computing Research
Repository , arXiv:1707.06347.
Nisan Stiennon, Long Ouyang, Jeffrey Wu, Daniel
Ziegler, Ryan Lowe, Chelsea V oss, Alec Radford,
Dario Amodei, and Paul F Christiano. 2020. Learn-
ing to summarize with human feedback. In Ad-
vances in Neural Information Processing Systems ,
volume 33, pages 3008–3021. Curran Associates,
Inc.
Hugo Touvron, Louis Martin, Kevin Stone, Peter Al-
bert, Amjad Almahairi, Yasmine Babaei, Nikolay
Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti
Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton
Ferrer, Moya Chen, Guillem Cucurull, David Esiobu,
Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller,
Cynthia Gao, Vedanuj Goswami, Naman Goyal, An-
thony Hartshorn, Saghar Hosseini, Rui Hou, Hakan
Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa,
Isabel Kloumann, Artem Korenev, Punit Singh Koura,
Marie-Anne Lachaux, Thibaut Lavril","[-0.001911111525259912, 0.013713156804442406, 0.04667583853006363, 0.005369566846638918, 0.011030147783458233, -0.027525685727596283, 0.0021275978069752455, 0.06365403532981873, -0.04031611233949661, -0.011597980745136738, 0.035461146384477615, -0.02729855105280876, -0.012045148760080338, -3.230102447560057e-05, -0.010412630625069141, -0.002636872697621584, 0.007239865604788065, -0.05172954872250557, 0.008105810731649399, 0.02692946046590805, -0.018766866996884346, -0.03557471185922623, 0.013613786548376083, 0.00827615987509489, 0.026517782360315323, 0.0012297125067561865, 0.0006955949356779456, 0.024729110300540924, -0.01220840122550726, -0.03480813652276993, 0.03177023306488991, -0.021648617461323738, -0.02895946241915226, -0.004485877696424723, -0.013819625601172447, 0.003399897599592805, -0.007410215213894844, -0.006377469748258591, -0.02251456305384636, -0.0017043850384652615, -0.009667349979281425, -0.04187765344977379, 0.004695265553891659, 0.04991248622536659, 0.008261964656412601, 0.026844285428524017, 0.0005292377318255603, -2.966703505080659e-05, -0.00992287416011095, 0.04590926691889763, -0.031032051891088486, 0.04176408797502518, 0.01225808635354042, -0.018170643597841263, -0.01467847265303135, -0.00814839731901884, 0.007949655875563622, 0.022102883085608482, 0.03512044623494148, 0.007935460656881332, 0.004599444102495909, -0.05888424068689346, 0.009575077332556248, 0.03287750855088234, -0.04920269548892975, -0.04201961308717728, -0.054568711668252945, 0.008503292687237263, 0.0293569453060627, 0.028647154569625854, 0.013769940473139286, 0.03707946836948395, 0.03631289303302765, -0.025467291474342346, -0.005578955169767141, -0.003765439847484231, 0.003359084716066718, 0.04721527919173241, -0.02286945842206478, 0.000507056771311909, -0.009993853978812695, 0.012357456609606743, 0.04412059113383293, -0.05036675184965134, -0.05008283630013466, -0.03248002380132675, -0.04866325482726097, -0.009887385182082653, -0.029300162568688393, -0.0027983500622212887, -0.043694719672203064, 0.003960632253438234, -0.04877682030200958, 0.007857383228838444, 0.03923723101615906, 0.010086126625537872, 0.029243377968668938, 0.020186448469758034, 0.03895331546664238, 0.04375150054693222, -0.016878824681043625, -0.02844841219484806, 0.022216450423002243, -0.0275682732462883, -0.003907397855073214, 0.005444095004349947, -0.008198083378374577, -0.021563442423939705, -0.0027894775848835707, 0.019519245252013206, -0.15887956321239471, -0.007807698100805283, -0.022684911265969276, -0.006636543665081263, -0.031685058027505875, -0.040145765990018845, -0.06337011605501175, -0.022102883085608482, -0.04599444195628166, -0.03035065159201622, -0.016609102487564087, 0.052808430045843124, 0.02518337592482567, -0.028675546869635582, 0.004624286666512489, -0.012840114533901215, 0.021818967536091805, -0.054057661443948746, -0.03460939601063728, -0.02224484272301197, -0.011725743301212788, -0.017020782455801964, 0.01220130268484354, -0.02592155709862709, 0.0022606835700571537, -0.005078552756458521, -0.006334882229566574, 0.004798185545951128, -0.048748429864645004, -0.015828333795070648, 0.04221835359930992, 0.01746085286140442, -0.039407581090927124, 0.02921498753130436, -0.028490999713540077, 0.013336967676877975, -0.03895331546664238, 0.008872384205460548, -0.031174009665846825, 0.008127103559672832, 0.002567667979747057, 0.025495683774352074, -0.00040946053923107684, -0.009447314776480198, -0.049628566950559616, -0.025524074211716652, -0.0036838138476014137, 0.07012732326984406, -0.00298821902833879, -0.04713010415434837, 0.020953021943569183, 0.05649934336543083, -0.013273087330162525, -0.010128714144229889, 0.047328848391771317, 0.015416654758155346, -0.015544417314231396, 0.022471975535154343, -0.055448852479457855, -0.031287577003240585, 0.01743246056139469, -0.00808451697230339, -0.02252875827252865, -0.026730719953775406, 0.014344871044158936, -0.02086784690618515, 0.002567667979747057, -0.01537406723946333, -0.04755597934126854, -0.03466618061065674, 0.005834479816257954, 0.004209059290587902, -0.02566603384912014, 0.02200351282954216, -0.03233806788921356, -0.015998683869838715, 0.014217108488082886, -0.0008899001404643059, -0.003850614884868264, 0.030776526778936386, 0.03793121874332428, 0.043581150472164154, 0.07932621240615845, 0.047328848391771317, -0.003474425757303834, -0.01885204203426838, 0.054795846343040466, -0.03679555281996727, 0.038243524730205536, -0.014692668803036213, 0.01619742438197136, 0.028732329607009888, -0.0270572230219841, -0.0515591986477375, 0.039663106203079224, -0.03009512834250927, 0.0014497475931420922, -0.01202385500073433, -0.060247037559747696, -0.008936265483498573, 0.06467613577842712, 0.022954633459448814, 0.06019025668501854, -0.001377881271764636, -0.04068520665168762, 0.020796868950128555, -0.02286945842206478, -0.01220840122550726, 0.016538124531507492, 0.013138226233422756, -0.01555861346423626, 0.04781150445342064, 0.059508856385946274, 0.03137275204062462, -0.028405824676156044, 0.01510434690862894, -0.0004504953103605658, -0.0033306931145489216, 0.030123518779873848, -0.042048003524541855, 0.06234801933169365, -0.014465535059571266, 0.0034300638362765312, -0.025623446330428123, -0.010604273527860641, -0.039010100066661835, 0.013145324774086475, -0.01808546856045723, -0.01692141219973564, -0.019788965582847595, -0.0006552255945280194, -0.013606688939034939, 0.0221454706043005, 0.03202575817704201, 0.040798772126436234, 0.04150856286287308, -0.019448265433311462, -0.0574362650513649, 0.00929825846105814, -0.018511341884732246, 0.02907302789390087, -0.018781062215566635, 0.0003333798376843333, -0.004042258486151695, -0.03693750873208046, -0.005142434034496546, -0.004368762020021677, -0.006746560800820589, -0.0007004747167229652, -0.0006827299948781729, -0.021322114393115044, -0.009113713167607784, -0.001197771867737174, 0.02868974208831787, -0.01088109239935875, 0.039265625178813934, -0.030492611229419708, 0.04187765344977379, 0.03716464340686798, -0.02301141619682312, -0.008631055243313313, 0.046335138380527496, 0.021591834723949432, 0.026531977578997612, -0.0409691222012043, -0.0034957195166498423, 0.01143472921103239, 0.041423387825489044, -0.044063810259103775, 0.010717839933931828, -0.012627176940441132, 0.03074813447892666, 0.06121235340833664, 0.004507170990109444, -0.008879481814801693, 0.030521001666784286, 0.011888994835317135, 0.004737853072583675, -0.04375150054693222, 0.012932387180626392, 0.030492611229419708, -0.024700718000531197, 0.010341650806367397, -0.03619932755827904, 0.02454456314444542, 0.01144892442971468, 0.029413728043437004, -0.023337919265031815, 0.009305357001721859, -0.021975120529532433, 0.03980506584048271, -0.0396914966404438, 0.020796868950128555, 0.012960778549313545, 0.01416032575070858, 0.05536367744207382, -0.0010886415839195251, -0.001434664591215551, 0.05093458294868469, -0.024956243112683296, -0.018270013853907585, 0.0023742499761283398, -0.03151470795273781, -0.006072259973734617, -0.044943951070308685, -0.06836704164743423, 0.04193443804979324, 0.013670569285750389, 0.012549100443720818, -0.027128202840685844, -0.04957178607583046, -0.037249818444252014, -0.006288745906203985, 0.011931582354009151, -0.001428453833796084, 0.05297878012061119, 0.02556666173040867, 0.010164203122258186, 0.023735402151942253, -0.04213317856192589, 0.027752818539738655, -0.006867225281894207, 0.024487780407071114, 0.009127909317612648, 0.010866896249353886, -0.03145792707800865, -0.024189667776226997, 0.05928172171115875, 0.02516917884349823, 0.007743816822767258, -0.08682160079479218, 0.0027255965396761894, -0.0288458950817585, 0.017247915267944336, -0.0053376262076199055, 0.014245499856770039, -0.010448119603097439, 0.04213317856192589, 0.029413728043437004, 0.03353051468729973, 0.013947388157248497, -0.04037289693951607, 0.04877682030200958, 0.0520702488720417, -0.014919801615178585, 0.007296648807823658, -0.00046180759090930223, -0.012087736278772354, -0.015757353976368904, 0.015317284502089024, -0.0067962463945150375, 0.019632812589406967, 0.027383726090192795, 0.00846070609986782, 0.005497329402714968, -0.014068052172660828, -0.03932240605354309, 0.003776086727157235, -0.001024760422296822, -0.011179204098880291, 0.0060580638237297535, 0.007229218725115061, -0.017773160710930824, 0.017730573192238808, -0.05272325500845909, 0.018497146666049957, -0.0008455382194370031, 0.009958364069461823, 0.010533294640481472, 0.04818059504032135, 0.023877359926700592, -0.010370043106377125, -0.004500073380768299, -0.03384282439947128, -0.005206315312534571, 0.035830236971378326, -0.0037441460881382227, 0.00828325841575861, -0.004482328426092863, -0.007126299198716879, -0.009255670942366123, -0.0059161060489714146, -0.034581005573272705, 0.0379028245806694, -0.011271476745605469, 0.010441021993756294, -0.005344724282622337, 0.03991863131523132, 0.03466618061065674, 0.0046349335461854935, -0.0212511345744133, -0.01669427752494812, -0.005564759485423565, 0.021946730092167854, -0.01936309225857258, 0.019022392109036446, 0.010831406340003014, 0.04037289693951607, -0.00515308091416955, 0.02326694130897522, 0.015530221164226532, -0.08704873919487, 0.015260500833392143, 0.0015083053149282932, 0.005366018041968346, -0.03676715865731239, 0.021066589280962944, -6.487930659204721e-05, 0.023323724046349525, 0.03134435787796974, 0.013606688939034939, -0.016282599419355392, -0.014139031991362572, -0.061382703483104706, -0.022983023896813393, 0.011818015947937965, 0.03671037778258324, -0.060985222458839417, 0.014188717119395733, -0.0412246473133564, -0.041536953300237656, 0.010582979768514633, 0.0396914966404438, -0.05587472766637802, -0.011917386204004288, -0.0778498500585556, 0.06677711009979248, 0.03188379853963852, 0.01417452096939087, -0.03795960918068886, 0.012960778549313545, -0.0018401325214654207, -0.05195668339729309, 0.0072824531234800816, -0.012101932428777218, -0.02871813252568245, -0.033956389874219894, 0.0215066596865654, 0.004255195613950491, -0.025069808587431908, 0.016481341794133186, 0.001198659068904817, 0.05831640586256981, 0.005855773575603962, -0.005326979327946901, -0.03531918674707413, 0.07506746798753738, -0.006661386229097843, 0.03452422097325325, 0.02569442428648472, 0.005330528598278761, 0.029413728043437004, -0.06325655430555344, -0.03929401561617851, -0.012662666849792004, 0.02502722106873989, -0.016225816681981087, 0.026858482509851456, 0.03009512834250927, 0.0022997220512479544, 0.0032455180771648884, -0.022315820679068565, -0.06564144790172577, -0.06285906583070755, -0.029158202931284904, -0.009894482791423798, -0.01088109239935875, -0.02286945842206478, -0.02238680049777031, -0.017503440380096436, -0.010767525993287563, -0.03225289285182953, 9.748532465891913e-05, 0.03134435787796974, 0.03412673994898796, 0.029669253155589104, -0.0017212425591424108, -0.00790706928819418, 0.0073463344015181065, 0.014117738232016563, 0.004304880741983652, 0.004595894832164049, 0.042814578860998154, -0.017475048080086708, -0.008716230280697346, -0.019916728138923645, -0.00878011155873537, -0.007537977769970894, -0.008936265483498573, -0.03429709002375603, -0.025878969579935074, -0.015061759389936924, -0.010412630625069141, 0.042161568999290466, -0.010866896249353886, -0.011775428429245949, -0.01923532970249653, 0.027341138571500778, 0.035830236971378326, 0.06473291665315628, 0.0011046117870137095, -0.007509585935622454, 0.014210010878741741, 0.035461146384477615, 0.05269486457109451, 0.05882745608687401, -0.03202575817704201, -0.0031355007085949183, -0.028647154569625854, 0.02932855300605297, -0.008183887228369713, -0.029385337606072426, 0.005323430523276329, -0.03719303384423256, 0.017475048080086708, -0.014806235209107399, 0.008843992836773396, -0.030776526778936386, -0.020143860951066017, -0.004255195613950491, 0.04272940382361412, 0.023479877039790154, 0.004216156899929047, 0.012180008925497532, -0.03060617670416832, 0.014536513946950436, 0.0026723621413111687, -0.03602897748351097, -0.03614254295825958, -0.022670716047286987, -0.011321162804961205, 0.020058685913681984, -0.015856726095080376, 0.02147826738655567, -0.002642196137458086, -0.008496195077896118, 0.008751720190048218, -0.018042881041765213, -0.012719450518488884, 0.01743246056139469, 0.049515001475811005, -0.03196897357702255, 0.0042232549749314785, -0.020697498694062233, 0.0017895599594339728, -0.021038196980953217, 0.01934889517724514, -0.004088394809514284, -0.016240011900663376, -0.007239865604788065, 0.018525538966059685, -0.009575077332556248, 0.014252598397433758, 0.009993853978812695, -0.03313303366303444, 0.0003187404072377831, 0.014990780502557755, -0.02809351682662964, 0.02416127733886242, 0.039379190653562546, -0.02718498557806015, -0.027625055983662605, -0.0042055100202560425, -0.015033368021249771, 0.03449583053588867, -0.03617093712091446, -0.005305685568600893, 0.014735255390405655, 0.00847490131855011, 0.015899311751127243, -0.05030996724963188, -0.01642455719411373, 0.009454412385821342, 0.010561686009168625, -0.035205621272325516, 0.021577639505267143, -0.004244548734277487, 0.024317430332303047, -0.02404771000146866, 0.0006676469347439706, 0.050508707761764526, -0.03301946446299553, -0.015288892202079296, -0.035830236971378326, -0.007250512484461069, -0.0029154655057936907, 0.013826723210513592, -0.03463778644800186, -0.02465813048183918, 0.04650548845529556, -0.004393604584038258, -0.004269391298294067, -0.015047564171254635, -0.008680740371346474, -0.010341650806367397, -0.009198888204991817, -0.0027859287802129984, 0.0014249049127101898, 0.007935460656881332, -0.007073064800351858, -0.01592770405113697, 0.0010646861046552658, 0.022415190935134888, -0.00014029457815922797, -0.048861995339393616, -0.0006933768163435161, -0.013805430382490158, -0.027412118390202522, 0.03565988689661026, 0.01163347065448761, 0.0015384714351966977, -0.04636353254318237, 0.037505343556404114, 0.022784283384680748, -0.010987560264766216, 0.035347577184438705, -0.001309563871473074, -0.004003219772130251, -0.02504141815006733, -0.020001903176307678, -0.014749451540410519, -0.040798772126436234, 0.022968828678131104, 0.005749305244535208, 0.008013537153601646, 0.011477316729724407, -0.00045559692080132663, 0.0011738163884729147, 0.015288892202079296, -0.02819288894534111, 0.005380213726311922, 0.005259549245238304, 0.005866420455276966, -0.020456168800592422, 0.03367247432470322, 0.00427294010296464, -0.0060190255753695965, 0.005138884764164686, -0.02059812657535076, -0.005369566846638918, -0.030066736042499542, -0.052410949021577835, 0.01720532774925232, 0.014387458562850952, 0.01050490327179432, -0.041139472275972366, -5.794776006950997e-05, -0.02528274618089199, 0.0138480169698596, -0.009717035107314587, -0.04840772971510887, 0.009695741347968578, -0.0014816882321611047, 0.018156446516513824, -0.004521367140114307, 0.021222742274403572, 0.009014341980218887, 0.046448707580566406, -0.014820430427789688, -0.011292770504951477, -0.025197571143507957, 0.016978194937109947, 0.05655612796545029, 0.01200965978205204, -0.0033892507199198008, -0.025467291474342346, 0.011051441542804241, -0.02238680049777031, 0.00904983188956976, 0.04434772580862045, -0.03353051468729973, 0.03392799571156502, -0.06501682847738266, -0.012549100443720818, 0.01756022311747074, -0.012627176940441132, 0.025978341698646545, -0.01417452096939087, 0.03707946836948395, -0.006586858071386814, 0.016509732231497765, -0.020512951537966728, 0.0020743634086102247, -0.030180301517248154, 0.00026750238612294197, -0.006189375184476376, -8.650574454804882e-05, 0.020413581281900406, -0.021038196980953217, -0.14718221127986908, -0.009816406294703484, 0.007594760973006487, -0.0399470217525959, 0.00802773330360651, -0.021591834723949432, 0.01012161560356617, -0.029498903080821037, 0.02137889713048935, 0.031912192702293396, 0.005106944590806961, -0.02008707821369171, -0.018397776409983635, -0.010405532084405422, 0.027213377878069878, -0.02200351282954216, -0.009809307754039764, 0.03276393935084343, 0.026759110391139984, -0.004145178012549877, -0.03355890512466431, -0.05984955653548241, 0.011044343933463097, 0.02998156100511551, 0.01530308835208416, 0.014167423360049725, -0.028008341789245605, -0.015956096351146698, 0.010561686009168625, 0.0061148470267653465, 0.014004170894622803, -0.009007244370877743, -0.00814839731901884, 0.009738328866660595, -0.046846188604831696, 0.007353432010859251, 0.0009608792024664581, -0.040032196789979935, 0.0023156923707574606, -0.011590883135795593, -0.010015147738158703, 0.0025907361414283514, -0.027752818539738655, -0.0044007026590406895, 0.054171230643987656, 0.009653153829276562, 0.0026457449421286583, 0.028490999713540077, 0.030009953305125237, 0.00635262718424201, 0.017020782455801964, -0.022429388016462326, 0.013216303661465645, -0.01555861346423626, -0.02098141424357891, 0.012180008925497532, -0.031656667590141296, 0.01105854008346796, 0.018426166847348213, -0.028888482600450516, 0.012868505902588367, 0.019135957583785057, 0.027241768315434456, -0.0036181584000587463, 0.004116786178201437, 0.027284355834126472, -0.009071125648915768, 0.019774770364165306, -0.029896385967731476, 0.004372310824692249, 0.024714913219213486, 0.0036802650429308414, -0.03111722692847252, 0.0011134842643514276, 0.01883784681558609, 0.014777842909097672, -0.001314000110141933, -0.015246305614709854, 0.027099810540676117, 0.004762696102261543, 0.021847359836101532, -0.0074599008075892925, 0.01188189722597599, 0.03707946836948395, 0.0027025281451642513, -0.011562490835785866, -0.07046802341938019, -0.013131128624081612, 0.010000951588153839, -0.007289550732821226, -0.031798623502254486, -0.04485877603292465, 0.022074492648243904, -0.013890604488551617, 0.02440260536968708, 0.015388263389468193, 0.03398478031158447, 0.009638958610594273, -0.07802020013332367, -0.018511341884732246, 0.02631903998553753, 0.005039514042437077, 0.013124031014740467, -0.013521513901650906, 0.021648617461323738, 0.026872677728533745, 0.024856870993971825, -0.014735255390405655, 0.05669808387756348, 0.02112337201833725, 0.004397153854370117, 0.00028635619673877954, 0.028647154569625854, -0.036738768219947815, 0.02745470590889454, -0.05527850240468979, 0.03690911829471588, 0.01497658435255289, -0.023451486602425575, -0.01555861346423626, 0.002572991419583559, 0.014863017946481705, -0.024445192888379097, -0.0069559491239488125, -0.007474096491932869, 0.021918337792158127, 0.03489331156015396, 0.02075428143143654, -0.054682277143001556, -0.026972047984600067, 4.807030109077459e-06, 0.06251836568117142, -0.03707946836948395, 0.006278099026530981, -0.018681691959500313, -0.006405861582607031, 0.006785599514842033, -0.03361568972468376, -0.020200643688440323, -0.05956563726067543, 0.013436338864266872, -0.027497293427586555, 0.022330015897750854, -0.018312601372599602, 0.02162022516131401, -0.019533440470695496, 0.03151470795273781, -0.013741549104452133, 0.007814795710146427, 0.0048301261849701405, -0.03557471185922623, 0.007466998416930437, -0.021421484649181366, -0.009688643738627434, 0.011079833842813969, -0.0021293722093105316, 0.04261583462357521, 0.020512951537966728, -0.013294380158185959, -0.007488292176276445, 0.015757353976368904, 0.01282591838389635, -0.026006732136011124, -0.016722669824957848, -0.02414708025753498, 0.04806702956557274, -0.045966047793626785, -0.03020869381725788, -0.02528274618089199, 0.06689067929983139, 0.003302301513031125, 0.0275682732462883, 0.0024860419798642397, -0.009709937497973442, 0.0230398066341877, 0.0282070841640234, -0.03009512834250927, -0.024856870993971825, 0.02668813243508339, -0.00917759444564581, -0.010788819752633572, 0.01643875427544117, -0.0284626092761755, 0.010952071286737919, 0.0042977831326425076, 0.014202912338078022, -0.007112103048712015, 0.02059812657535076, 0.054568711668252945, -0.002674136543646455, 0.00534827308729291, 0.000149056053487584, 0.01897980459034443, -0.01581413857638836, -0.000133529378217645, 0.012769135646522045, 0.02921498753130436, 0.011959973722696304, 0.02807932160794735, 0.06831026077270508, -0.059111371636390686, 0.014252598397433758, -0.003541855840012431, 0.013258891180157661, 0.0038648105692118406, -0.012002561241388321, 0.00300241494551301, 7.092361920513213e-05, 0.00033759421785362065, 0.02717079035937786, -0.039123665541410446, -0.01282591838389635, 0.005266647320240736, 0.017176935449242592, -0.01244972925633192, 0.051899898797273636, 0.025069808587431908, 0.02048456110060215, 0.018383579328656197, 0.04766954481601715, -0.010675252415239811, 0.01683623716235161, -0.026333237066864967, -0.004918850027024746, 0.018142251297831535, 0.008829796686768532, -0.016864627599716187, -0.0004941918305121362, 0.05073584243655205, 0.010079028084874153, 0.0010700095444917679, -0.004897556267678738, -0.012542002834379673, 0.004095492418855429, 0.01125728152692318, 0.017105957493185997, -0.027014635503292084, 0.02008707821369171, 0.008836894296109676, 0.011590883135795593, -0.035347577184438705, -0.0075805652886629105, 0.01974637806415558, -0.009809307754039764, -0.005564759485423565, -0.0368807278573513, 0.016112249344587326, -0.010895287618041039, 0.009347944520413876, -0.014919801615178585, -0.03392799571156502, 0.027156593278050423, -0.013549905270338058, 0.010185496881604195, -0.016594907268881798, -0.009773818776011467, -0.006636543665081263, 0.03753373399376869, 0.03071974404156208, 0.01543085090816021, -0.019930923357605934, -0.0017079339595511556, 0.00048798113130033016, -0.05042353272438049, -0.029058832675218582, -0.028519392013549805, -0.02037099376320839, 0.02807932160794735, -0.030521001666784286, -0.016240011900663376, 0.013635080307722092, 0.025382116436958313, 0.018482951447367668, 0.028405824676156044, -0.0035560515243560076, -0.01605546660721302, -0.008481998927891254, 0.03222449868917465, 0.057493049651384354, -0.00873042643070221, -0.013124031014740467, -0.0033697315957397223, 0.022060295566916466, -0.0013557003112509847, -0.0076941316947340965, -0.012144519947469234, -0.015274696983397007, 0.046221572905778885, 0.013315673917531967, 0.005933850537985563, 0.0033857019152492285, 0.0414801724255085, 0.019888335838913918, -0.027128202840685844, 0.016126446425914764, 0.028902679681777954, -0.029271770268678665, -0.02085365168750286, 0.017858335748314857, 0.024331627413630486, 0.0026031576562672853, 0.016722669824957848, -0.03830030933022499, 0.029782818630337715, 0.006157434545457363, -0.01594189926981926, -0.01907917484641075, 0.010760427452623844, -0.013769940473139286, 0.020385190844535828, -0.04312688484787941, 0.018937217071652412, -0.01845455914735794, -0.007026928476989269, 0.009184692054986954, 0.0015979163581505418, -0.04062842205166817, -0.012109030038118362, -0.025367921218276024, -0.015388263389468193, -0.04869164526462555, 0.013372457586228848, 0.011931582354009151, 0.0001679098786553368, -0.0033253696747124195, -0.007885775528848171, -0.03477974608540535, 0.00024909217609092593, 0.014721060171723366, 0.007708327379077673, 0.009248573333024979, -0.005259549245238304, 0.008368432521820068, -0.017986098304390907, -0.011030147783458233, -0.011739938519895077, -0.03225289285182953, 0.02944212034344673, 0.02160602994263172, 0.03565988689661026, 0.0002141571749234572, -0.00322599895298481, 0.010795917361974716, 0.030521001666784286, 0.008829796686768532, 0.02467232570052147, -0.007523782085627317, -0.005940948612987995, 0.004219706170260906, -0.0047484999522566795, 0.03858422487974167, 0.03310463950037956, -0.003822223050519824, -0.022542953491210938, 0.015984486788511276, 0.03781764954328537, 0.02465813048183918, 0.040798772126436234, -0.025225963443517685, 0.03631289303302765, 0.006906263995915651, -0.01995931565761566, 0.003960632253438234, -0.009078223258256912, -0.0020033842884004116, 0.003596864640712738, -0.0038648105692118406, 0.01995931565761566, -0.0432688444852829, 0.017503440380096436, 0.009142104536294937, 0.006412959191948175, 0.004539111629128456, -0.019164349883794785, 0.009347944520413876, -0.009816406294703484, -0.004720108583569527, -0.0019962864462286234, -0.03449583053588867, -0.020328406244516373, 0.011023050174117088, -0.004287136252969503, 0.008205180987715721, -0.016396166756749153, -0.021151764318346977, -0.025069808587431908, 0.03784604370594025, -0.015317284502089024, 0.03134435787796974, 0.030038343742489815, -0.035347577184438705, 0.01460749376565218, -0.022287430241703987, 0.003053874708712101, 0.0002652842958923429, -0.012293575331568718, 0.043439194560050964, -0.028874287381768227, 0.038385484367609024, 0.020129665732383728, 0.027994146570563316, -0.00016702263383194804, 0.02451617270708084, 0.0012998043093830347, 0.0004063551896251738, -0.0520702488720417, -0.012215498834848404, 0.008773013949394226, -0.013478926382958889, 0.015501829795539379, 0.034836530685424805, -0.002571217017248273, 0.0018277111230418086, -0.02096721902489662, -0.012811723165214062, -0.03642646223306656, -0.004315527621656656, 0.003985474817454815, 0.0017771385610103607, 0.006650739349424839, 0.013386653736233711, -0.006867225281894207, -0.002830290701240301, 0.004673972260206938, 0.012499415315687656, 0.005426350049674511, 0.014933996833860874, -0.0008615085389465094, 0.019717987626791, -0.015416654758155346, 0.022173862904310226, 0.015274696983397007, -0.01781574822962284, 0.0019412776455283165, -0.01632518693804741, 0.0036323540844023228, -0.01632518693804741, -0.008190984837710857, -0.0008646138594485819, 0.011498610489070415, -0.011569589376449585, -0.0010212113847956061, 0.002791251987218857, 0.014621688984334469, 0.0025392763782292604, 0.00968154612928629, 0.005717364605516195, -0.040543247014284134, 0.07870160043239594, 0.007112103048712015, 0.002455875976011157, 0.0022890751715749502, -0.03412673994898796, 0.013918996788561344, 0.004542660899460316, 0.01709176041185856, -0.02328113652765751, -0.03401317074894905, 0.0018401325214654207, 0.016850432381033897, -0.019448265433311462, -0.00822647474706173, 0.01087399385869503, -0.011015952564775944, -0.011718644760549068, -0.009191789664328098, -0.008893677964806557, 0.012499415315687656, -0.011683155782520771, 0.024984633550047874, 0.017730573192238808, -0.046988148242235184, 0.011782526038587093, 0.013315673917531967, 0.0021204997319728136, 0.0021027550101280212, 0.016736865043640137, 0.060644522309303284, 0.0030290319118648767, -0.030691351741552353, -0.03506366163492203, 0.02163442224264145, 9.049831714946777e-05, 0.02528274618089199, -0.06019025668501854, 0.010263574309647083, -0.01238584890961647, -0.04150856286287308, 0.006341980304569006, 0.01680784486234188, -0.005181472282856703, 0.00038306519854813814, 0.0021275978069752455, -0.006735913921147585, 0.006906263995915651, 0.0022961730137467384, 0.016353579238057137, -0.006586858071386814, -0.01619742438197136, 0.00010846489749383181, -0.01227228157222271, -0.021407289430499077, -0.00454975850880146, 0.010000951588153839, -0.01656651683151722, 0.08125684410333633, 0.017389873042702675, 0.02225903794169426, -0.028931070119142532, 0.006668483838438988, -0.02744051069021225, 0.015899311751127243, 0.004688167944550514, -0.05260968953371048, -0.01042682584375143, -0.007509585935622454, -0.004152275621891022, 0.028746524825692177, -0.01922113262116909, 0.0037902826443314552, 0.016083858907222748, 0.01683623716235161, 0.029924778267741203, 0.016140641644597054, -0.0045781503431499004, 0.0014790265122428536, 0.01907917484641075, 0.022727498784661293, -0.019888335838913918, -6.737466901540756e-05, -0.013202107511460781, 0.02881750464439392, -0.008176789619028568, -0.032167717814445496, 0.019647007808089256, -0.001263427548110485, -0.020456168800592422, -0.0037370482459664345, -0.01896560937166214, 0.005302136763930321, 0.03778925910592079, 0.02350826933979988, -0.027979951351881027, -0.021208547055721283, 0.003708656644448638, 0.008645251393318176, -0.006622347515076399, 0.028278063982725143, -0.008879481814801693, -0.013358261436223984, 0.008183887228369713, 0.01896560937166214, -0.03983345627784729, 0.0023813480511307716, -0.03262198343873024, 0.007172435522079468, -0.0062532564625144005, 0.017020782455801964, 0.027525685727596283, -0.006207120139151812, 0.029243377968668938, 0.01809966377913952, 0.018511341884732246, 0.002273104852065444, -0.008758817799389362, -0.0022447132505476475, -0.00878011155873537, -0.04111107811331749, 0.018624909222126007, -0.004918850027024746, 0.0014772519934922457, 0.004485877696424723, -0.015587004832923412, 0.004421996418386698, 0.04704492911696434, -0.01846875436604023, 0.015885116532444954, -0.01719113253057003, -0.01497658435255289, -0.028803307563066483, -0.006657836958765984, 0.001260765828192234, 0.013202107511460781, 0.0314011424779892, 0.012478121556341648, -0.020811064168810844, -0.011867701075971127, -0.00534827308729291, -0.00039459927938878536, 0.020953021943569183, 0.009532489813864231, 0.05011122673749924, -0.010561686009168625, -0.04426255077123642, 0.010334553197026253, 0.005472486838698387, 0.03486492112278938, -0.007821894250810146, -0.0022447132505476475, 0.006636543665081263, 0.011228889226913452, 0.012421337887644768, -0.009092419408261776, -0.02553827129304409, 0.021648617461323738, -0.01694980263710022, -0.012144519947469234, 0.008340041153132915, 0.018270013853907585, -0.009830601513385773, 0.000630382914096117, -0.011910288594663143, 0.013755744323134422, -0.027539880946278572, -0.019576027989387512, -0.0012838339898735285, 0.013748646713793278, 0.03316142410039902, 0.006608151830732822, 0.02414708025753498, -0.01768798567354679, 0.007616054732352495, 0.0020087077282369137, -0.03250841423869133, -0.02139309234917164, -0.0013423917116597295, 0.014139031991362572, 0.015019171871244907, -0.025367921218276024, -0.023550856858491898, 0.022670716047286987, 0.01460749376565218, 0.014905605465173721, 0.009624762460589409, 0.017375677824020386, 0.01669427752494812, -0.013840919360518456, -0.027412118390202522, -0.0027326943818479776, -0.00011888994777109474, 0.011974169872701168, 0.012336162850260735, 0.020782673731446266, 0.038385484367609024, -0.006994987837970257, 0.0013539257925003767, 0.023678619414567947, 0.01949085295200348, -0.025722816586494446, 0.0014186942717060447, -0.005561210680752993, -0.0020708146039396524, 0.028803307563066483, -0.010348749347031116, 0.01835518889129162, -0.0012447955086827278, -0.010668154805898666, -0.003217126475647092, -0.013876409269869328, -0.003996121697127819, 0.007843188010156155, 0.022102883085608482, 0.019760575145483017, 0.00455330777913332, 0.0017176936380565166, 0.019036587327718735, -0.030890092253684998, -0.01897980459034443, 0.015388263389468193, 0.0024949144572019577, 0.00980221014469862, 0.002684783423319459, -0.010341650806367397, 0.048237379640340805, 0.017546027898788452, -0.024842675775289536, -0.012627176940441132, 0.041678912937641144, 0.003050325671210885, -0.009894482791423798, 0.0020548442844301462, 0.012542002834379673, 0.013606688939034939, 0.00692755775526166, 0.011562490835785866, -0.004446838982403278, -0.005788343492895365, -0.00682818703353405, -0.031429532915353775, 0.003719303524121642, 0.024629738181829453, 0.03906688094139099, -0.03872618451714516, 0.06995697319507599, 0.03316142410039902, 0.008985950611531734, -0.0030769428703933954, 0.00168220407795161, -0.006622347515076399, 0.03350212424993515, -0.009631860069930553, -0.0546254962682724, 0.009972560219466686, -0.03651163727045059, -0.024317430332303047, -0.008765915408730507, -0.0003196276375092566, -0.016367774456739426, 0.0019483756041154265, -0.022471975535154343, 0.008964656852185726, 0.013982878066599369, -0.007701229769736528, 0.02707141824066639, -3.981482586823404e-05, 0.02137889713048935, -0.006707522552460432, -0.02580799162387848, -0.023494074121117592, 0.022074492648243904, 0.0035596005618572235, -0.02844841219484806, 0.0007244301959872246, 0.0386693999171257, 0.03287750855088234, 0.007438607048243284, 0.013322772458195686, -0.01669427752494812, 0.03531918674707413, -0.00216308725066483, -0.005635738372802734, 0.01658071205019951, 0.01537406723946333, 0.006547819823026657, -0.03211093321442604, -0.0027788307052105665, 0.019405679777264595, 0.014905605465173721, -0.009007244370877743, 0.009653153829276562, 0.008872384205460548, -0.0371362529695034, 0.004020964726805687, 0.022798478603363037, 0.0027770563028752804, -0.04414898529648781, 0.001989188604056835, 0.04253065958619118, -0.0209956094622612, -0.03299107402563095, 0.02404771000146866, 0.025211766362190247, 0.018766866996884346, 0.05357500538229942, 0.004035160411149263, 0.03290589898824692, -0.0023636030964553356, 0.02149246446788311, -0.0054298993200063705, 0.03111722692847252, -0.025893166661262512, 0.003981926012784243, -0.010795917361974716, 0.03517723083496094, 0.017801551148295403, 0.0217621847987175, -0.022571345791220665, 0.05454032123088837, -0.0013636854710057378, 0.0033768294379115105, 0.004510720260441303, -0.003328918479382992, -0.009788013994693756, 0.02021484076976776, -0.015828333795070648, 0.03719303384423256, 0.025112396106123924, 0.0008255753782577813, 0.03540436178445816, -0.000775446358602494, 0.015019171871244907, 0.007037575356662273, 0.015587004832923412, 0.009042734280228615, 0.0025197570212185383, 0.006391665432602167, 0.044716816395521164, -0.019576027989387512, -0.0507926270365715, 0.016509732231497765, -0.009234377183020115, 0.005522171966731548, -0.01808546856045723, 0.010086126625537872, 0.01706336997449398, 0.007232767529785633, 0.010071930475533009, 0.014266793616116047, 0.03690911829471588, 0.018170643597841263, 0.031912192702293396, 0.006473291665315628, 0.013507317751646042, 0.0548810213804245, -0.0031922839116305113, -0.020953021943569183, -0.03148631751537323, 0.022216450423002243, -0.05428479611873627, -0.010064832866191864, 0.0031638923101127148, 0.017006585374474525, 0.015246305614709854, 0.005060807801783085, 0.0030254831071943045, 0.0005811411538161337, 0.0007608069572597742, -0.03020869381725788, 0.007466998416930437, 0.003525885520502925, 0.015004976652562618, 0.00512468907982111, -0.0396914966404438, 0.0012270507868379354, -0.020697498694062233, -0.01768798567354679, 0.0010212113847956061, -0.008609761483967304, 0.02856197953224182, -0.018042881041765213, 0.030691351741552353, -0.017787355929613113, 0.0015260501531884074, 0.009135006926953793, -0.03361568972468376, 0.023295331746339798, -0.009596371091902256]",Token-level Direct Preference Optimization.pdf
", Jenya Lee, Di-
ana Liskovich, Yinghai Lu, Yuning Mao, Xavier Mar-
tinet, Todor Mihaylov, Pushkar Mishra, Igor Moly-
bog, Yixin Nie, Andrew Poulton, Jeremy Reizen-
stein, Rashi Rungta, Kalyan Saladi, Alan Schelten,
Ruan Silva, Eric Michael Smith, Ranjan Subrama-
nian, Xiaoqing Ellen Tan, Binh Tang, Ross Tay-
lor, Adina Williams, Jian Xiang Kuan, Puxin Xu,
Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan,
Melanie Kambadur, Sharan Narang, Aurelien Ro-
driguez, Robert Stojnic, Sergey Edunov, and Thomas
Scialom. 2023. Llama 2: Open foundation and fine-
tuned chat models. Technical report, Meta.
Ben Wang and Aran Komatsuzaki. 2021. GPT-J-
6B: A 6 Billion Parameter Autoregressive Lan-
guage Model. https://github.com/kingoflolz/
mesh-transformer-jax .
Sean Welleck, Ilia Kulikov, Stephen Roller, Emily Di-
nan, Kyunghyun Cho, and Jason Weston. 2020. Neu-
ral text generation with unlikelihood training. In
International Conference on Learning Representa-
tions .
Jeff Wu, Long Ouyang, Daniel M. Ziegler, Nisan Stien-
non, Ryan Lowe, Jan Leike, and Paul Christiano.
2021. Recursively summarizing books with hu-
man feedback. Computing Research Repository ,
arXiv:2109.10862.
Zheng Yuan, Hongyi Yuan, Chuanqi Tan, Wei Wang,
Songfang Huang, and Fei Huang. 2023. RRHF: Rank
responses to align language models with human feed-
back without tears. Computing Research Repository ,
arXiv:2304.05302.
Yao Zhao, Rishabh Joshi, Tianqi Liu, Misha Khal-
man, Mohammad Saleh, and Peter J. Liu. 2023.
SLiC-HF: Sequence likelihood calibration with hu-
man feedback. Computing Research Repository ,
arXiv:2305.10425.
Rui Zheng, Shihan Dou, Songyang Gao, Yuan Hua,
Wei Shen, Binghai Wang, Yan Liu, Senjie Jin, Qin
Liu, Yuhao Zhou, Limao Xiong, Lu Chen, Zhiheng
Xi, Nuo Xu, Wenbin Lai, Minghao Zhu, Cheng
Chang, Zhangyue Yin, Rongxiang Weng, Wensen
Cheng, Haoran Huang, Tianxiang Sun, Hang Yan,
Tao Gui, Qi Zhang, Xipeng Qiu, and Xuanjing Huang.
2023. Secrets of RLHF in large language mod-
els part i: PPO. Computing Research Repository ,
arXiv:2307.04964.
Zhanhui Zhou, Jie Liu, Chao Yang, Jing Shao, Yu Liu,
Xiangyu Yue, Wanli Ouyang, and Yu Qiao. 2024.
Beyond one-preference-for-all: Multi-objective di-
rect preference optimization. Computing Research
Repository , arXiv:2310.03708.
Daniel M. Ziegler, Nisan Stiennon, Jeffrey Wu, Tom B.
Brown, Alec Radford, Dario Amodei, Paul Chris-
tiano, and Geoffrey Irving. 2020. Fine-tuning lan-
guage models from human preferences. Computing
Research Repository , arXiv:1909.08593.
A Proof of Thm. 1
Theorem 1. Letywandylbe two responses to a prompt x, and let brθ(x,yw)andbrθ(x,yl)be their
associated estimated rewards. Finally, let Rw∼Gumbel( brθ(x,yw),1)andRl∼Gumbel( brθ(x,yl),1)
be Gumbel random variables. Then, we have,
P(Rw−Rl>0) = pBT(yw≻yl|x)
=σ(∆brθ), (11)
where pBT(yw≻yl|x)is a Bradley–Terry model Eq. (5a)parameterized by brθ(x,yw)andbrθ(x,yl),
and∆brθdef=brθ(x,yw)−brθ(x,yl)is the difference between the estimated rewards.
Proof. We define a random variable Ias,
Idef= arg","[-0.020565297454595566, -0.0062245591543614864, 0.06030546873807907, -0.0020219711586833, 0.007635189685970545, -0.043426405638456345, 0.011050613597035408, 0.05115455761551857, -0.02518925443291664, 0.01723475381731987, 0.018609005957841873, -0.022570090368390083, -0.027323389425873756, 0.03560124337673187, 7.47755475458689e-05, -0.032400041818618774, 0.0367976538836956, -0.01911020465195179, -0.0025221591349691153, 0.04504317417740822, -0.021923381835222244, -0.020128769800066948, -0.015884751453995705, 0.04255335032939911, 0.006467074621468782, -0.005327252671122551, 0.01812397688627243, 0.013419179245829582, 0.009118574671447277, -0.03767070919275284, 0.028535965830087662, -0.03828508034348488, -0.0321575291454792, -0.061307866126298904, -0.04504317417740822, 0.03647429868578911, 0.02657967619597912, 0.04426712542772293, 0.02040361985564232, 0.023119790479540825, -0.021212004125118256, -0.029538363218307495, -0.04261802136898041, 0.03873777762055397, -0.01843116246163845, 0.03573058545589447, 0.04853539541363716, 0.011487141251564026, -0.0056586903519928455, 0.042068321257829666, -0.05070186406373978, 0.04944078251719475, -0.032060522586107254, -0.026191651821136475, -0.0005022087716497481, 0.004025754053145647, -0.019950924441218376, 0.042132988572120667, 0.023540150374174118, -0.03644196316599846, -0.008249562233686447, -0.045172516256570816, 0.00011045813880627975, 0.027727581560611725, -0.030799442902207375, -0.037315018475055695, -0.06547912955284119, 0.007914082147181034, 0.03767070919275284, 0.031963516026735306, -0.006875308696180582, -0.001345959841273725, 0.05361204594373703, 0.011042529717087746, -0.037250347435474396, 0.01935272105038166, 0.01873834803700447, 0.06337732821702957, 0.016943736001849174, -0.03802639618515968, 0.005848660599440336, -0.009522766806185246, 0.029764709994196892, -0.02651500515639782, -0.04853539541363716, -0.04740365594625473, -0.027016203850507736, 0.0027747792191803455, -0.05526115000247955, -0.023216797038912773, -0.028616804629564285, -0.0321575291454792, -0.028471294790506363, 0.018204813823103905, 0.05283599719405174, -0.019530564546585083, 0.010234145447611809, 0.020468290895223618, 0.025787459686398506, 0.001665271702222526, 0.014203311875462532, -0.014316486194729805, 0.04009586200118065, -0.022133562713861465, 0.034760523587465286, 0.012174267321825027, -0.010654505342245102, 0.02525392547249794, -0.018948528915643692, 0.01662038080394268, -0.07572944462299347, 0.016499124467372894, -0.027937762439250946, 0.01482576783746481, -0.011042529717087746, -0.0430707149207592, -0.05024917051196098, -0.016765890643000603, -0.008079800754785538, 0.01049282867461443, -0.0008599188295193017, -0.007610938046127558, 0.04239167273044586, -0.033564116805791855, 0.006244768854230642, -0.019643738865852356, 0.014276066794991493, -0.07618213444948196, 0.0030334622133523226, -0.015157205983996391, 0.02371799573302269, 0.00991079118102789, -0.0035528489388525486, -0.0368623249232769, -0.044687483459711075, 0.000619929691310972, -0.005529348738491535, -0.013508101925253868, -0.03514854982495308, 0.006851057056337595, 0.008682047948241234, -0.0027080874424427748, -0.0737246498465538, -0.019158707931637764, -0.049020424485206604, 0.003346710931509733, -0.03569824993610382, 0.0018309904262423515, -0.04733898490667343, 0.023879673331975937, -0.012707801535725594, 0.006418571341782808, -0.020355116575956345, 0.039610832929611206, -0.021454518660902977, -0.08103244006633759, -0.005880995653569698, 0.07314261049032211, 0.021212004125118256, -0.06538212299346924, 0.008294022642076015, 0.034857530146837234, -0.03401681035757065, -0.012829058803617954, 0.06399170309305191, 0.036021605134010315, -0.0030759023502469063, 0.02611081302165985, -0.0679042786359787, -0.045948565006256104, -0.018900025635957718, 0.0336611233651638, -0.03931981325149536, -0.04995815083384514, -0.017525771632790565, -0.003467968665063381, -0.012335944920778275, -0.06609350442886353, 0.0005719318869523704, -0.06276296079158783, 0.010411989875137806, 0.045366525650024414, -0.010589834302663803, -0.02132517844438553, -0.0017804664094001055, -0.00011115283996332437, -0.006147762760519981, 0.00822531059384346, 0.013160496950149536, 0.02227907069027424, 0.014203311875462532, 0.06667553633451462, 0.08251987397670746, 0.015553314238786697, -0.008318274281919003, -0.03152698650956154, 0.07281925529241562, 0.01477726548910141, -0.017800621688365936, 0.03231920301914215, 0.03265872597694397, 0.05125156417489052, -4.393221388454549e-06, -0.06389469653367996, -0.025367099791765213, -0.0009791555348783731, 0.025512609630823135, 0.03259405493736267, -0.06706356257200241, -0.005670815706253052, 0.03763837367296219, -0.02067846991121769, 0.051445577293634415, 0.025237757712602615, -0.04442880302667618, 0.02552877739071846, -0.031720999628305435, 0.029166506603360176, 0.03102578967809677, 0.07210788130760193, -0.020435955375432968, 0.03020123764872551, 0.033499445766210556, 0.005367671605199575, -0.03585992753505707, 0.031478483229875565, 0.04507550969719887, -0.0107191763818264, 0.03369345888495445, -0.0009200423955917358, 0.08782286942005157, 0.010266480967402458, -0.020807811990380287, -0.0460779070854187, 0.00761902192607522, -0.022844940423965454, -0.014348821714520454, -0.006851057056337595, 0.007425009738653898, -0.055713847279548645, 0.0023402725346386433, 0.03964316472411156, 0.020823979750275612, -0.008924562484025955, 0.040289875119924545, 0.03931981325149536, -0.03071860410273075, -0.024898236617445946, 0.011074865236878395, -0.006944021210074425, 0.0042480593547225, -0.028810815885663033, 0.0019835729617625475, 0.006818721536546946, -0.04203598573803902, -0.03521322086453438, -0.023669492453336716, -0.014356905594468117, -0.020759308710694313, -0.03647429868578911, -0.029845548793673515, -0.010678756982088089, -0.02856830134987831, 0.04381442815065384, -0.004466323181986809, -0.028956325724720955, -0.03634496033191681, -0.006252852734178305, 0.0035306185018271208, 0.0017299423925578594, 0.008576957508921623, 0.003894391469657421, 0.014057802967727184, 0.00010351108358008787, -0.04678928479552269, -0.05037850886583328, 0.05429109185934067, 0.052706655114889145, -0.05678091570734978, 0.007837286219000816, -0.025916801765561104, 0.02712937816977501, 0.06276296079158783, -0.0008674974087625742, 0.007744321599602699, -0.010436241514980793, -0.013063490390777588, -0.0054687196388840675, -0.014947026036679745, -0.027517402544617653, 0.01907786913216114, -0.016402117908000946, 0.016943736001849174, -0.047727011144161224, 0.03443717211484909, 0.02378266677260399, 0.02866530790925026, -0.00860120914876461, -0.0005643533077090979, -0.014647923409938812, 0.024106020107865334, -0.02119583636522293, -0.0183988269418478, 0.030088063329458237, -0.027113210409879684, 0.03922280669212341, -0.003995439503341913, 0.008108094334602356, 0.01877068355679512, 0.01523804385215044, 0.014696426689624786, 0.0021866795141249895, -0.05108988657593727, 0.01859283819794655, -0.04805036261677742, -0.02948985993862152, 0.047727011144161224, 0.004809886682778597, -0.010654505342245102, -0.017832957208156586, -0.020726973190903664, -0.012238938361406326, 0.01404163520783186, -0.01143055409193039, -0.001208534580655396, 0.018900025635957718, 0.01259462721645832, -0.01775212027132511, 0.007623063866049051, -0.017929963767528534, 0.009813785552978516, 0.02549644187092781, 0.025609614327549934, 0.027258718386292458, 0.027355724945664406, -0.04617490991950035, -0.032367706298828125, 0.07294859737157822, 0.01917487569153309, 0.0017481311224400997, -0.07553543150424957, 0.011923668906092644, -0.02580362744629383, -0.020484458655118942, -0.008989233523607254, 0.012788639403879642, 0.05416174978017807, 0.042812034487724304, 0.04850305989384651, 0.04549586772918701, 0.010088636539876461, -0.017768288031220436, 0.024752726778388023, 0.012271273881196976, -0.016539543867111206, -0.004124781116843224, 0.007833244279026985, -0.028649140149354935, -0.02030661329627037, 0.010743427090346813, -0.012901813723146915, 0.011268877424299717, 0.02058146521449089, -0.0033446901943534613, 0.001371221849694848, 0.014890438877046108, -0.013249418698251247, 0.01213384885340929, -0.008560789749026299, -0.020565297454595566, -0.04730664938688278, 0.049020424485206604, -0.043458741158246994, 0.012303609400987625, -0.021114997565746307, -0.013661694712936878, 0.016701219603419304, 0.018269484862685204, 0.030702436342835426, 0.005428300704807043, -0.0008755812305025756, -0.0031264263670891523, 0.00670554768294096, -0.04986114427447319, 0.0004238965339027345, 0.021486854180693626, -0.0012913938844576478, -0.010921272449195385, -0.01812397688627243, -0.012222770601511002, -0.007368423044681549, -0.01658804528415203, -0.0523509681224823, 0.011826662346720695, -0.01165690179914236, -0.003918643109500408, -0.015892835333943367, 0.06515577435493469, 0.03382280096411705, 0.05409707874059677, -0.05852702260017395, 0.0005123135633766651, -0.048309046775102615, 0.004167221020907164, -0.019465893507003784, 0.01496319379657507, -0.010945523157715797, 0.055778518319129944, 0.023249132558703423, 0.028487462550401688, 0.0041874307207763195, -0.02177787385880947, 0.023087454959750175, -0.011600314639508724, 0.006826805416494608, -0.04805036261677742, 0.026967700570821762, 0.014364989474415779, 0.05716893821954727, 0.044719818979501724, -0.00277275824919343, -0.007534141652286053, 0.005561684258282185, -0.024316199123859406, -0.037315018475055695, 0.01969224214553833, -0.004114676266908646, -0.042779698967933655, 0.02611081302165985, -0.056974925100803375, -0.013160496950149536, 0.03757370263338089, 0.05186593905091286, -0.028374290093779564, -0.0308479443192482, -0.021212004125118256, 0.08329591900110245, 0.0034255285281687975, 0.016976069658994675, -0.04779168218374252, 0.02808327041566372, 0.03770304471254349, -0.040904246270656586, 0.006604499649256468, 0.013419179245829582, 0.01080001424998045, 0.004535036161541939, -0.008698214776813984, 0.001797644654288888, -0.010080552659928799, -0.003269914537668228, 0.027840755879878998, 0.03938448429107666, -0.015035947784781456, -0.023329971358180046, -0.003183013293892145, 0.08122645318508148, 0.008488034829497337, 0.020387452095746994, -0.012756304815411568, 0.011357799172401428, -0.004349107388406992, -0.01788146048784256, -0.02743656374514103, -0.014720678329467773, 0.029716206714510918, 0.014235647395253181, -0.003195138880982995, -0.005084737204015255, -0.0017784454394131899, -0.031041957437992096, -0.05487312749028206, 0.031720999628305435, -0.058430016040802, -0.008479950949549675, 0.012974567711353302, 0.006859140936285257, -0.023459313437342644, 0.023556318134069443, -0.013014987111091614, 0.057653967291116714, -0.035989269614219666, 0.010969774797558784, -0.014154809527099133, 0.013976965099573135, 0.06900368630886078, 0.032982081174850464, -0.037250347435474396, -0.01972457766532898, -0.008560789749026299, 0.014405407942831516, -0.021034160628914833, 0.04119526594877243, -0.022359909489750862, 0.0276467427611351, -0.0028414707630872726, 0.03343477472662926, -0.01662038080394268, 0.01624852418899536, -0.020532961934804916, 0.006378152407705784, -0.0026535214856266975, -0.020662302151322365, 0.013330257497727871, -0.004120739176869392, 0.009142826311290264, 0.04552820324897766, -0.015310798771679401, -0.013661694712936878, 0.06218092143535614, -0.023022785782814026, -0.00953893456608057, -0.018641341477632523, 0.021858712658286095, -0.0006118458695709705, 0.020532961934804916, -0.049634795635938644, 0.004688628949224949, -0.00964402500540018, 0.026870694011449814, -0.0029324141796678305, -0.0036235826555639505, -0.0338551364839077, -0.0246395543217659, 0.02808327041566372, -0.003942894283682108, 0.0024776977952569723, -0.07281925529241562, -0.021066494286060333, -0.037315018475055695, 0.03130064159631729, -0.01695990189909935, -0.006487283855676651, 0.0005613218527287245, -0.012012590654194355, -0.0036801695823669434, -0.022650929167866707, -0.025205422192811966, -0.01534313429147005, -0.014187145046889782, -0.03044375218451023, 0.004207640420645475, 0.019740745425224304, 0.021034160628914833, -0.0013338341377675533, -0.012521873228251934, 0.018689844757318497, -0.022844940423965454, 0.006471116561442614, 0.022408412769436836, 0.04258568584918976, -0.039804842323064804, 0.0005239340825937688, -0.02931201457977295, -0.024009013548493385, 0.013047322630882263, 0.007990879006683826, 0.0005572799127548933, 0.009191329590976238, 0.006382194347679615, 0.015415889210999012, -0.004256143234670162, 0.0004789677041117102, 0.018204813823103905, -0.03023357316851616, 0.015957506373524666, 0.0019340594299137592, 0.016442537307739258, 0.03160782530903816, 0.013863790780305862, -0.016571877524256706, 0.01396079733967781, 0.022683262825012207, -0.01972457766532898, 0.0014561022398993373, -0.034857530146837234, 0.04378209263086319, 0.006483242381364107, 0.004526952281594276, 0.0019239546963945031, -0.03954616189002991, -0.022311406210064888, -0.00796662736684084, -0.03880244866013527, -0.042165324091911316, 0.0037306935992091894, 0.015060199424624443, -0.0032739564776420593, -0.051477912813425064, 0.012707801535725594, 0.046433594077825546, -0.030346747487783432, -0.02839045785367489, 0.016782058402895927, -0.012893729843199253, -0.005258540157228708, 0.008997317403554916, -0.021697035059332848, -0.03401681035757065, 0.012497621588408947, 0.043329399079084396, -0.008593125268816948, -0.007509890012443066, -0.02181020937860012, -0.013968881219625473, -0.008067675866186619, -0.021341346204280853, 0.00975719839334488, 0.0006911685923114419, 0.0019189022714272141, -0.007703902665525675, 0.001517741591669619, -0.010848517529666424, -0.024720391258597374, -0.03964316472411156, -0.01935272105038166, -0.015068283304572105, -0.04200365021824837, 0.07074979692697525, -0.032303035259246826, 0.004708838649094105, 0.00715015921741724, 0.040354546159505844, -0.023556318134069443, -0.004381442908197641, 0.006758092902600765, -0.013386843726038933, -0.007768573239445686, 0.004745216108858585, -0.004349107388406992, -0.02030661329627037, -0.015318882651627064, 0.030864112079143524, 0.003914601169526577, -0.013685946352779865, -0.011155703105032444, -0.0030253783334046602, 0.003957041073590517, -0.0074088419787585735, -0.06486475467681885, 0.024558715522289276, 0.009530850686132908, -0.0011701362673193216, -0.04417011886835098, 0.0337904654443264, -0.011188038624823093, -0.019223378971219063, 0.011616482399404049, -0.02982938103377819, -0.03088027983903885, -0.017865292727947235, -0.036571305245161057, 0.009482348337769508, -0.017865292727947235, 0.017331760376691818, -0.037832386791706085, -0.0092640845105052, 0.0016784078907221556, 0.001315645407885313, -0.038479093462228775, -0.032335370779037476, -0.009401509538292885, -0.006745967082679272, 0.0247365590184927, 0.008665880188345909, 0.03252938389778137, 0.014615587890148163, 0.05054018646478653, 0.012255106121301651, -0.02027427777647972, -0.013176663778722286, 0.010266480967402458, 0.02119583636522293, -0.0026494795456528664, -0.016183853149414062, -0.0027000035624951124, -0.010508996434509754, -0.05041084438562393, -0.004203598480671644, 0.03408148139715195, -0.036668311804533005, 0.02484973333775997, -0.052609652280807495, -0.03870544210076332, 0.01805930584669113, 0.006576206535100937, 0.04248867928981781, -0.016361698508262634, -0.00017115010996349156, -0.012546124868094921, -0.017703616991639137, 0.011802410706877708, 0.02252158708870411, -0.027695246040821075, -0.005626354832202196, -0.005816325079649687, -0.01662038080394268, 0.048244375735521317, -0.02826111577451229, -0.0986228883266449, -0.030346747487783432, 0.019579067826271057, -0.011713488958775997, -0.015246127732098103, -0.03139764815568924, -0.035342562943696976, -0.022376077249646187, 0.03550424054265022, 0.05477612093091011, -0.014429659582674503, 0.003168866503983736, -0.011850913986563683, 0.002421111101284623, 0.0524156391620636, -0.02071080543100834, 0.020823979750275612, 0.038446757942438126, 0.038446757942438126, 0.006293271668255329, 0.012004506774246693, -0.04122760146856308, 0.0013489912962540984, -0.025383267551660538, 0.007178452797234058, 0.004611832555383444, -0.023863505572080612, -0.02430003322660923, 0.00269191968254745, -0.01373444963246584, 0.0034619057551026344, 0.009207497350871563, 0.03320842608809471, 0.024995243176817894, -0.03369345888495445, -0.015650320798158646, 0.0292796790599823, -0.018414994701743126, -0.009215581230819225, -0.002332188654690981, -0.010234145447611809, 0.01153564453125, -0.019708409905433655, -0.03437250107526779, 0.031106628477573395, 0.03573058545589447, 0.021551525220274925, 0.037250347435474396, 0.041518617421388626, -0.0013419179012998939, 0.015326966531574726, -0.030799442902207375, 0.017121579498052597, -0.008851808495819569, 0.004017670173197985, 0.005662732291966677, -0.02150302194058895, 0.01784912496805191, -0.012295525521039963, -0.03631262481212616, 0.011325464583933353, 0.011543727479875088, 0.0031001537572592497, -0.016798226162791252, 0.005363629665225744, 0.01307157427072525, -0.042132988572120667, -0.019191043451428413, -0.011673069559037685, 0.01938505657017231, 0.0002084115840261802, 0.0007048100815154612, -0.032610222697257996, 0.003993418533354998, 0.0008397091878578067, 0.06589949131011963, 0.0026939406525343657, 0.01004821714013815, -0.0028515756130218506, -0.007077404763549566, -0.026563508436083794, -0.0214383527636528, -0.014680258929729462, 0.012570375576615334, -0.04695096239447594, -0.02484973333775997, -0.029877884313464165, -0.030492255464196205, 0.0011388113489374518, 0.024283865466713905, -0.03948149085044861, -0.026029974222183228, 0.0068389312364161015, -0.012497621588408947, 0.003987355623394251, 0.018479665741324425, 0.03767070919275284, -0.02221440151333809, -0.11511392891407013, -0.025399435311555862, 0.024203026667237282, 0.005497013218700886, 0.0033042707946151495, -0.016159601509571075, 0.021082662045955658, 0.010452409274876118, -0.0026131023187190294, -0.021357513964176178, 0.02805093489587307, -0.009975462220609188, -0.008326358161866665, 0.004128823056817055, -0.0033709625713527203, -0.05160725489258766, 0.0013651590561494231, -0.022133562713861465, 0.030039560049772263, -0.01058175042271614, -0.015779661014676094, -0.007578602991998196, 0.022537754848599434, 0.009522766806185246, -0.02368566021323204, 0.01281289104372263, 0.014470078982412815, -0.00563848065212369, 0.008964981883764267, -0.013491934165358543, -0.005125156603753567, -0.019870085641741753, 0.03118746727705002, 0.028244948014616966, -0.04232700169086456, 0.006555996835231781, -0.008047466166317463, -0.001884545898064971, 0.019870085641741753, 0.008593125268816948, 0.0006997576565481722, -0.050184499472379684, 0.023912006989121437, 0.0046562934294342995, 0.028244948014616966, -0.0460779070854187, 0.01351618580520153, -0.03327309712767601, 0.017558107152581215, -0.0338551364839077, 0.011196122504770756, 0.01354852132499218, -0.002083610510453582, 0.012206602841615677, -0.00975719839334488, -0.004906892776489258, 0.029570698738098145, 0.00998354610055685, 0.006527703255414963, 0.00563848065212369, -0.043458741158246994, 0.00730375200510025, 0.017655113711953163, -0.019853917881846428, -0.029570698738098145, -0.02617548406124115, -0.00668129650875926, 0.026935365051031113, -0.01655570976436138, -0.040936581790447235, -0.026676682755351067, 0.027242550626397133, 0.001233796589076519, 0.026466501876711845, 0.007659441325813532, -0.01042815763503313, 0.00022811595408711582, 0.044622812420129776, -0.047080300748348236, 0.021114997565746307, 0.019837750121951103, -0.03159165754914284, -0.011681153438985348, 0.005517222918570042, 0.0023281467147171497, 0.03589226305484772, 0.04239167273044586, -0.004324856214225292, -0.017525771632790565, 0.039675500243902206, 0.03634496033191681, -0.00784941203892231, 0.008746718056499958, -0.003081965260207653, 0.0059820436872541904, -0.013912294059991837, -0.004393568728119135, 0.010177558287978172, 0.024106020107865334, -0.005965876393020153, 0.04106592386960983, 0.04016053304076195, -0.05112222209572792, -0.00368623249232769, 0.003611456835642457, -0.010153306648135185, 0.017768288031220436, 0.01236827950924635, 0.0037306935992091894, -0.013249418698251247, 0.006814679596573114, 0.014599421061575413, -0.037767715752124786, -0.03157548978924751, -0.00278488383628428, 0.012820974923670292, 0.04665994271636009, 0.04138927534222603, 0.021454518660902977, 0.00025893558631651103, 0.009627857245504856, 0.01344343088567257, 0.0019734681118279696, 0.006454948801547289, -0.021066494286060333, -0.01668505184352398, -0.00949043221771717, 0.003017294453456998, -0.02282877266407013, -0.010832349769771099, 0.015504810959100723, -0.006091175600886345, 0.01784912496805191, -0.011414386332035065, -0.02805093489587307, 0.002920288359746337, 0.01153564453125, 0.003961083013564348, -0.04258568584918976, 0.009482348337769508, 0.015844332054257393, 0.006992524489760399, 0.01883535459637642, 0.011406302452087402, -0.014704510569572449, -0.0084476163610816, 0.012667382135987282, -0.05467911437153816, 0.0012125765206292272, 0.01199642289429903, 0.019530564546585083, -0.019126372411847115, -0.016135351732373238, 0.023669492453336716, 0.005852702539414167, -0.002396859461441636, 0.0199670922011137, -0.024801230058073997, -0.03047608770430088, 0.0306862685829401, 0.003754945006221533, 0.054485101252794266, 0.015302714891731739, -0.005969918332993984, 0.03566591441631317, -0.03754136711359024, -0.010597918182611465, -0.025383267551660538, -0.026903029531240463, 0.03218986466526985, -0.029295846819877625, -0.022020388394594193, 0.001960332039743662, 0.011923668906092644, 0.0019573005847632885, 0.02371799573302269, 0.01027456484735012, 0.017994634807109833, 0.006919769570231438, 0.03398447483778, 0.034760523587465286, 0.017461100593209267, 0.0026898987125605345, -0.023928174749016762, 0.029085667803883553, -0.017687449231743813, 0.01194792054593563, -0.0008669921662658453, 0.00827381294220686, 0.0325455516576767, 0.013031154870986938, 0.019853917881846428, 0.007788782939314842, 0.0524803102016449, 0.029231175780296326, -0.02931201457977295, 0.0277760848402977, 0.04665994271636009, -0.01080001424998045, -0.04795335605740547, -0.012335944920778275, 0.04630425199866295, 0.004781593102961779, -0.011018278077244759, -0.03957849740982056, 0.015965590253472328, -0.005788031499832869, -0.011438637971878052, 0.006228601094335318, 0.008916478604078293, -0.005804199259728193, 0.012974567711353302, -0.041550952941179276, 0.020031763240695, -0.010032049380242825, -0.041550952941179276, 0.0014217458665370941, 0.012958400882780552, -0.026935365051031113, -0.013976965099573135, 0.009522766806185246, -0.031074292957782745, -0.017735952511429787, 0.009547018446028233, 0.005836534779518843, -0.010007797740399837, -0.00645899074152112, 0.01781678944826126, -0.010662589222192764, 0.0016531458823010325, -0.008245520293712616, 0.02484973333775997, -0.004171262960880995, -0.02743656374514103, -0.0005193869001232088, -0.014656007289886475, 0.001625862903892994, -0.01559373363852501, -0.020500626415014267, 0.018010802567005157, 0.031446151435375214, 0.016798226162791252, -0.0060305469669401646, 0.006758092902600765, -0.0008311201236210763, -0.010298816487193108, 0.018641341477632523, 0.030961118638515472, -0.02979704551398754, -0.03754136711359024, 0.014841935597360134, 0.020694637671113014, -0.00012226813123561442, 0.025415603071451187, 0.015925170853734016, 0.0012964463094249368, 0.031074292957782745, 0.03857610002160072, 0.027873091399669647, 0.007230997551232576, -0.02371799573302269, 0.005036234389990568, 0.017897628247737885, -0.00890839472413063, 0.0029162464197725058, -0.03197968378663063, -0.003195138880982995, 0.01914254017174244, 0.007485638838261366, -0.010969774797558784, -0.027565905824303627, 0.008673964068293571, -0.008843724615871906, 0.03573058545589447, 0.00982995331287384, -0.001467217574827373, 0.024041349068284035, 0.00781707651913166, 0.019546732306480408, 0.02688686177134514, -0.02839045785367489, 0.002738401759415865, -0.03446950763463974, -0.01699223741889, 0.03125213831663132, 0.00487859919667244, 0.008900310844182968, -0.009021569043397903, 0.03579525649547577, 0.023249132558703423, 0.032303035259246826, 0.037832386791706085, -0.006228601094335318, 0.008924562484025955, 0.008233394473791122, -0.014138641767203808, 0.0007376506691798568, -0.010120971128344536, 0.019304217770695686, -0.017897628247737885, 0.041615623980760574, 0.027016203850507736, 0.008568873628973961, -0.03954616189002991, 0.008051508106291294, 0.04252101480960846, 0.02897249348461628, -0.02436470240354538, -0.02208505943417549, -0.00670554768294096, -0.011858997866511345, 0.006087133660912514, 0.011131452396512032, 0.006119469180703163, 0.013807203620672226, -0.01273205317556858, -0.004235934000462294, -0.008932646363973618, 0.004834138322621584, 0.009053904563188553, -0.01726708933711052, -0.014712594449520111, 0.005444468464702368, 0.011074865236878395, -0.03589226305484772, 0.01552906259894371, 0.016103016212582588, -0.028794649988412857, 0.010703008621931076, 0.023766499012708664, 0.01978924870491028, 0.028810815885663033, 0.022909611463546753, -0.001965384464710951, -0.02822878025472164, -0.008964981883764267, -0.03437250107526779, -0.01080001424998045, -0.004902850836515427, -0.03186650946736336, 0.03307908773422241, 0.01993475668132305, 0.02095332182943821, -0.02454254776239395, -0.013572772964835167, 0.02279643714427948, -0.0002685351646505296, -0.006899559870362282, -0.009522766806185246, -0.042812034487724304, 0.10599534958600998, -0.007328003644943237, -0.0199670922011137, 0.013879958540201187, -0.014348821714520454, 0.038543764501810074, -0.015811996534466743, -0.00010237429523840547, -0.024526380002498627, 0.02347548119723797, 0.004967521410435438, 0.028002431616187096, -0.035374898463487625, -0.021082662045955658, 0.016636548563838005, 0.015391637571156025, -0.011446721851825714, 0.0021401974372565746, 0.011099116876721382, 0.022877275943756104, 0.003164824564009905, 0.015504810959100723, -0.003189076203852892, -0.01004821714013815, -0.0009741031099110842, 0.009918875060975552, 0.000980166019871831, -0.0006573175196535885, 0.010961690917611122, 0.04064556211233139, -0.015197625383734703, -0.012796723283827305, -0.058106664568185806, 0.032577887177467346, -0.03204435482621193, 0.013791035860776901, -0.04494616761803627, 0.02887548692524433, -0.01928805001080036, -7.401769107673317e-05, 0.015254211612045765, -0.00683488929644227, -0.0230712890625, 0.02399284578859806, 0.009530850686132908, 0.002402922371402383, -0.007032943423837423, 0.009660192765295506, 0.010824265889823437, 0.0029182673897594213, -0.020807811990380287, -0.008657796308398247, 0.009611689485609531, -0.020872483029961586, 0.007736237719655037, -0.017218586057424545, -0.01818864606320858, 0.031171299517154694, 0.00030415458604693413, 0.03128447383642197, -0.020937154069542885, 0.009191329590976238, -0.05176893249154091, 0.0009624825906939805, 0.014356905594468117, -0.03401681035757065, -0.007893872447311878, 0.0028515756130218506, -0.0004668419423978776, 0.04358808323740959, -0.017800621688365936, 0.0007593760383315384, -0.005266623571515083, 0.0029950637836009264, 0.011373966932296753, 0.019061701372265816, -0.014728762209415436, 0.023265300318598747, 0.020500626415014267, 0.0368623249232769, 0.017962299287319183, -0.003027399303391576, 0.0005441436660476029, 0.02341081015765667, -0.006762134842574596, -0.0022109311539679766, 0.008641628548502922, -0.011794326826930046, -0.03653896972537041, -0.0005294917500577867, 0.010250313207507133, 0.01668505184352398, 0.044655147939920425, -0.004543120041489601, -0.010096720419824123, -0.014235647395253181, 0.016531459987163544, 0.025997638702392578, 0.00991079118102789, 0.0260784775018692, -0.007441177498549223, -0.013847623020410538, 0.0337904654443264, 0.010525163263082504, -0.02190721407532692, 0.023265300318598747, -0.0460132360458374, 0.0020694637205451727, 0.0168952327221632, 0.014211395755410194, 0.0020815895404666662, -0.03290124237537384, 0.038543764501810074, -0.004522910341620445, 0.008779053576290607, 0.01172157283872366, -0.008326358161866665, 0.0066206674091517925, -0.00033648996031843126, -0.03118746727705002, 0.027242550626397133, -0.004179346840828657, 0.015787744894623756, 0.02808327041566372, -0.023556318134069443, 0.01935272105038166, 0.013774869032204151, 0.012651214376091957, 0.004064152017235756, -0.009037736803293228, -0.023944342508912086, 0.0007684703450649977, -0.0022715600207448006, -0.01032306719571352, 0.013031154870986938, -0.010597918182611465, 0.008253604173660278, -0.04239167273044586, -0.012942233122885227, 0.004084361717104912, 0.007752405479550362, 0.0035164717119187117, 0.0031425938941538334, 0.017897628247737885, -0.004296562634408474, -0.028212612494826317, -0.005715277045965195, 0.012521873228251934, 0.013386843726038933, -0.0027970096562057734, -0.0019775100518018007, -5.9776230045827106e-05, -0.011624566279351711, -0.013661694712936878, 0.011034445837140083, -0.00258076679892838, 0.005395965185016394, -0.017962299287319183, -0.01883535459637642, -0.009579353965818882, 0.029473692178726196, 0.0027141503524035215, 0.010808098129928112, 0.014696426689624786, 0.033499445766210556, -0.003855993039906025, -0.01165690179914236, 0.003494241274893284, 0.011406302452087402, 0.0013398970477283, 0.0048543475568294525, 0.008205100893974304, -0.01322516705840826, -0.017250921577215195, -0.005763780325651169, -0.013306005857884884, -0.019530564546585083, -0.019902421161532402, 0.007376506924629211, 0.011196122504770756, -0.02174553833901882, -0.0370563380420208, 0.02648266963660717, 0.0054161748848855495, 0.003356815781444311, -0.009312586858868599, 0.011487141251564026, 0.009700612165033817, -0.012150016613304615, -0.018075473606586456, 0.032674893736839294, -0.012384447269141674, 0.01702457293868065, -0.005497013218700886, 0.02085631527006626, 0.024558715522289276, 0.00938534177839756, 0.011115284636616707, 0.044525809586048126, 0.010250313207507133, 0.015221876092255116, -0.01723475381731987, 0.002499928465113044, 0.010226061567664146, -0.007344171404838562, -0.026870694011449814, 0.018657509237527847, 0.014696426689624786, -0.031510818749666214, -0.005185785237699747, 0.020177273079752922, 0.0051211146637797356, -0.0001429829717380926, 0.01614343374967575, 0.028681475669145584, 0.00826168805360794, -0.002138176467269659, 0.0007765541668049991, -0.03269106149673462, -0.020322781056165695, 0.004793718922883272, 0.014712594449520111, -0.009037736803293228, 0.007469471078366041, -0.007610938046127558, 0.00793429184705019, 0.03304675221443176, -0.0029122044797986746, -0.0032638516277074814, 0.019368888810276985, -0.003692295402288437, -0.009061988443136215, 0.005577851552516222, 0.02792159467935562, 0.011236541904509068, -0.007396716624498367, 0.0017885502893477678, -0.018107809126377106, -0.006911685690283775, -0.009441928938031197, -0.055002469569444656, 0.027501234784722328, 0.011907501146197319, 0.008924562484025955, -0.0246395543217659, 0.06389469653367996, 0.034243158996105194, 0.014284150674939156, -0.028794649988412857, 0.010209893807768822, 0.008811389096081257, 0.0030294202733784914, -0.021858712658286095, -0.057039596140384674, 0.03201201930642128, -0.02214973047375679, -0.016442537307739258, -0.026741353794932365, 0.030961118638515472, 0.034275494515895844, -0.028762314468622208, -0.0042238081805408, -0.002752548549324274, -0.0019138498464599252, -0.00245748832821846, 0.021341346204280853, -0.011406302452087402, -0.0018491791561245918, 0.003409360768273473, -0.01344343088567257, -0.003635708475485444, 0.026660514995455742, -0.01932038553059101, -0.019029365852475166, 0.024995243176817894, 0.03013656660914421, 0.0034861573949456215, -0.004203598480671644, 0.021826377138495445, -0.014736846089363098, 0.02552877739071846, -0.01474492996931076, -0.01451858226209879, 0.022747933864593506, 0.01624852418899536, 0.02193954959511757, 0.004401652608066797, -0.016086848452687263, 0.003302249824628234, 0.02252158708870411, -0.024688057601451874, -0.002447383478283882, 0.03330543264746666, -0.048244375735521317, 0.005695067346096039, 0.029942555353045464, 0.011317380703985691, -0.021341346204280853, -0.006580248475074768, 0.028891654685139656, -0.008673964068293571, -0.011422470211982727, 0.009878456592559814, -0.008706298656761646, 0.026983868330717087, 0.02645033411681652, -0.0037145258393138647, 0.030767107382416725, -0.005258540157228708, 0.022068891674280167, 0.021729370579123497, 0.007255249191075563, -0.008568873628973961, 0.026029974222183228, 0.01396079733967781, 0.028406623750925064, 0.022165898233652115, 0.004092445597052574, -0.009813785552978516, 0.02024194225668907, -0.009070072323083878, -0.009951210580766201, -0.016846729442477226, -0.016062596812844276, 0.05180126801133156, 0.002087652450427413, -0.022958114743232727, 0.026353327557444572, 0.01791379600763321, -0.015892835333943367, 0.0023443144746124744, -0.009247916750609875, 0.019983259961009026, -0.0004398115852382034, -0.025415603071451187, 0.00702081760391593, 0.010080552659928799, 0.01775212027132511, 0.017347928136587143, -0.020322781056165695, -0.019983259961009026, -0.0032638516277074814, -0.0010377633152529597, -0.0028818901628255844, -0.010840433649718761, 0.011470973491668701, 0.0215353574603796, 0.0027181922923773527, -0.0001827706437325105, 0.0012115660356357694, 0.021389849483966827, 0.02887548692524433, 0.0066893803887069225, -0.03647429868578911, 0.004502700641751289, 0.02255392260849476, 0.0012327861040830612, -0.019223378971219063, -0.03741202503442764, -0.0028839111328125, -0.03573058545589447, -0.010347318835556507, 0.03440483659505844, 0.006661086808890104, 0.014890438877046108, 0.020500626415014267, -0.012247022241353989, -0.0061760563403368, 0.015060199424624443, -0.03990184888243675, 0.0051211146637797356, 0.022909611463546753, -0.003047608770430088, 0.03054075874388218, -0.023055121302604675, 0.0007336087874136865, -0.023734163492918015, -0.0369269959628582, 0.017218586057424545, -0.012101513333618641, -0.0019684156868606806, -0.031413815915584564, 0.002471635118126869, -0.034178487956523895, 0.007756447419524193, 0.0037994063459336758, -0.018948528915643692, 0.021551525220274925, -0.010670673102140427]",Token-level Direct Preference Optimization.pdf
"max
l,w{Rl, Rw} (18)
To prove the theorem, it suffices to prove,
P(I=w) =exp 
brθ(x,yw)
exp 
brθ(x,yw)
+ exp 
brθ(x,yl) (19)
For ease of notation, we define gbrwdef= Gumbel( brθ(x,yw),1),brwdef=brθ(x,yw), andbrldef=brθ(x,yl).
Then, consider the following manipulation
P(I=w) = E
m∼gbrw
P(Rl< m)
(20a)
=Z+∞
−∞gbrw(m) exp 
−exp(brl−m)
dm (20b)
=Z+∞
−∞exp 
brw−m−exp(brw−m)
exp 
−exp(brl−m)
dm (20c)
=Z+∞
−∞exp(brw) exp(−m) exp
−exp(−m) 
exp(brw) + exp( brl| {z }
:=Z)
dm (20d)
= exp( brw)Z+∞
−∞exp(−m) exp
−Zexp(−m)
dm (20e)
=exp(brw)
exp(brw) + exp( brl). (20f)
■
B Datasets Statistics
We used the following datasets for either fine-tuning or prompting language models, which is consistent
with the intended use case of the datasets. All the datasets are in English. We refer to the corresponding
papers for data collection and postprocessing procedures, as well as the demographics of human annotators.
Sentiment Control. We train the SFT model on the train set of IMDB dataset (Maas et al., 2011), which
consists of 25000 movie reviews. For fine-tuning with DPO and ODPO, we sample 10000 prompts from
the train set and use the language model to generate continuations. For evaluation, we sample 256 prompts
from the test set of IMDB dataset.
Toxicity Control. We sample 10000 prompts for fine-tuning and 256for evaluation from REALTOXICI -
TYPROMPTS (Gehman et al., 2020). The dataset is released under Apache-2.0 license.
|DHF|= 5000 |DHF|= 7500 |DHF|= 10000
Method DKL(πθ∥πSFT)↓ Reward ↑ DKL(πθ∥πSFT)↓ Reward ↑ DKL(πθ∥πSFT)↓ Reward ↑
SLiC 0.55[0.52,0.56] 0 .71[0.71,0.72] 3 .56[3.24,3.88] 0 .81[0.81,0.82] 209 .42[85 .94,333.7] 0 .85[0.84,0.86]
DPO 0.39[0.37,0.4] 0 .72[0.71,0.73] 4.13 [3.42, 5.27] 0.83 [0.82, 0.84] 32.32 [27.57, 36.68] 0.86 [0.85, 0.86]
ODPO 0.35[0.32,0.39]0.76[0.75,0.78]3.09[2.43,4.04]0.87[0.87,0.88] 18.73[12.15,29.65] 0.89[0.88,0.89]
Table 1: Comparing ODPO to SLiC-HF on sentiment control task. In all 3experimental setups ODPO achieves
lower KL values and higher rewards compared to SLiC.
Summarization. We take 20000 posts under relationships andrelationship_advice subreddits
inREDDIT TL ;DRdataset (Stiennon et al., 2020) and 100posts for evaluation. The dataset is released
under a modified MIT license.
C Computational Budget
For sentiment control experiments, a single fine-tuning and evaluation run takes approximately 20minutes
on2rtx_4090 GPUs. For toxicity control experiments, a single fine-tuning and evaluation run takes
approximately 2hours on 2a100_40gb GPUs","[-0.004370030015707016, 0.024127934128046036, 0.031107349321246147, -0.002076455159112811, 0.0011694863205775619, 0.0013471298152580857, 0.0008591036894358695, 0.04857167974114418, -0.0024198992177844048, 0.01665901206433773, 0.03372857719659805, -0.035939253866672516, -0.02665441855788231, 0.017922254279255867, 0.03353909030556679, -0.009742758236825466, 0.04342396557331085, -0.03150211274623871, -0.044529303908348083, 0.06480434536933899, -0.0024850349873304367, -0.019548678770661354, -0.007607088889926672, -0.0008309767581522465, 0.01440886128693819, -0.011361287906765938, 0.009640119969844818, 0.009150614030659199, 0.01564052328467369, -0.017559072002768517, 0.009884873405098915, -0.03178634122014046, -0.02218569815158844, -0.05867762118577957, -0.019296031445264816, 0.03524446859955788, 0.01937498338520527, 0.0512244887650013, -0.018506504595279694, -0.04253969341516495, -0.01831701770424843, -0.0574459582567215, -0.03511814400553703, 0.00865321233868599, -0.043455544859170914, -0.0073347026482224464, 0.008969022892415524, -0.002621228341013193, 0.03287588804960251, -0.005056918133050203, -0.0749734491109848, 0.057003822177648544, -0.034107550978660583, -0.02425425872206688, 0.02458585985004902, 0.004291077144443989, -0.011321811936795712, 0.03960265591740608, 0.023748960345983505, -0.07010996341705322, 0.010145417414605618, -0.020243462175130844, 0.02397002838551998, -0.025928054004907608, -0.041118547320365906, -0.007587350904941559, -0.0839424729347229, -0.002008358482271433, 0.022943643853068352, 0.014077260158956051, 0.04061324894428253, 0.010516494512557983, 0.03953949362039566, -0.024743765592575073, 0.016437944024801254, -0.019896071404218674, 0.02561224438250065, 0.028186101466417313, 0.004279234446585178, -0.05731963366270065, -0.01838018000125885, 0.014890472404658794, 0.007559717632830143, -0.00971117801964283, -0.028217682614922523, -0.04339238256216049, -0.04200281575322151, 0.010342799127101898, -0.06632024049758911, -0.012892969883978367, -0.058488134294748306, 0.001201067352667451, -0.0197539571672678, 0.013595649041235447, 0.04478194937109947, -0.04336080327630043, -0.02119089476764202, 0.004859536420553923, 0.005309566389769316, 0.04086589813232422, -0.011369183659553528, -0.022580461576581, -0.0026172806974500418, -0.0046503120101988316, 0.020685598254203796, 0.036570873111486435, 0.018459131941199303, 0.03492865711450577, 0.011771841906011105, 0.01939077489078045, -0.06530964374542236, -0.028296634554862976, -0.06770980358123779, 0.02984410710632801, -0.00038637459510937333, -0.038307830691337585, -0.0526772178709507, -0.0009336152579635382, -0.036602456122636795, -0.02322787418961525, -0.029291437938809395, 0.02837558649480343, 0.03388648480176926, -0.0008285095100291073, 0.013650915585458279, -0.00022513845760840923, 0.02843874879181385, -0.09771181643009186, -0.0256911963224411, -0.0304599367082119, 0.010871781967580318, -0.03574976697564125, 0.023117339238524437, -0.02389107644557953, -0.03300221264362335, 0.009284833446145058, -0.030617842450737953, 0.03780253604054451, -0.018806524574756622, -0.010169102810323238, -0.003164028050377965, -0.01593264751136303, -0.03710775077342987, 0.010153312236070633, -0.06202521175146103, -0.028328215703368187, -0.026149122044444084, 0.0030357299838215113, -0.019359193742275238, 0.07055210322141647, 0.0018070291262120008, 0.019611841067671776, -0.021917259320616722, 0.021001407876610756, 0.0025245114229619503, -0.04367661476135254, -0.0172906331717968, 0.05024547502398491, -0.0018178850878030062, -0.04724527522921562, 0.0004147482104599476, 0.019485516473650932, 0.002368579851463437, -0.020732969045639038, 0.0065491232089698315, 0.03262323886156082, -0.007204430643469095, 0.006316212937235832, -0.05747753754258156, -0.04253969341516495, 0.011661308817565441, 0.01669059321284294, -0.022643623873591423, -0.057667024433612823, -0.0325600765645504, -0.04569780081510544, -0.004523987416177988, 0.022327812388539314, -0.013358790427446365, 0.007208378054201603, -0.003683141665533185, 0.027570270001888275, -0.029054580256342888, 0.012506102211773396, -0.026133332401514053, -0.05337199941277504, 0.007370231207460165, 0.011021791957318783, 0.03196003660559654, 0.016122134402394295, 0.045255668461322784, 0.004602940287441015, 0.08008958399295807, 0.01803278923034668, -0.00010788140934891999, -0.010263846255838871, 0.060446158051490784, 0.04926646128296852, -0.011116535402834415, 0.03704458847641945, 0.01456676609814167, 0.0706152617931366, -0.0081794960424304, -0.057698607444763184, -0.012371882796287537, -0.0016560321673750877, -0.032102152705192566, -0.0054793148301541805, -0.03420229256153107, 0.004176595713943243, 0.04895064979791641, 0.030917862430214882, 0.050434961915016174, 0.021933048963546753, -0.002534380415454507, 0.026828115805983543, -0.05002440884709358, 0.0020744812209159136, 0.03773937374353409, 0.04857167974114418, 0.013911459594964981, 0.04579254612326622, 0.053877297788858414, -0.0008408458670601249, -0.031754761934280396, 0.0499296635389328, 0.04064483195543289, 0.010524390265345573, 0.031754761934280396, -0.035528697073459625, 0.05214034020900726, -0.00692414864897728, -0.03524446859955788, -0.026843905448913574, -0.004016716964542866, -0.03012833558022976, -0.008929545991122723, -0.03162843734025955, 0.004591097589582205, -0.04778215289115906, 0.037328820675611496, 0.021396171301603317, 0.017211681231856346, -0.010540180839598179, 0.018601248040795326, 0.020353997126221657, -0.012790331616997719, -0.06575177609920502, -0.025185899809002876, -0.01057176198810339, 0.03496024012565613, -0.022280441597104073, -0.014172002673149109, -0.0654359683394432, -0.051856108009815216, -0.008740060031414032, -0.005443786270916462, -0.034139130264520645, -0.019911861047148705, 0.028186101466417313, -0.019975023344159126, -0.01662743091583252, -0.012892969883978367, 0.018790733069181442, -0.02769659459590912, -0.027665013447403908, 0.010540180839598179, 0.0304599367082119, -0.02251729927957058, -0.04026585817337036, -0.01632741093635559, 0.0058306544087827206, 0.02771238423883915, 0.0280755665153265, -0.04550831392407417, -0.025754358619451523, 0.04235021024942398, 0.03647613152861595, -0.0636674240231514, -0.010421751998364925, -0.008882174268364906, -0.018632829189300537, 0.030586261302232742, -0.02081192284822464, 0.007895266637206078, 0.01109284907579422, 0.011495507322251797, 0.00866900198161602, 0.01076914370059967, -0.010003302246332169, -0.002437663497403264, -0.047024205327034, 0.039318427443504333, -0.044908273965120316, 0.014977320097386837, -0.0045397779904305935, 0.015048377215862274, 0.00563327269628644, -0.008629526011645794, 0.0026883382815867662, 0.03770779073238373, 0.02291206270456314, 0.02014872059226036, -0.016564268618822098, 0.0415291003882885, -0.0009163443464785814, 0.003556817537173629, -0.004895064979791641, 0.0018080159788951278, 0.011684994213283062, 0.018253855407238007, -0.014100945554673672, -0.014779938384890556, 0.03087049163877964, 0.005842497106641531, 0.0003861278819385916, 0.06464643776416779, 0.015190492384135723, 0.008882174268364906, -0.029054580256342888, -0.017085356637835503, -0.039350006729364395, 0.0059096068143844604, 0.02951250597834587, -0.003361409530043602, 0.007997904904186726, -0.006959677208214998, -0.002165276790037751, -0.008447934873402119, -0.03303379565477371, -0.017243262380361557, 0.032086361199617386, 0.009924349375069141, 0.0034601003862917423, 0.012735064141452312, -0.048729583621025085, -0.036949846893548965, 0.020353997126221657, 0.020590854808688164, 0.046234678477048874, -0.07175218313932419, -0.0070860013365745544, -0.03745514526963234, 0.020306624472141266, -0.009253252297639847, 0.03287588804960251, 0.0006765256403014064, 0.0437081940472126, 0.05858287587761879, 0.05785651132464409, 0.002329103648662567, 0.0010707954643294215, -0.007599194068461657, 0.011977119371294975, 0.016580060124397278, -0.009158508852124214, -0.016485316678881645, -0.012356092222034931, -0.02254888042807579, -0.024001609534025192, -0.014274641871452332, 0.010800723917782307, 0.015585255809128284, 0.013745659030973911, 0.05754069983959198, -0.007855789735913277, -0.025091156363487244, 0.0007697884575463831, 0.004879274405539036, -0.006185941398143768, 0.021285638213157654, -0.009908558800816536, -0.03019149787724018, 0.009363786317408085, -0.04193965345621109, 0.02529643289744854, 0.03290747106075287, 0.015514198690652847, 0.03020728938281536, -0.0010717824334278703, 0.009300624020397663, -0.00011583836021600291, -0.03216531500220299, -0.025027994066476822, -0.02428583987057209, 0.019548678770661354, 0.004977965261787176, 0.01228503417223692, -0.02221727930009365, 0.0021317219361662865, -0.0016412284458056092, -0.02360684610903263, -0.017511701211333275, 0.013777240179479122, -0.0018583482597023249, -0.010713876225054264, -0.006430694367736578, 0.10124889761209488, 0.03612873703241348, 0.0568774975836277, -0.0007623866549693048, -0.018632829189300537, -0.054224688559770584, 0.019280239939689636, -0.02535959519445896, 0.03811834752559662, -0.00083640479715541, 0.021964630112051964, 0.044181909412145615, 0.010998105630278587, 0.033444348722696304, -0.02913353219628334, 0.02387528494000435, -0.024112142622470856, -0.008518991991877556, -0.03221268579363823, -0.00037502514896914363, 0.03786569833755493, 0.020038185641169548, 0.06445695459842682, -0.01838018000125885, -0.021775145083665848, -0.0029094056226313114, -0.03679193928837776, -0.06575177609920502, 0.03884471207857132, 0.016785336658358574, -0.025185899809002876, 0.03159685432910919, -0.03090207278728485, -0.010374380275607109, 0.06208837404847145, 0.040960643440485, 0.0001273111702175811, -0.06407798081636429, -0.020322415977716446, 0.04673997685313225, -0.01695903204381466, -0.006537280511111021, -0.01667480170726776, -0.001224753214046359, 0.004291077144443989, 0.006138569675385952, -0.0073347026482224464, -0.03372857719659805, -0.0014606242766603827, 0.04822428524494171, 0.002248177072033286, 0.009908558800816536, 0.010824410244822502, -0.03543395549058914, -0.017116937786340714, 0.02016451023519039, 0.0041963341645896435, -0.016895869746804237, -0.057351212948560715, 0.05315093323588371, -0.013469324447214603, 0.051129743456840515, -0.0009276937926188111, 0.023638427257537842, 0.0017507752636447549, -0.022627834230661392, 0.002167250495404005, -0.018474923446774483, 0.03710775077342987, 0.014479918405413628, -0.005862235091626644, -0.001736958627589047, -0.008084752596914768, -0.012261348776519299, -0.04440297931432724, -0.010484913364052773, -0.036570873111486435, -0.012640321627259254, -0.035181306302547455, 0.020053977146744728, -0.04336080327630043, 0.017906464636325836, -0.020180299878120422, 0.016532687470316887, -0.006916253361850977, -0.00024240935454145074, 0.032781146466732025, 0.04986650124192238, 0.0998593270778656, 0.04512934386730194, -0.03713933378458023, -0.010800723917782307, -0.015158911235630512, 0.017132727429270744, -0.01245083473622799, 0.01972237601876259, -0.021569866687059402, 0.0010609263554215431, -0.01631161943078041, -0.012561368755996227, 0.024001609534025192, -0.002546223346143961, -0.028296634554862976, 0.033412765711545944, 0.007839999161660671, -0.004895064979791641, 0.0026883382815867662, 0.01808016002178192, -0.004764793440699577, 0.028896674513816833, -0.04471878707408905, -0.0050766561180353165, -0.004358186852186918, -0.006059616804122925, 0.005716172978281975, 0.005092446692287922, 0.01877494342625141, 0.0007214299403131008, 0.025785939767956734, -0.03262323886156082, -0.002950855763629079, -0.028912466019392014, 0.02605437859892845, -0.019201287999749184, 0.012071861885488033, -0.02016451023519039, -0.020243462175130844, -0.013216676190495491, -0.03505498170852661, -0.0034482574556022882, -0.13251414895057678, -0.033823322504758835, -0.021411962807178497, 0.010350693948566914, -0.03578134626150131, 0.016737964004278183, 0.0037423563189804554, -0.046961043030023575, -0.004032507073134184, -0.005167451687157154, -0.039065778255462646, -0.059056591242551804, -0.023796333000063896, 0.03780253604054451, 0.008692688308656216, 0.002090271795168519, -0.0028067671228200197, 0.021601447835564613, -0.011669203639030457, 0.02949671447277069, -0.0048397984355688095, -0.026512304320931435, -0.03394964337348938, 0.038244668394327164, -0.05684591829776764, 0.004077904857695103, -0.024048980325460434, -0.006197784096002579, 0.010453332215547562, -0.00833740085363388, -0.024412162601947784, -0.0006602416397072375, 0.00027386704459786415, 0.006557018496096134, -0.013935144990682602, 0.0067938766442239285, -0.00468584056943655, -0.039002615958452225, -0.002110010012984276, 0.024191096425056458, -0.004180543590337038, 0.0032923261169344187, 0.04512934386730194, -0.045887287706136703, -0.01875915192067623, 0.005514843389391899, -0.04051850736141205, -0.0030475729145109653, -0.019896071404218674, 0.02775975689291954, -0.013248257339000702, 0.011053373105823994, -0.031738970428705215, -0.01730642467737198, -0.02700181119143963, 0.012885075062513351, -0.011069163680076599, -0.04253969341516495, 0.03568660467863083, 0.01695903204381466, -0.001224753214046359, -0.042476531118154526, 0.0017833432648330927, 0.01665901206433773, -0.029528295621275902, 0.0249648317694664, 0.002710050204768777, -0.0020863241516053677, 0.004326606169342995, 0.04989808425307274, -0.03322328254580498, -0.0071452162228524685, -0.017432747408747673, 0.017606444656848907, -0.03540237247943878, -0.0021198790054768324, -0.04029744118452072, -0.013579858466982841, 0.03524446859955788, -0.025770150125026703, -0.007986062206327915, 0.010879676789045334, 0.01945393532514572, -0.025470128282904625, -0.033412765711545944, -0.02084350399672985, -0.02565961517393589, -0.019564470276236534, 0.0028719031251966953, 0.009687491692602634, 0.0009888821514323354, 0.04655048996210098, -0.04705578833818436, -0.03751830384135246, -0.016185296699404716, 0.0020231620874255896, 0.002844269620254636, 0.004484511446207762, 0.011700784787535667, -0.021238265559077263, -0.03128104656934738, -0.01804857887327671, -0.003993031103163958, -0.04677155613899231, 0.008487410843372345, 0.015782637521624565, -0.03218110650777817, -0.01282191276550293, -0.014116736128926277, 0.015498408116400242, 0.013050875626504421, -0.011542879045009613, -0.03050730936229229, 0.030223079025745392, 0.018838105723261833, 0.012261348776519299, -0.05264563485980034, 0.04642416536808014, -0.02463323064148426, -0.01834859885275364, -0.023369988426566124, 0.005854339804500341, -0.030017802491784096, -0.02777554653584957, -0.03147052973508835, -0.02570698782801628, 0.021964630112051964, 0.029607249423861504, 0.011069163680076599, -0.01765381544828415, 0.0003091490361839533, -0.015119435265660286, -0.008605840615928173, -0.045224085450172424, 0.017211681231856346, -0.004097643308341503, 0.005609586834907532, 0.010477018542587757, 0.033854901790618896, 0.01732221432030201, 0.053940460085868835, 0.0013747632037848234, -0.0032686402555555105, 0.00847951602190733, 0.015727370977401733, 0.024506906047463417, 0.009434843435883522, 0.01661164127290249, -0.00510428985580802, 0.00728733092546463, -0.05368781089782715, -0.0076781464740633965, 0.06328845769166946, -0.045571476221084595, -0.012798226438462734, -0.03461284935474396, -0.03148632124066353, 0.008534782566130161, -0.009450634010136127, 0.040676411241292953, 0.004018690437078476, -0.005558267701417208, -0.006663604639470577, -0.01436938438564539, 0.010745457373559475, -0.011677098460495472, -0.009655910544097424, -0.02215411700308323, -0.004259495995938778, -0.01437728013843298, 0.04715052992105484, -0.011045477353036404, -0.026954438537359238, -0.018964430317282677, -0.004310815595090389, -0.021080361679196358, -0.025249062106013298, -0.0437081940472126, -0.01020068395882845, -0.01090336311608553, 0.005728015676140785, 0.04639258608222008, -0.051477137953042984, 0.004105538595467806, -0.007579455617815256, -0.035212889313697815, 0.02745973691344261, -0.011306021362543106, 0.015411559492349625, 0.031123138964176178, 0.014282536692917347, 0.012964027002453804, -0.003213373478502035, -0.039381589740514755, -0.009190090000629425, -0.015687894076108932, 0.02630702778697014, 0.0005960926064290106, 0.008155809715390205, -0.013453533872961998, -0.024885879829525948, -0.03565502166748047, -0.003882497316226363, 0.03123367391526699, 0.04329764097929001, -0.003454179037362337, -0.03219689428806305, -0.04171858727931976, 0.02458585985004902, -0.020259253680706024, 0.028991417959332466, 0.007658408489078283, -0.0024652970023453236, 0.03461284935474396, -0.013532486744225025, -0.011779737658798695, 0.008005799725651741, 0.0025541186332702637, -0.002483061281964183, 0.017053775489330292, 0.05750912055373192, 0.003835125593468547, -0.03698142617940903, -0.025027994066476822, 0.016785336658358574, 0.0023705537896603346, 0.006399113219231367, -0.002412003930658102, -0.024870088323950768, -0.01771697774529457, -0.006253051105886698, 0.0002664652420207858, 0.0204013679176569, -9.082640644919593e-06, 0.007863685488700867, -0.00736628333106637, -0.0024416111409664154, 0.009055870585143566, -0.018490713089704514, -0.04051850736141205, -0.012040280736982822, -0.008061067201197147, 0.0048871696926653385, -0.026275446638464928, -0.022722575813531876, 0.007867632433772087, 0.014424651861190796, 0.06707818061113358, -0.015758952125906944, 0.0008225880446843803, 0.01198501419275999, 0.010469122789800167, 0.00351141975261271, -0.01057176198810339, -0.018648618832230568, 0.01730642467737198, -0.035844508558511734, -0.020180299878120422, -0.01661164127290249, -0.0073820739053189754, 0.03162843734025955, 0.017827510833740234, -0.03641296923160553, -0.009426947683095932, 0.008440040051937103, -0.020938245579600334, 0.01943814568221569, 0.029196694493293762, 0.027238668873906136, -0.02324366383254528, -0.12266086041927338, -0.05176136642694473, 0.009079555980861187, -0.020275043323636055, -0.004831903148442507, -0.010848095640540123, 0.018601248040795326, 0.03464442864060402, 0.024349002167582512, 0.003499576821923256, 0.038686804473400116, -0.05166662111878395, -0.04228704795241356, -0.014187793247401714, -0.015545779839158058, -0.021269846707582474, 0.0005511883064173162, -0.02389107644557953, 0.01803278923034668, -0.034897077828645706, -0.041750166565179825, 0.0035331316757947206, -0.0008921651169657707, 0.042887087911367416, -0.02602279745042324, -0.0048397984355688095, -0.009750653989613056, 0.02491746097803116, -0.007180744782090187, 0.007030734792351723, -0.0023014701437205076, -0.010058569721877575, 0.012885075062513351, 0.00269031198695302, -0.048698004335165024, -0.005921449977904558, -0.026843905448913574, 0.0050253369845449924, 0.02010134793817997, 0.03325486183166504, 0.032086361199617386, -0.00973486341536045, 0.032133735716342926, -0.01301929447799921, 0.035465534776449203, -0.0493612065911293, 0.009324309416115284, -0.0005363846430554986, -0.024349002167582512, -0.007070211227983236, 0.032070573419332504, 0.014479918405413628, 0.01387198269367218, -0.005258247256278992, -0.027617640793323517, 0.005420100409537554, 0.022817319259047508, -0.006106988526880741, 0.015166806988418102, 0.0047845314256846905, -0.028170309960842133, 0.031044187024235725, 0.015032586641609669, -0.010374380275607109, -0.04607677459716797, -0.00633989879861474, -0.044939856976270676, -0.0003069284721277654, -0.02430162951350212, -0.03843415528535843, 0.0034502313937991858, 0.03338118642568588, 0.014006202109158039, -0.002002436900511384, -0.0043226582929492, -0.015151016414165497, 0.017511701211333275, 0.008384772576391697, -0.027838708832859993, 0.02565961517393589, 0.04692946374416351, -0.022138327360153198, 0.007168901618570089, 0.0019550654105842113, 0.016453735530376434, 0.0479084774851799, 0.012995608150959015, 0.0204803217202425, -0.00669123837724328, 0.028565073385834694, 0.04980333894491196, -0.01939077489078045, 0.01600370556116104, -0.010619132779538631, -0.00934799574315548, -0.031770553439855576, -0.005206928122788668, 0.011503403075039387, 0.0243174210190773, 0.010137521661818027, 0.01694324240088463, 0.004989808425307274, -0.02392265759408474, 0.011195487342774868, 0.01702219434082508, 0.017243262380361557, -0.0016017521265894175, 0.003146263537928462, -0.008463725447654724, -0.02526485174894333, 0.0039022353012114763, 0.031723178923130035, -0.006734662223607302, 0.025849102064967155, -0.022312022745609283, 0.03083891049027443, 0.038686804473400116, 0.013737763278186321, 0.026149122044444084, 0.01735379546880722, 0.004670049995183945, 0.037676211446523666, -0.01771697774529457, 0.026417560875415802, -0.02425425872206688, 0.009142718277871609, -0.02701760083436966, -0.006612285505980253, -0.014756252989172935, 0.006513594649732113, 0.03439177945256233, -0.0009331217734143138, 0.02152249589562416, 0.009837501682341099, 0.002317260717973113, 0.03082311898469925, 0.05829864740371704, 0.004393715877085924, 0.011471821926534176, 0.04266601800918579, 0.000590664625633508, 0.031028397381305695, 0.041402775794267654, 0.0180169977247715, -0.006209626793861389, 0.015151016414165497, 0.0068451957777142525, -0.022659413516521454, -0.020275043323636055, 0.009853292256593704, -0.0031423158943653107, -0.009648015722632408, -0.02155407704412937, 0.009055870585143566, 0.02392265759408474, 0.012253453023731709, -0.011479717679321766, -0.052550893276929855, -0.014353593811392784, -0.013240361586213112, 0.005001651123166084, 0.03420229256153107, -7.926107355160639e-05, -0.0010352667886763811, 0.042823925614356995, -0.018838105723261833, -0.017432747408747673, -0.018285436555743217, 0.007776837330311537, 0.006332003511488438, 0.006521489936858416, -0.035876091569662094, 0.006004350259900093, -0.01763802580535412, 0.014874681830406189, 0.025201689451932907, -0.0007544913678430021, 0.006624128669500351, -0.018174903467297554, 0.00973486341536045, -0.00238634436391294, 0.004180543590337038, 0.013224571011960506, 0.007745256181806326, 0.0671413466334343, -0.004713473841547966, -0.000685407780110836, -0.0001846752129495144, -0.032465334981679916, 0.018585456535220146, -0.007559717632830143, 0.052866704761981964, 0.0023922657128423452, 0.06524647772312164, 0.012877179309725761, -0.01697482168674469, 0.0026054379995912313, 0.02635439857840538, -0.021048780530691147, -0.04926646128296852, 0.02352789416909218, 0.04392926022410393, 0.008329506032168865, -0.01770118623971939, -0.02289627306163311, 0.02427004836499691, -0.00255214492790401, -0.022627834230661392, -0.008258448913693428, 0.0005102315917611122, -0.0077807847410440445, 0.0065491232089698315, -0.025928054004907608, 0.014266746118664742, -0.004042376298457384, -0.02570698782801628, 0.0036140582524240017, 0.009584853425621986, -0.04756108298897743, -0.05902501195669174, -0.03218110650777817, -0.03606557846069336, 0.008053171448409557, 0.02600700780749321, -0.031091559678316116, 0.0019659213721752167, 0.011558669619262218, -0.0060714599676430225, 0.027207087725400925, 0.022454136982560158, -0.016406362876296043, 0.005921449977904558, 0.004812164697796106, -0.0004887663526460528, 0.013192989863455296, -0.013066666200757027, 0.004032507073134184, -0.0027258407790213823, 0.013793029822409153, 0.004101590719074011, 0.032054781913757324, 0.008116333745419979, -0.009845397435128689, -0.02460164949297905, 0.008471621200442314, 0.016753755509853363, 0.022264651954174042, 0.03874996677041054, -0.014337803237140179, 0.003379174042493105, -0.011448136530816555, 0.010050673969089985, 0.0025166161358356476, -0.0037541992496699095, 0.011582355946302414, -0.010532285086810589, 0.022012002766132355, 0.04478194937109947, 0.04058166965842247, 0.014393070712685585, -0.04320289567112923, 0.019817117601633072, 0.0029666463378816843, -0.023006806150078773, 0.007239959202706814, -0.03496024012565613, -0.000928680703509599, -0.004081852734088898, -0.00033086101757362485, -0.012640321627259254, -0.0112902307882905, 0.013635125011205673, -0.009687491692602634, 0.022327812388539314, 0.0005487210000865161, 0.018143322318792343, 0.009379575960338116, -0.008613735437393188, 0.013564067892730236, -0.020638225600123405, -0.021443543955683708, -0.0031719233375042677, 0.008905860595405102, 0.007934742607176304, 0.01831701770424843, -0.03325486183166504, -0.0006627089460380375, -0.024885879829525948, 0.014961529523134232, 0.032117944210767746, 0.025533290579915047, 0.04708736762404442, -0.0017103120917454362, -0.015379979275166988, -0.02461744099855423, -0.003278509248048067, 0.003359435824677348, 0.0013441691407933831, 0.022469928488135338, -0.04402400553226471, 0.02327524498105049, 0.004614782985299826, 0.02629123628139496, -0.003618005895987153, 0.020685598254203796, 0.019959233701229095, 0.007149163633584976, -0.02668599970638752, -0.01143234595656395, -0.017495909705758095, 0.0011596172116696835, 0.016374781727790833, 0.0056174821220338345, 0.02109615132212639, -0.03650771081447601, -0.0003207451954949647, 0.013650915585458279, -0.023780541494488716, -0.01126654539257288, 0.013208780437707901, -0.014179898425936699, -0.020906664431095123, 0.032070573419332504, 0.019296031445264816, -0.00971117801964283, -0.004709526430815458, 0.028280844911932945, -0.00953748170286417, -0.005593796260654926, 0.022422555834054947, 0.01314561814069748, 0.02046453021466732, -0.0042989724315702915, -0.010627028532326221, -0.022296231240034103, -0.008692688308656216, -0.017259052023291588, -0.0063635846599936485, -0.012403463013470173, -0.027617640793323517, 0.012308720499277115, 0.009640119969844818, -0.013287733308970928, -0.019122334197163582, 0.0024435848463326693, 0.006059616804122925, -0.00425554858520627, 0.019169706851243973, 0.005787230096757412, -0.000925226544495672, 0.08526887744665146, -0.007066263351589441, -0.02629123628139496, 0.026528093963861465, -0.0010313191451132298, 0.013192989863455296, -0.01875915192067623, 0.018095949664711952, -0.02188567817211151, 0.035181306302547455, -0.03265482187271118, 0.01872757263481617, -0.010705981403589249, 0.00538062397390604, 0.03300221264362335, 0.0007095870678313076, -0.003996978513896465, 0.014850996434688568, 0.020511901006102562, -0.008266343735158443, 0.015837904065847397, 0.006399113219231367, -0.02914932370185852, 0.005838549230247736, 0.008108438923954964, 0.013421952724456787, -0.0035765557549893856, -0.00834529660642147, 0.017969626933336258, 0.02774396538734436, 0.022975225001573563, -0.058014415204524994, -0.042129140347242355, -0.0061188312247395515, -0.009750653989613056, -0.01869599148631096, -0.016485316678881645, 0.041465938091278076, -0.028201891109347343, -0.013579858466982841, -0.027222879230976105, -0.01245873048901558, -0.005041127558797598, -0.012861388735473156, -0.013627229258418083, 0.026875486597418785, -0.01766960695385933, 0.00485164113342762, 0.006351741962134838, 0.014487814158201218, 0.023464731872081757, 0.002127774292603135, 0.014322012662887573, -0.025533290579915047, 0.005112185142934322, -0.016548478975892067, 0.0012109364615753293, 0.008447934873402119, 0.020922455936670303, 0.01730642467737198, -0.038623642176389694, -0.002234360435977578, -0.04086589813232422, 0.01454308070242405, 0.00850320141762495, -0.03388648480176926, -0.019690794870257378, -0.0008072909549809992, -0.017574863508343697, 0.044213492423295975, -0.048729583621025085, -0.019138125702738762, -0.00579907326027751, 0.006730714347213507, 0.01905917376279831, 0.008100543171167374, 0.01629582978785038, 0.01421147957444191, 0.03334960341453552, 0.022122535854578018, -0.0021751457825303078, 0.004551621153950691, 0.009624329395592213, -0.004827955272048712, 0.01354038156569004, -0.0017576836980879307, 0.022343603894114494, -0.001351077458821237, -0.03638138622045517, 0.011108639650046825, -0.015332607552409172, 0.01539576891809702, 0.0325600765645504, -0.006284631788730621, -0.025122737511992455, -0.010437541641294956, -0.002607411704957485, 0.026180703192949295, 0.032749563455581665, -0.022312022745609283, 0.0019550654105842113, -0.013248257339000702, -0.008471621200442314, -5.6161250540753826e-05, -0.030049383640289307, 0.011566565372049809, -0.05349832400679588, -0.0030100701842457056, 0.0035548435989767313, 0.0172906331717968, 0.011519193649291992, -0.027238668873906136, 0.015443140640854836, 0.022027792409062386, -0.038339413702487946, -0.0005131923244334757, -0.010263846255838871, 0.020954037085175514, -0.02084350399672985, 0.005641167983412743, -0.007587350904941559, 0.010879676789045334, 0.01423516497015953, 0.010548075661063194, 0.016374781727790833, 0.004129224456846714, 0.0117955282330513, -0.025485919788479805, -0.0280755665153265, 0.02223307080566883, 0.018853895366191864, 0.006801771931350231, 0.012916655279695988, -0.004275286570191383, 0.001206001965329051, 0.011937642470002174, 0.017132727429270744, -0.03252849727869034, -0.018111741170287132, -0.0011458005756139755, -0.007172849494963884, 0.015735264867544174, 0.002867955481633544, 0.02114352397620678, 0.011637622490525246, -0.02327524498105049, -0.012995608150959015, -0.008124229498207569, 0.010058569721877575, 0.04197123646736145, 0.013200885616242886, -0.011029686778783798, 0.0019313795492053032, 0.047276854515075684, 0.0038173613138496876, -0.017416957765817642, -0.01354827731847763, -0.03162843734025955, -0.01598001830279827, 0.010627028532326221, 0.010721771977841854, 0.006158307660371065, -0.015506302937865257, 0.013256152160465717, 0.027175506576895714, -0.030396776273846626, -0.03334960341453552, 0.0061227791011333466, 0.013864087872207165, 0.025785939767956734, 0.003588398452848196, -0.012940341606736183, -0.015419455245137215, -0.013587753288447857, -0.018427550792694092, 0.00798211432993412, -0.02076455019414425, 0.020717179402709007, -0.030586261302232742, -0.015277340076863766, -0.00867689773440361, -0.028691397979855537, 0.018553875386714935, 0.0016836655559018254, -0.01334299985319376, 0.0018524269107729197, -0.001742880092933774, 0.012087652459740639, -0.01232451107352972, -0.00683730049058795, -0.0023725274950265884, -0.009884873405098915, -0.02288048155605793, -0.0013994359178468585, 0.03142315894365311, 0.050087571144104004, 0.010350693948566914, -0.004709526430815458, 0.04323447868227959, 0.004004873801022768, -0.028533492237329483, -0.012916655279695988, 0.007926847785711288, 0.006695185787975788, -0.01703798398375511, 0.007772889919579029, 0.0022580460645258427, -0.029196694493293762, 0.0074886600486934185, 0.008574259467422962, 0.040676411241292953, 0.00659254752099514, 0.006876776926219463, 0.040771156549453735, 0.02427004836499691, 0.014669405296444893, -0.014495708979666233, 0.02044874057173729, -0.039065778255462646, -0.0012908760691061616, -0.002344893990084529, 0.0005388519493862987, 0.025817520916461945, -0.013137723319232464, 0.006884672213345766, 0.02460164949297905, 0.03442336246371269, 0.023717379197478294, 0.012956132180988789, 0.021711982786655426, 0.0020389524288475513, -0.016406362876296043, -0.01631161943078041, -0.01215081475675106, 0.003844994818791747, 0.004496354144066572, 0.020732969045639038, -0.012727169319987297, 0.003963423892855644, 0.011534984223544598, -0.05071919038891792, 0.003858811454847455, -0.02499641291797161, -0.004330553580075502, -0.029275648295879364, 0.045887287706136703, 0.0028837460558861494, 0.04231862723827362, -0.022706786170601845, 0.0029212485533207655, -0.008495306596159935, -0.009095346555113792, -0.004259495995938778, -0.04433981701731682, 0.019848698750138283, -0.042160723358392715, -0.02253309078514576, -0.002500825561583042, 0.0008758811163716018, 0.005609586834907532, -0.039034195244312286, -0.026875486597418785, 0.016130028292536736, -0.014748357236385345, -0.008558468893170357, 0.0022027792874723673, -0.0243174210190773, -0.012071861885488033, -0.024759555235505104, 0.001409305026754737, -0.025517500936985016, 0.029717782512307167, -0.03011254593729973, -0.01598001830279827, 0.017053775489330292, 0.011527088470757008, 0.035939253866672516, 0.003333776257932186, 0.015814218670129776, -0.03442336246371269, 0.040107954293489456, -0.009119032882153988, -0.029323019087314606, -0.010840200819075108, 0.009948035702109337, 0.019832909107208252, 0.009458528831601143, 0.0008477542432956398, 0.002431741915643215, 0.024017401039600372, -0.0353076308965683, 0.007480764761567116, 0.016564268618822098, -0.021601447835564613, -0.000711067405063659, 0.025485919788479805, 0.023859495297074318, -0.002721893135458231, -0.03145474195480347, 0.012711378745734692, 0.0077294656075537205, 0.0021435648668557405, 0.0274281557649374, 0.004567411728203297, 0.003671298734843731, 0.0064149037934839725, 0.020654017105698586, 0.02458585985004902, 7.748772077320609e-07, 0.024064771831035614, 0.005045074969530106, 0.012182395905256271, -0.02319629304111004, 0.031691599637269974, 0.023322617635130882, 0.03502340242266655, -0.01631161943078041, 0.032465334981679916, -0.01972237601876259, 0.009655910544097424, -0.03707617148756981, 0.02216990850865841, 0.013240361586213112, 0.014440442435443401, 0.05731963366270065, 0.01798541657626629, -0.02014872059226036, 0.009458528831601143, -0.012395568192005157, -0.023780541494488716, 0.02809135802090168, 0.010705981403589249, 0.019911861047148705, 0.02493325062096119, 0.023685799911618233, -0.019627632573246956, -0.009119032882153988, 0.05349832400679588, 0.023812122642993927, -0.02984410710632801, -0.019296031445264816, 0.01662743091583252, 0.004756898153573275, 0.004859536420553923, -0.013532486744225025, -0.0018257803749293089, 0.002204753225669265, 0.0038390732370316982, -0.0007870593690313399, -0.001736958627589047, 0.01978553831577301, 0.028896674513816833, 0.0273492019623518, -0.00900849886238575, 0.023701589554548264, 0.016911661252379417, 0.004472668282687664, -0.02430162951350212, -0.03143895044922829, 0.0017823564121499658, -0.010303322225809097, -0.024538487195968628, 0.025549082085490227, 0.04055008664727211, -0.025880683213472366, 0.013824610970914364, 0.01905917376279831, -0.023733170703053474, 0.027270250022411346, -0.010958629660308361, -0.011558669619262218, 0.025138527154922485, 0.026512304320931435, 0.004512144718319178, -0.0019540784414857626, -0.00013101207150612026, -0.010050673969089985, -0.007654460612684488, 0.003215347183868289, -0.0340128056704998, 0.027301831170916557, -0.02395423874258995, -0.004800321999937296, -0.010532285086810589, 0.020590854808688164, 0.0021001407876610756, -0.024696392938494682, 0.028565073385834694, -0.03200741112232208]",Token-level Direct Preference Optimization.pdf
". For the summarization task, a single fine-tuning and
evaluation run takes approximately 15hours on 2a100_80gb GPUs. Notably, the reported runtimes are
the same for DPO and ODPO, and there is no extra computation cost for ODPO compared to DPO.
D Comparison to SLiC-HF
We compare DPO and ODPO to SLiC-HF (Zhao et al., 2023) on the sentiment control task. Following
Zhao et al. (2023), we set the margin hyperparameter to 1 for SLiC and βto0.5for DPO and ODPO. We
observe that none of the SLiC runs end up on the Pareto frontier of KL divergence and reward. We report
the mean values and 0.9confidence intervals for DKL(πθ||πSFT)and reward in Tab. 1 for 3dataset sizes.
E GPT-4 Evaluation Prompt for the Summarization Task
Following Rafailov et al. (2023) we use the prompt below to evaluate the win rates of generated summaries
against human-written summaries.
Which of the following summaries does a better job of summarizing the most important
points in the given forum post, without including unimportant or irrelevant details?
A good summary is both concise and precise.
Post:
<post>
Summary A:
<summary_a>
Summary B:
<summary_b>
FIRST provide a one-sentence comparison of the two summaries, explaining which you
prefer and why. SECOND, on a new line, state only ""A"" or ""B"" to indicate your choice.
Your response should use the format:
Comparison: <one-sentence comparison and explanation>
Preferred: <""A"" or ""B"">
F Qualitative Results
Post We have been dating for two and a half months, but we were friends in
high school. We are both divorced, but her kids’ dad takes them maybe
one day a week. By their bedtime she’s too tired to stay up for time for
herself. I have more free time because I only have my kids for half the
time.
What can I say to her to help her get over the mentality she has to take
care of all her problems alone? I’m willing to invest whatever it takes
because we get along so well. Ask me any info that I may have left out.
DPO Summary dating with benefits is giving my girlfriend anxiety and a mentality of
taking care of her problems alone even though she said she wanted
a relationship, not a one-man show. Do I need a break-up? Ask me
anything.
ODPO Summary Girl is tired when hanging out with me. What can I say to her to help her
get over the mentality she has to take care of all her problems alone? We
get along so well. Any info that I may have mentioned/left out.
Judgment Summary A [DPO] brings up unnecessary details and confusion while
Summary B [ODPO] is concise, straightforward and better delivers the
post’s message.
Table 2: An example of two summaries sampled with temperature 1, and its corresponding judgment from GPT-4.
Summaries are shown to the model in random order and are tagged with A or B. For clarity, we add the method in
brackets.
Post I don’t really have a question or anything. I just need to vent and maybe
reach out to those who have been in similar situations.
My sister told me yesterday that she’s pregnant. At first I was thrilled.
But then reality hit me. *I can’t have children.*
I’m so happy for my sister and my brother-in-law, I really am. But they
weren’t planning on having children for at least a few more years. My
sister’s never really wanted to be a mom. Me, on the other hand, have
always lived for it. As a kid when people asked what I want to be when I
grow up, I always said, ""a mom.""
But, 3 years ago I found out I can never have children. I was devastated
but have tried to tough it out, tried to believe it isn’t true for years. I’m in
a serious relationship and we’re planning on getting married in a little
over a year and starting to **try** having kids immediately, but we will
probably end up adopting. While adopting is wonderful and that thought
excites me, I still so badly want to be pregnant one day.
My sister being pregnant is like a kick in the side. A reminder that I’ll
never be pregnant. I don’t want to be around her, I don’t want to be happy
for her. I’m jealous. I don’t know how to deal with this. I","[-0.00060631288215518, 0.015602212399244308, -0.04815959557890892, 0.048735324293375015, -0.039379753172397614, -0.022798804566264153, 0.04467644542455673, 0.014882552437484264, 0.0035227318294346333, -0.008175328373908997, 0.041970524936914444, -0.02071179263293743, -0.048245955258607864, 0.005768068600445986, 0.013076208531856537, -0.024785064160823822, 0.04982920363545418, -0.009154065512120724, -0.02446841448545456, 0.05414716154336929, 0.03647232800722122, 0.004084066022187471, 0.03773893043398857, -0.015774929895997047, 0.012939472682774067, 0.0008919276297092438, 0.02501535415649414, -0.004213604610413313, 0.019430799409747124, -0.010830871760845184, 0.0102767338976264, -0.025864552706480026, -0.02265487238764763, -0.034025486558675766, 0.026857681572437286, 0.015055270865559578, -0.011593709699809551, 0.03796922042965889, 0.013212943449616432, -0.038055580109357834, 0.009744185954332352, 0.0007853280985727906, 0.015515852719545364, -0.010161587968468666, -0.014249253086745739, 0.07795348763465881, 0.012119061313569546, 0.022626085206866264, 0.03883281350135803, -0.007178600877523422, -0.0658632144331932, 0.051441241055727005, 0.022467760369181633, 0.027807632461190224, 0.0052787004970014095, -0.03091656044125557, -0.006653249729424715, -0.032154373824596405, -0.0025044141802936792, -0.032211948186159134, 0.05570162460207939, -0.010586187243461609, 0.003328423947095871, 0.023101061582565308, -0.035522378981113434, -0.017977086827158928, -0.04148115590214729, 0.002243537688627839, -0.04038727656006813, -0.04369770735502243, 0.046259693801403046, 0.047583866864442825, 0.023158634081482887, 0.0017145881429314613, -0.03586781397461891, 0.014911338686943054, 0.026742536574602127, -0.007988217286765575, -0.031002920120954514, -0.08837415277957916, 0.045712754130363464, 0.03483150526881218, -0.003745826194062829, 0.02534639835357666, 0.02688646875321865, -0.0004054830060340464, -0.05311084911227226, -0.014652261510491371, 0.0046597933396697044, -0.026440279558300972, -0.03500422462821007, 0.02347528375685215, -0.051815465092659, 0.0043863230384886265, 0.08468949794769287, -0.02585016004741192, -0.03477393463253975, 0.04513702541589737, -0.017156675457954407, 0.05069279670715332, -0.010233554057776928, -0.041366010904312134, -0.03785407543182373, 0.0031035305000841618, 0.0055989488027989864, 0.028124282136559486, -0.01021916139870882, 0.05581676959991455, -0.0214314516633749, 0.005987564567476511, -0.07490213215351105, 0.015630997717380524, -0.05731366202235222, 0.044446155428886414, -0.0716780573129654, -0.026382707059383392, -0.02744780294597149, -0.0013223738642409444, -0.006347394548356533, -0.020035313442349434, -0.023734360933303833, 0.0025062132626771927, -0.0052103325724601746, 0.0061746761202812195, 0.010614973492920399, -0.04600061848759651, 0.07737775892019272, -0.04660513252019882, -0.0289303008466959, -0.03874645382165909, 0.04412950202822685, 0.018984610214829445, -0.025173678994178772, -0.06626622378826141, -0.05305327847599983, -0.036558687686920166, -0.013817457482218742, 0.0038249888457357883, -0.03399670124053955, 0.011672873049974442, 0.0031772954389452934, -0.031924083828926086, 0.005764470435678959, 0.0046813832595944405, 0.003994108643382788, 0.0226980522274971, 0.019330047070980072, 0.017430147156119347, -0.04277654364705086, 0.021820068359375, 0.03785407543182373, 0.01506966445595026, -0.012327762320637703, -0.004627408925443888, 0.05964535474777222, -0.04648998752236366, -0.003785407403483987, -0.0034381719306111336, -0.012198223732411861, -0.04720964655280113, -0.026368314400315285, -0.028412146493792534, 0.015357527881860733, 0.0021733709145337343, 0.001554463873617351, 0.032643742859363556, -0.02039514295756817, 0.024094190448522568, -0.05172910541296005, -0.057946961373090744, 0.049397408962249756, -0.029880251735448837, -0.06045137345790863, 0.0192868672311306, 0.0008420012891292572, -0.022942736744880676, 0.01077329833060503, -0.03632839769124985, 0.007570814806967974, 0.03172257915139198, -0.005030417814850807, 0.06931757926940918, -0.03465878963470459, 0.0009355570073239505, 0.004767742473632097, -0.02760612778365612, -0.012737968005239964, -0.010564597323536873, 0.001298984861932695, -0.008722269907593727, 0.045108240097761154, -0.01052861474454403, 0.030599910765886307, -0.035176943987607956, 0.03730713576078415, -0.04395678639411926, 0.08313503116369247, 0.058493901044130325, -0.015487066470086575, 0.019085362553596497, 0.021258734166622162, 0.02727508544921875, 0.027131153270602226, -0.04579911381006241, 0.01184559054672718, -0.02750537544488907, 0.028843941166996956, -0.030283259227871895, -0.04381285235285759, -0.01938761956989765, 0.0578606016933918, -0.02556229569017887, 0.037335921078920364, 0.021244339644908905, 0.03883281350135803, -0.014853766188025475, -0.03989790752530098, 0.036731407046318054, 0.014004568569362164, 0.021114801988005638, -0.0049404604360461235, 0.00721818208694458, 0.018380096182227135, 0.03503300994634628, -0.005933590233325958, -0.0009895313996821642, 0.04156751558184624, -0.005814846605062485, -0.03834344446659088, 0.014321218244731426, 0.020539075136184692, 0.006588479969650507, -0.029966609552502632, -0.021028442308306694, 0.04127965122461319, -0.006588479969650507, 0.006009154487401247, -0.029462847858667374, -0.02589333802461624, -0.02088451012969017, 0.03074384294450283, 0.02197839319705963, 0.02330256626009941, -0.01256524957716465, -0.013644739054143429, -0.0003213728195987642, -0.0235760360956192, -0.07334766536951065, -0.00826168805360794, -0.013457627035677433, 0.03247102349996567, -0.01663852110505104, 0.01074451208114624, 0.0021086016204208136, -0.0426613986492157, -0.03422699123620987, 0.017286214977502823, 0.004872092977166176, 0.030657483264803886, -0.0011181705631315708, -0.014565902762115002, 0.02898787334561348, -0.00923322793096304, -0.00647333450615406, -0.01609157957136631, 0.04122208058834076, 0.017444539815187454, -0.00704186549410224, 0.013248926028609276, -0.02616680972278118, 0.016768060624599457, -0.030225686728954315, 0.03891916945576668, 0.06816612184047699, -0.03391034156084061, -0.03042719140648842, -0.03488907963037491, 0.017286214977502823, 0.016005221754312515, -0.040041837841272354, -0.010298323817551136, 0.0010794887784868479, 0.0196754839271307, -0.018308131024241447, 0.055672839283943176, 0.03465878963470459, 0.028570471331477165, 0.03284524753689766, -0.012176633812487125, 0.02750537544488907, -0.02721751108765602, -0.04205688461661339, 0.05388808250427246, -0.019531551748514175, -0.0006656847544945776, -0.03244223818182945, 0.01852402836084366, -0.025332003831863403, 0.0246411319822073, 0.0553274005651474, 0.03713441640138626, -0.03091656044125557, 0.025878945365548134, 0.04289168864488602, 0.052650269120931625, -0.03670262172818184, 0.01446515042334795, -0.011017982847988605, -0.02049589529633522, 0.019243687391281128, -0.007470062933862209, -0.03486029431223869, -0.011176307685673237, 0.030628696084022522, -0.015271169133484364, 0.0017955497605726123, 0.022136718034744263, -0.035234514623880386, 0.0016651115147396922, 0.003756621154025197, 0.011039572767913342, -0.02248215489089489, -0.03080141544342041, 0.02271244488656521, 0.025389578193426132, 0.004465485457330942, 0.005588153842836618, -0.01630747877061367, 0.06494204699993134, 0.004523058421909809, -0.03235587850213051, -0.031118065118789673, 0.02727508544921875, 0.025965305045247078, -0.017487719655036926, -0.05558647960424423, 0.01471703127026558, 0.06263913959264755, 0.009413142688572407, 0.02271244488656521, -0.02838335931301117, 0.018336916342377663, -0.01049982849508524, -0.016897598281502724, -0.039753977209329605, -0.01506966445595026, -0.010471041314303875, 0.04202809929847717, -0.011449778452515602, 0.009564271196722984, -0.007178600877523422, 0.010125605389475822, 0.049138329923152924, 0.019430799409747124, -0.002427050843834877, -0.018653567880392075, 0.01983380876481533, 0.01868235319852829, -0.011852787807583809, 0.0015886477194726467, -0.013623149134218693, 0.018092233687639236, -0.02160416916012764, 0.04096300154924393, -0.02700161375105381, -0.010888444259762764, -0.025000961497426033, 0.031146850436925888, -0.04067514091730118, 0.00920444168150425, -0.0030153722036629915, -0.025490330532193184, -0.030542338266968727, -0.01198232639580965, -0.08952561020851135, 0.011197897605597973, 0.03707684203982353, 0.013954192399978638, -0.028340179473161697, 0.023432103917002678, -0.02137387916445732, 0.021748101338744164, -0.02760612778365612, 0.007815498858690262, 0.013601559214293957, 0.03958125784993172, -0.042834118008613586, -0.04387042671442032, -0.04220081865787506, 0.00942033901810646, 0.029736319556832314, -0.011521744541823864, -0.008592731319367886, 0.01696956530213356, -0.023763148114085197, -1.343738676951034e-05, -0.030283259227871895, 0.0857258066534996, 0.016077186912298203, -0.018034659326076508, 0.023331351578235626, -0.009772972203791142, -0.04634605348110199, -0.019200507551431656, 0.0019340841099619865, 0.0002849400625564158, 0.034140635281801224, 0.017228642478585243, 0.011852787807583809, -0.024756276980042458, -0.008391226641833782, -0.0362420380115509, 0.04401435703039169, -0.024669917300343513, -0.015199203044176102, -0.03244223818182945, 0.018336916342377663, 0.06551777571439743, 0.037335921078920364, 0.03218315914273262, -0.04099179059267044, -0.016235511749982834, 0.008110559545457363, -0.013723901472985744, -0.022453367710113525, 0.023173026740550995, 0.0771474689245224, -0.018984610214829445, 0.044877950102090836, -0.04959891363978386, -0.018437668681144714, 0.040416061878204346, 0.006599274929612875, -0.03186650946736336, -0.000321822619298473, 0.00534346979111433, -0.009607451036572456, 0.024007830768823624, -0.03699048236012459, -0.03972518816590309, 0.034313350915908813, -0.016077186912298203, 0.005706897471100092, -0.017559684813022614, -0.06033622846007347, 0.04364013671875, 0.033248256891965866, -0.0344860702753067, -0.04723843187093735, -0.014767407439649105, -0.01593325473368168, -0.027203118428587914, 0.07317495346069336, 0.002038434846326709, -0.03103170543909073, -0.019819414243102074, -0.0030765431001782417, -0.010917230509221554, 0.042344748973846436, -0.026915254071354866, 0.045597609132528305, 0.0016938978806138039, -0.02844093181192875, -0.009031723253428936, -0.007477259263396263, -0.013824653811752796, 0.03549359366297722, 0.02982267737388611, -0.06465418636798859, -0.016624128445982933, -0.015357527881860733, -0.04821716621518135, -0.007300942670553923, 0.010399076156318188, -0.05388808250427246, -0.005365059711039066, 0.02573501318693161, 0.048188380897045135, -0.04568396881222725, 0.006908728741109371, 0.012363745830953121, 0.0162642989307642, 0.006991489324718714, 0.006001957692205906, 0.04171144962310791, 0.009859330952167511, 0.01273077167570591, 0.007829892449080944, -0.02133069932460785, 0.04749750718474388, -0.0021319903898984194, -0.014573099091649055, 0.018437668681144714, -0.01719985529780388, -0.012853113934397697, 0.006732412148267031, -0.0031629023142158985, -0.006228650454431772, -0.006563291884958744, -0.02017924375832081, 0.039869122207164764, 0.019056575372815132, 0.009981673210859299, 0.01912854239344597, 0.003767416113987565, -0.05411837249994278, 0.08584095537662506, 0.0038285870105028152, -0.029218165203928947, 0.009463518857955933, -0.02661299891769886, -0.034687574952840805, -0.002808470046147704, -0.009082099422812462, -0.021748101338744164, 0.020510287955403328, -0.014558706432580948, -0.041625089943408966, -0.02557668834924698, -0.012306172400712967, -0.010946016758680344, -0.014925732277333736, 0.011910360306501389, 0.01443636417388916, -0.02844093181192875, -0.024382054805755615, -0.012255796231329441, -0.0034795524552464485, -0.011615299619734287, -0.010636563412845135, 0.01784754917025566, -0.012752361595630646, 0.027044793590903282, 0.03284524753689766, -0.056392498314380646, 0.01691199094057083, 0.007200190331786871, -0.027692487463355064, 0.0164658036082983, -0.02265487238764763, -0.009513895027339458, 0.002349687274545431, 0.03555116429924965, 0.007693157065659761, 0.03362247720360756, -0.012881900183856487, 0.03572388365864754, 0.037796501070261, -0.01852402836084366, -0.0021229947451502085, 0.03471636027097702, -0.010751708410680294, 0.016796845942735672, -0.02049589529633522, -0.029333310201764107, 0.006257437169551849, -0.015458280220627785, -0.008844612166285515, 0.033536121249198914, -0.011543333530426025, 0.010478238575160503, -0.03768135607242584, -0.016278691589832306, -0.001134362886659801, -0.008024200797080994, 0.022985914722085, 0.022841984406113625, -0.0017118894029408693, -0.016897598281502724, 0.015285561792552471, -0.02651224657893181, 0.0064697363413870335, 0.010614973492920399, -0.040041837841272354, 0.004756947513669729, 0.011665675789117813, 0.0205534677952528, -0.031492289155721664, -0.003907749429345131, -0.02205035835504532, -0.015112843364477158, -0.04657634347677231, -0.022899556905031204, -0.03961004316806793, -0.019646696746349335, 0.04600061848759651, 0.027102366089820862, 0.0001449438714189455, 0.008859004825353622, 0.004954853560775518, -0.0015175814041867852, -0.017070317640900612, -0.008700679987668991, 0.014753013849258423, 0.01440757792443037, 0.012334958650171757, -0.004699374549090862, -0.024454019963741302, -0.03802679479122162, -0.02941966988146305, -0.004249587655067444, -0.01033430639654398, -0.054089587181806564, -0.020927689969539642, -0.04470523074269295, 0.02446841448545456, -0.0023982643615454435, -0.03724956139922142, 0.0024954183027148247, -0.022726837545633316, -0.006426556967198849, 0.021359486505389214, 0.013378464616835117, -0.06580563634634018, -0.045655179768800735, 0.010010459460318089, -0.0011073756031692028, -0.005739282350987196, 0.04079028591513634, 0.015717357397079468, 0.04139479994773865, -0.007365711964666843, -0.008614321239292622, -0.001264801132492721, 0.013795867562294006, 0.0067396084778010845, -0.013824653811752796, 0.01096760667860508, 0.017502112314105034, 0.024497199803590775, -0.003745826194062829, -0.019603516906499863, 0.0037026468198746443, -0.005919197108596563, 0.026382707059383392, -0.00788026861846447, -0.007243370171636343, -0.003756621154025197, 0.00690153194591403, -0.026296347379684448, -0.010989196598529816, 0.038602519780397415, 0.01036309264600277, -0.010895640589296818, -0.026425886899232864, -0.01686881296336651, -0.018221771344542503, 0.027562947943806648, -0.003940134309232235, -0.056018274277448654, -0.019905773922801018, 0.002002451801672578, 0.04263261333107948, 0.008815825916826725, 0.021258734166622162, -0.009002937003970146, -0.014227663166821003, -0.04171144962310791, -0.03635718300938606, 0.0012198223266750574, -0.029318917542696, -0.008693483658134937, -0.03097413294017315, 0.004569835960865021, 0.011989522725343704, 0.03690412640571594, 0.017890729010105133, 0.021345091983675957, 0.01907096989452839, -7.601400284329429e-05, -0.012342155911028385, -0.004965648520737886, 0.025778193026781082, -0.04651877284049988, 0.01002485305070877, 0.0005622337921522558, 0.027030400931835175, -0.04651877284049988, 0.020078491419553757, 0.021143587306141853, -0.004836109932512045, -0.016336264088749886, 0.006926720030605793, 0.030571123585104942, 0.025591082870960236, 0.005570162553340197, 0.032039228826761246, -0.019473979249596596, 0.003139513311907649, 0.009312390349805355, -0.010780495591461658, 0.013767081312835217, -0.024122977629303932, -0.00701307924464345, 0.029362095519900322, -0.005253512412309647, -0.016897598281502724, 0.032154373824596405, -0.011917556636035442, -0.07202349603176117, -0.015659784898161888, -0.0016246306477114558, -0.030657483264803886, 0.03042719140648842, -0.022064751014113426, -0.04009941220283508, -0.0012692989548668265, 0.04640362784266472, 0.007981020957231522, -0.04464765638113022, -0.010435058735311031, -0.013522396795451641, 0.0009544480708427727, 0.023288171738386154, -0.021834461018443108, -0.021014049649238586, -0.01878310553729534, 0.029218165203928947, -0.0041272458620369434, -0.011888770386576653, -0.011313042603433132, 0.010694135911762714, 0.0009652429143898189, 0.0008523464202880859, 0.013529593124985695, -0.00793784111738205, -0.02501535415649414, 0.0005482903798110783, -0.013839046470820904, 0.03212558850646019, 0.0205534677952528, 0.03863130882382393, 0.0016929983394220471, -0.020409535616636276, -0.031233210116624832, 0.013623149134218693, 0.00018879810522776097, 0.04392799735069275, -0.020582253113389015, 0.011859984137117863, 0.018394488841295242, -0.03543601930141449, -0.01215504389256239, 0.018049053847789764, 0.005778863560408354, 0.0016381243476644158, 0.0037386296316981316, 0.06309971958398819, 0.019920166581869125, -0.01096760667860508, -0.027620520442724228, 0.014839373528957367, -0.021359486505389214, -0.00970100611448288, -0.0064445482566952705, -3.7599384086206555e-06, 0.01096760667860508, -0.00626823166385293, 0.02171931602060795, -0.010435058735311031, -0.011341829784214497, 0.0013358674477785826, 0.008470389060676098, 6.947101155674318e-06, -0.027347050607204437, -0.0031161245424300432, -0.0028480514883995056, 0.009880920872092247, 0.01599082723259926, -0.011277060024440289, 0.016998350620269775, -0.01642262376844883, -0.00989531446248293, 0.02976510487496853, 0.0471520721912384, -0.03946611285209656, -0.009218834340572357, -0.04654755815863609, 0.010147195309400558, 0.006656847894191742, 0.0016525174723938107, 0.019963346421718597, -0.009398749098181725, 0.004148835316300392, 0.012493284419178963, -0.0003708493895828724, 0.014314021915197372, 0.0017055923817679286, -0.04326591268181801, -0.04280532896518707, -0.015299955382943153, 0.013551183044910431, -0.010291126556694508, 0.005098785739392042, 0.015386314131319523, 0.02105722948908806, -0.023734360933303833, -0.12712059915065765, -0.018912645056843758, 0.005969573277980089, 0.013356875628232956, -0.0350617989897728, -0.007322532590478659, 0.0038465785328298807, 0.023561643436551094, 0.04395678639411926, -0.013040225021541119, 0.02618120238184929, -0.03368005156517029, -0.00040076024015434086, -0.014896946027874947, -0.004584229085594416, -0.009463518857955933, -0.03103170543909073, -0.03085898794233799, -0.02265487238764763, -0.03416942059993744, -0.024007830768823624, -0.03629961237311363, -0.018264951184391975, 0.0127595579251647, -0.013925406150519848, -0.0009292599861510098, 0.0013106793630868196, 0.028297001495957375, -0.004138040356338024, -0.009125279262661934, 0.01653776876628399, -0.01696956530213356, -0.007200190331786871, -0.008801432326436043, -0.010917230509221554, -0.031434714794158936, 0.0012558053713291883, -0.0029847866389900446, 0.002450439613312483, 0.026425886899232864, 0.056737933307886124, 0.023014701902866364, 0.03339218720793724, -0.00482171680778265, 0.001585049438290298, -0.051988180726766586, 0.01658094860613346, 0.01835131086409092, -0.01504087820649147, 0.0031880903989076614, 0.026469066739082336, 0.0035173343494534492, -0.0306862685829401, -0.03373762592673302, 0.012694789096713066, -0.0027041195426136255, -0.030772628262639046, -0.003756621154025197, 0.04801566153764725, 0.032643742859363556, -0.011327436193823814, -0.0004565338313113898, -0.0008087170426733792, -0.013932602480053902, -0.025965305045247078, -0.003411184763535857, 0.0023047085851430893, -0.030571123585104942, -0.027534162625670433, 0.0037386296316981316, -0.042344748973846436, 0.01603400707244873, 0.03730713576078415, -0.03399670124053955, -0.02877197600901127, 0.008088969625532627, 0.022237470373511314, 0.012853113934397697, -0.04237353429198265, 0.002849850570783019, 0.03362247720360756, -0.00378180923871696, -0.002828260650858283, 0.03802679479122162, 0.01945958472788334, 0.009679416194558144, 0.007707550190389156, -0.01862478069961071, 0.0004749750951305032, 0.027016006410121918, 0.02910301834344864, -0.027951564639806747, -0.022467760369181633, -0.05731366202235222, -0.04412950202822685, -0.0065021212212741375, -0.008751056157052517, -0.0020366355311125517, 0.031233210116624832, 0.011593709699809551, 0.014414774253964424, 0.0285416841506958, -0.01945958472788334, -0.017487719655036926, -0.00701307924464345, 0.01534313429147005, 0.06338758766651154, -0.012594036757946014, 0.006861950736492872, 0.004224399570375681, -0.007232575211673975, -0.022079145535826683, -0.031175637617707253, 0.027850812301039696, -0.022237470373511314, 0.03229830414056778, 0.012054291553795338, 0.002416255883872509, 0.026742536574602127, -0.03391034156084061, 0.014335611835122108, 0.05642128363251686, -0.009578663855791092, 0.019848201423883438, -0.010370288975536823, 0.05106701701879501, -0.0015373720088973641, -0.008024200797080994, -0.0046454002149403095, -0.00655609555542469, -0.015573425218462944, 0.026440279558300972, 0.01768922433257103, 0.02809549681842327, 0.03851616010069847, 0.021129194647073746, 0.021560991182923317, -0.004789331927895546, 0.01658094860613346, 0.013328088447451591, 0.014673851430416107, 0.005271503701806068, -0.0058904108591377735, -0.0015103848418220878, -0.03802679479122162, -0.005789658520370722, 0.01396858599036932, 0.001557162613607943, -0.006199864204972982, -0.01581810973584652, 0.006718019023537636, -0.011399402283132076, 0.00875825248658657, -0.013637542724609375, 0.037710145115852356, 0.03581024333834648, -0.02501535415649414, -0.01878310553729534, -0.000738100497983396, -0.021834461018443108, -0.007707550190389156, 0.043668922036886215, 0.00854235514998436, -0.01977623626589775, 0.031607434153556824, -0.021287519484758377, -0.009290800429880619, -0.011485761031508446, -0.013356875628232956, -0.001807244261726737, -0.006581283640116453, 0.03963882848620415, 0.0319528691470623, -0.005465811584144831, 0.03437092527747154, 0.0263970997184515, 0.027807632461190224, -0.0011217688443139195, -0.039869122207164764, -0.00895256083458662, 0.025029748678207397, 0.013932602480053902, -0.016494588926434517, -0.0001424700312782079, 0.051210951060056686, -0.0387752391397953, 0.003184492001309991, 0.019416406750679016, -0.0010587986325845122, 0.017890729010105133, 0.02088451012969017, 0.027980349957942963, -0.007779516279697418, 0.03080141544342041, 0.002682529855519533, 0.012169437482953072, 0.002666337415575981, 0.007020275574177504, -0.002788679441437125, -0.019272474572062492, -0.007649977691471577, 0.05665157362818718, 0.027980349957942963, -0.020251210778951645, 0.009240424260497093, 0.03972518816590309, 0.013875029981136322, 0.00031417622813023627, 0.010485434904694557, 0.0184088833630085, -0.004782135598361492, 0.012306172400712967, -0.03814193978905678, 0.03232709318399429, 0.008434406481683254, -0.005634931847453117, -0.005649324972182512, 0.005242717452347279, 0.01008242554962635, -0.01515602320432663, -0.020913297310471535, -0.009600253775715828, -0.039984267204999924, 0.010643759742379189, -0.022856377065181732, -0.010384682565927505, 0.03129078447818756, 0.016221119090914726, 0.011996719054877758, 0.008204115554690361, -0.015530246309936047, 0.018667960539460182, -0.009247620590031147, 0.009708203375339508, 0.029563600197434425, 0.0004785733763128519, -0.012349352240562439, -0.020956477150321007, 0.018437668681144714, -0.031002920120954514, 0.01659534126520157, -0.024396447464823723, 0.035349659621715546, -0.02982267737388611, -0.008312064222991467, -0.005933590233325958, 0.05449259653687477, 0.019574731588363647, -0.019430799409747124, -0.0175308994948864, -0.0306862685829401, 0.03232709318399429, 0.0011631492525339127, -0.018279343843460083, 0.0015400707488879561, 0.014968912117183208, -0.02072618529200554, 0.03042719140648842, 0.019646696746349335, -0.012370942160487175, -0.020798152312636375, 0.03042719140648842, 0.010240750387310982, -0.007376506924629211, 0.007642780896276236, -0.03261495754122734, 0.0013286708854138851, -0.005490999668836594, 0.024266909807920456, -0.003639676608145237, -0.007210985291749239, 0.008650303818285465, -0.0029739916790276766, 0.04346741735935211, -0.0032708512153476477, -0.02953481487929821, -0.0038969547022134066, 0.001315177185460925, 0.04145237058401108, -0.03912067413330078, 0.014853766188025475, 0.0188982505351305, 0.007786712609231472, 0.015674177557229996, 0.015443886630237103, -0.022223077714443207, 0.016840025782585144, 0.00482171680778265, 0.015904469415545464, 0.004030091688036919, 0.010096819140017033, 0.046432413160800934, 0.000885630608536303, 0.01642262376844883, 0.020639825612306595, -0.02859925664961338, 0.008966953493654728, 0.013270515948534012, -0.012212617322802544, -0.022165503352880478, -0.02320181392133236, 0.012853113934397697, 0.034083060920238495, 0.012378138490021229, 0.021776888519525528, 0.023705575615167618, -0.01132023986428976, -0.008225704543292522, -0.008067379705607891, -0.020380748435854912, -0.014925732277333736, 0.0010354097466915846, 0.011557727120816708, 0.027016006410121918, -0.009413142688572407, -0.010262340307235718, 0.013723901472985744, 0.00568890618160367, -0.028023529797792435, 0.01817859150469303, -0.00574647868052125, 0.02523125149309635, 0.0022759223356842995, 0.026713751256465912, 0.005052007734775543, -0.023187419399619102, 0.039984267204999924, 0.00782269611954689, -0.03460121527314186, -0.0013340682489797473, 0.008686286397278309, -0.019488371908664703, 0.032384663820266724, -0.009398749098181725, -0.02733265794813633, -0.046202123165130615, -0.0038609716575592756, 0.03572388365864754, 0.008686286397278309, 0.0030765431001782417, -0.023604823276400566, -0.004674186464399099, -0.014306825585663319, 0.041912954300642014, 0.005883214063942432, -0.021345091983675957, -0.023993438109755516, 0.028887121006846428, -0.02065422013401985, 0.039322178810834885, 0.0777231976389885, -0.041797809302806854, -0.01878310553729534, 0.01383185014128685, -0.009017329663038254, 0.00019025990332011133, -0.01691199094057083, 0.0028714402578771114, -0.02655542455613613, 0.03520572930574417, -0.020035313442349434, 0.007282951381057501, 0.011399402283132076, 0.05092308670282364, 0.017559684813022614, -0.0001846375671448186, 0.0036324800457805395, -0.001993456156924367, 0.009873724542558193, -0.04035848751664162, 0.015616605058312416, 0.012471694499254227, -0.008398422971367836, 0.004746152553707361, -0.009031723253428936, -0.0025170082226395607, 0.02682889625430107, -0.018005874007940292, 0.0081321494653821, 0.03080141544342041, 0.026641784235835075, -0.008823022246360779, -0.03146350011229515, -0.0024936192203313112, -0.012464498169720173, 0.022223077714443207, 0.016983957961201668, 0.00942033901810646, -0.0025709825567901134, -0.00024918201961554587, 0.003889758139848709, -0.011262666434049606, 0.01718546263873577, -0.020467108115553856, 0.045770324766635895, 0.019805021584033966, -0.022007178515195847, 0.008650303818285465, 0.02115798182785511, -0.020265603438019753, 0.0029326113872230053, 0.010874050669372082, 0.016235511749982834, 0.03157864511013031, 0.002272323938086629, 0.004602220840752125, -0.031118065118789673, 0.044331006705760956, 0.010327110067009926, 0.03278767317533493, -0.051930610090494156, 0.01659534126520157, -0.027634914964437485, 0.010456648655235767, 0.003537125186994672, -0.03825708478689194, 0.013615952804684639, 0.025749407708644867, -0.04729600250720978, 0.03108927793800831, -0.03687533736228943, -0.0043611349537968636, -0.01835131086409092, -0.017430147156119347, 0.011197897605597973, 0.017890729010105133, -0.04689299315214157, -0.006088316906243563, 0.035464808344841, 0.014623475261032581, 0.023173026740550995, -0.03575266897678375, -0.012982652522623539, 0.0037098433822393417, 0.005555769428610802, -0.008664697408676147, -0.007873072288930416, 0.005775265395641327, -0.012327762320637703, -0.001557162613607943, -0.039091888815164566, 0.01437879167497158, -0.01396858599036932, 0.007570814806967974, -0.004566237796097994, -0.023000309243798256, 0.0023227001074701548, -0.0007390000391751528, 0.009369962848722935, 0.029232557862997055, -0.0434386320412159, 0.019243687391281128, 0.019545944407582283, -0.01068693958222866, 0.0026735339779406786, 0.0073980968445539474, -0.02390708029270172, 0.001968268072232604, -0.001961071277037263, -0.025806980207562447, -0.004379126243293285, -0.010298323817551136, 0.004256784450262785, -0.0016669107135385275, -0.013126583769917488, 0.0055521707981824875, 0.0360405333340168, -0.019977740943431854, -0.01564539223909378, -0.014940125867724419, -0.00759240472689271, 0.004717366304248571, 0.00011205318878637627, -0.019056575372815132, 0.013817457482218742, 0.026425886899232864, 0.011053965426981449, 0.03563752397894859, -0.01979062892496586, -0.005955180153250694, -0.002619559643790126, 0.03917824849486351, 0.009952886961400509, -0.02649785205721855, -0.007023874204605818, 0.05230483412742615, -0.02651224657893181, -0.015112843364477158, -0.027706880122423172, -0.03310432285070419, -0.03586781397461891, 0.020754972472786903, 0.022913949564099312, -0.012889096513390541, -0.012723575346171856, -0.018192986026406288, 0.00016271045024041086, -0.017372572794556618, 0.008556747809052467, 0.03391034156084061, 0.012982652522623539, 0.004519459791481495, -0.019473979249596596, -0.012284582480788231, -0.019214902073144913, -0.020294390618801117, 6.707449210807681e-05, -0.015515852719545364, -0.017055923119187355, 0.0027401025872677565, 0.03327704221010208, 0.013076208531856537, 0.0016534170135855675, -0.031146850436925888, 0.011449778452515602, -0.00207981513813138, -0.0016363251488655806, -0.012889096513390541, 0.02363360859453678, -0.012457300908863544, -0.017055923119187355, 0.029506027698516846, -0.03224073350429535, 0.01790512166917324, -0.0038609716575592756, 0.000884281296748668, -0.02749098278582096, 0.005742880515754223, 0.006099111866205931, 0.03762378543615341, -0.017041530460119247, -0.002720311749726534, 0.017991481348872185, -0.032874032855033875, -0.029966609552502632, 0.0117880180478096, 0.018192986026406288, -0.03235587850213051, -0.00690153194591403, -0.012579643167555332, -0.001034510089084506, -0.0025098114274442196, 0.01512723695486784, 0.01708471029996872, 0.020970869809389114, -0.007693157065659761, 0.008859004825353622, -0.00903891958296299, -0.0434386320412159, 0.04127965122461319, -0.022496547549962997, -0.027620520442724228, -0.013659131713211536, -0.0012387133901938796, -0.03391034156084061, -0.012867506593465805, -0.018552815541625023, -0.012522070668637753, 0.006548898760229349, 0.0049620503559708595, 0.019488371908664703, -0.001062396913766861, -0.014450756832957268, 0.0018477250123396516, 0.018365703523159027, -0.004217203240841627, 0.004602220840752125, 0.0337088368833065, -0.03627082332968712, -0.02043832279741764, -0.010543007403612137, -0.012666001915931702, -0.005796854849904776, -0.03851616010069847, -0.01747332513332367, 0.013191353529691696, 0.012622823007404804, -0.005105982068926096, -0.0037746126763522625, 0.01102517917752266, -0.000670182635076344, -0.021287519484758377, -0.0020528279710561037, -0.009542681276798248, -0.004483476746827364, -0.005771666765213013, 0.010758905671536922, -0.03511936962604523, 0.004782135598361492, -0.04214324429631233, -0.019992133602499962, 0.0393509678542614, 0.012176633812487125, 0.007426883094012737, -0.02137387916445732, 0.025691833347082138, -0.016321871429681778, 0.004846904892474413, 0.018667960539460182, 0.007779516279697418, 0.028066709637641907, -0.01791951432824135, -0.01333528570830822, -0.007290147710591555, 0.02236700803041458, 0.03042719140648842, -0.04767022654414177, -0.041366010904312134, 0.01658094860613346, 0.010751708410680294, -0.041682660579681396, -0.01065815333276987, 0.005613341927528381, 0.0102767338976264, 0.027706880122423172, -0.008441602811217308, -0.021301912143826485, -0.047468721866607666, -0.02760612778365612, 0.027030400931835175, -0.0233745314180851, 0.02209353819489479, 0.01691199094057083, -0.019992133602499962, 0.014824979938566685, -0.016667308285832405, 0.025490330532193184, 0.019473979249596596, 0.010708529502153397, 0.003569509834051132, 0.005357862915843725, 0.0062322490848600864, -0.04738236218690872, -0.003832185408100486, 0.018941430374979973, -0.03085898794233799, 0.0008725867955945432, -0.014393184334039688, -0.01008242554962635, -0.02374875359237194, 0.009844938293099403, 0.023043489083647728, -0.037825290113687515, 0.011536137200891972, -0.010888444259762764, 0.03543601930141449, 0.0001097480344469659, -0.025432756170630455, -0.006494924426078796, 0.011133127845823765, -0.010845264419913292, 0.025029748678207397, 0.010665349662303925, 0.022410187870264053, -0.005721290595829487, -0.010017656721174717, -0.0010309118079021573, 0.0014977907994762063, 0.0023892687167972326, 0.0263970997184515, -0.004695776384323835, 0.014753013849258423, 0.020467108115553856, -0.005537777673453093, -0.008650303818285465, 0.025260038673877716, 0.007513242308050394, 0.0025871749967336655, -0.015487066470086575, -0.003000978846102953, -0.002583576599135995, 0.02567744068801403, 0.03644354268908501, -0.0017595668323338032, 0.06592078506946564, 0.018725533038377762, 0.002554790349677205, 0.001218023244291544, -0.01316976360976696, -0.02606605738401413, 0.05443502217531204, -0.012543660588562489, 0.03126199543476105, 0.0020582254510372877, 0.02336013875901699, 0.003242064733058214, 0.007110232952982187, 0.016739273443818092, -0.01005363930016756, -0.009945690631866455, -0.0026015681214630604, 0.021345091983675957, 0.01702713780105114, -0.007873072288930416, 0.00023973647330421954, 0.014839373528957367, 0.01763165183365345, -0.03241345286369324, -0.0031161245424300432, -0.010578990913927555, 0.012075881473720074, 0.028340179473161697, -0.01118350401520729, -0.013176959939301014, -0.02711675874888897, 0.04502188041806221, 0.016163546591997147, -0.026972828432917595, -0.0021068023052066565, 0.042229603976011276, -0.02550472319126129, -0.04099179059267044, -0.01977623626589775, 0.02435326762497425, -0.01614915207028389, -0.007059856783598661, 0.005537777673453093, -0.0027149145025759935, 0.0271743331104517, -0.0008289574761874974, -0.01181680429726839, 0.01685441844165325, -0.007365711964666843, -0.02292834222316742, -0.02199278585612774, -0.021229946985840797, -0.004249587655067444, 0.002641149330884218, 0.004954853560775518, -0.043121982365846634, 0.0006922222091816366, -0.020524680614471436, -0.01603400707244873, -0.01314097736030817, 0.020423928275704384, 0.003062149975448847, 0.0013142776442691684, 0.03880402445793152, 0.022194290533661842]",Token-level Direct Preference Optimization.pdf
" never expected
to feel anger towards my sister for getting pregnant. But really, how am I
expected to feel about this?
I would never dare tell my sister or anyone else in my family how I feel
about this. I wouldn’t want to upset anyone and I really don’t want to be
selfish and make this about me. It’s just so hard.
DPO Summary I have a sister who’s pregnant and I feel immensely jealous and sad and I
don’t know how to deal with my feelings. I don’t want to have children.
ODPO Summary My sister is pregnant and I’m jealous and sad even though I’m happy for
her and I would love to be pregnant one day. I don’t know how to feel. I
really just want to vent.
Judgment Summary A [ODPO] better captures the overall emotion, situation, and
dilemma of the original post, while Summary B [DPO] falsely claims
that the poster does not want children, which contradicts the information
provided in the original post.
Table 3: An example of two summaries sampled with temperature 0.75, and its corresponding judgment from GPT-4.
Summaries are shown to the model in random order and are tagged with A or B. For clarity, we add the method in
brackets.
Post We have been dating for two and a half months, but we were friends in
high school. We are both divorced, but her kids’ dad takes them maybe
one day a week. By their bedtime she’s too tired to stay up for time for
herself. I have more free time because I only have my kids for half the
time.
What can I say to her to help her get over the mentality she has to take
care of all her problems alone? I’m willing to invest whatever it takes
because we get along so well. Ask me any info that I may have left out.
DPO Summary My girlfriend has to take care of her kids and her problems because she
doesn’t have time to do anything for herself. How can I help her?
ODPO Summary My girlfriend of two months is constantly tired from taking care of her
kids. How can I help her get over the mentality she has to take care of
everything alone?
Judgment Summary B [ODPO] is more concise and accurate as it mentions the
key point about the poster wanting to help his girlfriend overcome her
mentality of taking care of everything by herself, compared to Summary
A[DPO] which does not convey this aspect clearly.
Table 4: An example of two summaries sampled with temperature 0.5, and its corresponding judgment from GPT-4.
Summaries are shown to the model in random order and are tagged with A or B. For clarity, we add the method in
brackets.
Post I am currently in college and I met this wonderful girl. We have gone
on a few dates and everything appeared to be going great. She wanted
to taking things quite slow because she was getting over a recent ex
boyfriend.
However when I met her roommate she brought up that this girl has a
boyfriend who has been acting rather shady towards her. He goes to
another college and he has been spending the night ""on the couch"" at this
other girls place frequently. He also has recently been posting on her
wall and now I’m rather confused.
I know something is up but I really don’t know how to handle this. I
would really like to be straight forward with her but she seems dodgy
whenever I do. I really am beginning to over think things and I almost
feel like I was just there to shove in his face.
I really hate this situation because I feel like I could have a legitimate
relationship with this girl.
DPO Summary Met a girl who has a boyfriend who is spending the night at her place
frequently. She has been posting on his wall and I feel like she is hiding
something. I don’t know how to proceed.
ODPO Summary met girl, she has a boyfriend who is acting shady towards her, she wants
to take things slow, I’m confused as to what is going on.
Judgment Summary A [ODPO] provides more accurate information about the
situation, specifically pointing out that the girl wants to take things
slow, and expresses the poster’s confusion more effectively, whereas,
Summary B [DPO] provides false information about the girl posting on
the boyfriend’s wall.
Table 5: An example of two summaries sampled with temperature 0.25, and its corresponding judgment from GPT-4.
Summaries are shown to the model in random order and are tagged with A or B. For clarity, we add the method in
brackets.
Post My best friend and I have been friends for around ","[0.002465831581503153, -0.015958471223711967, -0.07085981220006943, 0.07013920694589615, -0.030866054818034172, 0.009720705449581146, 0.042786117643117905, -0.040294013917446136, 0.014599824324250221, 0.003186439862474799, 0.026182102039456367, -0.005051764193922281, -0.03732150420546532, -0.00887248944491148, -0.001794952666386962, -0.0077765644527971745, 0.01444969791918993, 0.0031657973304390907, -0.041104696691036224, 0.04230571165680885, 0.03771183267235756, 0.01300848089158535, 0.02974010445177555, -0.015943458303809166, 0.035279780626297, -0.004282365087419748, 0.02723298780620098, 0.014051862061023712, 0.010201111435890198, -0.019741665571928024, 0.012370442040264606, -0.022278806194663048, -0.011364593170583248, -0.06473464518785477, 0.012370442040264606, 0.010981770232319832, -0.024080326780676842, 0.018465587869286537, 0.016709104180336, -0.04071436822414398, 0.026182102039456367, 0.0005648517981171608, 0.006624341942369938, -0.06539520621299744, -0.013796646147966385, 0.0520038977265358, 0.01813530921936035, 0.011251998133957386, 0.044197309762239456, 0.0016072943108156323, -0.08857476711273193, 0.04170520603656769, 0.005869955290108919, 0.0390329509973526, 0.0005808027926832438, -0.027848508208990097, -0.0010846656514331698, -0.005393302533775568, 0.031736791133880615, -0.01352641824632883, 0.03561006113886833, -0.005359524395316839, -0.009195261634886265, 0.045758627355098724, 0.008977578021585941, 0.006658120546489954, -0.03651082143187523, -0.00939042679965496, 0.008812438696622849, -0.027187950909137726, 0.07362214475870132, 0.03939325362443924, 0.031166309490799904, -0.012017644941806793, -0.007386235054582357, 0.02332969382405281, 0.0696588009595871, -0.006162702105939388, -0.01726457290351391, -0.039543379098176956, 0.027067849412560463, 0.048821210861206055, -0.011349580250680447, 0.03669097274541855, 0.011304542422294617, -0.0016804810147732496, -0.053294990211725235, -0.015658218413591385, -0.004094706382602453, -0.025056151673197746, -0.02954494021832943, 0.02955995313823223, -0.04191538318991661, -0.014554786495864391, 0.07938701659440994, -0.05353518947958946, -0.02900448441505432, 0.020282121375203133, -0.005625999066978693, 0.037501655519008636, -0.0045300740748643875, -0.023614933714270592, -0.04488789290189743, 0.029620002955198288, 0.023584909737110138, -0.00868483167141676, -0.027353089302778244, 0.07356209307909012, 0.006965880282223225, 0.0037606745027005672, -0.05239422991871834, 0.02463579550385475, -0.018810879439115524, 0.057018131017684937, -0.04212556034326553, -0.005727334879338741, -0.026737570762634277, 0.029199648648500443, -0.0038582568522542715, -0.023104503750801086, -0.03738155588507652, -0.029064534232020378, -0.00023609773779753596, 0.026227138936519623, -0.011829986236989498, -0.05593721941113472, 0.055997271090745926, -0.06365372985601425, -0.04263599216938019, -0.0325474739074707, 0.02832891419529915, 0.0006319396779872477, -0.051913823932409286, -0.04599883034825325, -0.06479469686746597, -0.018840905278921127, 0.009360401891171932, 0.002180590759962797, -0.02349483221769333, 0.0006633724551647902, -0.0260019488632679, -0.0390329509973526, 0.028298888355493546, 0.003589905332773924, -0.009472996927797794, 0.016093585640192032, -0.0064629558473825455, 0.018435562029480934, -0.039153050631284714, 0.003501705825328827, 0.013819165527820587, 0.037501655519008636, -0.02621212601661682, -0.017159484326839447, 0.0789666622877121, -0.015177812427282333, 0.03185689076781273, -0.011604796163737774, 0.009743224829435349, -0.03167673945426941, -0.04849093407392502, -0.05446597561240196, 0.008962566033005714, -0.01831546053290367, -0.036841098219156265, 0.027248000726103783, -0.015237863175570965, 0.002458325121551752, -0.04452758654952049, -0.040474165230989456, 0.035429906100034714, 0.03128641098737717, -0.05674790218472481, 0.018976017832756042, -0.013083544559776783, -0.012745759449899197, 0.012723240070044994, -0.032937802374362946, -0.008797426708042622, 0.007667722646147013, -0.019741665571928024, 0.07272138446569443, -0.007119759917259216, -0.036480795592069626, 0.00647796830162406, -0.013406316749751568, 0.01810528337955475, 0.01568824239075184, -0.009007603861391544, -0.02832891419529915, 0.035910312086343765, 0.016874244436621666, 0.020867615938186646, -0.036360692232847214, 0.027848508208990097, -0.06551530212163925, 0.07470306009054184, 0.04756014794111252, -0.027563266456127167, 0.010081009939312935, 0.028764281421899796, 0.024951063096523285, 0.03894287347793579, -0.034889452159404755, 0.003407876705750823, -0.022699160501360893, 0.03011542186141014, -0.020207056775689125, -0.018180346116423607, 0.009457984007894993, 0.04200545698404312, -0.06341353058815002, 0.017429713159799576, 0.027293039485812187, 0.03398869186639786, -0.028088711202144623, -0.04524819552898407, 0.017865080386400223, 0.007611425127834082, -0.002154318615794182, 0.008392084389925003, 0.056627802550792694, 0.03272762522101402, 0.02017703279852867, -0.017910119146108627, 0.004931663163006306, 0.03858257085084915, -0.016589002683758736, -0.014479722827672958, -0.000341303733875975, 0.010486352257430553, 0.032937802374362946, -0.020957691594958305, -0.04999219998717308, 0.06629596650600433, -0.0195014625787735, -0.012070189230144024, -0.037231430411338806, -0.01700935885310173, -0.008016766980290413, 0.014682394452393055, 0.01839052326977253, 0.03561006113886833, 0.0015040821162983775, -0.030956130474805832, -0.014307077042758465, -0.0012404221342876554, -0.08389081805944443, -0.0260019488632679, -0.004316143225878477, 0.02247397042810917, -0.004252339713275433, -0.0176398903131485, -0.03221719712018967, -0.03873269632458687, -0.04053421691060066, 0.005941265262663364, 0.008211932145059109, -0.004402466118335724, 0.015132774598896503, -0.024110352620482445, 0.039903685450553894, 0.0007374975248239934, -0.010020959191024303, -0.007979235611855984, 0.03317800536751747, 0.025416454300284386, 0.02016201987862587, 0.018165333196520805, -0.031106257811188698, 0.0046314094215631485, -0.017985181882977486, 0.026257164776325226, 0.05362526699900627, -0.047229867428541183, -0.023990251123905182, -0.03335816040635109, 0.02127295732498169, -0.001572577515617013, -0.03305790573358536, -0.003952085971832275, 0.004672694485634565, 0.03290778025984764, -0.03419886901974678, 0.04386702924966812, 0.00392956705763936, 0.013699064031243324, 0.0464792363345623, -0.009397933259606361, 0.023554883897304535, -0.02825384959578514, -0.04701969027519226, 0.033868588507175446, -0.024951063096523285, 0.0014233890688046813, -0.035910312086343765, 0.048160653561353683, -0.04683953896164894, 0.04044413939118385, 0.051883798092603683, 0.026422305032610893, 0.0013924253871664405, 0.03594033792614937, 0.04620900750160217, 0.03765178471803665, -0.021077793091535568, 0.0015631945570930839, -0.006654367316514254, -0.005637258756905794, -0.00392206059768796, -0.02778845652937889, -0.057828813791275024, -0.012235328555107117, 0.03290778025984764, -0.025056151673197746, 0.010516377165913582, 0.033117957413196564, -0.01496012881398201, -0.04701969027519226, 0.003160167718306184, -0.04053421691060066, -0.01867576502263546, -0.005862448830157518, -0.0020942678675055504, 0.009457984007894993, -0.026152076199650764, -0.0018859669798985124, 0.00975073128938675, 0.020222069695591927, -0.009825794026255608, -0.033418208360672, -0.04230571165680885, 0.018840905278921127, 0.02843400277197361, 0.009930882602930069, -0.03783193603157997, -0.0025258820969611406, 0.06569545716047287, 0.0007337444112636149, 0.045188143849372864, -0.022519009187817574, -0.009090173058211803, 0.009322869591414928, 0.01682920567691326, -0.06725677102804184, -0.045848701149225235, 0.006031341385096312, 0.017039382830262184, -0.0009373537614010274, -0.012505556456744671, -0.0311362836509943, -0.010591440834105015, 0.04134489968419075, 0.031916942447423935, -0.0278635211288929, -0.009060148149728775, 0.04266601428389549, 0.011462175287306309, -0.007014671340584755, 0.016288749873638153, -0.011507214047014713, 0.030836030840873718, -0.032667577266693115, 0.028599141165614128, -0.019861765205860138, 0.00037977370084263384, -0.02750321663916111, -0.0032052055466920137, -0.023840123787522316, 0.005194384604692459, 0.0019535240717232227, -0.01291089877486229, -0.030956130474805832, 0.013166113756597042, -0.05275453254580498, 0.006339101120829582, 0.008234450593590736, -0.013158607296645641, -0.02397523820400238, 0.04999219998717308, -0.0325474739074707, 0.008985084481537342, -0.0014749950496479869, -0.0033384431153535843, 0.06365372985601425, 0.009653148241341114, -0.05185377225279808, -0.07932696491479874, -0.033328134566545486, -0.010276174172759056, 0.021137842908501625, 0.011537238955497742, -0.024215441197156906, -0.003344072960317135, -0.03774185851216316, -0.024020276963710785, 0.013196139596402645, 0.07110001891851425, 0.016198674216866493, -0.03867264464497566, 0.03296782821416855, -0.026257164776325226, -0.04095457121729851, -0.023810099810361862, -0.024650808423757553, -0.02008695714175701, 0.01894599385559559, 0.004147250670939684, 0.026437316089868546, 0.007986742071807384, -0.011582276783883572, -0.03594033792614937, 0.06401403993368149, 0.019906803965568542, -0.02712789922952652, -0.03305790573358536, 0.02712789922952652, 0.038972899317741394, 0.030926106497645378, 0.048550982028245926, -0.02378007397055626, -0.04299629479646683, 0.011552251875400543, -0.03882277011871338, 0.023164553567767143, 0.01305351871997118, 0.04206550866365433, -0.02852407842874527, 0.014014329761266708, -0.06485474854707718, -0.031106257811188698, 0.04731994494795799, -0.006354113575071096, -0.019396374002099037, 0.010854162275791168, -0.03927315026521683, -0.013076038099825382, 0.002441435819491744, -0.04626905918121338, -0.027713393792510033, 0.03416884317994118, -0.043446674942970276, 0.019546499475836754, -0.012558100745081902, -0.03314798325300217, 0.031166309490799904, 0.020507311448454857, -0.04497796669602394, -0.023284655064344406, 0.024320529773831367, -0.04005381092429161, -0.02128797024488449, 0.06563540548086166, 0.017024371773004532, -0.029484888538718224, -0.024605771526694298, -0.014870052225887775, 0.014764963649213314, 0.029229674488306046, -0.04662936180830002, 0.019306296482682228, -0.02415539138019085, -0.03503957763314247, 0.004957935307174921, -0.010163579136133194, -0.0473799966275692, -0.001069652964361012, 0.01624371111392975, -0.048460908234119415, -0.011004289612174034, -0.014111912809312344, -0.038972899317741394, 0.014134431257843971, -0.002554030856117606, -0.04224565997719765, -0.005689803045243025, 0.03230727091431618, 0.03918307647109032, 0.01711444742977619, 0.03801208734512329, 0.020131994038820267, 0.014825014397501945, 0.008339540101587772, 0.012843341566622257, 0.010050984099507332, -0.04068434238433838, 0.027353089302778244, 0.029304737225174904, 0.0031038701999932528, 0.011244491674005985, -0.028779294341802597, -0.018795866519212723, 0.054225772619247437, -0.018840905278921127, 0.0049654413014650345, -0.004334909375756979, -0.00037719341344200075, -0.022744199261069298, 0.019951842725276947, -0.014269545674324036, 0.0455484502017498, 0.03849249333143234, 0.010231136344373226, 0.0074988300912082195, -0.0013755362015217543, -0.05287463217973709, 0.061852212995290756, -0.025686683133244514, -0.037861961871385574, -0.01681419275701046, 0.007468804717063904, -0.03329810872673988, -0.002298815408721566, -0.009600603953003883, -0.022353868931531906, 0.006973386742174625, -0.009863326326012611, 0.00022554195311386138, -0.004327402915805578, -0.006568044424057007, -0.0006436683470383286, -0.012648176401853561, 0.026812633499503136, 0.014562292955815792, 0.0033647152595221996, -0.017054395750164986, -0.0017930760513991117, 0.0010630849283188581, -0.01568824239075184, -0.019216220825910568, 0.025161240249872208, -0.010696529410779476, 0.009375413879752159, 0.0007332752575166523, -0.023900175467133522, 0.010418795049190521, -0.01026866864413023, -0.04014388844370842, 0.01783505454659462, -0.029620002955198288, 0.003056955523788929, -0.0143971536308527, 0.034439072012901306, -0.003846997395157814, 0.037861961871385574, -0.005637258756905794, 0.02304445207118988, 0.020612400025129318, -0.015748294070363045, 0.003177056787535548, 0.020882626995444298, 0.008046792820096016, 0.01147718820720911, -0.024125365540385246, -0.030190484598279, -0.0004759486473631114, 0.011920061893761158, -0.009488008916378021, 0.04849093407392502, -0.031736791133880615, 0.0028542843647301197, -0.024275491014122963, 0.01514778658747673, -0.0012498049763962626, 0.010516377165913582, 0.01962156407535076, 0.0033253070432692766, 0.016468901187181473, -0.001300472766160965, 0.006436683237552643, 0.00464642234146595, -0.011739910580217838, 0.006800740957260132, -0.04416728392243385, 0.0015153416898101568, 0.020237082615494728, 0.041224800050258636, -0.037952035665512085, 0.002711663953959942, -0.020417235791683197, -0.012175277806818485, -0.011604796163737774, -0.0007112253806553781, -0.01700935885310173, -0.010426301509141922, 0.005235669668763876, 0.03654084727168083, 0.01681419275701046, 0.014622343704104424, 0.02481594868004322, -0.012940923683345318, -0.0269327349960804, -0.01310606300830841, 0.02145310863852501, 0.014299570582807064, 0.015778319910168648, -0.002640353748574853, -0.028028659522533417, -0.02834392711520195, -0.00648172153159976, -0.019456423819065094, 0.0195014625787735, -0.07476311177015305, 0.0054608597420156, -0.0315866619348526, 0.04200545698404312, -0.0028129995334893465, -0.042155586183071136, -0.011439656838774681, -0.025386430323123932, -0.004102212842553854, 0.029860205948352814, 0.032757651060819626, -0.04590875282883644, -0.05230415239930153, 0.0250711627304554, -0.03783193603157997, 0.0025521544739603996, 0.021062780171632767, 0.021603235974907875, 0.0020473531913012266, 0.011101871728897095, 0.011875024065375328, 0.004402466118335724, 0.0408644936978817, -0.001923498697578907, -0.03203704208135605, 0.014719925820827484, 0.010846655815839767, 0.016213687136769295, -0.01785006746649742, -0.035279780626297, 0.0072886524721980095, 0.002657243050634861, 0.03756170719861984, 0.010028465650975704, -0.02286430075764656, -0.005464612971991301, -0.004331156145781279, -0.022984402254223824, -0.015598166733980179, 0.01772996596992016, 0.02379508689045906, -0.03428894653916359, -0.017219536006450653, -0.009412946179509163, -0.02480093576014042, 0.021858451887965202, -0.012528075836598873, -0.05158354341983795, -0.036180540919303894, -0.0005564072052948177, 0.04849093407392502, 0.010726554319262505, 0.01356394961476326, -0.01729459874331951, -0.012227822095155716, -0.011702378280460835, -0.043897055089473724, 0.004957935307174921, -0.009555566124618053, -0.006474215071648359, -0.019276272505521774, -0.010201111435890198, -0.003809465793892741, 0.030400661751627922, 0.016769155859947205, 0.013894228264689445, 0.02489101141691208, 0.015245369635522366, -0.019276272505521774, 0.017790017649531364, 0.04897134006023407, -0.03539988398551941, 0.014952622354030609, 0.008587248623371124, 0.02535640448331833, -0.0445876382291317, 0.016423864290118217, 0.029785143211483955, -0.003407876705750823, -0.02870422974228859, 0.011995125561952591, 0.05683797970414162, 0.002450818894430995, 0.009983427822589874, 0.00990085769444704, 0.00789666548371315, -0.008512185886502266, -0.0134663674980402, -0.012618151493370533, 0.03104620799422264, 0.01453977357596159, -0.01804523356258869, 0.041495028883218765, -0.022458959370851517, -0.00872986949980259, 0.023855136707425117, 0.0016157389618456364, -0.08611269295215607, -0.02035718411207199, 0.004364934749901295, -0.014787483029067516, 0.02861415408551693, -0.024740884080529213, -0.04572860151529312, -0.011784948408603668, 0.02323961816728115, 0.013136088848114014, -0.011822479777038097, -0.026707544922828674, -0.01978670246899128, 0.0027004044968634844, 0.0064104110933840275, -0.02071748860180378, -0.012888379395008087, -0.015823356807231903, 0.014532267116010189, 0.01138711255043745, -0.007701501250267029, -0.0069321016781032085, 0.020657436922192574, -0.019546499475836754, -0.01772996596992016, -0.006887063849717379, -0.007573893293738365, -0.03567010909318924, 0.017714953050017357, -0.04813062772154808, 0.0031414018012583256, 0.022503996267914772, 0.029905244708061218, -0.013211152516305447, -0.022143691778182983, -0.014682394452393055, 0.021393058821558952, -0.02295437641441822, 0.054946381598711014, -0.021858451887965202, 0.011882530525326729, 0.037861961871385574, -0.030445700511336327, -0.010163579136133194, 0.001603541080839932, 0.010156073607504368, 0.0006849531782791018, -0.03134646266698837, 0.04293624311685562, 0.011034314520657063, 0.01082413736730814, -0.01792513206601143, 0.016018521040678024, -0.03452914580702782, -0.017519788816571236, -0.005539676174521446, -0.010576427914202213, 0.015598166733980179, -0.006459202617406845, 0.01757984049618244, -0.030806005001068115, 0.0007966099656186998, 0.03299785405397415, -0.007465051487088203, -0.014922596514225006, -0.030896080657839775, -0.003088857512921095, -0.016709104180336, -0.012903392314910889, 0.019216220825910568, -0.010081009939312935, 0.016949307173490524, -0.002649736823514104, -0.00886498298496008, 0.01905108243227005, 0.04020393639802933, -0.03230727091431618, -0.012513062916696072, -0.03567010909318924, 0.00817440077662468, -0.00975823774933815, 0.005854942370206118, 0.010246149264276028, -0.027338076382875443, 0.009367907419800758, 0.016393838450312614, 0.03753168135881424, 0.0399337112903595, 0.008091830648481846, -0.0028786801267415285, -0.047229867428541183, -0.013999317772686481, 0.006902076303958893, -0.024230454117059708, -0.0023738788440823555, 0.014862545765936375, 0.017234548926353455, -0.060441020876169205, -0.12010138481855392, -0.013211152516305447, 0.004192288964986801, 0.00622275285422802, -0.04731994494795799, -0.0005779879284091294, 0.01618366129696369, 0.030235523357987404, 0.013834178447723389, -0.009533047676086426, 0.020597387105226517, -0.02481594868004322, -0.01661902852356434, -0.018375512212514877, -0.004421232268214226, -0.00886498298496008, -0.024410605430603027, -0.01351891178637743, 0.014509748667478561, -0.021498147398233414, -0.029770130291581154, -0.029770130291581154, -0.024875998497009277, 0.006887063849717379, -0.008121855556964874, 0.004616396967321634, -0.0010996783385053277, 0.015372976660728455, 0.010171085596084595, 0.0037963297218084335, 0.018375512212514877, -0.013121075928211212, 0.016949307173490524, -0.02426047995686531, -0.008519691415131092, -0.03849249333143234, 0.013661532662808895, 0.027728406712412834, 0.009165236726403236, 0.003040066221728921, 0.053204912692308426, 0.02016201987862587, 0.03272762522101402, -0.0025164992548525333, 0.006290310062468052, -0.044077206403017044, 0.016393838450312614, 0.024110352620482445, -0.01035874430090189, 0.013316241092979908, 0.01772996596992016, 0.010096022859215736, -0.014051862061023712, -0.029574966058135033, -0.01561317965388298, 0.004211054649204016, -0.035369858145713806, 0.0050179860554635525, -0.0015331691829487681, -0.0022762964945286512, 0.00434241583570838, 0.0011672353139147162, 0.009375413879752159, 0.0037494150456041098, -0.02073250152170658, -0.0007806589710526168, 0.021528173238039017, -0.01300097443163395, -0.022744199261069298, 0.011101871728897095, -0.04599883034825325, 0.011169428937137127, 0.042605966329574585, -0.04467771574854851, -0.02388516254723072, 0.021678298711776733, 0.028193799778819084, -0.012062682770192623, -0.06161201000213623, 0.0026666258927434683, 0.016378825530409813, 0.002512746024876833, 0.009645642712712288, 0.03137648478150368, 0.017820043489336967, 0.019681613892316818, -0.008722363039851189, -0.04987210035324097, -0.013901734724640846, 0.005434587597846985, 0.01645389012992382, -0.02825384959578514, -0.014352114871144295, -0.033328134566545486, -0.026046987622976303, -0.01300848089158535, -0.013151101768016815, -0.01142464391887188, 0.03464924916625023, -0.007078475318849087, 0.010508870705962181, -0.002084885025396943, -0.01589842140674591, -0.018510624766349792, -0.010351237840950489, -0.008662312291562557, 0.03212711960077286, -0.018555663526058197, 0.010486352257430553, -0.019576525315642357, -0.008196919225156307, -0.026362253352999687, -0.0548262819647789, -0.006046353839337826, -0.012257847003638744, 0.06365372985601425, 0.01645389012992382, -0.01571826823055744, 0.050682783126831055, -0.014622343704104424, -0.00878992024809122, 0.0381321907043457, 0.00785913411527872, 0.01980171538889408, -0.002816752763465047, 0.04698966443538666, 0.030145447701215744, 0.021107817068696022, -0.022353868931531906, -0.0030456960666924715, -0.01903606951236725, 0.02026710845530033, 0.04227568581700325, 0.038342367857694626, 0.05731838569045067, 0.008632286451756954, 0.018570676445961, 0.011064339429140091, 0.0059187463484704494, 0.009457984007894993, 0.01598849706351757, 0.003272762754932046, 0.01774497888982296, 0.01691928133368492, -0.030956130474805832, -0.000726238067727536, 0.02341976948082447, -0.009548059664666653, -0.0250711627304554, -0.007461298257112503, 0.01959153823554516, -0.038702670484781265, 0.020327158272266388, -0.007791577372699976, 0.040744394063949585, 0.023089490830898285, -0.02499609999358654, 0.00388077599927783, -0.01570325531065464, -0.005978797096759081, -0.007232354953885078, 0.02981516905128956, -0.014659875072538853, -0.0292596984654665, 0.04756014794111252, -0.0070109181106090546, 0.013901734724640846, -0.00020583781588356942, -0.02537141740322113, -0.01597348414361477, 0.0003518595185596496, 0.002034217119216919, 0.03801208734512329, -0.0007679920527152717, 0.039633456617593765, 0.04335659742355347, 0.020026905462145805, 0.008016766980290413, -0.0501723513007164, -0.002880556508898735, 0.04239578917622566, -0.0011953840730711818, -0.016033533960580826, 0.002619711449369788, 0.03882277011871338, -0.024215441197156906, 0.012640670873224735, -0.003558003343641758, -0.02992025762796402, -0.00948050245642662, 0.031256385147571564, 0.028043672442436218, 0.0033027881290763617, 0.01942639797925949, 0.01615363545715809, -0.005502144806087017, 0.010328718461096287, 0.023059464991092682, 0.0018231014255434275, -0.01682920567691326, 0.0019891790580004454, 0.03867264464497566, 0.033508285880088806, -0.014149444177746773, 0.003501705825328827, 0.06068122386932373, 0.019186194986104965, 0.01941138505935669, 0.0017114446964114904, 0.02109280601143837, -0.003822601865977049, -0.006215246394276619, -0.04410723224282265, 0.0118449991568923, -0.007082228548824787, -0.012227822095155716, -0.01300097443163395, -0.02649736776947975, 0.012993467971682549, -0.010351237840950489, 0.0035392376594245434, 0.0026928982697427273, -0.020852603018283844, -0.005258188582956791, -0.01301598735153675, -0.00042481173295527697, 0.02005693130195141, 0.0176398903131485, 0.007273640017956495, 0.0032277246937155724, -0.020402222871780396, 0.04077441990375519, -0.002144935540854931, 0.0150952422991395, 0.024845972657203674, -0.0006061366875655949, 0.010801617987453938, -0.0026478602085262537, 0.01645389012992382, -0.03449912369251251, -0.008332033641636372, -0.02098771743476391, -0.02211366780102253, -0.03948333114385605, -0.01645389012992382, -0.007971729151904583, 0.06020081788301468, 0.026272177696228027, 0.0008519691764377058, 0.003501705825328827, -0.031556639820337296, 0.04398713260889053, -0.016589002683758736, -0.013691557571291924, 0.02741314098238945, 0.007941704243421555, -0.025986935943365097, 0.016573991626501083, 0.004237326793372631, -0.013091051019728184, 0.0035261015873402357, 0.02609202452003956, -0.009120198898017406, 0.0022781731095165014, -0.002951866714283824, -0.003501705825328827, 0.01794014312326908, 0.004327402915805578, -0.003287775442004204, 0.006669379770755768, -0.041675180196762085, 0.015125268138945103, -0.011792454868555069, 0.04017391428351402, 0.012167771346867085, -0.023254631087183952, -0.003058832138776779, 0.003576769260689616, 0.027338076382875443, -0.02082257717847824, 0.026182102039456367, 0.0195014625787735, -0.015733281150460243, 0.029379799962043762, -0.007146032061427832, -0.020657436922192574, -0.020582374185323715, 0.005036751739680767, 0.003970852121710777, 0.022173717617988586, -0.006372879724949598, 0.03912302479147911, 0.01036625076085329, 0.005213150754570961, 0.0032052055466920137, -0.00392956705763936, 0.007465051487088203, 0.04131487384438515, -0.003914554603397846, -0.0028824331238865852, -0.027728406712412834, 0.0199818667024374, 0.03185689076781273, 0.014674887992441654, 0.03446909785270691, 0.017609864473342896, -0.015418015420436859, -0.023554883897304535, -0.02992025762796402, -0.016754142940044403, -0.003025053534656763, 0.00036523016751743853, 0.027803469449281693, 0.022819261997938156, -0.012843341566622257, 0.008339540101587772, 0.008046792820096016, -0.015418015420436859, -0.017609864473342896, 0.01726457290351391, 0.011146909557282925, 0.007014671340584755, 0.0006849531782791018, 0.04801052808761597, 0.023720022290945053, -0.022503996267914772, 0.025011112913489342, 0.0042973775416612625, -0.02471086010336876, -0.008797426708042622, 0.014734938740730286, -0.013301228173077106, 0.024185415357351303, 0.0006882371963001788, -0.039633456617593765, -0.03389861434698105, -0.0125355813652277, 0.03576018661260605, -0.013706570491194725, 0.006654367316514254, -0.004912897013127804, -0.011642327532172203, -0.015418015420436859, 0.044827841222286224, -0.006068872753530741, 0.011282023973762989, -0.0009232793818227947, 0.034709300845861435, -0.0031564144883304834, 0.015778319910168648, 0.0882144644856453, -0.026272177696228027, -0.02705283649265766, 0.012437999248504639, -0.009157730266451836, -0.0005643826443701982, -0.008512185886502266, 0.012610645033419132, -0.008392084389925003, 0.020041918382048607, 0.003503582440316677, -0.001285460079088807, 0.003261503065004945, 0.05470617860555649, 0.028133748099207878, -0.00755137437954545, -0.00018062122398987412, -0.004563852678984404, 0.01736966334283352, -0.00826447643339634, 0.006042600609362125, -0.01300097443163395, -0.014201988466084003, -0.005464612971991301, -0.04128485172986984, -0.004079693928360939, 0.027443166822195053, -0.012790797278285027, 0.0008195980917662382, 0.007874147035181522, 0.029680054634809494, 0.008294501341879368, -0.0010949868010357022, 0.00043888611253350973, -0.0068532852455973625, 0.021017741411924362, 0.015365470200777054, 0.011687365360558033, 0.0033891107887029648, 0.00044287386117503047, 0.015237863175570965, 0.0008069311734288931, 0.012242835015058517, -0.030370637774467468, 0.034439072012901306, 0.022834274917840958, -0.01720452308654785, 0.010096022859215736, -0.0007679920527152717, -0.008707350119948387, 0.03047572635114193, 0.016754142940044403, 0.022819261997938156, 0.05797894299030304, -0.012760771438479424, -0.007562634069472551, -0.007671475876122713, 0.030700916424393654, 0.029529927298426628, 0.028193799778819084, -0.045578476041555405, 0.01607857272028923, -0.006613082252442837, 0.010636478662490845, 0.008512185886502266, -0.017714953050017357, 0.019396374002099037, 0.008377071470022202, -0.025941899046301842, 0.028013646602630615, -0.0292596984654665, -0.009022616781294346, -0.010786605067551136, -0.016664067283272743, -0.030640864744782448, 0.016694091260433197, -0.0529346838593483, -0.017880093306303024, 0.027848508208990097, 0.0004037001635879278, 0.030550789088010788, -0.025131214410066605, -0.012903392314910889, 0.013714076951146126, -0.019726652652025223, -0.024410605430603027, -0.026227138936519623, 0.016483914107084274, -0.04125482589006424, -0.006455449387431145, -0.003974605351686478, 0.010711542330682278, -0.009788262657821178, 0.007949210703372955, 0.01589842140674591, -0.016033533960580826, -0.007641450501978397, 0.001164420391432941, 0.014111912809312344, -0.004954182077199221, -0.03570013493299484, 0.016483914107084274, -0.013751608319580555, -0.0009368846076540649, 0.015658218413591385, 0.023149540647864342, 0.0022218755912035704, -0.013759114779531956, 0.003094487125054002, -0.03215714544057846, 0.0029162117280066013, -0.0023532365448772907, 0.002649736823514104, 0.014757457189261913, -0.035820238292217255, 0.003257750067859888, 0.058879703283309937, -0.027353089302778244, 0.01082413736730814, -0.01804523356258869, -0.0034660508390516043, 0.007055956404656172, 0.002968756016343832, -0.03335816040635109, 0.019756676629185677, 0.032007019966840744, 0.009397933259606361, 0.0381021648645401, -0.002052983036264777, 0.016799181699752808, -0.02229381911456585, 0.03594033792614937, 0.0083695650100708, -0.013233670964837074, -0.0009767620358616114, 0.04005381092429161, -0.011004289612174034, -0.00831702072173357, -0.04915149137377739, -0.0325174480676651, -0.03642074391245842, 0.008602261543273926, 0.02823883667588234, -0.015065217390656471, -0.018435562029480934, -0.015403002500534058, 0.01342132966965437, -0.020657436922192574, 0.023554883897304535, 0.02739812806248665, 0.028869369998574257, 0.016694091260433197, -0.015230356715619564, -0.02016201987862587, -0.02769838087260723, -0.029695067554712296, -0.006755702663213015, -0.006725677289068699, -0.022413920611143112, -0.0032446139957755804, 0.022038603201508522, 0.009660654701292515, 0.021888477727770805, -0.022789238020777702, 0.027548255398869514, -0.001795890973880887, 0.0031188828870654106, -0.02778845652937889, 0.021603235974907875, -0.02778845652937889, -0.014044355601072311, -0.013864203356206417, -0.037021249532699585, 0.00699590565636754, 0.0046314094215631485, 0.012212809175252914, -0.008444628678262234, 0.0011325185187160969, -0.0019516474567353725, 0.035069603472948074, -0.012332910671830177, -0.02750321663916111, 0.00422982033342123, -0.012437999248504639, -0.023720022290945053, 0.007157291751354933, 0.021528173238039017, -0.028584128245711327, 0.02732306532561779, 0.0074763111770153046, 0.004635162651538849, -0.003558003343641758, 0.005419574677944183, -0.014742444269359112, 0.019396374002099037, -0.014900078065693378, 0.005093049257993698, -0.04005381092429161, -0.04350672662258148, 0.02556658163666725, -0.013601481914520264, -0.018435562029480934, 0.003128265729174018, 0.0134738739579916, -0.031106257811188698, -0.025941899046301842, -0.0218284260481596, -0.00832452718168497, 0.05878962576389313, -0.0059187463484704494, 0.03984363377094269, 0.015087735839188099, 0.0013417575974017382, 0.010936732403934002, 0.04410723224282265, -0.010306200012564659, -0.017684929072856903, 0.05620744824409485, -0.0316166877746582, -0.0017142596188932657, -0.0077765644527971745, -0.01402934268116951, 0.006808246951550245, -0.04915149137377739, -0.0016964320093393326, 0.04452758654952049, 0.0031432784162461758, 0.025941899046301842, -0.010426301509141922, 0.023209592327475548, 0.00990085769444704, -0.0027435659430921078, -0.016754142940044403, -0.0024808442685753107, 0.007307418622076511, -0.004203548189252615, -0.014404659159481525, -0.030836030840873718, -0.012167771346867085, -0.028494052588939667, -0.0012094584526494145, 0.028028659522533417, 0.007866640575230122, -0.0067369369789958, -0.012047669850289822, 0.0033816045615822077, -0.023900175467133522, 0.017024371773004532, 0.020011892542243004, 0.007138526067137718, 0.004057175014168024, -0.007374975364655256, -0.029935268685221672, -0.01300848089158535, 0.012377948500216007, 0.015125268138945103, -0.03509962931275368, -0.0380721390247345, 0.02322460524737835, 0.012265353463590145, -0.05788886547088623, -0.0176398903131485, -0.00699590565636754, 0.0007074722088873386, 0.026407292112708092, 0.002084885025396943, -0.01291089877486229, -0.043897055089473724, -0.018555663526058197, 0.020387209951877594, -0.031196333467960358, 0.01607857272028923, -0.021167868748307228, 0.004683953709900379, 0.021167868748307228, 0.007179810665547848, 0.0427560918033123, 0.010989276692271233, -0.0006788542959839106, 0.0037869466468691826, 0.027172937989234924, 0.016709104180336, -0.043897055089473724, 0.015748294070363045, 0.035429906100034714, -0.020192045718431473, -0.002585932845249772, -0.027082862332463264, -0.019666600972414017, 0.003678104840219021, 0.011814973317086697, 0.008444628678262234, -0.02035718411207199, -0.0031714271754026413, 0.005862448830157518, 0.031826864928007126, 0.0002514622756280005, -0.010306200012564659, -0.026137063279747963, 0.016513939946889877, -0.015448040328919888, 0.006436683237552643, 0.002578426618129015, 0.005498391576111317, -0.008617274463176727, -0.013151101768016815, -0.004327402915805578, 0.0022143691312521696, -0.0005132457590661943, -0.003846997395157814, 0.0021186633966863155, -0.005299473647028208, 0.006725677289068699, -0.011582276783883572, 0.005629752296954393, -0.005813657771795988, -0.006507993675768375, 0.011702378280460835, 0.0021843439899384975, -0.01905108243227005, -0.005607233382761478, 0.015463053248822689, 0.028584128245711327, 0.004770276602357626, 0.037681810557842255, 0.012505556456744671, 0.029710078611969948, 0.004282365087419748, 0.0009528356022201478, -0.01738467440009117, 0.049842074513435364, 0.020552348345518112, 0.026707544922828674, -0.008977578021585941, 0.034318968653678894, 0.019111132249236107, 0.006173961795866489, 0.014329596422612667, -0.0011559758568182588, -0.023750048130750656, -0.02034217119216919, 0.008947553113102913, 0.021333007141947746, -0.007716513704508543, -0.013098557479679585, 0.023359719663858414, 0.023479821160435677, -0.044077206403017044, 0.0018662628717720509, -0.017414700239896774, -0.002674132352694869, 0.00653051258996129, -0.012798303738236427, -0.006646860856562853, -0.022353868931531906, 0.005776125937700272, 0.005295720417052507, -0.014232013374567032, -0.007172304205596447, 0.027923570945858955, -0.025041138753294945, -0.015493078157305717, 0.0010330595541745424, 0.0014008700381964445, -0.017684929072856903, -0.0061514428816735744, 0.015838369727134705, -0.01398430485278368, 0.026512380689382553, -0.023359719663858414, 0.006827013101428747, 0.00887999590486288, -0.008039286360144615, -0.0371713787317276, -0.012302885763347149, -0.03203704208135605, -0.025161240249872208, 0.0013689680490642786, 0.026962760835886, -0.028674205765128136, 0.006121417507529259, -0.020222069695591927, -0.010156073607504368, 0.0044737765565514565, 0.019546499475836754, -0.0007722143782302737, -0.007874147035181522, 0.04981204867362976, 0.02451569400727749]",Token-level Direct Preference Optimization.pdf
"5 years now? She and
her boyfriend has been together for a few years alr too. She is the kind
of person who always put relationship over friendship, and because she’s
my best friend, I understand her and never said anything.
I understand when she stop replying me for days when she stays over
at her boyfriend’s house. I understand when she ask me to leave early
because she wanted to spend time with her boyfriend. I understand when
she said I’m not allowed to be in contact with her boyfriend.(One time
she got angry and ignored me for a month because I called her boyfriend
to come over when they had a fight)
I’m really okay with her being like this. Her boyfriend is an important
part of her life and I can accept that. But recently, I can’t even get a
reply from her. Her text replies are always short and cold. We go to
different schools so I don’t get to talk/see her everyday. I’m always the
one looking for a topic to talk about with her. She only comes looking
for me if she and her boyfriend has a fight and she needed somebody to
talk to or when her boyfriend is too busy to talk or go out with her.
I had confronted her about it, but she said that it’s not like that, she didn’t
mean to make me feel this way. But after that it’s always back to the
same situation and I always end up feeling used and neglected.
Any advice?
DPO Summary My best friend doesn’t reply me anymore and I feel like she doesn’t care
about me anymore. She always put her boyfriend over me. I’m okay
with her being like this, but I’m not okay with feeling like she doesn’t
care about me anymore. Any advice?
ODPO Summary Best friend of 5 years doesn’t reply to my texts anymore and always puts
her boyfriend over me. I feel like she doesn’t care about me anymore.
Any advice?
Judgment Summary B [ODPO] is preferred as it encapsulates all the necessary
details more concisely and accurately without any unnecessary repetition.
Table 6: An example of two summaries generated with greedy decoding, and its corresponding judgment from
GPT-4. Summaries are shown to the model in random order and are tagged with A or B. For clarity, we add the
method in brackets.
","[-0.015235141851007938, 0.02681702747941017, -0.011701012961566448, 0.05098676681518555, -0.013137166388332844, -0.010522969998419285, -0.00933830812573433, -0.03388528525829315, 0.04185362160205841, 0.007194004952907562, 0.013521023094654083, -0.04010641202330589, -0.053289905190467834, 0.003861731383949518, 0.008312484249472618, -0.024540359154343605, 0.01277978252619505, 0.012548144906759262, -0.011621594429016113, 0.03399117663502693, 0.022819621488451958, 0.029702570289373398, 0.04079470783472061, 0.017763301730155945, 0.022700494155287743, -0.004636063240468502, 0.03592369705438614, 0.04886893555521965, 0.045798081904649734, -0.030682068318128586, -0.0030294901225715876, -0.024169739335775375, 0.002344504464417696, -0.05432235077023506, 0.04788943752646446, -0.005986179690808058, 0.045083314180374146, 0.03229691460728645, 0.03923280909657478, -0.023216715082526207, 0.012177525088191032, 0.005542759317904711, 0.02109888568520546, -0.03282637149095535, -0.029543733224272728, 0.00900739710777998, 0.006545419339090586, 0.018266286700963974, 0.053184013813734055, 0.006264145020395517, -0.04333610460162163, 0.06099351495504379, 0.001780301216058433, 0.06787646561861038, -0.003274364396929741, -0.020397353917360306, 0.038570985198020935, -0.005863742902874947, 0.026128731667995453, 0.0013782442547380924, -0.011456138454377651, -0.007637425791472197, 0.008034518919885159, 0.05392525717616081, -0.003891513217240572, 0.0031899819150567055, -0.045665718615055084, -0.007511679548770189, -0.00721385981887579, -0.02033117227256298, 0.044924475252628326, 0.017736829817295074, 0.008947833441197872, 0.00530119426548481, 0.022223982959985733, 0.039153389632701874, 0.07301220297813416, -0.012700363993644714, 0.003947768360376358, -0.03526187688112259, 0.02017233520746231, 0.014017390087246895, -0.0043580979108810425, 0.02761121280491352, -0.016730859875679016, 0.010628861375153065, -0.05352816358208656, -0.04111238196492195, -0.006092071533203125, -0.06025227531790733, -0.005526213441044092, 0.026896445080637932, -0.04317726567387581, -0.04090059921145439, 0.0170088242739439, -0.060517001897096634, -0.00704178586602211, 0.015791073441505432, -0.002963308012112975, 0.02394471876323223, -0.00631047273054719, -0.02686997316777706, -0.04881599172949791, 0.026141969487071037, 0.011310538277029991, 0.0024007593747228384, -0.016810279339551926, 0.01753828302025795, -0.012991565279662609, 0.02059590071439743, -0.07534181326627731, 0.003570529632270336, -0.02463301457464695, 0.005711523815989494, -0.05564599484205246, -0.07327692955732346, -0.059458088129758835, 0.020370880141854286, 0.03536776825785637, -0.021138593554496765, -0.002382559236139059, -0.0039014406502246857, 0.016995588317513466, -0.014983650296926498, -0.013461459428071976, -0.03542071208357811, 0.0811658501625061, -0.012303270399570465, -0.025811057537794113, -0.038518041372299194, 0.005744615104049444, -0.005400467664003372, -0.044898003339767456, -0.010423696599900723, -0.08323073387145996, -0.02080768346786499, -0.014811576344072819, 0.022144563496112823, -0.04174773022532463, -0.009133143350481987, -0.025625746697187424, -0.04000052064657211, 0.05575188621878624, 0.007829354144632816, 0.007280041929334402, 0.03944459185004234, 0.013077602721750736, 0.02877601981163025, -0.04193304106593132, -0.019695822149515152, 0.016995588317513466, 0.031899821013212204, -0.030840905383229256, 0.011138464324176311, 0.03430885076522827, 0.010509733110666275, 0.013507787138223648, 0.02792888879776001, -0.004487153142690659, -0.009583182632923126, -0.03282637149095535, -0.0396563746035099, -0.02874954789876938, -0.0028938166797161102, -0.01843836158514023, 0.03557955101132393, 3.8675221730954945e-05, 0.05061614513397217, -0.02202543616294861, -0.03994757682085037, 0.009569945745170116, -0.0003052653919439763, -0.058399174362421036, 0.051277969032526016, 0.009192707017064095, 0.005274721421301365, 0.02901427634060383, -0.00018613743304740638, 0.006101998966187239, -0.022991696372628212, -0.02213132753968239, 0.05575188621878624, -0.024143265560269356, -0.03550013154745102, -0.010741370730102062, -0.013037892989814281, -0.0037558397743850946, 0.022316638380289078, 0.0142556456848979, 0.00044879803317599, 0.022422529757022858, -0.008087464608252048, 0.013190112076699734, -0.04211835190653801, -0.0055460683070123196, -0.05432235077023506, 0.06507033854722977, 0.021668052300810814, -0.027042046189308167, 0.016439657658338547, 0.031582146883010864, 0.008603685535490513, 0.00262412428855896, -0.021562160924077034, 0.005297885276377201, -0.03425590693950653, 0.005790942348539829, -0.005870360881090164, -0.037935636937618256, -0.03706203028559685, 0.03465300053358078, -0.060305219143629074, 0.0350765660405159, 0.022872567176818848, 0.03261458873748779, -0.06390552967786789, -0.02352115325629711, 0.011998833157122135, -0.02540072798728943, 0.02713470160961151, 0.04116532951593399, 0.044924475252628326, 0.0266581904143095, 0.018861927092075348, -0.032588113099336624, -0.009861147962510586, 0.06549390405416489, -0.0017025370616465807, -0.007174150552600622, -0.016016092151403427, 0.000198856825591065, 0.014017390087246895, 0.0023345770314335823, -0.03565897047519684, 0.03319698944687843, -0.029279004782438278, 0.0013186803553253412, -0.019139891490340233, 0.010873734951019287, 0.009576564654707909, 0.018716325983405113, -0.003204873064532876, 0.044686220586299896, -0.0033471647184342146, -0.044368546456098557, -0.038544513285160065, -0.010979627259075642, -0.0859309658408165, -0.05776382237672806, -0.007498443126678467, 0.029517261311411858, 0.03531482070684433, -0.0023246498312801123, -0.04021230340003967, -0.02808772586286068, -0.013335713185369968, 0.03489125519990921, -2.3965194486663677e-05, 0.038147419691085815, 0.013673242181539536, -0.05538126453757286, -0.009252271614968777, 0.03542071208357811, 0.024593304842710495, -0.024355050176382065, -0.0083058662712574, 0.020794447511434555, 0.007498443126678467, 0.025930184870958328, -0.023852065205574036, -0.02492421679198742, -0.04799533262848854, 0.031846873462200165, 0.04079470783472061, -0.018981054425239563, -0.06332312524318695, -0.02025175280869007, -0.010741370730102062, 0.04145652800798416, -0.03380586579442024, -0.03293226286768913, 0.007405788172036409, 0.038968078792095184, -0.019603166729211807, 0.023243188858032227, 0.009450818412005901, 0.014838049188256264, 0.051992736756801605, 0.022382820025086403, 0.031158579513430595, -0.03595016896724701, -0.04143005609512329, 0.037194397300481796, -0.038306258618831635, -0.006909421645104885, 0.006336945574730635, 0.0278494693338871, -0.012958474457263947, 0.016135219484567642, 0.0645938292145729, 0.012614327482879162, 0.015857255086302757, -0.01806773990392685, 0.020026734098792076, -0.008987542241811752, -0.020609136670827866, 0.013209966942667961, 0.0008951142663136125, 0.02386530116200447, -0.017736829817295074, -0.011184792034327984, -0.014838049188256264, -0.031370364129543304, 0.015460161492228508, -0.04865715280175209, -0.0003261541423853487, 0.06237010285258293, -0.010781080462038517, -0.023878537118434906, -0.031502727419137955, -0.03335582837462425, -0.0476776547729969, -0.009695691987872124, 0.007121204864233732, 0.007776408456265926, -0.04161536693572998, -0.016069037839770317, 0.013885024935007095, 0.0020549572072923183, 0.0070020765997469425, -0.05101323872804642, -0.05408409237861633, -0.003967622760683298, 0.06353490799665451, -0.005347521509975195, 0.031873345375061035, -0.05591072142124176, 0.04119180142879486, 0.031529199331998825, 0.03544718772172928, -0.030417338013648987, -0.0023842137306928635, -0.019232546910643578, 0.05029847100377083, -0.06904126703739166, 0.005062938202172518, -0.015301324427127838, 0.03330288082361221, -0.03510303795337677, -0.04733350872993469, -0.008087464608252048, 0.025202181190252304, 0.005999416578561068, -0.02803478017449379, 0.019404619932174683, 0.002748215803876519, 0.03362055867910385, 0.01387178897857666, 0.005906761158257723, 0.014295355416834354, -0.02362704463303089, -0.009947184473276138, -0.046354010701179504, 0.00884856004267931, -0.02861718274652958, 0.03626784682273865, -0.02336231619119644, -0.014811576344072819, 0.0007193177589215338, 0.008696340955793858, 0.00516221160069108, -0.0030145992059260607, -0.039418116211891174, 0.029729044064879417, -0.0409800186753273, 0.00441766157746315, 0.0066116019152104855, -0.00928536243736744, -0.045215677469968796, 0.00834557507187128, 0.013514405116438866, -0.01798832230269909, -0.037988580763339996, 0.002595996716991067, 0.05403114855289459, 0.019272256642580032, -0.04420970752835274, -0.018928108736872673, 0.004440825432538986, -0.023984428495168686, 0.013739424757659435, 0.01103919092565775, 0.011290683411061764, 0.016148457303643227, 0.0021360304672271013, -0.006323709152638912, 0.012038541957736015, 0.044924475252628326, 0.01719413511455059, -0.005499740596860647, 0.0546400249004364, -0.020185571163892746, -0.008484558202326298, 0.0029583442956209183, -0.011019336059689522, -0.010595770552754402, -0.014560083858668804, 0.006889566779136658, 0.026380224153399467, 0.01711471751332283, 0.03645315393805504, -0.01637347601354122, 0.026287568733096123, 0.03219102323055267, -0.02540072798728943, -0.04158889502286911, -0.03748559579253197, 0.05734025686979294, 0.010291332378983498, 0.02157539688050747, -0.0016959188506007195, -0.029781989753246307, 0.006648001726716757, -0.04039761424064636, 0.027042046189308167, 0.025864003226161003, 0.05405762046575546, -0.04378614202141762, -0.006773747969418764, -0.05066909268498421, -0.04050350561738014, 0.06226421147584915, 0.0020930119790136814, -0.04418323561549187, 0.04217129573225975, -0.029252532869577408, 0.016519077122211456, 0.03425590693950653, -0.06141708046197891, -0.07724786549806595, 0.052151571959257126, -0.0350765660405159, -0.030629122629761696, -0.02479185163974762, 0.009417726658284664, 0.029914354905486107, 0.007352842483669519, -0.03446768969297409, -0.010628861375153065, 0.025546329095959663, -0.0015188814140856266, -0.0026108878664672375, 0.0546400249004364, 0.01413651742041111, -0.039021026343107224, -0.02468596026301384, 0.0007122859242372215, -0.0017836103215813637, 0.02529483661055565, -0.06189359351992607, -0.008696340955793858, -0.0843425914645195, -0.012654036283493042, 0.009735401719808578, 0.005506359040737152, -0.06056994944810867, 0.030152609571814537, 0.03589722514152527, 0.018636906519532204, 0.021932780742645264, 0.019907604902982712, -0.00349442008882761, -0.029226059094071388, 0.014123281463980675, -0.017577992752194405, -0.009133143350481987, -0.012422398664057255, 0.05135738477110863, 0.003795549040660262, 0.0176706463098526, 0.009682456031441689, -0.04047703370451927, -0.021906308829784393, -0.005880288314074278, 0.008471321314573288, -0.004338243044912815, 0.05397820100188255, 0.002870652824640274, -0.018769271671772003, 0.038173891603946686, -0.002983162645250559, -0.031079160049557686, 0.02758474089205265, -0.014017390087246895, -0.016677914187312126, -0.008736050687730312, -0.044845059514045715, -0.009371398948132992, 0.009444199502468109, -0.05670490860939026, 0.015049831941723824, 0.038809239864349365, -0.01777653954923153, 0.017075007781386375, -0.00034497471642680466, -0.03301168233156204, 0.02205190807580948, -0.026115495711565018, -0.04153594747185707, -0.022303400561213493, 0.022832859307527542, -0.04002699255943298, -0.026049314066767693, -0.013203348964452744, -0.0024685959797352552, 0.022329874336719513, -0.012435635551810265, -0.01716766320168972, -0.031079160049557686, -0.009675837121903896, 0.019656112417578697, -0.0350765660405159, 0.04627459496259689, 0.009861147962510586, 0.011131846345961094, -0.02375940978527069, -0.015685182064771652, -0.022607838734984398, 0.019457567483186722, -0.01835894212126732, -0.0014378082705661654, -0.029914354905486107, -0.00032449958962388337, 0.011952505446970463, -0.013633533380925655, 0.01674409583210945, -0.012197379022836685, -0.04272722825407982, -0.000564616871997714, -0.01283272821456194, 0.020556190982460976, -0.038756296038627625, 0.02199896238744259, -0.0038087854627519846, 0.022568129003047943, -0.022965222597122192, 0.005794251337647438, 0.04945133998990059, -0.019139891490340233, -0.0089015057310462, 0.017154425382614136, -0.004798209294676781, -0.0007470315904356539, -0.015698418021202087, -0.024407995864748955, -0.04121827334165573, 0.02001349627971649, 0.002822670852765441, 0.0243682861328125, -0.018795745447278023, 0.018994290381669998, -0.007379315327852964, 0.04860420525074005, 0.022329874336719513, -0.031264472752809525, -0.008908123709261417, 0.014877757988870144, 0.026618480682373047, 0.04709525406360626, -0.022978460416197777, 0.030735014006495476, -0.0013269530609250069, -0.02011938765645027, -0.02808772586286068, 0.00411984184756875, 0.026247860863804817, -0.0018845380982384086, 0.015407215803861618, -0.0010349241783842444, -0.005062938202172518, -0.018901636824011803, -0.029517261311411858, -0.01262094546109438, 0.02162834256887436, -0.04029172286391258, 0.007101349998265505, 0.002864034613594413, -0.016572022810578346, -0.004341552034020424, 0.04047703370451927, 0.012581235729157925, -0.011052426882088184, -0.018319232389330864, -0.019841423258185387, -0.0038319493178278208, -0.015685182064771652, 0.0015354270581156015, -0.0064494553953409195, -0.012230470776557922, 0.01814715936779976, 0.012713600881397724, 0.015632236376404762, -0.07237685471773148, 0.02017233520746231, -0.02471243403851986, -0.006307163741439581, 0.03714144974946976, -0.02534778229892254, -0.005096029490232468, -2.49992917815689e-05, 0.0070550222881138325, 0.005509668029844761, 0.04119180142879486, -0.022541657090187073, -0.015936672687530518, 0.02729353867471218, -0.031635090708732605, 0.0007259359699673951, 0.010701661929488182, 0.02835245430469513, -0.003769076196476817, 0.0020400662906467915, 0.007445497438311577, 0.022806385532021523, 0.014943940564990044, -0.0007189041352830827, -0.01764417439699173, 0.04304490238428116, -0.003272709669545293, -0.0004901619395241141, -0.02790241502225399, -0.038094472140073776, 0.008094082586467266, -0.018808981403708458, 0.02458006888628006, -0.00208639376796782, 0.004626135807484388, 0.007141059264540672, 0.015791073441505432, -0.001785264816135168, -0.038941606879234314, -0.003984168171882629, 0.016810279339551926, -0.029331950470805168, 0.01753828302025795, -0.008431612513959408, -0.030205555260181427, 0.006039125844836235, -0.02389177307486534, -0.06623514741659164, -0.02439475804567337, -0.001968920463696122, 0.025586038827896118, 0.00878237746655941, -0.0014055444626137614, -0.003408383345231414, -0.02197249047458172, -0.0009091779356822371, -0.030417338013648987, -0.025334546342492104, -0.010503115132451057, -0.01283272821456194, 0.011158319190144539, -0.00546003133058548, 0.017127953469753265, -0.01086711697280407, 0.019947314634919167, -0.004874318838119507, 0.0361354798078537, 0.0042224242351949215, -0.045427460223436356, -0.0009629509877413511, 0.06088762357831001, -0.02210485376417637, 0.024540359154343605, 0.009530236944556236, 0.03573838621377945, -0.0551694817841053, 0.017419155687093735, -0.011456138454377651, -0.016545549035072327, -0.015645472332835197, -0.00726680550724268, -0.0033984559122473, -0.0035572932101786137, 0.003209836548194289, 0.0013914807932451367, -0.015354270115494728, 0.0033736375626176596, -0.00524824857711792, -0.03735323250293732, 0.013885024935007095, -0.00258110580034554, -0.01642642170190811, 0.05143680423498154, -0.005469958763569593, 0.032058656215667725, 0.0364002101123333, -0.017710356041789055, -0.036982614547014236, -0.009861147962510586, -0.011085518635809422, -0.03438827022910118, 0.05093381926417351, -0.045930445194244385, -0.037776798009872437, -0.024460941553115845, 0.029914354905486107, -0.004109914414584637, -0.037803273648023605, -0.03483831137418747, -0.007167532108724117, 0.01830599643290043, 0.021456269547343254, 0.012541526928544044, -0.01206501480191946, -0.005605632439255714, 0.0337529219686985, 0.02500363439321518, 6.225262768566608e-05, 0.0024719052016735077, 0.01812068559229374, -0.000521598441991955, -0.030973268672823906, -0.004341552034020424, -0.006641383748501539, -0.02191954478621483, 0.01092006266117096, -0.05628134310245514, -0.01183999516069889, -0.009536854922771454, 0.04010641202330589, -0.010410459712147713, 0.0013377077411860228, -0.008855178020894527, 0.017657410353422165, -0.032482221722602844, 0.013282767497003078, -0.04876304417848587, -0.016201402992010117, 0.02901427634060383, -0.029331950470805168, -0.02487127110362053, -0.053316380828619, -0.014705684967339039, 0.012429016642272472, -0.02708175592124462, 0.030126137658953667, 0.002910362323746085, 0.0088353231549263, -0.0076638986356556416, 0.012389307841658592, -0.032561641186475754, 0.005489813629537821, -0.02890838496387005, -0.012647418305277824, 0.03520892933011055, 0.0041959513910114765, 0.017419155687093735, -0.01719413511455059, -0.0010514697059988976, 0.009186089038848877, -0.013673242181539536, -0.032323386520147324, -0.03364703059196472, -0.018107449635863304, -0.038200363516807556, -0.00983467511832714, 0.03608253598213196, -0.0035506749991327524, 0.03536776825785637, -0.029649624601006508, -0.014745393767952919, 0.030179083347320557, 0.007928627543151379, -0.03592369705438614, -0.014811576344072819, -0.019364912062883377, 0.0015345996944233775, -0.022488711401820183, 0.02399766631424427, 0.014957177452743053, -0.03637373819947243, 0.015288088470697403, 0.005191993433982134, 0.029993772506713867, 0.012574617750942707, -0.00014849631406832486, 0.002821016125380993, -0.01250181719660759, 0.0060788351111114025, -0.013951207511126995, -0.016836751252412796, -0.02360057272017002, 0.0248977430164814, 0.021403323858976364, -0.032058656215667725, -0.10255593806505203, -0.0011962432181462646, 0.031423307955265045, -0.044659748673439026, -0.053184013813734055, -0.010754607617855072, -0.02391824685037136, 0.011171555146574974, -0.009894238784909248, 0.003193291136994958, 0.01703529804944992, -0.019735531881451607, -0.0082396836951375, -0.021959254518151283, -0.008259538561105728, 0.008034518919885159, -0.022726967930793762, 0.0020251753740012646, -0.010350896045565605, -0.02136361412703991, 0.001467590220272541, -0.01772359386086464, -0.011442902497947216, -0.024407995864748955, -0.017895666882395744, 0.03528834879398346, 0.000432666129199788, -0.012680509127676487, -0.029305478557944298, 0.04111238196492195, 0.00406689615920186, -0.007941863499581814, -0.008391902782022953, -0.004563262686133385, -0.011879704892635345, -0.016519077122211456, -0.00455664424225688, 0.022978460416197777, 0.02874954789876938, -0.0012615981977432966, 0.031555671244859695, 0.004315079189836979, 0.03412354364991188, -0.0273200124502182, 0.00704178586602211, -0.012435635551810265, 0.007591098081320524, -0.016704387962818146, 0.00020743983623106033, 0.014639502391219139, 0.00999351218342781, 0.022899040952324867, 0.0034050741232931614, -0.007703607901930809, 0.01769712008535862, 0.013051129877567291, -0.004698936361819506, 0.007835972122848034, 0.010734752751886845, -0.03687672317028046, 0.00089759606635198, -0.01043031457811594, 0.018756035715341568, 0.015341034159064293, 0.0001284348254557699, -0.02407708391547203, -0.00359038426540792, -0.007842591032385826, 0.01820010505616665, -0.002306449692696333, -0.02165481634438038, -0.014189463108778, -0.007114586420357227, 0.00017858852515928447, -0.038200363516807556, 0.03240280598402023, 0.04158889502286911, 0.005721451248973608, -0.010648716241121292, 0.01790890283882618, 0.03436179831624031, 0.0008376184850931168, 0.006518946494907141, 0.031026214361190796, 0.012978329323232174, 0.018703090026974678, -0.00018810221808962524, 0.001504817744717002, -0.009371398948132992, 0.013898261822760105, 0.039021026343107224, 0.02450064942240715, -0.038253311067819595, -0.015089541673660278, -0.060940567404031754, -0.00608545308932662, -0.019536985084414482, 6.142535130493343e-05, 0.013779133558273315, -0.012693746015429497, 0.03404412418603897, -0.0027349793817847967, -0.003467947244644165, 0.007617570925503969, -0.01442771963775158, -0.026618480682373047, 0.029331950470805168, -0.011873086914420128, 0.02386530116200447, -0.04383908957242966, -0.010999481193721294, -0.03385881334543228, 0.000292856217129156, 0.022462237626314163, -0.022846095263957977, 0.04285959154367447, 0.01642642170190811, -0.015989620238542557, 0.059299249202013016, -0.03610900789499283, -0.01737944595515728, 0.052839867770671844, 0.04357435926795006, -0.008749286644160748, -0.024355050176382065, 0.05048378184437752, 0.0024768689181655645, 0.03332935646176338, 0.004718790762126446, 0.04746587201952934, 0.008438230492174625, 0.038888659328222275, -0.007332987617701292, 0.003759148996323347, 0.05448118597269058, 0.0019507203251123428, -0.019497275352478027, 0.07078848034143448, -0.0005207711947150528, -0.0009182780049741268, 0.013951207511126995, -0.02792888879776001, 0.02710822969675064, 0.013686479069292545, -0.0027233974542468786, 0.014162990264594555, 0.03491772711277008, -0.014785103499889374, -0.030258500948548317, -0.029967300593852997, 0.007518297992646694, -0.012534908950328827, 0.04894835501909256, -0.007888917811214924, 0.05760498717427254, 0.03309109807014465, -0.011145082302391529, 0.001058915164321661, 0.007505061570554972, 0.01706177182495594, -0.005304503254592419, 0.037856217473745346, 0.018557488918304443, 0.002566214883700013, 0.06226421147584915, -0.032138075679540634, 0.008610304445028305, -0.0030129447113722563, -0.005691668950021267, -0.015314561314880848, -0.031026214361190796, 0.009543472900986671, 0.0002481832343619317, -0.00024032410874497145, 0.045083314180374146, 0.00906034279614687, -0.019206074997782707, 0.0036698030307888985, -0.04262133687734604, 0.026274332776665688, 0.05511653423309326, 0.02064884640276432, -0.01069504301995039, 0.03372645005583763, 0.030999742448329926, -0.009801583364605904, -0.038994550704956055, 0.006548728793859482, -0.0143218282610178, -0.00358045706525445, 0.059140413999557495, 0.008484558202326298, 0.04262133687734604, 0.00532104866579175, 0.01751180924475193, -0.006164871621876955, 0.00886179693043232, 0.021509215235710144, 0.0012160979676991701, -0.006270763464272022, 0.010390604846179485, 0.02521541714668274, 0.06702933460474014, -0.021588632836937904, 0.023454971611499786, 0.045877501368522644, 0.00011354383605066687, 0.005115883890539408, 0.002622469561174512, 0.04746587201952934, 0.006614910904318094, 0.04034467041492462, -0.046539321541786194, -0.01820010505616665, -0.025533093139529228, -0.014917467720806599, 0.0011689431266859174, 0.012958474457263947, 0.001602436532266438, 0.008961069397628307, 0.017895666882395744, -0.01409680861979723, -0.0361354798078537, -0.020476771518588066, -0.0053342850878834724, 0.003785621840506792, 0.004923955537378788, 0.000940614496357739, -0.0063402545638382435, 0.008312484249472618, -0.010900207795202732, 0.019431093707680702, 0.038888659328222275, -0.005797560792416334, -0.0031750909984111786, 0.0038451857399195433, 0.030549703165888786, -0.012323125265538692, 0.026141969487071037, 0.0060523622669279575, -0.02766415849328041, -0.02178717963397503, -0.025255126878619194, -0.022859331220388412, -0.030232029035687447, -0.005986179690808058, 0.03208513185381889, 0.02030469849705696, -0.022634312510490417, -0.007154295686632395, -0.004801518749445677, 0.0409800186753273, -0.0020185571629554033, 0.021668052300810814, 0.007518297992646694, -0.017525047063827515, -0.0271876472979784, 0.02819361723959446, 0.020238516852259636, -0.022171037271618843, -0.009066961705684662, 0.008193355984985828, -0.019762003794312477, -0.01256799977272749, -0.008008046075701714, 0.004090060014277697, 0.006624838337302208, -0.02869660221040249, -0.00902063399553299, -0.01830599643290043, -0.01092006266117096, 0.03565897047519684, -0.02080768346786499, 0.045189205557107925, 0.023428497835993767, -0.01740591786801815, -0.014864522032439709, -0.029226059094071388, 0.03523540124297142, -0.03727381303906441, 0.026102259755134583, 0.016307294368743896, -0.006436218973249197, 0.021270958706736565, 0.02202543616294861, -0.030549703165888786, -0.0049636648036539555, -0.004665845073759556, -0.0025711783673614264, 0.0034977293107658625, -0.0036532573867589235, 0.04000052064657211, 0.015923436731100082, 0.021535687148571014, -0.03417648747563362, -0.011866468004882336, -0.014824812300503254, 0.015460161492228508, -0.002145957900211215, 0.010575915686786175, -0.015857255086302757, -0.00013743147428613156, 0.0503249429166317, 0.0012458799174055457, 0.004156242124736309, -0.002859070897102356, -0.009239034727215767, -0.012058396823704243, -0.01074798870831728, -0.022290164604783058, 0.01806773990392685, -0.007730080746114254, 0.01711471751332283, 0.015949910506606102, -0.02402413822710514, 0.0032131457701325417, 0.03301168233156204, -0.019748767837882042, 0.004715481773018837, -0.00048147549387067556, 0.025625746697187424, -0.016227874904870987, 0.026314042508602142, 0.024513887241482735, 1.0075981663248967e-05, -0.02845834568142891, 0.038544513285160065, -0.004940500948578119, -0.02070179209113121, -0.025149235501885414, 0.003891513217240572, 0.014242409728467464, 0.031714510172605515, -0.003037762828171253, -0.0047220997512340546, -0.02041058987379074, -0.009967039339244366, 0.0286436565220356, -0.008716195821762085, -0.012038541957736015, 0.00841175764799118, -0.02761121280491352, 0.013229821808636189, 0.02761121280491352, -0.006548728793859482, 0.0067108748480677605, 0.02458006888628006, 0.031132105737924576, 0.0023792500142008066, 0.011019336059689522, 0.07370049506425858, -0.01441448274999857, -0.03584427759051323, 0.008669868111610413, -0.017948612570762634, 0.010807553306221962, -0.006591747049242258, 0.02205190807580948, -0.01703529804944992, 0.011396574787795544, 0.0066380747593939304, 0.012309889309108257, 0.03290579095482826, 0.015618998557329178, 0.001322816708125174, 0.023799119517207146, -0.005721451248973608, 0.009139761328697205, 0.02734648436307907, 0.007339606061577797, -0.02882896549999714, -0.023507917299866676, 0.04786296561360359, 0.0067969118244946, -0.03457358106970787, -0.00425882451236248, 0.025890477001667023, 0.0010415423894301057, 0.01086711697280407, 0.017895666882395744, 0.03486478328704834, -0.014017390087246895, 0.007849209010601044, -0.004318388644605875, 0.002457014052197337, 0.01015234924852848, 0.0012235434260219336, 0.016280820593237877, -0.02094004862010479, -0.02202543616294861, 0.0044507528655231, 0.010192058980464935, 0.0271876472979784, -0.00406689615920186, 0.03253516927361488, 0.03391175717115402, -0.02019880712032318, 0.013468077406287193, -0.00845146644860506, -0.020767973735928535, 0.046248119324445724, 0.011072281748056412, 0.000666372012346983, 0.0054633403196930885, -0.00045665717334486544, -0.002622469561174512, -0.03470594435930252, 0.0008628504001535475, 0.04039761424064636, 0.011403192766010761, -0.01961640454828739, 0.01753828302025795, -0.002122794045135379, 0.0017323190113529563, 0.005450103897601366, -0.029279004782438278, -0.0050463927909731865, 0.021482741460204124, -0.009933948516845703, 0.02473890595138073, -0.018425123766064644, -0.019457567483186722, -0.029940826818346977, 0.021297432482242584, -0.015049831941723824, 0.015446925535798073, -0.039471063762903214, -0.006532182916998863, -0.008841942064464092, 0.009450818412005901, 0.03978873789310455, -0.045639242976903915, -0.022912276908755302, 0.004976901225745678, -0.021006230264902115, -0.0032181094866245985, -0.022237218916416168, 0.04910719022154808, 0.026989100500941277, -0.0014005807461217046, 0.010092785581946373, 0.02338878996670246, -0.022382820025086403, -0.005274721421301365, 0.01403062604367733, -0.006088762544095516, 0.0033620556350797415, -0.013633533380925655, 0.018531015142798424, -0.005499740596860647, -0.009503764100372791, -0.0003166404494550079, -0.007035167887806892, -0.025983130559325218, 0.002000357024371624, 0.025930184870958328, 0.0006849857745692134, 0.016042565926909447, 0.026578770950436592, -0.04288606345653534, -0.005013301502913237, -0.02439475804567337, -0.00047237545368261635, 0.008153647184371948, -0.0059696342796087265, -0.002354431664571166, 0.06422320753335953, 0.007008695043623447, 0.012256943620741367, -0.019762003794312477, -0.017948612570762634, -0.0023411952424794436, 0.007849209010601044, -0.058399174362421036, 0.0021012849174439907, 0.029437841847538948, 0.012998184189200401, 0.052575137466192245, 0.011052426882088184, 0.012713600881397724, -0.02843187190592289, 0.020688556134700775, 0.00502322893589735, -0.010628861375153065, -0.007273423485457897, 0.01404386293143034, 0.009761874563992023, -0.012879055924713612, -0.0208871029317379, -0.0417742058634758, -0.04910719022154808, 0.00917947106063366, -0.009689074009656906, -0.0073726968839764595, 0.0028143979143351316, -0.026724372059106827, 0.02708175592124462, -0.02893485687673092, 0.019484039396047592, 0.038729824125766754, 0.015989620238542557, -0.00613839877769351, -0.01452037412673235, -0.025440437719225883, -0.01743239164352417, -0.018875163048505783, 0.015539580024778843, 0.018028030171990395, -0.015896964818239212, -0.006783675402402878, 0.011634830385446548, 0.0033521284349262714, 0.008279393427073956, -0.0076638986356556416, 0.018703090026974678, 0.011760576628148556, -0.0042753699235618114, -0.030073191970586777, -0.010562678799033165, 0.023878537118434906, -0.021403323858976364, 0.010489878244698048, -0.02750532142817974, 0.011542175896465778, -0.023044642060995102, -0.017048534005880356, -0.02534778229892254, -0.004096677992492914, -0.013315858319401741, 0.014123281463980675, -0.003570529632270336, -0.004778354894369841, -0.021244486793875694, -0.022978460416197777, -0.006614910904318094, 0.02739943005144596, 0.022978460416197777, -0.019179601222276688, 0.02115183137357235, -0.0010547788115218282, 0.006234363187104464, -0.010344278067350388, -0.011204645968973637, -0.023203479126095772, 0.013898261822760105, 0.004960355814546347, 0.016280820593237877, -0.05485180765390396, -0.02006644196808338, 0.03528834879398346, -0.011138464324176311, -0.03544718772172928, 0.019206074997782707, -0.026512589305639267, -0.003726057708263397, -0.02518894523382187, -0.02407708391547203, -0.006681093014776707, 0.037512071430683136, 0.013428368605673313, 0.031423307955265045, 0.018861927092075348, -0.004321697633713484, -0.010648716241121292, 0.019907604902982712, -0.0067406571470201015, -0.0009538509184494615, 0.045506879687309265, -0.005370685365051031, 0.0005211848183535039, -0.02888191118836403, -0.006601674482226372, -0.0035142747219651937, -0.045771609991788864, 0.026062550023198128, 0.03626784682273865, 0.00617149006575346, 0.005112574901431799, -0.006876330357044935, 0.004457371309399605, 0.038491565734148026, 0.014162990264594555, -0.03528834879398346, 0.016174929216504097, 0.01663820445537567, -0.010013367049396038, -0.02822008915245533, -0.022938750684261322, -0.00704178586602211, 0.016889696940779686, -0.010728134773671627, 0.03430885076522827, 0.005900143180042505, -0.0179353766143322, -0.008047755807638168, 0.03621489927172661, -0.03494420275092125, -0.01103919092565775, 0.0038683495949953794, 0.01453361101448536, 0.0039610047824680805, 0.014123281463980675, -0.02906722202897072, 0.0024321959353983402, 0.016121983528137207, 0.003262782469391823, -0.03714144974946976, -0.01735297217965126, 0.0006502401083707809, -0.0206223726272583, -0.02210485376417637, 0.01397768035531044, -0.004146314691752195, -0.016241110861301422, 0.022276928648352623, 0.012693746015429497, -0.016201402992010117, -0.03303815424442291, -0.009053724817931652, 0.019947314634919167, -0.02107241190969944, 0.0219460166990757, -0.00683000311255455, -0.004569880664348602, 0.02845834568142891, -0.009808202274143696, 0.03976226598024368, 0.030390866100788116, 0.01189294084906578, -0.015023359097540379, 0.012124578468501568, 0.014401246793568134, -0.04304490238428116, -0.0020549572072923183, 0.01371295191347599, 0.0100464578717947, -0.004186023958027363, -0.032058656215667725, 0.004861082416027784, 0.0053905402310192585, -0.005880288314074278, 0.0067108748480677605, -0.02766415849328041, 0.005026537925004959, 0.025043344125151634, 0.016545549035072327, -0.003001362783834338, -0.012680509127676487, -0.029226059094071388, -0.0056784325279295444, 0.026433169841766357, -0.04338904842734337, 0.013163639232516289, -0.025930184870958328, 0.0005360757932066917, 0.00106470612809062, 0.003914677072316408, 0.0037756944075226784, -0.013262912631034851, 0.005837270058691502, 0.03290579095482826, -0.02115183137357235, 0.006164871621876955, 0.027068519964814186, 0.0042753699235618114, 0.0027018883265554905, 0.008219828829169273, -0.008484558202326298, -0.008736050687730312, -0.01097300834953785, 0.00015015086682979017, 0.031079160049557686, 0.014957177452743053, -0.04878951609134674, 0.024910978972911835, 0.021350378170609474, 0.011456138454377651, 0.02041058987379074, 0.00858383160084486, 0.011171555146574974, 0.024010902270674706, 0.012793019413948059, 0.004401116166263819, -0.04039761424064636, 0.02766415849328041, 0.021429795771837234, 0.014282118529081345, 0.01740591786801815, -0.013084220699965954, 0.0066314563155174255, -0.022554893046617508, 0.003150272648781538, 0.015963146463036537, -0.017551518976688385, 0.011581884697079659, 0.029464315623044968, -3.868168732878985e-06, -0.01380560640245676, 0.00702193146571517, -0.020026734098792076, -0.004841228015720844, 0.009258889593183994, -0.00818673800677061, -0.04296548292040825, -0.03674435615539551, -0.02867012843489647, 0.03404412418603897, 0.024010902270674706, -0.024699196219444275, 0.014692448079586029, -0.02399766631424427, -0.005648650694638491, 0.022806385532021523, -0.019325202330946922, -0.00450369855388999, -0.030284974724054337, -0.010503115132451057, -0.03332935646176338, 0.0033951469231396914, 0.01189294084906578, -0.010172204114496708, 0.012098105624318123, -0.02769063226878643, -0.04068881645798683, -0.00048685280489735305, 0.0089015057310462, -0.009702309966087341, -0.031423307955265045, -0.0012806255836039782, -0.0074256425723433495, 0.01256799977272749, 0.022356346249580383, -0.02803478017449379, -0.005949779879301786, 0.029755515977740288, 0.003977550193667412, -0.02184012532234192, 0.06147002801299095, 0.016439657658338547]",Token-level Direct Preference Optimization.pdf
