text,embedding,file
"Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
Luca Beurer-Kellner1Marc Fischer1Martin Vechev1
Abstract
To ensure that text generated by large language
models (LLMs) is in an expected format, con-
strained decoding proposes to enforce strict for-
mal language constraints during generation. How-
ever, as we show in this work, not only do such
methods incur performance overhead during gen-
eration, but many of them also significantly impair
task accuracy, if they do not correctly align the
underlying LLM sub-word vocabularies with ex-
ternal constraints. To address this, we present a
novel decoding algorithm, DOMINO, that can en-
force constraints in a fully subword-aligned fash-
ion, while leveraging pre-computation and specu-
lative decoding to achieve virtually no overhead
and in some cases even almost 2 ×speedup over
unconstrained decoding – thereby outperforming
existing approaches by a wide margin.
1. Introduction
The recent success of Large Language Models (LLMs)
(Brown et al., 2020; Chen et al., 2021; OpenAI, 2023; Tou-
vron et al., 2023a;b; Anil et al., 2023; Jiang et al., 2024) has
lead to the development of various methods that facilitate
constrained generation, a method that lets users tailor the
output of an LLM to a specific task or format.
Constrained Decoding To ensure that text generated by
an LLM adheres to syntactic constraints, these methods
restrict the decoding procedure of an LLM in a way that
only permits syntactically valid tokens at each sampling step.
Doing so, the generated text can be ensured to adhere to
constraints like high-level templates (Beurer-Kellner et al.,
2023; Lundberg et al.), regular expressions (Beurer-Kellner
et al., 2023; Lundberg et al.; Willard & Louf, 2023) or
context-free grammars (Willard & Louf, 2023; Lundberg
et al.). Constrained decoding provides numerous upsides.
*Equal contribution1Department of Computer Science,
ETH Zurich, Switzerland. Correspondence to: Luca
Beurer-Kellner < luca.beurer-kellner@inf.ethz.ch>, Marc Fischer
<marc.fischer@inf.ethz.ch>.Prompt: A person encoded as JSON object:
Unconstrained Decoding:
{\\n↓
····""name"":·""John·Doe"",\\n
····""age"":·32,\\n
····""gender"":·""male"",. . .
Valid Tokens in Greedily Constrained JSON:
[·\\n\\t] (whitespace) ""(quote) }(closing brace)
Greedy Constraining induces sub-optimal tokenization:
{\\n↓
···\\t""name""\\t:\\t""John·Doe""\\n
\\t,\\t""age""\\t:\\t35\\n
\\t,\\t""·occupation ""\\t:\\t""Software . . .
Figure 1. Greedy (overly-invasive) constraining of LLMs can dis-
tort tokenization, leading to different output than with uncon-
strained decoding, even in the case where unconstrained generation
would produce valid output for the same prompt. Gray boxes rep-
resent vocabulary tokens, orange hue is proportional to perplexity.
For instance, it guarantees that generated output will always
adhere to the specified syntactic constraints, and reduces
the need for ad-hoc parsing, retrying and prompting on
top of LLMs. This facilitates the use of LLMs as part of
larger pipelines or very specific tasks, without the need for
fine-tuning or additional post-processing.
Key Challenge: Token Misalignment Since LLM sub-
word token do not align directly with most given syntactic
constraints, the key challenge in constrained decoding is to
interface the LLM vocabulary with a syntactic constraint
likeall output should be valid JSON . We showcase this in
Fig. 1: While in an unconstrained setting, the LLM picks
·""as the fourth token during generation, naively restricting
the LLM to only immediatly valid JSON grammar termi-
nals like just ""or·, leads to the less optimal choice of \\t
instead. By introducing such sub-optimal tokens, the distri-
bution of a badly-constrained LLM can easily diverge from
the unconstrained case, leading to a significant decrease in
reasoning performance and therefore downstream accuracy.
Here, the naively constrained LLM produces various high
perplexity tokens, indicating that the model likely would not
have","[0.021199507638812065, 0.034054674208164215, 0.029530305415391922, 0.01763690635561943, 0.0007170919561758637, 0.016499042510986328, 0.001279251417145133, -0.0002007561270147562, -0.027796415612101555, 0.050553712993860245, 0.018801864236593246, -0.0051576439291238785, -0.018856048583984375, 0.02519558183848858, -0.015334084630012512, -0.038551948964595795, 0.014561962336301804, -0.014521324075758457, -0.01901859976351261, 0.0485759973526001, 0.03475906699895859, 0.0005456502549350262, 0.028040243312716484, 0.028853004798293114, -0.009380612522363663, 0.011283827014267445, 0.02629280835390091, 0.054807163774967194, 0.051176831126213074, -0.05033697932958603, 0.021687164902687073, -0.03884996101260185, -0.024355728179216385, -0.02562905289232731, 0.025791605934500694, 0.0580311119556427, 0.027186844497919083, 0.015117349103093147, -0.00991568062454462, -0.012997398152947426, -0.016661593690514565, -0.05889805778861046, -0.028040243312716484, -0.029990868642926216, 0.023922255262732506, 0.06718821823596954, 0.011649569496512413, 0.01788073591887951, -0.0039452756755054, 0.024870477616786957, -0.05377766489982605, 0.04004200920462608, 0.03083072230219841, -0.011392195709049702, -0.07081855088472366, -0.041992634534835815, -0.009732808917760849, 0.021294329315423965, 0.02619798667728901, -0.015076710842549801, 0.025060120970010757, -0.05101427808403969, 0.006532563827931881, 0.05431950464844704, -0.011060317978262901, -0.007816048339009285, -0.019655263051390648, -0.009949545376002789, 0.015713373199105263, 0.0167293231934309, -0.003484711516648531, 0.01307190116494894, 0.04659827798604965, -0.015036072582006454, -0.039364710450172424, 4.616755632014247e-06, 0.024680832400918007, 0.05431950464844704, 0.007436760235577822, -0.02408480830490589, 0.02782350778579712, -0.02686174027621746, 0.00020636501722037792, -0.036980610340833664, 0.0078905513510108, 0.00158065021969378, -0.00345253967680037, 0.031047457829117775, -0.02207999862730503, -0.05120392143726349, -0.02504657581448555, -0.016187483444809914, -0.04808834195137024, 0.008818453177809715, -0.003107116324827075, 0.012563925236463547, -0.0030715579632669687, -0.02519558183848858, 0.07022251933813095, 0.021009864285588264, 0.00742321414873004, -0.023163679987192154, 0.05532190948724747, -0.040746401995420456, 0.055376093834638596, -0.004063803236931562, -0.032239507883787155, -0.034163039177656174, -0.0020302084740251303, -0.020251287147402763, -0.016986697912216187, -0.005208441521972418, -0.03102036565542221, -0.0019269201438874006, 0.0412069670855999, -0.08333506435155869, -0.0642622783780098, 0.02725457400083542, -0.005442109890282154, -0.03876868635416031, -0.024071261286735535, -0.017772367224097252, 0.018138108775019646, -0.001964171649888158, -0.005486134439706802, 0.006969423033297062, 0.019804269075393677, -0.0398794561624527, 0.021443335339426994, -0.034921616315841675, 0.004869791213423014, 0.03622203320264816, 0.01676996238529682, -0.025723876431584358, -0.07065599411725998, 0.01111450232565403, -0.059927552938461304, -0.00627180328592658, -0.013871115632355213, 0.017338894307613373, -0.01290934905409813, -0.02380034141242504, 0.006854281760752201, 0.0019489324185997248, -0.020440930500626564, 0.008574625477194786, -0.008215655572712421, 0.02079312689602375, -0.06670056283473969, 0.05797692760825157, 0.00031854293774813414, -0.0353550910949707, -0.06139052286744118, 0.040177468210458755, -0.010294968262314796, -0.05282944440841675, -0.025656145066022873, 0.022825028747320175, 0.04527077078819275, -0.01668868586421013, 0.03733280673623085, 0.04508112743496895, 0.03752245008945465, 0.0010633618803694844, 0.04313049837946892, 0.035300906747579575, 0.014277496375143528, 0.04947003349661827, -0.051610302180051804, -0.021714257076382637, -0.008594944141805172, -0.04226355627179146, -0.0497138611972332, -0.028880096971988678, -0.01333604846149683, -0.013573103584349155, -0.021863263100385666, -0.022201912477612495, 0.013525692746043205, -0.03876868635416031, -0.023123040795326233, 0.05239597335457802, -0.02672628127038479, 0.007192932069301605, -0.03562600910663605, -0.009637987241148949, -0.02858208306133747, -0.00046479751472361386, 0.016634501516819, 0.01740662381052971, -0.04491857439279556, 0.0344068706035614, 0.09644760191440582, 0.029990868642926216, 0.041748806834220886, -0.01576755754649639, 0.09352166205644608, 0.02094213292002678, 0.003401742083951831, -7.54555148887448e-05, 0.024924660101532936, 0.01960107870399952, 0.005706257186830044, -0.07228151708841324, 0.026970108970999718, 0.026225078850984573, -0.020915040746331215, 0.017040882259607315, 0.022838575765490532, -0.014467139728367329, 0.01888314075767994, 0.004226355347782373, 0.03847067058086395, -0.006718821823596954, 0.003738699248060584, -0.018625766038894653, -0.0037590181455016136, 0.01302449032664299, -0.005939926020801067, 0.013322502374649048, -0.012733250856399536, 0.03370247781276703, 0.029286475852131844, 0.008235975168645382, -0.03906669840216637, -0.018232930451631546, -0.02500593662261963, -0.018856048583984375, 0.051556117832660675, -0.001862576580606401, 0.04779032990336418, -0.015835287049412727, -0.005452269688248634, -0.0321311391890049, 0.0017880734521895647, -0.03652004525065422, -0.019194697961211205, -0.010308514349162579, 0.0027176684234291315, 0.00016329293430317193, 0.007192932069301605, -0.020413838326931, 0.03294390067458153, -0.03738699108362198, -0.03196858614683151, 0.04185717552900314, -0.056947432458400726, -0.02237801067531109, 0.028229888528585434, 0.02806733548641205, 0.023434599861502647, 0.0029174722731113434, -0.03359410911798477, -0.006265030242502689, -0.05759764090180397, 0.02236446551978588, -0.031182918697595596, 0.023827433586120605, 0.021497519686818123, 0.01274002343416214, -0.009644759818911552, 0.019397888332605362, -0.023353323340415955, 0.031155826523900032, -0.01710861176252365, 0.0004495582543313503, -0.01960107870399952, 0.02423381432890892, -0.00153916550334543, 0.0027803187258541584, -0.019397888332605362, -0.04302213340997696, -0.003437300445511937, 0.012374280951917171, -0.04394325986504555, -0.04922620579600334, 0.05315454676747322, 0.03413594886660576, -0.02156524918973446, 0.04359106346964836, -0.031101642176508904, -0.007037153001874685, 0.025168489664793015, 0.016932513564825058, -0.012218502350151539, 0.021199507638812065, -0.021091138944029808, -0.03963562846183777, -0.029340660199522972, -0.00805310346186161, 0.0007348711369559169, 0.008703311905264854, 0.04172171652317047, 0.0174879003316164, 0.0017228833166882396, 0.019763629883527756, 0.030099237337708473, -0.014751606620848179, -0.006048294249922037, 0.024531826376914978, 0.048874009400606155, 0.04540622979402542, 0.00347793847322464, -0.026035433635115623, -0.04979513958096504, 0.02428799867630005, -0.006136343348771334, -0.032672978937625885, 0.015496636740863323, 0.011974673718214035, 0.012922895140945911, 0.03562600910663605, -0.02084731124341488, 0.014900612644851208, -0.01792137324810028, -0.05106846243143082, 0.053615111857652664, -0.05152902752161026, 0.02075248956680298, -0.015577913261950016, -0.03570728749036789, 0.005577570293098688, -0.008730404078960419, -0.044376734644174576, 0.006342920009046793, 0.01873413287103176, -0.01882895641028881, 0.03419013321399689, 0.0013368220534175634, -0.0255206860601902, -0.0005498834070749581, 0.02839243970811367, 0.026401177048683167, 0.03221241384744644, -0.01759626902639866, -0.07043925672769547, -0.038985420018434525, 0.037983015179634094, 0.06859700381755829, 0.02533104084432125, -0.052937813103199005, 0.02232382632791996, 0.02438282035291195, -0.0013613741612061858, -0.009333201684057713, -0.01553727500140667, -0.01259779091924429, 0.02969285659492016, 0.057435087859630585, 0.024152537807822227, -0.01326831802725792, -0.021741347387433052, 0.0014519630931317806, 0.00018276533228345215, 0.002548343501985073, 0.03375666216015816, 0.015794649720191956, -0.014819336123764515, -0.005096687003970146, -0.0006603680667467415, 0.005282944533973932, 0.022350918501615524, -0.004551460035145283, 0.06832607835531235, -0.018720587715506554, -0.01015950832515955, -0.02710556797683239, 0.031914401799440384, 0.03121001087129116, -0.05166448652744293, 0.014941250905394554, -0.00989536102861166, -0.004084122367203236, 0.02132142148911953, -0.010030820965766907, 0.01122964359819889, 0.009759901091456413, 0.02982831746339798, 0.024396367371082306, 0.031237103044986725, 0.00652579078450799, -0.030370157212018967, 0.006176981143653393, -0.00805310346186161, -0.008561079390347004, 0.04413290321826935, -0.022743752226233482, -0.026712734252214432, -0.03565310314297676, 0.002551729790866375, 0.004829152952879667, 0.024884022772312164, -0.003857226809486747, 0.03294390067458153, 0.029530305415391922, 0.005851876921951771, -0.0017313496209681034, 0.02203936129808426, 0.04288667067885399, 0.03432559221982956, 0.04432255029678345, -0.0058146254159510136, -0.026699189096689224, -0.018341299146413803, -0.01782655157148838, 0.009773447178304195, 0.01850385218858719, 0.035544734448194504, 0.01754208467900753, 0.008459484204649925, 0.014440048485994339, 0.016648048534989357, 0.011175459250807762, -0.03259170427918434, 0.02245928719639778, -0.016661593690514565, 0.050066057592630386, 0.005750281736254692, 0.023272046819329262, 0.042480289936065674, 0.0017880734521895647, -0.014114944264292717, -0.008026011288166046, -0.0572725348174572, -0.02232382632791996, 0.022730207070708275, 0.012516514398157597, -0.045622967183589935, 0.016702232882380486, -0.04093604534864426, 0.007260662037879229, 0.010200146585702896, 0.03039724938571453, -0.06773005425930023, -0.015036072582006454, 0.00843916554003954, 0.002597447717562318, 0.02184971608221531, 0.00931965559720993, -0.07927125692367554, 0.022743752226233482, -0.003022453747689724, -0.02189035527408123, 0.003222257364541292, -0.03221241384744644, 0.03196858614683151, -0.02207999862730503, 0.011927262879908085, 0.008506895042955875, 0.011581839993596077, -0.019181152805685997, -0.05106846243143082, 0.050066057592630386, -0.002612686948850751, 0.004270379897207022, -0.022445740178227425, 0.08198045939207077, -0.04982222989201546, 0.019370796158909798, -0.0037759507540613413, 0.01920824497938156, -0.00500525115057826, -0.03909378871321678, -0.03158929944038391, -0.013573103584349155, 0.03226659819483757, -0.016322944313287735, 0.019953275099396706, 0.0062853493727743626, 0.04085477069020271, -0.0003784417058341205, 0.00862880889326334, 0.0054658157750964165, 0.014358771964907646, -0.026306353509426117, 0.027593225240707397, 0.04207391291856766, -0.05524063482880592, 0.0016670060576871037, -0.013159950263798237, 0.01706797443330288, 0.0067493002861738205, 0.04145079478621483, -0.0038504537660628557, -0.01998036727309227, 0.066538006067276, 0.005983950570225716, 0.01391175389289856, -0.005567410495132208, -0.005347288213670254, 0.0023773249704390764, -0.04917202144861221, 0.019479164853692055, -0.015103803016245365, -0.014263950288295746, -0.010173054412007332, -0.008831999264657497, -0.029313568025827408, 0.007369030267000198, -0.028609175235033035, 0.02667209692299366, -0.009922453202307224, -0.020955679938197136, 0.026997201144695282, 0.011669889092445374, 0.014765152707695961, 0.06095705181360245, -0.01448068581521511, -0.008953913114964962, 0.01357987616211176, 0.0015518649015575647, 0.005543705075979233, 0.018558034673333168, 0.014832882210612297, -0.04540622979402542, 0.01983136124908924, -0.032483335584402084, 0.006017815321683884, -0.00559111637994647, 0.03603238984942436, 0.02237801067531109, -0.045297861099243164, -0.005899287760257721, 0.016268759965896606, -0.0030732513405382633, 0.016471950337290764, -0.03302517533302307, -0.07591184973716736, -0.02581869810819626, 0.009543164633214474, 0.03462360426783562, -0.012272686697542667, 0.016322944313287735, 0.04816961660981178, -0.05770600959658623, -0.02576451376080513, -0.01538826897740364, -0.022676022723317146, -0.029557397589087486, -0.013146404176950455, -0.0040705762803554535, 0.019181152805685997, 0.010863901115953922, 0.02969285659492016, -0.002316368045285344, -0.0030969567596912384, 0.0077076805755496025, -0.02147042751312256, -0.006024588365107775, 0.04210100322961807, 0.01701379008591175, -0.04453928396105766, 0.019059237092733383, -0.03928343206644058, -0.03172475844621658, 0.015754010528326035, 0.03294390067458153, -0.030126329511404037, -0.01544245332479477, -0.007992146536707878, 0.0025754354428499937, 0.014426502399146557, -0.022283188998699188, 0.013735655695199966, -0.030749445781111717, -0.01147347129881382, -0.017338894307613373, 0.020481569692492485, -0.003874159185215831, 0.05001187324523926, -0.018178747966885567, -0.018192293122410774, 0.04556878283619881, 0.014358771964907646, -0.0014172514202073216, -0.02419317699968815, 0.018151655793190002, 0.014196219854056835, 0.032483335584402084, 0.014900612644851208, -0.021213054656982422, -0.021632980555295944, -0.0006595214363187551, -0.030045052990317345, -0.06263675540685654, -0.005140711087733507, 0.006336146965622902, -0.020617028698325157, -0.03313354402780533, -0.016038477420806885, 0.05797692760825157, 0.011568293906748295, -0.027268121019005775, 0.01400657556951046, -0.07650787383317947, 0.01247587613761425, 0.005431950557976961, -0.017650453373789787, -0.037685003131628036, 0.0020979384426027536, 0.03608657419681549, -0.00879813451319933, -0.036980610340833664, -0.01682414673268795, -0.003205324988812208, 0.01175793819129467, -0.013187042437493801, 0.021009864285588264, 0.029611580073833466, -0.013661152683198452, -0.03633040189743042, 0.026089617982506752, 0.014643237926065922, -0.04556878283619881, -0.04077349603176117, 0.036682598292827606, -0.02035965584218502, -0.025656145066022873, 0.0427241213619709, -0.01697315275669098, 0.016607409343123436, -0.01869349554181099, -0.01400657556951046, 0.004981545731425285, 0.0249517522752285, -0.009035189636051655, -0.01173761859536171, -0.027498403564095497, -0.015699828043580055, -0.02294694259762764, -0.048928193747997284, -0.03278134763240814, 0.026794010773301125, -0.013979483395814896, 0.00621423264965415, 0.015957200899720192, -0.0003111349360551685, 0.0039080241695046425, -0.00276677287183702, -0.007186159025877714, 0.0036879016552120447, 0.017081519588828087, 0.0015103803016245365, -0.02839243970811367, 0.007294527254998684, -0.0038301346357911825, 0.00014720704348292202, -0.019438525661826134, 0.000499932502862066, 0.004724171478301287, -0.017325349152088165, 0.0005278711323626339, 0.050445348024368286, 0.012347189709544182, 0.017569176852703094, 0.005140711087733507, 0.012685840018093586, -0.014114944264292717, 0.01202208548784256, 0.022025814279913902, -0.045297861099243164, -0.012157545424997807, -0.03584274649620056, 0.005083140917122364, 0.0005206748028285801, 0.023312686011195183, 0.006976196076720953, 0.026035433635115623, -0.03608657419681549, -0.0031494477298110723, 0.0017144170124083757, 0.03703479468822479, 0.03337737172842026, -0.024152537807822227, -0.006403876934200525, 0.018571581691503525, -0.015022526495158672, -0.04879273474216461, -0.0037928831297904253, -0.008371435105800629, -0.04651700332760811, 0.006678183563053608, -0.02289276011288166, -0.047681961208581924, 0.005834944546222687, 0.014656784012913704, 0.056188855320215225, 0.002597447717562318, 0.006830576341599226, 0.029855409637093544, 0.012841618619859219, -0.0031325151212513447, 0.012340416200459003, -0.02166007272899151, 0.028690451756119728, 0.001363913994282484, -0.025832243263721466, 0.05096009373664856, -0.009658305905759335, -0.04058384895324707, -0.0017355827149003744, 0.011575066484510899, -0.014467139728367329, -0.03001796081662178, -0.025222674012184143, -0.027308758348226547, -0.020630575716495514, 0.006146502681076527, 0.048548903316259384, 0.014412956312298775, 0.02944902889430523, 0.013098993338644505, 2.5292943973909132e-05, 0.003718380117788911, -0.006129570305347443, -0.003762404667213559, 0.041234057396650314, -0.009035189636051655, 0.018341299146413803, -0.03437977656722069, -0.03790174052119255, 0.0034559261985123158, -0.030099237337708473, -0.01089776586741209, -0.011073864065110683, -0.014291041530668736, 0.0208879504352808, 0.041044414043426514, -0.009414478205144405, 0.009685398079454899, 0.01448068581521511, 0.032916806638240814, 0.04185717552900314, -0.02251347154378891, -0.03259170427918434, 0.021592341363430023, -0.021876808255910873, 0.008100515231490135, -0.01448068581521511, -0.012326870113611221, 0.013735655695199966, -0.015334084630012512, -0.04808834195137024, 0.019343703985214233, 0.02054929919540882, -0.0055166129022836685, 0.00595008535310626, 0.025588415563106537, 0.013275091536343098, 0.007971827872097492, -0.041802991181612015, 0.012421692721545696, -0.033241912722587585, 0.013126084581017494, 0.009509299881756306, 0.005692711099982262, 0.018151655793190002, 0.020711852237582207, 0.0015628710389137268, -0.02289276011288166, -0.0028412758838385344, 0.026807555928826332, -0.02686174027621746, -3.5425993701210245e-05, -0.001986183924600482, 0.014020121656358242, -0.03901251405477524, -0.0410173237323761, 0.027092022821307182, -0.0030884905718266964, 0.010301741771399975, -0.013884661719202995, 0.03356701508164406, 0.017040882259607315, 0.011033225804567337, -0.01500898040831089, -0.002209693193435669, 0.00284466240555048, 0.0016229815082624555, 0.019289519637823105, -0.011676661670207977, 0.006024588365107775, -0.010823262855410576, -0.01178502943366766, -0.002521251328289509, -0.020711852237582207, -0.030234698206186295, 0.01144638005644083, -0.002942871069535613, -0.035544734448194504, -0.022594746202230453, 0.013884661719202995, -0.0031240489333868027, 0.012963532470166683, -0.011073864065110683, 0.04388907551765442, -0.009726036339998245, -0.14738060534000397, -0.01311931200325489, 0.021402698010206223, 0.020901495590806007, 0.003924957010895014, -0.02338041551411152, 0.03039724938571453, 0.030505618080496788, -0.014805790036916733, -0.014765152707695961, -0.031616389751434326, -0.013139630667865276, -0.0043855211697518826, 0.007023606915026903, 0.0040434845723211765, -0.027877692133188248, -0.0077076805755496025, -0.03481324762105942, 0.011934036388993263, -0.003887705272063613, 0.014819336123764515, -0.03131837770342827, -0.0022926623933017254, -0.00452775415033102, 0.005570797249674797, -0.0344068706035614, 0.005232146941125393, 0.020915040746331215, -0.021497519686818123, 0.019248882308602333, 0.011825667694211006, -0.010098551400005817, -0.0017254231497645378, 0.02241864800453186, -0.013085447251796722, -0.046300265938043594, 0.0022977422922849655, -0.05440078303217888, -0.02438282035291195, -0.0030834109056741, 0.02113177813589573, -0.052125051617622375, 0.011371876113116741, -0.0078905513510108, -0.0004436318704392761, 0.006139729637652636, 0.021213054656982422, -0.010125643573701382, -0.01560500543564558, -0.021673617884516716, -0.03833521157503128, 5.214685370447114e-05, 0.031914401799440384, -0.015523728914558887, -0.02591351978480816, 0.00884554535150528, 0.002853128593415022, 0.02179553173482418, -0.004852858372032642, 0.017894281074404716, -0.0034068217501044273, -0.012753569521009922, 0.004131533671170473, -0.013925299979746342, -0.012523287907242775, -0.03275425359606743, -0.0008026011637412012, 0.009976637549698353, -0.02094213292002678, -0.02748485654592514, -0.0033915825188159943, -0.00836466159671545, 0.0022452513221651316, 0.06122796982526779, -0.0020302084740251303, 0.008926821872591972, 0.0336482934653759, 0.060306843370199203, -0.029801225289702415, 0.016648048534989357, 0.06821770966053009, -0.0167293231934309, 0.018707042559981346, 0.008032784797251225, 0.04245319962501526, 0.03700770437717438, 0.01563209667801857, 0.02075248956680298, -0.046679556369781494, 0.04478311538696289, 0.05857295170426369, 0.00047241715947166085, 0.0033187728840857744, -0.008324024267494678, 0.0016509201377630234, -0.022906305268406868, 0.014805790036916733, 0.0019726378377527, 0.015903016552329063, -0.007192932069301605, 0.024640195071697235, 0.031426746398210526, -0.048115432262420654, -0.051610302180051804, 0.0028615950141102076, 0.024965299293398857, -0.01185275986790657, -0.009637987241148949, 0.0002658404700923711, 0.014060759916901588, 0.015036072582006454, 0.007030379958450794, -0.016092661768198013, 0.034488145262002945, -0.00169748452026397, 0.023502329364418983, 0.05190831422805786, 0.02122659981250763, 0.03884996101260185, 0.024206722155213356, -0.009001324884593487, 0.0021301102824509144, -0.02686174027621746, -0.0009363680146634579, -0.026225078850984573, -0.010843582451343536, 0.01888314075767994, 0.019858453422784805, -0.011073864065110683, -0.030966181308031082, -0.019397888332605362, 0.014616146683692932, -0.00647837994620204, -0.012042404152452946, 0.007043926045298576, -0.012929667718708515, -0.014887066558003426, 0.05429241433739662, -0.01759626902639866, 0.04470183700323105, 0.014209765940904617, -0.008330796845257282, 0.03895832970738411, -0.0028920734766870737, -0.014805790036916733, 0.010416883043944836, 0.015415361151099205, -0.022391557693481445, -0.043374329805374146, 0.027552587911486626, 0.036249127238988876, 0.0007382576004602015, -0.02217482030391693, -0.006806870922446251, 0.02542586252093315, 0.010640392079949379, -0.0012970305979251862, -0.03196858614683151, 0.014453594572842121, 0.0066138398833572865, 0.002790478290989995, 0.015510182827711105, -0.02610316313803196, -0.031480930745601654, 0.014954796992242336, -0.0064411284402012825, -0.010105324909090996, -0.0123336436226964, -0.027308758348226547, -0.0077009075321257114, -0.027064930647611618, -0.07629113644361496, 0.016851238906383514, -0.01878831721842289, 0.02600834146142006, 0.02489756979048252, 0.010823262855410576, 0.014236858114600182, 0.02245928719639778, 0.03860613331198692, 0.0034254477359354496, 0.011134820990264416, -0.030099237337708473, 0.013830477371811867, 0.010592981241643429, -0.023583605885505676, -0.010979042388498783, -0.0016179017256945372, -0.0019506256794556975, 0.029611580073833466, 0.01820584014058113, 0.0631244108080864, 0.018517397344112396, 0.00695587694644928, 0.014751606620848179, -0.02346169203519821, 0.035924021154642105, 0.03744117543101311, 0.01362728700041771, -0.028419531881809235, -0.07699552923440933, 0.03489452600479126, 0.006861054804176092, -0.0058247847482562065, 0.018381938338279724, 0.0202241949737072, 0.03007214516401291, -0.009841177612543106, -0.02002100460231304, 0.043618157505989075, -0.0020522207487374544, -0.011216097511351109, -0.04134242609143257, 0.01816520094871521, 0.008425619453191757, 0.00086948461830616, 0.015374722890555859, -0.008418845944106579, -0.0026448587886989117, -0.0319414958357811, -0.04015037789940834, 0.0033780366647988558, -0.0072200242429971695, -0.01920824497938156, -0.009421250782907009, 0.008479802869260311, 0.033296097069978714, 0.02510075829923153, -0.011128048412501812, 0.0005143251037225127, -0.0007966748089529574, 0.010958722792565823, 0.018612219020724297, -0.003423754358664155, -0.005885742139071226, -0.00848657637834549, 0.010118870064616203, -0.005882355384528637, -0.0027549201622605324, 0.028473716229200363, 0.04483729600906372, -0.02317722514271736, 0.005895901471376419, -0.02748485654592514, -0.03990655019879341, -0.035978205502033234, 0.00276677287183702, 0.027660954743623734, -0.01111450232565403, 0.024111900478601456, -0.009123238734900951, 0.03903960436582565, 0.019763629883527756, -0.00029991715564392507, 0.010796170681715012, 0.020522207021713257, 0.01811101660132408, 0.0487656407058239, 0.048874009400606155, 0.036303311586380005, -0.01106709148734808, 0.04632735997438431, 0.008147926069796085, -0.019059237092733383, -0.007788956630975008, 0.0010032514110207558, -0.04012328386306763, -0.004097668454051018, 0.031237103044986725, -0.015523728914558887, -0.007152293808758259, 0.0020132758654654026, 0.012293005362153053, 0.01244878489524126, 0.012557152658700943, -0.01362728700041771, 0.002665177686139941, -0.032483335584402084, 0.017122158780694008, -0.003090183949097991, -0.04760068282485008, -0.02308240346610546, 0.011778256855905056, 0.002409496810287237, 0.018747679889202118, -0.016648048534989357, -0.004619190003722906, -0.00474449060857296, 0.017433715984225273, -0.01221172884106636, 0.029042648151516914, 0.01491415873169899, 0.00817501824349165, 0.0003128281969111413, -0.009665079414844513, -0.018138108775019646, 0.007518036291003227, -0.01022723875939846, 0.020901495590806007, -0.012340416200459003, -0.0048325397074222565, 0.01901859976351261, 0.02054929919540882, -0.025466501712799072, -0.012272686697542667, 0.0030004414729774, -0.01954689435660839, -0.038551948964595795, -0.03608657419681549, -0.012062722817063332, -0.006661251187324524, 0.027037838473916054, 0.020860858261585236, -0.01326831802725792, 0.0024078034330159426, -0.01202208548784256, -0.025371680036187172, -0.012489422224462032, 0.019275974482297897, -0.02753904089331627, -0.001589116407558322, -0.010030820965766907, 0.02977413311600685, -0.019709447398781776, -0.017230525612831116, 0.013112539425492287, -0.007524809334427118, -0.00013588342699222267, 0.011358330957591534, 0.01859867386519909, 0.014832882210612297, -0.0007547668064944446, 0.019668808206915855, -0.0038504537660628557, -0.01085035502910614, -0.021822623908519745, -0.004917202051728964, 0.0010057913605123758, -0.010030820965766907, -0.03576147183775902, 0.03484034165740013, 0.03744117543101311, -0.00236716540530324, 0.016742870211601257, -0.008608490228652954, 0.05808529630303383, 0.007125202100723982, 0.006600294262170792, 0.00843916554003954, -0.02686174027621746, 0.08219719678163528, -0.03283553197979927, -0.02896137163043022, -0.0011768097756430507, 0.01821938529610634, 0.013606968335807323, 0.0028920734766870737, -0.02064412087202072, 0.010125643573701382, 0.015984293073415756, -0.0009118159068748355, 0.016092661768198013, 0.00284466240555048, -0.007016833871603012, 0.022825028747320175, -0.036926425993442535, -0.005506453569978476, 0.030424341559410095, 0.0007018527248874307, 0.026590820401906967, 0.02604898065328598, 0.029476121068000793, -0.008215655572712421, -0.02160588838160038, 0.0018761225510388613, 0.005858649965375662, 0.00910969264805317, 0.011866305954754353, 0.0045582326129078865, 0.016052022576332092, -0.000519404886290431, -0.005547091830521822, -0.06469575315713882, 0.007138748187571764, -0.027742231264710426, 0.009353521279990673, -0.011656343005597591, 0.02213418297469616, -0.043807800859212875, -0.017582722008228302, 0.011216097511351109, -0.008831999264657497, -0.01469742227345705, 0.008195336908102036, 0.004724171478301287, 0.013417324051260948, 0.0042060366831719875, -0.018774772062897682, 0.016241667792201042, -0.013871115632355213, 0.012726477347314358, -0.021863263100385666, 0.036167848855257034, -0.02508721314370632, -0.001376613392494619, -0.05296490341424942, -0.007335165049880743, 0.029990868642926216, 0.013776293955743313, -0.0037691777106374502, -0.03906669840216637, 0.026794010773301125, -0.02508721314370632, -0.002109791385009885, -0.014101398177444935, -0.03362119942903519, -0.007829594425857067, 0.017989102751016617, -0.006173594854772091, 0.03801010921597481, -0.02610316313803196, -0.002536490559577942, 0.008852318860590458, 0.01567273586988449, -0.006617226637899876, 0.010267877019941807, 0.011249962262809277, -0.00553354574367404, 0.024545373395085335, 0.015117349103093147, -0.022960489615797997, -0.004256834276020527, -0.02644181437790394, 0.0003519846359267831, -0.01042365562170744, 0.012509741820394993, 0.003694674698635936, -0.002409496810287237, 0.007531582377851009, 0.038308121263980865, 0.0006993128336034715, -0.008046330884099007, 0.04188426584005356, 0.011060317978262901, -0.01027464959770441, -0.02504657581448555, 0.00463612237945199, -0.003738699248060584, 0.011825667694211006, -0.005045889411121607, 0.0029953618068248034, -0.014954796992242336, -0.039798181504011154, -0.0033136929851025343, -0.02906974032521248, -0.016377126798033714, -0.051176831126213074, 0.0027938648127019405, 0.0050120241940021515, 0.04015037789940834, 0.006844122428447008, -0.01998036727309227, 0.01640421897172928, 0.004121373873203993, 0.007179385982453823, 0.017758820205926895, -0.00991568062454462, 0.03077653795480728, 0.016891876235604286, -0.03627621755003929, 0.005862036254256964, 0.007436760235577822, 0.02457246370613575, 0.0436723418533802, -0.01560500543564558, 7.89478508522734e-05, -0.01731180213391781, 0.011419287882745266, 0.03939180076122284, -0.015185078606009483, -0.012225274927914143, 0.00234176660887897, -0.027552587911486626, 0.026712734252214432, 0.002402723766863346, -0.012814526446163654, 0.013444416224956512, -0.024355728179216385, -0.00817501824349165, -0.013952392153441906, 0.036547139286994934, 0.03335028141736984, -0.012943213805556297, 0.014643237926065922, 0.011974673718214035, 0.021632980555295944, 0.01725761778652668, -0.0056622326374053955, 0.0011420981027185917, 0.003996073268353939, -0.004805447533726692, 0.010186600498855114, -0.0063124410808086395, 0.007626404520124197, -0.008703311905264854, 0.018476760014891624, -0.009353521279990673, 0.010288195684552193, 0.019899090752005577, -0.011561520397663116, 0.02729521319270134, -0.01047106646001339, -0.019289519637823105, 0.018463212996721268, 0.04573133587837219, -0.00347793847322464, -0.021348513662815094, 0.004663214553147554, 0.009908907115459442, 0.0209827721118927, -0.03559891879558563, 0.006163435056805611, 0.021578796207904816, 0.015185078606009483, -0.015713373199105263, -0.025737421587109566, -0.01973653770983219, 0.01249619573354721, 0.021240144968032837, 0.026468906551599503, -0.011967901140451431, -0.008662674576044083, 0.0410173237323761, 0.0006552882841788232, -0.0173930786550045, 0.007436760235577822, 0.024640195071697235, 0.006163435056805611, -0.0034982573706656694, 0.014358771964907646, 0.012015311978757381, -0.0061498889699578285, -0.00780250271782279, 0.0027566133067011833, 0.010457520373165607, -0.009170649573206902, -0.016648048534989357, 0.004656441509723663, 0.03153511509299278, 0.0011378650087863207, -0.007951508276164532, -0.03489452600479126, 0.0627451241016388, 0.004084122367203236, 0.0035422819200903177, 0.013505373150110245, -0.012286231853067875, 0.001158184022642672, 0.007402895018458366, -0.0037082205526530743, 0.009692171588540077, -0.031751848757267, 0.04142370447516441, 0.06870537251234055, 0.019289519637823105, -0.002494159387424588, 0.0002925091830547899, -0.010234011337161064, -0.0508517250418663, -0.03996073454618454, -3.6060962884221226e-05, 0.004453251138329506, 0.016986697912216187, 0.020535754039883614, -0.003809815738350153, 0.020725397393107414, -0.00862880889326334, -0.02309594862163067, -0.004666600842028856, 0.04570424184203148, 0.008886183612048626, 0.0019201471004635096, -0.0029885887634009123, 0.0022283189464360476, -0.025412317365407944, -0.003232416929677129, 0.006353079341351986, 0.008926821872591972, 0.0005799385835416615, -0.011290600523352623, -0.016146846115589142, 0.026374084874987602, 0.03819975256919861, 0.04722139611840248, -0.03064107708632946, 0.05450914800167084, 0.011859533376991749, 0.011236416175961494, -0.017054427415132523, -0.00018011961947195232, 0.007328392006456852, 0.006329373922199011, 0.016079114750027657, -0.024938207119703293, 0.003931729588657618, -0.06117378547787666, -0.02629280835390091, -0.005299876909703016, -0.020617028698325157, 0.009041962213814259, 0.01058620773255825, 0.00013419018068816513, -0.004554846324026585, 0.042859580367803574, -0.018151655793190002, 0.010328833945095539, 0.015401815064251423, 0.008351116441190243, -0.00960412248969078, 0.002272343495860696, -0.0005900981486774981, 0.0012132145930081606, -0.02691592462360859, -0.01591656357049942, 0.026360537856817245, 0.00910969264805317, 0.019858453422784805, -0.033269003033638, 0.0031020366586744785, -0.002773545915260911, 0.02729521319270134, 0.01930306665599346, -0.02548004686832428, -0.012997398152947426, 0.017718182876706123, 0.001877815811894834, -0.027417127043008804, 0.010843582451343536, -0.004585324786603451, 0.0009152023703791201, -0.016024932265281677, 0.01793491840362549, 0.016797054558992386, -0.009773447178304195, 0.004026551730930805, 0.027660954743623734, 0.004300858825445175, 0.025886427611112595, -0.00896068662405014, 0.012929667718708515, -0.016553224995732307, -0.004517594818025827, 0.011480244807898998, 0.041992634534835815, -0.0047038523480296135, 0.04172171652317047, -0.020535754039883614, 0.04028583690524101, 0.018056832253932953, -0.0018981348257511854, -0.01839548349380493, 0.0023349937982857227, -0.008879410102963448, 0.002016662387177348, 0.00889295618981123, 0.017853643745183945, -0.006359852384775877, -0.01378983911126852, -0.007626404520124197, 0.05025570094585419, 0.0024704537354409695, -0.010166281834244728, -0.021240144968032837, -0.001552711590193212, 0.015889471396803856, -0.009678625501692295, -0.009102920070290565, -0.007768637500703335, 0.017745275050401688, -0.0009448343189433217, 0.028907189145684242, -0.032618794590234756, 0.0353550910949707, -0.011500563472509384, -0.0001240306592080742, -0.008093741722404957, -0.0070913368836045265, -0.010308514349162579, 0.019993912428617477, -0.01854448951780796, -0.01259779091924429, 0.025805151090025902, 0.013200588524341583, 0.015455999411642551, -0.017474355176091194, 0.0015450919745489955, -0.044430918991565704, 0.01591656357049942, -0.012089814990758896, -0.002704122569411993, 0.0654001459479332, 0.01941143348813057, 0.013823704794049263, -0.00946866162121296, 0.006498699076473713, 0.0038132022600620985, 0.01553727500140667, -0.008351116441190243, -0.04578552022576332, -0.005821398459374905, -0.02619798667728901, -0.022879213094711304, 0.02623862400650978, 0.00563852721825242, 0.01484642829746008, 0.004483729600906372, 0.003968981094658375, -0.018856048583984375, -0.0007010060944594443, 0.044376734644174576, -0.013593422248959541, 0.018869593739509583, 0.016173938289284706, -0.020806673914194107, -0.02136206068098545, 0.022025814279913902, -0.022052906453609467, -0.0009549938258714974, 0.011053545400500298, -0.013586649671196938, 0.009482207708060741, -0.013369913212954998, 0.02782350778579712, -0.023055311292409897, -0.00980053935199976, 0.02308240346610546, -0.015713373199105263, 0.0024839998222887516, 0.01807037927210331]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" chosen them otherwise (highlighted in Fig. 1). This
is because naive constraining does not account for bridge
1arXiv:2403.06988v1  [cs.LG]  7 Feb 2024
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
tokens that may span multiple parser terminals in the un-
derlying grammar (e.g., whitespace and double quotes, in
this example). While existing work on code generation has
made this observation before (Poesia et al., 2022), solving
this problem efficiently remains challenging, as the online
computation of all bridge tokens at each decoding step, can
be too costly in high-throughput environments.
This work: Efficient, Minimally-Invasive Constraining
In this work, we study the token misalignment problem out-
lined above, and examine its consequences for constrained
decoding, showing empirically that misalignment can lead
to a significant decrease in downstream accuracy. Based
on this observation, we propose the notion of minimally
invasive constrained decoding : A form of constraining that
enforces a grammar, but also intervenes as little as possi-
ble during generation, avoiding token misalignment and
optimizing for faithful, low-perplexity model output.
Based on this, we propose a novel constrained decoding
algorithm, D OMINO , which can enforce context-free gram-
mars in a minimally-invasive way. In contrast to existing
methods, DOMINO is highly efficient and incurs little to no
overhead, and in many cases even increases the throughput
of LLM inference over unconstrained generation, by lever-
aging pre-computation (Willard & Louf, 2023) and a novel
speculative decoding procedure for constrained decoding.
We compare D OMINO with other approaches in Table 1.
Main contributions In summary, our key contributions are:
•We identify the challenges of constrained decoding,
most notably the correct and efficient alignment of
sub-word tokens and grammar terminals (§2).
•We propose DOMINO , a novel constrained decoding
algorithm, that addresses token misalignment and lever-
ages pre-computation and speculative decoding for
very low overhead generation (§3).
•An extensive evaluation thats shows that DOMINO is
minimally-invasive, low-overhead, significantly outper-
forms other methods, and even exceeds unconstrained
generation throughput in many cases (§4).
2. Challenges of Constrained Decoding
We first introduce the required background and highlight
the challenges of efficient and token-aligned constraining.
Large Language Models (LLMs) are machine learning
models trained to complete a given text prompt. The current
generation of these models operate on sub-word tokens, such
as the commonly used Byte-Pair Encoding (BPE) (Sennrich
et al., 2016; Kudo & Richardson, 2018). Conditioned on a
sequence of input tokens l1, . . . , l nthe model computes aTable 1. Overview of different constrained decoding methods
Regex CFGPre-
ComputedMinimally
Invasive
LMQL ✓ ✗ ✗ ✗
GUIDANCE ✓ (✓) ✗ (✓)∗
OUTLINES ✓ ✓ (✓)†✗
PICARD ✓ ✓ ✗ ✗
SYNCHROMESH ✓ ✓ ✗ ✓
LLAMA .CPP ✓ ✓ ✗ ✓+
GCD ✓ ✓ ✗ ✓
DOMINO (ours) ✓ ✓ ✓ ✓
∗Boundary token healing,+Up to implementation. We observe
violations in some cases,†For regex.
Algorithm 1 Constrained Decoding
Input: Checker C, LLM f, Tokenized Prompt x
Output: Completion oadhering to C
1:o←[]
2:C.init()
3:loop
4: C.update (o) // advance state of C
5:m←C.mask() // compute mask
6:v←f(x+o) // compute logits
7:v′←m⊙v′
8: t←decode (α′) // e.g., argmax or sample
9: ift=EOS then break
10: o.append (t)
11:end loop
12:return o // optionally detokenize
probability distribution over the next token, from which the
next token is decoded, i.e. chosen or sampled. This process
is repeated for each token. In this context, we denote the set
of all tokens, the vocabulary, as V.
Constrained Decoding Algorithm 1 shows the general
outline used by most constrained decoding approaches. A
checker C, e.g., a parser or regex checker, is used to ensure
that given an input xthe generated output oadheres","[0.01708081178367138, 0.040892452001571655, 0.03664562106132507, 0.023090479895472527, -0.015424815006554127, 0.015251201577484608, 0.002924705157056451, -0.016519909724593163, -0.025814862921833992, 0.05619707331061363, 0.027858149260282516, -0.004771008621901274, -0.015331330709159374, 0.03309324011206627, 0.013181204907596111, -0.04121296852827072, 0.016373006626963615, 0.005645749159157276, 0.0071515049785375595, 0.06522493064403534, 0.04262857884168625, -0.013127786107361317, 0.017361262813210487, 0.03261246532201767, -0.007725762203335762, 0.00049287622096017, 0.010129629634320736, 0.04460509121417999, 0.02887311577796936, -0.03274601325392723, 0.027938278391957283, -0.02537415362894535, -0.029807953163981438, -0.043670255690813065, 0.03790097311139107, 0.05403359234333038, 0.009027857333421707, -0.010703886859118938, -0.0061332001350820065, -0.003009842010214925, -0.015384750440716743, -0.05662442743778229, -0.03734007105231285, -0.03445542976260185, 0.010129629634320736, 0.06821641325950623, 0.012800592929124832, 0.02900666370987892, -0.01762836053967476, 0.03597787767648697, -0.07767161726951599, 0.039824068546295166, 0.0192710030823946, 0.0013480018824338913, -0.0627676472067833, -0.024906735867261887, -0.010403403080999851, 0.00781924556940794, 0.02301035076379776, -0.011865755543112755, 0.029941501095891, -0.035924460738897324, -0.01298088300973177, 0.036405231803655624, -0.014009203761816025, 0.016506554558873177, -0.02598847635090351, 0.016880489885807037, 0.00691779563203454, 0.026455894112586975, -0.011732207611203194, 0.024973509833216667, 0.023918479681015015, -0.015691911801695824, -0.026255572214722633, -0.0018112472025677562, 0.005615700967609882, 0.05534236505627632, 0.004887863527983427, -0.010136307217180729, 0.03597787767648697, -0.030422275885939598, 0.02544092759490013, -0.04756985977292061, 0.025881636887788773, -0.0010375024285167456, -0.00428689643740654, 0.04700895771384239, -0.05149617791175842, -0.05446094647049904, -0.026736345142126083, -0.008253277279436588, -0.04433799535036087, 0.011331562884151936, 0.012206303887069225, 0.023784929886460304, -0.003729332936927676, -0.02640247531235218, 0.0471959263086319, 0.01629287749528885, 0.029380599036812782, -0.033146657049655914, 0.050801727920770645, -0.04508586600422859, 0.06260738521814346, 0.013561817817389965, -0.02876627817749977, -0.015611781738698483, -0.03525672107934952, -0.005999651737511158, -0.014810493215918541, -0.017000682651996613, -0.018362874165177345, 0.013875655829906464, 0.06234028935432434, -0.06880401819944382, -0.032185111194849014, 0.010496886447072029, -0.005415378604084253, -0.038595423102378845, -0.01655997335910797, -0.00032677571289241314, 0.02335757575929165, -0.011398336850106716, -0.0081931808963418, 0.00815979391336441, 0.022542933002114296, -0.04981347173452377, 0.018629971891641617, -0.025868281722068787, 0.011298175901174545, 0.011311531066894531, 0.02791156992316246, -0.030956467613577843, -0.0852571576833725, 0.0087941475212574, -0.04412432014942169, -0.009027857333421707, -0.014089332893490791, 0.019978808239102364, -0.006356893107295036, -0.02924705110490322, 0.010830757208168507, 0.020993772894144058, -0.035336848348379135, 0.020793450996279716, -0.01631958782672882, 0.03360072150826454, -0.052244048565626144, 0.04121296852827072, 0.02836563251912594, -0.024198930710554123, -0.04965321347117424, 0.029060084372758865, -0.024425961077213287, -0.07350491732358932, -0.04586044326424599, 0.03066266141831875, 0.03106330707669258, -0.01020308118313551, 0.008380148559808731, 0.03928987309336662, 0.03977064788341522, 0.0011334901209920645, 0.034001365303993225, 0.018215971067547798, 0.033520594239234924, 0.04893205314874649, -0.053686369210481644, -0.007812568917870522, 0.018576551228761673, -0.04129309579730034, -0.050801727920770645, 0.0010633773636072874, -0.014837202616035938, 0.00201490824110806, -0.053579527884721756, -0.025427572429180145, -0.01169214304536581, -0.047169215977191925, -0.03247891739010811, 0.03627168387174606, -0.010470177046954632, -0.002423899481073022, -0.031570788472890854, -0.0202325489372015, -0.02108725719153881, -0.001539977383799851, -0.0028629391454160213, 0.008687308989465237, -0.05451436713337898, 0.03512316942214966, 0.07120788842439651, 0.02616208791732788, 0.027150344103574753, -0.02681647427380085, 0.07526775449514389, 0.032799433916807175, 0.026829829439520836, -0.013454979285597801, 0.009274921379983425, 0.00920814648270607, 0.016613394021987915, -0.06415654718875885, 0.02701679617166519, 0.02252957783639431, 0.008553761057555676, 0.023397641256451607, 0.02561454102396965, 0.003929655067622662, 0.016105910763144493, -0.03816806897521019, 0.045112576335668564, -0.005455443169921637, -0.005849410314112902, -0.0012186270905658603, 0.032078273594379425, 0.0033119949512183666, 0.010363338515162468, 0.01937784068286419, 0.004123299848288298, 0.037847552448511124, 0.049706630408763885, 0.022743254899978638, -0.033867817372083664, -0.00605307100340724, -0.035470396280288696, 0.002036609686911106, 0.020486291497945786, -0.006043055094778538, 0.039076197892427444, -0.027804730460047722, -0.011511852964758873, -0.034482140094041824, 0.005982958246022463, -0.02176835387945175, -0.02331751212477684, -0.025427572429180145, 0.008146438747644424, -0.021714933216571808, -0.01964493654668331, -0.02764447219669819, 0.049599792808294296, -0.01995209790766239, -0.03768729791045189, 0.02815195545554161, -0.0438305139541626, -0.023063771426677704, 0.031143436208367348, 0.05293849855661392, 0.025975121185183525, 0.008393502794206142, -0.045379672199487686, 0.001309606828726828, -0.047783538699150085, 0.027751311659812927, -0.025868281722068787, 0.005799329839646816, -0.007952794432640076, 0.034615688025951385, -0.02053971029818058, 0.012640335597097874, -0.023891769349575043, 0.009742340072989464, -0.012453367933630943, -0.0005321060307323933, -0.015131008811295033, 0.026295635849237442, 0.007244988810271025, -0.016680167987942696, -0.03333362564444542, -0.044765349477529526, -0.010577015578746796, -0.005028089042752981, -0.06111164763569832, -0.044979028403759, 0.04166703298687935, 0.05178998410701752, -0.009562049992382526, 0.039797358214855194, -0.03274601325392723, -0.010610402561724186, 0.059615906327962875, 0.008153116330504417, -0.000888930051587522, 0.03600458800792694, -0.0016259490512311459, -0.036058008670806885, -0.017267780378460884, -0.014690299518406391, 0.0021751660387963057, 0.013808881863951683, 0.01165875606238842, -0.014089332893490791, -0.0041199615225195885, 0.006623989902436733, 0.00973566249012947, -0.005164975766092539, 0.008406857959926128, 0.01065046712756157, 0.040064454078674316, 0.04300251230597496, -0.0033520592842251062, -0.01828274503350258, -0.04618095979094505, 0.016373006626963615, -0.011551917530596256, -0.016439780592918396, -0.002892987336963415, 0.008533728308975697, 0.008046277798712254, 0.020219193771481514, -0.020219193771481514, 0.01042343582957983, -0.0166267491877079, -0.02972782403230667, 0.043055932968854904, -0.07654981315135956, 0.03434859216213226, -0.012800592929124832, -0.028338924050331116, -0.011965916492044926, 0.0063802641816437244, -0.03186459466814995, 0.007051344029605389, 0.03066266141831875, 0.018389584496617317, 0.028098536655306816, 0.008480309508740902, -0.04877179488539696, -0.009375082328915596, 0.014516687020659447, 0.037153102457523346, 0.037126392126083374, -0.0452728308737278, -0.0512290820479393, -0.05192353203892708, 0.04503244534134865, 0.05673126503825188, 0.042468320578336716, -0.047649990767240524, 0.008460276760160923, 0.02740408666431904, 0.017294488847255707, -0.0096355015411973, -0.02393183298408985, -0.006433683447539806, 0.022556288167834282, 0.05929538980126381, 0.010263177566230297, -0.031223563477396965, -0.03779413551092148, 0.00793943926692009, -0.00932834018021822, 0.036538783460855484, 0.05312546715140343, 0.02053971029818058, -0.010056178085505962, -0.007805890869349241, 0.0012361552799120545, -0.029086792841553688, 0.005018072668462992, 0.0019748436752706766, 0.0727570503950119, -0.028205376118421555, -0.025454282760620117, -0.037019554525613785, 0.0222491268068552, 0.013207915239036083, -0.03480265662074089, 0.018095778301358223, 0.025627896189689636, -0.02524060569703579, 0.025347445160150528, -0.03541697561740875, 0.005044782534241676, -0.010810725390911102, 0.02605525031685829, 0.024225639179348946, 0.00834676157683134, 0.0026425844989717007, -0.04436470568180084, 0.008620535023510456, 0.0008555430104024708, 0.011017724871635437, 0.04265528917312622, -0.008627212606370449, -0.03490949422121048, -0.030716082081198692, 0.016105910763144493, 0.0129274632781744, 0.02804511785507202, 0.00242556887678802, 0.02767118252813816, 0.024666348472237587, 0.002328746486455202, -0.018670035526156425, 0.03333362564444542, 0.03579091280698776, 0.043296318501234055, 0.05528894439339638, -0.015758685767650604, -0.017414681613445282, -0.029807953163981438, -0.0240787360817194, -0.025334089994430542, 0.010042822919785976, 0.021541321650147438, 0.03202485293149948, 0.020352741703391075, 0.026843184605240822, 0.0016184370033442974, 0.023571252822875977, -0.02266312576830387, 0.007365182042121887, -0.0006093135452829301, 0.04425786808133125, -0.014850557781755924, 0.029781244695186615, 0.04444483295083046, -0.0014398163184523582, -0.01304765697568655, -0.027310602366924286, -0.06570570170879364, -0.03199814260005951, 0.030849630013108253, 0.007164859678596258, -0.03320007771253586, 0.014116042293608189, -0.012112819589674473, 0.010530274361371994, -0.002535745967179537, 0.020219193771481514, -0.0435367077589035, -0.01810913346707821, -0.01294749602675438, 0.011752239428460598, 0.045486509799957275, -0.002467302605509758, -0.060096681118011475, 0.008413535542786121, 0.001341324532404542, -0.013862300664186478, -0.010329951532185078, -0.03149066120386124, 0.039316583424806595, -0.04447154328227043, -0.016987327486276627, -0.010964305140078068, -0.003485607448965311, -0.016132619231939316, -0.03568407520651817, 0.07425278425216675, 0.0009765711147338152, -0.012086110189557076, -0.021007128059864044, 0.08007548749446869, -0.03856871277093887, 0.012560206465423107, 0.021648159250617027, 0.0005805172258988023, -0.012800592929124832, -0.021688224747776985, -0.04481877014040947, -0.025507701560854912, 0.041720449924468994, -0.018563196063041687, 0.0240787360817194, 0.012640335597097874, 0.050935275852680206, -0.0063268449157476425, -0.0024806575383991003, -0.0014181147562339902, 0.007238311227411032, -0.04562005773186684, 0.024252349510788918, 0.06148558109998703, -0.04107942059636116, 0.009708952158689499, -0.007358504459261894, 0.006517150904983282, 0.0023421011865139008, 0.06196635589003563, 0.002193528925999999, 0.010763983242213726, 0.08798153698444366, 0.0018663357477635145, 0.00944853387773037, 0.0006685755797661841, 0.004116622731089592, -0.00548549136146903, -0.04356341436505318, 0.014236235991120338, -0.015478233806788921, -0.0017094167415052652, -0.022315900772809982, 0.0005871946341358125, -0.022716544568538666, -0.014062623493373394, -0.018816938623785973, 0.020793450996279716, 0.005174992140382528, -0.045379672199487686, 0.03066266141831875, -0.003205156186595559, 0.02375822141766548, 0.051896821707487106, 0.007926084101200104, -0.009769049473106861, 0.014636880718171597, -0.007191569544374943, -0.005712523125112057, 0.01174556277692318, -0.008687308989465237, -0.03728665038943291, 0.022623062133789062, -0.013368172571063042, -0.006931150332093239, -0.016653457656502724, 0.010122952051460743, 0.03234536945819855, -0.03995761647820473, 0.008480309508740902, -0.0010583692928776145, -0.01587887853384018, 0.01248007733374834, -0.03597787767648697, -0.10240474343299866, -0.03044898435473442, 0.011398336850106716, 0.025601185858249664, -0.010630435310304165, -0.00031759426929056644, 0.037500329315662384, -0.04773011803627014, -0.024359187111258507, -0.02102048322558403, -0.01810913346707821, -0.024011962115764618, -0.022449448704719543, -0.009468565694987774, -0.022756610065698624, -0.0025624556001275778, 0.01931106671690941, 0.006964537315070629, 0.015424815006554127, 0.02329080179333687, 0.003270260989665985, -0.012146206572651863, 0.04529954120516777, -0.005278491880744696, -0.02578815259039402, 0.007378536742180586, -0.033039819449186325, -0.0275376345962286, 0.006837666966021061, 0.033654142171144485, -0.025467637926340103, -0.009976048953831196, -0.0204729363322258, -0.0018613277934491634, 0.00725166592746973, -0.036538783460855484, -0.0022586334962397814, -0.019711710512638092, -0.005088185425847769, -0.020686613395810127, 0.0023454399779438972, -0.005291846580803394, 0.030876338481903076, -0.03237207978963852, -0.016640102490782738, 0.044658511877059937, 0.010844112373888493, -0.0015107637736946344, -0.02033938840031624, 0.01260027103126049, 0.004941282793879509, 0.01462352555245161, 0.005201701540499926, -0.0005450434982776642, -0.04842456802725792, 0.018469713628292084, -0.03669903799891472, -0.053445979952812195, -0.0006664888933300972, 0.004039832390844822, -0.006844344083219767, -0.036405231803655624, 0.005989635828882456, 0.013528430834412575, 0.02005893737077713, -0.025053638964891434, 0.03477594628930092, -0.07558827102184296, 0.005038104951381683, 0.010583693161606789, -0.009875888004899025, -0.03923645615577698, -0.033520594239234924, 0.03816806897521019, -0.0043069287203252316, -0.007899374701082706, -0.0028896487783640623, 0.00857379287481308, 0.000823825306724757, -0.001981521025300026, -0.0015691911103203893, 0.0316242091357708, -0.00688440864905715, -0.03541697561740875, 0.03864884376525879, 0.03007504902780056, -0.01868339069187641, -0.02622886188328266, 0.014209526591002941, -0.016880489885807037, -0.0014122719876468182, 0.031116725876927376, -0.017160940915346146, 0.030582532286643982, -0.0069578601978719234, -0.015825459733605385, -0.007238311227411032, 0.038114652037620544, -0.009615468792617321, -0.011238079518079758, -0.010790692642331123, -0.011765594594180584, -0.015972362831234932, -0.03990419581532478, -0.04604741185903549, 0.00914137251675129, 0.002585826674476266, -0.0041900742799043655, -0.0065271672792732716, 0.0011359942145645618, 0.010563661344349384, 0.015024170279502869, -0.018189262598752975, 0.0019698357209563255, 0.01907067932188511, 0.00658392533659935, -0.03995761647820473, 0.025026928633451462, 0.014329719357192516, 0.01883029378950596, -0.0032836159225553274, 0.005572297610342503, -0.005018072668462992, -0.01690720021724701, -0.0081931808963418, 0.05534236505627632, -0.0032836159225553274, 0.020285967737436295, -0.01931106671690941, 0.0025307380128651857, 0.002903003478422761, 0.0003532766713760793, 0.01527791190892458, -0.03603129833936691, -0.007118117995560169, -0.029327180236577988, 0.01443655788898468, 0.003064930671826005, 0.015651846304535866, 0.015798749402165413, 0.02256964147090912, -0.017000682651996613, -0.006310151424258947, -0.014316365122795105, 0.00929495319724083, 0.02180841751396656, -0.016920553520321846, -0.005929538980126381, 0.004373702686280012, -0.0234510600566864, -0.04586044326424599, -0.0007073879824019969, 0.00515162106603384, -0.05662442743778229, 0.006416989956051111, -0.03490949422121048, -0.02924705110490322, 0.0016635095234960318, 3.557806849130429e-05, 0.04375038295984268, 0.003619155613705516, 0.010136307217180729, -0.005465459078550339, 0.04011787474155426, -0.009401791729032993, 0.004754315130412579, -0.03031543642282486, 0.02719040960073471, -0.00026208828785456717, -0.011344918049871922, 0.03664562106132507, -0.009101307950913906, -0.06495783478021622, -0.0038595423102378845, 0.01443655788898468, -0.023437704890966415, -0.006777570117264986, -0.012179593555629253, -0.029807953163981438, -0.006216667592525482, 0.01810913346707821, 0.046341218054294586, 0.0067041185684502125, 0.02447938174009323, 0.004627444315701723, -0.014222880825400352, -0.005512201227247715, -0.025454282760620117, -0.017361262813210487, 0.03928987309336662, -0.00575258769094944, 0.02740408666431904, -0.05168314650654793, -0.03410820662975311, 0.006186619400978088, -0.01786874607205391, -0.007825923152267933, 0.0016134289326146245, -0.013475011102855206, 0.02170157991349697, 0.03779413551092148, -0.03664562106132507, 0.03894264996051788, 0.0053018624894320965, 0.018336165696382523, 0.037580456584692, -0.014984105713665485, -0.020512999966740608, 0.0034755913075059652, -0.0019431259715929627, -0.003306986764073372, -0.017054103314876556, -0.013742107897996902, 0.00860717985779047, -0.017414681613445282, -0.04858482629060745, 0.016893845051527023, 0.008500341325998306, 0.01660003885626793, -0.010530274361371994, 0.01553165353834629, 0.00951530784368515, 0.032665885984897614, -0.02541421912610531, 0.011525208130478859, -0.021234160289168358, 0.016332942992448807, 0.00781924556940794, 0.004150009714066982, -0.00042902352288365364, 0.016212748363614082, 0.0033003094140440226, -0.019431259483098984, 0.0040965904481709, 0.03683258593082428, -0.02677641063928604, 0.008627212606370449, 0.008466954343020916, 0.025881636887788773, -0.031704336404800415, -0.042094387114048004, 0.018402939662337303, 0.03800781071186066, 0.019017260521650314, 0.010363338515162468, 0.010623757727444172, 0.020085645839571953, 0.025574475526809692, -0.010677176527678967, -0.013408237136900425, -0.011672111228108406, -0.016306232661008835, 0.024946799501776695, -0.014329719357192516, -0.005635733250528574, 0.0028512536082416773, -9.750060416990891e-05, -0.017668424174189568, -0.024252349510788918, -0.0003278190561104566, 0.019631581380963326, 0.008647244423627853, -0.032425496727228165, -0.0226364154368639, 0.002193528925999999, -0.028098536655306816, 0.004764331504702568, -0.0102364681661129, 0.03958367928862572, -0.014797138050198555, -0.13087721168994904, 0.00017246494826395065, 0.0003737262450158596, 0.0447920598089695, -0.023170609027147293, -0.00733847264200449, 0.021421127021312714, 0.0349896214902401, -0.03378769010305405, -0.011151272803544998, -0.04543308913707733, 0.0006852690712548792, -0.010276532731950283, -0.016332942992448807, 0.0069044409319758415, -0.016720231622457504, -0.012673722580075264, -0.03600458800792694, 0.025053638964891434, -0.00011320295016048476, 0.012119497172534466, -0.018736809492111206, 0.006844344083219767, -0.0032135031651705503, -0.02208886854350567, -0.040037743747234344, 0.012172916904091835, 0.023851703852415085, -0.03034214675426483, 0.028312213718891144, 0.01765506900846958, -0.029407309368252754, 0.004350332077592611, 0.019658291712403297, -0.011865755543112755, -0.03394794836640358, -0.011264788918197155, -0.03856871277093887, -0.004013122990727425, 0.02390512451529503, 0.02836563251912594, -0.05002714693546295, -0.0029814629815518856, -0.031143436208367348, -0.004200090188533068, -0.005028089042752981, 0.01765506900846958, -0.01590558886528015, -0.009421824477612972, -0.02215564250946045, -0.030582532286643982, -0.016332942992448807, 0.018202615901827812, -0.00474096043035388, -0.02458621934056282, -0.0010199742391705513, 0.01042343582957983, 0.024025317281484604, 0.004133316222578287, 0.01907067932188511, -0.004340315703302622, 0.002871285891160369, 0.00688440864905715, 0.012767205946147442, -0.013942429795861244, -0.03827490657567978, 0.023304156959056854, 0.0014389816205948591, -0.02911350317299366, -0.034829363226890564, -0.005028089042752981, -0.0263357013463974, -0.01095762848854065, 0.022382674738764763, -0.010016113519668579, 0.02541421912610531, 0.01708081178367138, 0.026736345142126083, -0.03587104007601738, 0.01402255892753601, 0.033280204981565475, -0.024813251569867134, 0.003131704870611429, 0.014049268327653408, 0.037981100380420685, 0.03717981278896332, 0.011278144083917141, 0.02417222037911415, -0.03974393755197525, 0.033654142171144485, 0.05339256301522255, -0.010443467646837234, -0.006423667538911104, -0.00055505963973701, -0.01244669035077095, -0.03728665038943291, 0.02839234285056591, 0.0056390720419585705, -0.003689268371090293, -0.002068327507004142, 0.020486291497945786, 0.022409385070204735, -0.050053857266902924, -0.05726546049118042, 0.007064698729664087, 0.030262017622590065, -0.014049268327653408, -0.012046045623719692, -0.013281366787850857, -0.0027126974891871214, 0.028686149045825005, 0.00812640693038702, -0.009949339553713799, 0.03309324011206627, -0.005568959284573793, 0.030048340559005737, 0.04278883710503578, 0.02397189848124981, 0.029300469905138016, 0.01546487957239151, 0.0010875830193981528, 0.010897531174123287, -0.023304156959056854, -0.005164975766092539, -0.0301818884909153, -0.024946799501776695, 0.013548462651669979, 0.036886006593704224, 0.001966496929526329, -0.07622930407524109, -0.0016367998905479908, 0.007578859105706215, -0.00033220110344700515, 0.009281598031520844, 0.019831905141472816, 0.0129274632781744, -0.004069880582392216, 0.06741511821746826, -0.023651381954550743, 0.037393491715192795, 0.018055714666843414, 0.003969719633460045, 0.03939671441912651, 0.00216514989733696, -0.019978808239102364, 0.0021634805016219616, 0.009822468273341656, -0.012813948094844818, -0.03867555409669876, 0.022689836099743843, 0.025360798463225365, 0.010790692642331123, -0.013368172571063042, -0.0289799552410841, 0.013675333932042122, 0.008987792767584324, 0.0011426715645939112, -0.03768729791045189, 0.022369319573044777, 0.019124099984765053, 0.009281598031520844, -0.005662442650645971, -0.0560368150472641, -0.02701679617166519, 0.01673358678817749, 0.002979793818667531, -0.01680036075413227, -0.009274921379983425, -0.018696745857596397, -0.008687308989465237, -0.034615688025951385, -0.05993642285466194, 0.021514611318707466, 0.0016242797719314694, 0.024853315204381943, 0.03223853185772896, 0.016787005588412285, 0.02598847635090351, 0.025334089994430542, 0.03416162356734276, 0.006553876679390669, 0.007772503886371851, -0.0399843230843544, 0.01583881489932537, 0.011945884674787521, -0.028926536440849304, -0.00800621323287487, 0.02548099309206009, -0.0020232549868524075, 0.009488598443567753, 0.01813584193587303, 0.062286872416734695, 0.010316596366465092, 0.0043536704033613205, 0.019124099984765053, -0.021287579089403152, 0.03394794836640358, 0.04810405522584915, 0.01503752451390028, -0.01455675158649683, -0.07494723796844482, 0.0361381359398365, -0.003852864960208535, 0.006714134477078915, -0.009682242758572102, -0.0036391878966242075, 0.02664286084473133, -0.0016685175942257047, -0.014289654791355133, 0.05512868985533714, -0.017414681613445282, -0.0022436094004660845, -0.04495231807231903, 0.00013918224431108683, 0.0231171902269125, -0.002999825868755579, 0.02314389869570732, 0.01030324213206768, 0.01342826895415783, -0.0246529933065176, -0.03357401117682457, -0.003936332650482655, -0.013227947056293488, -0.013568495400249958, -0.004250170662999153, 0.02276996523141861, 0.058868035674095154, 0.027136990800499916, 0.004841121379286051, 0.0011543571017682552, -0.01109117642045021, -7.851172267692164e-05, 0.013061012141406536, 0.003255236893892288, 0.00039334112079814076, -0.01756158471107483, 0.01618603989481926, 0.001578372553922236, -0.0023804963566362858, 0.0380612313747406, 0.04588715359568596, -0.022209061309695244, 0.0010475185699760914, -0.016573328524827957, -0.021661514416337013, -0.024706413969397545, -0.0028028422966599464, 0.040545228868722916, -0.02486667037010193, 0.006313490215688944, -0.01515771821141243, 0.04059864580631256, 0.01813584193587303, -0.003582429839298129, 0.017160940915346146, 0.009648855775594711, 0.01865668036043644, 0.0275376345962286, 0.04925256967544556, 0.03360072150826454, -0.012800592929124832, 0.030876338481903076, 0.008199858479201794, -0.025708025321364403, -0.01574533060193062, -0.0030849629547446966, -0.036805879324674606, -0.004143332131206989, 0.038702260702848434, -0.004026477690786123, 0.0037961069028824568, -0.0020182467997074127, -0.0011785626411437988, 0.019217582419514656, 0.00302653550170362, -0.008166471496224403, 0.006433683447539806, -0.04388393089175224, 0.009087953716516495, -0.01383559126406908, -0.025641249492764473, -0.01583881489932537, 0.019417904317378998, 0.006871053948998451, 0.007545472122728825, -0.022502867504954338, 0.011131240986287594, -0.014169462025165558, 0.01607920043170452, 0.005772619973868132, 0.03830161690711975, 0.015131008811295033, 0.00029109331080690026, -0.0028562615625560284, -0.0022002062760293484, -0.017882101237773895, 0.031116725876927376, -0.014783783815801144, 0.014543396420776844, 0.0034488816745579243, -0.011972594074904919, 0.0192710030823946, 0.029781244695186615, -0.028071826323866844, 0.012253045104444027, 0.006700779777020216, 8.701498882146552e-05, -0.048371151089668274, -0.04842456802725792, -0.01629287749528885, -0.0012503447942435741, 0.024492736905813217, 0.010917563922703266, 0.0036759136710315943, 0.0035323493648320436, -0.009054566733539104, -0.026108669117093086, -0.028178665786981583, 0.023210672661662102, -0.016439780592918396, 0.01848306879401207, -0.0012503447942435741, 0.01824268139898777, -0.011084498837590218, -0.009081276133656502, 0.013915720395743847, -0.0053018624894320965, -0.00208835955709219, 0.008186503313481808, 0.02510705776512623, 0.004240154754370451, -0.013555140234529972, 0.035951171070337296, -0.017855390906333923, -0.015798749402165413, -0.021007128059864044, -0.0018613277934491634, 0.010723918676376343, -0.01402255892753601, -0.0321049839258194, 0.04425786808133125, 0.03977064788341522, 0.0017361263744533062, 0.03506975248456001, 0.0035189944319427013, 0.04951966553926468, -0.0016443119384348392, 0.009014502167701721, 0.0022002062760293484, -0.007031311746686697, 0.07671007513999939, -0.03525672107934952, -0.036298394203186035, 0.018055714666843414, 0.013608559034764767, 0.016987327486276627, 0.016586683690547943, -0.04276212677359581, -0.0008705671643838286, 0.002709358697757125, -0.0009790750918909907, 0.017307844012975693, 0.00800621323287487, 0.008173148147761822, 0.004076558165252209, -0.040144581347703934, -0.01800229400396347, 0.02132764458656311, 0.006937827914953232, 0.03338704630732536, 0.03947684168815613, 0.033760979771614075, -0.006176603492349386, -0.007952794432640076, -0.014423203654587269, -0.020005516707897186, -0.00884756725281477, 0.005575636401772499, 0.014770428650081158, 0.039824068546295166, 0.01830945536494255, -0.011097854003310204, -0.06351551413536072, 0.002090028952807188, -0.006844344083219767, 0.012319819070398808, -0.005505523644387722, 0.022449448704719543, -0.04340315982699394, -0.006059748586267233, 0.005148282274603844, 0.015264556743204594, -0.004300251137465239, 0.00345889781601727, -0.006493780296295881, 0.003268591593950987, 0.012733818963170052, -0.007665665354579687, 0.014409848488867283, -0.006443699821829796, 0.03191801533102989, -0.02589499205350876, 0.04030483961105347, -0.005578975193202496, -0.0018629970727488399, -0.029754534363746643, -0.005782636348158121, 0.03274601325392723, 0.011598659679293633, -0.013601882383227348, -0.04655489698052406, 0.02239602990448475, -0.018937131389975548, -0.00013406985090114176, -0.00797282624989748, -0.05045450106263161, -0.011398336850106716, 0.02510705776512623, -0.010944273322820663, 0.04086574167013168, -0.03995761647820473, -0.017788616940379143, -0.007084731012582779, 0.009802436456084251, 0.0031867935322225094, 0.002872955286875367, 0.009769049473106861, -0.010403403080999851, 0.01793552003800869, 0.02626892738044262, -0.01045682281255722, -0.01752152107656002, -0.04033154994249344, -0.009935984387993813, -0.009942661970853806, 0.011765594594180584, 0.03717981278896332, 0.012139529921114445, 4.327273927628994e-05, 0.028552601113915443, -0.007291730493307114, 0.0024339156225323677, 0.022850092500448227, 0.005241766106337309, -0.008286664262413979, -0.02520054206252098, 0.010196403600275517, -0.010824079625308514, 0.0102364681661129, -0.010864144191145897, 0.00812640693038702, -0.014850557781755924, -0.045112576335668564, -0.021714933216571808, -0.03851529583334923, -0.003645865246653557, -0.04866495728492737, 0.0069511826150119305, 0.0053152176551520824, 0.026495959609746933, 0.0204729363322258, -0.010737273842096329, 0.02688324823975563, 0.0029380598571151495, 0.0012403287691995502, 0.014717008918523788, 0.0008989461930468678, 0.02592170238494873, 0.018883712589740753, -0.026122024282813072, 0.010443467646837234, -0.005932877771556377, 0.03862213343381882, 0.028659438714385033, -0.016519909724593163, -0.012707109563052654, -0.013061012141406536, 0.025601185858249664, 0.03333362564444542, -0.021928610280156136, -0.016332942992448807, 0.0031767773907631636, -0.03239878639578819, 0.03250562772154808, 0.012112819589674473, -0.022195708006620407, 0.012967527844011784, -0.011645400896668434, -0.02375822141766548, -0.006664054002612829, 0.02150125615298748, 0.021674869582057, -0.018763519823551178, 0.01717429608106613, 0.012166239321231842, 0.00867395382374525, 0.003979735542088747, -0.007458665873855352, 0.01097098272293806, -0.00042693683644756675, -0.02565460465848446, 0.004954637493938208, -0.022542933002114296, 0.015077589079737663, -0.012099465355277061, -0.008520374074578285, -0.01625281386077404, 0.007492052856832743, 0.031009886413812637, -0.015999071300029755, 0.0061398777179419994, -0.015611781738698483, -0.017708487808704376, 0.022502867504954338, 0.0656522884964943, -0.01045682281255722, -0.011959239840507507, 0.011632046662271023, 0.022623062133789062, 0.010089565068483353, -0.04081232473254204, -0.006797602400183678, 0.0081931808963418, 0.01522449217736721, -0.008326728828251362, -0.015504943206906319, -0.02705686166882515, 0.011238079518079758, 0.014396493323147297, 0.01462352555245161, -0.015504943206906319, -0.012239690870046616, 0.051389340311288834, -0.007785859052091837, -0.023985253646969795, 0.009461888112127781, 0.0036558813881129026, 0.00477434741333127, -0.002203545067459345, -0.0032735997810959816, 0.02852589078247547, -0.01607920043170452, -0.020486291497945786, -0.0002710610569920391, 0.01598571613430977, -0.008019568398594856, -0.02170157991349697, 2.554891398176551e-05, 0.03568407520651817, 0.010844112373888493, -0.007418601308017969, -0.02620215341448784, 0.060096681118011475, 0.008340083993971348, -0.007411923725157976, 0.03247891739010811, -0.011565272696316242, 0.00941514689475298, -0.0006806783494539559, -0.013728752732276917, 0.002418891293928027, -0.023210672661662102, 0.04925256967544556, 0.05058804899454117, 0.01728113368153572, -0.004634121898561716, 0.013755462132394314, -0.006460393313318491, -0.0318111777305603, -0.029674405232071877, -0.002844576258212328, -0.01018304843455553, 0.0029130196198821068, 0.02379828505218029, -0.012733818963170052, 0.02668292634189129, -0.02668292634189129, -0.02434583380818367, -0.012233013287186623, 0.02228919044137001, 0.014703654684126377, -0.0025674637872725725, -0.006166587118059397, 0.006630667019635439, 0.0015107637736946344, -0.009254888631403446, 0.02605525031685829, -0.0020299323368817568, 0.0028145278338342905, 3.2761035981820896e-05, -0.015451524406671524, 0.027043506503105164, 0.011678787879645824, 0.02537415362894535, -0.006383602973073721, 0.053819917142391205, -0.004013122990727425, -0.0019264324801042676, -0.02325073815882206, 0.024572864174842834, 0.017428036779165268, 0.0018780212849378586, -0.015585072338581085, -0.035443685948848724, 0.014770428650081158, -0.044979028403759, -0.013074366375803947, 0.005876119714230299, -0.007305085193365812, 0.013241302222013474, 0.002418891293928027, 0.011912497691810131, -0.005532233510166407, 0.043803803622722626, 0.0033553980756551027, 0.012299787253141403, 0.01527791190892458, 0.024546155706048012, -0.01684042625129223, 0.002522391267120838, -0.023744866251945496, -0.008747405372560024, -0.02640247531235218, -0.010009435936808586, 0.03891593962907791, 0.019698357209563255, 0.02043287083506584, -0.030742790549993515, 0.012560206465423107, -0.003562397789210081, 0.05576971918344498, 0.011104530654847622, -0.024813251569867134, -0.015852168202400208, 0.001573364483192563, 0.013408237136900425, -0.023945188149809837, 0.0006510473904199898, 0.002382165752351284, -0.003739349078387022, -0.013481688685715199, 0.010603724978864193, 0.004250170662999153, -0.010570337995886803, -0.006891086231917143, 0.008967760019004345, 0.00770572992041707, 0.019110744819045067, 0.010476854629814625, 0.011171305552124977, -0.007478698156774044, 0.009154727682471275, 0.0137688172981143, 0.03693942725658417, 0.02194196544587612, 0.03766058757901192, -0.014049268327653408, 0.056571006774902344, 0.016332942992448807, -0.01301426999270916, -0.006453715730458498, 0.015478233806788921, 0.010510241612792015, -0.010356660932302475, 0.008246599696576595, 0.011071143671870232, 0.0043136063031852245, 0.010523596778512001, -0.0342150442302227, 0.04241489991545677, -0.0020666581112891436, 0.014703654684126377, -0.030368855223059654, 0.007378536742180586, 0.01732119917869568, -0.03672574833035469, -0.010376693680882454, 0.010723918676376343, 0.010670499876141548, -0.006083119660615921, 0.03237207978963852, -0.019364485517144203, 0.031944725662469864, -0.0021768352016806602, 0.0022653110790997744, -0.012740496546030045, -0.01323462463915348, -0.00582937803119421, 0.018469713628292084, -0.02156803011894226, -0.018162552267313004, 0.03311994671821594, 0.020152419805526733, -0.005588991101831198, -0.014636880718171597, -0.008486987091600895, -0.046821992844343185, 0.019725065678358078, -0.021901901811361313, -0.015585072338581085, 0.0579599104821682, 0.009348372928798199, 0.03990419581532478, -0.0015933967661112547, 0.005548927001655102, 0.0004427956882864237, -0.001320457668043673, -0.013461656868457794, -0.039423421025276184, -0.010743951424956322, -0.027804730460047722, -0.011451756581664085, 0.018736809492111206, -0.003956364933401346, 0.0004899548948742449, 0.008393502794206142, 7.282548904186115e-05, -0.013915720395743847, 0.01913745328783989, 0.04081232473254204, -0.0030248663388192654, 0.011565272696316242, 0.019965453073382378, -0.014837202616035938, 0.00043987430399283767, 0.02764447219669819, -0.028926536440849304, 0.01852313242852688, 0.010229790583252907, 0.003512317081913352, 0.003966380842030048, -0.013341463170945644, 0.020512999966740608, -0.011905820108950138, -0.010556983761489391, 0.027751311659812927, -0.02526731602847576, 0.006063087377697229, 0.024332478642463684]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" to the
constraint. For each new token, Cis first updated with the
latest generated sequence and then used to generate a mask
m. This mask enforces that the next token must be a valid
continuation. Each time the mask in Algorithm 1 rejects
a token that would otherwise have been chosen, we say
that the constrained decoding algorithm intervenes in the
decoding process. We can therefore say that an algorithm
that intervenes as little as possible is minimally invasive :
Definition 2.1 (Minimally invasive) We consider a con-
strained decoding method minimally invasive , if every valid
output that can be generated by an unconstrained model
(for any given prompt), is also generated by the constrained
model, given the same prompt.
2
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
Replacing the naive constraining in Fig. 1 with a minimally
invasive method, would lead to the same output as with
unconstrained generation, up to the final closing }bracket
of the JSON object. After that, an unconstrained model
continues to generate text, which will not part of the JSON
object. At this point, a minimally invasive decoder, however,
stops decoding by forcing an the EOStoken, to ensure that
the output remains valid JSON.
As this example shows, non-minimally naive constrained
decoding (as in Fig. 1) can lead to different overall output,
compared to unconstrained generation. This in turn, can
affect the model’s task accuracy as we will show in §4, for a
JSON-encoded version of the GSM8K dataset (Cobbe et al.,
2021). There, naive constraining can reduce accuracy from
41.5%in the unconstrained case to 30.8%, while minimally
invasive constraining actually achieves a slight increase in
accuracy to 41.8%(five-shot, Mistral 7B Jiang et al. (2023)).
Next, we discuss the broad categories of existing constrained
decoding approaches. Current approaches implement one
or multiple of the following paradigms: i) Regex-Based , ii)
Online Parser-Guided and iii) Template-Based approaches.
Regex-Based Decoding limited to regular expressions is
supported by many frameworks (e.g., LMQL (Beurer-Kellner
et al., 2023), OUTLINES (Willard & Louf, 2023), GUID -
ANCE (Lundberg et al.), LLAMA .CPP(Gerganov & et. al.))
and typically does not suffer from the token misalignment
problem as it is simpler to check if a token is a legal continu-
ation or not. For this, Willard & Louf (2023) also proposed
an algorithm to pre-compute a regex checker for the model
vocabulary offline, to be more efficient during inference.
Online Parser-Guided refers to running a parser and
scanner in lock-step with an LLM, and then computing
online, which tokens are valid continuations in each step.
Such algorithms ( PICARD (Scholak et al., 2021), GCD (Geng
et al., 2023a), LLAMA .CPP) can support full CFGs and as
Poesia et al. (2022) ( SYNCHROMESH ) demonstrated, can
be built to support bridge tokens and thus to be minimally
invasive. However, all of these approaches produce com-
paratively high inference overhead, since, in the worst case,
they have to check the entire model vocabulary at each step.
Template-Based Approaches Since constrained genera-
tion can add additional overhead during inference, GUID -
ANCE and LMQL , propose a template-based approach, where
some structure is fixed, and only parts of the output are sam-
pled under a regex constraints. For instance, templated
generation can be used to implement schema-driven JSON,
where fields are fixed. Template-based decoding is efficient
as templated tokens can be added deterministically during
generation, without invoking the LLM, thereby requiring
less model forward passes. However, this form of accelera-Prompt: Tell me one sentence about Thomas Cha-
pais.\\n\\nA: (Response In JSON)
(1a) Templated, Multi-Line Perplexity: 24.50
\\n{\\n····""reasoning"":·""Thomas·Chapais·is·a
·Canadian ·politician . . .
(1b) Templated, Single-Line Perplexity: 26.75
·{·""reasoning"":·""I·don’t·know·who·Thomas ·Chap
ais·is. . .
(2) Naturalized Template Output Perplex","[0.027693426236510277, 0.029385551810264587, 0.0016364125767722726, 0.006311472505331039, -0.017072325572371483, 0.031274084001779556, 0.009064950980246067, -0.008959193713963032, -0.010470018722116947, 0.041638344526290894, 0.0057600210420787334, -0.004449380561709404, -0.0006973402923904359, 0.05025004595518112, 0.008898761123418808, -0.025925761088728905, 0.02512502297759056, 0.00813579373061657, -0.019142156466841698, 0.054480358958244324, 0.04257505387067795, -0.0001345578784821555, 0.001439061015844345, 0.03650153800845146, -0.009563523344695568, 0.010538006201386452, -0.006760942749679089, 0.04846727475523949, 0.025351647287607193, -0.003958362154662609, 0.024596234783530235, -0.02714953012764454, -0.040248382836580276, -0.0403994657099247, 0.019595403224229813, 0.043270036578178406, 0.00419253995642066, -0.01571258157491684, 0.020517006516456604, -0.001231322530657053, 0.005608938634395599, -0.03635045513510704, -0.04532475769519806, -0.028327973559498787, 0.03184819594025612, 0.039885785430669785, 0.005015939939767122, 0.015621933154761791, -0.031334515661001205, 0.020229950547218323, -0.06466332077980042, 0.0413966104388237, 0.012743811123073101, -0.010024325922131538, -0.09034734964370728, -0.027330828830599785, -0.033298589289188385, -0.009699498303234577, 0.03193884715437889, -0.0043813930824398994, 0.04511324316263199, -0.05363429710268974, -0.009427549317479134, 0.040731847286224365, -0.004079228267073631, 0.03338923677802086, -0.01021317858248949, 0.025487622246146202, -0.0015448188642039895, 0.030488453805446625, -0.007225521840155125, 0.02041124925017357, 0.010545560158789158, 0.0017450031591579318, -0.021982507780194283, 0.020728522911667824, -0.00410566758364439, 0.06532808393239975, 0.008128239773213863, -0.008362418040633202, 0.037861280143260956, -0.028751004487276077, 0.002239798428490758, -0.04855792224407196, -0.0071084327064454556, 0.014994940720498562, -0.024747317656874657, 0.034990713000297546, -0.05671637877821922, -0.04604995250701904, -0.04399523138999939, 0.007282177451997995, -0.04169877618551254, 0.001319139264523983, 0.027874724939465523, 0.005106589291244745, -0.0024664222728461027, 0.003108522854745388, 0.04825575649738312, 0.026907797902822495, 0.02672649919986725, -0.029355334118008614, 0.03338923677802086, -0.02855459786951542, 0.06689934432506561, 0.012600282207131386, -0.032815124839544296, 0.039885785430669785, -0.050763726234436035, -0.024173203855752945, -0.009495536796748638, -0.0026005080435425043, -0.020940037444233894, 0.04166856035590172, 0.0586804524064064, -0.06611371040344238, -0.053422778844833374, 0.0006699565565213561, 0.011550258845090866, -0.014398164115846157, -0.004891296848654747, -0.03187841176986694, 0.010711750946938992, 0.0048459721729159355, -0.017495356500148773, -0.017026999965310097, 0.01719319075345993, -0.05127741023898125, 0.003032981650903821, -0.036320239305496216, -0.004868634510785341, 0.015183793380856514, 0.02560848742723465, -0.0348094142973423, -0.05976824834942818, -0.013808942399919033, -0.04188007488846779, -0.012638052925467491, -0.013302816078066826, 0.02371995709836483, -0.031062567606568336, -0.039885785430669785, 0.014367948286235332, 0.04713774845004082, -0.033298589289188385, 0.01628669537603855, -0.018537824973464012, 0.05475230515003204, -0.03302663937211037, 0.037649765610694885, 0.01354454830288887, 0.00244753691367805, -0.0380425788462162, 0.026771822944283485, -0.025155240669846535, -0.06490505486726761, -0.03991600126028061, 0.020819172263145447, 0.02603151835501194, -0.009812809526920319, 0.02021484263241291, 0.0026911573950201273, 0.038979291915893555, -0.006927133537828922, 0.008521053940057755, 0.0028724565636366606, 0.017238516360521317, 0.058559585362672806, -0.04490172490477562, -0.008369971998035908, 0.005608938634395599, -0.05185152217745781, -0.0719757154583931, -0.037498682737350464, -0.0206378735601902, 0.008906315080821514, -0.0630316287279129, -0.03777063265442848, 0.008332201279699802, -0.023825714364647865, -0.048739220947027206, 0.0512169748544693, -0.014186648651957512, 0.008498392067849636, -0.0006392679060809314, -0.03949297219514847, -0.017223408445715904, -0.0023096741642802954, 0.016437778249382973, -0.00831709336489439, -0.05115654319524765, 0.0030745293479412794, 0.09590718895196915, 0.027240179479122162, 0.03130429983139038, -0.05517533794045448, 0.0893804207444191, 0.01790327951312065, 0.010855278931558132, -0.0011690009851008654, 0.027738751843571663, 0.022345105186104774, 0.015236672945320606, -0.06022149324417114, 0.03115321695804596, 0.02631857618689537, -0.018145011737942696, -0.007316171191632748, 0.0042378646321594715, -0.011059240438044071, 0.01606007292866707, -0.03411443531513214, 0.033298589289188385, 0.009654173627495766, -0.003372917417436838, 0.009034735150635242, 0.011081903241574764, -0.011059240438044071, 0.003939476795494556, 0.01069664303213358, 0.0016722946893423796, 0.05396667867898941, 0.01684570126235485, -0.010099866427481174, -0.02077384665608406, 0.010273611173033714, -0.04181964322924614, -0.016800377517938614, 0.036229588091373444, -0.012471862137317657, 0.04224267229437828, -0.028010699898004532, -0.020305491983890533, -0.03009563870728016, 0.010356706567108631, -0.03366118669509888, -0.010749521665275097, -0.01578812301158905, 0.023810606449842453, -0.00936711672693491, -0.03205971047282219, -0.03017118014395237, 0.03934188932180405, -0.018084578216075897, -0.036380670964717865, 0.03453746438026428, -0.043390899896621704, -0.044388044625520706, 0.019066615030169487, 0.03450724855065346, 0.04855792224407196, 0.006319026462733746, -0.03215036168694496, 0.002778030000627041, -0.06309206038713455, 0.0277840755879879, -0.025019265711307526, 0.009759930893778801, -0.008883652277290821, 0.018356526270508766, 0.002730816602706909, -0.002354998840019107, -0.0011029024608433247, 0.006455000955611467, -0.027814293280243874, -0.0008125407039187849, 0.006088625639677048, -4.7508372517768294e-05, 0.02279835194349289, -0.01571258157491684, -0.02597108669579029, -0.03193884715437889, -0.004354953765869141, 0.018401851877570152, -0.06732237339019775, -0.026681173592805862, 0.03964405506849289, 0.018688907846808434, -0.023840822279453278, 0.03955340385437012, -0.04408587887883186, -0.01146716345101595, 0.03997643664479256, 0.014231973327696323, -0.025804895907640457, 0.05191195383667946, 0.0045853545889258385, 0.0003333258209750056, -0.014179094694554806, -0.03411443531513214, 0.03354031965136528, -0.01318950392305851, -0.0010056430473923683, 0.0003472537500783801, -0.00841529667377472, 0.009132938459515572, 0.02042635716497898, 0.018839990720152855, 0.004891296848654747, -0.012471862137317657, 0.039674270898103714, 0.014662559144198895, -0.0056127156130969524, -0.01746514067053795, -0.04795359447598457, 0.026439441367983818, -0.027240179479122162, -0.020033542066812515, 0.030125854536890984, -0.012237684801220894, -0.004626902285963297, 0.04000665247440338, -0.02693801373243332, 0.004940398503094912, -0.021363068372011185, -0.0488600879907608, 0.05496382340788841, -0.06082582473754883, 0.030820835381746292, -0.027119312435388565, -0.024158095940947533, 0.0003474898112472147, -0.015078036114573479, -0.027209961786866188, 0.002375772688537836, 0.0020150630734860897, -0.0015089367516338825, 0.026711389422416687, 0.009911013767123222, -0.016891026869416237, -0.02610705979168415, 0.0032180577982217073, 0.04049011692404747, 0.03423529863357544, -0.028645247220993042, -0.06013084575533867, -0.05296953395009041, 0.04647298529744148, 0.05689767748117447, 0.026046626269817352, -0.058771103620529175, 0.03447703272104263, 0.0006005530594848096, 0.016891026869416237, -0.013529440388083458, -0.009314237162470818, 0.00629636412486434, 0.039613839238882065, 0.05085437744855881, 0.0146701131016016, -0.028675463050603867, -0.019414104521274567, -0.012275455519557, -0.009102721698582172, 0.031546030193567276, 0.05976824834942818, 0.01677015982568264, 0.01003943383693695, -0.018492501229047775, 0.0006638188497163355, -0.008611704222857952, 0.04287721961736679, 0.0028800105210393667, 0.07499736547470093, -0.027406370267271996, -0.013514331541955471, -0.037649765610694885, 0.00996389240026474, 0.013423682190477848, -0.03607850521802902, -0.0003734571218956262, 0.007274623494595289, -0.009125384502112865, 0.009004518389701843, -0.034205082803964615, -0.012539849616587162, -0.01867379993200302, 0.038072794675827026, 0.010621101595461369, 0.02659052424132824, -0.010175407864153385, -0.011603137478232384, -0.012456754222512245, 0.002821466187015176, 0.009344453923404217, 0.02940065972507, 0.014707883819937706, -0.03387270122766495, -0.05173065513372421, 0.018009036779403687, 0.02468688413500786, 0.007025337312370539, 0.005416308529675007, 0.023327142000198364, 0.0097901476547122, 0.00943510327488184, -0.04000665247440338, 0.01986735127866268, 0.033359020948410034, 0.039190806448459625, 0.05200260505080223, 0.004264304414391518, -0.04695644974708557, -0.014889182522892952, -0.04580822214484215, 0.0008706130320206285, 0.006930910982191563, 0.022496188059449196, 0.023251600563526154, 0.019278129562735558, 0.045566488057374954, -0.005355875473469496, 0.03323815390467644, -0.009895904920995235, 0.021635018289089203, -0.008528608828783035, 0.031183432787656784, -0.019051507115364075, 0.05849915370345116, 0.03644110634922981, 0.023176059126853943, -0.0298992320895195, -0.03958361968398094, -0.06242729723453522, -0.03937210515141487, 0.04765142872929573, 0.013219720683991909, -0.0239314716309309, 0.02406744658946991, -0.010470018722116947, 0.013340586796402931, 0.033933136612176895, 0.025034373626112938, -0.0589221827685833, 0.01399779599159956, 0.012267900630831718, 0.016785267740488052, 0.05200260505080223, -0.01031138189136982, -0.06405898928642273, 0.015878772363066673, -0.0029952109325677156, -0.022783244028687477, -0.005091480910778046, -0.025487622246146202, 0.021801209077239037, -0.01259272824972868, -0.030412912368774414, 0.03199927881360054, -0.008966747671365738, -0.03801236301660538, -0.05852936953306198, 0.057230059057474136, -0.00271004275418818, -0.00806780718266964, -0.03275468945503235, 0.09663238376379013, -0.03142516314983368, 0.006779828108847141, 0.018960855901241302, -0.003591987071558833, -0.014307514764368534, -0.024173203855752945, -0.033570535480976105, -0.007561680395156145, 0.033087071031332016, -0.010424694046378136, 0.016528427600860596, 0.02666606567800045, 0.026363899931311607, -0.009148046374320984, -0.011958181858062744, 0.004864857066422701, 0.01838674396276474, -0.005023493897169828, 0.02477753348648548, 0.04647298529744148, -0.031062567606568336, 0.015055373311042786, -0.020048651844263077, 0.033359020948410034, 0.01154270488768816, 0.06859146803617477, 0.01452658511698246, -0.009646618738770485, 0.09494026005268097, 0.008090469054877758, 0.017419815063476562, 0.004811978433281183, -0.005624047014862299, 0.02281346172094345, -0.044176530092954636, 0.004373839125037193, -0.019882461056113243, 0.04257505387067795, -0.02231488935649395, -0.035262662917375565, -0.017495356500148773, -0.0057298047468066216, -0.022284671664237976, 0.006073517259210348, 0.016180938109755516, -0.02757256105542183, 0.04100379720330238, 0.0008677802397869527, 0.005862001795321703, 0.06732237339019775, 0.003758177859708667, 0.0034087994135916233, -0.004540029913187027, -0.012260346673429012, -0.0070479996502399445, -0.0002785584074445069, -0.004861080087721348, -0.033570535480976105, 0.04181964322924614, -0.02541208080947399, 0.022088265046477318, -0.015312213450670242, 0.015055373311042786, 0.0021699226927012205, -0.051670223474502563, -0.008347309194505215, 0.003939476795494556, -0.021000470966100693, -0.007304840255528688, -0.03079061768949032, -0.09675324708223343, -0.028327973559498787, -0.011180106550455093, 0.03073018603026867, 0.003890374908223748, -0.004709997680038214, 0.053422778844833374, -0.05852936953306198, -0.005676925648003817, -0.04112466424703598, -0.028962519019842148, -0.022858785465359688, -0.0010424694046378136, -0.02924957685172558, 0.002759144641458988, -0.0030140962917357683, 0.03910015895962715, -0.007202859502285719, 0.015040265396237373, 0.024324286729097366, -0.018900424242019653, -0.020154409110546112, 0.04429739713668823, 0.010658872313797474, -0.03885842487215996, 0.0055787223391234875, -0.0249890498816967, 0.00559760769829154, 0.013416128233075142, 0.027980484068393707, -0.031817980110645294, -0.004709997680038214, -0.001128397649154067, 0.010923266410827637, 0.0040565659292042255, -0.0008035701466724277, -6.916746497154236e-05, -0.023599090054631233, -0.0034106879029423, -0.007078216411173344, 0.03761954978108406, -0.015818340703845024, 0.015621933154761791, -0.01627158746123314, 0.0007365273195318878, 0.023750172927975655, 0.024792641401290894, 0.013740955851972103, -0.04308873414993286, -0.003882820950821042, 0.005457856226712465, 0.011671124957501888, 0.0041434383019804955, -0.017873061820864677, -0.03822387754917145, -0.0038450502324849367, -0.01557660847902298, -0.0467449314892292, 0.005744913127273321, 0.02856970578432083, -0.0044418261386454105, -0.04553627222776413, -0.008400188758969307, 0.0031746216118335724, 0.005824231076985598, -0.025578271597623825, 0.019247913733124733, -0.07560169696807861, 0.00813579373061657, 0.01476831641048193, -0.01719319075345993, -0.05296953395009041, -0.015516174957156181, 0.026197709143161774, -0.027889834716916084, -0.03130429983139038, -0.003255828283727169, 0.0014721103943884373, 0.00647388631477952, -0.00040202116360887885, 0.015251780860126019, 0.04320960119366646, -0.006500325631350279, -0.014322623610496521, 0.03456768020987511, 0.029143819585442543, -0.027980484068393707, -0.0360482893884182, -0.007810966577380896, -0.010334044694900513, -0.021710557863116264, 0.040520332753658295, -0.016875917091965675, 0.019489645957946777, -0.005661817733198404, -0.0047893160954117775, 0.0012483194004744291, 0.02595597691833973, -0.004400278441607952, -0.0011642796453088522, -0.014201757498085499, 0.00690824817866087, -0.010802400298416615, -0.04245419055223465, -0.03728716820478439, 0.010961037129163742, -0.004064119886606932, -0.010371815413236618, 0.009057397022843361, 0.00023819104535505176, 0.03888864070177078, 0.007319948170334101, -0.010711750946938992, 0.011708895675837994, 0.0026798262260854244, 0.0031557362526655197, -0.020864496007561684, 0.021302636712789536, 0.014896736480295658, -0.0008021537796594203, -0.00192158087156713, -0.010628655552864075, -0.019142156466841698, -0.028327973559498787, -0.026696281507611275, 0.061218637973070145, -0.0074030435644090176, 0.02160480059683323, -0.01451903022825718, 0.00515569094568491, -0.002502304269000888, -0.006878031883388758, 0.010001663118600845, -0.022224240005016327, -0.022556621581315994, -0.017011892050504684, 0.021937182173132896, -0.016785267740488052, 0.02370484732091427, 0.014738100580871105, 0.008521053940057755, -0.008332201279699802, -0.0006874254904687405, -0.025517838075757027, 0.019142156466841698, 0.03635045513510704, -0.005454079248011112, 0.006243485491722822, 0.02468688413500786, -0.012675823643803596, -0.04260527342557907, -0.0038790437392890453, -0.023100517690181732, -0.04632190242409706, 0.013476560823619366, -0.031062567606568336, -0.029445983469486237, 0.006394567899405956, 0.02716463804244995, 0.05390624329447746, -0.0004794509441126138, 0.030065422877669334, 0.012086601927876472, 0.021937182173132896, -9.655117901274934e-05, 0.016029855236411095, -0.01985224336385727, 0.023478224873542786, -0.008906315080821514, -0.012207468040287495, 0.0380425788462162, -0.006564535666257143, -0.043481551110744476, -0.010553114116191864, 0.007735425140708685, -0.020154409110546112, -0.02335735782980919, -0.013423682190477848, -0.013317924924194813, 0.01126320194453001, 0.032815124839544296, 0.051821306347846985, -0.0003680275985971093, 0.014111108146607876, 0.00236066454090178, -0.010160299949347973, 0.006832707207649946, -0.006390790920704603, -0.0041434383019804955, 0.029838798567652702, -0.0068138218484818935, 0.014103553257882595, -0.05173065513372421, -0.03529287874698639, 0.008173564448952675, -0.021635018289089203, -0.010356706567108631, -0.0026420557405799627, -0.01182220783084631, 0.007573011331260204, 0.04435782879590988, -0.02279835194349289, 0.02841862291097641, -0.0029819912742823362, 0.01059088483452797, 0.02518545649945736, -0.017434922978281975, -0.01719319075345993, 0.01929323747754097, -0.0011331188725307584, 0.012207468040287495, -0.013975133188068867, -0.007878953590989113, 0.01213948056101799, -0.03163668140769005, -0.04215202480554581, 0.017857953906059265, 0.02582000382244587, 0.02210337296128273, -0.007901616394519806, 0.02968771569430828, 0.013899591751396656, -0.006175498012453318, -0.027179745957255363, 0.01547085028141737, -0.02104579471051693, 0.004502259194850922, 0.018054362386465073, 0.003514557145535946, 0.038405176252126694, 0.011852423660457134, 0.005692034028470516, -5.0901828217320144e-05, -0.007142426446080208, 0.0325733907520771, -0.025804895907640457, -0.0030631981790065765, 0.008770340122282505, 0.0014211200177669525, -0.02202783152461052, -0.017993928864598274, 0.018779557198286057, 0.013000651262700558, 0.018719125539064407, 0.010938374325633049, 0.008770340122282505, 0.0013285819441080093, 0.03619937226176262, -0.008589041419327259, 0.009200925938785076, -0.016785267740488052, -0.00384882721118629, 0.02597108669579029, -0.010787292383611202, 0.017162974923849106, -0.010175407864153385, -0.008392633870244026, -0.017873061820864677, -0.0059299892745912075, -0.017162974923849106, 0.032664041966199875, -0.02322138473391533, -0.02420341968536377, -0.025940869003534317, 0.003338923677802086, 0.0027364823035895824, -0.015606824308633804, -0.0036675282754004, 0.02441493608057499, -0.010583330877125263, -0.1562797576189041, -0.004944175481796265, 0.021302636712789536, 0.009797701612114906, 0.013129071332514286, -0.008513499982655048, 0.015803232789039612, 0.05481274053454399, 0.005163245368748903, -0.00471755163744092, -0.03086615912616253, -0.01732916571199894, 0.004260526970028877, -0.0092613585293293, -0.012116818688809872, 0.0026042850222438574, 0.0007110321312211454, -0.0522141195833683, 0.015425525605678558, -0.003108522854745388, 0.008075361140072346, -0.02526099793612957, 0.027028663083910942, -0.018764449283480644, -0.015773015096783638, -0.02090982161462307, -0.009465320035815239, 0.02385593019425869, -0.036531753838062286, 0.027330828830599785, -0.00575624406337738, -0.05306018143892288, -0.0036996332928538322, -0.0016449110116809607, -0.019882461056113243, -0.04580822214484215, -0.011112120002508163, -0.02772364392876625, 0.0017912721959874034, 0.027602776885032654, 0.011754220351576805, -0.04913203790783882, 0.017450030893087387, -0.0024229860864579678, -0.00944265816360712, -0.006413453258574009, 0.010538006201386452, -0.008770340122282505, 0.008324647322297096, -0.015417971648275852, -0.00027596167637966573, -0.001837541232816875, 0.014715437777340412, -0.039674270898103714, -0.039402320981025696, 0.0024343172553926706, -0.015108251944184303, 0.02027527429163456, 0.016785267740488052, 0.04133617877960205, -0.00499705458059907, -0.0019140266813337803, 0.004158546682447195, -0.011429392732679844, -0.004777984693646431, -0.04780251160264015, 0.022360213100910187, 0.001826210063882172, -0.032029494643211365, -0.022058049216866493, -0.014201757498085499, -0.023417791351675987, -0.006685401778668165, 0.015040265396237373, -0.01427729893475771, 0.01252474170178175, 0.025563163682818413, 0.012003506533801556, -0.03136473149061203, 0.030820835381746292, 0.03511158004403114, -0.024822859093546867, 0.008166010491549969, 0.01501760259270668, 0.02772364392876625, 0.02856970578432083, -0.0003420602879486978, 0.015025156550109386, -0.04843705892562866, 0.03233166038990021, 0.052878882735967636, -0.0027836954686790705, 0.005831785500049591, 0.016014747321605682, -0.0325733907520771, -0.01725362427532673, 0.0018233772134408355, 0.004759099334478378, 0.0027043772861361504, 0.0076032280921936035, 0.032603610306978226, 0.010364261455833912, -0.058771103620529175, -0.03994622081518173, -0.002375772688537836, 0.035897206515073776, -0.017178082838654518, 0.01879466511309147, 0.010099866427481174, -0.0008030980243347585, 0.02953663282096386, -0.01101391576230526, -0.0013361360179260373, 0.017072325572371483, -0.009752376936376095, 0.03450724855065346, 0.048376623541116714, 0.0011387845734134316, 0.02974814921617508, 0.011550258845090866, 0.008279322646558285, 0.013529440388083458, -0.024717101827263832, 0.002458868082612753, -0.04124552756547928, 0.0009376559173688293, 0.020245058462023735, 0.021151553839445114, 0.019263021647930145, -0.051398273557424545, 0.005223678424954414, 0.02316095121204853, -0.004827086813747883, 0.028599921613931656, 0.027330828830599785, -0.0061075109988451, 0.018930640071630478, 0.05375516042113304, -0.04499237611889839, 0.025925761088728905, 0.001853593741543591, 0.0035258883144706488, 0.04215202480554581, 7.259043195517734e-05, -0.03242230787873268, -0.001439061015844345, 0.02391636371612549, -0.00023689267982263118, -0.03922102227807045, 0.0234328992664814, 0.011678678914904594, -0.004415386822074652, -0.014896736480295658, -0.01606007292866707, 0.012532295659184456, 0.004857303109019995, 0.004215202294290066, -0.029234468936920166, 0.012048831209540367, 0.0026514981873333454, -0.011051686480641365, 0.016785267740488052, -0.04889030382037163, -0.015198902226984501, 0.002978214295580983, -0.030563995242118835, -0.004600462969392538, -0.026001302525401115, -0.027557453140616417, 0.015289551578462124, -0.04109444469213486, -0.06363596022129059, 0.030428020283579826, -0.028116457164287567, 0.030080530792474747, 0.03683391958475113, 0.015448188409209251, 0.019398996606469154, 0.036531753838062286, 0.02406744658946991, 0.008196227252483368, 0.004067896865308285, -0.008928976953029633, 0.010877941735088825, 0.009472873993217945, -0.04360241815447807, -0.002047168090939522, 0.008120685815811157, -0.019187480211257935, 0.006103734020143747, 0.026499874889850616, 0.047258611768484116, 0.01732916571199894, 0.014926953241229057, 0.02433939464390278, -0.017646439373493195, 0.0413966104388237, 0.026650957763195038, 0.01161824632436037, -0.011172552593052387, -0.05889196693897247, 0.043541982769966125, 0.0030613096896559, 0.008505946025252342, -0.021030686795711517, 0.030276937410235405, 0.03474897891283035, -0.0027006000746041536, -0.031546030193567276, 0.03073018603026867, -0.03009563870728016, -0.001650576596148312, -0.037861280143260956, 0.0025816226843744516, -0.0008026259019970894, 0.009903459809720516, 0.011029024608433247, 0.01950475387275219, -0.003935699816793203, -0.03354031965136528, -0.055598367005586624, -0.01615072228014469, -0.023448007181286812, -0.02225445583462715, -0.025910653173923492, 0.015093144029378891, 0.027104204520583153, 0.025653813034296036, -0.01547085028141737, -0.00717264274135232, -0.0066627394407987595, 0.01754068024456501, 0.008075361140072346, 0.010175407864153385, -0.0007761864690110087, -0.005004608538001776, 0.009110276587307453, -0.004113221541047096, 0.01407333742827177, 0.035262662917375565, 0.03535331040620804, -0.013340586796402931, 0.00824155192822218, -0.021589692682027817, -0.015516174957156181, -0.04260527342557907, -0.00376195483841002, 0.049101822078228, -0.010704196989536285, 0.0022907888051122427, -0.009608848951756954, 0.02239043079316616, 0.03438638150691986, 7.979045767569914e-05, 0.024822859093546867, -0.0023625530302524567, 0.0004461655917111784, 0.03317772224545479, 0.016256479546427727, 0.028886979445815086, -0.0022700149565935135, 0.012653161771595478, 0.004324737470597029, -0.0316971130669117, -0.023040084168314934, -0.017857953906059265, -0.032241009175777435, 0.004015018232166767, 0.03795193135738373, -0.004974392242729664, 0.0146701131016016, -0.001821488724090159, 0.01711764931678772, 0.0020339484326541424, 0.007607005070894957, 0.007826074957847595, -0.010893049649894238, -0.024535801261663437, 0.02414298802614212, -0.014821195974946022, -0.029581958428025246, -0.015032711438834667, 0.028327973559498787, -0.0041434383019804955, 0.020245058462023735, -0.021786099299788475, 0.006828930228948593, -0.015833448618650436, -0.0015882550505921245, -0.004328514449298382, 0.026711389422416687, -0.028781220316886902, 0.0017808852717280388, 0.006522987969219685, -0.021514151245355606, -0.022768136113882065, 0.037710197269916534, -0.0002075024094665423, 0.027799183502793312, -0.014269744046032429, 0.006330357864499092, 0.015085590071976185, 0.00951064471155405, -0.0293402262032032, -0.0060206386260688305, 0.012003506533801556, 0.004430495202541351, -0.02926468476653099, -0.03163668140769005, -0.011565366759896278, 0.005363429430872202, 0.04296787083148956, -0.00013184310228098184, -0.0034295732621103525, 0.004634456243366003, -0.009707052260637283, -0.016875917091965675, -0.01888531632721424, 0.03671305254101753, -0.01252474170178175, -0.0185227170586586, 0.001829042797908187, 0.027134422212839127, -0.019761594012379646, -0.004963060840964317, 0.01340102031826973, 0.003535330994054675, -0.006976235657930374, 0.013242383487522602, 0.027270395308732986, 0.018205443397164345, -0.017072325572371483, 0.025366755202412605, 0.00813579373061657, -0.0007143370457924902, -0.01462478842586279, -0.022209130227565765, 0.021801209077239037, -0.01888531632721424, -0.026363899931311607, 0.026016410440206528, 0.007886507548391819, 0.004913959186524153, 0.023735065013170242, -0.017782412469387054, 0.02911360189318657, 0.0015599270118400455, 0.01544063352048397, 0.008437958545982838, -0.004302074667066336, 0.08877608925104141, -0.026258142665028572, -0.0391605906188488, 0.009699498303234577, 0.020018434152007103, -0.004332291427999735, 0.019686052575707436, -0.04623125120997429, -0.020320599898695946, 0.009359562769532204, -0.005831785500049591, 0.024898400530219078, -0.0003179814957547933, 0.003811056725680828, 0.0022020277101546526, -0.01648310385644436, -0.006016861647367477, 0.018930640071630478, 0.012864677235484123, 0.03459789976477623, 0.034205082803964615, 0.03780084848403931, -0.0025684027932584286, -0.007878953590989113, -0.014987386763095856, 0.0006595696322619915, 0.015833448618650436, 0.03843539580702782, 0.002371995709836483, 0.03734759986400604, 0.0032501628156751394, -0.012056385166943073, -0.04360241815447807, 0.004041457548737526, -0.009880797006189823, 0.02468688413500786, 0.011391622014343739, 0.040671415627002716, -0.02714953012764454, -0.013839159160852432, 0.013620089739561081, 0.019489645957946777, 0.01504781935364008, -0.007803412154316902, 0.005182130727916956, 0.027874724939465523, 0.002519301138818264, -0.0019187480211257935, 0.022692594677209854, -0.014685221016407013, 0.005608938634395599, -0.0043813930824398994, 0.044599562883377075, -0.013310370035469532, -0.001534431939944625, -0.04000665247440338, -0.019973110407590866, 0.01930834725499153, 0.011527596972882748, -0.011807098984718323, -0.058408502489328384, 0.028675463050603867, -0.007946941070258617, -0.003399356734007597, -0.01879466511309147, -0.05148892477154732, -0.016090288758277893, 0.031122999265789986, -0.01887020654976368, 0.02421852946281433, -0.038495827466249466, -0.002390880836173892, -0.018537824973464012, 0.010303827933967113, 0.021453717723488808, 0.020804064348340034, 0.007505024317651987, -0.004634456243366003, 0.030639536678791046, 0.040580764412879944, 0.01069664303213358, -0.025351647287607193, -0.0413966104388237, -0.01648310385644436, 0.013846713118255138, 0.013876929879188538, 0.03867712616920471, 0.019610511139035225, 0.008203781209886074, 0.020894713699817657, -0.009019626304507256, -0.002889453200623393, 0.015803232789039612, -0.005707142408937216, 0.007138649467378855, -0.03822387754917145, 0.015319768339395523, -0.01837163418531418, 0.001626025652512908, -0.0056731486693024635, 0.008672136813402176, -0.020652981474995613, -0.03613894060254097, -0.026122167706489563, -0.04245419055223465, -0.0016496323514729738, -0.04958528280258179, -0.009110276587307453, 0.01565214991569519, 0.023976797237992287, 0.024958832189440727, -0.030352478846907616, 0.012350996024906635, 0.018991073593497276, 0.00594509718939662, 0.0004034375597257167, 0.010205624625086784, 0.029506416991353035, 0.025427188724279404, -0.04695644974708557, 0.023946579545736313, 0.0021151553373783827, 0.02420341968536377, 0.027209961786866188, -0.019187480211257935, 0.009064950980246067, -0.030125854536890984, 0.01259272824972868, 0.01936877891421318, -0.015757907181978226, -0.02308540977537632, 0.010273611173033714, -0.017933495342731476, 0.019534969702363014, 0.005933766253292561, -0.0116862328723073, 0.01690613478422165, -0.014352839440107346, -0.019534969702363014, -0.0011189549695700407, 0.01867379993200302, 0.017026999965310097, -0.029521524906158447, 0.006598529405891895, 0.00496683781966567, 0.03341945260763168, -0.002354998840019107, -0.007229298818856478, 0.0017771081766113639, -0.009246250614523888, -0.009895904920995235, -0.010711750946938992, -0.007810966577380896, 0.02146882750093937, -0.019806919619441032, 0.013204612769186497, 0.0014957169769331813, 0.019383888691663742, 0.01108945719897747, -0.01294777262955904, 0.002398435026407242, -0.0034257962834089994, -0.017993928864598274, 0.030080530792474747, 0.052032820880413055, 0.010681534186005592, -0.015501067042350769, 0.0092613585293293, 0.01909683085978031, -0.016105396673083305, -0.02751212753355503, 0.0017676654970273376, 0.015621933154761791, 0.003144405083730817, -0.0073350565508008, -0.023765280842781067, -0.023538656532764435, 0.01207149401307106, 0.01986735127866268, 0.021801209077239037, 0.018779557198286057, -0.026424333453178406, 0.054842956364154816, -0.010991253890097141, -0.01565214991569519, 0.01593920588493347, 0.0011104565346613526, 0.0038469387218356133, -0.0068138218484818935, 0.001251152134500444, 0.017087433487176895, -0.0033804713748395443, -0.011852423660457134, 0.004328514449298382, 0.008453067392110825, 0.007138649467378855, -0.025593379512429237, 0.010402032174170017, 0.026197709143161774, 0.02075873874127865, -0.0015457631088793278, -0.004506036173552275, 0.04299808666110039, -0.007731648162007332, -0.013975133188068867, 0.024248745292425156, -0.03187841176986694, 0.0076598841696977615, -0.0014031789032742381, -0.026227926835417747, 0.006421007215976715, -0.021922074258327484, 0.0403994657099247, 0.040248382836580276, 0.025276105850934982, -0.009110276587307453, 0.007607005070894957, 0.0004487623227760196, -0.03523244336247444, -0.04958528280258179, 0.0014324511867016554, 0.0022341327276080847, 0.0031632904428988695, 0.02258683741092682, 0.014390610158443451, 0.018129901960492134, -0.0017119538970291615, -0.017344273626804352, -0.011353851296007633, 0.02246597222983837, -0.0064587779343128204, -0.006190606392920017, 0.0032539397943764925, 0.007440814282745123, 0.0030386473517864943, -0.022148698568344116, 0.015984531491994858, -0.006243485491722822, 0.002156703034415841, -0.003291710512712598, -0.023266708478331566, 0.056867461651563644, 0.014534139074385166, -0.004336068406701088, -0.012283009476959705, 0.04825575649738312, -0.009102721698582172, -0.005465410184115171, -0.016180938109755516, 0.012041277252137661, 0.02820710651576519, 0.02541208080947399, -0.010084758512675762, -0.029989881440997124, -0.002764810109511018, -0.034900061786174774, -0.031334515661001205, -0.014239528216421604, -0.014103553257882595, 0.011104565113782883, 0.003252051305025816, 0.005650486331433058, 0.007123541086912155, 0.04323981702327728, -0.018552934750914574, 0.0014551135245710611, 0.0034031339455395937, 0.009027181193232536, -0.016316913068294525, 0.0013455786975100636, -0.020955145359039307, 0.006054632365703583, -0.007818521000444889, -0.013703185133635998, 0.04169877618551254, 0.0015533171826973557, 0.021423501893877983, -0.013106408528983593, 0.024082554504275322, 0.005008385516703129, 0.03305685520172119, 0.023342249915003777, -0.02202783152461052, -0.02210337296128273, 0.019534969702363014, -0.00831709336489439, -0.03366118669509888, 0.002781806979328394, -0.004891296848654747, 0.0014617234701290727, -0.005053710658103228, 0.006235931068658829, 0.016543535515666008, -0.01985224336385727, -0.0024928615894168615, 0.013431236147880554, 0.0073350565508008, -0.018583150580525398, 0.02595597691833973, 0.023100517690181732, -0.010054541751742363, -0.004124552942812443, 0.011980843730270863, 0.03130429983139038, 0.011180106550455093, 0.025230782106518745, -0.02468688413500786, 0.04511324316263199, 0.01232078019529581, -0.008264213800430298, -0.02035081572830677, -0.002415431896224618, 0.00498194620013237, -0.009956338442862034, 0.006451223976910114, 0.013990242034196854, 0.0025816226843744516, 0.0002075024094665423, -0.02595597691833973, 0.028509272262454033, 0.009775039739906788, 0.027406370267271996, -0.013831605203449726, -0.0018498166464269161, 0.022828569635748863, -0.035957641899585724, 0.00040603429079055786, 0.008226443082094193, 0.010009217076003551, -0.0009277411154471338, 0.04203115776181221, -0.017434922978281975, 0.02618260122835636, -0.00707066198810935, 0.003981024492532015, -0.002579734195023775, 0.015606824308633804, 0.005053710658103228, 0.0033540320582687855, -0.024369610473513603, -0.01578812301158905, 0.023312034085392952, 0.0043813930824398994, -0.005457856226712465, -0.00463067926466465, 0.00841529667377472, -0.06297119706869125, 0.004022572189569473, -0.024233637377619743, -0.012615391053259373, 0.03341945260763168, 0.029234468936920166, 0.02125731110572815, 0.0019754040986299515, 0.000585916917771101, 0.02532143145799637, 0.01231322530657053, 0.003208615118637681, -0.028871869668364525, -0.014692775905132294, -0.015380200929939747, -0.02350844070315361, 0.0031123000662773848, -0.008928976953029633, -0.0006822320283390582, 0.019534969702363014, -0.00192158087156713, -0.0054314169101417065, 0.012849568389356136, 0.05496382340788841, -0.013234829530119896, 0.00445693451911211, 0.024520693346858025, -0.02547251433134079, -0.00996389240026474, 0.032603610306978226, -0.041366394609212875, -0.025230782106518745, 0.00619438337162137, 0.012109264731407166, 0.014269744046032429, -0.01670972630381584, 0.024581126868724823, -0.009397332556545734, -0.011920411139726639, 0.024898400530219078, -0.04260527342557907, -0.0041472152806818485, 0.007357718888670206]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
"ity: 49.39
·{·""reasoning"":·""I·don’t·know·who·Thomas ·Chap
ais·is. . .
(3) Output with Naturalized Template Perplexity: 4.17
·{·""reasoning"":⇝·""I·don’t·know·him""·}
Figure 2. Template-based tokens, marked as , force unnatural
tokenization and formatting, which can lead to different outputs
and increased perplexity. Gray boxes represent vocabulary tokens,
hue is proportional to perplexity.
tion also has its downside, as discussed next.
Template-Induced Misalignment To insert templated to-
kens without invoking the model, an external tokenizer has
to be used to translate template text into tokens. We show-
case this in Fig. 2, where we use the template-based GUID -
ANCE with Mistral-7B , to generate text in JSON format,
and compare it to unconstrained generation. (1a) and (1b)
already show that depending on the concrete phrasing of
a template (e.g., whitespace, formatting), output can vary
significantly. To compare to unconstrained generation, we
use the model to also generate the template text, but without
imposing a fixed tokenization (algorithm in App. B). We
then generate output with this naturalized template (3) to
contrast it with template-induced tokenization.
Overall, template-based outputs exhibit clearly different
outputs and much higher perplexities (perplexities 24.50−
26.75), when compared to unconstrained generation (per-
plexity 4.17). Further, we observe that naturalizing the full
template-based output under the model-preferred tokeniza-
tion (2) in Fig. 2, results in a form of perplexity explosion
(49.39), indicating that without invasive constraining, the
model is highly unlikely to generate such output. While
perplexity and output differences are not directly indicative
of output quality, our evaluation in §4.1 extends on this
experiment, and indeed shows that invasive template-based
generation can lead to a significant drop in task accuracy,
compared to unconstrained and less invasive approaches.
Token Healing To reduce the impact of template-induced
misalignment, GUIDANCE implements token healing (Lund-
berg & Ribeiro), a method that attempts to improve tok-
enization at the transition points between templated and
3
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
non-templated tokens. Token healing truncates the prompt
to the second-to-last token boundary, and enforces the rest
of the prompt as a prefix on generation. This can be effec-
tive at avoiding some tokenization issues and integrating
bridge tokens, yet, most templated tokens remain fixed as
demonstrated in Fig. 2, where token healing is already in
effect, and still leads to significant differences in output.
Key Challenge This section, as summarized in Table 1,
demonstrates that the key challenge in constrained decod-
ing is to find a method that allows i) expressivity for regex,
context-free grammars and templated decoding, ii) is min-
imally invasive in all settings and iii) has low inference
overhead. Next, we discuss DOMINO , a novel constrained
decoding algorithm, that fits these requirements.
3. Efficient Aligned Constrained Decoding
In this section, we address the above challenges by introduc-
ingDOMINO , a fast minimally-invasive constrained decod-
ing algorithm, showcased in Fig. 3. First, §3.1 discusses the
necessary preliminaries. Then, in §3.2-§3.5 we present the
main algorithm and then discuss further details.
3.1. Preliminaries
Formal Languages A formal language is a set Lof finite
strings over a given alphabet Σ. A language is called regular
if it can be described by a regular expression. A language is
context-free if it can be described by a context-free grammar
(CFG). Such a grammar is described by a set of production
rules A=αBγ , where upper case names ( A,B) are non-
terminals that are recursively extended and lower case greek
characters (e.g., α,β) are terminals that are part of the
language. For an example, see the grammar in Fig. 3 (a),
with the non-terminal Eand terminals int,(,),+, which
are defined either by a regex or a literal string.
All regular languages can be recognized by a non-
deterministic finite automata (NFA). A NFA is a set of states
with a start","[0.022280585020780563, 0.040985602885484695, 0.04344046860933304, 0.029271619394421577, 0.009399204514920712, 0.010666663758456707, -0.0026599951088428497, -0.0010173021582886577, -0.012527826242148876, 0.06521407514810562, 0.0389309860765934, 0.030632469803094864, 0.003161975182592869, 0.0025682710111141205, 0.010746713727712631, -0.006223888136446476, 0.040185101330280304, -0.006544088013470173, -0.0018594949506223202, 0.060891371220350266, 0.058543238788843155, -0.006584112998098135, 0.003565560793504119, 0.04725618660449982, 0.002978527219966054, 0.024201786145567894, -0.01702396757900715, 0.048883870244026184, 0.03903771936893463, -0.0097727719694376, 0.03025890327990055, -0.03129955381155014, 0.007311233785003424, -0.027670618146657944, 0.039598070085048676, 0.04632227122783661, 0.021773600950837135, -0.009919529780745506, -0.0051165297627449036, 0.009512608870863914, -0.012381067499518394, -0.023134451359510422, -0.03460828587412834, -0.015196159482002258, 0.01833145134150982, 0.0453883521258831, -0.013375021517276764, 0.026816751807928085, -0.025762761011719704, 0.01999915950000286, -0.04773648828268051, 0.02302771806716919, 0.014288926497101784, 0.022961009293794632, -0.0882684737443924, -0.0040025003254413605, -0.02745715156197548, 0.0026616626419126987, 0.023321235552430153, -0.012567850761115551, 0.035755667835474014, -0.035755667835474014, 0.018184693530201912, 0.0386107861995697, -0.02381487749516964, 0.025602661073207855, -0.034554921090602875, -0.002353136660531163, 0.006450696382671595, 0.025442561134696007, -0.0041425880044698715, 0.024055026471614838, 0.004672918934375048, -0.022894302383065224, -0.022840935736894608, 0.01678381860256195, -0.0018911814549937844, 0.06884300708770752, 0.013121530413627625, -0.016023343428969383, 0.013982067815959454, -0.038557421416044235, 0.025829467922449112, -0.07946297526359558, 0.01399540901184082, -0.003789033740758896, -0.00693099619820714, 0.00523660471662879, -0.06574773788452148, -0.054273903369903564, -0.0472828708589077, -0.008745463564991951, -0.04765643551945686, 0.007658117450773716, -0.008331871591508389, 0.01559640932828188, -0.019398784264922142, -0.01930539309978485, 0.01763768494129181, 0.020559510216116905, 0.039331234991550446, -0.05571480467915535, 0.010713359341025352, -0.008678754791617393, 0.05486093834042549, 0.00289013865403831, -0.020306019112467766, 0.011313734576106071, -0.03119281865656376, -0.020452776923775673, -0.025349168106913567, -0.018638309091329575, -0.026456527411937714, 0.005873669404536486, 0.053073152899742126, -0.08159764111042023, -0.04669583588838577, 0.015102767385542393, 0.01861162669956684, -0.04338710382580757, -0.0016627053264528513, -0.006554094143211842, 0.020052526146173477, -0.016116734594106674, -0.017944542691111565, 0.016196785494685173, 0.03223346918821335, -0.007771521341055632, 0.031139452010393143, -0.03954470157623291, 0.017944542691111565, 0.002708358457311988, 0.01955888420343399, -0.038370635360479355, -0.0747133418917656, -0.003011881373822689, -0.040105052292346954, 0.00515321921557188, -0.011267038062214851, 0.03007211908698082, -0.004052531439810991, -0.032900553196668625, 0.013621842488646507, 0.04362725466489792, -0.036102551966905594, 0.012874709442257881, -0.0143422931432724, 0.017517609521746635, -0.038370635360479355, 0.042559921741485596, 0.027243684977293015, -0.013274959288537502, -0.04061203822493553, 0.02200040966272354, -0.0006091305403970182, -0.10566601157188416, -0.03935791924595833, 0.014062117785215378, 0.045415036380290985, 0.009012296795845032, 0.0010723365703597665, 0.01913195103406906, 0.026389818638563156, 0.007651446387171745, 0.01329497154802084, 0.01791786029934883, 0.021693551912903786, 0.04261328652501106, -0.07668790966272354, 0.0034755044616758823, -0.0034821752924472094, -0.0423998199403286, -0.06137167289853096, -0.033327486366033554, -0.02807086892426014, 0.011006875894963741, -0.0353020541369915, -0.04290680214762688, -0.005710233934223652, -0.018811751157045364, -0.0373566709458828, 0.034368135035037994, -0.007818217389285564, 0.0183581355959177, -0.03412798419594765, -0.005850321147590876, -0.023227844387292862, -0.0268701184540987, -0.004392744041979313, 0.01903855986893177, -0.020839685574173927, 0.017184067517518997, 0.0780220702290535, 0.018998535349965096, 0.04485468566417694, -0.04442775249481201, 0.07599414139986038, 0.01100020483136177, -0.009239104576408863, 0.019772350788116455, 0.020279334858059883, 0.0067375423386693, 0.023668117821216583, -0.041946202516555786, 0.008351883850991726, 0.022560760378837585, 0.0008534498047083616, -0.014142167754471302, 0.0009464245522394776, -0.01763768494129181, 0.014115484431385994, -0.038210537284612656, 0.02310776896774769, 0.010006250813603401, -0.007758179679512978, 0.027670618146657944, 0.008091721683740616, 0.006957679521292448, 0.033941201865673065, 0.03762350231409073, -0.029004786163568497, 0.04546840488910675, 0.03314070403575897, -0.005546798463910818, -0.047683119773864746, -0.008531996048986912, -0.020132577046751976, -0.012527826242148876, 0.02156013436615467, -0.017090676352381706, 0.03799707069993019, 0.009079004637897015, 0.0211999099701643, -0.005890346132218838, -0.0036089210771024227, -0.018825093284249306, -0.003552219131961465, -0.020879710093140602, 0.015769850462675095, -0.025589318946003914, -0.024842185899615288, -0.007958305068314075, 0.03615592047572136, -0.006720865145325661, -0.006183863151818514, 0.02791076898574829, -0.02452198602259159, -0.024441935122013092, 0.044881369918584824, 0.03319406881928444, 0.033407535403966904, -0.015489676035940647, -0.026469869539141655, 0.02450864389538765, -0.056195102632045746, 0.04690930247306824, -0.03279381990432739, 0.009752758778631687, -0.002925160573795438, 0.01722409389913082, -0.017410876229405403, 0.02075963467359543, -0.010519905015826225, 0.014915984123945236, -0.02964518591761589, -0.002211381448432803, -0.035675618797540665, 0.0368763692677021, 0.019612250849604607, -0.034715019166469574, -0.003046903293579817, -0.026963509619235992, -0.0008913901983760297, -0.005073169246315956, -0.06596120446920395, -0.06142503768205643, 0.014849276281893253, 0.020999785512685776, -0.026443185284733772, 0.037596818059682846, -0.01560975145548582, -0.025135701522231102, 0.04770980402827263, -0.007471333723515272, -0.023868244141340256, 0.042800068855285645, 0.00537002133205533, -0.027056902647018433, -0.01755763404071331, -0.034634970128536224, 0.014982692897319794, 0.030925985425710678, -0.008011671714484692, 0.011393784545361996, -0.019799035042524338, 0.005903687793761492, -0.007891596294939518, 0.020933076739311218, 0.00860537588596344, -0.011227013543248177, 0.009419217705726624, -0.009092346765100956, -0.00856535043567419, 0.005900352727621794, -0.030552418902516365, 0.004986448213458061, -0.024228468537330627, -0.0097727719694376, 0.05291305482387543, -0.008945588022470474, 0.02520241029560566, -0.009085675701498985, -0.010266412980854511, 0.027270369231700897, -0.028097551316022873, -0.03818385303020477, 0.04392077028751373, -0.029591819271445274, 0.020906392484903336, -0.021093176677823067, -0.034021250903606415, -0.021960385143756866, 0.013008126057684422, -0.01826474256813526, 0.017344167456030846, 0.03295391798019409, -0.018037933856248856, 0.032126735895872116, 0.003855742048472166, -0.050618287175893784, -0.026616627350449562, 0.017144042998552322, 0.06190533936023712, 0.03396788612008095, -0.011880755424499512, -0.05838313698768616, -0.03807711973786354, 0.06286593526601791, 0.023134451359510422, 0.04290680214762688, -0.0605178065598011, -0.006490721367299557, -0.01316822599619627, 0.004159264732152224, -0.014248901046812534, -0.006760890129953623, -0.024908892810344696, 0.013054821640253067, 0.05379360541701317, 0.03180653601884842, -0.015356259420514107, -0.02365477755665779, -0.002861787797883153, -0.0014925990253686905, 0.006070458795875311, 0.031513020396232605, 0.015623092651367188, -0.011854072101414204, -0.031779851764440536, 0.006390658672899008, -0.00729789212346077, 0.028391068801283836, 0.004526160657405853, 0.09541960805654526, -0.02382821775972843, 0.009585988707840443, -0.03716988489031792, 0.031139452010393143, 0.009239104576408863, -0.05539460480213165, -0.01598331704735756, 0.005490096285939217, 0.0019028553506359458, 0.009085675701498985, -0.058810070157051086, 0.004309358540922403, -0.018998535349965096, 0.028924735262989998, 0.001901187701150775, 0.029965385794639587, -0.002082967897877097, -0.04765643551945686, -0.011807375587522984, -0.006484050303697586, 0.025709394365549088, 0.017530951648950577, 0.00767145911231637, -0.03156638517975807, -0.03415466845035553, 0.02146674320101738, 0.015583068132400513, 0.01563643477857113, 0.005149883683770895, 0.027697302401065826, -0.0007538042264059186, 0.009252446703612804, -0.04704272001981735, 0.025162385776638985, 0.04517488554120064, 0.04242650419473648, 0.05293973907828331, 0.0011056907242164016, -0.037516769021749496, -0.052192602306604385, -0.002925160573795438, -0.0020879709627479315, 0.015009376220405102, 0.0006629141280427575, 0.02833770215511322, -0.0072311838157474995, 0.007531371433287859, -0.000470293773105368, 0.02224056050181389, 0.010006250813603401, -0.007591409143060446, -0.019785692915320396, 0.03148633614182472, -0.026283085346221924, 0.023321235552430153, 0.04226640239357948, 0.01782446727156639, -0.02780403569340706, -0.04909733682870865, -0.06425347179174423, -0.05424721911549568, 0.00787158403545618, 0.018411502242088318, -0.037756919860839844, -0.018758384510874748, -0.05806293711066246, 0.004589533898979425, 0.007791534066200256, 0.03319406881928444, -0.012634559534490108, 0.004716279450803995, 0.008145088329911232, 0.023588068783283234, 0.05387365445494652, -0.006814256776124239, -0.04891055449843407, 0.010239729657769203, -0.00032311852555722, 0.0010331453522667289, -0.04005168750882149, -0.03295391798019409, 0.013248275965452194, -0.04746965318918228, -0.04344046860933304, 0.023241184651851654, -0.03188658505678177, -0.01173399668186903, -0.016463618725538254, 0.04157263785600662, 0.003145298222079873, 0.0032320190221071243, -0.018211375921964645, 0.08373230695724487, -0.004499477334320545, 0.014809250831604004, 0.02189367637038231, -0.011400454677641392, -0.007624763064086437, -0.040825504809617996, -0.03650280460715294, -0.0304190032184124, 0.013835309073328972, -0.012387738563120365, 0.017397534102201462, 0.02485552616417408, 0.0032186773605644703, -0.02669667638838291, -0.002806753385812044, 0.0419195182621479, -0.017357509583234787, -0.029831968247890472, 0.0677756741642952, 0.04021178558468819, -0.048803821206092834, 0.022560760378837585, -0.019318735226988792, 0.023774851113557816, 0.0011623927857726812, 0.043760668486356735, 0.0025482585188001394, -0.02365477755665779, 0.0780220702290535, 0.03474170342087746, 0.009325825609266758, 0.00929914228618145, -0.012047525495290756, 0.0068843006156384945, -0.05008462071418762, 0.04005168750882149, -0.014795909635722637, 0.03370105102658272, -0.010459867306053638, -5.821344893774949e-05, -0.020386068150401115, 0.008978942409157753, -0.03407461941242218, -0.005516779609024525, 0.0051932442001998425, -0.04130580276250839, 0.053313303738832474, 0.009125701151788235, -0.014555759727954865, 0.05848987028002739, 0.01574316807091236, 0.00990618858486414, 0.0032253481913357973, 0.009632684290409088, -0.029831968247890472, 0.00514654815196991, -0.011086925864219666, -0.03949133679270744, 0.014328951016068459, -0.037410035729408264, 0.023681459948420525, -0.03335417062044144, -0.014275584369897842, 0.0002797580964397639, -0.036369387060403824, -0.021880334243178368, -0.0035155294463038445, -0.004379402380436659, 0.0067575545981526375, -0.03049905225634575, -0.09888844192028046, -0.01609005033969879, -0.006227223202586174, 0.04320032149553299, 0.0024398574605584145, -0.005166560877114534, 0.03586240112781525, -0.03210005164146423, -0.0011165308533236384, -0.013461742550134659, -0.013808625750243664, -0.019238684326410294, 0.007818217389285564, -0.019879084080457687, 0.0031903262715786695, 0.025589318946003914, 0.021680209785699844, 0.018278084695339203, 0.0021947042550891638, 0.009359179995954037, -0.007391283754259348, -0.01571648381650448, 0.04963100329041481, 0.003715654369443655, -0.0353020541369915, 0.010806750506162643, -0.03989158570766449, -0.006494056899100542, 0.011894096620380878, 0.0458686538040638, -0.018718359991908073, -0.00564686069265008, 0.01090681366622448, -0.01798456721007824, -0.003815717063844204, -0.02148008532822132, 0.00268167513422668, 0.003662287723273039, 0.03716988489031792, -0.010633309371769428, 0.01472920086234808, -0.002111318986862898, 0.015156134963035583, -0.01156055461615324, 0.001110693789087236, 0.024201786145567894, 0.022814251482486725, -0.00193454185500741, -0.02192036062479019, 0.002468208549544215, -0.014875959604978561, 0.000672920374199748, 0.030312269926071167, -0.003789033740758896, -0.028844686225056648, -0.014222217723727226, -0.020399410277605057, -0.05104522034525871, 0.01317489705979824, 0.030819252133369446, 7.129454024834558e-05, -0.038210537284612656, -0.02815091796219349, 0.0038123815320432186, 0.022640809416770935, -0.01903855986893177, 0.011240354739129543, -0.05139210447669029, 0.0009114026906900108, 0.010313109494745731, -0.032473620027303696, -0.0368763692677021, -0.027056902647018433, 0.0037189899012446404, 0.004919739905744791, -0.03103271871805191, 0.002341462764889002, -0.002224723109975457, 0.021613501012325287, -0.00678090238943696, 0.007491346448659897, 0.03858410194516182, -0.001370022539049387, -0.0020546168088912964, 0.02565602771937847, 0.024308519437909126, -0.016557009890675545, -0.018198035657405853, 0.0005811963928863406, -0.002970188856124878, -0.022840935736894608, 0.03258035331964493, -0.011620592325925827, 0.030285585671663284, 0.008718780241906643, 0.02252073585987091, -0.009539292193949223, 0.010453196242451668, 0.007131121587008238, -0.01090681366622448, -0.023601410910487175, -0.017450900748372078, -0.03375441953539848, -0.03153970092535019, -0.03292723745107651, 0.016236810013651848, -0.0016351881204172969, -0.004409421235322952, 0.009719405323266983, -0.0041292463429272175, 0.0017344168154522777, 0.001996247097849846, -0.03586240112781525, -0.023347917944192886, 0.003118614898994565, -0.001977902138605714, -0.03060578554868698, 0.017504267394542694, 0.0063973297365009785, -0.011747338809072971, -0.0007204500725492835, 0.013715234585106373, -0.015836559236049652, 0.002644985681399703, -0.01420887652784586, 0.05486093834042549, -0.010273084044456482, 0.018758384510874748, -0.028551168739795685, 0.006437354721128941, -0.015369601547718048, -0.0014242230681702495, 0.009085675701498985, -0.017944542691111565, -0.01043318398296833, -0.028230968862771988, 0.00026454025646671653, 0.0005682716728188097, 0.03650280460715294, -0.009279130026698112, 0.016717109829187393, -0.028124235570430756, -0.00021721902885474265, -0.011160304769873619, 0.007031058892607689, 0.034368135035037994, -0.005860327742993832, 0.012587863020598888, 0.00960600096732378, -0.004689596127718687, -0.051232002675533295, -0.00567020894959569, -0.0022297261748462915, -0.06975024193525314, -0.0002693349088076502, -0.05267290398478508, -0.019865743815898895, -0.0004782153991982341, 0.013288301415741444, 0.06190533936023712, 0.022654151543974876, 0.01730414293706417, 0.01399540901184082, 0.03391451761126518, -0.009445901028811932, -0.002313111675903201, -0.03129955381155014, -0.013521780259907246, 0.019252026453614235, 0.010700017213821411, 0.04642900452017784, -0.0034354794770479202, -0.0682559683918953, -0.030018752440810204, 0.01626349240541458, -0.023481335490942, -0.04005168750882149, 0.0006754219066351652, -0.035061903297901154, 0.004289346281439066, 0.030178852379322052, 0.03991826996207237, 0.0009439229615963995, 0.015516359359025955, 0.012767976149916649, -0.008258492685854435, 0.015262868255376816, -0.016757134348154068, -0.00643068365752697, 0.046268902719020844, 0.007918279618024826, 0.0037990398705005646, -0.04117238521575928, -0.01609005033969879, 0.0252157524228096, -0.011133621446788311, -0.0015834892401471734, 0.007264538202434778, -0.01420887652784586, 0.015236184932291508, 0.03250030428171158, -0.023681459948420525, 0.009392534382641315, 0.009692722000181675, 0.022267242893576622, 0.03330080211162567, 0.0015351256588473916, 0.011320404708385468, 0.02581612765789032, 0.0053333318792283535, 0.001332499086856842, -0.010246400721371174, -0.01286803837865591, -0.0018461532890796661, 0.0002768395934253931, -0.04669583588838577, 0.03335417062044144, 0.010052946396172047, 0.02145340107381344, 0.003011881373822689, 0.039251185953617096, 0.030792569741606712, 0.01273462176322937, -0.029058152809739113, 0.012120905332267284, -0.023948293179273605, -0.013821967877447605, 0.04146590456366539, 0.00016395658894907683, 0.005296641960740089, 0.01560975145548582, -0.02138669416308403, -0.01757097616791725, -0.004823012743145227, 0.039331234991550446, -0.008538667112588882, 0.0019111939473077655, 0.003925785887986422, 0.01737085171043873, -0.011126951314508915, -0.019332077354192734, 0.017611000686883926, 0.03410130366683006, 0.009065663442015648, 0.008552009239792824, -0.003155304351821542, -0.00044235968380235136, 0.039144452661275864, -0.008445275947451591, -0.014569100923836231, -0.021346667781472206, -0.03468833491206169, 0.02017260156571865, -0.04616216942667961, -0.004636229481548071, -0.010446526110172272, -0.0007379609742201865, 0.021666867658495903, -0.021773600950837135, -0.01643693447113037, 0.03226015344262123, -0.0011857406934723258, -0.04677588865160942, -0.023534702137112617, 0.012881380505859852, -0.006984362844377756, 0.023574726656079292, -0.014142167754471302, 0.031513020396232605, -0.0022714189253747463, -0.13960720598697662, -0.008725450374186039, -0.004909733776003122, 0.03447486832737923, -0.010980192571878433, -0.010766725987195969, 0.012120905332267284, 0.04594870284199715, -0.012461117468774319, -0.020199285820126534, -0.028391068801283836, -0.019452150911092758, 0.004286010749638081, -0.001283301622606814, -0.008525325916707516, -0.05051155388355255, -0.010886800475418568, -0.024748792871832848, 0.005083175376057625, 0.009465913288295269, 0.00215134397149086, -0.01564977690577507, 0.01878506876528263, -0.004255991894751787, -0.00693099619820714, -0.0077314963564276695, 0.013615172356367111, 0.004175941925495863, -0.022267242893576622, 0.013942042365670204, -0.0008588698692619801, -0.008772146888077259, -0.020452776923775673, 0.02625640295445919, -0.013655196875333786, -0.038450688123703, -0.013808625750243664, -0.011320404708385468, -0.0005065664299763739, 0.009646025486290455, 0.04608212038874626, -0.03548883646726608, 0.02633645199239254, 0.015583068132400513, -0.0042593274265527725, -0.024281835183501244, 0.01003960520029068, -0.018918484449386597, 0.01047320943325758, -0.008511983789503574, -0.03076588548719883, 0.013701892457902431, 0.018731702119112015, -0.015129451639950275, -0.017264118418097496, 0.022534076124429703, 0.009525950998067856, -0.008531996048986912, 0.0007046068203635514, 0.021800285205245018, -0.008792159147560596, 0.000790076912380755, 0.00038878453779034317, 0.013768601231276989, 0.0065140691585838795, -0.04277338832616806, 0.020359385758638382, 0.01290806382894516, -0.026563260704278946, -0.0439741350710392, -0.016917234286665916, -0.0011548880720511079, 0.00917239673435688, 0.012027513235807419, -0.01416885107755661, 0.018104642629623413, 0.01598331704735756, 0.008231809362769127, -0.04709608852863312, 0.04800331965088844, 0.03266040235757828, -0.015222842805087566, -0.0040025003254413605, 0.020199285820126534, 0.04199957102537155, 0.030018752440810204, -0.00610381318256259, 0.025602661073207855, -0.03895767033100128, 0.010226388461887836, 0.04632227122783661, -0.01738419383764267, 0.0019362095044925809, 0.004923075437545776, -0.006910983938723803, -0.007778192404657602, -0.01416885107755661, 0.025669367983937263, 0.000765895121730864, 0.00990618858486414, 0.031593069434165955, 0.03188658505678177, -0.03978485241532326, -0.04135917127132416, -0.0015001037390902638, 0.03375441953539848, -0.011880755424499512, 0.0005274128052406013, 9.474669059272856e-05, 0.001398373511619866, 0.0507517047226429, -0.004185948055237532, -0.000648321642074734, -0.011006875894963741, -0.03335417062044144, 0.03250030428171158, 0.06489387154579163, 0.010239729657769203, 0.025002285838127136, 0.004392744041979313, 0.006233894266188145, 0.016276834532618523, -0.025429219007492065, -0.016530325636267662, -0.035088587552309036, -0.009439229965209961, 0.01791786029934883, 0.03799707069993019, 0.004306023474782705, -0.06617467105388641, 0.00043985809315927327, 0.002688345964998007, -0.02181362733244896, 0.016903892159461975, 0.02337460219860077, -0.009832808747887611, 0.025269119068980217, 0.05128537118434906, -0.06334623694419861, 0.014062117785215378, -0.021266618743538857, 0.001239107339642942, 0.025842810049653053, -0.010199705138802528, -0.01650364324450493, -0.00799832958728075, -0.002841775305569172, -0.026483209803700447, -0.028124235570430756, 0.0037390023935586214, 0.016703767701983452, 0.008045025169849396, -0.015543042682111263, 0.004899727646261454, 0.019145293161273003, -0.010800080373883247, 0.013648525811731815, -0.02711026929318905, -0.000305399124044925, 0.03226015344262123, -0.01729080080986023, 0.009252446703612804, -0.022534076124429703, -0.03268708661198616, 0.02390826866030693, -0.026963509619235992, -0.007951634004712105, -0.004689596127718687, -0.030872618779540062, -0.0018911814549937844, -0.0354621522128582, -0.07844900339841843, 0.03415466845035553, -0.024668743833899498, -0.001894516870379448, 0.031779851764440536, 0.025535952299833298, 0.018718359991908073, 0.007177817169576883, 0.021933700889348984, 0.011313734576106071, 0.02788408473134041, -0.0441342368721962, 0.003422137815505266, 0.011373771354556084, -0.048190101981163025, 0.001281633973121643, -0.00368230021558702, -0.000624139909632504, 0.012461117468774319, 0.02729705162346363, 0.037410035729408264, -0.002221387578174472, 0.009345837868750095, 0.018411502242088318, -0.04440107196569443, 0.004299352411180735, 0.03642275184392929, 0.034208036959171295, -0.008365225978195667, -0.08218467235565186, 0.030632469803094864, 0.01626349240541458, 0.011573896743357182, -0.004679589997977018, 0.006017092149704695, 0.012361055240035057, 0.006690846290439367, -0.007638104725629091, 0.036182601004838943, 0.0021296637132763863, 0.008411921560764313, -0.026443185284733772, 0.012134246528148651, 0.018918484449386597, -0.006827598437666893, -0.009932871907949448, 0.009465913288295269, -0.0020596198737621307, -0.016823843121528625, -0.032286837697029114, -0.021706894040107727, -0.023347917944192886, -0.02501562610268593, 0.0023848230484873056, 0.04157263785600662, 0.036823004484176636, 0.029671868309378624, -0.0097727719694376, -0.0023314564023166895, 0.006694181822240353, -0.015943292528390884, 0.015663117170333862, 0.002463205484673381, 0.020212626084685326, 0.0019528865814208984, 0.01782446727156639, -0.004589533898979425, 0.0013133203610777855, 0.042559921741485596, 0.023774851113557816, -2.0755152945639566e-05, 0.045922018587589264, -0.006253906525671482, -0.02373482659459114, -0.05902353674173355, -0.01722409389913082, 0.05678213760256767, -0.00999957975000143, 0.01386199239641428, -0.00942588783800602, 0.008058367297053337, 0.025709394365549088, -0.004739627242088318, 0.016837185248732567, 0.01273462176322937, 0.019398784264922142, 0.026910142973065376, 0.02164018526673317, 0.031059402972459793, -9.354802023153752e-05, 0.003625598270446062, -0.005023137666285038, -0.02494891919195652, -0.021947043016552925, 0.007984988391399384, -0.021626843139529228, -0.017704393714666367, 0.022707518190145493, -0.009686050936579704, 0.007764850743114948, 0.02911151945590973, -0.007711484096944332, 0.0001613507920410484, 0.020999785512685776, -0.015089426189661026, 0.003945798147469759, -0.025575976818799973, 0.010419842787086964, -0.007758179679512978, -0.024842185899615288, -0.03140628710389137, 0.02330789342522621, 0.014569100923836231, 0.029405035078525543, -0.027323735877871513, 0.009212421253323555, -0.020559510216116905, 0.010800080373883247, 0.0022447356022894382, 0.04669583588838577, -0.002321450272575021, 0.0004602875269483775, 0.010653321631252766, 0.029324986040592194, -0.01598331704735756, 0.011627263389527798, -0.005376691929996014, 0.008325200527906418, 0.007491346448659897, -0.006877629552036524, 0.018931826576590538, 0.015689801424741745, -0.03722325339913368, 0.013334996998310089, 0.022360635921359062, 0.010059617459774017, -0.05187240242958069, -0.02658994309604168, -0.006917654536664486, 0.015929950401186943, 0.03511526808142662, -0.027403784915804863, -0.0015209501143544912, 0.0007571396417915821, -0.017184067517518997, -0.04074545204639435, -0.0037456732243299484, 0.015369601547718048, -0.023361260071396828, -0.008698767051100731, -0.03599581867456436, 0.03930455446243286, 0.011006875894963741, -0.012914733961224556, 0.0007979985093697906, 0.006917654536664486, -0.01729080080986023, 0.03191326931118965, 0.036556169390678406, 0.021079834550619125, -0.0030018752440810204, 0.025269119068980217, 0.015863243490457535, -0.005269958637654781, -0.009125701151788235, -0.02658994309604168, 0.006484050303697586, -0.0032503637485206127, -0.022320609539747238, 0.006837604567408562, 0.021666867658495903, 0.0031536368187516928, 0.02468208596110344, -0.00040066696237772703, 0.025495927780866623, 0.001991243800148368, -0.002022930420935154, -0.01711735874414444, -0.014622467570006847, 0.0747133418917656, -0.031513020396232605, -0.026376476511359215, 0.011767351068556309, 0.008912233635783195, 0.007251196540892124, 0.016543667763471603, -0.06014423817396164, -0.011947463266551495, 0.010873459279537201, 0.010900142602622509, 0.005560140125453472, 0.018905142322182655, -0.0030769221484661102, 0.0186783354729414, -0.005843650549650192, -0.025362510234117508, 0.010233059525489807, 0.013521780259907246, 0.018464868888258934, 0.04827015474438667, 0.05048486962914467, -0.028898052871227264, -0.004225973039865494, -0.011573896743357182, 0.0050931815057992935, -0.0005048987222835422, 0.015222842805087566, 0.003558889962732792, 0.0357823520898819, -0.0005182403838261962, 0.0014734204160049558, -0.04936417192220688, 0.006964350584894419, -0.02416175976395607, 0.018224718049168587, 0.000359599624061957, 0.023081084713339806, -0.0474429689347744, 0.0032720440067350864, -0.006233894266188145, 0.012421092949807644, 0.013628513552248478, 0.010673333890736103, 0.00386908371001482, 0.031166136264801025, -0.003422137815505266, -0.006013756617903709, 0.024575352668762207, -0.01774441823363304, 0.016450276598334312, -0.006150508765131235, 0.03052573651075363, -0.006971021182835102, 0.010366476140916348, -0.01858494244515896, -0.017944542691111565, 0.0178111270070076, 0.017357509583234787, -0.010539917275309563, -0.03901103511452675, 0.03169980272650719, -0.00565353175625205, -0.01722409389913082, -0.004079214762896299, -0.03015216812491417, -0.01705065183341503, 0.014915984123945236, -0.018891802057623863, 0.024215126410126686, -0.01782446727156639, -0.037249937653541565, -0.0211999099701643, -0.012881380505859852, 0.004522825125604868, 0.009679379872977734, 0.009072334505617619, -0.01403543446213007, 0.008378567174077034, 0.021746918559074402, 0.005109858699142933, -0.024962259456515312, -0.03813048452138901, -0.010913483798503876, 0.00855867937207222, 0.01029976736754179, 0.043333735316991806, 0.003638939931988716, 0.004326035734266043, 0.02214716747403145, -0.008752133697271347, 0.0038524065166711807, 0.04320032149553299, 0.010199705138802528, -0.0042593274265527725, -0.02337460219860077, 0.009385863319039345, -0.02173357643187046, 0.014649150893092155, -0.0037390023935586214, 0.014529076404869556, -0.016983943060040474, -0.03797038644552231, -0.007397954817861319, -0.05032477155327797, -0.004422762896865606, -0.0679357722401619, 0.001640191301703453, -0.00786491297185421, 0.025575976818799973, 0.017664367333054543, -0.03180653601884842, 0.0089055635035038, 0.015836559236049652, -0.001024806872010231, -0.003043567994609475, 0.010153009556233883, 0.032286837697029114, -0.0007254531956277788, -0.030579103156924248, 0.008705438114702702, 0.004225973039865494, 0.037490084767341614, 0.024268493056297302, -0.004893056582659483, 0.0168638676404953, -0.004913069307804108, 0.041252437978982925, 0.032553669065237045, -0.03330080211162567, -0.02980528585612774, 0.020386068150401115, -0.01746424287557602, 0.03439481928944588, 0.01571648381650448, -0.010786738246679306, 0.012314359657466412, -0.010353134013712406, -0.02276088483631611, 0.005199914798140526, 0.025229094550013542, 0.034715019166469574, -0.011480504646897316, 0.011934122070670128, 0.026443185284733772, 0.016476958990097046, -0.003518864745274186, -0.00813174620270729, -0.006534081883728504, -0.032046686857938766, -0.005486760754138231, -0.023934951052069664, -0.01687720976769924, 0.012921405024826527, -0.035248685628175735, 0.002254741732031107, -0.006504063028842211, 0.020799659192562103, 0.028898052871227264, 0.006187198217958212, -0.003178652375936508, 0.008191783912479877, -0.012214296497404575, 0.013915359042584896, 0.04688262194395065, -0.009365851059556007, -0.022107142955064774, 0.00916572567075491, 0.028978101909160614, 0.011100267991423607, -0.0009247443522326648, 0.004195954650640488, 0.0203327015042305, 0.0022964344825595617, -0.031673118472099304, -0.024281835183501244, -0.02641650289297104, 0.008111733943223953, 0.020546168088912964, 0.0011015214258804917, -0.0026216376572847366, -0.021079834550619125, 0.038370635360479355, -0.023347917944192886, -0.046028751879930496, 0.010753383859992027, -0.013375021517276764, -0.006937667261809111, -0.02224056050181389, 0.006300602573901415, 0.01667708531022072, -0.02148008532822132, -0.019011875614523888, -0.012321029789745808, 0.001225765678100288, 0.00017875750199891627, -0.019572226330637932, 0.02173357643187046, 0.02929830178618431, 0.00098228023853153, 0.006277254782617092, -0.029965385794639587, 0.0474429689347744, 0.001832811627537012, -0.029965385794639587, 0.022027093917131424, -0.019412126392126083, 0.013621842488646507, 0.007077754940837622, -0.010639980435371399, 0.002124660648405552, -0.004059202503412962, 0.03025890327990055, 0.05224597081542015, 0.021600160747766495, -0.005913694389164448, 0.028657902032136917, -0.015089426189661026, -0.03716988489031792, -0.03418135270476341, -0.031059402972459793, 0.016837185248732567, -0.0046062106266617775, 0.012547838501632214, -0.010519905015826225, 0.019398784264922142, -0.023508017882704735, -0.01711735874414444, -0.010373146273195744, 0.02658994309604168, 0.011807375587522984, -0.00990618858486414, -0.009959555231034756, 0.032553669065237045, 0.004612881690263748, -0.004322700202465057, -0.000856368278618902, 0.03901103511452675, 0.00495309429243207, -0.0008263495401479304, -0.05131205543875694, 0.042800068855285645, 0.01878506876528263, 0.0159966591745615, -0.01815800927579403, 0.04666915535926819, 0.0109935337677598, 0.00031040224712342024, -0.039598070085048676, 0.014569100923836231, 0.006500727497041225, -0.020452776923775673, -0.0016293511725962162, -0.04135917127132416, 0.008705438114702702, -0.05424721911549568, -0.004739627242088318, -0.006310608703643084, -0.02086636796593666, 0.005977067165076733, -0.007818217389285564, 0.011854072101414204, -0.014115484431385994, 0.021440060809254646, 0.016476958990097046, 0.005063163116574287, -0.0001667708420427516, 0.02590951882302761, -0.01850489340722561, -0.004883050452917814, -0.018731702119112015, -0.0021696886979043484, -0.026963509619235992, -0.023427968844771385, 0.03746340423822403, 0.012794659473001957, 0.02887136861681938, -0.025335827842354774, 0.013875334523618221, 0.022013751789927483, 0.04026515409350395, 0.0016602037940174341, -0.003782362909987569, -0.02086636796593666, 0.013848651200532913, 0.010746713727712631, -0.032126735895872116, 0.008898892439901829, 0.0011557219550013542, 0.007077754940837622, -0.026469869539141655, -0.00030623297789134085, 0.016303518787026405, -0.013334996998310089, 0.005983737763017416, 0.022400660440325737, 0.030125485733151436, 0.008451946079730988, 0.03522200137376785, -0.003050238825380802, -0.004556179512292147, -0.023961635306477547, 0.015329576097428799, 0.02929830178618431, 0.024308519437909126, 0.029058152809739113, -0.0118607422336936, 0.02972523495554924, 0.03476838767528534, -0.03954470157623291, 0.020145917311310768, -0.01120700128376484, 0.0005061495467089117, -0.01659703440964222, -0.0015701474621891975, 0.019852401688694954, 0.006800915114581585, -0.00779820466414094, -0.016823843121528625, 0.034368135035037994, 0.011353759095072746, 0.026016252115368843, -0.04069208726286888, -0.011287051253020763, 0.05891680344939232, -0.03503521904349327, -0.01705065183341503, 0.004896392114460468, 0.03311401978135109, -0.005947048310190439, 0.006754219066351652, -0.0017210751539096236, 0.03799707069993019, 0.014195534400641918, 0.005720240063965321, -0.02362809330224991, 0.006010421086102724, -0.009579317644238472, 0.023921610787510872, -0.026483209803700447, -0.00873879250138998, 0.023014375939965248, 0.01722409389913082, -0.017410876229405403, -0.011247025802731514, 0.0021680209320038557, -0.028017502278089523, 0.01833145134150982, -0.004986448213458061, -0.005813631694763899, 0.05512776970863342, 0.006740877404808998, 0.034715019166469574, -0.024908892810344696, 0.006837604567408562, 0.010153009556233883, 0.01817135140299797, -0.016757134348154068, -0.02477547712624073, -0.025309143587946892, -0.009025637991726398, 0.002956847194582224, 0.0041459230706095695, 0.002908483613282442, 0.0007158638327382505, 0.01559640932828188, -0.009686050936579704, -0.016650401055812836, 0.0023447980638593435, 0.040665403008461, -0.02130664326250553, -0.005890346132218838, 0.026122985407710075, -0.019799035042524338, -0.011693972162902355, 0.00773816742002964, -0.05120532214641571, -0.017530951648950577, 0.008205126039683819, -0.0033787772990763187, 0.0019728990737348795, -0.01661037653684616, 0.006157179828733206, -0.022360635921359062, -0.012114234268665314, 0.02389492653310299, -0.011854072101414204, -0.008411921560764313, 0.00136335170827806]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" state and a set of accepting states. Connected
with transitions that are labeled with a character or the empty
string ε. We traverse or execute an NFA by starting in the
start state and whenever we read a character follow the
appropriate transitions or any ε-transitions. For a regular ex-
pression, we can construct a NFA (McNaughton & Yamada,
1960; Thompson, 1968), that when fed a string, character
by character, ends in a set of state including at least one
accepting state, if and only if the string matches the regular
expression. To illustrate this approach consider the grammar
given in Fig. 3 (a). The terminal intis given by a regex that
allows any positive integer (not starting with leading zeros)
or one or more zeros. Fig. 4 shows an NFA for this regex.3.2. Character Scanner
Like classical parsers, DOMINO separates the CFG recog-
nition into a parser and a scanner (or lexer). The parser
enforces the high-level structure of the language, e.g., the
rules in a context-free grammar, and the scanner enforces the
low-level structure, i.e., the regular expressions of the termi-
nals. The key idea is that any legal program in a context-free
grammar is a sequence of terminals, or formally:
Lemma 3.1 LetLGbe the language described by a CFG
G. Further, let r1, . . . , r nbe the regular expressions of the
terminals of Gand the rEOS= $. Then, it holds that:
•The union of these regular expressions r=
r1|. . .|rn|rEOSmatches any terminal in G.
•The regular expression R=r+matches all non-empty
sequences of terminals in the language.
•The language LRdescribed by Rcontains all legal
programs in G, i.e., LG⊆LR, but also
•LRcontains some illegal programs, i.e., LR̸⊆LG.
To construct an NFA for LR, we construct the NFA for
the regex rifor each terminal in the grammar. From the
accepting states of the invidual terminal NFAs, we add an
ε-transition to a single NFA accepting state qa. Similarly,
we add a transition from the start state q0to the start state
of each DFA. Finally, we add a transition from q0toqa,
to allow for the chaining of multiple tokens. This is the
standard disjuction construction for regex NFAs, however,
we do this explictly to track the sub-automata correspoding
to each terminal. This construction is showcased in Fig. 3 (b)
for the grammar in Fig. 3 (a). There, the boxes in the middle
correspond to individual NFAs like intas shown in Fig. 4.
3.3. Vocabulary-Aligned Subterminal Tree
Using a scanner Sat generation time can enforce that the
generated string will be in LR, but not neccesarily in LG.
To ensure this, we need to also run a parser Pon the output
as it is generated and dynamically allow and disallow some
of the transitions in S, according to the current parser state.
For this, we first lift Sfrom the character level to the
(sub)terminal level used by the parser. To do so, for each
node in Swe follow the transitions for each token in the vo-
cabulary and enumerate all reachable states. Particularly, we
track which terminal NFAs are partially or fully traversed.
As terminals are not neccesarily aligned with the token vo-
cabulary, we introduce the notion of a subterminal as a part
of a terminal NFA. In particular, for terminal α, e.g.,int,
we say that Sreads a:
•Full terminal if it passes q0and reaches an accepting
stateqαin the NFA for the terminal. We denote this
as. If we end in an accepting state, that also allows
4
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
(a) Example Grammar
E = E | E + E | (E) | int
int = ([1-9][0-9] *)|(0+)
(b) Character Scanner
q0 ( qa
)
+
int
ws
EOS(c) Vocabulary
V={0,1,2,12,),(,+,+11(,EOS}
(d) Vocabulary-aligned Subterminal Tree (offline, per node)
q[0-9]*
int
0
1
2
12
(
)
+
+1
1(
EOS( )+ EOS 0,1,
2,12
1(+1(e) Parser","[0.0005964977317489684, 0.05326863378286362, 0.05463840067386627, 0.002539772307500243, -0.00967713538557291, -0.006582481320947409, -0.024034300819039345, 0.003262703772634268, -0.016627423465251923, 0.09593427181243896, 0.033153384923934937, -0.006363699212670326, -0.02291819639503956, 0.024947477504611015, 0.030007997527718544, -0.024807963520288467, 0.015942541882395744, -0.00903664343059063, 0.0023431857116520405, 0.01774352788925171, 0.08320053666830063, -0.02270258404314518, -0.003674901556223631, -0.015283024869859219, 0.0052602775394916534, -0.026938708499073982, 0.016462543979287148, 0.04839836061000824, 0.023996250703930855, -0.05484132841229439, 0.013329841196537018, -0.02678651362657547, -0.004391491413116455, -0.006633213255554438, 0.039089031517505646, 0.042107585817575455, 0.004413686692714691, 0.0031961179338395596, -0.03046458587050438, 0.003015385242179036, -0.013963991776108742, -0.02001378685235977, -0.004534175619482994, -0.028638232499361038, 0.017832309007644653, 0.026761146262288094, 0.008960545063018799, 0.030261658132076263, -0.011218120343983173, 0.0025556262116879225, -0.034827541559934616, -0.015612782910466194, -0.0065888226963579655, 0.012968375347554684, -0.04583639279007912, -0.01426838431507349, -0.06224820390343666, 0.04170173034071922, 0.035512421280145645, 0.010457140393555164, 0.036679260432720184, -0.01596790738403797, 0.0249347947537899, -0.001834280090406537, -0.04187929257750511, 0.03046458587050438, -0.0666111558675766, 0.024681134149432182, -0.008478591218590736, 0.030413853004574776, 0.004714908078312874, 0.012163004837930202, 0.038759272545576096, -0.03256996348500252, 0.017363037914037704, 0.01216934621334076, 0.030515316873788834, 0.042614907026290894, 0.006664920598268509, -0.016703521832823753, 0.03120020031929016, -0.0013166547287255526, 0.025721140205860138, -0.09207864105701447, 0.024059666320681572, -0.0009639086201786995, -0.04953983053565025, -0.037592437118291855, -0.039266593754291534, -0.028587499633431435, -0.00015665496175643057, -0.008129808120429516, -0.035766083747148514, -0.013520087115466595, 0.04466955363750458, -0.0054568643681705, -0.008446883410215378, -0.012334225699305534, 0.012232760898768902, -0.00821858923882246, 0.01978549174964428, -0.04020513594150543, 0.04609005153179169, -0.030109461396932602, 0.044847115874290466, 0.023806005716323853, -0.03178361803293228, 0.04165099933743477, -0.057377927005290985, -0.055196452885866165, -0.035436324775218964, -0.00262379739433527, 0.019252806901931763, -0.0024620890617370605, 0.036019742488861084, -0.004829055164009333, -0.04078855365514755, -0.02077476680278778, 0.0021751360036432743, -0.00014208932407200336, -0.008649811148643494, 0.025568943470716476, -0.014128871262073517, -0.037769999355077744, -0.010926411487162113, 0.03832805156707764, -0.022575754672288895, 0.012492762878537178, 0.002160867443308234, -0.009715184569358826, 0.052710581570863724, -0.024871379137039185, 0.009924453683197498, -0.020242080092430115, -0.08888252079486847, -0.0014981803251430392, -0.014801070094108582, -0.004369296133518219, -0.01993768848478794, 0.0582403726875782, 0.009658110328018665, -0.019988421350717545, -0.004121977835893631, 0.02795334905385971, -0.019988421350717545, -0.005523450206965208, -0.0815771073102951, 0.034497782588005066, -0.010457140393555164, -0.005165155045688152, 0.01237227488309145, -0.014458629302680492, -0.05255838483572006, -0.006078331731259823, 0.01202349178493023, -0.07077118754386902, -0.031250931322574615, 0.02029281295835972, 0.018314262852072716, 0.01927817240357399, -0.01756596565246582, 0.01844109408557415, 0.02525186911225319, 0.03771926462650299, 0.011452755890786648, 0.018897682428359985, -0.02270258404314518, 0.008592737838625908, -0.03825195133686066, 0.045100778341293335, -0.0037985609378665686, -0.04545590281486511, -0.04291930049657822, -0.025353332981467247, -0.06133502721786499, -0.02324795350432396, -0.0030280682258307934, 0.006753701716661453, -0.04264027252793312, -0.03221483901143074, -0.008060052059590816, 0.02091428078711033, -0.02168794348835945, -0.00890981312841177, 0.0034592903684824705, -0.03289972245693207, 0.011129339225590229, -0.04373101145029068, -0.01672888733446598, -0.009493231773376465, -0.014699606224894524, 0.06417602300643921, 0.05035154148936272, -0.006658579222857952, 0.011655684560537338, -0.08041027188301086, 0.06458187848329544, 0.011046900413930416, 0.0368821881711483, 0.006490529514849186, 0.016525959596037865, 0.042006123811006546, 0.02558162808418274, -0.00017151786596514285, 0.011662025935947895, 0.02777578867971897, 0.051518380641937256, -0.0026507487054914236, 0.016564007848501205, -0.027319200336933136, 0.011192754842340946, 0.007559072691947222, -0.018973780795931816, -0.0359436459839344, -0.07361217588186264, 0.06392236053943634, 0.02970360592007637, 0.01735035516321659, 0.031022638082504272, -0.00010364395711803809, 0.005288814194500446, 0.02336210012435913, 0.049793489277362823, 0.00420758780092001, -0.03949488699436188, 0.03432022035121918, 0.0033863631542772055, -0.011731782928109169, -0.004017342813313007, -0.0017756210872903466, 0.02073671855032444, 0.03589291125535965, 0.011998125351965427, -0.05575450509786606, 5.766805406892672e-05, 0.0039888061583042145, -0.05834183841943741, -0.05900135263800621, -0.022727951407432556, 0.02525186911225319, -0.03353387489914894, 0.05590669810771942, 0.04147343710064888, -0.00013386519276537, 0.007172240875661373, 0.018314262852072716, -0.011903002858161926, 0.002894896548241377, 0.00984201394021511, 0.01943036913871765, 0.05834183841943741, -0.008656153455376625, -0.028308473527431488, 0.005063691176474094, -0.022169897332787514, 0.04340125247836113, -0.03140312805771828, 0.01142739038914442, 0.004835397005081177, 0.028257742524147034, -0.026228461414575577, 0.0031612396705895662, 0.010102015919983387, -0.004432711284607649, -0.014927900396287441, -0.040255866944789886, -0.018745485693216324, 0.007628829218447208, 0.01931622065603733, -0.07300339639186859, -0.024795280769467354, 0.012981059029698372, -0.012530812062323093, -0.00037910303217358887, -0.04598858579993248, -0.04015440493822098, 0.009480549022555351, 0.00015586227527819574, -0.014445946551859379, 0.04573492705821991, -0.0639730915427208, -0.025454796850681305, 0.0737643763422966, 0.006224186159670353, 0.0025873335544019938, -0.004194905050098896, -0.013976674526929855, -0.04631834477186203, -0.009981526993215084, -0.015168877318501472, 0.01518156100064516, -0.0017661089077591896, 0.03604510799050331, -0.027750421315431595, 0.02565772458910942, -0.04573492705821991, 0.018022553995251656, 0.02145965024828911, 0.014889851212501526, 0.007146874908357859, 0.009429816156625748, -0.012524470686912537, -0.036501698195934296, 0.01570156402885914, -0.04598858579993248, 0.052456922829151154, -0.021916238591074944, -0.0006611017743125558, 0.017071329057216644, -0.004232953768223524, 0.0012143980711698532, -0.012581543996930122, 0.014496678486466408, -0.001554461196064949, -0.00856103003025055, -0.053370099514722824, 0.004321734886616468, 0.02164989523589611, 0.03036312200129032, -0.009683476760983467, -0.0007697000401094556, -0.022765999659895897, 0.04697786271572113, -0.007717610336840153, -0.011649343185126781, 0.02955140918493271, -0.016931815072894096, 0.03289972245693207, -0.01756596565246582, -0.049615927040576935, 0.02048305794596672, -0.024287961423397064, 0.011643001809716225, 0.03135239705443382, -0.021510381251573563, -0.026329925283789635, -0.03878463804721832, 0.04086465388536453, 0.026913342997431755, 0.07604731619358063, -0.05367448925971985, -0.016969865188002586, -0.005190521012991667, 0.04697786271572113, -0.04733298718929291, 0.016462543979287148, -2.8883569029858336e-05, -0.019087927415966988, 0.06361796706914902, 0.046267613768577576, -0.010190797038376331, 0.0024906257167458534, 0.01128153596073389, -0.026304559782147408, 0.014255701564252377, -0.00018588533566799015, -0.0036114866379648447, -0.003928561694920063, -0.009651768952608109, 0.025568943470716476, -0.03982464596629143, 0.018174750730395317, -0.02274063415825367, 0.025886019691824913, -0.027648957446217537, -0.02001378685235977, -0.018250849097967148, -0.003773194970563054, 0.006671262439340353, -0.039342690259218216, 0.014585459604859352, 0.03457387909293175, 0.025721140205860138, 0.0459124892950058, -0.039672449231147766, -0.002921848092228174, -0.02307039126753807, -0.021599162369966507, 0.04195538908243179, 0.03254459798336029, 0.005792963784188032, 0.014217652380466461, -0.011211778968572617, -0.014623508788645267, -0.013634233735501766, 0.009670794010162354, -0.01818743348121643, -0.051366183906793594, -0.004771981853991747, 0.011370317079126835, -0.005615402013063431, -0.017172792926430702, -0.0002469223109073937, 0.04332515597343445, 0.0038524637930095196, -0.011091290973126888, 0.014864485710859299, 0.0362226702272892, -0.0009298230288550258, -0.001739157480187714, 0.06103063374757767, 0.005215886980295181, -0.0024811134207993746, -0.02062257193028927, -0.027420664206147194, -0.006779067683964968, 0.01552400179207325, 0.030845075845718384, 0.0330265536904335, 0.029018722474575043, 0.017768895253539085, 0.0016519618220627308, 0.034929003566503525, 0.02211916632950306, -0.039418790489435196, 0.004686371423304081, -0.029145551845431328, -0.05473986268043518, 0.011801538988947868, 0.03713584691286087, -0.0014363506343215704, 0.008408834226429462, -0.025974800810217857, -0.062298934906721115, -0.025645041838288307, 0.00034462110488675535, -0.004251978360116482, 0.02463040128350258, -0.023932836949825287, -0.013000083155930042, -0.004930519498884678, -0.014927900396287441, -0.034929003566503525, 0.01253715343773365, 0.006103697698563337, -0.005485401023179293, 0.028739696368575096, 0.01085665449500084, 0.01982354186475277, -0.0699087381362915, 0.023235270753502846, 0.015828393399715424, 0.026482120156288147, 0.0019151342567056417, -0.0169825479388237, 0.03360997140407562, -0.05215252935886383, -0.032011911273002625, 0.008053709752857685, -0.0030677025206387043, -0.02937384694814682, -0.03287435695528984, 0.010507872328162193, -0.001211227267049253, -0.00667760381475091, -0.022131849080324173, 0.08705616742372513, -0.007571755908429623, 0.06265406310558319, 0.0004894848680123687, 0.01610741950571537, -0.0051017398945987225, -0.011636659502983093, -0.01414155401289463, 0.0004958263598382473, 0.03518266603350639, -0.023197222501039505, -0.0042931982316076756, 0.10542116314172745, 0.04923543706536293, -0.06620530039072037, -0.025746505707502365, 0.033254846930503845, 0.016158152371644974, 0.008542005904018879, 0.03404119238257408, -0.0014173261588439345, -0.06742287427186966, 0.03295045346021652, -0.009220547042787075, -0.031910449266433716, -0.016386445611715317, -0.0005382351810112596, -0.05022471398115158, -0.0026729439850896597, 0.07787366956472397, 0.023222588002681732, -0.020571839064359665, 0.027496760711073875, 0.011833246797323227, -0.003015385242179036, 0.00759078050032258, 0.023298686370253563, -0.013634233735501766, 0.03013482689857483, -0.01377374678850174, 0.05367448925971985, -0.05808817595243454, -0.041853927075862885, -0.03373680263757706, 0.0038936834316700697, -0.008744933642446995, -0.004372466821223497, 0.03087044134736061, -0.018745485693216324, -0.04213295131921768, 0.03513193130493164, 0.0012587885139510036, -0.018644021824002266, 0.01343130599707365, 0.052101798355579376, -0.010159089230000973, -0.04570956155657768, 0.0032722160685807467, -0.020546473562717438, 0.015841078013181686, -0.014217652380466461, -0.0034846565686166286, -0.012879595160484314, -0.013875210657715797, 0.008434200659394264, -0.036171939224004745, 0.013799113221466541, -0.01253715343773365, -0.024693816900253296, -0.01898646354675293, 0.009765916503965855, -0.10785630345344543, -0.004464419092983007, -0.02846067026257515, 0.05849403515458107, 0.0032309964299201965, 0.006265406031161547, 0.03206264600157738, -0.017109377309679985, -0.005444181151688099, -0.002508064964786172, 0.002898067468777299, -0.01456009317189455, -0.024731865152716637, -0.01044445764273405, 0.0011779343476518989, 0.015270342119038105, -0.012346908450126648, 0.007273705210536718, 0.01629766635596752, 0.005463205743581057, 0.012308859266340733, 0.0041124653071165085, 0.02340015023946762, -0.033914364874362946, -0.003665389260277152, 0.0010043357033282518, -0.026507487520575523, -0.027496760711073875, 0.023717224597930908, 0.04390857368707657, 0.007064435631036758, -0.03287435695528984, -0.03203727677464485, -0.05065593495965004, -0.02318453975021839, 0.01273373980075121, -0.00863712839782238, 0.02073671855032444, 0.015485952608287334, -0.0032722160685807467, 0.012613251805305481, 0.004473931156098843, 0.019303537905216217, -0.0030581902246922255, -0.014204968698322773, 0.02729383297264576, -0.0005330826970748603, -0.0010622019181028008, -0.05940721184015274, -0.006284430623054504, 0.003297582035884261, -0.028004081919789314, 0.02612699754536152, -0.00932835228741169, -0.02485869638621807, 0.0065380907617509365, -0.017363037914037704, -0.011421049013733864, -0.004746615886688232, 0.01610741950571537, 0.025606993585824966, -0.029602140188217163, -0.0033102650195360184, 0.02085086517035961, 0.012568861246109009, -0.01468692347407341, 0.011516171507537365, -0.03226557374000549, -0.018276214599609375, -0.028232377022504807, -0.013494720682501793, -0.04274173825979233, -0.02379332296550274, 0.02011525072157383, -0.009924453683197498, 0.014547410421073437, 0.006582481320947409, -0.005612231325358152, -0.013367890380322933, -0.010482505895197392, -0.025163087993860245, 0.042335882782936096, -0.0007435413426719606, -0.045531999319791794, 0.04971739277243614, -0.006449309643357992, -0.00045262486673891544, -0.022930879145860672, 0.025048941373825073, -0.013938626274466515, 0.004480272531509399, 0.04124514386057854, -0.006312967278063297, -0.007863464765250683, 0.019760126248002052, 0.008694201707839966, -0.002687212312594056, 0.01628498174250126, 0.030261658132076263, 1.8479538994142786e-05, 0.020571839064359665, -0.03954561799764633, -0.03845487907528877, -0.013025449588894844, -0.0038968543522059917, 7.12428372935392e-05, -0.0020292813424021006, -0.03721194714307785, -0.010336651466786861, 0.008973227813839912, -0.015080096200108528, -0.0029757507145404816, -0.021053792908787727, 0.027572859078645706, -0.018935730680823326, 0.03244313597679138, -0.03097190521657467, 0.026837244629859924, 0.035005103796720505, -0.015270342119038105, 0.016094736754894257, -0.013317158445715904, -0.014471312053501606, -0.016500594094395638, 0.0008065600413829088, 0.024135764688253403, -0.011402023956179619, 0.014306433498859406, -0.03518266603350639, 0.02001378685235977, -0.017844991758465767, -0.0031327030155807734, 0.00420758780092001, 0.012892277911305428, -0.010634702630341053, -0.016893766820430756, -0.004648322705179453, -0.023894786834716797, 0.049692027270793915, 0.04297003149986267, 0.01859329082071781, -0.0355631560087204, -0.004756127949804068, -0.028257742524147034, 0.02233477681875229, 0.0020514766220003366, 0.013139596208930016, 0.006994679104536772, -0.05539938062429428, -0.033686067909002304, -0.03196118026971817, -0.0017724503995850682, -0.008751275949180126, -0.02904408797621727, -0.0010780557058751583, -0.032925087958574295, 0.0034719735849648714, -0.017553282901644707, 0.009759575128555298, 0.018567923456430435, -0.014598142355680466, 0.004302710294723511, 0.0010415920987725258, -0.0061480882577598095, -0.013329841196537018, 0.002265502233058214, -0.025936750695109367, 0.02517577074468136, 0.0032262401655316353, -0.028638232499361038, 0.02671041525900364, -0.03579144924879074, -0.08000441640615463, -0.019011829048395157, 0.019772808998823166, -0.01282886229455471, -0.0003519534657243639, -0.03761780261993408, -0.046191517263650894, 0.012670325115323067, 0.010939094237983227, 0.04291930049657822, -0.011116656474769115, -0.0035734374541789293, 0.004179051145911217, -0.01199178397655487, 0.028739696368575096, -0.025277234613895416, 0.014826436527073383, 0.04720615595579147, -0.03211337700486183, 0.016678156331181526, -0.03896220028400421, 0.0024605034850537777, 0.030895808711647987, 0.026076264679431915, -0.03366070240736008, -0.0271923691034317, -0.01723620854318142, 0.00821858923882246, -0.024300644174218178, -0.025518212467432022, 0.013558135367929935, -0.007026386447250843, -0.004042708780616522, 0.00989274587482214, 0.01731230691075325, -0.007077118381857872, 0.027167003601789474, -0.015384488739073277, -0.010679093189537525, -0.056616947054862976, -0.0011034216731786728, -0.001907207304611802, -0.04081391915678978, -0.0319865457713604, 0.012530812062323093, -0.05605889484286308, 0.027395296841859818, -0.02762359194457531, 0.03510656580328941, 0.004442223813384771, 0.020597204566001892, -0.015422537922859192, 0.010006893426179886, -0.0072610219940543175, -0.02233477681875229, 0.047612011432647705, -0.00969615951180458, 0.0006860714638605714, 0.008503956720232964, -0.016005955636501312, -0.007616146467626095, 0.011275194585323334, 0.011465439572930336, -0.009835672564804554, -0.008370785042643547, 0.02988116629421711, 0.034929003566503525, -0.013279109261929989, -0.006500041577965021, 0.02787725254893303, 0.07031459361314774, 0.02085086517035961, 0.012841545976698399, 0.02114257402718067, -0.006382723804563284, 0.029779702425003052, 0.01335520762950182, -0.006690286565572023, -0.0413973368704319, -0.019798176363110542, 0.008522981777787209, -0.02711627073585987, -0.003465631976723671, -0.003624169621616602, -0.022005019709467888, -0.016627423465251923, -0.006319308653473854, 0.0009234815370291471, 0.026989441365003586, -0.0061988201923668385, -0.0459124892950058, 0.0035766083747148514, -0.003976122941821814, -0.02320990525186062, -8.907831215765327e-05, 0.01672888733446598, 0.016551325097680092, -0.011110315099358559, -0.1035948097705841, 0.005558328237384558, 0.007641512434929609, 0.02208111807703972, -0.018162067979574203, -0.009169815108180046, 0.024389425292611122, 0.036831457167863846, -0.0024525767657905817, -0.018047921359539032, 0.0025667238514870405, 0.0033673385623842478, -0.02970360592007637, 0.0012413493823260069, 0.025594310835003853, -0.026583585888147354, -0.008922495879232883, -0.00017994017980527133, 0.031910449266433716, -0.004077587276697159, 0.00026693768450058997, 0.010691775940358639, -0.0014989729970693588, 0.001791474875062704, 0.004775152541697025, 0.010019576177001, -0.020800134167075157, -0.01760401576757431, 0.005250765476375818, 0.038175854831933975, 0.026811879128217697, -0.05134081840515137, 0.015016681514680386, 0.033762168139219284, 0.03087044134736061, -0.04596322029829025, -0.005884915590286255, 0.0073180957697331905, 0.03515729680657387, 0.015067413449287415, 0.04621688276529312, -0.047510549426078796, 0.010190797038376331, -0.015156194567680359, 0.015447904355823994, -6.688304711133242e-05, -0.008821032010018826, 0.035258762538433075, 0.020647937431931496, -0.019620614126324654, -0.005846866872161627, -0.002718919888138771, -0.0022401362657546997, -0.006620530039072037, -0.028638232499361038, 0.009480549022555351, 0.01894841343164444, -0.003120020031929016, 0.012365932576358318, 0.011122997850179672, -0.020495740696787834, -0.004141001962125301, -0.009467865340411663, 0.0006892422097735107, 0.03513193130493164, -0.041524168103933334, 0.0003109318786300719, -0.01748986728489399, 0.009023960679769516, -0.059204280376434326, -0.0013111059088259935, -0.02087623067200184, -0.04662273824214935, -0.012841545976698399, 0.013152279891073704, 0.020089885219931602, 0.01246105507016182, -0.006576139945536852, -0.016754252836108208, -0.006557115353643894, -0.00235111266374588, -0.022588437423110008, 0.0015449489001184702, 0.003494168631732464, 0.005155642982572317, -0.0010360432788729668, 0.0388607382774353, 0.0023653809912502766, -0.03906366601586342, 0.015067413449287415, 0.02561967633664608, 0.01128153596073389, 0.016627423465251923, -0.012454713694751263, -0.006969313137233257, -0.016500594094395638, 0.014724972657859325, -0.009302986785769463, 0.03749097138643265, -0.021231355145573616, 0.04449199140071869, 0.04002757370471954, -0.023412832990288734, -0.05641401931643486, -0.03097190521657467, 0.009537622332572937, 0.001970622455701232, -0.012086906470358372, 0.011148364283144474, 0.0011731781996786594, 0.012397640384733677, 0.042056854814291, 0.002327332040295005, 0.02087623067200184, -0.009797623381018639, 0.035258762538433075, 0.04565883055329323, -0.017375720664858818, 0.012714715674519539, 0.015828393399715424, -0.026228461414575577, 0.008193222805857658, -0.008288346230983734, 0.021928921341896057, -0.028562134131789207, -0.029272383078932762, 0.016525959596037865, 0.006493700202554464, -0.014674240723252296, -0.06260332465171814, 0.004435881972312927, -0.021041110157966614, -0.034751441329717636, -0.014471312053501606, 0.021193306893110275, -0.007324437145143747, 0.014648874290287495, 0.03495436906814575, -0.018124017864465714, -0.004093440715223551, 0.008808349259197712, -0.01224544458091259, 0.01636108011007309, -0.005618572700768709, -0.009004935622215271, -0.00010879642650252208, -0.018707437440752983, -0.010057625360786915, -0.006385894492268562, -0.002099037868902087, 0.006595164071768522, -0.034168023616075516, 0.0037858779542148113, -0.057022806257009506, 0.020711353048682213, -0.00480051850900054, 0.005862720310688019, -0.05250765383243561, -0.03094653971493244, 0.02058452181518078, 0.03203727677464485, -0.014116188511252403, 0.004794177133589983, -0.012898619286715984, 0.0047117373906075954, 0.032088011503219604, -0.000556070648599416, -0.005498084239661694, -0.01702059619128704, -0.010869338177144527, 0.004886128939688206, -0.05230472609400749, 0.05433400720357895, 0.006664920598268509, 0.01384984515607357, -0.018174750730395317, 0.05818964168429375, 0.0036939261481165886, 0.008440542034804821, 0.0465720072388649, 0.0026507487054914236, 0.025708457455039024, -0.0026047728024423122, 0.02627919241786003, -0.004959056153893471, -0.02729383297264576, 0.00212757452391088, 0.012283493764698505, 0.04479638487100601, 0.06108136847615242, 0.0032088011503219604, 0.030692879110574722, 0.015219610184431076, 0.010609336197376251, 0.04522760584950447, 4.042708678753115e-05, 0.02871433086693287, 0.015270342119038105, 0.024681134149432182, 0.00198172009550035, 0.0020245250780135393, 0.027902618050575256, -0.023412832990288734, -0.030845075845718384, -0.0161835178732872, -0.007482974790036678, 0.04662273824214935, -0.023641126230359077, -0.014724972657859325, 0.02114257402718067, 0.018707437440752983, -0.015955224633216858, -0.042437344789505005, -0.01993768848478794, 0.008694201707839966, -0.014839119277894497, -0.01171909924596548, -0.0006809189799241722, 0.028156278654932976, 0.006785409525036812, -0.011268852278590202, -0.031504593789577484, -0.018060604110360146, 0.008009319193661213, -0.005082715302705765, 0.026558218523859978, 0.0035131932236254215, 0.010583970695734024, -0.0008648225921206176, -0.0006852787919342518, -0.00913176592439413, -0.021624529734253883, -0.011230804026126862, -0.0021719650831073523, 0.022474290803074837, -0.007901513949036598, 0.020926963537931442, 0.00925859622657299, 0.006284430623054504, 0.022055750712752342, -0.0025857482105493546, -0.008878105320036411, 0.007781025487929583, -0.007679561618715525, -0.0017629381036385894, -0.007666878402233124, -0.02762359194457531, 0.030895808711647987, -0.009670794010162354, 0.017578648403286934, -0.01672888733446598, -0.007184924092143774, 0.0355631560087204, 7.783205364830792e-05, 0.022727951407432556, 0.011776173487305641, 0.02266453579068184, 0.03386363014578819, 0.01133226789534092, 0.028638232499361038, 0.004886128939688206, -0.010063966736197472, 0.004844909068197012, 0.007140533532947302, -0.020901598036289215, -0.0191006101667881, -0.005945160053670406, -0.00304233655333519, 0.018314262852072716, 0.004033196717500687, -0.014128871262073517, 0.02955140918493271, 0.024757232517004013, 0.019379636272788048, -0.007704927586019039, -0.012353249825537205, 0.014674240723252296, -0.051518380641937256, 0.0271923691034317, 0.01974744349718094, -0.024795280769467354, -0.0368821881711483, -0.003389533841982484, -0.0029329457320272923, 0.007508340757340193, -0.006658579222857952, -0.005605889484286308, -0.030515316873788834, 0.02168794348835945, -0.024807963520288467, 0.042767103761434555, -0.0011826904956251383, 0.016411812976002693, -0.013456671498715878, 0.03135239705443382, -0.018834266811609268, -0.007432242855429649, -0.011161047033965588, 0.03563925251364708, -0.007299071177840233, -0.03353387489914894, 0.03355924040079117, -0.008002977818250656, -0.05154374614357948, 0.02846067026257515, -0.003532217815518379, 0.005041495896875858, -0.04058562591671944, -0.028815794736146927, -0.016995230689644814, -0.014927900396287441, 0.012981059029698372, -0.00653174938634038, 0.006702969782054424, 0.03137776255607605, 0.01723620854318142, -0.04345198720693588, 0.002219526330009103, -0.03254459798336029, -0.010989826172590256, -0.004017342813313007, 0.0025572115555405617, 0.02721773460507393, 0.028409937396645546, -0.00876395870000124, 0.020965011790394783, 0.007983953692018986, -0.030337754637002945, -0.005542474333196878, 0.031504593789577484, 0.02412308193743229, -0.013963991776108742, 0.015003998763859272, 0.01523229293525219, -0.013152279891073704, -0.000509302073623985, 0.012213736772537231, -0.008529323153197765, 0.007039069663733244, -0.0015798271633684635, -0.01461082510650158, 0.028054814785718918, -0.0006971691036596894, 0.018567923456430435, 0.01171909924596548, 0.03203727677464485, 0.011655684560537338, -0.01246105507016182, -0.02091428078711033, -0.028080180287361145, 0.04984422028064728, -0.0228167325258255, -0.012010809034109116, 0.0371612124145031, 0.011268852278590202, 0.008231271989643574, 0.03193581476807594, -0.030337754637002945, -0.003944415599107742, -0.011015192605555058, -0.002435137517750263, 0.003021726617589593, 0.02544211409986019, -0.016564007848501205, 0.006652237847447395, -0.022207947447896004, -0.021408917382359505, 0.008002977818250656, -0.002224282594397664, 0.047180790454149246, 0.038505613803863525, 0.038175854831933975, -0.005551986861974001, -0.0018707436975091696, -0.026482120156288147, -0.01906256191432476, 0.004175880458205938, 0.054536934942007065, 0.016449861228466034, 0.018098652362823486, 0.003086727112531662, -0.020571839064359665, -0.04461882263422012, -0.00945518258959055, -0.0003489808877930045, -0.013621550984680653, 0.003414900042116642, -0.0060624778270721436, -0.012175687588751316, 0.04456809163093567, -0.03147922456264496, 0.02861286699771881, -0.03251923248171806, 0.012220078147947788, 1.594046079844702e-05, 0.0012143980711698532, -0.006420772988349199, 0.012981059029698372, -0.002255990169942379, 0.0015671441797167063, -0.006011745892465115, -0.021041110157966614, 0.028105545789003372, -0.005551986861974001, 0.002338429680094123, -0.015790345147252083, 0.009068351238965988, 0.002812457038089633, 0.013735697604715824, -0.015574733726680279, -0.04058562591671944, 0.022727951407432556, 0.02390746958553791, -0.03363533690571785, -0.010463481768965721, -0.031428493559360504, -0.01960793137550354, 0.03155532479286194, -0.02431332692503929, 0.01560010015964508, -0.03840414807200432, -0.04603932052850723, -0.026887977495789528, -0.010235187597572803, 0.015321074053645134, 0.03629877045750618, 0.013570819050073624, 0.021928921341896057, -0.011763489805161953, 0.06929995864629745, -0.00017409410793334246, -0.030261658132076263, -0.03429485484957695, 0.004401003941893578, 0.029931899160146713, 0.015650831162929535, 0.026329925283789635, 0.006106868386268616, 0.014788387343287468, 0.010920070111751556, -0.014407897368073463, 0.008186881430447102, 0.0030391658656299114, 0.023514296859502792, -0.0119727598503232, -0.013875210657715797, -0.0030803855042904615, -0.01622156798839569, -0.04038269817829132, -0.027725055813789368, 0.009226888418197632, 0.0034624612890183926, -0.02026744745671749, -0.02175135910511017, 0.006141746882349253, 0.01949378289282322, -0.06032038480043411, 0.014471312053501606, 0.019557198509573936, 0.03728804364800453, -0.014737655408680439, -0.012714715674519539, 0.00807273481041193, -0.008167857304215431, -0.0036622185725718737, -0.008453224785625935, -0.016208885237574577, 0.003804902546107769, 0.004102953244000673, 0.0028806282207369804, 0.020039152354002, -0.009918112307786942, 0.023412832990288734, -0.0006246381672099233, -0.016120104119181633, -0.019848907366394997, -0.012676666490733624, 0.008580055087804794, 0.010178114287555218, -0.03373680263757706, -0.021434282884001732, -0.011731782928109169, -0.027572859078645706, 0.015498636290431023, 0.031174834817647934, 0.004806859884411097, 0.009125424548983574, -0.008827373385429382, -0.022068433463573456, -0.006639554630964994, 0.03911439701914787, -0.001843792269937694, -0.0003432338999118656, 0.005054178647696972, 0.039596352726221085, -0.01964597962796688, 0.03746560588479042, 0.02085086517035961, 0.0191006101667881, 0.0072102900594472885, -0.005025641992688179, -0.002064159605652094, 0.0018739145016297698, 0.020546473562717438, -0.014991316013038158, -0.007521023973822594, 0.018631339073181152, 0.024947477504611015, 0.02223331294953823, -0.021294770762324333, -0.0010154333431273699, -0.0017645235639065504, 0.014128871262073517, 0.010989826172590256, 0.04256417602300644, 0.009905429556965828, -0.017984505742788315, 0.03470071032643318, -0.011585927568376064, -0.010425432585179806, 0.012708374299108982, -0.004540516994893551, -0.003804902546107769, 0.003151727607473731, -0.021408917382359505, -0.01497863233089447, -3.7776539102196693e-05, 0.03665389493107796, 0.01603132300078869, 0.011199096217751503, 0.00819956511259079, -0.03891146928071976, 0.025315284729003906, 0.0019309880444779992, -0.022169897332787514, 0.006129063665866852, 0.020838182419538498, -0.0021006232127547264, -0.015384488739073277, 0.0016789132496342063, 0.010882020927965641, -0.040255866944789886, -0.01789572462439537, -0.014243017882108688, 0.008700544014573097, 0.02062257193028927, -0.03657779470086098, 0.003548071486875415, 0.04829689487814903, 0.008110783994197845, 0.0031342883594334126, -0.02696407586336136, 0.033432409167289734, 0.010672750882804394, -0.027826519683003426, 0.02871433086693287, -0.026101630181074142, 0.0021957457065582275, -0.006709311157464981, 0.00821858923882246, 0.007229314651340246, -0.012201054021716118, 0.01943036913871765, -0.006071990355849266, -0.02019134908914566, 0.00781907420605421, 0.012892277911305428, -0.0026777000166475773, -0.020204031839966774, -0.0060973563231527805, -0.006439797580242157, -0.0079268803820014, -0.009924453683197498, 0.014699606224894524, 0.02048305794596672, -0.014027407392859459, -0.0004962226958014071, -0.00494637293741107, -0.022245995700359344, 0.01377374678850174, -0.0005707353702746332, 0.00039138970896601677, -0.051036424934864044, 0.04195538908243179, 0.03896220028400421, 0.0079268803820014, -0.005482230335474014, 0.01672888733446598, -0.004578565713018179, -0.0005588450585491955, -0.024592353031039238, 0.04253881052136421, 0.008611762896180153, 0.04078855365514755, -0.013494720682501793, 0.020597204566001892, -0.0057580857537686825, -0.04545590281486511, -0.03211337700486183, -0.006779067683964968, -0.002233794890344143, 0.007267363835126162, 0.009417133405804634, -0.006309796590358019, 0.048778850585222244, -0.037414874881505966, 0.015219610184431076, -0.004473931156098843, 0.002431966830044985, -0.0008997009135782719, -0.028562134131789207, 0.013545452617108822, -0.01931622065603733, 0.007299071177840233, -0.003487827256321907, -0.01927817240357399, -0.006125892978161573, 0.0307182464748621, -0.004714908078312874, 0.009042984806001186, -0.011522512882947922, 0.002203672658652067, -0.036019742488861084, -0.007140533532947302, 0.020102567970752716, -0.022385509684681892, -0.009835672564804554, 0.009829331189393997, -0.016094736754894257, 0.014357165433466434, 0.03140312805771828, -0.020318178460001945, 0.006490529514849186, -0.025974800810217857, 0.052355457097291946, 0.02762359194457531, -0.03614657372236252, -0.005092227831482887, 0.009360060095787048, 0.016716204583644867, -0.0262030940502882, 0.007153216749429703, 0.019468417391180992, -0.0397992804646492, -0.026000166311860085, 0.013418622314929962, 0.02248697355389595, 0.0021244038362056017, 0.047612011432647705, 0.013913259841501713, -0.006297113373875618, -0.020457692444324493, 0.0026777000166475773, 0.005983209237456322, 0.011021533980965614, 0.032088011503219604, 0.006671262439340353, 0.011027875356376171, 0.04581102356314659, -0.013190328143537045, 0.04063635692000389, 0.017045963555574417, 0.0071595581248402596, -0.0375417023897171, 0.019671345129609108, -0.01155422069132328, 0.00390002503991127, -0.0140654556453228, -0.021332819014787674, 0.0459124892950058, -0.023755274713039398, 0.034421682357788086, -0.030895808711647987, -0.0055266208946704865, 0.02419918030500412, -0.009353718720376492, -0.026507487520575523, -0.005694670602679253, 0.007781025487929583, -0.01456009317189455, 0.02929774858057499, 0.026355290785431862, 0.008668836206197739, -0.017667429521679878, 0.03120020031929016, 0.014116188511252403, -0.017692796885967255, -0.011294218711555004, 0.014826436527073383, -0.020977694541215897, -0.011287877336144447, 0.012213736772537231, 0.0032912406604737043, 0.00047957623610273004, -0.0010796410497277975, 0.00033689240808598697, 0.010958119295537472, 0.011858612298965454, -0.02528991736471653, -0.009144448675215244, 0.04956519603729248, 0.0020483057014644146, 0.018390361219644547, -0.006519066169857979, 0.020470375195145607, -0.02223331294953823, -0.0005746987881138921, -0.0005743024521507323, -0.05443546921014786, 0.013215694576501846, -0.014522043988108635, -0.008351760916411877, 0.027902618050575256, 0.010812264867126942, 0.006091014482080936, -0.013215694576501846, -0.003985635470598936, 0.002898067468777299, 0.02838457189500332, -0.020863547921180725, -0.018022553995251656, -0.0045373463071882725, 0.032011911273002625, -0.006880532018840313, 0.0013610452879220247, -0.01093275286257267, -0.027598226442933083, -0.022905511781573296, 0.005352229345589876, -0.01567619852721691, -0.013684965670108795, -0.04913397505879402, 0.009734208695590496, -0.03165678679943085, -0.004540516994893551, 0.027826519683003426, -0.014116188511252403, 0.003246850101277232, -0.0035766083747148514]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" (online)
( )+ EOS 0,1,
2,12
1(+1(12
k= 0
012
1+
2+1
(1+
)EOS
k= 1
012
1+
2+1
(1+
)EOS
k= 2
012
1+
2+1
(1+
)EOS
Figure 3. Running example and overview of DOMINO . (a) shows an example grammar, (b) the character level NFA for this language, (d)
one of the per-state subterminal trees for the grammar in (c). (e) shows how a parser can be used to prune this tree at inference time and
obtain token masks efficiently by traversing the tree.
int 0* [0-9]*0 [1-9]
0 [0-9]*
Figure 4. NFA for the intterminal from Fig. 3 (a). Traversed from
nodeintthis NFA accepts all legal inputs for the terminal.
further transitions, such as both accepting states in
Fig. 4, we also consider this a full terminal, but allow
further subterminals within the terminal NFA ( ).
•Start subterminal if starting from q0we reach a non-
accepting but valid state qαfor the NFA of the terminal.
We denote this as .
•End subterminal if starting from a state qαwithin
the NFA for αwe reach an accepting state for α. We
denote this as .
•Continuation subterminal if starting from a state qα
within the NFA for αwe reach another non-accepting
state for α. We denote this as .
We visit every state qinS, obtain the current (sub)terminal
αand, for each vocabulary token l∈ V, enumerate all possi-
ble subterminal sequences {αj
1, . . . , αj
mj}j. Typically there
is only one such sequence unless there is ambiguity in the
grammar, e.g., in C-style languages we can not be sure if
we are reading a variable name of a keyword. Ignoring these
edge cases, we show an example of this on the left hand side
of Fig. 3 (d) for the vocabulary given in Fig. 3 (c), where
we visualize the subterminals in the previously introduced
box notation with colors correspoding to the terminals in
Fig. 3 (b). Note that there may be tokens in the vocabulary
for which no continuation is possible, e.g., if we add an a
token to the language. After enumerating all these subtermi-
nal sequences, we organize them into a prefix tree Tq, where
we attach the corresponding vocabulary tokens las values
to the nodes. We formalize this procedure in Algorithm 2.Algorithm 2 Construct Terminal Tree
Input: CFG G, Alphabet Σ, V ocabulary V
Output: Scanner S
1:T={}
2:for all q∈S.states ()do
3: α←q.subterminal ()// get current (sub)terminal
4: for all l∈ V do
5: {αj
1, . . . , αj
mj}j←q.traverse (l)
6: T ← T ∪ { (αj
1, . . . , αj
mj), l}j
7: end for
8: Tq←PrefixTree (T)
9:end for
3.4. Parser
While subterminal trees can be pre-computed, we still need
a parser at inference time, to disallow illegal continuations.
For example, consider the prefix tree Fig. 3 (d). If so far, we
have observed the sequence (12and correctly advanced the
parser and scanner to this state, we are in an intterminal ,
that can still be extended further. Following the prefix tree
in Fig. 3 (d) would permit continuations such as (, which
are clearly illegal in the grammar. Thus, we need to disallow
these continuations dynamically by consulting the parser.
At inference time traversing the so-far generated sequence o
through the scanner and parser will result in a scanner state
Sand parser state P. The active state of Swill be a set
of states q1, . . . , s m. The active state of Pwill be a parser
that tracks rules that can match the output oso far. For each
of these nodes qiwe retrive the corresponding subterminal
treeTqiand use the parser to check which of the possible
5
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
continuations are","[0.006045412737876177, 0.06506045907735825, 0.05458979308605194, 0.00585798267275095, -0.002682790858671069, 0.0031068911775946617, 0.005314753390848637, 0.019746866077184677, -0.01155712641775608, 0.07913994789123535, 0.03463961184024811, -0.001774231786839664, -0.03695230931043625, 0.012643585912883282, 0.01313916314393282, -0.04081527143716812, 0.016862349584698677, 0.006172484252601862, 0.0400274321436882, 0.022771161049604416, 0.0702957957983017, -0.020458465442061424, -0.014219268225133419, 0.029251793399453163, -0.0016852819826453924, -0.018412617966532707, -0.0328097864985466, 0.04317879676818848, 0.020204322412610054, -0.06811016798019409, 0.03247940167784691, -0.03298768773674965, -0.016277821734547615, 0.009867079555988312, 0.03829926252365112, 0.05209919810295105, -0.005918341688811779, -0.0019155985210090876, -0.041806429624557495, 0.0034213922917842865, -0.025935234501957893, -0.021932490170001984, -0.03143741935491562, -0.020242443308234215, 0.02264408953487873, 0.045161109417676926, 0.0006703006220050156, 0.020560121163725853, -0.04030698910355568, -0.017891626805067062, -0.010985306464135647, -0.009504926390945911, -0.032098188996315, 0.020204322412610054, -0.04424619674682617, -0.05037102848291397, -0.059977613389492035, 0.009111005812883377, 0.04523735120892525, -0.027091581374406815, 0.010248293168842793, -0.015286666341125965, 0.030039634555578232, 0.0216275192797184, -0.047753360122442245, 0.03918876126408577, -0.042340125888586044, 0.036977723240852356, -0.019225874915719032, 0.0045332652516663074, 0.004250532016158104, 0.03031919151544571, 0.01413031853735447, -0.06302732229232788, -0.006690299138426781, 0.028286051005125046, 0.038629647344350815, 0.02660871110856533, 0.015998264774680138, -0.01404136884957552, 0.03702855110168457, 0.004908125381916761, 0.062315721064805984, -0.04635557904839516, 0.0029877617489546537, -0.015223131515085697, -0.02602418325841427, 0.0019060681806877255, -0.06140080839395523, -0.04536442086100578, -0.000425688544055447, 0.016709864139556885, -0.036901481449604034, -0.0007421752670779824, 0.07502284646034241, -0.014536947011947632, -0.024397673085331917, -0.04546608030796051, 0.013215405866503716, -0.014956281520426273, 0.03601198270916939, -0.054030679166316986, 0.028540194034576416, -0.020572829991579056, 0.051540084183216095, 0.0032720835879445076, -0.032174430787563324, 0.0407390296459198, -0.03222525864839554, -0.04226388409733772, -0.06409472227096558, -0.012160714715719223, 0.005336991045624018, -0.0136982761323452, 0.015528102405369282, -0.015337495133280754, -0.04635557904839516, -0.015667879953980446, -0.008177032694220543, -0.002326991641893983, 0.001240532728843391, 0.03308934345841408, -0.04152687266469002, -0.009860726073384285, -0.01251016091555357, 0.014968988485634327, -0.0016868703532963991, -0.017497705295681953, 0.00458727078512311, 0.018285546451807022, 0.0236225388944149, -0.033216413110494614, -0.0039169699884951115, -0.022758454084396362, -0.04963401332497597, -0.0029750547837466, -0.04348376765847206, 0.002303165616467595, 0.0008267570519819856, 0.029226379469037056, -0.0029146960005164146, -0.017154613509774208, 0.03133575990796089, 0.0284893661737442, -0.0021903899032622576, 0.008901338092982769, -0.06043506786227226, 0.050345614552497864, -0.045008622109889984, 0.0031195981428027153, 0.03524955362081528, -0.010343596339225769, -0.04971025884151459, -0.010832821018993855, 0.020992163568735123, -0.05702956020832062, -0.0328097864985466, 0.02444850094616413, -0.0027209122199565172, 0.03499541059136391, -0.040611959993839264, 0.017497705295681953, 0.04010367393493652, -0.00820244662463665, -0.013215405866503716, 0.011887512169778347, -0.019784986972808838, 0.03687606379389763, -0.055250562727451324, 0.004927186295390129, -0.006461570970714092, -0.051362182945013046, -0.04015450179576874, -0.02105570025742054, -0.044906966388225555, -0.02238994650542736, -0.02354629524052143, 0.0006564022041857243, -0.018870074301958084, -0.032860614359378815, 0.002033139346167445, 0.05652127414941788, -0.0304716769605875, -0.009523986838757992, 0.0020934981293976307, -0.02260596863925457, -0.011531712487339973, -0.022504311054944992, -0.011029780842363834, 0.012859606184065342, -0.003351503284648061, 0.058605242520570755, 0.07563278824090958, 0.004917656071484089, 0.033013101667165756, -0.054894763976335526, 0.07487035542726517, 0.019657915458083153, 0.019136924296617508, 0.010330889374017715, 0.023559002205729485, 0.009956029243767262, -0.0025588965509086847, -0.010477021336555481, 0.013062920421361923, 0.017612069845199585, 0.0465080626308918, 0.02311425283551216, 0.018730295822024345, -0.06434886157512665, 0.004231471102684736, -0.0017249917145818472, -0.022415362298488617, -0.005537128075957298, -0.08173220604658127, 0.05667376145720482, 0.02188166230916977, 0.006312262266874313, 0.028718093410134315, 0.006582288537174463, 0.018069526180624962, 0.027421968057751656, 0.07324384897947311, 0.030852889642119408, -0.019988302141427994, 0.043788738548755646, 0.020890507847070694, -0.008373992517590523, -0.007687808480113745, -0.0008331106510013342, 0.015820365399122238, 0.03024294786155224, 0.015439151786267757, -0.0533699095249176, -0.005273455288261175, -0.02390209399163723, -0.04531359300017357, -0.053878191858530045, -0.01885736733675003, -0.012090825475752354, -0.014880038797855377, 0.04338211193680763, 0.0637897476553917, 0.010375364683568478, 0.01407948974519968, 0.014104904606938362, -0.025325292721390724, -0.003405508352443576, -0.00087996810907498, 0.04755004867911339, 0.03735893592238426, -0.014409875497221947, -0.05070141330361366, 0.015019817277789116, -0.040688201785087585, 0.011893865652382374, -0.024130823090672493, 0.032098188996315, 0.02869267947971821, 0.03253022953867912, 0.002239630091935396, 0.0011912926565855742, -4.2365343688288704e-05, -0.00693173473700881, -0.004793761298060417, -0.035427454859018326, -0.017929747700691223, 0.006353560369461775, 0.02754903770983219, -0.06648365408182144, -0.049405287951231, -0.010712102986872196, 0.00011902998812729493, 0.0017345220549032092, -0.039747875183820724, -0.05682624503970146, -0.00036592537071555853, 0.03626612201333046, -0.01407948974519968, 0.05032020062208176, -0.038705889135599136, -0.02480429969727993, 0.08081728965044022, 0.012319553643465042, 0.001095989253371954, 0.005753149278461933, -0.018056819215416908, -0.020356807857751846, 0.003754954319447279, -0.022148512303829193, 0.01709107868373394, 0.04488155245780945, 0.027676109224557877, -0.020522000268101692, 0.0055847796611487865, -0.026507055386900902, 0.007135048508644104, 0.03687606379389763, 0.03438546881079674, -0.004253708757460117, 0.024461207911372185, -0.027447381988167763, 0.011277570389211178, 0.007624272722750902, -0.014117611572146416, 0.03369928523898125, -0.00016668169701006263, 0.01601097173988819, -0.013685569167137146, -0.006007291376590729, 0.004399840719997883, -0.03514789789915085, -8.458177762804553e-05, 0.028463950380682945, 0.0042473552748560905, -0.06312897801399231, 0.029048478230834007, -0.007891122251749039, 0.036571092903614044, -0.009257137775421143, 0.0030131761450320482, -0.010521496646106243, 0.037435177713632584, 0.007408251520246267, -0.016938593238592148, 0.041044000536203384, -0.007173169869929552, 0.028921406716108322, -0.003748600836843252, -0.03700313717126846, 0.012853252701461315, 0.0097336545586586, 0.0335213840007782, 0.05692790076136589, -0.03494458273053169, -0.023520881310105324, -0.03377552703022957, 0.03972246125340462, 0.0286672655493021, 0.060333412140607834, -0.08590013533830643, -0.028794337064027786, 0.007427312433719635, 0.03451254218816757, -0.05580967664718628, 0.013151870109140873, -0.012777009978890419, -0.0006929351948201656, 0.06719525903463364, 0.01734521985054016, 0.007128695026040077, -0.015845779329538345, 0.03021753393113613, -0.021805420517921448, 0.021297134459018707, 0.02627832628786564, 0.0034944582730531693, -0.021246306598186493, -0.008780620992183685, 0.008628135547041893, -0.02953135035932064, 0.02178000472486019, -0.019772280007600784, 0.03814677894115448, -0.00449832109734416, -0.02313966676592827, -0.03730810806155205, 0.015617052093148232, 0.02427060157060623, -0.0004705605679191649, 0.00549900671467185, 0.016430307179689407, 0.03344514220952988, 0.041450630873441696, -0.03418215736746788, -0.010445253923535347, -0.04272134229540825, -0.008971227332949638, 0.010286414995789528, 0.053776536136865616, -0.01043890044093132, 0.0029464636463671923, -0.036647338420152664, 0.01447341125458479, -0.016849642619490623, 0.004962130915373564, -0.016354065388441086, -0.018069526180624962, 0.005842098966240883, 0.010064040310680866, 0.005286162253469229, -0.023076131939888, 0.020394928753376007, 0.04582187905907631, 0.0027939782012254, -0.01399054005742073, -0.002466769888997078, 0.04383956640958786, 0.005889750551432371, 0.013685569167137146, 0.07420958578586578, 0.004009096883237362, -0.021907076239585876, -0.00872343871742487, -0.006645824294537306, -0.0064901621080935, 0.034614197909832, 0.024524744600057602, 0.03875672072172165, -0.0124402716755867, 0.03580866754055023, -0.025731919333338737, 0.03463961184024811, 0.0178535059094429, -0.024435793980956078, -0.013329770416021347, -0.04564397782087326, -0.052404168993234634, 0.033216413110494614, 0.05931684002280235, -0.013215405866503716, 0.003624706296250224, -0.008335871621966362, -0.0547931045293808, -0.020026423037052155, 0.004320421256124973, -0.025858990848064423, -0.018590517342090607, -0.002509656362235546, -0.03265730291604996, -0.010775638744235039, 0.007179523352533579, -0.022885525599122047, 0.006347206886857748, 0.0342583991587162, -0.0385788194835186, 0.026125840842723846, 0.020903214812278748, 0.002741561271250248, -0.05392902344465256, 0.01791704073548317, -0.014371753670275211, 0.05382736399769783, 0.004215587396174669, -0.02909930795431137, 0.004482436925172806, -0.03984953090548515, -0.03341972827911377, -0.0032291971147060394, -0.0328097864985466, -0.011512652039527893, -0.011188619770109653, 0.019619794562458992, 0.039747875183820724, -0.012325907126069069, -0.03024294786155224, 0.09067801386117935, -0.010216525755822659, 0.052912451326847076, 0.010381718166172504, 0.023279445245862007, -0.008640842512249947, -0.04737214744091034, -0.02044575847685337, -0.011258509010076523, 0.018374497070908546, 0.0032879675272852182, 0.010858234949409962, 0.07558195292949677, 0.043102554976940155, -0.05187046900391579, -0.014155732467770576, 0.02026785910129547, -0.013545790687203407, -0.007414605002850294, 0.033114757388830185, 0.022542431950569153, -0.04389039799571037, 0.02678661048412323, -0.019416481256484985, -0.021754590794444084, -0.004053571727126837, 0.03400425612926483, 0.0034595136530697346, 0.02372419461607933, 0.09713323414325714, 0.018082233145833015, -0.0004157611110713333, 0.010280060581862926, 0.000221778973354958, -0.000856142258271575, -0.011290277354419231, 0.007808526046574116, -0.013444134034216404, 0.051184285432100296, -0.004123460967093706, 0.007548030000180006, -0.05392902344465256, -0.035859495401382446, -0.03039543330669403, 0.014994403347373009, 0.005086025223135948, -0.00874249916523695, 0.019086096435785294, 0.0022761630825698376, -0.06414555013179779, 0.041730184108018875, 0.018984438851475716, 0.004460199736058712, 0.013571205548942089, 0.01407948974519968, -0.03847716376185417, -0.0421876423060894, -0.011728673242032528, -0.014003247022628784, -0.0004995486815460026, -0.025109270587563515, -0.008278689347207546, 0.000567055307328701, 0.006766541860997677, 0.010591385886073112, -0.005197212565690279, 0.008393053896725178, -0.022364532575011253, 0.0136982761323452, -0.013037506490945816, 0.00386614166200161, -0.09581169486045837, -0.0029274029657244682, -0.015540809370577335, 0.04188267141580582, -0.005908811464905739, -0.010089454241096973, 0.0223518256098032, -0.02246619015932083, 0.007668747566640377, -0.01160795520991087, 0.014155732467770576, -0.03176780417561531, -0.030878303572535515, -0.0031751918140798807, -0.007999132387340069, 0.0025795456022024155, 0.005864336621016264, 0.010038625448942184, 0.013406013138592243, 0.011582541279494762, -0.003542110091075301, -0.017434170469641685, 0.03489375486969948, -0.03626612201333046, -0.012560988776385784, -0.00892675295472145, -0.04124731570482254, -0.026049599051475525, 0.008920399472117424, 0.019518138840794563, 0.010985306464135647, -0.05126052722334862, -0.03941749036312103, -0.028209809213876724, -0.016379479318857193, 0.010648567229509354, -0.02588440477848053, 0.012726182118058205, 0.020039130002260208, -0.006925380788743496, -0.0005436265491880476, -0.00406627869233489, 0.033623043447732925, -0.01889548823237419, -0.014346339739859104, 0.023787731304764748, 0.004806468728929758, 0.00816432572901249, -0.07415875792503357, 0.03479209914803505, 0.00022058768081478775, -0.022123098373413086, 0.006817370653152466, -0.013672862201929092, -0.03710479289293289, 0.021983319893479347, -0.011944693513214588, -0.007624272722750902, 0.01259911060333252, 0.0180314052850008, 0.05286162346601486, -0.02566838450729847, -0.006772895343601704, 0.014536947011947632, -0.005066964775323868, -0.039646219462156296, 0.025681091472506523, -0.05021854117512703, -0.01942918822169304, 0.005883397068828344, -0.030878303572535515, -0.04477989301085472, -0.01395241916179657, 0.019696038216352463, -0.004790584556758404, 0.01343142706900835, 0.01737063378095627, -0.004326774738729, -0.012465685606002808, -0.005832568742334843, -0.018018698319792747, 0.03377552703022957, 0.025007614865899086, -0.029607592150568962, 0.0479566752910614, -0.02549048513174057, 0.0014406698755919933, -0.030979961156845093, 0.005009782500565052, -0.02996339090168476, 0.006944441702216864, 0.04958318546414375, -0.015439151786267757, 0.00020013716130051762, 0.016315942630171776, -0.016900470480322838, -0.0054481783881783485, 0.008348578587174416, 0.02274574711918831, -0.01589660905301571, 0.00749084772542119, -0.03479209914803505, -0.04617767781019211, -0.043026313185691833, -0.009981443174183369, 0.02203414775431156, -0.003650120459496975, -0.03972246125340462, -0.00998779758810997, 0.005762679502367973, -0.007795818615704775, 0.007058805786073208, -0.007916536182165146, 0.013393305242061615, -0.024524744600057602, 0.0064933388493955135, -0.039824116975069046, 0.0389346182346344, 0.03804511949419975, -0.03204736113548279, 0.02458827942609787, -0.01485462486743927, -0.027523623779416084, -0.024575572460889816, -0.008348578587174416, 0.015731416642665863, 0.005807154346257448, 0.008539184927940369, -0.031157860532402992, 0.0048477668315172195, -0.032606471329927444, 0.008437528274953365, 0.005000252276659012, -0.007872061803936958, -0.0038216665852814913, -0.017840798944234848, 0.00051702099153772, -0.015045231208205223, 0.029404278844594955, 0.02671036869287491, 0.04106941446661949, -0.013329770416021347, -0.00921266246587038, -0.016671743243932724, 0.02336839586496353, 0.018374497070908546, -0.00022257317323237658, 0.025681091472506523, -0.032428573817014694, -0.02278386801481247, -0.033623043447732925, 0.00928255170583725, 0.0021236776374280453, -0.048769932240247726, 0.004574563819915056, -0.05065058544278145, 0.022847402840852737, -0.014689432457089424, 0.017840798944234848, 0.002606548136100173, -0.02981090545654297, 0.01687505654990673, 0.006286848336458206, 0.006432979833334684, -0.0027669756673276424, 0.019378360360860825, -0.02178000472486019, -0.0057722097262740135, -0.009848019108176231, -0.01734521985054016, 0.02627832628786564, -0.0216275192797184, -0.04015450179576874, -0.0200137160718441, 0.0004006714152637869, -0.021030286327004433, -0.012408503331243992, -0.015731416642665863, -0.04239095747470856, 0.0081134969368577, 0.030954547226428986, 0.014918160624802113, -0.02339380979537964, 0.009657411836087704, 0.025325292721390724, -0.0328097864985466, 0.0234319306910038, -0.01489274576306343, 0.014193854294717312, 0.025693798437714577, -0.048185404390096664, 0.004749286454170942, -0.05469144880771637, -0.008736145682632923, 0.025337999686598778, 0.004094869829714298, -0.004472906701266766, -0.02076343633234501, -0.003662827657535672, 0.013266234658658504, -0.019276702776551247, 0.004530088510364294, 0.019136924296617508, -0.027345724403858185, 0.021868955343961716, -0.010311828926205635, 0.0005309194093570113, -0.01503252424299717, 0.02859102189540863, -0.03413132578134537, -0.018438031896948814, -0.05702956020832062, -0.017243564128875732, 0.0030370019376277924, -0.03842633590102196, -0.036647338420152664, 0.014231975190341473, -0.0353257954120636, 0.01407948974519968, -0.02909930795431137, 0.0290230643004179, -0.0165827926248312, 0.01537561696022749, -0.02022973634302616, 0.010337242856621742, 0.005311576649546623, -0.027574453502893448, 0.04279758408665657, -0.0019267172319814563, -0.0009697121568024158, 0.022046854719519615, 0.0012182951904833317, 0.004603154491633177, 0.01571870967745781, -0.000373668794054538, -0.015070646069943905, -0.009295258671045303, 0.019784986972808838, 0.038883790373802185, -0.019124217331409454, -0.009307966567575932, 0.04777877405285835, 0.07598858326673508, 0.010934477671980858, 0.0056514921598136425, 0.007897475734353065, 0.0009498572908341885, 0.030192120000720024, -0.001778996898792684, 0.0007556765922345221, -0.05342073738574982, -0.041196487843990326, -0.004024980589747429, -0.01925128884613514, 0.013660155236721039, -0.01223695743829012, -0.015566223300993443, -0.0007100104121491313, -0.023025304079055786, 0.012853252701461315, 0.038985446095466614, -0.002711381996050477, -0.04244178533554077, -0.012383089400827885, -0.009047470055520535, -0.04066278785467148, -0.006242373026907444, 0.010305475443601608, -0.0033451495692133904, -0.0006516370340250432, -0.11151769757270813, -0.0034595136530697346, 0.014536947011947632, 0.040256161242723465, 0.011658784002065659, -0.012116240337491035, 0.02386397309601307, 0.017789969220757484, 0.016900470480322838, -0.02029327303171158, -0.0374860055744648, -0.005730911623686552, -0.02115735597908497, -0.027701523154973984, 0.015566223300993443, -0.032174430787563324, -0.00953669473528862, -0.0058770435862243176, 0.02213580533862114, -0.015388323925435543, -0.029226379469037056, -0.014409875497221947, -0.04195891320705414, 0.012109886854887009, -0.0005364787648431957, -0.020026423037052155, -0.018870074301958084, 0.015667879953980446, -0.019391067326068878, 0.04691469296813011, 0.019403774291276932, -0.04640640690922737, -0.006880905944854021, 0.05174339562654495, 0.018298255279660225, -0.04424619674682617, -0.00042251177364960313, 0.01734521985054016, 0.036901481449604034, -0.017510412260890007, 0.02158939838409424, -0.05057434365153313, 0.018145769834518433, -0.007262119557708502, 0.015769537538290024, -0.0091936020180583, -0.007681454531848431, 0.03158990293741226, 0.0054799458011984825, -0.004885888192802668, -0.03283520042896271, -0.0027463266160339117, 0.0221739262342453, -0.003869318403303623, 0.003977329004555941, 0.005184505600482225, 0.024092702195048332, -0.003977329004555941, 0.027320310473442078, 0.010470667853951454, 0.001162701635621488, 0.013037506490945816, 0.005082848481833935, 0.006363091059029102, 0.009848019108176231, -0.052912451326847076, 0.014549653977155685, -0.01762477681040764, 0.000364138453733176, -0.04648264870047569, -0.0027923898305743933, 0.00802454724907875, -0.008437528274953365, 0.009034763090312481, 0.003856611205264926, 0.01691317744553089, 0.00928255170583725, 0.011836683377623558, -0.021868955343961716, -0.014651310630142689, 6.194721208885312e-05, -0.0031132446601986885, 0.0029750547837466, -0.0021808596793562174, 0.022758454084396362, -0.015883902087807655, 0.016125336289405823, 0.0052766320295631886, -0.037409763783216476, -0.014104904606938362, 0.028209809213876724, -0.004552326165139675, 0.01016569696366787, -0.022974474355578423, -0.02376231737434864, -0.03962080180644989, 0.0014438466168940067, 0.0003152954450342804, 0.029988806694746017, -0.010737516917288303, 0.05004064366221428, 0.023419223725795746, -0.018920904025435448, -0.05626713111996651, -0.02015349455177784, 0.018666760995984077, 0.0020696723368018866, -0.010877295397222042, 0.02513468638062477, 0.008914045058190823, 0.008863217197358608, 0.013228112831711769, 0.002169740851968527, 0.006108948495239019, -0.019263995811343193, 0.02826063707470894, 0.03946831822395325, -0.0011769970878958702, 0.012033644132316113, 0.015312081202864647, 0.0020363160874694586, 0.025681091472506523, -0.033216413110494614, 0.014219268225133419, -0.04592353478074074, -0.022008733823895454, 0.016646329313516617, -0.005575249437242746, -0.010985306464135647, -0.06572122871875763, 0.0073637766763567924, -0.008551892824470997, -0.030522504821419716, -0.012109886854887009, 0.037130206823349, -0.0029067539144307375, 0.010292768478393555, 0.04106941446661949, -0.0081134969368577, -0.005648315418511629, 0.0038534344639629126, 0.005511713679879904, 0.01878112554550171, 0.0032816140446811914, -0.017103785648941994, -0.01917504519224167, -0.019200459122657776, -0.02566838450729847, -0.0075353230349719524, -0.0016614560736343265, 0.008227860555052757, 0.003818489843979478, 0.021868955343961716, -0.042950067669153214, 0.01101707387715578, -0.004831882659345865, -0.001899714581668377, -0.043356698006391525, -0.022199340164661407, 0.0015423268778249621, 0.012408503331243992, -9.207698894897476e-05, -0.019632501527667046, -0.02134796418249607, -0.00809443648904562, 0.005997761152684689, -0.0019076565513387322, -0.0009101475588977337, -0.03679982200264931, 0.008621782064437866, -0.01903526671230793, -0.02256784774363041, 0.04945611581206322, 0.0038280203007161617, 0.023838559165596962, -0.008177032694220543, 0.05702956020832062, -0.0029496403876692057, 0.01245933212339878, 0.02005183696746826, 0.0066648852080106735, 0.02062365785241127, -0.01104884222149849, 0.014994403347373009, 0.021513156592845917, -0.043356698006391525, 0.02617666870355606, 0.013075627386569977, 0.02765069529414177, 0.03951914608478546, 0.0031767801847308874, 0.02311425283551216, -0.008799681439995766, 0.009809897281229496, 0.010337242856621742, -0.002115735551342368, 0.024397673085331917, 0.005419587250798941, 0.030166706070303917, 0.001219089375808835, -0.03039543330669403, 0.04221305623650551, -0.03453795611858368, -0.011029780842363834, -0.00784029345959425, 0.009682826697826385, 0.025795456022024155, 0.0022094505839049816, -0.013939712196588516, 0.01564246602356434, 0.018514275550842285, -0.014460703358054161, -0.043280456215143204, -0.013558498583734035, -0.020128080621361732, -0.019086096435785294, 0.013545790687203407, 0.0012373558711260557, 0.0040059201419353485, 0.0023206379264593124, -0.008863217197358608, -0.03499541059136391, -0.02996339090168476, 0.013355184346437454, -0.0013771342346444726, 0.03514789789915085, 0.03184404596686363, 0.020356807857751846, 0.0012317965738475323, -0.006683945655822754, -0.014867331832647324, -0.014028661884367466, -0.005241687409579754, -0.010445253923535347, 0.011233095079660416, 0.0065759350545704365, 0.018222011625766754, 0.018590517342090607, 0.0004300566215533763, 0.01697671413421631, 0.004514204803854227, -0.004644452594220638, 0.00827233586460352, -0.016138043254613876, 0.00024262660008389503, -0.01759936287999153, -0.012313200160861015, 0.04617767781019211, -0.0270407535135746, 0.01252922136336565, -0.011887512169778347, -0.002832099562510848, 0.04823623225092888, 0.018412617966532707, 0.02256784774363041, -0.00622013583779335, 0.027523623779416084, 0.045415252447128296, -4.653486757888459e-05, 0.028387708589434624, 0.01433363277465105, -0.025210928171873093, 0.013240819796919823, -0.011671490967273712, -0.0239783376455307, -0.01716732047498226, -0.013164577074348927, 0.010807406157255173, 0.03433464094996452, 0.023787731304764748, -0.0027034399099648, 0.031361173838377, 0.009651058353483677, 0.014486118219792843, -0.019619794562458992, -0.03247940167784691, 0.010292768478393555, -0.03504623845219612, -0.004949423484504223, -0.009485865943133831, -0.024689937010407448, -0.018183890730142593, 0.008774267509579659, 0.013469547964632511, 0.01205905806273222, -0.0164048932492733, -0.019556259736418724, -0.014270097017288208, -0.009828957729041576, -0.030954547226428986, 0.038273848593235016, -0.008602720685303211, 0.008227860555052757, -0.003793075680732727, 0.029582178220152855, -0.007223998196423054, -0.0007064365199767053, 0.012465685606002808, 0.010832821018993855, -0.04653347656130791, -0.024829715490341187, 0.030014220625162125, -0.0006115302094258368, -0.031132446601986885, 0.03588490933179855, -0.008443881757557392, 0.034563370048999786, -0.032936856150627136, -0.041120242327451706, -0.002009313553571701, 0.013005738146603107, 0.03575783967971802, -0.0136982761323452, 0.0049303630366921425, 0.04139979928731918, 0.025172807276248932, -0.030954547226428986, -0.008844156749546528, -0.013253527693450451, -0.01654467172920704, -0.017904333770275116, -0.006378974765539169, 0.001745640765875578, 0.008666256442666054, -0.023355688899755478, 0.005295692943036556, -0.006728420499712229, -0.005263925064355135, 0.0142446830868721, 0.02512197755277157, 0.024257894605398178, -0.021792713552713394, 0.028972236439585686, -0.003297497984021902, -0.018183890730142593, -0.009511279873549938, -0.005324283614754677, 0.006236019544303417, 0.010534203611314297, -0.02570650540292263, 0.010985306464135647, 0.023025304079055786, -0.007744990289211273, 7.66894590924494e-05, 0.0060422359965741634, 0.02333027496933937, 0.013888883404433727, -0.01691317744553089, -0.0037962524220347404, -0.03575783967971802, 0.05296327918767929, -0.012993031181395054, -0.014308217912912369, 0.0245120357722044, 0.010241939686238766, 0.004447492305189371, 0.02729489654302597, -0.04910031706094742, -0.021614812314510345, 0.0038407272659242153, 0.010311828926205635, 0.009079238399863243, 0.0026113134808838367, -0.032072775065898895, 0.024715350940823555, -0.02264408953487873, -0.008418467827141285, 0.0012556223664432764, 0.00912371277809143, 0.017218148335814476, 0.05159091204404831, 0.03014129213988781, -0.003707302501425147, 0.012713474221527576, -0.009746361523866653, -0.017840798944234848, -0.01404136884957552, 0.0270407535135746, 0.012726182118058205, 0.034156739711761475, -0.0011372873559594154, -0.034232985228300095, -0.06079086661338806, -0.015667879953980446, -0.007154108956456184, 0.00756073696538806, -0.0032291971147060394, 0.0033578567672520876, -0.025439657270908356, 0.0367744080722332, -0.007973718456923962, 0.02808273769915104, -0.0021935668773949146, 0.00908559188246727, 0.018196597695350647, 0.0008180208969861269, -0.01305021345615387, 0.02382585220038891, -0.00854553934186697, -0.006995270028710365, 0.006410742644220591, -0.021932490170001984, 0.0252363421022892, -0.007065159268677235, 0.010959891602396965, -0.028972236439585686, -0.0071604629047214985, -0.001007833518087864, 0.0054068798199296, -0.013583912514150143, -0.06516211479902267, -0.016849642619490623, 0.009911554865539074, -0.02119547873735428, -0.004152051638811827, -0.0349699966609478, 0.006594995968043804, 0.012465685606002808, -0.02894682250916958, 0.041730184108018875, -0.028184395283460617, -0.044551167637109756, -0.018107647076249123, -0.0016805167542770505, 0.008539184927940369, 0.032174430787563324, 0.02437225915491581, 0.010375364683568478, 0.003611999098211527, 0.06861845403909683, 0.005340167786926031, -0.025858990848064423, -0.05072682723402977, 0.0012254429748281837, 0.029048478230834007, 0.010673982091248035, 0.03618988022208214, 0.016786107793450356, 0.004050394985824823, -0.010820114053785801, 0.00037962524220347404, 0.005985054187476635, 0.006382151506841183, 0.013228112831711769, -0.016633622348308563, -0.018374497070908546, -0.012128947302699089, -0.021436912938952446, -0.04089151695370674, -0.019022559747099876, 0.005861159414052963, -0.01813306100666523, -0.03189487382769585, -0.01936565339565277, -0.01268806029111147, -0.008933106437325478, -0.037511423230171204, 0.0073637766763567924, 0.01679881475865841, 0.032098188996315, -0.006293201819062233, -0.016671743243932724, 0.005044727120548487, 0.001634453423321247, 0.006448864005506039, -0.006099418271332979, -0.02519822120666504, -0.01059773936867714, 0.009517633356153965, 0.005248040892183781, 0.02083967812359333, -0.017764555290341377, 0.01738334260880947, -0.01164607610553503, -0.011226741597056389, -0.027574453502893448, 0.0021030285861343145, 0.008323164656758308, 0.0057054972276091576, -0.05382736399769783, -0.0364186093211174, -0.0029448752757161856, -0.0392904169857502, 0.012198836542665958, 0.03153907507658005, 0.022936353459954262, -0.004660336766391993, 0.011144145391881466, -0.004495143890380859, 0.004739756230264902, 0.023736901581287384, 0.011773147620260715, 0.0021935668773949146, 0.02296176739037037, 0.043356698006391525, -0.00460633123293519, 0.035859495401382446, 0.006893613375723362, 0.023076131939888, 0.009028409607708454, -0.01842532493174076, 0.008412114344537258, 0.0052226269617676735, 0.015057938173413277, -0.004425255116075277, -0.021932490170001984, 0.007548030000180006, 0.05560636147856712, 0.012751596048474312, -0.006093064788728952, -0.00818338617682457, -0.007586151361465454, 0.013444134034216404, 0.0247026439756155, 0.02242806926369667, 0.019060682505369186, -0.02841312251985073, 0.05555553361773491, 0.017789969220757484, -0.0236225388944149, 0.029480520635843277, -0.007217644713819027, 0.001826648716814816, -0.00532746035605669, -0.02105570025742054, -0.007891122251749039, 0.003980505745857954, 0.03128493204712868, 0.00946680549532175, 0.0028972236905246973, -0.019950179383158684, -0.01498169545084238, 0.039061691612005234, -0.007706868927925825, -0.026939095929265022, 0.00917454157024622, 0.015947436913847923, 0.0018933610990643501, 0.002033139346167445, 0.017802676185965538, 0.0028352763038128614, -0.021716469898819923, -0.017726434394717216, -0.029556764289736748, 0.014841917902231216, -0.013202698901295662, -0.022237461060285568, 0.008983934298157692, 0.04231471195816994, 0.013024799525737762, -0.018590517342090607, 0.0031958408653736115, 0.03006504848599434, 0.015096060000360012, -0.012973970733582973, 0.031386587768793106, -0.024613693356513977, -0.004050394985824823, -0.006248726975172758, -0.0033133819233626127, 0.017980575561523438, 0.004666690248996019, 0.007567090447992086, -0.005375112406909466, 0.010413485579192638, 0.0018822422716766596, 0.01889548823237419, -0.008964873850345612, -0.022631382569670677, -0.007592504844069481, -0.013533083721995354, -0.011684197932481766, 0.005572072695940733, -0.00011803724191850051, 0.002139561576768756, 0.0070715127512812614, -0.007802172563970089, -0.014384460635483265, -0.03324182704091072, 0.004542795941233635, 0.00622966606169939, -0.01575683057308197, -0.0268628541380167, 0.029505934566259384, 0.047499217092990875, -0.0039550913497805595, 0.016887763515114784, -0.01494357455521822, -0.010127575136721134, 0.0022999888751655817, -0.021119235083460808, 0.03735893592238426, -0.003044943790882826, 0.031666144728660583, -0.012745242565870285, 0.022580554708838463, 0.001942601171322167, -0.03247940167784691, -0.02221204712986946, 0.004666690248996019, 0.020534707233309746, 0.010534203611314297, 0.020954042673110962, -0.033877186477184296, 0.04711800441145897, -0.01308833435177803, 0.00584845244884491, -0.009701887145638466, 0.008539184927940369, 0.005028842948377132, -0.020725315436720848, 0.004663513507694006, -0.009943322278559208, -0.0022189810406416655, 0.0066966526210308075, -0.012249664403498173, -0.017078369855880737, 0.0185651034116745, -0.01738334260880947, 0.017459584400057793, -0.014638603664934635, -0.011112377047538757, -0.03883296251296997, -0.0162269938737154, 0.025541312992572784, -0.010222879238426685, 0.010553264059126377, 0.013787226751446724, -0.005784916691482067, 0.023635245859622955, 0.04546608030796051, -0.02249160408973694, 0.0119002191349864, -0.007325655315071344, 0.028895992785692215, 0.010604092851281166, -0.0374860055744648, 0.0031386588234454393, 0.012014582753181458, 0.0014764086809009314, -0.014841917902231216, 0.00441572442650795, 0.034563370048999786, -0.050930142402648926, -0.025681091472506523, 0.0064393337815999985, 0.01958167366683483, -0.017840798944234848, 0.026913681998848915, 0.014956281520426273, -0.018870074301958084, -0.004174289293587208, 0.0169513002038002, 0.0038343737833201885, 0.010680335573852062, 0.03634236752986908, 0.002149091800674796, 0.014613189734518528, 0.03169155865907669, -0.01770102046430111, 0.02909930795431137, 0.021868955343961716, -0.0062677874229848385, -0.03685064986348152, 0.014066782779991627, -0.012586403638124466, 0.007706868927925825, 0.0006575935403816402, -0.03530038148164749, 0.0533699095249176, 0.002360347658395767, 0.035783253610134125, -0.0196452084928751, 7.534925680374727e-05, 0.04272134229540825, 0.01537561696022749, -0.012624524533748627, -0.0006552109261974692, -0.010432546027004719, 0.0019981947261840105, 0.015070646069943905, 0.02696451172232628, 0.003386447671800852, -0.01143005583435297, 0.02592252753674984, 0.00747178727760911, -0.0025541314389556646, -0.015909316018223763, 0.014168440364301205, -0.022199340164661407, -0.00881238840520382, 0.014664017595350742, 0.008253275416791439, -0.024168943986296654, 0.003592938417568803, 0.01404136884957552, -0.007166816387325525, 0.02627832628786564, -0.04467823728919029, 0.021144649013876915, 0.03547828271985054, 0.010152989998459816, 0.00369141879491508, 0.007744990289211273, 0.04160311445593834, -0.015159595757722855, 0.007713222410529852, -0.005181328859180212, -0.04978650063276291, -0.015273959375917912, -0.028895992785692215, -0.018438031896948814, 0.014231975190341473, 0.02826063707470894, -0.005664199125021696, 0.017573948949575424, 0.017891626805067062, -0.0090157026425004, 0.01451153215020895, -0.006957148667424917, -0.005549835041165352, -0.00048207640065811574, 0.022224754095077515, -0.012973970733582973, -0.0033959781285375357, 0.0035961151588708162, -0.01881924644112587, -0.019403774291276932, -0.003173603443428874, -0.002452474320307374, 0.012777009978890419, -0.026939095929265022, 0.021170062944293022, -0.03591032326221466, 0.004206057172268629, 0.04157770052552223, -0.02026785910129547, 0.023876680061221123, -0.01252922136336565]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" legal. The depths to which we follow these
terminal sequences in the prefix-tree is determined by the
so-called lookahead parameter k.
We showcase this in Fig. 3 (e), where so far we have read the
input(12. The parser thus knows that it has seen the partial
rule(E), in which recusively Ewas initialized with the int
terminal. The scanner Shas been advanced similarly and
has a single active state sthat corresponds to that for an int
terminal , as shown in Fig. 3 (d). In the corresponding
prefix tree Tswe can now check each outbound edge with
the parser and find that the EOS and(can not produce
legal (sub)terminal sequences, but all other tokens do. After
traversing one level of this tree ( k= 0) this includes all
number terminals, +and). By increasing kand checking
further paths in the tree we can also include the tokens +1
and1(atk= 1andk= 2respectively.
3.5. D OMINO
Based on Algorithm 1, DOMINO implements constraining
that leverages subterminal trees to efficiently check for legal
continuations in V, that, by construction, line up with the
current state, just like the pieces in a game of domino.
For this, we compute the character scanner Sand corre-
sponding prefix trees Tqfor all q∈Sbefore inference starts
(offline). When update is called in Algorithm 1, we can
then advance the scanner and parser state. When mask is
invoked , we traverse the corresponding Tqto the desired
depth, and take the union over the associated tokens to com-
pute the current mask. Here, k= 0 is already sufficient
to ensure that the generated output is in LG. If we always
traverse the full prefix-trees ( k=∞or sufficently large),
this approach is minimally invasive, as all valid tokens will
eventually be reached and included in the mask.
Overall, this enables us to handle expressive constraining
with far less overhead than fully online approaches, as the
size of subterminal trees is much smaller than the size of
the model vocabulary, which we would need to traverse
otherwise. Similarly DOMINO can also be extended to other
forms of constraining, e.g. to execute GUIDANCE programs.
Further Optimizations On top of this, DOMINO also
supports an optimization already present in LLAMA .CPP
(Gerganov & et. al.)’s fully online approach, which we term
opportunistic masking : Rather than computing the mask for
the full logit vectors as in Algorithm 1, we can first run the
decode step of the LLM and then use the parser to check the
model-proposed token first. Only if incorrect, we need to
compute the rest of the mask, and thus let the LLM guide
decoding.
To realize this in DOMINO , rather than traversing the trees
Tqfrom the root, we first determine the nodes linked tothe proposed token, and only then check if there exists a
parser-allowed path from the root to this node. This is can be
very effective when an LLM already naturally adheres to a
grammar, and parser transitions are expensive. In DOMINO ,
oppurtunistic masking is enabled using a runtime flag.
We finally want to note, that token healing can be impl-
mented in a similar way to GUIDANCE (Lundberg et al.),
i.e., by stripping the input back to the last token boundary
and changing the beginning of the grammar to force a prefix.
However, this means that the grammar needs to be recom-
piled for the current problem and can not neccesarily be
shared between multiple instance. Note however, that this is
of lesser concern in DOMINO , as it is only relevent for the
first boundary with the prompt, where all other boundaries
are embedded seamlessly into the grammar.
3.6. Speculative Decoding
Speculative Sampling (Chen et al., 2023) is a technique to
speed up the LLM sampling process, by using a smaller
LLM to propose multiple tokens and then only evaluate
the full large LLM to confirm this token choice. This is
efficient, as the parallel nature of Transformer-based models
Vaswani et al. (2017), allows to validate multiple tokens
with a single forward pass, where rejected tokens can simply
be discarded without the need to backtrack. In DOMINO ,
we adopt a similar approach to further speed up inference,
based on parser and scanner state. At any time, the active
scanner state is (largely) given by the most recently read
subterminal α","[0.013268635608255863, 0.052903611212968826, 0.043673254549503326, 0.022990422323346138, 0.024713991209864616, 0.02562563121318817, 0.007335853297263384, 0.03914354369044304, -0.025198299437761307, 0.06501132994890213, 0.030710874125361443, 0.000699309806805104, -0.011829953640699387, -0.003981302957981825, 0.006160692311823368, -0.05136521905660629, 0.042106375098228455, -0.003096371190622449, 0.0074569303542375565, 0.04652212932705879, 0.03996971622109413, -0.005751166492700577, 0.0014903177507221699, 0.02734920009970665, -0.012948136776685715, -0.038830168545246124, 0.006630756892263889, 0.03766212984919548, 0.04555351287126541, -0.05333094298839569, 0.029599811881780624, -0.03922900930047035, -0.033958591520786285, 7.428219396388158e-05, 0.025924762710928917, 0.03666502237319946, 0.023004665970802307, 0.014493651688098907, -0.03877319023013115, -0.011196078732609749, -0.016580453142523766, -0.06689158827066422, -0.05202046036720276, -0.009130644612014294, 0.01117471233010292, 0.05116579681634903, 0.01325439102947712, -0.010085017420351505, -0.019614504650235176, 0.01799064688384533, -0.027748042717576027, 0.0022844416089355946, -0.03891563415527344, 0.02830357477068901, -0.04797505587339401, -0.05435653775930405, -0.053530361503362656, 0.027990197762846947, 0.04763318970799446, -0.009109278209507465, 0.02283373288810253, -0.013731577433645725, 0.0035308245569467545, 0.01894501969218254, -0.014379696920514107, 0.041878461837768555, -0.0531884990632534, 0.010127751156687737, -0.02928643487393856, 0.01618161052465439, -0.0020084569696336985, 0.020497655496001244, 0.010647670365869999, -0.051849525421857834, -0.011388378217816353, 0.02249186858534813, 0.044670362025499344, 0.05398618429899216, -0.0010612059850245714, -0.003025149228051305, 0.033217884600162506, 0.00880302395671606, 0.06455551087856293, -0.05241930112242699, 0.014379696920514107, -0.009223232977092266, -0.015298458747565746, 0.010925435461103916, -0.06472644209861755, -0.026822159066796303, -0.0016185170970857143, 0.002159803407266736, -0.03424347937107086, -0.0006521253380924463, 0.05116579681634903, 0.007613618858158588, -0.02999865449965, -0.04216334968805313, 0.04145113378763199, 0.020625855773687363, 0.034813255071640015, -0.05994033068418503, 0.03133762627840042, -0.05261872336268425, 0.05068148672580719, 0.01762029156088829, -0.0019318934064358473, 0.021081674844026566, -0.027619844302535057, -0.02626662887632847, -0.0650683045387268, -0.02710704691708088, -0.029229458421468735, -0.024158461019396782, 0.025226788595318794, -0.03999820724129677, -0.04632270708680153, 0.007620740681886673, -0.014009343460202217, -0.02710704691708088, -0.02817537449300289, 0.0019425767241045833, -0.021708428859710693, -0.0023431996814906597, -0.0172499381005764, -0.00471488805487752, 0.028616949915885925, -0.05521119758486748, 0.023289553821086884, -0.017962157726287842, -0.012727349065244198, 0.01252792775630951, 0.024614280089735985, -0.022876467555761337, -0.03962785378098488, 0.016580453142523766, -0.020355211570858955, 0.005701311398297548, -0.012264407239854336, 0.0286739282310009, -0.014144664630293846, -0.05090939626097679, 0.013596256263554096, 0.011566433124244213, -0.06842997670173645, -0.0005969283520244062, -0.03575338050723076, 0.026779426261782646, -0.05355885252356529, 0.035041164606809616, 0.007136431988328695, -0.03851678967475891, -0.028759393841028214, 0.006808811333030462, -0.010163362137973309, -0.06387177854776382, -0.030084120109677315, 0.002537279389798641, 0.014500774443149567, 0.0072610704228281975, -0.045752935111522675, 0.04438547417521477, 0.03586733713746071, 0.0011911859037354589, -0.0032423760276287794, 0.036009781062603, 0.0012348092859610915, 0.039798785001039505, -0.05521119758486748, -0.01762029156088829, 0.02039794623851776, -0.05629377067089081, -0.010726015083491802, -0.0364656001329422, -0.04019762575626373, -0.017663026228547096, -0.03586733713746071, 0.007578007876873016, 0.004134430084377527, -0.0459238663315773, 0.01955752819776535, 0.04341685771942139, 0.011388378217816353, 0.01227865181863308, -0.01847495511174202, -0.0386592335999012, -0.048801228404045105, 0.009807252325117588, -0.0023360776249319315, 0.04518315941095352, 0.007300242315977812, 0.06751833856105804, 0.08028130233287811, 0.010790114291012287, 0.03224926441907883, -0.037633638828992844, 0.07481145858764648, 0.04643666371703148, 0.026337850838899612, -0.021779650822281837, 0.019999103620648384, 0.027149779722094536, 0.017962157726287842, -0.016722897067666054, 0.017079006880521774, 0.03877319023013115, 0.016195854172110558, 0.01809035614132881, 0.013183169066905975, -0.024742480367422104, 0.00814066082239151, 0.0018962824251502752, 0.014479408040642738, -0.0009632759029045701, -0.03814643621444702, 0.013183169066905975, -0.020611610263586044, -0.006552412640303373, 0.02894457057118416, 0.03751968592405319, 0.035667914897203445, 0.026708204299211502, 0.04293254762887955, 0.015127526596188545, -0.02150900661945343, 0.05578097328543663, 0.016366787254810333, -0.00561940623447299, -0.0035521911922842264, -0.014173153787851334, 0.04472734034061432, -0.007289559114724398, -0.002450032625347376, -0.025326499715447426, 0.01958601549267769, -0.04142264276742935, -0.025739585980772972, -0.06016824021935463, 0.00625684205442667, -0.02660849317908287, -0.008532380685210228, 0.0204264335334301, 0.045638978481292725, -0.03301846235990524, -0.01568305678665638, 0.011146224103868008, -0.03538302704691887, -0.03401556983590126, -0.011359889060258865, 0.05392920598387718, 0.01605341024696827, -0.03333183750510216, -0.02112440951168537, -0.0295428354293108, -0.06444155424833298, 0.02722100168466568, -0.04848785325884819, 0.03122367151081562, -0.00814066082239151, 0.06051010638475418, -0.002416202099993825, 0.02383084036409855, -0.013653233647346497, -0.0065987068228423595, 0.0032690842635929585, -0.04800354689359665, 0.0002345870598219335, 0.034699298441410065, 0.017321160063147545, -0.04971287027001381, -0.024229682981967926, -0.0297707449644804, -0.00689427787438035, 0.014166031032800674, -0.050368111580610275, -0.055097244679927826, 0.03780457377433777, 0.04646515101194382, -0.03999820724129677, 0.025611387565732002, -0.009287333115935326, -0.018560420721769333, 0.07817313075065613, -0.011324278078973293, 0.004960603546351194, 0.018759842962026596, 0.003092810045927763, -0.011367011815309525, -0.012784326449036598, -0.025255277752876282, -0.0013834849232807755, 0.009999551810324192, 0.029087014496326447, -0.044300008565187454, -0.0025942567735910416, -0.014016465283930302, -0.008653458207845688, -0.013874021358788013, -0.0026405511889606714, -0.011445355601608753, 0.040169138461351395, 0.01324014738202095, -0.003121298737823963, -0.02078254334628582, -0.011466722004115582, 0.010946802794933319, 0.013482301495969296, -0.001568661886267364, -0.0022791000083088875, -0.006808811333030462, 0.00888136774301529, -0.046379685401916504, -0.025825053453445435, 0.02283373288810253, 0.014956594444811344, -0.06449852883815765, 0.05116579681634903, -0.029087014496326447, 0.011630532331764698, -0.0017743150237947702, -0.024386370554566383, -0.04008367285132408, 0.002526596188545227, -0.011580676771700382, 0.004212773870676756, 0.016195854172110558, -0.03424347937107086, 0.007399952970445156, -0.001697751460596919, -0.07389982044696808, -0.005170708056539297, 0.01197951938956976, 0.036864444613456726, 0.03789003938436508, -0.04931402578949928, -0.0297707449644804, -0.021067431196570396, 0.01196527574211359, 0.028745150193572044, 0.04825994372367859, -0.06626483798027039, 0.011203201487660408, 0.0148853724822402, -3.786444358411245e-05, -0.06016824021935463, -0.004533272236585617, -0.0057476055808365345, 0.0004291117948014289, 0.051108818501234055, 0.014080565422773361, -0.02088225446641445, -0.03170797973871231, 0.036636535078287125, -0.03418650105595589, 0.031394604593515396, 0.05697750300168991, 0.004643666557967663, -0.027619844302535057, -0.014401063323020935, -0.01531270332634449, -0.026337850838899612, 0.028047174215316772, -0.003689293283969164, 0.05526817589998245, -0.02270553447306156, -0.010298683308064938, -0.04751923680305481, 0.005523256491869688, 0.026950357481837273, 0.0019016241421923041, 0.03800399228930473, 0.04207788407802582, -0.011894053779542446, 0.01270598266273737, -0.030340518802404404, 0.003626974066719413, -0.041736021637916565, 0.024372126907110214, 0.020868010818958282, 0.04145113378763199, 0.012435339391231537, -0.010847091674804688, -0.013695967383682728, 0.024884924292564392, 0.0008511014166288078, 0.02613842859864235, -0.0009730688761919737, -0.01458624005317688, -0.038830168545246124, -0.0034809692297130823, -0.010918313637375832, -0.010790114291012287, 0.01566881313920021, 0.04421454295516014, -0.016081899404525757, 0.013966609723865986, -0.019529039040207863, 0.04885820671916008, 0.027050068601965904, 0.0432744137942791, 0.04099531099200249, 0.00911640003323555, -0.026537271216511726, -0.01676562987267971, -0.010861336253583431, 0.004483417142182589, 0.03014109842479229, 0.009451143443584442, 0.03170797973871231, 0.004262629430741072, 0.05452746897935867, -0.025967495515942574, 0.04726283624768257, -0.034670811146497726, 0.009066544473171234, -0.004454928450286388, -0.0038281758315861225, -0.025013122707605362, 0.027164023369550705, 0.036408621817827225, -0.027918975800275803, -0.006324502639472485, -0.011018024757504463, -0.06586599349975586, -0.015455147251486778, 0.03484174236655235, 0.011381256394088268, -0.01568305678665638, 0.02928643487393856, -0.042220328003168106, -0.012435339391231537, -0.008503892458975315, 0.03441441059112549, 0.011879809200763702, -0.0020725566428154707, -0.04694946110248566, 0.005263296887278557, 0.038716211915016174, -0.023973284289240837, -0.06016824021935463, 0.017919424921274185, -0.03803248330950737, 0.018403733149170876, 0.00016247491294052452, -0.03244868665933609, 0.0014742928324267268, -0.06512528657913208, -0.020383700728416443, -0.002749164355918765, -0.010441127233207226, 0.008297348394989967, -0.024286659434437752, 0.036009781062603, 0.05495480075478554, 0.0038352981209754944, -0.0731591135263443, 0.08877094835042953, -0.019543282687664032, 0.03014109842479229, 0.01968572661280632, -0.0008056974620558321, -0.021081674844026566, -0.05153615027666092, -0.0022203419357538223, -0.0006734918570145965, 0.025226788595318794, 0.00819763820618391, 0.018289778381586075, 0.045382581651210785, 0.05392920598387718, -0.02541196532547474, -0.04122322052717209, 0.010220339521765709, 0.002731358865275979, -0.025739585980772972, 0.026708204299211502, 0.04994077980518341, -0.06620785593986511, 0.01542665809392929, -0.007535274606198072, -0.03270508721470833, -0.0138455331325531, 0.038830168545246124, -0.005120852962136269, 0.029257947579026222, 0.11292941123247147, 0.00888136774301529, 0.030312031507492065, -0.014928105287253857, -0.016836851835250854, -0.014322719536721706, -0.03167949244379997, 0.04042553901672363, -0.01773424819111824, 0.014052076265215874, -0.0023948356974869967, 0.030710874125361443, -0.048573318868875504, -0.024372126907110214, -0.023631418123841286, 0.03999820724129677, -0.005416423548012972, -0.04595235362648964, 0.014757173135876656, -0.010469615459442139, -0.01981392689049244, 0.024215437471866608, 0.028645439073443413, -0.006577340420335531, 0.017278427258133888, -0.02420119382441044, -0.025483187288045883, -0.013945243321359158, -0.014059198088943958, -0.02444334886968136, -0.0010273755760863423, -0.03489872068166733, -0.002795458771288395, -0.024742480367422104, 0.026095695793628693, 0.021779650822281837, 0.0049962145276367664, -0.013411079533398151, 0.001416425104252994, 0.01871711015701294, -0.019899392500519753, -0.03210682049393654, -0.11988066136837006, -0.029457367956638336, 0.01233562920242548, 0.02078254334628582, -0.021238364279270172, 0.010982413776218891, 0.03039749711751938, -0.04729132726788521, 0.002184731187298894, -0.012684616260230541, 0.00814066082239151, -0.016737140715122223, -0.035553961992263794, 0.0171359833329916, -0.0022897834423929453, -0.008860001340508461, -0.010049406439065933, 0.00183040217962116, -0.01021321676671505, 0.023617174476385117, -0.004885820671916008, -0.02370264008641243, 0.037263285368680954, -0.01452926266938448, -0.015540613792836666, 0.006399285513907671, -0.029713766649365425, -0.014728683978319168, 0.009322944097220898, 0.016950806602835655, 0.0172499381005764, -0.04156508669257164, -0.01907321810722351, -0.025696853175759315, 0.013738700188696384, -0.02589627355337143, -0.007211214862763882, 0.0007269082707352936, 0.012364117428660393, -0.0004584908310789615, 0.00677320035174489, 0.011302911676466465, 0.037263285368680954, -0.02760559879243374, -0.002396616153419018, 0.04071042314171791, 0.007592251989990473, 0.013631867244839668, -0.02784775383770466, 0.01885955221951008, -0.032876018434762955, 0.004764743614941835, 0.00014923208800610155, -0.015583346597850323, -0.045040715485811234, 0.015099038369953632, -0.011687509715557098, -0.012243040837347507, 0.03751968592405319, 0.001418205676600337, 0.07122188061475754, -0.04301801323890686, 0.006887155584990978, 0.029571322724223137, -0.005291785579174757, -0.0025800124276429415, 0.012478073127567768, -0.06364387273788452, -0.005192074924707413, 0.021053187549114227, -0.021053187549114227, -0.03583884984254837, -0.01270598266273737, -0.0011181834852322936, -0.012862671166658401, 0.0051101697608828545, 0.011680387891829014, 0.016195854172110558, 0.016338298097252846, -0.012969504110515118, -0.011374133639037609, 0.03800399228930473, 0.0107046477496624, -0.022819489240646362, 0.007919873110949993, 0.013482301495969296, -0.020440679043531418, -0.03509813919663429, 0.016081899404525757, -0.03697839751839638, 0.008475403301417828, 0.04740528017282486, -0.011395500041544437, 0.009258843958377838, 0.00480391550809145, -0.011594921350479126, -0.02091074362397194, -0.0004291117948014289, 0.015383925288915634, -0.015212993137538433, -0.01019897311925888, -0.03270508721470833, -0.035810358822345734, -0.028360551223158836, -0.029485857114195824, 0.010412638075649738, 0.02344624139368534, -0.0006663696840405464, -0.004807476885616779, 0.0022666361182928085, 0.006719783879816532, 0.03720630705356598, -0.00544135132804513, -0.0017111055785790086, 0.01100378017872572, 0.00503894779831171, -0.0432744137942791, 0.0194435715675354, 0.014500774443149567, -0.0014573776861652732, 0.024813702329993248, 0.0036002658307552338, -0.027548622339963913, -0.03515511751174927, -0.024030260741710663, 0.023517463356256485, 0.01525572594255209, 0.0074711749330163, -0.027990197762846947, 0.011367011815309525, -0.005060314200818539, 0.015754278749227524, 0.02672244794666767, -0.018631642684340477, -0.013069214299321175, -0.03826039284467697, -0.007513908203691244, -0.011452477425336838, 0.03569640591740608, 0.023902062326669693, 0.02526952140033245, 0.011039391160011292, -0.007884262129664421, -0.004006230738013983, 0.02284797839820385, 0.025568652898073196, -0.011993763968348503, 0.013104825280606747, -0.0025942567735910416, -0.03444289788603783, -0.03974180668592453, 0.006267525255680084, 0.017905179411172867, -0.04338836669921875, 0.004437122959643602, -0.0566641241312027, -0.004768304526805878, -0.01294101495295763, -0.008525258861482143, 0.02394479513168335, 0.001258846721611917, -0.00942977610975504, 0.0004502558149397373, -0.004725571721792221, -0.016381030902266502, 0.02991318888962269, -0.041622065007686615, 0.006324502639472485, 0.0017849983414635062, -0.00857511442154646, 0.03418650105595589, -0.023303797468543053, -0.061079882085323334, -0.009857107885181904, -0.00434453459456563, -0.02710704691708088, -0.008226126432418823, -0.0044478061608970165, -0.03703537583351135, 0.021608717739582062, 0.02796170860528946, 0.03316090628504753, -0.02283373288810253, 0.02125260792672634, 0.015227237716317177, -0.029799234122037888, 0.008432670496404171, -0.0323062427341938, 0.006409968715161085, 0.01245670672506094, -0.03880167752504349, -0.010989535599946976, -0.05444200336933136, -0.023289553821086884, 0.012178940698504448, -0.020725566893815994, -0.00559091754257679, 0.01410193182528019, 0.008617847226560116, -0.017933668568730354, 0.010106384754180908, -0.002464276971295476, 0.03293299674987793, -0.014009343460202217, 0.019543282687664032, -0.005338079761713743, -0.03977029770612717, -0.023659907281398773, 0.019486306235194206, -0.018261289224028587, 0.012093475088477135, -0.02126685157418251, -0.006741150747984648, 0.02381659485399723, -0.015711545944213867, -0.041251711547374725, -0.014030709862709045, -0.0086819464340806, 0.013859777711331844, -0.023731129243969917, 0.028631195425987244, -0.005395057145506144, 0.022164247930049896, -0.01712173968553543, 0.014023587107658386, -0.019728459417819977, 0.004967725835740566, 0.010127751156687737, -0.010369905270636082, 0.003406186355277896, 0.03196437656879425, -0.019970614463090897, -0.0016247490420937538, 0.02068283222615719, -0.002124192425981164, -0.02999865449965, -0.0018820380792021751, 0.006192742381244898, 0.04632270708680153, -0.045154668390750885, -0.005174269434064627, 0.040539491921663284, 0.058629848062992096, 0.029485857114195824, -0.009073667228221893, 0.011794342659413815, 0.009693297557532787, 0.03655106574296951, -0.0010184728307649493, -0.009372798725962639, -0.007079454604536295, -0.019771192222833633, 0.005804582964628935, -0.011039391160011292, 0.008126416243612766, 0.0011680388124659657, -0.0172499381005764, -0.007948361337184906, -0.022392157465219498, -0.013745822012424469, 0.027420422062277794, 0.00619630329310894, -0.016922317445278168, -0.019372349604964256, -0.007221898529678583, -0.03327485918998718, 0.01566881313920021, 0.016338298097252846, 0.014515018090605736, -0.00183040217962116, -0.14757172763347626, -0.021722672507166862, 0.0005386154516600072, 0.043559301644563675, -0.006424213293939829, -0.0014333402505144477, 0.03261961787939072, 0.011082123965024948, -0.0051635862328112125, -0.017663026228547096, -0.04335987940430641, -0.017221448943018913, -0.0077489400282502174, -0.027249490842223167, 0.012677494436502457, -0.04808901250362396, -0.0173638928681612, -0.02273402363061905, 0.022776756435632706, -0.008432670496404171, -0.02732071280479431, -0.0147714177146554, -0.03279055282473564, 0.03196437656879425, -0.013282880187034607, -0.040169138461351395, -0.005391496233642101, 0.011103490367531776, -0.017805470153689384, 0.042961034923791885, 0.018788330256938934, -0.027363445609807968, -0.009365676902234554, 0.019229907542467117, -0.0031658124644309282, -0.015967944636940956, 0.0016559086507186294, -0.01409480907022953, -0.001552636967971921, -0.019101707264780998, 0.016081899404525757, -0.032391708344221115, 0.02249186858534813, -0.013425324112176895, 0.005918538197875023, -0.0023200525902211666, -0.013930998742580414, 0.007399952970445156, -0.00616425322368741, -0.005833071656525135, -0.022292448207736015, 0.0006472287932410836, 0.02505585551261902, 0.0015891381772235036, -0.00045359431533142924, -0.003404405666515231, 0.024343637749552727, -0.0003503226034808904, -0.008653458207845688, 0.0015339411329478025, 0.00601824838668108, 0.017563315108418465, 0.0022452697157859802, 0.01117471233010292, 0.00011729352991096675, -0.03036900795996189, 0.0077489400282502174, 0.020098812878131866, 0.001258846721611917, -0.03247717767953873, -0.004939237143844366, -0.003377697430551052, 0.0008867123397067189, 0.023602930828928947, -0.0009178719483315945, 0.017520582303404808, -0.005149341654032469, 0.011602044105529785, -0.03125216066837311, -0.013104825280606747, 0.038345858454704285, -0.036892931908369064, 0.0031444458290934563, -0.012720227241516113, 0.02599598467350006, -0.006652123294770718, 0.011053635738790035, 0.004850209690630436, -0.03110971674323082, 0.00863209180533886, 0.038089461624622345, -0.005697750020772219, -0.010434005409479141, -0.018660131841897964, -0.026779426261782646, -0.05216290429234505, -0.022819489240646362, 0.012741593644022942, 0.03270508721470833, -0.00917337741702795, 0.03754817321896553, 0.010975291021168232, -0.03401556983590126, -0.06358689069747925, -0.0050496309995651245, 0.01920141838490963, -0.002095703734084964, -0.01689382828772068, 0.02344624139368534, -0.010925435461103916, 0.02223546989262104, 0.004896503873169422, -0.0006721564568579197, 0.007983972318470478, -0.031024249270558357, 0.038716211915016174, 0.043331388384103775, -0.00918050017207861, 0.040539491921663284, 0.011886931024491787, 0.007022477220743895, 0.014671706594526768, -0.04427151754498482, -0.0025853540282696486, -0.04036856070160866, -0.01739238202571869, 0.011274423450231552, 0.009622075594961643, -0.00929445493966341, -0.059256602078676224, 0.0008978407713584602, 0.014365452341735363, -0.008290226571261883, 0.0048715765587985516, 0.02078254334628582, 0.0060218097642064095, 0.006132203619927168, 0.045382581651210785, -0.00616425322368741, 0.019258394837379456, -0.005986198782920837, 0.001694190432317555, 0.013140436261892319, 0.0056870668195188046, -0.010092140175402164, -0.015013571828603745, -0.01809035614132881, -0.022990422323346138, -0.034813255071640015, 0.015113282017409801, 0.010953924618661404, 0.014358330518007278, 0.005929221399128437, -0.013532157056033611, 0.011829953640699387, 0.0037854427937418222, 0.00203872611746192, -0.047433771193027496, -0.009743153117597103, 0.01848919875919819, 0.040026694536209106, 0.011530822142958641, -0.037605151534080505, -0.04073891416192055, 0.026067206636071205, 0.007214776240289211, 0.00689427787438035, 0.005804582964628935, -0.02504161186516285, 0.004565322306007147, -0.005847316235303879, -0.032021354883909225, 0.03393010050058365, 0.02477096952497959, 0.03199286758899689, 0.011822831816971302, 0.03452836722135544, 0.0032708647195249796, 0.01703627221286297, 0.02759135514497757, -0.00935143232345581, 0.01895926333963871, -0.021067431196570396, 0.01579701155424118, 0.03655106574296951, -0.047576215118169785, 0.03281904011964798, 0.034670811146497726, -0.0077845510095357895, 0.030824828892946243, 0.03489872068166733, 0.01593945547938347, 0.0013336295960471034, 0.008354325778782368, -0.009194744750857353, -0.00019908740068785846, 0.023659907281398773, 0.03039749711751938, 0.03338881582021713, -0.009365676902234554, -0.04264765977859497, 0.05771820992231369, -0.02516981214284897, 0.016566209495067596, -0.02323257550597191, 0.010234584100544453, 0.01039127167314291, -0.002398396609351039, -0.020853765308856964, 0.03891563415527344, -0.008496769703924656, 0.005630089435726404, -0.04900065064430237, 0.011096368543803692, 0.007399952970445156, -0.027263734489679337, 0.010768747888505459, 0.0075281523168087006, -0.044527918100357056, -0.0074141975492239, -0.011445355601608753, -0.015326947905123234, 0.0023271748796105385, 0.0041201855055987835, -0.013368346728384495, 0.004305362235754728, 0.03734875097870827, 0.02320408821105957, -0.02247762493789196, -0.0068551055155694485, -0.012364117428660393, -0.017805470153689384, 0.011694632470607758, 0.007585129700601101, -0.009379921481013298, -0.010384149849414825, 0.01967148296535015, 0.032762061804533005, 0.013930998742580414, 0.026580004021525383, 0.0298846997320652, -0.006901399698108435, -0.02431514859199524, -0.005612283945083618, 0.007435563951730728, -0.013468056917190552, 0.018987752497196198, 0.04267614707350731, -0.03589582443237305, 0.008475403301417828, -0.015868233516812325, 0.02138080820441246, 0.057176921516656876, 0.016722897067666054, 0.016865340992808342, 0.0183467548340559, 0.03657955676317215, 0.05823100730776787, 0.01415890920907259, 0.04031158238649368, 0.012463828548789024, -0.005936343222856522, 0.009458265267312527, -0.006712662056088448, -0.026394827291369438, -0.01703627221286297, -0.003350989194586873, 0.008560869842767715, 0.004971287213265896, 0.03062540665268898, -0.015497880056500435, 0.03974180668592453, -0.01093968003988266, 0.040881358087062836, -0.014073442667722702, -0.03219228982925415, 0.005448473617434502, -0.024827945977449417, 0.0009267746936529875, -0.01579701155424118, -0.015156015753746033, -0.019486306235194206, -0.017705759033560753, -0.0011885151034221053, -0.0039421310648322105, -0.03771910443902016, -0.009515242651104927, -0.004113063216209412, -0.003133762627840042, 0.0009784104768186808, 0.04828843101859093, 0.010640548542141914, 0.006445579696446657, -0.007599374279379845, 0.00546984001994133, -0.003685732139274478, 0.007068771403282881, 0.00305541860871017, 0.013574889861047268, -0.009679052978754044, -0.0026387705001980066, 0.039456918835639954, 0.0025960374623537064, -0.0325341522693634, 0.029941676184535027, -0.012356995604932308, 0.023788107559084892, -0.0428185909986496, -0.02602447383105755, -0.017805470153689384, 0.020754054188728333, 0.03484174236655235, 0.00680525042116642, 0.01135276723653078, 0.010320049710571766, 0.017321160063147545, -0.03441441059112549, -0.012520805932581425, -0.0028951691929250956, -0.028517238795757294, -0.00212775357067585, 0.014458040706813335, 0.0054555959068238735, 0.017164472490549088, -0.019258394837379456, 0.005608723033219576, 0.0004395725263748318, -0.00047718657879158854, -0.0014039612142369151, 0.03196437656879425, 0.02076829969882965, -0.014500774443149567, 0.0057298000901937485, -0.009365676902234554, -0.027805021032691002, -0.009543731808662415, 0.0026191845536231995, -0.00331359775736928, -0.013688844628632069, -0.029257947579026222, 0.00978588592261076, 0.02541196532547474, 0.00677320035174489, 0.006652123294770718, -0.00044246591278351843, 0.040539491921663284, -0.00012719782534986734, -0.008311592973768711, 0.014742928557097912, -0.028104152530431747, 0.0630171149969101, -0.03219228982925415, -0.015141771174967289, 0.00555886747315526, 0.0037462706677615643, 0.021964827552437782, 0.012235918082296848, -0.033987078815698624, -0.02492765709757805, 0.014493651688098907, -0.002758067101240158, -0.008767412975430489, -0.0007914531161077321, -0.010726015083491802, 0.0021081676241010427, -0.006174936890602112, -0.03242019936442375, 0.028830615803599358, 0.003308256156742573, 0.023175599053502083, 0.036038268357515335, 0.028659682720899582, -0.0063743581995368, 0.0007126639247871935, -0.016708651557564735, 0.004640105180442333, -0.025326499715447426, 0.0159252118319273, 0.029742255806922913, 0.04863029718399048, 0.005249052308499813, -0.017463603988289833, -0.05942753329873085, 0.0019888710230588913, -0.025597142055630684, 0.0018909408245235682, 0.01062630396336317, 0.042362771928310394, -0.013902510516345501, -0.010676159523427486, -0.005886488128453493, 0.02771955542266369, 0.01178722083568573, 0.0011261958861723542, 0.012962381355464458, 0.012933893129229546, 0.000918762234505266, 0.006370796822011471, -0.010782992467284203, 0.010298683308064938, 0.030283542349934578, -0.020697077736258507, 0.04290406033396721, 0.0013505448587238789, 0.014415307901799679, -0.0289018377661705, 0.003361672628670931, 0.04105228930711746, -0.0043409732170403, -0.024016017094254494, -0.05603737384080887, -0.01591096818447113, -0.012891159392893314, -0.01531270332634449, 0.009016689844429493, -0.0323062427341938, -0.010782992467284203, 0.014458040706813335, -0.012235918082296848, 0.05751878768205643, -0.002850655699148774, -0.016950806602835655, -0.0193296167999506, -0.010839969851076603, 0.003071443410590291, 0.009087911807000637, 0.008653458207845688, 0.014871127903461456, 0.010063651017844677, 0.047319814562797546, 0.003717781975865364, -0.007399952970445156, -0.017549069598317146, 0.012164696119725704, 0.015326947905123234, 0.009372798725962639, 0.026337850838899612, 0.0035201413556933403, -0.0035361661575734615, 0.021295340731739998, 0.014429552480578423, 0.01257066149264574, 0.02150900661945343, 0.005555306561291218, -0.002455374225974083, -0.009251722134649754, -0.0015357217052951455, -0.029115503653883934, -0.015497880056500435, -0.0018206092063337564, -0.012463828548789024, -0.0074141975492239, -0.028018686920404434, -0.012969504110515118, -0.03464232012629509, 0.00923747755587101, -0.05763274431228638, 0.000683284888509661, 0.005160024855285883, 0.024813702329993248, -0.00808368343859911, -0.011958152987062931, 0.010526593774557114, 0.025070101022720337, -0.011139101348817348, 0.01519874855875969, -0.011659021489322186, 0.027178268879652023, 0.0037925648503005505, -0.013168925419449806, 0.013831288553774357, 0.0017378138145431876, 0.030112609267234802, 0.008040949702262878, -0.005142219364643097, -0.004469172563403845, -0.022263959050178528, -0.012193185277283192, 0.017819713801145554, -0.03657955676317215, -0.014500774443149567, 0.007862894795835018, -0.025084344670176506, 0.010412638075649738, -0.0003236143966205418, 0.020098812878131866, -0.00286846118979156, -0.004298240412026644, -0.004269751720130444, -7.316935079870746e-05, 0.04190695285797119, 0.023503219708800316, -0.01628132164478302, 0.009144889190793037, 0.0023521024268120527, 0.005003336817026138, 0.008646335452795029, 0.004999775905162096, 0.04518315941095352, 0.029115503653883934, -0.01331136841326952, 0.0023538831155747175, 0.0025889151729643345, -0.013304246589541435, -0.03789003938436508, -0.02612418495118618, 0.006897838786244392, 0.019372349604964256, 0.009159133769571781, 0.011445355601608753, 0.010918313637375832, -0.008062316104769707, -0.014685951173305511, 0.031793445348739624, 0.03900109976530075, 0.005847316235303879, -0.028232352808117867, 0.03233473375439644, 0.0005608722567558289, -0.006915644276887178, 0.004056085832417011, 0.01045537181198597, 0.0019123073434457183, -0.008603602647781372, -0.014628973789513111, -0.011744487099349499, -0.019130196422338486, 0.018318267539143562, -0.0035753382835537195, 0.009308699518442154, -0.02455730363726616, -0.005754727870225906, 0.04908611625432968, 0.0035361661575734615, -0.019158685579895973, 0.012342751026153564, 0.009244599379599094, 0.0065630958415567875, -0.0027188952080905437, 0.04506920278072357, -0.0032530592288821936, -0.0349556989967823, -0.003938569687306881, -0.009999551810324192, 0.011267300695180893, -0.022406402975320816, -0.017591804265975952, 0.025468943640589714, 0.037006888538599014, 0.008518136106431484, 0.0035290441010147333, -0.0014315596781671047, 0.014728683978319168, 0.018517687916755676, -0.016252832487225533, 0.03418650105595589, 0.0022630752064287663, -0.02197907119989395, 0.005395057145506144, -0.0035397273022681475, 0.0019586016424000263, -0.00035076774656772614, 0.02357444167137146, 0.03971331939101219, 0.01763453707098961, -0.0037818816490471363, 0.005138658452779055, -0.0003427552874200046, -0.027548622339963913, -0.00789850577712059, -0.0147714177146554, -0.035183608531951904, 0.019144440069794655, -0.0007358110160566866, -0.014671706594526768, 0.0062710861675441265, 0.000819496694020927, -0.014123298227787018, -0.01894501969218254, -0.0020102374255657196, 0.008368570357561111, -0.012485194951295853, -0.0077489400282502174, 0.0012223455123603344, 0.023246821016073227, -0.004682838451117277, 0.022534601390361786, -0.023531708866357803, 0.007578007876873016, -0.0035771187394857407, -0.05202046036720276, 0.02200756035745144, -0.005605161655694246, 0.03891563415527344, 0.001207210822030902, 0.03136611357331276, -0.016865340992808342, -0.0032993534114211798, -0.024400614202022552, 0.018759842962026596, 0.010797236114740372, 0.023289553821086884, -0.009401287883520126, -0.02223546989262104, 0.03632315620779991, -0.022164247930049896, -0.004501222632825375, -0.008283104747533798, -0.006100153550505638, 0.011416866444051266, -0.020113058388233185, 0.005120852962136269, 0.004291118122637272, 0.009914085268974304, -0.018389489501714706, 0.003096371190622449, -0.015170259401202202, 0.0138455331325531, -0.012207429856061935, -0.011829953640699387, -0.022164247930049896, -0.010206094942986965, -0.020939230918884277, -0.0047042048536241055, 0.027505889534950256, 0.014685951173305511, 0.006246158387511969, -0.008211882784962654, 0.004761182703077793, 0.006068103946745396, 0.0527326762676239, 0.004009791649878025, -0.013033603318035603, 0.001418205676600337, 0.016338298097252846, 0.01747784949839115, -0.007485419046133757, -0.004141552373766899, -0.0029574884101748466, -0.010305805131793022, -0.012976625934243202, 0.018304022029042244, 0.02294768951833248, -0.0428185909986496, -0.009821496903896332, -0.007934116758406162, -0.0017903399420902133, -0.016124632209539413, -0.026437560096383095, 0.01232850644737482, -0.00279367808252573, -0.00033607822842895985, 0.01774849183857441, 0.01082572527229786, 0.015583346597850323, 0.03791852667927742, 0.0062532806769013405, 0.03390161320567131, 0.01797640137374401, -0.025369232520461082, 0.022050293162465096, 0.010961046442389488, -0.0018054746324196458, -0.010263072326779366, 0.008347203955054283, -0.004554639104753733, 0.011010902002453804, 0.004177162889391184, -0.02321833185851574, 0.04301801323890686, -0.0031355430837720633, 0.034813255071640015, -0.036750487983226776, 0.006937010679394007, 0.02212151512503624, -0.015027816407382488, -0.0014529263135045767, -0.005815266165882349, 0.010049406439065933, 0.003956375177949667, 0.027933219447731972, 0.008112171664834023, 0.02333228662610054, 0.01809035614132881, 0.022748267278075218, 0.0077845510095357895, -0.013396834954619408, -0.00796260591596365, 0.03922900930047035, -0.03159402310848236, -0.03484174236655235, 0.016352543607354164, -0.013453812338411808, 0.0048715765587985516, -0.01979968138039112, 0.0015214773593470454, -0.027662577107548714, 0.0050140200182795525, -0.020967720076441765, 0.016224343329668045, 0.058629848062992096, 0.03267659619450569, 0.033616725355386734, 0.004237701650708914, 0.001533050904981792, -0.018617399036884308, 0.007741818204522133, -0.013638989068567753, -0.046379685401916504, -0.0020511900074779987, -0.021366562694311142, -0.030938783660531044, 0.00031026030774228275, 0.021850870922207832, -0.014066320843994617, -0.0005706652882508934, 0.010889825411140919, -0.022890711203217506, 0.0043409732170403, 0.014201642014086246, -0.013945243321359158, 0.022520357742905617, 0.007699084933847189, -0.010163362137973309, 0.00045893597416579723, 0.017349649220705032, -0.02491341345012188, 0.015996433794498444, 6.576895248144865e-05, -0.023645663633942604, 0.005986198782920837, -0.03296148404479027, 0.025440454483032227, -0.011146224103868008, -0.011765854433178902, 0.028218107298016548, 0.004650788381695747, -0.014757173135876656, 0.009208988398313522]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
"(or{αj}jif the NFA could be in multiple
possible subterminals). Similarly, we let βdenote some sub-
state of the currently used parser, e.g., the currently applied
rule. Conditioned on α, β we can then learn a simple, count-
based model for speculative next token prediction:
P(l|α, β) =#{LLM chose lin state (α, β)}
#{reached state (α, β)}.
As structured languages often are very predictable and α, β
can be strongly indicative of the next token, this mechanism
can lead to massive speed-up during inference. Further, as
we learn these counts over the parser state β, we only learn
to predict tokens that are legal in the language.
In practice, we parameterize stokens to be predicted this
way at a time, if the P(l|α, β)is sufficiently large. This
form of speculative decoding is independent of standard
speculative decoding applied to the underlying LLM (Chen
et al., 2023), and could even be applied jointly with it.
6
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
Table 2. Task Accuracy of different constrained decoding methods on GSM8K Cobbe et al. (2021) and CONLL2003 Tjong Kim Sang
(2002) datasets (400 test samples). All experiments rely on 5-shot prompting with demonstrations taken from the training split.
Dataset Model Method Accuracy Well-Formed Perplexity Performance Impact
GSM8KMistral 7BUnconstrained 0.415 0.952 1.636 1.0 ×
GUIDANCE Lundberg et al. 0.345 0.960 1.624 0.98 ×
GUIDANCEWSLundberg et al. 0.403 0.976 1.737 0.54 ×
llama.cpp Gerganov & et. al. 0.375 0.973 1.751 0.80 ×
DOMINO (k=∞)0.418 0.968 1.739 1.77×
Llama-2 13BUnconstrained 0.262 0.904 1.650 1.0 ×
GUIDANCE Lundberg et al. 0.152 0.947 1.659 1.12 ×
GUIDANCEWSLundberg et al. 0.259 0.977 1.760 0.73 ×
llama.cpp Gerganov & et. al. 0.237 0.978 1.780 0.86 ×
DOMINO (k=∞)0.262 0.920 1.750 1.66×
CoNLL2003Mistral 7BUnconstrained 0.21 0.988 1.573 1.0 ×
GUIDANCE Lundberg et al. 0.098 0.998 1.780 2.02 ×
GUIDANCEWSLundberg et al. 0.19 0.998 1.896 0.82 ×
llama.cpp Gerganov & et. al. 0.117 0.995 1.560 0.80 ×
DOMINO (k=∞)0.21 0.988 1.902 2.66×
Llama-2 13BUnconstrained 0.09 0.897 1.579 1.0 ×
GUIDANCE Lundberg et al. 0.062 1.000 1.820 2.18 ×
GUIDANCEWSLundberg et al. 0.087 0.980 1.767 0.90 ×
llama.cpp Gerganov & et. al. 0.080 0.922 1.786 0.86 ×
DOMINO (k=∞)0.09 0.897 1.812 2.71×
WSGUIDANCE CFG program with flexible whitespace and formatting.
4. Experimental Evaluation
We evaluate DOMINO in terms of downstream task accuracy,
compare its performance to multiple baselines and ablate
key parameters such as k.
Setup We evaluate on the Mistral 7B (Jiang et al., 2023)
and the Llama-2 13B (Touvron et al., 2023c) language mod-
els. As inference backends, we rely on both, transformers
(Wolf et al., 2019) and llama.cpp (Gerganov & et. al.) on
NVIDIA A100","[0.018642483279109, 0.02589474245905876, 0.06061330437660217, -0.004840846173465252, 0.009825872257351875, 0.017171846702694893, -0.01385570503771305, 0.009342868812382221, -0.003759495448321104, 0.03852491453289986, -1.7431146261515096e-05, -0.008809402585029602, -0.033997662365436554, 0.006989129353314638, -0.0010245796293020248, -0.013898959383368492, 0.010085396468639374, 0.012204843573272228, -0.0037054279819130898, 0.05060720816254616, 0.01981034316122532, -0.010193531401455402, -0.022045133635401726, -0.00410913210362196, -0.024712465703487396, -0.006942270789295435, 0.0037306593731045723, 0.04509952664375305, 0.02787000872194767, -0.05674927681684494, 0.02938389964401722, -0.034805070608854294, -0.0013877332676202059, -0.04198523983359337, 0.004693061579018831, 0.07318580895662308, 0.025433365255594254, 0.039995551109313965, -0.049886304885149, 0.007122495677322149, -0.029758768156170845, -0.06459267437458038, -0.04899238795042038, -0.040399257093667984, 0.01593189872801304, 0.04011089727282524, -0.027639320120215416, 0.07174400240182877, -0.012493203394114971, 0.03567015007138252, -0.053808003664016724, 0.018209943547844887, -0.007634335197508335, 0.043974924832582474, -0.01718626543879509, -0.04368656128644943, -0.010316084139049053, 0.02312648482620716, 0.0362757071852684, -0.03249818831682205, -0.02353018894791603, -0.04253312200307846, 0.030450832098722458, 0.017373699694871902, -0.008636386133730412, -0.016191422939300537, -0.030104799196124077, 0.015903063118457794, 0.005003048572689295, 0.027408631518483162, -0.003269283100962639, 0.004242498893290758, 0.027278870344161987, -0.030508503317832947, -0.03590083867311478, 0.0028313363436609507, 0.04847333952784538, 0.04677201807498932, 0.005298617761582136, -0.015412850305438042, 0.011858811601996422, -0.0317484512925148, 0.01028003916144371, -0.0529140867292881, 0.024986406788229942, -0.01809459924697876, 0.00659984303638339, 0.004152385983616114, -0.052942924201488495, -0.03976486623287201, -0.03887094929814339, -0.019334547221660614, -0.02342926152050495, 0.01764764077961445, 0.03471856191754341, -0.012536457739770412, 0.013019461184740067, -0.03910163789987564, 0.02475571818649769, 0.023602278903126717, 0.02324182726442814, -0.01607607863843441, 0.03532411903142929, -0.04204291105270386, 0.05969054996967316, 0.002948482520878315, -0.03304607421159744, 0.01748904399573803, -0.039476506412029266, -0.0010651303455233574, -0.05101091042160988, -0.02827371284365654, -0.04238894209265709, 0.02011311985552311, 0.036765918135643005, -0.05862361937761307, -0.07347416877746582, -0.008290354162454605, -5.1026228902628645e-05, -0.020271718502044678, -0.013646644540131092, -0.009580765850841999, 0.02011311985552311, 0.015585865825414658, -0.0030205724760890007, 0.030566176399588585, 0.01688348688185215, -0.06072864681482315, 0.0033269552513957024, -0.009696110151708126, -0.0050246757455170155, -0.0011984969023615122, 0.024971989914774895, 0.0018671320285648108, -0.0418410561978817, -0.004336215555667877, -0.04042809456586838, 0.01991126872599125, -0.035208772867918015, 0.02534685656428337, 0.0028890082612633705, -0.02611101232469082, 0.004192035645246506, 0.012586920522153378, -0.05279874429106712, 0.01764764077961445, -0.04253312200307846, 0.023501351475715637, -0.06124769523739815, 0.04388841614127159, -0.014994727447628975, -0.03396882489323616, -0.05579768866300583, -0.008924746885895729, -0.005572559777647257, -0.04723339155316353, -0.05648975446820259, 0.017820658162236214, 0.020084284245967865, -0.020185209810733795, -0.0030223748181015253, 0.03523761034011841, 0.02853323705494404, -0.007605499122291803, 0.017748568207025528, 0.023703204467892647, -0.043513547629117966, 0.0332479253411293, -0.07439691573381424, -0.006960293278098106, 0.02841789275407791, 0.0038135629147291183, -0.031114060431718826, -0.04884820803999901, -0.013999884948134422, -0.02595241367816925, -0.01136859878897667, -0.013769197277724743, -0.009941216558218002, -0.0438595786690712, -0.023919474333524704, 0.04305217042565346, -0.020170792937278748, -0.010799087584018707, -0.05210667848587036, -0.025462200865149498, -0.02041589841246605, 0.032180991023778915, 0.008052457123994827, 0.02645704336464405, -0.01549935806542635, 0.0463683120906353, 0.10479007661342621, 0.05080905929207802, 0.007482945919036865, -0.02011311985552311, 0.06315087527036667, 0.0309987161308527, 0.020891692489385605, -0.017705313861370087, 0.013574553653597832, 0.01673930697143078, 0.017200682312250137, -0.07497364282608032, 0.015960734337568283, 0.001677895663306117, -0.01411522924900055, 4.722460653283633e-05, -0.0005888855084776878, -0.0034422993194311857, 0.024020399898290634, -0.018757827579975128, 0.04057227447628975, -0.012882489711046219, -0.043715398758649826, -0.005543723702430725, -0.03613152727484703, -0.0012426520697772503, 0.0013868320966139436, 0.03163310885429382, 0.020487988367676735, 0.04703154042363167, 0.029902948066592216, 0.009133807383477688, -0.042360104620456696, 0.039188142865896225, 0.009141016751527786, -0.0033611981198191643, 0.004282148089259863, -0.020949365571141243, 0.018282033503055573, -0.01926245726644993, -0.00671518687158823, -0.009191479533910751, 0.005590582266449928, -0.055509328842163086, -0.00508955679833889, -0.04152386263012886, 0.016465364024043083, -0.04158153384923935, 0.011801139451563358, -0.0013787220232188702, 0.04853101447224617, -0.012514830566942692, -0.0063979909755289555, 0.008571505546569824, -0.0274663046002388, -0.04726222902536392, 0.03754449263215065, 0.03936116024851799, -0.005013862159103155, -0.028994612395763397, -0.024654792621731758, -0.016667217016220093, -0.06234346330165863, 0.020992619916796684, -0.04979979991912842, 0.012954579666256905, -0.008225473575294018, 0.002885403810068965, -0.03287305682897568, -0.0011426270939409733, -0.014468470588326454, 0.023400425910949707, -0.03976486623287201, -0.037573326379060745, -0.02358786016702652, 0.03417067974805832, 0.007598289754241705, -0.05660509690642357, -0.041898731142282486, -0.04227359965443611, -0.014836129732429981, 0.016364438459277153, -0.06568843871355057, -0.05729716271162033, 0.009177061729133129, 0.018916426226496696, -0.023414844647049904, 0.023977147415280342, -0.01413685642182827, -0.023674368858337402, 0.043830741196870804, 0.008232682012021542, -0.004696665797382593, 0.014627068303525448, 0.00377391348592937, -0.01795041933655739, -0.023674368858337402, -0.018685737624764442, -0.0012147171655669808, 0.018786663189530373, 0.04746408015489578, -0.024106908589601517, 0.002629484049975872, -0.005659068003296852, 0.032527025789022446, -0.0011255056597292423, -0.010517936199903488, 0.010539563372731209, 0.04339820146560669, 0.010085396468639374, -0.0027700597420334816, -0.02080518566071987, 0.0027556417044252157, 0.0241934172809124, -0.002627681940793991, -0.015787718817591667, 0.00268355174921453, -0.00016952422447502613, -0.008802193216979504, 0.018916426226496696, -0.020603332668542862, 0.02841789275407791, -0.040745288133621216, -0.057729702442884445, 0.03166194632649422, -0.051126256585121155, 0.03768867254257202, -0.03445903956890106, -0.004556090570986271, -0.019882433116436005, 0.002164503326639533, 0.0015886841574683785, -0.01975267007946968, 0.0074541098438203335, -0.01884433627128601, 0.00796594936400652, -0.017979254946112633, -0.033334434032440186, -0.003961347509175539, 0.038928620517253876, 0.06315087527036667, 0.025981249287724495, -0.03546829894185066, -0.04570508375763893, -0.04985747113823891, 0.03915930911898613, 0.03523761034011841, 0.04328285902738571, -0.09654297679662704, 0.017200682312250137, 0.017013248056173325, -0.003323350800201297, -0.03567015007138252, -0.0007740667788311839, -0.012550875544548035, 0.021035872399806976, 0.08639270067214966, 0.0018833522917702794, 0.0021266560070216656, -0.01206787209957838, 0.039130471646785736, -0.024078072980046272, 0.008874284103512764, 0.006088003516197205, 0.002968307351693511, 0.0019500355701893568, -0.001998696243390441, -0.002427631989121437, -0.03907280042767525, 0.0026781449560076, -0.035612478852272034, 0.0443497896194458, -0.015153326094150543, -0.005313035566359758, -0.011036984622478485, 0.0032638765405863523, 0.024568285793066025, -0.03910163789987564, 0.023068811744451523, 0.02661564201116562, -0.019493145868182182, -0.0025483828503638506, -0.01113791111856699, -0.008989627473056316, -0.01237065065652132, 0.024611538276076317, 0.013278985396027565, 0.030623847618699074, 0.03166194632649422, -0.03402649611234665, -0.017964838072657585, -0.005327453836798668, 0.0011552429059520364, 0.01581655442714691, -0.0015616504242643714, -0.007555035874247551, -0.012795981951057911, -0.009530303068459034, -0.004783174023032188, 0.00045078800758346915, 0.006805299781262875, 0.021583756431937218, -0.0074108559638261795, 0.026038922369480133, -0.01443963497877121, 0.0332479253411293, 0.033939991146326065, 0.036506395787000656, 0.04011089727282524, -0.03200797736644745, -0.02750955894589424, -0.016710471361875534, -0.01658070832490921, 0.006927852518856525, 0.010150277055799961, 0.03468972444534302, 0.04068761691451073, 0.014836129732429981, 0.03024897910654545, -0.026601223275065422, 0.04682968929409981, -0.044320955872535706, -0.011959737166762352, -0.022347912192344666, -0.010719788260757923, 0.002892612712457776, 0.05398102104663849, 0.06920643895864487, -0.011224418878555298, -0.031777288764715195, -0.017099756747484207, -0.05383684113621712, -0.013228521682322025, 0.016047243028879166, -0.004851659759879112, -0.05302943289279938, 0.037515655159950256, -0.040947142988443375, -0.012053454294800758, 0.02817278727889061, 0.032786548137664795, -0.01162091363221407, -0.029816439375281334, -0.027033764868974686, 0.018411796540021896, 0.0529140867292881, -0.006318691652268171, -0.05155879631638527, 0.010770251974463463, -0.006044749636203051, -0.015023563988506794, 0.0044623734429478645, -0.014850547537207603, 0.03673708438873291, -0.04631064087152481, -0.033795811235904694, 0.003698218846693635, -0.03321908786892891, -0.017402535304427147, -0.029470408335328102, 0.04394608736038208, 0.014850547537207603, -0.016768142580986023, -0.0418410561978817, 0.12976206839084625, -0.030623847618699074, 0.04723339155316353, 0.011195583269000053, 0.029874112457036972, -0.019738253206014633, -0.0463683120906353, -0.037313804030418396, -0.02802860736846924, 0.03745798394083977, 0.0014427019050344825, 0.02540452964603901, 0.025865904986858368, 0.03693893551826477, -0.015701210126280785, -0.02303997613489628, -0.02041589841246605, -0.013906167820096016, -0.027581648901104927, 0.03160427138209343, 0.052395038306713104, -0.04204291105270386, 0.025591963902115822, -0.005500469822436571, -0.017099756747484207, 0.00739643769338727, 0.04942493140697479, 0.004091109614819288, 0.012687847018241882, 0.1164398267865181, 0.007313534151762724, 0.009825872257351875, 0.00453446339815855, -0.012356232851743698, -0.0024871062487363815, -0.04299449920654297, 0.04158153384923935, -0.01783507503569126, 0.01425940915942192, -0.013841287232935429, 0.02348693460226059, -0.028836015611886978, -0.030075963586568832, -0.03996671736240387, 0.009523093700408936, -0.0027087831404060125, -0.029513660818338394, 0.02942715398967266, -0.008499415591359138, -0.01219763420522213, 0.019579654559493065, 0.0055184923112392426, -0.004999443888664246, -0.010647698305547237, -0.008528251200914383, -0.006275437772274017, 0.005875337868928909, 0.0015931897796690464, -0.01738811656832695, 0.0060483543202281, -0.020141957327723503, 0.008802193216979504, -0.01345921028405428, 0.024683628231287003, 0.005316640250384808, -0.005165251437574625, -0.013278985396027565, 0.00016648293239995837, 0.01577330008149147, -0.004848055075854063, -0.0071693542413413525, -0.12572503089904785, -0.009076136164367199, -0.010791878215968609, 0.023515770211815834, -0.022852541878819466, 0.007241444196552038, 0.020127538591623306, -0.04348471015691757, 8.740917110117152e-05, 0.010741415433585644, -0.004902122542262077, -0.017575550824403763, -0.021742355078458786, 0.01068374328315258, -0.013264566659927368, 0.027682574465870857, 0.004282148089259863, 0.003352186642587185, -0.004711084067821503, 0.015037981793284416, -0.003476541955024004, -0.005071534309536219, 0.03915930911898613, 0.030854536220431328, -0.03653522953391075, 0.03861142322421074, -0.012132753618061543, -0.0016959181521087885, 0.008780566975474358, 0.02005544863641262, -0.00834081694483757, -0.029960619285702705, 0.006787276826798916, 0.0004298368585295975, -0.014864965341985226, -0.03362279385328293, -0.0061745117418468, -0.0014201737940311432, 0.0026168683543801308, 0.006275437772274017, 0.014699158258736134, 0.010251203551888466, 0.045791592448949814, -0.03976486623287201, -0.006444849539548159, 0.03962068632245064, 0.030018292367458344, 0.014482888393104076, -0.03151776269078255, 0.02132423408329487, 0.018887590616941452, 0.019925685599446297, 0.010900014080107212, -0.02223256789147854, -0.04460931569337845, 0.009487048722803593, -0.0246980469673872, -0.02928297407925129, 0.010265621356666088, 0.032123319804668427, 0.011491152457892895, -0.042100582271814346, -0.015571448020637035, 0.0594598613679409, -0.009660065174102783, -0.003918093629181385, 0.01581655442714691, -0.06465034931898117, -0.0008312882273457944, 0.005702321883291006, -0.03206564858555794, -0.041350845247507095, -0.004671434406191111, 0.03719845786690712, -0.0022275822702795267, -0.012983416207134724, -0.0008529152837581933, -0.0011660563759505749, 0.020689841359853745, -0.025390110909938812, -0.014374753460288048, 0.00960239302366972, 0.005615814123302698, -0.01924804039299488, 0.025318020954728127, -0.006358341313898563, -0.0347762331366539, -0.019363384693861008, 0.00030841020634397864, -0.04610878974199295, -0.012882489711046219, 0.054500069469213486, -0.022045133635401726, -0.013113178312778473, -0.002425829879939556, -0.006834135390818119, 0.008297563530504704, 0.02389063872396946, -0.0046642255038022995, -0.01496589183807373, -0.011829975061118603, -0.006801695097237825, -0.015657955780625343, -0.028706252574920654, -0.03140242025256157, 0.015326341614127159, 0.0026943651027977467, -0.004970608279109001, 0.0063655502162873745, -0.002705178689211607, -0.011685795150697231, 0.01753229647874832, -0.014569397084414959, 0.014951474033296108, 0.02524593099951744, -0.0069350614212453365, -0.043023332953453064, 0.030681520700454712, 0.0068918075412511826, 0.000267859548330307, -0.010820714756846428, -0.012212052009999752, -0.01960849016904831, -0.02847556583583355, -0.022593017667531967, 0.03970719128847122, 0.016696052625775337, 0.02861974574625492, -0.03229633718729019, -0.014994727447628975, -0.014129647053778172, 0.00495258579030633, -0.00240059825591743, -0.042763810604810715, 0.008557087741792202, -0.03748682141304016, -0.005136415362358093, 0.006931457202881575, 0.03368046507239342, -0.005219318903982639, 0.03445903956890106, 0.008268726989626884, -0.008521042764186859, 0.008549878373742104, 0.011455106548964977, 0.010510727763175964, -0.003164752619341016, 0.004076691810041666, -0.0029232511296868324, -0.014735204167664051, -0.04982863366603851, -0.008304771967232227, 0.015758881345391273, -0.05735483393073082, 0.02601008489727974, -0.05533631145954132, -0.03270003944635391, -0.0010290852515026927, 0.018166689202189445, 0.026774240657687187, 0.020502407103776932, 0.003759495448321104, 0.027480721473693848, 0.01400709431618452, -0.03206564858555794, 0.014598232693970203, 0.0026601224672049284, 0.026932837441563606, 0.004793987609446049, -0.00451283622533083, 0.03840957209467888, -0.030566176399588585, -0.01829645223915577, -0.020877275615930557, -6.414886593120173e-05, -0.012601338326931, -0.022953467443585396, -0.018527138978242874, -0.028288131579756737, -0.0017950419569388032, -0.008333608508110046, 0.04406142979860306, -0.017056502401828766, 0.015845390036702156, 0.011613705195486546, -0.029556915163993835, -0.0001624278665985912, -0.030364323407411575, 0.0021464808378368616, 0.012449949979782104, -0.016768142580986023, 0.004967003595083952, -0.04766593128442764, -0.03463205322623253, 0.015456103719770908, -0.02821604162454605, 0.010056559927761555, 0.015989569947123528, -0.0009236535988748074, -0.01754671521484852, 0.01633560284972191, -0.01123883668333292, 0.020603332668542862, 0.027480721473693848, 0.02338600903749466, 0.0024456544779241085, -0.030508503317832947, -0.04394608736038208, 0.009364495985209942, -0.01975267007946968, 0.009631228633224964, -0.018224362283945084, -0.021035872399806976, 0.02857649140059948, -0.012601338326931, -0.07728052139282227, 0.0079371128231287, 0.002288858639076352, -0.008355235680937767, 0.00854266993701458, 0.03128707781434059, 0.0013084341771900654, 0.004682247992604971, -0.037515655159950256, 0.01451893337070942, -0.004484000150114298, 0.010143068619072437, 0.014100811444222927, -0.012248096987605095, -0.0072090039029717445, 0.00798757653683424, -0.00467503909021616, 0.01154161524027586, 0.011894856579601765, 0.011065821163356304, -0.004437142051756382, -0.01950756460428238, -0.009804245084524155, 0.03924581781029701, -0.026745403185486794, -0.009155434556305408, 0.029311809688806534, 0.04567624628543854, 0.012832026928663254, -0.012976206839084625, 0.006430431269109249, 0.02675982192158699, 0.03512226790189743, -0.010553981177508831, -0.018426213413476944, 0.006470080930739641, 0.00037509348476305604, 0.03803470358252525, -0.013415955938398838, -0.02514500543475151, 0.006596238352358341, -0.015167743898928165, -0.01401430368423462, 0.005579769145697355, -0.013502463698387146, 0.018368542194366455, -0.008600341156125069, -0.00919868890196085, -0.027740245684981346, 0.0093212416395545, -0.0309987161308527, 0.035698987543582916, 0.008153383620083332, 0.04077412560582161, -0.019824760034680367, -0.16159702837467194, -0.041148994117975235, 0.017907164990901947, 0.017575550824403763, -0.010352129116654396, -0.010914431884884834, 0.02201629802584648, 0.020041029900312424, -0.02877834253013134, 0.010806296952068806, -0.010993731208145618, -0.030652683228254318, -0.010546772740781307, 0.01754671521484852, 0.011729049496352673, -0.03385348245501518, -0.016652798280119896, -0.031373582780361176, 0.03924581781029701, -0.013653852976858616, 0.01177230291068554, -0.012680637650191784, -0.015311923809349537, 0.009076136164367199, -0.008095711469650269, -0.02076193131506443, -0.007468528114259243, 0.025591963902115822, 0.004127154592424631, 0.04400375857949257, -0.006178116425871849, -0.02898019552230835, 0.01632118411362171, 0.03809237480163574, -0.004033437464386225, -0.014252200722694397, -0.006390782073140144, -0.04342703893780708, -0.011166746728122234, -0.010618862695991993, 0.015456103719770908, -0.03590083867311478, 0.013531300239264965, 0.0002901623956859112, 0.017777403816580772, -0.0005605000187642872, 0.002892612712457776, -0.0007722645532339811, -0.01623467728495598, -0.03261353448033333, -0.0120967086404562, 0.005010257475078106, 0.016667217016220093, -0.012832026928663254, -0.010806296952068806, 0.0072090039029717445, 0.00534187164157629, 0.0064808945171535015, -0.003460321808233857, 0.021353069692850113, -0.008420116268098354, 0.015081236138939857, -0.008427325636148453, 0.007973157800734043, -0.02368878573179245, -0.018757827579975128, 0.015744464471936226, -0.009934007190167904, -0.000854717509355396, -0.03936116024851799, -0.01845504902303219, 0.00894637405872345, -0.011404643766582012, 0.016090495511889458, 0.0004703874874394387, 0.03120056912302971, -0.005651859100908041, 0.03665057569742203, -0.047291066497564316, 0.013545718044042587, 0.02792767994105816, -0.019968939945101738, -0.010171904228627682, -0.016249094158411026, 0.027639320120215416, 0.022650690749287605, 0.025736143812537193, -0.00916985236108303, -0.030450832098722458, 0.024726882576942444, 0.05922917649149895, 0.010229576379060745, 0.009263569489121437, 0.005500469822436571, -0.03264236822724342, -0.03160427138209343, 0.0011191978119313717, 0.01829645223915577, -0.008160592056810856, -0.009537512436509132, 0.03437253087759018, 0.03166194632649422, -0.04273497313261032, -0.039389997720718384, 0.003925302531570196, 0.022953467443585396, -0.007158540654927492, -0.028850432485342026, 0.013927794992923737, -0.0027772686444222927, 0.03235400840640068, 0.02872067131102085, 0.016667217016220093, 0.031085224822163582, -0.00480119651183486, 0.02389063872396946, 0.05366382375359535, 0.026730986312031746, 0.01401430368423462, 0.02223256789147854, 0.017099756747484207, -0.013704315759241581, -0.010207949206233025, 0.002656517783179879, -0.04057227447628975, -0.006347527727484703, 0.030479667708277702, 0.0058356886729598045, -0.0040947142988443375, -0.022146059200167656, -0.006358341313898563, 0.024957571178674698, -0.03246935456991196, 0.006304273847490549, 0.0073784152045845985, -0.006131257861852646, 0.009386123158037663, 0.03189263120293617, -0.026774240657687187, 0.04227359965443611, 0.005269781686365604, -0.00038996204966679215, 0.04951143637299538, 0.0022365935146808624, -0.014591023325920105, 0.003280096687376499, -0.011880437843501568, -0.015557030215859413, -0.0073279524222016335, 0.02851881831884384, 0.017402535304427147, -0.016249094158411026, -0.015960734337568283, -0.026745403185486794, 0.006488103419542313, -0.008694058284163475, -0.0028890082612633705, -0.030104799196124077, 0.011397435329854488, 0.026183102279901505, 0.008254309184849262, 0.018786663189530373, -0.027307705953717232, -0.04230243340134621, 0.03468972444534302, 0.0033666046801954508, -0.03154660016298294, -0.0090689267963171, -0.006372759118676186, 0.008456161245703697, -0.03396882489323616, -0.0619974322617054, 0.041552696377038956, 0.011094656772911549, 0.02510175108909607, 0.021583756431937218, 0.03131591156125069, -0.018671318888664246, 0.01335107535123825, 0.026932837441563606, -0.002038345905020833, 0.006459267344325781, -0.029874112457036972, 0.032123319804668427, 0.03385348245501518, -0.016263512894511223, 0.013012251816689968, 0.03261353448033333, -0.0012877082917839289, 0.03901512920856476, 0.010417010635137558, 0.044119104743003845, 0.013300611637532711, 0.025173841044306755, 0.01773414947092533, -0.03543946146965027, 0.02453944832086563, 0.04088946804404259, 0.017373699694871902, -0.02861974574625492, -0.0483868345618248, 0.0357854962348938, -0.00811012927442789, 0.012168798595666885, -0.015412850305438042, 0.008600341156125069, 0.01805134490132332, -0.021381905302405357, -0.01995452307164669, 0.025116169825196266, -0.00031404223409481347, 0.000461376243038103, -0.023270664736628532, 0.009782617911696434, 0.032786548137664795, -0.015297506004571915, 0.024265507236123085, 0.0028691834304481745, -0.013617807999253273, -0.021194471046328545, -0.027235615998506546, -0.020689841359853745, -0.016018405556678772, -0.011592078022658825, 0.027437468990683556, 0.0013625017600134015, 0.027033764868974686, 0.007865022867918015, -0.018959680572152138, 0.012002991512417793, -0.0008281343034468591, 0.024164579808712006, 0.02611101232469082, -0.016551872715353966, -0.006221370305866003, -0.028057442978024483, 0.001334566855803132, 0.029556915163993835, -0.00670437328517437, 0.021540503948926926, 0.042215924710035324, -0.0287350881844759, -0.019464310258626938, 0.0058356886729598045, -0.017171846702694893, -0.020026613026857376, -0.006015913560986519, 0.04426328465342522, -0.030364323407411575, 0.027091436088085175, -0.0033485821913927794, 0.00811733864247799, 0.050463028252124786, -0.014612650498747826, 0.006700769066810608, -0.006149280350655317, 0.005673485808074474, 0.03956301137804985, 0.04443629831075668, 0.045387886464595795, -0.010885595344007015, 0.022347912192344666, -0.013163641095161438, -0.007461318746209145, -0.019723834469914436, -0.01682581566274166, -0.02318415604531765, -0.0015814752550795674, 0.011995782144367695, 0.0007141419337131083, -0.02282370626926422, 0.01294737122952938, -0.008607550524175167, 0.024525031447410583, 0.0006789980689063668, -0.01934896595776081, 0.01995452307164669, -0.04172571375966072, 0.005925801116973162, -0.007097264286130667, -0.01702766679227352, 0.005071534309536219, 0.0067656501196324825, 0.006268228869885206, 0.006253810599446297, -0.032988402992486954, -0.0267021507024765, -0.002849358832463622, 0.016018405556678772, -0.03653522953391075, 0.0312582403421402, 0.015960734337568283, 0.018772246316075325, -0.010251203551888466, -0.0059618460945785046, 0.008297563530504704, 0.02171351946890354, -6.122021295595914e-05, 0.03362279385328293, -0.015960734337568283, -0.002586230169981718, 0.02710585482418537, 0.013235731050372124, -0.04564741253852844, 0.02112238109111786, 0.02051682397723198, 0.020401481539011, -0.04244661331176758, -0.01833970472216606, -0.024150162935256958, 0.0014886592980474234, 0.03667940944433212, 0.009436585940420628, 0.005475238431245089, 0.034545544534921646, -0.003990183584392071, -0.01413685642182827, -0.019493145868182182, -0.00929961446672678, -0.03200797736644745, -0.007223421707749367, -0.017849493771791458, 0.0061132353730499744, -0.010957685299217701, -0.013992676511406898, -0.004754337947815657, 0.002242000075057149, -0.020632168278098106, 0.00577080762013793, 0.012731100432574749, 0.014230573549866676, -0.00854266993701458, 0.015701210126280785, 0.005857315380126238, -0.00935007818043232, -0.011880437843501568, -0.016263512894511223, 0.013545718044042587, -0.006844948977231979, -0.02621193788945675, 0.004339820239692926, 0.03503575921058655, -0.008694058284163475, -0.004419119097292423, -0.00575999403372407, 0.03483390808105469, 0.005118392873555422, -0.02045915275812149, 0.003175566205754876, -0.015946315601468086, 0.07901068031787872, -0.02001219429075718, -0.022045133635401726, -0.0027718618512153625, -0.0028745902236551046, 0.029455989599227905, 0.01386291440576315, -0.05086673051118851, -0.01479287538677454, -0.0034783442970365286, 0.024553867056965828, 0.023919474333524704, 0.003910884726792574, -0.0017049293965101242, 0.00041947391582652926, -0.020430317148566246, -0.0027358168736100197, 0.02146841399371624, 0.018166689202189445, 0.03255585953593254, 0.029758768156170845, 0.029960619285702705, -0.0013237532693892717, -0.003343175398185849, -0.02283812314271927, -0.001699522603303194, -0.013790824450552464, 0.016595127061009407, 0.009112181141972542, 0.04530138149857521, 0.004613762255758047, -0.002220373135060072, -0.06811066716909409, 0.0036856031510978937, -0.013264566659927368, 0.012687847018241882, -0.010323293507099152, 0.03976486623287201, -0.030508503317832947, -0.0032007975969463587, -0.007980367168784142, 0.011923692189157009, 0.008751730434596539, 0.0021536899730563164, -0.015888644382357597, 0.011909274384379387, 0.0005046302685514092, -0.008802193216979504, 0.013819660060107708, -0.01098652184009552, 0.048300325870513916, -0.02841789275407791, 0.025736143812537193, 0.005900569725781679, 0.022463256493210793, -0.02922530099749565, -0.011671377345919609, 0.021785609424114227, 0.003418870037421584, -0.01040980126708746, -0.057527851313352585, -0.002220373135060072, -0.013250148855149746, 0.002323101507499814, -0.01443963497877121, -0.03633337840437889, -0.004134363494813442, 0.006978315766900778, -0.03053734079003334, 0.05801806226372719, -0.024409687146544456, -0.010344920679926872, -0.019493145868182182, -0.008045247755944729, -0.006848553661257029, 0.008874284103512764, 0.014807294122874737, -0.013105968944728374, 0.027235615998506546, 0.04651249200105667, -0.005929405800998211, 0.012882489711046219, -0.029816439375281334, 0.008708477020263672, 0.016047243028879166, 0.0016481585334986448, 0.03396882489323616, 0.0068918075412511826, -0.00023429261636920273, 0.025375694036483765, -0.0006929654628038406, 0.014172901399433613, 0.026082174852490425, 0.010294456966221333, 0.00937170535326004, -0.016854651272296906, 0.00894637405872345, -0.029268555343151093, 0.004026228561997414, -0.014764039777219296, 0.002442050026729703, -0.009660065174102783, -0.023905055597424507, -0.005013862159103155, -0.028086278587579727, 0.009962842799723148, -0.050578370690345764, -0.004754337947815657, -0.01632118411362171, 0.03809237480163574, 0.0016490595880895853, -0.0028187204152345657, 0.038236554712057114, -0.008831029757857323, 0.010121441446244717, -0.0038135629147291183, -0.004181222058832645, 0.017445789650082588, 0.006740418728441, -0.003618919989094138, 0.028043024241924286, 0.009227524511516094, 0.03607385605573654, -0.007418064866214991, -0.016162587329745293, -0.024178998544812202, -0.030681520700454712, 0.003932511433959007, 0.015557030215859413, -0.01388454157859087, -0.012024618685245514, -0.0018545162165537477, -0.025289185345172882, 0.021497249603271484, 0.010517936199903488, 0.005572559777647257, 0.019882433116436005, -0.015802135691046715, -0.012954579666256905, -0.0030133635737001896, 0.04339820146560669, 0.03915930911898613, -0.0032764922361820936, 0.0002186355704907328, 0.0043037752620875835, 0.00028993713203817606, 0.009328451007604599, 0.00010745921463239938, 0.03765983507037163, 0.026038922369480133, -0.0102007407695055, 0.0011975957313552499, 0.002551987301558256, 0.0041884309612214565, -0.029412735253572464, -0.0006925149355083704, 0.006971106864511967, -0.007108077872544527, 0.004329006653279066, 0.006012309342622757, 0.01663838140666485, -0.006041144952178001, -0.0019193972693756223, 0.01991126872599125, 0.03342094272375107, 0.0027484328020364046, -0.014050348661839962, 0.01058281771838665, 0.013841287232935429, -0.016869068145751953, 0.012788772583007812, 0.014735204167664051, 0.008297563530504704, 0.012421113438904285, -0.027538394555449486, -0.029960619285702705, -0.024323178455233574, 0.028461147099733353, 0.003143125679343939, 0.006668328307569027, -0.022246984764933586, -0.018181107938289642, 0.04804079979658127, -0.005716740153729916, -0.02162701077759266, -0.02681749314069748, -0.008124547079205513, 0.0075694541446864605, -0.010755833238363266, 0.01177230291068554, 0.01335107535123825, -0.02575056068599224, -0.008881492540240288, -0.019377801567316055, 0.0033197463490068913, 0.0158742256462574, -0.009523093700408936, 0.016450947150588036, 0.02489989995956421, 0.021410740911960602, 0.01425940915942192, -0.020603332668542862, 0.04662783816456795, 0.025966832414269447, -0.022564182057976723, 0.04218709096312523, -0.010380965657532215, -0.0026330887340009212, -0.013394328765571117, -0.006819717586040497, 0.011808347888290882, 0.011909274384379387, 0.01573004573583603, 0.02908112108707428, 0.02152608521282673, -0.016422109678387642, 0.012961789034307003, -0.015326341614127159, -0.0352664478123188, 0.0067656501196324825, -0.012954579666256905, 0.009508675895631313, 0.021800028160214424, 0.035612478852272034, -0.021756773814558983, 0.015917479991912842, 0.0032098088413476944, -0.018685737624764442, -0.012716682627797127, 0.015802135691046715, 0.0018923635361716151, -0.018714573234319687, -0.018685737624764442, 0.007263071369379759, 0.01603282429277897, 0.009883544407784939, 0.013625017367303371, -0.014252200722694397, 0.006026727147400379, 0.0005203999462537467, -0.026543552055954933, 0.025375694036483765, 0.0090689267963171, 0.0367947556078434, -0.0012309374287724495, 0.06366991996765137, 0.00781456008553505, -0.0028673813212662935, -0.028057442978024483, 0.00847057905048132, -0.00942937657237053, 0.018253197893500328, -0.0015652549918740988, -0.019594071432948112, 0.027841173112392426, -0.06540007889270782, -0.011729049496352673, 0.008283145725727081, 0.004873286467045546, -0.003011561231687665, -0.008535460568964481, 0.0012696858029812574, 0.01607607863843441, 0.008708477020263672, 0.0025015242863446474, 0.035756658762693405, -0.011015357449650764, 0.010597235523164272, -0.024005983024835587, 0.009414958767592907, -0.017719730734825134, -0.001984278205782175, -0.04068761691451073, -0.009934007190167904, 0.029614588245749474, 0.039995551109313965, 0.004725501872599125, -0.004999443888664246, -0.00506432494148612, 0.0012300362577661872, 0.0649963766336441, 0.008138964883983135, -0.007248653098940849, 0.0024582701735198498, 0.015311923809349537, 0.011974154971539974, -0.028432311490178108, 0.00826151855289936, -0.011282091028988361, 0.000267859548330307, -0.02263627201318741, 0.002159096533432603, 0.042215924710035324, -0.035554807633161545, 0.02262185327708721, 0.019233621656894684, 0.013567345216870308, 0.003260271856561303, -0.006383572705090046, 0.02106470987200737, -0.006116839591413736, -0.030364323407411575, -0.008275936357676983, 0.009717737324535847, 0.015585865825414658, 0.03564131632447243, 0.0076847979798913, 0.04806963726878166, -0.0012696858029812574, 0.006848553661257029, 0.0025069310795515776, 0.024957571178674698, 0.005406752694398165, 0.002580823376774788, 0.011202791705727577, 0.013315030373632908, -0.004783174023032188, 0.010777460411190987, -0.01017911359667778, 0.03538179025053978, -0.020877275615930557, 0.016969995573163033, -0.022953467443585396, -0.007165749557316303, 0.01965174451470375, -0.005013862159103155, 0.000947082880884409, -0.004192035645246506, 0.02126656100153923, 0.023112066090106964, 0.010496309958398342, -0.018469467759132385, 0.028158368542790413, 0.014677532017230988, 0.00672960514202714, 0.005684299394488335, -0.002753839362412691, 0.005767202936112881, 0.046599000692367554, -0.03483390808105469, -0.03362279385328293, 0.0005582472076639533, -0.015441685914993286, 0.0010696359677240252, -0.030479667708277702, -0.007389228790998459, -0.03852491453289986, 0.01415848359465599, -0.018671318888664246, 0.016003988683223724, 0.061017006635665894, 0.0016301359282806516, 0.026586806401610374, -0.011599287390708923, 0.02253534644842148, 0.009090553969144821, 0.030623847618699074, -0.0023627509362995625, -0.03241167962551117, -0.009213106706738472, -0.02867741696536541, -0.023515770211815834, 0.027696993201971054, 0.030566176399588585, 0.012305769138038158, 0.0071261003613471985, 0.006657515186816454, -0.02213164232671261, 0.006012309342622757, 0.014727994799613953, -0.023847384378314018, 0.017042085528373718, 0.008867074735462666, -0.0012066069757565856, 0.010827924124896526, 0.025764979422092438, -0.016350019723176956, -0.011318136006593704, 0.0037162413354963064, -0.007800142280757427, 0.008333608508110046, -0.012716682627797127, 0.0214251596480608, -0.012039036490023136, -0.005579769145697355, 0.016393274068832397, -0.010171904228627682, -0.013077132403850555, 0.00839128065854311]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" 40GB or H100 80GB GPUs. Because of its
nature, we explicitly evaluate DOMINO in an offline setting,
where all grammars are known ahead of time and do not
vary across inference requests.
Datasets We assess downstream accuracy of different con-
straining methods with the GSM8K (Cobbe et al., 2021)
benchmark for math reasoning and CoNLL-2003 (Tjong
Kim Sang, 2002) for named-entity recognition (subset of
400 test samples). To examine the performance properties of
different decoding methods, we compare their overhead over
unconstrained decoding for different tasks, including the
constrained generation of JSON ,JSON with Schema , the C
Programming Language ,XML with Schema and more static,
regex-based generation templates similar to GUIDANCE or
LMQL programs with simple structure.Baselines We consider the following baselines:
•Unconstrained Generation We generate output with-
out any form of constraints, using the same prompts
and inference backend.
•GUIDANCE Programs (Lundberg et al.) We construct
GUIDANCE programs to generate output in the desired
output formats. We compare template-based programs
(standard approach) and CFG-based variants, which
are whitespace agnostic (comparison in App. A).
•LLAMA .CPP Grammars (Gerganov & et. al.) We
rely on LLAMA .CPP’s support for ebnf grammars as an
online parsing baseline (also representative of (Poesia
et al., 2022) and Geng et al. (2023b)).
4.1. Task Accuracy
We first evaluate the impact of different constrained decod-
ing methods on downstream accuracy. For this, we use the
GSM8K benchmark for math reasoning and CoNLL-2003
for named-entity recognition.
Setup For both datasets, we prompt and constrain the mod-
els to generate a response in a given JSON format, instead of
free-text reasoning (see App. D for examples). Our prompts
consist of 5 few-shot demonstrations from the training split,
for which we manually construct the corresponding JSON
7
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
Table 3. Impact on throughput of constrained decoding methods with different grammars, compared to unconstrained generation. We
report the change in throughput compared to generating unconstrained output with the same model and inference backend. As CFGaccel
we report D OMINO opportunistic masking or speculative decoding, depending on which is more effective.
llama.cppop
Gerganov & et. al.guidanceHF
Lundberg et al.DOMINOHF
(Ours)
Grammar Model CFG Template↓CFG CFG CFGaccel
JSON (no schema)Mistral 7B 0.79× 1.03× 0.81× 0.88× 0.96×(opportunistic)
Llama 13B 0.83× 1.03× 0.86× 0.95× 1.12×(spec. s= 10 )
JSON (GSM8K schema, see App. D)Mistral 7B 0.80× 0.77× 0.59× 0.99× 1.77×(spec. s= 10 )
Llama 13B 0.86× 0.94× 0.74× 0.99× 1.66×(spec. s= 10 )
C Programming LanguageMistral 7B 0.74× - - 0.41 × 0.78×(opportunistic)
Llama 13B 0.81× - - 0.54 × 0.85×(opportunistic)
XML (with schema)Mistral 7B 0.80× - - 0.94 × 1.52×(spec. s= 10 )
Llama 13B 0.87× - - 0.98 × 1.84×(spec. s= 10 )
Fixed TemplateMistral 7B 0.55× 1.95× 0.92× 0.97× 1.30×(spec. s= 10 )
Llama 13B 0.69× 2.05× 1.06× 0.99× 1.91×(spec. s= 10 )
opllama.cpp always runs with opportunistic masking,HFUsing the transformers library as inference backend.
↓GUIDANCE templates lead to significantly worse accuracy compared to CFGs (cf. Table 2), but we show them here for completeness.
response. We then compare the accuracy","[0.03924514725804329, 0.02848927304148674, 0.0822962149977684, 0.0041782427579164505, 0.006794815883040428, 0.01314836461097002, -0.003373275976628065, -0.004915985278785229, -0.0065500508062541485, 0.024007659405469894, 0.032157301902770996, -0.006656920071691275, 0.010907557792961597, 0.005281409248709679, -0.020270682871341705, 0.004219611641019583, 0.01683707721531391, -0.025703778490424156, -0.010293921455740929, 0.050469864159822464, 0.044457606971263885, -0.010845504701137543, -0.0053469096310436726, 0.02159448340535164, -0.007108528632670641, 0.002992338966578245, 0.0016400981694459915, 0.0459468811750412, 0.035770170390605927, -0.03287436068058014, 0.02682073414325714, -0.03144024312496185, -0.019939733669161797, -0.05102144554257393, 0.019167516380548477, 0.05273135378956795, 0.03339836373925209, 0.009859549812972546, -0.011879723519086838, -0.00025015161372721195, -0.021773748099803925, -0.04955974966287613, -0.03552195802330971, -0.06795505434274673, 0.008004851639270782, 0.050138913094997406, -0.0012350293109193444, 0.023924922570586205, 7.239529804792255e-05, 0.023773236200213432, -0.07926250994205475, 0.044540345668792725, 0.009776812046766281, -0.003878319403156638, -0.026558730751276016, -0.01802298054099083, -0.010590397752821445, 0.01879519782960415, 0.02568998746573925, -0.02731715887784958, 0.0050159599632024765, -0.041258424520492554, 0.015816649422049522, 0.02147037722170353, -0.0023166495375335217, 0.0008325459202751517, -0.0196363627910614, -0.004526429809629917, 0.02167722024023533, 0.029675176367163658, 0.0004343717882875353, 0.019374359399080276, 0.048401426523923874, -0.04906332492828369, -0.021304901689291, 0.01687844656407833, 0.042306430637836456, 0.052869249135255814, 0.0004067926201969385, -0.02134627103805542, 0.013575841672718525, -0.022173644974827766, 0.016202757135033607, -0.04327170178294182, 0.00935623049736023, 0.016368232667446136, 0.0015444329474121332, -0.004388533998280764, -0.0751807913184166, -0.018395300954580307, -0.042554643005132675, -0.014603165909647942, -0.02324923314154148, -0.0072464244440197945, 0.040320731699466705, -0.014134319499135017, -0.003094037063419819, -0.02865474857389927, 0.038004081696271896, 0.02414555475115776, 0.03899693116545677, -0.011231613345444202, 0.017071500420570374, -0.028958119451999664, 0.06199795380234718, 0.013203523121774197, -0.03535648435354233, 0.020767107605934143, -0.014947905205190182, 0.002745850244536996, -0.06155668571591377, -0.053227778524160385, -0.05482736974954605, 0.019705310463905334, 0.03546680137515068, -0.034804899245500565, -0.08080694079399109, 0.0030836949590593576, -0.013865423388779163, -0.010355974547564983, -0.0022218460217118263, -0.010259447619318962, -0.007604953367263079, -0.004774642176926136, 0.0023425049148499966, 0.05568232387304306, 0.022256381809711456, -0.01854698546230793, 0.008542644791305065, -0.03982430696487427, -0.009638916701078415, -0.0012134830467402935, 0.03210214152932167, -0.019429517909884453, -0.06905821710824966, 0.005667517427355051, -0.06630030274391174, -0.002383873797953129, -0.014878957532346249, 0.020794687792658806, -0.027827372774481773, -0.03513585031032562, 0.0026872444432228804, 0.047711946070194244, -0.05587537959218025, 0.0121141467243433, -0.02637946791946888, 0.008694330230355263, -0.050304390490055084, 0.04898058995604515, 0.011845249682664871, -0.007536005694419146, -0.06563840061426163, -0.012203778140246868, 0.011762511916458607, -0.07082328200340271, -0.06503166258335114, 0.029316646978259087, 0.015720121562480927, -0.012527833692729473, 0.028461692854762077, 0.017305923625826836, 0.020463736727833748, -0.001573735848069191, 0.02284933440387249, 0.027620529755949974, -0.028792643919587135, 0.012589886784553528, -0.08235137164592743, -0.009962971322238445, 0.003974846564233303, -0.0009066648781299591, -0.03703881427645683, -0.037066392600536346, -0.019567415118217468, -0.010824820958077908, -0.015858016908168793, -0.022656280547380447, -0.0031164451502263546, -0.030337076634168625, -0.04106536880135536, 0.05642696097493172, -0.0495045930147171, 0.007839376106858253, -0.04390602186322212, -0.013837844133377075, -0.009935392998158932, 0.03579774871468544, 0.001010948559269309, 0.02606230601668358, -0.0181746669113636, 0.013175943866372108, 0.10772420465946198, 0.0338396318256855, 0.016533706337213516, -0.060894787311553955, 0.07131970673799515, 0.01493411511182785, -0.01341036707162857, 0.016892235726118088, 0.02293207123875618, 0.026200203225016594, 0.02102910913527012, -0.08135852217674255, 0.007536005694419146, -0.009866444393992424, -0.007956587709486485, -0.02451787330210209, 0.003933477681130171, -0.01485137827694416, 0.03030949831008911, -0.015072011388838291, 0.03681818023324013, -0.004105847328901291, -0.02784116193652153, -0.01891930401325226, -0.02633809857070446, -0.0010436988668516278, 0.0122175682336092, 0.05808171257376671, -0.007198160979896784, 0.053062304854393005, 0.024766085669398308, -0.02625536173582077, -0.029371805489063263, 0.03899693116545677, -0.019594993442296982, -0.018615933135151863, 0.012445095926523209, -0.054165471345186234, 0.03543922305107117, -3.2723321055527776e-05, -9.878941636998206e-05, -0.019470887258648872, -0.004264427814632654, -0.0484565868973732, 0.006174284499138594, -0.01967773027718067, 0.017719611525535583, -0.021801326423883438, 0.0065638404339551926, -0.008597803302109241, 0.036790601909160614, -0.008818436414003372, -0.004809116013348103, 0.030088864266872406, -0.021442797034978867, -0.07865576446056366, 0.03505311161279678, 0.05485495179891586, 0.012693308293819427, -0.010935137048363686, -0.01773340068757534, -0.022021960467100143, -0.05808171257376671, 0.008783962577581406, -0.033701732754707336, 0.005836439784616232, -0.019732888787984848, 0.021484166383743286, -0.02264249138534069, 0.021939221769571304, -0.024283450096845627, 0.0440714992582798, -0.02236669883131981, -0.001085929456166923, -0.02784116193652153, 0.03392236679792404, -0.012472675181925297, -0.026917260140180588, -0.03028191812336445, -0.01867109164595604, 0.013631000183522701, 0.010742083191871643, -0.04145147651433945, -0.0327916219830513, 0.009163175709545612, 0.03210214152932167, 0.005109039600938559, 0.010031919926404953, -0.02455924265086651, 0.000589935458265245, 0.020711949095129967, 0.03441879153251648, 0.004409218207001686, 0.021442797034978867, 0.0021666877437382936, -0.01623033545911312, -0.02926148846745491, -0.02107047848403454, 0.01233477983623743, 0.008908068761229515, 0.051600608974695206, -0.007022343575954437, 0.005705439019948244, 0.011438457295298576, 0.03417057916522026, 0.006936158984899521, 0.0017943690763786435, 0.008404749445617199, 0.027413684874773026, 0.012831204570829868, -0.008494381792843342, 0.0022356356494128704, -0.002690691966563463, 0.0123209897428751, -0.026765575632452965, -0.0031595376785844564, -0.0025941648054867983, -0.009652705863118172, -0.008508170954883099, 0.009273492731153965, -0.009301071986556053, 0.024614401161670685, -0.043326862156391144, -0.05637180432677269, 0.04826353117823601, -0.046002041548490524, 0.035328906029462814, -0.021663431078195572, -0.031550560146570206, -0.04147905856370926, -0.003861082484945655, -0.012362359091639519, -0.044457606971263885, 0.01351378858089447, -0.024531662464141846, 0.009163175709545612, -0.006608656141906977, -0.02240806818008423, -0.021939221769571304, 0.033425942063331604, 0.04955974966287613, 0.043602652847766876, -0.004385086707770824, -0.03116445057094097, -0.04967006668448448, 0.05223492905497551, 0.046526044607162476, 0.041865166276693344, -0.08819815516471863, 0.012348568998277187, 0.0010187051957473159, -0.008542644791305065, -0.019388150423765182, -0.015926964581012726, -0.0039817411452531815, 0.041423898190259933, 0.07573237270116806, -0.0021666877437382936, 0.0027648108080029488, -0.021539324894547462, -0.0014884128468111157, 0.014327374286949635, 8.419185178354383e-05, 0.038528088480234146, -0.0076807960867881775, -0.0074187940917909145, -0.010252553038299084, 0.006487997714430094, -0.03375689312815666, 0.008087588474154472, -0.00959754828363657, 0.047408577054739, -0.005677859764546156, 0.02533145807683468, -0.01387921255081892, 0.02751021273434162, 0.03880387917160988, -0.053669046610593796, -0.0038197138346731663, 0.027096524834632874, -0.021125636994838715, -0.008370275609195232, -0.0407344214618206, 0.002447650535032153, -0.012465780600905418, 0.05664759501814842, 0.011321245692670345, 0.030668025836348534, -0.00894943717867136, -0.022821756079792976, -0.017181817442178726, -0.0203672107309103, 0.041534215211868286, 0.006739657372236252, 0.015361592173576355, -0.0033612102270126343, -0.01980183646082878, 0.0007898844196461141, 0.015858016908168793, 0.016506128013134003, -0.012762256897985935, -0.006608656141906977, 0.0020598184783011675, 0.026365676894783974, 0.0007209365139715374, 0.012224462814629078, 0.034997954964637756, 0.05256588011980057, 0.03745250031352043, -0.01282430998980999, -0.029399385675787926, -0.013431050814688206, -0.03381204977631569, -0.0006097580189816654, -0.01591317541897297, 0.037921346724033356, 0.02044994756579399, -0.00019833294209092855, 0.01053523924201727, -0.01566496305167675, 0.036459650844335556, -0.04691215232014656, 0.006463865749537945, -0.058909088373184204, -0.009928497485816479, 0.008997701108455658, 0.030530130490660667, 0.041782427579164505, -0.029895810410380363, -0.038941774517297745, -0.022215014323592186, -0.059240035712718964, -0.03030949831008911, 0.016244126483798027, 0.004226506222039461, -0.05126965790987015, 0.018533196300268173, -0.020518895238637924, -0.03417057916522026, 0.020836055278778076, 0.030585289001464844, -0.012286515906453133, -0.02950970269739628, -0.014727272093296051, 0.014113635756075382, 0.04214095696806908, 0.03538406267762184, -0.02320786379277706, 0.04112052917480469, 0.0029768256936222315, 0.008253064006567001, -0.0006886171759106219, -0.03097139671444893, 0.0021753062028437853, -0.02033963054418564, -0.017705820500850677, 0.026145044714212418, -0.027744635939598083, -0.03510827198624611, -0.03099897690117359, 0.04321654513478279, 0.001691809156909585, -0.006608656141906977, -0.02742747589945793, 0.09718896448612213, -0.02009141817688942, 0.022449437528848648, 0.002046029083430767, 0.04534013941884041, -0.003194011515006423, -0.06254953891038895, -0.036873336881399155, -0.01574769988656044, 0.04862206056714058, 0.003778344951570034, 0.02182890474796295, 0.03348110243678093, 0.027992848306894302, -0.03389478847384453, -0.016933605074882507, 0.002032239455729723, -0.009121807292103767, -0.03331562504172325, 0.0338396318256855, 0.03389478847384453, -0.053503572940826416, 0.03381204977631569, -0.020601632073521614, 0.0054365419782698154, 0.009390704333782196, 0.0716506615281105, 0.012755361385643482, -0.008459907956421375, 0.12245146930217743, 0.004812563303858042, 0.020312052220106125, -0.006219100672751665, -0.0006356134545058012, 0.013065626844763756, -0.023400917649269104, 0.02840653620660305, -0.016133809462189674, 0.0144652696326375, -0.0027751531451940536, 0.009632022120058537, -0.022614911198616028, -0.017540346831083298, -0.04691215232014656, -0.005919177550822496, -0.009604442864656448, -0.03461184725165367, 0.03888661786913872, -0.008439223282039165, -0.018560774624347687, 0.024448925629258156, -0.007049922831356525, 0.02909601479768753, -0.004953906871378422, -0.004626404028385878, -0.001965015195310116, 0.003699054941534996, 0.01016292069107294, -0.024724718183279037, 0.02690347097814083, -0.015527067705988884, 0.013568947091698647, -0.00813585240393877, 0.029151173308491707, -0.01656128652393818, -0.011672879569232464, -0.006822394672781229, -0.0002915203513111919, -0.002171858912333846, -0.0015539133455604315, 0.0041230847127735615, -0.13337281346321106, -0.014892746694386005, -0.02884780243039131, 0.03218488022685051, -0.02451787330210209, 0.004471271298825741, 0.009045965038239956, -0.05466189607977867, 0.0014935838989913464, -0.0035715012345463037, -0.03149539977312088, -0.040486209094524384, -0.009969866834580898, -0.0012246870901435614, -0.011148875579237938, 0.026600100100040436, 0.016506128013134003, 0.01919509656727314, 0.006536261178553104, 0.031633298844099045, -0.01185214426368475, -0.015637384727597237, 0.040072519332170486, 0.022187434136867523, -0.056592438369989395, 0.039548516273498535, -0.028185902163386345, -0.006008809432387352, 0.020477525889873505, 0.023400917649269104, -0.022449437528848648, -0.03428089618682861, 0.00029259765869937837, 0.021842695772647858, 0.0024717822670936584, -0.022228803485631943, 0.00801174622029066, -0.009618232026696205, 0.00490909069776535, 0.0033284600358456373, 0.03844534978270531, 0.014520428143441677, 0.04564351215958595, -0.01195556577295065, 0.0014229123480618, 0.05121450126171112, 0.02735852636396885, 0.0062742591835558414, -0.04012767970561981, 0.012872572988271713, 0.02345607616007328, 0.008515065535902977, -0.020050048828125, -0.01497548446059227, -0.057364653795957565, -0.004140321630984545, -0.010321500711143017, -0.03985188528895378, -0.0004179966636002064, 0.030695606023073196, 0.0220357496291399, -0.022918282076716423, -0.020201735198497772, 0.03331562504172325, 0.0019994890317320824, -0.019457098096609116, 0.00652247155085206, -0.0357150137424469, 0.008163431659340858, 0.003909346181899309, -0.026145044714212418, -0.05438610538840294, -0.009632022120058537, 0.02232533134520054, 0.00669484119862318, -0.010680030100047588, -0.0071016340516507626, -0.002670007525011897, 0.0303922351449728, -0.02909601479768753, 0.01400331873446703, 0.019994892179965973, -0.005184882320463657, -0.034391213208436966, 0.028765063732862473, -0.013762000948190689, -0.033343203365802765, -0.02255975268781185, -0.00376455532386899, -0.01174872275441885, -0.0121141467243433, 0.04098263382911682, -0.03607354313135147, 0.000903217529412359, -0.0008148780325427651, 0.0005201257299631834, -0.0070878444239497185, 0.022435646504163742, -0.012982890009880066, -0.0189055148512125, -0.003516342956572771, -0.02950970269739628, -0.016216546297073364, -0.041010212153196335, -0.019691521301865578, 0.01587180607020855, 0.011093717068433762, -0.010645556263625622, 0.025662409141659737, -0.023304389789700508, -0.00048091160715557635, 0.0025993359740823507, -0.030502552166581154, 0.023387128487229347, 0.019622573629021645, -0.007467057555913925, -0.04525740072131157, 0.03315015137195587, 0.010597292333841324, -0.007853166200220585, -0.02268385887145996, -0.01647854782640934, -0.023235442116856575, -0.02604851685464382, -0.02345607616007328, 0.024090396240353584, 0.01664402335882187, 0.010811030864715576, -0.03855566680431366, -0.02633809857070446, -0.03615627810359001, -0.015347803011536598, 0.01101787481456995, -0.05741981044411659, 0.0028010085225105286, -0.028434114530682564, 0.0025579670909792185, 0.015582225285470486, 0.045919302850961685, -0.009790602140128613, 0.0237042885273695, -0.014299795031547546, -0.005243488121777773, -0.0076807960867881775, -0.008053114637732506, 0.008797752670943737, -0.004164453130215406, 0.0007437755120918155, 0.021925432607531548, -0.004333375487476587, -0.04010009765625, -0.0007985028787516057, -0.0026941392570734024, -0.059515830129384995, 0.01170735340565443, -0.054358527064323425, -0.03193666785955429, 0.007901429198682308, 0.017071500420570374, 0.041865166276693344, 0.024697137996554375, 0.024131765589118004, 0.029482122510671616, 0.016616445034742355, -0.029757915064692497, -0.0010480080964043736, -0.005384831223636866, 0.02393871173262596, 0.01578906923532486, -0.006236337590962648, 0.06194279342889786, -0.0098181813955307, -0.0465812012553215, -0.02393871173262596, 0.008149641565978527, 0.0019374360563233495, -0.030612867325544357, -0.025345249101519585, -0.025221142917871475, -0.014037792570888996, -0.004288559313863516, 0.040486209094524384, -0.018850356340408325, 0.003280196338891983, -0.007735954597592354, -0.037811029702425, 0.00405758386477828, 0.0042816647328436375, 0.0018219483317807317, 0.015292644500732422, -0.015623594634234905, 0.006360443774610758, -0.03982430696487427, -0.022352909669280052, 0.008046220056712627, -0.023400917649269104, -0.007029238622635603, -0.00296820723451674, -0.0060915471985936165, 0.007239529862999916, 0.025152195245027542, -0.039796728640794754, 0.002573480363935232, 0.015982123091816902, 0.02642083540558815, 0.011555667966604233, -0.015982123091816902, -0.0346670038998127, 0.014217057265341282, -0.01052834466099739, 0.0018650407437235117, -0.02431103028357029, -0.02556588128209114, 0.014299795031547546, 0.010935137048363686, -0.060122568160295486, 0.020808476954698563, -0.018229825422167778, -0.015720121562480927, 0.006763789337128401, 0.028902960941195488, 0.005464121233671904, -0.0011678050504997373, -0.015361592173576355, 0.013555156998336315, -0.0020994634833186865, 0.0013315563555806875, 0.025703778490424156, -0.003190564224496484, 0.021167006343603134, -0.00256658555008471, -0.0006257022032514215, -0.00742568913847208, -0.014148109592497349, 0.017016341909766197, -0.019498465582728386, -0.023511234670877457, 0.007818692363798618, 0.02821348048746586, -0.016947394236922264, -0.024903982877731323, 0.015596015378832817, 0.03019918128848076, 0.023263022303581238, 0.003219866892322898, 0.008177220821380615, -0.014396321959793568, 0.03224003687500954, -0.02118079550564289, -0.014685902744531631, -0.037066392600536346, -0.010087077505886555, 0.03168845549225807, -0.012479569762945175, -0.018891725689172745, 0.001731454161927104, 0.007667006459087133, -0.02032584138214588, -0.004726378712803125, -0.02366291917860508, 0.02255975268781185, -0.00907354336231947, -0.03414300084114075, -0.01591317541897297, -0.004267875105142593, -0.027468843385577202, 0.021456586197018623, 0.007156792096793652, 0.03229519724845886, -0.016133809462189674, -0.1453973352909088, -0.03157813847064972, 0.020918793976306915, 0.004061031620949507, -0.013382787816226482, -0.016588864848017693, 0.012810519896447659, 0.03337078541517258, -0.021539324894547462, -0.0057950709015131, -0.012024514377117157, -0.04605719819664955, -0.017361082136631012, 0.0016288941260427237, 0.0011031663743779063, -0.0361286997795105, 0.0006011395016685128, -0.03767313435673714, 0.01992594264447689, -0.008590908721089363, 0.015347803011536598, -0.01400331873446703, -0.0021959906443953514, -0.004167900420725346, -0.00968028511852026, -0.023924922570586205, -0.0069465008564293385, 0.0367630198597908, -0.006943053565919399, 0.034722164273262024, -0.005836439784616232, -0.013713737949728966, 0.02232533134520054, 0.0207808967679739, -0.02711031399667263, -0.03055771067738533, -0.017967823892831802, -0.030447393655776978, -0.01245888601988554, 0.001096271676942706, 0.0234974455088377, -0.03356383740901947, 0.006384575739502907, -0.008715014904737473, 0.012838099151849747, 0.004412665497511625, 0.015471909195184708, 0.007432583719491959, 0.0027372317854315042, -0.023221652954816818, -0.007177476305514574, -0.005657175090163946, -0.003519790479913354, -0.025883041322231293, -0.027137894183397293, 0.014382531866431236, -0.0012160686310380697, -0.010617977008223534, -0.03623901680111885, 0.011941776610910892, -0.010569713078439236, 0.016533706337213516, -0.0012539899908006191, -0.01377579104155302, -0.010280132293701172, -0.0363493338227272, 0.006729315035045147, -0.004485060926526785, -0.014382531866431236, -0.02240806818008423, -0.010107762180268764, 0.03210214152932167, 0.001401366083882749, 0.00581230828538537, -0.01329315546900034, 0.0415617935359478, 0.028599590063095093, 0.024931561201810837, -0.0430234894156456, 0.03891419619321823, 0.030916238203644753, -0.0396864116191864, 0.01410674024373293, -0.0024648874532431364, 0.02617262303829193, 0.03557711839675903, 0.02788253128528595, 0.004240295849740505, -0.032653726637363434, 0.02540040761232376, 0.047546472400426865, -0.017057711258530617, 0.0060674152337014675, 0.015513277612626553, -0.038252294063568115, -0.02642083540558815, 0.013472420163452625, 0.014079161919653416, -0.008315117098391056, -0.02021552436053753, 0.028268638998270035, 0.025510722771286964, -0.04492645338177681, -0.042830437421798706, 0.002502808813005686, 0.03030949831008911, -0.007329161744564772, -0.025138404220342636, -0.0010307711781933904, 0.00026092471671290696, 0.04026557505130768, 0.03290193900465965, -0.0006119126337580383, 0.008852910250425339, -0.007860060781240463, 0.04520224407315254, 0.027137894183397293, -0.0030371551401913166, 0.03141266480088234, 0.01606486178934574, 0.023511234670877457, -0.0077842180617153645, -0.013458630070090294, 0.0025390065275132656, -0.030337076634168625, 0.00376455532386899, 0.024890191853046417, 0.00508490763604641, -0.011266087181866169, -0.021015319973230362, -0.006443181540817022, 0.022945862263441086, -0.02581409364938736, 0.014865167438983917, 0.015292644500732422, -0.019981101155281067, 0.01209346204996109, 0.020546475425362587, -0.02779979445040226, 0.029123593121767044, 0.002373531460762024, 0.002042581560090184, 0.06221858784556389, -0.025317668914794922, -0.019388150423765182, -0.008204800076782703, 0.015637384727597237, -0.016175176948308945, -0.01618896797299385, 0.01846424862742424, 0.009156281128525734, -0.017471397295594215, -0.024490294978022575, -0.011886618100106716, 0.01675434038043022, 0.01944330893456936, 0.01505822129547596, -0.018602143973112106, 0.015003063715994358, -0.009383809752762318, -0.026875892654061317, 0.00799795612692833, -0.03152298182249069, -0.032929517328739166, 0.014906535856425762, -0.011231613345444202, 0.0016280323034152389, -0.0039955307729542255, -0.0018012638902291656, 0.005629596300423145, -0.03417057916522026, -0.058909088373184204, 0.037728291004896164, 0.004081715829670429, 0.020670581609010696, 0.02608988620340824, 0.022835545241832733, -0.0065259188413619995, 0.01988457515835762, 0.05422062799334526, -0.022270172834396362, 0.0022201223764568567, -0.00647420808672905, 0.03218488022685051, 0.033177729696035385, -0.030750764533877373, 0.01603728160262108, 0.020463736727833748, 0.003437052946537733, 0.024697137996554375, 0.01781613752245903, 0.05449642241001129, 0.005364146549254656, 0.02159448340535164, 0.013582736253738403, -0.032322775572538376, 0.03615627810359001, 0.04305107146501541, 0.00737742567434907, -0.014396321959793568, -0.05791623890399933, 0.036790601909160614, -0.0027579159941524267, 0.0007480847416445613, -0.01223825290799141, 0.034198157489299774, 1.2335210158198606e-05, 0.01810571923851967, -0.01097650546580553, 0.04045862704515457, 0.009838865138590336, 0.015292644500732422, -0.03130234777927399, -0.009018385782837868, -0.0068258424289524555, -0.006715525407344103, -0.0014005042612552643, 0.026931051164865494, -0.003293985966593027, -0.040237996727228165, -0.03888661786913872, -0.003961056936532259, -0.011576352640986443, -0.019208885729312897, 0.00850127637386322, 0.022380487993359566, 0.025827884674072266, 0.007653216831386089, -0.021815115585923195, 0.011397087946534157, 0.002247701631858945, 0.00023722386686131358, 0.021167006343603134, -0.00882533099502325, 0.004247190896421671, -0.017705820500850677, 0.008356485515832901, 0.01988457515835762, -0.019622573629021645, 0.024007659405469894, 0.04787742346525192, -0.017581714317202568, -0.010052603669464588, -0.0013522406807169318, -0.028075585141777992, -0.03262614831328392, -0.002825140254572034, 0.06425944715738297, -0.03177119418978691, 0.0031767745967954397, -0.0060915471985936165, -0.0002811781596392393, 0.05212461203336716, -0.022656280547380447, 0.029840651899576187, -0.004585035610944033, 0.008556434884667397, 0.05162818729877472, 0.03168845549225807, 0.03381204977631569, -0.013334523886442184, 0.022711439058184624, -0.005646833218634129, -0.007080949377268553, -0.028461692854762077, -0.004516087472438812, -0.03841777145862579, -0.00471948366612196, 0.02475229650735855, -0.017223184928297997, -0.01976046897470951, 0.02122216485440731, -0.0053331200033426285, 0.01948467642068863, -0.011059243232011795, -0.0205740537494421, 0.0090873334556818, -0.03339836373925209, 0.00837717019021511, -0.013141470029950142, -0.02970275655388832, 0.004974591080099344, 0.022435646504163742, -0.012755361385643482, 0.0030888658948242664, -0.03433605656027794, -0.007591163739562035, 0.009287281893193722, 0.004247190896421671, -0.007080949377268553, 0.030833501368761063, 0.023607760667800903, 0.000255322695011273, -0.023855973035097122, -0.012307200580835342, 0.012369253672659397, 0.02487640269100666, -0.008597803302109241, 0.031798772513866425, 0.0031457480508834124, 0.010404238477349281, 0.024986719712615013, 0.030530130490660667, -0.05524105951189995, 0.013003573752939701, 0.028985697776079178, 0.023800816386938095, -0.05940551310777664, -0.0332053080201149, -0.006849973928183317, 0.008370275609195232, 0.04622267186641693, -0.0044540343806147575, 0.00025058252504095435, 0.007963482290506363, -0.004726378712803125, -0.02759294956922531, -0.014051582664251328, -0.007122318260371685, -0.016382021829485893, -0.004712589085102081, -0.016740551218390465, 0.011100612580776215, -0.014044687151908875, -0.0091907549649477, 0.0033508678898215294, -0.014327374286949635, -0.011755617335438728, -0.0041230847127735615, 0.008060009218752384, 0.016051070764660835, -0.0025855463463813066, 0.008301327005028725, 0.015072011388838291, -0.009866444393992424, -0.00752911064773798, -0.03640449047088623, 0.01398263406008482, -0.0024459268897771835, -0.025234932079911232, 0.0222425926476717, 0.01992594264447689, -0.021746167913079262, 0.0034611846785992384, 0.00206498964689672, 0.04054136574268341, -0.0008601250592619181, -0.018091930076479912, -0.00034603229141794145, -0.018436668440699577, 0.07176097482442856, -0.03028191812336445, -0.03177119418978691, 0.015072011388838291, 0.0026079544331878424, 0.03210214152932167, 0.028116954490542412, -0.02884780243039131, -0.01810571923851967, 0.0015401237178593874, 0.009101122617721558, 0.016368232667446136, -0.001304839039221406, -0.008680541068315506, 0.008073799312114716, -0.02053268440067768, -0.01691981591284275, 0.01518232747912407, 0.006808605045080185, 0.03259856626391411, 0.03599080443382263, 0.03461184725165367, -0.007225740235298872, 0.008039325475692749, -0.014768640510737896, 0.009404493495821953, -0.007453267928212881, 0.012741572223603725, 0.012486465275287628, 0.037811029702425, -0.0009135596919804811, 0.0012962205801159143, -0.05121450126171112, 0.022008169442415237, -0.014037792570888996, 0.005602017045021057, -0.007191265933215618, 0.03036465495824814, -0.01773340068757534, -0.02593819983303547, -0.017361082136631012, 0.01806434988975525, 0.016340652480721474, 0.010700713843107224, -0.01948467642068863, 0.018409090116620064, 0.02995096892118454, -0.00048435901408083737, 0.016933605074882507, -0.02608988620340824, 0.021304901689291, -0.017071500420570374, 0.012527833692729473, 0.0013798198197036982, 0.02082226611673832, -0.017057711258530617, -0.0039955307729542255, 0.03284677863121033, 0.008101378567516804, 0.0003986050433013588, -0.045395299792289734, -0.014134319499135017, 9.846621833276004e-05, -0.01806434988975525, -0.02529009059071541, -0.05019407346844673, -0.017112869769334793, 0.007384320255368948, -0.031798772513866425, 0.014396321959793568, -0.014658323489129543, -0.010811030864715576, -0.0069602904841303825, -0.008170326240360737, 0.00742568913847208, 0.013989529572427273, 0.028351377695798874, -0.01028702687472105, 0.025579672306776047, 0.02679315395653248, 0.001441011088900268, -0.014451480470597744, -0.04564351215958595, 0.0016771577065810561, 0.006436286494135857, 0.004853932186961174, 0.0342533178627491, 0.0038507403805851936, -0.01802298054099083, 0.02491777203977108, 0.022297751158475876, 0.005757149774581194, 0.024255871772766113, 0.020063839852809906, -0.01583043858408928, -0.007880745455622673, 0.01675434038043022, -0.010700713843107224, 0.01919509656727314, -0.022504594177007675, 0.010438712313771248, -0.005839887075126171, -0.030530130490660667, 0.011217823252081871, -0.03546680137515068, -0.002183924661949277, -0.04550561308860779, -0.0008493519853800535, -0.019981101155281067, 0.027689477428793907, 0.01773340068757534, -0.002032239455729723, 0.00935623049736023, 0.014148109592497349, 0.002904430264607072, -0.004136873874813318, 0.009135597385466099, 0.025965780019760132, 0.023525023832917213, -0.011459141038358212, 0.017788559198379517, 0.025593461468815804, 0.049201223999261856, -0.0015004787128418684, -0.010542133823037148, 0.007191265933215618, -0.027868742123246193, -0.00633286451920867, 0.019374359399080276, -0.017071500420570374, -0.033701732754707336, -0.0016159664373844862, -0.010114656761288643, 0.025110825896263123, 0.01339657697826624, 0.006294943392276764, 0.003961056936532259, -0.009342440403997898, -0.008790857158601284, -0.011528088711202145, 0.021608272567391396, 0.04765678942203522, -0.015030642040073872, 0.01875382848083973, 0.003950714599341154, 0.016175176948308945, -0.0012324437266215682, -0.002433860907331109, 0.011838355101644993, -0.0026855207979679108, 0.00013067781401332468, -0.021125636994838715, 0.022449437528848648, 0.027179263532161713, -0.029454544186592102, 0.011845249682664871, 0.004174795467406511, 0.010659345425665379, 0.009521705098450184, -0.0006114817224442959, 0.002745850244536996, -0.005415857769548893, -0.006860316265374422, 0.03201940655708313, 0.03753523901104927, -0.008066904731094837, -0.010935137048363686, -0.001634065294638276, 0.02800663746893406, -0.003881766926497221, 0.015044432133436203, -0.013486209325492382, 0.0021494508255273104, -0.0024028343614190817, -0.029978547245264053, -0.02917875163257122, -0.03538406267762184, 0.03193666785955429, -0.003771450137719512, 0.0014746232191100717, -0.0008433189941570163, -0.027413684874773026, 0.04346475750207901, -0.013134575448930264, -0.03088865987956524, -0.018050560727715492, -0.005929519422352314, 0.002158069284632802, 0.0015142683405429125, 0.006463865749537945, 0.011210928671061993, -0.026034727692604065, -0.012265831232070923, -0.009011490270495415, 0.002383873797953129, 0.019015831872820854, -0.013017363846302032, 0.03458426892757416, 0.022863123565912247, 0.014534217305481434, 0.014878957532346249, -0.022614911198616028, 0.046332988888025284, 0.008983911946415901, -0.020477525889873505, 0.036183860152959824, -0.015623594634234905, 0.013575841672718525, -0.006636235397309065, -0.013555156998336315, 0.031192030757665634, 0.002702757716178894, 0.019622573629021645, 0.05769560486078262, 0.016133809462189674, -0.015844227746129036, 0.01683707721531391, 0.004915985278785229, -0.02159448340535164, -0.010493870824575424, -0.02247701585292816, 0.006191521417349577, 0.011583247222006321, 0.021663431078195572, -0.025234932079911232, 0.02329060062766075, 0.029757915064692497, -0.005832992494106293, 0.0028079033363610506, 0.038528088480234146, -0.012472675181925297, -0.013362103141844273, -0.011397087946534157, 0.011210928671061993, 0.01185214426368475, 0.0058157555758953094, -3.350436963955872e-05, -0.005219356156885624, -0.001563393627293408, -0.0011927987216040492, -0.048070475459098816, 0.029454544186592102, 0.010093973018229008, 0.030916238203644753, -0.018808986991643906, 0.05912971869111061, 0.009383809752762318, -0.0016590588493272662, -0.02666904777288437, 0.012224462814629078, 0.009569969028234482, 0.006143257953226566, -0.0001673063961789012, -0.018560774624347687, -0.00789453461766243, -0.059350352734327316, -0.007274003699421883, -0.008921858854591846, -0.018202245235443115, 0.0027665344532579184, 0.002225293545052409, 0.012424412183463573, -0.006618998479098082, 0.014823799021542072, -0.0077980076894164085, 0.02942696399986744, -0.028434114530682564, 0.009121807292103767, -0.012776046060025692, 0.0026803496293723583, -0.011190243996679783, -0.010397343896329403, -0.032570987939834595, -0.01760929450392723, 0.02848927304148674, 0.032488252967596054, 0.010328395292162895, -0.01879519782960415, -0.0023976631928235292, 0.0015418474795296788, 0.04749131575226784, 0.007446373347193003, -0.00659486697986722, -0.029537281021475792, 0.03367415443062782, 0.008797752670943737, -0.01341036707162857, 0.0038955563213676214, -0.011714247986674309, -0.011059243232011795, -0.022435646504163742, 0.011438457295298576, 0.015678752213716507, -0.020877424627542496, 0.005157303065061569, 0.02796526812016964, 0.006439733784645796, 0.01402400340884924, 0.0037369763012975454, 0.01660265401005745, 0.009956076741218567, -0.012596781365573406, 0.007708375342190266, 0.004922880325466394, 0.018726250156760216, 0.03690091520547867, -0.018078139051795006, 0.04313380643725395, -0.005781281739473343, 0.001462557353079319, 0.00011290219117654487, 0.025179773569107056, -0.006260469555854797, 0.008839121088385582, 0.010480080731213093, 0.027524001896381378, -0.009714758954942226, 0.025510722771286964, -0.013706842437386513, 0.029040856286883354, -0.019581204280257225, 0.010156026110053062, -0.027537791058421135, 0.01458937581628561, 0.035852909088134766, 0.008342696353793144, -0.016409600153565407, -0.001681466936133802, 0.015858016908168793, -0.010852399282157421, 0.02126353234052658, -0.007460162974894047, 0.03185392916202545, 0.023759447038173676, 0.01067313551902771, -0.00828064326196909, -0.018533196300268173, -0.009935392998158932, 0.020077629014849663, -0.0342533178627491, -0.020436158403754234, 0.014451480470597744, -0.008094483986496925, 0.009480336681008339, -0.02107047848403454, -0.0013884383952245116, -0.03221245855093002, 0.02126353234052658, -0.012121041305363178, 0.009838865138590336, 0.053145043551921844, 0.0014280834002420306, 0.04208580031991005, 0.0035473695024847984, 0.014203268103301525, 0.008459907956421375, 0.017223184928297997, -0.011576352640986443, -0.039024513214826584, -0.006608656141906977, -0.02500050887465477, -0.019222674891352654, 0.024931561201810837, 0.017623083665966988, 0.012031408958137035, 0.01967773027718067, -0.007411899510771036, -0.015471909195184708, 0.008701224811375141, 0.022090908139944077, -0.022504594177007675, 0.009880234487354755, 0.010721398517489433, -0.010735188610851765, -0.0057364655658602715, 0.012169304303824902, -0.0071016340516507626, -0.023318180814385414, 0.011424667201936245, -0.004354060161858797, 0.016974972561001778, -0.01398263406008482, 0.0001937005145009607, -0.019098568707704544, -0.020684370771050453, 0.015458119101822376, -0.0121141467243433, 0.0024217949248850346, -0.0113832987844944]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" of the generated
JSON responses, considering both the validity of the JSON
format and the accuracy of the final response. We also mea-
sure perplexity of the generated output and the overhead
over unconstrained generation in terms of throughput.
Results As documented in Table 2, DOMINO achieves the
best accuracy for all tasks, while also improving through-
put well beyond unconstrained generation. In all cases,
DOMINO ’s accuracy is the same or improved compared to
unconstrained generation, indicating very low or no inva-
siveness. In contrast, with standard GUIDANCE , we observe
clear artifacts of invasiveness, as accuracy drops by up to
11% points compared to unconstrained generation. And,
while GUIDANCE ’s inference optimizations do increase
throughput (up to 2.02×),DOMINO accellerates inference
even further (up to 2.71×), while also maintaining high ac-
curacy. Implementing minimally invasive GUIDANCEWS
programs with flexible whitespace and formatting restores
some accuracy, but not fully, and also lowers throughput
significantly to ∼0.8×.LLAMA .CPP’s online parsing ap-
proach also does not appear to be fully non-invasive, al-
though accuracy seems less impaired, while throughput is
also consistently reduced to ∼0.8×.
4.2. Parameter Study
Next, we investigate the key parameters of D OMINO .
Lookahead To experiment with lookahead parameter k,
we evaluate on GSM8K as before, but varying k. We reportTable 4. GSM8K task accuracy with different lookahead k.
Configuration Mistral 7B Llama-2 13B
Unconstrained 0.415 0.155
DOMINO (k= 0) 0.308 0.0
DOMINO (k= 1) 0.1 0.036
DOMINO (k=∞)0.418 0.157
the results in Table 4. We observe that lower kvalues impair
performance significantly. Manual inspection shows that
depending on k, the model is forced into different whitespac-
ing behavior, as bridge tokens like },are unavailable, lead-
ing to irregularities. This can affect reasoning, e.g. Llama-2
is unable to produce object lists of length greater than 1, if
relevant bridge tokens are missing. DOMINO withk=∞,
however, recovers and even slightly exceeds unconstrained
accuracy, demonstrating minimal invasiveness.
Speculation and Opportunistic Masking We also exper-
iment with the number of speculative tokens swe propose
at each decoding step, to speed up generation. For this,
we compare the generation of schema-driven JSON and
free-form JSON text with Mistral 7B . We form priors on
10 randoms samples, and then measure mean performance
across 100generated outputs per configuration, without
updating counts. We report the results in Fig. 5.
We find speculative decoding with s∈ {6,8,10}to be
particularly effective for schema-driven JSON generation, as
it achieves a throughput of 1.7x compared to unconstrained
8
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
0 2 4 6 8 10
Number of Speculative Sokens0102030405060JSON (With Schema) [tok/s]
speculative
unconstrained
opportunistic
0 2 4 6 8 10
Number of Speculative Tokens0102030405060JSON (No Schema) [tok/s]
Figure 5. Impact of the number of speculative tokens kon through-
put (tokens per second) with Mistral 7B and JSON generation with
and without schema, using D OMINO withtransformers LLMs.
generation. On free-form JSON output, speculation is not
effective, and DOMINO opportunistic masking is preferable,
incurring only a low 4.21% overhead.
4.3. Efficiency
Next, we examine throughput and efficiency of DOMINO .
For this, we compare unconstrained generation thrrough-
put of each backend, and report the relative differences
when running with constrained generation. We do not in-
clude DOMINO ’s precomputation time as part of the reported
throughputs. We note that for the tested grammars, it ranges
from 1-5s, with C being an outlier at around 20s.
Grammars We compare different constraining tasks, as
shown in Table 3. For each task, we prepare a small set of
relatively general inputs, prompting the model to generate a
response in the general distribution of the given output for-
mat (details in App.","[0.030445201322436333, 0.045814044773578644, 0.08572517335414886, 0.008615061640739441, 0.019769437611103058, 0.014677511528134346, 0.009412752464413643, 0.0032190149649977684, 0.0034766027238219976, 0.02564576081931591, 0.028052128851413727, 0.018160762265324593, -0.0039984253235161304, -0.01035668607801199, 0.014159012585878372, -0.013088777661323547, -0.007046269252896309, -0.015102947130799294, 0.013328084722161293, 0.037066034972667694, 0.03951228782534599, -0.011067960411310196, 0.00575334532186389, 0.023890841752290726, -0.00927980337291956, -0.01013067364692688, -0.009625469334423542, 0.0463724285364151, 0.04969613999128342, -0.03573654964566231, 0.012517099268734455, -0.04094813019037247, -0.009711885824799538, -0.03898049145936966, 0.03158855810761452, 0.04639901965856552, 0.030737686902284622, 0.0059494441375136375, -0.011626344174146652, -4.8765086830826476e-05, -0.005683547351509333, -0.05647651106119156, -0.031694915145635605, -0.03741170093417168, 0.030471790581941605, 0.03379550203680992, -0.0127564063295722, 0.020540539175271988, -0.004270969890058041, 0.023850956931710243, -0.04948342218995094, 0.05299326404929161, 0.002559258136898279, -0.036454472690820694, -0.0256324652582407, -0.04238397255539894, -0.012171433307230473, 0.009765065275132656, 0.01982261799275875, -0.0025426396168768406, 0.01075553148984909, -0.062432605773210526, 0.05115857347846031, 0.03025907278060913, 0.0005916206864640117, 0.011141082271933556, -0.01175264548510313, -0.01366710290312767, -0.0036959676072001457, -8.594911196269095e-05, -0.017775211483240128, 0.025991426780819893, 0.03313076123595238, -0.04498976469039917, -0.003110994352027774, 0.016844572499394417, 0.051052212715148926, 0.008335869759321213, -0.01627289317548275, -0.02596483752131462, 0.003579637734219432, -0.011938773095607758, 0.026297207921743393, -0.026908772066235542, 0.018160762265324593, -0.020540539175271988, 0.009200034663081169, -0.02611108124256134, -0.05315279960632324, -0.01596711203455925, -0.03773077577352524, -0.01689775101840496, -0.017575789242982864, 0.012031837366521358, 0.02978045865893364, -0.030205894261598587, 0.01366710290312767, -0.02179025486111641, 0.03666719049215317, 0.03653424233198166, 0.028610512614250183, -0.029142305254936218, 0.02028793655335903, -0.011859004385769367, 0.03717239201068878, 0.02289372682571411, -0.009558995254337788, -0.003275518072769046, -0.016817981377243996, -0.005434269085526466, -0.049988627433776855, -0.041533105075359344, -0.06418752670288086, -0.006148866843432188, 0.028052128851413727, -0.036029037088155746, -0.06721875071525574, 0.015102947130799294, -0.0033220499753952026, -0.045814044773578644, -0.016857866197824478, -0.018054403364658356, 0.0038521820679306984, 0.014730690978467464, -0.007750896271318197, 0.027254438027739525, 0.02071337215602398, -0.01326825749129057, 0.03642788156867027, -0.009007259272038937, 0.017429545521736145, 0.024329571053385735, 0.03882095590233803, -0.004816058557480574, -0.03009953536093235, 0.03573654964566231, -0.040469516068696976, -0.007325461134314537, -0.006866788957268, 0.012350913137197495, -0.02548622339963913, -0.034167759120464325, -0.003180792322382331, 0.05759327858686447, -0.05020134523510933, -0.0013161898823454976, -0.021138807758688927, 0.03225329890847206, -0.04655855521559715, 0.03972500562667847, 0.010988191701471806, -0.03164173662662506, -0.06280486285686493, -0.010177205316722393, 0.014690806157886982, -0.05924183875322342, -0.062645323574543, 0.021125512197613716, 0.011885593645274639, 0.001573777524754405, -0.001184072345495224, 0.021909909322857857, 0.02008851431310177, -0.01918446458876133, 0.019463656470179558, 0.03212035074830055, -0.015023177489638329, 0.04206489771604538, -0.08583153784275055, -0.0253266841173172, 0.03238624706864357, -0.03735852241516113, -0.028291435912251472, -0.03626834228634834, -0.019437067210674286, -0.022295460104942322, -0.06615515798330307, -0.01947695203125477, 0.023531880229711533, -0.03427411615848541, -0.01368039846420288, 0.05070654675364494, -0.03472614288330078, 0.000300588202662766, -0.0380498543381691, -0.02179025486111641, -0.05142446979880333, 0.004231085069477558, 0.021298345178365707, 0.03765100985765457, 0.01035668607801199, 0.031721506267786026, 0.056263793259859085, 0.033715732395648956, 0.044457968324422836, -0.04347415268421173, 0.04871232062578201, 0.024595467373728752, -0.037996675819158554, 0.013773461803793907, 0.03382209315896034, 0.01298241876065731, 0.03834234178066254, -0.07955636829137802, 0.0208596158772707, 0.008495407178997993, 0.018626080825924873, -0.03698626533150673, 0.016525495797395706, 0.00032925521372817457, 0.019596604630351067, -0.00927980337291956, 0.035257935523986816, -0.017150353640317917, -0.016658443957567215, -0.02305326610803604, -0.03773077577352524, 0.023890841752290726, 0.008315927349030972, 0.03424752876162529, -0.006507827900350094, 0.0457608662545681, 0.006321699824184179, -0.0018164085922762752, -0.006561007350683212, 0.04403253644704819, -0.009731828235089779, -0.038475289940834045, 0.021285051479935646, -0.05033429339528084, 0.053525056689977646, 0.010742236860096455, -0.008276042528450489, -0.014371730387210846, -0.011287325993180275, -0.056742407381534576, -0.006394821684807539, -0.02121857739984989, -0.0015638064360246062, -0.011486748233437538, 0.010243680328130722, -0.015528381802141666, 0.020965974777936935, -0.015501792542636395, -0.017722031101584435, 0.03257237747311592, -0.03547065332531929, -0.04113425686955452, 0.009864776395261288, 0.03166832774877548, 0.006221988704055548, -0.03485909104347229, -0.007232396863400936, -0.023983905091881752, -0.0537111833691597, -0.005470829550176859, -0.047834862023591995, 0.033715732395648956, 0.008581823669373989, 0.07205807417631149, -0.007245691958814859, -0.0001204845539177768, -0.03435388579964638, 0.0282648466527462, -0.023119740188121796, 0.011287325993180275, -0.01351421233266592, 0.035098396241664886, -0.004586722236126661, -0.037066034972667694, -0.02334575168788433, -0.022681009024381638, -0.017163647338747978, 0.007265634369105101, -0.042144667357206345, -0.03581631928682327, 0.015368843451142311, 0.028185077011585236, -0.033077578991651535, -0.0017615673132240772, 0.010250327177345753, -0.014704101718962193, 0.03855505958199501, 0.01949024572968483, 0.010928364470601082, 0.017602378502488136, 0.014557857997715473, -0.0014524620492011309, 0.0005791567964479327, -0.02641686238348484, 0.0028783343732357025, 0.027440564706921577, 0.03980477526783943, -0.0008317588944919407, -0.009479226544499397, -0.02488795481622219, 0.02427639067173004, -0.0069930898025631905, 0.004470392595976591, 0.00784396007657051, 0.05514702573418617, 0.013946294784545898, 0.02454228885471821, -0.0050886026583611965, 0.004945683293044567, 0.013933000154793262, -0.007026326842606068, -0.033396657556295395, 0.002431295346468687, 0.004799440037459135, -0.010017667897045612, 0.00959888007491827, -0.027892589569091797, 0.018533017486333847, -0.021697191521525383, -0.04849960282444954, 0.06971818208694458, -0.030657919123768806, 0.06248578429222107, 0.004001749213784933, -0.04732965677976608, -0.051956262439489365, -0.0023448786232620478, -0.016179829835891724, -0.030604738742113113, -0.012683284468948841, -0.02749374508857727, 0.029700689017772675, -0.004008396528661251, -0.05477477237582207, -0.04150651395320892, 0.014677511528134346, 0.06062450632452965, 0.041214026510715485, -0.040602464228868484, -0.032785095274448395, -0.017748622223734856, 0.04163946211338043, 0.025685645639896393, 0.036321524530649185, -0.09083040058612823, 0.01304224506020546, 0.0071459803730249405, -0.03914003074169159, -0.017097173258662224, -0.0213515255600214, -0.007046269252896309, 0.03961864486336708, 0.0679100826382637, -0.008149741217494011, 0.03395504131913185, -0.019104696810245514, 0.009273156523704529, -0.002298346720635891, 0.010795416310429573, 0.047542374581098557, -0.009239919483661652, -0.005776611156761646, -0.01583416387438774, -0.006637452635914087, -0.005776611156761646, 0.040150441229343414, -0.011932125315070152, 0.05769963935017586, 0.005969386547803879, 0.015368843451142311, -0.02565905638039112, 0.0359758585691452, 0.010861890390515327, -0.04501635208725929, -0.005387736950069666, 0.03222671151161194, -0.02762669324874878, -0.015275780111551285, -0.0208596158772707, 0.0030827426817268133, -0.02424980141222477, 0.048605963587760925, 0.00759800523519516, 0.03424752876162529, 0.005204932764172554, -0.026496632024645805, -0.01568792015314102, -0.01366710290312767, 0.024063674733042717, 0.0012970785610377789, 0.034460246562957764, -0.022348638623952866, -0.02008851431310177, -0.0013344703475013375, -0.002879996318370104, 0.0219630878418684, -0.0035663428716361523, -0.01007084734737873, 0.028929587453603745, 0.027520334348082542, -0.009100323542952538, 0.027679871767759323, 0.025393158197402954, 0.06126265600323677, 0.045202482491731644, -0.005510714370757341, -0.036029037088155746, -0.012237907387316227, -0.02257465198636055, -0.007691069506108761, -0.0185994915664196, -0.014690806157886982, 0.01013067364692688, 0.002175369532778859, 0.038767773658037186, -0.027759641408920288, 0.021923203021287918, -0.050440650433301926, -0.0034998685587197542, -0.03940592706203461, -0.011247441172599792, 0.016339367255568504, 0.024063674733042717, 0.06408116221427917, -0.06237942352890968, -0.013580686412751675, -0.003400157205760479, -0.060092709958553314, -0.04126720502972603, 0.029860228300094604, 0.005297996569424868, -0.04376663640141487, 0.015714509412646294, -0.03347642719745636, -0.03009953536093235, 0.0085951192304492, 0.04424525424838066, 0.006590920500457287, -0.017097173258662224, -0.02363823913037777, 0.019716259092092514, 0.033715732395648956, 0.026057900860905647, -0.03730534389615059, 0.03666719049215317, -0.035364292562007904, -0.003509839763864875, 0.006547712255269289, -0.04440478980541229, -0.0035530480090528727, -0.033715732395648956, -0.020327821373939514, 0.039379339665174484, -0.041825588792562485, -0.009991077706217766, -0.031987402588129044, 0.023571765050292015, 0.005510714370757341, -0.02210933156311512, -0.0598268136382103, 0.09774371981620789, -0.0017416250193491578, 0.017296597361564636, 0.03071109764277935, 0.03055156022310257, -0.0037125861272215843, -0.06296439468860626, -0.027254438027739525, -0.020779846236109734, 0.032944630831480026, 0.0035297819413244724, 0.0213515255600214, 0.02672264352440834, 0.034008219838142395, -0.030126124620437622, -0.034486833959817886, -0.020646898075938225, -0.010143968276679516, -0.05131811276078224, 0.029753869399428368, 0.04549496993422508, -0.04727647826075554, 0.02518044039607048, -0.011500042863190174, 0.007418524939566851, -0.005902912467718124, 0.04469727724790573, 0.007857254706323147, 0.006926615722477436, 0.11678194254636765, 0.002496107714250684, 0.04451115056872368, 0.008123151957988739, -0.012051778845489025, -0.016698328778147697, -0.026656169444322586, 0.06429388374090195, -0.014770575799047947, 0.03483249992132187, -0.005577188450843096, 0.01005090493708849, -0.0258185938000679, -0.018227236345410347, -0.0466117337346077, 0.0213515255600214, -0.037092626094818115, -0.03485909104347229, 0.025685645639896393, -0.02916889637708664, -0.04315507411956787, 0.03227989003062248, -0.013706987723708153, 0.020939385518431664, 0.008934137411415577, -0.0016635177889838815, -0.0071393330581486225, 0.01967637427151203, 0.011892241425812244, -0.030285662040114403, 0.002203620970249176, -0.023385636508464813, 0.00706621166318655, -0.016472315415740013, 0.02640356682240963, 0.002085629152134061, -0.0015064723556861281, -0.024063674733042717, 0.010263622738420963, 0.010190500877797604, -0.0039917780086398125, -0.0025875098071992397, -0.14103174209594727, -0.009745122864842415, -0.01005090493708849, 0.03557701036334038, -0.015156126581132412, -0.011918830685317516, 0.03360937535762787, -0.04730306565761566, -0.015780983492732048, 0.003652759362012148, -0.01304224506020546, -0.01228443905711174, 0.008987316861748695, 0.007312166038900614, 0.004104784224182367, 0.019264234229922295, 0.0010818681912496686, 0.016552085056900978, -0.006730516441166401, 0.03057814948260784, -0.010968249291181564, -0.018692554906010628, 0.045229069888591766, 0.015754394233226776, -0.034034810960292816, 0.04528225213289261, -0.008814483880996704, -0.021737076342105865, 0.02993999607861042, 0.026642873883247375, -0.0105826985090971, -0.02980704791843891, 0.003423423273488879, -0.006381526589393616, 0.02241511270403862, -0.026456747204065323, 0.0019776085391640663, -0.013175194151699543, -0.004746260587126017, 0.0015779322711750865, 0.02810530737042427, 0.013746872544288635, 0.026616284623742104, -0.0202480535954237, -0.0014906848082318902, 0.048738911747932434, 0.034752730280160904, 0.0140393590554595, -0.03134924918413162, 0.03624175488948822, 0.005381089635193348, 0.01704399473965168, -0.014823755249381065, -0.009818244725465775, -0.028902998194098473, 0.016179829835891724, 0.003722557332366705, -0.0614221952855587, 0.00836910679936409, 0.027387386187911034, 0.0029115716461092234, -0.016379252076148987, -0.0049290647730231285, 0.029248664155602455, 0.005440916400402784, 0.006162161938846111, -0.0023265983909368515, -0.05294008180499077, 0.0039851306937634945, 0.018546313047409058, -0.019769437611103058, -0.03914003074169159, -1.6001855556169176e-06, 0.015435317531228065, 0.01165958121418953, -0.020367706194519997, -0.005294673144817352, -0.014451499097049236, 0.03839552029967308, -0.02132493630051613, 0.006790343206375837, 0.01328155305236578, 0.005843085702508688, -0.03116312250494957, 0.009033848531544209, -0.010409865528345108, -0.02625732310116291, -0.024196622893214226, -0.00041151707409881055, -0.024010494351387024, -0.0012679960345849395, 0.0402567982673645, -0.028690280392766, -0.003228986170142889, -0.003679349087178707, -0.020327821373939514, -0.0030362107791006565, 0.015355548821389675, 0.009545700624585152, 0.009951193816959858, -0.010629230178892612, -0.01935729756951332, -0.015275780111551285, -0.048738911747932434, -0.04326143488287926, -0.013341379351913929, 0.010689057409763336, -0.01220467034727335, 0.0211653970181942, -0.011220850981771946, 0.01828041486442089, 0.0016967549454420805, -0.0030594768468290567, 0.01052951905876398, 0.04509612172842026, -0.008887605741620064, -0.04682445153594017, 0.0404961071908474, 0.01919776014983654, 0.00975177064538002, -0.0038920666556805372, -0.004231085069477558, -0.02903594635426998, -0.03961864486336708, -0.029301844537258148, 0.012078369036316872, 0.0072191022336483, 0.018360184505581856, -0.02334575168788433, -0.01320843119174242, -0.017868274822831154, -0.01381334662437439, 0.02242840826511383, -0.03711921349167824, -0.01280958577990532, -0.0368267260491848, 0.016233008354902267, 0.03411457687616348, 0.04929729551076889, -0.014730690978467464, 0.022295460104942322, 0.0016967549454420805, 0.0089009003713727, 0.006152190733700991, -0.0007295547402463853, 0.011300620622932911, -0.0006780372350476682, -0.003110994352027774, 0.028131896629929543, -0.0048592668026685715, -0.03204058110713959, -0.0011001486564055085, 0.021537652239203453, -0.058444149792194366, 0.01748272404074669, -0.06370890885591507, -0.03023248352110386, -0.0021720456425100565, 0.00621534138917923, 0.035550422966480255, 0.020327821373939514, 0.019556719809770584, -0.00805003009736538, 0.026470040902495384, -0.01995556615293026, 0.003612874774262309, -0.00782401766628027, 0.016831276938319206, 0.023292573168873787, 0.006241931114345789, 0.04932388290762901, -0.04038974642753601, -0.03161514922976494, -0.024967724457383156, 0.004344091285020113, -0.01582086831331253, -0.021391410380601883, -0.015913931652903557, -0.015209305100142956, 0.0044670687057077885, -0.015541676431894302, 0.04267645999789238, -0.005447563715279102, 0.007571415510028601, 0.01220467034727335, -0.04791463166475296, 0.019556719809770584, 0.002321612788364291, 0.010090788826346397, 0.010489634238183498, -0.006358260754495859, -0.02014169469475746, -0.05387072265148163, 0.009319688193500042, 0.00835581123828888, -0.02454228885471821, -0.0011333856964483857, 0.01519601047039032, -0.026616284623742104, -0.004058252088725567, 0.027919180691242218, -0.013693693093955517, 0.02151106297969818, 0.01794804446399212, 0.01625959761440754, -0.006700603291392326, -0.01288935448974371, -0.02736079692840576, 0.011293972842395306, 0.006145543418824673, 0.016964225098490715, -0.03422093763947487, -0.017921455204486847, 0.028929587453603745, 0.006813609506934881, -0.04358050972223282, -0.0022966850083321333, -0.009937898255884647, -0.0205538347363472, 0.0016901075141504407, 0.034141167998313904, 0.022654419764876366, 0.014172307215631008, -0.021258460357785225, 0.012264496646821499, 0.0028534065932035446, 0.026177555322647095, 0.01765555702149868, -0.008435580879449844, 0.039246391505002975, 0.0006830227794125676, 0.012723169289529324, 1.528128450445365e-05, -0.008309279568493366, 0.015847457572817802, -0.020540539175271988, 0.009180092252790928, 0.005035423673689365, 0.035523831844329834, -0.006212017498910427, 0.006261873058974743, 0.019583310931921005, 0.03656082972884178, 0.0035297819413244724, -0.010230384767055511, 0.004666491411626339, -0.0007607145817019045, 0.017562493681907654, -0.0036228459794074297, -0.015568266622722149, -0.030817456543445587, 0.0034167757257819176, 0.030126124620437622, -0.016831276938319206, -0.016459021717309952, -0.015501792542636395, 0.0035497243516147137, -0.01097489707171917, -0.02456887811422348, -0.015036472119390965, 0.033396657556295395, 0.005351176019757986, -0.033875271677970886, -0.016060175374150276, -0.0008242805488407612, -0.028690280392766, 0.030365431681275368, -0.006544388830661774, 0.020181577652692795, -0.03940592706203461, -0.1382664144039154, -0.03714580461382866, 0.01411912776529789, -0.01251045148819685, -0.026922065764665604, -0.013554097153246403, 0.012689932249486446, 0.02242840826511383, -0.03727875277400017, 0.004044957458972931, -0.037385109812021255, -0.044457968324422836, -0.005723431706428528, -0.006255225744098425, -0.0031392457894980907, -0.028610512614250183, -0.018639376387000084, -0.024209916591644287, 0.027201257646083832, -0.018147466704249382, 0.0006988104432821274, -0.018041107803583145, 0.002484474563971162, -0.007451761979609728, -0.014916818588972092, -0.03594926744699478, 0.0008541939314454794, 0.026363682001829147, -0.005979357752948999, 0.005042070988565683, 0.008103209547698498, -0.0031093324068933725, 0.017070583999156952, 0.02561917155981064, -0.021590832620859146, -0.029727278277277946, -0.011440216563642025, -0.018519721925258636, -0.007817369885742664, -0.005856380332261324, 0.009200034663081169, -0.024302981793880463, 0.0036660542245954275, -0.014238781295716763, 0.0011666228529065847, -0.018931861966848373, 0.02209603600203991, -0.0007731784717179835, -0.01042980793863535, -0.026749232783913612, -0.00814309436827898, 0.010988191701471806, 0.004845971707254648, -0.02455558255314827, -0.02149776928126812, 0.030471790581941605, 0.014092538505792618, -0.003041196381673217, -0.01796133816242218, 0.001896177651360631, 0.028610512614250183, 0.021697191521525383, -0.008654945529997349, -0.018333595246076584, 0.0033286975231021643, -0.04818052798509598, 0.009332982823252678, -0.006880083587020636, 0.013002361170947552, -0.01559485588222742, -0.0005301320343278348, 0.02027464285492897, 0.012164785526692867, 0.01050957664847374, 0.002717134542763233, 0.029594330117106438, 0.01580757461488247, -0.00614221952855587, -0.04834006726741791, 0.01704399473965168, 0.030312253162264824, -0.04358050972223282, 0.039698414504528046, -0.01336132176220417, 0.017376365140080452, 0.015860753133893013, 0.00822286307811737, -0.0007731784717179835, -0.024037083610892296, 0.020833026617765427, 0.05070654675364494, -0.032758504152297974, 0.004752907902002335, -0.014331845566630363, -0.03789031505584717, -0.0282648466527462, -0.01288935448974371, 0.0171902384608984, -0.008282690308988094, 0.00029310982790775597, 0.012091663666069508, 0.02658969536423683, -0.030471790581941605, -0.04166605323553085, 0.021617421880364418, 0.04663832485675812, -0.011014780960977077, -0.028025537729263306, 0.007239044643938541, -0.0004383145133033395, 0.031109943985939026, 0.031056763604283333, 0.016831276938319206, 0.028663691133260727, -0.008894252590835094, 0.04150651395320892, 0.031109943985939026, 0.0011317238677293062, 0.02209603600203991, 0.012949181720614433, 0.021378114819526672, -0.0016261260025203228, -0.022800663486123085, 0.02059371955692768, -0.024462519213557243, 0.020779846236109734, 0.017854981124401093, 0.009851481765508652, -0.004194524604827166, -0.03424752876162529, -0.01643243245780468, 0.029833637177944183, -0.02101915329694748, 0.026483336463570595, 0.0005288856336846948, -0.0205538347363472, 0.020008744671940804, 0.014916818588972092, -0.01917117089033127, 0.03640129417181015, -0.00767112709581852, 0.012025189585983753, 0.03725216165184975, -0.008814483880996704, -0.026337092742323875, -0.01734977588057518, 0.006089040078222752, -0.0256324652582407, -0.032333068549633026, 0.011639638803899288, 0.006607539020478725, -0.011799177154898643, -0.0189052727073431, -0.0027686520479619503, 0.010768826119601727, 6.725323328282684e-05, -0.013348027132451534, -0.028770050033926964, 0.0005164217436686158, 0.011859004385769367, -0.00882113166153431, 0.013427795842289925, -0.01717694289982319, -0.0371989831328392, 0.017535904422402382, 0.020008744671940804, -0.0018147466471418738, -0.0013070496497675776, -0.011932125315070152, 0.023585058748722076, -0.0012887693010270596, -0.05546610429883003, 0.03137584030628204, 0.013800051994621754, 0.03533770516514778, 0.014770575799047947, 0.015448613092303276, -0.001793142524547875, 0.003283827332779765, 0.0359758585691452, -0.010722294449806213, 0.008182978257536888, -0.02008851431310177, 0.01643243245780468, 0.01559485588222742, -0.03406139835715294, 0.019995450973510742, 0.026602989062666893, 0.014398319646716118, 0.024462519213557243, 0.023864250630140305, 0.035257935523986816, -0.010556109249591827, 0.02978045865893364, -0.01534225419163704, -0.03052496910095215, 0.046292658895254135, 0.050121575593948364, 0.004480363801121712, -0.002557596191763878, -0.05461523309350014, 0.04717011749744415, -0.01765555702149868, 0.004593370016664267, 0.007937024347484112, 0.02333245798945427, -0.007883844897150993, 0.028796639293432236, -0.04342097043991089, 0.047967810183763504, -0.008475465700030327, 0.03390186280012131, -0.02395731583237648, -0.01368039846420288, 0.002526021096855402, -0.013567391782999039, -0.01366710290312767, 0.01519601047039032, 0.0006489547668024898, -0.02272089384496212, -0.03642788156867027, -0.02378448285162449, 0.0005147598567418754, -0.014026064425706863, 0.014837049879133701, 0.020979268476366997, 0.026323797181248665, 0.029594330117106438, -0.027759641408920288, 0.01657867431640625, 0.00276366644538939, 0.0023814395535737276, 0.0031492169946432114, -0.005863027647137642, 0.004673138726502657, -0.018453247845172882, 0.01566133089363575, 0.030737686902284622, -0.015767689794301987, 0.01013067364692688, 0.02855733223259449, -0.022215690463781357, -0.0029165572486817837, -0.012031837366521358, -0.03895390406250954, -0.03775736689567566, 0.010409865528345108, 0.06099675968289375, -0.0282648466527462, 0.0071326857432723045, -0.021683895960450172, 0.0001432312128599733, 0.04557473585009575, 0.002017493126913905, 0.02702842466533184, 0.008389049209654331, 0.018493132665753365, 0.049350474029779434, 0.027214553207159042, 0.035842910408973694, 0.004251027479767799, 0.013035598210990429, -0.013068835251033306, -0.004098136909306049, -0.02658969536423683, -0.007804075721651316, -0.0222688689827919, -0.007232396863400936, 0.03129607066512108, -0.007312166038900614, -0.004563456401228905, 0.01366710290312767, 0.00208895280957222, 0.027094898745417595, -0.019543426111340523, -0.014571152627468109, 0.01979602873325348, -0.032492607831954956, 0.0022418436128646135, 0.0062784915789961815, -0.033715732395648956, 0.00805003009736538, 0.015275780111551285, 0.007564768195152283, -0.006248578429222107, -0.032918043434619904, -0.00927980337291956, 0.014371730387210846, 0.002152103465050459, 0.0045435139909386635, 0.03041861020028591, 0.00914685521274805, 0.004264322109520435, -0.02653651498258114, -0.0029082479886710644, 0.00967864878475666, 0.006770401261746883, 0.004546837881207466, 0.026137670502066612, -0.007504941429942846, -0.017615672200918198, 0.017748622223734856, 0.029860228300094604, -0.05267418548464775, 0.0057899062521755695, 0.03512498736381531, 0.028158487752079964, -0.04727647826075554, -0.02472841553390026, -0.010310154408216476, 0.008654945529997349, 0.029434792697429657, 0.002170383930206299, 0.018466543406248093, -0.005354499910026789, -0.0010062537621706724, -0.042011719197034836, -0.026323797181248665, -0.014797165058553219, -0.015727804973721504, -0.01042980793863535, -0.009851481765508652, 0.021723780781030655, -0.005022128578275442, -0.017894864082336426, 0.0068933782167732716, -0.020819731056690216, -0.0014931776095181704, -0.002127175685018301, 0.030179303139448166, 0.012178080156445503, -0.02700183540582657, -0.006268520373851061, 0.006580949295312166, -0.028052128851413727, -0.0016635177889838815, -0.00805003009736538, 0.0050819553434848785, -0.012410740368068218, -0.03190763294696808, 0.00694655766710639, 0.035364292562007904, -0.018027814105153084, -0.007617947645485401, 0.00029414851451292634, 0.051982853561639786, 0.005607102066278458, -0.0102769173681736, 0.008083267137408257, -0.013999474234879017, 0.07040951400995255, -0.0380498543381691, -0.03177468478679657, 0.025366568937897682, 0.0019776085391640663, 0.027094898745417595, 0.028770050033926964, -0.03932615742087364, -0.011307267472147942, 0.020939385518431664, 0.017841685563325882, -0.011539927683770657, 0.0036926439497619867, -0.0031043468043208122, 0.01813417114317417, -0.014571152627468109, -0.011194261722266674, 0.02059371955692768, -0.005188314244151115, 0.018533017486333847, 0.04562791809439659, 0.04342097043991089, -0.007770838215947151, 0.012896002270281315, 0.0026556458324193954, 0.005882970057427883, -0.007677774410694838, 0.001720020896755159, 0.02167060226202011, 0.04756896570324898, 0.005234846379607916, -0.008269394747912884, -0.057327382266521454, 0.0009688620339147747, -0.009798302315175533, 0.0012696579797193408, 0.011413626372814178, 0.0420914888381958, -0.030019765719771385, -0.028690280392766, -0.007903787307441235, 0.009778359904885292, 0.012563630938529968, 0.0023664827458560467, -0.010689057409763336, -0.0016061837086454034, 0.02224227972328663, -0.009047144092619419, 0.021737076342105865, -0.025366568937897682, 0.022973496466875076, -0.017017405480146408, 0.011480100452899933, 0.0007748403586447239, 0.02730761654675007, -0.028504153713583946, -0.01551508717238903, 0.03360937535762787, -0.008880957961082458, 0.003469955176115036, -0.05054701119661331, -0.03504521772265434, 0.017562493681907654, 0.0007627918967045844, -0.0031276128720492125, -0.05262100696563721, -0.023412225767970085, 0.013580686412751675, -0.004211143124848604, 0.027679871767759323, 0.007112743332982063, 0.005540627520531416, -0.018852094188332558, -0.008468817919492722, 0.01887868344783783, -0.0022867138031870127, 0.026669465005397797, -0.017775211483240128, 0.03142901882529259, 0.029275253415107727, -0.014996588230133057, -0.019849207252264023, -0.06120947748422623, -0.00022684333089273423, -0.010383276268839836, -0.007258986588567495, 0.02087291143834591, 0.014198897406458855, -0.003652759362012148, 0.019889092072844505, 0.018506428226828575, -0.023904135450720787, 0.004064899403601885, 0.012729816138744354, -0.026762528344988823, -0.013161898590624332, 0.0028467592783272266, -0.02625732310116291, 0.0014333507278934121, -0.018147466704249382, -0.00652112253010273, -0.008967374451458454, -0.02592495270073414, -0.004590046126395464, -0.034327294677495956, -0.020181577652692795, -0.042304206639528275, -0.0140393590554595, -0.0123575609177351, 0.04387299716472626, 0.00672054523602128, 0.013959590345621109, 0.010117379017174244, 0.009618822485208511, 0.008249453268945217, -0.005407679360359907, 0.0036893202923238277, 0.036959677934646606, 0.007298871409147978, -0.02964751049876213, 0.026616284623742104, 0.01903822086751461, 0.02842438407242298, 0.014557857997715473, -0.020912794396281242, 0.012550336308777332, -0.04456432908773422, -0.011380389332771301, 0.007478351704776287, -0.02180355042219162, -0.021617421880364418, 0.0007553135510534048, -0.014159012585878372, 0.016977520659565926, 0.023678123950958252, 0.01947695203125477, 0.011121139861643314, -0.005986005067825317, -0.0018546312348917127, -0.013015655800700188, 0.012144843116402626, 0.0420914888381958, -0.027467155829072, 0.004533542785793543, -0.0008782908553257585, 0.017402956262230873, -0.0017549198819324374, -0.0102769173681736, 0.05203603208065033, 0.00011539512343006209, -0.003725880989804864, -0.029860228300094604, 0.018931861966848373, 0.01826712116599083, -0.04174582287669182, -0.0055572460405528545, -0.019131286069750786, 0.0016552085289731622, 0.014531268738210201, 0.016086764633655548, 0.03243942931294441, -0.015767689794301987, 0.007956965826451778, 0.04347415268421173, 0.03812962397933006, -0.01159975491464138, -0.02026134729385376, 0.011001486331224442, 0.03007294423878193, -0.017456134781241417, -0.005371118430048227, 0.012955828569829464, 0.013800051994621754, 0.004300883039832115, -0.018041107803583145, -0.016552085056900978, -0.02736079692840576, 0.03222671151161194, -0.01105466578155756, 0.010369980707764626, -0.011141082271933556, -0.00664077652618289, 0.039698414504528046, 0.0005384413525462151, -0.01596711203455925, -0.0189052727073431, 0.0038555057253688574, 0.005407679360359907, 0.006275168154388666, 0.023518584668636322, 0.005823143292218447, -0.03220012038946152, -0.004284264519810677, -0.007591357920318842, 0.014398319646716118, -0.010589346289634705, -0.011626344174146652, 0.037225574254989624, -0.003862153273075819, 0.018493132665753365, 0.008329221978783607, -0.022694304585456848, 0.04001748934388161, 0.0019443714991211891, -0.03443365544080734, 0.04778168350458145, -0.017722031101584435, -0.0024678560439497232, 0.008262747898697853, -0.01873243972659111, 0.03379550203680992, 0.0023083179257810116, 0.026829002425074577, 0.036906495690345764, 0.01181247178465128, -0.028530742973089218, 0.002813522005453706, 0.006108982488512993, -0.03749147057533264, 0.005560569930821657, -0.022534767165780067, -4.611650365404785e-05, 0.010137321427464485, 0.009652059525251389, -0.019091401249170303, 0.0010004373034462333, 0.006428058724850416, -0.00468643382191658, -0.010310154408216476, 0.022335343062877655, 0.009858129546046257, 0.005939472932368517, -0.006434706039726734, 0.015275780111551285, 0.006803638301789761, 0.0021836787927895784, -0.002060701372101903, -0.02225557528436184, 0.005022128578275442, -0.011579812504351139, -0.057167842984199524, 0.026749232783913612, -0.004327472764998674, 0.036161985248327255, 0.006408116314560175, 0.04187877103686333, 0.018307004123926163, 0.008641650900244713, -0.024954428896307945, 0.006494532804936171, -0.015129536390304565, 0.007677774410694838, -0.013301494531333447, -0.016618559136986732, 0.009592232294380665, -0.03456660360097885, 0.003958540968596935, -0.01411912776529789, -0.012497156858444214, 0.014544563367962837, 0.0028384500183165073, 0.008575176820158958, 0.008907548151910305, 0.009200034663081169, 0.003463307861238718, 0.014424909837543964, -0.02689547650516033, -0.0008666578796692193, -0.00526475952938199, 0.0020922766998410225, -0.02379777655005455, -0.010822005569934845, -0.03286486491560936, -0.022813959047198296, 0.03366255387663841, 0.02071337215602398, 0.021431293338537216, -0.02749374508857727, -0.01951683685183525, -0.00047653718502260745, 0.05022793263196945, 0.0012854455271735787, -0.02718796394765377, -0.018852094188332558, 0.026815706863999367, 0.016033586114645004, -0.012869412079453468, 0.016365956515073776, -0.011094550602138042, -0.014624332077801228, -0.010569403879344463, 0.01949024572968483, 0.02039429545402527, -0.030897226184606552, 0.007192512508481741, 0.02884981967508793, 0.0014989940682426095, 0.024914544075727463, -0.005706813186407089, -0.020022040233016014, 0.020075220614671707, -0.028956178575754166, 0.002730429405346513, -0.015009882859885693, 0.0061953989788889885, 0.05294008180499077, -0.02672264352440834, 0.04498976469039917, 0.004154639784246683, -0.009545700624585152, -0.0008005991112440825, 0.031561966985464096, -0.007518236059695482, 0.0038056501653045416, 0.0008392372401431203, 0.014012768864631653, 0.0047894688323140144, 0.034141167998313904, 0.001579594099894166, 0.04241056367754936, -0.013540802523493767, 0.017256712540984154, -0.03334347903728485, -0.007711011450737715, 0.02075325697660446, 0.01326825749129057, 0.012556983157992363, -0.006959852762520313, -0.0061123063787817955, -0.012876059859991074, 0.016924340277910233, -0.008734715171158314, 0.02839779481291771, -0.0001329484803136438, 0.010994838550686836, -0.00982489250600338, -0.01579427905380726, -0.009426047094166279, 0.02228216454386711, -0.040602464228868484, -0.023545175790786743, 0.01005090493708849, 0.01748272404074669, 0.000725815596524626, -0.04126720502972603, -0.008415638469159603, -0.028743460774421692, 0.01582086831331253, -0.019144579768180847, 0.025300094857811928, 0.04225102439522743, 0.010263622738420963, 0.037837136536836624, 0.0017216827254742384, 0.03212035074830055, 0.0017964662984013557, 0.007578063290566206, -0.009718533605337143, -0.04961637035012245, 0.004334120079874992, -0.026376977562904358, -0.018971746787428856, 0.01288935448974371, 0.01717694289982319, 0.01826712116599083, 0.033981628715991974, 0.016219714656472206, -0.0184133630245924, 0.005008833948522806, 0.022189101204276085, -0.016179829835891724, 0.02242840826511383, 0.0015912270173430443, -0.017881570383906364, -0.0022368580102920532, 0.02059371955692768, -0.005424297880381346, -0.008541939780116081, 0.0035198109690099955, 0.012995713390409946, 0.03932615742087364, -0.03573654964566231, 0.0035962562542408705, -0.006541064940392971, -0.017589082941412926, 0.02071337215602398, -0.008761304430663586, -0.003001311793923378, 0.007332108449190855]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" C). Where practical, we also implement
GUIDANCE programs, using their custom CFG-like syntax.
Setup We run 100 repetitions per configuration. In each,
we sample one of 5 different prompts per workload, and
sample output of up to 128tokens from the model, using
a temperature value of 1.0. This way, we ensure that the
model produces in-distribution output, but that it still ex-
hibits diversity. Before measuring, we run 10repetitions
of warmup, allowing our speculative mechanisms to form a
prior. After that, the learned priors remain fixed.
Results As shown in Table 3, DOMINO is highly effective
and clearly reduces the compuational load of constraining
at inference time. DOMINO outcompetes both GUIDANCE
andllama.cpp ’s online parsing approach significantly. For
grammars with predictable structure (e.g. schema-driven
formats), speculative decoding is particularly effective, lead-
ing to up to 77% higher throughput over unconstrained
generation, while remaining minimally invasive.
C code generation induces the most overhead, which can
be explained by the fact that the C grammar is the mostcomplex of the tested workloads. Here, speculative decod-
ing does not bring any benefits, as the C code is to hard to
predict using our simple count-based model. However, by
relying on DOMINO ’s opportunistic masking mode, we still
outcompete llama.cpp , running at 0.78×vs.0.74×.
5. Conclusion
We have shown the need for minimally invasive, highly-
efficient constrained decoding methods. As first instantia-
tion of this for grammars, we presented DOMINO , which
leverages precomputation, speculative decoding and oppor-
tunistic masking, to implement minimally invasive con-
straining (no accuracy loss), often overhead-free or even
faster generation, and thus, high-throughput inference.
Impact Statement
This paper presents work whose goal is to advance the field
of Machine Learning. There are many potential societal
consequences of our work, none which we feel must be
specifically highlighted here.
Acknowledgements
This work has received funding from the Swiss State Secre-
tariat for Education, Research and Innovation (SERI). This
work has been done as part of the SERI grant SAFEAI (Cer-
tified Safe, Fair and Robust Artificial Intelligence, contract
no. MB22.00088, SERI-funded ERC Consolidator Grant).
9
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
References
Anil, R., Borgeaud, S., Wu, Y ., Alayrac, J., Yu, J., Sori-
cut, R., Schalkwyk, J., Dai, A. M., Hauth, A., Millican,
K., Silver, D., Petrov, S., Johnson, M., Antonoglou, I.,
Schrittwieser, J., Glaese, A., Chen, J., Pitler, E., Lilli-
crap, T. P., Lazaridou, A., Firat, O., Molloy, J., Isard, M.,
Barham, P. R., Hennigan, T., Lee, B., Viola, F., Reynolds,
M., Xu, Y ., Doherty, R., Collins, E., Meyer, C., Ruther-
ford, E., Moreira, E., Ayoub, K., Goel, M., Tucker, G.,
Piqueras, E., Krikun, M., Barr, I., Savinov, N., Danihelka,
I., Roelofs, B., White, A., Andreassen, A., von Glehn,
T., Yagati, L., Kazemi, M., Gonzalez, L., Khalman, M.,
Sygnowski, J., and et al. Gemini: A family of highly
capable multimodal models. ArXiv preprint , 2023. URL
https://arxiv.org/abs/2312.11805 .
Beurer-Kellner, L., Fischer, M., and Vechev, M. T. Prompt-
ing is programming: A query language for large language
models. Proc. ACM Program. Lang. , (PLDI), 2023.
Brown, T. B., Mann, B., Ryder, N., Subbiah, M., Kaplan,
J., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G.,
Askell, A., Agarwal, S., Herbert-V oss, A., Krueger, G.,
Henighan, T., Child","[0.0266839899122715, 0.045236553996801376, 0.052193764597177505, 0.005955461412668228, -0.001514551229774952, 0.01783335953950882, -0.0017631541704759002, 0.011309138499200344, -0.025553809478878975, 0.02480524778366089, 0.027271095663309097, -0.008072714321315289, -0.010237669572234154, -0.014839116483926773, 0.004062043037265539, -0.01980016566812992, 0.021385353058576584, -0.01563170924782753, 0.011998988687992096, 0.05518800765275955, 0.02206052653491497, -0.014780405908823013, -0.006575592327862978, 0.016204139217734337, 0.005918767303228378, -0.012784243561327457, 0.008021342568099499, 0.03507961332798004, 0.025729941204190254, -0.07268378138542175, 0.03772159293293953, -0.03540252149105072, -0.029472745954990387, -0.0447668693959713, 0.01569041982293129, 0.034521859139204025, 0.034257661551237106, -0.0025630868040025234, -0.02644914761185646, 0.00890934094786644, -0.023601680994033813, -0.0683979019522667, -0.020710181444883347, -0.034463148564100266, 0.005261941812932491, 0.056186091154813766, -0.007962631992995739, 0.0035153001081198454, -0.0037097791209816933, 0.021781649440526962, -0.061117783188819885, 0.014875810593366623, 0.004627132788300514, 0.00993677694350481, -0.06023712456226349, -0.02445298433303833, -0.012534723617136478, 0.02194310538470745, 0.01977081038057804, -0.025201546028256416, 0.009628546424210072, -0.04917016625404358, 0.015029925853013992, 0.04150842875242233, -0.027388516813516617, 0.0019906579982489347, -0.01767190545797348, 0.02031388320028782, 0.0026016156189143658, 0.02483460307121277, -0.009716612286865711, 0.023484259843826294, 0.031733106821775436, -0.05562833696603775, -0.03299538418650627, 0.004608785733580589, 0.029883719980716705, 0.06769337505102158, -0.006902170367538929, -0.0086744986474514, 0.006916848011314869, -0.0045610833913087845, 0.03757481276988983, -0.04280006140470505, -0.009261604398488998, 0.007474599406123161, -0.007632384076714516, 0.016028007492423058, -0.06963083148002625, -0.04599979147315025, -0.011228411458432674, -0.009327653795480728, -0.036752864718437195, 0.016938021406531334, 0.07121601700782776, 0.02418878674507141, 0.009305637329816818, -0.015382189303636551, 0.06170488893985748, 0.045764949172735214, 0.013797001913189888, -0.032320212572813034, 0.036723509430885315, -0.021400030702352524, 0.06417074054479599, 0.0003119003085885197, -0.04133229702711105, -0.0030621271580457687, -0.00868183746933937, 0.005698602180927992, -0.10873211920261383, -0.025054769590497017, -0.05028567090630531, -0.0058747343719005585, -0.010920180007815361, -0.047584980726242065, -0.06393589824438095, 0.004671165719628334, -0.008138763718307018, -0.020548727363348007, -0.01985887624323368, -0.0023832854349166155, -0.007485607638955116, -0.01748109608888626, 0.003944621421396732, 0.005049115512520075, 0.029458068311214447, -0.06029583513736725, 0.02254488877952099, -0.03590156137943268, -0.016600435599684715, 0.01433273684233427, 0.03751610219478607, -0.011441237293183804, -0.043504588305950165, 0.015059281140565872, -0.04274135082960129, 0.011859551072120667, -0.01542622223496437, 0.018405787646770477, 0.0070893107913434505, -0.022926507517695427, -0.01345941610634327, 0.04412105306982994, -0.03819127753376961, 0.029604844748973846, -0.020519372075796127, 0.027505937963724136, -0.03490348160266876, 0.03742803633213043, -0.004575761035084724, -0.015998652204871178, -0.04893532395362854, 0.00732415309175849, -0.0012219153577461839, -0.06246813014149666, -0.027300450950860977, 0.052575383335351944, 0.007122335489839315, -0.04664560779929161, -0.005617875140160322, 0.05806482955813408, 0.0045427363365888596, -0.0006921435124240816, 0.027285773307085037, 0.03396410867571831, -0.03328893706202507, 0.02644914761185646, -0.08107940107584, -0.002709863241761923, 0.010435817763209343, -0.013620870187878609, -0.021165188401937485, -0.013943779282271862, -0.023542970418930054, -0.012160442769527435, -0.04142036288976669, -0.03598962724208832, -0.011624707840383053, -0.041038744151592255, -0.020401950925588608, 0.049786631017923355, -0.038690317422151566, 0.00907079502940178, -0.03082308918237686, -0.023337481543421745, -0.03775094822049141, 0.020812924951314926, -0.003922604955732822, 0.054366059601306915, -0.00990742165595293, 0.04233037680387497, 0.08336912095546722, 0.0527808740735054, 0.029502101242542267, -0.04221295565366745, 0.0745038092136383, -0.011998988687992096, -0.004267530050128698, -0.013980473391711712, 0.01328328438103199, 0.0012650309363380075, 0.0022144922986626625, -0.05348540097475052, 0.020798247307538986, -0.011624707840383053, 0.013995151035487652, 0.002370442496612668, 0.0012476012343540788, 0.004825281444936991, 0.019183704629540443, 0.0031336809042841196, 0.045471396297216415, -0.0022860458120703697, -0.03358248993754387, -0.00357768009416759, -0.023689746856689453, 0.007166368421167135, 0.007786499802023172, 0.03751610219478607, 0.012160442769527435, 0.019594678655266762, 0.02678673341870308, 0.005181214772164822, -0.022809086367487907, 0.039160002022981644, -0.0176425501704216, -0.01972677744925022, 0.04156713932752609, -0.01799481362104416, 0.05181214585900307, -0.004983066115528345, 0.006300386507064104, -0.015132669359445572, -0.00890934094786644, -0.025759296491742134, -0.0038638946134597063, -0.03716383874416351, 0.003201565006747842, -0.03566671907901764, 0.02204584889113903, -0.02255956642329693, 0.02448233962059021, -0.013811679556965828, 0.0048766531981527805, 0.045647528022527695, -0.043504588305950165, -0.06293781101703644, 0.0292379017919302, 0.054659612476825714, -0.002091566799208522, -0.016820600256323814, 0.008446994237601757, -0.010523883625864983, -0.05483574420213699, -0.015587677247822285, -0.041156165301799774, 0.0004623463610187173, 0.005247264169156551, 0.022618276998400688, -0.03745739161968231, 0.005981147289276123, -0.014846455305814743, 0.019007572904229164, -0.008520382456481457, 0.006373774725943804, -0.022867796942591667, 0.025685908272862434, 0.012145765125751495, -0.0481133759021759, -0.019418546929955482, -0.03942419961094856, -0.002797929337248206, 0.0019172695465385914, -0.0538083091378212, -0.04171391576528549, 0.004608785733580589, 0.054483480751514435, -0.020871635526418686, 0.023058606311678886, -0.01450886856764555, -0.004740884993225336, 0.06540366262197495, 0.015881231054663658, 0.004663826897740364, 0.032114725559949875, -0.0010402792831882834, -0.015470256097614765, -0.030676312744617462, -0.015602354891598225, 0.0008462589466944337, 0.023425549268722534, 0.023337481543421745, -0.013929100707173347, 0.016189461573958397, -0.0089680515229702, 0.01427402626723051, 0.0019961621146649122, 0.00726544251665473, 0.0076837558299303055, 0.050021473318338394, 0.0316450372338295, 0.004946372006088495, -0.016864633187651634, 0.00017257720173802227, 0.01327594555914402, -0.03281925246119499, -0.01962403394281864, -0.009401042014360428, 0.0007857136079110205, -0.0013943779049441218, -0.006230667699128389, -0.018464498221874237, 0.015352834016084671, -0.036928996443748474, -0.07062891125679016, 0.03827934339642525, -0.04165520519018173, 0.04144971817731857, -0.014149266295135021, -0.02479057013988495, -0.019066283479332924, -0.016571080312132835, -0.0025282271672040224, -0.025010736659169197, 0.019139671698212624, -0.010619288310408592, 0.020475339144468307, -0.010479850694537163, -0.04708594083786011, -0.017231574282050133, 0.03839676454663277, 0.02448233962059021, 0.043622009456157684, -0.02483460307121277, -0.04934629797935486, -0.039160002022981644, 0.03369991108775139, 0.050138894468545914, 0.03830869868397713, -0.08724401891231537, 0.03099922277033329, -0.010245008394122124, -0.0024841942358762026, -0.018420465290546417, 0.00435192696750164, -0.007808516267687082, 0.025583164766430855, 0.07908324152231216, 0.019036928191781044, 0.01978548802435398, -0.03496219217777252, 0.03622446954250336, 0.02253021113574505, 0.018170945346355438, 0.03331829234957695, -0.0087478868663311, -0.017246251925826073, -0.006927856244146824, -0.0030382759869098663, -0.03167439624667168, 0.02455572783946991, 0.007947954349219799, 0.06393589824438095, 0.0088212750852108, 0.009312976151704788, -0.020519372075796127, 0.009599191136658192, 0.032232146710157394, -0.02211923711001873, 0.00500141317024827, 0.03278989717364311, -0.022676987573504448, -0.012116409838199615, -0.029927752912044525, 0.010531222447752953, -0.03405217453837395, 0.03320087119936943, 0.018772728741168976, 0.023029251024127007, 0.008322234265506268, -0.017158186063170433, -0.002148442668840289, -0.013048441149294376, 6.123336788732558e-05, 0.031997304409742355, 0.01447951328009367, -0.01773061603307724, -0.02216327004134655, 0.00508214021101594, 0.012571417726576328, -0.00891667976975441, -0.0180094912648201, 0.019066283479332924, -0.00726544251665473, 0.022926507517695427, -0.011771485209465027, 0.023807168006896973, 0.04638141021132469, 0.031909238547086716, 0.038925159722566605, -0.022941185161471367, -0.007720449939370155, -0.007984648458659649, -0.016703179106116295, 0.002102575032040477, 0.021517451852560043, 0.029502101242542267, 0.025553809478878975, 0.005482106935232878, 0.027814168483018875, -0.023587003350257874, 0.03578414022922516, -0.04488429054617882, -0.02032856084406376, -0.05915097892284393, 0.006597609259188175, -0.006542567629367113, 0.02932596765458584, 0.054424770176410675, -0.027505937963724136, -0.03270183131098747, -0.019169026985764503, -0.07215538620948792, -0.029957108199596405, 0.03108728863298893, -0.006744385696947575, -0.06340750306844711, 0.030265338718891144, -0.054307349026203156, -0.04053970053792, 0.011294460855424404, 0.034639280289411545, -0.00435926578938961, -0.01758383959531784, -0.02235407941043377, 0.03364120051264763, 0.028210466727614403, 0.04861241579055786, -0.05063793435692787, 0.01768658310174942, -0.005566503386944532, -0.0073388307355344296, 0.02919386886060238, -0.016938021406531334, 0.0076690781861543655, -0.04503106698393822, 0.0017677409341558814, -0.010582594200968742, -0.06704755872488022, 0.004117084201425314, -0.02672802284359932, 0.03334764763712883, 0.023029251024127007, 0.0003889580548275262, -0.03505025804042816, 0.08348654210567474, -0.0358722060918808, 0.04849499464035034, 0.03525574505329132, 0.04200746864080429, 0.016805922612547874, -0.0570080392062664, -0.023792490363121033, -0.025216223672032356, 0.03384668752551079, -0.0006247179699130356, 0.023997977375984192, 0.016908666118979454, 0.03158632665872574, -0.009782661683857441, -0.03293667361140251, -0.011411882005631924, -0.015147347003221512, -0.04887661337852478, 0.012652144767343998, 0.01994694210588932, -0.04667496308684349, -0.00020904201664961874, -0.0354318767786026, 0.018523208796977997, 0.008175457827746868, 0.06399460881948471, 0.025539131835103035, 0.017246251925826073, 0.07444509863853455, 0.005588519852608442, 0.020710181444883347, -0.0009907422354444861, 0.011800840497016907, 0.005760982166975737, -0.03537316620349884, 0.06511010974645615, -0.018537886440753937, 0.01974145509302616, 0.00665265042334795, 0.012050360441207886, -0.018464498221874237, -0.029810331761837006, -0.03531445562839508, 0.004597777500748634, -0.030500181019306183, -0.03948291018605232, 0.011367849074304104, -0.014046522788703442, -0.030118562281131744, 0.04280006140470505, 0.015969296917319298, 0.007063624914735556, 0.008571754209697247, -0.015308801084756851, -0.005162867717444897, 0.006604948081076145, 0.01015694160014391, -0.008160780183970928, 0.03331829234957695, -0.03143955022096634, 0.01762787252664566, -0.015088636428117752, 0.005474768113344908, 0.007647061720490456, -0.013899745419621468, -0.02442362904548645, -0.004414306953549385, 0.0032419285271316767, -0.021077122539281845, -0.006373774725943804, -0.07761547714471817, -0.017260929569602013, -0.004539066925644875, 0.023807168006896973, -0.0006779244868084788, 0.00126686564181, -0.004080390091985464, -0.06370105594396591, -0.015279445797204971, 0.005713279824703932, -0.011588013730943203, -0.03954162076115608, -0.006982897873967886, -0.00356300245039165, 0.008131424896419048, 0.018714018166065216, 0.02424749732017517, 0.006865476258099079, -0.006362766493111849, 0.02435024082660675, -0.00876990333199501, -0.018728695809841156, 0.04864177107810974, 0.035578653216362, -0.04614656791090965, 0.03132212907075882, -0.018875474110245705, -0.0037097791209816933, 0.007529640570282936, 0.03314216062426567, -0.0018457160331308842, -0.027505937963724136, 0.003186887362971902, -0.009261604398488998, -0.013048441149294376, -0.023616358637809753, 0.0045684222131967545, -0.018581919372081757, -0.012681500054895878, -0.0018209473928436637, -0.02878289483487606, 0.0017310467083007097, 0.02920854650437832, -0.03622446954250336, 0.0016659146640449762, 0.02890031598508358, 0.022985218092799187, 0.007459921762347221, -0.04673367738723755, 0.016394948586821556, 0.006946203298866749, 0.018229655921459198, 0.014905165880918503, -0.009679918177425861, -0.040803901851177216, 0.007845209911465645, 0.008358928374946117, -0.05128375068306923, -0.00014987269241828471, 0.031938593834638596, 0.023308126255869865, -0.031791817396879196, -0.0021044097375124693, 0.031850527971982956, -0.011177039705216885, -0.013026424683630466, 0.0036382253747433424, -0.043416522443294525, 0.005027099046856165, 0.018669985234737396, -0.021502774208784103, -0.050109539180994034, 0.027608681470155716, 0.006678336299955845, -0.0015925263287499547, -0.01453088503330946, -0.003940952010452747, 0.0018512201495468616, 0.004678504541516304, -0.03414024040102959, 0.0057940068654716015, 0.025245578959584236, -0.007081971969455481, -0.03757481276988983, 0.02484928071498871, -0.0009907422354444861, -0.034580569714307785, -0.02481992542743683, -0.011632046662271023, -0.02848934195935726, -0.02407136559486389, 0.04045163467526436, -0.03343571349978447, 0.019124994054436684, -0.004263860639184713, 0.0008380027720704675, -0.004634471610188484, 0.015866553410887718, 0.00032566062873229384, 0.004135431256145239, 0.0018778233788907528, -0.03167439624667168, -0.017260929569602013, -0.023073283955454826, -0.0354318767786026, 0.010597271844744682, 0.008498365990817547, 0.00010882109927479178, 0.016145428642630577, -0.01015694160014391, -0.02213391475379467, 0.02251553349196911, -0.018273688852787018, 0.025539131835103035, 0.03117535449564457, 0.0087478868663311, -0.0361657589673996, 0.03343571349978447, 0.004700521007180214, 0.01340804435312748, 0.010450495406985283, -0.012153103947639465, -0.021355997771024704, -0.025084124878048897, -0.025142835453152657, 0.01796545833349228, 0.014149266295135021, 0.02236875705420971, -0.02474653720855713, 0.008036020211875439, -0.03954162076115608, 0.006047196686267853, 0.007588351145386696, -0.043299101293087006, 0.004289546515792608, -0.03736932575702667, 0.0024731860030442476, 0.01805352419614792, 0.05533478409051895, 0.015484933741390705, 0.04450267180800438, 0.02462911605834961, 0.00497205788269639, 0.00245300424285233, -0.0009714777697809041, 0.03540252149105072, 0.0005329825798980892, -0.006894831545650959, -0.0026750038377940655, 0.0021814676001667976, -0.027373839169740677, 0.0173489972949028, 0.025788651779294014, -0.07749805599451065, 0.03827934339642525, -0.06358363479375839, -0.031762462109327316, 0.023851200938224792, 0.009731289930641651, 0.02672802284359932, 0.014773067086935043, 0.030059851706027985, 0.003904258133843541, 0.03132212907075882, -0.016659146174788475, 0.012637467123568058, -0.01789207011461258, -0.0012283368268981576, -0.006377444136887789, -0.012916342355310917, 0.03311280533671379, -0.020739536732435226, -0.11677547544240952, -0.015925263985991478, 0.014009828679263592, -0.011800840497016907, -0.00252639246173203, -0.021400030702352524, -0.032026659697294235, -0.019169026985764503, -0.018435142934322357, 0.04274135082960129, -0.03284860774874687, -0.0016227989690378308, 0.007511293515563011, -0.04203682392835617, -0.0008334160083904862, -0.034492503851652145, 0.014215315692126751, 0.027916913852095604, -0.009452414698898792, 0.021238576620817184, -0.0539550855755806, -0.05603931471705437, 0.02458508312702179, -0.018170945346355438, -0.013055779971182346, 0.020768892019987106, -0.03088179975748062, -0.0134520772844553, 0.03416959568858147, -0.01324659027159214, 0.015602354891598225, 0.012446657754480839, 0.023719102144241333, 0.0197561327368021, -0.02201649360358715, -0.015572999604046345, 0.01442814152687788, -0.02876821719110012, 0.003304308746010065, -0.018758051097393036, -0.022823764011263847, 0.008197474293410778, 0.011110990308225155, -0.05069664493203163, 0.027138996869325638, -0.008102069608867168, -0.009239587932825089, -0.00218330230563879, 0.0406864769756794, 0.014692339114844799, 0.0032419285271316767, -0.018625952303409576, 0.014780405908823013, 0.00896071270108223, 0.014156605117022991, 0.02228069119155407, -0.004689512774348259, 0.008491027168929577, 0.027050931006669998, -0.005610536318272352, 0.008263523690402508, -0.009753306396305561, 0.01466298382729292, -0.007536979392170906, 0.016380270943045616, 0.014780405908823013, 0.015866553410887718, 4.446299499250017e-05, -0.014017167501151562, 0.007456252351403236, 0.040891967713832855, 0.01574913039803505, -0.007122335489839315, 0.0011366014368832111, 0.01333465613424778, 0.02477589249610901, -0.020695503801107407, -0.015235412865877151, -0.0090414397418499, -0.013041102327406406, 0.017202218994498253, -0.005269280634820461, -0.0033997134305536747, -0.017246251925826073, 0.0014310720143839717, -0.011022924445569515, -0.02862144075334072, -0.030529536306858063, 0.01759851723909378, -0.0003997369494754821, -0.036576732993125916, -0.03364120051264763, 0.0018805754370987415, -0.030177272856235504, 0.027344483882188797, -0.0012604441726580262, 0.016086718067526817, -0.007573673501610756, -0.14008361101150513, -0.020930346101522446, 0.013907084241509438, 0.021796327084302902, -0.02421814203262329, -0.016365593299269676, 0.03361184522509575, 0.036312535405159, -0.027638036757707596, -0.02686012163758278, -0.021135833114385605, -0.025069447234272957, 0.0025630868040025234, -0.007463591173291206, 0.015572999604046345, -0.047878533601760864, -0.0004657864337787032, -0.04294683784246445, 0.032144080847501755, 0.00047518929932266474, 0.009334992617368698, -0.016160106286406517, -0.012101732194423676, -0.008645142428576946, -0.0005912345950491726, -0.018684662878513336, 0.003918935544788837, 0.030646957457065582, -0.00876990333199501, 0.00875522568821907, -0.0178627148270607, -0.027388516813516617, 0.01752512902021408, 0.034463148564100266, -0.025157513096928596, -0.004814273212105036, -0.005746304523199797, -0.027388516813516617, -0.011404543183743954, 0.011595352552831173, 0.004124423023313284, -0.047438204288482666, 0.017290284857153893, -0.012593434192240238, 0.02427685260772705, 0.012505368329584599, 0.020842280238866806, -0.01449419092386961, -0.008234168402850628, -0.023425549268722534, -0.004850967321544886, 0.016556402668356895, 0.001106328796595335, -0.005654569249600172, -0.010648643597960472, -0.0016411460237577558, 0.011529303155839443, 0.003610704792663455, -0.004315232392400503, 0.023557648062705994, -0.012703516520559788, 0.0031667056027799845, 0.007349839434027672, -0.011059618555009365, -0.009357009083032608, -0.03114599920809269, 0.014046522788703442, 0.011778824031352997, -0.01996161974966526, -0.04250650852918625, -0.009210232645273209, 0.03381733223795891, -0.004850967321544886, 0.012960375286638737, -0.0011494443751871586, 0.012321896851062775, 0.012233830988407135, 0.02878289483487606, -0.05360282212495804, 0.0029905736446380615, 0.03625382483005524, -0.03337700292468071, -0.004117084201425314, -0.002065880922600627, 0.01977081038057804, 0.02693350985646248, 0.013841034844517708, 0.021400030702352524, -0.03261376544833183, 0.03255505487322807, 0.047438204288482666, -0.02194310538470745, -0.002058542100712657, -0.010736709460616112, -0.013033763505518436, -0.008505704812705517, 0.0006274700281210244, 0.030382759869098663, 0.004102406557649374, 0.0024915330577641726, 0.036752864718437195, 0.043445877730846405, -0.03490348160266876, -0.04221295565366745, 0.01332731731235981, 0.02884160540997982, -0.0017145343590527773, -0.022999895736575127, 0.0006398543482646346, 0.010237669572234154, 0.028004979714751244, 0.014971215277910233, -0.0003520345489960164, 0.010692676529288292, 0.0004788587102666497, 0.03590156137943268, 0.04007001593708992, 0.008601109497249126, 0.016776567324995995, 0.00980467814952135, 0.019051605835556984, 0.010934858582913876, -0.032408278435468674, 0.0008242424810305238, -0.027080286294221878, -0.002313566394150257, 0.01745174080133438, 0.016615113243460655, -0.015162024646997452, -0.029854364693164825, -0.00885796919465065, 0.028151756152510643, -0.011411882005631924, 0.007969970814883709, 0.01450886856764555, -0.01570509746670723, -0.001754897995851934, 0.025773974135518074, -0.0290911253541708, 0.027828846126794815, 0.006355427671223879, 0.012197136878967285, 0.02898838184773922, -0.008593770675361156, -0.016761889681220055, -0.023484259843826294, -0.0033134822733700275, -0.015514289028942585, -0.015543644316494465, 0.016527047380805016, 0.02435024082660675, -0.008197474293410778, -0.020930346101522446, -0.007573673501610756, 0.005496784579008818, 0.02423281967639923, 0.0032254161778837442, -0.04611721262335777, 0.005005082581192255, -9.311141911894083e-05, 5.7621291489340365e-05, 0.025098802521824837, -0.049757275730371475, -0.0492875874042511, 0.002014509169384837, -0.02206052653491497, -0.014729034155607224, -0.01012024749070406, -0.02198713831603527, 0.00997347105294466, -0.030206628143787384, -0.039189357310533524, 0.034228306263685226, 0.023234738036990166, 0.025186868384480476, 0.02211923711001873, 0.02405668795108795, -0.022647632285952568, 0.01431072037667036, 0.03816192224621773, 0.0035006224643439054, 0.009290959686040878, -0.016057362779974937, 0.019433224573731422, 0.022911829873919487, -0.018640629947185516, 0.007269111927598715, 0.014787744730710983, -0.005361015908420086, 0.032232146710157394, 0.016908666118979454, 0.03325958177447319, -0.010303718969225883, 0.04685109853744507, -0.002841962268576026, -0.032114725559949875, 0.038954515010118484, 0.04045163467526436, -0.0006921435124240816, -0.006219659466296434, -0.04919952154159546, 0.04887661337852478, -0.024893315508961678, 0.02242746762931347, -0.0316450372338295, 0.014215315692126751, 0.00498673552647233, 0.0010512875160202384, -0.030588246881961823, 0.03276054188609123, -0.01441346388310194, 0.013958456926047802, -0.026140915229916573, 0.0048766531981527805, 0.002260359935462475, 0.009797339327633381, 0.001113667618483305, 0.022941185161471367, -0.03924806788563728, -0.021223898977041245, -0.023631036281585693, -0.002759400522336364, -0.010883485898375511, 0.0067774103954434395, 0.0007591103203594685, 0.007159029599279165, 0.01809755712747574, 0.025069447234272957, -0.016160106286406517, 0.009591852314770222, -0.00885796919465065, 0.004663826897740364, 0.023146672174334526, -0.011309138499200344, 0.007485607638955116, -0.021429385989904404, 0.019345158711075783, 0.006502204108983278, -0.026228981092572212, 0.00893135741353035, 0.047438204288482666, 0.0029226895421743393, 0.010333074256777763, -0.004117084201425314, -0.023513615131378174, -0.03516767919063568, 0.01980016566812992, 0.045207198709249496, -0.012431979179382324, -0.0013329151552170515, -0.01567574217915535, -0.0010173454647883773, 0.047467559576034546, 0.0019099307246506214, 0.02200181595981121, 0.005680255126208067, 0.02461443841457367, 0.052663449198007584, 0.03554929792881012, 0.03563736379146576, -0.014127249829471111, 0.01457491796463728, -0.0021502773743122816, -0.00880659744143486, -0.011507286690175533, -0.009767984040081501, -0.021605517715215683, -0.003940952010452747, -0.00441797636449337, -0.0022621946409344673, -0.004968388471752405, 0.015617032535374165, 0.00890200212597847, 0.025876717641949654, -0.008637803606688976, -0.0285040196031332, 0.0061279237270355225, -0.041244231164455414, -0.004766570869833231, -0.00995879340916872, -0.017275607213377953, 0.005944453179836273, 0.011771485209465027, 0.0061242543160915375, 0.007661739364266396, -0.04444396123290062, -0.018537886440753937, -0.018214978277683258, 0.01348143257200718, -0.004117084201425314, 0.026140915229916573, 0.0292379017919302, -0.006083890795707703, -0.016761889681220055, -0.01994694210588932, 0.0008921266417019069, 0.0070966496132314205, -0.009745967574417591, 0.021532129496335983, -0.015088636428117752, 0.0014824438840150833, 0.031821172684431076, 0.027285773307085037, -0.02678673341870308, 0.024893315508961678, 0.011382526718080044, 0.023572325706481934, -0.06058938801288605, -0.021003734320402145, -0.013092474080622196, -0.003276787931099534, 0.04726207256317139, -0.00363639066927135, -0.017260929569602013, 0.004263860639184713, -0.004652818664908409, -0.022618276998400688, -0.01582251861691475, -0.02206052653491497, -0.015587677247822285, 0.012608111836016178, 0.011940278112888336, 0.021620195358991623, -0.0029832348227500916, -0.01336401142179966, -0.004091398324817419, -0.015323478728532791, -0.002339252270758152, 0.011000907979905605, 0.010589933022856712, 0.031879883259534836, -0.011243089102208614, 0.012189798057079315, 0.014156605117022991, -0.020754214376211166, 0.0039079273119568825, -0.023425549268722534, 0.00992209929972887, -0.0064618405885994434, -0.04400363191962242, 0.023616358637809753, 0.031909238547086716, -0.0029373671859502792, -0.005247264169156551, -0.00504544610157609, 0.03258441016077995, -0.006249014753848314, -0.01792142540216446, -0.0006040775333531201, -0.017128830775618553, 0.07849613577127457, -0.023264093324542046, -0.02229536883533001, 0.008124086074531078, -0.003014424815773964, 0.032261501997709274, 0.021267931908369064, -0.02454105019569397, -0.02477589249610901, 0.001709947595372796, 0.016703179106116295, 0.008586431853473186, 0.00660861749202013, -0.00047518929932266474, 0.022970540449023247, -0.03146890550851822, -0.021444063633680344, 0.009599191136658192, 0.0020273521076887846, 0.030059851706027985, 0.040803901851177216, 0.0269775427877903, -0.022882474586367607, 0.0012677829945459962, -0.003205234417691827, -4.254228406352922e-05, 0.005283958278596401, 0.007581012323498726, 0.0026052850298583508, 0.045618172734975815, 0.00663063395768404, -0.004062043037265539, -0.05736030265688896, 0.012197136878967285, -0.02254488877952099, 0.013143845833837986, -0.009180877357721329, 0.02663995698094368, -0.0358722060918808, -0.003889580490067601, -0.009525802917778492, 0.0008806597325019538, 7.826175533409696e-06, 0.00878458097577095, 0.00441797636449337, 0.009701934643089771, -0.0017053608316928148, -0.0014659315347671509, 0.011199056170880795, -0.021488096565008163, 0.004660157486796379, -0.03381733223795891, 0.028093045577406883, -0.007889242842793465, 0.009562497027218342, -0.016130750998854637, -0.016893988475203514, 0.03751610219478607, 0.010648643597960472, 0.023909911513328552, -0.05997292697429657, -0.00038001383654773235, -0.006208650767803192, -0.011162362061440945, -0.023763135075569153, -0.06434687227010727, -0.02471718192100525, 0.007445244118571281, -0.011088973842561245, 0.041302941739559174, -0.009753306396305561, -1.708571653580293e-05, 0.003896919311955571, 0.006091229617595673, 0.006329741794615984, 0.015117991715669632, 0.005096818320453167, -0.008314895443618298, 0.03390539810061455, 0.034375082701444626, -0.009775322861969471, -0.020401950925588608, -0.04872983694076538, 0.002977730706334114, 0.0055371480993926525, -0.0008467176230624318, 0.04215424507856369, 0.008402961306273937, -0.011316477321088314, 0.016908666118979454, 0.011676079593598843, 0.006557245273143053, 0.028078367933630943, 0.0268307663500309, -0.002040195045992732, -0.010802758857607841, 0.00733149191364646, -0.0133053008466959, 0.013165862299501896, -0.009569835849106312, 0.00449136458337307, -0.013951118104159832, -0.029458068311214447, -0.0010925685055553913, -0.036694154143333435, 0.004311562981456518, -0.04194875806570053, -0.012498029507696629, -0.0027428881730884314, 0.03792707994580269, 0.012967714108526707, 0.0030529536306858063, 0.02013775147497654, 0.010237669572234154, 0.0004875735903624445, 0.010655982419848442, -0.005849048495292664, 0.023601680994033813, 0.015484933741390705, -0.043622009456157684, 0.028283854946494102, -0.0027887558098882437, 0.027461905032396317, 0.017275607213377953, -0.01798013597726822, -0.009767984040081501, -0.000982485944405198, -0.01802416890859604, 0.023895233869552612, -0.016849955543875694, -0.04808402061462402, -0.01792142540216446, -0.021634873002767563, 0.03525574505329132, 0.021605517715215683, 0.012336574494838715, 0.023264093324542046, -0.016938021406531334, -0.006215989589691162, -0.016512369737029076, 0.01000282634049654, 0.04517784342169762, -0.016864633187651634, 0.019169026985764503, -0.010949536226689816, -0.006960880942642689, 0.00028208631556481123, -0.009775322861969471, 0.016248172149062157, 0.007911259308457375, -0.0006958129233680665, 0.0028970034327358007, 0.0009058869327418506, 0.004843628499656916, -0.03393475338816643, -0.004961049649864435, -0.0029006728436797857, -0.001560418982990086, 0.010545900091528893, 0.0008600192377343774, 0.007056286092847586, -0.007940615527331829, 0.0027300450019538403, 0.02254488877952099, 0.0346979945898056, -0.015073958784341812, -0.02643446996808052, 0.0033868704922497272, 0.016512369737029076, -0.018787406384944916, 0.014765728265047073, 0.012864970602095127, 0.01999097503721714, -0.001454923185519874, -0.01428870391100645, -0.03152761608362198, -0.03390539810061455, 0.015881231054663658, -0.0001901215873658657, 0.022809086367487907, -0.027858201414346695, -0.011375187896192074, 0.05190021172165871, -0.003355680499225855, -0.018684662878513336, 0.014971215277910233, 0.0015191379934549332, 0.01733431965112686, -0.004678504541516304, 0.01329796202480793, 0.011771485209465027, -0.025348322466015816, 0.0037134485319256783, 0.00016512369620613754, 0.01748109608888626, 0.0036455641966313124, -0.004443662241101265, 0.030764378607273102, 0.022970540449023247, 0.016556402668356895, -0.013657564297318459, -0.028239822015166283, 0.0406864769756794, -0.006542567629367113, -0.01542622223496437, 0.036723509430885315, 0.0099881486967206, 0.0058563873171806335, -0.0017989309271797538, -0.008454333059489727, 0.006058204919099808, -0.00902676209807396, 0.018743373453617096, 0.0354318767786026, 0.016350915655493736, -0.011257766745984554, 0.01781868189573288, -0.01322457380592823, -0.049845341593027115, -0.013642886653542519, -0.016204139217734337, 0.0005834370385855436, 0.011808179318904877, 0.028034335002303123, -0.02424749732017517, 0.027960946783423424, 0.005716949235647917, -0.018288366496562958, -0.0009696430643089116, 0.040980033576488495, 0.011617369018495083, 0.005320652388036251, 0.0006765484577044845, 0.002425483660772443, -0.002396128373220563, -0.007845209911465645, 0.008256184868514538, -0.004917016718536615, 0.00725076487287879, -0.00358501891605556, -0.05703739449381828, 0.02878289483487606, 0.003761150874197483, 0.04200746864080429, -0.021429385989904404, 0.07374057173728943, 0.014993231743574142, -0.0008485523285344243, -0.019535968080163002, 0.020710181444883347, -0.0033024740405380726, 0.020519372075796127, -0.0031593667808920145, -0.03493283689022064, 0.017143508419394493, -0.05512929707765579, -0.008226829580962658, -0.0004185427096672356, -0.006524220574647188, 0.014031845144927502, 0.0007224161527119577, -0.011272444389760494, 0.007588351145386696, 0.015572999604046345, -0.007896581664681435, 0.03622446954250336, -0.01996161974966526, 0.027241740375757217, -0.001020097522996366, -0.021033089607954025, -0.03833805397152901, 0.0007348004728555679, -0.0441797636449337, -0.028107723221182823, 0.03132212907075882, 0.038954515010118484, 0.02462911605834961, -0.01809755712747574, 0.015969296917319298, 0.0014053861377760768, 0.06164617836475372, 0.0002894251374527812, -0.025788651779294014, -0.0077718221582472324, -0.00395929953083396, 0.02426217496395111, -0.025539131835103035, -0.0027080285362899303, -0.0025484091602265835, -0.0032254161778837442, -0.0014879480004310608, 0.016688501462340355, 0.021326642483472824, -0.027153674513101578, -0.011404543183743954, 0.01431805919855833, 0.00985604990273714, 0.00502342963591218, -0.013180539943277836, 0.004832620266824961, -0.019506612792611122, -0.0180828794836998, 0.011367849074304104, 0.01331997849047184, 0.024893315508961678, 0.04241844266653061, 0.0033428375609219074, 0.0580354742705822, 0.00031396435224451125, 0.0035042918752878904, 0.012894325889647007, 0.029927752912044525, -0.0008861638489179313, 0.00506012374535203, 9.035935363499448e-05, 0.029971785843372345, 0.0010522048687562346, 0.023102639243006706, -0.026170270517468452, 0.04042227938771248, -0.009122166782617569, 0.009423059411346912, -0.027931591495871544, -0.0007228748290799558, 0.006322402972728014, 0.015220735222101212, -0.00875522568821907, 0.011940278112888336, 0.02477589249610901, -0.002493367763236165, 0.03331829234957695, -0.015895908698439598, 0.030764378607273102, 0.007933276705443859, 0.0015815180959179997, -0.012784243561327457, -0.011881567537784576, -0.006252684164792299, 0.04015808179974556, -0.014398786239326, -0.036752864718437195, 0.01761319488286972, 0.012241169810295105, 0.000461199670098722, -0.02688947692513466, 0.016233494505286217, -0.017246251925826073, 0.034609925001859665, -0.0014145596651360393, 0.011426559649407864, 0.04655754193663597, 0.010589933022856712, 0.040950678288936615, 0.0010870643891394138, 0.004271199461072683, 0.0006265526753850281, 0.018669985234737396, -0.010920180007815361, -0.0392187125980854, 7.367498255916871e-06, -0.03613640367984772, -0.02442362904548645, 0.01544089987874031, 0.007536979392170906, 0.02238343469798565, 0.03813256695866585, -0.0018402119167149067, -0.025392355397343636, -0.00033391680335626006, 0.00869651511311531, -0.030177272856235504, 0.01762787252664566, -0.0029685571789741516, -0.009151522070169449, -0.012321896851062775, 0.01429604273289442, -0.029604844748973846, 0.004256521817296743, 0.002350260503590107, -0.006135262548923492, 0.02479057013988495, -0.01978548802435398, 0.023396193981170654, -0.012241169810295105, -0.008322234265506268, 0.016057362779974937, -0.012872309423983097, -0.009643224067986012, -0.0016117907362058759]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
", R., Ramesh, A., Ziegler, D. M., Wu,
J., Winter, C., Hesse, C., Chen, M., Sigler, E., Litwin, M.,
Gray, S., Chess, B., Clark, J., Berner, C., McCandlish,
S., Radford, A., Sutskever, I., and Amodei, D. Language
models are few-shot learners. In Advances in Neural In-
formation Processing Systems 33: Annual Conference on
Neural Information Processing Systems 2020, NeurIPS
2020, December 6-12, 2020, virtual , 2020.
Chen, C., Borgeaud, S., Irving, G., Lespiau, J., Sifre, L., and
Jumper, J. Accelerating large language model decoding
with speculative sampling. ArXiv preprint , 2023.
Chen, M., Tworek, J., Jun, H., Yuan, Q., de Oliveira Pinto,
H. P., Kaplan, J., Edwards, H., Burda, Y ., Joseph, N.,
Brockman, G., Ray, A., Puri, R., Krueger, G., Petrov,
M., Khlaaf, H., Sastry, G., Mishkin, P., Chan, B., Gray,
S., Ryder, N., Pavlov, M., Power, A., Kaiser, L., Bavar-
ian, M., Winter, C., Tillet, P., Such, F. P., Cummings, D.,
Plappert, M., Chantzis, F., Barnes, E., Herbert-V oss, A.,
Guss, W. H., Nichol, A., Paino, A., Tezak, N., Tang,
J., Babuschkin, I., Balaji, S., Jain, S., Saunders, W.,
Hesse, C., Carr, A. N., Leike, J., Achiam, J., Misra,
V ., Morikawa, E., Radford, A., Knight, M., Brundage,
M., Murati, M., Mayer, K., Welinder, P., McGrew, B.,
Amodei, D., McCandlish, S., Sutskever, I., and Zaremba,
W. Evaluating large language models trained on code.
ArXiv preprint , 2021.
Cobbe, K., Kosaraju, V ., Bavarian, M., Chen, M., Jun, H.,
Kaiser, L., Plappert, M., Tworek, J., Hilton, J., Nakano,
R., et al. Training verifiers to solve math word problems.
ArXiv preprint , 2021.Geng, S., Josifoski, M., Peyrard, M., and West, R. Grammar-
constrained decoding for structured NLP tasks without
finetuning. In EMNLP , 2023a.
Geng, S., Josifoski, M., Peyrard, M., and West, R. Grammar-
constrained decoding for structured nlp tasks without
finetuning. In Proc. of EMNLP , 2023b.
Gerganov, G. and et. al. llama.cpp: Port of facebook’s
llama model in c/c++. URL https://github.com/
guidance-ai/guidance .
Jiang, A. Q., Sablayrolles, A., Mensch, A., Bamford, C.,
Chaplot, D. S., Casas, D. d. l., Bressand, F., Lengyel, G.,
Lample, G., Saulnier, L., et al. Mistral 7b. ArXiv preprint ,
2023.
Jiang, A. Q., Sablayrolles, A., Roux, A., Mensch, A., Savary,
B., Bamford, C., Chaplot, D. S., de Las Casas, D., Hanna,
E. B., Bressand, F., Lengyel, G., Bour, G., Lample, G.,
Lavaud, L. R., Saulnier, L., Lachaux, M., Stock, P., Sub-
ramanian, S., Yang, S., Antoniak, S., Scao, T. L., Gervet,
T., Lavril, T., Wang, T., Lacroix, T., and Sayed, W. E.
Mixtral of experts. ArXiv preprint , 2024.
Kudo, T. and Richardson, J. SentencePiece: A simple and
","[-0.00831497274339199, 0.041174598038196564, 0.026704581454396248, -0.0019390275701880455, 0.001064860261976719, 0.019711244851350784, -0.008428256027400494, 0.032504670321941376, -0.04754865542054176, 0.02025500312447548, 0.026765000075101852, -0.04510174319148064, -0.0296197310090065, 0.029468687251210213, -0.03537450730800629, 0.021357623860239983, 0.04863617196679115, 1.0915289749391377e-05, 0.005037317983806133, 0.04498090595006943, -0.0022505559027194977, -0.024967575445771217, -0.0011866395361721516, -0.002571524353697896, 0.04401422664523125, 0.009100401774048805, -0.011645493097603321, 0.04111418128013611, 0.013699691742658615, -0.024680592119693756, 0.032383836805820465, -0.034679707139730453, -0.024544652551412582, -0.0035457583144307137, -0.033320311456918716, 0.025405602529644966, 0.020813865587115288, 0.010542872361838818, -0.03283696994185448, 0.0035155494697391987, -0.012476235628128052, -0.057155054062604904, -0.019137276336550713, 0.014349181205034256, -0.03748912364244461, 0.015466907061636448, -0.015920039266347885, 0.01755131408572197, 0.019847184419631958, 0.038878727704286575, -0.052321646362543106, 0.04634030535817146, -0.03292759507894516, -0.023834746330976486, -0.06247180327773094, -0.0200586449354887, -0.01658463291823864, 0.02389516308903694, 0.02155398018658161, -0.02739938348531723, -0.018457578495144844, -0.06579477339982986, 0.005252555478364229, 0.04425589740276337, -0.05975301191210747, -0.03927144408226013, -0.04510174319148064, -0.007869393564760685, 0.001474567223340273, 0.05265394225716591, -0.009598847478628159, 0.010716572403907776, 0.037791211158037186, -0.02735407091677189, -0.040781885385513306, -0.012113730423152447, -0.0051694815047085285, 0.0905659943819046, -0.013269216753542423, -0.019514886662364006, -0.01006708387285471, 0.01224966999143362, 0.02037583850324154, -0.07244070619344711, -0.031024441123008728, -0.028230126947164536, -0.018427370116114616, 0.0401172898709774, -0.05265394225716591, -0.005951134022325277, -0.0270368792116642, -0.017158599570393562, -0.04863617196679115, -0.005569748114794493, 0.08494715392589569, 0.017808089032769203, -0.014500225894153118, -0.008080855011940002, 0.05189872533082962, 0.01523278933018446, -0.03034474328160286, -0.009326968342065811, 0.018336743116378784, -0.03664327785372734, 0.0389089398086071, -0.008760552853345871, -0.007382276467978954, -0.02397068589925766, -0.012385609559714794, 0.014598404057323933, -0.10712041705846786, 0.0003058641159441322, -0.03679432347416878, -0.015353623777627945, 0.010980899445712566, -0.03292759507894516, -0.03640160709619522, -0.015036432072520256, -0.024846740067005157, 0.015323415398597717, -0.01892581582069397, 0.012181700207293034, 0.03652244433760643, -0.03392448648810387, 0.025556648150086403, -0.03905998170375824, 0.013306978158652782, -0.06700312346220016, -0.018140386790037155, -0.025314977392554283, -0.014998670667409897, -0.026734789833426476, 0.026493120938539505, -0.00641559436917305, -0.03126611188054085, -0.027414489537477493, -0.04232253134250641, -0.002193914260715246, -0.038878727704286575, 0.026613956317305565, 0.04951222985982895, -0.005562196020036936, -0.03159840777516365, 0.0031171708833426237, -0.03797246515750885, -0.015398937277495861, -0.031900495290756226, 0.004504887852817774, -0.029891610145568848, 0.017385166138410568, -0.005985118914395571, -0.009017327800393105, -0.019061755388975143, 0.0019900049082934856, -0.05609774589538574, -0.046672601252794266, -0.026900939643383026, 0.05718526244163513, 0.034558869898319244, -0.06428433209657669, 0.012619727291166782, 0.0519893504679203, 0.019394051283597946, 0.02821502275764942, 0.04887784272432327, 0.03558596968650818, -0.02167481556534767, 0.015429146587848663, -0.05455709993839264, -0.044165268540382385, 0.006883830763399601, -0.019756557419896126, -0.0049391393549740314, -0.00937983300536871, -0.01256686169654131, -0.04579654708504677, -0.01268769707530737, -0.04482986405491829, -0.031205693259835243, -0.07950957119464874, -0.011464240960776806, 0.010520216077566147, -0.03637139871716499, 0.029952028766274452, -0.05020703002810478, -0.0406610481441021, 0.012763218954205513, 0.04637051373720169, -0.005316749215126038, 0.047880951315164566, 0.01153976283967495, 0.02990671433508396, 0.09382854402065277, 0.038637060672044754, 0.008632165379822254, -0.026613956317305565, 0.06664062291383743, -0.022701915353536606, 0.009168371558189392, -0.003961129114031792, -0.00978765171021223, 0.034166157245635986, -0.03812351077795029, -0.043681930750608444, 0.016131501644849777, -0.014356733299791813, 0.005599956959486008, -0.00885873194783926, -0.06102178245782852, -0.019152380526065826, 0.051022667437791824, 0.02537539415061474, 0.057034220546483994, -0.006245669908821583, -0.04540383070707321, 0.019107067957520485, -0.04504132643342018, -0.0013537319609895349, -0.018835188820958138, 0.024151938036084175, -0.022082634270191193, 0.03760996088385582, 0.03316926583647728, 0.02025500312447548, -0.02696135640144348, 0.01641848497092724, 0.03606931120157242, -0.021282101050019264, 0.04745803028345108, -0.01998312398791313, 0.05189872533082962, -0.02747490629553795, -0.025813423097133636, -0.024680592119693756, -0.01602577045559883, -0.041778773069381714, -0.009326968342065811, -0.019182590767741203, 0.003904487704858184, -0.010104844346642494, 0.006170148029923439, -0.004580409731715918, 0.022928481921553612, 0.028063977137207985, 0.01714349538087845, 0.052563317120075226, -0.04479965567588806, -0.06651978194713593, 0.04570591822266579, 0.01144158374518156, 0.02312483824789524, -0.014915596693754196, -0.009198580868542194, 0.0009950024541467428, -0.025964466854929924, -0.002560195978730917, -0.038516223430633545, -0.013820527121424675, -0.05047890916466713, -0.011592628434300423, -0.05180809646844864, 0.009538429789245129, -0.013571305200457573, 0.006744115147739649, -0.007125501520931721, -0.014447360299527645, -0.045736126601696014, 0.040540214627981186, 0.016116395592689514, -0.02182585932314396, -0.011192361824214458, -0.009712129831314087, 0.01743047870695591, -0.0036061757709831, -0.04244336858391762, -0.013586409389972687, 0.012551757507026196, 0.05392271280288696, -0.020481567829847336, 0.02829054370522499, 0.002203354611992836, 0.031870286911726, 0.04794137179851532, 0.02013416774570942, -0.013163485564291477, 0.057487353682518005, 0.015210132114589214, -0.03256509080529213, -0.038576640188694, 0.01602577045559883, 0.03338072821497917, 0.005188361741602421, 0.007786319125443697, -0.0330786406993866, 0.016962243244051933, 0.008382942527532578, 0.03676411509513855, 0.00015930423978716135, 0.016886720433831215, -0.03909019008278847, 0.05032786726951599, -0.0010101068764925003, 0.02243003621697426, -0.017521105706691742, -0.0038931595627218485, 0.05543315410614014, -0.03313905745744705, -0.010157709941267967, 0.026523329317569733, -0.023290986195206642, 0.00743514159694314, -0.019469574093818665, -0.029831193387508392, 0.005362062714993954, -0.014772105030715466, -0.06192804500460625, 0.04631009325385094, -0.018049759790301323, 0.030646830797195435, -0.03785163164138794, -0.012521549127995968, -0.010633498430252075, -0.007571081165224314, 0.004010218661278486, -0.03483074903488159, 0.05404355004429817, -0.012400713749229908, 0.010112396441400051, 0.012287430465221405, -0.017037764191627502, 0.016403380781412125, 0.030933814123272896, 0.023789431899785995, 0.012884054332971573, 0.0005225178902037442, -0.031054649502038956, -0.04893825948238373, 0.04954243823885918, 0.027973352000117302, 0.01462861243635416, -0.09618482738733292, -0.004421813413500786, -0.013442917726933956, 0.0008486785809509456, -0.017460688948631287, 6.64357648929581e-05, -0.009674369357526302, 0.018578413873910904, 0.05093204230070114, 0.03854643180966377, -0.0013971570879220963, -0.04313817247748375, 0.015225236304104328, -0.008956910111010075, 0.006574190687388182, 0.003107730532065034, 0.0011517106322571635, -0.014379390515387058, -0.0001335795532213524, 0.0007358675356954336, -0.02061750739812851, 0.014915596693754196, -0.007061307784169912, 0.012868950143456459, 0.002254331950098276, 0.014228345826268196, -0.02138783223927021, -0.006683697458356619, -0.013767661526799202, -0.04754865542054176, 0.014281211420893669, 0.04383297264575958, -0.03785163164138794, 0.01045224629342556, -0.03313905745744705, -0.01480986550450325, -0.025979571044445038, 0.0313265286386013, -0.007159486413002014, 0.03999645635485649, -0.0004533680621534586, 0.00888138823211193, -0.0014320861082524061, -0.02836606651544571, 0.006234341766685247, 0.01776277646422386, -0.004546424839645624, 0.013941362500190735, 0.0017728791572153568, -0.012982233427464962, -0.005248779430985451, 0.0035457583144307137, -0.018306534737348557, 0.018019551411271095, 0.03606931120157242, 0.018306534737348557, 0.006362729240208864, 0.022414932027459145, 0.026055091992020607, 0.02179565094411373, -0.006162595935165882, -0.002658374607563019, -0.017898716032505035, 0.013760109432041645, -0.0023638387210667133, 0.053530000150203705, 0.04875700920820236, 0.057155054062604904, -0.004999557044357061, 0.008972014300525188, 0.040449585765600204, -0.05325812101364136, 0.03797246515750885, -0.012355400249361992, -0.005562196020036936, -0.04274545609951019, 0.019862288609147072, 0.026281658560037613, 0.0437423475086689, 0.05646025389432907, -0.009372280910611153, -0.03232342004776001, -0.034075528383255005, -0.046823643147945404, -0.03078277036547661, 0.018578413873910904, 0.01851799711585045, -0.05896758288145065, 0.028456691652536392, -0.03733808174729347, -0.014734343625605106, 0.02030031569302082, 0.05972280353307724, -0.043681930750608444, -0.028819197788834572, -0.06404266506433487, 0.0361599363386631, 0.05014661327004433, 0.007246336434036493, -0.01998312398791313, -0.01694713905453682, 0.02804887294769287, -0.027187922969460487, 0.027263443917036057, -0.014794761314988136, -0.003468348179012537, -0.004833408631384373, -0.005535763222724199, -0.0018153602723032236, -0.030208803713321686, 0.020768551155924797, -0.023880058899521828, 0.06126345321536064, -0.004418037366122007, 0.005751000717282295, -0.03942248970270157, 0.10005155205726624, 0.002582852728664875, 0.06361974030733109, -0.0009190084529109299, 0.04434652253985405, 0.03794225677847862, -0.0464913472533226, 0.007238784339278936, -0.0038402939680963755, 0.04180898517370224, -0.03017859347164631, 0.009213685058057308, 0.03558596968650818, 0.02107064053416252, 0.009281654842197895, 0.0030850740149617195, -0.038516223430633545, -0.03712661936879158, -0.025617064908146858, -0.005856731906533241, -0.002224123105406761, -0.04830387607216835, -0.031205693259835243, -0.016207022592425346, 0.007155710365623236, -0.022263888269662857, 0.04637051373720169, 0.018699249252676964, 0.011751224286854267, 0.040540214627981186, 0.028637945652008057, -0.005362062714993954, 0.0051468247547745705, 0.015874726697802544, -0.00879831425845623, -0.017747672274708748, 0.03534429892897606, -0.019107067957520485, 0.010852512903511524, -0.002969902940094471, 0.0073784999549388885, -0.019665930420160294, 0.007431365549564362, -0.04809241369366646, -0.017083078622817993, -0.0009152323473244905, -0.006766771897673607, 0.02397068589925766, -0.04301733523607254, 0.004761662799865007, 0.01755131408572197, 0.012294982559978962, 0.007741005625575781, 0.045856963843107224, 0.007000890094786882, -0.017808089032769203, 0.02732386253774166, 0.0011687030782923102, 0.02049667201936245, 0.022535767406225204, -0.03316926583647728, 0.011872059665620327, -0.013692139647901058, 0.021538875997066498, 0.004776766989380121, -0.025934256613254547, 6.60227524349466e-05, -0.029393164440989494, 0.017853403463959694, -0.01321635115891695, 0.0017955356743186712, -0.04183919355273247, -0.016932034865021706, 0.0043500675819814205, 0.02481653168797493, -0.0006173924193717539, 0.002463905606418848, -0.015202580019831657, -0.07666993886232376, -0.0011960797710344195, 0.0050561982207000256, -0.013291873037815094, -0.04322879761457443, -0.009991561993956566, -0.0033777218777686357, 0.025526437908411026, -0.004784319084137678, -0.0002824995026458055, 0.007816527970135212, 0.002233563456684351, 0.012959576211869717, -0.028668154031038284, -0.007442693691700697, 0.04123501479625702, 0.04833408445119858, -0.054255008697509766, 0.017158599570393562, -0.009984008967876434, 0.0021693697199225426, -0.007801423314958811, 0.00036958581767976284, -0.0005480065592564642, -0.021765442565083504, -0.0007240672712214291, 0.028109291568398476, -0.01933363452553749, 0.013163485564291477, 0.01517237164080143, -0.031900495290756226, -0.021856069564819336, 0.013057755306363106, -0.02102532610297203, 0.0037817645352333784, 0.037670377641916275, -0.021372728049755096, -0.03265571594238281, 0.0055848523043096066, 0.003759108018130064, 0.006283430848270655, -0.04939139261841774, -0.006762995850294828, 0.010354067198932171, -0.01617681421339512, -0.0007863729260861874, -0.03836518153548241, -0.030918709933757782, 0.00808840710669756, -0.012974681332707405, -0.04845492169260979, 0.009334520436823368, 0.015678368508815765, 0.028562422841787338, -0.04552466794848442, 0.0031454917043447495, 0.043681930750608444, -0.014945805072784424, -0.011902268044650555, -0.03256509080529213, -0.018744561821222305, -0.01162283681333065, 0.036703694611787796, -0.043923597782850266, -0.05507064610719681, 0.018366951495409012, 0.012793428264558315, -0.0018852180801331997, -0.016327857971191406, 0.01872945763170719, 0.012023103423416615, -0.020481567829847336, -0.015300759114325047, 0.004603066481649876, 0.008760552853345871, -0.004995780996978283, -0.009478012099862099, 0.014288763515651226, 0.014651269651949406, -0.02623634599149227, -0.029680149629712105, -0.01499111857265234, -0.032867178320884705, -0.020934700965881348, 0.026900939643383026, -0.024182146415114403, -0.00275844126008451, -0.027338966727256775, 0.01581430807709694, 0.0037005783524364233, -0.005856731906533241, 0.02522435039281845, -0.0022486678790301085, -0.011758776381611824, -0.03377344086766243, 0.0034419153816998005, -0.009470460005104542, -0.01002932246774435, 0.03812351077795029, 0.00016685643640812486, 0.0003339488757774234, 0.019016440957784653, -0.008186585269868374, -0.01416037604212761, 0.0023071973118931055, -0.034317199140787125, 0.007684364449232817, 0.0029944477137178183, 0.010059531778097153, -0.03401511162519455, 0.013171037659049034, -0.013918706215918064, 0.00266403891146183, 0.011449136771261692, -0.007423813454806805, -0.01800444722175598, -0.019560199230909348, -0.05262373387813568, 0.02990671433508396, -0.007620170712471008, 0.01018791925162077, -0.025571752339601517, -0.008956910111010075, -0.0309942327439785, 0.007975123822689056, -0.02122168429195881, -0.06059885770082474, 0.03082808293402195, -0.01422079373151064, 0.011109286919236183, -0.006838517729192972, 0.04250378534197807, 0.03159840777516365, 0.03905998170375824, 0.012294982559978962, 0.004693692550063133, -0.004508663900196552, 0.013503334484994411, 0.04229232296347618, -0.0029850073624402285, 0.008896492421627045, -0.041506893932819366, 0.02377432771027088, -0.020315419882535934, 0.006589295342564583, 0.02073834277689457, -0.05476855859160423, 0.035253673791885376, -0.07056776434183121, -0.009674369357526302, 0.006717682350426912, -0.006483564153313637, 0.01711328700184822, -0.006290983408689499, 0.016282545402646065, 0.0005012773326598108, 0.01289160642772913, -0.027338966727256775, 0.011464240960776806, -0.018699249252676964, 0.012000447139143944, -0.01127543579787016, -0.028622841462492943, 0.028698362410068512, -0.0014622948365285993, -0.11787474900484085, -0.03265571594238281, 0.0033229682594537735, -0.014862731099128723, 0.000489005004055798, -0.014696582220494747, -0.020345628261566162, -0.019378947094082832, 0.026085302233695984, 0.051747679710388184, -0.012423370033502579, -0.003896935610100627, -0.006071969401091337, -0.016932034865021706, 0.03344114497303963, -0.02594936266541481, -0.00355519843287766, 0.020723238587379456, 0.020224792882800102, 0.0032229016069322824, -0.049089305102825165, -0.06639894843101501, 0.017158599570393562, -0.004542648792266846, -0.019635722041130066, -0.002720680320635438, -0.030163489282131195, 0.003081297967582941, 0.009123058058321476, -0.013178590685129166, 0.003068081568926573, -0.0043689482845366, 0.021327415481209755, 0.021055536344647408, -0.026810312643647194, -0.010142605751752853, 0.0044331420212984085, -0.022898273542523384, 0.019378947094082832, -0.04510174319148064, -0.004282097797840834, -0.019016440957784653, -0.01523278933018446, -0.007808975409716368, 0.029680149629712105, -0.004591737873852253, -0.0021788098383694887, 0.03265571594238281, 0.0013480678899213672, -0.006147491279989481, -0.0004755526315420866, -0.03640160709619522, 0.015965351834893227, -0.010641050525009632, -0.002620613668113947, -0.010965795256197453, -0.030239012092351913, -0.011486897245049477, 0.005131720565259457, -0.02440871298313141, -0.01629764959216118, 0.024438921362161636, 0.022581079974770546, 0.011147048324346542, 0.027127504348754883, 0.028139499947428703, 0.003524989588186145, 0.014454912394285202, -0.012695249170064926, -0.006366505287587643, 0.03002754971385002, -0.004705021157860756, -0.025360289961099625, 0.020451359450817108, 0.029287435114383698, 0.036099519580602646, -0.027067087590694427, -0.005849179346114397, 0.03555576130747795, -0.008730344474315643, 0.023260777816176414, -0.012763218954205513, -0.002116504358127713, 0.029468687251210213, -0.028381170704960823, -0.023411821573972702, -0.018170595169067383, -0.04156731441617012, -0.012725458480417728, 0.0016983011737465858, -0.03325989097356796, -0.03709641098976135, -0.005664150696247816, -0.005346958059817553, 0.004833408631384373, 0.02119147591292858, 0.01578409969806671, 0.00586050795391202, -0.09189517796039581, -0.007582409773021936, 0.015127058140933514, 0.011396271176636219, -3.410290810279548e-05, -0.02732386253774166, 0.009432698599994183, 0.05395292118191719, 0.006498668808490038, -0.02203732170164585, 0.02832075208425522, -0.008760552853345871, -0.008095959201455116, 0.006834741681814194, 0.022565975785255432, -0.06760729849338531, 0.017173703759908676, -0.03010307252407074, 0.035163044929504395, 0.002533763414248824, -0.004727677442133427, -0.000879359373357147, 0.02788272500038147, 0.007197247352451086, -0.02255087159574032, 0.004867393523454666, -0.013609065674245358, 0.015708576887845993, 0.00127632194198668, 0.024106625467538834, -0.037307873368263245, -0.03470991551876068, 0.023185256868600845, 0.04552466794848442, -0.05180809646844864, 0.005150600802153349, -0.010142605751752853, -0.027308758348226547, -0.02037583850324154, -0.02631186693906784, 0.01484762690961361, -0.04990494251251221, -0.0018550093518570065, -0.014862731099128723, 0.03661306947469711, 0.012106177397072315, 0.017702357843518257, 0.004251888953149319, 0.011841850355267525, 0.007944915443658829, 0.012053312733769417, -0.00430853059515357, -0.011086630634963512, 0.023638388141989708, 0.001129998010583222, -0.014175481162965298, 0.016131501644849777, 0.005751000717282295, 0.03848601505160332, 0.024031102657318115, -0.006664817221462727, -0.012083521112799644, 0.007884497754275799, 0.014152823947370052, -0.03773079439997673, -0.021115953102707863, -0.010406932793557644, 0.034649498760700226, -0.02042115107178688, -0.04685385525226593, -0.04984452575445175, 0.053046658635139465, 0.016599737107753754, 0.02392537146806717, 0.01012750156223774, 0.0014660710003226995, 0.021040432155132294, 0.03567659482359886, -0.048001788556575775, 0.0027848740573972464, 0.02348734438419342, -0.03760996088385582, 0.008571747690439224, -0.0024695696774870157, -0.013171037659049034, 0.03208174929022789, 0.02517903782427311, 0.010482454672455788, -0.02020968869328499, 0.0322025828063488, 0.04600800573825836, -0.015361175872385502, 0.012174147181212902, -0.004897602368146181, 0.021976904943585396, 0.009092849679291248, -0.010097292251884937, 0.008398047648370266, 0.014832522720098495, 0.01008974015712738, 0.05537273734807968, 0.056309208273887634, -0.02647801674902439, -0.009228789247572422, 0.013609065674245358, 0.018472682684659958, 0.007620170712471008, -0.016720572486519814, -0.000634856871329248, -0.007370947860181332, 0.010467350482940674, 0.029045764356851578, -0.01307285949587822, -0.007688140496611595, -0.0200586449354887, 0.00937983300536871, 0.03452866151928902, 0.022505559027194977, -0.005422479938715696, 0.026055091992020607, 0.01141892746090889, 0.027006668969988823, -0.014047093689441681, -2.9368031391641125e-05, -0.015950247645378113, -0.007801423314958811, 0.01585962250828743, 0.026689477264881134, -0.020708134397864342, -0.011411375366151333, 0.014258555136620998, 0.0036005116999149323, -0.010429589077830315, 0.0026489344891160727, 0.010301201604306698, 0.010021770372986794, -0.0006669537397101521, 0.03156819939613342, -0.040328752249479294, 0.024786323308944702, 0.028788989409804344, -0.003328632563352585, 0.014137719757854939, 0.00017464463599026203, -0.0008024213020689785, -0.012740562669932842, -0.02090449258685112, -0.023759223520755768, -0.015950247645378113, -0.0011054533533751965, 0.029831193387508392, -0.016811199486255646, -0.017098182812333107, 0.009281654842197895, 0.007801423314958811, -0.007639050949364901, -0.016977347433567047, -0.04395380988717079, -0.021176371723413467, 0.03217237442731857, 0.0079675717279315, 0.029604626819491386, -0.033713024109601974, -0.0313265286386013, 0.038757894188165665, -0.035042211413383484, -0.024589965119957924, -0.03628077358007431, -0.03996624797582626, 0.030677039176225662, -0.028698362410068512, -0.008065750822424889, 0.04479965567588806, 0.024892054498195648, 0.013858288526535034, 0.02119147591292858, 0.009863174520432949, -0.024665487930178642, 0.017641941085457802, 0.028396274894475937, 0.021840965375304222, -0.017641941085457802, -0.021856069564819336, 0.015587742440402508, 0.006585518829524517, 0.0011026213178411126, 0.003509885398671031, -0.012589518912136555, -0.010958243161439896, 0.04365171864628792, -0.005818970501422882, 0.01641848497092724, 0.004346291534602642, 0.04827366769313812, 0.010920482687652111, -0.04624967649579048, 0.015935143455863, 0.027671264484524727, -0.006570414640009403, -0.02764105424284935, -0.0025054425932466984, 0.02792803756892681, -0.007038651034235954, -0.0014481345424428582, -0.04881742596626282, 0.022671706974506378, -0.0071481578052043915, -0.022747227922081947, -0.008307420648634434, 0.007548424880951643, -0.030601518228650093, 0.0072614410892128944, -0.02684052102267742, 0.020164376124739647, 0.008911596611142159, -0.0029661268927156925, -0.004455798305571079, 0.03295780345797539, -0.03712661936879158, -0.03830476105213165, -0.006842293776571751, 0.002433696761727333, -0.040087081491947174, 0.00937983300536871, 0.00281885894946754, 0.00749555928632617, -0.009938696399331093, -0.014243450947105885, 0.006853622384369373, -0.0018974904669448733, -0.00472012534737587, 0.01711328700184822, 0.005501778330653906, -0.03063172660768032, 0.010792095214128494, -0.018669040873646736, 0.0018814420327544212, -0.01860862225294113, -0.0035929596051573753, -0.008662374690175056, 0.04035896062850952, 0.007771214470267296, -0.016237230971455574, 0.00010602582187857479, 0.0019258111715316772, -0.003687361953780055, 0.028743676841259003, 0.023713910952210426, -0.003111506812274456, -0.011773880571126938, 0.011766328476369381, -0.012717906385660172, 0.03869747743010521, -0.0038421822246164083, 0.024544652551412582, -0.0032172375358641148, -0.0009931144304573536, 0.04936118423938751, 0.04014749825000763, 0.04205065220594406, -0.02167481556534767, 0.020572194829583168, 0.0008982399012893438, -0.008949358016252518, 0.010014218278229237, -0.028350962325930595, -0.0309942327439785, 0.01614660583436489, -0.0011790873249992728, 0.008753000758588314, -0.05664150416851044, 0.014198137447237968, 0.0014821194345131516, 0.01702266000211239, 0.012597071006894112, -0.01462861243635416, 0.009191028773784637, -0.02752021886408329, 0.010014218278229237, 0.013714796863496304, -0.0342869907617569, -0.015950247645378113, -0.0009893382666632533, 0.0019135389011353254, 0.020149271935224533, -0.030163489282131195, -0.032867178320884705, -0.02336650900542736, 0.03410573676228523, -0.03271613270044327, 0.011471793055534363, 0.0006103122141212225, -0.019288320094347, -0.0032738789450377226, -0.011162152513861656, 0.006611951626837254, -0.0011696470901370049, -0.003406042465940118, 0.03362239897251129, -0.0406610481441021, 0.022143052890896797, 0.026417598128318787, 0.02889472059905529, -0.01218925230205059, 0.009153267368674278, 0.0016831967514008284, 0.018170595169067383, -0.04927055910229683, -0.02380453608930111, -0.004108397290110588, -0.0022014665883034468, 0.026130614802241325, 0.02404620684683323, -0.008707687258720398, -0.004814527928829193, -0.019394051283597946, -0.00625322200357914, -0.03909019008278847, 0.0035457583144307137, -0.01590493507683277, -0.004629499278962612, -0.014402046799659729, 0.003957353066653013, 0.0005734952283091843, -0.0003476372512523085, -0.002490338170900941, 0.009931144304573536, -0.017626836895942688, 0.014115063473582268, 0.013971571810543537, 0.02110084891319275, -0.007952467538416386, 0.012030655518174171, 0.02990671433508396, -0.00761639466509223, 0.008080855011940002, -0.027248339727520943, -0.021282101050019264, -0.011011108756065369, -0.030495787039399147, 0.03026922047138214, 0.01523278933018446, -0.007824080064892769, 0.0006707298452965915, 0.008775657042860985, 0.004323634784668684, -0.0047805430367589, 0.015346071682870388, 0.0025960688944905996, -0.03196091204881668, 0.08259087055921555, 0.023094629868865013, -0.0014632388483732939, 0.01776277646422386, -0.015104401856660843, 0.020360732451081276, -0.02167481556534767, -0.00017830274009611458, -0.0026564865838736296, 0.0017275658901780844, 0.0045577529817819595, 0.01410751137882471, -0.021538875997066498, -0.0031228349544107914, 0.0034551317803561687, -0.01743047870695591, -0.009772547520697117, 0.006460907869040966, -0.025330081582069397, 0.016856512054800987, 0.007771214470267296, 0.027776993811130524, 0.00420657591894269, -0.02708219178020954, -0.006781876087188721, 0.001376388594508171, 0.006460907869040966, 0.011018660850822926, 0.008103511296212673, 0.05815194547176361, -0.005441360641270876, -0.010218127630650997, -0.04772990942001343, 0.009387385100126266, -0.016010666266083717, 0.043561093509197235, -0.03990582749247551, 0.020119063556194305, -0.03180987015366554, -0.02906086854636669, 0.012415817938745022, 0.016599737107753754, -0.013767661526799202, -0.002482786076143384, -0.009976456873118877, 0.003120946930721402, -0.014824969694018364, -0.011048870161175728, -0.01714349538087845, -0.016494005918502808, 0.004365172237157822, -0.013548647984862328, 0.02425766922533512, 0.00036014558281749487, -0.013880944810807705, -0.012362952344119549, -0.012868950143456459, 0.054013337939977646, 0.025632169097661972, 0.003938472829759121, -0.03788184002041817, -0.001211184193380177, -0.01646379753947258, -0.006721458863466978, -0.015678368508815765, -0.06192804500460625, -0.014756999909877777, -0.014251003041863441, 0.008133720606565475, 0.029347851872444153, -0.02312483824789524, 0.017324749380350113, -0.0009548813686706126, 0.007299202028661966, 0.01301244180649519, 0.01331453025341034, 0.01827632635831833, 0.01507419254630804, 0.021433144807815552, 0.0278072040528059, -0.020647717639803886, 0.0026734790299087763, -0.017370061948895454, 0.03241404518485069, 0.02437850460410118, -0.02397068589925766, 0.03174945339560509, -0.01885029301047325, -0.0051468247547745705, -0.0023487345315515995, -0.008549091406166553, 0.0012121282052248716, 0.02425766922533512, 0.03259529918432236, -0.01325411256402731, -0.00733318692073226, -0.0072312322445213795, 0.007106620818376541, 0.0254962295293808, -0.005278988275676966, -0.0015623614890500903, -0.008579299785196781, -0.037549540400505066, 0.017944028601050377, -0.02360817976295948, 0.011705910786986351, -0.03437761962413788, -0.012378057464957237, -0.014235898852348328, 0.02392537146806717, 0.015383833087980747, 0.00202210177667439, 0.02445402555167675, 0.008179033175110817, -0.0004547840799205005, -0.0005300701013766229, -0.011841850355267525, 0.008035541512072086, -0.004180143121629953, -0.04129543527960777, 0.042352743446826935, 0.0049013784155249596, 0.03211195766925812, -0.0007854288560338318, -0.01815549097955227, -0.016494005918502808, 0.033471353352069855, -0.019605513662099838, 0.00894180592149496, -0.005554643459618092, -0.028577527031302452, -0.01045224629342556, -0.0030831859912723303, -0.014190585352480412, 0.01309551578015089, 0.02771657705307007, 0.01718880981206894, -0.01952999085187912, -0.020390942692756653, -0.00819413736462593, 0.021976904943585396, 0.029151495546102524, 0.005033541936427355, 0.01803465560078621, 0.0025129946880042553, -0.04422568902373314, 0.0051770335994660854, -0.0063816094771027565, -0.0044331420212984085, 0.013692139647901058, -0.013971571810543537, -0.001544425031170249, -0.02276233397424221, 0.009432698599994183, -0.0024676816537976265, -0.0007353955297730863, 0.0046106185764074326, -0.002352510578930378, 0.0021769218146800995, -0.017808089032769203, -0.01256686169654131, 0.0012725457781925797, -0.0031870286911726, 0.008428256027400494, 0.027792098000645638, -0.025163933634757996, -0.022973794490098953, 0.01776277646422386, 0.01410751137882471, 0.005724568385630846, -0.0005654710112139583, 0.028381170704960823, -0.0004092348681297153, -0.009032431989908218, -0.013533543795347214, -0.029242120683193207, -0.018095072358846664, -0.0001949411816895008, 0.02909107692539692, 0.012279878370463848, -0.019197694957256317, -0.022852959111332893, 0.05162684619426727, -0.01730964332818985, -0.03147757425904274, 0.012642384506762028, 0.01573878712952137, 0.006306087598204613, -0.029151495546102524, -0.01091292966157198, 0.011486897245049477, 0.005505554378032684, -0.0050561982207000256, 0.005475345533341169, 0.0038346298970282078, 0.019197694957256317, 0.012513997033238411, 0.01513461023569107, 0.04047979786992073, -0.005112839862704277, -0.013797870837152004, -0.013473126105964184, 0.017294539138674736, -0.016282545402646065, 0.015021326951682568, 0.006589295342564583, 0.006989561952650547, -0.016962243244051933, -0.025163933634757996, -0.01641848497092724, 0.00653642974793911, -0.017611732706427574, 0.02158419042825699, 0.026462910696864128, 0.016448693349957466, -0.022445140406489372, 0.006215461064130068, 0.022671706974506378, -0.04108397290110588, -0.01827632635831833, 0.0051468247547745705, 0.0023695030249655247, 0.01416792906820774, -0.0007892049616202712, -0.0040290988981723785, 0.030012445524334908, 0.019152380526065826, -0.021282101050019264, -0.024227460846304893, 0.01800444722175598, -0.020768551155924797, 0.00392336817458272, -0.0056679267436265945, -0.007778766565024853, 0.010263441130518913, -0.01345802191644907, 0.01702266000211239, -0.015753891319036484, 0.014734343625605106, 0.0007910930435173213, -0.006789428647607565, 0.03760996088385582, 0.0246201753616333, 0.027097295969724655, -0.04446735978126526, 0.060629066079854965, 0.024151938036084175, 0.01614660583436489, -0.023094629868865013, 0.02094980515539646, -0.005411151796579361, 0.026342075318098068, -0.006951801013201475, -0.047276776283979416, 0.026931148022413254, -0.06032697856426239, -0.007340739015489817, 0.0005229898961260915, 0.007318082731217146, 0.003281431272625923, -0.0022751004435122013, -0.015157266519963741, -0.0049391393549740314, 0.004312306642532349, -0.027051983401179314, 0.0416579395532608, -0.022263888269662857, 0.018835188820958138, 0.0015529212541878223, -0.011977790854871273, -0.007778766565024853, 0.03205154091119766, -0.003961129114031792, 0.00814882479608059, -0.0013036986347287893, 0.03256509080529213, 0.01690182462334633, -0.0047012451104819775, 0.03558596968650818, -0.01875966601073742, 0.04180898517370224, -0.003949800971895456, -0.012038207612931728, -0.0014962797285988927, 0.036824531853199005, 0.0030718576163053513, -0.01496846228837967, -0.014877835288643837, 0.008367838338017464, 0.019726349040865898, 0.002722568344324827, 0.0014962797285988927, 0.029846297577023506, -0.031447362154722214, 0.005535763222724199, 0.02356286719441414, -0.01186450757086277, -0.013510887511074543, 0.007276545278728008, 0.03558596968650818, -0.021372728049755096, -0.029075972735881805, 0.02001333236694336, 0.015617950819432735, 0.01493070088326931, 0.043440259993076324, 0.00906264130026102, 0.034649498760700226, -0.014492672868072987, 0.0230795256793499, -0.0054375845938920975, 0.032383836805820465, -0.010482454672455788, -0.010928034782409668, 0.022822750732302666, 0.0051694815047085285, -0.003398490371182561, 0.024031102657318115, -0.01650911010801792, 0.03498179465532303, -0.009810308925807476, 0.009402490220963955, -0.002054198645055294, 0.003968681674450636, -0.007650379557162523, -0.0014877835055813193, -0.04748823866248131, 0.029121285304427147, 0.032504670321941376, 0.010996004566550255, 0.031205693259835243, 0.00207307911477983, 0.023290986195206642, 0.0035212135408073664, 0.0011611508671194315, -0.0034154828172177076, 0.0019267551833763719, 0.02739938348531723, 0.04168814793229103, -0.02146335504949093, -0.039694368839263916, 0.0014585187891498208, 0.010754333809018135, -0.011471793055534363, -0.00990848708897829, 0.0074615743942558765, 0.0043274108320474625, 0.009266550652682781, 0.012196804396808147, -0.0017898716032505035, 0.03449845314025879, 0.026462910696864128, 0.028592631220817566, -0.002939694095402956, 0.014500225894153118, 0.02631186693906784, 0.007114172913134098, -0.006483564153313637, -0.03070724755525589, 0.003596735652536154, -0.04156731441617012, 0.0009166483650915325, 0.03365260735154152, 0.04051000624895096, 0.010739229619503021, 0.010988452471792698, -0.01141892746090889, 0.0011753112776204944, 0.008488673716783524, -0.009326968342065811, -0.014915596693754196, 0.0032965356949716806, 0.014326524920761585, 0.023381613194942474, -0.01812528260052204, 0.004338739439845085, -0.02918170392513275, -0.008632165379822254, -0.014092406257987022, -0.028622841462492943, 0.011366061866283417, -0.0015028879279270768, 0.005565972067415714, -0.021176371723413467, -0.0120079992339015, 0.02421235479414463, -0.013941362500190735, 0.006056865211576223, -0.017324749380350113]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
"language independent subword tokenizer and detokenizer
for neural text processing. In Proc. of EMNLP , 2018.
Lundberg, S. and Ribeiro, M. T. A. p. The Art of Prompt
Design: Prompt Boundaries and Token Healing.
Lundberg, S., Ribeiro, M. T. A. p., and et. al. Guidance-
ai/guidance: A guidance language for controlling
large language models. URL https://github.com/
guidance-ai/guidance .
McNaughton, R. and Yamada, H. Regular expressions and
state graphs for automata. IRE Trans. Electron. Comput. ,
(1), 1960.
OpenAI. GPT-4 technical report. ArXiv preprint , 2023.
Poesia, G., Polozov, A., Le, V ., Tiwari, A., Soares, G.,
Meek, C., and Gulwani, S. Synchromesh: Reliable code
generation from pre-trained language models. In Proc. of
ICLR , 2022.
Scholak, T., Schucher, N., and Bahdanau, D. PICARD:
Parsing incrementally for constrained auto-regressive de-
coding from language models. In Proc. of EMNLP , 2021.
Sennrich, R., Haddow, B., and Birch, A. Neural machine
translation of rare words with subword units. In Proc. of
ACL, 2016.
Thompson, K. Regular expression search algorithm. Com-
mun. ACM , (6), 1968.
10
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
Tjong Kim Sang, E. F. Introduction to the CoNLL-2002
shared task: Language-independent named entity recog-
nition. In COLING-02: The 6th Conference on Natural
Language Learning 2002 (CoNLL-2002) , 2002.
Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux,
M., Lacroix, T., Rozière, B., Goyal, N., Hambro, E.,
Azhar, F., Rodriguez, A., Joulin, A., Grave, E., and Lam-
ple, G. Llama: Open and efficient foundation language
models. ArXiv preprint , 2023a.
Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi,
A., Babaei, Y ., Bashlykov, N., Batra, S., Bhargava, P.,
Bhosale, S., Bikel, D., Blecher, L., Canton-Ferrer, C.,
Chen, M., Cucurull, G., Esiobu, D., Fernandes, J., Fu,
J., Fu, W., Fuller, B., Gao, C., Goswami, V ., Goyal, N.,
Hartshorn, A., Hosseini, S., Hou, R., Inan, H., Kardas,
M., Kerkez, V ., Khabsa, M., Kloumann, I., Korenev, A.,
Koura, P. S., Lachaux, M., Lavril, T., Lee, J., Liskovich,
D., Lu, Y ., Mao, Y ., Martinet, X., Mihaylov, T., Mishra, P.,
Molybog, I., Nie, Y ., Poulton, A., Reizenstein, J., Rungta,
R., Saladi, K., Schelten, A., Silva, R., Smith, E. M., Sub-
ramanian, R., Tan, X. E., Tang, B., Taylor, R., Williams,
A., Kuan, J. X., Xu, P., Yan, Z., Zarov, I., Zhang, Y ., Fan,
A., Kambadur, M., Narang, S., Rodriguez, A., Stojnic, R.,
Edunov, S., and Scialom, T. Llama 2: Open foundation
and fine-tuned chat models. ArXiv preprint , 2023b.
Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi,
A., Babaei, Y ., Bashlykov, N., Batra, S., Bhargava, P.,
Bhosale, S., et al. Llama 2: Open foundation and fine-
tuned","[-0.01143789105117321, 0.02424776926636696, 0.04051561653614044, -0.013271873816847801, 0.0001807951630325988, 0.002862972905859351, -0.03247969225049019, 0.02284778282046318, -0.04015161842107773, 0.030771708115935326, 0.009946905076503754, -0.044155579060316086, -0.01843782514333725, 0.024373767897486687, -0.00606194231659174, 0.002838473068550229, 0.023281779140233994, -0.0036469653714448214, 0.006299939937889576, 0.04569556564092636, 0.022567786276340485, -0.021223798394203186, -0.034719668328762054, 0.011899886652827263, 0.018941819667816162, -0.006264940369874239, -0.012459881603717804, 0.05009152367711067, 0.0022627285216003656, -0.037127647548913956, 0.03950762376189232, -0.03172370046377182, -0.004469457548111677, -0.01433586422353983, -0.007440929301083088, 0.037883639335632324, 0.014531861990690231, 0.014069866389036179, -0.02414976991713047, 0.011479890905320644, -0.0344676710665226, -0.07795125991106033, 0.008420919999480247, 0.015287854708731174, -0.011535890400409698, 0.026487749069929123, 0.005897443741559982, 0.02794373407959938, 0.022651784121990204, 0.0242757685482502, -0.052359502762556076, 0.03289968892931938, -0.018717821687459946, 0.0059044440276920795, -0.05524347350001335, -0.04768354818224907, 0.0027439738623797894, 0.035195667296648026, 0.0088829156011343, -0.02469576522707939, -0.029007723554968834, -0.03306768462061882, 0.0012284882832318544, 0.01364987064152956, -0.0482715405523777, -0.027005743235349655, -0.08651918172836304, -0.016323845833539963, 0.001734233577735722, 0.019291816279292107, 0.004654955584555864, 0.018171828240156174, 0.0027089742943644524, -0.03763164207339287, -0.028727727010846138, -0.006520438008010387, -0.02042580582201481, 0.0850071907043457, -0.020775802433490753, -0.03194769471883774, 0.006114441901445389, 0.016953838989138603, 0.0014979857951402664, -0.06647136807441711, -0.04093560948967934, -0.024373767897486687, -0.04454757645726204, 0.0077489265240728855, -0.04244759678840637, -0.0510995127260685, -0.0460035614669323, -0.032675690948963165, -0.03329168260097504, 0.01719183661043644, 0.06613536924123764, -0.00416146032512188, -0.001021115342155099, -0.022623784840106964, 0.039003629237413406, 0.05863144248723984, -0.006163441576063633, -0.018619822338223457, 0.011654889211058617, -0.05252750217914581, 0.061935409903526306, -0.012907877564430237, -0.0029872215818613768, -0.026179751381278038, -0.027075743302702904, 0.024023771286010742, -0.12611080706119537, -0.009624908678233624, -0.010660898871719837, 0.019333817064762115, 0.0662473738193512, -0.05896744132041931, -0.0273557398468256, -0.005792445037513971, -0.010065904818475246, 0.0018899820279330015, -0.029651718214154243, 0.014531861990690231, 0.05529947578907013, -0.008336921222507954, 0.003632965497672558, -0.00668843649327755, 0.020705802366137505, -0.0355316624045372, -0.009085914120078087, -0.01903981901705265, 0.024499766528606415, 0.0015924848848953843, 0.025241760537028313, -0.005554447416216135, -0.05714745819568634, -0.034635670483112335, -0.019963810220360756, -0.008210921660065651, -0.03371167927980423, 0.013768869452178478, 0.03634365648031235, -0.009183912537992, -0.04516357183456421, 0.024597765877842903, -0.06311140209436417, -0.017457833513617516, -0.04314759001135826, -0.000766055251006037, -0.0595274344086647, 0.022581785917282104, -0.009757907129824162, -0.018801821395754814, -0.014489862136542797, 0.05037152022123337, -0.03119170293211937, -0.061263419687747955, -0.036007657647132874, 0.058183446526527405, 0.03502766788005829, -0.034607671201229095, 0.007699926849454641, 0.037099648267030716, 0.023029781877994537, 0.016295844689011574, 0.05219150334596634, 0.03233969211578369, -0.020663803443312645, 0.03953562304377556, -0.07380729913711548, -0.02609575167298317, 0.00508895143866539, -0.018003828823566437, -0.04194360226392746, -0.012361882254481316, -0.016211846843361855, -0.04939153045415878, -0.008112923242151737, -0.023309778422117233, -0.03169569745659828, -0.04743155092000961, -0.012557880952954292, 0.03497166931629181, -0.04393158107995987, 0.008007924072444439, -0.040487613528966904, -0.020201807841658592, -0.00831592082977295, 0.028265731409192085, -0.00790992472320795, 0.0273557398468256, 0.005529947578907013, 0.02851772867143154, 0.06803935021162033, 0.03245169296860695, 0.019837811589241028, -0.0392836257815361, 0.0460035614669323, -0.013502871617674828, 0.010086904279887676, -0.0009966155048459768, 0.024429768323898315, 0.03858363255858421, -0.03485966846346855, -0.04020761698484421, 0.014209864661097527, -0.001816482748836279, -0.0077489265240728855, -0.011997886002063751, -0.019179817289114, -0.017303835600614548, 0.04880353808403015, -0.003512216731905937, 0.05143551155924797, -0.0018234826857224107, -0.03617565706372261, -0.0033984677866101265, -0.05655946210026741, -0.0021104798652231693, -0.012277883477509022, 0.018367825075984, 0.006856434978544712, 0.004910453222692013, 0.051127515733242035, 0.025717755779623985, -0.011619889177381992, 0.0234637763351202, 0.024653766304254532, -0.030855705961585045, 0.01721983589231968, -0.019347816705703735, 0.05868744105100632, 0.00394446263089776, -0.0066744363866746426, -0.03802363947033882, -0.020775802433490753, -0.06031142547726631, -0.00857491884380579, -0.015735849738121033, 0.011521890759468079, -0.04314759001135826, 0.008805916644632816, -0.014517862349748611, 0.0394236259162426, 0.03385167941451073, 0.029987715184688568, 0.040291618555784225, -0.029427720233798027, -0.0431755892932415, 0.06820735335350037, 0.03247969225049019, 0.0343276746571064, -0.014314863830804825, 0.014419863000512123, 0.003316218499094248, -0.037211645394563675, 0.010688898153603077, -0.03558766096830368, -0.008273920975625515, -0.02861572802066803, -0.005438948515802622, -0.033431682735681534, 0.021167799830436707, -0.008084923028945923, 0.03933962807059288, 0.0005473073106259108, -0.028783727437257767, -0.05140751227736473, 0.06165541335940361, 0.029091723263263702, -0.01268387958407402, -0.007839925587177277, -0.03676364943385124, -0.01465786062180996, -0.005330449435859919, -0.05963943526148796, -0.0222597885876894, 0.007671927101910114, 0.010877897031605244, -0.01552585233002901, 0.046087563037872314, 0.011528890579938889, 0.015161856077611446, 0.04583556577563286, 0.022735783830285072, -0.0034649670124053955, 0.03861163184046745, -0.002108729910105467, -0.03301168605685234, -0.030015714466571808, -0.024429768323898315, 0.038527633994817734, 0.007965924218297005, 0.023197779431939125, -0.027089742943644524, 0.0019372316310182214, 0.003713464830070734, 0.03768764063715935, 0.025661755353212357, 0.021433796733617783, -0.02098580077290535, 0.029483720660209656, -0.01784983091056347, -0.00047205801820382476, -0.01306887622922659, 0.011871887370944023, 0.04079561308026314, -0.016813840717077255, -0.025745755061507225, 0.030995706096291542, -0.015133855864405632, 0.02171379327774048, -0.008371920324862003, -0.02223178930580616, -0.01270487904548645, -0.014489862136542797, -0.05031552165746689, 0.03301168605685234, -0.029091723263263702, 0.03295568749308586, -0.04132760688662529, -0.011689889244735241, -0.013243874534964561, 0.008014923892915249, 0.0018427325412631035, -0.010247902944684029, 0.04821554198861122, 0.009449910372495651, 0.0012993626296520233, -0.009302911348640919, -0.013789868913590908, 0.032031696289777756, 0.011626889929175377, 0.039591625332832336, 0.032787688076496124, 0.0007192431949079037, -0.04821554198861122, -0.04387558251619339, 0.05359148979187012, 0.05896744132041931, 0.03410367667675018, -0.06619136780500412, 0.0025269759353250265, -0.03572766110301018, 0.0009922406170517206, -0.015455853193998337, 0.008483919315040112, -0.02036980725824833, 0.017345834523439407, 0.041019611060619354, 0.022469786927103996, 0.033347684890031815, -0.03354367986321449, 0.02287578210234642, -0.013439872302114964, -0.010807896964251995, 0.014139865525066853, 0.005298949778079987, 0.002010730793699622, 0.01976781152188778, 0.01649184338748455, -0.03427167609333992, 0.005176450591534376, 0.0026354750152677298, 0.02353377640247345, -0.004402958322316408, 0.0004904328379780054, -0.0015679850475862622, 0.015315854921936989, -0.0059814429841935635, -0.03483166918158531, 0.01493785809725523, 0.008084923028945923, -0.013453871943056583, 0.0021717294584959745, -0.04264359548687935, 0.011738888919353485, -0.03746364265680313, 0.0034579671919345856, -0.001132239238359034, 0.032647691667079926, 0.01647784374654293, -0.004833454266190529, -0.0025112261064350605, -0.014349863864481449, -0.01300587598234415, 0.01915181800723076, -0.005683945957571268, 0.0031849697697907686, 0.010317902080714703, 0.019795812666416168, 0.009750907309353352, -0.014055866748094559, -0.02162979543209076, 0.05482348054647446, 0.019529813900589943, 0.02976371720433235, -0.028335731476545334, 0.016995837911963463, 0.038527633994817734, 0.03947962448000908, 0.011619889177381992, 0.0029889715369790792, 0.00030471585341729224, 0.0013229874894022942, -0.01240388210862875, 0.037239644676446915, 0.002141979755833745, 0.09486310184001923, 0.02532576024532318, 0.030211713165044785, 0.03917162865400314, -0.026319749653339386, 0.021881792694330215, -0.0015924848848953843, 0.009624908678233624, -0.0332636833190918, 0.016827840358018875, 0.014013866893947124, 0.02216178923845291, 0.0460035614669323, 0.0010456150630488992, -0.015189855359494686, -0.027635738253593445, -0.06411939114332199, -0.0171638373285532, 0.0066429367288947105, 0.032115694135427475, -0.05795944854617119, 0.012641879729926586, -0.034607671201229095, -0.02741174027323723, -0.00028043484780937433, 0.04698355495929718, -0.03805163875222206, -0.011843887157738209, -0.05465548112988472, 0.03886362910270691, 0.04936353117227554, 0.021657794713974, -0.04261559620499611, 0.0029399720951914787, -0.008749917149543762, -0.04264359548687935, 0.011360892094671726, -0.009120913222432137, -0.004402958322316408, -0.019417814910411835, -0.016841839998960495, 0.0023204779718071222, -0.04306359216570854, -0.008749917149543762, -0.01703783869743347, 0.05023152381181717, 0.004714454989880323, 0.004346958827227354, -0.01580584980547428, 0.07380729913711548, -0.039087627083063126, 0.05541147291660309, 0.012221883982419968, 0.05076351761817932, 0.016351845115423203, -0.025171760469675064, 6.961652252357453e-05, -0.008945914916694164, 0.007027933374047279, -0.01714983768761158, 0.0018269825959578156, 0.027537738904356956, 0.015287854708731174, 0.005753945559263229, -0.0072449310682713985, -0.020649803802371025, -0.039675623178482056, -0.023295778781175613, 0.027481738477945328, 0.01909581944346428, -0.07139932364225388, -0.02216178923845291, -0.026865744963288307, 0.03558766096830368, -0.012326883152127266, 0.028237732127308846, 0.00457795662805438, 0.027733735740184784, 0.0548514798283577, 0.009666908532381058, 0.021377796307206154, 0.020005809143185616, 0.03634365648031235, 0.020019810646772385, -0.013866867870092392, 0.01586185023188591, -0.016379844397306442, 0.016071846708655357, -0.010779897682368755, -0.0021874792873859406, -0.04381958395242691, -0.015035857446491718, -0.05073551833629608, -0.02797173336148262, -0.014601861126720905, -0.028867725282907486, 0.042251598089933395, -0.025759754702448845, -0.01846582442522049, 0.037771642208099365, 0.0010517400223761797, 0.02928772196173668, 0.025899754837155342, -4.295662438380532e-05, -0.001956481486558914, 0.002745723817497492, 0.009365910664200783, 0.019235817715525627, 0.01784983091056347, -0.03441167250275612, 0.005785445217043161, -0.01969781331717968, 0.007832925766706467, 0.00011845200060633942, -0.019879810512065887, 0.002441226737573743, -0.02794373407959938, 0.011283893138170242, -0.016897838562726974, -0.0008119922713376582, -0.06943933665752411, -0.004112461116164923, -0.004756454844027758, 0.028363730758428574, -0.005358449183404446, 0.010674898512661457, -0.018885821104049683, -0.053703490644693375, -0.017387835308909416, 0.0004917453043162823, -0.014727859757840633, -0.04309159144759178, 0.0002574663085397333, -0.008161922916769981, 0.037939637899398804, 0.024555766955018044, 0.004521957132965326, 0.0014682360924780369, 0.0020177308470010757, 0.018689822405576706, -0.011493890546262264, 0.01646384410560131, 0.04701155424118042, 0.05599946901202202, -0.030827706679701805, 0.018521824851632118, -0.028433728963136673, 0.006226440891623497, -0.013992867432534695, 0.0139788668602705, -0.008497918955981731, -0.0012398632243275642, 0.006033942569047213, 0.015091856941580772, -0.019949810579419136, 0.0010202403645962477, 0.0015286104753613472, -0.02168579399585724, 0.0027212242130190134, 0.007293930742889643, -0.010051904246211052, -0.005085451528429985, 0.01651984266936779, -0.015049857087433338, -0.04071161150932312, 0.006285940296947956, -0.000540307373739779, 0.0111298942938447, -0.045555565506219864, -0.011843887157738209, -0.0037309646140784025, 0.01141689158976078, -0.0008500544354319572, -0.03424367308616638, -0.015063856728374958, -0.01653384231030941, 0.006782935466617346, -0.04454757645726204, 0.004514957312494516, -0.006894934456795454, 0.019319815561175346, -0.032143693417310715, 0.018633823841810226, 0.05510347709059715, -0.020201807841658592, -0.01903981901705265, -0.01908181793987751, -0.053815487772226334, -0.01398586668074131, 0.0331236869096756, -0.04457557573914528, -0.060703422874212265, -0.0006151191773824394, 0.004903453402221203, 0.0002705911756493151, -0.017009837552905083, 0.007573928218334913, 0.002913722302764654, -0.01269087940454483, 0.0013212374178692698, 0.012592880055308342, 0.004126460757106543, 0.016057847067713737, -0.0038814630825072527, -0.002260978566482663, 0.006380439270287752, -0.03693164885044098, -0.012144885025918484, 0.0026337250601500273, -0.02603975310921669, -0.03617565706372261, 0.03819163888692856, -0.02676774561405182, -0.0053724488243460655, -0.020243806764483452, -0.008973915129899979, 0.010310902260243893, 0.015343854203820229, 0.021447796374559402, -0.017457833513617516, -0.004721455276012421, -0.04395958408713341, 0.0010709898779168725, -0.03289968892931938, -0.018213827162981033, 0.05468348041176796, -0.010975895449519157, -0.021909791976213455, 0.016421843320131302, 0.011388891376554966, 0.005463447887450457, 0.017555832862854004, -0.029707718640565872, 0.02931572124361992, 0.009099913761019707, 0.005823944695293903, -0.025731755420565605, 0.019963810220360756, -0.0278877355158329, -0.014685860835015774, -0.008182922378182411, -0.009974905289709568, -0.009085914120078087, -0.013194874860346317, -0.020691802725195885, 0.01520385593175888, -0.0013002376072108746, 0.02798573486506939, -0.015077856369316578, 0.01467186026275158, -0.018549824133515358, -0.006800435483455658, -0.01523185521364212, -0.06294339895248413, 0.008196922019124031, -0.024541767314076424, 0.00697543378919363, -0.018605822697281837, 0.039087627083063126, 0.023995772004127502, 0.043539587408304214, -0.01898382045328617, -0.0018392325146123767, -0.01703783869743347, 0.024541767314076424, 0.027075743302702904, -0.014405863359570503, 0.019487814977765083, -0.022021790966391563, 0.0003580903576221317, -0.027187742292881012, 0.0158198494464159, 0.010086904279887676, -0.056251466274261475, 0.020747803151607513, -0.06406339257955551, -0.012760878540575504, 0.023799773305654526, 0.004206960089504719, 0.06467938423156738, 0.012564880773425102, 0.025073761120438576, -0.016981838271021843, 0.017611833289265633, -0.026235749945044518, 0.02668374590575695, -0.03253569081425667, 0.012221883982419968, 0.022567786276340485, -0.023043781518936157, 0.04782354459166527, -0.018129827454686165, -0.10863896459341049, -0.021223798394203186, 0.0009204912348650396, -0.019837811589241028, -0.004535956773906946, -0.015077856369316578, -0.026459747925400734, -0.0171638373285532, 0.0066464366391301155, 0.05353549122810364, -0.01654784195125103, -0.009085914120078087, 0.008959914557635784, -0.034551672637462616, 0.028447730466723442, -0.03827563673257828, 0.00507495179772377, 0.03309568390250206, 0.005995443090796471, -0.0019109818385913968, -0.040459614247083664, -0.07459129393100739, 0.02554975636303425, 0.004854453727602959, -0.0038219636771827936, -0.0064784386195242405, -0.020607804879546165, 0.008182922378182411, -0.0121378842741251, -0.031471699476242065, 0.015357853844761848, 0.00791692454367876, 0.018955819308757782, 0.007993924431502819, -0.020187808200716972, -0.016799841076135635, 0.008357920683920383, -0.017303835600614548, 0.024359768256545067, -0.028923725709319115, -0.011899886652827263, 0.00040074618300423026, -0.018059829249978065, -0.03438367322087288, 0.02344977669417858, 0.01576385088264942, -0.010121903382241726, 0.019795812666416168, 0.025759754702448845, 0.000997490482404828, 0.012060885317623615, -0.037827640771865845, 0.013516871258616447, 0.00860991794615984, -0.011290892958641052, -0.0013194874627515674, -0.028755726292729378, -0.003755464218556881, 0.0063349399715662, -0.020187808200716972, 0.010373901575803757, 0.018773822113871574, 0.012501881457865238, -0.014279864728450775, 0.024905763566493988, 0.026445748284459114, 0.00020824802049901336, 0.006751435808837414, -0.01786383055150509, -0.0034702171105891466, 0.028405729681253433, -0.022343788295984268, -0.02851772867143154, 0.014783859252929688, 0.03323568403720856, 0.045527566224336624, -0.012921877205371857, -0.00858891848474741, 0.02928772196173668, 0.007195931859314442, 0.023813772946596146, -0.02088780142366886, 0.00044252705993130803, 0.02801373414695263, -0.030687708407640457, -0.008112923242151737, -0.03611965849995613, -0.06613536924123764, 0.0008106798049993813, 0.002561975736171007, -0.04401558265089989, -0.03749164566397667, 0.0023677274584770203, 0.004504457116127014, 0.0217277929186821, 0.008777916431427002, 0.031499702483415604, -0.0028594727627933025, -0.09979104995727539, -0.025605756789445877, 0.00034124674857594073, 0.037939637899398804, 0.021097799763083458, -0.014601861126720905, 0.02609575167298317, 0.05031552165746689, -0.003335468238219619, -0.039115630090236664, 0.03502766788005829, -0.012074884958565235, 0.010268902406096458, -0.0052359504625201225, 0.017681831493973732, -0.07543127983808517, 0.027131741866469383, -0.02724374085664749, 0.057399455457925797, -0.004210459999740124, -0.0006746185827068985, 0.022035790607333183, 0.026949744671583176, 0.05277949944138527, -0.02679574489593506, 0.002029980765655637, 0.0027492239605635405, 0.026851745322346687, -0.01839582435786724, 0.044155579060316086, -0.03754764422774315, -0.02612375095486641, 0.0030047213658690453, 0.0370156466960907, -0.02550775744020939, -0.007038433104753494, -0.012165884487330914, -0.035279665142297745, -0.037211645394563675, -0.014545861631631851, 0.02085980214178562, -0.05840744450688362, 0.003804463893175125, -0.008931915275752544, 0.01139589212834835, 0.004612956196069717, 0.0071749319322407246, -0.01084289699792862, -0.005449448246508837, 0.0064504388719797134, -0.005165950860828161, -0.014867858961224556, 0.01240388210862875, 0.012347882613539696, -0.005771445110440254, -0.0029557219240814447, 0.013313873670995235, -0.0006146816886030138, 0.03219969570636749, 0.04849553853273392, -0.016267845407128334, -0.006691936403512955, -0.009925905615091324, -0.0019302316941320896, -0.02419177070260048, -0.03474767133593559, -0.0008994914824143052, 0.029987715184688568, -0.02479376457631588, -0.04488357529044151, -0.02664174698293209, 0.04510757327079773, -0.0071504320949316025, 0.010793897323310375, 0.006166941486299038, 0.007762926165014505, 0.023757774382829666, 0.030855705961585045, -0.032703690230846405, -0.015707850456237793, 0.021069800481200218, -0.02479376457631588, -0.011738888919353485, 0.0013081125216558576, 0.005886944010853767, 0.014069866389036179, 0.02351977676153183, 0.0040739611722528934, -0.030071714892983437, 0.03231169283390045, 0.053731489926576614, -0.008371920324862003, 0.014314863830804825, -0.009540908969938755, 0.010184903629124165, -0.0031009705271571875, -0.011563889682292938, 0.02549375779926777, 0.017569832503795624, -0.014167865738272667, 0.04577956348657608, 0.04765554890036583, -0.05361948907375336, -0.031023705378174782, 0.025591757148504257, 0.01597384735941887, -0.0035262166056782007, -0.01086389645934105, 0.0047109550796449184, -0.01085689663887024, 0.042867593467235565, 0.02858772873878479, -0.012781878933310509, 0.01958581432700157, -0.027509737759828568, 0.014867858961224556, 0.05207950621843338, 0.021797792986035347, 0.003403717651963234, 0.02546575851738453, 0.008763916790485382, 0.0012836128007620573, -0.026193751022219658, 0.0039724623784422874, -0.026305750012397766, -0.02416376955807209, 0.01908181793987751, 0.03247969225049019, -0.032115694135427475, -0.04339958727359772, 0.016673842445015907, -0.022119790315628052, -0.028293730691075325, -0.008812916465103626, -0.018577823415398598, 0.011052895337343216, 0.022749783471226692, 0.050511520355939865, -0.035307664424180984, 0.021741792559623718, 0.021895792335271835, -0.01713583804666996, 0.021965790539979935, 0.00762292742729187, 0.0007345555350184441, -0.000399871205445379, -0.011052895337343216, -0.035223666578531265, -0.008847915567457676, -0.0039969622157514095, 0.030351711437106133, 1.6433437849627808e-05, -0.02473776414990425, 0.01964181289076805, 0.003214719472452998, -0.01901181973516941, -0.01664584130048752, -0.06081542372703552, -0.015287854708731174, 0.03376767784357071, 0.0018707321723923087, 0.025675756856799126, -0.023939773440361023, -0.01593184843659401, 0.02732774056494236, -0.020117808133363724, -0.014034866355359554, -0.002196229062974453, -0.01042990107089281, 0.019501814618706703, -0.023113779723644257, -0.03690364956855774, 0.029063723981380463, 0.01916581764817238, 0.009694907814264297, 0.006432938855141401, 0.019333817064762115, -0.03569966182112694, 0.013852868229150772, 0.0482715405523777, 0.024961762130260468, -0.0019284816225990653, -0.01777983084321022, 0.004616456106305122, 0.016981838271021843, -0.013446872122585773, 0.009960905648767948, 0.0016686090966686606, 0.004696955438703299, 0.04255959391593933, 0.0027807236183434725, 0.022469786927103996, 0.010471900925040245, 0.03351568058133125, 0.010765898041427135, -0.05291949585080147, 0.03133170306682587, 0.01912381872534752, -0.003387967823073268, -0.01905381865799427, -0.021909791976213455, 0.04141160473227501, 0.009092913940548897, -9.449910430703312e-05, -0.0445195771753788, 0.02349177747964859, -0.004080961458384991, -0.023911772295832634, 0.002343227853998542, 0.03107970394194126, 0.003993461839854717, -0.0015364853898063302, -0.0380796380341053, 0.021769793704152107, 0.017359834164381027, -0.02981971763074398, 0.016211846843361855, 0.019459815695881844, -0.011815887875854969, -0.032759688794612885, -0.02535375952720642, 0.0040319617837667465, -0.01839582435786724, 0.025661755353212357, -0.008490919135510921, 0.017513833940029144, -0.013908867724239826, -0.004717955365777016, -0.011374891735613346, 0.0008255546563304961, -0.0088829156011343, -0.009533909149467945, 0.013754868879914284, -0.0024639766197651625, 0.015273855067789555, -0.015427852980792522, 0.020159808918833733, -0.02928772196173668, 0.0046094562858343124, 0.0029277221765369177, 0.030939705669879913, 0.010597899556159973, 0.0032864687964320183, 0.012592880055308342, -0.013425872661173344, 0.005967443343251944, 0.01712183654308319, 0.027131741866469383, -0.005039952229708433, -0.008714917115867138, 0.014090865850448608, -0.016435842961072922, 0.039787620306015015, -0.007024433463811874, 0.021433796733617783, -0.0015382353449240327, 0.024583766236901283, 0.05417948588728905, 0.03424367308616638, 0.026165751740336418, -0.022651784121990204, 0.016925839707255363, -0.004759954754263163, -0.014475862495601177, -0.006229940801858902, -0.007377929985523224, -0.020131809636950493, 0.011808888055384159, 0.008938915096223354, 0.003428217489272356, -0.04115960747003555, 0.01905381865799427, 0.011654889211058617, 0.010107903741300106, 0.0014691110700368881, -0.018563823774456978, 0.014461862854659557, -0.020523805171251297, 0.020523805171251297, -0.0012118634767830372, -0.027565738186240196, -0.006870434619486332, -0.01210988499224186, 0.006362939719110727, 0.02469576522707939, 0.00038390260306186974, -0.022105790674686432, -0.02294578216969967, 0.04507957026362419, -0.03866763412952423, 0.015581851825118065, 0.01850782334804535, -0.0007428679382428527, -0.011598889715969563, -0.01962781324982643, -0.005634946282953024, 0.002358977682888508, -0.006117941811680794, 0.018745822831988335, -0.041579604148864746, 0.01580584980547428, 0.029119722545146942, 0.019837811589241028, -0.016267845407128334, 0.0008946789894253016, 0.002255728468298912, 0.012781878933310509, -0.058183446526527405, -0.0034212174359709024, -0.014146865345537663, -0.016813840717077255, 0.0341876745223999, 0.010604899376630783, -0.013579870574176311, -0.005396948661655188, -0.02298778109252453, -0.011808888055384159, -0.03303968533873558, -0.0010009905090555549, -0.006558937486261129, -0.0014656110433861613, -0.0017001088708639145, 0.017457833513617516, 0.002449976745992899, 0.0029907214920967817, 0.0040634614415466785, 0.02293178252875805, -0.03110770508646965, -0.00040555864688940346, 0.00761592760682106, 0.024443767964839935, -0.016673842445015907, 0.005638446658849716, 0.010989896021783352, -0.02340777777135372, -0.004857953637838364, -0.025269759818911552, -0.002798223402351141, 0.0072449310682713985, -0.023743774741888046, 0.018927820026874542, 0.030239712446928024, -0.006772435735911131, 1.9304503439343534e-05, 0.00829492136836052, 0.009400910697877407, -0.000829054624773562, -0.007664927281439304, 0.022567786276340485, -0.01972581259906292, 0.061375416815280914, -0.02542375773191452, -0.017415834590792656, 0.0026022251695394516, -0.003463217057287693, 0.046647556126117706, -0.007846925407648087, -0.012760878540575504, -0.014853859320282936, 0.01650584302842617, 0.012613880448043346, 0.011052895337343216, -0.007101432420313358, -0.0005591196822933853, 0.009911905974149704, -0.013992867432534695, -0.019319815561175346, 0.009470909833908081, 0.006233440712094307, 0.014895858243107796, 0.025311758741736412, 0.042839594185352325, 0.0003941837640013546, -0.02476576529443264, -0.0036434654612094164, 0.010233902372419834, -0.012361882254481316, 0.011871887370944023, 0.027719736099243164, 0.05219150334596634, 0.005515947472304106, -0.021657794713974, -0.04132760688662529, 0.01660384237766266, -0.023351777344942093, 0.022567786276340485, -0.028377730399370193, 0.020663803443312645, -0.024583766236901283, -0.01705183833837509, 0.016995837911963463, -0.0007866175146773458, 0.0011514890938997269, 0.013278873637318611, -0.006730435881763697, 4.090586298843846e-05, -0.0228617824614048, -0.008518919348716736, -0.0242757685482502, 0.009463910013437271, 0.008189922198653221, -0.014405863359570503, 0.00916291307657957, -0.014475862495601177, -0.0016187346773222089, -0.029063723981380463, -0.0018339825328439474, 0.03225569427013397, 0.012207884341478348, 0.011759888380765915, -0.035923659801483154, 0.02168579399585724, -0.013425872661173344, -0.008126922883093357, -0.011780887842178345, -0.03726764768362045, -0.015413853339850903, -0.01086389645934105, -0.02094380185008049, 0.03936762735247612, -0.020187808200716972, 0.003566466039046645, -0.010548899881541729, 0.003986462019383907, 0.021657794713974, 0.009288911707699299, 0.014895858243107796, -0.0002250916149932891, 0.028839726001024246, 0.037043649703264236, -0.005697946064174175, 0.023869773373007774, -0.0332636833190918, 0.007713926490396261, 0.021195799112319946, -0.012284883297979832, 0.011360892094671726, -0.02791573479771614, 0.006534438114613295, 0.02543775923550129, -0.003783463966101408, 0.012494881637394428, 0.03578365966677666, 0.03880763053894043, -0.006719936151057482, -0.015035857446491718, -0.01115089375525713, 0.0129708768799901, 0.014559861272573471, -0.004896453581750393, 0.014489862136542797, -0.009911905974149704, -0.032703690230846405, 0.014041866175830364, -0.028755726292729378, -0.020579803735017776, -0.050455521792173386, -0.00366446515545249, 0.0002651224785950035, 0.03743564337491989, 0.015133855864405632, -0.017583832144737244, 0.042867593467235565, 0.012494881637394428, -0.003804463893175125, 0.006058442406356335, -0.027033742517232895, 0.017947830259799957, -0.024513768032193184, -0.0111298942938447, 0.012830877676606178, -0.010674898512661457, 0.03617565706372261, 0.024653766304254532, -0.0011768637923523784, -0.0020754802972078323, 0.03259168937802315, -0.028335731476545334, 0.00732193049043417, -0.006621937267482281, -0.029539719223976135, -0.008525919169187546, -0.016225846484303474, 0.00029618467669934034, 0.020103808492422104, 0.006418939214199781, 0.017653832212090492, -0.017639832571148872, -0.021797792986035347, -0.0013474872102960944, 0.02284778282046318, 0.03939562663435936, 0.004112461116164923, 0.033907677978277206, 0.007391929626464844, -0.026879744604229927, 0.011780887842178345, 0.009764906950294971, 0.013117874972522259, 0.0011803638190031052, -0.013474872335791588, -0.014503861777484417, -0.026585746556520462, 0.021755794063210487, -4.2218347516609356e-05, -0.014895858243107796, -0.014230865053832531, -0.00635593943297863, -0.004087961278855801, -0.000201357455807738, 0.0029469719156622887, 0.010408900678157806, -0.005802944768220186, 0.0028717226814478636, 0.03665165230631828, -0.0272857416421175, -0.02413577027618885, 0.02216178923845291, 0.014349863864481449, 0.013327873311936855, -0.005155451130121946, 0.00668143667280674, -0.01493785809725523, 0.013131875544786453, -0.011255892924964428, -0.037883639335632324, -0.027635738253593445, 0.010240903124213219, 0.021839791908860207, -0.0040984610095620155, -0.017555832862854004, -0.014741860330104828, 0.032871685922145844, -0.030351711437106133, -0.03107970394194126, 0.004920953419059515, -0.00047162052942439914, 0.0047109550796449184, -0.012151884846389294, -0.0038604633882641792, 0.02151779644191265, -0.013558871112763882, -0.013705870136618614, 0.006460938602685928, -0.0046759555116295815, 0.0272857416421175, 0.01365687046200037, 0.025885753333568573, 0.05280749872326851, -0.009393910877406597, 0.009995904751121998, -0.02223178930580616, 0.020621804520487785, 0.006292940117418766, -0.0034492171835154295, 0.02976371720433235, 0.0008452419424429536, 0.0021384796127676964, -0.03236769139766693, -0.004143960773944855, 0.0008316796156577766, -0.004745955113321543, 0.0020334806758910418, 0.008350920863449574, -0.0008662417531013489, -0.02101380005478859, 0.011640889570116997, -0.00959690846502781, -0.02984771691262722, -0.026207750663161278, -0.0065484377555549145, 0.006905434187501669, 0.012508881278336048, -0.010198903270065784, -0.00044930822332389653, 0.00788892526179552, 0.004962952807545662, -0.0065799374133348465, -0.02412177063524723, 0.026249751448631287, 0.007664927281439304, -0.009120913222432137, -0.00011834262841148302, 0.017261836677789688, 0.008994914591312408, -0.000641368911601603, 0.0031639698427170515, -0.001642359420657158, 0.005379449110478163, 0.013495871797204018, -0.007013933267444372, 0.03413167595863342, 0.00731493066996336, 0.03894763067364693, -0.048719536513090134, 0.09407910704612732, 0.017457833513617516, 0.021321797743439674, -0.03511166572570801, 0.01964181289076805, 0.008273920975625515, 0.006383939180523157, 0.005197450518608093, -0.043567586690187454, -0.0020544803701341152, -0.06350339949131012, -0.008952914737164974, 0.001218863413669169, 0.0009231162257492542, 0.00886191613972187, -0.0013081125216558576, -0.025255760177969933, -0.016267845407128334, 0.007440929301083088, -0.004010961856693029, 0.03816363587975502, 0.0032234694808721542, 0.0254097580909729, -0.0011532390490174294, -0.002703724429011345, 0.00956190936267376, 0.00491745350882411, -0.012284883297979832, -0.02595575340092182, -0.009820906445384026, 0.015707850456237793, 0.011773888021707535, 0.0008846165728755295, 0.020033810287714005, -0.03477567061781883, 0.039787620306015015, 0.011206893250346184, -0.004157960414886475, -0.0026547247543931007, 0.003281218931078911, 0.00015257667109835893, -0.025017762556672096, -0.02217578887939453, 0.015273855067789555, 0.007391929626464844, 0.0011864887783303857, 0.008812916465103626, 0.01580584980547428, -0.016673842445015907, -0.003281218931078911, 0.039143629372119904, 0.005806444678455591, -0.009435910731554031, 0.007286930922418833, 0.03256369009613991, -0.016883838921785355, -0.0210558008402586, 0.00182873266749084, 0.032115694135427475, 0.014062866568565369, 0.04065561294555664, -0.0029819717165082693, 0.0382196381688118, -0.014377863146364689, 0.0025164762046188116, -0.0058449446223676205, 0.016379844397306442, -0.015707850456237793, -0.007503928616642952, 0.011752888560295105, 0.02469576522707939, -0.000880679115653038, 0.010422901250422001, -0.032815687358379364, 0.03771563991904259, -0.021461796015501022, 0.0021507295314222574, -0.0018899820279330015, 0.014475862495601177, 0.014104866422712803, 0.0060059428215026855, -0.02668374590575695, 0.019977809861302376, 0.0434555858373642, 0.006562437862157822, 0.026193751022219658, 0.0034194674808532, 0.007524928543716669, 0.026361750438809395, -0.01591784879565239, -0.006677936762571335, 0.003027471248060465, 0.009708907455205917, 0.048635538667440414, -0.017555832862854004, -0.04435157775878906, 0.01339087262749672, -0.012060885317623615, 0.004934953060001135, -0.0006448688800446689, 0.0008373670279979706, -0.02350577712059021, 0.014993857592344284, 0.0078119258396327496, -0.006345439702272415, 0.03443967178463936, 0.02470976486802101, 0.033375684171915054, -0.02085980214178562, 0.01959981396794319, 0.03060370869934559, -0.00395846227183938, -0.01710783690214157, -0.0406276136636734, 0.0034492171835154295, -0.045443568378686905, -0.0032899687066674232, 0.04631156101822853, 0.027551738545298576, 0.02088780142366886, 0.008518919348716736, -0.01597384735941887, -0.019459815695881844, 0.0027002242859452963, -0.014363863505423069, -0.0434555858373642, 0.0133768729865551, 0.027103742584586143, 0.009246911853551865, -0.015553852543234825, -0.0035944657865911722, -0.011780887842178345, -0.030211713165044785, -0.014090865850448608, -0.017345834523439407, 0.02662774734199047, -0.010065904818475246, 0.009295911528170109, -0.025087760761380196, 0.00047205801820382476, 0.019263816997408867, -0.005484447814524174, 0.0058134449645876884, -0.015553852543234825]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" chat models. ArXiv preprint , 2023c.
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones,
L., Gomez, A. N., Kaiser, L., and Polosukhin, I. Atten-
tion is all you need. In Advances in Neural Information
Processing Systems 30: Annual Conference on Neural In-
formation Processing Systems 2017, December 4-9, 2017,
Long Beach, CA, USA , 2017.
Willard, B. T. and Louf, R. Efficient guided generation for
large language models. ArXiv preprint , 2023.
Wolf, T., Debut, L., Sanh, V ., Chaumond, J., Delangue, C.,
Moi, A., Cistac, P., Rault, T., Louf, R., Funtowicz, M.,
et al. Huggingface’s transformers: State-of-the-art natural
language processing. ArXiv preprint , 2019.
11
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
A. Whitespace-Flexible GUIDANCE Programs
In our experiments, we differentiate standard GUIDANCE
programs based on templates and whitespace-flexible GUID -
ANCEWSprograms.
To demonstrate, consider the following example of a simple
template-based GUIDANCE program:
1f""""""{{
2 ""id"": {gen('id', regex='[1-9][0-9] *')},
3 ""description"": ""A nimble fighter"",
4 ""name"": ""{gen('name', stop='""')}"",
5 ""age"": {gen('age', regex='[1-9][0-9] *')},
6 ""armor"": ""{select(['leather', 'chainmail', 'plate'])}"",
7 ""weapon"": ""{select(['sword', 'axe', 'bow'])}"",
8 ""class"": ""{gen('class', stop='""')}"",
9 ""mantra"": ""{gen('mantra', stop='""')}"",
10 ""strength"": {gen('strength', regex='[1-9][0-9] *')},
11 ""items"": [ ""{gen('item', stop='""')}"", ""{gen('item', stop='""'
)}"", ""{gen('item', stop='""')}"" ],
12}}""""""
Listing 1. A standard JSON GUIDANCE program.
Here, we provide a fixed high-level template, with respect
to whitespace and formatting. Only the values of the fields
are generated by the LLM.
In contrast, a whitespace-flexible GUIDANCEWSprogram
for the same task would look as follows:
1nl = ""\\n""
2WS = token _limit(zero _or_more(select([' ', nl])), 16)
3
4f""""""{{{WS}""id""{WS}:{WS}{gen('id', regex='[1-9][0-9] *')}{WS},{WS}""
description"":{WS}""A nimble fighter""{WS},{WS}""name""{WS}:{WS}""
{gen('name', stop='""')}""{WS},{WS}""age""{WS}:{WS}{gen('age',
regex='[1-9][0-9] *')}{WS},{WS}""armor""{WS}:{WS}""{select(['
leather', 'chainmail', 'plate'])}""{WS},{WS}""weapon""{WS}:{WS}
""{select(['sword', 'axe', 'bow'])}""{WS},{WS}"" class"":{WS}""{
gen('class', stop='""')}""{WS},{WS}""mantra""{WS}:{WS}""{gen('
mantra', stop='""')}""{WS},{WS}""strength""{WS}:{WS}{gen('
strength', regex='[1-9][0-9] *')}{WS},{WS}""items"":{WS}[{WS}""{
gen('item', stop='""')}""{WS},{WS}""{gen('item', stop='""')}""{WS
},{WS}""{gen('item', stop='""')}""{WS}]{WS},{WS}}}""""""
Listing 2. A whitespace-flexible JSON GUIDANCE program.
As shown in the snippet, all explicit templated whitespace
is replaced by a {WS} token, using the zero_or_more operator.
Using this approach, all whitespace is now also generated
by the LLM, allowing for more flexible formatting of the
output, and less explicit constraints on the LLM.
Our experiments in §4 demonstrate that the whitespace-
flexible formulation leads to higher task accuracy but also
significantly higher inference time. This is because the pro-
gram leaves more freedom to the LLM on how to concretely
generate the output. At the same time however, inference
becomes less efficient,","[0.012697726488113403, 0.024174518883228302, 0.05808599665760994, -0.001508045825175941, -0.011385221034288406, -0.021931050345301628, -0.001697863102890551, -0.010744230821728706, 0.011545469053089619, 0.0662357360124588, 0.02243468537926674, -0.027989940717816353, -0.01381946075707674, 0.0022110375575721264, -0.0028787364717572927, 0.03519345819950104, 0.013056376948952675, -0.024876555427908897, -0.023503003641963005, 0.02255677990615368, 0.007432443555444479, 0.0312254186719656, -0.026143277063965797, 0.03543764725327492, -0.01579584926366806, -0.01784091629087925, -0.008554177358746529, 0.049478400498628616, 0.027547352015972137, 0.0068486835807561874, 0.04636501520872116, -0.028707239776849747, -0.0020164509769529104, -0.0356513112783432, -0.010599244385957718, 0.0210153479129076, 0.040046676993370056, -0.0007745308103039861, 0.016009513288736343, 0.027181072160601616, -0.008889934979379177, -0.0509130023419857, 0.000194109627045691, -0.014315466396510601, 0.01619265414774418, 0.0547589473426342, -0.009080706164240837, 0.025059696286916733, -0.007619399111717939, 0.04294639825820923, -0.035620786249637604, 0.025624379515647888, -0.0003987116797361523, 0.012728250585496426, -0.05485051870346069, -0.026082228869199753, -0.04508303478360176, 0.01516249030828476, 0.017917225137352943, 0.007211148738861084, 0.022007359191775322, -0.02788310870528221, -0.01910763792693615, 0.0496920645236969, -0.03604811429977417, -0.005829965695738792, -0.025044435635209084, -0.011492053046822548, -0.004658631049096584, 0.01631474681198597, -0.006325970869511366, 0.015360891819000244, 0.0014851533342152834, -0.004025271162390709, -0.01643684133887291, 0.013285301625728607, 0.026601126417517662, 0.04761647433042526, 0.024174518883228302, -0.019779151305556297, 0.012079628184437752, 0.0051851593889296055, -0.045418791472911835, -0.038917310535907745, -0.027822062373161316, 0.025044435635209084, -0.015040396712720394, 0.0021728831343352795, -0.038917310535907745, -0.042366452515125275, -0.03043181076645851, -0.026387464255094528, -0.056865058839321136, 0.0006209600251168013, 0.02240416221320629, 0.005188975017517805, -0.018787141889333725, -0.019840197637677193, 0.0586048923432827, 0.015131966210901737, 0.01617739163339138, -0.018146149814128876, 0.0235793124884367, -0.023106200620532036, 0.05326330289244652, -0.021747909486293793, -0.015368523076176643, 0.004963865038007498, -0.021305320784449577, 0.017871439456939697, -0.10158181190490723, -0.009462248533964157, -0.006638835649937391, 0.041725464165210724, 0.03833736851811409, -0.01471990067511797, -0.04447256773710251, 0.01344554964452982, 0.012896128930151463, 0.002277807332575321, -0.025136005133390427, -0.010812908411026001, 0.03174431622028351, -0.04679234325885773, -0.03400304913520813, -0.0010463796788826585, 0.016970999538898468, -0.02151898480951786, -0.01279692817479372, -0.002821505069732666, 0.0280204638838768, 0.009569080546498299, 0.04880688712000847, -0.04624292254447937, -0.07295088469982147, -0.04984468221664429, -0.018436122685670853, 0.005410269368439913, -0.013415026478469372, 0.06989854574203491, 0.009065444581210613, -0.011240235529839993, -0.023884546011686325, 0.0210153479129076, -0.03757428377866745, -0.014323096722364426, -0.039436209946870804, 0.03711643069982529, -0.05933745577931404, 0.043251633644104004, 0.003559789387509227, 0.023991378024220467, -0.03412514179944992, -0.009172276593744755, -0.017383065074682236, -0.03583445027470589, -0.045144081115722656, 0.041328657418489456, 0.030477596446871758, -0.010713706724345684, -0.03531555458903313, 0.046914439648389816, -0.011774394661188126, 0.0029817528557032347, 0.009653019718825817, 0.0022587303537875414, 0.021335843950510025, 0.006902099587023258, -0.0777125284075737, 0.004704416263848543, -0.004280904307961464, -0.05640720948576927, -0.05918483808636665, -0.03296525403857231, -0.006665543653070927, -0.025395452976226807, -0.01808510348200798, -0.018008794635534286, -0.03299577534198761, -0.06434328854084015, -0.009279107674956322, 0.035620786249637604, -0.041328657418489456, -0.007146286778151989, -0.0381847508251667, -0.016131607815623283, 0.00649384967982769, -0.0006276370259001851, -0.005150820594280958, 0.03378938511013985, 0.002289253519847989, 0.010339795611798763, 0.08497709780931473, 0.021686863154172897, 0.026219584047794342, -0.015841634944081306, 0.07026482373476028, -0.026021182537078857, 0.028844594955444336, 0.0027852586936205626, 0.0203743577003479, 0.04737228900194168, -0.01961127296090126, -0.06092467159032822, -0.0016425395151600242, 0.0002723257930483669, -0.030874401330947876, -0.007852139882743359, -0.03940568491816521, -0.03464403748512268, 0.030096054077148438, -0.00923332292586565, 0.02023700252175331, -0.00401763990521431, -0.05567464977502823, 0.027318427339196205, -0.0007683307630941272, -0.012186460196971893, -0.02853936143219471, 0.03323996439576149, -0.026158537715673447, 0.046914439648389816, 0.044625185430049896, -0.008371037431061268, -0.054697901010513306, 0.004406813066452742, -0.002346484921872616, -0.02637220174074173, -0.0059177204966545105, 0.001213304465636611, 0.06416014581918716, 0.03223269060254097, -0.006226770114153624, -0.05301911383867264, 0.000730176514480263, -0.033819906413555145, -0.022465208545327187, -0.003349941223859787, 0.017749346792697906, -0.013834722340106964, 0.008302359841763973, 0.01298769935965538, 0.049753110855817795, -0.02229733020067215, -0.0089128278195858, 0.016848906874656677, -0.0318664088845253, -0.07063110917806625, 0.05500313267111778, 0.02342669479548931, 0.03937516361474991, -0.021717386320233345, 0.0026650726795196533, -0.021717386320233345, -0.05833018198609352, 0.04135918244719505, -0.03516293689608574, 0.05167608708143234, -0.002520086709409952, -0.009141752496361732, -0.004979126621037722, 0.01605529896914959, -0.017871439456939697, 0.019672319293022156, -0.017367804422974586, 0.006406094878911972, -0.03577340394258499, 0.049356307834386826, 0.010278749279677868, 0.009080706164240837, 0.002441870514303446, -0.006669358815997839, -0.010011669248342514, 0.005585778970271349, -0.04404523968696594, -0.004338135477155447, 0.04282430559396744, 0.025700688362121582, -0.031057540327310562, 0.02281622774899006, -0.0470975786447525, -0.010866323485970497, 0.05259178578853607, 0.011301281861960888, 0.003065692260861397, 0.03552921488881111, -0.010736599564552307, -0.015193013474345207, -0.026799529790878296, -0.039436209946870804, 0.04343477264046669, 0.04279378056526184, 0.055338889360427856, 0.007852139882743359, 0.00739047396928072, 0.05262231081724167, 0.01768830046057701, 0.022938322275877, 0.0024933787062764168, -0.003494927193969488, 0.030645474791526794, 0.005250021815299988, -0.03244635462760925, -0.01605529896914959, 0.0020698667503893375, 0.028371483087539673, 0.0010540104703977704, -0.03192745894193649, 0.009073074907064438, 0.00014796685718465596, 0.022465208545327187, 0.029745034873485565, -0.05884908139705658, -0.0014450913295149803, -0.06348863244056702, -0.056376684457063675, 0.04016876965761185, -0.002224391559138894, 0.02254151739180088, -0.02800520323216915, -0.028722502291202545, -0.012575632892549038, 0.025960136204957962, -0.01311742328107357, -0.006200062111020088, 0.006928807590156794, -0.010652660392224789, 0.012316184118390083, -0.03961934894323349, -0.019977552816271782, 0.01045425795018673, -0.008386299014091492, 0.03937516361474991, 0.0197638887912035, 0.020175956189632416, -0.06709039211273193, -0.03708590939640999, 0.045540884137153625, 0.03461351618170738, 0.024281350895762444, -0.09456143528223038, -0.01924499310553074, -0.04978363588452339, -0.019962292164564133, -0.05958164110779762, -0.016268962994217873, 0.023380910977721214, 0.025700688362121582, 0.04447256773710251, 0.014826732687652111, 0.031057540327310562, -0.007981864735484123, -0.007436258718371391, -0.01922973059117794, -0.009500402957201004, 0.009118860587477684, 0.007443889509886503, -0.051401376724243164, 0.007585060317069292, 0.0023655621334910393, -0.026433248072862625, 0.0007864540093578398, 0.029622942209243774, 0.002678426681086421, -0.023411434143781662, 0.027440520003437996, 0.013216624036431313, -0.003840222954750061, -0.016604719683527946, -0.022312592715024948, 0.02177843265235424, 0.015841634944081306, 0.016101084649562836, -0.025517547503113747, -0.03577340394258499, 0.0033384948037564754, -0.010355057194828987, 0.0331178680062294, 0.004124471917748451, -0.002188144950196147, -0.009973514825105667, -0.013208993710577488, -0.03174431622028351, -0.01565849408507347, 0.0184819083660841, 0.029241399839520454, 0.0007979002548381686, -0.004235119093209505, -0.021595291793346405, -0.0420306958258152, 0.017611991614103317, 0.0034720345865935087, -0.008363406173884869, 0.035712357610464096, 0.044625185430049896, 0.03595654293894768, 0.010065085254609585, -0.0009519479935988784, 0.00126576644834131, 0.014674115926027298, 0.0019182037794962525, 0.020603282377123833, -0.01581111177802086, -0.0018390337936580181, -0.021931050345301628, -0.012247506529092789, -0.0071577331982553005, 0.04673129692673683, 0.011423375457525253, 0.0077071539126336575, 0.043862100690603256, 0.013643952086567879, 0.035468168556690216, -0.017154140397906303, -0.010652660392224789, -0.03360624238848686, 0.015131966210901737, -0.029729774221777916, 0.02023700252175331, 0.03900888189673424, -0.03900888189673424, -0.05195079743862152, 0.00497149582952261, -0.043617911636829376, -0.0165741965174675, -0.009408832527697086, -0.0017903870902955532, -0.04953944683074951, -0.016513150185346603, -0.06641887873411179, -0.052439168095588684, 0.03259897232055664, 0.013552381657063961, 0.0010101331863552332, -0.00866100937128067, -0.0197638887912035, 0.00506306579336524, 0.043007444590330124, 0.018771879374980927, -0.03537660092115402, 0.018558215349912643, 0.0006991762202233076, -0.01768830046057701, 0.01607055962085724, -0.03235478326678276, -0.0369332917034626, -0.017245709896087646, -0.005868120118975639, 0.0140102319419384, -0.03467456251382828, -0.01935182325541973, -0.008165004663169384, 0.05332434922456741, 0.020359095185995102, 0.025120742619037628, -0.008294728584587574, 0.07704101502895355, -0.01683364436030388, 0.024647630751132965, 0.01668102853000164, 0.03504084050655365, -0.008790734224021435, -0.031408559530973434, -0.011850702576339245, -0.034460898488759995, 0.016360532492399216, 0.009553818963468075, -0.01273588091135025, 0.03403357043862343, 0.023213032633066177, 0.00300846085883677, -0.03531555458903313, 0.0184666458517313, -0.011560730636119843, -0.00739047396928072, 0.027211595326662064, -0.0018609723774716258, -0.04917316883802414, 0.013384503312408924, -0.006860130000859499, 0.04035191237926483, -0.026814790442585945, 0.04596821218729019, 0.010782384313642979, 0.021992096677422523, 0.08326778560876846, 0.0037085909862071276, 0.010019300505518913, -0.0024456859100610018, -0.029745034873485565, 0.005234759766608477, -0.01718466356396675, 0.052042365074157715, -0.019321300089359283, 0.04178651049733162, -0.01758146844804287, -0.003365202806890011, -0.009454617276787758, -0.031530652195215225, -0.03391147777438164, 0.006448064465075731, -0.010141393169760704, 0.003004645463079214, 0.04639554023742676, 0.030599690973758698, -0.024159256368875504, 0.03787951543927193, 0.005291991401463747, 0.017169402912259102, 0.012980068102478981, -0.029271923005580902, -0.01707783155143261, -0.008218420669436455, 0.03226321563124657, 0.001753186690621078, 0.04215278849005699, -0.017779869958758354, 0.021946310997009277, -0.008752579800784588, -0.007119578775018454, -0.03864260017871857, 0.03543764725327492, 0.001212350558489561, -0.01287323608994484, -0.005032542627304792, 0.0015891235088929534, -0.014674115926027298, -0.10585508495569229, -0.0019592195749282837, -0.01616213098168373, 0.029500847682356834, -0.00905018299818039, 0.00847786944359541, 0.028951426967978477, -0.07398867607116699, 0.026723220944404602, -0.014689377509057522, -0.004414444323629141, -0.03910045325756073, 0.004395367112010717, -0.008424453437328339, 0.029653465375304222, 0.028554623946547508, 0.024433966726064682, -0.009393570944666862, 0.006287816446274519, 0.004723493475466967, -0.014826732687652111, 0.0010473335860297084, 0.019336562603712082, 0.04322110861539841, -0.0599173977971077, 0.0009910560911521316, -0.038398414850234985, -0.014788578264415264, 0.004525091499090195, 0.020160693675279617, 0.02281622774899006, -0.0017426942940801382, 0.016604719683527946, -0.005585778970271349, 0.0033671106211841106, 0.03375886008143425, 0.009027290157973766, -0.014651223085820675, -0.022709395736455917, 0.01510144304484129, 0.029256662353873253, 0.026723220944404602, 0.009279107674956322, -0.01565849408507347, -0.03656700998544693, 0.03806265816092491, -0.045662980526685715, -0.004734939429908991, -0.0624508373439312, 0.012430647388100624, 0.0050249118357896805, -0.005246206186711788, 0.00041635800153017044, -0.03836788982152939, -0.03388095274567604, -0.030279194936156273, 0.005387376993894577, -0.03659753501415253, -0.01491067185997963, -0.01642157882452011, 0.020481189712882042, -0.022465208545327187, -0.012644310481846333, 0.027150548994541168, -0.006314524449408054, -0.008058172650635242, 0.014712270349264145, -0.03729957342147827, 0.007974233478307724, -0.014567283913493156, -0.01759672909975052, -0.027425259351730347, -0.01235433854162693, 0.01197279617190361, 0.015704279765486717, -0.023380910977721214, 0.001211396767757833, -0.01279692817479372, -0.008325252681970596, -0.022694135084748268, 0.007615583948791027, 0.017230449244379997, -0.0037696375511586666, -0.021595291793346405, 0.021183226257562637, 0.010919739492237568, -0.028127295896410942, -0.05524732172489166, 0.014933564700186253, -0.018283504992723465, -0.0041015795432031155, 0.07160785049200058, -0.03072178363800049, 0.008783102966845036, 0.0023083307314664125, 0.026219584047794342, 0.021946310997009277, 0.034064095467329025, 0.036109160631895065, -0.004341951105743647, -0.0010053638834506273, -0.02686057612299919, 0.008821257390081882, -0.03360624238848686, -0.03971092030405998, 0.028966689482331276, 0.013056376948952675, -0.014521499164402485, 0.014094171114265919, 0.0009266707929782569, -0.013712629675865173, -0.014567283913493156, -0.012186460196971893, -0.003929885569959879, 0.019275516271591187, 0.019061852246522903, -0.024052424356341362, 0.04316006228327751, 0.033423103392124176, -0.03424723446369171, 0.011194449849426746, 0.011881226673722267, -0.01191938016563654, -0.02597539871931076, -0.04801328107714653, 0.025197051465511322, 0.004624292254447937, 0.038917310535907745, -0.035712357610464096, 0.03020288608968258, -0.012896128930151463, -0.007543090730905533, -0.0023693775292485952, -0.033178914338350296, 0.0008980551501736045, 0.0004049117269460112, -0.0047959862276911736, 0.027471043169498444, 0.04761647433042526, -0.001168473158031702, 0.01629948616027832, -0.020710114389657974, 0.012659572996199131, -0.01706257089972496, 0.017642514780163765, 0.019290776923298836, -0.027699969708919525, -0.009500402957201004, -0.012407754547894001, -0.01222461462020874, -0.030645474791526794, -0.005436977371573448, 0.033056821674108505, -0.061718277633190155, 0.029256662353873253, -0.04779961705207825, -0.0007726231124252081, 0.009736958891153336, 0.013239516876637936, 0.0521949827671051, 0.006200062111020088, 0.02826465107500553, 0.010087978094816208, -0.0089128278195858, -0.016116345301270485, -0.003004645463079214, -0.01012613158673048, 0.0369027704000473, 0.02306041494011879, -0.008943350985646248, 0.05326330289244652, -0.042854826897382736, -0.0675787702202797, -0.025059696286916733, 0.020084384828805923, -0.0036799751687794924, -0.015215905383229256, -0.005807073321193457, -0.017047308385372162, 0.0005980675341561437, 0.0007616537623107433, 0.029745034873485565, 0.0010110869770869613, -0.013811830431222916, 0.017550945281982422, -0.021503722295165062, -0.011171557940542698, -0.013537120074033737, -0.007382843177765608, 0.022221021354198456, -0.005650640930980444, -0.018298767507076263, -0.016467364504933357, -0.05747552961111069, 0.02318250760436058, -0.023396171629428864, -0.019596010446548462, -0.011041833087801933, -0.05796390026807785, -0.019718104973435402, 0.007588875945657492, -0.0011026571737602353, 0.005841412115842104, 0.017276234924793243, 0.014437559992074966, -0.01681838370859623, 0.0035254505928605795, -0.005841412115842104, 0.03983301296830177, -0.039192020893096924, -0.0030218148604035378, -0.03552921488881111, -0.021457936614751816, 0.019199207425117493, -0.004193149507045746, -0.012117782607674599, 0.050760384649038315, 0.026799529790878296, 0.02164107747375965, 0.03183588758111, 0.012590895406901836, 0.00630307849496603, -0.0006133291753940284, -0.033178914338350296, 0.016742074862122536, -0.002243468537926674, -0.011759133078157902, 0.007653737906366587, 0.005894828122109175, 0.013369240798056126, -0.015719542279839516, 0.003880284959450364, 0.03046233579516411, -0.0026860577054321766, -0.017093094065785408, -0.001848572283051908, -0.0008847011486068368, -0.003960408736020327, 0.005787996109575033, -0.000486466393340379, -0.007890294305980206, 0.009645388461649418, 0.014117063954472542, -0.011324174702167511, -0.008401560597121716, 0.026005921885371208, -0.028096772730350494, 0.012010950595140457, -0.053538013249635696, -0.02254151739180088, -0.018161412328481674, 0.0026555343065410852, -0.005856673698872328, -0.022098928689956665, 0.005772734526544809, 0.007737677078694105, -0.015505878254771233, -0.006226770114153624, -0.045052509754896164, -0.01692521572113037, 0.0076041375286877155, 0.02254151739180088, -0.0675177201628685, -0.042366452515125275, 0.0184819083660841, -0.008699163794517517, -7.219495455501601e-05, 0.003260278608649969, 0.06379386782646179, 0.013575274497270584, -0.14077383279800415, -0.015643233433365822, 0.020679591223597527, -0.0016444472130388021, -0.02113744243979454, -0.00043471972458064556, 0.0003059492155443877, 0.02878354862332344, -0.009515664540231228, -0.024143995717167854, -0.004952418617904186, -0.02214471437036991, -0.009363047778606415, -0.013422656804323196, 0.0330873467028141, -0.07679682970046997, 0.0203743577003479, -0.05069933831691742, 0.022938322275877, -0.0030771384481340647, -0.021320581436157227, 0.012423016130924225, -0.003592220600694418, 0.015689019113779068, -0.013979708775877953, -0.005143189802765846, 0.008516023866832256, 0.03323996439576149, 0.015566924586892128, 0.029775558039546013, 0.010683183558285236, -0.02460184507071972, 0.03262949362397194, 0.030767569318413734, -0.004677708260715008, -0.018237721174955368, -0.022633086889982224, -0.008714425377547741, 0.008065803907811642, 0.0014441375387832522, 0.015185382217168808, -0.04627344757318497, 0.019000805914402008, 3.2937827199930325e-05, -0.01616213098168373, 0.012697726488113403, 0.01331582572311163, -0.004689154680818319, 0.011431006714701653, -0.017627252265810966, -0.009157014079391956, 0.02153424546122551, 2.974837479996495e-05, -0.009660650044679642, -0.028096772730350494, 0.018542954698204994, -0.014040756039321423, -0.005864304956048727, 0.015605079010128975, 0.037910040467977524, -0.015505878254771233, -0.013544750399887562, -0.0032927098218351603, -0.023457219824194908, -0.003126738825812936, -0.030874401330947876, 0.006749482825398445, 0.015116704627871513, -0.018512431532144547, -0.01516249030828476, -0.026662174612283707, 0.024372920393943787, -0.0019096190808340907, 0.027989940717816353, 0.01439177431166172, 0.023762453347444534, 0.010042192414402962, 0.027806801721453667, -0.009653019718825817, 0.004200780298560858, 0.0037181293591856956, -0.03833736851811409, 0.014841994270682335, 0.003983301110565662, 0.01567375659942627, 0.04175598546862602, 0.031530652195215225, -0.01178965624421835, -0.06226769834756851, 0.03888678923249245, 0.030401287600398064, -0.009698804467916489, 0.0012743511470034719, -0.0254870243370533, -0.02586856670677662, -0.009302000515162945, -0.030798092484474182, -0.003990932367742062, -0.02217523753643036, -0.0165589340031147, 0.04981416091322899, 0.0318664088845253, -0.05326330289244652, -0.06727353483438492, 0.003321325406432152, 0.019580749794840813, -0.01745937392115593, -0.006635020021349192, 0.011171557940542698, -0.029897652566432953, 0.04392314702272415, 0.025807518512010574, -0.025166528299450874, 0.025319145992398262, -0.028722502291202545, 0.0021938681602478027, 0.044655706733465195, 0.02025226317346096, 0.03681119903922081, 0.032660018652677536, 0.02940927818417549, 0.031057540327310562, 0.011682824231684208, -0.02063380554318428, 0.0023693775292485952, 0.009057813324034214, 0.026952145621180534, 0.03974144160747528, -0.013537120074033737, -0.008538915775716305, 0.010446627624332905, 0.019840197637677193, 0.0021309135481715202, -0.007913187146186829, -0.002949321875348687, -0.024128733202815056, 0.02129005827009678, 0.014139956794679165, -0.07234041392803192, 0.009965884499251842, 0.0010711799841374159, 0.0009948714869096875, 0.03327048569917679, -0.02115270309150219, -0.004406813066452742, -0.006169538479298353, 0.029134567826986313, -0.018314028158783913, -0.00719970278441906, 0.025639640167355537, 0.005818519741296768, -0.01796301081776619, -0.012506955303251743, 0.015902681276202202, 0.029882390052080154, 0.03772690147161484, 0.006066522095352411, -0.060833100229501724, -0.022984106093645096, 0.011682824231684208, -0.003952777944505215, 0.021442675963044167, -0.00573076494038105, -0.024372920393943787, 0.007058531977236271, 0.003162985434755683, 0.0033117870334535837, -0.015643233433365822, -0.030035007745027542, 0.019168684259057045, -0.012613787315785885, -0.062084559351205826, 0.050119392573833466, -0.004147364292293787, 0.008371037431061268, 0.011797287501394749, 0.021839478984475136, -0.007024193182587624, 0.024418706074357033, 0.04138970747590065, 0.00681816041469574, 0.04022981598973274, -0.021106919273734093, 0.011156296357512474, 0.043892621994018555, 0.016360532492399216, 0.019183944910764694, -0.021244274452328682, -0.011507314629852772, 0.03885626420378685, 0.015330368652939796, 0.02100008726119995, 0.011690455488860607, 0.028585147112607956, 0.026280632242560387, -0.02635694108903408, 0.018436122685670853, 0.03084387816488743, 0.013964447192847729, -0.02383876033127308, -0.03681119903922081, 0.0407792367041111, -0.004769278224557638, 0.0027890740893781185, -0.0011932734632864594, 0.05466737598180771, 0.017627252265810966, 0.006024552509188652, -0.011858333833515644, 0.019382348284125328, 0.012751142494380474, -0.01629948616027832, 0.0038612077478319407, 0.002291161334142089, 0.00036723443190567195, -0.01733728125691414, 0.0052538369782269, -0.016848906874656677, -0.010385580360889435, -0.03894783556461334, -0.02077116072177887, -0.013582904823124409, -0.005291991401463747, -0.029973961412906647, -0.002525809919461608, 0.004906633403152227, -0.016284223645925522, 0.0254717618227005, -0.025258097797632217, 0.011759133078157902, 0.01668102853000164, -0.010171917267143726, 0.005898643750697374, -0.0051126666367053986, -0.007875032722949982, -0.0016167854191735387, 0.0003171570133417845, 8.382006490137428e-05, -0.029348231852054596, 0.017474636435508728, 0.02470867708325386, 0.0017741716001182795, 0.026814790442585945, 0.009958253242075443, -0.0382152758538723, -0.022449947893619537, 0.020404880866408348, 0.040046676993370056, -0.03632282465696335, -0.01298769935965538, -0.0008956704987213016, -0.0017655869014561176, 0.04471675306558609, -0.027974680066108704, 0.027593137696385384, -0.007470597513020039, 0.03214111924171448, 0.0331178680062294, 0.007981864735484123, 0.03455246984958649, -0.007745308335870504, 0.00439918227493763, 0.01718466356396675, -0.017383065074682236, -0.035346075892448425, 0.008790734224021435, -0.038398414850234985, -0.0032450170256197453, 0.010858693160116673, -0.008561808615922928, -0.019458655267953873, 0.011942273005843163, -0.006451879628002644, 0.004902818240225315, 0.01631474681198597, -0.010278749279677868, -0.00809632707387209, -0.030492858961224556, 0.014597807079553604, 0.026173800230026245, -0.02777627669274807, -0.007928448729217052, 0.004925710614770651, 0.002088943962007761, 0.010767122730612755, 0.0006376525270752609, -0.037269048392772675, 0.014552022330462933, 0.0203743577003479, -0.022953582927584648, 0.01860400103032589, 0.024754462763667107, -0.007337057963013649, -0.011499684303998947, -0.009584342129528522, -0.00809632707387209, -0.010576351545751095, -0.0041969651356339455, 0.028966689482331276, -0.0012991514522582293, 0.032415833324193954, 0.04752490669488907, 0.03555973991751671, -0.04523565247654915, 0.0025105481036007404, 0.016146868467330933, -0.0030408918391913176, -0.05454528331756592, 0.028112035244703293, 0.006345048081129789, -0.015719542279839516, 0.038032133132219315, -0.0031801548320800066, 0.008462607860565186, 0.03778794780373573, -0.019687581807374954, -0.029332969337701797, -0.006146646104753017, 0.015139597468078136, -0.012537479400634766, -0.004025271162390709, -0.005467500537633896, 0.02319777011871338, 0.005715503357350826, -0.013979708775877953, -0.009126490913331509, -0.006673174444586039, -0.01961127296090126, 0.012819820083677769, 0.00032407246180810034, 0.018283504992723465, 0.018680309876799583, -0.020862732082605362, 0.00910359900444746, -0.025120742619037628, -0.036231253296136856, -0.06782295554876328, 0.007283641956746578, 0.007974233478307724, -0.020923778414726257, -0.012728250585496426, 0.027440520003437996, -0.014155218377709389, 0.032293736934661865, 0.009790374897420406, -0.0009667327394708991, -0.022938322275877, -0.0318664088845253, -0.006638835649937391, -0.01605529896914959, 0.08009335398674011, -0.0344303734600544, -0.024556061252951622, -0.012766404077410698, 0.003115292638540268, 0.007554537151008844, -0.006028368137776852, -0.032293736934661865, -0.01820719800889492, 0.0006910684169270098, 0.014376512728631496, 0.000921424594707787, 0.011736240237951279, 0.0006109445821493864, 0.027348950505256653, -0.009889575652778149, -0.011354697868227959, 0.005440793000161648, 0.012140675447881222, 0.007241672370582819, 0.026830052956938744, 0.02942454069852829, -0.004818879067897797, -0.028737764805555344, -0.0038554847706109285, 0.007623214740306139, -0.001700724707916379, 0.017474636435508728, 0.0369027704000473, 0.016391055658459663, 0.005211867392063141, -0.015826374292373657, -0.039283592253923416, 0.005345407407730818, -0.020435404032468796, 0.020099647343158722, 0.00994299165904522, 0.011965165846049786, -0.02075590007007122, -0.03287368267774582, -0.00203743577003479, 0.017352541908621788, -0.007283641956746578, 0.01515485905110836, -0.014895410276949406, 0.018619263544678688, 0.006287816446274519, 0.018634524196386337, 0.02879881113767624, 0.0020355279557406902, 0.011797287501394749, 0.00834051426500082, 0.028096772730350494, 0.0009591018897481263, -0.010026930831372738, -0.054209526628255844, -0.0029817528557032347, 0.02318250760436058, 0.006863945629447699, 0.00563537934795022, -0.0010711799841374159, 0.00924095418304205, -0.0053759305737912655, -0.020450666546821594, -0.01987072080373764, -0.014948826283216476, -0.0024189779069274664, 0.03226321563124657, -0.02241942472755909, 0.04902055114507675, 0.004940972197800875, -0.033453624695539474, -0.006127568893134594, 0.025029173120856285, 0.02344195730984211, 0.023854022845625877, 0.0033308640122413635, -0.004567061085253954, 0.0006772375199943781, 0.0047082314267754555, 0.0019220191752538085, -0.005910089705139399, -0.011064725928008556, 0.0273794736713171, 0.034582991153001785, -0.007783462293446064, 0.010713706724345684, 0.019306039437651634, -0.007920817472040653, 0.033575721085071564, 0.007810170296579599, 0.018695570528507233, 0.018237721174955368, 0.01619265414774418, -0.017795132473111153, 0.0013830907410010695, -0.014407035894691944, -0.019397608935832977, 0.027486305683851242, -0.008378668688237667, 0.017520420253276825, -0.0035712355747818947, -0.0062038772739470005, 0.03986353799700737, -0.020206479355692863, 0.011156296357512474, -0.039955105632543564, -0.010591613128781319, 0.02190052717924118, 0.038673125207424164, -0.018893973901867867, -0.022327853366732597, 0.00710431719198823, 0.010751861147582531, 0.006097045727074146, -0.008378668688237667, -0.010202440433204174, 0.0067761908285319805, 0.001892449683509767, -0.02995869889855385, 0.02663165144622326, 0.007722415495663881, 0.04984468221664429, 0.008966243825852871, -0.009027290157973766, 0.008828888647258282, -0.0011865964625030756, -0.022510994225740433, 0.011820179410278797, -0.013926292769610882, -0.031774841248989105, -0.00828709825873375, -0.008844150230288506, 0.02266361191868782, 0.0034701270051300526, -0.011293651536107063, 0.009492771700024605, -0.029500847682356834, 0.012644310481846333, -0.0030847692396491766, -0.009157014079391956, 0.03543764725327492, -0.006077968515455723, 0.003119108034297824, 0.020557498559355736, 0.0071272095665335655, 0.005906274542212486, 0.005765103735029697, 0.013483704067766666, -0.007207333575934172, -0.02393033169209957, -0.007882663048803806, 0.014819101430475712, 0.013430288061499596, -0.015765326097607613, 0.016726812347769737, -0.02509021945297718, 0.006917361170053482, 0.008134481497108936, 0.017108354717493057, -0.000825085153337568, -0.00478072464466095, 0.01922973059117794, -0.0022606379352509975, 0.0381847508251667, -0.0031858780421316624, -0.013811830431222916, 0.008538915775716305, 0.018832925707101822, 0.0010597336804494262, 0.009637758135795593, -0.0105076739564538, -0.003493019612506032, -0.012041473761200905, -0.003204955020919442, -0.030538642778992653, -0.006127568893134594, 0.020679591223597527, -0.04746386036276817, 0.0026059336960315704, 0.0005766057875007391, -0.006169538479298353, 0.02814255841076374, -0.020710114389657974, -0.02202261984348297, -0.016986262053251266, 0.0010301641887053847, -0.0013716444373130798, -0.01197279617190361, 0.007188256364315748, 0.0165589340031147, -0.023136723786592484, -0.01745937392115593, -0.025013910606503487, 0.007882663048803806, 0.02609749138355255, -0.025059696286916733, -0.004658631049096584, 0.01860400103032589, -0.008203159086406231, 0.009927730076014996, -0.0496920645236969, 0.0028596592601388693, -0.01771882362663746, -0.023335125297307968, -0.005604856181889772, -0.011949904263019562, 0.01553640142083168, 0.010667921975255013, -0.005559070967137814, 0.006604496855288744, -0.003653267165645957, -0.0013477980392053723, 0.053934816271066666, 0.05466737598180771, 0.01184307225048542, -0.003115292638540268, -0.03360624238848686, -0.01797827146947384, -0.01733728125691414, -0.008683902211487293, 0.02434239722788334, -0.014292573556303978, 0.003155354643240571, -0.020816946402192116, 0.020710114389657974, 0.006703697610646486, -0.009187538176774979, 0.001163703971542418, 0.03378938511013985, 0.01235433854162693, -0.00757742952555418, -0.0054331617429852486, 0.008371037431061268, -0.007432443555444479, 0.018649786710739136, -0.0031820626463741064, -0.0041015795432031155, 0.01567375659942627, -0.0039985631592571735, -0.025395452976226807, 0.02751682884991169, 0.013300563208758831, 0.01822245866060257, -0.04547983780503273, 0.07856718450784683, 0.03378938511013985, -0.01832929067313671, -0.0026860577054321766, 0.025883827358484268, 0.029577156528830528, 0.013270040042698383, -0.00401763990521431, -0.022083666175603867, -0.013086900115013123, -0.03665858134627342, -0.007050901185721159, -0.0010082254884764552, -0.0013964447425678372, 0.03336205706000328, 0.008905196562409401, -0.0054713161662220955, -0.0051775285974144936, 0.010942632332444191, -0.017749346792697906, 0.03617020696401596, -0.03504084050655365, 0.012514586560428143, 0.036383870989084244, -0.013109792023897171, -0.0025563333183526993, -0.032415833324193954, -0.015261691063642502, -0.03302630037069321, 0.018405599519610405, 0.01222461462020874, 0.016253700479865074, -0.00068057602038607, 0.022999368607997894, 0.018756618723273277, 0.013292932882905006, 0.03403357043862343, 0.028478315100073814, -0.018436122685670853, 0.026830052956938744, 0.012583264149725437, -0.03093544766306877, 0.003451049793511629, -0.002928336849436164, -0.0013964447425678372, -0.005952059291303158, -0.008546547032892704, 0.022709395736455917, -0.011492053046822548, 0.0016377702122554183, 0.03937516361474991, 0.015856897458434105, 0.010881586000323296, 0.02063380554318428, 0.007665184326469898, -0.020832208916544914, -0.027471043169498444, -0.018420860171318054, 0.02139689028263092, 0.0086075933650136, 0.027791539207100868, -0.021442675963044167, 0.058024950325489044, 0.018039317801594734, 0.005738395731896162, 0.020816946402192116, -0.013147946447134018, -0.002232022350654006, 0.0010816723806783557, -0.004193149507045746, 0.016879430040717125, 0.012644310481846333, 0.0020107277669012547, -0.02446448989212513, 0.0369027704000473, -0.0105076739564538, 0.010927370749413967, 0.0010234871879220009, 0.017169402912259102, 0.03720800206065178, -0.0025391639210283756, -0.0178256556391716, -0.024006640538573265, 0.03192745894193649, 0.017520420253276825, 0.025120742619037628, 0.005749842151999474, 0.016391055658459663, 0.009073074907064438, 0.010248225182294846, -0.02330460213124752, -0.004502198658883572, 0.010904477909207344, 0.056376684457063675, -0.03244635462760925, -0.010141393169760704, -0.002039343351498246, -0.03121015802025795, -0.007791093084961176, -0.016909953206777573, 0.021335843950510025, -0.024556061252951622, -0.007359950337558985, 0.0022014989517629147, 0.00975222047418356, 0.03885626420378685, 0.01922973059117794, 0.04621240124106407, -0.011492053046822548, 0.015337998978793621, 0.0007168225711211562, 0.008973874151706696, -0.03250740095973015, -0.028112035244703293, -0.006604496855288744, -0.04956997185945511, 0.015208275057375431, 0.021702123805880547, 0.016528410837054253, 0.029516110196709633, 0.01898554340004921, -0.01260615698993206, -0.006543450057506561, 0.015841634944081306, 0.018512431532144547, -0.023121461272239685, 0.023747190833091736, 0.02789837121963501, -0.0035616972018033266, 0.017917225137352943, -0.027791539207100868, -0.011514945887029171, -0.038764696568250656, 0.006428987253457308, 0.020984824746847153, 0.014658854342997074, -0.012079628184437752, 0.020481189712882042, -0.019519703462719917, 0.010400841943919659, -0.005555255338549614, -0.016742074862122536, 0.001940142479725182, -0.014002601616084576]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
" as the LLM now also has to generate
all whitespace tokens explicitly and the GUIDANCE runtime
cannot skip over as many tokens as before.Algorithm 3 Model-Based Retokenization
Input: LLM f, Prompt x, Target Text s
Output: f-preferred tokenization of s
1:o←[]
2:while s̸=∅do
3:v←f(x+o) // compute logits
4: t←arg max {v[t]|t∈ V ∧ tprefix of s}
5: o.append (t)
6: s←s[|o|:] // remove prefix tfrom s
7:end while
8:return o
B. Model-Based Retokenization
To demonstrate differences between template-based and un-
constrained generation, we consider the task of naturalizing
a given text under a model-preferred tokenization. This is
the process of converting text to the tokenization a model
would have chosen to represent the same text during genera-
tion, when previously conditioned on some prompt. More
specifically, given a target text s, a tokenized prompt x,
and a model fwith vocabulary V, we re-encode tusing to-
kens from V, such that we greedily maximize the sequence
likelihood assigned by f.
We refer to this process as retokenization . We provide the
procedure for this in Algorithm 3. By greedily choosing the
highest likelihood token that aligns with the target text, we
obtain a tokenization of s, that is consistent with the model’s
preference, when forced to generate sfrom x. This corre-
sponds to applying arg max decoding to f, where the token
distribution of fis always masked such that it produces the
target text s. Put differently, if a model was to generate s
when conditioned on x, it would have produced the token
sequence ounder arg max decoding.
While retokenization allows us to recover the model-
preferred tokenization of a given text, template-based con-
strained generation methods cannot benefit from this, as its
computational overhead is equivalent to the cost of gener-
ating all templated tokens from scratch, thereby negating
the benefits of using a template-based approach in the first
place.
C. Grammars And Prompts
Below we include the grammars and prompts used for each
constraining task from our experiments in Section 4:
1root ::= object
2value ::= object | array | string | number |
3 (""true"" | ""false"" | ""null"") ws
4
5object ::=
6""{"" ws (
7 string "":"" ws value
8("","" ws string "":"" ws value) *
9)? ""}"" ws
12
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
10
11array ::=
12""["" ws (
13 value
14 ("","" ws value) *
15)? ""]"" ws
16
17string ::=
18 ""\\"""" (
19 [^""\\\\] |
20 ""\\ \\"" ([""\\ \\/bfnrt] |
21 ""u"" [0-9a-fA-F]
22 [0-9a-fA-F]
23 [0-9a-fA-F]
24 [0-9a-fA-F]) # escapes
25)*""\\"""" ws
26
27number ::= (""-""? ([0-9] |
28 [1-9] [0-9] *))
29 (""."" [0-9]+)? ([eE] [-+]? [0-9]+)? ws
30
31ws ::= ([ \\ \\ t\\ \\ n] ws)?
32
33#Prompts used forgeneration
34""A JSON file describing a person:""
35""A JSON file of a person John Smith:""
36""A JSON file of a person John Smith with friends""
37""JSON of a person Jane Doe with friends""
38""A JSON person:""
Listing 3. Basic JSON Grammar
1root ::= object
2value ::= object | array | string | number | (""true"" | ""false"" |
""null"") ws
3
4object ::=
5ws ""{"" ws (
6 ""\\""thoughts\\"""" "":"" ws ""["" ws thought (ws "","" ws thought) *
""]"" ws "","" ws
7 ""\\""answer\\"""" "":"" ws number ws
8) ""}"" ws
9
10thought ::=
11 ""{"" ws (
12 ""\\""step\\"""" "":"" ws string "","" ws
13 ""\\""calculation\\"""" "":"" ws string "","" ws
14 ""\\""result\\"""" "":"" ws number
15 ) ""}"" ws
16
17array ::=
18 ""["" ws (
19 value
20 ("","" ws value) *
21 )? ""]"" ws
22
23string ::=
24 ""\\"""" (
25 [^""\\\\] |
26 ""\\\\"" ([""\\\\/bfnrt] | ""u"" [0-","[0.02746732346713543, 0.01686372235417366, 0.02992173284292221, 0.006391116417944431, -0.005677545443177223, -0.009969314560294151, -0.0005235441494733095, 0.018008194863796234, 0.01622943766415119, 0.054052162915468216, 0.012527139857411385, -0.015898505225777626, 0.03574061393737793, 0.003131784964352846, -0.03171427920460701, -0.003798818914219737, 0.02240682765841484, -0.0005274222348816693, -0.04056669771671295, 0.04690955579280853, 0.05278358981013298, -0.004088384099304676, -0.011279252357780933, 0.015581362880766392, -0.01815987192094326, 0.02477850392460823, -0.0061463648453354836, 0.018132293596863747, 0.03579576686024666, -0.009603911079466343, 0.01736012101173401, -0.035409681499004364, -0.012492667883634567, -0.02071080356836319, -0.0010453646536916494, 0.03940843790769577, 0.0292047131806612, 0.017511798068881035, 0.006391116417944431, -0.004415868781507015, -0.011272357776761055, -0.036071546375751495, -0.021414032205939293, -0.0060119242407381535, 0.017953040078282356, 0.0763348862528801, -0.00640835240483284, 0.0038539741653949022, -0.013630244880914688, 0.023137634620070457, -0.034554775804281235, 0.0364852100610733, 0.031190304085612297, 0.012244469486176968, -0.05228719487786293, -0.03659551963210106, -0.040015146136283875, 0.003609222825616598, 0.014147326350212097, -0.0016701704589650035, 0.043048687279224396, -0.049446698278188705, -0.017953040078282356, 0.04437241330742836, 0.00997620914131403, 0.0005002755206078291, -0.023675398901104927, 0.007776892744004726, -0.010320928879082203, 0.030114775523543358, 0.0013176938518881798, 0.033837758004665375, 0.03356197848916054, -0.00019670608162414283, -0.02675030380487442, 0.013071798719465733, 0.033341359347105026, 0.05675476789474487, 0.011417140252888203, -0.048426322638988495, 0.03769862651824951, -0.037781357765197754, 0.022572293877601624, -0.060946568846702576, -0.0017011952586472034, 0.012203102931380272, -0.03761589154601097, -0.009507388807833195, -0.04379328340291977, -0.04917091876268387, -0.05005340650677681, -0.018421858549118042, -0.05736147612333298, 0.016974033787846565, 0.0322934091091156, -0.01299596019089222, -0.041311293840408325, -0.012520245276391506, 0.011492978781461716, -0.019524963572621346, 0.04451030120253563, -0.05578955262899399, -0.006532452069222927, 0.011499873362481594, 0.04892272129654884, 0.027743099257349968, 0.015733039006590843, 0.03287253901362419, -0.018628692254424095, -0.0038505271077156067, -0.05498979985713959, -0.0058671412989497185, 0.002070046029984951, 0.032238252460956573, 0.0374780036509037, -0.03113514743745327, -0.06800644099712372, -0.009066146798431873, -0.0013866379158571362, -0.043048687279224396, 0.0030731824226677418, -0.03949117287993431, 0.02192421816289425, -0.03364471346139908, -0.005046707112342119, 0.026943348348140717, 0.017332542687654495, -0.02258608117699623, -0.024323472753167152, -0.023689188063144684, 0.028032664209604263, -0.007321861572563648, 0.02555067650973797, -0.01712571084499359, -0.0550173781812191, 0.002847390715032816, -0.031079992651939392, 0.01212036982178688, -0.0036368004512041807, 0.05474160239100456, -0.02151055447757244, -0.03430657461285591, -0.014078381471335888, 0.012651239521801472, -0.03028024174273014, -0.009859004057943821, -0.040814898908138275, 0.06006408482789993, -0.054907068610191345, 0.03480297327041626, 0.018228815868496895, -0.0010600152891129255, -0.017856517806649208, 0.03695403039455414, 0.021041734144091606, -0.09144743531942368, -0.018228815868496895, 0.045999493449926376, 0.017208443954586983, 0.013278630562126637, -0.004857110790908337, 0.009293662384152412, 0.027412166818976402, 0.01624322682619095, 0.00247164536267519, 0.0022665366996079683, 0.031466078013181686, 0.041173405945301056, -0.06938532739877701, -0.023675398901104927, 0.0005515526863746345, -0.061222344636917114, -0.06828221678733826, -0.023137634620070457, -0.03789166733622551, 0.003131784964352846, -0.024488938972353935, -0.03554756939411163, -0.018035773187875748, -0.024806080386042595, -0.03640247508883476, 0.0382777564227581, -0.036209434270858765, -0.00963838305324316, 0.0038539741653949022, -0.03414110839366913, -0.0032420954667031765, -0.008459439501166344, 0.0009505665511824191, -0.0008303453214466572, -0.0076252156868577, 0.01312695350497961, 0.08604221791028976, -0.013878444209694862, 0.05198384076356888, -0.06293215602636337, 0.06695849448442459, 0.01762210763990879, 0.007721737492829561, 0.04492396488785744, 0.024723349139094353, 0.025040490552783012, -0.0034868470393121243, -0.05639626085758209, -0.0001206521483254619, 0.03982210159301758, -0.004822638817131519, -0.013781921938061714, -0.019718008115887642, -0.04409663751721382, 0.04393117129802704, -0.009810742922127247, 0.02925986982882023, 0.022930802777409554, -0.01811850443482399, 0.04834359139204025, -0.018173661082983017, -0.0005817157216370106, -0.025426577776670456, 0.039794523268938065, -0.023068690672516823, 0.06745488941669464, 0.07440445572137833, -0.03256918489933014, -0.022655025124549866, 0.022213783115148544, -0.021358877420425415, -0.02934260107576847, -0.010810432024300098, -0.025385212153196335, 0.03758831322193146, 0.028708316385746002, 0.009590121917426586, -0.06646209955215454, -0.00739080598577857, -0.027949931100010872, -0.029149558395147324, 0.0082732904702425, 0.0019942077342420816, -0.02652968280017376, 0.0016494871815666556, -0.01949738711118698, 0.038801729679107666, -0.013402730226516724, 0.026639994233846664, 0.03565787896513939, -0.01516769826412201, -0.010327823460102081, 0.033755023032426834, 0.03251402825117111, 0.040732163935899734, -0.030473284423351288, -0.042386822402477264, 0.007163290400058031, -0.041890423744916916, 0.036071546375751495, -0.021179622039198875, 0.015484841540455818, 0.007128818426281214, -0.006108445581048727, -0.00415043393149972, -0.004284875001758337, -0.01382328849285841, 0.018049560487270355, -0.032045211642980576, 0.019662853330373764, -0.0426625981926918, 0.0037746885791420937, 0.013533723540604115, -0.017704840749502182, -0.027398379519581795, -0.006208414677530527, -0.005115651059895754, -0.01592608354985714, -0.043545082211494446, -0.03816744312644005, 0.027494899928569794, 0.01740148663520813, -0.01758074201643467, 0.05330756679177284, -0.051459863781929016, 0.0037505582440644503, 0.03436173126101494, 0.009204035624861717, -0.01775999553501606, 0.01955254189670086, 0.0038057134952396154, -0.003290356369689107, -0.038443222641944885, -0.030831793323159218, 0.021758751943707466, 0.013285525143146515, 0.041807692497968674, 0.006077420897781849, -0.005929191131144762, 0.000762693933211267, 0.014960866421461105, -0.006708259228616953, -0.00024755235062912107, 0.024406205862760544, 0.05112893134355545, 0.02240682765841484, -0.016643101349473, -0.03336893767118454, -0.022296516224741936, -0.0068461475893855095, -0.002385465195402503, -0.024185584858059883, 0.009624593891203403, -0.009921053424477577, 0.012582295574247837, 0.021951796486973763, -0.024654405191540718, -0.011823910288512707, -0.0236202422529459, -0.06789613515138626, 0.06414557248353958, -0.004112514667212963, 0.013850866816937923, 0.013189002871513367, -0.010969003662467003, -0.014754033647477627, 0.018132293596863747, -0.01931813172996044, 0.012216891162097454, 0.029756266623735428, -0.007611426990479231, 0.02428210712969303, 0.005177700892090797, -0.01718086563050747, 0.0008979967096820474, -0.009066146798431873, 0.02612980827689171, 0.05079800263047218, 0.017511798068881035, -0.08085761964321136, -0.01820123754441738, 0.0410630963742733, 0.03924297168850899, 0.05708570033311844, -0.06502805650234222, -0.015981238335371017, 0.0010479501215741038, -0.0024526857305318117, -0.03353440389037132, -0.005536209791898727, -0.001652934355661273, 0.014740245416760445, 0.03179701045155525, 0.02978384494781494, 0.005198383703827858, 0.012127264402806759, -0.009210929274559021, -0.01861490309238434, -0.01873900182545185, -0.0022096578031778336, 0.00224757706746459, -0.004512390121817589, 0.01618807017803192, 0.034775394946336746, 0.0029577012173831463, 0.05487949028611183, 0.025660987943410873, 0.04042880982160568, -0.008445650339126587, 0.019304342567920685, -0.01600881665945053, 0.02862558327615261, -0.012423723936080933, -0.03367229178547859, -0.025330055505037308, 0.0263090617954731, 0.013251053169369698, -0.006260122638195753, -0.03949117287993431, -0.002313073957338929, -0.009631488472223282, 0.02890135906636715, 0.03364471346139908, 0.03830533102154732, 0.010603600181639194, -0.01256850641220808, -0.03841564431786537, -0.0047571416944265366, 0.004408974200487137, 0.007818259298801422, 0.01941465400159359, -0.021772541105747223, -0.02505427971482277, -0.017470430582761765, 0.04078732058405876, 0.017332542687654495, -0.009314346127212048, 0.023068690672516823, 0.0470474436879158, 0.019469808787107468, -0.016643101349473, 0.032320987433195114, 0.021372666582465172, 0.02800508588552475, 0.040732163935899734, 0.01636732555925846, -0.022475771605968475, 0.002156226197257638, -0.035492412745952606, -0.001916645560413599, 0.009838320314884186, 0.05363849550485611, 0.016450058668851852, 0.018463226035237312, 0.015016021206974983, 0.007466644048690796, 0.02433726191520691, -0.012278941459953785, 0.03551999107003212, -0.01628459244966507, 0.04084247350692749, -0.01100347563624382, 0.022131050005555153, 0.04183527082204819, -0.014616145752370358, -0.035051170736551285, -0.023896019905805588, -0.07302557677030563, -0.04194558039307594, -0.0161467045545578, 0.008128507062792778, -0.047709304839372635, -0.02393738552927971, -0.04919849708676338, -0.028060242533683777, 0.0037953718565404415, 0.03565787896513939, -0.0400703027844429, 0.026598626747727394, -0.01901477761566639, 0.015016021206974983, 0.023647820577025414, 0.01861490309238434, -0.034996017813682556, 0.0235237218439579, 0.005105309188365936, -0.011975587345659733, 0.03174185752868652, -0.04732321947813034, -0.004133197944611311, -0.013616456650197506, -0.026722727343440056, 0.012113475240767002, -0.018490802496671677, -0.06784097850322723, -0.025026703253388405, 0.04856421425938606, 0.001240993500687182, -0.006104998756200075, -0.03551999107003212, 0.07997513562440872, -0.012278941459953785, 0.007480433210730553, 0.025081858038902283, 0.02473713643848896, 0.004791613668203354, -0.015415896661579609, -0.02226893976330757, -0.01223068032413721, 0.022448193281888962, -0.053473033010959625, 0.026639994233846664, 0.04597191512584686, 0.04114582762122154, -0.023537511005997658, -0.012416829355061054, -0.0031300613190978765, -0.026584839448332787, -0.0027991298120468855, 0.03394806757569313, 0.038001980632543564, -0.028349807485938072, 0.04588918387889862, -0.03466508537530899, 0.06960594654083252, 0.01802198402583599, 0.05121166631579399, 0.01672583445906639, -0.019345710054039955, 0.08389116078615189, 0.020738380029797554, 0.008507699705660343, -0.0007428724784404039, 0.0006946116336621344, 0.026626205071806908, -0.014754033647477627, 0.0024440677370876074, -0.01646384783089161, 0.03358955681324005, -0.011017264798283577, 0.022930802777409554, -0.0077837868593633175, -0.01377502828836441, -0.029590800404548645, -0.027039868757128716, -0.02214483916759491, -0.027591422200202942, 0.059788309037685394, 0.021731175482273102, -0.0017365290550515056, 0.04820570349693298, 0.012396146543323994, 0.021220989525318146, 0.017194654792547226, -0.00207349332049489, -0.02876347117125988, -0.0005774067249149084, 0.007087451871484518, -0.03593365475535393, 0.028570428490638733, -0.04423452541232109, 0.030804216861724854, -0.014947077259421349, 0.021193411201238632, 0.006411799695342779, 0.005425899289548397, -0.00705642718821764, -0.007321861572563648, -0.02639179490506649, -8.930413605412468e-05, -0.008252606727182865, -0.062104832381010056, -0.01731875352561474, -0.012692606076598167, 0.038084711879491806, -0.015222853980958462, -0.0019597355276346207, 0.02344098873436451, -0.03243129700422287, 0.013382046483457088, -0.027591422200202942, -0.012023848481476307, -0.01945601962506771, -0.013644034042954445, -0.02268260344862938, 0.018366703763604164, 0.004843322094529867, 0.03171427920460701, -0.007735526189208031, 0.019028566777706146, 0.01897341199219227, -0.0005076008383184671, -0.011692916974425316, 0.04048396646976471, 0.04859178885817528, -0.01600881665945053, 0.029949309304356575, -0.04348992928862572, -0.007294284179806709, 0.011465401388704777, 0.012079003266990185, 0.013306207954883575, -0.019469808787107468, 0.0025354186072945595, 0.015084965154528618, 0.015291797928512096, 0.013319997116923332, 0.004191800486296415, -0.015843350440263748, 0.0049812099896371365, 0.0020476393401622772, 0.05228719487786293, 0.002721567638218403, 0.03221067413687706, 0.0053052473813295364, -0.004443446174263954, 0.03372744470834732, -0.011499873362481594, 0.014574779197573662, -0.06033986061811447, 0.013733661733567715, 0.013230369426310062, -0.015443474985659122, 0.007818259298801422, -0.006442824844270945, -0.02120720036327839, -0.01145161222666502, -0.01807713881134987, -0.04831601306796074, 0.007956147193908691, 0.016932666301727295, 0.012265152297914028, -0.03709191828966141, -0.0324864536523819, 0.033396512269973755, -0.0010427793022245169, 0.009721116162836552, 0.03532695025205612, -0.042828064411878586, 0.008935153484344482, -0.016643101349473, -0.02997688762843609, -0.03438930958509445, -0.014030121266841888, 0.018987201154232025, 0.013078692369163036, -0.029894154518842697, 0.0025957447942346334, -0.029149558395147324, 0.010520867072045803, -0.01891825720667839, 0.029039248824119568, 0.01959390938282013, 0.02009030617773533, -0.026736516505479813, 0.008004408329725266, -0.01187217142432928, -0.025688566267490387, -0.030749062076210976, -0.0007359780720435083, 0.002771552186459303, -0.01833912543952465, 0.03474781662225723, -0.019111299887299538, 0.015581362880766392, 0.013002853840589523, 0.009472916834056377, 0.01825639419257641, 0.01838049292564392, 0.02057291381061077, -0.00023634893295820802, -0.027412166818976402, -0.0018166765803471208, 0.009066146798431873, -0.06221514195203781, -0.026984713971614838, 0.029535645619034767, 0.017056766897439957, -0.03372744470834732, 0.0382777564227581, 0.006801333744078875, 0.01913887821137905, -0.014643723145127296, -0.03554756939411163, 0.014836766757071018, -0.005422451999038458, 0.020379871129989624, -0.040814898908138275, 0.015691673383116722, 0.0338929109275341, -0.022599870339035988, 0.020366081967949867, -0.0027543161995708942, -0.015622729435563087, -0.017236020416021347, -0.03971179202198982, 0.04470334202051163, -0.0061463648453354836, 0.013754344545304775, -0.02433726191520691, 0.007769998162984848, -0.005743042100220919, 0.012327202595770359, -0.01310627069324255, -0.02049018256366253, -0.015236642211675644, -0.01851838082075119, -0.0018838971154764295, 0.016712045297026634, 0.07197762280702591, -0.01780136302113533, 0.009686644189059734, -0.04191800206899643, 0.01098279282450676, -0.0707642063498497, 0.008886892348527908, 0.027122601866722107, -0.005543104372918606, 0.006901302840560675, 0.0036402475088834763, -0.025881608948111534, -0.03739527240395546, 0.003519595367833972, 0.004398632328957319, -0.019207822158932686, -0.013278630562126637, -0.038801729679107666, -0.00341617944650352, 0.01489192247390747, 0.009948630817234516, 0.05995377525687218, 0.0015538273146376014, 0.015498629771173, 0.026005707681179047, 0.011692916974425316, -0.03813986852765083, 0.016712045297026634, -0.028101608157157898, 0.021179622039198875, -0.006739284377545118, -0.023606454953551292, 0.05703054741024971, -0.022075895220041275, -0.051680486649274826, -0.04029092192649841, 0.026722727343440056, -0.02268260344862938, -0.021096888929605484, -0.0020976236555725336, -0.038084711879491806, -0.021979372948408127, 0.031079992651939392, 0.0532248318195343, -0.00019605974375735968, -0.006963352672755718, -0.007239128928631544, -0.01596744917333126, 0.0032214124221354723, 0.0014762651408091187, -0.00874210987240076, 0.05126681923866272, -0.008845525793731213, 0.002562996232882142, -0.020738380029797554, -0.03207278624176979, 0.007956147193908691, -0.017608318477869034, -0.01981453038752079, -0.03709191828966141, -0.03767104819417, 0.04078732058405876, 0.010251984931528568, -0.008755899034440517, -0.012409934774041176, 0.022710181772708893, 0.02483365871012211, 0.010003786534070969, -0.00460891192778945, -0.02647452801465988, 0.009224718436598778, -0.04056669771671295, 0.013030432164669037, -0.020159250125288963, -0.02812918648123741, -0.01223757490515709, -0.013961177319288254, -0.0324864536523819, 0.047654151916503906, 0.022613659501075745, 0.02111067809164524, 0.007035743910819292, 0.025605833157896996, -0.01010720245540142, 0.016794778406620026, -0.03797440230846405, 0.01259608380496502, 0.004774377681314945, -0.020407449454069138, 0.03251402825117111, 0.00706676859408617, 0.019000990316271782, -0.036567941308021545, -0.020600492134690285, 0.024943970143795013, -0.004539967980235815, 0.017070554196834564, -0.012947699055075645, 0.0002630647795740515, 0.000592488213442266, 0.006539346184581518, -0.011224096640944481, 0.003533384297043085, 0.04114582762122154, 0.020104095339775085, -0.005811986047774553, -0.007880308665335178, 0.029425334185361862, -0.03938085958361626, 0.05140470713376999, -0.020821113139390945, -0.01676720194518566, -0.027743099257349968, -0.022641237825155258, -0.010382979176938534, -0.020959001034498215, 0.01209968701004982, -0.015457263216376305, -0.031383346766233444, -0.00021965154155623168, -0.03982210159301758, -0.038222599774599075, 0.02539900131523609, -0.0016641378169879317, -0.05206657201051712, -0.01712571084499359, -0.011975587345659733, -0.013995649293065071, -0.019083721563220024, -0.023923596367239952, 0.03416868671774864, 0.008114718832075596, -0.13700568675994873, -0.01897341199219227, 0.05355576425790787, 0.024847447872161865, -0.006780650466680527, 0.0009850385831668973, 0.006425588391721249, 0.03494086116552353, -0.011327512562274933, -0.01013477984815836, -0.0042745331302285194, -0.024309683591127396, -0.008369811810553074, -0.01404390949755907, 0.006432482972741127, -0.05874035879969597, 0.014009437523782253, -0.05079800263047218, -0.0036747197154909372, -0.020021362230181694, -0.012244469486176968, 0.005215620156377554, 0.00821124017238617, 0.04373812675476074, -0.0010462264763191342, -0.013678506016731262, 0.0010307140182703733, 0.028735894709825516, -0.01413353718817234, 0.019786952063441277, -0.0006782374111935496, 0.00320417620241642, -0.0012573677813634276, 0.020545337349176407, -0.02009030617773533, -0.03372744470834732, -0.022393038496375084, -0.0038815520238131285, -0.00309214205481112, 0.0033627476077526808, 0.04371054843068123, -0.04991551488637924, 0.02782583236694336, -0.010727699846029282, -0.010858693160116673, -0.006804781034588814, -0.014588568359613419, 0.01967664062976837, 0.009210929274559021, -0.010920742526650429, -0.009355711750686169, 0.027053657919168472, 0.003574750851839781, -0.04776446148753166, -0.028349807485938072, 0.03791924566030502, -0.003000791184604168, -0.0068702781572937965, -0.008328445255756378, 0.03700918331742287, -0.005577576346695423, -0.010962109081447124, -0.012361674569547176, -0.009500495158135891, -0.006529004778712988, -0.041587069630622864, -0.003147297305986285, -0.002114859875291586, -0.01491949986666441, -0.025012914091348648, -0.006091209594160318, -0.0036574837286025286, -0.0020855586044490337, 0.033286202698946, 0.002094176597893238, 0.033286202698946, 0.011665338650345802, 0.014685089699923992, -0.028515273705124855, 0.020765958353877068, 0.02970111183822155, -0.024723349139094353, 0.03651278838515282, 0.014050804078578949, 0.012692606076598167, 0.014988443814218044, 0.017553163692355156, 0.014340369030833244, -0.0350787490606308, 0.028735894709825516, 0.04693713039159775, -0.048509057611227036, 0.005963663104921579, -0.016022605821490288, -0.009252295829355717, -0.026336640119552612, -0.025261111557483673, 0.036926452070474625, -0.0018804498249664903, -0.018752790987491608, 0.01694645546376705, 0.04861936718225479, -0.05236992612481117, -0.019800741225481033, -0.0009703880059532821, 0.02777067758142948, 0.004429657477885485, 0.0058912718668580055, 0.008569750003516674, 0.0006463507888838649, 0.049363963305950165, -0.015209064818918705, -0.026364218443632126, 0.045558251440525055, -0.031079992651939392, 0.01829775981605053, 0.05868520215153694, -0.008907575160264969, 0.04919849708676338, 0.014050804078578949, -0.003843632759526372, 0.025440366938710213, -0.008900681510567665, -0.02228272706270218, -0.042111046612262726, 0.023330677300691605, 0.00910061877220869, 0.013182109221816063, 0.00954875536262989, -0.01941465400159359, 0.026405584067106247, 0.04133887216448784, -0.011823910288512707, -0.011348196305334568, -0.01682235673069954, -0.011575711891055107, 0.016643101349473, 0.030611172318458557, -0.051873527467250824, 0.012913227081298828, -0.010245091281831264, 0.005587917752563953, 0.03811229020357132, -0.01136198453605175, -0.03234856575727463, -0.00342824449762702, 0.017594529315829277, -0.033396512269973755, -0.022062106058001518, 0.01165155041962862, 0.012830493971705437, -0.009721116162836552, -0.02481986954808235, -0.01632595993578434, 0.03430657461285591, -0.006928880233317614, 0.006008476950228214, -0.040814898908138275, 0.01220999751240015, 0.011906643398106098, -0.011555028147995472, 0.024930180981755257, 0.0009919330477714539, -0.019028566777706146, 0.011506767943501472, -0.02804645337164402, 0.018311548978090286, -0.014974654652178288, -0.022241361439228058, 0.005863694474101067, -0.034279000014066696, -0.04255228862166405, 0.030528441071510315, -0.01905614510178566, 0.015981238335371017, 0.02388223074376583, 0.023647820577025414, 0.0003925503697246313, 0.031466078013181686, 0.011803227476775646, -0.01158950012177229, 0.021000368520617485, -0.029756266623735428, -0.009272979572415352, 0.03935328125953674, -0.028239496052265167, -0.0012228956911712885, -0.002080387668684125, -0.00899030826985836, 0.041669804602861404, 0.027853410691022873, 0.03165912255644798, 0.039518747478723526, 0.030886949971318245, 0.015526208095252514, -0.019069934263825417, 0.04939154163002968, 0.009204035624861717, 0.027701733633875847, -0.010920742526650429, -0.033341359347105026, 0.03524421527981758, -0.004870899487286806, -0.0026681360322982073, -0.017994405701756477, 0.01771862991154194, 0.01165155041962862, 0.008045774884521961, -0.03287253901362419, 0.032238252460956573, 0.005791303236037493, 0.013099376112222672, -0.026102229952812195, 0.0036747197154909372, -0.013209686614573002, -0.010851798579096794, -0.013513040728867054, 0.00404701754450798, 0.013071798719465733, -0.02876347117125988, -0.05609290674328804, -0.002816365798935294, -0.026805460453033447, -0.003967732191085815, 0.005022576544433832, 0.008314656093716621, 0.007583849132061005, 0.026736516505479813, -0.009045463986694813, 0.01066564954817295, -0.007073663175106049, -0.024268317967653275, -0.016560368239879608, -0.002018338069319725, 0.012954593636095524, 0.010093414224684238, 0.005346613470464945, -0.014299003407359123, -0.014574779197573662, 0.05294905602931976, 0.027343222871422768, 0.006046396214514971, 0.027439745143055916, 0.005746489390730858, -0.0044503407552838326, -0.0026009154971688986, 0.01259608380496502, 0.03414110839366913, 0.0074252779595553875, 0.007115029264241457, 0.010651861317455769, 0.0005903337150812149, 0.03888446465134621, -0.021993162110447884, 0.047268062829971313, 0.007308072876185179, 0.005077731795608997, 0.054107315838336945, 0.008397389203310013, 0.027674155309796333, 0.011734282597899437, 0.02021440491080284, 0.030307820066809654, -0.01833912543952465, -0.03449961915612221, -0.00607397360727191, -0.023951174691319466, -0.013961177319288254, 0.01560894027352333, -0.02003515139222145, -0.018807945773005486, 0.014850555919110775, 0.01869763620197773, 0.011037947610020638, 0.01587092876434326, -0.012864965945482254, -0.011775649152696133, -0.03278980776667595, 0.041311293840408325, -0.004570992663502693, -0.042111046612262726, -0.01189974881708622, 0.016215648502111435, 0.0245165154337883, 0.011941115371882915, -0.0051604644395411015, -0.0051604644395411015, -0.012733972631394863, 0.008790371008217335, -0.014312791638076305, 0.026405584067106247, 0.015801984816789627, -0.02519216760993004, 0.008038880303502083, -0.001103105372749269, -0.025826454162597656, 0.026915770024061203, -0.006260122638195753, 0.020021362230181694, -0.016394903883337975, 0.0039022350683808327, 0.02657105028629303, 0.02728806808590889, -0.04795750603079796, -0.008087141439318657, 0.04652346670627594, 0.026157384738326073, -0.04315899685025215, 0.009107513353228569, -0.013809500262141228, -0.011513661593198776, 0.022779125720262527, -0.0029042696114629507, -0.016394903883337975, 0.010389873757958412, -0.015857139602303505, -0.025123223662376404, -0.01109310332685709, 0.0007277909899130464, -0.020435025915503502, -0.020297138020396233, -0.02348235435783863, 0.023509932681918144, 0.003269673092290759, -0.0022096578031778336, 0.0184356477111578, 0.0016598288202658296, -0.006225650664418936, 0.0007601085235364735, 0.015677884221076965, 0.021138256415724754, 0.004650278482586145, 0.022213783115148544, 0.019400864839553833, -0.015595152042806149, -0.03298284858465195, -0.05071526765823364, 0.012740866281092167, -0.004029781557619572, -0.021703597158193588, -0.011679127812385559, 0.020324716344475746, -0.01187906600534916, 0.00562583701685071, 0.0007609703461639583, 0.013637139461934566, -0.009790060110390186, -0.014657512307167053, -0.00047355968854390085, -0.01131372433155775, 0.07252917438745499, -0.02764657698571682, -0.014657512307167053, 0.016394903883337975, 0.00213554291985929, 0.00796304177492857, 0.0076803709380328655, -0.02428210712969303, -0.013078692369163036, 0.008700743317604065, 0.01775999553501606, 0.009266084991395473, 0.013968070968985558, -0.00392636563628912, 0.022062106058001518, -0.012830493971705437, 0.00830086786299944, 0.007976830936968327, 0.04666135460138321, 0.03877415135502815, 0.042745333164930344, 0.014767822809517384, -0.008390494622290134, -0.007914780639111996, -0.009279873222112656, 0.0056120483204722404, -0.00526732811704278, 0.019511176273226738, 0.024764714762568474, 0.00447102403268218, 0.008011302910745144, -0.0027922354638576508, -0.03971179202198982, 0.010886270552873611, -0.04191800206899643, 0.002797406166791916, 0.0027525925543159246, 0.025150801986455917, -0.022420616820454597, -0.014560990035533905, -0.029645955190062523, 0.002771552186459303, 0.001932157902047038, 0.014174903742969036, -0.012989065609872341, 0.014754033647477627, 0.017732419073581696, -0.027219124138355255, 0.019428443163633347, -0.018311548978090286, -0.009148879908025265, -0.013120058923959732, 0.013416518457233906, -0.021414032205939293, 0.015057387761771679, -0.04360023885965347, -0.008535277098417282, 0.0024992229882627726, 0.005026023834943771, -0.0014193863607943058, -0.03838806599378586, 0.020476393401622772, -0.005339719355106354, -0.02326173335313797, -0.02276533655822277, -0.04208346828818321, -0.006487638223916292, 0.030252663418650627, -0.03579576686024666, 0.039436016231775284, -0.03251402825117111, -0.03171427920460701, -0.008528383448719978, 0.015912294387817383, 0.0029818315524607897, 0.022310305386781693, 0.02075216919183731, -0.011782543733716011, 0.026378005743026733, 0.034996017813682556, -0.0008156946860253811, -0.028873782604932785, -0.04070458561182022, -0.0018528721993789077, 0.01672583445906639, 0.012947699055075645, 0.004188353195786476, 0.004884688183665276, 0.016932666301727295, 0.003162809880450368, 0.00816297996789217, 0.00308007700368762, 0.02992173284292221, 0.020834902301430702, -0.0305008627474308, -0.022199995815753937, 0.00952807255089283, -0.003126614261418581, -0.014822977595031261, -0.03984967991709709, 0.021841485053300858, -0.010900059714913368, 0.009238507598638535, 0.013947388157248497, -0.03237614035606384, -0.029066825285553932, -0.0723637118935585, -0.00269571365788579, 0.01731875352561474, 0.02692955918610096, 0.009845214895904064, -0.032624341547489166, 0.0038057134952396154, 0.01265813410282135, 0.018725212663412094, 1.2556710316857789e-05, -0.03645763173699379, 0.04751626402139664, 0.032320987433195114, -0.028928937390446663, 0.019125089049339294, -0.004091831389814615, 0.030611172318458557, 0.00997620914131403, 0.002007996430620551, 0.018752790987491608, 0.0206280704587698, 0.003149020951241255, 0.013513040728867054, -0.012161736376583576, -0.005987793672829866, 0.015195275656878948, -0.017236020416021347, 0.02298595756292343, 0.014423102140426636, -0.012754655443131924, -0.007156395819038153, -0.023247944191098213, -0.013002853840589523, 0.002995620481669903, -0.0008100929553620517, 0.05452097952365875, -0.019842106848955154, 0.0040952786803245544, 0.03745042532682419, 9.215885074809194e-05, 0.008873103186488152, -0.007949252612888813, -0.012561611831188202, -0.003290356369689107, -0.013568195514380932, -0.023234156891703606, -0.014588568359613419, 0.02415800653398037, -0.0034765054006129503, 0.013340679928660393, -0.01865626871585846, 0.01941465400159359, -0.0012142776977270842, 0.0008346543181687593, 0.00796304177492857, 0.0008893786580301821, 0.00584990531206131, 0.006211861968040466, 0.03207278624176979, 0.004939843434840441, -0.015071176923811436, -0.018366703763604164, 0.02898409217596054, -0.011741177178919315, -0.0032317538280040026, -0.021441610530018806, -0.012272046878933907, -0.006442824844270945, -0.008225029334425926, -0.018173661082983017, -0.017153287306427956, 0.03596123307943344, 0.006959905382245779, -0.009114407934248447, 0.0037815829273313284, -0.018628692254424095, 0.007521799299865961, -0.013513040728867054, -0.0009574609575793147, 0.0053810859099030495, 0.008197451941668987, -0.0013125230325385928, -0.014340369030833244, 0.009707327000796795, 0.01722223125398159, -0.02750868909060955, -0.020683225244283676, 0.0019511175341904163, 0.008590432815253735, 0.009927948005497456, -0.023992540314793587, -0.012789127416908741, 0.04020819067955017, -0.003843632759526372, 0.0038815520238131285, -0.04335204139351845, 0.04343477264046669, 0.009652171283960342, 0.0037712412886321545, -0.0024440677370876074, -0.03640247508883476, 0.0025043939240276814, 0.010203724727034569, -0.012602978385984898, 0.027357012033462524, -0.014230058528482914, 0.016560368239879608, 0.04031850025057793, 0.02639179490506649, 0.005870588589459658, 0.020117884501814842, 0.0036885084118694067, -0.025012914091348648, -0.04660620167851448, -0.008287078700959682, 0.0085214888677001, -0.0037091916892677546, 0.0009565991349518299, 0.012837388552725315, -1.5889456335571595e-05, -0.008907575160264969, -0.008700743317604065, 0.0050811790861189365, 0.053390298038721085, 0.029232291504740715, -0.008135401643812656, 0.005680992268025875, 0.03091452643275261, 0.006353197153657675, 0.013044220395386219, -0.01438173558562994, 0.011748071759939194, -0.006563476752489805, -0.01700161024928093, -0.03485812991857529, 0.046137381345033646, 0.01192043162882328, 0.0082732904702425, -0.0402633436024189, 0.07004719227552414, 0.012051425874233246, 0.001001412863843143, -0.014960866421461105, 0.01825639419257641, 0.03891203925013542, 0.00028374799876473844, -0.006422141566872597, -0.053031791001558304, -0.014436891302466393, -0.031024837866425514, -0.004826085641980171, -0.015719251707196236, -0.00809403508901596, 0.02290322445333004, 0.012637450359761715, -0.006001582369208336, 0.024709559977054596, 0.015333164483308792, 0.0006644485983997583, -0.001906303921714425, 0.001007445389404893, -0.010010681115090847, 0.004143539350479841, 0.0019407760119065642, 0.005367296747863293, -0.019083721563220024, -0.02388223074376583, -0.015098754316568375, 0.034472040832042694, 0.01111378613859415, 0.016077760607004166, -0.016532791778445244, 0.01366471778601408, 0.019566331058740616, 0.023923596367239952, 0.03292769566178322, -0.013588879257440567, -0.0013762962771579623, 0.031190304085612297, 0.026957137510180473, -0.04040123149752617, 0.001216001226566732, 0.004291769117116928, -0.015691673383116722, 0.0012547823134809732, -0.002609533490613103, 0.0041780113242566586, -0.019028566777706146, 0.0011496426304802299, 0.023496143519878387, 0.024681981652975082, -0.003905682358890772, 0.0016744794556871057, 0.01748421974480152, -0.023496143519878387, -0.004219377879053354, -0.010052047669887543, 0.017277387902140617, 0.008197451941668987, 0.020062727853655815, -0.04453787952661514, 0.035630300641059875, 0.023358255624771118, 0.013788816519081593, 0.0034765054006129503, -0.03005962073802948, -0.0036643780767917633, -0.008680060505867004, -0.005677545443177223, 0.015112543478608131, -0.0007937187911011279, -0.0012573677813634276, -0.022296516224741936, 0.05774756520986557, -0.016408691182732582, 0.008707637898623943, -0.01578819565474987, 0.006880619563162327, 0.016119126230478287, 0.002304455963894725, -0.0305008627474308, 0.0015779577661305666, 0.022434404119849205, -0.012444406747817993, 0.022696392610669136, 0.009500495158135891, 0.02459924854338169, 0.003533384297043085, -0.0019028567476198077, 0.00954875536262989, -0.01008651964366436, 0.003314486937597394, 0.0007596776122227311, -0.02232409454882145, -0.011823910288512707, 0.009107513353228569, -0.0036402475088834763, 0.0035109773743897676, -0.012582295574247837, 0.04288322106003761, -0.03538210317492485, -0.004398632328957319, 0.0019080275669693947, -0.02643316239118576, 0.033837758004665375, 0.022848069667816162, 0.033479247242212296, -0.024447571486234665, 0.0008040603715926409, 0.00582577520981431, 0.01281670480966568, -0.003695402992889285, -0.025702353566884995, -0.0170429777354002, -0.012830493971705437, -0.02652968280017376, 0.03529937192797661, 0.002271707635372877, 0.026088440790772438, 0.008252606727182865, -0.01424384769052267, -0.003819502191618085, 0.024144217371940613, 0.006925433408468962, -0.02370297536253929, 0.019786952063441277, 0.02102794498205185, -0.01999378390610218, -0.01855974644422531, -0.006804781034588814, -0.042690176516771317, -0.03885688632726669, -0.002257918706163764, -0.015195275656878948, 0.0324864536523819, 0.0030576700810343027, 0.019897261634469032, -0.023234156891703606, -0.005556893069297075, 0.005332824774086475, -0.0073494394309818745, -0.0007394253043457866, -0.030528441071510315]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
"9a-fA-F] [0-9a-fA-F] [0-9a-fA-F]
[0-9a-fA-F]) # escapes
27 )*""\\"""" ws
28
29number ::= (""-""? ([0-9] | [1-9] [0-9] *)) (""."" [0-9]+)? ([eE] [-+]?
[0-9]+)? ws
30
31#Optional space: by convention, applied in thisgrammar after
literal chars when allowed
32ws ::= ([ \\t\\n] ws)?
33
34#Prompts used forgeneration
35We use 5-shot prompts forquestions from GSM8K's test split as
prompt (cf. Task Accuracy Experiments).
Listing 4. Guided Math Reasoning Grammar (for GSM8K)
1root ::= (declaration) *
23declaration ::= dataType identifier ws ""("" ws parameter? ws "")"" ws
""{"" ws statement *""}""
4
5dataType ::= ""int"" ws | ""float"" ws | ""char"" ws
6identifier ::= [a-zA-Z _] [a-zA-Z _0-9]*
7
8parameter ::= dataType identifier
9
10statement ::=
11 ( dataType identifier ws ""="" ws expression "";"" ws ) |
12 ( ( dataType identifier ws ""["" ws expression ws ""]"" ws ( ""=""
ws expression )? "";"" ws ) ) |
13 ( identifier ws ""="" ws expression "";"" ws ) |
14 ( identifier ws ""("" argList? "")"" "";"" ws) |
15 ( ""return"" ws expression "";"" ws ) |
16 ( ""while"" ""("" condition "")"" ws ""{"" statement *""}"" ) |
17 ( ""for"" ""("" forInit "";"" ws condition "";"" ws forUpdate "")"" ""{""
statement *""}"" ws ) |
18 ( ""if"" ""("" condition "")"" ""{"" statement *""}"" (""else"" ""{""
statement *""}"")? ws ) |
19 ( singleLineComment ws ) |
20 ( multiLineComment ws )
21
22forInit ::= dataType identifier ws ""="" ws expression | identifier
ws ""="" ws expression
23forUpdate ::= identifier ws ""="" ws expression
24
25condition ::= expression relationOperator expression
26relationOperator ::= (""<="" | ""<"" | ""=="" | ""!="" | "">="" | "">"")
27
28expression ::= term ((""+"" | ""-"") term) *
29term ::= factor(("" *"" | ""/"") factor) *
30
31string ::=
32 ""\\"""" (
33 [^""\\\\] |
34 ""\\\\"" ([""\\\\/bfnrt] | ""u"" [0-9a-fA-F] [0-9a-fA-F] [0-9a-fA-F]
[0-9a-fA-F]) # escapes
35 )*""\\"""" ws
36
37factor ::= identifier | number | unaryTerm | funcCall |
parenExpression | subscript | string
38unaryTerm ::= ""-"" factor
39funcCall ::= identifier ""("" argList? "")""
40parenExpression ::= ""("" ws expression ws "")""
41subscript ::= identifier ""["" ws expression ws ""]""
42
43argList ::= expression ("","" ws expression) *
44
45number ::= [0-9]+
46
47singleLineComment ::= ""//"" [^\\n] *""\\n""
48multiLineComment ::= ""/ *"" ( [^*] | (""*"" [^/]) ) *""*/""
49
50ws ::= ([ \\t\\n] *)
51
52#prompts used forgeneration
53""A C program that prints \\""Hello, world!\\"":\\n ```c\\n""
54""A C main function that iterates over an array of integers and
prints each one:\\n ```c\\n""
55""A C program that prints the sum of two integers:\\n ```c\\n""
56""The following is a program that finds the sum of two integers in
C:\\n```c\\n""
57""A C program that fills an array with the numbers 0 to 9 and
prints them:\\n ```c\\n""
58""A C implementation of a simple bubble sort:\\n ```c\\n""
Listing 5. Simple C Program Grammar and Prompts
1root ::= person
2
3person ::= ( ""<person>"" ( ws personattributes ) ""</person>"" )
4personattributes ::= nameattribute ageattribute jobattribute
friends?
5
6nameattribute ::= ""<name>"" NAME ""</name>"" ws
7ageattribute ::= ""<age>"" NUMBER ""</age>"" ws
8jobattribute ::= ""<job>"" ws jobinfo ""</job>"" ws
9friends ::= ""<friends>"" ws person+ ws ""</friends>"" ws
10
13
Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation
11jobinfo ::= jobtitle jobsalary
12jobtitle ::= ""<title>"" NAME ""</title>"" ws
13jobsalary ::= ""<salary>"" NUMBER ""</salary>"" ws
14","[0.0030100406147539616, 0.030118247494101524, 0.04830338805913925, 0.024451449513435364, -0.0004320130974519998, 0.0008087141904979944, 0.018784651532769203, -0.006344815716147423, 0.02025487832725048, 0.05315656587481499, 0.02667820267379284, -0.06263453513383865, 0.021653736010193825, -0.005434845108538866, 0.005110110156238079, 0.009213900193572044, -0.0059915329329669476, -0.013017934747040272, -0.020040767267346382, 0.016515078023076057, 0.07125606387853622, -0.008700034581124783, -0.03043227829039097, 0.0062020751647651196, 0.013503252528607845, -0.01742861606180668, -0.009192489087581635, 0.05418429896235466, 0.012868057005107403, -0.018556267023086548, 0.04895999655127525, -0.030460825189948082, 0.012539753690361977, -0.0007382360636256635, 0.006694530136883259, 0.03397224098443985, 0.0564395971596241, 0.032573383301496506, 0.0061164312064647675, -0.01250406913459301, -0.0319167785346508, -0.026449816301465034, -0.006491124629974365, -0.06172099709510803, -0.013588896952569485, 0.045705512166023254, -0.011868873611092567, 0.03685560077428818, 0.006444734055548906, 0.002521154237911105, -0.04890289902687073, 0.0094422847032547, 0.03534255176782608, 0.08101951330900192, -0.03197387605905533, -0.017442891374230385, -0.03911089897155762, 0.018227962777018547, 0.04265086352825165, 0.011661900207400322, 0.04701872542500496, -0.043193280696868896, 0.006334110163152218, 0.03491432964801788, -0.03588496521115303, 0.020069316029548645, -0.000967959116678685, 0.002765597542747855, -0.0033740289509296417, 0.007558110170066357, 0.00763661740347743, 0.049702245742082596, 0.03391514718532562, 0.012732453644275665, -0.032830316573381424, 0.007672302424907684, 0.01691475138068199, 0.000504944589920342, -0.014916383661329746, -0.010198809206485748, 0.03571367636322975, -0.009370914660394192, 0.04442084580659866, -0.061435516923666, -0.004892431199550629, 0.0005424139671958983, -0.0369126982986927, -0.009784862399101257, -0.07353991270065308, -0.04813209921121597, -0.05247141420841217, -0.022867029532790184, -0.007515287958085537, 0.03959621861577034, 0.0801059752702713, -0.03497142717242241, -0.02363782934844494, 0.0028066353406757116, -0.0007016588351689279, -0.0018154808785766363, 0.02759174071252346, -0.0484175831079483, 0.01567290909588337, -0.02997550740838051, 0.05863780155777931, 0.033486925065517426, -0.01754280924797058, 0.03794042766094208, -0.026478365063667297, -0.009535065852105618, -0.12150072306394577, 0.02492249384522438, 0.0030564311891794205, 0.020140687003731728, 0.003861130913719535, 0.020454715937376022, -0.061663903295993805, -0.022196149453520775, 0.006230623461306095, -0.039453476667404175, -0.004478483460843563, -0.018227962777018547, -0.01775692030787468, -0.05127239227294922, -0.008079113438725471, 0.012218588031828403, 0.010555661283433437, 0.0004373658448457718, -0.002706717001274228, 0.01996939815580845, 0.037026889622211456, -0.011454925872385502, 0.0116690369322896, 0.012718179263174534, -0.042622316628694534, -0.0010009678080677986, -0.026778120547533035, -0.021568091586232185, -0.011412103660404682, 0.06280582398176193, 0.01925569586455822, -0.01388151478022337, -0.003109958954155445, 0.014331147074699402, 0.03180258721113205, -0.004321468994021416, -0.05698201432824135, 0.06588902324438095, -0.04219409450888634, 0.020897211506962776, 0.004228687845170498, 0.020326249301433563, -0.04981644079089165, 0.0015291078016161919, 0.021082773804664612, -0.06548934429883957, -0.013560349121689796, 0.02926180511713028, -0.034657396376132965, 0.0012757433578372002, -0.017913933843374252, 0.007486740127205849, 0.021582365036010742, 0.018242238089442253, -0.0423368364572525, 0.010113165713846684, -0.00136763253249228, 0.02396613173186779, -0.06109293922781944, 0.0036149034276604652, -0.012197176925837994, -0.08238982409238815, -0.0644616186618805, -0.01588701829314232, -0.011876010335981846, -0.007079929579049349, -0.014873561449348927, -0.045990992337465286, -0.03985315188765526, -0.024851122871041298, -0.015473071485757828, 0.03485723212361336, -0.033030156046152115, -0.02042616717517376, -0.009092570282518864, -0.049873534590005875, 0.010791182518005371, -0.0069478945806622505, 0.0025675450451672077, -0.009941876865923405, 0.004100221209228039, 0.00931381806731224, 0.08381722867488861, 0.019412709400057793, 0.015287509188055992, -0.07742245495319366, 0.07884985953569412, -0.010698401369154453, 0.006680256221443415, 0.027291985228657722, 0.004792512860149145, 0.03268757835030556, 0.012311369180679321, -0.0644616186618805, -0.02350936271250248, 0.024893945083022118, 0.029775671660900116, 0.017599904909729958, -0.01600121147930622, -0.041451845318078995, 0.05121529474854469, -0.006444734055548906, 0.020240604877471924, 0.02329525165259838, -0.03679850324988365, 0.05489800125360489, -0.022495904937386513, -0.028105607256293297, -0.0020786586683243513, 0.0010009678080677986, -0.022267520427703857, 0.0670880377292633, 0.05164351686835289, -0.029575834050774574, -0.019983671605587006, 0.01842780038714409, 0.02034052275121212, 0.00255327089689672, -0.0062020751647651196, -0.010484290309250355, 0.043364569544792175, 0.0024640581104904413, -0.01662926934659481, -0.08079113066196442, -0.02016923390328884, -0.017328698188066483, -0.040995076298713684, 0.01804240047931671, -0.02084011398255825, 0.026778120547533035, -0.015944115817546844, 0.030403729528188705, 0.04502035677433014, -0.0017271601827815175, 0.023652102798223495, 0.0029047694988548756, -0.02642126940190792, -0.034942876547575, 0.022453082725405693, -0.005274261813610792, 0.03551384061574936, -0.038853969424963, -0.03151710703969002, -0.017913933843374252, -0.045534223318099976, 0.011576255783438683, 0.002142891986295581, 0.03771204501390457, 0.04596244543790817, -0.01875610277056694, -0.013467567041516304, -0.027691660448908806, -0.01227568369358778, 0.0013551427982747555, -0.01996939815580845, 0.025022411718964577, -0.026606831699609756, 0.015558715909719467, 0.011876010335981846, -0.0649183839559555, -0.05038740113377571, -0.012033024802803993, -0.004910273477435112, -0.003986028954386711, -0.021625187247991562, -0.02696368284523487, 0.006148547399789095, 0.03508561849594116, -0.014816464856266975, 0.02576466277241707, -0.06583192199468613, 0.004592676181346178, 0.04456358775496483, 0.020654551684856415, -0.0017351893475279212, 0.013324826955795288, 0.009035474620759487, 0.002307043643668294, -0.004749690648168325, -0.031145980581641197, 0.021982038393616676, 0.028733665123581886, 0.04148039221763611, -0.006790880113840103, -0.002430157270282507, -0.013703089207410812, 0.023038318380713463, 0.001918075606226921, 0.023623554036021233, 0.02066882699728012, 0.04227973893284798, 0.027862947434186935, -0.04142329841852188, -0.018570540472865105, -0.024622738361358643, 0.036370281130075455, -0.001108023221604526, -0.011233678087592125, -0.020240604877471924, -0.02012641169130802, -0.010362961329519749, 0.025935951620340347, -0.00469973124563694, -0.018856022506952286, -0.007040675729513168, -0.07171283662319183, 0.035570934414863586, -0.0005852361209690571, 0.019055858254432678, -0.017871111631393433, 0.009634984657168388, -0.011340733617544174, 0.03288741409778595, -0.0345146544277668, 0.004228687845170498, 0.02622143179178238, 0.0032866003457456827, 0.004681888967752457, -0.03968186303973198, -0.019327064976096153, -0.008036291226744652, -0.03939638286828995, -0.004275078419595957, 0.05701056122779846, 0.010591345839202404, -0.05718185007572174, -0.04542003199458122, 0.04867451637983322, 0.042707961052656174, 0.07062800228595734, -0.05538332089781761, -0.004064536187797785, -0.04030992090702057, 0.0022071250714361668, -0.046904534101486206, -0.007950646802783012, 0.025536278262734413, 0.018113771453499794, 0.06172099709510803, 0.037911880761384964, -0.010748360306024551, 0.015872744843363762, 0.023480813950300217, 0.026649653911590576, -0.03499997407197952, -0.03362966328859329, -0.021039951592683792, -0.025664744898676872, 0.008157620206475258, 0.05663943663239479, -0.023866213858127594, 0.014873561449348927, 0.007929235696792603, 0.014530984684824944, -0.009877643547952175, 0.0334298275411129, 0.009042611345648766, -0.008164756931364536, -0.019569724798202515, -0.010769771412014961, 0.014802191406488419, 0.013803008012473583, 0.02483684942126274, -0.02396613173186779, -0.028576651588082314, -0.01087682694196701, -0.02622143179178238, 0.0064233229495584965, 0.009178214706480503, 0.005588291212916374, 0.025436358526349068, 0.010933923535048962, -0.024037502706050873, -0.010562798008322716, 0.0032776789739727974, -0.016229595988988876, 0.01730014942586422, -0.012703905813395977, 0.0014666587812826037, -0.04433520510792732, 0.025650469586253166, -0.015829922631382942, 0.0192128736525774, -0.007154867984354496, 0.04713291674852371, 0.024893945083022118, 0.039082352072000504, 0.04539148136973381, 0.003629177575930953, -0.010662715882062912, 0.018813200294971466, 0.0188845694065094, -0.022610098123550415, 0.004539148416370153, -0.02913333848118782, -0.017143135890364647, 0.0005352769512683153, 0.0766231045126915, 0.03739801421761513, 0.007693713530898094, 0.009242448024451733, -0.02059745602309704, 0.031945325434207916, 0.026392720639705658, -0.011718995869159698, -0.03305870294570923, 0.003208093112334609, 0.008507334627211094, 0.010734086856245995, 0.03759784996509552, -0.021867847070097923, -0.031231625005602837, -0.02283848263323307, -0.08004888147115707, -0.02600732073187828, 0.03497142717242241, -0.015387427061796188, -0.048075005412101746, -0.017071764916181564, -0.03722672536969185, -0.021111322566866875, 0.015430249273777008, 0.007536699064075947, 0.004728279542177916, 0.017357246950268745, -0.037112534046173096, 0.006765900179743767, 0.016614995896816254, 0.02133970707654953, -0.03205952048301697, 0.010598483495414257, 0.022809933871030807, 0.0038254456594586372, 0.03208806738257408, -0.026249980553984642, 0.005506215151399374, 0.007501014042645693, -0.04519164562225342, 0.003572081448510289, -0.024708382785320282, -0.04564841464161873, -0.00658390624448657, 0.02522224932909012, 0.0202977005392313, -0.009984699077904224, -0.008314634673297405, 0.0766231045126915, -0.024651287123560905, 0.015159042552113533, -0.013667403720319271, 0.02263864502310753, 0.01992657594382763, -0.006041492335498333, -0.032744672149419785, -0.032287903130054474, 0.009834821335971355, -0.04279360547661781, -0.0008497521048411727, 0.05267124995589256, 0.05689636990427971, -0.03722672536969185, -0.022610098123550415, 0.0017878249054774642, 0.003853993955999613, -0.017871111631393433, 0.03305870294570923, -0.011040979065001011, -0.024165969341993332, 0.05247141420841217, -0.04730420559644699, 0.052956730127334595, -0.00544911902397871, 0.057124752551317215, 0.012075847014784813, -0.0362560898065567, 0.028904953971505165, 0.030489373952150345, -0.0013524664100259542, 0.019983671605587006, 0.0023748453240841627, 0.0158441960811615, -0.00013069677515886724, 0.030289536342024803, -0.017400069162249565, 0.017557082697749138, 0.01897021383047104, 0.032830316573381424, -0.01762845367193222, -0.011447789147496223, -0.04464923217892647, -0.01404566690325737, -0.03514271602034569, -0.018984489142894745, 0.05869489908218384, 0.03554238751530647, -0.030118247494101524, 0.028448184952139854, 0.008807090111076832, -0.038283005356788635, 0.03154565393924713, -0.009092570282518864, -0.018370704725384712, -0.01962682045996189, -0.007836454547941685, -0.00395034346729517, -0.0052992417477071285, -0.011355007998645306, 0.021610913798213005, -0.0026710317470133305, 0.009349503554403782, -0.009791999123990536, 0.04259376972913742, -0.013967159204185009, -0.027449000626802444, -0.033572569489479065, -0.02259582281112671, 0.01254689134657383, -0.06331969052553177, 0.005677503999322653, -0.025393538177013397, 0.019641093909740448, -0.009142530150711536, 0.0038254456594586372, -0.0049245478585362434, -0.026792393997311592, 0.007240512408316135, 0.0011490611359477043, -0.020226331427693367, -0.004671183414757252, -0.03434336557984352, -0.02813415601849556, 0.013389060273766518, 0.016201049089431763, 0.012718179263174534, -2.327896982023958e-05, 0.019055858254432678, 0.019241420552134514, -0.010348686948418617, -0.005838086828589439, 0.00767943961545825, 0.0338580496609211, -0.030032603070139885, 0.036827053874731064, -0.025022411718964577, -0.02839108742773533, 0.014816464856266975, 0.007936372421681881, 0.01608685590326786, -0.028876405209302902, -0.017100313678383827, -0.0006177987670525908, -0.02021205611526966, 0.004756827373057604, 0.0013426529476419091, -0.013645992614328861, -0.010948196984827518, 0.003447183407843113, -0.006130705121904612, 0.0012614693259820342, 0.014224092476069927, -0.014017118141055107, -0.012211451306939125, 0.007322588469833136, -0.039453476667404175, 0.004945958964526653, -0.04793226346373558, -0.004828197881579399, 0.030032603070139885, -0.004992349538952112, -0.032287903130054474, -0.015601538121700287, -0.04404972121119499, 0.0028904953505843878, -0.025935951620340347, -0.03054646961390972, 0.0029814925510436296, 0.017371520400047302, 0.027905769646167755, -0.028533829376101494, -0.016943298280239105, 0.01471654698252678, 0.011561981402337551, -0.0012703905813395977, 0.036370281130075455, 0.0016977200284600258, 0.008214716799557209, -0.018513444811105728, -0.02583603374660015, -0.05629685893654823, -0.01684338040649891, 0.03034663386642933, -0.021696558222174644, -0.0030100406147539616, 0.028733665123581886, -0.010505701415240765, -0.004139475058764219, -0.013660266995429993, 0.01563008688390255, 0.02092575840651989, -0.008036291226744652, -0.05401301011443138, 0.030774854123592377, -0.036741409450769424, -0.016743462532758713, -0.030917594209313393, 0.028319718316197395, -0.0055204895325005054, -0.02021205611526966, 0.0434216633439064, -0.020568907260894775, -0.0035096323117613792, 0.056496694684028625, 0.005049445666372776, 0.019398435950279236, 0.005584722384810448, 0.02889068052172661, -0.021525269374251366, -0.0032687578350305557, -0.0023266703356057405, 0.012810961343348026, -0.04656195640563965, -0.014188406988978386, 0.026278529316186905, -0.019983671605587006, -0.007112046238034964, 0.009556476958096027, -0.0008814226603135467, 0.0021643030922859907, -0.0124826580286026, -0.037654947489500046, 0.033115800470113754, 0.015044850297272205, 0.008336045779287815, -0.039282187819480896, 0.04758968576788902, 0.023737747222185135, -0.0369126982986927, 0.023280978202819824, 0.002401609206572175, -0.016272418200969696, -0.007707987911999226, -0.04856032133102417, 0.01160480361431837, -0.015415975823998451, 0.010691264644265175, -0.034942876547575, -0.0010152419563382864, -0.029690027236938477, 0.002469410886988044, -0.011890284717082977, -0.02263864502310753, -0.011140896938741207, 0.012104395776987076, -0.03280176967382431, 0.021496720612049103, 0.06606031209230423, 0.0003749168827198446, 0.02700650505721569, -0.033943694084882736, 0.0037148217670619488, -0.058751996606588364, -2.4575343559263274e-05, 0.027563193812966347, -0.013517526909708977, 0.0030243145301938057, -0.043250374495983124, -0.011433514766395092, -0.017014669254422188, 0.004085947293788195, -0.01252548024058342, -0.017328698188066483, 0.010619894601404667, -0.031060336157679558, 0.001637947396375239, 0.01971246488392353, 0.021696558222174644, 0.018870295956730843, -0.01946980506181717, 0.038996707648038864, 0.024522820487618446, 0.003607766469940543, -0.014773642644286156, 0.011876010335981846, 0.002362355589866638, 0.02001222036778927, -0.0395105741918087, -0.013160675764083862, 0.02629280276596546, -0.03445756062865257, -0.07508151233196259, -0.02900487184524536, 0.025322167202830315, -0.005313515663146973, 0.0188845694065094, -0.017814015969634056, -0.06017940118908882, -0.032944511622190475, 0.027748756110668182, 0.04704727232456207, -0.02071164920926094, -0.013852966949343681, 0.005060151219367981, -0.04373569414019585, 0.004767532926052809, -0.026392720639705658, -0.006280582398176193, 0.01695757359266281, -0.0484175831079483, 0.029918411746621132, -0.0030189617536962032, -0.02596449851989746, 0.015744278207421303, -0.0006958600133657455, -0.020183509215712547, -0.025122329592704773, -0.01734297163784504, 0.02400895394384861, 0.012846645899116993, -0.01010602805763483, -0.020055042579770088, 0.014902109280228615, 0.023523636162281036, -0.03571367636322975, 0.01871328055858612, -0.013617444783449173, 0.00547053012996912, -0.08490205556154251, 0.00173251295927912, -0.021453898400068283, -0.0247512049973011, 0.005342063494026661, -0.009613573551177979, -0.022938400506973267, 0.029318900778889656, -0.01567290909588337, 0.03568512946367264, 0.005381317343562841, 0.01966964267194271, -0.04464923217892647, 0.0345146544277668, -0.010134576819837093, 0.013617444783449173, 0.006309130694717169, -0.033486925065517426, 0.033743858337402344, 0.0037576439790427685, -0.013117853552103043, -0.018013853579759598, -0.0028601631056517363, 0.029832767322659492, -0.0034239881206303835, 0.010041794739663601, -0.0021821456030011177, -0.005110110156238079, 0.01695757359266281, 0.028162702918052673, -0.008079113438725471, -0.014552394859492779, 0.023994680494070053, 0.024908220395445824, 0.003468594513833523, -0.005820244550704956, 0.012182902544736862, -0.044449396431446075, 0.026792393997311592, 0.003911090083420277, -0.014174132607877254, -0.012161491438746452, -0.023409444838762283, -0.009014063514769077, -0.0032634050585329533, 0.0015139415627345443, -0.026820942759513855, -0.023195333778858185, -0.005670366808772087, -0.01654362492263317, -0.007029970176517963, 0.03317289426922798, 0.008700034581124783, -0.07593795657157898, -0.022581549361348152, -0.010755497962236404, -0.02238171175122261, -0.014645176939666271, -0.0011508454335853457, -0.0021625186782330275, 0.0004224227159284055, -0.12218587845563889, 0.012289958074688911, 0.037112534046173096, 0.003545317566022277, -0.025950225070118904, 0.03542819619178772, -0.0012882330920547247, 0.020725922659039497, -0.0010223789140582085, -0.017985304817557335, -0.003911090083420277, -0.007062086835503578, -0.006430460140109062, -0.01306789368391037, 0.002157165901735425, -0.039282187819480896, 0.01563008688390255, -0.03154565393924713, 0.018327882513403893, -0.007001422345638275, -0.008935555815696716, 0.00012355975923128426, -0.017528535798192024, 0.008742856793105602, 0.00257289782166481, -0.02787722274661064, -0.030603565275669098, 0.03368676081299782, 0.02425161376595497, 0.0013542505912482738, 0.006169958505779505, -0.024708382785320282, 0.030203891918063164, 0.01671491377055645, 0.0018663322553038597, -0.031031787395477295, -0.017057491466403008, -0.011968792416155338, 0.014552394859492779, 0.016657818108797073, 0.03197387605905533, -0.05130093917250633, 0.018813200294971466, 0.02142535150051117, -0.00257289782166481, 0.006637434009462595, 0.011490611359477043, 0.046790339052677155, 0.02209623157978058, -0.0041787284426391125, -0.03988169878721237, 0.0033544020261615515, 0.01300366036593914, -0.03853993862867355, -0.03779768943786621, 0.013596033677458763, -0.011440652422606945, -0.018013853579759598, 0.002310612006112933, 0.026207158342003822, -0.00544911902397871, -0.01039864681661129, -0.009834821335971355, -0.010477153584361076, 0.0016040465561673045, -0.03768349438905716, -0.011483474634587765, 0.018641911447048187, 0.0005968337645754218, 0.0035863553639501333, -0.0062413290143013, -0.012489794753491879, -0.029318900778889656, 0.0153588792309165, 0.00387183646671474, 0.028205525130033493, -0.006301993504166603, -0.012325643561780453, -0.030917594209313393, 0.031203076243400574, -0.018056675791740417, -0.028533829376101494, 0.011861736886203289, 0.014745094813406467, 0.0010259473929181695, -0.014195543713867664, 0.027691660448908806, 0.01845634914934635, -0.041451845318078995, 0.015829922631382942, 0.011362144723534584, -0.047075822949409485, 0.008828500285744667, -0.027035053819417953, -0.01404566690325737, -0.0206260047852993, -0.02988986298441887, 0.00802201684564352, 0.0008890057797543705, -0.022110505029559135, 0.012661083601415157, 0.041994258761405945, -0.01845634914934635, -0.02946164272725582, 0.015144768171012402, 0.00175303197465837, 0.022538727149367332, -0.009642121382057667, 0.004521305672824383, -0.008821363560855389, 0.016971847042441368, 0.006437597330659628, -0.004435661248862743, 0.06040778383612633, -0.027991414070129395, 0.010684126988053322, 0.04410681873559952, -0.009071159176528454, 0.0027049328200519085, 0.0055811540223658085, -0.014181270264089108, 0.02863374724984169, 0.005527626257389784, -0.01338192354887724, -0.036655765026807785, 0.015073398128151894, 0.007572384085506201, 0.005623976234346628, 0.01181891467422247, -0.033486925065517426, 0.019112953916192055, 0.019769560545682907, -0.012332780286669731, -0.03679850324988365, -0.0033544020261615515, -0.008014880120754242, -0.0065624951384961605, 0.02997550740838051, -0.05538332089781761, 0.016900476068258286, 0.00510654179379344, 0.027035053819417953, 0.04576260969042778, -0.03417208045721054, -0.009684943594038486, -0.003925363998860121, 0.013124990276992321, 0.008350320160388947, -0.00474255345761776, 0.009513654746115208, 0.006055766250938177, -0.01612967811524868, -0.026406994089484215, -0.04850322753190994, 0.005688209552317858, 0.015159042552113533, 0.011983065865933895, -0.037911880761384964, -0.014324010349810123, -0.008179031312465668, -0.004610518459230661, 0.02379484288394451, -0.0006851544603705406, -0.018641911447048187, -0.007486740127205849, -0.010634168051183224, -0.01458808034658432, -0.02555055171251297, -0.010734086856245995, -0.00948510691523552, -0.020568907260894775, -0.009185352362692356, 0.05521203204989433, -0.006591042969375849, 0.04773242771625519, -0.003015393391251564, 0.05809538811445236, -0.02388048730790615, -0.0013596033677458763, 0.016529351472854614, -0.017143135890364647, 0.017114587128162384, -0.011640489101409912, 0.014195543713867664, 0.03437191620469093, -0.006187801249325275, 0.017314424738287926, -0.038996707648038864, -0.008485923521220684, 0.04895999655127525, -0.0011588744819164276, 0.011240815743803978, 0.016829106956720352, 0.021996313706040382, 0.0013988569844514132, 0.0036523728631436825, 0.04250812530517578, 0.009827684611082077, 0.03243064507842064, -0.003836151212453842, 0.014830739237368107, 0.004988780710846186, -0.03328708931803703, -0.013467567041516304, -0.032944511622190475, 0.020283427089452744, -0.007208395749330521, 0.01404566690325737, -0.016643544659018517, 0.02667820267379284, -0.02292412705719471, 0.007179847918450832, -0.014745094813406467, -0.0052992417477071285, -0.021982038393616676, -0.0069586001336574554, 0.02692086063325405, 0.007857865653932095, 0.0057560112327337265, -0.05321366339921951, -0.008236127905547619, -0.024494271725416183, -0.02116841822862625, 0.03614189848303795, 0.02809133380651474, 0.012953701429069042, -0.02522224932909012, -0.023894762620329857, -0.00403241952881217, 0.02841963618993759, 0.0004991457099094987, -0.024522820487618446, -0.0278914961963892, -0.007493876852095127, 0.036741409450769424, -0.004928116220980883, -0.015116220340132713, -0.01184032578021288, -0.0030189617536962032, 0.023123962804675102, 0.00232845451682806, 0.0021589503157883883, 0.010177399031817913, 0.012696769088506699, -0.008371731266379356, 0.008507334627211094, 0.0035970609169453382, 0.04176587238907814, -0.008378867991268635, 0.024451449513435364, 0.0021161281038075686, -0.0061770956963300705, 0.058123938739299774, -0.03245919197797775, 0.03322999179363251, -0.010020383633673191, 0.010662715882062912, 0.04079523682594299, -0.0003269649751018733, 0.017642727121710777, 0.016186773777008057, 0.010969608090817928, 0.0251794271171093, -0.02425161376595497, -0.04804645851254463, -0.021582365036010742, -0.030061151832342148, 0.018013853579759598, 0.009934740141034126, -0.006380500737577677, -0.03134581819176674, 0.007850727997720242, 0.006801585666835308, 0.003043941454961896, -0.002517585875466466, -0.03177403658628464, -0.006173527333885431, -0.02396613173186779, 0.024665560573339462, -0.012925153598189354, -0.04647631198167801, -0.010163124650716782, 0.03859703615307808, 0.04527729004621506, 0.008100524544715881, -0.02251017838716507, -0.03862558305263519, -0.02179647609591484, 0.012818098068237305, -0.030917594209313393, 0.01775692030787468, -0.006744489073753357, -0.01544452365487814, -0.0006445626495406032, 0.004232256207615137, -0.038911063224077225, 0.009021200239658356, -0.0028904953505843878, 0.022196149453520775, -0.023280978202819824, -0.007258355151861906, 0.035656578838825226, 0.014202681370079517, -0.02704932726919651, 0.013988570310175419, 0.02854810282588005, 0.007707987911999226, -0.022181876003742218, -0.008528745733201504, 0.015515893697738647, -0.00817189458757639, 0.03754075616598129, 0.017771193757653236, -0.0039574806578457355, 0.019227147102355957, -0.0009376267553307116, -0.03685560077428818, 0.0027691659051924944, 0.00437499675899744, 0.0014086704468354583, -0.0036149034276604652, 0.005987964570522308, 0.03919654339551926, -0.005434845108538866, -0.0005549037596210837, 0.018984489142894745, -0.020354798063635826, -0.020397618412971497, 0.005077993962913752, -0.001987661700695753, 0.0466761477291584, -0.000984909594990313, 0.03614189848303795, -0.00014931995247025043, -0.006987147964537144, -0.01955544948577881, -0.049416765570640564, 0.03622754290699959, 0.0009804489091038704, 0.0006177987670525908, 0.004881725646555424, 0.037654947489500046, 0.007486740127205849, 0.016814831644296646, -0.003911090083420277, 0.01721450500190258, -0.013303415849804878, -0.027491822838783264, -0.03331563621759415, -0.012425561435520649, 0.09106844663619995, -0.02088293619453907, -0.021896393969655037, 0.038197360932826996, 0.02012641169130802, 0.003026098944246769, 0.004871020093560219, -0.013053620234131813, -0.009156803600490093, -0.004499894566833973, -0.016786284744739532, 0.010748360306024551, 0.004200139548629522, -0.009328092448413372, 0.016643544659018517, -0.004849608987569809, 0.009163941256701946, 0.0006922914762981236, 0.02238171175122261, 0.04647631198167801, 0.059494245797395706, 0.02717779390513897, 0.007936372421681881, -1.8888027625507675e-05, -0.003657725639641285, -0.01531605701893568, -0.003611335065215826, 0.02476547844707966, 0.015872744843363762, 0.02622143179178238, 0.013496115803718567, 0.0025407811626791954, -0.008293223567306995, -0.005973690655082464, -0.03642737865447998, 0.01467372477054596, -0.026564009487628937, -0.006277014035731554, -0.005338495131582022, -0.005274261813610792, -0.049074187874794006, 0.0025122330989688635, -0.004510600119829178, 0.003925363998860121, -0.004813923966139555, -0.008328909054398537, 0.022938400506973267, -0.008100524544715881, 0.002833399223163724, -0.0194269847124815, -0.008257539011538029, -0.019655369222164154, 0.011661900207400322, -0.019526902586221695, 0.0030243145301938057, -0.064690001308918, -0.004881725646555424, 0.005259987898170948, -0.007151299621909857, 0.014074214734137058, -0.06040778383612633, 0.015515893697738647, 0.026863764971494675, -0.012675357982516289, -0.014459613710641861, -0.026521187275648117, -0.004967370070517063, 0.022724289447069168, -0.0384257473051548, 0.023694925010204315, -0.027734480798244476, -0.05190045014023781, -0.0032491309102624655, 0.029661478474736214, -0.00971349235624075, 0.01730014942586422, 0.025493456050753593, -0.039539121091365814, 0.008892733603715897, 0.024951042607426643, 0.0017824721289798617, -0.02587885409593582, -0.03243064507842064, -0.005199323408305645, 0.03876832500100136, -0.01684338040649891, 0.00971349235624075, -0.0079791946336627, 0.003589923959225416, -0.004110926762223244, -0.0019894458819180727, 0.012004476971924305, -0.00958502572029829, 0.021653736010193825, -0.01392433699220419, -0.018327882513403893, 0.009927602484822273, 0.02472265623509884, 0.0024533525574952364, -0.043707143515348434, 0.028119880706071854, 0.0010152419563382864, 0.026278529316186905, 0.017642727121710777, -0.03617044538259506, -0.03225935623049736, -0.035028520971536636, -0.011404966935515404, 0.0055204895325005054, 0.020982855930924416, 0.009142530150711536, -0.006812290754169226, 0.017014669254422188, -0.011640489101409912, 0.024537093937397003, -0.004193002358078957, -0.02487967163324356, -0.0002783439995255321, 0.05272834375500679, -0.025436358526349068, 0.005281399004161358, 0.009492244571447372, 0.015601538121700287, -0.01762845367193222, 0.002801282564178109, 0.016229595988988876, 0.011140896938741207, 0.005773853976279497, -0.014166995882987976, -0.008228990249335766, -0.032402098178863525, -0.0163866113871336, -0.014288325794041157, 0.02296694926917553, 0.02025487832725048, 0.015173316933214664, -0.0023962564300745726, -0.017314424738287926, -0.011947381310164928, 0.005848792381584644, -0.005431276746094227, 0.010384372435510159, -0.014423929154872894, 0.006548221223056316, 0.00967067014425993, -0.026663927361369133, 0.015544441528618336, 0.023109689354896545, -0.0032277198042720556, 0.0014880698872730136, -0.020783018320798874, 0.005709620658308268, 0.003186682006344199, 0.014202681370079517, -0.03054646961390972, 0.013638855889439583, 0.012182902544736862, 0.03334418311715126, -0.0037647809367626905, 0.006016512401401997, 0.012803823687136173, -0.0011579823913052678, 0.01817086711525917, 0.008864185772836208, 0.020069316029548645, 0.020040767267346382, 0.0067480579018592834, 0.0033847345039248466, 0.01375304814428091, -0.033743858337402344, 0.017114587128162384, -0.009135392494499683, -0.006187801249325275, 0.0025122330989688635, -0.0026424836833029985, -0.03245919197797775, -0.0018467053305357695, 0.04373569414019585, -0.013488978147506714, -0.015201864764094353, -0.012011614628136158, -0.017614180222153664, -0.007815043441951275, -0.011633351445198059, -0.02279566042125225, -0.008257539011538029, 0.028648020699620247, 0.003861130913719535, 0.02016923390328884, 0.01308930478990078, 0.012011614628136158, -0.020369071513414383, -0.00770085072144866, 0.019612547010183334, 0.012846645899116993, 0.001969819189980626, -0.02633562497794628, -0.015815649181604385, 0.033658213913440704, 0.023452267050743103, -0.015330331400036812, -0.0345146544277668, 0.015658633783459663, 0.01160480361431837, -0.0039003845304250717, 0.018570540472865105, -0.008928419090807438, 0.014902109280228615, 0.01471654698252678, -0.0010393293341621757, 0.021539542824029922, -0.002879789797589183, -0.008364593610167503, 0.015144768171012402, 0.019869480282068253, 0.020040767267346382, 0.009235311299562454, 0.008543020114302635, -0.03054646961390972, -0.012289958074688911, -0.0020483264233917, -0.010362961329519749, -0.010891101323068142, -0.013760185800492764, -0.010362961329519749, 0.011704722419381142, 0.001233813352882862, -0.026449816301465034, -0.011362144723534584, 0.03714108094573021, 0.017200231552124023, 0.009149666875600815, 0.000960822100751102, 0.019826658070087433, 0.02792004495859146, 0.016415158286690712, -0.004717573989182711, -0.0004424955986905843, -0.0071941218338906765, -0.023652102798223495, -0.011861736886203289, 0.04396407678723335, -0.0030029036570340395, 0.01588701829314232, -0.04827484115958214, 0.028476731851696968, 0.007736535742878914, -0.03137436509132385, 0.010926785878837109, 0.018641911447048187, 0.03968186303973198, 0.0036488042678683996, -0.004367859568446875, -0.032659027725458145, 0.00790068693459034, -0.02479402720928192, -0.0003013162931893021, -0.00802201684564352, 0.024565642699599266, 0.016486529260873795, -0.009064022451639175, -0.0011338948970660567, 0.0047996495850384235, 0.010769771412014961, 0.007779357954859734, 0.010320139117538929, -0.017185958102345467, 0.00772226182743907, 0.011412103660404682, -0.004435661248862743, -0.009642121382057667, -0.014431065879762173, -0.044706329703330994, -0.017971031367778778, 0.04039556533098221, -0.012475521303713322, 0.008435964584350586, 0.011519159190356731, 0.005313515663146973, 0.019769560545682907, 0.035913512110710144, 0.03925364091992378, -0.0006057550781406462, -0.0029904136899858713, 0.021111322566866875, 0.016429433599114418, -0.042622316628694534, 0.009820546954870224, -0.009906191378831863, 9.880319703370333e-05, 0.008421690203249454, 0.0049852123484015465, 0.007261923514306545, -0.002765597542747855, -0.007586658466607332, 0.026349898427724838, 0.0017583847511559725, -0.0057310317642986774, -0.010869690217077732, 0.00030599997262470424, -0.016600722447037697, 0.001157090300694108, -0.00881422683596611, 0.017913933843374252, -0.00504230847582221, -0.0007779357838444412, -0.021039951592683792, 0.03460029885172844, 0.010619894601404667, 0.006658845115453005, 0.024308709427714348, 0.0020322680938988924, 0.005556174553930759, -0.004039556719362736, 0.0007953323074616492, 0.022852756083011627, 0.003036804497241974, 0.016614995896816254, -0.04367859661579132, 0.05823813006281853, -0.019198598340153694, 0.0009965072385966778, 0.014231229200959206, 0.00817189458757639, 0.043193280696868896, 0.0016209969762712717, -0.02320960722863674, -0.00942087359726429, -0.009849095717072487, -0.012261410243809223, 0.014188406988978386, 0.01318922359496355, 0.02722061611711979, -0.01992657594382763, 0.017157409340143204, 0.0052314396016299725, -0.015344604849815369, 0.00036309618735685945, 0.00100275210570544, -0.028833582997322083, -0.0049138423055410385, -0.007151299621909857, -0.022867029532790184, -0.01563008688390255, -0.006876524072140455, 0.04921692982316017, 0.0004181851109024137, -0.0005896967486478388, 0.015016301535069942, -0.009128255769610405, 0.03397224098443985, -0.010263042524456978, 0.02046898938715458, -0.004567696247249842, 0.00969208125025034, 0.004442798439413309, 0.01645798049867153, 0.00397175457328558, -0.04781807214021683, -0.0073439995758235455, -0.013182085938751698, -0.018399251624941826, 0.00628415122628212, 0.04550567641854286, 0.03585641831159592, 0.02696368284523487, 0.001262361416593194, -0.008685760200023651, 0.03571367636322975, 0.015587263740599155, -0.005377748981118202, 0.00472114235162735, 0.026606831699609756, -0.04079523682594299, -0.010505701415240765, -0.0108554158359766, -0.023909036070108414, -0.05055868998169899, 0.0076152062974870205, -0.03768349438905716, 0.044620685279369354, -0.014345421455800533, 0.022267520427703857, -0.01708604022860527, 0.008978378027677536, 0.006234191823750734, -0.03622754290699959, -0.0006682040402665734, -0.028019962832331657]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
"
15NAME ::= ( [^<] )+
16NUMBER ::= ( [^<] )+
17
18#Optional space: by convention, applied in thisgrammar after
literal chars when allowed
19ws ::= ([ \\t\\n] ws)?
20
21#prompts used forgeneration
22""An XML file describing a person:""
23""An XML file of a person John Smith:""
24""An XML file of a person John Smith with friends""
25""XML of a person Jane Doe with friends""
26""An XML person:""
Listing 6. XML (with schema) Grammar and Prompts
1start: dict
2
3dict: ""{"" content ""}""
4
5content: id _pair "","" description _pair "","" name _pair "","" age _pair ""
,"" armor _pair "","" weapon _pair "","" class _pair "","" mantra _pair
"","" strength _pair "","" items _pair
6
7id_pair: ""\\""id\\"""" "":"" NUMBER
8description _pair: ""\\""description\\"""" "":"" ""\\""A nimble fighter\\""""
9name_pair: ""\\""name\\"""" "":"" STRING
10age_pair: ""\\""age\\"""" "":"" NUMBER
11armor_pair: ""\\""armor\\"""" "":"" ((""\\""leather\\"""") | (""\\""chainmail\\"""") |
(""\\""plate\\""""))
12weapon_pair: ""\\""weapon\\"""" "":"" ((""\\""sword\\"""") | (""\\""axe\\"""") | (""\\""
bow\\""""))
13class_pair: ""\\""class\\"""" "":"" STRING
14mantra_pair: ""\\""mantra\\"""" "":"" STRING
15strength _pair: ""\\""strength\\"""" "":"" NUMBER
16items_pair: ""\\""items\\"""" "":"" ""["" item "","" item "","" item ""]""
17
18item: STRING
19
20STRING: /""[^\\n\\r""]+""/
21NUMBER: /[0-9]+/
22
23WS: /[ \\t\\n]+/
24
25# prompts used for generation
26""The following is a character profile foran RPG game in JSON
format.\\n ```json\\n"",
27""A character profile foran RPG game:\\n ```json\\n"",
28""A character profile foran RPG game in JSON format:\\n ```json\\n"",
29""A character that is a level 5 human fighter with 10 strength, 10
dexterity, 10 constitution, 10 intelligence, 10 wisdom, and
10 charisma:\\n ```json\\n"",
30""JSON specifying a character that is a level 5 dwarf fighter from
a game:\\n ```json\\n""
Listing 7. Fixed Template Grammar and Prompts
D. Structured Reasoning Outputs
In our experiments, we evaluate task accuracy on GSM8K
and CoNLL2003. For these tasks, prompted and constrained
model output looks as follows:
1{
2""thoughts"": [
3 {
4 ""step"": ""Find the distance between the first and
second stops"",
5 ""calculation"": ""60 - 20 - 15"",
6 ""result"": 25
7 },
8 {9 ""step"": ""Find the distance between the first and
second stops"",
10 ""calculation"": ""25 + 15"",
11 ""result"": 40
12 }
13 ],
14 ""answer"": 40
15}
Listing 8. Structured Reasoning Output for GSM8K
1{
2""tokens"": [
3 {
4 ""token"": ""Nadim"",
5 ""tag"": ""B-PER""
6 },
7 {
8 ""token"": ""Ladki"",
9 ""tag"": ""I-PER""
10 }
11 ]
12}
Listing 9. Structured Reasoning Output for CoNLL2003
In practice, such outputs greatly facilitate downstream pro-
cessing of LLM outputs, as they are already in a structured
format and can be easily parsed.
Few-Shot Demonstrations For few-shot demonstrations,
we alternate between questions and answers using a simple
Q: ... \\n A: ... \\n ... format.
14
","[0.028754448518157005, 0.03311029076576233, 0.0442059189081192, -0.011566528119146824, -0.0014816855546087027, 0.0197043027728796, 0.010639440268278122, 0.02682669274508953, 0.03593570366501808, 0.07063528895378113, 0.014517023228108883, -0.055684152990579605, 0.022750448435544968, -0.007688945159316063, 0.007490283809602261, 8.484512363793328e-05, -0.014340435154736042, -0.015024714171886444, -0.006276239641010761, 0.04102732986211777, 0.06598512828350067, -0.02292703650891781, 0.007295300718396902, 0.01817387156188488, 0.02328021265566349, -0.012868866324424744, -0.041468799114227295, 0.040880173444747925, 0.00506587466225028, -0.04585407301783562, 0.02481064386665821, -0.03905542939901352, 0.026017330586910248, -0.010727734304964542, -0.010889606550335884, 0.03808419406414032, 0.031285546720027924, -0.00243728538043797, 0.015245449729263783, -0.022956468164920807, -0.007214364595711231, -0.04732564091682434, -0.008726401254534721, -0.036259446293115616, -0.008159846998751163, 0.03269825130701065, -0.03449356555938721, 0.0235598124563694, -0.00032719405135139823, 0.02647351659834385, -0.06686807423830032, 0.05883330851793289, 0.0022257473319768906, 0.03614172339439392, -0.023368507623672485, -0.03431697562336922, -0.030844075605273247, 0.03160928934812546, 0.035670820623636246, -0.029490232467651367, 0.0187624990940094, -0.07057642191648483, 0.028798595070838928, 0.07069414854049683, -0.01527488138526678, 0.0037856099661439657, -0.03693636879324913, -0.021661488339304924, 0.02769491821527481, 0.011228067800402641, 0.040114957839250565, 0.043735016137361526, 0.010021381080150604, 0.002645144471898675, -0.014708327129483223, 0.01623140089213848, 0.025413988158106804, 0.03631830960512161, -0.018909655511379242, -0.038937702775001526, 0.004201327916234732, -0.0326688215136528, 0.02662067487835884, -0.06586740911006927, 0.00413510762155056, 0.01715848781168461, 0.00036260366323404014, 0.0018596947193145752, -0.07822857797145844, -0.042969800531864166, -0.07204799354076385, -0.02772434987127781, 0.02011634036898613, 0.021072860807180405, 0.08199579268693924, 0.010256832465529442, -0.011198636144399643, 0.006232092622667551, 0.001480765757150948, 0.021529046818614006, 0.01883607730269432, -0.014833410270512104, -0.011404655873775482, -0.0033717313781380653, 0.038437370210886, 0.04370558261871338, 0.012346459552645683, 0.03905542939901352, -0.03228621184825897, -0.02129359543323517, -0.1290271282196045, -0.010256832465529442, -0.029519664123654366, 0.01799728348851204, 0.043587859719991684, 0.0015598626341670752, -0.050504229962825775, -0.00531604140996933, -0.00533443596214056, -0.018011998385190964, -0.001164378598332405, -0.001458692247979343, -0.00578694324940443, -0.04073301702737808, 0.012044788338243961, 0.00509898504242301, 0.013663513585925102, -0.014862841926515102, 0.002658020704984665, -0.0050695533864200115, 0.010845459997653961, -0.011941778473556042, 0.032786544412374496, -0.002485111355781555, -0.0712239146232605, 0.0093665337190032, -0.044735681265592575, -0.03534707427024841, -0.027945086359977722, 0.05129887908697128, -0.0064454698003828526, -0.027503615245223045, 0.005562528967857361, 0.04508885741233826, -0.019439419731497765, 0.020557811483740807, -0.05076911300420761, 0.05174034833908081, -0.06710352003574371, 0.029769830405712128, 0.013678229413926601, 0.00684647262096405, -0.04611895605921745, 0.008395298384130001, 0.011890273541212082, -0.07081187516450882, -0.02595846727490425, 0.016187254339456558, 0.010087601840496063, -0.01301602367311716, -0.0020473196636885405, -0.009690278209745884, 0.0011441444512456656, 0.0010779239237308502, -0.017114341259002686, -0.0017732400447130203, 0.015686919912695885, 0.05544869974255562, -0.07964129000902176, -0.006596305873245001, -0.04085073992609978, -0.04791427031159401, -0.04976844787597656, -0.010977900587022305, -0.037819311022758484, -0.006283597555011511, -0.011492949910461903, -0.02578187920153141, -0.03054976277053356, -0.020543096587061882, -0.03425811603665352, 0.01942470483481884, -0.03522935137152672, -0.02008691057562828, 0.009528405964374542, -0.05792093649506569, -0.015495616011321545, 0.0068906196393072605, -0.01605481281876564, 0.015407321974635124, -0.009579910896718502, 0.02953437902033329, 0.05639050528407097, -0.011890273541212082, -0.006357175763696432, -0.07758109271526337, 0.09317971765995026, 0.004767881706357002, -0.009145798161625862, 0.010889606550335884, 0.015157155692577362, 0.05441860109567642, -0.00463911984115839, -0.046854741871356964, 0.008226067759096622, 0.020410655066370964, 0.003504172433167696, -0.020513664931058884, -0.02414843812584877, -0.04882664233446121, 0.03958519175648689, -0.01598123461008072, 0.022750448435544968, 0.027327027171850204, -0.04246946796774864, 0.01814443990588188, -0.05503666028380394, -0.016025381162762642, -0.01350164134055376, -0.010506998747587204, -0.010845459997653961, 0.06398379802703857, 0.05903932824730873, -0.029490232467651367, -0.048002563416957855, 0.024015998467803, 0.0020509986206889153, -0.03440527245402336, 0.01817387156188488, -0.06627944856882095, 0.04941527172923088, 0.014237425290048122, -0.013148464262485504, -0.05815638601779938, 0.002141132252290845, -0.032786544412374496, -0.008969210088253021, -0.01661400869488716, 0.002996481256559491, -0.00020590462372638285, -0.013825385831296444, 0.022117674350738525, 0.05559585615992546, -0.006390286143869162, 0.021249448880553246, 0.012317027896642685, -0.017349792644381523, -0.05459519103169441, 0.03116782009601593, -0.002076751086860895, 0.04959185793995857, -0.02233840897679329, -0.025252114981412888, -0.03717181831598282, -0.052829310297966, -0.01574578322470188, -0.037407271564006805, 0.036259446293115616, -0.02856314368546009, 0.0066993157379329205, -0.013214685022830963, 0.00655951676890254, -0.015731066465377808, 0.036436036229133606, -0.03517048805952072, 0.02585545927286148, -0.03234507516026497, 0.02272101677954197, 0.0098521513864398, -0.0327276848256588, -0.028165820986032486, -0.013229400850832462, 0.0041314284317195415, 0.002722401637583971, -0.04597179964184761, -0.03405209630727768, -0.01094846986234188, 0.011515023186802864, -0.009844793006777763, 0.02074911631643772, -0.021484900265932083, 0.006379249505698681, 0.035876840353012085, 0.03961462527513504, -0.006651489529758692, 0.0206755381077528, -0.017320360988378525, -0.0022864495404064655, -0.014811336994171143, -0.018527047708630562, 0.05206409469246864, 0.0035096907522529364, 0.05085740610957146, 0.0006580670597031713, -0.02588488906621933, -0.06115838512778282, 0.01590765453875065, 0.0173056460916996, 0.03328688070178032, -0.004863533657044172, 0.011338435113430023, 0.023545095697045326, -0.00874111708253622, 0.00821871031075716, -0.021970517933368683, 0.03157985955476761, -0.029975850135087967, -0.03487617149949074, 0.026532379910349846, -0.027179870754480362, 0.003951161168515682, 0.0245016161352396, -0.012913013808429241, 0.03328688070178032, -0.03908485919237137, -0.0730486586689949, 0.05694970116019249, -0.008785263635218143, 0.0414099358022213, -0.015068861655890942, -0.030461467802524567, -0.025281546637415886, 0.03449356555938721, -0.018527047708630562, -0.03258052468299866, 0.008086268790066242, -0.01470096968114376, 0.015525047667324543, -0.023339075967669487, -0.02185279130935669, -0.04176311194896698, -0.015480900183320045, 0.010359842330217361, 0.05076911300420761, 0.011743116192519665, -0.054742347449064255, -0.015245449729263783, 0.04497113451361656, 0.023133056238293648, 0.06963462382555008, -0.041262779384851456, -0.006456506904214621, -0.05268215015530586, -0.021646773442626, -0.03923201560974121, 0.05692026764154434, 0.03190360590815544, 0.059186484664678574, 0.041262779384851456, 0.005157847423106432, 0.008623391389846802, 0.022353125736117363, 0.015569194220006466, 0.008292288519442081, -0.013163180090487003, -0.04211629182100296, -0.021808644756674767, -0.02915177121758461, 0.014104983769357204, 0.05939250439405441, -0.028327694162726402, 0.008365866728127003, 0.0011349471751600504, 0.048385173082351685, -0.015613341704010963, 0.03834907338023186, -0.04249889776110649, 0.012074219062924385, -0.014450802467763424, -0.01605481281876564, 0.033934369683265686, 0.017423370853066444, -0.00608125701546669, 0.005709685850888491, -0.03022601641714573, 0.009675562381744385, -0.023500949144363403, 0.03773101791739464, -0.012920371256768703, 0.013906322419643402, -0.0026764152571558952, -0.01712905801832676, -0.031285546720027924, -0.018718350678682327, 0.009167871437966824, 0.008608675561845303, 0.022941753268241882, 0.01782069355249405, -0.025693586096167564, -0.030667487531900406, 0.014060837216675282, -0.015230733901262283, -0.004701661411672831, -0.018703635782003403, 0.02320663444697857, 0.030005281791090965, 0.04208685830235481, 0.05400656536221504, 0.02202938124537468, 0.017850125208497047, 0.015002640895545483, -0.003991629462689161, -0.03096180036664009, -0.0007794714183546603, -0.011721042916178703, 0.016967184841632843, -0.012206660583615303, 0.013950468972325325, 0.01331033743917942, -0.020160488784313202, 0.03016715496778488, -0.024766497313976288, 0.0316975861787796, 0.013008665293455124, -0.011073553003370762, -0.06021658331155777, -0.008822052739560604, 0.037407271564006805, 0.04117448627948761, 0.027327027171850204, -0.029166487976908684, -0.04485340788960457, -0.016481567174196243, -0.03937917202711105, -0.011809336952865124, 0.040291544049978256, -0.014848126098513603, -0.04694303497672081, 0.00127934489864856, -0.04399989917874336, -0.03293370455503464, 0.050504229962825775, 0.033640056848526, -0.012773214839398861, 0.0326688215136528, -0.014561169780790806, 0.029446085914969444, 0.03428754583001137, 0.016187254339456558, -0.03231564536690712, -0.002148489933460951, -0.006905335001647472, 0.010933754034340382, 0.002036282792687416, -0.04535374045372009, 0.0072989799082279205, -0.01699661649763584, -0.019748449325561523, 0.046089526265859604, -0.047825977206230164, -0.012464185245335102, -0.02223539911210537, 0.027076860889792442, 0.028430704027414322, -0.01654043048620224, -0.05285874009132385, 0.09894826263189316, -0.016143105924129486, 0.019969183951616287, -0.005260857287794352, 0.002183439675718546, 0.021175870671868324, 0.0046317619271576405, -0.0005049319588579237, -0.03714238852262497, 0.032021328806877136, -0.02425144799053669, -0.0044404580257833, 0.047973133623600006, 0.032992564141750336, -0.02932835929095745, -0.01743808574974537, -0.014906988479197025, -0.03425811603665352, -0.02133774384856224, 0.0364948995411396, 0.04064472019672394, -0.019218685105443, 0.0053528305143117905, -0.004558183252811432, 0.02373640052974224, -0.020866841077804565, 0.052034661173820496, 0.008490949869155884, 0.00994044542312622, 0.059922270476818085, 0.013972543179988861, -0.01574578322470188, 0.02223539911210537, 0.00246303784660995, 0.0009675562614575028, -0.021028714254498482, 0.03911428898572922, -0.017496949061751366, 0.02859257534146309, -0.009498974308371544, 0.03726011514663696, -0.027945086359977722, 0.0033846076112240553, -0.041674818843603134, -0.02692970260977745, 0.00797590147703886, -0.010418704710900784, 0.06845736503601074, 0.022176537662744522, -0.008836768567562103, 0.03593570366501808, 0.011978567577898502, 0.008292288519442081, 0.02414843812584877, 0.0120079992339015, -0.021381890401244164, 0.003656847635284066, -0.0021264164242893457, -0.0035280855372548103, 0.00832172017544508, -0.014340435154736042, 0.017393939197063446, -0.02831297740340233, 0.0374661348760128, 0.001053091255016625, 0.01508357748389244, -0.005209352355450392, -0.009933087043464184, -0.008468876592814922, -0.014818694442510605, 0.014833410270512104, -0.07422591745853424, -0.00898392591625452, -0.018262164667248726, 0.01282471977174282, 0.0020565169397741556, 0.021249448880553246, 0.056272778660058975, -0.0297845471650362, 0.00035800502519123256, 0.007659513968974352, -0.022456135600805283, -0.023236066102981567, -0.011684253811836243, -0.009013356640934944, 0.008814695291221142, 0.01656986214220524, 0.0009376650559715927, 0.019969183951616287, 0.02300061471760273, 0.01858590915799141, -0.0356413871049881, -0.006875903811305761, 0.004388953093439341, 0.04367615282535553, -0.03019658476114273, 0.02907819300889969, -0.05653766170144081, -0.01674645021557808, 0.03543537110090256, 0.015480900183320045, -0.01113977376371622, -0.03419925272464752, -0.030638055875897408, 0.009925729595124722, -0.014620033092796803, 0.005054837558418512, -0.009999307803809643, -0.0132073275744915, 0.017320360988378525, 0.016069527715444565, -0.0002346461988054216, -0.0069200508296489716, 0.019895605742931366, -0.015142439864575863, -0.04888550564646721, 0.03802533075213432, -0.04812029004096985, 0.009498974308371544, -0.054918937385082245, -0.01983674243092537, 0.03231564536690712, 0.002131934743374586, -0.010735091753304005, -0.006283597555011511, -0.06109952554106712, -0.003296313341706991, -0.0061033302918076515, -0.05833297595381737, -0.011787263676524162, 0.032786544412374496, 0.004653835203498602, -0.037995897233486176, -0.0037966466043144464, 0.011044121347367764, -0.005235104821622372, -0.013670871034264565, 0.032403938472270966, 0.0002867259318009019, 4.127289867028594e-05, -0.009778572246432304, -0.021705634891986847, -0.050916269421577454, -0.011787263676524162, 0.03534707427024841, 0.00425651203840971, -0.03478787839412689, 0.03961462527513504, -0.021117007359862328, 0.013729734346270561, -0.030638055875897408, 0.009079577401280403, -0.008822052739560604, 0.020896272733807564, -0.03193303570151329, 0.01674645021557808, -0.02511967346072197, -0.01973373256623745, -0.04099789634346962, 0.02289760485291481, -0.03387550637125969, -0.008763190358877182, -0.00024257886980194598, -0.025840742513537407, 0.001448575290851295, 0.01740865595638752, -0.009109009057283401, 0.0122508080676198, 0.015142439864575863, 0.02481064386665821, -0.01590765453875065, -0.012331743724644184, -0.04370558261871338, -0.029681537300348282, -0.03599456697702408, -0.01949828304350376, 0.025001948699355125, -0.0032282534521073103, -0.01715848781168461, 0.009167871437966824, -0.0032595242373645306, 0.027503615245223045, -0.020763831213116646, -0.031108958646655083, 0.0034765806049108505, 0.00943275447934866, 0.0051688845269382, -0.027150439098477364, 0.05524268001317978, 0.006611021235585213, -0.020160488784313202, -0.014642106369137764, -0.014693611301481724, -0.026429370045661926, -0.029313644394278526, -0.057214584201574326, 0.028298262506723404, -0.015068861655890942, 0.015686919912695885, -0.011713685467839241, -0.028327694162726402, -0.012074219062924385, -0.004547146614640951, 0.007368879392743111, -0.04661928862333298, -0.005654501728713512, 0.02491365373134613, 0.0034637043718248606, 0.01567220501601696, 0.08340850472450256, 0.00418661255389452, 0.013486925512552261, -0.031668152660131454, 0.006625737063586712, -0.03325744718313217, -0.02199994958937168, 0.017084909602999687, -0.007045133970677853, 0.002509024227038026, -0.024589909240603447, -0.03001999668776989, -0.026223350316286087, 0.018291596323251724, 0.007703660987317562, -0.022147106006741524, 0.009263523854315281, -0.038967132568359375, -0.008189278654754162, 0.010139106772840023, 0.005146810784935951, 0.025840742513537407, -0.013818028382956982, 0.02657652646303177, 0.03308086097240448, 0.012287597171962261, -0.02272101677954197, -0.0079391123726964, -0.01799728348851204, 0.009778572246432304, -0.005242462735623121, 0.0008397137862630188, 0.04658985882997513, -0.01181669533252716, -0.04850289598107338, -0.03985007479786873, -0.007953827269375324, -0.0091237248852849, -0.026738399639725685, -0.010300979018211365, -0.04411762207746506, -0.03543537110090256, 0.00981536228209734, 0.05500723049044609, -0.013266189955174923, -0.015098292380571365, 0.004602330271154642, -0.03428754583001137, 0.016069527715444565, -0.014811336994171143, -0.002853003330528736, 0.008343793451786041, -0.006982592400163412, 0.014855483546853065, 0.007953827269375324, -0.010514357127249241, 0.012765856459736824, -0.002658020704984665, -0.019100958481431007, -0.012552479282021523, -0.03911428898572922, 0.005216710269451141, 0.026017330586910248, -0.01768825389444828, -0.013222042471170425, 0.01807086169719696, 0.0235303808003664, 0.007497641257941723, -0.005132094956934452, -0.007777239661663771, -0.00047917949268594384, -0.0751088559627533, 0.018571194261312485, -0.013781239278614521, -0.032433368265628815, 0.008468876592814922, -0.016201969236135483, -0.013597292825579643, 0.022603292018175125, -0.012317027896642685, 0.02557585947215557, -0.02373640052974224, 0.0442647784948349, -0.041439369320869446, 0.0027720672078430653, -0.01712905801832676, 0.01570163667201996, -0.02797451615333557, -0.01927754655480385, 0.0158782247453928, -0.02286817505955696, 0.0029891235753893852, -0.0031197252683341503, -0.017835410311818123, 0.01263341587036848, -0.00907221995294094, 0.006136440671980381, -0.00684647262096405, 0.004311695694923401, 0.009646131657063961, 0.005775906145572662, 0.024280879646539688, -0.006611021235585213, -0.0013740770518779755, 0.010308337397873402, -0.014774547889828682, -0.00014267316146288067, -0.0038665463216602802, -0.006894298363476992, 0.05733230710029602, -0.0008185599581338465, -0.004411026369780302, 0.011515023186802864, -0.007755165919661522, 0.0072879428043961525, -0.0103230532258749, -0.00806419551372528, 0.009270881302654743, -0.035111624747514725, -0.0022386235650628805, -0.01802671328186989, -0.024001281708478928, 0.030726350843906403, -0.004407347645610571, -0.0729897990822792, -0.04653099551796913, -0.02511967346072197, -0.017673537135124207, -0.021602625027298927, 0.003818720346316695, 0.009690278209745884, -0.004260190762579441, -0.14115284383296967, -0.010786596685647964, 0.03923201560974121, -0.02776849828660488, -0.0011993283405900002, 0.009410680271685123, 0.009822719730436802, 0.013383915647864342, -0.009844793006777763, -0.042440034449100494, -0.01331033743917942, -0.02815110608935356, -0.001190131064504385, -0.0096093425527215, -0.0028622006066143513, -0.037230681627988815, 0.016864174976944923, -0.03637717291712761, 0.00485617620870471, -0.014252141118049622, -0.011654822155833244, -0.008387940004467964, -0.0015304312109947205, 0.011824052780866623, -0.0032153772190213203, -0.017217351123690605, -0.03334574028849602, 0.02414843812584877, 0.01570163667201996, 0.016496282070875168, -0.005396977532655001, -0.010227400809526443, 0.015657488256692886, 0.01740865595638752, -0.021028714254498482, -0.02126416563987732, -0.02310362458229065, -0.0001589983730809763, 0.017805978655815125, 0.002141132252290845, 0.0327276848256588, -0.021882222965359688, 0.015539763495326042, -0.002497987588867545, 0.020587243139743805, -0.02557585947215557, -0.0033901259303092957, 0.0187330674380064, 0.04347013309597969, -0.0036366137210279703, -0.021352458745241165, 0.026841409504413605, -0.005488950293511152, -0.007390952669084072, -0.017143772915005684, 0.037407271564006805, -0.011721042916178703, -0.018806645646691322, -0.002700328128412366, 0.008343793451786041, -0.020145772024989128, -0.005216710269451141, 0.012677562423050404, -0.00927823968231678, -0.016378557309508324, -0.03881997615098953, 0.008100984618067741, 0.000788208853919059, -0.009778572246432304, -0.015731066465377808, -0.009410680271685123, 0.02136717364192009, -0.002039961749687791, -0.014575885608792305, -0.0011533418437466025, 0.019189253449440002, -0.0008571886573918164, 0.00446621049195528, -0.043205250054597855, 0.02741532027721405, 0.0037451419048011303, -0.03681864216923714, 0.018997948616743088, 0.028415987268090248, -0.0045655411668121815, 0.00142926094122231, 0.028754448518157005, -0.0010714858071878552, -0.045324310660362244, 0.021941086277365685, 0.025443419814109802, -0.010742450132966042, -0.007681587710976601, -0.00804212223738432, -0.0355236642062664, -0.0015874544624239206, -0.0054374453611671925, 0.006489616818726063, 0.01268492080271244, -0.002352670067921281, 0.04117448627948761, 0.03096180036664009, -0.014767189510166645, -0.0036623661871999502, 0.015731066465377808, 0.0007679748232476413, -0.00473477179184556, -0.001739209983497858, 0.00763744069263339, -0.01605481281876564, 0.025634722784161568, -0.00440366892144084, 0.004929754417389631, 0.01983674243092537, -0.021455468609929085, 0.024280879646539688, 0.048385173082351685, 0.0029817656613886356, 0.014597959816455841, 0.006504332646727562, 0.008211351931095123, 0.0346112921833992, -0.003082935931161046, 0.006375570315867662, -0.023500949144363403, 0.026738399639725685, 0.009256165474653244, 0.01858590915799141, -0.008226067759096622, -0.013722375966608524, 0.02011634036898613, 0.025929037481546402, -0.017747115343809128, -0.008123057894408703, 0.0005191877717152238, 0.006397644057869911, 0.028680870309472084, 0.028445418924093246, -0.04058586061000824, 0.011551812291145325, 0.0009280078811571002, 0.02216182090342045, 0.03422868251800537, -0.023574527353048325, -0.005683933384716511, -0.022117674350738525, 0.029961135238409042, -0.001547906082123518, -0.013096959330141544, 0.0015782571863383055, -0.013244116678833961, 0.00477891881018877, 0.0013198129599913955, -0.029210634529590607, 0.02723873220384121, 0.028474850580096245, 0.006883261725306511, -0.050327643752098083, 0.0072585116140544415, 0.009403322823345661, -0.02394242025911808, 0.014958493411540985, -0.009410680271685123, -0.02999056503176689, 0.0036163795739412308, -0.013685586862266064, -0.0062541658990085125, -0.022500282153487206, -0.02894575148820877, 0.022191252559423447, -0.04753166064620018, -0.00433376943692565, 0.03887883946299553, 0.000998827163130045, 0.03755442798137665, 0.02046951837837696, 0.03190360590815544, 0.0009385847952216864, -0.007225401233881712, 0.03213905543088913, -0.023221351206302643, 0.021970517933368683, -0.012810003943741322, 0.0076668718829751015, 0.04632497578859329, 0.005246141459792852, 0.002096985001116991, -0.021249448880553246, 0.011993283405900002, 0.014833410270512104, 0.0221029594540596, 0.007644798140972853, 0.02227954752743244, 0.02435445785522461, 0.015760498121380806, 0.004138786345720291, 0.023427370935678482, 0.023191919550299644, 0.011110342107713223, -0.01626083254814148, 0.00018659028864931315, 0.013244116678833961, -0.013052812777459621, -0.02575244940817356, -0.028298262506723404, 0.0413510762155056, -0.01301602367311716, 0.012081577442586422, -0.02613505721092224, 0.017908988520503044, -0.022191252559423447, 0.0036053427029401064, 0.0016481566708534956, -0.009977234527468681, -0.018894938752055168, -0.0024520009756088257, 0.00744613679125905, 0.015789929777383804, 0.00028856538119725883, -0.051475465297698975, -0.0016959826461970806, -0.0356413871049881, -0.04444136843085289, 0.0015506652416661382, 0.0047825975343585014, 0.03040260449051857, 0.014862841926515102, 0.00345818605273962, -0.004697982221841812, 0.013634081929922104, -0.007218043319880962, 0.00754178874194622, -0.009874224662780762, -0.011492949910461903, 0.024766497313976288, -0.016525713726878166, 0.0035060120280832052, -0.0173056460916996, 0.0016003306955099106, 0.0008098225225694478, 0.025031380355358124, -0.017555812373757362, -0.0006851991056464612, 0.0051688845269382, -0.014848126098513603, -0.007527072913944721, 0.018335742875933647, 0.04017382115125656, -0.024383889511227608, 0.020660821348428726, 0.012890939600765705, -0.018821360543370247, 0.04979787766933441, -0.01590765453875065, 0.03623001649975777, -0.00821871031075716, 0.008535097353160381, 0.04158652573823929, 0.022117674350738525, 0.03923201560974121, -0.013648797757923603, 0.02511967346072197, 0.009616700001060963, -0.03116782009601593, -0.014421370811760426, -0.030255448073148727, -0.03390493988990784, -0.012191944755613804, 0.030520331114530563, -0.007585935760289431, -0.05842126905918121, 0.03496446833014488, 0.007865533232688904, 0.004867212846875191, 0.006912692915648222, 0.01656986214220524, -0.017850125208497047, -0.03776044771075249, 0.03419925272464752, 0.002623070729896426, -0.027121007442474365, 0.003590627107769251, 0.04058586061000824, 0.038378506898880005, -0.0026285892818123102, -0.053005896508693695, -0.02790093794465065, -0.01963072456419468, 0.011250141076743603, -0.02654709480702877, 0.02766548842191696, -0.0018081897869706154, -0.007917038165032864, -0.01567220501601696, 0.008593959733843803, -0.011426729150116444, 0.015098292380571365, -0.0024722351226955652, 0.045147720724344254, -0.03623001649975777, 0.005371225066483021, 0.015186586417257786, 0.04314638674259186, -0.04170425236225128, 0.022676870226860046, 0.03711295872926712, 0.01904209703207016, -0.02588488906621933, 0.010587935335934162, -0.01115448959171772, -0.0008033844060264528, 0.02220596931874752, 0.02358924224972725, -0.0009804324945434928, 0.006956839933991432, -0.0091384407132864, -0.00684647262096405, 0.007361521478742361, -0.01023475918918848, -0.014494949951767921, -0.020337076857686043, 0.008108342066407204, 0.03352233022451401, 0.006239450536668301, 0.004550825338810682, 0.00922673474997282, -0.003627416444942355, -0.020587243139743805, 0.019895605742931366, -0.010955827310681343, 0.014929062686860561, 0.0009712352184578776, 0.019086243584752083, 0.014296287670731544, -0.013759165070950985, -0.021941086277365685, -0.0490032322704792, 0.017349792644381523, 0.0003202960651833564, -0.012854150496423244, -0.002521900460124016, 0.01407555304467678, -0.009197303093969822, -0.000606102286837995, -0.003277918789535761, 0.01855647936463356, 0.0037580181378871202, -0.002893471624702215, 0.00827021524310112, 0.002269894350320101, 0.09005998820066452, -0.004164538811892271, -0.034140389412641525, 0.018011998385190964, 0.04123334959149361, 0.010602651163935661, 0.010587935335934162, -0.024766497313976288, -0.01848290115594864, 0.0177618321031332, -0.007644798140972853, 0.01893908716738224, 0.00273711746558547, -0.019748449325561523, 0.0012453148374333978, 0.0081819212064147, 0.002422569552436471, 0.021941086277365685, 0.012890939600765705, 0.033698920160532, 0.04611895605921745, 0.03961462527513504, 0.008696969598531723, 0.005032764282077551, -0.011404655873775482, 0.006118046119809151, 0.013589935377240181, 0.025723017752170563, 0.022044096142053604, 0.03343403711915016, 0.002630428643897176, -0.014097626321017742, -0.011860841885209084, 0.004745808430016041, -0.0136929452419281, 0.016187254339456558, -0.02772434987127781, 0.02723873220384121, -0.01656986214220524, 0.001133107696659863, -0.005867879372090101, 0.005650823004543781, 0.0029229028150439262, 0.01038927398622036, -0.015525047667324543, 0.026591243222355843, 0.020278213545680046, 0.0013648797757923603, 0.013442778028547764, -0.03196246922016144, 0.010227400809526443, 0.013508998788893223, 0.012140439823269844, -0.011647464707493782, 0.01139729842543602, -0.06716238707304001, -0.008917705155909061, 0.006691957823932171, 0.00847623497247696, 0.019895605742931366, -0.04061529040336609, 0.007030418608337641, 0.016555145382881165, -0.014046121388673782, -0.016143105924129486, -0.03734840825200081, -0.011448802426457405, -0.0032926343847066164, -0.023648105561733246, 0.006213698070496321, -0.0038849408738315105, -0.03325744718313217, 0.0006714031333103776, 0.01911567524075508, -0.006997308228164911, 0.01980731263756752, 0.025826027616858482, -0.02575244940817356, -0.002917384495958686, 0.03658319264650345, 0.013428062200546265, -0.036671485751867294, -0.041468799114227295, -0.015436753630638123, 0.00783610250800848, -0.0018964839400723577, 0.0062247347086668015, -0.0002144121244782582, -0.02074911631643772, 0.01072037685662508, 0.008961851708590984, -0.003434272948652506, 0.0182474497705698, 0.020660821348428726, -0.032197918742895126, 0.002100663958117366, -0.0018247449770569801, 0.014583243988454342, -0.0012177228927612305, -0.04461795836687088, 0.01162539143115282, 0.009653489105403423, -0.005113700404763222, 0.010793955065310001, -0.03987950459122658, -0.015127724036574364, -0.03137383982539177, -0.013921038247644901, 0.01181669533252716, 0.0423811711370945, 0.0009592787246219814, 0.008380582556128502, 0.019586576148867607, 0.016098959371447563, 0.014296287670731544, -0.02144075371325016, -0.011632748879492283, 0.0197043027728796, 0.00668092118576169, -0.03776044771075249, 0.020925704389810562, 0.009042788296937943, 0.0084100142121315, 0.016481567174196243, 0.012486258521676064, 0.027297595515847206, -0.013052812777459621, -0.013347126543521881, 0.0025734053924679756, -0.027650771662592888, -0.012920371256768703, -0.01014646515250206, -0.004436778835952282, 0.04458852484822273, 0.019203968346118927, -0.005463197827339172, -0.009212018921971321, -0.0374661348760128, -0.022088242694735527, 0.019159821793437004, 0.017732400447130203, 0.037642721086740494, -0.010161180049180984, 0.004966543521732092, 0.04035040736198425, -0.018850792199373245, 0.012898297980427742, 0.0016895445296540856, 0.013773880898952484, 0.006180587690323591, 0.005956173408776522, -0.027091575786471367, 0.01671701855957508, 0.011721042916178703, -0.019292263314127922, 0.0009059343719854951, 5.4982629080768675e-05, 0.014870199374854565, -0.006357175763696432, 0.002027085516601801, -0.003086614888161421, -0.005779585335403681, -0.0073835947550833225, 0.014215352013707161, 0.020278213545680046, 0.02869558520615101, -0.017349792644381523, 0.00806419551372528, 0.020763831213116646, -0.014362508431077003, 0.01782069355249405, 0.0005927661550231278, 0.018011998385190964, -0.00879262201488018, -0.0117651904001832, -0.015407321974635124, -0.00555149232968688, 0.04726678133010864, -0.01939527317881584, 0.0018468184862285852, 0.0045655411668121815, -0.006754499394446611, -0.0012995789293199778, -0.018424037843942642, -0.030461467802524567, -0.010440777987241745, 0.025443419814109802, -0.00317123020067811, 0.015510331839323044, 0.013560503721237183, 0.024104291573166847, -0.00159205321688205, -0.012206660583615303, 0.005540455225855112, 0.02912233956158161, 0.04229287803173065, -0.026870841160416603, 0.010220043361186981, 0.045912936329841614, 0.0034802595619112253, 0.0005017129005864263, -0.04450023174285889, 0.0014430568553507328, -0.00026649184292182326, -0.03734840825200081, 0.02662067487835884, -0.018909655511379242, 0.0023600279819220304, 0.0013520035427063704, -0.014303646050393581, 0.038437370210886, -0.009822719730436802, 0.007240117061883211, 0.03199189901351929, 0.02046951837837696, 0.020557811483740807, 0.010256832465529442, -0.0067949676886200905, -0.020248781889677048, 0.0064822593703866005, 0.00029983208514750004, -0.011927062645554543, -0.01426685694605112, -0.021249448880553246, 0.011073553003370762, 0.0019774201791733503, 0.038407936692237854, -0.009528405964374542, -0.01973373256623745, 0.018894938752055168, 0.032197918742895126, -0.020410655066370964, 0.005739117041230202, 0.032050762325525284, 0.017393939197063446, 0.005246141459792852, 0.003191464114934206, -0.006239450536668301, 0.007427741773426533, -0.016422703862190247, -0.03402266278862953, 0.03605342656373978, 0.03016715496778488, 0.00981536228209734, -0.025384556502103806, 0.02848956547677517, 0.011117699556052685, 0.005739117041230202, -0.005661859642714262, -0.00713342847302556, 0.03496446833014488, 0.006040788721293211, -0.01966015435755253, -0.026708967983722687, 0.016172537580132484, -0.0394674651324749, -0.007218043319880962, -0.002935779048129916, 0.008961851708590984, 0.007917038165032864, -0.01737922430038452, 0.0005849484587088227, -0.016304979100823402, 0.009101650677621365, 0.0044147055596113205, 0.013987258076667786, -0.03699523210525513, -0.016187254339456558, 0.012147798202931881, 0.009543121792376041, -0.0017943938728421926, -0.017040763050317764, -0.01695246994495392, -0.01692303828895092, 0.011522381566464901, -0.005945136770606041, 0.012758499011397362, 0.009373891167342663, -0.014222709462046623, 0.010816028341650963, 0.02144075371325016, 0.0010006665252149105, -0.0067839305847883224, 0.013928395695984364, 0.04193970188498497, 0.018291596323251724, -0.022735733538866043, 0.0073946318589150906, 0.007376236841082573, -0.01047756802290678, 0.012780572287738323, 0.0235303808003664, 0.01945413462817669, -0.008174562826752663, 0.006806004326790571, 0.03228621184825897, 0.0201899204403162, 0.0004856176092289388, -0.016967184841632843, -0.007953827269375324, -0.01945413462817669, -0.01605481281876564, 0.008277572691440582, 0.003980592824518681, 0.0067839305847883224, 0.01018325425684452, -0.01643742062151432, 0.04611895605921745, -0.004834102466702461, 0.009756498970091343, 0.02779792807996273, 0.00115518132224679, -0.00598560506477952, -0.010058170184493065, 0.02345680259168148, 0.0023912987671792507, 0.008351150900125504, 0.006831756792962551, -0.026046762242913246, 0.051652055233716965, -0.02060195803642273, 0.002645144471898675, -0.007030418608337641, 0.019512997940182686, 0.05930421128869057, 0.022559145465493202, -0.026988565921783447, 0.019763164222240448, -0.023265497758984566, -0.014568528160452843, 0.025252114981412888, 0.019689586013555527, 0.012515690177679062, 0.007398310583084822, 0.011088268831372261, -0.019822027534246445, 0.0002064794534817338, 0.01723206788301468, 0.01720263622701168, -0.013854817487299442, -0.018159154802560806, -0.00846151914447546, 0.00017497868975624442, -0.004929754417389631, -0.015186586417257786, 0.030844075605273247, -0.003873904002830386, -0.012765856459736824, 0.0006231172592379153, -0.012729067355394363, 0.043411269783973694, 0.010852817445993423, 0.02891632169485092, 0.002630428643897176, -0.0012112847762182355, 0.0046317619271576405, 0.010300979018211365, -0.006493296008557081, -0.038407936692237854, -0.005709685850888491, -0.008196636103093624, -0.026591243222355843, 0.017850125208497047, 0.01886550895869732, 0.01792370341718197, 0.028136389330029488, -0.011787263676524162, -0.0134501364082098, -0.005371225066483021, 0.011022048071026802, -0.006173229776322842, 0.026767831295728683, 0.029504947364330292, -0.025693586096167564, -0.012530406005680561, -0.019336409866809845, -0.018924370408058167, -0.048179153352975845, 0.0052571785636246204, -0.04791427031159401, 0.02310362458229065, -0.011309003457427025, -0.007306337356567383, -0.018953802064061165, 0.006489616818726063, 0.015333743765950203, -0.031050095334649086, 0.0001814168062992394, -0.021396605297923088]","Guiding LLMs The Right Way: Fast, Non-Invasive Constrained Generation.pdf"
