text,embedding,file
"CHAI: Clustered Head Attention for Efficient LLM Inference
Saurabh Agarwal1Bilge Acun2Basil Hosmer2Mostafa Elhoushi2Yejin Lee2Shivaram Venkataraman1
Dimitris Papailiopoulos1Carole-Jean Wu2
Abstract
Large Language Models (LLMs) with hundreds of
billions of parameters have transformed the field
of machine learning. However, serving these mod-
els at inference time is both compute and mem-
ory intensive, where a single request can require
multiple GPUs and tens of Gigabytes of memory.
Multi-Head Attention is one of the key compo-
nents of LLMs, which can account for over 50%
of LLMs memory and compute requirement. We
observe that there is a high amount of redundancy
across heads on which tokens they pay attention to.
Based on this insight, we propose Clustered Head
Attention ( CHAI ).CHAI combines heads with
a high amount of correlation for self-attention at
runtime, thus reducing both memory and compute.
In our experiments, we show that CHAI is able
to reduce the memory requirements for storing
K,V cache by up to 21.4% and inference time
latency by up to 1.73×without any fine-tuning
required. CHAI achieves this with a maximum
3.2% deviation in accuracy across 3 different mod-
els (i.e. OPT -66B, LLAMA-7B, LLAMA-33B)
and 5 different evaluation datasets.
1. Introduction
LLMs have demonstrated remarkable performance on lan-
guage modelling tasks ranging from question answering,
text summarizing, language translation. However, such per-
formance has been achieved by scaling models to trillions of
parameters, and existing works (Hoffmann et al., 2022; Tou-
vron et al., 2023a; Kaplan et al., 2020) show that increasing
the model size may lead to even higher model quality.
Inference on LLMs introduce several new challenges.
Beyond just the quadratic computation cost of self-
attention (Vaswani et al., 2017) with increasing context and
large model sizes, LLMs also store intermediate Key (K)
and Value (V) pairs for subsequent next word prediction.
1University of Wisconsin-Madison2Meta-FAIR. Correspon-
dence to: Saurabh Agarwal <agarwal@cs.wisc.edu >.
,
3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0
Flops1e1215202530354045Accuracy
Random Head Selection
Static Head Selection
Dejavu
SpAtten
Chai
Chai-static
MHAFigure 1. Accuracy vs Flops: We study various methods of clus-
tering attention heads, and plot the runtime for sequence length of
2048. For random head selection we randomly choose heads to
combine in increasing number of 4, 8, 16 and 24. For Static Head
Selection , we choose the heads to combine based on activations.
CHAI is our proposed method.
This K,V caching introduces additional memory related
challenges as K,V cache size increases with increase in
sequence length. The architecture of widely used LLMs
like GPT (Brown et al., 2020) and LLAMA(Touvron et al.,
2023a;b) use Multi-Head Attention (MHA) (Vaswani et al.,
2017). MHA uses several attention heads to look at a se-
quence. As models grow bigger, the number of heads in-
creases as well. For example, LLAMA-7B uses 32 attention
heads in each layer, while LLAMA-65B uses 64 attention
heads per layer (Touvron et al., 2023a). The use of MHA
exacerbates bottlenecks for serving LLMs. First, it increases
compute pressure due to repeated application of the atten-
tion operation. Second, it increases the memory pressure
due to requiring storage of Key (K), Value (V) caches that
comes with the additional attention heads. To alleviate
these bottlenecks, prior works have introduced primarily
two types of methods - (i) pruning of LLMs to utilize spar-
sity based on the input context (Liu et al., 2023b; V oita et al.,
2019) and (ii) Co-designing of the Attention module to reuse
components across multiple heads like Multi-Query Atten-
tion (MQA) (Shazeer, 201","[0.020632421597838402, 0.018696872517466545, 0.07715316116809845, 0.013273300603032112, 0.003219195641577244, -0.0037971721030771732, 0.018239866942167282, 0.0048556760884821415, -0.025189029052853584, 0.051265183836221695, -0.0027201867196708918, -0.048496272414922714, -0.03742062672972679, 0.02742028795182705, -0.030377376824617386, -0.05795896053314209, 0.016653792932629585, -0.032097864896059036, 0.03263551741838455, 0.014852656051516533, -0.05935685709118843, 0.037850748747587204, 0.02501429244875908, 0.042689625173807144, 0.04865757003426552, -0.011788035742938519, 0.003575390437617898, -0.007238149642944336, 0.02020229957997799, -0.028361180797219276, 0.0514264814555645, -0.029033245518803596, -0.030646203085780144, 0.0022900644689798355, -0.037178684026002884, 0.08371252566576004, -0.017648449167609215, 0.022178173065185547, -0.028226766735315323, 0.022487323731184006, 0.012224878184497356, -0.01746027171611786, -0.02916765958070755, 0.03744751214981079, -0.008111835457384586, -0.007627947721630335, 0.029759077355265617, 0.04180249571800232, -0.0292214248329401, 0.07580903172492981, -0.024409431964159012, 0.033065639436244965, -0.04556606709957123, 0.02669445611536503, -0.002201015828177333, -0.0032679203432053328, 0.03596896678209305, 0.023105625063180923, 0.042367033660411835, 0.028011705726385117, 0.015040834434330463, -0.031667742878198624, 0.00893847644329071, 0.01164690125733614, -0.049248985946178436, -0.03607649728655815, -0.04658760502934456, 0.0022547810804098845, 0.021170075982809067, -0.007043250370770693, -0.01642528921365738, 0.023549187928438187, 0.04161432012915611, -0.009052727371454239, -0.021035661920905113, -0.016048932448029518, -0.022016877308487892, 0.015215571038424969, 0.011861962266266346, 0.036210909485816956, 0.01338083203881979, 0.01815921999514103, 0.057797666639089584, -0.02189590595662594, 0.032769933342933655, -0.053738389164209366, -0.03559260815382004, 0.0032326369546353817, -0.08532548695802689, -0.029113894328475, -0.006727379281073809, 0.05258243530988693, -0.01822642609477043, 0.004079439677298069, 0.039248645305633545, 0.03360329195857048, 0.04768979549407959, -0.034436654299497604, 0.017984483391046524, 0.027299316599965096, 0.017957599833607674, 0.018333956599235535, 0.030054785311222076, -0.02364327758550644, 0.04080783948302269, -0.03336134925484657, -0.011505767703056335, -0.021788375452160835, -0.022164732217788696, -0.015645693987607956, -0.047501616179943085, 0.014032735489308834, -0.0583890825510025, -0.0031872724648565054, -0.011525929905474186, -0.029678428545594215, -0.03169462829828262, 0.018065130338072777, -0.025189029052853584, 0.009361878037452698, -0.024180930107831955, -0.006542561110109091, 0.06726035475730896, -0.014866096898913383, 0.01680164597928524, -0.023186272010207176, 0.029006363824009895, -0.02983972430229187, 0.010874025523662567, -0.013098563998937607, 0.04247456416487694, 0.027904175221920013, 0.04051212966442108, -0.027218667790293694, -0.012957430444657803, -0.032420456409454346, -0.006838270463049412, 0.021869024261832237, -0.0583353191614151, -0.028388062492012978, 0.025471296161413193, -0.0342484787106514, 0.0035720302257686853, 0.014274679124355316, -0.013421155512332916, 0.05543199181556702, -0.04260897636413574, 0.016922619193792343, -0.020807160064578056, 0.0480123870074749, -0.027299316599965096, -0.03712492063641548, -0.01853557676076889, -0.003918143920600414, -0.05113077163696289, -0.039598122239112854, -0.036184027791023254, 0.009886088781058788, 0.024839553982019424, -0.07736822217702866, 0.041264843195676804, 0.007560741156339645, 0.012688604183495045, -0.018925374373793602, 0.013925204984843731, 0.03365705907344818, -0.06139993667602539, 0.005521021317690611, -0.07010991126298904, -0.04567359760403633, -0.03255487233400345, -0.036184027791023254, -0.01475856639444828, -0.057475075125694275, 0.018239866942167282, -0.010551434010267258, -0.004486039746552706, 0.006307338364422321, -0.012937268242239952, -0.03540442883968353, -0.012245040386915207, 0.06645387411117554, -0.0015297899954020977, 0.0188984926789999, -0.07355088740587234, 0.0029083651024848223, 0.0222722627222538, 0.01616990566253662, 0.014032735489308834, 0.02198999561369419, 0.0015751543687656522, 0.03056555613875389, 0.0755402073264122, 0.037555042654275894, 0.025323443114757538, -0.024799231439828873, 0.047824207693338394, 0.02505461499094963, 0.002711785724386573, -0.030995678156614304, 0.020632421597838402, 0.016559703275561333, 0.01461071241647005, -0.07946506887674332, 0.04072719067335129, 0.0006670253933407366, -0.017325857654213905, 0.015927961096167564, -0.017594683915376663, -0.027003606781363487, 0.03153333067893982, -0.027554700151085854, 0.07027120888233185, 0.02061898075044155, -0.025229353457689285, -0.024597611278295517, -0.056077174842357635, -0.03360329195857048, 0.007419607136398554, 0.022151291370391846, 0.025551944971084595, 0.023938987404108047, 0.034490421414375305, 0.05088882893323898, -0.07435736805200577, 0.020323272794485092, 0.0016213589115068316, -0.012749089859426022, 0.032393574714660645, -0.015188688412308693, 0.035216253250837326, -0.0036862813867628574, -0.019973797723650932, -0.013938645832240582, -0.015027392655611038, -0.0822070986032486, 0.0308881476521492, -0.001211398746818304, 0.023535747081041336, -0.04228638485074043, 0.007883332669734955, 0.01060519926249981, 0.008958637714385986, -0.021143192425370216, -0.023213155567646027, 0.038549698889255524, -0.022205056622624397, -0.020444244146347046, 0.04357675090432167, 0.02197655476629734, 0.010376697406172752, -0.02983972430229187, -0.07591655850410461, -0.008091673254966736, -0.053362030535936356, 0.0035384269431233406, 0.003331766463816166, 0.05871167406439781, 0.010766495019197464, 0.00437178835272789, -0.042017556726932526, 0.026479395106434822, -0.010080988518893719, 0.015457515604794025, -0.012527307495474815, -0.03147956728935242, -0.030780617147684097, 0.03223228082060814, -0.04043148458003998, -0.003847577143460512, -0.005810009315609932, -0.01145872287452221, 0.011599857360124588, 0.003998791798949242, -0.023495422676205635, -0.011042042635381222, 0.022514207288622856, 0.018589342013001442, -0.024234695360064507, 0.014126825146377087, -0.01720488630235195, 0.009126654826104641, 0.06946472823619843, 0.012823017314076424, 0.016008609905838966, 0.0033670500852167606, -0.0007485133828595281, -0.05398033186793327, -0.02844182774424553, -0.01918075978755951, 0.02544441446661949, -0.017742538824677467, 0.02465137653052807, -0.0239927526563406, 0.023092184215784073, 0.04137237370014191, -0.02737996354699135, 0.01252058707177639, 0.01920764334499836, 0.033818356692790985, 0.033791471272706985, 0.007607785519212484, -0.0021959752775728703, -0.027608465403318405, 0.019409261643886566, 0.030592437833547592, -0.0012550830142572522, 0.014180590398609638, 0.0145569471642375, 0.012493704445660114, -0.008804063312709332, -0.03395276889204979, 0.0010736252879723907, 0.022742709144949913, -0.056077174842357635, -0.030995678156614304, 0.010417020879685879, -0.01744683086872101, 0.018656548112630844, -0.012917106039822102, -0.030269846320152283, -0.03330758586525917, -0.015524721704423428, -0.016640350222587585, 0.031076326966285706, 0.006908837240189314, 0.01267516240477562, 0.020713070407509804, -0.03527001664042473, -0.02404651790857315, 0.045431654900312424, 0.019839385524392128, -0.005393328610807657, -0.014731683768332005, -0.018723756074905396, -0.02575356513261795, -0.032769933342933655, -0.006794585846364498, 0.04492088407278061, 0.003227596404030919, -0.04492088407278061, 0.022567972540855408, -0.054087862372398376, 0.051238302141427994, -0.0032780012115836143, -0.006928998976945877, -0.0005208510556258261, -0.0034712201450020075, 0.04868445172905922, -0.022930888459086418, 0.007970700971782207, -0.0036224350333213806, 0.044625174254179, -0.03828087076544762, -0.01094795297831297, 0.034839894622564316, -0.00023375291493721306, -0.020766835659742355, 0.012789413332939148, 0.017016708850860596, -0.04537788778543472, -0.002671461785212159, 0.014274679124355316, -0.0004935484030283988, 0.01923452503979206, 0.01647905446588993, -0.04707149416208267, 0.023428216576576233, 0.012480263598263264, -0.018387721851468086, 0.01922108419239521, 0.010074267163872719, -0.012607955373823643, -0.013804232701659203, -0.03970565274357796, 0.019731855019927025, 0.007157501764595509, -0.0013558928621932864, -0.0033166450448334217, 0.009113213047385216, -0.00036081537837162614, 0.013118726201355457, -0.008105114102363586, 0.0011551132192835212, 0.04242079704999924, 0.023119065910577774, -0.0024547206703573465, -0.0007808565278537571, -0.05290502682328224, -0.018038248643279076, 0.005205150227993727, 0.01954367570579052, -0.02196311205625534, 0.043415457010269165, 0.017057031393051147, 0.0006775264046154916, 0.03161397948861122, 0.022756149992346764, 0.03457107022404671, 0.036533500999212265, 0.02298465371131897, 0.016667233780026436, -0.01751403696835041, -0.011431840248405933, 0.03397965058684349, 0.007265032269060612, -0.002570651937276125, -0.0003931585233658552, 0.015497839078307152, -0.0171914454549551, 0.0651097446680069, -0.0074263280257582664, 0.014328444376587868, -0.004704460967332125, 0.011613298207521439, 0.019489910453557968, -0.01786351017653942, 0.02160019800066948, 0.03578078746795654, 0.0446789376437664, 0.011109248735010624, -0.0036661194171756506, -0.03981318324804306, 0.0011072285706177354, -0.025511620566248894, -0.002086764434352517, 0.05381903424859047, -0.060217101126909256, 0.002757150214165449, -0.05720624700188637, -0.06984108686447144, 0.0515071302652359, 0.004412112291902304, -0.008830945938825607, -0.017702214419841766, -0.012574352324008942, 0.0031469485256820917, 0.02018885873258114, -0.01404617726802826, -0.07236805558204651, 0.008481471799314022, -0.01610269770026207, -0.03220539540052414, -0.0154440738260746, -0.03529689833521843, -0.005702478811144829, -0.03508183732628822, 0.007681712973862886, 0.009368598461151123, -0.01785006932914257, 0.0011189896613359451, 0.0002849979209713638, 0.06080852076411247, 0.06967978924512863, 0.009744955226778984, -0.02774287946522236, 0.09753020107746124, -0.02612992189824581, 0.00339057226665318, -0.038253989070653915, 0.04363051801919937, 0.00842098519206047, 0.0032914425246417522, -0.008992241695523262, -0.012903665192425251, 0.003382171504199505, 0.03282369673252106, -0.018454929813742638, 0.022164732217788696, -0.008951917290687561, 0.02641218900680542, -0.033415116369724274, 0.0029789318796247244, -0.012305526062846184, -0.015632253140211105, -0.008434426970779896, 0.007305356208235025, -0.06629257649183273, -0.021721169352531433, -0.053362030535936356, 0.0014062979025766253, 0.010289328172802925, 0.032097864896059036, 0.010692568495869637, 0.0056218309327960014, 0.02133137173950672, 0.038630347698926926, 0.020148534327745438, 0.04596930742263794, 0.029624663293361664, -0.016936060041189194, -0.013616054318845272, 0.03357641026377678, -0.014879538677632809, -0.000940052152145654, -0.011102528311312199, 0.0018633026629686356, -0.029060129076242447, -0.0072045461274683475, -0.02951713278889656, 0.04352298751473427, -0.011015160009264946, 0.02364327758550644, 0.01115629356354475, -0.028576241806149483, 0.03336134925484657, 0.02361639402806759, -0.0036157143767923117, 0.015027392655611038, 0.016936060041189194, -0.01914043538272381, -0.0021422100253403187, 0.01959744095802307, 0.04637254402041435, -0.00133321073371917, 0.0032931228633970022, 0.0128431785851717, 0.013582451269030571, 0.009704630821943283, 0.018790962174534798, 0.026842311024665833, 0.005443733651190996, -0.003716524224728346, -0.004724623169749975, 0.02361639402806759, -0.0009627343388274312, -0.05225984379649162, -0.07844352722167969, -0.02954401634633541, -0.03529689833521843, 0.030108550563454628, -0.013656378723680973, -0.0007422127528116107, -0.00017547220340929925, -0.057421308010816574, -0.008911593817174435, 0.009166978299617767, -0.044114403426647186, -0.023199714720249176, 0.02712457813322544, 0.02438255026936531, 0.03352264687418938, 0.016559703275561333, 0.031345151364803314, -0.007177663501352072, -0.029732193797826767, 0.02638530544936657, -0.026842311024665833, 0.012836458161473274, 0.03642597049474716, 0.020336713641881943, -0.051937252283096313, 0.005053935572504997, -0.004089520778506994, -0.02954401634633541, -0.002216137247160077, -0.013683261349797249, 0.008165600709617138, -0.0006380425184033811, -0.0026765023358166218, 0.03349576145410538, -0.006431670393794775, -0.020081328228116035, -0.021385136991739273, -0.03696362301707268, 0.001096307416446507, -0.0013575730845332146, -0.004029035102576017, -0.0043919505551457405, -0.00910649262368679, -0.024812672287225723, -0.025135263800621033, 0.014220913872122765, -0.03873787820339203, 0.020363595336675644, -0.01579354889690876, 0.005796568002551794, 0.04242079704999924, 0.01746027171611786, 0.016532819718122482, -0.05338891223073006, -0.004002152476459742, -0.034759245812892914, -0.04075407609343529, -0.03145268186926842, 0.009247626177966595, -0.022487323731184006, 0.022742709144949913, -0.05801272764801979, 0.02332068607211113, 0.034517303109169006, -0.020807160064578056, 0.037635687738657, 0.00821936596184969, -0.012433218769729137, -0.0017658531432971358, -0.003709803568199277, -0.03282369673252106, -0.027514377608895302, -0.014032735489308834, 0.031748391687870026, 0.0377432182431221, -0.0008497433154843748, -0.017231769859790802, -0.029248306527733803, 0.0206458643078804, -0.05113077163696289, 0.014906421303749084, 0.03502807393670082, -0.0004208812606520951, 0.0051446640864014626, -0.001089586759917438, 0.0007060891948640347, -0.043738048523664474, -0.05040493980050087, 0.017729097977280617, -0.009301391430199146, -0.041264843195676804, 0.03051179088652134, -0.005389968398958445, 0.0005725161172449589, -0.014906421303749084, 0.0292214248329401, 0.022930888459086418, -0.0006691255839541554, 0.011337751522660255, -0.009563497267663479, -0.03817334026098251, -0.01993347331881523, 0.0037702894769608974, -0.06145370379090309, 0.004667497705668211, 0.02705737203359604, 0.0059007382951676846, 0.0027756320778280497, 0.012029979377985, 0.007601065095514059, -0.010074267163872719, 0.01474512554705143, 0.0019036266021430492, 0.01166706345975399, 0.008360499516129494, -0.006283815950155258, -0.02771599590778351, 0.04086160659790039, -0.009334995411336422, 0.004633894190192223, -0.010685847140848637, -0.006048592738807201, -0.018629666417837143, -0.01752747781574726, -0.03118385747075081, 0.044759586453437805, 0.035861436277627945, 0.03389900177717209, -0.030001020058989525, -0.0023068662267178297, 0.0067441812716424465, 0.026344982907176018, 0.03454418480396271, -0.05387280136346817, -0.013481641188263893, -0.02196311205625534, -0.03674856200814247, 0.012426498346030712, 0.014543505385518074, 0.016384966671466827, 0.005339563358575106, 0.0026160164270550013, -0.018750637769699097, -0.014355327002704144, 0.01919420063495636, 0.017608126625418663, 0.02536376565694809, 0.011922448873519897, -0.009442525915801525, -0.02544441446661949, -0.012124068103730679, -0.049921054393053055, -0.0017078873934224248, -0.031345151364803314, 0.02330724522471428, -0.06575492769479752, -0.03575390577316284, 0.007775802165269852, 0.01818610168993473, 0.03161397948861122, -0.0037299655377864838, 0.01356901042163372, -0.01409994252026081, 0.009610542096197605, -0.014597270637750626, 0.027850409969687462, -0.023226596415042877, 0.004523003473877907, 0.022702384740114212, -0.028603123500943184, 0.0686044842004776, -0.013978970237076283, -0.059195563197135925, -0.005712559912353754, 0.011183176189661026, -0.006102357991039753, 0.016909178346395493, 0.01252058707177639, -0.019704971462488174, -0.010430462658405304, 0.023750808089971542, 0.01856246031820774, -0.012325688265264034, -0.02637186460196972, 0.004680939018726349, 0.0036560383159667253, 0.0344097726047039, -0.015161805786192417, 0.01920764334499836, 0.00016087577387224883, 0.0009022484300658107, -0.01236601173877716, -0.01923452503979206, -0.0412379615008831, 0.012970871292054653, -0.023199714720249176, 0.008548677898943424, 0.013172491453588009, -0.0021186876110732555, -0.021855581551790237, 0.008326896466314793, 0.01580698974430561, 0.027353081852197647, -0.008736856281757355, 0.01951679214835167, 0.022809915244579315, -0.048872631043195724, -0.01642528921365738, 0.022110966965556145, -0.04188314452767372, -0.03387212008237839, -0.033764589577913284, -0.010759774595499039, 0.03462483361363411, -0.02814611978828907, 0.005373166874051094, 0.03091503120958805, 0.011438561603426933, 0.0026412189472466707, 0.04427570104598999, 0.020363595336675644, -0.00394838722422719, -0.009556776843965054, -0.05037805810570717, 0.01219799555838108, 0.02094157226383686, 0.023952428251504898, -0.01573978364467621, -0.011801476590335369, 0.00753385853022337, 0.0019691530615091324, 0.009140095673501492, 0.00893847644329071, 0.013992411084473133, 0.01352868601679802, -0.021183516830205917, 0.008904872462153435, 0.0003150308912154287, -0.052313607186079025, -0.009630704298615456, -0.03957124054431915, 0.01645217277109623, -0.003619074821472168, -0.04379181191325188, -0.006687055341899395, 0.031345151364803314, -0.0013088482664898038, 0.017325857654213905, -0.029113894328475, 0.04021642357110977, -0.020659305155277252, 0.0010879066539928317, -0.0028260371182113886, 0.027003606781363487, -0.045861776918172836, 0.002078363671898842, -0.03696362301707268, -0.028065470978617668, -0.013078401796519756, -0.021546432748436928, -0.02469170093536377, 0.004882558714598417, -0.03236669301986694, -0.011438561603426933, -0.007332238834351301, 0.005641993135213852, -0.019113553687930107, -0.003098223591223359, 0.028361180797219276, 0.013663099147379398, -0.11236941814422607, -0.034813012927770615, 0.027191786095499992, 0.007070132996886969, 0.010860584676265717, -0.014435974881052971, 0.013790791854262352, 0.019664647057652473, 0.0377969853579998, -0.02951713278889656, 0.007950539700686932, -0.006458553019911051, 0.011189896613359451, -0.0023337488528341055, 0.0075472998432815075, -0.06570115685462952, -0.041990675032138824, 0.011095807887613773, 0.028979480266571045, 0.0047212629579007626, -0.007332238834351301, 0.001545751467347145, 0.00770187471061945, 0.02846871130168438, 0.0017994564259424806, -0.010383417829871178, -0.008266409859061241, 0.020444244146347046, 0.00028331775683909655, 0.007863170467317104, -0.03158709779381752, -0.004704460967332125, 0.00684835109859705, 0.04174873232841492, -0.03645285218954086, 0.006502237170934677, -0.022124407812952995, 0.012083744630217552, -0.010914349928498268, -0.02194967120885849, -0.03266240283846855, -0.03123762272298336, 0.04008200764656067, -0.014852656051516533, 0.0067441812716424465, -0.007554020266979933, 0.03578078746795654, -0.001446621841751039, 0.0010316211264580488, 0.006818108260631561, -0.022057201713323593, -0.03473236411809921, 0.038307756185531616, 0.05516316741704941, 0.02639874815940857, 0.005692398175597191, -0.011929169297218323, 0.011411678977310658, 0.0222722627222538, 0.031802158802747726, 0.020000681281089783, 0.016976384446024895, 0.01852213591337204, -0.024543846026062965, -0.025215910747647285, -0.0012071983655914664, -0.008373940363526344, 0.06010957062244415, -0.019288290292024612, -0.019651206210255623, -0.017393065616488457, 0.008925034664571285, 0.005752883851528168, 0.034759245812892914, 0.03728621453046799, 0.00042907206807285547, 0.019395820796489716, 0.0755939707159996, -0.0061561232432723045, 0.014906421303749084, 0.04180249571800232, -0.05720624700188637, 0.021156633272767067, -0.00022052161511965096, 0.0015852353535592556, 0.022877123206853867, 0.03914111480116844, -0.019153878092765808, -0.0032443979289382696, 0.03524313494563103, 0.003760208608582616, -0.008985520340502262, 0.018616225570440292, 0.01955711655318737, 0.03674856200814247, 0.012755810283124447, 0.01322625670582056, 0.000722890836186707, 0.0410497821867466, 0.0007405325886793435, 0.047447849065065384, 0.02432878501713276, 0.03150644898414612, -0.053362030535936356, 0.002038039732724428, -0.03250110521912575, 0.016223670914769173, -0.033818356692790985, 0.026896076276898384, 0.01254074927419424, 0.018454929813742638, 0.01252058707177639, 0.01579354889690876, 0.03126450628042221, 0.021412018686532974, 0.025121822953224182, -0.001957391854375601, 0.004109682980924845, 0.029060129076242447, -0.02192278951406479, 0.002805874915793538, 0.013622775673866272, -0.020699629560112953, -0.03750127553939819, 0.0014667838113382459, -0.018293634057044983, -0.01674788072705269, 0.02978595905005932, 0.003118385560810566, -0.01985282637178898, -0.0022278984542936087, 0.035834550857543945, 0.018723756074905396, 0.01813233643770218, -0.018696872517466545, 0.010188519023358822, 0.0020044364500790834, -0.002505125477910042, 0.005178267601877451, 0.055001869797706604, -0.003397292923182249, -0.01891193352639675, 0.03489366173744202, -0.013488362543284893, 0.012534028850495815, 0.002550489967688918, -0.00808495283126831, -0.014906421303749084, -0.018965698778629303, 0.021116310730576515, 0.004986729007214308, -0.002679862780496478, 0.04002824425697327, 0.0514802448451519, 0.01077993679791689, 0.009691189974546432, 0.003014215501025319, -0.02266206219792366, 0.0010358215076848865, 0.01951679214835167, 0.01388488058000803, 0.03118385747075081, 0.01461071241647005, 0.024866437539458275, 0.024167489260435104, 0.006787865422666073, -0.041641201823949814, 0.001915387692861259, -0.002442959463223815, 0.03820022568106651, -0.0128431785851717, -0.028038587421178818, 0.039947595447301865, 0.0239793099462986, 0.00808495283126831, 0.018401164561510086, 0.002955409698188305, -0.021344812586903572, 0.02294432930648327, 0.028925715014338493, -0.015941401943564415, 0.00021254083549138159, -0.0222453810274601, 0.019463026896119118, 0.0028714013751596212, 0.03290434554219246, 0.025484738871455193, 0.005786487367004156, 0.010941232554614544, 7.135449413908646e-05, 0.005806649103760719, 0.016237111762166023, -0.022124407812952995, -0.0033586493227630854, -0.004875837825238705, -0.03169462829828262, 0.023159390315413475, 0.03352264687418938, -0.04537788778543472, -0.023387892171740532, -0.01744683086872101, 0.055700819939374924, -0.001809537410736084, 0.0032914425246417522, -0.01674788072705269, 0.022702384740114212, -0.00875029806047678, -0.0343828909099102, 0.006267014425247908, 0.0002560151042416692, 0.0020632422529160976, 0.016962943598628044, -0.022796474397182465, 0.030753733590245247, -0.0030948633793741465, -0.00891831424087286, 0.01185524184256792, 0.007580902893096209, 0.009550056420266628, -0.022877123206853867, -0.022097526118159294, -0.004916161764413118, -0.028979480266571045, 0.01811889559030533, -0.01615646295249462, 0.00343425665050745, -0.00014060878311283886, -0.015040834434330463, -0.028280531987547874, 0.009382039308547974, 0.015054275281727314, -0.00719110481441021, 0.011613298207521439, 0.013965528458356857, -0.02400619350373745, -0.005178267601877451, -0.02506805770099163, -0.02782352641224861, -0.002088444773107767, -0.012621397152543068, 0.029678428545594215, 0.00524547416716814, 0.005040494259446859, 0.009691189974546432, -0.0073389592580497265, -0.01682852953672409, 0.011660343036055565, 0.012036699801683426, -0.016559703275561333, -0.022218497470021248, 0.0014365408569574356, 0.002100205747410655, 0.04013577476143837, -0.017567802220582962, -0.0032023938838392496, -0.006566083524376154, 0.029624663293361664, 0.05618470907211304, 0.04088848829269409, 0.022769592702388763, -0.015511280857026577, 0.024826113134622574, -0.020672746002674103, -0.017715657129883766, 0.012836458161473274, -0.013636216521263123, -0.044356346130371094, 0.006599687039852142, 0.012016537599265575, 0.005722641013562679, -0.0188312865793705, 0.019274849444627762, -0.007043250370770693, 0.01269532460719347, -0.0003501043247524649, 0.029302071779966354, -0.010692568495869637, -0.012681882828474045, 0.0038072532042860985, -0.007641389034688473, -0.00737928319722414, -0.005191708914935589, -0.021774934604763985, 0.001987634925171733, -0.009536614641547203, 0.012460101395845413, -0.036882974207401276, -0.008031187579035759, 0.03459795191884041, -0.038979820907115936, 0.0016255592927336693, 0.019691530615091324, 0.022809915244579315, -0.0016280795680359006, -0.013636216521263123, -0.0048556760884821415, 0.01650593802332878, -0.00582345062866807, 0.014597270637750626, -0.03392588719725609, 0.029006363824009895, 0.014973627403378487, 0.026344982907176018, 0.014341886155307293, 0.01680164597928524, 0.01959744095802307, -0.013125446625053883, -0.04742096737027168, 0.01646561361849308, 0.00599482748657465, -0.027527818456292152, 0.032716166228055954, 0.014153707772493362, -0.010887467302381992, 0.006969322916120291, -0.006283815950155258, 0.0039651887491345406, -0.03255487233400345, 0.006455192808061838, -0.054034095257520676, -0.009630704298615456, 0.043361689895391464, -0.01219799555838108, -0.009153537452220917, 0.004980008117854595, -0.03943682461977005, 0.003083102172240615, -0.0072045461274683475, -0.019328614696860313, -0.00025748522602953017, 0.008360499516129494, 0.023199714720249176, -0.0010198599193245173, 0.025242794305086136, -0.04070030897855759, -0.008300013840198517, -0.050216760486364365, -0.002038039732724428, -0.0023673521354794502, -0.0004801070608664304, 0.04551229998469353, 0.030001020058989525, 0.006223329808562994, 0.00727847358211875, -0.01853557676076889, 0.04564671590924263, -0.006246852222830057, -0.0274337287992239, -0.003555228468030691, -0.016613468527793884, 0.06333548575639725, -0.01918075978755951, -0.035135604441165924, 0.0017423307290300727, 0.009079609997570515, 0.04914145544171333, -0.005877215880900621, 0.019086670130491257, -0.03943682461977005, -0.025215910747647285, 0.012406336143612862, 0.00789005309343338, 0.010699288919568062, -0.009529894217848778, -0.010336373001337051, 0.00014806451508775353, -0.0037837307900190353, 0.01744683086872101, 0.01645217277109623, 0.013898322358727455, 0.010309490375220776, -0.008434426970779896, -0.013669819571077824, -0.005433652549982071, 0.01610269770026207, 0.0222319383174181, 0.005137943662703037, 0.0343291237950325, -0.002920126309618354, 0.03013543412089348, -0.0031083046924322844, -0.04430258274078369, -0.022473882883787155, 0.00266642146743834, -0.006062034051865339, 0.03868411108851433, -0.02160019800066948, 0.03604961186647415, -0.005662154871970415, -0.014207473024725914, 0.0012710446026176214, 0.02262173779308796, 0.011693946085870266, -0.0076682716608047485, -0.02746061235666275, -0.035216253250837326, -0.011660343036055565, 0.017218327149748802, 0.011257103644311428, 0.018347399309277534, -0.040942251682281494, -0.013938645832240582, 0.02362983673810959, -0.014113383367657661, 0.008414264768362045, 0.001723848981782794, 0.00010537783236941323, 0.029705312103033066, 0.007097015623003244, 0.023119065910577774, -0.029947254806756973, 0.0016415208810940385, -0.03524313494563103, -0.018360840156674385, -0.009193860925734043, -0.01647905446588993, -0.003998791798949242, 0.033441998064517975, -0.028683772310614586, 0.01404617726802826, -0.03502807393670082, -0.017393065616488457, 0.015040834434330463, 0.02744716964662075, 0.0008312614518217742, 0.020807160064578056, -0.006666893605142832, 0.03053867258131504, 0.019059788435697556, 0.023938987404108047, -0.0024395990185439587, 0.022796474397182465, -0.019382379949092865, 0.013521965593099594, 0.007359121460467577, 0.005322761833667755, 0.007070132996886969, -0.04182938113808632, -0.017218327149748802, 0.04266274347901344, -0.008790621533989906, 0.021519549190998077, 0.030296729877591133, 0.006062034051865339, -0.0017389704007655382, -0.008239527232944965, -0.020309830084443092, -0.0023555909283459187, 0.036882974207401276, -0.024154048413038254, -0.02436910942196846, -0.00727847358211875, -0.018011365085840225, -0.005460535176098347, -0.03631843999028206, -0.016290877014398575, -0.03535066545009613, 0.008199203759431839, 0.01713768020272255, -0.0029302071779966354, 0.012896943837404251, 0.0005321921780705452, -0.0035283458419144154, 0.02259485423564911, -0.0017826547846198082, 0.014516622759401798, -0.0001508997956989333, 0.020699629560112953, -0.017715657129883766, -0.03250110521912575, 0.04185626283288002, 0.004791829735040665, 0.017930718138813972, 0.026237452402710915, 0.000559074804186821, -0.006428310181945562, 0.0033519286662340164, 0.016358083114027977, -0.0043180231004953384, -0.0026378585025668144, -0.04965222626924515, 0.011909007094800472, 0.016909178346395493, -0.0020531611517071724, 0.008683091029524803, 0.03682921081781387, 0.0056218309327960014, -0.0016079175984486938, -0.012023258954286575, -0.017957599833607674, 0.0010719450656324625, 0.03798516467213631, -0.004623813088983297, 0.007419607136398554, 0.002143890131264925, 0.013454758562147617, 0.005594948306679726, 0.016653792932629585, -0.001972513273358345, 0.007661550771445036, -0.001239121425896883, -0.011223499663174152, -0.006028431002050638, 0.024154048413038254, 0.013857997953891754, 0.001367654069326818, -0.002612655982375145, -0.003830775385722518, 0.007130619138479233, -0.009886088781058788, 0.021452343091368675, -0.011888844892382622, -0.002379113109782338, 0.0128431785851717, 0.05978697910904884, -0.028603123500943184, -0.03502807393670082, 0.009657586924731731, 0.017984483391046524, -0.01409994252026081, 0.03731309622526169, 0.01849525235593319, -0.021761493757367134, -0.023912103846669197, -0.015954844653606415, -0.012144230306148529, -0.0171511210501194, 0.032420456409454346, -0.0154037494212389, 0.02328036166727543, -0.021774934604763985, 0.01676132343709469, 0.02362983673810959, 0.003619074821472168, -0.015659134835004807, -0.025941742584109306, 0.002412716392427683, 0.016720999032258987, -0.01526933629065752, 0.025874536484479904, -0.006139321718364954, -0.0136967021971941, -0.006162844132632017, -0.02057865634560585, 0.003588831750676036, 0.027245551347732544, 0.00165328208822757, 0.056077174842357635, 0.04322727769613266, -0.0018885050667449832, -0.002797474153339863, -0.006928998976945877, -0.0292214248329401, -0.029409602284431458, 0.005638632923364639, 0.007554020266979933, 0.01572634093463421, -0.000701888813637197, 0.0001639210677240044, -0.0020615621469914913, 0.03712492063641548, 0.012003096751868725, -0.02541753090918064, 0.00840754434466362, -0.029597781598567963, 0.022205056622624397, 0.00960382167249918, 0.001844820799306035, -0.029409602284431458, -0.04177561402320862, 0.006603047251701355, 0.020081328228116035, 0.02302497625350952, 0.012594514526426792, -0.00015415511734317988, 0.019436145201325417, -0.0014289800310507417, -0.019328614696860313, 0.005393328610807657, -0.0013726945035159588, 0.011216779239475727, -0.014987069182097912, -0.0004969087312929332, -0.0012912065722048283, -0.008091673254966736, -0.00787661224603653, -0.011095807887613773, 0.026344982907176018, 0.002185894176363945, 0.018750637769699097, 0.01950335130095482, 0.010033943690359592, 0.008609163574874401, 0.004402031656354666, -0.025578826665878296, 0.03820022568106651, 0.01572634093463421, 0.026949841529130936, -0.037205565720796585, 0.010141474194824696, -0.00825296901166439, 0.03527001664042473, -0.022541088983416557, -0.023952428251504898, 0.012036699801683426, -0.022124407812952995, 0.007970700971782207, 0.00028730815392918885, 0.03715180233120918, 0.039302412420511246, -0.011767873540520668, 0.0018330597085878253, -0.019825942814350128, 0.012271923013031483, -0.021183516830205917, 0.03024296462535858, -0.029006363824009895, 0.022850239649415016, -0.027218667790293694, -0.02189590595662594, -0.020363595336675644, 0.007836287841200829, 0.013300183229148388, -0.023750808089971542, -0.004959846381098032, 0.006088916677981615, -0.020336713641881943, 0.010255725122988224, -0.0025824131444096565, -0.0032074344344437122, 0.01354884821921587, 0.007607785519212484, 0.006431670393794775, -0.016976384446024895, -0.0031217460054904222, -0.0008279011235572398, -0.003346888115629554, -0.005749523639678955, 0.04400687292218208, 0.006233410909771919, 0.00618636654689908, 0.003027656814083457, 0.00522531196475029, 0.00532948225736618, -0.016344642266631126, 0.008125276304781437, -0.013911763206124306, -0.004301221575587988, -0.023938987404108047, 0.015551604330539703, -0.031398918479681015, -0.015645693987607956, 0.00045616470742970705, 0.020820600911974907, 0.025269677862524986, 0.040323954075574875, -0.009133375249803066, 0.061937592923641205, -0.006844990886747837, 0.008293292485177517, -0.017567802220582962, 0.0014936664374545217, -0.014919862151145935, 0.03363017737865448, 0.008165600709617138, 0.0061594839207828045, -0.01424779649823904, -0.005762964952737093, -0.0068785944022238255, 0.028388062492012978, 0.015524721704423428, -0.018656548112630844, -0.0037904514465481043, -0.01235257089138031, 0.03838840126991272, -0.025619151070713997, 0.010732891969382763, 0.01525589544326067, 0.020739952102303505, 0.015363425947725773, 0.029275190085172653, -0.023938987404108047, 0.028388062492012978, -0.004274338949471712, -0.015000510029494762, 0.007688433397561312, 0.027003606781363487, 0.020995337516069412, 0.033818356692790985, -0.00856211967766285, -0.009778558276593685, 0.00330488383769989, -0.03989383205771446, -0.0019120273645967245, 0.007359121460467577, 0.0009224103996530175, -0.00719110481441021, 0.003296483075246215, -0.034087181091308594, -0.010585037991404533, 0.037232451140880585, 0.04599618911743164, -0.010249004699289799, -0.005715920124202967, -0.012480263598263264, 0.021183516830205917, -0.0018549017840996385, -0.008817504160106182, -0.026143362745642662, -0.013589171692728996, -0.02465137653052807, -0.012554190121591091, 0.017339300364255905, 0.03293122723698616, -0.00531268073245883, 0.015645693987607956, -0.04083472117781639, 0.004234015010297298, -0.022178173065185547, -0.004267618525773287, 0.006566083524376154, 0.025484738871455193, 0.021506108343601227, 0.016559703275561333, -0.0030125353951007128, -0.005413490813225508, -0.006058673840016127, 0.0035216251853853464, 0.023818014189600945, -0.0021976553834974766, 0.02026950754225254, -0.03951747342944145, -0.002763870870694518, -0.027030490338802338, -0.029302071779966354, 0.013273300603032112, -0.005662154871970415, 0.020067887380719185, -0.005699118599295616]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"9) and Grouped-Query Attention
(GQA) (Ainslie et al., 2023).
Pruning LLMs can potentially ease the compute bottleneck,
however it is challenging as the classical methods for prun-
ing (Frankle & Carbin, 2018; Chen et al., 2020b; You et al.,
1arXiv:2403.08058v2  [cs.LG]  27 Apr 2024
Runtime Clustered Head Attention for Efficient Inference
2019; Waleffe & Rekatsinas, 2020) require fine-tuning or
iterative training which is prohibitively expensive for LLMs
due to massive memory and compute cost. There have been
recent pruning works such as DEJAVU(Liu et al., 2023b)
which perform pruning based on the context at inference
time without requiring fine-tuning. However, we observe
that methods like DEJAVUare primarily designed for large
parameter-inefficient models such as OPT (Zhang et al.,
2022) and the insights used to build DEJAVUare not di-
rectly applicable on newer parameter efficient models like
LLAMA-7B (Section 2). In Figure 1, we show that CHAI
achieves the best trade-off between flops and accuracy com-
pared to the state-of-the-art methods. Furthermore, runtime
pruning methods like DEJAVUonly reduce the compute
cost and have no effect on the large memory requirements
of K,V cache.
The Attention module co-design methods like GQA (Ainslie
et al., 2023) require re-training of LLMs, e.g.,LLAMA-
2 (Touvron et al., 2023b) trained the models from scratch to
utilize the benefits of GQA, making it quite expensive. Even
in the case where users are willing to perform retraining, ac-
curacy trade-off between GQA and MHA will not be known
prior to multiple rounds of training. Further, Attention mod-
ule co-design methods only reduce the K,V cache size and
do not reduce computational complexity. Therefore, there
is a need for a method, which can reduce both the compute
and K,V cache overhead for attention and is - (i) Applicable
on a wide range of models (from LLAMA–7B to OPT-66B).
(ii) Does not require any fine-tuning or re-training.
In this work we present Clustered Head Attention for ef-
ficient LLM Inference ( CHAI ), a dynamic inference time
method for efficient LLM inference that does not require
fine-tuning. CHAI is inspired by two observations. First,
several heads in multi-head attention give similar weight to
each token in a given sequence, indicating redundant com-
pute. In Figure 2a we show attention scores for a single
layer of LLAMA-7B for an auto-regressive decoding step
of a sentence. We observe that several heads output similar
scores, i.e., giving similar weight to each token in the se-
quence. Figure 2b highlights the similarity in attention score
by plotting correlation for the activation for LLAMA-7B. In
Figure 2b we observe that there are three clusters and within
these clusters the correlation is greater than 0.95.
This indicates that by identifying attention heads with sim-
ilar attention scores and clustering them together we can
reduce the number of self-attention operations for MHA by
calculating self-attention only for a single head within a clus-
ter. Secondly, we observe that for each request to an LLM
we can accurately determine the heads which are going to
give similar (attention) weight to the tokens in a sequence
after running a few decoding steps on the sequence (Sec-
tion 3.3). Schematic in Figure 3 depicts both Multi-Head
0123456789101112
Token ID036912151821242730Head IDLayer 20
0.20.40.60.8
(a)Activations of Multi Head Attention: Figure shows activation
scores for each token for each head. We observe that several heads
give similar scores to the sequence.
024681012141618202224262830
Head ID036912151821242730Head IDLayer 20
0.000.250.500.751.00
(b)Pairwise cross correlation: Pairwise cross-correlations show
existence of three clusters- Heads [12,26] show strong correlation
forming one cluster, Heads [20,25] form another, and the remaining
heads form a third cluster.
Figure 2. Redundancy across heads for LL AMA–7B
and Clustered-Head Attention","[0.014337658882141113, 0.040841396898031235, 0.04984167963266373, 0.011165320873260498, 0.011472743935883045, 0.006599770858883858, 0.019204091280698776, 0.024436812847852707, -0.025143230333924294, 0.0200544074177742, 0.005020142998546362, -0.01962270773947239, -0.045629337430000305, 0.033489421010017395, -0.037623271346092224, -0.056827362626791, 0.029355572536587715, -0.03919309005141258, 0.02896311692893505, 0.0345359668135643, -0.05374005809426308, 0.02349492348730564, 0.013552750460803509, 0.03699534758925438, 0.04301297664642334, -0.011217648163437843, 0.0005371716688387096, -0.004372593481093645, 0.025692665949463844, -0.020970134064555168, 0.04091988876461983, -0.02684386447072029, -0.019570380449295044, -0.01153815258294344, -0.028910789638757706, 0.05436798557639122, -0.026163611561059952, 0.024933921173214912, -0.04180945083498955, -0.013199541717767715, 0.005870460066944361, -0.012846332974731922, -0.029695698991417885, 0.012872496619820595, 0.0010694375960156322, -0.014219922944903374, 0.05562383681535721, 0.02985268086194992, -0.017895910888910294, 0.06671720743179321, -0.04018730670213699, 0.046623554080724716, -0.06080423295497894, 0.015985965728759766, -0.00824153795838356, 0.0009827706962823868, 0.010086072608828545, 0.03864365443587303, 0.048062555491924286, -0.002806047210469842, 0.029172426089644432, -0.008961036801338196, 0.013336900621652603, -0.0007264490122906864, -0.027000846341252327, -0.024920839816331863, -0.03652440011501312, -0.00044191975030116737, 0.029381735250353813, -0.017752010375261307, -0.009621667675673962, 0.050103314220905304, 0.04044894129037857, -0.030480606481432915, -0.030925389379262924, 0.017294147983193398, 0.0018527107313275337, 0.002967934589833021, -0.00029577146051451564, 0.031814951449632645, 0.042725175619125366, 0.016339175403118134, 0.056984346359968185, -0.02820437215268612, 0.006325053051114082, -0.05991467088460922, -0.023102467879652977, -0.011426957324147224, -0.06619393825531006, -0.020446863025426865, -0.022304479032754898, 0.053556911647319794, -0.009039527736604214, 0.0037871827371418476, 0.01215299777686596, 0.009752485901117325, 0.029591044411063194, -0.027942737564444542, 0.009261918254196644, 0.02261844277381897, 0.02174196019768715, 0.014494640752673149, 0.02274926006793976, -0.009216131642460823, 0.05248420313000679, -0.02531329356133938, -0.012211865745484829, -0.005206558853387833, -0.020132899284362793, -0.014010613784193993, -0.014010613784193993, 0.014913258142769337, -0.07393836230039597, 0.028361354023218155, -0.010406576097011566, -0.02027679793536663, -0.0534784197807312, 0.006102662533521652, -0.017752010375261307, 0.006122285034507513, -0.02919859066605568, -0.021087870001792908, 0.04748695343732834, -0.007384679280221462, -0.008660155348479748, -0.025274047628045082, 0.04298681393265724, -0.03929774463176727, -0.007410842925310135, -0.023547250777482986, 0.0311870239675045, 0.032495204359292984, 0.023115551099181175, -0.020316043868660927, -0.009543177671730518, -0.02575807459652424, -0.01660081185400486, 0.020250635221600533, -0.05384471267461777, -0.006060146261006594, 0.01981893554329872, -0.013382687233388424, -0.004411838948726654, 0.022343723103404045, -0.002660512225702405, 0.05447264015674591, -0.050966713577508926, 0.008895628154277802, -0.04167863354086876, 0.04356241226196289, -0.013297655619680882, -0.041076868772506714, -0.04131234064698219, -0.015292630530893803, -0.054106347262859344, -0.015057158656418324, -0.044949084520339966, -0.0007305371109396219, 0.01225111074745655, -0.059548377990722656, 0.03210275247693062, -0.00980481319129467, 0.02429291233420372, -0.020015163347125053, -0.0030987528152763844, 0.045864809304475784, -0.05996699631214142, 0.004516493529081345, -0.06331594288349152, -0.024790022522211075, -0.0467805378139019, -0.030375951901078224, -0.028492173179984093, -0.0389837808907032, 0.017071755602955818, 6.387600296875462e-05, -0.015201058238744736, 0.006531091406941414, 0.006867947988212109, -0.03539936617016792, -0.012650106102228165, 0.04157397896051407, 0.024541467428207397, 0.026673801243305206, -0.050207968801259995, -0.012362306006252766, -0.0019442833727225661, 0.009837517514824867, -0.005392974242568016, 0.039507053792476654, -0.009497391059994698, 0.03231206163764, 0.07425232976675034, 0.04701600968837738, 0.023560332134366035, -0.02137567102909088, 0.06148448586463928, 0.049763187766075134, 0.010498149320483208, -0.016234520822763443, 0.02328561432659626, 0.014690867625176907, 0.026699965819716454, -0.0590251088142395, 0.032469041645526886, 0.021323343738913536, -0.003908189479261637, -0.019661953672766685, -0.017882827669382095, -0.027000846341252327, 0.029172426089644432, -0.04892595484852791, 0.061432160437107086, 0.0014610742218792439, -0.046623554080724716, -0.005749453790485859, -0.05640874430537224, -0.011217648163437843, 0.005857378244400024, 0.03511156514286995, 0.02786424569785595, 0.016875529661774635, 0.02652990259230137, 0.04248970374464989, -0.08565966039896011, 0.008980659767985344, -0.001349878846667707, -0.019792772829532623, 0.035242386162281036, -0.005167313385754824, 0.02339026890695095, 5.4780062782811e-05, -0.006809080019593239, -0.003044790355488658, -0.005196747370064259, -0.08623526245355606, 0.0423588864505291, -0.031605642288923264, 0.03851283714175224, -0.03165797144174576, -0.015358040109276772, 0.004110957495868206, 0.008084556087851524, -0.005965303163975477, -0.008882545866072178, 0.024253668263554573, -0.011655888520181179, -0.01616911217570305, 0.03958554565906525, 0.04225423187017441, 0.004634229466319084, -0.01692785695195198, -0.07085105776786804, -0.027157828211784363, -0.05426333099603653, 0.030349789187312126, 0.0016989995492622256, 0.04468744620680809, -0.011950229294598103, 0.017987482249736786, -0.045053739100694656, 0.02216057851910591, -0.0010776137933135033, 0.02095705270767212, -3.8478905480587855e-05, -0.030009662732481956, -0.000951701367739588, 0.025470275431871414, -0.041076868772506714, -0.02183353342115879, -0.04214957728981972, -0.0056153652258217335, 0.030899224802851677, 0.01492634043097496, -0.00790795125067234, -0.027890410274267197, 0.013219164684414864, 0.0005130520439706743, -0.013722813688218594, -0.00033338164212182164, -0.0228277500718832, 0.007790215313434601, 0.07189760357141495, 0.03129167854785919, 0.004990709014236927, -0.0006414172821678221, -0.006174612324684858, -0.030009662732481956, -0.03890528902411461, -0.026699965819716454, -0.005968573968857527, -0.030820734798908234, 0.039925672113895416, -0.01695401966571808, 0.011269975453615189, 0.006135366857051849, -0.001785666448995471, -0.004490329883992672, -0.015030995011329651, 0.0334109328687191, 0.025928139686584473, 0.009726322256028652, -0.022592278197407722, -0.014180677011609077, 0.006194234825670719, 0.018563082441687584, 0.000788587611168623, 0.0022091898135840893, 0.0006217945483513176, 0.013513505458831787, -0.03152715042233467, -0.0006639016210101545, -0.00930116418749094, 0.021859697997570038, -0.04803638905286789, -0.03955937922000885, 0.023207122460007668, -0.019701199606060982, 0.021990515291690826, 0.007901410572230816, -0.028230536729097366, -0.03422200307250023, -0.0060568759217858315, -0.015881311148405075, 0.022082088515162468, 0.003937623463571072, 0.0058050514198839664, 0.01264356542378664, -0.011590479873120785, -0.020878562703728676, 0.04725148156285286, 0.022801587358117104, -0.004316995851695538, -0.0037413963582366705, -0.024122849106788635, 0.0020358560141175985, -0.04018730670213699, -0.006220398470759392, 0.0009206320974044502, 0.023664986714720726, -0.05536220222711563, 0.002770072314888239, -0.028806136921048164, 0.032599858939647675, -0.014730113558471203, -0.00036424651625566185, -0.004827186465263367, -0.018759308382868767, 0.04086755961179733, -0.032469041645526886, -0.005428949370980263, -0.024018194526433945, 0.04167863354086876, -0.053530748933553696, -0.0061059328727424145, 0.025378702208399773, -0.01691477559506893, -0.02073466219007969, 0.0038493212778121233, 0.032809168100357056, -0.04264668747782707, -0.004228693898767233, 0.01648307591676712, 0.0036236601881682873, 0.030009662732481956, 0.022369887679815292, -0.03866981714963913, 0.028884626924991608, 0.031108533963561058, -0.012447337619960308, 0.02672612853348255, 0.012094128876924515, -0.01814446412026882, -0.03241671621799469, -0.05536220222711563, 0.007934114895761013, 0.0009966701036319137, -0.0046571227721869946, 0.002129063941538334, 0.015881311148405075, -0.009019904769957066, 0.004961274564266205, -0.0038885667454451323, -0.024319076910614967, 0.04031812399625778, 0.02327253296971321, -0.0013834009878337383, 0.007404301781207323, -0.06561833620071411, -0.008692859672009945, 0.008470469154417515, -0.004254857078194618, -0.0200674906373024, 0.039376236498355865, 0.003391458187252283, -0.006691343616694212, 0.007757510524243116, 0.020106734707951546, 0.04746079072356224, 0.06556601077318192, 0.04301297664642334, 0.01738571934401989, -0.032495204359292984, -0.010020663030445576, 0.026765374466776848, 0.012198783457279205, -0.032599858939647675, 0.002276234095916152, 0.02072158083319664, 0.0030578721780329943, 0.07545585185289383, 0.0026065497659146786, 0.023442596197128296, -0.02405744045972824, -0.019217172637581825, 0.008346191607415676, -0.019544217735528946, 0.031134696677327156, 0.018589245155453682, 0.03411734849214554, -0.007593987975269556, -0.011668970808386803, -0.023678068071603775, 0.011047584936022758, -0.03707383573055267, 0.004101146012544632, 0.04693751782178879, -0.052327223122119904, 0.009994499385356903, -0.062374047935009, -0.048873625695705414, 0.05206558480858803, 0.0039016485679894686, -0.01471703127026558, -0.012290356680750847, 0.00228277500718832, 0.005432219710201025, 0.028675317764282227, -0.02405744045972824, -0.062007758766412735, 0.014520804397761822, -0.02765493653714657, -0.028152044862508774, -0.030820734798908234, -0.0467543751001358, 0.012826710008084774, -0.01861540973186493, -0.002137240022420883, -0.005245803855359554, -0.008352733217179775, -0.013304196298122406, 0.005370081402361393, 0.05829252675175667, 0.058763470500707626, -0.019125599414110184, -0.0379110723733902, 0.10444513708353043, -0.010295380838215351, -0.006998766213655472, -0.032024260610342026, 0.035817984491586685, -0.018863962963223457, -0.018209872767329216, 0.03382955119013786, -0.032364387065172195, -0.0034470558166503906, 0.02896311692893505, 0.003996491432189941, 0.052301060408353806, -0.000608303933404386, 0.03322778642177582, -0.03699534758925438, 0.015201058238744736, -0.02141491509974003, -0.011067207902669907, 0.012460419908165932, 0.03576565533876419, -0.05374005809426308, 0.00428429152816534, -0.06420550495386124, 0.014115268364548683, -0.007430465426295996, 0.036472074687480927, 0.02151956968009472, 0.03942856192588806, 0.039716362953186035, 0.02906777150928974, 0.009680536575615406, 0.03333244100213051, 0.014782439917325974, 0.009739404544234276, -0.020250635221600533, 0.03521621972322464, -0.01398445013910532, -0.007077256683260202, -0.02684386447072029, -0.007894869893789291, -0.012022179551422596, -0.0015918922144919634, -0.019884344190359116, 0.026451410725712776, 0.013448095880448818, 0.026124365627765656, 0.01298369187861681, -0.016574647277593613, 0.018353773280978203, 0.00874518696218729, 0.011662430129945278, 0.008660155348479748, 0.0053144837729632854, -0.0009745944989845157, 0.005092092789709568, 0.0032557344529777765, 0.04256819561123848, -0.008019146509468555, 0.020917806774377823, 0.00990946777164936, 0.012630483135581017, -0.0036007671151310205, 0.01929566264152527, 0.023115551099181175, -0.0027847893070429564, 0.008320027962327003, -0.0046080658212304115, 0.013356523588299751, 0.0025329645723104477, -0.03819887340068817, -0.0991600900888443, -0.05057426169514656, -0.029146263375878334, 0.025156311690807343, -0.017359556630253792, 0.0054256790317595005, 0.010609344579279423, -0.06472877413034439, -0.0002679726167116314, -0.0035451692529022694, -0.03796340152621269, -0.03356791287660599, 0.021898942068219185, 0.01705867424607277, 0.022932404652237892, 0.005962032824754715, 0.007234238553792238, 0.005458383355289698, -0.03953321650624275, 0.01692785695195198, -0.028806136921048164, 0.011891361325979233, 0.04536770284175873, 0.025326374918222427, -0.0535045862197876, 0.012270733714103699, 0.00017588897026143968, -0.03422200307250023, -0.0038166167214512825, -0.026098202913999557, -0.009320786222815514, -0.009948712773621082, -0.020015163347125053, 0.03644591197371483, -0.005010331515222788, -0.020080571994185448, -0.022553032264113426, -0.036393582820892334, 0.013827468268573284, 0.0200544074177742, -0.013356523588299751, 0.008365814574062824, 0.010890603065490723, -0.0017039051745086908, -0.01092330738902092, 0.0029139721300452948, -0.041390832513570786, 0.013631241396069527, -0.005621905904263258, -0.009346949867904186, 0.03699534758925438, 0.02684386447072029, -0.003610578365623951, -0.05394936725497246, -0.01737263798713684, -0.02441065013408661, -0.018523836508393288, -0.02807355485856533, -0.006776375230401754, -0.011348466388881207, 0.01814446412026882, -0.04717298969626427, 0.005523792468011379, 0.03911459818482399, -0.028727645054459572, 0.03500691056251526, 0.010648589581251144, -0.03108236938714981, -0.013853631913661957, -0.02361265942454338, -0.026255184784531593, -0.015358040109276772, -0.012813628651201725, 0.03963787108659744, 0.04612644761800766, -0.003316237824037671, -0.01828836463391781, -0.01353966910392046, 0.04536770284175873, -0.04858582466840744, 0.024201340973377228, 0.035477858036756516, 0.013245328329503536, -0.010301921516656876, 0.0005755994352512062, -0.003075859509408474, -0.03958554565906525, -0.01950497180223465, 0.007855623960494995, -0.017411883920431137, -0.03150098770856857, 0.031003879383206367, -0.02072158083319664, 0.006325053051114082, -0.012892119586467743, 0.027942737564444542, 0.012990232557058334, 0.01353966910392046, 0.00518039520829916, 0.01420684065669775, -0.03121318854391575, -0.015475776046514511, -0.010766326449811459, -0.07875247299671173, 0.003538628341630101, 0.026124365627765656, 0.006292348727583885, 0.017791256308555603, 0.022356806322932243, -0.018026728183031082, -0.0032900741789489985, 0.013814386911690235, 0.007528579328209162, 0.00144226907286793, 0.0200674906373024, -0.03019280731678009, -0.03924541547894478, 0.018693899735808372, -0.017438046634197235, 0.014520804397761822, -0.026006629690527916, -0.027707263827323914, -0.02672612853348255, -0.015397285111248493, -0.02820437215268612, 0.0657229945063591, 0.025810401886701584, 0.03477143868803978, -0.02641216479241848, -0.014494640752673149, 0.01231652032583952, 0.03286149725317955, 0.024606876075267792, -0.025274047628045082, -0.024319076910614967, -0.012355765327811241, -0.03969019651412964, -0.006966061424463987, -0.00660304119810462, 0.0066978842951357365, 0.019583463668823242, -0.020119817927479744, -0.025103984400629997, -0.039062272757291794, 0.019779689610004425, 0.025339458137750626, 0.02783808298408985, -0.00011650982924038544, 0.004948193207383156, -0.02497316710650921, -0.030061990022659302, -0.056984346359968185, -0.005242533516138792, -0.0378849096596241, 0.023651905357837677, -0.04327461123466492, -0.03644591197371483, 0.018327610567212105, 0.024358322843909264, 0.026791537180542946, -0.01872006431221962, 0.014586213044822216, -0.013997532427310944, 0.009732862934470177, -0.010229972191154957, 0.03825119882822037, -0.0029352300334721804, -0.0012035261606797576, 0.0267392098903656, -0.026896191760897636, 0.05656572803854942, -0.019910508766770363, -0.05057426169514656, -0.017895910888910294, 0.008725563995540142, 0.004611336626112461, 0.006661909632384777, -0.005857378244400024, -0.013945205137133598, -0.002039126353338361, 0.02762877382338047, 0.03257369622588158, -0.01950497180223465, -0.022539950907230377, 0.0100337453186512, -0.003190325340256095, 0.03830352798104286, -0.014455394819378853, 0.0183799359947443, 0.008444305509328842, -0.004575361497700214, -0.01276130136102438, -0.012669729068875313, -0.029721861705183983, 0.030245134606957436, -0.03356791287660599, 0.012669729068875313, 0.022906241938471794, 0.009346949867904186, -0.0345098040997982, 0.0069856843911111355, -0.0014365457464009523, 0.028047392144799232, -0.0046865567564964294, 0.03874830901622772, 0.02439756691455841, -0.0712696760892868, -0.03830352798104286, 0.02718399278819561, -0.032704513520002365, -0.02664763852953911, -0.02684386447072029, -0.0211925245821476, 0.048402681946754456, -0.011106452904641628, -0.009320786222815514, 0.0007677384419366717, 0.013487341813743114, 0.02151956968009472, 0.05083589628338814, 0.01860232837498188, -0.009673994965851307, -0.013919041492044926, -0.039480891078710556, 0.011178403161466122, 0.013631241396069527, 0.020643088966608047, -0.010426199063658714, -0.003460137639194727, 0.0150440763682127, -0.0038493212778121233, 0.030820734798908234, 0.012434256263077259, 0.011119535192847252, 0.018772391602396965, -0.00676983455196023, 0.00819575134664774, -0.0007816379074938595, -0.03987334296107292, -0.01894245482981205, -0.025444112718105316, 0.011708215810358524, 0.01387979555875063, -0.031239351257681847, 0.013552750460803509, 0.036393582820892334, 0.00026592856738716364, 0.0300881527364254, -0.03286149725317955, 0.046963680535554886, -0.04649273678660393, 0.0008576758555136621, -0.00807801540941, 0.003685798728838563, -0.03252136707305908, -0.03032362461090088, -0.017215656116604805, -0.010439281351864338, 0.0037185032851994038, -0.027811918407678604, -0.011701675131917, -0.0029891924932599068, -0.02441065013408661, -0.002465920289978385, -0.00858166441321373, 0.00349611253477633, -0.029564879834651947, -0.011767083778977394, 0.031710296869277954, 0.0034830307122319937, -0.1257946491241455, -0.04319612309336662, 0.028256699442863464, -0.0074762520380318165, 0.012996774166822433, -0.00941890012472868, 0.014638540334999561, 0.013487341813743114, 0.029800353571772575, -0.019321827217936516, -0.007548201829195023, -0.02575807459652424, 0.019007863476872444, -0.002169944578781724, 0.00824153795838356, -0.04759160801768303, -0.03521621972322464, 0.006491845939308405, 0.032939985394477844, -0.015737412497401237, -0.007901410572230816, -0.011054125614464283, 0.025051657110452652, 0.01019072625786066, 0.006442789454013109, 0.015619675628840923, -0.018628491088747978, -0.002770072314888239, -0.008771350607275963, 0.028125882148742676, -0.012466960586607456, -0.014834767207503319, 0.0037086918018758297, 0.04599563032388687, -0.020917806774377823, 0.0019524594536051154, -0.02684386447072029, 0.02694851905107498, -0.004421650432050228, -0.013945205137133598, -0.011139157228171825, -0.03730931133031845, 0.0178174190223217, -0.01431149523705244, 0.0067959981970489025, -0.0161429475992918, 0.016522319987416267, -0.01581590250134468, -0.00028984376695007086, 0.013238787651062012, -0.008869464509189129, -0.0019197550136595964, 0.01695401966571808, 0.05094055086374283, 0.007221156731247902, 0.017908992245793343, -0.014808603562414646, -0.0012877401895821095, 0.018458427861332893, 0.01270243339240551, 0.007391219958662987, 0.01929566264152527, 0.03924541547894478, -0.008548960089683533, -0.026765374466776848, -0.01849767379462719, -0.002465920289978385, 0.04670204594731331, -0.0031036583241075277, -0.04000416025519371, -0.012499664910137653, 0.0011855385964736342, 0.012872496619820595, 0.012283815070986748, 0.03490225598216057, 0.0053864335641264915, 0.020342208445072174, 0.06608927994966507, -0.011335385031998158, 0.03254753351211548, 0.042960651218891144, -0.06629858911037445, 0.024031277745962143, 0.012735137715935707, -0.0013883066130802035, 0.019347989931702614, 0.03911459818482399, -0.03142249584197998, -0.026346756145358086, 0.02562725730240345, 0.004984167870134115, -0.002425039652734995, 0.004222152754664421, 0.025548767298460007, 0.02349492348730564, 0.01265664678066969, 0.017189493402838707, 0.012159538455307484, 0.044530466198921204, 0.015462694689631462, 0.04892595484852791, 0.005160772241652012, 0.029931170865893364, -0.061903104186058044, -0.004853350110352039, -0.014690867625176907, 0.013140673749148846, -0.02885846234858036, 0.019688118249177933, -0.005811592098325491, 0.02550952136516571, 0.019792772829532623, -0.0018805095460265875, 0.032913822680711746, 0.01894245482981205, 0.01648307591676712, 0.0013408850645646453, -0.009229213930666447, 0.04322228580713272, -0.017411883920431137, 0.02307630516588688, 0.014023696072399616, -0.015802821144461632, -0.035582512617111206, 0.007018388714641333, -0.02026371657848358, 0.002745544072240591, 0.027367137372493744, 0.00020971769117750227, -0.014324577525258064, -0.01848459057509899, 0.01131576206535101, 0.015017912723124027, 0.0072865658439695835, -0.012100670486688614, 0.004084793850779533, 0.01225111074745655, 0.004971086047589779, -0.024462977424263954, 0.04366706684231758, -0.020433779805898666, -0.0072473203763365746, 0.06540902704000473, 0.0020734660793095827, -0.016692383214831352, 0.0073258113116025925, -0.009588963352143764, -0.019884344190359116, -0.03825119882822037, 0.03723081946372986, -0.00114138750359416, -0.009235754609107971, 0.028125882148742676, 0.034038856625556946, 0.00011211516539333388, 0.037387799471616745, 0.003193595912307501, -0.021035542711615562, 0.017320310696959496, 0.027236320078372955, 0.0025280588306486607, 0.025117067620158195, 0.016077538952231407, 0.00858166441321373, 0.023128632456064224, -0.0005899076932109892, -0.040291961282491684, -0.005870460066944361, -0.002995733404532075, 0.03063758835196495, -0.013853631913661957, -0.012767842039465904, 0.04222806915640831, 0.027550281956791878, 0.005981655791401863, 0.013735895976424217, -0.006436248309910297, -0.009392736479640007, 0.015632757917046547, 0.040396615862846375, -0.03262602165341377, 0.003002274315804243, -0.012689351104199886, 0.021218689158558846, 0.01615603081882, 0.03490225598216057, 0.030663752928376198, 0.01292482390999794, 0.022369887679815292, 0.01572433114051819, 0.01661389321088791, 0.04468744620680809, -0.024031277745962143, -0.009445063769817352, -0.015985965728759766, -0.0194918904453516, 0.043824050575494766, 0.030689915642142296, -0.03641974553465843, -0.014782439917325974, -0.028884626924991608, 0.05693201720714569, -0.0027668019756674767, -0.001276293653063476, -0.011767083778977394, 0.015331876464188099, -0.0012157902820035815, -0.03495458513498306, 0.0012648471165448427, -0.007273484021425247, -0.013395768590271473, -0.008575123734772205, -0.027105500921607018, 0.02506474032998085, -0.012067966163158417, 0.0002833028556779027, 0.008123801089823246, -0.0019115788163617253, 0.013735895976424217, -0.008313487283885479, -0.036838363856077194, -0.0019475538283586502, -0.031579479575157166, 0.01265664678066969, -0.004464166238903999, 0.02765493653714657, 0.005899894516915083, -0.028779972344636917, -0.01242117490619421, -0.0014389986172318459, 0.004009573254734278, 0.005599012598395348, -0.00012816081289201975, 0.01364432368427515, -0.04610028490424156, -0.008856382220983505, -0.014900176785886288, -0.013631241396069527, 0.0017006347188726068, 0.009830976836383343, 0.04332694038748741, 0.009654372930526733, -0.002390699926763773, 0.01737263798713684, -0.008169587701559067, -0.023442596197128296, 0.02195126935839653, 0.022696932777762413, -0.004833727143704891, -0.03317545726895332, -0.0018167357193306088, 0.006145178340375423, 0.03767560049891472, -0.002879632404074073, -0.016967101022601128, -0.0040161143988370895, 0.047879409044981, 0.06389153748750687, 0.05078357085585594, 0.029250917956233025, -0.011387711390852928, 0.031108533963561058, -0.01925641857087612, -0.030951552093029022, 0.012918283231556416, -0.01637842133641243, -0.04879513382911682, 0.008732105605304241, -0.009144182316958904, -0.0023808886762708426, -0.0008217009017243981, 0.0311870239675045, -0.002351454459130764, 0.006648827809840441, -0.010740162804722786, 0.020708497613668442, 0.010563557967543602, -0.021467242389917374, 0.020669253543019295, -0.02104862593114376, 0.008051851764321327, -0.010164562612771988, -0.04364090412855148, 0.00970015861093998, 0.008529337123036385, 0.010792490094900131, -0.03087306208908558, -0.012663187459111214, 0.034588295966386795, -0.01971428096294403, 0.006881029810756445, 0.006233480293303728, 0.026333674788475037, -0.013356523588299751, 5.9685738960979506e-05, -0.0050757406279444695, 0.0034176218323409557, -0.0042679389007389545, 0.037597108632326126, -0.04209725186228752, 0.0256403386592865, 0.01605137623846531, 0.029172426089644432, -0.00470945006236434, 0.014049859717488289, 0.023691149428486824, -0.0024920839350670576, -0.049658533185720444, -0.010550476610660553, -0.0010669847251847386, -0.01784358359873295, 0.03330627828836441, 0.01737263798713684, 0.0007231785566546023, 0.01248004287481308, -0.007744429167360067, 0.011224188841879368, -0.03409118577837944, -0.0037119623739272356, -0.05860649049282074, -0.012846332974731922, 0.03220740705728531, -0.00326063996180892, 0.009961795061826706, 0.0018085596384480596, -0.033594075590372086, 0.008673236705362797, -0.01683628372848034, -0.015658920630812645, -0.0006487757782451808, -0.0022664228454232216, 0.017555782571434975, 0.009543177671730518, 0.015763575211167336, -0.027340974658727646, 0.017634274438023567, -0.041626304388046265, -0.0005522974533960223, -0.01131576206535101, -0.024567630141973495, 0.044608958065509796, 0.019308745861053467, -0.007234238553792238, 0.0026686883065849543, -0.013395768590271473, 0.04021346941590309, 0.002212460385635495, -0.045079901814460754, 0.0038951076567173004, -0.016626974567770958, 0.06813004612922668, -0.025705747306346893, -0.03699534758925438, 0.008869464509189129, -0.007306188344955444, 0.04698984697461128, -0.01025613583624363, -0.009660913608968258, -0.0401349812746048, -0.007554742973297834, -0.00220101373270154, 0.003456867067143321, 0.027602609246969223, -0.016666220501065254, -0.01603829301893711, -0.0035157352685928345, -0.006145178340375423, 0.02174196019768715, 0.023246368393301964, 0.021205607801675797, -0.004127309657633305, 0.017961319535970688, -0.009170345962047577, 0.010471985675394535, 0.01347425952553749, 0.029146263375878334, 0.0080714737996459, 0.037387799471616745, -0.00011732744314940646, 0.020878562703728676, -0.01493942178785801, -0.0412338525056839, -0.018536917865276337, -0.01386671420186758, -0.019531136378645897, 0.01737263798713684, -0.031108533963561058, 0.03542552888393402, -0.014285331591963768, 0.004333348013460636, 0.004274480044841766, 0.03424816578626633, 0.011505448259413242, -0.013683568686246872, -0.018092136830091476, -0.01906019076704979, -0.006436248309910297, 0.01726798340678215, 0.003144538961350918, 0.00662593450397253, -0.023900458589196205, -0.0009933996479958296, 0.027785755693912506, -0.011832493357360363, 0.018183710053563118, -0.004421650432050228, -0.02263152413070202, 0.036498237401247025, 0.006161530502140522, 0.002124158199876547, -0.013408850878477097, 0.0027488144114613533, -0.03519005700945854, -0.01470394991338253, -0.024881593883037567, -0.03385571390390396, -0.0009451604564674199, 0.016469992697238922, -0.04434731975197792, 0.013788223266601562, -0.04332694038748741, -0.007927574217319489, 0.018667737022042274, 0.009713240899145603, -0.005739642307162285, 0.017895910888910294, -0.0069856843911111355, 0.0300881527364254, 0.02684386447072029, 0.02161114290356636, -0.0026523361448198557, 0.004794481676071882, -0.025444112718105316, 0.015057158656418324, -0.006442789454013109, 0.013591996394097805, 0.024580713361501694, -0.0356348380446434, -0.009203050285577774, 0.047853246331214905, -0.010334626771509647, 0.02384813129901886, 0.03668138384819031, -0.0025018954183906317, 0.020316043868660927, -0.01870698295533657, -0.037283144891262054, -0.02261844277381897, 0.018746227025985718, -0.03286149725317955, -0.019112518057227135, -0.0005428949370980263, -0.011060666292905807, -0.013036019168794155, -0.030218971893191338, -0.010825194418430328, -0.039376236498355865, -0.006482034921646118, 0.026242101565003395, 0.0024675556924194098, 0.010543935000896454, -0.00699222506955266, 0.010471985675394535, 0.01398445013910532, -0.014403068460524082, 0.02151956968009472, 0.01605137623846531, 0.04492292180657387, -0.01420684065669775, -0.015972884371876717, 0.025378702208399773, -0.012466960586607456, 0.02285391464829445, 0.025588011369109154, 0.004892595112323761, -0.012885578908026218, -0.011767083778977394, 0.017438046634197235, -0.0006966061773709953, -0.004751965869218111, -0.05114986002445221, 0.0026179964188486338, 0.02341643162071705, -0.012506206519901752, 0.008169587701559067, 0.03351558744907379, -0.018759308382868767, -0.006743670906871557, -0.002773342886939645, -0.020577680319547653, 0.0051247975789010525, 0.020590761676430702, -0.014808603562414646, -0.0009361667325720191, 0.01759502850472927, 0.016208358108997345, 0.010622425936162472, 0.03710000216960907, 0.004140391480177641, 0.004369323141872883, 0.004032466560602188, -0.011296139098703861, -0.008038769476115704, 0.027550281956791878, 0.00980481319129467, -0.01769968308508396, 0.001097236410714686, -0.006200775969773531, 0.005684044677764177, -0.015030995011329651, 0.0130883464589715, -0.007724806200712919, 0.0020685605704784393, 0.01814446412026882, 0.06713582575321198, -0.014115268364548683, -0.05211791396141052, 0.012035260908305645, 0.025771157816052437, -0.015475776046514511, 0.05368772894144058, 0.013036019168794155, 0.003335860325023532, -0.01053739432245493, -0.02339026890695095, -0.014180677011609077, -0.013827468268573284, 0.011171861551702023, -0.025103984400629997, 0.03254753351211548, -0.008823677897453308, 0.004107687156647444, 0.02796890027821064, -0.010053367353975773, -0.0034307034220546484, -0.029172426089644432, 0.017791256308555603, 0.01760810986161232, -0.01265664678066969, 0.01962270773947239, 0.01437690481543541, -0.016182193532586098, 0.0037185032851994038, -0.008712482638657093, 0.01581590250134468, 0.05313829332590103, -0.008326569572091103, 0.030585261061787605, 0.03534703701734543, 0.0128070879727602, -0.004781399853527546, -0.008365814574062824, -0.026150530204176903, -0.025012413039803505, 0.014350741170346737, -0.009994499385356903, 0.004470706917345524, 0.000773052976001054, 0.0034110809210687876, 0.011590479873120785, 0.035242386162281036, 0.00014757912140339613, -0.015658920630812645, 0.010380412451922894, -0.012074506841599941, 0.02027679793536663, 0.015750493854284286, 0.011230730451643467, -0.013264951296150684, -0.02741946466267109, 0.014560049399733543, 0.007430465426295996, 0.023010896518826485, -0.0057265604846179485, 0.006894111633300781, 0.019910508766770363, -0.012303438037633896, 0.004542657174170017, -0.015070240013301373, -0.00829386431723833, 0.011387711390852928, -0.03419584035873413, 0.003960516769438982, -0.007947197183966637, -0.0013637782540172338, 0.012015638872981071, 0.005281778983771801, -0.0012787465238943696, -0.011322302743792534, 0.024083605036139488, 0.017778173089027405, 0.029486389830708504, 0.011989475227892399, -0.0036956099793314934, -0.021257935091853142, 0.038826800882816315, -0.004601525142788887, 0.023821968585252762, -0.039847180247306824, -0.002739003160968423, 0.000578461098484695, 0.04112919792532921, -0.014298413880169392, -0.03257369622588158, -0.0035974965430796146, -0.014586213044822216, 0.013127592392265797, 0.0021568627562373877, 0.032835330814123154, 0.03955937922000885, -0.03210275247693062, 0.017804337665438652, -0.022644605487585068, 0.03108236938714981, -0.023560332134366035, 0.031056206673383713, -0.04510606452822685, 0.020433779805898666, -0.022448377683758736, -0.018759308382868767, -0.022265233099460602, 0.011054125614464283, 0.010530853644013405, -0.03942856192588806, 0.002429945394396782, 0.01971428096294403, -0.022147497162222862, 0.030375951901078224, -0.012427715584635735, -0.008025688119232655, 0.01759502850472927, 0.0043071843683719635, 0.009981418028473854, -0.024476058781147003, -0.004078252706676722, -1.8191885828855447e-05, 0.007456629071384668, 0.008490092121064663, 0.024907758459448814, 0.0009132735431194305, 0.009490850381553173, 0.002096359385177493, -0.008732105605304241, -0.00896757747977972, -0.023586494848132133, 0.000932896276935935, -0.008248078636825085, -0.011237271130084991, -0.014638540334999561, 0.0200544074177742, -0.021925106644630432, -0.015567348338663578, -0.007194993086159229, 0.0045557389967143536, 0.030009662732481956, 0.018092136830091476, 0.0037871827371418476, 0.054315656423568726, 0.005540144629776478, 0.008895628154277802, -0.019230253994464874, -0.005144420079886913, -0.016221439465880394, 0.016849365085363388, 0.019230253994464874, 0.008411601185798645, -0.013696650043129921, -0.025692665949463844, -0.004549197852611542, 0.033253949135541916, 0.003034978872165084, -0.014416149817407131, -0.010066449642181396, -0.03087306208908558, 0.039925672113895416, -0.042175740003585815, 0.01571124792098999, 0.028884626924991608, 0.012414633296430111, 0.016077538952231407, 0.031919606029987335, -0.016626974567770958, 0.040605925023555756, -0.00048280038754455745, -0.01470394991338253, 0.01420684065669775, 0.013827468268573284, 0.022134415805339813, 0.025692665949463844, -0.0018363584531471133, -0.011505448259413242, 0.016901692375540733, -0.05141149461269379, -0.014743194915354252, 0.015384203754365444, 0.008411601185798645, -0.015475776046514511, 0.0025264236610382795, -0.02598046511411667, 0.009340409189462662, 0.03150098770856857, 0.03029746189713478, 0.01064204890280962, -0.005255615338683128, -0.005556496791541576, 0.0136574050411582, -0.008149964734911919, 0.006900652311742306, -0.02618977427482605, -0.018863962963223457, -0.02539178542792797, -0.017542701214551926, 0.02687002904713154, 0.007090338505804539, -0.018641572445631027, 0.010753244161605835, -0.03764943778514862, -0.012277274392545223, -0.014062941074371338, 0.013166837394237518, 0.004807563498616219, 0.027340974658727646, 0.02586272917687893, 0.029381735250353813, -0.012081047520041466, 0.004146932158619165, -0.016770875081419945, -0.0029924630653113127, 0.01593363843858242, -0.01119148451834917, 0.004438002593815327, -0.03830352798104286, -0.0006087127840146422, -0.02229139767587185, -0.010243053548038006, 0.008228455670177937, 0.00465058209374547, 0.03129167854785919, 0.008483550511300564]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
".
Our contributions in this paper are as follows:
•We show that there is high level of redundancy across
several different heads of multi head attention, and the re-
dundancy varies differently across layers with increasing
redundancy towards later layers.
•We introduce CHAI , a practical and principled inference
time pruning method which clusters attention heads that
have similar output together with dynamic determination
of clusters. CHAI reduces both compute and K,V cache
size for self attention.
•We show that CHAI is capable of reducing the inference
time by up to 1.73 ×and K,V cache memory size by up
to 21.4% compared to MHA for LLAMAmodels with
minimal accuracy trade-off (maximum of 3.2%).
•Compared to other runtime pruning methods like
DEJAVU, which only works well for OPT models, CHAI
outperforms DEJAVUand performs well for wider class
of models.
2. Background and Related Work
We first provide background on inference process for de-
coder only transformers like GPT (Radford et al., 2019;
2
Runtime Clustered Head Attention for Efficient Inference
QueriesKeysV alues
(a)Multi-Head Attention
QueriesKeysV alues (b)Clustered Head Attention
Figure 3. Clustered Head Attention: Schematic of clustered head
attention, comparing it with popular Multi-Head Attention. In
clustered head attention, we remove the query and key vectors
which produce similar attention scores.
Brown et al., 2020), LLaMa (Touvron et al., 2023a;b) and
the bottlenecks in performing inference. Further, we dis-
cussed several prior lines of work which have tried to tackle
the inference bottlenecks for transformer based model.
Decoder-only Transformer A decoder-only transformer
forms the building block of popular LLMs. A single decoder
block consists of a self attention layer and a MLP. An input
token is fed into the decoder block, to perform next-word
prediction. The self attention block uses prior query (Q),
key (K) and value (V) vectors associated with current token.
These tokens are extracted by performing a linear projection
with query, key and value weight matrices associated with a
transformer.
To precisely define Multi-Head Attention (MHA), let H,T,
dbe positive integers, where Hdenotes number of heads, T
denotes sequence length, ddenotes model dimension. Let
x∈RT×dbe input to the MHA layer. For a single head h,
thenKh=xWh
K,Qh=xWh
QandVh=xWh
Vdenote
the corresponding key, query and value vector. The attention
matrix for head his calculated as follows:
Ah=σ(1√
dQhKhT)
Output of MHA is denoted by:
y=A0V0⊕A1V1⊕A2V2⊕ · · · ⊕ AHVH
For performing inference, self attention needs access to the
query, key and values associated with prior tokens. In order
to avoid re-computation, inference serving systems cache
the prior tokens in a sequence.
Compute cost required for multiple attention heads and
memory capacity required for storing key and value vectors
associated with each head during inference form two pri-
mary bottlenecks for LLM inference. In this work, we focus
on reducing both memory and compute requirements via
clustering multiple attention heads with similar output.
Building Efficient Transformers. Improving efficiency of
transformer models has been of major focus in recent years.Prior work can be broadly categorized in the following fields
- (i) Hardware-software co-design (Dao et al., 2022; Dao,
2023; Ham et al., 2020; 2021; Tambe et al., 2021; Fang et al.,
2022; Qin et al., 2023; Wang et al., 2021b), (ii) Knowledge
distillation (Hsieh et al., 2023; Jiao et al., 2019; Sanh et al.,
2019; Wang et al., 2020) (iii) Neural Architecture Search
(NAS) (Zhou et al., 2023; Kitaev et al., 2020; Lagunas et al.,
2021) and (iv) Pruning (V oita et al., 2019; Liu et al., 2023b)
and Quantization (Frantar et al., 2022; Xiao et al., 2023;
Kim et al., 2021; Shen et al., 2020; Dettmers et al., 2022","[0.028344126418232918, 0.0413973443210125, 0.04070116952061653, -0.018585294485092163, 0.0245524775236845, 0.004997516982257366, 0.031228266656398773, 0.04639485850930214, -0.02460220456123352, 0.025111902505159378, 0.017802100628614426, -0.011977880261838436, -0.026255611330270767, 0.0013379546580836177, -0.02251368947327137, -0.038811564445495605, 0.035579338669776917, -0.03346595913171768, 0.03565392643213272, 0.0525609515607357, -0.05713579058647156, 0.011144960299134254, 0.03416213020682335, 0.028319263830780983, 0.053555481135845184, 0.006831183098256588, -0.010349336080253124, -0.006343241315335035, 0.034584805369377136, -0.042416736483573914, 0.02482597343623638, -0.017043771222233772, -0.035231251269578934, -0.026205886155366898, 0.0030690596904605627, 0.0525609515607357, 0.002024802379310131, 0.02174292877316475, -0.04460470378398895, 0.005929889623075724, 0.035206388682127, -0.011965448036789894, -0.05171560123562813, 0.03903533145785332, 0.0023915357887744904, 0.005149804521352053, 0.01892094686627388, 0.03060668334364891, -0.04015417769551277, 0.07846847921609879, -0.028393853455781937, 0.043361540883779526, -0.06822481006383896, 0.019269034266471863, -0.008683497086167336, 0.0108901122584939, -0.00273340567946434, 0.0023449170403182507, 0.030507231131196022, 2.425625643809326e-05, 0.019119853153824806, -0.02891598269343376, 0.026454517617821693, 0.010156645439565182, -0.03187471255660057, -0.006464450154453516, -0.03505720943212509, 0.019816026091575623, -0.009920444339513779, 0.0017886013956740499, -0.013923430815339088, 0.041273027658462524, 0.034361038357019424, -0.03393836319446564, 0.012580813840031624, 0.019530097022652626, -0.008832676336169243, 0.05116860941052437, -0.009398316033184528, 0.033590275794267654, 0.028269536793231964, -0.0055600483901798725, 0.05648934841156006, 0.0029478513170033693, 0.0021195937879383564, -0.024216823279857635, -0.0221407413482666, -0.04716562107205391, -0.07369472831487656, -0.036772776395082474, -0.017814531922340393, 0.04634513333439827, -0.010082055814564228, 0.005065890960395336, 0.02396819181740284, 0.043958257883787155, 0.015179025940597057, -0.005280336830765009, 0.03234711289405823, 0.049104955047369, 0.038264572620391846, 0.03150176256895065, 0.03088017925620079, -0.0036269293632358313, 0.014706623740494251, -0.03901046887040138, 0.005106294061988592, -0.028617622330784798, -0.027623092755675316, 0.0026044275145977736, -0.03289410471916199, -0.027299869805574417, -0.05469919368624687, 0.021270526573061943, -0.01914471760392189, -0.035778243094682693, -0.039458006620407104, 0.01951766572892666, -0.030731000006198883, 0.012792152352631092, -0.010411493480205536, -0.009988818317651749, 0.04448038712143898, 0.013823977671563625, 0.004096223507076502, -0.02232721634209156, 0.03242170438170433, -0.039681777358055115, 0.016621096059679985, -0.0020543276332318783, 0.02337147295475006, 0.025584304705262184, 0.043411266058683395, -0.027523638680577278, -0.0016425297362729907, -0.05499755218625069, -0.027623092755675316, 0.02637992799282074, -0.05106915533542633, 0.009814775548875332, 0.0251989234238863, -0.019182011485099792, -0.012966195121407509, 0.037170588970184326, -0.02241423726081848, 0.05952266603708267, -0.02020140551030636, 0.009025366976857185, -0.023893602192401886, 0.03301842138171196, -0.027026373893022537, -0.019132286310195923, -0.051367513835430145, -0.02901543490588665, -0.04883145913481712, -0.04820987954735756, -0.027846861630678177, 0.03923423960804939, 0.0323968380689621, -0.06787672638893127, 0.01102686021476984, 0.016583800315856934, -0.011567635461688042, -0.027250142768025398, -0.008260820992290974, 0.0317503958940506, -0.041273027658462524, 0.018746905028820038, -0.054599739611148834, -0.042640507221221924, -0.021457001566886902, -0.039134785532951355, -0.0022206006105989218, -0.02533567138016224, 0.021668339148163795, -0.0012711345916613936, -0.045276012271642685, -0.0016487454995512962, -0.005578695796430111, -0.034311309456825256, -0.03401295095682144, 0.054649464786052704, -0.00891348160803318, 0.04885632544755936, -0.052461497485637665, -0.021021893247961998, -0.011909506283700466, 0.03366486728191376, -0.0023045141715556383, 0.037444084882736206, -0.02874193899333477, 0.04040281102061272, 0.025024879723787308, 0.03915964812040329, 0.020822986960411072, 0.0046867262572050095, 0.033316779881715775, 0.02241423726081848, 0.009410747326910496, -0.015750881284475327, 0.032546017318964005, 0.0196544136852026, 0.019579824060201645, -0.04798610880970955, 0.04706616699695587, 0.0034870735835283995, -0.022364510223269463, -0.008372705429792404, 0.008235957473516464, -0.023122839629650116, 0.019169580191373825, -0.015937356278300285, 0.01500498317182064, 0.008198662661015987, 0.0011468182783573866, -0.030258597806096077, -0.06892098486423492, 0.013413733802735806, 0.002259449567645788, 0.03848833963274956, 0.041273027658462524, 0.011194687336683273, 0.01982845738530159, 0.025658894330263138, -0.04535060375928879, 0.010305824689567089, -0.0036020660772919655, -0.05280958488583565, 0.015104436315596104, 0.001153034158051014, 0.00409311568364501, -0.01291646808385849, -0.008994287811219692, -0.010846600867807865, 0.013388870283961296, -0.07279965281486511, 0.047091033309698105, -0.02301095612347126, 0.01459473930299282, -0.06021883711218834, -0.030407778918743134, -0.02311040833592415, -0.007148189935833216, -0.0018896084511652589, -0.01161736249923706, 0.04599704593420029, -0.011374945752322674, -0.035131800919771194, 0.05638989433646202, 0.03910992294549942, 0.017988575622439384, -0.026230748742818832, -0.06524121761322021, -0.03923423960804939, -0.04985085502266884, 0.006862262263894081, 0.006147443316876888, 0.03267033398151398, -0.0032850594725459814, 0.028717076405882835, -0.02737445943057537, 0.037170588970184326, 0.010560673661530018, 0.005395329557359219, 0.00966559536755085, -0.008111641742289066, 0.015887629240751266, 0.031178539618849754, -0.015042277984321117, -0.02928893081843853, -0.007999756373465061, -0.012468929402530193, 0.014980119653046131, 0.006974147167056799, -0.037220314145088196, -0.012991057708859444, 0.029711605980992317, 0.021792655810713768, -0.01455744355916977, 0.009777480736374855, -0.012655403465032578, 0.01246271375566721, 0.04559923708438873, 0.04321236163377762, 0.015862764790654182, 0.0060759615153074265, 0.021071620285511017, -0.022725027054548264, -0.04612136259675026, -0.04005472734570503, 0.01951766572892666, -0.018436113372445107, 0.02896570786833763, -0.04559923708438873, 0.04612136259675026, 0.0037015192210674286, -0.005006840918213129, 0.016558937728405, 0.005482350941747427, 0.013364006765186787, 0.01736699417233467, -0.004124194849282503, 0.009733970277011395, 0.0008212648681364954, -0.006943068001419306, 0.0025049743708223104, -0.025447556748986244, -0.0040433891117572784, 0.012829447165131569, 0.01360020786523819, -0.018448546528816223, -0.029363520443439484, -0.004369719419628382, 0.025534577667713165, -0.02879166603088379, -0.011592498980462551, 0.029139751568436623, -0.028070630505681038, 0.023458493873476982, -0.000291172182187438, -0.05842868238687515, -0.05748387798666954, -0.02884139120578766, -0.007788418792188168, 0.039632052183151245, -0.00948533695191145, -0.007527354639023542, 0.0165962316095829, -0.039184510707855225, -0.02182994969189167, 0.03157635033130646, -0.0008725453517399728, 0.012500008568167686, -0.012046254239976406, -0.0380159392952919, -0.007962461560964584, -0.04505224525928497, 0.029214341193437576, 0.0007334664114750922, -0.014507717452943325, -0.05584290251135826, 0.020039794966578484, -0.057185519486665726, 0.020661376416683197, -0.016534073278307915, 0.018063165247440338, 0.009746401570737362, -0.0017202274175360799, 0.03975636884570122, -0.018585294485092163, 0.002396197523921728, -0.016795137897133827, 0.04547492042183876, -0.046817537397146225, 0.0050192722119390965, 0.06434614211320877, -0.015427658334374428, -0.002214384963735938, 0.007850577123463154, 0.018386388197541237, -0.03378918394446373, 0.01198409590870142, 0.029313793405890465, 0.0070176576264202595, -0.0044412012211978436, 0.030532093718647957, -0.03774244338274002, 0.045276012271642685, 0.02814522013068199, 0.003825835417956114, 0.042590778321027756, 0.04157138615846634, -0.004494036082178354, -0.01642218977212906, -0.045823004096746445, 0.003822727594524622, 0.0060013714246451855, 0.006849830504506826, 0.008764302358031273, 0.010119350627064705, 0.0162357147783041, 0.03152662515640259, -0.02032572217285633, -0.012145706452429295, 0.01254973467439413, 0.03774244338274002, 0.01577574387192726, -0.014967688359320164, -0.06021883711218834, 0.017528604716062546, -0.015726016834378242, 0.005597343668341637, -0.05007462203502655, 0.029313793405890465, -0.00784436147660017, 0.0011336096795275807, -0.002219046698883176, 0.02059921808540821, 0.051914505660533905, 0.06131282076239586, 0.0448533371090889, 0.02550971321761608, -0.040179044008255005, -0.029040297493338585, 0.021432137116789818, 0.025808073580265045, 0.013426165096461773, -0.003853806760162115, 0.03498261794447899, -0.014482853934168816, 0.08010945469141006, -0.03602687641978264, 0.015079572796821594, -0.010946054011583328, -0.017317267134785652, -0.007539786398410797, -0.028344126418232918, 0.02792145125567913, 0.00852810125797987, 0.03925910219550133, -0.013674798421561718, -0.00024183414643630385, -0.03719545155763626, 0.006905773188918829, -0.059870753437280655, 0.0193311907351017, 0.03366486728191376, -0.06136254966259003, -0.004083791747689247, -0.055594269186258316, -0.03833916038274765, 0.03356541320681572, 0.016770275309681892, -0.007452765014022589, 0.00239930534735322, -0.009883149527013302, 0.005833544302731752, 0.049950309097766876, 0.004994409158825874, -0.04477874934673309, -0.005709228105843067, -0.045823004096746445, -0.01765292137861252, -0.042143240571022034, -0.03005969151854515, 0.009516416117548943, -0.006750377360731363, -5.191178570385091e-05, 0.005236825905740261, -0.03543015941977501, 0.015203889459371567, 0.00031700669205747545, 0.06608656793832779, 0.02697664685547352, -0.013836408965289593, -0.029860785230994225, 0.07135758548974991, 0.010591752827167511, 0.0044816043227910995, -0.030805589631199837, 0.016024377197027206, -0.010616615414619446, -0.0182869341224432, -0.025261081755161285, -0.0030597359873354435, -0.025683756917715073, 0.02841871604323387, -0.0012563720811158419, 0.03033318743109703, 0.003574094967916608, 0.03115367516875267, -0.023632537573575974, 0.0002678628661669791, -0.018262071534991264, -0.0060355584137141705, 0.015191457234323025, 0.04169570282101631, -0.019990067929029465, 0.0255594402551651, -0.06598711758852005, 0.034137267619371414, -0.03127799183130264, 0.015837902203202248, 0.005090754479169846, 0.037220314145088196, 0.03294382989406586, 0.02114620991051197, 0.03416213020682335, 0.020400311797857285, 0.012487577274441719, 0.009056446142494678, -0.013451028615236282, 0.05474891886115074, -0.012270023114979267, -0.003710842924192548, -0.013426165096461773, -0.021345116198062897, -0.011517909355461597, -0.007141973823308945, -0.013090510852634907, 0.026752877980470657, -0.004149057902395725, 0.037294901907444, 0.009149682708084583, -0.014980119653046131, -0.0014234221307560802, 0.015837902203202248, 0.0311039499938488, 0.009516416117548943, 0.022625574842095375, -0.027026373893022537, 0.0024117371067404747, 0.010392846539616585, 0.03818998113274574, -0.0005361142102628946, 0.03416213020682335, 0.014085042290389538, 0.020474901422858238, -0.009497769176959991, 0.0057030124589800835, 0.02468922547996044, -0.010734716430306435, 0.008851324208080769, -0.00612879591062665, 0.020300859585404396, 0.006700650788843632, -0.054500285536050797, -0.0897066742181778, -0.04875687137246132, -0.021021893247961998, 0.0038755619898438454, -0.01387370377779007, 0.010523378849029541, -0.0013294079108163714, -0.06822481006383896, -0.005510321818292141, -0.004469172563403845, -0.03965691477060318, -0.05842868238687515, 0.013848841190338135, 0.019393349066376686, 0.027623092755675316, 0.007490059826523066, 0.03180012106895447, -0.006212709471583366, -0.03142717108130455, 0.012866741977632046, -0.039085060358047485, -0.012904036790132523, 0.02928893081843853, 0.026504244655370712, -0.05917457863688469, 0.007608160376548767, -0.007452765014022589, -0.014942824840545654, -0.015290910378098488, 0.017814531922340393, 0.010927407070994377, -0.012226512655615807, -0.01346345990896225, 0.02355794794857502, -0.015576837584376335, -0.016931885853409767, -0.013587776571512222, -0.036996543407440186, 0.0025515928864479065, -0.004099331330507994, -0.02610643208026886, -0.005034811794757843, -0.012251376174390316, -0.003825835417956114, -0.009783696383237839, 0.017528604716062546, -0.06747891008853912, 0.002329377457499504, 0.010380415245890617, 0.015017414465546608, 0.03580310568213463, 0.021730497479438782, -0.004792395047843456, -0.048632554709911346, -0.013811546377837658, -0.031029360368847847, -0.02210344560444355, -0.027523638680577278, 0.003685979638248682, -0.024390866979956627, 0.01660866290330887, -0.049825992435216904, -0.002456801710650325, 0.040228769183158875, -0.03177525848150253, 0.029985101893544197, -0.026902057230472565, -0.024453025311231613, -0.012307317927479744, -0.021792655810713768, -0.011082801967859268, -0.038040801882743835, 0.006700650788843632, 0.019865751266479492, 0.040502265095710754, -0.014532580971717834, -0.03339137136936188, -0.00674416171386838, 0.02306068129837513, -0.02605670504271984, -0.003788540605455637, 0.015626564621925354, 0.021258095279335976, -0.0008826460689306259, -0.007278721779584885, -0.005746522918343544, -0.02814522013068199, -0.02391846477985382, -0.008217310532927513, -0.022861775010824203, -0.0241919606924057, 0.02665342390537262, -0.018398819491267204, 0.03187471255660057, -0.039358556270599365, 0.013401301577687263, 0.02819494716823101, 0.009373452514410019, 0.006694435141980648, 0.0014078826643526554, -0.04251619055867195, -0.014358538202941418, 0.004755100235342979, -0.07409254461526871, -0.006669572088867426, 0.035455022007226944, 0.032769788056612015, 0.00763923954218626, 0.016894591972231865, -0.02642965503036976, -0.0014793644659221172, 0.028766801580786705, -0.02018897421658039, -0.007309800945222378, -0.004506467375904322, -0.025882663205266, -0.026578834280371666, 0.004065144341439009, 0.010019897483289242, 0.010256098583340645, -0.0001284925965592265, -0.031054222956299782, -0.028319263830780983, -0.0251989234238863, -0.037319768220186234, 0.061412274837493896, 0.032173071056604385, 0.03950773552060127, -0.00743411760777235, -0.027523638680577278, -0.010336903855204582, 0.01321482751518488, 0.015203889459371567, -0.04930386319756508, -0.019356055185198784, -0.024614635854959488, -0.027250142768025398, -0.006663355976343155, 0.013289417140185833, 0.025932390242815018, 0.030731000006198883, 0.002118039643391967, -0.040502265095710754, -0.037817031145095825, -0.0011957678943872452, 0.012817014940083027, 0.019530097022652626, -0.00429823761805892, -0.002215938875451684, 0.015726016834378242, -0.03555447608232498, -0.007521138992160559, 0.013065648265182972, -0.05017407611012459, 0.031228266656398773, -0.05425165221095085, -0.031054222956299782, 0.023408768698573112, 0.023707127198576927, 0.000350416696164757, -0.02164347656071186, 0.022948797792196274, 0.002837520558387041, -0.01253108773380518, -0.015303341671824455, 0.03346595913171768, -0.021432137116789818, -0.012226512655615807, 0.027299869805574417, -0.01346345990896225, 0.06171063333749771, -0.010579320602118969, -0.028617622330784798, -0.00836648978292942, 0.011045507155358791, -0.011418456211686134, 0.03088017925620079, -0.021668339148163795, -0.0009339265525341034, -0.002178644062951207, 0.032993558794260025, 0.04512683302164078, -0.048185016959905624, -0.025360533967614174, 0.029090024530887604, 0.016558937728405, 0.008099209517240524, -0.012350829318165779, 0.02227748930454254, -0.006361889187246561, 0.015067140571773052, -0.01741671934723854, -0.021444570273160934, -0.01628544181585312, 0.005970292259007692, -0.027275005355477333, 0.009702891111373901, 0.007831930182874203, -0.006526608020067215, -0.03948287293314934, 0.017702648416161537, -0.004450525157153606, 0.02533567138016224, -0.004055820871144533, 0.03811538964509964, 0.01695675030350685, -0.06534066796302795, 0.0006806320161558688, 0.020897578448057175, -0.022662870585918427, -0.017578331753611565, -0.024888131767511368, -0.04835905879735947, 0.020089522004127502, -0.01609896682202816, 0.00558180408552289, 0.013177532702684402, 0.017727511003613472, 0.004898063838481903, 0.02532324008643627, 0.01923173852264881, 0.005665717646479607, -0.022849343717098236, -0.03533070534467697, 0.00946047343313694, 0.01696918159723282, 0.014545012265443802, -0.005960968788713217, 0.00443498557433486, 0.039955273270606995, -0.009671811945736408, 0.024204391986131668, 6.176968599902466e-05, 0.004416338168084621, 0.020661376416683197, -0.026355065405368805, -0.007614376023411751, -0.009093740954995155, -0.039632052183151245, -0.0172799713909626, -0.031029360368847847, 0.0013029907131567597, 0.01189085841178894, -0.010747147724032402, 0.007701397407799959, 0.01895824261009693, -0.006818751338869333, 0.008832676336169243, -0.01632273569703102, 0.023955760523676872, -0.03475885093212128, -0.007098463363945484, 0.004562410060316324, 0.0079562459141016, -0.005264797247946262, -0.02869221195578575, -0.005519645754247904, -0.023545516654849052, -0.006364997010678053, -0.026255611330270767, -0.011729246936738491, -0.004329316783696413, -0.02560916729271412, -0.021171074360609055, 0.009224273264408112, -0.0013255230151116848, -0.019032832235097885, -0.006862262263894081, 0.013799114152789116, 0.001356602064333856, -0.09980116039514542, -0.03841375187039375, 0.03088017925620079, -0.011524125002324581, 0.014893097802996635, -0.02573348395526409, 0.0193311907351017, 0.0020962844137102365, 0.025111902505159378, -0.03734463080763817, -0.004090007860213518, -0.03028346225619316, 0.01723024621605873, 0.008329194970428944, 0.028940845280885696, -0.05226259306073189, -0.0228244811296463, 0.004301345441490412, 0.02610643208026886, -0.013649934902787209, -0.005215070676058531, -0.008745654486119747, 0.030954770743846893, 0.0054326243698596954, -0.005006840918213129, 0.008901050314307213, -0.007023873273283243, -0.014706623740494251, -0.02301095612347126, 0.015203889459371567, -0.029139751568436623, -0.009802344255149364, -0.014507717452943325, 0.040825486183166504, -0.030780727043747902, 0.030134281143546104, -0.017031339928507805, 0.035082072019577026, 0.007688966114073992, -0.013227258808910847, -0.03806566447019577, -0.0406763069331646, 0.04930386319756508, -0.019256601110100746, 0.000973552349023521, 0.0035896345507353544, 0.029587289318442345, -0.023446062579751015, 0.03759326413273811, 0.03451021760702133, -0.004301345441490412, 0.001573378685861826, 0.013587776571512222, 0.03269520029425621, 0.019157148897647858, 0.014209358021616936, -0.02369469590485096, -0.01660866290330887, 0.0026743554044514894, 0.01148061454296112, 0.007266290485858917, 0.031029360368847847, 0.05079565942287445, 0.0013068756088614464, -0.024403298273682594, -0.000903624459169805, 0.02537296526134014, 0.04457984119653702, -0.013761819340288639, -0.04042767360806465, -0.012655403465032578, 0.004102439619600773, 0.002758268965408206, 0.011499261483550072, 0.0035678790882229805, -0.011636009439826012, 0.0323968380689621, 0.06404778361320496, 0.0020294643472880125, 0.016248146072030067, 0.05743415281176567, -0.05982102453708649, 0.011238197796046734, 0.016894591972231865, 0.007067384198307991, 0.0086399856954813, 0.018063165247440338, -0.026951784268021584, -0.009037798270583153, 0.060417745262384415, 0.0064085074700415134, 0.004453632980585098, 0.01442069560289383, 0.012767288833856583, 0.03620091825723648, 0.022861775010824203, 0.008453511632978916, 0.002680571284145117, 0.03851320222020149, 0.010716068558394909, 0.0241919606924057, 0.024888131767511368, -0.0001687011681497097, -0.05345602706074715, -0.0179637111723423, 0.003201145911589265, 0.027051236480474472, -0.01373695582151413, 0.013848841190338135, -0.003552339505404234, 0.034361038357019424, 0.010187724605202675, 0.02923920378088951, 0.02200399339199066, 0.03766785189509392, 0.014781213365495205, 0.0054978905245661736, -0.022265058010816574, 0.03906019404530525, -0.010044761002063751, 0.031029360368847847, 0.019157148897647858, -0.04005472734570503, -0.010921190492808819, -0.0029882541857659817, -0.018386388197541237, 0.009709106758236885, 0.036225784569978714, 0.005320739466696978, -0.013637502677738667, -0.010187724605202675, 0.022252624854445457, 0.02988564968109131, -0.0010302717564627528, -0.005171559751033783, 0.010237450711429119, 0.014370969496667385, 0.02856789529323578, -0.036772776395082474, 0.04271509498357773, -0.02087271399796009, -0.016534073278307915, 0.010529594495892525, -0.005395329557359219, -0.021121347323060036, 0.0031296638771891594, 0.0037388140335679054, -0.010324472561478615, -0.028866255655884743, 0.027299869805574417, -0.0028515062294900417, -0.00966559536755085, 0.016223283484578133, 0.04162111133337021, 0.02432870864868164, 0.046593766659498215, -0.02260071225464344, -0.011089017614722252, -0.002010816941037774, 0.03756839781999588, 0.03281951695680618, 0.0352809801697731, 0.02391846477985382, -0.00624068034812808, 0.013065648265182972, -6.779125396860763e-05, -0.020586786791682243, 0.004699158016592264, 0.003822727594524622, 0.02355794794857502, -0.017889121547341347, -0.014582307077944279, 0.05151669308543205, 0.043311815708875656, 0.006483097560703754, 0.009640732780098915, -0.010597968474030495, 0.02605670504271984, 0.02710096351802349, 0.04087521508336067, -0.008248389698565006, 0.011946801096200943, 0.0003247764543630183, 0.012033822014927864, -0.003539907978847623, 0.02769768238067627, 0.00464010750874877, 0.035629063844680786, 0.021457001566886902, 1.2346652511041611e-05, 0.020984599366784096, 0.016297873109579086, -0.01964198239147663, 0.0014265300706028938, -0.024937858805060387, -0.0017326590605080128, 0.03861265629529953, 0.025273513048887253, -0.04097466915845871, -0.02092244103550911, -0.03127799183130264, 0.06797617673873901, 0.007713829167187214, -0.0031918222084641457, -0.008360274136066437, 0.0338389091193676, 0.003717058803886175, -0.029214341193437576, -0.0269269198179245, 0.016260577365756035, 0.003797864308580756, -0.023073114454746246, -0.012537303380668163, 0.033863771706819534, -0.007943814620375633, 0.0031918222084641457, 0.011213334277272224, -0.016036808490753174, 0.01120711863040924, -0.0019859536550939083, -0.03483343869447708, -0.012630540877580643, -0.005389113444834948, -0.012991057708859444, -0.012518655508756638, 0.03033318743109703, 0.0031358797568827868, 0.006274867337197065, -0.006980362813919783, 0.0009999695466831326, 0.002882585162296891, -0.015154162421822548, 0.006806320045143366, 0.029711605980992317, -0.0297364704310894, -0.013102943077683449, 0.004062036518007517, -0.0015990190440788865, -0.013513186946511269, -0.001752860494889319, 0.045276012271642685, -0.000802617403678596, 0.013301849365234375, 0.011200902983546257, -0.005609774962067604, -0.009131035767495632, 0.024900563061237335, 0.01856043003499508, 0.0014832493616268039, -0.03587769716978073, -0.0025422691833227873, 0.019455507397651672, 0.02687719464302063, -0.004590380936861038, 0.002239248249679804, 0.016360031440854073, 0.04475388303399086, 0.043958257883787155, 0.038364022970199585, 0.01854799874126911, 0.01246271375566721, 0.015079572796821594, -0.026181021705269814, -0.03533070534467697, 0.018771767616271973, -0.018361523747444153, -0.040775761008262634, -0.006849830504506826, -0.0025811181403696537, -0.007999756373465061, -0.018199913203716278, 0.03038291446864605, -0.012555951252579689, -0.00044481942313723266, -0.009808559902012348, 0.008410001173615456, -0.004506467375904322, -0.015726016834378242, 0.006361889187246561, -0.03602687641978264, -0.01987818442285061, -0.0317503958940506, -0.01883392594754696, 0.010914974845945835, -0.0014723717467859387, -0.009646948426961899, -0.03707113489508629, 0.009373452514410019, 0.022501258179545403, -0.006806320045143366, -0.0009331495384685695, -0.0028126572724431753, 0.007583296857774258, -0.009342373348772526, -0.011089017614722252, 0.013998020440340042, 0.007409254088997841, -0.0038879937492311, 0.024005485698580742, -0.04047740250825882, 0.012114628218114376, 0.0158751979470253, 0.024067644029855728, -0.00045997046981938183, 0.011350082233548164, 0.010455004870891571, -0.010349336080253124, -0.06240680441260338, -0.004978869576007128, 0.010280962102115154, -0.02846844308078289, 0.03582797199487686, 0.01148061454296112, 0.014370969496667385, 0.025882663205266, 0.006396076176315546, 0.008515669964253902, -0.040179044008255005, 0.01302835252135992, -0.021755360066890717, -0.02933865785598755, 0.03438590094447136, -0.0029214341193437576, -0.00194399687461555, -0.028717076405882835, -0.04196919873356819, 0.015750881284475327, -0.01719295047223568, 0.01189085841178894, 0.02628047578036785, -0.031004495918750763, 0.024142233654856682, -0.012562166899442673, 0.02273746021091938, -0.02670315094292164, -0.00459348876029253, -0.024639500305056572, 0.0044474173337221146, 0.007726260926574469, -0.014221790246665478, 0.04117357358336449, -0.007968678139150143, -0.039458006620407104, 0.0010465881787240505, -0.022501258179545403, 0.023669831454753876, -0.025758346542716026, -0.00848459079861641, -0.0065825507044792175, 0.0048887403681874275, 0.05952266603708267, -0.03503234684467316, -0.048732008785009384, 0.006688219495117664, 0.007247643079608679, 0.03393836319446564, -0.012357044965028763, 0.008192447014153004, -0.040278494358062744, -0.011766541749238968, -0.004736452829092741, 0.0035367999225854874, -0.009435610845685005, -0.007073599845170975, -0.004997516982257366, 0.004360395949333906, -0.03388863429427147, 0.02006465755403042, 0.024589773267507553, 0.02928893081843853, 0.010517163202166557, 0.03204875439405441, -0.017715079709887505, 0.014619601890444756, 0.01455744355916977, 0.02028842829167843, -0.007005225867033005, 0.015166593715548515, 0.010280962102115154, 0.015464953146874905, 0.005547617096453905, -0.047687750309705734, -0.010324472561478615, -0.007446548901498318, -0.0013589330483227968, 0.03309301286935806, -0.04246646165847778, 0.04216810315847397, -0.038811564445495605, 0.0001007156606647186, 0.019977636635303497, 0.016310304403305054, 0.011126312427222729, -0.0025811181403696537, -0.01969170942902565, 0.0038351593539118767, -0.014445559121668339, 0.01445799134671688, 0.015054709278047085, 0.0165962316095829, -0.02388116903603077, 7.366714999079704e-05, 0.023756854236125946, -0.011468183249235153, 0.02150672860443592, -0.013513186946511269, -0.007316017057746649, 0.05161614716053009, -0.004077576100826263, 0.017541036009788513, -0.03446049243211746, -0.0011483721900731325, -0.02642965503036976, 7.199178980954457e-06, -0.014184495434165001, -0.02337147295475006, -0.014942824840545654, 0.009721538051962852, -0.03142717108130455, 0.0014319688780233264, -0.013612640090286732, -0.018436113372445107, 0.019716572016477585, 0.0026075353380292654, -0.007197916507720947, 0.034137267619371414, -0.013475892134010792, 0.02550971321761608, 0.034584805369377136, 0.02333417721092701, -0.008546749129891396, 0.0020543276332318783, -0.02174292877316475, 0.019990067929029465, -0.00743411760777235, 0.004668078850954771, 0.02518649213016033, -0.034908030182123184, -0.02260071225464344, 0.03547988459467888, -0.0021553346887230873, 0.02628047578036785, 0.03503234684467316, 9.008078632177785e-05, 0.015017414465546608, -0.027797134593129158, -0.04970167577266693, -0.01805073395371437, 0.03888615220785141, -0.019853319972753525, -0.003757461439818144, -0.01291646808385849, -0.03033318743109703, -0.011729246936738491, -0.037170588970184326, 0.010964701883494854, -0.02506217546761036, 0.0012959978776052594, 0.02478867955505848, -0.01130035612732172, 0.006793888285756111, -0.017702648416161537, -0.01928146556019783, 0.021481864154338837, -0.00814272090792656, 0.020723534747958183, 0.0182869341224432, 0.05216313898563385, -0.025298375636339188, -0.021481864154338837, 0.04408257454633713, -0.01266783569008112, 0.02891598269343376, 0.027946313843131065, 0.00015325874846894294, -0.013426165096461773, -0.0028344127349555492, 0.0010357105638831854, 0.0018709610449150205, -0.015850333496928215, -0.022812049835920334, 0.027001509442925453, 0.02015168033540249, -0.026777740567922592, 0.02446545660495758, 0.03212334215641022, -0.006682003382593393, 0.004621460102498531, -0.016894591972231865, -0.016136260703206062, 0.0019315652316436172, 0.025882663205266, -0.004260942805558443, 0.03339137136936188, 0.03296869620680809, 0.007664102595299482, -0.0055662645027041435, 0.009435610845685005, 0.0032260091975331306, 0.009628300555050373, 0.006570118945091963, -0.00287015363574028, 0.007490059826523066, 0.0323968380689621, -0.008963208645582199, -0.023843875154852867, -0.00804948341101408, 0.002666585613042116, 0.022538553923368454, -0.01873447373509407, 0.02501244843006134, 0.0060697454027831554, 0.018112892284989357, 0.027299869805574417, 0.0622078999876976, -0.0387369729578495, -0.01695675030350685, 0.014830940403044224, 0.027051236480474472, -0.010498515330255032, 0.04597218334674835, 0.0251989234238863, 0.00852810125797987, -0.005311415996402502, -0.008273253217339516, 0.0061350115574896336, -0.003953259903937578, 0.009062661789357662, -0.019082559272646904, 0.018112892284989357, 0.009945307858288288, 0.010765795595943928, 0.020499765872955322, 0.00016161124221980572, -0.010616615414619446, -0.018622588366270065, -0.026255611330270767, 0.01773994229733944, -0.009106172248721123, 0.013562913052737713, -0.007129542529582977, -0.01387370377779007, 0.016496779397130013, 0.018883652985095978, 0.007514922879636288, 0.05271013081073761, -0.013960725627839565, 0.056638527661561966, 0.026777740567922592, 0.032720062881708145, 0.011287923902273178, -0.011810053139925003, -0.02210344560444355, -0.028990572318434715, -0.024912996217608452, 0.0006378982216119766, 0.020077088847756386, 0.018088027834892273, 0.022028855979442596, 0.006100824568420649, 0.016795137897133827, -0.01941821351647377, -0.029985101893544197, -0.011281708255410194, -0.008453511632978916, 0.0032539803069084883, 0.018112892284989357, 0.018025869503617287, -0.022302351891994476, -0.03257088363170624, 0.014843371696770191, 0.016770275309681892, 0.008148936554789543, 0.010597968474030495, 0.008428648114204407, 0.025882663205266, -0.011903289705514908, -9.95501977740787e-05, 0.0007571642636321485, 0.02697664685547352, 0.010970917530357838, -0.03224765881896019, 0.008335410617291927, -0.0032881672959774733, -0.0050596753135323524, 0.017454015091061592, 0.0025935496669262648, -0.014445559121668339, -0.018224775791168213, 0.02841871604323387, 0.0019875075668096542, 0.02292393334209919, 0.0029664987232536077, 0.0269269198179245, -0.009174546226859093, 0.049552496522665024, -0.0010248328326269984, 0.01688215881586075, -0.04179515689611435, 0.010989564470946789, 0.002624628832563758, 0.038811564445495605, -0.01709349825978279, -0.02064894512295723, -0.008888619020581245, -0.008534316904842854, 0.009771265089511871, -0.014259085059165955, 0.02114620991051197, 0.037444084882736206, -0.02365740016102791, -0.007241426967084408, -0.03127799183130264, 0.026355065405368805, -0.04510197043418884, 0.026802603155374527, -0.04651917517185211, 0.020089522004127502, -0.024080075323581696, -0.014159631915390491, -0.024614635854959488, -0.02095973491668701, -0.007987325079739094, -0.030258597806096077, 0.01184734795242548, 0.017155654728412628, -0.013774250634014606, 0.034137267619371414, -0.009709106758236885, -0.00617230636999011, 0.011474398896098137, -0.01182248443365097, -0.01161736249923706, -0.03060668334364891, 0.002863937756046653, -0.009833422489464283, -0.005031703971326351, -0.018224775791168213, 0.026678288355469704, -0.002591995755210519, -0.016036808490753174, 0.018137754872441292, -0.006371212657541037, -0.0032850594725459814, -0.010622831992805004, -0.023756854236125946, -0.019903047010302544, -0.02637992799282074, -0.023533083498477936, 0.024129802361130714, -0.011306571774184704, -0.01654650643467903, -0.0036580085288733244, 0.011791405268013477, 0.02918947860598564, 0.03115367516875267, -0.02802090346813202, 0.053605206310749054, 0.02150672860443592, 0.01946794055402279, -0.01919444277882576, 0.006526608020067215, -0.019903047010302544, 0.016658389940857887, -0.010629047639667988, 0.0036113897804170847, -0.013289417140185833, 0.003337893867865205, -0.015713585540652275, 0.03903533145785332, 0.015402794815599918, 0.009628300555050373, -0.018025869503617287, -0.017031339928507805, 0.0255594402551651, -0.03851320222020149, 0.03142717108130455, 0.03060668334364891, 0.0282943993806839, 0.018622588366270065, 0.034137267619371414, -0.002045003930106759, 0.03324219211935997, -0.0030037937685847282, -0.02891598269343376, 0.012674051336944103, 0.03883642703294754, 0.021519159898161888, 0.023085545748472214, -0.006806320045143366, -0.005538293160498142, 0.0148682352155447, -0.0401044525206089, -0.0010939838830381632, 0.0026821251958608627, 0.00012101419270038605, 0.006588766351342201, -0.00022765430912841111, -0.027672817930579185, -0.0006682003731839359, 0.04778720438480377, 0.04102439433336258, -0.009957739152014256, 8.726424857741222e-05, -0.009168330579996109, 0.012400555424392223, -0.01305321604013443, -0.008378922007977962, -0.027299869805574417, -0.013413733802735806, -0.03838888555765152, -0.0339135006070137, 0.025857800617814064, -0.002657261909916997, -0.037046272307634354, 0.012288670986890793, 0.004932250827550888, -0.01250622421503067, -0.022774754092097282, 0.011082801967859268, -0.012543519027531147, 0.03237197548151016, 0.02215317264199257, 0.03714572265744209, -0.042043786495923996, -0.006874694023281336, 5.9293070080457255e-05, -0.021817518398165703, 0.00939209945499897, 0.009628300555050373, -0.0030908151529729366, -0.048732008785009384, -0.00859647523611784, -0.014196926727890968, 0.011250629089772701, 0.00921184103935957, 0.00610393239185214, 0.029860785230994225, 0.007931382395327091]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
";
Dettmers, 2015; Dettmers & Zettlemoyer, 2023). In this
work our focus is on pruning , which we discuss next.
LLM Quantization. Recently several methods have been
proposed to perform post training quantization allowing
models to be quantized to a lower precision (Frantar et al.,
2022; Xiao et al., 2023; Dettmers & Zettlemoyer, 2023).
The goal of these methods is to perform quantization so as
to minimize the error, CHAI is orthogonal to quantization
based mechanisms as it depends on the insight of several
attention heads focusing on the same tokens. The goal
of quantization methods is to keep the same properties of
original models, therefore we believe CHAI can be used to
further accelerate post training quantized neural networks.
LLM Pruning. Pruning is a widely studied method to
improve inference time by removing unused weights post
training. Several prior works have looked at pruning for
language models (Chen et al., 2020b; Prasanna et al., 2020;
Chen et al., 2020a). For example, oBERT is a second order
method to reduce the number of weights (Kurtic et al., 2022).
Although these approaches can compress a model, they
rarely yield inference speedups due to lack of hardware sup-
port for sparse operations on modern GPUs. To overcome
the challenges, low rank decomposition methods (Wang
et al., 2023; 2021a; 2019), attention head pruning (Michel
et al., 2019; V oita et al., 2019), layer dropping (Sajjad et al.,
2023; Fan et al., 2019; Dai et al., 2023) were proposed.
However, these methods are infeasible for LLMs due to the
use of iterative gradient calculations or fine-tuning leading
to high resource requirements.
To overcome these issues, a recently proposed method,
DEJAVU(Liu et al., 2023b), identifies portions of the
model which are unused for a given context. To reduce
the overhead of self-attention, DEJAVUprunes attention
heads which give uniform weight across tokens . We plot the
activations for an exemplary sentence used by DEJAVUfor
both OPT -66B and LLAMA-7B in Figure 4. We observe
that while there are heads which give uniform weight to
each token in OPT -66B model, there are no such heads in
more parameter efficient models like LLAMA-7B, indicat-
ing that for smaller parameter efficient models like LLAMA
DEJAVUmight not be applicable. (Additional plots for dif-
ferent layers can be found in Appendix-A.) The primary
3
Runtime Clustered Head Attention for Efficient Inference
01234567891011
Token ID0 10203040506070Head IDLayer 21
0.00.20.40.60.81.0
(a)OPT -66B : For several heads the activation scores are uniform,
i.e., the heads given close to equal importance to each input token.
0123456789101112
Token ID036912151821242730Head IDLayer 21
0.20.40.60.8
(b)LLAMA-7B: Heads in LLAMA-7B specifically pay attention
to a specific token. However, multiple heads are attending to same
token, in this case the first token.
Figure 4. Activations for OPT -66B and LLAMA-7B for an ex-
emplary sentence: We observe that OPT -66B has several heads
which give uniform attention scores to tokens whereas LLAMA-
7B does not. However, both models have redundancies across
heads, i.e., groups of heads are give similar attention to each token.
difference between OPT and LLAMAactivation patterns
could be attributed to the fact that LLAMAmodels are
trained significantly longer and with more data.
We observe that CHAI ’s insight about redundancy in the
output of multiple heads in the attention holds across both
OPT andLLAMAfamily of models. In our evaluation
(Section 4), we perform quantitative comparison between
CHAI and D EJAVU.
K,V Cache Compression. Prior works which have tried to
reduce the K,V cache size (Liu et al., 2023a; Zhang et al.,
2023) by storing the K,V cache values for the most recent
important tokens. However, they can not directly improve
the latency of generating the next token, as they still perform
the full transformer compute before finally deciding which
","[0.013429899699985981, 0.0334022156894207, 0.025810804218053818, -0.019958514720201492, 0.008039996027946472, -0.001406136667355895, 0.005179414059966803, 0.05769473686814308, -0.03116620145738125, 0.024347731843590736, 0.006963395979255438, 0.00710142171010375, -0.04725999757647514, 0.051732029765844345, -0.008840545080602169, -0.051732029765844345, 0.03409234434366226, -0.036687228828668594, 0.020427802577614784, 0.03823311626911163, -0.04176657274365425, 0.007253250107169151, 0.02560376562178135, 0.050821058452129364, 0.05968230962753296, -0.017225606366991997, -0.004796392749994993, -0.01514141820371151, 0.03431318700313568, -0.040579553693532944, 0.039917029440402985, -0.03831592947244644, -0.027881188318133354, -0.015348456799983978, -0.012042741291224957, 0.029647918418049812, -0.007046211510896683, 0.014120028354227543, -0.031911540776491165, -0.007163533475250006, 0.004796392749994993, -0.024209706112742424, -0.06448560208082199, 0.017004765570163727, -0.001683913404121995, 0.01982048898935318, 0.044941164553165436, 0.008046898059546947, -0.035141341388225555, 0.054492540657520294, -0.04218064993619919, 0.052836235612630844, -0.04706675931811333, 0.012794981710612774, -0.009558279067277908, -0.015431271865963936, 0.0075431037694215775, 0.012063445523381233, 0.041159261018037796, -0.014271856285631657, 0.002537947380915284, -0.03878521919250488, 0.0013681796845048666, 0.02115933783352375, -0.04720478504896164, -0.04720478504896164, -0.04888869822025299, 0.011559651233255863, 0.03425797447562218, -0.014782551676034927, -0.013719753362238407, 0.037018489092588425, 0.04356090724468231, -0.0142028434202075, -0.01983429118990898, 0.013126242905855179, 0.007336065173149109, 0.03839874640107155, 0.030476072803139687, 0.011890913359820843, 0.041462916880846024, 0.00935124047100544, 0.05355396866798401, -0.04154573380947113, 0.013988903723657131, -0.05946146696805954, -0.024306323379278183, -0.010821213945746422, -0.05736347660422325, -0.015596902929246426, 0.0009023429593071342, 0.03966858237981796, -0.029923969879746437, 0.014382276684045792, 0.04541045054793358, 0.04778449237346649, 0.0205934327095747, -0.025866014882922173, 0.037128910422325134, 0.025203490629792213, 0.012843290343880653, 0.0189509280025959, 0.028115833178162575, -0.005548632703721523, 0.04974445700645447, -0.02426491677761078, -0.004924066364765167, -0.012988217175006866, -0.006821919698268175, -0.011048956774175167, -0.04474793002009392, 0.0044375257566571236, -0.07801211625337601, 0.014258054085075855, -0.01813657581806183, -0.04110404849052429, -0.07304319739341736, 0.01816418021917343, -0.011042054742574692, 0.011718381196260452, -0.012449917383491993, -0.005697010550647974, 0.05614884942770004, 0.0008031369652599096, 0.013029624707996845, -0.023864641785621643, 0.02338155172765255, -0.034672051668167114, -0.016659701243042946, -0.0261696707457304, 0.027149653062224388, 0.040275897830724716, 0.04096602275967598, -0.03682525455951691, -0.005917851347476244, -0.03583147004246712, -0.015458877198398113, 0.03574865311384201, -0.0557071678340435, -0.0014113127253949642, 0.03365066275000572, -0.017957141622900963, -0.006207705475389957, 0.015665914863348007, -0.020441604778170586, 0.028543712571263313, -0.02870934270322323, 0.031359437853097916, -0.027342889457941055, 0.05581758916378021, -0.031359437853097916, -0.05109710991382599, -0.029233841225504875, -0.028930185362696648, -0.05142837017774582, -0.02270522527396679, -0.018122773617506027, 0.019006136804819107, 0.031249016523361206, -0.06172508746385574, 0.011601058766245842, 0.00802619382739067, 0.019861897453665733, -0.031883932650089264, 0.005503774154931307, 0.005414057523012161, -0.05101429298520088, 0.0050275856629014015, -0.07061394304037094, -0.0746442899107933, -0.020993707701563835, -0.033567845821380615, -0.004703225567936897, -0.05432691052556038, -0.011152476072311401, -0.03185632824897766, -0.03878521919250488, 0.008205627091228962, 0.006173199042677879, -0.031138595193624496, -0.009268425405025482, 0.05302947014570236, 0.009489266201853752, 0.03823311626911163, -0.03006199561059475, -0.013795667327940464, -0.00024197628954425454, 0.01871628314256668, -0.0016640721587464213, 0.051704421639442444, -0.0029502990655601025, 0.03105578012764454, 0.08193204551935196, 0.03326418995857239, 0.02738429605960846, -0.0011473385384306312, 0.043367672711610794, 0.029123419895768166, 0.019240781664848328, -0.016756318509578705, 0.015251838602125645, 0.03820551186800003, 0.0025068914983421564, -0.06702527403831482, 0.04276035726070404, 0.0183850210160017, -0.0057625724002718925, -0.03392671421170235, -0.010324321687221527, -0.02662515453994274, 0.016218017786741257, -0.0037922558840364218, 0.029758337885141373, -0.00818492379039526, -0.024651387706398964, -0.005721164867281914, -0.04643184319138527, 0.012173865921795368, 0.011980629526078701, 0.011897814460098743, 0.030200021341443062, 0.007163533475250006, 0.04750844091176987, 0.045824527740478516, -0.06056567281484604, 0.008923361077904701, -0.011780492961406708, -0.027522321790456772, 0.03185632824897766, -0.019972316920757294, 0.02539672702550888, 0.0003743946726899594, -0.018688678741455078, -0.01386468019336462, -0.007063464727252722, -0.08436129987239838, 0.012760475277900696, -0.03204956650733948, 0.0228156466037035, -0.04220825433731079, -0.01816418021917343, -0.011318106204271317, -0.012891598977148533, -0.010828115046024323, 0.003435114398598671, 0.050600215792655945, -0.029565103352069855, -0.03519655019044876, 0.03861958906054497, 0.02661135233938694, 0.008433369919657707, -0.003909577615559101, -0.07177335768938065, -0.0334298200905323, -0.045824527740478516, 0.008385060355067253, 0.017736300826072693, 0.04599015787243843, -0.014396079815924168, 0.041214469820261, -0.027135850861668587, 0.023685207590460777, 0.011442329734563828, 0.030034389346837997, 0.0010809137020260096, -0.019792884588241577, -0.025355318561196327, 0.03381629288196564, -0.009289128705859184, -0.003674933919683099, -0.0005965298041701317, -0.021214548498392105, 0.015596902929246426, 0.011594157665967941, -0.009530673734843731, -0.017087580636143684, 0.02338155172765255, 0.00801929272711277, -0.0044375257566571236, 0.007342966739088297, -0.03944774344563484, 0.020538222044706345, 0.0712764635682106, 0.03362305834889412, -0.01174598652869463, -0.024554770439863205, 0.003172865603119135, -0.02136637642979622, -0.01660449057817459, -0.016742516309022903, 0.001832291018217802, -0.02673557586967945, 0.023754220455884933, -0.03972379490733147, 0.02448575757443905, 0.029371866956353188, 0.013188354671001434, -0.010655582882463932, 0.009033781476318836, -0.003140084445476532, 0.033567845821380615, 0.002781217684969306, -0.022180728614330292, -0.01893712393939495, -0.017888128757476807, 0.013961298391222954, 0.0018305657431483269, 0.006342280190438032, -0.013457505032420158, 0.02626628801226616, -0.0010791883105412126, -0.0015571023104712367, -0.009282227605581284, 0.006846074014902115, -0.04585213214159012, -0.05098668858408928, 0.014313263818621635, -0.005848838482052088, 0.04066236689686775, 0.01363693829625845, -0.027908794581890106, -0.044692717492580414, -0.034451212733983994, -0.002406822983175516, 0.015389864332973957, 0.014561709947884083, -0.0006543280323967338, 0.009434055536985397, -0.03196674957871437, -0.01118698250502348, 0.011987531557679176, 0.018302205950021744, -0.017681090161204338, -0.008371258154511452, -0.05167681723833084, 0.0011559651466086507, -0.051400765776634216, -0.004513440188020468, 0.027080640196800232, 0.012670758180320263, -0.0512351356446743, 0.005558984819799662, 0.00579362828284502, 0.04218064993619919, -0.02495504543185234, 0.022194530814886093, 0.01635604351758957, 0.003999294247478247, 0.048474621027708054, 0.006231859792023897, 0.006104186177253723, -0.032353222370147705, 0.02870934270322323, -0.05659053102135658, 0.017612077295780182, 0.03734975308179855, 0.004216684959828854, -0.035251762717962265, -0.014796353876590729, 0.018426429480314255, -0.017543064430356026, -0.01286399457603693, 0.030117206275463104, 0.004109715111553669, 0.01936500333249569, -0.012015135958790779, -0.007743241265416145, 0.03950295224785805, 0.023906050249934196, -0.0161490049213171, 0.013409195467829704, 0.006059327628463507, -0.016742516309022903, -0.024982649832963943, -0.055072251707315445, 0.0004546221171040088, 0.010393334552645683, 0.006207705475389957, 0.009641094133257866, 0.00879913754761219, -0.007232546340674162, 0.006808117032051086, -0.01714279130101204, -0.00047920792712830007, 0.026928812265396118, 0.03977900370955467, 0.0037059898022562265, -0.003578315954655409, -0.05413367599248886, 0.0030520930886268616, 0.0050275856629014015, 0.01080741174519062, -0.02672177366912365, 0.0356106273829937, 0.011124870739877224, 0.002406822983175516, 0.027342889457941055, 0.03508612886071205, 0.015279443934559822, 0.057197846472263336, 0.03141464665532112, 0.02227734588086605, -0.026928812265396118, -0.0020910892635583878, 0.027260074391961098, 0.010959239676594734, 0.004751534201204777, -0.012449917383491993, 0.020510617643594742, 0.012298088520765305, 0.06658359616994858, -0.019019940868020058, 0.020855681970715523, -0.0323256179690361, -0.011525144800543785, -0.021352574229240417, 0.0024258014746010303, 0.019516833126544952, 0.040910813957452774, 0.0601239912211895, -0.016452662646770477, -0.00919251050800085, -0.02336774952709675, -0.029703129082918167, -0.03621793910861015, 0.012581042014062405, 0.03417516127228737, -0.04074518382549286, 0.005555533803999424, -0.05957188829779625, -0.05377480760216713, 0.02583840861916542, 0.0031780414283275604, -0.0378742478787899, -0.035693444311618805, -0.03961337357759476, 0.002943397732451558, 0.037487778812646866, -0.006980649195611477, -0.04767407476902008, 0.005417508073151112, -0.040248289704322815, -0.011166278272867203, -0.019199373200535774, -0.06244282051920891, 0.017087580636143684, -0.029565103352069855, -0.023975063115358353, 0.0036852858029305935, -0.01892332173883915, -0.00107228709384799, -0.0028864622581750154, 0.07061394304037094, 0.04924756661057472, -0.006987550295889378, -0.06382308155298233, 0.10545162856578827, 0.009406451135873795, 0.019116558134555817, -4.2054703953908756e-05, 0.03627315163612366, -0.0119737284258008, -0.02427871897816658, 0.03439600020647049, -0.0006668366258963943, 0.02995157428085804, 0.03193914517760277, -0.00010594550258247182, 0.027522321790456772, 0.004723929334431887, 0.004996529780328274, -0.059516675770282745, -0.005835035815834999, -0.04033110663294792, -0.008806038647890091, -0.0014069994213059545, 0.04654226079583168, -0.04864025115966797, -0.0009532399126328528, -0.07646623253822327, 0.014934379607439041, -0.03262927383184433, 0.02906820923089981, 0.007839859463274479, 0.024582374840974808, 0.08789476007223129, 0.03483768552541733, 0.022912263870239258, 0.029095815494656563, 0.024347731843590736, -0.015734927728772163, -0.03282250836491585, 0.027549928054213524, -0.015734927728772163, 0.007977885194122791, -0.0005326928803697228, 0.00692888954654336, 0.017211804166436195, 0.0356382317841053, -0.010945437476038933, 0.03105578012764454, 0.011911616660654545, 0.041600942611694336, 0.012284286320209503, -0.011138672940433025, 0.018509244546294212, 0.01536225900053978, 0.028378082439303398, 0.02539672702550888, 0.010055171325802803, -0.005700461100786924, -0.009772218763828278, 0.013823272660374641, 0.025783197954297066, -0.02048301137983799, 0.03630075603723526, -0.007770846132189035, 0.02180805802345276, -0.006918537896126509, 0.038812823593616486, 0.0356658399105072, -0.002991706831380725, 0.011773590929806232, -0.02962031215429306, 0.02514827996492386, 0.006449250504374504, -0.030641702935099602, -0.12002713978290558, -0.04963403940200806, -0.020096540451049805, 0.04154573380947113, -0.03699088469147682, 0.019572041928768158, 0.006331928540021181, -0.05968230962753296, 0.0024585826322436333, -0.006925438996404409, -0.015776336193084717, -0.02426491677761078, 0.03726693615317345, 0.01904754526913166, 0.03210477530956268, -0.0025120675563812256, 0.030558887869119644, -0.0027898442931473255, -0.031580276787281036, 0.032021958380937576, -0.022180728614330292, -0.009882639162242413, 0.031028175726532936, 0.01351961586624384, -0.04530003294348717, -0.016010979190468788, -0.025645172223448753, -0.019779080525040627, 0.01269146241247654, -0.019434016197919846, 0.013429899699985981, -0.021656230092048645, -0.02782597951591015, 0.027480915188789368, 0.012325693853199482, 0.004130418878048658, -0.020068936049938202, -0.047839704900979996, 0.0032798354513943195, 0.029206234961748123, -0.006763258948922157, 0.003961337264627218, 0.01475494634360075, -0.019848093390464783, -0.027080640196800232, 0.023326341062784195, -0.025548554956912994, 0.01692194864153862, -0.0050103324465453625, 0.020234566181898117, 0.02539672702550888, 0.0037059898022562265, 0.003352298866957426, -0.04099363088607788, -0.01497578714042902, -0.025258701294660568, -0.018426429480314255, -0.03296053409576416, -0.0022032351698726416, 0.004544495604932308, 0.003599019953981042, -0.0657002255320549, 0.010206999257206917, 0.05325030907988548, -0.036355964839458466, 0.02383703738451004, 0.0057280659675598145, -0.04444427043199539, -0.0005430448218248785, -0.004692873451858759, -0.03475486859679222, -0.018992334604263306, -0.009496167302131653, 0.021711440756917, 0.04422343149781227, 0.01514141820371151, -0.0012189393164590001, -0.011117969639599323, 0.0423462800681591, -0.03643878176808357, 0.003844015533104539, 0.015072405338287354, 0.0041925301775336266, -0.001670110854320228, -0.004927516914904118, 0.010793608613312244, -0.013616234064102173, -0.020400196313858032, -0.004440976772457361, -0.0035886678379029036, -0.04822617396712303, 0.026017842814326286, -0.027135850861668587, 0.014216645620763302, -0.03097296506166458, -0.004057955462485552, 0.018909519538283348, -0.00014471130270976573, 0.006532065570354462, 0.00290889129973948, -0.04866785928606987, -0.012429213151335716, -0.007494795136153698, -0.06884721666574478, 0.007936476729810238, 0.005445113405585289, 0.030696913599967957, 0.008599000051617622, 0.0009765317663550377, -0.008529987186193466, -0.006846074014902115, 0.01213245838880539, -0.0178329199552536, -0.006159396376460791, 0.0038302128668874502, -0.009682501666247845, -0.03688046336174011, 0.004896461497992277, -0.010621076449751854, 0.004972375463694334, -0.0009247721172869205, -0.01971006765961647, -0.020676247775554657, -0.022870857268571854, -0.037570592015981674, 0.04298119992017746, 0.04521721601486206, 0.019558239728212357, -0.024016469717025757, -0.012463719584047794, 0.005051740445196629, 0.012781178578734398, 0.029316656291484833, -0.022691423073410988, -0.030200021341443062, -0.014630722813308239, -0.026459524407982826, 0.005700461100786924, 0.017556868493556976, 0.012263582088053226, 0.015472679398953915, -0.01781911589205265, -0.009282227605581284, -0.013402294367551804, 0.02629389427602291, 0.023519577458500862, 0.006887482013553381, 0.015845349058508873, -0.009751514531672001, -0.02407168038189411, -0.03511373698711395, -0.04463750869035721, 0.0034730713814496994, -0.050627823919057846, 0.019199373200535774, -0.05523788183927536, -0.020524419844150543, -0.0067253015004098415, 0.015955770388245583, 0.029427077621221542, 0.0004878345353063196, -0.003511028364300728, -0.005317439790815115, 0.007035859394818544, -0.014175238087773323, 0.027232468128204346, -0.02069004997611046, -0.011545849032700062, 0.037460170686244965, -0.010738398879766464, 0.0668596401810646, -0.021214548498392105, -0.040607158094644547, -0.016535477712750435, 0.007867463864386082, -0.013761160895228386, 0.014782551676034927, -0.02271902933716774, -0.004133869428187609, -0.004306401591747999, 0.027135850861668587, 0.02574179135262966, -0.029647918418049812, -0.012857092544436455, 0.008702519349753857, -0.011904715560376644, 0.010414037853479385, -0.02514827996492386, 0.020786669105291367, -0.004327105358242989, 0.01857825741171837, -0.011035153642296791, -0.02719106152653694, -0.03906127065420151, 0.02104891836643219, -0.03481007739901543, -0.010351927019655704, 0.032794903963804245, 0.001112832105718553, -0.03083493933081627, 0.008757730014622211, 0.0016726987669244409, 0.03605230897665024, -0.012725968845188618, 0.031911540776491165, 0.02349197305738926, -0.056756164878606796, -0.01180809736251831, 0.017198000103235245, -0.046376630663871765, 0.006042074412107468, -0.034451212733983994, -0.02117314003407955, 0.021752849221229553, -0.013112440705299377, 0.019075149670243263, 0.018785296007990837, 0.017736300826072693, 0.012725968845188618, 0.03265687823295593, 0.007722537498921156, -0.0006448387866839767, -0.01424425095319748, -0.03119380585849285, 0.013278070837259293, 0.01583154685795307, 0.027122048661112785, -0.002681148936972022, -0.020883286371827126, 0.034009531140327454, -0.015514087863266468, 0.012256680987775326, -0.009986158460378647, -0.0009679051581770182, 0.0015208706026896834, -0.011511342599987984, 0.027480915188789368, 0.00618010014295578, -0.02628009207546711, -0.02596263214945793, -0.03017241507768631, 0.01102135144174099, 0.004599706269800663, -0.043698932975530624, -0.003057268913835287, 0.009337438270449638, 0.011953025124967098, 0.036576807498931885, -0.03486528992652893, 0.04019308090209961, -0.04212544113397598, -0.02939947135746479, -0.0039026762824505568, 0.0034454662818461657, -0.01769489422440529, -0.03185632824897766, -0.018730085343122482, -0.0028347026091068983, -0.024872228503227234, -0.024113086983561516, -0.0064457994885742664, -0.0013017547316849232, -0.027135850861668587, -0.00020520537509582937, -0.006069679744541645, 0.009827429428696632, -0.00969630479812622, 0.0014346045209094882, 0.024113086983561516, 0.009482365101575851, -0.13206298649311066, -0.028681738302111626, 0.019861897453665733, 0.0019875699654221535, 0.020524419844150543, -0.009848132729530334, 0.006269816774874926, 0.019434016197919846, 0.04184938967227936, -0.014189041219651699, 0.001137849292717874, -0.020220763981342316, 0.00651826336979866, -0.03326418995857239, 0.019627252593636513, -0.07326403260231018, -0.021683836355805397, -0.010883325710892677, 0.02081427350640297, -0.020289776846766472, -0.013008921407163143, -0.009848132729530334, 0.019903304055333138, 0.024899834766983986, -0.014465092681348324, 0.008302245289087296, -0.004717027768492699, 0.004023449029773474, -0.003567964071407914, 0.02862652763724327, -0.02694261446595192, -0.017198000103235245, -0.017984747886657715, 0.0523393414914608, -0.029095815494656563, 0.012015135958790779, -0.023105500265955925, 0.013333281502127647, 0.0002034800563706085, -0.03834353759884834, -0.010234604589641094, -0.04979966953396797, 0.034230370074510574, -0.01135951466858387, 0.009392648003995419, -0.02451336197555065, 0.02683219313621521, -0.009413352236151695, 0.019779080525040627, 0.005924752913415432, 0.018550653010606766, 0.0008091756026260555, 0.006815018597990274, 0.028930185362696648, 0.010034468024969101, 0.003992393147200346, 0.013630037195980549, 0.004944770131260157, 0.023878443986177444, 0.01736363209784031, 0.020869484171271324, 0.02571418508887291, 0.006649387534707785, -0.013498912565410137, -0.05211849883198738, -0.007529301568865776, 0.00197549257427454, 0.0445546917617321, -0.015389864332973957, -0.04541045054793358, -0.024775611236691475, 0.03160788118839264, 0.005645250901579857, 0.022442977875471115, 0.02782597951591015, -0.0036438782699406147, 0.016342241317033768, 0.05200808122754097, -0.007156631909310818, 0.009509970434010029, 0.060510460287332535, -0.05424409732222557, 0.0261834729462862, 0.022304952144622803, 0.004296049475669861, 0.050379376858472824, 0.02226354368031025, -0.020427802577614784, -0.012967513874173164, 0.024195903912186623, 0.02973073348402977, 0.01552789006382227, -0.0008380747167393565, 0.019889501854777336, 0.02605924941599369, -0.000319184415275231, 0.007349867839366198, 0.012995118275284767, 0.03130422532558441, 0.015472679398953915, 0.043146830052137375, 0.020731458440423012, -0.001413900637999177, -0.06095214560627937, 0.006535516586154699, 0.00395098514854908, 0.00818492379039526, -0.01581774465739727, 0.0008648172370158136, -0.005434761289507151, 0.029896363615989685, 0.013926791958510876, 0.010738398879766464, 0.04375414177775383, -0.003909577615559101, 0.017460249364376068, 0.005220821592956781, -0.01403031125664711, 0.031000569462776184, -0.007080717943608761, 0.007377473171800375, 0.014258054085075855, -0.017059974372386932, -0.009668699465692043, -0.0037163416855037212, -0.018440231680870056, 0.006273267790675163, 0.02738429605960846, -0.00895786751061678, -0.01657688617706299, 0.005952357780188322, 0.0228156466037035, 0.018757691606879234, 0.029592707753181458, -0.006314675323665142, 0.005462366621941328, 0.022456780076026917, -0.001863346784375608, -0.00913039967417717, 0.030255230143666267, -0.00318666803650558, -0.01180809736251831, 0.043036408722400665, 0.01213245838880539, -0.007439584471285343, 0.008095206692814827, 0.0008902656845748425, -0.030476072803139687, -0.036355964839458466, 0.01592816412448883, 0.006459602154791355, -0.006204254925251007, 0.012877796776592731, 0.036355964839458466, 0.011497539468109608, 0.011828801594674587, 0.009896442294120789, -0.030890149995684624, 0.011842603795230389, 0.03643878176808357, 0.005003431346267462, 0.04207022860646248, -0.01141472440212965, 0.011124870739877224, 0.029868759214878082, 0.005942006129771471, -0.03489289432764053, -0.005955808330327272, -0.010565866716206074, 0.034451212733983994, -0.014285658486187458, -0.029261445626616478, 0.03530697152018547, 0.043505698442459106, 0.02216692641377449, 0.00748789357021451, -0.010538261383771896, -0.005738418083637953, 0.039917029440402985, 0.029206234961748123, -0.009323635138571262, 0.0032470542937517166, -0.019213175401091576, 0.004996529780328274, 0.024582374840974808, 0.05708742514252663, 0.036024704575538635, 0.013188354671001434, 0.022650016471743584, 0.0007807078072801232, 0.007170434575527906, 0.033457428216934204, -0.009344339370727539, -0.003467895556241274, -0.0068253702484071255, -0.002367140492424369, 0.023864641785621643, 0.0239474568516016, -0.02115933783352375, -0.014437487348914146, -0.020786669105291367, 0.0623324029147625, 0.0013975100591778755, -0.013326380401849747, -0.02380943112075329, 0.01080741174519062, -0.0007254975498653948, -0.010552063584327698, -6.448388012358919e-05, 0.013968199491500854, -0.008640408515930176, 0.008053799159824848, -0.03475486859679222, 0.022760435938835144, -0.006949593313038349, -0.007232546340674162, 0.0023188316263258457, -0.008343652822077274, -0.007570709101855755, -0.015790138393640518, -0.027591334655880928, -0.010013763792812824, -0.017059974372386932, 0.005313989240676165, -0.03215998411178589, -0.0003901382442563772, 0.020634841173887253, -0.003940633498132229, -0.0019892952404916286, 0.0016865014331415296, -0.028019214048981667, 0.005082795862108469, 0.005631448235362768, 0.020648643374443054, -0.050186142325401306, -0.013443701900541782, -0.019130360335111618, -0.005348495673388243, -0.010876424610614777, 0.0037853545509278774, 0.03961337357759476, 0.0036369769368320704, -0.007556906435638666, -0.0097377123311162, -0.01736363209784031, 0.0020910892635583878, 0.007363670505583286, 0.03516894578933716, -0.021683836355805397, -0.02103511430323124, 0.0036852858029305935, 3.062445102841593e-05, 0.03743256628513336, -0.005110401194542646, 0.01013108529150486, -0.004130418878048658, 0.04734281077980995, 0.06100735440850258, 0.042484305799007416, 0.024251112714409828, -0.026128262281417847, 0.022304952144622803, -0.003861268749460578, -0.024030271917581558, -0.012484423816204071, -0.01870248094201088, -0.02851610817015171, 0.013002020306885242, 0.01236020028591156, -0.004989628680050373, 0.00653896713629365, 0.044389061629772186, 0.00373014435172081, 0.017211804166436195, -0.0038888738490641117, 0.032242801040410995, 0.006131791044026613, -0.01772249862551689, 0.010621076449751854, -0.031249016523361206, -0.006473404821008444, -0.03519655019044876, -0.019226977601647377, 0.01936500333249569, -0.007446486037224531, -0.01569352112710476, -0.03627315163612366, -0.0027691402938216925, 0.024085482582449913, -0.01475494634360075, -0.0029830802232027054, 0.023906050249934196, 0.02037259191274643, 0.000543907459359616, 0.006035173311829567, -0.015900559723377228, 0.0017460249364376068, -0.007218743674457073, 0.03398192301392555, -0.0478949137032032, 0.024554770439863205, 0.018219390884041786, 0.028819764032959938, 0.013498912565410137, 0.014340869151055813, -0.0010507205734029412, 0.001627840450964868, -0.023450564593076706, -0.013699050061404705, -0.006921988446265459, -0.01971006765961647, 0.03779143467545509, 0.010434742085635662, 0.018757691606879234, -0.007639721967279911, -0.0034609942231327295, 0.0015967846848070621, -0.050600215792655945, 0.005572787020355463, -0.04825378209352493, -0.02049681544303894, 0.044361457228660583, -0.00525877857580781, -0.011870209127664566, -0.011690775863826275, -0.04643184319138527, 0.006973748095333576, -0.022304952144622803, -8.188535502995364e-06, 0.006449250504374504, 0.010614175349473953, -0.0013397118309512734, -0.002974453615024686, 0.03572104871273041, -0.03511373698711395, -0.0021877072285860777, -0.029703129082918167, -0.011814999394118786, -0.011552750132977962, -0.025990236550569534, 0.025465739890933037, 0.019999923184514046, -0.017653485760092735, -0.003238427685573697, -0.019006136804819107, 0.026431920006871223, -0.005013782996684313, -0.010828115046024323, 0.010752201080322266, -0.015969572588801384, 0.0656450167298317, -0.03933732211589813, -0.030614098533988, 0.0035541614051908255, -0.029427077621221542, 0.055513933300971985, -0.014823959209024906, 0.005503774154931307, -0.04723238945007324, -0.006721850950270891, -0.009330536238849163, 0.02204270288348198, 0.014258054085075855, 0.006204254925251007, -0.0025275954976677895, -0.017087580636143684, 0.013899186626076698, 0.02128356136381626, 0.00845407322049141, 0.00818492379039526, 0.010372630320489407, 0.010041369125247002, -0.01141472440212965, -0.003336770925670862, -0.004754985217005014, 0.03773622214794159, 0.0073153614066541195, 0.024209706112742424, 0.01120078470557928, 0.033567845821380615, 0.00033665329101495445, -0.02829526551067829, -0.02785358391702175, -0.018108969554305077, 0.010565866716206074, 0.023988865315914154, -0.00503793777897954, 0.029040604829788208, -0.018467837944626808, -0.004803293850272894, -0.0039302813820540905, 0.051621608436107635, 0.007977885194122791, -0.018205588683485985, -0.011338810436427593, -0.007957180961966515, -0.004009646363556385, 0.016107598319649696, 0.006083482410758734, 0.022111715748906136, -0.016866739839315414, -0.008709421381354332, 0.023119302466511726, -0.00545201450586319, -0.00046713068149983883, -0.021324969828128815, -0.018454033881425858, 0.029592707753181458, 0.0022774238605052233, 0.006073130294680595, -0.024913636967539787, -0.0004252916551195085, -0.022346358746290207, 0.01325046643614769, -0.003764650784432888, -0.047370415180921555, -0.00581433204934001, 0.003957886714488268, -0.030890149995684624, 0.014071718789637089, -0.01881290227174759, 0.000694441725499928, 0.019737673923373222, -0.013271169736981392, -0.02404407598078251, 0.022788042202591896, -0.012160062789916992, 0.026418117806315422, 0.038702402263879776, 0.037377357482910156, -0.0183712188154459, 0.0078053525649011135, -0.02150440216064453, 0.012215273454785347, 0.001118870684877038, 0.0008255661814473569, 0.03240843117237091, -0.030338047072291374, -0.027315283194184303, 0.03119380585849285, -0.006204254925251007, 0.006228409241884947, 0.017308421432971954, 0.003916478715837002, 0.006997902411967516, -0.024444349110126495, -0.021297363564372063, -0.013705951161682606, 0.016093796119093895, -0.016797726973891258, -0.029896363615989685, -0.002370591275393963, -0.007453387137502432, -0.01554169226437807, -0.023547181859612465, -0.00913039967417717, -0.05300186574459076, -0.004440976772457361, 0.020206961780786514, 0.006742554716765881, 0.00011397902562748641, -0.005797078832983971, 0.026362907141447067, 0.011117969639599323, -0.002914067357778549, 0.01659068837761879, -0.007080717943608761, 0.03732214495539665, -0.018081365153193474, -0.02138017863035202, 0.023795628920197487, 0.0025051662232726812, 0.03318137675523758, 0.019420213997364044, 0.01602478325366974, -0.012836389243602753, 0.0015847074100747705, 0.0035921186208724976, 0.00014481914695352316, 0.0012525831116363406, -0.03146985545754433, 0.00019129498105030507, 0.019668661057949066, 0.009896442294120789, -0.0011507892049849033, 0.025907421484589577, 0.002763964468613267, -0.00939954910427332, -0.022691423073410988, -0.01481015607714653, 0.004061406012624502, 0.015472679398953915, -0.006045524962246418, 0.009385746903717518, 0.015293246135115623, 0.01728081703186035, 0.000249740231083706, 0.012512029148638248, 0.004358161240816116, 0.008847447112202644, -0.005310538224875927, -0.0010938536142930388, 0.011269797571003437, 0.02848850190639496, 0.011594157665967941, -0.035362180322408676, -0.006642486434429884, -0.00020757770107593387, 0.01994471251964569, -0.005476169288158417, 0.02494124136865139, 0.00991714559495449, 0.021200746297836304, 0.035362180322408676, 0.06111777573823929, -0.028405686840415, -0.0478949137032032, -0.002832977334037423, 0.019958514720201492, -0.005441662855446339, 0.025631370022892952, 0.025189688429236412, 0.003436839673668146, -0.0018271150765940547, -0.0028536811005324125, -0.0003012841916643083, -0.01514141820371151, 0.01690814644098282, -0.03116620145738125, 0.020068936049938202, -0.005904048681259155, 0.014437487348914146, 0.012594844214618206, -0.0037681013345718384, -0.015638310462236404, -0.003511028364300728, 0.003709440352395177, 0.02349197305738926, -0.019061347469687462, 0.013174552470445633, 0.02472040057182312, -0.019019940868020058, 0.02383703738451004, 0.0033937066327780485, 0.020220763981342316, 0.032574061304330826, -0.0041649253107607365, 0.04093841835856438, 0.03721172735095024, 0.016425056383013725, -0.004720478784292936, -0.008143515326082706, -0.017556868493556976, -0.02092469483613968, 0.009799824096262455, 0.0018995784921571612, 0.027867386117577553, 0.0010507205734029412, 0.003417861182242632, -0.0062249586917459965, 0.0322704054415226, 0.011145574040710926, -0.007501696236431599, 0.03406473994255066, 0.01146303303539753, -0.008509283885359764, 0.022111715748906136, 0.00560039235278964, -0.03605230897665024, -0.055293090641498566, 0.01046234741806984, 0.02138017863035202, 0.041352495551109314, 0.013664543628692627, 0.01012418419122696, 0.0194892268627882, -0.020082738250494003, 0.013781865127384663, 0.006483756937086582, -0.0012905402109026909, -0.00857139565050602, -0.01936500333249569, -0.007777747698128223, -0.031442251056432724, -0.002129046246409416, 0.010524459183216095, 0.00011840015940833837, -0.0013517891056835651, 0.0002007842413149774, 0.029454682022333145, 0.006811567582190037, 0.01625942625105381, 0.0038336634170264006, 0.006570023018866777, -0.026928812265396118, 0.045134399086236954, 0.013892285525798798, 0.024333929643034935, -0.028681738302111626, -0.007736339699476957, -0.0037370454519987106, 0.03017241507768631, -0.019309794530272484, -0.025852210819721222, 0.001371630234643817, -0.013823272660374641, 0.006197353359311819, -0.0010817763395607471, 0.014603117480874062, 0.04195981100201607, -0.03966858237981796, -0.008274639956653118, -0.007377473171800375, 0.018909519538283348, -0.02793639898300171, 0.032353222370147705, -0.019875699654221535, 0.03585907444357872, -0.0345616340637207, -0.004019998013973236, -0.02126975916326046, 0.011787394061684608, 0.012166964821517467, -0.044057801365852356, 0.006721850950270891, 0.024968847632408142, -0.010434742085635662, 0.033457428216934204, -0.009551377967000008, 0.0018529949011281133, 0.03861958906054497, -0.00484815239906311, -0.007384374272078276, -0.009937849827110767, -0.010358828119933605, 0.02227734588086605, -0.005821233615279198, 0.0006431134534068406, 0.029151026159524918, 0.010558965615928173, 0.004454778973013163, 0.006021370645612478, 0.007888168096542358, -0.022208333015441895, -0.023961259052157402, 0.00802619382739067, -0.005952357780188322, 0.0016054112929850817, -0.021311165764927864, 0.022097913548350334, -0.024237310513854027, -0.01882670447230339, -0.00986193586140871, 0.020331183448433876, 0.027356691658496857, 0.04289838299155235, -0.010200098156929016, 0.05291904881596565, 0.018454033881425858, 0.022746633738279343, -0.010331222787499428, -0.003995843697339296, 0.0003271640161983669, 0.0097377123311162, -0.010835016146302223, 0.012298088520765305, -0.004375414457172155, 0.004233938176184893, 0.005386452656239271, 0.030338047072291374, -0.008599000051617622, -0.005455465521663427, -0.009620390832424164, -0.029206234961748123, 0.022746633738279343, -0.03955816105008125, 0.002439604140818119, 0.01624562405049801, 0.02316071093082428, 0.012546535581350327, 0.03296053409576416, -0.011318106204271317, 0.02695641666650772, 0.004906813148409128, -0.019779080525040627, 0.013719753362238407, 0.023464366793632507, 0.01102825254201889, 0.02273283153772354, -0.009965455159544945, -0.029095815494656563, 0.007056563161313534, -0.023547181859612465, -0.00875082891434431, 0.005207018926739693, 0.01124909333884716, -0.015514087863266468, 0.004823997616767883, -0.04408540576696396, -0.009668699465692043, 0.032132379710674286, 0.031883932650089264, 0.00656657200306654, 0.009834330528974533, -0.002679423661902547, 0.02683219313621521, 1.6147927453857847e-05, -0.009082090109586716, -0.022525792941451073, -0.02213932015001774, -0.046845920383930206, -0.011994432657957077, 0.02785358391702175, 0.018233193084597588, -0.00469977455213666, -0.006273267790675163, -0.04044152796268463, -0.009158004075288773, -0.012104853056371212, -0.020565828308463097, -0.003027938539162278, 0.03928210958838463, 0.017777709290385246, 0.018122773617506027, -0.008391961455345154, 0.0020876384805887938, -0.008668012917041779, -0.021518204361200333, 0.012677659280598164, -0.010414037853479385, 0.01581774465739727, -0.020910892635583878, 0.008398863486945629, -0.013050328940153122, -0.020400196313858032, 0.011787394061684608, -0.01791573502123356, 0.041214469820261, 0.011739084497094154]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"K,V pairs should be stored. On the other hand, CHAI
reduces not just the K,V cache size, it is also able to reduce
the latency of next word prediction.
Speculative Decoding. Speculative decoding (Leviathan
et al., 2023; Yang et al., 2023; Xia et al., 2023) is a popular
method where a draft model is used to cheaply generate a
sequence of draft tokens which can be efficiently verified
by a target LLM. Speculative decoding can significantly
reduce the latency of LLM serving, however it further exac-
New Model
Offline Cluster
Identification
Num Clusters
per layerNew Inference
Request
Cluster Membership
Identification
Inference with CHAI
Offline OnlineFigure 5. CHAI Flow: In the offline phase, we run clustering
and perform elbow plot analysis for each new model. Then, for
each new inference request we only perform cluster membership
identification based on online performance.
erbates the compute and memory requirements as it requires
additional resources to run both the draft and target model.
CHAI on the other hand is focused on reducing the resource
required for inference.
3. CHAI
Next, we describe CHAI . We first describe the key insights
which have been used to build CHAI . Then, we detail
CHAI ’s runtime pruning algorithm which is inspired by our
insights and discuss how we perform inference using CHAI .
Figure 5 provides a high level overview of inference using
CHAI, which includes offline and online components.
3.1. Observations
Our primary insight stems from the observation that there
is a high amount of correlation across the output of various
attention heads in MHA, i.e., the output of several attention
heads focuses on the same tokens. In Figure 6, we plot
the average correlation across the 32 heads of LLAMA-7B
for 1024 samples of the C4 (Raffel et al., 2020) dataset for
different layers and in Figure 7, we plot correlation for a
single sample of the dataset. These show us two insights
- (i) Several heads output similar attention scores for each
example and (ii) The amount of correlation increases in
later layers, with heads in later layers with having higher
correlation. This indicates that there is an opportunity to
cluster attention heads with similar output and only run the
self-attention operation for one of the representative atten-
tion heads within each cluster, thus reducing the amount of
computation as well as the size of K,V cache.
Problem Formulation. Next, we formally define the
problem of finding heads whose attention score is sim-
ilar. Let Hbe the total number of attention heads, let
S={⟨K1, Q1⟩,⟨K2, Q2⟩,⟨K3, Q3⟩,· · ·,⟨KH, VH⟩}be
the set of Q, K pairs associated with each head h. Our goal
is to find ksubsets, S1⊂S, S 2⊂S, S 3⊂S,· · ·Sk⊂S
such that < Q, K > pairs in each subset Siproduce sim-
ilar output under function f. Where function fis the self
attention operation, where f(Q, K ) =σ(QKT). Further,
4
Runtime Clustered Head Attention for Efficient Inference
024681012141618202224262830
Head ID024681012141618202224262830Head IDLayer 1
0.20.40.60.81.0
(a) Layer 1
024681012141618202224262830
Head ID024681012141618202224262830Head IDLayer 5
0.920.930.940.950.960.970.980.991.00 (b) Layer 5
024681012141618202224262830
Head ID024681012141618202224262830Head IDLayer 17
0.860.880.900.920.940.960.981.00 (c) Layer 17
024681012141618202224262830
Head ID024681012141618202224262830Head IDLayer 30
0.40.50.60.70.80.91.0 (d) Layer 30
Figure 6. Average Correlation for 1024 Samples of C4 on LLAMA-7B: The above figure shows two interesting observations. First,
there exists high amount of correlation across several heads of attention. Second, the correlation is not uniform across layers, with later
layers having higher correlation, i.e., , first","[0.02149461954832077, 0.027230124920606613, 0.03682086616754532, 0.018883882090449333, 0.0327356681227684, 0.003780834609642625, 0.02162989042699337, 0.0040885768830776215, -0.047994278371334076, 0.02965148352086544, 0.003183949738740921, -0.03005729615688324, -0.022049231454730034, 0.018613340333104134, -0.0319240428507328, -0.050834979861974716, 0.028921017423272133, -0.02511989139020443, 0.011044906452298164, 0.028650475665926933, -0.0726136714220047, -0.010077716782689095, 0.025322798639535904, 0.03362846001982689, 0.051051411777734756, -0.014636361971497536, 0.007886320352554321, -0.008867037482559681, 0.018965044990181923, -0.021264659240841866, 0.009922154247760773, -0.025931520387530327, -0.03030078485608101, -0.04293512925505638, -0.03278977796435356, 0.058166686445474625, -0.020940007641911507, 0.034927066415548325, -0.04967164620757103, 0.0034629469737410545, 0.010111534036695957, -0.0006826976896263659, -0.03311442956328392, 0.006124410778284073, -0.0005744805675931275, -0.023740123957395554, 0.030598381534218788, 0.009590739384293556, -0.008244789205491543, 0.06774389743804932, -0.05605645477771759, 0.037659548223018646, -0.05746327340602875, 0.01617845520377159, -0.020304230973124504, 0.02307729423046112, 0.031031250953674316, 0.045424122363328934, 0.02975969947874546, 0.012357039377093315, 0.03966156393289566, -0.02378070540726185, 0.0126816900447011, 0.018342796713113785, -0.02305024117231369, -0.01504217553883791, -0.04710149019956589, 0.006712841335684061, 0.029029235243797302, 0.009137580171227455, -0.009617794305086136, 0.04585699364542961, 0.027446558699011803, -0.012181186117231846, -0.025809776037931442, 0.013439210131764412, 0.0071152737364172935, 0.009840991348028183, 0.017585277557373047, 0.01964140124619007, 0.034521251916885376, 0.030706599354743958, 0.06390219181776047, -0.028893962502479553, 0.01383149717003107, -0.08381413668394089, -0.024700550362467766, -0.010537639260292053, -0.08603258430957794, -0.031004196032881737, -0.003329366445541382, 0.042015284299850464, -0.0203448124229908, -0.02154872752726078, 0.026391442865133286, 0.04528885334730148, 0.025715086609125137, -0.038173578679561615, 0.01336481049656868, 0.012187949381768703, 0.02272558957338333, 0.008001301437616348, 0.020006634294986725, -0.006303645670413971, 0.04645218700170517, -0.01228940300643444, -3.352721978444606e-05, 0.0049915132112801075, -0.012729035690426826, -0.0419611781835556, -0.048183660954236984, -0.008339479565620422, -0.0715314969420433, 0.010267096571624279, -0.01163333747535944, -0.031869933009147644, -0.04101427644491196, -0.010943453758955002, -0.020750626921653748, -0.0018447631737217307, -0.015772640705108643, -0.014217020012438297, 0.04607342556118965, 0.02997613325715065, -0.021318767219781876, -0.02203570492565632, 0.040797844529151917, -0.04658745601773262, -0.019100315868854523, -0.015826748684048653, 0.01950613036751747, 0.025593342259526253, 0.016408415511250496, -0.02149461954832077, -0.005241765175014734, -0.020196015015244484, -0.010929926298558712, 0.004707443527877331, -0.04074373468756676, -0.017679966986179352, -0.01054440252482891, -0.03922869637608528, 0.008785875514149666, -0.004795369692146778, -0.00227424968034029, 0.06325288861989975, -0.04967164620757103, 0.005539362318813801, -0.023848341777920723, 0.035305824130773544, -0.007013820111751556, -0.04022970423102379, -0.03208636865019798, -0.002585373818874359, -0.041203659027814865, -0.02957032062113285, -0.03027373179793358, -0.007825448177754879, 0.012187949381768703, -0.04569466784596443, 0.024267682805657387, 0.0025008292868733406, 0.007764576468616724, -0.013060450553894043, -0.0150557029992342, 0.019276170060038567, -0.04945521056652069, 0.008413879200816154, -0.08495041728019714, -0.07272188365459442, -0.03403427451848984, -0.028136443346738815, -0.010929926298558712, -0.035359933972358704, 0.004518063738942146, -0.018937990069389343, 0.0013332683593034744, -0.010084480047225952, -0.007859266363084316, -0.018369851633906364, 0.0005313628353178501, 0.04615458846092224, 0.026851365342736244, 0.044504277408123016, -0.06747335940599442, -0.010672910138964653, 0.025945046916604042, -0.0007989464793354273, 0.02114291489124298, 0.028244661167263985, -0.009895100258290768, 0.017652912065386772, 0.05719273164868355, 0.007318180985748768, 0.01862686686217785, -0.03663148358464241, 0.05272877588868141, 0.041663579642772675, -0.00040940725011751056, -0.0018735083285719156, 0.0211158599704504, 0.01137632131576538, 0.024619387462735176, -0.057842034846544266, 0.03265450894832611, 0.01223529502749443, 0.0005059994291514158, -0.009529867209494114, -0.03625272586941719, -0.008386824280023575, 0.03232985734939575, -0.02149461954832077, 0.05978994444012642, 0.02940799482166767, -0.031978148967027664, -0.010436185635626316, -0.0794854536652565, -0.014622834511101246, 0.0075954869389534, 0.0324651263654232, 0.0007000293117016554, 0.05578590929508209, 0.03395311161875725, 0.038065362721681595, -0.07553552836179733, 0.027094854041934013, 0.030977142974734306, -0.06633707880973816, 0.044558387249708176, -0.03544109687209129, 0.029164506122469902, 0.011903880164027214, -0.011775372549891472, -0.01631372608244419, -0.0006514161359518766, -0.07174792885780334, 0.03357435390353203, -0.010165642946958542, 0.015975547954440117, -0.047534357756376266, -0.02957032062113285, 0.0014330310514196754, 0.010368550196290016, 0.026824310421943665, 0.010307678021490574, 0.03362846001982689, -0.020723572000861168, -0.02597210183739662, 0.013479791581630707, 0.01819399744272232, 0.014690469950437546, -0.0038180341944098473, -0.07596839964389801, -0.0232396200299263, -0.061304982751607895, 0.008839983493089676, 0.017111826688051224, 0.01666543260216713, 0.0019969434943050146, 0.005180893000215292, -0.04066257178783417, 0.015677951276302338, -0.02664845809340477, -0.007859266363084316, -0.004233993589878082, -0.027013691142201424, -0.013040159828960896, 0.007602250669151545, -0.06006048619747162, -0.041609469801187515, -0.017382370308041573, 0.004200175870209932, 0.0433138906955719, -0.005637433845549822, -0.0262696985155344, -0.02152167446911335, -0.01160628255456686, 0.014636361971497536, -0.02664845809340477, -0.019059734418988228, -0.03614450991153717, 0.03224869444966316, 0.06704048812389374, 0.04902234300971031, 0.014162912033498287, -0.0150557029992342, 1.2410883755364921e-05, -0.03000318817794323, -0.041825905442237854, -0.0338178426027298, 0.015732059255242348, -0.03389900550246239, 0.02608031965792179, -0.010375313460826874, -0.010368550196290016, 0.027148962020874023, 0.004233993589878082, -0.0004425910010468215, 0.0021119241137057543, 0.01803167350590229, 0.01615140028297901, -0.0010745618492364883, -0.00028237898368388414, 0.017801711335778236, 0.011673918925225735, -0.011207232251763344, 0.004010796081274748, 0.03224869444966316, 0.019167952239513397, -0.00554274395108223, -0.016678959131240845, 0.006337463390082121, -0.010929926298558712, 0.016976555809378624, -0.02981380932033062, -0.02978675439953804, 0.05023978278040886, -0.031193576753139496, 0.03446714207530022, 0.005576562136411667, -0.04639807716012001, -0.050753816962242126, -0.01699008233845234, -0.0046127536334097385, 0.015799695625901222, 0.0038958152290433645, -0.012566709890961647, 0.00462966226041317, -0.010808181948959827, -0.024172993376851082, 0.03730784356594086, 0.006039866246283054, 0.011903880164027214, -0.007108510006219149, -0.024213574826717377, -0.02533632703125477, -0.06579598784446716, 0.0020087796729058027, 0.009218743070960045, 0.011477774940431118, -0.04033792018890381, 0.0012394238729029894, -0.03958040103316307, 0.03533288091421127, -0.012803434394299984, 0.012438202276825905, -0.0012977595906704664, -0.021426983177661896, 0.06065567955374718, -0.012181186117231846, -0.00376392574980855, -0.007419634144753218, 0.028596365824341774, -0.03663148358464241, -0.005400709342211485, 0.037740711122751236, -0.02678373083472252, -0.014352291822433472, 0.0009342178818769753, 0.022211557254195213, -0.04285396635532379, -0.0002971742651425302, 0.047426141798496246, -0.007798394188284874, 0.03909342363476753, -0.001471076044254005, -0.05051032826304436, 0.051051411777734756, 0.034521251916885376, -0.017517641186714172, -0.008231262676417828, 0.02114291489124298, -0.019032681360840797, -0.042502261698246, -0.05321575328707695, -0.009847755543887615, -0.0017551459604874253, 0.017517641186714172, -0.0028795890975743532, 0.030598381534218788, -0.014852795749902725, 0.0036726174876093864, 0.006242773495614529, -0.011315449140965939, 0.054162655025720596, 0.00902936328202486, -0.03571163862943649, 0.008055409416556358, -0.0816497951745987, 0.0010661074193194509, -0.013865314424037933, -0.008549150079488754, -0.017165936529636383, 0.023970086127519608, 0.0019834162667393684, 0.007581959944218397, 0.03292505070567131, 0.012958996929228306, 0.023713070899248123, 0.07564374804496765, 0.024091830477118492, -0.002761226613074541, -0.027351869270205498, 0.005792995914816856, 0.028406986966729164, 0.02463291585445404, -0.024159464985132217, 0.0029641338624060154, 0.02962442860007286, 0.0046837711706757545, 0.05654342845082283, -0.007196436636149883, 0.022198030725121498, -0.04867063835263252, -0.01849159598350525, 0.009333724156022072, -0.02978675439953804, 0.025092838332057, 0.013662408106029034, 0.05573180317878723, 0.0013298866106197238, -0.036712646484375, -0.03709140792489052, 0.03021962195634842, -0.04347621649503708, 0.013702989555895329, 0.055001337081193924, -0.024064775556325912, 0.02938093990087509, -0.06882607191801071, -0.06319878250360489, 0.05397327244281769, 0.0016613014740869403, -0.009847755543887615, -0.028596365824341774, -0.022400937974452972, 0.02919156104326248, 0.007473743055015802, -0.022603845223784447, -0.057733818888664246, 0.021859852597117424, -0.0401485413312912, -0.031518228352069855, -0.030354894697666168, -0.03749722242355347, 0.0229690782725811, -0.015894385054707527, -0.022576790302991867, 0.0007059474010020494, 0.0033564206678420305, -0.020655937492847443, -0.0007232790812849998, 0.01805872656404972, 0.061413198709487915, -0.009834228083491325, -0.057787925004959106, 0.09869398921728134, -0.009069944731891155, 0.01101785246282816, -0.051213737577199936, 0.03598218411207199, 0.002118687843903899, -0.03549520671367645, 0.03297915682196617, -0.02975969947874546, -0.007230254355818033, 0.03549520671367645, -0.011247813701629639, 0.041474200785160065, 0.003753780387341976, 0.006009430158883333, -0.04748024791479111, 0.015380353666841984, -0.030895980075001717, -0.010943453758955002, 0.001554775284603238, 0.03871466591954231, -0.05383800342679024, 0.0029455339536070824, -0.06936715543270111, -0.013439210131764412, -0.007649595383554697, 0.03292505070567131, 0.03903931379318237, 0.028542257845401764, 0.06850142031908035, 0.03368256986141205, 0.00471082516014576, 0.03595512732863426, 0.003882288234308362, -0.005268819630146027, -0.025728613138198853, 0.037903036922216415, -0.015272136777639389, -0.008785875514149666, 0.012045915238559246, -0.0036861447151750326, 0.007825448177754879, -0.006608006078749895, -0.02479524165391922, 0.03920163959264755, 0.017612330615520477, 0.038200631737709045, 0.010395604185760021, -0.037930089980363846, 0.0372537337243557, 0.022211557254195213, 0.00045949991908855736, -0.015921439975500107, 0.026905473321676254, 0.0025177381467074156, 0.03379078581929207, 0.024375898763537407, 0.03600923717021942, -0.021508146077394485, -0.0008175463299266994, 0.0021558874286711216, 0.0019918708130717278, -0.017450006678700447, 0.007717231288552284, -0.004829187877476215, -0.019100315868854523, -0.014379345811903477, 0.003359802532941103, 0.014162912033498287, 0.007676649838685989, -0.025566287338733673, -0.08873801678419113, -0.05245823413133621, -0.048264823853969574, 0.030625436455011368, -0.025485124439001083, 0.009523103944957256, 0.0025532469153404236, -0.061088547110557556, -0.0021372875198721886, -0.004748024977743626, -0.03760543838143349, -0.02457880601286888, 0.03343908116221428, 0.005820050369948149, 0.022590316832065582, 0.011227522976696491, 0.022103341296315193, 0.01859981194138527, -0.03287094086408615, 0.013128085993230343, -0.0151909738779068, 0.008988781832158566, 0.04585699364542961, 0.007588723674416542, -0.04950932040810585, 0.007744285743683577, -0.017964037135243416, -0.03955334797501564, -0.006121029146015644, -0.006401717197149992, 0.003425747388973832, -0.017531169578433037, -0.014054694212973118, 0.03884993493556976, 0.002732481574639678, -0.018667448312044144, -0.023686015978455544, -0.022712061181664467, 0.017855819314718246, 0.027595357969403267, -0.024091830477118492, 0.01674659550189972, 0.011903880164027214, -0.009556922130286694, -0.014068221673369408, 0.012979287654161453, -0.03557636961340904, 0.017395896837115288, -0.008826456032693386, -0.004250902682542801, 0.04547823220491409, 0.01709830015897751, -0.010158879682421684, -0.0404190830886364, -0.012079732492566109, -0.015434462577104568, -0.021183496341109276, -0.007088219281286001, -0.010226515121757984, 0.01800461858510971, 0.00413930369541049, -0.0427728034555912, -0.0019783435855060816, 0.03013845905661583, -0.016354307532310486, 0.04017559438943863, 0.008339479565620422, -0.013533899560570717, 0.0008606640622019768, 0.00493740476667881, -0.02045303024351597, -0.018018145114183426, -0.01685481145977974, 0.02645907923579216, 0.044910091906785965, -0.011166650801897049, -0.01961434818804264, -0.02002016268670559, 0.03311442956328392, -0.03365551680326462, 0.03387194871902466, 0.031599391251802444, -0.00011582610750338063, -0.013317465782165527, -0.009665139019489288, 0.0036387997679412365, -0.03728078678250313, -0.01983078196644783, 0.01251936424523592, -0.03398016467690468, -0.027757683768868446, 0.029245669022202492, -0.006577569991350174, -0.0002754040469881147, -0.024105357006192207, 0.0071490914560854435, 0.01682775840163231, -0.004108867608010769, 0.01482574176043272, 0.023821286857128143, -0.04637102410197258, -0.03719962388277054, -0.004460573196411133, -0.05040210857987404, 0.0024298117496073246, 0.011660391464829445, -3.4610445709404303e-06, 0.01009124331176281, 0.0032076220959424973, -0.027514195069670677, 0.0029455339536070824, 0.028596365824341774, 0.0007613241323269904, 0.0009950899984687567, 0.024430008605122566, -0.0319240428507328, -0.045045364648103714, 0.017828766256570816, 0.0034798558335751295, 0.01699008233845234, -0.02369954250752926, -0.01950613036751747, -0.031328849494457245, -0.019438493996858597, -0.038065362721681595, 0.025823302567005157, 0.00942165032029152, 0.022630898281931877, -0.04577583074569702, -0.009489285759627819, 0.007602250669151545, 0.016760122030973434, 0.0033970021177083254, -0.023388419300317764, -0.027121908962726593, -0.030895980075001717, -0.06092622131109238, -0.006411862559616566, -0.003659090492874384, 0.027460087090730667, 0.03260039910674095, -0.0035136735532432795, -0.0076090143993496895, -0.025349853560328484, 0.01644899696111679, 0.028325824066996574, 0.021751634776592255, -0.003459565108641982, -0.01650310680270195, -0.020953534170985222, -0.017652912065386772, -0.034602414816617966, 0.018532177433371544, -0.031464118510484695, 0.01674659550189972, -0.04699327051639557, -0.03592807427048683, 0.015299190767109394, 0.003723344299942255, 0.01931675150990486, -0.019154425710439682, 0.0032397492323070765, -0.008792638778686523, -0.009381068870425224, -0.01245172880589962, 0.017612330615520477, -0.004119012970477343, -0.007203199900686741, 0.03649621456861496, -0.02637791633605957, 0.05345924198627472, -0.00972601119428873, -0.061737850308418274, -0.01108548790216446, 0.00570168811827898, 0.005414236336946487, 0.0027392450720071793, -0.012796671129763126, -0.021995123475790024, -0.031031250953674316, 0.022617371752858162, 0.029110398143529892, -0.029353884980082512, -0.03703729808330536, 0.009820700623095036, -0.021697526797652245, 0.0330062136054039, -0.022373883053660393, 0.010517348535358906, 0.001084707211703062, -0.0006395798991434276, -0.007940429262816906, -0.031112413853406906, -0.02758183144032955, 0.007230254355818033, -0.041176602244377136, -0.0019039444159716368, 0.012674926780164242, 0.002311449497938156, -0.035305824130773544, 0.004085195250809193, -0.013635353185236454, 0.00032930122688412666, -0.001670601312071085, 0.028434040024876595, 0.01789640076458454, -0.03406132757663727, 0.0008327643154188991, 0.012350275181233883, -0.027757683768868446, 0.004379410296678543, -0.025295745581388474, -0.022184504196047783, 0.023686015978455544, -0.02670256793498993, 0.005042240023612976, 0.0060432483442127705, 0.007751049008220434, 0.017774656414985657, 0.025985628366470337, 0.020439503714442253, -0.0013002959312871099, -0.017328262329101562, -0.022739116102457047, 0.012269112281501293, 0.006895457860082388, 0.006361135747283697, 0.014392873272299767, -0.020764153450727463, 0.022685008123517036, -0.021372875198721886, 0.02367248944938183, 0.011910643428564072, 0.0039059605915099382, 0.02484934963285923, -0.005258674267679453, 0.0045417360961437225, 0.013303938321769238, -0.028758691623806953, -0.0004633044300135225, -0.016706014052033424, 0.03928280249238014, 0.028028227388858795, -0.03633388876914978, 0.0182210523635149, 0.028217606246471405, 0.006959711667150259, 0.03565753251314163, -0.011477774940431118, 0.030246676877141, -0.031896986067295074, -0.009374305605888367, -0.009996553882956505, 0.007602250669151545, -0.03557636961340904, -0.028488149866461754, -0.006800767965614796, -0.031842879951000214, 0.0003455760597717017, -0.009644848294556141, -0.026770202443003654, -0.0029793516732752323, -0.023009659722447395, -0.028109388425946236, 0.005015185568481684, -4.6288168960018083e-05, -0.038254741579294205, 0.0021254513412714005, 0.015637369826436043, -0.012255585752427578, -0.11243755370378494, -0.01974961906671524, 0.011856535449624062, 0.0030334603507071733, 0.013060450553894043, -0.0064592077396810055, 0.021129386499524117, 0.01230293046683073, 0.012133841402828693, -0.019817255437374115, -0.0012165968073531985, -0.008305661380290985, 0.01345950085669756, -0.008921146392822266, 0.005421000067144632, -0.06309056282043457, -0.01827516034245491, 0.006547133903950453, 0.013236302882432938, -0.0003831984067801386, -0.011234287172555923, -0.004389555659145117, 0.018478067591786385, 0.027392450720071793, -0.005951940082013607, -0.00550892623141408, -0.02313140220940113, -0.02342900075018406, 0.006215719040483236, 0.027527721598744392, -0.01816694438457489, -0.007575196214020252, 0.008217735216021538, 0.04090606048703194, -0.03346613422036171, -0.0013975222827866673, -0.027865901589393616, 0.025647450238466263, -0.004863005597144365, 0.00032951257890090346, -0.011673918925225735, -0.045234743505716324, 0.0359010212123394, 0.006222482770681381, 0.023929504677653313, -0.005728742107748985, 0.007845738902688026, 0.0037301077973097563, 0.01789640076458454, 0.02348310872912407, -0.0010796345304697752, -0.008927909657359123, 0.041420090943574905, 0.04266458749771118, 0.015245082788169384, 0.030652491375803947, -0.01862686686217785, -0.020223068073391914, 0.008204207755625248, 0.01615140028297901, -0.0010043898364529014, 0.03406132757663727, 0.044558387249708176, -0.003973596263676882, -0.008582968264818192, -0.014338764362037182, -0.0029708973597735167, 0.05299932137131691, -0.004119012970477343, -0.03560342267155647, -0.0005495399236679077, 0.00589783163741231, 0.010273859836161137, 0.01677364856004715, 0.01800461858510971, 0.004754788242280483, 0.0074669793248176575, 0.051971256732940674, -0.028352877125144005, 0.03387194871902466, 0.04296218603849411, -0.05051032826304436, 0.021859852597117424, 0.0151909738779068, -0.023117875680327415, 0.018924463540315628, 0.0435844324529171, -0.02616148255765438, -0.027676520869135857, 0.01966845616698265, 0.025376908481121063, -0.0012411148054525256, -0.007230254355818033, 0.0025633922778069973, 0.01974961906671524, 0.0047175888903439045, 0.001137124840170145, 0.00995597243309021, 0.06314466893672943, 0.006232628133147955, 0.055109553039073944, 0.01628667302429676, 0.03278977796435356, -0.04055435582995415, -0.0026462459936738014, -0.02302318625152111, 0.01088258158415556, -0.021589308977127075, 0.031842879951000214, -0.007866029627621174, 0.023713070899248123, 0.012850779108703136, -0.008860274218022823, 0.004764933604747057, -0.0052383835427463055, 0.012864306569099426, -0.007554905489087105, -0.010470003820955753, 0.028677528724074364, -0.018965044990181923, 0.01513686589896679, 0.01620551012456417, -0.014149384573101997, -0.04020264744758606, -0.017490588128566742, 0.015001594088971615, -0.006374663207679987, 0.030517220497131348, 0.0005389718571677804, -0.0017331643030047417, -0.025295745581388474, 0.014947486110031605, 0.023983612656593323, 0.014649888500571251, 0.014108803123235703, 0.007392580155283213, -0.0015260300133377314, -0.009184925816953182, -0.0014583943411707878, 0.04317861795425415, -0.011099015362560749, 0.006800767965614796, 0.045261796563863754, -0.010605274699628353, -0.016083765774965286, 0.013730043545365334, -0.005877540912479162, -0.008819692768156528, -0.019573766738176346, 0.045126527547836304, -0.0018751992611214519, -0.0034392743837088346, 0.013973532244563103, 0.028082335367798805, 0.005569798406213522, 0.031085358932614326, -0.006641823798418045, -0.016895392909646034, 0.014392873272299767, 0.03260039910674095, 0.009665139019489288, 0.048048388212919235, 0.02171105332672596, 0.01682775840163231, 0.02351016364991665, -0.002859298372641206, -0.027920009568333626, -0.00451468164101243, 0.010206224396824837, 0.034981176257133484, -0.030814817175269127, -0.0330062136054039, 0.03668559342622757, 0.05648932233452797, 0.01653015986084938, 0.02981380932033062, -0.007629305124282837, -0.010409131646156311, 0.0058234320022165775, 0.034602414816617966, -0.0301114059984684, 0.00744668859988451, -0.03230280056595802, 0.008380061015486717, 0.034494198858737946, 0.012674926780164242, 0.025877412408590317, 0.023009659722447395, 0.016029655933380127, -0.0011996879475191236, 0.019181478768587112, 0.03241102024912834, -0.032032258808612823, 0.005366891156882048, -0.01999310776591301, -0.023280201479792595, 0.016435470432043076, -0.0009113908163271844, -0.029137451201677322, 0.005674633663147688, -0.031410012394189835, 0.0491035059094429, 0.017598804086446762, -0.0027409358881413937, -0.0038078888319432735, 0.020304230973124504, -0.016678959131240845, -0.02108880504965782, 0.004233993589878082, -0.0002540565328672528, -0.014122330583631992, 0.012113550677895546, -0.03922869637608528, 0.026472605764865875, -0.0022370500955730677, 0.0004907814436592162, 0.022590316832065582, 0.007013820111751556, -0.003165349829941988, -0.018613340333104134, -0.02010132372379303, -0.014676942490041256, -0.03357435390353203, 0.0213864017277956, -0.027730628848075867, 0.005799759645015001, 0.009184925816953182, -0.009766592644155025, -0.014054694212973118, -0.011044906452298164, 0.018965044990181923, 0.015840277075767517, -0.003963450901210308, 0.005390563979744911, -0.03622567281126976, -0.0037977434694767, 0.0006945339264348149, -0.017544696107506752, 0.0009773356141522527, 0.008400351740419865, 0.037659548223018646, 0.013905895873904228, -0.0028643710538744926, 0.0022133777383714914, -0.0002051263436442241, -0.023807760328054428, 0.013344519771635532, 0.031518228352069855, 0.003533964278176427, -0.031653497368097305, -0.017964037135243416, 0.011707736179232597, 0.051619552075862885, -0.017625859007239342, -0.012904888018965721, 0.004988131579011679, 0.044720713049173355, 0.05876187980175018, 0.04434195160865784, 0.03341202810406685, -0.014947486110031605, 0.02973264642059803, -0.018153417855501175, -0.027690047398209572, 0.0209805890917778, -0.01846454106271267, -0.03922869637608528, 0.012877834029495716, -0.0006865021423436701, -0.0045045362785458565, -0.018505122512578964, 0.041176602244377136, 0.017463533207774162, 0.010733782313764095, -0.0052755833603441715, 0.0012622509384527802, 0.001213215058669448, -0.025214582681655884, 0.03303326666355133, -0.03652326762676239, 0.0031399864237755537, -0.015759114176034927, -0.023496635258197784, -0.0014989757910370827, -0.00037220760714262724, 0.006418626289814711, -0.03335791826248169, -0.006026339251548052, 0.015989074483513832, -0.02474113181233406, 0.011051670648157597, 0.008637076243758202, 0.028948072344064713, -0.008109518326818943, -0.02023659646511078, 0.0014093584613874555, 0.013013104908168316, 0.009360778145492077, 0.022563263773918152, -0.06000637635588646, 0.008407115004956722, 0.016516633331775665, 0.0303819477558136, -0.004859623499214649, 0.01786934770643711, 0.03922869637608528, -0.0012918415013700724, -0.03901226073503494, -0.02144051156938076, -0.011369558051228523, -0.008779111318290234, 0.017422951757907867, 0.038011252880096436, 0.0004975449992343783, 0.0025414107367396355, 0.002820407971739769, 0.0182210523635149, -0.026959583163261414, 0.007088219281286001, -0.03901226073503494, -0.015650896355509758, 0.03414249047636986, -0.005140312016010284, -0.0021964688785374165, -0.013222775422036648, -0.057733818888664246, -0.010219751857221127, -0.016300199553370476, -0.013973532244563103, 0.005887686274945736, -0.005241765175014734, 0.003770689247176051, 0.015177447348833084, 0.016273144632577896, -0.03890404477715492, -0.0011912334011867642, -0.030706599354743958, 0.006675641983747482, -0.0057253604754805565, -0.010612038895487785, 0.027527721598744392, 0.014365818351507187, -0.011369558051228523, -0.006564042996615171, 0.0003988391545135528, 0.016300199553370476, -0.009935681708157063, -0.018613340333104134, -0.009563685394823551, -0.03297915682196617, 0.07223490625619888, -0.005782850552350283, -0.027676520869135857, 0.001089779892936349, -0.0032989303581416607, 0.03579280152916908, -0.008643840439617634, 0.01080141868442297, -0.058707769960165024, -0.017436478286981583, 0.009753065183758736, -0.0024889931082725525, 0.03568458557128906, 0.013946477323770523, -0.008562677539885044, 0.01459578052163124, -0.0006252073217183352, 0.017328262329101562, 0.011241050437092781, 0.01054440252482891, 0.01070672832429409, -0.0041528306901454926, -0.014528144150972366, 0.00011487497977213934, 0.01644899696111679, 0.03254628926515579, -0.0011396611807867885, 0.02217097580432892, -0.006236009765416384, 0.04244815558195114, -0.005481871776282787, -0.04263753443956375, -0.0220627598464489, 0.005059149116277695, -0.005001658573746681, 0.014081749133765697, -0.04285396635532379, 0.031355902552604675, -0.018559230491518974, -0.017084773629903793, -0.0013780769659206271, 0.008650603704154491, 0.02106175199151039, 0.0015852112555876374, -0.026256171986460686, -0.013662408106029034, -0.0008725002990104258, 0.013486554846167564, 0.012309693731367588, -0.009651611559092999, -0.0213864017277956, 0.00826507993042469, 0.01222176756709814, -0.014690469950437546, 0.0162325631827116, -0.023861868306994438, 0.0010356713319197297, 0.04012148454785347, 0.015353299677371979, 0.012931942008435726, -0.030517220497131348, -0.031274739652872086, -0.04377381503582001, -0.023631907999515533, -0.022441519424319267, -0.035549312829971313, -0.0032701853197067976, 0.022563263773918152, -0.021237604320049286, 0.024619387462735176, -0.028948072344064713, -0.0035610187333077192, -0.00374025315977633, -0.004639807622879744, 0.009536631405353546, 0.015623842366039753, -0.025823302567005157, 0.028352877125144005, 0.010612038895487785, 0.01237056590616703, -0.002844080328941345, 0.007602250669151545, -0.022576790302991867, -0.002302994951605797, 0.007683413568884134, -0.0025600106455385685, 0.031112413853406906, -0.015218028798699379, -0.020412448793649673, 0.041663579642772675, -0.02938093990087509, 0.009475759230554104, 0.02288791537284851, 0.002284395042806864, 0.01179566327482462, -0.013554190285503864, -0.00679738586768508, -0.01830221526324749, 0.023983612656593323, -0.020655937492847443, -0.0041595944203436375, -0.02157578244805336, -0.0019428349332883954, -0.0327356681227684, -0.029299777001142502, -0.013101032003760338, -0.04255637153983116, -0.002789971884340048, 0.0021897051483392715, -0.009306670166552067, 0.0034494197461754084, 0.013107795268297195, 0.013500082306563854, 0.008725003339350224, -0.038173578679561615, 0.005150457378476858, 0.0099694998934865, 0.031572334468364716, -0.015989074483513832, -0.018072254955768585, 0.04409846290946007, -0.0036962900776416063, 0.014379345811903477, 0.008887328207492828, 0.0034088382963091135, -0.015069229528307915, -0.005488635506480932, -0.007176145911216736, -0.00020037070498801768, -0.020940007641911507, -0.027324816212058067, -0.0005457354127429426, 0.03446714207530022, -0.00554274395108223, 0.015475044026970863, 0.028866909444332123, -0.027595357969403267, -0.006547133903950453, -0.01707124523818493, -0.011856535449624062, 0.004146067425608635, 0.03955334797501564, -0.007960719987750053, -0.0066993143409490585, 0.020791208371520042, 0.014352291822433472, 0.015082756988704205, 0.021129386499524117, 0.016462525352835655, 0.0018887263722717762, 0.007351998705416918, -0.027541249990463257, 0.0026513186749070883, 0.026770202443003654, 0.003112932201474905, -0.010984034277498722, 0.007879557088017464, -0.007629305124282837, 0.022847333922982216, -0.013155139982700348, 0.031085358932614326, 0.0001811368128983304, 0.0032076220959424973, -0.00576932355761528, 0.060709789395332336, -0.003143368288874626, -0.058058470487594604, 0.0019360714359208941, 0.017422951757907867, 0.000867427617777139, 0.03649621456861496, 0.028406986966729164, 0.005299255717545748, -0.008339479565620422, -0.01002360787242651, -0.019654929637908936, -0.006844731047749519, 0.030246676877141, -0.028325824066996574, 0.038308851420879364, -0.003400383982807398, -0.011200468987226486, 0.01939791440963745, 0.013838260434567928, -0.004687152802944183, -0.010314441286027431, 0.019763145595788956, 0.014785160310566425, -0.014014113694429398, 0.011464248411357403, 0.020872371271252632, 0.00739934341982007, 0.00029062206158414483, -0.0035272007808089256, 0.0049204956740140915, 0.05267466977238655, 0.0020104707218706608, 0.04033792018890381, 0.022522682324051857, 0.008393588475883007, -0.009563685394823551, 0.002837316831573844, -0.01510981097817421, -0.06222482770681381, 0.017030663788318634, -0.008934673853218555, -0.008089227601885796, -0.014257601462304592, 0.02114291489124298, 0.0076698861084878445, 0.028163498267531395, 0.005481871776282787, -0.009820700623095036, 0.0017331643030047417, -0.014785160310566425, -0.0024788477458059788, 0.018315741792321205, -0.0010069261770695448, -0.005525835324078798, -0.03595512732863426, 0.027405979111790657, 0.012715508230030537, 0.035468149930238724, -0.02436237223446369, 0.011051670648157597, 0.02476818673312664, -0.009455468505620956, 0.002801808062940836, -0.011443957686424255, -0.009651611559092999, 0.006780477240681648, -0.028352877125144005, 0.018667448312044144, -0.025417489930987358, -0.0012056060368195176, -0.002450102474540472, -0.028325824066996574, 0.0018092545215040445, -0.004954313859343529, 0.016760122030973434, 0.0004288524796720594, 0.010436185635626316, 0.00927285198122263, -0.011755081824958324, -0.020439503714442253, 0.03595512732863426, -0.008995546028017998, 0.029164506122469902, -0.04572172090411186, -0.010307678021490574, -0.008339479565620422, 0.04734497889876366, -0.030706599354743958, -0.03306031972169876, -0.02141345664858818, -0.026283225044608116, 0.010260333307087421, 0.005505544599145651, 0.018924463540315628, 0.028948072344064713, -0.03370962291955948, 0.010030371136963367, -0.020940007641911507, -0.009326960891485214, -0.005681397393345833, 0.018478067591786385, -0.030598381534218788, 0.024916986003518105, -0.02975969947874546, -0.03690202906727791, -0.01832927018404007, 0.01383149717003107, 0.002762917662039399, -0.018288688734173775, 0.03400722146034241, 0.02962442860007286, -0.03365551680326462, 0.03392605856060982, -0.016949502751231194, -0.028028227388858795, 0.019046207889914513, -0.01685481145977974, 0.022103341296315193, -0.017314733937382698, 0.01466341596096754, 0.0040175593458116055, -0.0023892305325716734, 0.0022387411445379257, 0.029029235243797302, 0.005082821473479271, -0.0014355673920363188, 0.008752057328820229, -0.0052789649926126, -0.002223523100838065, -0.01830221526324749, 0.0031924042850732803, -0.007061165291815996, -0.016029655933380127, -0.014703997410833836, 0.0150557029992342, -0.006807531230151653, -0.008968491107225418, -0.005745651200413704, 0.0105579299852252, 0.029137451201677322, 0.0262696985155344, -0.0025633922778069973, 0.061737850308418274, 0.006026339251548052, 0.002421357436105609, -0.022874386981129646, -0.007886320352554321, 0.0037503985222429037, 0.005840341094881296, 0.014068221673369408, 0.00942165032029152, -0.00040200958028435707, -0.013243066146969795, 0.003400383982807398, 0.03365551680326462, -0.00607706606388092, -0.019086789339780807, -0.0018718175124377012, -0.026689039543271065, 0.041257765144109726, -0.024944039061665535, 0.01857275888323784, 0.040960170328617096, 0.02436237223446369, 0.01859981194138527, 0.026797257363796234, -0.017558222636580467, 0.031951095908880234, 0.008325952105224133, -0.005194420460611582, -0.015015121549367905, 0.003359802532941103, 0.010212987661361694, 0.02133229374885559, -0.004146067425608635, 0.004132539965212345, 0.00897525530308485, -0.04642513021826744, -0.03303326666355133, 0.012742562219500542, 0.023713070899248123, -0.014149384573101997, 0.005130166653543711, -0.026607876643538475, -0.0017027283320203424, 0.027365397661924362, 0.04564055800437927, 0.0016055019805207849, 0.0062123374082148075, 0.012512600980699062, 0.028704583644866943, 0.0013907586690038443, 0.005471726879477501, -0.03287094086408615, 0.002228595782071352, -0.023117875680327415, -0.017558222636580467, 0.02471407875418663, 0.005891067907214165, -0.020114852115511894, 0.008704712614417076, -0.03430481627583504, -0.015366827137768269, -0.020899426192045212, 0.0004102526872884482, -0.001067798351868987, 0.03308737650513649, 0.018883882090449333, 0.027013691142201424, -0.004491009283810854, -0.02367248944938183, -0.024646442383527756, -0.01792345568537712, 0.005045621655881405, -0.004896823316812515, 0.006523461546748877, -0.04918466880917549, -0.01661132276058197, -0.017936982214450836, -0.020196015015244484, 0.0019546712283045053, -0.008231262676417828, 0.005130166653543711, -0.004771697334945202]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
" layer has very little correlation but correlation increases in later layers.
036912151821242730
Head ID036912151821242730Head IDLayer 1
0.000.250.500.751.00
(a) Layer 1
036912151821242730
Head ID036912151821242730Head IDLayer 5
0.920.940.960.981.00
 (b) Layer 5
036912151821242730
Head ID036912151821242730Head IDLayer 17
0.920.940.960.981.00
 (c) Layer 17
036912151821242730
Head ID036912151821242730Head IDLayer 30
0.60.70.80.91.0
 (d) Layer 30
Figure 7. Correlation on a randomly selected single sample of LL AMA-7B.
0 5 10 15 20 25 30
Number of Clusters020406080Clustering Error
Layer 3
Layer 5
Layer 17
Layer 30
Figure 8. Clustering Error: We plot the clustering error on 1024
samples of C4-dataset. The markers represent the number of
clusters we choose for a layer.
we want ∪k
i=1Si=S.
Formally, we want to find Si,
∀< Kn, Qn>, < Km, Qm>∈Si,
s.t.
f(Kn, Qn)≈f(Km, Qm)
Informally, we want subset of heads, where within each
subset the self attention operation gives similar outcome.
In order to solve this problem we need to determine kwhich
represents the number of such subsets, and the membership
of such subset Si. Our observations empirically demonstrate
the existence of such a solution. We can potentially solve
this problem using clustering, where determining the num-
ber of subsets translates to determining number of clusters
and determining cluster membership becomes determination
of cluster membership.
0 1 3 5 7 9 11
Token ID for Membership Determination0.02.55.07.510.012.515.017.520.0 Avg Cluster Membership ChangesLayer 0
Layer 5
Layer 17
Layer 30Figure 9. Cluster Membership Evaluation: We evaluate the num-
ber of times the cluster membership changes for performing next
token prediction. We observed that if clustering is performed
beyond the fifth token the number of times cluster membership
changes is quite small.
To observe memory and compute savings, we need an accu-
rate and efficient method to determine the number of clusters
and their membership without having access to activations .
Solving this forms a core contribution of our work.
3.2. Determination of Number of Clusters
Challenges. Figure 6 and Figure 7 indicate that the num-
ber of clusters varies widely per layer in a LLM. Specif-
ically, the last few layers in the LLM exhibit a very low
number of clusters (high redundancy), whereas the early
layers demonstrate a high degree of variance across the out-
put of heads resulting in large number of clusters. This
observation suggests that the method used to determine
number of clusters needs to make decisions for each layer
independently. Additionally, widely used methods such as
Elbow plot method (Thorndike, 1953) for determining num-
5
Runtime Clustered Head Attention for Efficient Inference
MHA
MHA
MHA
MHAHead 1 Head 2 Head 3 Head 4 Head 5Head 1 Head 2 Head 3 Head 4 Head 5Head 1 Head 2 Head 3 Head 4 Head 5
MHALayer NNum Cluster
Identification
Num Cluster
Identification
Num Cluster
Identification
Layer 1Layer 2MHA
(a)Offline Cluster Identification: For each new
model we run an offline cluster identification
phase. We collect the activations and perform
Elbow-plot analysis to decide number of clus-
ters.
Head
1,2,3,4,5
Layer 1Layer 2Layer NCluster Member
Identification
Cluster Member
Identification
Cluster Member
IdentificationHead
2,4,5Head
1,3
Head
1,3,5Head 
4Head 
2MHA Head 1 Head 2 Head 3 Head 4 Head 5MHA Head 1 Head 2 Head 3 Head 4 Head 5MHA Head 1 Head 2 Head 3 Head 4 Head 5
MHAMHAMHA(b)Cluster Membership Identification: For
each new request, we initial run with multi-head
attention for first five","[0.00915202684700489, 0.01918286830186844, 0.03916216269135475, -0.0014340807683765888, 0.005084077827632427, -0.01317534875124693, 0.035317350178956985, 0.011019507423043251, -0.009646359831094742, 0.033202700316905975, 0.02430470660328865, -0.04157890006899834, -0.04097471758723259, -0.0037658566143363714, -0.038310810923576355, -0.023000217974185944, 0.02519725263118744, -0.022382300347089767, -0.015365518629550934, 0.022629467770457268, -0.04438012093305588, 0.019855709746479988, 0.023920226842164993, 0.016079554334282875, 0.052921097725629807, 0.008843068964779377, 0.015228203497827053, -0.02617218717932701, 0.03171970322728157, -0.004884971771389246, 0.03515256941318512, -0.03270836919546127, -0.03287314623594284, -0.010511443018913269, -0.02545815147459507, 0.04564341530203819, -0.017438970506191254, 0.04399564117193222, -0.051959894597530365, 0.0038036180194467306, 0.01274967286735773, -0.00045185128692537546, -0.013889385387301445, -0.0035221227444708347, 0.004895270336419344, -0.017933303490281105, 0.007765147835016251, 0.0067009590566158295, -0.0009140011970885098, 0.07662162184715271, -0.043171752244234085, 0.048938971012830734, -0.02867131493985653, 0.018194202333688736, -0.020720792934298515, 0.003964962903410196, 0.03443853557109833, 0.020459894090890884, 0.06541673839092255, -0.011211748234927654, 0.03416390344500542, -0.028094593435525894, 0.028506537899374962, 0.0031702539417892694, 0.014939842745661736, -0.022615736350417137, -0.04229293763637543, -0.03583914414048195, 0.022505884990096092, 0.01947122812271118, -0.01329206582158804, 0.023782910779118538, 0.02427724376320839, -0.01330579724162817, -0.04481952637434006, 0.041112031787633896, -0.010648757219314575, -0.0013439679751172662, -0.0015585222281515598, 0.023975152522325516, 0.05020226538181305, 0.01121861394494772, 0.06267044693231583, -0.02313753217458725, -0.0030192076228559017, -0.06657018512487411, -0.03303792327642441, -0.028753705322742462, -0.08041150867938995, -0.07255710661411285, -0.02128378301858902, 0.028836093842983246, -0.021434828639030457, -0.0017344567459076643, -0.005386170465499163, -0.013552963733673096, 0.030374018475413322, -0.04858195036649704, -0.006584241520613432, -0.0018812117632478476, 0.010895923711359501, 0.011156821623444557, -0.002701667370274663, -0.023439625278115273, 0.01550283282995224, -0.0477580651640892, -0.022533347830176353, 0.03323016315698624, -0.054953355342149734, 0.027229510247707367, -0.02960505522787571, -0.005121839698404074, -0.045945510268211365, 0.03452092409133911, -0.005132138263434172, -0.01503596268594265, -0.022780513390898705, 0.023933958262205124, -0.019841978326439857, 0.00830754078924656, -0.019979292526841164, -0.04006844013929367, 0.0481150820851326, -0.003985560033470392, -0.010889058001339436, -0.014445509761571884, 0.052921097725629807, -0.026666520163416862, -0.04789537936449051, -0.008335004560649395, 0.026968613266944885, 0.013628487475216389, 0.022766781970858574, -0.026913687586784363, -0.02059721015393734, -0.0025746512692421675, 0.01617567613720894, 0.018619878217577934, -0.0412493459880352, -0.001467551221139729, -0.006000653840601444, -0.03702004998922348, 0.00309644709341228, 0.02799847349524498, -0.010943983681499958, 0.06019877642393112, -0.03748692199587822, 0.01422580610960722, -0.025540539994835854, 0.04512162134051323, -0.004751089494675398, -0.04369354620575905, -0.03652571886777878, 0.005976623855531216, -0.048719268292188644, -0.05407454073429108, -0.03328509256243706, 0.00808783806860447, 0.007586638908833265, -0.026721445843577385, 0.018551219254732132, -0.02150348760187626, 0.0224646907299757, -0.0024459187407046556, -0.019045554101467133, 0.06673496216535568, -0.03864036500453949, -0.00375555781647563, -0.0689869225025177, -0.061681777238845825, -0.00854784157127142, -0.03408151492476463, -0.027366826310753822, -0.047538358718156815, -0.004970793146640062, -0.006416030693799257, -0.0266390573233366, -0.008472318761050701, -0.002711965935304761, -0.01809808239340782, 0.01623060181736946, 0.03564690425992012, 0.006113938521593809, 0.0355919785797596, -0.05882563069462776, -0.0039237686432898045, 0.019608544185757637, 0.006759317591786385, 0.019608544185757637, 0.020940495654940605, 0.020487358793616295, 0.023933958262205124, 0.04833478480577469, 0.01693090610206127, 0.025609197095036507, -0.021942894905805588, 0.06327462941408157, 0.04416041821241379, -0.004596610553562641, 0.003583914367482066, -0.0203775055706501, 0.005708859767764807, 0.03487794101238251, -0.04622013866901398, 0.02982475981116295, 0.03995858505368233, -0.0192103311419487, -0.002864728681743145, 0.022258717566728592, 0.015420444309711456, 0.026309503242373466, -0.058001741766929626, 0.06766869872808456, 0.005990355275571346, -0.039436791092157364, 0.011149955913424492, -0.10534786432981491, -0.03029162995517254, 0.018413905054330826, 0.030950739979743958, 0.015626415610313416, 0.047098953276872635, 0.02056974731385708, 0.043830860406160355, -0.06646032631397247, 0.0009878078708425164, 0.015132083557546139, -0.06689973920583725, 0.009557105600833893, -0.02177811600267887, 0.02132497727870941, 0.024030078202486038, 0.02063840441405773, -0.023645596578717232, -0.022327374666929245, -0.0337519608438015, 0.011143090203404427, -0.0222175233066082, 0.014802527613937855, -0.04281473159790039, -0.024002615362405777, 0.04050784558057785, 0.013717741705477238, 0.034795552492141724, -0.005403334740549326, 0.007270814850926399, -0.004854075610637665, -0.012241608463227749, 0.03496032953262329, 0.022739319130778313, 0.037816476076841354, 0.00240472424775362, -0.06646032631397247, -0.009660091251134872, -0.060528334230184555, 0.04264995455741882, 0.005135571118444204, 0.02891848236322403, 0.007607236038893461, 0.00733947241678834, -0.017535090446472168, 0.01053890585899353, -0.02867131493985653, 0.014445509761571884, -0.026954881846904755, -0.03303792327642441, -0.004370041191577911, 0.018702266737818718, -0.04303443804383278, -0.04665954411029816, -0.03496032953262329, -0.02431843802332878, 0.02635069750249386, 0.008815606124699116, -0.023453356698155403, -0.03394420072436333, -0.00011274826829321682, 0.009975914843380451, -0.030483869835734367, -0.0037109307013452053, -0.027174584567546844, 0.007950522936880589, 0.058001741766929626, 0.03281822055578232, 0.03125283122062683, 0.017452701926231384, -0.009042175486683846, -0.00751111563295126, -0.05113600566983223, -0.02175065316259861, 0.026666520163416862, -0.0574524849653244, 0.02965998277068138, -0.02199782058596611, -0.009460984729230404, 0.004387205466628075, -0.003139358013868332, -0.019938098266720772, -0.004562282003462315, 0.039217088371515274, 0.03820095956325531, -0.00996218342334032, -0.027641454711556435, -0.0031479401513934135, -0.003139358013868332, 0.03419136628508568, -0.0037727223243564367, 0.038310810923576355, 0.01504969410598278, -0.014102223329246044, -0.05135570839047432, -0.003649139078333974, -0.008211420848965645, 0.04330906644463539, -0.026007410138845444, -0.015598953701555729, 0.05849607661366463, -0.023961421102285385, 0.011850261129438877, 0.015241934917867184, -0.045039232820272446, -0.06783347576856613, -0.01970466412603855, -0.0008655118872411549, 0.03408151492476463, 0.007387532386928797, -0.010943983681499958, 0.004651536699384451, 0.010786072351038456, -0.035042718052864075, 0.03350479528307915, -0.005410200450569391, -0.011534437537193298, -0.01668374054133892, 0.0027943546883761883, -0.01756255328655243, -0.04119442030787468, 0.006869169417768717, 0.006810810882598162, 0.03405405208468437, -0.0273119006305933, -0.003226896282285452, -0.01422580610960722, 0.014308194629848003, -0.029000870883464813, -0.007147231604903936, 0.007909328676760197, -0.016326721757650375, 0.03053879551589489, -0.012646686285734177, -0.01785091497004032, -0.03520749881863594, -0.01802942343056202, -0.0374319963157177, -0.029989536851644516, 0.02617218717932701, 0.034850478172302246, -0.034630775451660156, 0.011506974697113037, 0.035509590059518814, -0.041331734508275986, 0.026295771822333336, 0.020679598674178123, -0.008987248875200748, 0.019787052646279335, 0.03270836919546127, -0.027641454711556435, 0.00858217105269432, -0.01807061769068241, -0.012818329967558384, -0.025169789791107178, -0.01688971184194088, 0.006477822549641132, -0.03765169903635979, -0.07173321396112442, -0.01624433323740959, 0.00016874693392310292, 0.026803836226463318, 0.020720792934298515, 0.039656493812799454, 0.010442784987390041, 0.008891128934919834, 0.02455187402665615, -0.011623691767454147, 0.04517654702067375, -0.00959143415093422, -0.01738404482603073, 0.011603094637393951, -0.10045945644378662, -0.017438970506191254, 0.008952920325100422, 0.0061002071015536785, -0.005719158332794905, 0.012275937013328075, -0.005389603320509195, -0.025513077154755592, 0.0040954118594527245, 0.016560155898332596, 0.04229293763637543, 0.04858195036649704, 0.011390256695449352, -0.00207688519731164, -0.02751787193119526, 0.00711290305480361, 0.0314176119863987, 0.024840235710144043, -0.023673059418797493, -0.012097427621483803, 0.030181778594851494, 0.010202484205365181, 0.033889275044202805, -0.008733216673135757, -0.00022506742971017957, -0.008746948093175888, -0.015324324369430542, 0.04281473159790039, -0.014898648485541344, 0.028080862015485764, 0.003146223723888397, 0.033889275044202805, -0.007366935256868601, -0.025622928515076637, -0.023727985098958015, 0.033669572323560715, -0.02172319032251835, -0.015241934917867184, 0.06865736842155457, -0.03630601614713669, 0.021201394498348236, -0.056573670357465744, -0.05261900648474693, 0.05212467163801193, 0.02982475981116295, 0.009907257743179798, -0.028561463579535484, -0.009632628411054611, 0.02198408916592598, 0.024812771007418633, -0.027682648971676826, -0.03589406982064247, 0.034108977764844894, -0.011857126839458942, -0.03402658924460411, -0.03872275352478027, -0.04333652928471565, 0.018867043778300285, -0.018894506618380547, -0.02798474207520485, -0.009035308845341206, 0.028341760858893394, -0.054980818182229996, -0.022821707651019096, 0.02360440231859684, 0.07244725525379181, -0.0129487793892622, -0.048472099006175995, 0.11100523173809052, -0.011726678349077702, 0.02891848236322403, -0.06854751706123352, 0.008767545223236084, -0.009646359831094742, -0.006982454098761082, 0.03770662471652031, -0.054541412740945816, 0.01573626883327961, 0.007854402996599674, -0.06684481352567673, 0.06953617930412292, -0.005118406377732754, 0.020885569974780083, -0.030593721196055412, 0.016985831782221794, -0.03515256941318512, 0.007394398096948862, 0.014198343269526958, 0.023892764002084732, -0.04534132406115532, 0.027668917551636696, -0.047538358718156815, -0.00103844259865582, -0.023055143654346466, 0.004380339756608009, 0.005114973522722721, 0.014047296717762947, 0.05805666744709015, 0.02131124585866928, 0.025993678718805313, 0.05206974595785141, 0.0059525934047997, -0.012124890461564064, -0.009811137802898884, 0.03128029406070709, -0.01640911027789116, -0.0025420389138162136, -0.018688535317778587, -0.019388839602470398, -0.026996076107025146, -0.0035495858173817396, -0.021173931658267975, 0.039903659373521805, -0.029797296971082687, 0.03353225812315941, 0.006045280955731869, -0.007586638908833265, 0.012069964781403542, 0.012234742753207684, -0.00878814235329628, -0.02803966775536537, 0.026227112859487534, 0.0029093557968735695, 0.06420836597681046, -0.004030187148600817, 0.02386530116200447, -0.021009154617786407, -0.005859906319528818, 0.03957410529255867, 0.0007642423151992261, -0.010834132321178913, 0.014527898281812668, -0.0045107887126505375, -0.00718156062066555, -0.02173692174255848, -0.0008650827803649008, 0.009145161136984825, -0.003146223723888397, -0.014926111325621605, -0.07090932875871658, -0.039244551211595535, 0.010305470786988735, 0.027943547815084457, -0.025815170258283615, 0.011857126839458942, 0.0069549912586808205, -0.057013075798749924, 0.009666956961154938, -0.002902490086853504, -0.039464253932237625, -0.05250915139913559, 0.027888622134923935, 0.0072776805609464645, 0.0374319963157177, -0.0033539123833179474, -0.0094815818592906, 0.011225479654967785, -0.02523844689130783, 0.01735658198595047, -0.0030621185433119535, 0.03468570113182068, 0.028314298018813133, 0.005561246536672115, -0.04028814285993576, 0.019979292526841164, -0.005739755928516388, -0.03858543932437897, -0.014170880429446697, -0.010278007946908474, 0.004661835264414549, 0.004057650454342365, -0.008595902472734451, 0.03957410529255867, 0.0007599511882290244, 0.0007209023460745811, -0.005139003973454237, -0.026007410138845444, 0.018812118098139763, 0.025293372571468353, -0.020734524354338646, 0.02659786306321621, -0.005914831999689341, -0.020089145749807358, -0.02061094157397747, 0.021352440118789673, -0.026721445843577385, -0.013161617331206799, -0.006398866418749094, 0.026721445843577385, 0.04352876916527748, 0.022080209106206894, -0.02567785419523716, -0.0452863983809948, -0.018180470913648605, -0.027380557730793953, -0.039464253932237625, -0.007119768764823675, -0.006817676592618227, -0.03075850009918213, 0.007449324242770672, -0.03306538611650467, 0.006793646141886711, 0.033202700316905975, -0.03674542158842087, 0.041771139949560165, 0.01824912801384926, -0.013388186693191528, -0.004589744843542576, 0.003518689889460802, -0.02063840441405773, 0.020487358793616295, 0.0031324923038482666, 0.016848517581820488, 0.03408151492476463, -0.007332606706768274, -0.01918286830186844, -0.0040130228735506535, 0.014102223329246044, -0.040645159780979156, 0.038503050804138184, 0.04053530842065811, 0.00984546635299921, -0.01642284169793129, -0.0075797731988132, 0.008822471834719181, -0.04740104451775551, -0.02523844689130783, 0.03916216269135475, -0.018166739493608475, -0.026323234662413597, 0.04031560570001602, -0.008211420848965645, 0.004400937352329493, -0.011046970263123512, 0.024194855242967606, 0.0020374073646962643, 0.00912456400692463, 0.03938186541199684, 0.010181887075304985, -0.027627723291516304, -0.039436791092157364, -0.006467523984611034, -0.06986573338508606, -0.003403688780963421, 0.020761987194418907, -0.01782345212996006, 0.003238911274820566, 0.023247383534908295, -0.032323889434337616, 0.020528553053736687, -0.0008140188874676824, -0.021105274558067322, 0.00335734523832798, 0.010374127887189388, -0.014486704021692276, -0.05028465390205383, 0.01065562292933464, 0.004243025090545416, 0.03306538611650467, -0.029550129547715187, -0.030621185898780823, -0.05283870920538902, -0.004212129395455122, -0.04885658249258995, 0.02777877077460289, 0.0044318330474197865, 0.01272221002727747, -0.04913121089339256, -0.02615845575928688, 0.023755447939038277, 0.013367588631808758, 0.003118760883808136, -0.036251090466976166, 0.002648457884788513, -0.01178846973925829, -0.04012336581945419, 0.0054994551464915276, 0.02033631131052971, 0.02449694834649563, 0.006718123331665993, -0.003745259251445532, 0.005077212117612362, -0.04330906644463539, 0.02987968549132347, 0.029275501146912575, 0.03468570113182068, -0.0023772611748427153, -0.009316804818809032, -0.03292807191610336, -0.013820727355778217, -0.050559282302856445, -0.005097809247672558, -0.0046755666844546795, 0.005561246536672115, -0.0541294664144516, -0.03097820281982422, -0.002614129101857543, 0.009248146787285805, 0.028836093842983246, -0.029110722243785858, 0.0053346771746873856, -0.0012753105256706476, 0.008451721630990505, -0.03721229359507561, 0.0173703134059906, -0.031060591340065002, -0.0051561682485044, 0.036910198628902435, -0.034795552492141724, 0.05558500438928604, -0.0048369113355875015, -0.042018309235572815, -0.02243722788989544, 0.021640801802277565, -0.01667000912129879, 0.026776373386383057, -0.01989690400660038, -0.0021026318427175283, -0.016724934801459312, 0.03383434936404228, 0.046165212988853455, -0.015832388773560524, -0.011184284463524818, -0.00683484086766839, -0.003470629919320345, 0.025293372571468353, -0.027133390307426453, 0.01283892709761858, 0.004105710424482822, -0.006151699926704168, -0.010229947045445442, -0.023082606494426727, -0.02317872643470764, 0.027847427874803543, -0.012536834925413132, 0.007765147835016251, 0.018578683957457542, 0.020418699830770493, -0.030895814299583435, -0.0073600695468485355, -0.009371730498969555, -0.012365191243588924, 0.010676220059394836, 0.0536351352930069, 0.020501090213656425, -0.02078945003449917, -0.009206952527165413, 0.025307105854153633, -0.01341564953327179, 0.008746948093175888, -0.04421534389257431, -0.026254575699567795, 0.03820095956325531, -0.03468570113182068, -0.00022142000671010464, -0.002636442892253399, 0.026693983003497124, 0.04561595246195793, 0.023741716518998146, 0.006999618373811245, 0.01064189150929451, -0.010477113537490368, -0.04237532615661621, 0.012083696201443672, 0.006625435780733824, 0.009296207688748837, 0.00020093006605748087, 0.008623365312814713, 0.024647993966937065, -0.014761333353817463, 0.044764600694179535, 0.014514166861772537, 0.024249780923128128, 0.02913818508386612, -0.006742153316736221, 0.00027055293321609497, -0.004201830830425024, -0.030428944155573845, -0.02707846462726593, 0.0019292719662189484, 0.013031167909502983, 0.020981691777706146, -0.02361813373863697, 0.007373800966888666, 0.026941150426864624, 0.013806995935738087, 0.02127005159854889, -0.019045554101467133, 0.043611157685518265, -0.022162597626447678, -0.025320837274193764, -7.080291106831282e-05, -0.007387532386928797, -0.025568002834916115, -0.019828246906399727, -0.007957388646900654, -0.02339843101799488, 0.00892545748502016, -0.027902353554964066, -0.014115954749286175, -0.004668700974434614, -0.04171621426939964, 0.015585222281515598, 0.009399193339049816, 0.018688535317778587, -0.03262598067522049, -0.0011714663123711944, 0.034630775451660156, -0.0053346771746873856, -0.11820051819086075, -0.02312380075454712, 0.015804925933480263, -0.0056127398274838924, 0.016010897234082222, -0.005128705408424139, 0.02497754991054535, 0.010257410816848278, 0.023920226842164993, -0.022753050550818443, -0.006841706577688456, -0.03745945915579796, 0.0004587170260492712, 0.013134153559803963, 0.011204881593585014, -0.05072406306862831, -0.0192103311419487, 0.024373365566134453, 0.007257083430886269, -0.008760679513216019, -0.034795552492141724, -0.029714908450841904, 0.031390149146318436, 0.02267066203057766, -0.026254575699567795, -0.027847427874803543, -0.03446599841117859, -0.03490540385246277, 0.023549476638436317, 0.014884917065501213, -0.02408500388264656, 0.005516619421541691, -0.012069964781403542, 0.033889275044202805, -0.01306549645960331, -0.007538578938692808, -0.03301046043634415, -0.001867480343207717, -0.022135134786367416, 0.00543423043563962, -0.014912379905581474, -0.020198997110128403, 0.01599716581404209, -0.012049367651343346, 0.0028355491813272238, -0.02571904845535755, 0.007270814850926399, -0.01783718355000019, -0.005468558985739946, 0.019855709746479988, -0.013621621765196323, -0.025622928515076637, 0.028973408043384552, 0.02845161221921444, -0.004634371958673, 0.011445182375609875, -0.03097820281982422, 0.002251961501315236, 0.020446162670850754, 0.004400937352329493, 0.006165431346744299, 0.019841978326439857, 0.02058347873389721, -0.011692349798977375, -0.024373365566134453, -0.01575000025331974, -0.006810810882598162, 0.05624411255121231, -0.0035221227444708347, -0.016010897234082222, -0.004922733176499605, -0.006817676592618227, 0.001380871282890439, 0.007373800966888666, 0.02268439345061779, 0.016079554334282875, 0.017892109230160713, 0.02869877964258194, -0.013484306633472443, 0.025554271414875984, 0.014404315501451492, -0.020693330094218254, 0.0014383718371391296, -0.0007831230759620667, -0.012289668433368206, 0.011149955913424492, 0.0444350466132164, -0.04992763698101044, -0.02427724376320839, 0.021929161623120308, 0.02059721015393734, 0.007449324242770672, -0.0028338327538222075, 0.032323889434337616, -0.0011431451421231031, -0.007675893604755402, -0.0014666930073872209, 0.014747601933777332, 0.06755884736776352, 0.006889766547828913, 0.027627723291516304, 0.015077157877385616, 0.025128595530986786, -0.022327374666929245, -0.01285265851765871, -0.02732563205063343, 0.020761987194418907, -0.006512151099741459, 0.04127680882811546, -0.002214200096204877, 0.025526808574795723, 0.021874235942959785, -0.0032680905424058437, 0.010291739366948605, -0.009955317713320255, 0.025540539994835854, 0.00671469047665596, -0.00972188264131546, 0.023714253678917885, -0.023274846374988556, 0.016299258917570114, 0.018688535317778587, -0.0016589335864409804, -0.014939842745661736, -0.02452441118657589, 0.0033796587958931923, -0.016285527497529984, 0.028753705322742462, 0.012420117855072021, -0.015791194513440132, -0.027133390307426453, 0.013964908197522163, 0.003666303353384137, 0.014994768425822258, 0.009818003512918949, -0.021860504522919655, 0.0046034762635827065, 0.013072362169623375, -0.03443853557109833, 0.030648648738861084, -0.009694419801235199, 0.005241990089416504, 0.05470618978142738, 0.007016782648861408, -0.025362031534314156, 0.0369376614689827, -0.014720139093697071, -0.0020786018576472998, -0.010710548609495163, 0.046192675828933716, 0.006776481866836548, -0.004143471829593182, 0.009715016931295395, 0.027641454711556435, -0.005468558985739946, 0.01158936321735382, 0.014184611849486828, -0.022396031767129898, 0.003920335788279772, 0.055914558470249176, 0.018194202333688736, 0.028836093842983246, 0.01894943229854107, 0.0026776371523737907, 0.03081342577934265, 0.0049398974515497684, -0.031609851866960526, -0.0023686790373176336, 0.0020923332776874304, 0.0337519608438015, -0.015447907149791718, -0.02063840441405773, 0.04146904870867729, 0.014843722805380821, 0.007840671576559544, 0.013635353185236454, 0.003144507296383381, -0.011513840407133102, -0.01042905356734991, 0.032516129314899445, -0.010195618495345116, 0.02477157674729824, -0.025265909731388092, 0.011582497507333755, 0.014472972601652145, 0.030236704275012016, 0.027133390307426453, 0.025732779875397682, 0.007840671576559544, 0.025609197095036507, 0.016711203381419182, 0.048499561846256256, -0.005073779262602329, 0.003556451527401805, 0.0009663524106144905, -0.034823015332221985, 0.025389494374394417, 0.02317872643470764, -0.018592415377497673, -0.009090235456824303, -0.020267654210329056, 0.03932693973183632, 0.003927201498299837, -0.001217809971421957, -0.012433849275112152, 0.016326721757650375, -0.00683484086766839, -0.0192103311419487, -0.026776373386383057, 0.02155841328203678, -0.028534000739455223, 0.019855709746479988, -0.04284219443798065, 0.012983107939362526, -0.023961421102285385, -0.002711965935304761, 0.024689188227057457, 0.017301656305789948, 0.04034306854009628, -0.011946382001042366, -0.024647993966937065, -0.0031771196518093348, -0.026103530079126358, 0.025046207010746002, 0.004143471829593182, 0.015818657353520393, 0.0022279315162450075, -0.0023171859793365, -0.01592850871384144, -0.0019996457267552614, 0.00904904119670391, 0.01618940755724907, -0.006333642173558474, 0.015255666337907314, -0.037157367914915085, -0.008980383165180683, -0.007840671576559544, -0.02640562318265438, -0.012186682783067226, 0.0027789068408310413, 0.028314298018813133, 0.00797798577696085, -0.019361376762390137, 0.008643962442874908, -0.009509044699370861, 0.00567453121766448, 0.0226431991904974, 0.002155841328203678, -0.003927201498299837, -0.027916084975004196, -0.004081680439412594, 0.010147558525204659, 0.04328160360455513, -0.022835439071059227, -0.01029860507696867, 0.0011783320223912597, 0.022602004930377007, 0.02941281534731388, 0.03913469985127449, 0.017658675089478493, 0.01086846087127924, 0.025375762954354286, -0.004963927436619997, -0.03454838693141937, 0.022821707651019096, -0.022039014846086502, -0.025622928515076637, -0.011506974697113037, -0.015104620717465878, -0.009982780553400517, -0.025732779875397682, 0.03770662471652031, -0.010504577308893204, -0.0024270378053188324, 0.007572907488793135, 0.004823179915547371, 0.014472972601652145, -0.03982127085328102, 0.026254575699567795, -0.037843938916921616, -0.00856843963265419, -0.02242349646985531, -0.014170880429446697, 0.008135898038744926, 0.024936355650424957, 0.00035122534609399736, -0.03004446253180504, -0.023068875074386597, 0.04536878690123558, -0.027957279235124588, 0.021929161623120308, 0.0034568982664495707, 0.025046207010746002, 0.009399193339049816, 0.005485723726451397, -0.005568112246692181, 0.027929816395044327, 0.0031651046592742205, 0.03671795874834061, -0.05036704242229462, 0.008980383165180683, -0.01317534875124693, 0.0350976437330246, -0.01166488602757454, 0.021228857338428497, 0.02777877077460289, 0.005286617204546928, -0.03539973869919777, -0.029467741027474403, -0.012989973649382591, -0.0046652681194245815, 0.021929161623120308, 0.028588926419615746, -0.00503601785749197, -0.01342938095331192, 0.028424149379134178, 0.024455754086375237, -0.04350130632519722, 0.0014692676486447453, -0.014761333353817463, -0.017768526449799538, 0.008080972358584404, -0.01596970297396183, 0.025609197095036507, 0.005468558985739946, -0.02339843101799488, -0.004332279786467552, -0.011500108987092972, -0.025815170258283615, 0.015461638569831848, -0.01665627770125866, -0.00018934413674287498, 0.024359634146094322, 0.020940495654940605, -0.03858543932437897, 0.002885325811803341, -0.015818657353520393, 0.009097101166844368, -0.009680688381195068, -0.024153660982847214, 0.029440278187394142, 0.04311682656407356, -0.027710111811757088, 0.02965998277068138, -0.011026373133063316, 0.02474411390721798, -0.020665867254137993, -0.008698888123035431, 0.01250937208533287, -0.0421006977558136, 0.07453443855047226, -0.013903116807341576, -0.031362686306238174, -0.012234742753207684, 0.003886006772518158, 0.017438970506191254, 0.016766129061579704, 0.004541684873402119, -0.04306190088391304, -0.017301656305789948, 0.008369333110749722, 0.00199106358923018, 0.0065258825197815895, 0.004260189365595579, 0.013800130225718021, 0.02453814260661602, -0.013230274431407452, 0.02172319032251835, 0.0021146468352526426, 0.037102438509464264, 0.024936355650424957, 0.0206246729940176, -0.019141674041748047, -0.005853040609508753, 0.011163687333464622, 0.017905840650200844, -0.007682759314775467, 0.028067130595445633, -0.014843722805380821, 0.020281385630369186, -0.02313753217458725, -0.04608282446861267, 0.0037761551793664694, 0.006234088912606239, -0.02523844689130783, -0.001456394325941801, -0.04462728649377823, 0.02614472433924675, -0.013491172343492508, -0.014033565297722816, 0.006340507883578539, 0.013010570779442787, 0.008602768182754517, 0.00014493140042759478, -0.04718134179711342, -0.003000326920300722, -0.010065170004963875, 0.013498038053512573, 0.0007981418748386204, -0.008245749399065971, -0.008795008063316345, -0.025073669850826263, 0.005887369159609079, -0.0017447553109377623, 0.026089798659086227, -0.013326394371688366, 0.00016831782704684883, 0.027723845094442368, 0.01342938095331192, -0.0030930142384022474, -0.01274967286735773, -0.0024510680232197046, -0.034603312611579895, 0.001877778908237815, -0.022135134786367416, -0.030181778594851494, -0.021695727482438087, 0.020528553053736687, -0.007009916938841343, 0.026542937383055687, -0.01923779398202896, -0.02033631131052971, 0.005386170465499163, -0.016038360074162483, -0.006601405795663595, 0.004699596669524908, -0.019539887085556984, 0.023673059418797493, 0.03556451573967934, 0.011287271045148373, -0.010483980178833008, -0.001331094652414322, -0.028506537899374962, 0.007408129516988993, -0.0003458614810369909, -0.02341216243803501, 0.034823015332221985, -0.013594157993793488, 0.00020371927530504763, 0.024002615362405777, -0.02658413164317608, 0.038036178797483444, 0.016546424478292465, 0.0030449542682617903, 0.0015241935616359115, -0.005114973522722721, -0.03814603388309479, -0.025087401270866394, 0.010792938061058521, -0.025842633098363876, -0.00011929216998396441, -0.025526808574795723, -0.01366968173533678, -0.015475369989871979, -0.038310810923576355, -0.018825849518179893, -0.03866782784461975, -0.004212129395455122, 0.002143826335668564, -0.005990355275571346, 0.01470640767365694, 0.0074630556628108025, 0.030374018475413322, 0.005712292622774839, -0.027476677671074867, 0.003486077766865492, 0.005973191000521183, 0.03886006772518158, -0.02199782058596611, -0.033697035163640976, 0.0374319963157177, -0.0049295988865196705, 0.026474280282855034, -0.003762423526495695, 0.005712292622774839, -0.01504969410598278, -0.004236159380525351, 0.002068303059786558, -0.017864646390080452, -0.020665867254137993, -0.023027680814266205, 0.025842633098363876, 0.023494550958275795, -0.008046642877161503, 0.024387096986174583, 0.026556668803095818, -0.009440387599170208, -0.018111813813447952, -0.016711203381419182, 0.012632954865694046, 0.01897689513862133, 0.030923277139663696, -0.028836093842983246, -0.017699869349598885, 0.020748255774378777, 0.05017480254173279, 0.0011680334573611617, 0.016766129061579704, -0.008369333110749722, 0.015283129177987576, 0.004600043408572674, -0.03235135227441788, -0.016258064657449722, 0.029989536851644516, -0.02017153427004814, -0.0173703134059906, 0.01086846087127924, 0.013834458775818348, 0.01259862631559372, -0.010456516407430172, 0.02081691287457943, 0.0027033837977796793, 0.0010135543998330832, 0.007984851486980915, 0.06613077223300934, 0.0033848080784082413, -0.030895814299583435, -0.002816668478772044, 0.017315387725830078, -0.010078901425004005, 0.02543068863451481, 0.013552963733673096, -0.0023806942626833916, -0.013147885911166668, -0.008094703778624535, -0.028588926419615746, -0.011987576261162758, 0.03767916187644005, -0.013340125791728497, 0.009563971310853958, -0.018880775198340416, -0.0023206190671771765, 0.020995423197746277, 0.025746511295437813, -0.010332933627068996, -0.01570880599319935, 0.011280405335128307, 0.01785091497004032, 0.002885325811803341, 0.033669572323560715, 0.0010058303596451879, -0.012907585129141808, -0.010106364265084267, -0.00949531327933073, 0.013992371037602425, 0.04053530842065811, -0.004651536699384451, 0.046604618430137634, 0.01710941456258297, -0.008211420848965645, 0.018798386678099632, -0.004438698757439852, -0.03147253766655922, -0.038503050804138184, 0.03336748108267784, 0.0026845030952244997, -0.0014263567281886935, 0.006591107230633497, 0.020981691777706146, -0.0002681928453966975, 0.02267066203057766, 0.005221392493695021, -0.013930579647421837, 0.0026295771822333336, 0.0029865955002605915, 0.019059285521507263, 0.014404315501451492, 0.0022159165237098932, -0.014871185645461082, -0.020720792934298515, -0.005537216551601887, 0.02337096631526947, 0.04100218042731285, -0.010449650697410107, -0.008293809369206429, 0.00984546635299921, 0.0049982559867203236, -0.006841706577688456, -0.011781604029238224, 0.0038894398603588343, 0.03301046043634415, -0.05470618978142738, 0.018372710794210434, -0.010943983681499958, 0.02015780285000801, 0.0133195286616683, -0.003734960686415434, -0.0040748147293925285, 0.014802527613937855, -0.0037109307013452053, 0.029522666707634926, 0.024853967130184174, 0.016807323321700096, 0.020665867254137993, 0.0007015924784354866, 0.023686790838837624, -0.004562282003462315, 0.02317872643470764, -0.04185352846980095, 0.006361105013638735, -0.0015791193582117558, 0.03685527294874191, -0.014761333353817463, -0.05739755928516388, 0.003916902933269739, -0.00214554276317358, 0.028534000739455223, -0.013649084605276585, 0.02776503935456276, 0.015475369989871979, -0.043830860406160355, 0.014253268949687481, 0.00641946354880929, 0.004452430177479982, 0.022794244810938835, 0.012756538577377796, -0.024936355650424957, 0.010772340930998325, -0.00834187027066946, -0.015200740657746792, -0.012681015767157078, 0.01871599815785885, 0.014733870513737202, -0.03372449800372124, 0.0060281166806817055, 0.016848517581820488, -0.030236704275012016, 0.000839336309581995, -0.0005707143573090434, -0.01621687039732933, 0.010669354349374771, -0.008870531804859638, 0.010504577308893204, -0.033175237476825714, 0.008348735980689526, 0.01940257102251053, 0.0005368147976696491, 0.01503596268594265, 0.013449978083372116, -0.014967305585741997, 0.011973844841122627, 0.010291739366948605, 0.009433521889150143, 0.002912788651883602, 0.003961530048400164, -0.020473625510931015, -0.012241608463227749, -0.047071490436792374, 0.006498419679701328, 0.012214145623147488, -0.03446599841117859, -0.004922733176499605, -0.033916737884283066, 0.01664254628121853, 0.01215921901166439, 0.022986486554145813, 0.005585276521742344, 0.05352528393268585, -6.647829650319181e-06, -0.008959786035120487, -0.004352876916527748, -0.00043511606054380536, -0.009097101166844368, 0.0005844458355568349, 0.00508751068264246, 0.0009989646496251225, -0.019965561106801033, -0.008966651745140553, 0.008259480819106102, 0.0389149934053421, -0.013360722921788692, -0.017644943669438362, -0.022986486554145813, 0.010161289945244789, 0.019622275605797768, -0.03542720153927803, 0.025320837274193764, 0.046851787716150284, 0.009866063483059406, 0.0015782611444592476, 0.03361464664340019, -0.011328465305268764, 0.02614472433924675, 0.005746621638536453, 0.008465453051030636, 0.014527898281812668, 0.018661072477698326, 0.026721445843577385, 0.022313643246889114, -0.016532693058252335, -0.008465453051030636, 0.009570837020874023, -0.03498779237270355, -0.022533347830176353, 0.011692349798977375, 0.015832388773560524, -0.04600043594837189, -0.021228857338428497, -0.009797406382858753, 0.017260462045669556, 0.02271185629069805, 0.02566412277519703, -0.009687554091215134, 0.00915202684700489, 0.01434938982129097, 0.021421097218990326, -0.018633609637618065, 0.009021577425301075, -0.03614123538136482, -0.016546424478292465, -0.02496381849050522, -0.0329006090760231, 0.026433086022734642, 0.0111087616533041, -0.014321926049888134, 0.010902789421379566, -0.02220379188656807, -0.022341106086969376, -0.01639537885785103, -0.0004900419735349715, -0.010820400901138783, 0.046165212988853455, 0.04034306854009628, 0.03144507482647896, -0.012605492025613785, -0.0094815818592906, -0.021695727482438087, -0.016120748594403267, 0.0014967306051403284, -0.012770269997417927, 0.0068623037077486515, -0.0462750643491745, -0.027421751990914345, -0.008376198820769787, 0.00026068344595842063, 0.013903116807341576, -0.0029042065143585205, 0.015283129177987576, 0.007847537286579609]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
" tokens. Using this we
determine the number of clusters in each layer.
Head 1
Layer 1Layer 2Layer N
Head 1
Head 1 Head 4 Head 2Head 2
CHACHACHA(c) CHAI Inference:
Post cluster membership
identification we substi-
tute MHA with Clus-
tered Head Attention.
Figure 10. Schematic of CHAI detailing three phases of the system.
ber of clusters entail manual effort making cluster number
determination impractical at inference time.
Design. To determine the number of clusters, we propose
an offline strategy we run once for each model. In our
case, we sample a small number of samples (1024) from
the C4 (Raffel et al., 2020) dataset and perform elbow-plot
analysis by plotting clustering error (i.e. sum of squared
distance from the closest cluster) as a function of number of
clusters. Figure 8 shows the clustering error for LLAMA-7B
for the samples selected. Based on the Elbow-plot analysis
we choose the number of clusters when the error plateaus.
The offline analysis is performed once for each network by
using the C4 (Raffel et al., 2020) dataset. We do not change
the number of clusters determined for a new dataset.
3.3. Determination of Cluster Membership
Challenges. Having determined number of clusters, we
need to determine the membership of these clusters, i.e.,
which heads belong to which cluster in each layer. For Fig-
ure 6, 7 and 8, we perform clustering based on activations
obtained by performing the forward pass. However, for
each decoding step, performing clustering on output of self
attention post forward pass will not yield any performance
benefit as we will still be performing the original compute
and using the full K,V cache. In order to utilize the insights
observed in Section 3.1, we will need to decide the cluster
members without having access to the output of the self
attention.
Design. A simple strategy would have been keeping the
cluster membership static across the tokens and independent
of input context, e.g., we use the same cluster membershipfound during offline analysis with C4 data in the previous
section. For evaluation purposes we call this version of head
selection CHAI-static.
However, we observed that the cluster membership does not
remain static and varies based on context. When compar-
ing Figure 7, which plots correlation for a single example,
with Figure 6, which plots correlation for 1024 samples,
we observe that the correlation across heads varies with
varying context. Therefore, the correlation across the out-
put of the heads depends on the context (input prompt),
i.e.,a solution to determine the membership of each cluster
has to account for context. To understand the effects of
accounting for context while clustering heads, we analysed
the change in cluster membership changes and clustering
with different context. In Figure 9, we observed an inter-
esting phenomenon, after determining cluster membership
by accounting for five tokens, the cluster membership does
not change frequently. A direct outcome of this observation
is that for each new sequence we can perform clustering
based on the output of self-attention after the first five to-
kens. We observe that activation from first five tokens of
a new sequence are enough to accurately predict the clus-
ter membership. This dynamic version of head selection
further allows us to improve accuracy over CHAI -static.
Figure 10b shows an illustration of the membership identi-
fication step. Furthermore, evaluation results in Section 4
compare CHAI-static and CHAI performance.
3.4. Clustered Head Attention
Once we have decided which heads have similar attention
output, we can than use Clustered Head Attention to com-
bine key and query vectors for the heads.
6
Runtime Clustered Head Attention for Efficient Inference
Table 1. Accuracy on OPT-66B
Method PIQA Hellaswag Arc-Challenge Arc-Easy Boolq
MHA 78.4 71.1 41.6 64.7 65.4
DejaVu-50% -0.25 -0.7 -0.6 -0.2 -4.0
CHAI-static -1.35 -1.7 -0.7 -0.7 -0.7
CHAI -0.15 0.1 0.1 -0.1 -0.6
3.5. Inference using CHAI
Next we, discuss the inference flow of CHAI , illustrated in
detail in Figure 10. For each new model we first perform
offline cluster identification (Figure","[0.03216557204723358, 0.008668415248394012, 0.03513907641172409, 0.0034583162050694227, 0.03606991469860077, -0.021771231666207314, 0.009314829483628273, 0.026386629790067673, -0.03420824185013771, 0.03619919717311859, 0.03601820021867752, -0.014285754412412643, -0.030433181673288345, 0.0023254752159118652, -0.02590828202664852, -0.044809434562921524, 0.022378860041499138, -0.03309641033411026, -0.012437010183930397, 0.018228881061077118, -0.05605704337358475, 0.020362049341201782, 0.043878600001335144, 0.019573424011468887, 0.03981911763548851, 0.01613449864089489, 0.013264420442283154, -0.032010432332754135, 0.007317409384995699, 0.004935372620820999, 0.009424719959497452, -0.033406686037778854, -0.026115134358406067, -0.025972923263907433, -0.01301231887191534, 0.043878600001335144, -0.042559914290905, 0.02221079356968403, -0.03105374053120613, -0.005817728117108345, 0.009773783385753632, 0.01543637178838253, -0.030097046867012978, 0.013742766343057156, -0.01040726900100708, -0.02385268546640873, 0.018384020775556564, 0.027821669355034828, -0.006376876495778561, 0.06676166504621506, -0.044887006282806396, 0.057039592415094376, -0.0392761304974556, 0.019366569817066193, -0.012159052304923534, 0.01295414101332426, 0.03837114945054054, 0.01701362244784832, 0.03555278480052948, 0.013329061679542065, 0.043361466377973557, -0.03844871744513512, 0.037440311163663864, 0.012003912590444088, -0.004389152862131596, -0.02081453800201416, -0.036690473556518555, 0.0025274797808378935, 0.0301746167242527, -0.012702039442956448, -0.017026551067829132, 0.0526181198656559, 0.01606985740363598, -0.013354917988181114, -0.03782816231250763, 0.01351005770266056, -0.02361997589468956, 0.022301292046904564, 0.009877209551632404, 0.02396903932094574, 0.0002902803826145828, 0.0268908329308033, 0.07141584157943726, -0.024111250415444374, 0.023839756846427917, -0.08315473049879074, -0.021008463576436043, -0.034182384610176086, -0.09241137653589249, -0.05915983021259308, -0.030381469056010246, 0.05585018917918205, -0.006625745911151171, -0.023257983848452568, 0.01729804463684559, 0.006936024874448776, 0.018138384446501732, -0.03829357773065567, 0.01058180071413517, 0.000654090428724885, 0.04439572989940643, -0.010853295214474201, 0.013316133059561253, 0.0042081568390131, 0.06091807782649994, -0.03681975603103638, -0.015940574929118156, 0.04687796160578728, -0.03893999382853508, -0.017220474779605865, -0.03883656859397888, 0.007698793429881334, -0.05111843720078468, 0.005662588868290186, -0.027795812115073204, -0.02683911845088005, -0.018332308158278465, 0.015151949599385262, -0.027382107451558113, 0.0038881816435605288, 0.002960577141493559, -0.025236012414097786, 0.03777644783258438, 0.028080234304070473, -0.00970914214849472, -0.016561131924390793, 0.04597298055887222, -0.04599883779883385, -0.02343898080289364, -0.024809379130601883, 0.005019406788051128, 0.022353004664182663, 0.022378860041499138, -0.00973499845713377, -0.014841671101748943, -0.015811292454600334, 0.01840987801551819, -0.0033645860385149717, -0.05096329748630524, -0.022844279184937477, -0.016651630401611328, -0.07394979149103165, 0.005846816580742598, 0.019573424011468887, -0.039793260395526886, 0.034285809844732285, -0.05859098583459854, 0.007032986730337143, -0.01887529529631138, 0.03343254327774048, -0.017569538205862045, -0.03612162917852402, -0.030303899198770523, -0.016212068498134613, -0.04876549169421196, -0.026464199647307396, -0.06567568331956863, 0.0024531420785933733, 0.00958632305264473, -0.03772473335266113, 0.03425995633006096, -0.01636720821261406, 0.008745985105633736, -0.034647803753614426, -0.029967764392495155, 0.01478995755314827, -0.02614099159836769, 0.0201164111495018, -0.0737946480512619, -0.052075132727622986, -0.029269637539982796, -0.006102150306105614, -0.023076988756656647, -0.05641903355717659, 8.549838094040751e-05, -0.013232099823653698, 0.000976893468759954, -0.013897906057536602, 0.001131224911659956, -0.030898600816726685, -0.0023287073709070683, 0.062469471246004105, 0.013406631536781788, 0.02018105238676071, -0.06795106828212738, -0.003204598557204008, 0.011616064235568047, 0.01388497743755579, 0.031596727669239044, 0.021564379334449768, 0.016767986118793488, 0.028338801115751266, 0.06086636334657669, 0.027330394834280014, 0.011034291237592697, -0.028804218396544456, 0.05548819899559021, 0.033872105181217194, 0.003797683632001281, 0.009948315098881721, -0.0016394681297242641, -0.0063122352585196495, 0.002530711703002453, -0.04263748228549957, 0.052411265671253204, 0.013341990299522877, 0.0033419616520404816, -0.007963823154568672, -0.001180513994768262, -0.0005349077982828021, -0.0014972570352256298, -0.08801576495170593, 0.06169377639889717, 0.008202997036278248, -0.05173899605870247, -0.010071134194731712, -0.08987743407487869, -0.022469358518719673, 0.023180413991212845, 0.020969677716493607, -7.464064401574433e-05, 0.057143017649650574, 0.01126053649932146, 0.030846888199448586, -0.05559162423014641, 0.023891469463706017, -0.002213968662545085, -0.05173899605870247, 0.034699514508247375, -0.037440311163663864, 0.024537883698940277, 0.0168326273560524, 0.015863005071878433, -0.012488722801208496, -0.014040117152035236, -0.05316110700368881, 0.038914136588573456, -0.011331642046570778, 0.015229519456624985, -0.03971569240093231, -0.033535972237586975, -0.002986433682963252, 0.033535972237586975, 0.0006892391829751432, -0.009974171407520771, 0.023749258369207382, 0.0037233459297567606, -0.014143543317914009, 0.032191429287195206, -0.0011481932597234845, 0.022611569613218307, -0.009657428599894047, -0.06851991266012192, -0.000622173713054508, -0.05786700174212456, -0.0027925095055252314, 0.013393702916800976, 0.04080166667699814, 0.0011473852209746838, 6.988091627135873e-06, -0.028209516778588295, 0.040491387248039246, -0.025714358314871788, -0.0029056319035589695, -0.020077627152204514, -0.036845613270998, -0.01706533506512642, 0.011086003854870796, -0.0604526586830616, -0.04597298055887222, -0.04250819981098175, 0.007976751774549484, 0.025766070932149887, 0.004722055979073048, -0.007065307814627886, -0.017569538205862045, -0.0055947150103747845, 0.033768679946660995, -0.04134465381503105, -0.02823537401854992, -0.02870079129934311, 0.01046544685959816, 0.04840349778532982, 0.042301349341869354, 0.01245640218257904, 0.00360375945456326, 0.012979998253285885, -0.043232183903455734, -0.014699460007250309, -0.01420818455517292, 0.023826828226447105, -0.024408601224422455, 0.01636720821261406, -0.01641892082989216, 0.0029056319035589695, 0.0257272869348526, -0.0006860070861876011, -0.0016548204002901912, 0.017388543114066124, 0.02795095182955265, 0.0302263293415308, -0.0021881121210753918, -0.02789923921227455, -0.008422777988016605, 0.022443503141403198, 0.016767986118793488, -0.00923725962638855, 0.0514545738697052, 0.028985215350985527, -0.004903052002191544, -0.032243143767118454, 0.005093744024634361, -0.02315455861389637, 0.026037566363811493, -0.013329061679542065, -0.025106729939579964, 0.019327785819768906, -0.03793158754706383, 0.03904341906309128, 0.017142904922366142, -0.07700086385011673, -0.029916051775217056, -0.024951590225100517, 0.010277986526489258, 0.026554696261882782, 0.005468664690852165, 0.013419559225440025, 0.017155833542346954, 0.001824504230171442, -0.014557248912751675, 0.023697545751929283, -0.0032288390211760998, 0.019495854154229164, 0.005950243212282658, 0.006806741934269667, -0.008933444507420063, -0.03322569280862808, 0.013484201394021511, 0.0217583030462265, 0.015268304385244846, -0.01953463815152645, -0.004812553990632296, -0.029864337295293808, 0.04915333911776543, -0.00383000448346138, 8.231681567849591e-05, -0.01070461980998516, -0.0012233390007168055, 0.042559914290905, -0.034751228988170624, 0.004602469503879547, -0.012669718824326992, 0.01696190983057022, -0.05109257996082306, -0.02841636911034584, 0.0245637409389019, -0.012204300612211227, -0.024007825180888176, -0.04000011458992958, 0.018862366676330566, -0.049618758261203766, 0.02000005729496479, 0.028390513733029366, 0.006538480054587126, 0.03751788288354874, 0.0213316697627306, -0.04620568826794624, 0.01659991778433323, -5.534922092920169e-05, -0.02636077255010605, -0.0217583030462265, -0.010594729334115982, -0.0031157166231423616, -0.03045903891324997, -0.050497882068157196, 0.0006144975195638835, 0.011493245139718056, 0.01817716844379902, 0.012294799089431763, 0.02952820248901844, -0.01865551434457302, -0.024292247369885445, -0.0004981429665349424, -0.015914717689156532, 0.03870728611946106, -0.001368782133795321, -0.02111188881099224, 0.010523623786866665, -0.07575974613428116, 0.013329061679542065, -0.012960605323314667, -0.007078235968947411, -0.02683911845088005, 0.031596727669239044, -0.012372368946671486, -0.0201681237667799, 0.006890775635838509, 0.009120904840528965, 0.04822250083088875, 0.05760843679308891, 0.03974154591560364, 0.0014051429461687803, -0.03363939747214317, -0.00440208101645112, 0.008952837437391281, 0.013988404534757137, -0.0334584005177021, -0.023594120517373085, 0.00891405250877142, 0.028080234304070473, 0.06867504864931107, -0.019198503345251083, 0.023232128471136093, -0.020439617335796356, -0.01148678082972765, 0.006224968936294317, -0.017466112971305847, 0.010400804691016674, 0.02911449782550335, 0.027175255119800568, 0.007653544656932354, -0.03881071135401726, -0.021719519048929214, 0.005636732093989849, -0.03126059100031853, -0.010148703120648861, 0.0583324208855629, -0.024227606132626534, 0.027511389926075935, -0.053109392523765564, -0.04858449473977089, 0.03630262240767479, 0.003034914843738079, 0.003030066844075918, -0.026528840884566307, -0.007666472811251879, 0.03862971439957619, 0.00021917482081335038, -0.018629658967256546, -0.037388600409030914, 0.024421529844403267, -0.042559914290905, -0.0098190326243639, -0.06174548715353012, -0.048093218356370926, -0.01020688097923994, -0.01712997816503048, -0.034699514508247375, -0.006166792009025812, -0.0005890449974685907, -0.04390445351600647, -0.0200646985322237, 0.024654239416122437, 0.0741049274802208, -0.01819009706377983, -0.061073217540979385, 0.09587615728378296, -0.019599279388785362, -0.0043277433142066, -0.05210098624229431, 0.02549457736313343, 0.008991622366011143, -0.03436338156461716, 0.045869555324316025, -0.03526836261153221, 0.021073104813694954, 0.021021390333771706, -0.010116382502019405, 0.053005967289209366, -0.025055015459656715, 0.011622527614235878, -0.034182384610176086, 0.02386561408638954, -0.015164878219366074, -0.012294799089431763, -0.002878159284591675, 0.03547521308064461, -0.039017561823129654, 0.015578582882881165, -0.05419537052512169, 0.0020087321754544973, -0.00610861461609602, 0.044059593230485916, 0.030303899198770523, 0.022585714235901833, 0.06572739779949188, 0.02356826327741146, 0.013691053725779057, 0.05941839516162872, 0.01603107340633869, -0.0005082432180643082, 0.0009663893142715096, 0.048739634454250336, -0.013316133059561253, 0.00835813581943512, -0.014802886173129082, 0.014104758389294147, -0.0024192053824663162, -0.0068196700885891914, -0.0046509504318237305, 0.039379555732011795, 0.00014170612848829478, 0.051894135773181915, 0.027459677308797836, -0.03945712372660637, 0.016354279592633247, -0.006115078926086426, 0.01379447989165783, -0.014996809884905815, 0.00932775717228651, 0.01626378297805786, 0.02841636911034584, 0.020310334861278534, 0.024886948987841606, -0.015927646309137344, 0.005449272226542234, 0.025248941034078598, -0.004405313171446323, -0.011926342733204365, 0.011939271353185177, 0.008170676417648792, 0.003642544150352478, 0.0023400194477289915, -0.0084163136780262, 0.016509419307112694, 0.015203663147985935, -0.024874020367860794, -0.11097639799118042, -0.04501628875732422, -0.013820336200296879, 0.02614099159836769, -0.013716910034418106, 0.010051741264760494, -0.00751133356243372, -0.06639967113733292, 0.021551450714468956, -0.008687807247042656, -0.024770593270659447, -0.025753144174814224, 0.051351148635149, -0.004011000506579876, 0.028545653447508812, -0.006670995149761438, -0.006289610639214516, 0.006538480054587126, -0.02338726632297039, 0.007912110537290573, -0.017905674874782562, 0.02058183029294014, 0.03852628916501999, -0.006774421315640211, -0.05122186616063118, 0.00377829116769135, -0.029657484963536263, -0.024757664650678635, -0.005197170656174421, -0.0020830698776990175, -0.0173109732568264, 0.0017501665279269218, -0.01626378297805786, 0.03397553414106369, 0.011519101448357105, -0.020905036479234695, -0.012766681611537933, -0.016806770116090775, 0.03351011499762535, 0.02602463774383068, -0.011997448280453682, 0.006160327699035406, -0.0063962689600884914, -0.031079595908522606, 0.002142863115295768, 0.003804147709161043, -0.01073047611862421, 0.02836465649306774, -0.00868134293705225, 0.020025912672281265, 0.05052373558282852, 0.01659991778433323, 0.018927009776234627, -0.03082103095948696, -0.023994896560907364, -0.014596033841371536, -0.011234679259359837, 0.00128959643188864, -0.022146152332425117, 0.0007878173491917551, -0.0026906991843134165, -0.03348425775766373, 0.008429241366684437, 0.029217923060059547, -0.027925094589591026, 0.04514557123184204, 0.008222389034926891, -0.027692386880517006, 0.0020087321754544973, -0.014234041795134544, -0.007892717607319355, -0.010672299191355705, -0.00031229888554662466, 0.026205632835626602, 0.050368595868349075, -0.012844250537455082, -0.0008718512253835797, -0.020155195146799088, 0.032243143767118454, -0.029967764392495155, 0.023762186989188194, 0.038086727261543274, -0.0011263767955824733, 0.00824178196489811, -0.01912093348801136, 0.015035594813525677, -0.03273441642522812, -0.0086554866284132, 0.0072592319920659065, -0.021086031571030617, -0.02929549291729927, 0.02403368055820465, -0.027278680354356766, 0.010446053929626942, -0.030614178627729416, 0.006489999126642942, 0.00996770802885294, -0.004023928660899401, 0.020840395241975784, 0.019599279388785362, -0.03904341906309128, -0.011124788783490658, 0.011060147546231747, -0.061952341347932816, -0.0005437959916889668, 0.015203663147985935, -0.006250825710594654, 0.013613483868539333, 0.009360077790915966, -0.02947648987174034, 0.014815814793109894, 0.0048965876922011375, 0.009049799293279648, 0.008448634296655655, 0.0230252742767334, -0.02841636911034584, -0.0369490385055542, 0.033820394426584244, -0.001353429863229394, 0.02513258531689644, -0.014970953576266766, -0.02455081231892109, -0.03899170830845833, -0.021538522094488144, -0.04801565036177635, 0.016044002026319504, 0.0029282565228641033, 0.03619919717311859, -0.0491274818778038, -0.013949619606137276, 0.019857846200466156, 0.007213982753455639, 0.008817090652883053, -0.021215315908193588, -0.021771231666207314, -0.005539770238101482, -0.038500431925058365, -0.005976099520921707, 0.013199779205024242, 0.02250814437866211, 0.01502266712486744, -0.01719461940228939, -0.003223991021513939, -0.028261231258511543, 0.024046609178185463, 0.02018105238676071, 0.014958025887608528, 0.006632210221141577, 0.005840352736413479, -0.024705952033400536, -0.014608961530029774, -0.046386685222387314, 0.008215924724936485, -0.03865557163953781, 0.02333555370569229, -0.06919217854738235, -0.0334584005177021, 0.022172007709741592, 0.003926966339349747, 0.032889556139707565, -0.01922435872256756, 0.007524261716753244, -0.018215952441096306, -0.0009720454108901322, -0.020892107859253883, 0.009353614412248135, -0.0018875296227633953, -0.021305812522768974, 0.02320627123117447, -0.008144819177687168, 0.04424059018492699, -0.017375614494085312, -0.03847457468509674, -0.01835816353559494, 0.010193952359259129, 0.016923123970627785, -0.0024499099235981703, -0.02064647153019905, -0.0074984049424529076, -0.01918557472527027, 0.02449909970164299, 0.05005832016468048, -0.026916688308119774, -0.0535748116672039, 0.003826772328466177, -0.018629658967256546, 0.028778361156582832, -0.014634818769991398, 0.0245637409389019, 0.017440255731344223, 0.0043794563971459866, -0.0036134556867182255, -0.03725931793451309, -0.004256637766957283, -0.004964461550116539, -0.01210733875632286, 0.008687807247042656, 0.03454437851905823, 0.0006338899838738143, -0.053936805576086044, -0.02232714742422104, 0.01063997857272625, -0.0019473228603601456, -0.010924400761723518, 0.038681428879499435, 0.02139631099998951, -0.049851465970277786, -0.0024337496142834425, 0.038500431925058365, -0.024473242461681366, -0.0022947704419493675, -0.04144808277487755, -0.027640672400593758, 0.04734337702393532, -0.00830642320215702, 0.021486809477210045, 0.0069230967201292515, 0.005930850747972727, 0.015940574929118156, 0.025740215554833412, 0.024292247369885445, 0.02093089371919632, -0.012973533943295479, -0.022314218804240227, 0.011208822950720787, -0.0037750592455267906, 0.0012249549617990851, 0.005433111451566219, -0.0004504699318204075, 0.02396903932094574, -0.00791857484728098, 0.015203663147985935, 0.002910480136051774, 0.005442807916551828, 0.036690473556518555, 0.002816749969497323, -0.0018632890423759818, -0.01180998794734478, -0.020219838246703148, 0.0005999532295390964, -0.021422168239951134, 0.0026906991843134165, 0.009230795316398144, -0.046800389885902405, 0.02924378030002117, 0.018927009776234627, 0.0036587046924978495, 0.04607640579342842, -0.02157730795443058, 0.052411265671253204, -0.04765365645289421, -0.019857846200466156, -0.00438268855214119, 0.007569510955363512, -0.022895991802215576, -0.023529477417469025, -0.01446675043553114, -0.01376862358301878, 0.014777029864490032, -0.003807379864156246, -0.009321293793618679, -0.011182966642081738, -0.023464836180210114, -0.006910168100148439, 0.014802886173129082, -0.003716881852596998, -0.03110545314848423, 0.002398196840658784, 0.005184242036193609, 0.0026454501785337925, -0.11118324846029282, -0.016936052590608597, 0.02823537401854992, -0.00440208101645112, 0.030329756438732147, -0.015513941645622253, 0.028287086635828018, 0.018603801727294922, 0.004977389704436064, -0.03348425775766373, -0.0032595437951385975, -0.027407962828874588, 0.0064027332700788975, 0.007466084323823452, -0.0007037835312075913, -0.05179071053862572, -0.026089278981089592, 0.0005082432180643082, 0.014583105221390724, -0.006800277624279261, -0.023878542706370354, -0.023632904514670372, 0.03436338156461716, 0.03296712785959244, -0.016444778069853783, -0.011764738708734512, -0.022663284093141556, -0.012818394228816032, 0.014298683032393456, 0.016044002026319504, -0.0313381627202034, -0.012895964086055756, -0.0006338899838738143, 0.026968402788043022, -0.016910197213292122, 0.004030392970889807, -0.026102207601070404, -0.006409197114408016, -0.02864907868206501, -0.02957991510629654, 0.006173255853354931, -0.026554696261882782, 0.034725371748209, -0.005138993263244629, 0.017905674874782562, -0.008170676417648792, 0.008280565962195396, -0.011887557804584503, 0.005413719452917576, 0.033406686037778854, 2.994715941895265e-05, -0.004030392970889807, 0.03508736565709114, 0.05429879575967789, 8.120579150272533e-05, 0.02748553268611431, -0.021616091951727867, -0.026218561455607414, 0.00723337521776557, 0.019896630197763443, 0.025365294888615608, 0.033406686037778854, 0.04426644742488861, -0.009747927077114582, -0.006344555877149105, -0.005355542059987783, -0.006299306638538837, 0.05158385634422302, -0.009618643671274185, -0.017323901876807213, 0.00011807159899035469, 0.00410473020747304, 0.017685893923044205, 0.003939894959330559, 0.013290276750922203, -0.0004743064346257597, 0.01888822391629219, 0.032941270619630814, -0.03004533424973488, 0.024693023413419724, 0.03594063222408295, -0.03193286433815956, 0.020025912672281265, 0.005287668667733669, -0.024227606132626534, 0.020206909626722336, 0.012618006207048893, -0.041551508009433746, -0.018099598586559296, -0.0015546262729912996, 0.019082147628068924, 0.015539797954261303, -0.005711069796234369, 0.021952226758003235, 0.011001970618963242, -0.006351019721478224, 0.013264420442283154, 0.009515217505395412, 0.0625728964805603, 0.006577264983206987, 0.04237891733646393, 0.016767986118793488, 0.03625091165304184, -0.03875899687409401, -0.001040726900100708, -0.02087917923927307, 0.022482287138700485, -0.022133223712444305, 0.03180358186364174, 0.00947643257677555, 0.014040117152035236, 0.024421529844403267, -0.007136413361877203, 0.0028038218151777983, -0.00495476508513093, 0.03550107032060623, -0.01764710806310177, -0.01040726900100708, 0.03278613090515137, -0.03480294346809387, 0.029321350157260895, 0.0010504231322556734, -0.0012467714259400964, -0.021008463576436043, -0.0026745388749986887, 0.009192010387778282, -0.0045539881102740765, -0.0004072409647051245, -0.010620585642755032, -0.031208880245685577, -0.015074379742145538, 0.015397586859762669, 0.010943792760372162, 0.0390692763030529, 0.01008406188338995, -0.004589540883898735, -2.9416898541967385e-05, -0.015811292454600334, -0.025003302842378616, 0.029657484963536263, -0.021357527002692223, -0.005717534106224775, 0.03115716576576233, -0.0009041719022206962, -0.041370511054992676, 0.023283841088414192, -0.013626412488520145, -0.007724650204181671, -0.038965851068496704, 0.05915983021259308, -0.02332262508571148, 0.009276044555008411, 0.01754368282854557, 0.03537178784608841, -0.006619281601160765, 0.023839756846427917, 0.01578543521463871, -0.00943764764815569, 0.019030435010790825, 0.05137700214982033, 0.006438286043703556, 0.04258577153086662, 0.03257927671074867, 0.008810626342892647, 0.023128701373934746, 0.0004989510052837431, -0.042016927152872086, 0.003287016414105892, 0.015294160693883896, 0.03441509231925011, -0.0257272869348526, -0.04005182534456253, 0.04338732361793518, 0.0290627833455801, 0.0034777086693793535, 0.026502983644604683, 0.02776995487511158, -0.0034938689786940813, 0.0018713691970333457, 0.036457762122154236, -0.01865551434457302, 0.005197170656174421, -0.026438342407345772, 0.01870722882449627, 0.006583728827536106, 0.027201110497117043, 0.031234735623002052, 0.034001387655735016, 0.02280549518764019, -0.004515203647315502, 0.01236590463668108, 0.037155888974666595, -0.02924378030002117, -0.0038623251020908356, -0.012766681611537933, -0.024162964895367622, 0.021551450714468956, -0.004602469503879547, -0.03263099119067192, -0.0013291892828419805, -0.0325017087161541, 0.03286369889974594, 0.005578554701060057, -0.01543637178838253, -0.011383354663848877, 0.014867527410387993, -0.0020038841757923365, -0.03286369889974594, -0.01283778715878725, 0.006677458994090557, -0.00891405250877142, 0.01087915152311325, -0.029373062774538994, 0.040310390293598175, -0.0092631159350276, -0.0057821753434836864, 0.01219137292355299, 0.0010997122153639793, 0.024938661605119705, -0.004411777015775442, -0.02859736606478691, -0.0034259953536093235, -0.042301349341869354, 0.023710474371910095, -0.020374976098537445, 0.012010376900434494, 0.015294160693883896, -0.008390456438064575, -0.014221113175153732, 0.005229491274803877, 0.022779637947678566, -0.007369122467935085, -0.002687467262148857, 0.012288334779441357, -0.035345930606126785, -0.003351657884195447, -0.01953463815152645, -0.012753752991557121, -0.007944431155920029, -0.004948300775140524, 0.035397645086050034, 0.028855931013822556, -0.0076794009655714035, 0.016160355880856514, -0.0007878173491917551, -0.016793841496109962, 0.01160959992557764, 0.007188126444816589, -0.010911472141742706, -0.028080234304070473, -0.006987737957388163, 0.00720751890912652, 0.042249634861946106, -0.025391152128577232, -0.007976751774549484, 0.003752434626221657, 0.04015525430440903, 0.062055766582489014, 0.026580553501844406, 0.016328424215316772, 0.003012290457263589, 0.026994258165359497, -0.01595350354909897, -0.030562466010451317, 0.012663254514336586, -0.027976809069514275, -0.028261231258511543, 0.009579858742654324, -0.004641254432499409, -0.0032013666350394487, -0.011900486424565315, 0.022314218804240227, -0.0010148703586310148, 0.004053017124533653, 0.0036069913767278194, -0.0014116071397438645, 0.0037201140075922012, -0.022883063182234764, 0.009075655601918697, -0.03299298137426376, -0.008668415248394012, -0.024072466418147087, -0.03436338156461716, 0.013471272774040699, 0.006370412185788155, 0.011195894330739975, -0.03433752432465553, -0.015151949599385262, 0.006115078926086426, -0.014311611652374268, 0.021473880857229233, -0.01940535567700863, 0.013458344154059887, -0.012087945826351643, -0.004479650873690844, -0.0016596685163676739, 0.02385268546640873, 0.013639340177178383, 0.017155833542346954, -0.04532656818628311, 0.009715606458485126, 0.003181974170729518, 0.022029796615242958, -0.009166154079139233, 0.026683980599045753, 0.01742732711136341, 0.0037427383940666914, -0.056212183088064194, -0.010129311122000217, -0.010116382502019405, -0.015358801931142807, 0.02074989676475525, 0.014712387695908546, -0.007013594266027212, -0.0015311937313526869, 0.01596643216907978, 0.018565017729997635, -0.0346219465136528, -0.005795103497803211, -0.04315461590886116, -0.021422168239951134, 0.018810654059052467, -0.004618629813194275, 0.023180413991212845, -0.00859084539115429, -0.04175835847854614, -0.008280565962195396, -0.004347135778516531, -0.00830642320215702, 0.002726251957938075, -0.015888862311840057, 0.010749869048595428, 0.006864919327199459, 0.02823537401854992, -0.03976740315556526, 0.006425357423722744, -0.05191999301314354, 0.0020943821873515844, -0.007272160146385431, 0.006619281601160765, 0.03606991469860077, 0.02005176991224289, -0.018733084201812744, 0.001418071216903627, -0.0034130671992897987, 0.033949676901102066, 0.022365933284163475, -0.021473880857229233, 0.0035035652108490467, -0.04168079048395157, 0.06081465259194374, -0.01263093389570713, -0.03767302259802818, 0.007569510955363512, 0.0026195936370640993, 0.02730453759431839, 0.015009738504886627, 0.016767986118793488, -0.061590347439050674, -0.019340714439749718, 0.006082757841795683, 0.008720127865672112, 0.017026551067829132, -0.0004072409647051245, -0.017233403399586678, 5.832878377987072e-05, -0.010096990503370762, 0.015772506594657898, 0.01824180968105793, 0.02976091206073761, 0.0024143571499735117, 0.011208822950720787, -0.02087917923927307, 0.008810626342892647, 0.007575974799692631, 0.03687146678566933, -0.0007942814845591784, 0.022133223712444305, -0.013484201394021511, 0.049722183495759964, -0.01906922087073326, -0.03723346069455147, -0.02028447948396206, -0.0038203082513064146, -0.027149397879838943, 0.010711084119975567, -0.044292304664850235, 0.05667760223150253, 0.0007510525174438953, -0.005798335652798414, -0.0016427001683041453, 0.0268908329308033, 0.02111188881099224, -0.024162964895367622, -0.036406051367521286, -0.0013477737084031105, -0.003739506471902132, 0.015462229028344154, -0.003487404901534319, -0.008047857321798801, -0.02795095182955265, -0.017323901876807213, 0.015061452053487301, -0.011195894330739975, 0.013167457655072212, -0.005038798786699772, -0.004592773038893938, 0.02846808359026909, 0.025934139266610146, -0.0023998129181563854, -0.02758895978331566, -0.017285116016864777, -0.03115716576576233, -0.024227606132626534, -0.03855214640498161, -0.03521664813160896, -0.009541073814034462, 0.022818421944975853, -0.01659991778433323, 0.010161631740629673, -0.023245055228471756, -0.015255375765264034, -0.010478374548256397, -0.02263742685317993, 0.0018164239590987563, 0.005297364667057991, -0.014660675078630447, 0.021422168239951134, 0.025352366268634796, 0.036690473556518555, 0.0007417603628709912, 0.007640616502612829, -0.024188820272684097, -0.000552280165720731, 0.0023771882988512516, -0.015604440122842789, 0.02455081231892109, -0.012501651421189308, -0.0007526685949414968, 0.042430631816387177, -0.024512028321623802, 0.01764710806310177, 0.006670995149761438, -0.0005106672761030495, 0.005491288844496012, -0.0109050078317523, -0.019793203100562096, -0.0268908329308033, 0.0034777086693793535, -0.040491387248039246, -0.0068261343985795975, -0.008836482651531696, 0.001994187943637371, -0.030536608770489693, -0.032191429287195206, -0.009676821529865265, -0.02548164874315262, -0.008539131842553616, 0.0151131646707654, -0.00883001834154129, 0.0063090031035244465, 0.008468026295304298, 0.0023141629062592983, 0.02157730795443058, -0.04240477457642555, 0.005190706346184015, 0.005116368643939495, 0.037983302026987076, -0.024343959987163544, -0.031545013189315796, 0.03643190488219261, 0.0018972257385030389, 0.01694898121058941, 0.0011376891052350402, 0.016819698736071587, -0.002517783548682928, -0.000871043186634779, 0.0005983371520414948, 0.003390442579984665, 0.014014260843396187, -0.0493343360722065, 0.0063057709485292435, 0.022469358518719673, -0.002658378565683961, 0.02093089371919632, 0.019457068294286728, -0.01508730836212635, 0.003442155895754695, -0.03082103095948696, 0.020788682624697685, 3.777483289013617e-05, 0.032889556139707565, -0.018086669966578484, -0.01729804463684559, 0.01830645091831684, 0.020206909626722336, -0.0030397630762308836, 0.007724650204181671, 0.006115078926086426, 0.014156471937894821, 0.01254043634980917, -0.044887006282806396, 0.015824221074581146, 0.03343254327774048, -0.0015166493831202388, -0.0025210154708474874, 0.01764710806310177, 0.002349715679883957, 0.016625775024294853, -0.018784798681735992, 0.01965099200606346, -0.01189402211457491, -0.0037718270905315876, -0.007226911373436451, 0.04760194569826126, 0.0006944913184270263, -0.0346219465136528, -0.005242419429123402, 0.018991651013493538, -0.012572756968438625, 0.027925094589591026, 0.015397586859762669, -0.011538494378328323, 5.163738751434721e-05, -0.009243723936378956, -0.00938593503087759, -0.02074989676475525, 0.03940541297197342, -0.03987083211541176, 0.027382107451558113, -0.0004973349277861416, -0.003484172746539116, 0.03278613090515137, 0.030717603862285614, -0.008409849368035793, -0.01643184944987297, -0.01078865397721529, 0.018720155581831932, -0.006515855435281992, 0.028519796207547188, 0.007065307814627886, -0.0013485817471519113, -0.01098904199898243, -0.01742732711136341, 0.012411152943968773, 0.03661290183663368, -0.014893383719027042, 0.04729166626930237, 0.013193314895033836, 0.004505507182329893, -0.019482925534248352, 0.007808683905750513, -0.016224997118115425, -0.048972342163324356, 0.016289638355374336, -0.009321293793618679, -0.002627673791721463, -0.009528146125376225, 0.002322243060916662, -0.0014487758744508028, 0.022818421944975853, 0.009017478674650192, -0.010672299191355705, -0.0008035736973397434, -0.031596727669239044, -0.006968345493078232, 0.021616091951727867, 0.0012928284704685211, -0.009301900863647461, -0.03570792078971863, -0.005530073773115873, 0.014285754412412643, 0.04385274276137352, -0.005972867365926504, 0.016289638355374336, 0.034932225942611694, 0.004069177433848381, -0.009166154079139233, 0.005433111451566219, -0.004217852838337421, 0.015591511502861977, -0.033122263848781586, 0.0075889029540121555, -0.008280565962195396, -0.006237897556275129, -0.00010054771701106802, -0.032708559185266495, 0.010478374548256397, 0.02069818414747715, 0.01254043634980917, 0.004091802053153515, 0.012398225255310535, 0.0072592319920659065, 0.014647746458649635, -0.020077627152204514, 0.0240853950381279, -0.017582466825842857, 0.007634152192622423, -0.05254054814577103, -0.009922458790242672, 0.015552726574242115, 0.06929560750722885, -0.04798979312181473, -0.03415652737021446, -0.010497767478227615, -0.0045701488852500916, 0.015229519456624985, -0.0035229576751589775, 0.027278680354356766, 0.03519079089164734, -0.02683911845088005, 0.0257272869348526, -0.003099556313827634, -0.0054169511422514915, 0.02707182802259922, 0.013458344154059887, -0.03855214640498161, 0.014272826723754406, -0.03257927671074867, -0.02390439808368683, -0.01654820516705513, 0.018151311203837395, -0.0015715946210548282, -0.03232071176171303, 0.019663920626044273, 0.032372426241636276, -0.02753724716603756, 0.01608278602361679, -0.017349757254123688, -0.022353004664182663, 0.021486809477210045, -0.009424719959497452, 0.00956046674400568, -0.023697545751929283, 0.017802247777581215, -0.0014907928416505456, -0.004977389704436064, -0.014337467961013317, 0.026968402788043022, 0.00445702625438571, -0.0013615100178867579, -0.0007987255812622607, 0.019276073202490807, 0.0006500502931885421, -0.003136725164949894, -0.016341352835297585, 0.013678125105798244, -0.016742128878831863, -0.008054321631789207, 0.001330805360339582, -0.018138384446501732, -0.008235317654907703, -0.015591511502861977, 0.008002608083188534, 0.02976091206073761, 0.027149397879838943, -0.0019408587832003832, 0.04292190447449684, 0.015371730551123619, -0.004932140465825796, -0.005248883739113808, 0.002811901969835162, 0.008959301747381687, -0.004437633790075779, 0.005284436512738466, 0.0019634831696748734, -0.009844888933002949, -0.007097628433257341, 0.009806104004383087, 0.015177805908024311, -0.006722708232700825, -0.004495811183005571, -0.019392427057027817, -0.024240534752607346, 0.03619919717311859, -0.03273441642522812, 0.016341352835297585, 0.04289604723453522, 0.006845526862889528, 0.009276044555008411, 0.017440255731344223, -0.024124179035425186, 0.04103437438607216, 0.0021137746516615152, 0.0023319392930716276, -0.01988370157778263, 0.011654849164187908, 0.011965127661824226, 0.02678740583360195, 0.00580479996278882, 0.0053587742149829865, 0.021667804569005966, -0.050420310348272324, -0.01701362244784832, 0.02443445846438408, 0.012268941849470139, -0.036328479647636414, -0.0005021830438636243, -0.02976091206073761, 0.007931502535939217, 0.040077682584524155, 0.031545013189315796, 0.0045701488852500916, 0.01263093389570713, 0.029217923060059547, 0.02174537442624569, -0.020310334861278534, 0.0086554866284132, -0.03893999382853508, -0.01654820516705513, -0.030536608770489693, -0.038681428879499435, 0.015824221074581146, 0.017336830496788025, -0.03656119108200073, 0.013251491822302341, -0.0380091555416584, -0.0034162993542850018, -0.02116360142827034, -0.001383326482027769, -0.006903704255819321, 0.0030219864565879107, 0.036690473556518555, 0.018396949395537376, -0.010025884956121445, -0.0050743515603244305, -0.007517797406762838, -0.00862963031977415, 0.0063057709485292435, -0.01189402211457491, 0.013193314895033836, -0.04863620921969414, -0.01718169078230858, -0.008215924724936485, -0.010607657954096794, 0.01941828429698944, -0.004114426672458649, 0.005892065819352865, -0.008080177940428257]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
" 10a). Then for each
new request, we determine the cluster membership using
K-Means clustering once we have processed five tokens,
using the observed activations (Figure 10b). After this step,
we keep the clustered heads same throughout inference
(Figure 10c).
There are two direct outcomes of CHAI ’s design. First,
we directly reduce the amount of computation by removing
redundant heads. Secondly, after a pre-determined token
we fix the heads which are going to be pruned, this also al-
lows us to remove the corresponding Keytokens associated,
which significantly reduces the K,V cache size. Therefore,
CHAI allows us to reduce both the inference compute as
well as the size of the K,V cache required.
4. Evaluation
We experimentally verify the performance of CHAI
and compare it to DEJAVU(Liu et al., 2023b) and
SPATTEN (Wang et al., 2021b) on three different mod-
els of various sizes LLaMa-7B (Touvron et al., 2023a),
LLaMa-33B and OPT-66B (Zhang et al., 2022). We
evaluate the models on five commonly used NLP tasks:
PIQA (Bisk et al., 2020), HellaSwag (Zellers et al., 2019),
Arc-Challenge and Arc-Easy (Clark et al., 2018) and
BoolQA (Clark et al., 2019).
4.1. Experimental Setup
All our experiments are performed on servers with NVIDIA
V100 GPUs. For OPT -66B we used eight GPUs on a sin-
gle node, for LLAMA-33B we used four GPUs, and for
LLAMA-7B, we used a single GPU for inference. CHAI is
built on top of Meta’s xFormers (facebookresearch, 2023).
4.2. Accuracy Evaluation
In our evaluation, we compare CHAI with Multi-Head At-
tention as baseline, static version of CHAI , as well two
other state-of-the-art prior pruning methods; DEJAVUand
SPATTEN . For DEJAVU, we try different sparsity ratios, in
order to try to match the accuracy number to MHA. We
also compare CHAI toSPATTEN , a method which removes
unimportant tokens and heads.Table 2. Accuracy on LL AMA-7B
Method PIQA HellaSwag Arc-Challenge Arc-Easy BoolQ
MHA 79.8 76.1 47.5 72.8 76.0
DejaVu-10% -3.9 -4.7 -5.78 -3.18 -7.4
DejaVu-30% -13.3 -18.6 -18.75 -4.2 -20.2
DejaVu-50% -24.6 -50.7 -19.35 -46.3 -21.6
SpAtten -41.4 -42.5 -18.0 -40.2 -27.1
CHAI-static -4.0 -4.3 -3.7 -2.5 -0.8
CHAI -2.0 -3.2 -0.5 0.3 0.1
Table 3. Accuracy on LL AMA-33B
Method PIQA HellaSwag Arc-Challenge Arc-Easy BoolQ
MHA 82.1 82.8 57.8 80.0 83.1
DejaVu-10% -0.7 0.1 -0.2 -0.6 -0.2
DejaVu-30% -9.3 -24.4 -17.91 -12.4 -12.2
DejaVu-50% -27.6 -43.2 -24.6 -37.6 -21.2
SpAtten -31.9 -44.1 -26.4 -40.3 -34.55
CHAI-static -0.5 -0.2 -1.3 -3.7 -1.5
CHAI 0 -0.14 -0.21 0.9 -0.04
In Table 1, we first verify that we are able to reproduce the
performance numbers reported by DEJAVU. To perform this,
we took the OPT -66B and evaluated both DEJAVU,CHAI
andCHAI -static. We used DEJAVUwith 50% sparsity as
reported by the authors. We used the author provided code
to train their MLP predictor","[-0.0016179324593394995, 0.01502467691898346, 0.04316387325525284, -0.03349904343485832, 0.050604935735464096, -0.010313428938388824, -0.006368381902575493, 0.04553018882870674, -0.011696155183017254, 0.01222358737140894, 0.012808037921786308, -0.017105894163250923, -0.04148179292678833, 0.0218100156635046, -0.007034799084067345, -0.03817465528845787, 0.02839578501880169, -0.04535913094878197, -0.005306391045451164, 0.027996646240353584, -0.03743339702486992, 0.019472209736704826, 0.022323191165924072, 0.01610805094242096, 0.02575862593948841, 0.00032853116863407195, 0.018959032371640205, -0.03198802098631859, 0.011817322112619877, -0.02759750932455063, -0.0015279484214261174, -0.033955201506614685, -0.027340920642018318, -0.015509343706071377, -0.010413212701678276, 0.032843317836523056, -0.027340920642018318, 0.0044653513468801975, -0.03164590522646904, -0.029279589653015137, 0.007284259889274836, 0.010484487749636173, -0.04290728643536568, -0.0015012203948572278, -0.006332744844257832, -0.00536341080442071, 0.01817501336336136, 0.0004071559233125299, -0.009465261362493038, 0.024432919919490814, -0.09852994978427887, 0.07509487867355347, -0.029593197628855705, 0.00943675171583891, -0.017105894163250923, -0.007740417029708624, 0.02155342698097229, 0.004932199604809284, 0.02880917675793171, -0.01082660537213087, 0.009714722633361816, -0.017747364938259125, 0.01610805094242096, 0.014269166626036167, -0.031503356993198395, -0.02132534794509411, -0.03252970799803734, 0.012601342052221298, 0.038915909826755524, -0.006664171349257231, -0.02610074356198311, 0.05599329248070717, 0.04438979551196098, -0.026271803304553032, -0.03991375491023064, -0.006999161560088396, -0.005705528426915407, 0.044076189398765564, 0.013406744226813316, 0.014896382577717304, -0.01093351747840643, 0.03215908259153366, 0.0340692400932312, -0.036920223385095596, 0.014497245661914349, -0.05570819601416588, -0.01674952171742916, -0.010655546560883522, -0.06169525906443596, -0.02028474025428295, -0.022879133000969887, 0.05069046840071678, -0.00224514864385128, 0.006143867038190365, 0.04635697230696678, 0.01370609737932682, 0.01763332635164261, -0.01907307282090187, 0.007312770001590252, 0.03147484362125397, 0.03737637773156166, 0.03463943675160408, 0.00715596554800868, 0.00722724013030529, 0.04852372035384178, -0.007569358218461275, -0.010512997396290302, -0.005481013562530279, -0.044845953583717346, -0.0076548876240849495, -0.05000622943043709, 0.00932983960956335, -0.09562195092439651, 0.009315584786236286, -0.04692716896533966, -0.03347053378820419, -0.04749736562371254, -0.0053420281037688255, -0.02883768640458584, -0.005249371286481619, -0.039714183658361435, -0.0003570409899111837, 0.05958553031086922, -0.018417345359921455, 0.0321020632982254, 0.004155306611210108, 0.02754049003124237, -0.07292813062667847, -0.04307834431529045, -0.03540920093655586, -0.003551254980266094, 0.03404073044657707, 0.05573670566082001, -0.03469645604491234, 0.006051210220903158, -0.023135721683502197, -0.005445376504212618, 0.021125778555870056, -0.03520963340997696, -0.013955558650195599, 0.014525755308568478, -0.05097556486725807, -0.007405426818877459, 0.03164590522646904, -0.046242933720350266, 0.004565135575830936, -0.028067922219634056, 0.010684056207537651, -0.03703426197171211, 0.0362359844148159, -0.01920136623084545, -0.031275276094675064, -0.04801054298877716, -0.023549115285277367, -0.06431816518306732, -0.003203791566193104, -0.024333134293556213, 0.008873682469129562, 0.025516292080283165, -0.0486377589404583, 0.003089752048254013, 0.020199209451675415, 0.014939147979021072, -0.03059104084968567, -0.0004953581956215203, 0.01830330677330494, -0.02222340740263462, 0.0053883567452430725, -0.08473119884729385, -0.06562961637973785, -0.016165070235729218, -0.005484577268362045, -0.011482331901788712, -0.07024820894002914, -0.0005087221506983042, -0.03412625938653946, -0.01079096831381321, 0.005673455074429512, 0.0005884605925530195, -0.04059799015522003, -0.025573311373591423, 0.06403306126594543, -0.0037454781122505665, 0.04279324412345886, -0.04664207249879837, -0.02059834823012352, -0.011118831112980843, 0.04812458157539368, 0.023035937920212746, 0.03883038088679314, 0.052287016063928604, 0.04099712520837784, 0.07161667943000793, 0.013827264308929443, 0.017647581174969673, -0.036150455474853516, 0.06454624235630035, 0.03156037628650665, 0.0076263779774308205, 0.01824628747999668, 0.020669622346758842, 0.02372017316520214, -0.005915788467973471, -0.038060612976551056, 0.06511643528938293, -0.005349155515432358, 0.004992783069610596, -0.055137999355793, -0.0122592244297266, -0.022266171872615814, 0.030705079436302185, -0.028994491323828697, 0.05502396076917648, -0.023648899048566818, -0.06648490577936172, -0.016179325059056282, -0.07401150465011597, 0.0005880151293240488, -0.013535038568079472, 0.018460111692547798, 0.013378234580159187, 0.025330979377031326, 0.03803210332989693, 0.041367754340171814, -0.038203164935112, 0.02813919633626938, 0.028481313958764076, -0.010634164325892925, 0.029422137886285782, -0.041054144501686096, -0.0019582684617489576, 0.019172856584191322, -0.019657524302601814, 0.022993173450231552, 0.008267848752439022, -0.10252133011817932, 0.028281744569540024, -0.007469573989510536, 0.016065286472439766, -0.044646382331848145, 0.0037490418180823326, -0.0016606972785666585, 0.0234350748360157, -0.00460790004581213, 0.011589243076741695, 0.023805702105164528, -0.035665787756443024, -0.0271270964294672, 0.02979276515543461, 0.004661356098949909, -0.0015618037432432175, -0.025259703397750854, -0.04524508863687515, -0.03441135585308075, -0.03347053378820419, -0.018289051949977875, -0.005131768062710762, 0.06112506240606308, -0.01798969879746437, 0.003991375211626291, -0.041054144501686096, 0.04758289456367493, -0.020812170580029488, 0.03024892322719097, -0.008225084282457829, 0.008303485810756683, 0.0007376917055808008, 0.025901174172759056, -0.010548634454607964, -0.0073270248249173164, -0.004105414729565382, 0.024432919919490814, 0.03746190667152405, -0.014461607672274113, 0.004362002946436405, -0.029650216922163963, 0.006382636725902557, 0.018374580889940262, -0.030762100592255592, -0.010270664468407631, -0.02979276515543461, 0.02238021232187748, 0.05262913554906845, 0.03811763599514961, 0.0047647044993937016, 0.018260542303323746, 0.015181480906903744, -0.03081911988556385, -0.007533721160143614, -0.022836368530988693, -0.015010422095656395, -0.007273568771779537, 0.02702731266617775, -0.014924893155694008, 0.021638955920934677, 0.03746190667152405, 0.045387640595436096, 0.02852407842874527, -0.011211488395929337, -0.0037526055239140987, 0.04236559942364693, 0.020826425403356552, -0.02384846843779087, -0.015965500846505165, 0.019871346652507782, 0.015010422095656395, -0.00751233845949173, 0.019629012793302536, -0.022907642647624016, 0.02028474025428295, -0.016977600753307343, 0.0244186632335186, -0.010427468456327915, -0.00042096537072211504, -0.03703426197171211, -0.06243651360273361, 0.01528126560151577, -0.019999641925096512, 0.043791089206933975, -0.013192920945584774, -0.05536607652902603, -0.032330140471458435, -0.048979878425598145, -0.00650380365550518, -0.02228042669594288, 0.0043905130587518215, 0.025487782433629036, 0.022052349522709846, -0.03173143416643143, -0.015224246308207512, 0.009073251858353615, 0.017390992492437363, -0.0007800109451636672, -0.013606313616037369, -0.04062649980187416, 0.006632097531110048, -0.041054144501686096, 0.005627126432955265, 0.023064447566866875, 0.026371587067842484, -0.04610038548707962, -0.010092477314174175, -0.015095951966941357, 0.051688309758901596, 0.006354127079248428, -0.0075052110478281975, -0.005915788467973471, -0.01989985629916191, 0.050918545573949814, 0.005338464397937059, 0.002565884031355381, -0.04173838347196579, 0.025929685682058334, -0.03247268870472908, 0.010612782090902328, -2.5475086658843793e-05, -0.024276115000247955, 0.0035958015359938145, -0.01585146225988865, 0.014354696497321129, -0.0486377589404583, 0.01061990950256586, 0.013791627250611782, -0.011952743865549564, 0.042451128363609314, 0.010847987607121468, -0.02684199996292591, 0.015480834059417248, 0.018417345359921455, -0.007669142447412014, -0.01539530511945486, -0.007348407059907913, 0.015865717083215714, -0.02289338782429695, -0.051944900304079056, -0.007341279648244381, 0.008246466517448425, 0.023449329659342766, 0.01018513459712267, 0.013492274098098278, -0.02129683829843998, -0.03683469071984291, -0.02684199996292591, -0.01079096831381321, 0.029906805604696274, 0.015295520424842834, 0.014953402802348137, 0.017234187573194504, -0.04535913094878197, -0.0014263821067288518, 0.020455798134207726, -0.010120987892150879, -0.01136829238384962, 0.022308936342597008, 0.024874821305274963, -0.003173499833792448, 0.030477002263069153, 0.02374868281185627, 0.02028474025428295, 0.06500239670276642, 0.015338284894824028, 0.017832893878221512, -0.05217297747731209, -0.021610446274280548, -0.014910637401044369, 0.022294681519269943, -0.0003795370284933597, -0.01814650371670723, 0.009465261362493038, 0.022522760555148125, 0.06226545572280884, -0.025459272786974907, 0.03797508403658867, -0.03081911988556385, -0.0014869654551148415, -0.014497245661914349, -0.03030594252049923, 0.05431121587753296, 0.05097556486725807, 0.0351526141166687, -0.009935673326253891, -0.01954348385334015, -0.026856254786252975, -0.03577983006834984, -0.030163394287228584, 0.0020455799531191587, 0.03686320036649704, -0.04456085339188576, 0.013805882073938847, -0.05128917470574379, -0.04364854097366333, 0.03087613917887211, 0.028851941227912903, -0.03632151708006859, -0.05867321789264679, -0.02976425550878048, 0.009700467810034752, 0.01878797449171543, -0.008524437434971333, -0.01680654101073742, 0.006935014855116606, -0.07036224752664566, -0.020413033664226532, -0.028723647817969322, -0.057703882455825806, 0.0051638418808579445, -0.008075407706201077, -0.010627036914229393, -0.0016847524093464017, -0.0006423619925044477, -0.02976425550878048, -0.05374101921916008, 0.03902994841337204, 0.047925014048814774, -0.006346999667584896, -0.07486679404973984, 0.09362626075744629, -0.008310613222420216, 0.004860925022512674, -0.018003953620791435, 0.0594714917242527, -0.019586248323321342, -0.04826713353395462, 0.03629300743341446, -0.004547317046672106, 0.03575132042169571, 0.01951497420668602, 0.023991016671061516, 0.00975748710334301, -0.016735266894102097, 0.01788991503417492, -0.05345591902732849, -0.005673455074429512, -0.022993173450231552, -0.022166388109326363, 0.014368951320648193, 0.024105055257678032, -0.04287877678871155, -0.0008147573098540306, -0.06374796479940414, -0.008645604364573956, -0.0321020632982254, 0.03335649520158768, 0.019686033949255943, 0.03763296827673912, 0.10343363881111145, 0.03335649520158768, 0.040797557681798935, 0.010570017620921135, 0.03081911988556385, 0.014582774601876736, -0.011881468817591667, 0.05402611568570137, -0.01731971837580204, 0.00786158349364996, -0.02674221433699131, 0.01920136623084545, 0.004034140147268772, -0.00596924452111125, -0.002485700184479356, 0.033955201506614685, 0.001450437237508595, 0.03347053378820419, 0.03213057294487953, -0.03979971259832382, 0.009187290444970131, -0.009764614515006542, 0.027939626947045326, 0.037490420043468475, 0.008845172822475433, 0.0023574060760438442, -0.010634164325892925, 0.03441135585308075, 0.012587087228894234, -0.01716291345655918, 0.01897328719496727, 0.0052101705223321915, 0.0255020372569561, -0.009800251573324203, 0.03509559482336044, 0.028723647817969322, 0.00018609341350384057, 0.021795760840177536, -0.014076725579798222, 0.026799233630299568, -0.01674952171742916, -0.038915909826755524, -0.08364782482385635, -0.03740488737821579, -0.013955558650195599, 0.02689901925623417, -0.020641112700104713, 0.03492453321814537, -0.01431193109601736, -0.08627072721719742, 0.00205805292353034, 0.017120148986577988, 0.01747652143239975, -0.018132247030735016, 0.03364159166812897, 0.03255821764469147, 0.010498742572963238, 0.016949091106653214, -0.013299833051860332, 0.005409738980233669, -0.023249762132763863, 0.03797508403658867, -0.025858409702777863, 0.0029276025015860796, 0.006364818196743727, 0.04553018882870674, -0.0486377589404583, 0.011076066642999649, -0.027654528617858887, -0.008189447224140167, 0.018673934042453766, -0.023919742554426193, -0.010883625596761703, -0.014953402802348137, -0.007954240776598454, 0.0218100156635046, 0.02253701537847519, 0.0008708860259503126, 0.0038987183943390846, -0.03489602357149124, -0.024333134293556213, 0.02129683829843998, 0.005848077591508627, 0.009251438081264496, 0.024489939212799072, -0.024233350530266762, -0.01079096831381321, -0.0044938609935343266, 0.009600683115422726, 0.010235026478767395, -0.019714543595910072, 0.0010807005455717444, 0.04173838347196579, 0.006653480231761932, 0.009066123515367508, -0.029906805604696274, -0.01951497420668602, -0.021211309358477592, 0.007483828812837601, -0.012808037921786308, 0.009308457374572754, 0.016165070235729218, 0.011902851052582264, -0.03304288536310196, -0.007095382548868656, 0.05126066505908966, -0.027911117300391197, 0.03455390781164169, -0.009650574997067451, -0.02687050960958004, 0.008132426999509335, 0.003389105200767517, -0.02813919633626938, -0.03084762953221798, -0.028509823605418205, 0.02754049003124237, 0.02591542899608612, 0.007376916706562042, -0.008239339105784893, -0.021610446274280548, 0.02397676184773445, -0.012273479253053665, 0.012815166264772415, 0.024190586060285568, -0.01649293303489685, 0.01343525480479002, -0.017462266609072685, 0.015010422095656395, -0.005908661056309938, -0.003716968232765794, 0.0029632397927343845, -0.009892908856272697, -0.040540970861911774, 0.036749161779880524, -0.046528033912181854, -0.02088344655930996, -0.03652108460664749, -0.013834391720592976, -0.000377977907191962, 0.0004011421406175941, -0.014048215933144093, 0.006421837955713272, -0.054681841284036636, -0.009393987245857716, 0.01788991503417492, -0.04943603277206421, 0.03786104544997215, 0.03156037628650665, 0.0034158332273364067, 0.03438284620642662, 0.00898059457540512, -0.011753174476325512, -0.000494021805934608, 0.002448281040415168, -0.020954720675945282, 0.015894226729869843, -0.0016179324593394995, -0.01569465734064579, -0.03472496569156647, 0.013299833051860332, -0.03224461153149605, 0.0010432814015075564, -0.01811799220740795, -0.010356193408370018, -0.04669909179210663, -0.03250119835138321, -0.01378449983894825, 0.01817501336336136, 0.0475543849170208, 0.030362961813807487, -0.030362961813807487, -0.03814614564180374, -0.0015021113213151693, 0.01168190035969019, 0.005965680815279484, -0.022237662225961685, -0.02091195620596409, -0.020413033664226532, -0.023378055542707443, -0.00575542077422142, 0.005178096704185009, 0.02212362363934517, 0.013941303826868534, 0.00400206632912159, -0.006489548832178116, 0.009892908856272697, 0.016692502424120903, 0.0036332206800580025, 0.017946934327483177, 0.016507187858223915, 0.006482421420514584, -0.026129253208637238, -0.037518929690122604, -0.03900143876671791, -0.009379732422530651, -0.0634058490395546, 0.015110206790268421, -0.05813153088092804, -0.027554744854569435, 0.003424742491915822, 0.003763296641409397, 0.03295735642313957, 0.022565525025129318, -0.00736978929489851, -0.028994491323828697, 0.001972523517906666, -0.00929420255124569, 0.013763117603957653, -0.00030648059328086674, -0.00865985918790102, 0.03401222079992294, -0.03760445863008499, 0.03113272786140442, 0.0048395427875220776, -0.04752587527036667, -0.0401703417301178, -0.002161401091143489, 0.03378413990139961, -0.0028527642134577036, -0.008068280294537544, 0.015552109107375145, 0.012701126746833324, 0.02062685787677765, 0.029564687982201576, -0.035608768463134766, -0.03241566941142082, 0.02021346427500248, -0.04416171833872795, 0.010983409360051155, 0.001935104257427156, 0.03358457237482071, 0.015352539718151093, 0.008880809880793095, -0.025644587352871895, -0.022722329944372177, -0.035067081451416016, 0.0034532523714005947, -0.036720652133226395, -0.01977156288921833, 0.02947915717959404, -0.010049712844192982, -0.04045543819665909, -0.005245807580649853, -0.002241584938019514, 0.02330678142607212, -0.005181660410016775, 0.02537374384701252, 0.007590740453451872, -0.05619286373257637, -0.010876498185098171, 0.006457475014030933, -0.029821274802088737, 0.01268687192350626, -0.057960473001003265, 0.001829974353313446, 0.040483951568603516, -0.023991016671061516, 0.012793783098459244, 0.010798095725476742, -0.027939626947045326, -0.00538122933357954, 0.03059104084968567, 0.02655690163373947, 0.013221430592238903, -0.020484307780861855, -0.035865359008312225, 0.013827264308929443, 0.006029827520251274, 0.012537195347249508, 0.0034496886655688286, -0.00482172379270196, 0.02811068668961525, -0.005812440533190966, 0.021496407687664032, 0.011724664829671383, 0.004280037246644497, 0.022337447851896286, 0.0017079166136682034, 0.003121825633570552, -0.005281444638967514, 0.011610625311732292, 0.008859427645802498, -0.03438284620642662, 0.006660607643425465, 0.010235026478767395, -0.03024892322719097, -0.00566632766276598, 0.022708075121045113, 0.01125425286591053, 0.0560218021273613, -0.022864878177642822, 0.04610038548707962, -0.0394861064851284, -0.013442382216453552, -0.009935673326253891, -0.007918603718280792, -0.031018687412142754, -0.02253701537847519, -0.01010673213750124, -0.012173694558441639, -0.008617093786597252, -0.025416508316993713, -0.0038131889887154102, -0.015751678496599197, -0.009579300880432129, -0.015381050296127796, 0.010634164325892925, 0.015352539718151093, -0.005962117109447718, 0.006297107320278883, 0.008103917352855206, -0.010406085290014744, -0.12487302720546722, -0.019600503146648407, 0.033385004848241806, -0.00858145672827959, 0.03577983006834984, -0.011375419795513153, 0.015267010778188705, 0.04746885597705841, 0.003945047035813332, -0.009935673326253891, 0.04111116752028465, -0.022936154156923294, -0.010213644243776798, -0.01064841914921999, -0.0021079450380057096, -0.04501701146364212, -0.023064447566866875, -0.005709092132747173, 0.03252970799803734, -0.03894441947340965, -0.01024928130209446, 0.0011029738234356046, 0.0159512460231781, 0.009743232280015945, -0.020099425688385963, 0.0033303038217127323, -0.007433936465531588, 0.02511715516448021, -0.007547975983470678, 0.01018513459712267, -0.022679565474390984, -0.012138057500123978, 0.005705528426915407, 0.03378413990139961, -0.015609128400683403, -0.002086562803015113, -0.027583254501223564, -0.010213644243776798, -0.0013497619656845927, -0.02336380071938038, -0.016949091106653214, -0.034525398164987564, 0.041367754340171814, -0.009230055846273899, 0.014910637401044369, -0.035893868654966354, 0.016578461974859238, -0.0011065375292673707, -0.002166746649891138, 0.00573047436773777, 0.016450168564915657, 0.005274317227303982, 0.02480354718863964, 0.010327683761715889, 0.003724095644429326, 0.0078045642003417015, -0.005448940210044384, -0.009429624304175377, 0.024889076128602028, 0.034781984984874725, 0.032073549926280975, 0.03255821764469147, 0.023349545896053314, -0.03110421821475029, -0.039942264556884766, 0.0060868472792208195, -0.01597975566983223, 0.03686320036649704, -0.024105055257678032, -0.02900874614715576, -0.0319024920463562, 0.036977242678403854, 0.024276115000247955, -0.002198820235207677, 0.03931504860520363, 0.006446783896535635, -0.0020313248969614506, 0.03897292912006378, -0.04196646064519882, 0.017661835998296738, 0.04604336619377136, -0.05311380326747894, 0.035608768463134766, 0.0014994385419413447, -0.0425366573035717, 0.027269646525382996, 0.02240872196853161, -0.02501736953854561, -0.0013871811097487807, -0.008709751069545746, 0.041339244693517685, 0.01396268606185913, 0.005402611568570137, 0.005816004239022732, -0.0025106463581323624, -0.00964344758540392, 0.0005091676139272749, 0.010349065996706486, 0.01499616727232933, 0.022323191165924072, 0.031246766448020935, 0.00877389870584011, 0.027269646525382996, -0.02302168309688568, 0.015238501131534576, -0.0049678366631269455, 0.014269166626036167, -0.02607223391532898, -0.003613620065152645, 0.011738919652998447, 0.026727959513664246, 0.026057979092001915, -0.00046283917617984116, 0.005270753521472216, -0.009686212986707687, 0.023948252201080322, -0.011339782737195492, -0.018488621339201927, 0.023264016956090927, -0.04008481279015541, 0.010562889277935028, -0.00898059457540512, -0.01744801178574562, -0.011403929442167282, 0.00139252666849643, 0.025131409987807274, -0.013634823262691498, 0.0019297586986795068, -0.010142370127141476, -0.006614279001951218, 0.01039183046668768, 0.01153935119509697, -0.00776892714202404, 0.022109368816018105, -0.009301329962909222, 0.0011368292616680264, 0.02263680100440979, -0.02372017316520214, 0.020555583760142326, 0.022166388109326363, -0.00535628292709589, -0.007063308730721474, 0.01677803136408329, 0.007954240776598454, -0.0060868472792208195, -0.005691273603588343, -0.019158601760864258, -0.004105414729565382, -0.042166028171777725, 0.04960709437727928, -0.015438069589436054, 0.010256408713757992, 0.006746137049049139, 0.03156037628650665, -0.0035601642448455095, 0.01982858218252659, 0.002428680658340454, -0.007391171995550394, 0.02015644498169422, 0.029137039557099342, -0.009550791233778, 0.03666363283991814, 0.011325527913868427, 0.009194417856633663, 0.027497725561261177, -0.00886655505746603, -0.02785409800708294, -0.0023199869319796562, 0.010178007185459137, 0.03187398239970207, -0.011175851337611675, -0.015495088882744312, 0.03657810389995575, 0.024746527895331383, 0.024660997092723846, 0.0028884015046060085, 0.024874821305274963, -0.015238501131534576, 0.015095951966941357, 0.038602299988269806, -0.02588691934943199, -0.0029970952309668064, -0.0007051726570352912, 0.025430763140320778, 0.02206660434603691, 0.023734427988529205, 0.02250850573182106, 0.019272640347480774, 0.014910637401044369, 0.004101851023733616, 0.011040429584681988, 0.02493184059858322, 0.007384044583886862, 0.006101102102547884, 0.0019849964883178473, -0.009949928149580956, 0.036948733031749725, 0.00969334039837122, -0.024233350530266762, -0.005869459826499224, -0.015238501131534576, 0.05505247041583061, 0.0030024407897144556, -0.0004966945853084326, -2.9372913559200242e-05, 0.008125299587845802, 0.005951425526291132, -0.020413033664226532, 0.005113949533551931, 0.010413212701678276, -0.02565884217619896, -0.00566632766276598, -0.006628533825278282, 0.015124461613595486, -0.01282942108809948, -0.0004345520865172148, 0.024561213329434395, 0.013021862134337425, -0.010541507042944431, -0.03555174916982651, -0.02950766682624817, 0.0017453357577323914, -0.03002084419131279, 0.02999233454465866, -0.03734786808490753, -0.00676395557820797, -0.0024696635082364082, -0.02186703495681286, 0.005851641297340393, 0.00482172379270196, -0.004807468969374895, -0.011567860841751099, 0.002977494616061449, -0.005185224115848541, -0.031275276094675064, -0.009130271151661873, -0.021353857591748238, 0.0006374618387781084, -0.0017595906974747777, 3.858849231619388e-05, 0.023121466860175133, 7.210981129901484e-05, -0.0237771924585104, -0.004158870317041874, -0.009479516185820103, 0.009287075139582157, 0.01473957858979702, 0.01925838552415371, -0.015737421810626984, -0.025102900341153145, -0.008310613222420216, 0.009301329962909222, 0.03868783265352249, 0.005926479585468769, 0.009543663822114468, 0.006029827520251274, 0.04230858013033867, 0.06026976928114891, 0.020840682089328766, 0.02547352761030197, -0.030733590945601463, 0.010847987607121468, -0.024946095421910286, -0.029279589653015137, 0.010242153890430927, -0.0180182084441185, -0.03446837514638901, 0.010719694197177887, -0.005049802362918854, 0.006425401661545038, 0.0040163216181099415, 0.024618232622742653, 0.012109547853469849, 0.027640273794531822, -0.011225743219256401, 0.002532028825953603, 0.01093351747840643, -0.01111170370131731, -0.009515153244137764, -0.03079061023890972, -0.005252934992313385, -0.021282583475112915, -0.01623634435236454, 0.02307870239019394, -0.0036706398241221905, -0.012579959817230701, -0.026186272501945496, -0.015195735730230808, 0.024775037541985512, -0.0069100684486329556, 0.008089662529528141, 0.016592716798186302, 0.027469215914607048, -0.0031841909512877464, -0.026129253208637238, -0.0058837151154875755, 0.015894226729869843, -0.008994849398732185, 0.012309116311371326, -0.05148874223232269, 0.013584931381046772, 0.003756169229745865, 0.025316722691059113, -0.016307618468999863, 0.027112841606140137, 0.00028843924519605935, 0.017376737669110298, -0.04176689311861992, -0.0056413812562823296, 0.0010994101176038384, -0.03033445216715336, 0.004059086088091135, 0.011532223783433437, 0.0031182619277387857, 0.011924234218895435, -0.010855115018785, -0.0017845367547124624, -0.03292884677648544, -0.008716878481209278, -0.021254073828458786, -0.023648899048566818, 0.03857379034161568, 0.00800413265824318, 0.017433756962418556, 0.0033659411128610373, -0.03030594252049923, 0.016407404094934464, -0.0060583376325666904, -0.01843160018324852, 0.004721939563751221, -0.0049678366631269455, 6.024927643011324e-05, 0.010862242430448532, 0.05106109380722046, -0.014867872931063175, 0.010548634454607964, -0.06038380786776543, -0.02088344655930996, -0.015338284894824028, -0.023064447566866875, 0.04772544652223587, 0.009650574997067451, -0.009529408998787403, -0.01636463962495327, -0.02979276515543461, 0.04042692855000496, 0.025031626224517822, -0.022936154156923294, 0.003615401918068528, -0.014062470756471157, 0.07691950350999832, 0.004215890076011419, -0.04208049923181534, 0.007098946254700422, -0.009165908209979534, 0.025445017963647842, -0.02225191704928875, -0.00283316383138299, -0.05599329248070717, -0.0011715756263583899, -0.006279288791120052, 0.01453288272023201, 0.03503857180476189, 0.009885781444609165, -0.012387518770992756, -0.006856612395495176, -0.010669801384210587, 0.00467917462810874, 0.012038272805511951, 0.008531564846634865, -0.013870029710233212, 0.010484487749636173, 0.015366795472800732, -0.0002810890437103808, 0.011375419795513153, 0.04205198958516121, -0.005096131004393101, 0.02374868281185627, 0.01652144268155098, 0.05565117672085762, -0.004721939563751221, -0.01786140538752079, -0.016036774963140488, -0.018060972914099693, 0.021482152864336967, 0.014825108461081982, -0.010149497538805008, 0.049806661903858185, 0.009194417856633663, -0.02785409800708294, 0.012530067935585976, 0.05328486114740372, 0.031189747154712677, -0.021824270486831665, -0.0122592244297266, -0.021496407687664032, -0.020869191735982895, 0.0065073673613369465, -0.008538692258298397, 0.011418184265494347, -0.004825287498533726, -0.004180253017693758, 0.01626485399901867, -0.00843890756368637, -0.013050371780991554, 0.018189268186688423, -0.014147999696433544, 0.04618591442704201, 0.015224246308207512, -0.009508025832474232, -0.020669622346758842, -0.0022932589054107666, -0.016165070235729218, -0.010512997396290302, -0.029935315251350403, -0.05453929305076599, -0.006215141620486975, 0.009415369480848312, -0.028124941512942314, 0.002637158613651991, -0.03184547275304794, 0.023705918341875076, -0.00522086163982749, -0.03757594898343086, -0.0005265407962724566, 0.01099766418337822, -0.017590561881661415, 0.023378055542707443, 0.057219214737415314, 0.016250599175691605, -0.009885781444609165, -0.003966429270803928, -0.004622155334800482, 0.0057340385392308235, 0.0040733409114181995, -0.016735266894102097, 0.03141782432794571, -0.007719034794718027, -0.018730953335762024, 0.0255020372569561, -0.022152133285999298, 0.01254432275891304, 0.007954240776598454, 0.010113859549164772, -0.006332744844257832, -0.013934176415205002, -0.02632882259786129, 0.007098946254700422, 0.04122520610690117, -0.010669801384210587, -0.000451925239758566, 0.01018513459712267, -0.015309775248169899, -0.035637278109788895, -0.016321873292326927, -0.003684894647449255, -0.03512410447001457, -0.014682559296488762, 0.011724664829671383, 0.0024179895408451557, 0.017904169857501984, 0.011382547207176685, 0.03503857180476189, 0.02591542899608612, -0.0033035757951438427, 0.02406229078769684, 0.003542345715686679, 0.03418327867984772, -0.013328342698514462, -0.029906805604696274, 0.03575132042169571, 0.028866196051239967, 0.00996418297290802, 0.008267848752439022, -0.0017284080386161804, 0.00037085043732076883, -0.003531654365360737, 0.0008276758017018437, 0.004294292069971561, 0.01716291345655918, -0.04664207249879837, -0.01179593987762928, 0.0317029245197773, 0.02129683829843998, 0.0008508400642313063, 0.011154468171298504, -0.0043691303580999374, -0.007811691612005234, -0.019557738676667213, -0.009486643597483635, -0.003134298836812377, 0.01913009211421013, -0.004262218717485666, -0.03107570856809616, 0.015309775248169899, 0.01887350343167782, -0.010427468456327915, 0.0011626662453636527, 0.00470412103459239, 0.014083852991461754, -0.01992836594581604, -0.042422618716955185, 0.027740059420466423, 0.02302168309688568, 0.011275635100901127, -0.013649078086018562, 0.009479516185820103, -0.010484487749636173, 0.01626485399901867, -0.008331996388733387, 0.02578713558614254, -0.02431887947022915, 0.0039236643351614475, 0.019914111122488976, 0.031018687412142754, -0.023677408695220947, -0.04310685396194458, 0.012458792887628078, 0.03746190667152405, -0.012366136536002159, 0.015936991199851036, 0.01079096831381321, 0.009935673326253891, 0.004126796964555979, -0.009401114657521248, -0.01719142310321331, -0.018802229315042496, 0.01153935119509697, -0.05014878138899803, 0.04441830515861511, 5.117290493217297e-05, -0.021610446274280548, 0.02317848615348339, 0.006457475014030933, -0.01165339071303606, -0.011874341405928135, -0.004230144899338484, 0.01071256585419178, -0.01579444296658039, 0.005887278821319342, 0.022237662225961685, -0.004868052434176207, -0.009714722633361816, -0.0029792767018079758, 0.018132247030735016, 0.047383327037096024, 1.4080901564739179e-05, 0.03079061023890972, 0.016307618468999863, 0.010805223137140274, -0.019857091829180717, 0.01321430318057537, -0.021596191450953484, -0.02235170267522335, 0.007483828812837601, 0.02356337010860443, 0.013335470110177994, -0.01410523522645235, -0.0031129163689911366, 0.009023359045386314, 0.025045881047844887, 0.015252755954861641, -0.01610805094242096, 0.024746527895331383, -0.01776161976158619, -0.026314567774534225, 0.009921418502926826, 0.005227989051491022, -0.019529229030013084, -0.05844513699412346, 0.007016980554908514, 0.017590561881661415, 0.025701606646180153, 0.005096131004393101, 0.00010206739534623921, 0.0019707416649907827, 0.01370609737932682, 5.392922685132362e-05, 0.01384864654392004, -0.002868801122531295, -0.02327827177941799, -0.010983409360051155, -0.010634164325892925, -0.025031626224517822, -0.006849484983831644, -0.015908481553196907, -0.012530067935585976, -0.005758984480053186, 0.006667735055088997, 0.02979276515543461, -0.00676395557820797, -0.005972808226943016, 0.014333314262330532, 0.00313608068972826, -0.022907642647624016, 0.030705079436302185, 0.0051353322342038155, 0.015124461613595486, -0.036435555666685104, -0.016977600753307343, 0.025487782433629036, 0.03509559482336044, -0.017832893878221512, -0.016535697504878044, 0.023477839305996895, -0.022494250908493996, 0.008075407706201077, -0.007683397736400366, 0.02798239141702652, 0.016421658918261528, -0.045986346900463104, -0.00582669535651803, 0.018930522724986076, -0.003278629621490836, 0.003463943488895893, 0.032586727291345596, -0.019885601475834846, 0.0163931492716074, -0.04806756228208542, 6.219818897079676e-05, -0.008153809234499931, 0.0034550342243164778, 0.010805223137140274, -0.043277911841869354, 0.01488212775439024, 0.02111152373254299, -0.03113272786140442, 0.032615236937999725, -0.014768089167773724, -0.032643746584653854, 0.03275778889656067, 0.021767251193523407, 0.0007626377628184855, -0.009550791233778, 0.01335685234516859, 0.01007822249084711, 0.008396143093705177, 0.00996418297290802, 0.047326307743787766, 0.0016250599874183536, 0.008189447224140167, -0.000668198976200074, 0.015780188143253326, 0.004404767882078886, -0.01817501336336136, 0.00961493793874979, -0.005979935638606548, 0.00019288677140139043, -0.0007626377628184855, 0.011225743219256401, -0.002168528502807021, -0.029365118592977524, -0.015523599460721016, -0.002612212672829628, 0.038915909826755524, 0.022864878177642822, -0.002913347678259015, 0.020840682089328766, 0.006140303332358599, 0.024660997092723846, -0.012038272805511951, 8.262001756520476e-06, 0.03136080503463745, 0.02976425550878048, 0.001600113813765347, 0.031759943813085556, -0.028737902641296387, 0.014810853637754917, 0.01249442994594574, 0.00751233845949173, -0.00898059457540512, 0.0029792767018079758, -0.016635481268167496, -0.013777372427284718, 0.02632882259786129, -0.04042692855000496, -0.014575647190213203, 0.031189747154712677, 0.010641291737556458, -0.008317740634083748, 0.027996646240353584, -0.014582774601876736, 0.04122520610690117, 0.0016981164226308465, 0.00783307384699583, -0.01904456317424774, 0.009344094432890415, 0.01935817115008831, 0.02922256849706173, 0.0009016231633722782, -0.020427288487553596, 0.035865359008312225, -0.01977156288921833, -0.02069813199341297, 0.013941303826868534, -0.0021043813321739435, -0.008588584139943123, 0.00559505308046937, -0.028067922219634056, -0.017262699082493782, 0.02922256849706173, 0.03706277161836624, 0.027169862762093544, 0.018759464845061302, -0.012416028417646885, 0.013285578228533268, -0.02075515128672123, 0.0027725803665816784, -0.029678726568818092, -0.002603303175419569, -0.035865359008312225, -0.022494250908493996, 0.010056840255856514, 0.01788991503417492, -0.009850144386291504, 0.002986404113471508, -0.019187111407518387, 0.015765933319926262, -0.003463943488895893, -0.009885781444609165, -0.0076263779774308205, 0.013698969967663288, 0.011503714136779308, -0.0040163216181099415, 0.016507187858223915, 0.009921418502926826, 0.005488140974193811, 0.0053598470985889435, 0.014098107814788818, -0.0005657417932525277, 0.02601521462202072, -0.017847150564193726, 0.026286058127880096, -0.009108888916671276, -0.03389818221330643, 0.01884499378502369, -0.0218100156635046, 0.029251080006361008, -0.020797915756702423]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
" layers and incorporate their
scheme in our setup. In Table 1, we observe that we were
able to replicate results for OPT-66B. Furthermore, CHAI
is also able to match the accuracy of MHA for OPT-66B.
Next, we compare CHAI ,CHAI -static and DEJAVUwith
the pre-trained MHA network, using LLAMA-7B on 5 dif-
ferent datasets. For DEJAVUwe used three configurations,
50% sparsity, 30% sparsity and 10% sparsity. In Table 2,
we observe that when we use DEJAVUwith more 10% spar-
sity we see significant decrease in accuracy (by 18.6% for
DEJAVU-30%). On the other hand, our method based on our
close analysis of the behaviour of layers of LLAMA-7B is
able to recover accuracy. We observe a maximum accuracy
degradation of 3.7% for CHAI . Similarly for LLAMA-33B
using sparsity for more than 10% leads to significant accu-
racy drop, meanwhile CHAI closely matches the accuracy
of the pre-trained model using MHA with maximum degra-
dation in accuracy by 0.14%. This shows that CHAI is
widely applicable across multiple datasets and models. We
also want to highlight that we do not perform any dataset
specific tuning.
4.3. Reduction in K,V Cache Memory Requirement
In this section, we study the memory capacity reduction
achieved by use of CHAI due to reduction in K,V cache
size. In Figure 11, we show that for LLAMA-7B CHAI
reduces the size of K,V cache by up to 21.4% compared to
MHA. Even for comparatively small models like LLAMA-
7B, the size of the K,V cache for a sequence length of
2048 is around 1.2 GB, while around 12 GB is used for the
7
Runtime Clustered Head Attention for Efficient Inference
128 256 512 1024 2048
Sequence Length0100200300400500K,V Cache Size (MB)CHAI
CHAI-static
MHA
Figure 11. Memory Savings : We observed that for LLAMA-7B
CHAI provides memory savings of up to 21.4%.
128 256 512 1024 2048
Sequence Length102103Time(ms)Time CHAI
Time MHA
(a)Time to first token: We ob-
serve speedups of upto 1.73 ×
for sequence length of 2048.
128 256 512 1024 2048
Sequence Length102103Time(ms)Time CHAI
Time MHA(b)Time to next token: We ob-
serve a speedup of upto 5×for
sequence length of 2048.
Figure 12. Latency Analysis: We observe that the speedups pro-
vided by CHAI increases as the sequence length becomes larger.
Even for a comparatively small model like LLAMA-7B we ob-
serve speedups of up to 1.73 ×for a large sequence length.
model weights. A reduction in K,V cache size can enable
use of larger context length or serving more requests. We
would also like to note that as shown in Figure 3, CHAI
only removes the keys associated with redundant heads and
keeps all the value vectors.
4.4. End-to-End Latency
Next, we evaluate time to first token and time to next token
comparing it with MHA. These are two standard metrics
used for evaluation of an LLM. Time to first token evaluates
the time for generating a first token given a new context.
Time to first token accounts for generating K,V caches for
all the tokens in the context. Whereas time to next token
evaluates the time for generating the next token, assuming
the K,V caches for all internal tokens is available.
Time to first token. Next, in our experiments we com-
pare the speedups provided by CHAI . In Figure 12-(a) for
LLAMA-7B we show that our method provides speedup of
up to 1.72×on a sequence length of 2048. The execution
times represented in this figure accounts for the overhead of
clustering in CHAI.
Time to next token. Another metric for evaluation of LLMs
is time to next token. We do not account for the overhead
of clustering in the case of time to next token. Our primary
wins come from reducing compute and reducing memory
bandwidth requirement for performing time to next token.
1 2 3 4","[0.004613344557583332, 0.023123105987906456, 0.05906142666935921, -0.030698144808411598, 0.039692673832178116, 0.0009419050184078515, 0.04773203283548355, 0.02767343632876873, 0.0013506719842553139, 0.0198994018137455, -0.002072854433208704, -0.0186125747859478, -0.05378144979476929, 0.02011166326701641, -0.008875133469700813, -0.027487708255648613, 0.015110279433429241, -0.030645079910755157, 0.016397107392549515, 0.02195567451417446, -0.02474159002304077, 0.027991825714707375, 0.004407717380672693, 0.04359295591711998, 0.0474667064845562, -0.0224465262144804, 0.012417227029800415, -0.014513297006487846, 0.02224753238260746, -0.027355045080184937, 0.009618044830858707, -0.038339514285326004, -0.03380244970321655, -0.016344042494893074, -0.0007462275680154562, 0.07407884299755096, -0.024409933015704155, -0.004212039988487959, -0.02693052403628826, -0.006789012812077999, -0.016887959092855453, 0.004301587585359812, -0.060494184494018555, -0.0017080319812521338, -0.003800785867497325, 0.009094026871025562, 0.02249959111213684, 0.02368028834462166, -0.0238792821764946, 0.05508154630661011, -0.05409984290599823, 0.05439170077443123, -0.055665262043476105, 0.018572775647044182, -0.003172296332195401, -0.012423859909176826, 0.034014713019132614, 0.02418440766632557, 0.018042124807834625, -0.013903048820793629, 0.02020452730357647, -0.02971644140779972, 0.001875518704764545, -0.01955447904765606, -0.03897629678249359, -0.00638439180329442, -0.04353989288210869, 0.002263556933030486, 0.023348631337285042, 0.014725557528436184, -0.011329392902553082, 0.050093427300453186, 0.02955724485218525, -0.020536182448267937, -0.037145551294088364, -0.000951854744926095, -0.01926262117922306, 0.008191920816898346, 0.029689908027648926, 0.02165054902434349, 0.009047594852745533, 0.0034293304197490215, 0.04308883845806122, -0.017790066078305244, 0.03703942149877548, -0.04300924018025398, -0.03319220244884491, -0.0021425022277981043, -0.053728386759757996, -0.012927978299558163, -0.010380854830145836, 0.0608125738799572, -0.018838100135326385, 0.016038918867707253, 0.03388204798102379, 0.03470455855131149, 0.01736554503440857, -0.03364325687289238, 0.0023083307314664125, 0.041921406984329224, 0.02801835909485817, 0.015733793377876282, 0.020642314106225967, -0.015269475057721138, 0.053622256964445114, -0.02762036956846714, 0.004042895045131445, 0.008994529955089092, -0.05142005532979965, -0.023600691929459572, -0.020522916689515114, 0.008185287937521935, -0.07848324626684189, 0.0301144290715456, -0.02722238190472126, -0.019979000091552734, -0.04024985805153847, -0.002850589342415333, -0.016436906531453133, 0.010699245147407055, -0.03470455855131149, -0.014937818050384521, 0.04422973841428757, -0.024595661088824272, 0.0032104370184242725, -0.02796529419720173, 0.03595158830285072, -0.06463325768709183, -0.030273623764514923, -0.020536182448267937, 0.012808581814169884, 0.036004651337862015, 0.040992770344018936, -0.030247092247009277, 0.013000942766666412, -0.026506002992391586, -0.01617158018052578, 0.0056713297963142395, -0.06102483347058296, -0.010035932064056396, -0.0001085139301721938, -0.062086135149002075, 0.016052184626460075, 0.024569129571318626, -0.030300157144665718, 0.030936937779188156, -0.036853693425655365, -0.010606381110846996, -0.044468529522418976, 0.03244929388165474, -0.014659225940704346, -0.03818032145500183, -0.02005859836935997, -0.006924991961568594, -0.05688575655221939, 0.0012005972675979137, -0.03621691092848778, -0.0014294404536485672, 0.013253001496195793, -0.05778786540031433, 0.014022445306181908, -0.009671109728515148, 0.02976950630545616, -0.015242942608892918, 0.007594938389956951, 0.012463659048080444, -0.062086135149002075, 0.014460232108831406, -0.08506330847740173, -0.07429110258817673, 0.0022950645070523024, -0.012828481383621693, -0.029477648437023163, -0.0755646601319313, 0.017179816961288452, -0.04807695746421814, -0.018639106303453445, -0.00487866997718811, 0.010659446939826012, -0.02293737791478634, -0.020071864128112793, 0.06951524317264557, -0.008284784853458405, 0.03940081596374512, -0.07312367111444473, 0.0035852089058607817, 0.005346306134015322, 0.027806097641587257, 0.025564098730683327, 0.0491647906601429, 0.014009179547429085, 0.04982810467481613, 0.04353989288210869, 0.010400754399597645, 0.005127412732690573, -0.01525620836764574, 0.04900559410452843, 0.030724676325917244, 0.006759163457900286, -0.011070700362324715, 0.016304243355989456, 0.03141452372074127, 0.02846941165626049, -0.07238075882196426, 0.04200100526213646, -0.0059897201135754585, -0.03170638158917427, -0.030777743086218834, -0.007581672165542841, 0.007979660294950008, 0.014592895284295082, -0.022406727075576782, 0.05476315692067146, -0.03948041424155235, -0.05200377106666565, -0.011760546825826168, -0.06394341588020325, -0.004092643968760967, 0.010241558775305748, 0.00042700799531303346, 0.01363772340118885, 0.04030292108654976, 0.015760326758027077, 0.02812448889017105, -0.046564601361751556, 0.019196290522813797, -0.010447186417877674, -0.0403294563293457, 0.029079660773277283, -0.031573716551065445, 0.020575981587171555, 0.01851971074938774, -0.03268808498978615, -0.0018655689200386405, 0.010513518005609512, -0.0756177306175232, 0.012748884037137032, -0.009637943468987942, 0.007263281848281622, -0.03335139900445938, -0.000725084450095892, 0.02119949646294117, 0.012815214693546295, 0.016861427575349808, -0.007661269977688789, 0.011057434603571892, -0.02926538698375225, -0.048554543405771255, 0.04913825914263725, 0.005134045612066984, -0.018042124807834625, -0.041178494691848755, -0.04555636644363403, -0.041921406984329224, -0.030963469296693802, 0.015136811882257462, 0.0016035601729527116, 0.060547247529029846, -1.5999845345504582e-05, 0.011554919183254242, -0.01702062226831913, 0.02174341306090355, -0.0019584328401833773, 0.016834894195199013, -0.017843130975961685, -0.018532976508140564, -0.028734736144542694, 0.02054945006966591, -0.034014713019132614, -0.005900172982364893, 0.023507827892899513, 0.0037410876248031855, 0.014553096145391464, -0.00985020399093628, -0.014354102313518524, -0.03672103211283684, 0.012848380953073502, -0.004444200079888105, -0.016344042494893074, 0.02214140072464943, -0.02009839564561844, 0.025205910205841064, 0.058902230113744736, 0.04422973841428757, -0.004132442642003298, -0.0051804776303470135, 0.03698635473847389, -0.012602955102920532, -0.006580069195479155, -0.042876578867435455, 0.007044388446956873, -0.013823451474308968, 0.01568072848021984, -0.024754855781793594, 0.022035270929336548, 0.05433863401412964, 0.01363772340118885, 0.013226469047367573, -0.02577635832130909, 0.025471234694123268, 0.03818032145500183, 0.0002454259665682912, -0.030273623764514923, -0.018453378230333328, 0.01920955628156662, 0.04972197487950325, -0.005528717301785946, 0.013292800635099411, -0.012125369161367416, 0.03473109006881714, -0.0012047429336234927, -0.009783872403204441, -0.0022104920353740454, 0.01652977056801319, -0.02836328186094761, -0.024502797052264214, 0.030990002676844597, -0.047705501317977905, 0.03672103211283684, -0.0008540159906260669, -0.0409131720662117, -0.027195850387215614, -0.037543538957834244, -0.016503237187862396, 0.016489971429109573, -0.0009584878571331501, 0.013000942766666412, 0.014075510203838348, -0.012430493719875813, -0.02364048920571804, 0.012470291927456856, 0.00925985537469387, 0.0007578355725854635, 0.0012072303798049688, -0.03987840190529823, -0.022181199863553047, -0.03000829927623272, -0.011806978844106197, 0.0271295178681612, 0.028946997597813606, -0.06235146149992943, -0.014486764557659626, -0.03149412199854851, 0.06521697342395782, 0.014791889116168022, -0.0037742534186691046, 0.012861646711826324, -0.004115859512239695, 0.049748506397008896, 0.005492235068231821, -0.008861866779625416, -0.02488751895725727, 0.010274725034832954, -0.0585307739675045, -0.0020977286621928215, -0.0031490803230553865, -0.0029517447110265493, -0.031732913106679916, -0.019846336916089058, 0.013392297551035881, -0.06357195973396301, -0.0012544915080070496, 0.016834894195199013, 0.002938478486612439, 0.020589247345924377, 0.005674646236002445, -0.014937818050384521, 0.03369631990790367, 0.008808801881968975, -0.014553096145391464, -0.005170527845621109, -0.01087834034115076, 0.0035852089058607817, -0.04086010530591011, -0.062086135149002075, 0.012503458186984062, -0.0019385333871468902, 0.013451996259391308, -2.2762533262721263e-05, 0.03359019011259079, -0.010261458344757557, -0.017577804625034332, -0.0016640875255689025, -0.0010637888917699456, 0.052826281636953354, -0.004815655294805765, -0.013969380408525467, -0.009173624217510223, -0.05476315692067146, 0.010712511837482452, -0.0035719426814466715, 0.008384281769394875, -0.012138635851442814, 0.0346514917910099, 0.0019766739569604397, -0.011243162676692009, 0.032369695603847504, 0.018546242266893387, 0.03953348100185394, 0.04255818948149681, 0.041523419320583344, 0.005409320816397667, -0.03971920534968376, -0.013836718164384365, -0.00386380054987967, 0.002603505039587617, 0.006410924252122641, -0.009246588684618473, 0.00017422341625206172, 0.04903212562203407, 0.06266985088586807, -0.024754855781793594, 0.014075510203838348, -0.04483998566865921, 0.030592015013098717, -0.005555249750614166, -0.039241623133420944, 0.050597548484802246, 0.044017478823661804, 0.022075070068240166, 0.007926595397293568, -0.025895755738019943, -0.050491414964199066, -0.009399151429533958, -0.029000062495470047, 0.016410373151302338, 0.050836339592933655, -0.03239622712135315, 0.002208833582699299, -0.05784092843532562, -0.05062408000230789, 0.0338289849460125, 0.027832631021738052, -0.012782049365341663, -0.05147312209010124, -0.0037046053912490606, 0.00668288255110383, 0.04184180870652199, -0.006845394615083933, -0.025258975103497505, -0.0056215813383460045, -0.04109890013933182, -0.01747167482972145, -0.052269097417593, -0.04499918222427368, -0.0004522968374658376, -0.03932121768593788, -0.02188934199512005, 0.023547625169157982, -0.0016350675141438842, -0.002412802539765835, -0.024250738322734833, 0.02836328186094761, 0.07004589587450027, -0.028495943173766136, -0.07678516209125519, 0.10098282992839813, -0.04022332653403282, 0.02199547179043293, -0.02767343632876873, 0.02950417995452881, -0.02926538698375225, -0.028734736144542694, 0.019435083493590355, -0.007157151587307453, 0.016237912699580193, 0.04056824743747711, 0.00793986115604639, 0.03274115175008774, -0.00980377197265625, 0.024104809388518333, -0.054179441183805466, 0.009253222495317459, -0.04388481378555298, -0.052428290247917175, 0.00674258079379797, 0.027434643357992172, -0.07917308807373047, 0.007754133548587561, -0.051234327256679535, 0.01375711988657713, -0.009691009297966957, 0.0060892170295119286, -0.005246809218078852, 0.016649166122078896, 0.0750340148806572, 0.06182080879807472, 0.013392297551035881, 0.04056824743747711, 0.007322980090975761, -0.003969930578023195, -0.013272901065647602, 0.04813002049922943, -0.014699025079607964, 0.00813222210854292, -0.01298767700791359, 0.004092643968760967, 0.014446966350078583, 0.013345865532755852, -0.016609366983175278, 0.00945884920656681, -1.971802703337744e-05, 0.03496988117694855, 0.02289757877588272, -0.05075674131512642, 0.02134542539715767, 0.002029739087447524, 0.014208173379302025, 0.0135647589340806, 0.003412747522816062, -0.0036581733729690313, 0.020920904353260994, 0.024608926847577095, 0.04306230694055557, -0.021279094740748405, 0.028310216963291168, 0.011992706917226315, 0.00492510199546814, -0.0020993868820369244, 0.03619037941098213, 0.038923230022192, 0.005266708321869373, 0.008105689659714699, -0.015070480294525623, 0.01637057587504387, -0.008749104104936123, -0.03075120970606804, -0.08516944199800491, -0.027355045080184937, -0.0187585037201643, 0.037198614329099655, -0.03390858322381973, 0.0032336527947336435, 0.021027036011219025, -0.05460396036505699, 0.014168374240398407, 0.010858440771698952, -0.017405344173312187, -0.02498038299381733, 0.02418440766632557, 0.03075120970606804, 0.02159748412668705, 0.02110663242638111, 0.005157261621206999, 0.007004589773714542, -0.02253939025104046, 0.005193743854761124, -0.008430713787674904, 0.02020452730357647, 0.018692171201109886, 0.02175668068230152, -0.04070091247558594, 0.03223703056573868, -0.005293241236358881, -0.020629046484827995, 0.0335371270775795, -0.0028787802439182997, -0.0181747879832983, -0.007449009455740452, -0.00920679047703743, 0.013717321678996086, 0.01752473972737789, 0.0019103426020592451, -0.010818641632795334, -0.03876403719186783, 0.021663816645741463, 0.03319220244884491, 0.010142061859369278, 0.004543696995824575, 0.01633077673614025, -0.012125369161367416, -0.01611851528286934, 0.0275673046708107, -0.011753913946449757, 0.018692171201109886, -0.01301420945674181, 0.017737001180648804, 0.05338346213102341, 0.006188713945448399, 0.03075120970606804, -0.031785979866981506, 0.002071196213364601, -0.04064784571528435, -0.017657402902841568, -0.02423747256398201, 0.023812951520085335, -0.025365104898810387, -0.0064474064856767654, -0.031732913106679916, -0.0036017918027937412, 0.02732851170003414, -0.03170638158917427, 0.04266431927680969, -0.0042551555670797825, -0.02617434784770012, 0.0060892170295119286, -0.0196075439453125, -0.039639610797166824, -0.010573215782642365, -0.04223979637026787, 0.01602565124630928, 0.0312553271651268, -0.00582389160990715, -0.0070841871201992035, -0.012410594150424004, 0.028151020407676697, -0.039294686168432236, 0.020695379003882408, 0.01911669224500656, -0.023149637505412102, 0.011946274898946285, -0.014048977755010128, 0.022419992834329605, -0.023653756827116013, -0.013929581269621849, 0.01682162843644619, -0.021836277097463608, -0.04181527718901634, 0.025166111066937447, -0.029185790568590164, 0.00801282562315464, -0.010851806960999966, 0.005963187664747238, -0.010679345577955246, 0.009266488254070282, 0.0011541653657332063, -0.013597925193607807, -0.06399647891521454, -0.031679850071668625, 0.005362888798117638, -0.03993146866559982, 0.016237912699580193, 0.0009551713010296226, -0.0005269196117296815, 0.03727821260690689, 0.021279094740748405, -0.008808801881968975, 0.02458239533007145, -0.01117683108896017, -0.018877899274230003, 0.008351115509867668, 0.01146868895739317, -0.012961143627762794, -0.03637610748410225, 0.01333923265337944, -0.01087834034115076, 0.019687142223119736, -0.021478088572621346, -0.021172964945435524, -0.036853693425655365, -0.03584545850753784, -0.029689908027648926, 0.036402639001607895, 0.03971920534968376, 0.035155609250068665, -0.04258472099900246, -0.0013515010941773653, 0.015906255692243576, 0.03512907773256302, 0.0098767364397645, -0.003976563923060894, -0.021265827119350433, -0.03300647437572479, -0.026187613606452942, 0.012178434059023857, 0.024051744490861893, 0.021531153470277786, 0.020668845623731613, -0.005041182041168213, -0.0028257151134312153, -0.014115309342741966, 0.0010679345577955246, -0.00015162929776124656, 0.017551273107528687, 0.0036482238210737705, -0.019925935193896294, -0.02767343632876873, -0.023627223446965218, -0.046962589025497437, 0.01336576510220766, -0.04807695746421814, 0.02812448889017105, -0.05011996254324913, -0.03255542367696762, 0.031122665852308273, 0.014964350499212742, 0.05842464417219162, 0.003109281649813056, -0.006122382823377848, -0.019169757142663002, -0.005200377199798822, -0.0012918028514832258, 0.010898238979279995, -0.016954291611909866, 0.0030412920750677586, 0.037198614329099655, -0.008404181338846684, 0.06850700825452805, -0.006676249671727419, -0.029000062495470047, -0.025113046169281006, 0.008755736984312534, 0.00337792350910604, -0.0009228347917087376, -0.008662872947752476, 0.00336465728469193, -0.02114643156528473, 0.0010729094501584768, 0.0326615534722805, -0.010294623672962189, -0.03881710022687912, -0.010884973220527172, -0.027487708255648613, 0.023998679593205452, -0.018134988844394684, 0.009153724648058414, 0.011933008208870888, -0.0002758969203568995, -0.02852247655391693, -0.025497768074274063, -0.03390858322381973, 0.01910342648625374, -0.04346029460430145, -0.019129958003759384, 0.029451115056872368, 0.011661049909889698, -0.023653756827116013, 0.015813391655683517, 0.02353435941040516, 0.021769946441054344, 0.015747060999274254, 0.03260848671197891, 0.020814774557948112, -0.032422758638858795, -0.00448068231344223, 0.01816152036190033, -0.04871373623609543, -0.028151020407676697, -0.054179441183805466, 0.0008822068339213729, 0.025656962767243385, -0.022181199863553047, 0.00013307725021149963, 0.01617158018052578, -0.005359572358429432, -0.0026151130441576242, 0.03205130249261856, 0.012078937143087387, 0.03433310240507126, -0.011879943311214447, -0.02926538698375225, 0.01149522140622139, 0.0014053953345865011, 0.0021425022277981043, 0.005276658106595278, -0.009982867166399956, 0.023229235783219337, -0.009312920272350311, 0.00658338563516736, -0.010095629841089249, 0.0020463219843804836, 0.017339011654257774, -0.0073030805215239525, 0.0050643980503082275, 0.0021773262415081263, 0.008304683491587639, -0.000573351513594389, -0.025272240862250328, -0.0042054071091115475, -0.015707261860370636, -0.03470455855131149, -0.021133165806531906, 0.02926538698375225, 0.016211379319429398, 0.04303577542304993, -0.018692171201109886, 0.03916202485561371, -0.026890724897384644, -0.012762149795889854, -0.0026632032822817564, -0.008497044444084167, -0.037251681089401245, -0.02921232208609581, -0.020575981587171555, -0.018625840544700623, 0.003724504727870226, -0.02045658603310585, -0.013650990091264248, -0.011236528865993023, -0.012304463423788548, -0.024423200637102127, -0.021358691155910492, 0.028840867802500725, -0.013451996259391308, 0.00020707814837805927, 0.027408109977841377, 0.015932787209749222, -0.09323533624410629, -0.023003708571195602, 0.02841634675860405, -0.002635012613609433, 0.017737001180648804, -0.00985683687031269, 0.0005866177962161601, 0.03165331482887268, 0.029398050159215927, -0.017259415239095688, 0.02438340149819851, -0.02711625210940838, 0.0005816429620608687, -0.014181640930473804, -0.01702062226831913, -0.03579239174723625, -0.020668845623731613, 0.027142785489559174, 0.0366414338350296, -0.014274504967033863, -0.00552540086209774, -0.004809022415429354, 0.03982533887028694, 0.019753472879529, 0.002200542250648141, -0.019037093967199326, -0.011229895986616611, -0.002714610192924738, -0.009412417188286781, -0.001184014487080276, -0.02179647795855999, 0.017657402902841568, -0.004009729716926813, 0.02937151864171028, -0.029185790568590164, 0.004633244127035141, -0.02532530575990677, -0.0017362228827551007, -0.00896136462688446, -0.010904872789978981, -0.028602074831724167, -0.0193156860768795, 0.05030569061636925, -0.0025421485770493746, 0.029822571203112602, -0.02990216761827469, 0.01951467990875244, -0.012974410317838192, 0.0014543146826326847, -0.0011442155810073018, 0.0152031434699893, -0.0005895197973586619, 0.04483998566865921, 0.03141452372074127, -0.0046232943423092365, 0.032024770975112915, -0.0024924001190811396, -0.014115309342741966, -0.0036117415875196457, 0.0338289849460125, 0.021570952609181404, 0.03942734748125076, 0.004208723548799753, -0.010327789932489395, -0.03937428444623947, -0.0009435633546672761, -0.005336356349289417, 0.0494566485285759, 0.02368028834462166, -0.017577804625034332, -0.008516944013535976, 0.031043067574501038, 0.014486764557659626, 0.012981043197214603, 0.04900559410452843, 0.04019679129123688, 0.0009742415859363973, 0.05120779573917389, -0.029530713334679604, 0.025497768074274063, 0.02722238190472126, -0.03263501822948456, 0.03199823945760727, 0.008895033039152622, 0.010155328549444675, 0.018493177369236946, 0.027049921452999115, -0.031785979866981506, -0.012808581814169884, -0.0013780336594209075, 0.03836604580283165, 0.026612134650349617, 0.010765576735138893, 0.031918641179800034, 0.007090820465236902, 0.0018440112471580505, 0.0013199936365708709, 0.023414963856339455, 0.031626783311367035, 0.026585601270198822, 0.039586544036865234, -0.0005663038464263082, 0.027593838050961494, -0.024051744490861893, 0.024264004081487656, -0.014287770725786686, 0.018546242266893387, -0.013849983923137188, 0.01696755737066269, 0.01626444421708584, 0.03205130249261856, 0.02284451387822628, 0.0024509429931640625, 0.03547400236129761, -0.00908739399164915, 0.019992265850305557, 0.001149190473370254, -0.021040301769971848, 0.026704998686909676, -0.03393511474132538, 0.021066833287477493, 0.005545299965888262, -0.01132276002317667, -0.03085733950138092, -0.0028223986737430096, -0.008974630385637283, 0.007667902857065201, 0.015296007506549358, -0.018851367756724358, -0.019474882632493973, 0.007734234444797039, 0.0349433496594429, 0.0009924826445057988, 0.02937151864171028, -0.02219446748495102, 0.009273121133446693, 0.006845394615083933, -0.022884313017129898, 0.0013432096457108855, 0.0326615534722805, -0.011316127143800259, 0.014274504967033863, 0.00672931456938386, -0.009817038662731647, -0.012317730113863945, 0.008835334330797195, -0.008914932608604431, -0.0018821518169716, -0.03319220244884491, 0.0352352075278759, -0.019673876464366913, -6.695319461869076e-05, 0.023507827892899513, 0.06298824399709702, -0.006858660839498043, 0.01920955628156662, -0.009326186962425709, -0.019687142223119736, 0.017949260771274567, 0.040541715919971466, -0.0021275777835398912, 0.03443923220038414, 0.0018655689200386405, 0.038790568709373474, 0.035155609250068665, 0.008211820386350155, -0.050836339592933655, 0.018785035237669945, 0.0036415907088667154, 0.03778233006596565, 0.006049418356269598, -0.014765356667339802, 0.03454536199569702, 0.02532530575990677, 0.04545023664832115, 0.01381018478423357, 0.005153945181518793, 0.005913439206779003, 0.014314303174614906, 0.04136422276496887, -0.04086010530591011, 0.014141841791570187, -0.018134988844394684, 0.024118075147271156, 0.012204966507852077, 0.014765356667339802, 0.016808362677693367, 0.018824834376573563, -0.0017992376815527678, 0.02378641813993454, 0.010931405238807201, 0.021610751748085022, -0.002256923820823431, 0.004513847641646862, 0.004414350725710392, -0.021066833287477493, 0.03160025179386139, 0.02184954285621643, -0.046060483902692795, -0.012656020000576973, -0.005077664274722338, 0.0412050299346447, 0.006958157755434513, -0.004357968922704458, -0.010374221950769424, 0.03189210966229439, -0.024051744490861893, -0.009286387823522091, 0.018042124807834625, 0.005843791179358959, 0.003319883719086647, -0.004268421791493893, -0.02852247655391693, 0.02762036956846714, 0.0007657124078832567, 0.00896136462688446, -0.004958267789334059, 0.004265105351805687, 0.005379471927881241, -0.035155609250068665, -0.03274115175008774, 0.005843791179358959, -0.018280917778611183, 0.033616725355386734, -0.019634077325463295, 0.001749489107169211, 0.0034160639625042677, -0.007966393604874611, -0.013345865532755852, 0.0028655140195041895, -0.0003642005322035402, -0.0029019962530583143, 0.019925935193896294, 0.0003726992290467024, -0.037490472197532654, -0.0019186340505257249, -0.009438949637115002, -0.0015670779393985868, 0.004682992585003376, -0.006245095748454332, 0.03908242657780647, -0.008914932608604431, -0.029291920363903046, -0.0073561458848416805, -0.008570008911192417, 0.005833841394633055, 0.018493177369236946, 0.01797579415142536, -0.01935548521578312, -0.031573716551065445, 0.012934611178934574, 0.011501854285597801, 0.03741087764501572, -0.006291527766734362, 0.007720968220382929, 0.020828040316700935, 0.041974473744630814, 0.06399647891521454, 0.02931845188140869, 0.021915875375270844, -0.03374938666820526, 0.008099056780338287, 0.00021578413725364953, -0.013717321678996086, -0.003285059705376625, -0.01286828052252531, -0.033510591834783554, 0.00012634047016035765, 0.009823671542108059, 0.02478138916194439, 0.0031822461169213057, 0.02528550662100315, 0.017750266939401627, 0.02498038299381733, -0.006225196179002523, 0.03006136417388916, 0.00035798194585368037, -0.013107072561979294, 0.0093062873929739, -0.04590128734707832, -0.0010463768849149346, -0.01796252653002739, -0.01095130480825901, -0.010924771428108215, -0.021557684987783432, -0.007833731360733509, -0.03290034458041191, -0.015786858275532722, 0.02139849029481411, -0.013836718164384365, 0.002693052403628826, 0.026108015328645706, 0.025869222357869148, 0.0013631090987473726, -0.012350895442068577, -3.766765075852163e-06, 0.02557736448943615, -0.010241558775305748, 0.014234705828130245, -0.03343099728226662, 0.028230618685483932, 0.010321157053112984, 0.02383948303759098, -0.007767400238662958, 0.0355270653963089, 0.024423200637102127, 0.007992926985025406, -0.023812951520085335, -0.0064474064856767654, -0.0042352559976279736, -0.022711850702762604, 0.018426846712827682, 0.009943068027496338, 0.014340835623443127, -0.006192030850797892, -0.011402357369661331, -0.0012113761622458696, -0.021013768389821053, 0.024648725986480713, -0.03438616544008255, -0.008782269433140755, 0.0332452692091465, -0.0002676055009942502, 0.01485822070389986, -0.0008838651119731367, -0.04643194004893303, -0.0015173294814303517, -0.006938258185982704, -0.02364048920571804, 0.014393901452422142, 0.0049118357710540295, 0.002688077511265874, 0.006099166814237833, 0.04393788054585457, -0.034465763717889786, 0.008384281769394875, -0.04051518440246582, -0.017206350341439247, -0.02110663242638111, -0.008105689659714699, 0.02886739932000637, 0.03250235691666603, -0.007163784932345152, 0.000710159947630018, -0.025550832971930504, 0.037304747849702835, -0.0031623467803001404, -0.009744074195623398, -0.004901885986328125, -0.015388871543109417, 0.06426180154085159, -0.0060096196830272675, -0.02458239533007145, -0.0010231609921902418, -0.019567744806408882, 0.02145155519247055, 0.0038737503346055746, 0.023348631337285042, -0.06601294875144958, 0.007979660294950008, 0.006480571813881397, 0.01468575932085514, 0.03380244970321655, 0.00407937727868557, -0.02443646639585495, 0.006334642879664898, 0.004619977902621031, 0.03510254621505737, -0.004888619761914015, 0.017299214377999306, 0.00040130462730303407, 0.00965121015906334, -0.0002895777579396963, -0.0037908360827714205, 0.0013233103090897202, 0.030326688662171364, -0.0075219739228487015, 0.0332452692091465, -0.0027975242119282484, 0.04624621197581291, 0.006838761270046234, -0.019567744806408882, -0.011687582358717918, -0.002553756581619382, -0.0047261081635952, 0.012145268730819225, -0.004095960408449173, 0.05187110975384712, 0.007581672165542841, -0.012529990635812283, 0.015760326758027077, 0.038631372153759, 0.005522083956748247, -0.015282740816473961, -0.004022995941340923, -0.016688965260982513, -0.012881546281278133, -0.018280917778611183, 0.02617434784770012, 0.009637943468987942, -0.011986073106527328, -0.01687469333410263, 0.01777680031955242, -0.0031490803230553865, -0.0009858495322987437, 0.0011690899264067411, 0.021862810477614403, 0.036906756460666656, 0.00771433487534523, -0.006172131281346083, -0.029849102720618248, -0.0225924551486969, -0.04627274349331856, -0.01522967591881752, -0.020483117550611496, -0.044415466487407684, -0.014301037415862083, 0.025152845308184624, -0.03815378621220589, -0.009399151429533958, -0.03290034458041191, 0.005462385714054108, 0.0011848435970023274, -0.007130619138479233, 0.0023464711848646402, 0.004228623118251562, -0.017538007348775864, 0.024860987439751625, 0.0465911328792572, 0.015866456553339958, -0.011130399070680141, 0.007508707698434591, -0.032077837735414505, -0.007250015623867512, 0.008065891452133656, 0.005920072086155415, 0.020987236872315407, -0.015747060999274254, 0.006852027494460344, 0.028310216963291168, -0.010818641632795334, -0.0030147593934088945, 0.016237912699580193, -0.004248522222042084, -0.004195457324385643, -0.02159748412668705, -0.02349456027150154, -0.010652813129127026, 0.015110279433429241, -0.023958880454301834, -0.015534800477325916, 0.0037278214003890753, 0.011601351201534271, -0.01727268099784851, -0.02697032317519188, -0.021279094740748405, -0.04940358176827431, -0.013034108094871044, 0.00323531124740839, 0.006185397505760193, -0.008304683491587639, 0.01363772340118885, 0.04653806984424591, 0.020244324579834938, -0.018652373924851418, 0.02796529419720173, 0.008808801881968975, 0.047015655785799026, -0.029928700998425484, -0.023414963856339455, 0.03717208281159401, 0.029796037822961807, 0.02170361392199993, 0.02184954285621643, 0.002278481610119343, -0.00027403136482462287, -0.02602841891348362, 0.006739264354109764, -0.007283181417733431, -0.0007586647407151759, -0.03682716190814972, -0.029185790568590164, 0.01542866975069046, 0.027540773153305054, 0.009923168458044529, 0.033616725355386734, -0.016091983765363693, -0.015216409228742123, -0.014314303174614906, -0.005906805861741304, -0.010387487709522247, 0.04937705025076866, -0.012855013832449913, -0.022526122629642487, 0.018042124807834625, 0.040037598460912704, 0.005084297154098749, 0.027938760817050934, 0.014805154874920845, -0.005956554319709539, -0.013146871700882912, -0.029742972925305367, 0.01991266943514347, 0.03109613247215748, -0.004119176417589188, -0.015043947845697403, 0.007893429137766361, -0.03433310240507126, 0.021265827119350433, 0.0037875196430832148, 0.02931845188140869, -0.013292800635099411, -0.006825495045632124, 0.02070864476263523, 0.046750329434871674, -0.022260798141360283, -0.052720148116350174, 0.007163784932345152, 0.016397107392549515, -0.0016101932851597667, 0.020960703492164612, 0.0057907262817025185, 0.02632027678191662, 0.0006649717106483877, -0.0007586647407151759, 0.005495551507920027, -0.022778183221817017, 0.03348406031727791, -0.03579239174723625, 0.004341386258602142, -0.00960477814078331, 0.008258252404630184, 0.0234414953738451, 0.009518546983599663, -0.014181640930473804, -0.01926262117922306, 0.013133605942130089, 0.00734287966042757, 0.00060817546909675, 0.010911505669355392, 0.01617158018052578, -0.010500251315534115, -0.019435083493590355, -0.005455752834677696, 0.0006612405413761735, 0.02194240689277649, 0.006192030850797892, 0.05234869569540024, 0.033324867486953735, -0.0029351618140935898, -0.01000276580452919, -0.00028854134143330157, -0.05508154630661011, -0.02080150879919529, 0.013093806803226471, 0.030326688662171364, 0.004984800238162279, -0.024754855781793594, 0.0037875196430832148, -0.005187110975384712, 0.02926538698375225, 0.024914052337408066, 0.005478968843817711, -0.0014393901219591498, -0.012171801179647446, -0.015415403991937637, 0.01772373355925083, -0.006400974467396736, -0.0036913391668349504, -0.05439170077443123, -0.01336576510220766, 0.008006192743778229, 0.022128134965896606, -0.01321320328861475, 0.022910844534635544, -0.00676911324262619, -0.0011790395947173238, -0.012118736281991005, 0.010420653969049454, -0.016397107392549515, -0.0013274559751152992, -0.009166991338133812, -0.00029019961948506534, -0.003412747522816062, 0.016609366983175278, -0.004132442642003298, -0.009936435148119926, 0.009392517618834972, 0.012994309887290001, 0.03733127936720848, -0.0032054621260613203, -0.002679786179214716, 0.02139849029481411, -0.011442156508564949, -0.013478528708219528, 0.04027638956904411, 0.00020624900935217738, 0.0355270653963089, -0.05062408000230789, -0.017179816961288452, -0.021438289433717728, 0.03109613247215748, -0.018095189705491066, -0.02383948303759098, 0.014553096145391464, -0.014340835623443127, 0.023613957688212395, -0.005296557676047087, 0.04035598784685135, 0.04449506476521492, -0.031918641179800034, 0.0037609869614243507, 0.009518546983599663, -0.029530713334679604, 0.006659666541963816, 0.020496385172009468, -0.01652977056801319, 0.012238132767379284, -0.04176221415400505, 0.0093062873929739, -0.012675919570028782, 0.007495441474020481, 0.022871047258377075, -0.03815378621220589, -0.0005488918395712972, 0.007309713866561651, -0.030300157144665718, 0.008430713787674904, -0.0026665199548006058, -0.014340835623443127, 0.012198333628475666, 0.008331216871738434, 0.006971423979848623, -0.02016472816467285, -0.003419380635023117, 0.005518767517060041, 0.010473718866705894, 0.017644137144088745, 0.027487708255648613, 0.016742030158638954, -0.003843901213258505, 0.008145488798618317, 0.012450392358005047, 0.0028107906691730022, -0.03210436925292015, -0.0011458739172667265, -0.011999339796602726, 0.012437126599252224, -0.006798962596803904, 0.002459234558045864, -0.01508374698460102, -0.012629487551748753, 0.0011964516015723348, 0.022220999002456665, 0.03045935183763504, 0.058106254786252975, -0.005054448265582323, 0.06739263981580734, -0.006032835692167282, 0.007475541904568672, -0.012496824376285076, 0.005488918628543615, 0.0017395394388586283, 0.00898789707571268, -0.0012694160686805844, -0.0034923451021313667, -0.02190260961651802, 0.02369355410337448, 0.019740207120776176, 0.027142785489559174, -0.0009477090206928551, -0.024303803220391273, -0.028336748480796814, -0.026214145123958588, 0.04030292108654976, -0.03136145696043968, 0.02961030974984169, 0.017047153785824776, 0.01149522140622139, 0.017193082720041275, 0.03149412199854851, -0.03080427460372448, 0.041390758007764816, -0.011886576190590858, 0.008278151042759418, -0.0001318335416726768, 0.03398817777633667, 0.028257152065634727, 0.026784595102071762, -0.008112323470413685, -0.025219175964593887, 0.014805154874920845, -0.01727268099784851, -0.0304062869399786, -0.003843901213258505, 0.0042352559976279736, -0.03244929388165474, 0.00940578430891037, -0.035659730434417725, 0.0007192805060185492, 0.05176497995853424, 0.040939703583717346, 0.003306617261841893, 0.000839091488160193, -0.009797139093279839, 0.010354322381317616, -0.012291197665035725, -0.00896136462688446, -0.03120226226747036, 0.0021756680216640234, -0.02478138916194439, -0.013836718164384365, 0.011428889818489552, 0.018798302859067917, -0.01375711988657713, 0.006759163457900286, -0.03504947945475578, 0.00020075595239177346, -0.01323973573744297, -0.008138855919241905, -0.00449394853785634, 0.02483445405960083, 0.011528386734426022, 0.021040301769971848, 0.00761483795940876, 0.014194906689226627, 1.535207843517128e-06, 0.02134542539715767, -0.004188823979347944, -0.00168896175455302, 0.014725557528436184, -0.03210436925292015, 0.0022337078116834164, -0.012762149795889854, -0.011574818752706051, 0.020217793062329292, -0.011773812584578991, 0.01816152036190033, 0.0077408673241734505]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"
Cluster ID0510152025Number of MembersFigure 13. Cluster Distribution : We observe that number of heads
within the cluster is quite skewed. We often observe one or two
large clusters, while the remaining heads in the cluster.
Table 4. Pruning Both Q,K,V
CHAI CHAI-QKV MHA
Arc-Challenge 47.0 41.29 47.5
PIQA 77.8 61.93 79.8
Figure 12-(b) shows time to predict the next token for dif-
ferent sequence lengths. We observe that CHAI provides a
speedup of over 5×for a sequence length of 2048.
Unfortunately, we are not able to compare times with
DEJAVUas the authors have not released the specialized
kernels used for realizing the speedups on hardware (git,
2024), thus inhibiting a runtime comparison. However, we
believe it is unlikely that at less than 10% sparsity which is
needed by DEJAVUto get comparable accuracy to MHA, it
will yield high speedups (Hooker, 2021). We would like to
highlight that because of performing dense computations,
unlike DEJAVU,CHAI does not need custom GPU kernels.
Further, CHAI ’s speedup benefits are independent of the
framework used, because irrespective of implementation,
CHAI directly reduces the complexity of MHA.
4.5. Additional Experiments
Next we perform additional studies on our algorithm.
Pruning K, Q and V . InCHAI , we prune only the Key
and Query portion of an attention head leaving the Value
vector intact. Next, we study how accuracy changes if we
remove the value vector as well. To perform this experiment
we chose to reuse the value vector generated by the chosen
head. In Table 4, we show how reusing the full head (Query,
Key and Value vector) lead to additional loss in accuracy.
This shows that for smaller networks like LLAMAit might
be hard to remove the whole head in Multi-Head Attention.
Cluster Distribution. Figure 13 shows the distribution
across clusters for Layer-18 on LLAMA-7B for different
1024 samples of C4 dataset. We observe that typically for
LLMs majority of heads can be grouped into a single head.
8
Runtime Clustered Head Attention for Efficient Inference
5. Conclusion
In this work, we present CHAI , an efficient runtime method
which identifies attention heads giving similar scores. Us-
ing this method we reduce overhead of Multi-Head Atten-
tion by clustering the correlated heads and computing atten-
tion scores only for heads which lead to disparate attention
scores. Our evaluation shows that with minor accuracy loss
system can speedup inference by up to 1.73×.
References
Deja Vu: Contextual Sparsity for Efficient LLMs
at Inference Time. https://github.com/
FMInference/DejaVu , 2024.
Ainslie, J., Lee-Thorp, J., de Jong, M., Zemlyanskiy, Y .,
Lebr ´on, F., and Sanghai, S. Gqa: Training generalized
multi-query transformer models from multi-head check-
points. arXiv preprint arXiv:2305.13245 , 2023.
Bisk, Y ., Zellers, R., Gao, J., Choi, Y ., et al. Piqa: Reasoning
about physical commonsense in natural language. In Pro-
ceedings of the AAAI conference on artificial intelligence ,
volume 34, pp. 7432–7439, 2020.
Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J. D.,
Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G.,
Askell, A., et al. Language models are few-shot learners.
Advances in neural information processing systems , 33:
1877–1901, 2020.
Chen, T., Frankle, J., Chang, S., Liu, S., Zhang, Y ., Wang,
Z., and Carbin, M. The lottery ticket hypothesis for pre-
trained bert networks. Advances in neural information
processing systems , 33:15834–15846, 2020a.
Chen, X., Cheng, Y ., Wang, S., Gan, Z., Wang, Z., and Liu,
J. Earlybert: Efficient bert training via early-bird lottery
tickets. arXiv preprint arXiv:2101.00063 , 2020b.
Clark, C., Lee, K., Chang, M","[0.012367049232125282, 0.028375664725899696, 0.04224218428134918, 0.000869781244546175, 0.022177860140800476, 0.002741886069998145, -0.009546618908643723, 0.05680845305323601, -0.055608879774808884, 0.023448839783668518, 0.03461631387472153, -0.025576656684279442, -0.018279241397976875, 0.03495904803276062, -0.010646229609847069, -0.019864393398165703, 0.03730107471346855, -0.03198867291212082, 0.01026065181940794, 0.035158976912498474, -0.06631936877965927, 0.027733035385608673, 0.02356308326125145, 0.008846866898238659, 0.061806682497262955, 0.008304201997816563, 0.01423067506402731, -0.013188187032938004, 0.018793344497680664, -0.01659412309527397, 0.022135019302368164, -0.03361666575074196, -0.018279241397976875, -0.009218163788318634, -0.0471261665225029, 0.0716317743062973, -0.0165084395557642, 0.021778002381324768, -0.037872303277254105, -0.008318482898175716, -0.004073557443916798, -0.026747670024633408, -0.009767969138920307, 0.024148590862751007, -0.004191373009234667, 0.0004172629560343921, 0.04189944639801979, 0.03210291638970375, -0.020735513418912888, 0.06586238741874695, -0.05592305213212967, 0.04309902340173721, -0.06757606565952301, 0.0143806217238307, -0.01622282713651657, -0.006422725506126881, 0.010267792269587517, 0.0278329998254776, 0.0474974662065506, -0.0035630238708108664, 0.006329901050776243, -0.03401652351021767, 0.014680515043437481, 0.03595869615674019, -0.03684409707784653, -0.034673433750867844, -0.03952885791659355, -0.0034755549859255552, 0.0430418998003006, -0.009717986918985844, -0.027661632746458054, 0.052267204970121384, 0.03347386047244072, -0.026804793626070023, -0.005055352579802275, 0.008304201997816563, -0.0224491935223341, 0.04855423420667648, -0.005062493029981852, 0.007861501537263393, 0.006979671306908131, 0.02427711710333824, 0.045640978962183, -0.015094654634594917, -0.018579134717583656, -0.06397734582424164, -0.03441638499498367, -0.014009324833750725, -0.06974673271179199, -0.03136032447218895, -0.019650183618068695, 0.041728079319000244, -0.0189218707382679, -0.015594477765262127, 0.050639208406209946, 0.03830072283744812, 0.03504473343491554, -0.017022542655467987, 0.017508085817098618, 0.007008232641965151, -0.0015583767089992762, 0.018393486738204956, 0.015965774655342102, -0.013902219943702221, 0.04064274951815605, -0.03370235115289688, -0.03610150143504143, 0.023448839783668518, -0.02237778902053833, -0.004698336124420166, -0.08968252688646317, 0.0005368634592741728, -0.05700838193297386, 0.011438806541264057, -0.025019710883498192, -0.025733744725584984, -0.027361739426851273, -0.015166058205068111, -0.012981117703020573, 0.024062907323241234, -0.029560960829257965, -0.0200357623398304, 0.04838286712765694, -0.011624454520642757, 0.00200464716181159, -0.03013218566775322, 0.03530178591609001, -0.07077493518590927, -0.02753310650587082, -0.024819782003760338, 0.014302077703177929, 0.030560607090592384, 0.04427003860473633, -0.016579842194914818, -0.01078189630061388, -0.039100438356399536, -0.019950078800320625, 0.010881860740482807, -0.06751894950866699, -0.037015464156866074, -0.0008162287995219231, -0.03424501419067383, -0.008097132667899132, 0.029418153688311577, -0.025847990065813065, 0.04801156744360924, -0.04127109795808792, 0.0018511301605030894, -0.02089260146021843, 0.05777953937649727, -0.01947881653904915, -0.024619853124022484, -0.039100438356399536, -0.009525198489427567, -0.06609088182449341, -0.03350242227315903, -0.042327865958213806, 0.01512321550399065, 0.017722295597195625, -0.06997521966695786, 0.03493048623204231, 0.014651954174041748, -0.004205653443932533, -0.027104686945676804, 0.021206775680184364, 0.026162164285779, -0.04261348024010658, 0.016979701817035675, -0.07374531030654907, -0.05692270025610924, -0.023705890402197838, -0.019678745418787003, -0.005355246365070343, -0.04167095571756363, 0.002659772289916873, -0.022292105481028557, -0.016022896394133568, -0.023334594443440437, -0.010789036750793457, -0.05600873753428459, -0.005797946825623512, 0.059693146497011185, 0.011760121211409569, 0.0130810821428895, -0.05997876077890396, -0.01852201297879219, 0.011595893651247025, 0.012259944342076778, 0.021235337480902672, 0.04644069820642471, 0.006883276626467705, 0.039214685559272766, 0.0397002249956131, 0.030303554609417915, 0.009810811839997768, -0.04098548740148544, 0.062035173177719116, 0.023805854842066765, 0.01440204307436943, -0.014409182593226433, -0.006465567275881767, 0.032531335949897766, 0.004562669899314642, -0.04584090784192085, 0.03110327199101448, -0.009967898949980736, -0.011181754060089588, -0.03395940363407135, -0.03201723471283913, -0.012874012812972069, 0.040328577160835266, -0.01248843502253294, 0.060321494936943054, -0.010846159420907497, -0.03395940363407135, -0.008896849118173122, -0.06437720358371735, 0.007497345097362995, -0.0017440252704545856, 0.02437708154320717, 0.015408828854560852, 0.03324536979198456, 0.02998938038945198, 0.044555649161338806, -0.050382159650325775, 0.004587661009281874, 0.004744748119264841, -0.03995727747678757, 0.037758056074380875, -0.011267438530921936, 0.032674144953489304, 0.008361324667930603, -0.004262776114046574, -0.014766199514269829, -0.0241200290620327, -0.0604928620159626, 0.027961526066064835, -0.019507378339767456, 0.014095008373260498, -0.04398442432284355, -0.02126389928162098, -4.8336678446503356e-05, 0.018422048538923264, 0.008839726448059082, 0.03273126482963562, 0.030532045289874077, -0.03196011111140251, -0.0389576330780983, 0.03955741971731186, 0.022092176601290703, 0.012052875012159348, -0.02430567890405655, -0.060949843376874924, -0.016651246696710587, -0.05118187516927719, -0.0023795145098119974, -0.021877966821193695, 0.04384161904454231, 0.0026651276275515556, 0.005676561035215855, -0.03555883467197418, 0.0082542197778821, -0.015965774655342102, 0.006858285516500473, -0.009532338939607143, -0.023320313543081284, -0.0015762274852022529, 0.03630143031477928, -0.03755812719464302, -0.01625138707458973, -0.018793344497680664, 0.009767969138920307, 0.027633070945739746, 0.00234202784486115, -0.024334238842129707, -0.016094300895929337, 0.011153193190693855, 0.022206421941518784, -0.02464841492474079, -0.011974330991506577, -0.020107164978981018, 0.042584918439388275, 0.06317763030529022, 0.03498760983347893, 0.02144954726099968, 0.013359555043280125, 0.007968606427311897, -0.052010152488946915, -0.03593013435602188, -0.013509501703083515, 0.014601971954107285, -0.02096400409936905, 0.0241200290620327, -0.030931903049349785, 0.021806564182043076, 0.01863625831902027, 0.025519534945487976, 0.00385934766381979, 0.00445199478417635, -0.007540186867117882, 0.05469491705298424, 0.0070867761969566345, -0.018950432538986206, -0.010789036750793457, 0.0030524905305355787, 0.023291751742362976, -0.019864393398165703, 0.01933600939810276, -0.012495574541389942, 0.018507732078433037, -0.036615606397390366, -0.01606573909521103, 0.0009273501927964389, 0.019121799618005753, -0.039843033999204636, -0.05278130993247032, 0.02029281295835972, -0.022777648642659187, 0.031417444348335266, 0.007233152631670237, -0.05181022360920906, -0.04030001536011696, -0.032531335949897766, 0.013809395022690296, 0.006561961956322193, 0.01725103333592415, 0.01822211779654026, 0.0007439329638145864, -0.004002154339104891, -0.041585274040699005, 0.03001794032752514, 0.02112109214067459, 0.0015512363752350211, -0.013445238582789898, -0.04801156744360924, -0.019650183618068695, -0.02571946382522583, 0.027518825605511665, 0.012095716781914234, 0.01863625831902027, -0.04821150004863739, 0.016379913315176964, -0.03510185331106186, 0.029361030086874962, -0.010946123860776424, 0.007126047741621733, 0.013052520342171192, 0.006769031286239624, 0.04078555479645729, -0.009853653609752655, 0.0028079343028366566, -0.02906113676726818, 0.03398796543478966, -0.03641567379236221, 0.0047376081347465515, 0.01903611607849598, -0.016708368435502052, -0.018536292016506195, -0.025362446904182434, 0.03447350487112999, -0.050410717725753784, -0.007590169087052345, 0.021049687638878822, 0.0027525967452675104, 0.0319029875099659, 0.013366695493459702, -0.026062199845910072, 0.02140670455992222, 0.014052166603505611, -0.02033565565943718, -0.005851499270647764, -0.004227074328809977, -0.01903611607849598, -0.029361030086874962, -0.04549817368388176, 0.008839726448059082, -0.017536647617816925, 0.03275982663035393, 0.0015217824839055538, 0.03958598151803017, -0.008082851767539978, -0.014366340823471546, -0.008432728238403797, -0.02137814275920391, 0.02604791894555092, 0.017936505377292633, -0.01091042160987854, 0.008675498887896538, -0.06300625950098038, 0.016337072476744652, -0.009203883819282055, 0.006915408186614513, -0.028975453227758408, 0.024205714464187622, 0.006526260171085596, -0.009025375358760357, -0.0010880075860768557, 0.0052160099148750305, 0.03444494307041168, 0.04252779856324196, 0.01217425987124443, 0.011160333640873432, -0.020735513418912888, -0.009967898949980736, 0.011917208321392536, 0.029903696849942207, -0.0069082677364349365, 0.017608050256967545, 0.00518744857981801, -3.494855991448276e-05, 0.06026437133550644, -0.029103979468345642, 0.017836540937423706, -0.020435620099306107, -0.0022706245072185993, -0.006854715291410685, -0.02342027798295021, 0.03670128807425499, 0.014173552393913269, 0.051010508090257645, 0.004551959224045277, -0.03073197416961193, -0.03184586390852928, 0.005255281925201416, -0.04287053272128105, 0.005765815265476704, 0.06003588065505028, -0.0638059750199318, 0.02604791894555092, -0.061064090579748154, -0.045783787965774536, 0.03744388371706009, 0.028861207887530327, -0.016865456476807594, -0.005569456145167351, -0.03113183192908764, 0.043470319360494614, 0.028232859447598457, -0.013873658142983913, -0.045441050082445145, -0.007333117537200451, -0.04626932740211487, -0.033673789352178574, -0.022249264642596245, -0.03350242227315903, 0.015465951524674892, 0.0031738760881125927, -0.013295291922986507, -0.0021974360570311546, -0.0248626247048378, -0.007575888652354479, -0.00316852075047791, 0.04715472832322121, 0.04826861992478371, -0.004277057014405727, -0.047811638563871384, 0.09470931440591812, -0.019064677879214287, 0.012188540771603584, -0.039985839277505875, 0.026847634464502335, 0.011288859881460667, -0.034759119153022766, 0.02144954726099968, -0.017508085817098618, 0.01606573909521103, 0.019550219178199768, -0.008804025128483772, 0.0512104369699955, -0.0008630871889181435, 0.024405643343925476, -0.02683335542678833, 0.006033577490597963, -0.02797580696642399, -0.02560521848499775, 0.00881116557866335, 0.025362446904182434, -0.052381448447704315, 0.006179954390972853, -0.053980883210897446, 0.02214929834008217, -0.01643703691661358, 0.031560253351926804, 0.031160393729805946, 0.0463835746049881, 0.041328221559524536, 0.03418789431452751, 0.0139164999127388, 0.022991858422756195, 0.03855777531862259, 0.0013084652600809932, -0.010474861599504948, 0.04652637988328934, -0.017022542655467987, -0.004798300564289093, 0.0028204298578202724, 0.02671911008656025, -0.002925749635323882, -0.0011246016947552562, -0.021778002381324768, 0.021049687638878822, -0.026376374065876007, 0.038500651717185974, -0.0031595954205840826, -0.04215649887919426, 0.002220642287284136, 0.021792283281683922, 0.005262421909719706, 0.023834416642785072, 0.018721941858530045, -0.011617315001785755, 0.001692257821559906, 0.016051458194851875, 0.03435926139354706, -0.009896495379507542, 0.03355954587459564, 0.009339549578726292, 0.011067509651184082, -0.0005489127361215651, 0.046183645725250244, 0.020121445879340172, -0.007404520642012358, -0.006329901050776243, -0.009282426908612251, 0.02252059616148472, 0.009475216269493103, -0.031560253351926804, -0.07351682335138321, -0.04198513180017471, -0.03732963651418686, 0.021992212161421776, -0.014601971954107285, 0.012095716781914234, -0.0022117167245596647, -0.07260286062955856, 0.008882569149136543, 0.015465951524674892, -0.024519888684153557, -0.02794724516570568, 0.03815791755914688, -0.0012495574774220586, 0.02163519524037838, 0.0003039102302864194, 0.00899681355804205, 0.00636560283601284, -0.027633070945739746, 0.028489910066127777, -0.037386760115623474, 0.006883276626467705, 0.042956218123435974, 0.023177506402134895, -0.05069633200764656, 0.025776585564017296, -0.013109643012285233, -0.016465596854686737, -0.0028115042950958014, -0.010289213620126247, -0.017465243116021156, 0.0013227458111941814, -0.013816535472869873, 0.03727251663804054, -0.003318467643111944, -0.014216394163668156, -0.013259589672088623, -0.04875416308641434, 0.0008077496895566583, 0.03795798495411873, -0.01966446451842785, 0.015194619074463844, -0.0030756965279579163, -0.029589520767331123, -0.00913248024880886, 0.024020064622163773, -0.05295267701148987, 0.024662693962454796, -0.006758321076631546, 0.008668358437716961, 0.03224572539329529, 0.010310634039342403, 0.017422402277588844, -0.049011215567588806, -0.01566588133573532, -0.024334238842129707, -0.0048375725746154785, -0.02196365036070347, 0.003289906308054924, 0.003527322318404913, 0.012267084792256355, -0.043213266879320145, 0.006740469951182604, 0.04538392648100853, -0.02509111538529396, 0.024776939302682877, -0.015208899974822998, -0.025333885103464127, -0.012209962122142315, 0.007404520642012358, -0.036872655153274536, -0.0287612434476614, -0.01599433645606041, 0.026547741144895554, 0.035787325352430344, -0.0018921870505437255, -0.01740812137722969, -0.023877259343862534, 0.020092884078621864, -0.03695834055542946, 0.01985011249780655, 0.020478462800383568, 0.0030382098630070686, -0.0015673021553084254, 0.0006140682380646467, 0.004869704134762287, -0.029418153688311577, -0.007018942851573229, -0.004077127669006586, -0.028632717207074165, -0.05161029472947121, 0.03384515643119812, -0.02497687004506588, -0.008154255338013172, -0.027804439887404442, 0.015608757734298706, 0.01945025473833084, -0.013088222593069077, 0.027847280725836754, 0.009860794059932232, -0.052495695650577545, -0.021035408601164818, 0.004551959224045277, -0.06711909174919128, 0.009568040259182453, 0.011388824321329594, 0.0036451376508921385, 0.0191075187176466, 0.0020278533920645714, -0.01882190629839897, -0.007251003757119179, 0.024876903742551804, -0.0005560530698858202, 0.01977870985865593, 0.008554114028811455, -0.01970730721950531, -0.03870058059692383, 0.03158881515264511, -0.028047209605574608, 0.01254555769264698, -0.022763367742300034, -0.01882190629839897, -0.01585152931511402, -0.02471981756389141, -0.03815791755914688, 0.04541248828172684, 0.01302395947277546, 0.0371011458337307, -0.034873366355895996, -0.03458775207400322, -0.004584090784192085, 0.028032930567860603, 0.02219214104115963, -0.0298751350492239, -0.007183170411735773, -0.005869349930435419, -0.03161737322807312, -0.00477687967941165, 0.024762660264968872, 0.01929316855967045, 0.03393084183335304, -0.023620206862688065, -0.008711201138794422, 0.00044939442886970937, 0.007154609076678753, 0.01922176405787468, 0.023934381082654, 0.004555529449135065, -0.024734098464250565, -0.01989295519888401, -0.0007881137426011264, -0.024776939302682877, 0.007222442422062159, -0.04315614700317383, 0.03630143031477928, -0.0701465904712677, -0.01926460675895214, 0.03218860179185867, 0.009932196699082851, 0.03441638499498367, -0.007568748202174902, 0.02630496956408024, -0.014466305263340473, -0.0053588165901601315, -0.01328815147280693, 0.043955862522125244, 0.001516427262686193, -0.011774402111768723, 0.041356783360242844, -0.010232090950012207, 0.05929328873753548, -0.022506315261125565, -0.07625871151685715, -0.02460557222366333, 0.0022974007297307253, 0.0108532989397645, 0.023448839783668518, -0.03176018223166466, -0.0017574133817106485, -0.008125693537294865, 0.02686191536486149, 0.060435742139816284, -0.027333177626132965, -0.032674144953489304, 0.013345274142920971, -0.02831854298710823, 0.02430567890405655, -0.0263478122651577, 0.02998938038945198, -0.005787236150354147, -0.0002416554925730452, -0.008632657118141651, -0.022334948182106018, -0.044441405683755875, 0.018679099157452583, -0.03218860179185867, -0.010731914080679417, 0.014780480414628983, 0.00099518324714154, -0.0211496539413929, -0.005780096165835857, 0.010417738929390907, 0.013109643012285233, -0.004405582789331675, 0.0250482726842165, 0.01562303863465786, -0.06352036446332932, -0.007768677547574043, 0.027076125144958496, -0.03387371823191643, -0.002084975829347968, -0.06374885141849518, -0.022163579240441322, 0.013430957682430744, -0.026133602485060692, 0.013281011022627354, 0.01859341561794281, -0.014866163954138756, 0.012438451871275902, 0.029818011447787285, -0.003298831870779395, 0.0007457180763594806, -0.0011397749185562134, -0.03275982663035393, 0.01397362258285284, 0.015394547954201698, 0.009011094458401203, -0.0018993273843079805, -0.018507732078433037, 0.011481648311018944, -0.005969314835965633, 0.02163519524037838, 0.021163932979106903, 0.01258125901222229, 0.01599433645606041, -0.025248201563954353, 0.021849405020475388, -0.0006609266856685281, -0.025733744725584984, 0.005105334799736738, -0.025319604203104973, -0.015822967514395714, 0.014737637713551521, -0.0252339206635952, 0.005280273035168648, 0.030560607090592384, 0.011945769190788269, 0.031160393729805946, -0.026005076244473457, 0.037615250796079636, -0.011902927421033382, -0.008454148657619953, 0.008040009997785091, 0.010482002049684525, -0.021535230800509453, -0.03207435458898544, -0.023591645061969757, -0.032045792788267136, -0.001711893710307777, -0.02683335542678833, -0.015894372016191483, -0.01506609283387661, -0.019364571198821068, -0.02883264608681202, -0.008154255338013172, -0.002293830504640937, -0.02237778902053833, 0.013759412802755833, 0.006087129935622215, -0.0022652691695839167, -0.10938983410596848, -0.024734098464250565, 0.0191075187176466, -0.012681223452091217, 0.025362446904182434, -0.030332116410136223, 0.023477399721741676, 0.011745840311050415, 0.02456272952258587, -0.02627640962600708, -0.004366310779005289, -0.020864039659500122, 0.007072495296597481, 0.004826861899346113, 0.018422048538923264, -0.0664336159825325, -0.01323102880269289, 0.013773693703114986, 0.034273575991392136, -0.011110351420938969, -0.01870766095817089, -0.010539124719798565, 0.01007500384002924, 0.042956218123435974, -0.004219934344291687, 0.01434492040425539, -0.011681577190756798, -0.0006966282962821424, 0.0015958633739501238, 0.011667297221720219, -0.018022188916802406, -0.03196011111140251, 0.0031381743028759956, 0.04869703948497772, -0.03553027659654617, 0.024077188223600388, -0.028704119846224785, 0.01187436655163765, -0.007790098432451487, -0.025319604203104973, -0.026162164285779, -0.045441050082445145, 0.04272772744297981, -0.015837248414754868, 0.03273126482963562, -0.012702644802629948, 0.008911130018532276, -0.02337743528187275, 0.017350997775793076, 0.020164288580417633, 0.014709076844155788, -0.019064677879214287, 0.02471981756389141, 0.045812349766492844, 0.006851145066320896, 0.009825091809034348, -0.012367049232125282, 0.0005132111255079508, 0.019678745418787003, 0.02961808256804943, 0.006993951741605997, 0.02560521848499775, 0.02509111538529396, -0.03244565427303314, -0.017950786277651787, -0.004348460119217634, -0.02200649306178093, 0.04515543952584267, 0.002302756067365408, -0.0378437414765358, -0.02312038466334343, 0.02913254126906395, 0.01703682355582714, 0.026105040684342384, 0.017379559576511383, 0.0016342427115887403, 0.03287407383322716, 0.05021078884601593, -0.020507022738456726, 0.01325245015323162, 0.04038569703698158, -0.05986451357603073, 0.014616252854466438, 0.013181046582758427, -0.021806564182043076, 0.017193911597132683, 0.022534877061843872, -0.029818011447787285, -0.00636560283601284, 0.02906113676726818, 0.020435620099306107, 0.009782250039279461, 0.003261344972997904, 0.018464889377355576, 0.024776939302682877, 0.01759376935660839, 0.0077472566626966, 0.004866133909672499, 0.03124607726931572, 0.011802962981164455, 0.03127463907003403, 0.013181046582758427, 0.019007554277777672, -0.028818365186452866, -0.006397734396159649, 0.0005341858486644924, 0.03841496631503105, -0.012881152331829071, 0.009603741578757763, 0.0008385423570871353, 0.03430213779211044, 0.028889769688248634, -0.007065355312079191, -0.005241001024842262, 0.0008470214670524001, 0.026704829186201096, -0.012095716781914234, -0.005287413485348225, 0.02330603264272213, -0.011288859881460667, 0.020321374759078026, 0.008968252688646317, -0.022877613082528114, -0.03287407383322716, 0.00456624012440443, -0.01453056838363409, 0.017722295597195625, 0.015251741744577885, -0.008582674898207188, -0.029418153688311577, 0.014651954174041748, 0.022891893982887268, 0.005340965930372477, 0.0070974864065647125, -0.0030364247504621744, 0.004905405919998884, 0.01488044485449791, -0.011474507860839367, -0.029332470148801804, 0.0345020666718483, -0.015323145315051079, -0.020064322277903557, 0.02549097314476967, -0.0019957218319177628, -0.019992919638752937, 0.0014039671514183283, -0.006097840610891581, -0.019607342779636383, -0.03347386047244072, 0.035787325352430344, 0.005108905024826527, 0.004919686354696751, 0.013902219943702221, 0.038386404514312744, 0.004659064579755068, 0.026319250464439392, 0.002998938085511327, -0.031217515468597412, 0.011160333640873432, 0.05812227353453636, 0.012445592321455479, 0.04446996748447418, 0.02816145494580269, 0.016194265335798264, 0.027775878086686134, -0.021763721480965614, -0.03978591039776802, -0.0100178811699152, -0.010174968279898167, 0.03667272627353668, -0.03644423559308052, -0.0005453425692394376, 0.04372737184166908, 0.04575522616505623, 0.0035933703184127808, 0.021021127700805664, 0.015894372016191483, -0.018450608476996422, 0.033788032829761505, 0.028661279007792473, -0.01538026798516512, 0.0014905435964465141, -0.021349582821130753, 0.0004931289586238563, 0.00886828824877739, 0.03473055735230446, 0.011610174551606178, 0.01747952401638031, 0.00786864198744297, -0.006254927720874548, 0.011917208321392536, 0.022906174883246422, -0.0062513574957847595, 0.026362093165516853, 0.009589461609721184, -0.012252803891897202, 0.023034699261188507, 0.023991504684090614, -0.0352446623146534, -0.019907236099243164, 0.009182462468743324, 0.05098194628953934, 0.007732975762337446, 0.00857553444802761, -0.03715826943516731, 0.026476338505744934, -0.0017208191566169262, -0.034530628472566605, 0.0017966851592063904, 0.00719031086191535, -0.01499469019472599, 0.002647276734933257, -0.029789451509714127, 0.01993579789996147, -0.0050803436897695065, 0.0023170365020632744, 0.021835124120116234, 0.008354184217751026, -0.011653016321361065, -0.029675206169486046, -0.028589876368641853, 0.0005966636817902327, -0.034045085310935974, 0.025062553584575653, -0.021806564182043076, 0.01435920037329197, 0.014116429723799229, -0.02460557222366333, -0.018193557858467102, 0.009403812699019909, -0.0013325638137757778, -0.0016395979328081012, -0.0015467737102881074, 0.0003400581481400877, -0.04255635663866997, -0.011838664300739765, -0.006747610401362181, -0.012866872362792492, -0.015294583514332771, -0.006615514401346445, 0.03767237439751625, 0.01208143588155508, 0.017208192497491837, 0.02186368592083454, 0.002979302080348134, -0.007861501537263393, 0.029418153688311577, 0.003723681438714266, -0.030075063928961754, -0.01512321550399065, -0.007079635746777058, 0.002329532289877534, 0.028032930567860603, 0.002450917847454548, -0.008468429557979107, -0.0014200328150764108, 0.04538392648100853, 0.05680845305323601, 0.0385863371193409, 0.027304615825414658, -0.00968942604959011, 0.014273516833782196, -0.015408828854560852, -0.01940741389989853, 0.017936505377292633, -0.025248201563954353, -0.021620914340019226, 0.010524843819439411, -0.013995043933391571, 0.013630887493491173, -0.024619853124022484, 0.01385937724262476, -0.0066726370714604855, 0.009717986918985844, -0.0035183969885110855, 0.01493756752461195, -0.0033345334231853485, -0.018250679597258568, 0.008975393138825893, -0.01617998443543911, 0.007254573982208967, -0.019121799618005753, -0.031160393729805946, 0.021763721480965614, -0.006729759741574526, 0.0014164627064019442, -0.0385863371193409, -0.021420985460281372, 0.032417092472314835, -0.04298477619886398, 0.024577010422945023, 0.006622654851526022, 0.016279948875308037, -0.011588753201067448, -0.011288859881460667, -0.00023920100647956133, 0.021592354401946068, -0.007208161521703005, 0.028932610526680946, -0.04949675872921944, 0.02898973412811756, 0.020606989040970802, 0.02731889672577381, 0.016351351514458656, 0.023106103762984276, 0.026105040684342384, -0.0030703411903232336, -0.04709760844707489, -0.014523427933454514, -0.005444500595331192, -0.011645875871181488, 0.014202113263309002, 0.006412014830857515, -0.0017645537154749036, 0.013395256362855434, 0.0035844449885189533, 0.007861501537263393, -0.03541602939367294, 0.003655848326161504, -0.030703412368893623, -0.029446715489029884, 0.04075699672102928, 0.002754381624981761, 0.0046840556897223, -0.004819721914827824, -0.030589167028665543, 0.011995752342045307, -0.006026437506079674, 0.007997168228030205, 0.011760121211409569, -0.006179954390972853, 0.018721941858530045, -0.0008443438564427197, 0.0452696830034256, -0.030589167028665543, 0.0010371326934546232, -0.04598371684551239, -0.004020004998892546, -0.00651197973638773, -0.03518753871321678, 0.03878626599907875, 0.005719403270632029, 0.0028079343028366566, -0.012288505211472511, 0.005019650794565678, 0.023177506402134895, 0.02137814275920391, -0.005601587705314159, 0.0034791249781847, -0.019792990759015083, 0.07545898854732513, -0.0032738405279815197, -0.029818011447787285, 0.003234568750485778, -0.010360616259276867, 0.042442113161087036, -0.021906528621912003, 0.013388115912675858, -0.05506621301174164, -0.005201729480177164, 0.004716186784207821, 0.006087129935622215, 0.015351706184446812, 0.010503423400223255, -0.003093547420576215, -0.011403104290366173, -0.01785082183778286, 0.012645522132515907, 0.019535938277840614, 0.02212073840200901, 0.01133884210139513, 0.03127463907003403, 0.017208192497491837, 0.00951805803924799, 0.01148878876119852, 0.026562022045254707, -0.0019118229392915964, 0.021392423659563065, 0.004441284574568272, 0.04626932740211487, 0.002038563834503293, -0.04758314788341522, -0.028889769688248634, -0.01696542091667652, -0.006819013971835375, 0.023805854842066765, -0.029418153688311577, 0.05632290989160538, 0.004491266794502735, -0.008939690887928009, 0.017508085817098618, 0.026776231825351715, 0.0003994121216237545, -0.00042998165008611977, -0.028961172327399254, -0.024448484182357788, -0.014909005723893642, 0.02089260146021843, 0.003420217428356409, 0.004373451229184866, -0.02597651444375515, -0.020992565900087357, 0.029903696849942207, -0.008939690887928009, -0.008582674898207188, -0.001999292057007551, -0.0020135727245360613, 0.05352390184998512, 0.006254927720874548, 0.013652307912707329, -0.01993579789996147, -0.006129972171038389, -0.018322082236409187, -0.010803316719830036, -0.028118614107370377, -0.05095338448882103, -0.010938983410596848, 0.005887201055884361, -0.018422048538923264, 0.012231382541358471, -0.02579086646437645, -0.007126047741621733, 0.009682285599410534, -0.01996435783803463, -0.01057482697069645, 0.01777941733598709, 0.001983226276934147, 0.034759119153022766, 0.030931903049349785, 0.051496051251888275, -0.006329901050776243, 0.008111413568258286, -0.030589167028665543, 0.01449486706405878, 0.030046502128243446, 0.0006689595174975693, 0.006726189516484737, -0.027233213186264038, -0.02297757752239704, 0.041585274040699005, -0.024291398003697395, 0.01622282713651657, 0.03444494307041168, 0.01959306187927723, 0.00503750192001462, -0.024477045983076096, -0.021349582821130753, -0.008197097107768059, 0.03010362572968006, -0.02790440432727337, -0.025248201563954353, -0.006915408186614513, -0.003384515643119812, -0.023434558883309364, -0.042327865958213806, 0.003805795218795538, -0.02843278832733631, -0.008132833987474442, 0.02464841492474079, 0.006129972171038389, 0.008875428698956966, 0.006926118861883879, 0.014259235933423042, 0.014509147964417934, -0.032302845269441605, 0.03310256451368332, -0.01206001453101635, 0.027304615825414658, -0.013602325692772865, -0.017208192497491837, 0.033530984073877335, 0.015237460844218731, 0.009310988709330559, 0.009303848259150982, 0.002965021412819624, -0.008082851767539978, -0.001691365265287459, 0.00421279389411211, -0.005087484139949083, 0.00064039824064821, -0.04869703948497772, 0.0019671604968607426, 0.027675913646817207, 0.009825091809034348, 0.01323102880269289, 0.030474921688437462, -0.01595149375498295, -0.010710492730140686, -0.02182084321975708, 0.0002974393137264997, -0.003486265428364277, 0.03001794032752514, -0.004883984569460154, 0.013945061713457108, 0.0248626247048378, 0.007104626856744289, -0.00627991883084178, 0.017393840476870537, 0.019650183618068695, 0.008032869547605515, -0.0032399240881204605, -0.020235691219568253, 0.011788682080805302, 0.020664110779762268, 0.006611944176256657, -0.011474507860839367, 0.01562303863465786, 0.0019939367193728685, 0.00957518070936203, -0.03210291638970375, 0.019621623679995537, -0.009717986918985844, -0.009560899809002876, 0.0013700505951419473, 0.03261702135205269, -0.017508085817098618, -0.052267204970121384, -0.002836495405063033, 0.024919746443629265, 0.0024330669548362494, 0.031303200870752335, 0.033759474754333496, -0.013188187032938004, -0.007193881087005138, -0.009782250039279461, -0.011103210970759392, -0.020478462800383568, -0.0004922364023514092, -0.017879381775856018, 0.03235996887087822, -0.013573764823377132, -0.010396318510174751, 0.03313112258911133, 0.0036540632136166096, -0.004841142799705267, -0.007201021537184715, 0.0005930935149081051, 0.015837248414754868, -0.027618790045380592, 0.005669421050697565, 0.022135019302368164, -0.006879706401377916, 0.012345627881586552, 0.015794407576322556, 0.0024223565123975277, 0.057950906455516815, 0.006654786411672831, 0.048639919608831406, 0.026776231825351715, 0.02182084321975708, -0.009767969138920307, -0.0060514286160469055, -0.019321728497743607, -0.030160747468471527, 0.005612298380583525, -0.001428065705113113, 0.01323102880269289, 0.012267084792256355, 0.003977163229137659, 0.006647645961493254, 0.023148944601416588, -8.741323836147785e-05, 0.0005261529586277902, 0.014980409294366837, -0.014923286624252796, 0.0004246263997629285, 0.0189218707382679, 0.015094654634594917, -0.024619853124022484, -0.0385863371193409, 0.012652662582695484, 0.026562022045254707, 0.020164288580417633, -0.006754750851541758, 0.0058729201555252075, 0.02604791894555092, 0.01538026798516512, -0.009532338939607143, -0.007425941526889801, -0.009639443829655647, -0.002077835611999035, -0.020978284999728203, 0.011253157630562782, -0.013409537263214588, 0.002220642287284136, -0.0008331870776601136, -0.018193557858467102, 0.0009246725239790976, 0.004291337449103594, 0.020721232518553734, 0.010324914939701557, 0.023620206862688065, 0.014780480414628983, 0.02734745852649212, -0.031531691551208496, 0.055608879774808884, 0.002036778721958399, 0.003662988543510437, -0.04144246503710747, 0.006726189516484737, -0.0004726004844997078, 0.06563390046358109, -0.0274617038667202, -0.04127109795808792, -0.0015985410427674651, -0.029903696849942207, 0.005487342365086079, 0.0037879443261772394, 0.01870766095817089, 0.0371011458337307, -0.031188955530524254, -0.0072295828722417355, -0.009525198489427567, 0.006054998375475407, -0.007447362877428532, 0.034159332513809204, -0.03767237439751625, 0.032531335949897766, -0.012267084792256355, -0.011888647451996803, -0.015865810215473175, 0.015408828854560852, -0.0003340334806125611, -0.029446715489029884, 0.0026990443002432585, 0.030332116410136223, -0.007158179301768541, 0.019650183618068695, -0.0015324930427595973, -0.021992212161421776, 0.02797580696642399, -0.023505961522459984, 0.01585152931511402, -0.0049375370144844055, 0.003805795218795538, -0.007497345097362995, -0.019350290298461914, -0.005208869464695454, 0.043584566563367844, 0.008782603777945042, -0.008754042908549309, 0.0051695979200303555, 0.004605512134730816, -0.005558745935559273, -0.012881152331829071, -0.0017895448254421353, -0.0027472414076328278, -0.021920809522271156, -0.020921163260936737, 0.01662268489599228, -0.01482332218438387, -0.02809005230665207, -0.0033416738733649254, 0.01139596477150917, 0.03210291638970375, 0.0345020666718483, -0.0006595878512598574, 0.0504678413271904, 0.0064298659563064575, 0.01815071515738964, -0.007147469092160463, 0.0030221440829336643, 0.014566270634531975, 0.02126389928162098, 0.006697628181427717, 0.02650490030646324, -0.011324561201035976, 0.005562316160649061, 0.0012772262562066317, 0.009189602918922901, -0.0020814058370888233, -0.01122459676116705, -0.0039914436638355255, -0.032559897750616074, 0.004148530773818493, -0.04115685448050499, -0.011895786970853806, 0.04761170968413353, 0.026633424684405327, 0.017493804916739464, 0.03287407383322716, -0.024776939302682877, 0.036272868514060974, -0.006565532181411982, -0.0102035291492939, 0.008875428698956966, 0.022577719762921333, 0.01710822805762291, 0.016708368435502052, 0.0010933628072962165, -0.010439160279929638, 0.007115337532013655, -0.03618718683719635, -0.01866481825709343, -0.007261713966727257, 0.010382037609815598, -0.0006814551306888461, 0.008739762008190155, -0.02226354368031025, 0.0012415245873853564, 0.041956569999456406, 0.019535938277840614, 0.0065298303961753845, 0.002631210954859853, 0.005401658359915018, 0.015594477765262127, -0.00848271045833826, -0.006454857066273689, -0.025519534945487976, 0.002559807850047946, -0.03890050947666168, -0.03073197416961193, 0.01640847511589527, 0.010346336290240288, -0.018879028037190437, 0.02214929834008217, -0.01796506717801094, -0.0013762983726337552, -0.01505181286484003, -0.011952909640967846, -0.011203175410628319, 0.017165349796414375, 0.014609112404286861, 0.04107116907835007, -0.01031777448952198, -0.011210315860807896, -0.009125339798629284, -0.004651924129575491, 0.0051803081296384335, -0.0178079791367054, 0.01622282713651657, -0.02049274370074272, 0.004002154339104891, -0.03535890579223633, -0.010639089159667492, 0.021035408601164818, -0.008646938018500805, 0.031074710190296173, -0.006611944176256657]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
".-W., Kwiatkowski, T., Collins,
M., and Toutanova, K. Boolq: Exploring the surprising
difficulty of natural yes/no questions. arXiv preprint
arXiv:1905.10044 , 2019.
Clark, P., Cowhey, I., Etzioni, O., Khot, T., Sabharwal, A.,
Schoenick, C., and Tafjord, O. Think you have solved
question answering? try arc, the ai2 reasoning challenge.
arXiv preprint arXiv:1803.05457 , 2018.
Dai, S., Genc, H., Venkatesan, R., and Khailany, B. Efficient
transformer inference with statically structured sparse
attention. In 2023 60th ACM/IEEE Design Automation
Conference (DAC) , pp. 1–6. IEEE, 2023.
Dao, T. Flashattention-2: Faster attention with bet-
ter parallelism and work partitioning. arXiv preprint
arXiv:2307.08691 , 2023.Dao, T., Fu, D., Ermon, S., Rudra, A., and R ´e, C. Flashat-
tention: Fast and memory-efficient exact attention with
io-awareness. Advances in Neural Information Process-
ing Systems , 35:16344–16359, 2022.
Dettmers, T. 8-bit approximations for parallelism in deep
learning. arXiv preprint arXiv:1511.04561 , 2015.
Dettmers, T. and Zettlemoyer, L. The case for 4-bit preci-
sion: k-bit inference scaling laws. In International Con-
ference on Machine Learning , pp. 7750–7774. PMLR,
2023.
Dettmers, T., Lewis, M., Belkada, Y ., and Zettlemoyer, L.
Llm. int8 (): 8-bit matrix multiplication for transformers
at scale. arXiv preprint arXiv:2208.07339 , 2022.
facebookresearch. xformers - toolbox to accelerate re-
search on transformers. https://github.com/
facebookresearch/xformers , 2023. Accessed:
December 12, 2023.
Fan, A., Grave, E., and Joulin, A. Reducing transformer
depth on demand with structured dropout. arXiv preprint
arXiv:1909.11556 , 2019.
Fang, C., Zhou, A., and Wang, Z. An algorithm–hardware
co-optimized framework for accelerating n: M sparse
transformers. IEEE Transactions on Very Large Scale
Integration (VLSI) Systems , 30(11):1573–1586, 2022.
Frankle, J. and Carbin, M. The lottery ticket hypothesis:
Finding sparse, trainable neural networks. arXiv preprint
arXiv:1803.03635 , 2018.
Frantar, E., Ashkboos, S., Hoefler, T., and Alistarh, D. Gptq:
Accurate post-training quantization for generative pre-
trained transformers. arXiv preprint arXiv:2210.17323 ,
2022.
Ham, T. J., Jung, S. J., Kim, S., Oh, Y . H., Park, Y ., Song, Y .,
Park, J.-H., Lee, S., Park, K., Lee, J. W., et al. Aˆ 3: Ac-
celerating attention mechanisms in neural networks with
approximation. In 2020 IEEE International Symposium
on High Performance Computer Architecture (HPCA) ,
pp. 328–341. IEEE, 2020.
Ham, T. J., Lee, Y ., Seo, S. H., Kim, S., Choi, H., Jung, S. J.,
and Lee, J. W. Elsa: Hardware-software co-design for
efficient, lightweight self-attention mechanism in neural
networks. In 2021 ACM/IEEE 48th Annual International
Symposium on Computer Architecture (ISCA) , pp. 692–
705. IEEE, 2021.
Hoffmann, J., Borgeaud, S., Mensch, A., Buchatskaya, E.,
Cai, T., Rutherford, E., Casas, D. d. L., Hendricks, L. A.,
Welbl, J., Clark, A., et al. Training compute-optimal
large language models. arXiv preprint arXiv:220","[-0.00422204053029418, 0.03089532069861889, 0.013334925286471844, 0.009027141146361828, 0.02861795760691166, -0.01928899623453617, -0.019467344507575035, 0.0511995293200016, -0.060418736189603806, 0.0019978380296379328, 0.03855055570602417, -0.007888458669185638, -0.011812109500169754, 0.02826126106083393, -0.004647331312298775, -0.0016068448312580585, 0.040169402956962585, -0.02902952954173088, 0.041157178580760956, 0.028947213664650917, -0.039593204855918884, -0.03108738735318184, 0.010172681882977486, 0.017999405041337013, 0.021333137527108192, 0.0089585455134511, -0.012518641538918018, 0.009459291584789753, 0.012703849002718925, -0.04980018362402916, 0.0366024486720562, -0.031197139993309975, -0.03704145923256874, -0.032733675092458725, 0.006866388954222202, 0.04214495047926903, 0.0168607234954834, 0.02053743042051792, -0.03278855234384537, 0.034654341638088226, 0.024337610229849815, -0.06919893622398376, -0.02099015936255455, 0.029495976865291595, -0.014391292817890644, 0.004095138981938362, 0.018260067328810692, -0.008101104758679867, -0.013478975743055344, 0.06585147976875305, -0.03149896115064621, 0.036959145218133926, -0.060418736189603806, 0.02015329711139202, -0.03649269789457321, 0.007998211309313774, -0.02640918828547001, 0.031937967985868454, 0.030017301440238953, 0.017807338386774063, 0.0006422234582714736, -0.07545482367277145, 0.0009388981270603836, 0.02900209091603756, -0.03841336444020271, 0.009171190671622753, -0.0446692556142807, 0.011119297705590725, -0.007092753425240517, 0.03975783288478851, -0.0008518678369000554, 0.03926394507288933, 0.042830903083086014, -0.0527360625565052, 0.01739576645195484, 0.022485537454485893, 0.0012741575483232737, 0.09581390768289566, -0.02326752431690693, -0.014994931407272816, 0.014089473523199558, -0.01640799455344677, 0.012278557755053043, -0.042940653860569, -0.026752164587378502, -0.03147152066230774, -0.021717270836234093, -0.027534151449799538, -0.04749538376927376, -0.029852671548724174, -0.01278616301715374, 0.01708022877573967, -0.0346817821264267, 0.015241874381899834, 0.03638294339179993, 0.019343873485922813, 0.03325499966740608, 0.01729973405599594, 0.019028333947062492, 0.044147931039333344, 0.022801075130701065, 0.020084701478481293, 0.028288699686527252, -0.034270208328962326, 0.0350659154355526, -0.03037399612367153, -0.0114554138854146, -0.031800780445337296, 0.0022139132488518953, 0.03166358917951584, -0.09537489712238312, -0.028206385672092438, -0.030813006684184074, 0.022471819072961807, 0.012388310395181179, -0.049141667783260345, -0.041925445199012756, -0.00467819906771183, -0.015104684047400951, 0.023226367309689522, -0.008087385445833206, -0.0031811068765819073, 0.025805549696087837, 0.05224217474460602, 0.036520134657621384, -0.0017517523374408484, 0.033913515508174896, -0.04713868722319603, -0.004101998638361692, -0.007799284998327494, 0.020276769995689392, 0.002207053592428565, 0.055068302899599075, -0.022183718159794807, -0.001311027561314404, -0.05205010995268822, -0.012985088862478733, 0.005710558500140905, -0.0352579802274704, -0.004095138981938362, 0.03306293115019798, -0.007840442471206188, -0.020400241017341614, 0.028727710247039795, -0.0469740591943264, 0.040196843445301056, 0.002069863025099039, 0.01312228012830019, -0.017793620005249977, 0.021936776116490364, 0.007984491996467113, -0.019234120845794678, -0.03646525740623474, -0.011290785856544971, -0.037370715290308, -0.05421772226691246, -0.044175371527671814, 0.08977752178907394, 0.02509215846657753, -0.056193266063928604, 0.018561886623501778, 0.03226722776889801, 0.01398658100515604, 0.019878916442394257, 0.0200298260897398, 0.0406358540058136, -0.01983775943517685, -0.0048531172797083855, -0.059650469571352005, -0.039209071546792984, -0.0008771623251959682, -0.031800780445337296, 0.0006207874394021928, -0.004517000168561935, 0.02393975853919983, 0.0017225993797183037, -0.038084108382463455, -0.02451595850288868, -0.02864539436995983, -0.0408279187977314, -0.0053435736335814, 0.013664182275533676, -0.017423205077648163, 0.03413301706314087, -0.02864539436995983, -0.03265136107802391, -0.003155383514240384, 0.02156636118888855, 0.020551150664687157, 0.029249032959342003, -0.018726514652371407, 0.01801312528550625, 0.04661736264824867, 0.0204139593988657, -0.008759618736803532, -0.0439009889960289, 0.05805905908346176, -0.02922159619629383, 0.012793022207915783, -0.021744707599282265, -0.0035326576326042414, 0.055260367691516876, -0.004359230864793062, -0.04099254682660103, 0.024241577833890915, -0.018685357645154, -0.008855652995407581, -0.020359084010124207, -0.016901880502700806, -0.031005073338747025, 0.04944348707795143, -0.00040985687519423664, 0.03630062937736511, 0.010062930174171925, -0.0032205490861088037, -0.013794513419270515, -0.0517757274210453, 0.028919776901602745, 0.0024111245293170214, 0.051062338054180145, -0.007284820079803467, 0.02118222787976265, 0.012628394179046154, 0.02178586646914482, -0.032953180372714996, 0.03624575212597847, 0.012264838442206383, -0.037480469793081284, 0.01563972793519497, -0.007106472738087177, 0.032925739884376526, 0.012223681434988976, -0.018095439299941063, -0.03174590319395065, -0.02236206643283367, -0.05243424326181412, 0.028151508420705795, -0.03396838903427124, 0.010426484979689121, -0.05959559231996536, 0.018644200637936592, -0.016847005113959312, 0.0068560997024178505, 0.004170593805611134, -0.028028037399053574, 0.050870269536972046, -0.025750674307346344, -0.059650469571352005, 0.05298300459980965, 0.011770952492952347, 0.004753653891384602, -0.01688816212117672, -0.020427679643034935, -0.011174173094332218, -0.03934626281261444, -0.01890486292541027, 0.0034674920607358217, -0.00036184018244966865, -0.013259470462799072, 0.00796391349285841, -0.007991352118551731, 0.02118222787976265, 0.027890846133232117, -0.0075111850164830685, 0.012854758650064468, 0.016298241913318634, -0.017423205077648163, 0.030813006684184074, -0.01283417921513319, -0.00935639813542366, 0.033666569739580154, 0.007154489401727915, 0.008375485427677631, 0.011860126629471779, -0.06491858512163162, -0.020276769995689392, 0.03262392058968544, 0.008691024035215378, -0.051226966083049774, 0.009623919613659382, 0.023432152345776558, 0.022416941821575165, 0.04897703975439072, 0.02614852599799633, -0.002486579352989793, 0.013060543686151505, -0.006036385893821716, -0.019755445420742035, -0.037123773247003555, -0.012889055535197258, 0.028096633031964302, -0.026587536558508873, 0.024214139208197594, -0.042666275054216385, 0.023322399705648422, -0.006739487871527672, 0.0027661053463816643, 0.011112437583506107, 0.03092275932431221, -0.049909938126802444, 0.032349541783332825, -0.018438415601849556, 0.023048019036650658, 0.0036595589481294155, -0.0038241876754909754, 0.0398675836622715, -0.03358425572514534, 0.02509215846657753, 0.053915902972221375, 0.007799284998327494, 0.0027112290263175964, -0.006142708472907543, -0.003724724519997835, 0.016202209517359734, -0.03898956626653671, -0.0259838979691267, 0.018452133983373642, -0.04584909602999687, 0.020208174362778664, -0.05034894496202469, -0.032322101294994354, -0.05635789409279823, -0.027890846133232117, 0.00250715808942914, 0.01621592789888382, -0.0026735016144812107, -0.013026246801018715, 0.003776171011850238, -0.01448732614517212, -0.02710886113345623, 0.006681181490421295, -0.01020697969943285, 0.030072176828980446, -0.02576439268887043, -0.049169108271598816, -0.0063965111039578915, -0.019508501514792442, 0.05136415734887123, 0.005395019892603159, 0.01467939279973507, -0.08632031828165054, 0.0024780051317065954, -0.05805905908346176, -0.0369865819811821, -0.02490009181201458, 0.03528542071580887, 0.016366837546229362, 0.003064494812861085, 0.04406561702489853, 0.002256785286590457, 0.013787654228508472, -0.023596782237291336, 0.052159860730171204, -0.047824639827013016, -0.008457799442112446, 0.013945423066616058, 0.004335222765803337, -0.0234870295971632, -0.016613779589533806, 0.0028672832995653152, 0.007161348592489958, 0.03605368733406067, 0.059869974851608276, -0.01698419451713562, -0.014775426127016544, 0.007826723158359528, -0.019906355068087578, 0.04848315566778183, 0.0035600957926362753, -0.015529974363744259, 0.01878139190375805, 0.04719356447458267, -0.01640799455344677, -0.033501941710710526, -0.014363855123519897, -0.019604535773396492, -0.01813659630715847, 0.01384253054857254, 0.019604535773396492, 0.054903674870729446, 0.04711124673485756, 0.017601553350687027, -0.03490128740668297, -0.019920073449611664, -0.007826723158359528, 0.020811812952160835, 0.016037579625844955, -0.005209812428802252, -0.04746794328093529, 0.0019755444955080748, -0.007325977552682161, -0.01720369979739189, -0.06074799224734306, 0.004523859824985266, 0.0040745604783296585, 0.028151508420705795, 0.005868327338248491, 0.014048316515982151, 0.018342381343245506, 0.029249032959342003, -0.028508204966783524, 0.00916433148086071, 0.0050726220943033695, -0.01592782698571682, 0.02592902071774006, 0.012045334093272686, 0.03797435387969017, 0.05457441508769989, 0.026395469903945923, -0.0018589325482025743, 0.05114465206861496, -0.05268118530511856, 0.01621592789888382, 0.01378079503774643, 0.005940352566540241, -0.05205010995268822, -0.010124665684998035, 0.012552939355373383, -0.006756636314094067, 0.03822129964828491, -0.0354500487446785, 0.017601553350687027, -0.041705939918756485, -0.02922159619629383, -0.06563197821378708, 0.006866388954222202, 0.029825234785676003, -0.08061318844556808, 0.03358425572514534, -0.04969043284654617, -0.047028932720422745, -0.019110649824142456, 0.012875337153673172, -0.015255593694746494, 0.0038241876754909754, -0.02977035753428936, 0.02236206643283367, 0.03267879784107208, 0.03687683120369911, -0.03572443127632141, -0.015433941036462784, -0.006214733701199293, -0.02201909013092518, 0.01765642873942852, -0.03701402246952057, 0.007723830174654722, -0.011812109500169754, 0.01142111700028181, -0.003954518586397171, -0.0333373136818409, 0.022032808512449265, -0.005696839187294245, 0.07594870775938034, -0.009130033664405346, -0.008375485427677631, -0.025970177724957466, 0.07424754649400711, 0.007065315265208483, 0.06596123427152634, -0.014775426127016544, 0.01954965852200985, -0.00494229095056653, -0.041870567947626114, -0.005093200597912073, 0.010536237619817257, 0.016901880502700806, 0.019810320809483528, -0.002522591967135668, 0.025874145328998566, 0.006523412652313709, -0.004643901251256466, -0.02050999365746975, 0.0065371314994990826, -0.0229108277708292, 0.0114554138854146, 0.015241874381899834, 0.014089473523199558, -0.0004818819579668343, 0.00040471224929206073, -0.046644799411296844, 0.025229349732398987, -0.047028932720422745, 0.0011035267962142825, -0.0018520730081945658, 0.036547571420669556, 0.03396838903427124, 0.009507307782769203, 0.011270207352936268, 0.026765884831547737, 0.009829705581068993, -0.004376379773020744, -0.014281540177762508, 0.05375127121806145, -0.016092456877231598, -0.0030713542364537716, -0.0005972078070044518, -0.019343873485922813, -0.02660125494003296, -0.012011036276817322, -0.025435134768486023, -0.001461937208659947, -0.028590518981218338, 0.021813303232192993, 0.002085296902805567, -0.017066508531570435, -0.030785568058490753, 0.05668715015053749, 0.024762900546193123, 0.0017646139021962881, 0.02941366285085678, 0.006540561560541391, 0.012895915657281876, 0.01794452965259552, 0.030977634713053703, -0.002778109395876527, 0.025901583954691887, -0.0058305999264121056, 0.014761707745492458, -0.0027112290263175964, 0.022073965519666672, -0.03037399612367153, -0.028055476024746895, -0.03051118738949299, -0.011078139767050743, -0.00023022295499686152, -0.00797763280570507, -0.05386102572083473, -0.12456905841827393, -0.022677604109048843, -0.024694306775927544, -0.01650402881205082, -0.013938563875854015, 0.0010923800291493535, -0.01705279015004635, -0.04807158187031746, -0.0028552792500704527, 0.015598569996654987, -0.014981212094426155, -0.06788190454244614, 0.0046850587241351604, 0.0028672832995653152, 0.01756039634346962, 0.009075157344341278, 0.024845216423273087, -0.009987475350499153, -0.029303910210728645, 0.00342462002299726, -0.032898303121328354, -0.02415926195681095, 0.016133613884449005, 0.03473665565252304, -0.03931882232427597, 0.012573517858982086, -0.009383836761116982, -0.0002857422805391252, -0.0045684464275836945, 0.040196843445301056, 0.018479572609066963, -0.0027832540217787027, -0.010577394627034664, 0.013245751149952412, -0.027067704126238823, -0.02134685590863228, 0.0019309575436636806, -0.022087685763835907, 0.014720549806952477, -0.003369743935763836, -0.037892039865255356, -0.0034229052253067493, -0.01515956036746502, -0.01330062747001648, -0.02516075409948826, 0.027918284758925438, -0.031965408474206924, 0.017258577048778534, 0.004256337881088257, -0.019700568169355392, 0.02765762247145176, -0.02072949893772602, 0.023377276957035065, -0.03396838903427124, -0.02223859541118145, -0.029111843556165695, -0.008389204740524292, -0.027822252362966537, 0.022965705022215843, -0.009562184102833271, 0.015036088414490223, -0.04768744856119156, -0.010824337601661682, 0.052571434527635574, -0.0214703269302845, -0.02653265930712223, -0.048181336373090744, -0.02823382243514061, -0.018959740176796913, -0.002339099533855915, -0.027547869831323624, -0.05550731346011162, 0.01938503049314022, 0.0020184165332466364, -0.0020441398955881596, 0.0026786462403833866, -0.03503847494721413, -0.022705042734742165, -0.004945720545947552, -0.034434836357831955, -0.002184760058298707, 0.012230540625751019, 0.004722786135971546, -0.006249031517654657, -0.007867880165576935, -0.014830302447080612, -0.009006562642753124, -0.02550373040139675, -0.005741426255553961, -0.033858638256788254, -0.0035498065408319235, 0.04118461534380913, -0.006015807390213013, 0.013417239300906658, -0.044147931039333344, 0.004691918380558491, 0.039181631058454514, -0.0014002014650031924, 0.02941366285085678, 0.013211453333497047, -0.018177753314375877, -0.04450462758541107, -0.001126677729189396, -0.04535520821809769, 0.0006079258164390922, 0.0213742945343256, 0.03380376100540161, -0.011187892407178879, 0.00777870649471879, -0.0098708625882864, -0.009953177534043789, 0.022732481360435486, -0.02612108737230301, 0.012902774848043919, -0.002376826945692301, -0.0020149867050349712, 0.006482255179435015, 0.003988816402852535, 0.009157472290098667, -0.028672832995653152, 0.008203997276723385, -0.011482852511107922, 0.003314867615699768, -0.022636447101831436, -0.04579421877861023, 0.03374888375401497, 0.015447660349309444, 0.020455116406083107, 0.002363107865676284, -0.021964212879538536, -0.04845571517944336, -0.009088876657187939, -0.004897703882306814, -0.04905935376882553, 0.007120191585272551, -0.0015245304675772786, 0.0018246348481625319, -0.02188189886510372, 0.03267879784107208, 0.04392842575907707, 0.029852671548724174, -0.015200717374682426, -0.020743217319250107, -0.00796391349285841, 0.013348644599318504, 0.02794572338461876, -0.008128542453050613, -0.0021676113829016685, -0.04038890823721886, 0.018849987536668777, -0.019138086587190628, 0.02564092166721821, 0.022032808512449265, -0.0498550608754158, 0.013499554246664047, -0.06738802045583725, -0.004952580202370882, 0.03435252234339714, -0.0006220735958777368, 0.014651955105364323, 0.016037579625844955, 0.03975783288478851, -0.017066508531570435, -0.016202209517359734, -0.005851178430020809, 0.026134807616472244, -0.025201911106705666, 0.01557113230228424, -0.011222190223634243, 0.0056899795308709145, 0.05114465206861496, -0.027122579514980316, -0.11035610735416412, -0.022005369886755943, 0.021099912002682686, -0.014350135810673237, -0.0025517449248582125, -0.017121385782957077, -0.03073069266974926, -0.014322697184979916, 0.028700271621346474, 0.07073546946048737, -0.043187595903873444, -0.019906355068087578, 0.002778109395876527, 0.0007451163837686181, 0.004218610469251871, -0.025586044415831566, 0.027547869831323624, 0.024858934804797173, 0.028782585635781288, -0.009802267886698246, -0.03149896115064621, -0.032569047063589096, -0.014651955105364323, -0.024433644488453865, -0.012374591082334518, 0.009013421833515167, -0.03528542071580887, -0.014027738012373447, -0.0026786462403833866, -0.010213839821517467, 0.019261559471488, 0.008931107819080353, 0.028082912787795067, 0.005449896212667227, -0.04030659422278404, -0.00547047471627593, 0.004705637227743864, -0.04145899787545204, -0.013547570444643497, -0.025531169027090073, -0.03416045755147934, -0.017135104164481163, -0.005305846221745014, 0.035011038184165955, 0.031389206647872925, 0.0034863557666540146, 0.020523712038993835, 0.0058305999264121056, 0.001942961709573865, -0.003229123540222645, -0.010920370928943157, -0.015337907709181309, 0.012408888898789883, 0.0221425611525774, 0.0007716970867477357, 0.0006413660012185574, -0.02573695406317711, 0.037864603102207184, -0.004101998638361692, 0.01801312528550625, -0.0069521330296993256, 0.010124665684998035, 0.002946167951449752, -0.03265136107802391, 0.029111843556165695, 0.021319417282938957, -0.02955085225403309, -0.0040745604783296585, -0.02444736286997795, -0.025339102372527122, 0.038056667894124985, 0.005635103676468134, -0.01710766740143299, 0.013396660797297955, -0.0044106775894761086, 0.043269913643598557, -0.013526991941034794, -0.015461379662156105, -0.00034854983096010983, 0.0091025959700346, 0.01832866296172142, -0.032953180372714996, -0.004112287890166044, 0.0037864602636545897, 0.003141664434224367, -0.046864304691553116, -0.01852072961628437, -0.02509215846657753, 0.003947659395635128, -0.013211453333497047, -0.036355506628751755, -0.044175371527671814, 0.0060706837102770805, -0.0010066359536722302, -0.013904266059398651, -0.0025723236612975597, 0.01450104545801878, -0.002248210832476616, -0.06612586230039597, -0.019179243594408035, 0.018932301551103592, -0.013430958613753319, 0.006307337433099747, -0.02101759798824787, 0.02233462780714035, 0.031937967985868454, 0.018026843667030334, -0.033474504947662354, 0.03111482597887516, -0.008574412204325199, 0.012889055535197258, 0.0014199225697666407, 0.026518940925598145, -0.0346817821264267, 0.013979720883071423, -0.028000598773360252, 0.034654341638088226, -0.012703849002718925, -0.0008278594468720257, -0.00421518087387085, 0.012909634038805962, 0.014844021759927273, -0.02588786371052265, 0.005686549935489893, 0.0013736208202317357, 0.003872204339131713, -0.0015819789841771126, 0.015653446316719055, -0.0221425611525774, -0.04376379773020744, 0.008924247696995735, 0.033858638256788254, -0.03610856458544731, 4.2336159822298214e-05, -0.013060543686151505, 0.020784374326467514, -0.0024402777198702097, -0.0024419925175607204, -0.01772502437233925, -0.07287564128637314, 0.04137668013572693, -0.017807338386774063, 0.0510074608027935, 0.022032808512449265, 0.026093650609254837, -0.023473309352993965, 0.035998810082674026, 0.017066508531570435, 0.015022370032966137, -0.004043692722916603, -0.008793916553258896, 0.010742023587226868, 0.013773934915661812, -0.02736952342092991, 0.01055681612342596, -0.005861468147486448, 0.029688043519854546, 0.012937072664499283, -0.0055150617845356464, 0.04233701527118683, 0.02134685590863228, -0.030566062778234482, 0.003844766179099679, -0.027451837435364723, 0.002020131330937147, 0.02413182519376278, 0.0020732928533107042, -0.03994990140199661, -0.03163614869117737, 0.035203106701374054, 0.01067342795431614, -0.002333954907953739, -0.015255593694746494, -0.009541605599224567, 0.02451595850288868, 0.022087685763835907, -0.01643543317914009, -0.018342381343245506, 0.03778228908777237, -0.04000477492809296, -0.017066508531570435, -0.00969251524657011, 0.005353862885385752, 0.027602747082710266, 0.02130569890141487, 0.00372129469178617, 0.00882821436971426, 0.03553236275911331, 0.02701282687485218, -0.0019583955872803926, 0.034434836357831955, -0.023857442662119865, 0.020578589290380478, 0.001050365506671369, -0.006753206718713045, 0.03051118738949299, 0.04623322933912277, 0.0035326576326042414, 0.04348941519856453, 0.05336713790893555, -0.020276769995689392, -0.0460137240588665, -0.022266032174229622, 0.028288699686527252, 0.0003952803963329643, -0.012504922226071358, 0.0011292500421404839, -0.010947808623313904, 0.009301521815359592, 0.007435730192810297, 0.006444527767598629, 0.009671936742961407, 0.03133432939648628, 0.030620940029621124, 0.005659111775457859, 0.020208174362778664, 0.030566062778234482, -0.0036561291199177504, 0.017889652401208878, 0.015900390222668648, -0.02092156559228897, 0.005593946203589439, -0.031581275165081024, -0.04974530637264252, 0.02650522254407406, 0.02060602605342865, -0.02752043306827545, -0.0012141367187723517, 0.014267820864915848, 0.027328364551067352, -0.004791381303220987, 0.001961825415492058, 0.022855952382087708, 0.009136892855167389, 0.006050105206668377, 0.03989502415060997, -0.0392913855612278, 0.03166358917951584, -0.02192305587232113, -0.009918879717588425, 0.008574412204325199, -0.00013708340702578425, -0.007175067905336618, -0.014912617392838001, -0.00025980468490161, -0.023857442662119865, -0.003748732851818204, -0.008917388506233692, 0.026711007580161095, -0.0022190578747540712, 0.0019858337473124266, 0.03720608726143837, 0.017327170819044113, 0.023418433964252472, -0.02451595850288868, -0.023445872589945793, -0.02211512252688408, 0.05740054324269295, 0.020647183060646057, 0.009754250757396221, 0.01488517876714468, -0.006924694869667292, 0.014281540177762508, -0.025270506739616394, -0.037507906556129456, -0.017354609444737434, -0.011736654676496983, 0.020400241017341614, -0.019083211198449135, 0.01225797925144434, 0.048400841653347015, 0.0440930537879467, 0.025133315473794937, 0.008835073560476303, -0.0006134991417638958, 0.0066365948878228664, 0.015529974363744259, 0.014624516479671001, 0.016778409481048584, 0.010145244188606739, 0.006262750364840031, -0.015502536669373512, 0.017231138423085213, 0.039620641618967056, 0.005923203658312559, 0.02269132435321808, 0.019920073449611664, 0.025874145328998566, 0.005628244020044804, 0.00969251524657011, -0.0022053387947380543, 0.02864539436995983, 0.0023545334115624428, -0.010508798994123936, 0.0049045635387301445, 0.018342381343245506, -0.015118403360247612, -0.03509335219860077, 0.0002808119752444327, 0.027904566377401352, 0.01397286169230938, -0.02230718918144703, -0.0389072522521019, 0.036520134657621384, 0.010419624857604504, -0.027794813737273216, -0.016778409481048584, 0.03671220317482948, -0.010824337601661682, 0.016462869942188263, -0.0010117805795744061, 0.040580976754426956, -0.0214703269302845, 0.0014267821097746491, 0.028892338275909424, 0.007229944225400686, -0.02072949893772602, -0.019851477816700935, -0.055617064237594604, -0.024625711143016815, -0.011352521367371082, -0.0165726225823164, -0.022156279534101486, 0.013732777908444405, 0.008910528384149075, 0.014926335774362087, -0.007744408678263426, 0.01158574502915144, 0.015626007691025734, 0.0009191769640892744, 0.00013343928731046617, 0.013033105991780758, 0.012237400747835636, -0.022993143647909164, 0.007428870536386967, -0.010954668745398521, -0.01350641343742609, 0.003455488011240959, 0.0121276481077075, 0.02448851987719536, 0.0327611118555069, 0.02602505497634411, 0.003961378242820501, 0.003229123540222645, 0.012806741520762444, 0.013671042397618294, -0.005110349506139755, -0.0007592641632072628, -0.006530271843075752, -0.008691024035215378, 0.014830302447080612, -0.0033954670652747154, 0.001970399869605899, -0.0010512229055166245, 0.014926335774362087, 0.0431327223777771, 0.0235830619931221, 0.035230543464422226, 0.0013676186790689826, 0.0217584278434515, 0.009569043293595314, -0.02413182519376278, 0.01611989364027977, -0.02900209091603756, -0.008889949880540371, -0.014240383170545101, -0.013081123121082783, 0.005888905841857195, -0.059869974851608276, 0.0017388907726854086, 0.009349538944661617, 0.007682673167437315, 0.007984491996467113, -0.0053641521371901035, -0.009987475350499153, 0.0014062034897506237, 0.012546079233288765, -0.002868998097255826, -0.029139280319213867, -0.027959441766142845, 0.01259409636259079, -0.004235759377479553, 0.015200717374682426, -0.012628394179046154, -0.04181569069623947, -0.003037056652829051, 0.02861795760691166, -0.02297942340373993, 0.0004492991720326245, 0.01717626117169857, -0.020139578729867935, -0.023418433964252472, -0.02736952342092991, 0.015653446316719055, -0.0009929168736562133, 0.0059815095737576485, 0.0214703269302845, -0.03476409614086151, 0.012690129689872265, 0.02653265930712223, 0.03182821720838547, -0.0200298260897398, 0.007545482367277145, 0.010474501177668571, 0.005089771002531052, -0.07144886255264282, -0.0046850587241351604, 0.02355562336742878, -0.018410976976156235, 0.018452133983373642, 0.008046228438615799, 0.0052681188099086285, 0.03223978728055954, 0.029934987425804138, 0.00620101485401392, -0.040937673300504684, 0.010954668745398521, 0.004661050159484148, -0.015872951596975327, 0.02022189274430275, 0.0016385701019316912, -0.00211102026514709, -0.024076947942376137, -0.028672832995653152, 0.01467939279973507, -0.019728006795048714, 0.02182702347636223, 0.022485537454485893, -0.009246645495295525, 0.007847301661968231, 0.005737996194511652, 0.023514466360211372, -0.02173098921775818, 0.004465553909540176, -0.006633164826780558, 0.020167017355561256, 0.01206591259688139, -0.013149717822670937, 0.021264541894197464, 0.015598569996654987, -0.020976440981030464, 0.0032908592838793993, 0.006681181490421295, -0.007792425341904163, -0.017025351524353027, 0.004400388337671757, 0.002357963239774108, -0.009027141146361828, 0.06969282031059265, -0.019055772572755814, 0.0006237884517759085, -0.00725738238543272, -0.0077581279911100864, 0.0346817821264267, -0.029907548800110817, 0.014734269119799137, -0.02099015936255455, 0.003858485259115696, -0.01595526561141014, 0.017793620005249977, -0.02806919440627098, -0.0037281543482095003, 0.0348738469183445, -0.015914108604192734, -0.03421533480286598, 0.009363257326185703, -0.019659411162137985, 0.03374888375401497, 0.02806919440627098, 0.03701402246952057, -0.0091025959700346, -0.02230718918144703, 0.011860126629471779, -0.0024522817693650723, 0.004760513547807932, 0.03610856458544731, 0.0131840156391263, 0.03811154514551163, -0.002658067736774683, -0.04206263646483421, -0.04656248539686203, 0.0019189533777534962, -0.0015348197193816304, 0.032322101294994354, -0.06716851145029068, 0.03734327852725983, -0.03802923113107681, 0.004887414630502462, -0.00043708065641112626, -0.00672233896329999, 0.011379959061741829, 0.013623025268316269, -0.03435252234339714, -0.010536237619817257, -0.02634059265255928, -0.0021556071005761623, -0.019947512075304985, -0.015132121741771698, -0.01662749983370304, -0.011105578392744064, 0.0352579802274704, -0.025133315473794937, 0.018849987536668777, -0.015653446316719055, 0.016833284869790077, 0.07369878143072128, 0.022005369886755943, 0.03210259974002838, -0.010824337601661682, -0.008066806942224503, -0.018987176939845085, -0.016366837546229362, -0.035587240010499954, -0.0502391941845417, -0.017574114724993706, -0.019330153241753578, 0.014295259490609169, 0.005641962867230177, -0.00930838193744421, -0.009761110879480839, 0.017779899761080742, -0.011750373989343643, 0.013321205973625183, 0.012710708193480968, 0.024543397128582, 0.022773638367652893, 0.008992843329906464, 0.030867882072925568, -0.0335293784737587, -7.958125934237614e-05, -0.004637042060494423, 0.020180735737085342, 0.015186998061835766, 0.0035120791289955378, 0.014267820864915848, -0.021168507635593414, -0.025750674307346344, 0.04000477492809296, -0.003350880229845643, -0.00110181188210845, 0.03643782064318657, 0.013897406868636608, -0.02977035753428936, -0.036520134657621384, -0.03470921888947487, -0.012354012578725815, 0.05454697832465172, 0.003779600840061903, -0.018918583169579506, 0.020935283973813057, -0.031059948727488518, 0.001717454637400806, -0.0016668656608089805, -0.004530719015747309, -0.020770655944943428, -0.012203102931380272, 0.030785568058490753, 0.0005920631228946149, -0.008519535884261131, -0.0001871365384431556, 0.003133089980110526, 0.011208470910787582, 0.014459888450801373, 0.008190277963876724, 0.016284523531794548, 0.013911126181483269, 0.0005740568740293384, -0.05021175742149353, 0.042858339846134186, 0.008903669193387032, 0.025339102372527122, -0.010954668745398521, -0.004359230864793062, -0.014789145439863205, 0.02941366285085678, -0.028316138312220573, -0.018273785710334778, -0.003069639438763261, 0.006451387424021959, 0.007209365256130695, 0.007881599478423595, 0.0008934537181630731, 0.01916552521288395, 0.04851059243083, 0.009644498117268085, 0.004355801269412041, -0.01345839723944664, -0.009349538944661617, 0.03377632424235344, 0.04425768554210663, 0.005192663986235857, 0.04071816802024841, 0.01806800067424774, -0.019179243594408035, -0.012841039337217808, -0.024186700582504272, 0.0182051919400692, -0.0027215182781219482, -0.006094691809266806, -0.013746497221291065, 0.01983775943517685, 0.01089293323457241, -0.002064718399196863, -0.012182524427771568, 0.004424396436661482, -0.011949300765991211, 0.0037041460163891315, -0.017601553350687027, -0.008848792873322964, 0.018671639263629913, -0.009960036724805832, -0.0022602148819714785, 0.022705042734742165, -0.06129675731062889, -0.024721743538975716, 0.0038310473319143057, 0.01100954506546259, 0.0035635256208479404, 0.018822548910975456, 0.025682078674435616, -0.03649269789457321, -0.0017225993797183037, -0.014761707745492458, -0.012038473971188068, -0.002270504366606474, 0.0005290412227623165, -0.013074262998998165, 0.021840741857886314, -0.010062930174171925, -0.019316434860229492, -0.008087385445833206, 0.000867301772814244, -0.032322101294994354, 0.016558904200792313, -0.03720608726143837, 0.004818819463253021, -0.007422010879963636, -0.0027695349417626858, -0.019851477816700935, -0.023349838331341743, 0.033886075019836426, 0.006379362195730209, 0.016970476135611534, 0.024474801495671272, -0.015049807727336884, 0.049717869609594345, 0.04669967666268349, 0.020167017355561256, 0.0025723236612975597, -0.014953774400055408, -0.009082017466425896, -0.022471819072961807, -0.019206682220101357, 0.01299194898456335, 0.015996422618627548, 0.017121385782957077, -0.006588578224182129, -0.003580674296244979, -0.00349664525128901, -0.027863409370183945, -0.01206591259688139, -0.009404415264725685, 0.011023263446986675, -0.006269610021263361, 0.017862215638160706, 0.027438117191195488, -0.05246168002486229, -0.014597078785300255, 0.00011468275624793023, 0.009054578840732574, 0.01691559888422489, 0.006132419221103191, -0.019700568169355392, 0.019467344507575035, 0.013403520919382572, -0.0011309649562463164, -0.002553459955379367, 0.022677604109048843, -0.005676260683685541, -0.005583656951785088, 0.01640799455344677, 0.0013187445001676679, 0.005988369230180979, -0.013197734951972961, -0.0031450942624360323, -0.005617954768240452, 0.01887742429971695, 0.010323591530323029, -0.01621592789888382, 0.03031912073493004, 0.008457799442112446, 0.032157473266124725, -0.0394834503531456, 0.055068302899599075, 0.04126692935824394, 0.028124071657657623, -0.027794813737273216, 0.039017003029584885, -0.0270402655005455, 0.03191053122282028, -0.022759918123483658, -0.0207980927079916, -0.005395019892603159, -0.028014319017529488, 0.010632270947098732, 0.0020372802391648293, 0.01515956036746502, -0.016010141000151634, -0.007133910432457924, -0.03588905930519104, 0.0011232479009777308, 5.648393926094286e-05, -0.06085774675011635, 0.0408279187977314, -0.015241874381899834, 0.038440804928541183, 0.0082863112911582, -0.007099613081663847, -0.01036474946886301, 0.0038824935909360647, -0.007010438945144415, -0.004304354544728994, 0.02435133047401905, 0.01996123045682907, 0.005446466617286205, 0.014432449825108051, -0.008951686322689056, -0.012895915657281876, 0.007456308696419001, -0.0023099465761333704, -0.013513272628188133, -0.0021178796887397766, 0.0021178796887397766, 0.011112437583506107, -0.01243632659316063, -0.012683269567787647, 0.006430808920413256, 0.010645989328622818, 0.0012844469165429473, 0.026875635609030724, 0.028535641729831696, -0.03374888375401497, -0.02204652689397335, -0.001115530962124467, 0.0007343983743339777, -0.004739935044199228, -0.014747988432645798, 0.02144288830459118, 0.003999105654656887, -0.03223978728055954, -0.008149120956659317, 0.0010366464266553521, 0.018246348947286606, 0.03534029424190521, -0.026573816314339638, 0.04768744856119156, 0.013478975743055344, 0.012504922226071358, -0.020784374326467514, 0.017546676099300385, -0.011969879269599915, -0.002517447341233492, -5.551931826630607e-05, 0.033117808401584625, -0.0010049210395663977, 0.015982704237103462, -0.01916552521288395, 0.03945601359009743, 0.00047973834443837404, 0.00046601929352618754, 0.016174770891666412, -0.016010141000151634, -0.018740234896540642, 0.005590516608208418, -0.0018314943881705403, 0.043242473155260086, 0.02701282687485218, -0.025009844452142715, 0.02900209091603756, 0.020208174362778664, 0.017834777012467384, -0.006252461113035679, -0.00207157782278955, 0.0026940801180899143, -0.0030850733164697886, 0.0207980927079916, 0.019151806831359863, -0.04807158187031746, -0.03377632424235344, -0.005048613529652357, -0.01806800067424774, -0.024200420826673508, -0.012141367420554161, 0.012196243740618229, 0.020839249715209007, 0.0012218536576256156, -0.005086340941488743, 0.011681778356432915, 0.039044443517923355, 0.027150018140673637, 0.01583179458975792, 0.0002400835364824161, 0.00954846478998661, 0.028371013700962067, 0.008759618736803532, -0.012902774848043919, -0.009575903415679932, -0.0049045635387301445, -0.029825234785676003, -0.007497465703636408, 0.029331348836421967, 0.009719952940940857, -0.0027232333086431026, 0.019110649824142456, 0.017217418178915977, -0.01073516346514225, -0.02259529009461403, -0.0439009889960289, -0.014857741072773933, 0.027918284758925438, 0.006742917466908693, 0.03437996283173561, -0.03720608726143837, -0.026162246242165565, 0.0005766291869804263, -0.017903372645378113, -0.0011558306869119406, -0.02717745490372181, 0.017601553350687027, -0.03034655936062336, 0.008540114387869835, -0.03336475044488907, -0.007353415712714195, 0.002748956438153982, -0.014350135810673237, 0.02977035753428936, -0.012429467402398586]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"3.15556 ,
2022.
9
Runtime Clustered Head Attention for Efficient Inference
Hooker, S. The hardware lottery. Communications of the
ACM , 64(12):58–65, 2021.
Hsieh, C.-Y ., Li, C.-L., Yeh, C.-K., Nakhost, H., Fujii, Y .,
Ratner, A., Krishna, R., Lee, C.-Y ., and Pfister, T. Distill-
ing step-by-step! outperforming larger language models
with less training data and smaller model sizes. arXiv
preprint arXiv:2305.02301 , 2023.
Jiao, X., Yin, Y ., Shang, L., Jiang, X., Chen, X., Li,
L., Wang, F., and Liu, Q. Tinybert: Distilling bert
for natural language understanding. arXiv preprint
arXiv:1909.10351 , 2019.
Kaplan, J., McCandlish, S., Henighan, T., Brown, T. B.,
Chess, B., Child, R., Gray, S., Radford, A., Wu, J., and
Amodei, D. Scaling laws for neural language models.
arXiv preprint arXiv:2001.08361 , 2020.
Kim, S., Gholami, A., Yao, Z., Mahoney, M. W., and
Keutzer, K. I-bert: Integer-only bert quantization. In
International conference on machine learning , pp. 5506–
5518. PMLR, 2021.
Kitaev, N., Kaiser, Ł., and Levskaya, A. Reformer: The
efficient transformer. arXiv preprint arXiv:2001.04451 ,
2020.
Kurtic, E., Campos, D., Nguyen, T., Frantar, E., Kurtz, M.,
Fineran, B., Goin, M., and Alistarh, D. The optimal bert
surgeon: Scalable and accurate second-order pruning for
large language models. arXiv preprint arXiv:2203.07259 ,
2022.
Lagunas, F., Charlaix, E., Sanh, V ., and Rush, A. M.
Block pruning for faster transformers. arXiv preprint
arXiv:2109.04838 , 2021.
Leviathan, Y ., Kalman, M., and Matias, Y . Fast inference
from transformers via speculative decoding. In Inter-
national Conference on Machine Learning , pp. 19274–
19286. PMLR, 2023.
Liu, Z., Desai, A., Liao, F., Wang, W., Xie, V ., Xu, Z.,
Kyrillidis, A., and Shrivastava, A. Scissorhands: Ex-
ploiting the persistence of importance hypothesis for
llm kv cache compression at test time. arXiv preprint
arXiv:2305.17118 , 2023a.
Liu, Z., Wang, J., Dao, T., Zhou, T., Yuan, B., Song, Z.,
Shrivastava, A., Zhang, C., Tian, Y ., Re, C., et al. Deja
vu: Contextual sparsity for efficient llms at inference time.
InInternational Conference on Machine Learning , pp.
22137–22176. PMLR, 2023b.
Michel, P., Levy, O., and Neubig, G. Are sixteen heads
really better than one? Advances in neural information
processing systems , 32, 2019.Prasanna, S., Rogers, A., and Rumshisky, A. When bert
plays the lottery, all tickets are winning. arXiv preprint
arXiv:2005.00561 , 2020.
Qin, Y ., Wang, Y ., Deng, D., Zhao, Z., Yang, X., Liu, L.,
Wei, S., Hu, Y ., and Yin, S. Fact: Ffn-attention co-
optimized transformer architecture with eager correlation
prediction. In Proceedings of the 50th Annual Interna-
tional Symposium on Computer Architecture , pp. 1–14,
2023.
Radford, A., Wu, J., Child, R., Luan, D., Amodei, D.,
Sutskever, I., et al. Language models are unsupervised
multitask learners. OpenAI blog , 1(8):9","[-0.01659410633146763, 0.006520597264170647, 0.010444036684930325, 0.008581009693443775, 0.020611044019460678, -0.0016344779869541526, -0.004633329343050718, 0.07169540971517563, -0.08161308616399765, 0.01293730828911066, 0.019239744171500206, -0.025029676035046577, -0.02396310865879059, 0.03421322628855705, 0.0012743388069793582, 0.0018630278063938022, 0.04438023269176483, -0.007694512605667114, -0.0037953131832182407, 0.0441863127052784, -0.036928121000528336, -0.018117772415280342, 0.00519085256382823, 0.007438259664922953, 0.06166691333055496, 0.00823472160845995, -0.00037702074041590095, 0.030196288600564003, 0.028312481939792633, -0.025833062827587128, 0.016040045768022537, -0.022813433781266212, -0.05249721556901932, -0.003895736765116453, -0.01929515041410923, 0.05559995397925377, 0.025971578434109688, -0.00032269684015773237, -0.01821473240852356, 0.02439250610768795, 0.0017989645712077618, -0.05789930373430252, -0.0447680726647377, 0.037870023399591446, -0.026705708354711533, 0.027827680110931396, 0.04487888514995575, 0.006247030105441809, -0.03252334147691727, 0.06548993289470673, -0.04706742614507675, 0.014294756576418877, -0.051389094442129135, 0.020472528412938118, -0.01998772658407688, 0.010887285694479942, 0.001977302832528949, 0.021220510825514793, 0.032883480191230774, -0.02304890938103199, 0.0063370647840201855, -0.04083424434065819, 0.0064270999282598495, 0.02706584706902504, -0.07485354691743851, -0.026497935876250267, -0.04908974468708038, 0.04410320147871971, 0.0259992815554142, 0.008276276290416718, 0.0034646084532141685, 0.017743781208992004, 0.02210700698196888, -0.044684965163469315, 0.013553700409829617, 0.030334802344441414, -0.009481357410550117, 0.09740380197763443, 0.013401334173977375, -0.023533713072538376, 0.010651810094714165, -0.006323213689029217, 0.03338213637471199, -0.027038143947720528, -0.0541871003806591, -0.04194236546754837, -0.006240104325115681, -0.024586426094174385, -0.033576056361198425, -0.026844222098588943, 0.001843982026912272, 0.0018751479219645262, -0.027121253311634064, 0.007382853887975216, 0.037177447229623795, 0.011032726615667343, 0.02853410691022873, -0.003705278504639864, 0.04554376006126404, 0.05274654179811478, 0.024614129215478897, 0.002474225591868162, 0.037980835884809494, -0.0287003256380558, 0.015513689257204533, -0.02212085761129856, -0.0057899304665625095, -0.03590310737490654, -0.01756371185183525, 0.016954246908426285, -0.12333382666110992, -0.018962714821100235, -0.028450997546315193, 0.017785336822271347, 0.002005005721002817, -0.0361524373292923, -0.03764839842915535, 0.00770836416631937, -0.0037953131832182407, 0.022938096895813942, 0.007472888566553593, -0.011808410286903381, 0.036124732345342636, 0.028326334431767464, 0.021954640746116638, -0.02745368890464306, 0.032357122749090195, -0.06814941763877869, 0.01623396761715412, -0.01955832913517952, 0.008276276290416718, 0.022037750110030174, 0.05507359653711319, -0.006662575528025627, -0.003930365666747093, -0.03845178708434105, -0.014052354730665684, 0.009453654289245605, -0.03762069717049599, -0.027135103940963745, 0.02573610283434391, -0.0057414500042796135, -0.018020812422037125, -0.003069840604439378, -0.03842408210039139, 0.01727283000946045, 0.006711055524647236, -0.007126600947231054, -0.012646427378058434, 0.007244338747113943, -0.006811479106545448, -0.01623396761715412, -0.02856181003153324, -0.002437865361571312, -0.05523981526494026, -0.055406033992767334, -0.01994617097079754, 0.06255341321229935, 0.019184337928891182, -0.050696518272161484, 0.02735672891139984, 0.0654345229268074, -0.02775842323899269, 0.0042420243844389915, 0.026359420269727707, 0.051389094442129135, -0.023256681859493256, -0.000348668429069221, -0.051804639399051666, -0.055821578949689865, 0.006624483969062567, -0.015596798621118069, 0.010589477606117725, -0.04972691461443901, -0.0013271475909277797, -0.019738398492336273, -0.023132018744945526, -0.02692733146250248, 0.011600637808442116, -0.06343990564346313, 0.009668353013694286, 0.006347453687340021, -0.022203966975212097, 0.013387482613325119, -0.03307740017771721, -0.016580255702137947, -0.014038503170013428, 0.03138751909136772, 0.002050023293122649, 0.04507280886173248, 0.00016556881018914282, 0.03737136721611023, 0.059450674802064896, 0.035736892372369766, 0.016137007623910904, -0.00997308548539877, 0.042690347880125046, -0.015278213657438755, 0.023076612502336502, -0.008345534093677998, -0.020430974662303925, 0.04341062530875206, -0.005346681922674179, -0.04969920963048935, 0.017092760652303696, -0.032495636492967606, -0.00811698380857706, -0.0013072360306978226, -0.033714570105075836, -0.015278213657438755, 0.05479656532406807, 0.01716201938688755, 0.059450674802064896, 0.0011462123366072774, -0.04172074422240257, -0.011545232497155666, -0.050474897027015686, 0.03180306404829025, -0.01387228537350893, 0.02692733146250248, 0.021746868267655373, 0.011856891214847565, 0.01809006929397583, 0.015347471460700035, -0.039476796984672546, 0.036374058574438095, 0.025569884106516838, -0.024461762979626656, 0.03800853714346886, -0.008207018487155437, 0.047649189829826355, -0.0034213224425911903, 0.009772239252924919, -0.028617216274142265, -0.023132018744945526, -0.033021993935108185, 0.019364409148693085, -0.013380557298660278, 0.005571769084781408, -0.07302515208721161, 0.009148920886218548, -0.0008700478356331587, -0.004370150621980429, 0.0009877856355160475, 0.011856891214847565, 0.04501740261912346, -0.02144213393330574, -0.06432640552520752, 0.052608028054237366, 0.028783433139324188, 0.005696432664990425, -0.04022477939724922, -0.025805359706282616, -0.010277818888425827, -0.05008705332875252, -0.0021885382011532784, 0.014336311258375645, -0.0075767748057842255, 0.006929216906428337, 0.024350950494408607, -0.041222088038921356, 0.024018514901399612, -0.014197795651853085, -0.006260881666094065, 0.007826101966202259, -0.030861159786581993, -0.03482269123196602, 0.05565536022186279, -0.00850482564419508, -0.03318821266293526, 0.008338607847690582, 3.157170067424886e-05, 0.01293730828911066, 0.0010276087559759617, -0.04975461587309837, -0.030639536678791046, 0.0224948488175869, 0.035986218601465225, -0.051139768213033676, 0.013775324448943138, 0.001073491876013577, 0.027896936982870102, 0.0399477481842041, 0.014945777133107185, 0.028090858832001686, -0.0042420243844389915, -0.0034247853327542543, -0.04518362134695053, -0.02950371243059635, -0.027509095147252083, 0.02410162426531315, -0.00488958228379488, 0.010748770087957382, -0.03870111331343651, 0.021095847710967064, 0.0017340356716886163, 0.025126636028289795, -0.001992885721847415, 0.009328991174697876, -0.021068144589662552, 0.0560154989361763, -0.02665030211210251, 0.018727239221334457, 0.030251692980527878, -0.0054401797242462635, 0.04673498868942261, -0.0329388864338398, -0.007230487186461687, 0.033299025148153305, 0.0060704234056174755, -0.0012613529106602073, 0.008809559047222137, -0.017175870016217232, 0.007514443248510361, -0.043466031551361084, -0.026691855862736702, 0.012916531413793564, -0.03324361890554428, 0.01753600873053074, -0.01413546409457922, -0.043244410306215286, -0.04091735556721687, -0.02292424626648426, 0.017632970586419106, 0.01493192557245493, 0.026428677141666412, -0.011891519650816917, 0.008684895932674408, -0.0029953885823488235, -0.0013669707113876939, 0.026068538427352905, 0.025514477863907814, 0.030473317950963974, -0.011240499094128609, -0.03828556835651398, -0.015569095499813557, -0.028894245624542236, 0.041609931737184525, 0.01011852640658617, 0.014751856215298176, -0.0844942033290863, 0.018796496093273163, -0.057012807577848434, -0.03180306404829025, -0.020167795941233635, 0.04044640436768532, 0.006032331846654415, 0.006808016449213028, 0.0337422750890255, 0.031027378514409065, -0.005014245864003897, -0.036651089787483215, 0.041748445481061935, -0.03509972244501114, -0.015319768339395523, 0.03579229861497879, -0.006790701765567064, -0.01213392149657011, -0.011025800369679928, -0.0005008185980841517, -0.017619118094444275, 0.016981948167085648, 0.06288585066795349, -0.006690278649330139, -0.011448271572589874, 0.005291276145726442, -0.002008468611165881, 0.031581439077854156, 0.019267447292804718, -0.01092884037643671, 0.019461369141936302, 0.03847948834300041, -0.017605267465114594, -0.020998885855078697, -0.027966195717453957, -0.01146212313324213, -0.03069494292140007, 0.018325544893741608, 0.010173932649195194, 0.027135103940963745, 0.0009444996831007302, 0.00060686917277053, -0.009031183086335659, -0.017065057530999184, 0.0016137006459757686, 0.01648329384624958, -0.007147378288209438, -0.0033537964336574078, -0.0417761467397213, 0.0048376391641795635, 0.0011011948809027672, 0.01138594001531601, -0.052857354283332825, 0.031193597242236137, 0.007985394448041916, 0.03166454657912254, -0.011773781850934029, 0.0076598841696977615, 0.019198190420866013, 0.0465964749455452, -0.01889345794916153, 0.008394014090299606, -0.0069742342457175255, -0.013955394737422466, 0.028229374438524246, 0.04152682051062584, 0.027896936982870102, 0.04623633250594139, 0.02051408402621746, -0.009543688967823982, 0.044684965163469315, -0.03756529092788696, 0.003234327072277665, -0.018921159207820892, 0.002018857281655073, -0.03750988468527794, 0.014987331815063953, 0.011275127530097961, 0.013325151056051254, 0.060891229659318924, -0.018117772415280342, -0.014904222451150417, -0.024821901693940163, -0.026761114597320557, -0.050724223256111145, 0.008130835369229317, 0.03485039621591568, -0.07003322243690491, 0.03340983763337135, -0.05665266886353493, -0.03606932610273361, 0.030307099223136902, 0.016012342646718025, -0.019059674814343452, -0.00012022675946354866, -0.04665188118815422, 0.04166533797979355, 0.07762385159730911, -0.0008609577780589461, -0.04041869938373566, -0.0025763805024325848, -0.027509095147252083, -0.018685683608055115, -0.00970990676432848, -0.042551834136247635, 0.01567990705370903, 0.005222018342465162, 0.012798793613910675, 0.005246258806437254, -0.04812014102935791, 0.022148560732603073, -0.02465568482875824, 0.03401930257678032, 0.012874976731836796, -0.007078120484948158, -0.0296145249158144, 0.08754152804613113, -0.012653352692723274, 0.045377541333436966, -0.018727239221334457, 0.024960417300462723, 0.014599489979445934, -0.046430256217718124, -0.017397494986653328, -0.009758387692272663, 0.01984921097755432, -0.0013635078212246299, -0.006032331846654415, 0.04249642789363861, 0.012480208650231361, -0.004397853743284941, -0.03174765780568123, 0.0008120446582324803, -0.02588846907019615, 0.02867262251675129, 0.010340150445699692, 0.008844188414514065, -0.02025090530514717, -0.005914594046771526, -0.06399396806955338, 0.0337422750890255, -0.012279362417757511, 0.026858074590563774, 0.010340150445699692, 0.014821114018559456, 0.038368675857782364, 0.01659410633146763, 0.002806661883369088, 0.0007172484183683991, 0.010485591366887093, 0.0014267053920775652, -0.02199619449675083, 0.04371536150574684, -0.016150858253240585, 0.00706773204728961, -0.005893816705793142, 0.014364014379680157, -0.033991601318120956, -0.023159721866250038, -0.03886733204126358, 0.0010051000863313675, -0.010513294488191605, 0.020140092819929123, 0.010540997609496117, -0.016137007623910904, -0.028478700667619705, 0.03027939610183239, 0.016968097537755966, -0.0075906263664364815, 0.020444825291633606, -0.012653352692723274, -0.0041866181418299675, 0.011330533772706985, 0.04676268994808197, 0.013636809773743153, 0.033021993935108185, 0.0008553306106477976, 0.01850561425089836, -0.003843793412670493, 0.02412932738661766, 0.0017288413364440203, -0.015596798621118069, 0.001241441466845572, -0.008290127851068974, 0.03468417748808861, 0.012251659296452999, -0.041222088038921356, -0.05551684647798538, -0.025015823543071747, -0.02396310865879059, 0.016815731301903725, -0.02466953545808792, 0.006524060387164354, -0.015236658975481987, -0.047122832387685776, 0.009841496124863625, 0.005911130923777819, -0.018048515543341637, -0.051139768213033676, 0.018006959930062294, -0.00012661144137382507, 0.023547563701868057, 0.011088131926953793, 0.03418552130460739, -0.023949258029460907, -0.011711450293660164, 0.014710301533341408, -0.022979652509093285, 0.006233178544789553, 0.048286356031894684, 0.0391443632543087, -0.03620784357190132, -0.0022474071010947227, -0.006773387547582388, -0.01320048701018095, -0.017632970586419106, 0.02732902579009533, -0.006281659007072449, -0.004491351544857025, -0.0030178972519934177, 0.027564501389861107, -0.024170881137251854, -0.016995800659060478, -0.01213392149657011, -0.02694118395447731, -0.004764918703585863, 0.015208955854177475, -0.026691855862736702, 0.02264721505343914, -0.009204327128827572, -0.017660673707723618, -0.014433271251618862, 0.03171995282173157, -0.020153943449258804, 0.02020934969186783, -0.031249001622200012, 0.01727283000946045, 0.0042073954828083515, 0.008394014090299606, -0.0004129480803385377, -0.06255341321229935, -0.023935405537486076, -0.024738794192671776, 0.010153155773878098, -0.011559083126485348, 0.015084292739629745, 0.01225858461111784, 0.00242747669108212, -0.04216399043798447, -0.010367853567004204, 0.047621484845876694, -0.04008626565337181, 0.0060357945039868355, -0.027259768918156624, -0.02253640443086624, -0.005963074043393135, 0.01914278417825699, -0.016261670738458633, -0.0479816235601902, 0.021220510825514793, 0.00492767384275794, -0.0026768038515001535, -0.015319768339395523, -0.018561020493507385, -0.01447482593357563, -0.0067145186476409435, -0.043743062764406204, -0.006101589184254408, -0.022217819467186928, -0.009765313006937504, -0.013456740416586399, -0.0011825724504888058, -0.00957831833511591, -0.030113179236650467, -0.03493350371718407, -0.0005852262256667018, -0.034102413803339005, -0.03684501349925995, 0.025957725942134857, -0.014267053455114365, 0.003262030193582177, -0.05396547541022301, -0.0013210875913500786, 0.0337422750890255, -0.01273646205663681, 0.023949258029460907, -0.0009419025736860931, -0.03526594117283821, -0.016580255702137947, 0.003864570753648877, -0.04742756485939026, 0.0048722680658102036, 0.03282807394862175, 0.0312212985008955, -0.016275521367788315, -0.02306276187300682, -0.0012821302516385913, -0.00034282481647096574, 0.030113179236650467, -0.004737215582281351, 0.00308369193226099, 0.005644489545375109, -0.01561064925044775, -0.008733375929296017, 0.012625649571418762, -0.021788422018289566, 0.00022660201648250222, 0.0022023897618055344, -0.019779954105615616, 0.0017781873466446996, -0.04210858419537544, -0.05186004564166069, 0.04667958244681358, 0.021539095789194107, 0.042579535394907, -0.02383844554424286, -0.02707969769835472, -0.025237448513507843, 0.005052337422966957, -0.00844942033290863, -0.042939674109220505, 0.032495636492967606, -0.0048722680658102036, -0.020611044019460678, 0.0002210830571129918, 0.01861642673611641, 0.04291197285056114, 0.038784224539995193, 0.03083345666527748, -0.018131624907255173, -0.007826101966202259, 0.022854987531900406, 0.03202468529343605, -0.00616392120718956, 0.0015228001866489649, -0.02707969769835472, 0.01727283000946045, -0.03346524387598038, 0.005630637984722853, 0.02104044146835804, -0.048840418457984924, 0.04144371300935745, -0.06715211272239685, -0.04385387524962425, 0.028243225067853928, 0.01428090501576662, 0.016150858253240585, -0.011662970297038555, 0.02023705281317234, -0.007278967648744583, -0.013138155452907085, -0.015915382653474808, 0.025251299142837524, -0.020444825291633606, -0.01687113754451275, -0.0010492517612874508, -0.0030300174839794636, 0.04892352595925331, -0.015499837696552277, -0.07718060165643692, -0.024337099865078926, 0.023076612502336502, -0.02665030211210251, 0.010263967327773571, -0.028063155710697174, -0.011718375608325005, -0.003954605665057898, 0.04365995526313782, 0.06006013974547386, -0.029420603066682816, -0.012584094889461994, -0.004224710166454315, 0.007521369028836489, 0.014086984097957611, -0.03667879477143288, 0.03224631026387215, 0.03147062659263611, 0.022300928831100464, 0.008193166926503181, -0.01904582418501377, -0.04512821510434151, -0.00311832083389163, -0.012687981128692627, 0.002488077152520418, 0.0200846865773201, -0.01637248322367668, -0.00492767384275794, -0.013692216016352177, -0.00025062571512535214, 0.0287003256380558, 0.01756371185183525, 0.031027378514409065, 0.024281693622469902, -0.051112063229084015, -0.01673262193799019, 0.02225937321782112, -0.03942139074206352, -0.00037334143416956067, -0.03922747075557709, -0.02333979122340679, -0.04210858419537544, -0.027287470176815987, 0.003556374693289399, 0.047344453632831573, 0.012210104614496231, 0.002662952523678541, 0.0030057772528380156, 0.006759535986930132, -0.004027326125651598, -0.015749163925647736, -0.04601471126079559, 0.01286112517118454, 0.007168155629187822, -4.2636675061658025e-05, -0.007313596084713936, -0.031249001622200012, 0.031055081635713577, -0.006911902688443661, 0.01566605642437935, 0.026581043377518654, 0.014557935297489166, -0.0031806526239961386, -0.03268956020474434, 0.016718769446015358, 0.005706821568310261, -0.02088807336986065, -0.0051596867851912975, -0.016414036974310875, -0.02252255193889141, 0.046568769961595535, 0.0035078944638371468, -0.018394803628325462, 0.01057562604546547, 0.0067145186476409435, 0.04504510387778282, -0.0028412905521690845, 0.0155552439391613, -0.0009557540761306882, -0.007012325804680586, 0.011032726615667343, -0.017258979380130768, -0.011261275969445705, 0.018006959930062294, -0.027232065796852112, -0.02678881585597992, -0.04008626565337181, -0.05075192451477051, -0.004422094207257032, 0.004297430627048016, -0.0457930862903595, -0.02842329442501068, -0.0020552175119519234, -0.015915382653474808, -0.019184337928891182, -0.005744913127273321, 0.03160914033651352, 0.001535785966552794, -0.10006329417228699, -0.04634714499115944, 0.020292459055781364, -0.009737609885632992, 0.012168549932539463, -0.04654106870293617, 0.01742519810795784, 0.012410950846970081, 0.01124742440879345, -0.023616820573806763, 0.010167007334530354, -0.016926543787121773, -0.0058107078075408936, 0.004110435023903847, 0.04720593988895416, -0.0417761467397213, 0.0027322100941091776, -0.03199698403477669, 0.032384827733039856, -0.017342088744044304, -0.02439250610768795, -0.002931325463578105, 0.015319768339395523, 0.017771484330296516, -0.012445580214262009, 0.013138155452907085, -0.004068880341947079, 0.03227401524782181, 0.007182007189840078, 0.010762621648609638, -0.03152603283524513, -0.025417517870664597, 0.00425241282209754, 0.0622209757566452, -0.022841136902570724, 0.02947600930929184, -0.021359026432037354, 0.012251659296452999, 0.008636415004730225, -1.8869974155677482e-05, -0.02116510458290577, -0.05950607731938362, 0.01904582418501377, -0.04726134613156319, 0.027135103940963745, 0.01440556813031435, 0.004591775126755238, -0.03108278475701809, 0.021248213946819305, 0.007410557009279728, 0.012687981128692627, 0.003930365666747093, -0.016524849459528923, 0.029919257387518883, 0.024489466100931168, -0.029669931158423424, 0.012223956175148487, -0.017466751858592033, 0.0312212985008955, 0.025362111628055573, -0.011088131926953793, 0.012549466453492641, 0.02615164779126644, -0.02289654314517975, -0.013851508498191833, -0.005710284225642681, 0.003937290981411934, 0.004716438706964254, 0.009038109332323074, -0.05294046550989151, -0.02771686762571335, 0.03997545316815376, -0.010624106973409653, -0.0063578421249985695, 0.006849570665508509, -0.011157389730215073, 0.026179350912570953, 0.035293642431497574, -0.012168549932539463, 0.002974611474201083, 0.05518440902233124, -0.05695740133523941, 0.0033503335434943438, -0.0013132961466908455, 0.003899199655279517, 0.017355939373373985, 0.031692251563072205, -0.011676820926368237, -0.007299744989722967, 0.052857354283332825, 0.037870023399591446, -0.0032810759730637074, 0.00402040034532547, -0.02466953545808792, 0.015541392378509045, 0.004342447966337204, 0.02425399050116539, 0.03942139074206352, 0.037842318415641785, 0.0021920010913163424, 0.021372877061367035, 0.046845801174640656, -0.029143573716282845, -0.037205152213573456, -0.028506403788924217, 0.020430974662303925, 0.006156995426863432, 0.010409408248960972, 0.017646821215748787, -0.02439250610768795, 0.029005058109760284, 0.023783039301633835, 0.0027512558735907078, -0.0008354191086255014, 0.015236658975481987, 0.024281693622469902, 0.02088807336986065, 0.021109698340296745, 0.013387482613325119, 0.003989234566688538, -0.0030092401430010796, 0.006783775985240936, -0.03199698403477669, -0.01784074306488037, -0.015915382653474808, -0.04327211156487465, 0.032883480191230774, 0.027827680110931396, -0.005890354048460722, -0.003843793412670493, 0.022190116345882416, 0.014904222451150417, -0.014793410897254944, 0.0028326334431767464, -0.006219326984137297, 0.012646427378058434, 0.003090617712587118, 0.016538700088858604, -0.035570673644542694, 0.023242831230163574, -0.005066188983619213, -0.019904617220163345, 0.011295905336737633, 0.015278213657438755, -0.014724153093993664, -0.0019097767071798444, -0.029448306187987328, -0.03507201746106148, -0.03027939610183239, -0.0009444996831007302, 0.04102816805243492, 0.01413546409457922, 0.00069993402576074, 0.022938096895813942, -0.0015686833066865802, 0.022425591945648193, 0.012348619289696217, -0.030445614829659462, -0.016677215695381165, 0.05873039364814758, 0.013976171612739563, 0.03523823618888855, 0.02908816747367382, -0.014571786858141422, 0.017896149307489395, -0.02627631090581417, -0.048064734786748886, -0.02383844554424286, -0.02493271417915821, 0.03654027730226517, -0.03482269123196602, -0.006292047444730997, 0.05679118260741234, 0.05465805158019066, -0.0005973462830297649, -0.0007752515957690775, 0.004148526582866907, 0.0023841909132897854, 0.036374058574438095, 0.033576056361198425, 0.02036171779036522, -0.01637248322367668, -0.01245250552892685, -0.008470197208225727, 0.014447122812271118, 0.04352143779397011, 0.005852262023836374, 0.014530232176184654, 0.008581009693443775, 0.014460974372923374, 0.0009609483531676233, 0.016815731301903725, 0.003352064872160554, 0.044297121465206146, 0.0011626610066741705, -0.020749559625983238, 0.024434059858322144, 0.027786124497652054, -0.02182997763156891, -0.00890651997178793, -0.0203755684196949, 0.029586821794509888, 0.008844188414514065, -0.0034801913425326347, -0.049920834600925446, 0.021899234503507614, 0.012023109011352062, -0.023492157459259033, -0.016691068187355995, 0.02785538323223591, -0.011884594336152077, 0.0045225173234939575, -0.029531415551900864, 0.013442888855934143, 0.0032602986320853233, 0.016414036974310875, 0.012778015807271004, 0.0029053539037704468, -0.03523823618888855, 0.0031564123928546906, -0.045377541333436966, -0.02213471010327339, 0.0022751102223992348, -0.01146212313324213, -0.010173932649195194, 0.021649906411767006, 0.02424013987183571, -0.011981554329395294, -0.005021171644330025, 0.006520597264170647, -0.009813793934881687, 0.0038264791946858168, -0.0007917002658359706, 0.007272041868418455, -0.0031737268436700106, -0.011171241290867329, 0.019752250984311104, -0.011157389730215073, -0.021608352661132812, 0.003670649603009224, 0.03307740017771721, -0.00924588181078434, 0.023533713072538376, 0.011025800369679928, 0.01500118337571621, 0.0012630843557417393, 0.015278213657438755, 0.023783039301633835, -0.005357070825994015, -0.019239744171500206, -0.004203932825475931, 0.004480963107198477, 0.031165894120931625, 0.010624106973409653, 0.018796496093273163, 0.0039407541044056416, 0.017854593694210052, 0.042524129152297974, 0.03662338852882385, 0.04426942020654678, -0.0075837005861103535, 0.03523823618888855, -0.0020552175119519234, -0.022813433781266212, -0.0022474071010947227, -0.009273584932088852, -0.0027097011916339397, -0.020458677783608437, 0.0034403682220727205, -0.005654877983033657, -0.04158222675323486, 0.0203755684196949, 0.0045571462251245975, 0.00013754115207120776, 0.010070046409964561, -0.00784687977284193, 0.0076183294877409935, 0.00028438877779990435, 0.02692733146250248, -0.0007934317109175026, -0.007251264527440071, -0.029780741780996323, 0.0013435962609946728, -0.006794164888560772, 0.0007094569155015051, -0.018976565450429916, -0.040557216852903366, -0.028173968195915222, 0.028506403788924217, -0.038534894585609436, 0.0008029546006582677, 0.017231276258826256, -0.019059674814343452, -0.006191624328494072, -0.015846125781536102, 0.01112276129424572, -0.00485495338216424, -0.00997308548539877, 0.021012738347053528, -0.03310510516166687, 0.01173222716897726, 0.020472528412938118, 0.009619872085750103, -0.01386536005884409, 0.009619872085750103, 0.0008484048885293305, 0.005048874765634537, -0.053134385496377945, -0.0066521866247057915, 0.0064270999282598495, -0.02289654314517975, 0.0343240387737751, 0.00488958228379488, 0.011212795972824097, 0.023381344974040985, 0.0009817256359383464, 0.013089675456285477, -0.025389814749360085, 0.013740696012973785, -0.015776867046952248, -4.152746987529099e-05, 0.025389814749360085, 0.022425591945648193, -0.006936142686754465, -0.020971182733774185, -0.02947600930929184, 0.026636449620127678, -0.013484443537890911, 0.0288111362606287, 0.03346524387598038, -0.0019097767071798444, 0.0041935439221560955, -0.016150858253240585, 0.026220904663205147, -0.031304407864809036, 0.02142828330397606, -0.01428090501576662, 0.013366705738008022, 0.0067145186476409435, -0.013380557298660278, 0.04645795747637749, 0.014364014379680157, 0.011441345326602459, -0.002789347432553768, 0.01943366602063179, -0.016441740095615387, 0.0054678828455507755, 0.005990777164697647, -0.020874222740530968, -0.009869199246168137, 0.0720832496881485, -0.02652563899755478, -0.011780708096921444, -0.00876800436526537, -0.040280185639858246, 0.05643104389309883, -0.026096241548657417, -0.0019513311563059688, -0.027841530740261078, -0.0022318242117762566, -0.0020846519619226456, 0.02652563899755478, -0.01982150785624981, -0.01173222716897726, 0.02601313218474388, -0.015236658975481987, -0.018048515543341637, 0.010866507887840271, -0.0023720706813037395, 0.03268956020474434, 0.029254384338855743, 0.020181646570563316, -0.036235544830560684, -0.014447122812271118, -0.0035321346949785948, 0.01447482593357563, 0.0026923869736492634, 0.0023738022428005934, 0.015984639525413513, 0.04889582470059395, -0.005405551288276911, -0.03468417748808861, -0.04271805286407471, 0.015472134575247765, -0.004636792466044426, 0.03443484753370285, -0.06150069460272789, 0.03227401524782181, -0.02759220451116562, -0.0006995011353865266, 0.004141600802540779, 0.02077726274728775, -0.021788422018289566, 0.03654027730226517, -0.024821901693940163, -0.009786090813577175, -0.018588723614811897, -0.0034784600138664246, 0.0033572593238204718, -0.0023720706813037395, -0.012307064607739449, -0.000304300308926031, 0.01548598613590002, -0.026082389056682587, -0.007382853887975216, -0.01838095113635063, 0.0031685323920100927, 0.060614198446273804, 0.005305127706378698, 0.023145869374275208, -0.03219090402126312, 0.018062366172671318, -0.014197795651853085, 0.004338984843343496, -0.01998772658407688, -0.041859257966279984, -0.028728028759360313, -0.022813433781266212, 0.005724135786294937, 0.03324361890554428, -0.019516775384545326, -0.0042489501647651196, 0.0025001971516758204, -0.013221264816820621, 0.021733015775680542, 0.004647180903702974, -0.010499442927539349, 0.010250115767121315, 0.03149832785129547, 0.035432156175374985, -0.017258979380130768, 0.0003335183428134769, -0.010250115767121315, 0.03712204098701477, 0.029697634279727936, 0.013325151056051254, 0.040806543081998825, -0.02933749370276928, -0.029780741780996323, 0.020292459055781364, -0.009460579603910446, 0.00818624161183834, 0.03980923444032669, 0.015541392378509045, 0.004061954561620951, -0.019530626013875008, -0.017328236252069473, -0.020832668989896774, 0.014093909412622452, -0.0076321810483932495, -0.019184337928891182, -0.00710582360625267, -0.02091577649116516, -0.01493192557245493, -0.007833028212189674, 0.014121612533926964, -0.05028097331523895, -0.008428642526268959, 0.028173968195915222, 0.027675313875079155, -0.002772032981738448, -0.019627587869763374, 0.006544837728142738, 0.012729535810649395, 0.002772032981738448, -0.011510603129863739, 0.006257419008761644, 0.02225937321782112, -0.024170881137251854, -0.034490253776311874, 0.021248213946819305, 0.00871259905397892, 0.013719919137656689, 0.0057553015649318695, -0.017175870016217232, -0.0022612586617469788, 0.02412932738661766, -0.02170531265437603, -0.019253596663475037, 0.002953834133222699, -0.0015808034222573042, 0.007299744989722967, 0.0016067749820649624, -0.0026646838523447514, 0.02077726274728775, 0.030085476115345955, 0.02558373473584652, 0.0011695866705849767, -0.04432482644915581, -0.0008756750030443072, 0.022674918174743652, 0.020417122170329094, 0.013401334173977375, 0.020985035225749016, 0.030778050422668457, -0.020334014669060707, 0.0019547941628843546, 0.0009981743060052395, 0.015790719538927078, -0.019738398492336273, 0.010866507887840271, -0.013983097858726978, 0.0026837296318262815, 0.0272043626755476, 0.0064409514889121056, -0.015028886497020721, 0.003992697224020958, -0.024586426094174385, -0.007299744989722967, -0.009536763653159142, -0.003397082444280386, 0.014571786858141422, -0.004148526582866907, 0.015624500811100006, 0.039088957011699677, -0.025500627234578133, -0.01057562604546547, 0.00876800436526537, 0.011739153414964676, 0.0321354977786541, 0.023159721866250038, 0.028728028759360313, -0.029254384338855743, -0.011697598733007908, 0.0060357945039868355, -0.005918056704103947, -0.008698747493326664, -0.008809559047222137, 0.006087737623602152, 0.000699068303219974, -0.015444431453943253, 0.003712204284965992, 0.00777762196958065, -0.006908439565449953, -0.0220931563526392, 0.007507517468184233, -0.025916172191500664, -0.002919205231592059, -0.01730053313076496, -0.024849604815244675, -0.0010284745367243886, 0.005436717066913843, 0.025140486657619476, 0.010312448255717754, 0.004169303923845291, 0.04318900406360626, -0.005519825965166092, 0.037205152213573456, 0.034794989973306656, 0.008297053165733814, 0.008255498483777046, -0.02437865361571312, -0.004075806122273207, -0.01998772658407688, -0.0019374797120690346, -0.0054955859668552876, 0.014959628693759441, 0.030861159786581993, -0.0063578421249985695, -0.007694512605667114, -0.003390156663954258, -0.028617216274142265, 0.002138326643034816, 0.012161624617874622, 0.010818027891218662, -0.008110057562589645, -0.003954605665057898, 0.009702981449663639, -0.046845801174640656, -0.013089675456285477, 0.010402482934296131, 0.008705672807991505, 0.015582947060465813, 0.006569077726453543, -0.017217423766851425, 0.03205239027738571, 0.02586076594889164, -0.010741844773292542, -0.0025763805024325848, 0.012050812132656574, 0.013179710134863853, -0.010319373570382595, 0.006191624328494072, -0.006326676346361637, 0.0018768793670460582, -0.0005657475558109581, 0.0008791378932073712, 0.010097749531269073, 0.016829581931233406, 0.010534072294831276, -0.016386333853006363, 0.010901137255132198, 0.005062726326286793, 0.026622598990797997, -0.04180385172367096, 0.05471345782279968, 0.05263572931289673, 0.0287003256380558, -0.03421322628855705, 0.03415782004594803, -0.004581386223435402, 0.008172390051186085, -0.0006648724083788693, -0.02437865361571312, -0.0010146229760721326, -0.04102816805243492, -0.0060912007465958595, -0.010873434133827686, 0.0041796923615038395, -0.00676646176725626, -0.030251692980527878, -0.02038942091166973, -0.0030404061544686556, 0.028617216274142265, -0.0259992815554142, 0.04501740261912346, -0.018200881779193878, 0.024475615471601486, -0.005121595226228237, -0.01781303994357586, -0.009702981449663639, 0.01541672833263874, -0.016123155131936073, -0.009820719249546528, -0.002148715313524008, 0.03886733204126358, -0.006454802583903074, 0.0018266676925122738, 0.017660673707723618, -0.0009384396835230291, 0.038922738283872604, -0.015873828902840614, -0.008691821247339249, 3.197750629624352e-05, 0.01930900290608406, 0.011157389730215073, -0.025140486657619476, -0.028755730018019676, 0.02385229617357254, 0.010977320373058319, -0.013761472888290882, 0.012750313617289066, 0.017217423766851425, -0.04069573059678078, -0.007362076546996832, 0.008705672807991505, -0.004605626687407494, -0.010991171933710575, -0.025362111628055573, 0.029143573716282845, -0.01703735440969467, -0.02707969769835472, -0.023533713072538376, 0.026207054033875465, 0.013934616930782795, 0.030085476115345955, -0.012556391768157482, 0.06548993289470673, -0.020417122170329094, 0.03559837490320206, -0.002013663062825799, 0.018810348585247993, -0.0038057018537074327, 0.012674129568040371, 0.00022227341833058745, 0.009806867688894272, 0.00984842237085104, 0.0005666132783517241, 0.0033537964336574078, 0.037980835884809494, -0.0013557163765653968, -0.005235869903117418, 0.01620626449584961, 0.005568306427448988, -0.008200093172490597, -0.013096600770950317, -0.005717210005968809, 0.03568148612976074, 0.015527540817856789, 0.011967702768743038, 0.019613735377788544, 0.002172955311834812, 0.022577958181500435, 0.0020673375111073256, -0.015347471460700035, 0.00818624161183834, 0.012577169574797153, 0.02906046435236931, 0.030861159786581993, -0.03817475587129593, -0.01876879297196865, -0.001843982026912272, -0.029448306187987328, -0.02357526682317257, -0.013290521688759327, 0.0070504178293049335, 0.006856496445834637, -0.002501928713172674, -0.011108909733593464, 0.00028135874890722334, 0.04446334019303322, 0.017729930579662323, 0.00790228508412838, -0.018519466742873192, -0.00777762196958065, 0.049117449671030045, 0.01548598613590002, -0.018865754827857018, -0.034517958760261536, -0.01286112517118454, -0.04238561540842056, -0.008179315365850925, 0.025085080415010452, 0.013221264816820621, -0.004408242646604776, 0.018464060500264168, -0.0005544931627810001, 0.00169248110614717, -0.025126636028289795, -0.03335443139076233, -0.025029676035046577, 0.01807621866464615, -0.002803198993206024, 0.04465726390480995, -0.04504510387778282, -0.019516775384545326, -0.0057553015649318695, -0.026996590197086334, 0.007168155629187822, -0.028838839381933212, 0.03795313090085983, -0.04050181061029434, -0.0017522157868370414, -0.03739907220005989, -0.0055232890881598, 0.0110465781763196, -0.010741844773292542, 0.025694547221064568, -0.007355150766670704]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
", 2019.
Raffel, C., Shazeer, N., Roberts, A., Lee, K., Narang, S.,
Matena, M., Zhou, Y ., Li, W., and Liu, P. J. Exploring
the limits of transfer learning with a unified text-to-text
transformer. The Journal of Machine Learning Research ,
21(1):5485–5551, 2020.
Sajjad, H., Dalvi, F., Durrani, N., and Nakov, P. On the ef-
fect of dropping layers of pre-trained transformer models.
Computer Speech & Language , 77:101429, 2023.
Sanh, V ., Debut, L., Chaumond, J., and Wolf, T. Distilbert,
a distilled version of bert: smaller, faster, cheaper and
lighter. arXiv preprint arXiv:1910.01108 , 2019.
Shazeer, N. Fast transformer decoding: One write-head is
all you need. arXiv preprint arXiv:1911.02150 , 2019.
Shen, S., Dong, Z., Ye, J., Ma, L., Yao, Z., Gholami, A.,
Mahoney, M. W., and Keutzer, K. Q-bert: Hessian based
ultra low precision quantization of bert. In Proceedings
of the AAAI Conference on Artificial Intelligence , vol-
ume 34, pp. 8815–8821, 2020.
Tambe, T., Hooper, C., Pentecost, L., Jia, T., Yang, E.-
Y ., Donato, M., Sanh, V ., Whatmough, P., Rush, A. M.,
Brooks, D., et al. Edgebert: Sentence-level energy op-
timizations for latency-aware multi-task nlp inference.
InMICRO-54: 54th Annual IEEE/ACM International
Symposium on Microarchitecture , pp. 830–844, 2021.
Thorndike, R. L. Who belongs in the family? Psychome-
trika , 18(4):267–276, 1953.
Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux,
M.-A., Lacroix, T., Rozi `ere, B., Goyal, N., Hambro, E.,
Azhar, F., et al. Llama: Open and efficient foundation lan-
guage models. arXiv preprint arXiv:2302.13971 , 2023a.
Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi,
A., Babaei, Y ., Bashlykov, N., Batra, S., Bhargava, P.,
Bhosale, S., et al. Llama 2: Open foundation and fine-
tuned chat models. arXiv preprint arXiv:2307.09288 ,
2023b.
10
Runtime Clustered Head Attention for Efficient Inference
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones,
L., Gomez, A. N., Kaiser, Ł., and Polosukhin, I. At-
tention is all you need. Advances in neural information
processing systems , 30, 2017.
V oita, E., Talbot, D., Moiseev, F., Sennrich, R., and Titov, I.
Analyzing multi-head self-attention: Specialized heads
do the heavy lifting, the rest can be pruned. arXiv preprint
arXiv:1905.09418 , 2019.
Waleffe, R. and Rekatsinas, T. Principal component net-
works: Parameter reduction early in training. arXiv
preprint arXiv:2006.13347 , 2020.
Wang, H., Agarwal, S., and Papailiopoulos, D. Pufferfish:
Communication-efficient models at no extra cost. Pro-
ceedings of Machine Learning and Systems , 3:365–386,
2021a.
Wang, H., Zhang, Z., and Han, S. Spatten: Efficient sparse
attention architecture with cascade token and head prun-
ing. In 2021 IEEE International Symposium on High-
Performance Computer Architecture (HPCA) , pp. 97–110.
IEEE, 2021b.
Wang, H., Agarwal, S., Tanaka, Y ., Xing,","[0.0015914116520434618, 0.030685681849718094, 0.00518909003585577, 0.008201890625059605, 0.006532268598675728, -0.0065968772396445274, -0.004393384326249361, 0.055495381355285645, -0.05448884516954422, 0.015329238958656788, 0.039282023906707764, 0.0008730661356821656, -0.0224973913282156, 0.022973455488681793, -0.009840908460319042, -0.01113308034837246, 0.06545190513134003, -0.025952251628041267, 0.020579537376761436, 0.05340070277452469, -0.04026135429739952, 0.0011434020707383752, 0.004202959127724171, 0.024632876738905907, 0.047524720430374146, 0.02029389888048172, -0.002446625381708145, 0.037540990859270096, 0.022415781393647194, -0.027910912409424782, 0.026836369186639786, -0.0310665313154459, -0.020144278183579445, -0.03093051351606846, -0.0008352361037395895, 0.057073190808296204, 0.01128270011395216, 0.027652477845549583, -0.04148551821708679, 0.027720486745238304, 0.007589809596538544, -0.04575648531317711, -0.02115081250667572, 0.045021988451480865, -0.0036520857829600573, 0.00892958790063858, 0.0097048906609416, 0.02260620705783367, -0.010248962789773941, 0.08362392336130142, -0.02886303886771202, 0.027326034381985664, -0.06360206007957458, 0.017179084941744804, -0.023775961250066757, 0.004155352711677551, -0.007882248610258102, 0.0299511831253767, 0.03354205936193466, 0.004600811749696732, -0.00917442049831152, -0.00877996813505888, 0.00538631621748209, 0.04646378010511398, -0.045810893177986145, -0.01421389076858759, -0.057182006537914276, 0.022184550762176514, -0.005920187570154667, 0.020973989740014076, -0.005947391036897898, 0.013676619157195091, 0.0319642499089241, -0.026305899024009705, -0.00027819949900731444, 0.005977995228022337, -0.03460300341248512, 0.06637682765722275, -0.013547401875257492, -0.00013750579091720283, 0.032100267708301544, -0.014853175729513168, 0.021354839205741882, -0.031610604375600815, -0.03506546467542648, -0.03609919920563698, -0.026537129655480385, -0.03593597933650017, -0.04091424122452736, -0.01385344285517931, 2.4440751076326706e-05, 0.007283768616616726, -0.043770622462034225, -0.026373907923698425, 0.020715555176138878, 0.03588157147169113, 0.021110007539391518, -0.0020725757349282503, 0.01818561926484108, 0.033161211758852005, 0.01828083209693432, 0.00542712165042758, 0.0054475245997309685, -0.02374875918030739, 0.022674215957522392, -0.032236285507678986, -0.018362442031502724, -0.04137670248746872, -0.004141750745475292, 0.047062259167432785, -0.08765005320310593, -0.03669768199324608, -0.014717156998813152, 0.018403246998786926, 0.022089337930083275, -0.0501362681388855, -0.024782495573163033, 0.00509047694504261, -0.012493261136114597, 0.025163346901535988, 0.0013712323270738125, -0.009616479277610779, 0.02840057760477066, 0.013799034990370274, 0.010133347474038601, -0.03716014325618744, 0.01693425141274929, -0.0416487380862236, 0.01571008935570717, -0.040832631289958954, 0.02780209667980671, 0.01100386306643486, 0.04711666703224182, -0.009494062513113022, -0.002733963541686535, -0.053944773972034454, -0.01598212495446205, 0.01513881329447031, -0.044260285794734955, 0.00063928501913324, 0.0318826399743557, -0.006083408836275339, -0.043933842331171036, 0.0001150840544141829, -0.03351485729217529, 0.05247578024864197, 0.003543271217495203, 0.004964660387486219, -0.040206946432590485, 0.025938650593161583, -0.03133856877684593, -0.01021495833992958, -0.03294358029961586, -0.018172016367316246, -0.04749751836061478, -0.032236285507678986, -0.012574872002005577, 0.05402638390660286, 0.024564867839217186, -0.07562606036663055, 0.014241093769669533, 0.015696488320827484, -0.007841442711651325, 8.920874097384512e-05, 0.011044668965041637, 0.031039327383041382, -0.008548736572265625, 0.0009419252746738493, -0.07540842890739441, -0.05886862799525261, -0.0006622380460612476, -0.05008186027407646, 0.012432053685188293, -0.03171942010521889, -0.0008696656441316009, -0.0012709189904853702, -0.04001652076840401, -0.020905980840325356, -0.016852641478180885, -0.068389892578125, 0.012486460618674755, 0.026469120755791664, -0.006617280188947916, 0.016893446445465088, -0.040342964231967926, -0.013139347545802593, 0.0014987493632361293, 0.025163346901535988, 0.002091278089210391, 0.05214933678507805, -0.015968523919582367, 0.03261713683605194, 0.03525589033961296, 0.02404799871146679, -0.0018056401750072837, -0.009201623499393463, 0.04257366061210632, -0.021858107298612595, 0.005787569563835859, -0.036289624869823456, -0.012676886282861233, 0.026496324688196182, -0.0074605923146009445, -0.025122541934251785, 0.01633577235043049, -0.021953320130705833, -0.01653979904949665, 0.0012641181237995625, -0.013622211292386055, -0.0330795980989933, 0.04774234816431999, 0.024551264941692352, 0.04091424122452736, -0.010282967239618301, -0.05973914638161659, -0.018865708261728287, -0.04932015761733055, 0.027040395885705948, -0.001992664998397231, 0.020538732409477234, 0.013941854238510132, 0.018376043066382408, 0.021586071699857712, 0.02013067714869976, -0.042383234947919846, 0.008412718772888184, 0.003335843561217189, -0.04091424122452736, 0.018620876595377922, -0.00551893375813961, 0.03547351807355881, -0.0019382578320801258, 0.01341138407588005, -0.02295985259115696, -0.03030483052134514, -0.057345226407051086, 0.02075636014342308, -0.04153992608189583, 0.022361373528838158, -0.054706476628780365, -0.0194097813218832, -0.016131745651364326, 0.009528066962957382, 0.0077598318457603455, -0.000915571756195277, 0.04605572670698166, -0.01828083209693432, -0.07236162573099136, 0.04668140783905983, 0.032562728971242905, 0.017505528405308723, -0.026999590918421745, -0.04355299100279808, 0.007943456061184406, -0.04795997962355614, -0.013037334196269512, 0.007453791331499815, 0.0002648102235980332, 0.012921718880534172, 0.030359238386154175, -0.024197617545723915, 0.027326034381985664, 0.0028767825569957495, 0.008630347438156605, 0.0035738754086196423, -0.016417384147644043, -0.006916519720107317, 0.03397731855511665, -0.009017999283969402, 0.001378033310174942, -0.01113308034837246, 0.013792234472930431, 0.007263366132974625, 0.014458723366260529, -0.0865619108080864, 0.013241360895335674, 0.029434313997626305, 0.01443151943385601, -0.053618330508470535, 0.004913653712719679, 0.0019246559822931886, 0.014635546132922173, 0.04570207744836807, 0.0318826399743557, 0.029624739661812782, 0.0199266504496336, 0.0029804965015500784, -0.03789464011788368, -0.0194097813218832, -0.003740497399121523, 0.026768360286951065, -0.01121469121426344, 0.024388043209910393, -0.029434313997626305, 0.03713293746113777, 0.019096938893198967, 0.007991062477231026, -0.0013720825081691146, 0.031093735247850418, -0.05146924406290054, 0.0427640862762928, -0.029570331797003746, 0.02226616069674492, 0.018634477630257607, 0.022116541862487793, 0.01019455585628748, -0.048150405287742615, -0.018294433131814003, 0.01560127455741167, -0.011337107978761196, -0.03465740755200386, -0.006831508595496416, -0.03555512800812721, 0.017043067142367363, -0.04246484860777855, -0.022361373528838158, 0.037840232253074646, -0.021205220371484756, 0.01815841533243656, -0.024143211543560028, -0.03492944687604904, -0.04695344343781471, -0.019219355657696724, 0.02668674848973751, 0.012289234437048435, 0.00929003581404686, -0.03871074691414833, 0.011316705495119095, -0.013132546097040176, 0.002210293896496296, 0.029298296198248863, 0.01660780794918537, 0.014635546132922173, -0.022837437689304352, -0.036888107657432556, -0.023775961250066757, -0.03057686612010002, 0.031773824244737625, 0.01735590770840645, 0.021667681634426117, -0.0764421671628952, -0.011772365309298038, -0.05772607773542404, -0.017043067142367363, -0.021735690534114838, 0.039581265300512314, 0.018797699362039566, -9.537205914966762e-05, 0.020946785807609558, 0.011847175657749176, 0.0009521266329102218, -0.008528334088623524, 0.03264434263110161, -0.07791116088628769, 0.006773700937628746, 0.05465206876397133, -0.00939204916357994, -0.017709555104374886, 0.004689223598688841, -0.0030825098510831594, -0.0013678319519385695, 0.03435816988348961, 0.02948872186243534, 0.0048660472966730595, -0.0036520857829600573, 0.02460567280650139, -0.007086542434990406, 0.019450586289167404, 0.0010090841678902507, -0.02576182596385479, 0.01999465934932232, 0.060500845313072205, -0.021966921165585518, -0.01411867793649435, -0.01690704934298992, -0.0009232228039763868, -0.018471255898475647, 0.02013067714869976, -0.016118142753839493, 0.04406986013054848, 0.009582474827766418, 0.007310972083359957, -0.012846908532083035, 0.006641083396971226, -0.00235991389490664, 0.019722623750567436, 0.003340944414958358, 0.013288967311382294, -0.04793277382850647, -0.0024279227945953608, -0.0008832674939185381, 0.011398316361010075, -0.06186102703213692, 0.028536595404148102, 0.02784290350973606, 0.027666078880429268, -0.0313657708466053, -0.008106677792966366, 0.0108202388510108, 0.04197518154978752, 0.01781836897134781, 0.021735690534114838, -0.019545799121260643, -0.016050133854150772, 0.01973622478544712, 0.04153992608189583, -0.00905880518257618, 0.04385223239660263, 0.02323189005255699, -0.017342306673526764, 0.060011181980371475, -0.035038258880376816, 0.010473392903804779, 0.010480193421244621, -0.015342840924859047, -0.016621410846710205, -0.0007030434790067375, -0.009759297594428062, -0.0005385466502048075, 0.048449642956256866, -0.012030799873173237, -0.004872848279774189, -0.04194797948002815, -0.009283234365284443, -0.06327561289072037, -0.00246702809818089, 0.03683369979262352, -0.07617013156414032, 0.01103786751627922, -0.03577275574207306, -0.04091424122452736, -0.009698090143501759, 0.0230550654232502, -0.008807171136140823, -0.012132813222706318, -0.06137136369943619, 0.036942511796951294, 0.07812879234552383, 0.002676155883818865, -0.048612866550683975, -0.0025503390934318304, -0.021327637135982513, -0.04572928324341774, -0.015234026126563549, -0.03623522073030472, -0.007841442711651325, -0.0010498896008357406, 0.019464189186692238, -0.0067226942628622055, -0.038166675716638565, 0.010452990420162678, -0.012744895182549953, 0.048776086419820786, 0.015492460690438747, 0.003621481591835618, -0.03604479506611824, 0.08449443429708481, -0.003985329996794462, 0.036616068333387375, -0.013390980660915375, 0.026836369186639786, 0.005053072236478329, -0.03498385101556778, -0.00896359235048294, -0.006998130585998297, 0.0074469903483986855, 0.026210686191916466, -0.018457654863595963, 0.060011181980371475, 0.007358578499406576, 0.013193754479289055, -0.014009863138198853, -0.015669284388422966, -0.03775862231850624, 0.025326568633317947, 0.010405384004116058, 0.030087200924754143, -0.014295501634478569, -0.011833573691546917, -0.04651818796992302, 0.025843437761068344, -0.03337883949279785, 0.018512062728405, 0.0040159341879189014, 0.01953219808638096, 0.0467086136341095, 0.014921184629201889, -0.0010116345947608352, 0.008365112356841564, 0.00291078700684011, 0.011554736644029617, -0.005797771271318197, 0.053618330508470535, -0.01537004392594099, -0.0030145009513944387, -0.024632876738905907, -0.024238424375653267, -0.02200772613286972, -0.009426053613424301, -0.04526682198047638, 0.03014160878956318, -0.013132546097040176, 0.008487529121339321, -0.009732094593346119, 0.0018821503035724163, -0.037704214453697205, 0.04926575347781181, 0.03843871131539345, -0.026237890124320984, 0.02276942878961563, -0.00450559938326478, -0.02068835124373436, 0.018444053828716278, 0.044097065925598145, 0.01522042416036129, 0.044722747057676315, -0.0046416171826422215, 0.013765030540525913, -0.016430985182523727, 0.012744895182549953, -0.014608343131840229, -0.008562338538467884, -0.007025334518402815, -0.0173967145383358, 0.009432854130864143, -0.004549805074930191, -0.03593597933650017, -0.08846616744995117, -0.028971852734684944, -0.01537004392594099, 0.02358553744852543, -0.037840232253074646, 0.002791771199554205, -0.01403706707060337, -0.05576741695404053, 0.004345777910202742, -0.012092008255422115, -0.0347934290766716, -0.05217653885483742, 0.043634604662656784, -0.0016177651705220342, 0.030876105651259422, -0.0016118143685162067, 0.02237497642636299, -0.010466592386364937, -0.0282373558729887, 0.026809165254235268, -0.026632342487573624, 0.003097811946645379, 0.0313657708466053, 0.02131403423845768, -0.05214933678507805, 0.005838576704263687, -0.014948387630283833, -0.040451779961586, -0.05000025033950806, 0.02652352675795555, 0.004097545053809881, 0.004090744070708752, -0.01467635203152895, 0.03857472911477089, -0.01466275006532669, -0.020497925579547882, -0.012384447269141674, -0.04404265806078911, 0.00578076858073473, -0.003818707773461938, -0.033950116485357285, 0.0008284351788461208, -0.00488304952159524, -0.008507931604981422, -0.03528309240937233, 0.012357243336737156, -0.056093860417604446, 0.01677102968096733, -0.006913119461387396, 0.008378714323043823, 0.022987056523561478, -0.016743827611207962, 0.010976660065352917, -0.0593038871884346, 0.004362780135124922, -0.04151272028684616, -0.010636614635586739, -0.015669284388422966, 0.003672488499432802, -0.008793569169938564, 0.001538704615086317, -0.047987181693315506, 0.011894782073795795, 0.07089262455701828, -0.016811836510896683, 0.01700226031243801, -0.02019868604838848, -0.02451045997440815, -0.023843972012400627, 0.01913774572312832, -0.030005590990185738, -0.03781303018331528, 0.024496857076883316, 0.013207356445491314, 0.009745696559548378, -0.03620801493525505, -0.012935319915413857, -0.02708120085299015, -0.008888782002031803, -0.03166501224040985, 0.01451313029974699, 0.01029656920582056, 0.018756894394755363, -0.011588741093873978, -0.0003481213061604649, -0.024061599746346474, -0.027693282812833786, -0.011989994905889034, -0.007936655543744564, -0.05146924406290054, -0.023299898952245712, 0.03327002376317978, 0.011425519362092018, 0.009398849681019783, -0.04058779776096344, -0.008038668893277645, 0.040206946432590485, -8.129206435114611e-06, 0.02869981713593006, -0.003944524563848972, -0.023843972012400627, -0.026605138555169106, -0.017138279974460602, -0.06686649471521378, -0.00527070090174675, 0.051142800599336624, 0.033650875091552734, -0.015859710052609444, -0.0067532979883253574, 0.003349445527419448, 0.01785917580127716, 0.02826455980539322, -0.007372180465608835, -0.008120279759168625, 0.01571008935570717, -0.008229094557464123, -0.030032794922590256, 0.029896775260567665, -0.008324307389557362, -0.011901582591235638, 0.005063273478299379, -0.015669284388422966, -0.009657284244894981, -0.013996261171996593, -0.03743217885494232, 0.0639284998178482, 0.013220958411693573, 0.037214551120996475, -0.009861311875283718, -0.02174929343163967, -0.016621410846710205, 0.0019620610401034355, -0.005998397711664438, -0.04295451194047928, 0.020484324544668198, -0.01474436093121767, -0.01545165479183197, -0.006763499695807695, 0.02527216076850891, 0.022742224857211113, 0.02569381706416607, 0.01147992629557848, -0.0310665313154459, -0.020307499915361404, 0.03852032124996185, 0.039880502969026566, 0.007161352317780256, 0.013907849788665771, -0.019641011953353882, 0.016390180215239525, -0.031610604375600815, 0.009698090143501759, 0.035527925938367844, -0.051142800599336624, 0.05506012216210365, -0.06594157218933105, -0.01781836897134781, 0.006182022392749786, 0.002487430814653635, 0.009385247714817524, -0.006964126136153936, 0.049537789076566696, -0.0033681478817015886, -0.0027322634123265743, -0.012180419638752937, 0.034875039011240005, -0.0188113022595644, 0.0053489115089178085, 0.009664085693657398, 0.0009113211999647319, 0.061425767838954926, -0.01014694944024086, -0.0855281725525856, -0.006069807335734367, 0.0009742295951582491, -0.030005590990185738, 0.011520732194185257, -0.017831971868872643, -0.019164949655532837, -0.010316971689462662, 0.04042457789182663, 0.04417867586016655, -0.03920041397213936, -0.025585003197193146, 0.018797699362039566, 0.00471982778981328, 0.00578076858073473, -0.026741156354546547, 0.022524595260620117, 0.01100386306643486, 0.011799569241702557, 0.0007315222756005824, -0.02842778153717518, -0.029787961393594742, 0.01065701711922884, -0.020742759108543396, 0.024034395813941956, 0.0034701614640653133, -0.032399509102106094, -0.0103917820379138, -0.020606741309165955, 0.006906318478286266, 0.015478858724236488, 0.008106677792966366, 0.02101479470729828, 0.020402712747454643, -0.04608292877674103, -0.01999465934932232, 0.02293265052139759, -0.03498385101556778, -0.006777101196348667, -0.01864808052778244, -0.033297229558229446, -0.01693425141274929, -0.02441524714231491, 0.030522460117936134, 0.02826455980539322, 0.006083408836275339, 0.001154453493654728, 0.030495256185531616, -0.0022868041414767504, -0.00535231176763773, -0.019817834720015526, -0.053455110639333725, 0.012160017155110836, 0.015478858724236488, 0.009024799801409245, -0.01894732005894184, -0.018729690462350845, 0.013540600426495075, -0.01369022112339735, 0.01834884099662304, 0.021327637135982513, 0.01765514723956585, -0.0024228221736848354, -0.02480969950556755, 0.04273688420653343, -0.009942922741174698, -0.0319642499089241, -0.006872314028441906, -0.0013219257816672325, -0.014309102669358253, 0.02615627832710743, -0.00958927534520626, -0.012690487317740917, 0.026632342487573624, 0.024714486673474312, 0.035337500274181366, -0.009936121292412281, 0.010786234401166439, 0.0024636276066303253, -0.0020572736393660307, 0.0182536281645298, -0.007501397747546434, -0.0008284351788461208, -0.012228026054799557, -0.020266694948077202, -0.02967914752662182, -0.02585703879594803, -0.04360739886760712, -0.012976125814020634, 0.010983460582792759, -0.03389570862054825, -0.023041464388370514, 0.008344709873199463, -0.0004726628540083766, -0.03373248502612114, 0.010473392903804779, 0.02678196132183075, 0.01930096745491028, -0.07600691169500351, -0.03389570862054825, 0.01815841533243656, -0.026305899024009705, -0.001431590411812067, -0.03686090186238289, 0.03351485729217529, -0.00010546715202508494, 0.02075636014342308, -0.010010931640863419, 0.01050739735364914, -0.008188288658857346, 0.00023845671967137605, -0.004335576668381691, 0.02527216076850891, -0.05973914638161659, 0.0115275327116251, -0.02645551785826683, 0.028591003268957138, -0.00971849262714386, -0.02497292123734951, 0.0002973270311485976, 0.03370528295636177, 0.008310705423355103, -0.023068668320775032, 0.0032151276245713234, 0.011065071448683739, 0.005828374996781349, 0.008841175585985184, 0.01403706707060337, -0.02042991667985916, -0.014417917467653751, 0.0041179475374519825, 0.04741590470075607, -0.014771564863622189, 0.02374875918030739, -0.03011440485715866, 0.029760757461190224, 0.012887714430689812, -0.003757499624043703, -0.026673147454857826, -0.06245950609445572, 0.015492460690438747, -0.02170848660171032, 0.020470721647143364, 0.029842369258403778, 0.016716623678803444, -0.020008260384202003, 0.01108547393232584, 0.0222389567643404, 0.02437444217503071, -0.02145005203783512, -0.01003133412450552, 0.050326693803071976, 0.016294967383146286, -0.027883708477020264, 0.009976927191019058, -0.006542470306158066, 0.036616068333387375, 0.037078529596328735, -0.006991329602897167, 0.02101479470729828, 0.021518060937523842, -0.02184450440108776, -0.009725293144583702, -0.019845038652420044, 0.004590610507875681, 0.024796098470687866, -0.006919920444488525, -0.04839523509144783, -0.028645409271121025, 0.02951592579483986, 0.019559402018785477, -0.0002894634963013232, 0.009779701009392738, -0.033351633697748184, 0.023150278255343437, 0.030957717448472977, -0.011595542542636395, -0.003366447752341628, 0.043036121875047684, -0.05209492892026901, 0.0019229557365179062, -0.000948726199567318, -0.012398049235343933, 0.022279763594269753, 0.015900515019893646, -0.00482524186372757, -0.004512399900704622, 0.04657259210944176, 0.040342964231967926, 0.0006426854524761438, 0.014649148099124432, -0.02349032461643219, 0.030821699649095535, 0.0050224680453538895, 0.008412718772888184, 0.025571400299668312, 0.038003455847501755, 0.0067668999545276165, 0.04121348261833191, 0.03764980658888817, -0.010929053649306297, -0.04028855636715889, -0.023830369114875793, 0.010963058099150658, 0.01707027107477188, 0.016675816848874092, 0.0020317703019827604, -0.04007092863321304, 0.027829300612211227, 0.01009934302419424, 0.00976609904319048, 0.0038357102312147617, 0.01999465934932232, 0.014186686836183071, 0.039880502969026566, 0.027992522343993187, 0.012466058135032654, 0.012595275416970253, 0.0037472983822226524, 0.0230550654232502, -0.0008322607027366757, -0.01100386306643486, -0.014227491803467274, -0.030386440455913544, 0.007188556250184774, 0.035799961537122726, -0.002796872053295374, -0.006015399936586618, 0.024959320202469826, 0.018566468730568886, -0.009330840781331062, -0.0015599575126543641, -0.00010084466339321807, 0.01591411605477333, 0.0095552708953619, 0.045674875378608704, -0.047551922500133514, 0.03324282169342041, -0.021817302331328392, -0.02527216076850891, 0.018362442031502724, 0.016050133854150772, -0.0019314568489789963, -0.006603678222745657, -0.018362442031502724, -0.03748658671975136, -0.017083872109651566, -0.003798305056989193, 0.01719268597662449, 0.013649415224790573, -0.010316971689462662, 0.022279763594269753, 0.010452990420162678, 0.028482187539339066, -0.016920650377869606, -0.025408178567886353, -0.014322704635560513, 0.051442041993141174, 0.018294433131814003, 0.024333635345101357, 0.030876105651259422, -0.008725560270249844, 0.01545165479183197, -0.0173967145383358, -0.029570331797003746, -0.003713293932378292, -0.03631683066487312, 0.027326034381985664, -0.019382577389478683, -0.010874646715819836, 0.0639284998178482, 0.050653137266635895, 0.014091474004089832, -0.005182289052754641, -0.0028784829191863537, -0.016553401947021484, 0.015098008327186108, 0.0216812826693058, 0.034739021211862564, -0.01033057365566492, -0.010711424984037876, 0.007902651093900204, 0.015342840924859047, 0.04836803302168846, 0.024469655007123947, 0.025312965735793114, 0.012330039404332638, -0.002079376485198736, -0.004155352711677551, 0.01483957376331091, -0.02068835124373436, 0.0194097813218832, -0.007889049127697945, -0.020905980840325356, 0.01033057365566492, 0.0293527040630579, -0.029135074466466904, -0.038003455847501755, 0.016852641478180885, 0.04866727069020271, 0.011588741093873978, -0.01732870377600193, -0.04464113712310791, 0.04306332767009735, -0.009806904010474682, -0.025802630931138992, -0.00432537542656064, 0.006603678222745657, -0.01498919352889061, -0.0038051060400903225, -0.024864107370376587, 0.040451779961586, -0.0071477508172392845, -0.0058725811541080475, 0.02553059533238411, 0.009813705459237099, -0.02622428722679615, -0.010636614635586739, -0.04904812201857567, -0.02717641368508339, -0.005688956473022699, -0.020973989740014076, -0.02131403423845768, 0.012472858652472496, 0.019396180287003517, -0.006794103421270847, -0.013554202392697334, 0.003279736265540123, -0.014608343131840229, 0.008059071376919746, 0.007508198730647564, 0.02510893903672695, 0.005685556214302778, -0.012996528297662735, 0.0010124846594408154, -0.0022000926546752453, 0.004787836689502001, -0.009942922741174698, 0.034875039011240005, 0.018702486529946327, 0.02147725597023964, 0.023925581946969032, 0.0005891283508390188, -0.0005831775488331914, 0.013982659205794334, 0.008487529121339321, 0.005053072236478329, -0.02145005203783512, -0.007161352317780256, -0.000701343291439116, 0.0230550654232502, -0.00924242939800024, -0.0024857306852936745, 0.0012343641137704253, 0.01878409832715988, 0.05729081854224205, 0.03577275574207306, 0.03495664894580841, 0.016022931784391403, 0.031039327383041382, -0.001134050777181983, -0.04031576216220856, 0.01515241526067257, 0.00522989546880126, -0.003771101590245962, -0.015642080456018448, 0.0019178551156073809, 0.011554736644029617, -0.034276559948921204, 0.02003546431660652, -0.0012199121993035078, -0.007249764166772366, 0.015859710052609444, -0.004046538379043341, 0.006120814010500908, -0.013744628056883812, 0.017437519505620003, -0.001514051342383027, 0.0046382169239223, -0.0216404777020216, -8.12920625321567e-05, -0.0034752620849758387, 0.018865708261728287, -0.011323506012558937, -0.04774234816431999, -0.0024024194572120905, 0.03865634277462959, -0.032698750495910645, -0.006284035742282867, -0.01490758266299963, -0.01696145534515381, -0.0025724421720951796, -0.018144812434911728, 0.004104346036911011, -0.01683903858065605, 0.009772899560630322, 0.035201482474803925, -0.03261713683605194, -0.0015183018986135721, 0.022905446588993073, 0.03854752704501152, -0.010140148922801018, 0.013322971761226654, 0.010024533607065678, 0.0010592408943921328, -0.06996770203113556, -0.003057006513699889, 0.012071605771780014, -0.009133614599704742, 0.02684997022151947, -0.011384714394807816, 0.010058538056910038, 0.005950791295617819, 0.027815699577331543, 0.015234026126563549, -0.044559527188539505, 0.00935804471373558, -0.021654080599546432, -0.0035534726921468973, 0.029434313997626305, 0.015206822194159031, -0.012826506048440933, -0.018104007467627525, -0.03120254911482334, 0.01459474116563797, -0.02374875918030739, 0.01804959960281849, 0.026414712890982628, -0.009222026914358139, -0.0006180321797728539, -0.00917442049831152, 0.04412426799535751, -0.027353238314390182, -0.007583008613437414, -0.018525663763284683, 0.004658619407564402, 0.01930096745491028, -0.023531129583716393, 0.025612207129597664, 0.012676886282861233, -0.006528868339955807, 0.006763499695807695, 0.010418985970318317, 0.004141750745475292, -0.020089872181415558, 0.004206359386444092, -0.000829285301733762, -0.007963859476149082, 0.06964126229286194, -0.039282023906707764, -0.010663818567991257, -0.003811907023191452, -0.003228729357942939, 0.053128667175769806, -0.041784755885601044, -0.009840908460319042, -0.014499528333544731, 0.003057006513699889, -0.0019365575863048434, 0.01802239753305912, -0.021558867767453194, -0.020021863281726837, 0.025380974635481834, -0.017845572903752327, -0.03158339858055115, 0.0021303833927959204, -0.020865174010396004, 0.025557799264788628, 0.01380583643913269, 0.02661873959004879, -0.011398316361010075, -0.02840057760477066, 0.008222293108701706, 0.02997838705778122, 7.94988500274485e-06, 0.02362634241580963, 0.01467635203152895, 0.037867434322834015, 0.0096844881772995, -0.03947244957089424, -0.03838430345058441, 0.01459474116563797, -0.014499528333544731, 0.03702412545681, -0.06936922669410706, 0.03305239602923393, -0.024945717304944992, -0.008609944954514503, 0.00924242939800024, 0.018199220299720764, -0.0033970517106354237, 0.04056059569120407, -0.027910912409424782, -0.002616648096591234, -0.010881447233259678, 0.021994125097990036, -0.004733429290354252, -0.003296738490462303, -0.025911446660757065, 0.017383111640810966, 0.0071341488510370255, -0.026605138555169106, -0.003692891215905547, -0.016811836510896683, -0.0020691752433776855, 0.05772607773542404, 0.0108202388510108, 0.008922786451876163, -0.003181123174726963, 0.002189891180023551, -0.005365913733839989, -0.007263366132974625, -0.02062034234404564, -0.027040395885705948, -0.030005590990185738, -0.009861311875283718, -0.0017971390625461936, 0.02710840478539467, -0.019396180287003517, -0.006858712062239647, 0.02612907439470291, -0.0012641181237995625, 0.02427922934293747, 0.025013726204633713, -0.023911980912089348, 0.027747690677642822, 0.024945717304944992, 0.026836369186639786, -0.015723690390586853, 0.00865075085312128, -0.01630856841802597, 0.039880502969026566, 0.03759539872407913, 0.01630856841802597, 0.02187170833349228, -0.016662215813994408, -0.015669284388422966, 0.027992522343993187, -0.005954192019999027, 0.011622745543718338, 0.03400452062487602, 0.026999590918421745, 0.012445655651390553, -0.012595275416970253, -0.02128683030605316, -0.026169881224632263, 0.037078529596328735, -0.007569406647235155, -0.017111076042056084, -0.00494085717946291, -0.022021329030394554, -0.0021065801847726107, -0.020797165110707283, 0.0002699109027162194, -0.04464113712310791, 0.0072905695997178555, 0.03343324735760689, 0.011241895146667957, 0.01050739735364914, -0.01103786751627922, 0.006263632792979479, 0.01989944651722908, -0.0038017055485397577, 0.0068689133040606976, -0.0009997329907491803, 0.019913047552108765, -0.01553326565772295, -0.027434848248958588, 0.043879434466362, 0.005593744106590748, 0.023667147383093834, -0.0066104792058467865, -0.001208860776387155, -0.006372447591274977, 0.0196682158857584, -0.0196682158857584, -0.021028395742177963, 0.004553205333650112, -0.0017852374585345387, 0.0019280564738437533, 0.02372155524790287, -0.012840108014643192, 0.01383984088897705, 0.04124068468809128, 0.0013015230651944876, 0.023463120684027672, -0.03014160878956318, -0.01696145534515381, 0.03405892848968506, 0.027992522343993187, 0.010119745507836342, 0.020185085013508797, 0.02474169060587883, -0.02826455980539322, 0.0012853709049522877, 0.007412985898554325, 0.019096938893198967, -0.0007123947725631297, 0.003300138982012868, -0.00027734937611967325, 0.011581940576434135, 0.032997988164424896, 0.011459523811936378, -0.027666078880429268, -0.007188556250184774, -0.015954921022057533, 0.011065071448683739, -0.01772315613925457, 0.010092542506754398, -0.0009784800931811333, -0.003703092457726598, 0.0063860490918159485, 0.03492944687604904, -0.03133856877684593, -0.01679823361337185, -0.003968327771872282, 0.014812369830906391, 0.012608876451849937, 0.015329238958656788, 0.031120939180254936, -0.033025193959474564, -0.015397247858345509, -0.001612664433196187, 0.003924122080206871, -0.010174153372645378, 0.0023327101953327656, -0.002366714645177126, 0.013125745579600334, -0.01341138407588005, -0.0016687719617038965, 0.0015540067106485367, -0.012921718880534172, -0.004236963577568531, -0.008949990384280682, -0.026428313925862312, 0.012445655651390553, -0.02312307432293892, -0.015886912122368813, -0.009840908460319042, -0.014853175729513168, 0.02872702106833458, 0.005940590053796768, 0.0056175473146140575, 0.04866727069020271, -0.006246630568057299, 0.048449642956256866, 0.022592604160308838, 0.0025724421720951796, 0.008820773102343082, -0.019790632650256157, -0.012112410739064217, -0.017138279974460602, -0.01621335558593273, -0.0002824500552378595, -0.0063860490918159485, 0.0109698586165905, -0.006549270823597908, -0.02638750895857811, 0.002446625381708145, -0.020960386842489243, -0.013683419674634933, 0.01867528446018696, 0.02434723824262619, 0.0014638947322964668, 0.0038255087565630674, 0.018824903294444084, -0.0347118154168129, -0.018471255898475647, 0.008045470342040062, 0.01989944651722908, 0.017831971868872643, -0.009419253095984459, 0.0008756164461374283, 0.02293265052139759, 0.0034718618262559175, -0.026496324688196182, 0.009201623499393463, 0.02480969950556755, 0.0010422385530546308, -0.01700226031243801, 0.011983193457126617, -0.012112410739064217, -0.014934786595404148, -0.006957325153052807, 0.0006341843400150537, 0.002223895862698555, -0.0023276095744222403, 0.0063554453663527966, -0.00920842494815588, 0.020253093913197517, 0.0048524453304708, 0.03593597933650017, -0.05837896466255188, 0.06011999398469925, 0.04311773553490639, 0.02154526486992836, -0.03133856877684593, 0.033324431627988815, -0.028536595404148102, 0.03729616105556488, -0.013629012741148472, -0.03074008785188198, -0.01561487652361393, -0.03618081286549568, 0.006168420426547527, 0.00220349314622581, 0.02247018925845623, 0.00576376635581255, -0.009303637780249119, -0.01610454171895981, -0.00434917863458395, 0.01647179014980793, -0.042682476341724396, 0.029706351459026337, -0.01600932888686657, 0.04213840514421463, 0.001035437686368823, -0.02214374579489231, -0.008229094557464123, 0.00108134385664016, 0.003941124305129051, 0.001026936573907733, -0.010677419602870941, 0.04042457789182663, 0.0009359744726680219, 0.023531129583716393, 0.014254695735871792, -0.008147483691573143, 0.036588866263628006, 0.007004931569099426, 0.002784970449283719, -0.0036078798584640026, 0.02029389888048172, 0.00865075085312128, -0.024238424375653267, -0.006760098971426487, 0.03930922970175743, 0.003181123174726963, -0.014703555032610893, 0.023204686120152473, 0.02504093013703823, -0.01818561926484108, -0.00905880518257618, 0.002016468206420541, -0.01927376352250576, -0.010473392903804779, -0.03669768199324608, 0.020865174010396004, -0.008841175585985184, -0.021463654935359955, -0.01834884099662304, 0.0094056511297822, 0.009657284244894981, 0.027203617617487907, -0.009575673379004002, 0.06099051237106323, 0.007276967633515596, 0.01577809825539589, -0.006056205369532108, 0.00457020802423358, -0.013486193493008614, 0.015410849824547768, 0.006127614993602037, 0.01561487652361393, -0.01133030652999878, -0.006579875014722347, 0.0027203618083149195, 0.035799961537122726, 0.010221759788691998, 0.00971849262714386, 0.03588157147169113, 0.016580605879426003, -0.005464526824653149, -0.031773824244737625, -0.011058270931243896, 0.05250298231840134, 0.03030483052134514, 0.007562605664134026, 0.02636030502617359, 0.01663501188158989, 0.02872702106833458, 0.016580605879426003, -0.005539336707442999, 0.002643851563334465, 0.020865174010396004, 0.03476622328162193, 0.032045863568782806, -0.029570331797003746, -0.022551799193024635, -0.009854510426521301, -0.016675816848874092, -0.007168153300881386, 0.008983994834125042, -0.0009946322534233332, -0.003196425037458539, 0.01890651509165764, -0.011901582591235638, -3.3685730159049854e-05, 0.038737952709198, 0.03258993476629257, 0.019423382356762886, -0.015098008327186108, 0.007038936018943787, 0.034739021211862564, 0.017845572903752327, -0.02013067714869976, -0.02140924707055092, -0.022130142897367477, -0.026890777051448822, -0.016349375247955322, 0.019790632650256157, -0.008188288658857346, -0.013595008291304111, 0.02434723824262619, -0.0041757551953196526, -0.007576207630336285, -0.02840057760477066, -0.02513614296913147, -0.03430376201868057, 0.0296519435942173, 0.005875981412827969, 0.03414054214954376, -0.048014383763074875, -0.018144812434911728, -0.024034395813941956, -0.0290534645318985, 0.016022931784391403, -0.008711958304047585, 0.017872776836156845, -0.01878409832715988, -0.013071338646113873, -0.025285763666033745, 0.001485147513449192, 0.012765297666192055, 0.01019455585628748, 0.04126788675785065, -0.01133030652999878]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
" E., Papailiopoulos,
D., et al. Cuttlefish: Low-rank model training without
all the tuning. Proceedings of Machine Learning and
Systems , 5, 2023.
Wang, S., Li, B. Z., Khabsa, M., Fang, H., and Ma, H.
Linformer: Self-attention with linear complexity. arXiv
preprint arXiv:2006.04768 , 2020.
Wang, Z., Wohlwend, J., and Lei, T. Structured pruning of
large language models. arXiv preprint arXiv:1910.04732 ,
2019.
Xia, H., Ge, T., Wang, P., Chen, S.-Q., Wei, F., and Sui,
Z. Speculative decoding: Exploiting speculative execu-
tion for accelerating seq2seq generation. In Findings of
the Association for Computational Linguistics: EMNLP
2023 , pp. 3909–3925, 2023.
Xiao, G., Lin, J., Seznec, M., Wu, H., Demouth, J., and Han,
S. Smoothquant: Accurate and efficient post-training
quantization for large language models. In International
Conference on Machine Learning , pp. 38087–38099.
PMLR, 2023.
Yang, S., Lee, G., Cho, J., Papailiopoulos, D., and
Lee, K. Predictive pipelined decoding: A compute-
latency trade-off for exact llm decoding. arXiv preprint
arXiv:2307.05908 , 2023.
You, H., Li, C., Xu, P., Fu, Y ., Wang, Y ., Chen, X., Baraniuk,
R. G., Wang, Z., and Lin, Y . Drawing early-bird tickets:
Towards more efficient training of deep networks. arXiv
preprint arXiv:1909.11957 , 2019.Zellers, R., Holtzman, A., Bisk, Y ., Farhadi, A., and Choi,
Y . Hellaswag: Can a machine really finish your sentence?
arXiv preprint arXiv:1905.07830 , 2019.
Zhang, S., Roller, S., Goyal, N., Artetxe, M., Chen, M.,
Chen, S., Dewan, C., Diab, M., Li, X., Lin, X. V .,
et al. Opt: Open pre-trained transformer language models.
arXiv preprint arXiv:2205.01068 , 2022.
Zhang, Z., Sheng, Y ., Zhou, T., Chen, T., Zheng, L., Cai,
R., Song, Z., Tian, Y ., R ´e, C., Barrett, C., et al. H 2o:
Heavy-hitter oracle for efficient generative inference of
large language models. arXiv preprint arXiv:2306.14048 ,
2023.
Zhou, Y ., Du, N., Huang, Y ., Peng, D., Lan, C., Huang, D.,
Shakeri, S., So, D., Dai, A. M., Lu, Y ., et al. Brainformers:
Trading simplicity for efficiency. In International Con-
ference on Machine Learning , pp. 42531–42542. PMLR,
2023.
11
Runtime Clustered Head Attention for Efficient Inference
A. Additional Plots
A.1. Accuracy and Inference Time Trade-off
1000 2000 3000 4000 5000 6000 7000
Time(ms)15202530354045Accuracy
Random Head Selection
Static Head Selection
CHAI
CHAI-static
MHA
Figure 14. Accuracy vs Inference Time for LLAMA-7B: We study various methods of clustering attention heads, and plot the runtime
for sequence length of 2048. For random head selection we randomly choose heads to combine together in increasing number of 4, 8, 16
and 24. For Static Head selection we choose the heads in increasing order of 4,8,16, and 24 based on activation analysis of activation on
C4 dataset (Raffel et al., 2020).
A.2. OPT-66B Activation Plots
From Figure 15 to Figure 15 shows the activation plots for all layers of OPT. We consistently observe that for this examples
there is high amount of.
A.3. LL AMA-7B Activation Plots
12
Runtime Clustered Head Attention","[0.011546905152499676, 0.022531917318701744, 0.0534922331571579, -0.01308508776128292, -0.0005544305313378572, -0.0036382584366947412, 0.034078821539878845, 0.015789199620485306, -0.032589804381132126, 0.001896389527246356, 0.021660981699824333, -0.031831249594688416, -0.03983822837471962, 0.010528474114835262, -0.0017550382763147354, -0.042479123920202255, 0.009032432921230793, -0.030482705682516098, 0.007283540442585945, 0.04155200347304344, -0.04767663776874542, -0.019343173131346703, -0.007353777065873146, 0.037197329103946686, 0.049390412867069244, -0.0015768128214403987, 0.009657539427280426, 0.012495099566876888, 0.026507310569286346, -0.009025409817695618, 0.02673206850886345, -0.043321963399648666, -0.020354580134153366, -0.025467809289693832, -0.02517281472682953, 0.030482705682516098, 0.022630248218774796, -0.0017488925950601697, -0.04385576397180557, 0.00018700507644098252, -0.005387151148170233, -0.043996237218379974, -0.029387013986706734, 0.013211513869464397, -0.004158009774982929, 0.009460876695811749, 0.04360291361808777, 0.03199981898069382, -0.00918695330619812, 0.08602584898471832, -0.03697257116436958, 0.0460471473634243, -0.06967475265264511, 0.03267408907413483, 0.009109693579375744, 0.010184314101934433, 0.015409921295940876, 0.03393834829330444, 0.039304427802562714, -0.011069295927882195, 0.026380885392427444, -0.032702185213565826, 0.00287267891690135, 0.0034521312918514013, -0.04011917486786842, -0.03233695402741432, -0.0693376213312149, -0.007255445700138807, 0.01997530274093151, -0.00841435045003891, -0.011996420100331306, 0.020326485857367516, 0.036298301070928574, -0.017966534942388535, -0.019343173131346703, 0.014918264001607895, -0.017348451539874077, 0.04239484295248985, 0.00593148497864604, 0.008063167333602905, 0.013984116725623608, 0.020214106887578964, 0.05675121396780014, -0.03264599293470383, -0.001018431386910379, -0.054812680929899216, -0.02130979858338833, -0.015466109849512577, -0.0538293682038784, -0.015199210494756699, -0.02921844646334648, 0.02140813134610653, -0.007606629282236099, 0.0010377464350312948, 0.03365740180015564, 0.01830366998910904, 0.02921844646334648, -0.01691298559308052, 0.022377396002411842, 0.040315836668014526, -0.0016654864884912968, 0.013611862435936928, 0.030819842591881752, -0.018556522205471992, 0.02978033944964409, -0.02841774746775627, -0.042507220059633255, -0.01415970828384161, -0.0230657160282135, 0.017854155972599983, -0.07478798180818558, 0.019581977277994156, -0.0684947818517685, -0.00743103725835681, -0.02442830614745617, -0.043321963399648666, -0.030145570635795593, 0.0035293917171657085, -0.007817339152097702, 0.01460922323167324, -0.017207978293299675, -0.018809374421834946, 0.031213166192173958, 0.0007475813617929816, 0.01827557571232319, -0.0007006105734035373, 0.025004247203469276, -0.04506383463740349, 0.0014047329314053059, -0.01033883448690176, 0.012740927748382092, 0.009629444219172001, 0.037843506783246994, -0.034696903079748154, -0.0305669903755188, -0.04806996136903763, -0.01423696894198656, 0.014384466223418713, -0.0687195360660553, 0.016407281160354614, 0.03230885788798332, -0.002091296250000596, -0.03230885788798332, 0.014054353348910809, -0.03922014310956001, 0.05905497446656227, -0.024245690554380417, -0.0051588816568255424, -0.04733950272202492, 0.05278986692428589, -0.007487226743251085, -0.018177244812250137, -0.041046299040317535, 0.005415245424956083, -0.025594234466552734, -0.03671972081065178, -0.03745018318295479, 0.027378246188163757, 0.022602153941988945, -0.05236844718456268, 0.035736408084630966, 0.004147474188357592, 0.008280901238322258, 0.00919397734105587, 0.0025495903100818396, 0.03964156657457352, -0.04837900400161743, -0.0006848073098808527, -0.07445085048675537, -0.056385982781648636, 0.017193932086229324, -0.015157069079577923, -0.004674248863011599, -0.07068616151809692, 0.006149218417704105, -0.027069205418229103, -0.016294902190566063, -0.019399361684918404, 1.857430106610991e-05, -0.034078821539878845, -0.005906902253627777, 0.027322055771946907, -0.01685679517686367, 0.028052518144249916, -0.059504490345716476, 0.0020702253095805645, -0.013267703354358673, 0.04646856710314751, 0.005183464847505093, 0.037225425243377686, -0.007241398561745882, 0.037871602922677994, 0.0843963548541069, 0.014454702846705914, 0.023360708728432655, -0.027827760204672813, 0.07855267077684402, 0.005808570887893438, 0.005271260626614094, -0.01979268714785576, 0.005580301862210035, 0.04365910217165947, 0.00476906867697835, -0.06489866226911545, 0.018949847668409348, -0.006479330826550722, -0.029302729293704033, 0.00476906867697835, -0.010472284629940987, -0.004993825685232878, 0.047142837196588516, -0.023290472105145454, 0.08226116001605988, -0.0050219204276800156, -0.05264939367771149, -0.013780430890619755, -0.06040351837873459, -0.022419538348913193, 0.027897996827960014, 0.018696995452046394, 0.006149218417704105, 0.021239561960101128, 0.02442830614745617, 0.04804186895489693, -0.048631854355335236, 0.0380963571369648, 0.02378213033080101, -0.0052537014707922935, 0.04683379828929901, 0.001697093015536666, 0.046328093856573105, 0.01594371907413006, 0.00220367475412786, -0.026942778378725052, 0.00476906867697835, -0.07315849512815475, 0.010156219825148582, -0.020846238359808922, 0.017207978293299675, -0.054728396236896515, 0.00552411237731576, 0.012776046060025692, 0.026380885392427444, 5.6738044804660603e-05, 0.006644386798143387, 0.026619689539074898, -0.029443202540278435, -0.07085473090410233, 0.03584878519177437, 0.01490421686321497, 0.025453761219978333, -0.03725351765751839, -0.04160819202661514, -0.03902348130941391, -0.04301292449235916, 0.005566254258155823, -0.01687084324657917, 0.025706613436341286, -0.016351092606782913, 0.010907751508057117, -0.04276007041335106, 0.03281456232070923, 0.004238781984895468, 0.050907522439956665, -0.009208024479448795, -0.021941930055618286, -0.014553033746778965, 0.04517621174454689, -0.022574059665203094, -0.05922354385256767, -0.02448449656367302, -0.0266899261623621, 0.017446784302592278, 0.01067597046494484, -0.05028944090008736, -0.04961517080664635, 0.014918264001607895, 0.00845649279654026, -0.053239379078149796, 0.013927927240729332, -0.027111345902085304, 0.01994720846414566, 0.06332536041736603, 0.02747657708823681, -0.0018015700625255704, 0.010837514884769917, -0.002988569438457489, -0.02687254175543785, -0.03138173371553421, -0.03289884701371193, 0.01490421686321497, -0.028108706697821617, 0.01345031801611185, -0.027308009564876556, 0.04514811933040619, 0.00628618011251092, 0.0003154064470436424, 0.004203663673251867, -0.013155324384570122, 0.005116739775985479, 0.04983992502093315, -0.019399361684918404, -0.002128170570358634, -0.007578534539788961, 0.016632039099931717, 0.06607864052057266, -0.023318568244576454, 0.022574059665203094, 0.03427548334002495, -0.00519400043413043, -0.022447632625699043, 0.001139589585363865, -0.005401198286563158, 0.003183476161211729, -0.031859345734119415, -0.024976152926683426, 0.03624211251735687, -0.016365138813853264, 0.021646935492753983, -0.06388725340366364, -0.04969945177435875, -0.03593306988477707, 0.0021738242357969284, 0.006753253750503063, 0.02309381030499935, 0.015185163356363773, 0.0023459040094166994, 0.026254460215568542, -0.01490421686321497, -0.015367778949439526, 0.022855006158351898, 0.00032879531499929726, 0.010851562023162842, 0.0038454565219581127, -0.004038607235997915, -0.004249317105859518, -0.03607354313135147, 0.02448449656367302, 0.020284343510866165, 0.05899878591299057, -0.08591347187757492, 0.0192026998847723, -0.05236844718456268, 0.03523070365190506, -0.01183487568050623, 0.021815503016114235, 0.010493355803191662, 0.013927927240729332, 0.0689442977309227, 0.003778731683269143, -0.012923543341457844, -0.04233865067362785, 0.026493264362215996, -0.025060435757040977, 0.00422824639827013, 0.028544174507260323, 0.019736498594284058, -0.024034980684518814, -0.013745312578976154, 0.048491381108760834, -0.017966534942388535, 0.02529924176633358, 0.01996125653386116, 0.01182785164564848, 0.023908555507659912, 0.02157669886946678, -0.01304294541478157, 0.011919159442186356, 0.008189593441784382, 0.0016909473342821002, 0.010191338136792183, 0.028614411130547523, -0.02820703759789467, -0.01412458997219801, -0.04660904034972191, -0.00594904413446784, 0.009552184492349625, 0.0015680332435294986, 0.010100030340254307, 0.03615782782435417, 0.0025952442083507776, 0.01675846427679062, 0.0003013591340277344, -0.022054307162761688, 0.008273877203464508, 0.032449331134557724, 0.0006352026830427349, -0.0023125417064875364, -0.04146771878004074, 0.010851562023162842, 0.018107008188962936, -0.006651410833001137, -0.05026134476065636, 0.01696917414665222, 0.0058998786844313145, 0.0003702788380905986, 0.02232120744884014, 0.025481855496764183, 0.021970024332404137, 0.034106917679309845, 0.02130979858338833, -0.006416117772459984, -0.015185163356363773, 0.004846328869462013, -0.0019420433090999722, -0.005460899323225021, -0.008238758891820908, 0.000138827133923769, 0.014229944907128811, 0.008316019549965858, 0.057088349014520645, -0.022068355232477188, 0.014482797123491764, -0.02152050845324993, -0.022475726902484894, -0.018022723495960236, -0.014482797123491764, 0.005840177182108164, 0.016407281160354614, 0.05447554588317871, -0.002082516672089696, -0.03163458779454231, -0.038742534816265106, 0.005720775108784437, -0.060965411365032196, -0.004249317105859518, 0.061752062290906906, -0.06371869146823883, -0.0006119367899373174, -0.04750806838274002, -0.03140982985496521, 0.034781187772750854, 0.029696054756641388, 0.010029793716967106, -0.028754884377121925, -0.04267578944563866, 0.022377396002411842, 0.027013015002012253, -0.0011492471676319838, -0.024006886407732964, 0.031831249594688416, 0.003929740749299526, -0.03728161379694939, -0.015775151550769806, -0.03315169736742973, -0.0016092972364276648, -0.02145027182996273, -0.00439681438729167, 0.0055522071197628975, -0.023149998858571053, 0.01688489131629467, -0.0061281477101147175, 0.02844584360718727, 0.029499392956495285, -0.005380127113312483, -0.03385406360030174, 0.10496164858341217, -0.028881309553980827, 0.01997530274093151, -0.03152220696210861, 0.029583675786852837, -0.005748869851231575, -0.026254460215568542, 0.018851516768336296, -0.03216838464140892, 0.023922603577375412, 0.02521495707333088, -0.02768728695809841, 0.055486951023340225, 0.013520554639399052, 0.013204489834606647, -0.04961517080664635, 0.004891982767730951, -0.045569539070129395, 0.02138003520667553, 0.011553929187357426, 0.012523194774985313, -0.037815410643815994, 0.01229843683540821, -0.062370143830776215, 0.014454702846705914, -0.022447632625699043, 0.03697257116436958, 0.009629444219172001, 0.0307074636220932, 0.05616122484207153, 0.01688489131629467, 0.007055271416902542, 0.020944569259881973, 0.0037330780178308487, 0.01538182608783245, -0.00552411237731576, 0.046412378549575806, -0.01682870090007782, 0.023515230044722557, -0.0191886518150568, -0.012593431398272514, -0.02980843372642994, -0.025776850059628487, -0.014876122586429119, 0.014721601270139217, -0.0153396837413311, 0.01983482949435711, -0.011097390204668045, 0.010036816820502281, -0.015199210494756699, 0.007262469734996557, 0.01538182608783245, 0.01074620708823204, 0.034865472465753555, -0.009383616037666798, 0.002026327420026064, 0.006440700963139534, 0.042422935366630554, -0.020073633641004562, 0.0230657160282135, 0.0035381712950766087, 0.024372117593884468, 0.002379266545176506, 0.020200060680508614, 0.012066656723618507, -0.019329125061631203, -0.004554846789687872, -0.022335253655910492, 0.030482705682516098, -0.005229118745774031, -0.022447632625699043, -0.10372548550367355, -0.03517451509833336, -0.011757615022361279, 0.021632887423038483, -0.03587688133120537, 0.015803245827555656, -0.01220010593533516, -0.06810145825147629, 0.004224734380841255, -0.010149195790290833, -0.026998968794941902, -0.06276346743106842, 0.01909032091498375, 0.0037576607428491116, 0.040231551975011826, 0.01257236022502184, -0.0027831271290779114, 0.004179080482572317, -0.023473087698221207, 0.027883950620889664, -0.01924484223127365, 0.006735694594681263, 0.028108706697821617, 0.038602061569690704, -0.030876031145453453, -0.0008748852415010333, -0.014819933101534843, -0.02461092174053192, -0.009264213964343071, -0.016449423506855965, -0.0046285949647426605, 0.0017919124802574515, -0.024905916303396225, 0.03444405272603035, -0.013274726457893848, -0.013885785825550556, -0.014791837893426418, -0.02157669886946678, -0.012495099566876888, 0.018879611045122147, -0.035511650145053864, 0.024358069524168968, 0.02302357368171215, -0.03756256029009819, -0.026465170085430145, 0.020228154957294464, -0.03660733997821808, 0.0034661786630749702, -0.008316019549965858, 0.01302187517285347, 0.03385406360030174, 0.015114926733076572, -0.010289669036865234, -0.0383211150765419, -0.020228154957294464, -0.03059508465230465, -0.020242203027009964, -0.026984920725226402, 0.003043002914637327, -0.014876122586429119, 0.014243992045521736, -0.05742548406124115, 0.016646085307002068, 0.07911456376314163, -0.02907797321677208, -0.00804209616035223, -0.018050819635391235, -0.017264168709516525, -0.010486331768333912, 0.0012677714694291353, -0.04646856710314751, -0.03129745274782181, -0.021871693432331085, 0.023135952651500702, 0.03199981898069382, 0.005183464847505093, -0.0018507357453927398, -0.01264259684830904, 0.012164987623691559, -0.04958707466721535, 0.021618841215968132, 0.031044598668813705, 0.009299332275986671, -0.0013186930445954204, -0.0007269493071362376, -0.0069780112244188786, -0.027406340464949608, -0.027027063071727753, 0.011476668529212475, -0.022574059665203094, -0.028768932446837425, 0.03975394368171692, -0.028614411130547523, 0.011617141775786877, -0.030904125422239304, 0.021773360669612885, 0.03157839924097061, 0.00438979035243392, 0.0095240892842412, -0.024245690554380417, -0.010100030340254307, -0.025088531896471977, 0.003690935904160142, -0.05978543683886528, 0.006317786406725645, 0.02746252901852131, 0.023360708728432655, 0.01765749417245388, 0.0018524916376918554, -0.02230715937912464, 0.004523240029811859, 0.012481052428483963, -0.009243142791092396, 0.028178943321108818, 0.005120251793414354, -0.01765749417245388, -0.04267578944563866, 0.03523070365190506, -0.01256533619016409, 0.001631246181204915, -0.0053204260766506195, -0.025762803852558136, -0.011272981762886047, -0.031803153455257416, -0.0459347702562809, 0.03666353225708008, 0.035708311945199966, 0.027813713997602463, -0.04149581119418144, -0.011329171247780323, -0.018556522205471992, 0.017446784302592278, 0.001440729247406125, -0.057088349014520645, -0.008442445658147335, -0.01419482659548521, -0.023135952651500702, -0.002402093494310975, 0.023234283551573753, 0.007262469734996557, 0.033207885921001434, -0.00093414745060727, -0.02760300226509571, -0.027420388534665108, 0.03379787504673004, 0.020171966403722763, 0.03646686673164368, 0.0191886518150568, -0.012080703862011433, -0.010732159949839115, -0.03126935660839081, -0.026675879955291748, 0.01490421686321497, -0.03239314258098602, 0.0305669903755188, -0.06040351837873459, -0.02153455652296543, 0.023135952651500702, 0.023557372391223907, 0.037197329103946686, 0.006697064731270075, 0.01834581233561039, -0.009755870327353477, 0.005225606728345156, -0.014356371015310287, 0.018921753391623497, 0.0036312348674982786, 0.0076417475938797, 0.0030746092088520527, 0.0014521427219733596, 0.06776431947946548, -0.027139442041516304, -0.07186613976955414, -0.01994720846414566, 0.011181674897670746, -0.01227736659348011, -0.013071040622889996, -0.019610071554780006, -0.009762894362211227, -0.009629444219172001, 0.020452912896871567, 0.04368719458580017, -0.01689893752336502, -0.02765919268131256, 0.0011123729636892676, -0.018711043521761894, 0.020312439650297165, -0.034781187772750854, 0.021913833916187286, 0.015803245827555656, -0.01682870090007782, -0.02528519369661808, -0.014286134392023087, -0.03146601840853691, 0.002942915540188551, -0.021295752376317978, 0.021646935492753983, 0.017025364562869072, 0.01994720846414566, -0.016351092606782913, -0.008189593441784382, -0.005685656797140837, 0.02286905236542225, 0.0020087682642042637, 0.018626758828759193, 0.022447632625699043, -0.04158009588718414, -0.024203550070524216, 0.024315927177667618, -0.036382585763931274, -0.012031538411974907, -0.021646935492753983, -0.030173664912581444, 0.02834751084446907, -0.03267408907413483, -0.011469644494354725, 0.020860284566879272, 0.01755916140973568, -0.0028832145035266876, 0.029443202540278435, 0.023557372391223907, 0.006553079467266798, -0.018008677288889885, -0.04672141745686531, 0.013169371522963047, 0.009425758384168148, 0.005924461409449577, -0.02211049757897854, -0.023487135767936707, 0.03160649165511131, 0.0052080475725233555, 0.016393233090639114, 0.014581128023564816, -0.008702320978045464, 0.022742627188563347, -0.0017128962790593505, 0.02681635320186615, -0.002105343621224165, -0.01983482949435711, -0.019652213901281357, -0.007655794732272625, -0.017868204042315483, 0.01692703180015087, -0.029387013986706734, -0.025818992406129837, 0.0456819161772728, 0.006823490373790264, 0.037225425243377686, 0.0013906856765970588, 0.037815410643815994, -0.003487249603495002, -0.004168545361608267, 0.0008538142428733408, -0.014482797123491764, -0.03371359035372734, 0.006121124140918255, -0.013963045552372932, -0.011574999429285526, -0.012523194774985313, -0.022826911881566048, -0.0055522071197628975, 0.004080749116837978, -0.040147267282009125, -0.02383831888437271, -0.0015592536656185985, 0.013710194267332554, -0.01231248490512371, 0.010907751508057117, 0.0015364267164841294, 0.020396722480654716, -0.13159538805484772, -0.05045801028609276, 0.0010904240189120173, -0.02368379756808281, 0.015536346472799778, -0.04028774052858353, 0.012094751000404358, 0.01257236022502184, 0.025088531896471977, -0.015901576727628708, 0.02209644950926304, -0.02368379756808281, -0.0002758983464445919, -0.014356371015310287, 0.01980673521757126, -0.06040351837873459, -0.0033485323656350374, 0.004112355876713991, 0.03697257116436958, -0.015058737248182297, 0.006187848746776581, 0.004740973934531212, 0.02080409601330757, 0.025116626173257828, -0.017320357263088226, 0.012129869312047958, 0.00012905984476674348, 0.014595176093280315, 0.001784888794645667, 0.016337044537067413, -0.02602970227599144, -0.008807675912976265, 0.0006259841611608863, 0.036410678178071976, -0.022391444072127342, 0.0019543347880244255, -0.024077123031020164, -0.0017550382763147354, 0.0017445028061047196, -0.012740927748382092, -0.021815503016114235, -0.053941745311021805, 0.044867172837257385, -0.021927881985902786, 0.022770721465349197, -0.004028071649372578, 0.008730415254831314, -0.016660133376717567, 0.01673037000000477, -0.01765749417245388, 0.00915183499455452, 0.0010377464350312948, 0.02135194092988968, 0.04228246212005615, 0.005878807511180639, -0.008175546303391457, -0.00034745191805996, -0.021590745076537132, 0.04750806838274002, 0.015747057273983955, 0.010549544356763363, 0.034837376326322556, 0.013323891907930374, -0.0133871054276824, -0.04040012136101723, -0.013668051920831203, 0.010261574760079384, 0.04135533794760704, -0.011926183477044106, -0.045485254377126694, -0.016547754406929016, 0.04006298631429672, 0.006640875246375799, -0.003848968306556344, 0.00918695330619812, -0.014707554131746292, 0.04840710014104843, 0.03427548334002495, -0.008316019549965858, 0.015887530520558357, 0.03739399090409279, -0.044839076697826385, -0.012045585550367832, -0.013878761790692806, 0.012754975818097591, 0.030145570635795593, 0.022405490279197693, -0.014665412716567516, -0.003968370612710714, 0.03593306988477707, 0.040231551975011826, -0.004944660235196352, 0.020916474983096123, 0.015957767143845558, 0.008105309680104256, -0.007768173236399889, 0.02986462414264679, 0.022012166678905487, 0.043265774846076965, 0.0027743475511670113, 0.05144132301211357, 0.006939380895346403, 0.02441425994038582, -0.025622328743338585, 0.006974499206990004, 0.006268620956689119, 0.010331811383366585, -0.01189808826893568, 0.006753253750503063, -0.0191465113312006, 0.02062148042023182, 0.029555581510066986, -0.006605756934732199, 0.030370326712727547, 0.022672390565276146, 0.025439715012907982, 0.04430527985095978, 0.0058296420611441135, 0.03264599293470383, -0.01850033365190029, 0.0027111347299069166, 0.012579384259879589, -0.03368549793958664, -0.023178094998002052, -0.03382597118616104, -0.024962104856967926, 0.015873482450842857, 0.024175453931093216, -0.016435375437140465, -0.021085042506456375, -0.0076206764206290245, 0.001975405728444457, -0.004421397112309933, 0.017994629219174385, -0.01345031801611185, -0.002222989918664098, 0.008723392151296139, 0.0050886450335383415, -0.02056529000401497, 0.04340624809265137, -0.014553033746778965, -0.012825212441384792, 0.030061285942792892, -0.004705855622887611, -0.0004899006453342736, 0.014665412716567516, -0.014033282175660133, -0.03688828647136688, -0.039304427802562714, 0.02135194092988968, 0.008681249804794788, -0.01614038273692131, 0.0016145650297403336, 0.04287245124578476, 0.011539881117641926, 0.020495053380727768, 0.0008094774093478918, -0.03966965898871422, -0.015199210494756699, 0.025004247203469276, 0.013113182038068771, 0.031859345734119415, 0.03455642983317375, 0.0014934067148715258, 0.023262377828359604, -0.014047330245375633, -0.06310060620307922, 0.0008037706720642745, -0.02456877939403057, 0.01599990949034691, -0.009292308241128922, 0.0021492415107786655, 0.04832281544804573, 0.01979268714785576, -0.0002130145876435563, -0.003968370612710714, 0.015143021941184998, 0.0043546720407903194, 0.007360800635069609, 0.040962014347314835, -0.012818188406527042, 0.003278295509517193, -0.01227034255862236, 0.04278816655278206, 0.017236074432730675, 0.018584616482257843, 0.007908646948635578, 0.03655115142464638, 0.01305699348449707, 0.02614208124577999, -0.016266807913780212, 0.03531498834490776, -0.006732183042913675, 0.03351692855358124, -0.0018946336349472404, -0.019539834931492805, 0.030089380219578743, 0.036354489624500275, -0.029555581510066986, -0.03924823924899101, -0.003281807526946068, 0.03958537429571152, 0.015367778949439526, 0.00036040181294083595, -0.036410678178071976, 0.03388215973973274, -0.013639957644045353, -0.031100789085030556, -0.008028049021959305, 0.010725135914981365, -0.019343173131346703, 0.015494205057621002, -0.016575848683714867, 0.041636284440755844, -0.011413455940783024, -0.02531328797340393, 0.020087681710720062, 0.014721601270139217, -0.021056948229670525, -0.015395873226225376, -0.050317537039518356, -0.02071981132030487, -0.01104822475463152, 0.006890215445309877, -0.007957812398672104, -0.0004095674667041749, 0.0037401015870273113, -0.011926183477044106, -0.002877946710214019, 0.010605733841657639, 0.005352032836526632, 0.0020948080345988274, 0.02913416177034378, -0.004126403015106916, -0.01604204997420311, -0.020045539364218712, 0.008646131493151188, -0.024245690554380417, -0.003304634243249893, 0.0014100007247179747, 0.03927633538842201, 0.017334405332803726, -0.013337939977645874, 0.003123774891719222, 0.010254550725221634, 0.0062405262142419815, 0.009306356310844421, 0.007824363186955452, -0.010444189421832561, -0.015114926733076572, 0.01382959634065628, -0.0014846271369606256, 0.025790898129343987, -0.015508252196013927, -0.0026268507353961468, -0.009067551232874393, 0.04059678316116333, 0.04981183260679245, 0.04062487930059433, 0.03303932026028633, -0.024077123031020164, 0.04509192705154419, 0.0013274726225063205, -0.01823343336582184, 0.015255399979650974, -0.01264962088316679, -0.036298301070928574, -0.007409966550767422, -0.001282696845009923, -0.016744418069720268, -0.04062487930059433, 0.013260679319500923, 0.011659284122288227, 0.007353777065873146, 0.007571510970592499, 0.016351092606782913, 0.02368379756808281, -0.01689893752336502, 0.0192167479544878, -0.0153396837413311, -0.014075424522161484, -0.01605609804391861, -0.029387013986706734, -0.010612757876515388, 0.013710194267332554, 0.012396768666803837, -0.02992081269621849, -0.029752245172858238, 0.01990506611764431, -0.013148300349712372, 0.026212317869067192, 0.032533615827560425, -0.0025636376813054085, -0.0027831271290779114, -0.022489774972200394, 0.00801400188356638, 0.019553883001208305, -0.009215048514306545, 0.015606583096086979, -0.019652213901281357, 0.031915534287691116, 0.020888378843665123, 0.029555581510066986, 0.007536392658948898, 0.010893704369664192, 0.010697041638195515, 0.02225097082555294, -0.061246357858181, -0.013745312578976154, -0.006409094203263521, -0.0152834951877594, 0.038658250123262405, 0.03264599293470383, 0.009432782419025898, 0.018725091591477394, -0.007058783434331417, 0.010725135914981365, -0.02611398696899414, 0.022588105872273445, -0.02060743235051632, -0.004712879192084074, 0.00956623163074255, -0.00267777219414711, 0.004147474188357592, -0.0026321185287088156, -0.030145570635795593, -0.008533752523362637, -0.027069205418229103, 0.007655794732272625, 0.013071040622889996, 0.0009718996589072049, 0.00010392829426564276, -0.0075082979165017605, 0.02597351372241974, -0.02598755992949009, 0.018261529505252838, -0.0191184151917696, 0.004509192891418934, -0.015789199620485306, -0.003817361779510975, 0.04062487930059433, 0.03511832281947136, 0.001710262382403016, 0.014279110357165337, -0.019596025347709656, 0.024287832900881767, -0.024863773956894875, -0.008920054882764816, -0.006556591019034386, -0.019385315477848053, 0.07770983129739761, -0.01987697184085846, -0.02368379756808281, 0.0021826038137078285, -0.01751702092587948, 0.0384615883231163, -0.012776046060025692, -0.00166899838950485, -0.04132724553346634, -0.00020105240400880575, 0.004698832053691149, 0.01682870090007782, 0.0057137515395879745, -0.020101729780435562, 0.021675029769539833, -0.017081553116440773, -0.00918695330619812, 0.01302187517285347, 0.01607014611363411, 0.05736929550766945, 0.0031343104783445597, 0.03475309535861015, -0.01267771515995264, -0.00726949330419302, 0.002818245440721512, 0.02824917994439602, -0.007220327388495207, 0.004895494319498539, 0.003476714249700308, 0.04309720918536186, -0.017432736232876778, -0.04916565492749214, -0.02373998798429966, 0.00918695330619812, -0.005611908156424761, 0.019329125061631203, -0.04762044921517372, 0.03742208704352379, -0.027097299695014954, 0.015620631165802479, 0.0006286179996095598, 0.027926091104745865, -0.001984185306355357, -0.009088622406125069, -0.014890169724822044, -0.01115357968956232, -0.018682949244976044, 0.021099088713526726, 0.01748892478644848, 0.001700604916550219, -0.023543324321508408, -0.0030043725855648518, 0.009144811891019344, -0.014335299842059612, 0.019511740654706955, -0.010233479551970959, -0.021211467683315277, 0.04512002319097519, 0.006405582185834646, 0.017011316493153572, -0.0306231789290905, -0.0020983198191970587, -0.045513350516557693, 0.0002989447384607047, -0.009208024479448795, -0.04854757338762283, -0.005130787380039692, -0.003975394181907177, -0.007072830572724342, 0.02310785837471485, -0.038545873016119, -0.0047620446421206, 0.0001806398795451969, 0.01382257230579853, 0.010521450079977512, 0.019708404317498207, -0.005910413805395365, 0.003543438855558634, 0.030960315838456154, 0.02838965319097042, -0.01599990949034691, -0.01220010593533516, -0.03472499921917915, 0.012747951783239841, 0.01261450257152319, -0.005632979329675436, 0.025411618873476982, -0.01771368272602558, -0.009720752015709877, 0.02064957469701767, 0.005878807511180639, 0.018795328214764595, 0.046384282410144806, 0.0043546720407903194, -0.003817361779510975, 0.0095943259075284, -0.0307074636220932, -0.00652498472481966, 0.03576450049877167, -0.03351692855358124, -0.017222026363015175, 0.005425781011581421, -0.020846238359808922, 0.006180825177580118, -0.010465260595083237, -0.010999059304594994, -0.05158179625868797, -0.020129824057221413, 0.014791837893426418, -0.01038097683340311, -0.006324810441583395, 0.003569777589291334, 0.040343932807445526, 0.0001381686597596854, 0.005366079974919558, 0.013000803999602795, -0.002249328652396798, 0.03773112967610359, -0.005380127113312483, -0.04287245124578476, 0.03587688133120537, -0.00915885902941227, 0.029583675786852837, 0.01996125653386116, 0.0077330549247562885, -0.011244887486100197, -0.0007493372540920973, -0.012172011658549309, -0.014524939469993114, -0.015873482450842857, -0.006437188945710659, 0.004428420681506395, 0.009994675405323505, -0.008835770189762115, 0.022784769535064697, 0.0381525494158268, -0.0009165882947854698, -0.0044038379564881325, -0.030988410115242004, 0.003239665413275361, 0.004832281265407801, 0.029302729293704033, -0.0004644398286473006, 0.016308950260281563, 0.023248331621289253, -0.0036242110654711723, 0.00726949330419302, 0.0004675126983784139, 0.002017547842115164, 0.009664562530815601, -0.01449684426188469, -0.03517451509833336, 0.008695296943187714, 0.02309381030499935, -0.007416990119963884, -0.0065179611556231976, -0.009650515392422676, -0.015929672867059708, 0.0008037706720642745, -0.01828962378203869, -0.0021492415107786655, -0.006967475637793541, -0.002821757458150387, 0.02289714850485325, 0.039529185742139816, -0.02524305135011673, -0.04422099515795708, 0.004765556659549475, 0.022700484842061996, -0.011062271893024445, 0.04677760973572731, 0.002683039987459779, -0.00594904413446784, -0.02378213033080101, -0.0049797785468399525, -0.00023331737611442804, -0.029583675786852837, 0.02296738512814045, -0.03511832281947136, 0.015367778949439526, -0.011750590987503529, 0.00882172305136919, 0.021211467683315277, -0.005587325431406498, 0.004119379445910454, 0.00039859299431554973, -0.007213303819298744, 0.015690866857767105, -0.0039894417859613895, -0.0002217941655544564, -0.006061422638595104, -0.010071935132145882, 0.0026883077807724476, -0.003378382883965969, 0.02388046123087406, 0.018064865842461586, -0.010029793716967106, 0.041018202900886536, 0.03775922209024429, 0.006366952322423458, -0.007339729927480221, -0.01618252322077751, -0.006802419666200876, -0.024835679680109024, -0.00020588118059094995, 0.00989634357392788, -0.006138683296740055, -0.0017725974321365356, -0.005566254258155823, -0.02459687367081642, 0.020424816757440567, 0.005987674463540316, -0.012080703862011433, -0.008554823696613312, 0.014651364646852016, -0.01453898660838604, 0.01379447802901268, 0.010956916958093643, -0.040147267282009125, -0.023950697854161263, 0.004035095684230328, 0.01618252322077751, 0.035567838698625565, 0.012445934116840363, -0.008596966043114662, 0.04394004866480827, -0.010071935132145882, -0.008189593441784382, -0.005678633227944374, 0.0016821677563712, 0.0002756788453552872, -0.014468749985098839, 0.01497445348650217, 0.006465283688157797, 0.015241352841258049, -0.007037712261080742, 0.007188721094280481, -0.004028071649372578, 0.021267658099532127, 0.022672390565276146, -0.005647026468068361, 0.01748892478644848, 0.02513067238032818, 0.02383831888437271, -0.030398420989513397, 0.030370326712727547, 0.0267742108553648, 0.0382368303835392, -0.04045630991458893, 0.021646935492753983, -0.009439805522561073, 0.03475309535861015, -0.029246540740132332, -0.04270388185977936, 0.016702275723218918, -0.025495903566479683, -0.007262469734996557, -0.010999059304594994, 0.01983482949435711, 0.017053458839654922, -0.02617017552256584, -0.007754126098006964, -0.01220010593533516, 0.012853306718170643, -0.011525833979249, 0.041832949966192245, -0.02209644950926304, 0.00996658019721508, -0.011560952290892601, -0.011525833979249, -0.011434526182711124, 0.01979268714785576, -0.0037998026236891747, -0.02286905236542225, 0.0023862901143729687, 0.015171116217970848, -0.01415970828384161, -0.0042177108116447926, 0.005678633227944374, -0.00517644127830863, 0.02216668613255024, -0.006570638623088598, -0.0028287810273468494, -0.01688489131629467, -0.013654004782438278, -0.0013222049456089735, -0.007136043626815081, 0.013288773596286774, 0.004884958732873201, 0.0005395052721723914, -0.007613652851432562, 0.01341519970446825, 0.01764344610273838, -0.02459687367081642, -0.014075424522161484, 0.011708449572324753, 0.006848073098808527, 0.0005078987451270223, -0.014349346980452538, 0.011926183477044106, -0.024329975247383118, -0.03618592023849487, -0.015901576727628708, 0.025088531896471977, 0.02386641316115856, 0.041748665273189545, 0.0029077972285449505, 0.0614149272441864, -0.0028287810273468494, 0.01111846137791872, -0.030089380219578743, 0.02770133502781391, -0.005685656797140837, 0.007129020057618618, 0.018584616482257843, 0.0026338743045926094, -0.01109036710113287, 0.00960134994238615, -0.01035288255661726, 0.04458622634410858, -0.012930567376315594, -0.019469598308205605, -0.01067597046494484, 0.0006334467907436192, 0.029752245172858238, -0.025523997843265533, 0.014342323876917362, 0.038742534816265106, 0.0029306241776794195, -0.0191886518150568, 0.023388804867863655, -0.013197466731071472, 0.045653823763132095, -0.0010447701206430793, -0.014026259072124958, 0.000855131191201508, 0.015058737248182297, 0.01671632193028927, 0.04382766783237457, -0.021618841215968132, -0.01678655855357647, 0.01490421686321497, -0.03197172284126282, -0.02005958743393421, -0.006848073098808527, 0.008344113826751709, -0.015452062711119652, 0.004660201724618673, -0.021731220185756683, 0.007592581678181887, 0.02756086178123951, 0.04646856710314751, 0.008035073056817055, 0.003174696583300829, 0.02230715937912464, 0.020452912896871567, -0.002179092029109597, -0.0009631200809963048, -0.020045539364218712, -0.0038033146411180496, -0.028192991390824318, -0.010760254226624966, 0.029583675786852837, 0.021632887423038483, -0.013689123094081879, -0.001459166407585144, -0.017376547679305077, -0.005991186015307903, -0.011989396065473557, -0.020944569259881973, -0.025060435757040977, 0.020200060680508614, 0.015676820650696754, 0.024091171100735664, -0.014482797123491764, -0.0269006360322237, -0.014679459854960442, -0.01231248490512371, 0.010956916958093643, -0.012923543341457844, 0.01758725754916668, -0.02597351372241974, -0.004691808018833399, -0.02073385939002037, -0.004298483021557331, -0.00400700094178319, -0.007129020057618618, 0.023487135767936707, -0.012719857506453991]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
" for Efficient Inference
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 0
0.0760.0780.0800.0820.0840.0860.0880.090
(i) Layer 0
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 1
0.0760.0780.0800.0820.0840.0860.0880.090 (ii) Layer 1
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 2
0.00.20.40.60.81.0 (iii) Layer 2
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 3
0.00.20.40.60.81.0
(iv) Layer 3
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 4
0.00.20.40.60.81.0 (v) Layer 4
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 5
0.00.20.40.60.81.0 (vi) Layer 5
Figure 15. Activations for OPT-66B
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 6
0.00.20.40.60.81.0
(vii) Layer 6
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 7
0.00.20.40.60.81.0 (viii) Layer 7
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 8
0.00.20.40.60.81.0 (ix) Layer 8
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 9
0.00.20.40.60.81.0
(x) Layer 9
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 10
0.00.20.40.60.81.0 (xi) Layer 10
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69He","[0.01823403872549534, 0.013169028796255589, 0.04992074891924858, -0.005778164602816105, 0.03368029743432999, 0.01277193147689104, 0.03695432096719742, -0.01328248530626297, -0.014279278926551342, -0.003036980517208576, 0.04291887581348419, 0.003225398948416114, -0.022545376792550087, -0.0028708481695502996, 0.03821854665875435, -0.024425508454442024, 0.042465053498744965, -0.02244812808930874, -0.02995244972407818, 0.06045597046613693, -0.010332622565329075, 0.0016704406589269638, 0.0023055931087583303, 0.02014658786356449, 0.014927600510418415, -0.016540300101041794, 0.009035979397594929, -0.007431384176015854, 0.057992350310087204, -0.029482416808605194, -0.0009861576836556196, -0.0487537682056427, -0.021135278046131134, -0.030843891203403473, -0.03053593821823597, 0.0008737143944017589, 0.007054547313600779, 0.020875949412584305, -0.025252118706703186, 0.0007232835632748902, 0.06071529909968376, -0.05387550964951515, -0.03896411508321762, -0.03316164016723633, 0.01823403872549534, -0.005899725016206503, -0.0391261987388134, -0.02319369837641716, 0.013298693113029003, 0.04084425047039986, -0.01747226156294346, 0.01991967484354973, -0.016062162816524506, 0.03637083247303963, -0.03870478644967079, 0.018104374408721924, -0.0004553445032797754, 0.04324303939938545, 0.06528596580028534, 0.010024669580161572, 0.033518217504024506, 0.01472499966621399, 0.017083268612623215, -0.025689736008644104, 0.03154083713889122, 0.023728564381599426, -0.07332514971494675, 0.02301540970802307, 0.035625260323286057, 0.008213422261178493, -0.036305997520685196, 0.05980765074491501, 0.02925550378859043, -0.0021901107393205166, 0.01125648058950901, 0.043891359120607376, -0.006013181060552597, 0.026840506121516228, 0.010494702495634556, -0.030827682465314865, 0.029142048209905624, 0.008257993496954441, 0.08791238069534302, -0.04849443957209587, 0.02141081541776657, -0.02303161844611168, -0.0347176119685173, -0.008898211643099785, -0.061039458960294724, -0.048624105751514435, -0.032756440341472626, 0.004821890499442816, -0.01897960901260376, -0.004137101117521524, 0.004003384616225958, -0.04868893697857857, 0.01915789768099785, -0.009092708118259907, -0.016678068786859512, -0.025349367409944534, 0.03481486067175865, 0.005300027318298817, 0.043988607823848724, 0.021702559664845467, 0.012399147264659405, 0.004021618515253067, -0.027618492022156715, -0.0068397908471524715, -0.07527011632919312, 0.004291077144443989, -0.03873720392584801, -0.005445899907499552, -0.00777985667809844, 0.03238365426659584, 0.042465053498744965, -0.02285332977771759, -0.025316951796412468, -0.008687506429851055, 0.004870514385402203, -0.028526142239570618, -0.013468877412378788, -0.05507490411400795, 0.031508419662714005, 0.005599875934422016, -0.022415712475776672, -0.05069873481988907, 0.05086081475019455, -0.03961243852972984, -0.01863924041390419, -0.018509576097130775, 0.03987176716327667, 0.02513866312801838, 0.043891359120607376, -0.026759466156363487, -0.004477469716221094, 0.043567199259996414, 0.008906315080821514, 0.09121882170438766, -0.019627930596470833, 0.009643780998885632, 0.00506095914170146, -0.02953103929758072, 0.008800962939858437, 0.027877820655703545, 0.008091861382126808, 0.03753780946135521, -0.042886462062597275, 0.04022834450006485, -0.0307952668517828, 0.03223778307437897, 0.0037035360001027584, -0.011045776307582855, -0.024911750108003616, -0.029401374980807304, 0.012164130806922913, -0.08110500872135162, 0.008873899467289448, 0.050569068640470505, 0.004671966191381216, 0.06638811528682709, -0.007941937074065208, -0.007613724563270807, 0.023631315678358078, 0.009886901825666428, -0.008541634306311607, 0.05218987166881561, 0.004676018375903368, -0.003729874035343528, -0.09796136617660522, -0.0443451851606369, 0.01719672605395317, 0.01551108993589878, -0.05445899814367294, -0.002139460761100054, -0.03011452965438366, 0.03400445729494095, -0.01787746325135231, 0.002722949953749776, -0.02766711637377739, -0.022464336827397346, 0.012366730719804764, 0.04687363654375076, 0.016208035871386528, 0.034036874771118164, -0.029547248035669327, -0.015324696898460388, 0.012504499405622482, -0.0026155717205256224, 0.017585719004273415, -0.006556150037795305, 0.00820531789213419, 0.02259400114417076, 0.05202779173851013, 0.004359961487352848, 0.001598517526872456, -0.05990489944815636, 0.058997247368097305, -0.03222157433629036, 0.017164308577775955, -0.0012591617414727807, 0.007937884889543056, 0.001966237323358655, 0.046614307910203934, -0.024911750108003616, 0.007390864193439484, -0.0014354240847751498, -0.02335577830672264, -0.022415712475776672, 0.03701915219426155, -0.028704430907964706, 0.0487537682056427, -0.06113670766353607, -0.000760258175432682, -0.012707099318504333, -0.031070804223418236, 0.021978095173835754, -0.03575492650270462, -0.0247820857912302, -0.012617954984307289, 0.009003563784062862, -0.008452489972114563, 0.06573978811502457, 0.034458283334970474, 0.010891799814999104, -0.03061697818338871, 0.0613960362970829, 0.04249746724963188, -0.010000357404351234, 0.00787305273115635, -0.02682429738342762, 0.023566482588648796, -0.007111275568604469, 0.02556007169187069, -0.038510292768478394, -0.022123968228697777, -0.03685707226395607, -0.0038960063830018044, -0.0022468389943242073, -0.016840148717164993, -0.03069801814854145, -0.006681762635707855, 0.0393206924200058, -0.008541634306311607, 0.03734331205487251, -0.02497658133506775, -0.023760979995131493, -0.01467637624591589, -0.017990918830037117, -0.0017160257557407022, -0.02058420516550541, 0.027634700760245323, -0.007269303780049086, -0.029725536704063416, -0.01311230007559061, -0.057992350310087204, 0.026791881769895554, 0.014254966750741005, 0.013655269518494606, 0.0029235242400318384, 0.04223813861608505, -0.016840148717164993, -0.034782443195581436, -0.05160638317465782, 0.009254788048565388, -0.0487537682056427, -0.006450797896832228, 0.021880848333239555, 0.01803954318165779, -0.03262677416205406, -0.08337413519620895, 0.010000357404351234, -0.0035840016789734364, 0.04791095107793808, 0.003545507788658142, -0.03131392225623131, -0.03974210098385811, 0.01829887181520462, 0.02278849668800831, -0.053681012243032455, 0.014279278926551342, -0.019595514982938766, 0.008160745725035667, 0.042302973568439484, 0.03358304873108864, -0.024814501404762268, -0.013347316533327103, -0.019190313294529915, 0.01277193147689104, -0.01897960901260376, -0.06846274435520172, 0.03526868298649788, -0.041103579103946686, 0.019417226314544678, -0.006009128876030445, -9.155007137451321e-05, 0.013776829466223717, 0.017342597246170044, -0.014919496141374111, 0.0073422398418188095, 0.007257147692143917, 0.04116841033101082, 0.007022131234407425, 0.010470390319824219, 0.00050599459791556, -0.021897055208683014, 0.008322825655341148, 0.01795850321650505, 0.018947193399071693, 0.019336186349391937, -0.03278885409235954, -0.022042928263545036, -0.009927421808242798, 0.0026601438876241446, -0.025949064642190933, -0.04502592235803604, -0.043307870626449585, 0.04486384242773056, 0.0021273046731948853, -0.004165465012192726, -0.013501293025910854, -0.008792859502136707, -0.025835607200860977, 0.001341214869171381, 8.205317863030359e-05, 0.04282163083553314, 0.028396477922797203, -0.031054595485329628, -0.0019763673190027475, 0.03763505816459656, -0.04408585652709007, -0.011280792765319347, -0.019968299195170403, -0.015000537037849426, 0.021978095173835754, -0.011572537012398243, -0.0014080730034038424, -0.0612015426158905, 0.019433435052633286, 0.009157540276646614, 0.027975069358944893, -0.055042486637830734, 0.006361654028296471, -0.010494702495634556, -0.013144716620445251, -0.046776387840509415, -0.014222551137208939, 0.012099298648536205, -0.0052797673270106316, 0.07150985300540924, 0.010640575550496578, -0.04071458429098129, 0.015656961128115654, 0.011685993522405624, 0.008091861382126808, -0.027359163388609886, 0.007792012766003609, 0.05802476778626442, -0.04285404458642006, -0.05361618101596832, 0.036403246223926544, -0.04522041976451874, 0.026759466156363487, 0.02841268479824066, 0.013160924427211285, 0.022966785356402397, 0.022901954129338264, -0.03543076664209366, 0.024149972945451736, -0.0008504153229296207, 0.012877283617854118, 0.02471725456416607, 0.01589197851717472, -0.0123910428956151, -0.03763505816459656, -0.06146087124943733, -0.01727776601910591, -0.018930984660983086, 0.003381401300430298, 0.03178395703434944, 0.03214053437113762, -0.0017028567381203175, 0.01159684918820858, 0.020308667793869972, 0.0190606489777565, 0.03854270651936531, -0.06486455351114273, -0.014506191946566105, -0.004805682227015495, -0.06395690888166428, -0.03257815167307854, 0.0327078141272068, 0.010073293931782246, 0.016037851572036743, 0.010729718953371048, -0.010356934741139412, -0.012974532321095467, 0.030665602535009384, 0.07235267013311386, 0.0013250068295747042, 0.023485442623496056, 0.0027391579933464527, 0.006353549659252167, -0.04447484761476517, 0.010932319797575474, -0.02277228981256485, -0.010754031129181385, 0.01940101757645607, 0.014036158099770546, 0.03575492650270462, 0.02615976892411709, 0.019368601962924004, -0.008148590102791786, 0.017764005810022354, -0.03941794112324715, 0.012220858596265316, 0.009206163696944714, 0.018315080553293228, 0.001909509184770286, -0.02564111165702343, 0.01611078716814518, -0.0443451851606369, -0.030082114040851593, 0.005336495582014322, 0.016418740153312683, -0.03312922269105911, -0.0004219154070597142, 0.047943368554115295, -0.04907793179154396, 0.025705944746732712, -0.08272580802440643, -0.018541991710662842, 0.039936598390340805, -0.004643602296710014, 0.039677269756793976, -0.018995817750692368, -0.009319620206952095, -0.019336186349391937, 0.025203494355082512, 0.01087559200823307, -0.006762802600860596, -0.0018983661429956555, 0.023825811222195625, -0.004906982649117708, -0.04227055609226227, -0.07488112151622772, 0.035139020532369614, -0.05060148611664772, -0.04123324155807495, -0.0074638002552092075, 0.008760442957282066, -0.02925550378859043, -0.016629444435238838, -0.013711998239159584, 0.036565326154232025, -0.017407430335879326, -0.016904979944229126, 0.08220715820789337, 0.007552944589406252, 0.03873720392584801, -0.025430407375097275, -0.03121667541563511, -0.02935275249183178, -0.010932319797575474, 0.00986258964985609, -0.036630161106586456, 0.05228712037205696, -0.025997688993811607, -0.015754209831357002, 0.05770060420036316, 0.04437759891152382, -0.020373500883579254, -0.029385168105363846, 0.024393092840909958, -0.040520086884498596, -0.00990310963243246, 0.024425508454442024, 0.0443451851606369, 0.0018902621231973171, 0.012131714262068272, -0.07993803173303604, -0.027116043493151665, -0.01922272890806198, 0.00019829517987091094, 0.010826967656612396, 0.03659774363040924, 0.054361749440431595, 0.03406928852200508, 0.005636344198137522, -0.022302256897091866, 0.0026783777866512537, -0.033291302621364594, 0.006543994415551424, 0.06729575991630554, -0.022237423807382584, 0.011815657839179039, 0.01795850321650505, -0.007613724563270807, -0.06055321916937828, -0.012901595793664455, -0.040617335587739944, 0.03581975772976875, 0.05206020921468735, 0.05896483361721039, 0.018833737820386887, 0.035203851759433746, 0.022334672510623932, 0.03332372009754181, 0.026127353310585022, -0.04026075825095177, 0.009457388892769814, -0.0034705456346273422, 0.018930984660983086, -0.014230654574930668, -0.007066703401505947, -0.02841268479824066, 0.017229141667485237, 0.011661681346595287, 0.017569510266184807, -0.017488470301032066, -0.01661323569715023, -0.025203494355082512, -0.0012338366359472275, -0.04343753308057785, -0.021216318011283875, 0.0029296022839844227, -0.012617954984307289, -0.0005011828616261482, -0.09517358243465424, -0.03594942390918732, 0.022723665460944176, 0.02875305525958538, -0.04158981889486313, -0.0030207724776118994, 0.023825811222195625, -0.02285332977771759, 0.02513866312801838, 0.017812630161643028, -0.005008283071219921, -0.0253817830234766, -0.0084768021479249, 0.009238580241799355, 0.020649036392569542, 0.0012540967436507344, -0.013169028796255589, 0.005514783784747124, -0.013079884462058544, 0.02614356018602848, 0.013395940884947777, -0.0035698197316378355, 0.02734295465052128, 0.0038595383521169424, -0.0029863305389881134, 0.038672372698783875, -0.004218141082674265, -0.03970968723297119, 0.01095663197338581, -0.014109094627201557, 0.01358233392238617, 0.012074986472725868, -0.004534197971224785, 0.03517143800854683, -0.013185236603021622, 0.02243192121386528, -0.015502985566854477, 0.011118711903691292, 0.037505391985177994, -0.0010281972354277968, -0.018363703042268753, 0.012585539370775223, 0.010365038178861141, -0.023226113989949226, -0.027537452057003975, -0.011369937099516392, 0.02496037445962429, 0.004104685038328171, -0.003936526365578175, -0.004359961487352848, 0.03197845444083214, -0.005984817165881395, -0.01721293292939663, -0.026500137522816658, -0.019498266279697418, -0.04402102530002594, -0.027618492022156715, -0.04437759891152382, 0.0018750671297311783, 0.009992253966629505, 0.0265811774879694, -0.0467439740896225, 0.011540121398866177, 0.004846202675253153, 0.004153308924287558, 0.012966427952051163, 0.01855820044875145, -0.0010474442970007658, 0.0017008306458592415, 0.009878797456622124, -0.0160540584474802, 0.019190313294529915, 0.0069127269089221954, -0.004748954437673092, 0.0180557519197464, -0.01855820044875145, 0.01787746325135231, -0.022869538515806198, -0.009741028770804405, -0.02132977358996868, 0.015802834182977676, 0.025495238602161407, 0.014814144000411034, -0.00047788379015401006, 0.007646140642464161, 0.005109583027660847, 0.003012668574228883, -0.023485442623496056, 0.03594942390918732, -0.01669427566230297, 0.0006574384169653058, 0.016362011432647705, -0.005267611239105463, 0.008051341399550438, 0.020438332110643387, 0.018655449151992798, 0.015778522938489914, 0.016921188682317734, 0.033615466207265854, 0.02436067722737789, -0.016135098412632942, -0.020730076357722282, -0.018331287428736687, -0.06878690421581268, -0.03549559786915779, 0.0318974144756794, 0.021621519699692726, -0.024749670177698135, 0.010519014671444893, -0.03380995988845825, 0.0018183389911428094, 0.006880310829728842, -0.040876664221286774, 0.002915420336648822, -0.01727776601910591, 0.005526939872652292, -0.046419814229011536, 0.02800748497247696, 0.03789438679814339, -0.005008283071219921, 0.010535222478210926, -0.050569068640470505, -0.04421551898121834, 0.036565326154232025, -0.005409431643784046, 0.026840506121516228, 0.017148101702332497, 0.003482701489701867, -0.06330858916044235, -0.018331287428736687, 0.0026135456282645464, -0.021362191066145897, -0.025624902918934822, -0.0032031128648668528, 0.0018234039889648557, -0.007220679894089699, -0.035981837660074234, 0.018541991710662842, 0.022399503737688065, 0.01787746325135231, -0.011540121398866177, 0.015146409161388874, -0.023307153955101967, -0.025511447340250015, 0.04732746258378029, 0.03368029743432999, 0.011483392678201199, 0.0371164008975029, -0.019498266279697418, -0.015843354165554047, -0.014352215453982353, -0.035625260323286057, 0.004185725003480911, 0.035139020532369614, 0.020211419090628624, -0.038413044065237045, 0.004359961487352848, -0.009497908875346184, -0.0009370270418003201, 0.030049696564674377, -0.036305997520685196, -0.011483392678201199, -0.020016923546791077, 0.006159053184092045, 0.009919317439198494, 0.03675982356071472, -0.013849765993654728, 0.0013199418317526579, -0.005198727361857891, -0.012026362121105194, 0.02413376420736313, -0.03280506283044815, -0.051411889493465424, -0.02082732506096363, 0.01601353846490383, -0.031005971133708954, 0.018671656027436256, -0.04917518049478531, -0.03734331205487251, -0.01593249849975109, 0.04985591769218445, 0.046679142862558365, -0.03296714276075363, -0.0017808579141274095, 0.0007865962106734514, -0.012642267160117626, 0.006171209271997213, 0.011540121398866177, 0.022723665460944176, 0.014611544087529182, -0.03575492650270462, 0.0076988167129457, -0.03442586585879326, -0.0011365885147824883, 0.03196224570274353, -0.0070302351377904415, -0.007848741486668587, 0.04155740141868591, 0.020260043442249298, -0.0371164008975029, -0.012147922068834305, -0.012852972373366356, 0.00881717074662447, -0.004106711130589247, 0.05640396103262901, 0.004086450673639774, 0.05432933568954468, 0.011126816272735596, 0.022901954129338264, -0.04003384709358215, 0.014100990258157253, -0.013525605201721191, -0.04107116162776947, 0.002080706413835287, -0.07669642567634583, -0.023226113989949226, -0.020778700709342957, 0.015267969109117985, 0.05692261829972267, 0.01042176689952612, 0.003853460308164358, -0.025316951796412468, -0.032335031777620316, -0.004147231113165617, 0.016426844522356987, -0.00474490225315094, -0.01938481070101261, 0.026435306295752525, 0.025868024677038193, 0.027018794789910316, -0.0383157953619957, 0.015024848282337189, 0.012958324514329433, 0.02285332977771759, 0.008574050851166248, -0.019255146384239197, -0.022545376792550087, 0.0009618455660529435, -0.0175533015280962, -0.05128222331404686, -0.022658832371234894, 0.03131392225623131, 0.03533351793885231, -0.0026378578040748835, 0.007018079049885273, 0.023517858237028122, 0.0007075820467434824, 0.031103219836950302, -0.00910891592502594, 0.030049696564674377, -0.021102862432599068, -0.024020308628678322, -0.026273224502801895, -0.05682536959648132, -0.0025223754346370697, -0.011799450032413006, -0.0004067203844897449, -0.005737644620239735, 0.003831174224615097, 0.01563264988362789, 0.01578662544488907, 0.017439845949411392, -0.06463764607906342, 0.007313875947147608, -0.023809604346752167, -0.011645473539829254, -0.014619647525250912, 0.008857691660523415, 0.004485573619604111, -0.0084768021479249, -0.12162509560585022, 0.00103478180244565, 0.03449069708585739, 0.009035979397594929, -0.018250247463583946, -0.011183544062077999, 0.010008461773395538, 0.05264369770884514, 0.01889856904745102, 0.011945322155952454, 0.009676196612417698, -0.0012814478250220418, -0.01982242614030838, -0.0017352728173136711, 0.022140176966786385, -0.020519372075796127, 0.03423137217760086, -0.009967941790819168, -0.004578770138323307, -0.029061006382107735, -0.03526868298649788, -0.003012668574228883, 0.015041057020425797, 0.020373500883579254, -0.03155704587697983, -0.028137149289250374, -0.011321312747895718, 0.0029417583718895912, 0.019498266279697418, -0.0070342873223125935, -0.020033132284879684, 0.028866510838270187, 0.01982242614030838, 0.01396322250366211, 0.011685993522405624, -0.03162187710404396, -0.03037385828793049, -0.00851732213050127, 0.015170721337199211, -0.013525605201721191, -0.03432861715555191, -0.031184259802103043, 0.024182388558983803, -7.749466749373823e-05, 0.017310181632637978, -0.014303591102361679, -0.0032821272034198046, -0.006612878292798996, 0.031832579523324966, -0.014619647525250912, 0.014214446768164635, -0.0019145741825923324, 0.006381914019584656, -0.002915420336648822, -0.01336352527141571, 0.028947550803422928, 0.0052595073357224464, 0.025073830038309097, 0.02014658786356449, -0.029498623684048653, 0.015981122851371765, 0.013160924427211285, 0.014028054662048817, -0.03131392225623131, 0.004647654015570879, -0.016143202781677246, -0.03037385828793049, 0.04732746258378029, 0.010138126090168953, 0.0004117853823117912, -0.02834785357117653, -0.01196963433176279, -0.0003211217117495835, -0.004979918710887432, 0.0071517955511808395, 0.025916649028658867, 0.01872028037905693, -0.004274869337677956, -0.01915789768099785, 0.009603261016309261, -0.0026297536678612232, 0.018849944695830345, -0.012220858596265316, 0.008160745725035667, -0.007471904158592224, -0.026613593101501465, 0.0009957811562344432, -0.032934729009866714, 0.010235373862087727, -0.017845047637820244, 0.0041310228407382965, -0.012334315106272697, 0.011564433574676514, 0.013039364479482174, 0.02698637917637825, -0.024992790073156357, -0.024344468489289284, 0.004465313628315926, 0.029741745442152023, 0.005583668127655983, 0.004716538358479738, 0.030049696564674377, 0.02343681827187538, -0.050471819937229156, -0.01930377073585987, 0.018315080553293228, -0.0007729206699877977, -0.028607182204723358, 0.0038413044530898333, -0.023971684277057648, -0.004546354059129953, 0.007860897108912468, -0.005851100664585829, 0.01607026718556881, 0.004574717953801155, -0.015308489091694355, 0.014652064070105553, -0.0015529324300587177, 0.006325185764580965, -0.023209907114505768, -0.00026971183251589537, 0.009506012313067913, 0.003093708772212267, -0.012796243652701378, -0.031589459627866745, 0.00944928452372551, 0.0021171746775507927, 0.04502592235803604, 0.009643780998885632, -0.01821783185005188, -0.030681811273097992, 0.02875305525958538, -0.007994613610208035, 0.03449069708585739, 0.0327078141272068, -0.034361034631729126, -0.009846381843090057, 0.01661323569715023, -0.012188442051410675, 0.012463979423046112, -0.003039006609469652, 0.005081219132989645, 0.0238744355738163, -0.006580462213605642, -0.013533709570765495, 0.027861611917614937, -0.019125482067465782, 0.0036224958021193743, 0.006171209271997213, 0.014562919735908508, 0.012593643739819527, -0.008655090816318989, 0.014514295384287834, 0.03173533454537392, 0.009392556734383106, 0.023064034059643745, 0.00579842459410429, 0.024522757157683372, 0.014449463225901127, 0.065804623067379, 0.05825167894363403, 0.016240451484918594, 0.013485085219144821, -0.006681762635707855, 0.0075610484927892685, -0.0067222826182842255, -0.007354395929723978, -0.030130736529827118, 0.019125482067465782, 0.0020948885940015316, 0.0026540658436715603, 0.009895005263388157, 0.02285332977771759, 0.03666257485747337, 0.026678426191210747, 0.02311265841126442, -0.002542635425925255, -0.005445899907499552, 0.0012186416424810886, 0.00393247464671731, -0.014489983208477497, 0.0201627966016531, -0.008614570833742619, 0.020519372075796127, 0.03536593168973923, -0.009335828013718128, 0.010794551111757755, 0.013104196637868881, -0.010851279832422733, 0.016499780118465424, 0.02539799176156521, 0.0495641715824604, 0.01438463106751442, -0.006548046134412289, -0.004765162244439125, -0.0056647080928087234, 0.04064975306391716, 0.0012946168426424265, -0.00914943590760231, 0.005563408136367798, 0.020292460918426514, 0.017764005810022354, 0.0026439358480274677, -0.016629444435238838, 0.007767701055854559, 0.04064975306391716, -0.02403651550412178, -0.01185617782175541, -0.0048745665699243546, 0.03928827866911888, -0.00685194693505764, 0.012285690754652023, -0.02429584413766861, 0.005028543062508106, -0.025576280429959297, 0.011313208378851414, -0.013541813008487225, -0.0038960063830018044, 0.017601925879716873, 0.008687506429851055, -0.009878797456622124, -0.053421683609485626, -0.013955118134617805, 0.035884588956832886, 0.023842019960284233, 0.005530992057174444, -0.021702559664845467, -0.015446257777512074, -0.016921188682317734, -0.012139818631112576, -0.0055917720310389996, 0.017391221597790718, -0.01159684918820858, 0.011815657839179039, -0.007269303780049086, 0.00786494929343462, 0.007374655921012163, -0.01273141149431467, -0.013549917377531528, -0.003620469942688942, 0.02919067069888115, 0.0403255932033062, -0.0019317951519042253, 0.010097606107592583, -0.005445899907499552, 0.004688173998147249, 0.015089680440723896, 0.012164130806922913, -0.0024656474124640226, -0.031508419662714005, -0.019174106419086456, -0.00510147912427783, 0.03523626923561096, -0.028947550803422928, -0.015284176915884018, -0.035463180392980576, 0.018752695992588997, 0.016921188682317734, -0.020811116322875023, 0.04090908169746399, 0.00419788109138608, 0.04748954251408577, 0.03789438679814339, -0.019676554948091507, 0.007488112431019545, -0.007840637117624283, 0.005996973253786564, -0.022804705426096916, -0.0032172950450330973, 0.005348651669919491, -0.021443231031298637, 0.025657320395112038, 0.025705944746732712, -0.01789367012679577, -0.00047788379015401006, -0.008493010886013508, 0.04515558481216431, -0.03384237736463547, 0.011321312747895718, -0.04697088524699211, -0.02421480417251587, -0.003091682679951191, 0.021183902397751808, 0.015859562903642654, 0.026257017627358437, -0.019417226314544678, -0.02792644500732422, -0.04800819978117943, 0.04142773896455765, -0.010227270424365997, 0.0323026143014431, -0.0084281787276268, -0.004736798349767923, 0.004116841126233339, 0.0003094721760135144, 0.006082065403461456, 0.013087988831102848, 0.0030633185524493456, 0.032610565423965454, -0.015738002955913544, 0.0013209548778831959, 0.019790010526776314, 0.0025588434655219316, -0.015373321250081062, 0.027780571952462196, 0.031427379697561264, 0.042205724865198135, -0.014968120492994785, -0.021362191066145897, -0.01904444210231304, 0.024004099890589714, 0.028380269184708595, 0.0180557519197464, 0.01803954318165779, -0.006321133580058813, 0.026613593101501465, 0.013801141642034054, -0.03397204354405403, -0.010251582600176334, -0.0022144229151308537, 0.012156026437878609, 0.009424972347915173, 0.006799270864576101, 0.025689736008644104, -0.005741696339100599, 0.003170696785673499, -0.018655449151992798, -0.0033550632651895285, -0.016248555853962898, 0.002704715821892023, -0.023631315678358078, -0.0029539144597947598, 0.03139496594667435, 0.0004416689625941217, -0.027975069358944893, 0.017942294478416443, 0.017002228647470474, 0.011288896203041077, -0.03675982356071472, -0.006973507348448038, 0.004424793645739555, 0.008825275115668774, 0.021897055208683014, 0.04026075825095177, -0.014571024104952812, 0.009100811555981636, -0.02184843085706234, -0.0015235552564263344, 0.013355420902371407, -0.018444744870066643, 0.1207822784781456, -0.021637726575136185, -0.005733592435717583, 0.025365574285387993, -0.0026804038789123297, -0.006462953984737396, 0.00545805599540472, 0.020632829517126083, -0.0371164008975029, -0.013136612251400948, -0.016143202781677246, 0.004355909302830696, 0.017764005810022354, -0.008971147239208221, -0.007877104915678501, 0.02740778774023056, -0.017650550231337547, 0.021119069308042526, 0.021200109273195267, 0.030811475589871407, -3.653139356174506e-05, 0.014263071119785309, -0.015575922094285488, -0.0063089774921536446, 0.009554636664688587, 0.025511447340250015, -0.018266456201672554, 0.006592618301510811, 0.007828480564057827, 0.008031081408262253, -0.021459437906742096, -0.023582691326737404, 0.007338188122957945, 0.012666579335927963, 0.01273141149431467, 0.0081769535318017, -0.03659774363040924, -0.011580641381442547, -0.026500137522816658, 0.005267611239105463, -0.047684039920568466, 0.01020295824855566, 0.010940424166619778, 0.006292769685387611, -0.03011452965438366, -0.015608337707817554, 0.010778343304991722, -0.009635676629841328, -0.011669785715639591, -0.009659988805651665, 0.006394070107489824, -0.008484906516969204, -0.016986021772027016, -0.02337198704481125, -0.0017170386854559183, -0.01839612051844597, -0.0027330799493938684, 0.035722509026527405, 0.027780571952462196, 0.0024636213202029467, -0.04664672538638115, -0.027132250368595123, -0.016986021772027016, 0.019255146384239197, -0.013517501763999462, -0.02546282298862934, -0.01661323569715023, 0.02826681360602379, -0.013874078169465065, 0.0123910428956151, 0.017861254513263702, -0.028218189254403114, -0.009335828013718128, -0.006612878292798996, -0.019271353259682655, -0.007840637117624283, -0.01931997761130333, 0.01434411108493805, 0.007451644167304039, 0.05740886181592941, 0.022399503737688065, -0.011791345663368702, -0.01586766727268696, -0.02066524513065815, 0.002603415632620454, -0.0286882221698761, 0.01747226156294346, 0.006665554363280535, 0.00042115565156564116, -0.016402531415224075, -0.002021952299401164, 0.008314722217619419, -0.0018618979956954718, -0.010535222478210926, -0.01476551964879036, -0.0007091015577316284, -0.0001725902548059821, -0.022561585530638695, 0.014935704879462719, 0.022658832371234894, 0.03162187710404396, 0.005044750869274139, 0.011499601416289806, 0.0027553660329431295, -0.05270852893590927, -0.014822248369455338, -0.03795921802520752, -0.034198954701423645, -0.008687506429851055, 0.019255146384239197, 0.006483213976025581, -0.0009633650770410895, 0.026872921735048294, 0.001848728978075087, 0.006706074345856905, 0.00777985667809844, -0.005158207379281521, 0.03316164016723633, 0.033518217504024506, -0.055269401520490646, 0.03958002105355263, 0.0019510422134771943, 0.01855820044875145, -0.03358304873108864, 0.006819530855864286, 0.005308131687343121, -0.014514295384287834, 0.04207605868577957, -0.025187287479639053, -0.019854843616485596, 0.008922523818910122, 0.016969813033938408, 0.013760621659457684, 0.006592618301510811, 0.0253817830234766, 0.0039020844269543886, 0.0012925907503813505, -0.021637726575136185, -0.011442872695624828, 0.01442515105009079, 0.006272509694099426, 0.041524987667798996, 0.003810914233326912, -0.010235373862087727, 0.01837991178035736, 0.024668630212545395, -0.0045382496900856495, -0.014157718978822231, -0.014668271876871586, -0.009311515837907791, -0.008752338588237762, -0.0007298680720850825, -0.012431562878191471, 0.0165565088391304, -0.0331130176782608, -0.017764005810022354, 0.009441180154681206, -0.019708970561623573, -0.002722949953749776, 0.008010821416974068, 0.005146051291376352, 0.001244979677721858, 0.0055958242155611515, 0.01705085299909115, 0.01679152436554432, -0.01092421542853117, -0.008922523818910122, -0.0047813705168664455, 0.01122406404465437, -0.023825811222195625, 0.006199573632329702, -0.0029843044467270374, 0.008484906516969204, -0.003460415406152606, 0.010786447674036026, -0.012536915019154549, 0.006268457509577274, 0.02319369837641716, -0.023047825321555138, -0.01084317546337843, 0.016921188682317734, -0.015113992616534233, -0.016305282711982727, 0.027099834755063057, 0.0035698197316378355, 0.0021698507480323315, -0.030292818322777748, 0.009311515837907791, 0.01974138617515564, 0.0006792179774492979, 0.030065905302762985, -0.01938481070101261, -0.0026297536678612232, -0.03497694060206413, 0.017650550231337547, 0.0201627966016531, -0.01555971335619688, 0.019546890631318092, 0.007301719859242439, -0.0021273046731948853, 0.04058492183685303, -0.03983934968709946, -0.013047467917203903, -0.021021822467446327, 0.0274888277053833, 0.003816992277279496, -0.00244741328060627, 0.02150806225836277, 0.018201623111963272, -0.014279278926551342, 0.025090038776397705, 0.007735284976661205, -0.0012297846842557192, 0.0011771086137741804, 0.006082065403461456, 0.014028054662048817, 0.005389171652495861, 0.006025337148457766, -0.002431205241009593, 0.007099119480699301, -0.024733461439609528, 0.009352036751806736, 0.04544733092188835, -0.023469235748052597, -0.008882002905011177, 0.013177132233977318, 0.0009329750319011509, -0.015494881197810173, -0.0040641650557518005, -0.022756081074476242, 0.015802834182977676, -0.0168563574552536, -0.005425639916211367, -0.01505726482719183, 0.01024347823113203, -0.013379733078181744, -0.025786984711885452, -0.00495155481621623, -5.261280239210464e-05, -0.013695789501070976, -0.013987534679472446, 0.010316414758563042, 0.0009881836595013738, 0.01252881158143282, -0.011580641381442547, 0.016759108752012253, 0.004493677988648415, 0.01290970016270876, -0.03685707226395607, 0.04953175410628319, 0.02371235564351082, 0.021734975278377533, 0.015778522938489914, -0.02925550378859043, 0.026273224502801895, 0.005133895203471184, 0.020260043442249298, -0.03162187710404396, 0.015924394130706787, -0.029871409758925438, -0.0329023115336895, 0.021945679560303688, 0.03374512866139412, -0.020454540848731995, 0.009943629615008831, -0.0084281787276268, 0.0048745665699243546, 0.02142702229321003, -0.006985662970691919, 0.008914419449865818, -0.004287025425583124, 0.010948527604341507, 0.0157461054623127, -0.019449641928076744, 0.03061697818338871, 0.04729504510760307, -0.017310181632637978, -0.007018079049885273, 0.007168003357946873, -0.016524091362953186, -0.0028728742618113756, 0.010616263374686241, 0.021054238080978394, -0.006693918723613024, 0.0022265787702053785, 0.05805718153715134, -0.021572895348072052, 0.010259686037898064, 0.018623031675815582, 0.003128150710836053, 0.01671048440039158, -0.013209548778831959, 0.015738002955913544, -0.01231000293046236, -0.005737644620239735, -0.0032942830584943295, -0.013849765993654728, -0.022869538515806198, 0.012002049945294857, 0.037246063351631165, -0.008784755133092403, 0.011126816272735596, -0.03507418930530548, -0.008784755133092403, 0.007528632413595915, 0.012828660197556019, 0.00013282991130836308, 0.020389707759022713, 0.007423280272632837, -0.008306617848575115, -0.006134741473942995, -0.012123609893023968, -0.033258888870477676, 0.015130200423300266, -0.003565767779946327, -0.03113563545048237, 0.004380221478641033, 0.015081577003002167, 0.005360807757824659, 0.027796780690550804, -0.0190606489777565, -0.006325185764580965, -0.013630957342684269, -0.012455875054001808, 0.01769917458295822, -0.03442586585879326, -0.0012672657612711191, 0.01693739742040634, -0.012682787142693996, -0.03604666888713837, 0.018347496166825294, -0.022756081074476242, 0.038153715431690216, 0.002491985447704792, 0.03594942390918732, -0.003997306805104017, -0.011888593435287476, 0.009578948840498924, 0.033939626067876816, -0.03387479484081268, -0.030244193971157074, -0.02816956490278244, -0.0190606489777565, -0.017229141667485237, -0.00491103483363986, 0.02885030210018158, -0.01133752055466175, -0.0529678575694561, 0.0023400350473821163, -0.017828838899731636, 0.0007952067535370588, -0.0168563574552536, -0.004258661065250635, 0.0046354979276657104, 0.03223778307437897, 0.008371450006961823, 0.02995244972407818, 0.018768904730677605, -0.02202671952545643, -0.004001358523964882, 0.005697124172002077, -0.036727406084537506, 0.034912109375, 0.0036690940614789724, 0.008104017935693264, -0.010316414758563042, -0.012707099318504333, -0.030341442674398422, -0.007321979850530624, -0.016969813033938408, 0.007925729267299175, 0.057895101606845856, 0.019076857715845108, 0.021151486784219742, -0.005968608893454075, -0.009376347996294498, -0.04048767313361168, -0.008493010886013508, -0.007690712809562683, -0.0019328081980347633, 0.018752695992588997, -0.038413044065237045, -0.013160924427211285, -0.013566125184297562, 0.022334672510623932, 0.014887080527842045, -0.007143691647797823, -0.002240760950371623, 0.02995244972407818]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"adsLayer 11
0.00.20.40.60.81.0 (xii) Layer 11
Figure 15. Activations for OPT-66B
13
Runtime Clustered Head Attention for Efficient Inference
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 12
0.00.20.40.60.81.0
(xiii) Layer 12
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 13
0.00.20.40.60.81.0 (xiv) Layer 13
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 14
0.00.20.40.60.81.0 (xv) Layer 14
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 15
0.00.20.40.60.81.0
(xvi) Layer 15
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 16
0.00.20.40.60.81.0 (xvii) Layer 16
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 17
0.00.20.40.60.81.0 (xviii) Layer 17
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 18
0.00.20.40.60.81.0
(xix) Layer 18
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 19
0.00.20.40.60.81.0 (xx) Layer 19
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 20
0.00.20.40.60.81.0 (xxi) Layer 20
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 21
0.00.20.40.60.81.0
(xxii) Layer 21
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 22
0.00.20.40.60.81.0 (xxiii) Layer 22
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
","[0.013001630082726479, 0.013048738241195679, 0.049525532871484756, -0.007753085810691118, 0.03148341551423073, -0.001284656929783523, 0.029803253710269928, -0.026961110532283783, -0.021873515099287033, -0.012985927984118462, 0.031891681253910065, -0.007890482433140278, -0.012797498144209385, -0.0029697262216359377, 0.020334675908088684, -0.017775176092982292, 0.040198277682065964, -0.017304101958870888, -0.02444871887564659, 0.06083130091428757, -0.029913172125816345, -0.013205762021243572, -0.014085100032389164, 0.022705746814608574, 0.003138527739793062, -0.0077295321971178055, 0.01827765442430973, -0.008385109715163708, 0.06770897656679153, -0.015749558806419373, 0.011721880175173283, -0.05147263780236244, -0.023632191121578217, -0.02890821546316147, -0.03473382443189621, 0.006677467841655016, -0.00859709270298481, 0.02722805179655552, -0.03266109898686409, -0.002771482802927494, 0.051692474633455276, -0.06108253821730614, -0.03156192973256111, -0.0057039158418774605, 0.02727515995502472, -0.023726405575871468, -0.03507927805185318, -0.02214045822620392, 0.026411524042487144, 0.05257181078195572, -0.028280116617679596, 0.007831597700715065, -0.033477626740932465, 0.045285873115062714, -0.03690076246857643, 0.03187597915530205, 0.022705746814608574, 0.033477626740932465, 0.06883955001831055, -0.01326072122901678, 0.04110902175307274, 0.009272297844290733, 0.03376027196645737, -0.025280948728322983, 0.028672678396105766, -0.001141372020356357, -0.07198004424571991, -0.0053506107069551945, 0.029756147414445877, 0.006850194651633501, -0.019188396632671356, 0.07292218506336212, 0.011078080162405968, 0.008180977776646614, 0.008612794801592827, 0.03975860774517059, -0.018104927614331245, 0.022014837712049484, 0.018167737871408463, -0.034168537706136703, 0.01469749491661787, 0.014053694903850555, 0.06296683102846146, -0.028075983747839928, 0.030117303133010864, -0.03875365108251572, -0.053576767444610596, -0.014885924756526947, -0.061742041260004044, -0.02934788353741169, -0.021747896447777748, 0.005923750344663858, -0.017461126670241356, -0.010497089475393295, 0.0019981369841843843, -0.0407949723303318, 0.020727237686514854, -0.009523537009954453, 0.004742140416055918, -0.016393359750509262, 0.036241259425878525, -0.004361356142908335, 0.011753285303711891, 0.007513623218983412, -0.005001231096684933, -0.020570212975144386, -0.010457833297550678, -0.004184703342616558, -0.04786107316613197, -0.002661565551534295, -0.0642230287194252, 0.010991716757416725, -0.013127249665558338, 0.024762766435742378, 0.027165241539478302, -0.03561316058039665, -0.02214045822620392, -0.004793173633515835, -0.013559067621827126, -0.02612888067960739, -0.03859662637114525, -0.037623073905706406, 0.017822284251451492, 0.010968162678182125, -0.01275039091706276, -0.05294866859912872, 0.04164290428161621, -0.03825117275118828, -0.05571230128407478, -0.0336974635720253, 0.044343724846839905, 0.029803253710269928, 0.045631326735019684, -0.04183133319020271, -0.017775176092982292, 0.03517349436879158, 0.004663628526031971, 0.08962959796190262, -0.03759166970849037, -0.024919791147112846, -0.004141521640121937, -0.027777638286352158, 0.02672557346522808, 0.03897348791360855, -0.008149572648108006, 0.06161642447113991, -0.05075032636523247, 0.04459496587514877, -0.04267926514148712, 0.045913971960544586, -0.012067334726452827, -0.0020118767861276865, -0.03171895444393158, -0.009397917427122593, -0.019109884276986122, -0.054047841578722, 0.0021473104134202003, 0.041925545781850815, 0.011195848695933819, 0.03467101603746414, 0.002371070208027959, -0.009492132812738419, 0.037026382982730865, 0.007505772169679403, -0.011604112572968006, 0.049525532871484756, 0.005099371541291475, 0.0074154832400381565, -0.09088579565286636, -0.04930569976568222, 0.010764030739665031, -0.0015584684442728758, -0.05075032636523247, 0.0010216408409178257, -0.009908247739076614, 0.019628064706921577, -0.003507535206153989, 0.010395023040473461, -0.02396194264292717, 0.00788263138383627, 0.024118967354297638, 0.03878505527973175, -0.01277394499629736, 0.035895805805921555, -0.06378336250782013, -0.01744542457163334, 0.0022925580851733685, -0.00590412225574255, 0.014022289775311947, -0.010654114186763763, -0.005044412799179554, 0.017508234828710556, 0.05084453895688057, 0.025422269478440285, -0.009476429782807827, -0.0605800598859787, 0.04456355795264244, -0.03749745711684227, 0.0022925580851733685, -0.003234705189242959, 0.0036802622489631176, -0.0041375961154699326, 0.04939991608262062, -0.026898300275206566, 0.015780964866280556, -0.0023946240544319153, -0.014406999573111534, -0.026662763208150864, 0.018984265625476837, -0.012687581591308117, 0.05982634425163269, -0.05992055684328079, 0.006453707814216614, -0.009609900414943695, -0.03542473167181015, 0.019156992435455322, -0.04481479898095131, -0.0167074091732502, -0.0029952428303658962, -0.0007708922494202852, 0.0020687980577349663, 0.062275927513837814, 0.03913051262497902, 0.01896856166422367, -0.026914002373814583, 0.054361891001462936, 0.035990022122859955, -0.032975148409605026, -0.0033230313565582037, -0.03514208644628525, 0.030447054654359818, -0.0030757179483771324, 0.01193386409431696, -0.03492225334048271, -0.005327057093381882, -0.050593301653862, -0.002873548772186041, -0.004432016983628273, -0.001744935056194663, -0.02568921260535717, 0.002867660252377391, 0.030792508274316788, -0.01141568273305893, 0.04230240732431412, -0.005044412799179554, -0.023569380864501, 0.0033917296677827835, -0.03897348791360855, -0.002806813456118107, -0.02080575004220009, 0.019989222288131714, 0.006528294645249844, -0.03869084268808365, -0.012554110959172249, -0.06620153784751892, 0.014414851553738117, 0.026756979525089264, -0.004169001244008541, -0.017366912215948105, 0.03799993544816971, -0.005185734946280718, -0.02306690253317356, -0.03997844457626343, 0.013417745009064674, -0.0370577871799469, -0.0186702162027359, 0.018261952325701714, 0.025563592091202736, -0.025375163182616234, -0.06890235841274261, 0.009664859622716904, 5.048859748058021e-06, 0.04833214730024338, 0.00674420315772295, -0.035456135869026184, -0.03300655633211136, 0.004522306378930807, 0.0044634221121668816, -0.057031307369470596, 0.0026399747002869844, -0.011125187389552593, 0.022988390177488327, 0.04490901529788971, 0.030258625745773315, -0.0339801050722599, -0.014611131511628628, -0.007168169599026442, 0.004208257421851158, -0.021323930472135544, -0.03975860774517059, 0.023836322128772736, -0.05188090354204178, 0.03423134610056877, -0.006885525304824114, -0.018309058621525764, 0.010724774561822414, 0.02382062003016472, -0.010630560107529163, -0.0002693951828405261, 0.011611963622272015, 0.04525446891784668, 0.0184346791356802, 0.016613194718956947, -0.019926412031054497, -0.006661765277385712, 0.04170571267604828, 0.012742539867758751, 0.02619169093668461, 0.03284953162074089, -0.037277620285749435, -0.017995011061429977, -0.0015447287587448955, 0.01457187533378601, -0.023899132385849953, -0.04930569976568222, -0.025296650826931, 0.047892481088638306, 0.008283043280243874, 0.004082637373358011, 0.011918161064386368, -0.007003293838351965, -0.020366080105304718, -0.004432016983628273, 0.010834692046046257, 0.021967731416225433, 0.02198343351483345, -0.013064440339803696, -0.004675405099987984, 0.04104620963335037, -0.05027925223112106, -0.01509790774434805, -0.010661965236067772, -0.014461958780884743, -0.0022925580851733685, 0.011282212100923061, -0.025469377636909485, -0.05549246817827225, 0.015898732468485832, 0.011211550794541836, 0.004773545544594526, -0.05643461272120476, -0.00755680538713932, -0.026804085820913315, -0.003945241216570139, -0.032629694789648056, 0.004231811035424471, 0.013723943382501602, -0.0126247713342309, 0.0744924321770668, 0.0028323298320174217, -0.04352719709277153, -0.0031718953978270292, -0.008165274746716022, -0.0030030941125005484, -0.05973212793469429, 0.0046832566149532795, 0.059857748448848724, -0.05241478607058525, -0.05206933245062828, 0.031891681253910065, -0.05841312184929848, 0.017178483307361603, 0.033823080360889435, 0.0031503045465797186, 0.027934662997722626, 0.025312352925539017, -0.03247267007827759, 0.04183133319020271, 0.0030384245328605175, -0.007058252114802599, 0.02479417249560356, -0.007258458528667688, -0.008950397372245789, -0.03674373775720596, -0.056497424840927124, -0.01239708624780178, -0.010905353352427483, 0.011800392530858517, 0.031844574958086014, 0.03281812369823456, -0.01424997579306364, 0.0031738581601530313, 0.022642936557531357, 0.009570644237101078, 0.048740413039922714, -0.055806513875722885, -0.03162473812699318, 0.014752454124391079, -0.07097508758306503, -0.025359461084008217, 0.02075864188373089, 0.030321436002850533, 0.0008557836408726871, 0.011957417242228985, -0.009303702972829342, -0.008534282445907593, 0.04380984231829643, 0.07091227173805237, 0.023239629343152046, 0.022690042853355408, -0.0017586746253073215, 0.01728839986026287, -0.04930569976568222, 0.012734688818454742, -0.022360291332006454, 0.0033838783856481314, 0.011156592518091202, 0.014367743395268917, 0.017759473994374275, 0.025563592091202736, 0.020240461453795433, -0.010630560107529163, 0.012177251279354095, -0.04129745066165924, 0.0031071228440850973, 0.013723943382501602, 0.0340743213891983, 0.01991070993244648, -0.02000492438673973, 0.03872224688529968, -0.007046475540846586, -0.023679297417402267, 0.01069337036460638, 0.02232888713479042, -0.04129745066165924, 0.014752454124391079, 0.06494534015655518, -0.06359492987394333, 0.03501646965742111, -0.06770897656679153, -0.033132173120975494, 0.056497424840927124, 0.024181775748729706, 0.022109052166342735, -0.029457800090312958, -0.006355567369610071, 0.005786353722214699, 0.007874779403209686, 0.005170032382011414, 0.009154529310762882, 0.001885275705717504, 0.0003184653469361365, -0.0368693582713604, -0.041328854858875275, -0.06387757509946823, 0.03008589893579483, -0.04729578644037247, -0.03008589893579483, -0.0038883197121322155, 0.025673508644104004, -0.03284953162074089, -0.008769819512963295, -0.008628497831523418, 0.04139166325330734, -0.01640906184911728, -0.022171862423419952, 0.08171556144952774, 0.01044998224824667, 0.033320602029561996, -0.029614824801683426, -0.005205363035202026, -0.030211517587304115, -0.024527231231331825, 0.013433448038995266, -0.047798264771699905, 0.04462637007236481, -0.035895805805921555, -0.015294188633561134, 0.04811231419444084, 0.038659438490867615, -0.01472104899585247, -0.006308460142463446, 0.011926012113690376, -0.046259425580501556, -0.022642936557531357, -0.002657640026882291, 0.05791064351797104, -0.019596660509705544, 0.02919085882604122, -0.07983126491308212, -0.029881766065955162, 0.011195848695933819, -0.003338733920827508, 0.01422642171382904, 0.059857748448848724, 0.07135194540023804, 0.04104620963335037, 0.02386772818863392, -0.008926844224333763, 0.019675172865390778, -0.035801589488983154, -0.0008842443348839879, 0.07022136449813843, -0.020978476852178574, -0.0016958648338913918, 0.020099138841032982, -0.022799961268901825, -0.054267674684524536, -0.02371070347726345, -0.04035530239343643, 0.026050368323922157, 0.03583299741148949, 0.06215030699968338, -0.005315280053764582, 0.04877181723713875, 0.021512359380722046, 0.016189228743314743, 0.04402967542409897, -0.03284953162074089, -0.0064380052499473095, 0.0007600968237966299, 0.033069364726543427, -0.013794604688882828, -0.007423334289342165, -0.0438726507127285, 0.026552846655249596, 0.02020905539393425, 0.01163551677018404, -0.01311939861625433, -0.007258458528667688, -0.015254932455718517, -0.016000797972083092, -0.045034632086753845, -0.01931401714682579, 0.006579327397048473, 0.006308460142463446, -0.008683456107974052, -0.06852550059556961, -0.0368693582713604, 0.01733550801873207, 0.01509790774434805, -0.047798264771699905, 0.0036017498932778835, 0.012766093946993351, -0.035895805805921555, 0.03363465145230293, 0.03126358240842819, -0.018984265625476837, -0.05470734462141991, 0.010803286917507648, 0.005224991124123335, 0.03683795407414436, 0.001210070215165615, 0.003788216505199671, 0.0027165242936462164, -0.010756179690361023, 0.01338634081184864, 0.0002129645145032555, 0.0001664705341681838, 0.012734688818454742, 0.0100574204698205, -0.005656808614730835, 0.0504048727452755, 0.008848331868648529, -0.02382062003016472, -0.0026929706800729036, -0.018356166779994965, -0.0009868009947240353, 0.00761961517855525, -0.004561562556773424, 0.03501646965742111, -0.022768555209040642, 0.02110409550368786, -0.009916098788380623, -0.003725406713783741, 0.037434644997119904, -0.0011825909605249763, -0.022046243771910667, 0.011839648708701134, 0.010371469892561436, -0.038313984870910645, -0.023977644741535187, -0.005224991124123335, -0.012161549180746078, 0.0025791276711970568, 0.004942346829921007, 0.02094707079231739, 0.03567597270011902, 0.00033343175891786814, -0.017806580290198326, -0.03008589893579483, -0.003764662891626358, -0.030965235084295273, -0.01788509264588356, -0.032629694789648056, 0.011855351738631725, -0.0063163116574287415, 0.008063209243118763, -0.0503106564283371, 0.018733026459813118, 0.034168537706136703, 0.010489238426089287, 0.01361402589827776, 0.025814831256866455, 0.010065271519124508, -0.005986560136079788, 0.026866896077990532, -0.027133837342262268, 0.023145414888858795, 0.023082604631781578, -0.006826641038060188, 0.01634625345468521, -0.037811506539583206, 0.0044241659343242645, -0.0011207625502720475, -0.00894254632294178, -0.028201604261994362, 0.010457833297550678, 0.024527231231331825, 0.02301979437470436, 0.0024770619347691536, -0.009083868935704231, 0.014681792818009853, -0.013001630082726479, -0.027008218690752983, 0.04594537615776062, -0.019329719245433807, -0.008149572648108006, 0.030211517587304115, -0.006854120641946793, -0.009256595745682716, 0.0014593466185033321, 0.00768242496997118, 0.02672557346522808, 0.01420286763459444, 0.03938174992799759, 0.010010313242673874, -0.03498506546020508, -0.022218970581889153, -0.015647493302822113, -0.05222635716199875, -0.013504109345376492, 0.04798669368028641, 0.013095845468342304, -0.025971855968236923, 0.00044089541188441217, -0.031185070052742958, 0.006536145694553852, 0.027306564152240753, -0.04958834499120712, -0.005374164320528507, -0.0006491982494480908, 0.005315280053764582, -0.05118999257683754, 0.045819755643606186, 0.03501646965742111, -0.00037097043241374195, 0.004526231903582811, -0.05238338187336922, -0.04277348145842552, 0.019156992435455322, -0.03975860774517059, 0.017162781208753586, 0.022737151011824608, 0.002443694043904543, -0.05153544992208481, -0.020067734643816948, 0.011054526083171368, -0.007847300730645657, -0.020727237686514854, -0.02638011984527111, 0.015875179320573807, -0.018152033910155296, -0.021810706704854965, 0.02115120366215706, 0.005860940087586641, 0.02345946431159973, 0.0005014970665797591, 0.018340464681386948, -0.011918161064386368, -0.04534868150949478, 0.047452811151742935, 0.03438837081193924, 0.03303796052932739, 0.034513991326093674, -0.03072969987988472, -0.01373179443180561, 0.0064890384674072266, -0.03052556701004505, 0.00010169791494263336, 0.015945840626955032, 0.021402442827820778, -0.038219768553972244, -0.0035330518148839474, 0.004514454863965511, 0.0034643535036593676, 0.029614824801683426, -0.028248712420463562, -0.002600718755275011, -0.01580451801419258, 0.013708241283893585, -0.004428091458976269, 0.027777638286352158, -0.0083772586658597, 0.0078080445528030396, 0.022784259170293808, -0.010135932825505733, 0.023899132385849953, -0.02974044531583786, -0.029803253710269928, -0.026066070422530174, 0.013951628468930721, -0.035204898566007614, 0.019392527639865875, -0.040637947618961334, -0.041234638541936874, -0.006889450829476118, 0.03617845103144646, 0.039947040379047394, -0.036680929362773895, -0.016817325726151466, -0.004117968026548624, -0.02479417249560356, 0.0016850694082677364, 0.01191031001508236, 0.022658638656139374, 0.012412788346409798, -0.011337170377373695, -0.00033858412643894553, -0.033917296677827835, -0.01275039091706276, 0.03225283697247505, 0.00044948270078748465, 0.0005039505776949227, 0.02554788999259472, 0.01118799764662981, -0.039852824062108994, -0.0038255099207162857, -0.004361356142908335, 0.016471872106194496, -0.005201437510550022, 0.06488253176212311, 0.0029658006969839334, 0.035801589488983154, 0.0075096976943314075, 0.02860986813902855, -0.02722805179655552, 0.028248712420463562, -0.018717322498559952, -0.03768588602542877, 0.010269403457641602, -0.06953045725822449, -0.019047074019908905, -0.013802455738186836, 0.030462756752967834, 0.060203202068805695, 0.018811536952853203, 0.00527209835126996, -0.035990022122859955, -0.04007265716791153, -0.00971196684986353, 0.015568981878459454, -0.0012277355417609215, -0.02534375712275505, 0.020381782203912735, 0.025296650826931, 0.03441977500915527, -0.03335200995206833, 0.031797464936971664, -0.0010883762734010816, 0.01793220080435276, 0.004663628526031971, -0.015883030369877815, -0.020538806915283203, 0.001630110782571137, -0.03507927805185318, -0.05005941912531853, -0.010834692046046257, 0.02653714455664158, 0.02856275998055935, -0.020978476852178574, 2.8292015485931188e-05, 0.018214844167232513, -0.0006123956409282982, 0.030447054654359818, -0.007898333482444286, 0.0405123271048069, -0.03828257694840431, -0.016613194718956947, -0.024244586005806923, -0.02934788353741169, -0.008487175218760967, -0.010928906500339508, -0.005464453250169754, -0.017366912215948105, -0.0032150771003216505, 0.00496590044349432, -0.02159087173640728, 0.009280148893594742, -0.04311893507838249, -0.010402875021100044, -0.009547091089189053, -0.006473335903137922, -0.032535482197999954, 0.005735320504754782, 0.006987591274082661, 0.0016153898322954774, -0.12241631746292114, -0.009005356580018997, 0.026223095133900642, -0.003843175247311592, -0.016142120584845543, -0.01299377903342247, 0.013519811443984509, 0.05213214084506035, 0.04016687348484993, -0.013920224271714687, 0.013990884646773338, -0.006626435089856386, -0.012145847082138062, -0.002194417640566826, 0.01684873178601265, -0.018309058621525764, 0.015082205645740032, 0.010316510684788227, 0.004204331431537867, -0.032786719501018524, -0.033666059374809265, -0.007949366234242916, 0.02747929096221924, 0.04104620963335037, -0.01970657706260681, -0.020680129528045654, -0.012122293002903461, -0.02075864188373089, 0.02895532175898552, -0.008911142125725746, -0.013519811443984509, 0.04267926514148712, -0.00767064793035388, 0.042459432035684586, 0.014391297474503517, -0.015600386075675488, -0.036932166665792465, -0.011274361051619053, 0.005366313271224499, -0.011690475977957249, -0.02667846716940403, -0.02391483448445797, 0.02617598883807659, 0.0036410060711205006, 0.00906816590577364, 0.005613626912236214, 0.004753917455673218, -0.00596693204715848, 0.01484666857868433, -0.011392129585146904, 0.0168958380818367, -0.006834492553025484, 0.009649156592786312, -0.004922718740999699, 0.0091937854886055, 0.02835862897336483, 0.0026439004577696323, 0.013292125426232815, 0.024919791147112846, -0.026411524042487144, 0.03160903602838516, 0.02683549001812935, 0.021952027454972267, -0.033666059374809265, 0.0020089324098080397, -0.009445024654269218, -0.021622275933623314, 0.053639575839042664, 0.0067363521084189415, 0.003994311206042767, -0.03526770696043968, -0.011172294616699219, -0.006065072026103735, 0.0064223031513392925, 0.012452044524252415, 0.03134209290146828, 0.017021458595991135, -0.0023965868167579174, -0.015529725700616837, 0.013433448038995266, 0.020428890362381935, 0.023192521184682846, -0.01887434720993042, -0.001708623138256371, -0.000994161469861865, -0.024040454998612404, -0.00028043598285876215, -0.03413712978363037, 0.009641305543482304, -0.0006251538870856166, 0.029677635058760643, -0.006320237182080746, 0.01400658767670393, 0.014658238738775253, 0.024919791147112846, -0.022894175723195076, -0.0038156958762556314, 0.008549985475838184, 0.03913051262497902, -0.01116444356739521, 0.021025583148002625, 0.0014279417227953672, 0.009146678261458874, -0.043684221804142, -0.015788815915584564, 0.006610732525587082, 0.006854120641946793, -0.0218892190605402, -0.0046440004371106625, -0.02317681908607483, -0.00504048727452755, 0.004530157428234816, -0.00019861148030031472, 0.024197479709982872, 0.005005156621336937, -0.017775176092982292, 0.022909877821803093, -0.005550816655158997, 0.006979740224778652, -0.018591703847050667, -0.004172926768660545, -0.00442024040967226, 0.007372301537543535, 0.003379952860996127, -0.044343724846839905, -0.0012964337365701795, 0.015050800517201424, 0.019580958411097527, -0.006147509906440973, -0.0015457101399078965, -0.029771849513053894, 0.025610700249671936, -0.008934695273637772, 0.027542101219296455, 0.017068564891815186, -0.025924747809767723, 0.003507535206153989, 0.015042949467897415, -0.01620493084192276, 0.02771482802927494, 0.0011610001092776656, -0.00069041718961671, 0.02218756452202797, 0.006952260620892048, -0.011156592518091202, 0.03448258340358734, -0.006642137188464403, -0.018654514104127884, 0.007647094316780567, 0.02513962611556053, 0.014242123812437057, -0.01079543586820364, 0.0008695232681930065, 0.03376027196645737, 0.018717322498559952, 0.03325779363512993, 0.004659702535718679, 0.019047074019908905, 0.020444592460989952, 0.06877674162387848, 0.042867694050073624, 0.013566918671131134, 0.009625603444874287, 0.011596260592341423, 0.021512359380722046, -0.003491832874715328, -0.0201619490981102, -0.02469995804131031, 0.008534282445907593, -0.0033210685942322016, -0.013480555266141891, 0.025814831256866455, 0.01937682554125786, 0.030745401978492737, 0.018890049308538437, 0.04126604273915291, 0.003060015384107828, -0.003635117784142494, 0.00970411580055952, 0.010261552408337593, -0.005915898829698563, 0.023647893220186234, -0.014085100032389164, 0.03195448964834213, 0.037026382982730865, 0.0039648693054914474, 0.011345021426677704, 0.020287567749619484, -0.011823946610093117, 0.011643368750810623, 0.029724741354584694, 0.04870900511741638, 0.004569413606077433, -0.009821884334087372, -0.0038255099207162857, -0.012907415628433228, 0.05118999257683754, -0.0024358429946005344, -0.008023953065276146, 0.0020766493398696184, 0.030619781464338303, 0.02642722800374031, 0.0033289198763668537, -0.013095845468342304, -0.0020432816818356514, 0.03818836435675621, -0.030007386580109596, -0.02598755806684494, -0.012067334726452827, 0.03853381797671318, -0.010599154978990555, 0.02124541811645031, -0.040229681879282, -0.00020253709226381034, -0.03058837726712227, 0.023883430287241936, -0.009170232340693474, -0.0235222727060318, 0.01995781622827053, 0.002596792997792363, -0.02133963257074356, -0.04362141340970993, -0.026301607489585876, 0.04585115984082222, 0.012664027512073517, 0.01081898994743824, -0.013527662493288517, -0.022564424201846123, -0.030478460714221, -0.007819821126759052, 0.012538407929241657, 0.02336524985730648, -0.010292957536876202, 0.015498320572078228, -0.015176420100033283, 0.007380152586847544, 0.014037991873919964, -0.016613194718956947, -0.014658238738775253, 0.008416514843702316, 0.0336032472550869, 0.046510662883520126, -0.003762700129300356, 0.014257826842367649, -0.0007414501742459834, -0.003091420279815793, 0.029285073280334473, 0.00933510810136795, 0.013409893959760666, -0.01807352341711521, -0.018560297787189484, -6.250311707844958e-05, 0.030305732041597366, -0.030902426689863205, -0.030839616432785988, -0.02776193618774414, 0.01703716069459915, 0.013190059922635555, -0.012349979020655155, 0.030839616432785988, -0.00968056172132492, 0.05191230773925781, 0.027353672310709953, -0.024888386949896812, 0.016660301014780998, -0.0050915200263261795, -0.0009907266357913613, -0.027165241539478302, 0.002490801503881812, 0.009719817899167538, -0.012734688818454742, 0.024888386949896812, 0.019973520189523697, -0.01749253273010254, 0.004592967219650745, 0.004286769311875105, 0.038219768553972244, -0.02939498983323574, 0.023490868508815765, -0.047798264771699905, -0.029473502188920975, -0.010418577119708061, 0.0053780898451805115, 0.00039427875890396535, 0.008557836525142193, -0.0064105261117219925, -0.03642968833446503, -0.04613380506634712, 0.03448258340358734, -0.011949566192924976, 0.01804211735725403, 0.007109285332262516, -0.002376958727836609, -0.0016193153569474816, 0.00205702125094831, 0.008934695273637772, 0.02598755806684494, 0.010701221413910389, 0.03963299095630646, -0.024275992065668106, 0.013676836155354977, 0.00149173301178962, 0.011643368750810623, -0.006563624832779169, 0.019628064706921577, 0.04274207353591919, 0.016738813370466232, -0.02144954912364483, -0.020287567749619484, -0.019785089418292046, 0.010190891101956367, 0.035393327474594116, 0.0007807062938809395, 0.013135101646184921, -0.007698127068579197, 0.02623879723250866, 0.010764030739665031, -0.03642968833446503, -0.009531388990581036, 0.0002703765931073576, 0.009641305543482304, 0.007368375547230244, 0.00946072768419981, 0.013103696517646313, 0.0019451412372291088, 0.00619854312390089, -0.024040454998612404, -0.004663628526031971, -0.023161116987466812, -0.00820453092455864, -0.018199142068624496, 0.007093582767993212, 0.025061113759875298, -0.0016310922801494598, -0.018607405945658684, 0.012781796045601368, 0.016236335039138794, 0.02247020974755287, -0.03878505527973175, -0.01101526990532875, 0.012789647094905376, 0.003297514980658889, 0.006822715513408184, 0.037434644997119904, -0.009264446794986725, 0.003299477742984891, -0.028578463941812515, -0.003843175247311592, 0.01797930710017681, -0.011195848695933819, 0.11475352197885513, -0.029661932960152626, -0.015137163922190666, 0.0118082445114851, -8.783559314906597e-05, 0.011619814671576023, -0.012287168763577938, 0.015223527327179909, -0.037371836602687836, -0.013276423327624798, -0.019690874963998795, 0.016566086560487747, 0.010418577119708061, -0.018701620399951935, -0.00263016065582633, 0.029866063967347145, -0.004326025489717722, 0.022988390177488327, 0.008063209243118763, 0.022705746814608574, 0.004863834474235773, 0.01940823160111904, -0.020727237686514854, -0.007580359000712633, 0.01917269453406334, 0.029567718505859375, -0.011768988333642483, -0.009774776175618172, 0.008879736997187138, -0.0035252005327492952, -0.019329719245433807, -0.021402442827820778, 0.01600865088403225, 0.03029002994298935, 0.01227931771427393, 0.007972920313477516, -0.041925545781850815, -0.003900096518918872, -0.00576672563329339, 0.010677667334675789, -0.03429415449500084, 0.005276023875921965, 0.013441299088299274, 0.004687182139605284, -0.03843960165977478, -0.0071289134211838245, 0.003313217544928193, -0.02085285633802414, -0.009256595745682716, -0.006854120641946793, -0.021056989207863808, -0.0007213313947431743, -0.01299377903342247, -0.02301979437470436, -0.00909171998500824, -0.016613194718956947, -0.006241724826395512, 0.03909910470247269, 0.022046243771910667, -0.0009195748716592789, -0.04647925868630409, -0.030352840200066566, -0.01892145536839962, 0.031216474249958992, -0.01326857227832079, -0.029410693794488907, 0.0011030972236767411, 0.028390033170580864, -0.020099138841032982, 0.004989454057067633, 0.021371036767959595, -0.020538806915283203, -0.0046989587135612965, -0.021967731416225433, -0.011698327027261257, 0.0010265478631481528, -0.014297083020210266, 0.013928075321018696, 0.014807412400841713, 0.03872224688529968, 0.0044516450725495815, -0.004459496587514877, 8.900101238396019e-05, -0.015749558806419373, -0.0064772614277899265, -0.027290862053632736, 0.01482311449944973, -0.002530057681724429, -0.01457187533378601, -0.01106237806379795, 0.0034309858456254005, 0.016487574204802513, -0.005228916648775339, -0.012185103259980679, -0.008683456107974052, 0.010402875021100044, -0.016613194718956947, -0.01733550801873207, 0.009900395758450031, 0.018733026459813118, 0.04170571267604828, 0.013645431026816368, -0.007223127875477076, 0.0028971023857593536, -0.04921148717403412, -0.01373179443180561, -0.0203503780066967, -0.014901626855134964, -0.023004092276096344, 0.013166505843400955, 0.0033681760542094707, -0.002314148936420679, 0.02080575004220009, 0.008369406685233116, -0.004392760805785656, -0.0019402342149987817, -0.002771482802927494, 0.03432556241750717, 0.014681792818009853, -0.04754702374339104, 0.0407007560133934, -0.007411557249724865, 0.032880935817956924, -0.024464420974254608, 0.0078080445528030396, -0.008769819512963295, 0.0006143584614619613, 0.022014837712049484, -0.029724741354584694, -0.013213614001870155, -0.0019520111382007599, 0.01714707724750042, 0.02133963257074356, -0.004306397400796413, 0.013480555266141891, 0.027494993060827255, 0.002066835295408964, -0.014713197946548462, -0.021669384092092514, 0.004640074446797371, 0.013056589290499687, 0.051755283027887344, 0.0016144083347171545, 0.010607006959617138, 0.02292557992041111, 0.016236335039138794, -0.0008209438528865576, -0.022407399490475655, -0.006591104436665773, 3.9869508327683434e-05, -0.0017351210117340088, -0.022203266620635986, -0.013417745009064674, 0.026819787919521332, -0.028751190751791, -0.022250374779105186, 0.008934695273637772, -0.021355334669351578, 0.0009308609878644347, -0.0029304700437933207, 0.00405123271048069, 0.006347716320306063, -0.012695432640612125, 0.012240061536431313, 0.025280948728322983, -0.005067966412752867, -0.014406999573111534, -0.006320237182080746, 0.004510529339313507, -0.013299977406859398, 0.009272297844290733, -0.007815895602107048, 0.002777371322736144, -0.013417745009064674, 0.014077248051762581, -0.007121061906218529, 0.008173126727342606, 0.02771482802927494, -0.017162781208753586, -0.01101526990532875, 0.0013592435279861093, -0.023742107674479485, 0.002950098132714629, 0.014289231970906258, 0.007917961105704308, 0.005256395787000656, -0.024291694164276123, 0.012436342425644398, 0.025909045711159706, -0.003491832874715328, 0.02108839340507984, -0.02499830350279808, -0.011203699745237827, -0.021606573835015297, 0.011839648708701134, 0.03385448828339577, -0.0044241659343242645, 0.04095199704170227, 0.005531189031898975, -0.009295851923525333, 0.02568921260535717, -0.03319498524069786, -0.028342926874756813, -0.023004092276096344, 0.043307363986968994, 0.0011433347826823592, 0.0005652882973663509, 0.02603466622531414, 0.010976013727486134, -0.006504741031676531, 0.018466083332896233, 0.00021799419482704252, -0.008502878248691559, 0.006528294645249844, -0.005005156621336937, 0.030509864911437035, 0.006406600587069988, 0.03828257694840431, 0.0036449318286031485, -0.011643368750810623, -0.010379320941865444, 0.0014730863040313125, 0.04782966896891594, -0.04151728376746178, 0.0005726488307118416, 0.024480123072862625, 0.006171063520014286, -0.014540471136569977, 0.0031777836848050356, -0.022595828399062157, 0.013975182548165321, -0.02060161717236042, 0.02377351187169552, -0.016126418486237526, 0.016071459278464317, -0.013292125426232815, -0.022391697391867638, -0.012836754322052002, 0.0018214844167232513, -0.02628590539097786, -0.0026890449225902557, 0.016314847394824028, 0.013574769720435143, 0.011706178076565266, -0.003580159042030573, 0.021371036767959595, -0.00014070869656279683, 0.02736937440931797, -0.03338341414928436, 0.04647925868630409, 0.0186231080442667, 0.034702420234680176, 0.0033563992474228144, -0.021214013919234276, 0.011941715143620968, -0.006748128682374954, 0.02138674072921276, -0.03197019174695015, 0.018717322498559952, -0.024590039625763893, -0.027180945500731468, 0.01336278673261404, 0.04421810433268547, -0.012632623314857483, 0.0016605342971161008, -0.008094614371657372, 0.01252270583063364, 0.021763598546385765, 0.003990385681390762, 0.0017321767518296838, -0.007058252114802599, 0.008487175218760967, 0.022862769663333893, -0.011297914199531078, 0.018466083332896233, 0.056246183812618256, -0.017743771895766258, -0.012381383217871189, 0.005264247301965952, -0.01237353216856718, -0.003794105025008321, 0.027353672310709953, 0.022266076877713203, -0.01991070993244648, -0.0028656974900513887, 0.04242802783846855, -0.006826641038060188, 0.01190245896577835, 0.014893775805830956, -0.01497228816151619, 0.01042642816901207, -0.006649988703429699, 0.0007247662870213389, -0.026741275563836098, 0.003332845401018858, -0.001776339951902628, -0.012923118658363819, -0.02578342705965042, 0.007847300730645657, 0.0372462160885334, -0.012200805358588696, 0.01571815460920334, -0.030447054654359818, 0.007505772169679403, 0.017806580290198326, 0.02099417895078659, -0.020884262397885323, 0.022595828399062157, -0.003485944354906678, 0.0010069197742268443, -0.010889650322496891, -0.0005677418084815145, -0.04337017238140106, 0.016142120584845543, -0.0029756147414445877, -0.022894175723195076, 0.0035252005327492952, 0.014116504229605198, 0.005601849872618914, 0.02806028164923191, -0.017571043223142624, -0.015514022670686245, -0.01565534435212612, -0.009821884334087372, 0.026254499331116676, -0.025610700249671936, -0.0010167338186874986, 0.03834538906812668, 0.0040198275819420815, -0.015898732468485832, 0.01793220080435276, -0.03256688639521599, 0.03178176283836365, 0.009201637469232082, 0.022784259170293808, 0.009225190617144108, -0.002528094919398427, 0.023035498335957527, 0.024071859195828438, -0.031106557697057724, -0.019031371921300888, -0.026851193979382515, -0.025029709562659264, -0.001349429483525455, -0.000177143287146464, 0.018811536952853203, -0.02504541166126728, -0.03740324079990387, 0.0007556804921478033, -0.02345946431159973, 0.008589241653680801, -0.006363418884575367, -0.021779300644993782, 0.008338002488017082, 0.027337970212101936, 0.011580558493733406, 0.015529725700616837, 0.0218892190605402, -0.013323530554771423, -0.006653914228081703, -0.016189228743314743, -0.03875365108251572, 0.04076356440782547, -0.0009131957194767892, 0.0031581558287143707, -0.00022547740081790835, -0.010457833297550678, -0.014705346897244453, -0.018214844167232513, -0.0077295321971178055, 0.0011796467006206512, 0.053922221064567566, 0.028986727818846703, 0.028892511501908302, -0.001665441319346428, -0.0032386307138949633, -0.02959912270307541, -0.024715660139918327, 0.000818490341771394, -0.006708872504532337, 0.01659749262034893, -0.029724741354584694, -0.017853688448667526, -0.003652782877907157, 0.02480987459421158, 0.000461750227259472, -0.008871885947883129, -0.004887388087809086, 0.011242955923080444]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"42
45
48
51
54
57
60
63
66
69HeadsLayer 23
0.00.20.40.60.81.0 (xxiv) Layer 20
Figure 15. Activations of OPT-66B
14
Runtime Clustered Head Attention for Efficient Inference
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 24
0.00.20.40.60.81.0
(xxv) Layer 24
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 25
0.00.20.40.60.81.0 (xxvi) Layer 25
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 25
0.00.20.40.60.81.0 (xxvii) Layer 25
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 26
0.00.20.40.60.81.0
(xxviii) Layer 26
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 27
0.00.20.40.60.81.0 (xxix) Layer 27
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 28
0.00.20.40.60.81.0 (xxx) Layer 28
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 29
0.00.20.40.60.81.0
(xxxi) Layer 29
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 30
0.00.20.40.60.81.0 (xxxii) Layer 30
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 31
0.00.20.40.60.81.0 (xxxiii) Layer 31
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 32
0.00.20.40.60.81.0
(xxxiv) Layer 32
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 33
0.00.20.40.60.81.0 (xxxv) Layer 33
01234567891011
T oken0
3
6","[0.008723074570298195, 0.024930058047175407, 0.04624044895172119, 0.00013820876483805478, 0.029968244954943657, -0.0035605633165687323, 0.057751644402742386, -0.03231613710522652, -0.028680164366960526, -0.015024884603917599, 0.03975113108754158, -0.011698703281581402, -0.01402213890105486, 0.0008809693972580135, 0.012171542271971703, -0.01760919764637947, 0.040762029588222504, -0.029120394960045815, -0.02153865620493889, 0.07121942192316055, -0.02170170471072197, -0.019158154726028442, -0.010655194520950317, 0.026087699458003044, -0.0013431089464575052, -0.004915900994092226, 0.010003002360463142, -0.009424181655049324, 0.061632189899683, -0.01323950756341219, 0.006558610592037439, -0.053936317563056946, -0.022272374480962753, -0.04235990345478058, -0.04242512211203575, 0.013932461850345135, -0.01227752398699522, 0.027799705043435097, -0.03203895688056946, -0.0049729677848517895, 0.06097999960184097, -0.057490769773721695, -0.01466617826372385, -0.009579077363014221, 0.019321203231811523, -0.02431047521531582, -0.02647901512682438, -0.023397406563162804, 0.023544149473309517, 0.06349094212055206, -0.020690806210041046, 0.021457133814692497, -0.03106066770851612, 0.03939242660999298, -0.025973565876483917, 0.021326694637537003, -0.002912447089329362, 0.033294428139925, 0.07858919352293015, -0.00707628857344389, 0.04099029675126076, 0.01557109598070383, 0.03194112703204155, -0.029120394960045815, 0.03226722404360771, 0.0030388094019144773, -0.0765673965215683, -0.0001752767275320366, 0.03603363409638405, -0.004732471890747547, -0.007296403404325247, 0.06841499358415604, 0.02109842747449875, 0.006750192493200302, 0.0091551523655653, 0.026837721467018127, -0.008600788190960884, 0.02238650806248188, 0.0072556412778794765, -0.047414395958185196, 0.019141849130392075, 0.014951513148844242, 0.07017591595649719, -0.030522609129548073, 0.026185529306530952, -0.046566542237997055, -0.037696726620197296, -0.008869817480444908, -0.058632105588912964, -0.03929459676146507, -0.03743584826588631, 0.007712176069617271, -0.029397577047348022, -0.005148244556039572, 0.0038907357957214117, -0.04115334525704384, 0.006644211243838072, -0.009106237441301346, 0.002368273911997676, -0.014715093187987804, 0.035283613950014114, 0.008132025599479675, 0.021212561056017876, 0.01584012433886528, 0.010907919146120548, 0.002117587486281991, -0.014421606436371803, -0.011926970444619656, -0.05807774141430855, -0.007002917118370533, -0.05752337723970413, 0.016891784965991974, -0.007985281758010387, 0.023315882310271263, 0.04024027660489082, -0.018000513315200806, -0.019337506964802742, 0.009146999567747116, -0.02202780172228813, -0.020690806210041046, -0.02403329312801361, -0.051588427275419235, 0.025451812893152237, 0.01674504205584526, -0.011747617274522781, -0.0470556877553463, 0.02872907929122448, -0.04565347358584404, -0.0511971116065979, -0.03378356993198395, 0.04659915342926979, 0.016655365005135536, 0.037011925131082535, -0.05005577206611633, -0.017168967053294182, 0.03495751693844795, 0.019826652482151985, 0.0836762934923172, -0.027636656537652016, -0.021587571129202843, -0.009546468034386635, -0.028941042721271515, 0.02082124538719654, 0.026854025200009346, 0.002967475913465023, 0.07350209355354309, -0.04659915342926979, 0.04884921759366989, -0.05292541906237602, 0.042392510920763016, -0.00715781282633543, -0.006823563948273659, -0.023152833804488182, -0.007810004986822605, -0.020332101732492447, -0.05657769739627838, 0.009057323448359966, 0.04565347358584404, 0.01054106093943119, 0.05149059742689133, 0.008445892482995987, -0.013720499351620674, 0.036751046776771545, 0.005294987931847572, -0.0041821845807135105, 0.06231699138879776, 0.004801767412573099, 0.000551816017832607, -0.08667638152837753, -0.051849301904439926, 0.01892988756299019, 0.009228523820638657, -0.043272972106933594, -0.013247660361230373, 0.0006791973137296736, 0.016329269856214523, -0.00894318986684084, 0.020283186808228493, -0.02638118714094162, 0.011079120449721813, 0.025451812893152237, 0.049436189234256744, 0.0004269822675269097, 0.044903453439474106, -0.05103406310081482, -0.0244735237210989, 0.001456223544664681, -0.0016029669204726815, 0.018864667043089867, -0.022777823731303215, -0.007651033345609903, 0.016027631238102913, 0.04826224595308304, 0.023658283054828644, -0.003218162339180708, -0.06466488540172577, 0.06029519438743591, -0.04428387060761452, 0.0003584510996006429, 0.003913154825568199, 0.008527416735887527, 0.015204237774014473, 0.05390371009707451, -0.027375780045986176, 0.009269285947084427, 0.008910579606890678, -0.011918817646801472, -0.030767180025577545, 0.01244872435927391, -0.018277695402503014, 0.061990898102521896, -0.05925168842077255, 0.009611686691641808, 0.00816055852919817, -0.030066074803471565, 0.003375096246600151, -0.044577356427907944, -0.015562943182885647, -0.008690465241670609, 0.006220285780727863, 0.0103698605671525, 0.06616492569446564, 0.05018621310591698, 0.02029949054121971, -0.012905258685350418, 0.040729422122240067, 0.03404444828629494, -0.031109582632780075, 0.0028676087968051434, -0.01626405119895935, 0.028859518468379974, -0.010524756275117397, 0.01744614914059639, -0.03880545496940613, -0.008706769905984402, -0.051686253398656845, -0.00132272788323462, -0.011706855148077011, 0.006024627946317196, -0.03456620126962662, -0.0006751211476512253, 0.02698446437716484, -0.015334676019847393, 0.03668582811951637, -0.013761261478066444, -0.02837037295103073, -0.0065096961334347725, -0.033098768442869186, -0.0019575965125113726, -0.018636399880051613, 0.016614602878689766, 0.005511026363819838, -0.030571524053812027, -0.017821159213781357, -0.07239336520433426, 0.03143567964434624, 0.007276022341102362, 0.015383590012788773, -0.016353726387023926, 0.02975628338754177, -0.00017922554980032146, -0.031011752784252167, -0.05964300408959389, 0.012807429768145084, -0.039261989295482635, -0.010565518401563168, 0.022093020379543304, 0.023919159546494484, -0.025370288640260696, -0.07050200551748276, 0.005959408823400736, -0.005352054722607136, 0.05996910110116005, 0.01423410139977932, -0.03547926992177963, -0.034761860966682434, 0.006954002659767866, 0.0022643308620899916, -0.06065390259027481, 0.004006907809525728, -0.015766752883791924, 0.02682141587138176, 0.035022735595703125, 0.02804427780210972, -0.03991417959332466, -0.010973138734698296, -0.014071052893996239, 0.01224491372704506, -0.01927228830754757, -0.04330558329820633, 0.04350123926997185, -0.0440882109105587, 0.036066245287656784, -0.0008519264520145953, -0.01702222414314747, -0.005588474217802286, 0.03632712364196777, -0.008087187074124813, 0.0022276449017226696, 0.008926885202527046, 0.039261989295482635, 0.0016162145184352994, 0.01149489264935255, -0.01588088646531105, -0.008038272149860859, 0.03668582811951637, 0.016712432727217674, 0.019402727484703064, 0.03296833112835884, -0.03766411542892456, -0.02100059762597084, -0.0010144650004804134, 0.019891871139407158, -0.03187590837478638, -0.05233844742178917, -0.029479101300239563, 0.044218651950359344, 0.011388911865651608, -0.003505534725263715, 0.01137260627001524, -0.014079205691814423, -0.025027886033058167, -0.009668753482401371, 0.02439199946820736, 0.018342914059758186, 0.019810346886515617, -0.019826652482151985, 0.001438899664208293, 0.04399038478732109, -0.04650132358074188, -0.007679566740989685, -0.02724534086883068, -0.03505534678697586, 0.0030979143921285868, 0.008205397054553032, -0.026071395725011826, -0.058958202600479126, 0.01626405119895935, 0.020886464044451714, -0.001338013680651784, -0.06502359360456467, -0.004512356594204903, -0.027473608031868935, -0.014250406064093113, -0.03158242255449295, -0.000321510509820655, 0.015995020046830177, -0.010549213737249374, 0.06329528242349625, -0.018522266298532486, -0.04549042508006096, 0.008910579606890678, 0.005413197912275791, 0.008617093786597252, -0.04310992360115051, 0.01231828611344099, 0.052990641444921494, -0.049860116094350815, -0.06101260706782341, 0.03593580797314644, -0.03919677063822746, 0.010435080155730247, 0.047088298946619034, 0.004614261910319328, 0.03151720389723778, 0.023218052461743355, -0.03609885275363922, 0.03045738860964775, 0.009481248445808887, 0.005747446324676275, 0.014079205691814423, -0.015016731806099415, 0.0010557365603744984, -0.04193597659468651, -0.062186554074287415, -0.01821247488260269, -0.012660686857998371, 0.019989699125289917, 0.021718010306358337, 0.03645756095647812, -0.02246803231537342, 0.00012871884973719716, 0.015995020046830177, 0.0010119173675775528, 0.03724019229412079, -0.0496644601225853, -0.014592806808650494, 0.009668753482401371, -0.07141508162021637, -0.030571524053812027, 0.017674416303634644, 0.02212562970817089, 0.009693210944533348, 0.021131036803126335, -0.00039182501495815814, -0.013003087602555752, 0.03469664230942726, 0.0777413472533226, 0.014878141693770885, 0.028582336381077766, 0.003915193025022745, 0.017168967053294182, -0.03332703560590744, 0.007512442301958799, -0.03296833112835884, 0.00911439023911953, 0.004818072076886892, 0.017543978989124298, 0.016891784965991974, 0.019076630473136902, 0.014413454569876194, -0.009848106652498245, 0.012742211110889912, -0.04200119525194168, 0.00670535396784544, 0.019288593903183937, 0.02013644389808178, 0.01813095062971115, -0.009913326241075993, 0.03587058559060097, -0.015163475647568703, -0.0332455113530159, 0.009269285947084427, 0.027180122211575508, -0.04089247062802315, 0.02489744871854782, 0.05579506605863571, -0.0739586278796196, 0.02437569387257099, -0.06593666225671768, -0.027277950197458267, 0.05586028844118118, 0.020788636058568954, 0.028060581535100937, -0.024848533794283867, -0.015522181056439877, -0.007039602845907211, 0.02212562970817089, 0.00907362811267376, 0.008666007779538631, -0.010622585192322731, 0.005600702948868275, -0.032413966953754425, -0.04001200944185257, -0.06815411895513535, 0.04545781761407852, -0.04503389075398445, -0.03270745277404785, -0.0012432419462129474, 0.010524756275117397, -0.019810346886515617, -0.009041018784046173, -0.01796790398657322, 0.037957604974508286, -0.006179523654282093, -0.00626920023933053, 0.08041533082723618, -0.0011433749459683895, 0.03609885275363922, -0.04046854376792908, -0.010092678479850292, -0.030147597193717957, -0.017658112570643425, 0.021799534559249878, -0.04115334525704384, 0.04731656610965729, -0.037892382591962814, -0.016859175637364388, 0.04549042508006096, 0.035707540810108185, -1.2833670552936383e-05, -0.004418604075908661, 0.012913411483168602, -0.03984896093606949, -0.009791039861738682, -0.011804684065282345, 0.055762458592653275, -0.025044191628694534, 0.022288678213953972, -0.08498068153858185, -0.03802282363176346, -0.0034525441005825996, 0.005951256491243839, 0.01935381256043911, 0.03968591243028641, 0.04584913328289986, 0.027310561388731003, 0.020870160311460495, -0.0005314349546097219, 0.016117306426167488, -0.0228104330599308, 0.00038876786129549146, 0.05859949439764023, -0.022370202466845512, 0.008747532032430172, 0.033098768442869186, -0.016386335715651512, -0.048131804913282394, -0.02334849163889885, -0.053838491439819336, 0.02413112297654152, 0.034305326640605927, 0.064240962266922, -0.00311421905644238, 0.035544492304325104, 0.016312964260578156, 0.007589890155941248, 0.030783485621213913, -0.03740324079990387, 0.004037478938698769, -0.012571010738611221, 0.030163902789354324, -0.01132369227707386, -0.004940357990562916, -0.03877284377813339, 0.027375780045986176, 0.01959838531911373, 0.009717668406665325, -0.02135930396616459, -0.0010547175770625472, -0.024538742378354073, -0.009399724192917347, -0.042490340769290924, -0.019386421889066696, 0.0020299491006881, -0.0017711102264001966, -0.0055151027627289295, -0.06841499358415604, -0.0385119654238224, 0.013630823232233524, 0.014845531433820724, -0.04780571162700653, 0.011005748063325882, 0.008812750689685345, -0.046207837760448456, 0.02439199946820736, 0.033718351274728775, -0.026756197214126587, -0.04715351760387421, -0.0013828518567606807, -0.0061020758002996445, 0.029462795704603195, 0.007027374114841223, -0.003371019847691059, 0.010916071943938732, -0.008967646397650242, 0.014723245985805988, 0.0042229462414979935, 0.002504826756194234, 0.013500384986400604, 0.009220371022820473, -0.009888868778944016, 0.053512394428253174, -0.00047818958410061896, -0.03531622514128685, -0.007153736427426338, -0.015228694304823875, 0.008812750689685345, 0.01760919764637947, 0.0015866620233282447, 0.032756369560956955, -0.02230498380959034, 0.021832143887877464, -0.004280013032257557, -0.006473010405898094, 0.03381618112325668, -0.005535483825951815, -0.02039732038974762, 0.004919976927340031, 0.005669998470693827, -0.029625844210386276, -0.02716381661593914, -0.003709344891831279, -0.013011240400373936, -0.0052460734732449055, 0.003002123674377799, -0.0018913582898676395, 0.04125117510557175, -0.006236590910702944, -0.021571267396211624, -0.03055521845817566, -0.01708744280040264, -0.035446662455797195, -0.026527930051088333, -0.04138161242008209, 0.01760919764637947, -0.0022582164965569973, 0.012571010738611221, -0.04695785790681839, 0.012513943016529083, 0.019891871139407158, 0.009791039861738682, 0.01423410139977932, 0.032935719937086105, -0.0024885220918804407, -0.009171457029879093, 0.0205603688955307, -0.030359560623764992, 0.024228950962424278, 0.021391913294792175, -0.011046510189771652, 0.01045953668653965, -0.034142278134822845, 0.008902427740395069, -0.005148244556039572, -0.012937868945300579, -0.028419287875294685, 0.016712432727217674, 0.023038700222969055, 0.025631165131926537, 0.0016223288839682937, 0.0016467859968543053, 0.008886123076081276, -0.005906418431550264, -0.025565946474671364, 0.0366206094622612, -0.018277695402503014, -0.007675490342080593, 0.03671843558549881, -0.00998669769614935, 0.0030225045047700405, 0.011959579773247242, 0.009277437813580036, 0.01847335323691368, 0.0183103047311306, 0.03818587213754654, 0.02160387672483921, -0.036066245287656784, -0.03391401097178459, -0.007540975697338581, -0.0590234212577343, -0.015383590012788773, 0.04275121912360191, 0.0066034491173923016, -0.020071223378181458, 0.0084132831543684, -0.040044620633125305, 0.0017201576847583055, 0.02665836736559868, -0.04506650194525719, -0.002492598257958889, -0.005409121513366699, 0.0025700461119413376, -0.04513172060251236, 0.03971852362155914, 0.0373380221426487, -0.005568093620240688, 0.0059920186176896095, -0.06006692722439766, -0.04764266312122345, 0.02551703155040741, -0.04353385046124458, 0.015473267063498497, 0.02431047521531582, 0.0013166136341169477, -0.04731656610965729, -0.01951686106622219, 0.009187761694192886, -0.015130866318941116, -0.028158411383628845, -0.019549470394849777, 0.02116364613175392, -0.019304897636175156, -0.035968415439128876, 0.0067868782207369804, 0.009676906280219555, 0.02602248080074787, -0.001608062069863081, 0.009358962066471577, -0.010361708700656891, -0.03896849974989891, 0.045099109411239624, 0.04487084224820137, 0.02665836736559868, 0.036751046776771545, -0.0209190733730793, -0.0162395928055048, 0.005478417035192251, -0.027636656537652016, -0.006501543801277876, 0.017120052129030228, 0.011421521194279194, -0.035968415439128876, -0.0014480710960924625, 0.002912447089329362, -0.009839953854680061, 0.03812064975500107, -0.02065819688141346, 0.0020472730975598097, -0.016027631238102913, 0.01223676186054945, 0.003002123674377799, 0.023055003955960274, -0.010948681272566319, 0.008148330263793468, 0.023919159546494484, -0.009138847701251507, 0.014543892815709114, -0.027180122211575508, -0.04033810645341873, -0.015954259783029556, 0.004438985139131546, -0.04611000791192055, 0.017168967053294182, -0.04284904524683952, -0.043272972106933594, 0.005001501180231571, 0.03655539080500603, 0.03916415944695473, -0.026234442368149757, -0.019141849130392075, 0.002030968200415373, -0.020332101732492447, -0.004149574786424637, 0.012652534060180187, 0.018620096147060394, 0.01310906931757927, -0.01919076405465603, -0.004871062468737364, -0.027310561388731003, -0.010956834070384502, 0.028517117723822594, 0.00457757618278265, -0.009473095647990704, 0.03740324079990387, 0.006550458259880543, -0.04157727211713791, -0.009913326241075993, -0.010557365603744984, 0.010166050866246223, 0.005066720303148031, 0.0706324502825737, 0.0033954770769923925, 0.031468287110328674, 0.00612245686352253, 0.03916415944695473, -0.031044362112879753, 0.028484506532549858, -0.01702222414314747, -0.02776709571480751, 0.01166609302163124, -0.06952372193336487, -0.020022310316562653, -0.014674331061542034, 0.030685657635331154, 0.05426241457462311, 0.029788892716169357, 0.003442353568971157, -0.025728993117809296, -0.04089247062802315, -0.006758344825357199, 0.016394488513469696, -0.0003635463654063642, -0.016859175637364388, 0.022794127464294434, 0.019630994647741318, 0.03358791396021843, -0.03991417959332466, 0.020250577479600906, -0.007850767113268375, 0.02907148003578186, 0.005213463678956032, -0.0153183713555336, -0.014348234981298447, 0.008568178862333298, -0.030000854283571243, -0.03746845945715904, -0.012171542271971703, 0.02568008005619049, 0.02561485953629017, -0.02202780172228813, 0.007516518700867891, 0.022598469629883766, -0.008723074570298195, 0.04376211762428284, -0.015000427141785622, 0.053936317563056946, -0.02204410545527935, -0.02491375245153904, -0.019663603976368904, -0.031729165464639664, -0.003271152963861823, -0.011315539479255676, -0.003813287941738963, -0.018342914059758186, -0.001066946191713214, 0.0008514169021509588, -0.017560282722115517, 0.004830300807952881, -0.04069681093096733, -0.010932376608252525, -0.0043615372851490974, -0.0010032554855570197, -0.01654123142361641, 0.00453681405633688, 0.011837293393909931, -0.0008356216130778193, -0.1158946081995964, -0.008568178862333298, 0.033359646797180176, 0.0024273789022117853, -0.012522095814347267, -0.007516518700867891, 0.0076591856777668, 0.055762458592653275, 0.023022394627332687, 0.0010893652215600014, 0.010932376608252525, -0.011087272316217422, -0.006803182885050774, -0.008148330263793468, 0.019484249874949455, -0.03079979121685028, 0.011837293393909931, 0.0018883011071011424, -0.00017655054398346692, -0.03616407513618469, -0.037174973636865616, 0.002064596861600876, 0.01600317284464836, 0.024881143122911453, -0.024506133049726486, -0.020870160311460495, -0.009146999567747116, -0.00816055852919817, 0.02413112297654152, -0.011209558695554733, -0.015204237774014473, 0.045099109411239624, -0.0021624257788062096, 0.038675013929605484, 0.0025211316533386707, -0.025060497224330902, -0.03841413930058479, -0.010818243026733398, 0.0054498836398124695, -0.012595467269420624, -0.03187590837478638, -0.0231691375374794, 0.023756111040711403, 0.006481162738054991, 0.01024757418781519, -0.007165965158492327, 0.009831801988184452, -0.00022126140538603067, 0.016117306426167488, -0.012717753648757935, 0.01953316479921341, -0.004025250673294067, 0.007846690714359283, -0.0018485580803826451, 0.010834547691047192, 0.01806573197245598, 0.0009370172047056258, 0.016166221350431442, 0.025370288640260696, -0.02413112297654152, 0.026788806542754173, 0.011763921938836575, 0.01710374839603901, -0.041349004954099655, 0.004479747265577316, -0.007549128029495478, -0.023674586787819862, 0.04917531460523605, 0.014291168190538883, -0.0012513943947851658, -0.0392293781042099, -0.009016561321914196, 0.002030968200415373, 0.001238146680407226, 0.007218955550342798, 0.024538742378354073, 0.019321203231811523, -0.0024273789022117853, -0.009538315236568451, 0.005612931679934263, 0.016973309218883514, 0.01953316479921341, -0.007850767113268375, -0.00040277981315739453, 0.0029369043186306953, -0.030424779281020164, -0.00903286598622799, -0.03984896093606949, -0.001239165780134499, -0.004854757804423571, 0.03009868413209915, -0.013100916519761086, 0.021978886798024178, 0.012571010738611221, 0.016859175637364388, -0.023560453206300735, -0.003638011170551181, 0.004280013032257557, 0.04549042508006096, 0.005115634761750698, 0.010092678479850292, 0.011910665780305862, 0.005360207054764032, -0.0511971116065979, -0.01578305847942829, 0.001659014611504972, 0.007043678779155016, -0.022549554705619812, -0.003189628943800926, -0.025924650952219963, -0.010084526613354683, 0.0034851536620408297, 0.004500128328800201, 0.0254192017018795, 0.01028018444776535, -0.004655024036765099, 0.04177292808890343, 0.002207264071330428, 0.004096583928912878, -0.0246528759598732, -0.001287061139009893, 0.005747446324676275, 0.016027631238102913, -0.0038560880348086357, -0.038055431097745895, -0.0016916242893785238, 0.011657941155135632, 0.02724534086883068, -0.0018913582898676395, 0.007867071777582169, -0.017413539811968803, 0.015000427141785622, -0.003456620266661048, 0.024098511785268784, 0.020739721134305, -0.032674845308065414, -0.0022256069350987673, 0.017576588317751884, 0.0020065109711140394, 0.02577790804207325, 0.004818072076886892, 0.001830215216614306, 0.029055176302790642, 0.00845404528081417, -0.006216209847480059, 0.042653389275074005, -0.016875481233000755, -0.01728310063481331, 0.004459366202354431, 0.017234187573194504, 0.021065818145871162, -0.018179865553975105, 0.0013318993151187897, 0.021978886798024178, 0.027538828551769257, 0.027979057282209396, -0.0026373034343123436, 0.011829141527414322, 0.013035697862505913, 0.05553419142961502, 0.04007722809910774, 0.013598213903605938, 0.016728738322854042, 0.002133892383426428, 0.023055003955960274, -0.002625074703246355, -0.017853770405054092, -0.026527930051088333, 0.014649873599410057, -0.0050381869077682495, -0.013386251404881477, 0.019549470394849777, 0.02760404720902443, 0.015831973403692245, 0.026788806542754173, 0.03322920575737953, -0.00613876199349761, -0.010263879783451557, 0.011886208318173885, 0.016451556235551834, -0.006591220386326313, 0.009212219156324863, -0.01210632361471653, 0.0340118370950222, 0.035283613950014114, -0.003576868213713169, -0.0016661479603499174, 0.01937011629343033, -0.008739379234611988, 0.015008579939603806, 0.02776709571480751, 0.04200119525194168, 0.0005650636740028858, -0.008796446025371552, -0.005943104159086943, -0.020201662555336952, 0.058175571262836456, -0.00535613065585494, -0.011168796569108963, 0.010214964859187603, 0.026576844975352287, 0.029299747198820114, 0.00016903504729270935, -0.013076459057629108, -0.004414528142660856, 0.05912125110626221, -0.027033379301428795, -0.024245256558060646, -0.005221616011112928, 0.03384878858923912, -0.017429843544960022, 0.017380930483341217, -0.034305326640605927, 0.005209387745708227, -0.03298463672399521, 0.02100059762597084, -0.0009079742594622076, -0.005975713953375816, 0.02282673679292202, 0.0030306570697575808, -0.011307387612760067, -0.03968591243028641, -0.025484422221779823, 0.047936148941516876, 0.014625417068600655, -0.0001807541266316548, -0.017250491306185722, -0.017723331227898598, -0.016353726387023926, -0.015220542438328266, 0.004324851557612419, 0.019761431962251663, -0.015334676019847393, 0.011527501977980137, -0.005706684198230505, 0.003424010705202818, 0.010614432394504547, -0.006901011802256107, -0.018163561820983887, 0.011062814854085445, 0.03130523860454559, 0.04128378629684448, -0.008066806010901928, 0.0018108532531186938, -0.0024599884636700153, 0.012473181821405888, 0.023283271118998528, 0.017332015559077263, -0.0033914009109139442, -0.024196341633796692, -0.019467946141958237, -0.002435531234368682, 0.0306367427110672, -0.026674672961235046, -0.027832314372062683, -0.03919677063822746, 0.018864667043089867, 0.01917445845901966, -0.01419333927333355, 0.036066245287656784, -0.006856173742562532, 0.04226207360625267, 0.027473608031868935, -0.02621813863515854, 0.021310389041900635, -0.0014297282323241234, 3.541201294865459e-05, -0.016598299145698547, -0.0010241459822282195, 0.008213548921048641, -0.015546638518571854, 0.02047884464263916, 0.026364881545305252, -0.016557537019252777, -0.005462112370878458, -0.0006134685827419162, 0.041609879583120346, -0.03499012812972069, 0.025647470727562904, -0.03808804228901863, -0.02786492370069027, -0.004540890455245972, 0.02204410545527935, 0.0029572853818535805, 0.006570839323103428, -0.012750362977385521, -0.043012093752622604, -0.0421968549489975, 0.03453359380364418, -0.005396892782300711, 0.010565518401563168, 0.001357375644147396, 0.0034973821602761745, 0.006819487549364567, 0.00940787699073553, 0.009880715981125832, 0.023576758801937103, 0.007161888759583235, 0.01979404129087925, -0.028419287875294685, 0.014331930316984653, 0.008902427740395069, 0.016394488513469696, -0.015970563516020775, 0.020201662555336952, 0.04258817061781883, 0.029267137870192528, -0.02507680095732212, -0.016598299145698547, -0.024000683799386024, 0.02369089238345623, 0.03776194527745247, 0.001136241597123444, 0.013117221184074879, -0.005095253698527813, 0.027636656537652016, 0.009138847701251507, -0.03724019229412079, -0.018717924132943153, -0.002028930000960827, 0.005881960969418287, 0.012913411483168602, -0.0009140885667875409, 0.019565774127840996, 0.0022480259649455547, 0.006053161807358265, -0.025044191628694534, 0.001438899664208293, -0.01969621330499649, -0.013475927524268627, -0.01806573197245598, 0.005156396888196468, 0.03239766135811806, -0.0003337391244713217, -0.021457133814692497, 0.0059675611555576324, 0.015008579939603806, 0.01535913348197937, -0.03671843558549881, -0.01032909844070673, 0.01328026968985796, 0.0126199247315526, 0.00529091153293848, 0.03965330496430397, -0.013728652149438858, 0.005800437182188034, -0.028663860633969307, 0.000148526654811576, 0.013956919312477112, -0.007973053492605686, 0.12411223351955414, -0.024277865886688232, -0.02359306439757347, 0.011837293393909931, 0.009171457029879093, 0.0013003087369725108, -0.016777651384472847, 0.017511367797851562, -0.04020766541361809, -0.013508536852896214, -0.039522863924503326, 0.0010781557066366076, 0.004243327304720879, -0.005229768343269825, 0.011551959440112114, 0.029658453539013863, -0.00785891991108656, 0.033555302768945694, 0.010206812992691994, 0.024538742378354073, -0.0006481162854470313, 0.01927228830754757, -0.021212561056017876, -0.005812665447592735, 0.017071139067411423, 0.022239763289690018, -0.007104821968823671, 0.004899596329778433, 0.008050501346588135, 0.005906418431550264, -0.019842956215143204, -0.028272544965147972, 0.005678150802850723, 0.02724534086883068, 0.012359047308564186, 0.012994935736060143, -0.0388706736266613, -0.0111117297783494, -0.005665922071784735, -6.381805724231526e-05, -0.0332455113530159, 0.010948681272566319, 0.01760919764637947, 0.007655109278857708, -0.034761860966682434, -0.008262463845312595, 0.005270530469715595, -0.008013815619051456, -0.019582079723477364, 0.003964107483625412, -0.01539989560842514, 0.007300479803234339, -0.006778725888580084, -0.014690635725855827, -0.013671585358679295, -0.017429843544960022, -0.0037582593504339457, 0.03971852362155914, 0.028712773695588112, 0.005482492968440056, -0.03394661843776703, -0.017543978989124298, -0.02499527670443058, 0.034500982612371445, -0.013769414275884628, -0.030604133382439613, -0.01470694039016962, 0.025451812893152237, -0.02369089238345623, 0.004858834203332663, 0.026348575949668884, -0.024718094617128372, -0.005564017221331596, -0.0059227230958640575, -0.017837464809417725, -0.005743369925767183, -0.015073798596858978, 0.01674504205584526, 0.026413796469569206, 0.03133784979581833, 0.007997510023415089, -0.013997681438922882, 0.0021216636523604393, -0.015285762026906013, -0.01166609302163124, -0.026511624455451965, 0.020006004720926285, 0.000983383972197771, -0.012774820439517498, 0.0018852439243346453, 0.008034196682274342, 0.01937011629343033, -0.000981345889158547, -0.011967732571065426, -0.008820903487503529, 0.004549042787402868, -0.007267870008945465, -0.013606365770101547, 0.01466617826372385, 0.01366343256086111, 0.04350123926997185, 0.006660515908151865, -0.010549213737249374, 0.012660686857998371, -0.04937097057700157, -0.021310389041900635, -0.029968244954943657, -0.012473181821405888, -0.023413710296154022, 0.0017996436217799783, 0.003095876192674041, -0.0016997767379507422, 0.025582250207662582, 0.011869903653860092, -0.005152320489287376, 0.000981345889158547, -0.002694370225071907, 0.017723331227898598, 0.014910751022398472, -0.0463382750749588, 0.04216424375772476, -0.007569509092718363, 0.035609710961580276, -0.037011925131082535, 0.0027921991422772408, -0.004830300807952881, 0.005164549220353365, 0.02959323488175869, -0.03185960277915001, -0.013826481066644192, 0.0027004845906049013, 0.01881575398147106, 0.01628035493195057, -0.001391004305332899, 0.013850938528776169, 0.023739807307720184, -0.002896142192184925, -0.013467774726450443, -0.02318544313311577, 0.008714921772480011, 0.013647127896547318, 0.047349173575639725, 0.006379257887601852, -0.003540182486176491, 0.01674504205584526, 0.018962496891617775, -0.008356216363608837, -0.015986869111657143, -0.012815582565963268, -0.0024069978389889, -0.010060069151222706, -0.012432419694960117, -0.001015993650071323, 0.0229897852987051, -0.026511624455451965, -0.02786492370069027, 0.010166050866246223, -0.020984293892979622, -0.016288507729768753, -0.0015489571960642934, 0.009358962066471577, 0.0031244095880538225, -0.006888783071190119, 0.008103491738438606, 0.02483223006129265, 0.00027794609195552766, -0.01795159839093685, 0.000594106619246304, 0.01227752398699522, -0.005201234947890043, 0.014429759234189987, -0.006199904717504978, -0.0017904721898958087, -0.009146999567747116, 0.014690635725855827, -0.0028186943382024765, 0.001523480867035687, 0.019223373383283615, -0.022174544632434845, -0.010133440606296062, 0.0035829825792461634, -0.013117221184074879, 0.0017354434821754694, 0.01575860194861889, 0.005869732238352299, 0.015122713521122932, -0.024343084543943405, 0.0019922442734241486, 0.027375780045986176, -0.01153565477579832, 0.022516945376992226, -0.03306616097688675, -0.01128293015062809, -0.022696299478411674, 0.009049170650541782, 0.03828369826078415, -0.01119325403124094, 0.03368574380874634, -0.0020258729346096516, -0.0006170352571643889, 0.024147426709532738, -0.040142446756362915, -0.030848704278469086, -0.019582079723477364, 0.02995194122195244, 0.011168796569108963, -0.005641465075314045, 0.024685485288500786, 0.007708100136369467, -0.008706769905984402, 0.01979404129087925, 0.0056496174074709415, -0.008527416735887527, 0.013899852521717548, 0.007006993051618338, 0.030767180025577545, -0.002847227966412902, 0.040305495262145996, 0.0027065989561378956, 0.0005451921606436372, -0.008429587818682194, 0.006562686990946531, 0.041446834802627563, -0.03065304644405842, -0.0018699581269174814, 0.027881229296326637, -0.004891443531960249, -0.00907362811267376, 0.0018363294657319784, -0.017918989062309265, 0.0021766924764961004, -0.020462539047002792, 0.019582079723477364, -0.009929630905389786, 0.023201748728752136, -0.008902427740395069, -0.018114646896719933, -0.010060069151222706, 0.0024803695268929005, -0.022940870374441147, -0.007035526446998119, 0.028500812128186226, 0.009799192659556866, 0.009921478107571602, -0.010916071943938732, 0.02716381661593914, -0.0007454356527887285, 0.016206983476877213, -0.030946534126996994, 0.06401269137859344, 0.021734314039349556, 0.034337934106588364, 0.00522569241002202, -0.03065304644405842, 0.020984293892979622, -0.011592721566557884, 0.02005491964519024, -0.030832400545477867, 0.013035697862505913, -0.02012013830244541, -0.042653389275074005, 0.011209558695554733, 0.03763150796294212, -0.019826652482151985, 0.003285419661551714, -0.01128293015062809, 0.005274606868624687, 0.027098597958683968, -0.010818243026733398, 0.015033037401735783, -0.006448553409427404, 0.007577661424875259, 0.022859346121549606, -0.00940787699073553, 0.016149915754795074, 0.05266454443335533, -0.0183103047311306, -0.004997424781322479, 0.003163133515045047, -0.009212219156324863, 0.001001726952381432, 0.01536728534847498, 0.019761431962251663, -0.014103662222623825, -0.00854372140020132, 0.044381700456142426, -0.010997596196830273, 0.016891784965991974, 0.011984037235379219, -0.006945849861949682, 0.021033208817243576, -0.008189092390239239, 0.006982536055147648, -0.019402727484703064, -0.0067868782207369804, 0.0008610978838987648, -0.010076373815536499, -0.030832400545477867, 0.0040884315967559814, 0.034924909472465515, -0.008164634928107262, 0.015049342066049576, -0.04141422361135483, 0.004679481033235788, 0.009676906280219555, 0.020446235314011574, -0.014103662222623825, 0.022712603211402893, -0.0075287469662725925, 0.0011943274876102805, -0.0170059185475111, -0.005694455932825804, -0.03913154825568199, 0.02318544313311577, -0.0021828068420290947, -0.01544065773487091, -0.0022806355264037848, 0.015334676019847393, 0.004952586721628904, 0.021391913294792175, -0.010997596196830273, -0.011250320822000504, -0.008364369161427021, -0.004025250673294067, 0.015122713521122932, -0.024685485288500786, -0.01162533089518547, 0.03254440426826477, -0.0017201576847583055, -0.029837805777788162, 0.011062814854085445, -0.026788806542754173, 0.04428387060761452, 0.017315709963440895, 0.02437569387257099, 0.0012799277901649475, -0.00579228438436985, 0.021294085308909416, 0.025826822966337204, -0.039979398250579834, -0.021489743143320084, -0.032837893813848495, -0.02481592446565628, 0.0011943274876102805, -0.008311377838253975, 0.021506046876311302, -0.025044191628694534, -0.038577187806367874, 0.0018342913826927543, -0.019141849130392075, 0.006420020014047623, -0.011845446191728115, -0.013052002526819706, 0.01098129153251648, 0.0325281023979187, 0.011715007945895195, 0.017592892050743103, 0.0168265663087368, -0.01644340343773365, -0.01137260627001524, -0.012163390405476093, -0.036848876625299454, 0.0347292497754097, 0.005099330097436905, -0.001304385019466281, -0.005910494364798069, -0.0040191360749304295, -0.016875481233000755, -0.011397063732147217, -0.0043859947472810745, -0.0015479380963370204, 0.03785977512598038, 0.03381618112325668, 0.02724534086883068, -0.0008035215432755649, -0.004679481033235788, -0.023707197979092598, -0.02135930396616459, 0.004977044183760881, -0.015244999900460243, 0.010818243026733398, -0.024163732305169106, -0.011723159812390804, -0.008682312443852425, 0.011992189101874828, 0.004544966388493776, -0.00701106945052743, -0.003611515974625945, 0.015163475647568703]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 34
0.0760.0780.0800.0820.0840.0860.0880.090 (xxxvi) Layer 34
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 35
0.00.20.40.60.81.0
(xxxvii) Layer 35
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 36
0.00.20.40.60.81.0 (xxxviii) Layer 36
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 37
0.00.20.40.60.81.0 (xxxix) Layer 37
Figure 15. Activations of OPT-66B15
Runtime Clustered Head Attention for Efficient Inference
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 38
0.00.20.40.60.81.0
(xl) Layer 38
01234567891011
T oken0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69HeadsLayer 39
0.00.20.40.60.81.0 (xli) Layer 39
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 41
0.00.20.40.60.81.0 (xlii) Layer 41
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 42
0.00.20.40.60.81.0
(xliii) Layer 42
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 43
0.00.20.40.60.81.0 (xliv) Layer 43
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 44
0.00.20.40.60.81.0 (xlv) Layer 44
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 45
0.00.20.40.60.81.0
(xlvi) Layer 45
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 46","[0.023676525801420212, 0.024840181693434715, 0.031434234231710434, 0.011846020817756653, 0.027105433866381645, -4.824324787477963e-05, 0.04825294762849808, -0.03149629756808281, -0.014010421000421047, -0.016198094934225082, 0.05067335069179535, -0.00047758393338881433, -0.004995964001864195, -0.0017852425808086991, 0.004743838682770729, -0.009914351627230644, 0.024483326822519302, -0.02477812021970749, -0.025367707014083862, 0.06684041768312454, -0.025491829961538315, -0.020092464983463287, -0.003529757261276245, 0.02352137118577957, 0.03472350165247917, 0.005690278951078653, 0.009239430539309978, -0.013800962828099728, 0.06345805525779724, -0.014530187472701073, 0.012156329117715359, -0.045056771486997604, -0.012730399146676064, -0.03875751048326492, -0.021814676001667976, 0.018153037875890732, -0.011326254345476627, 0.029510322958230972, -0.031899698078632355, -0.0057213096879422665, 0.04719789698719978, -0.054614268243312836, -0.029991300776600838, -0.011233162134885788, 0.004235708620399237, -0.007369822822511196, -0.006570778787136078, -0.016136033460497856, 0.023723071441054344, 0.05926889181137085, -0.015980878844857216, 0.022993847727775574, -0.03590267524123192, 0.0442809984087944, -0.026376208290457726, 0.01567832939326763, -0.007920620031654835, 0.02992923930287361, 0.08068016916513443, -0.005127845332026482, 0.02834666706621647, 0.013824236579239368, 0.03061191737651825, -0.03947122022509575, 0.009510950185358524, 0.006140226032584906, -0.06969524919986725, 0.005690278951078653, 0.044374093413352966, -0.00032703590113669634, -0.00724957836791873, 0.0534040629863739, 0.012714884243905544, 0.005655369255691767, 0.005255847238004208, 0.03061191737651825, -0.0018075460102409124, 0.005434274673461914, 0.009410100057721138, -0.032706499099731445, 0.029789600521326065, 0.012745914980769157, 0.07385338097810745, -0.03655432164669037, 0.01883571594953537, -0.04366038367152214, -0.04546017199754715, -0.015980878844857216, -0.05144912004470825, -0.02615899220108986, -0.033854641020298004, 0.00584931205958128, -0.023381732404232025, -0.017889276146888733, -0.005209301132708788, -0.04021596163511276, -0.005345060955733061, -0.018323706462979317, -0.0006317683728411794, -0.00461195781826973, 0.04173647239804268, 0.02133369818329811, 0.03363742306828499, 0.008773968555033207, 0.020511381328105927, 0.0085334787145257, -0.025414252653717995, -0.01005399040877819, -0.06379939615726471, 0.0006526171928271651, -0.04905974864959717, 0.008355052210390568, -0.007571523543447256, 0.03357536345720291, 0.03844720125198364, -0.01933220960199833, -0.00723018404096365, 0.012047721073031425, -0.01810649037361145, -0.01428969856351614, -0.023102454841136932, -0.03506484255194664, 0.01868056133389473, 0.011388315819203854, -0.030053362250328064, -0.05175942927598953, 0.04573944956064224, -0.047322019934654236, -0.05371437221765518, -0.03168248012661934, 0.04387759789824486, 0.016042940318584442, 0.04946314916014671, -0.03996771201491356, -0.01698938198387623, 0.031248049810528755, 0.01557747833430767, 0.0804939791560173, -0.03171351179480553, -0.010022958740592003, -0.023195547983050346, -0.03453731909394264, 0.011543470434844494, 0.023754103109240532, 0.013281196355819702, 0.05874136835336685, -0.036771535873413086, 0.04223296418786049, -0.051387060433626175, 0.05064231902360916, 0.016430826857686043, 0.0022865845821797848, -0.02954135276377201, -0.01567832939326763, -0.01618257910013199, -0.07062617689371109, -0.016213610768318176, 0.03618195280432701, 0.009658346883952618, 0.02946377545595169, 0.0038555811624974012, -0.02029416523873806, 0.037733495235443115, 0.009363554418087006, -0.0034017551224678755, 0.05200767517089844, 0.015057711862027645, 0.007687889039516449, -0.08980323374271393, -0.05324890837073326, 0.01795133762061596, 0.011652077548205853, -0.049587272107601166, 0.0018579711904749274, -0.018168553709983826, 0.010612544603645802, -0.024467812851071358, 0.0375162772834301, -0.024964304640889168, 0.01474740356206894, 0.013723386451601982, 0.047663360834121704, 0.0072069112211465836, 0.04316388815641403, -0.05017685890197754, -0.03292371332645416, 0.01423539500683546, -0.0023428278509527445, 0.023102454841136932, -0.012963131070137024, -0.007676252629607916, 0.011830504983663559, 0.041333071887493134, 0.01875813864171505, -0.0007539523066952825, -0.05632096156477928, 0.05570034682750702, -0.02321106381714344, 0.012722641229629517, 0.013180346228182316, 0.020076949149370193, 0.004650746006518602, 0.041798532009124756, -0.021768130362033844, 0.0082697169855237, 0.00737370178103447, -0.022000860422849655, -0.01336653158068657, 0.02508842945098877, 0.002994475420564413, 0.06597155332565308, -0.07559110969305038, 0.01549990102648735, -0.007606433238834143, -0.03323402255773544, 0.015670571476221085, -0.04381553828716278, -0.026422753930091858, -0.001266445848159492, 0.0033067231997847557, 0.007699525449424982, 0.07050205022096634, 0.04030905291438103, 0.027291618287563324, -0.026143476366996765, 0.03326505422592163, 0.03397876396775246, -0.018478861078619957, -0.01279246062040329, -0.03180660307407379, 0.013909570872783661, -0.004006856586784124, 0.026019353419542313, -0.03103083372116089, -0.018044428899884224, -0.0593930147588253, -0.0016281490679830313, -0.012505426071584225, 0.0048951138742268085, -0.03891266509890556, -0.0047205653972923756, 0.033513300120830536, -0.0014012360479682684, 0.03816792368888855, -0.016042940318584442, -0.01024017482995987, 0.0005391607410274446, -0.03602679818868637, 0.0045537748374044895, -0.00714484928175807, 0.015282685868442059, 5.400092413765378e-05, -0.03912987932562828, -0.01669458858668804, -0.0685160830616951, 0.04120894521474838, 0.008130078203976154, 0.02052689716219902, -0.015717117115855217, 0.02255941554903984, 0.006291501689702272, -0.04676346480846405, -0.07248802483081818, 0.009464404545724392, -0.034320101141929626, -0.017904790118336678, 0.031015317887067795, 0.023754103109240532, -0.0283932127058506, -0.07484637200832367, -0.0038109743036329746, -0.017935821786522865, 0.06578536331653595, 0.02324209362268448, -0.025910746306180954, -0.045242954045534134, 0.00141481205355376, -0.0025445283390581608, -0.06541299819946289, -0.010418602265417576, -0.030363669618964195, 0.024141987785696983, 0.04291564226150513, 0.03608885779976845, -0.037423186004161835, -0.016430826857686043, -0.018804684281349182, -0.0013556595658883452, -0.03422700986266136, -0.05014582723379135, 0.029339652508497238, -0.03549927473068237, 0.04176750034093857, -0.006097558885812759, -0.017718605697155, 0.0026085295248776674, 0.022699054330587387, -0.007780981250107288, 0.0023816165048629045, 0.019844217225909233, 0.04201574996113777, 0.01169862411916256, 0.006260470487177372, -0.004499470815062523, -0.007943893782794476, 0.03975049778819084, 0.008215413428843021, 0.014025936834514141, 0.025802137330174446, -0.03050330840051174, -0.0440327525138855, -0.000848499359562993, 0.016446340829133987, -0.029867177829146385, -0.05507972836494446, -0.018354738131165504, 0.039564311504364014, 0.014320729300379753, 0.009697135537862778, 0.01695835031569004, -0.02110096625983715, -0.01010829396545887, -0.01145037729293108, 0.027601925656199455, 0.023024877533316612, 0.01784272864460945, -0.02148885279893875, 0.003328056773170829, 0.04412584379315376, -0.03338917717337608, -0.00439086277037859, -0.03160490468144417, -0.03816792368888855, 0.006291501689702272, 0.006966422311961651, -0.029448261484503746, -0.05970332399010658, 0.006307017058134079, 0.014219879172742367, 0.026903731748461723, -0.05517282336950302, 0.0010143204126507044, -0.03397876396775246, -0.004871841054409742, -0.033513300120830536, -0.011822747066617012, 0.015228381380438805, -0.015949849039316177, 0.0643579512834549, -0.016601495444774628, -0.037268031388521194, -0.003880793694406748, 0.0023389491252601147, -0.0029983543790876865, -0.04772542044520378, 0.011419346556067467, 0.04955624043941498, -0.04834603890776634, -0.05045613646507263, 0.032054852694272995, -0.03410288691520691, 0.007823648862540722, 0.036461230367422104, 0.014134544879198074, 0.03975049778819084, 0.028951767832040787, -0.03137217089533806, 0.03931606560945511, 0.0019820944871753454, 0.010969399474561214, 0.01289331167936325, -0.003632546868175268, -0.0059540411457419395, -0.057903535664081573, -0.058400027453899384, -0.015158561989665031, -0.023071425035595894, 0.01148916594684124, 0.018230615183711052, 0.03134114295244217, -0.02068204991519451, 0.013808720745146275, 0.01909947767853737, 0.004002977628260851, 0.04021596163511276, -0.0429777055978775, -0.005876463837921619, 0.012365787290036678, -0.07124679535627365, -0.030286094173789024, 0.032892681658267975, 0.012435606680810452, 0.0025774985551834106, 0.016585979610681534, -0.008680875413119793, -0.011768443509936333, 0.032396189868450165, 0.06882638484239578, 0.020278649404644966, 0.019673548638820648, 0.012055478990077972, 0.017129020765423775, -0.030782585963606834, 0.009627316147089005, -0.029293106868863106, -0.0024979820009320974, -0.0061091952957212925, 0.002129490952938795, 0.009053245186805725, 0.009829016402363777, 0.01568608544766903, -0.003925400320440531, 0.009061003103852272, -0.03095325641334057, -0.010969399474561214, 0.031558357179164886, 0.02052689716219902, 0.012342513538897038, -0.012978645972907543, 0.037609368562698364, -0.021225089207291603, -0.028362181037664413, 0.022699054330587387, 0.02819151245057583, -0.05650714784860611, 0.024498842656612396, 0.04331904277205467, -0.06404764205217361, 0.036306075751781464, -0.06988143920898438, -0.029603414237499237, 0.0513249970972538, 0.03782658651471138, 0.019689064472913742, -0.017594482749700546, -0.030627433210611343, -0.010837518610060215, 0.02394028753042221, -0.004972691182047129, 0.002387434709817171, -0.011496923863887787, 0.011015946045517921, -0.007369822822511196, -0.03723699972033501, -0.07341895252466202, 0.03636813536286354, -0.03720596805214882, -0.038726478815078735, -0.014530187472701073, 0.010178113356232643, -0.023583432659506798, -0.002205128548666835, -0.014413822442293167, 0.04443615302443504, -0.000910561007913202, -0.0165394339710474, 0.07155710458755493, -0.011512438766658306, 0.037764523178339005, -0.02996026910841465, -0.014173333533108234, -0.028672490268945694, -0.01436727587133646, 0.018711593002080917, -0.04238811880350113, 0.03925400599837303, -0.03199278935790062, -0.027400225400924683, 0.058710336685180664, 0.02712094783782959, 0.0050502680242061615, -0.002984778257086873, 0.025771107524633408, -0.044746462255716324, 0.003531696740537882, -0.004930023569613695, 0.04434306174516678, -0.02639172412455082, 0.00020970054902136326, -0.08583128452301025, -0.029991300776600838, -0.00034158158814534545, 0.01698938198387623, 0.016136033460497856, 0.03993668407201767, 0.05607271566987038, 0.03388566896319389, 0.021069936454296112, 0.017051443457603455, 0.007641342934221029, -0.020852720364928246, -0.011690866202116013, 0.05141809210181236, -0.020806172862648964, 0.014956861734390259, 0.036119889467954636, -0.0019083962542936206, -0.05163530632853508, -0.014072482474148273, -0.06404764205217361, 0.03605782985687256, 0.02769501879811287, 0.06190651282668114, 0.012396818026900291, 0.03298577666282654, 0.00722242658957839, 0.019083961844444275, 0.028827644884586334, -0.03463041037321091, -0.007416369393467903, -0.0006337077938951552, 0.024467812851071358, -0.007881831377744675, 4.7122019168455154e-05, -0.0362129807472229, 0.029277591034770012, 0.02136472798883915, 0.008944638073444366, -0.01729968935251236, 0.00046303821727633476, -0.01826164498925209, -0.0038963090628385544, -0.043753474950790405, -0.02992923930287361, -0.002951808040961623, -0.006000587251037359, 0.0025038004387170076, -0.09625764191150665, -0.03211691230535507, 0.020728597417473793, 0.014762919396162033, -0.042946673929691315, 0.007967166602611542, 0.011326254345476627, -0.035809580236673355, 0.028207028284668922, 0.019595971331000328, -0.024762604385614395, -0.045367076992988586, 0.003283450147137046, -0.005682521499693394, 0.03525102511048317, 0.0017813637387007475, -0.007870195433497429, 0.011504681780934334, -0.011248677037656307, 0.01995282620191574, 0.008285232819616795, 0.005182149354368448, 0.021116482093930244, 0.0010569877922534943, -0.006578536704182625, 0.06134795770049095, -0.007389217149466276, -0.04288461059331894, -0.0036306073889136314, -0.01630670204758644, 0.002399071352556348, 0.017082473263144493, -0.0016620890237390995, 0.0468875877559185, -0.025646984577178955, 0.02493327483534813, -0.016136033460497856, -0.020076949149370193, 0.041643377393484116, 0.003665517084300518, -0.02063550427556038, 0.010930610820651054, 0.007047878112643957, -0.025864198803901672, -0.024607451632618904, 0.0062643494457006454, -0.010154840536415577, 0.0024611330591142178, 0.004522744100540876, 0.0012528698425740004, 0.03540617972612381, -0.006229439750313759, -0.024312658235430717, -0.033358145505189896, -0.001517601660452783, -0.03705081343650818, -0.020247619599103928, -0.029634445905685425, 0.014646553434431553, -0.0017076655058190227, 0.014995650388300419, -0.047353051602840424, 0.013164831325411797, 0.03279959037899971, -0.0003520060272421688, 0.03391670063138008, 0.030146455392241478, 0.006559142377227545, -0.011752927675843239, 0.019689064472913742, -0.033202990889549255, 0.01756345108151436, 0.005488578695803881, -0.013793205842375755, 0.022109469398856163, -0.02290075458586216, 0.007982681505382061, -0.01581021025776863, -0.003407573327422142, -0.028207028284668922, 0.019999371841549873, 0.02884315885603428, 0.03373051434755325, -0.0055933077819645405, 0.006807389203459024, 0.004790384788066149, -0.002139188116416335, -0.02654687874019146, 0.03990565240383148, -0.017284173518419266, -0.005061904899775982, 0.03553030267357826, -0.011768443509936333, -0.0010598968947306275, 0.004627473186701536, 0.003221388440579176, 0.02394028753042221, 0.012614034116268158, 0.030099907889962196, 0.014072482474148273, -0.01990627869963646, -0.027307134121656418, -0.01147365104407072, -0.05684848502278328, -0.006194530054926872, 0.037112876772880554, 0.010271205566823483, -0.026872701942920685, 0.01336653158068657, -0.048780471086502075, 0.013141557574272156, 0.017439328134059906, -0.03916091099381447, -0.010496179573237896, -0.0165394339710474, -0.005519609432667494, -0.042295027524232864, 0.03497174754738808, 0.03252031281590462, 0.014553461223840714, 0.002317615319043398, -0.05554519221186638, -0.03931606560945511, 0.03199278935790062, -0.050394073128700256, 0.03183763474225998, 0.015554205514490604, 0.0012131116818636656, -0.04744614288210869, -0.03487865626811981, 0.016772165894508362, -0.004724444355815649, -0.022730085998773575, -0.01902190037071705, 0.014514672569930553, -0.017330721020698547, -0.03559236600995064, 0.008960152976214886, 0.022605961188673973, 0.01995282620191574, -0.009270461276173592, 0.0024844061117619276, -0.005019237287342548, -0.04446718469262123, 0.042946673929691315, 0.04933902621269226, 0.03447525575757027, 0.03670947626233101, -0.016710104420781136, -0.0239713191986084, 0.003068173537030816, -0.02750883437693119, 0.004123222082853317, 0.012047721073031425, 0.02321106381714344, -0.025072913616895676, -0.013746659271419048, -0.01131849642843008, 0.0028451394755393267, 0.0341339148581028, -0.034164946526288986, 0.002583316992968321, -0.0016329976497218013, 0.010666849091649055, -0.0020519138779491186, 0.021069936454296112, -0.014568976126611233, 0.015166319906711578, 0.020511381328105927, -0.017051443457603455, 0.029168983921408653, -0.018199583515524864, -0.056258901953697205, -0.019052932038903236, 0.01137279998511076, -0.03590267524123192, 0.007261214777827263, -0.03878854215145111, -0.03670947626233101, 0.0036092738155275583, 0.038229987025260925, 0.05182149261236191, -0.026252085343003273, -0.02010798081755638, 0.0022477959282696247, -0.01883571594953537, 0.004770990461111069, 0.006574657745659351, 0.016834227368235588, 0.006753085181117058, -0.013506170362234116, -0.007199153304100037, -0.028765583410859108, 0.0004964933614246547, 0.026795124635100365, 0.01474740356206894, -0.0023389491252601147, 0.03248928114771843, 0.019999371841549873, -0.037081845104694366, -0.008370567113161087, -0.008455902338027954, 0.0035898794885724783, 0.002048034919425845, 0.06203063577413559, 0.00901445746421814, 0.018711593002080917, 0.006760842632502317, 0.04030905291438103, -0.03549927473068237, 0.023335186764597893, -0.02048034965991974, -0.02389374189078808, 0.018354738131165504, -0.0726742148399353, -0.01698938198387623, -0.017330721020698547, 0.03214794397354126, 0.06190651282668114, 0.036430198699235916, 0.007102182134985924, -0.026795124635100365, -0.04322595149278641, -0.006962543353438377, 0.014739645645022392, -0.0021450063213706017, -0.02466951310634613, 0.012761429883539677, 0.03003784641623497, 0.03636813536286354, -0.028300119563937187, 0.01615154929459095, -0.009348038583993912, 0.031046349555253983, 0.002808290533721447, -0.012862280011177063, -0.008060258813202381, -0.005965677555650473, -0.03397876396775246, -0.03186866641044617, -0.01776515133678913, 0.033544331789016724, 0.019782155752182007, -0.011760685592889786, 0.0027636836748570204, 0.02907589077949524, -0.013925086706876755, 0.042326055467128754, -0.017020411789417267, 0.04493264853954315, -0.03034815564751625, -0.027260586619377136, -0.020263133570551872, -0.03162042051553726, -0.008587783202528954, -0.025197036564350128, -0.004697292577475309, -0.014584491960704327, 0.006485444027930498, 0.009417857974767685, -0.012590760365128517, -0.0067996312864124775, -0.03816792368888855, -0.00884378794580698, -0.003211691277101636, -0.009922108612954617, -0.02704337053000927, 0.010488421656191349, 0.014103514142334461, -0.0014836617046967149, -0.11872396618127823, -0.005442032590508461, 0.02811393514275551, -0.002808290533721447, -0.015748148784041405, -0.0063031380996108055, 0.0015379657270386815, 0.04055729880928993, 0.029789600521326065, -0.0015573599375784397, -0.006380714941769838, -0.011675351299345493, 0.001997609855607152, -0.00993762444704771, 0.01787376031279564, -0.036926690489053726, 0.022031892091035843, 0.011962385848164558, 0.005065783392637968, -0.035468243062496185, -0.0369887538254261, 0.0006899511790834367, 0.00422019325196743, 0.034195978194475174, -0.024452297016978264, -0.014662068337202072, -0.015724875032901764, -0.02075962722301483, 0.03149629756808281, -0.0033513300586491823, -0.015368020161986351, 0.03267546743154526, 0.009146338328719139, 0.03556133434176445, 0.013529443182051182, -0.007024604827165604, -0.040681421756744385, -0.017889276146888733, 0.01020138617604971, -0.007369822822511196, -0.01626015640795231, -0.027819141745567322, 0.021085450425744057, -0.006659992504864931, 0.020014887675642967, -0.006272107362747192, -0.0055933077819645405, -0.0009900775039568543, 0.01428969856351614, -0.0019025779329240322, 0.01937875524163246, 0.002994475420564413, 0.012652822770178318, 0.018804684281349182, 0.020899266004562378, 0.009805743582546711, -0.0021547034848481417, 0.008114563301205635, 0.023847196251153946, -0.02113199792802334, 0.030394701287150383, 0.010341024957597256, 0.012342513538897038, -0.03141871839761734, -0.0015563901979476213, -0.008991183713078499, -0.017889276146888733, 0.04483955353498459, 0.012008932419121265, 4.36674126831349e-05, -0.026298630982637405, -0.02075962722301483, -0.002119793789461255, 0.0027908356860280037, 0.0045537748374044895, 0.025228068232536316, 0.010736668482422829, -0.008758452720940113, -0.01031775213778019, 0.016865257173776627, 0.027493318542838097, 0.004724444355815649, -0.004243466537445784, 0.003033264074474573, -0.0052636051550507545, -0.01306398119777441, -0.0065862941555678844, -0.039688434451818466, 0.01444485317915678, -0.007784860208630562, 0.020123494789004326, -0.009829016402363777, 0.014910315163433552, 0.015352505259215832, 0.018137522041797638, -0.027369195595383644, -0.0023835559841245413, -0.008548994548618793, 0.03962637484073639, 0.004546016920357943, 0.012070993892848492, 0.010154840536415577, 0.01868056133389473, -0.05051819607615471, -0.021054420620203018, 0.005814402364194393, 0.004705050028860569, -0.015965363010764122, -0.003489029360935092, -0.0203251950442791, -0.0013391744578257203, 0.014033694751560688, -0.0026027110870927572, 0.01281573437154293, 0.00715648615732789, -0.012676095589995384, 0.04446718469262123, 0.0040184929966926575, -0.0035161813721060753, -0.030720524489879608, 0.0004021886852569878, 0.022202560678124428, 0.02274559997022152, -0.012396818026900291, -0.0309998020529747, 0.004848567768931389, 0.01729968935251236, 0.0260503850877285, 0.008680875413119793, 0.005461426451802254, -0.02209395356476307, 0.013071738183498383, -0.005174391437321901, 0.028563881292939186, 0.025693530216813087, -0.0369887538254261, 0.001039532944560051, 0.0050114793702960014, -0.009829016402363777, 0.019595971331000328, 0.0022788268979638815, 0.0014468126464635134, 0.03996771201491356, -1.5576024452457204e-05, 0.001885123085230589, 0.04803572967648506, -0.02915346808731556, -0.020992359146475792, -0.006004466209560633, 0.017718605697155, 0.014848253689706326, -0.018137522041797638, 0.005248089786618948, 0.022761115804314613, 0.02156643010675907, 0.03338917717337608, -0.004751596134155989, 0.018804684281349182, 0.01103146094828844, 0.06100661680102348, 0.039036788046360016, 0.00427837623283267, 0.025460798293352127, 0.003971946891397238, 0.015290442854166031, -0.0082697169855237, -0.016865257173776627, -0.020728597417473793, 0.01841679960489273, 0.0012441424187272787, -0.005837675649672747, 0.01427418366074562, 0.022761115804314613, 0.00868863333016634, 0.026329662650823593, 0.027027856558561325, 0.011194373480975628, -0.008735179901123047, 0.002581377513706684, 0.011830504983663559, -0.008983426727354527, 0.014413822442293167, -0.007850800640881062, 0.018959838896989822, 0.03909885138273239, 0.001318810391239822, 0.021892253309488297, 0.02420404925942421, -0.015717117115855217, 0.010496179573237896, 0.03463041037321091, 0.047477174550294876, 0.005635974928736687, -0.003799337660893798, -0.0006754054920747876, -0.019673548638820648, 0.0560106560587883, 0.00884378794580698, -0.007590917404741049, -0.003304783720523119, 0.03962637484073639, 0.035778552293777466, 0.0026124082505702972, -0.011558985337615013, -0.01043411809951067, 0.05728291720151901, -0.02013901062309742, -0.028641458600759506, -0.012202875688672066, 0.03391670063138008, -0.015150804072618484, 0.018742622807621956, -0.029743053019046783, 0.011264192871749401, -0.03652328997850418, 0.012730399146676064, 0.003785761771723628, 0.010209144093096256, 0.023428279906511307, -0.00570579431951046, -0.009565254673361778, -0.04139513149857521, -0.012187359854578972, 0.03618195280432701, 0.016058456152677536, 0.005864827428013086, -0.009635074064135551, -0.00834729429334402, -0.013343258760869503, -0.020387258380651474, 0.006388472858816385, 0.015042196027934551, -0.018044428899884224, 0.01760999858379364, -0.013257923536002636, 0.0033396934159100056, 0.008719664067029953, -0.012039963155984879, -0.025212552398443222, 0.013614778406918049, 0.033668454736471176, 0.045056771486997604, -0.011008188128471375, 0.0027908356860280037, -0.005306272301822901, 0.011295223608613014, 0.038385141640901566, 0.010907338000833988, -0.0006467989296652377, -0.022854208946228027, -0.008324021473526955, -0.002416526200249791, 0.034847624599933624, -0.028051873669028282, -0.02428162656724453, -0.0380438007414341, 0.02029416523873806, 0.02355240285396576, -0.011078007519245148, 0.030441246926784515, -0.003931218758225441, 0.04266739636659622, 0.01956493966281414, -0.022854208946228027, 0.02136472798883915, -0.0023331306874752045, 0.00031127803958952427, -0.016772165894508362, 0.004879598505795002, 0.016632527112960815, -0.008486933074891567, 0.018090976402163506, 0.01567832939326763, -0.00847917515784502, 0.0015088742366060615, 0.009138580411672592, 0.036957722157239914, -0.041302040219306946, 0.025910746306180954, -0.05408674106001854, -0.018509892746806145, -0.011326254345476627, 0.01868056133389473, 0.01099267229437828, 0.015042196027934551, -0.01436727587133646, -0.04207780957221985, -0.043753474950790405, 0.042108841240406036, -0.02359894849359989, 0.022109469398856163, -0.0030293851159512997, 0.000388370273867622, 0.004030129406601191, 0.01857195422053337, 0.010325510054826736, 0.009068761020898819, 0.009805743582546711, 0.03236515820026398, -0.025848684832453728, 0.0032136307563632727, 0.014010421000421047, 0.01586451381444931, -0.020573442801833153, 0.020852720364928246, 0.04542914032936096, 0.02884315885603428, -0.03376154601573944, -0.02198534458875656, -0.029975784942507744, 0.021721582859754562, 0.031511809676885605, 0.01285452302545309, 0.009891077876091003, -0.009565254673361778, 0.025134975090622902, 0.012474395334720612, -0.04102276265621185, -0.015546447597444057, -0.005701915826648474, 0.0066522350534796715, 0.011752927675843239, -0.0009876532712951303, 0.02206292189657688, 0.005798886995762587, 0.0027617441955953836, -0.019239116460084915, -0.012769187800586224, -0.01972009427845478, -0.017346234992146492, -0.01826164498925209, 0.002112036105245352, 0.029525838792324066, 0.008292989805340767, -0.023226579651236534, -0.0046895346604287624, 0.0016805136110633612, 0.015779178589582443, -0.03847823292016983, -0.014359517954289913, 0.007940014824271202, 0.022683538496494293, 0.008261959068477154, 0.04918387159705162, -0.0025503465440124273, 0.008471417240798473, -0.029510322958230972, -0.006931512616574764, 0.011745170690119267, -0.006842298898845911, 0.11711036413908005, -0.02904485911130905, -0.02490224316716194, 0.010853033512830734, 0.0025134976021945477, -0.00017139686679001898, -0.003209751797839999, 0.007951650768518448, -0.044715430587530136, -0.00588810071349144, -0.03844720125198364, 0.001313961809501052, 0.006190651096403599, -0.005081298761069775, 0.004119343124330044, 0.02854836732149124, -0.011295223608613014, 0.02896728366613388, 0.011807232163846493, 0.028610428795218468, 0.004235708620399237, 0.01899087056517601, -0.01657046563923359, -0.007877952419221401, 0.017935821786522865, 0.031217018142342567, -0.01633773371577263, 0.007036241237074137, 0.006574657745659351, 0.005065783392637968, -0.013987148180603981, -0.02972753904759884, 0.003242722013965249, 0.02021658793091774, 0.012187359854578972, 0.004053402692079544, -0.03652328997850418, 0.002387434709817171, -0.005442032590508461, 0.008409355767071247, -0.032054852694272995, 0.02425059676170349, 0.012551971711218357, 0.0013440229231491685, -0.040371112525463104, -0.012505426071584225, -0.00036218800232745707, -0.014033694751560688, -0.016896288841962814, 0.0016892410349100828, -0.020542411133646965, 0.00010472906433278695, -0.009510950185358524, -0.014266425743699074, -0.004642988555133343, -0.026826156303286552, -0.0032776317093521357, 0.04111585393548012, 0.024498842656612396, 0.008052500896155834, -0.03180660307407379, -0.02328864112496376, -0.030177485197782516, 0.026764092966914177, -0.007916741073131561, -0.02881212905049324, -0.005748461931943893, 0.023723071441054344, -0.0237075574696064, 0.013475139625370502, 0.0064776865765452385, -0.015934333205223083, 0.007812012452632189, -0.013436350971460342, -0.021799160167574883, -0.008044743910431862, -0.01279246062040329, 0.01181499008089304, 0.021659521386027336, 0.03767143189907074, 0.015779178589582443, -0.012567487545311451, 0.0015020862920209765, -0.003572424640879035, -0.008587783202528954, -0.02462296560406685, 0.011962385848164558, -0.017625512555241585, -0.007897347211837769, 0.004293891601264477, 0.01060478761792183, 0.02263699285686016, -0.0031845392659306526, -0.009487677365541458, -0.004945538938045502, -0.0030429610051214695, -0.005364455282688141, -0.02151988260447979, 0.013754417188465595, -0.0033299962524324656, 0.04282255098223686, 0.006155741401016712, -0.0032989655155688524, 0.01925463229417801, -0.05666230246424675, -0.017811698839068413, -0.03565442934632301, -0.01917705498635769, -0.011287465691566467, -0.003089507343247533, 0.0030739919748157263, -0.0046895346604287624, 0.02055792696774006, 0.00965058896690607, -0.009596285410225391, -0.006179014686495066, -0.00417364714667201, 0.023273125290870667, 0.011520196683704853, -0.04803572967648506, 0.035809580236673355, -0.016523918136954308, 0.022342199459671974, -0.029479291290044785, 0.009386827237904072, -0.00864984467625618, 0.0012266876874491572, 0.030317123979330063, -0.034382164478302, -0.012839007191359997, 0.0037004267796874046, 0.012133056297898293, 0.019083961844444275, -0.004068918060511351, 0.02826908975839615, 0.02857939712703228, -0.005054146982729435, -0.019130509346723557, -0.0328306220471859, 0.0032582376152276993, 0.013397562317550182, 0.044901616871356964, 0.003971946891397238, 0.005189906805753708, 0.01995282620191574, 0.026748578995466232, -0.0020422167144715786, -0.012420090846717358, -0.017004895955324173, -0.0024242838844656944, -0.004274497274309397, -0.014072482474148273, -0.01525165420025587, 0.017718605697155, -0.01695835031569004, -0.017423812299966812, 0.015305958688259125, -0.013413078151643276, -0.006702660117298365, -0.013281196355819702, -0.0025581042282283306, 0.001632027910090983, 0.006237197667360306, 0.00283932127058506, 0.0237075574696064, -0.013707870617508888, -0.021845705807209015, -0.006252713035792112, 0.026096930727362633, -0.006675507873296738, 0.018122006207704544, -0.007129333913326263, -0.004518865142017603, -0.0043792263604700565, 0.002181855496019125, -0.003558848751708865, -0.0007006180239841342, 0.022342199459671974, -0.015375778079032898, -0.009658346883952618, 0.011155584827065468, -0.012800218537449837, 0.0016388158546760678, 0.007552129216492176, 0.0009003790328279138, 0.005577792413532734, -0.022295653820037842, -0.0011074128560721874, 0.01143486239016056, -0.004480076488107443, 0.02738470956683159, -0.02193879894912243, -0.012924342416226864, -0.031279079616069794, 0.009099791757762432, 0.03950225189328194, -0.006435018964111805, 0.03779555484652519, -0.00044509852887131274, -0.013095011934638023, 0.02954135276377201, -0.02425059676170349, -0.018199583515524864, -0.022435292601585388, 0.03540617972612381, -0.0010909277480095625, -0.0056010652333498, 0.019999371841549873, 0.007424126844853163, -0.020201072096824646, 0.03134114295244217, 0.00461195781826973, -0.0030216274317353964, 0.01300191879272461, 0.004739959724247456, 0.03267546743154526, -0.006776358466595411, 0.031589388847351074, -0.00289556453935802, -0.006900481414049864, -0.017578966915607452, 0.011954628862440586, 0.04595666378736496, -0.02808290347456932, -0.01302519254386425, 0.023924771696329117, -0.013459623791277409, -0.007715040817856789, 0.002100399462506175, -0.007284488063305616, 0.00815335102379322, -0.032706499099731445, 0.022187046706676483, -0.028719035908579826, 0.022047407925128937, -0.01164432056248188, -0.023117970675230026, -0.006194530054926872, 0.0036829719319939613, -0.022574931383132935, -0.004045644775032997, 0.02217153087258339, -0.008696391247212887, 0.011163342744112015, -0.020154526457190514, 0.024653997272253036, -0.00851796381175518, 0.026577908545732498, -0.028594912961125374, 0.06429588794708252, 0.03373051434755325, 0.022962816059589386, -0.0012334756320342422, -0.025864198803901672, 0.008223170414566994, -0.010085021145641804, 0.013475139625370502, -0.028362181037664413, 0.0048951138742268085, -0.01016259752213955, -0.049121808260679245, 0.020201072096824646, 0.03453731909394264, -0.009099791757762432, 0.002007307019084692, -0.014987892471253872, -0.007629706058651209, 0.022761115804314613, -0.0019054871518164873, 0.009681619703769684, -0.012264937162399292, 0.014941345900297165, 0.016942834481596947, -0.021845705807209015, 0.023583432659506798, 0.044715430587530136, -0.019533909857273102, -0.009247188456356525, -0.001985973445698619, -0.016523918136954308, 0.006435018964111805, 0.005228695459663868, 0.017237627878785133, -0.007257336284965277, -0.0024475569371134043, 0.04366038367152214, -0.005131724290549755, 0.004778748378157616, 0.017160050570964813, -0.003789640497416258, 0.02328864112496376, -0.012404575943946838, 0.0028645338024944067, -0.014638795517385006, -0.009627316147089005, -1.0598665539873764e-05, -0.007889589294791222, -0.029665477573871613, -0.004964933265000582, 0.031930726021528244, -0.023195547983050346, 0.00851796381175518, -0.046980682760477066, -0.008525721728801727, 0.0022574930917471647, 0.011334012262523174, -0.009472161531448364, 0.03267546743154526, 0.0019268208416178823, -0.0025406493805348873, -0.022605961188673973, -0.009549738839268684, -0.029479291290044785, 0.028175996616482735, 0.0008834090549498796, -0.009526466019451618, -0.005034752655774355, 0.017780667170882225, 0.0033319357316941023, 0.02324209362268448, -0.012877795845270157, -0.01787376031279564, -0.011403831653296947, 0.0010501997312530875, 0.008238686248660088, -0.03779555484652519, -0.01010829396545887, 0.04189162328839302, 0.0011510499753057957, -0.02013901062309742, 0.013071738183498383, -0.023583432659506798, 0.03196175768971443, 0.0021896131802350283, 0.010915095917880535, -0.005213180091232061, -0.00037915800930932164, 0.018432315438985825, 0.02738470956683159, -0.035157933831214905, -0.024110957980155945, -0.02010798081755638, -0.028703520074486732, 0.00020279134332668036, 0.0009978351881727576, 0.026686517521739006, -0.02636069245636463, -0.04657728224992752, -0.0002513982472009957, -0.021085450425744057, -0.0011074128560721874, -0.00580276595428586, -0.006369078531861305, 0.008168866857886314, 0.03422700986266136, 0.007377580739557743, 0.016679072752594948, 0.014592248946428299, -0.020170042291283607, -0.013731143437325954, -0.003704305738210678, -0.04676346480846405, 0.030177485197782516, 0.005957920104265213, -0.005341181997209787, -0.006609567441046238, -0.011209888383746147, -0.006225560791790485, -0.010550483129918575, -0.0075366138480603695, -0.005061904899775982, 0.046670373529195786, 0.03788864612579346, 0.031899698078632355, -0.007548250257968903, -0.004836931359022856, -0.02636069245636463, -0.02206292189657688, 0.005356697831302881, -0.024343688040971756, 0.009278219193220139, -0.028020842000842094, -0.02912243641912937, -0.0010647454764693975, 0.004565411247313023, -9.897138806991279e-05, -0.0003794004151131958, 0.003919582348316908, 0.02055792696774006]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"
0.00.20.40.60.81.0 (xlvii) Layer 46
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 47
0.00.20.40.60.81.0 (xlviii) Layer 47
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 48
0.00.20.40.60.81.0
(xlix) Layer 48
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 49
0.00.20.40.60.81.0 (l) Layer 49
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 50
0.00.20.40.60.81.0 (li) Layer 50
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 51
0.00.20.40.60.81.0
(lii) Layer 51
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 52
0.00.20.40.60.81.0 (liii) Layer 52
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 53
0.00.20.40.60.81.0 (liv) Layer 53
Figure 15. Activations of OPT-66B16
Runtime Clustered Head Attention for Efficient Inference
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 54
0.00.20.40.60.81.0
(lv) Layer 54
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 55
0.00.20.40.60.81.0 (lvi) Layer 55
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 56
0.00.20.40.60.81.0 (lvii) Layer 56
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 57
0.00.20.40.60.81.0
(lviii) Layer 57
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
","[0.03147732466459274, 0.016229279339313507, 0.028128672391176224, 0.006946505047380924, 0.010949311777949333, -0.00036552868550643325, 0.04061992093920708, -0.0228487066924572, -0.015053356997668743, -0.027038414031267166, 0.046008914709091187, 0.01205514557659626, -0.013729470781981945, -0.0014387520495802164, 0.006304031237959862, -0.006011997815221548, 0.018409796059131622, -0.03230280429124832, -0.01842537149786949, 0.0626431480050087, -0.02330038510262966, -0.006498720031231642, -0.0015205213567242026, 0.004364928230643272, 0.031041219830513, -0.0009486223571002483, 0.0011369839776307344, -0.0072463261894881725, 0.057378754019737244, -0.027832744643092155, 0.028611501678824425, -0.04432680085301399, -0.005649875849485397, -0.04993384703993797, -0.029374683275818825, 0.015909988433122635, 0.0005602177116088569, 0.021384643390774727, -0.029826361685991287, -0.009049146436154842, 0.033268462866544724, -0.06301695108413696, -0.03566703200340271, -0.011182938702404499, 0.020699338987469673, 0.0021435264497995377, -5.332654473022558e-05, -0.013706108555197716, 0.018783599138259888, 0.04367264732718468, -0.026244083419442177, 0.027256466448307037, -0.03339306265115738, 0.04252008721232414, -0.03152405098080635, 0.02358073741197586, 0.01383849699050188, 0.0354178287088871, 0.07282927632331848, -0.011922757141292095, 0.03850170597434044, 0.013122041709721088, 0.02235030196607113, -0.025574352592229843, 0.008940121158957481, 0.011354264803230762, -0.0725177749991417, 0.011829306371510029, 0.05086835101246834, 0.001743440399877727, -0.021633846685290337, 0.0611167848110199, 0.012023995630443096, 0.004730943590402603, 0.0016285738674923778, 0.03125927224755287, -0.007666854653507471, -0.0010863648494705558, -0.0026964431162923574, -0.037068791687488556, 0.025340724736452103, 0.010816923342645168, 0.07295387983322144, -0.028144247829914093, 0.03354881703853607, -0.027085138484835625, -0.0472237728536129, -0.015777599066495895, -0.046040065586566925, -0.021431369706988335, -0.026041606441140175, 0.007339776959270239, -0.0269449632614851, -0.031695377081632614, -0.009095871821045876, -0.035012878477573395, -0.0028521944768726826, -0.018098292872309685, 0.002423878526315093, -0.0020968010649085045, 0.05460638180375099, 0.012958502396941185, 0.03725569322705269, -0.003985284827649593, 0.027786020189523697, -0.002011137781664729, -0.002957326592877507, 0.005941909737884998, -0.05058800056576729, 0.003418739652261138, -0.05080605298280716, 0.0028950260020792484, -0.021104292944073677, 0.03588508442044258, 0.03566703200340271, -0.030901044607162476, -0.015551760792732239, 0.00247255084104836, -0.01978040672838688, -0.011058337986469269, -0.026617886498570442, -0.04410874843597412, 0.021929774433374405, -0.003152015618979931, -0.023284809663891792, -0.04660077020525932, 0.04575971141457558, -0.035760484635829926, -0.04466945305466652, -0.04769102856516838, 0.028813978657126427, 0.02101084217429161, 0.056288495659828186, -0.028409024700522423, -0.02231915108859539, 0.023534011095762253, 0.0045128921046853065, 0.07669191062450409, -0.043018490076065063, -0.007296945434063673, -0.018581122159957886, -0.03766064718365669, 0.020091909915208817, 0.034016069024801254, 0.014188936911523342, 0.06127253547310829, -0.04498095437884331, 0.03675729036331177, -0.05058800056576729, 0.05061915144324303, 0.006736240815371275, -0.0023498968221247196, -0.030075563117861748, -0.011190726421773434, -0.017070334404706955, -0.05775255709886551, -0.01876802369952202, 0.03591623529791832, 0.006140492390841246, 0.029873086139559746, 0.003909355960786343, -0.016836708411574364, 0.04379724711179733, 0.0017882188549265265, -0.009687726385891438, 0.03865745663642883, 0.001964412396773696, 0.02002960816025734, -0.09762487560510635, -0.031461749225854874, 0.014336900785565376, 0.003847055369988084, -0.04772217944264412, -0.004723156336694956, -0.014687341637909412, 0.006268986966460943, -0.014165574684739113, 0.024468518793582916, -0.0037867019418627024, 0.005392886232584715, 0.018160594627261162, 0.05202091112732887, 0.012670362368226051, 0.033455364406108856, -0.03283236175775528, -0.017319537699222565, 0.006428631953895092, 0.0011068071471527219, 0.025262849405407906, -0.0032298911828547716, -0.007573403883725405, 0.008644193410873413, 0.06317269802093506, 0.024499669671058655, 0.012514611706137657, -0.0599953755736351, 0.05382762476801872, -0.013900797814130783, 0.012280984781682491, 0.001229461282491684, 0.016042377799749374, 0.0021649422124028206, 0.05413912981748581, -0.028299998492002487, 0.011907181702554226, 0.0027236996684223413, -0.012639212422072887, -0.005762795452028513, 0.0348571240901947, 0.004664749372750521, 0.058624763041734695, -0.06180208921432495, 0.03107237070798874, -0.011720280162990093, -0.04077567160129547, 0.013815134763717651, -0.04102487489581108, -0.02052801288664341, -0.006751815788447857, -0.009983654133975506, 0.00796667579561472, 0.0590297169983387, 0.018877049908041954, 0.03354881703853607, -0.014944330789148808, 0.04108717665076256, 0.034763675183057785, -0.02099526673555374, -0.006561020854860544, -0.03339306265115738, 0.02671133726835251, -0.013215492479503155, 0.029359107837080956, -0.0274277925491333, -0.009578701108694077, -0.04392184689640999, 0.010606658644974232, -0.004290946293622255, -0.0035063496325165033, -0.026119481772184372, -0.009461887180805206, 0.028066372498869896, 0.013441331684589386, 0.025262849405407906, -0.016322730109095573, -0.004213070962578058, -0.0011545059969648719, -0.0399969182908535, 0.012109658680856228, -0.01551282312721014, 0.0027451154310256243, 0.006280668545514345, -0.043485745787620544, -0.018783599138259888, -0.07756411284208298, 0.030869893729686737, 0.007939418777823448, 0.017039185389876366, -0.005595363210886717, 0.016821132972836494, 0.0111440010368824, -0.04445140063762665, -0.06460560858249664, 0.019032800570130348, -0.041710179299116135, -0.02900088019669056, 0.03482597693800926, 0.024561969563364983, -0.05080605298280716, -0.06230049207806587, -0.031664226204156876, -0.0263842586427927, 0.06697303056716919, 0.01876802369952202, -0.02794177085161209, -0.04750412702560425, 0.0031695375218987465, 0.0015769812744110823, -0.04086912423372269, 0.00035336060682311654, -0.028066372498869896, 0.027863895520567894, 0.046787671744823456, 0.02903202921152115, -0.035542432218790054, -0.002464763354510069, -0.008675343357026577, -0.0036387380678206682, -0.02411029115319252, -0.04482520371675491, 0.009820114821195602, -0.0481894314289093, 0.033206161111593246, -0.003985284827649593, -0.0111440010368824, 0.012156384065747261, 0.032707758247852325, -0.00973445177078247, 0.013503631576895714, 0.02518497407436371, 0.049404289573431015, 0.025589928030967712, 0.0026185675524175167, -0.01013161800801754, -0.012086295522749424, 0.05983962491154671, 0.01361265778541565, 0.006779072340577841, 0.02872052788734436, -0.04177248105406761, -0.033486515283584595, -0.006588276941329241, 0.023970114067196846, -0.02692938782274723, -0.05308001860976219, -0.02716301567852497, 0.04747297614812851, 0.033175013959407806, 0.02689823880791664, 0.02822212316095829, -0.013176553882658482, 0.002326534129679203, -0.006662258878350258, 0.023424984887242317, 0.00999144185334444, 0.017817940562963486, -0.025854704901576042, 0.0001229582994710654, 0.04180363193154335, -0.033237311989068985, -0.006911460775882006, -0.03435872122645378, -0.0354178287088871, 0.01438362617045641, 0.01747528836131096, -0.026602311059832573, -0.05619504302740097, 0.007405971176922321, 0.01946890354156494, 0.0327700600028038, -0.0538899265229702, 0.008761006407439709, -0.021976498886942863, -0.00806791428476572, -0.03977886587381363, -0.014671766199171543, 0.011330902576446533, -0.014445926994085312, 0.06192668899893761, -0.007238538470119238, -0.034981727600097656, -0.010598871856927872, -0.0009865866741165519, -0.0064909327775239944, -0.03928045928478241, -0.0031753783114254475, 0.07407528907060623, -0.04382839798927307, -0.040651071816682816, 0.04174133017659187, -0.028331149369478226, 0.0046335989609360695, 0.03208475559949875, 0.013371243141591549, 0.018300769850611687, 0.031929001212120056, -0.03797215223312378, 0.033735718578100204, -0.001730785588733852, -0.00201892526820302, 0.029888661578297615, -0.015793174505233765, -0.010147192515432835, -0.03600968420505524, -0.05507363751530647, -0.017584314569830894, -0.006455888506025076, 0.007409865036606789, 0.01697688363492489, 0.02178959734737873, -0.017397413030266762, -0.00011778686894103885, 0.02129119262099266, -0.013620445504784584, 0.03812790289521217, -0.047628726810216904, -0.0005602177116088569, 0.014414777047932148, -0.07008805125951767, -0.022973306477069855, 0.02898530475795269, 0.012709300965070724, 0.005938015878200531, -0.00022693441133014858, -0.006514295469969511, -0.0059925285167992115, 0.03697534278035164, 0.06183324009180069, 0.026275232434272766, 0.017584314569830894, 0.013480269350111485, -0.0003978957247454673, -0.03610313683748245, 0.027645843103528023, -0.0502764992415905, -0.007086681202054024, -0.003924930933862925, -0.0031559092458337545, 0.02460869401693344, 0.03255200758576393, 0.022692954167723656, -0.004555723629891872, 0.017008034512400627, -0.037567198276519775, -0.003919090609997511, 0.01822289451956749, 0.030122287571430206, 0.014920968562364578, -0.009056934155523777, 0.04130522534251213, -0.0024491881486028433, -0.026602311059832573, 0.01165019255131483, 0.030729718506336212, -0.028315573930740356, 0.030184589326381683, 0.0445760041475296, -0.0508372038602829, 0.027318766340613365, -0.07233086973428726, -0.036040835082530975, 0.05463753268122673, 0.04507440701127052, 0.024982497096061707, -0.0169457346200943, -0.01772448979318142, -0.003576437709853053, 0.02107314206659794, -0.01474964153021574, -0.010980461724102497, 0.0003460597654338926, 0.008815519511699677, -0.028813978657126427, -0.05227011442184448, -0.08061683923006058, 0.024281617254018784, -0.04382839798927307, -0.02775486931204796, -0.0006098634330555797, 0.012880627065896988, -0.04214628413319588, 0.0016003439668565989, -0.01553618535399437, 0.03900010883808136, -0.0067868600599467754, -0.013246642425656319, 0.08641078323125839, -0.014212300069630146, 0.03977886587381363, -0.02210110053420067, -0.014796366915106773, -0.02664903551340103, -0.014516014605760574, 0.01976483128964901, -0.05821980908513069, 0.03395376726984978, -0.02747451700270176, -0.021088717505335808, 0.04769102856516838, 0.030869893729686737, 0.006856948137283325, -0.009165960364043713, 0.04395299777388573, -0.026524435728788376, -0.00163344107568264, -0.0022408708464354277, 0.054263729602098465, -0.033206161111593246, 0.002231136430054903, -0.090273417532444, -0.009905778802931309, 0.005124215502291918, 0.019624656066298485, 0.017070334404706955, 0.05949697270989418, 0.052457015961408615, 0.046569619327783585, 0.011229664087295532, 0.0020014033652842045, 0.0008712334674783051, -0.01873687282204628, -0.006039253901690245, 0.05591469258069992, -0.020668188109993935, 0.015419372357428074, 0.00737482076510787, 0.007106150034815073, -0.05342267453670502, -0.021680571138858795, -0.04507440701127052, 0.027505667880177498, 0.030153438448905945, 0.04420220106840134, -0.004454485140740871, 0.039623115211725235, 0.008418354205787182, 0.024748871102929115, 0.02210110053420067, -0.03264546021819115, -0.014056548476219177, 0.005552531685680151, 0.0264621339738369, -0.006615533493459225, -3.327965896460228e-05, -0.0405576229095459, 0.027240891009569168, 0.025807978585362434, 0.009555337950587273, -0.006736240815371275, -0.004275371320545673, -0.004765987861901522, -0.005825096275657415, -0.03766064718365669, -0.028658226132392883, -0.004582980182021856, -0.003081927541643381, 0.001558485790155828, -0.11369840055704117, -0.03625888749957085, 0.011175150983035564, 0.014804154634475708, -0.04803368076682091, 0.0020422879606485367, 0.005478549748659134, -0.0342964231967926, 0.038906656205654144, 0.030091138556599617, -0.02929680608212948, -0.03719339519739151, 0.0018242363585159183, 0.0033953769598156214, 0.035012878477573395, -0.00199166894890368, -0.005474655888974667, 0.011634617112576962, -0.015427160076797009, 0.0009637107723392546, 0.0013774249237030745, 0.0038918338250368834, 0.02409471571445465, 0.014056548476219177, -0.0018067143391817808, 0.05289311707019806, 0.01296629011631012, -0.031165821477770805, -0.002704230835661292, -0.01205514557659626, -0.004590767435729504, 0.012164170853793621, 0.004485635552555323, 0.045510511845350266, -0.02205437421798706, 0.018892625346779823, -0.014165574684739113, -0.016852283850312233, 0.03853285685181618, 0.017101485282182693, -0.019873857498168945, 0.008465079590678215, 0.018394220620393753, -0.029966536909341812, -0.01925085298717022, 0.003451836761087179, -0.010505421087145805, 0.0077486238442361355, -0.006323500070720911, -0.004364928230643272, 0.04370379447937012, 0.004649174399673939, -0.0171482115983963, -0.02513824962079525, -0.013386818580329418, -0.036570388823747635, -0.028782827779650688, -0.023222507908940315, 0.009469674900174141, -0.0034635181073099375, 0.012483461759984493, -0.04463830217719078, 0.020683763548731804, 0.03766064718365669, -0.004127407446503639, 0.03532437980175018, 0.025558777153491974, 0.014149999246001244, -0.01716378517448902, 0.014438139274716377, -0.040433019399642944, 0.011626829393208027, 0.009282773360610008, -0.0031695375218987465, 0.02440621890127659, -0.03495057672262192, 0.0007373847183771431, -0.0172260869294405, 0.006253411993384361, -0.029873086139559746, 0.008729856461286545, 0.035822782665491104, 0.02794177085161209, -0.0061988988891243935, 0.005657663568854332, 0.012156384065747261, -0.014554952271282673, -0.0481894314289093, 0.03753604739904404, -0.021166592836380005, -0.023238083347678185, 0.037567198276519775, -0.018269618973135948, -0.010318519547581673, 0.0035199779085814953, 0.007522784639149904, 0.027131864801049232, 0.011899393983185291, 0.03519978001713753, 0.005431824363768101, -0.023424984887242317, -0.014297963120043278, -0.015590698458254337, -0.06572701781988144, -0.017786791548132896, 0.02563665248453617, 0.009173748083412647, -0.015123444609344006, 0.008823307231068611, -0.042208585888147354, 0.016774408519268036, 0.020652612671256065, -0.039903465658426285, -0.01165019255131483, -0.002630248898640275, -0.004345459397882223, -0.051927462220191956, 0.044233351945877075, 0.015980076044797897, 0.0172260869294405, -0.011206300929188728, -0.05747220665216446, -0.03336191549897194, 0.01897050067782402, -0.0636088028550148, 0.030371490865945816, 0.021742872893810272, 0.0037029855884611607, -0.04984039440751076, -0.032458558678627014, 0.009944716468453407, 0.0017200777074322104, -0.007923844270408154, -0.013916372321546078, 0.012693725526332855, -0.0008561450522392988, -0.027349917218089104, 0.006829691585153341, 0.03660153970122337, 0.01798926666378975, 0.002519276225939393, 0.01126860175281763, -0.017599890008568764, -0.046258118003606796, 0.038096752017736435, 0.05289311707019806, 0.026010455563664436, 0.03214705362915993, -0.005610938183963299, -0.029935387894511223, 0.0014056548243388534, -0.02594815567135811, 9.259897342417389e-05, 0.008690918795764446, 0.011774793267250061, -0.02795734629034996, -0.011767005547881126, -0.007355351932346821, 0.015427160076797009, 0.03952966257929802, -0.03361111506819725, -0.006623321212828159, -0.003693251172080636, 0.015092294663190842, -0.009267197921872139, 0.02210110053420067, -0.01643175445497036, 0.010715684853494167, 0.021493669599294662, -0.010084892623126507, 0.03138387203216553, -0.016353879123926163, -0.04903048649430275, -0.022163400426506996, 0.011774793267250061, -0.02946813404560089, -0.0027217527385801077, -0.04311194270849228, -0.03392262011766434, 0.005022977478802204, 0.019920581951737404, 0.054014526307582855, -0.019406603649258614, -0.01901722513139248, -0.004777668975293636, -0.02361188642680645, 0.008371628820896149, 0.0025075948797166348, 0.026290807873010635, 0.007331989239901304, -0.021602695807814598, -0.0015682202065363526, -0.029327956959605217, -0.009555337950587273, 0.02362746186554432, 0.016322730109095573, -0.0011291964910924435, 0.022194551303982735, 0.029888661578297615, -0.040401868522167206, 0.004590767435729504, -0.011977270245552063, 0.005167047027498484, -0.001881669624708593, 0.05099295452237129, 0.003249360015615821, 0.000840569962747395, 0.014368051663041115, 0.036321189254522324, -0.046102363616228104, 0.02073048986494541, -0.02261507883667946, -0.027801595628261566, 0.024219317361712456, -0.06392030417919159, -0.024686571210622787, -0.004069000948220491, 0.022163400426506996, 0.06289234757423401, 0.02177402190864086, 0.008651981130242348, -0.022568354383111, -0.03663269057869911, -0.01925085298717022, 0.015053356997668743, -0.005677132401615381, -0.02205437421798706, 0.013752833940088749, 0.02691381238400936, 0.04314308986067772, -0.02769256941974163, 0.01256133709102869, -0.016603080555796623, 0.021228892728686333, 0.003603694261983037, -0.005369523540139198, -0.003198741003870964, 0.0031870596576482058, -0.022147824987769127, -0.04532361030578613, -0.02330038510262966, 0.03342421352863312, 0.023736488074064255, -0.0032104223500937223, 0.004080682527273893, 0.022256851196289062, -0.00564208859577775, 0.036570388823747635, -0.01359708234667778, 0.039623115211725235, -0.034234121441841125, -0.016540780663490295, -0.017771216109395027, -0.015676362439990044, -0.010824711062014103, -0.025792405009269714, -0.014290175400674343, -0.015793174505233765, 0.0027490092907100916, 0.006814116612076759, -0.013604870066046715, -0.01294292788952589, -0.036040835082530975, 0.006627215072512627, -0.003467411734163761, -0.009633214212954044, -0.04239548742771149, 0.015232470817863941, 0.015582910738885403, 0.005828989669680595, -0.128339022397995, -0.0027159121818840504, 0.03055839240550995, -0.005034658592194319, -0.009617638774216175, -0.008768794126808643, 0.00960985105484724, 0.04199053347110748, 0.032988112419843674, -0.010357457213103771, 0.0005826069391332567, -0.010591084137558937, -0.006163855083286762, -0.017085909843444824, 0.015847688540816307, -0.022459328174591064, 0.010824711062014103, -0.00211432296782732, -0.0023849408607929945, -0.039623115211725235, -0.023206934332847595, 0.0024472412187606096, 0.009134809486567974, 0.025465326383709908, -0.028891853988170624, -0.011572316288948059, -0.019842706620693207, -0.02797292172908783, 0.030667418614029884, -0.006506507750600576, -0.02286428026854992, 0.02923450618982315, 0.0055213812738657, 0.03026246465742588, 0.021182168275117874, -0.009952504187822342, -0.04750412702560425, -0.017584314569830894, 0.009648788720369339, -0.007094468455761671, -0.017381837591528893, -0.036570388823747635, 0.021135441958904266, -4.377461300464347e-05, 0.0313994474709034, -0.0003380288544576615, 0.0049139512702822685, -0.002782106399536133, 0.015559548512101173, -0.0012177799362689257, 0.016307154670357704, 0.002986529842019081, 0.010193917900323868, 0.012779388576745987, 0.016540780663490295, 0.031695377081632614, 0.0027587437070906162, -0.006646683905273676, 0.02563665248453617, -0.027147440239787102, 0.026773637160658836, 0.0027782125398516655, 0.014087699353694916, -0.030200164765119553, 0.0036504194140434265, -0.011665767058730125, -0.022116675972938538, 0.04647616669535637, -0.0029028134886175394, -0.0011622935999184847, -0.033206161111593246, -0.018892625346779823, -0.01281053852289915, 0.0030040519777685404, 0.015528397634625435, 0.03386031836271286, 0.010038167238235474, -0.014477076940238476, -0.016556356102228165, 0.02898530475795269, 0.039903465658426285, 0.005743326619267464, -0.012062933295965195, 0.00883888266980648, 0.0029514858033508062, -0.011439927853643894, 0.006011997815221548, -0.05494903400540352, 0.010061529465019703, -0.003426527138799429, 0.012693725526332855, -0.008161365054547787, 0.01130753941833973, 0.017132636159658432, 0.022178975865244865, -0.02259950339794159, -0.0005538903060369194, -0.0034713055938482285, 0.03622773662209511, 0.00010561880480963737, 0.010264006443321705, 0.017771216109395027, 0.014547165483236313, -0.054544080048799515, -0.012623636983335018, -0.004929526709020138, -0.0008507911115884781, -0.013690533116459846, 0.0037730736657977104, -0.0259014293551445, 0.004181920550763607, 0.009679938666522503, -0.009586488828063011, 0.01898607611656189, 0.00784986186772585, -0.007242432329803705, 0.0441710501909256, 0.013246642425656319, 0.006085979286581278, -0.030091138556599617, -0.0007602606783621013, 0.017599890008568764, 0.010933736339211464, -0.0036971447989344597, -0.03488827496767044, -0.006031466647982597, 0.008028975687921047, 0.01901722513139248, 0.0034284740686416626, -0.0005791998701170087, -0.03002883680164814, 0.02434391714632511, -0.0058134146966040134, 0.025807978585362434, 0.019889432936906815, -0.03600968420505524, -0.006923142354935408, 0.010092680342495441, -0.01585547626018524, 0.016073526814579964, 0.007740836124867201, 0.013285580091178417, 0.03744259476661682, 0.0012664522510021925, -0.0019391028909012675, 0.0472237728536129, -0.02485789731144905, -0.02233472652733326, -0.013129828497767448, 0.021898623555898666, 0.006019785068929195, -0.024561969563364983, 0.007191813085228205, 0.02492019720375538, 0.026820361614227295, 0.031929001212120056, 0.01244452316313982, 0.00621836818754673, 0.022724105045199394, 0.054512932896614075, 0.03585393354296684, 0.0059886351227760315, 0.014952118508517742, 0.002587417373433709, 0.019562354311347008, -0.008831094950437546, -0.023938965052366257, -0.022256851196289062, 0.00950861256569624, 0.009859053418040276, -0.009282773360610008, 0.0008936226950027049, 0.030838744714856148, 0.017849091440439224, 0.01954677887260914, 0.033984918147325516, 0.01460946537554264, -0.003516084048897028, 0.002176623558625579, 0.008885608054697514, -0.007919950410723686, 0.033175013959407806, 5.220099774305709e-05, 0.02817539870738983, 0.04311194270849228, 0.002301224507391453, 0.010996037162840366, 0.021976498886942863, -0.019920581951737404, 0.0029767954256385565, 0.039124708622694016, 0.0580640584230423, 0.007094468455761671, -0.0022214020136743784, 0.002587417373433709, -0.01973368041217327, 0.05261276662349701, 0.019811557605862617, -0.011050550267100334, 0.006755709648132324, 0.03101007081568241, 0.0316019244492054, 0.0038490022998303175, -0.00429873401299119, 0.005723857786506414, 0.05644424632191658, -0.019032800570130348, -0.030169013887643814, -0.030605116859078407, 0.01244452316313982, -0.009282773360610008, 0.033984918147325516, -0.04086912423372269, 0.02261507883667946, -0.04641386866569519, 0.01167355477809906, 0.007293051574379206, -0.004976252093911171, 0.018830323591828346, -0.010139405727386475, -0.00962542649358511, -0.027131864801049232, -0.010809135623276234, 0.036508090794086456, 0.013168767094612122, 0.01063780952244997, -0.011323114857077599, -0.01920412667095661, -0.01794254221022129, -0.011019399389624596, 0.006253411993384361, 0.0061950054951012135, -0.008846670389175415, 0.013394606299698353, -0.023440560325980186, -0.011058337986469269, 0.014656190760433674, -0.00897905882447958, -0.018892625346779823, 0.0166653823107481, 0.03613428771495819, 0.03379801660776138, -0.008761006407439709, 0.01613582856953144, -0.0054006739519536495, 0.0017872453900054097, 0.027365490794181824, 0.015341496095061302, -0.004076788667589426, -0.016291579231619835, 0.002192198531702161, -0.007090575061738491, 0.02851805090904236, -0.03572933375835419, -0.03510632738471031, -0.018269618973135948, 0.01716378517448902, 0.01876802369952202, -0.00621836818754673, 0.033455364406108856, -0.011665767058730125, 0.04311194270849228, 0.017008034512400627, -0.026633460074663162, 0.01616697758436203, -0.006946505047380924, 0.004867225885391235, -0.015575123019516468, 0.005151472054421902, 0.006327393930405378, -0.007639598101377487, 0.020465711131691933, 0.021633846685290337, -0.01822289451956749, -0.0015000790590420365, 0.0155206099152565, 0.0342964231967926, -0.038844358175992966, 0.02621293254196644, -0.044731754809617996, -0.02233472652733326, -0.014718491584062576, 0.015193533152341843, 0.009960290975868702, 0.014399201609194279, -0.007191813085228205, -0.03924931213259697, -0.053983379155397415, 0.03610313683748245, -0.017615463584661484, 0.01950005441904068, 0.0015253886813297868, -0.0010591084137558937, -0.005568106658756733, 0.006646683905273676, 0.010279580950737, 0.0011253026314079762, 0.018658997491002083, 0.03404721990227699, -0.02051243744790554, 0.012491248548030853, 0.012654787860810757, 0.017615463584661484, -0.016291579231619835, 0.015434946864843369, 0.04083797335624695, 0.027552392333745956, -0.027567967772483826, -0.02286428026854992, -0.03532437980175018, 0.02049686200916767, 0.039373911917209625, 0.014453714713454247, 0.002198039321228862, -0.022147824987769127, 0.020434562116861343, 0.015948927029967308, -0.03175767511129379, -0.01231992244720459, -0.016836708411574364, -0.00026842750958167017, 0.014274600893259048, -0.0035744907800108194, 0.020605888217687607, 0.005272179376333952, -0.0021688358392566442, -0.009905778802931309, -0.013970885425806046, -0.02052801288664341, -0.018254045397043228, -0.01422008778899908, 0.007008805405348539, 0.029546009376645088, 0.009664364159107208, -0.02767699398100376, 0.003632897511124611, 0.004283159039914608, 0.01875244826078415, -0.03700649365782738, -0.001839811448007822, 0.020107483491301537, 0.014811942353844643, 0.001386185991577804, 0.047317225486040115, -0.0029222825542092323, 0.012257621623575687, -0.021462520584464073, -0.008200302720069885, 0.016556356102228165, -0.005034658592194319, 0.11949234455823898, -0.024935772642493248, -0.014445926994085312, 0.006451994646340609, -0.0009719850495457649, 0.008293753489851952, -0.0007159689557738602, 0.01256133709102869, -0.04516785591840744, -0.006179430056363344, -0.04027726873755455, -0.002149367006495595, 0.005116427782922983, -0.008309327997267246, -0.0022291895002126694, 0.013651595450937748, -0.000923312793020159, 0.0266646109521389, 0.011860456317663193, 0.0261817816644907, -0.0056226192973554134, 0.023284809663891792, -0.027085138484835625, -0.015582910738885403, 0.005353948567062616, 0.03379801660776138, -0.011494440957903862, -0.0017395465401932597, 0.004415547475218773, 0.012849477119743824, -0.005342267453670502, -0.02185189723968506, 0.0013608763692900538, 0.014157786965370178, 0.007666854653507471, -0.005420142784714699, -0.028673801571130753, 0.0056070443242788315, 0.001868041348643601, 0.0075422534719109535, -0.03224050626158714, 0.03101007081568241, 0.0026029925793409348, 0.009866840206086636, -0.04005921632051468, -0.014305750839412212, -0.008535167202353477, -0.007690217345952988, -0.013651595450937748, 0.001482557039707899, -0.020169785246253014, -0.000569465453736484, -0.0009753921185620129, -0.02029438503086567, -0.0012859210837632418, -0.03264546021819115, -0.004906164016574621, 0.038906656205654144, 0.016540780663490295, 0.0036757290363311768, -0.04924853891134262, -0.015941139310598373, -0.03171095252037048, 0.014632828533649445, -0.01334788091480732, -0.033206161111593246, -0.003743870183825493, 0.03432757034897804, -0.022365877404808998, 0.016836708411574364, 0.00977338943630457, -0.00976560264825821, 0.0021260043140500784, -0.016836708411574364, -0.019032800570130348, -0.0017638826975598931, -0.012467886321246624, -0.0007860569749027491, 0.01895492523908615, 0.04211513325572014, 0.01078577246516943, -0.013573720119893551, 0.008410566486418247, -0.003985284827649593, -0.018082717433571815, -0.017880242317914963, 0.010707897134125233, -0.008317115716636181, -0.00999144185334444, -0.0037049325183033943, 0.0022272425703704357, 0.026275232434272766, -0.007370926905423403, -0.019095100462436676, -0.014983268454670906, 0.00285803503356874, -0.009010208770632744, -0.025543201714754105, 0.0036893573123961687, -0.004933420103043318, 0.035822782665491104, 0.01643175445497036, 0.0018797226948663592, 0.005427930504083633, -0.04510555788874626, -0.019624656066298485, -0.03949851170182228, -0.024452943354845047, -0.007771986536681652, 0.004030063282698393, -0.0007339777075685561, -0.012366647832095623, 0.02875167690217495, 0.020403411239385605, -0.0076434919610619545, -0.010147192515432835, 0.003909355960786343, 0.023456135764718056, 0.012779388576745987, -0.05061915144324303, 0.03510632738471031, -0.007662960793823004, 0.024717720225453377, -0.029655035585165024, 0.013379030860960484, -0.006366331595927477, -0.007530571892857552, 0.036570388823747635, -0.029109904542565346, -0.011066124774515629, 0.0016217597294598818, 0.007032168097794056, 0.010793560184538364, 0.0027236996684223413, 0.018923774361610413, 0.03893780708312988, -0.0036309505812823772, -0.01499105617403984, -0.03510632738471031, 0.0043493532575666904, 0.013807347044348717, 0.04357919469475746, 0.010559933260083199, 0.007001018151640892, 0.0210419911891222, 0.02154039591550827, -0.0023596312385052443, -0.010380819439888, -0.0210419911891222, -0.006226155441254377, 0.002431666012853384, -0.01641618087887764, -0.019032800570130348, 0.03610313683748245, -0.01371389627456665, -0.006132704671472311, 0.012615850195288658, -0.002649717964231968, -0.005132003221660852, 6.424738239729777e-05, 0.00208901334553957, 0.0015068931970745325, 0.003455730387941003, 0.006315712351351976, 0.032458558678627014, -0.009788964875042439, -0.023020032793283463, 0.0001836160954553634, 0.024951348081231117, -0.008535167202353477, 0.015715299174189568, -0.004987933207303286, -0.010793560184538364, -0.014734067022800446, -0.005735539365559816, -0.004088469780981541, -0.009999229572713375, 0.03931161016225815, -0.013145403936505318, -0.008138001896440983, 0.003551128087565303, -0.018861474469304085, 0.009578701108694077, 0.0006045094924047589, 0.005560318939387798, 0.0010114095639437437, -0.017537588253617287, 0.007012699265033007, 0.01515459455549717, 0.0029222825542092323, 0.03255200758576393, -0.021758446469902992, -0.004941207822412252, -0.019141826778650284, 0.01203957013785839, 0.03351766616106033, -0.006561020854860544, 0.03569818288087845, 0.0020695445127785206, -0.012600274756550789, 0.015925563871860504, -0.027614694088697433, -0.023051181808114052, -0.017646614462137222, 0.04071337357163429, 0.0019868016242980957, -0.003749710973352194, 0.020683763548731804, 0.010217281058430672, -0.024530818685889244, 0.023129059001803398, 0.003391483100131154, 0.007121725007891655, 0.017646614462137222, 0.002342109102755785, 0.03843940421938896, -0.006818010006099939, 0.0359785333275795, 0.0034751994535326958, 0.0005845538689754903, -0.022241275757551193, 0.0112841771915555, 0.04466945305466652, -0.03289465978741646, -0.001078577246516943, 0.03233395516872406, -0.01205514557659626, -0.008099064230918884, 0.00019006516959052533, -0.010061529465019703, 0.01179815549403429, -0.025278424844145775, 0.018565546721220016, -0.028782827779650688, 0.012748238630592823, -0.008831094950437546, -0.02283313125371933, 0.00044754144619219005, 0.0060937670059502125, -0.013277792371809483, -0.0072619011625647545, 0.02434391714632511, 0.0005290674744173884, -0.0017823781818151474, -0.02330038510262966, 0.034234121441841125, -0.011837094090878963, 0.039685413241386414, -0.03255200758576393, 0.052488166838884354, 0.027007263153791428, 0.020200934261083603, -0.0012207003310322762, -0.025839129462838173, 0.011198513209819794, -0.0066700465977191925, 0.017039185389876366, -0.02823769859969616, 0.0022837023716419935, -0.008823307231068611, -0.04756642505526543, 0.02155597135424614, 0.021742872893810272, -0.009796752594411373, -0.00847286731004715, -0.02259950339794159, -0.004096257500350475, 0.01294292788952589, 0.016353879123926163, 0.013129828497767448, -0.008823307231068611, 0.020652612671256065, 0.008262602612376213, -0.019297577440738678, 0.02409471571445465, 0.04956004396080971, -0.021898623555898666, -0.02744336798787117, 0.0030663523357361555, -0.012576911598443985, 0.007370926905423403, 0.014757429249584675, 0.011751430109143257, -0.01640060544013977, -0.011720280162990093, 0.054294880479574203, -0.013285580091178417, 0.007032168097794056, 0.010053741745650768, -0.004711474757641554, 0.025247273966670036, -0.004407759755849838, -0.00044754144619219005, -0.028081947937607765, -0.010528783313930035, 0.0004942668019793928, -0.00737482076510787, -0.018347496166825294, 0.004357140511274338, 0.028268849477171898, -0.018830323591828346, 0.0020968010649085045, -0.035511281341314316, 0.008239240385591984, 0.00674402853474021, 0.008527380414307117, -0.008161365054547787, 0.0394362136721611, -0.006923142354935408, -0.001435831654816866, -0.026835937052965164, -0.01747528836131096, -0.038345955312252045, 0.034732524305582047, 0.010770197957754135, -0.013363455422222614, -0.0028483006171882153, 0.014952118508517742, 0.0043376716785132885, 0.024811170995235443, -0.017771216109395027, -0.018331920728087425, -0.010357457213103771, -0.0004954836331307888, 0.018845899030566216, -0.03267660737037659, -0.004656961653381586, 0.02949928306043148, 0.008519592694938183, -0.018098292872309685, 0.014033186249434948, -0.03404721990227699, 0.029125479981303215, 0.005770583171397448, 0.002649717964231968, -3.744722198462114e-05, 9.472838428337127e-05, 0.02099526673555374, 0.03082316927611828, -0.02923450618982315, -0.01800484210252762, -0.022397026419639587, -0.024266041815280914, -0.003467411734163761, -0.004921738989651203, 0.024702144786715508, -0.03974771499633789, -0.033984918147325516, 0.011276389472186565, -0.008130214177072048, 0.0014173361705616117, -0.0024608694948256016, -0.015528397634625435, 0.008667556568980217, 0.027521243318915367, 0.0042481147684156895, 0.005392886232584715, 0.02154039591550827, -0.006506507750600576, -0.008449504151940346, -0.01928200200200081, -0.05158481001853943, 0.03569818288087845, 0.000789464043918997, -0.003064405405893922, 0.0076590669341385365, -0.01898607611656189, -0.008465079590678215, -0.026244083419442177, 0.0040534259751439095, -0.019640229642391205, 0.04342344403266907, 0.03108794614672661, 0.01798926666378975, -0.00924383569508791, -0.0005280940094962716, -0.031960152089595795, -0.029156630858778954, -0.0023674187250435352, -0.02900088019669056, 0.014531590044498444, -0.02439064346253872, -0.027053989470005035, 0.00016244366997852921, 0.00025187895516864955, 0.010357457213103771, -0.008060126565396786, 0.00732420152053237, 0.023284809663891792]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"51
54
57
60
63
66
69T okenLayer 58
0.00.20.40.60.81.0 (lix) Layer 58
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 59
0.00.20.40.60.81.0 (lx) Layer 59
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 60
0.00.20.40.60.81.0
(lxi) Layer 60
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 61
0.00.20.40.60.81.0 (lxii) Layer 61
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 62
0.00.20.40.60.81.0 (lxiii) Layer 62
01234567891011
Head ID0
3
6
9
12
15
18
21
24
27
30
33
36
39
42
45
48
51
54
57
60
63
66
69T okenLayer 63
0.00.20.40.60.81.0
(lxiv) Layer 63
Figure 15. Layer Map OPT-66B
17
Runtime Clustered Head Attention for Efficient Inference
0123456789101112
T oken024681012141618202224262830Head IDLayer 0
0.20.40.60.8
(a) Layer 0
0123456789101112
T oken024681012141618202224262830Head IDLayer 1
0.10.20.30.40.50.6 (b) Layer 1
0123456789101112
T oken024681012141618202224262830Head IDLayer 2
0.10.20.30.40.50.60.7 (c) Layer 2
0123456789101112
T oken024681012141618202224262830Head IDLayer 3
0.20.40.60.8
(d) Layer 3
0123456789101112
T oken024681012141618202224262830Head IDLayer 4
0.20.40.60.8 (e) Layer 4
0123456789101112
T oken024681012141618202224262830Head IDLayer 5
0.20.40.60.8 (f) Layer 5
0123456789101112
T oken024681012141618202224262830Head IDLayer 6
0.20.40.60.8
(g) Layer 6
0123456789101112
T oken024681012141618202224262830Head IDLayer 7
0.20.40.60.8 (h) Layer 7
0123456789101112
T oken024681012141618202224262830Head IDLayer 8
0.00.20.40.60.8 (i) Layer 8
0123456789101112
T oken024681012141618202224262830Head IDLayer 9
0.20.40.60.8
(j) Layer 9
0123456789101112
T oken024681012141618202224262830Head IDLayer 10
0.20.40.60.8 (k) Layer 10
0123456789101112
T oken024681012141618202224262830Head IDLayer 11
0.10.20.30.40.50.60.70.8 (l) Layer 11
0123456789101112
T oken024","[0.016133522614836693, 0.02214885875582695, 0.04178043082356453, 0.004920152481645346, 0.005112218204885721, 0.001374087412841618, 0.022034436464309692, -0.03087763488292694, -0.017473896965384483, -0.011671059764921665, 0.043186187744140625, -0.005234813317656517, -0.018258506432175636, -0.010543184354901314, -0.0011595459654927254, -0.0045482804998755455, 0.022214243188500404, -0.033770881593227386, -0.011352311819791794, 0.06695330888032913, -0.03733431547880173, -0.018667157739400864, 0.00723720109090209, 0.015021993778645992, 0.021364251151680946, -0.006652830634266138, 0.022083476185798645, -0.016092658042907715, 0.05417071655392647, -0.01592102460563183, -0.003692157566547394, -0.051457278430461884, -0.012529226019978523, -0.05770145729184151, -0.026464208960533142, 0.011188851669430733, 0.009039349853992462, 0.03798815608024597, -0.05420340970158577, -0.0004096721822861582, 0.03880545496940613, -0.034032415598630905, -0.0199584923684597, -0.021462326869368553, 0.017915239557623863, -0.005251159425824881, -0.01682005636394024, 0.0062973047606647015, 0.024273842573165894, 0.05979374796152115, -0.037759311497211456, 0.04622654989361763, -0.035209331661462784, 0.04635731875896454, -0.03854392096400261, 0.026545939967036247, 0.019827723503112793, 0.039197761565446854, 0.0916031077504158, -0.00028733242652378976, 0.05685146525502205, 0.003963910508900881, 0.02242674119770527, -0.01699986308813095, 0.00591317331418395, 0.007249460555613041, -0.06891483068466187, -0.004376647528260946, 0.029422840103507042, 0.0072453743778169155, 0.002398778684437275, 0.0531572625041008, -0.001294400542974472, -0.001621321076527238, 0.02644786238670349, 0.014711420051753521, -0.013248451054096222, 0.003079181769862771, -0.006043941713869572, -0.02731420285999775, 0.02304789051413536, 0.017081592231988907, 0.05979374796152115, -0.02466614730656147, 0.023293081670999527, -0.05580531805753708, -0.047043852508068085, -0.006452592089772224, -0.053811103105545044, -0.049528446048498154, -0.04256504029035568, 0.007241287734359503, -0.02244308777153492, -0.010028284043073654, -0.0036472061183303595, -0.020432528108358383, -0.0033856697846204042, -0.005864135455340147, -0.006987924221903086, -0.02391422912478447, 0.055314939469099045, -0.006064373999834061, 0.013665273785591125, 0.00021658478362951428, 0.02481326088309288, -0.018797924742102623, -0.021070022135972977, -0.003512351540848613, -0.05979374796152115, 0.021315213292837143, -0.03968814015388489, -0.0031220901291817427, -0.003469443181529641, 0.05449763685464859, 0.049103450030088425, -0.034359339624643326, -0.017898892983794212, 0.003896482987329364, -0.006554754916578531, -0.02378346212208271, -0.045540016144514084, -0.03622278571128845, 0.027853621169924736, -0.004887460730969906, -0.029945911839604378, -0.05407264083623886, 0.02540171705186367, -0.041747741401195526, -0.04838422313332558, -0.024862298741936684, 0.02775554545223713, 0.007752100937068462, 0.009635980241000652, -0.026905551552772522, -0.02463345415890217, 0.028393039479851723, -0.008177096955478191, 0.08297240734100342, -0.02110271342098713, -0.004249965772032738, -0.018340235576033592, -0.021086368709802628, 0.015708526596426964, 0.03115551732480526, 0.02407768927514553, 0.08303779363632202, -0.04531117156147957, 0.04449387267231941, -0.0317603200674057, 0.041420817375183105, 0.0032160799019038677, -0.004413425922393799, -0.035961247980594635, -0.03710547089576721, -0.010216264054179192, -0.05995720624923706, 0.0026930070016533136, 0.0265786312520504, -0.0055372146889567375, 0.04710923507809639, -0.001735743135213852, -0.00835281703621149, 0.04589962959289551, 0.025303641334176064, -0.021037330850958824, 0.049822673201560974, 0.004200927447527647, 0.01905946061015129, -0.1004299595952034, -0.036386243999004364, 0.011997980065643787, -0.0036002113483846188, -0.037432391196489334, -0.011205198243260384, -0.006084806751459837, 0.02556517720222473, -0.015030167065560818, 0.003972083330154419, 0.0011299187317490578, 0.004993709735572338, 0.013689793646335602, 0.047795768827199936, -0.004736259579658508, 0.03452279791235924, -0.04697846621274948, -0.020710408687591553, -0.00269505032338202, 0.013060471042990685, 0.03556894510984421, -0.0003769801405724138, -0.012136921286582947, 0.013076817616820335, 0.05011690407991409, 0.014294596388936043, 0.0009066933998838067, -0.061362966895103455, 0.05224188417196274, -0.006513889878988266, 0.017964277416467667, 0.006293218582868576, 0.023260388523340225, 0.01727774553000927, 0.06466486304998398, -0.03677855059504509, -0.0046381838619709015, 0.010069149546325207, -0.017245052382349968, -0.01829119771718979, 0.016713807359337807, -0.009407135657966137, 0.06133027374744415, -0.046716928482055664, 0.008965793065726757, -0.008332384750247002, -0.03498048707842827, 0.012014325708150864, -0.04975729063153267, -0.019255613908171654, -0.021887322887778282, -0.002120896242558956, -0.006697782315313816, 0.08336471021175385, 0.024731531739234924, 0.045278482139110565, -0.04011313617229462, 0.03586317226290703, 0.04227081313729286, -0.040211211889982224, 0.004172321874648333, -0.02523825690150261, 0.018863309174776077, -0.011703751981258392, 0.038936223834753036, -0.030681483447551727, -0.017800817266106606, -0.05227457731962204, -0.010624914430081844, -0.02036714367568493, -0.000947558437474072, -0.03622278571128845, -0.02244308777153492, 0.03628816828131676, 0.0016887483652681112, 0.02984783612191677, -0.007637678645551205, -0.021658478304743767, -0.01610083132982254, -0.01963157206773758, -0.003150695702061057, -0.010518665425479412, 0.015005648136138916, 0.011989806778728962, -0.051195740699768066, -0.021642133593559265, -0.053386107087135315, 0.03207089379429817, 0.015250838361680508, 0.020710408687591553, -0.005851875990629196, 0.025499794632196426, 0.007821571081876755, -0.03645163029432297, -0.05688415467739105, 0.001996257808059454, -0.03069782815873623, -0.02038348838686943, 0.02641517110168934, 0.025744983926415443, -0.05488993972539902, -0.056622620671987534, -0.015847468748688698, -0.006043941713869572, 0.04769769310951233, 0.014343634247779846, -0.04102851450443268, -0.0339670330286026, 0.007993204519152641, -0.008818678557872772, -0.0458015538752079, 0.0065711005590856075, -0.04233619570732117, 0.008046329021453857, 0.01788254827260971, 0.01513641607016325, -0.029161302372813225, -0.018650811165571213, -0.010142706334590912, -0.012659993954002857, -0.018356582149863243, -0.05505340173840523, 0.042172737419605255, -0.04929960146546364, 0.03146609291434288, 0.002545892959460616, -0.02244308777153492, 0.003641076385974884, 0.021674824878573418, -0.007935993373394012, 0.009554250165820122, 0.009995592758059502, 0.04161697253584862, -0.010077322833240032, 0.014515267685055733, -0.0008561228751204908, -0.019304651767015457, 0.031204555183649063, 0.022475779056549072, 0.00039153831312432885, 0.024600762873888016, -0.03942660614848137, -0.03929583728313446, -0.004683135077357292, 0.007825657725334167, -0.016427751630544662, -0.051620736718177795, -0.014106616377830505, 0.07166095823049545, 0.02670940011739731, 0.011867212131619453, -0.002235318534076214, -0.015904679894447327, -0.02406134456396103, -0.004319436382502317, -0.0009174204897135496, 0.02347288653254509, 0.027804583311080933, -0.026235364377498627, -0.0036962442100048065, 0.044101566076278687, -0.03229973837733269, -0.005157169885933399, -0.008193443529307842, -0.011172506026923656, -0.004000688903033733, 0.01964791864156723, -0.006673263385891914, -0.07028789073228836, 0.02039983496069908, 0.0057824053801596165, 0.019745994359254837, -0.0723147988319397, -0.006620138883590698, -0.02687286026775837, -0.012022498995065689, -0.03599394112825394, 0.00031287307501770556, 0.01623160019516945, -0.025189219042658806, 0.06289949268102646, -0.006178796291351318, -0.04367657005786896, 0.005255246069282293, 0.0031527390237897635, -0.007862436585128307, -0.03332953900098801, 0.0033284586388617754, 0.06289949268102646, -0.036942008882761, -0.05152266100049019, 0.0383804589509964, -0.035503558814525604, 0.01904311589896679, 0.01816043071448803, 0.007261720020323992, 0.0037207631394267082, 0.016427751630544662, -0.043349649757146835, 0.023276735097169876, -0.0019196359207853675, 0.0032324257772415876, 0.02747766301035881, 0.003851531306281686, -0.027526700869202614, -0.038315076380968094, -0.04236888885498047, -0.031253594905138016, 0.0007233114447444677, 0.008655218407511711, 0.0140330595895648, 0.017947932705283165, -0.01144221518188715, -0.011270581744611263, 0.021151751279830933, -0.010003765113651752, 0.04933229461312294, -0.06858790665864944, -0.001904311589896679, 0.02510748989880085, -0.07270710170269012, -0.043186187744140625, 0.027820929884910583, -0.003334588371217251, 0.012921529822051525, 0.008034070022404194, 0.008062675595283508, 0.0081321457400918, 0.05093420296907425, 0.06983020156621933, 0.015553239732980728, 0.024437302723526955, -0.003702373942360282, -0.00929271336644888, -0.05142458528280258, 0.0062114885076880455, -0.028098812326788902, -0.01861811801791191, -0.018193121999502182, 0.006309564225375652, 0.043480418622493744, 0.020285412669181824, 0.02597382850944996, -0.025303641334176064, 0.0013056384632363915, -0.04442848637700081, -0.017670050263404846, 0.02213251404464245, 0.01350998692214489, 0.007004270330071449, -0.03311704099178314, 0.04034198075532913, -0.01951714977622032, -0.0354381762444973, -0.007915561087429523, 0.034653566777706146, -0.03739969804883003, 0.01699986308813095, 0.05227457731962204, -0.048514991998672485, 0.026611322537064552, -0.06858790665864944, -0.015250838361680508, 0.05982644110918045, 0.025630561634898186, 0.03100840374827385, -0.026905551552772522, -0.01744120568037033, 0.0016223426209762692, 0.012570090591907501, -0.0062114885076880455, -0.0017061160178855062, -0.01113981381058693, -0.005663896445184946, -0.019075807183980942, -0.041584279388189316, -0.06767252832651138, 0.031041095033288002, -0.04361118748784065, -0.0147768035531044, -0.0083078658208251, 0.009856651537120342, -0.040243905037641525, 0.005733367055654526, -0.025189219042658806, 0.04959382861852646, -0.004188667982816696, -0.007686716970056295, 0.06335718184709549, 0.004192754626274109, 0.04916883260011673, -0.04609578102827072, 0.003628816921263933, -0.014866706915199757, -0.018062354996800423, 0.02788631245493889, -0.05436686798930168, 0.02808246575295925, -0.02084117755293846, -0.020939253270626068, 0.059466827660799026, 0.02316231280565262, -0.014891225844621658, -0.007461959030479193, 0.025369025766849518, -0.04093043878674507, 0.004601405002176762, 0.014212866313755512, 0.03517663851380348, -0.026104597374796867, 0.02259020134806633, -0.05538032203912735, -0.016648422926664352, 0.00030955279362387955, -0.0009450044017285109, 0.005255246069282293, 0.04361118748784065, 0.06332448869943619, 0.04681500792503357, 0.009170117788016796, -0.00042423035483807325, 0.0075396024622023106, -0.031384360045194626, -0.0021862804424017668, 0.07192249596118927, -0.022949814796447754, -0.00404768344014883, 8.792371954768896e-05, -0.01685274764895439, -0.05567454919219017, -0.011720097623765469, -0.0516534298658371, 0.041715048253536224, 0.019991185516119003, 0.059891823679208755, -0.0036594655830413103, 0.0151527626439929, 0.023848846554756165, 0.006513889878988266, 0.021936360746622086, -0.029766105115413666, 0.0018838789546862245, -0.0008974987431429327, 0.024028651416301727, -0.005753799807280302, 0.01003645732998848, -0.026186326518654823, 0.01874888688325882, 0.022116167470812798, 0.00849175825715065, -0.008401854895055294, -0.001060448121279478, -0.02378346212208271, -0.009537903591990471, -0.041878506541252136, -0.027804583311080933, 0.005994903389364481, -0.005120391491800547, -0.004409339278936386, -0.10513760894536972, -0.034784335643053055, -0.003604297759011388, 0.026104597374796867, -0.06414178758859634, -0.009644152596592903, 0.0169835165143013, -0.03632086142897606, 0.03370549529790878, 0.03658239543437958, -0.032414160668849945, -0.035078562796115875, 0.01565948873758316, 0.003949607722461224, 0.02170751616358757, -0.005475917365401983, -0.0035143946297466755, 0.014008540660142899, -0.0005034063942730427, 0.005635290872305632, -0.008720602840185165, 0.012455668300390244, 0.023211350664496422, 0.008957619778811932, -0.017947932705283165, 0.05047651380300522, 0.012275862507522106, -0.042303502559661865, 0.007323017809540033, -0.0054268790408968925, 0.00583144323900342, 0.006587446667253971, -0.0012361678527668118, 0.03159686177968979, -0.016059966757893562, 0.007923734374344349, -0.012414803728461266, -0.015782084316015244, 0.03605932369828224, 0.003921002149581909, -0.03874007239937782, 0.026055559515953064, 0.00028018103330396116, -0.035372789949178696, -0.01447440218180418, -0.0027502181474119425, 0.0027195694856345654, 0.012798935174942017, -0.010992699302732944, 0.0020728798117488623, 0.0368766263127327, 0.023799806833267212, -0.0302728321403265, -0.034195877611637115, -0.010134533047676086, -0.03870737925171852, -0.03143339976668358, -0.026774784550070763, 0.00046611702418886125, 0.0020361014176160097, 0.016051793470978737, -0.05211111903190613, 0.024764223024249077, 0.0413554348051548, -0.005949951708316803, 0.02142963372170925, 0.03534010052680969, 0.012521052733063698, -0.01284797303378582, 0.011164332740008831, -0.023538270965218544, 0.01130327396094799, 0.014932091347873211, 0.010052802972495556, 0.006538408808410168, -0.02804977260529995, 0.011131640523672104, -0.02053060382604599, 0.004564626608043909, -0.014989301562309265, 0.013559024780988693, 0.043055422604084015, 0.036549706012010574, -0.010894623585045338, -0.008303779177367687, -0.0011677189031615853, -0.015381606295704842, -0.018797924742102623, 0.041257359087467194, -0.023015199229121208, -0.020579641684889793, 0.029504569247364998, -0.013232104480266571, -0.023832499980926514, -0.002139285672456026, 0.025189219042658806, 0.017604665830731392, 0.02036714367568493, 0.04491886869072914, 0.005766059271991253, -0.02482960745692253, -0.025140181183815002, -0.023260388523340225, -0.05789760872721672, -0.02007291465997696, 0.029210340231657028, 0.014686900191009045, -0.013820561580359936, 0.02262289449572563, -0.03481702506542206, 0.013567198067903519, 0.016918132081627846, -0.045834243297576904, -0.003367280587553978, -0.008622526191174984, 0.00036472061765380204, -0.06276872009038925, 0.01992580108344555, 0.01933734305202961, 0.016198907047510147, -0.007192249409854412, -0.06270334124565125, -0.04093043878674507, 0.030893981456756592, -0.054105330258607864, 0.016771018505096436, 0.022475779056549072, -0.0072658066637814045, -0.04204196855425835, -0.03426126018166542, 0.005921346601098776, -0.008140319027006626, -0.018209468573331833, -0.0191902294754982, 0.028556499630212784, -0.0005424835835583508, -0.03233243152499199, 0.010052802972495556, 0.021952707320451736, 0.0169835165143013, 0.0016907915705814958, 0.00708600040525198, -0.009366270154714584, -0.021053675562143326, 0.04034198075532913, 0.047926537692546844, 0.023701731115579605, 0.028393039479851723, -0.006092979572713375, -0.019893107935786247, -0.01611717790365219, -0.03628816828131676, 0.0022067129611968994, 0.011017218232154846, 0.016493136063218117, -0.038609303534030914, -0.018977731466293335, 0.010306166484951973, 0.004082418978214264, 0.026333441957831383, -0.02406134456396103, -0.0009220177889801562, -0.005872308276593685, 0.015021993778645992, -0.0035940816160291433, 0.0354708656668663, -0.008128059096634388, 0.006043941713869572, 0.04321888089179993, -0.013501813635230064, 0.033443961292505264, -0.026088250800967216, -0.04491886869072914, -0.02582671493291855, 0.014547958970069885, -0.03795546293258667, 0.012414803728461266, -0.04151889681816101, -0.03216896951198578, -0.008025896735489368, 0.03556894510984421, 0.06139565631747246, -0.027265165001153946, -0.028017081320285797, -0.007257633842527866, -0.02703632041811943, 0.013771523721516132, 0.015814775601029396, 0.02363634668290615, -0.0020034092012792826, -0.013330181129276752, 0.009529730305075645, -0.012128747999668121, -0.009766748175024986, 0.027395932003855705, 0.01633784919977188, -0.00291572161950171, 0.02080848626792431, 0.02095559984445572, -0.029308417811989784, -0.014964782632887363, -0.00487928744405508, -0.005708848126232624, -0.0037125900853425264, 0.06257256865501404, 0.0022189724259078503, 0.019876763224601746, -0.001803170540370047, 0.026905551552772522, -0.03720354661345482, 0.021936360746622086, -0.015765737742185593, -0.017931586131453514, 0.016002755612134933, -0.05806107074022293, -0.026349786669015884, -0.004405253101140261, 0.037301622331142426, 0.051326509565114975, 0.013027779757976532, -0.00016512036381755024, -0.02760843001306057, -0.039491988718509674, -0.008777813985943794, 0.015847468748688698, -0.012913357466459274, -0.020906561985611916, 0.006963405292481184, 0.022246936336159706, 0.03707277774810791, -0.040211211889982224, 0.017179669812321663, -0.007809312082827091, 0.01935368962585926, 0.009268194437026978, -0.016207080334424973, -0.005492263473570347, 0.007580467499792576, -0.02317865937948227, -0.0413227416574955, -0.00997924618422985, 0.02599017508327961, 0.027657469734549522, -0.019320998340845108, 0.003649249440059066, 0.03156416863203049, 0.0032937233336269855, 0.04701115936040878, -0.020628679543733597, 0.010412415489554405, -0.011254236102104187, -0.02005656808614731, -0.020645026117563248, -0.014498921111226082, -0.026660362258553505, -0.025042105466127396, -0.0037105469964444637, -0.014507094398140907, -0.003269204404205084, -0.013346526771783829, -0.005606685299426317, -0.007139124907553196, -0.032724734395742416, -0.006697782315313816, -0.007944166660308838, -0.0007350601954385638, -0.03277377411723137, 0.005655723623931408, 0.014057578518986702, -0.006967491935938597, -0.13331815600395203, -0.011417696252465248, 0.026464208960533142, -0.010600395500659943, -0.0005751756252720952, -0.013256623409688473, 0.008107626810669899, 0.0317603200674057, 0.0302728321403265, -0.008025896735489368, 4.900613930658437e-05, 0.0006420921417884529, -0.012594609521329403, -0.00576197262853384, 0.026954589411616325, -0.02332577295601368, 0.028981497511267662, 0.012063364498317242, -0.012962395325303078, -0.029782451689243317, -0.034359339624643326, 0.0029586299788206816, 0.023979613557457924, 0.02909591794013977, -0.01597006246447563, -0.0118263466283679, -0.015585931949317455, -0.029275724664330482, 0.03619009256362915, 0.010706644505262375, -0.006481197662651539, 0.028752652928233147, 0.03274108096957207, 0.03723623603582382, 0.010747509077191353, -0.019680609926581383, -0.048645760864019394, -0.008802332915365696, 0.015316222794353962, -0.005365581717342138, -0.0243719182908535, -0.02468249201774597, 0.011507599614560604, -0.006366775371134281, 0.02896515093743801, -0.00011665696365525946, -0.006893934682011604, -0.003724849782884121, 0.009161945432424545, -0.003892396343871951, 0.009227328933775425, 0.003265117760747671, 0.018356582149863243, 0.013877772726118565, 0.016591211780905724, 0.03792276978492737, -0.002425340935587883, -0.004642270039767027, 0.0272978562861681, -0.02201809175312519, 0.016019102185964584, 0.01537343394011259, 0.022704623639583588, -0.028180541470646858, -0.004515588749200106, -0.014090270735323429, -0.013240277767181396, 0.045278482139110565, 0.005602599121630192, -0.0013771522790193558, -0.019435420632362366, -0.01784985512495041, -0.013411911204457283, -0.002053468953818083, 0.00989751610904932, 0.02527095004916191, 0.011989806778728962, 0.001201432547532022, -0.006170623004436493, 0.026774784550070763, 0.0265786312520504, -0.0031220901291817427, -0.012512879446148872, 0.012643648311495781, -0.0015968020306900144, -0.0154960285872221, 0.009872997179627419, -0.029308417811989784, 0.011115294881165028, 0.00024072070664260536, 0.02082483097910881, 0.002907548565417528, 0.010494145564734936, 0.012022498995065689, 0.028033427894115448, -0.028180541470646858, 0.01055952999740839, 0.0007258655386976898, 0.04181312397122383, -0.008426373824477196, 0.011589329689741135, 0.0027890398632735014, 0.012226824648678303, -0.05878029391169548, -0.02464980073273182, 0.0004709697386715561, 0.015013821423053741, -0.012422977015376091, 0.006248266901820898, -0.037268929183483124, 0.0005976514075882733, 0.0191902294754982, -0.011172506026923656, 0.011450388468801975, 0.008091281168162823, -0.0019339387072250247, 0.03413049504160881, 0.006436245981603861, 0.010183571837842464, -0.02245943434536457, 0.005962211638689041, 0.0206777174025774, 0.02008926123380661, -0.020792139694094658, -0.026970935985445976, -0.00010835624561877921, 0.019680609926581383, 0.03159686177968979, 0.008283346891403198, 0.014498921111226082, -0.02229597419500351, 0.02422480471432209, -0.014670554548501968, 0.013232104480266571, 0.01521814614534378, -0.023848846554756165, -9.258488717023283e-05, 0.02142963372170925, -0.025025758892297745, 0.014327287673950195, 0.0007391466642729938, -0.0042744847014546394, 0.043513111770153046, -0.0012443409068509936, -0.009619633667171001, 0.035045869648456573, -0.010077322833240032, -0.002421254524961114, -0.006374948658049107, 0.02157674916088581, 0.019288305193185806, -0.023440195247530937, 0.0075845541432499886, 0.032414160668849945, 0.0339670330286026, 0.017326783388853073, 0.0030607925727963448, 0.01713063009083271, 0.01784985512495041, 0.0561649315059185, 0.02069406397640705, -0.007282152771949768, 0.020416181534528732, 0.00554130133241415, 0.02999494969844818, -0.005986730568110943, -0.019386380910873413, -0.030599752441048622, 0.019255613908171654, 0.013894118368625641, -0.009096560999751091, 0.01891234703361988, 0.025074796751141548, 0.010788374580442905, 0.028899766504764557, 0.038020845502614975, 0.004961017519235611, -0.0005751756252720952, 0.007886955514550209, 0.014793150126934052, -0.01994214579463005, 0.026251710951328278, 0.0006793815409764647, 0.0213969424366951, 0.037432391196489334, -0.013199412263929844, 0.006088892929255962, 0.007878782227635384, -0.014899399131536484, 0.009047523140907288, 0.041551586240530014, 0.047632306814193726, -0.003348891157656908, 0.00027098640566691756, -0.003912828862667084, -0.012169613502919674, 0.05198035016655922, 0.013019606471061707, -0.01395132951438427, 0.009701363742351532, 0.015463336370885372, 0.03945929557085037, 0.005864135455340147, -0.014727765694260597, 0.008753295056521893, 0.04920152574777603, -0.0295536071062088, -0.02599017508327961, -0.013567198067903519, 0.023145966231822968, -0.018846962600946426, 0.015855642035603523, -0.04416695237159729, 0.0051326509565114975, -0.027804583311080933, 0.013240277767181396, -0.005120391491800547, -0.0012913356767967343, 0.005484090186655521, -0.00822613574564457, -0.013616235926747322, -0.0339997261762619, -0.012341246008872986, 0.033476654440164566, 0.015422471798956394, 0.015111897140741348, -0.006068460643291473, -0.014580651186406612, -0.017931586131453514, -0.004064029548317194, 0.007020616438239813, 0.02497672103345394, 0.0037759309634566307, 0.0058477893471717834, -0.012602782808244228, 0.004683135077357292, 0.019092153757810593, -0.015986409038305283, -0.014883052557706833, 0.009333578869700432, 0.0324632003903389, 0.02832765504717827, 0.002815602347254753, 0.011867212131619453, -0.005970384459942579, 0.0070001836866140366, 0.03332953900098801, 0.025728639215230942, 0.004634097218513489, -0.012880665250122547, -0.01740851253271103, 0.006080720108002424, 0.023718077689409256, -0.025467101484537125, -0.03159686177968979, -0.02286808378994465, 0.011156159453094006, 0.020710408687591553, 0.005328803323209286, 0.035242024809122086, -0.0002651120303198695, 0.03808623179793358, 0.0317603200674057, -0.029717067256569862, 0.014956610277295113, -0.005377841182053089, -0.003154782112687826, -0.014147481881082058, 0.0029586299788206816, 0.014981129206717014, -0.012022498995065689, 0.030321869999170303, 0.03413049504160881, -0.02316231280565262, 0.00923550222069025, 0.010690297931432724, 0.031662244349718094, -0.04017852246761322, 0.027118049561977386, -0.03896891698241234, -0.019402727484703064, -0.015888333320617676, 0.02303154394030571, 0.0012780545512214303, 0.009881170466542244, -0.0057578859850764275, -0.024306533858180046, -0.04753423109650612, 0.03367280587553978, -0.008900408633053303, 0.010747509077191353, -0.017980623990297318, -0.0023047891445457935, -0.0074864779599010944, 0.0067059556022286415, 0.009088387712836266, 0.007118692621588707, 0.012030672281980515, 0.030534368008375168, -0.027575738728046417, 0.016509482637047768, 0.009848478250205517, 0.014433537609875202, -0.02659497782588005, 0.016133522614836693, 0.03599394112825394, 0.03573240339756012, -0.02626805752515793, -0.025777677074074745, -0.01873254030942917, 0.028425732627511024, 0.026022866368293762, 0.013117682188749313, 0.012676339596509933, -0.011638367548584938, 0.03334588557481766, 0.017065247520804405, -0.029635338112711906, -0.005663896445184946, -0.01858542673289776, -0.014801322482526302, 0.010363377630710602, -0.0006441354053094983, 0.012373938225209713, 0.003839271841570735, -0.001493617775849998, -0.02893245778977871, -0.010600395500659943, -0.018372928723692894, -0.02375076897442341, -0.023276735097169876, 0.010289820842444897, 0.02406134456396103, 0.004200927447527647, -0.02850746177136898, -0.001272946479730308, 0.015389779582619667, 0.014825841411948204, -0.04341503232717514, -0.01729409024119377, 0.023521926254034042, 0.02023637481033802, -0.005455484613776207, 0.025516139343380928, -0.0017388081178069115, 0.008238394744694233, -0.028867075219750404, -0.006971578113734722, 0.01860177330672741, -0.017768125981092453, 0.1283489614725113, -0.036255475133657455, -0.01977868564426899, 0.009995592758059502, -0.0022475779987871647, 0.001974803861230612, -0.0036349466536194086, 0.016460444778203964, -0.029422840103507042, -0.00923550222069025, -0.018781578168272972, 0.0009812720818445086, 0.0008688932284712791, -0.008761467412114143, 0.0019349603680893779, 0.029193995520472527, -0.010984526947140694, 0.03040360100567341, 0.004323522560298443, 0.02731420285999775, 0.013035952113568783, 0.020645026117563248, -0.022998852655291557, -0.007453785743564367, 0.014678727835416794, 0.029471877962350845, -0.02406134456396103, -0.009497039020061493, -0.009586941450834274, 0.013485467992722988, -0.018994078040122986, -0.035078562796115875, 0.011385004036128521, 0.01889600045979023, 0.008671564981341362, 0.0035409568808972836, -0.04923421889543533, 0.004196841269731522, 0.0016243859427049756, -0.0007651981431990862, -0.030011296272277832, 0.011654713191092014, 0.008818678557872772, 0.0021229395642876625, -0.037759311497211456, -0.012897010892629623, -0.0053533222526311874, -0.012006153352558613, -0.005116304848343134, -0.011834519915282726, 0.001188151421956718, 0.005214381031692028, -0.014073925092816353, -0.021445980295538902, 0.0038024932146072388, -0.042009275406599045, -0.0028993755113333464, 0.04416695237159729, 0.020138299092650414, 0.013052298687398434, -0.041747741401195526, -0.018879655748605728, -0.020416181534528732, 0.017980623990297318, -0.005369668360799551, -0.03821700066328049, -0.003283507190644741, 0.03909968584775925, -0.012798935174942017, 0.022246936336159706, 0.006252353545278311, -0.01937003619968891, 0.0026133202482014894, -0.014196519739925861, 0.00028350131469778717, 0.008581661619246006, -0.01788254827260971, 0.007208595518022776, 0.022671932354569435, 0.030779559165239334, 0.005193948280066252, -0.010134533047676086, 0.006652830634266138, -0.000797379354480654, 0.0024805087596178055, -0.03334588557481766, 0.018274853006005287, -0.008181183598935604, -0.005749713163822889, 0.0002207990037277341, -0.005328803323209286, 0.010567703284323215, -0.0055617340840399265, -0.0042295330204069614, -0.015013821423053741, -0.008303779177367687, -0.0029504569247365, -0.03409780189394951, 0.0033529778011143208, 0.006174709647893906, 0.02670940011739731, 0.015512374229729176, -0.0033631939440965652, 0.013763350434601307, -0.028115157037973404, -0.009660499170422554, -0.030779559165239334, -0.011556637473404408, -0.005394187290221453, -0.004121240694075823, -0.004364387597888708, -0.008246568031609058, 0.04109389707446098, 0.010935488156974316, -0.007278066128492355, -0.0020657284185290337, 0.005336976144462824, 0.029030535370111465, 0.025516139343380928, -0.03854392096400261, 0.038936223834753036, -0.004299003630876541, 0.028556499630212784, -0.0428592674434185, 0.007784792687743902, -0.007208595518022776, 0.0008382444502785802, 0.027820929884910583, -0.03218531608581543, -0.019745994359254837, 0.013926810584962368, 0.0077602737583220005, 0.023718077689409256, 0.009872997179627419, 0.012864319607615471, 0.03058340586721897, 0.0007718387059867382, -0.020301759243011475, -0.04017852246761322, 0.00013408846280071884, 0.01567583531141281, 0.04521309584379196, 0.002801299560815096, -0.006285045295953751, 0.02466614730656147, 0.02716708742082119, 0.006746820639818907, -0.011736443266272545, -0.025630561634898186, -0.012447495944797993, 0.005177602171897888, -0.02685651369392872, -0.020775793120265007, 0.02082483097910881, -0.022786354646086693, -0.014212866313755512, 0.01069847121834755, -0.011474907398223877, -0.001586585771292448, 0.004143716301769018, 0.016362367197871208, 0.011818173341453075, -0.000640559708699584, 0.013714312575757504, 0.033901650458574295, -0.0021985399071127176, -0.028425732627511024, -0.0020177119877189398, 0.013183066621422768, 0.001727570197544992, 0.015749391168355942, 0.03187474235892296, -0.007915561087429523, -0.008998485282063484, -0.004719913937151432, -0.007171817123889923, -0.003939391113817692, 0.0332641527056694, -0.010069149546325207, -0.0012361678527668118, -0.00017048389418050647, -0.02257385663688183, -0.0012739680241793394, 0.008283346891403198, 0.012831627391278744, 0.0047240001149475574, -0.018193121999502182, 0.008777813985943794, 0.022835392504930496, -0.006477111019194126, 0.01740851253271103, -0.017604665830731392, -0.008442720398306847, -0.02170751616358757, -0.0031220901291817427, 0.046161167323589325, -0.007380228955298662, 0.03025648556649685, 0.019745994359254837, 0.00464635668322444, 0.02394692227244377, -0.03380357474088669, -0.024290189146995544, -0.025483448058366776, 0.04639000818133354, 0.012398457154631615, -0.012136921286582947, 0.018062354996800423, 0.006955232471227646, -0.013975848443806171, 0.025156527757644653, 0.005271592177450657, -0.009791267104446888, 0.02080848626792431, -0.003203820204362273, 0.02822957932949066, 0.003565476043149829, 0.01829119771718979, 0.0020922909025102854, -0.0005051942425779998, -0.02893245778977871, 0.015708526596426964, 0.03306800127029419, -0.03651701286435127, -0.006799945142120123, 0.025009414181113243, -0.0041253273375332355, -0.010453280992805958, -0.0024416870437562466, -0.012365765869617462, 0.007874695584177971, -0.030354563146829605, 0.027706507593393326, -0.011940768919885159, 0.016109004616737366, -0.010829239152371883, -0.029046880081295967, 0.0007146276184357703, 0.01641140505671501, -0.0037922770716249943, -0.004068116191774607, 0.025957481935620308, 0.002686877269297838, -0.0047240001149475574, -0.0169835165143013, 0.02762477658689022, 0.006428073160350323, 0.025777677074074745, -0.027788236737251282, 0.04995344206690788, 0.020595988258719444, 0.022671932354569435, -0.0036860278341919184, -0.034032415598630905, 0.010951834730803967, -0.014449883252382278, 0.023995960131287575, -0.027052665129303932, 0.002809472382068634, -0.019419074058532715, -0.04014582931995392, 0.018781578168272972, 0.032152626663446426, -0.013943156227469444, -0.011564810760319233, -0.017947932705283165, 0.004899720195680857, 0.017637357115745544, 0.017947932705283165, 0.002907548565417528, -0.002325221663340926, 0.017375821247696877, 0.021805593743920326, -0.007429266814142466, 0.025892099365592003, 0.05793030187487602, -0.025434410199522972, -0.0191902294754982, -0.0023170486092567444, -0.005618944764137268, 0.0048139034770429134, 0.015381606295704842, 0.020497910678386688, -0.028899766504764557, -0.004149846266955137, 0.04521309584379196, -0.012570090591907501, 0.01499747484922409, 0.003618600545451045, -0.0074864779599010944, 0.018683502450585365, -0.009472519159317017, 0.01652582734823227, -0.02567959949374199, -0.001930873841047287, -0.003861747682094574, -0.010755682364106178, -0.03086128830909729, -0.00849175825715065, 0.022786354646086693, -0.021740209311246872, 0.006754993461072445, -0.02451903186738491, -0.0076499381102621555, 0.008900408633053303, 0.009129253216087818, 0.005005969200283289, 0.03370549529790878, 0.010150879621505737, -0.009063868783414364, -0.020595988258719444, -0.012300381436944008, -0.03290454298257828, 0.020628679543733597, 0.00023139837139751762, -0.015479682944715023, -0.014482575468719006, 0.017833510413765907, 0.013828734867274761, 0.03501318022608757, -0.01276624295860529, -0.01439267210662365, -0.00015401018026750535, -0.019729647785425186, 0.03102474845945835, -0.028278617188334465, -0.007147298194468021, 0.03913237527012825, 0.0132893156260252, -0.013747003860771656, 0.018879655748605728, -0.020301759243011475, 0.03798815608024597, 0.007408834528177977, 0.02582671493291855, 0.009112907573580742, -0.001506898901425302, 0.021756555885076523, 0.03573240339756012, -0.03439202904701233, -0.0067263878881931305, -0.02242674119770527, -0.0258594062179327, -0.007870609872043133, 0.005185775458812714, 0.019745994359254837, -0.048351533710956573, -0.03517663851380348, 0.013027779757976532, -0.01276624295860529, 0.0033917995169758797, 0.00420501409098506, -0.02481326088309288, -0.0008750229608267546, 0.02008926123380661, 0.00642398651689291, 0.0027256992179900408, 0.026382479816675186, -0.019860416650772095, -0.015079204924404621, 0.005684329196810722, -0.03221800923347473, 0.023113274946808815, 0.0036553791724145412, -0.006428073160350323, 0.006677350029349327, -0.006628311704844236, -0.010461454279720783, -0.011147987097501755, -0.0019635658245533705, -0.008348730392754078, 0.05289572477340698, 0.030763212591409683, 0.010551356710493565, -0.006603792775422335, 0.0027992562390863895, -0.03736700490117073, -0.03058340586721897, -0.003645162796601653, -0.016787365078926086, 0.014637862332165241, -0.01858542673289776, -0.035536251962184906, -0.01069847121834755, 0.0041702790185809135, 0.012316727079451084, -0.019092153757810593, 0.0034122320357710123, 0.0076295058242976665]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
"681012141618202224262830Head IDLayer 12
0.20.40.60.8
(m) Layer 12
0123456789101112
T oken024681012141618202224262830Head IDLayer 13
0.20.40.60.8 (n) Layer 13
0123456789101112
T oken024681012141618202224262830Head IDLayer 14
0.20.40.60.8 (o) Layer 14
Figure 16. Activations of LL AMA-7B18
Runtime Clustered Head Attention for Efficient Inference
0123456789101112
T oken024681012141618202224262830Head IDLayer 15
0.20.40.60.8
(xvi) Layer 15
0123456789101112
T oken024681012141618202224262830Head IDLayer 16
0.20.40.60.8 (xvii) Layer 16
0123456789101112
T oken024681012141618202224262830Head IDLayer 17
0.20.40.60.8 (xviii) Layer 17
0123456789101112
T oken024681012141618202224262830Head IDLayer 18
0.20.40.60.8
(xix) Layer 18
0123456789101112
T oken024681012141618202224262830Head IDLayer 19
0.20.40.60.8 (xx) Layer 19
0123456789101112
T oken024681012141618202224262830Head IDLayer 20
0.20.40.60.8 (xxi) Layer 20
0123456789101112
T oken024681012141618202224262830Head IDLayer 21
0.20.40.60.8
(xxii) Layer 21
0123456789101112
T oken024681012141618202224262830Head IDLayer 22
0.20.40.60.8 (xxiii) Layer 22
0123456789101112
T oken024681012141618202224262830Head IDLayer 23
0.20.40.60.8 (xxiv) Layer 20
0123456789101112
T oken024681012141618202224262830Head IDLayer 24
0.20.40.60.8
(xxv) Layer 24
0123456789101112
T oken024681012141618202224262830Head IDLayer 25
0.20.40.60.8 (xxvi) Layer 25
0123456789101112
T oken024681012141618202224262830Head IDLayer 26
0.20.40.60.8 (xxvii) Layer 26
0123456789101112
T oken024681012141618202224262830Head IDLayer 27
0.20.40.60.8
(xxviii) Layer 27
0123456789101112
T oken024681012141618202224262830Head IDLayer 28
0.20.40.60.8 (xxix) Layer 28
0123456789101112
T oken024681012141618202224262830Head IDLayer 29
0.20.40.60.8 (xxx) Layer 29
Figure 16. Activations of LL AMA-7B19
Runtime Clustered Head Attention for Efficient Inference
0123456789101112
T oken024681012141618202224262830Head IDLayer 30
0.20.40.60.8
(xxxi) Layer 30
0123456789101112
T oken024681012141618202224262830Head IDLayer 31
0.20.40.60.8 (xxxii) Layer 31
Figure 16. Activations of LL AMA-7B
20
","[0.024388039484620094, 0.02721865102648735, 0.04196342080831528, 0.0006271923775784671, 0.016359975561499596, -0.004137970507144928, 0.039404675364494324, -0.02189326286315918, -0.019190588966012, -0.008120018057525158, 0.02413216419517994, -0.016647836193442345, -0.026035230606794357, -0.008587787859141827, 0.0026007245760411024, -0.006620753090828657, 0.025203639641404152, -0.029153702780604362, -0.020997701212763786, 0.05661223456263542, -0.029537513852119446, -0.01616807095706463, -0.009643270634114742, 0.028721913695335388, 0.029489537701010704, -0.0027026745956391096, 0.01874280720949173, -0.0093074357137084, 0.05920296534895897, -0.007064535282552242, 0.013777242973446846, -0.06652737408876419, -0.023412518203258514, -0.03793339431285858, -0.02533157728612423, 0.029297631233930588, 0.001589220599271357, 0.03364749625325203, -0.05015140399336815, 0.015480407513678074, 0.03374345228075981, -0.06294512748718262, -0.020310038700699806, -0.012106062844395638, 0.0037621548399329185, -0.014888698235154152, -0.013393430970609188, -0.014536870643496513, 0.01770331710577011, 0.04880806431174278, -0.0153284827247262, 0.027938298881053925, -0.03393535688519478, 0.0601624958217144, -0.01978229731321335, 0.020022179931402206, 0.029937317594885826, 0.030513035133481026, 0.07471535354852676, -0.029329616576433182, 0.03145657107234001, -0.008195980452001095, 0.026403050869703293, -0.0038101314567029476, 0.00991513766348362, -0.01959039270877838, -0.06457632780075073, -0.013537360355257988, 0.02910572476685047, 0.0040060351602733135, -0.012529854662716389, 0.05651628226041794, -0.001434296602383256, 0.004985555075109005, -0.003984046168625355, 0.0406840480864048, -0.03566250950098038, -0.006160978227853775, 0.006600762717425823, -0.01206608209758997, 0.006588768679648638, 0.015432431362569332, 0.05862724781036377, -0.022596918046474457, 0.031264666467905045, -0.028577983379364014, -0.029713427647948265, -0.013993137516081333, -0.04308287054300308, -0.0366540253162384, -0.03399932384490967, 0.01834300346672535, -0.014992646872997284, -0.009067553095519543, -0.009243466891348362, -0.015488403849303722, 0.016919702291488647, -0.010418890044093132, 0.010498850606381893, -0.006013051141053438, 0.04199540242552757, 0.009075549431145191, 0.020150117576122284, 0.007832158356904984, 0.015088600106537342, -0.027522502467036247, -0.021109646186232567, -0.0057331882417202, -0.032751936465501785, -0.0010464867809787393, -0.05984264984726906, -0.012721761129796505, -0.01747942715883255, 0.03161649405956268, 0.025251615792512894, -0.02848203107714653, -0.01186618022620678, 0.002892581280320883, -0.005669219419360161, -0.028737906366586685, -0.02825814113020897, -0.041643574833869934, 0.019270548596978188, -0.02480383589863777, -0.01192215271294117, -0.03220820426940918, 0.06099408492445946, -0.034479089081287384, -0.05913899466395378, -0.028050243854522705, 0.02980937995016575, 0.021701356396079063, 0.026051223278045654, -0.026914799585938454, -0.023412518203258514, 0.00991513766348362, -0.0002468789170961827, 0.06464029848575592, -0.04919187352061272, -0.029377592727541924, -0.0012084073387086391, -0.028498023748397827, 0.017287520691752434, 0.03409527987241745, 0.004817637149244547, 0.07145296037197113, -0.05661223456263542, 0.022676877677440643, -0.04692098870873451, 0.036366164684295654, -0.029361600056290627, -0.012921663001179695, -0.04119579493999481, -0.024723874405026436, -0.02797028236091137, -0.0624653659760952, -0.008203976787626743, 0.02980937995016575, 0.023860298097133636, 0.013921172358095646, 0.008363897912204266, -0.026179160922765732, 0.04359462112188339, 0.0016351980157196522, -0.01903066597878933, 0.05037529394030571, -0.008883642964065075, -0.0038521108217537403, -0.09313832223415375, -0.04647320881485939, 0.016319995746016502, -0.014640819281339645, -0.05255022644996643, -0.037325695157051086, 0.0021009696647524834, 0.009859164245426655, -0.0006211953586898744, 0.004701694007962942, -0.009635274298489094, -0.014081094413995743, 0.01576826721429825, 0.032751936465501785, -0.007348395884037018, 0.013033607974648476, -0.05597255006432533, -0.03706981986761093, -0.012689776718616486, 0.013297478668391705, 0.015608345158398151, 0.013449403457343578, -0.007552295923233032, 0.005065515637397766, 0.07957696914672852, 0.032000306993722916, 0.016423944383859634, -0.0498635433614254, 0.05725192278623581, -0.019686345010995865, 0.00784815102815628, -0.007104515563696623, 0.0019480446353554726, -0.01284170150756836, 0.06806261837482452, -0.02870592102408409, 0.015552372671663761, 0.01823105849325657, -0.01177822332829237, -0.007764192298054695, 0.010610796511173248, -0.014840721152722836, 0.057060014456510544, -0.03921276703476906, 0.0372617244720459, -0.008763701654970646, -0.05175061896443367, 0.017607364803552628, -0.03777347505092621, -0.012777733616530895, 0.0029085734859108925, 0.009643270634114742, 0.014392941258847713, 0.05088704451918602, 0.014856713823974133, 0.0389568954706192, -0.03937269002199173, 0.031104745343327522, 0.03225617855787277, -0.029537513852119446, 0.015840230509638786, -0.013321466743946075, 0.020469961687922478, -0.002804624615237117, 0.023236604407429695, -0.048520203679800034, -0.014392941258847713, -0.0601624958217144, 0.014312980696558952, -0.01020299643278122, 0.014920682646334171, -0.019926227629184723, -0.012289972975850105, 0.03674997761845589, 0.01645592972636223, 0.011650286614894867, -0.014001132920384407, -0.026898806914687157, -0.00043053884292021394, -0.04909592121839523, 0.013921172358095646, -0.003612228436395526, 0.013913176022469997, 0.026962775737047195, -0.051942527294158936, -0.009379399940371513, -0.060482338070869446, 0.02510768547654152, 0.0026986764278262854, 0.02480383589863777, -0.0055892588570714, -0.0007936107576824725, 0.00590110570192337, -0.023972243070602417, -0.042954932898283005, 0.022421004250645638, -0.029953310266137123, -0.026738885790109634, 0.03118470497429371, 0.037101805210113525, -0.0315045490860939, -0.05760375037789345, -0.016583867371082306, -0.03161649405956268, 0.05312594398856163, 0.03287987411022186, -0.0447140708565712, -0.04624931886792183, 0.0094513650983572, -0.008915627375245094, -0.03118470497429371, 0.00022551440633833408, -0.013225513510406017, 0.014960662461817265, 0.039116814732551575, 0.011034588329494, -0.005537284538149834, -0.006600762717425823, -0.011962133459746838, -0.020437976345419884, -0.0332317017018795, -0.03351956233382225, 0.029537513852119446, -0.05450126901268959, 0.020262062549591064, -0.026099199429154396, -0.030353114008903503, 0.014384944923222065, 0.031200697645545006, -0.005581262521445751, -0.002932561794295907, 0.0153284827247262, 0.044618118554353714, 0.02344450168311596, 0.0018940711161121726, -0.013321466743946075, -0.02848203107714653, 0.07701822370290756, 0.0005117490072734654, 0.005545280408114195, 0.037325695157051086, -0.033551543951034546, -0.03225617855787277, 0.0010010090190917253, 0.013137556612491608, -0.02916969358921051, -0.05312594398856163, -0.021045679226517677, 0.036526087671518326, 0.01588021218776703, 0.02240501157939434, 0.009059556759893894, -0.0018930715741589665, -0.041643574833869934, -0.0062889158725738525, -0.005041527561843395, 0.020469961687922478, 0.021397504955530167, -0.011130541563034058, 0.002150945132598281, 0.021685365587472916, -0.047592658549547195, -0.005865123588591814, -0.010362917557358742, -0.0072924233973026276, -0.003204428358003497, 0.014097086153924465, -0.015552372671663761, -0.06844642758369446, 0.006009052973240614, 0.009075549431145191, 0.019158603623509407, -0.05203847959637642, 0.0045817531645298, -0.015064612030982971, -0.0007216460653580725, -0.03307177871465683, 0.014768756926059723, 0.025699395686388016, -0.027698416262865067, 0.06652737408876419, -0.01063478458672762, -0.042731042951345444, -0.02195723168551922, -0.003360352013260126, 0.0009840173879638314, -0.05357372388243675, -0.0072924233973026276, 0.0744594857096672, -0.03902086243033409, -0.04772059619426727, 0.0544373020529747, -0.037453632801771164, 0.020310038700699806, 0.0206298828125, 0.004341870546340942, 0.007196470629423857, 0.021365521475672722, -0.021989215165376663, 0.01920657977461815, 0.0029925324488431215, 0.0018550901440903544, 0.01235394086688757, -0.015552372671663761, 0.005081507842987776, -0.041003890335559845, -0.06208155304193497, -0.011514352634549141, -0.003178441198542714, 0.0010574813932180405, 0.017847247421741486, 0.021189607679843903, -0.006552786100655794, -0.0015582357300445437, 0.012617811560630798, 0.007652246858924627, 0.03943665698170662, -0.033615514636039734, -0.014728776179254055, 0.033551543951034546, -0.06176171079277992, -0.024787843227386475, 0.02608320862054825, 0.001806114218197763, 0.018982689827680588, 0.011818204075098038, 0.0009400389972142875, 0.0025467509403824806, 0.04935179650783539, 0.07062136381864548, 0.021285559982061386, 0.036302197724580765, -0.004709690343588591, 0.00488560413941741, -0.046505190432071686, 0.007916118018329144, -0.021157624199986458, 0.007740203756839037, -0.016088109463453293, 0.006416853051632643, 0.026722894981503487, 0.008539811708033085, 0.008691737428307533, 0.009515332989394665, 0.0014213029062375426, -0.016343984752893448, -0.0004840126202907413, 0.031488556414842606, 0.014912686310708523, 0.040492139756679535, -0.008867651224136353, 0.0306569654494524, -0.02051793783903122, -0.026323089376091957, 0.004030023701488972, 0.028322109952569008, -0.028354093432426453, 0.00604503508657217, 0.05824343487620354, -0.05398952215909958, 0.04321080818772316, -0.04714487865567207, -0.02469189092516899, 0.06166575849056244, 0.017575379461050034, 0.004917588084936142, -0.023220611736178398, 0.0008146004984155297, 0.00999509822577238, 0.03009723871946335, 0.004801644943654537, 0.008923623710870743, 0.008635764941573143, -0.007208464667201042, -0.036366164684295654, -0.04979957640171051, -0.060322415083646774, 0.03742164745926857, -0.04487399384379387, 6.784172728657722e-05, 0.009003584273159504, 0.02457994595170021, -0.036813944578170776, 0.0006551786791533232, -0.005809151101857424, 0.043242793530225754, -0.014728776179254055, -0.025651419535279274, 0.07887331396341324, -0.004477804061025381, 0.03278392180800438, -0.02326858788728714, 0.0107467295601964, -0.036526087671518326, -0.004917588084936142, 0.023972243070602417, -0.06329695880413055, 0.033327654004096985, -0.02125357650220394, -0.012977635487914085, 0.06748690456151962, 0.01632799208164215, -0.0028306117746979, -0.004453815519809723, 0.01598416082561016, -0.0200541652739048, 0.011650286614894867, -0.0007776186103001237, 0.041643574833869934, -0.050055451691150665, 0.020901748910546303, -0.06236940994858742, -0.04343469813466072, 0.021765325218439102, 0.010874666273593903, -0.0011714254505932331, 0.04145167022943497, 0.05897907540202141, 0.0458655059337616, 0.024164149537682533, -0.0030005283188074827, 0.02584332600235939, -0.02923366241157055, -0.013713274151086807, 0.05581262707710266, -0.021749332547187805, 0.01765534095466137, -0.0101710120216012, -0.008243956603109837, -0.05347777158021927, -0.023412518203258514, -0.05015140399336815, 0.01049085520207882, 0.03192034363746643, 0.0521664172410965, -0.020613890141248703, 0.032464079558849335, 0.011594314128160477, 0.009627277962863445, 0.0384131595492363, -0.020437976345419884, -0.016264023259282112, 0.014129070565104485, 0.025811340659856796, -0.015592352487146854, 0.006572776474058628, -0.04804043844342232, 0.03307177871465683, 0.026674916967749596, 0.015248521231114864, 0.009523329325020313, 0.015520388260483742, 0.0035802440252155066, -0.020613890141248703, -0.03374345228075981, -0.01816708967089653, 0.008659753017127514, -0.0034782940056174994, -0.006468827370554209, -0.10791507363319397, -0.03233614191412926, 0.008128013461828232, 0.01707962341606617, -0.04381851106882095, 0.011826200410723686, -0.007488327566534281, -0.045129865407943726, 0.022436996921896935, 0.03048105165362358, -0.010266964323818684, -0.05565270408987999, 0.007136499974876642, 0.007612266577780247, 0.031776417046785355, 0.005473315715789795, -0.019334517419338226, 0.009011580608785152, -0.010706748813390732, 0.006500811781734228, -0.0020000191871076822, 0.0036702000070363283, 0.03019319288432598, 0.019638368859887123, -0.008259949274361134, 0.05008743703365326, 0.0028905824292451143, -0.026722894981503487, -0.013121564872562885, -0.01696767844259739, -0.01065877266228199, 0.0009405387099832296, -0.010179007425904274, 0.028897827491164207, -0.03431916981935501, 0.0037521598860621452, -0.019110627472400665, -0.02537955343723297, 0.027634447440505028, 0.013009619899094105, -0.021013693884015083, 0.008611776866018772, 0.016072116792201996, -0.050119418650865555, -0.016887716948986053, 0.0035802440252155066, -0.02608320862054825, 0.0017041641985997558, 0.004093992058187723, 0.0075562940910458565, 0.04145167022943497, 0.02027805522084236, -0.0226289015263319, -0.04046015813946724, -0.016631843522191048, -0.03212824463844299, -0.021749332547187805, -0.02773039974272251, 0.018822768703103065, 0.004833629354834557, -0.005681213922798634, -0.043530650436878204, 0.03335963934659958, 0.04452216625213623, 0.00038880930515006185, 0.024723874405026436, 0.01989424228668213, 0.01057081576436758, -0.020533928647637367, 0.009291443042457104, -0.024276094511151314, 0.013577341102063656, 0.019174596294760704, 0.008899635635316372, -0.006688719615340233, -0.01730351336300373, 0.007232452742755413, -0.007476333528757095, -0.011754235252737999, -0.04247516766190529, 0.01223399955779314, 0.033487576991319656, 0.024739867076277733, -0.005277411546558142, -0.004933580290526152, -0.004153962712734938, -0.016999661922454834, -0.03684592992067337, 0.04193143546581268, -0.022596918046474457, -0.013377439230680466, 0.041003890335559845, 0.0012044092873111367, -0.015896202996373177, 0.004301890265196562, 0.02579534985125065, 0.012937654741108418, 0.018534909933805466, 0.0509829968214035, -0.0018141103209927678, -0.03700584918260574, -0.009547317400574684, 0.006920605897903442, -0.05075910687446594, -0.0010814695851877332, 0.04842425137758255, 0.01183419581502676, -0.01149036455899477, -0.0026966773439198732, -0.03054502047598362, 0.016583867371082306, 0.03614227473735809, -0.03879697248339653, -0.0014392940793186426, 0.011106552556157112, 0.014848717488348484, -0.041067857295274734, 0.03540663421154022, 0.0315205417573452, 0.014033117331564426, -0.03145657107234001, -0.06851039826869965, -0.03857308253645897, 0.01683974079787731, -0.05031132698059082, 0.023972243070602417, 0.020581906661391258, 0.004117980599403381, -0.05891510471701622, -0.04250715300440788, 0.009131521917879581, 0.0075043197721242905, 0.0003420822322368622, -0.022452987730503082, 0.02160540409386158, -0.0075043197721242905, -0.02504371851682663, 0.013441408053040504, 0.02280481532216072, 0.010298948734998703, 0.008064044639468193, -0.0023008715361356735, -0.008175990544259548, -0.03444710746407509, 0.03770950436592102, 0.04177151247859001, 0.021877270191907883, 0.018662847578525543, -0.02315664291381836, -0.021061670035123825, -0.008259949274361134, -0.024228118360042572, -0.01069075707346201, 0.003542262827977538, 0.013505376875400543, -0.04442621022462845, -0.0243560541421175, 0.005533286370337009, 0.003784144064411521, 0.04113182798027992, -0.017751293256878853, -0.016951685771346092, -0.0016152078751474619, 0.01943046972155571, -0.015032627619802952, 0.03060898743569851, -0.008175990544259548, 0.013625317253172398, 0.02825814113020897, -0.0024707883130759, 0.03278392180800438, -0.03713378682732582, -0.06236940994858742, -0.047080907970666885, 0.014648815616965294, -0.04052412509918213, 0.019558407366275787, -0.045705582946538925, -0.020421983674168587, 0.001525252009741962, 0.034063294529914856, 0.0452897883951664, -0.015088600106537342, -0.0015862220898270607, -0.016695812344551086, -0.03043307363986969, 0.008096029050648212, 0.008000076748430729, 0.018422964960336685, -0.002768642269074917, -0.014616831205785275, 0.0058771176263689995, -0.015472412109375, -0.002222909824922681, 0.024739867076277733, 0.014792745001614094, 0.01811911351978779, 0.010778713971376419, 0.033487576991319656, -0.03662203997373581, 0.004737676586955786, -0.011138536967337132, 0.004081998020410538, 0.007444349117577076, 0.0469849556684494, 0.007104515563696623, -0.005037529394030571, 0.0020210088696330786, 0.020533928647637367, -0.030241169035434723, 0.034191232174634933, -0.013841211795806885, -0.020469961687922478, 0.019238565117120743, -0.07266835868358612, -0.04084396734833717, -0.00043728554737754166, 0.013585337437689304, 0.05434134975075722, 0.010043074376881123, 0.012729756534099579, -0.020821787416934967, -0.03978848457336426, -0.023364542052149773, 0.015952177345752716, 0.010242976248264313, -0.014944670721888542, 0.013097576797008514, 0.019110627472400665, 0.046281300485134125, -0.02413216419517994, 0.023908274248242378, -0.01264179963618517, 0.0038061332888901234, 0.0011854185722768307, 0.0034483089111745358, -0.010322936810553074, -0.0005127485492266715, -0.03190435469150543, -0.05392555147409439, -0.004117980599403381, 0.018694831058382988, 0.026786861941218376, -0.027666430920362473, -0.003278392134234309, 0.03136061877012253, 0.0042978920973837376, 0.025699395686388016, -0.01048285886645317, 0.030800893902778625, -0.027202658355236053, -0.02509169466793537, -0.012593823485076427, -0.01611209847033024, -0.014824729412794113, -0.018646854907274246, -0.015776263549923897, -0.010754725895822048, -0.0035982353147119284, -0.01000309456139803, -0.015568364411592484, -0.00012718762445729226, -0.035054806619882584, 0.0032064274419099092, 0.005277411546558142, 0.0032923852559179068, -0.041803497821092606, 0.023876290768384933, 0.026227137073874474, 0.00968325138092041, -0.13535761833190918, -0.01558435708284378, 0.017111606895923615, -0.017159584909677505, -0.0029085734859108925, -0.016120094805955887, 0.012449894100427628, 0.03072093240916729, 0.03729370981454849, -0.026850830763578415, 0.005649229511618614, -0.023236604407429695, -0.017319506034255028, -0.015408443287014961, 0.016695812344551086, -0.02309267409145832, 0.008443858474493027, 0.017783278599381447, 0.0050775096751749516, -0.013921172358095646, -0.03329567238688469, -0.030624980106949806, 0.026435034349560738, 0.033103764057159424, -0.021525442600250244, -0.011962133459746838, -0.019398486241698265, -0.0073124137707054615, 0.033839404582977295, 0.01747942715883255, -0.010610796511173248, 0.02865794487297535, 0.0005152472876943648, 0.0458655059337616, 0.013849208131432533, -0.011698262766003609, -0.051270853728055954, -0.009699243120849133, 0.01172225084155798, -0.012417909689247608, -0.021589411422610283, -0.024739867076277733, 0.018838761374354362, -0.008683741092681885, 0.012417909689247608, 0.003830121597275138, 0.00977120827883482, -0.007712217513471842, 0.01165828201919794, -0.010722741484642029, -0.0005527289467863739, -0.00013368442887440324, 0.014177046716213226, 0.0041259764693677425, 0.008379890583455563, -0.0002596226695459336, -0.010522839613258839, -0.0016561876982450485, 0.018982689827680588, -0.018838761374354362, 0.043178822845220566, 0.010107043199241161, 0.01759137213230133, -0.033039797097444534, -0.007340400014072657, -0.01094663143157959, -0.01071474514901638, 0.05021537095308304, 0.012865690514445305, -0.0052174413576722145, -0.039052847772836685, -0.010522839613258839, -0.008627768605947495, -0.004081998020410538, 0.006612756755203009, 0.008899635635316372, 0.014616831205785275, 0.011442388407886028, 0.002712669549509883, 0.014872705563902855, 0.04420232027769089, -0.006280919536948204, -0.0035982353147119284, -0.01025896891951561, -0.0016861730255186558, -0.009891148656606674, 0.00118142063729465, -0.055332861840724945, 0.007928111590445042, 0.015144572593271732, 0.021861277520656586, -0.0007276431424543262, 0.015376458875834942, 0.016999661922454834, 0.020421983674168587, -0.019526423886418343, 0.016176067292690277, 0.006093011703342199, 0.029761403799057007, -0.010450874455273151, 0.02453196793794632, -0.0013733265222981572, -0.008715725503861904, -0.06118599325418472, -0.0197663065046072, -0.008643760345876217, 0.014968658797442913, -0.005509297829121351, -0.003782144980505109, -0.007108513731509447, 0.014296988025307655, 0.02138151414692402, -0.0050975000485777855, 0.02744254097342491, 0.005333384498953819, 0.015592352487146854, 0.04145167022943497, 0.004881605971604586, -0.004917588084936142, -0.013369442895054817, -0.006760684307664633, 0.01754339598119259, -0.003402331378310919, -0.009595294483006, -0.055045004934072495, -0.012937654741108418, 0.014025121927261353, 0.022452987730503082, 0.0072404490783810616, -0.005521292332559824, -0.03566250950098038, 0.0389888770878315, -0.02182929404079914, 0.0035702490713447332, 0.01903066597878933, -0.026914799585938454, 0.013681289739906788, 0.022165128961205482, -0.028609968721866608, 0.008403878659009933, 0.0006786671583540738, -0.002232905011624098, 0.033327654004096985, 0.0011924152495339513, -0.003470298135653138, 0.04132373258471489, -0.02870592102408409, -0.004465810023248196, -0.007052541244775057, 0.012961642816662788, 0.033039797097444534, -0.02200520783662796, -0.007552295923233032, 0.007380380295217037, 0.01741545833647251, 0.02475585788488388, 0.005949082318693399, 0.0015852225478738546, 0.018694831058382988, 0.059746697545051575, 0.02619515359401703, 0.012601819820702076, 0.010498850606381893, 0.0016302005387842655, 0.03187236934900284, -0.0036821940448135138, -0.028577983379364014, -0.016743788495659828, 0.00042454179492779076, -0.0008775696041993797, -0.014209031127393246, 0.010298948734998703, 0.04941576346755028, 0.020437976345419884, 0.01576826721429825, 0.024563953280448914, 0.009387396275997162, -0.001054482883773744, 0.010123034939169884, 0.022421004250645638, -0.018023161217570305, 0.014568855054676533, 0.0015722289681434631, 0.021909255534410477, 0.03134462609887123, 0.026291105896234512, 0.011994117870926857, 0.010210991837084293, -0.0005207445938140154, 0.0025467509403824806, 0.03176042437553406, 0.06812658905982971, 0.0016731794457882643, -0.013553353026509285, -0.008995587937533855, -0.014081094413995743, 0.05603651702404022, 0.016144081950187683, -0.013921172358095646, -0.014776753261685371, 0.011850188486278057, 0.04439422860741615, 0.003176442114636302, -0.005653227213770151, 0.002178931375965476, 0.038828957825899124, -0.024627922102808952, -0.027538493275642395, -0.01140240766108036, 0.027810361236333847, -0.027298612520098686, 0.02830611728131771, -0.0240681953728199, 0.006816656794399023, -0.03048105165362358, 0.006452835164964199, -0.018662847578525543, -0.010706748813390732, 0.01609610579907894, -0.0051694647409021854, -0.018982689827680588, -0.014816733077168465, -0.019526423886418343, 0.051142916083335876, 0.01515256892889738, 0.0040779998525977135, -0.017959192395210266, -0.030624980106949806, -0.03271995112299919, -0.003204428358003497, -0.004113982431590557, 0.01987825147807598, -0.007560292258858681, 0.006544790230691433, -0.0332317017018795, -0.01077071763575077, 0.019926227629184723, -0.02579534985125065, -0.014432922005653381, 0.004557764623314142, 0.052646178752183914, 0.03815728798508644, -0.009523329325020313, 0.016711803153157234, -0.005133482161909342, 0.012257988564670086, 0.03540663421154022, 0.009803191758692265, -0.011914157308638096, -0.01217802707105875, -0.006936598103493452, -0.019270548596978188, 0.0153284827247262, -0.022964736446738243, -0.026626940816640854, -0.01685573346912861, 0.024436015635728836, 0.015944181010127068, -0.010642779991030693, 0.026227137073874474, -0.0028026255313307047, 0.0538615845143795, 0.021765325218439102, -0.011154529638588428, 0.015888208523392677, -0.004625731147825718, -0.0031824391335248947, -0.010818693786859512, -0.00023176133981905878, 0.008211972191929817, -0.015408443287014961, 0.027122698724269867, 0.019926227629184723, -0.020390000194311142, 0.007660243194550276, 0.014416929334402084, 0.03409527987241745, -0.03537465259432793, 0.0452897883951664, -0.032975826412439346, -0.01863086223602295, -0.017687326297163963, 0.01082669012248516, -0.003096481319516897, 0.016711803153157234, -0.0019860260654240847, -0.03243209421634674, -0.05897907540202141, 0.024659905582666397, -0.006372874602675438, 0.012162035331130028, 0.009707239456474781, 0.009459360502660275, 0.0035182745195925236, -0.011762231588363647, 0.012194019742310047, 0.009443368762731552, 0.005161468405276537, 0.033839404582977295, -0.032576024532318115, 0.012042094022035599, 0.0055612726137042046, 0.023428509011864662, -0.023172635585069656, 0.002424810780212283, 0.037453632801771164, 0.03060898743569851, -0.0378374420106411, -0.00979519635438919, -0.013377439230680466, 0.013601329177618027, 0.03270396217703819, 0.0029525519348680973, 0.0016831745160743594, -0.015064612030982971, 0.015664316713809967, 0.014121074229478836, -0.028290124610066414, 0.0016731794457882643, -0.024340063333511353, -0.008531815372407436, 0.016487913206219673, 0.0056332373060286045, 0.014992646872997284, 0.012082074768841267, -0.01930253393948078, -0.01616807095706463, -0.0063408901914954185, -0.022500963881611824, -0.012074078433215618, -0.014280996285378933, 0.00613299198448658, 0.017911216244101524, 0.002796628512442112, -0.012249992229044437, 0.003040508832782507, 0.003322370583191514, 0.02528359927237034, -0.04074801504611969, -0.015232529491186142, 0.016343984752893448, 0.014656811952590942, -0.00578916072845459, 0.027874330058693886, 0.003788142232224345, 0.025827333331108093, -0.026674916967749596, -0.027058729901909828, 0.030241169035434723, -0.02373236045241356, 0.11846990138292313, -0.029089733958244324, -0.015656322240829468, -0.005125486291944981, -0.0016032137209549546, 0.02355644665658474, 0.006636745296418667, 0.006037039216607809, -0.04052412509918213, -0.011394411325454712, -0.0160481296479702, 0.007424358744174242, 0.007152492180466652, -0.009491344913840294, -0.004469807725399733, 0.019702337682247162, 0.003970053046941757, 0.030001286417245865, 0.013897184282541275, 0.026147175580263138, 0.014872705563902855, 0.026722894981503487, -0.030688948929309845, -0.01235394086688757, 0.0027206656523048878, 0.025715388357639313, -0.0063608805648982525, 0.002570739248767495, 0.01226598396897316, 0.0018540907185524702, -0.026722894981503487, -0.011066572740674019, 0.0029365597292780876, 0.017687326297163963, -0.0002554997045081109, 0.00321042537689209, -0.03982046991586685, -0.015432431362569332, 0.0038441147189587355, 0.012649795971810818, -0.03793339431285858, 0.018374988809227943, 0.01129046268761158, 0.010682760737836361, -0.045641615986824036, -0.013937165029346943, -0.011210502125322819, -0.011410403996706009, 0.0003031013475265354, 0.007392374332994223, -0.016695812344551086, 0.003926074597984552, 0.0027806363068521023, -0.017159584909677505, 0.0041259764693677425, -0.03339162468910217, -0.00499754911288619, 0.04087595269083977, 0.009923133067786694, 0.004513786174356937, -0.04653717577457428, -0.006976578384637833, -0.018774792551994324, 0.018422964960336685, -0.015592352487146854, -0.024228118360042572, 0.0025847323704510927, 0.03259201720356941, -0.01707962341606617, 0.01650390587747097, 0.009315431118011475, -0.02056591399013996, 0.009051560424268246, -0.013441408053040504, -0.0028725911397486925, -0.0006281919195316732, -0.0183270126581192, 0.00997111015021801, 0.03371146693825722, 0.03627021238207817, -0.0009485348127782345, -0.02171734906733036, 0.01197812519967556, -0.0005162468296475708, -0.006596764549612999, -0.02745853364467621, 0.03129665181040764, 0.0020889753941446543, -0.023428509011864662, 0.0035522577818483114, -0.0018680838402360678, 0.02624312974512577, -0.004549768753349781, -0.008595784194767475, -0.0106028001755476, 0.01959039270877838, -0.01714359223842621, -0.026850830763578415, 0.021173615008592606, 3.073492553085089e-05, 0.025587450712919235, 0.004038019571453333, -0.015712294727563858, 0.0108906589448452, -0.039692532271146774, -0.006336892023682594, -0.023860298097133636, -0.021413497626781464, -0.005277411546558142, -0.008563799783587456, -0.0030724932439625263, 0.0010010090190917253, 0.0252196304500103, 0.013625317253172398, -0.003990042954683304, -0.015520388260483742, -0.005869121756404638, 0.03870102018117905, 0.007040547206997871, -0.04516185075044632, 0.03107276000082493, -0.007404368836432695, 0.019238565117120743, -0.021461473777890205, 0.01787923090159893, -0.013761251233518124, -0.012257988564670086, 0.026722894981503487, -0.01949443854391575, -0.02286878414452076, -0.0067766765132546425, 0.02573138102889061, 0.03136061877012253, -0.0020629882346838713, 0.02568340301513672, 0.03233614191412926, 0.004649719689041376, -0.023300573229789734, -0.03678195923566818, 0.0106028001755476, 0.013977144844830036, 0.042379215359687805, 0.0081679942086339, 0.006980576552450657, 0.03540663421154022, 0.011930149048566818, 0.0008740713237784803, -0.00999509822577238, -0.02195723168551922, -0.0012024103198200464, 0.003348357742652297, -0.032240189611911774, -0.023108666762709618, 0.03431916981935501, -0.013113568536937237, -0.0010364917106926441, 0.01690370962023735, -0.008883642964065075, 0.006880625616759062, -0.014896693639457226, -0.003304379293695092, -0.00127137650270015, 0.006800664588809013, 0.02269287034869194, 0.028226157650351524, -0.005693207960575819, -0.018726816400885582, -0.008195980452001095, 0.018023161217570305, -0.011442388407886028, 0.024164149537682533, 0.010242976248264313, -0.00038456139736808836, -0.011242486536502838, -0.005953080486506224, -0.011962133459746838, 0.002504771575331688, 0.04465010017156601, -0.017047639936208725, 0.004022027365863323, 0.005605251062661409, -0.019702337682247162, 0.014544866979122162, 0.007584280334413052, -0.0008500830736011267, 0.0005497303791344166, -0.0076762354001402855, 0.00982718076556921, 0.012809718027710915, -0.0015552372206002474, 0.012705768458545208, -0.01550439652055502, -0.0056852116249501705, -0.02240501157939434, 0.01025896891951561, 0.03248007223010063, -0.003386339172720909, 0.0538615845143795, 0.026722894981503487, -0.004309886135160923, 0.035790447145700455, -0.014744768850505352, -0.03088085539638996, -0.010091050527989864, 0.0389568954706192, -0.005713197868317366, 0.003678196109831333, 0.025763364508748055, 0.007412364706397057, -0.009891148656606674, 0.01783125475049019, 0.015592352487146854, -0.004165956750512123, 0.021045679226517677, -0.001498265191912651, 0.04301890358328819, 0.01177822332829237, 0.023012714460492134, -0.016887716948986053, -0.008691737428307533, -0.006672727409750223, 0.014328972436487675, 0.05875518545508385, -0.034415122121572495, -0.01125847827643156, 0.01879078522324562, -0.0025747371837496758, -0.0016821749741211534, 0.015352470800280571, -0.019334517419338226, 0.012857694178819656, -0.03547060489654541, 0.013033607974648476, -0.018982689827680588, 0.005073511973023415, -0.011098557151854038, -0.029537513852119446, 0.0022189116571098566, 0.02280481532216072, -0.01206608209758997, -0.020358014851808548, 0.02905774861574173, 0.0020469960290938616, 0.007856147363781929, -0.012929658405482769, 0.025651419535279274, 0.0107467295601964, 0.026610948145389557, -0.03754958510398865, 0.03479893505573273, 0.0243560541421175, 0.01987825147807598, -0.004961566533893347, -0.027026744559407234, 0.02171734906733036, -0.02704273723065853, 0.01971832849085331, -0.022788822650909424, 0.027266627177596092, -0.017239544540643692, -0.05197450891137123, 0.012106062844395638, 0.035790447145700455, 0.004157960880547762, -0.002322860760614276, -0.002430807799100876, 0.0003305878781247884, 0.018071137368679047, 0.0014043112751096487, 0.004533776547759771, -0.005137480329722166, 0.02298072911798954, 0.020645873621106148, 0.006740693934261799, 0.006988572422415018, 0.057060014456510544, -0.023060690611600876, -0.025875309482216835, 0.005265417508780956, -0.006644741166383028, 0.005697205662727356, 0.025603443384170532, 0.03479893505573273, -0.021077662706375122, -0.010266964323818684, 0.040716029703617096, -0.017287520691752434, 0.016663827002048492, 0.004693698137998581, -0.010722741484642029, 0.0209177415817976, 0.00953932199627161, 0.0029065744020044804, -0.02480383589863777, 0.0027706411201506853, 0.001371327438391745, -0.0197663065046072, -0.01719156838953495, 0.005981066729873419, 0.0464092381298542, -0.014432922005653381, -0.008064044639468193, -0.023108666762709618, 0.013433411717414856, 0.025427529588341713, 0.017159584909677505, -0.002640704857185483, 0.039276737719774246, 0.009555313736200333, -0.007600272540003061, -0.01931852474808693, -0.0057052019983530045, -0.031952328979969025, 0.016024140641093254, 0.012162035331130028, -0.028577983379364014, -0.015320486389100552, -0.007244447246193886, 0.008259949274361134, 0.0332317017018795, -0.025539474561810493, -0.022421004250645638, 0.007084525655955076, -0.011306454427540302, 0.027202658355236053, -0.03116871416568756, -0.007452344987541437, 0.041739530861377716, 0.0024747862480580807, -0.012226004153490067, 0.011642290279269218, -0.03300781175494194, 0.03291185945272446, -0.021573418751358986, 0.01965436153113842, 0.025715388357639313, 0.0008620772277936339, 0.018710823729634285, 0.041643574833869934, -0.029153702780604362, -0.010290953330695629, -0.02182929404079914, -0.023572439327836037, -0.026834839954972267, 0.0006851639482192695, 0.02577935717999935, -0.03273594379425049, -0.028274133801460266, 0.007108513731509447, -0.026323089376091957, 0.011674274690449238, -0.0014492892660200596, -0.015024631284177303, 0.011210502125322819, 0.025571458041667938, 0.010011089965701103, 0.009979105554521084, 0.02688281610608101, -0.010730736888945103, -0.013385435566306114, -0.03212824463844299, -0.031488556414842606, 0.03083287924528122, 0.0023088676389306784, 0.0007376382127404213, 0.0091635063290596, -0.013457399792969227, -0.001142439665272832, -0.007524309679865837, -0.009243466891348362, -0.007872139103710651, 0.04765662923455238, 0.03422321379184723, 0.02923366241157055, 0.014296988025307655, 0.005281409714370966, -0.02166937291622162, -0.019734321162104607, 0.005837137345224619, -0.015136576257646084, 0.02102968655526638, -0.046729084104299545, -0.03112073801457882, -0.009339419193565845, 0.009675255045294762, 0.003678196109831333, -0.02023007906973362, 0.00764824915677309, 0.02211715281009674]",CHAI: Clustered Head Attention for Efficient LLM Inference.pdf
