text,embedding,file
"KTO: Model Alignment as Prospect Theoretic Optimization
Kawin Ethayarajh1Winnie Xu2Niklas Muennighoff2Dan Jurafsky1Douwe Kiela1 2
Abstract
Kahneman & Tversky’s prospect theory tells us
that humans perceive random variables in a biased
but well-defined manner (1992); for example, hu-
mans are famously loss-averse. We show that ob-
jectives for aligning LLMs with human feedback
implicitly incorporate many of these biases—the
success of these objectives (e.g., DPO) over cross-
entropy minimization can partly be ascribed to
them belonging to a family of loss functions that
we call human-aware losses (HALOs). However,
the utility functions these methods attribute to hu-
mans still differ from those in the prospect theory
literature. Using a Kahneman-Tversky model of
human utility, we propose a HALO that directly
maximizes the utility of generations instead of
maximizing the log-likelihood of preferences, as
current methods do. We call this approach KTO,
and it matches or exceeds the performance of
preference-based methods at scales from 1B to
30B, despite only learning from a binary signal
of whether an output is desirable. More broadly,
our work suggests that there is no one HALO that
is universally superior; the best loss depends on
the inductive biases most appropriate for a given
setting, an oft-overlooked consideration.
1. Introduction
Aligning generative models with human feedback has been
successfully used to make generations more helpful, factual,
and ethical, among other desiderata (Ouyang et al., 2022;
Tian et al., 2023). For LLMs, alignment methods such as
RLHF and DPO have consistently proven to be more benefi-
cial than doing supervised finetuning (SFT) alone. However,
human feedback is often discussed only in the context of
preferences (e.g., output yw≻ylfor input x), even though
it can take many forms (e.g., approval/disapproval of ygiven
1Stanford University (first author was an intern at Contex-
tual AI)2Contextual AI. Correspondence to: Kawin Ethayarajh
<kawin@stanford.edu >.
Proceedings of the 41stInternational Conference on Machine
Learning , Vienna, Austria. PMLR 235, 2024. Copyright 2024 by
the author(s).
Figure 1. The utility that a human gets from the outcome of a
random variable, as implied by different human-aware losses (HA-
LOs). Notice that the implied value functions share properties
such as loss aversion with the canonical human value function in
prospect theory (Tversky & Kahneman, 1992).
x). This is because preferences, despite being a kind of data
that is relatively scarce and expensive to collect in practice
(Casper et al., 2023), are required by the alignment methods
shown to work best—RLHF (Christiano et al., 2017) and
DPO (Rafailov et al., 2023).
To understand why these methods work so well, and whether
feedback needs to be in preference form, we frame align-
ment through the lens of prospect theory (Kahneman &
Tversky, 1979; Tversky & Kahneman, 1992). Prospect the-
ory explains why humans make decisions about uncertain
events that do not maximize their expected value. It formal-
izes how humans perceive random variables in a biased but
well-defined manner; for example, relative to some refer-
ence point, humans are more sensitive to losses than gains,
a property called loss aversion . We show that popular align-
ment methods such as DPO and PPO-Clip (Schulman et al.,
2017) implicitly model some of these biases, helping ex-
plain their success independently of the data used ( §3.2).
We then propose a more general class of such loss functions
called human-aware losses (HALOs).1
1We use the term human-aware to draw an analogy with how
hardware-aware methods benefit from being designed around hard-
ware limitations (Dao et al., 2022), not to claim that a simple loss
function is fully aware of human behavior.
1arXiv:2402.01306v2  [cs.LG]  3 Jun 2024
Model Alignment as Prospect Theoretic Optimization
Although it is impossible to say that HALOs are categori-
cally better than non-HALOs, we find that among existing
methods, those that meet the definition of a HALO work
better","[-0.03251323848962784, 0.028053956106305122, 0.04487504065036774, 0.044903263449668884, 0.02575375698506832, -0.010414396412670612, -0.009864041581749916, 0.02994491718709469, 0.008579881861805916, 0.018429812043905258, 0.024413151666522026, -0.04024641960859299, -0.004723874386399984, -0.02788461744785309, 0.020250214263796806, -0.005408288910984993, 0.024145029485225677, -0.060623638331890106, 0.012404138222336769, 0.02734837308526039, -0.0007183710695244372, 0.0015540452441200614, -0.005418872926384211, 0.049418993294239044, 0.012255966663360596, -0.024709496647119522, 0.04368966072797775, 0.05037858337163925, 0.01038617268204689, -0.033275265246629715, 0.08094441145658493, -0.03485577180981636, -0.04182692617177963, -0.0011668568477034569, -0.02279031090438366, 0.053116243332624435, 0.018966054543852806, 0.02279031090438366, -0.0104214521124959, -0.0035314399283379316, 0.016595298424363136, -0.031356081366539, 0.01948818564414978, 0.04851584509015083, 0.0030445880256593227, 0.02338300086557865, 0.02154848724603653, -0.004106489475816488, -0.015438143163919449, 0.001352954306639731, -0.053934719413518906, 0.03256968408823013, -0.010470842942595482, 0.007867244072258472, -0.008269425481557846, 0.004632148426026106, 0.02516106888651848, 0.007860188372433186, 0.03231567516922951, -0.0002135489194188267, -0.025697311386466026, -0.017865346744656563, 0.004505143500864506, 0.02613477222621441, -0.03383973240852356, -0.013462511822581291, -0.08173466473817825, 0.0065795560367405415, 0.0003779275866691023, 0.026967359706759453, 0.016835195943713188, 0.010915359482169151, 0.02190127782523632, 0.019050724804401398, -0.012771041132509708, -0.01968574896454811, 0.018853161484003067, 0.08399252593517303, 0.011388099752366543, -0.009595920331776142, 0.0025647920556366444, 0.003926565870642662, 0.04493148624897003, -0.02890065498650074, 0.005619963631033897, -0.017216211184859276, -0.040895555168390274, -0.010781299322843552, -0.06141389161348343, -0.00477326475083828, -0.02544330060482025, -0.009892265312373638, -0.013081497512757778, -0.02628999948501587, 0.0124676413834095, 0.0048755742609500885, -0.004042987246066332, 0.011437490582466125, 0.06034140661358833, -0.010922415181994438, -0.014464438892900944, -0.015607482753694057, 0.03341638296842575, -0.010682517662644386, 0.058478668332099915, -0.00783902034163475, -0.011896119453012943, 0.024497821927070618, 0.02132270112633705, 0.027009693905711174, -0.06971154361963272, -0.004635676275938749, -0.05317268893122673, 0.008720998652279377, 4.624872235581279e-05, -0.07371924817562103, -0.07682381570339203, 0.03155364468693733, 0.020800570026040077, -0.0017833595629781485, -0.012672260403633118, -0.014288043603301048, 0.05255177617073059, 0.013116776943206787, -0.005563517101109028, -0.022268179804086685, 0.04069799184799194, -0.03956906124949455, -0.012975660152733326, -0.038214344531297684, -0.004805016331374645, 0.047866709530353546, -0.004635676275938749, -0.052297767251729965, -0.07648513466119766, -0.009236074052751064, -0.0033127092756330967, -0.0011315777665004134, 0.003572010900825262, -0.039738401770591736, 0.001283277990296483, -0.070953369140625, -0.05760374665260315, -0.02181660756468773, -0.07157427817583084, 0.013575405813753605, 0.023862797766923904, 0.005898668896406889, -0.040980227291584015, 0.05257999897003174, 0.028406746685504913, -0.036746732890605927, -0.04854406788945198, 0.041601140052080154, 0.006096231751143932, -0.03403729572892189, -0.025076398625969887, 0.022691529244184494, -0.00477326475083828, -0.032259225845336914, 0.03951261565089226, 0.04507260397076607, 0.0009860513964667916, 0.013250837102532387, 0.03578713908791542, -0.0002963446022477001, -0.0010133926989510655, 0.014097535982728004, -0.04106489568948746, -0.02551385946571827, -0.008960896171629429, 0.0008220035233534873, -0.049531884491443634, -0.013293172232806683, 0.011197593063116074, -0.0006500178133137524, -0.015480478294193745, -0.02061711810529232, -0.02053244784474373, -0.04462103173136711, -0.015649817883968353, 0.03084806352853775, -0.002208472928032279, -0.01789356954395771, -0.05139462277293205, 0.008050695061683655, -0.023989802226424217, -0.009574753232300282, -0.010096884332597256, 0.04936254397034645, 0.020391331985592842, 0.02279031090438366, 0.06180901825428009, -0.017216211184859276, -0.0010892428690567613, -0.02310076728463173, 0.04882630333304405, 0.06209124997258186, -0.008332927711308002, -0.02901354804635048, 0.020405443385243416, 0.014774895273149014, 0.05565633997321129, -0.07078402489423752, -0.011606830172240734, 0.033162374049425125, 0.00393714988604188, 0.014619667083024979, -0.02675568498671055, -0.023510005325078964, 0.039738401770591736, -0.00865749642252922, 0.03849657624959946, 0.03488399460911751, -0.002587723545730114, -0.043350983411073685, -0.04998345673084259, 0.035533130168914795, -0.02668512612581253, 0.08263780921697617, 0.001963282935321331, 0.01734321564435959, 0.0009102012845687568, 0.012785153463482857, -0.022000059485435486, -0.011183480732142925, 0.030086033046245575, -0.04239138960838318, 0.050660815089941025, -0.04352032393217087, 0.05932536721229553, -0.020405443385243416, -0.018740268424153328, -0.00497082807123661, 0.00464978814125061, -0.04131890460848808, -0.00750739686191082, -0.01532525010406971, 0.012474697083234787, -0.03908926621079445, -0.015974385663866997, -0.004215854685753584, 0.012820431962609291, -0.0003150866541545838, 0.0047556255012750626, 0.05150751397013664, -0.04281473904848099, 0.0146478908136487, 0.012827487662434578, -0.015240579843521118, 0.04391545057296753, -0.013949364423751831, -0.004053570795804262, 0.0016298952978104353, -0.011239927262067795, -0.012079570442438126, 0.00496024452149868, -0.005926892161369324, -0.026783907786011696, -0.004819127731025219, -0.010019269771873951, -0.008629272691905499, -0.01590382680296898, 0.03801678121089935, -0.022112952545285225, -0.010943583212792873, -0.03942794352769852, -0.011148202233016491, -0.017300879582762718, -0.030594052746891975, 0.02154848724603653, 0.019262399524450302, -0.031186742708086967, 0.0012603466166183352, -0.03691606968641281, -0.05582568049430847, 0.013060330413281918, 0.03745231404900551, -0.008085974492132664, -0.014845454134047031, -0.032259225845336914, 0.037367645651102066, 0.0493907667696476, -0.018951943144202232, 0.02531629614531994, 0.01809113286435604, -0.02283264696598053, -0.027447154745459557, -0.03262612968683243, 0.004071210511028767, 0.004981411620974541, -0.043859001249074936, 0.039738401770591736, -0.0406133234500885, 0.036464497447013855, 0.03496866300702095, 0.015000682324171066, -0.04267362505197525, -0.015762710943818092, 0.016115501523017883, 0.04476214945316315, 0.005775191821157932, -0.01590382680296898, -0.001700453576631844, 0.007295722141861916, -0.00041122225229628384, 0.013935252092778683, 0.03917393460869789, 0.006625418551266193, -0.006113871466368437, 0.039032816886901855, 0.004956716205924749, 0.004713290371000767, 0.014803119003772736, -0.042222052812576294, -0.03652094677090645, 0.05480964109301567, -0.030368266627192497, -0.017131540924310684, 0.011769114062190056, -0.05613613501191139, -0.06767946481704712, 0.001009864849038422, -0.027475379407405853, 0.003132785903289914, -0.01507124025374651, 0.00369019596837461, 0.00624440424144268, -0.011465714313089848, -0.022493967786431313, -0.005775191821157932, -0.007493284996598959, -0.007172245066612959, -0.01378708053380251, 0.0033779756631702185, -0.0014473259216174483, -0.022889092564582825, 0.05018102005124092, 0.011677389033138752, -0.02952156774699688, -0.07620289921760559, -0.04648377001285553, -0.04289941117167473, -0.034291304647922516, -0.011119978502392769, -0.018486259505152702, 0.008876226842403412, -0.009087901562452316, 0.027023805305361748, 0.010294447652995586, -0.03426308184862137, -0.024638937786221504, 0.025104621425271034, 0.024130918085575104, -0.05026569217443466, 0.04625798389315605, -0.002813509898260236, -0.016440069302916527, -0.0032809581607580185, -0.006011561956256628, -0.00026790081756189466, -0.012622869573533535, 0.016242505982518196, -0.0002720902266446501, 0.035025108605623245, -0.004730930086225271, -0.0036231656558811665, -0.014845454134047031, 0.009306631982326508, -0.001689869910478592, -0.017258545383810997, 0.01069662906229496, -0.04535483568906784, 0.02010909840464592, -0.05503542721271515, 0.02360878698527813, -0.004289940930902958, 0.013998755253851414, -0.005242477171123028, 0.013942308723926544, 0.007973081432282925, -0.0013450164115056396, 0.00013262743595987558, -0.027602383866906166, 0.006480774376541376, 0.028872432187199593, -0.016087278723716736, -0.02489294670522213, -0.048600517213344574, -0.026713348925113678, 0.03925860673189163, 0.012919213622808456, -0.06395398825407028, 0.03849657624959946, 0.012023123912513256, 0.007958969101309776, -0.004378138575702906, 0.03714185953140259, 0.05797065049409866, 0.035730693489313126, -0.06903418153524399, -0.0017551361816003919, -0.053116243332624435, 0.001651944825425744, -0.043548546731472015, -0.02854786440730095, -0.020024428144097328, 0.05362426117062569, 0.008135365322232246, 0.029803801327943802, 0.06045430153608322, -0.045608848333358765, 0.023933354765176773, -0.022747976705431938, 0.029860246926546097, -0.02863253466784954, 0.01437271386384964, 0.03186410292983055, 0.036662060767412186, 0.03587180748581886, -0.0140058109536767, -0.03581536188721657, 0.016552962362766266, -0.06259927153587341, -0.04453635960817337, 0.0016334232641384006, 0.04301230236887932, -0.03468643128871918, 0.03169476240873337, -0.09629788994789124, -0.02411680668592453, 0.054245173931121826, 0.011896119453012943, -0.036492720246315, -0.06417977809906006, -0.001213601790368557, 0.028420859947800636, 0.008495212532579899, 0.028491416946053505, -0.03262612968683243, 0.016835195943713188, 0.02294554002583027, -0.05574100837111473, -0.01835925504565239, -0.007648513186722994, 0.019191840663552284, -0.02610654942691326, 0.01937529258430004, -0.038299012929201126, -0.01984097808599472, -0.00966647919267416, 0.033896178007125854, 0.05926892161369324, -0.03002958744764328, 0.011522160843014717, -0.0019103643717244267, 0.05266467109322548, -0.009327799081802368, 0.04205271229147911, -0.008036583662033081, -0.013688298873603344, -0.021802496165037155, -0.0032262755557894707, -0.019234176725149155, 0.0008440529345534742, 0.020179657265543938, 0.003256262745708227, -0.0022843230981379747, -0.04504438117146492, 0.001966811018064618, 0.014048146083950996, -0.04507260397076607, 0.018810827285051346, -0.023157214745879173, -0.047471582889556885, 0.012361804023385048, 0.04758447781205177, -0.005411817226558924, 0.017103318125009537, -0.02225406840443611, 0.00787429977208376, -0.05235421285033226, -0.018853161484003067, 0.007066407706588507, 0.030594052746891975, 0.012502919882535934, 0.029041770845651627, 0.03076339326798916, -0.02104046754539013, 0.03883525729179382, 0.006399632431566715, -0.05328558385372162, 0.07840431481599808, -0.01687753014266491, -0.0069605703465640545, -0.03084806352853775, 0.025344520807266235, 0.035730693489313126, -0.005013163201510906, -0.002945806598290801, 0.013801191933453083, -0.036774955689907074, -0.02260686084628105, 0.044592808932065964, 0.02610654942691326, 0.028449082747101784, 0.012813376262784004, -0.010611959733068943, -0.01882493868470192, 0.05001167953014374, -0.042842961847782135, 0.028025733307003975, -0.02088523842394352, 0.026699237525463104, -0.00034860181040130556, 0.03115851804614067, -0.024257922545075417, 0.00017882103566080332, 0.00032258345163427293, 0.015282914973795414, -0.017258545383810997, -0.022620972245931625, -0.026007767766714096, 0.008339984342455864, -0.008043639361858368, 0.0114516019821167, -0.062712162733078, -0.06976798921823502, -0.026473451405763626, -0.00904556643217802, 0.019008390605449677, 0.003647861070930958, 0.03838368132710457, 0.016595298424363136, -0.028053956106305122, -0.019784530624747276, 0.01641184650361538, -0.043859001249074936, -0.02194361202418804, -0.007810797076672316, -0.00011796455510193482, -0.014520885422825813, 0.023820461705327034, 0.04524194449186325, 0.006011561956256628, -0.022000059485435486, 0.025076398625969887, -0.024836501106619835, 0.011818504892289639, 0.03488399460911751, 0.019925646483898163, -0.03516622632741928, -0.03383973240852356, -0.0244272630661726, -0.036154042929410934, 0.024610714986920357, -0.021068690344691277, 0.0076837921515107155, 0.03279547020792961, 0.020941685885190964, -0.008220034651458263, -0.008269425481557846, -0.024610714986920357, 0.030876286327838898, 0.014789007604122162, 0.04484681785106659, -0.0045545343309640884, 0.01847214810550213, 0.019474074244499207, 0.026783907786011696, -0.029069995507597923, -0.004247606266289949, 0.012404138222336769, -0.029860246926546097, 0.011790282092988491, 0.002427203580737114, 0.010103940032422543, -0.014365658164024353, 0.024370815604925156, 0.019459962844848633, -0.033077701926231384, -0.019586967304348946, -0.037395868450403214, -0.003619637805968523, -0.06333307921886444, -0.0031733568757772446, -0.004519255366176367, 0.019586967304348946, -0.046850670129060745, 0.02123803086578846, 0.0586480088531971, -0.035025108605623245, -0.010068660601973534, -0.008601049892604351, -0.02652989886701107, -0.003923038020730019, 0.0013414885615929961, -0.006053897086530924, 0.03663383796811104, -0.03448886796832085, 0.0034361863508820534, 0.007232219446450472, 0.011606830172240734, -0.05263644829392433, -0.002887595910578966, 0.021633155643939972, -0.026388781145215034, 0.002663573483005166, 0.008255314081907272, -0.0006460488657467067, 0.0016325413016602397, -0.021619044244289398, 0.007923690602183342, -0.026981471106410027, -0.050745487213134766, -0.006755951326340437, -0.02462482638657093, -0.004589813761413097, 0.06214769929647446, -0.021181583404541016, -0.010103940032422543, 0.00719694048166275, 0.02551385946571827, 0.008565770462155342, 0.006636002566665411, -0.012622869573533535, 0.00834704004228115, -0.023326553404331207, -0.01933295838534832, -0.013892917893826962, -0.01594616286456585, -0.022493967786431313, -0.0019915064331144094, 0.0030234206933528185, 0.01780889928340912, 0.03223100304603577, 0.013328451663255692, -0.03149719908833504, 0.030622275546193123, -0.020165545865893364, -0.0012100738240405917, 0.032146334648132324, 0.019586967304348946, -0.032343897968530655, 0.018218137323856354, -0.003898342838510871, -0.0024677745532244444, -0.0032280394807457924, -0.028844209387898445, -0.023622898384928703, -0.023975690826773643, -0.04840295389294624, 0.006660697981715202, -0.013469568453729153, 0.03937149792909622, 0.0141398711130023, -0.009638255462050438, 0.013575405813753605, 0.03894814848899841, -0.013568349182605743, -0.055797457695007324, -0.003866591490805149, -0.01773834228515625, -0.007175772916525602, 0.023368889465928078, 0.039145711809396744, 0.00781785324215889, 0.038524799048900604, 0.02466716058552265, -0.003455589758232236, -0.015311137773096561, 0.016002608463168144, 0.02030666172504425, -0.024130918085575104, 0.011931398883461952, -0.020490113645792007, 0.0016510628629475832, -0.02679801918566227, -0.03505333513021469, 0.0060292016714811325, 0.0006451669032685459, -0.00028487888630479574, -0.050463251769542694, -0.04752803221344948, 0.023312442004680634, -0.01007571630179882, 0.06846971809864044, 0.0011897883377969265, 0.014549109153449535, 0.008756277151405811, -0.00027275169850327075, 0.00783902034163475, 0.01201606821268797, -0.047274019569158554, 0.0013353147078305483, 0.049418993294239044, 0.0037995611783117056, 0.05444273725152016, -0.024794165045022964, -0.10239411890506744, -0.022889092564582825, 0.009221961721777916, -0.026120660826563835, -0.0020832319278270006, -0.03976662456989288, -0.012220687232911587, -0.011889063753187656, 0.04989878833293915, 0.03660561516880989, 0.004282885231077671, -0.023622898384928703, 0.029041770845651627, 0.0012762221740558743, 0.010887136682868004, 0.003021656535565853, -0.0004709762579295784, -0.001149217365309596, -0.010259168222546577, 0.010858912952244282, -0.025767870247364044, -0.02376401610672474, -0.01835925504565239, -0.048995643854141235, -0.0007333647226914763, -0.004603925161063671, -0.01991153508424759, -0.04981411620974541, 0.018697934225201607, 0.0076837921515107155, -0.014358601532876492, 0.003915982320904732, -0.0001937044144142419, 0.003534967778250575, -0.029154665768146515, 0.017907680943608284, 0.01831691898405552, -0.011197593063116074, 0.0020303132478147745, -0.007973081432282925, 0.028660757467150688, 0.00565877091139555, 0.03217455744743347, 0.0016069639241322875, 0.01629895344376564, 0.024808276444673538, -0.006614835001528263, 0.02983202412724495, 0.032259225845336914, -0.0022649194579571486, 0.006226764526218176, 0.00687590055167675, 0.013723577372729778, 0.00853754673153162, 0.007570899091660976, 0.0182463601231575, -0.01437271386384964, -0.004854407161474228, -0.0026776851154863834, 0.011500992812216282, 0.01417515054345131, 0.008241202682256699, 0.03482754901051521, -0.027743499726057053, 0.027052029967308044, 0.0318923257291317, -0.017752453684806824, -0.03488399460911751, 0.010851857252418995, 0.0282797422260046, -0.02267741784453392, 0.02073001116514206, 0.009419525042176247, 0.008085974492132664, 0.01953052170574665, 0.040274642407894135, -0.018542705103754997, 0.03076339326798916, -0.007359224371612072, -0.022000059485435486, -0.003492632880806923, 0.0008784501114860177, 0.004194687586277723, 0.029803801327943802, -0.031920548528432846, -0.021520262584090233, -0.013413121923804283, -0.02380635030567646, -0.019036613404750824, 0.0257114227861166, -0.01778067648410797, -0.019431740045547485, 0.017216211184859276, -0.020334884524345398, 0.0011721487389877439, -0.018232248723506927, 0.05153574049472809, -0.02963446080684662, -0.10143452882766724, -0.032259225845336914, 0.03863769397139549, 0.0344606451690197, -0.009560641832649708, -0.004113545175641775, 0.05921247601509094, 0.033162374049425125, -0.015170021913945675, -0.0070734634064137936, 0.02088523842394352, -0.026896800845861435, 0.02050422504544258, 0.00018477439880371094, 0.030706945806741714, -0.06434911489486694, -0.020447777584195137, 0.0016881058691069484, -0.006434911396354437, 0.0040782662108540535, -0.026233553886413574, -0.009419525042176247, -0.006420799996703863, 0.03341638296842575, -0.015282914973795414, -0.010576680302619934, 0.010668406262993813, 0.012432361952960491, -0.009306631982326508, 0.01283454429358244, -0.016792861744761467, -0.020786456763744354, -0.004162936005741358, 0.032259225845336914, -0.03807322680950165, -0.006170317996293306, 0.007902522571384907, -0.0018274583853781223, -0.036069370806217194, 0.014464438892900944, -0.014492662623524666, -0.013737689703702927, 0.05006812885403633, -0.007267498876899481, 0.03443242236971855, -0.020447777584195137, 0.026656903326511383, -0.014930123463273048, 0.006329074036329985, 0.009518306702375412, 0.016200171783566475, -0.051874417811632156, -0.015127686783671379, -0.02050422504544258, -0.0015143562341108918, -0.00992048904299736, 0.020603006705641747, 0.008855058811604977, -0.005246005021035671, 0.002213764702901244, -0.009003231301903725, 0.014464438892900944, 0.02932400442659855, -0.022747976705431938, -0.051366399973630905, -0.008445821702480316, -0.006812398321926594, 0.028533753007650375, -0.0038030892610549927, -0.02722136862576008, -0.016510628163814545, 0.01762544922530651, 0.006784174591302872, 0.0441976822912693, 0.010096884332597256, -0.01373063400387764, 0.041516467928886414, 0.04679422453045845, -0.016792861744761467, 0.03855302184820175, 0.029126441106200218, -0.027644718065857887, 0.026092438027262688, 0.02932400442659855, 0.002102635568007827, 0.03928682953119278, 0.0003296392678748816, -0.022747976705431938, -0.020857015624642372, 0.034912217408418655, 0.024399040266871452, -0.018542705103754997, 0.0229032039642334, -0.02626177668571472, -0.011811449192464352, -0.04244783893227577, -0.016750525683164597, 0.01723032258450985, 0.022239957004785538, -0.015776822343468666, 0.03084806352853775, 0.006075064651668072, -0.03042471408843994, -0.007613234221935272, 0.0007479173364117742, 0.009899321012198925, 0.011331653222441673, 0.007366280071437359, 0.012375915423035622, 0.031327858567237854, -0.0016810500528663397, -0.003919510170817375, -0.030396489426493645, 0.0045686461962759495, 0.010703684762120247, 0.013624796643853188, 0.028406746685504913, 0.006378464866429567, 0.0437178872525692, 0.018966054543852806, 0.008601049892604351, 0.03302125632762909, -0.03787566348910332, -0.020391331985592842, 0.006657170131802559, 0.014464438892900944, 0.02123803086578846, 0.018105244264006615, -0.021054578945040703, -0.006861788686364889, 0.02504817582666874, -0.00257713976316154, -3.92411311622709e-06, -0.00822709035128355, -0.0406133234500885, 0.003813672810792923, 0.018331030383706093, 0.009264296852052212, -0.012143073603510857, 0.02216940000653267, -0.004088850226253271, -0.010160386562347412, -0.00020958003005944192, -0.0004806780198123306, 0.014986569993197918, -0.0037925054784864187, -0.015113575384020805, -0.01811935566365719, -0.0014049909077584743, -0.013406065292656422, 0.014210429973900318, 0.015551036223769188, -0.006586611736565828, 0.020758233964443207, -0.0024077999405562878, 0.014069313183426857, 0.020899351686239243, -0.021689603105187416, -0.00946891587227583, 0.00812830962240696, 0.009779372252523899, 0.03485577180981636, -0.018387477844953537, 0.0017657199641689658, 0.03776276856660843, -0.023862797766923904, -0.008241202682256699, 0.016891643404960632, 0.009144348092377186, -0.002347825560718775, -0.029860246926546097, -0.04309697449207306, 0.00915845949202776, 0.012608757242560387, 0.006833565421402454, 0.03022715076804161, -0.010026326403021812, 0.00882683601230383, 0.011896119453012943, 0.06118810549378395, 0.022310515865683556, 0.011035309173166752, -0.005764608271420002, -0.01909305900335312, 0.05255177617073059, -0.016665855422616005, -0.008008359931409359, 0.007944857701659203, -0.01241119485348463, 0.01707509346306324, 0.033557500690221786, 0.02628999948501587, 0.012481752783060074, 0.04018997400999069, -0.01811935566365719, -0.030086033046245575, 0.005489431321620941, 0.039540838450193405, -0.03488399460911751, -0.028053956106305122, -0.06259927153587341, 0.057857755571603775, -0.007091103121638298, 0.002000326057896018, -0.02209884114563465, 0.005792831536382437, 0.005683466326445341, -0.02279031090438366, -0.018175803124904633, 0.00610681576654315, -0.0021149832755327225, 0.021689603105187416, -0.04814894497394562, 0.014330378733575344, 0.012453529052436352, -0.037790995091199875, 0.0334446057677269, -0.006583083886653185, -0.01579093374311924, -0.01811935566365719, 0.006053897086530924, -0.019304733723402023, -0.00114480743650347, 0.002234932268038392, 0.012813376262784004, -0.015536924824118614, 0.03550490736961365, -0.011818504892289639, -0.003785449545830488, -0.001775421667844057, -0.011578607372939587, 0.0138858612626791, -0.010936527512967587, 0.01960107870399952, -0.016200171783566475, -0.011303430423140526, -0.003534967778250575, -0.004194687586277723, 0.00406415481120348, -0.010964750312268734, 0.05001167953014374, 0.020857015624642372, 0.018951943144202232, -0.01917772926390171, 0.006957042496651411, -0.021379146724939346, 0.02307254448533058, 0.04030286520719528, -0.02963446080684662, 3.784236832871102e-05, -0.012340635992586613, 0.022423408925533295, 0.03835545852780342, 0.014478551223874092, 0.007944857701659203, -0.006357297301292419, 0.02030666172504425, 0.044169459491968155, 0.019431740045547485, 0.018683822825551033, -0.026120660826563835, 0.03115851804614067, 0.0027870505582541227, -0.015847381204366684, -0.005178974941372871, -0.007641457486897707, 0.00286466465331614, 0.010767187923192978, 0.026925023645162582, -0.0007964261458255351, -0.019855089485645294, 0.01785123534500599, -0.010209777392446995, 0.03175120800733566, 4.352010364527814e-05, -0.010922415181994438, 0.03818611800670624, -0.0022331683430820704, 0.03477109968662262, 0.00840348657220602, -0.006995849311351776, 0.0014120468404144049, -0.0010751312365755439, 0.015028905123472214, 0.010393228381872177, -0.013716521672904491, -0.011670333333313465, -0.021985948085784912, 0.02287498116493225, 0.009031455032527447, 0.04368966072797775, 0.05780130997300148, -0.009165515191853046, -0.0007483583176508546, -0.002829385455697775, -0.006854732986539602, -0.005094305146485567, -0.02143559418618679, 0.013307284563779831, 0.007726127281785011, 0.052495330572128296, 0.012841599993407726, -0.00033074175007641315, 0.007221635896712542, 0.017752453684806824, 0.004282885231077671, -0.00941246934235096, -0.03107384964823723, -0.014288043603301048, -0.007436838466674089, -0.027376597747206688, -0.018697934225201607, 0.02703791856765747, 0.014563220553100109, 0.010484954342246056, -0.013279060833156109, -0.01629895344376564, -0.000783637457061559, -0.007923690602183342, -0.0021414426155388355, 0.006911179516464472, -0.0018574456917122006, 0.002037369180470705, 0.0016828139778226614, -0.026515787467360497, 0.015494589693844318, 0.0015381696866825223, 0.0035067445132881403, -0.01038617268204689, 0.012756929732859135, -0.004780320916324854, 0.030368266627192497, 0.028844209387898445, 0.003358572255820036, -0.043153420090675354, -0.011500992812216282, -0.038101449608802795, -0.01937529258430004, -0.01614372618496418, -0.013314340263605118, 0.044705700129270554, 0.0119596216827631, 0.010837745852768421, -0.004646260291337967, -0.009221961721777916, 0.014873676933348179, -0.016948089003562927, 0.01687753014266491, 0.006780646741390228, -0.007881355471909046, 0.07975903153419495, -0.03883525729179382, -0.0329083614051342, 0.012883935123682022, 0.001561983022838831, 0.009306631982326508, -0.005401233211159706, -0.005944531876593828, -0.02236696146428585, -0.014041089452803135, -0.011839672923088074, 0.022649195045232773, 0.005926892161369324, -0.002728839870542288, 0.037170082330703735, -0.014407992362976074, -0.009934600442647934, 0.015649817883968353, 0.01056256890296936, 0.008269425481557846, 0.012975660152733326, -0.005249532870948315, 0.006981737911701202, -0.03321881964802742, 0.0036037620157003403, 0.0013264949666336179, -0.0156780406832695, 0.0208429042249918, -0.014605555683374405, 0.02668512612581253, 0.008777445182204247, -0.022663306444883347, -0.06350241601467133, 0.0019015446305274963, -0.008177700452506542, 0.005256589036434889, -0.00763440178707242, 0.02294554002583027, -0.010435563512146473, -0.010943583212792873, 0.011119978502392769, -0.02057478204369545, 0.008036583662033081, 0.001443797955289483, -0.012622869573533535, 0.007535620126873255, 0.012806320562958717, 0.015226468443870544, -0.007309833541512489, 0.008001304231584072, 0.005253061186522245, -0.003894814755767584, 0.026614569127559662, -0.011472770012915134, -0.006064480636268854, 0.0029810855630785227, -0.01583326980471611, 0.05359603837132454, 0.014944234862923622, 0.006572499871253967, 0.001935059786774218, 0.008975008502602577, -0.043238088488578796, 0.02010909840464592, 0.01442916039377451, -0.005584684666246176, -0.003330348990857601, 0.02610654942691326, -0.004882630426436663, 0.061752572655677795, -0.04964477941393852, 0.01809113286435604, 0.007239275611937046, 0.01984097808599472, 0.010703684762120247, 0.024497821927070618, -0.035843584686517715, 0.017950017005205154, 0.00010616810322972015, 0.013314340263605118, 0.014746672473847866, 0.0034238386433571577, -0.013794136233627796, 0.015692152082920074, -0.005126056261360645, -0.0013944072416052222, 0.002423675497993827, 0.001530231791548431, -0.07242097705602646, 0.05368071049451828, -0.01025211252272129, 0.017046870663762093, 0.0586480088531971, 0.017244433984160423, -0.02329833060503006, -0.011606830172240734, -0.018302807584404945, 0.012404138222336769, -0.00046656635822728276, 0.0001644888980081305, -0.00572932930663228, -0.00502727460116148, 0.013314340263605118, 0.04340742900967598, -0.022931428626179695, -0.009278408251702785, -0.027475379407405853, -0.0018468619091436267, 0.006897068116813898, -0.0020885239355266094, 0.01665174402296543, -0.007662625052034855, 0.024723608046770096, 0.011818504892289639, -0.015424031764268875, 0.027066141366958618, 0.028138626366853714, 0.014182206243276596, 0.001545225502923131, 0.0014684933703392744, 0.012841599993407726, 0.002331949770450592, 0.016115501523017883, -0.00521072605624795, -0.01254525501281023, 0.012128961272537708, -0.0033867955207824707, 0.012531143613159657, 0.006583083886653185, 0.004561590030789375, -0.02349589392542839, 0.024286147207021713, 0.019276510924100876, -0.029465120285749435, -0.004805016331374645, 0.02287498116493225, -0.02451193332672119, -0.028928877785801888, -0.018218137323856354, 4.999712837161496e-05, -0.002555972198024392, -0.0029863775707781315, -0.01780889928340912, 0.01248880848288536, -0.028830096125602722, -0.011049420572817326, 0.02119569480419159, -0.010527289472520351, 0.004713290371000767, -0.00873511005192995, 0.022550413385033607, 0.01676463708281517, -0.006770063191652298, 0.0034079630859196186, -0.0013547182315960526, 0.01056256890296936, 0.00010004937939811498, -0.033077701926231384, 0.0027870505582541227, 0.012989772483706474, 0.0333881601691246, -0.012756929732859135, -0.015057128854095936, 0.017752453684806824, 0.03700074180960655, -0.012199520133435726, -0.01847214810550213, -0.014746672473847866, 0.019318846985697746, 0.005842222366482019, -0.0002113439841195941, -0.004237022250890732, 0.01629895344376564, 0.014245708473026752, 0.0037254751659929752, -0.028688980266451836, -0.007860188372433186, 0.012481752783060074, -0.010611959733068943, -0.0013970531290397048, -0.005302451550960541, -0.00470623467117548, 0.008290593512356281, 0.008466988801956177, -0.01625661924481392, 0.02478005364537239, 0.03372683748602867, 0.009292520582675934, -0.001229477347806096, 0.011268150992691517, -0.004540422931313515, -0.036774955689907074, 0.016976311802864075, 0.006650113966315985, 0.02101224474608898, 0.0385812446475029, 0.007994248531758785, -0.009504195302724838, 0.005341258831322193, 0.022973762825131416, 0.022508079186081886, -0.005736385006457567, -0.030255373567342758, 0.0034502979833632708, 0.008953840471804142, 0.011500992812216282, 0.01495834719389677, 0.01828869618475437, 0.0231431033462286, 0.03144075348973274, -0.007338056806474924, -0.02535863220691681, 0.04670955613255501, 0.014916012063622475, 0.014986569993197918, 0.03457353636622429, 3.4397140552755445e-05, 0.006939402781426907, -0.02870309166610241, -0.024370815604925156, -0.007853131741285324, 0.013025050982832909, 0.016284842044115067, -0.004459280986338854, 0.009927544742822647, 0.03423485904932022, 0.0093913022428751, 0.03321881964802742, 0.012587590143084526, 0.039145711809396744, -0.009440692141652107, -0.02489294670522213, 0.005828110501170158, 0.013794136233627796, -0.013180279172956944, 0.00019822455942630768, -0.027291927486658096, -0.0040782662108540535, 0.006099760066717863, -0.006279683206230402, -0.024046247825026512, 0.03714185953140259, 0.027489490807056427, -0.012982715852558613, -0.0026723933406174183, 0.0832587257027626, 0.027052029967308044, -0.0019915064331144094, -0.025429189205169678, 0.0063114347867667675, -0.008198867551982403, 8.544162119505927e-05, -0.005916308611631393, -0.022733865305781364, 0.010484954342246056, -0.020334884524345398, -0.023439448326826096, 0.0006350241601467133, -0.02839263528585434, 0.04196804016828537, -0.004748569801449776, 0.009017342701554298, 0.009574753232300282, 0.007158133666962385, -0.026431117206811905, 0.01917772926390171, -0.015438143163919449, 0.03034004382789135, 0.0030075449030846357, -0.060002729296684265, -0.011268150992691517, 0.015099463053047657, 0.015226468443870544, -0.011769114062190056, 0.018923720344901085, 0.03863769397139549, 0.002568319905549288, -0.004261717665940523, -0.006657170131802559, -0.036972519010305405, 0.01164916530251503, 0.0038383682258427143, -0.010012214072048664, -0.0002511432394385338, 0.02174605056643486, -0.0027782307006418705, -0.0244272630661726, -0.013801191933453083, 0.003972428850829601, 0.03259790688753128, -0.015155909582972527, 0.006614835001528263, 0.01902250200510025, 0.01700453646481037, -0.01538169663399458, 0.010294447652995586, 0.00610681576654315, -0.0032791942358016968, -0.006914707366377115, 0.009066733531653881, 0.009906376712024212, -0.03776276856660843, 0.00904556643217802, 0.012869822792708874, 0.03942794352769852, 0.03256968408823013, -0.008085974492132664, 0.049531884491443634, 0.003332112915813923, 0.010287391021847725, 0.02283264696598053, -0.005207198206335306, -0.0068406215868890285, 0.004932020790874958, 0.036972519010305405, 0.01442916039377451, -0.009243129752576351, -0.02307254448533058, -0.044705700129270554, -0.002053244737908244, -0.001567274914123118, -0.013723577372729778, -0.009927544742822647, -0.028886543586850166, 0.007620289921760559, 0.0064454954117536545, -0.006057424936443567, 0.023834573104977608, 0.03415018692612648, -0.01192434225231409, 0.02022199146449566, 0.011211704462766647, 0.008918561972677708, 0.0354766845703125, -0.007669680751860142, 0.035956479609012604, 0.00022821180755272508, -0.0024836501106619835, 0.018683822825551033, -0.017512554302811623, 0.014887788332998753, -0.010132163763046265, -0.0019421156030148268, 0.027164923027157784, -0.013547182083129883, 0.011620942503213882, 0.006000978406518698, 0.013815303333103657, -0.008720998652279377, 0.013857638463377953, 0.033980850130319595, 0.02225406840443611, -0.030396489426493645, -0.0030234206933528185, -0.008678663522005081, 0.010492010042071342, -0.022747976705431938, -0.0022649194579571486, 0.000307369336951524, 0.007115798536688089, -0.027475379407405853, -0.02123803086578846, -0.020038539543747902, 0.0280116219073534, 0.00038762931944802403, 0.03166653960943222, -0.024060359224677086, -0.017611335963010788, -0.012552310712635517, -0.005330675281584263, 0.02765882946550846, 0.03618226572871208, 0.0072816102765500546, 0.0018256944604218006, -0.01831691898405552, -0.02746126800775528, -0.015226468443870544, -0.023594675585627556, 0.008558714762330055, -0.0138858612626791, 0.0028470249380916357, -0.010654293932020664, 0.005034330300986767, -0.013137944042682648, 0.01095063891261816, -0.0011342237703502178, 0.006205597426742315, 0.015043016523122787, -0.017794787883758545]",Model Alignment as Prospect Theoretic Optimization.pdf
" than those that do not ( §3.3). We find that DPO per-
formance can even be matched at most scales by running an
offline PPO variant on dummy +1/-1 rewards, suggesting
that preference data might not be needed if the inductive
bias in the loss function is good enough. However, despite
the surprising success of this simple baseline, it significantly
lags behind DPO at the 30B LLM scale and suffers from
hyperparameter sensitivity, making it difficult to use.
Taking a more principled approach, we derive a HALO us-
ing the model of human utility that Kahneman & Tversky
proposed to describe how humans make decisions about un-
certain monetary outcomes (Tversky & Kahneman, 1992).
This approach, which we call Kahneman-Tversky Optimiza-
tion (KTO), directly maximizes the utility of generations
instead of maximizing the log-likelihood of preferences, as
most current methods do ( §4.1). KTO only requires a binary
signal of whether an output is desirable or undesirable for
an input. This data is more abundant, cheaper, and faster to
collect in the real world, making it easier to scale alignment
in production and rapidly iterate on models. We find that:
•KTO matches or exceeds DPO performance at scales
from 1B to 30B parameters ( §4.2).2That is, breaking
upnpreferences meant for DPO into 2nexamples for
KTO can yield better LLM generations, as determined
by closed-ended tasks such as mathematical reasoning
and open-ended judgments from humans and GPT-4 .
•KTO can handle extreme data imbalances, matching
DPO performance while using up to 90% fewer desir-
able examples (i.e., examples of good generations). Its
success cannot be ascribed to the alignment data being
sourced from a preference dataset.
•When the pretrained model is sufficiently good, one
can skip supervised finetuning (SFT) and go straight
to KTO without a loss in generation quality, whereas
SFT is always needed for best results with DPO.
The intent behind KTO was that even if the model learns
from a weaker signal, we could compensate with the higher
volume of data that could be accessed in practice; the fact
that KTO can match and even outperform DPO on the same
data is thus surprising. We conclude by discussing some
theoretical explanations for this phenomenon ( §4.3). De-
spite the success of KTO in our experiments, our work
ultimately suggests that there is no one HALO that is uni-
versally superior; the best HALO depends on the inductive
biases appropriate for a given setting, and this choice should
be made deliberately instead of defaulting to any one loss.
2Our code is available on Github; models are on Huggingface.2. Background
For a detailed survey, please see Appendix A. In brief, LLMs
are traditionally trained in three stages (Ouyang et al., 2022):
Pretraining Given a large corpus, train the model to max-
imize the log-likelihood of the next token conditioned on
the preceding text. Let π0denote the pretrained model.
Supervised Finetuning (SFT) Finetune the model to pre-
dict the next token on data that is more relevant to the down-
stream task. Often, such data will comprise instructions and
an appropriate response (i.e., instruction finetuning). Let
πrefdenote the finetuned model.
RLHF Given a dataset Dof preferences (x, yw, yl)—
where xis an input, yw, ylare the preferred and dispreferred
outputs (i.e., yw≻ylforx), and r∗is the “true” reward
function underlying the preferences—it is first assumed that
the probability that ywis preferred to ylcan be captured with
a specific function class, typically a Bradley-Terry model
(Bradley & Terry, 1952). Where σis the logistic function:
p∗(yw≻yl|x) =σ(r∗(x, yw)−r∗(x, yl)) (1)
Since getting the true reward from a human would be in-
tractably expensive, a reward model rϕlearns to serve as a
proxy, done by minimizing the negative log-likelihood of
the human preference data:
LR(rϕ) =Ex,yw,yl∼D[−logσ(rϕ(x, yw)−rϕ(x, yl))]
But solely maximizing the reward might come at the ex-
pense of des","[0.01193476002663374, 0.009781993925571442, 0.05885196477174759, 0.018749427050352097, 0.05957925319671631, -0.009040161967277527, -0.010312912054359913, 0.045149900019168854, -0.012043852359056473, 0.04811722785234451, 0.01521481852978468, -0.019098524004220963, -0.03339696303009987, -0.03179693594574928, 0.037469763308763504, -0.02183311991393566, 0.032524220645427704, -0.04861178249120712, -0.0030909646302461624, 0.03601519390940666, -0.006960125174373388, -0.01129474863409996, -0.006167383398860693, 0.028931427747011185, 0.024480439722537994, 0.0006731938919983804, 0.012705682776868343, 0.015389367006719112, -0.004545536357909441, -0.021905848756432533, 0.06097564101219177, -0.03639338165521622, -0.049280885607004166, -0.029716897755861282, 0.012123853899538517, 0.03342605382204056, 0.04270622134208679, 0.038662511855363846, 0.007421951275318861, 0.009171073324978352, -0.017963958904147148, -0.05652465298771858, -0.022371310740709305, 0.01819669082760811, 0.01925852708518505, 0.02066946215927601, 0.03706248477101326, -0.0150984525680542, -0.000959108117967844, 0.020131271332502365, -0.04986271262168884, 0.05312095209956169, -0.021193107590079308, -0.013556607067584991, -0.0008100145496428013, -0.003981889691203833, 0.012996597215533257, -0.0196512620896101, 0.03976798802614212, -0.01925852708518505, -0.02426225319504738, -0.010669282637536526, 0.025338636711239815, 0.01949125900864601, -0.016742119565606117, -0.006567390635609627, -0.10030725598335266, 0.025382274761795998, -0.0022854956332594156, 0.0335715115070343, 0.012887503951787949, 0.0008277421584352851, 0.037207942456007004, 0.02386952005326748, -0.00564737431704998, -0.03557882085442543, 0.0286259688436985, 0.06365205347537994, 0.01608756184577942, -0.02176039107143879, 0.008531061932444572, -0.008894705213606358, 0.01962217129766941, -0.056204646825790405, -0.012574771419167519, -0.029629623517394066, -0.03237876296043396, -0.03066236898303032, -0.029164159670472145, -0.0095638083294034, -0.0346188023686409, -0.031011465936899185, -0.013258419930934906, -0.02261858806014061, 0.03269876912236214, -0.009491079486906528, -0.0047528124414384365, 0.006567390635609627, 0.042124394327402115, 0.004956452641636133, -0.025775007903575897, -0.03336787223815918, 0.002334587275981903, -0.010000179521739483, 0.049339067190885544, 0.010021998547017574, 0.0030782371759414673, 0.02597864903509617, 0.013447513803839684, 0.0014763901708647609, -0.05591373145580292, 0.00864015519618988, -0.06458298116922379, 0.009272893890738487, -0.0006259203073568642, -0.061208371073007584, -0.053237318992614746, 0.031506020575761795, -0.010989287868142128, -0.02344769425690174, -0.017033033072948456, -0.02993508242070675, 0.0165239330381155, 0.016596661880612373, -0.010771102271974087, -0.017382130026817322, 0.008007416501641273, -0.03133147209882736, 0.056495558470487595, -0.02990599162876606, 0.0051782745867967606, 0.062372028827667236, -0.009243802167475224, -0.05873560160398483, -0.07592863589525223, 0.031186014413833618, -0.018109416589140892, 0.0047709946520626545, 0.002401861362159252, -0.01803668774664402, -0.03688793629407883, -0.07534680515527725, -0.045557182282209396, -0.01305477973073721, -0.09559444338083267, -0.003840069053694606, 0.0014391167787835002, 0.00676739402115345, -0.06051017716526985, 0.044597163796424866, 0.009520171210169792, -0.0301969051361084, -0.024538623169064522, 0.03290240839123726, -0.0026764117646962404, -0.04229894280433655, -0.005891014821827412, 0.01684393920004368, 0.004967361688613892, -0.017891230061650276, -0.0030982375610619783, 0.046139009296894073, -0.013956613838672638, 0.019505804404616356, 0.024029523134231567, 0.012800229713320732, -0.014116616919636726, 0.027811408042907715, -0.06144110485911369, -0.01988399401307106, 0.015156636014580727, 0.0015491187805309892, -0.055768273770809174, -0.015593007206916809, 0.00970926508307457, 0.0027400492690503597, -0.032000575214624405, -0.011091108433902264, -0.016407568007707596, -0.04776813089847565, -0.008051053620874882, 0.018749427050352097, -0.02779686264693737, -0.0026909573934972286, -0.03787704184651375, 0.02126583643257618, -0.002330950926989317, -0.022793136537075043, -0.004483717028051615, 0.060684725642204285, 0.02519317902624607, 0.019767627120018005, 0.07406678795814514, -0.034676987677812576, -0.019811265170574188, -0.015273001044988632, 0.06155746802687645, 0.06807395070791245, -0.027244126424193382, 0.00023045868147164583, 0.01707667112350464, 0.03191329911351204, 0.037702493369579315, -0.088496133685112, -0.011418387293815613, 0.029455075040459633, 0.004894633311778307, -0.007505589164793491, -0.03013872355222702, -0.04229894280433655, 0.0034636985510587692, 0.022604042664170265, 0.04849541559815407, 0.018211236223578453, -0.010342003777623177, -0.03342605382204056, -0.0533536858856678, 0.02829141728579998, 0.019723990932106972, 0.0874488428235054, 0.01678575575351715, 0.02657502330839634, -0.0028527784161269665, 0.017062123864889145, -0.030342362821102142, -0.019345801323652267, 0.022793136537075043, -0.035433363169431686, 0.004407351836562157, -0.03688793629407883, 0.05690284073352814, 0.0026200469583272934, -0.008254693821072578, 0.010269274935126305, 0.022894956171512604, -0.031971484422683716, 0.016000287607312202, -0.03115692362189293, 0.009418350644409657, -0.05594282224774361, -0.015142089687287807, -0.012916595675051212, 0.030080540105700493, -0.02363678812980652, 0.0056764655746519566, 0.03738249093294144, -0.04078618809580803, -0.005989198572933674, 0.0010081998771056533, -0.03464789316058159, 0.03714975714683533, -0.02100401371717453, -0.009752902202308178, -0.01777486503124237, -0.03616064786911011, -0.0017927595181390643, -0.0013291147770360112, -0.007571044843643904, -0.03284422680735588, 0.0054073696956038475, -0.00895288772881031, 0.005316459108144045, 0.013142053969204426, 0.02456771396100521, -0.01215294562280178, -0.013432968407869339, -0.04366623982787132, -0.022560404613614082, -0.015025724656879902, -0.009527443908154964, 0.015971194952726364, 0.0028000501915812492, -0.02475680783390999, 0.02498953975737095, -0.04232803359627724, -0.05288822203874588, 0.04491716995835304, 0.03336787223815918, -0.02693866565823555, -0.035171542316675186, -0.04648810625076294, 0.03738249093294144, 0.056961022317409515, 0.0031546021346002817, 0.024887720122933388, 0.003205512184649706, -0.02394224889576435, 0.01605847105383873, -0.03485153615474701, -0.02802959457039833, 0.0025200452655553818, -0.053004588931798935, 0.03714975714683533, -0.0481463186442852, 0.018574878573417664, 0.04096073657274246, -0.009476534090936184, -0.029731443151831627, 0.0008291057893075049, 0.02321496233344078, 0.031738750636577606, -0.012698410078883171, -0.006618300452828407, -0.006981943733990192, 0.0292805265635252, -0.017120307311415672, 0.028015049174427986, 0.028844153508543968, 0.020393094047904015, 0.006356477737426758, 0.013163872994482517, 0.023273145779967308, 0.013047507032752037, 0.04325895756483078, -0.002370951697230339, -0.016902120783925056, 0.0642920657992363, -0.037906136363744736, -0.010291093960404396, -0.05652465298771858, -0.0426771305501461, -0.06615391373634338, -0.018473058938980103, 0.006971034221351147, 0.018225781619548798, -0.012160218320786953, -0.016262110322713852, -0.0013427514350041747, -0.03365878760814667, -0.04229894280433655, 0.002936416305601597, 0.022211307659745216, 0.0016227563610300422, 0.013687518425285816, -0.025789553299546242, 0.008123782463371754, -0.02061127871274948, 0.05504098907113075, 0.001901852316223085, 0.01621847227215767, -0.07901232689619064, -0.007360131945461035, -0.02597864903509617, -0.02693866565823555, -0.03159329295158386, 0.015142089687287807, 0.0351424477994442, 0.028960520401597023, 0.01592755876481533, 0.017265764996409416, -0.01866215281188488, -0.020160362124443054, 0.026429565623402596, 0.00918561965227127, 0.01370206382125616, 0.027607768774032593, -0.007021944038569927, -0.025105904787778854, -0.017003942281007767, -0.003047327511012554, -0.0029109613969922066, 0.011592935770750046, 0.004760085605084896, 0.031738750636577606, 0.014851176179945469, 0.022967685014009476, -0.0346188023686409, 0.00021909484348725528, 0.027055030688643456, 0.0074255880899727345, -0.023229507729411125, 0.026647750288248062, -0.013047507032752037, 0.045091718435287476, -0.06144110485911369, 0.009338349103927612, 0.01234931219369173, 0.011360203847289085, 0.013098416849970818, 0.03217512369155884, 0.008749248459935188, 0.011796575039625168, -0.010160182602703571, -0.03732430562376976, -0.006567390635609627, 0.029847808182239532, 0.0010127454297617078, -0.040146175771951675, -0.0434625968337059, -0.025804100558161736, 0.013643881306052208, -0.007327404338866472, -0.015811193734407425, 0.023534968495368958, -0.02938234619796276, -0.00036568837822414935, -0.022080397233366966, 0.044248066842556, 0.03776067867875099, 0.06656119227409363, -0.05192820355296135, -0.0043273502960801125, -0.07697592675685883, -0.01767304539680481, -0.04096073657274246, -0.04183347895741463, 0.0012600226327776909, 0.029033249244093895, 0.005643737502396107, 0.027113214135169983, 0.05603009834885597, -0.0031655114144086838, 0.0245968047529459, -0.03886615112423897, 0.02743322029709816, -0.013607516884803772, 0.013374785892665386, 0.014982087537646294, 0.02288041077554226, 0.047040846198797226, -0.029004156589508057, -0.022924048826098442, -0.006567390635609627, -0.0505027249455452, -0.028873246163129807, 0.03738249093294144, 0.011636572889983654, -0.036189742386341095, 0.012683863751590252, -0.042153485119342804, -0.02238585613667965, 0.04593537002801895, 0.02610955946147442, -0.03406606614589691, -0.0699939876794815, -0.020131271332502365, -0.008938342332839966, 0.021542204543948174, 0.012342039495706558, -0.011367476545274258, 0.04084436967968941, 0.002734594512730837, -0.023287691175937653, -0.03438607230782509, -0.030982375144958496, -0.003989162389189005, -0.027549585327506065, 0.0034946082159876823, -0.007429224438965321, -0.02647320181131363, -0.012851139530539513, 0.03758613020181656, 0.061208371073007584, -0.03988435119390488, 0.004774631001055241, -0.03784795105457306, 0.06516480445861816, -0.004876451101154089, 0.029222343116998672, -0.0022036759182810783, -0.01506936177611351, -0.015651190653443336, -0.0012191127752885222, -0.031738750636577606, 0.002750958548858762, 0.0290187019854784, 0.0035891553852707148, -0.012123853899538517, -0.0261531975120306, 0.016640298068523407, 7.892186840763316e-05, -0.06010289862751961, 0.017789410427212715, -0.033746059983968735, -0.022109488025307655, -0.005356459878385067, 0.036422472447156906, 0.0026800481136888266, 0.022633133456110954, 0.0016609389567747712, 0.010225637815892696, -0.04968816414475441, -0.01419661846011877, -0.0038291597738862038, 0.041426196694374084, 0.018603971228003502, 0.0648157075047493, -0.0006409205961972475, -0.048844512552022934, 0.014152981340885162, 0.0019727626349776983, -0.05853195860981941, 0.0577755831182003, -0.018473058938980103, -0.025265907868742943, -0.015738464891910553, 0.019113071262836456, 0.011796575039625168, -0.0020273090340197086, 0.003645519958809018, 0.054255519062280655, -0.07249584794044495, -0.022414948791265488, 0.038167957216501236, 0.023302236571907997, 0.015883920714259148, 0.024509530514478683, -0.01506936177611351, -0.008814703673124313, 0.027578676119446754, -0.02845142036676407, 0.01582573913037777, -0.017658498138189316, 0.008923796936869621, -0.01310568954795599, 0.005752830766141415, -0.043375324457883835, -0.014305711723864079, -0.012094762176275253, 0.021614933386445045, -0.020291272550821304, -0.00012977505684830248, -0.026662297546863556, 0.024014975875616074, 0.008072872646152973, 0.012138399295508862, -0.054750073701143265, -0.08820521831512451, -0.005585554987192154, -0.012836594134569168, 0.03336787223815918, 0.002167311729863286, 0.022109488025307655, 0.007803776301443577, -0.03575336933135986, -0.016611207276582718, -0.024247707799077034, -0.03037145361304283, -0.025600459426641464, -0.01764395274221897, 0.011636572889983654, 0.005436461418867111, 0.008443787693977356, 0.018909430131316185, 0.01764395274221897, -0.022167671471834183, 0.03403697535395622, -0.024669533595442772, -0.005411006044596434, 0.009105618111789227, 0.011447478085756302, -0.03490971773862839, -0.04541172459721565, -0.01388388592749834, -0.05044454336166382, 0.018676698207855225, -0.00976017490029335, 0.011832939460873604, 0.02855324000120163, -0.010989287868142128, -0.006225566379725933, 0.012080216780304909, -0.008385605178773403, 0.027011394500732422, 0.015011178329586983, 0.02011672407388687, -0.003190966323018074, 0.008858340792357922, 0.0071783107705414295, 0.026502294465899467, -0.023200416937470436, 0.01154202502220869, 0.03525881469249725, -0.032029666006565094, -0.001301841577515006, -0.0034636985510587692, 0.03205875679850578, -0.0020854920148849487, 0.014843902550637722, 0.013469332829117775, -0.023287691175937653, -0.009032889269292355, -0.02832050807774067, -0.022734953090548515, -0.04957180097699165, -0.007803776301443577, 0.0071019455790519714, 0.03653883934020996, -0.05064818263053894, 0.018385784700512886, 0.0292805265635252, -0.03924434259533882, -0.009352895431220531, -0.013963887467980385, -0.036975208669900894, -0.006091018673032522, 0.007636500522494316, -0.01167293731123209, 0.032756950706243515, -0.04229894280433655, 0.014742082916200161, -0.004920088220387697, 0.010021998547017574, -0.05123000964522362, -0.027258671820163727, 0.030604185536503792, -0.01579664647579193, 0.00720376567915082, 0.0013536607148125768, -0.0043091680854558945, -0.00826196651905775, -0.029367800801992416, 0.007174674421548843, -0.03136056289076805, -0.05899742245674133, -0.028378691524267197, -0.020494913682341576, 0.0024600441101938486, 0.03784795105457306, -0.007767412345856428, -0.0012200218625366688, 0.005261912476271391, 0.0010272911749780178, 0.0014572988729923964, -0.002570955315604806, -0.013149326667189598, 0.0032527856528759003, -0.0022109488490968943, -0.0166548453271389, -0.009767448529601097, -0.02456771396100521, -0.015505732968449593, 0.0048837242648005486, 0.012851139530539513, 0.019447622820734978, 0.01608756184577942, 0.008683792315423489, -0.004800086375325918, -0.00728740356862545, -0.028233233839273453, -0.00038568873424082994, 0.012669318355619907, 0.02657502330839634, -0.019302165135741234, 0.012589316815137863, 0.0189967043697834, 0.0016409385716542602, 0.010101999156177044, 0.0009454715182073414, -0.03194238990545273, -0.005047363229095936, -0.021193107590079308, 0.013185691088438034, 0.0021545840427279472, 0.03490971773862839, 0.012291129678487778, -0.0051782745867967606, 0.007156492210924625, 0.00826196651905775, 0.004018254112452269, -0.036975208669900894, -0.01819669082760811, -0.0145093509927392, 0.0033673332072794437, 0.02350587584078312, 0.046139009296894073, 0.013309329748153687, 0.05288822203874588, 0.006207384169101715, -0.006400114856660366, -0.028276871889829636, 0.003836432471871376, 0.01892397552728653, -0.021905848756432533, -0.013098416849970818, -0.015607552602887154, 0.008509243838489056, -0.038429781794548035, -0.053790055215358734, 0.0014336621388792992, -0.034473344683647156, -0.00760740926489234, -0.0533536858856678, -0.030749643221497536, -0.0012945686466991901, -0.020916739478707314, 0.06254658102989197, -0.02228403650224209, 0.01648029498755932, 0.007098309230059385, -0.015112998895347118, -0.0077965036034584045, 0.011891122907400131, -0.03761522099375725, -0.0028745969757437706, 0.02235676534473896, 0.0026527747977524996, 0.07139037549495697, -0.010523824952542782, -0.10868559032678604, -0.023404056206345558, 0.0170475784689188, -0.0170475784689188, 0.0030436909291893244, -0.03525881469249725, -0.014283892698585987, -0.011171109974384308, 0.05131728574633598, 0.03243694454431534, -0.007400132715702057, -0.0165239330381155, 0.02443680167198181, -0.013025688007473946, 0.002521863440051675, -0.007745593786239624, 0.0076001365669071674, 0.026196833699941635, 0.013382058590650558, -0.0035764279309660196, -0.025134997442364693, -0.020596733316779137, 0.005280094686895609, -0.04669174924492836, 0.0052328212186694145, 0.007400132715702057, -0.013956613838672638, -0.04520808532834053, 0.014371166937053204, -0.012320221401751041, 0.010014724917709827, -0.0041346196085214615, 0.010225637815892696, -0.016596661880612373, -0.04544081538915634, -0.0009718356304802, 0.023854974657297134, -0.00319823925383389, 0.015112998895347118, -0.003421879606321454, 0.00025841372553259134, -0.001150020631030202, 0.022429494187235832, 0.003836432471871376, -0.00648011639714241, 0.02080037258565426, -0.019069433212280273, 0.024480439722537994, 0.04226984828710556, 0.00928016658872366, 0.006669210735708475, -0.0111274728551507, 0.014218437485396862, 0.010436550714075565, 0.017658498138189316, 0.014189345762133598, -0.017847593873739243, 0.01310568954795599, -0.010443824343383312, -0.005261912476271391, 0.01018927339464426, -0.002725503407418728, 0.04052436351776123, -0.026880482211709023, 0.01968035288155079, 0.009796539321541786, -0.0189967043697834, -0.038197048008441925, 0.0024509530048817396, 0.03450243920087814, -0.017236672341823578, 0.0029182343278080225, 0.013309329748153687, 0.0008513789507560432, 0.01111292652785778, 0.07127400487661362, -0.00976017490029335, 0.02868415229022503, -0.01918579824268818, -0.005421915557235479, -0.00939653255045414, -0.034967899322509766, -0.002605501329526305, 0.029731443151831627, -0.03284422680735588, -0.0003015963302459568, -0.015054815448820591, -0.03714975714683533, -0.02647320181131363, 0.04817540943622589, -0.02116401679813862, -0.011476569809019566, 0.01354933436959982, 0.0004509171994868666, 0.004625537432730198, -9.119481546804309e-06, 0.050066351890563965, -0.02360769733786583, -0.1210203543305397, -0.06155746802687645, 0.010727465152740479, 0.0029091432224959135, -0.012509315274655819, -0.003218239638954401, 0.056204646825790405, 0.006989216431975365, -0.04133892431855202, -0.011716574430465698, -0.0014254801208153367, -0.0541391521692276, 0.021251291036605835, 0.012429313734173775, 0.016756664961576462, -0.07237948477268219, -0.007047399412840605, -0.010392913594841957, 0.0025891372933983803, -0.02769504301249981, -0.04989180341362953, -0.017629407346248627, -0.01042200531810522, 0.026749571785330772, -0.02990599162876606, -0.010603826493024826, 0.03266967833042145, -0.0005040999385528266, -0.018618516623973846, 0.0034455163404345512, -0.010385640896856785, -0.023491330444812775, -0.002585500944405794, 0.01678575575351715, -0.05617555230855942, -0.006556481122970581, 0.002161856973543763, -0.020829465240240097, -1.7855434634839185e-05, 0.01837123930454254, 0.004374624229967594, -0.03706248477101326, 0.04072800278663635, -0.01991308480501175, 0.023200416937470436, -0.044829897582530975, -0.00236186059191823, -0.0068910326808691025, -0.0011691119289025664, 0.014022069983184338, 0.030458727851510048, -0.04939724877476692, -0.00322733074426651, -0.012698410078883171, 0.003609155770391226, -0.010974742472171783, 0.0009150164551101625, 0.018080323934555054, 0.0015945740742608905, -0.02610955946147442, 0.004880087450146675, 0.027505949139595032, -0.0057310122065246105, -0.025600459426641464, -0.03554973006248474, -0.026865936815738678, 0.008451060391962528, 0.017600316554307938, -0.006974670570343733, -0.056204646825790405, -0.008174692280590534, 0.012814775109291077, 0.008109236136078835, 0.0429389514029026, 0.001698212348856032, -0.015040270052850246, 0.03092419169843197, 0.02222585305571556, -0.0377315878868103, 0.048408143222332, 0.03636429086327553, -0.05172456428408623, 0.027345946058630943, 0.029556894674897194, 0.0348806269466877, 0.04331714287400246, -0.013440241105854511, -0.0007363768527284265, -0.01697484962642193, 0.020931284874677658, 0.017236672341823578, -0.027011394500732422, -0.0024291344452649355, -0.0272004883736372, -0.020203998312354088, -0.018603971228003502, -0.026924120262265205, 0.01925852708518505, 0.02548409439623356, -0.025076813995838165, 0.024814991280436516, 0.02756413072347641, -0.03860433027148247, 0.00772377522662282, 0.0069673978723585606, 0.024014975875616074, 0.0026782299391925335, 0.011512934230268002, 0.04328804835677147, -0.005985562223941088, -0.017760319635272026, 0.006385568995028734, -0.013411150313913822, 0.01608756184577942, -0.001501845195889473, 0.01229840237647295, 0.04354987293481827, 0.028015049174427986, 0.04133892431855202, 0.009011071175336838, -0.01391297671943903, 0.030516911298036575, -0.018807610496878624, 0.004480080213397741, -0.009258348494768143, -0.003010963089764118, 0.0037782497238367796, 0.03293149918317795, -0.032524220645427704, -0.014363894239068031, 0.007971052080392838, 0.005938288290053606, 0.015040270052850246, 0.012422041036188602, -0.010560189373791218, 0.020087633281946182, 0.030051449313759804, 0.019665807485580444, -0.01780395582318306, 0.02113492414355278, -0.002378224628046155, 0.023665878921747208, 0.0051564560271799564, 0.006072836462408304, 0.0045418995432555676, 0.008698337711393833, 0.028931427747011185, -0.03232058137655258, -0.021309472620487213, 0.0032236941624432802, 0.0021945848129689693, -0.004050981719046831, 0.008029235526919365, -0.013411150313913822, 0.005036454182118177, -0.007258312311023474, 0.013011142611503601, -0.023913156241178513, 0.015942104160785675, 0.006869214121252298, 0.011760211549699306, 0.02475680783390999, -0.00550555344671011, -0.030225997790694237, 0.05530280992388725, -0.02696775645017624, 0.0006891032680869102, 0.010676555335521698, 0.0048437234945595264, 0.011018379591405392, -0.015680281445384026, -0.03685884177684784, 0.011520206928253174, 0.009411077946424484, 0.03191329911351204, 0.0011091107735410333, -0.0245968047529459, 0.030080540105700493, -0.012007487937808037, 0.042880769819021225, 0.020160362124443054, 0.03159329295158386, 0.0033382417168468237, -0.022996775805950165, 0.04552809149026871, -0.02842232771217823, 0.021774936467409134, 0.003225512569770217, 0.006105564069002867, 0.023302236571907997, 0.01322205550968647, 0.02344769425690174, 0.0010300184367224574, 0.033484239131212234, 0.00873470213264227, -0.02888779155910015, 0.03307695686817169, 0.04069891199469566, -0.008036508224904537, -0.03749885410070419, -0.038167957216501236, 0.049804531037807465, -0.003432788886129856, -0.014698445796966553, -0.03281513601541519, 0.02990599162876606, 0.001393661368638277, -0.011156563647091389, -0.020203998312354088, 0.023331327363848686, 0.010705647058784962, 0.008276511915028095, -0.03165147826075554, 0.024320436641573906, 0.02074219100177288, -0.04817540943622589, -0.001709121628664434, 0.011469297111034393, -0.004876451101154089, -0.029818717390298843, -0.013520242646336555, -0.023651333525776863, 0.026298653334379196, -0.0025382274761795998, -0.011571116745471954, -0.022080397233366966, 0.050531815737485886, 0.0019436712609604, 0.003670975100249052, 0.006240112241357565, -0.015593007206916809, 0.014894813299179077, -0.009738356806337833, 0.022269491106271744, -0.010720192454755306, -0.012022034265100956, -0.01634938456118107, 0.019069433212280273, 0.00011079744581365958, -0.011992942541837692, 0.04177529737353325, 0.01694575883448124, 0.009411077946424484, 0.009701992385089397, 0.018080323934555054, 0.017716681584715843, 0.025702279061079025, 0.03156420215964317, -0.0333096906542778, -0.015534824691712856, -0.00840742327272892, 0.02816050499677658, -0.007087400183081627, 0.002512772334739566, -0.0004690993227995932, 0.0020200363360345364, 0.024684078991413116, 0.06446661055088043, 0.03066236898303032, 0.017993049696087837, -0.018589423969388008, 0.020727645605802536, 0.000625465763732791, -0.008611063472926617, -0.0026073195040225983, -0.005283731035888195, 0.00458190031349659, -0.0003727339790202677, 0.03813886642456055, -0.009098345413804054, -0.00783286802470684, 0.021556749939918518, 0.0042291670106351376, 0.040407996624708176, -0.0022727681789547205, 0.011265656910836697, 0.023054959252476692, -0.003203693777322769, 0.03243694454431534, -0.0023054960183799267, 0.018836701288819313, -0.0009172891732305288, -0.008792885579168797, 0.014174800366163254, 0.02152765914797783, -0.01137474924325943, -0.0022636770736426115, 0.003938252571970224, -0.002798232017084956, 0.014494805596768856, 0.029469620436429977, 0.05364460125565529, -0.007258312311023474, -0.004349168855696917, -0.007956506684422493, -0.0095638083294034, -0.008996524848043919, -0.004374624229967594, 0.0010063817026093602, -0.02717139758169651, 0.033047866076231, -0.0014900267124176025, -0.009978361427783966, -0.01767304539680481, 0.026880482211709023, 0.013432968407869339, 0.004290986340492964, -0.01991308480501175, -0.022124033421278, 0.0035709731746464968, -0.005454643163830042, -0.03508426621556282, 0.007134673651307821, 0.029367800801992416, 0.002812777878716588, 0.0026309562381356955, 0.0037491582334041595, -0.008661973290145397, -0.01472026389092207, 0.0120365796610713, 0.007818322628736496, -0.02357860468327999, 0.003825523192062974, -0.0020436730701476336, -0.028204143047332764, -0.01132383942604065, 0.010872922837734222, 0.020960375666618347, -0.001382752088829875, 0.010014724917709827, 0.01348387822508812, 0.011571116745471954, 0.006836486514657736, -0.025527730584144592, -0.04128074273467064, -0.005821922793984413, -0.017687590792775154, -0.02581864595413208, -0.020393094047904015, -0.03898251801729202, 0.04183347895741463, 0.007221947889775038, 0.00213094730861485, -0.017033033072948456, -0.018647607415914536, 0.01094565074890852, -0.0012572952546179295, 0.024873174726963043, 0.015971194952726364, -0.017193036153912544, 0.08133964240550995, -0.036946117877960205, -0.025004085153341293, 0.02274949848651886, -0.013760247267782688, 0.032233305275440216, -0.010101999156177044, -0.02123674564063549, -0.003836432471871376, 0.028335053473711014, -0.0029018702916800976, 0.02258949726819992, -0.008174692280590534, 0.00026795934536494315, 0.0343569815158844, -0.007840140722692013, -0.002949143759906292, 0.017367584630846977, 0.0068728504702448845, -0.0007091036532074213, 0.02021854557096958, 0.00633829552680254, 0.001610028906725347, -0.012749319896101952, 0.019767627120018005, -0.0009400168783031404, -0.03554973006248474, 0.0005900106043554842, 0.008603790774941444, 0.02498953975737095, 0.00460735522210598, -0.05160820111632347, -0.03368787840008736, -0.0018600333714857697, 0.0065783001482486725, -0.0011045653373003006, 0.0005550099886022508, 0.02357860468327999, -0.015112998895347118, -0.010640190914273262, -0.012174763716757298, -0.021425839513540268, 0.009672900661826134, 0.013258419930934906, -5.738739491789602e-05, 0.019447622820734978, 0.012734774500131607, 0.019796719774603844, 0.001379115623421967, 0.002503681229427457, 0.002501863054931164, 0.006152837537229061, 0.027215033769607544, -0.014327529817819595, 0.002547318348661065, 0.004716448485851288, -0.009469260461628437, 0.01869124546647072, 0.014967541210353374, 0.004036436323076487, -0.022211307659745216, 0.009221984073519707, -0.04747721552848816, 0.03144783899188042, -0.006723756901919842, -0.016596661880612373, -0.00933107640594244, 0.028640514239668846, -0.011949305422604084, 0.05070636421442032, -0.03214603289961815, 0.012087489478290081, -0.025745917111635208, -0.0024418621324002743, -0.007301949430257082, 0.012334766797721386, -0.014305711723864079, 0.01886579394340515, -0.00498554389923811, 0.02964416891336441, -0.0024509530048817396, -0.0009427441982552409, -0.029993265867233276, 0.016407568007707596, -0.02545500174164772, 0.004156438168138266, 0.004618264734745026, 0.0008645609486848116, -0.06132473796606064, 0.04148438200354576, -0.0026836844626814127, 0.006672847084701061, 0.033775150775909424, 0.009265621192753315, -0.028218688443303108, -0.0045418995432555676, -0.008443787693977356, 0.00997108779847622, -0.009054708294570446, 0.012269311584532261, -0.01886579394340515, -0.004032799508422613, 0.0008841067901812494, 0.03874978795647621, -0.013418423011898994, -0.015971194952726364, -0.04037890583276749, 0.001034563989378512, 0.006898305844515562, -0.010851103812456131, -0.012400222942233086, -0.00760740926489234, 0.01751304231584072, 0.018705790862441063, 0.014152981340885162, 0.03985526040196419, 0.0026073195040225983, 0.0476226732134819, 0.013963887467980385, -7.517180347349495e-05, -0.003047327511012554, 0.00901834387332201, 0.02324405312538147, 0.021585842594504356, 0.0006127382512204349, 0.027869591489434242, -0.00794923398643732, 0.0022964049130678177, -0.011403840966522694, -0.001150020631030202, -0.015651190653443336, 0.014371166937053204, 0.006072836462408304, -0.03764431178569794, -0.009127436205744743, 0.03714975714683533, 0.012203855440020561, -0.03706248477101326, -0.015374821610748768, -0.00012204764789203182, 0.004458261653780937, 0.016174836084246635, -0.01842942088842392, 0.04160074517130852, -0.004461898468434811, -0.011534752324223518, 0.034473344683647156, -0.024014975875616074, 0.017338493838906288, 0.005567372776567936, 0.004316441249102354, 0.0073201316408813, 0.012545679695904255, -0.0026418655179440975, -0.001721849082969129, -0.008051053620874882, -0.011614753864705563, -0.03182602673768997, -0.004003708250820637, 0.013142053969204426, 0.04474262148141861, -0.009672900661826134, 0.008414696902036667, 0.0270695760846138, 0.023418601602315903, -0.012945687398314476, -0.0175712238997221, -0.02696775645017624, 0.0027291399892419577, 0.00043568963883444667, 0.005036454182118177, 0.0054073696956038475, 0.019447622820734978, -0.0047891768626868725, -0.00383279612287879, -0.024204071611166, -0.015520278364419937, 0.007934687659144402, 0.0001630711049074307, -0.012371131218969822, -0.007505589164793491, 0.01783304661512375, 0.0069092148914933205, 0.008291058242321014, -0.003014599671587348, 0.028436874970793724, 0.02318587154150009, 0.017760319635272026, 0.004167347680777311, 0.02558591403067112, -0.003967343829572201, -0.02238585613667965, 0.026371382176876068, -0.0027218670584261417, 0.006007380783557892, 0.024974994361400604, -0.00017068488523364067, -0.01608756184577942, 0.010923832654953003, 0.0032346034422516823, 0.010923832654953003, -0.011163836345076561, -0.008938342332839966, 0.010407459922134876, -0.01215294562280178, 0.0014200254809111357, 0.020291272550821304, 0.006756484974175692, 0.030313272029161453, 0.00878561194986105, 0.010989287868142128, -0.025833191350102425, 0.026356836780905724, 0.010262002237141132, 0.031040556728839874, 0.019636716693639755, 0.012254765257239342, 0.021585842594504356, -0.04058254510164261, -0.023127688094973564, -0.007091036532074213, -0.013098416849970818, 0.03194238990545273, 0.0005359186907298863, -0.007505589164793491, 0.020567642524838448, -0.0056546470150351524, 0.028145959600806236, 0.0272004883736372, 0.04084436967968941, 0.004381896927952766, -0.015942104160785675, -0.0007009216933511198, 0.018909430131316185, 0.004636446945369244, -0.016858484596014023, -0.022996775805950165, -0.01144020538777113, 0.0020509460009634495, 0.010443824343383312, -0.03310604766011238, 0.03380424156785011, -0.0003390969941392541, -0.009403805248439312, -0.017105761915445328, 0.056466467678546906, 0.007174674421548843, 0.00814560055732727, -0.020858556032180786, 0.026633204892277718, 0.007091036532074213, -0.011796575039625168, -0.03016781434416771, -0.023913156241178513, 0.03133147209882736, -0.015316639095544815, -0.004992817062884569, -0.015563915483653545, -0.013825702480971813, 0.042851679027080536, -0.016073016449809074, 0.00997108779847622, 0.012407495640218258, -0.002069127978757024, -0.019433075562119484, 0.028975065797567368, -0.01684393920004368, 0.0060619269497692585, -0.004850996192544699, -0.034735169261693954, -0.011258384212851524, 0.013156600296497345, 0.014058434404432774, -0.00939653255045414, 0.024887720122933388, 0.02100401371717453, 0.016611207276582718, -0.007760139182209969, 0.005207366310060024, -0.0296732597053051, 0.0014400258660316467, -0.02077128179371357, -0.021978575736284256, -0.00044705349137075245, 0.0028745969757437706, 0.014880266971886158, -0.01902579702436924, -0.011963850818574429, -0.009236529469490051, 0.020320365205407143, -0.028902336955070496, 0.020451275631785393, 0.010822012089192867, -0.007418314926326275, -0.016116652637720108, -0.001375479274429381, 0.021614933386445045, -0.014138435944914818, -0.02756413072347641, 0.042153485119342804, -0.007898323237895966, -0.03508426621556282, 0.013840248808264732, 0.004367351066321135, 0.030778734013438225, 0.03810977563261986, -0.03130238130688667, 0.027360491454601288, -0.0014091162011027336, -0.0024873174261301756, 0.011105653829872608, 0.007789230905473232, -0.001050927909091115, 0.017716681584715843, 0.027011394500732422, 0.023796791210770607, 0.0028400509618222713, -0.012436587363481522, -0.024204071611166, 0.0037709767930209637, -0.018618516623973846, 0.008021961897611618, 0.001397297834046185, 0.0010118363425135612, 0.01267659105360508, 0.0013818430015817285, -0.019083978608250618, 0.02321496233344078, 0.018647607415914536, -0.03159329295158386, 0.03610246628522873, 0.016669390723109245, 0.025673188269138336, 0.034967899322509766, -0.0011100199772045016, 0.03089510090649128, -0.0013418422313407063, -0.005541917867958546, 0.03333878144621849, -0.021425839513540268, -0.015273001044988632, 0.010429278016090393, 0.02087310142815113, 0.007701956667006016, -0.018953068181872368, 0.01068382803350687, 0.010101999156177044, -0.004160074517130852, -0.026735026389360428, 0.023040413856506348, 0.028611423447728157, 0.027855046093463898, -0.041920751333236694, -0.0171784907579422, -0.005629192106425762, 0.011483842507004738, -0.026400474831461906, -0.012160218320786953, -0.02337496541440487, -0.01658211648464203, -0.02324405312538147, -0.008960160426795483, 0.003825523192062974, 0.027418674901127815, -0.023287691175937653, -0.0076219551265239716, -0.027418674901127815, -0.038720693439245224, -0.006974670570343733, -0.006712847854942083, 0.018211236223578453, 0.048786330968141556, 0.028538694605231285, 0.00432007759809494, -0.009527443908154964, -0.011032924987375736, 0.009221984073519707, -0.02584773674607277, 0.026560476049780846, -0.005309186410158873, 0.0037709767930209637, -0.021280381828546524, -0.0010036544408649206, -0.019098524004220963, 0.01175293792039156, 0.006400114856660366, 0.016465749591588974, 0.033775150775909424, -0.02034945599734783]",Model Alignment as Prospect Theoretic Optimization.pdf
"iderata such as generating grammatical text. To
avoid this, a KL divergence penalty is introduced to restrict
how far the language model can drift from πref. Where πθis
the model we are optimizing, the optimal model π∗is that
which maximizes
Ex∈D,y∈πθ[rϕ(x, y)]−βD KL(πθ(y|x)∥πref(y|x))(2)
where β > 0is a hyperparameter. Since this objective is
not differentiable, we need to use an RL algorithm like PPO
(Schulman et al., 2017).
However, RLHF is often slow (largely because of having
to sample generations) and quite unstable in practice (espe-
cially in a distributed setting). For this reason, recent work
has focused on designing closed-form losses that maximize
the margin between the preferred and dispreferred genera-
tions. In particular, Direct Preference Optimization (DPO)
(Rafailov et al., 2023) has emerged as a popular alternative
since it allows the same optimal policy as in RLHF to be
recovered under certain conditions:
LDPO(πθ, πref) =Ex,yw,yl∼D
−logσ
βlogπθ(yw|x)
πref(yw|x)−βlogπθ(yl|x)
πref(yl|x)(3)
2
Model Alignment as Prospect Theoretic Optimization
3. A Prospect Theoretic View of Alignment
To understand why alignment methods work so well, we
now frame them through the lens of prospect theory (Tver-
sky & Kahneman, 1992). Prospect theory explains why,
when faced with an uncertain event, humans make decisions
that do not maximize their expected value. For example,
because humans are loss-averse, given a gamble that returns
$100 with 80% probability and $0 with 20% probability, a
person might accept $60 to avoid the gamble, despite their
certainty equivalent of$60 being less than the expected
value of $80.
3.1. Prospect Theory
In prospect theory, human utility depends on a value func-
tionand a weighting function :3
Definition 3.1. Avalue function v:Z →Rmaps an out-
come z, relative to some reference point z0, to its perceived
(or subjective) value. For example, these functions capture
the fact that humans tend to be more sensitive to relative
losses than relative gains of the same magnitude.
Definition 3.2. Aweighting function ωis the derivative of
acapacity function that maps cumulative probabilities to
perceived cumulative probabilities. These functions capture,
for example, the fact that humans tend to overestimate the
chance of rare events. Let ωzdenote the weight placed on
outcome z.
Definition 3.3. The utility of a random variable Zis a
function of its outcomes: u(Z)≜P
z∈Zωzv(z−z0).
However, because humans do not see the full probability
distribution of an LLM, weighting functions are not salient
to this discussion; we will focus only on value functions. Us-
ing experiments that presented real humans with monetary
gambles and asked for their certainty equivalent, Tversky &
Kahneman (1992) proposed the following functional form
for human value:
v(z;λ, α, z 0) =(
(z−z0)αifz≥z0
−λ(z0−z)αifz < z 0(4)
where the median value of hyperparameter α= 0.88and
λ= 2.25across individuals. αcontrols the curvature of the
function, which reflects risk aversion; λcontrols its steep-
ness, which reflects loss aversion. While the shape of the
median Kahneman-Tversky value function is illustrated in
Figure 1, it should be noted that it varies across individuals
(Tversky & Kahneman, 1992). There are also other func-
tional forms for the value function that have been proposed
in later work (Gurevich et al., 2009). The salient qualities of
a value function are: the existence of a reference point that
3Cumulative prospect theory is the full name of the expanded
theory we dicuss here (Tversky & Kahneman, 1992).is used to get the relative gain or loss; concavity in relative
gains (i.e., diminishing sensitivity away from z0); and loss
aversion (i.e., greater sensitivity to losses).
3.2. HALOs
Inform","[-0.0364840105175972, 0.010639959014952183, 0.04482736811041832, 0.03258850798010826, 0.01962287537753582, 0.017980366945266724, 0.015509339049458504, 0.03549560159444809, 0.02132352441549301, 0.040815580636262894, 0.03517581894993782, -0.02991398237645626, -0.019172275438904762, 0.012275198474526405, 0.050408985465765, -0.012042631395161152, 0.029347099363803864, -0.04567042365670204, -0.015189559198915958, 0.03133845701813698, -0.004847576841711998, -0.022384613752365112, -0.03561188280582428, 0.042210984975099564, -0.0160907581448555, -0.023576520383358, 0.03285014629364014, 0.04087372124195099, 0.0120717016980052, -0.05165903642773628, 0.05171717703342438, -0.027283065021038055, -0.006435576360672712, -0.014499124139547348, -0.03985624015331268, 0.01856178604066372, 0.0305535439401865, 0.04346103593707085, 0.002213024301454425, 0.019913583993911743, 0.0036156964488327503, -0.020727571099996567, -0.010145753622055054, 0.04067022725939751, -0.0029815868474543095, 0.041658636182546616, 0.03418741002678871, -0.013837761245667934, -0.004244355019181967, 0.010974274948239326, -0.06639799475669861, 0.005839622113853693, 0.0009475304977968335, 0.02713770978152752, 0.012100772932171822, 0.024899248033761978, 0.01843096688389778, -0.00782007910311222, 0.0354083888232708, 0.0026218341663479805, 0.017239058390259743, -0.02436143532395363, -0.012275198474526405, 0.027297599241137505, -0.02380908839404583, -0.03616423159837723, -0.08855003863573074, 0.034361835569143295, -0.02401258423924446, 0.029201745986938477, 0.015204094350337982, -0.013597926124930382, 0.05840349197387695, 0.019375773146748543, -0.024710286408662796, 0.02979769930243492, 0.033838558942079544, 0.046600695699453354, 0.01952112652361393, -0.013394429348409176, 0.013147326186299324, -0.01918681152164936, 0.03250129520893097, -0.019215881824493408, 0.0008739447221159935, -0.04447851702570915, -0.044362232089042664, -0.017893154174089432, -0.05456613004207611, -0.003586625447496772, -0.007921827025711536, -0.04319939762353897, -0.014506392180919647, -0.01082891970872879, 0.01995719037950039, 0.017893154174089432, -0.0187652837485075, 0.020538609474897385, 0.031076820567250252, -0.012624049559235573, -0.026134762912988663, -0.023125922307372093, 0.015930866822600365, -0.007136912550777197, 0.0707586333155632, 0.014361037872731686, -0.014208415523171425, 0.04942057281732559, -0.0010810750536620617, 0.00810352060943842, -0.07634025067090988, -0.005109215155243874, -0.052066028118133545, 0.04953685775399208, -0.022544503211975098, -0.060525666922330856, -0.0868639275431633, 0.0015843654982745647, 0.0115193547680974, 0.0052182311192154884, -0.0029034586623311043, -0.03549560159444809, 0.04494365304708481, -0.001151026925072074, -0.005647027399390936, -0.01303104218095541, 0.022878818213939667, -0.04866473004221916, -0.0022039394825696945, -0.029943054541945457, 0.004069929476827383, 0.04189120605587959, -0.008793954737484455, -0.05282187461853027, -0.07267731428146362, 0.0038664331659674644, 0.0028071613050997257, 0.00965154729783535, 0.02402712032198906, -0.004644080530852079, -0.037908487021923065, -0.04773446172475815, -0.03453626111149788, -0.014077596366405487, -0.06133965402841568, 0.0364840105175972, 0.012500498443841934, 0.0203641839325428, -0.025684162974357605, 0.0343327634036541, 0.041571423411369324, -0.020829318091273308, -0.04130978509783745, 0.0120717016980052, 0.004833041690289974, -0.053577717393636703, -0.020218828693032265, 0.014986062422394753, 0.007754669524729252, -0.024085262790322304, -0.00611216202378273, 0.054420772939920425, -0.008866632357239723, 0.009695153683423996, 0.04726932570338249, 0.02466668002307415, -0.03782127425074577, 0.015567480586469173, -0.04116443172097206, -0.028547650203108788, -0.01995719037950039, -0.008873900398612022, -0.06081637740135193, -0.06122336909174919, 0.00020406427211128175, -0.002020429354161024, -0.01319820061326027, -0.01792222633957863, 0.005414459854364395, -0.029187209904193878, -0.005145553965121508, 0.015102346427738667, 0.00649008434265852, -0.008648600429296494, 0.0002877567312680185, 0.026221975684165955, -0.031483814120292664, -0.02231193520128727, -0.0013354456750676036, 0.016323324292898178, 0.03378041461110115, 0.030727969482541084, 0.07343316078186035, -0.021963084116578102, -0.016119828447699547, 0.0032123373821377754, 0.059043049812316895, 0.07064235210418701, -0.0160907581448555, -0.009150073863565922, 0.01639600284397602, 0.009244554676115513, 0.04061208292841911, -0.06843295693397522, -0.012144379317760468, 0.07000278681516647, 0.02316952869296074, 0.020189758390188217, -0.04421687871217728, -0.0525311641395092, 0.018605392426252365, 0.0038046573754400015, 0.026294652372598648, 0.027297599241137505, -0.014390108175575733, 0.0036502182483673096, -0.016279717907309532, 0.025015531107783318, -0.0006173029541969299, 0.0739564374089241, -0.0004124437691643834, 0.026120226830244064, 0.02478296495974064, 0.026003943756222725, -0.05846163257956505, -0.011373999528586864, 0.03424555063247681, -0.052589304745197296, 0.03613515943288803, -0.042530763894319534, 0.0461064875125885, -0.0037356140092015266, -0.008343355730175972, -0.030902395024895668, -0.02059675194323063, -0.008379694074392319, -0.004564135335385799, 0.017544303089380264, 0.022907890379428864, -0.05209510028362274, -0.011664709076285362, 0.015102346427738667, -0.015145952813327312, -0.0006522788899019361, 0.007558440789580345, 0.05869419872760773, -0.037530567497015, 0.01598900929093361, 0.009520728141069412, -0.014186612330377102, 0.021047350019216537, -0.014491857029497623, 0.009520728141069412, 0.0051746247336268425, -0.029550597071647644, 0.014281092211604118, -0.0018896101973950863, -0.005777846556156874, 0.011606567539274693, -0.002385632833465934, -0.01972462423145771, -0.027501096948981285, -0.0014017637586221099, 0.032559435814619064, -0.02165783941745758, -0.006421040743589401, -0.04168770834803581, -0.023678269237279892, -0.012507765553891659, -0.04956592991948128, 0.03718171268701553, 0.0031251246109604836, -0.029303492978215218, 0.034478116780519485, -0.04860658943653107, -0.05407192185521126, 0.02497192472219467, 0.05020548775792122, -0.01738441362977028, 0.0147462273016572, -0.042734261602163315, 0.0006813498330302536, 0.05651387944817543, -0.032443154603242874, 0.03787941858172417, 0.00210400833748281, 0.010283839888870716, -0.0160907581448555, -0.027399348095059395, -0.020015332847833633, -0.013263610191643238, -0.029434312134981155, 0.054100994020700455, -0.07587511837482452, 0.020567679777741432, 0.035989806056022644, 0.01505874004215002, -0.06174664571881294, 0.010719903744757175, 0.03444904834032059, 0.061804790049791336, 0.0017315370496362448, -0.0035684562753885984, 0.010298375971615314, -0.006580931134521961, -0.019535662606358528, 0.032995499670505524, 0.035873521119356155, -0.020204294472932816, 0.013685138896107674, 0.03174545243382454, 0.026018477976322174, 0.0012482329038903117, 0.0041971150785684586, -0.04636812582612038, -0.02723945863544941, 0.0472111850976944, -0.009331767447292805, -0.002381999045610428, 0.01195541862398386, -0.02186133712530136, -0.04171678051352501, 0.01674485392868519, -0.027646450325846672, 0.02754470333456993, 0.003034277819097042, -0.025902194902300835, 0.00017499334353487939, -0.01674485392868519, -0.011512086726725101, 0.0278790183365345, 0.0011001528473570943, -0.004575036931782961, 0.004037224687635899, 0.003386762924492359, -0.015349448658525944, -0.029012784361839294, 0.05456613004207611, 0.011708315461874008, -0.0321524441242218, -0.07854964584112167, -0.0385771207511425, -0.023750945925712585, -0.022457290440797806, -0.01287841983139515, -0.015087810344994068, 0.031367529183626175, -0.0018242006190121174, 0.04279240220785141, 0.03418741002678871, -0.04226912558078766, -0.01617797091603279, 0.03258850798010826, 0.03709449991583824, -0.011344929225742817, 0.05064155161380768, 0.0010447363601997495, -0.04901358112692833, -0.04052487015724182, -0.0030052070505917072, 0.0003686102572828531, -0.013118254952132702, 0.008764884434640408, 0.006442843936383724, 0.011352196335792542, 0.005766944959759712, -0.01854724995791912, -0.026570826768875122, -0.011083290912210941, 0.007689259946346283, -0.04270518943667412, 0.005319979507476091, -0.04104814678430557, 0.02668710984289646, -0.049071721732616425, -0.00017624249448999763, 0.0029997562523931265, 0.0064828163012862206, 0.030902395024895668, -0.015102346427738667, 0.00922275148332119, 0.006875274237245321, -0.04427501931786537, -0.0268179289996624, 0.008859364315867424, 0.003661119844764471, -0.027515631169080734, -0.015814583748579025, -0.068549245595932, -0.0028816554695367813, 0.045205291360616684, 0.002047683345153928, -0.043490104377269745, 0.0012436906108632684, 0.012289733625948429, -0.0036302318330854177, -0.007950898259878159, 0.03808291256427765, 0.06163036450743675, 0.024157939478754997, -0.036716580390930176, 0.007304070051759481, -0.06145593896508217, -0.010312911123037338, -0.04372267425060272, -0.019797300919890404, -0.02318406291306019, 0.05712436884641647, 0.025466131046414375, 0.02747202478349209, 0.06197921559214592, -0.03526303172111511, 0.028155192732810974, -0.03514675050973892, 0.026149297133088112, -0.033925771713256836, 0.04267612099647522, 0.004244355019181967, 0.06197921559214592, 0.05029270052909851, -0.016570428386330605, -0.04218191280961037, 0.0013100085780024529, -0.024942854419350624, -0.02510274387896061, 0.00981143768876791, 0.03250129520893097, -0.00567973218858242, 1.9162963837970892e-07, -0.08238700777292252, 0.006882541812956333, 0.02542252466082573, 0.04130978509783745, -0.010792581364512444, -0.035873521119356155, 0.02979769930243492, 0.0686655268073082, -0.0018805254949256778, 0.002845316892489791, -0.018896102905273438, 0.009041057899594307, 0.020771177485585213, -0.06663056463003159, -0.017849547788500786, -0.03657122328877449, 0.047676317393779755, 0.02027697116136551, -0.018314683809876442, -0.016643105074763298, -0.019259488210082054, -0.026352794840931892, 0.0675026923418045, 0.04244355112314224, -0.03130938857793808, 0.006991557776927948, 0.0020495003554970026, 0.06424674391746521, -0.007812811061739922, 0.029739556834101677, 0.012580443173646927, -0.028591256588697433, -0.019681017845869064, 0.007536637596786022, -0.035873521119356155, 0.009477121755480766, 0.00574150774627924, 0.0009043783647939563, -0.005341782700270414, -0.05520568788051605, -0.014775298535823822, 0.008234339766204357, -0.041658636182546616, 0.017457090318202972, -0.02239914797246456, 0.008866632357239723, 0.02049500308930874, 0.04753096401691437, -0.015901796519756317, 0.02424515224993229, -0.020102545619010925, 0.03360598906874657, -0.02809705026447773, -0.005349050275981426, -0.004473288543522358, 0.01148301549255848, 0.03933296352624893, 0.04558321088552475, -0.0008943852153606713, -0.01489884965121746, 0.02071303501725197, 0.0268179289996624, -0.06279320269823074, 0.05814185366034508, -0.018067579716444016, 0.012282466515898705, -0.01089432928711176, 0.015741907060146332, 0.02167237550020218, 0.009942256845533848, 0.0023474772460758686, 0.03692007437348366, -0.028329618275165558, -0.016788460314273834, 0.03343156352639198, 0.030408188700675964, 0.013743280433118343, 0.04942057281732559, -0.02498646080493927, -0.03380948677659035, 0.061107087880373, -0.04244355112314224, -0.010320179164409637, -0.03706543147563934, 0.033722274005413055, -0.02347477339208126, 0.013924974016845226, -0.026977820321917534, -0.005439897067844868, -0.006697214674204588, 0.008968380279839039, -0.0187652837485075, -0.019041456282138824, -0.010727171786129475, 0.012464159168303013, -0.003626598045229912, 0.020567679777741432, -0.047560036182403564, -0.07424714416265488, -0.013067381456494331, -0.0386061891913414, 0.013358091004192829, -0.00804537907242775, 0.007856417447328568, 0.020974673330783844, -0.014702620916068554, -0.0024074360262602568, 0.0001779458689270541, -0.04630998522043228, 0.012892955914139748, -0.011185038834810257, -0.007136912550777197, -0.01661403477191925, 0.018590856343507767, 0.044362232089042664, -0.004818506073206663, -0.02572776935994625, 0.04474015533924103, -0.009847776032984257, 0.010160288773477077, 0.00928089302033186, 0.0160762220621109, -0.015436661429703236, -0.043693602085113525, -0.029754092916846275, -0.044333163648843765, 0.026541756466031075, -0.027922624722123146, 0.03241408243775368, 0.01642507314682007, 0.009927721694111824, -0.02818426303565502, -0.013423500582575798, -0.011904544197022915, 0.0294779185205698, -0.001727903145365417, -0.00996406003832817, -0.0006886175833642483, 0.01281301025301218, 0.006838935427367687, 0.02607662044465542, -0.0385771207511425, 0.007184152491390705, 0.019550198689103127, -0.044333163648843765, 0.008307017385959625, -0.011294054798781872, -0.0002670891408342868, -0.025582414120435715, 0.03785034641623497, -0.0055707162246108055, -0.027922624722123146, -0.0044187805615365505, -0.045205291360616684, -0.03154195472598076, -0.03787941858172417, 0.004789435304701328, -0.004277059808373451, 0.01735534332692623, -0.04203655943274498, 0.012355143204331398, 0.028053443878889084, -0.04753096401691437, -0.019274024292826653, 0.013009238988161087, -0.03723985701799393, 0.0060358508490026, -0.013096451759338379, 0.000558706873562187, -0.0035684562753885984, -0.01282027829438448, 0.012427820824086666, 0.009295428171753883, -0.0009575236472301185, -0.043170325458049774, -0.038344550877809525, 0.049042653292417526, -0.027094103395938873, 0.002002259949222207, 0.021715981885790825, 0.0036792890168726444, -0.0009348119492642581, -0.01886703073978424, -0.002489197999238968, -0.009157341904938221, -0.03366413339972496, -0.02476842887699604, 0.005105581600219011, -0.018300147727131844, 0.06709569692611694, -0.019695552065968513, -0.021730517968535423, 0.01564015820622444, 0.014404644258320332, -0.004120803903788328, 0.008379694074392319, 0.00605402048677206, -0.00501110078766942, -0.022660786285996437, 0.026832465082406998, -0.01748616248369217, -0.013895902782678604, -0.005574350245296955, -0.00949892494827509, 0.009237286634743214, 0.013161862269043922, 0.01684660091996193, 0.019433913752436638, -0.013845028355717659, 0.037385210394859314, -0.04215284436941147, 0.022777071222662926, 0.04814145341515541, 0.0018305599223822355, -0.02690514177083969, 0.01099607814103365, -0.006377434358000755, -0.0193176306784153, 0.013423500582575798, -0.023620126768946648, -0.011068754829466343, -0.006072189658880234, -0.002905275672674179, 0.020233364775776863, -0.01527677197009325, 0.02508820965886116, 0.01319820061326027, -0.010974274948239326, -0.0018078482244163752, 0.03238501027226448, -0.003906405530869961, -0.04084465280175209, -0.025887658819556236, -0.01126498356461525, -0.003521215869113803, 0.023765482008457184, 0.04357731714844704, 0.02574230544269085, 0.040583014488220215, 0.017122775316238403, -0.016468679532408714, -0.022660786285996437, 0.01800943911075592, 0.0018877933034673333, -0.023954443633556366, 0.004258890636265278, -0.016584962606430054, 0.005799649748951197, -0.028067979961633682, -0.04096093401312828, 0.017747800797224045, -0.0063483635894954205, -0.002739934716373682, -0.03476882725954056, -0.026861535385251045, 0.005498039070516825, 0.01082891970872879, 0.05413006618618965, -0.0160907581448555, 0.01736987754702568, 0.007147814147174358, -0.012733065523207188, 0.011875472962856293, 0.03380948677659035, -0.04459480196237564, -0.007009726949036121, 0.029419777914881706, 0.018198398873209953, 0.0557871088385582, -0.019274024292826653, -0.04924614727497101, -0.00412807147949934, 0.013801421970129013, -0.017311736941337585, -0.014884314499795437, -0.04944964498281479, -0.02338756062090397, -0.021396201103925705, 0.043693602085113525, 0.03142566978931427, -0.011010613292455673, -0.014331966638565063, 0.01362699642777443, -0.015131416730582714, 0.0029416142497211695, -0.005665196571499109, 0.023736411705613136, 0.010574549436569214, -0.013765083625912666, 0.02122177556157112, -0.02596033737063408, -0.03729799762368202, -0.014222950674593449, -0.04587392136454582, 0.002323857042938471, -0.02553880773484707, -0.005178258754312992, -0.06349090486764908, -0.0011028782464563847, -0.007053333334624767, 0.00027253993903286755, 0.011621102690696716, -0.005730606149882078, -0.02306777983903885, -0.0012146196095272899, 0.004436950199306011, 0.04020509123802185, 0.00032409539562650025, -0.010857990942895412, -0.025495201349258423, 0.01216618251055479, 0.020509539172053337, 0.003521215869113803, -0.01489884965121746, 0.010719903744757175, 0.00868493877351284, -0.0013009239919483662, 0.03947831690311432, 0.01642507314682007, -0.0027726395055651665, 0.01962287537753582, -0.003837362164631486, 0.014760762453079224, 0.00012480057193897665, -0.006653608288615942, 0.020829318091273308, -0.010530943050980568, 0.006555493921041489, -0.004153508692979813, 0.005846890155225992, 0.007602047175168991, -0.0026345527730882168, 0.006755356676876545, -0.019041456282138824, 0.03401298448443413, 0.021614233031868935, -0.020233364775776863, -0.022370077669620514, 0.0014408277347683907, 0.06785154342651367, -0.017878619953989983, 0.012202520854771137, 0.006500985939055681, 0.004891183227300644, 0.026788858696818352, 0.05241487920284271, -0.008118055760860443, 0.01597447320818901, -0.023663733154535294, -0.03741428256034851, -0.008001772686839104, -0.01577097736299038, -0.026221975684165955, 0.025887658819556236, -0.04322846606373787, -0.025248099118471146, -0.010923400521278381, 0.0230387095361948, -0.014520927332341671, 0.009397177025675774, -0.03267572075128555, -0.021904943510890007, -0.0012055350234732032, -0.016337860375642776, -0.0033122687600553036, 0.005505306646227837, 0.03936203569173813, -0.0364258699119091, -0.11930707842111588, 0.003077884204685688, 0.027748199179768562, 0.017718728631734848, -0.0006758990348316729, -0.003786488203331828, 0.04378081485629082, 0.005185526330024004, -0.0011210475349798799, -0.025248099118471146, 0.0008939309627749026, -0.02444864809513092, 0.01705009862780571, -0.003997252322733402, 0.019535662606358528, -0.043054040521383286, -0.022704392671585083, -0.0056070550344884396, -0.011308589950203896, -0.018082115799188614, -0.036513082683086395, 0.006242981180548668, -0.016686711460351944, 0.03186173364520073, -0.03357692062854767, 0.01992812007665634, 0.015320378355681896, 0.011381267569959164, 0.007965433411300182, 0.002089472720399499, -0.011548425070941448, -0.019855443388223648, 0.008917506784200668, 0.03840269520878792, -0.043809887021780014, 0.004378808196634054, -0.002045866334810853, -0.013597926124930382, -0.01995719037950039, 0.028809288516640663, -0.004040858708322048, -0.05084504932165146, 0.045089006423950195, 0.007478495594114065, 0.02959420345723629, -0.014491857029497623, 0.023518379777669907, 0.012340608052909374, 0.009920453652739525, -0.011555693112313747, 0.01715184561908245, -0.029855841770768166, -0.010283839888870716, -0.018183864653110504, -0.0008267044904641807, -0.0026636235415935516, 0.009891382418572903, 0.000672265188768506, -0.014942456036806107, 0.0019241318805143237, -0.016657641157507896, 0.02039325423538685, 0.0354083888232708, -0.0235910564661026, -0.04857751727104187, -0.014477320946753025, 0.0045786709524691105, 0.014281092211604118, -0.009179145097732544, -0.03927482292056084, -0.0024274224415421486, 0.0246521458029747, -0.020872924476861954, 0.04212377220392227, -0.0062102763913571835, 0.0030506302136927843, 0.03145474195480347, 0.028562184423208237, -0.025582414120435715, 0.02658536285161972, 0.03154195472598076, -0.02488471195101738, 0.020625822246074677, 0.01629425399005413, 0.0028289644978940487, 0.032123371958732605, 0.0006386518944054842, -0.007387649267911911, -0.03014655038714409, 0.018721675500273705, 0.03186173364520073, -0.028358688578009605, 0.04232726991176605, -0.006737187039107084, 0.01982637122273445, -0.04421687871217728, -0.03953646123409271, -0.0024346900172531605, 0.014346501789987087, -0.020451396703720093, 0.03851897642016411, 0.016919279471039772, -0.007638385985046625, -0.005585251841694117, -0.005476235877722502, -0.02100374363362789, -0.005167357157915831, -0.003851897781714797, 0.02564055658876896, 0.0013954044552519917, -0.012783939950168133, -0.0014344685478135943, -0.02423061616718769, 0.016323324292898178, 0.004117169883102179, 0.0364549420773983, 0.04139699786901474, 0.02875114604830742, 0.010305643081665039, 0.002084021922200918, 0.008001772686839104, 0.03604794666171074, -0.02081478387117386, -0.0182420052587986, -0.017442556098103523, 0.008336087688803673, 0.013656067661941051, 0.031687308102846146, -0.007950898259878159, 0.010232966393232346, -0.0010283839656040072, -0.01093066856265068, 0.00391003955155611, 0.022573573514819145, -0.025146350264549255, 0.013692406006157398, 0.01792222633957863, 0.006493717897683382, 0.00012287008576095104, 0.01735534332692623, 0.018605392426252365, 0.003221421968191862, 0.007351310458034277, 0.012485962361097336, 0.005327247083187103, 0.019477520138025284, -0.018096651881933212, -0.018590856343507767, 0.013438035733997822, -0.00501473480835557, 0.03366413339972496, -0.007329507265239954, 0.00041471494478173554, 0.004091732669621706, 0.0006159402546472847, 0.035321176052093506, 0.03729799762368202, -0.03171638026833534, 0.017936760559678078, 0.03261758014559746, 0.014433714561164379, 0.04793795570731163, -0.005617956630885601, -0.023721875622868538, 0.03171638026833534, -0.016759388148784637, -0.014862511307001114, 0.004302497021853924, -0.0022039394825696945, -0.008307017385959625, -0.014143005944788456, -0.058723270893096924, -0.004026323091238737, -0.007870953530073166, 0.018794354051351547, 0.029754092916846275, -0.015015133656561375, 0.0006586381932720542, 0.006955218967050314, 0.021250847727060318, 0.026977820321917534, -0.013278145343065262, -0.0034866943024098873, -0.013837761245667934, 0.07593326270580292, 0.0034467217046767473, 0.005403558257967234, -0.028678469359874725, 0.0022402782924473286, 0.00780554348602891, 0.034361835569143295, 0.022370077669620514, 0.0008448737789876759, 0.03799569979310036, -0.017297200858592987, -0.02250089682638645, -0.002988854655995965, 0.06029310077428818, -0.007122376933693886, -0.019274024292826653, -0.06395603716373444, 0.05203695595264435, -0.012035363353788853, -0.0007072411244735122, -0.04921707883477211, 0.0024492256343364716, -0.00217123469337821, -0.014273825101554394, 0.005883228499442339, 0.01812572218477726, 0.01104695163667202, 0.004676785320043564, -0.02982676960527897, 0.035350244492292404, 0.0026836099568754435, -0.06029310077428818, -0.0012155281146988273, -0.00707513652741909, -0.02100374363362789, -0.011664709076285362, 0.010807116515934467, -0.03721078485250473, -0.007696527522057295, 0.007863685488700867, 0.0029579666443169117, -0.03482696786522865, 0.04633905738592148, -0.006101260427385569, 0.014695352874696255, 0.00048648376832716167, -0.01641053706407547, 0.04142607003450394, -0.014768030494451523, 0.012587711215019226, -0.013830493204295635, -0.026730716228485107, -0.0008058097446337342, -0.0020186123438179493, 0.015073275193572044, 0.005280007142573595, 0.030582614243030548, 0.0003736068319994956, 0.021090956404805183, -0.008009039796888828, 0.012922026216983795, -0.022602645680308342, 0.02380908839404583, 0.062037356197834015, -0.032879218459129333, 0.020131615921854973, -0.01694834977388382, 0.030204692855477333, 0.031803593039512634, 0.01561108697205782, -0.006079457234591246, -0.01136673241853714, 0.01393950916826725, 0.03186173364520073, 0.026556290686130524, -0.005734240170568228, -0.033518776297569275, 0.0017315370496362448, 0.011722850613296032, -0.020204294472932816, -0.014913384802639484, -0.010814384557306767, 0.009629744105041027, 0.006217544432729483, 0.039420176297426224, -0.0088448291644454, -0.019971726462244987, 0.024928318336606026, -0.01287841983139515, 0.02907092683017254, 0.024506790563464165, 0.007900023832917213, 0.03799569979310036, -0.014135737903416157, 0.030757039785385132, 0.030437259003520012, -0.026977820321917534, -0.0014072145568206906, -0.009077396243810654, 0.0026454543694853783, 0.0053345151245594025, -0.01693381369113922, 0.007602047175168991, -0.008030842989683151, 0.02017522230744362, 0.017122775316238403, 0.044013381004333496, 0.05596153438091278, -0.007049699779599905, 0.00640650512650609, -0.010472801513969898, -0.025437060743570328, -0.005665196571499109, -0.009128270670771599, -0.007703795563429594, 0.011155967600643635, 0.05479869619011879, 0.011185038834810257, -0.007274999283254147, -0.0052545699290931225, 0.006293855607509613, 0.007965433411300182, 0.019244953989982605, -0.011453945189714432, -0.040176019072532654, -0.0252044927328825, 0.010807116515934467, -0.025335311889648438, 0.000558706873562187, 0.028286011889576912, 0.030931465327739716, -0.003054264234378934, -0.004582304507493973, 0.0031451107934117317, -0.0088520972058177, 0.007740133907645941, -0.010516407899558544, 0.00019509316189214587, -0.009448051452636719, 0.011141432449221611, -0.03194894641637802, -0.006657242309302092, 0.016003545373678207, -0.007140546105802059, 0.015945402905344963, 0.01652682200074196, -0.005450798664242029, 0.041106291115283966, 0.03290828689932823, 0.012158914469182491, -0.028169726952910423, -0.026440007612109184, -0.03482696786522865, 0.006806230638176203, -0.0305535439401865, -0.01832921802997589, 0.033402495086193085, 0.0023910836316645145, 0.035350244492292404, -0.016352396458387375, -0.009876847267150879, 0.006580931134521961, -0.0088520972058177, 0.015712834894657135, -0.014680817723274231, -0.0029506990686059, 0.07174704223871231, -0.013401697389781475, -0.020436860620975494, 0.00276355491951108, -0.0020495003554970026, 0.023983513936400414, 0.0018496377160772681, -0.02059675194323063, -0.03183266520500183, -0.022995103150606155, -0.01898331567645073, 0.021585162729024887, 0.009011986665427685, 0.00774740194901824, 0.0386061891913414, -0.02776273526251316, 0.0022602644748985767, 0.029972124844789505, 0.02510274387896061, 0.012020828202366829, 0.01984090730547905, -0.025248099118471146, -0.005000199191272259, -0.01652682200074196, 0.005785114131867886, 0.0050183688290417194, -0.019492056220769882, 0.014637211337685585, 0.012493230402469635, 0.008125323802232742, -0.012253395281732082, -0.018823424354195595, -0.0675608292222023, 0.024855641648173332, -0.020611286163330078, -0.002302053850144148, 0.010414659045636654, 0.018372824415564537, -0.011490283533930779, -0.007907291874289513, -0.0036284150555729866, -0.01738441362977028, -0.014927920885384083, -0.008386962115764618, -0.007580243982374668, 0.004665883723646402, 0.020669428631663322, 0.008619529195129871, 0.015247700735926628, 0.023663733154535294, 0.006308390758931637, 0.015363984741270542, 0.016817530617117882, -0.0031451107934117317, -0.007264097686856985, -0.011504818685352802, -0.012922026216983795, 0.014833440072834492, -0.004898451268672943, 0.018096651881933212, -0.007009726949036121, 0.005610688589513302, -0.04415873810648918, 0.008423300459980965, 0.03561188280582428, -0.01061815582215786, -0.00210400833748281, 0.03610609099268913, -0.014012186788022518, 0.0450017936527729, -0.0353793166577816, 0.009019254706799984, -0.011068754829466343, 0.009520728141069412, -0.00544716464355588, 0.016861137002706528, -0.044449444860219955, 0.012267930433154106, -0.014564533717930317, 0.008714010007679462, 0.0017624249448999763, -0.010218430310487747, -0.013001971878111362, 0.01356885489076376, 0.0005496221710927784, -0.004004519898444414, 0.028663933277130127, 0.028998248279094696, -0.040815580636262894, 0.04055394232273102, -0.025146350264549255, 0.02187587134540081, 0.059362832456827164, -0.0018678070046007633, -0.018314683809876442, -0.014855243265628815, 0.012558639980852604, 0.009150073863565922, 0.001252775196917355, 0.015509339049458504, -0.008648600429296494, -0.004066295921802521, 0.03552467003464699, 0.024579467251896858, -0.01303831022232771, 0.008779419586062431, -0.020742105320096016, 0.0021439807023853064, 0.007096939720213413, -0.008997451514005661, -0.0001111735837184824, -0.002736300928518176, 0.005439897067844868, -0.009048325940966606, -0.008714010007679462, 0.027297599241137505, 0.029187209904193878, 0.006522789131850004, 0.004553233738988638, -0.02123631164431572, 0.0035666392650455236, -0.010080344043672085, 0.004891183227300644, -0.01716638170182705, -0.011323126032948494, 0.02937617152929306, -0.016163434833288193, 0.01489884965121746, 0.0009775098878890276, 0.0131400590762496, -0.028896501287817955, 0.02594580128788948, 0.006442843936383724, -0.019492056220769882, -0.006540958303958178, 0.018372824415564537, -0.008663135580718517, -0.027079567313194275, -0.013256342150270939, 0.006533690728247166, -0.014295628294348717, -0.01217345055192709, -0.015596551820635796, -0.0019059625919908285, -0.023721875622868538, -0.021817730739712715, 0.02123631164431572, -0.015291307121515274, 0.008067182265222073, 0.0015162305207923055, 0.0030379118397831917, 0.019259488210082054, -0.027268528938293457, 0.01099607814103365, 0.017747800797224045, -0.01098881009966135, -0.016555892303586006, -0.03453626111149788, 0.001097427448257804, 0.010312911123037338, 0.028067979961633682, -0.007696527522057295, 0.0034012983087450266, 0.018794354051351547, 0.02747202478349209, -0.01303104218095541, -0.00758751155808568, -0.026876071467995644, 0.016468679532408714, -0.0010347432689741254, -0.01378688681870699, -0.015509339049458504, 0.025248099118471146, -0.018823424354195595, -0.010225698351860046, -0.035786308348178864, -0.024419577792286873, -0.00413170550018549, -0.011490283533930779, -0.003455806290730834, -0.006984290201216936, -0.008554119616746902, 0.01517502311617136, -0.00619210721924901, 0.007892756722867489, 0.026091156527400017, 0.02466668002307415, 0.008285214193165302, -0.010734439827501774, 0.032966431230306625, 0.022675322368741035, -0.04232726991176605, 0.03718171268701553, 0.006907979026436806, 0.017529768869280815, 0.04067022725939751, 0.004527796525508165, -0.023765482008457184, 0.0019513858715072274, 0.01715184561908245, 0.007173250894993544, -0.02508820965886116, -0.005730606149882078, 0.014397376216948032, -0.007856417447328568, -0.008670403622090816, -0.007536637596786022, 0.00826341100037098, 0.004680418875068426, 0.03526303172111511, 0.0023438434582203627, -0.02271892875432968, 0.02840229496359825, 0.029027320444583893, 0.014869778417050838, 0.04244355112314224, 6.359265171340667e-06, 0.004956592805683613, -0.018169328570365906, -0.008059914223849773, -0.0012782122939825058, 0.008219804614782333, 0.0044187805615365505, 0.0036865568254143, 0.002569143194705248, 0.041135359555482864, 0.030495401471853256, 0.00686437264084816, 0.005189160350710154, 0.029245352372527122, -0.012565908022224903, -0.030640756711363792, -0.015378519892692566, -0.001737896353006363, 0.007180518936365843, -0.0019477520836517215, -0.031890805810689926, -0.003246858948841691, -0.0017133677611127496, 0.00900471955537796, -0.033722274005413055, 0.02164330519735813, -0.007195054087787867, -0.009847776032984257, 0.0016370564699172974, 0.06523516029119492, 0.030495401471853256, -0.010574549436569214, -0.03712357208132744, 0.013125522993505001, 0.0017415301408618689, 0.0041244374588131905, -0.00715508172288537, -0.026934213936328888, 0.030175620689988136, -0.016337860375642776, -0.029550597071647644, -0.01812572218477726, -0.020306041464209557, 0.043257538229227066, 0.0005046530859544873, -0.009549799375236034, 0.010974274948239326, -0.004985664039850235, -0.010792581364512444, 0.015930866822600365, -0.031047748401761055, 0.026992354542016983, -0.02456493303179741, -0.03761778026819229, -0.013118254952132702, 0.03465254232287407, -0.012347876094281673, -0.013023775070905685, 0.002191221108660102, 0.02164330519735813, 0.007006093394011259, -0.001003855373710394, 0.013525248505175114, -0.010690833441913128, 0.013314484618604183, 0.0016752121737226844, -0.02702142670750618, 0.0182420052587986, 0.011010613292455673, -0.011228645220398903, -0.0278790183365345, -0.015073275193572044, 0.020000796765089035, 0.025713233277201653, -0.02347477339208126, -0.012086237780749798, -0.011846402660012245, -0.022442754358053207, -0.005766944959759712, 0.011650173924863338, -0.002020429354161024, -0.017675122246146202, 0.0018151159165427089, 0.02668710984289646, -0.014709888957440853, -0.011701047420501709, 0.0050910459831357, 0.016381466761231422, 0.021585162729024887, 0.027283065021038055, 0.0016098024789243937, 0.020509539172053337, -0.030262833461165428, 0.008597726002335548, 0.02295149676501751, -0.015204094350337982, 0.004803970456123352, 0.024753892794251442, 0.01533491350710392, 0.00426615821197629, -0.0061666700057685375, -0.014913384802639484, -0.02841683104634285, 0.022457290440797806, -0.011214110068976879, -0.011272251605987549, 0.009266357868909836, -0.026410937309265137, 0.025044603273272514, 0.01303104218095541, 0.011541157960891724, 0.04032137617468834, 0.0031632801983505487, 0.002314772456884384, 0.005752409342676401, 0.012275198474526405, -0.0007072411244735122, 0.017965832725167274, -0.012129844166338444, 0.03729799762368202, 0.00699882535263896, -0.0055343774147331715, 0.025916730985045433, -0.011773725040256977, 0.020640358328819275, -0.015145952813327312, -0.010763510130345821, 0.011235913261771202, -0.00036202388582751155, -0.009978595189750195, 0.022035762667655945, 0.007089672144502401, -0.006715383846312761, 0.010356517508625984, 0.00891023874282837, 0.019433913752436638, -0.04697861522436142, -0.020117081701755524, 0.009142805822193623, 0.0009693336905911565, 0.011621102690696716, -0.004524162970483303, -0.003515765070915222, 0.015218629501760006, -0.03401298448443413, -0.003982716705650091, -0.02155609242618084, 0.02831508219242096, 0.016468679532408714, 0.0052109635435044765, -0.008452371694147587, -0.019041456282138824, -0.001292747794650495, -0.008299749344587326, 0.02455039694905281, 0.07465413957834244, -0.0033122687600553036, -0.011068754829466343, -0.005250935908406973, -0.029361635446548462, -0.02231193520128727, -0.02799530141055584, 0.009680618532001972, 0.0006336553487926722, -0.007870953530073166, -0.015698300674557686, 0.009840508922934532, -0.02189040742814541, -0.0009566151420585811, 0.006337461993098259, 0.009542531333863735, 0.026512684300541878, -0.005574350245296955]",Model Alignment as Prospect Theoretic Optimization.pdf
"ally, HALOs are loss functions that reflect the model
of human decision-making in Tversky & Kahneman (1992).
Formally,
Definition 3.4 (HALOs ).Letθdenote the trainable param-
eters of the model πθ:X → P (Y)being aligned, πrefthe
reference model, l:Y → R+a normalizing factor, and
rθ(x, y) =l(y) log[πθ(y|x)/πref(y|x)]the implied reward.
Then f:X × Y → Ris ahuman-aware loss if there exists
a reference point distribution Q(X′, Y′|x, y)overX × Y
and a value function vf: R→ Rthat is non-decreasing
everywhere and concave in (0,∞)such that fis linear in
vf(rθ(x, y)−EQ[rθ(x′, y′)]) (5)
In a classic prospect theory experiment, rθwould be the dol-
lar amount assigned to each outcome; here, rθis measured
in nats, as the decrease in conditional surprisal when going
from πreftoπθ, normalized according to l. This follows
naturally from the next-token prediction objective used to
pretrain and finetune LLMs. As πθis aligned, we would
expect rθto grow increasingly positive for desirable outputs
and increasingly negative for undesirable outputs.
Another perspective on the reward comes from the RLHF
objective in (2). The policy that maximizes this objective
has a closed-form expression (Peng et al., 2019; Peters &
Schaal, 2007); where Z(x)is the partition function:
π∗(y|x) =1
Z(x)πref(y|x) exp1
βr∗(x, y)
Letting l(·) =β, we get
rθ∗(x, y) =r∗(x, y)−βlogZ(x) (6)
Under θ∗, the HALO-defined reward is just the optimal
reward shifted by an input-specific term, meaning that rθ∗
is in the same equivalence class as r∗and would also induce
the optimal policy π∗(Lemma 1, Rafailov et al. (2023)).
The reference point in a HALO is the expected reward from
the human’s perspective, where Q(X′, Y′|x, y)describes
the examples that are perceived as a baseline. We require
that the value function be concave in gains but not neces-
sarily convex in losses—unlike the canonical Kahneman-
Tversky value function—because a minority of individuals
are risk-averse in both the gain and loss regime, resulting in
concavity everywhere (Kahneman & Tversky, 1979).
Theorem 3.5. DPO and PPO-Clip are human-aware losses.
3
Model Alignment as Prospect Theoretic Optimization
Figure 2. HALOs (DPO, offline PPO variant) outperform non-HALOs (SLiC, CSFT), as measured by the GPT-4-0613 -judged winrate
of the aligned model’s generations against the outputs that would have been used for SFT. For better visualization, the y-axis here plots
the winrate above chance (i.e., the winrate – 50%). The difference between methods is only significant (p <0.05)at 13B+ parameters,
and only the HALO-aligned Llama- {13B, 30B }models are able to match the baseline and yield a winrate at or above chance.
The proof is deferred to Appendix B. In Figure 1, we can
see this more intuitively by plotting the value function for
each loss (i.e., the implied human utility).
3.3. Does being a HALO matter?
A natural question is whether modeling human biases has
practical benefits. This is difficult to answer, since both
HALOs and non-HALOs are diverse function classes, but
we attempt to do so by comparing popular methods that
qualify as a HALO with those that do not:
1.CSFT : Conditional SFT is a simple alignment method
where a control token is prepended to the output during
training; then, at inference, the control token corre-
sponding to desirable generations (e.g., <|good|> ) is
appended to the input to induce good generations (Kor-
bak et al., 2023). This is not a HALO.
2.SLiC : Sequence Likelihood Calibration (Zhao et al.,
2023), which","[-0.004690465051680803, 0.009023213759064674, 0.04502846673130989, 0.021608991548419, 0.01221346016973257, -0.001927288481965661, -0.0008422761457040906, 0.02382829412817955, 0.004190392326563597, 0.01592933014035225, 0.043626800179481506, -0.03194626420736313, -0.00274492590688169, -0.016338149085640907, 0.01098700426518917, -0.00482917157933116, 0.010264270938932896, -0.05019710212945938, 0.005347495432943106, 0.034895602613687515, 0.0041502402164042, -0.0013094976311549544, -0.028880124911665916, 0.05977514386177063, 0.0025496419984847307, -0.020207326859235764, 0.02857351116836071, 0.011790040880441666, -0.00674185948446393, 0.001111475983634591, 0.1055336445569992, -0.03355234116315842, -0.0285005085170269, -0.001429953146725893, -0.0028106290847063065, 0.06120600923895836, -0.011505328118801117, 0.017929622903466225, -0.0004991603782400489, 0.00975324772298336, -0.0034968603868037462, -0.04000583663582802, -0.003425682196393609, 0.028018685057759285, 0.02076215296983719, 0.023536279797554016, 0.032851506024599075, -0.006114030722528696, -0.015505911782383919, 0.02120017260313034, -0.05148196220397949, 0.04146590456366539, -0.016819972544908524, 0.0285005085170269, -0.003345378441736102, -0.004668564070016146, 0.008818804286420345, 0.004369250498712063, 0.02306905947625637, -0.017520803958177567, -0.03366914391517639, -0.033026713877916336, 0.01289239153265953, 0.01578332483768463, -0.025200756266713142, 0.010643888264894485, -0.10074461996555328, 0.01975470595061779, 0.007187179755419493, 0.028179293498396873, 0.015520512126386166, 0.012235361151397228, 0.04088187590241432, 0.013644326478242874, -0.023638484999537468, -0.01730179414153099, 0.031391441822052, 0.07323695719242096, 0.027434658259153366, -0.014783178456127644, 0.005380346905440092, -8.053181954892352e-05, 0.07335376739501953, -0.047685787081718445, 0.0162651464343071, -0.028442105278372765, -0.06406773626804352, -0.01846984773874283, -0.04196232557296753, -0.009943055920302868, -0.014994887635111809, 0.001514819567091763, -0.01686377450823784, -0.031391441822052, 0.024558326229453087, -0.017827417701482773, 0.0042268941178917885, -0.003829025663435459, 0.03431157395243645, -0.015695720911026, -0.011030806228518486, -0.054723311215639114, 0.027609866112470627, -0.02432471700012684, 0.04993429034948349, 0.004022484645247459, 0.010914000682532787, 0.026909034699201584, 0.012833989225327969, 0.010870198719203472, -0.056183379143476486, -0.0009335303329862654, -0.04669294133782387, 0.009096217341721058, 0.021054165437817574, -0.06523579359054565, -0.06132281571626663, 0.009935756213963032, 0.008081470616161823, -0.011928747408092022, -0.008439186960458755, -0.03790333867073059, 0.0420791320502758, -0.008950211107730865, -0.012775585986673832, -0.010205868631601334, 0.0541100837290287, -0.04970068112015724, 0.010235069319605827, -0.05197838693857193, 0.0003034201799891889, 0.03577164188027382, -0.01771061308681965, -0.06418454647064209, -0.06494378298521042, 0.015067891217768192, -0.02723024971783161, -0.025229956954717636, -0.020791353657841682, 0.004606511443853378, -0.020878957584500313, -0.08053729683160782, -0.04783179610967636, -0.011308219283819199, -0.07201050221920013, 0.015286901034414768, -0.0069134170189499855, -0.012498173862695694, -0.04406482353806496, 0.057614244520664215, 0.0311870314180851, -0.028164692223072052, -0.036589279770851135, 0.025054749101400375, -0.019199881702661514, -0.035216815769672394, -0.02381369285285473, 0.008388085290789604, 0.0010704116430133581, -0.01592933014035225, 0.005544604267925024, 0.0469849556684494, 0.021054165437817574, 0.013841435313224792, 0.05282522365450859, -0.01059278566390276, 0.022689441218972206, 0.02670462615787983, -0.06284128129482269, -0.023594683036208153, -0.004329098854213953, 0.005989925004541874, -0.07382098585367203, -0.04537888243794441, -0.004562709480524063, 0.0015385455917567015, -0.02619360201060772, -0.011687836609780788, -0.041757915169000626, -0.05857788771390915, -0.00037094828439876437, 0.03977222368121147, -0.014994887635111809, -0.0065447501838207245, -0.05060592293739319, 0.02120017260313034, -0.010629287920892239, -0.006318439729511738, 0.009271425195038319, 0.06897356361150742, 0.014169950038194656, 0.029288943856954575, 0.07066724449396133, -0.05148196220397949, -0.011972549371421337, -0.015228498727083206, 0.05460650473833084, 0.06821432709693909, -0.023550881072878838, -0.01587092876434326, 0.011687836609780788, 0.030456997454166412, 0.04003503546118736, -0.06873995065689087, -0.01747700199484825, 0.023799091577529907, 0.005570155568420887, 0.010381076484918594, -0.022105414420366287, -0.020820556208491325, 0.014133448712527752, 0.020995764061808586, 0.0476565882563591, 0.010176667012274265, -0.03069060854613781, -0.010665789246559143, -0.029858369380235672, 0.014060445129871368, 0.002440136857330799, 0.0801868811249733, 0.01883486472070217, 0.035830043256282806, 0.026179000735282898, 0.033026713877916336, -0.057351432740688324, -0.008490289561450481, 0.03238428756594658, -0.02314206212759018, 0.021477585658431053, -0.03740691766142845, 0.0676887035369873, 0.0013076724717393517, -0.019053874537348747, -0.009234923869371414, -0.008329682052135468, -0.04663453996181488, -0.008848005905747414, -0.03279310464859009, 0.018177833408117294, -0.06587821990251541, -0.02552197128534317, -0.0037377714179456234, 0.04204992949962616, -0.005895020440220833, 0.008840705268085003, 0.04826981574296951, -0.022236820310354233, -0.0059570735320448875, 0.00916192028671503, -0.013403414748609066, 0.04000583663582802, -0.0021298727951943874, -0.02711344324052334, -0.0029383848886936903, -0.04102788120508194, -0.0016882024938240647, 0.005960723385214806, -0.02416410855948925, -0.03232588246464729, -0.021229373291134834, -0.02855890989303589, -0.005920571740716696, -0.0027923781890422106, 0.016411153599619865, -0.028704917058348656, -0.01627974770963192, -0.025989193469285965, -0.013074900023639202, -0.022441228851675987, -0.02035333402454853, 0.0405314601957798, 0.0362972654402256, -0.02162359282374382, -0.00793546438217163, -0.05425608903169632, -0.05647538974881172, 0.025989193469285965, 0.03711490333080292, -0.02061614580452442, -0.01798802614212036, -0.04143670201301575, 0.02441232092678547, 0.03702729940414429, -0.0075631472282111645, 0.009023213759064674, 0.01855745166540146, -0.005851218476891518, -0.008738500997424126, -0.03442838042974472, -0.016995180398225784, -0.01471017487347126, -0.05466490983963013, 0.04152430593967438, -0.051919981837272644, 0.01788582094013691, 0.04806540533900261, 0.011687836609780788, -0.018455246463418007, -0.002655496820807457, 0.015316102653741837, 0.04724776744842529, 0.00012250874715391546, -0.019477292895317078, -0.009329828433692455, 0.023346470668911934, -0.004872973542660475, 0.003533362178131938, 0.04315958172082901, -0.000419313000747934, -0.026222802698612213, 0.01576872356235981, 0.007336836773902178, -0.00601547583937645, 0.01000875886529684, -0.00744269136339426, -0.033610742539167404, 0.039713822305202484, -0.00861439574509859, 0.0017876694910228252, -0.029478752985596657, -0.03615126013755798, -0.06044677272439003, -0.00813987385481596, -0.0004676777170971036, -0.0020933710038661957, -0.01174623891711235, -0.015140894800424576, 0.02263103798031807, -0.011257116682827473, -0.025580374523997307, -0.003336253110319376, -0.007256533019244671, 0.0013916263123974204, -0.0038253755774348974, -0.008840705268085003, 0.0026919986121356487, -0.031099427491426468, 0.05384727194905281, 0.01338881440460682, -0.015286901034414768, -0.06214044988155365, -0.051890779286623, -0.04245874658226967, -0.0027504011522978544, -0.03626806288957596, 0.001686377334408462, 0.007504744455218315, 0.015432908199727535, 0.033610742539167404, 0.004427653271704912, -0.04172871634364128, -0.027405457571148872, -0.0020057670772075653, -0.002786902943626046, -0.02101036347448826, 0.042429547756910324, -0.008256678469479084, -0.039801426231861115, -0.019710903987288475, 0.010556284338235855, -0.00027034053346142173, -0.005592056550085545, 0.009205722250044346, 0.024864941835403442, 0.023127460852265358, 0.031917065382003784, -0.0011123885633423924, -0.008358883671462536, 0.023112861439585686, -0.007628850173205137, -0.029274342581629753, -0.009672943502664566, -0.04850342497229576, 0.01326470822095871, -0.06254927068948746, 0.04748138040304184, 0.006241786293685436, -0.002213826635852456, 0.0006054715486243367, 0.018353041261434555, 0.010789895430207253, -0.013001896440982819, -0.00915461964905262, -0.024353917688131332, -0.009672943502664566, 0.030807413160800934, -0.0018278213683515787, -0.025740981101989746, -0.05127755180001259, -0.008957510814070702, 0.03069060854613781, -0.001471017487347126, -0.0461089164018631, 0.04771498963236809, -0.012395968660712242, 0.0041502402164042, -0.010439478792250156, 0.03034019283950329, 0.04161190986633301, 0.05825667455792427, -0.05180317535996437, 0.004427653271704912, -0.061848439276218414, -0.028091689571738243, -0.04061906412243843, -0.03661847859621048, -0.0003036482958123088, 0.030807413160800934, 0.010154766030609608, 0.030223386362195015, 0.04094027727842331, -0.018951669335365295, 0.03439917787909508, -0.012520074844360352, 0.03766972944140434, -0.03994743153452873, -0.01627974770963192, 0.004551758989691734, 0.02815009094774723, 0.02982916869223118, 0.006614103447645903, -0.06336690485477448, -0.008826104924082756, -0.03355234116315842, -0.036910492926836014, 0.006960869301110506, 0.016761569306254387, -0.023682286962866783, 0.02815009094774723, -0.07948604971170425, -0.003111767815425992, 0.035567231476306915, 0.020966561511158943, -0.04789019748568535, -0.05165717005729675, -0.022528834640979767, 2.2713737052981742e-05, 0.02866111509501934, 0.0016945902025327086, 0.004058986436575651, 0.036238864064216614, 0.025302961468696594, -0.02723024971783161, -0.029099134728312492, -0.013994742184877396, -0.002305080881342292, -0.017535405233502388, -0.005289092659950256, -0.04669294133782387, 0.004314498044550419, -0.0008559642592445016, 0.036676883697509766, 0.06570301204919815, -0.02874871902167797, 0.011563730426132679, -0.04494086280465126, 0.047598183155059814, -0.005227040033787489, 0.04908745363354683, 0.018849464133381844, -0.033698346465826035, -0.012636879459023476, -0.007063074037432671, -0.02347787655889988, 0.017944224178791046, 0.009213022887706757, 0.012184259481728077, -0.01127901766449213, -0.031099427491426468, 0.014075045473873615, 0.012074753642082214, -0.042341943830251694, 0.03945101052522659, -0.016381951048970222, -0.008263979107141495, 0.005544604267925024, 0.043217983096838, -0.014651772566139698, 0.03518761321902275, -0.025638775900006294, 0.01310410164296627, -0.07136807590723038, -0.015914730727672577, 0.0073623876087367535, 0.04657613858580589, 0.05107314512133598, 0.04406482353806496, 0.014082346111536026, -0.019521094858646393, 0.028383702039718628, 0.013147903606295586, -0.06885676085948944, 0.05665060132741928, -0.018542850390076637, -0.0010339099681004882, -0.06628704071044922, 0.010965103283524513, 0.029726963490247726, 0.0041757915169000626, -0.006000875495374203, 0.02687983401119709, -0.060505177825689316, -0.02882172167301178, 0.05784785374999046, 0.045408084988594055, 0.00020862989185843617, -0.002016717568039894, -0.0005662322510033846, -0.03019418567419052, 0.045320481061935425, -0.022280622273683548, 0.0318586602807045, -0.020236529409885406, 0.022689441218972206, -0.018864065408706665, 0.0028745068702846766, -0.020791353657841682, -0.007774856872856617, 0.01882026344537735, 0.003704919945448637, -0.009782449342310429, -0.015900129452347755, -0.01575412228703499, -0.0042852964252233505, 0.00200211675837636, 0.00962914153933525, -0.05270841717720032, -0.07458022236824036, -0.010943202301859856, -0.009716745465993881, 0.024456122890114784, -0.02112716995179653, 0.025229956954717636, 0.0240619033575058, -0.040064238011837006, 0.01620674319565296, -0.020484739914536476, -0.04009344056248665, -0.023842893540859222, -0.010833697393536568, -0.01089940033853054, -0.01195064838975668, 0.025492770597338676, 0.031420640647411346, 0.025244558230042458, -0.024777336046099663, 0.022382827475667, -0.016221344470977783, 0.011454225517809391, 0.030398594215512276, 0.00507008284330368, -0.03372754901647568, -0.03688129410147667, -0.032763902097940445, -0.04172871634364128, -0.001251094858162105, 0.004756168462336063, -0.005497152451425791, 0.03445758298039436, 0.030807413160800934, -0.0006871440564282238, -0.008278579451143742, -0.024777336046099663, 0.015184696763753891, -0.0010548983700573444, 0.028339900076389313, 0.012001750990748405, 0.013140602968633175, 0.025828585028648376, 0.01272448431700468, -0.05373046547174454, 0.004716016352176666, 0.027069641277194023, -0.05089793726801872, -0.0002965761232189834, -0.005405898205935955, 0.020134324207901955, -0.01251277420669794, 0.028690315783023834, 0.005946123041212559, -0.02162359282374382, -0.033377133309841156, -0.036414071917533875, -0.028266897425055504, -0.043539196252822876, 0.00898671243339777, 0.00017429549188818783, 0.017929622903466225, -0.06511899083852768, -0.0004469173727557063, 0.04993429034948349, -0.0213753804564476, -0.001668126555159688, -0.005650459323078394, -0.03510000929236412, -0.0189224686473608, 0.009519636631011963, -0.02322966605424881, 0.02797488309442997, -0.03241348639130592, 0.00654840050265193, -0.0033891804050654173, 0.0026262954343110323, -0.03585924580693245, -0.017535405233502388, 0.013921738602221012, -0.03212147578597069, 0.0040918379090726376, 0.005792815703898668, 0.005351145751774311, 0.004270696081221104, -0.011052707210183144, 0.011549130082130432, -0.03731931373476982, -0.054635707288980484, -0.011556430719792843, -0.004168491344898939, 0.00037665164563804865, 0.03314352035522461, -0.016586361452937126, -0.01368812844157219, 0.00042843841947615147, 0.01898087188601494, -0.0015723096439614892, 0.00936632975935936, -0.0069134170189499855, -0.0017073658527806401, -0.014688273891806602, -0.020572343841195107, -0.00966564379632473, -0.022193018347024918, -0.01899547129869461, -0.0019382389727979898, -0.004635712597519159, 0.02417870983481407, 0.030456997454166412, 0.005898670759052038, 0.004434953443706036, 0.027843477204442024, -0.022061612457036972, 0.010030659846961498, 0.008110672235488892, 0.010351874865591526, -0.030252588912844658, 0.006187033839523792, -0.005555554758757353, 0.012921593151986599, 0.01738939806818962, -0.020221928134560585, -0.022090813145041466, -0.007957365363836288, -0.03241348639130592, -0.001434515812434256, 0.00016357313143089414, 0.03136223927140236, -0.006563001312315464, -0.011702436953783035, 0.02677762880921364, 0.014177250675857067, -0.021638192236423492, -0.024689732119441032, -0.016995180398225784, -0.022674839943647385, 0.004956927616149187, 0.02009052224457264, 0.01883486472070217, 0.013512919656932354, 0.053526055067777634, 0.007413490209728479, -0.03968461975455284, -0.023550881072878838, 0.016849173232913017, 0.03247189149260521, -0.01661556214094162, -0.008329682052135468, 0.0037249960005283356, -0.006187033839523792, -0.02509855106472969, -0.04993429034948349, 0.02287925034761429, -0.023361071944236755, 0.02696743793785572, -0.0561249740421772, -0.03536282107234001, -0.015111693181097507, 0.009417432360351086, 0.05559935048222542, -0.006132281385362148, 0.009030514396727085, 0.009264125488698483, -0.014184551313519478, -0.00792816374450922, -0.007070374209433794, -0.04640093073248863, -0.004613811615854502, 0.0405314601957798, 0.015082492493093014, 0.05568695440888405, -0.0034475831780582666, -0.05758504197001457, -0.012855890206992626, -0.0012894216924905777, -0.0026262954343110323, -0.030486198142170906, -0.03518761321902275, -0.02339027263224125, -0.004350999835878611, 0.053292445838451385, 0.027785075828433037, -0.0017247041687369347, -0.0259453896433115, 0.018031828105449677, -0.00629653874784708, 0.003237698459997773, -0.005376696586608887, -0.009395531378686428, 0.019010072574019432, -0.027858078479766846, 0.006511898711323738, -0.03457438573241234, -0.02324426732957363, -0.008913708850741386, -0.06599503010511398, -0.008059569634497166, 0.0023817343171685934, 0.005533653777092695, -0.05808146670460701, 0.002445612335577607, -0.006376842502504587, 6.2737257394474e-05, -0.009519636631011963, -0.013126002624630928, -0.019988317042589188, -0.020586945116519928, 0.01992991380393505, 0.02807708829641342, -0.004383851308375597, 0.003345378441736102, -0.0037815736141055822, 0.00045900855911895633, 0.021331578493118286, 0.019944515079259872, -0.01271718367934227, -0.0039421808905899525, 0.022864649072289467, -0.0178128182888031, 0.02001751773059368, 0.037173304706811905, 0.01883486472070217, 0.0015202948125079274, 0.0037176955956965685, 0.014432761818170547, 0.013512919656932354, -0.005164986941963434, 0.008804203942418098, -0.00315739493817091, -0.023098260164260864, 0.025901587679982185, 0.02247043140232563, 0.004862023051828146, -3.961002221331e-05, 0.03156664967536926, -0.010381076484918594, 0.030632205307483673, 0.007526645436882973, -0.01013286504894495, -0.03203386813402176, 0.009118118323385715, 0.02723024971783161, -0.023200465366244316, 0.014184551313519478, 0.0037888737861067057, 0.003100817324593663, 0.016235945746302605, 0.04704335704445839, 0.007869761437177658, 0.0340779647231102, -0.00877500232309103, -0.01347641833126545, -0.01889326609671116, -0.02855890989303589, -0.0028234045021235943, 0.03977222368121147, -0.019302085041999817, -0.021506786346435547, 0.016396552324295044, -0.020732952281832695, -0.010775294154882431, 0.030486198142170906, -0.026149800047278404, -0.02949335426092148, 0.021594390273094177, -0.011257116682827473, -0.0011771790450438857, -0.012082054279744625, 0.05162796750664711, -0.02543436735868454, -0.13210685551166534, -0.045232877135276794, 0.043013572692871094, 0.031157828867435455, -0.00500437943264842, 0.016936777159571648, 0.043188780546188354, 0.02737625688314438, 0.0006383230211213231, -0.004869323223829269, 0.00915461964905262, -0.03460358828306198, 0.025317560881376266, 0.012023651972413063, 0.01386333629488945, -0.0654694065451622, -0.004500656388700008, -0.010658489540219307, -0.01874726079404354, -0.019477292895317078, -0.03305591642856598, -0.019199881702661514, 0.016586361452937126, 0.0427507609128952, -0.02280624583363533, -0.017243390902876854, 0.018163233995437622, 0.008585194125771523, -0.020732952281832695, 0.010461379773914814, -0.010468680411577225, -0.031245434656739235, -0.03028178960084915, 0.011213314719498158, -0.0474521778523922, -0.006019126158207655, 0.004529858008027077, 0.005252590868622065, -0.019623300060629845, 0.02728865295648575, -0.0005689698737114668, -0.04123229160904884, 0.05045991390943527, 0.008322382345795631, 0.03799094259738922, -0.04350999742746353, -0.0036173160187900066, -0.018207035958766937, -0.008271279744803905, 0.013695428147912025, 0.01043217908591032, -0.059629134833812714, -0.006110380403697491, -0.01394363958388567, -0.013169804587960243, -0.013352313078939915, 0.017184987664222717, -0.00056121323723346, 0.018426045775413513, 5.036090442445129e-05, -0.02019272744655609, 0.03384435176849365, 0.026646222919225693, -0.030982621014118195, -0.04669294133782387, -0.02493794448673725, 0.0020459189545363188, 0.026047594845294952, -0.02603299543261528, -0.04079427197575569, -0.001919988077133894, 0.012322965078055859, 0.02550737001001835, 0.024616729468107224, 0.004318148363381624, -0.011133010499179363, 0.029653960838913918, 0.015126294456422329, -0.02788727916777134, 0.03282230719923973, 0.040239445865154266, -0.0418747216463089, 0.015243099071085453, 0.0354212261736393, 0.0013469117693603039, 0.0434223935008049, -0.01746240071952343, -0.011169512756168842, -0.027668269351124763, 0.009234923869371414, 0.02847130596637726, -0.0041757915169000626, 0.017842018976807594, -0.01806102879345417, 0.00060957798268646, -0.0403270497918129, -0.015374505892395973, -0.0008605269831605256, 0.022441228851675987, -0.018177833408117294, 0.008059569634497166, -0.002788727870211005, -0.03737771511077881, -0.008972112089395523, 0.00975324772298336, 0.019521094858646393, 0.006690756883472204, 0.018513649702072144, 0.029376547783613205, 0.003985982853919268, -0.0034129065461456776, 0.0027339754160493612, -0.028266897425055504, 0.00801576767116785, -0.00500437943264842, 0.0008892720798030496, 0.039305005222558975, 0.013447216711938381, 0.028266897425055504, 0.00241458578966558, 0.0018570227548480034, 0.0327347032725811, -0.012155057862401009, 0.02109796740114689, 0.009475834667682648, 0.005668709985911846, 0.018674256280064583, 0.0369688980281353, -0.03670608252286911, 0.0013459993060678244, 0.006037376821041107, -0.006387792993336916, -0.013337711803615093, -0.015651918947696686, -0.019550297409296036, 0.034807998687028885, 0.0340779647231102, 0.009337128140032291, -0.020703749731183052, 0.02273324318230152, 0.007460942491889, -0.009351729415357113, 0.004471455235034227, 0.020499341189861298, -0.008709299378097057, 0.019886111840605736, 0.0004220506234560162, -0.021477585658431053, -0.013885237276554108, 0.006796611938625574, 0.008731200359761715, 0.005106584168970585, 0.012578477151691914, -0.009497735649347305, 0.005095633678138256, 0.014301355928182602, 0.033114317804574966, -0.02578478306531906, -0.03019418567419052, 0.019564898684620857, 0.01166593562811613, 0.02458752878010273, -0.015330703929066658, -0.0052489410154521465, 0.02807708829641342, -0.0181486327201128, -0.02391589805483818, 0.03729011118412018, -0.0007432653801515698, 0.004716016352176666, -0.019783908501267433, -0.06476857513189316, 0.02525915950536728, -0.005351145751774311, 0.018528250977396965, 0.009592640213668346, -0.03215067461133003, 0.021214773878455162, -0.015286901034414768, 0.04266315698623657, 0.019973715767264366, 0.0213753804564476, 0.002531391102820635, -0.007150677964091301, 0.059804342687129974, 0.0020951961632817984, 0.01957949809730053, -0.007464592345058918, 0.0018780111568048596, 0.015374505892395973, 0.015243099071085453, 0.026923635974526405, 0.012374067679047585, 0.023594683036208153, -0.005661409813910723, -0.02339027263224125, 0.01538910623639822, 0.030135782435536385, -0.04657613858580589, -0.04038545489311218, -0.047510579228401184, 0.04289676994085312, -0.016338149085640907, -0.001803182763978839, -0.040823474526405334, 0.024120306596159935, 0.012578477151691914, -0.029902171343564987, -0.007398889400064945, 0.011760839261114597, 0.007150677964091301, 0.013374214060604572, -0.01652795821428299, 0.023623883724212646, 0.010381076484918594, -0.043276384472846985, 0.04237114265561104, -0.018630454316735268, 0.004179441835731268, -0.0389837883412838, -0.0031993717420846224, -0.009110817685723305, 0.005537304095923901, 0.00038189877523109317, 0.004248795099556446, -0.015812525525689125, 0.03264709934592247, -0.01157103106379509, 0.00511023448780179, -0.0026682724710553885, 0.0032230978831648827, 0.004186742007732391, 0.01721419021487236, 0.004040735308080912, -0.01645495556294918, -0.03326032683253288, 0.003173820674419403, -0.01790042221546173, 0.010147465392947197, 0.00039284926606342196, 0.05653379485011101, 0.02330266870558262, -0.0011406773701310158, -0.01441086083650589, 0.02120017260313034, 0.004821871407330036, 0.019112277776002884, 0.038370560854673386, -0.023521678522229195, 0.00036159472074359655, -0.005551904905587435, 0.02112716995179653, 0.028383702039718628, -0.0033855303190648556, -0.006880565546452999, -0.00017566431779414415, 0.029741564765572548, 0.06301648914813995, 0.04640093073248863, 0.01908307522535324, -0.037523720413446426, 0.03069060854613781, 0.024967145174741745, -0.0019875161815434694, -0.007971965707838535, -0.004299897234886885, 0.006497298367321491, 0.004018834326416254, 0.019783908501267433, 0.013140602968633175, -0.0036976197734475136, 0.020499341189861298, 6.826953904237598e-05, 0.02347787655889988, -0.003370929742231965, -0.0027686520479619503, 0.032588694244623184, 0.008322382345795631, 0.0405314601957798, 0.006533799692988396, 0.00801576767116785, -0.0071725789457559586, -0.010235069319605827, 0.031829461455345154, 0.01165133435279131, -0.006249086931347847, -0.0011990800267085433, -0.0011863044928759336, 0.01297269482165575, 0.02153598889708519, 0.032092273235321045, 0.03203386813402176, -0.0030515401158481836, -0.002896407851949334, -0.011768139898777008, -0.011111109517514706, 0.00830778107047081, -0.017520803958177567, 0.0008842530660331249, 0.005223389714956284, 0.05317563936114311, -0.005482551641762257, -0.01873265951871872, -0.009651042520999908, 0.014965686947107315, 0.011023505590856075, 0.02645641379058361, -0.037348512560129166, -0.010235069319605827, -0.0035716888960450888, -0.0005114797386340797, -0.028266897425055504, 0.017024381086230278, 0.030924219638109207, 0.01297269482165575, -0.006143231876194477, -0.022660240530967712, -0.01823623664677143, 0.004690465051680803, 0.0012684331741183996, 0.012695282697677612, -0.012111255899071693, 0.00831508170813322, 0.022017810493707657, -0.029960574582219124, -0.00020691886311396956, 0.010067162103950977, -0.005694261286407709, -0.018937068060040474, 0.0256095752120018, 0.001395276514813304, 0.020893558859825134, 0.022572636604309082, -0.0031354939565062523, -0.038458164781332016, 0.0037450718227773905, -0.01933128759264946, -0.024047303944826126, -0.019389688968658447, 0.00101292144972831, 0.026149800047278404, 0.028091689571738243, 0.015170096419751644, 0.0022302523721009493, -0.0077018532902002335, 0.016936777159571648, -0.02171119675040245, 0.014425462111830711, -0.0006433420348912477, -0.017257992178201675, 0.07668271660804749, -0.029712364077568054, -0.018207035958766937, -0.0013989267172291875, -0.001965615199878812, 0.01728719286620617, -0.011454225517809391, 0.0045955609530210495, -0.027244850993156433, -0.017783615738153458, -0.01509709283709526, 0.042955171316862106, -0.021419182419776917, -0.005113884806632996, 0.042517151683568954, -0.015958532691001892, 0.0007241019629873335, 0.02585778571665287, 0.01933128759264946, 0.012848589569330215, 0.022090813145041466, 0.004405752290040255, 0.0013916263123974204, -0.0334063321352005, 0.01991531439125538, 0.004471455235034227, -0.049379464238882065, 0.029726963490247726, 0.0009116293513216078, 0.02975616604089737, -0.0066652060486376286, -0.009169220924377441, -0.03839976340532303, 0.00586946913972497, 0.007212731055915356, -0.02321506477892399, -0.021141769364476204, 0.02644181251525879, -0.012921593151986599, -0.01762300916016102, -0.014111547730863094, -0.017506202682852745, 0.007008321583271027, 0.00916192028671503, -0.000740071467589587, -0.00291465874761343, 0.01098700426518917, 0.02467513270676136, 0.0039969333447515965, 0.01679076999425888, 0.021389981731772423, -0.011045406572520733, 0.02255803532898426, -0.004416702780872583, 0.0005931522464379668, 0.0213753804564476, -0.014272155240178108, 0.022572636604309082, 0.01575412228703499, 0.010578185319900513, -0.01377573236823082, 0.006625053938478231, -0.047189366072416306, 0.02457292750477791, -0.010767994448542595, -0.00444955425336957, -0.01051978301256895, 0.026149800047278404, -0.01807563006877899, 0.04821141064167023, -0.049817487597465515, 0.015710320323705673, -0.007825959473848343, 0.027011239901185036, -0.005654109641909599, 0.01289239153265953, -0.02093736082315445, 0.02492334321141243, -0.020411737263202667, 0.0025149653665721416, 0.02017812617123127, 0.0016161116072908044, -0.01221346016973257, 0.013899837620556355, -0.010395676828920841, 0.006555700674653053, 0.00831508170813322, 0.0005164986941963434, -0.05816907063126564, 0.04038545489311218, 0.005843918304890394, 0.006621403619647026, 0.041582707315683365, 0.005822017323225737, -0.03247189149260521, -0.0053328946232795715, -0.01883486472070217, 0.0003209866117686033, 0.002949335379526019, 0.007665351964533329, 0.01098700426518917, -0.008475689217448235, 0.01406774576753378, 0.03822455555200577, -0.03501240536570549, -0.005686961114406586, -0.02374069020152092, -0.0035826393868774176, 0.006712657865136862, -0.015666518360376358, -0.004584610462188721, -0.0009317052317783237, 0.011439625173807144, 0.019287485629320145, -0.003042414551600814, 0.03693969547748566, 0.03086581639945507, 0.047364573925733566, 0.0028088039252907038, 0.01423565298318863, -0.00037391402292996645, -0.01906847581267357, 0.02264563925564289, 0.002845305483788252, -0.0022685790900141, 0.006738209165632725, -0.016089938580989838, 0.004719666671007872, -0.0008710212423466146, -0.019389688968658447, -0.013877936638891697, 0.029011530801653862, 0.015491310507059097, -0.03857497125864029, -0.0026153449434787035, 0.01940429024398327, 0.014199151657521725, -0.016250545158982277, -0.01127171702682972, 0.02409110590815544, 0.002814279170706868, -1.944854921021033e-05, -0.015973132103681564, 0.007577747572213411, -0.01677617058157921, -0.012235361151397228, 0.027536863461136818, -0.008738500997424126, 0.01136662159115076, 0.0003917085996363312, 0.02153598889708519, 0.01846984773874283, 0.009337128140032291, 0.017579207196831703, -0.001947364304214716, -0.009709445759654045, -0.001072236686013639, -0.02714264579117298, 0.016980579122900963, 0.008855306543409824, 0.02931814454495907, -0.02518615499138832, 0.004533507861196995, 0.01857205294072628, 0.03656007722020149, -0.007833259180188179, -0.01166593562811613, -0.004168491344898939, 0.00593517255038023, -0.0058913701213896275, 0.006128631066530943, -0.019637901335954666, 0.022339025512337685, -0.0004987041465938091, -0.013220906257629395, -0.026339609175920486, -0.014951085671782494, 0.019053874537348747, -0.013885237276554108, -0.015827126801013947, -0.002907358342781663, -0.0013907138491049409, 0.014075045473873615, 0.0311870314180851, -0.010074462741613388, 0.0037523722276091576, 0.03422397002577782, 0.019433490931987762, -0.0007510219584219158, 0.03638486936688423, 0.006333040539175272, -0.023696888238191605, -0.0009755072533152997, 0.0011233390541747212, -0.0025989192072302103, 0.03130383789539337, -0.005179587751626968, -8.036071812966838e-05, 0.006614103447645903, -0.012644180096685886, 0.014600669965147972, 0.0007341399323195219, 0.011512627825140953, 0.015184696763753891, -0.00754854641854763, -0.005373046733438969, 0.014461963437497616, 0.013498319312930107, 0.014425462111830711, 0.017243390902876854, 0.01115491148084402, 0.005398597568273544, 0.03331872820854187, 0.007453641854226589, 0.01807563006877899, 0.025332162156701088, -0.006103080231696367, -0.002160899108275771, -0.00805226992815733, -0.02195940725505352, -0.006541100330650806, 0.01051978301256895, 0.03384435176849365, 0.0046503134071826935, -0.007950064726173878, 0.025288360193371773, -0.008380784653127193, 0.015316102653741837, 0.019652502611279488, 0.029288943856954575, -0.013162503950297832, -0.04406482353806496, -0.006365892011672258, 0.017345596104860306, -5.124492963659577e-05, -0.006537450011819601, -0.0266170222312212, -0.0058074165135622025, -0.003077091183513403, 0.01950649544596672, -0.02603299543261528, 0.028456706553697586, 0.015330703929066658, -0.006084829103201628, -0.029449550434947014, 0.056416988372802734, 0.012235361151397228, -9.399180999025702e-05, -0.017871219664812088, 0.018294639885425568, 0.018367642536759377, 0.01471747551113367, -0.020324133336544037, -0.029040733352303505, 0.00944663304835558, -0.03740691766142845, -0.0030095630791038275, -0.004726966843008995, -0.002852605888620019, 0.04631332680583, -0.02679223008453846, 0.01454226765781641, 0.021141769364476204, -0.010541683994233608, -0.018104830756783485, 0.02109796740114689, -0.03296831250190735, 0.0194918941706419, -0.002410935703665018, -0.04584610462188721, -0.022412028163671494, 0.0227186419069767, -0.0006155095179565251, -0.01538910623639822, 0.015038690529763699, 0.033026713877916336, -0.014586069621145725, 0.006730908993631601, 0.01798802614212036, -0.033026713877916336, 0.02222221903502941, -0.01118411310017109, -0.01355672162026167, -0.008833405561745167, 0.03034019283950329, -0.002717549679800868, -0.005749013740569353, -0.009789749048650265, 0.009497735649347305, 0.032763902097940445, -0.03241348639130592, 0.006274637766182423, 0.02061614580452442, 0.016557158902287483, -0.0354212261736393, 0.013432616367936134, 0.026821430772542953, -0.007745655253529549, 0.0032997513189911842, 0.03010658174753189, -0.0076215495355427265, -0.038545768707990646, 0.0064899977296590805, 0.025390565395355225, 0.049467068165540695, 0.01289239153265953, -0.011344720609486103, 0.0194918941706419, -0.0053292447701096535, -0.0038801280315965414, 0.028193892911076546, 0.006077528931200504, -0.0025989192072302103, 0.004945977125316858, 0.020148925483226776, 0.019856911152601242, -0.0035844645462930202, -0.014352458529174328, -0.027945682406425476, 0.0015878229169175029, -0.01654255948960781, 0.002431011525914073, 0.004307197872549295, 0.0001716719416435808, 0.02248503267765045, 0.008169074542820454, -0.0008039493695832789, 0.04216673597693443, 0.017769014462828636, -0.010943202301859856, 0.014126148074865341, -0.0006739121745340526, 0.006917067337781191, 0.05434369295835495, -0.001992991426959634, 0.023375673219561577, -0.0014326907694339752, -0.00760694919154048, 0.045320481061935425, -0.02282084710896015, 0.01203825231641531, 0.0073331864550709724, -0.0038107747677713633, 0.018864065408706665, -0.017929622903466225, 0.0011078257812187076, 0.0030022626742720604, -0.00024638630566187203, -0.02136078104376793, 0.0026773978024721146, 0.028164692223072052, 0.018367642536759377, -0.024193309247493744, 0.002009417163208127, 0.0030880416743457317, 0.016469554975628853, -0.009205722250044346, -0.008205576799809933, 0.010548983700573444, -0.03679369017481804, -0.017024381086230278, 0.0009216673206537962, -0.038516566157341, 0.035392023622989655, -0.038020145148038864, 0.010417577810585499, -0.015447508543729782, -0.005592056550085545, -0.006716308183968067, 0.0014016643399372697, 0.019462693482637405, 0.02797488309442997, 0.03247189149260521, -0.003865527454763651, -0.005340195260941982, -0.021725796163082123, -0.007190830074250698, -0.015797924250364304, 0.0056979116052389145, -0.019112277776002884, -0.003228573128581047, -0.013790332712233067, 0.004836471751332283, -0.01864505559206009, 0.01272448431700468, -0.001954664709046483, 0.006953569129109383, 0.024383118376135826, -0.018192434683442116]",Model Alignment as Prospect Theoretic Optimization.pdf
" combines a max-margin loss for prefer-
ences with a language modeling loss, is not a HALO:
LSLiC(πθ, πref) =Lcal(πθ) +λregLreg(πθ)
Lcal=Ex,yw,yl∼D
max
0, δ−logπθ(yw|x)
πθ(yl|x)
Lreg=Ex∼D,y∼πref(x)[−logπθ(y|x)]
3.DPO : DPO is a HALO (Theorem 3.5).
4.PPO (offline) : The standard RLHF objective in (2) is
typically optimized with PPO-Clip, which works by
“clipping” how far πθcan drift from the version πoldat
the previous step:
LPPO (offline) =−Ex,y,t∼D[min( qθA(x:y<t, yt),
clip(qθ,1−ϵ,1 +ϵ)A(x:y<t, yt))]where qθ=πθ(yt|x:y<t)
πold(yt|x:y<t)andA(x:y<t, yt)is the per-
token advantage (i.e., the surplus benefit from produc-
ing a given token in a given state).
PPO is an online algorithm—generations are sampled
from the current model, judged by a reward model, and
then used to update the current version. However, for
a fair comparison with offline methods, we consider a
variant of PPO that is only fed offline data. Because
RLHF is also quite unstable in a distributed setting, we
never update πoldand keep it as πref, instead clipping
less conservatively than we traditionally would. Ba-
heti et al. (2023) found that these changes, along with
treating the entire output sequence as a single action,
greatly improves stability. However, since RLHF tradi-
tionally uses token-level advantages, we omit the third
change and only preserve the first two. The PPO-Clip
loss itself is left unchanged and is therefore a HALO
(Theorem 3.5).
Calling this method PPO is somewhat imprecise, be-
cause it is offline and takes only one step, but to avoid
introducing too many new terms, we will call this PPO
(offline) . Instead of using learned rewards, we simplify
even further and use dummy +1/-1 rewards4forywand
ylinstead. Further details on the implementation of
this method can be found in Appendix C.
Experimental Setup We compare these baselines on two
model families, Pythia- {1.4B, 2.8B, 6.9B, 12B }(Biderman
et al., 2023) and Llama- {7B, 13B, 30B }(Touvron et al.,
2023). This permits us to see how LLM alignment scales
within a model family (Llama-2 lacks a 30B model, hence
our use of Llama). Later experiments ( §4.2) are done on
4Note that +1/-1 do not refer to the HALO-implied rewards, but
rather the rewards used for the advantage A(x:y<t, yt)calculation.
4
Model Alignment as Prospect Theoretic Optimization
Mistral-7B and its derivatives (Jiang et al., 2023). The
models were trained on a combination of Anthropic-HH
(Ganguli et al., 2022), OpenAssistant (K ¨opf et al., 2023),
and SHP (Ethayarajh et al., 2022).
All models are aligned under identical settings on the
same data (e.g., same effective batch size, same optimizer,
etc.), save for hyperparameters unique to them. Similar to
Rafailov et al. (2023), the target sequences for SFT are a sub-
set of the generations used to subsequently align the model.
We then use GPT-4-0613 to judge whether the aligned
model’s response is better than the SFT target for a given
test input with respect to helpfulness, harmlessness, and
conciseness, a now standard practice (Zheng et al., 2023; Li
et al., 2023).5Note that while the SFT target is considered
a desirable output for x, it is by no means the best output,
meaning that it can be improved upon by an aligned model.
In Figure 2, we see the results of this analysis:
•HALOs either match or outperform non-HALOs
at every scale , though the gap is only","[-0.006607123650610447, 0.006428048480302095, 0.08070316165685654, -0.0018187310779467225, 0.01090119406580925, -0.00029962428379803896, -0.01617644727230072, 0.021757619455456734, -0.018280578777194023, 0.033755648881196976, 0.034113798290491104, -0.03262150660157204, -0.029741382226347923, -0.012811328284442425, -0.013139632530510426, -0.02225007489323616, 0.025816654786467552, -0.07312231510877609, -0.009334287606179714, 0.024652665480971336, 0.01786273717880249, -0.017907505854964256, -0.013273938558995724, 0.05608033761382103, 0.008595602586865425, -0.013400783762335777, 0.01977287046611309, 0.01720612868666649, 0.010968347080051899, -0.024190055206418037, 0.07067495584487915, -0.04527614265680313, -0.019504258409142494, -0.008603064343333244, -0.017355358228087425, 0.062079351395368576, 0.002889450639486313, -0.00023503601551055908, 0.005308829247951508, 0.001733856974169612, -0.020384710282087326, -0.01584814302623272, -0.0353076308965683, 0.008215067908167839, 0.010132663883268833, 0.022399304434657097, 0.03584485873579979, 0.018728265538811684, 0.0010697869583964348, 0.014691616408526897, -0.045007530599832535, 0.06034829467535019, -0.033666111528873444, 0.006256434600800276, 0.01016997080296278, -0.012997864745557308, 0.018459653481841087, 0.00015575799625366926, 0.05539388582110405, -0.016161523759365082, -0.019713178277015686, -0.019817639142274857, 0.018519345670938492, 0.007468922063708305, -0.0321439728140831, 0.015019920654594898, -0.09676022082567215, 0.020414557307958603, 0.01853426918387413, 0.04829057306051254, -0.007226424757391214, -0.003359522670507431, 0.02866693213582039, -0.01978779397904873, -0.01798211969435215, -0.03605377674102783, 0.044888146221637726, 0.07962870597839355, 0.028517702594399452, -0.018967032432556152, 0.012841173447668552, 0.0032364085782319307, 0.06001998856663704, -0.06190027669072151, 0.04148572310805321, -0.016564441844820976, -0.05912461504340172, -0.010662427172064781, -0.05885600298643112, -0.0052640605717897415, -0.01965348795056343, -0.012318871915340424, -0.010938500985503197, -0.025309273973107338, 0.02459297515451908, -0.02414528653025627, -0.020086253061890602, -0.011266805231571198, 0.029845843091607094, 0.012647176161408424, 0.01672859489917755, -0.03876974806189537, 0.019175954163074493, -0.04038142412900925, 0.06470578908920288, -0.007715150248259306, 0.021086087450385094, 0.007558459881693125, 0.01968333311378956, 0.01180403120815754, -0.054319433867931366, -0.014124545268714428, -0.047813039273023605, -0.0017870197771117091, 0.005428212694823742, -0.05360313504934311, -0.04999178647994995, 0.013908162713050842, -0.010632581077516079, 0.003165524685755372, -0.008222529664635658, 0.004480607341974974, 0.021996386349201202, 0.0011126903118565679, 0.01586306467652321, 0.008916445076465607, 0.055781878530979156, -0.03599408641457558, 0.009677514433860779, -0.03321842476725578, 0.010229662992060184, 0.023115605115890503, -0.006954081356525421, -0.023458832874894142, -0.07855425775051117, 0.01629582978785038, -0.027129871770739555, -0.018265655264258385, -0.008961214683949947, -0.01471400074660778, -0.021891925483942032, -0.07431615144014359, -0.0350390188395977, 0.00558490352705121, -0.050857316702604294, 0.0059169381856918335, -0.014751307666301727, -0.01765381544828415, -0.05160346254706383, 0.04506722092628479, 0.010983269661664963, -0.04638043791055679, -0.03626269847154617, 0.041515566408634186, -0.006248973309993744, -0.045992445200681686, -0.026130035519599915, 0.024801895022392273, 0.021489007398486137, -0.023324526846408844, -0.007233886048197746, 0.02204115502536297, -0.00791660975664854, 0.016937516629695892, 0.044112157076597214, 0.024801895022392273, -0.0009387450409121811, 0.02978615090250969, -0.08900029957294464, -0.02438405342400074, 0.0007135021733120084, -0.00711077218875289, -0.043425701558589935, -0.04921579360961914, -0.024010980501770973, -0.017265820875763893, -0.03450179472565651, -0.02335437200963497, -0.048827797174453735, -0.036023933440446854, 0.021101010963320732, 0.03644177317619324, -0.030621834099292755, 0.007133156526833773, -0.06043783202767372, 0.017489664256572723, 0.0003560515760909766, 0.006498932372778654, 0.022444073110818863, 0.06273595988750458, 0.013923085294663906, 0.03584485873579979, 0.07604720443487167, -0.03787437453866005, -0.015139304101467133, -0.006342241540551186, 0.07503245025873184, 0.06136305257678032, -0.024443745613098145, 0.007047349587082863, 0.0050514088943600655, 0.022787300869822502, 0.014766230247914791, -0.07085403054952621, -0.012706867419183254, -0.010490813292562962, -0.02698064222931862, 0.004779065493494272, -0.021742695942521095, -0.0016639056848362088, 0.022175461053848267, 0.026338955387473106, 0.049394868314266205, 0.009431286714971066, -0.050857316702604294, 0.0003495228011161089, -0.050051476806402206, -0.005790093448013067, 0.02866693213582039, 0.05023055151104927, 0.019190877676010132, 0.031069522723555565, 0.019713178277015686, 0.02786109410226345, -0.05121546611189842, 0.0035870971623808146, 0.026383724063634872, -0.016833055764436722, 0.01523630227893591, -0.06721283495426178, 0.04670874401926994, 0.011371266096830368, -0.01863872818648815, -0.006760083604604006, -0.006372087635099888, -0.037038691341876984, -0.018907342106103897, -0.02841324172914028, 0.0028987773694097996, -0.07592782378196716, -0.019355028867721558, -0.000602512969635427, 0.055244654417037964, -0.027726788073778152, 0.0036766347475349903, 0.024533282965421677, -0.028383396565914154, -0.03721776604652405, 0.009334287606179714, 0.005126023665070534, 0.027473097667098045, -0.00984166655689478, -0.03868021070957184, -0.006913043092936277, -0.04999178647994995, 0.0032625237945467234, -0.000484994932776317, -0.02078763023018837, -0.03572547435760498, 0.0023839366622269154, -0.04169464111328125, 0.017668738961219788, -0.002714106347411871, 0.03205443546175957, -0.006801121402531862, -0.02933846414089203, -0.014975151978433132, 0.009558130986988544, -0.01640029065310955, -0.026667259633541107, 0.02045932598412037, 0.03632238879799843, -0.010953424498438835, -0.007204040419310331, -0.055334191769361496, -0.06094520911574364, 0.015683989971876144, 0.026040498167276382, -0.012863557785749435, -0.02001163735985756, -0.026144959032535553, 0.017355358228087425, 0.048171188682317734, -0.0022962645161896944, 0.009707360528409481, 0.007256270386278629, -0.019578872248530388, -0.004868603311479092, -0.006513854954391718, -0.0024249746929854155, 0.013908162713050842, -0.0461118258535862, 0.05978122353553772, -0.05631910637021065, 0.00865529477596283, 0.047007203102111816, 0.031636592000722885, -0.016564441844820976, 0.006163166370242834, 0.014370772987604141, 0.041067879647016525, -0.004241840448230505, -0.015385531820356846, -0.01325155422091484, 0.04035158082842827, 0.006898120511323214, 0.0017347895773127675, 0.03539716824889183, -0.0057266708463430405, -0.0210114736109972, 0.005614749155938625, 0.009080597199499607, -0.003184178378432989, 0.01572875864803791, 0.012550177052617073, -0.02550327219069004, 0.042410943657159805, -0.018593959510326385, 0.01740012690424919, -0.027353715151548386, -0.03524794057011604, -0.07479368150234222, -0.0024902625009417534, 0.002130246954038739, 0.020265327766537666, -0.01651967316865921, 0.01404993049800396, 0.00516706146299839, -0.050379782915115356, -0.012468100525438786, 0.009513362310826778, 0.012080105021595955, 0.017489664256572723, -0.013467936776578426, -0.012930711731314659, 0.0224589966237545, -0.04190356284379959, 0.07031680643558502, 0.038381755352020264, 0.02866693213582039, -0.08380712568759918, -0.033666111528873444, -0.019399797543883324, 0.010654965415596962, -0.03999342769384384, -0.005510288756340742, 0.013378399424254894, 0.019489334896206856, 0.04482845589518547, 0.0034733100328594446, -0.02080255188047886, -0.010811656713485718, 0.0202205590903759, -0.01651967316865921, -0.0007731938385404646, 0.01674351841211319, -0.020727938041090965, -0.02739848382771015, -0.021384546533226967, 0.006398202385753393, -0.013699241913855076, 0.022742532193660736, -0.020145943388342857, 0.017340434715151787, 0.016430135816335678, 0.038501136004924774, -0.00262643420137465, -0.0064504328183829784, 0.006446701940149069, -0.027831248939037323, -0.009729744866490364, 0.012878481298685074, -0.01493784412741661, 0.03721776604652405, -0.07724104076623917, 0.0359642393887043, 0.009005983360111713, 0.0015650413697585464, -0.011207113973796368, 0.02381698228418827, 0.009073136374354362, -0.0018159330356866121, -0.037934064865112305, -0.032979656010866165, -0.00019364821491762996, 0.02551819570362568, -0.014460310339927673, 0.0030647949315607548, -0.04766381159424782, -0.02336929552257061, 0.01049827504903078, 0.00396203575655818, -0.018280578777194023, 0.04644013196229935, -0.018071657046675682, -0.012893403880298138, 0.00043439690489321947, 0.049932096153497696, 0.040172506123781204, 0.07819610834121704, -0.035576242953538895, -0.0029043734539300203, -0.07055557519197464, -0.02650310844182968, -0.05551326647400856, -0.022876838222146034, -0.02472728118300438, 0.03572547435760498, 0.018131349235773087, 0.03841159865260124, 0.028950467705726624, -0.010819117538630962, 0.03560608997941017, -0.014788615517318249, 0.02865200862288475, -0.0350390188395977, -0.022772377356886864, -0.007054810877889395, 0.05560280382633209, 0.04641028493642807, 0.004864872433245182, -0.06082582846283913, -0.01617644727230072, -0.03259165957570076, -0.02739848382771015, 0.009155211970210075, 0.019862407818436623, -0.023802058771252632, 0.02653295360505581, -0.05709509551525116, -0.010990731418132782, 0.03572547435760498, 0.04059034585952759, -0.04945456236600876, -0.07986747473478317, -0.01731058955192566, -0.020623477175831795, 0.037695299834012985, 0.0007223626598715782, -0.017892582342028618, 0.03536732494831085, 0.018489498645067215, -0.014587155543267727, -0.044261384755373, -0.029308617115020752, -0.031308289617300034, -0.029860764741897583, 0.010647504590451717, -0.022951453924179077, 0.0036300006322562695, -0.02302606776356697, 0.0013169478625059128, 0.058826155960559845, -0.015057227574288845, 0.02069809101521969, -0.06703376024961472, 0.05775170400738716, -0.025876345112919807, 0.0783751830458641, 0.002583530731499195, 0.011811492033302784, -0.016042141243815422, -0.013244092464447021, -0.007129425648599863, 0.013520167209208012, 0.014870691113173962, 0.023846827447414398, 0.01096088532358408, 0.0013467936078086495, 0.01550491526722908, 0.013475397601723671, -0.048827797174453735, 0.025533119216561317, -0.03575532138347626, -0.011998028494417667, 0.002456685993820429, 0.034770406782627106, -0.02045932598412037, 0.03033829852938652, -0.0224589966237545, 0.005883361678570509, -0.07037650048732758, 0.006998850032687187, 0.020966704934835434, 0.033099040389060974, 0.07198817282915115, 0.03921743854880333, 0.008035993203520775, -0.014296158216893673, 0.009968511760234833, 0.01584814302623272, -0.04038142412900925, 0.039157744497060776, -0.01908641681075096, -0.00027420869446359575, -0.05709509551525116, -0.004409723449498415, 0.03324826806783676, -0.02145916037261486, -0.01796719804406166, 0.03551655262708664, -0.017131512984633446, -0.005943053402006626, 0.052528683096170425, 0.04823088273406029, 0.009028367698192596, 0.005215561017394066, -0.007692765910178423, -0.031099367886781693, 0.027114948257803917, 0.0023932636249810457, 0.017176281660795212, -0.00483502633869648, 0.0036934230010956526, 0.0024865318555384874, -0.0029789882246404886, -0.03942635655403137, 0.0019306530011817813, 0.007700227200984955, 0.018787957727909088, 7.968606951180845e-05, -0.0049282945692539215, -0.021533776074647903, 0.0009140289621427655, 0.012893403880298138, 0.0021022665314376354, -0.04551491141319275, -0.08792585134506226, -0.01196818333119154, -0.04076942056417465, 0.025652501732110977, -0.017564278095960617, 0.006178089417517185, 0.015758605673909187, -0.032412584871053696, 0.008864215575158596, -0.02113085612654686, -0.027607403695583344, -0.03936666622757912, -0.018116425722837448, 0.0018252597656100988, 0.007909148000180721, 0.015385531820356846, 0.0005656720022670925, 0.026249418035149574, -0.026159880682826042, 0.03080090880393982, -0.0035889626014977694, 0.008886599913239479, 0.023772213608026505, 0.012206949293613434, -0.02820432186126709, -0.03244243189692497, -0.013236631639301777, -0.05417020618915558, -0.01275909785181284, 0.010199816897511482, -0.012259179726243019, 0.024085594341158867, 0.030860600993037224, 0.005954245571047068, -0.0014428599970415235, -0.021936694160103798, 0.023637907579541206, 0.00556624960154295, 0.0206831693649292, -0.0052864449098706245, 0.02078763023018837, 0.011833876371383667, 0.02584649994969368, -0.03751622512936592, 0.004846218507736921, 0.027682019397616386, -0.017265820875763893, 0.010751964524388313, -0.02484666369855404, 0.007349538616836071, 0.0033240807242691517, 0.031397826969623566, 0.014035007916390896, -0.010692273266613483, -0.0334571897983551, -0.015788450837135315, -0.02696571871638298, -0.04569398611783981, -0.00452537601813674, -0.002089208923280239, 0.032323047518730164, -0.044201694428920746, 0.01966840960085392, 0.031159060075879097, -0.024563128128647804, 0.008356835693120956, -0.01560937613248825, -0.026219572871923447, -0.02899523638188839, 0.013453013263642788, -0.036352235823869705, 0.004014265723526478, -0.03599408641457558, 0.014736385084688663, -0.0033520611468702555, 0.01684797741472721, -0.014587155543267727, -0.01908641681075096, 0.017056899145245552, -0.023220065981149673, 0.009990896098315716, 0.01096088532358408, -0.004238109569996595, -0.011848799884319305, -0.008229991421103477, 0.018937187269330025, -0.03685961663722992, -0.0483502633869648, -0.009356671944260597, -0.006241512019187212, -0.00011553605872904882, 0.029368309304118156, -0.018802881240844727, -0.01291578821837902, 0.004156033508479595, 0.005465520080178976, -0.004700720310211182, 0.004331377800554037, -0.012841173447668552, -0.021742695942521095, -0.015683989971876144, -0.034442100673913956, 0.016027217730879784, -0.03605377674102783, 0.0021806119475513697, 0.011498111300170422, -0.007909148000180721, 0.016818132251501083, 0.03303934633731842, 0.01663905754685402, 0.011945798993110657, 0.015295994468033314, -0.027816325426101685, 0.01596752554178238, 0.011759261600673199, 0.0026152420323342085, -0.043425701558589935, 0.013356014154851437, -0.001096834777854383, 0.006454163696616888, 0.010923578403890133, -0.0025033201090991497, -0.03417348861694336, 0.000511576421558857, -0.023667752742767334, 0.02192177064716816, 0.009856589138507843, 0.03417348861694336, -0.01866857521235943, -0.0022552264854311943, 0.02426467090845108, 0.017788121476769447, -0.01720612868666649, -0.030084609985351562, -0.011617493815720081, -0.01742997206747532, 0.002346629276871681, 0.023682676255702972, 0.03426302596926689, 0.027040334418416023, 0.05291667953133583, 0.0037587108090519905, -0.04139618203043938, -0.010759426280856133, 0.009341748431324959, 0.04921579360961914, -0.006290011573582888, -0.014758769422769547, -0.0059393225237727165, -0.013542551547288895, -0.039157744497060776, -0.05978122353553772, 0.020399633795022964, -0.03975466266274452, -0.0009774513309821486, -0.06703376024961472, -0.009983434341847897, -0.02001163735985756, 0.014900537207722664, 0.0445299968123436, -0.013341091573238373, -0.007909148000180721, 0.005640864372253418, -0.010572889819741249, -0.005771439988166094, 0.003171120770275593, -0.03966512531042099, 0.02080255188047886, -0.0036729041021317244, 0.009819282218813896, 0.06864544004201889, 0.004842488095164299, -0.06727252900600433, -0.011110114865005016, -0.008371759206056595, 0.010043126530945301, -0.0225933026522398, -0.03990389034152031, -0.0375460684299469, -0.014661770313978195, 0.04608198255300522, 0.03000999428331852, 0.009595438838005066, -0.018385039642453194, 0.011759261600673199, -0.018967032432556152, 0.011348881758749485, 0.004249301739037037, 0.016370445489883423, 0.034561485052108765, -0.021548697724938393, -0.010744503699243069, -0.045783523470163345, -0.023399140685796738, -0.007554729003459215, -0.033546727150678635, 0.0014680423773825169, 0.00468952814117074, -0.0021041319705545902, -0.04211248457431793, -0.002242168877273798, -0.004323916509747505, -0.011445880867540836, 0.0036244045477360487, 0.0076293437741696835, -0.02560773305594921, -0.02402590401470661, 0.008685139939188957, 0.026592645794153214, -0.01593768037855625, 0.002630164846777916, -0.029368309304118156, 0.010550505481660366, 0.019175954163074493, 0.013460475020110607, -0.009364132769405842, 0.013781317509710789, 0.009871512651443481, -0.02653295360505581, 0.018474576994776726, 0.0391279011964798, 0.015877988189458847, 0.0032606583554297686, 0.0011238824808970094, 0.015355685725808144, 0.009408902376890182, -0.012938172556459904, 0.02204115502536297, -0.0036766347475349903, -0.01398277748376131, 0.023458832874894142, -0.008744832128286362, 0.008961214683949947, -3.3190383419423597e-06, 0.018907342106103897, 0.00041970715392380953, 0.02233961410820484, 0.008125530555844307, 0.007465191185474396, -0.03417348861694336, 0.0027047793846577406, 0.021503929048776627, -0.0029789882246404886, -0.007618151139467955, 0.005924399942159653, 0.008065839298069477, 0.021160703152418137, 0.06828729063272476, -0.014982612803578377, 0.047007203102111816, -0.010602735914289951, -0.01422154437750578, -0.012654636986553669, -0.022667918354272842, -0.017728431150317192, 0.0230559129267931, -0.020429478958249092, -0.0021190547849982977, 0.010289354249835014, -0.021832233294844627, -0.016430135816335678, 0.023339448496699333, -0.029935380443930626, -0.0036281351931393147, 0.006360895000398159, -0.0032214857637882233, 0.013497781939804554, 0.008453834801912308, 0.05112592875957489, -0.022100847214460373, -0.1349032074213028, -0.036471620202064514, 0.04035158082842827, 0.025100354105234146, -0.011639879085123539, 0.02033994160592556, 0.036561157554388046, 0.02954738400876522, -0.011886106804013252, -0.012497946619987488, 0.016549520194530487, -0.028562471270561218, 0.005282714031636715, 0.01517661102116108, 0.002801778493449092, -0.07210755348205566, 0.005193176679313183, -0.007092118263244629, 0.018489498645067215, -0.03709838166832924, -0.028726624324917793, 0.007647997234016657, 0.023667752742767334, 0.029398154467344284, -0.025980805978178978, -0.007468922063708305, 0.002109728055074811, -0.004335108678787947, -0.006622046232223511, 0.022966375574469566, -0.0009116972214542329, -0.020981626585125923, -0.01899687945842743, 0.010102817788720131, -0.04888749122619629, -0.005099908448755741, 0.0009662591619417071, 0.025876345112919807, 0.0010343450121581554, 0.035904549062252045, 0.018623806536197662, -0.05169299989938736, 0.03829221799969673, 0.0016517809126526117, 0.04178417846560478, -0.034113798290491104, 0.0025350311771035194, -0.0009709225851111114, 0.011736877262592316, 0.011095192283391953, 0.013781317509710789, -0.04530598968267441, -0.00443583820015192, 0.008259836584329605, -0.03384518623352051, -0.014311081729829311, 0.011908491142094135, 0.0002655813586898148, 0.009461131878197193, -0.00646162498742342, -0.006125859450548887, 0.04482845589518547, 0.016668902710080147, -0.029069850221276283, -0.031159060075879097, -0.013244092464447021, -0.012684483081102371, 0.02865200862288475, -0.02898031286895275, -0.05306590721011162, 0.004376146476715803, 0.015198995359241962, 0.023503601551055908, 0.009185058064758778, 0.019489334896206856, 0.012908327393233776, 0.01999671384692192, 0.017161360010504723, -0.04261986166238785, 0.03775499016046524, 0.04205279424786568, -0.03429287299513817, 0.02741340734064579, 0.018355192616581917, 0.008237452246248722, 0.04596259817481041, 0.009304441511631012, 0.003096506232395768, -0.010117740370333195, 0.019384874030947685, 0.033099040389060974, 0.0010156913194805384, 0.010490813292562962, -0.0202205590903759, -0.015295994468033314, -0.03536732494831085, -0.012371101416647434, 0.0012563234195113182, 0.004820103757083416, -0.01829550229012966, 0.030591988936066628, 0.011363804340362549, -0.03894882649183273, -0.009102982468903065, 0.01908641681075096, 0.0116249555721879, 0.002348494715988636, 0.011445880867540836, 0.024652665480971336, -0.01698228530585766, -0.010968347080051899, 0.015818296000361443, -0.0203548651188612, 0.017504585906863213, -0.013863394036889076, 0.019295336678624153, 0.03665069490671158, -0.008326990529894829, 0.030263684689998627, 0.009961050003767014, -0.008550833910703659, 0.039038363844156265, -0.00914775114506483, 0.027831248939037323, -0.002395128831267357, 0.0031487364321947098, 0.010543043725192547, 0.04569398611783981, -0.037247613072395325, -0.008908984251320362, 0.010886271484196186, -0.014505079947412014, -0.01090119406580925, 0.003590828040614724, -0.00944620929658413, 0.022757455706596375, 0.044231537729501724, 0.01550491526722908, -0.03291996568441391, 0.03566578030586243, 0.020951781421899796, -0.004111264832317829, 0.019190877676010132, 0.026368802413344383, -0.013751472346484661, 0.03390487655997276, 0.00021230187849141657, -0.03665069490671158, -0.03199474513530731, 0.001380370231345296, -0.006920504849404097, -0.0005950515042059124, -0.016355521976947784, -0.011721954680979252, 0.007707688957452774, 0.0036113469395786524, 0.002113458700478077, -0.013624627143144608, -0.021503929048776627, 0.01832534745335579, 0.006610854063183069, 0.037247613072395325, -0.005569980479776859, -0.007767380680888891, 0.03897866979241371, -0.0050961775705218315, -0.03054722025990486, 0.021757619455456734, 0.005778901278972626, 0.017698584124445915, -0.009983434341847897, -0.04945456236600876, 0.03862052038311958, -0.011371266096830368, 0.03199474513530731, -0.0032401392236351967, -0.008700063452124596, 0.013117248192429543, -0.021071165800094604, 0.05396128445863724, -0.0031170251313596964, 0.01732551120221615, 0.005301367957144976, 0.0050215632654726505, 0.05616987496614456, -0.009729744866490364, 0.016236137598752975, 0.009065674617886543, 0.014094699174165726, 0.022518688812851906, 0.016683826223015785, 0.027577558532357216, -0.0025760692078620195, 0.024652665480971336, -0.003659846493974328, -0.013236631639301777, 0.030159223824739456, 0.035576242953538895, -0.042440786957740784, -0.03829221799969673, -0.03154705464839935, 0.06037813797593117, 0.009192519821226597, -0.007468922063708305, -0.041754335165023804, 0.006961542647331953, 0.00012299751688260585, -0.03706853836774826, -0.013945469632744789, 0.026786644011735916, 0.007744996342808008, 0.016937516629695892, -0.024966048076748848, 0.034113798290491104, 9.676581976236776e-05, -0.057244326919317245, 0.019593795761466026, -0.003637462155893445, 0.0017021456733345985, -0.03178582340478897, -0.009296979755163193, -0.009677514433860779, 0.01355001237243414, 0.007730073295533657, 0.0036244045477360487, -0.014990074560046196, 0.021608389914035797, -0.01219948846846819, 0.0015128111699596047, 0.000544220267329365, -0.014057392254471779, -0.0014913594350218773, 0.011311574839055538, 0.016922593116760254, -0.01660921238362789, -0.009931203909218311, 0.0062303198501467705, -0.017235973849892616, 0.018907342106103897, -0.0010585947893559933, 0.04527614265680313, 0.01122949831187725, -0.0035236747935414314, -0.004159764386713505, 0.03360641747713089, 0.016833055764436722, 0.018713343888521194, 0.03011445514857769, -0.012945634312927723, -0.012124873697757721, -0.008856753818690777, 0.004585067741572857, 0.008103146217763424, -0.0014820325886830688, 0.010252047330141068, 0.006946620065718889, 0.0202205590903759, 0.06649653613567352, 0.056587718427181244, 0.012557637877762318, -0.023667752742767334, 0.036232851445674896, 0.008849292062222958, 0.010050587356090546, 0.004193340893834829, -0.011557802557945251, -0.011274266988039017, 0.0013085536193102598, 0.044888146221637726, 0.01650475151836872, -0.007730073295533657, 0.008409066125750542, -0.0040105353109538555, 0.03160674870014191, 0.0015361282275989652, 0.018832726404070854, 0.035218093544244766, 0.005763978231698275, 0.028129706159234047, 0.002557415748015046, 0.019161030650138855, -0.024757126346230507, -0.007163002155721188, -3.657864453998627e-06, 0.019802717491984367, -0.011013115756213665, -1.0434386240376625e-05, -0.011818953789770603, 0.021489007398486137, 0.013139632530510426, 0.033427342772483826, 0.037247613072395325, 0.013684319332242012, -0.015124380588531494, -0.003917267080396414, 0.0012992268893867731, 0.009625284001231194, 0.007737534586340189, 0.002363417763262987, -0.023891597986221313, 0.03844144567847252, 0.013751472346484661, -0.004025457892566919, -0.02878631465137005, 0.011789107695221901, 0.00012940970191266388, 0.008297144435346127, -0.040829114615917206, -0.013057556003332138, -0.015027381479740143, -0.0014838980278000236, -0.019399797543883324, 0.014661770313978195, 0.011139960959553719, 0.001593021908774972, -0.004898448940366507, -0.01786273717880249, -0.02730894647538662, 2.2253223505686037e-05, 0.002602184424176812, 0.01460207812488079, -0.017041975632309914, 0.012624791823327541, 0.024533282965421677, -0.024473590776324272, -0.012281564064323902, 0.009573054499924183, 0.006498932372778654, -0.015818296000361443, 0.011662263423204422, 0.005883361678570509, 0.0042828782461583614, 0.008215067908167839, -0.01619136892259121, -0.04641028493642807, 0.005275252740830183, -0.011975644156336784, -0.027667095884680748, -0.017370279878377914, -0.012863557785749435, 0.015042304992675781, 0.025533119216561317, -0.013505243696272373, 0.0018019427079707384, -0.007185386493802071, 0.022727608680725098, -0.013341091573238373, 0.004331377800554037, 0.012796404771506786, -0.023414064198732376, 0.0738983079791069, -0.02402590401470661, -0.008080761879682541, 0.02507050707936287, 0.009632745757699013, 0.02911461889743805, -0.014743845909833908, -0.004644759465008974, -0.028338627889752388, 0.0022123230155557394, -0.01741504855453968, 0.03160674870014191, -0.031308289617300034, -0.012303948402404785, 0.03193505108356476, -0.012945634312927723, 0.0016321945004165173, 0.030278608202934265, 0.016012294217944145, 0.01560937613248825, 0.016161523759365082, 0.005558788310736418, -0.013967853970825672, -0.025756962597370148, -0.004245571326464415, 0.0005414222250692546, -0.023742368444800377, 0.030979985371232033, 0.004372416064143181, 0.03145751729607582, 0.0026096459478139877, -0.026652337983250618, -0.045216452330350876, -0.0023876673076301813, -0.0065399701707065105, -0.008244914002716541, -0.0005101774004288018, 0.038710057735443115, -0.0056520565412938595, -0.02011609822511673, -0.021101010963320732, -0.0014409945579245687, -0.007715150248259306, 0.008401604369282722, 6.960143946344033e-05, 0.00452537601813674, -0.004805180709809065, 0.025309273973107338, -0.003917267080396414, 0.004051573108881712, 0.002081747632473707, -0.006372087635099888, 0.02653295360505581, -0.02144423872232437, 0.019235646352171898, 0.010826579295098782, 0.001817798358388245, 0.011990567669272423, 0.022623149678111076, 0.007163002155721188, -0.023190218955278397, -0.008640371263027191, -0.037934064865112305, -0.005327482707798481, -0.010662427172064781, -0.026234496384859085, -0.0041075339540839195, 0.027458176016807556, -0.03841159865260124, 0.041515566408634186, -0.04091865196824074, 0.0036710386630147696, -0.026771720498800278, 0.01325155422091484, 0.00011314605944789946, 0.009804359637200832, -0.007062272634357214, 0.03474055975675583, -0.008304606191813946, 0.024443745613098145, 0.007614420726895332, 0.006954081356525421, -0.02235453575849533, 0.004405992571264505, -0.019161030650138855, 0.014191698282957077, 0.008759754709899426, -0.00927459541708231, -0.0661383867263794, 0.03641192987561226, 0.014363312162458897, 0.001443792600184679, 0.0299055352807045, -0.0048312959261238575, -0.019399797543883324, -0.0005157734849490225, -0.024473590776324272, 0.007603228557854891, 0.01298294123262167, -0.004170956555753946, 0.010475890710949898, -0.008058377541601658, 0.01707182265818119, 0.034322720021009445, -0.015072150155901909, -0.013564935885369778, -0.042948167771101, 0.0002702447818592191, 0.010252047330141068, 0.009237288497388363, 0.006782467942684889, -0.0024454938247799873, 0.0210114736109972, 0.01934010535478592, -0.008916445076465607, 0.029413077980279922, 0.0195639505982399, 0.05226007103919983, 0.009655130095779896, 0.0050439476035535336, 0.00871498603373766, -0.0017394530586898327, 0.02707017958164215, 0.005860977340489626, 0.01106534618884325, -0.007573382463306189, -0.0007876504678279161, -0.015624298714101315, 0.008035993203520775, -0.013057556003332138, -0.015124380588531494, 0.015027381479740143, 0.019534103572368622, -0.02248884178698063, 0.012639714404940605, 0.004760412033647299, 0.007398038171231747, -0.014057392254471779, -0.00950590055435896, 0.012930711731314659, 0.011095192283391953, 0.01371416449546814, -0.020757783204317093, 0.010923578403890133, -0.01720612868666649, -0.0023578216787427664, 0.013460475020110607, -0.0031095638405531645, 0.014430465176701546, 0.014990074560046196, -0.005070062354207039, -0.006872005295008421, 0.007297308649867773, 0.03963527828454971, -0.00831206701695919, 0.0013635819777846336, -0.016937516629695892, -0.02190684899687767, 0.02921907976269722, 0.01696736179292202, 0.0058721695095300674, -0.02517496794462204, -0.001327207311987877, 0.036113470792770386, 0.03390487655997276, -0.021399470046162605, -0.019743025302886963, 0.007871841080486774, 0.021817311644554138, -0.0009154279832728207, 0.01495276764035225, -0.029248926788568497, -0.00654370104894042, -0.006226588971912861, -0.02742832899093628, -0.014654308557510376, -0.02495112456381321, 0.02460789680480957, -0.011789107695221901, -0.019235646352171898, 0.004678335972130299, -0.01493784412741661, 0.02605541981756687, 0.025010816752910614, -0.007767380680888891, -9.950557432603091e-05, 0.03853098303079605, 0.01631075330078602, 0.0036300006322562695, 0.020145943388342857, 0.007323423866182566, -0.019713178277015686, -0.014810999855399132, -0.00395830487832427, 0.015430300496518612, 0.024100517854094505, -0.006006476003676653, 0.006666814908385277, 0.02821924351155758, -0.00904329027980566, -0.00033413353958167136, 0.006868274416774511, 0.022518688812851906, 0.010528121143579483, -0.01617644727230072, -0.007737534586340189, -0.010087895207107067, -0.006476548034697771, 0.008125530555844307, 0.00017173017840832472, 0.019474413245916367, 0.010140124708414078, 0.014587155543267727, 0.01202041283249855, 0.040500808507204056, -0.01235617883503437, -0.0019455758156254888, 0.01942964270710945, -0.011886106804013252, -0.02392144314944744, -0.0017637027194723487, 0.005189445801079273, 0.02438405342400074, -0.0046410285867750645, -0.015594452619552612, 0.009028367698192596, 0.012781482189893723, 0.023011144250631332, 0.01865365169942379, 0.0318753607571125, -0.00870752427726984, -0.03876974806189537, -0.02335437200963497, 0.0047865272499620914, 0.014975151978433132, -0.0013719761045649648, -0.012900865636765957, 0.00443583820015192, -0.004480607341974974, 0.03381533920764923, -0.030397990718483925, 0.018593959510326385, 0.010707195848226547, -0.0006067100330255926, -0.03987404704093933, 0.053304675966501236, 0.03321842476725578, 0.040620192885398865, -0.031755976378917694, 0.0042082639411091805, 0.020623477175831795, 0.005521480925381184, -0.020638400688767433, -0.04079926759004593, 0.030651681125164032, -0.053424056619405746, 0.0061295898631215096, -0.007961378432810307, 0.0006799256079830229, 0.022652994841337204, -0.024518359452486038, -0.008752292953431606, -0.008759754709899426, -0.016385367140173912, -0.022891761735081673, 0.03339749947190285, -0.016370445489883423, -0.010222201235592365, -0.013632088899612427, -0.027711864560842514, -0.015430300496518612, 0.022071000188589096, -0.008782139047980309, -0.013191862031817436, 0.01040127594023943, 0.01841488480567932, -0.00887913815677166, -0.0028036439325660467, 0.006987657863646746, -0.021981462836265564, 0.036680541932582855, -0.013960393145680428, -0.007931532338261604, -0.009408902376890182, 0.025189891457557678, 0.009259672835469246, -0.004659682046622038, -0.01707182265818119, 0.004096341785043478, 0.025010816752910614, -0.02732386812567711, 0.006506393663585186, 0.027040334418416023, -0.004667143803089857, -0.01152795646339655, 0.03235289454460144, 0.02627926506102085, -0.018071657046675682, -0.012095027603209019, 0.032203663140535355, -0.0018038081470876932, -0.024309439584612846, 0.008953752927482128, 0.018459653481841087, 0.048260726034641266, 0.02056378498673439, -0.0067153144627809525, 0.03045768290758133, 0.0002819033106788993, -0.010945962741971016, 0.017892582342028618, 0.004827565047889948, -0.006021398585289717, 0.012609868310391903, 0.031397826969623566, 0.024861587211489677, -0.0111324992030859, -0.0035460591316223145, -0.025592809543013573, 0.013303784653544426, -0.02908477373421192, 0.006983926985412836, 0.009752129204571247, -0.0019922100473195314, 0.040829114615917206, 0.012624791823327541, 0.010125202126801014, 0.03772514685988426, 0.020623477175831795, -0.010610196739435196, 0.01650475151836872, 0.016833055764436722, -0.0009569323156028986, 0.03462117910385132, -0.01404246874153614, 0.01381862536072731, -0.004887256771326065, -0.005342405755072832, 0.03718791902065277, -0.02236945927143097, -0.016698749735951424, 0.01016997080296278, -0.009908819571137428, 0.016027217730879784, -0.02427959255874157, 0.00871498603373766, -0.0029155658558011055, -0.0017431837040930986, -0.015758605673909187, -0.00920744240283966, 0.028114784508943558, 0.052200380712747574, -0.0013328033965080976, -0.01808658055961132, -0.008073300123214722, 0.01281878910958767, -0.010848963633179665, -0.015266148373484612, -0.005782632157206535, -0.029965225607156754, -0.012714329175651073, -0.01775827631354332, -0.01229648757725954, 0.029293695464730263, -0.02651803195476532, 0.0036430582404136658, -0.01314709335565567, -0.0035012904554605484, 0.00685708224773407, -0.004756681155413389, 0.007047349587082863, 0.029517538845539093, 0.029248926788568497, -0.012229333631694317, -0.002044440247118473, -0.028592316433787346, -0.008185222744941711, -0.0005344271194189787, 0.01404246874153614, -0.018355192616581917, -0.0016079447232186794, -0.002178746508434415, -0.011975644156336784, -0.01540045440196991, 0.014818460680544376, 0.004163495264947414, 0.003055468201637268, 0.016549520194530487, -0.01629582978785038]",Model Alignment as Prospect Theoretic Optimization.pdf
" significant (p <
0.05)at 13B+ model sizes after correcting for multiple
comparisons (Holm, 1979). In fact, only the HALO-
aligned Llama- {13B, 30B }models match or exceed a
win rate of 50% (i.e., are able to match or exceed the
generation quality of the SFT targets in the test data).
•Up to a scale of 7B parameters, alignment provides
virtually no gains over SFT alone. However, it is
worth noting that if the base models were more perfor-
mant, or if the SFT data distribution were less similar to
the preference data, then the gains from the alignment
stage would ostensibly be greater.
•Despite only using dummy +1/-1 rewards, our of-
fline PPO variant performs as well as DPO for all
models except Llama-30B. This challenges conven-
tional wisdom, which places heavy emphasis on reward
learning (Casper et al., 2023), and suggests that even
the simplest rewards can prove useful when used in a
loss function that has the right inductive bias. Despite
its success, our offline PPO baseline still suffers from
hyperparameter sensitivity and training instability, al-
beit not to the same extent as traditional RLHF.
4. Kahneman-Tversky Optimization
The surprising success of offline PPO with dummy +1/-1
rewards suggests that—with the right inductive biases—a
binary signal of good/bad generations may be sufficient
to reach DPO-level performance, even if the offline PPO
approach itself was unable to do so past a certain scale
5We validate that GPT-4 judgments concur with human judg-
ments in Appendix D.(§3.3). Taking a more principled approach, we now derive a
HALO using the Kahneman-Tversky model of human utility,
which allows us to directly optimize for utility instead of
maximizing the log-likelihood of preferences.
4.1. Derivation
The canonical Kahneman-Tversky value function (4) suffers
from numerical instability during optimization due to the
exponent a, so we replace it with the logistic function σ,
which is also concave in gains and convex in losses.
To control the degree of risk aversion, we introduce a hy-
perparameter β∈ R+as part of the value function. The
greater βis, the more quickly the value saturates, meaning
the human is simultaneously more risk-averse in gains and
more risk-seeking in losses. In practice, this has a similar
effect as βin the DPO loss, which controls how far πθdrifts
from πref, though we introduce it here explicitly to control
risk aversion; in DPO, it carries over from the KL constraint
in the RLHF objective (2) and is part of the reward.
We replace the loss aversion coefficient λin the original
Kahneman-Tversky value function (4) with a weighting
function w:X × Y → R+. By default, w(x, y)∈
{λD, λU}, where λDandλUare hyperparameters for de-
sirable and undesirable losses respectively; more complex
schemes could also be used for importance sampling.
Rather than having just one dispreferred generation serve
as the reference point z0, we assume that humans judge
the quality of (x, y)in relation to all possible input-output
pairs. We break down Q(X′, Y′|x, y)into a uniform prior
over inputs in the dataset and let Q(Y′|X′)beπθ. The
reference point simplifies to the expected KL divergence
KL(πθ(y′|x′)∥πref(y′|x′))w.r.t. Q(X′). However, as we
discuss further below, we end up taking a biased estimate of
this term in practice.
Where λydenotes λD(λU)when yis desirable(undesirable)
respectively, the default KTO loss is:6
LKTO(πθ, πref) =Ex,y∼D[λy−v(x, y)] (7)
where
rθ(x, y) = logπθ(y|x)
πref(y|x)
z0=Ex′∼D[KL(πθ(y′|x′)∥πref(y′|x′))]
v(x, y) =(
λDσ(β(rθ(x, y)−z0))ify∼ydesirable|x
λUσ(β(z0−rθ(x, y)))ify∼yundesirable","[0.0001758659491315484, 0.010887782089412212, 0.041090771555900574, 0.02444801852107048, 0.01733561046421528, -0.014917675405740738, 0.009134424850344658, 0.05231791362166405, -0.01857992820441723, 0.01706695184111595, 0.03051406890153885, -0.008681945502758026, -0.02635691501200199, -0.029665669426321983, 0.03419046103954315, -0.02597513608634472, 0.029015231877565384, -0.05093219503760338, -0.02048882469534874, 0.02481565810739994, -0.007734566926956177, -0.023599620908498764, 0.011524080298841, 0.023840000852942467, 0.013128967955708504, 0.00757195707410574, 0.031645268201828, -0.003980403300374746, 0.007932526990771294, -0.040807969868183136, 0.054410628974437714, -0.0386304147541523, -0.030825147405266762, -0.037075016647577286, 0.007861826568841934, 0.036339737474918365, 0.019527306780219078, 0.0417129285633564, -0.0062357294373214245, -0.00035548783489502966, -0.014861115254461765, -0.06510045379400253, -0.025056038051843643, 0.006150889676064253, 0.006956868339329958, 0.023599620908498764, 0.047170959413051605, -0.010152502916753292, -0.00048208481166511774, -0.008618315681815147, -0.042646169662475586, 0.04626600071787834, -0.008597105741500854, 0.005737295374274254, -0.016939692199230194, -0.011396820656955242, 0.012683558277785778, -0.004220782779157162, 0.028591031208634377, -0.01493181474506855, -0.022524982690811157, -0.02350063994526863, 0.025155017152428627, 0.028294092044234276, -0.016572052612900734, -0.007621447090059519, -0.09683055430650711, 0.037301257252693176, -0.0048570819199085236, 0.02145034447312355, -0.006016559898853302, -0.004429347347468138, 0.04991411790251732, 0.006896773353219032, -0.01274011842906475, -0.005899905227124691, 0.05110187456011772, 0.06866372376680374, 0.01997978612780571, -0.03600037842988968, 0.022935042157769203, 0.019088968634605408, 0.04982927814126015, -0.051865432411432266, 0.0055888257920742035, -0.03215430676937103, -0.057634543627500534, -0.042928967624902725, -0.05115843564271927, -0.001053428277373314, -0.02546609751880169, -0.028591031208634377, -0.015242894180119038, -0.023401660844683647, 0.01931520737707615, -0.03280474618077278, -0.004277342930436134, 0.0014502312988042831, 0.05067767575383186, 1.7868289432954043e-05, -0.014394495636224747, -0.03037266992032528, 0.015907473862171173, 0.007126547861844301, 0.06606196612119675, -0.006218054331839085, 0.010520142503082752, 0.04227852821350098, 0.015978172421455383, 0.001279667834751308, -0.08868592977523804, 0.013701637275516987, -0.07776986807584763, 0.031305909156799316, -0.011403891257941723, -0.07030396163463593, -0.046068042516708374, 0.024787377566099167, -0.0035897865891456604, -0.009643463417887688, -0.010046453215181828, -0.016374092549085617, 0.024264199659228325, 0.020955445244908333, -0.009360664524137974, -0.021549323573708534, 0.01171497069299221, -0.038545574992895126, 0.020375706255435944, -0.019159667193889618, -0.010746382176876068, 0.05158263444900513, -0.015836773440241814, -0.044682323932647705, -0.08008882403373718, 0.042419929057359695, -0.010838291607797146, 0.009452573955059052, 0.008349656127393246, -0.011241281405091286, -0.043947044759988785, -0.05619226396083832, -0.04428640380501747, -0.006935658399015665, -0.07635587453842163, -0.00028412515530362725, -0.008003226481378078, -0.008045646362006664, -0.03800825774669647, 0.04601148143410683, 0.01982424594461918, -0.03206946700811386, -0.029835350811481476, 0.015271174721419811, 0.01990908570587635, -0.039337415248155594, -0.01815572939813137, 0.04069485142827034, 0.01633167266845703, -0.024193499237298965, -0.005716085433959961, 0.03783857822418213, -0.01153115089982748, 0.014945955015718937, 0.043947044759988785, 0.01903240755200386, -0.022920900955796242, 0.02152104303240776, -0.07222700119018555, -0.023811720311641693, 0.029807070270180702, 0.014104626141488552, -0.05528730899095535, -0.02539539709687233, -0.01383596658706665, 0.011396820656955242, -0.033342063426971436, -0.006656393874436617, -0.03238054737448692, -0.04705784097313881, 0.005610035732388496, 0.01101504173129797, -0.02143620327115059, 0.006589228753000498, -0.029156630858778954, 0.017293190583586693, 0.009226334281265736, -0.032521944493055344, -0.0025133807212114334, 0.040949370712041855, 0.03837589547038078, 0.020008066669106483, 0.06951212137937546, -0.04157153144478798, -0.005800925195217133, -0.011828090064227581, 0.0634036511182785, 0.06521356850862503, -0.02686595544219017, 0.02833651192486286, 0.014288445934653282, -0.004984341561794281, 0.01727905124425888, -0.081050343811512, -0.02590443566441536, 0.0076850769110023975, -0.005758505314588547, -0.0019672242924571037, -0.05658818408846855, -0.025296417996287346, -0.00379658374004066, 0.011969489976763725, 0.050819072872400284, 0.010258552618324757, 0.007529537193477154, -0.01080294232815504, -0.05491966754198074, 0.04295724630355835, 0.010088873095810413, 0.07912730425596237, -0.0005143416346982121, 0.02576303668320179, -0.0012832029024139047, 0.019711127504706383, -0.009756583720445633, -0.00977072399109602, 0.018537508323788643, -0.02569233626127243, 0.016741732135415077, -0.03888493403792381, 0.054495468735694885, 0.019484886899590492, -0.00830723624676466, 0.0014652550453320146, 0.01962628774344921, -0.019880807027220726, 0.010753451846539974, -0.020898884162306786, 0.00757195707410574, -0.0708695575594902, -0.01350367721170187, -0.001157710561528802, 0.005104531534016132, -0.04092109203338623, -0.002223511226475239, 0.02898695133626461, -0.029693949967622757, -0.011177651584148407, -0.016359953209757805, -0.022652242332696915, 0.019640427082777023, -0.013044128194451332, 0.00015520832675974816, 0.0031514472793787718, -0.04623772203922272, 0.0071512931026518345, 0.02912835031747818, -0.009749514050781727, -0.010930201970040798, 0.007960806600749493, -0.00885162502527237, -0.013341067358851433, -0.00815876666456461, 0.0063028945587575436, -0.010336322709918022, -0.011255420744419098, -0.04985755681991577, -0.020177746191620827, -0.013864247128367424, -0.030316108837723732, 0.0027873427607119083, 0.011255420744419098, -0.03291786462068558, 0.015865053981542587, -0.04210884869098663, -0.06029285863041878, 0.012054329738020897, 0.03840417414903641, -0.0528552308678627, -0.03990301117300987, -0.025197437033057213, 0.03438842296600342, 0.0609150193631649, 0.011389750987291336, 0.026950795203447342, -0.02649831585586071, -0.008646595291793346, 0.02203008346259594, -0.02473081834614277, -0.02912835031747818, 0.0038990983739495277, -0.03170182555913925, 0.059105101972818375, -0.05511762574315071, 0.012174519710242748, 0.053618788719177246, 0.00830016564577818, -0.044399525970220566, 0.0011745017254725099, 0.02203008346259594, 0.05294007062911987, -0.01771738938987255, -0.011509940959513187, 0.0017798695480450988, 0.03880009427666664, -0.011007971130311489, 0.04524792358279228, 0.04010097309947014, 0.00918391440063715, -0.004496512468904257, -0.0027926452457904816, 0.023698600009083748, 0.01186344027519226, 0.025282276794314384, -0.00215104385279119, -0.016529632732272148, 0.06447829306125641, -0.024278338998556137, 0.0026406405959278345, -0.0373295359313488, -0.03088170848786831, -0.058143582195043564, -0.003347639460116625, 0.012167450040578842, 0.026187235489487648, -0.02195938304066658, -0.019230367615818977, -0.0079395966604352, -0.036933619529008865, -0.03950709477066994, -0.0006513226544484496, -0.0006252520834095776, -0.0006818120018579066, 0.017363891005516052, -0.044088445603847504, -0.0049737365916371346, -0.02232702262699604, 0.08025850355625153, -0.0013945552054792643, 0.010399952530860901, -0.08834657073020935, -0.005875159986317158, -0.01763254962861538, -0.019202087074518204, -0.03704673796892166, -0.01262699905782938, 0.03611350059509277, 0.03537822142243385, 0.04940507560968399, 0.02150690369307995, -0.007352787535637617, -0.03498230129480362, 0.028944531455636024, 0.02839307300746441, 0.019711127504706383, 0.012089679948985577, -0.019781826063990593, -0.01734975166618824, -0.04400360584259033, -0.00757195707410574, -0.016430651769042015, 0.007663866970688105, 0.014917675405740738, 0.018169868737459183, 0.023741019889712334, 0.03345518559217453, -0.017590129747986794, -0.0002260186884086579, 0.006504388991743326, 0.007101803086698055, -0.03814965486526489, 0.022341161966323853, -0.04736892133951187, 0.020163606852293015, -0.05568322539329529, -0.006748303771018982, 0.02576303668320179, 0.023811720311641693, 0.009297034703195095, 0.024645978584885597, -0.014974234625697136, 0.014677295461297035, -0.03008987009525299, -0.009678813628852367, 0.01633167266845703, 0.005366120953112841, 0.00215988140553236, -0.023302681744098663, -0.0410059317946434, -0.031871505081653595, 0.020446404814720154, -0.02912835031747818, -0.026738695800304413, 0.03475606068968773, -0.016925550997257233, -0.002577010774984956, -0.030316108837723732, 0.032833024859428406, 0.042928967624902725, 0.08365210145711899, -0.05158263444900513, -0.0079395966604352, -0.07680834829807281, -0.0379234179854393, -0.05630538612604141, -0.02672455459833145, -0.0014652550453320146, 0.033709704875946045, -0.0021174615249037743, 0.04001613333821297, 0.04476716369390488, 0.0013812988763675094, 0.022284602746367455, -0.04759516194462776, 0.030683748424053192, -0.020729204639792442, 0.009608114138245583, 0.004871221724897623, 0.03848901391029358, 0.05384502932429314, -0.014147046022117138, -0.035519618541002274, -0.0010065895039588213, -0.029920190572738647, -0.03834761679172516, 0.03650941699743271, 0.0015244662063196301, -0.015907473862171173, 0.023698600009083748, -0.04411672428250313, 0.010074732825160027, 0.03973333165049553, 0.01800018921494484, -0.035236820578575134, -0.06781532615423203, -0.00271664303727448, -0.005493380594998598, 0.00991919357329607, -0.011106951162219048, 0.00984849315136671, 0.03492574021220207, -0.0139844361692667, -0.015426713973283768, -0.023528920486569405, -0.04086453095078468, -0.008625385351479053, -0.005861020181328058, 0.0050833215937018394, -0.0031638196669518948, -0.032833024859428406, -0.02012118697166443, 0.04137356951832771, 0.05497622862458229, -0.040214091539382935, -0.01027976255863905, -0.05240275338292122, 0.06074533984065056, -0.025211578235030174, 0.023684460669755936, -0.0020449941512197256, -0.009106144309043884, -0.023246120661497116, -0.014776275493204594, -0.003686998737975955, 0.011071600951254368, 0.011729110032320023, -0.0001716681435937062, -0.011425101198256016, -0.026625575497746468, 0.030344389379024506, -0.02467425912618637, -0.06300773471593857, 0.013828896917402744, -0.03755577653646469, -0.029467711225152016, 0.004422277677804232, 0.018608208745718002, -0.008936464786529541, 0.022143201902508736, -0.00848398543894291, 0.010576702654361725, -0.035972099751234055, -0.0036339738871902227, 0.0004679448320530355, 0.028364792466163635, 0.04553072527050972, 0.06125437840819359, -0.004977271426469088, -0.03724469617009163, 0.006872028578072786, 0.010986761189997196, -0.07562059164047241, 0.05271383002400398, -0.017816370353102684, -0.014620735310018063, -0.003909703344106674, 0.01997978612780571, 0.01532773394137621, 0.017250770702958107, -0.00991212297230959, 0.05619226396083832, -0.05443890765309334, -0.028562752529978752, 0.02276536263525486, 0.022312883287668228, 0.026328636333346367, 0.025664057582616806, -0.006550344172865152, -0.01743459142744541, 0.022129062563180923, -0.025805456563830376, 0.01196242030709982, -0.021832123398780823, 0.014069275930523872, -0.01511563453823328, -0.002672455506399274, -0.027912313118577003, -0.014550035819411278, -0.007352787535637617, 0.02364204078912735, -0.017533570528030396, -0.015200474299490452, -0.019060688093304634, 0.012344199232757092, 0.0010180782992392778, -0.015030794776976109, -0.04994239658117294, -0.08155938237905502, -0.03074030764400959, -0.028803132474422455, 0.03243710473179817, -0.007713356986641884, 0.03337034583091736, -0.003211542032659054, -0.032974425703287125, -0.01314310822635889, -0.016232693567872047, -0.028449632227420807, -0.02941115014255047, -0.011227141134440899, 0.015539834275841713, -0.006727093830704689, 0.00860417541116476, 0.006621043663471937, 0.02350063994526863, -0.030202988535165787, 0.03834761679172516, -0.02159174345433712, 0.0009093772387132049, 0.004496512468904257, 0.007967876270413399, -0.022567402571439743, -0.029552550986409187, -0.008717295713722706, -0.06787188351154327, -0.010187853127717972, -0.012018979527056217, 0.022793641313910484, 0.034727782011032104, 0.025664057582616806, 0.004775776993483305, 0.004425812512636185, -0.014521755278110504, 0.03461466357111931, 0.0070593832060694695, 0.012365409173071384, 0.011997769586741924, 0.02285020239651203, 0.013991506770253181, 0.03718813881278038, -0.041967447847127914, 0.032550226897001266, 0.024052100256085396, -0.02847791276872158, 0.01684071123600006, -0.005610035732388496, 0.043579407036304474, 0.0003451037919148803, 0.024052100256085396, 0.012322989292442799, -0.02362789958715439, -0.008964745327830315, -0.031221067532896996, -0.021252384409308434, -0.04722752049565315, 0.00252398569136858, 0.020036347210407257, 0.026385195553302765, -0.051356393843889236, 0.028279952704906464, 0.03857385367155075, -0.03520854189991951, -0.007130083162337542, -0.004450557753443718, -0.028675870969891548, -0.0063523841090500355, -0.0019813640974462032, -0.005995349958539009, 0.029298031702637672, -0.022213902324438095, 0.019852526485919952, -0.01153115089982748, 0.003296382026746869, -0.028053712099790573, -0.04663364216685295, 0.04225024953484535, -0.021535184234380722, 0.003874353598803282, 0.0003539412864483893, -0.019880807027220726, 0.024546999484300613, -0.011509940959513187, 0.0016420047031715512, -0.0158791933208704, -0.04275928810238838, -0.026088256388902664, -0.003920308314263821, -0.0026583154685795307, 0.04751031845808029, -0.022963320836424828, -0.0180143304169178, -0.005995349958539009, 0.0032362870406359434, -0.0067624435760080814, -0.010357532650232315, 0.015907473862171173, -0.01917380839586258, -0.01335520762950182, -0.006836678367108107, -0.0024055633693933487, -0.031136227771639824, -0.02019188553094864, -0.0037329536862671375, 0.00598121015354991, 0.020361565053462982, 0.0020662040915340185, 0.00737399747595191, -0.011644270271062851, 0.007515397388488054, -0.028817271813750267, 0.020771624520421028, 0.04097764939069748, 0.023840000852942467, -0.010838291607797146, -0.00881627481430769, 0.018622348085045815, -0.011007971130311489, 0.02217148244380951, -0.006175634451210499, -0.03925257548689842, -0.01845266856253147, 0.005330771207809448, 0.01925864815711975, 0.010110083036124706, 0.036198340356349945, 0.00010207295417785645, -0.00037382563459686935, -0.0021492764353752136, 0.0003943727642763406, 0.001746287103742361, -0.0380365364253521, -0.013977366499602795, -0.01910310797393322, 0.0022889086976647377, 0.02921319007873535, 0.034077342599630356, -0.003379454370588064, 0.050903916358947754, -0.007423487491905689, -0.01792949065566063, -0.02714875526726246, 0.009360664524137974, 0.026512455195188522, -0.018749607726931572, -0.007996156811714172, -0.008533475920557976, 0.006582159083336592, -0.04553072527050972, -0.0541561096906662, 0.02034742571413517, -0.014790414832532406, -4.2778952774824575e-05, -0.04544588550925255, -0.026116536930203438, -0.005436820909380913, -0.021789703518152237, 0.04722752049565315, -0.023175420239567757, 0.015044935047626495, -0.003994543105363846, -0.011828090064227581, -0.017802231013774872, 0.02665385603904724, -0.021620023995637894, -0.004705077037215233, 0.006589228753000498, 0.008554685860872269, 0.07132203876972198, -0.023246120661497116, -0.0833127424120903, -0.012655278667807579, 0.006016559898853302, -0.013482467271387577, -0.017236631363630295, -0.042193688452243805, -0.019810106605291367, -0.023755159229040146, 0.06006661802530289, 0.03877181559801102, -0.02949598990380764, -0.010696891695261002, 0.024546999484300613, -0.032323986291885376, 0.004931316711008549, 0.003269869601354003, 0.010491861961781979, 0.020700925961136818, -0.0039344485849142075, -0.007967876270413399, -0.043947044759988785, -0.02562163770198822, -0.01423188578337431, -0.032550226897001266, -0.0056135705672204494, -0.01602059230208397, -0.016642751172184944, -0.05370362848043442, -0.006341779138892889, -0.013588516972959042, 0.0028067852836102247, 0.009601043537259102, -0.004454092588275671, 0.0010039382614195347, -0.024334900081157684, 0.0043515777215361595, 0.04547416418790817, -0.0034978766925632954, 0.013242087326943874, -0.0013203202979639173, 0.007607307285070419, 0.007508327253162861, 0.01815572939813137, -0.022058362141251564, -0.0013512514997273684, -0.00046440985170193017, -0.016359953209757805, 0.022312883287668228, 0.025126738473773003, 0.003038327442482114, -0.005974140018224716, 0.00019387232896406204, 0.013114827685058117, -0.009134424850344658, 0.0018311269814148545, 0.01638823188841343, -0.0029570225160568953, 0.004680332262068987, 0.005122206173837185, -0.01976768672466278, 0.00048341043293476105, -0.008328446187078953, 0.022920900955796242, -0.011757390573620796, 0.012577508576214314, 0.015681233257055283, -0.02283606119453907, -0.02788403257727623, -0.003849608590826392, 0.03475606068968773, -0.004620237275958061, 0.0027944128960371017, 0.01310775801539421, 0.0043480428867042065, 0.025494378060102463, 0.06657100468873978, -0.015822634100914, 0.025522656738758087, -0.026441754773259163, -0.00669527892023325, -0.009049585089087486, -0.031871505081653595, -0.008766785264015198, 0.01624683290719986, -0.031362466514110565, 0.0006513226544484496, -0.006500854156911373, -0.014691435731947422, -0.020078767091035843, 0.017971910536289215, -0.023472361266613007, -0.006935658399015665, 0.0037506287917494774, -0.013920806348323822, 0.013348137959837914, -0.00592818483710289, 0.024023819714784622, -0.032097745686769485, -0.13868488371372223, -0.03840417414903641, 0.0064160143956542015, -0.0032681019511073828, 0.012881518341600895, -0.0020396916661411524, 0.05129983276128769, 0.026781115680933, -0.022864341735839844, -0.002972929971292615, 0.001389252720400691, -0.04247649013996124, 0.0373295359313488, 0.012464389204978943, 0.02480151876807213, -0.06804156303405762, 0.0019530842546373606, -0.012174519710242748, -0.0008656316786073148, -0.04414500668644905, -0.04448436573147774, -0.007013428024947643, 0.0018770818132907152, 0.01822642982006073, -0.06261181831359863, -0.0009650533902458847, 0.03973333165049553, -0.0006902075838297606, -0.009346524253487587, 0.001401625107973814, -0.005995349958539009, -0.006963938474655151, 0.0033900593407452106, 0.016939692199230194, -0.04295724630355835, -0.01982424594461918, 0.005546405911445618, -0.008356725797057152, -0.01083122193813324, 0.030316108837723732, 0.0104282321408391, -0.05599430575966835, 0.037725456058979034, 0.006886168383061886, 0.020955445244908333, -0.04126045107841492, 0.005839810241013765, -0.012139169499278069, -0.001763078267686069, 0.0008523754659108818, 0.02921319007873535, -0.05568322539329529, -0.01619027368724346, -0.02115340530872345, -0.013977366499602795, -0.012492668814957142, 0.018650628626346588, -0.01046358235180378, 0.008250676095485687, -0.029326310381293297, 0.0006968356901779771, 0.033483464270830154, 0.0050833215937018394, -0.02013532631099224, -0.023104721680283546, 0.001688843360170722, -0.001014543347992003, 0.02136550471186638, -0.011205931194126606, -0.04640740156173706, 0.005857485346496105, 0.025664057582616806, 0.013411767780780792, 0.025494378060102463, -0.018933428451418877, -0.006051909644156694, 0.031221067532896996, 0.019866665825247765, -0.04312692582607269, 0.04061001166701317, 0.023514781147241592, -0.04756687954068184, 0.03888493403792381, 0.023260261863470078, 0.02313300035893917, 0.05944446101784706, 0.0003095329157076776, -0.008427426218986511, -0.012153309769928455, 0.008137556724250317, 0.030118148773908615, -0.017307331785559654, 0.011750319972634315, -0.0292697511613369, -0.02099786512553692, -0.037216417491436005, -0.03659425675868988, 0.0035243891179561615, 0.012358339503407478, -0.012132099829614162, 0.021464483812451363, 0.0043515777215361595, -0.02422177977859974, 0.004097057972103357, 0.001245201681740582, 0.018537508323788643, 0.0005850415327586234, -0.006939193233847618, 0.02408037893474102, -0.015271174721419811, -0.024985337629914284, -0.0014917674707248807, -0.01675587147474289, 0.02371273934841156, -0.004888896830379963, 0.017802231013774872, 0.03167354688048363, 0.019866665825247765, 0.029552550986409187, 0.016303392127156258, -0.0016534934984520078, 0.03368142247200012, -0.030712028965353966, 0.019202087074518204, 0.006688208784908056, 0.0024090984370559454, 0.011842230334877968, 0.030429229140281677, -0.03636801987886429, -0.0072679477743804455, 0.0046767969615757465, -0.0026229654904454947, 0.009480854496359825, 0.008179976604878902, -0.01295928843319416, 0.021916963160037994, 0.02789817377924919, 0.00646196911111474, -0.023387521505355835, 0.016741732135415077, -0.006504388991743326, 0.015469133853912354, -0.0009182147332467139, 0.014592455700039864, -0.0027307828422635794, 0.032550226897001266, 0.026003416627645493, -0.04179776832461357, -0.023090580478310585, 0.008293095976114273, 0.026441754773259163, -0.00023021649394650012, -0.0014511150075122714, -0.025791317224502563, 0.02064436487853527, 0.012973427772521973, 0.015497414395213127, -0.02825167216360569, -0.008066856302320957, 0.007642657030373812, 0.012641138397157192, 0.025381257757544518, -0.006907378323376179, -0.04383392632007599, 0.04097764939069748, -0.026682134717702866, -0.002193463733419776, 0.013991506770253181, 0.011686690151691437, -0.0022217438090592623, -0.027106335386633873, -0.041090771555900574, 0.04208057001233101, 0.013001708313822746, 0.025777176022529602, 0.005960000213235617, -0.0033847568556666374, 0.01938590779900551, -0.0020237842109054327, 0.04603976383805275, 0.026809394359588623, 0.01954144798219204, -0.001266411622054875, -0.038828376680612564, 0.05248759314417839, -0.026880094781517982, 0.03051406890153885, -0.001854104339145124, 0.017986049875617027, 0.051780592650175095, 0.025720616802573204, 0.009141494520008564, -0.004330367781221867, 0.04261788725852966, -0.0007021381752565503, -0.004987876396626234, 0.03167354688048363, 0.03320066258311272, -0.007727497257292271, -0.033342063426971436, -0.025084318593144417, 0.022298742085695267, -0.004114733077585697, -0.010088873095810413, -0.04239165037870407, 0.030400948598980904, 0.0004270714707672596, -0.022298742085695267, -0.0031284696888178587, 0.02187454327940941, 0.028506191447377205, 0.012188659980893135, -0.026880094781517982, 0.03715985640883446, -0.0008134905365295708, -0.05579634755849838, -0.00503383157774806, 0.004093523137271404, -0.015440854243934155, -0.03486918285489082, -0.012280569411814213, -0.015935752540826797, 0.02972223050892353, -0.0068437485024333, -0.012301779352128506, -0.028803132474422455, 0.048924319446086884, -0.004447022452950478, 0.01189171988517046, 0.013348137959837914, -0.02826581336557865, 0.033992502838373184, -0.010265623219311237, 0.016529632732272148, -0.011121091432869434, -0.003722348716109991, -0.00830016564577818, 0.002930510090664029, 0.009099074639379978, -0.005196441430598497, 0.04456920549273491, 0.011304911226034164, 0.02129480428993702, 0.005436820909380913, 0.0074517675675451756, 0.003020652336999774, 0.03755577653646469, 0.04691644012928009, -0.0366225391626358, -0.014154116623103619, -0.0180143304169178, 0.024914639070630074, -0.01511563453823328, -0.005726690404117107, 0.0025451956316828728, -0.0018841518322005868, 0.010484792292118073, 0.04151497036218643, 0.04018581286072731, 0.008406216278672218, -0.030259549617767334, 0.019739406183362007, -0.00342187425121665, -0.007515397388488054, -0.0008727016393095255, 0.003372384235262871, 0.009099074639379978, 0.01204726006835699, 0.060405977070331573, 0.01932934671640396, -0.015836773440241814, 0.019159667193889618, -0.006345314439386129, 0.027714353054761887, 0.014274305664002895, -0.0011674318229779601, 0.025649916380643845, -0.004439952317625284, 0.045389324426651, -0.006051909644156694, -0.0043480428867042065, -0.009381874464452267, -0.0180143304169178, 0.001345065189525485, 0.018933428451418877, -0.014550035819411278, -0.00503383157774806, 0.012817888520658016, -0.0023101186379790306, 0.0366225391626358, 0.03789513558149338, 0.04612460359930992, -0.010810011997818947, -0.008250676095485687, 0.0033334994222968817, -0.012485599145293236, -0.011333190836012363, 0.011573570780456066, -0.003743558656424284, -0.013729916885495186, 0.024250058457255363, 0.0031850296072661877, -0.013645077124238014, -0.01689727231860161, 0.01474799495190382, 5.672560655511916e-05, 0.01705281063914299, -0.008144626393914223, -0.021478623151779175, -0.004238457884639502, 0.005390865728259087, -0.038602136075496674, 0.00827188603579998, 0.03266334533691406, 0.009304104372859001, 0.005652455613017082, -0.001999039202928543, -0.013220877386629581, -0.006599833723157644, 0.00543328607454896, 0.019923226907849312, -0.025706477463245392, -0.0004241993010509759, -0.0012142704799771309, -0.02583373710513115, -0.014606595039367676, 0.0007370462408289313, 0.011785670183598995, -0.012817888520658016, 0.014465196058154106, 0.009396013803780079, 0.012379549443721771, 0.021252384409308434, -0.028661731630563736, -0.042646169662475586, -0.0033405693247914314, -0.018792027607560158, -0.010774661786854267, -0.026088256388902664, -0.031079668551683426, 0.023514781147241592, 0.00921926461160183, 0.014479335397481918, -0.02253912203013897, -0.004977271426469088, 0.023189561441540718, -0.014033926650881767, 0.01954144798219204, -0.006083725020289421, -0.0032009370625019073, 0.07788299024105072, -0.016996251419186592, -0.00253282324410975, 0.023896560072898865, -0.012789608910679817, 0.022298742085695267, 0.008024436421692371, -0.016925550997257233, -0.02306230179965496, 0.029156630858778954, -0.01299463864415884, 0.011764460243284702, -0.013560237362980843, -0.012125029228627682, 0.032521944493055344, -0.005012621637433767, -0.0007092081941664219, 0.016642751172184944, 0.027770914137363434, 0.005998884793370962, 0.010718101635575294, -0.010209063068032265, -0.0028279952239245176, 0.007791127078235149, 0.00721138808876276, -0.00090098159853369, -0.032550226897001266, 0.0006592763820663095, 0.009289964102208614, 0.01997978612780571, -0.00914856418967247, -0.04236336797475815, -0.04898087680339813, -0.000125160877360031, 0.012457319535315037, -0.004796986933797598, -0.014111696742475033, 0.029976749792695045, -0.005825670436024666, -0.01350367721170187, -0.008879904635250568, -0.014465196058154106, 0.012676488608121872, 0.002981767524033785, 0.0048570819199085236, 0.011990699917078018, 0.017406310886144638, 0.016048872843384743, -0.00521411607041955, -0.0016349348006770015, 0.024278338998556137, 0.008144626393914223, 0.024165218695998192, -0.015992313623428345, -0.0025416607968509197, 0.0008943534921854734, -0.009353593923151493, 0.018198149278759956, 0.005139881279319525, 0.011941210366785526, -0.04075141251087189, -0.006016559898853302, -0.04035549238324165, 0.028788991272449493, 0.0016040035989135504, -0.017547709867358208, -0.010407022200524807, 0.009827283211052418, -0.011729110032320023, 0.0528552308678627, -0.04151497036218643, 0.02181798405945301, -0.03045750968158245, 0.0031585171818733215, -0.007366927806288004, -0.008554685860872269, -0.032012905925512314, 0.03506714105606079, -0.007614377420395613, 0.02977878972887993, -0.014125836081802845, 0.01196242030709982, -0.012563369236886501, -0.000328754453221336, -0.008978884667158127, 0.0005779715138487518, 0.013044128194451332, 0.008080996572971344, -0.05582462623715401, 0.056163985282182693, -0.007784056942909956, 0.0093323839828372, 0.03215430676937103, 0.017802231013774872, -0.026116536930203438, -0.01247852947562933, -0.00029583481955341995, 0.013843037188053131, -0.005868090316653252, 0.01594989374279976, -0.0048570819199085236, -0.005567615851759911, 0.020305005833506584, 0.033568304032087326, -0.00646196911111474, -0.01186344027519226, -0.02833651192486286, -0.01028683315962553, 0.004227852914482355, 0.011241281405091286, 0.007444697432219982, 0.0009650533902458847, 0.0007732799276709557, 0.022129062563180923, -0.01138268131762743, 0.04620944336056709, 0.02160588465631008, 0.05729518458247185, 0.02174728363752365, -0.0019513167208060622, -0.00827188603579998, -0.0008894928614608943, 0.028576891869306564, 0.005405005998909473, 0.000653090130072087, 0.028492052108049393, -0.02094130404293537, 0.0048570819199085236, -0.01003231294453144, -0.004295017570257187, -0.005903440061956644, 0.021464483812451363, 0.009933332912623882, -0.022157343104481697, 0.00611200463026762, 0.01962628774344921, -0.009127354249358177, -0.02019188553094864, -0.02150690369307995, 0.00028279953403398395, 0.001423718873411417, 0.006822538562119007, -0.008978884667158127, 0.0035420639906078577, -0.022426001727581024, -0.028958670794963837, 0.03141902759671211, -0.035604462027549744, 0.0251832976937294, 0.005896369926631451, 0.007183108013123274, 0.0043763224966824055, 0.009841423481702805, 0.012096749618649483, -0.006776583846658468, -0.004913641605526209, 0.002785575343295932, -0.04287240654230118, 0.0022411863319575787, 0.009749514050781727, 0.03156042844057083, -0.014260166324675083, 0.015228754840791225, 0.015384294092655182, 0.02371273934841156, -0.02187454327940941, -0.023599620908498764, -0.03133418783545494, 0.0009738908847793937, -0.018707187846302986, 0.007925456389784813, -0.006642254069447517, 0.005334306042641401, -0.008363796398043633, 0.010993831790983677, -0.02143620327115059, -0.005129276309162378, 0.0002498799003660679, -0.014719715341925621, -0.011608920060098171, 0.009134424850344658, 0.006104934960603714, 0.02977878972887993, 0.011672550812363625, -0.0020273190457373857, 0.021775564178824425, 0.03133418783545494, 0.025367116555571556, 0.01076052151620388, 0.021337224170565605, -0.0024356108624488115, -0.036707378923892975, 0.0329461432993412, 0.017363891005516052, 0.015271174721419811, 0.018466809764504433, -0.005132811609655619, -0.023599620908498764, 0.009834353812038898, 0.008349656127393246, -0.0024214708246290684, -0.002990605076774955, 0.0035544366110116243, 0.015044935047626495, -0.022666381672024727, -0.004977271426469088, 0.01982424594461918, -0.0029287426732480526, 0.018127448856830597, 0.01778808981180191, -0.001667633419856429, -0.012209869921207428, 0.01808502897620201, 0.018495088443160057, 0.0008002342656254768, 0.011785670183598995, 0.013991506770253181, 0.012563369236886501, -0.02604583650827408, -0.006405409425497055, -0.013744057156145573, -0.003800118574872613, 0.03390766307711601, -0.0057054804638028145, 0.013694566674530506, 0.006546808872371912, 0.007847687229514122, 0.02460355870425701, 0.005037366412580013, 0.02137964405119419, -0.008802135474979877, -0.023189561441540718, -0.00235960865393281, 0.0004458511248230934, 0.001553629874251783, -0.012711838819086552, -0.010138362646102905, -0.016359953209757805, -0.006044839974492788, 0.01603473350405693, -0.044625766575336456, 0.012867378070950508, -0.0036109965294599533, -0.017448730766773224, -0.0229916013777256, 0.05443890765309334, 0.009622253477573395, 0.00759316748008132, -0.01116351131349802, 0.016303392127156258, 0.017660830169916153, -0.0015580486506223679, -0.01947074756026268, -0.027205314487218857, 0.018282989040017128, -0.021040285006165504, -0.014316725544631481, -0.030796868726611137, -0.018466809764504433, 0.02949598990380764, -0.021690724417567253, -0.0077062868513166904, -0.0024391459301114082, -0.0031655870843678713, -0.009897983632981777, 0.01043530274182558, -0.03834761679172516, 0.009473783895373344, -0.02700735442340374, -0.03812137618660927, -0.011184721253812313, 0.017024531960487366, -0.0007613493362441659, -0.0017268445808440447, 0.026512455195188522, 0.03096654824912548, 0.0254802368581295, -0.000236181789659895, 0.012231079861521721, -0.031136227771639824, 0.03153214603662491, -0.021422063931822777, -0.012330058962106705, 0.007381067611277103, 0.015242894180119038, 0.020474685356020927, -0.033257223665714264, -0.026102395728230476, -0.009410154074430466, 0.01757599040865898, -0.037357818335294724, -0.010350462980568409, 0.018339550122618675, -0.013913736678659916, -0.02430661953985691, 0.007819406688213348, 0.026257935911417007, -0.016798291355371475, -0.012471458874642849, 0.022963320836424828, 0.0038602135609835386, -0.018396109342575073, 0.00250807823613286, 0.005369655787944794, 0.03133418783545494, 0.02584787644445896, -0.007423487491905689, 0.01404806599020958, -0.013270367868244648, 0.016656892374157906, 0.01365214679390192, 0.015638813376426697, 0.004641447216272354, 0.024433879181742668, 0.01500251516699791, 0.03871525451540947, 0.0036940688733011484, 0.0030895848758518696, -0.03192806616425514, 0.006090794689953327, -0.009933332912623882, 0.0016137247439473867, 0.01822642982006073, -0.0021740214433521032, -0.0031532146967947483, 0.002315421123057604, -0.0019919690676033497, 0.031814947724342346, 0.004489442333579063, -0.030316108837723732, 0.026950795203447342, 0.002594685647636652, 0.010852431878447533, 0.025140877813100815, -0.0018054982647299767, 0.006978078279644251, -0.01624683290719986, -0.008710225112736225, 0.032606784254312515, -0.023811720311641693, -0.000774605548940599, 0.004245528019964695, 0.02005048654973507, 0.02041812613606453, -0.008844555355608463, 0.00740934768691659, 0.010923131369054317, -0.0017577757826074958, -0.01894756779074669, 0.007458837702870369, 0.021719003096222878, 0.04603976383805275, -0.034727782011032104, -0.009339454583823681, 0.0054969158954918385, 0.017802231013774872, -0.01532773394137621, -0.014288445934653282, -0.0053873308934271336, -0.002451518317684531, -0.024900497868657112, -0.022341161966323853, -0.0014095788355916739, 0.023034021258354187, -0.011446311138570309, 0.0041465479880571365, -0.010880711488425732, -0.024108659476041794, 0.013086548075079918, -0.0045601422898471355, 0.023444080725312233, 0.04985755681991577, 0.02224218286573887, 0.009593973867595196, -0.01631753332912922, -0.020305005833506584, 0.004415207542479038, -0.031503867357969284, 0.028378931805491447, -0.0025451956316828728, -0.002960557583719492, -0.013857176527380943, -0.010081803426146507, -0.017986049875617027, 0.010088873095810413, -0.001963689224794507, 0.00977072399109602, 0.039196014404296875, -0.020248446613550186]",Model Alignment as Prospect Theoretic Optimization.pdf
" |x
For more stable training, we do not backpropagate through
6An earlier draft separated out λD, λUinto a function w. For an
easier comparison with (4), they—along with β—have been moved
into the value function itself. Note that λyexists solely to make
the loss non-negative and can be removed without consequence.
5
Model Alignment as Prospect Theoretic Optimization
Figure 3. KTO is as good or better than DPO at all scales, as measured by the GPT-4-0613 -judged winrate of the aligned model’s
generations against the outputs that would have been used for SFT. In fact, for the Llama models, KTO alone matches the performance of
SFT+DPO and is significantly better than DPO alone. Error bars denote a 90% binomial confidence interval.
z0; it exists purely to control the loss saturation.
Intuitively, KTO works as follows: if the model increases
the reward of a desirable example in a blunt manner, then the
KL penalty also rises and no progress is made. This forces
the model to learn exactly what makes an output desirable,
so that the reward can be increased while keeping the KL
term flat (or even decreasing it). The argument works in the
other direction as well, though the non-negativity of the KL
term allows faster saturation in the loss regime.
KL Estimate In practice, estimating z0as it is defined
above is impractical because sampling from πθis slow and
humans do not perceive the full distribution induced by πθ.
Taking the expected reward w.r.t. a human’s actual belief
would give you a biased estimate of the KL term, since
they have an “availability heuristic” that would overweight
outputs for which they have already given feedback, regard-
less of whether those outputs are a good continuation of
x(Tversky & Kahneman, 1973). To better simulate the
human-perceived reference point, we create mpairs (xi, yj)
where yjis in the same m-sized batch of offline data as xi
buti̸=j, and estimate z0as:
ˆz0= max
0,1
mX
i̸=jlogπθ(yj|xi)
πref(yj|xi)

This estimate is a biased one, but this is desirable because it
gets us closer to how humans would construct their subjec-
tive reference point.
Data If the alignment data is naturally binary, every posi-
tive example can be assumed to be drawn from ydesirable|x
and every negative example from yundesirable |x. However,
the canonical feedback datasets in academic research (HH,
SHP, OASST) are in preference format, since the methodsthat have worked best up until now are preference-based. In
our experiments, we converted preference data yw≻ylby
assuming that ywis drawn from the desirable distribution
andylfrom the undesirable one. This is a naive assump-
tion, made for the sake of simplicity, and a more complex
deconstruction of preferences into binary feedback would
likely yield better results, which we leave for future work.
To show that KTO can be used with non-preference data, we
also subsample exactly one yperxfor some experiments
(denoted one- y-per-x), removing any trace of preferences at
the cost of reducing the data volume.
If human feedback is in the form of scores or ratings, the
simplest means of incorporating it into KTO is to con-
struct a weighting function such that high-magnitude data is
weighed more and that examples with scores above(below)
some threshold are desirable(undesirable). It is also possible
to construct score-based HALOs from first principles, but
we leave the design of such losses to future work.
Hyperparameters The default weighting function wcon-
trols the degree of loss aversion with two hyperparameters
λD, λUthat are both set to 1. In a class-imbalanced setting,
where nDandnUrefer to the number of desirable and un-
desirable examples respectively, we find that it is generally
best to set λD, λUsuch that
λDnD
λUnU∈
1,4
3
(8)
where one of the two should be set to 1 and the ratio is
controlled by changing the other. For example, if there were
a 1:10 ratio of desirable:undesirable examples, we would set
λU= 1, λD∈[10,10.33].","[-0.019448813050985336, 0.028415286913514137, 0.04970887675881386, 0.010267828591167927, 0.03249095752835274, -0.005991950165480375, -0.011276020668447018, 0.03884042426943779, -0.02067866362631321, 0.054027657955884933, 0.007422009948641062, -0.022022919729351997, -0.02289525605738163, -0.0239678006619215, 0.04235836863517761, -0.014400701969861984, 0.031261105090379715, -0.029573636129498482, -0.019548917189240456, 0.03578009456396103, -0.020235344767570496, -0.019348708912730217, 0.019820628687739372, 0.041014112532138824, 0.006714130286127329, 0.009266787208616734, 0.042930394411087036, 0.005802467465400696, 0.01999223604798317, -0.03297717869281769, 0.07035893946886063, -0.04278738796710968, -0.04167193919420242, -0.026727816089987755, 0.01417189184576273, 0.037524767220020294, 0.022280331701040268, 0.061034951359033585, -0.012942040339112282, -0.015973767265677452, -0.02276655100286007, -0.04653414338827133, -0.008280046284198761, 0.020263945683836937, -0.022966759279370308, 0.017360925674438477, 0.016202576458454132, 0.012391467578709126, -0.00755071546882391, -0.0019645446445792913, -0.01960611902177334, 0.055915337055921555, -0.02612719126045704, 0.02508324757218361, 0.008809167891740799, -0.0008097713580355048, 0.0020128090400248766, 0.011912398040294647, 0.04418884590268135, 0.0018483522580936551, -0.029101716354489326, -0.01367852184921503, 0.038497209548950195, 0.010375083424150944, -0.022652145475149155, -0.005648735910654068, -0.07996894419193268, 0.023767592385411263, -0.002699237782508135, 0.04424604773521423, 0.021922815591096878, 0.004522563889622688, 0.026370301842689514, -0.010560991242527962, 0.0064424192532896996, -0.0105180898681283, 0.024797236546874046, 0.05296941474080086, 0.015573350712656975, -0.03769637644290924, 0.02536926046013832, 0.018705181777477264, 0.03157572075724602, -0.02862979657948017, 0.0016374184051528573, -0.055715128779411316, -0.02648470737040043, -0.03200473636388779, -0.03955545276403427, -0.013492614030838013, -0.03821119666099548, -0.0039398143999278545, -0.005784591659903526, -0.011247419752180576, 0.040842507034540176, -0.013034994713962078, 0.018547875806689262, -0.00031684761052019894, 0.05274060368537903, -0.021179184317588806, -0.03369220718741417, -0.01670309714972973, 0.020335448905825615, -0.01637418381869793, 0.03803958743810654, -0.01208400446921587, -0.013120798394083977, 0.021222086623311043, 0.016088172793388367, -0.027843263000249863, -0.06498191505670547, 0.01999223604798317, -0.048679232597351074, 0.014944124035537243, 0.007132423110306263, -0.08997935801744461, -0.06275102496147156, 0.019749125465750694, 0.004100696183741093, -0.018176060169935226, -0.020721565932035446, -0.021107681095600128, 0.024110807105898857, 0.011011459864675999, -0.020950375124812126, -0.029402028769254684, 0.028358085080981255, -0.023209869861602783, 0.0016168613219633698, -0.010618194006383419, 0.01201965194195509, 0.027185436338186264, -0.011261720210313797, -0.048965245485305786, -0.06503912061452866, 0.028915807604789734, -0.023867696523666382, 0.05256899446249008, 0.0035018587950617075, 0.005655886139720678, 0.004050644114613533, -0.052683401852846146, -0.04458926245570183, 0.012098305858671665, -0.08179941773414612, 0.0043831332586705685, -0.012212710455060005, 0.03300577774643898, -0.0544566735625267, 0.054771289229393005, 0.023653188720345497, -0.03643792122602463, -0.021436596289277077, -0.010274979285895824, 0.012462970800697803, -0.016645895317196846, -0.01683180406689644, 0.04107131436467171, 0.02172260731458664, -0.05271200090646744, 0.020978976041078568, 0.03180452808737755, 0.023696089163422585, 0.0234815813601017, 0.020521357655525208, 0.00040712012560106814, -0.004118571989238262, 0.03323458880186081, -0.06343744695186615, -0.03623771294951439, 0.025354959070682526, -0.0021540275774896145, -0.04387423396110535, -0.014729615300893784, -0.024997444823384285, 0.008337248116731644, -0.03921223804354668, -0.02857259288430214, -0.02729984000325203, -0.05234018713235855, -0.0074506113305687904, 0.01686040498316288, -0.01307789608836174, 0.010789800435304642, -0.04873643442988396, -0.014229094609618187, 0.004157898481935263, -0.04121432080864906, -0.004726347513496876, 0.024868739768862724, 0.0401274748146534, 0.0036752535961568356, 0.05462828278541565, -0.01534454058855772, -0.015759257599711418, -0.004075670149177313, 0.05725959315896034, 0.07688001543283463, -0.025626670569181442, 0.019877830520272255, 0.011497680097818375, 0.034321434795856476, 0.044303249567747116, -0.0828290581703186, 0.011569183319807053, -0.011340374127030373, 0.009860262274742126, -0.002625947119668126, -0.051281943917274475, 0.007128847762942314, 0.007843878120183945, 0.013413960114121437, 0.03738176077604294, 0.0215223990380764, -0.005419926252216101, 0.02368178963661194, -0.054056257009506226, 0.021837012842297554, 0.013556966558098793, 0.08763406425714493, -0.012405768036842346, 0.05817482993006706, 0.013699972070753574, 0.011683587916195393, -0.038010988384485245, -0.01891968958079815, 0.024539824575185776, -0.04201515391469002, 0.02172260731458664, -0.04679155349731445, 0.02895870991051197, 0.0004902423825114965, 0.0034285681322216988, -0.018176060169935226, 0.014386400580406189, -0.06789923459291458, -0.009416943415999413, -0.021407993510365486, -0.019320107996463776, -0.03758196905255318, -0.010403684340417385, 0.007722322829067707, 0.007858178578317165, -0.027242638170719147, -0.024382518604397774, 0.03186172991991043, -0.036123309284448624, -0.0030531776137650013, -0.04227256774902344, -0.029802445322275162, 0.027013828977942467, -0.00952419824898243, -0.03303438052535057, -0.024825837463140488, -0.038010988384485245, 0.0038003837689757347, 0.01513003185391426, -0.016388485208153725, -0.00971725583076477, 0.013049295172095299, 0.013228052295744419, -0.02895870991051197, -0.0283723846077919, 0.0002574107493273914, 0.0007346931961365044, 0.007371957879513502, -0.027371343225240707, -0.031489916145801544, 0.017818544059991837, -0.00543780205771327, 0.019262904301285744, 0.02230893261730671, -0.007808126043528318, 0.008923572488129139, -0.04232976958155632, -0.05302661657333374, 0.028000568971037865, 0.03975566104054451, -0.030345868319272995, -0.07047334313392639, -0.04667714983224869, 0.031261105090379715, 0.06841405481100082, 0.0018465647008270025, 0.028229380026459694, -0.004372407682240009, -0.033377595245838165, 0.022609245032072067, -0.02332427352666855, -0.0023077588994055986, 0.03154711797833443, -0.032691165804862976, 0.044303249567747116, -0.0037968086544424295, 0.001937730936333537, 0.045962121337652206, -0.012548774480819702, -0.03211914002895355, -0.008337248116731644, -0.01389303058385849, 0.04187214747071266, -0.005069561768323183, -0.006170707754790783, 0.0037932335399091244, 0.025540867820382118, -0.01731802336871624, 0.03949825093150139, 0.026470405980944633, 0.004790700040757656, -0.000714136112947017, -0.0011932060588151217, 0.022223128005862236, -0.020364051684737206, 0.05943328142166138, -0.018705181777477264, -0.024110807105898857, 0.05971929430961609, -0.01624547876417637, 0.00037583758239634335, -0.022752249613404274, -0.043359410017728806, -0.07653679698705673, -0.022523440420627594, -0.0005344848032109439, 0.047735393047332764, -0.0039398143999278545, -0.028815703466534615, -0.016331281512975693, -0.021250687539577484, -0.03560848906636238, -0.004479662049561739, -0.02373899146914482, 0.0023738991003483534, -0.022680748254060745, -0.02635600045323372, 0.0024382518604397774, -0.022594943642616272, 0.06789923459291458, 0.008165640756487846, 0.019935032352805138, -0.08734805136919022, -0.029130317270755768, -0.009138082154095173, -0.004522563889622688, -0.00018490225193090737, 0.005133914295583963, 0.05397045612335205, -0.005823918152600527, 0.03026006370782852, 0.04190075024962425, -0.034807655960321426, -0.011175916530191898, 0.009123780764639378, 0.02752864919602871, 0.019262904301285744, 0.0022201677784323692, -0.018905390053987503, -0.007457761559635401, -0.0156591534614563, 0.0039183637127280235, -0.00021361517428886145, 0.02037835121154785, 0.031918931752443314, 0.010603892616927624, 0.02328137308359146, 0.022552041336894035, -0.003426780691370368, 0.00760791776701808, 0.00383613514713943, -0.009331139735877514, -0.025655271485447884, 0.013914481736719608, -0.04378842934966087, 0.0047048963606357574, -0.03763917088508606, 0.013635619543492794, 0.03952684998512268, 0.013492614030838013, 0.0252691563218832, 0.014507955871522427, 0.00998181663453579, 0.006313713733106852, -0.00755071546882391, -0.011497680097818375, 0.01390733104199171, -0.0071932002902030945, 0.011604934930801392, -0.01413614023476839, -0.04235836863517761, -0.017689839005470276, 0.013406810350716114, 0.025598069652915, -0.04610512778162956, 0.016216877847909927, 0.022065822035074234, 0.002917321864515543, -0.014250545762479305, 0.047077566385269165, 0.03512226790189743, 0.057574205100536346, -0.048679232597351074, -0.007958282716572285, -0.07750923931598663, -0.02286665514111519, -0.03623771294951439, -0.03180452808737755, 0.018576476722955704, 0.040585096925497055, 0.026599111035466194, 0.048679232597351074, 0.0404420904815197, -0.015301639214158058, 0.03878321871161461, -0.007722322829067707, 0.020750166848301888, -0.005048111081123352, 0.024925941601395607, 0.02328137308359146, 0.017961550503969193, 0.028358085080981255, -0.037496168166399, 0.008930723182857037, -0.013070746324956417, -0.03354920074343681, -0.03852580860257149, 0.02165110409259796, -0.017561133950948715, -0.017990151420235634, 0.028057772666215897, -0.06069173663854599, 0.003989866469055414, 0.05385604873299599, 0.013614168390631676, -0.031232504174113274, -0.07688001543283463, -0.01683180406689644, 0.011204518377780914, -0.01846207119524479, 0.023867696523666382, -0.010196326300501823, 0.012227010913193226, -0.009052278473973274, -0.028787102550268173, -0.016216877847909927, -0.02465423010289669, 0.014415002427995205, -0.0023417228367179632, 0.005741689819842577, 0.023638887330889702, -0.031918931752443314, -0.0033105884213000536, 0.04747798293828964, 0.04539009556174278, -0.02531205676496029, 0.008580358698964119, -0.03861161321401596, 0.0329485759139061, 0.009231035597622395, 0.03309158235788345, -0.02491164021193981, -0.012334265746176243, -0.027471447363495827, -0.004454636014997959, -0.017503932118415833, -0.021279288455843925, 0.022366134449839592, 0.01104006078094244, -0.013292405754327774, -0.010203476063907146, 0.008172791451215744, 0.019062696024775505, -0.027728859335184097, 0.032862771302461624, -0.05863244831562042, -0.047620989382267, 0.014915523119270802, 0.053369831293821335, 0.01960611902177334, 0.04424604773521423, -0.008730514906346798, 0.022552041336894035, -0.06212179362773895, -0.03632351756095886, 0.004315205384045839, 0.059833697974681854, 0.05133914574980736, 0.05045250803232193, 0.005280495621263981, -0.01093995664268732, -0.024153709411621094, -0.004833601880818605, -0.049651674926280975, 0.06675519049167633, -0.016803201287984848, -0.022737950086593628, -0.008616110309958458, 0.011776542291045189, 0.006181433331221342, 0.011032911017537117, -0.013964533805847168, 0.041700541973114014, -0.05191116780042648, -0.0016964083770290017, 0.02047845534980297, 0.03741036355495453, -0.008666162379086018, 0.017160717397928238, -0.03506506606936455, -0.039383843541145325, 0.04344521462917328, -0.034807655960321426, -0.006127805914729834, -0.009974666871130466, 0.030774885788559914, -0.020206743851304054, 0.021479496732354164, -0.03680973872542381, 0.004365257453173399, -0.03537967801094055, 0.05766000971198082, -0.042615778744220734, -0.0005943685537204146, -0.0547998882830143, 0.012956341728568077, 0.0397842638194561, 0.0016606568824499846, -0.035665690898895264, -0.10061900317668915, -0.04673435166478157, -0.004783549811691046, 0.027385644614696503, -0.009988967329263687, 0.015258737839758396, 0.02699952758848667, -0.03186172991991043, -0.02409650757908821, 0.003982716239988804, -0.030059855431318283, -0.003601962933316827, -0.0035465480759739876, 0.010882754810154438, 0.007239677477627993, 0.03377801179885864, -0.012227010913193226, 0.010468036867678165, -0.033120185136795044, 0.04787839949131012, -0.004969457630068064, -0.017032012343406677, -0.027800360694527626, 0.004250852391123772, -0.015358841978013515, -0.04072810336947441, -0.02752864919602871, -0.047620989382267, 0.014050336554646492, -0.011797992512583733, 0.02462562918663025, 0.011654986999928951, 0.009138082154095173, -0.00213972688652575, 0.006960815750062466, 0.010017568245530128, 0.02328137308359146, -0.019062696024775505, 0.006574699655175209, -0.004172199405729771, -0.002981674624606967, 0.025941284373402596, 0.020206743851304054, -0.03875461965799332, -0.017046311870217323, 0.016102472320199013, -0.025540867820382118, 0.003054965054616332, -0.009631452150642872, 0.030574677512049675, -0.015959465876221657, 0.009610001929104328, -0.006885737646371126, -0.046133726835250854, 0.009953215718269348, -0.023824796080589294, -0.01647428795695305, -0.05259759724140167, 0.00034611913724802434, 0.009845960885286331, 0.010403684340417385, -0.06074893847107887, 0.02149379812180996, 0.07453471422195435, -0.030517475679516792, 0.023009661585092545, 0.008766266517341137, -0.02948783151805401, -0.01082555204629898, -0.014322048053145409, -0.02422521263360977, 0.040785305202007294, -0.04933706298470497, 0.028358085080981255, -0.004969457630068064, 0.010325031355023384, -0.057803016155958176, -0.028815703466534615, 0.031461313366889954, 0.009030827321112156, 0.0053519983775913715, 0.01780424453318119, 0.004872928373515606, 0.006042002234607935, -0.012563074938952923, -0.008401600643992424, 0.008487404324114323, -0.03254815936088562, -0.02518335171043873, 0.0057381149381399155, 0.012677479535341263, 0.05082432180643082, -0.008894971571862698, -0.00045024536666460335, 0.0032587486784905195, -0.00743631087243557, -0.0005666611832566559, -0.009388342499732971, 0.0039183637127280235, -0.0020771618001163006, -0.018733782693743706, 0.0022952458821237087, -0.016488589346408844, -0.07361947745084763, -0.011326072737574577, 0.022723648697137833, 0.011054362170398235, 0.014307747595012188, 0.003900487907230854, 0.009938915260136127, -0.012312814593315125, 0.009002226404845715, -0.031089499592781067, 0.02243763767182827, 0.034292832016944885, 0.02223742939531803, -0.017303721979260445, 0.003605538047850132, 0.0017098152311518788, -0.009938915260136127, 0.04212956130504608, -0.012698930688202381, -0.028086373582482338, -0.02465423010289669, -0.022952459752559662, 0.014929823577404022, 0.0009626089595258236, 0.03761057183146477, 0.013113647699356079, -0.04107131436467171, 0.005709513556212187, -0.005491429474204779, 0.0011646049097180367, -0.0371815524995327, -0.011619235388934612, -0.018347665667533875, -0.004858627915382385, 0.026456104591488838, 0.027600152418017387, -0.016688797622919083, 0.043817032128572464, 0.011361824348568916, 0.006703405175358057, -0.007943982258439064, 0.039412446320056915, 0.01048233825713396, -0.03277697041630745, -0.008680462837219238, -0.0065568238496780396, -0.0033195260912179947, -0.023624587804079056, -0.05457108095288277, 0.015273038297891617, -0.02870129980146885, -0.016388485208153725, -0.03981286287307739, -0.03237655386328697, -0.011597784236073494, -0.01751823164522648, 0.054542478173971176, 0.009559948928654194, 0.011175916530191898, -0.005827493499964476, -0.010346482507884502, -0.00978160835802555, 0.00044667022302746773, -0.029688039794564247, 0.005952623672783375, 0.008959324099123478, -0.02729984000325203, 0.03071768395602703, -0.023238470777869225, -0.05574372783303261, -0.014550858177244663, 0.007125272881239653, -0.05082432180643082, 0.014479354955255985, -0.026241596788167953, -0.009567099623382092, -0.0011565608438104391, 0.04936566203832626, 0.042901791632175446, -0.0033159509766846895, -0.017403827980160713, 0.018376268446445465, -0.011619235388934612, 0.009238186292350292, -0.014143290929496288, -0.013449711725115776, 0.014207643456757069, 0.00883776880800724, -0.008930723182857037, -0.04513268545269966, -0.028615495190024376, -0.0211934857070446, -0.035923101007938385, 0.015015627257525921, -0.011311772279441357, -0.02100757695734501, -0.04307340085506439, -0.012298514135181904, 0.0024382518604397774, -0.0022845205385237932, 0.0005796211189590394, 0.013707122765481472, -0.007329056039452553, -0.004930131137371063, -0.013535515405237675, 0.03186172991991043, -0.011376124806702137, 0.021779809147119522, -0.00024020535056479275, 0.00026590173365548253, 0.005577233154326677, 0.02729984000325203, -0.00882346834987402, 0.034292832016944885, 0.01172649022191763, 0.0030835664365440607, 0.021965717896819115, 0.0194059107452631, -0.01498702634125948, 0.01963471993803978, -0.010739748366177082, 0.014479354955255985, -0.01162638608366251, 0.018805285915732384, 0.019620420411229134, -0.02618439309298992, 0.010182025842368603, -0.006735581438988447, -0.017332324758172035, 0.025683872401714325, -0.018533574417233467, 0.027500048279762268, -0.020106639713048935, 0.01950601488351822, 0.01846207119524479, -0.023638887330889702, -0.04433185234665871, -0.0007628474850207567, 0.03583729639649391, -0.022680748254060745, -0.005194691941142082, -0.0012280638329684734, 0.005044535733759403, 0.036580927670001984, 0.06166417524218559, -0.04458926245570183, 0.022351833060383797, -0.03712435066699982, 0.008802018128335476, -0.009745856747031212, -0.02113628387451172, -0.0014273783890530467, 0.017146416008472443, -0.03758196905255318, 0.00644956948235631, -0.019191401079297066, 0.002347085624933243, -0.01578786037862301, 0.01087560411542654, -0.011426177807152271, -0.028915807604789734, 0.011483379639685154, -0.0022559191565960646, 0.00738625880330801, -0.023553084582090378, 0.00998181663453579, -0.05931887775659561, -0.1180657297372818, -0.05949048697948456, 0.02739994414150715, 0.019291505217552185, 0.007657969836145639, -0.006785633508116007, 0.04559030383825302, 0.011311772279441357, -0.031261105090379715, -0.012076854705810547, -0.0060384273529052734, -0.03466464951634407, 0.006549673620611429, -0.0053519983775913715, 0.020263945683836937, -0.0815134048461914, -0.010904205963015556, 0.004064945038408041, -0.010131972841918468, -0.020921774208545685, -0.036866940557956696, 7.882087083999068e-05, -0.0030853538773953915, 0.029630837962031364, -0.03251956030726433, -0.018805285915732384, 0.026913724839687347, -0.0026759991887956858, -0.0006341421394608915, 0.017789943143725395, 0.01064679492264986, -0.026198694482445717, 0.009974666871130466, 0.02905881404876709, -0.04396003484725952, -0.009760158136487007, -0.0029101716354489326, -0.0017124965088441968, -0.0007467592949979007, -0.001460448489524424, -0.006177857983857393, -0.025354959070682526, 0.02885860577225685, -0.035923101007938385, 0.022880956530570984, -0.05468548461794853, -0.005119613837450743, -0.01423624437302351, -0.006403092294931412, 0.010160574689507484, 0.02465423010289669, -0.01630268059670925, -0.021093381568789482, -0.020978976041078568, 0.009517047554254532, 0.007282579317688942, -8.038499800022691e-05, -0.02742854505777359, -0.020864572376012802, 0.0026152217760682106, -0.025612369179725647, 0.021479496732354164, 0.015430344268679619, -0.027542950585484505, -0.03929804265499115, -0.02862979657948017, 0.0064996215514838696, 0.027442846447229385, -0.0064638699404895306, -0.0551145039498806, 0.008044086396694183, 0.018090255558490753, 0.011283171363174915, 0.04295899346470833, 0.0035429729614406824, -0.010725447908043861, 0.01384297851473093, 0.022294631227850914, -0.03377801179885864, 0.05328402668237686, 0.019935032352805138, -0.02635600045323372, 0.0056094094179570675, 0.03440723568201065, 0.03274836763739586, 0.053141020238399506, -0.01428629644215107, -0.004933706019073725, -0.02732844091951847, 0.0022219552192837, 0.04187214747071266, -0.016316981986165047, 0.016331281512975693, -0.03214774280786514, -0.0022916707675904036, -0.03818259388208389, -0.013085046783089638, 0.02618439309298992, -0.0032104840502142906, 0.001270965556614101, 0.0010788013460114598, 0.007311180233955383, -0.03374940901994705, -0.009080879390239716, 0.01591656543314457, 0.0210361797362566, 0.020421253517270088, -0.020364051684737206, 0.021508097648620605, -0.00432235561311245, -0.011583483777940273, -0.01943451166152954, -0.022723648697137833, 0.03666673228144646, -0.013285255059599876, 0.007271853741258383, 0.04516128823161125, 0.027900464832782745, 0.03300577774643898, -0.01521583553403616, -0.006753457244485617, 0.02880140393972397, 0.003006700659170747, -0.015301639214158058, 0.008487404324114323, 0.009173832833766937, -0.01976342499256134, 0.01767553761601448, -0.009080879390239716, 0.023066863417625427, 0.03646652400493622, 0.0008213905384764075, 0.03844000771641731, -0.007736623287200928, -0.023166967555880547, 0.013228052295744419, 0.025383559986948967, 0.017160717397928238, -0.007543565239757299, 0.026985228061676025, -0.00540562579408288, 0.02325277216732502, 0.01511573139578104, 0.0022487689275294542, 0.008101288229227066, -0.0018715907353907824, 0.015387442894279957, -0.03958405554294586, 0.026041388511657715, 0.007279003970324993, 0.012598826549947262, -0.01568775624036789, -0.005173241253942251, 0.0021379392128437757, 0.017260821536183357, -0.004790700040757656, 0.0056308601051568985, -0.03263396397233009, 0.014844019897282124, 0.022809453308582306, 0.004293754231184721, -0.0073791081085801125, 0.003090716665610671, -0.0371815524995327, 0.030574677512049675, -0.028072072193026543, -0.02338147722184658, 0.02060716040432453, 0.02485443837940693, 0.011075812391936779, -0.022523440420627594, -0.045933518558740616, -0.0013987772399559617, 0.015444645658135414, 0.04653414338827133, 0.0011252783006057143, -0.02439681999385357, 0.012091155163943768, -0.007736623287200928, 0.034321434795856476, 0.03901202976703644, -0.0015668092528358102, -0.028486790135502815, -0.023982102051377296, 0.050795722752809525, -0.028887206688523293, 0.03517946973443031, -0.01660299301147461, -0.0012611339334398508, 0.043817032128572464, 0.026398902758955956, -0.009366891346871853, 0.0017116027884185314, 0.019491713494062424, -0.0172894224524498, -0.009238186292350292, 0.0011351099237799644, 0.03972705826163292, -0.005577233154326677, -0.022480539977550507, -0.03134690970182419, 0.030288664624094963, -0.016431385651230812, -0.0127203818410635, -0.027442846447229385, 0.026141492649912834, 0.010189175605773926, -0.019234303385019302, 0.01174079068005085, 0.007808126043528318, -0.001367494580335915, 0.019877830520272255, -0.010904205963015556, 0.02445402182638645, 0.0034857706632465124, -0.03700994700193405, 0.006757032126188278, -0.015144332312047482, -0.03274836763739586, -0.025040345266461372, -0.005248319357633591, -0.041528936475515366, 0.019391609355807304, -0.0012370017357170582, -0.001693726982921362, -0.031461313366889954, 0.0304888729006052, -0.0021182759664952755, 0.034292832016944885, 0.02142229489982128, -0.018776684999465942, 0.040813904255628586, -0.022938158363103867, 0.012248462066054344, 0.0006940258899703622, -8.965804590843618e-05, 0.0027046005707234144, 0.002860119566321373, -0.00859465915709734, -0.004644119180738926, 0.04301619529724121, 0.033863816410303116, 0.004283029120415449, -0.011304622516036034, 0.007572166156023741, 0.013020694255828857, 0.012992092408239841, 0.06074893847107887, -0.03249095752835274, 0.008108438923954964, -0.013313855975866318, 0.02047845534980297, 0.023896297439932823, 0.0032551735639572144, 0.006024126894772053, -0.013571267016232014, 0.023395776748657227, 0.05259759724140167, 0.0345788449048996, 0.036123309284448624, -0.013985984027385712, 0.024825837463140488, 0.01162638608366251, -0.01767553761601448, -0.0275572519749403, -0.002096825046464801, 0.013821527361869812, 0.011876646429300308, 0.03309158235788345, 0.005416351370513439, -0.017961550503969193, 0.032405152916908264, -0.004200800321996212, 0.03904063254594803, -0.006842835806310177, -0.006213609594851732, 0.03738176077604294, 0.0007691039936617017, 0.0348934568464756, 0.006320863962173462, -0.002289883093908429, -0.016216877847909927, 0.0035376104060560465, 0.009359740652143955, 0.018018752336502075, -0.011669287458062172, 0.010575291700661182, 0.0014649174408987164, 0.006077753845602274, 0.010210626758635044, 0.02409650757908821, 0.052683401852846146, -0.019491713494062424, 0.0006546992226503789, 0.019463112577795982, -0.0068714371882379055, -0.028644096106290817, -0.0034196304623037577, 0.007700871676206589, -0.014944124035537243, 0.011168766766786575, 0.0008696551085449755, -0.0005465509602800012, -0.02126498892903328, 0.010417984798550606, 0.01793294958770275, 0.005044535733759403, -0.012191259302198887, -0.025855479761958122, 0.004451061133295298, -0.00263309758156538, -0.024153709411621094, 0.006274387240409851, 0.04067089781165123, -0.0064066676422953606, 0.007514963857829571, -0.00749351317062974, 0.0034625320695340633, -0.002770740771666169, 0.01979202777147293, 0.0022237428929656744, -0.027285540476441383, 0.011862345971167088, 0.0005157152772881091, -0.01511573139578104, -0.013985984027385712, 0.01284908689558506, -0.007657969836145639, 0.005856094881892204, 0.012477271258831024, -0.005877545569092035, 0.019448813050985336, 0.03211914002895355, -0.012470120564103127, -0.0453328937292099, -0.003929089289158583, -0.03715295344591141, -0.018576476722955704, -0.01389303058385849, -0.02778606116771698, 0.007143148221075535, 0.01291343942284584, -0.001841201912611723, -0.01676030084490776, -0.014372100122272968, 0.010832702741026878, -0.009824510663747787, 0.055686526000499725, 0.007901079952716827, -0.018633678555488586, 0.07602197676897049, -0.04484667256474495, -0.020507056266069412, 0.015301639214158058, -0.0068571362644433975, 0.006034852005541325, 0.003516159486025572, -0.0017777429893612862, -0.018633678555488586, 0.02044985443353653, -0.015072830021381378, 0.024768635630607605, 0.011276020668447018, -0.006746307015419006, 0.030631879344582558, 0.012505872175097466, -0.018833886831998825, 0.020035136491060257, 0.026956625282764435, -0.012076854705810547, 0.02289525605738163, -0.02595558390021324, -0.004118571989238262, -0.0032426605466753244, 0.014143290929496288, 0.005813193041831255, -0.023953501135110855, 0.008044086396694183, 0.011876646429300308, 0.031518515199422836, -0.017103513702750206, -0.0304888729006052, -0.05494289472699165, -0.01513003185391426, -0.014801118522882462, 0.008237143978476524, -0.017475329339504242, 0.02954503521323204, -0.01301354356110096, -0.021050479263067245, -0.006056303158402443, -0.01647428795695305, 0.018176060169935226, 0.004776399582624435, -0.010789800435304642, 0.005033810157328844, 0.021207785233855247, 0.005359149072319269, 0.011647836305201054, -0.0041042715311050415, 0.03469324856996536, -0.006124231033027172, 0.020235344767570496, -0.015988068655133247, -0.004100696183741093, 0.017232220619916916, 0.004544015042483807, 0.024740032851696014, 0.016088172793388367, -0.0015122882323339581, -0.002836880972608924, 0.001069863443262875, -0.031232504174113274, 0.00887352041900158, 0.02426811307668686, 0.0009067472419701517, -0.009788759052753448, 0.029602237045764923, -0.016331281512975693, 0.04905105009675026, -0.017604036256670952, 0.022966759279370308, -0.020921774208545685, -0.00952419824898243, 0.008601808920502663, -0.00012635918392334133, -0.034493040293455124, 0.028157876804471016, 0.0023363600485026836, 0.028515391051769257, -0.017461029812693596, 0.01884818822145462, -0.020635761320590973, 0.009123780764639378, -0.010339331813156605, -0.0019556067418307066, 0.018176060169935226, -0.001751823234371841, -0.05574372783303261, 0.0394696481525898, -0.010732598602771759, 0.001389839337207377, 0.05525750666856766, 0.02403930388391018, -0.0012227010447531939, -0.008222843520343304, -0.00943839456886053, 0.01614537462592125, 0.007085945922881365, 0.01284908689558506, -0.01169073861092329, -0.007765224203467369, 0.027042429894208908, 0.04041348770260811, -0.009695804677903652, -0.003387453965842724, -0.027728859335184097, 0.005541481543332338, 0.008694763295352459, -0.014114690013229847, -0.007722322829067707, -0.018533574417233467, 0.01377862598747015, 0.009924614802002907, -0.003600175492465496, 0.03397822007536888, -0.004672720097005367, 0.040785305202007294, -0.002756440080702305, 0.0054807038977742195, 0.011147315613925457, -0.004919405560940504, 0.008501704782247543, -0.004308055154979229, -0.006302988156676292, 0.02044985443353653, -0.013578417710959911, 0.004629818256944418, -0.010081920772790909, 0.0037574819289147854, -0.006631901953369379, 0.008716214448213577, 0.009624302387237549, -0.037038546055555344, 0.0030210011173039675, 0.04069950059056282, 0.0021468771155923605, -0.03775357827544212, -0.03372080996632576, -0.003839710494503379, 0.004579766187816858, -0.007929680868983269, -0.015601951628923416, 0.01670309714972973, -0.025812577456235886, -0.023538783192634583, 0.031003694981336594, -0.01937730982899666, 0.027471447363495827, 0.0017759554320946336, 0.019806327298283577, -0.006210034247487783, 0.013321006670594215, 0.009331139735877514, 0.010360782966017723, -0.00543065182864666, 0.00421510124579072, -0.01307789608836174, 0.002852969104424119, 0.00525904493406415, 0.04327360913157463, 0.0002395350020378828, -0.015187234617769718, 0.0345788449048996, 0.011268870905041695, -0.013964533805847168, -0.017990151420235634, -0.021279288455843925, 0.01767553761601448, -0.010360782966017723, -0.004451061133295298, 0.024597028270363808, 0.019220003858208656, 0.0014193343231454492, -0.0035572736524045467, -0.004858627915382385, -0.0016999834915623069, 0.00031371935619972646, -0.0022684321738779545, -0.005698787979781628, 0.004980183206498623, -0.00528407096862793, 0.00529837142676115, 0.008065536618232727, 0.01164068654179573, 0.013585567474365234, 0.002325634704902768, 0.014715314842760563, 0.0015006689354777336, 0.0008593765087425709, -0.0032229970674961805, -0.021865613758563995, 0.03898342698812485, -0.0150013267993927, 0.026813620701432228, 0.014507955871522427, 0.02047845534980297, 0.00161417992785573, 0.013242353685200214, 0.007908230647444725, 0.022323232144117355, -0.03466464951634407, -0.00986741203814745, 0.0027975544799119234, -0.005991950165480375, 0.009138082154095173, -0.0025186927523463964, -0.0037324558943510056, 0.014743915759027004, 0.019220003858208656, 0.03140411153435707, -0.020278247073292732, 0.005523605737835169, 0.01751823164522648, -0.0027975544799119234, 0.013900180347263813, 0.011390426196157932, -0.016774600371718407, -0.041471730917692184, -0.019348708912730217, -0.0020485606510192156, -0.014479354955255985, 0.03803958743810654, -0.018419168889522552, 0.006013401318341494, -0.0003715920902322978, -0.010510939173400402, 0.02514044940471649, 0.00957425031810999, 0.018862487748265266, -0.0009170257835648954, -0.016388485208153725, -0.0010323243914172053, -0.007572166156023741, -0.012269912287592888, 0.0008057492668740451, -0.019649021327495575, -0.012234160676598549, 0.014972725883126259, 0.016316981986165047, -0.04387423396110535, 0.034779053181409836, -0.012312814593315125, -0.011712189763784409, -0.0153302401304245, 0.04410304129123688, 0.019849229604005814, 0.016931908205151558, -0.031747326254844666, 0.014400701969861984, 0.014543707482516766, 0.002513329964131117, -0.008830619044601917, -0.022966759279370308, 0.003189033130183816, 0.009288238361477852, -0.015544749796390533, -0.02801487036049366, -0.011612084694206715, 0.036609530448913574, -0.03237655386328697, 0.01637418381869793, 0.002877995138987899, 0.0019466688390821218, -0.011747940443456173, 0.017132116481661797, -0.01627407968044281, 0.012227010913193226, -0.03046027198433876, -0.04879363998770714, -0.009188134223222733, 0.03600890561938286, 0.010703996755182743, 0.01568775624036789, 0.02488303929567337, 0.043388012796640396, 0.014972725883126259, 0.0300026535987854, -0.0035840871278196573, -0.04212956130504608, 0.022680748254060745, -0.021407993510365486, -0.02654190920293331, 0.004093545954674482, -0.0006256511551328003, 0.012455820105969906, -0.02729984000325203, 0.00020646487246267498, -0.03320598602294922, 0.03366360813379288, -0.012791884131729603, 0.010096222162246704, 0.029430629685521126, -0.004669145215302706, -0.020893173292279243, -0.006438843905925751, -0.0011217030696570873, -0.00524116912856698, -0.012148357927799225, -0.0028029170352965593, -0.0013263804139569402, -0.02905881404876709, 0.01816175878047943, -0.005287645850330591, 0.03369220718741417, 0.040327683091163635, -0.009209584444761276, 0.0187480840831995, 0.01306359563022852, -0.004504688084125519, -0.013199451379477978, 0.0156591534614563, -0.010131972841918468, -0.0034929208923131227, 0.0026473980396986008, 0.01487262174487114, -0.012105455622076988, 0.009359740652143955, -0.029230421409010887, 0.007250403054058552, -0.013206602074205875, 0.014322048053145409, 0.006767757702618837, -0.0172894224524498, 0.010210626758635044, 0.004472511820495129, -0.008744815364480019, 0.01861937716603279, 0.008945023640990257, -0.03206193819642067, 0.019977934658527374, 0.02735704369843006, 0.040813904255628586, 0.02067866362631321, 0.004640543833374977, 0.027442846447229385, -0.016188276931643486, -0.006356615573167801, 0.008358699269592762, -0.031289707869291306, -0.012312814593315125, 0.00641739321872592, 0.023896297439932823, 0.016002368181943893, -0.011054362170398235, 0.022280331701040268, -0.010432286188006401, 0.005473553668707609, -0.02165110409259796, 0.01879098452627659, 0.0036716784816235304, 0.03795378655195236, -0.031261105090379715, -0.026241596788167953, 0.004608367569744587, 0.018047353252768517, -0.005595108959823847, -0.03440723568201065, -0.01511573139578104, -0.0012915227562189102, -0.015458946116268635, -0.010897055268287659, -0.0018429894698783755, 0.03237655386328697, -0.011733639985322952, -0.003090716665610671, -0.012098305858671665, -0.03483625501394272, 0.007943982258439064, -0.018276164308190346, 0.02077876776456833, 0.04736357927322388, 0.022394735366106033, 0.011719339527189732, 0.0014872620813548565, -0.005098163150250912, 0.007371957879513502, -0.03623771294951439, 0.018447769805788994, 0.009416943415999413, 0.014350649900734425, -0.018147457391023636, -0.015458946116268635, -0.0064424192532896996, 0.010096222162246704, 0.025455063208937645, 0.01897689327597618, 0.01816175878047943, -0.052454590797424316]",Model Alignment as Prospect Theoretic Optimization.pdf
" The interval [1,4/3]was deter-
mined empirically and suggests a value function that is more
gain-sensitive, in contrast to the classic Kahneman-Tversky
value function (4), which is more loss-sensitive. In tasks
6
Model Alignment as Prospect Theoretic Optimization
Figure 4. Without doing SFT first, DPO-aligned models tend to
ramble and hallucinate entire conversations. KTO does not suffer
from this issue.
where minimizing the downside is more important, like tox-
icity prevention, setting λD, λUsuch that λDnD< λUnU
may work better. This is especially helpful if the positive
KTO examples are instances of less toxic outputs that should
still be avoided, as would be the case if a preference dataset
were simply split up to create the KTO data. w(x, y)could
also serve as importance weights, which is helpful when
the offline dataset Ddoes not match the desired feedback
distribution. We leave more complex weighting schemes as
a direction for future work.
By default, we set β= 0.1in our experiments. If we want
the loss to saturate more quickly—i.e., be more risk-averse
in gains and risk-seeking in losses—we would use lower β
(and vice-versa for higher β).
4.2. Experiments
We subject the models to: (1) winrate experiments following
§3.3, where—for some test inputs— GPT-4-0613 is used
to judge the aligned model’s generation against the SFT
target; (2) generative benchmarks such as MMLU (0-shot)
(Hendrycks et al., 2021), GSM8K (8-shot, chain-of-thought)
(Cobbe et al., 2021), HumanEval (0-shot) (Chen et al., 2021),
and BigBench-Hard (3-shot chain-of-thought) (Srivastava
et al., 2022). The experimental configuration is identical
across methods, save for the data-imbalanced experiments,
where we set λD, λUfor KTO according to (8).
KTO≥DPO As seen in Figure 3, in the winrate evalu-
ation, SFT+KTO is competitive with SFT+DPO at scales
from 1B to 30B, despite the model learning from a weaker
signal. KTO alone is better than DPO alone for the
Llama- {7B, 13B, 30B }models, and this gap is significant
(p <0.01) at 7B and 30B even after correcting for multiple
comparisons (Holm, 1979). Among the Pythia models, there
is no significant difference between the two, suggesting that
a minimum model capacity is needed for these differences
to emerge. KTO also fares better than DPO and other base-
lines on generative benchmarks (Table 1). This is most
Figure 5. A KTO-aligned Llama-7B model can match or exceed
the performance of its DPO-aligned counterpart while aligned
on a smaller and highly imbalanced version of the same dataset,
even with as few as 0.1 positive/desirable examples for every
negative/undesirable one.
pronounced for certain tasks: on GSM8K, a mathematical
reasoning dataset, just swapping DPO for KTO when align-
ing Zephyr- β-SFT (Tunstall et al., 2023) on UltraFeedback
(Cui et al., 2023) improves performance by 13.5 points.
At sufficient scale, KTO does not need SFT. A KTO-
aligned Llama- {13B, 30B }model is competitive with its
SFT+KTO counterpart despite not undergoing SFT first,
and is the only alignment method of the ones we tested
to show this behavior. This is perhaps due to KTO alone
keeping the average response length roughly the same, while
running DPO without SFT prior causes the response length
to increase dramatically (Figure 4).
KTO data need not come from preferences. Might KTO
be secretly benefiting from its 2nexamples in the previous
experiment coming from npreference pairs instead of a nat-
urally unpaired data distribution? To test this, we randomly
discard increasingly large fractions of the desirable data be-
fore KTO-aligning a Llama-7B model. For example, if we
discard 90% of the desirable data while leaving the undesir-
able data untouched, then the ratio of desirable:undesirable
examples goes from 1:1 to","[-0.0005853683105669916, -0.0033805356360971928, 0.052770037204027176, 0.010569772683084011, 0.016882972791790962, -0.008025861345231533, -0.017742885276675224, 0.03393792733550072, -0.02879277616739273, 0.03881077095866203, 0.02473684959113598, 0.006216459441930056, -0.0027427664026618004, -0.008692294359207153, 0.044887494295835495, -0.02857779711484909, 0.018187174573540688, -0.05549309775233269, -0.01798652857542038, 0.026671655476093292, -0.015335127711296082, -0.025367453694343567, 0.006008646916598082, 0.025955060496926308, 0.018875105306506157, -0.022443747147917747, 0.001699225278571248, 0.010870741680264473, 0.004120419733226299, -0.06220042333006859, 0.06105387210845947, -0.04454352706670761, -0.05125085636973381, -0.05213943123817444, -0.009738522581756115, 0.050304949283599854, 0.035686418414115906, 0.05620969086885452, -0.012146281078457832, -0.004693695344030857, -0.036632321774959564, -0.04288103058934212, -0.038667451590299606, 0.0035543099511414766, -0.006646416150033474, -0.000900222104974091, 0.0358584001660347, -0.00017097502131946385, -0.023704953491687775, 0.010698758997023106, 0.004260155837982893, 0.05609503388404846, -0.016954630613327026, 0.008384158834815025, 0.0025528687983751297, -0.013801614753901958, 0.0006350820767693222, 0.018746118992567062, 0.05428921803832054, -0.00912941712886095, -0.05185279622673988, -0.031530167907476425, 0.03471184894442558, 0.03760689124464989, -0.030412280932068825, -0.014489545486867428, -0.0843861922621727, 0.010232972912490368, -0.012526076287031174, 0.02606971561908722, -0.0201649758964777, 0.005245473235845566, 0.0066070035099983215, 0.003937688190490007, 0.025424780324101448, -0.025367453694343567, 0.04058792442083359, 0.053773269057273865, 0.03608771041035652, -0.04050193354487419, 0.037377581000328064, 0.017585234716534615, 0.05193878710269928, -0.03846680372953415, 0.010340462438762188, -0.01739891991019249, -0.015435450710356236, -0.017155278474092484, -0.07280602306127548, -0.015879739075899124, -0.04523145779967308, -0.027201935648918152, -0.0032497572246938944, -0.02538178488612175, 0.04821249470114708, -0.018975429236888885, 0.02287370339035988, -0.018645795062184334, 0.02702995389699936, 0.004349729977548122, -0.019563036039471626, 0.0055930218659341335, -0.009365892969071865, -0.02330366149544716, 0.07945602387189865, 0.02432122454047203, 0.0350271500647068, 0.007696227636188269, -0.003873194567859173, 0.008771119639277458, -0.02549644000828266, 0.004675780422985554, -0.05701227858662605, 0.02102489024400711, -0.001660708338022232, -0.08650731295347214, -0.0448015034198761, 0.018115514889359474, 0.008190677501261234, -0.02293103188276291, -0.019061420112848282, -0.025525104254484177, 0.03132952004671097, 0.027646224945783615, -0.019391054287552834, -0.009738522581756115, 0.024450212717056274, -0.0447155125439167, 0.011845311149954796, -0.02596939355134964, 0.026227368041872978, 0.020953230559825897, 0.004055926110595465, -0.025209803134202957, -0.0663280114531517, 0.016667993739247322, -0.03322133049368858, 0.02383394166827202, -0.01851680874824524, -0.005195311736315489, -0.036804307252168655, -0.07257671654224396, -0.021684156730771065, -0.0003600888594519347, -0.07011163234710693, -0.0022071118000894785, 0.00015765083662699908, 0.0029649108182638884, -0.03628835827112198, 0.03932671993970871, 0.00026805122615769506, -0.04311034083366394, -0.02526712976396084, 0.01788620464503765, 0.03167348727583885, -0.01996432989835739, -0.028620794415473938, 0.020021656528115273, 0.022802043706178665, -0.0395846925675869, 0.014589868485927582, 0.022744717076420784, 0.008068856783211231, 0.03410990908741951, 0.006979632657021284, 0.02357596717774868, -0.00617346353828907, 0.025353122502565384, -0.07888274639844894, -0.02161249704658985, 0.02857779711484909, -0.00484059751033783, -0.0709715411067009, -0.0030777743086218834, -0.028334155678749084, -0.005822332110255957, -0.05517779290676117, -0.002483000745996833, -0.0052848863415420055, -0.041906461119651794, -0.024665189906954765, 0.015521441586315632, 0.0012916619889438152, 0.03815150260925293, -0.05537844076752663, -0.031386848539114, 0.012891539372503757, -0.010985396802425385, 0.0016069636913016438, 0.03924072906374931, 0.03491249680519104, -0.0015666552353650331, 0.05534977838397026, 0.015478446148335934, -0.03385193645954132, -0.01256190612912178, 0.048871759325265884, 0.07744956016540527, -0.039298053830862045, 0.03691896051168442, 0.022372087463736534, 0.014991161413490772, 0.036317020654678345, -0.09361593425273895, -0.0013892980059608817, -0.006861394736915827, 0.001076683634892106, 0.00172341032885015, -0.04328232258558273, -0.009165246970951557, 0.015879739075899124, 0.01734159328043461, 0.03433921933174133, 0.0264996737241745, 0.0032264678739011288, -0.0014340851921588182, -0.06672929972410202, 0.015693424269557, 0.018860774114727974, 0.07567240297794342, 0.006409939844161272, 0.03359396010637283, 0.01245441660284996, 0.033278658986091614, -0.03081357292830944, 0.027789544314146042, -0.0038875264581292868, -0.01771422103047371, 0.0156504288315773, -0.05136550962924957, 0.02473684959113598, -0.014245903119444847, 0.022042453289031982, -0.029495039954781532, 0.013342994265258312, -0.061913784593343735, -0.012956032529473305, -0.04964568465948105, -0.02255840227007866, -0.04245107248425484, -0.015148812904953957, -0.026628660038113594, 0.029724350199103355, -0.02969568595290184, -0.05256938934326172, 0.024392884224653244, -0.04652132838964462, -0.03597305715084076, -0.021268531680107117, -0.013522142544388771, 0.03347930684685707, -0.01469019241631031, -0.05715559422969818, -0.028778444975614548, -0.036947622895240784, 0.002053043805062771, 0.029609695076942444, -0.008720957674086094, -0.004525295924395323, 0.026757648214697838, -0.011580171063542366, 0.0006485182093456388, -0.041963785886764526, 0.004937337711453438, -0.029093746095895767, 0.009566539898514748, -0.006875726394355297, -0.01303485780954361, -0.0010462283389642835, -0.017097949981689453, 0.033708617091178894, 0.024650858715176582, -0.019892670214176178, 0.007452585268765688, -0.04442887380719185, -0.053773269057273865, 0.00496241869404912, 0.015449782833456993, -0.021626828238368034, -0.0567256398499012, -0.014174243435263634, 0.009279902093112469, 0.05268404632806778, -0.020365621894598007, 0.00011588680354179814, -0.01442505232989788, -0.013751452788710594, 0.03244740888476372, 0.0028610045555979013, -0.00022751883079763502, 0.04474417492747307, -0.01990700140595436, 0.06025128439068794, -0.01590840332210064, -0.005091405473649502, 0.020035989582538605, 0.009537875652313232, -0.01900409162044525, -0.023489974439144135, 0.006381276063621044, 0.03107154741883278, -0.0014251277316361666, 0.010232972912490368, -0.0010175645584240556, 0.05684029310941696, -0.008584804832935333, 0.03135818615555763, 0.013428985141217709, 0.007345096208155155, 0.0049731675535440445, -0.007459751330316067, 0.008692294359207153, -0.016854308545589447, 0.044514864683151245, 0.002794719533994794, -0.025568099692463875, 0.07194611430168152, -0.01851680874824524, 0.009666862897574902, -0.04139051213860512, -0.04279503598809242, -0.10307498276233673, -0.026299025863409042, 0.025095148012042046, 0.044572193175554276, 0.0013651129556819797, -0.011709158308804035, -0.0007273436640389264, -0.013471980579197407, -0.007653231732547283, -0.007653231732547283, -0.004829848650842905, 0.0009190327255055308, -0.023661958053708076, -0.056868959218263626, 0.018688790500164032, -0.008928770199418068, 0.03055560030043125, 0.03474051132798195, 0.0373489186167717, -0.0983741283416748, -0.02432122454047203, -0.0025689920876175165, -0.011379524134099483, -0.016567669808864594, 0.03614503890275955, 0.03256206586956978, 0.012640731409192085, 0.03969934955239296, 0.024077583104372025, -0.006510263308882713, -0.00035829737316817045, 0.03924072906374931, 0.031042883172631264, 0.05317132920026779, 0.009050591848790646, -0.029079414904117584, -0.006495931185781956, 0.0056754304096102715, -0.006943802814930677, 0.01329999789595604, 0.021153876557946205, 0.005091405473649502, 0.04316766560077667, 0.032877366989851, 0.05428921803832054, -0.0320461168885231, -0.012432918883860111, -0.0220281220972538, -0.010498112998902798, 0.007531410548835993, 0.01024013850837946, -0.011694826185703278, 0.00768906157463789, -0.06518145650625229, 0.01580807939171791, 0.029896331951022148, 0.03528512641787529, 0.007366593927145004, 0.03373727947473526, -0.007402423769235611, 0.00742392148822546, -0.010849243961274624, -0.019505709409713745, -0.0027929279021918774, 0.004177747294306755, 0.0030562765896320343, -0.010569772683084011, -0.048929087817668915, -0.012217939831316471, 0.009896173141896725, 0.014138414524495602, -0.042651720345020294, 0.019505709409713745, 0.007291351445019245, 0.026786310598254204, -0.0064529357478022575, 0.07143016159534454, 0.023289328441023827, 0.06655731797218323, -0.036317020654678345, 0.0030437360983341932, -0.09860343486070633, -0.014776183292269707, -0.05804417282342911, -0.009595203213393688, 0.0019867587834596634, 0.031042883172631264, 0.036374349147081375, 0.023805277422070503, 0.05019029602408409, -0.04362628608942032, 0.04144784063100815, -0.02304568700492382, 0.021254200488328934, 0.003934104926884174, 0.00990333966910839, 0.038180168718099594, 0.0018156719161197543, 0.046693313866853714, -0.02697262540459633, -0.012604901567101479, -0.017943531274795532, -0.051508828997612, -0.01590840332210064, 0.004281653556972742, -0.008699459955096245, -0.0010928069241344929, 0.0417344756424427, -0.05910473316907883, 0.0014520001132041216, 0.05592305213212967, 0.041963785886764526, -0.020465945824980736, -0.04288103058934212, -0.00849164742976427, -0.006495931185781956, -0.013844610191881657, -0.018975429236888885, -0.005019746255129576, -0.000244985829340294, -0.02271605283021927, 0.0027696385513991117, -0.031100211665034294, -0.02655700035393238, -0.009545042179524899, -0.024407217279076576, 0.0011492387857288122, 0.03087090142071247, -0.01671098917722702, -0.0040129306726157665, 0.0373489186167717, 0.03895409032702446, -0.039842668920755386, -0.004493048880249262, -0.04374094307422638, 0.04649266600608826, -0.003239008132368326, 0.0693090409040451, -0.03714827075600624, 0.005019746255129576, -0.02809051424264908, -0.024923164397478104, -0.013909103348851204, -0.022687388584017754, 0.006782568991184235, 0.012017293833196163, 0.002140826778486371, -0.003823032835498452, 0.01900409162044525, 0.004622036125510931, -0.0507635697722435, 0.012375591322779655, -0.0276175606995821, -0.052397407591342926, 0.01782887615263462, 0.05348663032054901, 0.009760020300745964, 0.01229676604270935, -0.009158080443739891, 0.011322196573019028, -0.044772837311029434, -0.0220281220972538, 0.03792219236493111, 0.04772520810365677, 0.027115944772958755, 0.05641033872961998, 0.014589868485927582, -0.0026675239205360413, 0.027975859120488167, -0.015994394198060036, -0.05380193144083023, 0.06695861369371414, -0.01745624840259552, 0.005320715717971325, 0.0014940999681130052, 0.022601397708058357, -0.002067375695332885, -0.011601668782532215, -0.009143749251961708, 0.03465452045202255, -0.015922734513878822, 0.010290300473570824, 0.02756023406982422, 0.02080991119146347, 0.012819879688322544, 0.011393856257200241, -0.012110451236367226, -0.0220281220972538, 0.019333725795149803, -0.0005629747174680233, -0.00886427704244852, 0.001076683634892106, 0.028377151116728783, -0.00862063467502594, 0.0012038791319355369, -0.02287370339035988, 0.007140866480767727, -0.014632864855229855, 0.0335366353392601, -0.038237493485212326, -0.004607704002410173, -0.04101788252592087, 0.00390544137917459, 0.031960126012563705, -0.0035722246393561363, -0.03324999660253525, -0.08627800643444061, -0.026700319722294807, -0.028377151116728783, 0.03367995098233223, -0.016854308545589447, 0.007076372858136892, 0.001220898237079382, -0.0276175606995821, -0.02495182864367962, 0.008047359064221382, -0.021168207749724388, -0.009874675422906876, -0.010698758997023106, 0.0327913761138916, 0.009408888407051563, 0.02624169923365116, -0.016195040196180344, 0.016582002863287926, -0.01686863973736763, 0.04064525291323662, -0.0433109849691391, -0.0193767212331295, -0.0027750132139772177, 0.03399525582790375, -0.03671831265091896, -0.02220010571181774, 0.0022554819006472826, -0.05984999239444733, -0.006442186422646046, 0.008799782954156399, 0.018158510327339172, 0.0017502825940027833, 0.00517381401732564, 0.023762281984090805, 0.003246174193918705, -0.02006465196609497, 0.010025160387158394, -0.0009718816145323217, 0.0193767212331295, -0.007216108962893486, 0.004213577136397362, 0.030268961563706398, 0.04299568384885788, -0.019620364531874657, -0.008441486395895481, 0.02410624735057354, -0.03729159012436867, 0.008835612796247005, 0.0005885034333914518, 0.004381977021694183, -0.001713557168841362, 0.011372358538210392, 0.0007470499840565026, -0.025396117940545082, 0.007710559293627739, -0.02969568595290184, -0.008663630113005638, -0.05827348306775093, 0.003204969922080636, 0.011537175625562668, 0.02208545058965683, -0.04666464775800705, 0.03218943625688553, 0.03952736407518387, -0.03912607207894325, 0.014116915874183178, 0.006205710582435131, -0.01996432989835739, -0.005399541463702917, -0.010763253085315228, -0.03611637279391289, 0.013866107910871506, -0.043396975845098495, 0.026327690109610558, -0.011931302025914192, 0.011730656027793884, -0.04517413303256035, -0.014962498098611832, 0.03582973778247833, -0.0004711610381491482, 0.015292131341993809, 0.020824242383241653, 0.014389222487807274, 0.025138143450021744, -0.016796980053186417, -0.009874675422906876, -0.009874675422906876, -0.03422456607222557, -0.033765945583581924, -0.011315030977129936, 0.005345796700567007, 0.008685127831995487, -3.879688665620051e-05, -0.02043728157877922, -0.001824629376642406, -0.007531410548835993, -0.009638199582695961, 0.005693345330655575, 0.0009593411814421415, 0.01356513798236847, -0.004414223600178957, -0.03322133049368858, -0.004955252632498741, -0.05102154612541199, -0.010498112998902798, 0.021856138482689857, 0.018545471131801605, 0.01497683022171259, -0.0027714301832020283, 0.04150516539812088, 0.012461582198739052, 0.002038711914792657, -0.02644234523177147, 0.01877478137612343, 0.005202477797865868, 0.01994999684393406, -0.022644393146038055, 0.014675860293209553, -0.007284185383468866, 0.0002788001438602805, 0.028534801676869392, 0.022056786343455315, -0.03198878839612007, -0.004639951046556234, -0.029222732409834862, 0.038495469838380814, 0.01898976042866707, 0.03571508079767227, 0.017269933596253395, -0.021999457851052284, 0.004184913355857134, 0.007925537414848804, 0.0010775793343782425, -0.041161201894283295, -0.010254470631480217, -0.030584262683987617, 0.00851314514875412, 0.027101613581180573, 0.04144784063100815, 0.013471980579197407, 0.03304934874176979, 0.002766055753454566, 0.008384158834815025, 0.0031476423610001802, 0.021469177678227425, 0.03075624629855156, -0.04093189164996147, -0.0031798891723155975, 0.00886427704244852, 0.008613469079136848, -0.049559690058231354, -0.051164865493774414, 0.017155278474092484, -0.019491376355290413, -0.0409892201423645, -0.049043744802474976, -0.021053552627563477, -0.002835923573002219, -0.040157970041036606, 0.06512413173913956, 0.012999028898775578, -0.01814417913556099, -0.011723489500582218, -0.0034504036884754896, -0.0034181568771600723, 0.010232972912490368, -0.04038728028535843, 0.00811185222119093, -0.0049194227904081345, -0.020938897505402565, 0.04365495219826698, -0.034625858068466187, -0.05841680243611336, -0.01771422103047371, -0.007284185383468866, -0.03385193645954132, 0.01953437179327011, -0.047438573092222214, -0.020021656528115273, -0.00770339323207736, 0.0521680973470211, 0.023174673318862915, -0.004607704002410173, 0.0027033535297960043, 0.004808350466191769, 0.0038337819278240204, -0.0012674769386649132, 0.005926238372921944, -0.017370255663990974, 0.006323948502540588, 0.006402773782610893, 0.008212175220251083, -0.04746723547577858, -0.021411851048469543, -0.011673328466713428, -0.014554038643836975, 0.03170214965939522, 0.003912607207894325, -0.023117346689105034, -0.03032628819346428, 0.007402423769235611, 0.018316160887479782, -0.001254936563782394, 0.0049409205093979836, 0.012131948955357075, -0.0024435881059616804, -0.027115944772958755, -0.028491806238889694, 0.014145580120384693, -0.027044285088777542, 0.021526506170630455, -0.0029702852480113506, 0.012332594953477383, 0.019305061548948288, 0.009459050372242928, -0.006033727433532476, 0.016911635175347328, 0.009143749251961708, -0.01590840332210064, 0.02585473842918873, 0.026471009477972984, -0.0033948675263673067, 0.013873274438083172, 0.00039233561255969107, 0.014023758471012115, -0.006126884836703539, 0.015019825659692287, 0.008477315306663513, -0.01447521336376667, -0.013350159861147404, -0.00859913695603609, -0.03580107167363167, 0.028821440413594246, -0.004306734539568424, 0.01354364026337862, -0.012110451236367226, 0.012225106358528137, 0.02122553624212742, 0.00862063467502594, -0.04391292482614517, 0.012282433919608593, 0.022329092025756836, -0.019276399165391922, -0.005134401377290487, 0.016854308545589447, 0.01957736723124981, 0.03648900240659714, 0.057069603353738785, -0.03720559924840927, 0.020408617332577705, 0.01712661422789097, 0.021999457851052284, 0.013257002457976341, -0.030526936054229736, -0.013744287192821503, -0.00010009932884713635, -0.011773651465773582, 0.006832730956375599, -0.001571133965626359, -0.00768906157463789, -0.010892240330576897, 0.013851775787770748, -0.020093316212296486, -0.010569772683084011, -0.0022841456811875105, -0.004797601606696844, 0.03846680372953415, 0.0009333646157756448, 0.019305061548948288, -0.04566141590476036, -0.14171376824378967, -0.05397391691803932, 0.025740083307027817, 0.014353392645716667, 0.005535694304853678, -0.006058808416128159, 0.05222542583942413, 0.03425322845578194, -0.030842237174510956, -0.0007174905040301383, 0.006467267405241728, -0.03439654782414436, -0.0010175645584240556, -0.010863576084375381, 0.0010480198543518782, -0.03491249680519104, -0.004124002531170845, -0.00941605493426323, -0.0029649108182638884, -0.026041053235530853, -0.016825644299387932, 0.010118317790329456, -0.013837444595992565, 0.032218098640441895, -0.04250840097665787, -0.021569501608610153, 0.032533399760723114, 0.0018810611218214035, 0.00023692412651143968, 0.01761389896273613, 0.0044751339592039585, 0.0029577447567135096, 0.028076181188225746, 0.03144417703151703, -0.03938404470682144, -0.02112521231174469, -0.005524945445358753, -0.011286366730928421, 0.019462712109088898, 0.014145580120384693, 0.0005902948905713856, -0.020781246945261955, 0.023117346689105034, -0.019448380917310715, 0.035944391041994095, -0.03683296963572502, 0.01497683022171259, -0.013536474667489529, -0.014611366204917431, -0.00809035450220108, 0.02406325191259384, -0.03703361749649048, -0.015779415145516396, -0.007219691760838032, 0.011852476745843887, 0.012970364652574062, 0.0064493524841964245, -0.012024459429085255, 0.003031195607036352, -0.00715878140181303, -0.015077153220772743, 0.034998487681150436, 0.005338630639016628, -0.007660397794097662, -0.03439654782414436, -0.02059493213891983, -0.019147410988807678, 0.014991161413490772, 0.002126494888216257, -0.046320684254169464, -0.001993924845010042, 0.014718855731189251, 0.012010127305984497, 0.002397009404376149, 0.008986097760498524, 0.005424621980637312, 0.0071014538407325745, 0.02734525501728058, -0.07664697617292404, 0.036689650267362595, 0.010053823702037334, -0.02606971561908722, 0.037377581000328064, 0.029724350199103355, 0.029222732409834862, 0.049244388937950134, 0.011250536888837814, -0.0017708847299218178, -0.020781246945261955, 0.0011008686851710081, 0.040415942668914795, -0.026915298774838448, 0.016639329493045807, -0.015320795588195324, -0.00835549458861351, -0.0182588342577219, -0.009982164949178696, 0.016897303983569145, -0.0022680223919451237, -0.0006601628847420216, 0.007975699380040169, 0.009609535336494446, -0.04468684643507004, -0.04328232258558273, 0.008169179782271385, 0.012182110920548439, 0.0018398569663986564, 0.0019975078757852316, 0.017069285735487938, -0.029839005321264267, -0.019061420112848282, -0.01165183074772358, 0.014539707452058792, 0.01767122559249401, -0.017843209207057953, 0.02192779816687107, 0.05322865769267082, 0.00952354446053505, 0.00902192760258913, 0.022730384021997452, 0.008706625550985336, 0.04603404551744461, -0.026915298774838448, 0.009265569970011711, 0.001377653330564499, 0.008986097760498524, -0.03465452045202255, 0.02549644000828266, -0.022286096587777138, 0.01236842479556799, 0.024306893348693848, -0.005886825732886791, 0.0038767775986343622, -0.01596572995185852, -0.003351871855556965, -0.003937688190490007, 0.019190406426787376, 0.006929471157491207, 0.015937067568302155, 0.031960126012563705, 0.00012417242396622896, -0.008004363626241684, 0.03714827075600624, 0.0072591048665344715, 0.0073056831024587154, -0.013436151668429375, 0.023747948929667473, -0.045317452400922775, 0.02000732533633709, 0.0025080814957618713, 0.015019825659692287, -0.013235504738986492, 0.0027481408324092627, 0.005739924032241106, 0.005499864462763071, -0.025152474641799927, -0.009050591848790646, -0.01612338237464428, 0.040157970041036606, 0.041849132627248764, 0.0014439383521676064, 0.016725320369005203, -0.01415991224348545, -0.03514180704951286, 0.047868527472019196, -0.004622036125510931, -0.005657515488564968, 0.016352692618966103, 0.02303135395050049, 0.02347564324736595, -0.018588466569781303, -0.04127585515379906, 0.008849944919347763, 0.0015218680491670966, 0.04087456315755844, -0.007495580706745386, -0.030985556542873383, -0.004532461520284414, -0.0002942517166957259, 0.03597305715084076, 0.006958134938031435, 0.008140516467392445, -0.017800213769078255, 0.011465515941381454, 0.040530599653720856, -0.06971033662557602, 0.011085720732808113, 0.0036438843235373497, 0.003052693558856845, 0.026041053235530853, 0.004736691247671843, 0.020250966772437096, -0.006352612283080816, 0.024077583104372025, -0.005467617884278297, -0.01782887615263462, 0.030584262683987617, 0.039298053830862045, -0.017699889838695526, -0.02857779711484909, -0.0036474671214818954, 0.047983184456825256, 0.011365192010998726, -0.011959966272115707, -0.012024459429085255, 0.03479783982038498, 0.01676831766963005, -0.019348056986927986, -0.006682245992124081, 0.020207971334457397, -0.0019079335033893585, 0.0264996737241745, -0.017642563208937645, 0.031157538294792175, 0.016624998301267624, -0.04213577136397362, 0.0023593881633132696, -0.0026657325215637684, -0.011078554205596447, -0.017699889838695526, -0.03431055694818497, -0.02569708786904812, 0.018015190958976746, -0.005223975516855717, -0.0013113683089613914, -0.015593101270496845, 0.04262305423617363, -0.0050734905526041985, 0.022802043706178665, 0.014131247997283936, -0.018029524013400078, 0.023762281984090805, -0.013063522055745125, 0.011637498624622822, 0.0004218951507937163, 0.0002487927267793566, 0.002038711914792657, 0.0005249056266620755, -0.0027570982929319143, 0.0031100211199373007, 0.03666098788380623, 0.01702629029750824, 0.01375861931592226, -0.014145580120384693, 0.003651050152257085, 0.0072053601033985615, 0.02144051529467106, 0.04193512350320816, -0.030354952439665794, 0.008455817587673664, -0.019978661090135574, 0.012110451236367226, 0.016582002863287926, -0.00557510694488883, 4.758637078339234e-05, -0.009824513457715511, 0.024966159835457802, 0.05500581115484238, 0.033450640738010406, 0.0313008576631546, -0.019864005967974663, 0.03611637279391289, -0.014776183292269707, -0.012289599515497684, -0.009853177703917027, -0.0047868527472019196, 0.005245473235845566, 0.0017502825940027833, 0.03932671993970871, 0.0029505789279937744, -0.022099781781435013, 0.04577607288956642, -0.019606031477451324, 0.03239008039236069, 0.013557972386479378, 0.010404955595731735, 0.043511632829904556, -0.006470850668847561, 0.04311034083366394, 0.018000859767198563, 0.008928770199418068, -0.00522755878046155, 0.014145580120384693, 0.01285570953041315, 0.011315030977129936, -0.022114112973213196, -0.001366008655168116, -0.011744987219572067, 0.009380225092172623, -0.000979943317361176, 0.033393315970897675, 0.05070624500513077, -0.006169880740344524, -0.018746118992567062, -0.00578650226816535, 0.0015505318297073245, -0.015048488974571228, -0.021383186802268028, 0.0066034202463924885, -0.0432249940931797, -0.010655763559043407, 0.013149512931704521, 0.013600967824459076, -0.020738251507282257, 0.003719126572832465, 0.01798652857542038, 0.0005034077912569046, -0.0075170788913965225, -0.018387820571660995, 2.7991982278763317e-05, -0.0008285626536235213, -0.010684427805244923, 0.00404517725110054, 0.020781246945261955, -0.02526712976396084, 0.014933833852410316, 0.0007595904171466827, -0.014948165975511074, 0.029839005321264267, 0.003663590643554926, 0.018803445622324944, -0.03055560030043125, 0.01312084961682558, 0.004274487495422363, -0.020308295264840126, -0.00589399179443717, -0.0006982319755479693, -0.0052813030779361725, 0.003491607727482915, 0.000584024703130126, 0.0032927528955042362, -0.0007998988730832934, 0.02809051424264908, -0.02592639811336994, -0.03571508079767227, 0.0008397594792768359, -0.022529738023877144, -0.023776613175868988, -0.014718855731189251, -0.03416723757982254, 0.027904199436306953, 0.017757218331098557, -0.024980492889881134, -0.005474783945828676, 0.0036259694024920464, 0.038753442466259, 0.0009476965060457587, 0.01910441555082798, 0.01714094541966915, -0.0015917361015453935, 0.08295300602912903, -0.043769605457782745, -0.015349458903074265, 0.015779415145516396, 0.005191728938370943, 0.014991161413490772, -0.0009906921768561006, -0.002830549143254757, -0.022544071078300476, 0.04804050922393799, -0.02495182864367962, 0.0013239088002592325, 0.009344395250082016, -0.00010530583676882088, 0.028334155678749084, 0.009072089567780495, -0.01431756280362606, 0.04440021142363548, 0.025023488327860832, -0.016295364126563072, 0.01845948025584221, -0.012289599515497684, -0.016209373250603676, 0.008240839466452599, 0.004665031563490629, -0.002441796474158764, -0.02144051529467106, -0.001452895812690258, 0.00325334002263844, 0.024708187207579613, 0.003206761321052909, -0.04933037981390953, -0.048671115189790726, -0.023017022758722305, 0.005163065157830715, -0.0022375669796019793, -0.021841807290911674, 0.03763555362820625, -0.02075258269906044, -0.037492237985134125, -0.017040623351931572, -0.008427154272794724, -0.003099272260442376, 0.00037374894600361586, 0.004518129862844944, 0.02240075170993805, 0.023862604051828384, 0.0002698427124414593, 0.012397089041769505, -0.00524189043790102, 0.02938038483262062, -0.0264996737241745, 0.011193209327757359, -0.018502475693821907, 0.016624998301267624, 0.006692994851619005, 0.012354093603789806, 0.02661432884633541, 0.030211633071303368, 8.671916293678805e-05, -0.011902638711035252, -0.026571333408355713, -0.01996432989835739, 0.01115021388977766, 0.012827045284211636, -0.023375319316983223, -0.001035479363054037, 0.016582002863287926, -0.008076022379100323, 0.0462920181453228, -0.003366203745827079, 0.004138334654271603, -0.013629632070660591, -0.011795149184763432, 0.007667563855648041, -0.00026222888845950365, 0.003919773269444704, 0.019190406426787376, -0.0069473860785365105, 0.016137713566422462, -0.011565838940441608, 0.011458349414169788, -0.004149083513766527, 0.004407057538628578, -0.019305061548948288, 0.020336957648396492, -0.010225806385278702, -0.02885010465979576, -0.048183828592300415, 0.029523702338337898, -0.01110005285590887, -0.0021999457385390997, 0.03975667431950569, 0.012425752356648445, 0.010225806385278702, -0.01810118369758129, -0.014066754840314388, -0.007183862384408712, 0.006936637219041586, 0.010670095682144165, 0.0028233833145350218, -0.008119018748402596, 0.015263468027114868, 0.029495039954781532, -0.011859643273055553, -0.01841648481786251, -0.04210710525512695, 0.009487714618444443, 0.011229039169847965, -0.004901507869362831, 0.0013095769099891186, 0.0014708107337355614, 0.01180948130786419, 0.021297195926308632, -0.017312929034233093, 0.056381672620773315, 0.00702262856066227, 0.044514864683151245, -0.01606605388224125, 0.01018997747451067, 0.016796980053186417, 0.010627100244164467, 0.011042725294828415, 0.00703696021810174, 0.02000732533633709, 0.02065226063132286, -0.021841807290911674, -0.0028753364458680153, -0.01447521336376667, -0.0011107218451797962, 0.017054954543709755, 0.008104686625301838, 0.02437855303287506, -0.033335987478494644, 0.015593101270496845, 0.034081246703863144, -0.005034077912569046, -0.02145484648644924, -0.009079255163669586, 0.01788620464503765, 0.02846314199268818, 0.022472411394119263, -0.01622370444238186, 0.0008428945438936353, -0.004170581232756376, -0.01920473948121071, 0.025195470079779625, -0.03691896051168442, 0.014718855731189251, 0.016854308545589447, 0.008054524660110474, -0.009545042179524899, 0.0001269716303795576, 0.005901157855987549, -0.035743746906518936, 0.018230170011520386, 0.0021462012082338333, -0.0439702533185482, -0.001428710762411356, 0.04411357268691063, 0.03032628819346428, -0.0059835659340023994, -0.012827045284211636, 0.03247607499361038, 0.016137713566422462, -0.04093189164996147, -0.030412280932068825, 0.005754255689680576, 0.016209373250603676, -0.008842779323458672, 0.009595203213393688, 0.008634966798126698, 0.013952099718153477, -0.006499514449387789, -0.026886634528636932, 0.00029649108182638884, -0.0115730045363307, 0.030211633071303368, -0.011594503186643124, -0.019864005967974663, 0.030670255422592163, 0.0071516153402626514, 0.008455817587673664, -0.0007792967953719199, -0.01415991224348545, 0.023232001811265945, 0.010254470631480217, 0.01180948130786419, -0.01622370444238186, 0.01618070900440216, -0.029523702338337898, -0.02192779816687107, 0.0013543640961870551, -0.011658996343612671, 0.009588037617504597, 0.024464543908834457, 0.021110881119966507, 0.01675398461520672, -0.0013588427100330591, -0.015607433393597603, 0.008771119639277458, -0.015449782833456993, -0.008025861345231533, -0.013823112472891808, -0.007226857822388411, 0.008921604603528976, -0.0019867587834596634, -0.015120148658752441, 0.01349347922950983, 0.01888943649828434, 0.03795085847377777, -0.004353312775492668, 0.02161249704658985, -0.008577639237046242, -0.007595904171466827, 0.006592671386897564, 0.004059509374201298, 0.011006895452737808, -0.02606971561908722, -0.01757090352475643, 0.005625268444418907, -0.024450212717056274, 0.034998487681150436, -0.014038090594112873, -0.009437552653253078, -0.003280212404206395, -0.02165549248456955, 0.036632321774959564, 0.0038122839760035276, -0.0004160728130955249, 0.005886825732886791, -0.01820150576531887, -0.00029022086528129876, 0.009724190458655357, -0.0026585664600133896, 0.007990031503140926, -0.0051272353157401085, -0.024278229102492332, -0.0010704133892431855, 0.010168478824198246, -0.027631893754005432, 0.01863146387040615, -0.02214277721941471, -0.008412822149693966, 0.0003074639244005084, 0.06145516410470009, 0.020451612770557404, 0.012196442112326622, -0.005621685646474361, 0.0029452042654156685, -0.015894070267677307, -0.0023808861151337624, -0.02543911337852478, 0.0019025590736418962, 0.012518909759819508, -0.01590840332210064, -0.013393155299127102, -0.006929471157491207, 0.003127936040982604, 0.023719286546111107, -0.02149784192442894, -0.0057255919091403484, -0.012905871495604515, 0.003065234050154686, -0.01380878034979105, 0.003280212404206395, -0.01553577370941639, 0.004983916413038969, -0.029022086411714554, -0.003040153067559004, -0.016424350440502167, 0.023017022758722305, 0.003140476532280445, 0.00912941712886095, 0.0264566782861948, 0.036947622895240784, 0.006646416150033474, 0.018172841519117355, -0.009838845580816269, -0.02847747504711151, 0.022572733461856842, -0.02585473842918873, -0.016109049320220947, -0.020236635580658913, 0.010426453314721584, 0.01208178699016571, -0.01835915632545948, -0.0030491105280816555, -0.015578769147396088, 0.023017022758722305, -0.0030329872388392687, 0.001641001901589334, 0.020709587261080742, -0.009874675422906876, -0.02932305634021759, 0.004586206283420324, 0.010971065610647202, -0.012067454867064953, -0.034883830696344376, 0.013765784911811352, 0.007065623998641968, -0.03350796923041344, -0.0022286095190793276, 0.008606302551925182, 0.026843639090657234, 0.0433109849691391, -0.00330708478577435, 0.03740624338388443, 0.012153446674346924, -0.010913738049566746, 0.0055213626474142075, 0.011737821623682976, -0.026542669162154198, -0.007889707572758198, 0.008892940357327461, 0.016453014686703682, -0.0052848863415420055, 0.01032613031566143, -0.030899565666913986, 0.007882541976869106, -0.020408617332577705, 0.0029720766469836235, 0.014790515415370464, -0.031272195279598236, 0.03433921933174133, -0.001160883461125195, -0.001940180198289454, 0.0033482888247817755, 0.008291001431643963, -0.024622194468975067, 0.025940729305148125, 0.019176075235009193, 0.01883210986852646, 0.02863512560725212, 0.02910807728767395, 0.01143685169517994, -0.026800643652677536, -0.01524913590401411, 0.013851775787770748, -0.041849132627248764, -0.02702995389699936, 0.009724190458655357, 0.0045073810033500195, 0.022544071078300476, -0.033278658986091614, 0.03485516831278801, -0.011673328466713428, -0.010799082927405834, -0.028348486870527267, 0.010139815509319305, 0.012253769673407078, 0.034081246703863144, -0.02655700035393238, -0.008871442638337612, -0.005446120165288448, 0.009344395250082016, 0.007180279120802879, -0.008412822149693966, -0.0035077312495559454, -0.00925840437412262, -0.0013068896951153874, -0.013371657580137253, 0.019677691161632538, 0.02671465091407299, -0.027703551575541496, -0.0028323407750576735, 0.006198544520884752, -0.03542844206094742, 0.005449702963232994, 0.004851346369832754, 0.0047868527472019196, 0.05411723256111145, 0.03155883029103279, 0.008871442638337612, -0.023446979001164436, -0.02218577265739441, 0.01380878034979105, -0.024464543908834457, 0.016624998301267624, -0.007352261804044247, 0.016725320369005203, -0.004145500715821981, -0.028291160240769386, -0.005833080969750881, 0.007054875139147043, 0.01767122559249401, 0.024765513837337494, 0.015994394198060036, -0.005514196585863829]",Model Alignment as Prospect Theoretic Optimization.pdf
" 1:10 and the vast majority of un-
desirable examples no longer have a preferred counterpart.
We handle such imbalances by changing λD, λUto satisfy
the criteria in (8); when we drop 90% of the desirable data,
we set λu= 1, λD= 13.33for example. For Llama-7B,
we find that up to 90% of the desirable data can in fact be
discarded while still outperforming DPO (Figure 5).
We further verify this claim by aligning Mistral-7B on Ope-
nAssistant using DPO (on npairs), standard KTO (on all 2n
outputs), and KTO where only one yperxis used. Since the
output of one yin OpenAssistant is not conditioned on the
other yfor the same x, the latter captures the setting where
the data is from an inherently unpaired distribution. Despite
7
Model Alignment as Prospect Theoretic Optimization
Table 1. (top) Results from aligning Zephyr- β-SFT (Tunstall et al.,
2023) on UltraFeedback for exactly 1 epoch. Even when only
one of the two outputs in each preference is seen by KTO, it still
outperforms DPO, despite this reducing the volume of data by half
(one-y-per-x). (middle) Changing the structure of the KTO loss,
even in subtle ways, makes the aligned model worse, supporting
our design choices. (bottom) Fixing λU= 1, we try different
levels of loss and risk aversion by changing λDandβrespectively
(see Appendix C for more results).
Dataset ( →) MMLU GSM8k HumanEval BBH
Metric ( →) EM EM pass@1 EM
SFT 57.2 39.0 30.1 46.3
DPO 58.2 40.0 30.1 44.1
ORPO ( λ= 0.1) 57.1 36.5 29.5 47.5
KTO ( β= 0.1,λD= 1) 58.6 53.5 30.9 52.6
KTO (one- y-per-x) 58.0 50.0 30.7 49.9
KTO (no z0) 58.5 49.5 30.7 49.0
KTO (concave, v=−logσ)58.3 42.5 30.6 43.2
KTO (risk-neutral, v(·) =·)57.3 42.0 28.8 6.1
KTO (no πref,λD= 1.75) 57.5 47.5 29.5 51.6
KTO ( β= 0.01) 57.3 54.0 33.2 49.8
KTO ( β= 0.50) 58.3 45.0 32.7 51.8
KTO ( λD= 0.50) 57.4 47.0 32.2 30.5
KTO ( λD= 0.75) 58.3 52.0 30.3 50.6
KTO ( λD= 1.33) 58.5 52.0 32.8 45.4
KTO ( λD= 2.00) 58.1 43.0 32.1 45.3
the one- y-per-xsetup decreasing the amount of training data
by 72%, the KTO-aligned model still outperforms both its
DPO counterpart and the official instruction-tuned Mistral-
7B (Jiang et al., 2023), as seen in Table 2.
Changing the design of KTO makes it significantly worse.
For one, removing the reference point z0—which is neces-
sary for KTO to qualify as a HALO—causes a 3.6 and 4.0
point drop on BBH and GSM8K respectively (Table 1, mid-
dle). Even changes that allow KTO to remain a HALO are
typically suboptimal. For example, removing the symmetry
of the value function—going from 1−σ(·)to−logσ(·)(i.e.,
making the value function concave everywhere, as in DPO)—
causes a 9.4 and 11.0 point drop on BBH and GSM","[-0.0003347471938468516, 0.03209850937128067, 0.06389926373958588, 0.009252887219190598, -0.002458379603922367, -0.0001225933083333075, -0.016064142808318138, 0.018833309412002563, -0.011590301990509033, 0.020724084228277206, 0.016927646473050117, -0.0007253243238665164, -0.03436148539185524, -0.007979963906109333, 0.04451509565114975, -0.01152330543845892, 0.03269403055310249, -0.03632669895887375, -0.017910253256559372, 0.04106108099222183, -0.021930010989308357, -0.0214238204061985, -0.00532990088686347, 0.04645053297281265, 0.004846041090786457, -0.004648775327950716, 0.02151314727962017, -0.0060370806604623795, 0.016972310841083527, -0.04534882307052612, 0.05597884953022003, -0.03832169249653816, -0.023761235177516937, -0.048237092792987823, 0.0011054333299398422, 0.04168637841939926, 0.026723945513367653, 0.04567635804414749, -0.007138791959732771, 0.002752417465671897, -0.013481076806783676, -0.04302629455924034, -0.038857657462358475, -0.006401836406439543, -0.0010263408767059445, 0.02280840277671814, 0.048058439046144485, -0.005050751380622387, -0.0013380582677200437, -0.007243007887154818, 0.0028901314362883568, 0.05279281735420227, -0.010622582398355007, 0.002932934323325753, 0.010235494002699852, -0.014642340131103992, 0.041507720947265625, 0.014768887311220169, 0.06336329132318497, -0.010600250214338303, -0.03364686295390129, -0.0433240570127964, 0.03242604434490204, -0.0050842491909861565, -0.021528035402297974, -0.005910532549023628, -0.06955669820308685, 0.0034465701319277287, 0.01140420138835907, 0.03593961149454117, -0.006506052333861589, 0.010235494002699852, 0.031175455078482628, -0.006044524721801281, 0.019667036831378937, -0.03430193290114403, 0.03251537308096886, 0.05636593699455261, 0.034778349101543427, -0.019801028072834015, 0.033617086708545685, -7.374208507826552e-05, 0.04796911031007767, -0.028525391593575478, 0.023686794564127922, -0.025488242506980896, -0.029433559626340866, -0.01664477400481701, -0.05815249681472778, -0.014724223874509335, -0.05711033567786217, -0.006346006412059069, 0.01246124878525734, -0.03165186941623688, 0.047760676592588425, -0.016034366562962532, 0.018252678215503693, -0.019845692440867424, 0.033855292946100235, -0.014329692348837852, -0.01727006956934929, -0.024714065715670586, 0.006357172504067421, -0.017150966450572014, 0.0495770126581192, -0.0037406079936772585, 0.00167489901650697, 0.02041143737733364, 0.016927646473050117, 0.012051829136908054, -0.023746347054839134, 0.00020761768973898143, -0.06187449395656586, 0.04106108099222183, -0.005463893059641123, -0.06717462092638016, -0.04067399352788925, 0.009044455364346504, 0.00989307090640068, -0.03296201303601265, -0.03147321566939354, -0.042996518313884735, 0.03230694308876991, 0.020009459927678108, 0.0006783340941183269, 0.00947620626538992, 0.021349379792809486, -0.02737901732325554, 0.007979963906109333, -0.02709614485502243, 0.024892721325159073, 0.03989981859922409, -0.013101432472467422, -0.02685793675482273, -0.046897172927856445, 0.02979087084531784, -0.02170669101178646, 0.04123973846435547, 0.004808821249753237, 0.0028603554237633944, -0.03358731046319008, -0.06604313105344772, -0.03653513267636299, -0.003483789972960949, -0.07515458017587662, 0.021632252261042595, -0.0029608493205159903, 0.02560734562575817, -0.04787978157401085, 0.054698482155799866, 0.019905244931578636, -0.04147794470191002, -0.03742841258645058, 0.0046562193892896175, 0.020336996763944626, -0.014902879483997822, -0.005404341034591198, 0.016347015276551247, -0.00020424464310053736, -0.024460969492793083, 0.024520521983504295, 0.022302212193608284, 0.011173437349498272, 0.030282175168395042, 0.016347015276551247, 0.005087971221655607, -0.02449074573814869, 0.02516070567071438, -0.0798591896891594, -0.03733908385038376, 0.03671378642320633, -0.012386809103190899, -0.05231640115380287, -0.022019339725375175, -0.012729233130812645, 0.0087839150801301, -0.04106108099222183, -0.017314733937382698, -0.03855989873409271, -0.025681786239147186, -0.013160984963178635, 0.01968192495405674, 0.020709196105599403, 0.02565200999379158, -0.05047029256820679, -0.008813691325485706, 0.0024937386624515057, -0.009587866254150867, -0.019622372463345528, 0.038083482533693314, 0.028599832206964493, 0.023016834631562233, 0.057914286851882935, -0.009974954649806023, -0.019667036831378937, -0.007246729917824268, 0.05380520224571228, 0.07682203501462936, -0.024460969492793083, 0.03278335928916931, 0.015163419768214226, 0.02026255615055561, 0.07283205538988113, -0.09409210830926895, -0.0178060382604599, 0.012215597555041313, 0.0011314873117953539, -0.02026255615055561, -0.02560734562575817, 0.0043435716070234776, -0.00376666197553277, 0.027036592364311218, 0.04028690606355667, 0.0286296084523201, 0.0024323256220668554, -0.0006643766537308693, -0.07711979746818542, 0.004745547194033861, 0.01475400011986494, 0.06586447358131409, -0.002826857380568981, 0.042996518313884735, 0.022838179022073746, 0.03421260416507721, -0.013622512109577656, 0.006085466593503952, 0.019413940608501434, -0.017478501424193382, 0.027795881032943726, -0.03382551670074463, 0.030550159513950348, 0.001178012345917523, 0.007034576032310724, 0.016064142808318138, 0.013518296182155609, -0.05273326486349106, -0.015051759779453278, -0.056812576949596405, -0.02108139544725418, -0.04796911031007767, -0.049785442650318146, -0.004890705458819866, 0.02699192985892296, -0.03200918063521385, -0.04177570343017578, 0.025011826306581497, -0.035820506513118744, -0.023805899545550346, -0.010436481796205044, -0.02392500266432762, 0.010421594604849815, -0.016868093982338905, -0.050887156277894974, -0.045408375561237335, -0.05958174169063568, 0.016540559008717537, 0.01376394834369421, 0.00909656286239624, -0.03069903887808323, 0.0030352892354130745, 0.014865660108625889, -0.0144339082762599, -0.024148322641849518, 0.028718935325741768, -0.035641852766275406, 0.02218310721218586, 0.00042570350342430174, -0.01664477400481701, -0.01368950866162777, -0.037071097642183304, 0.029522888362407684, 0.014493459835648537, -0.002992486348375678, 0.030207734555006027, -0.02271907590329647, -0.05865868553519249, 0.0008439630037173629, 0.018535548821091652, -0.025711562484502792, -0.035880059003829956, -0.017984693869948387, 0.017195630818605423, 0.03867900371551514, -0.008314942941069603, 0.03132433444261551, -0.019324613735079765, -0.013034436851739883, 0.03936384990811348, -0.007328614126890898, -0.006446500308811665, 0.04216279089450836, -0.026634616777300835, 0.045974116772413254, -0.02103673294186592, -0.020277444273233414, 0.011344649828970432, 0.012520801275968552, -0.045944344252347946, -0.03302156552672386, -0.009907958097755909, 0.05270349234342575, 0.02498205006122589, -0.008307499811053276, -0.010250382125377655, 0.035820506513118744, -0.0053224568255245686, 0.0524652823805809, 0.021915122866630554, -0.0031450882088392973, -0.0014031932223588228, -0.023359259590506554, 0.025205370038747787, -0.0021475928369909525, 0.05544288083910942, -0.009498538449406624, -0.035731181502342224, 0.03909586742520332, -0.012833449058234692, 0.017016975209116936, -0.04484263062477112, -0.043770696967840195, -0.1145184338092804, -0.05621705576777458, 0.03317044675350189, 0.010786349885165691, -0.0030390112660825253, -0.022599970921874046, -0.009379434399306774, -0.021959787234663963, -0.031026573851704597, -0.00682242214679718, -0.030639486387372017, 0.00024983909679576755, -0.024118546396493912, -0.04031668230891228, 0.02425253763794899, -0.018014470115303993, 0.05693168193101883, 0.02103673294186592, 0.012379365041851997, -0.08206260949373245, -0.017642270773649216, 0.007756643462926149, 0.009639974683523178, -0.024580074474215508, -0.008791359141469002, 0.04129928722977638, -0.021930010989308357, 0.04052511230111122, 0.02203422784805298, -0.03701154887676239, -0.023061498999595642, 0.04293696954846382, 0.028182968497276306, 0.03254514932632446, 0.021572699770331383, -0.002687282394617796, -0.0036717508919537067, -0.014634896069765091, 0.016927646473050117, 0.007875747978687286, 0.02670905739068985, -0.006327396258711815, 0.0069154719822108746, 0.027319464832544327, 0.052673716098070145, -0.028182968497276306, 0.006818700116127729, -0.03805370628833771, -0.008486155420541763, -0.007056908216327429, 0.015617502853274345, -0.04826686903834343, 0.013577848672866821, -0.05303102731704712, 0.00045292061986401677, 0.03406372666358948, 0.00768964784219861, 0.02641129679977894, 0.02545846626162529, -0.007592875976115465, -0.0060370806604623795, -0.0209325160831213, -0.0019577709026634693, 0.002927351277321577, -0.0016916480381041765, 0.013987268321216106, -0.008337275125086308, -0.045884791761636734, -0.018743980675935745, -0.02459496259689331, 0.03281313553452492, -0.043294280767440796, 0.038291916251182556, -0.009357103146612644, 0.010987337678670883, -0.0005959849222563207, 0.0746186152100563, 0.027453456073999405, 0.06509029865264893, -0.035492971539497375, -0.007544489577412605, -0.10909920185804367, -0.030520383268594742, -0.061338525265455246, -0.04653986170887947, 0.0030594822019338608, 0.0274236798286438, 0.012126268818974495, 0.029150687158107758, 0.051036033779382706, -0.041984137147665024, 0.05288214609026909, -0.022510644048452377, 0.02064964361488819, -0.018684430047869682, -0.004161193501204252, 0.018639765679836273, 0.021111171692609787, 0.036118268966674805, -0.05371587350964546, -0.0336766354739666, -0.014515792019665241, -0.028718935325741768, -0.0389767624437809, 0.031890079379081726, -0.021394044160842896, -0.010481146164238453, 0.04793933406472206, -0.0760478600859642, -0.003978815861046314, 0.048921938985586166, 0.0010114529868587852, -0.02410365827381611, -0.06580492109060287, -0.020083900541067123, -0.025384025648236275, 0.004994921386241913, 0.004868373274803162, 0.0030948412604629993, 0.006908027920871973, 0.004246799740940332, -0.01588548719882965, -0.016436342149972916, -0.02617308869957924, 0.01741895079612732, -0.014887991361320019, 0.0041723595932126045, 0.034659244120121, -0.010265270248055458, -0.020232779905200005, 0.036028940230607986, 0.03870877996087074, -0.011240433901548386, 0.009446430951356888, -0.06943759322166443, 0.07592875510454178, -0.011724293231964111, 0.035105884075164795, -0.013354528695344925, -0.001889844425022602, -0.017642270773649216, -0.017597606405615807, -0.01051836647093296, -0.026202864944934845, 0.04240100085735321, 0.013816055841743946, -0.021200500428676605, -0.02511604130268097, -0.00035056567867286503, -0.0025384025648236275, -0.05615750327706337, 0.01660011149942875, -0.0409121997654438, -0.035582300275564194, 0.04546792805194855, 0.049874771386384964, 0.008955126628279686, 0.008761582896113396, 0.002227615797892213, 0.018803533166646957, -0.07086683809757233, 0.00014050542085897177, 0.0005289889522828162, 0.0447533018887043, 0.05585974454879761, 0.05794406309723854, 0.018208013847470284, -0.03692222014069557, -0.011627521365880966, 0.00791296735405922, -0.04904104396700859, 0.07330846786499023, -0.01886308565735817, 0.020009459927678108, 0.000628087145742029, 0.015959927812218666, 0.009431542828679085, 0.0015669611748307943, -0.02675372175872326, 0.034629467874765396, -0.01601947844028473, 0.01321309246122837, 0.0394531786441803, 0.04311562329530716, 0.008605259470641613, -0.0068894182331860065, -0.041358839720487595, -0.011709405109286308, 0.027691664174199104, -0.024431195110082626, -0.008099067024886608, 0.0028938534669578075, 0.01368950866162777, -0.011039446108043194, -0.0015353241469711065, -0.030490607023239136, 0.014247807674109936, -0.010376930236816406, 0.04787978157401085, -0.04409823194146156, -0.0144413523375988, -0.034629467874765396, 0.00823305919766426, 0.014694447629153728, -0.009989842772483826, -0.03296201303601265, -0.11445888131856918, -0.00272450246848166, -0.028465840965509415, 0.042430777102708817, -0.022867955267429352, 0.0006327396258711815, 0.018639765679836273, -0.02498205006122589, -0.009275218471884727, 0.006308786571025848, -0.016391679644584656, -0.010935230180621147, 0.004224467556923628, 0.04132906347513199, -0.001261757337488234, 0.026872824877500534, -0.01008661463856697, 0.01771670952439308, -0.02487783506512642, 0.0438004732131958, -0.009438986890017986, 0.00033032731153070927, 0.013726728036999702, 0.024416306987404823, -0.018178237602114677, -0.023329483345150948, 0.014069152064621449, -0.047373589128255844, 0.008888131007552147, -0.000929103756789118, 0.0007439343607984483, 0.024148322641849518, -0.014500903896987438, 0.017210518941283226, -0.0001385281066177413, -0.019086405634880066, 0.006599102169275284, 0.002905019326135516, 0.011054334230720997, -0.009937734343111515, -0.004064421635121107, 0.009178446605801582, 0.03334910050034523, -0.04695672541856766, -0.009371990337967873, 0.01612369529902935, -0.016734102740883827, 0.0013306142063811421, -0.008389383554458618, 0.018699318170547485, -0.014218032360076904, 0.03504633158445358, -0.016808543354272842, -0.025324473157525063, 0.0057504866272211075, -0.030118407681584358, -0.021200500428676605, -0.061814941465854645, 0.017389174550771713, 0.018267566338181496, 0.017210518941283226, -0.05779518559575081, 0.041358839720487595, 0.046897172927856445, -0.02396966703236103, 0.01582593470811844, -0.010138722136616707, -0.018639765679836273, -0.003595449961721897, -0.003364686155691743, -0.017940029501914978, 0.02554779313504696, -0.05577041581273079, 0.030103519558906555, -0.0068484763614833355, 0.020634757354855537, -0.034569915384054184, -0.03701154887676239, 0.036892443895339966, 0.005649992730468512, 0.010801238007843494, 0.002352302661165595, 0.000524801725987345, 0.01582593470811844, -0.002854772377759218, -0.0032251111697405577, -0.0034726241137832403, -0.037607066333293915, -0.014694447629153728, 0.0019633539486676455, -0.009111450985074043, 0.025622233748435974, 0.01843133382499218, -0.009878182783722878, -3.794693111558445e-05, -0.008813691325485706, -0.002811969490721822, 0.0026109814643859863, -0.006774036213755608, 0.012386809103190899, -0.017284957692027092, 0.00697874603793025, -0.012818560935556889, -0.04636120796203613, -0.011500973254442215, 0.0011426534038037062, 0.012059273198246956, 0.033140670508146286, 0.016570335254073143, 0.021647140383720398, 0.01694253459572792, -0.010116389952600002, -0.053626544773578644, 0.01939905248582363, 0.02988019958138466, 0.025041602551937103, -0.03647558018565178, 0.008121399208903313, -0.003165559144690633, -0.007987407967448235, 0.017910253256559372, -0.003245582105591893, -0.02589021809399128, -0.009133783169090748, -0.020083900541067123, 0.028852928429841995, 0.02242131531238556, 0.030967023223638535, 0.007756643462926149, -0.030148183926939964, 0.03501655533909798, 0.010451369918882847, 0.005843536928296089, -0.020441211760044098, -0.01886308565735817, -0.020128564909100533, 0.007120181806385517, 0.034867677837610245, 0.04499151185154915, -0.018997076898813248, 0.04835619777441025, 0.006870808079838753, 0.01746361516416073, 0.009654862806200981, 0.029537774622440338, 0.014597675763070583, -0.023076387122273445, 0.011500973254442215, 0.00851593166589737, 0.002106650732457638, -0.04633143171668053, -0.059313759207725525, 0.0007053185836412013, -0.026783498004078865, -0.02252553217113018, -0.061814941465854645, -0.030148183926939964, -0.014992207288742065, -0.00756682176142931, 0.038143035024404526, 0.011582857929170132, -0.007890635170042515, -0.009982398711144924, -0.007823639549314976, -0.018877973780035973, 0.00030404070275835693, -0.012498469091951847, 0.017076525837183, 0.0008118607802316546, -0.003243721090257168, 0.05836092680692673, -0.010198274627327919, -0.05880756676197052, -0.006736816372722387, 0.018267566338181496, -0.028048977255821228, -0.0025867884978652, -0.0394531786441803, -0.01750827766954899, 0.0055681089870631695, 0.037219978868961334, 0.03519521281123161, -0.02127494104206562, 0.008635034784674644, 0.0031785862520337105, -0.009252887219190598, -0.020813412964344025, -0.0018684429815039039, -0.013972380198538303, 0.014761444181203842, 0.004030923824757338, 0.013615068048238754, -0.026143314316868782, -0.0007899940828792751, 0.0052964030764997005, -0.0577654093503952, 0.013324752449989319, 0.0036624460481107235, -0.011553081683814526, -0.04406845569610596, 0.01164240948855877, 0.006029636599123478, -0.014791219495236874, -0.00010322728485334665, 0.01832711696624756, -0.004950257018208504, -0.01948838122189045, -0.017046749591827393, 0.027900096029043198, -0.010175942443311214, 0.007667315658181906, -0.0019131068838760257, 0.011299985460937023, 0.02545846626162529, -0.005795150995254517, -0.015706831589341164, 0.007328614126890898, -0.0065358285792171955, 0.001933577936142683, 0.00952831469476223, 0.03769639506936073, 0.007321170065551996, 0.017969805747270584, 0.000203081508516334, 0.015453735366463661, 2.310255695192609e-05, 0.015029427595436573, 0.005877034738659859, -0.034331709146499634, 0.005843536928296089, -0.005623938981443644, -0.006245512515306473, 0.002236920641735196, -0.009357103146612644, 0.019265061244368553, -0.01400215644389391, 0.009826074354350567, 0.004094197880476713, -0.00041337439324706793, -0.03483790159225464, 0.0039750938303768635, 0.050261858850717545, -0.008329831063747406, 0.005441560875624418, 0.014061708003282547, 0.004324961453676224, 0.023791011422872543, 0.06467343866825104, -0.02041143737733364, 0.00525918323546648, -0.021051621064543724, 0.01380861271172762, -0.0016032506246119738, -0.04359203949570656, -0.006413002498447895, 0.0022536697797477245, -0.0052554612047970295, -0.011530749499797821, -0.005091693252325058, 0.0007811543182469904, -0.008649922907352448, 0.013548072427511215, 0.007149958051741123, -0.019175732508301735, -0.017002087086439133, -0.004838597495108843, 0.019071517512202263, 0.0042728534899652, 0.02291261963546276, -0.02656017802655697, -0.14471128582954407, -0.061576735228300095, 0.022927507758140564, 0.016629885882139206, -0.00473810313269496, 0.00018179633480031043, 0.021051621064543724, 0.01727006956934929, -0.017016975209116936, -0.004332405515015125, 0.008322387002408504, -0.01968192495405674, -0.008739250712096691, -0.004324961453676224, 0.018371781334280968, -0.05779518559575081, 0.0010486729443073273, 0.011121329851448536, -0.005981250666081905, -0.03763684257864952, -0.018833309412002563, -0.004749269224703312, -0.0028733822982758284, 0.01679365523159504, -0.049011267721652985, -0.021394044160842896, 0.036981772631406784, -0.005095415282994509, 0.010123834013938904, 0.012796228751540184, 0.0019410218810662627, -0.0022220327518880367, -0.0057504866272211075, 0.016823431476950645, -0.03200918063521385, -0.010019618086516857, -0.002140148775652051, -0.02507137879729271, -0.003483789972960949, 0.011292541399598122, -0.0041463058441877365, -0.04782022908329964, 0.03930429741740227, -0.0073174480348825455, 0.02944844774901867, -0.0332002229988575, -0.0012989772949367762, -0.022510644048452377, -0.006867086049169302, -0.016674550250172615, 0.0023634687531739473, -0.031056350097060204, -0.005828648805618286, -0.015289967879652977, 0.013615068048238754, -0.01518575195223093, 0.007793863769620657, -0.01877375692129135, -0.0056090508587658405, -0.006219458766281605, 0.009304994717240334, 0.039780713617801666, -0.0013389887753874063, -0.024088770151138306, -0.03930429741740227, -0.03552274778485298, -0.023031722754240036, 0.02179601974785328, 0.012989772483706474, -0.045110613107681274, -0.017046749591827393, 0.03007374331355095, 0.0012459388235583901, 0.003576840041205287, 0.0012226763647049665, -0.012915332801640034, 0.005910532549023628, 0.028168080374598503, -0.0519590899348259, 0.04287741705775261, 0.02265952341258526, -0.03790482506155968, 0.03647558018565178, 0.050529845058918, 0.017210518941283226, 0.03445081412792206, -0.017984693869948387, -0.021528035402297974, -0.0012757148360833526, 0.0024639626499265432, 0.00682242214679718, -0.003208362264558673, 0.012692012824118137, -0.026009321212768555, -0.007596597541123629, -0.024088770151138306, -0.009654862806200981, 0.021185612305998802, -0.009505982510745525, -0.004592945333570242, -0.008411715738475323, -0.008456379175186157, -0.040108248591423035, -0.01727006956934929, 0.012982328422367573, 0.02267441153526306, 0.009178446605801582, -0.031026573851704597, 0.03358731046319008, -0.012505913153290749, -0.012595240958034992, -0.011821065098047256, -0.009237999096512794, 0.025264922529459, -0.0034577359911054373, -0.0033628251403570175, 0.04770112410187721, 0.01095011830329895, 0.016719214618206024, -0.0036810559686273336, -0.001309212762862444, 0.020054124295711517, -0.01145630981773138, -0.001396679668687284, 0.01039926242083311, 0.015662167221307755, -0.004592945333570242, 0.03311089426279068, -0.03156254068017006, 0.023880338296294212, 0.022242659702897072, 0.013629956170916557, 0.0057244328781962395, -0.0009211944998241961, 0.0034167941194027662, -0.011999721638858318, 0.004719493445008993, 0.01007917057722807, 0.0085382629185915, 0.02194489911198616, 0.0008751347777433693, 0.004090475849807262, 0.012237928807735443, 0.0047864895313978195, -0.0009351519984193146, -0.004168637562543154, 0.017061637714505196, -0.015468623489141464, 0.017642270773649216, 0.0006685638800263405, 0.017865590751171112, -0.011046890169382095, -0.0016516365576535463, 0.00791296735405922, -0.0033907401375472546, -0.011396757327020168, -0.006911749951541424, -0.019279949367046356, 0.023180603981018066, 0.02530958503484726, -0.0013445717049762607, 0.019071517512202263, -0.007362111937254667, -0.04773090034723282, 0.04695672541856766, -0.006204570643603802, -0.02569667436182499, 0.0016032506246119738, 0.017925141379237175, 0.025235146284103394, -0.004056977573782206, -0.0442768856883049, 0.0216620285063982, -0.002811969490721822, 0.05922443047165871, -2.766782017715741e-05, -0.014880547299981117, 0.020619869232177734, -0.008501043543219566, 0.0485944040119648, 0.017404062673449516, -0.007042020093649626, -0.030579935759305954, 0.00706063024699688, 0.05696145445108414, -0.041507720947265625, 0.03989981859922409, -0.0013529462739825249, 0.004217023495584726, 0.036594685167074203, 0.026872824877500534, 0.015245303511619568, 0.0009798159589990973, 0.010994781740009785, -0.0019819638691842556, -0.009945178404450417, 0.021021844819188118, 0.04067399352788925, -0.020426325500011444, -0.022540420293807983, -0.008017183281481266, 0.029195351526141167, -0.0033293270971626043, -0.015662167221307755, -0.013473632745444775, 0.03209850937128067, 0.0076449839398264885, -0.04371114447712898, -0.003336771158501506, 0.028704047203063965, -0.00859037134796381, 0.04305607080459595, -0.008761582896113396, 0.013972380198538303, -0.0026668114587664604, -0.05925420671701431, 0.011873173527419567, -0.012602685019373894, -0.0008946752641350031, -0.021736467257142067, -0.002918046433478594, -0.021542923524975777, 0.02267441153526306, 0.019771253690123558, 0.019309725612401962, -0.034480590373277664, 0.04725448414683342, -0.017776262015104294, 0.020336996763944626, 0.018565325066447258, -0.006721928250044584, 0.032366495579481125, 0.010630026459693909, 0.012223041616380215, -0.014954987913370132, -0.025235146284103394, 0.00020517513621598482, -0.0068335882388055325, -0.028748711571097374, -0.0020191839430481195, 0.032842908054590225, 0.02011367678642273, 0.001793072558939457, -0.008180951699614525, -0.016093919053673744, 0.010816126130521297, 0.01944371685385704, 0.061338525265455246, -0.038619451224803925, 0.009654862806200981, -0.017314733937382698, 0.01978614181280136, 0.015915263444185257, -0.002609120449051261, 0.0003263726830482483, -0.0031506712548434734, 0.005791428964585066, 0.0543709471821785, 0.030445942655205727, 0.027125921100378036, -0.022257547825574875, 0.01636190339922905, -0.014091484248638153, -0.005635105073451996, -0.02185557223856449, -0.014106372371315956, 0.007537045981734991, 0.022004451602697372, 0.03930429741740227, 0.01625768654048443, -0.012334700673818588, 0.023805899545550346, -0.015118755400180817, 0.02194489911198616, 0.005817482713609934, 0.008374495431780815, 0.042133018374443054, -0.016912758350372314, 0.032068733125925064, 0.021051621064543724, 0.010280158370733261, -0.00803951546549797, -0.00501725310459733, 0.02675372175872326, 0.014069152064621449, -0.019696813076734543, -0.013682064600288868, -0.0036066160537302494, -0.006844754330813885, -0.0013324752217158675, 0.03293223679065704, 0.04418756067752838, -0.014255251735448837, -0.018997076898813248, -0.007637539878487587, -0.0012952552642673254, -0.009520870633423328, 0.0026109814643859863, -0.0026668114587664604, -0.01196250133216381, 0.00227414071559906, 0.01996479742228985, -0.007831083610653877, -0.022436203435063362, 0.00929010659456253, 0.007068073842674494, 0.021959787234663963, -0.0008886270225048065, -0.015513286925852299, 0.002357885707169771, 0.00225553079508245, -0.008367051370441914, 0.009193334728479385, 0.018118685111403465, -0.016347015276551247, 0.0005964501760900021, -0.014180812053382397, 0.004451509565114975, 0.017255183309316635, 0.021245164796710014, 0.025428690016269684, 0.0005508557078428566, 0.009930290281772614, 0.013079100288450718, -0.02848072722554207, -0.013175873085856438, 0.0023988275788724422, -0.005657436791807413, -0.014530680142343044, -0.0015483511378988624, -0.0002400688681518659, 0.014657228253781796, 0.03203895688056946, -0.018595101311802864, -0.04383024573326111, 0.021379156038165092, -0.020143453031778336, -0.004228189587593079, -0.034331709146499634, -0.0255031306296587, 0.013555516488850117, 0.029329342767596245, -0.0075296019203960896, -0.022748852148652077, -0.00584725895896554, 0.03483790159225464, 0.0030818143859505653, 0.03766661882400513, 0.014299916103482246, -0.022257547825574875, 0.08378961682319641, -0.05359676852822304, -0.01321309246122837, 0.020828301087021828, -0.0028901314362883568, 0.01896730065345764, 0.003377713030204177, -0.006260400637984276, -0.02632196992635727, 0.0255031306296587, -0.006379504222422838, 0.029031584039330482, 0.005929142702370882, -0.0005462031695060432, 0.03144343942403793, 0.004161193501204252, -0.007674759719520807, 0.05186976492404938, 0.02373145893216133, -0.0018879834096878767, 0.011433977633714676, -0.01612369529902935, -0.00847126729786396, -0.004090475849807262, -0.003733163932338357, -0.00211781682446599, -0.023954778909683228, 0.013845832087099552, -0.006383226253092289, 0.0394531786441803, -0.021617364138364792, -0.0288678165525198, -0.048237092792987823, -0.02955266274511814, -0.0015939456643536687, 0.006081744562834501, -0.01722540706396103, 0.026694169268012047, -0.017404062673449516, -0.040406011044979095, -0.01881842128932476, -0.0006499539013020694, 0.012528245337307453, 0.016198134049773216, -0.017865590751171112, 0.005970084574073553, 0.021676916629076004, 0.016853205859661102, 0.008649922907352448, 0.008940239436924458, 0.042371224611997604, -0.02785543166100979, 0.016719214618206024, -0.013816055841743946, -0.004280297551304102, 0.014605119824409485, 0.0002442561089992523, 0.010116389952600002, 0.02492249757051468, -0.009312438778579235, -0.011478642001748085, -0.02580088935792446, -0.021394044160842896, 0.013622512109577656, 0.006059412844479084, -0.016183247789740562, -0.006476276554167271, 0.02248086780309677, -0.02824252098798752, 0.05023208260536194, -0.018997076898813248, 0.021632252261042595, -0.027453456073999405, -0.010421594604849815, 0.005690934602171183, -0.010957561433315277, -0.01475400011986494, 0.007443995680660009, 0.007682203780859709, 0.020828301087021828, -0.0063906703144311905, 0.01159774512052536, -0.008739250712096691, 0.0014785636449232697, -0.022942395880818367, 0.011307429522275925, 0.007082961965352297, -0.02507137879729271, -0.058599136769771576, 0.024029219523072243, 0.008046959526836872, -0.007388165686279535, 0.024654515087604523, 0.00473810313269496, -0.002657506614923477, -0.00395648367702961, -0.006308786571025848, 0.006651210132986307, 0.023686794564127922, 0.010443925857543945, -0.018074022606015205, -0.012491025030612946, 0.023031722754240036, 0.027170585468411446, -0.006554438266903162, -0.019845692440867424, -0.03254514932632446, 0.004793933127075434, 0.013704396784305573, -0.003660585032775998, 0.0009379434632137418, -0.0036121990997344255, 0.020232779905200005, 0.0182824544608593, 0.011687073856592178, 0.01877375692129135, 0.017969805747270584, 0.04558702930808067, -0.0009495746926404536, 0.013421524316072464, 0.018803533166646957, 0.0054117850959300995, 0.009692082181572914, -0.0170914139598608, 0.01640656776726246, 0.021021844819188118, -0.02675372175872326, 0.006435334216803312, -0.014299916103482246, -0.007086683996021748, -6.222715455805883e-05, 0.010912897996604443, 0.01703186333179474, -0.027885207906365395, 0.0017902810359373689, 0.0356120765209198, 0.013629956170916557, -0.015215527266263962, -0.023999443277716637, 0.0022294768132269382, 0.005024697165936232, 0.026381520554423332, -0.00964741874486208, 0.019175732508301735, -0.00682242214679718, -0.01380861271172762, 0.016614999622106552, -0.023359259590506554, 0.018416445702314377, -0.00020971131743863225, -0.0015129921957850456, 0.0024062716402113438, 0.0006676333723589778, -0.01126276608556509, -0.014768887311220169, 0.0062082926742732525, 0.007012244313955307, -0.045408375561237335, 0.0062752882950007915, 0.018461110070347786, 0.04680784419178963, 0.004164915531873703, -0.00229275063611567, 0.035254765301942825, 0.004202135838568211, -0.03239626809954643, -0.017165854573249817, -0.0052405730821192265, 0.02097718045115471, -0.0139574920758605, -0.0061934045515954494, 0.027274800464510918, 0.026068873703479767, -0.002201561816036701, -0.02218310721218586, -0.005489946808665991, -0.006148740649223328, 0.009126339107751846, 0.0013892357237637043, -0.004090475849807262, 0.01085334550589323, 0.002134565729647875, 0.015721719712018967, 0.0178060382604599, 0.005002364981919527, 0.011865729466080666, 0.01746361516416073, 0.00847126729786396, 0.01489543542265892, 0.006591658107936382, -0.0029441004153341055, -0.005493668839335442, 0.026485737413167953, 0.0023132218047976494, 0.02714080922305584, 0.021379156038165092, 0.0021513148676604033, 0.01306421309709549, 0.00404208991676569, -0.008940239436924458, 0.010004729963839054, -0.021498259156942368, 0.009468763135373592, 0.0034726241137832403, -0.014843327924609184, 0.014687003567814827, -0.017076525837183, -0.005888200830668211, 0.008813691325485706, 0.01601947844028473, 0.027006816118955612, -0.005054473411291838, 0.01612369529902935, 0.01832711696624756, -0.0105853620916605, 0.017731597647070885, 0.011724293231964111, 0.009997286833822727, -0.011419089511036873, -0.015044315718114376, 7.141583773773164e-05, -0.009178446605801582, 0.043234728276729584, -0.004321239423006773, 0.010302490554749966, 0.006424168590456247, -0.012133712880313396, 0.0356120765209198, 0.023791011422872543, 0.01188806165009737, -0.013384304940700531, -0.003688500029966235, -0.014605119824409485, -0.017284957692027092, 0.016525670886039734, -0.01892263814806938, -0.02103673294186592, -0.019577709957957268, 0.007831083610653877, 0.014285027980804443, -0.023642130196094513, 0.022748852148652077, -0.009126339107751846, -0.0008965362794697285, 0.005337344948202372, 0.07467816770076752, 0.016287462785840034, 0.011627521365880966, -0.009543202817440033, 0.00964741874486208, -0.0028696605004370213, -0.011538193561136723, -0.015103867277503014, -0.008002295158803463, 0.010049394331872463, -0.026768609881401062, -0.018877973780035973, -0.02280840277671814, 0.0009104937198571861, 0.0322473905980587, -0.025562681257724762, 0.024416306987404823, 0.02328481897711754, 0.0018433195073157549, -0.0126324612647295, 0.023374147713184357, -0.009662306867539883, 0.0036159208975732327, -0.029522888362407684, -0.02136426791548729, -0.0144339082762599, 0.017984693869948387, 0.00604080269113183, -0.006100354716181755, 0.03638625144958496, 0.03540364280343056, 0.011299985460937023, 0.018297342583537102, -0.012237928807735443, -0.03165186941623688, 0.023255042731761932, -0.02498205006122589, -0.0018033080268651247, -0.00847126729786396, 0.0006890348740853369, 0.015394183807075024, -0.02950800023972988, -0.0065209404565393925, -0.029493112117052078, 0.03257492557168007, -0.01689787022769451, -0.0024230205453932285, 0.0016013896092772484, -0.005393174942582846, -0.02319549024105072, -0.004351015668362379, 0.008932795375585556, -0.016912758350372314, -0.033378876745700836, 0.003949039615690708, -0.0032399992924183607, -0.029895087704062462, -0.005735598970204592, -0.006632600445300341, 0.037607066333293915, 0.031175455078482628, -0.013160984963178635, 0.022867955267429352, -0.0024155767168849707, -0.0077864197082817554, 0.012662236578762531, 0.01771670952439308, -0.021810907870531082, 0.009520870633423328, 0.003111590165644884, 0.005787706933915615, -0.028227632865309715, 0.010012174025177956, -0.02830207161605358, 0.024907609447836876, -0.02718547359108925, -0.009342215023934841, 0.006524662487208843, -0.03585028275847435, 0.02209378033876419, 0.008575483225286007, -0.0014134286902844906, 0.020724084228277206, 0.009059342555701733, -0.024460969492793083, 0.02578600123524666, 0.01834200508892536, 0.03832169249653816, 0.01905662938952446, 0.005992416758090258, 0.03537386655807495, -0.042996518313884735, -0.0049837552942335606, 0.026098649948835373, -0.03290246054530144, -0.019711701199412346, -0.005311291199177504, 0.005419229157269001, 0.005709544755518436, -0.046420756727457047, 0.013912828639149666, -0.00725417397916317, -0.01549839973449707, -0.0274236798286438, 0.006613990291953087, 0.008322387002408504, 0.013860720209777355, -0.042847640812397, -0.01703186333179474, 0.014486015774309635, 0.012103937566280365, -0.008761582896113396, 0.01277389656752348, -0.0029534052591770887, -0.015245303511619568, -0.008649922907352448, -0.008359607309103012, 0.006089188624173403, 0.02474384196102619, -0.030550159513950348, 0.001081240363419056, 0.008314942941069603, -0.019890356808900833, -0.007559377700090408, -0.0067033180966973305, 0.026500625535845757, 0.03930429741740227, 0.017776262015104294, 0.011553081683814526, -0.016391679644584656, -0.012446360662579536, 0.023567691445350647, -0.014017044566571712, 0.021379156038165092, -0.003498678095638752, 0.015074091963469982, -0.006465110462158918, -0.009982398711144924, -0.008605259470641613, 0.017910253256559372, 0.023642130196094513, 0.012714345008134842, 0.004466397687792778, -0.0276767760515213]",Model Alignment as Prospect Theoretic Optimization.pdf
"8K re-
spectively. Making the value function risk-neutral by setting
it to the identity function leads to a total collapse in BBH
performance. Changing the curvature and slope via the
risk and loss aversion hyperparameters can, depending on
the task, slightly improve or degrade performance, though
extreme choices of λD, βare detrimental (Table 1, bottom).
KTO works without a reference model or SFT, but not
as well as standard KTO. If we can avoid storing the
reference model in memory, then we can do much more
memory-efficient alignment. The naive way to do this is
to assume that πrefreturns a uniform distribution over out-
puts for all x, which simplifies rθ−z0tologπθ(y|x)−
Ex′H(πθ(y′|x′)), where Hdenotes the entropy and is esti-
mated as max
0,1
mP
i̸=jlogπθ(yj|xi)
. As seen in Ta-Table 2. In aligning Mistral-7B on the OpenAssistant dataset, we
find that using KTO with only one output per input still outper-
forms DPO, despite this restriction reducing the amount of training
data by 72%. A 90% binomial confidence interval is given.
Method Winrate vs. SFT Target
Mistral-7B (unaligned) 0.525 ±0.037
Mistral-7B + DPO 0.600 ±0.037
Mistral-7B + KTO (all yperx) 0.652±0.036
Mistral-7B + KTO (one yperx) 0.631 ±0.036
Mistral-7B-Instruct 0.621 ±0.031
ble 1 (middle), if we set λD= 1.75, this memory-efficient
variant of KTO is better than DPO on some tasks and worse
on others, though it still trails standard KTO. We find that it
is also more sensitive to the loss aversion hyperparameters;
setting λD∈ {1.5,2.0}reduces performance on GSM8K
and BBH by several points. Still, it strictly outperforms
ORPO (Hong et al., 2024), a recently-proposed reference-
free method, while also using less memory than all existing
approaches, since πrefneed never be loaded into memory
and a batch of mKTO outputs is smaller than a batch of m
preferences (i.e., 2moutputs) used for ORPO/DPO.
4.3. Theoretical Analysis
KTO was designed with the motivation that even if binary
feedback were weaker, one could compensate with sheer
volume, as such data is much more abundant, cheaper, and
faster to collect than preferences. So why does KTO perform
as well or better than DPO on the same preference data (that
has been broken up)? Greater data efficiency helps, but it is
not the only answer, given that even after adjusting for this
factor in the one- y-per-xsetup, KTO still outperforms.
In this section, we will discuss two theoretical explanations
for this phenomenon: (1) preference likelihood can be max-
imized without necessarily maximizing underlying human
utility; (2) KTO implicitly ignores noisy and intransitive
data, which is common in real-world feedback.
Proposition 4.1. As the reward implied by the current policy
tends to ±∞, the KTO update of πθtends to zero.
This means that if (x, y)is implied by the current policy
πθto be too difficult or too easy to learn from, then it is
effectively ignored. In some cases, this may be a blessing in
disguise: since real-world feedback is very noisy (Hoeffler
& Ariely, 1999), the reason a desirable example has a highly
negative implied reward may be because it is mislabelled.
By avoiding this hard-to-learn data, KTO avoids fitting to
noise. However, this also means that KTO could end up ig-
noring data that is hard-to-learn but necessary to recover r∗,
potentially resulting in underfitting to complex distributions.
Such underfitting may be mitigated by aligning the model
8
Model Alignment as Prospect Theoretic Optimization
with lower βand for more epochs.
Theorem 4.2. Assuming the value function is logistic, for a
reward function r∗
athat maximizes (2), there exists a","[-0.008724325336515903, 0.012688004411756992, 0.03179406374692917, 0.02942432090640068, 0.0019747866317629814, 0.006372213363647461, -0.014288991689682007, 0.04556114971637726, -0.006932911463081837, 0.03771842643618584, 0.021638019010424614, 0.0019712601788342, -0.004707750398665667, -0.0024085345212370157, 0.04781804978847504, -0.04056775942444801, 0.03317641466856003, -0.041724421083927155, 0.0112069146707654, 0.03904435411095619, -0.03170943260192871, -0.034022752195596695, 0.0061994194984436035, 0.036053963005542755, 0.01692674309015274, -0.017533283680677414, -0.00257427548058331, 0.020622415468096733, 0.007927358150482178, -0.04894649609923363, 0.03989069163799286, -0.03822622820734978, -0.03512299060821533, -0.05946929007768631, 0.02005819045007229, 0.029875701293349266, 0.04203474521636963, 0.05946929007768631, 0.0012421760475263, 0.00142554915510118, 0.0013056513853371143, -0.04087808355689049, -0.04460196569561958, 0.05137266591191292, -0.011087016202509403, 0.010395840741693974, 0.016701051965355873, -0.012589264661073685, -0.00952129252254963, 0.017307594418525696, -0.023203743621706963, 0.052585747092962265, -0.015643130987882614, -0.005642247386276722, 0.00023075910576153547, -0.0080472556874156, 0.012857271358370781, -0.004658380523324013, 0.061161965131759644, 0.004880544263869524, -0.011672399938106537, -0.0315965861082077, 0.03520762547850609, 0.0280842874199152, -0.017970558255910873, -0.00202062982134521, -0.04852332919836044, 0.016320200636982918, -0.022625412791967392, 0.041498731821775436, -0.022131716832518578, -0.01496606133878231, 0.00793441105633974, 0.010106676258146763, -0.003554615890607238, -0.02732258290052414, 0.03675924241542816, 0.04440448805689812, 0.046887077391147614, -0.03546152636408806, 0.02128537930548191, 0.00013488497643265873, 0.04166799783706665, -0.031032361090183258, 0.0034311919007450342, -0.05402452126145363, -0.024727150797843933, -0.03766200318932533, -0.07165654748678207, -0.010473421774804592, -0.043219614773988724, -0.013520236127078533, -0.004115314222872257, -0.005772724747657776, 0.04951072111725807, -0.019084902480244637, 0.0013779426226392388, -0.038959719240665436, 0.031370896846055984, -0.021384118124842644, -0.032273657619953156, -0.03185048699378967, -0.0017834792379289865, 0.00020728647359646857, 0.05986424535512924, 0.023119108751416206, -0.013590764254331589, 0.03715420141816139, 0.007983780466020107, -0.00020331927225925028, -0.04812837019562721, -0.018464256078004837, -0.0682711973786354, 0.0366181880235672, 0.0013118225615471601, -0.07978138327598572, -0.0669170543551445, 0.022879313677549362, 0.0086820088326931, -0.024106502532958984, -0.02107379399240017, -0.01885921321809292, 0.026645513251423836, 0.04697171226143837, 0.0049299136735498905, -0.006911753211170435, 0.0007744866306893528, -0.02735079452395439, 0.00810367800295353, -0.029198631644248962, 0.020297985523939133, 0.0280842874199152, -0.008646744303405285, -0.030891304835677147, -0.046407487243413925, 0.021313590928912163, 0.009648242965340614, 0.02520674094557762, 0.0230344757437706, -0.027689330279827118, -0.03712598979473114, -0.0505545400083065, -0.06257252395153046, -0.015445652417838573, -0.10590498894453049, 0.009027596563100815, 0.00808251928538084, 0.002854624530300498, -0.022188138216733932, 0.03814159333705902, 0.028719039633870125, -0.028394611552357674, -0.0056528267450630665, 0.012998327612876892, 0.014740372076630592, -0.03368421643972397, -0.00840694922953844, 0.02296394668519497, 0.009126335382461548, -0.03436128795146942, 0.02100326679646969, 0.039693210273981094, 0.00013091777509544045, 0.030524559319019318, 0.009577714838087559, 0.027266161516308784, -0.036928512156009674, 0.027379006147384644, -0.062177568674087524, -0.029339687898755074, 0.03839549422264099, -0.002299215877428651, -0.05154193192720413, -0.015361019410192966, -0.028436927124857903, 0.022794680669903755, -0.027379006147384644, -0.027675224468111992, -0.0069963871501386166, -0.02757648564875126, -0.004185842350125313, 0.0054095047526061535, 0.03043992631137371, 0.00017554883379489183, -0.017138326540589333, -0.0080472556874156, -0.015516180545091629, -0.015332807786762714, -0.006195893045514822, 0.03430486470460892, 0.03929825499653816, 0.004182315897196531, 0.0656193420290947, 0.0007343738107010722, -0.031032361090183258, -0.013181701302528381, 0.03862118348479271, 0.07374417781829834, -0.033119991421699524, 0.019028479233384132, 0.01911311410367489, 0.002685357118025422, 0.036420706659555435, -0.09450764954090118, 0.007306710816919804, 0.020424935966730118, 0.011383234523236752, 0.014303097501397133, -0.05969497933983803, -0.004312792792916298, 0.0025108002591878176, -0.0014264307683333755, 0.007341974414885044, 0.055858250707387924, 0.005434189457446337, -0.0094648702070117, -0.05693027749657631, 0.038198016583919525, 0.018224459141492844, 0.09388700127601624, -0.0211443230509758, 0.018718156963586807, 0.013640133664011955, 0.023330694064497948, -0.008696113713085651, 0.010120781138539314, 0.025841493159532547, -0.02165212482213974, 0.026998154819011688, -0.04818479344248772, 0.024938734248280525, 0.0100996233522892, 0.023880813270807266, -0.007602928671985865, 0.046661388128995895, -0.03619501739740372, -0.02204708196222782, -0.018760472536087036, -0.0011478447122499347, -0.039721421897411346, -0.020368514582514763, 0.0198748167604208, 0.001456405152566731, -0.0416962094604969, -0.06364455074071884, 0.025404220446944237, -0.025982549414038658, -0.014147935435175896, -0.025150317698717117, -0.0302988700568676, 0.024402720853686333, -0.03512299060821533, -0.023457644507288933, -0.02110200561583042, -0.0268147811293602, -0.010163098573684692, 0.0322454459965229, 0.028309976682066917, -0.02956537716090679, 0.0157700814306736, 0.018577100709080696, -0.017265276983380318, -0.007299657911062241, 0.008258840069174767, -0.027491850778460503, 0.0051203398033976555, -0.0211443230509758, -0.010953012853860855, -0.003621617564931512, -0.01863352209329605, 0.02423345297574997, -0.0008375211036764085, -0.016559995710849762, 0.02273825742304325, -0.021384118124842644, -0.046887077391147614, 0.015022484585642815, 0.03280967101454735, -0.05884864181280136, -0.04003174602985382, -0.02096094936132431, 0.024656621739268303, 0.044009532779455185, -0.03388169780373573, 0.027816280722618103, -0.014408890157938004, -0.020721154287457466, 0.033402103930711746, -0.010692059062421322, -0.008216522634029388, 0.010036148130893707, -0.03783126920461655, 0.03673103079199791, -0.025305479764938354, 0.019155429676175117, 0.0010852511040866375, 0.011742928065359592, -0.04429164156317711, 0.012793796136975288, -0.019564492627978325, 0.038451917469501495, 0.024769466370344162, -0.009612979367375374, 0.003762673819437623, 0.025249058380723, -0.010953012853860855, 0.04211937636137009, 0.016588207334280014, 0.011975670233368874, 0.016701051965355873, -0.02379617840051651, 0.007687562145292759, -0.014740372076630592, 0.05441947653889656, -0.023951340466737747, -0.015093011781573296, 0.07712952047586441, -0.02589791640639305, -0.003603985533118248, -0.04403774067759514, -0.07588823139667511, -0.11002382636070251, -0.010529844090342522, 0.01427488587796688, 0.06392666697502136, -0.016983164474368095, -0.025728648528456688, -0.010170151479542255, -0.003383585251867771, -0.0019377593416720629, -0.006911753211170435, -0.017716657370328903, 0.005578772164881229, -0.02510800212621689, -0.018111614510416985, 0.015487969852983952, -0.0022339774295687675, 0.02153928019106388, 0.017998769879341125, -0.0027118052821606398, -0.09157367795705795, 0.001988892210647464, -0.008491582237184048, -0.020537780597805977, -0.02234330028295517, 0.007363133132457733, 0.02905757538974285, 0.013068855740129948, 0.03444592282176018, 0.045786838978528976, -0.009436658583581448, -0.005765671841800213, 0.04697171226143837, 0.03839549422264099, 0.015163539908826351, 0.019493965432047844, -0.025672227144241333, -0.004274002742022276, -0.02670193649828434, 0.011270389892160892, -0.0049440194852650166, 0.014486470259726048, 0.0017790711717680097, 0.002972759073600173, 0.02151106856763363, 0.01856299489736557, -0.028690828010439873, 6.584458606084809e-05, -0.04127304255962372, 0.015304596163332462, -0.008181259036064148, 0.025249058380723, -0.048805441707372665, 0.0012139647733420134, -0.04305034875869751, -0.024078290909528732, 0.028577983379364014, 0.026857098564505577, 0.042881082743406296, 0.019564492627978325, -0.011446709744632244, -7.383409683825448e-05, -0.000312748015858233, -0.02252667397260666, 0.01863352209329605, -0.001338270609267056, 0.005081549286842346, -0.03258397802710533, -0.03520762547850609, 0.007588822860270739, 0.0003872433153446764, 0.028126604855060577, -0.057127755135297775, 0.020608309656381607, 0.003172001102939248, 0.011150491423904896, -0.04632285237312317, 0.07182580977678299, 0.040821660310029984, 0.0536295622587204, -0.05896148830652237, 0.0060759955085814, -0.10455084592103958, -0.008167153224349022, -0.05879221856594086, -0.022583095356822014, -0.008167153224349022, 0.03512299060821533, 0.020072296261787415, 0.030327079817652702, 0.08243323862552643, -0.057748403400182724, 0.015614920295774937, -0.026645513251423836, 0.008985279127955437, -0.014923744834959507, 0.028394611552357674, 0.015290491282939911, 0.01895795203745365, 0.04025743529200554, -0.03898793086409569, -0.02836639992892742, -0.009062860161066055, -0.049708202481269836, -0.04014459252357483, 0.023739757016301155, 0.03015781380236149, -0.012899588793516159, 0.03927004337310791, -0.0694560706615448, 0.013682450167834759, 0.053319238126277924, -0.007948515936732292, -0.010374682955443859, -0.04646391049027443, -0.01360486913472414, 0.015643130987882614, -0.022427933290600777, -0.0015339860692620277, -0.021243061870336533, 0.0012404128210619092, -0.01994534581899643, -0.030270658433437347, -0.012455261312425137, -0.0029833384323865175, 0.017335806041955948, -0.024543777108192444, -0.0040342072024941444, 0.026927625760436058, -0.0002556643448770046, -0.03179406374692917, 0.052218999713659286, 0.04031385853886604, -0.029001152142882347, 0.0007295249961316586, -0.03949573263525963, 0.07746805995702744, -0.002054130658507347, 0.010163098573684692, -0.01918364129960537, 0.010727323591709137, -0.014698054641485214, -0.013301598839461803, -0.029621800407767296, 0.015361019410192966, 0.028944730758666992, 0.0029833384323865175, -0.015332807786762714, -0.032273657619953156, -0.009697613306343555, 0.0013065329985693097, -0.06962533295154572, 0.014091513119637966, -0.05202152207493782, -0.06048489362001419, 0.02361280657351017, 0.04178084433078766, 0.02084810473024845, 0.0030521033331751823, 0.007553558796644211, 0.023993657901883125, -0.034643400460481644, -0.0154597582295537, 0.02331658825278282, 0.031229840591549873, 0.0061853136867284775, 0.061669766902923584, -0.009676454588770866, -0.015389230102300644, -0.001110817538574338, -0.01722296141088009, -0.05690206587314606, 0.08553647249937057, -0.016221461817622185, 0.0014211410889402032, -0.0013576658675447106, 0.020664731040596962, -0.01035352423787117, 0.0040871030651032925, -0.002253372687846422, 0.034784454852342606, -0.007155075203627348, -0.0039178356528282166, 0.02412060834467411, 0.01784360781311989, 0.034022752195596695, 0.014486470259726048, -0.038508340716362, -0.010014989413321018, 0.018732262775301933, -0.038451917469501495, -0.012518736533820629, -0.02630697935819626, 0.037069566547870636, -0.009401394985616207, -0.0007484793895855546, -0.04519440233707428, -0.002516089705750346, -0.022399723529815674, 0.047902680933475494, -0.029762856662273407, -0.00799083337187767, -0.05470158904790878, 0.02400776371359825, 0.03043992631137371, -0.01895795203745365, -0.04505334794521332, -0.09388700127601624, -0.027562379837036133, -0.025658121332526207, 0.05210615694522858, -0.010148992761969566, 0.013717714697122574, 0.006128891371190548, -0.0066931163892149925, -0.022554883733391762, -0.0135696055367589, -0.020467253401875496, -0.013343915343284607, 0.004118840675801039, 0.03173764422535896, -0.012575158849358559, 0.010424052365124226, -0.0019166009733453393, 0.003871992463245988, -0.024177031591534615, 0.0372670441865921, -0.0309195164591074, -0.01819624751806259, 0.011228072457015514, 0.004013048484921455, -0.04028564691543579, -0.027915019541978836, 0.007405450101941824, -0.03879045322537422, -0.0020153403747826815, -0.0001409459946444258, 0.01402098499238491, 0.037803057581186295, 0.01013488695025444, -0.002888125367462635, -0.007084547076374292, -0.03117341734468937, 0.011312706395983696, -0.0054165576584637165, 0.03382527455687523, -0.02448735386133194, -0.028606195002794266, 0.03357137367129326, 0.022978052496910095, -0.01918364129960537, 0.005836199969053268, 0.0315401628613472, -0.02891651913523674, 0.0059032016433775425, -0.0020841052755713463, 0.023767968639731407, -0.02056599222123623, 0.015078906901180744, -0.002383849583566189, -0.0230344757437706, 0.02280878648161888, -0.021158428862690926, -0.02001587301492691, -0.04846690595149994, 0.017716657370328903, 0.023485856130719185, 0.03444592282176018, -0.05484264716506004, 0.04922860860824585, 0.03280967101454735, -0.05478622391819954, -0.007504189386963844, -0.00272062118165195, -0.025996655225753784, 0.005293133668601513, -0.014035090804100037, 0.003120868233963847, 0.023006264120340347, -0.02790091373026371, 0.021243061870336533, -0.006301685236394405, 0.015191751532256603, -0.03836728259921074, -0.03594111651182175, 0.061444077640771866, -0.009690560400485992, 0.011030593886971474, 0.01360486913472414, 0.011686504818499088, 0.017025481909513474, -0.014422995038330555, -0.001902495394460857, -0.0094648702070117, -0.043360672891139984, -0.029762856662273407, -0.012814954854547977, -0.007391344290226698, 0.028817780315876007, 0.012264835648238659, -0.006227630656212568, -0.00971877109259367, 0.015629025176167488, -0.009697613306343555, -0.007969674654304981, 0.003075024811550975, 0.006534427870064974, -0.010685006156563759, -0.008477477356791496, -0.017053693532943726, -0.039439309388399124, -0.01634841226041317, -0.0037662002723664045, 0.021708548069000244, 0.022752363234758377, -0.02695583738386631, 0.041103772819042206, -0.011961564421653748, -0.011122280731797218, -0.02778806909918785, 0.01715243235230446, 0.028239449486136436, 0.015629025176167488, -0.01725117117166519, 0.02001587301492691, -0.016362518072128296, 0.007948515936732292, 0.04000353440642357, 0.013795295730233192, -0.02979106642305851, -0.014422995038330555, -0.03701314330101013, 0.030073178932070732, 0.0032636874821037054, 0.015685448423027992, 0.021877814084291458, -0.012673898600041866, 0.019479859620332718, 0.01885921321809292, 0.00042493175715208054, -0.03134268522262573, -0.03740810230374336, -0.009119282476603985, -0.0012554001295939088, 0.029198631644248962, 0.037295255810022354, -0.009838669560849667, 0.04719740152359009, 0.01560081448405981, 0.012060304172337055, -0.013689503073692322, 0.018788684159517288, 0.007906199432909489, -0.03094772808253765, 0.0012730321614071727, -0.012941905297338963, -0.001188398338854313, -0.05354493111371994, -0.044376276433467865, -0.0016177381621673703, -0.009239180013537407, -0.030496347695589066, -0.04939787834882736, -0.04403774067759514, -0.01780129037797451, -0.03484087809920311, 0.04863617569208145, 0.0038931507151573896, -0.007906199432909489, -0.01932469755411148, -0.007560611702501774, -0.015967560932040215, 0.019169535487890244, -0.0230344757437706, -0.0031702378764748573, -0.004601958207786083, -0.0048629119992256165, 0.04062418267130852, -0.02379617840051651, -0.05165477469563484, -0.011030593886971474, 0.01950807124376297, -0.029508953914046288, 0.003584590507671237, -0.03890329599380493, 0.0005144142778590322, 0.0033024779986590147, 0.07052809745073318, 0.022935736924409866, -0.011813456192612648, -0.004175262991338968, 0.011489026248455048, 0.016630524769425392, 0.012335363775491714, -0.010706164874136448, -0.005208499729633331, 0.027816280722618103, 0.02684299275279045, 0.028874201700091362, -0.017533283680677414, -0.016038088127970695, 0.0031437897123396397, -0.027745751664042473, 0.042232222855091095, 0.015050695277750492, -0.006026625633239746, -0.03599753975868225, -0.0002807899727486074, 0.0021934236865490675, 0.017970558255910873, -0.00308736739680171, 0.0005421847454272211, -0.021116111427545547, -0.0423450693488121, -0.02215992659330368, 0.027449535205960274, -0.01496606133878231, 0.02038261853158474, 0.02252667397260666, 0.012779690325260162, -0.001110817538574338, -0.007567664608359337, -0.021595703437924385, 0.01725117117166519, 0.023231955245137215, -0.0023362431675195694, 0.013287493027746677, 0.037323467433452606, 0.010854274034500122, 0.0014467075234279037, 0.012419997714459896, 0.013830559328198433, -0.013590764254331589, 0.022625412791967392, 0.028380505740642548, -0.007539453450590372, 0.006721327546983957, -0.009105176664888859, -0.03433307632803917, 0.01213083229959011, -0.011383234523236752, 0.016842108219861984, -0.025813283398747444, 0.0069963871501386166, 0.005162656307220459, 0.005081549286842346, -0.04762056842446327, 0.0157700814306736, 0.03613859415054321, -0.003949573263525963, 0.017589706927537918, 0.007292605005204678, 0.008823065087199211, 0.013231070712208748, 0.05704312399029732, 0.010000883601605892, -0.0019077849574387074, -0.019409332424402237, 0.0046407487243413925, 0.016193250194191933, -0.02815481461584568, -0.014056249521672726, 0.018153931945562363, -0.023556383326649666, -0.023782072588801384, -0.025601698085665703, 0.00846337154507637, -0.00952129252254963, 0.0013082961086183786, -0.01685621403157711, -0.025770965963602066, -0.017138326540589333, -0.024797677993774414, -0.004171737004071474, -9.113552368944511e-05, 0.014190252870321274, -0.06082342937588692, -0.1110958531498909, -0.038056958466768265, 0.021158428862690926, 0.0014017458306625485, 0.01360486913472414, 0.0011513711651787162, 0.059412866830825806, -0.0016671078046783805, -0.026462141424417496, -0.006135944277048111, -0.011291547678411007, -0.03193512186408043, 0.007419555447995663, -0.0063827927224338055, 0.011221019551157951, -0.03989069163799286, -0.0049687041901052, 0.0085197938606143, 0.0025125632528215647, -0.0023415328469127417, -0.02481178380548954, 0.003164948197081685, -0.022385617718100548, 0.021243061870336533, -0.05577361583709717, -0.01360486913472414, 0.039580367505550385, -0.004235212225466967, -0.0009071676176972687, 0.005836199969053268, -0.0012906640768051147, 0.012095567770302296, 0.030609192326664925, 0.030637403950095177, -0.03241471201181412, -0.001476682024076581, -0.0015066564083099365, -0.00276999082416296, 0.011340918019413948, 0.01805519312620163, 0.011764085851609707, -0.03004496917128563, 0.03684387728571892, -0.015290491282939911, 0.020791681483387947, -0.038310859352350235, 0.022498462349176407, -0.01918364129960537, -0.011249231174588203, -0.0011936880182474852, 0.01754738949239254, -0.04003174602985382, 0.011841666884720325, -0.026871204376220703, 0.019240064546465874, 0.0074759782291948795, 0.0189297404140234, 0.0018883896991610527, -0.009337919764220715, -0.013809400610625744, -0.01426078099757433, 0.02866261824965477, 0.02310500293970108, -0.009006437845528126, -0.030580982565879822, -0.027844492346048355, 0.011319759301841259, 0.019917134195566177, 0.004905228968709707, -0.03766200318932533, -0.008308209478855133, 0.016517680138349533, -0.01107996329665184, 0.006294632330536842, -0.013238123618066311, 0.0013664818834513426, 0.000793000275734812, 0.034784454852342606, -0.059638556092977524, 0.039439309388399124, 0.03345852717757225, -0.03292251378297806, 0.041865475475788116, 0.0321890227496624, 0.028648512437939644, 0.0347280353307724, -0.02481178380548954, -0.018294988200068474, -0.0058820429258048534, 0.018577100709080696, 0.01699727028608322, -0.027731645852327347, 0.008258840069174767, -0.03458697721362114, -0.0048699649050831795, -0.014895533211529255, -0.014211410656571388, 0.02201887033879757, 0.015389230102300644, -0.013555499725043774, 0.015022484585642815, 0.012885482981801033, -0.03735167905688286, -0.029706433415412903, 0.013964562676846981, -0.0021934236865490675, -0.011065858416259289, 0.004020101390779018, 0.038931507617235184, -0.014331309124827385, -0.026363402605056763, -0.0025143264792859554, 0.013809400610625744, 0.008371684700250626, 0.0020435515325516462, 0.01402098499238491, 0.04697171226143837, 0.035433314740657806, -0.0060160462744534016, 0.011594818904995918, 0.0080472556874156, 0.0347280353307724, -0.002406771294772625, -0.009556557051837444, 0.01062858384102583, 0.0006440096767619252, -0.029085787013173103, 0.02462841011583805, -0.0110446996986866, 0.008287050761282444, 0.01823856495320797, -0.0034876142162829638, 0.015318701975047588, -0.011665347032248974, -0.022075293585658073, 0.019028479233384132, 0.007602928671985865, 0.004436217248439789, -0.008174206130206585, 0.029762856662273407, -0.014366572722792625, 0.007320816162973642, 0.0013752978993579745, 0.0015710133593529463, -0.005032179411500692, -0.017208855599164963, 0.02026977390050888, -0.015417441725730896, 0.001801992766559124, 0.007617034018039703, 0.03986248001456261, -0.004658380523324013, 0.01224367693066597, 0.007906199432909489, -0.012631582096219063, -0.023006264120340347, -0.01066384743899107, -0.017885925248265266, 0.023048581555485725, 0.02732258290052414, -0.0056598796509206295, 0.026391612365841866, -0.013329809531569481, -0.037944115698337555, 0.045025136321783066, -0.02045314759016037, -0.014669843949377537, 0.00725734094157815, 0.0290293637663126, 0.007715773768723011, -0.025742754340171814, -0.029819278046488762, 0.01678568683564663, 0.016320200636982918, 0.03438949957489967, -0.001057039829902351, -0.007349027320742607, 0.0176602341234684, 0.006728379987180233, 0.041724421083927155, 0.0249246284365654, 0.005197920370846987, -0.03193512186408043, 0.0010755534749478102, 0.03568721562623978, -0.061951879411935806, 0.00434100441634655, -0.002096447627991438, -0.005282554309815168, 0.03207617625594139, 0.020185140892863274, 0.006640220060944557, -0.019536282867193222, 0.019240064546465874, -0.008160100318491459, -0.023344799876213074, -7.581770478282124e-05, 0.034530553966760635, 0.003452350152656436, -0.03309178352355957, -0.0271392110735178, 0.03139910846948624, 0.004129420034587383, -0.01842193864285946, -0.016306094825267792, 0.026504456996917725, 0.012427050620317459, -0.04138588532805443, 0.015417441725730896, 0.015445652417838573, -0.009274444542825222, 0.0233589056879282, -0.03410738706588745, 0.010233626700937748, -0.003156132297590375, -0.043247826397418976, -0.002359164645895362, -0.01234946958720684, -0.02709689363837242, 0.026800675317645073, -0.01623556762933731, -0.024896416813135147, 0.020029978826642036, -0.0005589351640082896, 0.013668344356119633, -0.02811249904334545, 0.056366052478551865, -0.001402627443894744, 0.012793796136975288, 0.01660231314599514, -0.036420706659555435, 0.041244830936193466, -0.020749365910887718, -0.002112316433340311, 0.0056034573353827, -0.0026835938915610313, -0.003670987207442522, 0.010713217779994011, -0.00688354205340147, -0.005663406103849411, 0.022385617718100548, 0.01747686229646206, 0.007997886277735233, -0.020001767203211784, 0.0075747175142169, -0.012490525841712952, 0.014627526514232159, 0.05292428284883499, -0.0347280353307724, 0.008808959275484085, -0.029142208397388458, 0.031511951237916946, 0.019254170358181, 0.0019994715694338083, -0.010967118665575981, 0.0011892799520865083, -0.008033149875700474, 0.04747951403260231, 0.02474125474691391, 0.020481359213590622, 0.0028493350837379694, 0.01715243235230446, -0.016912637278437614, -0.029480744153261185, -0.005335450172424316, -0.01569955423474312, 0.0051062339916825294, 0.012123779393732548, 0.026984049007296562, 0.0008467779261991382, -0.027379006147384644, 0.03374063968658447, -0.020862210541963577, 0.015685448423027992, 0.012427050620317459, -0.0004813542473129928, 0.02481178380548954, 0.0013858770253136754, 0.02804196998476982, 0.0112069146707654, -0.006403950974345207, -0.0015181172639131546, -0.03018602356314659, 0.014867322519421577, 0.023923128843307495, -0.020975055173039436, 0.011615977622568607, -0.005698670167475939, 0.001750859897583723, 0.006523848976939917, 0.03955215588212013, 0.033656008541584015, -0.007927358150482178, -0.010974171571433544, -0.0063827927224338055, -0.023443538695573807, -0.011333865113556385, 0.00210173730738461, -0.0015851189382374287, -0.012709162198007107, 0.010141939856112003, 0.014162041246891022, 0.009196863509714603, -0.002634224249050021, 0.014500576071441174, 0.028563877567648888, -0.004136472940444946, -0.0017693735426291823, -0.007652298081666231, -0.010014989413321018, -0.008548005484044552, -0.02517852932214737, 0.004873491358011961, 0.014324256218969822, -0.015290491282939911, 0.015234068036079407, -0.00942960660904646, -0.0022851102985441685, 0.012723268009722233, 0.0016688710311427712, 0.0085197938606143, -0.02089042216539383, 0.007743984926491976, 0.012772638350725174, -0.038508340716362, -0.021454647183418274, -0.0036568816285580397, 0.00010039233166025952, -0.0031067626550793648, 0.0024543777108192444, -0.012250729836523533, 0.03430486470460892, 0.022625412791967392, -0.038564760237932205, -0.030609192326664925, -0.0013929298147559166, -0.02836639992892742, -0.0003682888927869499, -0.02005819045007229, -0.021680336445569992, 0.022131716832518578, 0.0220893993973732, 0.009577714838087559, -0.025545276701450348, 0.0034276654478162527, 0.025150317698717117, 0.014056249521672726, 0.03501014783978462, 0.004072997253388166, -0.03165300935506821, 0.08880897611379623, -0.04773341491818428, -0.032019756734371185, 0.0058961487375199795, -0.031032361090183258, 0.01124217826873064, 0.00034073885763064027, 0.006774223409593105, -0.03385348618030548, 0.030496347695589066, 0.0054306634701788425, 0.012504630722105503, 0.007722826208919287, 0.0034206125419586897, 0.025799177587032318, 0.014035090804100037, -0.021962448954582214, 0.04604073986411095, 0.017490968108177185, -0.012920746579766273, 0.029226843267679214, -0.01692674309015274, -0.007511242292821407, 0.010783745907247066, 0.003307767678052187, -0.0018689945572987199, -0.017349911853671074, -0.0230344757437706, -0.0024138239677995443, 0.022075293585658073, 0.003720357082784176, -0.047140978276729584, -0.056140363216400146, -0.0034065069630742073, -0.015093011781573296, 0.018732262775301933, -0.02306268736720085, 0.028168920427560806, -0.04302213713526726, -0.021271273493766785, -0.0017676103161647916, -0.007877987809479237, 0.004757119808346033, 1.615809742361307e-05, 0.007042230106890202, 0.022653624415397644, 0.020608309656381607, 0.012730320915579796, 0.0003815129166468978, 0.0012606896925717592, 0.02423345297574997, -0.01725117117166519, 0.01794234663248062, -0.013809400610625744, 0.002491405000910163, 0.010840168222784996, -0.009055807255208492, 0.008011991158127785, 0.029142208397388458, -0.0010499870404601097, -0.017081905156373978, -0.009091071784496307, -0.020580098032951355, 0.0004361721803434193, 0.028352294117212296, -0.01943754218518734, -0.0024966944474726915, 0.030863095074892044, -0.011510184966027737, 0.05645068734884262, -0.018365515395998955, 0.024148819968104362, -0.019959451630711555, -0.00023362431966233999, 0.0038860980421304703, 0.0029762855265289545, -0.0126245291903615, 0.010600372217595577, 0.0006607600953429937, 0.019663233309984207, -0.007835671305656433, 0.007793354336172342, -0.01667284220457077, 0.0005902319680899382, -0.019973555579781532, 0.02008640207350254, 0.00228863675147295, -0.024177031591534615, -0.038931507617235184, 0.045532938092947006, -0.014253728091716766, -0.008985279127955437, 0.034276653081178665, -0.004016574937850237, 0.005335450172424316, -0.012850218452513218, -0.002376796677708626, -0.0060160462744534016, -0.012673898600041866, 0.0284087173640728, -0.014867322519421577, -0.01809750869870186, 0.012532842345535755, 0.015755975618958473, -0.029508953914046288, -0.001704135094769299, -0.04635106399655342, 0.006643746513873339, 0.016644630581140518, -0.007969674654304981, 0.013252228498458862, -0.00720091862604022, 0.006608482450246811, 0.025672227144241333, -0.005663406103849411, 0.0154597582295537, 0.015812398865818977, 0.027816280722618103, 0.013597816228866577, -0.013717714697122574, 0.010706164874136448, 0.0030732618179172277, -0.006407477427273989, -0.02096094936132431, 0.02179318107664585, 0.02905757538974285, -0.013562552630901337, 0.01904258504509926, -0.015572602860629559, 0.0004275765677448362, -0.0008145995088852942, 0.011883984319865704, 0.00849863514304161, -0.021891919896006584, 0.0015445653116330504, 0.04468660056591034, -0.0009186284150928259, -0.010621530935168266, -0.023090898990631104, -0.013865822926163673, 0.016701051965355873, 0.011524290777742863, -0.017956452444195747, 0.020424935966730118, -0.006869436241686344, -0.04279644787311554, 0.021412329748272896, -0.03966499865055084, 0.02561580389738083, 0.006269947625696659, 0.008597374893724918, 0.006509743165224791, -0.02230098284780979, 0.011171650141477585, -0.023584594950079918, 0.00935202557593584, 0.010014989413321018, -0.050300635397434235, -0.005906728096306324, 0.020650625228881836, 0.039100777357816696, 0.00210173730738461, -0.0009583004866726696, 0.030524559319019318, 0.018294988200068474, -0.021426435559988022, -0.02230098284780979, -0.005536455195397139, 0.011538396589457989, -0.0019377593416720629, -0.006537954322993755, 0.02008640207350254, 0.01775897480547428, -0.012596317566931248, -0.023330694064497948, 0.0010967118432745337, 0.003002733690664172, 0.0023521119728684425, -0.023161426186561584, 0.0008608835632912815, 0.015671342611312866, 0.020918631926178932, 0.009986777789890766, -0.006361634004861116, -0.006569691933691502, 0.010064358823001385, -0.0024949314538389444, 0.0164189413189888, -0.002212818944826722, 0.00506744347512722, -0.013950456865131855, -0.005032179411500692, 0.04468660056591034, -0.003501719795167446, 0.0071586016565561295, 0.028027864173054695, 0.020791681483387947, 0.003995416685938835, 0.0025778019335120916, -0.005275501403957605, 0.022442039102315903, -0.006012520287185907, -9.862913429969922e-05, -0.01082606241106987, -0.00830115657299757, 0.009775194339454174, -0.013668344356119633, 0.005201446823775768, 0.014084460213780403, 0.033007148653268814, 0.02052367478609085, -0.022371511906385422, 0.024727150797843933, 0.0030062601435929537, -0.004820595029741526, 0.020368514582514763, 0.003586353501304984, 0.00904875434935093, -0.038198016583919525, -0.021412329748272896, -0.017025481909513474, -0.016221461817622185, 0.03960857912898064, -0.009006437845528126, -0.016842108219861984, 0.0071656545624136925, -0.0069223325699567795, 0.03422022983431816, 3.135194128844887e-05, -0.0074759782291948795, 0.009055807255208492, -0.013689503073692322, -0.0018072824459522963, -0.0025548802223056555, -0.0100996233522892, -0.008548005484044552, -0.020862210541963577, -0.014444153755903244, 0.005405978299677372, 0.002304505556821823, -0.04130125045776367, 0.03055277094244957, -0.025785071775317192, -0.014923744834959507, 0.02096094936132431, 0.05969497933983803, 0.00887948740273714, 0.009838669560849667, -0.02324605919420719, 0.0130970673635602, -0.022286877036094666, -0.011749980971217155, -0.0398060567677021, -0.0041470518335700035, 0.01932469755411148, -0.01990302838385105, -0.02529137395322323, -0.00935202557593584, -0.004799436777830124, 0.026899415999650955, -0.012546948157250881, 0.009500134736299515, -0.002281583845615387, 0.015064801089465618, -0.0046195900067687035, 0.01648946851491928, -0.004164684098213911, -0.008322315290570259, -0.04409416392445564, -0.03094772808253765, 0.0037415153346955776, 0.021736757829785347, 0.01784360781311989, 0.02158159762620926, 0.025700436905026436, 0.033909909427165985, 0.027054576203227043, 0.01768844574689865, -0.00021555149578489363, -0.03354316204786301, 0.03106057271361351, -0.020805787295103073, -0.01004320103675127, -0.01586882211267948, 0.014571104198694229, 0.010508686304092407, -0.03190691024065018, -0.013174648396670818, -0.018478360027074814, 0.005740986671298742, -0.009069913066923618, 0.004556114785373211, 0.006051310338079929, -0.026984049007296562, -0.0208198931068182, -0.019747866317629814, 0.0046936445869505405, -0.039439309388399124, -0.03295072540640831, 0.0026800676714628935, 0.0041541047394275665, -0.021341800689697266, 0.02324605919420719, -0.013308651745319366, 0.032894302159547806, 0.03004496917128563, -0.010833115316927433, 0.01784360781311989, 0.010395840741693974, 9.361502452520654e-05, 0.013992774300277233, -0.0012263072421774268, -0.005585825070738792, 0.004707750398665667, -0.006576744839549065, 0.016320200636982918, -0.0140421437099576, 0.005846778862178326, -0.03320462629199028, 0.017561495304107666, -0.00632989639416337, -0.003154369071125984, 0.011982723139226437, -0.027153316885232925, 0.01418319996446371, -0.01837962120771408, 0.005822094157338142, 0.016559995710849762, -0.0053636617958545685, -0.013308651745319366, 0.024402720853686333, 0.013844665139913559, 0.03977784514427185, 0.00022337569680530578, 0.0060160462744534016, 0.0025055105797946453, -0.023260165005922318, -0.02612360566854477, 0.014796794392168522, -0.03015781380236149, -0.008569163270294666, -0.008385790511965752, 0.015262279659509659, 0.007504189386963844, -0.0467178113758564, 0.026504456996917725, -0.00593846570700407, 0.002325663808733225, -0.01964912749826908, 0.03244292363524437, 0.018718156963586807, 0.03385348618030548, -0.0448276586830616, -0.022442039102315903, 0.01360486913472414, 0.028309976682066917, 0.007722826208919287, -0.008061361499130726, -0.0060759955085814, -0.008766641840338707, -0.005183815024793148, -0.007207971066236496, 0.00849863514304161, 0.007250288035720587, -0.014415942132472992, 0.010459315963089466, -0.016249673441052437, -0.023979552090168, -0.002299215877428651, -0.00196244427934289, 0.02709689363837242, 0.04654854163527489, 0.027223844081163406, 0.012448208406567574, -0.029593588784337044, -0.016559995710849762, -0.0024420353583991528, -0.023838495835661888, 0.02412060834467411, -0.009817510843276978, 0.01520585734397173, -0.023006264120340347, -0.02455788291990757, -0.01911311410367489, -0.0025954339653253555, 0.017096010968089104, 0.017787184566259384, 0.021934237331151962, -0.015107117593288422]",Model Alignment as Prospect Theoretic Optimization.pdf
" reward
function in its equivalence class (i.e., r∗
b(x, y) =r∗
a(x, y) +
h(x)for some h(x)) that induces the same optimal policy
π∗and the same Bradley-Terry preference distribution but
a different human value distribution.
A key insight from Rafailov et al. (2023) is that reward
functions in the same equivalence class (i.e., differing only
in an input-specific component) induce the same optimal
policy under (2) and the same Bradley-Terry preference
distribution. However, we show under mild assumptions
that the value distribution—i.e., human utility—is affected
by such input-specific changes, so maximizing preference
likelihood does not mean one is maximizing human utility.
This helps explain why the margin between KTO and DPO
is even bigger in human evaluations than it is in automated
LLM-as-a-judge evaluations (Appendix D).
Theorem 4.3. For input xwith outputs {ya, yb}, let dataset
Dcomprise contradictory preferences ya≻ybandyb≻ya
in proportion p∈(0.5,1)and(1−p)∈(0,0.5)respec-
tively. If p1/βπref(ya|x)<(1−p)1/βπref(yb|x), then the
optimal DPO policy is more likely to produce the minority-
preferred yb; the optimal KTO policy will strictly produce
the majority-preferred yafor a loss-neutral value function
(λD=λU).
Informally, say there are two contradictory preferences over
the output for x, with the majority ppreferring yaand the
minority 1−ppreferring yb. In the worst-case, when p
is sufficiently low and the reference model is sufficiently
unaligned, the optimal DPO policy is more likely to produce
the minority-preferred output ybeven though the implied
reward rθ(x, yb)> rθ(x, ya). In contrast, the optimal KTO
policy will deterministically produce the majority-preferred
yaif the value function is loss-neutral ( λD=λU), which
is the default setting. This suggests that KTO has better
worst-case outcomes when handling feedback intransitivity.
4.4. KTO vs. DPO – when to use which?
When human feedback is in a binary format, and especially
when there is an imbalance between the number of desirable
and undesirable examples, KTO is the natural choice. When
your data is in the form of preferences, the choice is less
clear. Putting aside the greater data efficiency of KTO, our
theoretical analysis suggests that if your preference data has
sufficiently little noise and sufficiently little intransitivity,
then DPO will work better, since there is some risk of KTO
underfitting; this risk can be mitigated by using a lower
value of βand aligning with KTO for more epochs. But
if there is enough noise and intransitivity, then the better
worst-case guarantees of KTO will win out. Most publicly
available preference datasets (e.g., SHP, OpenAssistant)contain noisy feedback from many different humans whose
preferences likely contradict to some extent, which explains
why KTO was able to match or exceed DPO performance
in our experiments. Even synthetic feedback can be noisy
and intransitive, which helps explain why KTO outperforms
DPO when aligning with UltraFeedback.
5. Future Work
The existence of HALOs raises many questions. For one,
KTO is based on the Kahneman-Tversky value function
for monetary gambles, which is almost certainly different
from how humans perceive the relative goodness of text.
What value functions and reference point distributions best
describe how humans perceive language, and how do they
vary across domains and individuals? How can we identify
the best HALO for each individual and setting instead of
using one default loss?
On a more technical level, important directions include
developing HALOs that: (1) incorporate granular feedback,
such as a score, especially when optimizing for multiple
desiderata; (2) work for other modalities (e.g. images) and
model classes (e.g., diffusion models), especially models
that do not produce an explicit distribution over the output
space; (3) can resolve contradictions in feedback according
to different definitions of fairness; (4) are designed to be
used with online data, where the direction of feedback is
implied by rθor some external reward data.
Ecologically valid evaluation (De Vries et al., 2020), where
the aligned models","[0.00354665401391685, 0.017444394528865814, 0.023125004023313522, 0.028522329404950142, 0.05039491504430771, 0.007693424820899963, -0.003951080609112978, 0.04004755616188049, 0.018204791471362114, 0.03986864164471626, 0.03670777752995491, -0.0214103851467371, -0.01735493540763855, -0.03804965317249298, 0.035962287336587906, -0.021857677027583122, 0.03196647763252258, -0.03497824817895889, 0.01559558603912592, 0.03405384346842766, -0.028522329404950142, -0.015178114175796509, -0.012814920395612717, 0.03634994104504585, 0.016862913966178894, -0.014663727954030037, -0.00570670235902071, 0.02811976708471775, -0.022021682932972908, -0.02753828652203083, 0.06274017691612244, -0.031906839460134506, -0.03637976199388504, -0.017638221383094788, 0.004756206646561623, 0.04341715946793556, 0.015670135617256165, 0.04013701528310776, 0.01978522352874279, -0.0014536995440721512, -0.008610374294221401, -0.03694633021950722, -0.03351709246635437, 0.010205715894699097, -0.010928838513791561, 0.021425293758511543, 0.028089947998523712, -0.02956601046025753, 0.0036305212415754795, 0.00724613294005394, -0.05054401233792305, 0.050931666046381, -0.006131629925221205, -0.023781033232808113, 0.012322898954153061, -0.002991266315802932, -0.022483885288238525, -0.020769266411662102, 0.03148936852812767, -0.0268524382263422, -0.03423275798559189, -0.01895027793943882, 0.022632982581853867, 0.0219173151999712, -0.024943992495536804, 0.007145492359995842, -0.09285785257816315, 0.002899944083765149, -0.0019121739314869046, 0.03718488663434982, 0.021753307431936264, -0.0003468843933660537, 0.019218653440475464, 0.015923600643873215, -0.012621093541383743, -0.02467561699450016, 0.055851880460977554, 0.040524668991565704, 0.013560406863689423, -0.026330597698688507, 0.003365873359143734, 0.006135357543826103, 0.02931254543364048, -0.023527566343545914, -0.0015953420661389828, -0.03554481640458107, -0.04446084052324295, -0.026762980967760086, -0.07097035646438599, -0.018726631999015808, -0.026226229965686798, 0.0032354132272303104, -0.005073038395494223, 0.000479907204862684, 0.036499038338661194, -0.04261203110218048, 0.008118352852761745, -0.01598323881626129, 0.04037557169795036, -0.0006490395753644407, -0.04225419834256172, -0.03229449316859245, -0.016967281699180603, 0.0012766463914886117, 0.06387332081794739, 0.0042045461013913155, -0.010630643926560879, 0.03992827981710434, -0.005497965961694717, -0.0056433361023664474, -0.042194560170173645, -0.0035485178232192993, -0.06518537551164627, 0.013031111098825932, -0.009154579602181911, -0.07466796785593033, -0.08772890269756317, -0.015446488745510578, -0.005382415372878313, -0.0291336290538311, -0.025227276608347893, -0.03450113534927368, 0.03763217851519585, 0.02579384669661522, -0.002996857510879636, -0.036827053874731064, 0.026509514078497887, -0.03617102652788162, 0.017235657200217247, -0.027150632813572884, 0.03366618975996971, 0.04124033823609352, -0.015237752348184586, -0.036618318408727646, -0.057163938879966736, 0.04705513268709183, -0.03793037310242653, 0.015088655054569244, 0.010660463012754917, -0.033785466104745865, -0.044580116868019104, -0.06912154704332352, -0.05221390351653099, -0.012934197671711445, -0.08671503514051437, 0.009057666175067425, -0.002903671469539404, -0.0027378008235245943, -0.052780475467443466, 0.06697454303503036, 0.021097280085086823, -0.023721393197774887, -0.016639268025755882, 0.023885400965809822, -0.011227033101022243, -0.019323021173477173, 0.00034571957075968385, 0.03250322863459587, -0.009065121412277222, -0.04774098098278046, 0.020500890910625458, 0.028611788526177406, 0.01978522352874279, 0.0026464785914868116, 0.030863158404827118, 0.004133725073188543, -0.007671060506254435, 0.03381528705358505, -0.04502740874886513, -0.015535947866737843, 0.0032857335172593594, 0.007760518696159124, -0.054838016629219055, -0.006057081278413534, -0.005177406594157219, 0.00770833482965827, -0.016326162964105606, -0.027836481109261513, -0.012889469042420387, -0.03626048564910889, 0.009773333556950092, 0.03235413134098053, 0.004193363711237907, -0.020664896816015244, -0.0367375947535038, 0.0005651722894981503, -0.018055692315101624, -0.01775749772787094, -0.012926743365824223, 0.04273131117224693, 0.010272810235619545, 0.026181500405073166, 0.0704336017370224, -0.010503910481929779, -0.009743514470756054, -0.026211319491267204, 0.04720423370599747, 0.09345424175262451, -0.04645874351263046, -0.026032403111457825, 0.03560445457696915, 0.03119117207825184, 0.028835434466600418, -0.09357351809740067, -0.006101810373365879, 0.007220041006803513, 0.014417717233300209, -0.006329183932393789, -0.03846712410449982, -0.02934236451983452, 0.005557605065405369, 0.0022085050586611032, 0.02452651970088482, 0.05221390351653099, -0.014231345616281033, -0.025167638435959816, -0.04953015223145485, 0.04228401929140091, 0.015774503350257874, 0.07073179632425308, 0.016326162964105606, 0.03843730688095093, 0.01909937523305416, 0.02351265773177147, -0.015386849641799927, -0.0031683193519711494, 0.022290058434009552, -0.028567058965563774, 0.014589179307222366, -0.05606061592698097, 0.046100910753011703, -0.0020556801464408636, -0.009646601043641567, -0.005158769432455301, 0.017414573580026627, -0.03655868023633957, 0.010742466896772385, -0.020784175023436546, 0.009124759584665298, -0.05680610239505768, -0.02123146690428257, -0.006310546770691872, 0.028209224343299866, -0.021350745111703873, -0.030281677842140198, 0.02424323558807373, -0.025391284376382828, -0.018488075584173203, -0.00864019338041544, -0.04362589493393898, 0.035276442766189575, -0.03414330258965492, -0.020590348169207573, -0.022692622616887093, -0.029446734115481377, -0.013105659745633602, 0.013008746318519115, -0.007279679644852877, -0.03518698364496231, 0.02173839882016182, -0.014976832084357738, -0.008841474540531635, -0.0072088586166501045, 0.0247054360806942, 0.016027968376874924, -0.01123448833823204, -0.003611884079873562, -0.030773699283599854, -0.002331510419026017, -0.008655102923512459, 0.014216435141861439, 0.0076486957259476185, -0.02006850764155388, 0.03989845886826515, -0.039182793349027634, -0.057044658809900284, 0.013597681187093258, 0.04583253711462021, -0.01575959287583828, -0.05579224228858948, -0.045772895216941833, 0.04317860305309296, 0.05373469740152359, -0.035276442766189575, 0.02264789305627346, -0.012926743365824223, -0.014768095687031746, 0.005747704301029444, -0.008200355805456638, -0.01133885607123375, 0.016505081206560135, -0.04478885605931282, 0.042194560170173645, -0.0521840862929821, 0.029297636821866035, 0.011256852187216282, 0.023423198610544205, -0.04025629535317421, -0.004838210064917803, -0.008975662291049957, 0.04786026105284691, 0.0027843937277793884, -0.0012710551964119077, 0.010861744172871113, 0.02890998311340809, -0.013224937953054905, 0.018607353791594505, 0.05597115680575371, 0.0021768216975033283, -0.013142934069037437, -0.004398372955620289, -0.0019475845620036125, -0.012531635351479053, 0.05656754598021507, -0.03790055587887764, -0.02992384508252144, 0.07866378128528595, -0.01644544117152691, -0.010593369603157043, -0.03181738033890724, -0.05203498527407646, -0.07126855105161667, -0.00909494049847126, 0.020679807290434837, 0.026181500405073166, -0.012442177161574364, -0.0148202795535326, -0.007302044425159693, -0.016609448939561844, -0.03408366069197655, 0.009080030955374241, 0.012978927232325077, 0.009788243100047112, 0.020679807290434837, -0.001609319937415421, 0.019665945321321487, -0.025674570351839066, 0.045892175287008286, 0.013977879658341408, 0.012889469042420387, -0.07663605362176895, -0.004021902102977037, -0.025659659877419472, -0.010518820025026798, -0.02865651808679104, -0.01133885607123375, 0.03843730688095093, 0.02873106673359871, 0.009251493029296398, 0.039838820695877075, -0.0255851112306118, -0.03080352023243904, -0.00028118834597989917, 0.037155069410800934, -0.010496456176042557, 0.01930811069905758, -0.03083333931863308, -0.009758424013853073, -0.021425293758511543, -0.00023226576740853488, -0.0001596972724655643, 0.018666991963982582, 0.006657198071479797, 0.029357274994254112, 0.027881210669875145, 0.018309159204363823, -0.029551101848483086, -0.004588472191244364, -0.004685385152697563, 0.021499842405319214, -0.00824508536607027, 0.021097280085086823, -0.03912315517663956, 0.038824960589408875, -0.061070289462804794, 0.025928035378456116, 0.02264789305627346, 0.0013661048142239451, 0.013232393190264702, 0.026897167786955833, -0.016027968376874924, 0.0009113577543757856, -0.01963612623512745, -0.03652885928750038, -0.009229128248989582, 0.023125004023313522, 0.0009216081816703081, -0.03399420529603958, -0.0623227059841156, -0.004413282498717308, 0.014365533366799355, 0.00269866269081831, -0.04046503081917763, 0.02862669713795185, 0.0011685508070513606, 0.001803146442398429, -0.035306259989738464, 0.07055288553237915, 0.05221390351653099, 0.05155787616968155, -0.035455357283353806, 0.014507175423204899, -0.07806739211082458, 0.002929763635620475, -0.04568343982100487, -0.015058835968375206, 0.00878929067403078, 0.05892328545451164, 0.014633907936513424, 0.05292957276105881, 0.07627822458744049, -0.010436817072331905, 0.021648939698934555, -0.009862791746854782, 0.014835190027952194, -0.009214218705892563, -0.001568318111822009, 0.015998149290680885, 0.035097524523735046, 0.03083333931863308, -0.008834020234644413, -0.0178618673235178, -0.01162959635257721, -0.04478885605931282, -0.014141886495053768, 0.03315925970673561, -0.004819572903215885, -0.027657564729452133, 0.023035546764731407, -0.05764104798436165, -0.049112677574157715, 0.04127015545964241, 0.033427633345127106, -0.010995931923389435, -0.055016934871673584, -0.029595831409096718, 0.017340024933218956, 0.015066290274262428, 0.014194071292877197, 0.009683875367045403, 0.023676665499806404, -0.010332448408007622, -0.01427607424557209, -0.019695764407515526, -0.013530587777495384, 0.00269866269081831, -0.020992912352085114, -0.005736521910876036, 0.00163541198708117, 0.004189636558294296, -0.0031086804810911417, 0.05761123076081276, 0.03709542751312256, -0.014171706512570381, 0.006888299249112606, -0.033606551587581635, 0.07132818549871445, -0.0026912076864391565, 0.023855581879615784, 0.0034460132010281086, -0.0002786257246043533, -0.037125248461961746, 0.003969717770814896, -0.01699710264801979, 0.017802227288484573, -0.0044058277271687984, -0.011294126510620117, -0.02206641249358654, -0.034769508987665176, -0.0020799085032194853, 0.02888016402721405, -0.029610740020871162, 0.016102517023682594, -0.05003708228468895, -0.035425540059804916, -0.01757858134806156, 0.06691490858793259, 0.00204263417981565, 0.00278066610917449, 0.008975662291049957, 0.00909494049847126, -0.046607840806245804, -0.039689723402261734, -0.0004118815122637898, 0.06321728974580765, 0.00965405534952879, 0.048277731984853745, -0.010011889040470123, -0.025152727961540222, -0.00654910271987319, -0.0066795628517866135, -0.05626935139298439, 0.06607995927333832, -0.01905464567244053, -0.022737350314855576, -0.012598728761076927, -0.0033285990357398987, 0.014753186143934727, 0.010377177968621254, -0.013985334895551205, 0.02667352184653282, -0.044699396938085556, -0.016654178500175476, 0.03286106511950493, 0.03807947039604187, 0.019874680787324905, 0.009758424013853073, -0.030892977491021156, -0.030311498790979385, 0.003386374330148101, -0.05236300081014633, -6.971467519178987e-05, -0.01619197614490986, 0.015953419730067253, -0.0066124689765274525, 0.0088042002171278, -0.045772895216941833, -0.001451835734769702, -0.02087363414466381, 0.05227354168891907, -0.025376373901963234, -0.010824469849467278, -0.03685687482357025, 0.010615733452141285, 0.018428437411785126, -0.023617025464773178, -0.030892977491021156, -0.07323663681745529, -0.009758424013853073, -0.01056354958564043, 0.02561493031680584, -0.007507053203880787, 0.029759837314486504, -0.0060943556018173695, -0.03199629858136177, -0.01209925301373005, -0.010981022380292416, -0.0514385960996151, -0.004133725073188543, -0.015066290274262428, 0.0030099034775048494, -0.013321851380169392, 0.018383707851171494, 0.0022457793820649385, 0.007738154381513596, -0.03098243661224842, 0.023930130526423454, -0.015357030555605888, -0.01018335111439228, -0.002607340458780527, -0.005050674080848694, -0.030624601989984512, -0.03754272311925888, 0.0003145023074466735, -0.04571325704455376, 0.016281435266137123, 0.016892733052372932, -0.0042045461013913155, 0.031042074784636497, -0.009422955103218555, 0.007518235594034195, -0.004182181786745787, -0.0011788011761382222, 0.02642005681991577, -0.013672229833900928, 0.03963008522987366, -0.004059176426380873, -0.00593407591804862, 0.029700199142098427, 0.03736380487680435, -0.03974936157464981, -0.01270309742540121, 0.04514668881893158, -0.045564159750938416, 0.0002974958624690771, 0.0031832291278988123, 0.03709542751312256, -0.012546544894576073, 0.026360416784882545, 0.002499244874343276, -0.02381085231900215, -0.011077935807406902, -0.025734208524227142, -0.005557605065405369, -0.03718488663434982, -0.0015589995309710503, 0.02452651970088482, 0.02398976869881153, -0.05981786921620369, 0.019218653440475464, 0.03587283194065094, -0.038168929517269135, -0.00862528383731842, 0.0089309336617589, -0.036976151168346405, 0.013694594614207745, -0.0014210843946784735, -0.007283407263457775, 0.052810292690992355, -0.027016445994377136, 0.007738154381513596, -0.024258144199848175, -0.002978220349177718, -0.05459946393966675, -0.01356786210089922, 0.042880408465862274, -0.011681780219078064, -0.010712646879255772, 0.019591396674513817, 0.0072088586166501045, 0.026867348700761795, -0.04076322540640831, 0.00200163247063756, -0.026733161881566048, -0.03804965317249298, -0.033099617809057236, -0.014618998393416405, 0.007600239012390375, 0.031220993027091026, 0.0006448461790569127, -0.03930206969380379, -0.012650912627577782, -0.007097035646438599, -0.01750403270125389, -0.004409555345773697, -0.0043387338519096375, 0.008722197264432907, -0.011227033101022243, 0.009646601043641567, -0.023467928171157837, -0.022021682932972908, -0.027761932462453842, 0.002864533569663763, 0.01532721146941185, 0.022111142054200172, 0.019740493968129158, -0.008200355805456638, 0.006921845953911543, 0.0135529525578022, -0.027597926557064056, -0.0018767633009701967, 0.023318830877542496, 0.02996857464313507, -0.007190221454948187, 0.01162959635257721, -0.02348283864557743, 0.012211075983941555, 0.014797915704548359, -0.015923600643873215, -0.03137008845806122, -0.02604731358587742, -0.023110095411539078, 0.0026054768823087215, 0.002402331680059433, 0.02254352532327175, 0.02018778584897518, -0.017668040469288826, 0.0135529525578022, 0.01242726668715477, -0.004100177902728319, -0.03569391369819641, -0.0141866160556674, -0.009825517423450947, -0.00037087974487803876, 0.02297590672969818, 0.032085757702589035, 0.01209925301373005, 0.05606061592698097, 0.023646844550967216, 0.0038914417382329702, -0.02272244170308113, 0.007969255559146404, 0.011241942644119263, -0.025629840791225433, 0.0020500889513641596, -0.009795698337256908, 0.0095645971596241, -0.03372582793235779, -0.029327455908060074, 0.014119522646069527, -0.013970425352454185, -0.008670012466609478, -0.056358810514211655, -0.04705513268709183, -0.00938568077981472, -0.016982192173600197, 0.04147889092564583, -0.01394806057214737, -0.0013409445527940989, -0.00855073519051075, -0.013128024525940418, -0.013001292012631893, -0.001287828665226698, -0.03199629858136177, -0.008998027071356773, 0.03289088234305382, -0.0013810144737362862, 0.03611138463020325, -0.016102517023682594, -0.09100904315710068, -0.003980900160968304, 0.013769143261015415, -0.02999839372932911, -0.013120570220053196, -0.0352168008685112, -0.0006611536955460906, 0.0021060004364699125, 0.05862509086728096, 0.03050532564520836, -0.011361220851540565, -0.0183687973767519, 0.011987430043518543, 0.0064223697409033775, 0.019427388906478882, -0.010585914365947247, -0.01945720799267292, 0.017697859555482864, 0.02442215196788311, 0.025734208524227142, -0.01631125435233116, -0.006455916911363602, -0.011420859955251217, -0.0455939806997776, 0.023110095411539078, 0.015998149290680885, 0.006836114916950464, -0.050126541405916214, -0.0016521853394806385, -0.014447536319494247, -0.008923478424549103, -0.017190927639603615, -0.0020407703705132008, -0.01085428986698389, -0.0402861125767231, -0.025122908875346184, 0.0296405591070652, 0.003716252278536558, 0.011801058426499367, 0.009318586438894272, 0.02148493379354477, 0.015312300994992256, 0.023318830877542496, -0.012434721924364567, -0.02112709917128086, -0.0013623773120343685, -0.0243177842348814, 0.02285662852227688, 0.023527566343545914, 0.014156796969473362, 0.02500363066792488, 0.004044266417622566, 0.015245207585394382, 0.0050693112425506115, 0.02047106996178627, 0.017653129994869232, -0.02166385017335415, -0.004610836505889893, -0.005591151770204306, -0.02460106834769249, 0.014164251275360584, 0.004059176426380873, 0.03942134976387024, -0.04705513268709183, 0.008655102923512459, 0.020709626376628876, -0.014119522646069527, -0.040166836231946945, -0.012800010852515697, 0.038496945053339005, -0.019144104793667793, 0.0101982606574893, 0.004446829669177532, 0.0117190545424819, 0.017190927639603615, 0.05322776734828949, 0.004070358816534281, 0.016042878851294518, 0.0021209102123975754, -0.00012463609164115041, -0.0017901004757732153, -0.023095184937119484, -0.007160401903092861, 0.03837766498327255, -0.042045462876558304, -0.024630887433886528, -0.010011889040470123, -0.02036670222878456, -0.020530709996819496, 0.03029658831655979, -0.01978522352874279, -0.030564963817596436, 0.005140132270753384, -0.01065300777554512, -0.0002693071437533945, -0.017802227288484573, 0.04446084052324295, -0.03405384346842766, -0.12154418975114822, -0.041359614580869675, 0.0435662567615509, -0.00023541078553535044, -0.0009239378268830478, 0.008043804205954075, 0.05576242133975029, 0.024138865992426872, -0.03324871510267258, -0.013597681187093258, 0.0074585964903235435, -0.04684639722108841, 0.025167638435959816, -0.012382538057863712, 0.005140132270753384, -0.05048437416553497, -0.0030154946725815535, -0.0012365764705464244, 0.01725056767463684, -0.009892611764371395, -0.030311498790979385, -0.01197251956909895, -0.009378225542604923, 0.04115087911486626, -0.044371381402015686, -0.0002998255076818168, 0.023885400965809822, -0.019919410347938538, -0.03333817422389984, -0.0005758886691182852, -0.020515799522399902, -0.002314736833795905, -0.002437742194160819, -0.0020966818556189537, -0.04082286357879639, -0.020664896816015244, 0.026226229965686798, -0.028134675696492195, -0.01981504261493683, 0.0027694839518517256, 0.007037396542727947, -0.017906595021486282, 0.02616659179329872, -0.025570200756192207, 0.03485896810889244, -0.04923195764422417, 0.023423198610544205, -0.008998027071356773, -0.005281774792820215, 0.01575959287583828, 0.018324067816138268, -0.045743077993392944, -0.004745024256408215, -0.017190927639603615, -0.0070746708661317825, -0.0004808390513062477, 0.027955759316682816, 0.007518235594034195, -0.013515678234398365, -0.013135479763150215, 0.0009267334244213998, 0.015640316531062126, 0.014082248322665691, -0.01960630528628826, -0.04899340122938156, -0.030714061111211777, -0.0030807247385382652, 0.03739362582564354, -0.0127925556153059, -0.03154900670051575, 0.0011638914002105594, 0.031071895733475685, 0.012464541010558605, 0.02743391878902912, -0.013068385422229767, -0.01326221227645874, 0.036827053874731064, 0.010913928970694542, -0.040852684527635574, 0.03196647763252258, 0.023289011791348457, -0.052989210933446884, 0.012926743365824223, 0.04815845564007759, 0.0423138365149498, 0.028671426698565483, -0.031608644872903824, -0.018786270171403885, -0.012307989411056042, 0.01541666965931654, 0.02642005681991577, -0.01623670570552349, 0.004707749933004379, -0.031399909406900406, -0.0049351234920322895, -0.01124939788132906, -0.009952249936759472, 0.027016445994377136, 0.013679685071110725, -0.02568947896361351, 0.008774381130933762, 0.011838332749903202, -0.053287405520677567, -0.001650321646593511, -0.004987307358533144, 0.02652442455291748, 0.006392550189048052, -0.005978805013000965, 0.03324871510267258, -0.00037833460373803973, -0.021186739206314087, -0.006470826454460621, -0.0026539333630353212, 0.020918363705277443, -0.006552829872816801, 0.03238395228981972, 0.04428192228078842, 0.003088179510086775, 0.0276128351688385, 0.021276196464896202, -0.007316953968256712, 0.04598163440823555, -0.01411206740885973, 0.000642516533844173, 0.009042756631970406, 0.007931981235742569, -0.021470023319125175, 0.015014106407761574, -0.020053599029779434, 0.013836237601935863, 0.01534212101250887, -0.009445318952202797, 0.00446546683087945, -0.016072697937488556, -0.017012011259794235, 0.01308329589664936, 0.011376130394637585, 0.006340366322547197, 0.0002846828137990087, 0.035425540059804916, 0.007656150497496128, 0.003619339084252715, 0.005620971322059631, 0.018935367465019226, 0.005952713079750538, -0.00842400174587965, 0.004241820424795151, -0.013060931116342545, -0.026032403111457825, -0.004979852586984634, 0.0123527180403471, -0.0024284236133098602, 0.009996979497373104, 0.016147246584296227, -0.00036948194610886276, -0.005494238808751106, 0.014387897215783596, -0.02082890458405018, -0.007671060506254435, 0.0243177842348814, -0.0009062325116246939, 0.023542476817965508, -0.01985977217555046, -0.03736380487680435, 0.04329787939786911, -0.03742344304919243, -0.008401637896895409, 0.033755648881196976, 0.026748070493340492, 0.002680025529116392, -0.03137008845806122, -0.04314878210425377, 0.013493313454091549, 0.01717601902782917, 0.030594782903790474, 0.0009914976544678211, -0.022185690701007843, 0.01644544117152691, -0.002051952760666609, 0.03068424202501774, 0.03303997963666916, 0.011331400834023952, -0.012591274455189705, -0.027299731969833374, 0.04806899651885033, -0.02731464058160782, 0.029431823641061783, -0.0034199212677776814, -0.006388823036104441, 0.020992912352085114, 0.02409413643181324, 0.018726631999015808, -0.006884571630507708, 0.029879115521907806, -0.0433277003467083, -0.031578827649354935, 0.016833094879984856, 0.03655868023633957, 0.011115210130810738, -0.029431823641061783, -0.06774985045194626, 0.03810929134488106, -0.0043610986322164536, -0.010421907529234886, -0.035664092749357224, 0.036827053874731064, -0.0003589985426515341, -0.008036348968744278, 0.005196043755859137, 0.016907643526792526, -0.007454869337379932, 0.026032403111457825, -0.051289498805999756, 0.0296405591070652, 0.009012936614453793, -0.034262578934431076, -0.013195118866860867, -0.01409715786576271, -0.00795434508472681, 0.0019270837074145675, -0.00800652988255024, -0.016758546233177185, 0.028641607612371445, 0.006936755962669849, 0.009229128248989582, -0.0020239970181137323, 0.054480183869600296, 0.0109586575999856, 0.017012011259794235, -0.007723244372755289, -0.027448829263448715, 0.03303997963666916, -0.008110897615551949, 0.02199186384677887, 0.014030063524842262, -0.028268864378333092, -0.009572052396833897, 0.01403751876205206, 0.0050693112425506115, -0.006284454837441444, 0.04443101957440376, 0.030773699283599854, -0.0034143300727009773, -0.0163410734385252, 0.0027489829808473587, -0.0034050114918500185, 0.026151681318879128, 0.04335751757025719, -0.03709542751312256, 0.01532721146941185, -0.009922430850565434, 0.02366175502538681, 0.008446366526186466, 0.012449631467461586, 0.013292031362652779, -0.013970425352454185, 0.019114283844828606, 0.05474856123328209, 0.014738276600837708, 0.015804322436451912, -0.023348649963736534, 0.013575316406786442, 0.0006108333473093808, -0.012240895070135593, -0.01318766362965107, -0.005945258308202028, 0.010228080675005913, 0.01327712181955576, 0.03435203805565834, 0.008088532835245132, -0.04082286357879639, 0.027702294290065765, 0.001899127964861691, 0.05134914070367813, 0.0002825861447490752, 0.006728019565343857, 0.019159013405442238, -0.008148171938955784, 0.029357274994254112, -0.005997442174702883, 0.01844334602355957, 0.019546667113900185, -0.021827857941389084, 0.02376612275838852, 0.011696689762175083, -0.027553196996450424, -0.0019885862711817026, -0.0010036117164418101, 0.0025588837452232838, 0.008356908336281776, 0.028522329404950142, 0.035276442766189575, -0.018681902438402176, -0.009176944382488728, -0.0013810144737362862, -0.014932103455066681, 0.00032941202516667545, -0.004745024256408215, 0.015103564597666264, -0.009840426966547966, 0.03634994104504585, 0.024645797908306122, -0.003684569150209427, -0.018711721524596214, 0.032443590462207794, 0.005937803536653519, -0.0022085050586611032, -0.014261164702475071, -0.004931395873427391, 0.0029073990881443024, -0.003483287524431944, -0.015014106407761574, 0.01778731867671013, 0.010899018496274948, 0.005404780153185129, 0.003157137194648385, -0.015386849641799927, -0.016803275793790817, -0.0055091483518481255, 0.01541666965931654, 0.00104181794449687, -0.03274178504943848, -0.0043610986322164536, 0.018145151436328888, -0.03590264916419983, -0.006433552131056786, 0.01549121830612421, 0.014380442909896374, 0.0010530002182349563, 0.014030063524842262, 0.0016121154185384512, 0.01945720799267292, 0.024302873760461807, -0.017146199941635132, -0.06429079174995422, 0.0038578948006033897, -0.02518254891037941, -0.006619923748075962, -0.014827734790742397, -0.008066168054938316, 0.02057543955743313, 0.014753186143934727, 0.007044851314276457, -0.020277244970202446, 0.0018972642719745636, 0.00036412375629879534, -0.0026912076864391565, 0.024839624762535095, 0.003734889440238476, -0.013053475879132748, 0.08349453657865524, -0.04025629535317421, -0.02416868507862091, 0.02391522005200386, -0.016475260257720947, 0.017727678641676903, -0.008774381130933762, 0.020635077729821205, -0.023795941844582558, 0.0198895912617445, -0.00818544626235962, 0.022200601175427437, -0.011912881396710873, -0.00748096127063036, 0.0271059051156044, 0.021007820963859558, -0.00547187402844429, 0.033636368811130524, 0.018204791471362114, -0.00014269085659179837, 0.0018543987534940243, -0.010630643926560879, 0.01001934427767992, -0.002037042984738946, 0.011890516616404057, 0.008863839320838451, -0.03473969176411629, 0.0040815407410264015, 0.011540137231349945, 0.017384754493832588, -0.012725462205708027, -0.032234854996204376, -0.040017738938331604, -0.00023855581821408123, -0.01728038676083088, 0.002510427264496684, -0.01250181533396244, 0.03357673063874245, 0.005676882807165384, -0.016117427498102188, 0.005438326857984066, -0.013418764807283878, -0.007078398484736681, -0.00556133221834898, 0.013306941837072372, 0.026912078261375427, 0.023497747257351875, 0.01031008455902338, 0.00809598807245493, -0.01241235714405775, 0.00800652988255024, -0.0027322096284478903, 0.016877824440598488, -0.0031273176427930593, -0.011562502011656761, -0.0003524755302350968, -0.00050040811765939, 0.01750403270125389, 0.01327712181955576, 0.017548762261867523, -0.013933150097727776, 0.01380641758441925, -0.05275065451860428, 0.02601749263703823, 0.018413526937365532, -0.01233780849725008, -0.01326221227645874, 0.015006652101874352, -0.01649017073214054, 0.049947623163461685, -0.03453095257282257, 0.0206499882042408, -0.009967160411179066, -0.003032268024981022, -0.01892045885324478, 0.00254583777859807, -0.01796623505651951, 0.00632172916084528, 0.01003425382077694, 0.0012020976282656193, -0.0005945258308202028, 0.001986722694709897, -0.022006774321198463, 0.005468146409839392, -0.02938709408044815, 0.008252540603280067, 0.003842985024675727, -0.02166385017335415, -0.0486355684697628, 0.029551101848483086, 0.0014080384280532598, 0.007730699144303799, 0.027836481109261513, 0.011555047705769539, -0.028567058965563774, -0.011473043821752071, -0.007149219512939453, 0.01796623505651951, -0.007268497254699469, 0.012076888233423233, -0.004983580205589533, -0.00492766872048378, 0.009765878319740295, 0.036618318408727646, -0.016355983912944794, -0.006769021041691303, -0.03736380487680435, 0.015446488745510578, 0.0032820061314851046, -0.010921383276581764, 0.007447414565831423, -0.02018778584897518, 0.02272244170308113, 0.029774747788906097, -0.002730345819145441, 0.04493795335292816, 0.029357274994254112, 0.03453095257282257, 0.007775428704917431, 0.023303920403122902, 0.006139084696769714, 0.008953297510743141, 0.008945843204855919, 0.0035783371422439814, 0.005766341462731361, 0.02300572581589222, -0.01525266282260418, 0.003943625837564468, -0.016877824440598488, -0.005647063255310059, -0.026867348700761795, 0.021365655586123466, 0.018070602789521217, -0.03131045028567314, -0.00716412952169776, 0.023706484586000443, 0.01775749772787094, -0.047442786395549774, -0.019114283844828606, -0.0008885271963663399, 0.016877824440598488, 0.003798255929723382, -0.0141866160556674, 0.02181294746696949, -0.02254352532327175, -0.04335751757025719, 0.01821970008313656, -0.01502156164497137, 0.03560445457696915, 0.012017249129712582, 0.01930811069905758, 0.01742948405444622, 0.015998149290680885, 0.006843570154160261, -0.016803275793790817, -0.0061726318672299385, 0.0010203851852566004, -0.03867586329579353, -0.0014117658138275146, 0.01892045885324478, 0.0268524382263422, -0.004644383676350117, 2.5058261599042453e-05, 0.025644749402999878, 0.012419812381267548, -0.021753307431936264, -0.014454991556704044, -0.012740371748805046, 0.012531635351479053, 0.009713694453239441, 0.003304370678961277, -0.0021320926025509834, 0.020053599029779434, 0.0062285433523356915, -0.007894706912338734, -0.012829829938709736, -0.005218408536165953, -0.0021115916315466166, 0.0022662803530693054, -0.003254050388932228, -0.0031757743563503027, 0.012136527337133884, 0.01496192254126072, 0.023244282230734825, -0.013962970115244389, 0.013813872821629047, 0.029402004554867744, 0.011025751940906048, 0.01009389292448759, 0.022304968908429146, -0.005106585565954447, -0.03298034146428108, 0.012665823101997375, -0.005997442174702883, 0.01778731867671013, 0.03703578934073448, 0.0012915560510009527, -0.0007198608363978565, -0.0009840427665039897, 0.01520047802478075, 0.011987430043518543, -0.003356554778292775, -0.013284577056765556, 0.001975540304556489, -0.020202696323394775, 0.0006644152454100549, 0.0018478756537660956, 0.004808390513062477, 0.01880118064582348, 0.0226777121424675, 0.021499842405319214, -0.020456161350011826, 0.04144907370209694, 0.0121588921174407, 0.028611788526177406, 0.01742948405444622, -0.003099361900240183, 0.021186739206314087, -0.024943992495536804, -0.02072453685104847, -0.003449740819633007, -0.01270309742540121, 0.05081238970160484, -0.015789413824677467, 0.0016437986632809043, 0.02130601555109024, -0.005188588984310627, 0.024437060579657555, 0.0101982606574893, 0.01692255400121212, -0.006884571630507708, -0.02424323558807373, -0.012203620746731758, 0.03787073493003845, -0.008163081482052803, -0.02756810560822487, -0.02246897667646408, -0.015893781557679176, 0.011495408602058887, 0.009162033908069134, -0.029088899493217468, 0.04765152558684349, -0.017340024933218956, -0.023378469049930573, -0.011279216967523098, 0.05489765852689743, -0.003473968943580985, -0.0010464772349223495, -0.026136770844459534, 0.014082248322665691, 0.01103320624679327, 0.00717531144618988, -0.024377422407269478, -0.02579384669661522, 0.016877824440598488, -0.0168480034917593, -0.013008746318519115, -0.016579629853367805, -0.012591274455189705, 0.031220993027091026, -0.03709542751312256, 0.010101348161697388, -0.005483056418597698, 0.0031385000329464674, -0.029044169932603836, 0.028969621285796165, -0.02485453337430954, 0.0005274320137687027, -0.029193267226219177, -0.0331890769302845, -0.020888542756438255, 0.04138943552970886, 0.015878871083259583, -0.002965174149721861, 0.012061978690326214, 0.04210510104894638, 0.04771116375923157, -0.001342808362096548, 0.009907521307468414, -0.02518254891037941, 0.013687140308320522, -0.02166385017335415, -0.02533164620399475, 0.013858601450920105, 0.01079465076327324, 0.004916486330330372, -0.013582771643996239, -0.008230175822973251, -0.009698784910142422, 0.023930130526423454, -0.027597926557064056, 0.019993958994746208, -0.00029772883863188326, -0.005792433395981789, -0.025167638435959816, -0.0029073990881443024, 0.010406997054815292, -0.018890637904405594, -0.028939802199602127, 0.0004107166896574199, -0.00756296468898654, -0.034620411694049835, 0.026315689086914062, -0.016117427498102188, 0.03760236129164696, 0.03336799517273903, -0.034113481640815735, 0.021335836499929428, 0.002683752914890647, -0.004633201286196709, 0.013836237601935863, -0.013769143261015415, -0.015312300994992256, 0.008863839320838451, 0.0010688418988138437, 0.012546544894576073, -0.01616215705871582, -0.006377640645951033, -0.03247341141104698, 0.0013800826855003834, -0.028209224343299866, 0.0031198628712445498, 0.004681657999753952, -0.015804322436451912, 0.01503647118806839, 0.009840426966547966, -0.006258362904191017, 0.01699710264801979, 0.01717601902782917, -0.01550612784922123, 0.036320123821496964, 0.01141340471804142, 0.03924243152141571, 0.014454991556704044, 0.006064536049962044, 0.018816089257597923, 0.0010967976413667202, -0.00020081554248463362, 0.017474213615059853, -0.027821572497487068, -0.014894829131662846, 0.00017914982163347304, 0.005982532631605864, 0.03080352023243904, -0.011659415438771248, 0.014030063524842262, 0.01402260921895504, -0.018130242824554443, -0.012240895070135593, 0.012867104262113571, 0.019680853933095932, 0.036827053874731064, -0.03921261057257652, -0.019397569820284843, -0.014208980835974216, 0.008699832484126091, 0.004074085969477892, -0.017697859555482864, -0.005132677499204874, -0.011622141115367413, -0.017116378992795944, -0.01804078370332718, -0.007160401903092861, 0.022916268557310104, -0.03315925970673561, 0.003813165705651045, -0.02518254891037941, -0.020500890910625458, -0.010339903645217419, -0.004681657999753952, 0.01757858134806156, 0.039003875106573105, 0.02612186223268509, 0.005292957182973623, -0.024645797908306122, -0.0038877143524587154, 0.009624236263334751, -0.034292399883270264, 0.0010492728324607015, -0.02272244170308113, 0.0055874246172606945, -0.030490415170788765, 0.004107633139938116, -0.007167856674641371, 0.012039613910019398, 0.0007972050807438791, 0.027046265080571175, 0.024630887433886528, -0.01641562208533287]",Model Alignment as Prospect Theoretic Optimization.pdf
" are deployed in real-world settings, are
also needed to judge the merits of different HALOs.
6. Conclusion
Although model alignment has historically been reward-
centric, we found that the inductive biases of alignment
objectives are critical to their success. Moreover, these in-
ductive biases have analogs in the prospect theory literature,
suggesting that they work in part because they reflect human
biases in decision-making. We abstracted these insights into
a family of alignment objectives called human-aware losses
(HALOs). We then proposed a HALO called Kahneman-
Tversky Optimization (KTO) for directly maximizing the
utility of generations instead of maximizing the likelihood of
preferences, as existing methods do. Despite only learning
from a binary signal of whether an output is (un)desirable,
KTO was as good or better than preference-based methods
in our experiments. More broadly, our work suggests that
akin to how there is no one reward model that is univer-
sally superior, there is no one loss function either—the best
HALO depends on the inductive biases that are most ap-
propriate for a given setting, and much work remains to be
done in identifying the best HALO for each context.
9
Model Alignment as Prospect Theoretic Optimization
Acknowledgements
We thank Percy Liang, Dilip Arumugam, Arya McCarthy,
and Nathan Lambert for feedback. We thank Stas Bekman
and Gautam Mittal for cluster assistance and Alex Manthey
for helping with human evaluation.
Impact Statement
The methods discussed in this paper have the potential to
make LLMs more helpful and safer, which is often needed
for models deployed in production. It is possible that in
making models more helpful, we increase the utility of one
person at the expense of broader society. In aligning models
with human feedback, one may also—without even fully
recognizing it—be aligning to an unrepresentative subset of
the population, which may hinder the ability of individuals
outside that subset to benefit equally from using the model.
The data used for LLM alignment, including the datasets
used in this paper (e.g., SHP, HH, OASST) contain prefer-
ences of groups that are not representative of the broader
population. Biases in this data have the potential to be propa-
gated downstream when used to align models with methods
like KTO, especially when no efforts are made to adjust
for the different population. KTO in particular implicitly
resolves contradictions in feedback by taking the majority-
preferred outcome for a loss-neutral value function, which
does not comport with many theories of fairness (e.g., Rawl-
sianism). Since user preferences are, in turn, affected by the
models they interact with, this also risks the homogeniza-
tion of preferences and utility functions when KTO-aligned
models are deployed at scale. The design of HALOs that
resolve contradictions in more diverse ways is an important
direction for future work.
On the other hand, because KTO works with binary feed-
back, which is more abundant, cheaper, and faster to collect
in the real world, it significantly lowers the barrier to data
collection. This makes it easier to collect feedback from
traditionally under-represented groups and serve different
models to different users, instead of just one monolithic
model being served to everyone.
References
Azar, M. G., Guo, Z. D., Piot, B., Munos, R., Rowland, M.,
Valko, M., and Calandriello, D. A general theoretical
paradigm to understand learning from human preferences.
InInternational Conference on Artificial Intelligence and
Statistics , pp. 4447–4455. PMLR, 2024.
Baheti, A., Lu, X., Brahman, F., Le Bras, R., Sap, M., and
Riedl, M. Improving language models with advantage-
based offline policy gradients. In The Twelfth Interna-
tional Conference on Learning Representations , 2023.Bai, Y ., Jones, A., Ndousse, K., Askell, A., Chen, A., Das-
Sarma, N., Drain, D., Fort, S., Ganguli, D., Henighan, T.,
et al. Training a helpful and harmless assistant with rein-
forcement learning from human feedback. arXiv preprint
arXiv:2204.05862 , 2022.
Biderman, S., Schoelkopf, H., Anthony, Q. G., Bradley,
H., O’Brien, K., Hallahan, E., Khan, M. A., Purohit, S.,
Prashanth, U. S., R","[-0.015308600850403309, 0.040297240018844604, 0.0506298691034317, 0.029556749388575554, 0.020298171788454056, -0.011488248594105244, -0.024104928597807884, 0.031623274087905884, -0.014411293901503086, 0.04201028123497963, 0.022119976580142975, -0.04217343032360077, -0.0011292812414467335, -0.03597385436296463, 0.016056356951594353, -0.014588036574423313, 0.05054829269647598, -0.05019481107592583, 0.009809196926653385, 0.05209818854928017, -0.024607963860034943, 0.00425541028380394, -0.003014815505594015, 0.05307706817984581, 0.026756063103675842, -0.00021413007925730199, 0.022745372727513313, 0.028768206015229225, -0.019917495548725128, -0.025967519730329514, 0.08793608844280243, -0.033064402639865875, -0.06112563982605934, 0.0005221544997766614, -0.027707751840353012, 0.0678146556019783, 0.014723991975188255, 0.000816583342384547, 0.013092524372041225, 0.007994189858436584, -0.025967519730329514, -0.04820985719561577, 0.020379744470119476, 0.06629195064306259, -0.007613514084368944, 0.016872091218829155, 0.027000783011317253, -0.005156116560101509, -0.022419080138206482, 0.016097143292427063, -0.05171751230955124, 0.02061086893081665, -0.023058069869875908, -0.02825157530605793, 0.0007634757203049958, -0.004891003016382456, 0.018639514222741127, 0.012147633358836174, 0.03619138151407242, 0.006019434425979853, -0.04791075363755226, -0.029094500467181206, 0.0036470091436058283, 0.03809475898742676, -0.03551160544157028, -0.03654486685991287, -0.09723544865846634, 0.0008492976776324213, -0.01755186915397644, 0.030508438125252724, 0.013289660215377808, 0.014316124841570854, 0.010958021506667137, 0.0178509708493948, -0.029475174844264984, -0.019550416618585587, 0.023697061464190483, 0.0962565690279007, 0.00927217211574316, -0.013976235873997211, -0.004398163873702288, 0.005965052172541618, 0.06030990555882454, -0.04035162553191185, -0.0007520044455304742, -0.0067060100845992565, -0.04258129745721817, -0.008028178475797176, -0.07080567628145218, 0.001964558381587267, -0.03420643135905266, -0.0165186058729887, -0.016097143292427063, -0.008075762540102005, 0.02817000076174736, 0.00031992053845897317, -0.00316946511156857, -0.017524678260087967, 0.06253957748413086, 0.006383115891367197, -0.02354751154780388, -0.01896580681204796, 0.02069244347512722, -0.016369054093956947, 0.04426714405417442, -0.014615227468311787, 0.025518866255879402, -0.005788309965282679, 0.030671585351228714, 0.029420793056488037, -0.10223861783742905, 0.006454492453485727, -0.05769955739378929, -0.01789175719022751, -0.0032510384917259216, -0.08026818931102753, -0.07662457972764969, 0.03110664337873459, 0.007531940471380949, -0.03230305016040802, -0.01586601883172989, -0.021834470331668854, 0.0502220019698143, 0.013534380123019218, -0.007076489273458719, -0.03874734789133072, 0.04307073727250099, -0.03697992488741875, 0.0032680328004062176, -0.05228852480649948, -0.018992997705936432, 0.044049616903066635, 0.004309792537242174, -0.024268075823783875, -0.07058814913034439, 0.0007413828861899674, -0.011705777607858181, -0.007681491784751415, -0.007300816010683775, -0.027231907472014427, -0.0009109025704674423, -0.06237643212080002, -0.0696636512875557, -0.020950758829712868, -0.08690281957387924, 0.01222920697182417, -0.00038025082903914154, -0.0039019258692860603, -0.04736693203449249, 0.04456624761223793, 0.027150334790349007, -0.024485604837536812, -0.024934258311986923, 0.03793161362409592, -0.02498864009976387, -0.03420643135905266, -0.020950758829712868, 0.03572913259267807, 0.007960200309753418, -0.04758446291089058, 0.044049616903066635, 0.048835255205631256, 0.0031167822889983654, 0.022106381133198738, 0.0309434961527586, 0.00602963101118803, -0.0038305490743368864, 0.029801469296216965, -0.057427648454904556, -0.031161025166511536, 0.0074911536648869514, -0.012902187183499336, -0.037442173808813095, -0.014220956712961197, -0.001652710372582078, 0.007742671761661768, -0.015009499154984951, -0.0309434961527586, -0.03779565915465355, -0.05595932900905609, 0.0021684919483959675, 0.012691455893218517, -0.017497485503554344, 0.004948784131556749, -0.07308973371982574, 0.014193764887750149, -0.013500391505658627, 0.008884699083864689, -0.005951456725597382, 0.07428614050149918, 0.01511826366186142, 0.018857043236494064, 0.08271539211273193, -0.025056617334485054, 0.0028924555517733097, -0.003942712675780058, 0.039671845734119415, 0.04641524329781532, -0.00897986814379692, -0.024254480376839638, 0.032112713903188705, 0.029094500467181206, 0.04290758818387985, -0.08124706894159317, -0.01090363971889019, -0.001015418441966176, -0.012609882280230522, 0.004860412795096636, -0.031704846769571304, -0.018109286203980446, 0.03630014508962631, 0.011284315027296543, 0.05043952912092209, 0.039590273052453995, 5.756870086770505e-05, -0.028713824227452278, -0.0636272206902504, 0.004289399366825819, -0.01722557470202446, 0.06438857316970825, 0.014356912113726139, 0.04220062121748924, -0.005383842159062624, 0.005808703135699034, -0.04546355456113815, 0.0029264444019645452, 0.01838119700551033, -0.027027973905205727, 0.04179275408387184, -0.04279882460832596, 0.05737326666712761, -0.024064142256975174, -0.007790256291627884, 0.008809923194348812, 0.0037251836620271206, -0.04799233004450798, 0.0128885917365551, -0.024390434846282005, 0.009265374392271042, -0.05285954102873802, -0.001449626637622714, -0.009000261314213276, 0.01986311376094818, -0.011012404225766659, 0.005383842159062624, 0.05688382685184479, -0.03697992488741875, -0.0030080177821218967, 0.005009964108467102, -0.015335792675614357, 0.025831565260887146, -0.013704325072467327, -0.01573006436228752, -0.011719373054802418, -0.01817726530134678, -0.01257589366286993, -0.0031320771668106318, -0.0033869941253215075, -0.018489962443709373, 0.0009737820364534855, -0.020135024562478065, 0.020393339917063713, -0.003963105846196413, 0.01779658906161785, -0.006461290176957846, 0.002047831192612648, -0.0314057432115078, -0.00952368974685669, -0.018150072544813156, -0.027123143896460533, 0.028904162347316742, 0.019183335825800896, -0.01763344183564186, 0.010128692723810673, -0.037197452038526535, -0.03980780020356178, 0.009591667912900448, 0.044212762266397476, -0.009557679295539856, -0.03630014508962631, -0.03352665156126022, 0.03668082132935524, 0.06041867285966873, -0.003364901291206479, 0.022405484691262245, 0.013269267044961452, -0.011617406271398067, -0.017864566296339035, -0.051527176052331924, -0.0013238677056506276, -0.006811375729739666, -0.03333631530404091, 0.028387529775500298, -0.05027638375759125, 0.044838160276412964, 0.02780292183160782, 0.018897829577326775, -0.026035498827695847, 0.003437977284193039, 0.012548702768981457, 0.042227812111377716, -0.0012813815847039223, -0.03741498291492462, -0.021263455972075462, 0.03901926055550575, -0.015634894371032715, -0.0019679574761539698, 0.039671845734119415, 0.022500652819871902, -0.005499404389411211, 0.03260215371847153, -0.01069970615208149, -0.007463962770998478, 0.02271818183362484, -0.03817633539438248, -0.050167620182037354, 0.058297764509916306, -0.025668418034911156, -0.0012516413116827607, 0.012698253616690636, -0.052397292107343674, -0.055497076362371445, 0.0008569451747462153, -0.0046666762791574, 0.013296457938849926, -0.00958487018942833, 0.006760392338037491, 0.004894401878118515, -0.02768056094646454, -0.02936641126871109, -0.007287220563739538, 0.0008667169604450464, 0.004948784131556749, 0.007137669250369072, 0.015757255256175995, -0.014098595827817917, -0.03564755991101265, 0.038230717182159424, 0.011671788990497589, -0.0023877203930169344, -0.05324021354317665, -0.041412077844142914, -0.0488896369934082, -0.01647781953215599, -0.020882781594991684, -0.024145714938640594, 0.016953663900494576, 0.004537518136203289, 0.011889318004250526, 0.020964354276657104, -0.020175812765955925, -0.03184080123901367, 0.011121168732643127, 0.026579320430755615, -0.04481096938252449, 0.03730621933937073, -0.025260550901293755, -0.011080381460487843, 0.009870377369225025, 0.011923306621611118, -0.007939807139337063, 0.005934461951255798, 0.016083547845482826, 0.017742207273840904, 0.02904011681675911, 0.013785898685455322, -0.015607703477144241, -0.0052478862926363945, -0.010509368032217026, 0.009265374392271042, -0.014723991975188255, 0.006491879932582378, -0.03292844817042351, 0.019264908507466316, -0.05443662405014038, 0.0003891729284077883, -0.009047845378518105, -0.011189145967364311, 0.016831304877996445, 0.006838567089289427, 0.011828137561678886, -0.00021816625667270273, 0.006253957748413086, -0.02668808586895466, 0.018761873245239258, 0.024213694036006927, -0.013160502538084984, -0.031242597848176956, -0.037686895579099655, -0.004823025315999985, 0.02337076887488365, 0.000675104558467865, -0.05682944133877754, 0.04206466302275658, 0.010230659507215023, -0.0007460563792847097, -0.014452081173658371, 0.04160241410136223, 0.05612247437238693, 0.055904943495988846, -0.0412217378616333, 0.00048689101822674274, -0.0498141348361969, 0.011529034934937954, -0.029883041977882385, -0.03697992488741875, -0.015621298924088478, 0.04932469502091408, 0.020379744470119476, 0.027068760246038437, 0.06727083027362823, -0.049052782356739044, 0.03241181746125221, -0.014465676620602608, 0.006583650130778551, -0.024730324745178223, 0.015675680711865425, 0.031052259728312492, 0.024023355916142464, 0.027286289259791374, -0.004996368661522865, -0.022772563621401787, 0.004136449191719294, -0.0575907938182354, -0.05612247437238693, 0.016287481412291527, -8.831803279463202e-05, -0.03763251006603241, 0.035457223653793335, -0.07744031399488449, -0.036001045256853104, 0.04282601550221443, 0.023928185924887657, -0.03341788798570633, -0.05457257851958275, -0.024961449205875397, 0.02032536268234253, 0.017456699162721634, 0.020964354276657104, -0.00902745220810175, 0.027979664504528046, -0.0036300146020948887, -0.037768468260765076, -0.012609882280230522, -0.004734653979539871, 0.010713301599025726, -0.048019520938396454, 0.04002533107995987, -0.030372481793165207, -0.022541439160704613, 0.00224666646681726, 0.028469104319810867, 0.03891049325466156, -0.006570054683834314, 0.004452546127140522, -0.03015495277941227, 0.06580251455307007, -0.007192051503807306, 0.04959660395979881, 0.010692908428609371, -0.008130145259201527, -0.01059773936867714, -0.013004153966903687, -0.008911889977753162, 0.0005684643983840942, 0.025369316339492798, -0.007083286996930838, 0.008429247885942459, -0.0270551647990942, -6.951792602194473e-05, 0.007742671761661768, -0.041167356073856354, 0.021385816857218742, -0.043560177087783813, -0.02792528085410595, 0.0032748307567089796, 0.03820352628827095, -0.014356912113726139, -0.005818899720907211, -0.02458077296614647, 0.008864305913448334, -0.04598018527030945, -0.026375386863946915, 0.03208552300930023, 0.04486535117030144, -0.004269006196409464, 0.031079450622200966, 0.009951950050890446, -0.006614240352064371, 0.027490222826600075, 0.011868923902511597, -0.04788356274366379, 0.07765784114599228, -0.01551253441721201, -0.018489962443709373, -0.037360601127147675, 0.01738872192800045, 0.010441390797495842, -0.0018184062791988254, -0.020841993391513824, -0.016450628638267517, -0.03523969277739525, -0.01261668000370264, 0.043016351759433746, 0.02399616502225399, 0.018639514222741127, 0.02085559070110321, -0.0041840337216854095, -0.028822587803006172, 0.05101054161787033, -0.0408138744533062, 0.015335792675614357, -0.01084245927631855, 0.0334450788795948, 0.004333585035055876, 0.029393602162599564, -0.024607963860034943, 0.005166313145309687, 0.00371158798225224, 0.0369255430996418, -0.014071404933929443, -0.007892223075032234, -0.02131783962249756, 0.005149318370968103, 0.005825697910040617, 0.002294250763952732, -0.06330092996358871, -0.06183261051774025, -0.03431519493460655, 0.010896841995418072, 0.01536298356950283, 0.012807018123567104, 0.03407047316431999, 0.00509153725579381, -0.02792528085410595, -0.014017023146152496, 0.0006780785624869168, -0.05174470320343971, -0.02308526262640953, 0.0016960462089627981, -0.004513726104050875, -0.0009601864730939269, 0.023737847805023193, 0.04192870855331421, 0.024648752063512802, -0.03284687548875809, 0.026620106771588326, -0.03891049325466156, 0.0007961899973452091, 0.030209336429834366, 0.008123347535729408, -0.04051477089524269, -0.015580512583255768, -0.01313331164419651, -0.03341788798570633, -0.008952676318585873, -0.0027259099297225475, 0.004829823039472103, 0.03159608319401741, 0.007300816010683775, -2.210606362496037e-05, -0.005244487430900335, -0.015811637043952942, 0.02792528085410595, -0.01424814760684967, 0.010998808778822422, 0.008245707489550114, 0.008769136853516102, 0.014180169440805912, 0.02672887220978737, -0.023221217095851898, -0.005465415306389332, 0.022772563621401787, -0.03279249370098114, 0.011984487064182758, 0.0015447955811396241, 0.006525869015604258, -0.011100775562226772, 0.0178509708493948, 0.01759265549480915, -0.04124893248081207, -0.025831565260887146, -0.03912802413105965, 0.004313191398978233, -0.053702462464571, -0.010794875212013721, 0.0020087440498173237, 0.01664096675813198, -0.04394085332751274, 0.009177003055810928, 0.048590533435344696, -0.05098335072398186, 0.0027717947959899902, -0.020624466240406036, -0.023778636008501053, -0.01216122880578041, -0.0016824506456032395, -0.018286028876900673, 0.04519164189696312, -0.021290648728609085, 0.004795833956450224, -8.279483881779015e-05, 0.004714260809123516, -0.02239188738167286, 0.006287946831434965, 0.019849518314003944, -0.012732242234051228, 0.005275077652186155, 0.0005807853303849697, -0.006298143416643143, 0.0035620369017124176, -0.02420009858906269, 0.025953924283385277, -0.03700711578130722, -0.05498044565320015, -0.016328267753124237, -0.015417365357279778, -0.006886151619255543, 0.03447834029793739, -0.014207360334694386, -0.00982959009706974, -0.0007473309524357319, 0.018761873245239258, 0.006841965951025486, 0.0004006441740784794, -0.006597245577722788, 0.011610608547925949, -0.009951950050890446, -0.005961653310805559, -0.017375126481056213, -0.03377137333154678, -0.027395054697990417, 0.012759433127939701, -0.0003772767959162593, 0.026334600523114204, 0.027000783011317253, 0.0011692182160913944, -0.018530748784542084, 0.02433605305850506, -0.022854138165712357, -0.0016178716905415058, 0.008150538429617882, 0.014533653855323792, -0.02213357202708721, 0.008517618291079998, -0.011433866806328297, 0.01166499126702547, 0.018598726019263268, -0.033852946013212204, -0.026878423988819122, -0.019591202959418297, -0.03706149756908417, 0.0186667051166296, -0.010618132539093494, 0.03341788798570633, 0.019237717613577843, -0.012541905045509338, 0.009904365986585617, 0.03192237764596939, -0.011766958050429821, -0.04146645963191986, -0.007450367324054241, -0.021657727658748627, 0.008585596457123756, 0.008347674272954464, 0.030590010806918144, 0.018816255033016205, 0.046605583280324936, 0.03684397041797638, -0.018041308969259262, -0.03738779202103615, 0.00887790136039257, 0.02523336000740528, -0.027816517278552055, -0.01028504129499197, -0.016328267753124237, 0.00978880375623703, -0.021005140617489815, -0.021331435069441795, 0.008755541406571865, -0.012487522326409817, 0.02016221545636654, -0.05688382685184479, -0.03700711578130722, 0.01771501451730728, -0.0070153092965483665, 0.05498044565320015, 0.0026834236923605204, 0.008898294530808926, 0.0014955116203054786, -0.0077834585681557655, -0.017293553799390793, -0.00885750725865364, -0.03453272208571434, -0.01313331164419651, 0.0451100692152977, 0.0007609265157952905, 0.05737326666712761, -0.0204069372266531, -0.11191865801811218, -0.011250326409935951, 0.008504022844135761, -0.01631467230618, 0.008082561194896698, -0.0255732499063015, -0.013350840657949448, -0.01327606476843357, 0.044212762266397476, 0.025287741795182228, 0.0044797370210289955, -0.029067307710647583, 0.01615152508020401, 0.01271864678710699, 0.021671323105692863, -0.011807744391262531, -0.01925131306052208, 0.009741218760609627, 0.002620544284582138, 0.022541439160704613, -0.0314057432115078, -0.03891049325466156, -0.0006436647963710129, -0.032574962824583054, 0.011012404225766659, -7.073939923429862e-05, -0.015566917136311531, -0.060364287346601486, 0.014982307329773903, 0.0033835950307548046, -0.022826945409178734, -0.003844144754111767, 0.009462510235607624, -0.014017023146152496, -0.024431223049759865, 0.015186240896582603, 0.022663800045847893, -0.016491414979100227, -0.0026239431463181973, -0.02061086893081665, 0.021739302203059196, -0.006111204624176025, 0.021657727658748627, -0.005203700624406338, 0.023071665316820145, 0.012902187183499336, -0.0043471804820001125, 0.021630536764860153, 0.02865944243967533, 0.008735147304832935, -0.002851668745279312, 0.005774714518338442, 0.012609882280230522, 0.008585596457123756, 0.005105133168399334, 0.01536298356950283, -0.02172570489346981, -0.003565435763448477, -0.008150538429617882, 0.0035382446367293596, 0.02316683530807495, 0.009448914788663387, 0.03749655559659004, -0.027367863804101944, 0.029964614659547806, 0.022378291934728622, -0.014751182869076729, -0.016178717836737633, 0.01738872192800045, 0.025953924283385277, -0.009020654484629631, 0.023968974128365517, 0.010298636741936207, 0.01694006845355034, 0.01821805164217949, 0.043641749769449234, -0.018802659586071968, 0.029475174844264984, -0.003254437353461981, 0.003115082858130336, -0.016613775864243507, -0.008211718872189522, -0.0014989105984568596, 0.03594666346907616, -0.04249972105026245, -0.014275338500738144, -0.013785898685455322, -0.03638172149658203, -0.017565464600920677, 0.02399616502225399, -0.022609416395425797, -0.0343695767223835, 0.0061315977945923805, 0.005880080163478851, -0.0039223190397024155, -0.017334340140223503, 0.04856334254145622, -0.02048850990831852, -0.09489700943231583, -0.0296111311763525, 0.0377412773668766, 0.019931090995669365, -0.005499404389411211, -0.003373398445546627, 0.04543636366724968, 0.03591947257518768, -0.011651395820081234, -0.0199446864426136, 0.001991749508306384, -0.025722799822688103, 0.010883246548473835, 0.024308862164616585, 0.027816517278552055, -0.06558498740196228, -0.0007473309524357319, -0.017198383808135986, 0.0020325363148003817, 0.00906823854893446, -0.036898352205753326, -0.004153443966060877, -0.006321935448795557, 0.051146499812603, -0.021984022110700607, -0.020434128120541573, 0.02085559070110321, 0.015811637043952942, -0.01428893394768238, 0.012983759865164757, -0.034804634749889374, -0.0255732499063015, -0.02097794972360134, 0.028142809867858887, -0.054246287792921066, 0.004778839647769928, 0.009258576668798923, -0.011372686363756657, -0.03684397041797638, 0.01020346861332655, -0.024132119491696358, -0.02561403624713421, 0.046986255794763565, -0.014968711882829666, 0.05481730028986931, -0.024879876524209976, 0.02093716338276863, -0.01941446028649807, -0.0019186735153198242, 0.02012142911553383, 0.016912877559661865, -0.03301002085208893, -0.011658193543553352, -0.0027225110679864883, -0.0004588501760736108, -0.022106381133198738, 0.023900995030999184, 0.011379484087228775, 0.005343055352568626, -0.00250838091596961, -0.01177375577390194, 0.01627388596534729, 0.017823779955506325, -0.028849778696894646, -0.03268372640013695, -0.012562298215925694, -0.006903145927935839, 0.04366894066333771, -0.00851082056760788, -0.051064927130937576, -0.030046189203858376, 0.033145975321531296, 0.015145454555749893, 0.034804634749889374, 0.02453998662531376, -0.01664096675813198, 0.046034567058086395, 0.03534845635294914, -0.022663800045847893, 0.02865944243967533, 0.025015830993652344, -0.035375647246837616, 0.031378552317619324, 0.04027004912495613, 0.007831042632460594, 0.04570827633142471, -0.010482177138328552, -0.006267553195357323, -0.016572987660765648, 0.022854138165712357, 0.03230305016040802, -0.01594759337604046, 0.017524678260087967, -0.025953924283385277, 0.014220956712961197, -0.014302529394626617, -0.0029961217660456896, 0.023697061464190483, 0.012603084556758404, -0.02176649309694767, 0.015036690048873425, 0.018680300563573837, -0.0373334102332592, 0.014465676620602608, 0.006012636702507734, 0.009149812161922455, 0.013289660215377808, 0.008170931600034237, 0.02498864009976387, 0.016124334186315536, -0.020828397944569588, 0.009326554834842682, -0.023900995030999184, 0.006281149107962847, 0.005094936117529869, 0.025342125445604324, 0.022745372727513313, 0.013038142584264278, 0.031215406954288483, 0.023642679676413536, 0.012140835635364056, 0.022242337465286255, -0.03725183755159378, -0.004313191398978233, -0.0017895156051963568, 0.0025066814851015806, 0.011671788990497589, 0.01034622173756361, -0.0322214774787426, -0.005597971845418215, 0.03730621933937073, 0.004833221901208162, 0.012807018123567104, 0.0011420270893722773, -0.045545127242803574, 0.016301076859235764, 0.007497951854020357, -0.002277256455272436, -0.038149144500494, 0.028360338881611824, 0.006733201444149017, -0.011841733008623123, -0.009075036272406578, 0.0028380732983350754, 0.015254219062626362, -0.011964092962443829, -0.007946604862809181, -0.03923678770661354, -0.006155389826744795, -0.011644597165286541, 0.0028533681761473417, -0.00280408444814384, 0.010883246548473835, 0.02758539281785488, -0.004197629168629646, 0.0034838623832911253, 0.023017283529043198, -0.03581070527434349, -0.01775580272078514, 0.017483890056610107, -0.005924265366047621, 0.03602823615074158, -0.025015830993652344, -0.01586601883172989, 0.02655212953686714, -0.03333631530404091, -0.022419080138206482, 0.014152978546917439, 0.0128885917365551, 0.023615488782525063, -0.025627631694078445, -0.03757812827825546, 0.017456699162721634, 0.012861399911344051, 0.01044818852096796, 0.021698513999581337, -0.0242408849298954, 0.0002761598152574152, 0.01222920697182417, 0.04796513915061951, 0.00877593457698822, 0.01941446028649807, -0.006886151619255543, -0.03039967268705368, 0.044049616903066635, -0.023438746109604836, 0.0037863636389374733, -0.0008981567225418985, -0.02144019864499569, 0.017008045688271523, 0.022745372727513313, 0.01684490032494068, 0.0034464746713638306, 0.046034567058086395, -0.023533916100859642, -0.03597385436296463, 0.01854434423148632, 0.04886244609951973, -0.03156889230012894, -0.02044772356748581, -0.04114016517996788, 0.04239095747470856, -0.005512999836355448, -0.0069473315961658955, -0.029855851083993912, 0.007695087231695652, -0.0014717194717377424, -0.037768468260765076, -0.014628822915256023, 0.0216849185526371, -0.0022483658976852894, 0.020964354276657104, -0.04092263802886009, 0.020474914461374283, 0.009985939599573612, -0.022854138165712357, 0.03088911436498165, -0.01718478836119175, -0.017742207273840904, -0.019142549484968185, 0.0003069622616749257, -0.005455218721181154, 0.004071870353072882, 0.006689015775918961, 0.0034192835446447134, -0.0017351334681734443, 0.03494058921933174, -0.015091071836650372, 0.009115823544561863, 0.0072736251167953014, -0.005071144085377455, 0.004568108357489109, -0.0009304462000727654, -0.004041280597448349, -0.010067512281239033, -0.0072736251167953014, 0.003298622788861394, -0.007586322724819183, 0.0050507509149611, -0.0022364696487784386, 0.053430553525686264, 0.038312289863824844, 0.012711849063634872, -0.0068215723149478436, 0.011019201949238777, -0.007844638079404831, 0.03684397041797638, 0.02792528085410595, -0.025124596431851387, 0.0019407662330195308, -0.010869651101529598, 0.008578798733651638, 0.017619846388697624, 0.008728349581360817, 0.004088864661753178, -0.017402317374944687, 0.016804112121462822, 0.059004731476306915, 0.02874101512134075, 0.033472269773483276, -0.018150072544813156, 0.03143293410539627, 0.0025474680587649345, -0.009210992604494095, -0.009680039249360561, -0.010427795350551605, -0.0031439734157174826, 0.007008511573076248, 0.02395537681877613, 0.010509368032217026, -0.025994712486863136, 0.01891142502427101, -0.0019866512157022953, 0.028305957093834877, -0.006539464462548494, -0.011440664529800415, 0.031623274087905884, 0.005234290845692158, 0.02358829788863659, -0.0029213461093604565, 0.00585628766566515, 0.0007146166753955185, -0.007593120448291302, 0.008959474042057991, 0.013799494132399559, -0.00474145170301199, -0.001979853492230177, -0.010917235165834427, 0.01627388596534729, -0.0002542794682085514, 0.02411852404475212, 0.04535479098558426, -0.004520523827522993, -0.004486535210162401, -0.007531940471380949, -0.0075523341074585915, 0.0021633936557918787, -0.015716467052698135, 0.016749730333685875, -0.0038271502126008272, 0.03793161362409592, 0.011379484087228775, -0.0014861647505313158, 0.003946111537516117, 0.024757515639066696, 0.005322662182152271, 0.007477558217942715, -0.03233024477958679, -0.0028822587337344885, 0.007525142747908831, -0.012739039957523346, -0.016423437744379044, 0.009238183498382568, 0.004343781620264053, 0.004846817348152399, -0.021209074184298515, -0.01801411807537079, -0.01639624685049057, -0.00425541028380394, 0.0012609882978722453, 0.019604798406362534, -0.015594108030200005, 0.010359817184507847, 0.0016382650937885046, -0.02239188738167286, 0.0031167822889983654, 0.00658704899251461, 0.0008272049017250538, -0.013826685026288033, 0.00567954545840621, 0.00442875362932682, 0.018897829577326775, 0.016423437744379044, -0.0015583911444991827, -0.04111297428607941, 0.005693140905350447, -0.03048124723136425, -0.0212770514190197, -0.004931789357215166, -0.006393312476575375, 0.04638805240392685, 0.007674694061279297, 0.0019390668021515012, -0.006359323393553495, 0.005818899720907211, 0.0067535946145653725, -0.01969996653497219, 0.034967780113220215, 0.009618858806788921, -0.017402317374944687, 0.07183894515037537, -0.038149144500494, -0.021413007751107216, 0.008871103636920452, 0.0010485575767233968, 0.020665252581238747, 0.002967230975627899, 0.006655026692897081, -0.017130406573414803, -0.00958487018942833, -0.003986898344010115, 0.017728611826896667, -0.00124654290266335, -0.0031014871783554554, 0.030916305258870125, -0.002430206397548318, 0.0034277806989848614, 0.03638172149658203, 0.0063117388635873795, 0.004445748403668404, 0.018489962443709373, 0.018530748784542084, 0.0026987188030034304, -0.03540283814072609, 0.02057008258998394, 0.02324840798974037, -0.015539725311100483, 0.007831042632460594, -0.0003012266242876649, 0.04995008930563927, 0.002496484899893403, -0.02445841394364834, -0.03820352628827095, -0.0014946619048714638, -0.019523225724697113, 0.01272544451057911, -0.021712109446525574, 0.03980780020356178, -0.015050285495817661, -0.018721086904406548, 0.016505010426044464, -0.015539725311100483, -0.0016025766963139176, 0.005040553864091635, -0.011291112750768661, 0.010434593074023724, 0.016246695071458817, 0.011719373054802418, -0.005587775260210037, -0.012113644741475582, -0.002059727441519499, -0.017361531034111977, 0.019441651180386543, -0.012915782630443573, -0.0035620369017124176, 0.0025950525887310505, -0.011032797396183014, 0.04701344668865204, 0.004537518136203289, 0.015893209725618362, -0.003266333369538188, 0.015240623615682125, -0.03953589126467705, 0.0036062223371118307, 0.002012142911553383, -0.02255503460764885, -0.00993155688047409, 0.03279249370098114, 0.007164860609918833, 0.059167880564928055, -0.03804037719964981, 0.01862591877579689, -0.0016501611098647118, 0.012392353266477585, 0.008143740706145763, 0.014683205634355545, -0.026864828541874886, 0.018925020471215248, 0.017211979255080223, 0.012487522326409817, 0.012378757819533348, 0.014615227468311787, -0.015974784269928932, 0.012426341883838177, -0.02069244347512722, -0.004017488099634647, 0.014819161035120487, -0.0018591928528621793, -0.06324654817581177, 0.035457223653793335, -0.004775440786033869, 0.013398424722254276, 0.04527321830391884, 0.031487319618463516, -0.026701681315898895, 0.003572233486920595, -0.015539725311100483, 0.016804112121462822, 0.0186667051166296, -0.006291345693171024, -0.00035752076655626297, -0.013663538731634617, 0.010278243571519852, 0.04065072536468506, -0.03260215371847153, -0.007171658333390951, -0.02999180741608143, 0.0032272462267428637, 0.02395537681877613, -0.0045952992513775826, 0.01121633779257536, -0.006678819190710783, 0.016205908730626106, 0.02738145925104618, -0.010305434465408325, 0.032194286584854126, 0.02077401615679264, 0.032901257276535034, -0.006094209849834442, -0.0011454259511083364, 0.01635545864701271, 0.009346948005259037, 0.017334340140223503, 0.001238895463757217, -0.0101015018299222, -0.000597354955971241, 0.01519983634352684, -0.006950730457901955, 0.010162681341171265, -0.015458152629435062, -0.024893471971154213, 0.013989832252264023, 0.012045666575431824, -0.02651134319603443, -0.010754087939858437, 0.026375386863946915, -0.005377043969929218, -0.032275859266519547, -0.016926473006606102, 0.012093250639736652, 0.004907997325062752, 0.012426341883838177, -0.025342125445604324, 0.040378816425800323, -0.030372481793165207, -0.011868923902511597, 0.02527414634823799, -0.01313331164419651, 0.006848763674497604, -0.003565435763448477, 0.03230305016040802, 0.015050285495817661, -0.0014266840880736709, 0.013976235873997211, -0.013330447487533092, 0.003731981385499239, 0.011148359626531601, -0.0270551647990942, 0.010454986244440079, 0.008279696106910706, 0.011372686363756657, -0.014220956712961197, -0.01540376991033554, 0.006529267877340317, 0.041276123374700546, -0.037034306675195694, -0.011644597165286541, -0.00732120918110013, 0.007253231480717659, 0.0005523196305148304, -0.015621298924088478, 0.0014190366491675377, 0.020760420709848404, 0.010910437442362309, 0.008028178475797176, -0.020787611603736877, -0.0048842052929103374, 0.0036911945790052414, 0.004782238509505987, -0.0020580280106514692, -0.006695813499391079, -0.004523922689259052, 0.0027938876301050186, 0.005033756140619516, -0.02180727943778038, 0.018884234130382538, 0.030372481793165207, 0.021630536764860153, -0.0005599671276286244, 0.012290386483073235, -0.010087906382977962, -0.02999180741608143, 0.018979402258992195, 0.002608648268505931, 0.011100775562226772, 0.02928483672440052, 0.007633907254785299, -0.000623271451331675, 0.01564848981797695, 0.00732120918110013, 0.0128885917365551, 0.0007443569484166801, -0.021657727658748627, 0.004751648288220167, -0.004887604154646397, 0.01495511643588543, 0.008177729323506355, 0.030209336429834366, 0.00801458302885294, 0.022459866479039192, -0.009516892023384571, -0.022935710847377777, 0.04907997325062752, 0.0009482903406023979, 0.022106381133198738, 0.032275859266519547, -0.0007554033072665334, -0.0006309190066531301, -0.031704846769571304, -0.016328267753124237, -0.01257589366286993, 0.0016433633863925934, 0.02205199934542179, 0.000764750293456018, 0.010053916834294796, 0.03311878442764282, -0.0005710135446861386, 0.008735147304832935, 0.017769398167729378, 0.029257645830512047, 0.0002670253161340952, -0.015594108030200005, 0.015553321689367294, 0.02428167127072811, -0.017606250941753387, -0.0017419311916455626, -0.04646962508559227, 0.009401329793035984, 0.016409842297434807, 0.010883246548473835, -0.022323910146951675, 0.03779565915465355, 0.018245242536067963, 0.004826424177736044, -0.022079190239310265, 0.07515625655651093, 0.03472306206822395, 0.007246433757245541, -0.013962640427052975, 0.030535629019141197, 0.005591174121946096, 0.006219969131052494, -0.017211979255080223, -0.02271818183362484, 0.028469104319810867, -0.03279249370098114, -0.02036614902317524, 0.01028504129499197, -0.015240623615682125, 0.02784370817244053, -0.03238462656736374, -0.0025185775011777878, 0.020583678036928177, 0.008905092254281044, -0.023397959768772125, 0.034260813146829605, -0.01460163202136755, 0.016912877559661865, 0.00952368974685669, -0.061941374093294144, -0.02379223145544529, 0.019523225724697113, 0.009775208309292793, -0.02069244347512722, 0.018068499863147736, 0.0420374721288681, 0.00897986814379692, -7.828068919479847e-05, 0.01115515735000372, -0.03382575511932373, 0.011325102299451828, -0.008592394180595875, -0.014914330095052719, -0.0019271706696599722, 0.023221217095851898, 0.013146907091140747, -0.03154170140624046, -0.027204716578125954, -0.0064578913152217865, 0.033227551728487015, -0.023968974128365517, 0.007688289508223534, 0.013357638381421566, 0.012215611524879932, -0.018639514222741127, 0.010210266336798668, 0.004133050329983234, -0.003437977284193039, -0.007158062420785427, 0.013717920519411564, -0.011243528686463833, -0.05285954102873802, 0.012487522326409817, 0.009673241525888443, 0.04853615164756775, 0.045082878321409225, -0.0008310286211781204, 0.04307073727250099, -0.014615227468311787, 0.011087179183959961, 0.008354471996426582, 0.0186667051166296, -0.010325828567147255, 0.005006565246731043, 0.01900659315288067, 0.014234552159905434, -0.01594759337604046, 0.008463236503303051, -0.02375144511461258, 0.006760392338037491, -0.005829096771776676, -0.0012992257252335548, -0.0030080177821218967, -0.02326200343668461, -0.005655752960592508, -0.0025593643076717854, -0.0199446864426136, 0.03445114940404892, 0.039345551282167435, 0.0036708014085888863, 0.03110664337873459, 0.011746563948690891, 0.016124334186315536, 0.03670801222324371, -0.016464224085211754, 0.03621857240796089, -0.0059854453429579735, -0.012337971478700638, 0.026157857850193977, -0.004598698578774929, -0.008198123425245285, 0.011685384437441826, -0.0022976496256887913, 0.016613775864243507, -0.015539725311100483, 0.018992997705936432, 0.002486288081854582, 0.007450367324054241, 0.00021710411238018423, 0.0182588379830122, 0.029855851083993912, 0.030290909111499786, -0.020189408212900162, -0.008694360964000225, -0.012093250639736652, 0.023941781371831894, 0.0035348457749933004, -0.01135909091681242, 0.0017895156051963568, -0.01797333173453808, -0.03151451051235199, -0.020216599106788635, -0.0044423495419323444, 0.018109286203980446, -0.005767916329205036, 0.03861139342188835, -0.034886207431554794, -0.003106585470959544, -0.014207360334694386, -0.007171658333390951, 0.01726636104285717, 0.038067568093538284, 0.017171192914247513, 0.00700171384960413, -0.014316124841570854, -0.020461319014430046, -0.0036708014085888863, -0.030997877940535545, -0.0008289043325930834, -0.016953663900494576, 0.012915782630443573, -0.01882985047996044, 0.004024285823106766, -0.010924032889306545, 0.005890276748687029, 0.014071404933929443, 0.013418817892670631, 0.015553321689367294, -0.027612583711743355]",Model Alignment as Prospect Theoretic Optimization.pdf
"aff, E., et al. Pythia: A suite for ana-
lyzing large language models across training and scaling.
InInternational Conference on Machine Learning , pp.
2397–2430. PMLR, 2023.
Bradley, R. A. and Terry, M. E. Rank analysis of incom-
plete block designs: I. the method of paired comparisons.
Biometrika , 39(3/4):324–345, 1952.
Busa-Fekete, R., Sz ¨or´enyi, B., Weng, P., Cheng, W., and
H¨ullermeier, E. Preference-based reinforcement learning:
evolutionary direct policy search using a preference-based
racing algorithm. Machine learning , 97:327–351, 2014.
Casper, S., Davies, X., Shi, C., Gilbert, T. K., Scheurer, J.,
Rando, J., Freedman, R., Korbak, T., Lindner, D., Freire,
P., et al. Open problems and fundamental limitations of re-
inforcement learning from human feedback. Transactions
on Machine Learning Research , 2023.
Chan, L., Critch, A., and Dragan, A. Human irrationality:
both bad and good for reward inference. arXiv preprint
arXiv:2111.06956 , 2021.
Chen, M., Tworek, J., Jun, H., Yuan, Q., Pinto, H. P. d. O.,
Kaplan, J., Edwards, H., Burda, Y ., Joseph, N., Brockman,
G., et al. Evaluating large language models trained on
code. arXiv preprint arXiv:2107.03374 , 2021.
Chen, Z., Deng, Y ., Yuan, H., Ji, K., and Gu, Q. Self-play
fine-tuning converts weak language models to strong lan-
guage models. arXiv preprint arXiv:2401.01335 , 2024.
Christiano, P. F., Leike, J., Brown, T., Martic, M., Legg,
S., and Amodei, D. Deep reinforcement learning from
human preferences. Advances in neural information pro-
cessing systems , 30, 2017.
Cobbe, K., Kosaraju, V ., Bavarian, M., Chen, M., Jun, H.,
Kaiser, L., Plappert, M., Tworek, J., Hilton, J., Nakano,
R., Hesse, C., and Schulman, J. Training verifiers to solve
math word problems. arXiv preprint arXiv:2110.14168 ,
2021.
Cui, G., Yuan, L., Ding, N., Yao, G., Zhu, W., Ni, Y ., Xie, G.,
Liu, Z., and Sun, M. Ultrafeedback: Boosting language
models with high-quality feedback, 2023.
Dao, T., Fu, D., Ermon, S., Rudra, A., and R ´e, C. Flashat-
tention: Fast and memory-efficient exact attention with
10
Model Alignment as Prospect Theoretic Optimization
io-awareness. Advances in Neural Information Process-
ing Systems , 35:16344–16359, 2022.
De Vries, H., Bahdanau, D., and Manning, C. Towards
ecologically valid research on language user interfaces.
arXiv preprint arXiv:2007.14435 , 2020.
Ethayarajh, K., Choi, Y ., and Swayamdipta, S. Under-
standing dataset difficulty with V-usable information. In
Chaudhuri, K., Jegelka, S., Song, L., Szepesvari, C., Niu,
G., and Sabato, S. (eds.), Proceedings of the 39th In-
ternational Conference on Machine Learning , volume
162 of Proceedings of Machine Learning Research , pp.
5988–6008. PMLR, 17–23 Jul 2022.
Ganguli, D., Lovitt, L., Kernion, J., Askell, A., Bai, Y .,
Kadavath, S., Mann, B., Perez, E., Schiefer, N., Ndousse,
K., et al. Red teaming language models to reduce harms:
Methods, scaling behaviors, and lessons learned. arXiv
preprint arXiv:2209.07858 , 2022.
Gurevich, G., Kliger, D., and Levy","[-0.008876150473952293, 0.02978704869747162, 0.0532708466053009, -0.003814025316387415, 0.007418871857225895, 0.009189918637275696, -0.006240498274564743, 0.03511413559317589, -0.027011945843696594, 0.04889203980565071, 0.03140470013022423, -0.057175517082214355, -0.019481511786580086, 0.020555295050144196, 0.019648853689432144, -0.025338515639305115, 0.05129062011837959, -0.03751271590590477, 0.004288163501769304, 0.037540607154369354, -0.012111447751522064, -0.014084700495004654, -0.017557067796587944, 0.018142767250537872, 0.04063645377755165, -0.010605361312627792, 0.019300222396850586, 0.04044121876358986, -0.015841800719499588, -0.03321757912635803, 0.037066467106342316, -0.03129313513636589, -0.04175207391381264, -0.016232268884778023, -0.035811398178339005, 0.007983654737472534, 0.025226954370737076, -0.004507801495492458, -0.016957420855760574, -0.009322398342192173, -0.010312510654330254, -0.05611567571759224, -0.0005791635485365987, 0.07407715916633606, -0.042086757719516754, 0.022186890244483948, 0.04074801504611969, -0.010110304690897465, -0.005257358308881521, 0.034723665565252304, -0.06386923789978027, 0.035560380667448044, -0.03232508525252342, -0.042393554002046585, -0.006254443898797035, -0.0038454020395874977, 0.02649597078561783, 0.026244957000017166, -0.00191398523747921, -0.009698919951915741, -0.017738355323672295, -0.04841789975762367, 0.006407841574400663, 0.032882895320653915, -0.049449849873781204, -0.04900360107421875, -0.06398079544305801, -0.008339257910847664, 0.01034737378358841, 0.03271555155515671, 0.01525610126554966, 0.006083614192903042, 0.029842831194400787, -0.018895810469985008, -0.011888324283063412, 0.010612333193421364, 0.018351946026086807, 0.08718568831682205, -0.036229755729436874, -0.02058318629860878, -0.01980225183069706, -0.0021545407362282276, 0.008450820110738277, -0.039214037358760834, -0.04666079953312874, -0.029424473643302917, -0.03614608198404312, -0.0006292792968451977, -0.011553637683391571, -0.027611590921878815, -0.023665085434913635, -0.007077213376760483, -0.04303503409028053, 0.0002586407645139843, 0.05670137703418732, 0.01879819482564926, 0.010730868205428123, -0.005504886619746685, 0.03865622729063034, 0.02567320130765438, -0.023706922307610512, -0.012013831175863743, 0.020862091332674026, -0.019411785528063774, 0.022172944620251656, -0.03438898175954819, 0.00607315544039011, -0.006861061789095402, -0.01076573133468628, -0.0038209978956729174, -0.12026381492614746, -0.002083071507513523, -0.05039812624454498, -0.008799451403319836, 0.0036920043639838696, -0.03954872488975525, -0.061303310096263885, -0.016176488250494003, -0.009761673398315907, -0.006739040836691856, -0.027541864663362503, 0.01001966092735529, 0.05533474311232567, -0.018212493509054184, 0.01522821094840765, -0.024543635547161102, 0.03614608198404312, -0.06771812587976456, -0.020541349425911903, -0.026133393868803978, -0.010284620337188244, 0.004336972255259752, 0.030344858765602112, -0.02165696956217289, -0.0514579638838768, 0.0009883694583550096, -0.0032230953220278025, 0.009273589588701725, -0.036229755729436874, -0.03801474720239639, 0.0131364231929183, -0.011978968046605587, -0.05092804506421089, 0.01938389427959919, -0.06810858845710754, -0.006125450134277344, -0.017333943396806717, 0.0028605188708752394, -0.015005086548626423, 0.022591302171349525, 0.01842167228460312, -0.008757615461945534, -0.019732525572180748, 0.025756873190402985, -0.04387174919247627, -0.033719610422849655, -0.022591302171349525, 0.06063393875956535, 0.026663314551115036, -0.07932057231664658, 0.03221352398395538, 0.0465492382645607, 0.00587792182341218, -0.014600674621760845, 0.04914305359125137, 0.021754587069153786, -0.02260524593293667, 0.012327599339187145, -0.045573070645332336, -0.03447265177965164, 0.018826084211468697, 0.020680801942944527, -0.026844602078199387, -0.02751397341489792, -0.010424072854220867, -0.03416585922241211, -0.008402012288570404, -0.023177001625299454, -0.02327461913228035, -0.04852946102619171, -0.000547786767128855, 0.00010638698586262763, -0.03979973867535591, 0.028197290375828743, -0.040050752460956573, -0.013073669746518135, -0.024975938722491264, 0.014795907773077488, -0.01711081899702549, 0.04217043146491051, 0.010054524056613445, 0.022953877225518227, 0.08869177848100662, 0.0241810604929924, 0.0029964852146804333, -0.03547671064734459, 0.0763641744852066, -0.014530948363244534, -0.03134891763329506, -0.01818460412323475, -0.004389266949146986, 0.04214254021644592, -0.0285459216684103, -0.058904726058244705, 0.03316180035471916, -0.03525358811020851, -0.018045151606202126, -0.0011478682281449437, -0.05332662910223007, -0.021378064528107643, 0.03848888352513313, 0.02698405459523201, 0.0472743920981884, 0.009350288659334183, -0.02614733949303627, 0.01645539328455925, -0.03480733931064606, 0.0036920043639838696, 0.006488026585429907, 0.036285534501075745, -0.011449048295617104, 0.021977711468935013, 0.026914328336715698, 0.015339773148298264, -0.030289078131318092, 0.0297312680631876, 0.05583677440881729, -0.00789998285472393, 0.04498736932873726, -0.02729085087776184, 0.06470595300197601, -0.0004070269351359457, -0.01414745394140482, -0.02650991640985012, 0.0012332828482612967, -0.021977711468935013, 0.015618677251040936, -0.00222078082151711, 0.012181174010038376, -0.0360066294670105, 0.004710007458925247, 0.000636251934338361, 0.006121963728219271, -0.0006026962073519826, 0.014572784304618835, 0.05193210393190384, -0.040413327515125275, -0.04534994438290596, 0.02458547241985798, 0.013708178885281086, 0.01652511954307556, -0.0189097560942173, -0.00930845271795988, -0.014642510563135147, -0.013770932331681252, -0.03567194566130638, -0.003454935271292925, 0.005731496959924698, -0.01783597283065319, -0.020011430606245995, -0.04548939689993858, 0.034137967973947525, -0.019537292420864105, 0.038795679807662964, -0.0035804423969238997, -0.01220209151506424, -0.03723381087183952, 0.020722638815641403, 0.004769274964928627, -0.038321539759635925, 0.018756357952952385, 0.007593187503516674, -0.010849403217434883, 0.030902668833732605, -0.03901880234479904, -0.04013442248106003, 0.043537065386772156, 0.04889203980565071, -0.0476369671523571, -0.005651311483234167, 0.0074816253036260605, 0.04172418266534805, 0.06944733113050461, 0.008471738547086716, 0.007160884793847799, 0.031153684481978416, -0.003463651053607464, -0.04024598374962807, -0.038572557270526886, -0.002907584188506007, 0.0020638967398554087, -0.00834623072296381, 0.020611075684428215, -0.05762176588177681, 0.03003806434571743, -0.0032161227427423, 0.05301983281970024, 0.002494456246495247, -0.01184648834168911, -0.02639835514128208, 0.035393040627241135, -0.004424130078405142, -0.012794764712452888, -2.3641552616027184e-05, 0.019132880493998528, 0.04852946102619171, -0.015242155641317368, 0.0065612392500042915, 0.028615647926926613, -0.01694347709417343, 0.023428017273545265, -0.00810218881815672, -0.02501777559518814, 0.007188775110989809, -0.049087271094322205, -0.06102440506219864, 0.04389964044094086, -0.012306680902838707, 0.0217266958206892, -0.027667371556162834, -0.057175517082214355, -0.010835457593202591, -0.017487341538071632, 0.0007160013192333281, 0.00873669795691967, 0.0487246960401535, 0.020178774371743202, 0.0019227010197937489, 0.013938275165855885, -0.02340012602508068, 0.011490884236991405, 0.016553008928894997, 0.01312945131212473, -0.0032265817280858755, 0.003224838525056839, -0.021573297679424286, -0.055920444428920746, 0.05547419562935829, 0.01842167228460312, 0.009908098727464676, -0.08383882790803909, -0.002473538275808096, -0.028615647926926613, -0.011930159293115139, -0.025338515639305115, 0.002187660662457347, -0.00873669795691967, 0.004298622719943523, 0.042923472821712494, 0.0374569371342659, -0.004298622719943523, -0.034500543028116226, 0.01861690543591976, 0.015646567568182945, -0.018212493509054184, 0.005748928524553776, -0.02751397341489792, -0.016720352694392204, 0.004162656608968973, -0.0038209978956729174, 0.001478196238167584, 0.01812882162630558, 0.02789049595594406, -0.0018390296027064323, 0.019830143079161644, 0.016260158270597458, -0.04007864370942116, -0.0004954920732416213, -0.006840144284069538, -0.03224141150712967, -0.011121335439383984, 0.006250957492738962, -0.05547419562935829, -0.00607315544039011, -0.04205886647105217, 0.0026966622099280357, -0.004019717685878277, 0.02261919155716896, 0.0006166414241306484, 0.02674698457121849, 0.006376464385539293, 0.010256730020046234, 0.014586728997528553, -0.037903182208538055, 0.0012908070348203182, 0.023372234776616096, -0.017264217138290405, -0.0025380351580679417, -0.028392525389790535, -0.016971366479992867, -0.0027559297159314156, 0.005999942775815725, -0.05494427680969238, 0.022898096591234207, 0.022061381489038467, 0.02029033564031124, -0.018226439133286476, 0.03159993141889572, 0.04961719363927841, 0.02458547241985798, -0.027778934687376022, -0.016887694597244263, -0.023316454142332077, 0.025031719356775284, -0.007223638240247965, 0.038684118539094925, 0.021224666386842728, 0.06844327598810196, 0.010919129475951195, 0.015604732558131218, 0.04802743345499039, -0.03516991436481476, 0.004974967334419489, -0.008813397027552128, -0.006289307028055191, -0.07547168433666229, 0.011449048295617104, 0.01573023945093155, 0.03201828896999359, 0.05653403326869011, -0.00043753214413300157, -0.0176407378166914, -0.014977196231484413, -0.02925712987780571, -0.01752917654812336, 0.03687123581767082, 0.0036466822493821383, -0.05558575689792633, 0.020611075684428215, -0.05371709540486336, -0.03631342574954033, 0.0332733616232872, 0.054470136761665344, -0.03592295944690704, -0.029061896726489067, -0.03486311808228493, 0.053633421659469604, 0.01585574634373188, 0.018296165391802788, -0.04917094483971596, 0.0010450220433995128, -0.008311367593705654, -0.04356495290994644, 0.03620186448097229, -0.0006576055893674493, 0.0031708006281405687, -0.031070012599229813, 0.01632988452911377, 0.012467051856219769, -0.029285021126270294, 0.01956518366932869, 0.009810482151806355, 0.03056798316538334, 0.006756472401320934, 0.0042567867785692215, -0.03812630847096443, 0.07536011934280396, -0.004532205406576395, 0.05678505077958107, 0.008778533898293972, 0.02956392616033554, 0.026677260175347328, -0.029647596180438995, 0.0007129507721401751, 0.012320626527071, 0.03929770737886429, 0.007886037230491638, 0.012181174010038376, 0.011198034510016441, -0.019885923713445663, 0.002396839438006282, -0.016050979495048523, -0.009106246754527092, -0.06063393875956535, -0.017138710245490074, 0.0013701205607503653, 0.002194633474573493, -0.045740414410829544, -0.03397062420845032, -0.009719837456941605, -0.004786706529557705, -0.019941704347729683, 0.02094576321542263, 0.026161285117268562, 0.0325482077896595, 0.01614859700202942, -0.002020317828282714, -0.01938389427959919, -0.00849265605211258, 0.01687375083565712, 0.020736584439873695, -0.015158484689891338, 0.0638134554028511, -0.016497228294610977, -0.0059650796465575695, -0.009364234283566475, 0.013994056731462479, -0.02381848357617855, 0.0028082244098186493, -0.024920158088207245, -0.031125793233513832, -0.007844202220439911, -0.022005600854754448, 0.018100932240486145, -0.027625536546111107, -0.00948276836425066, 0.033412814140319824, -0.0015470508951693773, 0.011323541402816772, 0.057063955813646317, -0.013450191356241703, -0.00349328457377851, 0.006679773796349764, 0.030316969379782677, 0.012829627841711044, 0.02356746979057789, -0.025380350649356842, 0.0029058409854769707, -0.019342059269547462, 0.05235046148300171, -0.0001046983088599518, -0.031097901985049248, -0.01026370283216238, -0.020415842533111572, 0.028378579765558243, -0.029396582394838333, -0.01585574634373188, -0.06922420859336853, -0.010967937298119068, -0.006456649862229824, 0.020625021308660507, 0.00538286566734314, 0.01662273518741131, -0.028615647926926613, -0.05935097485780716, -0.00032117648515850306, -0.004615877289324999, -0.025812653824687004, -0.05313139408826828, 0.0032666742336004972, 0.02111310511827469, 0.026844602078199387, -0.0014354889281094074, 0.008109161630272865, 0.004587986506521702, -0.018449563533067703, 0.006522889714688063, -0.022828370332717896, -0.007781448308378458, 0.027137452736496925, 0.060522377490997314, -0.04066434130072594, -0.019425731152296066, -0.01694347709417343, -0.019885923713445663, -0.009224781766533852, 0.0035943875554949045, -0.012857518158853054, 0.0020551809575408697, 0.005888381041586399, 0.013471109792590141, -0.03148837015032768, 0.012383379973471165, 0.006467108614742756, -0.04774852842092514, -0.00810218881815672, 0.016901640221476555, -0.048083215951919556, 0.030679546296596527, 0.017919642850756645, -0.016427502036094666, -0.019662799313664436, 0.01528399158269167, -0.00819980539381504, 0.02070869319140911, -0.011504829861223698, -0.0017710464308038354, 0.009782591834664345, -0.002606018213555217, 0.010598388500511646, -0.03349648416042328, -0.01627410389482975, -0.004075498785823584, 0.002511887811124325, -0.03469577804207802, 0.00898073986172676, 0.014321769587695599, -0.006711150519549847, -0.027011945843696594, 0.01441938616335392, 0.06392501294612885, -0.037847403436899185, -0.01980225183069706, -0.02830885350704193, -0.01620437763631344, 0.00341135635972023, 0.022354232147336006, -0.024808596819639206, -0.0264541357755661, 0.02542218752205372, 0.013471109792590141, -0.012348516844213009, 0.007244556210935116, -0.02220083400607109, 0.005550208501517773, 0.011944104917347431, -0.014224153012037277, -0.004835514817386866, 0.002947676694020629, -0.001222823979333043, 0.0002338007907383144, -0.011316568590700626, -0.00593718932941556, -0.02351168729364872, -0.028810882940888405, -0.023665085434913635, -0.0011853460455313325, -0.010054524056613445, 0.0356440544128418, -0.03238086402416229, -0.005361947696655989, -0.02441812865436077, 0.025896325707435608, 0.00037826484185643494, 0.012634394690394402, 0.0030853860080242157, -0.001723109744489193, -0.011616391129791737, -0.03157204017043114, -0.023553524166345596, -0.04289558157324791, -0.0003322891134303063, 0.024975938722491264, -0.0034584214445203543, 0.0098174549639225, -0.00620912155136466, 0.020025376230478287, -0.020304281264543533, 0.003317225957289338, -0.01634383015334606, 0.025171171873807907, 0.0012411270290613174, -0.0023515173234045506, -0.015186375007033348, 0.022786535322666168, -0.03536514937877655, 0.01312945131212473, 6.057467180653475e-05, -0.021698806434869766, -0.005762873683124781, -0.03140470013022423, -0.049087271094322205, 0.00690987054258585, -0.005480482243001461, 0.030289078131318092, -0.008339257910847664, -0.00801851786673069, -0.017515230923891068, 0.016260158270597458, -0.02554769441485405, -0.05223890021443367, 0.019523346796631813, -0.0011862176470458508, 0.02213110774755478, -0.004922672640532255, 0.019244441762566566, 0.025101445615291595, 0.04027387499809265, 0.015019032172858715, -0.010807567276060581, -0.013241012580692768, 0.002947676694020629, 0.022340286523103714, -0.010967937298119068, -0.01352689042687416, -0.04367651790380478, 0.036648113280534744, -0.022884150967001915, 0.005152768921107054, 0.02524089813232422, -0.05039812624454498, 0.015493170358240604, -0.06833171844482422, -0.03274344280362129, 0.01627410389482975, -0.008039435371756554, 0.022577356547117233, 0.0017806338146328926, 0.018198547884821892, -0.0054212152026593685, 0.008771561086177826, -0.019551238045096397, -0.0015243899542838335, -0.01656695455312729, -0.013024861924350262, 0.032576099038124084, -0.015158484689891338, 0.03793107345700264, -0.027388466522097588, -0.13208939135074615, -0.017194490879774094, 0.02914556860923767, -0.016078870743513107, 0.008938903920352459, -0.031627822667360306, -0.01962096430361271, -0.019885923713445663, 0.0160928163677454, 0.027486084029078484, -0.022047437727451324, -0.029647596180438995, -0.001381451147608459, -0.010960964486002922, 0.03240875527262688, -0.027486084029078484, 0.009113219566643238, 0.019342059269547462, 0.018867921084165573, 0.028587758541107178, -0.03416585922241211, -0.07223638147115707, 0.011051609180867672, -0.0025345487520098686, -0.0036780592054128647, -0.006219580769538879, -0.017124764621257782, -0.01651117391884327, 0.01439149584621191, 0.013924330472946167, -0.01370120607316494, 0.0030470367055386305, 0.03305023908615112, 0.012341544032096863, -0.04217043146491051, -0.008032462559640408, 0.0038976967334747314, -0.03344070538878441, 0.006017374340444803, -0.019537292420864105, 0.012794764712452888, -0.014558838680386543, -0.0023550037294626236, -0.0004863405192736536, 0.03394273295998573, -0.010772704146802425, -0.006585643161088228, 0.025101445615291595, 0.021684860810637474, 0.005686174612492323, -0.006589129567146301, -0.02500382997095585, 0.013171286322176456, 0.0024613363202661276, -0.0014616362750530243, 0.0031185061670839787, -0.02565925568342209, -0.002511887811124325, -0.004863405134528875, -0.03558827191591263, 0.004671657923609018, 0.017975425347685814, 0.01384763140231371, -0.030344858765602112, 0.023051494732499123, 0.035560380667448044, -0.016190432012081146, -0.0011740155750885606, -0.008576327003538609, -0.004933131393045187, 0.023469852283596992, -0.016594845801591873, -0.02411133423447609, 0.005114419851452112, 0.013708178885281086, 0.043174486607313156, -0.03547671064734459, 0.023623250424861908, 0.025519803166389465, 0.025059610605239868, 0.007586214691400528, -0.02825307287275791, -0.0021928902715444565, 0.037066467106342316, -0.017877807840704918, -0.02087603695690632, -0.04219831898808479, -0.03324547037482262, -0.02489226683974266, 0.012139338068664074, -0.0472743920981884, -0.04515471309423447, 0.0025223467964679003, 0.0036920043639838696, 0.007042350247502327, 0.007460707798600197, 0.008088244125247002, -0.016078870743513107, -0.07664307951927185, -0.016971366479992867, 0.026105504482984543, 0.008576327003538609, 0.013624507002532482, -0.02867143042385578, 0.028755100443959236, 0.029870720580220222, -0.00255023711360991, -0.0385446660220623, 0.040831685066223145, -0.017626794055104256, 0.011469966731965542, -0.004528719466179609, 0.015493170358240604, -0.05084437504410744, 0.011958050541579723, -0.024306567385792732, 0.05569732189178467, 0.0036013603676110506, -0.02213110774755478, 0.002733268542215228, -0.007349145598709583, 0.030233297497034073, -0.015465280041098595, 0.010472881607711315, 0.00018935032130684704, 0.020903926342725754, -0.01740366965532303, 0.018742412328720093, -0.03667600080370903, -0.05014711245894432, 0.0105914156883955, 0.042505115270614624, -0.04348128288984299, 0.02847619540989399, -0.008924958296120167, -0.020192718133330345, -0.026649368926882744, -0.022396069020032883, -0.009545521810650826, -0.03405429422855377, 0.02998228371143341, -0.013380465097725391, 0.053354520350694656, -0.014077727682888508, 0.02273075468838215, -0.01831011101603508, 0.013094588182866573, -0.0020011430606245995, 0.013464136980473995, 0.02153146266937256, -0.012585585936903954, 0.006571698002517223, 0.007070240564644337, 0.011260787956416607, 0.017333943396806717, -0.008750642649829388, 0.031739383935928345, 0.01614859700202942, -0.007439789827913046, 0.006439218297600746, 0.005574612878262997, -0.014203234575688839, -0.012055667117238045, -0.014321769587695599, -0.015297937206923962, 0.027806824073195457, -0.02220083400607109, -0.04604720696806908, -0.04680025205016136, 0.04373229667544365, -0.004155683796852827, 0.037540607154369354, -0.01076573133468628, -0.011958050541579723, 0.05480482429265976, 0.0374569371342659, -0.02082025445997715, 0.006094073411077261, 0.024683088064193726, -0.015172429382801056, -0.0067285820841789246, 0.02465519867837429, -0.009050466120243073, 0.038990914821624756, 0.010744813829660416, 0.0048459735698997974, -0.018449563533067703, 0.04024598374962807, 0.04476424679160118, -0.013743042014539242, 0.017780190333724022, -0.0046333083882927895, 0.026942219585180283, 0.006111504975706339, 0.005316625814884901, 0.029340801760554314, 0.03762427717447281, 0.003165571251884103, 0.026007886976003647, 0.06041081249713898, -0.041975196450948715, -0.004776247311383486, 0.010626278817653656, 0.0006580413901247084, 0.008311367593705654, -0.010486826300621033, 0.0125925587490201, -0.002557209925726056, 0.006083614192903042, 0.04336972162127495, -0.020806310698390007, -0.000760016031563282, -0.012962107546627522, 0.025868434458971024, 0.01783597283065319, 0.04175207391381264, 0.0069342744536697865, 0.013415328226983547, 0.0042846775613725185, 0.02280048094689846, -0.01831011101603508, 0.015813911333680153, -0.028559867292642593, -0.009189918637275696, 0.005302680656313896, 0.013659370131790638, -0.03949294239282608, 0.005511859431862831, 0.043341830372810364, -0.0003285848943050951, 0.005853517912328243, -0.012941190041601658, -0.018770303577184677, 0.022089272737503052, 0.009566440246999264, 0.0019209579331800342, -0.0367317833006382, 0.03062376379966736, 0.017905699089169502, -0.016315940767526627, 0.007010973524302244, -0.014600674621760845, 0.002445647958666086, -0.00740492669865489, -0.004703034646809101, -0.04721860960125923, 0.005288735497742891, 0.012738984078168869, 0.026161285117268562, -0.020318226888775826, 0.001080756657756865, 0.03302234783768654, 0.014977196231484413, -0.0038244843017309904, 0.005257358308881521, -0.05081648379564285, -0.005445619113743305, 0.024934103712439537, 0.005027262028306723, 0.0332733616232872, -0.0031882321927696466, -0.018031205981969833, 0.03159993141889572, -0.038684118539094925, -0.035504601895809174, -0.012195119634270668, -0.02908978797495365, 0.03235297650098801, -0.022772589698433876, -0.022423958405852318, 0.0336359366774559, 0.015144539065659046, 0.017431559041142464, 0.03547671064734459, -0.0013038807082921267, 0.0002904533757828176, 0.012996970675885677, 0.02603577822446823, 0.020360061898827553, -0.012732011266052723, -0.012362462468445301, -0.024390239268541336, 0.036703892052173615, 0.0013404869241639972, 0.001744027598761022, -0.0007852917769923806, -0.017361832782626152, 0.03076321631669998, 0.023316454142332077, 0.011442075483500957, 0.002686203457415104, 0.04822266846895218, 0.0032161227427423, -0.05935097485780716, 0.024320513010025024, 0.036592330783605576, -0.023651139810681343, -0.041194263845682144, -0.03547671064734459, 0.03324547037482262, 0.017068983986973763, 0.004204492084681988, -0.05575310066342354, 0.029368693009018898, -0.0019959136843681335, -0.02441812865436077, 0.00565479788929224, 0.024697033688426018, -0.024320513010025024, 0.01927233301103115, -0.030679546296596527, 0.023051494732499123, -0.009141109883785248, -0.01214631088078022, 0.019495457410812378, -0.00585003150627017, -0.047051265835762024, -0.00601388793438673, -0.022939933463931084, -0.0038663200102746487, -0.017445504665374756, 0.018561124801635742, -0.004947076551616192, 0.016190432012081146, -0.00034100489574484527, 0.0033520888537168503, 0.008185860700905323, 0.002539778361096978, 0.006379950791597366, -0.00023183974553830922, -0.01847745291888714, -0.026607533916831017, 0.012467051856219769, -0.013861576095223427, 0.004901754669845104, -0.0223681777715683, -0.004214951302856207, 0.019607018679380417, 0.04451323300600052, 0.03770795091986656, 0.002339315367862582, -0.009043493308126926, 0.00574195571243763, -0.0036920043639838696, 0.016232268884778023, 0.042700350284576416, -0.021266503259539604, -0.018589016050100327, 0.00274547073058784, -0.019760416820645332, 0.02614733949303627, 0.0025171171873807907, 0.011734926141798496, -0.023734811693429947, 0.012697148136794567, 0.03804263472557068, 0.03285500407218933, 0.04540572687983513, -0.01849139854311943, 0.043174486607313156, -0.013331657275557518, -0.008360176347196102, 0.014056810177862644, -0.01211842056363821, -0.0012411270290613174, 0.01801726035773754, 0.023943990468978882, -0.0043021091260015965, -0.047776419669389725, 0.023539578542113304, 0.009203863330185413, 0.023190947249531746, 0.007017945870757103, -0.012250900268554688, 0.009678002446889877, -0.00918294582515955, 0.009106246754527092, 0.007635023444890976, -0.022089272737503052, -0.017041092738509178, 0.0035264045000076294, -0.008388066664338112, 0.022270560264587402, -0.011379322037100792, -0.020555295050144196, -0.04883625730872154, 0.03224141150712967, -0.018212493509054184, 0.005829113535583019, 0.042867690324783325, -0.023790592327713966, -0.0036362234968692064, -0.015827856957912445, 0.009517631493508816, 0.0013919100165367126, -0.0067529864609241486, 0.034082185477018356, -0.0219079852104187, 0.032269302755594254, 0.025687146931886673, 0.023441961035132408, 0.007537406403571367, 0.004420643672347069, 0.0027262959629297256, 0.027332685887813568, -0.049868207424879074, -0.009447905234992504, 0.004148711450397968, -0.013450191356241703, -0.00156709726434201, 0.03695490583777428, -0.01118408888578415, 0.010033605620265007, -0.023595359176397324, 0.0018163685454055667, -0.03558827191591263, 0.0019784821197390556, -0.005438646767288446, 0.010898211039602757, -0.004594959318637848, 0.013220095075666904, 0.0031673144549131393, -0.018114877864718437, 0.006456649862229824, 0.009433960542082787, -0.018630851060152054, 0.0022190376184880733, 0.016315940767526627, 0.007300337310880423, 0.025380350649356842, 0.00010153883340535685, 0.007160884793847799, -0.014558838680386543, -0.012745956890285015, -0.03505835309624672, -0.018296165391802788, -0.0031010746024549007, -0.022214779630303383, 0.056980282068252563, 0.007052809000015259, 0.003054009284824133, -0.00574195571243763, 0.004866891540586948, 0.006306738592684269, 0.008555409498512745, 0.018937647342681885, 0.002473538275808096, -0.021461736410856247, 0.07173435389995575, 0.005117905791848898, -0.005173686891794205, 0.018714522942900658, -0.015521060675382614, 0.023121220991015434, -0.020304281264543533, 0.016553008928894997, -0.025533748790621758, 0.013485054485499859, 0.005497913807630539, 0.023832429200410843, -0.011665199883282185, 0.0003468880313448608, 0.0069621652364730835, -0.00921083614230156, 0.004134765826165676, 0.020471623167395592, 0.0040894439443945885, 0.004835514817386866, -0.002499685622751713, 0.041250042617321014, 0.012125393375754356, -0.020136937499046326, -0.0024282163940370083, 0.01662273518741131, 0.020025376230478287, 0.004361376166343689, 0.026970108970999718, 0.05664559826254845, -0.009120192378759384, -0.02931291051208973, -0.045684631913900375, 0.01439149584621191, -0.03756849840283394, 0.02914556860923767, -0.02961970679461956, 0.03098634071648121, -0.022828370332717896, -0.017445504665374756, 0.01692953146994114, -0.00662747910246253, -0.007335200440138578, 0.01340138353407383, -0.002421243581920862, 0.0034619078505784273, -0.012641367502510548, 0.005912784952670336, 0.000424240599386394, -0.0025206035934388638, -0.020931817591190338, -0.021322283893823624, 0.007669886574149132, -0.017013203352689743, 0.006034805905073881, -0.017752300947904587, -0.012397325597703457, 0.05123484134674072, 0.020150883123278618, 0.027262959629297256, -0.026719095185399055, 0.014712236821651459, -0.0251851174980402, 0.0007456349558196962, 0.0015209035482257605, -0.04958930239081383, -0.02405555173754692, -0.015507115982472897, -0.0035525518469512463, 0.02669120393693447, -0.030958449468016624, -0.004239355213940144, -0.0020691261161118746, -0.002070869319140911, 0.029006116092205048, 0.021405955776572227, 0.002630422357469797, 0.004650739952921867, 0.011665199883282185, 0.04038543626666069, -0.017543122172355652, 0.003092358820140362, -0.023428017273545265, 0.002583357272669673, 0.018575070425868034, -0.0013736069668084383, 0.037010688334703445, -0.010354346595704556, -0.038154199719429016, 0.011546664871275425, -0.020374007523059845, -0.0020638967398554087, 0.039520833641290665, 0.03698279708623886, -0.008220723830163479, -0.010333429090678692, -0.009803509339690208, 0.023706922307610512, 0.01794753409922123, 0.007112076506018639, 0.0004972352180629969, -0.0103194834664464, -0.0009421758004464209, -0.0003139859763905406, -0.03433319926261902, 0.010849403217434883, -0.028378579765558243, -0.005103960633277893, 0.009280562400817871, 0.023916101083159447, 0.014349659904837608, -0.007188775110989809, 0.0314604789018631, 0.0026495971251279116, -0.00760016031563282, 0.01312945131212473, -0.006212607957422733, 0.003852374618873, -0.012780820019543171, -0.03656443953514099, 0.030679546296596527, -0.002105732448399067, 0.011372349224984646, 0.0015435646055266261, -0.019174715504050255, 0.00762805063277483, 0.030846888199448586, -0.020192718133330345, -0.01800331473350525, -0.0031620850786566734, -0.024264730513095856, -0.019188661128282547, 0.019007373601198196, 0.0002719323383644223, 0.003488055197522044, 0.030289078131318092, 0.014112590812146664, -0.029814939945936203, -0.016469337046146393, -0.005564154125750065, 0.015465280041098595, 0.018393782898783684, -0.0013849374372512102, 0.045824084430933, -0.00518763205036521, -0.04518260434269905, 0.019244441762566566, -0.02416711486876011, 0.010361319407820702, -0.012425215914845467, 0.0103194834664464, 0.014698291197419167, -0.010110304690897465, 0.012996970675885677, 0.018463509157299995, -0.00787209253758192, 0.014963250607252121, -0.021015489473938942, -0.013220095075666904, -0.015353717841207981, 0.005595530848950148, 0.007098131347447634, -0.011937132105231285, 0.02231239713728428, 0.027904441580176353, -0.03834943100810051, -0.025282735005021095, 0.01927233301103115, 0.017794135957956314, 0.03165571391582489, 0.00405109440907836, 0.016357775777578354, 0.005522318184375763, 0.0009386895108036697, 0.010584442876279354, -0.030791107565164566, -0.014530948363244534, -0.012006858363747597, 0.009224781766533852, 0.006247471086680889, -0.012738984078168869, -0.010995827615261078, 0.02436234802007675, -0.004162656608968973, -0.02105732448399067, 0.014768017455935478, 0.007098131347447634, 0.004772760905325413, -0.016441447660326958, -0.01614859700202942, -0.0028518030885607004, -0.021043378859758377, 0.0171805452555418, 0.017333943396806717, 0.01837983727455139, 0.038990914821624756, 0.0032039207872003317, 0.020917871966958046, 0.03876778855919838, 0.0012733754701912403, -0.023204892873764038, -0.015660513192415237, 0.004249814432114363, -0.006223066709935665, -0.009196891449391842, 0.013589643873274326, 0.0024107848294079304, 0.015507115982472897, -0.013024861924350262, -0.00690987054258585, -0.0008811653242446482, -0.012487969361245632, 0.02374875731766224, 0.008771561086177826, 0.01789175346493721, -0.008639081381261349, -0.0007831128314137459, 0.002503172028809786, -0.060578156262636185, -0.01854717917740345, 0.0103194834664464, -0.0018425158923491836, 0.01812882162630558, 0.007335200440138578, -0.009935989044606686, 0.04521049186587334, 0.018142767250537872, -0.00043862161692231894, -0.00891101360321045, 0.02698405459523201, 0.01538160815834999, -0.0028413443360477686, -0.0007595802308060229, 0.009636166505515575, -0.009447905234992504, -0.009440932422876358, -0.01692953146994114, 0.0044764247722923756, -0.001478196238167584, 0.005236440803855658, -0.03193461894989014, 0.04069223254919052, 0.0033642910420894623, 0.02112705074250698, -0.051597416400909424, 0.08712990581989288, 0.0420030876994133, 0.030846888199448586, -0.03422163799405098, 0.01885397545993328, -0.007446762174367905, 0.016190432012081146, -0.012732011266052723, -0.04367651790380478, 0.021154941990971565, -0.060466594994068146, -0.0160928163677454, -0.008653026074171066, -0.010340400971472263, 0.012829627841711044, -0.0003242270031478256, -0.017780190333724022, 0.004242841619998217, -0.005891867447644472, -0.017027147114276886, 0.03848888352513313, -0.014049837365746498, 0.012278790585696697, -0.003573469817638397, -0.01634383015334606, -0.003451448865234852, 0.01674824208021164, -0.019132880493998528, -0.02356746979057789, 0.009678002446889877, 0.02978704869747162, 0.026189176365733147, 0.0021283933892846107, 0.023957936093211174, -0.03684334456920624, 0.012278790585696697, -0.019369948655366898, -0.026998000219464302, -0.0005098731489852071, -3.8540089008165523e-05, 0.013568726368248463, -0.02183825895190239, -0.03642498701810837, 0.012055667117238045, 0.022647082805633545, -0.017431559041142464, 0.01573023945093155, 0.021224666386842728, -0.03104212135076523, -0.013903412036597729, 0.0304564218968153, 0.004465965554118156, -0.01271109376102686, -0.004821569658815861, 0.019760416820645332, -0.013910384848713875, -0.0405527800321579, 0.02040189690887928, 0.034667886793613434, 0.019397839903831482, 0.06124752759933472, 0.017319997772574425, 0.030372750014066696, -0.013924330472946167, 0.028866663575172424, -0.010696005076169968, 0.004856432788074017, -0.015297937206923962, 0.005173686891794205, 0.0060452651232481, 0.02369297668337822, -0.014035891741514206, 0.02512933686375618, -0.0262728463858366, 0.020569240674376488, -0.018296165391802788, -0.0007417128654196858, -0.013366520404815674, -0.007579242344945669, -0.026844602078199387, -0.007279419340193272, -0.04169629141688347, 0.024989884346723557, 0.03157204017043114, 0.012069611810147762, 0.02261919155716896, 0.010807567276060581, 0.03104212135076523, 0.016957420855760574, -0.003904669312760234, 0.005972052458673716, -0.008255586959421635, 0.007969709113240242, 0.03977184742689133, -0.007084185723215342, -0.03681545332074165, 0.008367149159312248, -0.007565297186374664, 0.009942961856722832, -0.011023718863725662, 0.003793107345700264, 0.016845859587192535, 0.027067726477980614, 0.0005926730227656662, 0.01106555387377739, 0.021433845162391663, 0.02105732448399067, 0.017849916592240334, -0.0010214893845841289, 0.00671463692560792, 0.03687123581767082, 0.011191061697900295, -0.02825307287275791, -0.034082185477018356, -0.0004553995095193386, -0.04666079953312874, -0.013122478500008583, 0.02578476257622242, 0.02554769441485405, 0.006756472401320934, 0.02620312012732029, -0.004134765826165676, -0.007390981540083885, -0.01896553672850132, -0.014530948363244534, 0.012745956890285015, 0.03943715989589691, 0.0063660056330263615, 0.017431559041142464, -0.03776372969150543, -0.009329371154308319, -0.021182831376791, -0.02478070557117462, -0.009733783081173897, -0.02440418303012848, 0.02459941804409027, -0.02656569704413414, 0.01229273620992899, -0.03567194566130638, -0.004138252232223749, 0.02685854770243168, -0.019314168021082878, 0.019314168021082878, -0.027834715321660042]",Model Alignment as Prospect Theoretic Optimization.pdf
", O. Decision-making
under uncertainty–a field study of cumulative prospect
theory. Journal of Banking & Finance , 33(7):1221–1229,
2009.
He, X., Liao, L., Zhang, H., Nie, L., Hu, X., and Chua,
T.-S. Neural collaborative filtering. In Proceedings of
the 26th international conference on world wide web , pp.
173–182, 2017.
Hendrycks, D., Burns, C., Basart, S., Zou, A., Mazeika, M.,
Song, D., and Steinhardt, J. Measuring massive multitask
language understanding. Proceedings of the International
Conference on Learning Representations (ICLR) , 2021.
Hoeffler, S. and Ariely, D. Constructing stable preferences:
A look into dimensions of experience and their impact on
preference stability. Journal of consumer psychology , 8
(2):113–139, 1999.
Holm, S. A simple sequentially rejective multiple test pro-
cedure. Scandinavian journal of statistics , pp. 65–70,
1979.
Hong, J., Lee, N., and Thorne, J. Reference-free monolithic
preference optimization with odds ratio. arXiv preprint
arXiv:2403.07691 , 2024.
Jain, A., Wojcik, B., Joachims, T., and Saxena, A. Learning
trajectory preferences for manipulators via iterative im-
provement. Advances in neural information processing
systems , 26, 2013.
Jiang, A. Q., Sablayrolles, A., Mensch, A., Bamford, C.,
Chaplot, D. S., Casas, D. d. l., Bressand, F., Lengyel, G.,
Lample, G., Saulnier, L., et al. Mistral 7b. arXiv preprint
arXiv:2310.06825 , 2023.Kahneman, D. and Tversky, A. Prospect theory: An analysis
of decision under risk. Econometrica , 47(2):263–292,
1979.
K¨opf, A., Kilcher, Y ., von R ¨utte, D., Anagnostidis, S.,
Tam, Z.-R., Stevens, K., Barhoum, A., Duc, N. M., Stan-
ley, O., Nagyfi, R., et al. Openassistant conversations–
democratizing large language model alignment. arXiv
preprint arXiv:2304.07327 , 2023.
Korbak, T., Shi, K., Chen, A., Bhalerao, R. V ., Buckley,
C., Phang, J., Bowman, S. R., and Perez, E. Pretrain-
ing language models with human preferences. In Inter-
national Conference on Machine Learning , pp. 17506–
17533. PMLR, 2023.
Koren, Y ., Bell, R., and V olinsky, C. Matrix factorization
techniques for recommender systems. Computer , 42(8):
30–37, 2009.
Kreutzer, J., Uyheng, J., and Riezler, S. Reliability and
learnability of human bandit feedback for sequence-to-
sequence reinforcement learning. In Proceedings of the
56th Annual Meeting of the Association for Computa-
tional Linguistics (Volume 1: Long Papers) , pp. 1777–
1788, 2018.
Kwon, M., Biyik, E., Talati, A., Bhasin, K., Losey, D. P.,
and Sadigh, D. When humans aren’t optimal: Robots that
collaborate with risk-aware humans. In Proceedings of
the 2020 ACM/IEEE international conference on human-
robot interaction , pp. 43–52, 2020.
Li, X., Zhang, T., Dubois, Y ., Taori, R., Gulrajani, I.,
Guestrin, C., Liang, P., and Hashimoto, T. B. Alpacae-
val: An automatic evaluator of instruction-following
models. https://github.com/tatsu-lab/
alpaca_eval , 2023.
Lu, X., Welleck, S., Hessel, J., Jiang, L., Qin, L., West,
P., Ammanabrolu, P., and Choi, Y . Quark: Controllable
text generation with reinforced unlearning. Advances in
neural information processing systems , 35","[-0.032652534544467926, 0.008492812514305115, 0.02902606874704361, 0.027635684236884117, 0.0467570535838604, -0.004017064347863197, -0.003934644628316164, 0.056876759976148605, -0.026703981682658195, 0.01558090653270483, 0.026417305693030357, -0.06576374918222427, -0.024711575359106064, 0.002277292078360915, 0.006855168845504522, -0.001772919436916709, 0.04632703959941864, -0.04027814790606499, 0.020755430683493614, 0.044520970433950424, -0.02263316512107849, -0.039045438170433044, -0.011180411092936993, -0.0007229641196317971, 0.02081276662647724, -0.022747837007045746, 0.013574166223406792, 0.048706457018852234, -0.017415640875697136, -0.055816054344177246, 0.039274778217077255, -0.03116181306540966, -0.028782391920685768, -0.0026266800705343485, -0.05676208809018135, 0.031219149008393288, 0.02514159120619297, 0.006407235749065876, -0.012663966044783592, 0.02627396583557129, -0.010843565687537193, -0.05570138245820999, 0.01059272326529026, 0.06215161830186844, -0.01523689366877079, 0.034859947860240936, -0.0003973167040385306, -0.01470654085278511, 0.012728468514978886, 0.0522899255156517, -0.062438298016786575, 0.01903536729514599, -0.03503195568919182, -0.049709830433130264, -0.026015957817435265, -0.006618660409003496, 0.0065326569601893425, 0.024410564452409744, 0.03640800714492798, 0.007278017699718475, -0.03038778528571129, -0.054210662841796875, -0.009180838242173195, 0.050856538116931915, -0.05406732112169266, -0.04016347602009773, -0.07201331853866577, -0.005643957760185003, -0.015079221688210964, 0.026417305693030357, -0.010542554780840874, 0.0008327077375724912, 0.027478011325001717, -0.0033003713469952345, -0.026531975716352463, 0.00013012457930017263, 0.00561528978869319, 0.07407739013433456, -0.029312744736671448, -0.023894546553492546, 0.01599658839404583, 0.012104945257306099, -0.009173670783638954, -0.05157323181629181, -0.042542897164821625, -0.01707162894308567, -0.013538331724703312, -0.009166504256427288, -0.04449230432510376, -0.0029581505805253983, -0.05120055004954338, -0.016197262331843376, -0.029212407767772675, 0.02269050106406212, 0.044062286615371704, 0.013667335733771324, 0.007525276858359575, -0.0015238685300573707, 0.029671091586351395, 0.008263470605015755, -0.041023507714271545, -0.019995735958218575, 0.006403652485460043, -0.017487309873104095, 0.024095220491290092, -0.011029905639588833, -0.018562350422143936, 0.0030208611860871315, -0.011696429923176765, 0.006708246655762196, -0.11232013255357742, -0.00523902615532279, -0.07023591548204422, 0.029083402827382088, 0.03695269301533699, -0.050168514251708984, -0.05042652040719986, -0.022747837007045746, -0.008464144542813301, -0.003963312599807978, -0.025772280991077423, -0.014763876795768738, 0.054354000836610794, 0.0012130029499530792, 0.013122649863362312, -0.02796536311507225, 0.03047378733754158, -0.05739277973771095, -0.012470458634197712, -0.05349396914243698, -0.01797466166317463, 0.013760506175458431, 0.03139115497469902, -0.021085109561681747, -0.040020138025283813, -0.004217738285660744, 0.02955642156302929, 0.012061944231390953, -0.016211597248911858, -0.030043771490454674, 0.009517683647572994, -0.02446790039539337, -0.05446866899728775, 0.017558978870511055, -0.08176033943891525, 0.004608336370438337, -0.00516377342864871, 0.014169021509587765, -0.03351256623864174, 0.016483940184116364, 0.01180393435060978, 0.013158484362065792, -0.024797579273581505, 0.00982586108148098, -0.04601169377565384, -0.027621349319815636, -0.038959432393312454, 0.027090996503829956, 0.010564055293798447, -0.0641583576798439, 0.02134311944246292, 0.0467570535838604, 0.003350539831444621, 0.003909560386091471, 0.03162049502134323, 0.036293335258960724, -0.03723936900496483, 0.015724245458841324, -0.05243326351046562, -0.04108084365725517, 0.022074146196246147, -0.005529286805540323, -0.021271448582410812, 0.0023507531732320786, 0.006851585581898689, -0.008041296154260635, -0.013251653872430325, -0.03379924222826958, -0.012448958121240139, -0.033942583948373795, 0.02835237607359886, 0.008234802633523941, -0.017616314813494682, 0.013746172189712524, -0.0312478169798851, -0.02628830075263977, -0.020540421828627586, 0.0073747714050114155, 0.0054397000931203365, 0.04641304165124893, 0.02309184893965721, 0.048649124801158905, 0.048792462795972824, 0.03225118666887283, -0.015982255339622498, -0.04882112890481949, 0.053665973246097565, 0.006493238732218742, -0.011725097894668579, -0.025858284905552864, -0.003599590854719281, 0.02438189648091793, -0.02492658421397209, -0.033111218363046646, 0.015523571521043777, -0.017845656722784042, -0.0033218723256140947, -0.003280662465840578, -0.05524269863963127, -0.018720021471381187, 0.059227511286735535, 0.026718316599726677, 0.05917017534375191, 0.016655946150422096, -0.028452713042497635, -0.006288981530815363, -0.03451593592762947, 0.012728468514978886, -0.04454964026808739, 0.03159182891249657, -0.0015722453827038407, 0.021816136315464973, 0.02413822151720524, 0.00514585617929697, -0.03047378733754158, 0.008585982955992222, 0.04303025081753731, -0.025557273998856544, 0.04225622117519379, -0.04724440351128578, 0.048792462795972824, 9.462588059250265e-05, -0.009510516189038754, -0.006597159430384636, -0.007496609352529049, -0.018161000683903694, 0.01100840512663126, -0.019866731017827988, -0.008736488409340382, -0.035089291632175446, 0.02216014824807644, 0.010069536976516247, 0.008091464638710022, 0.0029527752194553614, 0.03216518461704254, 0.049795832484960556, -0.04007747396826744, -0.029126405715942383, 0.01040638331323862, 0.013373492285609245, 0.00018275671754963696, -0.008528647013008595, 0.01913570426404476, -0.007768952287733555, -0.027836358174681664, -0.05028318241238594, -0.01138825248926878, 0.020511753857135773, -0.0012766094878315926, 0.009395845234394073, -0.03999147191643715, -0.0010392048861831427, 0.0038020566571503878, 0.04007747396826744, -0.001610767561942339, 0.022504162043333054, -0.026388637721538544, 0.02330685779452324, -0.0018956530839204788, -0.018562350422143936, -0.0007570070447400212, 0.012104945257306099, -0.01082206517457962, 0.0499965064227581, -0.07109595090150833, -0.026488974690437317, 0.02680431865155697, 0.03465927392244339, -0.06025955080986023, 0.015079221688210964, -0.002185913734138012, 0.03701002895832062, 0.06421569734811783, -0.010384881868958473, 0.0243675634264946, 0.03414325788617134, 0.008636151440441608, -0.02316351979970932, -0.04672838747501373, 0.011753765866160393, 0.011015571653842926, -0.024439232423901558, 0.03422925993800163, -0.047961097210645676, 0.03239452466368675, 0.006636577658355236, 0.035089291632175446, -0.019594388082623482, -0.0015471611404791474, -0.024410564452409744, 0.04351760074496269, -0.0059736366383731365, 0.005876882933080196, 0.011180411092936993, 0.01512222271412611, 0.039733462035655975, -0.02376554161310196, 0.0019010283285751939, 0.025886952877044678, 0.00046181908692233264, -0.009180838242173195, 0.03299654647707939, -0.019780727103352547, 0.0208844356238842, -0.05882616341114044, -0.0628969818353653, 0.055185362696647644, -0.034028586000204086, 0.034171923995018005, -0.04632703959941864, -0.05598805844783783, -0.03672335296869278, 0.00529636163264513, 0.02941308170557022, -0.01783132180571556, 0.023192185908555984, 0.006357067264616489, 0.010693060234189034, -0.010040869005024433, -0.0345732718706131, -0.012355787679553032, 0.002642805455252528, 0.04214154928922653, 0.0014674289850518107, -0.007410605903714895, -0.03847208246588707, -0.01206911075860262, 0.037898726761341095, 0.010220042429864407, 0.036752019077539444, -0.08720720559358597, -0.042170219123363495, -0.03961879014968872, -0.029298411682248116, -0.014448531903326511, 0.003260953351855278, -0.005461201071739197, 0.0057442947290837765, 0.036149997264146805, 0.03033044934272766, 0.011660595424473286, -0.0217157993465662, 0.009704023599624634, -0.0007247558096423745, -0.01797466166317463, 0.005815964192152023, 0.0017980036791414022, -0.01432669349014759, -0.0008255408029071987, -0.011438420973718166, 0.01988106407225132, 0.03801339864730835, 0.021285783499479294, -0.0037662219256162643, 0.027406342327594757, -0.0035530056338757277, -0.024037884548306465, -0.012226782739162445, -0.02284817397594452, -0.028696389868855476, 0.012456124648451805, 0.017472976818680763, -0.04380427673459053, -0.013473829254508018, -0.03162049502134323, -0.015294229611754417, -0.02413822151720524, 0.028309375047683716, 0.004167569801211357, 0.031735166907310486, 0.00010923969966825098, -0.007754618767648935, -0.0035960073582828045, -0.026030290871858597, 0.009467515163123608, 0.01935071125626564, -0.008127299137413502, 0.018161000683903694, -0.009309842251241207, -0.009395845234394073, 0.009202338755130768, -0.022489827126264572, -0.049939170479774475, -0.0024170472752302885, 0.02240382507443428, 0.012370121665298939, -0.009352844208478928, 0.02309184893965721, 0.036981359124183655, 0.03560531139373779, -0.008277804590761662, 0.011094408109784126, -0.01730096898972988, 0.03334055840969086, -0.02269050106406212, 0.019551385194063187, -0.018089331686496735, 0.058080803602933884, 0.028782391920685768, 0.03268120065331459, 0.07046525925397873, -0.05951419100165367, 0.010277378372848034, -0.01919304020702839, 0.010162707418203354, -0.027392007410526276, 0.01880602538585663, -0.012219616211950779, 0.06203695014119148, 0.04429163038730621, -0.015380232594907284, -0.005396698601543903, -0.00903033185750246, -0.04730173945426941, -0.057020097970962524, 0.031735166907310486, 0.02284817397594452, -0.0549846887588501, 0.03580598533153534, -0.06794250011444092, -0.03844341263175011, 0.0189063623547554, 0.04443496838212013, -0.020984772592782974, -0.013273155316710472, -0.052232589572668076, 0.06324099004268646, 0.034458599984645844, 0.0072063482366502285, -0.026560643687844276, 0.009309842251241207, -0.008206135593354702, -0.0417688712477684, 0.021730132400989532, -0.014763876795768738, -0.0013778423890471458, -0.017415640875697136, 0.023593533784151077, -0.022575831040740013, -0.037526048719882965, 0.0028775224927812815, -0.0005809692665934563, 0.05788012966513634, 0.004206988029181957, 0.013782006688416004, -0.027635684236884117, 0.09781426191329956, -0.016096925362944603, 0.03589198738336563, 0.028094366192817688, 0.02552860602736473, 0.02650330774486065, -0.0215581264346838, 0.004723007325083017, -0.004267907235771418, 0.01082206517457962, 0.0030853634234517813, -0.0037447211798280478, 0.006238813046365976, -0.014075851067900658, 0.021070774644613266, -0.0434315986931324, -0.008535814471542835, -0.034544605761766434, -0.027320338413119316, 0.0033684573136270046, 0.008628983981907368, -0.027177000418305397, -0.038816094398498535, 0.0021500790026038885, 0.02574361301958561, -0.00614922633394599, 0.010234376415610313, 0.04638437181711197, 0.02383721061050892, 0.048649124801158905, 0.017458641901612282, 0.005819547455757856, -0.005167356692254543, 0.025170259177684784, 0.027320338413119316, 0.0004891430144198239, 0.06553441286087036, -0.01684228703379631, -0.006572075188159943, -0.0015364106511697173, 0.008284971117973328, -0.013452327810227871, 0.007417772896587849, -0.024037884548306465, -0.012907641939818859, -0.016498273238539696, -0.019221706315875053, 0.012542128562927246, -0.052834611386060715, -0.011789600364863873, 0.023937547579407692, 0.0029348579701036215, 0.018992366269230843, 0.04830510914325714, -0.014384029433131218, -0.014735208824276924, 0.004966682754456997, 0.034085921943187714, 0.013007978908717632, 0.0309324711561203, -0.03270987048745155, -0.013610000722110271, -0.012749969027936459, 0.048649124801158905, -0.014613371342420578, -0.022360822185873985, -0.011753765866160393, -0.021586794406175613, 0.01054972130805254, -0.013007978908717632, -0.031419821083545685, -0.0720706507563591, -0.011359584517776966, -0.015881918370723724, 0.02247549407184124, 0.01644093729555607, 0.02635996975004673, -0.017716651782393456, -0.04389028251171112, 0.004579668398946524, 0.014455698430538177, -0.03428659588098526, -0.02293417789041996, 0.00476242508739233, 0.0008645109483040869, 0.00554362079128623, -0.0032107848674058914, 0.025800948962569237, -0.007525276858359575, -0.01904970034956932, 0.02703366056084633, -0.03563397750258446, -0.012104945257306099, 0.050168514251708984, 0.04672838747501373, -0.02819470316171646, 0.0038092234171926975, 0.013653002679347992, -0.0028631887398660183, 0.0038128069136291742, 0.0007704450399614871, 0.012520627118647099, 0.019393714144825935, -0.008593149483203888, 0.0077402847819030285, -0.02164413034915924, -0.0109367361292243, 0.028925731778144836, -0.023177852854132652, -0.015752913430333138, 0.0036569260992109776, -0.010535387322306633, 0.020898768678307533, 0.02651764266192913, -0.015064887702465057, -0.02886839583516121, 0.0225471630692482, -0.005282027646899223, 0.018705688416957855, -0.0005357280606403947, -0.007224265951663256, 0.0092955082654953, -0.008127299137413502, -0.005611706525087357, -0.04601169377565384, -0.013681669719517231, -0.02492658421397209, 0.01070739421993494, -0.013359158299863338, 0.002442131517454982, 0.002804061397910118, 0.023263856768608093, -0.028051365166902542, 0.024439232423901558, 0.05234725773334503, -0.058023467659950256, -0.03133381903171539, -0.037583380937576294, -0.021070774644613266, -0.004321658983826637, 0.010456551797688007, -0.03202184662222862, -0.00462983688339591, 0.02033974789083004, 0.008435476571321487, -0.0037483046762645245, -0.019408047199249268, -0.02795102819800377, -0.007475108373910189, 0.0104422178119421, -0.01622593030333519, 0.009352844208478928, 0.001672582351602614, 0.004335992969572544, 0.001064289128407836, -0.02300584688782692, 7.032550638541579e-05, -0.029986437410116196, -0.026331301778554916, -0.022676168009638786, -0.03139115497469902, -0.0127571364864707, 0.02802269719541073, -0.02689032256603241, -0.02033974789083004, -0.023579200729727745, 0.002305959817022085, 0.022289153188467026, -0.018146667629480362, 0.00891566090285778, 0.029054734855890274, -0.008614649996161461, -0.02719133347272873, -0.019006699323654175, -0.010263044387102127, -0.014075851067900658, 0.021070774644613266, 0.0009406596072949469, 0.0028972316067665815, 0.018490679562091827, 0.010392049327492714, -0.009460347704589367, 0.009216672740876675, -0.029671091586351395, 0.014047183096408844, 0.03480261191725731, -0.008456978015601635, -0.017716651782393456, 0.01797466166317463, -0.02545693702995777, -0.01500755175948143, -0.0046728383749723434, -0.02941308170557022, -0.020382750779390335, -0.03643667325377464, -0.03313988447189331, 0.033111218363046646, -0.02552860602736473, 0.019766394048929214, -0.0011153535451740026, -0.01406151708215475, -0.0031426989007741213, 0.008865492418408394, -0.015021885745227337, -0.06134892255067825, -0.007453607395291328, 0.008951496332883835, 0.0036605095956474543, -0.0026356386952102184, 0.03511795774102211, 0.008593149483203888, 0.05587339028716087, 0.03712470084428787, -0.0028542301151901484, 0.010571221821010113, -0.02071242779493332, 0.00925967376679182, -0.02125711552798748, -0.018562350422143936, -0.03936078026890755, 0.03047378733754158, -0.018877694383263588, 0.014369695447385311, 0.01645527221262455, -0.02620229683816433, 0.02757834829390049, -0.04939448460936546, -0.04196954518556595, 0.012090611271560192, -0.03497461974620819, 0.04225622117519379, 0.0003785035223700106, 0.028667721897363663, -0.004199821036309004, 0.007396271917968988, -0.018074998632073402, 0.01608259230852127, -0.019164372235536575, -0.006579242181032896, 0.040564827620983124, -0.009424513205885887, 0.055730048567056656, -0.03420059010386467, -0.09529150277376175, -0.026316968724131584, 0.003275287104770541, -0.0083853080868721, 0.019766394048929214, -0.03055979125201702, -0.02125711552798748, -0.015638241544365883, 0.02469724230468273, 0.055730048567056656, -0.009582186117768288, -0.024568237364292145, -0.005837464705109596, -0.0034293762873858213, 0.019838063046336174, -0.025843949988484383, 0.013043813407421112, 0.016928289085626602, 0.024109553545713425, 0.021457789465785027, -0.041482191532850266, -0.054354000836610794, 0.020554756745696068, -0.002884689485654235, -0.005647541023790836, -0.002581886714324355, -0.030072439461946487, -0.028295040130615234, 0.0008147903718054295, 0.006023805122822523, -0.006267480552196503, 0.005174523685127497, 0.019580053165555, 0.015552238561213017, -0.02033974789083004, 0.006116975098848343, 0.0075682783499360085, -0.04162553325295448, -0.002101702382788062, -0.008206135593354702, 0.015251227654516697, -0.01912136934697628, -0.020626425743103027, 0.01516522467136383, 0.04297291487455368, 0.0004179216339252889, -0.0015767246950417757, 0.026703981682658195, 0.015308563597500324, -0.007403438910841942, 0.0038773093838244677, -0.04449230432510376, 0.014434197917580605, 0.00956785213202238, -0.0016286849277094007, -0.016928289085626602, -0.034859947860240936, 0.0037626384291797876, -0.02932707965373993, -0.013050979934632778, 0.01735830493271351, 0.028983065858483315, 0.036006659269332886, -0.020153408870100975, 0.041711535304784775, 0.007905123755335808, -0.013108315877616405, 0.0037913061678409576, 0.0010185999562963843, 0.007310268934816122, 0.020511753857135773, -6.349452451104298e-05, -0.01444136444479227, 0.029613755643367767, 0.0014432405587285757, 0.05234725773334503, -0.01601092331111431, 0.005697709508240223, 0.024969585239887238, 0.0006647327682003379, 0.0013231944758445024, -0.00971835758537054, 0.004353910218924284, 0.03245186060667038, -0.03738270699977875, -0.032423194497823715, -0.03420059010386467, -0.037440042942762375, -0.012140779756009579, 0.005640374030917883, -0.026990659534931183, -0.0513438880443573, 0.0019565720576792955, 0.032795872539281845, -0.02263316512107849, -0.01130941603332758, 0.026689648628234863, -0.015337230637669563, -0.08657652139663696, -0.03981946408748627, 0.024209890514612198, -0.009245339781045914, 0.022532828152179718, -0.03055979125201702, 0.023278189823031425, 0.044062286615371704, -0.0008725737570784986, -0.03084646910429001, 0.025485605001449585, 0.0038378911558538675, 0.009926198981702328, -0.01112307608127594, 0.006901754066348076, -0.05220391973853111, 0.017229299992322922, -0.031735166907310486, 0.03953278809785843, 0.001643914612941444, -0.017243634909391403, -0.003137323772534728, -0.027707353234291077, 0.03603532537817955, -0.030129775404930115, 0.014118853025138378, 0.016641613095998764, 0.029441749677062035, -0.010112538933753967, 0.020296746864914894, -0.03617866337299347, -0.0355193056166172, 0.016326267272233963, 0.06077557057142258, -0.03379924222826958, 0.025815283879637718, -0.006640160921961069, -0.004346743226051331, -0.0362359993159771, -0.01942238211631775, -0.014011348597705364, -0.029083402827382088, 0.04036414995789528, -0.010263044387102127, 0.04251423105597496, -0.026388637721538544, 0.016799284145236015, -0.0185910165309906, 0.012219616211950779, -0.01180393435060978, 0.03563397750258446, -0.0027968946378678083, 0.005841048434376717, -0.0032448277343064547, -0.000812998681794852, 0.009532017633318901, 0.023880211636424065, 0.017573313787579536, 0.02796536311507225, 0.023865878582000732, -0.006446653977036476, 0.003683802206069231, 0.02383721061050892, -0.011359584517776966, -0.0208844356238842, -0.014075851067900658, -0.02019640989601612, 0.024181222543120384, -0.024424899369478226, -0.03055979125201702, -0.03844341263175011, 0.046040359884500504, 0.00899449735879898, 0.0368666909635067, -0.0005218420992605388, -0.026875989511609077, 0.03033044934272766, 0.048419781029224396, -0.019709058105945587, 0.0004439017502591014, 0.038500748574733734, -0.04492231830954552, 0.012004608288407326, 0.03207917883992195, -0.021199779585003853, 0.016784951090812683, 0.013875177130103111, -0.012448958121240139, -0.005002517253160477, 0.013860843144357204, 0.06146359443664551, 0.0023453780449926853, 0.02780769020318985, -0.033254556357860565, 0.01798899471759796, -0.006521906703710556, -0.026904655620455742, 0.03898810222744942, 0.029226742684841156, 0.005514952819794416, 0.02476891130208969, 0.049623824656009674, -0.014369695447385311, 0.016741950064897537, 0.006220895331352949, 0.0071275122463703156, 0.016426604241132736, -0.008607483468949795, 0.02802269719541073, -0.0072636837139725685, -0.007675782311707735, 0.011065740138292313, -0.025313597172498703, 0.01040638331323862, 0.012620964087545872, 0.013767673633992672, 0.011947273276746273, 0.03901676833629608, 0.004834094550460577, 0.026947658509016037, 0.021042106673121452, -0.005052685737609863, -0.01927904225885868, -0.011567425914108753, -0.025499938055872917, -0.018863361328840256, 0.018619684502482414, 0.01195443980395794, -0.020626425743103027, 0.0007865705993026495, 0.030215777456760406, 0.015079221688210964, 0.0025603859685361385, 0.003004735568538308, -0.01645527221262455, 0.016813619062304497, 0.015380232594907284, 0.009804360568523407, -0.03784139081835747, 0.01067155972123146, 0.018877694383263588, -0.010807731188833714, -0.00544686708599329, -0.0038952266331762075, 0.010528220795094967, -0.006987757049500942, -0.0189063623547554, 0.002347169676795602, -0.018849026411771774, -0.0002548739721532911, 0.03976212814450264, -0.013918179087340832, -0.0023830044083297253, 0.04168286547064781, -0.006367817521095276, 0.009044665843248367, -0.0010750395013019443, -0.04174020141363144, 0.011760932393372059, 0.015552238561213017, 0.009352844208478928, 0.022590164095163345, 0.010986904613673687, -0.031964510679244995, 0.03391391411423683, -0.03818540647625923, -0.028467047959566116, -0.023665204644203186, 0.0018544432241469622, 0.013473829254508018, -0.028452713042497635, -0.006579242181032896, 0.020554756745696068, 0.024281559512019157, 0.025729279965162277, 0.027363339439034462, 0.028209038078784943, -0.008313639089465141, 0.013151316903531551, 0.01781698875129223, 0.03399991616606712, 0.00569412624463439, -0.019408047199249268, -0.009137836284935474, 0.046499043703079224, 0.007596946321427822, 0.01699995808303356, 0.005529286805540323, -0.012714134529232979, 0.02918373979628086, 0.018533682450652122, -0.0055507877841591835, 0.0118469363078475, 0.0654197409749031, 0.006421569734811783, -0.050168514251708984, 0.0007041508797556162, 0.035089291632175446, -0.0025460519827902317, -0.02955642156302929, -0.010693060234189034, 0.049939170479774475, 0.008378141559660435, -0.0024797578807920218, -0.036293335258960724, 0.030072439461946487, 0.01913570426404476, -0.04151086136698723, 0.010528220795094967, 0.0225471630692482, -0.041338853538036346, 0.010341880843043327, -0.04985316842794418, 0.025413934141397476, 0.003355915192514658, -0.008206135593354702, 0.009711191058158875, 0.011610426940023899, -0.04397628456354141, -0.009166504256427288, -0.022948510944843292, -0.023034514859318733, -0.020784098654985428, 0.022819506004452705, 0.010126872919499874, 0.002232498722150922, 0.019938400015234947, -0.0011368542909622192, -0.006407235749065876, 0.0104422178119421, -0.01100123766809702, 0.025327932089567184, -0.0099476994946599, -0.00971835758537054, 0.0016098717460408807, -0.004124568309634924, 0.0006647327682003379, -0.005604539532214403, 0.0012192740105092525, 0.0015005760360509157, 0.022518495097756386, 0.01017704140394926, 0.017687983810901642, -0.00529277790337801, -0.005206774920225143, -0.010693060234189034, 0.029585087671875954, 0.03345523029565811, -0.026073291897773743, -0.006948338821530342, 0.0010015785228461027, -0.017229299992322922, 0.04500832408666611, 0.009725524112582207, -0.011875603348016739, -0.03216518461704254, 0.008356641046702862, 0.020927436649799347, 0.025700611993670464, 0.038214072585105896, -0.021529458463191986, 0.023120516911149025, -0.008929994888603687, -0.03216518461704254, 0.013810674659907818, -0.021271448582410812, 0.0005599164287559688, 0.024482233449816704, -8.891472680261359e-05, -0.0008842200040817261, -0.06719713658094406, 0.01157459244132042, -0.003060279181227088, 0.02256149612367153, -0.015365898609161377, 0.0019010283285751939, 0.0011252081021666527, -0.012800137512385845, 0.004210571758449078, 0.004002730827778578, -0.0197377260774374, -0.01058555580675602, -0.019852397963404655, 0.006830084603279829, 0.018161000683903694, -0.033627238124608994, -0.004891430027782917, -0.018318673595786095, 0.018691353499889374, -0.018189668655395508, 0.02081276662647724, 0.0312478169798851, -0.014864213764667511, -0.00556153804063797, -0.03213651478290558, 0.0008004565606825054, -0.02765001729130745, -0.0032949962187558413, 0.03202184662222862, -0.01032754685729742, 0.0549846887588501, 0.019866731017827988, 0.025944286957383156, 0.01383217517286539, 0.01661294512450695, 0.012764303013682365, 0.013559832237660885, -0.035691313445568085, 0.005063436459749937, -0.0071239289827644825, -0.0019081952050328255, 0.014849879778921604, 0.013939679600298405, -0.012405956164002419, 0.03202184662222862, -0.02399488352239132, 0.003389958059415221, -0.021916473284363747, -0.0102845449000597, 0.0036766352131962776, -0.015107888728380203, -0.012499126605689526, -0.006134892348200083, 0.009804360568523407, -0.029083402827382088, -0.0026051790919154882, 0.004034981597214937, -0.01728663593530655, 0.005966469645500183, 0.013846509158611298, -0.009395845234394073, 0.014011348597705364, -0.003683802206069231, 0.02026807889342308, -0.0014620537403970957, -0.012011774815618992, -0.03399991616606712, -0.006980590056627989, -0.01926470920443535, -0.026015957817435265, 0.034773945808410645, -0.0092955082654953, 0.01462770439684391, -0.016856620088219643, 0.0033200804609805346, -0.001430698437616229, 0.006374984513968229, 0.006496822461485863, 0.00632123276591301, -0.02757834829390049, 0.07350403815507889, 0.0005930634797550738, -0.0031534493900835514, 0.004371827468276024, -0.004128152038902044, 0.03236585855484009, -0.007306685671210289, 0.015494903549551964, -0.022991511970758438, 0.004181903786957264, 0.007270850706845522, 0.01092956867069006, 0.007424939889460802, -0.003407875308766961, 0.015136556699872017, -0.025585941970348358, -0.012699800543487072, 0.012319953180849552, -0.011603260412812233, 0.0012676508631557226, 0.004862762056291103, 0.04242822900414467, 0.00849997904151678, -0.02162979543209076, 0.017343971878290176, 0.018247004598379135, -0.012534961104393005, -0.01150292344391346, 0.009216672740876675, 0.06025955080986023, 0.00559737253934145, -0.02217448316514492, -0.046957727521657944, 0.0032430358696728945, -0.05048385635018349, 0.015724245458841324, -0.04225622117519379, 0.037898726761341095, -0.0037733889184892178, -0.02681865356862545, 0.036006659269332886, -0.0027019327972084284, 0.0016672072233632207, 0.009159336797893047, 0.004092317074537277, 0.008478478528559208, 0.0016125593101605773, 0.01599658839404583, -0.015451901592314243, -0.0007874664734117687, 0.0022092063445597887, 0.008714986965060234, 0.013538331724703312, -0.005944968666881323, -0.016727615147829056, 0.003966895863413811, -0.031649164855480194, 0.04191220924258232, 0.025628942996263504, 0.013696003705263138, -0.025800948962569237, 0.03184983879327774, -0.040421485900878906, -0.00956785213202238, -0.0010347255738452077, -0.04271490499377251, -0.0067046633921563625, -0.00514227245002985, 0.005192440934479237, 0.03680935502052307, -0.025557273998856544, 0.008736488409340382, -0.00443991320207715, 0.003017277689650655, 0.03179250285029411, 0.017788320779800415, -0.00601663812994957, 0.002599803963676095, 0.026546310633420944, 0.01904970034956932, -0.006848001852631569, 0.0007301310542970896, -0.008571648970246315, 0.016168594360351562, 0.016354935243725777, -0.014040016569197178, 0.023206520825624466, -0.009582186117768288, -0.03916010633111, 0.02941308170557022, -0.03368457406759262, 0.019107036292552948, 0.054440002888441086, 0.025800948962569237, -0.020970437675714493, -0.02277650497853756, -0.023120516911149025, 0.015179558657109737, 0.026574978604912758, 0.0072027649730443954, -0.002709099557250738, -0.006059639621526003, -0.0005097479443065822, 0.006013054400682449, -0.04357493668794632, 0.021156778559088707, -0.03222252056002617, -0.0042858244851231575, 0.013359158299863338, 0.0058589656837284565, 0.00516018969938159, 0.02012474089860916, 0.049337148666381836, 0.011359584517776966, 0.006439486984163523, 0.016928289085626602, 0.013825008645653725, 0.010377715341746807, -0.011216245591640472, -0.04420562461018562, 0.02772168628871441, 0.009266841225326061, 0.01730096898972988, -0.0116892633959651, -0.014563202857971191, 0.0025209677405655384, 0.02575794793665409, -0.023951880633831024, -0.019107036292552948, 0.00899449735879898, -0.029757095500826836, -0.013803508132696152, 0.008105798624455929, 0.0015955378767102957, 0.0029904015827924013, 0.049337148666381836, -0.01613992638885975, -0.027248669415712357, -0.014649205841124058, -0.025944286957383156, 0.021300116553902626, 0.023435862734913826, -0.0025102172512561083, 0.034315261989831924, -0.024854915216565132, -0.04237089306116104, 0.005310695618391037, -0.02651764266192913, 0.03397125005722046, 0.0003260953235439956, 0.005479118321090937, 0.012599463574588299, 0.00510285422205925, -0.002038991777226329, 0.0059736366383731365, 0.008786656893789768, 0.017687983810901642, -0.01512222271412611, 0.006271064281463623, -0.014520200900733471, 0.005651124753057957, -0.009467515163123608, -0.01470654085278511, 0.00018522035679779947, 0.04136752337217331, -0.01903536729514599, -0.01834734156727791, 0.0015982254408299923, 0.006202978082001209, 0.007410605903714895, -0.02941308170557022, 0.023507531732320786, -0.007460774388164282, 0.00012441343278624117, 0.014090185053646564, -0.025270596146583557, -0.019221706315875053, -0.013660169206559658, 0.025241928175091743, 0.024668574333190918, -0.024209890514612198, -0.007933791726827621, 0.016240263357758522, -0.019694725051522255, -0.01728663593530655, 0.009231006726622581, -0.002970692701637745, 0.013839342631399632, -0.019938400015234947, -0.006185060832649469, -0.012334287166595459, -0.008700652979314327, 0.02711966447532177, 0.006708246655762196, 0.02332119084894657, 0.04569634795188904, -0.0017836698098108172, -0.004425579681992531, 0.018648352473974228, 0.017415640875697136, -0.00529636163264513, -0.014964550733566284, 0.00014289066893979907, -0.007761785760521889, -0.001644810545258224, 0.014197689481079578, -0.01150292344391346, 0.00032676724367775023, -0.007353270426392555, 0.012714134529232979, -0.010578389279544353, -0.0012362954439595342, 0.011065740138292313, 0.012076277285814285, 0.017315303906798363, -0.004095900803804398, 0.009231006726622581, 0.023650869727134705, -0.07006391137838364, 0.011868436820805073, 0.013402159325778484, -0.024324562400579453, 0.008370975032448769, -0.018720021471381187, -0.0028398961294442415, 0.045524340122938156, 0.026402970775961876, -0.013724671676754951, -0.000731922744307667, 0.013387826271355152, -0.012398789636790752, -0.004640587605535984, 0.004203404765576124, 0.0111947450786829, 0.005776545964181423, -0.018920695409178734, -0.011051406152546406, -0.01965172216296196, -0.0008922828128561378, -0.009582186117768288, -0.022418158128857613, 0.010786229744553566, 0.0004067232948727906, 0.02863905392587185, -0.024095220491290092, 0.09489015489816666, 0.041338853538036346, 0.010105371475219727, -0.03549063950777054, 0.01774531975388527, -0.018247004598379135, 0.005020434502512217, -0.0027180584147572517, -0.022833840921521187, 0.028223371133208275, -0.04899313673377037, -0.01806066371500492, 0.006102641113102436, -0.01252779457718134, 0.014735208824276924, -0.018017662689089775, -0.033569902181625366, 0.005726377479732037, -0.012291285209357738, -0.020913103595376015, 0.03649400919675827, -0.014849879778921604, 0.022346489131450653, 0.004407661966979504, -0.010341880843043327, 0.0008940745610743761, 0.04053615778684616, 1.3298015346663306e-06, 0.009646688587963581, -0.009976367466151714, 0.04698639363050461, 0.03603532537817955, 0.0023937546648085117, 0.02727733738720417, -0.03084646910429001, 0.029284076765179634, -0.009403012692928314, -0.013911011628806591, 0.006400068756192923, 0.016512608155608177, 0.014161854051053524, -0.030588459223508835, -0.020913103595376015, 0.0335412323474884, 0.0017997954273596406, -0.02461123839020729, 0.020554756745696068, 0.018605351448059082, -0.021572459489107132, -0.0031229897867888212, 0.019221706315875053, 0.013473829254508018, -0.03202184662222862, -0.012004608288407326, 0.013366324827075005, -0.022074146196246147, -0.03374190628528595, 0.01123057957738638, 0.007840622216463089, 0.020755430683493614, 0.051229219883680344, -0.0027933111414313316, 0.026861654594540596, -0.015881918370723724, 0.026689648628234863, -0.002666098065674305, 0.017028626054525375, -0.024811912328004837, 0.00603455537930131, 0.008263470605015755, 0.027678685262799263, -0.015967920422554016, 0.03078913316130638, -0.029957769438624382, 0.026832986623048782, -0.01523689366877079, -0.0065326569601893425, 0.022604499012231827, -0.005393114872276783, -0.02263316512107849, 0.010026535950601101, -0.0017281260807067156, 0.05796613171696663, 0.026345636695623398, 0.018017662689089775, 0.03772672265768051, 0.006873086094856262, 0.014491532929241657, 0.028983065858483315, -0.017272302880883217, 0.018031997606158257, 0.002836312633007765, 0.007353270426392555, 0.03594932332634926, -0.023951880633831024, -0.024324562400579453, -0.003013694193214178, -0.0038701423909515142, 0.006815750617533922, 0.002705516293644905, 0.019580053165555, 0.01682795211672783, 0.01470654085278511, 0.002950983587652445, 0.010829231701791286, 0.03726803883910179, 0.03841474652290344, 0.0113524179905653, 0.000964847975410521, 0.009711191058158875, 0.036293335258960724, 0.02247549407184124, -0.012484792619943619, -0.014269358478486538, 0.015666909515857697, -0.04409095644950867, -0.012355787679553032, 0.017716651782393456, 0.017802655696868896, 0.01913570426404476, 0.03483128175139427, -0.006554157938808203, -0.0038378911558538675, -0.023263856768608093, -0.03557664155960083, -0.0029742761980742216, 0.0355193056166172, 0.013817842118442059, 0.015709910541772842, -0.030760465189814568, -0.013875177130103111, -0.032423194497823715, -0.023450195789337158, -0.01735830493271351, -0.02703366056084633, 0.006518322974443436, -0.019236041232943535, 0.013882343657314777, -0.023364193737506866, 0.003375624306499958, 0.017415640875697136, -0.0034526686649769545, 0.020225077867507935, -0.02750667929649353]",Model Alignment as Prospect Theoretic Optimization.pdf
":27591–27609,
2022.
Munos, R., Valko, M., Calandriello, D., Azar, M. G., Row-
land, M., Guo, Z. D., Tang, Y ., Geist, M., Mesnard, T.,
Michi, A., et al. Nash learning from human feedback.
arXiv preprint arXiv:2312.00886 , 2023.
Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright, C.,
Mishkin, P., Zhang, C., Agarwal, S., Slama, K., Ray, A.,
et al. Training language models to follow instructions
with human feedback. Advances in Neural Information
Processing Systems , 35:27730–27744, 2022.
11
Model Alignment as Prospect Theoretic Optimization
Peng, X. B., Kumar, A., Zhang, G., and Levine, S.
Advantage-weighted regression: Simple and scalable
off-policy reinforcement learning. arXiv preprint
arXiv:1910.00177 , 2019.
Peters, J. and Schaal, S. Reinforcement learning by reward-
weighted regression for operational space control. In
Proceedings of the 24th international conference on Ma-
chine learning , pp. 745–750, 2007.
Rafailov, R., Sharma, A., Mitchell, E., Manning, C. D.,
Ermon, S., and Finn, C. Direct preference optimization:
Your language model is secretly a reward model. In Thirty-
seventh Conference on Neural Information Processing
Systems , 2023.
Rosset, C., Cheng, C.-A., Mitra, A., Santacroce, M., Awadal-
lah, A., and Xie, T. Direct nash optimization: Teaching
language models to self-improve with general preferences.
arXiv preprint arXiv:2404.03715 , 2024.
Schulman, J., Wolski, F., Dhariwal, P., Radford, A., and
Klimov, O. Proximal policy optimization algorithms.
arXiv preprint arXiv:1707.06347 , 2017.
Srivastava, A., Rastogi, A., Rao, A., Shoeb, A. A. M., Abid,
A., Fisch, A., Brown, A. R., Santoro, A., Gupta, A.,
Garriga-Alonso, A., et al. Beyond the imitation game:
Quantifying and extrapolating the capabilities of language
models. arXiv preprint arXiv:2206.04615 , 2022.
Stiennon, N., Ouyang, L., Wu, J., Ziegler, D., Lowe, R.,
V oss, C., Radford, A., Amodei, D., and Christiano,
P. F. Learning to summarize with human feedback. Ad-
vances in Neural Information Processing Systems , 33:
3008–3021, 2020.
Sun, L., Zhan, W., Hu, Y ., and Tomizuka, M. Interpretable
modelling of driving behaviors in interactive driving sce-
narios based on cumulative prospect theory. In 2019 IEEE
Intelligent Transportation Systems Conference (ITSC) , pp.
4329–4335. IEEE, 2019.
Swamy, G., Dann, C., Kidambi, R., Wu, Z. S., and Agarwal,
A. A minimaximalist approach to reinforcement learning
from human feedback. arXiv preprint arXiv:2401.04056 ,
2024.
Tian, K., Mitchell, E., Yao, H., Manning, C. D., and Finn,
C. Fine-tuning language models for factuality. arXiv
preprint arXiv:2311.08401 , 2023.
Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux,
M.-A., Lacroix, T., Rozi `ere, B., Goyal, N., Hambro, E.,
Azhar, F., et al. Llama: Open and efficient foundation lan-
guage models. arXiv preprint arXiv:2302.13971 , 2023.Tunstall, L., Beeching, E., Lambert, N., Rajani, N., Rasul,
K., Belkada, Y ., Huang, S., von Werra, L., Fourrier, C.,
Habib, N., Sarraz","[-0.03240489959716797, 0.009902199730277061, 0.0364997461438179, -0.019286224618554115, -0.0006793148932047188, 0.005658851005136967, 0.011412490159273148, 0.04547302424907684, -0.027298979461193085, 0.03854716941714287, 0.040190163999795914, -0.03821857273578644, -0.04188371077179909, -0.004568787757307291, 0.006767872255295515, -0.02633845992386341, 0.031975194811820984, -0.043071724474430084, 0.030584968626499176, 0.032303791493177414, 0.00036532923695631325, -0.020878663286566734, -0.019349414855241776, 0.029422232881188393, 0.03207630291581154, -0.007785264402627945, 0.0009376125526614487, 0.04031654819846153, -0.027020934969186783, -0.03435121476650238, 0.03728332743048668, -0.023772861808538437, -0.031166335567831993, -0.006401358172297478, -0.03480619937181473, -0.005684128031134605, 0.04797542840242386, -0.0013246639864519238, -0.01591176725924015, -0.008524611592292786, -0.004594064317643642, -0.066023088991642, 0.022673320025205612, 0.05919834226369858, -0.0044676801189780235, 0.03708111494779587, -0.0033618188463151455, -0.006989044137299061, -0.008158097974956036, 0.057378411293029785, -0.055760692805051804, 0.018527919426560402, -0.03644919395446777, -0.03235434740781784, -0.02386133000254631, 0.00925763975828886, 0.030180538073182106, 0.021156709641218185, 0.015064992941915989, -0.006325527559965849, -0.032253239303827286, -0.047621551901102066, -0.008404547348618507, 0.04110012948513031, -0.022142505273222923, -0.041277069598436356, -0.06304042041301727, 0.0010774249676615, -0.004173837136477232, 0.013788512907922268, 0.004966897889971733, -0.00307429488748312, 0.01999397575855255, -0.02694510482251644, -0.02151058427989483, 0.0015221392968669534, 0.022812342271208763, 0.08538514375686646, -0.02853754535317421, -0.03917909041047096, -0.01905873231589794, -0.0077220723032951355, 0.03000360168516636, -0.046357713639736176, -0.044739995151758194, -0.028107838705182076, -0.04817764461040497, -0.005121718160808086, -0.016164535656571388, -0.007797902915626764, -0.028436437249183655, -0.028183668851852417, -0.031115781515836716, 0.003012682544067502, 0.06374817341566086, 0.008069628849625587, -0.004777321591973305, -0.025832923129200935, 0.06435481458902359, 0.013813789002597332, -0.03655030205845833, -0.015949681401252747, 0.028032008558511734, -0.028638651594519615, 0.033314865082502365, -0.02124517783522606, 0.0005955853848718107, -0.02873975969851017, -0.0024076183326542377, 0.014016004279255867, -0.10798262804746628, -0.002922633895650506, -0.02152322418987751, -0.006673084106296301, -0.008271843194961548, -0.05151418596506119, -0.08189693838357925, -0.01965273730456829, -0.007665199693292379, -0.022041399031877518, -0.013245061039924622, -0.008309759199619293, 0.042869508266448975, -0.02144739218056202, 0.017693784087896347, -0.037864696234464645, 0.046762142330408096, -0.05879391357302666, -0.009150213561952114, -0.009744219481945038, -0.01683437079191208, 0.008543569594621658, 0.02144739218056202, -0.041605666279792786, -0.06531533598899841, -0.024480612948536873, 0.011722131632268429, -0.009801091626286507, -0.03121688961982727, -0.030028877779841423, 0.02118198573589325, -0.029093634337186813, -0.08568846434354782, 0.021295731887221336, -0.07815596461296082, -0.019703291356563568, -0.011027018539607525, -0.0008128081681206822, -0.013131314888596535, 0.02238263562321663, 0.027501193806529045, 0.007892691530287266, -0.030256370082497597, 0.033845677971839905, -0.044613610953092575, -0.02384869195520878, -0.058035608381032944, 0.04714129492640495, 0.025099895894527435, -0.0695112943649292, 0.0300794318318367, 0.06086661294102669, -0.001775697572156787, -0.031115781515836716, 0.055103495717048645, -0.0008475637878291309, -0.022041399031877518, 0.02418992854654789, -0.03756137564778328, -0.01233509462326765, 0.022471103817224503, 0.006603572517633438, -0.02959917113184929, -0.020373128354549408, -0.004726768005639315, -0.020764918997883797, -0.029649725183844566, -0.03093884326517582, -0.024910319596529007, -0.03983628749847412, 0.009282916784286499, 0.013927535153925419, -0.046155497431755066, 0.034983135759830475, -0.023570647463202477, -0.015052353963255882, -0.036322809755802155, 0.016164535656571388, 0.002101136837154627, 0.04036710411310196, -0.006372921634465456, 0.030256370082497597, 0.066023088991642, 0.027956176549196243, -0.0024139375891536474, -0.007412431295961142, 0.054496850818395615, -0.011336660012602806, -0.019273584708571434, -0.035918381065130234, 0.0020158274564892054, 0.03895159810781479, -0.01376323588192463, -0.052980244159698486, 0.02312830276787281, -0.02111879363656044, -0.005933736450970173, -0.0021580096799880266, -0.06041163206100464, -0.027248425409197807, 0.03114105761051178, 0.03723277524113655, 0.050958096981048584, 0.00901751033961773, -0.057580627501010895, 0.02099240943789482, -0.03263239189982414, -0.009276597760617733, -0.001627196092158556, 0.0411759614944458, -0.003567193169146776, -0.006170706823468208, 0.04112540930509567, 0.008676272816956043, -0.03220268711447716, 0.022243613377213478, 0.03270822390913963, -0.005068005062639713, 0.03548867255449295, -0.0221930593252182, 0.056973982602357864, -0.03296098858118057, -0.02587083913385868, -0.012404605746269226, 0.0035134798381477594, -0.03270822390913963, 0.0009968550875782967, -0.03020581603050232, 0.025213640183210373, -0.03857244923710823, 0.0016477336175739765, -0.006391879171133041, 0.0167838167399168, 0.0048183961771428585, 0.02712204121053219, 0.052424151450395584, -0.042945340275764465, -0.03288516029715538, 0.04110012948513031, 0.007633603643625975, 0.007121747825294733, -0.023823415860533714, -0.011955942027270794, -0.029649725183844566, -0.017213523387908936, -0.02373494580388069, -0.009232363663613796, 0.0020411042496562004, -0.025820285081863403, -0.023027194663882256, -0.024518528953194618, 0.022496381774544716, -0.0034882030449807644, 0.03346652537584305, 0.0020584820304065943, -0.013927535153925419, -0.03950769081711769, 0.027981454506516457, 0.0214600320905447, -0.009447216056287289, 0.004919503815472126, -0.007342920172959566, -0.021144071593880653, 0.0362217016518116, -0.04767210781574249, -0.016758540645241737, 0.02967500127851963, 0.039532966911792755, -0.04511914774775505, 0.0034186916891485453, -0.0005991399521008134, 0.020347850397229195, 0.06319208443164825, 0.01703658513724804, -0.0014826442347839475, 0.0110965296626091, -0.0029542299453169107, -0.013042845763266087, -0.02606041543185711, -0.00781686045229435, -0.011677896603941917, -0.01684700883924961, 0.016986031085252762, -0.03710639104247093, 0.04744461551308632, 0.016076065599918365, 0.039861567318439484, -0.01272688526660204, 0.024025630205869675, -0.021839184686541557, 0.05138780176639557, -0.011267147958278656, -0.02211722917854786, 0.0012804295402020216, 0.011191317811608315, 0.019020816311240196, -0.013219784013926983, 0.0048563117161393166, 0.023873968049883842, -0.02980138547718525, 0.020335212349891663, 0.024430058896541595, -0.029978323727846146, -0.001074265455827117, -0.04302116855978966, -0.04451250284910202, 0.05287913605570793, -0.013485190458595753, 0.03296098858118057, -0.017630591988563538, -0.038724109530448914, 0.00199686991982162, -0.011311382986605167, 0.022471103817224503, -0.00841718539595604, 0.03207630291581154, 0.017820168286561966, 0.016531048342585564, -0.009497770108282566, -0.0007812121184542775, -0.0038641958963125944, 0.006335006095468998, 0.01957690715789795, 0.006281292997300625, 0.01359893660992384, -0.02004452794790268, -0.06597253680229187, 0.022875534370541573, 0.035918381065130234, 0.009978029876947403, -0.07497108727693558, -0.00879001896828413, -0.04805126041173935, -0.018072934821248055, -0.04390585795044899, 0.0007662040297873318, -0.019399968907237053, 0.0312674418091774, 0.027829794213175774, 0.03877466171979904, 0.0055703818798065186, -0.044537778943777084, 0.023747583851218224, 0.0254032164812088, -0.03516007587313652, 0.03783942013978958, -0.008170736022293568, -0.009965391829609871, -0.00700168265029788, 0.0029494904447346926, 0.004710969980806112, 0.004748885054141283, 0.013447275385260582, 0.0035956294741481543, 0.0013570500304922462, 0.00491002481430769, -0.0025008267257362604, -0.0008317657629959285, -0.007140705361962318, -0.004502435680478811, 0.0034123724326491356, 0.023343155160546303, -0.0665791779756546, 0.012145518325269222, -0.039002154022455215, -0.006938490550965071, 0.0008013545884750783, -0.0015837515238672495, -0.0010260815033689141, 0.006679403129965067, 0.0021311528980731964, 0.010489885695278645, 0.012183433398604393, -0.026616504415869713, -0.01584857515990734, 0.022951364517211914, -0.004176996648311615, -0.020006613805890083, -0.012038092128932476, -0.014521541073918343, -0.005709404591470957, -0.009712623432278633, -0.06410204619169235, 0.029220018535852432, 0.026161521673202515, 0.03369401767849922, -0.003646183293312788, 0.018072934821248055, 0.04858207330107689, 0.047950152307748795, -0.023545369505882263, 0.001992130419239402, -0.028588097542524338, 0.013320891186594963, -0.031848810613155365, 0.029043082147836685, 0.0025845561176538467, 0.06410204619169235, 0.004534031730145216, 0.030382754281163216, 0.04072097688913345, -0.05727730318903923, 0.005074324086308479, -0.01105861458927393, 0.010015944950282574, -0.054041869938373566, 0.004840513691306114, 0.012076007202267647, 0.0431981086730957, 0.047874320298433304, -0.0020853388123214245, 0.0015805920120328665, 0.013055484741926193, -0.04269257187843323, -0.056771766394376755, 0.030635522678494453, 0.004233869723975658, -0.04853152111172676, 0.02886614389717579, -0.03586782515048981, -0.03382040187716484, 0.04031654819846153, 0.037991080433130264, -0.032329071313142776, -0.01964009925723076, -0.06395038962364197, 0.03533701226115227, 0.023646477609872818, 0.02300191856920719, -0.058035608381032944, 0.02252165786921978, -0.017731698229908943, -0.0665791779756546, 0.020208828151226044, 0.019298862665891647, 0.01359893660992384, -0.04468943923711777, 0.04764683172106743, -0.0029589692130684853, -0.030357476323843002, -0.002101136837154627, 0.03109050542116165, 0.03488203138113022, 0.004884747788310051, -0.006913213990628719, -0.04183315858244896, 0.07835818082094193, -0.00895431824028492, 0.05788394808769226, 0.021636968478560448, 0.011064933612942696, 0.00889112614095211, -0.016253003850579262, -0.027096765115857124, 0.015734829008579254, 0.03922964632511139, 0.029194742441177368, 0.00566201051697135, 0.009308193810284138, -0.017858082428574562, 0.0003276114584878087, -0.01803502067923546, -0.030180538073182106, -0.03695473074913025, -0.03488203138113022, -0.011241871863603592, -0.0014234016416594386, -0.032506007701158524, -0.030711352825164795, -0.02638901397585869, -0.005592499393969774, -0.020284658297896385, 0.008196013048291206, 0.02866392955183983, 0.01750420778989792, 0.017681144177913666, 0.01979175955057144, -0.0015726929996162653, -0.014824862591922283, 0.008056990802288055, 0.011930665001273155, -0.017491567879915237, 0.034047894179821014, -0.013333529233932495, -0.007380835246294737, -0.02539057843387127, 0.003529277862980962, 0.0035861507058143616, 0.006075918674468994, -0.028891419991850853, -0.02560543268918991, -0.017339907586574554, -0.03220268711447716, 0.02518836408853531, -0.0014542078133672476, 0.001761479303240776, 0.034528154879808426, -0.0051564741879701614, 0.007418750319629908, 0.06587142497301102, -0.04223758727312088, -0.009851645678281784, -0.010388778522610664, 0.02205403707921505, 0.013914897106587887, 0.031520210206508636, -0.03849661722779274, -0.0017930753529071808, -0.02686927281320095, 0.055760692805051804, -0.018199319019913673, -0.025908753275871277, -0.003725173184648156, -0.021144071593880653, 0.018199319019913673, -0.0017061862163245678, -0.01725143939256668, -0.08265524357557297, -0.012594182044267654, 0.006376081146299839, 0.02679344266653061, 0.0004048242699354887, 0.01864166371524334, -0.0027646536473184824, -0.042818956077098846, 0.0031453859992325306, -0.013927535153925419, -0.027551747858524323, -0.04471471905708313, 0.016922838985919952, 0.020335212349891663, 0.0300794318318367, 0.003475564531981945, 0.02606041543185711, 0.0006820795242674649, -0.03028164617717266, 0.007431388832628727, -0.019488438963890076, 0.00015205594536382705, 0.026363737881183624, 0.04261673986911774, -0.048152368515729904, -0.024910319596529007, -0.004625660367310047, 0.0015584747307002544, -0.016151895746588707, -0.010079137049615383, -0.005848427303135395, 0.0031374869868159294, 0.02506197988986969, 0.003870515152812004, -0.021965568885207176, 0.005045888014137745, 0.014647925272583961, -0.03414900228381157, -0.013207145035266876, -0.0004095636832062155, -0.043476153165102005, 0.022205697372555733, 0.01771906018257141, -0.022496381774544716, -0.009175490587949753, 0.022142505273222923, -0.0271473191678524, 0.01159574743360281, -0.011077572591602802, -0.000830186007078737, -0.00345028773881495, 0.021156709641218185, 0.03336542099714279, -0.03938130661845207, -0.017959190532565117, 0.0038104825653135777, 0.001977912150323391, -0.039002154022455215, 0.015128185041248798, 0.001229085959494114, 0.010609950870275497, -0.040746256709098816, 0.01347255241125822, 0.05495183542370796, -0.05272747576236725, -0.017529483884572983, -0.026616504415869713, -0.03814274072647095, -0.010906953364610672, 0.014963884837925434, -0.024291036650538445, -0.010388778522610664, 0.03179825469851494, 0.0020916578359901905, -0.001992130419239402, 0.009940114803612232, -0.025302110239863396, 0.0055577438324689865, 0.012568905018270016, -0.020676448941230774, -0.007374516222625971, -0.000600324769038707, 0.002116934861987829, 0.009402981959283352, -0.0066604455932974815, 0.012840631417930126, -0.019538991153240204, -0.04746989160776138, -0.020284658297896385, 0.008581484667956829, -0.014433071948587894, 0.05212083086371422, -0.02606041543185711, 0.005443998146802187, -0.020550064742565155, 0.04084736108779907, 0.011020699515938759, -0.01035718247294426, -0.0068437024019658566, -0.008796337991952896, -0.009706303477287292, -0.00035051858867518604, -0.030989397317171097, -0.03073662891983986, -0.022079313173890114, 0.02272387221455574, 0.009649431332945824, 0.003996899351477623, -0.007355558220297098, 0.009636792354285717, -0.03639863803982735, 0.00855620764195919, -0.008372951298952103, 0.0011421969393268228, 0.00965575035661459, 0.0024913479574024677, -0.0026524877175688744, 0.030559690669178963, -0.017592675983905792, 0.016670070588588715, 0.0015110806562006474, -0.03430066257715225, -0.012088645249605179, -0.03634808585047722, -0.04726767912507057, 0.020347850397229195, -0.008493015542626381, 0.02492295764386654, -0.01658160239458084, 0.013358806259930134, -0.017023947089910507, 0.019425246864557266, -0.02679344266653061, -0.06020941585302353, 0.012916461564600468, -0.011248190887272358, 0.014470987021923065, -0.024847127497196198, 0.03212685510516167, 0.021434754133224487, 0.054092422127723694, 0.024442696943879128, -0.0073681967332959175, -0.03687889873981476, -0.006110674235969782, 0.018793325871229172, -0.013889620080590248, -0.012076007202267647, -0.03983628749847412, 0.03207630291581154, -0.018692217767238617, 0.00571256410330534, 0.026237353682518005, -0.03417427837848663, 0.037738312035799026, -0.08007700741291046, -0.03907798230648041, 0.004824715666472912, -0.015279845334589481, 0.0181108508259058, -0.0014834341127425432, 0.01624036580324173, -0.007077513262629509, 0.006477188318967819, -0.013333529233932495, 0.0026335299480706453, -0.013940173201262951, -0.006508784368634224, 0.028714481741189957, 0.005504030268639326, 0.041732050478458405, -0.026439568027853966, -0.14367352426052094, 0.0019873909186571836, 0.010774250142276287, -0.016619518399238586, -0.005665170028805733, -0.02465755119919777, 0.00099843495991081, -0.028486991301178932, 0.02359592355787754, 0.028689205646514893, -0.016720624640583992, -0.026970380917191505, -0.008669953793287277, 0.005232304334640503, 0.01890707202255726, -0.02934640273451805, 0.008695230819284916, 0.03394678607583046, 0.01143144816160202, 0.021700160577893257, -0.03801635652780533, -0.07234229892492294, 0.01937469281256199, 0.01631619594991207, 0.011115487664937973, -0.002462911419570446, -0.03157076612114906, -0.032506007701158524, 0.013851705007255077, 0.005377646069973707, 0.010148648172616959, -0.008297120220959187, -0.016821732744574547, 0.006963767576962709, -0.032253239303827286, 0.002165908692404628, 0.015191377140581608, -0.03718222305178642, -0.006989044137299061, -0.007153343874961138, -0.0002144581376342103, -0.010249756276607513, -0.012259264476597309, -0.018363619223237038, 0.0226480420678854, 0.0321015790104866, 0.0010805845959112048, 0.043880581855773926, 0.031242165714502335, -0.006135951261967421, -0.005304975435137749, -0.020297296345233917, 0.009984348900616169, 0.017959190532565117, 0.002657226985320449, 0.006360283121466637, -0.020903941243886948, 0.00038942121318541467, -0.022812342271208763, -0.023039832711219788, -0.0019178796792402864, -0.006214941386133432, -0.004663575906306505, -0.020815471187233925, 0.025377940386533737, 0.01731463149189949, -0.02881558984518051, 0.014028642326593399, -0.002897357102483511, 0.001553735346533358, 0.03569088876247406, -0.025643346831202507, -0.02694510482251644, -0.005007972475141287, 0.024695465341210365, 0.027046211063861847, -0.0018831241177394986, 0.0023049311712384224, 0.04279367998242378, 0.018022382631897926, -0.0026430089492350817, -0.021611692383885384, 0.003977941814810038, 0.0420859269797802, -0.02959917113184929, -0.016417304053902626, -0.042995892465114594, -0.03890104591846466, -0.023772861808538437, 0.008783699944615364, -0.039457134902477264, -0.03675251454114914, 0.0001484026579419151, -0.0037694077473133802, -0.009333470836281776, -0.010944868437945843, 0.03048386052250862, -0.023431625217199326, -0.06688249856233597, -0.015355676412582397, 0.03584254905581474, -0.00399057986214757, 0.012745843268930912, -0.042995892465114594, 0.01546942163258791, 0.012107603251934052, 0.0034439684823155403, -0.029093634337186813, 0.012448840774595737, 0.00035190090420655906, 0.012556266970932484, -0.016998670995235443, 0.03109050542116165, -0.051969170570373535, 0.011854834854602814, -0.044613610953092575, 0.038193296641111374, 0.02412673644721508, -0.023305241018533707, 0.008865849114954472, -0.009459855034947395, 0.021889736875891685, -0.024695465341210365, -0.006458230782300234, 0.006565657444298267, 0.028562821447849274, 0.0010229218751192093, 0.008208652026951313, -0.05047783628106117, -0.040796808898448944, 0.023103024810552597, 0.04931510239839554, -0.03869882971048355, 0.016290919855237007, -0.021295731887221336, -0.00895431824028492, -0.02164960838854313, 0.013207145035266876, -0.00909334048628807, -0.022091953083872795, 0.02239527367055416, -0.012290860526263714, 0.04797542840242386, -0.019197754561901093, 0.024821849539875984, -0.02012035995721817, 0.00544715765863657, -0.022167783230543137, 0.03869882971048355, -0.006341325584799051, -0.025226280093193054, -0.012929100543260574, 0.008846892043948174, -0.01817404292523861, 0.007203897461295128, 0.0036904176231473684, 0.030104707926511765, 0.021952928975224495, -0.0016730104107409716, 0.011109167709946632, 0.005722043104469776, -0.012379328720271587, -0.02767813205718994, -0.006154908798635006, 0.013459913432598114, 0.03394678607583046, -0.02205403707921505, -0.05389020964503288, -0.03682834655046463, 0.04266729578375816, -0.007229174487292767, 0.02707148902118206, -0.004590904805809259, -0.029851939529180527, 0.0283353291451931, 0.031975194811820984, -0.025441132485866547, 0.00043089102837257087, 0.011083891615271568, -0.0364997461438179, 0.0028073082212358713, 0.025479048490524292, -0.01964009925723076, 0.03179825469851494, 0.010976464487612247, 0.01709977723658085, -0.02405090630054474, 0.020335212349891663, 0.058035608381032944, -0.003063236130401492, 0.015216653235256672, -0.02044895850121975, -0.001624036580324173, -0.008038032799959183, -0.01570955105125904, 0.023482177406549454, 0.029498064890503883, -0.0070206401869654655, 0.04918871819972992, 0.04613022133708, -0.04266729578375816, 0.0008333455771207809, 0.014369879849255085, -0.0036430235486477613, 0.002853122539818287, 0.020297296345233917, 0.00038784139906056225, 0.0035134798381477594, 0.010767931118607521, 0.03703055903315544, -0.022812342271208763, 0.012423563748598099, 0.0003349180333316326, 0.01730199158191681, 0.01644258014857769, 0.04476527124643326, 0.002025306224822998, 0.03109050542116165, 0.030888289213180542, 0.01998133584856987, -0.028765035793185234, 0.0006812896463088691, -0.02384869195520878, -0.01416766457259655, 0.015064992941915989, 0.0010782149620354176, -0.029118912294507027, -0.004729927517473698, 0.054699067026376724, -0.02005716785788536, 0.008511973544955254, -0.00805067177861929, -0.03435121476650238, 0.02967500127851963, 0.02159905433654785, 0.009377704933285713, -0.03907798230648041, 0.02613624557852745, 0.019488438963890076, 0.0007954303291626275, -0.0017172448569908738, -3.0460558264167048e-05, 0.016745902597904205, 0.005819990765303373, 0.004780481103807688, -0.038724109530448914, 0.009567281231284142, 0.0069005754776299, 0.030129985883831978, -0.015317761339247227, -0.0007586999563500285, 0.03141910210251808, -0.0020268859807401896, -0.004954259376972914, 0.023305241018533707, -0.03968462720513344, -0.02010772004723549, 0.013030207715928555, 0.008177055977284908, 0.044411394745111465, -0.015279845334589481, -0.018995540216565132, 0.01577274315059185, -0.028765035793185234, -0.02384869195520878, -0.008467739447951317, -0.024379504844546318, 0.01937469281256199, -0.027248425409197807, -0.022964002564549446, 0.030180538073182106, 0.014483625069260597, 0.009845326654613018, 0.010470927692949772, -5.85514135309495e-05, 0.006227579899132252, 0.014812224544584751, 0.02846171334385872, 0.025175726041197777, -0.0026730250101536512, -0.014192941598594189, -0.0235200934112072, 0.039406582713127136, -0.005298655945807695, -0.0016508931294083595, 2.742437573033385e-05, -0.014445709995925426, 0.04443667083978653, 0.005535626318305731, -0.00491002481430769, 0.021978206932544708, 0.057378411293029785, 0.008031713776290417, -0.030306922271847725, 0.011064933612942696, 0.0308124590665102, -0.01691020093858242, -0.03976045921444893, -0.03991211950778961, 0.03480619937181473, -0.0019810718949884176, 0.0006911634118296206, -0.04104957729578018, 0.030433306470513344, -0.009946433827280998, -0.030332200229167938, 0.008777379989624023, 0.012568905018270016, -0.0038673554081469774, 0.00033847260056063533, -0.04211120307445526, 0.019463161006569862, -0.011412490159273148, -0.033112652599811554, 0.03637336194515228, -0.008960637263953686, -0.04178260639309883, -0.008214971050620079, -0.029902493581175804, -0.006053801625967026, -0.03167187049984932, 0.01557052880525589, -0.006401358172297478, -0.0004222021088935435, 0.014534179121255875, -0.0015956000424921513, -0.011166040785610676, 0.011747408658266068, -0.013775873929262161, 0.006056961137801409, -0.01510290801525116, -0.007342920172959566, 0.009333470836281776, -0.015178738161921501, -0.0034692452754825354, -0.015279845334589481, -0.017428375780582428, 0.01984231360256672, 0.024644913151860237, 0.03495785966515541, -0.0038104825653135777, -0.02600986137986183, 0.018148766830563545, 0.0068310643546283245, 0.011918026953935623, 0.05515405163168907, -0.020006613805890083, -0.006824744865298271, -0.008208652026951313, -0.0033397015649825335, 0.0374097116291523, -0.008246567100286484, 0.009933795779943466, -0.012967015616595745, 0.005194389261305332, 0.03192463889718056, 0.03394678607583046, 0.03862300142645836, -0.020373128354549408, 0.04489165544509888, 0.003895791945978999, -0.02105560153722763, 0.006553018931299448, -0.026490122079849243, -0.015166100114583969, 0.023747583851218224, 0.02345690131187439, 0.02426576055586338, -0.028486991301178932, 0.015798021107912064, 0.004944780375808477, 0.03109050542116165, 0.01212656032294035, -3.3941061701625586e-05, 0.015861213207244873, -0.021801268681883812, 0.014205580577254295, 0.009649431332945824, -0.021940290927886963, -0.009377704933285713, 0.003898951457813382, -0.012878546491265297, 0.013042845763266087, -0.013320891186594963, -0.00522914482280612, -0.02212986722588539, 0.026919826865196228, -0.005658851005136967, 0.01664479449391365, 0.06273709982633591, -0.028840865939855576, 0.0026730250101536512, -0.010578354820609093, -0.0011793222511187196, 0.0011595747200772166, -0.002709360560402274, 0.029624449089169502, -0.023305241018533707, 0.027956176549196243, 0.007165982387959957, 0.01910928636789322, 0.00805067177861929, 0.012676332145929337, 0.0032227961346507072, 0.010919592343270779, -0.043476153165102005, -0.0032449134159833193, 0.0006508784717880189, -0.026035137474536896, 0.0071470243856310844, 0.009681027382612228, 0.0023302079644054174, 0.011052295565605164, -0.02532738633453846, 0.0006406097672879696, -0.03917909041047096, -0.00014583548181690276, 0.004941620863974094, 0.030660798773169518, -0.0012583123752847314, 0.00034577917540445924, 0.0002713309950195253, -0.031444381922483444, -0.016695348545908928, 0.010167606174945831, -0.02694510482251644, 0.008947999216616154, 0.012006496079266071, 0.002816786989569664, 0.00825288612395525, 0.005522988270968199, 0.003056917106732726, -0.003706215647980571, -0.003917909227311611, -0.032910436391830444, -0.009245001710951328, -0.015279845334589481, -0.019463161006569862, 0.028436437249183655, 0.006233898922801018, 0.008872168138623238, -0.003744130954146385, -0.008208652026951313, 0.00925763975828886, -0.004688852466642857, 0.026692336425185204, 0.013042845763266087, -0.025504324585199356, 0.06819689273834229, -0.003139066742733121, -0.004676213953644037, 0.012954376637935638, -0.026035137474536896, 0.027020934969186783, -0.008448781445622444, 0.010098095051944256, -0.014382517896592617, 0.009737899526953697, 0.00915653258562088, 0.03192463889718056, -0.024973511695861816, -0.015216653235256672, 0.013181868940591812, -0.011475682258605957, 0.006932171527296305, 0.028107838705182076, 0.002090078080072999, 0.019728567451238632, 0.008082267828285694, 0.044613610953092575, -0.0008056990336626768, -0.035134799778461456, 0.008771060965955257, 0.029118912294507027, -0.01487541664391756, -0.0019368373323231936, 0.028158392757177353, 0.05687287449836731, -0.010976464487612247, -0.02886614389717579, -0.048354580998420715, 0.02560543268918991, -0.031848810613155365, 0.01957690715789795, -0.031772978603839874, 0.022357359528541565, -0.016695348545908928, -0.01577274315059185, 0.03106522746384144, -0.003649342805147171, -0.004783640615642071, 0.005121718160808086, -0.005617775954306126, 0.010186564177274704, 0.0011011220049113035, 0.013396721333265305, 0.006344485096633434, 0.00899223331362009, 0.008196013048291206, -0.007804222404956818, -0.004524553194642067, -0.014989161863923073, -0.007374516222625971, -0.009099659509956837, -0.02939695678651333, 0.0499722994863987, 0.006338166072964668, 0.012050730176270008, -0.010767931118607521, 0.014723755419254303, -0.0321015790104866, 0.00010713032679632306, -0.0017914955969899893, -0.025352664291858673, -0.014559456147253513, 0.007949563674628735, -0.011355617083609104, 0.06182713434100151, -0.029245296493172646, 0.0032354346476495266, 0.002169068204239011, 0.008859530091285706, 0.02947278693318367, 0.018098212778568268, -0.012316136620938778, 0.007305004633963108, 0.01770642213523388, 0.013131314888596535, -0.016922838985919952, -0.002875239821150899, -0.030888289213180542, 0.025314748287200928, 0.02405090630054474, -0.0007164402632042766, 0.028158392757177353, 0.006290771998465061, -0.03710639104247093, 0.024847127497196198, -0.025769731029868126, -0.003598789218813181, 0.041403453797101974, 0.028486991301178932, -0.021295731887221336, -0.0018467885674908757, -0.010173925198614597, 0.025820285081863403, 0.0071912589482963085, 0.002965288469567895, -0.0013696884270757437, -0.009105979464948177, 0.0005525357555598021, 0.015595805831253529, -0.044613610953092575, 0.011981219053268433, -0.0276023019105196, -0.01256258599460125, 0.01400336530059576, 0.011709492653608322, -0.0006413996452465653, -0.012252944521605968, 0.049492038786411285, 0.009200767613947392, 0.004142241086810827, 0.0066162110306322575, 0.008019075728952885, 0.012512032873928547, 0.0004115384363103658, -0.024303674697875977, 0.009137575514614582, -0.012865908443927765, 0.020158274099230766, -0.0024028790649026632, -0.01658160239458084, -0.01423085667192936, 0.01383906602859497, -0.020676448941230774, -0.012410924769937992, 0.005990609526634216, -0.020006613805890083, -0.010445651598274708, 0.002661966485902667, -0.014205580577254295, -0.006142270285636187, 0.04044293239712715, -0.000776867673266679, -0.012019134126603603, -0.009112298488616943, 0.0002424996200716123, 0.01845208741724491, 0.010767931118607521, -0.004436084069311619, 0.04003850370645523, -0.004186475649476051, -0.02426576055586338, 0.033441249281167984, -0.01859111152589321, 0.027905624359846115, -0.0005264690262265503, 0.011191317811608315, 0.018629025667905807, 0.00199686991982162, 0.011128125712275505, 0.02306511066854, -0.02312830276787281, 0.0006880037835799158, -0.025491686537861824, -0.006654126103967428, -0.010502523742616177, -0.002740956610068679, -0.007374516222625971, 0.0004411597328726202, 0.02526419423520565, 0.042540911585092545, -0.023608561605215073, -0.019020816311240196, 0.013927535153925419, 4.184007048024796e-05, 0.00775366835296154, 0.003358659101650119, 0.008663634769618511, 0.004831034690141678, -0.0022448988165706396, 0.006372921634465456, -0.03495785966515541, -0.023633839562535286, -0.013674766756594181, -0.006767872255295515, -0.0002669865498319268, -0.018490003421902657, 0.0014202420134097338, 0.022268889471888542, -0.009933795779943466, -0.013295614160597324, -0.000813598046079278, 0.015115546062588692, 0.017390461638569832, -0.007241812534630299, -0.005042728036642075, -0.004385530482977629, -0.0255422405898571, 0.021030325442552567, 0.017605314031243324, 0.011722131632268429, 0.038066912442445755, 0.01163366250693798, 0.028790313750505447, 0.03874938562512398, 0.0059179384261369705, -0.00875210389494896, -0.004549829754978418, 0.0022954524029046297, -0.004205433186143637, -0.009333470836281776, 0.02873975969851017, 0.004913184326142073, 0.021738076582551003, 0.009535685181617737, -0.011330340057611465, -0.008303439244627953, -0.024847127497196198, 0.005286017898470163, 0.0033965744078159332, 0.037131667137145996, 0.005074324086308479, -0.005093282088637352, 0.004594064317643642, -0.0640009418129921, -0.0018831241177394986, 0.000664701743517071, -0.006584614980965853, 0.014824862591922283, 0.004306540358811617, -0.0044202860444784164, 0.05247470736503601, 0.014028642326593399, -0.003251232672482729, -0.00496057840064168, 0.016606878489255905, 0.00862571969628334, 0.0004996124189347029, 0.008530931547284126, 0.007058555725961924, 0.0014210320077836514, 0.0033902551513165236, -0.0009178650216199458, 0.0010150228627026081, -0.002090078080072999, -0.001399704604409635, -0.016151895746588707, 0.043551985174417496, -0.0020347849931567907, 0.018553195521235466, -0.05773228779435158, 0.09650694578886032, 0.030155261978507042, 0.02686927281320095, -0.036600854247808456, 0.030332200229167938, 0.0032891479786485434, 0.009617835283279419, -0.016493134200572968, -0.036600854247808456, 0.026717612519860268, -0.06248433142900467, -0.0156337209045887, -0.014673201367259026, -0.02285025641322136, 0.00979477260261774, 0.005886342376470566, -0.026161521673202515, 0.005608297418802977, 0.006429794244468212, -0.027172595262527466, 0.04243980348110199, -0.009087021462619305, 0.01736518368124962, 0.004537191707640886, -0.030332200229167938, -0.01651841029524803, 0.02158641628921032, -0.007058555725961924, -0.031317997723817825, 0.007728391792625189, 0.030433306470513344, 0.028512267395853996, 0.007450346369296312, 0.0226480420678854, -0.02954861707985401, 0.01359893660992384, -0.01416766457259655, -0.03114105761051178, -0.004928982350975275, 0.0018783846171572804, 0.009042787365615368, -0.039861567318439484, -0.019804399460554123, 0.005276538897305727, 0.013775873929262161, -0.02420256845653057, 0.007494580931961536, 0.018730133771896362, -0.01904609426856041, -0.013030207715928555, 0.018464727327227592, -0.01553261373192072, -0.02418992854654789, 0.00046248704893514514, 0.021877098828554153, -0.011627343483269215, -0.023140940815210342, -0.0001116722560254857, 0.03243017569184303, 0.026414290070533752, 0.057176195085048676, -0.0030363795813173056, 0.047090739011764526, -0.020335212349891663, 0.021952928975224495, -0.0026461684610694647, 0.008505654521286488, -0.016139257699251175, 0.0025371620431542397, 0.002546641044318676, 0.009725261479616165, -0.010344544425606728, 0.0053365714848041534, -0.037258051335811615, 0.02319149486720562, -0.003873674664646387, 0.0012377749662846327, -0.008581484667956829, 0.00992115680128336, -0.013207145035266876, 0.008474058471620083, -0.016063427552580833, 0.03730860725045204, 0.03179825469851494, 0.019084008410573006, 0.024556443095207214, 0.011671577580273151, 0.010527800768613815, 0.036929454654455185, -0.017327269539237022, 0.025352664291858673, -0.005655691493302584, 0.014572094194591045, 0.033845677971839905, -0.019020816311240196, -0.0399879515171051, -0.0049921744503080845, -0.00700168265029788, 0.010843761265277863, -0.006357123609632254, -0.00415803911164403, 0.009049106389284134, 0.03922964632511139, 0.0066667646169662476, 0.02111879363656044, 0.03093884326517582, 0.029169466346502304, 0.013434636406600475, -0.0027583343908190727, 0.004227550234645605, 0.04249035567045212, 0.005361848045140505, -0.010843761265277863, -0.03387095779180527, 0.002285973634570837, -0.05672121420502663, -0.006353964097797871, 0.017858082428574562, 0.016354111954569817, 0.025226280093193054, 0.022976640611886978, -0.0026035138871520758, -0.016025511547923088, -0.022230975329875946, -0.03253128379583359, 0.006104355212301016, 0.024366866797208786, 0.020095081999897957, 0.01597495935857296, -0.02420256845653057, -0.0077599878422915936, -0.020234104245901108, -0.03569088876247406, -0.008461419492959976, -0.022483743727207184, 0.019336776807904243, -0.03028164617717266, -0.004350774921476841, -0.035791996866464615, 0.005993769038468599, -0.001124819042161107, -0.012783758342266083, 0.005971651989966631, -0.014660563319921494]",Model Alignment as Prospect Theoretic Optimization.pdf
"in, N., Sanseviero, O., Rush, A. M.,
and Wolf, T. Zephyr: Direct distillation of lm alignment,
2023.
Tversky, A. and Kahneman, D. Availability: A heuristic for
judging frequency and probability. Cognitive psychology ,
5(2):207–232, 1973.
Tversky, A. and Kahneman, D. Advances in prospect theory:
Cumulative representation of uncertainty. Journal of Risk
and uncertainty , 5:297–323, 1992.
von Werra, L., Belkada, Y ., Tunstall, L., Beeching, E.,
Thrush, T., Lambert, N., and Huang, S. Trl: Trans-
former reinforcement learning. https://github.
com/huggingface/trl , 2020.
Welleck, S., Kulikov, I., Roller, S., Dinan, E., Cho, K.,
and Weston, J. Neural text generation with unlikelihood
training. In International Conference on Learning Repre-
sentations , 2019.
Xu, H., Sharaf, A., Chen, Y ., Tan, W., Shen, L., Van Durme,
B., Murray, K., and Kim, Y . J. Contrastive preference
optimization: Pushing the boundaries of llm performance
in machine translation. arXiv preprint arXiv:2401.08417 ,
2024.
Yuan, W., Pang, R. Y ., Cho, K., Sukhbaatar, S., Xu, J.,
and Weston, J. Self-rewarding language models. arXiv
preprint arXiv:2401.10020 , 2024.
Zhao, Y ., Joshi, R., Liu, T., Khalman, M., Saleh, M., and
Liu, P. J. Slic-hf: Sequence likelihood calibration with
human feedback. arXiv preprint arXiv:2305.10425 , 2023.
Zheng, L., Chiang, W.-L., Sheng, Y ., Zhuang, S., Wu, Z.,
Zhuang, Y ., Lin, Z., Li, Z., Li, D., Xing, E., et al. Judging
llm-as-a-judge with mt-bench and chatbot arena. arXiv
preprint arXiv:2306.05685 , 2023.
Ziegler, D. M., Stiennon, N., Wu, J., Brown, T. B., Radford,
A., Amodei, D., Christiano, P., and Irving, G. Fine-tuning
language models from human preferences. arXiv preprint
arXiv:1909.08593 , 2019.
12
Model Alignment as Prospect Theoretic Optimization
A. Related Work
LLM Alignment Human feedback has been used to improve LLM capabilities in translation (Kreutzer et al., 2018), sum-
marization (Stiennon et al., 2020), sentiment-conditioned generation (Ziegler et al., 2019), and instruction-following (Ouyang
et al., 2022). The RLHF framework (Christiano et al., 2017; Bai et al., 2022) traditionally used to accomplish this is detailed
in§2. Still, momentum has largely shifted in favor of closed-form losses that directly operate on offline preferences, such
as DPO (Rafailov et al., 2023). This single stage of optimization distinguishes DPO from the conventional approach in
preference-based RL, which learns a reward and then fits the policy to those rewards (Jain et al., 2013; Busa-Fekete et al.,
2014). Other preference-based losses include CPO (Xu et al., 2024) and IPO (Azar et al., 2024).
Binary Feedback Despite not being a human-aware loss, unlikelihood training was among the first methods to align
language models using a binary signal (Welleck et al., 2019). However, Korbak et al. (2023) found unlikelihood training to
be worse than the CSFT baseline we tested in this work, which is among various approaches that convert a binary/discrete
signal into a control token (Lu et al., 2022). Learning from sparse binary feedback is a staple of information retrieval and
recommender systems (He et al., 2017; Koren et al., 2009). Many retrieval-augmented generation systems use contrastive
learning to ensure that generations are grounded. This can be framed as learning from synthetic binary","[-0.03886743262410164, 0.019377099350094795, 0.0555977001786232, -0.0049185846000909805, 0.012880322523415089, -0.011004890315234661, 0.020806673914194107, 0.04421772062778473, -0.012958169914782047, 0.055682625621557236, 0.01975926384329796, -0.030431531369686127, 0.003644706681370735, 0.015796087682247162, 0.011684291996061802, -0.04183981567621231, 0.03578181937336922, -0.03960345312952995, 0.01138705387711525, 0.039773304015398026, -0.03365868702530861, -0.04141518846154213, -0.012448619119822979, 0.026708975434303284, 0.012802474200725555, -0.031110933050513268, 0.029327502474188805, 0.022943958640098572, -0.006149999797344208, -0.029299193993210793, 0.05599401518702507, -0.03405500575900078, -0.024769850075244904, -0.005962457042187452, -0.030233372002840042, 0.03951852768659592, 0.03179033473134041, 0.01871185190975666, -0.008039585314691067, -0.002825532341375947, -0.03009182959794998, -0.04234936833381653, 0.002662759041413665, 0.02938411943614483, -0.025987111032009125, 0.044698964804410934, 0.04968124255537987, 0.016617031767964363, -0.022491024807095528, 0.042575836181640625, -0.0453217476606369, 0.049766167998313904, -0.034536249935626984, -0.009893786162137985, 0.006280926521867514, 0.0009925633203238249, 0.0043134926818311214, 0.01824476383626461, 0.03190356865525246, -0.007742347661405802, -0.014536364004015923, -0.03725385665893555, 0.003335083369165659, 0.019193096086382866, -0.026921289041638374, -0.043623246252536774, -0.07105408608913422, 0.020665131509304047, 0.007685730699449778, 0.022080551832914352, 0.03060138039290905, -0.015399769879877567, 0.027161911129951477, 0.013715419918298721, -0.01983003504574299, 0.006397698540240526, 0.03804649040102959, 0.08283037692308426, 0.015244074165821075, -0.023411046713590622, 0.0011730293044820428, -0.010382105596363544, 0.022887341678142548, -0.04891691729426384, -0.014918526634573936, -0.018145684152841568, -0.01556962076574564, 0.0017710443353280425, -0.04820920526981354, -0.026595741510391235, -0.021018987521529198, -0.0343380905687809, -0.014748676680028439, -0.0018135069403797388, 0.03136570751667023, -0.0009040995500981808, -0.012031069956719875, -0.016999194398522377, 0.03555535152554512, 0.009079919196665287, -0.030403222888708115, -0.01770690456032753, 0.039093900471925735, -0.02761484496295452, 0.055541083216667175, -0.012731702998280525, -0.0004750503576360643, -0.01303601823747158, 0.003811018541455269, 0.02345350943505764, -0.09341771900653839, -0.0028273016214370728, -0.043226927518844604, 0.007416801061481237, 0.0035527043510228395, -0.06476961821317673, -0.043793097138404846, 0.005566139239817858, 0.003662399249151349, 0.023552589118480682, -0.029780438169836998, -0.014904373325407505, 0.03728216513991356, 0.0038251725491136312, 0.026708975434303284, -0.03261127695441246, 0.04413279518485069, -0.051408056169748306, -0.0007913082372397184, -0.027558228000998497, 0.009823014959692955, 0.042689066380262375, 0.011896605603396893, -0.018485385924577713, -0.08917146176099777, -0.0019868959207087755, 0.017282279208302498, -0.011330436915159225, -0.04820920526981354, -0.01104735303670168, 0.008032508194446564, -0.043764788657426834, -0.04996432736515999, -0.016602877527475357, -0.0782444179058075, 0.008846375159919262, -0.0053750574588775635, 0.0036270138807594776, -0.03926375135779381, 0.007254027761518955, 0.00932054128497839, -0.032809436321258545, -0.050473880022764206, 0.05242715775966644, -0.04795442894101143, -0.04520851746201515, -0.05053049325942993, 0.03196018561720848, 0.024840621277689934, -0.06086306273937225, 0.02912934496998787, 0.061542462557554245, 0.018202301114797592, -0.0022345944307744503, 0.055003222078084946, 0.0028202245011925697, -0.027600690722465515, 0.026765592396259308, -0.04424602910876274, -0.0387825071811676, 0.007522957399487495, 0.00757957436144352, -0.03940529376268387, -0.04195304960012436, -0.007402646820992231, -0.0039490219205617905, -0.004228567238897085, -0.03408331423997879, -0.02032543160021305, -0.03852773457765579, -0.005442290101200342, 0.006886018440127373, -0.013524338603019714, -0.004469188861548901, -0.01634810119867325, 0.0029423043597489595, -0.023722440004348755, 0.012972324155271053, 0.007678653579205275, 0.0324697345495224, -0.016546260565519333, 0.05030402913689613, 0.07501725852489471, 0.017735213041305542, -0.02230701968073845, 0.008867606520652771, 0.06799677759408951, 0.04996432736515999, -0.0015994246350601315, -0.017508745193481445, 0.007940506562590599, 0.03060138039290905, 0.006818785797804594, -0.06510931998491287, -0.012738780118525028, 0.004575345199555159, -0.022675028070807457, 0.02298642136156559, -0.03883912414312363, 0.00015613852883689106, 0.01906570792198181, 0.006886018440127373, 0.05545615777373314, 0.01849954016506672, -0.01971680112183094, -0.002491139341145754, -0.02747330255806446, 0.014309896156191826, 0.009242692962288857, 0.044698964804410934, 0.005329056177288294, -0.01235661655664444, 0.0244159959256649, 0.003512010909616947, -0.07360184192657471, 0.01296524703502655, 0.028563175350427628, -0.02162761799991131, 0.05016248673200607, -0.04486881569027901, 0.09205891937017441, -0.011082738637924194, -0.03674430400133133, -0.02104729600250721, -0.0026751437690109015, -0.02901611104607582, -0.0369141548871994, -0.019603567197918892, 0.01817399263381958, -0.027855467051267624, 0.010091944597661495, 0.0016516182804480195, 0.03365868702530861, -0.029469044879078865, 0.008825143799185753, 0.045123592019081116, -0.045916225761175156, -0.019306330010294914, 0.0295539703220129, -0.006850632838904858, 0.007254027761518955, -0.013849885202944279, -0.03651783615350723, -0.010014096274971962, -0.027487456798553467, -0.013651725836098194, -0.011613521724939346, 0.005881070159375668, 0.0001794708368834108, -0.023425200954079628, -0.012540621683001518, 0.011004890315234661, -0.005757221020758152, 0.04133026301860809, -0.02915765345096588, -0.016786880791187286, -0.02510955184698105, 0.004366570618003607, -0.019858343526721, -0.02312796376645565, 0.00985840056091547, -0.005707681179046631, -0.010035327635705471, 0.028379172086715698, -0.02464246191084385, -0.07156363874673843, 0.04166996479034424, 0.016999194398522377, 0.0065887803211808205, 0.018768468871712685, -0.04178319871425629, 0.02029712311923504, 0.04852059856057167, 8.221600000979379e-05, 0.00922853872179985, 0.006065074820071459, -0.030771231278777122, -0.03804649040102959, -0.020679285749793053, -0.00966024212539196, 0.002708760090172291, -0.034564558416604996, 0.04183981567621231, -0.052200689911842346, 0.04679378494620323, 0.02410460263490677, 0.03045983985066414, -0.022137168794870377, -0.001947971759364009, 0.02090575359761715, 0.039207134395837784, -0.013212946243584156, -0.016036709770560265, 0.005849223118275404, -0.003910097759217024, 0.01878262311220169, 0.0004303761525079608, 0.01971680112183094, 0.02406213991343975, -0.005898762959986925, 0.01738135702908039, 0.0134889530017972, -0.016503797844052315, 0.014189586043357849, -0.04093394801020622, -0.052738551050424576, 0.04373648017644882, -0.03128078207373619, -0.00450811255723238, -0.03207341954112053, -0.03447963297367096, -0.019844189286231995, 0.01950448751449585, 0.003938406240195036, 0.020948216319084167, 0.020452819764614105, 0.013623417355120182, -0.03136570751667023, -0.03436639904975891, 0.0044550346210598946, 0.0002026925649261102, 0.011486133560538292, 0.01590932160615921, 0.004674424417316914, 0.0007722885347902775, -0.036121517419815063, -0.03498918190598488, 0.04520851746201515, 0.022533487528562546, -0.0022045166697353125, -0.10241979360580444, -0.02966720424592495, -0.009851323440670967, -0.00014817678311374038, -0.02387813664972782, -0.017112428322434425, 0.008379286155104637, 0.019447870552539825, 0.03447963297367096, 0.020990679040551186, -0.03249804303050041, -0.029865361750125885, 0.03915051743388176, -0.0040587168186903, -0.017409665510058403, 0.02980874665081501, -0.01906570792198181, -0.02513786032795906, 0.01796168088912964, -0.0016303869197145104, -0.0053821345791220665, -0.0038464039098471403, 0.015852704644203186, 0.02097652480006218, 0.014196663163602352, -0.0026503740809857845, 0.005622756201773882, -0.0017241585301235318, -0.00038326921639963984, -0.022745799273252487, 0.005198129918426275, 0.01330494787544012, -0.04639746993780136, 0.035640276968479156, -0.030261680483818054, 0.011344591155648232, 0.02707698568701744, 0.008435903117060661, 0.0035898589994758368, 0.006355235818773508, 0.01256893016397953, -0.0019886652007699013, -0.02424614503979683, -0.04662393406033516, -0.0006931134848855436, 0.02859148383140564, -0.023085501044988632, -0.025831416249275208, -0.042151208966970444, 0.006666628178209066, -0.0033545454498380423, -0.010028250515460968, -0.045236825942993164, 0.019674338400363922, 0.027062831446528435, 0.028181012719869614, -0.0258172620087862, 0.05412566289305687, 0.0324697345495224, 0.03145063295960426, -0.04758642241358757, -0.02590218558907509, -0.04475558176636696, 0.0033315448090434074, -0.04192474111914635, -0.009150690399110317, -0.012979401275515556, 0.050558801740407944, 0.026128653436899185, 0.023481817916035652, 0.05078526958823204, -0.028676409274339676, 0.03960345312952995, -0.028464097529649734, -0.000335719931172207, -0.02992197871208191, 0.028209321200847626, -0.003803941421210766, 0.07864073663949966, 0.06352405250072479, 0.007310644257813692, -0.01677272655069828, 0.021684234961867332, -0.05670172721147537, -0.01332617923617363, 0.00840759463608265, -0.004483343102037907, -0.027841312810778618, 0.037084005773067474, -0.0780179500579834, -0.05650356784462929, 0.04260414466261864, 0.030120138078927994, -0.04138687998056412, -0.046171002089977264, -0.013998503796756268, 0.027034522965550423, 0.02399136871099472, 0.001312802080065012, -0.06137261167168617, 0.02980874665081501, 0.03634798526763916, -0.055003222078084946, -0.01803245022892952, -0.011832911521196365, 0.04053762927651405, -0.042943842709064484, 0.02518032304942608, 0.006171231158077717, -0.026751438155770302, -0.014217894524335861, 0.0081174336373806, 0.05160621553659439, 0.0015171533450484276, 0.006164154037833214, -0.02711944840848446, 0.07484740763902664, -0.060749828815460205, 0.0612027607858181, -0.004727502819150686, -0.015102531760931015, -0.006500316318124533, 0.021528538316488266, -0.035328883677721024, -0.002052359050139785, 0.03184695169329643, 0.023212889209389687, -0.003611090360209346, -0.006411852780729532, -0.006606473121792078, -0.021967317909002304, -0.053502876311540604, 0.02287318743765354, -0.0359799787402153, -0.01997157745063305, 0.02363751456141472, 0.04636916145682335, -0.03125247359275818, 0.013552647083997726, -0.0343380905687809, 0.019051553681492805, -0.0212596096098423, 0.004543498158454895, 0.0037473244592547417, 0.02072174847126007, 0.06057997792959213, 0.0033810846507549286, -0.009964557364583015, -0.03719723969697952, 0.00917899888008833, 0.0076574222184717655, -0.04019792750477791, 0.043226927518844604, -0.016744418069720268, -0.008711909875273705, -0.018060758709907532, 0.020353740081191063, 0.0056546032428741455, -0.002438060939311981, -0.004907968919724226, -0.0033050058409571648, -0.02478400431573391, -0.019306330010294914, 0.02915765345096588, 0.016079170629382133, 0.005251208320260048, 0.019094016402959824, -0.013708342798054218, -0.030686305835843086, 0.04959631711244583, -0.0014711521798744798, 0.000404500518925488, -0.016730263829231262, 0.02111806720495224, -0.0005683795898221433, 0.03538550063967705, -0.03380022943019867, 0.010063636116683483, -0.01745212823152542, 0.03943360224366188, -0.0167019572108984, -0.020622670650482178, -0.028223475441336632, -0.004667347762733698, 0.015796087682247162, 0.005912917200475931, -0.04945477470755577, -0.04880368337035179, -0.033998388797044754, -0.019051553681492805, 0.03419654816389084, 0.013135097920894623, 0.023071346804499626, 0.016079170629382133, -0.03439470753073692, -0.00019650011381600052, -0.00017106678569689393, -0.04506697505712509, -0.04713348671793938, 0.00713017862290144, 0.014946835115551949, 0.012710471637547016, 0.01463544275611639, 0.03555535152554512, 0.0030696922913193703, -0.02093406207859516, 0.013149252161383629, -0.009865477681159973, 0.012993555516004562, 0.022575950250029564, 0.03167710080742836, -0.058202072978019714, -0.03688584640622139, -0.02331196703016758, -0.03286605328321457, 0.0007519418722949922, -0.00898084044456482, -0.001753351534716785, 0.0038004028610885143, 0.0030166138894855976, -0.0007152294274419546, -0.0307146143168211, -0.011210126802325249, 0.03204511106014252, -0.013099712319672108, 0.005806760862469673, 0.008520828559994698, 0.001855969545431435, 0.016149941831827164, 0.028676409274339676, -0.018216455355286598, -0.0013782652094960213, 0.04348170384764671, -0.04622761905193329, -0.0015463463496416807, -0.002498216461390257, -0.00012738780060317367, -0.02069343999028206, 0.055116456001996994, 0.018018297851085663, -0.03193187713623047, -0.03569689393043518, -0.016333946958184242, -0.01712658256292343, -0.035470426082611084, 0.019221404567360878, -0.004766426980495453, 0.0244159959256649, -0.05803222209215164, 0.0066170888021588326, 0.05718296766281128, -0.0474165715277195, -0.019447870552539825, -0.013113866560161114, -0.013708342798054218, -0.002945842919871211, 0.00502827949821949, -0.013793268240988255, -0.01612163335084915, -0.005679372698068619, 0.013071403838694096, -0.0011588751804083586, 0.014048043638467789, -0.039490219205617905, 0.01572531647980213, 0.033743612468242645, 0.0023531357292085886, 0.003312082961201668, -0.00011207251372979954, -0.002616757759824395, -0.021995626389980316, -0.018131529912352562, 0.002829070668667555, -0.026057882234454155, -0.0350457988679409, -0.011747986078262329, -0.002439830219373107, -0.020679285749793053, 0.05650356784462929, -0.031195856630802155, -0.0008381940424442291, -0.014154200442135334, 0.022009780630469322, 0.005304286722093821, 0.009617779403924942, -0.021896548569202423, -0.012505236081779003, -0.02312796376645565, -0.016263175755739212, -0.00778481038287282, -0.05588078126311302, 0.0071867951191961765, 0.013255408965051174, 0.0035703969188034534, 0.01012733019888401, -0.001932048355229199, 0.02226455695927143, -0.002140822820365429, 0.03300759568810463, -0.031167548149824142, -0.007229257840663195, 0.029497353360056877, 0.005686449818313122, -0.029752129688858986, 0.026624049991369247, -0.024444304406642914, -0.0032430810388177633, 0.021854085847735405, -0.015144994482398033, -0.014932680875062943, -0.022788261994719505, -0.04130195826292038, 0.038697581738233566, -0.007034637499600649, 0.041754890233278275, -0.028902877122163773, -0.012123072519898415, 0.0018736622296273708, 0.009002071805298328, -0.03699908033013344, -0.045916225761175156, -0.01663118600845337, -0.015031760558485985, 0.0062101553194224834, -0.00037398049607872963, 0.04246260225772858, 0.004879660438746214, 0.048973534256219864, -0.008669448085129261, -0.014649596996605396, -0.043085385113954544, 0.01330494787544012, 0.009171921759843826, -0.030374914407730103, -0.01817399263381958, -0.008563291281461716, 0.01220799796283245, -0.03728216513991356, -0.01936294510960579, -0.013439413160085678, -0.019730955362319946, -0.008273130282759666, -0.06375052034854889, -0.07065776735544205, 0.008704832755029202, 0.000756807392463088, 0.04495374113321304, -0.006659551057964563, 0.00922853872179985, 0.004557652398943901, -0.003320929128676653, -0.018442923203110695, 0.010573187842965126, -0.04328354448080063, -0.0009686780977062881, 0.02651081793010235, -0.005392750259488821, 0.06669459491968155, -0.035357192158699036, -0.05517307296395302, -0.0053750574588775635, 0.005106127820909023, -0.013453567400574684, -0.011563981883227825, -0.030799539759755135, -0.02798285335302353, -0.01569700799882412, 0.01892416551709175, 0.047246720641851425, 0.014833602122962475, -0.0176361333578825, -0.006380005739629269, 0.024911392480134964, 0.018202301114797592, -0.01835799776017666, 0.01738135702908039, 0.026057882234454155, 0.005470598582178354, 0.008768526837229729, -0.040707480162382126, -0.04240598529577255, -0.009433774277567863, -0.017409665510058403, 0.013856962323188782, 0.003542088670656085, -0.015314844436943531, -0.030431531369686127, 0.008202359080314636, -0.005244131200015545, -0.006050920579582453, 0.003934867680072784, 0.013389873318374157, 0.01138705387711525, -0.004253337159752846, 0.00690371124073863, 0.02941242791712284, -0.0315355584025383, -0.011549827642738819, -0.029185960069298744, -0.001253531314432621, 0.01691426895558834, -0.006546317599713802, -0.0031829257495701313, 0.03204511106014252, 0.018329689279198647, 0.014118814840912819, 0.04755811393260956, 0.02373659424483776, 0.01749459095299244, 0.0041754893027246, -0.03917882591485977, 0.01393480971455574, 0.0035863204393535852, 0.005442290101200342, 0.00029104575514793396, -0.010297181084752083, 0.006390621419996023, -0.018542002886533737, -0.014104660600423813, 0.0014667289797216654, 0.014140046201646328, 0.026708975434303284, -0.013800345361232758, 0.015399769879877567, 0.01220799796283245, -0.016716111451387405, -0.029610587283968925, -0.009837169200181961, 0.020849136635661125, 0.0001732783712213859, -0.008358055725693703, -0.01583855040371418, 0.014331127516925335, 0.00606861338019371, 0.05254039168357849, -0.025944648310542107, 0.03164879232645035, 0.002558371750637889, -0.009745166637003422, -0.014720368199050426, -0.014592980034649372, -0.024047985672950745, 0.025095397606492043, -0.041471805423498154, -0.013184637762606144, -0.02266087383031845, -0.0626181811094284, -0.022561796009540558, 0.018018297851085663, -0.054720137268304825, -0.034706100821495056, 0.035215649753808975, 0.009624856524169445, -0.01648964360356331, -0.006847094278782606, 0.03932036831974983, -0.0295539703220129, -0.10542048513889313, -0.038159724324941635, 0.029440736398100853, 0.009122381918132305, 0.01756536215543747, -0.00888883788138628, 0.02025466039776802, 0.03849942609667778, 0.0005988996126689017, -0.02578895352780819, -0.00847836583852768, -0.0056404490023851395, -0.00028507443494163454, -0.002439830219373107, 0.016829343512654305, -0.05709804221987724, 0.0038322496693581343, -0.03331898897886276, 0.012491081841289997, 0.002036435529589653, -0.022745799273252487, 0.0031280783005058765, -0.005629833322018385, 0.029752129688858986, -0.015074223279953003, 0.011783371679484844, 0.016008401289582253, 0.0350457988679409, -0.024019677191972733, 0.03275281935930252, -0.023694131523370743, -0.021316224709153175, 0.015824396163225174, 0.03445132449269295, -0.028534866869449615, 0.012441541999578476, -0.007501726038753986, -0.007834349758923054, -0.023354429751634598, 0.013623417355120182, 7.591295434394851e-05, -0.0213728416711092, 0.025406789034605026, -0.018117375671863556, 0.018726006150245667, -0.03798987343907356, 0.035753510892391205, -0.02377905696630478, 0.017069965600967407, -0.02420368231832981, 0.01201691571623087, -0.008612831123173237, 0.00624907948076725, -0.0021213607396930456, 1.9738474293262698e-05, -0.004147180821746588, 0.020594362169504166, -0.0170558113604784, 0.00642954558134079, 0.008924223482608795, -0.020495282486081123, 0.000887291447725147, 0.0015189226251095533, -0.007806041277945042, -0.022250402718782425, 0.00949746835976839, -0.008591599762439728, 0.03985822945833206, -0.024656616151332855, -0.06029689311981201, -0.019207250326871872, 0.03006352111697197, -0.00437364773824811, 0.03866927698254585, -0.000999640440568328, -0.006871864199638367, 0.042037975043058395, 0.05050218477845192, -0.018697697669267654, 0.03031829744577408, 0.03447963297367096, -0.018372152000665665, 0.03699908033013344, 0.015074223279953003, 0.0061252303421497345, 0.04166996479034424, 0.004709810018539429, -0.006461392622441053, -0.012618470005691051, 0.042575836181640625, 0.04116041585803032, -0.003027229569852352, 0.027062831446528435, -0.019617721438407898, -0.0056404490023851395, -0.022222094237804413, -0.005035356618463993, 0.01831553503870964, 0.029185960069298744, -0.03688584640622139, 0.03569689393043518, 0.03031829744577408, -0.05848515406250954, -0.03156386688351631, 0.04186812415719032, 0.012434464879333973, 0.017183199524879456, 0.011443670839071274, 0.02097652480006218, -0.005895224399864674, -0.0017338895704597235, 0.002542448230087757, -0.028888722881674767, 0.020636824890971184, 0.007381415460258722, 0.03391346335411072, 0.0462559275329113, 0.019447870552539825, 0.024189528077840805, 0.0162348672747612, 0.02058020792901516, 0.023014729842543602, -0.037112314254045486, -0.011832911521196365, -0.026765592396259308, -0.011747986078262329, 0.006015534978359938, 0.003050230210646987, -0.02434522472321987, -0.0039702532812952995, 0.035753510892391205, -0.009780552238225937, 0.0035332422703504562, -0.028237629681825638, -0.0313090905547142, 0.021882394328713417, 0.012561853043735027, 0.010764269158244133, -0.021273763850331306, 0.044698964804410934, 0.015527158044278622, 0.010205178521573544, 0.005693526938557625, 0.004723964259028435, -0.004161335062235594, -0.0076574222184717655, 0.0007435378502123058, -0.04795442894101143, -0.017607824876904488, -0.002342520048841834, 0.033885154873132706, -0.0037225547712296247, -0.01882508583366871, 0.03136570751667023, 0.00024615039001218975, -0.005357364658266306, 0.02840748056769371, -0.03665937855839729, 0.0031121547799557447, 0.035498734563589096, -0.0016215405194088817, 0.031195856630802155, -0.018343843519687653, -0.026355121284723282, 0.025491714477539062, -0.016107479110360146, -0.021811623126268387, 9.382686403114349e-05, 0.0074521866627037525, 0.010927042923867702, -0.023835673928260803, -0.04433095455169678, 0.0010102560045197606, 0.0054953680373728275, 0.0012579545145854354, 0.017069965600967407, 0.004794735461473465, 0.034026697278022766, 0.01373665127903223, 0.026171116158366203, 0.021344533190131187, 0.016362255439162254, -0.014564672484993935, 0.012533544562757015, 0.03940529376268387, -0.008612831123173237, -0.015102531760931015, 0.0013986119301989675, -0.015484695322811604, 0.03232819214463234, 0.013871116563677788, 0.01796168088912964, 0.027529919520020485, 0.0464823953807354, 0.01235661655664444, -0.026057882234454155, 0.004493958782404661, 0.0649394690990448, -0.02503878064453602, -0.04866214096546173, -0.0726393535733223, 0.047105178236961365, 0.0038534810300916433, -0.00966024212539196, -0.03917882591485977, 0.005219361279159784, 0.019476179033517838, -0.012653854675590992, 0.0037225547712296247, 0.008839298039674759, -0.0028892261907458305, 0.021684234961867332, -0.038442809134721756, 0.012653854675590992, -0.002342520048841834, -0.03702738881111145, 0.016461335122585297, -0.023354429751634598, -0.019235558807849884, -0.0036199367605149746, -0.006730322260409594, -0.007678653579205275, 0.012264614924788475, 4.1025065002031624e-05, -0.00838636327534914, -0.005849223118275404, 0.030233372002840042, -0.003124539740383625, 0.01292986236512661, 0.004355954937636852, -0.00935592595487833, 0.025732336565852165, -0.009348848834633827, 0.005063665099442005, -0.02097652480006218, -0.00620307819917798, 0.021613463759422302, -0.019773418083786964, -0.01723981648683548, 0.012703394517302513, 0.04325523599982262, 0.016829343512654305, 0.00599784217774868, -0.022533487528562546, 0.01978757232427597, -0.013906502164900303, 0.017551207914948463, 0.038018181920051575, -0.027345914393663406, -0.008216513320803642, 0.015272381715476513, 0.020014038309454918, 0.016206558793783188, 0.014564672484993935, -0.002611449919641018, -0.02237779088318348, 0.009186076000332832, 0.03459286689758301, 0.061542462557554245, 0.046171002089977264, -0.024331070482730865, 0.04733164608478546, 0.0026362198404967785, -0.0047982740215957165, -0.020679285749793053, -0.02036789432168007, -0.0037225547712296247, -0.0005900532123632729, 0.014069274999201298, 0.008626985363662243, -0.023750748485326767, 0.02123130112886429, 0.003466009860858321, 0.03221495822072029, 0.008025432005524635, 0.011111047118902206, 0.0371406227350235, -0.010106098838150501, 0.027176065370440483, -0.0017276970902457833, -0.019745109602808952, -0.025619102641940117, -0.0008603099850006402, 0.0013030710397288203, 0.0005338787450455129, 0.0008364247623831034, 0.014720368199050426, -0.007905120961368084, 0.0106864208355546, -0.010516570881009102, 0.05814545601606369, 0.05061541870236397, -0.006107537541538477, -0.008952531963586807, -0.012894476763904095, -0.0031493096612393856, 0.0025265247095376253, -0.009957480244338512, 0.025449251756072044, -0.02969551272690296, 0.04328354448080063, 0.02737422287464142, 0.027784695848822594, -0.0007545957923866808, 0.0001002957797027193, 0.013411104679107666, -0.007622037082910538, -0.028294246643781662, -0.01220799796283245, -0.022066397592425346, -0.01824476383626461, 0.0341116227209568, 0.01569700799882412, -0.000858098384924233, 0.006864787079393864, -0.017084119841456413, -0.009037456475198269, -0.016574569046497345, 0.016503797844052315, -0.01522991992533207, 0.018159838393330574, -0.007480494678020477, 0.0008996763499453664, 0.015328998677432537, -0.017338896170258522, 0.012080609798431396, 0.0034076236188411713, -0.004097640980035067, 0.007614959962666035, 0.0213728416711092, 0.021316224709153175, 0.018485385924577713, 0.006755092181265354, -0.003303236560896039, -0.037621863186359406, -0.02714775688946247, -0.03196018561720848, -0.013864039443433285, -0.02133037894964218, -0.0336303785443306, 0.055654317140579224, 0.03113924153149128, 0.012236306443810463, 0.00462488504126668, 0.0010111406445503235, 0.006065074820071459, 0.007338952738791704, 0.009561162441968918, 0.009900863282382488, -0.03181864321231842, 0.07065776735544205, -0.028817951679229736, -0.01332617923617363, -0.006252618040889502, -0.020636824890971184, 0.02338273823261261, -0.026737283915281296, -0.01798998937010765, -0.039631761610507965, 0.016206558793783188, -0.006691398099064827, 0.02798285335302353, -0.004232105799019337, -0.00929930992424488, 0.014536364004015923, -0.027062831446528435, 0.022108860313892365, 0.04169827327132225, 0.024147065356373787, 0.013991426676511765, 0.029214268550276756, 0.016263175755739212, -0.0061464617028832436, -0.012639700435101986, -0.01665949448943138, 0.0038251725491136312, -0.021415304392576218, -0.001528653665445745, -0.0007913082372397184, 0.0221937857568264, 0.005053049419075251, -0.03099769912660122, -0.05248377472162247, 0.022533487528562546, -0.031337399035692215, 0.016107479110360146, -0.022745799273252487, 0.023142118006944656, -0.025095397606492043, -0.0011199511354789138, 0.012420310638844967, -0.0026486048009246588, -0.0048902761191129684, 0.008025432005524635, -0.01143659371882677, 0.0008054624777287245, -0.006075690500438213, 0.01522991992533207, 0.008846375159919262, 0.01943371631205082, -0.004677962977439165, -0.024826467037200928, 0.019815880805253983, -0.0221937857568264, 0.008641139604151249, -0.012165535241365433, -0.01576777920126915, 0.03646121919155121, 0.007883889600634575, -0.006620627362281084, -0.023368583992123604, 0.015994247049093246, -0.03835788369178772, 0.003239542478695512, 0.017395511269569397, -0.023764902725815773, 0.0018090837402269244, 0.019589412957429886, -0.015484695322811604, 0.04574637487530708, -0.048718757927417755, -0.005951841361820698, -0.016928423196077347, 0.019164787605404854, 0.0075583430007100105, 0.005813837982714176, -0.010325489565730095, 0.007338952738791704, 0.0002492466301191598, -0.002349597169086337, -0.005870454479008913, 0.002140822820365429, -0.01866939105093479, 0.03742370381951332, 0.006365851499140263, -0.007108947262167931, 0.020820828154683113, -0.02363751456141472, -0.04101887345314026, 0.02525109238922596, -0.016801035031676292, 0.019207250326871872, 0.06358066946268082, 0.018910011276602745, -0.014734522439539433, -0.010856271721422672, -0.010481185279786587, 0.02280241623520851, 0.021995626389980316, -0.007940506562590599, -0.0029051497112959623, -0.0076574222184717655, -0.005120282061398029, 0.030799539759755135, -0.028931185603141785, 0.011479056440293789, -0.03377192094922066, 0.0036730149295181036, 0.012915708124637604, 0.009561162441968918, 0.0004869929398410022, -0.026949597522616386, 0.03663107007741928, 0.007961737923324108, -0.0034359320998191833, 0.020566053688526154, 0.005944764241576195, 0.013375719077885151, 0.0022098245099186897, -0.014423130080103874, 0.016730263829231262, -0.0035031645093113184, 0.023028884083032608, 0.01759367063641548, -0.0083509786054492, -0.012682163156569004, 0.0022345944307744503, -0.009943326003849506, 0.010941197164356709, 0.008570368401706219, -0.024359378963708878, -0.011245512403547764, 0.017324741929769516, 0.0038817895110696554, -0.004295799881219864, 0.007912198081612587, -0.016617031767964363, -0.036291368305683136, -0.012639700435101986, 0.0040551782585680485, 0.0016772727249190211, -0.0074309553019702435, -0.0031970799900591373, 0.042689066380262375, -0.006726783700287342, -0.011252589523792267, 0.01605086401104927, 0.0017480436945334077, 0.016135787591338158, 0.002981228521093726, 0.003952560480684042, 0.012752934359014034, -0.0011234896956011653, -0.008110356517136097, 0.018768468871712685, -0.010283026844263077, -0.005590909160673618, -0.014564672484993935, -0.004150719381868839, 0.005038895178586245, 0.008372209034860134, -0.007002790458500385, -0.0055024451576173306, 0.014890219084918499, 0.05477675423026085, -0.0038251725491136312, -0.01882508583366871, 0.0014331127749755979, 0.023439355194568634, 0.014373590238392353, -0.018726006150245667, 0.0031086162198334932, 0.004345339257270098, -0.012993555516004562, -0.002059436170384288, -0.03759355470538139, -0.02668066695332527, 0.012399079278111458, -0.001245569670572877, -0.008032508194446564, -0.019985731691122055, -0.0034624713007360697, 0.017834292724728584, 0.004794735461473465, -0.02392059937119484, -0.00471334857866168, 0.011946145445108414, 0.016857651993632317, -0.0025389096699655056, 0.002623834880068898, 0.0007514995522797108, -0.010735960677266121, 0.007869735360145569, 0.01026887260377407, 0.01332617923617363, 0.020551899448037148, 0.017650287598371506, 0.011408285237848759, 0.036036595702171326, 0.004674424417316914, -0.010311335325241089, -0.0035102416295558214, -0.014210817404091358, 0.005597986280918121, -0.00791927520185709, 0.012172612361609936, 0.0015490002697333694, -0.0006395929376594722, -0.007883889600634575, -0.008803912438452244, -0.0003107289376202971, -0.01131628267467022, 0.021967317909002304, 0.002662759041413665, 0.02326950617134571, 0.020282968878746033, -0.006036766339093447, -0.013432336039841175, -0.026992060244083405, -0.004087025299668312, -0.00437364773824811, -0.007699884939938784, 0.005070742219686508, 0.010120253078639507, -0.00874729547649622, 0.03581012785434723, 0.002268210519105196, 0.0096956267952919, 0.007586651481688023, 0.014522209763526917, 0.011450747959315777, -0.034932564944028854, -0.010134407319128513, 0.012236306443810463, -0.004982278682291508, 0.01007779035717249, -0.00232482748106122, -0.01515914872288704, 0.010445799678564072, 0.00552367651835084, -0.02539263479411602, 0.038301266729831696, 0.026312658563256264, 0.021146375685930252, -0.01983003504574299, 0.08951116353273392, 0.04597284272313118, 0.034932564944028854, -0.0343380905687809, -0.005081357900053263, 0.0025459867902100086, -0.01504591479897499, -0.004989355802536011, -0.03663107007741928, 0.029978595674037933, -0.037367090582847595, -0.024982163682579994, -0.01630563847720623, -0.02233532816171646, 0.023694131523370743, -0.008358055725693703, -0.018089067190885544, -0.017933372408151627, 0.0045187282375991344, -0.012441541999578476, 0.036263059824705124, -0.002664528088644147, 0.015187457203865051, 0.016900114715099335, -0.03646121919155121, -0.006082767620682716, 0.0074451095424592495, -0.01598009280860424, -0.004745195619761944, 0.011691369116306305, 0.019674338400363922, 0.0056475261226296425, 0.001610924955457449, 0.0235950518399477, -0.018485385924577713, 0.010028250515460968, -0.009752243757247925, -0.03510241582989693, 0.008570368401706219, 0.0071938722394406796, -0.006436622701585293, -0.01784844696521759, -0.016107479110360146, -0.008506674319505692, 0.03278112784028053, -0.03261127695441246, 0.0058669159188866615, 0.008641139604151249, -0.018768468871712685, -0.012328308075666428, 0.00874729547649622, -0.001245569670572877, -0.007126640062779188, -0.019844189286231995, 0.03139401599764824, -0.010353797115385532, -0.024628307670354843, 0.012675086036324501, 0.04223613440990448, 0.0343380905687809, 0.04130195826292038, -0.015668699517846107, 0.04133026301860809, -0.013722497038543224, 0.025194477289915085, 0.0075583430007100105, 0.0015029991045594215, -0.003676553489640355, -0.00029303616611287, 0.02438768744468689, 0.01339695043861866, -0.001253531314432621, -0.020311277359724045, -0.02938411943614483, 0.016149941831827164, -0.030657997354865074, 0.00840759463608265, -0.020311277359724045, 0.007317721378058195, 0.005509522277861834, -0.012392002157866955, -0.01484775636345148, 0.021344533190131187, 0.024769850075244904, 0.015215765684843063, 0.02058020792901516, 0.011061507277190685, 0.0030608458910137415, 0.02761484496295452, -0.004079948179423809, 0.02097652480006218, 0.0023902906104922295, 0.00027202602359466255, 0.02826593816280365, -0.033205755054950714, -0.0334039144217968, -0.029837053269147873, -0.02259010449051857, 0.014104660600423813, -0.021953165531158447, -0.005176898557692766, -0.01427451055496931, 0.02567571960389614, 0.004026869777590036, 0.004200258757919073, 0.03430978208780289, 0.01838630624115467, 0.004550575278699398, -0.01756536215543747, 0.011931991204619408, 0.02658158726990223, 0.002185054589062929, -0.017183199524879456, -0.021556846797466278, 0.004044562578201294, -0.050700344145298004, -0.01259016152471304, 0.004971663001924753, 0.022547641769051552, -0.0036411681212484837, 0.022859033197164536, -0.005300748161971569, -0.014692059718072414, -0.017211508005857468, -0.002036435529589653, 0.012101841159164906, 0.053644418716430664, 0.022759953513741493, 0.0315355584025383, -0.012179689481854439, -0.013290793634951115, -0.023863982409238815, -0.018584465608000755, -0.0029776899609714746, -0.03125247359275818, 0.004504574462771416, -0.01104735303670168, 0.004667347762733698, -0.025279400870203972, 0.018414614722132683, -0.0045258053578436375, -0.01271754875779152, 0.01312802080065012, -0.02018388919532299]",Model Alignment as Prospect Theoretic Optimization.pdf
" feedback, although
depending on the implementation, it may be the retriever and not the LLM that is updated (Lu et al., 2022).
Online Alignment A recent string of work has centered on the idea of “self-training” or “self-play”, during which the
policy is continually aligned on online data sampled from itself and then filtered (Chen et al., 2024; Yuan et al., 2024). Many
of these approaches frame the learning of a preference model as a two-player min-max game between two policies (Munos
et al., 2023; Rosset et al., 2024; Swamy et al., 2024). In theory, KTO can also be adapted for online alignment, though we
leave this as a direction for future work.
Prospect Theory Prospect theory, despite being influential in behavioral economics, has had a muted impact in machine
learning, with work concentrated in human-robot interaction (Kwon et al., 2020; Sun et al., 2019; Chan et al., 2021).
B. Proofs
Theorem 3.5 (restated) DPO and PPO-Clip are human-aware loss functions.
Proof. For a loss fto be a HALO, it needs to be linear in
vf(rθ(x, y)−EQ[rθ(x′, y′)])
where rθ(x, y) = l(x, y) logπθ(y|x)
πref(y|x)is the implied reward (normalized by factor l(y)),Q(X′, Y′|x, y)is an input-
conditioned reference point distribution, and vf: R→ Ris a value function (in the prospect theoretic sense) that
is non-decreasing everywhere and concave in (0,∞).
The DPO loss is
LDPO(πθ, πref) =Ex,yw,yl
−logσ
βlogπθ(yw|x)
πref(yw|x)−βlogπθ(yl|x)
πref(yl|x)
where β >0is a hyperparameter. DPO meets the criteria with the following construction: l(y) =β;rθ=βlogπθ(y|x)
πref(y|x);
vDPO(·) = log σ(·)is increasing and concave everywhere; and Qplaces all mass on (x, yl), where ylis a dispreferred output
forxsuch that y≻yl.
The PPO-Clip loss is
LPPO (offline) =−Ex,y,t∼D[min( qθA(x:y<t, yt),clip(qθ,1−ϵ,1 +ϵ)A(x:y<t, yt))]
where qθ=πθ(yt|x:y<t)
πref(yt|x:y<t)are the token-level probability ratios (where y<tdenotes the output sequence up to the t-th token),
Adenotes the token-level advantages, and ϵ∈(0,1)is a hyperparameter.
Since this is a token-level objective, let x:y<tdenote the actual input and the token yithe actual output for the purpose
of framing this as a HALO. The advantage function A(x:y<t, yt)can be expressed as Qπ(x:y<t, yt)−Vπ(x:y<t), the
13
Model Alignment as Prospect Theoretic Optimization
difference between the action-value and value functions. Because Vπ(x:y<t) = Ey∼πQπ(x:y<t, y), we can break down
the reference point distribution as follows: Q(Y′|X′)as the current policy as Q(X′|x, y)as 1[x′=x].
The HALO-defined reward rθis then implied by the product qθQπ(x:y<t, y). Assume without loss of generality that Qπis
non-negative, since a constant can be added to Qπwithout changing the advantage. Then means ∃u≥1, qθQπ(x:y<t, y) =
logu= log ˆ πθ(x:y<t, y)/ˆπref(x:y<t, y), where ˆπθ,ˆπrefare some implied policy and reference distributions. It is trivial to
show that the latter exist but are not unique.
For clarity, we can first write the value function piecewise. Where qθA=rθ−z0in the HALO notation:
vf(qθA) =(
Amin(qθ,1 +ϵ)ifA(x:y<t, yt)≥0
Amax( qθ,1−ϵ)ifA(x:y<t, yt)<0
which we can combine","[-0.010877011343836784, 0.002648666501045227, 0.028315186500549316, 0.012154287658631802, 0.0243354644626379, 0.011139188893139362, 0.0001069823483703658, 0.03221423923969269, 0.00023843882081564516, 0.03406964987516403, 0.05894291400909424, -0.03740401193499565, -0.014278599061071873, -0.03872162476181984, 0.01324333343654871, -0.0231523048132658, 0.015959223732352257, -0.030789067968726158, 0.010386268608272076, 0.03600573167204857, -0.002831854857504368, -0.021054882556200027, -0.018970906734466553, 0.06448225677013397, 0.006067059934139252, -0.022412829101085663, 0.029014326632022858, 0.01757262647151947, -0.010366100817918777, -0.04409962520003319, 0.0807238295674324, -0.03052016906440258, -0.02207670360803604, -0.019696936011314392, 0.0052200243808329105, 0.03372007980942726, 0.0004165851860307157, 0.038318272680044174, -0.005781353451311588, -0.019764162600040436, 0.006517467554658651, -0.054694294929504395, -0.019159136340022087, 0.03156887739896774, 0.01637602038681507, 0.04772977903485298, 0.015098744072020054, 0.009996363893151283, -0.007300639525055885, 0.004736003931611776, -0.05878157541155815, 0.032967161387205124, -0.025088384747505188, 0.0296865776181221, -0.0032301631290465593, -0.019199471920728683, 0.014009698294103146, -0.0017545735463500023, 0.05133303999900818, -0.018796121701598167, -0.009700573049485683, -0.02874542772769928, 0.001605838187970221, 0.035467930138111115, -0.024806039407849312, 0.00873253308236599, -0.09094203263521194, 0.03673176094889641, -0.003979722503572702, 0.03907119482755661, 0.02471192553639412, 0.01745161972939968, 0.03740401193499565, 0.0032335245050489902, -0.02127000316977501, -0.02219770848751068, 0.039501432329416275, 0.061363015323877335, 0.01699448935687542, -0.013196275569498539, 0.012665197253227234, -0.008618250489234924, 0.06141679733991623, -0.05235486105084419, 0.014802954159677029, -0.047810450196266174, -0.04310469701886177, -0.028826097026467323, -0.03506458178162575, 0.0026906821876764297, -0.019777607172727585, -0.02457747422158718, -0.019414592534303665, -0.04444919526576996, 0.03726956248283386, 0.006288902368396521, -0.01175765972584486, 0.013794578611850739, 0.03691999241709709, -0.02161957323551178, -0.027132026851177216, -0.08373551070690155, 0.008463632315397263, -0.028933657333254814, 0.05550099536776543, 0.015179414302110672, 0.0014907153090462089, 0.038318272680044174, 0.017639851197600365, -0.022143928334116936, -0.08529513329267502, -0.011932444758713245, -0.05098346993327141, 0.014439938589930534, 0.02054397203028202, -0.06502006202936172, -0.05407582223415375, 0.0028738705441355705, -0.004581386689096689, -0.021404452621936798, -0.027011021971702576, -0.017895305529236794, 0.037108223885297775, -0.004110811278223991, 0.0007344335899688303, -0.011898832395672798, 0.013646683655679226, -0.0510641410946846, -0.004823396448045969, -0.04420718550682068, 0.006275457330048084, 0.04735331982374191, -0.0077981045469641685, -0.07098964601755142, -0.07803482562303543, 0.014103813096880913, -0.012087062001228333, 0.001554579008370638, 0.006951068993657827, 0.00348897953517735, -0.018365880474448204, -0.07281816750764847, -0.06588053703308105, -0.01696760021150112, -0.07405510544776917, 0.03431165963411331, -0.008658585138618946, -0.01140808966010809, -0.025814415886998177, 0.028906768187880516, 0.03052016906440258, -0.06362178176641464, -0.022264933213591576, 0.0439920648932457, -0.001023501274175942, -0.03861406445503235, -0.01628190465271473, 0.02756226621568203, 0.013391228392720222, -0.004110811278223991, -0.024738814681768417, 0.03334362059831619, 0.0009285458945669234, 0.010298876091837883, 0.039501432329416275, 0.01852722093462944, -0.009727463126182556, 0.03382764011621475, -0.06835442036390305, -0.03963588550686836, -0.0008201454766094685, -0.012624862603843212, -0.05786731466650963, -0.043884508311748505, -0.010446771048009396, -0.022964073345065117, -0.03245624899864197, -0.01722305454313755, -0.021122107282280922, -0.045551687479019165, 0.02494049072265625, 0.027508486062288284, 0.009162773378193378, -0.03156887739896774, -0.03275204077363014, 0.021767467260360718, -0.00990897137671709, -0.0010789618827402592, -0.01039299089461565, 0.05144060030579567, 0.025478290393948555, 0.033773861825466156, 0.04832135885953903, -0.05770597606897354, -0.008100617676973343, -0.03514525294303894, 0.05044567212462425, 0.06830064207315445, -0.011609764769673347, 0.008658585138618946, 0.013014768250286579, 0.023542208597064018, 0.03113863803446293, -0.06609565764665604, -0.01058122143149376, 0.02268172800540924, 0.015744104981422424, 0.002719252835959196, -0.031541988253593445, -0.03304782882332802, 0.021471677348017693, -0.007152744103223085, 0.045551687479019165, 0.012053449638187885, -0.04455675557255745, -0.012282014824450016, -0.038560282438993454, 0.03135376051068306, 0.017787745222449303, 0.09524443745613098, -0.013720630668103695, 0.035118360072374344, 0.03062772937119007, 0.034741900861263275, -0.03259069845080376, 0.014292043633759022, 0.028180737048387527, -0.029310118407011032, 0.013445008546113968, -0.04794489964842796, 0.04065770283341408, 0.004349460359662771, -0.024564029648900032, -0.019912056624889374, 0.009209830313920975, -0.03339739888906479, 0.009229998104274273, -0.01827176660299301, -0.005357835907489061, -0.057544633746147156, -0.02316574938595295, 0.004668779205530882, 0.048294469714164734, -0.015851665288209915, 0.019670046865940094, 0.027226140722632408, -0.0243354644626379, 0.01913224719464779, -0.001437775557860732, -0.01794908568263054, 0.03786114230751991, -0.008268680423498154, -0.032133568078279495, 0.01210722979158163, -0.046869296580553055, -0.0052805268205702305, 0.022587614133954048, -0.0006541836773976684, -0.03347807005047798, 0.0008167842170223594, -0.010655169375240803, 0.025343840941786766, 0.002036918653175235, 0.009687128476798534, 0.003730989759787917, -0.008954375050961971, -0.004998181946575642, -0.022977519780397415, -0.0032620951533317566, -0.003073865082114935, -0.00019022585183847696, 0.011562706902623177, -0.021565793082118034, 0.028826097026467323, -0.038775403052568436, -0.04893982782959938, 0.02231871336698532, 0.026943795382976532, -6.683114406769164e-06, -0.01204672735184431, -0.04813312739133835, 0.03100418858230114, 0.043884508311748505, -0.013861803337931633, 0.034499891102313995, -0.007939277216792107, -0.017303725704550743, 0.008907318115234375, -0.042002204805612564, -0.013707186095416546, -0.007737602107226849, -0.04084593430161476, 0.04011990502476692, -0.04452986642718315, 0.02127000316977501, 0.029014326632022858, 0.01270553283393383, -0.05722195282578468, 0.02777738682925701, 0.025088384747505188, 0.05603879317641258, 0.0012529067462310195, -0.027253031730651855, 0.021417897194623947, 0.017384395003318787, -0.0048872604966163635, 0.03552171215415001, 0.036167070269584656, -0.011246749199926853, -0.024738814681768417, 0.02909499779343605, 0.008658585138618946, 0.005159521941095591, 0.006897289305925369, -0.018554111942648888, -0.019186027348041534, 0.046519726514816284, -0.01039299089461565, -0.028906768187880516, -0.0273337010294199, -0.02172713354229927, -0.054586734622716904, -0.009176217950880527, 0.0057309349067509174, 0.005062045529484749, -0.01887679100036621, -0.022533833980560303, -0.005845217499881983, -0.003660403424873948, -0.049370069056749344, 0.004806590266525745, 0.018002865836024284, -0.0021343950647860765, 0.003657042281702161, -0.00213607563637197, 0.0109778493642807, -0.011166078969836235, 0.05953449755907059, 0.015179414302110672, 0.011428256519138813, -0.07437778264284134, -0.024900155141949654, -0.024550585076212883, -0.007838440127670765, -0.05560855194926262, -0.0006655278848484159, 0.02815384790301323, 0.014695393852889538, 0.01901124231517315, 0.011381199583411217, -0.028449637815356255, -0.03624774143099785, 0.029740357771515846, 0.0015806287992745638, 0.018244875594973564, 0.025989200919866562, -0.00015377727686427534, -0.03514525294303894, -0.034634340554475784, 0.011327419430017471, 0.0057141282595694065, -0.00368393212556839, 0.0013117286143824458, 0.010359378531575203, -0.008745977655053139, 0.03170333057641983, -0.0036805709823966026, -0.01664491929113865, 0.024039674550294876, 0.00745525723323226, -0.012315627187490463, 0.02008684165775776, -0.05958827584981918, 0.016349129378795624, -0.0475415475666523, 0.012429909780621529, -0.014950849115848541, 0.021001102402806282, 0.024752259254455566, 0.021686797961592674, -0.0019881806802004576, -0.01265847496688366, -0.03245624899864197, -0.010816508904099464, 0.0007260304410010576, 0.02387833409011364, -0.017424730584025383, -0.029525237157940865, -0.05200529098510742, -0.02148512378334999, 0.04418029636144638, -0.007018294185400009, -0.02350187487900257, 0.03627463057637215, -0.030708398669958115, 0.008752699941396713, 0.0020671701058745384, 0.05308089032769203, 0.035118360072374344, 0.06986026465892792, -0.046143267303705215, 0.0207994282245636, -0.07098964601755142, -0.013821468688547611, -0.07658276706933975, -0.034849461168050766, -0.01074928417801857, 0.032241128385066986, 0.00463180523365736, 0.020933877676725388, 0.04372316598892212, -0.014386158436536789, 0.03151509910821915, -0.024402689188718796, 0.04665417969226837, -0.020355742424726486, -0.017854969948530197, -0.005166244227439165, 0.052919551730155945, 0.04764910787343979, 0.020154066383838654, -0.037108223885297775, 0.008591360412538052, -0.014762618578970432, -0.04189464449882507, 0.011334141716361046, 0.013250055722892284, 0.007112409453839064, 0.024806039407849312, -0.05450606346130371, -0.01854066550731659, 0.0004214169748593122, 0.03514525294303894, -0.021525457501411438, -0.05058012157678604, -0.04143751412630081, -0.004430130124092102, 0.026338770985603333, -0.008866982534527779, -0.013048380613327026, 0.02042296715080738, -0.006477132439613342, -0.029014326632022858, -0.0016999532235786319, -0.02398589439690113, 0.002193216932937503, -0.017491955310106277, -0.003260414581745863, -0.010480383411049843, 0.008416575379669666, -0.02695724181830883, 0.06001851707696915, 0.06980647891759872, -0.021350672468543053, 0.004006612580269575, -0.06023363769054413, 0.06926868110895157, 0.01109885424375534, 0.014345823787152767, 0.025357285514473915, -0.03304782882332802, -0.036651093512773514, 0.0006071261595934629, -0.017962530255317688, 0.04415340721607208, 0.020691867917776108, -0.012369407340884209, 0.008651862852275372, -0.03127308934926987, 0.017518846318125725, 0.0029797498136758804, -0.032483138144016266, 0.03987789526581764, -0.020839761942625046, 0.000539901084266603, 0.01052071899175644, 0.03764602169394493, -0.002050363691523671, 0.021054882556200027, -0.016429800540208817, 0.013135773129761219, -0.07276438176631927, -0.009868635796010494, -0.004705752711743116, 0.04076526314020157, 0.054694294929504395, 0.04100727662444115, 0.001781463623046875, -0.021901918575167656, -0.002349515212699771, 0.0063662114553153515, -0.04681551828980446, 0.0630301982164383, -0.015878554433584213, 3.2693427783669904e-05, -0.02659422531723976, 0.008067005313932896, 0.007979611866176128, 0.00939133856445551, -0.005031794309616089, 0.02065153233706951, -0.042835794389247894, -0.020812872797250748, 0.028557198122143745, 0.018984351307153702, 0.0011831606971099973, 0.008302292786538601, -0.01925325207412243, -0.014466828666627407, 0.06813929975032806, -0.03893674537539482, 0.002230190671980381, -0.02861097641289234, 0.005989751312881708, -0.028664756566286087, -0.00028738705441355705, -0.02163301780819893, -0.022157372906804085, -0.00023822873481549323, 0.019065020605921745, -0.0106820585206151, -0.022264933213591576, -0.004695669282227755, 0.027589157223701477, 0.01747851073741913, 0.029740357771515846, -0.05770597606897354, -0.07443156838417053, -0.022654838860034943, -0.025357285514473915, 0.03242935985326767, -0.008631695061922073, 0.022748954594135284, 0.02101454697549343, -0.011703879572451115, -0.0027108497451990843, -0.02826140634715557, -0.01793564110994339, -0.010661891661584377, -0.004184758756309748, 0.01460127905011177, -0.025626186281442642, 0.011703879572451115, 0.019804496318101883, 0.014574388973414898, -0.030116818845272064, 0.027831166982650757, -0.008920762687921524, 0.006258651148527861, 0.025034604594111443, -0.0042822351679205894, -0.001315089873969555, -0.05867401510477066, -0.024201015010476112, -0.04302402585744858, -0.00392258120700717, -0.004433491267263889, -0.017774300649762154, 0.031999118626117706, 0.006924179382622242, -0.006836786866188049, -0.009196385741233826, -0.02424135059118271, 0.025101829320192337, 0.0026503473054617643, 0.02898743748664856, 0.011320697143673897, 0.01923980750143528, 0.014466828666627407, 0.030573949217796326, -0.05765219405293465, 0.014977739192545414, 0.018930571153759956, -0.03385452926158905, 0.017048269510269165, -0.009014877490699291, 0.025021160021424294, -0.01770707592368126, 0.01593233458697796, -0.012100507505238056, -0.023313643410801888, -0.02043641172349453, -0.027696717530488968, -0.03358563035726547, -0.01983138732612133, 0.025948865339159966, 0.00339822587557137, 0.038667842745780945, -0.047218870371580124, 0.027132026851177216, 0.04477187618613243, -0.02291029319167137, -0.031299978494644165, -0.011334141716361046, -0.04452986642718315, -0.015192858874797821, 0.011172802187502384, 0.001232739188708365, 0.014695393852889538, -0.04444919526576996, 0.00891404040157795, -0.0011999669950455427, 0.011824884451925755, -0.01591889001429081, -0.017142385244369507, 0.023932114243507385, -0.023582544177770615, 0.010823231190443039, 0.011885386891663074, 0.01336433831602335, -0.008463632315397263, -0.006292263977229595, 0.01875578612089157, -0.01503151934593916, -0.06276129931211472, -0.019871722906827927, -0.007448534481227398, 0.0037377122789621353, 0.041141726076602936, -0.014991183765232563, -0.001542814658023417, 0.00866530742496252, 0.023219529539346695, -0.008235067129135132, -0.010298876091837883, 0.0012831579660996795, -0.022130483761429787, -0.016564249992370605, -0.01068878173828125, -0.0065073841251432896, -0.01831210032105446, -0.02671523205935955, -0.0029663050081580877, 0.02887987717986107, 0.04576680809259415, 0.013142495416104794, 0.007206524256616831, -0.006258651148527861, 0.031057968735694885, -0.03468812257051468, 0.013566013425588608, 0.022278377786278725, 0.009162773378193378, -0.02231871336698532, 0.010124091058969498, -0.005139354150742292, -0.002746142912656069, 0.028234517201781273, -0.018002865836024284, -0.018930571153759956, 0.0037108222022652626, -0.02104143798351288, 0.014789508655667305, -0.026284990832209587, 0.02184813842177391, -0.01590544544160366, -0.01062827929854393, 0.0067695616744458675, 0.01698104478418827, 0.00240497593767941, -0.019522150978446007, -0.04098038375377655, -0.013781133107841015, 0.0016537359915673733, 0.012429909780621529, 0.028073176741600037, 0.013451730832457542, 0.0772281289100647, 0.008356072939932346, -0.02504805102944374, -0.03221423923969269, 0.00872580986469984, 0.011085408739745617, -0.017303725704550743, 0.0019780967850238085, -0.019549041986465454, -0.007219969294965267, -0.027858056128025055, -0.05246242135763168, 0.0098014110699296, -0.02363632433116436, -0.0024217821191996336, -0.05262376368045807, -0.011811439879238605, -0.017639851197600365, -0.011959334835410118, 0.05014988034963608, -0.0166314747184515, 0.0020638087298721075, 0.00578807620331645, -0.02542451024055481, -0.01652391441166401, 0.018459996208548546, -0.03839894384145737, -0.007502314634621143, 0.030681507661938667, 0.02053052745759487, 0.061470575630664825, 0.000775188731495291, -0.08255235105752945, -0.013256778009235859, 0.005562872160226107, -0.006712420377880335, -0.023757329210639, -0.05275821313261986, -0.01958937756717205, 0.00047225592425093055, 0.05297333374619484, 0.02539762109518051, -0.0064973002299666405, -0.018607892096042633, 0.008705643005669117, -0.008362795226275921, 0.015703769400715828, -0.0020604475867003202, 0.018123870715498924, 0.015407979488372803, -0.021404452621936798, 0.0033478070981800556, -0.03291337937116623, -0.019024686887860298, 0.004964569117873907, -0.05905047431588173, 0.006386378780007362, -0.009404783137142658, 0.002783116651698947, -0.045067667961120605, 0.007986335083842278, -0.02233215793967247, 0.010655169375240803, -0.02172713354229927, -0.01111229881644249, -0.02576063573360443, -0.01371390838176012, -0.00010987092537106946, 0.034849461168050766, 0.018083535134792328, 0.0255320705473423, -0.012140842154622078, -0.0025074940640479326, 0.008893872611224651, 0.019750716164708138, -0.011307251639664173, 0.00362342968583107, 0.01816420629620552, 0.00463180523365736, 0.00967368297278881, 0.014681949280202389, 0.0036402358673512936, 0.03839894384145737, 0.006077143829315901, 0.011811439879238605, 0.010635001584887505, -0.005764547269791365, 0.00968040619045496, -0.0037679634988307953, -0.005966222379356623, -0.004198203794658184, -0.0023058189544826746, -0.009162773378193378, -0.001598275383003056, 0.008019947446882725, -0.02090698853135109, 0.023071633651852608, 0.009451841004192829, -0.030600838363170624, -0.03600573167204857, 0.004329292569309473, 0.06571920216083527, -0.00825523491948843, 0.014211373403668404, 0.02340775914490223, -0.000289487827103585, 0.026204321533441544, 0.07109720259904861, 0.013041658326983452, 0.028422746807336807, -0.020234737545251846, -0.018338991329073906, -0.020517082884907722, -0.037242673337459564, -0.010796341113746166, 0.017155829817056656, -0.02874542772769928, -0.023905225098133087, -0.005599845666438341, -0.008463632315397263, -0.019535597413778305, 0.0303050484508276, -0.01686003990471363, -0.024738814681768417, -0.015044963918626308, -0.009821578860282898, -0.026392551138997078, 0.009976196102797985, 0.03412343189120293, -0.02861097641289234, -0.12068239599466324, -0.021673353388905525, 0.013572735711932182, 0.01579788513481617, -0.002868828596547246, 0.0035091470927000046, 0.051010359078645706, 0.006393101532012224, -0.006463687866926193, -0.030600838363170624, 0.009135883301496506, -0.03955521434545517, 0.02102799341082573, -0.0139559181407094, 0.019320476800203323, -0.0713123232126236, 0.0010411478579044342, -0.008356072939932346, 0.010366100817918777, -0.02481948584318161, -0.04267445579171181, -0.023259863257408142, 0.00012877797416877002, 0.04536345601081848, -0.029901698231697083, 0.0004365426138974726, 0.028476526960730553, 0.005764547269791365, -0.01068878173828125, 0.010110646486282349, -0.0067393104545772076, -0.030116818845272064, -0.013734076172113419, 0.02066497690975666, -0.05499008297920227, 0.0003705780254676938, 0.009169495664536953, 0.002006667433306575, -0.009976196102797985, 0.037108223885297775, 0.013969363644719124, -0.059426937252283096, 0.051359932869672775, 0.0002378085773671046, 0.046869296580553055, -0.04358871653676033, -0.006144368555396795, -0.025007715448737144, -0.0020604475867003202, 0.0010453494032844901, 0.019065020605921745, -0.055985014885663986, 0.0059023587964475155, -0.00570068322122097, -0.005741018336266279, -0.008819925598800182, 0.011240026913583279, -0.004581386689096689, -0.00992241594940424, -0.0321066789329052, -0.00843674223870039, 0.03506458178162575, 0.02483293041586876, -0.0332898385822773, -0.028557198122143745, -0.013518955558538437, 0.023663213476538658, 0.03275204077363014, -0.019683491438627243, -0.03573683276772499, -0.0020873374305665493, -0.009747630916535854, 0.012665197253227234, 0.01899779587984085, 0.00493095675483346, -0.014413048513233662, 0.02898743748664856, 0.015865109860897064, -0.034499891102313995, 0.023959005251526833, 0.035467930138111115, -0.026701785624027252, 0.012880317866802216, 0.027965616434812546, 0.0012234956957399845, 0.03952832520008087, -0.014332378283143044, -0.020933877676725388, -0.015649989247322083, -0.01734406128525734, 0.030923519283533096, -0.01866167038679123, -0.005593123380094767, -0.030143707990646362, -0.0172096099704504, -0.04939695820212364, -0.05025744065642357, 0.01371390838176012, 0.027858056128025055, -0.027118582278490067, 0.0225607231259346, -0.001710877288132906, -0.026674896478652954, -0.0043024024926126, 0.007777937222272158, -0.005838494747877121, 0.001826840452849865, 0.0017915472853928804, 0.038183823227882385, 0.0009033365058712661, -0.007273749448359013, -0.017196165397763252, -0.019387701526284218, 0.018110426142811775, -0.013734076172113419, 0.02457747422158718, 0.02947145700454712, 0.014897068962454796, 0.010218205861747265, -0.0010403074556961656, 0.003010001266375184, 0.04713819921016693, -0.024846374988555908, 0.012981154955923557, 0.00046973497956059873, -0.015407979488372803, 0.0034788958728313446, 0.03952832520008087, -0.019293585792183876, -0.024738814681768417, 0.0019629711750894785, -0.027965616434812546, -0.0136534059420228, -0.0027579073794186115, -0.010823231190443039, 0.037726692855358124, 0.027253031730651855, 0.02139100804924965, -0.021915363147854805, 0.016308795660734177, -0.001598275383003056, -0.0020033062901347876, 0.008880428038537502, 0.026580780744552612, -0.013848358765244484, 0.024886710569262505, 0.004329292569309473, -0.015865109860897064, -0.02269517444074154, 0.011455146595835686, 0.026527000591158867, 0.0028705091681331396, 0.0008772867731750011, -0.012013114988803864, -0.000989888678304851, -0.0015781078254804015, 0.020812872797250748, -0.039017412811517715, -0.008551024831831455, 0.017747411504387856, 0.01323661021888256, 0.048402030020952225, -0.012799647636711597, -0.01781463623046875, 0.020880097523331642, -0.024281684309244156, -0.009492175653576851, 0.0075964294373989105, 0.001815076102502644, 0.0032520112581551075, -0.017532290890812874, -0.04466431587934494, 0.015354199334979057, -0.0031679801177233458, 0.029390787705779076, 0.010366100817918777, -0.004016696009784937, 0.01735750585794449, -0.002917566802352667, 0.05028432980179787, 0.0225607231259346, 0.018083535134792328, -0.010077033191919327, -0.020490191876888275, 0.05480185151100159, -0.009915693663060665, 0.023219529539346695, -0.0009125799406319857, 0.015488649718463421, 0.014655059203505516, 0.05152127146720886, 0.019871722906827927, 0.015300419181585312, 0.019683491438627243, -0.011260194703936577, -0.007058629300445318, -0.008362795226275921, 0.038560282438993454, -0.00814767461270094, -0.04797178879380226, -0.05308089032769203, 0.03052016906440258, -0.021579237654805183, -0.0009201427455991507, -0.05334979295730591, 0.01899779587984085, -0.0007995578343980014, -0.03135376051068306, 0.011945889331400394, 0.023353978991508484, 0.02377077378332615, -0.00023843882081564516, -0.031649548560380936, 0.03541415184736252, -0.01099129393696785, -0.0605563148856163, 0.020638087764382362, 0.0029579016845673323, -0.003784769680351019, -0.021216223016381264, 0.0033595713321119547, -0.00915605016052723, -0.005112464539706707, -0.006719142664223909, 0.01015098113566637, -0.012087062001228333, 0.05560855194926262, -0.011455146595835686, 0.0041511463932693005, 0.006460326258093119, -0.022708619013428688, 0.03372007980942726, -0.0010554331820458174, 0.02340775914490223, -0.0010335850529372692, -0.026217766106128693, -0.0010150980670005083, -0.001778102363459766, 0.024859819561243057, 0.006087227258831263, 0.04243244603276253, 0.02551862597465515, 0.008060282096266747, -0.002798242261633277, 0.03396208956837654, -0.011582874692976475, 0.02539762109518051, 0.056737933307886124, -0.026150541380047798, -0.0029595824889838696, -0.02174057811498642, 0.03420409932732582, 0.018581001088023186, 0.007219969294965267, -0.0032066344283521175, -0.005062045529484749, 0.02698413096368313, 0.03958210349082947, 0.03065461851656437, 0.005633458495140076, -0.021565793082118034, 0.014749174006283283, 0.019387701526284218, -0.0048166741617023945, -0.013505510985851288, -0.01981794275343418, -0.0036772098392248154, 0.023098524659872055, 0.039151862263679504, 0.024873264133930206, -0.005761186126619577, 0.01383491326123476, -0.014211373403668404, 0.017438175156712532, 0.01550209429115057, -0.0017478510271757841, 0.02777738682925701, -0.0069712367840111256, 0.028557198122143745, -0.003226801985874772, -0.0008856899221427739, -0.018809566274285316, -0.01306854747235775, -0.013646683655679226, 0.004914150573313236, -0.010258541442453861, 0.013465175405144691, 0.005680515896528959, -0.011152634397149086, 0.024846374988555908, 0.047810450196266174, 0.05117170140147209, 0.003297388320788741, 0.009028322994709015, -0.0062351226806640625, -0.01971038244664669, -0.006944346707314253, -0.0010092159500345588, -0.00424190005287528, 0.009586290456354618, 0.043185364454984665, 0.0021646462846547365, -0.012470245361328125, -0.005162883084267378, 0.023837998509407043, 0.0166314747184515, 0.02424135059118271, -0.004776339046657085, -0.005203218199312687, 0.005535982083529234, -0.012960988096892834, -0.03240247070789337, 0.0046553341671824455, 0.022547278553247452, 0.025128720328211784, 0.014130703173577785, -0.020396078005433083, -0.0041040885262191296, -0.00968040619045496, 0.01781463623046875, 0.003754518460482359, -0.019428037106990814, 0.010157703422009945, 0.023716993629932404, -0.021175887435674667, -0.011676989495754242, 0.006863676477223635, -0.0031293255742639303, -0.008846815675497055, 0.018352435901761055, 0.0008113221847452223, 0.028530307114124298, 0.023918669670820236, -0.022762399166822433, -0.028906768187880516, 0.002714211121201515, -0.024443024769425392, -0.012927375733852386, -0.029847918078303337, -0.019549041986465454, 0.019764162600040436, 0.022533833980560303, 0.01758607104420662, -0.011394644156098366, -0.011777827516198158, 0.019293585792183876, -0.006725865416228771, 0.011737491935491562, -0.00240497593767941, -0.0026873210445046425, 0.07029050588607788, -0.037457793951034546, -0.022022923454642296, 0.007898942567408085, 0.004567941650748253, 0.029874807223677635, -0.0012234956957399845, -0.027992507442831993, -0.042459335178136826, -0.01864822581410408, -0.013996253721415997, 0.02635221555829048, -0.013639960438013077, -0.005546065978705883, 0.021767467260360718, -0.011945889331400394, -0.008430019952356815, 0.029283227398991585, 0.022627947852015495, 0.016591139137744904, 0.014117258600890636, -0.017048269510269165, 0.005623374599963427, -0.015851665288209915, 0.01735750585794449, -0.01819109544157982, -0.03813004121184349, 0.01491051446646452, 0.016201235353946686, 0.028073176741600037, -0.004803229123353958, -0.025612739846110344, -0.04415340721607208, 0.007146021816879511, 0.005529259797185659, -0.006342682521790266, -0.013781133107841015, 0.026217766106128693, -0.021901918575167656, -0.018675116822123528, 0.00617798138409853, -0.0009613180882297456, 0.005589762236922979, 0.008920762687921524, 0.015098744072020054, -0.0013327364576980472, 0.02278928831219673, 0.03958210349082947, -0.007152744103223085, 0.01971038244664669, 0.020947322249412537, 0.010224929079413414, 0.041168615221977234, -0.0024184207431972027, -0.01109885424375534, 0.003003278747200966, -0.012893762439489365, 0.009243442676961422, 0.0035427596885710955, 0.01109885424375534, -0.013559291139245033, 0.011085408739745617, -0.04504077881574631, 0.017290281131863594, 0.0024503527674824, -0.007979611866176128, -0.013888693414628506, 0.0207994282245636, -0.008766145445406437, 0.07023672014474869, -0.043185364454984665, 0.03156887739896774, -0.022735508158802986, 0.002667153486981988, -0.008934208191931248, 0.009841745719313622, -0.02686312608420849, 0.027279920876026154, -0.001546175917610526, 0.008954375050961971, 0.00891404040157795, 0.014251708984375, -0.016483580693602562, 0.01696760021150112, -0.006403184961527586, 0.006426713895052671, 0.022843068465590477, 0.0006415789830498397, -0.05523209273815155, 0.040200572460889816, 0.0020638087298721075, 0.004141062498092651, 0.03955521434545517, 0.00974090863019228, -0.022412829101085663, -0.013942473568022251, -0.0059326100163161755, -0.005314139649271965, -0.00915605016052723, -0.00035461210063658655, -0.006036808714270592, -0.014439938589930534, 0.029014326632022858, 0.031434427946805954, -0.004433491267263889, 0.006951068993657827, -0.018970906734466553, 0.005129270721226931, 0.011851774528622627, -0.008940930478274822, 0.0069309016689658165, -0.0011907235020771623, 0.012490412220358849, 0.025679966434836388, -0.023138858377933502, 0.027642937377095222, 0.017787745222449303, 0.03761913254857063, 0.006124201230704784, 0.0037511573173105717, -0.0034351996146142483, -0.009525788016617298, 0.016833150759339333, 0.015394533984363079, 0.0003630152205005288, 0.025007715448737144, -0.002697404706850648, 0.008994710631668568, -0.006157813593745232, -0.007226692046970129, -0.019777607172727585, 0.03374696895480156, 0.02576063573360443, -0.03552171215415001, -0.013209720142185688, 0.023663213476538658, 0.007690544705837965, -0.01437271386384964, -0.01875578612089157, 0.012960988096892834, -0.008275402709841728, 0.011434979736804962, -0.01204672735184431, 0.02032885141670704, -0.005747741088271141, -0.016940711066126823, 0.026580780744552612, -0.02065153233706951, 0.02777738682925701, 0.013821468688547611, 0.006188064813613892, 0.019549041986465454, -0.017559180036187172, 0.014883624389767647, 0.019683491438627243, -0.034284770488739014, 0.0031831057276576757, -0.01566343382000923, 0.017276834696531296, -0.00718635693192482, 0.021296892315149307, -0.021579237654805183, 0.0021680076606571674, 0.01996583677828312, 0.023004408925771713, -0.0006117478478699923, -0.015139078721404076, -0.011354309506714344, 0.00381838227622211, -0.0006995605654083192, 0.007381309289485216, 0.00045208839583210647, 0.016362575814127922, -0.007993057370185852, -0.0071930792182683945, -0.022493498399853706, -0.017007935792207718, 0.0025898446328938007, -0.020221292972564697, -0.0021243111696094275, -0.010157703422009945, 0.0043024024926126, 0.024053119122982025, 0.006645195186138153, 0.015071853995323181, 0.03318227827548981, 0.046976856887340546, 0.01210722979158163, 0.011031629517674446, 0.03347807005047798, 0.02590852975845337, -0.02008684165775776, 0.0067292265594005585, 0.009398060850799084, 0.016456689685583115, 0.020046507939696312, -0.007112409453839064, -0.01793564110994339, 0.029014326632022858, 0.0070317392237484455, 0.007885497063398361, -0.006067059934139252, 0.00044326510396786034, 0.025935420766472816, -0.0004957846831530333, -0.0015697047347202897, 0.00526035949587822, 0.008282124996185303, 0.011293807066977024, 0.02127000316977501, 0.004783061798661947, -0.009398060850799084, 0.020288517698645592, 0.016698699444532394, 0.011912276968359947, 0.025572406128048897, 0.013626515865325928, 0.014036588370800018, -0.013465175405144691, -0.012940820306539536, 0.00018917546549346298, -0.009653516113758087, 0.02744126133620739, -0.017962530255317688, 0.0007789701339788735, 0.0166314747184515, 0.013088715262711048, 0.023918669670820236, 0.009492175653576851, 0.022950628772377968, -0.012833259999752045, -0.03347807005047798, -0.009169495664536953, -0.0050486004911363125, 0.008940930478274822, 0.004974653013050556, -0.021780913695693016, -0.004470465239137411, -0.0009352683555334806, 0.0051191868260502815, -0.02492704428732395, 0.03396208956837654, 0.011078686453402042, -0.015649989247322083, -0.01817765086889267, 0.043884508311748505, 0.004648611415177584, 0.0044536590576171875, -0.021229667589068413, 0.017411286011338234, 0.017196165397763252, 0.010144258849322796, -0.019091911613941193, -0.04216354712843895, 0.030439497902989388, -0.01091734692454338, -0.012577804736793041, -0.021283447742462158, -0.001512563438154757, 0.037834253162145615, -0.026419440284371376, 0.0029158862307667732, -0.0030654617585241795, -0.02030196227133274, -0.025935420766472816, 0.01675247959792614, -0.03089662827551365, 0.022291824221611023, -0.013055102899670601, -0.03726956248283386, -0.01711549609899521, 0.030950408428907394, 0.018554111942648888, -0.002719252835959196, 0.0005525057786144316, 0.020812872797250748, 0.024039674550294876, 0.001784824882633984, 0.005801520776003599, -0.02828829735517502, 0.022251488640904427, -0.012234956957399845, -0.0071930792182683945, 0.0008840092923492193, 0.020570863038301468, -0.009371170774102211, -0.02101454697549343, -0.016765926033258438, 0.009014877490699291, 0.022587614133954048, -0.03264448046684265, 0.0012218151241540909, 0.0003945269563701004, -0.011966057121753693, -0.017411286011338234, 0.0303050484508276, 0.0213775634765625, -0.03302093967795372, -0.012053449638187885, 0.028691647574305534, -0.023004408925771713, -0.011616487056016922, 0.016470134258270264, 0.026459775865077972, 0.04705752804875374, 0.03218735009431839, -0.016806259751319885, 0.01342484075576067, -0.00718635693192482, -0.005455311853438616, 0.021807802841067314, -0.008080449886620045, 0.007105686701834202, 0.017034824937582016, 0.025021160021424294, 0.013498787768185139, -0.01591889001429081, -0.018365880474448204, -0.040684595704078674, 0.009626626037061214, -0.012409742921590805, 0.0043830727227032185, 0.009915693663060665, -0.006225038785487413, 0.044583648443222046, 0.003993167541921139, 0.012087062001228333, 0.020974213257431984, 0.017182720825076103, -0.006174619775265455, 0.0219825878739357, 0.010218205861747265, 0.01866167038679123, 0.030977299436926842, -0.01948181726038456, 0.026459775865077972, -0.008981265127658844, 0.004762894008308649, 0.02459092065691948, -0.020638087764382362, 0.01781463623046875, 0.0001777262077666819, -0.003660403424873948, 0.02199603244662285, 0.0072334143333137035, 0.006477132439613342, 0.030439497902989388, 0.011670267209410667, -0.015878554433584213, 0.00996947381645441, 0.015730660408735275, 0.031649548560380936, -0.037215784192085266, -0.002129353117197752, -0.006789728999137878, 0.00345872831530869, -0.019522150978446007, -0.019549041986465454, 0.0036435972433537245, -0.025800971314311028, -0.02804628759622574, 0.005707405973225832, -0.02576063573360443, 0.02377077378332615, -0.029552128165960312, 0.004137701354920864, -0.02576063573360443, -0.009727463126182556, -0.012510580010712147, -0.007273749448359013, 0.024913599714636803, 0.03027815744280815, 0.0219825878739357, -0.01175765972584486, -0.013512233272194862, -0.03113863803446293, -0.007354419678449631, -0.013075270690023899, 0.02030196227133274, -0.002621776657178998, -0.017760856077075005, -0.014816398732364178, 0.014507163316011429, -0.016120564192533493, 0.00909554772078991, -0.008470355533063412, 0.016416354104876518, 0.03861406445503235, -0.02222459763288498]",Model Alignment as Prospect Theoretic Optimization.pdf
" as vf(qθA) = min( qθA, A(1 +sign (qθA)ϵ)). This completes the construction.
Proposition 4.1 (restated) As the reward rθ(x, y)implied by the current policy tends to ±∞, the KTO update of πθtends
to zero.
Proof. Where d(y)is -1(+1) when yis desirable(undesirable), λyisλD(λU)when yis desirable(undesirable), and
z=rθ(x, y)−z0, the derivative of the KTO loss is
∇θLKTO(πθ, πref) =Ex,y∼D[d(y)λyσ(βz)(1−σ(βz))β∇θlogπθ(y|x)] (9)
Note that we do not backpropagate through the KL term in the KTO loss and β, λy>0. This gradient is simple to interpret:
ifyis desirable, then d(y)is negative and we push up the probability of πθ(y|x)to minimize the loss; if yis undesirable,
thend(y)is positive and we push down the probability of πθ(y|x)to minimize the loss. As rθtends to ±∞, the gradient
will tend to zero since either (1−σ(βz))orσ(βz)will tend to zero.
Theorem 4.2 (restated) Assuming the value function is logistic, for a reward function r∗
athat maximizes (2), there exists
a reward function in its equivalence class (i.e., r∗
b(x, y) =r∗
a(x, y) +h(x)for some h(x)) that induces the same optimal
policy π∗and the same Bradley-Terry preference distribution but a different human value distribution.
Proof. Following the definition in Rafailov et al. (2023), we say r∗
aandr∗
bare in the same equivalence class if there exists
some function h(x)such that r∗
b(x, y) =r∗
a(x, y) +h(x). From Lemma 1 in Rafailov et al. (2023), we know that two
functions in the same equivalence class induce the same optimal policy:
π∗
ra(y|x) =1
Z(x)πref(y|x) exp1
βr∗
a(x, y)
=1
P
yπref(y|x) exp
1
βr∗a(x, y)
exp
1
βh(x)πref(y|x) exp1
βr∗
a(x, y)
exp1
βh(x)
=1
P
yπref(y|x) exp
1
β(r∗a(x, y) +h(x))πref(y|x) exp1
β(r∗
a(x, y) +h(x))
=π∗
rb(y|x)
For a Bradley-Terry model of preferences, it is trivial to show that p(yw≻yl|x)is unaffected by h(x)since it is added to the
reward of both ywandyl. We will now show that the two reward functions do not necessarily induce the same distribution
of human values.
A Taylor series expansion of the human value of r∗
a(x, y)would be:
σ(0) + σ′(0)(r∗
a(x, y)−EQ[r∗
a(x, y)]) +σ′′(0)
2(r∗
a(x, y)−EQ[r∗
a(x, y)])2+...
14
Model Alignment as Prospect Theoretic Optimization
Choosing h(x)such that EQ[h(x)] = 0 , a Taylor series expansion of the value of r∗
a(x, y) +h(x)would be:
σ(h(x)) +σ′(h(x))(r∗
a(x, y)−EQ[r∗
a(x, y)]) +σ′′(h(x))
2(r∗
a(x, y)−EQ[r∗
a(x, y)])2+...
Since σis strictly monotonic, for these series to be equal, we must have h(x) = 0 . If this is not the case, then the values of
r∗
a(x, y)andr∗
b(x, y)will be different. Thus two arbitrary reward functions in the same equivalence class","[-0.018432792276144028, -0.04268356412649155, 0.018391432240605354, -0.005649092607200146, 0.012056452222168446, -0.005969632882624865, -0.0007979041547514498, 0.03088216483592987, 0.007699861191213131, 0.015454869717359543, 0.027725014835596085, -0.022651517763733864, -0.019563300535082817, -0.005001118406653404, 0.03879572078585625, -0.06534887105226517, 0.02862115018069744, -0.02531234733760357, 0.0174125786870718, 0.034687288105487823, -0.03860270604491234, -0.0236855186522007, -0.0035190503112971783, 0.028235122561454773, 0.00541816558688879, -0.013324826955795288, -0.004870145116001368, 0.019384073093533516, -0.014048627577722073, -0.03719646483659744, 0.03250899538397789, -0.019935540854930878, 0.0028073128778487444, -0.05955846235156059, -0.025960320606827736, 0.03703102469444275, 0.026470428332686424, 0.04604751616716385, 0.015179135836660862, 0.02216898277401924, 0.0020387053955346346, -0.02374066412448883, -0.033860087394714355, 0.04298686981201172, -0.01212538592517376, 0.014917189255356789, 0.011608385480940342, -0.010388264432549477, -0.01080186478793621, 0.027214908972382545, -0.059668757021427155, 0.017054123803973198, -0.009843690320849419, -0.004908058326691389, -0.0051424321718513966, -0.000311923649860546, -0.011112065054476261, -0.019949328154325485, 0.035486917942762375, -0.014117561280727386, 0.020445648580789566, -0.025794880464673042, 0.014241641387343407, 0.01640615053474903, -0.016185563057661057, -0.0019111786969006062, -0.054402243345975876, 0.030964884907007217, 0.0037982305511832237, 0.049080584198236465, -0.005773172713816166, -0.0010555427288636565, 0.05944816768169403, 0.02499525249004364, -0.011346438899636269, -0.011201678775250912, 0.04869455844163895, 0.030110111460089684, 0.04061556234955788, -0.0390714555978775, 0.01400037482380867, -0.017081698402762413, 0.06319814920425415, 0.00631085317581892, -0.025450212880969048, -0.06264667958021164, -0.057297445833683014, -0.042821429669857025, -0.03521118313074112, -0.006479740142822266, -0.015441082417964935, 0.00357764377258718, 0.0022661855909973383, 0.012070239521563053, 0.057352595031261444, -0.0006440965225920081, -0.001069329446181655, -0.0028073128778487444, 0.011856545694172382, -0.01999068818986416, -0.01760559156537056, -0.07345543801784515, -0.0024540291633456945, 0.007534421049058437, 0.06590033322572708, 0.020900608971714973, -0.021341782063245773, 0.0636393204331398, -0.02975165843963623, -0.007734328042715788, -0.05994448810815811, -0.022568797692656517, -0.013083560392260551, 0.01465524174273014, -0.020266421139240265, -0.060109928250312805, -0.0887310802936554, -0.00865114200860262, -0.007713648024946451, -0.018267352133989334, 0.0006949349190108478, -0.02667722851037979, 0.03796852007508278, -0.007679181173443794, -0.008320261724293232, -0.02806968241930008, 0.007741221226751804, -0.046323247253894806, -0.033860087394714355, -0.0318196602165699, 0.013124920427799225, 0.04954933002591133, -0.0078032612800598145, -0.0404776968061924, -0.05531216412782669, 0.006627947092056274, -0.002290312433615327, -0.0019594321493059397, 0.020390501245856285, -0.021148769184947014, -0.02594653330743313, -0.05117616057395935, -0.10533024370670319, -0.017619378864765167, -0.07224220782518387, 0.02274802327156067, -0.005032138433307409, -0.004091197624802589, -0.01635100319981575, 0.0005734397564083338, 0.015303215943276882, -0.004942525178194046, 0.00356385693885386, 0.016309643164277077, -0.0016811133828014135, -0.052720267325639725, -0.012159852311015129, 0.038492415100336075, 0.001814671908505261, -0.015110202133655548, -0.005249278619885445, 0.0404776968061924, -0.02425077185034752, 0.0029917098581790924, 0.025339920073747635, -0.0018508619396016002, -0.012904333882033825, 0.03283987566828728, -0.051589760929346085, -0.027159761637449265, -0.027297629043459892, -0.002621192717924714, -0.06049595773220062, -0.016516443341970444, -0.0018095019040629268, 0.004670238122344017, -0.016888683661818504, -0.04072585701942444, 0.022651517763733864, -0.02329949103295803, 0.027270054444670677, 0.002174848923459649, 0.015689242631196976, -0.017950259149074554, 0.004273870959877968, 0.0005738706095144153, -0.03201267495751381, -0.03590051829814911, 0.008016955107450485, 0.005321658682078123, 0.032288406044244766, 0.03998137637972832, 0.06882311403751373, -0.020817888900637627, -0.005159665364772081, -0.029034750536084175, 0.012242572382092476, 0.07395175844430923, -0.0010340011212974787, 0.02562944032251835, 0.05385077744722366, -0.0012089195661246777, 0.05608421936631203, -0.028731442987918854, -0.012104705907404423, 0.03714131936430931, 0.02262394316494465, 0.014696601778268814, -0.07003633677959442, -0.026539361104369164, 0.006441826932132244, -0.021948397159576416, 0.013407547026872635, 0.04127732291817665, -0.03565235808491707, 0.019122127443552017, -0.01905319280922413, 0.03187480568885803, 0.006579693406820297, 0.09937439858913422, -0.020941969007253647, 0.059723902493715286, 0.030413419008255005, 0.02398882433772087, -0.05627723038196564, 0.024912532418966293, 0.03038584440946579, -0.038437265902757645, 0.009161249734461308, -0.015165349468588829, 0.050404105335474014, 0.026966748759150505, -0.0027245928067713976, -0.03890601545572281, 0.019521940499544144, -0.014145134948194027, -0.017205778509378433, 0.005697345826774836, 0.022100050002336502, -0.06038566306233406, -0.016116630285978317, 0.023216770961880684, -0.002703912789002061, -0.005845552776008844, 0.0062901731580495834, 0.022651517763733864, -0.023602798581123352, -0.005880019627511501, -0.0022489523980766535, -0.03515603765845299, 0.02999981865286827, -0.011856545694172382, -0.0022748024202883244, 0.017895111814141273, -0.05420922860503197, 0.020721381530165672, 0.013579880818724632, 0.002886586356908083, -0.025794880464673042, 0.0028435029089450836, 0.009099209681153297, -0.004301444627344608, -0.007458594627678394, 0.01596497744321823, -0.030551284551620483, -0.01571681722998619, -0.02004583366215229, -0.029531070962548256, 0.01640615053474903, 0.01566166989505291, 0.035983238369226456, 0.017509084194898605, -0.031295765191316605, 0.02354765124619007, -0.048639409244060516, -0.059117287397384644, 0.0390714555978775, 0.039760787039995193, -0.022941038012504578, -0.01992175355553627, -0.041883938014507294, -0.003760317340493202, 0.04742618277668953, -0.04141518846154213, 0.025712160393595695, -0.03488030284643173, -0.0011649745283648372, 0.02356143854558468, -0.05624965950846672, -0.03929204121232033, -0.018322499468922615, -0.02900717779994011, 0.028179975226521492, -0.059172436594963074, 0.030909739434719086, 0.034990597516298294, 0.015234282240271568, -0.04191150888800621, 0.0019215187057852745, 0.025257200002670288, 0.043124739080667496, 0.008154821582138538, -0.022100050002336502, 0.04033982753753662, -0.013276574201881886, -0.023478718474507332, 0.0374721996486187, 0.014875829219818115, -0.0006940732127986848, 0.02455407939851284, 0.007644714787602425, 0.0005286330706439912, -0.03816153481602669, 0.0037568705156445503, -0.023782024160027504, -0.048584263771772385, 0.051700055599212646, -0.010919051244854927, -0.012111599557101727, -0.01942543312907219, -0.005325105506926775, -0.05569818988442421, -0.0141864949837327, 0.0025798326823860407, 0.02787666954100132, 0.0018077786080539227, -0.029779231175780296, -0.0026056827045977116, 0.0033742901869118214, -0.007341407705098391, 0.0033760135993361473, -0.007630927953869104, 0.006455613300204277, 0.013766000978648663, -0.014793109148740768, 0.0035604103468358517, -0.04067070782184601, 0.058841556310653687, 0.013703960925340652, 0.006379786878824234, -0.05081770569086075, -0.01647508330643177, -0.011215465143322945, -0.03876814618706703, -0.02361658401787281, -0.002378202509135008, 0.04320745915174484, 0.008306475356221199, 0.010188356973230839, 0.07262823730707169, -0.014448441565036774, -0.031240619719028473, 0.026222268119454384, 0.01443465519696474, -0.021162554621696472, 0.009243969805538654, 0.0010857011657208204, -0.04141518846154213, -0.07544071972370148, 0.013924547471106052, 0.0184741523116827, -0.004491011146456003, 0.01409688126295805, -0.026511788368225098, -0.0016793900867924094, 0.0024919426068663597, 0.00032204826129600406, 0.01551001612097025, -0.012359759770333767, 0.008947555907070637, -0.025725947692990303, 0.015565162524580956, -0.05291328206658363, 0.015234282240271568, -0.012876760214567184, -0.03692073002457619, 0.014351935125887394, 0.012787146493792534, 0.05840038135647774, -0.031240619719028473, -0.014393295161426067, 0.0006604681839235127, -0.002504006028175354, -0.03672771900892258, 0.00027120986487716436, 0.00876832939684391, -0.016819750890135765, -0.025395067408680916, -0.012656173668801785, 0.0036431304179131985, 0.008933769538998604, -0.012139172293245792, -0.04403465986251831, 0.03956777602434158, -0.009223289787769318, -0.0009331859764643013, -0.014669029042124748, 0.06374961137771606, 0.05156218633055687, 0.07709512114524841, -0.052720267325639725, 0.012800933793187141, -0.04447583481669426, -0.03250899538397789, -0.0443655401468277, -0.003276060102507472, -0.013786680996418, 0.07047751545906067, -0.016695670783519745, 0.05955846235156059, 0.07510983943939209, -0.03212296590209007, 0.007885981351137161, -0.0399538017809391, 0.01092594489455223, -0.027297629043459892, 0.03537662327289581, 0.03733433410525322, 0.04276628419756889, 0.03452184796333313, -0.01992175355553627, -0.014972335658967495, 0.016819750890135765, -0.014999909326434135, -0.012669960036873817, 0.0014346764655783772, 0.04670927673578262, 0.005152772180736065, 0.026401493698358536, -0.04778463765978813, -0.006834747269749641, 0.03802366554737091, 0.015992550179362297, -0.023961251601576805, -0.043758925050497055, 0.015813322737812996, 0.04392436519265175, -0.010312437079846859, 0.014476015232503414, -0.017771031707525253, 0.0395953468978405, 0.0012580346083268523, -0.02667722851037979, 0.032095395028591156, -0.004008477553725243, 0.03840969502925873, 0.01635100319981575, -0.018088124692440033, 0.014917189255356789, 0.0327020063996315, -0.045633915811777115, 0.04271113872528076, 0.012925013899803162, -0.02494010515511036, -0.019577087834477425, -0.015055055730044842, 0.06005478277802467, 0.02550536021590233, -0.019122127443552017, 0.012228786014020443, -0.008540849201381207, -0.028179975226521492, -0.0011270612012594938, -0.034301262348890305, 0.0028969263657927513, 0.005924826022237539, 0.03300531581044197, -0.0009857476688921452, -0.062426090240478516, -0.013304146938025951, 0.01350405439734459, -0.04836367815732956, 0.032233260571956635, -0.03137848526239395, -0.004063624422997236, 0.02016991376876831, 0.05216880142688751, 0.0037258504889905453, 0.015896042808890343, -0.012242572382092476, 0.023092690855264664, -0.03107517957687378, -0.039374761283397675, -0.005876572802662849, 0.0219208225607872, 0.030661579221487045, 0.061543744057416916, -0.03363950178027153, -0.0404776968061924, -0.007231114432215691, 0.01615799032151699, -0.048143088817596436, 0.025781093165278435, -0.016626738011837006, -0.010188356973230839, -0.011325758881866932, 0.051203735172748566, -0.011353331618010998, -0.00889240950345993, -0.0047288318164646626, 0.01854308694601059, -0.007224220782518387, -0.004804658237844706, 0.022761810570955276, 0.015082629397511482, 0.01659916341304779, 0.03840969502925873, -0.009292223490774632, -0.037058599293231964, 0.05318901687860489, -0.05669083073735237, -0.031213045120239258, -0.035431768745183945, 0.030220404267311096, -0.018901539966464043, 0.014820681884884834, -0.03796852007508278, -0.01528942957520485, -0.012318399734795094, 0.030992459505796432, -0.029724083840847015, -0.05561546981334686, -0.039374761283397675, 0.008092781528830528, 0.006045459769666195, 0.01792268455028534, -0.023395998403429985, -0.0887310802936554, -0.03352920711040497, -0.029779231175780296, 0.05092800036072731, -0.00721732759848237, 0.028345415368676186, 0.0035500703379511833, 0.021452074870467186, 0.006338426843285561, -0.015992550179362297, -0.015578949823975563, -0.00044806714868173003, 0.00024406734155490994, -0.00905095599591732, -0.030523711815476418, 0.017067911103367805, 0.03931961581110954, 0.017771031707525253, -0.020473221316933632, 0.0005204472108744085, -0.0057972995564341545, -0.0020059621892869473, 0.013359294272959232, 0.014572521671652794, -0.003843037411570549, -0.03278472647070885, 0.004073964431881905, -0.0507349856197834, 0.0031985100358724594, -0.02022506110370159, 0.028731442987918854, 0.02098332904279232, 0.0063866800628602505, -0.01080186478793621, -0.0007535282638855278, 0.0066245002672076225, 0.0019146252889186144, -0.00267806276679039, 0.05718715116381645, 0.014227855019271374, 0.010953518562018871, 0.023313278332352638, 0.01406930759549141, -0.013373080641031265, 0.008995809592306614, 0.005476759281009436, -0.02167266234755516, 0.004242850933223963, 0.009533490054309368, 0.03540419787168503, -0.032095395028591156, 0.02999981865286827, -0.010071170516312122, -0.05136917531490326, -0.01021593064069748, -0.033667076379060745, -0.020831674337387085, -0.04033982753753662, 0.017509084194898605, -0.009126782417297363, -0.01672324351966381, -0.062040064483881, 0.018391432240605354, 0.025712160393595695, -0.031240619719028473, -0.020969541743397713, 0.003911970648914576, -0.043124739080667496, 0.01848793961107731, -0.04775706306099892, 0.016626738011837006, -0.007041547447443008, -0.004746065009385347, 0.02794560231268406, -0.011001771315932274, -0.003746530506759882, -0.019963113591074944, -0.050955574959516525, 0.0387130007147789, -0.015551376156508923, -0.008947555907070637, 0.012966373935341835, 0.014806895516812801, 0.04108430817723274, -0.040119241923093796, 0.02223791740834713, 0.009843690320849419, -0.022706663236021996, -0.02586381323635578, -0.01375221461057663, -0.0041532376781105995, 0.053768057376146317, 0.009133676066994667, -0.005556032527238131, -0.004759851843118668, 0.04442068561911583, -0.02549157291650772, -0.005263065453618765, 0.03733433410525322, -0.001488099922426045, -0.014351935125887394, 0.044944580644369125, -0.027021894231438637, 0.001335584674961865, -0.013235214166343212, -0.008327155373990536, 0.020390501245856285, 0.01755044423043728, -0.015027482062578201, 0.004522031173110008, -7.706539327045903e-05, 0.017839964479207993, -0.028221335262060165, 0.012173639610409737, 0.021217701956629753, -0.0034053102135658264, -0.031240619719028473, 0.007086353842169046, 0.004608198069036007, -0.008975129574537277, 0.049962930381298065, -0.021962182596325874, -0.036121103912591934, -0.01873609982430935, -0.019742527976632118, 0.010877691209316254, -0.014875829219818115, 0.03545934334397316, 0.016378577798604965, 0.012704426422715187, -0.012180532328784466, -0.0006410806672647595, -0.03683800995349884, -0.022320637479424477, -0.024609224870800972, -0.010987984947860241, -0.0041877045296132565, 0.029861951246857643, 0.05230666697025299, 0.014379508793354034, 0.054043788462877274, -0.007913555018603802, -0.018212204799056053, -0.03576264902949333, 0.001489823218435049, 0.010539917275309563, -0.017646951600909233, 0.0011158594861626625, -0.0006768398452550173, -0.015634097158908844, -0.028111042454838753, -0.03490787744522095, -0.0013528181007131934, -0.0021782955154776573, -0.014889615587890148, -0.022389570251107216, -0.05172762647271156, -0.018970472738146782, -0.0018973919795826077, 0.03945748135447502, -0.018970472738146782, 0.00038667331682518125, 0.005514672491699457, -0.04604751616716385, 0.019397860392928123, 0.016998978331685066, -0.04017438739538193, -0.010195250622928143, 0.02343735843896866, 0.007465487811714411, 0.04585450142621994, -0.016998978331685066, -0.05680112540721893, -0.013414440676569939, 0.05431952327489853, -0.029834378510713577, -0.011380905285477638, -0.04692986235022545, -0.016557803377509117, -0.005476759281009436, 0.04475156590342522, 0.023947464302182198, -0.028428135439753532, -0.020900608971714973, 0.009347369894385338, 0.00226273899897933, 0.03347406163811684, 0.022100050002336502, 0.010608850978314877, 0.03581779822707176, 0.018970472738146782, 0.010967304930090904, -0.014627669006586075, -0.02749064192175865, -0.005204472225159407, -0.05018351972103119, 0.02123148925602436, -0.024043971672654152, 0.01234597247093916, -0.034356407821178436, 0.010229717008769512, -0.025974107906222343, 0.009223289787769318, -0.02016991376876831, -0.008409875445067883, -0.018694739788770676, -0.012738893739879131, -0.009843690320849419, 0.026897814124822617, 0.03237112611532211, 0.021838102489709854, -0.00732762087136507, -8.277394226752222e-05, 0.02669101394712925, -0.0023489058949053288, -0.03821668028831482, -0.006193666253238916, 0.021217701956629753, 0.01641993783414364, 0.016006337478756905, 0.03019283153116703, 0.0017784818774089217, 0.02655314840376377, 0.01293190661817789, 0.012394226156175137, -0.00510796532034874, 0.007162180729210377, 0.03449427708983421, -0.00130456464830786, 0.018749887123703957, -0.01686111092567444, -0.01748151145875454, -0.005032138433307409, -0.0063211931847035885, 0.00048425717977806926, -0.03501816838979721, 0.017205778509378433, 0.01684732362627983, -0.04968719929456711, -0.005531905684620142, -0.005114858504384756, 0.05230666697025299, -0.0125941326841712, -0.006548673380166292, 0.0050459252670407295, -0.0014260598691180348, 0.0103400107473135, 0.05396106839179993, 0.002412669127807021, 0.015248069539666176, -0.038189105689525604, 0.001336446381174028, -0.005476759281009436, -0.026208480820059776, 0.0013562646927312016, -0.000876746722497046, -0.03300531581044197, -0.02906232327222824, -0.0012373545905575156, 0.010705357417464256, -0.022251702845096588, 0.003942990675568581, -0.039871081709861755, -0.020845461636781693, -0.010022916831076145, -0.035238757729530334, -0.026167120784521103, 0.012442479841411114, 0.038740575313568115, -0.036231398582458496, -0.13334478437900543, -0.015482442453503609, 0.018239779397845268, -0.019246207550168037, 0.02310647815465927, 0.008844155818223953, 0.04367620497941971, -0.023975038900971413, -0.006758920382708311, -0.024512719362974167, 0.01190479937940836, -0.0335843563079834, -0.0020059621892869473, -0.009919516742229462, 0.008044528774917126, -0.0353490486741066, -0.045826926827430725, -0.016957618296146393, 0.005535352509468794, -0.027890454977750778, -0.026911601424217224, 0.005904146004468203, 0.001816395204514265, 0.03438398241996765, -0.05511914938688278, 0.0073758745566010475, 0.03388766199350357, -0.007513741031289101, 0.003539730329066515, -0.016750818118453026, -0.012725106440484524, -0.015179135836660862, 0.01541350968182087, 0.034108247607946396, -0.022196557372808456, 0.01228393241763115, 0.0034053102135658264, -0.0009495576377958059, 0.00836851540952921, 0.042325109243392944, 0.010126316919922829, -0.050211090594530106, 0.048639409244060516, -4.469900522963144e-05, 0.031240619719028473, -0.04315230995416641, 0.020473221316933632, -0.028731442987918854, 0.0032226366456598043, -0.009767863899469376, 0.018529299646615982, -0.034108247607946396, -0.02543642744421959, -0.040119241923093796, 0.006772707216441631, -0.004945972003042698, 0.0026056827045977116, 0.016695670783519745, 0.0020111321937292814, -0.01608905754983425, -0.021769169718027115, 0.02243093028664589, 0.02900717779994011, -0.012118492275476456, -0.023134050890803337, -0.025725947692990303, 0.003005496459081769, 0.018680952489376068, -0.016185563057661057, -0.024719519540667534, -0.0012442480074241757, 0.0015699582872912288, -0.020404288545250893, 0.025974107906222343, -0.019742527976632118, -0.014021054841578007, 0.0028745229355990887, 0.018460365012288094, -0.017757244408130646, 0.013676387257874012, 0.04731588810682297, -0.05194821581244469, -0.0034621802624315023, 0.02856600284576416, -0.0039016306400299072, 0.02851085551083088, 0.01428300142288208, 0.0003164474037475884, -0.024347279220819473, -0.010071170516312122, 0.047398608177900314, -0.006645180284976959, 0.016171777620911598, -0.03093731217086315, 0.0032898467034101486, -0.02335463836789131, -0.03438398241996765, -0.000819015025626868, 0.012938800267875195, -0.004584071226418018, 0.0030089430510997772, 0.02964136376976967, -0.021010901778936386, 0.00048425717977806926, -0.02405775897204876, -0.008085888810455799, 0.001666465075686574, 0.015261855907738209, 0.04464127495884895, 0.0030261764768511057, -0.013435120694339275, -0.0032415934838354588, -0.026153333485126495, -0.0038947374559938908, -0.007844621315598488, 0.016833538189530373, 0.04116702824831009, 0.022389570251107216, -0.006090266164392233, -0.019259992986917496, 0.027173548936843872, 0.025670800358057022, 0.0057318126782774925, -0.003095109947025776, -0.003929204307496548, 0.007444807793945074, -0.015275642275810242, 0.014200281351804733, -0.008230648934841156, 0.030716724693775177, 0.025257200002670288, -0.013207640498876572, -0.00036685497616417706, -0.036479558795690536, 0.0038189105689525604, 0.02324434369802475, 0.023699304088950157, -0.015055055730044842, -0.02374066412448883, 0.004356591030955315, 0.018680952489376068, -0.005780065897852182, 0.0035948771983385086, 0.02925533801317215, -0.004945972003042698, -0.0006316023063845932, 0.0023644159082323313, -0.007555101066827774, -0.015027482062578201, 0.006820960436016321, 0.02374066412448883, -0.020845461636781693, 0.007624034769833088, 0.012049559503793716, 0.004036050755530596, 0.018901539966464043, 0.019563300535082817, -0.014296787790954113, 0.0021317654754966497, 0.018901539966464043, -0.006117839831858873, 0.06374961137771606, 0.005500885657966137, -0.015758177265524864, 0.033115606755018234, -0.04734346270561218, -0.01369017455726862, -0.00021164710051380098, 0.02469194494187832, -0.0043945047073066235, -0.025643227621912956, -0.03978836163878441, -0.022637730464339256, 0.0012416630052030087, 0.04221481829881668, -0.010450304485857487, -0.011291291564702988, 0.0006617606850340962, 0.015082629397511482, 0.0288141630589962, 0.03901630640029907, 0.027600934728980064, -0.038492415100336075, -0.03515603765845299, 0.03319832682609558, -0.015937402844429016, 0.0005536213866434991, -0.0076585011556744576, 0.026966748759150505, 0.016185563057661057, 0.04841882362961769, 0.01953572779893875, 0.013469587080180645, 0.04298686981201172, 0.0037947839591652155, -0.0357075035572052, -0.000551036384422332, 0.019466793164610863, 0.00920950248837471, -0.023768238723278046, -0.048391249030828476, 0.03339134156703949, 0.013469587080180645, -0.004804658237844706, -0.013869401067495346, 0.02237578295171261, -0.01108449138700962, -0.0321781150996685, 0.022513650357723236, -0.0109604112803936, 0.02925533801317215, 0.008120355196297169, -0.026773734018206596, 0.006500420160591602, -0.0025625992566347122, -0.04078100249171257, -0.014269215054810047, -0.02204490266740322, -0.015151562169194221, 0.006476293317973614, -0.014476015232503414, -0.05583605915307999, 0.007665394805371761, 0.009037169627845287, -0.0007281090947799385, -0.03237112611532211, 0.02299618348479271, 0.013414440676569939, 0.005807639565318823, -0.007162180729210377, -0.019135912880301476, 0.049576904624700546, -0.0318196602165699, -0.015647882595658302, -0.0054285055957734585, -0.015578949823975563, -0.003867164021357894, 0.024471359327435493, -0.006776153575628996, 0.016640523448586464, 0.01953572779893875, 0.02135556936264038, -0.0031761066056787968, 0.002352352486923337, 0.02681509405374527, -0.00038064163527451456, 0.030551284551620483, 0.0687679648399353, -0.028042109683156013, -0.007637821137905121, -0.014862041920423508, 0.05806950107216835, -0.00089268758893013, 0.009099209681153297, 0.013531627133488655, -0.019342713057994843, 0.03275715559720993, 0.01790889911353588, 0.02149343490600586, -0.019259992986917496, -0.0251882653683424, 0.0005872264737263322, -0.006500420160591602, -0.04072585701942444, -0.025229625403881073, -0.03151635453104973, 0.015330789610743523, 0.024843599647283554, 0.007630927953869104, -0.0014036564389243722, -0.02010098099708557, 0.028676297515630722, -0.007506847847253084, 0.045440901070833206, 0.012387332506477833, 0.011697999201714993, 0.03565235808491707, -0.0038947374559938908, 0.034411557018756866, 0.006093712989240885, -0.016461297869682312, -0.013104240410029888, -0.013076666742563248, 0.0003390661731828004, 0.001543246558867395, 0.009388729929924011, 0.039236895740032196, 0.01083633117377758, 0.008451235480606556, 0.008761435747146606, 0.03551448881626129, 0.029724083840847015, -0.003251933492720127, 0.001666465075686574, -0.005869679618626833, -0.037747934460639954, -0.015937402844429016, 0.0006906265625730157, -0.005328552331775427, -0.013021520338952541, 0.04108430817723274, 0.00016177807992789894, -0.009057849645614624, -0.005921379663050175, 0.010519237257540226, 0.04527546092867851, 0.01836385950446129, 0.01062263734638691, -0.009926410391926765, -0.029586218297481537, -0.012511412613093853, -0.027035681530833244, -0.006383233238011599, 0.030220404267311096, 0.015179135836660862, 0.02034914121031761, -0.025601867586374283, 0.008078995160758495, -0.002566046081483364, 0.007817048579454422, -0.014751749113202095, -0.02568458765745163, 0.0005105380550958216, 0.03192995488643646, -0.028345415368676186, 0.015813322737812996, 0.027104614302515984, -0.006276386324316263, -0.011098278686404228, 0.019204847514629364, -0.010994878597557545, 0.04566148668527603, 0.037003450095653534, -0.013118026778101921, -0.025987893342971802, -0.003183000022545457, -0.0318196602165699, -0.0046978117898106575, -0.01859823241829872, -0.023037543520331383, 0.022458503022789955, 0.006162646226584911, 0.020969541743397713, -0.015399722382426262, -0.008637355640530586, 0.004060177598148584, 0.0038464840035885572, 0.022720450535416603, -0.006093712989240885, -0.010050490498542786, 0.07786717265844345, -0.02329949103295803, -0.011422265321016312, 0.018336284905672073, -0.02054215408861637, 0.015344575978815556, 0.005445738788694143, 0.0013183513656258583, -0.028028322383761406, 0.0001236492971656844, -0.014544948935508728, 0.01068467739969492, 0.02436106465756893, -0.004832231905311346, 0.02043186128139496, 0.015937402844429016, -0.004404844716191292, 0.016888683661818504, 0.028455710038542747, 0.01985282078385353, 0.007410340942442417, -0.03424611687660217, -0.0017466001445427537, -0.005063158459961414, 0.020280208438634872, 0.0058110859245061874, -0.023009970784187317, -0.015096415765583515, 0.01350405439734459, 0.010732931084930897, -0.006555567029863596, -0.022541223093867302, -0.044944580644369125, 0.0011735912412405014, -0.00867871567606926, -0.014903401955962181, -0.02444378472864628, 0.016516443341970444, -0.01413134764879942, -0.017260923981666565, 0.008092781528830528, -0.026787521317601204, -0.01415892131626606, 0.005976526066660881, 0.024319704622030258, 0.012366652488708496, 0.02674616128206253, 0.010643317364156246, 0.014834469184279442, 0.007865301333367825, -0.016557803377509117, -0.004849465098232031, 0.02374066412448883, -0.019811460748314857, 0.003836143994703889, 0.00042178627336397767, -0.005793852731585503, 0.00021746335551142693, 0.013145600445568562, 0.02255501039326191, -0.01184275932610035, -0.002650489332154393, -0.026828881353139877, -0.009809223935008049, 0.024085331708192825, -0.022017329931259155, -0.0057007926516234875, 0.024843599647283554, -0.015882257372140884, 0.0542643778026104, -0.0288141630589962, 0.023906104266643524, 0.0015854683006182313, -0.02329949103295803, -0.010691571049392223, 0.005780065897852182, -0.038492415100336075, 0.009760970249772072, -0.0023971591144800186, 0.013531627133488655, 0.004863251931965351, -0.004304890986531973, -0.015427296049892902, 0.026525573804974556, -0.019218632951378822, 0.03413582220673561, 0.01953572779893875, 0.015358362346887589, -0.023906104266643524, 0.019563300535082817, -0.018749887123703957, -0.01854308694601059, 0.0494941845536232, -0.023340851068496704, -0.03220568597316742, -0.024388639256358147, 0.02267909049987793, 0.01985282078385353, -0.011773825623095036, 0.046516261994838715, 0.010794971138238907, -0.014793109148740768, 0.034549422562122345, 0.022334422916173935, -0.0035914303734898567, 0.024595439434051514, -0.030771872028708458, 0.003151979995891452, 0.03785822540521622, 0.003698277287185192, 0.03545934334397316, -0.0253674928098917, 0.018818819895386696, 0.0022799724247306585, -0.0027866328600794077, 0.018556872382760048, -0.013497160747647285, -0.007699861191213131, 0.0038464840035885572, 0.002653936157003045, 0.014214067719876766, -0.024829812347888947, -0.005214812234044075, 0.002950349822640419, 0.005780065897852182, 0.022444717586040497, -0.012159852311015129, 0.03689315915107727, -0.0026918493676930666, 0.01653023064136505, -0.021838102489709854, 0.02674616128206253, 0.005011458415538073, -0.016612950712442398, 0.011808292008936405, 0.025408852845430374, -0.0011486028088256717, -0.025257200002670288, -0.0003252795140724629, -0.0067830472253263, 0.021452074870467186, -0.005545692518353462, -0.009443876333534718, 0.016199350357055664, 0.01074671745300293, -0.047453757375478745, 0.016681883484125137, -0.017743458971381187, 0.016874898225069046, -0.005593945737928152, 0.010395157150924206, 0.026470428332686424, -0.011456731706857681, 0.010967304930090904, 0.016254497691988945, -0.015248069539666176, 0.009250862523913383, -0.021452074870467186, -0.00042781795491464436, -0.0076585011556744576, 0.023630371317267418, 0.001339031383395195, 0.005076945293694735, 0.02124527469277382, 0.026787521317601204, 0.0063522132113575935, -0.005304425489157438, 0.006817513611167669, 0.0038878440391272306, 0.010078064166009426, -0.017646951600909233, 0.021286634728312492, 0.017881324514746666, 0.0011374012101441622, 0.0040567307732999325, -0.02154858224093914, -0.0023868191055953503, -0.021838102489709854, -0.01886017993092537, 0.014324361458420753, 0.0107398247346282, -0.017771031707525253, -0.002848672913387418, 0.003784443950280547, 0.004177364520728588, 0.011339545249938965, 0.025891387835144997, 0.008968235924839973, -0.03460456803441048, 0.014145134948194027, 0.0103400107473135, -0.009388729929924011, 0.0404776968061924, 0.002469539176672697, 0.022568797692656517, 0.04610266163945198, 0.011153425090014935, 0.025546720251441002, 0.01666809804737568, 0.02568458765745163, 0.015055055730044842, -0.020087193697690964, -0.007058780640363693, 0.007499954663217068, 0.0012046112678945065, -0.008630461990833282, -0.0076585011556744576, 0.01704033836722374, -0.016998978331685066, 0.03082701936364174, 0.0030468564946204424, -0.00429110461845994, 0.035872943699359894, 0.00214555230922997, 0.008720075711607933, 0.05178277567028999, 0.02386474423110485, 0.002526409225538373, -0.004908058326691389, -0.039871081709861755, -0.012235679663717747, 0.001575128291733563, 0.020252633839845657, 0.001930135302245617, 0.010608850978314877, 0.025270987302064896, 0.03350163623690605, 0.020321568474173546, 0.018460365012288094, 0.021658875048160553, 0.00033626577351242304, -0.005214812234044075, -0.009181929752230644, 0.020211273804306984, 0.003122683148831129, -0.012911226600408554, -0.01585468277335167, -0.01647508330643177, -0.020680021494627, -0.006472846958786249, -0.037003450095653534, 0.030358271673321724, -0.006438380107283592, -0.004635771736502647, 0.007906661368906498, 0.05280298739671707, 0.00701742060482502, -0.015358362346887589, -0.02856600284576416, 0.008940662257373333, 0.008540849201381207, 0.016585377976298332, -0.021272849291563034, -0.021893249824643135, 0.03372222185134888, -0.012794040143489838, 0.006517653353512287, -0.022279277443885803, -0.008182395249605179, 0.05012837052345276, 0.0005911039770580828, 0.01218742597848177, -0.005083838477730751, 0.0012115045683458447, -0.030771872028708458, 0.007313834503293037, -0.019315140321850777, 0.01036758441478014, -0.02423698455095291, -0.026208480820059776, 0.001694900100119412, 0.02398882433772087, 0.020059620961546898, -0.017440151423215866, 0.008754542097449303, 0.013579880818724632, 0.0007082907250151038, 0.012021985836327076, 0.005445738788694143, -0.017123058438301086, 0.030220404267311096, 0.006586587056517601, -0.012173639610409737, 0.004970098379999399, 0.023078903555870056, -0.013448907062411308, -0.019259992986917496, -0.007686074823141098, 0.025477787479758263, -0.0021800189279019833, -0.012787146493792534, -0.017260923981666565, -0.005942059680819511, -0.026787521317601204, -0.03088216483592987, 0.020390501245856285, 0.0213004220277071, -0.040946442633867264, 0.006183326244354248, 0.014586308971047401, -0.009760970249772072, -0.021438289433717728, 0.0074861678294837475, -0.0184741523116827, 0.03614867851138115, 0.0023937125224620104, -0.025215839967131615, 0.019494367763400078, -0.0034673502668738365, 0.024085331708192825, 0.028455710038542747, -0.008568421937525272, 0.012614812701940536, 0.028028322383761406, -0.007920448668301105, 0.017578018829226494, -0.0007522357627749443, -0.005145878531038761, -0.014806895516812801, 0.011174105107784271, -0.0071828607469797134, -0.0050459252670407295, 0.010539917275309563, -0.01778481900691986, 0.018184632062911987, -0.018005404621362686, -0.013331720605492592, 0.01779860444366932, -0.005083838477730751, -0.009416303597390652, 0.005256172269582748, -0.004811551887542009, 0.018198419362306595, -0.007906661368906498, -0.002054215408861637, 0.023589011281728745, -0.003715510480105877, 0.0004967513377778232, 0.0283729899674654, -0.009795436635613441, 0.002018025377765298, -0.007293154485523701, -0.002946902997791767, -0.0033191435504704714, -0.006824407260864973, 0.02374066412448883, 0.04408980533480644, 0.0070725674740970135, 0.009271543473005295, 0.008065208792686462, 0.012008199468255043, 0.007410340942442417, -0.04422767460346222, -0.03810638561844826, 0.0019732187502086163, 0.00020712334662675858, -0.010912157595157623, -0.009754076600074768, 0.003482860280200839, 0.01465524174273014, -0.029089897871017456, 0.006465953309088945, 0.004063624422997236, 0.010002236813306808, 0.016323430463671684, -0.00845812913030386, -0.028152402490377426, -0.017702098935842514, -0.023602798581123352, -0.018115699291229248, 0.028924457728862762, 0.04654383659362793, 0.006638287100940943, 0.0011374012101441622, -0.030909739434719086, -0.0056215194053947926, -0.008878622204065323, -0.05536730960011482, 0.02087303437292576, 0.005755939520895481, -0.005562925711274147, -0.046075087040662766, 0.006476293317973614, -0.03896116092801094, 0.007520634680986404, 0.010064276866614819, 0.011684211902320385, 0.01541350968182087, 0.01212538592517376]",Model Alignment as Prospect Theoretic Optimization.pdf
" do not induce the
same distribution of human values.
Theorem 4.3 (restated) For input xwith outputs {ya, yb}, let dataset Dcomprise contradictory preferences ya≻yband
yb≻yain proportion p∈(0.5,1)and(1−p)∈(0,0.5)respectively. If p1/βπref(ya|x)<(1−p)1/βπref(yb|x), then the
optimal DPO policy is more likely to produce the minority-preferred yb; the optimal KTO policy will strictly produce the
majority-preferred yafor a loss-neutral value function ( λD=λU).
Proof. Where u=β(rθ(x, ya)−rθ(x, yb)), we can write the total DPO loss for xas
LDPO(x) =p(−logσ(u)) + (1 −p)(−logσ(−u))
Taking the derivative with respect to uand setting to zero, we get
0 =−pσ(u)σ(−u)
σ(u)+ (1−p)σ(−u)σ(u)
σ(−u)=−p(1−σ(u)) + (1 −p)σ(u) =−p+σ(u)
=⇒u=σ−1(p)
βr∗
θ(x, ya) =σ−1(p) +βr∗
θ(x, yb)
βlogπ∗
θ(ya|x)
πref(ya|x)= logp
1−p+βlogπ∗
θ(yb|x)
πref(yb|x)
π∗
θ(ya|x) =p
1−p1/β
·πref(ya|x)
πref(yb|x)·π∗
θ(yb|x)
Thus when p1/βπref(ya|x)<(1−p)1/βπref(yb|x), we have π∗
θ(ya|x)< π∗
θ(yb|x), meaning the optimal DPO policy is more
likely to produce the minority-preferred yb.
Where ua=β(rθ(x, ya)−EQ[rθ(x′, y′)])andub=β(rθ(x, yb)−EQ[rθ(x′, y′)]), noting that 1−σ(−u) =σ(u), we
can write the total KTO loss for xas
LKTO(x) =pλD(1−σ(ua)) + (1 −p)λUσ(ua) +pλUσ(ub) + (1 −p)λD(1−σ(ub))
=pλD+ ((1−p)λU−pλD)σ(ua) + (1 −p)λD+ (pλU−(1−p)λD)σ(ub)
=λD+ ((1−p)λU−pλD)σ(ua) + (pλU−(1−p)λD)σ(ub)
=λD+λD((1−2p)σ(ua) + (2 p−1)σ(ub))(under loss neutrality)
Given that p >0.5by assumption and λD>0by definition, the KTO loss is decreasing in uaand increasing in ub—and thus
decreasing in rθ(x, ya)and increasing in rθ(x, yb)respectively. The optimal KTO policy is thus π∗
θ(y|x) = 1[y=ya].
C. Implementations
SLiC Instead of sampling from the reference model to calculate the Lregas Zhao et al. (2023) do—as it is very slow—we
just apply the cross-entropy loss to the SFT data, assuming that the reference model recovers the SFT distribution.
DPO We use the implementation of DPO in the code provided by Rafailov et al. (2023). We found that, as mentioned
in the original paper, β= 0.1works best for most settings. Other training configurations, such as the learning rate and
optimizer, were borrowed from the original paper.
CSFT The control tokens used for generating the good and bad outputs are ⟨|good|⟩and⟨|bad|⟩respectively, following
the precedent set in Korbak et al. (2023).
15
Model Alignment as Prospect Theoretic Optimization
KTO We use a β= 0.1in our experiments unless otherwise specified (the same setting as for DPO), as it is close-to-
optimal","[0.006012813188135624, -0.008978442288935184, 0.023561924695968628, 0.013723449781537056, 0.017437899485230446, 0.0035253919195383787, -0.0003695452178362757, 0.021011482924222946, -0.011425087228417397, 0.03508339449763298, 0.03864214941859245, -0.006335325539112091, -0.017704807221889496, -0.022316360846161842, 0.033897142857313156, -0.013508440926671028, 0.025252332910895348, -0.04303128272294998, -0.02726896107196808, 0.03819730505347252, -0.008110996335744858, -0.03368954733014107, 0.014294332824647427, 0.02584545873105526, 0.018994854763150215, -0.003182490821927786, 0.040718089789152145, -0.027357930317521095, 0.001001826603896916, -0.03858283534646034, 0.028158649802207947, -0.03778211772441864, -0.030516324564814568, -0.08274105936288834, 0.015955084934830666, 0.037485554814338684, 0.02286500111222267, 0.06168508902192116, -0.0026523848064243793, 0.014627966098487377, 0.005486414302140474, -0.05821530148386955, -0.052995793521404266, 0.00013970893633086234, -0.017645495012402534, 0.026616523042321205, 0.03724830225110054, -0.0296266358345747, 0.026616523042321205, -0.018935542553663254, -0.04009530693292618, 0.04917013272643089, -0.02913730777800083, -0.00917120836675167, -0.0070952679961919785, 0.00693215848878026, 0.008815333247184753, 0.009675365872681141, 0.04703488200902939, -0.026749975979328156, -0.021960485726594925, -0.0309611689299345, 0.03745589777827263, 0.013567754067480564, -0.022761205211281776, 0.00441878754645586, -0.06619284301996231, 0.04964463412761688, 0.0014513048809021711, 0.018475869670510292, 0.001655191881582141, -0.012270291335880756, 0.03962080553174019, -0.023161564022302628, 0.009104481898248196, -0.006187044084072113, 0.02765449322760105, 0.04730178788304329, 0.02759518101811409, -0.025741662830114365, 0.010364874266088009, 0.003692208556458354, 0.04492928460240364, 0.011558540165424347, -0.014509341679513454, -0.07941955327987671, -0.032888829708099365, -0.012307361699640751, -0.04142984002828598, -0.024199534207582474, -0.021293219178915024, -0.012203564867377281, 0.014079324901103973, -0.0014040401438251138, 0.048280443996191025, -0.032829515635967255, 0.019958684220910072, -0.019469356164336205, 0.03152463957667351, -0.015747491270303726, -0.020477669313549995, -0.028484869748353958, -0.0005208386573940516, 0.0035976790823042393, 0.041400182992219925, 0.014034840278327465, 0.008489114232361317, 0.01936555840075016, -0.004800612572580576, 0.009845889173448086, -0.0268537737429142, -0.02847004123032093, -0.038226962089538574, 0.05266957730054855, -0.01184768881648779, -0.08428318053483963, -0.0629899650812149, 0.011299047619104385, -0.02468886412680149, -0.012366673909127712, -0.024599894881248474, -0.019854888319969177, 0.03176188841462135, 0.03368954733014107, 0.0026449705474078655, -0.03137635812163353, 0.027165163308382034, -0.08131755143404007, -0.01774929091334343, -0.01309325359761715, 0.048339758068323135, 0.004774663131684065, -0.02740241400897503, -0.025267161428928375, -0.039976682513952255, 0.013886558823287487, 0.014190535992383957, 0.035468924790620804, 0.010854203253984451, -0.013412058353424072, -0.03588411584496498, -0.06346447020769119, -0.044217534363269806, 0.019335903227329254, -0.07046335190534592, 0.0016663129208609462, -0.04567069187760353, 0.004604139365255833, -0.03271089121699333, 0.07164960354566574, 0.016978228464722633, -0.03724830225110054, -0.015866117551922798, 0.006357567850500345, 0.011462157592177391, -0.035379957407712936, 0.010031240992248058, 0.028292102739214897, 0.0059275515377521515, -0.03529099002480507, 0.0020815010648220778, 0.06281203031539917, 0.008363074623048306, 0.009897788055241108, 0.011921829544007778, 0.0038775603752583265, -0.01447227131575346, 0.027165163308382034, -0.06637078523635864, -0.01868346519768238, 0.009571568109095097, 0.02428850345313549, -0.05735526978969574, 0.0001911440776893869, -0.02989354357123375, -0.015510241501033306, -0.009934858419001102, -0.022079110145568848, -0.016236821189522743, -0.026824116706848145, 0.010757820680737495, 0.02090768702328205, 0.019246933981776237, 0.018327588215470314, -0.007080439943820238, -0.02692791447043419, 0.013219292275607586, -0.021827030926942825, -0.0016125609399750829, 0.013063596561551094, 0.03155429661273956, 0.01849069818854332, 0.0645914077758789, -0.02132287435233593, -0.010224007070064545, -0.02854418195784092, 0.046115536242723465, 0.06310859322547913, -0.0399470254778862, 0.020759405568242073, 0.011921829544007778, 0.025815803557634354, 0.0086003253236413, -0.06903985142707825, -0.015673350542783737, 0.0028507111128419638, 0.009186036884784698, -0.004774663131684065, -0.043743032962083817, 0.015161779709160328, 0.0008947859751060605, -0.0033215046860277653, 0.02199014090001583, 0.0017163580050691962, -0.0005078639951534569, 0.018920714035630226, -0.05848221108317375, 0.03549858182668686, 0.014642794616520405, 0.056317299604415894, -0.0052528707310557365, 0.041400182992219925, 0.026735147461295128, 0.024644378572702408, -0.012470470741391182, 0.014398130588233471, 0.025000255554914474, -0.020640779286623, 0.015465756878256798, -0.05154263600707054, 0.018861401826143265, 0.022242220118641853, 0.004140759818255901, -0.003364135744050145, 0.05175023153424263, -0.05699939653277397, -0.006550333462655544, -0.01849069818854332, -0.017096852883696556, -0.04839906841516495, -0.03899802640080452, -0.014946771785616875, 0.00703224865719676, -0.04323887452483177, -0.00388126727193594, 0.03105013817548752, -0.01672614924609661, -0.020566638559103012, -0.04042152687907219, -0.020359044894576073, 0.0029637757688760757, 0.0010722603183239698, -0.03739658370614052, -0.045374128967523575, -0.05581314489245415, 0.014954186044633389, 0.027239305898547173, -0.010587296448647976, -0.0289593692868948, 0.0399470254778862, -0.015436100773513317, -0.020225591957569122, -0.0006329764728434384, -0.011476985178887844, -0.011491813696920872, -0.010861617513000965, -0.004952600691467524, -0.02078906074166298, 0.014494513161480427, -0.021011482924222946, 0.021827030926942825, 0.009645708836615086, -0.004074033349752426, 0.020270075649023056, -0.055575892329216, -0.03796005621552467, -0.004585604183375835, 0.05038604140281677, -0.06654872000217438, -0.009571568109095097, -0.035528238862752914, -0.011432500556111336, 0.05228404328227043, 0.00786633137613535, 0.04451409727334976, -0.032355014234781265, -0.01194407232105732, 0.031406015157699585, -0.03567652031779289, 0.022316360846161842, 0.029982512816786766, -0.04134087264537811, 0.04237884283065796, -0.03496477007865906, 0.014850388281047344, 0.007362174801528454, 0.033304017037153244, -0.04359475150704384, 0.009297247976064682, -0.016770632937550545, 0.06067677587270737, -0.004681987222284079, 0.012255462817847729, 0.0002622728352434933, 0.0161330234259367, -0.018742777407169342, 0.03567652031779289, 0.033096421509981155, 0.014924529008567333, -0.00470793666318059, -0.045789316296577454, 0.011862517334520817, -0.021159764379262924, 0.03935389965772629, -0.014538997784256935, -0.00917120836675167, 0.06429484486579895, -0.008007199503481388, -0.012255462817847729, -0.04012496396899223, -0.06304927915334702, -0.10379702597856522, -0.03487579897046089, 0.01754169724881649, 0.021471155807375908, -0.008511356078088284, -0.011921829544007778, -0.007955300621688366, -0.006635595578700304, -0.03345229849219322, 0.01207752525806427, -0.004170416388660669, 0.007514163386076689, -0.010401944629848003, -0.020937342196702957, -0.002615314209833741, 0.011343532241880894, 0.05501242354512215, 0.008778262883424759, 0.022479470819234848, -0.10071276873350143, 0.02617167867720127, -0.005000792443752289, -0.008541012182831764, -0.00288592791184783, -0.00019207083096262068, 0.03567652031779289, 0.039561495184898376, 0.048814259469509125, 0.035113051533699036, -0.033570922911167145, -0.0153471315279603, 0.02523750439286232, 0.04059946537017822, 0.0344013012945652, -0.00022543416707776487, 0.03446061164140701, -0.025415442883968353, -0.023858487606048584, -0.014390716329216957, -0.006398345343768597, 0.0146798649802804, 0.014620552770793438, 0.011239735409617424, 0.010209178552031517, 0.007080439943820238, -0.015969913452863693, -0.02010696567595005, 0.0032974090427160263, 0.011907001957297325, -0.011106281541287899, 0.01638510264456272, -0.05720698833465576, 0.012878244742751122, -0.04430650174617767, -0.00812582392245531, 0.03176188841462135, 0.026883428916335106, 0.044899627566337585, 0.013708621263504028, -0.019410043954849243, -0.0024781539104878902, -0.021174592897295952, -0.02099665440618992, -0.016414757817983627, 0.0034104736987501383, 0.007410366088151932, -0.02206428162753582, -0.028173478320240974, -0.01795688457787037, -0.011929243803024292, 0.00934914592653513, -0.007807019166648388, 0.01929141767323017, -0.016785461455583572, -0.00430386932566762, -0.0006612426368519664, 0.06844672560691833, 0.024851974099874496, 0.05889739841222763, -0.04878460243344307, -0.012233220972120762, -0.05940155312418938, -0.004366889130324125, -0.06476934254169464, -0.021560125052928925, 0.018713120371103287, 0.02698722667992115, 0.020952170714735985, 0.041518811136484146, 0.06856534630060196, -0.04042152687907219, 0.029241105541586876, -0.03155429661273956, 0.013004284352064133, -0.012670651078224182, 0.02577131800353527, 0.011328703723847866, 0.01856483891606331, 0.06358309090137482, -0.020477669313549995, -0.011625266633927822, -0.02160460874438286, -0.04914047569036484, -0.020092139020562172, 0.024599894881248474, 0.003380817361176014, -0.02457023784518242, 0.03475717455148697, -0.040391869843006134, 0.0066430093720555305, 0.030056653544306755, 0.05139435455203056, -0.03265157714486122, -0.05062329024076462, -0.026601694524288177, -0.015302646905183792, -0.03016044944524765, 0.012388916686177254, -0.007925644516944885, -0.020121794193983078, -0.009527084417641163, 0.007402952294796705, -0.013612238690257072, -0.013137737289071083, -0.01626647636294365, 0.006157387979328632, -0.028217962011694908, 0.024866800755262375, 1.0520164323679637e-05, -0.040925685316324234, 0.03232536092400551, 0.03540961444377899, -0.0038441969081759453, -0.0016079271445050836, -0.019795576110482216, 0.0645320937037468, -0.0026764804497361183, 0.028662806376814842, 0.015302646905183792, 0.030516324564814568, -0.021560125052928925, -0.010906102135777473, -0.01605888269841671, 0.00139106553979218, 0.03152463957667351, 0.020952170714735985, -0.021367359906435013, -0.01942487247288227, 0.011380602605640888, -0.018475869670510292, -0.03873111680150032, 0.011217492632567883, -0.0478949137032032, -0.04196365550160408, 0.01113593764603138, 0.06571834534406662, -0.013404644094407558, 0.015184021554887295, 0.0033826709259301424, 0.04513687640428543, -0.04783559963107109, -0.007970129139721394, 0.010950585827231407, 0.06838741153478622, 0.07799605280160904, 0.06714184582233429, -0.010505741462111473, -0.01807551085948944, 0.001690408680588007, -0.0027228184044361115, -0.039502181112766266, 0.06340515613555908, -0.01841655746102333, -0.005497535225003958, -0.007947886362671852, 0.01356033980846405, 0.024140221998095512, 0.00046615986502729356, -0.017022712156176567, 0.04338715597987175, 0.0032696062698960304, -0.01963246613740921, 0.024599894881248474, 0.006042469758540392, 0.018861401826143265, 0.013397229835391045, -0.03401576727628708, -0.030812887474894524, 0.0015115442220121622, -0.005271405912935734, -0.003356721717864275, -0.008363074623048306, 0.012166494503617287, -0.020477669313549995, 0.01072816364467144, -0.05949052423238754, 0.003391938516870141, -0.034935113042593, 0.0523730143904686, -0.028588665649294853, -0.020092139020562172, -0.027624836191534996, 0.007525284308940172, 0.018372073769569397, -0.027372758835554123, -0.020640779286623, -0.123844675719738, -0.028707291930913925, -0.04317956417798996, 0.034846145659685135, -0.0058793602511286736, -7.634178473381326e-05, 0.013471370562911034, -0.007373295724391937, -0.006843189708888531, 0.0017728902166709304, -0.010298147797584534, -0.01565852202475071, -0.0026950156316161156, 0.003080547321587801, -0.021293219178915024, 0.014969013631343842, 0.0030694263987243176, 0.01440554391592741, -0.039650462567806244, 0.039650462567806244, -0.008578082546591759, -0.023220878094434738, 0.008414973504841328, 0.013649309054017067, -0.015258162282407284, -0.04552241042256355, -0.00853359792381525, -0.04890322685241699, 0.0061536808498203754, 0.01984005980193615, 0.0014318429166451097, 0.011447329074144363, -0.0009962661424651742, 0.002908170223236084, 0.011395430192351341, -0.0011538151884451509, -0.0013539951760321856, -0.01801619865000248, 0.03496477007865906, 0.005946086719632149, -0.016236821189522743, 0.04353543743491173, 0.04866597801446915, -0.06429484486579895, -0.0024262554943561554, 0.045848630368709564, -0.00267462688498199, 0.006542919669300318, -0.003910923842340708, 0.03419370576739311, -0.017378587275743484, 0.029982512816786766, -0.021100452169775963, -0.023235704749822617, 0.01548058446496725, -0.006780169904232025, -0.026408929377794266, -0.04196365550160408, -0.003138006431981921, 0.03035321645438671, 0.028796261176466942, -0.03751521185040474, 0.03170257806777954, 0.03819730505347252, -0.04919978976249695, -0.0037885913625359535, -0.0013289726339280605, -0.023235704749822617, 0.017497213557362556, 0.013767934404313564, -0.009786576963961124, 0.0074659716337919235, -0.04424718767404556, 0.04546309635043144, 0.0035661691799759865, 0.0064205871894955635, -0.022835345938801765, -0.01511729508638382, 0.03487579897046089, -0.026008568704128265, 0.0034605187829583883, 0.028781432658433914, 0.01407191064208746, 0.018312761560082436, -0.001026849146001041, -0.009371388703584671, -0.0004334916011430323, -0.025089222937822342, -0.039175961166620255, -0.007740292232483625, -0.008288933895528316, 0.039294589310884476, 0.0002710770640987903, -0.02347295545041561, -0.021308045834302902, -0.008511356078088284, -0.005794098135083914, -0.014153465628623962, 0.009816233068704605, -0.009082240052521229, -0.00068116799229756, 0.027357930317521095, -0.01542127225548029, -0.04433615878224373, 0.00408515427261591, 0.011966314166784286, 0.03211776539683342, 0.02004765346646309, -0.004574483260512352, 0.02267223596572876, 0.012337017804384232, -0.016548210754990578, -0.03499442711472511, 0.025489583611488342, 0.03259226679801941, 0.029166964814066887, -0.0178679171949625, 0.020092139020562172, -0.02510405145585537, -0.009845889173448086, 0.020284904167056084, -0.019676949828863144, -0.029715605080127716, -0.017571354284882545, -0.029582152143120766, 0.001210347400046885, 0.01740824431180954, 0.016103366389870644, 0.017986541613936424, -0.010060897096991539, 0.0012122009648010135, -0.013649309054017067, -0.004945186898112297, -0.032621923834085464, 0.006706029176712036, 0.0012946825008839369, -0.008874645456671715, 0.03229570388793945, 0.06441346555948257, 0.015272990800440311, 0.06322721391916275, 0.0019146844279021025, 0.00388126727193594, -0.005968329031020403, 0.018846573308110237, 0.013567754067480564, -0.033837828785181046, 0.003226975444704294, -0.0003055988345295191, -0.0033511610236018896, -0.033155735582113266, -0.027016881853342056, 0.011358359828591347, -0.018787261098623276, -0.019469356164336205, -0.04134087264537811, -0.014509341679513454, -0.024066081270575523, -0.032829515635967255, 0.03689242899417877, 0.009801404550671577, -0.02396228536963463, -0.022583266720175743, -0.014049668796360493, 0.004177830182015896, 0.025074396282434464, -0.03644758462905884, -0.027031710371375084, 0.009030341170728207, -0.009964514523744583, 0.0394132137298584, -0.021767718717455864, -0.06915847212076187, -0.012477885000407696, 0.009534497745335102, -0.042942311614751816, 0.008985856547951698, -0.042675405740737915, -0.007010006345808506, -0.019988341256976128, 0.03176188841462135, 0.050297074019908905, -0.02442195639014244, -0.007265791762620211, 0.02158978208899498, -0.01807551085948944, 0.004922944586724043, 0.007098975125700235, -0.00372742535546422, 0.021041139960289, 0.024244019761681557, 0.003610653569921851, -0.01521367859095335, -0.022509125992655754, -0.023917799815535545, -0.04062912240624428, 0.014694693498313427, -0.013916215859353542, -0.0019387801876291633, -0.057177331298589706, -0.014183121733367443, -0.014724349603056908, -0.01289307326078415, 0.010453843511641026, -0.0019573152530938387, -0.010557640343904495, -0.027713805437088013, -0.0199735127389431, 0.02584545873105526, -0.002841443521901965, 0.047064535319805145, -0.005100882146507502, 4.71488710900303e-05, 0.019217276945710182, 0.007629081141203642, -0.03656620904803276, 0.012707721441984177, 0.005734785459935665, 0.002752474742010236, 0.020284904167056084, 0.04131121560931206, 0.02537095919251442, 0.00954932626336813, 0.0071953581646084785, 0.015302646905183792, -0.014665036462247372, 0.007128631230443716, 0.03973943367600441, -0.013197050429880619, -0.008459457196295261, 0.002811787184327841, -0.020596295595169067, 0.005071226041764021, -0.009675365872681141, 0.004693108145147562, -0.03345229849219322, 0.018920714035630226, 0.0019387801876291633, -0.017719635739922523, -0.04893288388848305, -0.027565523982048035, 0.033570922911167145, 0.01869829185307026, -0.01814965158700943, 0.022687064483761787, 0.012010798789560795, 0.03446061164140701, 0.04988188296556473, 0.002407720312476158, -0.011313876137137413, -0.005834875628352165, -0.014820732176303864, -0.011261977255344391, -0.015688179060816765, -0.0157326627522707, 0.011936658062040806, -0.020640779286623, -0.029997339472174644, 0.0024058667477220297, 0.026230990886688232, -0.008629981428384781, 0.01598474197089672, -0.019958684220910072, -0.0037144506350159645, -0.009267591871321201, -0.018935542553663254, 0.01018693670630455, 0.004711643327027559, 0.022894658148288727, -0.06162577494978905, -0.139740452170372, -0.026156850159168243, 0.01862415112555027, 0.019469356164336205, 0.029241105541586876, -0.008844989351928234, 0.057384926825761795, 0.0027765703853219748, -0.019647294655442238, -0.022494297474622726, 0.01039453037083149, -0.028217962011694908, -0.0009554887074045837, -0.013241535052657127, 0.0014735470758751035, -0.05065294727683067, -0.009504841640591621, -0.013893973082304, -0.0018368366872891784, -0.008474285714328289, -0.02881108783185482, -0.005304769612848759, -0.01120266504585743, 0.04715350642800331, -0.06310859322547913, -0.0015643694205209613, 0.023191221058368683, -0.015747491270303726, 0.008140652440488338, -0.0007891354034654796, 0.015109880827367306, 0.019484184682369232, 0.02428850345313549, 0.01794205792248249, -0.05284751206636429, 0.004859924782067537, -0.002502249786630273, -0.009356560185551643, 0.015866117551922798, 0.014049668796360493, 0.0006186117534525692, -0.03419370576739311, 0.029122479259967804, -0.014316575601696968, 0.017363758757710457, -0.041933998465538025, 0.026572037488222122, -0.018179306760430336, 0.0015838313847780228, -0.008882059715688229, 0.03179154545068741, -0.042349185794591904, -0.0017673297552391887, -0.025800975039601326, -0.02253878302872181, 0.011380602605640888, 0.01430174708366394, 0.0017386002000421286, -0.008978442288935184, -0.010416773147881031, -0.01605888269841671, 0.026749975979328156, 0.01721547730267048, -0.015969913452863693, -0.06708253175020218, -0.022761205211281776, -0.012581681832671165, 0.015376787632703781, -0.020729748532176018, -0.023176392540335655, 0.005968329031020403, 0.02947835437953472, -0.0022779740393161774, 0.019484184682369232, -0.03523167595267296, -0.019128309562802315, 0.013649309054017067, 0.015880944207310677, -0.056584205478429794, 0.010068311356008053, 0.048695631325244904, -0.03422336280345917, 0.02489645779132843, 0.04940738528966904, 0.020625950768589973, 0.030308730900287628, 0.0005704202339984477, -0.014442614279687405, -0.00867446605116129, -0.0076439096592366695, 0.026572037488222122, -0.028796261176466942, -0.00524545693770051, -0.02396228536963463, -0.00450404966250062, -0.024777833372354507, -0.024125393480062485, 0.020344216376543045, 0.01174389198422432, -0.001422575325705111, 0.003836782881990075, 0.0033659893088042736, -0.036328960210084915, -0.006520677357912064, 0.021011482924222946, 0.012500127777457237, 0.00526028499007225, -0.0013567754067480564, 0.021678749471902847, -0.02603822574019432, -0.01634061709046364, -0.02314673736691475, 0.01619233563542366, 0.0060016922652721405, -0.02098182775080204, 0.015747491270303726, 0.05587245523929596, 0.015391616150736809, 0.007725464180111885, 0.010439014993607998, 0.008029441349208355, 0.023383986204862595, 0.004719057586044073, 0.006031348370015621, 0.001065773074515164, -0.0029174378141760826, -0.010068311356008053, 0.05483448505401611, -0.026008568704128265, 0.02402159757912159, 0.018475869670510292, 0.0033215046860277653, 0.022019797936081886, -0.01991420052945614, 0.015747491270303726, 0.014338817447423935, 0.02529681846499443, 0.02725413255393505, 0.0027617423329502344, 0.03211776539683342, 0.0015893919626250863, 0.00934173259884119, 0.0019072702853009105, 0.02692791447043419, -0.021293219178915024, 0.021426672115921974, 0.026349615305662155, -0.02706136740744114, 0.005275113042443991, 0.006187044084072113, 0.031406015157699585, -0.022553611546754837, -0.008148066699504852, -0.0004749640647787601, -0.000872080388944596, 0.018594495952129364, -0.00524916360154748, -0.01585128903388977, 0.012270291335880756, 0.02468886412680149, 0.010350045748054981, 0.029196619987487793, -0.02314673736691475, -0.03271089121699333, 0.039917368441820145, -0.02199014090001583, -0.022079110145568848, 0.0005486414302140474, 0.01856483891606331, 0.0030249417759478092, -0.009868131019175053, -0.05916430428624153, -0.0046856943517923355, 0.016073711216449738, 0.04027324542403221, -0.0020240419544279575, 0.007554940413683653, 0.02234601601958275, -0.011966314166784286, 0.018876230344176292, 0.01955832540988922, 0.008051683194935322, -0.026082709431648254, -0.0037348393816500902, 0.03947252407670021, -0.04931841418147087, 0.015895772725343704, 0.002075940603390336, 0.021485984325408936, 0.01875760592520237, 0.02179737575352192, 0.012989455834031105, -0.003130592405796051, 0.02476300485432148, 0.01228511892259121, 0.002407720312476158, 0.009304662235081196, 0.04398028180003166, 0.011254562996327877, -0.029448699206113815, -0.0015374934300780296, 0.04460306465625763, -8.914264617487788e-05, -0.010105381719768047, -0.04051049426198006, 0.035320643335580826, 0.0232801903039217, -0.014620552770793438, 0.0030972291715443134, 0.010935758240520954, -0.004626381676644087, 0.018579667434096336, -0.021204249933362007, 0.013463957235217094, -0.01092834398150444, -0.057651832699775696, -0.0023354331497102976, 0.014835560694336891, -0.02348778396844864, -0.006098075304180384, 0.00319731910713017, -0.0271206796169281, 0.033155735582113266, -0.0009666098048910499, -0.011195250786840916, -0.03490545600652695, 0.054359983652830124, -0.002022188389673829, 0.02596408501267433, 0.013849488459527493, -0.03122807666659355, 0.055842798203229904, -0.002837736625224352, 0.005204679444432259, 0.025623036548495293, -0.02233118936419487, 0.007732878439128399, -0.012299947440624237, -0.005934965796768665, 0.002568976255133748, 0.046382442116737366, -0.00012557586887851357, -0.0032492175232619047, -0.014672450721263885, 0.002224222058430314, 0.005401152186095715, 0.016652008518576622, 0.04285334423184395, -0.016103366389870644, 0.017259962856769562, -0.017185822129249573, 0.01501349825412035, 0.007566061802208424, 0.004848803859204054, 0.013300847262144089, -0.0034920284524559975, 0.004218607675284147, 0.05702904984354973, 0.03143567219376564, -9.158986813417869e-07, -0.02873694710433483, 0.018846573308110237, -0.018475869670510292, -0.013115495443344116, -0.0030657192692160606, -0.01949901320040226, 0.013960699550807476, 0.020003169775009155, 0.006079540122300386, 0.001479107653722167, -0.03564686328172684, 0.025207849219441414, -0.014027426950633526, 0.02725413255393505, 0.018031025305390358, 0.0096531230956316, 0.040391869843006134, -0.03223638981580734, 0.0336005799472332, 0.009134138002991676, -0.020625950768589973, -0.010913515463471413, -0.012033040635287762, 0.0163999292999506, 0.010327803902328014, -0.022953970357775688, 0.0019721435382962227, -0.016904087737202644, -0.001087088487111032, 0.006413173396140337, 0.04472168907523155, 0.04205262288451195, -0.022153250873088837, 0.002255731727927923, 0.0009476112318225205, -0.026008568704128265, -0.017037540674209595, 0.02029973268508911, -0.013805004768073559, -0.009519670158624649, 0.010965414345264435, 0.01651855558156967, 0.0037997125182300806, -0.016711320728063583, 0.02827727608382702, 0.016281304880976677, 0.020551810041069984, 0.004719057586044073, -0.029448699206113815, -0.025860287249088287, 0.007881159894168377, -0.015688179060816765, -0.005301062483340502, 0.025593381375074387, -0.00880791898816824, 0.00860773865133524, -0.008844989351928234, -0.013159980066120625, -0.0008836648776195943, 0.015072810463607311, -0.0034994424786418676, -0.0172006506472826, 0.019528668373823166, 0.02335433103144169, -0.015065397135913372, -0.004203779622912407, 0.0061536808498203754, 0.0029026097618043423, 0.02234601601958275, 0.008578082546591759, -0.014716935344040394, 0.03265157714486122, 0.014724349603056908, -0.02024042047560215, -0.04255678132176399, 0.008919130079448223, -0.023042939603328705, -0.0016968960408121347, -0.025830630213022232, -0.05118676275014877, 0.015969913452863693, -0.001058358931913972, -0.022642578929662704, -0.00578297721222043, -0.0004066155815962702, 0.03128739073872566, 0.009964514523744583, 0.0297600906342268, -0.0005523484433069825, 0.0014846681151539087, 0.0889095664024353, -0.023725034669041634, -0.05020810291171074, 0.007903401739895344, 0.006635595578700304, 0.023858487606048584, -0.007310276385396719, 0.01029073353856802, -0.04264574870467186, 0.010075725615024567, -0.019484184682369232, 0.018372073769569397, -0.014323989860713482, 0.0015467610210180283, 0.029522839933633804, 0.0235470961779356, -0.0103203896433115, 0.009868131019175053, 0.03202879801392555, -0.01860932447016239, 0.012425987049937248, -0.02240533009171486, -0.019647294655442238, 0.003067572833970189, 0.012796690687537193, -0.0009003464947454631, -0.041518811136484146, -0.016073711216449738, -0.004544826690107584, 0.03164326399564743, -0.003310383763164282, -0.03736693039536476, -0.04448444023728371, -0.016711320728063583, 0.0002706136729102582, -0.005171316210180521, -0.03715933486819267, 0.0333336740732193, -0.011958899907767773, -0.032621923834085464, -0.014235020615160465, -0.023309845477342606, 0.0043149907141923904, 0.0020666730124503374, 0.009230521507561207, 0.015762319788336754, 0.002116717863827944, 0.005875653121620417, 0.017437899485230446, -4.0864284528652206e-05, 0.03623998910188675, -0.02664617821574211, 0.018060682341456413, -0.018876230344176292, -0.015080224722623825, 4.095117037650198e-05, 0.011343532241880894, 0.01018693670630455, 0.024199534207582474, 0.019202450290322304, -0.034104738384485245, 0.006791290827095509, -0.030323559418320656, 0.0029026097618043423, 0.0193062461912632, -0.01721547730267048, -0.00556796882301569, 0.006238942500203848, 0.00345866521820426, 0.05492345616221428, -0.01490970142185688, 0.021100452169775963, -0.02907799556851387, -0.02922627702355385, 0.0012863416923210025, -0.016073711216449738, -0.014049668796360493, 0.01082454714924097, 0.007940472103655338, 0.029923198744654655, -0.00556426215916872, 0.01634061709046364, -0.00516019482165575, 0.006913623306900263, -0.007176822982728481, 0.004378010053187609, 0.0020055067725479603, -0.016503727063536644, -0.042734719812870026, 0.030783232301473618, -0.01674097776412964, 0.010342632420361042, 0.027417242527008057, -0.004789491184055805, -0.013182221911847591, -0.017393415793776512, 0.007955300621688366, 0.013145151548087597, 0.00388126727193594, 0.026023397222161293, -0.03647724166512489, -0.009875545278191566, 0.0076883938163518906, 0.02388814464211464, -0.0025356130208820105, 0.012737377546727657, -0.04095533862709999, 0.004296455532312393, 0.009979342110455036, -0.017259962856769562, 0.017704807221889496, 0.002318751299753785, 0.016236821189522743, 0.026082709431648254, -0.026957569643855095, 0.03947252407670021, -0.006631888449192047, 0.03787108510732651, 0.01062436681240797, -0.0009086873615160584, 0.0151469511911273, 0.006813533138483763, 0.017304446548223495, -0.00225943885743618, 0.024851974099874496, 0.014249849133193493, -0.001058358931913972, 0.016088539734482765, 0.004392838571220636, 0.017423072829842567, -0.009786576963961124, 0.016755806282162666, -0.005612453445792198, -0.03244398534297943, 0.013545511290431023, 0.012833761051297188, 0.011098867282271385, -0.01059471070766449, -0.019662121310830116, -0.003226975444704294, 0.01049091387540102, 0.008452043868601322, 0.00022323311713989824, 0.02970077656209469, -0.003119471250101924, -0.02422919124364853, 0.006906209047883749, -0.038820087909698486, 0.03137635812163353, 0.022034626454114914, 0.016355445608496666, -0.01383466087281704, -0.0029229982756078243, 0.01782343164086342, 0.014687279239296913, -0.005527191795408726, -0.006635595578700304, -0.03647724166512489, -0.01605888269841671, 0.01373086404055357, 0.03339298442006111, -0.007080439943820238, 0.009230521507561207, 0.02362123690545559, 0.02301328256726265, -0.01788274385035038, -0.02409573830664158, -0.013501027598977089, 0.017853088676929474, 0.0018627858953550458, 0.0007159214583225548, 0.013211878016591072, -0.0020110674668103456, -0.008110996335744858, -0.030990825966000557, 0.007499334868043661, -0.010913515463471413, -0.007740292232483625, -0.015747491270303726, 0.03116876445710659, 0.009934858419001102, 0.005367788951843977, 0.009082240052521229, 0.02449609711766243, 0.005816340446472168, 0.0309611689299345, 0.005241749808192253, 0.024510925635695457, 0.01674097776412964, 0.002196419285610318, -0.0019832646939903498, 0.0016959692584350705, 0.030783232301473618, 0.0024262554943561554, 0.020017998293042183, 0.035468924790620804, 0.022790860384702682, -0.014146051369607449, 0.010565054602921009, 0.0030434769578278065, 0.006101782433688641, -0.013063596561551094, 0.024451613426208496, -0.0026597988326102495, -0.0032640458084642887, -0.016755806282162666, 0.004003599751740694, -0.011195250786840916, 0.009260177612304688, 0.027031710371375084, 0.04009530693292618, -0.00893395859748125, 0.031613606959581375, 0.022894658148288727, 0.007284326944500208, 0.00027200381737202406, 0.015391616150736809, 0.028855573385953903, -0.030664606019854546, -0.008800504729151726, -0.003951700869947672, 0.0038775603752583265, 0.03211776539683342, -0.008570668287575245, -0.008926544338464737, 0.02010696567595005, -0.0021204249933362007, 0.041933998465538025, 0.0035531946923583746, 0.003010113723576069, -0.006168508902192116, -0.012989455834031105, -0.010757820680737495, 0.007851503789424896, 0.007528991438448429, -0.014257262460887432, -0.013879145495593548, -0.04237884283065796, 0.021293219178915024, 0.0029248518403619528, -0.052195075899362564, 0.002205686876550317, -0.02569717727601528, -0.013130323961377144, 0.014294332824647427, 0.02989354357123375, 0.0014568653423339128, 0.015176608227193356, -0.0297600906342268, 0.002580097410827875, 0.016770632937550545, -0.008237035013735294, -0.019143136218190193, -0.0226129237562418, 0.015969913452863693, -0.0031639556400477886, -0.008251863531768322, -0.03016044944524765, -0.004678280092775822, 0.026260647922754288, -0.02382883056998253, -0.0012594657018780708, -0.002344700740650296, 0.002196419285610318, -0.024674035608768463, 0.01666683703660965, -0.010172108188271523, -0.0037218646612018347, -0.036595866084098816, -0.020863201469182968, -0.004166709259152412, 0.02772863395512104, 0.0024058667477220297, 0.0010472378926351666, 0.020878029987215996, 0.02510405145585537, 0.04009530693292618, 0.006906209047883749, 0.008103582076728344, -0.028573838993906975, 0.04555206745862961, -0.01721547730267048, -0.015821631997823715, -0.00785891804844141, 0.0049563078209757805, 0.007176822982728481, -0.02523750439286232, -0.008385316468775272, -0.026156850159168243, 0.005716250278055668, -0.024407129734754562, 0.011410258710384369, 0.0013864317443221807, -0.012062696740031242, -0.016978228464722633, -0.009401044808328152, 0.022701893001794815, -0.03884974494576454, -0.030753575265407562, 0.0239474568516016, -0.007050783839076757, -0.030753575265407562, 0.016622351482510567, -0.003840490011498332, 0.02806968055665493, 0.017719635739922523, -0.0025319058913737535, 0.025667522102594376, -0.0028655393980443478, 0.004852510988712311, -0.009467771276831627, 0.00013275824312586337, -0.0018850280903279781, 0.01714133657515049, -0.009771748445928097, 0.009712436236441135, -0.018164480105042458, 0.008481699973344803, -0.027031710371375084, -0.00556796882301569, -0.04774663224816322, -0.007829261012375355, 0.006854310631752014, -0.012307361699640751, 0.04946669563651085, 0.006668958812952042, -0.014464857056736946, 0.015495412983000278, 0.006313083227723837, -0.028929714113473892, 0.028306931257247925, 0.007606839295476675, 0.01915796473622322, 0.010253663174808025, 0.01103214081376791, 0.01619233563542366, -0.017304446548223495, 0.01333050336688757, 0.0048080263659358025, -0.03635861352086067, -0.02071492001414299, 0.00026806507958099246, -0.002001799875870347, 0.007388123776763678, -0.035053737461566925, 0.023250533267855644, 0.01399776991456747, -0.003929459024220705, 0.0016616791253909469, -0.0004828415112569928, 0.03291848674416542, 0.03164326399564743, -0.04131121560931206, -0.01166975125670433, 0.01363448053598404, 0.017660321667790413, 0.00587194599211216, -0.015762319788336754, -0.0032473639585077763, 0.01312290970236063, -0.014420372433960438, -0.01146957091987133, 0.008741192519664764, 0.01647407002747059, -0.014442614279687405, -0.002061112318187952, 0.004481807351112366, -0.039294589310884476, 0.004752420820295811, -0.019083824008703232, 0.01281893253326416, 0.03787108510732651, 0.01782343164086342, 0.0024614722933620214, -0.004515170585364103, 0.008889473974704742, -0.005382617004215717, -0.018001370131969452, 0.024006769061088562, -0.004081447143107653, 0.00294338702224195, -0.012811518274247646, -0.019276591017842293, 0.0005050837644375861, -0.004344646818935871, 0.026008568704128265, 0.014568653889000416, 0.01795688457787037, -0.022776033729314804]",Model Alignment as Prospect Theoretic Optimization.pdf
" for most settings. By default, λD=λU= 1. In experiments on imbalanced data subsampled from [SHP, HH,
OASST], we found that setting λU, λDsuch that the effective ratio of desirable:undesirable examples was 4:3 worked best,
regardless of which group was in the minority (see (8)). However, in running data-imbalanced experiments on UltraFeedback,
we found that an effective ratio of 1:1 worked best. The other hyperparameters (e.g., learning rate) are the same as in DPO.
PPO PPO-Clip is the traditional means of optimizing the RLHF objective (2). However, most implementations of
PPO-Clip for LLM alignment suffer from instability, particularly during distributed training. We find that running the
PPO-Clip objective on offline data with the following “tricks” leads to much more stable training:
•We never update the reference distribution (i.e., the policy only takes one step in the trust region). Baheti et al. (2023)
recommend this as well. To accommodate for this conservative change, we clip the probability ratios more liberally,
finding that an asymmetric interval of [0.25,4.0]works best instead of the small symmetrical interval (e.g., [0.8,1.2])
that is traditionally recommended.
•Including a KL penalty (between the policy and reference distributions) in addition to the clipping makes training more
stable, as is also done in the implementation by von Werra et al. (2020). We find that it is important to estimate the KL
term not using the entire distribution but rather as the mean difference in the predicted log probabilities of the actual
output tokens (i.e., the labels). We suspect that this makes a difference because the rest of the distribution can be poorly
calibrated.
•The value of a state is generally predicted by some value head attached to the policy model; the value loss is the MSE
between the predicted value and the discounted sum of future rewards for each token. This is a linear layer in many
RLHF implementations (von Werra et al., 2020). However, we find that backpropagating the value loss through this
head and the policy leads to worse performance. Instead, we make the value head a 3-layer MLP and detach it from the
computational graph, so that the value losses are not backpropagated through the policy model but the value head still
has sufficient capacity to learn good estimates.
D. Human Evaluation
For human evaluation, we randomly sampled 256 prompts from the OpenAssistant test set and generated outputs from
Mistral 7B models aligned with DPO and KTO. All inputs were multi-turn conversations between a user and an assistant,
where the LLM played the role of the assistant (see Table 5 for an example) and the last turn in the input was that of the user.
These were sent to a third-party data annotation service where a pool of workers picked either the generated output or the
SFT target (from the OpenAssistant dataset) as the more appropriate response by the assistant. Any questions that required
specific domain experience (e.g., coding) were skipped, leading to 214 comparisons for DPO and KTO each.
The winrates of the aligned model over the SFT targets are 72.9%±5.3for KTO and 62.1%±5.7for DPO (where the
intervals are 90% binomial confidence intervals). In contrast, Table 2 contains the winrates when the same experiment is
run with GPT-4 as a judge instead: 65.2%±3.6for KTO and 60.0%±3.7for DPO. Thus although there is no significant
difference in the GPT-4-based evaluation, there is a significant difference with human evaluation at p <0.05. We found that
68.7% of the individual human judgments concurred with the GPT-4 judgments for KTO; this number fell to 65.9% for
DPO.
E. Additional Experiments
16
Model Alignment as Prospect Theoretic Optimization
Table 3. KTO alignment with only desirable/positive examples (i.e., the same data that would be used for SFT), yields similar results to
SFT when βis small; this is intuitive because it is less bound to the reference model. λDis fixed at 1.
Dataset ( →) MMLU GSM8k HumanEval BBH TydiQA AlpacaEval 2 Avg.
Setup ( →) 0-shot 8-shot, CoT 0-shot, Synth. 3-Shot, CoT 1-Shot, GP ","[-0.025696657598018646, 0.0023771855048835278, 0.06869210302829742, -0.002576302969828248, -0.0024715042673051357, -0.008216223679482937, -0.015789680182933807, 0.043763965368270874, 0.008230196312069893, 0.005875717382878065, 0.037867289036512375, -0.007273034658282995, -0.009536688216030598, -0.020666318014264107, 0.01984190009534359, -0.04242254048585892, 0.011877194046974182, -0.053042151033878326, -0.015789680182933807, 0.0312999002635479, -0.02037288062274456, -0.016809722408652306, 0.007678256370127201, 0.025501033291220665, 0.024984026327729225, -0.01809525489807129, 0.008321022614836693, 0.011157575994729996, 0.010319185443222523, -0.04667038470506668, 0.03208239749073982, -0.02438317984342575, -0.0278764721006155, -0.0358830988407135, 0.014043034985661507, 0.03364739194512367, 0.02225925773382187, 0.06897155940532684, -0.011220455169677734, -0.009606554172933102, -0.013232591561973095, -0.045161280781030655, -0.031747039407491684, 0.019017484039068222, -0.025487059727311134, 0.007259061560034752, 0.05533374845981598, 0.006364778615534306, -0.0027701808139681816, -0.004426001105457544, -0.01827690564095974, 0.09356433898210526, -0.017536327242851257, 0.0018182586645707488, 0.02611585333943367, -0.003828648244962096, 0.02455085888504982, -0.009215304628014565, 0.056479550898075104, -0.01358192041516304, -0.021854037418961525, -0.03482113778591156, 0.05958159267902374, 0.005620707292109728, -0.023950012400746346, -0.02174225077033043, -0.09675022214651108, 0.009075573645532131, 0.02559884637594223, 0.007880867458879948, -0.013267523609101772, 0.012443107552826405, -0.000535783707164228, -0.03199855610728264, 0.010004788637161255, -0.012366254813969135, 0.03758782520890236, 0.05812838301062584, -0.007259061560034752, -0.03739219903945923, -0.0013265777379274368, -0.018905697390437126, 0.053880538791418076, -0.022943943738937378, 0.021155377849936485, -0.03761577233672142, -0.03152346983551979, -0.03169114887714386, -0.05346134677529335, -0.019269000738859177, -0.0337032824754715, -0.022189391776919365, 0.0054949489422142506, -0.01454606931656599, 0.051784563809633255, -0.041164956986904144, 0.002083748811855912, -0.02386617287993431, 0.029315708205103874, 0.021029619500041008, -0.018863778561353683, -0.021658411249518394, -0.0066931480541825294, -0.007091383449733257, 0.06902745366096497, 0.023111620917916298, 0.01931091956794262, 0.018011415377259254, 0.0019003510242328048, 0.01826293207705021, -0.06667996197938919, 0.012443107552826405, -0.0688597783446312, 0.022762292996048927, -0.005365696735680103, -0.06897155940532684, -0.02559884637594223, -0.0047089578583836555, -0.0020296028815209866, -0.029651064425706863, -0.04714547097682953, -0.00713679613545537, 0.030377669259905815, 0.030182044953107834, 0.018025388941168785, 0.01722891815006733, 0.029734903946518898, -0.0351564921438694, -0.009466822259128094, -0.01657217927277088, -0.0027771673630923033, 0.03730836138129234, -0.023405058309435844, -0.028896514326334, -0.048822253942489624, 0.04611145704984665, -0.01810922659933567, 0.013875356875360012, -0.02417358197271824, -0.005030340980738401, -0.028435399755835533, -0.05156099423766136, -0.034569621086120605, 0.03985147923231125, -0.0806531310081482, -0.0005244304775260389, -0.02488621510565281, -0.0018287384882569313, -0.03968380019068718, 0.05935802310705185, 0.0029168990440666676, -0.025696657598018646, -0.03633023798465729, 0.022580640390515327, -0.005620707292109728, -0.03261337801814079, -0.027960311621427536, 0.03459756821393967, 0.004722930956631899, -0.04423905164003372, 0.045189227908849716, 0.031802933663129807, -0.00207152240909636, 0.018947618082165718, 0.014643881469964981, 0.03389890864491463, -0.0023370124399662018, 0.029203923419117928, -0.07841742783784866, -0.03191471844911575, 0.012317348271608353, 0.003975366707891226, -0.03538006544113159, -0.005281858146190643, -0.02870089001953602, -0.006438137497752905, -0.025319382548332214, 0.016390526667237282, -0.03574336692690849, -0.04938117787241936, -0.013337389566004276, 0.006501017138361931, 0.0033989734947681427, 0.01620887592434883, -0.0476764515042305, -0.02976285107433796, 0.00361206429079175, -0.006368272006511688, 0.00019868099479936063, 0.04155620560050011, 0.050415195524692535, -0.0008851129096001387, 0.05796070396900177, -0.003442639485001564, -0.017354676499962807, -0.02364260144531727, 0.0449097640812397, 0.0526229552924633, -0.034373994916677475, 0.02886856719851494, 0.024942107498645782, 0.008453767746686935, 0.009033653885126114, -0.09026667475700378, 0.007028504274785519, -0.011527864262461662, -0.011961032636463642, -0.012009939178824425, -0.05164483189582825, 0.004502853844314814, 0.03512854874134064, 0.0366097018122673, 0.04538485407829285, 0.03496086969971657, -0.026940269395709038, -0.026772592216730118, -0.08227401971817017, -0.004104618448764086, 0.042925573885440826, 0.06304693967103958, -0.0012165390653535724, 0.03851005434989929, 0.017550300806760788, 0.022189391776919365, -0.017438514158129692, 0.027331518009305, 0.001656693872064352, -0.004897595848888159, 0.022049661725759506, -0.07238101959228516, 0.006448617670685053, 0.006780480500310659, -0.007650310173630714, -0.0065813628025352955, 0.02527746371924877, -0.04966064170002937, 0.013847410678863525, -0.04524512216448784, -0.009194345213472843, -0.05083438754081726, 0.0010139280930161476, -0.005250418093055487, 0.03954406827688217, -0.03518443927168846, -0.007259061560034752, 0.0065988292917609215, -0.022189391776919365, -0.04384780302643776, 0.017173025757074356, -0.018542395904660225, 0.023894120007753372, -0.029706956818699837, -0.039795584976673126, -0.03574336692690849, -0.020596452057361603, 0.017829764634370804, 0.016753830015659332, -0.010640568099915981, -0.05569705367088318, -0.000693855166900903, -0.018165118992328644, 0.01827690564095974, -0.014853478409349918, 0.007873880676925182, -0.028072096407413483, 0.012296388857066631, -0.031216058880090714, -0.02056850492954254, -0.022902024909853935, -0.027080001309514046, -0.0008763797231949866, 0.016474366188049316, 0.012296388857066631, 0.028672942891716957, -0.04247843474149704, -0.04924144968390465, 0.00047465108218602836, 0.011269360780715942, -0.032445698976516724, -0.04426699876785278, -0.02174225077033043, 0.0311881136149168, 0.0362464003264904, 0.0011955793015658855, 0.016111064702272415, 0.011017844080924988, -0.01184226106852293, 0.01261777151376009, -0.013316430151462555, 0.02886856719851494, 0.0334797129034996, -0.024928133934736252, 0.06617692857980728, -0.02870089001953602, 0.009941909462213516, 0.014210713095963001, 0.025696657598018646, -0.026409288868308067, 0.010584675706923008, 0.001723939785733819, 0.04544074460864067, 0.005379670299589634, 0.011898153461515903, -0.01200295239686966, 0.055082231760025024, 0.01738262176513672, 0.029203923419117928, 0.0032278019934892654, 0.018234984949231148, -0.011968019418418407, -0.021378949284553528, 0.0022147472482174635, -1.2260637049621437e-05, 0.042198970913887024, 0.0024505446199327707, -0.0414164736866951, 0.06399711221456528, -0.014727720059454441, 0.0013222111156210303, -0.039460230618715286, -0.042534325271844864, -0.08769560605287552, -0.020121363922953606, 0.02892445959150791, 0.03730836138129234, -0.010151507332921028, 0.0031160167418420315, 0.0011396865593269467, -0.020778102800250053, -0.01391727663576603, 0.0034740790724754333, -0.033870961517095566, 0.004946501925587654, -0.0007204915164038539, -0.010451930575072765, 0.018514448776841164, -0.013295470736920834, 0.04619529843330383, 0.017354676499962807, 0.031216058880090714, -0.08680132776498795, -0.018877752125263214, -0.030349723994731903, -0.0029151523485779762, -0.03152346983551979, 0.02056850492954254, 0.01952051743865013, 0.006473070476204157, 0.045189227908849716, 0.031942665576934814, -0.005966543219983578, -0.009306130930781364, 0.023391084745526314, 0.047927968204021454, 0.004775330424308777, 0.014008102007210255, -0.013016006909310818, 0.0066058156080543995, -0.008390887640416622, 0.012561879120767117, -0.026045987382531166, 0.01539843250066042, 0.00818827748298645, 0.00569755956530571, 0.036665596067905426, 0.03183088079094887, -0.017466461285948753, -0.006521976552903652, 0.0027771673630923033, 0.0008056405349634588, -0.0006842486327514052, 0.036274347454309464, -0.02016328275203705, 0.021658411249518394, -0.07059244811534882, 0.017438514158129692, 0.03621845319867134, 0.025542953982949257, -0.008600485511124134, 0.019799981266260147, -0.019967658445239067, 0.009103519842028618, -0.014057008549571037, -0.017326729372143745, -0.014937317930161953, -0.007091383449733257, 0.009292157366871834, -0.011094695888459682, -0.030517401173710823, 0.0026863417588174343, -0.005274871364235878, 0.003881047712638974, -0.04370807483792305, 0.01226145587861538, -0.002246186835691333, 0.02734549157321453, -0.025738578289747238, 0.06394122540950775, 0.027107948437333107, 0.0638294368982315, -0.04085754603147507, -0.009068586863577366, -0.08216223120689392, 0.013644799590110779, -0.06768602877855301, -0.009250237606465816, -0.028058122843503952, 0.02439715340733528, 0.03029382973909378, 0.024578804150223732, 0.054579198360443115, -0.05818427726626396, 0.03012615256011486, -0.020778102800250053, 0.002242693677544594, -0.011604717001318932, 0.013253550976514816, 0.027066027745604515, 0.02245488204061985, 0.04264611378312111, -0.02491416037082672, -0.018165118992328644, -0.02631147764623165, -0.025696657598018646, -0.02854718454182148, 0.009445861913263798, 0.007650310173630714, -0.002927378984168172, 0.019967658445239067, -0.028281694278120995, -0.017983468249440193, 0.04890609160065651, 0.044127266854047775, -0.03062918595969677, -0.05723410099744797, -0.020470691844820976, 0.003175402758643031, 0.015118968673050404, 0.0004986674757674336, 0.012114737182855606, 0.004066192079335451, -0.00374131603166461, -0.006770000327378511, -0.02139292098581791, -0.057010531425476074, -0.019282974302768707, -0.018947618082165718, -0.015384458936750889, 0.023544790223240852, -0.009550660848617554, -0.01105976291000843, 0.02768084779381752, 0.05488660931587219, -0.012904222123324871, 0.005327270831912756, -0.053712863475084305, 0.07769081741571426, -0.014797586016356945, 0.06198497861623764, -0.02021917514503002, 0.013553974218666553, -0.025123758241534233, -0.02213349938392639, -0.011905140243470669, 0.00304440432228148, 0.046055566519498825, 0.009613540023565292, -0.007143782917410135, -0.01931091956794262, 0.011835274286568165, 0.0004606779257301241, -0.03225007280707359, -0.009983829222619534, -0.0366097018122673, -0.056339818984270096, -0.004181470721960068, 0.05273474007844925, -0.022762292996048927, -0.001112613594159484, -0.009879030287265778, 0.03155141696333885, -0.0638294368982315, -0.01827690564095974, 0.03599488362669945, 0.04926939308643341, 0.06394122540950775, 0.04124879464507103, 0.0073219407349824905, -0.02506786584854126, 0.019604356959462166, 0.00030959301511757076, -0.037671662867069244, 0.05745767056941986, -0.016390526667237282, -0.013903303071856499, 0.005264391656965017, 0.029706956818699837, 0.02087591402232647, -0.026353396475315094, -0.006350805517286062, 0.026521075516939163, -0.025864336639642715, -0.011954045854508877, 0.04488182067871094, 0.025976121425628662, 0.03990736976265907, -0.0018200052436441183, -0.04144442081451416, -0.02055453136563301, 0.0072241285815835, -0.008111424744129181, -0.016111064702272415, -0.010123561136424541, 0.022049661725759506, -0.004153524525463581, -0.0005624200566671789, -0.01949257031083107, 0.016809722408652306, -0.016236823052167892, 0.051784563809633255, -0.031048381701111794, -0.016642045229673386, -0.027080001309514046, 0.020680289715528488, 0.016125036403536797, -0.01539843250066042, -0.037503987550735474, -0.08165919780731201, -0.03599488362669945, -0.029651064425706863, 0.009033653885126114, 0.001158899744041264, 0.01149293128401041, -0.0024715042673051357, -0.0379231795668602, -0.02069426327943802, 0.002213000552728772, -0.010312198661267757, -0.025151703506708145, -0.008069504983723164, 0.027722766622900963, 0.013826451264321804, 0.01929694600403309, -0.02822580188512802, 0.03426221013069153, -0.020456720143556595, 0.045161280781030655, -0.003667956916615367, -0.00896378792822361, -0.010640568099915981, 0.022720372304320335, -0.04334476962685585, -0.021895956248044968, 0.004261816386133432, -0.03605077788233757, -0.0005143872695043683, -0.0026426755357533693, -0.013616853393614292, 0.009473809041082859, 0.018374716863036156, 0.020135337486863136, -0.006860826164484024, -0.024299340322613716, 0.012310362420976162, -0.004296749364584684, 0.028449371457099915, 0.006239019799977541, -0.009557647630572319, 0.03884540870785713, 0.03895719721913338, -0.034066587686538696, 0.0049604750238358974, 0.03484908491373062, -0.03462551161646843, 0.008453767746686935, -0.013169711455702782, 0.01496526412665844, -0.00913845282047987, 0.027093974873423576, 0.0027073014061897993, -0.01724288985133171, -0.034066587686538696, -0.012498999945819378, 0.00799963902682066, -0.037895236164331436, 0.0005803231615573168, 0.00828608963638544, 0.039599962532520294, -0.04242254048585892, 0.0347931906580925, 0.05919034406542778, -0.0362464003264904, 0.024788402020931244, -0.018710073083639145, -0.032110340893268585, -0.0017955522052943707, 0.0024872240610420704, -0.018332798033952713, 0.009292157366871834, -0.0494929663836956, 0.017200971022248268, 0.005218978505581617, 0.020973727107048035, -0.026730673387646675, -0.02040082775056362, 0.04910171777009964, 0.002581543056294322, -0.005578787997364998, 0.008956801146268845, -0.0036819300148636103, 0.015524190850555897, -0.028100043535232544, -0.02716384083032608, -0.01488142553716898, -0.04088549315929413, -0.024592777714133263, -0.0012418654514476657, 0.015803653746843338, 0.03672148659825325, -0.019087348133325577, -0.037000950425863266, -0.01581762731075287, 0.00670362776145339, -0.002277626655995846, 0.007042477373033762, -0.0016523272497579455, 0.006829386577010155, -0.0015213288133963943, -0.030182044953107834, 0.005348230246454477, -0.06528264284133911, 0.003283694852143526, 0.01435044500976801, 0.01707521267235279, 0.03954406827688217, -0.0016759069403633475, 0.020638370886445045, -0.0023929052986204624, 0.013449175283312798, -0.009089546278119087, 0.002221733797341585, 0.011814314872026443, 0.001519582117907703, -0.02386617287993431, 0.006874799262732267, -0.025305408984422684, 0.006556909531354904, -0.003468839218840003, -0.00862843170762062, -0.028980351984500885, -0.013777544721961021, -0.036665596067905426, 0.01585954613983631, 0.03747604042291641, 0.017326729372143745, 0.016753830015659332, -0.0233631394803524, 0.017662085592746735, -0.01634860783815384, -0.0032802014611661434, -0.058072492480278015, -0.008020599372684956, -0.02527746371924877, 0.005421589594334364, 0.024970052763819695, 0.051477156579494476, 0.0022933464497327805, 0.05941391363739967, 0.002118681790307164, -0.006969118025153875, -0.0375598780810833, -0.016055170446634293, 0.03252953663468361, -0.029315708205103874, 0.017019320279359818, -0.007143782917410135, -0.0033413341734558344, -0.05499839410185814, -0.02784852683544159, 0.013190671801567078, -0.02195184864103794, -0.012708596885204315, -0.06394122540950775, -0.02471853606402874, -0.026702726259827614, -0.016083117574453354, 0.05379670113325119, -0.0010017015738412738, -0.010766326449811459, -0.007811001501977444, -0.006008462514728308, -0.01061960868537426, -0.020330961793661118, -0.02262256108224392, -0.010053695179522038, 0.00430373614653945, -0.0017876923084259033, 0.05164483189582825, -0.014105914160609245, -0.0625998005270958, -0.013693706132471561, 0.004499360453337431, -0.016949454322457314, -0.003568398067727685, -0.038565948605537415, -0.01915721409022808, -0.01724288985133171, 0.0401029959321022, 0.04245048761367798, -0.0018951110541820526, -0.01707521267235279, 0.011716502718627453, -0.012841342017054558, 0.0075035919435322285, 0.009851084090769291, -0.004632105585187674, 0.003196362406015396, 0.019981632009148598, 0.015929412096738815, -0.025515006855130196, -0.019269000738859177, -0.0019684701692312956, -0.009285170584917068, 0.02091783471405506, -0.01086413860321045, -0.030237937346100807, -0.03831442818045616, -0.006116754841059446, -0.03099248930811882, -0.009208318777382374, 0.02000957727432251, 0.009075573645532131, -0.02421550266444683, -0.04477003216743469, -0.014378391206264496, 0.03320024907588959, -0.022175420075654984, 0.03135579079389572, -0.014727720059454441, 0.0030513908714056015, 0.028952406719326973, 0.009173385798931122, -0.019925739616155624, 0.0111366156488657, -0.004897595848888159, -0.008132384158670902, 0.02836553379893303, 0.027932364493608475, 0.004481893964111805, -0.004118591547012329, -0.02508183941245079, 0.013546987436711788, -0.007412766106426716, 0.0067176008597016335, 0.01789962872862816, -0.010228360071778297, 0.005267884582281113, 0.009410928934812546, -0.02629750408232212, 0.018598288297653198, -0.00048425764543935657, 0.025850363075733185, -0.02664683386683464, 0.005404123105108738, 0.00744071276858449, -0.0025501034688204527, -0.035575687885284424, -0.003378013614565134, 0.015803653746843338, -0.0037168629933148623, -0.0054949489422142506, 0.007210155483335257, 0.018668154254555702, 0.03138373792171478, 0.06835674494504929, -0.02508183941245079, 0.02351684309542179, 0.0054949489422142506, 0.0025099304039031267, 0.012547905556857586, -0.025165677070617676, -0.00880309659987688, 0.013043953105807304, -0.010053695179522038, -0.005910650361329317, -0.015412405133247375, -0.011646636761724949, 0.0037867287173867226, 0.005103699862957001, -0.014490175992250443, -0.004321202635765076, 2.3429620341630653e-05, -0.019883818924427032, 0.029008299112319946, 0.0002842666581273079, 0.032473646104335785, -0.04398753494024277, -0.13045351207256317, -0.04504949599504471, 0.017983468249440193, 0.00019835350394714624, 0.00039496037061326206, 0.005791878793388605, 0.055585265159606934, 0.03146757557988167, -0.03079686500132084, 0.0009362023556604981, 0.018039360642433167, -0.04463030397891998, 0.005358710419386625, -0.0056661199778318405, 0.004604159388691187, -0.04507744312286377, -0.005264391656965017, -0.002719528041779995, 0.010940991342067719, -0.026590941473841667, -0.012016925029456615, -0.008663364686071873, 0.0065534161403775215, 0.02368452213704586, -0.0609230175614357, -0.003126496681943536, 0.03225007280707359, 0.0001861269847722724, -0.002328279195353389, -0.0038915276527404785, -0.016949454322457314, 0.016460392624139786, 0.017466461285948753, 0.01669793762266636, -0.05385259538888931, -0.014322497881948948, -0.01340725552290678, 0.010822219774127007, 0.006039902567863464, 0.008642405271530151, 0.011304293759167194, -0.023083675652742386, 0.03359149768948555, -0.03289284184575081, 0.03412247821688652, -0.045189227908849716, 0.004698478151112795, -0.020638370886445045, 0.006521976552903652, 0.02087591402232647, 0.021714305505156517, -0.04183566942811012, 0.006123741157352924, 0.002162348013371229, 0.006204087287187576, 0.016656016930937767, 0.013302456587553024, -0.014420310966670513, -0.006102781742811203, -0.017354676499962807, -0.015552137047052383, 0.0375598780810833, 0.02470456250011921, -0.0245648305863142, -0.04147236421704292, -0.017634140327572823, 0.007531538140028715, 0.02207760699093342, -0.01453209575265646, -0.051449209451675415, -0.022580640390515327, 0.03434605151414871, 0.018025388941168785, 0.009969856590032578, -0.004471414256840944, 0.0001765204215189442, 0.02193787507712841, 0.024508938193321228, -0.043959591537714005, 0.0331164114177227, 0.03744809329509735, -0.04233870282769203, 0.04208718612790108, 0.04183566942811012, 0.02544514089822769, 0.037140682339668274, 0.010577688924968243, -0.013700691983103752, -0.00149250915274024, -0.0016636804211884737, 0.02470456250011921, -0.03965585306286812, 0.004827729891985655, -0.024606751278042793, -0.021812116727232933, -0.029008299112319946, -0.014937317930161953, 0.008579526096582413, -0.0056486534886062145, -0.005337750539183617, 0.018570341169834137, 0.0023614654783159494, -0.047648508101701736, -0.0189615897834301, 0.010144520550966263, 0.022147472947835922, 0.00552638852968812, -0.011863220483064651, 0.02626955881714821, -0.013302456587553024, 0.0026059960946440697, 0.017983468249440193, 0.004733411129564047, 0.03462551161646843, -0.04197540134191513, 0.02661888673901558, 0.05340545251965523, 0.0072870077565312386, 0.008425820618867874, 0.021267162635922432, 0.007025010883808136, 0.022203365340828896, -0.015091022476553917, 0.02453688532114029, -0.0013667505700141191, -0.0011396865593269467, -0.016264768317341805, 0.031802933663129807, -0.03099248930811882, 0.008635418489575386, 0.038398269563913345, -0.015244727954268456, -0.001973710022866726, -0.008062518201768398, -0.010661528445780277, 0.007971692830324173, 0.03135579079389572, 0.005334257148206234, 0.0009082559845410287, 0.02367054857313633, -0.007790041621774435, 0.015314592979848385, 0.027038082480430603, 0.022021714597940445, -0.010563716292381287, 9.617470641387627e-05, 0.02508183941245079, -0.029036246240139008, -2.8846952773164958e-05, 0.009033653885126114, 0.02819785475730896, -0.013896316289901733, -0.0017414061585441232, 0.012394201010465622, -0.01105277705937624, 0.001656693872064352, 0.0015405418816953897, -0.005997982807457447, 0.0033151344396173954, 0.007734149228781462, 0.007384819909930229, 0.04108111560344696, -0.02297189086675644, -0.031774986535310745, 0.03912487253546715, -0.023950012400746346, -0.023782333359122276, 0.010444943793118, 0.032976679503917694, 0.00844678096473217, -0.012540919706225395, -0.04295352101325989, 0.021378949284553528, -0.008740217424929142, 0.043763965368270874, 0.009103519842028618, -0.015873519703745842, 0.004450454376637936, -0.022706400603055954, 0.047788240015506744, -0.0026601420249789953, 0.041332636028528214, -0.021448815241456032, -0.009103519842028618, 0.045692261308431625, -0.06388533115386963, -0.007252074778079987, 0.0020296028815209866, 0.01034713163971901, 0.038565948605537415, 0.014657854102551937, 0.018751993775367737, 0.00957162119448185, 0.021854037418961525, 0.0003670140285976231, -0.01054275594651699, 0.04085754603147507, 0.020778102800250053, -0.01707521267235279, -0.04180772230029106, -0.0007431979174725711, 0.0518963485956192, 0.005288844462484121, -0.017801817506551743, -0.003884541103616357, 0.03549185022711754, 0.01045891735702753, -0.04004710167646408, 0.0005846897838637233, 0.011457998305559158, -0.011115656234323978, 0.02611585333943367, -0.011604717001318932, 0.011618690565228462, 0.003533465089276433, -0.04488182067871094, -0.004150031134486198, 0.0005829431465826929, -0.018360743299126625, -0.020806048065423965, -0.007992653176188469, -0.008698297664523125, 0.00674904091283679, -0.006053875666111708, 0.00709487684071064, -0.024494964629411697, 0.03859389200806618, -0.014084954746067524, 0.02610187977552414, 0.03322819620370865, -0.015132942236959934, -0.011933086439967155, 0.005079247057437897, 0.01742454245686531, -0.006462590768933296, -0.024830320850014687, 0.007217141799628735, 0.0024505446199327707, -0.02192390151321888, 0.0025046905502676964, 0.04549663886427879, 0.025892281904816628, 0.003117763437330723, -0.009299144148826599, 0.02195184864103794, 0.01742454245686531, 0.023111620917916298, 0.048654574900865555, -0.03532417118549347, 0.010612621903419495, -0.0058652376756072044, 0.005383163224905729, 0.002654902171343565, 0.003147456329315901, 0.0026880884543061256, -0.014462229795753956, -0.00828608963638544, 0.03878951817750931, 0.04558047652244568, 0.019534491002559662, -0.03328409045934677, 0.0397396944463253, -0.004572719801217318, -0.004576212726533413, 0.004663545172661543, -0.012883261777460575, -0.0007218015380203724, 0.015077049843966961, 0.05270679295063019, 0.002064535627141595, -0.02942749485373497, 0.02608790621161461, -0.004356135614216328, 0.034569621086120605, 0.003416439751163125, 0.0012156657176092267, 0.04055013507604599, -0.014769639819860458, 0.038174696266651154, -0.003947420045733452, -0.008698297664523125, 0.00210820185020566, -0.005138632841408253, 0.01707521267235279, 0.009983829222619534, -0.018919670954346657, -0.011548824608325958, -0.0048382095992565155, 0.013337389566004276, 0.0027527143247425556, 0.02663286030292511, 0.05239938572049141, -0.007629350293427706, -0.006364778615534306, -0.0023020796943455935, -0.00020905170822516084, -0.012408174574375153, -0.004408535081893206, 0.012058844789862633, -0.030321776866912842, 0.015985306352376938, 0.021281136199831963, 0.014769639819860458, -0.03378712385892868, 0.02156060002744198, 0.004611145704984665, 0.003386746859177947, -0.02073618210852146, -0.0009082559845410287, -0.0011344467056915164, -0.009334077127277851, -0.01912926882505417, 0.01929694600403309, 0.02158854715526104, -0.01789962872862816, -0.009382982738316059, -0.0037098764441907406, -0.01218460313975811, -0.003954406827688217, 0.01739659532904625, 0.0010017015738412738, -0.009983829222619534, 0.008020599372684956, 0.017480434849858284, -0.02491416037082672, -0.012932168319821358, 0.012988060712814331, -0.0032260555308312178, 0.005348230246454477, -0.01156978402286768, -0.003138723084703088, 0.011185522191226482, 0.014671827666461468, -0.019464625045657158, -0.054774824529886246, 0.016250794753432274, -0.035938989371061325, -0.013295470736920834, -0.02714986726641655, -0.04004710167646408, 0.03638613224029541, 0.02054055780172348, -0.008761176839470863, -0.023572735488414764, 0.009459835477173328, 0.024620724841952324, -0.01706123910844326, 0.018137173727154732, 0.011457998305559158, -0.00894981436431408, 0.07433725893497467, -0.03188677132129669, -0.02207760699093342, 0.01453209575265646, 0.0003624290693551302, 0.017159052193164825, -0.010214386507868767, -0.017648112028837204, -0.021323056891560555, 0.023181486874818802, -0.010906058363616467, 0.0010034481529146433, -0.009739299304783344, -0.004146537743508816, 0.01564995013177395, 0.003194615710526705, -0.010423984378576279, 0.0247464831918478, 0.038733623921871185, -0.017159052193164825, 0.01686561480164528, 0.0018409650074318051, -0.0029064191039651632, 0.009564634412527084, 0.0007209281902760267, 0.00949476845562458, -0.010647554881870747, -0.006232033483684063, 0.01672588288784027, 0.02681451104581356, -0.003811181988567114, -0.05103001371026039, -0.04071781411767006, -0.012366254813969135, -0.005358710419386625, -0.0015885746106505394, -0.024620724841952324, 0.04041040688753128, -0.021504707634449005, -0.02995847538113594, 0.003004231257364154, 0.0007021517376415431, 0.014070981182157993, 0.005529881455004215, -0.012387214228510857, 0.009026667103171349, 0.015733787789940834, 0.0004672278300859034, -0.00957860704511404, 0.011478958651423454, 0.02749919705092907, -0.023069702088832855, 0.01756427437067032, -0.014238659292459488, 0.009781218133866787, -0.0006742054247297347, 0.0032260555308312178, 0.02353081665933132, 0.027415357530117035, 0.011499918065965176, -0.028449371457099915, 0.001647960627451539, -0.027066027745604515, 0.005585774313658476, 0.0007746375631541014, -0.02178417146205902, -0.021644439548254013, 0.019269000738859177, -0.021700331941246986, 0.050191622227430344, -0.009725325740873814, 0.01829087920486927, -0.027792632579803467, -0.024285368621349335, 0.021378949284553528, -0.009459835477173328, 0.0002176757698180154, 0.008796109817922115, 0.0012505985796451569, 0.023195460438728333, -0.010430971160531044, 0.011709515936672688, -0.02418755553662777, -0.0019929232075810432, -0.014727720059454441, 0.016418473795056343, 0.009795191697776318, -0.02714986726641655, -0.0434565544128418, 0.024257421493530273, 0.0015623749932274222, 0.00030282477382570505, 0.04700573906302452, 0.02435523457825184, -0.007122823037207127, -0.0012540919706225395, -0.007182208821177483, 0.01564995013177395, 0.009313116781413555, -0.00144622300285846, -0.00431421585381031, -0.009606554172933102, -0.005016367882490158, 0.014252632856369019, -0.012163643725216389, -0.0036015843506902456, -0.03222212940454483, -0.002918645739555359, 0.0014540828997269273, 0.007056450471282005, 0.008118411526083946, -0.0019510036800056696, 0.02561281807720661, 0.03261337801814079, -0.006672188173979521, 0.0275131706148386, 0.0037483025807887316, 0.048319220542907715, 0.004485387355089188, 0.0067001343704760075, 0.015132942236959934, 0.01514691486954689, -0.0003606824320740998, 0.013113819062709808, 0.01052179653197527, 0.02040082775056362, -0.008111424744129181, -0.005449535790830851, -0.006888772360980511, -0.008418834768235683, -0.012680650688707829, 0.005809345282614231, 0.014797586016356945, -0.02244091033935547, 0.020107390359044075, 0.04270200431346893, 0.0034897990990430117, -0.027624955400824547, -0.004988421220332384, -0.004370108712464571, 0.013477121479809284, 0.021197296679019928, -0.021658411249518394, 0.0181232001632452, -0.015454324893653393, -0.03982353210449219, 0.005781398620456457, -0.02578049711883068, 0.017997441813349724, 0.02735946513712406, 0.003425172995775938, -0.023391084745526314, 0.0025431166868656874, 0.019744088873267174, -0.010857152752578259, -0.00809046532958746, -0.010018762201070786, -0.030601240694522858, -0.0057779052294790745, 0.020316988229751587, 0.022426936775445938, -0.022552695125341415, -0.016152983531355858, 0.039404336363077164, 0.02316751517355442, -0.03722452372312546, -0.02942749485373497, -0.007168235722929239, 0.019604356959462166, -0.0014488429296761751, -0.003884541103616357, 0.015132942236959934, 0.010382064618170261, 0.006514990236610174, -0.025361301377415657, -0.015468298457562923, -0.021504707634449005, 0.03258543089032173, -0.03800702095031738, -0.00509322015568614, 0.014057008549571037, 0.013197658583521843, 0.01933886669576168, 0.02038685418665409, 8.302027708850801e-05, 0.02526349015533924, 0.023726440966129303, 0.011423065327107906, 0.0014767893590033054, 0.01967422291636467, -0.020414799451828003, -0.012401187792420387, 0.016809722408652306, 0.004150031134486198, 0.020833995193243027, 0.05033135414123535, 0.004195443820208311, -0.004681011661887169, 0.01687958836555481, -0.01514691486954689, -0.017620166763663292, -0.01400111522525549, -0.005763932131230831, -0.0004373165138531476, -0.014671827666461468, 0.018011415377259254, -0.013630826026201248, -0.016656016930937767, 0.007755108643323183, 0.017815791070461273, 0.027764687314629555, -0.007419752888381481, 0.006225046701729298, 0.00443298788741231, -0.007098369766026735, 0.0006126361549831927, 0.002190294209867716, 0.017131105065345764, -0.025542953982949257, -0.00483471667394042, 0.0031596829649060965, -0.014203726314008236, 0.03811880573630333, -0.01287627499550581, -0.006549923215061426, -0.014126873575150967, -0.003881047712638974, 0.040689866989851, 0.009592580609023571, -0.0006611055578105152, 0.0027422343846410513, -0.0337032824754715, 0.004439974669367075, 0.008153344504535198, -0.007929773069918156, 0.012561879120767117, -0.0014593228697776794, -0.005250418093055487, 0.00635779183357954, 0.021868009120225906, -0.051980189979076385, 0.024299340322613716, -0.014741693623363972, -0.011045790277421474, -0.02021917514503002, 0.07187797874212265, 0.01462990790605545, 0.02783455327153206, -0.011695542372763157, 0.016152983531355858, 0.008572539314627647, -0.003140469780191779, -0.019366811960935593, -0.02207760699093342, 0.024634696543216705, -0.02002355083823204, -0.010465903207659721, -0.0255848728120327, -0.023069702088832855, 0.015887493267655373, -0.05052698031067848, -0.021183324977755547, -0.014301538467407227, 0.007608390413224697, 0.0012741783866658807, 0.015971332788467407, -0.011975006200373173, -0.008062518201768398, -0.014294551685452461, -0.020512612536549568, -0.009445861913263798, 0.017690032720565796, 0.010556729510426521, 0.010731393471360207, 0.0027160346508026123, 0.022720372304320335, 0.020470691844820976, 0.0049080755561590195, 0.0123732415959239, -0.03814675286412239, 0.024578804150223732, -0.007517565041780472, -0.012310362420976162, -0.023083675652742386, 0.017885657027363777, 0.01411290094256401, -0.013777544721961021, -0.02125319093465805, -0.02225925773382187, 0.007748122327029705, -0.03621845319867134, 0.008754190057516098, -0.003529971931129694, -0.01773195154964924, -0.02801620401442051, 0.013896316289901733, 0.014476203359663486, -0.033870961517095566, -0.019101321697235107, 0.016278741881251335, -0.006148194428533316, -0.016809722408652306, 0.02017725631594658, 0.007804014720022678, 0.05192429572343826, 0.02333519235253334, -0.004869649652391672, 0.029287762939929962, -0.015943385660648346, 0.011912127025425434, 0.008244169875979424, 0.01585954613983631, -0.025654738768935204, 0.009851084090769291, 0.0017938056262210011, 0.03289284184575081, -0.029818743467330933, 0.001282038283534348, -0.03842621669173241, -0.0012750517344102263, -0.04524512216448784, -0.013022993691265583, 0.0017518860986456275, -0.005879210773855448, 0.04597172513604164, 0.02749919705092907, 0.004621625877916813, 0.037168629467487335, 0.02225925773382187, -0.02993052825331688, 0.037140682339668274, 0.015426378697156906, 0.02248282916843891, 0.022874077782034874, 0.012478039599955082, 0.003814675146713853, -0.02330724522471428, -0.0048312232829630375, 0.01949257031083107, -0.0247464831918478, -0.029567226767539978, 0.002874979516491294, 0.012554892338812351, 0.0200514979660511, -0.0390130877494812, 0.02364260144531727, -0.013505067676305771, -0.006682668346911669, 0.01070344727486372, 0.0074337259866297245, 0.00923626497387886, 0.03605077788233757, -0.014671827666461468, 0.005376176908612251, 0.01655820570886135, 0.015118968673050404, 0.011898153461515903, -0.001987683353945613, -0.018500475212931633, 0.0033273608423769474, -0.01653025858104229, -0.02122524380683899, 0.0222732312977314, 0.027736740186810493, -0.030768917873501778, 0.022776266559958458, -0.000939695630222559, -0.02783455327153206, 0.008307049050927162, -0.01742454245686531, 0.002274133265018463, 0.03250158950686455, 0.028407452628016472, 0.0017658591968938708, -0.020778102800250053, -0.01227542944252491, 0.012464066967368126, -0.03082481026649475, 0.021281136199831963, 0.007734149228781462, 0.012464066967368126, -0.002169334562495351, -0.02611585333943367, -0.015021156519651413, -0.007052957080304623, 0.012834356166422367, -0.004705464467406273, 0.031216058880090714, -0.018863778561353683]",Model Alignment as Prospect Theoretic Optimization.pdf
"0-shot
Metric ( →) EM EM pass@1 EM F1 % Win
SFT 57.2 1.0 54.4 33.2 25.4 7.17 29.7
KTO ( β= 0.1) 57.8 12.5 53.2 29.5 28.0 5.46 31.1
KTO ( β= 0.01)57.3 1.5 53.7 33.4 26.5 5.31 29.6
Figure 6. AlpacaEval 2 winrates of Mistral7B aligned with various methods on the OpenAssistant dataset. GPT-4-turbo with chain-of-
thought is used as the LM judge. KTO outperforms the SFT and DPO-aligned models at all temperatures.
Table 4. Results from aligning Zephyr- β-SFT (Tunstall et al., 2023) on UltraFeedback. Note that the base model had not been finetuned
on UltraFeedback but a similar dataset called UltraChat; the first row here denotes the finetuning results. All the methods below see
exactly 1 epoch of UltraFeedback, for an apples-to-apples comparison. AlpacaEval 2 was run using GPT4 Turbo CoT as the LM judge.
All evaluations were run with sampling temperature 0.7. Among the KTO variants: “one- y-per-x” denotes training standard KTO with
either the positive or negative output (not both); “no z0” refers to a constant reference point of 0; “concave” refers to a variant where the
human value function is concave in the loss regime (i.e., minimize −log(·)instead of 1−(·)); “no πref” refers to a reference model-free
variant; “risk-neutral” refers to a variant where the human value function is just the identity function, implying risk neutrality.
Dataset ( →) MMLU GSM8k HumanEval BBH TydiQA AlpacaEval 2 Avg.
Setup ( →) 0-shot 8-shot, CoT 0-shot, Synth. 3-Shot, CoT 1-Shot, GP 0-shot
Metric ( →) EM EM pass@1 EM F1 % Win
SFT 57.2 39.0 30.1 46.3 36.3 6.4 35.9
DPO 58.2 40.0 30.1 44.1 36.5 7.8 36.1
ORPO ( λ= 0.1) 57.1 36.5 29.5 47.5 38.5 5.0 35.7
KTO 58.6 53.5 30.9 52.6 31.2 12.5 39.9
KTO (one- y-per-x) 58.0 50.0 30.7 49.9 37.7 11.6 39.7
KTO (no z0) 58.5 49.5 30.7 49.0 29.0 12.1 38.1
KTO (concave) 58.3 42.5 30.6 43.2 36.6 7.4 36.4
KTO (no πref,λD= 1.75)57.5 47.5 29.5 51.6 36.8 9.7 38.8
KTO (risk-neutral) 57.3 42.0 28.8 6.1 33.6 10.3 29.7
17
Model Alignment as Prospect Theoretic Optimization
Prompt <|user|>
I need some show recommendations that are similar to Breaking Bad.
<|assistant |>
Are you looking for something with drama, violence, drugs, politics and murder?
<|user|>
This is exactly what I’m looking for in a show
<|assistant |>
SFT Well, you’ve just asked for one of the best shows ever made, and they all have those elements
in some combination. There are a lot of shows with those elements.
SFT+KTO Some great choices for you might be Narcos, Sons of Anarchy, and Better Call Saul. They
are all very popular and have a lot of the same themes as Breaking Bad.
SFT+DPO Well, you might like *******, which is also a dark, suspenseful drama","[-0.02852032333612442, 0.01690123975276947, -0.01724175550043583, 0.01725836656987667, -0.024500569328665733, -2.5710673071444035e-05, 0.020530646666884422, 0.04003143683075905, 0.041426725685596466, 0.0034196979831904173, 0.020929299294948578, -0.024866001680493355, -0.037872064858675, -0.004659260623157024, 0.035513367503881454, -0.029018640518188477, -0.017972620204091072, -0.04797128215432167, -0.02719147875905037, 0.05601079389452934, 0.011859936639666557, -0.006021326407790184, -0.0031643107067793608, 3.9385184209095314e-05, 0.022839512676000595, -0.004518071189522743, -0.03220786526799202, 0.03641033545136452, 0.02604535035789013, -0.0038038170896470547, 0.04086196422576904, -0.0327560156583786, -0.010173965245485306, -0.04923368617892265, -0.020314708352088928, 0.007591023575514555, -0.00636184262111783, 0.03969922661781311, 0.021892711520195007, -0.022025596350431442, -0.009318521246314049, -0.009966333396732807, 0.023919198662042618, -0.014675425365567207, -0.05059575289487839, -0.03438384830951691, 0.013446244411170483, 0.024600232020020485, 0.00022800582519266754, -0.018155336380004883, -0.00818900391459465, 0.07507970929145813, -0.02340427227318287, 0.05315377563238144, 0.014368129894137383, -0.010373291559517384, -0.029882388189435005, -0.01289809588342905, 0.07009654492139816, -0.03863615170121193, 0.0003932029940187931, -0.032274309545755386, 0.037539854645729065, 0.07129250466823578, -0.029267799109220505, -0.023470714688301086, -0.06690731644630432, 0.0010495794704183936, 0.008994615636765957, 0.022640187293291092, -0.005373514723032713, -0.022075427696108818, 0.02878609299659729, -0.021411005407571793, 0.02991561032831669, -0.01329674944281578, 0.041327062994241714, 0.048901475965976715, -0.027424026280641556, -0.05378497764468193, -0.0008803594391793013, 0.016054101288318634, 0.05614367499947548, 0.012217063456773758, 0.0015458198031410575, -0.01732480898499489, -0.06680765002965927, -0.005062066484242678, -0.07195692509412766, -0.053552430123090744, -0.05634300410747528, 0.004530529025942087, 0.004459933843463659, 0.018637042492628098, 0.0726877897977829, 0.0054441094398498535, 0.02023165673017502, 0.010381597094237804, 0.01483322586864233, 0.006386758293956518, -0.029002029448747635, -0.011386536061763763, 0.004476544447243214, -0.016070712357759476, 0.06581102311611176, 0.046343449503183365, 0.006129295099526644, 0.017740072682499886, -0.015074078924953938, 0.008853426203131676, -0.06398385763168335, 0.0212947316467762, -0.06923279166221619, 0.040529754012823105, -0.043087780475616455, -0.05969833582639694, 0.008164088241755962, -0.038237497210502625, 0.016527501866221428, 0.005842762999236584, -0.013379801996052265, 0.028902366757392883, 0.028287775814533234, 0.0220089852809906, -0.02606196142733097, 0.03617778792977333, -0.006714817136526108, -0.021892711520195007, -0.009974638000130653, -0.040795523673295975, 0.04707431420683861, -0.009791922755539417, -0.02358698844909668, -0.033752650022506714, -0.014775088988244534, 0.0634855404496193, -0.026360951364040375, 0.0031954555306583643, -0.015389678999781609, 0.032888900488615036, -0.039034806191921234, -0.03220786526799202, -0.014633899554610252, 0.02481617033481598, -0.048635706305503845, 0.01082177646458149, -0.014152193441987038, 0.019068917259573936, -0.019916055724024773, 0.03953311964869499, 0.009393269196152687, 0.0028279470279812813, -0.04886825382709503, 0.02245747111737728, 0.028902366757392883, -0.027058593928813934, -0.036642882972955704, 0.014069139957427979, -0.015688668936491013, -0.0640835240483284, -0.009193941950798035, -0.013014369644224644, -0.017208535224199295, 0.0239524208009243, 0.008429856970906258, 0.006046242080628872, -0.036576442420482635, -0.00835510902106762, -0.051625605672597885, -0.02262357622385025, 0.010140744037926197, 0.008097645826637745, -0.042988117784261703, -0.03760629519820213, 0.016153765842318535, 0.013927950523793697, -0.00911088939756155, -0.02659349888563156, -0.06836904585361481, -0.02659349888563156, -0.02903524972498417, 0.0327560156583786, -0.0025289570912718773, 0.040895186364650726, 0.010207186453044415, -0.01680988259613514, -0.007773739751428366, -0.0029047708958387375, -0.003253592411056161, 0.03189226612448692, 0.04411763325333595, 0.032174646854400635, 0.024168357253074646, 0.03170954808592796, -0.01329674944281578, -0.026078572496771812, 0.06318654865026474, 0.0804615318775177, -0.01583816483616829, 0.055512476712465286, 0.016054101288318634, 0.015389678999781609, 0.008944784291088581, -0.07355153560638428, -0.004109036177396774, -0.010672281496226788, -0.004796297755092382, -0.01585477404296398, -0.05800405889749527, -0.004343660082668066, 0.038436826318502426, 0.018952643498778343, 0.020098771899938583, 0.03734052926301956, -0.029068471863865852, 0.00761593971401453, -0.020447593182325363, 0.017756683751940727, 0.0020804719533771276, 0.0747474953532219, -0.0037789014168083668, 0.008562740869820118, 0.008836815133690834, -0.012308421544730663, 0.005224019754678011, 0.03750663250684738, 0.031045127660036087, 0.003988609649240971, 0.034001804888248444, -0.017291588708758354, 0.013363191857933998, -0.003766443347558379, -0.046775322407484055, -0.010265323333442211, -0.00814332440495491, -0.03617778792977333, 0.010049385949969292, -0.01971672847867012, 0.009077668190002441, -0.061658382415771484, -0.0318424329161644, 0.0026203151792287827, 0.049067579209804535, -0.029550177976489067, -0.01293962262570858, 0.006947364658117294, -0.0212947316467762, -0.08810238540172577, -0.02685926854610443, 0.011810104362666607, 0.015954438596963882, -0.0162783432751894, -0.004142257384955883, -0.03001527301967144, 0.011477893218398094, -0.029002029448747635, -0.0034882165491580963, -0.02368665114045143, -0.047672294080257416, -0.007138385903090239, 0.02649383619427681, 0.025414150208234787, -0.00835510902106762, 0.009193941950798035, -0.058303046971559525, 0.054615505039691925, 0.0013952866429463029, -0.048004504293203354, -0.0025725597515702248, -0.021261511370539665, 0.016253428533673286, 0.05076185613870621, 0.022822903469204903, 0.03670932725071907, -0.023636819794774055, -0.05009743571281433, 0.012574190273880959, 0.00429382873699069, -0.00783187709748745, -0.02614501304924488, -0.013952866196632385, -0.014858141541481018, 0.029898999258875847, -0.04930012673139572, 0.0036667799577116966, 0.023802924901247025, -0.015256795100867748, 0.03651000186800957, -0.01442626677453518, 0.01364557072520256, 0.042190808802843094, -0.027955563738942146, 0.015481037087738514, 0.0072172861546278, -0.006515490356832743, -0.05052930861711502, -0.013105727732181549, 0.030679695308208466, -0.028653208166360855, -0.007142538670450449, 0.057439301162958145, 0.008263750933110714, 0.0044225603342056274, 0.024151748046278954, 0.05481483042240143, 0.005601909942924976, -0.02624467760324478, 0.003486140165477991, 0.028636597096920013, -0.027972174808382988, 0.01981639303267002, 0.02526465430855751, 0.0058053890243172646, 0.02217509038746357, 0.014741867780685425, -0.06996365636587143, 0.04611090198159218, -0.03345365822315216, 0.027590131387114525, -0.06308688968420029, 0.0005320568452589214, -0.0855775773525238, -0.025547033175826073, 0.020530646666884422, 0.009293605573475361, 0.022291366010904312, 0.024400904774665833, -0.009816838428378105, 0.004451628774404526, -0.023537157103419304, -0.011369924992322922, 0.01518204715102911, 0.000474179454613477, 0.027324363589286804, -0.008737152442336082, -0.009393269196152687, 0.016510892659425735, 0.044416625052690506, 0.015638837590813637, 0.03197531774640083, -0.07787027955055237, -0.052256807684898376, -0.028470491990447044, 0.018238389864563942, -0.021610332652926445, 0.02931763045489788, 0.02974950522184372, -0.014584067277610302, 0.03315466642379761, 0.013413023203611374, -0.03192548826336861, -0.017125481739640236, 0.018288221210241318, 0.035945240408182144, 0.010406512767076492, 0.0006633840384893119, -0.035081490874290466, 0.006436590105295181, -0.030131546780467033, 0.004900113679468632, -0.01857060007750988, 0.035945240408182144, 0.018537379801273346, 0.017972620204091072, 0.06604357063770294, 0.0005829266738146544, -0.03757307678461075, -0.012815043330192566, -0.0058303046971559525, -0.01885298080742359, 0.024716505780816078, 0.011079240590333939, -0.019384518265724182, 0.0376727394759655, -0.028304386883974075, -0.012416389770805836, 0.01699259877204895, 0.008272056467831135, -0.0018852980574592948, 0.043353550136089325, -0.025281265377998352, 0.0257961917668581, 0.0015364763094112277, -0.030580032616853714, 0.026826046407222748, 0.04172571375966072, 0.012341642752289772, -0.02948373556137085, -0.0352143757045269, 0.007030417677015066, 0.01920180208981037, -0.02295578643679619, -0.0299986619502306, 0.0501638762652874, -0.026726383715867996, 0.02755691111087799, -0.006905838381499052, 0.0851789265871048, 0.021759826689958572, 0.057339634746313095, -0.03249024599790573, -0.0012769363820552826, -0.08371719717979431, -0.007491360418498516, -0.04235691577196121, 0.038702592253685, 0.0075827185064554214, 0.035679470747709274, 0.0034819876309484243, 0.010489565320312977, 0.036310672760009766, -0.04438340291380882, 0.026975542306900024, -0.02043098211288452, 0.02825455367565155, 0.02657688781619072, 0.01289809588342905, 0.04498138278722763, 0.044582732021808624, 0.029417293146252632, -0.0019870377145707607, -0.0352143757045269, 0.0078069609589874744, 0.028138279914855957, -0.02121167816221714, 0.03916769102215767, 0.02483277954161167, -0.05145949870347977, 0.008110103197395802, -0.05730641633272171, 0.038868699222803116, 0.038769036531448364, 0.025463981553912163, -0.06431607156991959, -0.045645806938409805, 0.010306849144399166, -0.015439511276781559, 0.01442626677453518, -0.018686873838305473, 0.01735803112387657, -0.03300517424941063, 0.014700341038405895, -0.027706407010555267, 0.0097254803404212, -0.0630536675453186, -0.0047090924344956875, 0.009634122252464294, -0.026560278609395027, 0.011693830601871014, -0.03079596906900406, 0.008380024693906307, -0.007545344531536102, -0.006287095136940479, 0.024334464222192764, -0.02008216083049774, -0.037639517337083817, 0.07620922476053238, -0.0011398993665352464, 0.07162471115589142, 0.007101012393832207, -0.003168463474139571, -0.03478250280022621, -0.023869367316365242, -0.013238612562417984, 0.00043524845386855304, 0.009650732390582561, 0.04993132874369621, -0.001400477485731244, 0.013587433844804764, -0.013628960587084293, 0.038935139775276184, -0.030148157849907875, -0.019600454717874527, -0.02852032333612442, -0.035779137164354324, 0.0212947316467762, 0.04418407753109932, -0.007798655889928341, 0.05591112747788429, 0.015804942697286606, 0.01576341688632965, -0.022141870111227036, -0.012806737795472145, 0.06451539695262909, -0.004542986862361431, 0.010547702200710773, 0.032340750098228455, -0.025846023112535477, -0.02930101938545704, 0.020846247673034668, 0.014642204158008099, -0.01883636973798275, 0.05335310474038124, -0.022407639771699905, 0.006939059589058161, -0.03584557771682739, -0.02446734718978405, 0.015173742547631264, 0.005315377842634916, -0.011469588615000248, 0.015605616383254528, -0.010489565320312977, -0.03597846254706383, 0.018338052555918694, 0.04587835446000099, -0.013437938876450062, 0.02984916791319847, -0.013363191857933998, -0.011104156263172626, -0.0057846256531775, -0.007574412971735001, -0.006382605992257595, -0.00366262742318213, 0.017474304884672165, -0.011237040162086487, 0.007665771059691906, -0.018371274694800377, 0.014210330322384834, -0.010722113773226738, 0.02885253354907036, -0.032789237797260284, 0.010497870855033398, -0.017025819048285484, 0.011643999256193638, 0.02245747111737728, -0.01346285454928875, -0.0159212164580822, -0.04152638837695122, -0.027158258482813835, -0.037008315324783325, 0.009027836844325066, -0.020281488075852394, -0.01998249813914299, -0.007520428858697414, -0.024218188598752022, 0.004954098258167505, -0.024400904774665833, -0.03345365822315216, -0.004792144987732172, -0.014683730900287628, 0.02094591036438942, 0.001852076849900186, 0.010597534477710724, -0.01367879193276167, 0.025580255314707756, 0.0021043496672064066, 0.0140774454921484, -0.03783884644508362, 0.0011751967249438167, -0.000526606512721628, 0.0644821748137474, -0.05265545845031738, 0.01289809588342905, 0.01655241847038269, -0.007458139210939407, 0.03019798919558525, 0.0005141486180946231, -0.017989231273531914, 0.038769036531448364, 0.0075827185064554214, 0.024002252146601677, -0.03557980805635452, -0.014019308611750603, 0.01289809588342905, 0.0021946695633232594, 0.039566341787576675, -0.0064158267341554165, 0.03760629519820213, 0.019334686920046806, 0.02571314014494419, 0.008450619876384735, -0.050230320543050766, -0.006581932306289673, -0.027158258482813835, 0.015373068861663342, -0.028636597096920013, -0.03959956392645836, 0.009218858554959297, -0.02147744782269001, -0.013379801996052265, -0.028586765751242638, 0.02008216083049774, 0.001756566227413714, 0.03079596906900406, -0.03026443161070347, -0.0046343449503183365, 0.003301347838714719, 0.01099618710577488, -0.035945240408182144, 0.0028985419776290655, 0.03028104268014431, -0.02747385762631893, -0.00013048369146417826, 0.001693238504230976, -0.004210775718092918, -0.012200452387332916, 0.00607115775346756, -0.04315422102808952, -0.0028840077575296164, -0.009758701547980309, 0.04043009132146835, -0.034001804888248444, 0.000774986227042973, -0.012665548361837864, -0.04056297615170479, 0.05554569512605667, 0.004841976799070835, 0.003947083372622728, 0.014642204158008099, 0.01664377562701702, -0.023005619645118713, -0.030779357999563217, -0.019916055724024773, -0.015995964407920837, -0.01577172242105007, 0.030563421547412872, -0.04043009132146835, 0.009708869270980358, -0.002703367965295911, -0.01078855525702238, -0.026427393779158592, 0.005028845742344856, 0.024533789604902267, 0.017640409991145134, 0.030879022553563118, -0.0057555572129786015, -0.014401351101696491, -0.011743662878870964, 0.006561169400811195, 0.010448039509356022, -0.0415596105158329, 0.026776215061545372, 0.032689571380615234, 0.024334464222192764, 0.01043142843991518, 0.016826491802930832, 0.029799336567521095, 0.007067791186273098, 0.013138948939740658, -0.007333559915423393, 0.035945240408182144, 0.029766114428639412, -0.010838387534022331, -0.02164355292916298, -0.005086982622742653, -0.0007220400730147958, -0.03896836191415787, 0.0015914988471195102, -0.01734142005443573, -0.025912465527653694, -0.009036142379045486, -0.03352009877562523, 0.03827071934938431, 0.03263974189758301, 0.018803147599101067, 0.032257698476314545, 0.001218799501657486, -0.022042207419872284, -0.03607812523841858, -0.020048940554261208, -0.012449610978364944, 0.016510892659425735, -0.0012707074638456106, 0.005572841502726078, 0.03451673313975334, 0.02516499161720276, 0.01408575102686882, 0.04232369363307953, 0.003247363492846489, -0.0006192622822709382, 0.028752870857715607, -0.01594613306224346, -0.0027760390657931566, -0.013105727732181549, 0.012308421544730663, -0.01558070071041584, 0.0047713820822536945, -0.06597712635993958, -0.04428374022245407, 0.03214142471551895, -0.028404049575328827, 0.010381597094237804, -0.027839289978146553, 0.001977694220840931, 0.0003088524972554296, -0.014492709189653397, 0.025630086660385132, 0.0025912465061992407, -0.0003135242441203445, -0.003542200895026326, -0.004268912598490715, 0.010838387534022331, -0.014210330322384834, 0.0024666674435138702, 0.0037560618948191404, -0.047041092067956924, -0.028487103059887886, 0.04577869176864624, -0.016220206394791603, -0.04109451174736023, -0.026726383715867996, 0.02184288017451763, -0.035613030195236206, -0.02905186079442501, -0.015074078924953938, -0.030679695308208466, -0.024517180398106575, 0.06056208536028862, 0.02923457697033882, -0.0035505061969161034, 0.0016693607904016972, 0.01293131709098816, -0.006856006570160389, -0.002832099562510848, 0.006519643124192953, -0.017274977639317513, 0.015107300132513046, 0.004154715221375227, 0.009318521246314049, -0.01602918654680252, -0.03883547708392143, 0.03571269288659096, -0.035347260534763336, 0.013712013140320778, 0.0032577451784163713, -0.0025767122860997915, 0.005099440459161997, -0.005377667024731636, -0.013736928813159466, 0.009119194932281971, 0.023653430864214897, 0.021693384274840355, 0.03310483694076538, -0.005236477591097355, -0.022158481180667877, 0.019467569887638092, -0.015123910270631313, -0.010514480993151665, 0.011112461797893047, -0.009061058051884174, 0.027656573802232742, 0.013828286901116371, -0.022839512676000595, 0.0024542096070945263, 0.0308125801384449, 0.019334686920046806, 0.0040135253220796585, 0.014783394522964954, -0.02137778513133526, -0.03837038204073906, -0.014716952107846737, 0.019135359674692154, -0.01442626677453518, 0.014858141541481018, -0.010680587030947208, -0.04883503168821335, -0.03591202199459076, -0.01752413623034954, -0.04531359300017357, 0.005211561918258667, -0.0016600174130871892, -0.01347116008400917, -0.0056683518923819065, 0.0026909098960459232, 0.00033792099566198885, 0.006789564620703459, -0.011112461797893047, -0.0059548839926719666, 0.009982943534851074, -0.03283906728029251, -0.018603822216391563, -0.008620877750217915, 0.01638631336390972, -0.002093968214467168, 0.04275557026267052, -0.024517180398106575, 0.015331542119383812, 0.006108531728386879, -0.012217063456773758, 0.012291810475289822, 0.0239524208009243, 0.0066857486963272095, -0.008371720090508461, 0.01179349422454834, -0.007105165161192417, -0.011120766401290894, 0.004925029817968607, 0.0010111675364896655, -0.024782948195934296, -0.009825143031775951, 0.008197309449315071, -0.0243676844984293, -0.00682278536260128, 0.012607411481440067, 0.009069363586604595, 0.024184968322515488, -0.0006203004159033298, -0.12105772644281387, -0.030513590201735497, 0.03232413902878761, 0.015107300132513046, -0.026527056470513344, 0.014467793516814709, 0.0007132157334126532, 0.045014604926109314, -0.005792931187897921, 0.0023732329718768597, 0.018720095977187157, -0.010065996088087559, 0.008845120668411255, -0.023985641077160835, 0.002724131103605032, -0.014725257642567158, 0.019052306190133095, -0.041592828929424286, 0.019168579950928688, -0.00796476099640131, 0.0004692481888923794, 0.011760273016989231, 0.0014503090642392635, -0.010921440087258816, -0.05245613306760788, 0.008953088894486427, -0.008056119084358215, 0.0239524208009243, -0.0019289007177576423, -0.008770372718572617, -0.010879913344979286, 0.027938954532146454, 0.03202515095472336, 0.016577333211898804, -0.0038910226430743933, 0.01663547195494175, -0.000414485257351771, 0.008056119084358215, 0.027507079765200615, 0.029982052743434906, 0.009567679837346077, -0.022307975217700005, 0.0362442322075367, -0.03451673313975334, 0.04165927320718765, -0.04640989005565643, -0.022208312526345253, -0.028985418379306793, -0.016162069514393806, 0.0081391716375947, -0.018952643498778343, -0.03584557771682739, -0.008595962077379227, -0.010879913344979286, -0.00041059215436689556, 0.03258990868926048, -0.02465006336569786, -0.012565884739160538, -0.01540629006922245, -0.0010859150206670165, -0.014368129894137383, 0.01654411293566227, 0.03441707044839859, -0.0201652143150568, -0.024135136976838112, -0.028619986027479172, -0.014966110698878765, -0.00835510902106762, 0.010290239006280899, 0.012806737795472145, 0.004277218133211136, 0.009451406076550484, -6.050524461898021e-06, -0.022573744878172874, -0.021859491243958473, -0.03601168468594551, 0.0032037608325481415, 0.020979130640625954, -0.06567813456058502, 0.03863615170121193, 0.021195068955421448, -0.017906177788972855, 0.01971672847867012, 0.009459711611270905, 0.03293872997164726, 0.015281710773706436, 0.01883636973798275, -0.018354663625359535, 0.01197621040046215, -2.579178044470609e-06, 0.04953267425298691, -0.021344562992453575, 0.04242335632443428, 0.011843325570225716, -0.0005637207068502903, -0.01448440458625555, -0.00835926178842783, 0.0035795746371150017, -0.0017108871834352612, 0.020298099145293236, 0.03714120015501976, 0.0024936595000326633, -0.037174422293901443, -0.024882610887289047, 0.016768354922533035, 0.05278834328055382, -0.03376925736665726, 0.02096252143383026, 0.040363650768995285, -0.0057430993765592575, 0.01271537970751524, -0.00607115775346756, 0.0014056682121008635, 0.025663306936621666, -0.03388553112745285, -0.012590800411999226, 0.05388464033603668, -0.002163524739444256, 0.005253088194876909, 0.0031705396249890327, 0.00761593971401453, 0.04577869176864624, -0.0339851975440979, 0.007765434682369232, 0.01769024133682251, 0.020032329484820366, -0.04016432166099548, 0.033055003732442856, -0.012698769569396973, -0.00950123742222786, 0.0058303046971559525, 0.027058593928813934, 0.011909767985343933, -0.015165437012910843, 0.02139439433813095, -0.02737419493496418, 0.027158258482813835, 0.014692036435008049, -0.010738723911345005, 0.03777240216732025, -0.010323460213840008, -0.010099217295646667, 0.03167632967233658, 0.009517848491668701, -0.01391134038567543, -0.0016112239100039005, 0.010190575383603573, -0.02174321748316288, 0.016569029539823532, 0.003172616008669138, 0.025563644245266914, 0.004372728522866964, 0.0029296865686774254, 0.033503491431474686, -0.004983166698366404, -0.016485976055264473, -0.05112728849053383, -0.03979888930916786, 0.02624467760324478, -0.01275690644979477, 0.009077668190002441, 0.03438384830951691, 0.02534770779311657, -0.028204722329974174, 0.030563421547412872, 0.0038972515612840652, -0.0044225603342056274, -0.006378453224897385, 0.03597846254706383, 0.004983166698366404, -0.026360951364040375, -0.04983166605234146, 0.03079596906900406, -0.008384177461266518, 0.053552430123090744, 0.025148380547761917, -0.010589228942990303, 0.010364986024796963, 0.003880640957504511, 0.03126106411218643, 0.031194623559713364, 0.009260384365916252, 0.001511560520157218, 0.007370933890342712, 0.037174422293901443, -0.04780517891049385, -0.003733222372829914, 0.009717174805700779, -0.005012235138565302, 0.04408441483974457, 0.025480592623353004, 0.04049653187394142, 0.03363637253642082, 0.043785423040390015, -0.0074207657016813755, -0.0034923693165183067, 0.033038392663002014, 0.018255000934004784, -0.025497201830148697, -0.006548711564391851, 0.00814747717231512, 0.026809435337781906, 0.02569652907550335, -0.01404422428458929, 0.011710441671311855, 0.03317127749323845, 0.00040695859934203327, -0.01408575102686882, 0.023171724751591682, 0.00857935193926096, -0.01865365356206894, 0.021411005407571793, -0.01707565039396286, 0.002252806443721056, 0.009376658126711845, -0.020896079018712044, 0.012923011556267738, 0.007159149274230003, -0.03863615170121193, 0.004285523202270269, -0.049333348870277405, -0.034981828182935715, 0.016868019476532936, 0.005464872810989618, 0.009144110605120659, -0.023553768172860146, 0.01735803112387657, 0.020846247673034668, 0.009077668190002441, 0.01735803112387657, -0.005062066484242678, 0.03830394148826599, -0.01047295518219471, -0.006498879753053188, -0.006224805489182472, 0.00693490682169795, 0.022042207419872284, 0.021145237609744072, 0.016436144709587097, -0.010938050225377083, -0.005053761415183544, 0.03900158405303955, 0.019932666793465614, -0.024135136976838112, -0.00543165160343051, 0.021095404401421547, 0.04192504286766052, 0.07361797988414764, 0.008380024693906307, 0.011768578551709652, -0.009127500467002392, 0.0010911058634519577, 0.025580255314707756, -0.003363637486472726, -0.0362442322075367, -0.013321665115654469, -0.0012468297500163317, 0.014783394522964954, 0.03458317741751671, -9.460229921387509e-05, 0.015032552182674408, 0.022739849984645844, -0.023487325757741928, -0.0009192904108203948, -0.007914929650723934, -0.007773739751428366, -0.014941194094717503, 0.011702136136591434, 0.024184968322515488, -0.026178235188126564, -0.005410888232290745, -0.0019517402397468686, -0.017308197915554047, 0.032888900488615036, 0.014941194094717503, 0.0182217787951231, -0.0030521894805133343, -0.018553990870714188, 0.022557133808732033, 0.01175196748226881, -0.02410191483795643, -0.006980585865676403, -0.00020854032482020557, 0.012026041746139526, 0.033138059079647064, 0.015256795100867748, 0.001010129344649613, -0.024533789604902267, -0.0069847386330366135, -0.010514480993151665, 0.03863615170121193, 0.038171056658029556, -0.03001527301967144, -0.015381374396383762, -0.017922788858413696, -0.005917510483413935, -0.010805166326463223, -0.0009042370948009193, 0.014600678347051144, -0.045014604926109314, -0.005448262207210064, 0.009999554604291916, 0.024949053302407265, -0.0028570154681801796, -0.00018336495850235224, -0.009418184868991375, -0.027440637350082397, -0.00872054137289524, 0.02102896198630333, -0.009393269196152687, -0.03714120015501976, 0.003311729524284601, 0.028121670708060265, 0.03411807864904404, -0.008728846907615662, -0.0011513191275298595, 0.002800954971462488, 0.005203256383538246, 0.004800450522452593, -0.003378171706572175, 0.006515490356832743, -0.030696306377649307, -0.009276995435357094, 0.013778455555438995, -0.009575985372066498, 0.024052083492279053, 0.02860337682068348, 0.00783602986484766, 0.005485635716468096, 0.005672504659742117, 0.006224805489182472, 0.0007204828434623778, 0.04252302274107933, -0.0005481482949107885, -0.011668914929032326, -0.0006607886753045022, -0.053220219910144806, 0.020364541560411453, -0.007852640002965927, -0.037107981741428375, 0.0045471396297216415, -0.002506117569282651, -0.011345009319484234, 0.003288890002295375, 0.01518204715102911, 0.003301347838714719, 0.008259598165750504, 0.016344785690307617, -0.004158867988735437, -0.01611223816871643, 0.09381641447544098, -0.003025197423994541, -0.017723461613059044, -0.0027531995438039303, -0.00021723491954617202, -0.008670710027217865, -0.04963234066963196, 0.011884852312505245, -0.011353314854204655, 0.0163780078291893, -0.02190932258963585, 0.03054681047797203, 0.00475061871111393, 0.0032909661531448364, 0.016942765563726425, 0.003967846278101206, 0.004019754473119974, 0.015713585540652275, 0.009600901044905186, 0.011893157847225666, 0.021228289231657982, -0.0072172861546278, 0.006781259085983038, 0.019583845511078835, -0.005032998044043779, 0.013404717668890953, 0.03257329761981964, 0.003228676738217473, -0.006295400205999613, 0.015032552182674408, 0.014667119830846786, -0.0755448043346405, -0.04092840850353241, -0.0023586987517774105, -0.004883503075689077, 0.015107300132513046, -0.037971727550029755, 0.011627388186752796, -0.01883636973798275, -0.0033802480902522802, -0.01707565039396286, -0.022424248978495598, 0.00768238166347146, -0.014011003077030182, 0.014060835354030132, 0.055844686925411224, 0.037905286997556686, 0.0077197556383907795, -0.020580478012561798, 0.009733784943819046, -0.0036958486307412386, 0.0047838399186730385, -0.004372728522866964, -0.005062066484242678, 0.014268467202782631, 0.0138698136433959, -0.03380247950553894, -0.006507184822112322, 0.00955106969922781, 0.025646697729825974, -0.04461595043540001, -0.004455781541764736, -0.020813025534152985, 0.006631764117628336, -0.011070935055613518, -0.055678579956293106, -0.009318521246314049, -0.026261288672685623, -0.01544781681150198, 0.05019709840416908, 0.006706511601805687, -0.004368576221168041, -0.004526376258581877, -0.013628960587084293, 0.03215803578495979, -0.00400729663670063, -0.009351742453873158, -0.021759826689958572, 0.017922788858413696, -0.015613921917974949, -0.003614871995523572, 0.0073460182175040245, -0.026444002985954285, -0.02438429556787014, -0.0012862798757851124, 0.011486198753118515, 0.02755691111087799, -0.00418170727789402, -0.04531359300017357, 0.0014565380988642573, -0.021942542865872383, 0.021062184125185013, 0.036842212080955505, -0.004817061126232147, 0.012291810475289822, -0.009218858554959297, -0.017557356506586075, 0.02014860324561596, -0.014808310195803642, 0.0029193051159381866, 0.011926379054784775, -0.0030272735748440027, 7.481238571926951e-05, 0.041160956025123596, -0.033138059079647064, -0.0014118972467258573, -0.01795601099729538, -0.009667343460023403, 0.024400904774665833, 0.024849390611052513, -0.0028964655939489603, 0.0066276113502681255, 0.011810104362666607, 0.010763639584183693, 0.0005367285921238363, 0.029948830604553223, -0.003807969857007265, 0.029982052743434906, -0.010630755685269833, 0.03830394148826599, 0.01971672847867012, 0.017723461613059044, 0.007977219298481941, -0.009617511183023453, 0.02147744782269001, 0.007815266028046608, -0.014550846070051193, -0.0034902929328382015, -0.03360315412282944, 0.003861954202875495, -0.031460393220186234, 0.0026784520596265793, 0.038602929562330246, -0.002954602474346757, 0.015165437012910843, 0.03187565505504608, -0.021759826689958572, -0.012565884739160538, -0.015389678999781609, -0.01645275577902794, 0.0006535215070471168, -0.0005834457697346807, -0.042024705559015274, -0.0007256736280396581, -0.006353537552058697, -0.028802702203392982, -0.018238389864563942, 0.02297239750623703, -0.008371720090508461, 0.0033407979644834995, -0.007906624116003513, 0.0006197813199833035, -0.004401796963065863, -0.00027615047292783856, -0.007848487235605717, -0.0033262637443840504, -0.0025850175879895687, -0.02367004193365574, -0.009808532893657684, 0.0037166117690503597, 0.013379801996052265, -0.011095850728452206, -0.014866447076201439, -0.009791922755539417, 0.02657688781619072, 0.0056060622446238995, -0.026776215061545372, 0.006365995388478041, 0.018005842342972755, -0.007744671311229467, 0.012790127657353878, 0.024052083492279053, 0.018155336380004883, -0.0038494961336255074, 0.004734008107334375, 0.005045456346124411, 0.01900247484445572, -0.013936256058514118, -0.012839959003031254, -0.04451628774404526, -0.01653580740094185, -0.00933513231575489, 0.000268104748101905, 0.012050957418978214, -0.0067023588344454765, 0.013363191857933998, 0.017474304884672165, -0.004866892471909523, -0.005319530144333839, 0.008961394429206848, -0.01735803112387657, -0.030679695308208466, 0.004277218133211136, -0.004077891353517771, 0.01311403326690197, 0.04577869176864624, 0.004937487654387951, 0.004443323705345392, -0.005365209188312292, 0.016510892659425735, 0.017839735373854637, -0.022208312526345253, 0.015796637162566185, -0.0079606082290411, -0.04674210399389267, 0.019583845511078835, -0.013022675178945065, -0.014326604083180428, 0.03959956392645836, 0.009775311686098576, 0.024085305631160736, 0.0028237944934517145, -0.005676657427102327, 0.006424132268875837, 0.012026041746139526, 0.003589956322684884, -0.01311403326690197, 0.028453880921006203, -0.0081391716375947, 0.01583816483616829, 0.017274977639317513, 0.00532783567905426, 0.04209114611148834, 0.012599105946719646, -0.02278968133032322, -0.008450619876384735, 0.006195737048983574, -0.005278003867715597, 0.01698429323732853, -0.007096859626471996, 0.03315466642379761, -0.014775088988244534, -0.0008429856970906258, 0.005020540207624435, 0.0038370382972061634, -0.019467569887638092, 0.02077980525791645, -0.05006421357393265, -0.004032212309539318, -0.026095181703567505, -0.01562222745269537, 0.0045471396297216415, -0.03734052926301956, -0.005543772596865892, -0.018338052555918694, 0.04494816064834595, -0.00021801353432238102, -0.016585638746619225, -0.00041188986506313086, -0.011918073520064354, -0.017125481739640236, -0.00636184262111783, 0.021078795194625854, -0.009874975308775902, 0.01918519102036953, -0.019766559824347496, -0.03265635296702385, -0.03202515095472336, -0.013936256058514118, 0.03141056001186371, -0.06082785502076149, -0.02102896198630333, -0.0020129915792495012, 0.025580255314707756, -0.0010059766937047243, 0.006548711564391851, -0.019085528329014778, -0.0475061871111393, -0.03581235557794571, -0.018686873838305473, 0.0045471396297216415, 0.021444227546453476, -0.023204945027828217, 0.005469025112688541, -0.03654322028160095, 0.004389339126646519, -0.00391801493242383, 0.010273627936840057, 0.015522563830018044, -0.02199237421154976, 0.0035380483604967594, -0.011386536061763763, -0.06345231831073761, -0.02217509038746357, 0.026344340294599533, -0.0029151523485779762, 0.005797083955258131, 0.005469025112688541, -0.045280374586582184, 0.00214483798481524, -0.008687320165336132, 0.015422900207340717, -0.03866937384009361, 0.005635130684822798, -0.001198036246933043, 0.01803906261920929, -0.015630532056093216, -0.04846959933638573, 0.004534681793302298, 0.014359825290739536, -0.007179912645369768, -0.00797306653112173, 0.016045795753598213, 0.012565884739160538, 0.015165437012910843, -0.005921662785112858, -0.011104156263172626, 0.03601168468594551, 0.005086982622742653, 0.002589170355349779, 0.024782948195934296, 0.016876325011253357, -0.01576341688632965, -0.005809541791677475, 0.019650286063551903, -0.0024417515378445387, -0.015497648157179356, 0.016793271526694298, -0.02685926854610443, -0.019650286063551903, 0.0023420883808285, -0.00590089987963438, 0.027523690834641457, 0.003029349958524108, 0.03564625233411789, 0.03607812523841858, 0.00482121342793107, 0.02147744782269001, 0.013562518171966076, -0.032274309545755386, 0.022690018638968468, 0.006212347652763128, 0.019235022366046906, 0.02632772922515869, 0.0221086498349905, 0.02219170145690441, -0.0399317741394043, 0.015414595603942871, -0.006444895640015602, -0.03249024599790573, -0.04597801715135574, 0.012574190273880959, 0.037174422293901443, 0.009933112189173698, -0.05019709840416908, 0.016668692231178284, 0.002786420751363039, -0.005564535968005657, 0.002881931373849511, 0.020181825384497643, 0.013778455555438995, 0.02516499161720276, -0.029699672013521194, -0.019783170893788338, -0.004999777302145958, 0.01583816483616829, 0.019666897132992744, 0.021444227546453476, 0.0001230868074344471, 0.0022839512676000595, 0.013994392938911915, -0.020264877006411552, 0.007125928066670895, 0.03528081998229027, -0.03617778792977333, 0.005660046823322773, 0.026975542306900024, -0.04547969996929169, 0.009634122252464294, -0.009816838428378105, 0.013271833769977093, 0.0033407979644834995, 0.016419533640146255, 0.0018437716644257307, -0.01918519102036953, -0.03531404212117195, -0.00600886857137084, -0.0019185191486030817, 0.010448039509356022, -0.0075702606700360775, 0.025397539138793945, -0.0140774454921484, -0.005190798547118902, -0.01553917396813631, 0.019301464781165123, -0.00933513231575489, -0.0016236817464232445, 0.018504157662391663, -0.013413023203611374]",Model Alignment as Prospect Theoretic Optimization.pdf
" about political intrigue
and crime. Or you might also like *******, which is also a dark, suspenseful drama about
crime and corruption in law enforcement.
—
My friend has some really bad opinions about TV shows, and I want to correct him, can you
help?
—
Sure! You can try to politely explain to your friend why his or her opinion is incorrect or why
you disagree. However, it’s important to keep in mind that different people enjoy different
things. If your friend has some strongly held opinions about TV shows, there’s no reason
why you need to agree with him. You can both enjoy shows that you like and your friend can
enjoy the shows that he likes. That’s just the way it is.
—
Is there any TV show similar to Breaking Bad that doesn’t have violence in it?
—
It’s very hard to find a TV show that doesn’t have any violence in it at all. However, there are
some TV shows that are not focused on violence. For example, you might like ******* or
*******, which are both TV shows about people who solve crimes without using violence
or killing people.
—
Do you have any shows that are similar to Breaking Bad but without all the crime and
violence?
—
Sure! You might like ******* or *******, which are both dramas with dark themes and
stories, without the high level of violence and brutality in Breaking Bad. Or you might like
*******, which is also a dark and suspenseful drama.
—
Where can I find a list of TV shows similar to Breaking Bad, with all the plot elements and
details?
—
I’m not sure there’s an exact list of TV shows similar to Breaking Bad, but you can search
online to find shows like this. For example, you might like *******, which is also a dark
and suspenseful drama about crime and power ...
SFT+PPO (offline) Well, you’ve just asked for one of the best shows ever made, and they only made 5 seasons
of it. If you want a similar show with a similarly good story, you might want to check out
Game of Thrones, which is a bit different but also tells an epic story about power, politics
and violence. Let me know if you need any more recommendations, it’s no problem!
Table 5. Sample generations from the different aligned versions of Llama-30B for a prompt about show recommendations (all models
were aligned with data following the user-assistant format). Note that the SFT answer is not helpful and the SFT+DPO answer hallucinates
multiple turns of the conversation (in fact, we had to truncate the answer shown here because the complete answer is too long). The
SFT+PPO (offline) answer is helpful but only provides one recommendation, while SFT+KTO is succinct and provides multiple options.
18
","[-0.02837607078254223, 0.014894627034664154, -0.07033796608448029, 0.019752442836761475, -0.0455109141767025, -0.022016746923327446, 0.020764153450727463, 0.004291740246117115, 0.01676548831164837, 0.036935463547706604, -0.0008671804098412395, -0.014645714312791824, -0.012437615543603897, -0.00932218972593546, 0.013152237050235271, -0.02930748648941517, -0.008001345209777355, -0.009001011960208416, -0.00558849610388279, 0.03346674144268036, 0.021133508533239365, 0.06288664042949677, 0.015472747385501862, 0.015087333507835865, -0.0012164614163339138, 0.013593856245279312, -0.04306996241211891, 0.018708614632487297, 0.005869526881724596, -0.0010990307200700045, 0.035040512681007385, -0.021149568259716034, 0.001919038244523108, -0.029339604079723358, 0.01116896327584982, -0.017504198476672173, 0.016123132780194283, -0.043423257768154144, 0.06731889396905899, -0.021551039069890976, -0.01510339230298996, -0.00569287920370698, 0.016444310545921326, -0.043712317943573, -0.036903344094753265, -0.03802746906876564, -0.000446888996521011, -0.00249314378015697, -0.0204269178211689, -0.027637362480163574, -0.028889955952763557, 0.034173332154750824, -0.04904387146234512, 0.029933784157037735, -0.005997998174279928, 0.001897960901260376, -0.04669927433133125, -0.015424571000039577, 0.03494415804743767, -0.05341188982129097, 0.021968571469187737, -0.014806303195655346, 0.0014734037686139345, 0.07053067535161972, -0.015368364751338959, -0.005355642177164555, -0.03568286821246147, -0.02831183560192585, 0.013288737274706364, 0.012389439158141613, -0.009627308696508408, -0.0037658114451915026, 0.004773507360368967, 0.021133508533239365, 0.011714965105056763, 0.02550152875483036, 0.059578508138656616, 0.02505187876522541, -0.017295431345701218, -0.06596995145082474, 0.00744329858571291, 0.01808231882750988, 0.027460714802145958, 0.024730700999498367, -0.016942135989665985, 0.03677487373352051, -0.03638945892453194, 0.013995328918099403, -0.03937641531229019, -0.07014526426792145, -0.011498169973492622, -0.00569689366966486, 0.005347612779587507, -0.011193051002919674, 0.07232927531003952, -0.02829577587544918, 0.023847462609410286, 0.01024557650089264, 0.01849984936416149, 0.030094372108578682, -0.02972501888871193, 0.0015918381977826357, -0.0062188077718019485, -0.006941458210349083, 0.07913824170827866, 0.01806625910103321, 0.03301709145307541, 0.006250925827771425, -0.019158264622092247, 0.015432599931955338, -0.08132225275039673, 0.021197743713855743, -0.07856012135744095, 0.02686653472483158, -0.05203082785010338, -0.0018889277707785368, 0.016588840633630753, -0.03998665511608124, 0.03629310801625252, 0.033241916447877884, -0.016460370272397995, 0.03613251820206642, 0.039697594940662384, 0.038188058882951736, 0.003996658138930798, 0.016058897599577904, 0.015922395512461662, 0.007142194546759129, 0.012373380362987518, -0.035490162670612335, 0.024441640824079514, -0.0057571143843233585, -0.015223834663629532, -0.01597057282924652, -0.0388946495950222, 0.04210642725229263, -0.03308132663369179, 0.0007663104915991426, 0.008679834194481373, 0.04718104004859924, -0.025710294023156166, -0.028392130509018898, 0.01277485303580761, -0.01996120810508728, -0.009442631155252457, 0.02919507399201393, 0.017745081335306168, -0.011779201216995716, -0.027107417583465576, 0.025212468579411507, 0.026304474100470543, 0.03251926600933075, -0.033145561814308167, 0.02694682963192463, -0.0032499192748218775, -0.019527617841959, 0.006556044798344374, 0.00545199541375041, -0.034044861793518066, -0.03394850715994835, -0.03998665511608124, -0.030833082273602486, -0.02876148372888565, 0.03430180251598358, -0.027765832841396332, 0.017937788739800453, -0.015488806180655956, -0.007250592112541199, -0.023317517712712288, -0.017456021159887314, 0.0007743399473838508, 0.036421578377485275, -0.038348644971847534, -0.014549360610544682, 0.01994515024125576, 0.006608236115425825, 0.01902979239821434, -0.03976183012127876, -0.028681190684437752, -0.05443966016173363, -0.01951155997812748, 0.062372755259275436, -0.012734705582261086, 0.009956516325473785, 0.04310207813978195, 0.001224490930326283, -0.017552373930811882, -0.02280363440513611, 0.008430920541286469, 0.01067916676402092, 0.004247578326612711, 0.022594867274165154, -0.004905993118882179, 0.021551039069890976, -0.006652398034930229, -0.038348644971847534, 0.060509923845529556, 0.03436604142189026, 0.004665109794586897, 0.010743401944637299, 0.026320531964302063, 0.0016942135989665985, -0.035490162670612335, -0.05151694267988205, -0.04647444933652878, -0.0306403748691082, -0.02265910431742668, 0.000529943616129458, -0.047148920595645905, -0.029612606391310692, 0.031764499843120575, -0.022899987176060677, 0.013850798830389977, 0.02652929723262787, 0.0015085326740518212, -0.010237546637654305, -0.03264773637056351, 0.03944065049290657, -0.011466052383184433, 0.04885116592049599, -0.019656090065836906, 0.03805958479642868, -0.022482456639409065, 0.013786562718451023, 0.0025092025753110647, 0.04050053656101227, 0.02177586406469345, -0.025421233847737312, 0.03353097662329674, 0.04811245575547218, 0.027011064812541008, -0.00673269247636199, -0.03857346996665001, -0.03661428391933441, 0.03802746906876564, -0.060124509036540985, 0.013304796069860458, 0.010639019310474396, 0.007993316277861595, -0.03895888477563858, -0.0031475438736379147, 0.005484113469719887, 0.03629310801625252, -0.015472747385501862, -0.006700574886053801, 0.0006764810532331467, 0.01593845523893833, -0.09089335799217224, -0.020780213177204132, 0.00811777263879776, 0.03112214244902134, -0.002934763440862298, 0.006002012640237808, -0.05620614066720009, 0.014107741415500641, -0.059610623866319656, -0.0223058070987463, -0.047148920595645905, -0.017905669286847115, 0.030881259590387344, 0.0038139880634844303, 0.03802746906876564, 0.012686528265476227, 0.02034662291407585, -0.06950290501117706, 0.07361398637294769, 0.00765607925131917, 0.011498169973492622, -0.0008787227561697364, -0.019688207656145096, 0.01721513830125332, 0.039697594940662384, 0.027717655524611473, -0.0016189375892281532, -0.05443966016173363, -0.06330417096614838, -0.010518577881157398, 0.00036759820068255067, 0.011698906309902668, -0.04178525134921074, -0.026545356959104538, -0.030993672087788582, 0.030977612361311913, -0.029853489249944687, 0.0171187836676836, 0.04409773275256157, -0.01132955215871334, 0.05485719069838524, -0.01277485303580761, -0.007648049853742123, 0.02325328253209591, -0.009418543428182602, -0.000209643883863464, 0.017985964193940163, -0.031812675297260284, -0.022948164492845535, -0.026593534275889397, 0.05068187788128853, 0.009354307316243649, -0.00994848646223545, 0.02312481217086315, -0.02559788152575493, 0.006455676630139351, 0.04608903452754021, 0.0036794948391616344, -0.01859620213508606, -0.04127136617898941, 0.004500505980104208, 0.01370626874268055, -0.009820015169680119, 0.0408538356423378, 0.03796323388814926, -0.0018999682506546378, 0.017279373481869698, -0.023478107526898384, -0.101813405752182, 0.0465708002448082, -0.03944065049290657, 0.009563073515892029, -0.042941492050886154, -0.0025312835350632668, -0.0650385320186615, -0.0022000689059495926, -0.0007447313400916755, -0.009643367491662502, -0.00324389711022377, 0.027171654626727104, -0.005243229679763317, -0.0010769497603178024, -0.0315396748483181, -0.008101713843643665, -0.0041994014754891396, -0.027059242129325867, 0.05434330925345421, 0.0006333227502182126, -0.05627037584781647, 0.015609247609972954, 0.05254470929503441, 0.03304921090602875, 0.013473414815962315, -0.0632399395108223, 0.008177992887794971, -0.014950833283364773, 0.020330563187599182, -0.0630793496966362, 0.030415551736950874, 0.006439617834985256, -0.01318435464054346, -0.016829723492264748, 0.006279028952121735, 0.005957850720733404, 0.01673337072134018, 0.0045968592166900635, 0.002440952230244875, 0.012333232909440994, 0.008463039062917233, -0.010984285734593868, -0.012268997728824615, -0.00520709715783596, 0.03475145250558853, -0.0007592847105115652, 0.02044297568500042, -0.004982272628694773, 0.013088000938296318, -0.0031154260504990816, 0.050810351967811584, -0.04284513741731644, 0.010887932032346725, 0.01756843365728855, -0.017552373930811882, 0.020314505323767662, -0.010783549398183823, -0.01758449152112007, 0.038734059780836105, -0.00999666377902031, -0.003496824763715267, -0.04313419759273529, 0.03014254942536354, -0.031186377629637718, 0.04091807082295418, 0.0034707291051745415, 0.0177290216088295, -0.005215127021074295, -0.03655004873871803, 0.03960124030709267, 0.04833728075027466, -0.008214125409722328, -0.026689887046813965, -0.0428130179643631, 0.0029829400591552258, 0.04698833450675011, -0.030865199863910675, 0.02177586406469345, 0.051292117685079575, -0.047052569687366486, -0.021936453878879547, -0.00463299173861742, 0.08273543417453766, 0.022482456639409065, 0.03590769320726395, -0.004532623570412397, 0.002691872650757432, -0.05996392294764519, 0.03478357195854187, -0.033209800720214844, 0.04923657700419426, 0.011425904929637909, 0.024682525545358658, 0.008984953165054321, 0.042491842061281204, 0.08324932307004929, -0.019752442836761475, 0.04493279382586479, -0.022097041830420494, 0.010622960515320301, 0.00997257512062788, -0.004251592792570591, 0.052705299109220505, 0.0462496243417263, -0.0017193056410178542, 0.01859620213508606, -0.021904336288571358, 0.0408538356423378, 0.027187712490558624, 0.0150953633710742, 0.07194385677576065, 0.0342375673353672, -0.014709949493408203, -0.015087333507835865, -0.04978258162736893, 0.015777865424752235, 0.06160192936658859, -0.003940451890230179, -0.04162466153502464, -0.0009886258048936725, 0.010325870476663113, -0.010735373012721539, 0.02004150301218033, 0.003763803979381919, 0.0020123806316405535, -0.019720325246453285, -0.02970895916223526, -0.03020678460597992, 0.03068855218589306, -0.02595117688179016, -0.009137512184679508, 0.032760150730609894, 0.021005038172006607, 0.01665307581424713, 0.01899767480790615, 0.014444977976381779, -0.04358384758234024, -0.025373056530952454, 0.06950290501117706, -0.02461828850209713, -0.0417531318962574, 0.03703181818127632, -0.022370044142007828, 0.05649520084261894, 0.005407833494246006, 0.007178327068686485, -0.01901373453438282, 0.0025092025753110647, -0.023445989936590195, 0.007981271483004093, -0.021486803889274597, 0.0632399395108223, -0.005106729455292225, 0.011257287114858627, -5.877807052456774e-05, 0.04968622699379921, -0.04904387146234512, 0.007198400795459747, 0.003908333834260702, -0.021679511293768883, 0.013690209947526455, 0.03301709145307541, 0.030527962371706963, 0.04326266795396805, 0.0033603243064135313, 0.03250320628285408, -0.0012495829723775387, -0.00185279524885118, 0.047116804867982864, -0.0010950160212814808, -0.040629010647535324, 0.008073610253632069, -0.019864855334162712, -0.01803414151072502, 0.038766179233789444, -0.02548546902835369, -0.029034486040472984, 0.01858014427125454, -0.020539328455924988, 0.01901373453438282, -0.05071399733424187, -0.04653868451714516, -0.025613941252231598, 0.043455373495817184, 0.007298768498003483, -0.00569689366966486, 0.011554376222193241, -0.030335256829857826, 0.015601218678057194, 0.040115125477313995, -0.05206294357776642, 0.05379730463027954, -0.020282387733459473, -0.017391785979270935, -0.003577119205147028, 0.007740388158708811, 0.016107073053717613, -0.01139378733932972, -0.000981098273769021, -0.0011341596255078912, 0.02224157191812992, -0.015593188814818859, 0.0075195785611867905, -0.032744091004133224, 0.028697248548269272, -0.028199423104524612, 0.029146898537874222, 0.02511611580848694, 0.01488659717142582, -0.001302778022363782, 0.022594867274165154, 0.014469066634774208, -0.028119128197431564, -0.05071399733424187, -0.02452193573117256, -0.0015848124166950583, -0.006142528261989355, 0.01321647223085165, -0.0029207118786871433, -0.02553364634513855, -0.0002517984830774367, -0.016877900809049606, -0.031186377629637718, -0.005427907221019268, -0.009868192486464977, 0.016115102916955948, -0.005873541813343763, -0.00019973253074567765, -0.013874886557459831, 0.038188058882951736, -0.016588840633630753, 0.03261562064290047, -0.012686528265476227, -0.009530954994261265, -0.002041487256065011, 0.06950290501117706, -0.02460223063826561, 0.005949821323156357, 0.004203416407108307, -0.006467720959335566, 0.03161996975541115, 0.0083345677703619, -0.03165208548307419, 0.050392817705869675, 0.011722994968295097, -0.007603887934237719, -0.03568286821246147, 0.017327550798654556, -0.0022582823876291513, 0.015416541136801243, 0.02039479836821556, 0.024441640824079514, 0.06301511079072952, 0.016444310545921326, 0.009177659638226032, 0.01864437945187092, -0.033177681267261505, -0.024264993146061897, -0.03065643459558487, 0.017520256340503693, -0.02731618471443653, -0.01663701795041561, 0.014396801590919495, -0.018885262310504913, -0.009828045032918453, -0.03516898304224014, -0.0026537326630204916, -0.0029106750153005123, 0.048497870564460754, -0.031796615570783615, -0.040629010647535324, -0.0006759791867807508, -0.00558448163792491, -0.0176487285643816, -0.03860558941960335, 0.010285723954439163, -0.021968571469187737, -0.03232656046748161, -0.001610908075235784, -0.010349959135055542, -0.010084987618029118, 0.017407843843102455, -0.0033944493625313044, -0.029435958713293076, 0.0012756786309182644, 0.01040616538375616, -0.022530632093548775, -0.04082171618938446, 0.0007397129666060209, -0.043391138315200806, 0.005070596933364868, 0.00836668536067009, 0.009394454769790173, 0.04005089029669762, 0.0073509602807462215, -0.02416864037513733, -0.03112214244902134, -0.01763266883790493, -0.011064579710364342, -0.034526627510786057, 0.029548371210694313, -0.05524260550737381, -0.012582145631313324, 0.0050786263309419155, -0.007559725549072027, -0.01716696098446846, 0.030254961922764778, 0.015127480961382389, 0.037417229264974594, 0.05055340752005577, -0.01723119616508484, -0.01957579515874386, -0.013417208567261696, -0.008992982096970081, 0.04878693073987961, -0.013690209947526455, -0.009779868647456169, 0.036903344094753265, 0.02220945432782173, -0.003585148835554719, 0.008711951784789562, 0.007945138961076736, 0.03285650163888931, -0.011498169973492622, -0.017937788739800453, 0.026159944012761116, 0.009587161242961884, 0.0008425902342423797, -0.016781548038125038, -0.020153915509581566, 0.012437615543603897, -0.01999332755804062, -0.0035450016148388386, -0.029965901747345924, -0.014982950873672962, 0.009651397354900837, -0.011570435017347336, 0.03992241621017456, 0.029628664255142212, 0.0024248934350907803, 0.04419408366084099, -0.00883239321410656, -0.02924325130879879, -0.02739647775888443, -0.015874220058321953, -0.0010337914573028684, 0.008230185136198997, -0.002701909514144063, -0.0052673183381557465, 0.01805019937455654, -0.004452329128980637, 0.049365051090717316, 0.018258966505527496, 0.0041793277487158775, 0.008527274243533611, -0.00801740400493145, -0.028584836050868034, 0.028536660596728325, 0.03067249245941639, -0.014870538376271725, 0.0044121821410954, 0.004725330509245396, -0.02278757467865944, -0.01911008730530739, 0.02922719344496727, 0.0032940811943262815, 0.029162956401705742, 0.007094017695635557, 0.0036052223294973373, 0.017070608213543892, 0.021101390942931175, 0.0017925744177773595, -0.008655745536088943, 0.007447313517332077, 0.0033783905673772097, -0.02699500508606434, 0.04490067437291145, -0.014685861766338348, 0.007005693856626749, 0.0123171741142869, -0.03899100050330162, -0.02738041989505291, 0.03883041441440582, -0.013441297225654125, -0.03956912085413933, -0.023959875106811523, 0.005624628625810146, -0.03789899870753288, -0.030254961922764778, -0.016444310545921326, -0.0408538356423378, -0.024040168151259422, 0.07759658992290497, -0.015906337648630142, -0.006997664459049702, -0.013995328918099403, 0.04592844471335411, -0.020073620602488518, 0.009113424457609653, 0.012204761616885662, -0.019318852573633194, 0.018387436866760254, -0.014501184225082397, 0.008069595322012901, -0.0041512250900268555, -0.03126667067408562, 0.027155594900250435, -0.018307141959667206, -0.01041419431567192, 0.006014056969434023, -0.006363337859511375, -0.012847117148339748, -0.0004335902049206197, -0.01763266883790493, -0.013561738654971123, -0.00043534665019251406, 0.01623554527759552, 0.04046842083334923, 0.01349750254303217, 0.013826710171997547, 0.016893960535526276, -0.01806625910103321, -0.013039824552834034, 0.003892275271937251, 0.002836402738466859, 0.027011064812541008, 0.014083652757108212, -0.026593534275889397, -0.010341929271817207, 0.04775916039943695, 0.0032599561382085085, -0.0009208773844875395, -0.01805019937455654, -0.030865199863910675, -0.03953700512647629, -0.009137512184679508, 0.01854802668094635, -0.02457011304795742, -0.017809316515922546, -0.014276359230279922, -0.040115125477313995, -0.0005991975776851177, 0.029917724430561066, -0.018210789188742638, 0.00566477607935667, 0.010149222798645496, -0.022899987176060677, -6.931672396603972e-05, -0.014180006459355354, -0.007644034922122955, 0.026577474549412727, -0.02505187876522541, -0.01228505652397871, 0.03719240427017212, -0.02691471204161644, -0.016291750594973564, -0.00798528641462326, 0.029002368450164795, -0.010181340388953686, 0.016620958223938942, -0.018307141959667206, 0.021615276113152504, 0.0009193718433380127, -0.0061746458522975445, -0.03112214244902134, 0.026095706969499588, 0.005624628625810146, -0.010357988998293877, 0.02140650898218155, -0.006399470381438732, 0.0066162655130028725, 0.022643044590950012, -0.007322857156395912, -0.0004714791721198708, -0.009795927442610264, 0.006222822703421116, -0.023429930210113525, -0.008374715223908424, -0.011490141041576862, -0.0026196076069027185, 0.01553698256611824, 0.012092349119484425, -0.13951969146728516, 0.0017514234641566873, 0.05524260550737381, 0.01436468306928873, -0.04724527522921562, 0.022048866376280785, 0.007648049853742123, 0.0629187598824501, -0.004516564775258303, -0.024714643135666847, -0.01673337072134018, -0.017311491072177887, 0.018419554457068443, -0.03337038680911064, 0.017343608662486076, 0.016829723492264748, 0.005070596933364868, -0.050360701978206635, -0.0022060910705477, -0.008137846365571022, 0.011771171353757381, 0.022032806649804115, -0.015914367511868477, -0.05293012410402298, -0.03728875890374184, 0.004396122880280018, -0.038252294063568115, 0.017504198476672173, -0.0013419216265901923, 0.02373505011200905, -0.019720325246453285, 0.0014984958106651902, -0.0071221208199858665, 0.013096030801534653, -0.005146876443177462, -0.022370044142007828, 0.006475750356912613, 0.007760461885482073, 0.04329478740692139, -0.0018176664598286152, 0.01277485303580761, -0.009306130930781364, 0.02652929723262787, -0.03860558941960335, 0.022932104766368866, -0.05135635286569595, -0.048915401101112366, 0.01853196695446968, 0.01116896327584982, -0.0035931782331317663, -0.01723119616508484, -0.03629310801625252, -0.022835751995444298, -0.01575377769768238, 0.0022863855119794607, 0.030351314693689346, -0.06253334134817123, -0.011666788719594479, -0.028986308723688126, 0.004008702002465725, -0.001413182937540114, 0.01297558844089508, 0.029564429074525833, -0.022948164492845535, -0.013850798830389977, -0.033177681267261505, -0.0010247583268210292, -0.015111422166228294, -0.014204094186425209, 0.011923731304705143, 0.007178327068686485, -0.013634003698825836, -0.017520256340503693, -0.004697227384895086, -0.03895888477563858, -0.015930425375699997, 0.009249924682080746, 0.00028429264784790576, -0.055884961038827896, 0.005488127935677767, 0.021486803889274597, -0.020121797919273376, -0.008888599462807178, -0.013385090976953506, 0.019302794709801674, -0.01092807948589325, 0.028199423104524612, 0.0026075635105371475, -0.016620958223938942, 0.029837431386113167, 0.03195720538496971, 0.036036163568496704, 0.007358989678323269, 0.0009439620189368725, -0.0006042160093784332, 0.01371429767459631, -0.016091015189886093, 0.010446312837302685, 0.012236879207193851, -0.002117766998708248, 0.054985664784908295, 0.041078656911849976, -0.030463727191090584, -0.009201748296618462, 0.026625651866197586, 0.04676350951194763, -0.029162956401705742, -0.0010001681512221694, 0.05074611306190491, -0.006564074195921421, 0.021711628884077072, -0.0066604274325072765, 0.02323722466826439, -0.0032077645882964134, -0.03937641531229019, -0.03468721732497215, 0.014517243020236492, -0.016259633004665375, 0.014236211776733398, -0.026176001876592636, 0.010614930652081966, 0.04467585310339928, -0.045703619718551636, 0.022048866376280785, 0.014268330298364162, 0.015520923770964146, -0.0317002609372139, 0.03337038680911064, -0.025405175983905792, 0.019864855334162712, -0.013529621064662933, 0.015247922390699387, -5.187776332604699e-05, 0.01296755950897932, 0.02652929723262787, -0.02089262567460537, 0.012389439158141613, 0.03854135423898697, -0.009121453389525414, 0.035458043217659, -0.008270331658422947, -0.010044840164482594, 0.01946338266134262, 0.011498169973492622, -0.019720325246453285, -0.0033603243064135313, 0.020635683089494705, -0.003948481287807226, 0.01185949519276619, 0.009249924682080746, -0.0039023119024932384, 0.008101713843643665, 0.031411200761795044, 0.013754445128142834, 0.04210642725229263, 0.016524605453014374, -0.030752787366509438, -0.03375580161809921, 0.008033462800085545, -0.000628806184977293, -0.03187691047787666, 0.015545012429356575, 0.024473758414387703, 0.013377061113715172, 0.02094080112874508, -0.00029106749570928514, 0.007491475436836481, -0.023301459848880768, 0.009009040892124176, 0.018788909539580345, -0.028119128197431564, -0.033145561814308167, 0.03934429585933685, -0.011441963724792004, 0.03706393390893936, 0.016339927911758423, 0.023028457537293434, -0.01992909051477909, -0.019688207656145096, 0.03471933677792549, 0.007383077871054411, 0.0148303909227252, -0.009410513564944267, 0.01506324578076601, 0.010044840164482594, -0.021936453878879547, -0.008527274243533611, -0.009852133691310883, -0.0010297767585143447, -0.012574116699397564, 0.04313419759273529, 0.007278695236891508, 0.028665130957961082, 0.03468721732497215, 0.006568088661879301, -0.001278689713217318, 0.005488127935677767, 0.0025413203984498978, -0.023301459848880768, 0.019302794709801674, -0.021149568259716034, 0.006343264132738113, 0.027669480070471764, 4.8176691052503884e-05, -0.014581478200852871, 0.05061764270067215, -0.03719240427017212, 0.017327550798654556, 0.012052202597260475, 0.0306403748691082, 0.01116896327584982, 0.02497158572077751, -0.0017704933416098356, 0.010767490603029728, 0.023927755653858185, -0.005403819028288126, 0.044836439192295074, 0.019736384972929955, -0.046153269708156586, 0.01024557650089264, -0.024393465369939804, -0.027268007397651672, -0.0041311513632535934, 0.0002002343680942431, -0.02219339646399021, -0.0003628307022154331, -0.004219475202262402, 0.021117448806762695, 0.003494817530736327, -0.010317841544747353, -0.01626766286790371, 0.011682847514748573, 0.016339927911758423, 0.004821683745831251, -0.012421556748449802, 0.014091681689023972, 0.024810995906591415, 0.04438679292798042, 0.013762474991381168, -0.04374443367123604, -0.024441640824079514, 0.009225836023688316, 0.028167305514216423, -0.010912020690739155, -0.006788898725062609, -0.010550695471465588, 0.029532311484217644, 0.014894627034664154, 0.05007164180278778, 0.004088996443897486, -0.019174322485923767, -0.0014372712466865778, 0.005118773318827152, -0.007623961195349693, -0.027107417583465576, -0.011104727163910866, 0.013128148391842842, 0.024923408403992653, 0.012582145631313324, -0.000915357144549489, 0.009699573740363121, -0.0025754456873983145, -0.021165626123547554, -0.003496824763715267, -0.03161996975541115, 0.02360657788813114, -0.00776849128305912, -0.011650729924440384, -0.017439961433410645, -0.04493279382586479, -0.021711628884077072, 0.015304128639400005, 0.016492487862706184, 0.013617944903671741, -0.009603220038115978, 0.015930425375699997, -0.03343462198972702, -0.021518921479582787, 0.025646058842539787, 0.008736039511859417, -0.008623627945780754, -0.022370044142007828, -0.006190704647451639, 0.004115092568099499, 0.03211779519915581, 0.00012552285625133663, 0.011546347290277481, -0.020619623363018036, 0.0011612590169534087, -0.024329228326678276, 0.017086666077375412, 0.021213803440332413, -0.01367415115237236, 0.020250268280506134, -0.033659446984529495, -0.020683858543634415, 0.0006278025102801621, 0.02783006802201271, -0.0064516616985201836, -0.04043630138039589, -0.00925795454531908, -0.0031174332834780216, 0.03242291137576103, 0.016315840184688568, -0.0020816344767808914, -0.03214991092681885, -0.005090670194476843, -0.011032462120056152, 0.02969290129840374, -0.027219830080866814, -0.024232875555753708, 0.004841757472604513, 0.033691566437482834, 0.02233792655169964, -0.01250988058745861, -0.0034486481454223394, 0.006351293995976448, 0.024843113496899605, 0.004044834524393082, -0.0068691931664943695, -0.019591854885220528, -0.0379953496158123, 0.02315692976117134, 0.014332565478980541, -0.004255607724189758, -2.6550500479061157e-05, 0.027621302753686905, 0.005612584296613932, -0.003145536407828331, -0.0012967559741809964, 0.011265316046774387, 0.015866190195083618, 0.04685986042022705, -0.016797605901956558, -0.02498764358460903, -0.013963211327791214, -0.020330563187599182, 0.029050543904304504, -0.0011893620248883963, -0.020619623363018036, -0.0033161621540784836, -0.007925065234303474, 0.00213984795846045, 0.029018426313996315, 0.004392108414322138, -0.014220152981579304, -0.0031154260504990816, -0.018355319276452065, -0.02781401015818119, -0.01954367756843567, 0.0949402004480362, 0.0013609915040433407, -0.019591854885220528, 0.013577797450125217, 0.012879235669970512, 0.019559737294912338, -0.03145937994122505, -0.003563067875802517, -0.013650062493979931, 0.0150953633710742, -0.015609247609972954, 0.021615276113152504, 0.0306403748691082, -0.004624962341040373, 0.013545679859817028, 0.01811443641781807, 0.02177586406469345, 0.009892280213534832, 0.0013208442833274603, -0.0018407510360702872, 0.0116025535389781, 0.02004150301218033, 0.03632522374391556, 0.010863843373954296, -0.018708614632487297, 0.004207430873066187, 0.03760993853211403, 0.0030772860627621412, 0.011401817202568054, 0.010920049622654915, 0.05248047411441803, -0.05273741856217384, 0.0007241558632813394, 0.023349637165665627, -0.009161600843071938, 0.009522926062345505, -0.004757448099553585, 0.020202092826366425, -0.005046508274972439, 0.012437615543603897, -0.008744069375097752, -0.030046196654438972, 0.0012947486247867346, 0.02175980620086193, 0.04958987236022949, 0.07098032534122467, 0.02407228574156761, 0.027284065261483192, -0.010141193866729736, -0.0008661767351441085, -0.02036268077790737, 0.029837431386113167, -0.0015787903685122728, 0.032294441014528275, 0.0038902678061276674, -0.0066564129665493965, -0.029435958713293076, -0.015545012429356575, 0.006792913656681776, 0.027637362480163574, -0.04763069003820419, 0.02977319434285164, -0.012517910450696945, -0.0007397129666060209, 0.006881237495690584, -0.07213656604290009, -0.0044081672094762325, -0.005227170884609222, -0.023847462609410286, -0.0032398824114352465, -0.013344943523406982, -0.003021080046892166, -0.005283377133309841, -0.005881571210920811, 0.01674943044781685, 0.0024429596960544586, -0.022980282083153725, -0.01943126507103443, 0.03844499960541725, -0.020635683089494705, -0.010149222798645496, -0.02970895916223526, -0.030720669776201248, -0.003332221182063222, -0.012879235669970512, -0.019318852573633194, 0.004516564775258303, 0.02686653472483158, -0.023959875106811523, -0.014493154361844063, 0.004183342680335045, 0.02280363440513611, 0.017777198925614357, 0.008543333038687706, -0.016974253579974174, -0.014477095566689968, 0.01552895363420248, 0.011345610953867435, -0.012124467641115189, -0.02371899038553238, 0.017407843843102455, 0.008760128170251846, -0.020571447908878326, 0.06333629041910172, -0.012646381743252277, 0.010976255871355534, -0.011899642646312714, -0.008210111409425735, -0.0038260321598500013, 0.017456021159887314, 0.004351960960775614, -0.00017727517115417868, -0.007945138961076736, -0.003920378163456917, -0.008856481872498989, 0.028215482831001282, 0.0066604274325072765, -0.0006639350322075188, 0.007342930883169174, 0.024907348677515984, -0.0048457724042236805, 0.022835751995444298, 0.004733359906822443, 0.003263970836997032, 0.03203750029206276, -0.027685537934303284, 0.007371033541858196, -0.00487788999453187, 0.018869204446673393, -0.0019230529433116317, -0.03767417371273041, 0.007832727394998074, 0.016877900809049606, 0.020330563187599182, -0.00313349231146276, -0.020780213177204132, -0.002326532732695341, -0.0017162946751341224, 0.0034125156234949827, -0.013079972006380558, -0.020073620602488518, 0.01019739918410778, -0.02318904735147953, -0.018467731773853302, -0.016026780009269714, -0.03126667067408562, -0.007619946729391813, 0.013136177323758602, -0.020282387733459473, -0.0013810651144012809, -0.014726008288562298, -0.005624628625810146, -0.02501976117491722, 0.00858348049223423, -0.003265978069975972, 0.0070819733664393425, -0.018435614183545113, -0.0023325548972934484, -0.009009040892124176, -0.01580195501446724, -0.0007718307315371931, -0.017456021159887314, -0.00972366239875555, -0.002946807537227869, 0.011867525056004524, 0.026095706969499588, -0.007973242551088333, -0.014645714312791824, -0.0008511215564794838, 0.0037878924049437046, 0.012895294465124607, 0.0334988608956337, 0.020234210416674614, 0.005969895049929619, 0.01904585212469101, 0.005833394359797239, 0.017969906330108643, -0.00029307487420737743, 0.0037497524172067642, 0.010052869096398354, -0.02688259445130825, -0.023927755653858185, -0.0043640052899718285, -0.016861841082572937, -0.023991992697119713, 0.028054893016815186, 0.016492487862706184, -0.0035409866832196712, 0.020699918270111084, -0.0014151902869343758, -0.014091681689023972, -0.006034130696207285, -0.015601218678057194, -0.003894282504916191, 0.007591843605041504, 0.040629010647535324, -0.011072609573602676, 0.015729689970612526, 0.005572437308728695, 0.01999332755804062, -0.003607229795306921, -0.036485813558101654, 0.0070578851737082005, -0.004372034687548876, -0.06372170150279999, -0.004331887699663639, -0.017472079023718834, 0.005431921686977148, 0.05347612872719765, 0.015930425375699997, 0.004757448099553585, -0.014380741864442825, 0.011747083626687527, -0.0097638089209795, 0.018885262310504913, 0.007623961195349693, -0.00040373069350607693, 0.029403841122984886, -0.012742734514176846, 0.016074955463409424, 0.028199423104524612, 0.013730357401072979, 0.028600895777344704, 0.0008104724693112075, -0.028922073543071747, -0.02225763164460659, 0.013039824552834034, -0.021534981206059456, 0.02187221683561802, -0.006319175940006971, 0.0352974571287632, 0.011345610953867435, -0.006331220269203186, 0.02094080112874508, -0.017343608662486076, 0.0022643045522272587, 0.024843113496899605, -0.05071399733424187, -0.035072632133960724, -0.02738041989505291, -0.005403819028288126, 0.003500839462503791, -0.016958195716142654, -0.025308821350336075, -0.013762474991381168, 0.02370293252170086, -0.007664108648896217, -0.01071128435432911, 0.010574784129858017, -0.018210789188742638, -0.012493821792304516, 0.027653420343995094, -0.002583475084975362, 0.0038440984208136797, -0.01768084615468979, -0.005688864272087812, -0.02188827656209469, -0.026384767144918442, -0.011209109798073769, 0.039183709770441055, -0.028857838362455368, -0.004982272628694773, 0.010992314666509628, 0.009900310076773167, 0.010944138281047344, -0.014726008288562298, -0.028199423104524612, -0.06532759219408035, -0.014244241639971733, -0.010614930652081966, 0.0011120786657556891, 0.010317841544747353, -0.012116437777876854, 0.025710294023156166, -0.030335256829857826, -0.019286734983325005, -0.008210111409425735, 0.019383089616894722, 0.03584345802664757, 0.00929007213562727, 0.00498628756031394, 0.006997664459049702, -0.03754569962620735, -0.0180983766913414, 0.012485792860388756, 0.019591854885220528, -0.009097364731132984, 0.026561414822936058, -0.011048520915210247, 0.0160348080098629, -0.014244241639971733, 0.020748095586895943, -0.03610039874911308, 0.029580488801002502, 0.004024761263281107, 0.022402161732316017, -0.012172644026577473, -0.018323201686143875, 0.016910018399357796, 0.025148233398795128, -0.03253532573580742, -0.031780555844306946, 0.0085593918338418, -0.0073349010199308395, 0.005933762528002262, 0.01668519340455532, -0.004532623570412397, 0.02360657788813114, -0.010382076725363731, 0.004817669279873371, 0.023301459848880768, -0.009956516325473785, 0.014444977976381779, 0.013754445128142834, 0.01670125313103199, 0.006901310756802559, -0.002589497249573469, 0.028857838362455368, -0.01625160314142704, -0.02739647775888443, 0.027251947671175003, 0.0070779589004814625, 0.02548546902835369, 0.0009063240140676498, 0.04255607724189758, 0.04213854670524597, 0.010952168144285679, -0.034173332154750824, -0.0030411535408347845, -0.025244586169719696, 2.6848469133256003e-05, 0.0019230529433116317, -0.006580132991075516, -0.0006092343828640878, 0.026095706969499588, 0.013152237050235271, -0.037320878356695175, 0.0048297131434082985, 0.004757448099553585, -0.030784904956817627, -0.030784904956817627, 0.012252938002347946, 0.022386102005839348, 0.01665307581424713, -0.030784904956817627, 0.03166814520955086, 0.015296099707484245, -0.020764153450727463, -0.024008050560951233, 0.014284389093518257, 0.014059564098715782, 0.02603147178888321, -0.0444510281085968, -0.00020148897601757199, -0.0023847462143749, -0.011297433637082577, -0.002328539965674281, 0.014742067083716393, 0.034173332154750824, 0.014693890698254108, -0.00860756915062666, -0.005456010345369577, -0.01161058247089386, 0.0027882258873432875, -0.02177586406469345, 0.0034486481454223394, 0.004608903545886278, -0.06474947184324265, 0.002569423522800207, -0.01805019937455654, 0.02879360318183899, 0.03343462198972702, 0.00416728388518095, -0.04043630138039589, -0.014782214537262917, -0.0317002609372139, -0.027155594900250435, -0.0077283442951738834, 0.010727343149483204, 0.016797605901956558, 0.026192061603069305, -0.028889955952763557, -0.006953502539545298, -0.0342375673353672, 0.021711628884077072, 0.006519912276417017, 0.015793925151228905, 0.006122454535216093, 0.012927412055432796]",Model Alignment as Prospect Theoretic Optimization.pdf
