text,embedding,file
"KV-Runahead: Scalable Causal LLM Inference by
Parallel Key-Value Cache Generation
Minsik Cho1Mohammad Rastegari2Devang Naik1
Abstract
Large Language Model or LLM inference has two
phases, the prompt (or prefill) phase to output the
first token and the extension (or decoding) phase
to the generate subsequent tokens. In this work,
we propose an efficient parallelization scheme,
KV-Runahead to accelerate the prompt phase.
The key observation is that the extension phase
generates tokens faster than the prompt phase be-
cause of key-value cache (KV-cache). Hence,
KV-Runahead parallelizes the prompt phase by
orchestrating multiple processes to populate the
KV-cache and minimizes the time-to-first-token
(TTFT). Dual-purposing the KV-cache scheme
has two main benefits. First, since KV-cache is
designed to leverage the causal attention map, we
minimize computation and computation automati-
cally. Second, since it already exists for the exten-
sion phase, KV-Runahead is easy to implement.
We further propose context-level load-balancing
to handle uneven KV-cache generation (due to
the causal attention) and to optimize TTFT. Com-
pared with an existing parallelization scheme such
as tensor or sequential parallelization where keys
and values are locally generated and exchanged
via all-gather collectives, our experimental results
demonstrate that KV-Runahead can offer over
1.4×and 1.6 ×speedups for Llama 7B and Falcon
7B respectively.
1. Introduction
Large language models or LLMs, and especially Generative
Pre-trained Transformer (GPT) models have shown excel-
lent performance on many complex language tasks (Ouyang
et al., 2022; Zhang et al., 2022a). However, the decoder
architecture and autoregression execution in LLMs pose
1Apple. USA2Meta. USA (the work done while being with
Apple). Correspondence to: Minsik Cho <minsik@apple.com >.
Proceedings of the 41stInternational Conference on Machine
Learning , Vienna, Austria. PMLR 235, 2024. Copyright 2024 by
the author(s).two challenges for efficient inferences: a) Time-to-first-
token or TTFT : consuming potentially a long user context
and generate the first token b) Time Per Output Token
or TPOT : generating the subsequent tokens fast (Liu et al.,
2023a). The second challenge is known to be a memory-
bound problem, and a large body of research has been
done (Pope et al., 2022), including sparsification, quan-
tization, or weight clustering (Frantar et al., 2023; Lin et al.,
2023; Cho et al., 2023; Liu et al., 2023b) or speculative de-
coding (Leviathan et al., 2023; Chen et al., 2023). But, the
first challenge for a long user context is largely a compute-
bound problem (Liu et al., 2023a; NVidia-LLM, 2023) and
critical for favorable user experience with retrieval augmen-
tation (Ram et al., 2023), in-context learning (Dong et al.,
2023), summarization (Zhang et al., 2023b), story genera-
tion (Zhang et al., 2023a), and so on.
Since TTFT for a long context is compute-bound, one so-
lution is to use more computing power in the form of par-
allelization. The current SOTA in LLM parallelization inl-
cudes tensor and sequential parallelization (Patel et al., 2023;
Li et al., 2023; Korthikanti et al., 2022; NVidia-LLM, 2023)
where the key and value computations are distributed over
multiple processes and subsequently exchanged, aiming
to compute the attention map perfectly in parallel. The
methods above are generic enough to drive LLM infer-
ence (Vaswani et al., 2017), but not specialized enough
for scalable LLM inference, as the causality in attention is
not fully leveraged, resulting in up to 2 ×overhead in terms
of both computation and communication over the ideal case.
Therefore, we propose a novel yet effective parallelization
technique tailed for LLM inference, KV-Runahead to min-
imize TTFT. By re-purposing the key-value cache or KV-
cache (NVidia-LLM, 2023)","[0.005207035690546036, 0.002440153155475855, 0.011136315762996674, -0.01634335145354271, -0.002321498701348901, 0.014912620186805725, 0.022368930280208588, 0.0296876709908247, -0.02594575844705105, 0.028339480981230736, 0.014761293306946754, 0.024446241557598114, -0.02971518412232399, 0.007655787281692028, -0.03395234793424606, -0.041628770530223846, -0.003442696761339903, -0.03265918791294098, 0.005915523041039705, 0.017526455223560333, -0.0258769728243351, -0.04209651052951813, 0.02324938029050827, 0.04553576931357384, 0.00982939824461937, -0.027692900970578194, -0.012470747344195843, 0.020387917757034302, 0.02034664712846279, -0.06735441833734512, 0.028366995975375175, -0.03018292412161827, -0.08287234604358673, -0.03904245048761368, -0.018214307725429535, 0.06779464334249496, 0.03307189792394638, -0.015600471757352352, -0.01670103333890438, 0.038189515471458435, 0.030898289754986763, -0.08078128099441528, -0.030953317880630493, 0.017581483349204063, 0.015572957694530487, 0.0339798629283905, 0.01661849208176136, -0.0019466197118163109, -0.038106974214315414, 0.038437142968177795, 0.0035286780912429094, -0.0019328626804053783, -0.04996553063392639, 0.009162181988358498, -0.03367720916867256, 0.0035837062168866396, 0.030623149126768112, -0.012429476715624332, 0.035107940435409546, 0.004993801936507225, 0.03007286787033081, -0.06333736330270767, 0.009588649496436119, 0.025106579065322876, -0.031090887263417244, -0.00986379012465477, -0.017829110845923424, 0.008584386669099331, -0.022410200908780098, 0.030430549755692482, -0.018558233976364136, 0.017664026468992233, 0.028105610981583595, -0.01626080833375454, -0.0067994119599461555, 0.022465229034423828, -0.010868053883314133, 0.05434026941657066, 0.03579579293727875, 0.01934238336980343, 0.037859346717596054, -0.0062972805462777615, 0.03681381046772003, -0.01337871141731739, 0.027720414102077484, -0.038519684225320816, -0.021557265892624855, -0.00023300969041883945, -0.035107940435409546, -0.03243907541036606, 0.00163192767649889, 0.04391244053840637, -0.034695230424404144, 0.034722741693258286, 0.06388764828443527, 0.07054604589939117, 0.025340449064970016, -0.03598839044570923, 0.04308701679110527, 0.05893511697649956, 0.01298663578927517, 0.005041951313614845, 0.03973030298948288, -0.03989538550376892, 0.0599256232380867, -0.015036433935165405, -0.02375839091837406, 0.018489448353648186, -0.029192417860031128, -0.03629104420542717, -0.0868343710899353, -0.0016405257629230618, -0.040968433022499084, -0.006084046326577663, -0.004164940677583218, -0.07973574101924896, -0.061301324516534805, -0.0042578005231916904, 0.0004144305130466819, -0.012064915150403976, -0.030430549755692482, 0.0037831831723451614, 0.027390247210860252, -0.0163020808249712, -0.02264407090842724, -0.03653867170214653, 0.018186792731285095, -0.053542360663414, 0.025588074699044228, -0.002519255969673395, 0.00246766721829772, 0.018049223348498344, 0.04960785061120987, -0.004670511465519667, -0.04239916428923607, -0.012704617343842983, -0.04575588181614876, 0.0009733098559081554, -0.03623601794242859, 0.018668290227651596, -0.01960376836359501, -0.020511731505393982, 0.007119263056665659, 0.028944790363311768, -0.03992290049791336, 0.03934510424733162, -0.018131764605641365, 0.024913981556892395, -0.024611325934529305, -0.004601726308465004, -0.025161607190966606, -0.03241156041622162, -0.014637479558587074, 0.007415038999170065, -0.017801595851778984, -0.030678177252411842, -0.0588250607252121, 0.03631855919957161, 0.025037793442606926, -0.030953317880630493, -0.011837923899292946, 0.004006735049188137, 0.041161034256219864, 0.0022303585428744555, 0.0072499546222388744, 0.009451079182326794, -0.06652899831533432, 0.003036864334717393, -0.06828989833593369, -0.0588250607252121, -0.01620578020811081, -0.03400737792253494, -0.06366753578186035, 0.0035132013726979494, 0.027225162833929062, -0.02993529662489891, -0.04069329425692558, -0.0227541271597147, -0.01704495958983898, -0.03975781425833702, -0.04369232803583145, 0.06498821079730988, 0.006974813994020224, 0.03527302294969559, -0.054973091930150986, 0.010544762946665287, 0.012401962652802467, 0.031145915389060974, -0.0265648253262043, 0.02941253036260605, -0.019039729610085487, 0.015765557065606117, 0.06273205578327179, 0.05274445191025734, -0.0002897574449889362, -0.009485471993684769, 0.05010310187935829, 0.015187760815024376, -0.002682620892301202, -0.034172460436820984, 0.017512699589133263, -0.007057356182485819, -0.005918961949646473, -0.08589889109134674, 0.04597599431872368, -0.0032500983215868473, -0.007600759156048298, 0.008611900731921196, -0.018283093348145485, -0.04740672558546066, 0.027197647839784622, 0.02036040462553501, 0.06504323333501816, 0.03681381046772003, 0.004673950839787722, -0.018131764605641365, -0.054175183176994324, 0.008756349794566631, 0.0070986272767186165, 0.0388498529791832, 0.015572957694530487, 0.004532941151410341, -0.022217603400349617, 0.02000272087752819, -0.028009312227368355, 0.03549313545227051, -0.012051157653331757, -0.034199975430965424, 0.04223408177495003, -0.00802034791558981, 0.03722652420401573, -0.038409627974033356, -0.009045246988534927, -0.027225162833929062, -0.005520008038729429, -0.05998064950108528, 0.024473756551742554, -0.010737361386418343, 0.009065882302820683, -0.06372255831956863, 0.0005068605532869697, 0.012924729846417904, 0.0019930496346205473, -0.01483007799834013, -0.008598143234848976, 0.03873979672789574, -0.028105610981583595, -0.024253644049167633, 0.06410776078701019, 0.024528784677386284, -0.009492350742220879, -0.010998745448887348, -0.054312754422426224, 0.0015330490423366427, -0.050956036895513535, 0.002993873553350568, 0.004254361614584923, -0.002670583315193653, 0.004804642871022224, 0.000680543074849993, -0.007511338219046593, -0.005956793669611216, 0.0010653099743649364, 0.019177298992872238, -0.012381326407194138, -0.017980437725782394, -0.0235107634216547, 0.0010016837622970343, -0.030650662258267403, -0.0324665904045105, 0.045068029314279556, -0.028284452855587006, 0.0019638161174952984, -0.025037793442606926, -0.009739977307617664, -0.007875899784266949, 0.021529750898480415, 0.0030901727732270956, 0.017278829589486122, 0.0168523620814085, -0.00977437011897564, 0.02291921153664589, 0.08094636350870132, -0.014692507684230804, -0.007208683528006077, 0.0023232183884829283, -0.00035746782668866217, -0.003466771449893713, -0.02338695153594017, -0.038299571722745895, 0.02699129283428192, -0.009451079182326794, 0.020965714007616043, -0.00830924604088068, 0.04275684803724289, 0.03989538550376892, 0.0015020957216620445, 0.021378424018621445, -0.021626051515340805, 0.021323395892977715, 0.04611356556415558, 0.004450398962944746, 0.010248987004160881, -0.0008439078228548169, -0.014252282679080963, 0.02304302528500557, -0.012972879223525524, 0.0004600006795953959, -0.021020742133259773, 0.01987890712916851, 0.0006878515123389661, 0.011989251710474491, 0.004704904276877642, 0.02026410400867462, -0.00836427416652441, -0.04000544175505638, 0.031696196645498276, -0.0665840208530426, 0.03744663670659065, -0.038299571722745895, -0.0011753662256523967, -0.06212674826383591, -0.018324363976716995, 0.01665976271033287, 0.017471427097916603, -0.000529215729329735, -0.0011048614978790283, -0.008969583548605442, 0.009581771679222584, 0.00036112204543314874, 0.00036993512185290456, 0.010008239187300205, -0.0031056494917720556, -0.01990642212331295, -0.06240188702940941, -0.04264679178595543, -0.03348461166024208, -0.019108515232801437, 0.04718661308288574, -0.007827750407159328, -0.09123662114143372, 0.010744240134954453, -0.013021028600633144, 0.008997097611427307, -0.0012570485705509782, 0.05392755568027496, 0.031558625400066376, -0.0004767670761793852, 0.05695410445332527, 0.005939597729593515, 0.006679038051515818, -0.03574076294898987, 0.051561348140239716, -0.01310357078909874, 0.017526455223560333, 0.01608196832239628, 0.018062980845570564, -0.03362217918038368, -0.0015115536516532302, -0.0013817216968163848, -0.018530718982219696, 0.009554257616400719, 0.024253644049167633, 0.005213914439082146, -0.014045927673578262, -0.006176906172186136, -0.0328793004155159, 0.012862822972238064, 0.020910685881972313, 0.01505019050091505, 0.021268367767333984, 0.018709560856223106, -0.020456703379750252, -0.018200550228357315, -0.03579579293727875, -0.0010429548565298319, -0.01166596170514822, 0.03678629919886589, 0.022602800279855728, 0.050956036895513535, 0.02674366533756256, 0.00018958906002808362, -0.009313508868217468, -0.00672374852001667, 0.021048255264759064, 0.034805286675691605, 0.01311732828617096, -0.0388498529791832, -0.058219749480485916, -0.002515816828235984, 0.00020614049572031945, 0.00733937555924058, -0.0007299823919311166, 0.04237165302038193, 0.017842868342995644, 0.03642861545085907, -0.005048830062150955, 0.01587561145424843, 0.048149604350328445, 0.051286205649375916, 0.0026654244866222143, -0.02263031341135502, -0.02963264286518097, 0.021117040887475014, 0.021942462772130966, 0.0130416639149189, 0.025312934070825577, 0.020993227139115334, 0.04891999810934067, 0.01522903237491846, 0.054863035678863525, -0.018461933359503746, 0.020814385265111923, -0.06311725080013275, 0.058109693229198456, -0.008811377920210361, 0.01126012858003378, 0.02362081967294216, 0.021103283390402794, 0.05976053699851036, -0.0012553289998322725, -0.01957625336945057, -0.047791920602321625, -0.04925016686320305, -0.0046464367769658566, 3.342528361827135e-05, 0.04033561050891876, -0.060475904494524, 0.025395477190613747, -0.04891999810934067, -0.032741729170084, 0.0074563100934028625, 0.06245691701769829, -0.003502883715555072, -0.03763923421502113, -0.005031633656471968, -0.01687987521290779, 0.05370744317770004, -0.000999104231595993, -0.06223680451512337, 0.0077933575958013535, -0.02624841220676899, -0.02286418341100216, 0.00415462302044034, -0.044297635555267334, 0.006816608365625143, -0.03197133541107178, -0.006961056962609291, 0.02979772724211216, -0.034282516688108444, 0.03307189792394638, 0.025684375315904617, 0.05959545448422432, 0.015187760815024376, 0.018516961485147476, -0.03978532925248146, 0.08254218101501465, -0.009382294490933418, 0.03659369796514511, 0.0008550853817723691, 0.008708199486136436, 0.03607093170285225, -0.04025306925177574, -0.02921993099153042, 0.02670239470899105, 0.01488510612398386, 0.051781460642814636, 0.012367569841444492, 0.031448569148778915, 0.013358076103031635, 0.01350252516567707, -0.030788233503699303, -0.00147200224455446, -0.011342670768499374, -0.050983551889657974, 0.010929959826171398, 0.01608196832239628, -0.041518714278936386, -0.002459069015458226, -0.0014505068538710475, 0.013990899547934532, -0.0014754415024071932, 0.04671887308359146, 0.00761451618745923, 0.01299351453781128, 0.04586593806743622, 0.01979636587202549, 0.018062980845570564, -0.010455342940986156, 0.017168773338198662, -0.019328627735376358, -0.01687987521290779, 0.024707624688744545, -0.015724284574389458, -0.0012372728670015931, 0.01348876766860485, -0.024583812803030014, -0.0021289002615958452, 0.010359043255448341, -0.01643965020775795, 0.013241141103208065, -0.011982372961938381, 0.006231934297829866, 0.020525489002466202, -0.000304374290863052, 0.03703392297029495, 0.054505351930856705, 0.01355067454278469, 0.015201518312096596, 0.025065308436751366, -0.01634335145354271, 0.03340206667780876, -0.00031942102941684425, 0.02329065091907978, 0.005323970690369606, 0.044600289314985275, -0.02333192341029644, 0.03590584918856621, 0.021529750898480415, 0.00749758118763566, 0.0026052375324070454, 0.0046533155255019665, -0.030678177252411842, -0.012594561092555523, 0.007910291664302349, -0.018296848982572556, -0.044655319303274155, -0.13558928668498993, -0.03279675915837288, -0.04652627557516098, 0.031476084142923355, 0.009691827930510044, -0.027459030970931053, -0.008013470098376274, -0.04663633182644844, 0.0032500983215868473, 0.00969870574772358, -0.02963264286518097, -0.04969039186835289, -0.02320810966193676, 0.017691539600491524, 0.019177298992872238, 0.01960376836359501, 0.04630616307258606, -0.017292587086558342, -0.024267399683594704, 0.04311453178524971, -0.03422749042510986, -0.012573924846947193, 0.025326691567897797, 0.023840932175517082, -0.031806252896785736, 0.017664026468992233, -0.025904487818479538, 0.0035665100440382957, -0.010255865752696991, -0.0003828323388006538, 0.006042775232344866, -0.022052519023418427, 0.001321534626185894, 0.034310031682252884, 0.02276788465678692, 0.006221616640686989, -0.0269775353372097, -0.002864901442080736, -0.0038313327822834253, 0.02263031341135502, -0.022162575274705887, -0.0028563032392412424, 0.025189122185111046, -0.02979772724211216, -0.02337319403886795, 0.022217603400349617, -0.012340055778622627, 0.031778737902641296, -0.014155983924865723, 0.0070986272767186165, 0.008749471046030521, 0.025725645944476128, 0.02313932403922081, -0.04066577926278114, -0.01657722145318985, -0.0260833278298378, -0.022410200908780098, -0.03268670290708542, 0.0167147908359766, -0.028133125975728035, 0.01160405483096838, -0.03929007798433304, 0.009602406993508339, 0.031173430383205414, -0.011246372014284134, 0.024542540311813354, -0.01946619711816311, -0.022492744028568268, 0.0135575532913208, 0.013688244856894016, -0.029164902865886688, -0.037859346717596054, -0.01612323895096779, 0.004374735523015261, 0.008666928857564926, -0.002422956982627511, -0.0163020808249712, 0.0006568981916643679, 0.03296184167265892, -0.04652627557516098, 0.01488510612398386, 0.02631719782948494, -0.00969870574772358, 0.0026241533923894167, -0.0301003810018301, -0.010104537941515446, -0.02949507161974907, -0.03662121295928955, -0.004739296622574329, -0.0022217603400349617, -0.014802563935518265, 0.02696377784013748, -0.02033288963139057, 0.03697889670729637, -0.021240854635834694, 0.004078959114849567, -0.004708343651145697, 0.00420277239754796, -2.8750042474712245e-05, -0.015187760815024376, -0.020429188385605812, -0.030953317880630493, 0.017595240846276283, -0.02949507161974907, -0.015380359254777431, -0.0015115536516532302, 0.01674230583012104, 0.01599942520260811, 0.01631583645939827, 0.015339088626205921, -0.01620578020811081, 0.021405939012765884, -0.006156270857900381, 0.01690739020705223, 0.025835702195763588, -0.005678214132785797, -0.018021708354353905, 0.031173430383205414, -0.001986171118915081, 0.012745887972414494, 0.021020742133259773, -0.006046214606612921, -0.02324938029050827, -0.024996522814035416, -0.04872740060091019, 0.051203664392232895, 0.015793070197105408, 0.04217905178666115, -0.010723604820668697, 0.006462364923208952, -0.02627592720091343, -0.005908644292503595, -0.0021443769801408052, -0.04338967055082321, -0.012890337035059929, -0.03375975042581558, -0.0010592913022264838, -0.0032999676186591387, 0.02366209216415882, 0.02938501536846161, 0.021337153390049934, -4.5516422687796876e-05, -0.0072774686850607395, -0.0007295524701476097, -0.0038038187194615602, 0.01657722145318985, -0.014389852993190289, -0.006912907585501671, -0.005348045378923416, -0.005072904750704765, -0.022451473399996758, -0.009079639799892902, 0.0066549633629620075, -0.04751678183674812, 0.0026654244866222143, -0.04969039186835289, -0.0019431804539635777, 0.008171675726771355, 0.034777771681547165, 0.03007286787033081, 0.001229534507729113, 0.027541574090719223, -0.024226129055023193, -0.008845769800245762, -0.015916883945465088, 0.027376489713788033, -0.04622362181544304, 0.008900797925889492, 0.01979636587202549, -0.0012544691562652588, 0.03997792676091194, -0.021103283390402794, -0.05673399195075035, -0.018778346478939056, 0.006104682106524706, -0.02692250721156597, 0.00206183479167521, -0.012353812344372272, -0.028944790363311768, -0.03252161666750908, 0.008281731978058815, 0.04206899553537369, -0.022451473399996758, -0.022616557776927948, -0.007126141339540482, -0.008935190737247467, -0.0025330130010843277, -0.03956521674990654, 0.0029474436305463314, -0.01627456583082676, -0.0071330200880765915, -0.006018700543791056, -0.024363700300455093, -0.04947027936577797, 0.01660473458468914, -0.004175258334726095, 0.0009862070437520742, 9.67291125562042e-05, 0.0074287960305809975, -0.01668727770447731, 0.048507288098335266, 0.027486545965075493, 0.02941253036260605, 0.028917277231812477, 0.010434706695377827, 0.021887434646487236, -0.02675742283463478, -0.023909717798233032, -0.0011693475535139441, -0.05021315813064575, -0.01317235641181469, -0.021309638395905495, -0.015256546437740326, -0.006149392109364271, -0.03563070669770241, 0.00024526205379515886, 0.05717421695590019, 0.010001360438764095, -0.008123526349663734, 0.02644101157784462, 0.015339088626205921, -0.010572277009487152, -0.007855264469981194, -0.01649467833340168, 0.01332368329167366, 0.01682484708726406, 0.015297817066311836, 0.02996281161904335, -0.010324650444090366, 0.031145915389060974, -6.980617763474584e-05, -0.010661697946488857, -0.008694442920386791, 0.014211012050509453, -0.011989251710474491, -0.01712750270962715, 0.0011985811870545149, 0.03285178542137146, -0.01333744078874588, -0.004522623494267464, -0.04938773810863495, 0.0069816927425563335, 0.008715078234672546, -0.00846745166927576, -0.015600471757352352, 0.012285027652978897, 0.008549993857741356, 0.00970558449625969, -0.0331544429063797, 0.02974269911646843, 0.018613262102007866, 0.019136028364300728, 0.03681381046772003, -0.0061081210151314735, -0.025381719693541527, -0.017086230218410492, -0.04622362181544304, -0.011913587339222431, -0.008708199486136436, -0.024515027180314064, -0.005987747106701136, 0.0004333464312367141, -0.022534014657139778, -0.018833374604582787, -0.018915915861725807, 0.017196286469697952, 0.010317772626876831, 0.00328793004155159, 0.04911259561777115, -0.0034684911370277405, -0.10053637623786926, -0.031035859137773514, 0.017842868342995644, 0.013915235176682472, 0.017691539600491524, -0.025533046573400497, -0.00796531978994608, -0.00830236729234457, 0.014114712364971638, -0.020429188385605812, -0.00835051666945219, -0.035080425441265106, -0.027514059096574783, -0.015710528939962387, -0.013192991726100445, -0.05915522947907448, -0.034887827932834625, -0.005998064763844013, 0.03367720916867256, -0.014981405809521675, -0.021006984636187553, -0.00022441154578700662, 0.0017849745927378535, 0.0168523620814085, -0.002956041833385825, -0.027390247210860252, -0.0071330200880765915, 0.005908644292503595, -0.023950988426804543, 0.02282291278243065, -0.014155983924865723, -0.03378726541996002, 0.00050557084614411, 0.03978532925248146, -0.03992290049791336, 0.031283486634492874, -0.012456990778446198, -0.017774082720279694, -0.00652083195745945, -0.035025399178266525, -0.03736409172415733, -0.05387252941727638, 0.02611084282398224, -0.019218571484088898, 0.047654349356889725, -0.010737361386418343, 0.04900253936648369, 0.009175938554108143, 0.0014100956032052636, 0.005698849447071552, 0.009664313867688179, -0.0033085655886679888, 0.012622075155377388, 0.017196286469697952, 0.021818649023771286, 0.013949627988040447, -0.014706265181303024, -0.003979220986366272, 0.025010280311107635, 0.030815746635198593, 0.005217353347688913, -0.002419517608359456, 0.0019724140875041485, -0.006280084140598774, -0.024198615923523903, -0.0010257585672661662, 0.002268190262839198, 0.03706143796443939, 0.015366602689027786, -0.03381478041410446, -0.01517400424927473, 0.01674230583012104, -0.0002805144467856735, 0.014623722992837429, 0.028394509106874466, 0.027293946593999863, -0.007580123376101255, 0.034310031682252884, -0.067959725856781, 0.04380238428711891, 0.05527574568986893, -0.044655319303274155, 0.014362338930368423, 0.0011512914206832647, 0.031118402257561684, 0.007841506972908974, 0.04385741055011749, -0.018173037096858025, -0.02944004349410534, 0.011205100454390049, 0.031806252896785736, -0.04250922054052353, 0.020553002133965492, 0.010723604820668697, 0.025244150310754776, 0.013736394234001637, 0.006424532737582922, 0.01994769275188446, 0.006964496336877346, -0.027968041598796844, 0.03887736797332764, 0.031613655388355255, -0.028449537232518196, -0.05843986198306084, -0.0074907029047608376, 0.010675455443561077, 0.028160639107227325, 0.00406864145770669, 0.02320810966193676, -0.014651237055659294, 0.00964367762207985, 0.019837636500597, -0.017553970217704773, 0.05004807561635971, -0.012106185778975487, 0.038519684225320816, 0.011872316710650921, 0.00761451618745923, 0.02027786150574684, -0.012525775469839573, 0.01694866083562374, 0.04083086550235748, -0.031641166657209396, -0.012739009223878384, -0.024776410311460495, -0.012346934527158737, 0.010881810449063778, 0.025670617818832397, -0.019246084615588188, -0.011335792951285839, -0.007222440559417009, 0.022437715902924538, 0.02301551029086113, -0.009526743553578854, -0.011679718270897865, -0.009540500119328499, -0.025753159075975418, 0.006276644766330719, -0.027582844719290733, 0.05555088445544243, 0.012635831721127033, 0.010262744501233101, 0.0523042269051075, 0.004921577405184507, 0.01964503899216652, 0.008178554475307465, 0.0004350660601630807, -0.012346934527158737, -0.01500891987234354, 0.007236197590827942, 0.025656860321760178, -0.024349942803382874, 0.010434706695377827, 0.0398128442466259, -0.012078671716153622, 0.007587002124637365, 0.001592376152984798, -0.021460967138409615, 0.012016765773296356, 0.04718661308288574, 0.008948948234319687, 0.041188545525074005, -0.009375415742397308, 0.024184858426451683, 0.028999818488955498, -0.01981012336909771, -0.0100907813757658, -0.010001360438764095, -0.004973166156560183, -0.003776304656639695, -0.011129437014460564, -0.04173882678151131, 0.03651115670800209, 0.018173037096858025, 0.044737860560417175, 0.03362217918038368, -0.005145129282027483, -0.005162325222045183, 0.009684949181973934, 0.03257664665579796, -0.01175538171082735, 0.009010854177176952, -0.009602406993508339, 0.007951563224196434, 0.002594919642433524, 0.012071793898940086, -0.0005808045971207321, -0.004054884426295757, -0.004433203022927046, 0.020608030259609222, 0.025436747819185257, 0.014596208930015564, -0.021928705275058746, 0.037996917963027954, 0.002268190262839198, -0.024322427809238434, 0.00808225478976965, 0.034942854195833206, -0.04393995180726051, -0.014651237055659294, -0.06031081825494766, 0.04333464428782463, -0.004230286460369825, -0.019122270867228508, -0.024597568437457085, 0.02696377784013748, -0.007126141339540482, -0.012945365160703659, -0.010971231386065483, 0.004897502716630697, 0.013812057673931122, 0.01670103333890438, -0.035080425441265106, 0.04594847932457924, 0.011170708574354649, -0.019149785861372948, -0.009953211061656475, -0.005224232096225023, -0.01668727770447731, -0.01947995461523533, -0.04614107683300972, -0.003514921059831977, -0.0006384121370501816, 0.01305542141199112, -0.03392483666539192, 0.025835702195763588, 0.004078959114849567, -0.017746567726135254, -0.018365634605288506, 0.0014376096660271287, -0.007002328056842089, -0.0011882634134963155, 0.005836419761180878, 0.010682333260774612, -0.027926770970225334, -0.004219968803226948, -0.007126141339540482, -0.031586140394210815, -0.0009836276294663548, -0.0070986272767186165, 0.01488510612398386, -0.012704617343842983, -0.011301400139927864, 0.003176154335960746, -0.017443913966417313, -0.00018281802476849407, 0.02670239470899105, 0.04231662303209305, -0.0015975350979715586, 0.011404577642679214, 0.010125174187123775, 0.001229534507729113, 0.04256425052881241, -0.015256546437740326, 0.007167412433773279, 0.000748468388337642, 0.02337319403886795, 0.06069601699709892, 0.030540606006979942, 0.03254913166165352, -0.0295500997453928, 0.018695803359150887, 0.012477626092731953, -0.008336760103702545, -0.020319132134318352, -0.030650662258267403, -0.03673126921057701, 0.005372120067477226, 0.024597568437457085, 0.0130072720348835, -0.01711374521255493, 0.017581483349204063, 0.001030917395837605, 0.022217603400349617, -0.01003575325012207, 0.002840826753526926, -0.003004191443324089, -0.0054546622559428215, -0.0014358899788931012, -0.002618994563817978, -0.014486152678728104, -0.01701744645833969, -0.025367962196469307, 0.001965535571798682, -0.0130416639149189, -0.015325331129133701, -0.028091855347156525, 0.0013103571254760027, 0.03576827794313431, -0.006644645240157843, -0.009678070433437824, 0.0398128442466259, 0.015187760815024376, 0.007655787281692028, -0.003291369415819645, -0.011177586391568184, 0.009217210114002228, 0.009134667925536633, 0.014266040176153183, -0.03210890665650368, 0.02693626470863819, 0.018420662730932236, 0.02308429591357708, 0.0036800054367631674, 0.01149399857968092, 0.020883170887827873, -0.0262208990752697, -0.014073441736400127, -0.003004191443324089, 0.004402249585837126, -0.01923232711851597, 0.044957973062992096, 0.013977142050862312, 0.017994195222854614, 0.009519864805042744, -0.000684412254486233, 0.010991866700351238, -0.024969009682536125, 0.022300144657492638, -0.027404002845287323, 0.004876866936683655, 0.01606821082532406, 0.0033016870729625225, 0.00045097264228388667, 0.00835051666945219, -0.03587833419442177, 0.01478880736976862, 0.02706007845699787, 0.0008413283503614366, 0.0005038512172177434, 0.03403489291667938, 0.004539819899946451, 0.012470747344195843, 0.01166596170514822, -0.054560381919145584, 0.011184465140104294, -0.010702969506382942, 0.004577651619911194, -0.004711782559752464, -0.015627985820174217, 0.041353631764650345, 0.021791135892271996, 0.0041099125519394875, 0.01153526920825243, -0.009416687302291393, 0.009409808553755283, -0.01939741149544716, -0.0034031453542411327, 0.007924049161374569, 0.005189839284867048, 0.06394267082214355, -0.022547772154211998, -0.011796653270721436, 0.0074907029047608376, -0.03367720916867256, 0.0260833278298378, -0.006070289295166731, -0.023840932175517082, -0.020594272762537003, 0.015683013945817947, -0.008054740726947784, -0.0001265001919819042, -0.01687987521290779, 0.0036249773111194372, 0.00976749137043953, -0.023854689672589302, 0.004453838337212801, 0.03279675915837288, 0.00036477623507380486, 0.010840539820492268, 0.03527302294969559, 0.007139898370951414, -0.006166588515043259, -0.02329065091907978, -0.010868053883314133, -0.006912907585501671, -0.018585747107863426, 0.029137389734387398, 0.00820606853812933, 0.021323395892977715, 0.0032948085572570562, -0.03563070669770241, -0.048039548099040985, -0.007112384308129549, -0.001277684117667377, 0.03367720916867256, -0.01516024675220251, 0.025257905945181847, -0.0010180202079936862, 0.008123526349663734, 0.020566759631037712, -0.0024573495611548424, -0.01945243962109089, -0.02290545403957367, -0.03263167291879654, -0.014926377683877945, 0.004244043491780758, -0.006269766483455896, 0.013241141103208065, 0.007215562276542187, -0.015765557065606117, -0.009684949181973934, 0.01686611771583557, 0.0033653134014457464, 0.004250922240316868, -0.03906996548175812, 0.018283093348145485, 0.05348733067512512, 0.017691539600491524, 0.02606957219541073, -0.03367720916867256, -0.013137963600456715, -0.03334704041481018, -0.014183497987687588, -0.038079459220170975, -0.018090493977069855, -0.035052910447120667, 0.02999032475054264, -0.02359330654144287, 0.008329881355166435, -0.020938199013471603, -0.005733242258429527, 0.00019904701912309974, 0.018131764605641365, 0.014513666741549969, 0.020869413390755653, -0.011686597019433975, 0.01143209170550108, 0.019218571484088898, 0.03403489291667938, 0.002933686599135399, 0.023964745923876762, -0.028050582855939865, 0.01601318269968033, 0.007697058375924826, 0.01316547766327858, 0.01320674829185009, -0.019149785861372948, -0.00372471590526402, 0.044902946799993515, -0.025079065933823586, 0.01608196832239628, 0.041050978004932404, 0.0004595707869157195, -0.012663345783948898, -0.03224647790193558, -0.03585081920027733, -0.01698993146419525, 0.019273599609732628, 0.0009457957930862904, -0.028449537232518196, 0.002661985345184803, -0.01676981896162033, 0.0010532726300880313, -0.015256546437740326, -0.0170587170869112, -0.05552337318658829, 0.006097803357988596, 0.022506501525640488, 0.01634335145354271, 0.0004544119001366198, -0.02717013470828533, 0.02675742283463478, -0.010414071381092072, 0.00825421791523695, 0.051533833146095276, -0.010475978255271912, 0.022327659651637077, 0.0001460609637433663, -0.012092429213225842, 0.008866406045854092, -0.005041951313614845, 0.03362217918038368, 0.011961737647652626, -0.022300144657492638, -0.009464836679399014, 0.006493317894637585, -0.02293296903371811, -0.0010360763408243656, 0.004199333488941193, -0.037831831723451614, -0.01967255212366581, 0.008866406045854092, -0.003270733868703246, 0.024487512186169624, 0.04369232803583145, 0.0018073298269882798, -0.01676981896162033, 3.557481977622956e-05, -0.009629921056330204, 0.008605021983385086, 0.03202636539936066, 0.006207859609276056, 0.017443913966417313, -0.005918961949646473, 0.004127108957618475, 0.00836427416652441, 0.003796940203756094, 0.038106974214315414, -0.004367856774479151, 0.0018090493977069855, 0.030513092875480652, 0.012697738595306873, -0.00026718730805441737, 0.008233582600951195, 0.01309669204056263, -0.0323290191590786, -0.020841900259256363, 0.015504173003137112, 0.01645340770483017, 0.00991193950176239, 0.00184688123408705, -0.008446816354990005, 0.024418728426098824, 0.04669135808944702, -0.04644373431801796, -0.02041543275117874, 0.010111416690051556, 0.020841900259256363, 0.002216601511463523, 0.009162181988358498, 0.018035465851426125, -0.0020308815874159336, -0.0031383223831653595, -0.006775337271392345, -0.020979469642043114, -0.03210890665650368, 0.028256939724087715, -0.005705728195607662, -0.008632536046206951, -0.02648228220641613, -0.006008382886648178, 0.014926377683877945, 0.0007355712004937232, -0.020704329013824463, -0.024432484060525894, -0.009093396365642548, 0.009739977307617664, -0.00842618104070425, -0.00016841613978613168, 0.0057882703840732574, -0.012704617343842983, 0.008171675726771355, 0.022245116531848907, -0.004360978491604328, 0.017141258344054222, 0.02305678278207779, 0.03739160671830177, 0.01332368329167366, 0.027197647839784622, 0.0061425138264894485, -0.017608998343348503, -0.025010280311107635, -0.019191056489944458, 0.005702288821339607, 0.03243907541036606, 0.017842868342995644, 0.009533621370792389, 0.0036112202797085047, -0.017884138971567154, -0.00583298085257411, -0.0067787766456604, 0.011562783271074295, 0.014912620186805725, -0.0063247946090996265, 0.005922401323914528, 0.005791709758341312, 0.012484504841268063, -0.030898289754986763, -0.03750166296958923, -0.0003192060685250908, 0.022410200908780098, -0.00035531827597878873, -0.020759357139468193, -0.009217210114002228, -0.0009285995038226247, -0.004522623494267464, -0.003851968329399824, -0.008605021983385086, 0.014568694867193699, -0.004687707871198654, -0.014389852993190289, 0.03026546537876129, 0.005017876625061035, 0.012952243909239769, 0.0010455342708155513, 0.0077589647844433784, -0.003382509807124734, -0.0025966393295675516, 0.034172460436820984, 0.004969726782292128, 0.01704495958983898, 0.02297423966228962, 0.004601726308465004, -0.010654819197952747, 0.0585499182343483, 0.02355203591287136, 0.028201911598443985, -0.017333857715129852, 0.006765019614249468, -0.014568694867193699, 0.015421630814671516, -0.019837636500597, -0.024212371557950974, -0.008281731978058815, -0.014871349558234215, 0.006372943986207247, -0.015545443631708622, 0.015022676438093185, 0.03653867170214653, 0.023785904049873352, -0.020374160259962082, -0.02360706403851509, 0.018585747107863426, -0.027541574090719223, 0.02690874971449375, -0.0004150753957219422, 0.031283486634492874, -0.001436749822460115, 0.00846745166927576, 0.005207035690546036, 0.021364666521549225, 0.002754845190793276, -0.0009122630581259727, 0.013867085799574852, 0.006376383360475302, -0.009237845428287983, -0.018351877108216286, 0.01004263199865818, -0.016370864585042, 0.00572292460128665, 0.0042887539602816105, -0.009052125737071037, -0.0169211458414793, -0.01641213707625866, -0.0034753696527332067, -0.008494965732097626, -0.008955826051533222, -0.004422884900122881, 0.0057813916355371475, 0.01950746774673462, 0.01693490333855152, -0.007091748993843794, -0.018874645233154297, -0.03527302294969559, -0.00033360798261128366, -0.00761451618745923, 0.004931895062327385, -0.03596087545156479, 0.03296184167265892, -0.028477052226662636, 0.0013481889618560672, 0.012037401087582111, 0.041188545525074005, 0.01139082107692957, 0.034777771681547165, -0.010978110134601593, 0.04867237061262131, -0.03959273174405098, 0.006104682106524706, -0.01941116899251938, -0.012092429213225842, -0.03375975042581558, 0.01683860458433628, -0.0022062836214900017, 0.0015038152923807502, -0.01670103333890438, 0.023978503420948982, -0.02612460032105446, 0.05332224816083908, 0.001564002363011241, 0.002586321672424674, -0.005530326161533594, -0.006376383360475302, 0.00755260931327939, -0.005313652567565441, 0.027459030970931053, 0.0019156663911417127, 0.038437142968177795, 0.0005145989125594497, 0.03552065044641495, -0.004543259274214506, 0.027211405336856842, -0.00842618104070425, -0.00377974403090775, 0.020608030259609222, 0.0400879830121994, 2.6210904252366163e-05, 0.034667715430259705, -0.018118008971214294, -0.031366027891635895, 0.01149399857968092, -0.00819918978959322, -0.006820047739893198, -0.009960089810192585, 0.022148817777633667, -0.031173430383205414, 0.0029697988647967577, -0.03596087545156479, 0.002515816828235984, 0.03309941291809082, 0.018145522102713585, -0.006943860556930304, 0.03340206667780876, -0.013468132354319096, 0.017801595851778984, 0.010193958878517151, -0.00415462302044034, -0.027940526604652405, 0.0014255722053349018, -0.02280915528535843, -0.018035465851426125, 0.017705297097563744, 0.010909324511885643, 0.009148424491286278, -0.010118295438587666, -0.031063374131917953, -0.027610359713435173, -0.02025034837424755, -0.02337319403886795, -0.006568981800228357, 0.03590584918856621, 0.01953498274087906, 0.00672374852001667, -0.025409234687685966, -0.01176913920789957, -0.003972342237830162, -0.03703392297029495, -0.021006984636187553, -0.02040167525410652, 0.015738042071461678, -0.024198615923523903, 0.01672854833304882, -0.015627985820174217, -0.009588649496436119, 0.014142226427793503, 0.014692507684230804, 0.02252025716006756, 0.008178554475307465]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
" mechanism (which exists any-
way for subsequent token generation), our proposed KV-
Runahead uses other processes to populate KV-cache for the
last process with context-level load-balancing. Since KV-
cache assumes causal attention computation, KV-Runahead
reduces the computation and communication costs and of-
fers lower TTFT over the existing methods. Further, KV-
Runahead requires minimal engineering costs, as it simply
makes the KV-cache interface dual-purposed. In detail, our
contributions are the following:
1arXiv:2405.05329v2  [cs.DC]  13 May 2024
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
(a) LLM inference consists of two phases: the prompt phase for the
first token and the extension phase for the next tokens.
(b) Causal attention computation of one layer on one process:
the upper triangle of QKTwill be masked out with −∞.
Figure 1. LLM inference begins with the prompt phase to generate the KV-cache and the first token which drive the extension phase as in
(a). Inside each layer of the LLM as in (b), a causal attention map ( QKT) is built to compute the attention Afrom query, value, and key s
(Q, K, V ). Computing attention thus has O(C2)complexity where Cis the user context.
•We demonstrate that KV-cache scheme can be dual-
purposed to parallelize LLM inference for low
TTFT . Since the KV-cache is built on the causal de-
coder and gets populated in parallel, KV-Runahead
can offer considerable compute and communication
savings over tensor/sequential parallelization.
•We show that using KV-cache for parallelization
enables asynchronous communication . Thus, KV-
Runahead replaces global synchronization with point-
to-point asynchronous communication, and provides
robustness against network bandwidth fluctuation.
•We highlight that context-level partitioning can
load-balance parallel LLM inference. Asymmetric
computations and communication rise from KV-cache
and its dependency chain across parallel processes. Yet,
we can mitigate the negative effects on TTFT with the
proposed context-level load-balancing.
•We propose that hierarchical grid search for ef-
ficient context-partitioning . Such search results
contribute to a lookup table from which a TTFT-
minimizing partitioning can be interpolated for various
context lengths.
2. Related Works
LLM Inference: Generative LLM inference consists of two
steps as in Fig. 1 (Patel et al., 2023). Once the user context
is received, all the input tokens are consumed to generate the
first token, which is called the prompt phase. At the same
time, the computed key and value embeddings are saved as
KV-cache (Park et al., 2020; Liu et al., 2023a) and fed to
all subsequent token generations to expedite the extension
phase. Accordingly, KV-cache grows as more tokens are
generated, because the next token generation needs to attend
to all previous tokens, including the user context. While the
critical metric for the extension phase is time-per-output-
token or TPOT, the prompt phase needs to deliver the first
token fast which is measured as time-to-first-token or TTFT.
TTFT Optimization: Minimizing TTFT, especially forlong context requires two efforts: efficient KV-cache man-
agement and fast attention map computation. PagedAtten-
tion (Kwon et al., 2023) facilitates the exchange of data
including KV-cache between different memory subsystems
to handle long contexts. Infinite-LLM (Lin et al., 2024)
suggests distributed KV-cache management system at the
cloud scale to adaptively handle extremely long context
lengths. CacheGen (Liu et al., 2023a) proposes compress-
ing KV-cache for pre-computed contexts to lower TTFT.
SplitWise (Patel et al., 2023) proposes to use two different
platforms, one with high computing capacity for the prompt
phase and the other with low computing capacity for the
extension phase by transferring the LLM states, including
KV-cache from the first to the second platforms.
LLM Inference Parallelization: Since TTFT optimiza-
tion is compute-bound, one can employ parallel DNN in-
ference. Pipeline parallelism shards the layers of a model
across multiple processes, splitting the model into several
stages or layers (Huang et al., 2019; Narayanan et al., 2021a;
Agrawal et al., 2023). Tensor Parallelism is one of the popu-
lar parallel methods from (Hugging","[-0.017761947587132454, -0.0018975433195009828, 0.012107973918318748, -0.013452556915581226, 0.007946488447487354, 0.017103102058172226, 0.03259270265698433, 0.034555792808532715, -0.03278094530105591, 0.054643869400024414, 0.028800977393984795, 0.03799792751669884, -0.0066489651799201965, 0.013223977759480476, -0.029903534799814224, -0.03525497764348984, -0.005139670334756374, -0.01998051069676876, 0.007233859039843082, 0.017304789274930954, -0.04055263474583626, -0.04410233721137047, 0.033453237265348434, 0.050152961164712906, -0.001615180866792798, -0.04528557136654854, -0.009539819322526455, 0.013089519925415516, 0.006242228671908379, -0.0665837749838829, 0.04006858542561531, -0.02034354768693447, -0.08142797648906708, -0.03348012641072273, 0.0023967199958860874, 0.08314903825521469, 0.007301087956875563, 0.008114561438560486, -0.022602448239922523, 0.043860312551259995, 0.03205486759543419, -0.07475884258747101, -0.07438235729932785, 0.0022269662003964186, 0.01333154458552599, 0.015825746580958366, 0.010944909416139126, 0.00041997223161160946, -0.04722176864743233, 0.043860312551259995, 0.010561702772974968, -0.015395480208098888, -0.04875459522008896, -0.011281055398285389, -0.03979966789484024, 0.0011823930544778705, 0.028881652280688286, -0.0328885093331337, 0.023597439751029015, -0.004168208688497543, 0.036384426057338715, -0.05101349577307701, -0.0015756837092339993, -0.003462302265688777, -0.029069893062114716, 0.003183301305398345, 0.000894147960934788, 0.021338539198040962, -0.023220956325531006, 0.0392349436879158, -0.021755360066890717, 0.02289825677871704, 0.024350406602025032, 0.0005550608620978892, -0.0022773882374167442, 0.03506673499941826, 0.013849209062755108, 0.02428317628800869, 0.04160141199827194, 0.011751659214496613, 0.06346433609724045, -0.02117718942463398, 0.029500160366296768, 0.008181789889931679, 0.027510177344083786, -0.047329336404800415, -0.018326671794056892, 0.01064237765967846, -0.042139243334531784, -0.02565465122461319, 0.00306901172734797, 0.05300347879528999, -0.03643821179866791, 0.0356314592063427, 0.06798213720321655, 0.06152813881635666, 0.026703426614403725, -0.05286902189254761, 0.02289825677871704, 0.034475117921829224, 0.013445834629237652, 0.004218630492687225, 0.017963634803891182, -0.034744035452604294, 0.0584087036550045, -0.009230565279722214, -0.029338810592889786, 0.01971159316599369, -0.027348827570676804, -0.03603483736515045, -0.0776093527674675, -0.023987367749214172, -0.03334566950798035, 0.02464621514081955, 0.005351441912353039, -0.06878888607025146, -0.04353761300444603, 0.003227000357583165, -0.001272312132641673, -0.0038253399543464184, -0.013714751228690147, -0.004087533801794052, 0.030871635302901268, 0.0005239673773758113, -0.016578713431954384, -0.04864702746272087, 0.0205452349036932, -0.04299977794289589, 0.006262397393584251, 0.0010941547807306051, 0.008296079933643341, 0.012981953099370003, 0.031543929129838943, 0.000708847597707063, -0.03084474429488182, -0.009190227836370468, -0.03503984585404396, 0.011839057318866253, -0.02463276870548725, -0.004201823379844427, -0.03458268567919731, -0.02073347568511963, 0.01479041762650013, 0.01942923106253147, -0.03598105162382126, 0.05195470526814461, -0.026326943188905716, 0.030925419181585312, -0.01625601388514042, -0.004185015801340342, -0.02920435182750225, -0.03412552922964096, 0.011025584302842617, 0.0012017214903607965, -0.03479781746864319, -0.029876643791794777, -0.042677078396081924, 0.032001085579395294, 0.027241259813308716, -0.03369526192545891, -0.016363579779863358, -0.0028135408647358418, 0.0556657537817955, -0.007933042012155056, -0.01172476727515459, -0.009163335897028446, -0.07443613559007645, 0.0010496154427528381, -0.060291122645139694, -0.046038538217544556, -0.015839193016290665, -0.04256951063871384, -0.049695804715156555, 0.012780265882611275, 0.028532059863209724, -0.017385464161634445, -0.05036809667944908, -0.0034270070027559996, -0.0028118600603193045, -0.04235437884926796, -0.0493193194270134, 0.04498976096510887, 0.008141452446579933, 0.04585029557347298, -0.0419778935611248, -0.0018706517294049263, 0.010971800424158573, 0.03415241837501526, -0.0346633605659008, 0.03038758598268032, -0.01706276461482048, 0.024081489071249962, 0.058731403201818466, 0.03549700230360031, 0.011765104718506336, -0.0011790315620601177, 0.027053019031882286, 0.033641476184129715, 3.4166074328823015e-05, -0.027617743238806725, 0.022575555369257927, -0.024673106148838997, 0.00691115902736783, -0.0712091401219368, 0.05332617834210396, 0.005042187869548798, 0.005038826260715723, 0.005852299276739359, -0.025157155469059944, -0.04585029557347298, 0.023583993315696716, 0.023220956325531006, 0.051900919526815414, 0.043940987437963486, 0.010191942565143108, -0.021526779979467392, -0.0639483854174614, 0.007254027761518955, 0.010151605121791363, 0.03799792751669884, 0.02080070599913597, 0.008464152924716473, -0.019657809287309647, 0.0013336586998775601, -0.023758789524435997, 0.01433325931429863, -0.027698418125510216, -0.053164828568696976, 0.03385661169886589, 0.009607048705220222, 0.02947326935827732, -0.021109959110617638, -0.008027163334190845, -0.01936200074851513, -0.01473663467913866, -0.06061382219195366, -0.001431141048669815, -0.036841586232185364, 0.002026959555223584, -0.0757807195186615, -0.024135272949934006, -0.002916065277531743, -0.008591888472437859, 0.0009151570848189294, -0.015126563608646393, 0.033453237265348434, -0.0178022850304842, -0.02090827189385891, 0.06470135599374771, 0.020101523026823997, -0.016498038545250893, -0.020948609337210655, -0.06701403856277466, 0.004309389740228653, -0.04453260451555252, -0.03127501159906387, 0.016269460320472717, -0.004460655618458986, 0.004497631452977657, 0.014844201505184174, -0.01671317219734192, -0.00026744604110717773, -0.008296079933643341, 0.00259000388905406, -0.01569128781557083, -0.016000542789697647, -0.008934756740927696, 0.0065346756018698215, -0.038105495274066925, -0.05614980310201645, 0.047517579048871994, -0.016484592109918594, -0.01127433218061924, -0.025426072999835014, -0.012175203301012516, 0.0053480807691812515, 0.004043834749609232, -0.007522944360971451, 0.010326400399208069, 0.01190628670156002, -0.004043834749609232, 0.010823897086083889, 0.09272247552871704, -0.015072780661284924, -0.009781844913959503, 0.0006407780456356704, -0.001286598271690309, 0.003097584005445242, -0.006158192176371813, -0.03945007920265198, 0.027886660769581795, -0.020760368555784225, 0.011946624144911766, -0.004803524352610111, 0.028720302507281303, 0.04410233721137047, -0.02217218093574047, 0.005916167050600052, -0.02026287280023098, 0.012013852596282959, 0.03038758598268032, 0.019402338191866875, 0.004410233814269304, -0.0035967607982456684, -0.011765104718506336, 0.022978931665420532, 0.0021076344419270754, 0.007254027761518955, -0.028505168855190277, -0.000284043257124722, -0.022145289927721024, 0.013708028011023998, -0.014871092513203621, 0.037379421293735504, -0.030199343338608742, -0.03415241837501526, 0.03323810175061226, -0.061097871512174606, 0.05176646262407303, -0.023046160116791725, 0.012074359692633152, -0.08508524298667908, -0.014024005271494389, 0.014763525687158108, 0.039288729429244995, 0.0076708486303687096, -0.01696864329278469, -0.018864504992961884, 0.007408654782921076, -0.00803388562053442, 0.002606811234727502, 0.028908543288707733, 0.011079367250204086, -0.028182469308376312, -0.04964201897382736, -0.028908543288707733, -0.020061185583472252, 0.0014714784920215607, 0.03689536824822426, 0.012444119900465012, -0.08696765452623367, 0.0053985025733709335, -0.02292514778673649, 0.002479075687006116, -0.00518000777810812, 0.07325290888547897, 0.026878222823143005, -0.014024005271494389, 0.05534305423498154, 0.02656896784901619, -0.004353088792413473, -0.030333802103996277, 0.03598105162382126, -0.013526509515941143, 0.041843436658382416, 0.020504897460341454, 0.023866355419158936, -0.0510941706597805, -0.008154898881912231, -0.0018286334816366434, -0.017681272700428963, 0.0012849175836890936, 0.045957863330841064, 0.008074223063886166, -0.007731354795396328, -0.0018370371544733644, -0.03165149316191673, -0.015261022374033928, 0.02188981883227825, 0.020397331565618515, 0.029419485479593277, 0.022790689021348953, -0.0043631731532514095, -0.021298201754689217, -0.046226777136325836, 0.003953075502067804, -0.011166765354573727, 0.022938594222068787, 0.023140281438827515, 0.03431376814842224, 0.025345398113131523, 0.009943194687366486, 0.007381762843579054, -0.011395344510674477, 0.02721436880528927, 0.012679421342909336, -0.003455579513683915, -0.031812842935323715, -0.05192781239748001, 0.009996977634727955, -0.004927898291498423, 0.018030863255262375, 0.0008155739051289856, 0.029957318678498268, 0.008524659089744091, 0.013687859289348125, -0.004937982652336359, 0.00803388562053442, 0.046065427362918854, 0.04891594499349594, 0.01064237765967846, -0.007576727773994207, -0.03794414550065994, -0.002687486121430993, 0.015812302008271217, 0.01816532202064991, 0.03165149316191673, 0.0023916778154671192, 0.038293737918138504, 0.006817038170993328, 0.051255520433187485, -0.02201083116233349, 0.009486036375164986, -0.05332617834210396, 0.028424493968486786, 0.0007323778118006885, 0.00237318966537714, 0.025318505242466927, 0.020612463355064392, 0.0657770186662674, -0.019375447183847427, -0.013580292463302612, -0.048781488090753555, -0.0620659701526165, 0.005674141924828291, 0.007381762843579054, 0.03487849608063698, -0.051174845546483994, 0.02127131074666977, -0.0383206270635128, -0.03616929426789284, 0.021325092762708664, 0.037110503762960434, 0.017197221517562866, -0.028827868402004242, -0.00853138230741024, 0.0011798719642683864, 0.0365188866853714, -0.043591395020484924, -0.04501665383577347, 0.014682850800454617, -0.026326943188905716, -0.02456554025411606, 0.008289356715977192, -0.061474353075027466, 0.00853138230741024, -0.02363777719438076, -0.010393629781901836, 0.03915426880121231, -0.03460957854986191, 0.025614313781261444, 0.031006094068288803, 0.06900402158498764, 0.025883231312036514, 0.015906421467661858, -0.046334344893693924, 0.09320652484893799, -0.011126427911221981, 0.041762761771678925, 0.005082525312900543, 0.012444119900465012, 0.03622307628393173, -0.03140946850180626, -0.019483013078570366, 0.02436385117471218, 0.016659388318657875, 0.06034490466117859, 0.019550243392586708, 0.02245454303920269, 0.00046808310435153544, 0.01753336749970913, -0.021755360066890717, 0.012585300952196121, -0.026501739397644997, -0.06454000622034073, 0.008101115003228188, 0.009069215506315231, -0.029688403010368347, 0.021688131615519524, -0.01218864880502224, 0.03369526192545891, 0.015045888721942902, 0.04353761300444603, 0.01286766305565834, 0.02812868542969227, 0.03396417573094368, 0.01668628118932247, -0.0004920334904454648, 0.006272481754422188, 0.012128142639994621, -0.029231244698166847, -0.01843423955142498, 0.018689710646867752, -0.015072780661284924, -0.00239503919146955, 0.005428755655884743, -0.04251572862267494, 0.01227604690939188, 0.03065650165081024, -0.022225964814424515, 0.011173488572239876, 0.014709742739796638, 0.010279340669512749, 0.00019128799613099545, -0.006211975589394569, 0.04316112771630287, 0.07637234032154083, 0.02180914394557476, 0.020128414034843445, 0.028989218175411224, -0.011106259189546108, 0.03942318633198738, 0.008343140594661236, 0.030629610642790794, -0.0005466571892611682, 0.03872400149703026, -0.016108108684420586, 0.042757753282785416, 0.016269460320472717, -0.010212111286818981, -0.006101047154515982, -0.001445427187718451, -0.04224681109189987, -0.010433967225253582, 0.01945612207055092, -0.016403917223215103, -0.04872770234942436, -0.09600325673818588, -0.028263144195079803, -0.04006858542561531, 0.03140946850180626, 0.01805775612592697, -0.01163736917078495, -0.009694446809589863, -0.03111365996301174, 0.004695957526564598, 0.006521229632198811, -0.031140552833676338, -0.041036687791347504, -0.014669405296444893, 0.015220684930682182, 0.013062627986073494, 0.013553401455283165, 0.04068709537386894, -0.010749944485723972, -0.021768806502223015, 0.04781338572502136, -0.03401796147227287, -0.010595317929983139, 0.02400081418454647, 0.02344953455030918, -0.03460957854986191, 0.01004403829574585, -0.022508326917886734, -0.005112778395414352, -0.011852502822875977, 0.002534539671614766, 0.00875996146351099, -0.019577134400606155, -0.011913008987903595, 0.03888535127043724, 0.033533912152051926, 0.0076708486303687096, -0.023489871993660927, -0.012598746456205845, 0.00375474919565022, 0.01569128781557083, -0.013432388193905354, -0.011079367250204086, 0.013781980611383915, -0.028074901551008224, -0.024404188618063927, 0.008423815481364727, 0.00306901172734797, 0.03323810175061226, -0.012195372022688389, 0.006766616366803646, 0.021244417876005173, 0.0164173636585474, 0.012860940769314766, -0.04068709537386894, -0.004904367960989475, -0.03240446001291275, -0.02518404833972454, -0.015489601530134678, 0.00773807754740119, -0.016121555119752884, 0.00750949839130044, -0.022952038794755936, 0.015906421467661858, 0.0006479211151599884, -0.007825475186109543, 0.028316926211118698, -0.004964874126017094, -0.02073347568511963, 0.015274467878043652, 0.01854180544614792, -0.018783830106258392, -0.022414205595850945, -0.02035699412226677, 0.0004237538669258356, 0.021325092762708664, -0.01899896375834942, -0.016108108684420586, 0.0015698011266067624, 0.044882193207740784, -0.019119976088404655, 0.023301631212234497, 0.022252855822443962, -0.02143266052007675, 0.011079367250204086, -0.03668023645877838, -0.006363241001963615, -0.02400081418454647, -0.043940987437963486, -0.016578713431954384, -0.018730048090219498, -0.012444119900465012, 0.02381257340312004, -0.019281325861811638, 0.04587718844413757, -0.02034354768693447, -7.290163193829358e-05, -0.01606777124106884, 0.0009025516337715089, -0.006938050501048565, 3.53215764334891e-05, -0.029634619131684303, -0.03049515187740326, 0.02026287280023098, -0.023019269108772278, -0.004366534762084484, -0.004793439991772175, 0.024121826514601707, 0.011610478162765503, 0.01762748882174492, 0.028182469308376312, -0.006131300237029791, 0.024699997156858444, -0.011509634554386139, 0.015624059364199638, 0.025036143139004707, -0.006124577485024929, -0.019469568505883217, 0.02812868542969227, 0.0058422149159014225, 0.010097821243107319, 0.02182258851826191, 0.0021967131178826094, -0.03853576257824898, -0.020679693669080734, -0.045957863330841064, 0.0492924302816391, 0.019093085080385208, 0.03304985910654068, -0.020948609337210655, 0.008390200324356556, -0.019025854766368866, -0.003099264809861779, 0.0013487852411344647, -0.030253127217292786, -0.020155305042862892, -0.031705278903245926, -0.0011008776491507888, -0.0048707532696425915, 0.030468260869383812, 0.035389434546232224, 0.012027299031615257, -0.009049046784639359, -0.0005193453398533165, -0.008060777559876442, 0.018205659464001656, 0.019469568505883217, 0.003174897748976946, 0.006833845283836126, -0.009600325487554073, -0.00691115902736783, -0.023167172446846962, -0.01227604690939188, 0.0214595515280962, -0.04318802058696747, -0.0074355462566018105, -0.03904670476913452, -0.010918017476797104, 0.008625502698123455, 0.02554708532989025, 0.02499580569565296, -0.006225421093404293, 0.021136851981282234, -0.028532059863209724, 0.010111267678439617, -0.004682512022554874, 0.031006094068288803, -0.04243505373597145, -0.006870821584016085, 0.0246596597135067, -0.00898854061961174, 0.022763798013329506, -0.009223842062056065, -0.04216613620519638, -0.010225556790828705, 0.0091229984536767, -0.02901611104607582, 0.02392013929784298, -0.002682443941012025, -0.036734018474817276, -0.022037722170352936, 0.017869513481855392, 0.03694915398955345, -0.035362545400857925, -0.029285026714205742, -0.022857917472720146, 0.009768398478627205, -0.01690141297876835, -0.04781338572502136, -0.0005601030425168574, -0.01456183847039938, -0.01278698816895485, -0.015839193016290665, -0.02646140195429325, -0.04334937036037445, 0.01150291133671999, -0.0082086818292737, -0.0022706652525812387, -0.0007878418546169996, 6.654637400060892e-05, -0.021325092762708664, 0.044774629175662994, 0.04770582169294357, 0.015382034704089165, 0.019321663305163383, 0.012040744535624981, 0.020921718329191208, -0.028370710089802742, -0.020585572347044945, -0.00625567464157939, -0.05044877156615257, -0.019550243392586708, -0.024310069158673286, -0.0055262381210923195, -0.015086226165294647, -0.03662645444273949, 0.01805775612592697, 0.0538371205329895, 0.0042119077406823635, -0.0018084647599607706, 0.02264278568327427, -0.00627920450642705, -0.00352617003954947, -0.0029227882623672485, -0.008161621168255806, 0.01227604690939188, 0.015677843242883682, -0.003327843965962529, 0.036465100944042206, -0.017963634803891182, 0.023489871993660927, 0.0032454882748425007, -0.0065346756018698215, -0.02109651453793049, 0.003258934011682868, -0.011227271519601345, -0.01980571448802948, 0.013795426115393639, 0.01898551732301712, -0.0012134865391999483, -0.01273320522159338, -0.037379421293735504, 0.01934855617582798, 0.015126563608646393, -0.005465731490403414, -0.01770816370844841, -0.005660696420818567, 0.015852639451622963, 0.016498038545250893, -0.0365188866853714, 0.022521773353219032, -0.007375040091574192, 0.01706276461482048, 0.011583586223423481, 0.009943194687366486, -0.02820936031639576, -0.02966151013970375, -0.04703352972865105, -0.006655687931925058, -0.022387314587831497, -0.02627316117286682, -0.002954722149297595, -0.000991630251519382, -0.03313053399324417, -0.028343819081783295, -0.03149014338850975, 0.01442738063633442, 0.007193521596491337, -0.005761540029197931, 0.060183554887771606, -0.001021883450448513, -0.08809710294008255, -0.01465595979243517, 0.0214461050927639, 0.020867934450507164, 0.01680729351937771, -0.018313227221369743, 0.000540354463737458, -0.0012437396217137575, 0.03132879361510277, -0.023301631212234497, -0.018864504992961884, -0.013835763558745384, -0.01465595979243517, -0.024699997156858444, -0.022320084273815155, -0.033184319734573364, -0.04539313539862633, 0.005042187869548798, 0.027416056022047997, -0.02728159725666046, -0.025318505242466927, 9.039172437041998e-05, -0.002026959555223584, 0.01899896375834942, -0.007375040091574192, -0.04055263474583626, 0.0015723222168162465, -0.006259035784751177, -0.01496521383523941, 0.0093583008274436, -0.002458906965330243, -0.026084918528795242, -0.014077788218855858, 0.022414205595850945, -0.043134234845638275, 0.02508992701768875, -0.005415309686213732, 0.0030101861339062452, -0.0035160856787115335, -0.012544963508844376, -0.026152146980166435, -0.03794414550065994, 0.020935164764523506, -0.004037111531943083, 0.041574519127607346, -0.019738484174013138, 0.03348012641072273, 0.01805775612592697, 0.011563417501747608, -0.0019950256682932377, 0.011610478162765503, -0.016995534300804138, 0.018138431012630463, 0.011193657293915749, 0.01635013520717621, 0.029365701600909233, -0.02958083525300026, -0.0035833148285746574, 0.019214097410440445, 0.023032713681459427, 0.007744800765067339, 0.01899896375834942, 0.004766548052430153, -0.013035736046731472, -0.022441096603870392, -0.007610342465341091, 0.02336885966360569, 0.04006858542561531, 0.0114087900146842, -0.00989613402634859, -0.01163736917078495, 0.00023110027541406453, -0.004941344261169434, -0.0014185354812070727, 0.04246194660663605, 0.023436089977622032, -0.005580021068453789, 0.01953679695725441, -0.062281105667352676, 0.04152073711156845, 0.039745885878801346, -0.050421878695487976, 0.020881380885839462, 0.02463276870548725, 0.028989218175411224, 0.010064207017421722, 0.03931561857461929, -0.027994226664304733, -0.032996077090501785, 0.0005911965272389352, 0.03065650165081024, -0.04232748597860336, 0.019846051931381226, 0.005980034824460745, 0.02537228912115097, 0.030199343338608742, 0.003643820993602276, 0.021674685180187225, 0.014830755069851875, -0.018770385533571243, 0.029258135706186295, 0.019563689827919006, -0.011576863005757332, -0.0629802867770195, -0.005381694994866848, 0.01569128781557083, 0.01633668877184391, 0.008201958611607552, 0.0374063104391098, -0.020222535356879234, 0.015449264086782932, 0.0033379283268004656, -0.01860903389751911, 0.053998470306396484, -0.004981681704521179, 0.03520119562745094, 0.0069783879444003105, 0.01450805552303791, 0.009526373818516731, -0.010790281929075718, 0.020209088921546936, 0.04482841119170189, -0.037836577743291855, -0.01899896375834942, -0.02901611104607582, -0.018864504992961884, 0.01761404238641262, 0.01680729351937771, 0.0028303482104092836, -0.0068909903056919575, -0.02026287280023098, 0.027805985882878304, 0.025937015190720558, 0.013197086751461029, -0.024780672043561935, 0.005264044273644686, -0.014306367374956608, 0.01213486585766077, -0.01336515974253416, 0.056472502648830414, 0.006514506880193949, 0.006074155680835247, 0.050260528922080994, -0.00010719901183620095, 0.005993480794131756, 0.019227543845772743, 0.006198529619723558, -0.006195168010890484, -0.01144912838935852, 0.004403510596603155, 0.02855895273387432, -0.020209088921546936, 0.001172308693639934, 0.031086768954992294, -0.005633804481476545, 0.024605877697467804, 0.004615282639861107, -0.02483445592224598, 0.03237757086753845, 0.06513161957263947, -0.012605469673871994, 0.04437125474214554, -0.005253959912806749, 0.026851331815123558, 0.03813238441944122, -0.01991328038275242, -0.011778551153838634, -0.009687723591923714, -0.020491451025009155, -0.002428653882816434, -0.024861346930265427, -0.027227815240621567, 0.03616929426789284, 0.03549700230360031, 0.05004539713263512, 0.04784027859568596, -0.02116374298930168, -0.004998488817363977, 0.02188981883227825, 0.01690141297876835, -0.014803864061832428, 0.02647484838962555, -0.028693409636616707, -0.009338132105767727, 0.020693138241767883, 0.00013235742517281324, 0.003077415283769369, 0.0026555522345006466, -0.00041093831532634795, 0.009156613610684872, 0.03576591983437538, 0.009687723591923714, -0.029285026714205742, 0.02646140195429325, 0.011476019397377968, -0.016457701101899147, 0.011946624144911766, 0.03797103464603424, -0.042381271719932556, -0.007025448605418205, -0.04324180260300636, 0.0465225875377655, -0.0260311346501112, -0.016753509640693665, -0.026676535606384277, 0.04082155227661133, -0.01163736917078495, -0.013237424194812775, -0.018488021567463875, 0.011348283849656582, 0.002707654843106866, 0.005287574138492346, -0.04574272781610489, 0.04133249446749687, 0.009875965304672718, -0.010407076217234135, -0.014158463105559349, -0.028505168855190277, -0.002531178295612335, -0.019469568505883217, -0.04009547829627991, -0.005522876512259245, 0.0042488835752010345, 0.013660967350006104, -0.032619595527648926, 0.013129857368767262, 0.016672834753990173, -0.01232982985675335, 0.009640662930905819, 0.023153726011514664, -0.01578540913760662, 0.011341561563313007, 0.005643888842314482, 0.02675721049308777, -0.0319204106926918, -0.004453932400792837, -0.021150296553969383, -0.0428653210401535, -0.010427244938910007, -0.004292582627385855, 0.020504897460341454, -0.003136240877211094, -0.008322971872985363, 0.0051195016130805016, -0.027523623779416084, -0.018877951428294182, 0.013029013760387897, 0.06088273972272873, -0.005274128634482622, 0.002924469066783786, 0.006897713057696819, 0.000442872173152864, 0.03998791053891182, -0.016390472650527954, 0.012383613735437393, -0.001431141048669815, 0.028263144195079803, 0.056741420179605484, 0.02253521792590618, 0.011852502822875977, -0.020289763808250427, 0.01852835901081562, 0.005311104469001293, -0.006971665192395449, -0.018582142889499664, -0.02392013929784298, -0.0319204106926918, -0.005166561808437109, 0.014924876391887665, 0.003300952259451151, -0.02931191958487034, 0.02392013929784298, -0.0014807224506512284, 0.018824167549610138, -0.017291342839598656, 0.003590037813410163, -0.013539955019950867, -0.010534810833632946, 0.014239138923585415, -0.016928305849432945, -0.004806885961443186, -0.02354365587234497, -0.031194334849715233, -0.0005651452229358256, -0.014857647009193897, -0.017681272700428963, -0.015261022374033928, -0.00663888081908226, 0.031248118728399277, 0.00040400531725026667, -0.011032307520508766, 0.033076751977205276, 0.013304652646183968, 0.01104575302451849, 0.004215268883854151, 0.0012244113022461534, -0.005459008738398552, 0.007933042012155056, 0.005190092138946056, -0.052895911037921906, 0.006692664232105017, 0.015395480208098888, 0.023126835003495216, -0.0029564027208834887, 0.020101523026823997, 0.01897207275032997, -0.02702612616121769, -0.01350634079426527, 0.0016656027873978019, 0.003415241837501526, 0.005240513943135738, 0.04235437884926796, 0.0038051712326705456, 0.018595589324831963, 0.012934892438352108, 0.01625601388514042, 0.00875996146351099, -0.028962327167391777, 0.01501899678260088, -0.04047195985913277, -0.002924469066783786, 0.016121555119752884, 0.006141385063529015, 0.00713973818346858, 0.010924740694463253, -0.0364919938147068, 0.007791860960423946, 0.0205317884683609, 0.00048110875650309026, 0.011381899006664753, 0.024336960166692734, 0.004830415826290846, 0.010252448730170727, 0.010803728364408016, -0.056902769953012466, 0.01671317219734192, -0.00789270456880331, 0.012988676317036152, -0.013156749308109283, 0.0019345193868502975, 0.04784027859568596, 0.008645671419799328, -0.0026740403845906258, -0.0017731693806126714, 0.008430537767708302, 0.0056136357598006725, -0.00857844203710556, 0.008605333976447582, 0.0008361628279089928, -0.001515177427791059, 0.06739052385091782, -0.012255878187716007, -0.018783830106258392, 0.0027950527146458626, -0.03915426880121231, 0.028316926211118698, -0.0107297757640481, -0.018689710646867752, -0.028424493968486786, 0.003801809623837471, -0.01587953045964241, -0.005996841937303543, -0.01232982985675335, 0.014010559767484665, -0.0005735488957725465, -0.01698208786547184, 0.0025580700021237135, 0.029634619131684303, -0.004581667948514223, 9.842770668910816e-05, 0.057924654334783554, -0.005536322481930256, -0.01579885557293892, -0.02738916501402855, -0.015946758911013603, -0.009627217426896095, -0.013795426115393639, 0.03369526192545891, -0.0013269358314573765, 0.005610274150967598, 0.00812128372490406, -0.02253521792590618, -0.03294229507446289, -0.008914588019251823, 0.008854081854224205, 0.03216243535280228, -0.006057348567992449, 0.034636467695236206, 0.0016244248254224658, 0.014292921870946884, 0.0228175800293684, -0.0013630714965984225, -0.02829003520309925, -0.024054598063230515, -0.03694915398955345, -0.014158463105559349, 0.0027110164519399405, -0.0191737599670887, 0.021123405545949936, 0.010232280008494854, 0.002026959555223584, 0.000568086514249444, 0.026058027520775795, 0.013439111411571503, 0.011852502822875977, -0.039288729429244995, 0.01635013520717621, 0.049157969653606415, 0.0014756802702322602, 0.024498309940099716, -0.04082155227661133, -0.018851060420274734, -0.023113388568162918, -0.001317691756412387, -0.035470109432935715, -0.028343819081783295, -0.03977277874946594, 0.034744035452604294, -0.020316654816269875, 0.0005542204598896205, -0.021230973303318024, -0.016498038545250893, 0.014118125662207603, 0.015005551278591156, -0.005445562768727541, 0.02318061888217926, -0.027348827570676804, 0.022494880482554436, 0.02847827784717083, 0.03770212084054947, 0.0003248009306844324, 0.026515185832977295, -0.01879727654159069, 0.015408925712108612, 0.006060709711164236, 0.010756667703390121, 0.03342634439468384, -0.020652800798416138, -0.007375040091574192, 0.050529446452856064, -0.030199343338608742, 0.02080070599913597, 0.02291170135140419, 0.004020304419100285, -0.011025584302842617, -0.03603483736515045, -0.03670712932944298, -0.03732563555240631, 0.005882552359253168, -0.003364820033311844, -0.02482100948691368, -0.0034656638745218515, 0.004242160823196173, 0.0022017552983015776, -0.009365024045109749, 0.0015219004126265645, -0.05303037166595459, 0.010030592791736126, 0.033641476184129715, 0.006148107815533876, 0.008833913132548332, -0.019644364714622498, 0.010534810833632946, -0.00131180917378515, -0.0032875065226107836, 0.048862162977457047, -0.008961648680269718, 0.021244417876005173, -0.0022841112222522497, -0.0058422149159014225, 0.008235573768615723, -0.015341697260737419, 0.02976907789707184, 0.014763525687158108, -0.012538240291178226, -0.0014059300301596522, 0.0036135679110884666, -0.019644364714622498, -0.01606777124106884, -0.00744226947426796, -0.051067277789115906, -0.015906421467661858, 0.016538375988602638, -0.007388486061245203, 0.026905113831162453, 0.04273086041212082, -0.0066624111495912075, -0.020128414034843445, -0.0011630646185949445, -0.014629067853093147, -0.0011933178175240755, 0.027254706248641014, -0.010702883824706078, 0.013203809037804604, 0.006151469424366951, -0.0028555591125041246, 0.014844201505184174, 0.006675856653600931, 0.05063701048493385, -0.0007962455274537206, 0.0032690183725208044, 0.02728159725666046, 0.004625367000699043, 0.01286766305565834, 0.007623787969350815, 0.0045413305051624775, -0.021472997963428497, -0.01465595979243517, 0.032646484673023224, 0.02336885966360569, 0.014467718079686165, -0.0010143201798200607, -0.013371882028877735, 0.01578540913760662, 0.056902769953012466, -0.04055263474583626, -0.02090827189385891, 0.015731625258922577, 0.018407346680760384, -0.011072644963860512, 0.009069215506315231, 0.005761540029197931, 0.006346433889120817, -0.015045888721942902, -0.004860668908804655, -0.0069918339140713215, -0.029338810592889786, 0.0173316802829504, -0.0025244553107768297, -0.01213486585766077, -0.020114967599511147, -0.011321392841637135, 0.019214097410440445, 0.00789270456880331, -0.016538375988602638, -0.022427652031183243, -0.016766956076025963, 0.02336885966360569, -0.0044774627313017845, -0.009647386148571968, -0.0008012877078726888, -0.018662817776203156, 0.020666247233748436, 0.007307811174541712, -0.005798515863716602, 0.026421064510941505, 0.005146393086761236, 0.03751387819647789, 0.00972806103527546, 0.02180914394557476, 0.013378605246543884, -0.000988268875516951, -0.02035699412226677, -0.022562110796570778, 0.0030757347121834755, 0.03342634439468384, 0.014212246984243393, 0.0010840704198926687, -0.0018925011390820146, -0.0003401376015972346, -0.005536322481930256, -0.004215268883854151, 0.013223977759480476, 0.007422100752592087, -0.0016076175961643457, 0.008464152924716473, 0.008679285645484924, 0.014145017601549625, -0.0178022850304842, -0.04216613620519638, -0.016659388318657875, 0.024874793365597725, -0.016269460320472717, -0.03003799356520176, 0.01889139786362648, -0.023799126967787743, -0.006245590280741453, -0.006860736757516861, -0.005075802560895681, 0.008363309316337109, -0.017909850925207138, -0.01851491443812847, 0.03821306303143501, 0.009176782332360744, 0.02463276870548725, -0.01427947636693716, 0.015072780661284924, -0.005815323442220688, -0.011193657293915749, 0.03587348759174347, 0.006971665192395449, 0.01488453894853592, 0.0209889467805624, 0.004601836670190096, -0.011778551153838634, 0.03404485434293747, 0.027590852230787277, 0.028720302507281303, -0.011570140719413757, 0.008712900802493095, -0.031248118728399277, 0.015234130434691906, -0.017506476491689682, -0.029795968905091286, -0.00976167619228363, -0.010427244938910007, 0.012813880108296871, -0.023530209437012672, 0.023328522220253944, 0.03512052074074745, 0.0012555047869682312, -0.017573704943060875, -0.026152146980166435, 0.019294772297143936, -0.019751930609345436, 0.02246798947453499, -0.009378469549119473, 0.04205856844782829, -0.004894283600151539, -0.0006899393629282713, 0.0067767007276415825, 0.025721881538629532, 0.008322971872985363, 0.002127803396433592, 0.031248118728399277, 0.019119976088404655, -0.0002313103759661317, -0.012652530334889889, 0.008961648680269718, -0.017506476491689682, 0.0013773576356470585, 0.006242228671908379, 0.002620256971567869, -0.02180914394557476, -0.009075937792658806, 0.004020304419100285, -0.0041345939971506596, -0.013297930359840393, -0.003361458657309413, -0.013008845038712025, 0.020746922120451927, 0.015045888721942902, 0.0001991664175875485, -0.02417561039328575, -0.0510941706597805, -0.02675721049308777, -0.012847494333982468, -0.01524757593870163, -0.02154022641479969, 0.02463276870548725, -0.03971899300813675, 0.007838921621441841, 0.024794118478894234, 0.0410904698073864, 0.00889441929757595, 0.026125255972146988, -0.032807834446430206, 0.046334344893693924, -0.02299237623810768, 0.009156613610684872, -0.021056177094578743, -0.00698511116206646, -0.022696567699313164, 0.00663888081908226, -0.008692732080817223, 0.0017580428393557668, 0.0015227406984195113, 0.02217218093574047, -0.028505168855190277, 0.05130930244922638, 0.005227067973464727, 0.013163471594452858, -0.008410369046032429, -0.0022824304178357124, 0.030979203060269356, -0.01942923106253147, 0.024699997156858444, -0.009943194687366486, 0.0260311346501112, 0.011012137867510319, 0.03458268567919731, 0.008511213585734367, 0.011173488572239876, -0.012968507595360279, 0.004924536682665348, 0.018595589324831963, 0.05085214599967003, 0.0003823659208137542, 0.030064886435866356, -0.015207238495349884, -0.033560801297426224, 0.002885812195017934, -0.0052976589649915695, -0.01496521383523941, -0.008430537767708302, 0.019590580835938454, -0.04246194660663605, 0.011005415581166744, -0.02564120665192604, 0.007570004556328058, 0.02128475531935692, 0.029688403010368347, -0.011630646884441376, 0.04251572862267494, -0.01805775612592697, 0.006679218262434006, 0.023852910846471786, -0.0028135408647358418, -0.023570546880364418, -0.0011487784795463085, -0.01433325931429863, -0.008457429707050323, 0.01050119660794735, 0.008840636350214481, 0.0060842400416731834, 0.0045547764748334885, -0.03686847910284996, -0.04590407758951187, -0.03057582676410675, -0.015005551278591156, -0.008598610758781433, 0.030629610642790794, 0.0237453430891037, 0.014669405296444893, -0.0237453430891037, -0.020585572347044945, -0.020397331565618515, -0.036572668701410294, -0.011092813685536385, -0.006733001675456762, 0.0068002305924892426, -0.02300582267343998, 0.007691017352044582, -0.015099671669304371, -0.013459280133247375, 0.015005551278591156, 0.0196174718439579, 0.02426973171532154, 0.017909850925207138]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
"Face-TensorParallelism;
Shoeybi et al., 2020; Narayanan et al., 2021b) where a large
matrix multiplication is scattered and then the partial out-
put matrices are gathered, and is known to be superior to
pipeline parallelism (Patel et al., 2023). Sequence paral-
lelization (NVidia-LLM, 2023; Li et al., 2023) is a novel
(a) 1 process
 (b) 2 processes
 (c) 4 processes
 (d)pprocesses
Figure 2. QKTcomputation coverage using BLAS matrix-matrix
multiplication: by linking each context partition to KV-cache, we
can closely approximate the lower triangular part and minimize
unnecessary dot products. Note the upper triangular part of the
attention will be masked out to enforce causality.
2
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
(a) Tensor+Sequence Parallel Inference: With even context par-
titioning, each process will perform all-gather overK, V . All
computations in the layers are symmetric and globally synchro-
nized, and the user context can be evenly partitioned. (See Fig. 4).
(b) KV-Runahead Inference: Since the later processes wait for
the KV-cache to be ready, the layers will asynchronously com-
municate, and the user context is unevenly partitioned (for load-
balancing) to minimize TTFT. (See Fig. 5).
Figure 3. Comparing the existing tensor+sequence parallel scheme with the proposed KV-Runahead for parallel LLM inference.
data parallel algorithm (by evenly partitioning the input se-
quences over multiple processes) coupled with a distributed
ring attention algorithm. By deploying the ring topology
over all the devices, each process exchanges the key and
value embedding with neighbors and builds a full attention
map locally.
Both tensor and sequence parallelizations in LLM are math-
ematically similar in a sense that a)one of two matrices
(i.e., either activations or parameters) in multiplication will
be sharded over multiple devices, b)both require collec-
tive communication to merge the partial outcomes. Hence,
both are popular for parallel LLM inference (Korthikanti
et al., 2022), yet not specialized enough for causal atten-
tion, leading to excessive computation and communication
overheads.
3. Causal LLM Scalability and Motivation
In this section, we will discuss the lower bound of the scala-
bility of a causal attention-based LLM for a sufficiently long
user context Cover parallel pprocesses. Assume that the
user context Cis partitioned into C={c0, c1, c2, ..., c p−1}
forpprocesses, and each process is exclusively mapped to
one compute fabric (e.g., GPU). The minimum compute
overpto generate the first token, TTFT (p)with perfect
load-balancing is as follows:
TTFT (p)≥α""
1
2C2+1
2(Pp−1
0c2
i)
p#
(1)
≥α""1
2C2+1
2p(C
p)2
p#
=αC2
2(1
p+1
p2)
=TTFT (1)
2(1
p+1
p2) (2)
=TTFT∗(p) (3)
where αis a fitting coefficient such that TTFT (1) =
αC2(single process performance) (Dao et al., 2022), and
TTFT∗(p) is the lower bound of TTFT over p. The signifi-cance of TTFT∗(p)is that for a very long user context, there
exists super-linear scalability (i.e., more than 2 ×speedup
with 2 processes) with causal LLM in the ideal setup, such
as perfect load-balancing, zero communication costs, and so
on. Please see the super-linear scalability of KV-Runahead
reported in Fig. 8 (d).
Fig. 2 visualizes the concepts behind Eq. (1) which essen-
tially divides an attention map, QKT(C, C)in the shaded
regions over pprocesses. We need to practically compute
multiple rectangle regions using matrix-matrix multiplica-
tion and mask out the upper triangle part (which is how most
LLMs are implemented). Therefore, with more partitions,
we can eliminate the wasted computation. Other equally
good partitioning setups (i.e., using vertical rectangles to
","[-0.010887688025832176, 0.005671220365911722, 0.009694787673652172, 0.018915051594376564, 0.03329576179385185, 0.0009515193523839116, 0.04062452167272568, 0.030554069206118584, -0.03479842096567154, 0.03561565652489662, 0.029315033927559853, 0.015263853594660759, 0.016463344916701317, 0.026573341339826584, -0.025874735787510872, -0.033216677606105804, 0.01638425700366497, -0.019969549030065536, 0.0077505577355623245, 0.007612154819071293, -0.05525567755103111, -0.02607245370745659, 0.014262081123888493, 0.060053642839193344, 0.0066202678717672825, -0.04109904542565346, 0.01739921048283577, 0.01291759591549635, 0.009997955523431301, -0.016871962696313858, 0.05594110116362572, -0.017939642071723938, -0.08035272359848022, -0.06442980468273163, -0.008699605241417885, 0.07181128859519958, -0.015553840436041355, 0.04088814556598663, -0.017596930265426636, 0.0737093836069107, 0.027812374755740166, -0.06015909090638161, -0.06870052218437195, 0.004613427445292473, 0.01828235387802124, 0.010762467049062252, -0.0003985259681940079, -0.0016501240897923708, -0.03841007873415947, 0.06021181493997574, -0.005605313926935196, 0.00035445127286948264, -0.035114772617816925, 0.029288671910762787, -0.007368302438408136, -0.007823054678738117, 0.018967775627970695, -0.003188207745552063, 0.0540430061519146, -0.014921141788363457, 0.0689641460776329, -0.0325312539935112, 0.01971910521388054, -0.01422253716737032, -0.046687882393598557, 0.005068179219961166, -0.02624380961060524, -0.00012913477257825434, -0.004966024775058031, 0.03350666165351868, -0.024596158415079117, 0.016661062836647034, 0.026744697242975235, 0.04233808070421219, 0.026375623419880867, 0.03556293249130249, -0.005447139497846365, 0.040044549852609634, 0.041520845144987106, 0.03532567247748375, 0.05899914354085922, 0.003871983615681529, 0.059051867574453354, 0.04036089777946472, 0.02505750022828579, -0.03593200817704201, -0.035879284143447876, -0.013827100396156311, -0.04713604599237442, -0.01496068574488163, 0.002710388507694006, 0.05006227642297745, -0.03189855441451073, 0.03564202040433884, 0.0784546285867691, 0.03432389721274376, 0.019086407497525215, -0.039280038326978683, 0.023726196959614754, 0.058577343821525574, 0.005134085658937693, 0.014670698903501034, 0.01633153297007084, -0.03261033818125725, 0.05069497600197792, -0.018190084025263786, -0.011210627853870392, 0.01792646013200283, -0.002194673288613558, -0.024543432518839836, -0.031845830380916595, 0.009727740660309792, -0.0061325631104409695, 0.03139766678214073, 0.024306170642375946, -0.05430663004517555, -0.027917824685573578, 0.010222036391496658, 0.006814691238105297, 0.00030275617609731853, -0.03590564429759979, -0.00759897381067276, 0.04207445681095123, 0.012957139872014523, -0.010683379136025906, -0.05198673531413078, 0.02060224860906601, -0.06938594579696655, 0.027680562809109688, -0.009806828573346138, 0.01193559542298317, 0.03627471998333931, 0.01768919825553894, -0.015250672586262226, -0.02607245370745659, 0.01645016297698021, -0.015514296479523182, 0.022948505356907845, -0.013734832406044006, -0.023884372785687447, -0.03593200817704201, 0.005242830608040094, 0.015619746409356594, 0.008976411074399948, -0.024121634662151337, 0.062478985637426376, -0.03171401843428612, 0.032979413866996765, -0.01675333082675934, -0.008693015202879906, -0.04109904542565346, -0.03195127844810486, -0.014182993210852146, 0.004765011370182037, -0.028128724545240402, -0.04294441640377045, -0.0633753091096878, 0.03640653192996979, 0.018137359991669655, -0.015685653313994408, 0.012700106017291546, -0.031002230942249298, 0.06453525274991989, 0.001990364398807287, -0.025004776194691658, 0.009009364061057568, -0.05064224824309349, 0.0034732515923678875, -0.06843689829111099, -0.05206582322716713, 0.017175130546092987, -0.03432389721274376, -0.06943867355585098, -0.02178855799138546, 0.045738834887742996, -0.009734331630170345, -0.02095814049243927, -0.008673243224620819, -0.018862327560782433, -0.02725876495242119, -0.037909191101789474, 0.05551930144429207, 0.009259807877242565, 0.03158220648765564, -0.044315263628959656, 0.028418712317943573, 0.025268400087952614, 0.02416117675602436, -0.00553611246868968, -0.01318122074007988, -0.01519794762134552, 0.023554841056466103, 0.05462297797203064, 0.04328712821006775, -0.002240807516500354, -0.023660290986299515, 0.0389636866748333, 0.03593200817704201, -0.023119861260056496, -0.004689219407737255, 0.014828872866928577, -0.009740921668708324, 0.02636244148015976, -0.038620974868535995, 0.05296214297413826, 0.012311260215938091, -0.0039247083477675915, -0.0021880825515836477, -0.01763647235929966, -0.044789787381887436, 0.024319352582097054, 0.015804283320903778, 0.045686110854148865, 0.04631881043314934, 0.012726468965411186, -0.02949957177042961, -0.08789237588644028, 0.009754103608429432, 0.009839781560003757, 0.04703059419989586, 0.0069399126805365086, 0.060053642839193344, -0.007704423274844885, 0.007809873204678297, -0.03329576179385185, 0.03690741956233978, -0.009503659792244434, -0.04695150628685951, 0.024147996678948402, -0.008706196211278439, 0.02273760549724102, 0.0061951735988259315, -0.000765746517572552, -0.020641790702939034, 0.014024819247424603, -0.07798010110855103, -0.018809601664543152, -0.047821469604969025, -0.0031569022685289383, -0.06326986104249954, -0.021353578194975853, 0.006359938997775316, 0.026046091690659523, 0.0011269943788647652, 0.0021188813261687756, 0.03638016805052757, 0.0018371326150372624, 0.004389346577227116, 0.01775510422885418, 0.025004776194691658, -0.012621019035577774, -0.020760422572493553, -0.0731821358203888, 0.015461571514606476, -0.0633753091096878, 0.022948505356907845, 0.01662151888012886, -0.011658789590001106, 0.011981729418039322, -0.005134085658937693, -0.019745469093322754, 0.024437982589006424, -0.021590840071439743, -0.018005548045039177, 0.0051209041848778725, -0.019640019163489342, 0.008323940448462963, -0.01268033403903246, -0.027337851002812386, -0.03848916292190552, 0.04228535667061806, 0.016661062836647034, -0.018506433814764023, 0.009299350902438164, -0.033401213586330414, -0.011342440731823444, 0.033743925392627716, -0.007546248845756054, -0.01667424477636814, -0.00684105372056365, -0.019916824996471405, 0.028814148157835007, 0.075554758310318, -0.03237307816743851, 0.012607838027179241, -0.023001229390501976, -0.008884143084287643, 0.00958274770528078, -0.01261442806571722, -0.035299308598041534, 0.03651197999715805, -0.02594064176082611, 0.020351804792881012, 0.0036413122434169054, 0.03152947872877121, 0.05799737200140953, -0.006712536793202162, -0.012957139872014523, -0.04373529180884361, 0.00507806520909071, 0.008752330206334591, 0.01971910521388054, -0.014749785885214806, -0.02019363082945347, -0.004023567773401737, 0.05367393046617508, -0.023172585293650627, 0.01365574449300766, -0.027917824685573578, 0.027153315022587776, -0.02315940521657467, 0.023713016882538795, -0.012153085321187973, 0.03139766678214073, -0.012225582264363766, -0.02897232212126255, 0.03334848955273628, -0.05409573018550873, 0.01768919825553894, -0.029341397807002068, 0.002431935165077448, -0.08272533863782883, -0.016634700819849968, 0.017596930265426636, 0.040466345846652985, 0.013616200536489487, -0.04819054156541824, -0.01970592513680458, 0.007987819612026215, -0.007084906101226807, 0.0053219180554151535, 0.01415663119405508, -0.015461571514606476, -0.02368665300309658, -0.03564202040433884, -0.044130727648735046, -0.025571567937731743, 0.003460070351138711, 0.018677789717912674, 0.0032508184667676687, -0.10075724869966507, 0.010986546985805035, -0.03189855441451073, -0.005578951444476843, -0.019218219444155693, 0.047874193638563156, 0.02926230989396572, -0.017649654299020767, 0.06949139386415482, 0.012957139872014523, -0.02797055058181286, -0.02511022612452507, 0.04017636179924011, -0.016951050609350204, 0.026863327249884605, 0.021406302228569984, 0.02043089270591736, -0.05238217115402222, -0.008258034475147724, -0.0007793396944180131, -0.019270945340394974, 0.012390347197651863, 0.03986001014709473, 0.027917824685573578, 0.00053425133228302, 0.03258397802710533, -0.03993909806013107, -8.045178390148067e-08, 0.014710241928696632, 0.035299308598041534, 0.032083090394735336, 0.032557614147663116, 0.0006005693576298654, -0.00985296256840229, -0.04500068724155426, -0.020272716879844666, -0.020879054442048073, 0.02807600051164627, 0.019073225557804108, 0.01596245914697647, -0.008033953607082367, 0.03632744401693344, 0.007500114385038614, 0.0037138089537620544, -0.004119131248444319, 0.03044861927628517, -0.0011830145958811045, -0.026968777179718018, -0.05762829631567001, -0.022302625700831413, 0.017069680616259575, 0.007711014244705439, -0.0013617848744615912, 0.0428653284907341, 0.019495025277137756, -0.012508978135883808, 0.016595156863331795, 0.022052181884646416, 0.044789787381887436, 0.027153315022587776, 0.015830645337700844, -0.031239492818713188, 0.0005626733764074743, -0.013378938660025597, 0.021894007921218872, 0.009002774022519588, -0.003868688363581896, 0.03551020845770836, 0.03419208526611328, 0.024596158415079117, 0.05921004340052605, -0.02470160834491253, 0.0022490457631647587, -0.019640019163489342, 0.047399669885635376, -0.01994318701326847, -0.02018044888973236, 0.03282123804092407, 0.009813418611884117, 0.026283353567123413, -0.024200720712542534, -0.004507977515459061, -0.03403391316533089, -0.04141539707779884, -0.019864099100232124, 0.013102133758366108, 0.037197403609752655, -0.059051867574453354, 0.009180719964206219, -0.023053955286741257, -0.014789329841732979, 0.040756333619356155, 0.04623972252011299, 0.01585700921714306, -0.004277306143194437, -0.002015079138800502, 0.01697741262614727, 0.021221764385700226, -0.05515022575855255, -0.03403391316533089, 0.028339624404907227, -0.011362211778759956, -0.011856508441269398, -0.020813146606087685, -0.020140904933214188, 0.00017887327703647316, -0.03021135739982128, -0.004639789462089539, 0.010307714343070984, -0.009483887813985348, 0.004461843054741621, 0.02468842640519142, 0.0730239599943161, 0.040756333619356155, -0.017069680616259575, -0.045738834887742996, 0.07080952078104019, -0.020641790702939034, 0.008290987461805344, -0.020101360976696014, 0.020391348749399185, 0.007025590632110834, -0.03922731429338455, -0.025083862245082855, 0.014262081123888493, 0.026401985436677933, 0.059157319366931915, -0.009497069753706455, 0.019389575347304344, 0.01422253716737032, 0.015567021444439888, -0.03342757746577263, 0.057311948388814926, -0.019429119303822517, -0.030026821419596672, 0.0046430849470198154, 0.015039772726595402, -0.025611111894249916, 0.008244853466749191, -0.007249671500176191, 0.03313758969306946, 0.006597200874239206, 0.017122406512498856, 0.016344713047146797, 0.04323440417647362, 0.045686110854148865, 0.03015863336622715, -0.0009177424944937229, 0.010604292154312134, 0.019864099100232124, -0.026744697242975235, -0.018242809921503067, 0.03197764232754707, -0.014209356158971786, -0.01579110324382782, -0.022632155567407608, -0.0571010485291481, 0.004732058383524418, -0.008758921176195145, -0.014921141788363457, 0.031265854835510254, -0.0017102634301409125, 0.015922915190458298, -0.02646789140999317, 0.020852690562605858, 0.031793102622032166, 0.05409573018550873, 0.009233444929122925, -0.006313804537057877, 0.03899005055427551, -0.0007974638720043004, 0.01619972102344036, 0.019692743197083473, 0.026401985436677933, -0.011540158651769161, 0.042891692370176315, -0.0015858656261116266, 0.017069680616259575, 0.025400212034583092, -0.0027466367464512587, -0.006834462750703096, 0.0002179020520998165, -0.04315531626343727, -0.01089427899569273, 0.012548522092401981, -0.043656203895807266, -0.04629244655370712, -0.10418436676263809, -0.005793146323412657, -0.04652971029281616, 0.03395482525229454, 0.02802327461540699, -0.014907960779964924, -0.008739149197936058, -0.021683108061552048, 0.014169812202453613, 0.010248399339616299, -0.03614290803670883, -0.0472678579390049, 0.002690616762265563, -0.03195127844810486, -0.014011637307703495, 0.026757877320051193, 0.027337851002812386, -0.00985955260694027, -0.03471933677792549, 0.04850689321756363, -0.011296305805444717, 0.005486682988703251, 0.028761424124240875, 0.0035226813051849604, -0.02101086638867855, 0.016845600679516792, -0.0021238240879029036, -0.04254898056387901, -0.011645608581602573, 0.003153607016429305, -0.0034501845948398113, -0.034877508878707886, -0.018915051594376564, 0.02214444987475872, 0.022289443761110306, 0.0035523390397429466, -0.02559792995452881, -0.01365574449300766, 0.04149448126554489, 0.023950278759002686, -0.03590564429759979, 0.010492251254618168, 0.015830645337700844, -0.03044861927628517, -0.004254239145666361, 0.00404993025586009, -0.02553202398121357, 0.03848916292190552, -0.017306942492723465, 0.01936321333050728, 0.02451707050204277, -0.02231580577790737, 0.008488706313073635, -0.04837508127093315, -0.006531294900923967, -0.04768965765833855, -0.03424481302499771, -0.02148539014160633, 0.014736604876816273, -0.036960143595933914, -0.009253216907382011, -0.031555842608213425, 0.024714788421988487, 0.04623972252011299, -0.016951050609350204, 0.027285126969218254, -0.002333075972273946, -0.007974638603627682, -0.013734832406044006, 0.016357894986867905, -0.01958729326725006, -0.025426574051380157, -0.03332212567329407, 0.015817465260624886, 0.01234421320259571, 0.00036330739385448396, -0.03664379194378853, -0.019284125417470932, 0.021775376051664352, -0.013734832406044006, 0.03514113277196884, 0.04020272195339203, -0.017491480335593224, 0.0033051911741495132, -0.018308715894818306, -0.0014062714762985706, -0.028471436351537704, -0.014894779771566391, -0.0052395351231098175, 0.002461592899635434, -0.021340396255254745, 0.03680196776986122, -0.008824827149510384, 0.012568294070661068, -0.013490979559719563, 0.009991365484893322, -0.010769057087600231, 0.021287672221660614, 0.010683379136025906, 0.015237490646541119, -0.02915685996413231, -0.009035727009177208, 0.026151541620492935, -0.03163493052124977, -0.016410619020462036, 0.00759897381067276, 0.04993046447634697, 0.025255218148231506, 0.024965232238173485, 0.009912277571856976, 0.010887688025832176, 0.047821469604969025, -0.011790601536631584, -0.015132041648030281, 0.01958729326725006, -0.0216040201485157, -0.03384937345981598, 0.017175130546092987, 0.013563476502895355, -0.0034897280856966972, 0.021419484168291092, -0.018387801945209503, -0.020206810906529427, -0.018743695691227913, -0.04547521099448204, 0.027654200792312622, 0.02161720208823681, 0.02551884390413761, -0.02820781245827675, -0.007645107805728912, -0.01894141361117363, 0.00010302977898390964, 0.0017217969289049506, -0.027812374755740166, -0.008389847353100777, -0.018730513751506805, -0.020391348749399185, 0.011144721880555153, 0.016160177066922188, 0.01948184333741665, 0.025479299947619438, -0.004679333418607712, -0.008943458087742329, -0.015988821163773537, 0.0428653284907341, 0.026929233223199844, -0.012126723304390907, 0.023133043199777603, -0.006471979431807995, -0.020325442776083946, -0.036432892084121704, 0.007645107805728912, 0.0016493002185598016, -0.02986864559352398, -0.02166992612183094, -0.04030817374587059, 0.01733330450952053, -0.005140676163136959, 0.04518522322177887, 0.025874735787510872, 0.011652198620140553, 0.011434708721935749, -0.048006005585193634, -0.013603019528090954, 0.003581996774300933, 0.04776874557137489, -0.02559792995452881, 0.015896551311016083, 0.0012110247043892741, -0.012930777855217457, 0.020628610625863075, -0.010024318471550941, -0.0030909962952136993, -0.02356802299618721, 0.0012588065583258867, -0.017583748325705528, 0.024200720712542534, -0.006999228149652481, -0.05035226419568062, -0.02630971558392048, 0.04655607044696808, 0.0384628027677536, -0.006478569936007261, -0.02820781245827675, -0.010749285109341145, 0.002721922006458044, -0.003918117843568325, -0.03551020845770836, -0.020681334659457207, -0.021063590422272682, -0.010261580348014832, -0.02619108557701111, 0.008772102184593678, -0.031265854835510254, 0.007809873204678297, -0.035009320825338364, 0.004171856213361025, -0.0005606138147413731, -0.0044025275856256485, -0.00893686804920435, 0.04310259222984314, 0.03841007873415947, 0.011770830489695072, 0.04887596517801285, 0.0020513273775577545, 0.03769829124212265, -0.04536976292729378, -0.027047865092754364, -0.007480342872440815, -0.03522022068500519, -0.016951050609350204, -0.019495025277137756, -0.010874507017433643, 0.006478569936007261, -0.052803970873355865, -0.007717604748904705, 0.040993597358465195, 0.022223537787795067, 0.02712695300579071, 0.018005548045039177, -0.01739921048283577, -0.0019013910787180066, 0.004985796753317118, -0.012245354242622852, 0.012093770317733288, 0.020219992846250534, 0.010960184969007969, 0.02136675827205181, -0.01264079101383686, 0.011045862920582294, -0.001444991328753531, -0.00458706496283412, -0.03324303776025772, 0.0032293989788740873, 0.009543203748762608, -0.011671970598399639, 0.007486933376640081, 0.017847372218966484, -0.004267420154064894, 0.005262602586299181, -0.030527707189321518, 0.03545748442411423, -0.0002261403133161366, -0.005199991632252932, -0.0012703401735052466, 0.020154086872935295, 0.02232898771762848, 0.046160634607076645, 0.0019969549030065536, 0.008857780136168003, -0.01699059270322323, 0.04484251141548157, 0.006129267625510693, -0.01704331859946251, -3.712367106345482e-05, -0.019270945340394974, -0.01697741262614727, -0.012192629277706146, -0.010287942364811897, -0.026520615443587303, -0.004728762898594141, 0.0049989777617156506, -0.035009320825338364, -0.023554841056466103, -0.027917824685573578, 0.007394664920866489, 0.006129267625510693, 0.012627609074115753, 0.042127180844545364, 0.007058543618768454, -0.11451844871044159, -0.02831326238811016, 0.016423800960183144, 0.006508227903395891, 0.009154357947409153, -0.006109495647251606, 0.012555113062262535, 0.011770830489695072, 0.018611883744597435, -0.0035160905681550503, -0.0015784511342644691, -0.035404760390520096, -0.0033842783886939287, 0.016410619020462036, -0.00809986051172018, -0.02891959808766842, -0.03917458653450012, 0.01875687763094902, 0.021630384027957916, -0.025637473911046982, -0.04249625653028488, -0.017557386308908463, 0.01009022444486618, 0.022539887577295303, -0.01763647235929966, -0.04080905765295029, -0.0005655567510984838, -0.004966024775058031, 0.007282624486833811, 0.010432936251163483, 0.01870415173470974, -0.019139131531119347, 0.004863870330154896, 0.00962229073047638, -0.033401213586330414, 0.023554841056466103, -0.01374801341444254, -0.00036598482984118164, -0.005720649845898151, 0.0022029115352779627, -0.04689878225326538, -0.034692972898483276, 0.03519386053085327, -0.002216092776507139, 0.03996546193957329, -0.03471933677792549, 0.023001229390501976, 0.0013543703826144338, 0.01894141361117363, 0.007737376727163792, -0.02041771076619625, -0.0420217327773571, 0.005038521718233824, -0.004821031354367733, 0.011250171810388565, 0.0076055643148720264, -0.04484251141548157, 0.005038521718233824, 0.0075660208240151405, 0.015329759567975998, -0.0021501865703612566, 0.004422299563884735, 0.021274490281939507, -0.035352032631635666, -0.016832418739795685, -0.020470434799790382, 0.014064362272620201, 0.06290078163146973, 0.005529521964490414, -0.004260829649865627, 0.006158925127238035, -0.019257763400673866, 0.0032639997079968452, 0.008996183052659035, 0.020799966529011726, 0.014486161060631275, 0.006346757523715496, 0.026375623419880867, -0.04302350431680679, 0.024016184732317924, 0.017188312485814095, -0.022513525560498238, 0.0006388772744685411, 0.022869417443871498, 0.02445116452872753, -0.02007499895989895, 0.04215354472398758, -0.01651606895029545, -0.03300577774643898, 0.012772602960467339, 0.01633153297007084, -0.005905186757445335, 0.01714876852929592, -0.007987819612026215, 0.008660062216222286, 0.02725876495242119, -0.001398857100866735, 0.021089952439069748, 0.022605793550610542, -0.007941685616970062, 0.027865100651979446, 0.019376395270228386, -0.0313449427485466, -0.05657380074262619, -0.015316578559577465, -0.01643698289990425, 0.029895007610321045, -0.014262081123888493, 0.051564935594797134, -0.024899326264858246, 0.005674515385180712, -0.007249671500176191, -0.022039001807570457, 0.03474569693207741, 0.007453980389982462, 0.03593200817704201, -0.0002438525843899697, 0.015224309638142586, 0.01929730735719204, -0.0024533546529710293, 0.010854735039174557, 0.03711831569671631, -0.013240535743534565, 0.005789851304143667, -0.03295304998755455, -0.02599336765706539, 0.025202494114637375, 0.05314668267965317, -0.0001877294125733897, 0.001838780241087079, -0.022645337507128716, 0.04956138879060745, 0.011994910426437855, 0.013840281404554844, -0.00944434478878975, 0.01517158467322588, 0.012588066048920155, 0.018730513751506805, -0.030606795102357864, 0.03403391316533089, 0.00938502885401249, 0.002829019445925951, 0.0633753091096878, 0.018915051594376564, 0.03709195554256439, 0.030369533225893974, -0.001998602645471692, -0.017175130546092987, -0.008271216414868832, -0.008587565273046494, 0.022539887577295303, -0.009226854890584946, 0.016845600679516792, 0.03237307816743851, -0.026164723560214043, 0.018269171938300133, -0.004030158277601004, -0.026256991550326347, 0.030712245032191277, 0.05736467242240906, -0.01768919825553894, 0.04007091000676155, 0.0018486662302166224, 0.028524162247776985, 0.039332762360572815, -0.017135586589574814, -0.02385800890624523, -0.018809601664543152, -0.004676037933677435, 0.0031470165122300386, -0.020918596535921097, -0.05741739645600319, 0.042127180844545364, 0.023053955286741257, 0.036722879856824875, 0.0086402902379632, -0.006181992590427399, -0.005381233524531126, -0.0017580452840775251, 0.007882369682192802, -0.028365986421704292, 0.039332762360572815, -0.0186382457613945, -0.011981729418039322, 0.00045763549860566854, -0.010399983264505863, 0.02066815458238125, -0.00015086318308021873, -0.0015430266503244638, -0.00887755211442709, 0.04078269749879837, 0.013444844633340836, -0.0146970609202981, 0.029315033927559853, 0.021828101947903633, -0.018190084025263786, 0.015356122516095638, 0.025452937930822372, -0.04349802806973457, -0.005763488821685314, -0.06263715773820877, 0.043840739876031876, -0.006313804537057877, -0.013220764696598053, -0.03611654415726662, 0.052329447120428085, -0.010320895351469517, -0.013866644352674484, -0.006719127297401428, 0.007453980389982462, 0.003964252304285765, 0.010320895351469517, -0.0345611609518528, 0.034640248864889145, 0.012462844140827656, -0.03192491829395294, -0.014196174219250679, -0.0032195132225751877, -0.002125471830368042, -0.026494253426790237, -0.046925146132707596, -0.008231672458350658, -0.0049627297557890415, -0.010017727501690388, -0.021353578194975853, 0.02363392896950245, 0.020259536802768707, -0.0030399190727621317, -0.018796421587467194, 0.015290215611457825, 0.01287805289030075, 0.005552589427679777, -0.0004914123564958572, 0.017979184165596962, -0.012957139872014523, -0.01347779855132103, -0.010314305312931538, -0.019257763400673866, 0.0075660208240151405, -0.011210627853870392, 0.022249899804592133, 0.0013238888932392001, -0.01294395886361599, 0.01786055415868759, -0.019679563120007515, -0.01994318701326847, 0.017069680616259575, 0.03166129067540169, 0.014683879911899567, -0.005348280072212219, -0.008521659299731255, -0.0054504345171153545, 0.030975868925452232, -0.0038093726616352797, 0.005578951444476843, -0.008719377219676971, 0.011197446845471859, 0.032794877886772156, 0.021274490281939507, 0.011652198620140553, -0.01519794762134552, 0.027153315022587776, 0.015619746409356594, -0.006745489779859781, -0.004929776303470135, -0.02802327461540699, -0.021234946325421333, 0.00655765738338232, 0.017359668388962746, -0.0038522116374224424, -0.03039589524269104, -0.006666402332484722, -0.010900869034230709, 0.0091477669775486, -0.0019310488132759929, 0.009675015695393085, -0.014670698903501034, -0.0026477777864784002, 0.017003774642944336, -0.009490478783845901, 0.00484080333262682, -0.021762195974588394, -0.03450843691825867, -0.0036182450130581856, 0.0015257262857630849, 0.0005165390903130174, -0.01142811868339777, -0.011494024656713009, 0.030606795102357864, 0.002072746865451336, -0.018137359991669655, 0.01697741262614727, 0.020088180899620056, 0.014894779771566391, -0.004405823070555925, -0.011006318964064121, 9.849873458733782e-05, 0.016819236800074577, -0.0015199595363810658, -0.03239944204688072, 0.009483887813985348, -0.0017761695198714733, 0.0146970609202981, -0.010854735039174557, 0.021340396255254745, 0.035483844578266144, -0.021577658131718636, -0.020154086872935295, -0.0267710592597723, -0.003483137581497431, -0.010109996423125267, 0.03276851400732994, -0.0037632384337484837, 0.018598701804876328, 0.01204763539135456, 0.004346507601439953, 0.010525205172598362, -0.036432892084121704, 0.024174358695745468, -0.025861555710434914, 3.1125186069402844e-05, 0.033928461372852325, 0.0011673618573695421, 0.009154357947409153, 0.014196174219250679, -0.027917824685573578, 0.0018107701325789094, 0.011553339660167694, -0.007177174557000399, 0.00979364663362503, 0.03261033818125725, 0.0048177363350987434, 0.018414165824651718, 0.009905687533318996, -0.05446480214595795, 0.01691150665283203, 0.01190923247486353, -0.0008365956018678844, -0.011098587885499, -0.0026889690198004246, 0.03543112054467201, 0.005539407953619957, -0.010340667329728603, 0.0024813648778945208, 0.015619746409356594, 0.013016455806791782, -0.020338622853159904, -0.017346486449241638, -0.027680562809109688, -0.0074210274033248425, 0.06500978022813797, -0.02439843863248825, -0.023910734802484512, 0.029895007610321045, -0.0016863724449649453, 0.046687882393598557, -0.0036709699779748917, -0.010109996423125267, -0.02783873863518238, 0.014143450185656548, -0.015685653313994408, -0.008587565273046494, -0.015553840436041355, -0.0009037374402396381, 0.013260307721793652, 0.0008262977935373783, -0.015039772726595402, 0.031555842608213425, -0.005733830854296684, 0.004102654755115509, 0.05306759476661682, -0.01345143560320139, 0.0010750932851806283, -0.0047880783677101135, 0.0035259765572845936, -0.002262227004393935, -0.007671470288187265, 0.027047865092754364, -0.02107677236199379, 0.014064362272620201, 0.001433457713574171, -0.03972819820046425, -0.008620518259704113, -0.029315033927559853, -0.0057470123283565044, 0.046819694340229034, -0.014314806088805199, 0.028893236070871353, -0.005420777015388012, -0.0009622290963307023, 0.018440527841448784, -0.0012777545489370823, -0.026810603216290474, -0.00655765738338232, -0.03893732652068138, -0.006205059587955475, -0.009226854890584946, 0.006593905854970217, -0.0008114689262583852, -0.008304169401526451, 0.010617473162710667, 0.013306442648172379, 0.03445570915937424, 0.019429119303822517, 0.00032705903868190944, -0.004135608207434416, 0.017886916175484657, 0.04233808070421219, 0.010650426149368286, 0.026138359680771828, -0.04945594072341919, 0.007210127543658018, -0.028339624404907227, 0.0012439776910468936, -0.033163949847221375, -0.025637473911046982, -0.040281809866428375, 0.007704423274844885, -0.021327214315533638, 0.0218544639647007, -0.021353578194975853, 0.0019244581926614046, 0.0006162220379337668, 0.02405572682619095, -0.0020776898600161076, 0.009134585969150066, -0.016476524993777275, 0.015988821163773537, 0.012027863413095474, 0.03556293249130249, -0.009292760863900185, 0.008870961144566536, -0.0034073456190526485, 0.000871608208399266, 0.02231580577790737, 0.022104907780885696, 0.016779694706201553, -0.03353302553296089, -0.021538114175200462, 0.027996912598609924, -0.02356802299618721, 0.025914279744029045, 0.01631835103034973, -0.008666652254760265, -0.016489706933498383, -0.03329576179385185, -0.030764969065785408, -0.03616926819086075, 0.015066135674715042, 0.01246943511068821, -0.017359668388962746, -0.01311531476676464, 0.017254218459129333, 0.024082090705633163, -0.04708332195878029, 0.00069201405858621, -0.06142449006438255, 0.015079316683113575, 0.04181083291769028, -0.01906004548072815, 0.007572611328214407, -0.0039510708302259445, 0.0040664067491889, -0.017900098115205765, -0.0066762883216142654, 0.026046091690659523, -0.017320124432444572, 0.014420255087316036, 0.003249170957133174, -0.004481615033000708, 0.02695559710264206, -0.014327987097203732, 0.028392348438501358, 0.008218491449952126, -0.011447889730334282, 0.01840098388493061, -0.010591111145913601, -0.00507477018982172, -0.01721467450261116, 0.010703151114284992, -0.02553202398121357, 0.009595928713679314, 0.03197764232754707, -0.017728742212057114, 0.0325312539935112, 0.05377937853336334, -0.01858552172780037, -0.016239263117313385, -0.0021831397898495197, 0.0007290862849913538, 0.005529521964490414, 0.021208584308624268, -0.003957661334425211, 0.011731286533176899, -0.004339917097240686, -0.0022424552589654922, 0.01822962798178196, -0.001754750031977892, 0.023133043199777603, -0.01875687763094902, 0.013866644352674484, 0.027627838775515556, -0.008066906593739986, 0.01552747841924429, -0.00634016701951623, 0.006389596499502659, -0.03619563207030296, -0.015988821163773537, 0.017412392422556877, 0.0009910630760714412, 0.006386301480233669, -0.00509124668315053, -0.002730160253122449, 0.016595156863331795, 0.04059816151857376, -0.020615428686141968, -0.009806828573346138, 0.0019178675720468163, 0.00911481399089098, -0.010558158159255981, 0.004560702480375767, 0.0005383704556152225, -0.022948505356907845, 0.0013082361547276378, -0.0033776878844946623, -0.028365986421704292, -0.00837666541337967, 0.015540659427642822, -0.003512795316055417, -0.016937868669629097, -0.016885142773389816, -0.0012176152085885406, 0.019574113190174103, 0.0040169768035411835, -0.00887755211442709, -0.0003571287088561803, -0.010169311426579952, 0.016489706933498383, -0.004702400416135788, -0.007144221570342779, -0.008956639096140862, -0.007368302438408136, 0.016608338803052902, -0.026612885296344757, 0.010413164272904396, 0.01667424477636814, 0.008218491449952126, 0.031186768785119057, 0.02992137148976326, 0.026283353567123413, 0.023607566952705383, -0.010294533334672451, -0.02754875086247921, -0.002687321277335286, -0.006221536081284285, 0.014538886025547981, 0.02358120307326317, 0.001404623850248754, 0.008093269541859627, -0.0009869439527392387, 0.01208058837801218, 0.0051209041848778725, 0.000848541094455868, 0.007381483446806669, -0.018506433814764023, 0.011302896775305271, 0.014921141788363457, 0.034165725111961365, -0.014842054806649685, -0.0369337797164917, 0.013036226853728294, 0.004148789215832949, 0.004211400169879198, -0.028049638494849205, 0.009022546000778675, -0.007051953114569187, -0.010459298267960548, 0.005401005037128925, -0.019745469093322754, -0.0044288900680840015, -0.012785783968865871, -0.016819236800074577, 0.029763195663690567, 0.022632155567407608, 0.02671833522617817, -0.021801738068461418, 0.005002273246645927, -0.00605347566306591, -0.023251673206686974, 0.035062048584222794, 0.0023363714572042227, 0.030975868925452232, 0.03329576179385185, -0.022421255707740784, -0.006920140702277422, 0.009780465625226498, 0.033691201359033585, 0.020865872502326965, -0.02112949639558792, 0.020694516599178314, -0.03395482525229454, 0.013774375431239605, -0.012363985180854797, -0.03603745624423027, 0.00045557593693956733, 0.010914050973951817, 0.013069179840385914, -0.009997955523431301, 0.04128358140587807, 0.04368256404995918, 0.0077241952531039715, 0.0033315534237772226, -0.016133813187479973, 0.011882870458066463, -0.017122406512498856, 0.009332303889095783, 0.005430663004517555, 0.02309349924325943, -0.017834192141890526, -0.007803282700479031, -0.017583748325705528, 0.021221764385700226, 0.02926230989396572, 0.007084906101226807, 0.002476421883329749, 0.0051472666673362255, -0.006959684658795595, 0.0032475232146680355, -0.016015183180570602, -0.02012772485613823, 0.018190084025263786, 0.013286670669913292, 0.007493523880839348, -0.011942186392843723, -0.0026543682906776667, 0.007776920218020678, -0.010584520176053047, -0.014248899184167385, -0.005796441808342934, -0.02731148898601532, -0.008699605241417885, -0.000725379039067775, 0.008060316555202007, -0.01834825985133648, -0.03859461471438408, -0.006801509764045477, -0.0238052848726511, -0.002974012866616249, 0.0029937848448753357, 0.03722376748919487, -0.03284760192036629, 0.008831418119370937, 0.022276263684034348, 0.03564202040433884, 0.009938640519976616, 0.01415663119405508, -0.022131269797682762, 0.03651197999715805, 0.005513045471161604, -0.002216092776507139, -0.01786055415868759, -0.01347779855132103, -0.029710471630096436, 0.02351529709994793, 0.0176232922822237, -0.012423300184309483, -0.01782101020216942, -0.01187627948820591, -0.016819236800074577, 0.046635158360004425, 0.00881164614111185, 0.01631835103034973, -0.0017712265253067017, -0.004755125381052494, 0.0643770843744278, -0.02397664077579975, 0.024556614458560944, -0.01552747841924429, 0.014143450185656548, -0.022131269797682762, 0.021564476191997528, 0.0182955339550972, 0.03350666165351868, -0.0036709699779748917, -0.01680605672299862, 0.02255306765437126, 0.029947733506560326, -0.000135004534968175, 0.03353302553296089, -0.019982730969786644, -0.02783873863518238, 0.008297578431665897, -0.02095814049243927, -0.01940275728702545, -0.004942957777529955, 0.03870006278157234, -0.03324303776025772, 0.002504431875422597, 0.009240035898983479, 0.014987047761678696, 0.007678061258047819, 0.011441299691796303, -0.029051410034298897, 0.044737063348293304, -0.01036043930798769, -0.011019500903785229, 0.02488614432513714, 0.0033628589008003473, -0.024240264669060707, 0.027232401072978973, -0.01917867548763752, 0.016278807073831558, 0.003941184841096401, -0.0017844077665358782, 0.00759897381067276, -0.00736171193420887, -0.02695559710264206, -0.03669651970267296, -0.02797055058181286, -0.021037228405475616, -0.010426345281302929, 0.03561565652489662, 0.029051410034298897, 0.04115176945924759, -0.03150311857461929, -0.035589296370744705, -0.013734832406044006, -0.032452166080474854, -0.0019178675720468163, -0.012508978135883808, -0.007229899521917105, -0.026322897523641586, 0.011111768893897533, -0.020035455003380775, -0.005473501980304718, -0.005157152656465769, 0.017306942492723465, 0.0170301366597414, 0.004105950240045786]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
"approximate the lower triangle) could exist, but the one in
Fig. 2 (d) is LLM-friendly: easy to generate at the context
level, and exactly aligned with KV-cache.
Hence, we can intuitively map the partitions in Fig. 2 (d) to
pprocesses, which can be implemented by dual-purposing
the already-existing KV-cache interface with minor efforts,
leading to the motivation behind KV-Runahead. Also, as
seen in Fig. 2 (d), each process will suffer from varying
computation load, thus one may not effectively minimize
TTFT. Yet, optimizing cialone may lead to global over-
computation. Hence, we perform context-level partitioning
for load-balancing and minimal TTFT in KV-Runahead.
4. KV-Runahead Overview
In Fig. 3, the proposed KV-Runahead is illustrated and com-
pared against Tensor/sequence parallel inference (or TSP),
which characterizes both tensor parallelism (Shoeybi et al.,
2020; Narayanan et al., 2021b) and sequence paralleliza-
tion (Li et al., 2023). As in Fig. 3 (b), KV-Runahead starts
with uneven context partitioning for load-balancing. The
existing TSP parallelizes the forward computation itself, but
KV-Runahead achieves parallel inference by utilizing mul-
tiple processes to populate KV-caches for the last process.
Therefore, unlike TSP where computation is symmetric and
evenly distributed (thus no need to balance out context par-
titioning), KV-Runahead needs good context partitioning
3
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
(a)Q, K, V are computed for the evenly partitioned context.
 (b)K, V are exchanged by all-gather to mimic Fig. 1 (b).
Figure 4. Tensor/sequence parallel inference over 3 processes p{0,1,2}within a layer to compute attention map ( QKT) and final attention
A: Each process will compute the equal amount of (Q, K, V )in (a), and then globally share ( K, V ) using all-gather collectives to
compute the equally sized partial QKT(i.e., 27 dot-products needed on each) and partial A. Such all-gather operations require global
synchronization, and incur the traffic for36(K, V)entries (i.e., the number of blue rows in (K, V)).
(a)Q, K, V are computed for the uneven partitioning.
 (b) KV-caches are handed down from pitopi+1bysend.
Figure 5. KV-Runahead execution over 3 processes p{0,1,2}within a layer to compute attention map ( QKT) and final attention A:
Each process will compute different amounts of (Q, K, V )in (a), and the maximum amount for QKTis21 dot-products onp1(in
contrast to 27from Fig. 4 (b)). The locally computed (K, V)are passed down to the following processes as KV-cache using point-2-point
one-way send (i.e.,p0→p1→p2). Our communication is much cheaper than global all-gather in Fig. 4 (b), as the traffic incurred in
KV-Runahead is 22(i.e., the number of blue rows in (K, V)), which is much lower than 36from Fig. 4.
4
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
to balance out the KV-cache amount from each compute
process and to minimize TTFT.
Once partitioning is complete, each process will run each
layer, conditioning on the KV-cache from its precedent pro-
cess. In detail, the current process must wait for the required
KV-cache to arrive from the precedent (i.e., notice the layer
misalignment in Fig. 3 (b)), forming a dependency chain
via local peer-to-peer communication rather than global
synchronization via all-gather (Thakur et al., 2005).
We will first elaborate on how KV-Runahead works inside
each layer in terms of compute/communication saving in
Section 4.1, and then discuss the context partitioning for
load-balancing in KV-Runahead in Section 4.2. Finally,
Section 4.3 briefly discuss implementing KV-Runahead.
4.1. Forward Execution
The causal attention computation on a single process is
shown in Fig. 1 (b), which is to be parallelized in this sec-
tion.","[-0.018774406984448433, 0.01782659813761711, 0.019709233194589615, -0.02394191361963749, 0.018735455349087715, -0.006803450640290976, 0.042274873703718185, 0.021487997844815254, -0.03393935039639473, 0.01982608623802662, 0.05006508529186249, 0.05055846646428108, 0.005083112511783838, 0.011373707093298435, -0.03222550451755524, -0.033653710037469864, -0.0017609121277928352, -0.02905748412013054, 0.001859912765212357, -0.010107798501849174, -0.03339403495192528, -0.051675062626600266, 0.02079986222088337, 0.06689193844795227, -0.008419918827712536, -0.047546252608299255, 0.005816690623760223, 0.020514219999313354, 0.004813700914382935, -0.06813837587833405, 0.025227298960089684, -0.018761424347758293, -0.0868348777294159, -0.05624531954526901, 0.017527973279356956, 0.07795403897762299, -0.0032994786743074656, 0.007082599680870771, -0.04333953559398651, 0.05240214988589287, 0.03487417474389076, -0.048714783042669296, -0.07551310956478119, 0.017527973279356956, 0.02411070093512535, 0.003547791624441743, -0.0013941230718046427, -0.025954384356737137, -0.05946527421474457, 0.04398872330784798, 0.030303917825222015, -0.011250361800193787, -0.032822754234075546, 0.009465105831623077, -0.015450583770871162, 0.004777995869517326, 0.05081813782453537, -0.017813613638281822, 0.04263841733336449, -0.0024604080244898796, 0.049337998032569885, -0.04819543659687042, 0.009043135680258274, 0.005063636694103479, -0.017540957778692245, 0.023461516946554184, -0.007303322199732065, 0.0031939863692969084, -0.0003596886235754937, 0.012620140798389912, -0.03786042332649231, 0.040119584649801254, 0.016580164432525635, 0.0010833261767402291, 0.021072519943118095, 0.020462285727262497, 0.01803433708846569, 0.026928160339593887, 0.048143502324819565, 0.024474244564771652, 0.060296230018138885, -0.023993847891688347, 0.05671273171901703, 0.022292984649538994, 0.03858751058578491, -0.056193385273218155, -0.020838813856244087, -0.007225420325994492, -0.044248394668102264, -0.014697530306875706, -0.0020968650933355093, 0.050117019563913345, -0.021643800660967827, 0.04575450345873833, 0.07483795285224915, 0.024058766663074493, 0.02747347578406334, -0.05154522508382797, 0.030303917825222015, 0.02629196085035801, 0.010140256956219673, -0.00159293576143682, 0.020085759460926056, -0.029550865292549133, 0.06704774498939514, -0.012490304186940193, -0.012477320618927479, 0.026928160339593887, -0.00035664558527059853, -0.03651012107729912, -0.052454084157943726, -0.01450277492403984, -0.00903015211224556, 0.02570769377052784, -0.008199196308851242, -0.05702434107661247, -0.039911843836307526, -0.020462285727262497, 0.002423080150038004, -0.017696760594844818, -0.010899802669882774, 0.021487997844815254, 0.007218928541988134, -0.00760194705799222, -0.04837720841169357, -0.053440842777490616, 0.03157632052898407, -0.05115571618080139, 0.011847611516714096, -0.012100793421268463, 0.02905748412013054, 0.025655759498476982, 0.019345689564943314, -0.0007887587998993695, 0.002005979185923934, 0.020877763628959656, -0.012892798520624638, 0.029161354526877403, -0.009543008171021938, 0.0015231483848765492, -0.041651658713817596, -0.012055350467562675, 0.027992822229862213, 0.004839668050408363, -0.019774150103330612, 0.05546629801392555, -0.027785083279013634, 0.031108906492590904, -0.012879814952611923, -0.009977960959076881, -0.023253777995705605, -0.01728128269314766, -0.014853334985673428, -0.008393951691687107, -0.022825317457318306, -0.010847868397831917, -0.05624531954526901, 0.026123171672225, 0.02139711193740368, -0.00024445843882858753, -0.017553940415382385, -0.033056460320949554, 0.07748662680387497, -0.02469496801495552, -0.016541212797164917, -0.022241050377488136, -0.05608951672911644, -0.010166225023567677, -0.0663725957274437, -0.06658033281564713, -0.0007591397734358907, -0.0450533851981163, -0.061698466539382935, 0.03100503794848919, 0.037263173609972, -0.01689177379012108, -0.036016739904880524, -0.00242794887162745, 0.012113776989281178, -0.036951564252376556, -0.03612060844898224, 0.04235277697443962, 0.012801912613213062, 0.0365360863506794, -0.05728401243686676, 0.03632834926247597, 0.026798324659466743, 0.014269068837165833, -0.056764665991067886, 0.028667975217103958, 0.005534295458346605, 0.032069697976112366, 0.0239289291203022, 0.04398872330784798, 0.009367727674543858, -0.008510804735124111, 0.031031005084514618, 0.03217357024550438, -0.001976765925064683, -0.013068078085780144, 0.011477576568722725, -0.01334722712635994, 0.014866318553686142, -0.06455487757921219, 0.043287601321935654, -0.009783205576241016, 0.020098742097616196, -0.004956521559506655, 0.0002586593327578157, -0.05567403882741928, 0.02238387055695057, 0.016320491209626198, 0.026746388524770737, 0.05437566712498665, 0.01255522295832634, -0.030537625774741173, -0.06621678918600082, 0.028512170538306236, -0.003852908266708255, 0.039106857031583786, 0.023007087409496307, 0.033445969223976135, -0.019540444016456604, 0.011782693676650524, -0.033368069678545, 0.03843170404434204, -0.006167249754071236, -0.07385119795799255, 0.03349790349602699, 0.0042261891067028046, 0.025837531313300133, -0.017709745094180107, 0.005222687032073736, -0.014931236393749714, -0.004096352495253086, -0.0660090520977974, -0.0063263000920414925, -0.036795761436223984, 0.0028872466646134853, -0.07826564460992813, -0.03869137912988663, 0.019137950614094734, 0.0011677200673148036, -0.0075629958882927895, 0.014775432646274567, 0.03339403495192528, 0.008458870463073254, -0.011029639281332493, 0.023422565311193466, 0.01263961661607027, -0.008218672126531601, -0.01683983765542507, -0.0734357163310051, 0.006543776951730251, -0.04985734820365906, -0.011049115099012852, 0.028148626908659935, -0.003437430365011096, 0.0013770819641649723, -0.0027541639283299446, -0.025058509781956673, -0.0009129152749665082, -0.02409771829843521, -0.0006199709023348987, -0.022643545642495155, -0.004972750786691904, 0.03786042332649231, -0.01606081798672676, -0.02235790342092514, -0.06268522888422012, 0.033030491322278976, 0.0030170835088938475, 0.003327069105580449, -0.02137114480137825, 0.00198812666349113, 0.012990175746381283, 0.02450021170079708, 0.00014677649596706033, -0.0030398049857467413, -0.007050140295177698, 0.003865891834720969, 0.016177671030163765, 0.08522490411996841, -0.016930723562836647, 0.002838557818904519, -0.0010273340158164501, -0.016515245661139488, 0.014385921880602837, 0.010906294919550419, -0.03508191555738449, 0.005222687032073736, -0.008757495321333408, 0.03357580676674843, 0.01861860230565071, 0.03575706481933594, 0.04378098249435425, -0.024811821058392525, -0.005222687032073736, 0.00031465146457776427, -0.010360979475080967, 0.03331613168120384, 0.012886306270956993, 0.03321226313710213, 0.03840573877096176, -0.003641923423856497, 0.012425385415554047, -0.0016351327067241073, 0.015580421313643456, -0.04095054045319557, 0.0008520542760379612, -0.02390296198427677, 0.037159305065870285, -0.026227042078971863, 0.016437344253063202, 0.009977960959076881, -0.03588690236210823, 0.05473921075463295, -0.03316032886505127, 0.04575450345873833, 0.004206713754683733, -0.009984453208744526, -0.0801353007555008, -0.009387203492224216, 0.04624788090586662, 0.03399128466844559, 0.021708719432353973, -0.012405910529196262, -0.024032799527049065, 0.0200338251888752, 0.006699581164866686, -0.015229861252009869, -0.0022429313976317644, 0.0001313583634328097, -0.039158791303634644, -0.03347193822264671, -0.03043375536799431, -0.024617064744234085, -0.007478602230548859, 0.03170615807175636, 0.005014948081225157, -0.08823711425065994, -0.030329886823892593, -0.008478345349431038, -0.015995899215340614, -0.011315280571579933, 0.07520149648189545, 0.026045270264148712, -0.027940887957811356, 0.05473921075463295, 0.02081284485757351, -0.003830186789855361, -0.04767608642578125, 0.03606867417693138, -0.015840094536542892, 0.03840573877096176, -0.013788672164082527, 0.004537797532975674, -0.02177363820374012, -0.030122147873044014, -0.013931493274867535, -0.032251469790935516, -0.0028840007726103067, 0.03702946752309799, 0.007115059066563845, 0.009841632097959518, 0.0047260611318051815, -0.027499442920088768, -0.006271119229495525, 0.012315024621784687, 0.029888439923524857, 0.043469373136758804, 0.028200561180710793, 0.001119842752814293, -0.04840317368507385, -0.0593094676733017, -0.017735712230205536, -0.007472109980881214, 0.02768121473491192, 0.022656528279185295, 0.03949636593461037, 0.029161354526877403, 0.02414965257048607, 0.0075889634899795055, 0.010036387480795383, 0.01650226302444935, -0.003476381301879883, 0.0009680959628894925, -0.01245135348290205, -0.04494951292872429, -0.012808403931558132, 0.008251131512224674, -0.0017203381285071373, -0.001469590701162815, 0.029369093477725983, 0.011613905429840088, 0.017229348421096802, -0.012120269238948822, -0.012464337050914764, 0.03845767304301262, 0.0471307747066021, 0.013107028789818287, -0.010718030855059624, -0.036769792437553406, -0.022994104772806168, 0.016242587938904762, 0.003179379738867283, 0.012178695760667324, 0.0011839496437460184, 0.040301356464624405, 0.006829417776316404, 0.045806437730789185, -0.008510804735124111, 0.0008958742255344987, -0.040093615651130676, 0.05024685710668564, -0.011925513856112957, 0.002380883088335395, 0.013593916781246662, -0.016151703894138336, 0.05749175325036049, -0.016995642334222794, -0.010529767721891403, -0.04492354765534401, -0.045988209545612335, -0.01646331138908863, 0.008939266204833984, 0.03354984149336815, -0.06606098264455795, 0.043261636048555374, -0.043235667049884796, -0.019670281559228897, 0.014853334985673428, 0.027707181870937347, 0.033653710037469864, -0.016593148931860924, 0.0007230289047583938, 0.004427436273545027, -0.0003578627947717905, -0.03879524767398834, -0.03788638859987259, 0.03144648298621178, -0.04204116761684418, -0.013541982509195805, -0.0011587938060984015, -0.04027538746595383, -0.0004925685352645814, -0.013094045221805573, -0.02651268243789673, 0.033601775765419006, -0.026525666937232018, 0.02194242551922798, 0.04741641506552696, 0.037522848695516586, 0.024863755330443382, 0.010425898246467113, -0.0681903064250946, 0.06912513077259064, 0.019735200330615044, 0.031316645443439484, 0.016567181795835495, -0.00036922350409440696, 0.033238232135772705, -0.04905235767364502, -0.009692320600152016, 0.016021866351366043, 0.01724233292043209, 0.06476261466741562, -0.001572648761793971, 0.01067908015102148, -0.00012080911983503029, 0.03038182109594345, -0.02159186638891697, 0.017605874687433243, -0.031264711171388626, -0.05473921075463295, -0.013178438879549503, -0.007829161360859871, -0.02664251998066902, 0.028486203402280807, 0.016982659697532654, 0.03201776370406151, 0.008290082216262817, 0.02960279956459999, 0.012970699928700924, 0.02488972246646881, 0.043053895235061646, 0.01743708737194538, 0.010549243539571762, 0.036795761436223984, 0.03191389515995979, -0.03791235759854317, 0.0005854829796589911, 0.03760074824094772, -0.01332125999033451, 0.0011766463285312057, 0.0037263173144310713, -0.0305635929107666, 0.01882634125649929, 0.014463824220001698, -0.012990175746381283, 0.03804219514131546, 0.033082425594329834, 0.03162825480103493, 0.0014493037015199661, 0.018631586804986, 0.026123171672225, 0.041495855897665024, 0.02272144705057144, 0.006861877162009478, 0.02804475836455822, -0.016125734895467758, 0.021539932116866112, 0.021864524111151695, 0.006907320115715265, -0.007920047268271446, 0.0431058295071125, -0.019488509744405746, 0.03256307914853096, 0.027992822229862213, -0.008621166460216045, -0.03116084262728691, 0.018527716398239136, -0.04118424654006958, -0.014983171597123146, 0.025032542645931244, -0.01865755394101143, -0.03139454871416092, -0.11809959262609482, -0.03747091069817543, -0.042456645518541336, 0.03614657744765282, 0.010828392580151558, -0.017761679366230965, -0.006732040084898472, -0.017333218827843666, 0.019540444016456604, 0.018579652532935143, -0.028771843761205673, -0.04131408408284187, 0.003901597112417221, 0.004777995869517326, 0.00932228472083807, 0.013775688596069813, 0.029524898156523705, -0.009588451124727726, -0.020241564139723778, 0.057387884706258774, -0.024045782163739204, 0.0003744981368072331, 0.02590245008468628, 0.013412145897746086, -0.015048089437186718, 0.021215340122580528, -0.010438881814479828, -0.01284735556691885, -0.009653368964791298, -0.004596224054694176, -0.006534039042890072, 0.009075595065951347, -0.020631074905395508, 0.03783445432782173, 0.02608422189950943, 0.005670623853802681, -0.038327835500240326, -0.003237806260585785, 0.029291192069649696, 0.01924181915819645, -0.028486203402280807, 0.001240753335878253, 0.010737506672739983, -0.0197871346026659, -0.0012212777510285378, 0.003202100982889533, -0.013801655732095242, 0.03780848905444145, -0.010153240524232388, 0.014671563170850277, 0.01568428985774517, 0.007179977372288704, 0.005845903884619474, -0.04282018914818764, -0.013386177830398083, -0.03160228580236435, -0.012886306270956993, 0.004183992277830839, 0.01206184271723032, -0.008796446025371552, -0.005014948081225157, -0.008212179876863956, 0.025227298960089684, 0.022228067740797997, -0.0005035235080868006, 0.04507935047149658, 0.01704757660627365, -0.009393695741891861, 0.0040314337238669395, 0.007822670042514801, -0.013684802688658237, -0.014723497442901134, -0.015749208629131317, -0.005832919850945473, 0.016190653666853905, -0.007868112996220589, -0.03155035153031349, -0.011542495340108871, 0.04437823221087456, -0.005651148501783609, 0.038951050490140915, 0.03505594655871391, -0.02351345121860504, 0.01844981499016285, -0.021851539611816406, -0.022838300094008446, -0.007543520536273718, -0.033368069678545, -0.011587938293814659, -0.01765781082212925, -0.00795899797230959, 0.042690351605415344, -0.01708652824163437, 0.03684769570827484, -0.000955923751462251, -0.00030836250516586006, -0.02135816030204296, 0.005219440907239914, 0.0004901340580545366, 0.007991457358002663, -0.015450583770871162, -0.012334499508142471, 0.006404201965779066, -0.029083453118801117, -0.009387203492224216, 0.0001347057259408757, 0.036588020622730255, -0.005553770810365677, 0.01729426719248295, 0.013288800604641438, -0.011594429612159729, 0.05219440907239914, 0.002246177289634943, -0.003577004885300994, 0.01998188905417919, -0.028122659772634506, -0.02314990945160389, 0.03996377810835838, 0.0004860766639467329, 0.007777226623147726, 0.04881865158677101, 0.0024750148877501488, -0.04596224054694176, -0.01489228568971157, -0.05094797536730766, 0.03095310367643833, 0.01964431442320347, 0.028096692636609077, -0.01729426719248295, -0.01060117781162262, -0.032459210604429245, 0.007050140295177698, -5.918733950238675e-05, -0.027109932154417038, -0.013197914697229862, -0.028304431587457657, -0.02723976969718933, -0.005761509761214256, 0.020929697901010513, 0.026551634073257446, 0.00795899797230959, 0.0016748952912166715, 0.006034167017787695, -0.04175552725791931, 0.013606901280581951, 0.026201074942946434, -0.0027833771891891956, -0.007907063700258732, -0.006076364312320948, -0.014048346318304539, -0.022812332957983017, -0.0019978643395006657, 0.03082326613366604, -0.014204150065779686, -0.024019815027713776, -0.022812332957983017, 0.021449046209454536, 0.002781754359602928, 0.031056972220540047, -0.003116084262728691, -0.014827366918325424, 0.03139454871416092, -0.03713333606719971, 0.0003038993454538286, 0.005907576065510511, 0.03505594655871391, -0.02276039868593216, 0.009731271304190159, 0.011841120198369026, -0.007465618196874857, 0.003963269758969545, -0.016969675198197365, -0.012159219942986965, -0.01786554977297783, -0.02372119016945362, -0.019916972145438194, 0.019903987646102905, -0.028719909489154816, -0.04920816421508789, -0.013003159314393997, 0.04759818688035011, 0.036795761436223984, -0.04357324540615082, -0.032666947692632675, -0.014359954744577408, 0.0009364482248201966, -0.019942939281463623, -0.04614401236176491, -0.011607413180172443, -0.009056119248270988, 0.013645851984620094, -0.005268129985779524, -0.022890234366059303, -0.01980011910200119, 0.008945758454501629, -0.00029294437263160944, -0.016164686530828476, 0.008101819083094597, -0.004891602788120508, -0.02591543272137642, 0.030927134677767754, 0.04331357032060623, 0.023175876587629318, 0.050350725650787354, -0.008757495321333408, 0.00942615419626236, -0.009951993823051453, -0.021254291757941246, 0.006686597131192684, -0.05536242946982384, -0.016956690698862076, -0.025603825226426125, -0.004326812922954559, -0.004703339654952288, -0.043287601321935654, 0.01265909243375063, 0.06123105436563492, 0.0008869479061104357, -0.009224907495081425, 0.0231369249522686, -0.02376014180481434, -0.02646074816584587, 0.007309813983738422, -0.011659348383545876, 0.011925513856112957, -0.0033627741504460573, -6.075958299334161e-05, 0.03682172670960426, -6.498181846836815e-06, 0.011737250722944736, -0.006202955264598131, 0.006803450640290976, -0.03723720461130142, 0.0025902448687702417, -0.0070631243288517, -0.0012805158039554954, 0.00042643287451937795, 0.006907320115715265, 0.011847611516714096, 0.009166480973362923, -0.02962876670062542, 0.028745876625180244, 0.026954127475619316, 0.009257366880774498, 0.011049115099012852, 0.005407704506069422, 0.025253266096115112, 0.03393935039639473, -0.013580933213233948, 0.013762705028057098, -0.016359442844986916, 0.02962876670062542, 0.01625557243824005, 0.004171008709818125, -0.0061575123108923435, -0.04256051778793335, -0.028200561180710793, -0.010250618681311607, -0.019163917750120163, -0.0069722384214401245, 0.005868625361472368, -0.03243324160575867, -0.026590585708618164, -0.021630818024277687, -0.02096864953637123, 0.0009461859590373933, 0.0077577512711286545, -0.007264371030032635, 0.04788382723927498, -0.012198171578347683, -0.09618312865495682, -0.0044598956592381, 0.02411070093512535, 0.012334499508142471, 0.016359442844986916, -0.011587938293814659, -0.0035153324715793133, -0.004528059624135494, 0.01983906887471676, -0.011639872565865517, -0.012730502523481846, -0.012717518955469131, -0.008952249772846699, -0.01285384688526392, -0.016606131568551064, -0.03269291669130325, -0.021656785160303116, 0.008725035935640335, 0.004661142360419035, -0.042872123420238495, -0.027966855093836784, -0.01865755394101143, 0.0043949768878519535, 0.022656528279185295, -0.028018789365887642, -0.029680700972676277, -0.01235397532582283, -0.011626888997852802, -0.006290595047175884, 0.015450583770871162, -0.007835653610527515, -0.019878020510077477, -0.012464337050914764, 0.03456256538629532, -0.0321476012468338, 0.018956178799271584, -0.01381464023143053, 0.001164474175311625, 0.015645340085029602, -0.009640385396778584, -0.050117019563913345, -0.049337998032569885, 0.030122147873044014, -0.0035867427941411734, 0.03388741612434387, -0.02274741418659687, 0.0455467626452446, 0.014645596034824848, 0.011088065803050995, 0.019150933250784874, 0.014437857083976269, -0.0157102569937706, -0.01195797324180603, 0.009049627929925919, 0.01442487258464098, 0.0249027069658041, -0.02981053851544857, -0.024604082107543945, -0.0020400614012032747, 0.0239289291203022, -0.0019232082413509488, 0.0197871346026659, 0.030251983553171158, -0.00873801950365305, -0.020838813856244087, -0.011639872565865517, 0.03238130733370781, 0.05702434107661247, 0.006378234829753637, -0.009945501573383808, -0.00735525693744421, 0.005800460930913687, 0.006647646427154541, -0.0029489193111658096, 0.028512170538306236, 0.02256564237177372, -0.01590501330792904, 0.007121550850570202, -0.07291636615991592, 0.027317671105265617, 0.03318629786372185, -0.05115571618080139, 0.03297855705022812, 0.031056972220540047, 0.01371077075600624, -0.013593916781246662, 0.03456256538629532, -0.028590071946382523, -0.017151447013020515, -0.007192960940301418, 0.007907063700258732, -0.025045527145266533, 0.01097121275961399, -0.007796702440828085, 0.005326556507498026, 0.026928160339593887, 0.021695736795663834, 0.009302809834480286, 0.01685282215476036, -0.005446655675768852, 0.02765524759888649, 0.018345946446061134, -0.010964721441268921, -0.06730742007493973, -0.01786554977297783, 0.013983427546918392, 0.018099255859851837, 0.0023143417201936245, 0.03144648298621178, -0.0349520780146122, 0.006034167017787695, -0.0055732461623847485, -0.02708396501839161, 0.022020328789949417, -0.00834201741963625, 0.041106343269348145, -0.01502212230116129, 0.006803450640290976, 0.008867856115102768, -0.01964431442320347, 0.0068359095603227615, 0.0340951532125473, -0.026356877759099007, -0.022513708099722862, -0.022890234366059303, -0.004940291866660118, 0.01323686633259058, 0.022656528279185295, -0.012438368983566761, -0.004148287232965231, -0.03017408214509487, 0.021864524111151695, 0.021462028846144676, 0.027992822229862213, -0.013334243558347225, -0.007920047268271446, -0.015450583770871162, -0.010438881814479828, 0.0026567864697426558, 0.030511656776070595, 0.0028693941421806812, 0.0010038011241704226, 0.051077812910079956, 0.017125479876995087, 0.004102844279259443, 0.02861603908240795, -0.005972494836896658, -0.00911454576998949, -0.002528572455048561, 0.010815409012138844, 0.01748902164399624, -0.006842401344329119, 0.005907576065510511, 0.033835481852293015, -0.0032702654134482145, 0.03960023820400238, 0.005716066807508469, -0.004807209130376577, 0.03747091069817543, 0.05531049519777298, -0.01402237918227911, 0.04339147359132767, -0.007582471705973148, 0.018865292891860008, 0.032874688506126404, -0.019176902249455452, -0.00813427846878767, -0.010270094498991966, -0.006952762603759766, 0.005871871020644903, -0.015294780023396015, -0.03866541013121605, 0.03591287136077881, 0.02079986222088337, 0.07255282998085022, 0.05042862892150879, -0.015035105869174004, -0.023266762495040894, -0.00016036878514569253, 0.018683521077036858, -0.00431707501411438, 0.03427692502737045, -0.02884974516928196, -0.022825317457318306, -0.0047844876535236835, -0.013593916781246662, -0.0006605449016205966, 0.007478602230548859, -0.010653113014996052, 0.0021487995982170105, 0.03547142446041107, 0.019968906417489052, -0.02664251998066902, 0.018138207495212555, 0.0038756297435611486, -0.0028142135124653578, 0.01460664439946413, 0.03329016640782356, -0.04261245205998421, -0.010769966058433056, -0.06585324555635452, 0.05063636973500252, -0.0227733813226223, -0.02237088792026043, -0.03230340778827667, 0.04497548192739487, -0.01423011813312769, -0.018722472712397575, -0.011438625864684582, 0.0009534892742522061, -0.00164243602193892, 0.007829161360859871, -0.03406918793916702, 0.03863944485783577, 0.0029359355103224516, -0.015736225992441177, -0.01274348609149456, -0.032043732702732086, 0.0012780814431607723, -0.019371656700968742, -0.0321476012468338, -0.013593916781246662, -0.0007189714815467596, -0.003638677531853318, -0.01944955810904503, 0.014385921880602837, 0.016735969111323357, -0.007835653610527515, 0.008783462457358837, 0.02370820753276348, -0.012496795505285263, 0.02102058380842209, -0.011211411096155643, 0.023876994848251343, -0.04313179850578308, 0.010893311351537704, -0.01787853240966797, -0.02846023626625538, -0.005381736904382706, -0.007433159276843071, 0.015619372017681599, 0.013373194262385368, -0.007011189591139555, 0.0010695309611037374, -0.020670024678111076, -0.02237088792026043, 0.026928160339593887, 0.06310070306062698, 0.013438113033771515, 0.005787477362900972, -0.005664132069796324, -0.011704791337251663, 0.045001447200775146, 0.008601690642535686, -0.007011189591139555, 0.005625180900096893, 0.016632098704576492, 0.05785529688000679, -0.002299735089763999, 0.020734943449497223, -0.019358672201633453, -0.004881865344941616, 0.012977192178368568, -0.016619116067886353, -0.021319208666682243, -0.010159732773900032, -0.02115042135119438, 0.0166840348392725, 0.025422053411602974, 0.026395829394459724, -0.011607413180172443, 0.017527973279356956, -0.011899546720087528, 0.028564104810357094, -0.023474501445889473, -0.003168019000440836, -0.014827366918325424, -0.003758776467293501, 0.014788416214287281, -0.03318629786372185, 0.008770478889346123, -0.001254548435099423, -0.04292405769228935, 0.009783205576241016, -0.007290338631719351, -0.016385409981012344, -0.03456256538629532, -0.0028888697270303965, 0.01264610793441534, 0.014191166497766972, -0.014282052405178547, -0.003476381301879883, 0.0020205858163535595, 0.008088835515081882, 0.02100760117173195, -0.0011652855901047587, -0.009354744106531143, 0.01728128269314766, -0.012977192178368568, -0.047728024423122406, -0.004401468671858311, 0.0078551284968853, 0.02469496801495552, -0.002945673419162631, 0.005401212722063065, 0.010756982490420341, -0.039132822304964066, -0.007881096564233303, -0.0046384213492274284, 0.0029765095096081495, 0.01943657547235489, 0.03388741612434387, 0.004612453747540712, 0.01667105033993721, 0.0071410262025892735, 0.016761936247348785, 0.009653368964791298, -0.04121021181344986, 0.012892798520624638, -0.018956178799271584, 0.00949756521731615, 0.03321226313710213, 0.011698299087584019, 0.005608951672911644, 0.01313948817551136, -0.050532497465610504, -0.0070631243288517, 0.04258648306131363, -0.000516101426910609, -0.002979755401611328, 0.02294217050075531, 0.008673100732266903, 0.030667461454868317, 0.0026600323617458344, -0.05811496824026108, 0.021656785160303116, 0.010776457376778126, -0.004200221970677376, -0.02414965257048607, 0.015113008208572865, 0.04095054045319557, -0.005696591455489397, -0.007907063700258732, 0.012120269238948822, 0.021864524111151695, -0.0005481549305841327, -0.014152215793728828, 0.0002308661350980401, -0.015515502542257309, -0.006387972738593817, 0.06523002684116364, -0.0182680431753397, -0.02351345121860504, 0.015138975344598293, -0.03290065377950668, 0.008504313416779041, 0.006254890002310276, -0.018969163298606873, -0.03232937306165695, 0.005096096079796553, -0.019358672201633453, -0.012425385415554047, -0.01195797324180603, 0.018735455349087715, 0.016008881852030754, 0.0004402280319482088, -0.0024198340252041817, 0.027966855093836784, -0.01559340488165617, 0.0022250788751989603, 0.03554932773113251, -0.005725804716348648, 0.0004528059798758477, -0.027135899290442467, -0.011445117183029652, -0.00795899797230959, -0.008406935259699821, 0.021669767796993256, 0.009393695741891861, 0.018501749262213707, 0.0039113350212574005, -0.02783701941370964, -0.019709233194589615, -0.0205791387706995, 0.012308532372117043, 0.03645818307995796, -0.006147774402052164, 0.02609720453619957, 0.009075595065951347, 0.010847868397831917, 0.004128811415284872, 0.006108823232352734, -0.016761936247348785, -0.03926265984773636, -0.040327321738004684, -0.012464337050914764, 0.0182680431753397, -0.0007035533781163394, 0.0029278206638991833, -0.0055407872423529625, 0.0157102569937706, 0.011821644380688667, 0.0065210554748773575, 0.02077389508485794, -0.00045442895498126745, -0.030901167541742325, 0.023072006180882454, 0.05536242946982384, 0.030511656776070595, 0.027577344328165054, -0.039522334933280945, -0.036743827164173126, -0.018943194299936295, -0.012620140798389912, -0.0404311940073967, -0.0174760390073061, -0.03175809234380722, 0.022059278562664986, -0.017943451181054115, -0.011127017438411713, -0.01803433708846569, 0.0050896042957901955, 0.018190141767263412, 0.020695991814136505, 0.007128042634576559, 0.007803194224834442, -0.02646074816584587, 0.01921585202217102, 0.014243101701140404, 0.035964805632829666, -0.005531049333512783, 0.02607123740017414, -0.011159476824104786, -0.010724523104727268, 0.006764499470591545, 0.017592892050743103, 0.017618859186768532, -0.02314990945160389, -0.0166840348392725, 0.05001315101981163, -0.02331869676709175, 0.027369605377316475, 0.009283334016799927, -0.007095583248883486, -0.015827110037207603, -0.03466643765568733, -0.04466387256979942, -0.06491842120885849, -0.006894336082041264, 0.0019037326565012336, -0.03295259177684784, -0.018332961946725845, 0.020150678232312202, 0.01149056013673544, -0.019852053374052048, -0.01569727435708046, -0.042482614517211914, 0.0015799520770087838, 0.03741897642612457, 0.006254890002310276, 0.007478602230548859, -0.01707354374229908, -0.0009258989593945444, -0.010159732773900032, -0.0119644645601511, 0.03484820947051048, -0.02259160950779915, 0.006349021568894386, 0.018319977447390556, -0.0036646449007093906, 0.015801142901182175, -0.02021559700369835, 0.021280258893966675, -0.010354488156735897, -0.022396855056285858, 0.0008350131683982909, -0.006043904926627874, -0.006965746637433767, -0.03232937306165695, -0.013360210694372654, -0.030693428590893745, -0.014178182929754257, 0.036562055349349976, -0.006631416734308004, 0.019916972145438194, 0.03588690236210823, -0.0194235909730196, -0.02472093515098095, -0.008049883879721165, -0.015840094536542892, 0.00021402791026048362, 0.00853677187114954, 0.0012269581202417612, 0.006446399260312319, -0.01510002464056015, 0.006566498428583145, 0.029109420254826546, 0.004534551873803139, 0.04832527041435242, -0.006563252303749323, 0.012990175746381283, 0.024643031880259514, -0.00656974408775568, 0.014359954744577408, -0.014243101701140404, -0.01630750671029091, -0.027499442920088768, -0.013464080169796944, 0.035964805632829666, -9.509534493190586e-08, 0.013217390514910221, -0.013217390514910221, 0.002470145933330059, 0.013671819120645523, 0.041677627712488174, -0.02626599371433258, -0.010250618681311607, 0.004407960921525955, 0.022111214697360992, -0.018112238496541977, 0.010029896162450314, 0.020254546776413918, 0.0049532754346728325, 0.006027675233781338, -0.011899546720087528, -0.01442487258464098, -0.012152728624641895, 0.020150678232312202, -0.006147774402052164, -0.005173997953534126, -0.004833176266402006, -0.015943964943289757, 0.01625557243824005, 0.01590501330792904, -0.0021958656143397093, -0.013152471743524075, -0.008069359697401524, 0.024214571341872215, 0.006154266186058521, -0.00342769268900156, 0.009257366880774498, -0.004398223012685776, 0.024604082107543945, 0.009887075051665306, -0.004664388485252857, 0.029369093477725983, 0.0012918765423819423, 0.0404311940073967, -0.019566411152482033, 0.03625044599175453, -6.725142884533852e-05, -0.0003572541754692793, -0.02077389508485794, -0.01786554977297783, 0.003138805739581585, 0.02412368543446064, 0.006303578615188599, -0.00646587461233139, 0.010062355548143387, 0.009309301152825356, 0.006053642835468054, -0.009315793402493, -0.0016732722287997603, 0.0007680660346522927, -0.0022267017047852278, 0.003137182677164674, 0.01099068857729435, 0.020631074905395508, -0.0019199622329324484, -0.03414708748459816, 0.005436917766928673, 0.0345885343849659, -0.0048948489129543304, -0.04315776750445366, 0.006978730205446482, -0.023227810859680176, 8.911067561712116e-05, 0.009594942443072796, -0.02747347578406334, -0.0180213525891304, -0.003992483019828796, -0.022708462551236153, 0.041262149810791016, 0.007231912110000849, 0.028875714167952538, -0.0242924727499485, 0.010750490240752697, -0.0027184588834643364, -0.03219953551888466, 0.02626599371433258, -0.003297855844721198, 0.008114802651107311, -0.004414452705532312, -0.020864780992269516, -0.008458870463073254, 0.01787853240966797, 0.023889979347586632, 0.01038694754242897, -0.007627914194017649, 0.01841086335480213, -0.035004012286663055, 0.017761679366230965, -0.022111214697360992, -0.04435226321220398, -0.03666592389345169, 0.0045313057489693165, 0.011633381247520447, -0.03279678523540497, 0.029498931020498276, 0.0404311940073967, 0.020657042041420937, -0.012490304186940193, -0.011127017438411713, 0.012594173662364483, 0.002463654149323702, 0.009581958875060081, -0.01175023429095745, 0.05237618088722229, -0.012496795505285263, -0.0005607328494079411, 0.001128769014030695, 0.02846023626625538, 0.007102075032889843, 0.007965490221977234, 0.019319722428917885, 0.025227298960089684, -0.020695991814136505, -0.008595198392868042, -0.016593148931860924, -0.01049081701785326, 0.012100793421268463, 0.0019053556025028229, 0.006881352514028549, -0.004700093530118465, -0.005686853546649218, 0.014970188029110432, 0.018203124403953552, -0.005845903884619474, -0.011289313435554504, -0.004407960921525955, 0.014450840651988983, 0.006598957348614931, -0.009445630013942719, -0.013197914697229862, -0.043287601321935654, -0.026317927986383438, -0.016606131568551064, -0.0023922438267618418, -0.016346458345651627, 0.008166736923158169, -0.015632355585694313, 0.006254890002310276, 0.020553171634674072, 0.01865755394101143, 0.01216571219265461, 0.013087553903460503, -0.016826855018734932, 0.02905748412013054, -0.006598957348614931, -0.009309301152825356, -0.010257109999656677, -0.025642776861786842, -0.021254291757941246, -0.004988980479538441, -0.014256085269153118, -0.014905269257724285, -0.01313948817551136, 0.00952353235334158, -0.015736225992441177, 0.033238232135772705, 0.02139711193740368, 0.019916972145438194, -0.009659861214458942, 0.002885623835027218, 0.01645032688975334, -0.017579907551407814, 0.02390296198427677, -0.0050084562972188, 0.00960792601108551, -0.012568206526339054, 0.027577344328165054, 0.01943657547235489, 0.031134873628616333, -0.006770991254597902, -0.002710344037041068, 0.008595198392868042, 0.05001315101981163, 0.0033335608895868063, 0.023383615538477898, -0.00911454576998949, -0.012672076001763344, -0.006517809350043535, -0.00923139974474907, -0.021228322759270668, 0.007277355063706636, 0.04139198362827301, -0.026447763666510582, 0.010977705009281635, -0.028901681303977966, 0.0038334326818585396, -0.003083624877035618, 0.004122319631278515, -0.007115059066563845, 0.04759818688035011, -0.002791492035612464, -0.006400956306606531, 0.018008369952440262, 0.010841376148164272, -0.026369862258434296, 0.0078551284968853, -0.015177926979959011, -0.002165029291063547, -0.012198171578347683, -0.001366532756946981, 0.004797471221536398, -0.01109455805271864, -0.023020071908831596, -0.02217613160610199, -0.022487740963697433, -0.034017253667116165, -0.007731783669441938, 0.03526368737220764, 0.012983684428036213, 0.011269837617874146, -0.03367967531085014, -0.03648415207862854, -0.013983427546918392, -0.051908768713474274, -0.01107508223503828, -0.00018755337805487216, 0.0074526346288621426, -0.018943194299936295, 0.007550012320280075, -0.03121277689933777, -0.005975740496069193, 0.0050896042957901955, 0.028018789365887642, 0.020670024678111076, 0.007965490221977234]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
" For a given context, once (Q, K, V )are computed,
QKTor attention map is computed for A. Although only
the lower triangular part of QKTis needed due to the
causality, the entire QKTis commonly computed via dense
matrix-matrix multiplication first, then a mask is added
in general (HuggingFace-Transformers), because no good
mapping to BLAS-L3 exists or writing a custom kernel is
expensive (NVidia-cuBLAS).
One SOTA way to enable parallel inference for LLM (e.g.,
GPT-3, Llama, and BLOOM), would be to utilize tensor and
sequence parallelizations (Li et al., 2023; Patel et al., 2023;
Shoeybi et al., 2020; Korthikanti et al., 2022), Tensor/se-
quence parallelization or TSP in Fig. 4 where the focus is
on parallelizing the single process behavior from Fig. 1 (b).
In TSP, for a given evenly partitioned context, (Q, K, V )
are independently computed on each process as in Fig. 4
(a). Then, the collective operation all-gather is performed
to exchange KandVto all processes so that QKTcan be
evenly distributed as shown in Fig. 4 (b). Although TSP
faithfully follows the single process case in Fig. 1 (b), it
does not take advantage of the causality in LLM inference.
In our KV-Runahead, we start with a given yet unevenly
partitioned context, and (Q, K, V )are independently com-
puted on each process as in Fig. 5 (a). Thus, each process
computes a different number of entries in (Q, K, V ). Then,
KV-Runahead simply populates the KV-cache from each
process and hands over to the next process in chain, mim-
icking the extension phase in Fig. 1 (a). As a result, only the
last process will have the full (K, V), but still each process
can output the Ain the same shape as Q, driving the next
layer. Since KV-cache itself is built upon the causality, KV-
Runahead can automatically minimize the computation of
the upper triangle and reduce the number of dot-products forQKT. For example, 27 dot-products are needed on all the
processes in TSP as in Fig. 4 (b), but KV-Runahead requires
21 (max out of {p0: 16, p1: 21, p2: 18}) as in Fig. 5 (b).
This also highlights the motivation behind uneven context
partitioning to minimize the largest QKTcomputation.
KV-Runahead also removes the global synchronization
points and reduces the total traffic volume exchanged among
processes. All-gather operations in Fig. 4 (b) force all the
processes to stop and secure the full (K, V)(Thakur et al.,
2005), while KV-Runahead shares only the local KV-cache
with the next process via point-to-point send operations. As
a result, TSP in Fig. 4 (a) requires to share 36 (K, V)en-
tries to get to the state in Fig. 4 (b), but KV-Runahead only
needs 22 to transit to Fig. 5 (b). Such a dependency chain
from KV-cache introduces a longer wait time for the later
processes, but KV-Runahead can outperform TSP even with
such overheads.
In theory, with a sufficient number of parallel processes and
a sufficiently long user context (i.e., QKTdominates the
runtime), KV-Runahead can offer up to 2 ×speed up over
TSP, because both total QKTcomputation and network
traffic among processes in KV-Runahead are half of those
in TSP. It could be possible to handcraft a custom/expensive
BLAS kernel for TSP to avoid over-computation. Even
with a tailored custom kernel, however, the communication
involved in TSP remains suboptimal as it still uses All-
gather to exchange (K, V) The proposed KV-Runahead
avoids both over-computation and wasted network traffic
seamlessly, by dual-purposing the LLM-specific KV-cache
scheme (which already exists for the extension phase).
Additionally, the same computational savings achieved with
the custom GPU kernel, can also be applied to KVR. From
Fig 5 (b), we can still see some wasted computation. Hence,
a custom kernel would save such waste to","[-0.032198961824178696, -0.012921582907438278, 0.040346696972846985, -0.005214831791818142, 0.011437631212174892, -0.022791264578700066, 0.03435489162802696, 0.028111092746257782, -0.0218672938644886, 0.03900274261832237, 0.02042534202337265, 0.06310996413230896, 0.003699380671605468, 0.01170362252742052, -0.007727750577032566, -0.04110267385840416, 0.008007741533219814, -0.041438665241003036, -0.010723654180765152, -0.019641365855932236, -0.024317216128110886, -0.032170962542295456, 0.006453791633248329, 0.05790213122963905, -0.010471662506461143, -0.03270294517278671, -0.014349536970257759, 0.011815618723630905, 0.00933769904077053, -0.05359027162194252, 0.0024306715931743383, -0.02391122840344906, -0.07834147661924362, -0.060814037919044495, 0.02503119222819805, 0.07156569510698318, 0.0008898462983779609, 0.02062133513391018, -0.01706545054912567, 0.05482223257422447, 0.03950672596693039, -0.03527886047959328, -0.09228502213954926, 0.009022708982229233, 0.014391535893082619, -0.0009799683466553688, -0.01902538724243641, -0.02540918067097664, -0.054626237601041794, 0.03505486994981766, 0.051014356315135956, -0.0016536966431885958, -0.05711815878748894, 0.02382723242044449, -0.03611883521080017, -0.02042534202337265, 0.032422956079244614, -0.041466664522886276, 0.03931073099374771, -0.0027684106025844812, 0.02188129350543022, -0.04107467457652092, 0.01485352125018835, -0.02035534381866455, -0.011220637708902359, 0.01485352125018835, 0.008756717666983604, 0.005347827449440956, -0.014951517805457115, 0.02064933441579342, -0.05151833966374397, 0.029119061306118965, 0.014433534815907478, 0.004721347708255053, 0.015595496632158756, 0.02659914270043373, 0.033850908279418945, 0.028951065614819527, 0.07352562993764877, 0.010632657445967197, 0.046506501734256744, -0.032282959669828415, 0.06736582517623901, 0.013845553621649742, 0.0056803165934979916, -0.06714183837175369, -0.026109157130122185, -0.0007345388294197619, -0.055970195680856705, -0.019277378916740417, -0.004777345806360245, 0.06143001839518547, 0.013488564640283585, 0.03530685976147652, 0.05840611457824707, 0.026221154257655144, 0.019823361188173294, -0.05398225784301758, 0.021727299317717552, 0.04843843728303909, 0.010681655257940292, -0.016267474740743637, 0.0061388020403683186, -0.03455088660120964, 0.08461327105760574, -0.012179607525467873, -0.022679269313812256, 0.030407018959522247, 0.001319457427598536, -0.006107302848249674, -0.04230663552880287, -0.010380664840340614, -0.019879359751939774, 0.041438665241003036, -0.008161736652255058, -0.07458959519863129, -0.04426657408475876, -0.021027320995926857, 0.00754575664177537, -0.004717847798019648, 0.006803780794143677, 0.019753362983465195, 0.01341156754642725, -0.00030186527874320745, -0.019921356812119484, -0.04902641847729683, 0.0341029018163681, -0.06450992077589035, 0.011542627587914467, -0.02669713832437992, 0.01579149067401886, 0.0007826622459106147, 0.04418257623910904, 0.0005717940512113273, 0.0038183769211173058, -0.00551582220941782, -0.04281061887741089, 0.03925473242998123, 0.007587755098938942, 0.01887139119207859, -0.04569452628493309, 0.004150866065174341, 0.009925680235028267, 0.021349310874938965, -0.037014804780483246, 0.036818813532590866, -0.0297070425003767, 0.007370762061327696, -0.020873326808214188, -0.002255677245557308, -0.03261894732713699, -0.014909518882632256, -0.009974678047001362, -0.014587529934942722, -0.011164640076458454, -0.03261894732713699, -0.044798556715250015, 0.0379667766392231, 0.008238734677433968, -0.020075352862477303, -0.031022999435663223, -0.036986805498600006, 0.06770181655883789, -0.010002677328884602, -0.01885739155113697, -0.016687462106347084, -0.0345228873193264, -0.008392729796469212, -0.0795174390077591, -0.05107035115361214, 0.005155333783477545, -0.04213863983750343, -0.05795812979340553, 0.024457210674881935, 0.027397116646170616, -0.016659462824463844, -0.041774652898311615, 0.00786774605512619, 0.012046611867845058, -0.05521421879529953, -0.03956272453069687, 0.027873100712895393, 0.03303893283009529, 0.022623270750045776, -0.059302087873220444, 0.010758653283119202, 0.005673317238688469, 0.015441502444446087, -0.05171433091163635, 0.028783071786165237, -0.0038568757008761168, 0.03491487354040146, 0.037014804780483246, 0.04395858198404312, 0.019389374181628227, -0.006975274998694658, 0.007580755744129419, 0.029539046809077263, 0.003041401971131563, 0.010611657984554768, 0.03606283664703369, -0.013957549817860126, 0.02221728302538395, -0.05734214931726456, 0.022413277998566628, -0.026067160069942474, 0.02707512676715851, 0.005725815426558256, -0.021027320995926857, -0.02973504178225994, 0.006985774729400873, -0.01245959848165512, 0.031078997999429703, 0.03765878453850746, 0.010891648940742016, -0.02867107465863228, -0.06624586135149002, 0.030491016805171967, -0.016491468995809555, 0.02676713652908802, 0.016561465337872505, 0.04460256174206734, -0.023169253021478653, 0.013817554339766502, -0.032282959669828415, 0.033738911151885986, 0.016127480193972588, -0.05163033306598663, 0.027915099635720253, -0.006271797697991133, 0.012921582907438278, -0.004941840656101704, -0.004483355209231377, -0.03449488803744316, 0.01742943748831749, -0.08595722913742065, -0.005732815247029066, -0.04779445752501488, -0.0019284378504380584, -0.0717896819114685, -0.023141253739595413, 0.005697816144675016, 0.01105264388024807, -0.010499661788344383, -0.015609496273100376, 0.01717744581401348, -0.021559305489063263, -0.029007064178586006, 0.010877649299800396, 0.022329280152916908, -0.005855311173945665, -0.014979517087340355, -0.07778149098157883, -0.026165155693888664, -0.04734647274017334, -0.005050336942076683, -0.001158462604507804, 0.008847714401781559, -0.014643527567386627, 0.0034158898051828146, -0.0035733848344534636, -0.02052333764731884, -0.013040579855442047, 0.008490726351737976, -0.010534659959375858, 0.008490726351737976, 0.04292261600494385, 0.00784674659371376, 0.009743685834109783, -0.021181317046284676, 0.0657418817281723, -0.00954069197177887, 0.0006487915525212884, -0.037154801189899445, -0.023071255534887314, -0.02500319294631481, 0.016925454139709473, -0.009631689637899399, -0.0014883270487189293, -0.01705145090818405, -0.012788587249815464, 0.01884339191019535, 0.07324563711881638, -0.009141704998910427, 0.0011400881921872497, -0.008805716410279274, -0.0013080828357487917, 0.04286661744117737, 0.004528854042291641, -0.0687657818198204, 0.031162995845079422, 0.00391637347638607, 0.014601528644561768, 0.0317789763212204, 0.037014804780483246, 0.03007102943956852, -0.037042804062366486, -0.00336514157243073, -0.011080642230808735, -0.03158298134803772, 0.02190929278731346, 0.01032466720789671, 0.020929325371980667, 0.021377310156822205, -0.016995452344417572, 0.02052333764731884, 0.01752743497490883, -0.006460791453719139, -0.0570901595056057, 0.02526918426156044, -0.018129415810108185, 0.026123156771063805, -0.0320589654147625, 0.030463017523288727, -0.020131351426243782, -0.04911041632294655, 0.03317892923951149, -0.046338506042957306, 0.03751879185438156, -0.02379923313856125, 0.009036708623170853, -0.09844482690095901, -0.011570626869797707, 0.007048772647976875, 0.047906454652547836, -6.458385178120807e-05, -0.0134465666487813, 0.009274700656533241, 0.0038568757008761168, 0.006614786572754383, -0.002659914316609502, 0.03443888947367668, 0.017765427008271217, -0.029567046090960503, -0.06003006547689438, -0.012767587788403034, -0.003545385552570224, -0.011584626510739326, 0.015497500076889992, 0.0156794935464859, -0.09816483408212662, -0.017695428803563118, -0.0044938549399375916, -0.012802586890757084, 0.0006417917902581394, 0.08433327823877335, 0.022525273263454437, -0.03284294158220291, 0.03189096972346306, 0.04227863624691963, 0.024583207443356514, -0.02825108915567398, 0.027495114132761955, -0.007013774011284113, 0.02192329242825508, -0.008476726710796356, 0.011640624143183231, -0.03309493139386177, -0.024975193664431572, -0.004150866065174341, -0.011262636631727219, 0.0002988028572872281, 0.008154736831784248, -0.002722912235185504, 0.002603915985673666, 0.04379058629274368, -0.0348028764128685, 0.024667205289006233, 0.007349763065576553, 0.0075667561031877995, 0.03936672955751419, 0.029483048245310783, 0.021601302549242973, -0.0506223663687706, -0.05056636780500412, -0.027621109038591385, 0.009988677687942982, 0.04594651982188225, 0.027649108320474625, 0.04698248580098152, 0.02179729752242565, 0.02384123019874096, 0.0031078997999429703, 0.00864472147077322, 0.03001503273844719, -0.014013548381626606, 0.016925454139709473, -0.032310958951711655, -0.06842979043722153, 0.00028764698072336614, -0.010128673166036606, 0.00021032134827692062, -0.01171762216836214, 0.04093467816710472, 0.00956869125366211, 0.013964549638330936, -0.0008758467738516629, -0.0023221750743687153, 0.03474687784910202, 0.04880242794752121, 0.012207605876028538, 0.014545531012117863, -0.07268565893173218, -0.04888642206788063, 0.02998703345656395, -0.011395632289350033, 0.02074733003973961, -6.0865226259920746e-05, 0.02357523888349533, 0.015525499358773232, 0.06551788747310638, -0.01485352125018835, 0.029091062024235725, -0.06193400174379349, 0.049502402544021606, -0.01033166702836752, 0.015021516010165215, 0.016953453421592712, -0.02654314413666725, 0.0687657818198204, -0.032254960387945175, 0.0044938549399375916, -0.03945072740316391, -0.03614683449268341, -0.027215123176574707, -0.0014025797136127949, 0.01565149612724781, -0.05000638589262962, 0.02829308807849884, -0.04115867242217064, -0.00636629480868578, 0.033738911151885986, 0.024681204929947853, 0.03917073830962181, -0.029035063460469246, -0.006541288923472166, 0.0048018451780080795, 0.014671526849269867, -0.021503306925296783, 0.002747411374002695, 0.017891423776745796, -0.02829308807849884, -0.016071481630206108, 0.014629527926445007, -0.05093035846948624, 0.01028266828507185, -0.016729461029171944, -0.01432853750884533, 0.026263153180480003, -0.012550595216453075, 0.014769523404538631, 0.04278261959552765, 0.03922673314809799, 0.01898338831961155, 0.002273176796734333, -0.05664217472076416, 0.06898977607488632, 0.009274700656533241, 0.02858707867562771, 0.02046733908355236, 0.019641365855932236, 0.013915550895035267, -0.04925041273236275, -0.0019424373749643564, 0.03303893283009529, 0.018605399876832962, 0.06103803217411041, 0.010436663404107094, 0.014713525772094727, 0.018157415091991425, 0.04068268835544586, -0.01913738250732422, 0.0207053329795599, -0.030911002308130264, -0.06775781512260437, -0.010205671191215515, 0.009085707366466522, -0.01565149612724781, 0.004248863086104393, 0.030127028003335, 0.030687009915709496, -0.015511499717831612, 0.004661849699914455, 0.03169497847557068, 0.020915325731039047, 0.041802652180194855, 0.037238799035549164, 0.005729315336793661, 0.00432236073538661, -0.0013667058665305376, -0.026277152821421623, -0.018269410356879234, 0.04754246771335602, -0.016099480912089348, 0.009841682389378548, 0.022413277998566628, -0.02076132968068123, 0.02370123565196991, 0.01752743497490883, -0.009463694877922535, 0.032506950199604034, 0.013313570991158485, 0.003435139311477542, -0.003877874929457903, 0.0350828692317009, 0.03340292349457741, 0.051126349717378616, 0.009848682209849358, -0.00858872290700674, 0.005295329261571169, -0.024905197322368622, -0.022623270750045776, 0.0254511795938015, 0.024079224094748497, -0.0005201707244850695, 0.035558853298425674, -0.022833263501524925, 0.027663107961416245, 0.015021516010165215, -0.0031096497550606728, -0.03651082143187523, -0.003905873978510499, -0.03628683090209961, -0.013257572427392006, 0.030379019677639008, -0.014685526490211487, -0.022469274699687958, -0.09586890786886215, -0.03575484827160835, -0.045022547245025635, 0.027887100353837013, -0.0050363377667963505, -0.014713525772094727, -0.004836843814700842, -0.006765281781554222, -0.004525354132056236, 0.01194861438125372, -0.03018302656710148, -0.020089352503418922, 0.009477694518864155, 0.016323473304510117, 0.017933420836925507, 0.01264159195125103, 0.03729479759931564, -0.009274700656533241, -0.025829166173934937, 0.06562988460063934, -0.03337492421269417, -0.0026231654919683933, 0.004927841015160084, 0.014657527208328247, -0.010387664660811424, 0.016673462465405464, -0.00861672218888998, -0.021293314173817635, -0.0025951662100851536, -0.01101064495742321, 0.013579562306404114, 0.013789555057883263, -0.027649108320474625, 0.015287507325410843, 0.032142963260412216, 0.006173800677061081, -0.0411306731402874, -0.000500921334605664, 0.026305152103304863, 0.018381407484412193, -0.007755749858915806, -0.005358327180147171, 0.03001503273844719, 0.0015828239265829325, 0.003846375970169902, -0.003067651065066457, -0.007447759620845318, 0.049614399671554565, -0.026039160788059235, 0.008224735036492348, -0.0044168573804199696, -0.013768555596470833, 0.013180575333535671, -0.04533053934574127, -0.012039612047374249, -0.033878907561302185, -0.007748750038444996, -0.004262862727046013, 0.012158608064055443, -0.019907357171177864, 0.017079448327422142, -0.009995677508413792, 0.014825521968305111, 0.0190533846616745, -0.016421470791101456, 0.040094707161188126, 0.015469500795006752, -0.012312603183090687, 0.015497500076889992, -0.0035978839732706547, -0.016169479116797447, -0.019725363701581955, -0.02354724146425724, -0.010576658882200718, -0.015161511488258839, 0.00790974497795105, -0.03760278597474098, -0.04561052843928337, 0.031162995845079422, -0.008322731591761112, 0.02339324541389942, 0.04911041632294655, -0.022525273263454437, 0.044658560305833817, -0.01916538178920746, -0.022343279793858528, -0.008679719641804695, -0.037126801908016205, -0.013747557066380978, -0.01742943748831749, -0.016253475099802017, 0.036902811378240585, -0.01593148708343506, 0.02185329608619213, -0.01713544689118862, 0.006947276182472706, -0.029035063460469246, 0.008126737549901009, 0.016841456294059753, 0.010513660497963428, -0.02211928740143776, -0.024331215769052505, 0.010807651095092297, -0.01265559159219265, 0.00954069197177887, 0.01340456772595644, 0.030715009197592735, -0.013278571888804436, 0.011892616748809814, 0.013684558682143688, -0.002778910333290696, 0.0316389799118042, 0.0004996088682673872, -0.009715686552226543, 0.019683364778757095, -0.002901406493037939, -0.024709202349185944, 0.02204928919672966, 0.01177362073212862, -0.01590348780155182, 0.04899841919541359, 0.004546353593468666, -0.041830651462078094, -0.02860107831656933, -0.028727073222398758, 0.04743047058582306, 0.03317892923951149, 0.026319151744246483, -0.00548782292753458, 0.002603915985673666, -0.038470759987831116, 0.007580755744129419, -0.011913616210222244, -0.017093447968363762, -0.019473372027277946, -0.03917073830962181, -0.009925680235028267, 0.0030361521057784557, 0.0013955800095573068, 0.014020548202097416, 0.0025461679324507713, 0.0016773209208622575, -0.003130648983642459, -0.01503551471978426, 0.026473145931959152, 0.03348692134022713, -0.008210735395550728, 0.01752743497490883, 0.009064707905054092, -0.03340292349457741, -0.01913738250732422, -0.007510758005082607, 0.03197496756911278, -0.012998580932617188, -0.02976304106414318, -0.03009902872145176, 0.03653882071375847, 0.00376237859018147, 0.029091062024235725, 3.2127870781550882e-06, 0.0006907902425155044, 0.020229347050189972, -0.036986805498600006, -0.004458856303244829, 0.013768555596470833, 0.025857165455818176, -0.017989419400691986, -0.011388632468879223, 0.0032898939680308104, -0.0077207512222230434, 0.006828279700130224, -0.03729479759931564, -0.03992671146988869, 0.0010779652511700988, -0.0026721637696027756, -0.028979064896702766, -0.007153769489377737, -0.034186895936727524, -0.044882550835609436, 0.011409631930291653, 0.03592284023761749, 0.03446688875555992, -0.02507319115102291, -0.004668849520385265, -0.008371730335056782, -0.013096577487885952, -0.014559530653059483, -0.01917938143014908, -0.009771685115993023, -0.011402632109820843, 0.0014962017303332686, -0.006114302668720484, -0.016267474740743637, -0.0150635140016675, 0.009253701195120811, -0.025619173422455788, -0.011360633186995983, 0.0015723243122920394, -0.010569659061729908, -0.0441545769572258, 0.03449488803744316, 0.04093467816710472, 0.049558401107788086, 0.03835876286029816, 0.013005580753087997, -0.008119737729430199, -0.0343828909099102, -0.009463694877922535, 0.0022294281516224146, -0.040430694818496704, -0.03530685976147652, -0.02535318210721016, -0.0031918969471007586, -0.016897454857826233, -0.04927841201424599, -0.012305603362619877, 0.04292261600494385, 0.012235605157911777, -0.016645463183522224, 0.016575464978814125, -0.021643301472067833, -0.00952669233083725, -0.001842690515331924, -0.015301506966352463, 0.01411154493689537, 0.004906841553747654, -0.005225331522524357, 0.02699112892150879, -0.01915138214826584, 0.019389374181628227, -0.007685752119868994, 0.009925680235028267, -0.02202128991484642, 0.022693268954753876, -0.0021454307716339827, 0.0009204703383147717, 0.00858172308653593, 0.014377536252140999, 0.018269410356879234, -0.007671752478927374, -0.013824554160237312, 0.019333375617861748, 0.008035740815103054, 0.019249379634857178, -0.0036363827530294657, -0.007237766403704882, 0.01412554457783699, 0.02228728123009205, -0.03365491330623627, -0.009491694159805775, -0.03491487354040146, 0.04194264858961105, 0.014391535893082619, -0.00786774605512619, -0.006467791274189949, -0.032534949481487274, -0.0316389799118042, -0.011241637170314789, -0.013607561588287354, -0.0031901472248136997, 0.005596319679170847, -0.009015709161758423, -0.022469274699687958, -0.011794619262218475, -0.0206353347748518, -0.01335556898266077, 0.011626625433564186, -0.02066333405673504, 0.030883004888892174, -0.004521854221820831, -0.10281268507242203, -0.013894552364945412, 0.030631011351943016, 0.0003055839042644948, 0.016589464619755745, 0.010016676969826221, -0.005722315516322851, 0.001661571441218257, 0.035222865641117096, -0.0027456614188849926, -0.010919648222625256, -0.01196961384266615, -0.009967678226530552, -0.013264572247862816, -0.013873552903532982, -0.037042804062366486, -0.005932308733463287, 0.006100303493440151, -0.0010709654306992888, -0.04589052125811577, -0.022497273981571198, -0.010653655976057053, 0.004990838933736086, 0.018185414373874664, -0.017863424494862556, -0.02540918067097664, 0.016365472227334976, -0.02364523708820343, -0.02374323457479477, 0.008952711708843708, -0.0005682941991835833, -0.014559530653059483, -0.016113480553030968, 0.036846812814474106, -0.03911473974585533, -0.007265765685588121, -0.002220678376033902, 0.009064707905054092, 0.03275894373655319, 0.0017849424621090293, -0.03897474333643913, -0.057622142136096954, 0.01735943928360939, -0.01908138394355774, 0.021503306925296783, -0.038498759269714355, 0.03208696469664574, 0.00795174390077591, 0.01339756790548563, 0.01891339011490345, 0.023001257330179214, -0.02529718354344368, -0.008385729975998402, 0.016813457012176514, 0.011227637529373169, 0.00034823876922018826, -0.029567046090960503, -0.008679719641804695, -0.016715461388230324, 0.024905197322368622, 0.0019844360649585724, 0.00793774425983429, 0.037266798317432404, -0.02343524433672428, -0.033738911151885986, -0.030239025130867958, 0.020901326090097427, 0.049978386610746384, 0.009456695057451725, 0.0035698849242180586, -0.005081836134195328, 0.014433534815907478, 0.016351472586393356, -0.003884874749928713, 0.04885842278599739, 0.035586852580308914, -0.02535318210721016, 0.014937518164515495, -0.060814037919044495, 0.0190533846616745, 0.02836308442056179, -0.049670398235321045, 0.0444345660507679, 0.037070803344249725, 0.03292693942785263, -0.022553272545337677, 0.05157433822751045, -0.025969162583351135, -0.030575014650821686, -0.008238734677433968, 0.022763265296816826, -0.035502854734659195, 0.033794909715652466, -0.01195561420172453, 0.012347601354122162, 0.03569884970784187, 0.020985323935747147, 0.014020548202097416, -0.01027566846460104, 0.0004252362996339798, 0.01566549390554428, 0.015413503162562847, 0.0029696542769670486, -0.06338995695114136, -0.03665081784129143, 0.011430631391704082, 0.021181317046284676, -0.0013728307094424963, 0.048214446753263474, -0.033906906843185425, 0.006086303852498531, -0.009281700477004051, -0.03334692493081093, 0.029539046809077263, -0.015217509120702744, 0.02854507975280285, -0.002217178465798497, -0.010198671370744705, -0.0002134931128239259, -0.03138698637485504, 0.010023676790297031, 0.022791264578700066, -0.01034566666930914, -0.015469500795006752, -0.010366666130721569, -0.00670928368344903, -0.0007682252326048911, 0.035334859043359756, -0.004402858205139637, 0.013754555955529213, -0.027411116287112236, 0.0046513499692082405, 0.00376937841065228, 0.00037951901322230697, -0.011325635015964508, 0.006593787577003241, -0.012844585813581944, 0.002239927649497986, -0.0018129415111616254, 0.03298293799161911, -0.004122867248952389, -0.01433553732931614, 0.041718654334545135, 0.011388632468879223, -0.0035873842425644398, 0.016351472586393356, 0.004588352050632238, -0.01915138214826584, -0.00754575664177537, 0.0013448316603899002, 0.012578594498336315, -0.015203509479761124, 0.025787169113755226, 0.02816709131002426, -0.005785313434898853, 0.0032163963187485933, -0.01604348234832287, -0.010023676790297031, 0.015385503880679607, 0.04622650891542435, -0.0346628837287426, 0.027901099994778633, -0.02382723242044449, 0.011472630314528942, 0.01706545054912567, 0.004392358474433422, -0.002269676886498928, -0.004997838754206896, -0.004630350507795811, 0.020159350708127022, -0.0037448792718350887, -0.031078997999429703, 0.020103352144360542, 0.016393471509218216, 0.07027773559093475, 0.029651043936610222, -0.018423406407237053, -0.03749079257249832, 0.0008259733440354466, 0.031050998717546463, -0.01094764657318592, 0.044938549399375916, -0.021517306566238403, -0.012018612585961819, 0.00788174569606781, -0.019795361906290054, 0.01728944294154644, 0.019977355375885963, -0.010779652744531631, -0.0063802944496273994, 0.02224528230726719, 0.017905423417687416, -0.01271159015595913, 0.010037676431238651, -0.01025466900318861, 0.0034963872749358416, 0.021041320636868477, 0.026305152103304863, -0.03446688875555992, -0.0015679494244977832, -0.03760278597474098, 0.042054641991853714, -0.0031253991182893515, -0.03287094086408615, -0.02701912820339203, 0.05109835043549538, -0.03578284755349159, -0.030939001590013504, -0.00511683477088809, -0.000357863464159891, 0.006558788474649191, 0.00789574533700943, -0.03320692852139473, 0.03278694301843643, -0.0012468347558751702, -0.018185414373874664, -0.000546419876627624, -0.03261894732713699, -0.035418856889009476, -0.016813457012176514, -0.050958357751369476, -0.002255677245557308, 0.009673687629401684, -0.021055320277810097, -0.014020548202097416, -0.008175736293196678, 0.015469500795006752, -0.01572149246931076, 0.004938340745866299, 0.017891423776745796, -0.021587302908301353, 0.019823361188173294, 0.008091739378869534, 0.03161098062992096, -0.03959072381258011, 0.01747143641114235, -0.02354724146425724, -0.019193381071090698, -0.026291152462363243, 0.002964404411613941, 0.004290861543267965, -0.0030431519262492657, -0.006562288384884596, -0.010562659241259098, -0.016729461029171944, -0.016183478757739067, 0.03015502728521824, 0.043314602226018906, -0.0013238323153927922, 0.009967678226530552, -0.01604348234832287, -0.011885616928339005, 0.033766910433769226, 0.01507751364260912, 0.010716654360294342, 0.0030151528771966696, 0.011108641512691975, 0.0720696747303009, -0.004105367697775364, 0.010051676072180271, -0.019515370950102806, -0.004619850777089596, 0.014461533166468143, -0.008700719103217125, -0.016953453421592712, -0.011542627587914467, -0.003660881891846657, 0.014741524122655392, 0.01594548486173153, 0.02672513760626316, -0.005218331702053547, 0.021307311952114105, -0.004098367877304554, 0.03180697560310364, -0.030547015368938446, 0.005561320576816797, -0.006485290825366974, 0.011269636452198029, 0.011493629775941372, -0.010051676072180271, 0.014391535893082619, 0.0048053450882434845, -0.04852243512868881, 0.009071707725524902, -0.011794619262218475, -0.008385729975998402, -0.05361827090382576, -0.01485352125018835, 0.010023676790297031, -0.005953308194875717, 0.007580755744129419, 0.01171062234789133, 0.0033388922456651926, 0.0034438888542354107, 0.02703312784433365, 0.003435139311477542, -0.008490726351737976, 0.024009225890040398, 0.008224735036492348, -0.04213863983750343, -0.008364730514585972, 0.009421695955097675, 0.012963581830263138, 0.00024367963487748057, 0.029539046809077263, 0.01580549031496048, -0.021475307643413544, -0.006639285944402218, -0.006250798236578703, -0.013663559220731258, 0.010884649120271206, 0.038554757833480835, -0.004479855298995972, 0.021587302908301353, 0.0003924248449038714, 0.005081836134195328, 0.009743685834109783, -0.03665081784129143, 0.0005801062798127532, -0.0034088899847120047, 0.0034088899847120047, 0.01407654583454132, 0.02533918246626854, 3.210052818758413e-05, 0.005400325637310743, -0.0569501630961895, -0.005669817328453064, 0.032226961106061935, -0.022651270031929016, -0.009715686552226543, 0.022427277639508247, 0.027985097840428352, 0.005365327000617981, -0.0032653945963829756, -0.05538221448659897, 0.02048133872449398, 0.004035369958728552, -0.024443211033940315, -0.030883004888892174, 0.01741543784737587, 0.019991355016827583, 0.01747143641114235, 0.013292571529746056, 0.005207831971347332, 0.011822618544101715, 0.009099706076085567, -0.013173575513064861, 0.0021769297309219837, -0.002635414944961667, -0.007153769489377737, 0.06725382804870605, -0.015371504239737988, -0.014629527926445007, 0.006541288923472166, -0.04230663552880287, 0.027985097840428352, 0.016477469354867935, -0.017821425572037697, -0.030407018959522247, 0.029287055134773254, -0.013803554698824883, -0.016141479834914207, 0.0005031087785027921, 0.0028401582967489958, 0.011913616210222244, 0.004861343186348677, -0.010037676431238651, 0.03186297416687012, -0.00786074623465538, -0.03455088660120964, 0.027747105807065964, -0.005599819589406252, -0.0015250758733600378, -0.0050328378565609455, -0.010562659241259098, -0.002509419107809663, 0.0012555845314636827, 0.021139318123459816, 0.02658514305949211, 0.00793074443936348, 0.0077137514017522335, -0.009050708264112473, -0.023253250867128372, -0.014223541133105755, 0.007594754919409752, 0.018395407125353813, -0.009155704639852047, 0.015273507684469223, 0.004115867428481579, -0.009673687629401684, 0.0029609045013785362, 0.011122641153633595, -0.018255410715937614, -0.01868939772248268, -0.024415211752057076, -0.008805716410279274, 0.029623044654726982, -0.004682849161326885, -0.006534289103001356, -0.010499661788344383, 0.012263604439795017, 0.005270829889923334, 0.00395837239921093, 0.02178329788148403, -0.004717847798019648, -0.03914273902773857, 0.018507402390241623, 0.028013097122311592, 0.0069542755372822285, 0.015147511847317219, -0.03959072381258011, -0.05630618333816528, -0.02503119222819805, -0.003947872668504715, -0.04129866883158684, -0.037238799035549164, -0.03620283305644989, 0.01334156934171915, -0.03788277879357338, 0.005134334322065115, -0.01486752089112997, -0.004826344549655914, 0.008007741533219814, 0.008133737370371819, -0.010842650197446346, 0.022469274699687958, -0.015021516010165215, 0.02371523529291153, -0.0029154059011489153, 0.05093035846948624, -0.005977807100862265, 0.016421470791101456, -0.013208573684096336, -0.0038918745703995228, 0.002890906762331724, 0.026263153180480003, 0.017975419759750366, -0.006838779430836439, -0.005333827808499336, 0.04432256892323494, -0.020971324294805527, 0.008434727787971497, 0.010884649120271206, -0.015595496632158756, -0.011843618005514145, -0.031190993264317513, -0.04236263409256935, -0.06143001839518547, -0.003797377459704876, -0.0011147140758112073, -0.012438599020242691, -0.009022708982229233, 0.021559305489063263, 0.008903712965548038, -0.02685113437473774, -0.001563574536703527, -0.03732279688119888, 0.009855682030320168, 0.027761105448007584, -0.0038183769211173058, 0.014727525413036346, -0.01268359087407589, 0.00857472326606512, -0.00037339419941417873, -0.00707327201962471, 0.033822908997535706, -0.02363123744726181, 0.019991355016827583, 0.016099480912089348, 0.0024271716829389334, 0.019781362265348434, -0.01268359087407589, 0.03446688875555992, -0.009246701374650002, -0.021055320277810097, -0.011493629775941372, -0.00395137257874012, -0.005830811802297831, -0.024163220077753067, -0.012949582189321518, -0.030799007043242455, -0.0011925864964723587, 0.03651082143187523, -0.006835279520601034, 0.01503551471978426, 0.031218992546200752, -0.025829166173934937, -0.009596690535545349, 0.020971324294805527, -0.026193154975771904, 0.004609351512044668, 0.004518354311585426, -0.003452638629823923, 0.005624318495392799, -0.02364523708820343, -0.006996274460107088, 0.018563400954008102, -0.008035740815103054, 0.04404257982969284, -0.016351472586393356, -0.004010870587080717, 0.009435695596039295, -0.002523418515920639, 0.001493576797656715, -0.016477469354867935, -0.006037305109202862, -0.014643527567386627, -0.02384123019874096, 0.030239025130867958, 0.004224363714456558, 0.011997613124549389, -0.006919276900589466, 0.0012267103884369135, 0.014601528644561768, 0.04303461313247681, -0.048270441591739655, -0.014181542210280895, 0.007587755098938942, 0.0015390753978863358, -0.02196529135107994, -0.003018652554601431, 0.03189096972346306, 0.004784345626831055, 0.007237766403704882, -0.002435921458527446, 0.019347375258803368, -0.015385503880679607, 0.01727544330060482, -0.02228728123009205, -0.002579416846856475, 0.003692380851134658, -0.016799457371234894, 0.0016493217553943396, 0.002824408933520317, -0.009253701195120811, -0.008021741174161434, -0.022595271468162537, 0.022847263142466545, 0.006649785675108433, 0.00014054233906790614, -0.004770345985889435, -0.018115416169166565, 0.019865360110998154, -0.004987339023500681, -0.010807651095092297, 0.025703171268105507, 0.00858872290700674, 0.03567085042595863, -0.012179607525467873, 0.029035063460469246, 0.01741543784737587, -0.0031113997101783752, -0.022679269313812256, -0.018227411434054375, 0.00377637823112309, 0.027327118441462517, 0.01196961384266615, 0.0022854262497276068, 0.012382600456476212, 0.006261297967284918, 0.018493402749300003, -0.00467234943062067, -0.004091368056833744, 0.00293990527279675, -0.0064502921886742115, 0.004661849699914455, 0.005711815785616636, 0.03359891474246979, 0.007601754739880562, -0.044742558151483536, -0.008385729975998402, 0.026403147727251053, -0.008154736831784248, -0.04451856389641762, 0.0032933938782662153, -0.0253811813890934, 0.004745847079902887, 0.018073417246341705, -0.0319189690053463, -0.029119061306118965, -0.02694912999868393, 0.005246330983936787, 0.03569884970784187, 0.020845327526330948, 0.029315054416656494, -0.021195316687226295, -0.013803554698824883, -0.026347151026129723, -0.029147060588002205, 0.02825108915567398, -0.012515596114099026, -0.004472855944186449, -0.012270604260265827, -0.025759169831871986, 0.0028856568969786167, 0.027593109756708145, 0.02350524254143238, -0.016323473304510117, 0.0029924034606665373, 0.02032734453678131, -0.0249611958861351, 0.02494719624519348, -0.02377123385667801, -0.019935356453061104, -0.011899616569280624, 0.014363536611199379, 0.01264859177172184, -0.03578284755349159, 0.04059869050979614, 0.032478950917720795, 0.019291378557682037, -0.005424825008958578, -0.002199679147452116, -0.00953369215130806, -0.0005757314502261579, 0.015609496273100376, -0.01721944473683834, 0.03975871950387955, -0.029623044654726982, 0.01889939047396183, 0.0013387068174779415, 0.010506661608815193, 0.0009475944680161774, 0.011983613483607769, 0.012970581650733948, 0.027313118800520897, -0.013593561947345734, 0.01028266828507185, 0.0010735903633758426, -0.008084739558398724, 0.003877874929457903, -0.012781587429344654, 0.0009852182120084763, -0.009183703921735287, -0.0032478952780365944, 0.00790974497795105, 0.004196364898234606, 0.0018689397256821394, -0.009652689099311829, 0.011682623066008091, 0.006131802219897509, 0.007139769848436117, 0.003618883201852441, -0.022385278716683388, -0.07061371952295303, -0.006985774729400873, -0.011101641692221165, -0.004556852858513594, -0.016477469354867935, 0.005939308553934097, -0.02035534381866455, 0.011311635375022888, 0.01885739155113697, 0.014062546193599701, 0.016267474740743637, 0.01864739879965782, -0.017611432820558548, 0.030631011351943016, -0.014475532807409763, 0.009029708802700043, 0.00468634907156229, -0.02697712928056717, -0.02041134238243103, 0.015203509479761124, -0.014755523763597012, -0.022357279434800148, -0.006712783593684435, 0.009750685654580593, -0.02662714198231697, 0.043454598635435104, 0.019781362265348434, 0.030603013932704926, 0.013187575154006481, 0.0034788877237588167, 0.006705783773213625, -0.018325408920645714, 0.026109157130122185, -0.019641365855932236, 0.004745847079902887, -0.009666687808930874, 0.024457210674881935, 0.018535401672124863, 0.03505486994981766, 0.0009965928038582206, 0.015133512206375599, 0.0008259733440354466, 0.020201347768306732, 0.004927841015160084, 0.019543370231986046, -0.025647172704339027, -0.018045417964458466, 0.0011322135105729103, 0.00863772165030241, -0.03141498565673828, -0.016141479834914207, 0.02827908843755722, -0.01584748923778534, -0.005428324919193983, -0.01888539083302021, -0.0058798105455935, -0.007041772827506065, 0.008182736113667488, -0.007692751940339804, 0.05991806834936142, 0.002782410243526101, -0.002269676886498928, 0.007986742071807384, -0.0010744653409346938, -0.01416754350066185, 0.00881971511989832, -0.02041134238243103, 0.004927841015160084, -0.00860272254794836, 0.008749717846512794, 0.012032612226903439, -0.00585881108418107, -0.01755543425679207, -0.04157865792512894, -0.002834908664226532, -0.044994547963142395, -0.0009388447506353259, 0.03897474333643913, 0.016589464619755745, 0.01414654403924942, -0.025479178875684738, -0.0253111831843853, 0.0012949582887813449, -0.02377123385667801, -0.005599819589406252, 0.002652914496138692, 0.017597433179616928, -0.024065224453806877, 0.007370762061327696, -0.022511273622512817, -0.01875939592719078, 0.015581497922539711, 0.028979064896702766, 0.015301506966352463, 0.01247359812259674]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
" further enhance
the performance of KVR. Yet, the benefit from a custom
kernel would diminish with more GPUs in parallel, as the
nature of KV-cache allows our technique to approximate
the unmasked lower triangle more accurately with more
processes, as illustrated in Figure 2 (b) and (d).
For simplicity, assume that a user context Cis even parti-
tioned for KV-Runahead and TSP over pprocesses. Then,
the total TSP traffic Nettspcan be written as follows:
Nettsp(C, p) =p(p−1)C
p(4)
= (p−1)C (5)
which is essentially the total number of (K, V)entries from
other processes. The total KV-Runahead traffic Netkvris
5
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
the sum of the total KV-cache put into the network.
Netkvr(C, p) =C
p+2C
p+3C
p+... (6)
=p−1X
i=1iC
p=(p−1)
2C (7)
The 2×reduction is over the total computation and network
traffic, not for each individual process. Therefore, it is
critical to perform load-balancing to maximize the gain over
TSP and minimize TTFT, and KV-Runahead accomplishes
it by context-level load-balancing in Section 4.2.
4.2. Context-Level Load-Balancing
As discussed in Section 3, KV-Runahead needs load-
balancing for low TTFT. We propose running off-line search
for the best partitioning, and then store the results in a par-
titioning lookup table. For example, we pre-compute the
optimal partitioning of user contexts at various lengths for a
given number of processes off-line by measuring TTFT on
the target hardware, and then contribute the search results
to a lookup table. During inference, we can predict the best
partitioning by interpolating the two nearest known entries
in the lookup table. For the example of 10k prompt, we can
interpolate from the known partitioning configurations from
8k and 12k in the lookup table.
Finding the best partitioning configuration for a given user
context, although one-time off-line overhead, can be ex-
pensive. Hence, we propose a hierarchical grid search for
acceleration. From the nature of KV-Runahead, it is straight-
forward to see that finding the TTFT-optimal partitioning
has two conflicting objectives.
•The partitions for the earlier processes must be small,
otherwise the later processes will wait too long for the
earlier ones to populate KV-caches and send them over.
•The partitions for the later processes need to be small,
otherwise the later processes will the bottleneck in
generating the first token.
For two processes, we can use a binary search to find out
the best partitioning. Fig. 6 (a) shows how TTFT changes
as we grow the partition for the p0for a 16k context where
the partitioning is C[0,8192 + δ1,16384] . Asδ1grows, it
bottoms at the partition of [0,9728,16384] (i.e.,δ1= 1536 ,
thusp0takes C[0:9728] and p1takes in C[9728:16384]).
By generalizing the binary search into a hierarchical grid
search for multiple processes (Zhang et al., 2022b), we
can find a high-quality partitioning fast for a given user
context length. Figs. 6 (b-d) depict the proposed search
process for a user context length of 96 over 4 processes,
which is to find the optimal (δ1, δ2)for the partitioning of
(a) 2 partitions
 (b) stride 8
 (c) stride 4
 (d) stride 2
Figure 6. Finding two partitions can be done quickly by binary
search as shown in (a) where δ1is the variable for additional
context the p0. We can extend such binary search into hierarchical
grid search for multiple processes as in (b, c, d) for the example of
C[0,32 + δ1,64 + δ2,96].
(a) Without KV-Runahead.
 (b) With KV-Runahead.
Figure 7. KV-Runahead can be easily implemented in LLM with
existing KV-cache support (e.g., most of public LLMs) by simply
inserting recv/send operations (in","[-0.028274228796362877, 0.013311539776623249, 0.05390116199851036, -0.012110703624784946, 0.02338900975883007, -0.031112568452954292, 0.03676195442676544, 0.04666885361075401, -0.02931131422519684, 0.041456133127212524, 0.02701880969107151, 0.055838871747255325, 0.004834047053009272, 0.010391324758529663, 0.014000656083226204, -0.040883008390665054, 0.01554263848811388, -0.013113674707710743, -0.023129738867282867, 0.001587184495292604, -0.012288100086152554, -0.04688718542456627, 0.012581486254930496, 0.03949112817645073, 0.004359853453934193, -0.03910904377698898, -0.005294594913721085, 0.012683830223977566, 0.0017347304383292794, -0.08804310858249664, 0.013905134983360767, -0.018435562029480934, -0.06790181994438171, -0.058895546942949295, 0.03365070000290871, 0.054092202335596085, -0.007389234844595194, 0.012247162871062756, -0.018844937905669212, 0.0499984435737133, 0.014355448074638844, -0.027346311137080193, -0.0868968591094017, 0.02111015096306801, 0.013352476991713047, 0.006915041245520115, -0.009552104398608208, -0.016961807385087013, -0.053355325013399124, 0.0312490276992321, 0.027114329859614372, 0.0005586275365203619, -0.046395935118198395, 0.007573454175144434, -0.011571692302823067, 0.01610211841762066, 0.02846527099609375, -0.03403278440237045, 0.02775568701326847, 0.022119944915175438, 0.02819235436618328, -0.036379870027303696, 0.012322214432060719, -0.011919661425054073, 0.00257053948007524, 0.01727566309273243, 0.004492900334298611, 0.008562779054045677, 0.011803671717643738, 0.037990082055330276, -0.027974020689725876, 0.016320452094078064, 0.019568167626857758, -0.01780785247683525, 0.016607016324996948, 0.03485153615474701, 0.019431710243225098, 0.01184460986405611, 0.04197467491030693, 0.031440068036317825, 0.0557297058403492, -0.01723472587764263, 0.04156529903411865, 0.012417735531926155, 0.03861779347062111, -0.041592590510845184, -0.021792443469166756, 0.006024648901075125, -0.03146735951304436, -0.02207900770008564, -0.01918608322739601, 0.049179691821336746, 0.008746998384594917, 0.0393819622695446, 0.05916846543550491, 0.004550895653665066, 0.03296840563416481, -0.05057156831026077, 0.025258492678403854, 0.04022800549864769, 0.0012358034728094935, -0.006584129296243191, 0.020209522917866707, -0.04353030398488045, 0.06986682116985321, -0.027073392644524574, -0.0075870999135077, 0.053382616490125656, -0.010500491596758366, -0.012854402884840965, -0.07679891586303711, -0.01966368965804577, -0.017453059554100037, 0.023852968588471413, -0.010841638781130314, -0.05922304838895798, -0.07270515710115433, -0.018230874091386795, -0.003940243273973465, 0.0055299862287938595, -0.013714092783629894, 0.02412588708102703, -0.000393171445466578, -0.01481940783560276, -0.04418530687689781, -0.045959267765283585, 0.0209327545017004, -0.053109701722860336, 0.008180694654583931, 0.0025875968858599663, 0.009975126013159752, 0.028710896149277687, 0.03790820762515068, 0.004318915773183107, -0.024753596633672714, 0.016675245016813278, -0.01677076704800129, 0.028792772442102432, 0.008378559723496437, -0.009818199090659618, -0.04020071402192116, -0.013891489244997501, 0.016811704263091087, 0.014573781751096249, -0.04868844151496887, 0.041346967220306396, -0.021014628931879997, 0.037089455872774124, -0.03223152831196785, -0.018735770136117935, -0.02903839759528637, -0.03861779347062111, -0.003167546121403575, -0.009777260944247246, -0.010868930257856846, -0.009784083813428879, -0.023975782096385956, 0.021396713331341743, 0.0020775827579200268, -0.005338944029062986, -0.04011883959174156, -0.0374988317489624, 0.06773806363344193, -0.0026575319934636354, -0.00660459790378809, -0.017166495323181152, -0.057749293744564056, 0.0025193674955517054, -0.07456099987030029, -0.029584232717752457, 0.02194254845380783, -0.05834971368312836, -0.050325945019721985, 0.015501701273024082, 0.026827767491340637, -0.00976361520588398, -0.047978855669498444, 0.01918608322739601, -0.008985800668597221, -0.0356975793838501, -0.04197467491030693, 0.03924550488591194, 0.025053804740309715, 0.024412449449300766, -0.03897258639335632, 0.019499938935041428, 0.020809940993785858, 0.0040698787197470665, -0.0624980553984642, 0.026131829246878624, 0.012615600600838661, 0.022324632853269577, 0.035206329077482224, 0.03722591698169708, 0.018258165568113327, -0.006921864114701748, 0.024180470034480095, 0.036680079996585846, -0.018844937905669212, 0.0197319183498621, 0.016088472679257393, -0.010254866443574429, -0.002691646572202444, -0.05616637319326401, 0.021055568009614944, -0.04587739333510399, -0.007628037594258785, 0.016716182231903076, -0.004431494046002626, -0.02587255649268627, -0.005693736486136913, 0.026909641921520233, 0.02729172632098198, 0.03340507298707962, 0.00968173984438181, -0.02993902377784252, -0.054829079657793045, 0.03774445876479149, -0.017193788662552834, 0.03283194825053215, 0.01554263848811388, 0.02136942185461521, -0.016156701371073723, 0.012690653093159199, -0.007027619518339634, 0.04762406274676323, 0.009170019999146461, -0.06288013607263565, 0.040746547281742096, 0.0005087348399683833, 0.03269548714160919, 0.013277425430715084, -0.004202926065772772, -0.025162972509860992, 0.007218661718070507, -0.04331197217106819, -0.033486947417259216, -0.04868844151496887, -0.024207761511206627, -0.0694301500916481, -0.047132812440395355, -0.008392206393182278, 0.010091115720570087, 0.005042146425694227, -0.007703090086579323, 0.03108527697622776, -0.018435562029480934, -0.029857149347662926, 0.02931131422519684, 0.005751731339842081, -0.046559687703847885, -0.012206224724650383, -0.06839306652545929, -0.014314510859549046, -0.036952998489141464, -0.004892041906714439, 0.012267631478607655, -0.0016963514499366283, 0.012083412148058414, -0.008091997355222702, -0.021819734945893288, -0.004322327207773924, -0.011837786063551903, 0.009906896390020847, -0.03154923766851425, -0.01566545106470585, 0.019854731857776642, -0.005785846151411533, -0.023702865466475487, -0.05998721718788147, 0.04107404872775078, -0.011892369948327541, 0.0030140301678329706, -0.0206325463950634, 0.005127433221787214, -0.02026410773396492, 0.014341802336275578, -0.008903926238417625, -0.007307359948754311, -0.016020243987441063, -0.0256405770778656, 0.016607016324996948, 0.08585977554321289, -0.006962801795452833, 0.009654448367655277, -0.0040562329813838005, 0.019581813365221024, 0.016593370586633682, 0.029229439795017242, -0.04112863168120384, 0.0020605253521353006, 0.0014379328349605203, 0.015297013334929943, -0.005400350317358971, 0.03182215243577957, 0.06348055601119995, -0.04112863168120384, -0.017794206738471985, -0.006331680808216333, -0.021492235362529755, 0.0400642566382885, 0.040855713188648224, 0.024057656526565552, 0.022119944915175438, -0.006915041245520115, 0.01767139323055744, 0.019499938935041428, 0.012424558401107788, -0.05900471284985542, -0.002417023526504636, -0.027919435873627663, 0.030621318146586418, -0.02846527099609375, 0.03403278440237045, -0.02295234240591526, -0.05092636123299599, 0.05911387875676155, -0.041592590510845184, 0.032040487974882126, -0.026432037353515625, 0.02416682429611683, -0.081329345703125, 0.004008472431451082, 0.026909641921520233, 0.06888432055711746, 0.02205171436071396, -0.00846725795418024, -0.025654222816228867, 0.005949596408754587, -0.016784412786364555, -0.014491907320916653, 0.012827111408114433, 0.017453059554100037, -0.02265213243663311, -0.05130844563245773, -0.030102774500846863, -0.009258718229830265, 0.015433471649885178, 0.03616153821349144, -0.008876633830368519, -0.07150432467460632, -0.011387472972273827, 0.007075380068272352, -0.019718272611498833, 0.01085528451949358, 0.07461558282375336, 0.02389390766620636, -0.0256405770778656, 0.034796953201293945, 0.020782649517059326, 0.011721796356141567, -0.039845921099185944, 0.01932254247367382, -0.019445355981588364, 0.03771716728806496, -0.01798524707555771, 0.0450313501060009, -0.04369405284523964, -0.03703487291932106, -0.002092934213578701, -0.014955866150557995, 0.006345326546579599, 0.042629677802324295, -0.0076485066674649715, 0.008283038623631, 0.007784964982420206, -0.04735114425420761, 0.006045117508620024, 0.006086055189371109, 0.0303483996540308, 0.020018480718135834, 0.022611195221543312, -0.0003596964234020561, -0.044485513120889664, -0.09535729140043259, -0.01174226589500904, 0.017016392201185226, 0.03850862756371498, 0.01939077116549015, 0.040910299867391586, 0.04484030604362488, 0.013836905360221863, 0.008207987062633038, -0.0006494577974081039, 0.007430172525346279, -0.003537690034136176, -0.014082531444728374, 0.003936831373721361, -0.08187518268823624, -0.01929525099694729, -0.02846527099609375, -0.0025500706396996975, 0.031876735389232635, 0.03365070000290871, 0.0025671280454844236, 0.008446789346635342, 0.00919048860669136, 0.006751290988177061, 0.024576200172305107, 0.023907553404569626, -0.006481785327196121, -0.011059972457587719, -0.07057640701532364, -0.021219316869974136, 0.006174753420054913, 0.004073290154337883, -0.0027684045489877462, 0.024480678141117096, 0.05471991375088692, 0.01791701838374138, 0.04634135216474533, -0.012997685000300407, 0.02161504700779915, -0.05392845347523689, 0.05638470873236656, -0.021928902715444565, -0.02749641425907612, 0.043939679861068726, -0.015474408864974976, 0.05736720934510231, -0.036352578550577164, 0.0034524034708738327, -0.051772404462099075, -0.03845404461026192, -0.010138876736164093, 0.0055436319671571255, 0.012561017647385597, -0.0444309301674366, 0.020646192133426666, -0.03965488076210022, -0.0040494101122021675, 0.03094881772994995, 0.05229094997048378, 0.029420481994748116, -0.04530426487326622, -0.006573894526809454, 0.03487882763147354, 0.005031912121921778, 0.008508196100592613, -0.01861295849084854, 0.029092980548739433, -0.036516331136226654, 0.001072905957698822, 0.021683277562260628, -0.03239528089761734, -0.011646744795143604, -0.012990862131118774, 0.0002479709219187498, 0.04211113601922989, -0.015351596288383007, 0.02819235436618328, 0.010739294812083244, 0.032286111265420914, 0.020946400240063667, 0.005287772044539452, -0.05862262845039368, 0.05703970789909363, 0.013482113368809223, 0.01932254247367382, 0.026200057938694954, -0.0020366450771689415, 0.03935467079281807, -0.03051215037703514, 0.01038450188934803, 0.040446337312459946, 0.021792443469166756, 0.034060075879096985, 0.0074574644677340984, 0.02749641425907612, 0.0034438748843967915, 0.04789698123931885, -0.0400642566382885, 0.014437323436141014, -0.024617137387394905, -0.04440363869071007, -0.016552431508898735, 0.005072849802672863, -0.027632873505353928, 0.015406180173158646, -0.007041265722364187, 0.023989427834749222, -0.007703090086579323, 0.03880883380770683, 0.03351423889398575, 0.03395090997219086, 0.07346932590007782, 0.03531549498438835, 0.019568167626857758, 0.015788264572620392, 0.011012211441993713, -0.0419473834335804, 0.009565750136971474, 0.052481990307569504, -0.015952013432979584, -0.024726305156946182, 0.008624185808002949, -0.005434465128928423, 0.023989427834749222, 0.003143665846437216, 0.005591392517089844, 0.03891800343990326, 0.0256405770778656, 0.015392533503472805, -0.006331680808216333, 0.03777175024151802, 0.018258165568113327, 0.05139032006263733, 0.002773521700873971, -0.00541058462113142, 0.02641839161515236, -0.020427856594324112, 0.015065032988786697, 0.01566545106470585, 0.021901611238718033, 0.002282270696014166, 0.03474236652255058, -0.018872229382395744, 0.01277252845466137, 0.013181904330849648, -0.0033688226249068975, -0.026664016768336296, 0.004223394673317671, -0.02903839759528637, -0.014150760136544704, 0.029529647901654243, -0.027742039412260056, -0.04369405284523964, -0.11233274638652802, -0.0278648529201746, -0.03891800343990326, 0.0268823504447937, 0.0026472974568605423, -0.014601074159145355, -0.007068557199090719, -0.011442056857049465, 0.016593370586633682, 0.004400791134685278, -0.019882023334503174, -0.019977543503046036, -0.006870692130178213, -0.0009927365463227034, -0.014682948589324951, -0.010732471942901611, 0.022242756560444832, -0.002949212212115526, -0.03152194619178772, 0.05682137608528137, -0.015378887765109539, 0.004383733496069908, -0.009961480274796486, -0.0011274894932284951, -0.01734389178454876, 0.019172437489032745, -0.004851104225963354, -0.023580051958560944, -0.004486077465116978, 0.010609658434987068, -0.001519808080047369, -0.005925716366618872, -0.009170019999146461, 0.008890279568731785, 0.020796295255422592, 0.0209736917167902, -0.032613612711429596, -0.009347416460514069, 0.010193459689617157, 0.0197319183498621, -0.01137382723391056, -0.009272363968193531, 0.032149653881788254, -0.01118960790336132, 0.008351268246769905, 0.004878396168351173, 0.02070077508687973, 0.03976404666900635, -0.026268286630511284, 0.006877514999359846, -0.0046225362457334995, 0.007600746117532253, 0.007164078298956156, -0.04527697339653969, 0.0009185372036881745, -0.032449863851070404, -0.014423677697777748, 0.010439085774123669, -0.002115108771249652, -0.008617362938821316, 0.008064704947173595, -0.024849116802215576, 0.021669631823897362, 0.01741212233901024, 0.00016012568084988743, 0.04484030604362488, 0.010971274226903915, 0.005840429570525885, 0.032477155327796936, 0.0017432590248063207, -0.02046879567205906, -0.01966368965804577, -0.04696906358003616, 0.0024784300476312637, 5.474336649058387e-05, -0.009504344314336777, -0.03932737931609154, -0.028110478073358536, 0.03558841347694397, -0.010677888058125973, 0.03212236240506172, 0.028683604672551155, -0.007068557199090719, 0.03092152625322342, -0.009067676030099392, -0.03135819360613823, 0.005113787483423948, -0.024248698726296425, -0.01941806450486183, -0.01346164382994175, -0.03747154027223587, 0.03613424673676491, -0.0033654109574854374, 0.03384174033999443, 0.005819960962980986, 0.002092934213578701, -0.01982744038105011, 0.000468650134280324, 2.4200086045311764e-05, 0.013427529484033585, -0.014833053573966026, -0.003046439029276371, 0.016893578693270683, -0.013304716907441616, -0.0017927252920344472, 0.007205015979707241, 0.033759865909814835, -0.011605806648731232, 0.00024882378056645393, 0.050189483910799026, -0.0005492459749802947, 0.02604995295405388, 0.003817430231720209, 0.022461090236902237, 0.04445822164416313, 0.009149551391601562, -0.03861779347062111, 0.030102774500846863, 0.017562225461006165, -0.008194341324269772, 0.056875959038734436, 0.0025603051763027906, -0.03687112405896187, -0.028219645842909813, -0.044485513120889664, 0.04241134226322174, 0.026677662506699562, 0.03662549704313278, -0.004605479072779417, -0.010841638781130314, -0.04137425869703293, 0.0040425872430205345, -0.009108614176511765, -0.014751178212463856, 0.005929127801209688, -0.0265821423381567, -0.01162627525627613, 0.014259926974773407, 0.016716182231903076, 0.03190402686595917, 0.017930664122104645, -0.017098266631364822, 0.009668094106018543, -0.030866943299770355, 0.036407165229320526, 0.03242257237434387, -0.01166039053350687, -0.012083412148058414, 0.00660459790378809, -0.01679805852472782, -0.007293714210391045, -0.010480022989213467, 0.028656313195824623, -0.027482768520712852, -0.015856493264436722, -0.024739950895309448, -0.006826343014836311, 0.00415857695043087, 0.0187494158744812, -0.0019957076292485, 0.0015530698001384735, 0.02678683027625084, -0.041155923157930374, 0.007245953660458326, -0.010016064159572124, 0.032449863851070404, -0.0196909811347723, 0.022242756560444832, 0.029393190518021584, -0.01858566515147686, 0.005755142774432898, -0.018899520859122276, -0.03266819566488266, -0.004776052199304104, 0.019609104841947556, -0.038563210517168045, -0.0016801469027996063, -0.026623079553246498, -0.027837561443448067, -0.007730381563305855, 0.03225881978869438, 0.038999877870082855, -0.044239889830350876, 0.004373499192297459, -0.01647055707871914, -0.011517108418047428, -0.0021338718943297863, -0.03779904171824455, 0.0007675798260606825, -0.00569714792072773, -0.013195550069212914, 0.0027871676720678806, -0.016006598249077797, -0.02026410773396492, 0.009067676030099392, -0.012233516201376915, -0.002940683625638485, 0.00169293989893049, 0.004376910626888275, -0.0337325744330883, 0.02154681831598282, 0.044540099799633026, 0.03354153409600258, 0.05109011381864548, 0.015037741512060165, 0.01401430182158947, -0.010043355636298656, -0.01453284453600645, 0.00659436360001564, -0.041155923157930374, -0.018844937905669212, -0.01767139323055744, 0.007989653386175632, -0.003622976830229163, -0.03673466295003891, -0.006413555704057217, 0.04183821752667427, -0.003998238127678633, -0.02295234240591526, 0.0038481333758682013, -0.020236816257238388, -0.02749641425907612, 0.019513584673404694, -0.013666331768035889, 0.012724767439067364, 0.008733352646231651, -0.023784739896655083, 0.04183821752667427, -0.005707382224500179, 0.004837458487600088, 0.01075294055044651, -0.004898864775896072, -0.019076917320489883, 0.001654560910537839, 0.014314510859549046, -0.0024681955110281706, -0.019281605258584023, 0.037253208458423615, 0.019172437489032745, -0.02772839367389679, -0.029993608593940735, 0.008385383524000645, 0.014328156597912312, 0.0045304265804588795, -0.009381530806422234, 0.0034865180496126413, 0.024480678141117096, 0.031139859929680824, -0.020946400240063667, 0.006123581435531378, -0.009981948882341385, 0.03951841965317726, 0.02329348959028721, -0.02950235642492771, 9.200297063216567e-05, -0.03880883380770683, -0.03744424879550934, -0.018735770136117935, -0.04265696927905083, -0.0006793081411160529, -0.0004287786141503602, -0.01416440587490797, -0.04238405078649521, -0.022338278591632843, -0.01562451384961605, -0.012881695292890072, 0.02637745440006256, -0.014723886735737324, 0.03515174239873886, -0.005700559355318546, -0.10234397649765015, -0.02366192638874054, 0.028847355395555496, 0.02083723433315754, 0.015720034018158913, 0.002253273269161582, 0.017098266631364822, -0.018667541444301605, 0.00041129483724944293, -0.0005091612692922354, -0.017589518800377846, -0.026868704706430435, -0.005014854948967695, -0.018394622951745987, -0.023880260065197945, -0.00020618046983145177, -0.022542966529726982, 0.012724767439067364, 0.00433597294613719, -0.04546801745891571, -0.02547682635486126, -0.02237921580672264, 0.012608777731657028, 0.011326066218316555, -0.039573002606630325, -0.021014628931879997, -0.0006311211618594825, -0.03788091614842415, -0.00023368540860246867, 0.01176273450255394, -0.0005603332538157701, -0.021096505224704742, 0.0020144705194979906, 0.015160554088652134, -0.0350152850151062, -0.00229762215167284, -0.009538458660244942, -0.00788048654794693, 0.01704368367791176, -0.009640802629292011, -0.02641839161515236, -0.04776052013039589, 0.003068613586947322, 0.0028059305623173714, 0.04825177416205406, -0.038699667900800705, 0.0350971594452858, 0.028983814641833305, -0.006737645249813795, 0.02761922776699066, 0.03531549498438835, -0.026936935260891914, 0.0015462469309568405, 0.020591607317328453, 0.017657747492194176, 0.009565750136971474, -0.017589518800377846, -0.00659436360001564, 0.001170985633507371, 0.01996389776468277, 0.008794759400188923, 0.007621214725077152, 0.040009669959545135, -0.02274765446782112, -0.024780888110399246, -0.015747325494885445, 0.018790353089571, 0.040419045835733414, 0.016825350001454353, 0.01445096917450428, -0.012929455377161503, 0.004591832868754864, -0.0012204519007354975, 0.008426320739090443, 0.03919091820716858, 0.020714420825242996, -0.026595788076519966, -0.012185756117105484, -0.0668647289276123, 0.015488054603338242, 0.03498799353837967, -0.04576822742819786, 0.018094414845108986, 0.01737118326127529, 0.029556939378380775, -0.020960045978426933, 0.041155923157930374, -0.026554850861430168, 0.0015692743472754955, -0.03108527697622776, 0.017630456015467644, -0.018872229382395744, 0.020987337455153465, -0.0009236543555743992, -0.006973036099225283, 0.027701102197170258, 0.01824451982975006, 0.015842847526073456, 0.004639593418687582, 0.006710353307425976, 0.03534278646111488, 0.031303610652685165, 0.0025278960820287466, -0.07008515298366547, -0.016020243987441063, -0.00986595917493105, 0.03504257649183273, -0.03315944969654083, 0.02920214831829071, -0.039436545222997665, 0.009497520513832569, 0.007491578813642263, -0.031876735389232635, 0.02917485684156418, -0.02019587717950344, 0.05139032006263733, -0.0013765264302492142, 0.009913720190525055, -0.015788264572620392, -0.043503012508153915, 0.0011761029018089175, 0.02933860570192337, -0.018121706321835518, -0.007280068006366491, -0.033186741173267365, -0.012349506840109825, 0.014205344021320343, 0.024453386664390564, 0.01573367975652218, 0.019172437489032745, -0.030321108177304268, 0.03889071196317673, 0.020073065534234047, 0.01764410175383091, -0.019104208797216415, 0.0011701327748596668, -0.02604995295405388, -0.0039777690544724464, 0.006580717395991087, 0.03733508288860321, 0.01704368367791176, 0.0010916690807789564, 0.04257509484887123, 0.02278859168291092, -0.008160226047039032, 0.036680079996585846, 0.0051820166409015656, -0.008944863453507423, 0.008310331031680107, -0.004025529604405165, 0.001368850702419877, -0.020236816257238388, 0.01438274048268795, 0.009449760429561138, -0.012908986769616604, 0.0290656890720129, 0.008221632800996304, -0.013297894038259983, 0.05259115621447563, 0.05411949381232262, -0.024521617218852043, 0.040746547281742096, -0.010943982750177383, 0.012417735531926155, 0.0500803180038929, -0.004953448195010424, -0.0020895227789878845, -0.005018266383558512, -0.000559053965844214, -0.0016409150557592511, -0.008364913985133171, -0.041155923157930374, 0.040009669959545135, 0.016688890755176544, 0.07363308221101761, 0.030866943299770355, 0.0012827111640945077, -0.023839322850108147, -0.02274765446782112, 0.02332078106701374, 0.0024681955110281706, 0.03138548508286476, -0.030976109206676483, -0.014423677697777748, 0.003960711881518364, -0.020960045978426933, 0.00877428986132145, 0.02194254845380783, -0.004370087757706642, 0.011196430772542953, 0.042493220418691635, 0.031603820621967316, -0.0007347444770857692, 0.03687112405896187, 0.024890054017305374, -0.0032528326846659184, 0.01835368573665619, 0.022256402298808098, -0.02295234240591526, -0.0035103983245790005, -0.049752816557884216, 0.041892800480127335, -0.010800700634717941, -0.029556939378380775, -0.04167446866631508, 0.05676679313182831, -0.03108527697622776, -0.017425768077373505, -0.019308896735310555, 0.013038622215390205, 0.008085174486041069, 0.017794206738471985, -0.038399457931518555, 0.022911405190825462, 0.012172110378742218, 0.005318475421518087, -0.0024852529168128967, -0.016456911340355873, 4.688100307248533e-05, -0.023989427834749222, -0.019650043919682503, -0.009115437045693398, 0.006106523796916008, -0.011169139295816422, -0.03138548508286476, 0.007941892370581627, 0.028547145426273346, -0.004625947680324316, 0.015242429450154305, 0.024780888110399246, -0.014778469689190388, 0.005373058840632439, -0.0020895227789878845, 0.014833053573966026, -0.027564644813537598, -0.009715855121612549, -0.02755099907517433, -0.024344220757484436, -0.025531411170959473, -0.00459524430334568, 0.004994385875761509, 0.007703090086579323, -0.013434352353215218, 0.005615272559225559, -0.0362979955971241, -0.03367799147963524, 0.006341915111988783, 0.03788091614842415, 0.004718057345598936, 0.005144490394741297, -0.01023439783602953, -0.01707097515463829, 0.04123779758810997, -0.006389675661921501, -0.007546162232756615, 0.007027619518339634, -0.001255419454537332, 0.06424472481012344, 0.004308681469410658, 0.016661599278450012, -0.021560464054346085, -0.01828545704483986, 0.012656538747251034, -0.010220752097666264, -0.011544400826096535, -0.014805762097239494, 0.00035799070610664785, -0.0029509179294109344, 0.0256815142929554, 0.004363264888525009, -0.02570880576968193, 0.017630456015467644, -0.012240339070558548, 0.02819235436618328, -0.01808076910674572, -0.018435562029480934, -0.008719706907868385, -0.007286890875548124, 0.005905247293412685, -0.020946400240063667, -0.008221632800996304, 0.0024988986551761627, -0.03995508700609207, 0.016784412786364555, 0.00041129483724944293, -0.02419411577284336, -0.01835368573665619, -0.003599096555262804, 0.022870467975735664, 0.003513809759169817, 0.004230217542499304, -0.010439085774123669, 0.006256628315895796, 0.013250133022665977, 0.00794871523976326, -0.012827111408114433, -0.0017441118834540248, 0.007750850636512041, 0.005601626820862293, -0.04825177416205406, -0.00631803460419178, 0.0015070150839164853, 0.0071163177490234375, -0.009361062198877335, 0.020960045978426933, -6.945530913071707e-05, -0.032149653881788254, -0.007894132286310196, -0.028874646872282028, -0.010336741805076599, 0.03190402686595917, 0.030866943299770355, 0.022829528898000717, 0.023539114743471146, -0.0036912059877067804, 0.0018166055670008063, -0.007907778024673462, -0.02961152419447899, 0.008999447338283062, -0.012213047593832016, -0.0046293591149151325, 0.04213842749595642, 0.011271483264863491, -0.0015965660568326712, 0.013987010344862938, -0.031112568452954292, 0.014805762097239494, 0.03264090418815613, -0.01780785247683525, -0.0014626659685745835, 0.01346164382994175, 0.025517765432596207, 0.018490144982933998, -0.005734674166887999, -0.06380805373191833, 0.020345982164144516, 0.015365242026746273, 0.0002963710867334157, -0.004383733496069908, 0.02768745645880699, 0.03553382679820061, -0.007041265722364187, -0.0018166055670008063, -0.003861779347062111, 0.009784083813428879, 0.009777260944247246, -0.008746998384594917, 0.018967749550938606, -0.006389675661921501, -0.005291183479130268, 0.06511805951595306, -0.010991742834448814, -0.014041593298316002, 0.010862107388675213, -0.03534278646111488, 0.03438757732510567, 0.014137114398181438, -0.018108060583472252, -0.01642961986362934, 0.015501701273024082, -0.019540876150131226, -0.008972154930233955, -0.009272363968193531, 0.019813792780041695, 0.0004938096972182393, -0.004721468780189753, -0.013659508898854256, 0.038399457931518555, -0.002908274531364441, -0.0076826210133731365, 0.05098094418644905, -0.013700447045266628, 0.002156046452000737, -0.009640802629292011, -0.01374820712953806, -0.010377679020166397, 0.001458401675336063, 0.018995041027665138, 0.02076900377869606, 0.020291399210691452, 0.0031726632732897997, -0.019336188212037086, -0.004649828188121319, -0.015433471649885178, 0.009361062198877335, 0.017562225461006165, -0.01129195187240839, 0.03793549910187721, 0.023402655497193336, -0.004451963119208813, 0.008037413470447063, 0.010104761458933353, -0.004039175342768431, -0.017357537522912025, -0.04257509484887123, -0.009797729551792145, 0.036106955260038376, 0.005772200413048267, 0.016006598249077797, -0.02678683027625084, 0.007389234844595194, 0.014751178212463856, 0.005587981082499027, 0.007368766237050295, 0.0022635075729340315, -0.02056431584060192, 0.032313402742147446, 0.025517765432596207, 0.006768348161131144, 0.01488763652741909, -0.050162192434072495, -0.03875425085425377, -0.0287654809653759, -0.008978977799415588, -0.024821825325489044, -0.031030694022774696, -0.04716010391712189, 0.040419045835733414, -0.02359369769692421, -0.008542310446500778, -0.03094881772994995, -0.002190161030739546, 0.008869810961186886, 0.0032596555538475513, 0.010575544089078903, 0.011196430772542953, -0.018189935013651848, 0.030621318146586418, 0.021492235362529755, 0.03163111209869385, -0.005717616993933916, 0.020004834979772568, -0.024248698726296425, 0.004472431726753712, 0.003015735885128379, 0.007996476255357265, 0.031603820621967316, 0.001224716193974018, -0.0040630558505654335, 0.06118805333971977, -0.029802566394209862, 0.03547924384474754, 0.008064704947173595, 0.0015999774914234877, -0.030976109206676483, -0.024289635941386223, -0.026172766461968422, -0.053819283843040466, 0.0006793081411160529, 0.0004083098319824785, -0.03703487291932106, -0.013925603590905666, 0.02862902171909809, 0.004950036760419607, -0.008167048916220665, 0.0046361819840967655, -0.03597049415111542, 0.009722677990794182, 0.011407941579818726, -0.0046873539686203, -0.0034967525862157345, 0.0007526546251028776, 0.0028076362796127796, 0.008330799639225006, -0.01430086512118578, 0.043202802538871765, -0.022665780037641525, 0.011674036271870136, 0.023197967559099197, -0.004803344141691923, 0.03225881978869438, -0.0031539001502096653, 0.0034285231959074736, 0.0006720587844029069, -0.02412588708102703, 0.007082202937453985, 0.006921864114701748, -0.029229439795017242, -0.017521288245916367, -0.0034575206227600574, -0.02933860570192337, -0.010070647113025188, 0.03766258433461189, 0.006751290988177061, 0.013434352353215218, 0.04197467491030693, -0.0003808048786595464, -0.02768745645880699, 0.013468467630445957, -0.043803222477436066, -0.016006598249077797, 0.01737118326127529, -0.008221632800996304, 0.0015863316366448998, -0.010834815911948681, 0.004011883866041899, 0.020482441410422325, 0.0028605142142623663, 0.05895012989640236, -0.012028828263282776, 0.008139757439494133, 0.016415974125266075, -0.011530754156410694, 0.0018456029938533902, 0.009231426753103733, 0.00045159278670325875, -0.014287219382822514, -0.019063271582126617, 0.037280499935150146, 0.013079560361802578, 0.018667541444301605, -0.007532516494393349, 0.008917571976780891, 0.000990177970379591, 0.059605132788419724, -0.045113224536180496, -0.005342355463653803, 0.00039594326517544687, 0.009954657405614853, -0.008248924277722836, 0.015488054603338242, 0.025313077494502068, 0.012308568693697453, 0.0016426207730546594, -0.006174753420054913, 0.012649714946746826, -0.021833380684256554, 0.031112568452954292, -0.0012682124506682158, -0.005454933736473322, -0.011510285548865795, -0.017453059554100037, 0.013550342060625553, 0.01784878969192505, -0.00315901730209589, -0.009688562713563442, -0.001762022147886455, 0.02947506494820118, 0.02695058099925518, 0.009572573006153107, -0.008221632800996304, -0.01808076910674572, 0.03223152831196785, -0.00623274827376008, 0.005298006348311901, 0.025858910754323006, 0.0028673370834439993, 0.03141277655959129, -0.026391100138425827, 0.016743473708629608, 0.015119616873562336, -0.005567512474954128, -0.014410031959414482, -0.012806642800569534, 0.01364586316049099, 0.017998894676566124, 0.02134213037788868, -0.0021338718943297863, 0.01955452188849449, 0.00379354995675385, 0.018831292167305946, -0.008139757439494133, 0.01186507847160101, 0.02242015302181244, -0.020741712301969528, 0.005100141279399395, -0.0065773059614002705, 0.014519198797643185, -0.006416967138648033, -0.030402984470129013, 0.011953776702284813, 0.02003212831914425, -0.012137995101511478, -0.04273884370923042, 0.005212720017880201, -0.028547145426273346, 0.0027479357086122036, 0.00786683987826109, -0.01663430780172348, -0.01814899779856205, -0.0055572777055203915, -0.023498177528381348, 0.031603820621967316, 0.01300450786948204, 0.01082116924226284, -0.024357866495847702, 0.007825902663171291, -0.010868930257856846, -0.02070077508687973, 0.035069867968559265, -0.01465565711259842, -0.015160554088652134, 0.003152194432914257, -0.014273572713136673, 0.0103162731975317, 0.009777260944247246, 0.026773184537887573, -0.011646744795143604, 0.010984919965267181, 0.011326066218316555, -0.015215137973427773, 0.029229439795017242, -0.01290216390043497, -0.037526123225688934, -0.007887309417128563, -0.005823372397571802, 0.01996389776468277, -0.021096505224704742, 0.03616153821349144, 0.028137769550085068, 0.032449863851070404, -0.011162316426634789, 0.004134696442633867, 0.023375364020466805, 0.0023470884189009666, 0.007170901168137789, -0.006601186469197273, 0.02931131422519684, -0.026363808661699295, 0.017166495323181152, 0.00751204788684845, 0.032176945358514786, 0.019349833950400352, 0.00951116718351841, 0.019718272611498833, 0.00459524430334568, -0.010964451357722282, -0.008883456699550152, -0.01780785247683525, -0.005690325051546097, 0.016088472679257393, 0.002132166177034378, -0.0038208416663110256, 0.0022038070019334555, -0.01773962192237377, 0.031194442883133888, 0.01562451384961605, -0.0040425872430205345, -0.005345766898244619, -0.001835368573665619, 0.012424558401107788, 0.010370856150984764, 0.0021065801847726107, -0.020004834979772568, -0.040009669959545135, -0.031440068036317825, -0.0209736917167902, 0.0007603304693475366, -0.012847580015659332, 0.008999447338283062, -0.019499938935041428, 0.00704808859154582, 0.0061883991584181786, 0.009538458660244942, 0.01554263848811388, 0.0196909811347723, -0.00042835218482650816, 0.030102774500846863, -0.018708478659391403, 0.006901395507156849, -0.007798610720783472, -0.009872782044112682, -0.0026421803049743176, -0.0030583790503442287, -0.017957955598831177, -0.014423677697777748, -0.012731590308248997, 0.027564644813537598, -0.032449863851070404, 0.049479901790618896, 0.013966540805995464, 0.01573367975652218, -0.021314838901162148, 0.004411025438457727, 0.018135352060198784, -0.023006925359368324, 0.01436909381300211, -0.01166039053350687, 0.004223394673317671, -0.004683942534029484, 0.05169053003191948, 0.020741712301969528, 0.0005867721047252417, -0.006802462972700596, 0.0029816210735589266, 0.01416440587490797, 0.04369405284523964, -0.00307031930424273, 0.006737645249813795, -0.012949923984706402, -0.004226806107908487, 0.004451963119208813, 0.0019223609706386924, -0.018558373674750328, 0.0034592263400554657, 0.03425111621618271, -0.033132154494524, 0.02113744243979454, -0.022611195221543312, 0.0059768883511424065, 8.848489233059809e-05, 0.01693451590836048, -0.024617137387394905, 0.04710552096366882, 0.00578925758600235, -0.010480022989213467, 0.015774618834257126, -0.0024528440553694963, -0.02446703240275383, 0.015720034018158913, -0.01872212439775467, -0.008637831546366215, -0.009361062198877335, -0.009593041613698006, 0.010070647113025188, -0.010172991082072258, -0.028383396565914154, -0.039136335253715515, -0.016920870169997215, -0.02819235436618328, -0.010084292851388454, 0.05130844563245773, 0.008153403177857399, 0.0021952781826257706, -0.017384830862283707, -0.015801910310983658, -0.02214723639190197, -0.01767139323055744, -0.005901835858821869, 0.006488608196377754, 0.0009424174204468727, -0.006812697276473045, -0.012752058915793896, -0.014833053573966026, -0.012697475962340832, 0.024248698726296425, 0.016293160617351532, 0.010138876736164093, -0.0056357416324317455]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
" the blue boxes). Note that Mis
the causality mask.
C[0,32+δ1,64+δ2,96]. In the first level, we set the search
stride as 8 and measure the TTFTs on each grid. Once we
find the best performing (δ1, δ2)pair, we limit the search to
the gray grid and reduce the search stride to 4 to perform
another scan as in Fig. 6 (c). We repeat the same process
recursively until the minimum stride is applied, leading to
the final search as in Fig. 6 (d). The best partitioning is then
[0,28,70,96]and marked as a red dot in Fig. 6 (b).
A comprehensive partitioning lookup table will enable effi-
cient partitioning as in Fig. 3 (b) for effective load-balancing.
For a given user context, we will interpolate and predict the
best partitioning from two closest entries. Therefore, having
a dense and large table would be advantageous at the cost of
one-time search overhead. Our results also show that even
at the 4k intervals between entries, the predicted partitioning
can yield excellent TTFT (see Fig. 10).
6
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
(a)TSP hits out-of-memory error for 16k.
 (b)KVR-S is 1.42×faster for 12k than TSP.
(c)KVR-S is 1.41×faster for 16k than TSP.
(d)KVR-S shows the best scalability.
 (e)KVR-S is 1.79×faster for 8k than TSP.
(f)KVR-S is 1.57×faster for 16k than TSP.
Figure 8. Llama 7B: while KVR-E already outperforms TSP in all the test cases, KVR-S further accelerates by 1.42 ×over TSP as in
(a-c) with 300GB/s network. The speedups from KVR-E andKVR-S are even higher with 10GB/s network as in (e, f): 1.55 ×(4 GPUs
and 8k) and 1.79 ×(4 GPUs and 12k) over TSP, respectively. KVR-S is the closest to the scalability lower bounds as in (d).
(a)KVR-S is 1.26×faster for 4k than TSP.
(b)KVR-S is 1.46×faster for 8k than TSP.
(c)KVR-S is 1.63×faster for 8k than TSP.
Figure 9. Falcon 7B: KVR-S offers up to 1.63 ×speedup over TSP. Since 4k context length is relatively short, the benefit from KVR-E
is canceled out by the overhead from KV-cache waiting time and unbalanced attention compute as in (b-c). However, with load-balancing,
KVR-S delivers 1.37 ×and 1.47 ×speedup over TSP with 4 and 8 GPUs, respectively, which emphasizes the context-level load-balancing.
4.3. Implementation
Since KV-Runahead dual-purposes the KV-cache interface,
which exists in most LLM implementations for faster sub-
sequent token generations during the extension phase in
Fig. 1 (a) (HuggingFace-Transformers), KV-Runahead is
easy to implement. Fig. 7 shows the pseudocode/compu-
tational graph without and with KV-Runahead. Note that
KV-cache is already in the input argument to the attention
block. The only additions are two parts in the blue boxes:
a)overwrite the KV-cache by receiving it from pi−1before
concatenating it with the local (K, V), and b)forward theupdated KV-cache to pi+1right after concatenation. We
can make both recv andsend asynchronous calls by overlap-
ping with qkvproj andsoftmax respectively, thanks to the
nature of point-to-point connections. More details on the
implementation and examples can be found in Appendix 5.
Both TSP and KV-Runahead require to have tensors in the
contiguous memory space for efficient network communi-
cation, which is then about KV-cache for KV-Runahead: if
KV-cache is physically fragmented, costly extra memory
copy will be necessary. Therefore, the KV-cache manage-
ment such as vLLM (Kwon et al., 2023; vLLM) needs to
7
KV","[-0.02399345487356186, 0.007927577011287212, 0.04682429879903793, -0.024821817874908447, 0.004548728931695223, -0.01120469719171524, 0.03450058400630951, 0.041185617446899414, -0.020752668380737305, 0.0563286691904068, 0.012439974583685398, 0.027655690908432007, 0.00014078534150030464, 0.014038569293916225, -0.013486327603459358, -0.024066118523478508, 0.0021599195897579193, -0.03883132338523865, -0.012461774051189423, -0.009700564667582512, -0.05188167095184326, -0.04095309227705002, 0.01262889988720417, 0.04656270891427994, 0.01264343224465847, -0.044615328311920166, -0.005576916038990021, 0.019313933327794075, -0.002677646465599537, -0.07929030805826187, 0.008930332027375698, -0.027859149500727654, -0.06812920421361923, -0.04447000101208687, 0.016378331929445267, 0.070745088160038, 0.008530683815479279, 0.03028610721230507, -0.03455871343612671, 0.03589572012424469, 0.015622631646692753, -0.05693904310464859, -0.08347571641206741, 0.00037489773239940405, 0.022859906777739525, 0.004029185511171818, -0.0008656028076075017, -0.014656208455562592, -0.05321867763996124, 0.06266491860151291, 0.023513877764344215, 0.0016649002209305763, -0.060165297240018845, 0.01511398795992136, -0.03293105587363243, 0.00045232969569042325, 0.030547695234417915, -0.041127488017082214, 0.049527376890182495, -0.0022416659630835056, 0.009853157214820385, -0.028498586267232895, -0.01825304701924324, -0.019313933327794075, 0.0003971508995164186, -0.001505949068814516, -0.00845075398683548, 0.006982952821999788, -0.008886734023690224, 0.032669465988874435, -0.027960877865552902, 0.03246600925922394, 0.025897236540913582, -0.03307637944817543, 0.001847467035986483, 0.024153314530849457, 0.025780975818634033, 0.038366276770830154, 0.04999241977930069, 0.005119136534631252, 0.04621392488479614, -0.009918554686009884, 0.042290098965168, 0.0004777618742082268, 0.02384812943637371, -0.05853763595223427, -0.022874439135193825, -0.006216354202479124, -0.03717459738254547, -0.02041841670870781, -0.022859906777739525, 0.04345271363854408, -0.016465527936816216, 0.030024517327547073, 0.05397437512874603, 0.03952889144420624, 0.03249507397413254, -0.07121013849973679, 0.02256925217807293, 0.030489563941955566, 0.0210869200527668, -0.0023597439285367727, 0.0247346218675375, -0.05490446835756302, 0.08655664324760437, -0.01550636999309063, -0.025824572890996933, 0.031942833214998245, -0.005991097539663315, -0.010296404361724854, -0.08841682970523834, -0.016712583601474762, -0.02751036360859871, 0.036971140652894974, 0.018441971391439438, -0.06033968925476074, -0.06539706140756607, -0.0140531025826931, 0.006238153204321861, 0.0037857634015381336, -0.0123600447550416, 0.023760933429002762, 0.011023038066923618, -0.009751428849995136, -0.02749583125114441, -0.02681279554963112, 0.0420866422355175, -0.07138452678918839, 0.007491596974432468, 0.0030246141832321882, 0.007716853637248278, -0.004207211080938578, 0.05673558637499809, 0.02047654613852501, -0.011793270707130432, 0.004861181601881981, -0.053799983114004135, 0.002534136176109314, -0.017947860062122345, 0.017846131697297096, -0.04845195636153221, -0.01123376190662384, 0.0037639643996953964, 0.020534677430987358, -0.0490332655608654, 0.04133094474673271, -0.02961760386824608, 0.03432619199156761, -0.03173937276005745, 0.009591569192707539, -0.034064602106809616, -0.011778737418353558, -0.008152834139764309, -0.012447240762412548, -0.037668708711862564, -0.0421157069504261, -0.05542764440178871, 0.027771953493356705, 0.010042082518339157, -0.01016561035066843, -0.027612093836069107, 0.0007352628163062036, 0.07591872662305832, -0.002630415139719844, 0.005700443871319294, -0.014598078094422817, -0.06632715463638306, -0.008189165964722633, -0.07545367628335953, -0.03793029487133026, 0.018819821998476982, -0.06743163615465164, -0.045400094240903854, 0.011836868710815907, 0.018659962341189384, -0.019967902451753616, -0.039005715399980545, -0.0020309421233832836, 0.007051983382552862, -0.048306629061698914, -0.026929058134555817, 0.052375782281160355, 0.021421171724796295, 0.036796748638153076, -0.04618486016988754, -0.00047503699897788465, -0.009715097025036812, 0.03958702087402344, -0.032611336559057236, 0.019459258764982224, -0.004250809084624052, 0.029210688546299934, 0.039674218744039536, 0.03577946126461029, 0.011132033541798592, 0.015259314328432083, 0.019430194050073624, 0.03662235662341118, 0.0038438939955085516, -0.009271849878132343, 0.0023942592088133097, 0.00617275619879365, 0.01084864605218172, -0.07870899885892868, 0.02602803148329258, -0.03819188475608826, -0.003511458868160844, 0.016727115958929062, -0.007062882650643587, -0.022351263090968132, 0.031041806563735008, 0.017003236338496208, 0.03979048132896423, 0.023615606129169464, -0.012425442226231098, -0.007716853637248278, -0.04487691819667816, 0.021958880126476288, 0.0009028427884913981, 0.022075142711400986, 0.027946345508098602, 0.02040388435125351, -0.017061367630958557, -0.004853915423154831, -0.03647702932357788, 0.03284385800361633, 0.011851401068270206, -0.0630718320608139, 0.010521660558879375, -0.003277119481936097, 0.02877470850944519, 0.006249052472412586, 0.003945622593164444, -0.03845347464084625, -0.01893608272075653, -0.08045291900634766, -0.03795936331152916, -0.050922513008117676, 0.014285624958574772, -0.06562958657741547, -0.02958853729069233, 0.005544217769056559, 0.010267338715493679, -0.0015677128685638309, -0.011706074699759483, 0.02594083547592163, -0.021915283054113388, -0.04778345301747322, 0.058014459908008575, 0.016596321016550064, -0.011088435538113117, -0.024109717458486557, -0.0637112706899643, -0.009460775181651115, -0.03888945281505585, 0.003429712727665901, 0.008959397673606873, 0.01123376190662384, 0.0078040496446192265, -0.00254685222171247, -0.006198188289999962, -0.006833992898464203, -0.008639678359031677, -0.007091948296874762, -0.02873110957443714, -0.008886734023690224, 0.01368978526443243, -0.006507007870823145, -0.02099972404539585, -0.05557297170162201, 0.025475788861513138, -0.017163095995783806, 0.013261071406304836, -0.02034575305879116, -0.0007016559829935431, 0.0073099383153021336, 0.025708312168717384, -0.018093187361955643, 0.007934843190014362, 0.012490838766098022, 0.003967421595007181, 0.0031154435127973557, 0.07394228130578995, -0.019183138385415077, -0.0034987428225576878, 0.013253804296255112, 0.0033170843962579966, 0.015985948964953423, -0.017410151660442352, -0.054497551172971725, 0.011851401068270206, -0.008036572486162186, 0.011800536885857582, -0.013827845454216003, 0.026536675170063972, 0.04853915423154831, -0.029094425961375237, -0.003542340826243162, -0.006903023459017277, -0.014874198473989964, 0.04694055765867233, 0.025693779811263084, 0.019328465685248375, 0.019982436671853065, -0.014641676098108292, 0.039092909544706345, 0.03601198270916939, 0.013776981271803379, -0.0490332655608654, 0.008399889804422855, -0.0281643345952034, 0.012774226255714893, -0.013827845454216003, 0.014714338816702366, -0.028004474937915802, -0.04714401438832283, 0.05132942646741867, -0.05414876714348793, 0.06510640680789948, -0.03101273998618126, -0.003862059907987714, -0.08155740052461624, 0.00035014678724110126, 0.008944865316152573, 0.023702802136540413, -0.01892155036330223, -0.012708828784525394, 0.0016176690114662051, 0.004668623674660921, -0.011110234074294567, -0.0018311177846044302, 0.022976167500019073, 0.012839623726904392, -0.03441338613629341, -0.0769069492816925, -0.015433707274496555, -0.010485328733921051, 0.0051373024471104145, 0.009264583699405193, 0.014627142809331417, -0.09236972033977509, -0.004962910432368517, -0.014554480090737343, -0.017933327704668045, 0.0014750671107321978, 0.07237274944782257, 0.03979048132896423, -0.027583027258515358, 0.04435374215245247, 0.027277842164039612, 0.00442520109936595, -0.04072057083249092, 0.04165066406130791, -0.0175409447401762, 0.022743646055459976, -0.01834024302661419, 0.014002237468957901, -0.02948680892586708, -0.01679977960884571, 0.0034515117295086384, -0.01263616606593132, 0.020897995680570602, 0.02737957052886486, -0.004000120330601931, 0.00740440096706152, 0.004461532924324274, -0.04522570222616196, 0.006452510133385658, 0.0017984192818403244, -0.00978776067495346, 0.031390588730573654, 0.014772470109164715, 0.021595563739538193, -0.04013926535844803, -0.06824547052383423, -0.024821817874908447, 0.028600314632058144, 0.034791238605976105, 0.02806260623037815, 0.05499166250228882, 0.029152557253837585, 0.005605981685221195, -0.022859906777739525, -0.0061400574631989, 0.031303394585847855, -0.009446242824196815, 0.012040326371788979, -0.013871443457901478, -0.04138907417654991, -0.016334732994437218, -0.03944169357419014, 0.020839864388108253, -0.01016561035066843, 0.026856394484639168, 0.014866932295262814, 0.02399345487356186, 0.030460499227046967, 0.007607858162373304, 0.026405880227684975, 0.06452510505914688, -0.01903781108558178, -0.0073135714046657085, -0.05670652166008949, -0.020796265453100204, -0.006873957812786102, -0.007651456166058779, -0.0008024764829315245, 0.018558233976364136, 0.058857355266809464, 0.008530683815479279, 0.051765408366918564, -0.03255320340394974, 0.01964818499982357, -0.060165297240018845, 0.038308147341012955, 0.0057295095175504684, 0.003753064665943384, 0.01826757937669754, 0.003756697988137603, 0.08301067352294922, -0.03717459738254547, -0.0018365675350651145, -0.05690997838973999, -0.0353144146502018, -0.019473792985081673, -0.005867569707334042, 0.009170121513307095, -0.05353839695453644, 0.03101273998618126, -0.02594083547592163, -0.015361043624579906, 0.03089647926390171, 0.0490042008459568, 0.019415661692619324, -0.03641889616847038, -0.016349265351891518, 0.007774983998388052, 0.012432708404958248, -0.01828211173415184, -0.018529167398810387, 0.015680762007832527, -0.022176871076226234, -0.028353260830044746, 0.013282869942486286, -0.048132237046957016, -0.0003226709377486259, -0.014016770757734776, -0.017846131697297096, 0.038337212055921555, -0.0016485509695485234, 0.0064779422245919704, 0.02258378639817238, 0.017889730632305145, 0.00489388033747673, -0.0010617939988151193, -0.05130036175251007, 0.06522267311811447, -0.020665472373366356, 0.02528686448931694, 0.0020908894948661327, -0.003411546815186739, 0.019459258764982224, -0.05057372897863388, 0.0035314413253217936, 0.026885459199547768, 0.01957552134990692, 0.06789668649435043, -0.006005630362778902, 0.030693020671606064, 0.00721910921856761, 0.047434668987989426, -0.04438280686736107, 0.020868929103016853, -0.03391927480697632, -0.03711646795272827, 0.0036386200226843357, 0.01483060047030449, -0.04080776870250702, 0.02596990019083023, -0.004937478341162205, 0.026391347870230675, -0.004864814691245556, 0.02104332111775875, 0.014954128302633762, 0.023688269779086113, 0.07115200161933899, 0.059351466596126556, -0.00989675521850586, 0.012803291901946068, 0.0027757419738918543, -0.036099180579185486, -0.009446242824196815, 0.03278572857379913, -0.017875196412205696, -0.0008161008590832353, 0.006434344220906496, -0.02255471982061863, 0.025112472474575043, 0.022729111835360527, -0.02464742586016655, 0.03848253935575485, -0.006714098621159792, 0.014481816440820694, 0.010652454569935799, 0.0015359226381406188, 0.03173937276005745, 0.052462976425886154, 0.0002246888616355136, 0.011415421031415462, 0.027016254141926765, -0.02387719415128231, 0.0009963968768715858, 0.006761329714208841, 0.02325228974223137, 0.0007897603791207075, 0.008705075830221176, -0.0176862720400095, 0.026405880227684975, 0.012221984565258026, 0.0008878559456206858, -0.020011501386761665, -0.0002824789844453335, -0.024255044758319855, -0.013377332128584385, 0.019546454772353172, -0.020040566101670265, -0.030663955956697464, -0.11364556103944778, -0.05670652166008949, -0.07324471324682236, 0.01303581427782774, -0.011873200535774231, -0.025112472474575043, 0.0002368372806813568, -0.01512852031737566, 0.01607314497232437, 0.0030336971394717693, -0.026376815512776375, -0.018500102683901787, -0.008494351990520954, 0.019212203100323677, 0.02961760386824608, 0.015055857598781586, 0.020505612716078758, -0.015797024592757225, -0.025621116161346436, 0.05083531513810158, -0.020592808723449707, -0.002525053219869733, 0.007840381003916264, 0.011931330896914005, -0.034849368035793304, 0.02806260623037815, -0.025054341182112694, -0.01627660170197487, 0.0025068873073905706, 0.0006199096678756177, 0.006586937699466944, -0.014314690604805946, -0.015767958015203476, 0.033279839903116226, 0.027641158550977707, 0.024414904415607452, -0.029123492538928986, -0.01611674204468727, 0.014176630415022373, 0.011015771888196468, -0.005039207171648741, 0.0019473792053759098, 0.01547730527818203, -0.01825304701924324, -0.008210964500904083, 0.020185893401503563, 0.018107719719409943, 0.019909773021936417, -0.029050828889012337, 0.005253564100712538, -0.0027975409757345915, 0.012185652740299702, 0.007368069142103195, -0.04444093629717827, -0.006724997889250517, -0.026376815512776375, -0.020709069445729256, -0.015302912332117558, 0.002555935177952051, -0.01974991336464882, 0.013486327603459358, -0.03729085996747017, 0.02262738347053528, 0.029690265655517578, -0.0025650181341916323, 0.03740711882710457, -0.010892244055867195, -0.0174682829529047, 0.003640436567366123, -0.005071905441582203, -0.04510943964123726, -0.02307789772748947, -0.04156346619129181, 0.003916557412594557, -0.0016667167656123638, -0.0040764170698821545, -0.0281788669526577, -0.03656422346830368, 0.04519663751125336, -0.020810797810554504, 0.027757419273257256, 0.03665142133831978, -0.007600591983646154, 0.021290376782417297, -0.025766443461179733, -0.04377243295311928, -0.008915799669921398, -0.036186374723911285, -0.009395377710461617, -0.033454231917858124, -0.027728354558348656, 0.05414876714348793, -0.019473792985081673, 0.029007229954004288, -0.016639919951558113, 0.009620634838938713, -0.0067867618054151535, 0.002425141166895628, 0.009191920049488544, 0.0022925303783267736, -0.032611336559057236, -0.034791238605976105, -0.0014877831563353539, -0.010761450044810772, 0.004991975612938404, 0.01693057268857956, 0.01815131865441799, -0.009547971189022064, 0.0048066843301057816, 0.021581031382083893, 0.00911925733089447, 0.02743770182132721, 0.003048229729756713, 0.01303581427782774, 0.03354142606258392, 0.00808743666857481, -0.020156828686594963, 0.025156069546937943, 0.010637922212481499, -0.0028938199393451214, 0.04505131021142006, 0.0072045763954520226, -0.036883942782878876, -0.04726027697324753, -0.03880225867033005, 0.035576000809669495, 0.035372544080019, 0.03307637944817543, -0.01678524538874626, 0.0043997690081596375, -0.016639919951558113, 0.011117500253021717, 0.0006385296583175659, -0.022394860163331032, 0.0006653242744505405, -0.03223348408937454, 0.0007670530467294157, 0.00289745326153934, 0.0008083803695626557, 0.03031517192721367, 0.02262738347053528, -0.018601831048727036, 0.007193677127361298, 0.001812951872125268, 0.0023524777498096228, 0.03455871343612671, -0.0017702621407806873, 0.006456143222749233, -0.015230249613523483, -0.018558233976364136, -0.020810797810554504, -0.016029546037316322, 0.028469521552324295, -0.02951587364077568, -0.016596321016550064, -0.05563110113143921, -0.0024051587097346783, 0.00016689875337760895, 0.025083405897021294, -0.00914832204580307, 0.0010163793340325356, 0.02120318077504635, -0.02394985780119896, -0.0029991818591952324, -0.004868448246270418, 0.022031543776392937, -0.02806260623037815, 0.0063616810366511345, 0.02099972404539585, 0.006921189371496439, 0.02535952813923359, -0.02307789772748947, -0.022816307842731476, 0.007462531328201294, 0.00913378968834877, -0.03391927480697632, 0.0047085885889828205, -0.012984950095415115, -0.03223348408937454, -0.00437070382758975, 0.02951587364077568, 0.04060430824756622, -0.0422319695353508, -0.007262707222253084, -0.019313933327794075, -0.009409910999238491, -0.0123600447550416, -0.03025704063475132, 0.004069150425493717, 0.007949376478791237, -0.017148563638329506, -0.01604408025741577, -0.020563744008541107, -0.0424063615500927, 0.030663955956697464, -0.01475067064166069, -0.01969178207218647, 0.004577794577926397, 0.0032480540685355663, -0.029210688546299934, 0.03604104742407799, 0.01019467506557703, 0.03822094947099686, 0.04711494967341423, 0.0049193124286830425, 0.004308939911425114, -0.019837109372019768, -0.020171361044049263, -0.0005685911164619029, -0.048045042902231216, -0.018427439033985138, -0.05109690502285957, 0.00721910921856761, -0.007527928799390793, -0.04380149766802788, 0.007716853637248278, 0.0637112706899643, -0.00442520109936595, -0.0071064806543290615, 0.008131034672260284, -0.004853915423154831, -0.018500102683901787, -0.014765203930437565, -0.020185893401503563, 0.014954128302633762, 0.017061367630958557, -0.015593566000461578, 0.02386266179382801, -0.022336730733513832, 0.035459741950035095, -0.004312573000788689, 0.006899390369653702, -0.0029628502670675516, 0.012105722911655903, 0.008210964500904083, -0.015331977978348732, 0.003676768159493804, 0.027946345508098602, 0.013769715093076229, -0.01970631442964077, -0.01235277857631445, 0.005704076960682869, 0.03083834797143936, -0.008378090336918831, -0.015738893300294876, 0.00845802016556263, 0.01446001697331667, 0.039732348173856735, -0.018122252076864243, 0.009482573717832565, -0.020142294466495514, 0.02187168411910534, 0.03575039282441139, -0.023048831149935722, -0.014910530298948288, -0.029225220903754234, -0.042290098965168, -0.014569012448191643, -0.029762929305434227, -0.000245693139731884, 0.016349265351891518, -0.008545216172933578, -0.03249507397413254, -0.023339485749602318, -0.013529925607144833, -0.003171757562085986, 0.005511519033461809, -0.015375575982034206, 0.034849368035793304, -0.02679826319217682, -0.08370824158191681, -0.03182657063007355, 0.030780218541622162, -0.0003362953139003366, 0.0350818894803524, -0.00092555012088269, 0.004668623674660921, -0.01682884432375431, 0.03877319023013115, 0.004363437183201313, -0.0211014524102211, -0.016407396644353867, -0.014787002466619015, -0.025737376883625984, -0.010754183866083622, -0.029138024896383286, -0.027960877865552902, 0.0026885459665209055, 0.010514394380152225, -0.06533893197774887, -0.011887732893228531, -0.004025552421808243, 0.015331977978348732, 0.011328225024044514, -0.024240510538220406, -0.03089647926390171, -0.0019419294549152255, -0.04060430824756622, -0.008894000202417374, 0.03322170674800873, -0.004465166013687849, -0.010732384398579597, 0.0022888972889631987, 0.03798842802643776, -0.034849368035793304, 0.001570437802001834, -0.02185715176165104, 0.005046473350375891, 0.010347268544137478, -0.0033624989446252584, -0.023557474836707115, -0.05566016584634781, 0.017163095995783806, -0.00981682538986206, 0.04432467743754387, -0.02886190451681614, 0.03455871343612671, 0.024182381108403206, 0.0024632893037050962, 0.010746917687356472, 0.022322198376059532, -0.007051983382552862, 0.004577794577926397, 0.014249293133616447, 0.0013706134632229805, 0.018049590289592743, -0.01911047473549843, 0.0002824789844453335, 0.01908141002058983, 0.021493835374712944, 0.006390746217221022, 0.031216198578476906, 0.019401129335165024, -0.02036028541624546, -0.030663955956697464, -0.022394860163331032, 0.004784885328263044, 0.034820303320884705, 0.008937598206102848, -0.01015834417194128, -0.02884737029671669, 0.010579791851341724, -0.004995609167963266, -0.01332646794617176, 0.04133094474673271, 0.03275666385889053, -0.016509125009179115, 0.023542942479252815, -0.07237274944782257, 0.015956884250044823, 0.0424063615500927, -0.055136989802122116, 0.017962392419576645, 0.02322322316467762, 0.03214628994464874, -0.006692299619317055, 0.05563110113143921, -0.03636076673865318, -0.004788518417626619, -0.0036713185254484415, 0.03627357259392738, -0.016291135922074318, 0.02034575305879116, 0.004149080254137516, 0.003562323283404112, 0.02393532544374466, 0.03304731473326683, 0.01834024302661419, 0.022685514762997627, -0.006169123109430075, 0.03720366209745407, 0.027960877865552902, 0.00546428794041276, -0.058595769107341766, -0.029181621968746185, 0.011865933425724506, 0.02887643687427044, -0.011807803064584732, 0.04028458893299103, -0.023397615179419518, 0.029414145275950432, 0.00423990935087204, -0.00632534921169281, 0.05981651321053505, -0.024429436773061752, 0.02966120094060898, 0.004952010698616505, 0.0031990064308047295, 0.013660719618201256, -0.02535952813923359, -0.002951950766146183, 0.037552446126937866, -0.022990699857473373, -0.011800536885857582, -0.02383359707891941, -0.0043888697400689125, 0.009279116988182068, 0.025635648518800735, -0.020055098459124565, 0.00273214397020638, -0.008210964500904083, 0.018427439033985138, 0.019313933327794075, 0.004316206090152264, -0.0247055571526289, 0.0014387354021891952, -0.023659203201532364, -0.005791273433715105, 0.008712342008948326, 0.04757999628782272, 0.010637922212481499, -0.0067758625373244286, 0.04167972877621651, 0.010122012346982956, 0.006601470056921244, 0.012614366598427296, 0.005504252854734659, -0.021145049482584, -0.00273214397020638, -0.0011816886253654957, 0.01130642555654049, -0.020868929103016853, -0.003800295991823077, 0.020520145073533058, 0.011059369891881943, 0.022191403433680534, -0.002032758668065071, -0.018674494698643684, 0.029879191890358925, 0.0560670830309391, -0.003028247272595763, 0.038424406200647354, -0.011560747399926186, -0.000692573084961623, 0.03322170674800873, 0.0022580153308808804, -0.017221227288246155, 0.00030836532823741436, 0.005496986676007509, 0.013435463421046734, -0.009693297557532787, -0.031070871278643608, 0.03211722522974014, 0.025156069546937943, 0.0628974437713623, 0.038976650685071945, -0.0016549089923501015, -0.02174089103937149, 0.009162855334579945, 0.02880377322435379, -0.006659600883722305, 0.027975410223007202, -0.01974991336464882, 0.004025552421808243, 0.006612369790673256, 0.005184534005820751, 0.00437070382758975, 0.004730387590825558, -0.003989221062511206, 0.015288379974663258, 0.015462771989405155, 0.02098519168794155, -0.007426199968904257, 0.020127762109041214, 0.01056525856256485, -0.006336248945444822, 0.013987705111503601, 0.029341481626033783, -0.022205935791134834, 0.00419267825782299, -0.022104207426309586, 0.0491785928606987, -0.0006557872402481735, -0.02316509373486042, -0.03734898939728737, 0.03391927480697632, -0.011284626089036465, -0.022205935791134834, -0.020200425758957863, 0.012897754088044167, 0.014227494597434998, 0.015579033643007278, -0.031913768500089645, 0.014939595945179462, 0.002185351913794875, -0.018689027056097984, 0.00912652350962162, -0.03185563534498215, -0.024037053808569908, -0.02521420083940029, -0.038976650685071945, -0.003883858909830451, -0.002644947962835431, -0.0005304428632371128, -0.018689027056097984, 0.005813072435557842, 0.0055551170371472836, -0.019488325342535973, 0.020040566101670265, 0.020839864388108253, -0.010688786394894123, 0.0030300638172775507, -0.0029919156804680824, 0.01761360839009285, -0.03357049077749252, -0.003618637565523386, -0.024807285517454147, -0.028338726609945297, -0.01976444572210312, 0.00271216151304543, 0.005409790202975273, -0.008697809651494026, -0.004112748429179192, 0.002079989993944764, -0.015811556950211525, -0.0033425164874643087, 0.019880706444382668, 0.048074107617139816, -0.0007561535458080471, 0.008254562504589558, -0.008923065848648548, -0.002626782050356269, 0.03383208066225052, 0.00882860366255045, 0.00422537699341774, 0.0016866992227733135, 0.017395619302988052, 0.07289592921733856, 0.014191162772476673, 0.018674494698643684, -0.021639160811901093, -0.006205454468727112, 0.010289138182997704, -0.01908141002058983, -0.010151077061891556, -0.043162062764167786, -0.015767958015203476, -0.00808017048984766, 0.018471037968993187, 0.015535435639321804, -0.022205935791134834, 0.029021764174103737, -0.003698567161336541, 0.017918795347213745, -0.03214628994464874, 0.014387354254722595, -0.006270851474255323, -0.0041890451684594154, 0.014242026954889297, -0.008269094862043858, 0.0014387354021891952, -0.013806046918034554, -0.030518628656864166, -0.012839623726904392, -0.0123600447550416, -0.012527170591056347, -0.027859149500727654, -0.0008215506095439196, 0.03947076201438904, -0.006601470056921244, -0.003293468849733472, 0.032582271844148636, 0.01160434540361166, 0.010674254037439823, 0.025911768898367882, -0.0035278082359582186, 0.007331737317144871, -0.004519663751125336, 0.00770232081413269, -0.060165297240018845, 0.01836930774152279, 0.00810196902602911, 0.026318684220314026, -0.00419267825782299, 0.036825813353061676, 0.0069902194663882256, -0.031303394585847855, -0.007477064151316881, -0.00986769050359726, -0.006078293547034264, 0.0007352628163062036, 0.022307664155960083, 0.012069391086697578, 0.029239753261208534, 0.0010172876063734293, 0.004050984513014555, -0.0027648424729704857, -0.03726179152727127, 0.00598746445029974, -0.02243845909833908, 0.00045596284326165915, 0.02671106718480587, 0.0017148563638329506, -0.00333161698654294, 0.02243845909833908, -0.03717459738254547, 0.009380845353007317, 0.01482333429157734, -0.02166822738945484, -0.00021197277237661183, 0.011858667246997356, 0.00807290431112051, 0.0075933258049190044, 0.013072146102786064, -0.04098216071724892, -0.0012398193357512355, -0.008378090336918831, -0.0003991945704910904, -0.014234760776162148, 0.018558233976364136, 0.026464011520147324, 0.022307664155960083, 0.01053619384765625, 0.003887491999194026, -0.007375335320830345, 0.013646187260746956, -0.0015304728876799345, 0.027132514864206314, -0.009228251874446869, -0.009271849878132343, 0.07324471324682236, -0.01303581427782774, -0.015055857598781586, -0.005486086942255497, -0.05359652638435364, 0.02466195821762085, -0.006634168792515993, -0.006107359193265438, -0.02876017428934574, 0.015331977978348732, -0.016378331929445267, -0.0004709496861323714, -0.011807803064584732, 0.007139179389923811, 0.0015586300287395716, -0.0014450934249907732, -0.004472432658076286, 0.030460499227046967, -0.0001449862029403448, -0.025432191789150238, 0.0353144146502018, -0.017192160710692406, -0.012069391086697578, -0.02121771313250065, -0.006121891550719738, 0.002446940168738365, 0.002868387848138809, 0.011386355385184288, 0.025577517226338387, 0.008683276362717152, 0.010732384398579597, -0.023746401071548462, -0.036825813353061676, 0.0029283352196216583, 0.0122655825689435, 0.008370824158191681, -0.014140298590064049, 0.029879191890358925, 0.013079412281513214, -0.001145356916822493, 0.0027339605148881674, 0.007469797972589731, -0.017308423295617104, -0.02313602715730667, -0.04342364892363548, -0.025156069546937943, 0.031274329870939255, -0.015520903281867504, 0.00018199911573901772, -0.004069150425493717, 0.011822335422039032, -0.011328225024044514, 0.016668984666466713, 0.01604408025741577, -0.002501437673345208, -0.03374488279223442, 0.017017768695950508, 0.026246020570397377, 0.008799538016319275, 0.003600471653044224, -0.03592478483915329, -0.038976650685071945, -0.010645188391208649, -0.016465527936816216, -0.02740863524377346, -0.03249507397413254, -0.03229161724448204, 0.03298918530344963, -0.03290198743343353, -0.005958399269729853, -0.019342998042702675, 0.00044256553519517183, 0.0005667745717801154, 0.0021435704547911882, 0.010884977877140045, 0.016465527936816216, -0.0050319405272603035, 0.03362862393260002, 0.01970631442964077, 0.01912500709295273, -0.020011501386761665, 0.013515393249690533, -0.02464742586016655, 0.010296404361724854, 0.011262827552855015, 0.018500102683901787, 0.02807713858783245, -0.013617121614515781, -0.001573162735439837, 0.05286989361047745, -0.026362283155322075, 0.013144809752702713, 0.013282869942486286, -0.008428954519331455, -0.0211305171251297, -0.024356773123145103, -0.03357049077749252, -0.03185563534498215, 0.0014768836554139853, -0.0016975987236946821, -0.018863419070839882, -0.005333493929356337, -0.0024778221268206835, -0.006343515124171972, 4.339935185271315e-05, -0.0009809558978304267, -0.044586263597011566, 0.0011898631928488612, 0.03638983145356178, 0.0122510502114892, 0.004159979987889528, -0.01755547896027565, 0.007753184996545315, 0.002990099135786295, 0.00335159944370389, 0.04371430352330208, -0.008399889804422855, 0.021595563739538193, 0.00847255252301693, -0.0009300915407948196, 0.022002479061484337, 0.006532439962029457, 0.01691604033112526, -0.0014596261316910386, -0.02325228974223137, -0.010521660558879375, 0.0007579701486974955, -0.007985708303749561, -0.03240787610411644, -0.009831358678638935, -0.026420412585139275, -0.013558991253376007, 0.03284385800361633, 0.003318900940939784, 0.009053859859704971, 0.05272456631064415, -0.013813313096761703, -0.010768716223537922, -0.001138998894020915, -0.021363040432333946, 0.011088435538113117, 0.00874867383390665, -0.008312693797051907, 0.009584303013980389, -0.00048048674943856895, 0.006216354202479124, 0.0176426749676466, 0.009082925505936146, 0.04781251773238182, -0.0031608580611646175, 0.0006203638040460646, 0.00809470284730196, 0.013769715093076229, 0.012687030248343945, 0.008494351990520954, -3.184700835845433e-05, -0.006924822460860014, -0.0176717396825552, 0.03452964872121811, 0.008138300850987434, 0.012825090438127518, -0.003066395642235875, 0.0015014075906947255, 0.020694537088274956, 0.04621392488479614, -0.03441338613629341, -0.006285384297370911, 0.00846528634428978, 0.008588814176619053, -0.005395257845520973, 0.00951163936406374, 0.019895240664482117, 0.00014078534150030464, -0.002125404542312026, -0.008574281819164753, 0.007920310832560062, -0.0247200895100832, 0.039645154029130936, -0.009250051341950893, -0.0005708618555217981, -0.012316446751356125, -0.0045087640173733234, 0.0023052464239299297, 0.008189165964722633, -0.018093187361955643, -0.02877470850944519, 9.97986426227726e-05, 0.01685790903866291, -0.00684852572157979, 0.005173634272068739, -0.009911288507282734, -0.004686789587140083, 0.01826757937669754, 0.01122649572789669, -0.011756938882172108, 0.015273847617208958, 0.006652334704995155, 0.043975893408060074, -0.010434464551508427, 0.017758935689926147, 0.007876712828874588, -0.006910289637744427, -0.01263616606593132, -0.007825848646461964, 0.0056241475977003574, 0.04409215226769447, -0.006746796891093254, -0.010034816339612007, -0.0029501342214643955, -0.004011020064353943, 0.01695963740348816, -0.007164611481130123, 0.0069938525557518005, 0.005584182683378458, 0.001684882678091526, 0.001359713962301612, 0.009533438831567764, 0.011023038066923618, -0.007869446650147438, -0.0420866422355175, -0.006223620381206274, 0.030722087249159813, -0.01613127626478672, -0.02027308940887451, -0.0028611214365810156, -0.027815550565719604, -0.009475307539105415, 0.0006603286601603031, -0.02043294906616211, -0.015157585963606834, -0.013900509104132652, -0.0005940233240835369, 0.024938080459833145, 0.005780373699963093, 0.02881830558180809, -0.012490838766098022, 0.006873957812786102, -0.015622631646692753, -0.015012258663773537, 0.04513850435614586, 0.0067903948947787285, -0.0025177868083119392, -0.01695963740348816, -0.00494837760925293, 0.004759452771395445, 0.056561194360256195, 0.029370548203587532, 0.007847647182643414, 0.0006412545335479081, 0.015593566000461578, -0.035430677235126495, 0.006539706140756607, -0.027641158550977707, -0.022874439135193825, -0.014590810984373093, -0.006107359193265438, 0.026202423498034477, -0.02528686448931694, 0.03237881138920784, 0.024879949167370796, 0.014874198473989964, -0.014954128302633762, -9.633577428758144e-05, 0.0032898355275392532, -0.0024106083437800407, 0.01443095225840807, -0.0008492534980177879, 0.04415028542280197, -0.02175542339682579, 0.008327226154506207, 0.012934085913002491, 0.01678524538874626, 0.0047158547677099705, 0.020810797810554504, 0.0024996211286634207, 0.011262827552855015, -0.02393532544374466, -0.016436461359262466, -0.010347268544137478, -0.005206333007663488, 0.00651064096018672, -0.013529925607144833, 0.007905778475105762, -0.007992974482476711, -0.013471795246005058, 0.004261708818376064, 0.00664870161563158, 0.016625387594103813, -0.011807803064584732, 0.009220985695719719, 0.016029546037316322, 0.015172118321061134, 0.012243783101439476, -0.03284385800361633, -0.05185260623693466, -0.016334732994437218, -0.012178386561572552, -0.0005536043317988515, -0.02326682209968567, 0.01677071303129196, -0.009344513528048992, 0.005275363102555275, 0.0016521841753274202, 0.021537432447075844, 0.017046835273504257, 0.023644670844078064, -0.008959397673606873, 0.046010468155145645, -0.019168606027960777, 0.012890487909317017, -0.017846131697297096, -0.013842378742992878, -0.00839262269437313, 0.00838535651564598, -0.024938080459833145, -0.0021017889957875013, 0.0007325379410758615, 0.020026033744215965, -0.030576759949326515, 0.06028155982494354, 0.005311694927513599, 0.0075933258049190044, -0.006645068060606718, 0.015826089307665825, 0.017061367630958557, -0.01818038336932659, 0.023354018107056618, -0.007295405492186546, 0.023601073771715164, 0.020069632679224014, 0.0281643345952034, 0.009584303013980389, 0.015448239631950855, 0.007255441043525934, 0.0045995935797691345, 0.02604256384074688, 0.028571249917149544, 0.008109236136078835, 0.027699289843440056, -0.02674013189971447, -0.02328135445713997, 0.007498863153159618, -0.013646187260746956, -0.020738136023283005, -0.01446728315204382, 0.010129278525710106, -0.03851160407066345, 0.004352537915110588, -0.026216955855488777, -0.008516150526702404, 0.008494351990520954, 0.02877470850944519, -0.011764205060899258, 0.050893448293209076, 0.007113747298717499, 0.003883858909830451, 0.008116502314805984, -0.008261828683316708, -0.013617121614515781, 0.005140936002135277, -0.01909594237804413, -0.018674494698643684, 0.009722363203763962, 0.014103966765105724, 0.011640677228569984, -0.017904262989759445, -0.016596321016550064, -0.0354016087949276, -0.017381086945533752, -0.04688242822885513, -0.011778737418353558, 0.04449906945228577, 0.016450993716716766, -2.3899447114672512e-05, -0.012934085913002491, -0.030634891241788864, -0.015273847617208958, -0.03089647926390171, -0.008588814176619053, 0.0030500462744385004, 0.015869686380028725, -0.017933327704668045, 0.01015834417194128, -0.014539946801960468, -0.02381906285881996, 0.018529167398810387, 0.02394985780119896, 0.01970631442964077, -0.003449695184826851]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
"-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
(a) The partitioning breakdowns found by hier-
archical grid search for KVR-S in Figs. 8 (a-c).
(b)KVR-P with predicted partitions is only
1.1% worse than KVR-S .
(c)KVR-P with predicted partitions is only
1.3% worse than KVR-S .
Figure 10. KVR-P with predicted partitions for 10k and 12k contexts interpolated from the searched breakdowns for Figs. 8 (a-c) has
negligible TTFT degradations from KVR-S , supporting the fact that the proposed lookup method for context partitioning is effective. /
support contiguous physical memory allocation during the
prompt phase to work seamlessly with KV-Runahead.
5. Experimental Results
We used PyTorch 2.0 (Paszke et al., 2019) and NCCL 2.14
to enable KV-Runahead in Huggingface LLaMA 7B and Fal-
con 7B (Touvron et al., 2023; Almazrouei et al., 2023). All
our experiments were done on a single node with 8×NVidia
A100 GPUs, and under high (300GB/s) and low (10GB/s)
bandwidth setups. Note that we turned off the high-speed
CUDA-direct link (NVidia-NCCL, 2023) to configure the
low bandwidth environments.
We used FP16 for the inference. We compared KV-
Runahead with Tensor/Sequence Parallelization ( TSP) (Li
et al., 2023; Shoeybi et al., 2020; Patel et al., 2023). Note
that KV-Runahead is applicable to any LLM with causal
attention and does not alter any task accuracy. For ablation,
we created a few variants of KVR as below.
KVR-E with even context partitioning
KVR-S with searched context partitioning
KVR-P with predicted/interpolated context partitioning
Acceleration: Our results are presented in Figs. 8 and 9 with
multiple context lengths and GPU counts. From Figs. 8 (a-c),
we can see KVR-S (even KVR-E ) consistently outperforms
TSP. And, KVR-S can deliver larger speed up (over 40%)
with longer contexts and more GPUs, and the speedup gain
is even higher on low bandwidth (10GB/s) network as in (e,
f). Also, note that TSP hit the out-of-memory error for 16k
contexts on 2 GPUs, apparently consuming more memory.
Fig. 9 shows the similar results with 8k context lengths, but
speedups are observed only with KVR-S for 4k context.
Fig. 8 (d) compares the scalabilities of TSP, KVR-E , and
KVR-S against two lower bounds: TTFT (p)is the same
asKVR-S without any communication (so practical lower
bound), and TTFT∗(p)is from Eq. (3) (so theoretical lower
bound), which leads to the following observations:•TTFT∗(p)is very tight to TTFT (p), until the non-
parallelizable parts become dominant, like on 8 GPUs.
•KVR-S gets much closer than TSP toTTFT (p).
•KVR-S is up to 17% away from TTFT (p)in our tests.
More results with other smaller/bigger LLMs and shorter/-
longer contexts are available in Appendix A.
Context-level Partitioning: Fig. 10 (a) discloses the
searched context partitioning for the cases in Figs. 8 (a-c).
In general, we can see the earlier processes need to consume
more contexts, and the later ones consume less, which im-
plies that the wait time for the later processes is less of a
concern for the configuration. We can use these breakdowns
to build a partitioning lookup table, and linearly interpolate
the partitionings for 10k and 14k contexts. For example, we
can interpolate from the breakdowns of 8k and 12k to get
the predicted partitioning for 10k on 4 GPUs, which results
in[0.350,0.255,0.210,0.185] in terms of ratio. And. it can
be done similarly for 12k user contexts as well on 4 and
8 GPUs. According to our results in Figs. 10 (b, c), even
with","[-0.03418538719415665, 0.008437389507889748, 0.05426078662276268, -0.01605759747326374, 0.01154948491603136, -0.019176503643393517, 0.03669140487909317, 0.03061703033745289, -0.003478124737739563, 0.044509101659059525, 0.00905708409845829, 0.045353520661592484, 0.012965931557118893, 0.009799356572329998, 0.01048034057021141, -0.017664719372987747, 0.031461451202631, -0.02993604727089405, -0.02150546759366989, 0.01086169108748436, -0.041785165667533875, -0.049711816012859344, -0.013762682676315308, 0.028328925371170044, -0.0032704246696084738, -0.023616516962647438, -0.00036922088474966586, -0.001177250756882131, 0.016003118827939034, -0.044427383691072464, -0.0029520646203309298, -0.017664719372987747, -0.07964786142110825, -0.05731159448623657, 0.008784690871834755, 0.05371600016951561, -0.00926818884909153, 0.031597647815942764, -0.03244206681847572, 0.03519324213266373, 0.02805653214454651, -0.041485533118247986, -0.1018206924200058, 0.030317397788167, 0.01803245022892952, 0.005979037843644619, -0.0015952044632285833, -0.00712990015745163, -0.04554419592022896, 0.045680392533540726, -0.008348860777914524, 0.015104220248758793, -0.049085311591625214, 0.010221567004919052, -0.022240931168198586, 0.023548418655991554, 0.02868303656578064, -0.030344637110829353, 0.03325924649834633, -0.0010512687731534243, 0.03350440040230751, -0.03862540051341057, 0.029445739462971687, -0.03094390220940113, 0.006026706658303738, 0.005032469984143972, -0.004576210863888264, 0.014504954218864441, 0.03443054109811783, 0.058728042989969254, -0.01958509348332882, 0.029336782172322273, 0.0030984762124717236, -0.0207972452044487, 0.020851723849773407, 0.02729382924735546, 0.036500729620456696, 0.012952311895787716, 0.026912478730082512, -0.001108301104977727, 0.04674272611737251, -0.010364573448896408, 0.055186927318573, 0.03887055441737175, 0.025986341759562492, -0.04796849936246872, -0.008505487814545631, 0.020729146897792816, -0.023303264752030373, -0.010807212442159653, -0.009091133251786232, 0.03211519494652748, -0.0002547304902691394, 0.03249654546380043, 0.0458710677921772, -0.0011840605875477195, 0.023711854591965675, -0.0652654841542244, 0.014368757605552673, 0.04946666210889816, 0.002291510347276926, 0.01593502052128315, 0.025250878185033798, -0.0637400820851326, 0.0645572617650032, 0.0033895967062562704, -0.04227547347545624, 0.0020020923111587763, -0.030453594401478767, -0.018345702439546585, -0.052054401487112045, 0.0029248252976685762, -0.04943942278623581, 0.05682128667831421, 0.012264518067240715, -0.04884015768766403, -0.0738731175661087, -0.005376366898417473, 0.009424815885722637, -0.0022455439902842045, -0.020157119259238243, 0.0070549920201301575, 0.030317397788167, 0.003605809062719345, -0.022622281685471535, -0.02846512198448181, 0.016806678846478462, -0.06553787738084793, 0.021941296756267548, -0.0013602650724351406, 0.0010274342494085431, 0.022649521008133888, 0.05183648690581322, 0.0003104860370513052, -0.024678852409124374, 0.005264004692435265, -0.046688247472047806, 0.011862737126648426, -0.01928546093404293, -0.02541431412100792, -0.04284749925136566, 0.0030780467204749584, 0.016765819862484932, 0.013047649525105953, -0.03552011400461197, 0.027974814176559448, -0.007640637923032045, 0.027021436020731926, -0.03350440040230751, 0.02574118785560131, -0.031978998333215714, -0.05292605981230736, 0.0022251144982874393, -0.006067565642297268, -0.013258754275739193, -0.02914610505104065, -0.03219691291451454, 0.020729146897792816, 0.017201650887727737, -0.01461391244083643, -0.018590858206152916, -0.019898345693945885, 0.06428486853837967, -0.001526254927739501, -0.001057227374985814, -0.008144565857946873, -0.053688760846853256, 0.012407524511218071, -0.08280763030052185, -0.022023014724254608, -0.011168134398758411, -0.04309265315532684, -0.053988393396139145, 0.008702972903847694, 0.04091350734233856, 0.003956515807658434, 0.004031423944979906, 0.00547170452773571, 0.0023800383787602186, -0.027239350602030754, -0.056330978870391846, 0.055622756481170654, 0.004416179843246937, 0.03094390220940113, -0.04025975987315178, 0.014586672186851501, 0.004102927166968584, 0.029200583696365356, -0.03780822083353996, 0.006847291719168425, 0.006925605237483978, 0.019394418224692345, 0.034403301775455475, 0.019149264320731163, 0.000471581268357113, -0.005338912829756737, 0.008049228228628635, 0.034321583807468414, -0.008839169517159462, -0.003415133571252227, 0.01756938174366951, 0.011535865254700184, 0.015703486278653145, -0.053280171006917953, 0.03791717812418938, -0.039687734097242355, -0.017637480050325394, 0.009717638604342937, -0.008355670608580112, -0.007245667278766632, 0.03685484081506729, 0.007695116568356752, 0.024801429361104965, 0.028002053499221802, -0.0022234120406210423, -0.04151277244091034, -0.0699506551027298, 0.04328332841396332, -0.006741739343851805, 0.04992973059415817, 0.038761597126722336, 0.022663140669465065, -0.00444341916590929, 0.022200072184205055, -0.006019896827638149, 0.030453594401478767, 0.02729382924735546, -0.044890452176332474, 0.03865263983607292, -0.013789921998977661, 0.019312700256705284, 0.017923492938280106, -0.023630136623978615, -0.014150843024253845, 0.005124403163790703, -0.07528956979513168, -0.03957877680659294, -0.03309581056237221, -0.018604477867484093, -0.07501717656850815, -0.03358611837029457, 0.011440527625381947, 0.014395996928215027, 0.005716858897358179, 0.006190142594277859, 0.023807192221283913, -0.0046579292975366116, -0.04943942278623581, 0.025945482775568962, 0.009881074540317059, -0.02553689107298851, -0.0411859005689621, -0.08155462145805359, -0.010289665311574936, -0.05175476893782616, 0.006404652260243893, -0.003481529653072357, 0.0046749538742005825, -0.0030474024824798107, -0.025795666500926018, -0.022159213200211525, -0.0014836933696642518, -0.005127808079123497, 0.027075914666056633, -0.006367198191583157, -0.015322134830057621, 0.012230468913912773, 0.006925605237483978, -0.03451225906610489, -0.0676080733537674, 0.03189728036522865, -0.03911570832133293, -0.020810864865779877, -0.03437606245279312, 0.0007558920187875628, -0.011100036092102528, 0.017501283437013626, -0.014586672186851501, -0.025645848363637924, -0.013068079017102718, 0.010255616158246994, 0.024556275457143784, 0.07588883489370346, -0.0192446019500494, 0.009635920636355877, -0.0035615451633930206, 0.014545813202857971, 0.016929257661104202, -0.008941316977143288, -0.046769965440034866, 0.0063127195462584496, -0.027811378240585327, 0.008675733581185341, -0.00506311422213912, 0.019421657547354698, 0.06150645390152931, -0.017215270549058914, -0.005042684730142355, -0.009710828773677349, -0.02243160642683506, 0.02683076076209545, -0.0010265830205753446, 0.014164462685585022, 0.011113655753433704, 0.01740594580769539, 0.018250364810228348, 0.018645336851477623, 0.02104239910840988, -0.060907188802957535, 0.00034283276181668043, -0.021628044545650482, 0.03282341733574867, -0.01904030703008175, 0.01519955787807703, -0.03946981951594353, -0.040613871067762375, 0.05856460705399513, -0.05300777778029442, 0.03208795562386513, -0.03208795562386513, -0.01004451047629118, -0.09936915338039398, -0.004184645134955645, 0.020620189607143402, 0.03592870384454727, 0.009118372574448586, -0.015499191358685493, -0.019925585016608238, 0.006867721676826477, -0.011985315009951591, -0.025754807516932487, 0.02519639953970909, 0.010419052094221115, -0.022254550829529762, -0.05412459000945091, -0.012482432648539543, -0.006322934292256832, 0.010929789394140244, 0.03530219942331314, -0.024746950715780258, -0.09125182777643204, -0.011331570334732533, -0.0027613891288638115, -0.029827089980244637, -0.0041097369976341724, 0.05796533823013306, 0.008914077654480934, -0.039306383579969406, 0.04911255091428757, 0.03039911575615406, 0.009424815885722637, -0.02683076076209545, 0.018168646842241287, -0.026735423132777214, 0.022240931168198586, -0.011542675085365772, 0.015567289665341377, -0.03756306692957878, -0.038135092705488205, 0.001499866833910346, -0.01069144532084465, 0.01593502052128315, 0.018563617020845413, -0.006033516488969326, 0.020075401291251183, 0.02729382924735546, -0.07643362134695053, 0.04175792634487152, 0.023085350170731544, 0.0027852237690240145, 0.037208955734968185, 0.005488729104399681, 0.02096068114042282, -0.042874738574028015, -0.08498677611351013, -0.04208479821681976, -0.0015781798865646124, 0.04516284540295601, 0.023711854591965675, 0.047233033925294876, 0.020143499597907066, 0.007123090326786041, -0.00794708076864481, -0.008566776290535927, 0.03372231870889664, -0.013463049195706844, -0.0016871372936293483, 0.014872686006128788, -0.06962378323078156, -0.008655304089188576, -0.04298369586467743, 0.009717638604342937, 0.00031814712565392256, 0.022622281685471535, -0.02239074744284153, 0.022840196266770363, 0.02461075410246849, -0.012182800099253654, 0.02465161308646202, 0.028710275888442993, -0.020347794517874718, 0.002953767077997327, -0.08046504110097885, -0.01605759747326374, 0.004327652044594288, 0.011726540513336658, -0.01869981549680233, 0.017896253615617752, 0.040314238518476486, 0.0027699016500264406, 0.051264457404613495, -0.043256089091300964, 0.026571987196803093, -0.04600726440548897, 0.05069243162870407, -0.030453594401478767, -0.007735975552350283, 0.04892187565565109, -0.0013926118845120072, 0.0871114432811737, -0.03535667806863785, -0.01978938840329647, -0.042411670088768005, -0.016193794086575508, -0.0017654504626989365, -0.0002664349158294499, 0.02335774339735508, -0.059817615896463394, 0.03660968691110611, -0.02364375628530979, 0.011522245593369007, 0.04145829379558563, 0.07212980091571808, 0.031216297298669815, -0.033858515322208405, 0.013224705122411251, 0.01660238392651081, 0.009669969789683819, -0.002218304667621851, -0.008668923750519753, 0.02313982881605625, -0.0215599462389946, 0.012107891961932182, -0.005035874899476767, -0.04211203753948212, -0.0021331817843019962, -0.006792813073843718, -0.004031423944979906, 0.01465477142482996, -0.0030644270591437817, 0.027307448908686638, 0.03358611837029457, 0.034648455679416656, 0.027947574853897095, -0.014355137944221497, -0.032850656658411026, 0.053443606942892075, -0.009397576563060284, 0.04164896905422211, -0.011753779835999012, 0.021069638431072235, 0.028710275888442993, -0.04903083294630051, -0.014954403974115849, 0.01171973068267107, 0.023030871525406837, 0.03609213978052139, -0.0026915883645415306, 0.028165489435195923, 0.01618017442524433, 0.05254470929503441, -0.011624393053352833, 0.012734396383166313, -0.04581658914685249, -0.04361020028591156, -0.015049741603434086, -0.004351486451923847, -0.02960917539894581, 0.03974221274256706, -0.010323714464902878, 0.03317752853035927, -0.007545300293713808, 0.028437882661819458, 0.03225139155983925, 0.034784652292728424, 0.07757767289876938, 0.04028699919581413, -0.008273952640593052, 0.0007299294811673462, 0.02767518162727356, -0.05921835079789162, -0.012986361049115658, 0.037290673702955246, -0.015689866617321968, -0.007402293849736452, -0.008668923750519753, -0.018713435158133507, 0.016534285619854927, 0.005362747237086296, -0.0021212645806372166, 0.023221546784043312, 0.025468792766332626, 0.026803521439433098, -0.012754825875163078, 0.013932928442955017, 0.026817141100764275, 0.027974814176559448, 0.002182553056627512, -0.0022438415326178074, 0.011440527625381947, -0.0059041292406618595, 0.03355887904763222, 0.007674687076359987, 0.02469247207045555, 0.007899411953985691, 0.018549997359514236, -0.012169180437922478, 0.0056521655060350895, 0.014314278960227966, 0.0033368205185979605, -0.038598161190748215, -0.004412774927914143, -0.02960917539894581, 0.01623465307056904, 0.039687734097242355, -0.011971695348620415, -0.027021436020731926, -0.09179661422967911, -0.03786269947886467, -0.06679088622331619, 0.012904643081128597, -0.0014547515893355012, -0.008559966459870338, -0.012986361049115658, -0.01473648939281702, 0.011937645263969898, 0.04592554643750191, -0.017555762082338333, -0.03475741297006607, -0.0035240910947322845, 0.027688801288604736, 0.008852789178490639, 0.00851229764521122, 0.04412774741649628, -0.0072524771094322205, -0.02527811750769615, 0.048622243106365204, -0.013170226477086544, 0.00532529316842556, -0.009513343684375286, 0.010296475142240524, -0.034403301775455475, 0.022867435589432716, -0.014940784312784672, -0.022663140669465065, -0.00785855296999216, 0.019762149080634117, -0.01195126585662365, -0.018168646842241287, -0.006019896827638149, 0.03505704551935196, 0.021124117076396942, 0.027947574853897095, -0.013517527841031551, -0.011971695348620415, 0.03249654546380043, 0.012870593927800655, -0.00676216883584857, -0.0010810617823153734, 0.009928743354976177, -0.008056038059294224, -0.013680963777005672, 0.028274446725845337, 0.015335754491388798, 0.04687892273068428, -0.05450594052672386, 0.008893648162484169, 0.005386581644415855, 0.02414768561720848, 0.008818740025162697, -0.04420946538448334, 0.009629110805690289, -0.02713039331138134, -0.009901504032313824, 0.002311939839273691, -0.009009415283799171, -0.02210473269224167, -0.0008410149603150785, -0.03451225906610489, 0.005819006357342005, 0.03761754557490349, 0.0025434743147343397, 0.041322097182273865, 0.010854881256818771, -0.007722355891019106, 0.017746437340974808, 0.005189096555113792, -0.025359835475683212, -0.022213691845536232, -0.04519008472561836, 0.002167230937629938, -0.007504441309720278, -0.004562591202557087, -0.03824404999613762, -0.0311073400080204, 0.04633413627743721, -0.03320476785302162, 0.015104220248758793, 0.015417472459375858, -0.003970135468989611, 0.02012987993657589, -0.02243160642683506, -0.04273854196071625, 0.011420098133385181, -0.017474044114351273, -0.017474044114351273, -0.00450811255723238, -0.02477419003844261, 0.0458710677921772, -0.022921914234757423, 0.00521974079310894, -0.0167249608784914, 0.007804074324667454, -0.0025451770052313805, 0.025713948532938957, -0.005342317745089531, 0.012925072573125362, -0.02176424115896225, -0.0334499217569828, 0.02515554055571556, -0.005607901606708765, 0.010078559629619122, 0.02130117267370224, 0.029282303526997566, 0.004283388145267963, 0.0017126741586253047, 0.02700781635940075, 0.012148750945925713, 0.025795666500926018, 0.009990031830966473, 0.01319065596908331, 0.047396469861269, -0.0032023261301219463, -0.03200623765587807, 0.0244881771504879, 0.011052366346120834, -0.005914343986660242, 0.036337293684482574, -0.013490288518369198, -0.03955153748393059, -0.0235211793333292, -0.04058663174510002, 0.025809286162257195, 0.029799850657582283, 0.027402786538004875, -0.0017654504626989365, -0.013258754275739193, -0.020075401291251183, -0.009383956901729107, -0.01094340905547142, -0.020320555195212364, 0.019394418224692345, -0.03132525458931923, -0.02164166420698166, 0.020347794517874718, 0.006370603106915951, 0.019993683323264122, 0.023670995607972145, -0.020851723849773407, 0.008308001793920994, -0.016084836795926094, 0.01819588616490364, 0.03162488713860512, -0.0072524771094322205, 0.027021436020731926, -0.016112076118588448, -0.026694564148783684, -0.00913880206644535, -0.002677968703210354, 0.024678852409124374, -0.02482866868376732, -0.012257708236575127, -0.045680392533540726, 0.010453101247549057, 0.02083810418844223, 0.03135249391198158, -0.003197218757122755, 0.0007580200908705592, 0.028029292821884155, -0.03211519494652748, 0.003052509855479002, -0.009002605453133583, 0.030834944918751717, -0.02142374962568283, 0.0006643848028033972, 0.004055258352309465, -0.022758478298783302, 0.026272354647517204, -0.01236666552722454, -0.005883699748665094, -0.014395996928215027, 0.018454659730196, -0.005046089645475149, 0.013197465799748898, -0.008961746469140053, -0.02096068114042282, -0.01618017442524433, 0.039606016129255295, 0.05731159448623657, -0.050501756370067596, -0.014940784312784672, -0.02180510014295578, -0.026340452954173088, 0.0009772117482498288, -0.02200939506292343, 0.008866408839821815, -0.003067831974476576, -0.009200090542435646, -0.014368757605552673, -0.017051834613084793, -0.04181240499019623, -0.019299080595374107, -0.009029844775795937, -0.004909893032163382, 0.01043948158621788, 0.00945205520838499, -0.0064863706938922405, 0.02599996142089367, 0.023112589493393898, 0.038598161190748215, 0.05491453409194946, 0.01936717890202999, 0.0016879885224625468, -0.023262405768036842, -0.011277091689407825, 0.015131459571421146, -0.04726027324795723, -0.008076467551290989, -0.029827089980244637, 0.010235186666250229, 0.005274219438433647, -0.035492874681949615, -0.004358296282589436, 0.044699776917696, 0.000536274746991694, -0.007075421512126923, 0.013170226477086544, -0.006894960999488831, -0.02650388889014721, -0.0009372039348818362, -0.004974586423486471, 0.012754825875163078, 0.0003770947805605829, -0.024706091731786728, 0.03794441744685173, -0.01339495088905096, 0.004698788281530142, 0.00253155711106956, -0.0010657396633177996, -0.011910405941307545, 0.015335754491388798, 0.01983024738729, 0.006874531507492065, -0.022159213200211525, 0.027144012972712517, 0.03383127599954605, -0.024174924939870834, -0.020483992993831635, -0.0151586988940835, 0.02394339069724083, -0.005509158596396446, 0.008580395951867104, 0.005638545844703913, 0.015008882619440556, 0.041240379214286804, -0.005073328968137503, 0.0014334708685055375, 0.01908116601407528, 0.04012356325984001, 0.035411156713962555, -0.022377127781510353, -0.017977971583604813, -0.011420098133385181, -0.0287647545337677, -0.031679365783929825, -0.02511468157172203, 0.0024651612620800734, -0.01519955787807703, -0.014491334557533264, -0.04382811486721039, -0.03001776523888111, -0.01635723002254963, -0.018182266503572464, 0.019884726032614708, -0.0151586988940835, 0.03320476785302162, -0.02422940358519554, -0.09904228150844574, -0.025904623791575432, 0.03723619505763054, 0.00995598267763853, 0.014287039637565613, -0.019598713144659996, 0.011277091689407825, -0.001083615468814969, 0.012509671971201897, -0.00687793642282486, -0.008457818999886513, -0.028002053499221802, -0.012182800099253654, -0.01605759747326374, -0.02154632657766342, -0.007545300293713808, -0.029364021494984627, 0.014327898621559143, 0.00583943584933877, -0.0691879540681839, -0.017746437340974808, -0.0003292131004855037, 0.01970767043530941, 0.034239865839481354, -0.03208795562386513, -0.015049741603434086, 0.0033589524682611227, -0.03701827675104141, 0.0013415380381047726, 0.02545517310500145, 0.0004464699886739254, -0.030535312369465828, -0.0028567269910126925, 0.012468812987208366, -0.052599187940359116, 0.007592969108372927, -0.031298015266656876, 0.004416179843246937, 0.006040326319634914, -0.0155536700040102, -0.015689866617321968, -0.024174924939870834, 0.014218941330909729, -0.009023034945130348, 0.043174371123313904, -0.04080455005168915, 0.04952114075422287, 0.027770519256591797, -0.004780506249517202, 0.028165489435195923, 0.05932730808854103, -0.02180510014295578, 0.00876426137983799, -0.0014930568868294358, 0.02444731816649437, 0.01823674514889717, -0.03745410963892937, -0.009418006055057049, 0.0009261379600502551, 0.03917018696665764, 0.016071217134594917, 0.02188681811094284, 0.04265682399272919, -0.03404919058084488, -0.05387943610548973, -0.013531147502362728, 0.012965931557118893, 0.02263590134680271, 0.006993703544139862, 0.007095851004123688, -0.018127787858247757, 0.004756671842187643, 0.011161324568092823, -0.009567822329699993, 0.016329990699887276, 0.020661048591136932, -0.010997887700796127, 0.017800915986299515, -0.06363112479448318, 0.005890509579330683, 0.04499940946698189, -0.03745410963892937, 0.027770519256591797, 0.018441040068864822, 0.030371876433491707, -0.0057611227966845036, 0.059054914861917496, -0.028492361307144165, -0.003474719822406769, -0.007334195543080568, 0.026980577036738396, -0.017337847501039505, 0.01278887502849102, 0.004879248794168234, -0.0037658403161913157, 0.03769926354289055, 0.05349808558821678, 0.018468279391527176, 0.00220128009095788, 0.005955202970653772, 0.02482866868376732, 0.024460937827825546, 0.01180144865065813, -0.057257115840911865, -0.0066838557831943035, 0.0005733032012358308, 0.04355572164058685, -0.02402510866522789, 0.03598318248987198, -0.026013581082224846, 0.014436855912208557, 0.02041589468717575, -0.006608947645872831, 0.04328332841396332, -0.027579843997955322, 0.03769926354289055, 0.004623879678547382, -0.0018284415127709508, 0.0006103317136876285, -0.04066834971308708, 0.005080138798803091, 0.03824404999613762, -0.015376613475382328, -0.0019561259541660547, -0.024161305278539658, 0.01597587950527668, 0.0014121901476755738, 0.0250738225877285, 0.009377147071063519, 0.027103153988718987, -0.01823674514889717, 0.01958509348332882, 0.0006831118371337652, -7.87919489084743e-05, -0.00043114786967635155, 0.0017841774970293045, -0.006462536286562681, -0.0035819746553897858, 0.003399811452254653, 0.04009632393717766, 0.007572539616376162, -0.009785736910998821, 0.05357980355620384, 0.017746437340974808, 0.0024123850744217634, 0.017324227839708328, 0.013211085461080074, -0.008328431285917759, 0.000865275040268898, 0.0033947040792554617, 0.004208480007946491, -0.018836012110114098, -0.009227329865098, 0.01461391244083643, 0.005447870120406151, 0.023071730509400368, 0.006585113238543272, -0.00196463824249804, 0.025046583265066147, 0.03056255169212818, -0.015567289665341377, 0.03974221274256706, -0.019258221611380577, 0.013136177323758602, 0.035247720777988434, 0.01098426803946495, 0.012584580108523369, 0.004756671842187643, 0.014123603701591492, 0.02247246541082859, -0.02025245688855648, -0.0357380285859108, 0.036500729620456696, 0.03317752853035927, 0.05238127335906029, 0.032986853271722794, -0.011958075687289238, -0.03639177232980728, 0.0043038176372647285, 0.0239025317132473, -0.013667344115674496, 0.023725474253296852, -0.013987407088279724, -0.007157139480113983, -0.0014130413765087724, -0.009840215556323528, 0.004314032383263111, 0.012012554332613945, -0.013265564106404781, 0.024120446294546127, 0.02192767709493637, 0.025564130395650864, -0.015390233136713505, 0.027974814176559448, -0.002587738446891308, -0.012502862140536308, 4.410434121382423e-05, 0.0155536700040102, -0.026817141100764275, 0.006234406493604183, -0.04608898237347603, 0.04374639689922333, -0.0006575749721378088, -0.015185938216745853, -0.031461451202631, 0.04099522531032562, -0.012427954003214836, -0.02226817049086094, -0.024924006313085556, 0.007388674188405275, 0.015226797200739384, 0.013708203099668026, -0.03086218424141407, 0.00031261410913430154, 0.03061703033745289, -0.00691879540681839, 0.00811732653528452, -0.027280209586024284, -0.009826595894992352, -0.025795666500926018, -0.03170660510659218, -0.008171805180609226, -0.009996841661632061, -0.023589277639985085, -0.014082744717597961, 0.029118865728378296, 0.028274446725845337, -0.015008882619440556, 0.013115747831761837, 0.011964885517954826, -0.017719198018312454, 0.007674687076359987, 0.0016752200899645686, 0.014123603701591492, -0.028165489435195923, -0.03320476785302162, -0.02277209796011448, -0.028873711824417114, -0.025060202926397324, -0.00481115048751235, 0.00676216883584857, -0.012734396383166313, -0.010024080984294415, -0.0032057310454547405, -0.0200073029845953, 0.0014189999783411622, 0.011331570334732533, 0.03530219942331314, 0.009915123693645, 0.015322134830057621, -0.03056255169212818, -0.01551281102001667, 0.03628281503915787, -0.00859401561319828, 0.003146145027130842, 0.004906488116830587, 0.011440527625381947, 0.05412459000945091, 0.023344123736023903, 0.0221728328615427, -0.020306935533881187, -0.013551576994359493, 0.012897833250463009, -0.020347794517874718, 0.005035874899476767, -0.005822411272674799, -0.004286793060600758, -0.012516481801867485, 0.02319430746138096, -0.0016054193256422877, -0.043964311480522156, 0.004395750351250172, -0.007334195543080568, 0.023630136623978615, -0.016956496983766556, 0.004661334212869406, 0.0016241463599726558, 0.0073205758817493916, 0.015431092120707035, 0.0043923454359173775, 0.002034439006820321, -0.00543084554374218, -0.019258221611380577, 0.0018624906660988927, 0.0027681991923600435, -0.013551576994359493, -0.03219691291451454, -0.016793059185147285, 0.0346212163567543, -0.010616537183523178, -0.005161857232451439, 0.015757964923977852, -0.0006745995488017797, 0.009159231558442116, 0.013728633522987366, -0.02059295028448105, -0.008880028501152992, 0.01878153346478939, 0.0005545761669054627, -0.04633413627743721, 0.010459911078214645, -0.029009908437728882, 0.011665252037346363, -0.01073230430483818, 0.017964351922273636, 0.00583943584933877, -0.029009908437728882, -0.007511251140385866, -0.032224152237176895, -0.010548438876867294, 0.010024080984294415, 0.014518573880195618, 0.01016708742827177, 0.03489360958337784, -0.0027409596368670464, 0.001192572875879705, 0.0001786518405424431, -0.039905648678541183, 0.00983340572565794, -0.01150862593203783, 0.0005903278361074626, 0.02775689959526062, 0.017977971583604813, -0.0136060556396842, 0.032605502754449844, -0.021750621497631073, -0.0062207868322730064, 0.014668391086161137, -0.032305870205163956, 0.004412774927914143, -0.0057236687280237675, 0.021859578788280487, 0.007020942866802216, 0.020701907575130463, -0.03554735332727432, 0.01643894799053669, 0.0034662075340747833, -0.004211884923279285, -0.021737001836299896, 0.01195126585662365, 0.033531639724969864, 0.016697721555829048, 0.0017450209707021713, -0.020020922645926476, 0.01289102341979742, 0.0056691900826990604, -0.008348860777914524, 0.012884213589131832, -0.0014470905298367143, 0.004198264796286821, 0.0707678347826004, 0.001811416819691658, 0.0026711588725447655, -0.008192234672605991, -0.027607083320617676, 0.029636414721608162, -0.005992657504975796, -0.02309896983206272, -0.040532153099775314, 0.030998382717370987, -0.007204808294773102, 0.0072184279561042786, -0.016193794086575508, 0.024038728326559067, 0.0003613470180425793, 0.013783112168312073, -0.0155536700040102, 0.030889423564076424, -0.0006699177902191877, -0.010671015828847885, 0.042411670088768005, -0.009077513590455055, 0.0012666297843679786, -0.015063361264765263, 0.002592845819890499, -0.00307123688980937, 0.0010104096727445722, 0.0035240910947322845, 0.0221728328615427, 0.019571473821997643, 0.004923512693494558, -0.020783625543117523, -0.011672061868011951, -0.017514903098344803, 0.008859599009156227, 0.01211470179259777, -0.004293602891266346, 0.03118905797600746, 0.02188681811094284, -0.002938444958999753, -0.006867721676826477, -0.005815601442009211, -0.0010325416224077344, -0.025060202926397324, -0.05355256423354149, -0.010024080984294415, 0.020238837227225304, -0.0014828421408310533, 0.013510718010365963, -0.014477714896202087, 0.01799159124493599, 0.006980083882808685, 0.010766353458166122, 0.026476649567484856, 0.00798793975263834, -0.007722355891019106, 0.016588764265179634, 0.042575106024742126, 0.03140697255730629, 0.02188681811094284, -0.04557143524289131, -0.020116260275244713, -0.022036634385585785, 0.008716592565178871, -0.04412774741649628, -0.02218645252287388, -0.028029292821884155, 0.01528127584606409, -0.023507559671998024, -0.011726540513336658, -0.034784652292728424, -0.007490821648389101, -0.003980350214987993, -0.015294895507395267, 0.01722889021039009, 0.0037488157395273447, -0.007981129921972752, 0.042411670088768005, 0.03778098151087761, 0.004497897811233997, -0.019653191789984703, -0.015826063230633736, -0.03170660510659218, 0.011733350344002247, 0.0030235680751502514, 0.012182800099253654, 0.028900951147079468, -0.008021988905966282, -0.009206900373101234, 0.03857092186808586, -0.023725474253296852, 0.02713039331138134, 0.0023034275509417057, 0.016193794086575508, -0.01912202499806881, -0.01593502052128315, -0.04385535418987274, -0.050174884498119354, 0.006547659169882536, -0.007313766051083803, -0.023466700688004494, -0.012884213589131832, 0.01245519332587719, 0.0014879495138302445, -0.014763728715479374, 0.01765109971165657, -0.037590306252241135, -0.0014487929875031114, 0.02574118785560131, -0.004613664932549, 0.02045675367116928, 0.0029435523319989443, 0.013469859026372433, -0.008403339423239231, -0.006302504800260067, 0.05006592720746994, -0.012530101463198662, 0.024515416473150253, 0.013088508509099483, -0.0077155460603535175, 0.04246614873409271, 0.004079092759639025, 0.0017705578356981277, -0.019258221611380577, -0.02499210461974144, 0.011828687973320484, -0.007014133036136627, -0.020851723849773407, -0.03170660510659218, 0.005573852453380823, -0.018563617020845413, -0.011910405941307545, 0.040314238518476486, -0.0026915883645415306, 0.009635920636355877, 0.05028384178876877, -0.00970401894301176, -0.04415498673915863, 0.0005592579254880548, -0.024556275457143784, -0.003534305840730667, 0.019271841272711754, -0.016711341217160225, -0.014287039637565613, -0.018972208723425865, 0.00017386367835570127, -0.0027443645521998405, -0.006782598327845335, 0.035710789263248444, -0.020742766559123993, 0.00811051670461893, -0.012775255367159843, -0.011181754060089588, 0.011937645263969898, -0.004334461875259876, 0.020184358581900597, -0.030834944918751717, -0.018645336851477623, 0.036718644201755524, -0.0052265506237745285, 0.00202933163382113, -0.0006022450397722423, 0.0029452547896653414, 0.02055209130048752, 0.0497390553355217, -0.05039279907941818, -0.010473530739545822, 0.01511783991008997, 0.020361416041851044, 0.009023034945130348, 0.011181754060089588, 0.020402275025844574, -0.002271080855280161, 0.003396406536921859, -0.029963286593556404, -0.002696695737540722, -0.023030871525406837, 0.030753226950764656, -0.028029292821884155, -0.0052435752004384995, -0.005073328968137503, -0.03396747261285782, 0.013742253184318542, 0.01113408524543047, -0.029118865728378296, -0.013810351490974426, -0.015294895507395267, 0.01803245022892952, 0.01188997644931078, -0.00762020843103528, -0.0002781393122859299, -0.015649007633328438, 0.0019373989198356867, -0.01954423449933529, -0.004542161710560322, 0.03246930614113808, -0.00220128009095788, 0.04712407663464546, -0.022799337282776833, 0.020157119259238243, 0.018059689551591873, 0.004610260017216206, -0.023030871525406837, -0.029418500140309334, -0.007361434865742922, 0.03157040849328041, 0.0027818188536912203, -0.016534285619854927, 0.019694050773978233, -0.005124403163790703, 0.007913031615316868, -0.005927963647991419, 0.0057066441513597965, -0.0033197959419339895, -0.010841261595487595, 3.5725046473089606e-05, 0.003959920722991228, 0.000877617858350277, -0.00029133338830433786, -0.03652796894311905, 0.012720776721835136, 0.021941296756267548, -0.0005192501121200621, -0.04717855527997017, -0.0022795931436121464, -0.030589791014790535, 0.008124136365950108, 0.0015739237423986197, -0.023493940010666847, -0.014981643296778202, -0.008743831887841225, 0.0021416940726339817, -0.00103509530890733, 0.01623465307056904, 0.022526944056153297, -0.01652066595852375, 0.002776711480692029, 0.0002398339711362496, -0.017800915986299515, 0.038679879158735275, 0.005464894697070122, -0.0034236458595842123, -0.003421943401917815, 0.005049494560807943, -0.010916169732809067, 0.029990525916218758, 0.015540050342679024, -0.00470559811219573, 0.004460443742573261, 0.010922979563474655, -0.052817102521657944, 0.010575678199529648, 0.001867598039098084, -0.035329438745975494, -0.0008031352772377431, -0.010977458208799362, 0.02436560019850731, -0.014123603701591492, 0.019516995176672935, 0.020320555195212364, 0.008587205782532692, -0.032142434269189835, -0.0017296988517045975, 0.018209505826234818, 0.0017314013093709946, 0.008982175961136818, -0.00868254341185093, 0.02360289730131626, -0.02985432930290699, 0.016616003587841988, 0.010419052094221115, 0.015485570766031742, -0.005056304391473532, 0.029990525916218758, -0.0007682348368689418, 0.0311073400080204, -0.008328431285917759, -0.011964885517954826, 0.0026183826848864555, -0.005801981780678034, 0.0028414048720151186, -0.011154514737427235, 0.0011372428853064775, 0.00010007269156631082, -0.0074635823257267475, 0.017678339034318924, -0.006452321540564299, 0.012407524511218071, 0.00317678926512599, -0.02164166420698166, 0.003311283653602004, 0.004405965097248554, 0.010643776506185532, -0.026258734986186028, -0.034866370260715485, -0.021273933351039886, -0.005376366898417473, -0.01364691462367773, -0.028356164693832397, -0.00042327397386543453, -0.013898879289627075, 0.002439624397084117, 0.00842376984655857, 0.01761024072766304, 0.017882633954286575, 0.006367198191583157, -0.0016794762341305614, 0.030426355078816414, -0.022240931168198586, 0.015649007633328438, -0.010711874812841415, -0.033613357692956924, -0.017215270549058914, 0.013456239365041256, -0.020579330623149872, -0.009104752913117409, -0.009213710203766823, 0.021491847932338715, -0.020824484527111053, 0.03178832307457924, -0.010112608782947063, 0.011699301190674305, -0.006745144259184599, 0.00913880206644535, 0.034948088228702545, -0.02751174569129944, 0.017201650887727737, 0.0010282854782417417, 0.006530634593218565, -0.0023170472122728825, 0.020851723849773407, -0.00842376984655857, 0.025795666500926018, 0.013810351490974426, 0.016193794086575508, 0.014872686006128788, 0.005073328968137503, 0.012080652639269829, 0.023534798994660378, -0.02628597430884838, -0.007204808294773102, 0.00033942784648388624, 0.0048724389635026455, -0.036119379103183746, -0.022908294573426247, 0.025346215814352036, -0.03639177232980728, -0.001014665816910565, -0.029173344373703003, 0.004787316080182791, -0.007347815204411745, 0.03265998139977455, -0.015376613475382328, 0.057257115840911865, 0.001683732378296554, -0.02373909391462803, 0.011624393053352833, -0.006118639372289181, -0.002276188228279352, 0.02365737594664097, -0.022949153557419777, 0.006779193412512541, 0.004937132354825735, 0.016874779015779495, 0.0026558367535471916, -0.018808772787451744, -0.007313766051083803, -0.04205755889415741, -0.02947297878563404, -0.05240851268172264, -0.026190636679530144, 0.037426870316267014, 0.015962259843945503, 0.00762020843103528, -0.02527811750769615, -0.029118865728378296, -0.013885259628295898, -0.02172338217496872, -0.000583092391025275, 0.0011704409262165427, 0.011610773392021656, -0.007926651276648045, 0.009561012499034405, -0.01593502052128315, -0.04205755889415741, 0.007422723341733217, 0.02335774339735508, 0.014573052525520325, -0.01289102341979742]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
" 4k intervals, KVR-P with predicted partitioning from
interpolation is within 1.3% of the KVR-S cases with the
searched partition configurations and still outperforms TSP.
Point-to-point communication: To understand the bene-
fit of point-to-point asynchronous communication of KVR
over the all-gather operation in TSP, we added a noisy side-
car to generate the bidirectional network traffic between a
random pair of adjacent GPUs (i.e., simulating dynamically
changing non-uniform network bandwidth), averaged out
multiple TTFTs for the 8k, 12k, and 16k context lengths,
and then reported the results in Fig 11. We found that KVR
is much more robust against non-uniform bandwidth among
processes: while TSP degraded the TTFTs over 10% on av-
erage due to non-uniform effective bandwidth, KVR has up
to 3.7% impact on TTFT, clearly demonstrating the benefits
of the communication mechanism in KV-Runahead. Also,
8
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
(a) On a noisy network, KVR-S outperforms
TSP even more (42.2% vs. 43.4%) than the
quiet case in Fig. 8 (b).
(b) On a noisy network, KVR-S outperforms
TSP even more (41.1% vs. 45.8%) than the
quiet case in Fig. 8 (c).
(c) In terms of the TTFT overhead, TSP is
most affected (up to 11.8%), and KVR-E is
least influenced (up to 2.7%).
Figure 11. On a noisy high bandwidth network, KVR-S still outperforms TSP by even wider margin than the case in Figs. 8 (b, c), and
shows high tolerance against the other noisy traffics. Yet, in terms of absolute tolerance, KVR-E appears to be the best.
KVR-S is tuned to the quiet environment, but still outper-
forms TSP thanks to the point-to-point communication.
6. Conclusion
In this work, we propose an efficient parallel LLM infer-
ence technique, KV-Runahead, to minimize the time-to-
first-token. With the proposed techniques, we observed over
60% speedup in the first token generation over the exist-
ing parallelization schemes and higher robustness against a
non-uniform bandwidth environment.
7. Impact Statements
This paper presents work whose goal is to advance the field
of Machine Learning. There are many potential societal
consequences of our work, none which we feel must be
specifically highlighted here.
References
Agrawal, A., Panwar, A., Mohan, J., Kwatra, N., Gulavani,
B. S., and Ramjee, R. Sarathi: Efficient llm inference by
piggybacking decodes with chunked prefills, 2023.
Ainslie, J., Lee-Thorp, J., de Jong, M., Zemlyanskiy, Y .,
Lebr ´on, F., and Sanghai, S. Gqa: Training generalized
multi-query transformer models from multi-head check-
points, 2023.
Almazrouei, E., Alobeidli, H., Alshamsi, A., Cappelli, A.,
Cojocaru, R., Debbah, M., Goffinet, E., Heslow, D., Lau-
nay, J., Malartic, Q., Noune, B., Pannier, B., and Penedo,
G. Falcon-40B: an open large language model with state-
of-the-art performance. 2023.
Chen, C., Borgeaud, S., Irving, G., Lespiau, J.-B., Sifre,
L., and Jumper, J. Accelerating large language model
decoding with speculative sampling, 2023.Cho, M., Vahid, K. A., Fu, Q., Adya, S., Mundo, C. C. D.,
Rastegari, M., Naik, D., and Zatloukal, P. edkm: An
efficient and accurate train-time weight clustering for
large language models. 2023.
Dao, T., Fu, D. Y ., Ermon, S., Rudra, A., and R ´e, C. Flashat-
tention: Fast and memory-efficient exact attention with
io-awareness. Advances in Neural Information Process-
ing Systems , 2022.
Dong,","[-0.01913585513830185, 0.012990779243409634, 0.02301849238574505, -0.02043493278324604, -0.0021748607978224754, -0.007838256657123566, 0.002778786001726985, 0.040140047669410706, -0.030769171193242073, 0.03252073749899864, 0.02081443928182125, 0.02741200290620327, -0.02862350270152092, 0.01247260719537735, -0.003630849765613675, -0.03415553271770477, 0.0018646876560524106, -0.02949928678572178, 0.007407663390040398, 0.0070682973600924015, -0.03126544877886772, -0.03363006189465523, 0.0034137286711484194, 0.024755463004112244, 0.045482322573661804, -0.020799843594431877, 0.005955323576927185, 0.023266632109880447, -0.0068530007265508175, -0.07917077094316483, 0.013362986966967583, -0.029776617884635925, -0.05838552489876747, -0.07146388292312622, 0.007436856161803007, 0.07321544736623764, 0.019617535173892975, 0.025645840913057327, -0.02757256291806698, -0.0012981656473129988, 0.017661621794104576, -0.06124641373753548, -0.05637122318148613, 0.03041885793209076, -0.013377583585679531, 0.02039114385843277, 0.003922777250409126, -0.023047685623168945, -0.014961290173232555, 0.048781104385852814, -0.019281819462776184, 0.003621726995334029, -0.06539178639650345, -0.0021529661025851965, -0.03905991464853287, 0.003685586154460907, 0.0334257110953331, -0.02963065356016159, 0.04288416728377342, -0.01253829151391983, 0.019121259450912476, -0.05494077876210213, 0.008925686590373516, -0.002729523228481412, -0.037425119429826736, -0.003962917253375053, -0.017997337505221367, 0.004057793878018856, 0.00485694594681263, 0.04571586474776268, -0.019734306260943413, 0.033454906195402145, 0.03622821718454361, -0.02126692794263363, -0.009575226344168186, 0.005918832495808601, -0.029397111386060715, 0.04930657520890236, 0.008385621011257172, -0.011210020631551743, 0.014465013518929482, -0.006086690817028284, 0.0358487106859684, -0.004780314862728119, -0.002145668026059866, -0.0659172534942627, -0.025251738727092743, -0.0005418906221166253, -0.03459342196583748, -0.010056906379759312, -0.028229400515556335, 0.029221953824162483, -0.011925242841243744, 0.035585977137088776, 0.06749366223812103, 0.03400956839323044, 0.035994675010442734, -0.04977365955710411, 0.023602347820997238, 0.034418266266584396, 0.0021803344134241343, 0.015603531152009964, 0.013501652516424656, -0.03538162633776665, 0.06358183920383453, -0.007612012792378664, -0.03488535061478615, 0.019588343799114227, 0.000570171105209738, 0.00965550635010004, -0.09038078784942627, -0.008765126578509808, -0.045569900423288345, 0.021704819053411484, 0.013151339255273342, -0.08751989901065826, -0.05607929453253746, -0.017486464232206345, 0.006021006964147091, -0.002773312386125326, -0.029572267085313797, 0.023339612409472466, 0.022493023425340652, -0.00445189606398344, -0.021865379065275192, -0.029805809259414673, 0.023894276469945908, -0.054094187915325165, -0.006998964585363865, -0.004367967136204243, -0.005251048132777214, -0.004105232190340757, 0.04031520336866379, 0.010421816259622574, -0.012231767177581787, -0.027645545080304146, -0.06381537765264511, 0.014070911332964897, -0.02620050311088562, 0.008582672104239464, -0.012516397051513195, -0.02415701001882553, -0.01725292205810547, 0.025850189849734306, -0.04057794064283371, 0.010677252896130085, -0.029353322461247444, 0.023660734295845032, -0.017033977434039116, 0.009743084199726582, -0.022551408037543297, -0.009910942986607552, -0.005418906453996897, 0.018376844003796577, -0.0343598797917366, -0.05318921059370041, -0.03304620832204819, 0.058735836297273636, 0.021427487954497337, -0.028448347002267838, -0.018201686441898346, 0.028185611590743065, 0.04031520336866379, 0.024726269766688347, 0.000897677440661937, -0.0058859908021986485, -0.04956930875778198, 0.012450712732970715, -0.07876206934452057, -0.04484008252620697, 0.0068785445764660835, -0.042066771537065506, -0.03885556757450104, 0.010107994079589844, 0.004430001601576805, -0.03260831534862518, -0.016318753361701965, -0.026507027447223663, 0.010808619670569897, -0.06533340364694595, -0.03552759066224098, 0.053335174918174744, -0.0016676365630701184, 0.0242007989436388, -0.040431976318359375, 0.0005085926386527717, -0.0036472706124186516, 0.04691276699304581, -0.023325016722083092, 0.054473694413900375, -0.00031838356517255306, 0.04437299817800522, 0.03847606107592583, 0.04463573172688484, 0.0055283792316913605, 0.010188274085521698, 0.012166083790361881, 0.017822181805968285, -0.023266632109880447, 0.0027349968440830708, 0.014012525789439678, 0.006546476855874062, -0.008013413287699223, -0.07835337519645691, 0.027222249656915665, -0.05882341414690018, 0.01331189926713705, 0.011319493874907494, -0.02812722697854042, -0.007258050609380007, 0.03360087051987648, 0.020829034969210625, 0.06445761770009995, -0.000587960472330451, -0.009779575280845165, -0.009465753100812435, -0.053714681416749954, 0.028054244816303253, -0.0053130825981497765, 0.03958538547158241, 0.026463238522410393, 0.02929493598639965, -0.01080132182687521, 0.013866562396287918, -0.010232063010334969, 0.03701642155647278, 0.006360372994095087, -0.03844686597585678, 0.04784693568944931, -0.023602347820997238, 0.045657478272914886, 0.005703535862267017, 0.015224025584757328, -0.027353618294000626, -0.009794171899557114, -0.04539474472403526, 0.0023098771926015615, -0.025893980637192726, 0.004382563289254904, -0.0726899802684784, -0.006535529624670744, 0.010808619670569897, 0.015705706551671028, 0.01337028481066227, -0.01985107734799385, 0.051174912601709366, -0.023792101070284843, -0.055349476635456085, 0.039643771946430206, 0.028185611590743065, -0.02256600558757782, -0.016056019812822342, -0.08354968577623367, 0.015078061260282993, -0.03643256798386574, -0.004973717033863068, -0.01621657982468605, 0.008911090902984142, -0.009283298626542091, 0.006783667951822281, -0.017413482069969177, -0.016815030947327614, -0.005320380907505751, 0.02110636606812477, -0.01709236204624176, -0.01863957941532135, 0.014428522437810898, 0.016347946599125862, 0.002364613814279437, -0.02725144289433956, 0.02992258034646511, -0.02411322109401226, -0.009268702007830143, -0.029178164899349213, -0.029864195734262466, -0.016946397721767426, 0.02779150940477848, 0.016245771199464798, -0.023675329983234406, 0.0006860299035906792, 0.017690813168883324, 0.030564822256565094, 0.08652734756469727, -0.022011343389749527, -0.014443119056522846, 0.018770946189761162, -0.002207702724263072, 0.002618225757032633, -0.03363006189465523, -0.04329286515712738, 0.019909463822841644, 0.003658218076452613, -0.0013930421555414796, -0.009297894313931465, 0.03689965233206749, 0.02754337154328823, 0.023938065394759178, 0.027776913717389107, -0.005707184784114361, -0.03923507034778595, 0.05745135620236397, 0.009910942986607552, 0.011304897256195545, 0.011363282799720764, -0.02055170387029648, 0.039643771946430206, 0.0035706397611647844, -0.009312490932643414, -0.03552759066224098, -0.0031309237238019705, -0.021792396903038025, -0.01655229553580284, -0.01395414024591446, 0.02624429389834404, -0.03698723018169403, -0.055437054485082626, 0.04898545518517494, -0.06311475485563278, 0.051291681826114655, -0.028594309464097023, -0.01985107734799385, -0.06726012378931046, -0.010472903028130531, 0.008254253305494785, 0.03619902580976486, 0.0038716900162398815, -0.002333596348762512, -0.021033385768532753, -0.006798264570534229, -0.02206972800195217, -0.003743971697986126, 0.04434380680322647, 0.02110636606812477, -0.021427487954497337, -0.06521663069725037, -0.02227407693862915, -0.046328913420438766, 0.004389861598610878, 0.040431976318359375, 0.0036126042250543833, -0.07444154471158981, -0.00403225002810359, -0.018624981865286827, 0.004984664265066385, 0.03818413242697716, 0.052167464047670364, 0.020756054669618607, -0.01763242855668068, 0.05067863315343857, 0.03538162633776665, 0.01435554027557373, -0.0242007989436388, 0.04326367378234863, 0.0007872923160903156, 0.013757089152932167, -0.007546328939497471, -0.004035899415612221, -0.022376252338290215, -0.021923763677477837, 0.007239805068820715, -0.024682480841875076, 0.034447457641363144, 0.010268554091453552, 0.008225060999393463, -0.00854618102312088, -0.0031126781832426786, -0.05318921059370041, 0.03135302662849426, -0.02193836122751236, -0.02938251569867134, 0.03217042237520218, 0.044694118201732635, 0.009764978662133217, -0.02574801631271839, -0.04629972204566002, -0.015121851116418839, 0.01579328440129757, 0.04472330957651138, 0.0358487106859684, 0.06562533229589462, 0.0300101600587368, 0.0043935105204582214, -0.002452191896736622, -0.026842745020985603, 0.008181271143257618, 0.007955027744174004, -0.0013127620331943035, -0.007119384594261646, -0.04238789156079292, 0.01291049923747778, -0.022098921239376068, 0.0057108341716229916, -0.04580344259738922, 0.03179091960191727, 0.004937225952744484, 0.022347059100866318, -0.007845554500818253, -0.0028554170858114958, 0.04755501076579094, 0.04629972204566002, -0.01232664380222559, -5.824298204970546e-05, -0.0527513213455677, 0.0037366736214607954, 0.010830515064299107, 0.035702746361494064, 0.009750382043421268, 0.029280340299010277, 0.033454906195402145, 0.035585977137088776, 0.033367328345775604, -0.04691276699304581, 0.02582099847495556, -0.056166872382164, 0.018668770790100098, -0.015486760064959526, 0.01926722377538681, 0.027601756155490875, 0.009188422001898289, 0.07934592664241791, -0.014552592299878597, -0.0005779254715889692, -0.06229735538363457, -0.04478169605135918, -0.027689334005117416, -0.006958824582397938, 0.01395414024591446, -0.06352344900369644, 0.05774328485131264, -0.039643771946430206, -0.02707628719508648, 0.010312343016266823, 0.05453208088874817, 0.003298782045021653, -0.022493023425340652, -0.014910203404724598, 0.029221953824162483, 0.019165048375725746, -0.008122885599732399, -0.0090862475335598, -0.000843853282276541, -0.019544554874300957, -0.04308851808309555, 2.3818898625904694e-05, -0.035790327936410904, -0.005853148642927408, -0.029572267085313797, -0.008422112092375755, 0.04288416728377342, -0.015778688713908195, 0.030564822256565094, 0.0007959589129313827, 0.0259085763245821, 0.013910351321101189, -0.02144208364188671, -0.07187257707118988, 0.09090626239776611, -0.01253829151391983, 0.030652400106191635, -0.008363726548850536, 0.009283298626542091, 0.027090882882475853, -0.0697707012295723, -0.015705706551671028, 0.017150748521089554, 0.02620050311088562, 0.0580935962498188, 0.010107994079589844, 0.045949406921863556, 0.02077065035700798, 0.022011343389749527, -0.0305064357817173, -0.02117934823036194, -0.042475469410419464, -0.03862202540040016, 0.0012680606450885534, 0.02352936565876007, -0.03908910974860191, 0.014005227945744991, -0.006382267456501722, 0.020960403606295586, -0.02817101590335369, 0.031236255541443825, 0.023894276469945908, 0.028156418353319168, 0.04977365955710411, 0.036666110157966614, 0.016026826575398445, -0.01479343231767416, 0.04221273213624954, -0.022638987749814987, -0.013800878077745438, 0.057684898376464844, -0.017895163968205452, -0.016231175512075424, 0.009283298626542091, -0.022449234500527382, 0.0018473544623702765, 0.026521624997258186, -0.0450444333255291, 0.017734602093696594, -0.0017433553002774715, 0.018406037241220474, 0.002990433480590582, 0.004579614382237196, 0.03465180844068527, 0.05514512583613396, 0.007268997840583324, -0.006086690817028284, 0.03246235102415085, 0.0004976453492417932, 0.0022332463413476944, 0.023412594571709633, 0.03523566201329231, 0.02239084802567959, 0.02891543135046959, -0.025602051988244057, 0.023762907832860947, 0.0028389960061758757, 0.017690813168883324, -0.0029138026293367147, -0.016158193349838257, -0.03943942114710808, -0.010005819611251354, 0.016070615500211716, -0.018566597253084183, -0.028842449188232422, -0.08932985365390778, -0.04416864737868309, -0.046737611293792725, 0.01426796242594719, -0.0007909414125606418, -0.017398886382579803, -0.012421520426869392, -0.03681207448244095, 0.0034940086770802736, -0.004320528823882341, -0.04025682061910629, -0.014457715675234795, 0.005962621420621872, 0.006072094663977623, 0.021471276879310608, 0.009772277437150478, 0.016727453097701073, -0.0024266482796519995, -0.01875634863972664, 0.06288120895624161, -0.03360087051987648, -0.02160264365375042, 0.007166822906583548, 0.030243702232837677, -0.034038759768009186, 0.014647467993199825, -0.023470981046557426, -0.010750235058367252, -0.002019774168729782, 0.006075743585824966, 0.0005902411649003625, -0.01312214694917202, -0.014917501248419285, 0.028842449188232422, 0.005207258742302656, -0.0025032793637365103, -0.00954603310674429, -0.02474086545407772, 0.00191212585195899, 0.017311308532953262, -0.03689965233206749, 0.012793728150427341, 0.018697964027523994, -0.025047389790415764, -0.012523694895207882, 0.017938952893018723, -0.005637852009385824, 0.0358487106859684, -0.04478169605135918, -0.005101435352116823, 0.009962029755115509, 0.01998244598507881, 0.029221953824162483, -0.04408106952905655, -0.003203905653208494, -0.024084027856588364, 0.005703535862267017, -0.03949780762195587, 0.00434607220813632, -0.004926278721541166, -0.0006139602628536522, -0.034622617065906525, 0.012319345958530903, 0.05640041455626488, -0.014676661230623722, 0.008305341005325317, -0.03847606107592583, -0.019281819462776184, 0.010874303989112377, 0.020945806056261063, -0.045073624700307846, -0.022624390199780464, -0.007192366756498814, 0.003001380944624543, 0.008896494284272194, -0.012859411537647247, -0.035994675010442734, -0.017895163968205452, 0.029265744611620903, -0.01926722377538681, 0.011407071724534035, 0.025310125201940536, -0.018333055078983307, 0.0074259089305996895, -0.027514178305864334, -0.011487351730465889, -0.018960699439048767, -0.03978973627090454, -0.0033462203573435545, -0.027426600456237793, -0.02707628719508648, 0.05102894827723503, -0.01259667705744505, -0.006542827934026718, -0.027470389381051064, 0.00639321468770504, -0.01751565746963024, 0.004864243790507317, 0.025003600865602493, 0.008728635497391224, -0.04002327844500542, -0.038388483226299286, -0.0007909414125606418, -0.020420337095856667, 0.0008329059928655624, 0.009020563215017319, 0.005659746937453747, 0.0031710637267678976, 0.00368193699978292, 0.008312638849020004, -0.00503575149923563, 0.02812722697854042, -0.012151487171649933, 0.018449826166033745, 0.03310459107160568, 0.010421816259622574, -0.002289807191118598, 0.0319952666759491, -0.006345776841044426, 0.010210168547928333, 0.02949928678572178, -0.018522808328270912, -0.028842449188232422, -0.029557671397924423, -0.045190393924713135, 0.038125745952129364, 0.030856749042868614, 0.04378914460539818, -0.006586616858839989, 0.015895459800958633, -0.02736821398139, 0.0035542186815291643, -0.014961290173232555, -0.01278642937541008, 0.025266336277127266, -0.03187849745154381, 0.01178657729178667, 0.0017168993363156915, 0.02119394578039646, 0.03173253312706947, 0.04571586474776268, -0.0006801001145504415, -0.01379358023405075, -0.019909463822841644, -0.018697964027523994, 0.02566043846309185, -0.011341388337314129, 0.007560925558209419, -0.03126544877886772, -0.004521228838711977, -0.0181433018296957, -0.007517136167734861, 0.028229400515556335, -0.05429853871464729, 0.004024952184408903, -0.06708496809005737, -0.014078209176659584, -0.003537797834724188, 0.025499878451228142, 0.026302678510546684, -0.00673987902700901, 0.031528182327747345, -0.02820020727813244, 0.009670102037489414, -0.01922343298792839, 0.025499878451228142, -0.024054836481809616, -0.004802209325134754, 0.00513792596757412, -0.006787317339330912, 0.03730835020542145, -0.023135263472795486, -0.06042901799082756, 0.0005560308927670121, 0.014567187987267971, -0.028054244816303253, 0.00787474773824215, -0.0244489386677742, -0.01242881827056408, -0.011793876066803932, 0.011728191748261452, 0.05024074390530586, -0.033951181918382645, -0.023514769971370697, -0.019486168399453163, -0.004652596544474363, 0.0015946546336635947, -0.03885556757450104, 0.00510873319581151, 0.013654914684593678, 0.0029502934776246548, -0.008721337653696537, -0.030915135517716408, -0.06031224504113197, 0.025149565190076828, -0.006407811306416988, -0.011290300637483597, 0.01626036874949932, -0.013611124828457832, -0.02949928678572178, 0.037717048078775406, 0.017077766358852386, 0.0288278516381979, 0.028930027037858963, 0.015136446803808212, -4.564219852909446e-05, -0.05193392187356949, 0.0005318556213751435, 0.008721337653696537, -0.049160610884428024, -0.011304897256195545, -0.03672449290752411, -0.0056123086251318455, -0.005783815868198872, -0.03996489197015762, 0.0055867647752165794, 0.060195475816726685, -0.018610386177897453, 0.00458691269159317, 0.024828443303704262, 0.0015234972815960646, -0.01633335091173649, -0.005842201411724091, -0.021748607978224754, 0.01493939571082592, 0.014173085801303387, 0.009998520836234093, 0.025061985477805138, -0.015194832347333431, 0.014231471344828606, -0.006783667951822281, -0.01084511075168848, -0.018581192940473557, 0.0016165492124855518, 0.0059845163486897945, -0.004641649313271046, 0.02736821398139, 0.03450584411621094, 0.015603531152009964, 0.0003681024827528745, -0.026930322870612144, -0.022449234500527382, 0.029528478160500526, 0.0036965333856642246, -0.010166379623115063, -0.00027938385028392076, 0.009407367557287216, 0.030739977955818176, -0.006495389621704817, -0.006703387945890427, 0.028229400515556335, 0.015530548989772797, 0.023456383496522903, -0.01650850661098957, -0.03117786906659603, -0.03079836443066597, -0.03030208684504032, -0.01734049990773201, -0.04046116769313812, -0.03555678576231003, 0.0054955375380814075, -0.007196015678346157, -0.03652014583349228, -0.0343598797917366, -0.005459046456962824, -0.0053386264480650425, 0.01312214694917202, -0.012895902618765831, 0.04390591382980347, -0.015588934533298016, -0.09849637746810913, -0.03380521759390831, 0.0353524349629879, 0.00548459030687809, 0.03952699899673462, -0.014654766768217087, 0.013260812498629093, 0.00940006971359253, 0.017223728820681572, -0.022784950211644173, 0.009181123226881027, -0.020288970321416855, -0.018041126430034637, -0.01132679171860218, 0.009743084199726582, -0.04533635824918747, -0.007232506759464741, -0.015413777902722359, 0.03222880885004997, -0.03456423059105873, 0.003809655550867319, 0.009115439839661121, 0.02303308993577957, 0.04848917946219444, -0.0044336505234241486, -0.008735934272408485, 0.011720893904566765, -0.0227703545242548, -0.007809063885360956, 0.02135450579226017, -0.02151506580412388, -0.03184930235147476, 0.009195719845592976, 0.043935105204582214, -0.0460369847714901, 0.020084619522094727, -0.02272656559944153, -0.02368992567062378, 0.0016639874083921313, -0.017311308532953262, -0.014844519086182117, -0.04670841991901398, 0.02606913633644581, -0.007130332291126251, 0.054006610065698624, -0.018318457528948784, 0.03978973627090454, -0.0015855318633839488, 0.02339799888432026, 0.015807880088686943, 0.016245771199464798, -0.00034848859650082886, 0.007159525062888861, 0.00871403981000185, -0.0005104172159917653, 0.01666906662285328, -0.010545885190367699, 0.02030356600880623, 0.004313230514526367, 0.0242007989436388, -0.008152078837156296, 0.025499878451228142, 0.01989486813545227, -0.017077766358852386, -0.017603235319256783, -0.008108289912343025, -0.0040869866497814655, 0.03961457684636116, 0.0025507176760584116, -0.029645249247550964, -0.007823660038411617, 0.0227703545242548, 0.016946397721767426, 0.006163321901112795, 0.033571675419807434, 0.012589378282427788, 0.00687489565461874, 0.023938065394759178, -0.07613472640514374, 0.028083436191082, 0.0469711534678936, -0.055057547986507416, 0.012757237069308758, -0.008925686590373516, 0.023003896698355675, 0.019121259450912476, 0.04086986556649208, -0.018770946189761162, -0.0068785445764660835, 0.022595196962356567, 0.05508674308657646, -0.023675329983234406, 0.012567483820021152, 0.003154642879962921, 0.00611223466694355, 0.026185907423496246, 0.031236255541443825, 0.011793876066803932, 0.014158489182591438, -0.009509542025625706, 0.030389664694666862, 0.04729227349162102, -0.030243702232837677, -0.03844686597585678, -0.016917206346988678, 0.01951536163687706, 0.010056906379759312, 0.013472459279000759, 0.04089906066656113, -0.02101878821849823, 0.013406775891780853, 0.016479313373565674, -0.01228285487741232, 0.03465180844068527, -0.03088594228029251, 0.026652991771697998, 0.007757976651191711, 0.004488387145102024, -0.0025653140619397163, -0.009465753100812435, -0.00029147148597985506, 0.04326367378234863, -0.03427230194211006, -0.012801025994122028, -0.012749939225614071, -0.011560333892703056, 0.012874008156359196, 0.015851669013500214, -0.01796814426779747, -0.0037585680838674307, 0.006152374669909477, 0.005776517558842897, 0.0006951526156626642, -0.005163469817489386, -0.01758863963186741, -0.0004620666732080281, -0.011626017279922962, 0.023543963208794594, -0.01805572398006916, 0.05391903221607208, 0.01599763333797455, -0.015895459800958633, 0.02974742464721203, 0.01253829151391983, 0.013764386996626854, -0.0011613245587795973, -0.001409463002346456, -0.010976478457450867, 0.0008415725897066295, 0.008582672104239464, 0.016537699848413467, -0.0234855767339468, 0.002315351041033864, 0.024463534355163574, -0.011903348378837109, 0.020624686032533646, -0.011801173910498619, -0.02644864283502102, -0.009166527539491653, 0.05637122318148613, 0.016158193349838257, 0.02640485391020775, -0.022974703460931778, 0.0031309237238019705, 0.0358487106859684, -0.01976349949836731, -0.017398886382579803, -0.023164456710219383, 0.006893140729516745, 0.022303270176053047, -0.017150748521089554, -0.015983037650585175, 0.02030356600880623, 0.02611292526125908, 0.05135006830096245, 0.03730835020542145, -0.006013709120452404, -0.024011047556996346, 0.025441491976380348, 0.03389279544353485, 0.011574930511415005, 0.007487943395972252, -0.014698555693030357, -0.01821628399193287, 0.019705114886164665, -0.00681286072358489, -0.003428325057029724, -0.0012808324536308646, -0.024127818644046783, 0.025222545489668846, 0.009473050944507122, 0.03494373708963394, -0.007407663390040398, 0.05219665914773941, 0.00458691269159317, -0.032491542398929596, 0.013589230366051197, 0.0353524349629879, -0.023091474547982216, -0.0009250456350855529, -0.029032202437520027, 0.036374181509017944, -0.0012443414889276028, -0.01763242855668068, -0.02411322109401226, 0.031323835253715515, -0.008371024392545223, -0.013209724798798561, -0.01967592164874077, 0.018566597253084183, -0.004342423286288977, 0.027222249656915665, -0.02574801631271839, 0.02272656559944153, 0.007440505083650351, -0.01839143969118595, 0.009567927569150925, -0.020741457119584084, -0.040694709867239, -0.019208837300539017, -0.03657853230834007, -0.0023536663502454758, -0.0009150106343440711, 0.008195867761969566, -0.02653622068464756, 0.014764239080250263, 0.010035011917352676, -0.029762020334601402, 0.005922481417655945, 0.013567335903644562, -0.009312490932643414, 0.007998816668987274, -0.0015134622808545828, -0.009151930920779705, -0.009852557443082333, -0.005189013667404652, -0.013501652516424656, -0.0234855767339468, -0.022887125611305237, 0.005247398745268583, 0.017077766358852386, -0.0069369301199913025, 0.010939987376332283, 0.0020526160951703787, -0.008889196440577507, -0.014486907981336117, 0.04008166119456291, 0.0324331596493721, 0.006725282408297062, 0.0005163470050320029, -0.012187978252768517, -0.003110853722319007, 0.01412199903279543, 0.01630415767431259, 0.001979634165763855, 0.0007111174636520445, 0.008458603173494339, 0.06615079939365387, 0.026652991771697998, 0.03698723018169403, -0.015092657878994942, 0.00011597280536079779, -3.612034197431058e-05, -0.010823216289281845, 0.00468908715993166, -0.033542484045028687, -0.01259667705744505, -0.0031491692643612623, 0.01034153625369072, 0.012414221651852131, -0.02933872491121292, 0.01431175135076046, 0.002016125014051795, 0.028054244816303253, -0.006933281198143959, 0.003191133728250861, -0.00833453331142664, -0.014961290173232555, 0.011618719436228275, -0.0013209724565967917, -0.00378776085563004, -0.027937473729252815, -0.02644864283502102, -0.007823660038411617, 0.001952265971340239, -0.011961733922362328, -0.02958686463534832, -0.013706001453101635, 0.0314989909529686, -0.014618275687098503, 0.002625524066388607, 0.02498900517821312, 0.015165640041232109, -0.0014897431246936321, -0.005119680427014828, -0.013063761405646801, 0.0042876871302723885, -0.016727453097701073, 0.019486168399453163, -0.05832713842391968, 0.024507323279976845, 0.012246363796293736, 0.035294048488140106, 0.004966418724507093, 0.021427487954497337, 0.02532472088932991, -0.026302678510546684, -0.022157305851578712, -0.025893980637192726, -0.009648207575082779, -0.009743084199726582, 0.0244489386677742, 0.01379358023405075, 0.010370728559792042, -0.02669678069651127, -0.013187830336391926, 0.00015337603690568358, -0.03380521759390831, 0.023704523220658302, -0.003703831695020199, -0.004820454865694046, -0.00023559470719192177, 0.017997337505221367, -0.001338305650278926, 0.0036199025344103575, -0.019924059510231018, 0.01228285487741232, 0.003258642042055726, -0.011494649574160576, 0.014092805795371532, 0.025587456300854683, 0.006229005753993988, 0.023719118908047676, 0.01604142226278782, -0.0372791588306427, 0.01285211369395256, -0.001813600305467844, -0.003860742785036564, -0.0007877484313212335, -0.010093397460877895, 0.048868682235479355, 0.030739977955818176, 0.007422259543091059, -0.0018427930772304535, -0.004816805943846703, 0.009509542025625706, 0.0028262243140488863, 0.02431757003068924, -0.005382415372878313, -0.012946990318596363, 0.07858691364526749, -0.007181419525295496, 0.0029959070961922407, 0.004367967136204243, -0.03941022977232933, 0.028930027037858963, -0.025791805237531662, -0.0066632479429244995, -0.019150452688336372, 0.029849600046873093, -0.008794319815933704, 0.013691405765712261, -0.021091770380735397, 0.008495093323290348, 0.0019431432010605931, -0.006210760213434696, -0.0030761873349547386, 0.017486464232206345, -0.016289561986923218, 0.006710686255246401, 0.03284185752272606, 0.016026826575398445, -0.0102831507101655, -0.020697668194770813, -0.011771981604397297, 0.00891838874667883, -0.0037093053106218576, 0.01675664447247982, 0.020405741408467293, 0.035790327936410904, 0.010976478457450867, -0.02586478739976883, -0.01855199970304966, -0.0016548646381124854, 0.003486710600554943, 0.01993865706026554, -0.021500470116734505, 0.02615671418607235, 0.0010217466624453664, -0.00760471448302269, 0.02314986102283001, -0.0031254501082003117, -0.021033385768532753, -0.0029557670932263136, -0.029236551374197006, -0.011421668343245983, 0.01696099527180195, -0.013713300228118896, 0.0012945164926350117, -0.015384585596621037, -0.001463287160731852, -0.020785246044397354, 0.0028481187764555216, 0.002315351041033864, -0.000282804889138788, -0.02532472088932991, 0.021967552602291107, 0.04446057602763176, 0.010611568577587605, 0.012837517075240612, -0.050882983952760696, -0.02857971377670765, -0.013560038059949875, -0.013669510371983051, -0.018873119726777077, -0.04437299817800522, -0.042767398059368134, 0.012633168138563633, -0.007250752300024033, 0.0121003994718194, -0.0266237985342741, -0.0003690147423185408, 0.005594063084572554, -0.007429557852447033, 0.021909167990088463, 0.019062872976064682, -0.014654766768217087, 0.03304620832204819, 0.024478130042552948, 0.025835594162344933, -0.03173253312706947, -0.002559840213507414, -0.031061097979545593, 0.003740322543308139, 0.0015472164377570152, 0.02402564324438572, 0.023222841322422028, -0.019792692735791206, -0.007976922206580639, 0.03237477317452431, -0.028842449188232422, 0.009137334302067757, 0.01604142226278782, 0.004068741109222174, -0.012625869363546371, -0.03214123100042343, -0.024711672216653824, -0.023616943508386612, 0.0029429954010993242, -0.015501356683671474, -0.019924059510231018, -0.015953844413161278, 0.0018099512672051787, -0.00015360410907305777, -0.005364169832319021, 0.004280388820916414, -0.04755501076579094, -0.009925538673996925, 0.030944326892495155, 0.021281523630023003, 0.0033553431276232004, -0.014180384576320648, 0.013888456858694553, 0.0007799941231496632, 0.006163321901112795, 0.03789220377802849, -0.00764850340783596, 0.02523714303970337, -0.009195719845592976, -0.021748607978224754, 0.027849894016981125, 0.017997337505221367, 0.02624429389834404, 0.014932097867131233, -0.013516249135136604, -0.019836481660604477, 0.011516544967889786, -0.016347946599125862, -0.003276887582615018, -0.006451600231230259, -0.01935480162501335, -0.029032202437520027, 0.01989486813545227, 0.00579841248691082, 0.019500764086842537, 0.04872271791100502, -0.008794319815933704, -0.01709236204624176, -0.0009660979849286377, -0.024098625406622887, 0.003632674226537347, 0.025091178715229034, -0.010925390757620335, 0.01901908405125141, 0.0022825091145932674, -0.009772277437150478, 0.004024952184408903, 0.0037549189291894436, 0.03129464015364647, 0.0013045514933764935, -0.001732407952658832, 0.022741161286830902, -0.0011257459409534931, 0.00886000320315361, 0.0038351991679519415, -0.002828048774972558, -0.0013282706495374441, -0.0300101600587368, 0.026025347411632538, 0.000910905422642827, -0.004977365955710411, 0.000433101988164708, -0.010399921797215939, 0.01976349949836731, 0.030360473319888115, -0.04516120254993439, -0.020785246044397354, 0.023412594571709633, 0.029324129223823547, -0.00545539753511548, 0.0036782880779355764, 0.03003935143351555, 0.0006399600533768535, 0.0075828200206160545, -0.015778688713908195, -0.003962917253375053, -0.033454906195402145, 0.011304897256195545, -0.03021450899541378, 0.011421668343245983, -0.011137038469314575, -0.02310607023537159, 0.03465180844068527, 0.011903348378837109, -0.012603974901139736, -0.017895163968205452, -0.007706888951361179, 0.00818856991827488, -0.019821885973215103, -0.002025247784331441, 0.004809507634490728, -0.0032312737312167883, 0.01696099527180195, 0.022551408037543297, -0.0018126880750060081, 0.020288970321416855, 0.017895163968205452, 0.05771408975124359, -0.005594063084572554, 0.01410740241408348, -0.007480645086616278, -0.009991222992539406, -0.019500764086842537, -0.026215100660920143, 0.004521228838711977, 0.04863514006137848, -0.0008712214767001569, -0.006345776841044426, -0.012202574871480465, -0.002999556250870228, -0.0009496770217083395, -0.013720598071813583, 0.01971971057355404, -0.002603629371151328, 0.001238867873325944, -0.008079096674919128, 0.006550125777721405, 0.0150050800293684, -0.03275427967309952, -0.048781104385852814, -0.009334385395050049, 0.026901129633188248, -0.010691849514842033, -0.01671285554766655, -0.022084323689341545, -0.002163913566619158, 0.002034370554611087, 0.004236599430441856, -0.009976626373827457, -0.005634203087538481, -0.024770058691501617, 0.01462557353079319, 0.01331189926713705, -0.0014021648094058037, 0.01472774799913168, -0.015194832347333431, 0.012888604775071144, 0.006458898540586233, 0.0007102051749825478, 0.030156122520565987, 0.001817249460145831, -0.007429557852447033, 0.004948173183947802, 0.026083732023835182, -0.013151339255273342, 0.07298190146684647, 0.01880013942718506, 0.01955915056169033, -0.0034940086770802736, 0.01441392581909895, -0.018435228615999222, 0.005539326462894678, -0.015326200053095818, -0.037541892379522324, -0.007955027744174004, -0.02449272759258747, 0.007692292798310518, -0.00708289397880435, 0.027193058282136917, 0.007736081723123789, 0.0009487647912465036, -0.0210625771433115, 0.0002736821479629725, 0.01675664447247982, -0.011166231706738472, 0.030360473319888115, -0.001512549933977425, 0.04273820295929909, -0.022536812350153923, 0.010582376271486282, 0.014888308942317963, 0.011815770529210567, -0.010881601832807064, 0.009750382043421268, 0.008217762224376202, 0.030973520129919052, 0.0016931801801547408, -0.020361950621008873, 0.01642092876136303, -0.018479017540812492, 0.01897529512643814, -0.010107994079589844, -0.009750382043421268, -0.00965550635010004, -0.0030798364896327257, 0.016245771199464798, -0.0004520316724665463, 0.0028535923920571804, 0.01053128857165575, 0.006710686255246401, 0.008604566566646099, 0.026419449597597122, 0.0064734951592981815, -0.030331280082464218, -0.03652014583349228, -0.0033024311996996403, -0.0075828200206160545, 0.0037950591649860144, -0.013362986966967583, 0.024390552192926407, -0.02490142546594143, -0.008422112092375755, 0.014932097867131233, 0.031061097979545593, 0.019369397312402725, 0.044402189552783966, -0.01017367746680975, 0.03757108375430107, -0.025777209550142288, 0.017895163968205452, -0.009385473094880581, 0.0027404704596847296, -0.02077065035700798, 0.01535539235919714, -0.026419449597597122, 0.00875052995979786, -0.007882045581936836, 0.03614063933491707, -0.01347975805401802, 0.038213323801755905, -0.007940431125462055, 0.00802071113139391, 0.0010162730468437076, -0.003280536737293005, -0.007356576155871153, -0.011377879418432713, -0.0025379457511007786, 0.023602347820997238, 0.034710194915533066, 0.014472311362624168, 0.026886533945798874, -0.013304601423442364, 0.021471276879310608, 0.005305784288793802, -0.004462843295186758, 0.016742048785090446, 0.022930914536118507, 0.03059401363134384, 0.027514178305864334, -0.02117934823036194, -0.03117786906659603, 0.006028305273503065, -0.0007681345450691879, -0.030185315757989883, -0.032112039625644684, 0.012421520426869392, -0.017544850707054138, 0.011173529550433159, -0.030535629019141197, 0.007331032305955887, 0.02424458973109722, 0.026025347411632538, -0.00482775317505002, 0.04145372286438942, 0.011917944997549057, 0.01747186854481697, 0.010122589766979218, -0.02206972800195217, -0.02301849238574505, -0.0021839835681021214, -0.02377750538289547, 0.0011348685948178172, 0.020610090345144272, 0.015691109001636505, 0.006783667951822281, -0.004561368841677904, -0.017749199643731117, -0.02023058384656906, -0.03138221800327301, -0.03021450899541378, -0.025806400924921036, 0.014829923398792744, 0.008203166536986828, 0.020084619522094727, -0.02557285875082016, -0.03730835020542145, -0.009983924217522144, -0.029265744611620903, -0.012260960415005684, 0.004466492682695389, 0.028258593752980232, -0.016523104161024094, 0.019369397312402725, -0.01675664447247982, -0.0005149785429239273, 0.012881306000053883, 0.01734049990773201, 0.017778392881155014, -0.0001631829800317064]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
" Q., Li, L., Dai, D., Zheng, C., Wu, Z., Chang, B.,
Sun, X., Xu, J., Li, L., and Sui, Z. A survey on in-context
learning, 2023.
Frantar, E., Ashkboos, S., Hoefler, T., and Alistarh, D.
GPTQ: Accurate Post-Training Quantization for Gen-
erative Pre-trained Transformers. In arXiv , 2023.
Huang, Y ., Cheng, Y ., Bapna, A., Firat, O., Chen, M. X.,
Chen, D., Lee, H., Ngiam, J., Le, Q. V ., Wu, Y ., and
Chen, Z. Gpipe: Efficient training of giant neural net-
works using pipeline parallelism. In Advances in Neural
Information Processing Systems , 2019.
HuggingFace-TensorParallelism. https://
huggingface.co/docs/transformers/v4.
15.0/parallelism#tensor-parallelism .
HuggingFace-Transformers. https://huggingface.
co/docs/transformers/main_classes/
output .
Korthikanti, V ., Casper, J., Lym, S., McAfee, L., Andersch,
M., Shoeybi, M., and Catanzaro, B. Reducing activation
recomputation in large transformer models, 2022.
Kwon, W., Li, Z., Zhuang, S., Sheng, Y ., Zheng, L., Yu,
C. H., Gonzalez, J. E., Zhang, H., and Stoica, I. Efficient
memory management for large language model serving
with pagedattention, 2023.
9
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
Leviathan, Y ., Kalman, M., and Matias, Y . Fast inference
from transformers via speculative decoding. In Interna-
tional Conference on Machine Learning , 2023.
Li, S., Xue, F., Baranwal, C., Li, Y ., and You, Y . Sequence
parallelism: Long sequence training from system perspec-
tive. In Association for Computational Linguistics (ACL) ,
2023.
Lin, B., Peng, T., Zhang, C., Sun, M., Li, L., Zhao, H., Xiao,
W., Xu, Q., Qiu, X., Li, S., Ji, Z., Li, Y ., and Lin, W.
Infinite-llm: Efficient llm service for long context with
distattention and distributed kvcache, 2024.
Lin, J., Tang, J., Tang, H., Yang, S., Dang, X., and Han, S.
AWQ: Activation-aware Weight Quantization for LLM
Compression and Acceleration. arXiv , 2023.
Liu, Y ., Li, H., Du, K., Yao, J., Cheng, Y ., Huang, Y ., Lu,
S., Maire, M., Hoffmann, H., Holtzman, A., Anantha-
narayanan, G., and Jiang, J. Cachegen: Fast context
loading for language model applications, 2023a.
Liu, Z., Oguz, B., Zhao, C., Chang, E., Stock, P., Mehdad,
Y ., Shi, Y ., Krishnamoorthi, R., and Chandra, V . LLM-
QAT: Data-Free Quantization Aware Training for Large
Language Models. arXiv , 2023b.
Narayanan, D., Phanishayee, A., Shi, K., Chen, X., and
Zaharia, M. Memory-efficient pipeline-parallel dnn train-
ing. In International Conference on Machine Learning ,
2021a.
Narayanan, D., Shoeybi, M., Casper, J., LeGresley, P., Pat-
wary, M., Korthikanti, V . A., Vainbrand, D., Kashinkunti,
P., Bernauer, J., Catanzaro, B., Phanishayee, A., and Za-
haria, M. Efficient large-scale language model training
on gpu clusters using megatron-lm, 2021b.
NVidia-cuBLAS. https://docs.nvidia.com/
cuda/cublas/ .
NVidia-LLM. https://
developer.nvidia.com/blog/
mastering-llm-techniques-inference_
optimization , 2023.
NVidia-NCCL. https://docs.n","[0.0027987859211862087, 0.019512875005602837, 0.03388655558228493, -0.013082191348075867, 0.026110848411917686, 0.001781653962098062, 0.006594629026949406, 0.041247379034757614, -0.07243050634860992, 0.008130364120006561, 0.04882233589887619, 0.007775706704705954, -0.034127455204725266, 0.02673986554145813, 0.0017448498401790857, 0.005239568185061216, 7.3608236561995e-05, -0.015752162784337997, 0.00660801213234663, 0.04847437143325806, 0.00805006455630064, -0.048688504844903946, 0.00750134838744998, 0.026017166674137115, 0.01671576127409935, -0.01563171297311783, 0.002004151465371251, 0.03359212353825569, 0.020463090389966965, -0.030915459617972374, 0.036375854164361954, -0.02853322960436344, -0.05232876539230347, -0.018080860376358032, 0.007006166037172079, 0.03490368649363518, 0.027890829369425774, 0.022952387109398842, -0.03236085921525955, 0.026512349024415016, 0.017010195180773735, -0.08961468189954758, -0.0384368821978569, 0.027676697820425034, -0.016260728240013123, 0.023420803248882294, 0.0013517149491235614, -0.0005365873221307993, -0.025829799473285675, 0.06365104764699936, 0.0035967661533504725, 0.02186833880841732, -0.07152044028043747, 0.0108873276039958, -0.02423718571662903, 0.00875938031822443, -0.01377143245190382, 0.00640057073906064, 0.01500269677489996, -0.025374766439199448, -0.010566127486526966, -0.0668630450963974, -0.004617244005203247, 0.037178851664066315, -0.03476985543966293, -0.003317389404401183, -0.03902575001120567, 0.015149913728237152, -0.03771418333053589, 0.010385452769696712, -0.017652593553066254, 0.020556773990392685, 0.03527842089533806, -0.010465753264725208, 0.0016243999125435948, 0.041407980024814606, -0.005895350594073534, 0.08618855476379395, -0.012105208821594715, -0.014065864495933056, 0.004108678083866835, -0.013189258053898811, 0.0058585465885698795, -0.020891355350613594, -0.018294991925358772, -0.010606277734041214, -0.030888693407177925, -0.006671582814306021, -0.02214938774704933, -0.0103787612169981, -0.003319062292575836, 0.0019455995643511415, -0.048929404467344284, -0.005333251319825649, 0.04362960904836655, 0.039186347275972366, 0.04577093943953514, -0.018294991925358772, 0.026378516107797623, 0.052382297813892365, -0.006818799301981926, 0.00688571622595191, 0.03846364840865135, -0.022925620898604393, 0.03359212353825569, -0.018482359126210213, -0.02461191825568676, -0.02494650147855282, -0.01730462722480297, 0.02032925747334957, -0.09764467179775238, -0.006601320579648018, -0.012533475644886494, 0.01235280092805624, 0.010693269781768322, -0.05005360022187233, -0.029710961505770683, -0.00617640046402812, -0.013456923887133598, 0.028479695320129395, -0.04745723679661751, -0.014467364177107811, 0.024478085339069366, 0.009455312974750996, -0.0007749776123091578, -0.011308901943266392, 0.012827908620238304, -0.05005360022187233, 0.016059979796409607, 0.000945196661632508, 0.011957992799580097, -0.0017515415092930198, 0.04826023802161217, -0.031664926558732986, -0.015578179620206356, -0.04395081102848053, -0.032334089279174805, 0.004075219854712486, -0.03747328370809555, 0.0073742070235311985, 0.027315348386764526, 0.008257505483925343, -0.018990924581885338, 0.019138142466545105, -0.03361888974905014, 0.016822827979922295, 0.0013199294917285442, 0.015457729808986187, -0.026512349024415016, 0.006293504498898983, -0.020610306411981583, -0.005246259737759829, -0.041622113436460495, 0.00567452609539032, -0.03485015407204628, -0.046734537929296494, -0.038998983800411224, 0.07778383046388626, 0.024772517383098602, -0.08286949247121811, 0.005440318025648594, 0.036563217639923096, 0.038543950766325, 0.025829799473285675, 0.008551938459277153, 0.023661702871322632, -0.04178271070122719, -0.00688571622595191, -0.06509644538164139, -0.06183091923594475, -0.010017411783337593, -0.033083558082580566, -0.0268603153526783, -0.032521456480026245, 0.01628749445080757, -0.02094488963484764, -0.030888693407177925, -0.051151033490896225, -0.05492512881755829, -0.05428272858262062, -0.013824964873492718, 0.035546086728572845, -0.029122095555067062, 0.011523035354912281, -0.05776239186525345, 0.002380557358264923, -0.00925456266850233, 0.047082506120204926, 2.7707646950148046e-05, 0.07435770332813263, -0.011068002320826054, 0.02007497288286686, 0.05572812631726265, 0.03632231801748276, 0.003954770043492317, -0.03217349201440811, 0.054202429950237274, 0.0018652996513992548, 0.027127981185913086, -0.03766065090894699, 0.02683354914188385, 0.028479695320129395, -0.0036134952679276466, -0.06258038431406021, 0.02267133630812168, -0.03361888974905014, -0.0009736362262628973, -0.0293629951775074, -0.03669705241918564, -0.02186833880841732, 0.050535399466753006, 0.053586795926094055, 0.06573884934186935, 0.030942225828766823, -0.0058786217123270035, -0.014494131319224834, -0.06059965491294861, 0.014842097647488117, 0.02458515204489231, 0.04068528115749359, 0.011951301246881485, 0.024143502116203308, 9.932929970091209e-05, 0.03059425950050354, -0.021547138690948486, 0.020556773990392685, 0.004112023860216141, -0.014039098285138607, 0.04215744510293007, -0.006256700027734041, 0.04065851494669914, 0.0008059265674091876, -0.013537224382162094, -0.027783764526247978, -0.0017231019446626306, -0.05353326350450516, 0.005463738460093737, -0.029443295672535896, -0.0025612320750951767, -0.04716280475258827, -0.007822548039257526, 0.012071751058101654, 0.03142402693629265, 0.0032053040340542793, 0.00011124880984425545, 0.03937371447682381, -0.03988227993249893, -0.0587259903550148, 0.06215211749076843, 0.016849594190716743, -0.010679885745048523, -0.033324457705020905, -0.039587847888469696, 6.15318858763203e-05, -0.042425110936164856, -0.010412219911813736, -0.0032839311752468348, -0.008230739273130894, -0.044432610273361206, -0.020516622811555862, -0.007454507052898407, 0.028881195932626724, -2.917144593084231e-05, 0.0033592123072594404, -0.005002014338970184, -0.0006097773439250886, -0.03482338786125183, 0.02350110188126564, -0.018214693292975426, 0.006256700027734041, 0.025428300723433495, -0.0060927546583116055, 0.004306081682443619, 0.0052864099852740765, -0.07243050634860992, -0.007876081392168999, 0.041622113436460495, 0.009475387632846832, -0.016488244757056236, 0.030139226466417313, 0.02732873149216175, 0.021480221301317215, 0.060706719756126404, 0.03324415534734726, 0.016474861651659012, 0.030058927834033966, -0.01872325874865055, 0.005497197154909372, -0.034743089228868484, -0.021533755585551262, 0.04735017195343971, -0.01751876063644886, 0.0030296482145786285, -0.024973267689347267, 0.04654717072844505, 0.03688441962003708, -0.0025545405223965645, 0.021761272102594376, -0.011911150999367237, -0.0355193205177784, 0.01631426252424717, -0.014172931201756, -0.012178817763924599, -0.0002733124129008502, -0.01832175999879837, 0.04641333967447281, -0.03693795204162598, -0.009850120171904564, -0.001535735442303121, 0.018709875643253326, -0.016059979796409607, -0.0005687909433618188, -0.0040819114074110985, 0.004784535616636276, -0.0293629951775074, -0.035546086728572845, 0.002022553700953722, -0.04114031419157982, 0.02198878861963749, -0.05120456591248512, -0.0028774128295481205, -0.048340536653995514, -0.010954244062304497, 0.006293504498898983, 0.001708882162347436, 0.012386258691549301, -0.03399362042546272, -0.01903107576072216, -0.01974039152264595, -0.021533755585551262, 0.008324422873556614, -0.008424797095358372, 0.026846932247281075, -0.017652593553066254, -0.049330901354551315, -0.012332725338637829, -0.029122095555067062, 0.03501075506210327, 0.020918123424053192, 0.008732613176107407, -0.10305152833461761, 0.012774375267326832, -0.04218421131372452, -0.008812913671135902, -0.02347433567047119, 0.0517398975789547, 0.01551126316189766, 0.029416527599096298, 0.04116708040237427, 0.005089005921036005, 0.0004663249128498137, -0.04036407917737961, 0.022925620898604393, -0.023300353437662125, 0.0365096852183342, 0.02205570414662361, 0.003396016312763095, -0.018121009692549706, -0.005995725281536579, 0.010599586181342602, -0.031504325568675995, 0.01306211668998003, 0.027435798197984695, -0.024852817878127098, -0.035358719527721405, 0.012319342233240604, 0.004004957154393196, 0.009020354598760605, 0.008839679881930351, -0.010706652887165546, 0.022256454452872276, 0.033324457705020905, 0.0014420523075386882, -0.0156718622893095, -0.02359478548169136, -0.006099446211010218, -0.0141863152384758, 0.00660801213234663, 0.02643204852938652, 0.04941120371222496, 0.032735589891672134, 0.02168097160756588, 0.02728858031332493, -0.0021915179677307606, -0.0015792312333360314, 0.028693828731775284, -0.003646953497081995, -0.03021952696144581, -0.011616718024015427, 0.006266737822443247, -0.005366709548979998, -0.015899378806352615, -0.04759107157588005, 0.02569596655666828, 0.006367112509906292, 0.004383035935461521, 0.03503752127289772, 0.005915425717830658, 0.01671576127409935, 0.02544168382883072, -0.012479942291975021, -0.016515010967850685, -0.025856565684080124, -0.022724870592355728, 0.03321738913655281, 0.026298215612769127, 0.02773023024201393, 0.03260175883769989, 0.019178291782736778, -0.006022491957992315, 0.04451290890574455, -0.03286942467093468, 0.007407665252685547, -0.008304347284138203, 0.025361383333802223, -0.04239834472537041, -0.005617646966129541, -0.000756993773393333, 0.019472723826766014, 0.06536411494016647, -0.021011805161833763, 0.004389727488160133, -0.05861892178654671, -0.047912269830703735, -0.05706645920872688, 0.0027569630183279514, 0.03527842089533806, -0.05760179087519646, 0.011369126848876476, -0.048099637031555176, -0.03099576011300087, -0.003417764324694872, 0.023327119648456573, -0.008839679881930351, -0.014574430882930756, -0.042612478137016296, 0.013664365746080875, 0.048287004232406616, 0.013717899098992348, -0.027489330619573593, 0.010278386995196342, -0.0018351871985942125, -0.01622057892382145, -0.01943257451057434, -0.027596397325396538, -0.016086746007204056, -0.0045570190995931625, -0.010820411145687103, 0.013256174512207508, -0.05487159639596939, 0.04317457601428032, 0.014614581130445004, 0.07553543150424957, -0.0065444414503872395, 0.013932031579315662, -0.027127981185913086, 0.08244122564792633, -0.01887047477066517, 0.06852257996797562, -0.02016865648329258, 0.037767715752124786, 0.013624215498566628, -0.031343724578619, -0.0344754233956337, 0.014226464554667473, 0.020101740956306458, 0.04887586832046509, -0.009850120171904564, 0.046306271106004715, -0.00588196748867631, -0.01680944487452507, -0.023019302636384964, -0.0013809909578412771, -0.032521456480026245, 0.00471092713996768, 0.011402585543692112, 0.022216305136680603, -0.012593700550496578, -0.013343165628612041, -0.03407392278313637, 0.039641380310058594, -0.045315906405448914, 0.008029989898204803, 0.007313982117921114, 0.028640296310186386, 0.05760179087519646, -0.008692463859915733, 0.006872332654893398, 0.0014144491869956255, -0.006507637444883585, -0.015230213291943073, -0.00829765573143959, 0.04437907412648201, -0.014962547458708286, -0.0016812790418043733, 0.014427214860916138, -0.016956660896539688, -0.04903646931052208, -0.03522488847374916, -0.03423452004790306, 0.0038175908848643303, -0.021828187629580498, 0.019539641216397285, 0.016153661534190178, 0.022778403013944626, -0.024759134277701378, 0.06033198907971382, 0.0064474125392735004, -0.007146690506488085, 0.057815924286842346, 0.02430410124361515, 0.010318536311388016, -0.011342359706759453, 0.020770905539393425, 0.005333251319825649, 0.05409536138176918, -0.01225911732763052, 0.025147249922156334, 0.0055005429312586784, 0.029496828094124794, 0.01130221039056778, -0.006387187633663416, -0.018522508442401886, -0.02115902304649353, -0.0008573686936870217, -0.0121654337272048, -0.011944609694182873, -0.08570675551891327, -0.005386784672737122, -0.019071225076913834, -0.004834722727537155, -0.011516342870891094, -0.0007996531203389168, -0.013282940723001957, -0.061081454157829285, -0.00851178914308548, -0.0018351871985942125, -0.02392936870455742, -0.05851185694336891, -0.0036068037152290344, -0.00297276908531785, 0.02794436365365982, 0.027489330619573593, 0.022309986874461174, 0.00880622211843729, -0.0252944678068161, 0.022644570097327232, -0.022644570097327232, -0.013998948037624359, 0.029309460893273354, 0.048527903854846954, -0.03709855303168297, -0.012239042669534683, -0.01179739274084568, 0.005557422060519457, -0.015123146586120129, 0.03241439163684845, 0.009649370796978474, -0.006601320579648018, -0.0013124013785272837, 0.025896716862916946, 0.0009050467051565647, -0.002236686646938324, -0.009482079185545444, -0.024839434772729874, -0.007474581710994244, 0.03543902188539505, -0.028024664148688316, 0.018054092302918434, 0.00475776894018054, -0.02661941573023796, -0.019780540838837624, 0.030861927196383476, -0.030513960868120193, 0.02362155169248581, -0.006229933351278305, 0.005115772597491741, 0.02773023024201393, 0.007682023104280233, 0.02170773781836033, -0.040631748735904694, -0.021533755585551262, -0.0010756839765235782, -0.0060492586344480515, -0.01957979053258896, 0.031664926558732986, -0.028934728354215622, 0.007688715122640133, -0.03506428748369217, 0.005614301189780235, 0.05717352405190468, -0.04009641334414482, -0.021078722551465034, -0.05307823047041893, -0.028452929109334946, -0.025174017995595932, 0.019753774628043175, -0.032735589891672134, -0.03685765340924263, 0.009749745950102806, 0.007307290565222502, -0.026592647656798363, -0.004403111059218645, -0.007313982117921114, -0.02995186112821102, 0.002255088649690151, -0.017679359763860703, 0.0009334862697869539, 0.0028640294913202524, -0.011128227226436138, -0.010994394309818745, -0.014360297471284866, -0.009977261535823345, -0.03286942467093468, -0.014708263799548149, -0.007916231639683247, -0.029282694682478905, 0.006688312161713839, 0.04025701433420181, -0.017692742869257927, 0.026793397963047028, -0.04006964713335037, -0.00033374642953276634, 0.009147495962679386, 0.01638117805123329, 0.01721094362437725, -0.008819605223834515, -0.011924534104764462, -0.041033245623111725, 0.031504325568675995, -0.04199684411287308, 0.0007766505586914718, 0.03664351999759674, 0.022403670474886894, 0.012339416891336441, 0.024866200983524323, -0.011188452132046223, -0.015564796514809132, 0.04381697624921799, -0.03784801810979843, 0.010251619853079319, 0.011991450563073158, -0.0003209904534742236, 0.009937112219631672, 0.03410068899393082, -0.0136777488514781, -0.0242773350328207, 0.0077087897807359695, -0.01957979053258896, -0.0061161755584180355, -0.03078162670135498, -0.05888659134507179, 0.04483410716056824, 0.023273585364222527, 0.028881195932626724, -0.006932557560503483, -0.025990398600697517, -0.050936900079250336, -0.031718458980321884, -0.0015474458923563361, -0.0669701099395752, -0.024250568822026253, -0.006079371087253094, -0.0060827168636024, -0.010291770100593567, 0.036964718252420425, 0.03824951499700546, 0.02501341700553894, -0.00473434804007411, -9.127839439315721e-05, -0.005918771494179964, 0.027221664786338806, 0.023581402376294136, -0.014922397211194038, 0.004108678083866835, -0.03206642344594002, 0.019633324816823006, -0.028024664148688316, 0.008625547401607037, 0.022443819791078568, -0.04504824057221413, 0.03479662165045738, -0.05792298913002014, -0.002736888127401471, 0.019379042088985443, 0.022939004004001617, 0.01063973642885685, -0.00805006455630064, 0.01763921044766903, 0.005068930797278881, -0.005647759418934584, -0.0015482823364436626, -0.0009677810012362897, -0.022229688242077827, 0.006199820898473263, -0.033297691494226456, -0.001892066327854991, 0.040230248123407364, -0.016755910590291023, -0.08634915202856064, -0.014172931201756, -0.0027753650210797787, -0.03201289102435112, -0.00188704754691571, -0.02581641636788845, -0.022939004004001617, -0.01998129114508629, 0.001783326850272715, 0.0629015862941742, -0.024371018633246422, -0.015926145017147064, -0.008029989898204803, -0.007889464497566223, -0.006865641102194786, -0.027810530737042427, 0.013001891784369946, 0.018482359126210213, -0.0018201309721916914, -0.01631426252424717, -0.027395647019147873, -0.014226464554667473, -0.004496794193983078, -0.015966296195983887, 9.096472786040977e-05, -0.0016294186934828758, -0.019379042088985443, -0.005316522438079119, 0.020409556105732918, -0.0074478150345385075, 0.017184177413582802, 0.0075883399695158005, 0.007206915412098169, 0.017880110070109367, -0.036161720752716064, -0.00891328789293766, -0.0015817406820133328, -0.03902575001120567, -0.007434431929141283, -0.03444865345954895, -0.026271449401974678, -0.022430436685681343, -0.032119959592819214, 0.01612689532339573, 0.03527842089533806, 0.024933116510510445, 0.011529726907610893, 0.010867252014577389, 0.008485022000968456, 0.01964670792222023, -0.007113232277333736, -0.03260175883769989, 0.01196468435227871, 0.011021160520613194, 0.006594629026949406, -0.0021630784031003714, -0.02855999581515789, 0.0268603153526783, -0.00750134838744998, -0.007441123481839895, -0.008699155412614346, 0.014146164990961552, 0.004737693816423416, 0.007661948446184397, 0.02572273276746273, 0.017130644991993904, -0.005912079941481352, -0.00523622240871191, -0.00908057950437069, -0.005129155702888966, 0.016729144379496574, 0.00032140870462171733, -0.01865634135901928, 0.019392425194382668, 0.000953561277128756, 0.00966944545507431, -0.017411693930625916, 0.00500536011531949, 0.0034027080982923508, 0.023581402376294136, 0.008197280578315258, -0.027489330619573593, -0.002838935935869813, 0.025682583451271057, -0.03303002193570137, -0.0435493104159832, -0.0293629951775074, -0.039641380310058594, -0.015993062406778336, 0.007347440347075462, -0.03741975128650665, -0.048527903854846954, 0.010733419097959995, 0.02979126013815403, 0.027074448764324188, 0.0003038430877495557, 0.033324457705020905, 0.012071751058101654, -0.0850108191370964, -0.03723238408565521, 0.007086465600878, -0.016448095440864563, 0.007173457182943821, -0.02572273276746273, -0.005540692713111639, 0.01714402809739113, 0.011449426412582397, -0.028131728991866112, 0.013865115121006966, -0.0024508198257535696, 0.00020357278117444366, -0.0011718765599653125, 0.034154221415519714, -0.06536411494016647, 0.0027285234536975622, -0.025026800110936165, 0.06777311116456985, -0.006504291668534279, -0.01634102873504162, -0.005938846617937088, 0.017010195180773735, 0.01059289462864399, -0.019633324816823006, -0.011114844121038914, 0.01045236922800541, 0.02652573212981224, 0.0011451099999248981, 0.009462004527449608, -0.024437934160232544, -0.049759168177843094, 0.0061161755584180355, 0.03988227993249893, -0.026873698458075523, 0.016461478546261787, -0.029844794422388077, 0.01008432824164629, 0.0055005429312586784, -0.01952625811100006, -0.01671576127409935, -0.06118851900100708, 0.03444865345954895, -0.023447569459676743, 0.033324457705020905, 0.004714272916316986, 0.031477559357881546, -0.00397819047793746, 0.03608141839504242, -0.005888659041374922, 0.016568545252084732, 0.007421048823744059, 0.0025294467341154814, 0.009502153843641281, 0.016581928357481956, -0.02565581724047661, -0.003069797996431589, -0.02482605166733265, 0.019231824204325676, 0.025428300723433495, -0.01397218182682991, 0.023675085976719856, -0.007441123481839895, -0.01804070919752121, -0.016515010967850685, -0.011288827285170555, 0.0025311196222901344, 0.026258066296577454, -0.0046975440345704556, -0.04903646931052208, -0.036375854164361954, 0.03460925444960594, 0.008398030884563923, 0.006417300086468458, 0.0007411011029034853, 0.01905784197151661, 0.023728618398308754, 0.02605731599032879, -0.012433100491762161, -0.004068527836352587, 0.021533755585551262, -0.005226184614002705, -0.01196468435227871, -0.00013320581638254225, 0.005794975906610489, 0.012105208821594715, 0.02704768069088459, -0.02880089543759823, -0.028479695320129395, 0.036134954541921616, 0.02470560185611248, -0.03509105369448662, 0.024678833782672882, -0.0033558665309101343, 0.025923483073711395, 0.013811581768095493, 0.005965612828731537, 0.027462564408779144, 0.012379567138850689, -0.0010188049636781216, 0.027221664786338806, 0.01816115900874138, -0.05588872730731964, -0.039213117212057114, 0.0047945729456841946, 0.018790176138281822, 0.01622057892382145, 0.016849594190716743, 0.02214938774704933, -0.02137315459549427, 0.013945414684712887, 0.0030580877792090178, -0.009214413352310658, 0.029818028211593628, 0.01782657578587532, 0.01801394298672676, 0.02896149456501007, 0.01844220981001854, 0.023046070709824562, -0.0017481956165283918, 0.022805171087384224, 0.008244122378528118, -0.033137090504169464, 0.006193129345774651, -0.03913281485438347, -0.026780014857649803, 0.03303002193570137, 0.03364565595984459, -0.02489296719431877, -0.008993588387966156, 0.003897890681400895, 0.01581908017396927, -0.0038343199994415045, -0.008157131262123585, 0.0017381581710651517, 0.012854674831032753, -0.0018234767485409975, 0.02896149456501007, -0.03750004991889, 0.03870454803109169, -0.007226990535855293, 0.005453701131045818, 0.032735589891672134, -0.0012789431493729353, 0.009201029315590858, -0.011931225657463074, 0.007655256427824497, -0.02352786995470524, -0.0033207351807504892, -0.01628749445080757, 0.03985551372170448, -0.025187401100993156, -0.010171320289373398, 0.044459376484155655, 0.0032672020606696606, 0.0030079002026468515, -0.019593173637986183, -0.041006479412317276, -0.024973267689347267, 0.03418098762631416, 0.017973793670535088, 0.030246293172240257, -0.010385452769696712, 0.002158059738576412, -0.0020593577064573765, -0.011743859387934208, -0.028506463393568993, 0.0055774967186152935, -0.030460426583886147, 0.01643471233546734, -0.014253231696784496, -0.02640528231859207, 0.052757032215595245, 0.030299827456474304, 0.01936565712094307, 0.010030794888734818, -0.002852319274097681, 0.007421048823744059, 0.02877412922680378, 0.010171320289373398, 0.00638384185731411, 0.0006461632438004017, 0.001354224281385541, -0.007313982117921114, 0.01983407326042652, 0.011583260260522366, -3.335373185109347e-05, 0.0002603473258204758, 0.004051798954606056, 0.028238795697689056, -0.011322285048663616, 0.014534280635416508, -0.008137055672705173, 0.037205617874860764, 0.02352786995470524, -0.02106533944606781, 0.008572014048695564, 0.01936565712094307, -0.028613530099391937, -0.027489330619573593, 0.010091019794344902, 0.03543902188539505, 0.011007777415215969, -0.005199418403208256, -0.05615639314055443, 0.04309427738189697, -0.005099043250083923, -0.034154221415519714, 0.0028473003767430782, 0.030861927196383476, 0.0032320707105100155, -0.009843428619205952, -0.001758233061991632, 0.030674559995532036, -0.02303268574178219, -0.03506428748369217, 0.035733453929424286, 0.0009460331639274955, -0.01429338101297617, -0.018977541476488113, -0.06316924840211868, -0.011931225657463074, 0.0021630784031003714, -0.020101740956306458, -0.02898826263844967, 0.015618329867720604, 0.005902042146772146, 0.009308096021413803, -0.008491713553667068, 0.005784938111901283, -0.007581648416817188, 0.007032932247966528, 0.008230739273130894, 0.011630101129412651, -0.007186840754002333, -0.012319342233240604, -0.0002762399963103235, -0.01201152615249157, -0.018495742231607437, 0.005423588678240776, 0.024063201621174812, -0.005594226066023111, 0.009896961972117424, -0.005353326443582773, -0.0025160633958876133, 0.010318536311388016, 0.01745184324681759, 0.01321602426469326, -0.001710555050522089, -0.0032454540487378836, 0.018241459503769875, -0.0083712637424469, 0.02312636934220791, -0.022711487486958504, 0.008645622059702873, 0.0005508071044459939, 0.018576042726635933, 0.03701825067400932, 0.022229688242077827, 0.018294991925358772, -0.03945401683449745, 0.04108677804470062, 0.020958272740244865, -0.020248956978321075, 0.0012111901305615902, -0.029871560633182526, -0.014494131319224834, -0.01497593056410551, 0.01723771169781685, 0.003914619795978069, -0.03586728498339653, 0.001374299288727343, 0.005805013235658407, 0.0156718622893095, -0.0027987859211862087, -0.015604945831000805, 0.005935500375926495, 0.007427740376442671, 0.01480194739997387, 0.0032554916106164455, -0.02180142141878605, -0.03142402693629265, -0.0054603926837444305, -0.0033475018572062254, -0.0072336820885539055, -0.014279997907578945, -0.03458248823881149, 0.0008632238605059683, 0.05010713264346123, -0.004540289752185345, -0.02960389479994774, 0.020409556105732918, -0.014935780316591263, -0.010586203075945377, -0.010927476920187473, 0.010117786936461926, -0.004523560870438814, 0.0038376657757908106, 0.02374200150370598, -0.04641333967447281, 0.021640822291374207, 0.011021160520613194, 0.01333647407591343, -0.016327645629644394, -0.005022089462727308, 0.005687909200787544, -0.007688715122640133, -0.05409536138176918, 0.010418911464512348, 0.00851178914308548, -0.021788038313388824, 0.03894544765353203, -0.0005390967126004398, 0.024344252422451973, 0.02775699645280838, 0.018080860376358032, 0.008103597909212112, -0.044860873371362686, 0.002581306966021657, 0.00154410011600703, -0.015364046208560467, 0.0011852598981931806, -0.0021881721913814545, 0.0013224389404058456, -0.00891328789293766, -0.03792831674218178, 0.015404196456074715, -0.01903107576072216, 0.039587847888469696, 0.03873131424188614, 0.00489494763314724, 0.002969423308968544, -0.003459587227553129, 0.020744139328598976, -0.03559961915016174, -0.004834722727537155, -0.017839960753917694, 0.006467487197369337, 0.006079371087253094, -0.027703464031219482, 0.031049292534589767, 0.01638117805123329, -0.008290964178740978, -0.005413551349192858, -0.01130221039056778, 0.0038075533229857683, -0.03784801810979843, 0.002260107547044754, 0.026084082201123238, -0.00713330740109086, 0.07312643527984619, -0.009990645572543144, 0.007822548039257526, -0.009261254221200943, -0.01603321172297001, 0.03618848696351051, -0.021908488124608994, 0.009495462290942669, -0.02516063302755356, 0.011081385426223278, -0.012379567138850689, 0.0036068037152290344, -0.045851241797208786, -0.00920772086828947, 0.04191654548048973, -0.026806781068444252, -0.028399396687746048, 0.01539081335067749, 0.00014638001448474824, 0.0192719753831625, 0.042853377759456635, 0.017291244119405746, -0.0008063447894528508, -0.03795508295297623, -0.009093963541090488, -0.008244122378528118, -0.013905265368521214, 0.018174542114138603, 0.014748414047062397, 0.04274630919098854, 0.009087271057069302, -0.039213117212057114, -0.04429877549409866, 0.005129155702888966, -0.00734074879437685, 0.02960389479994774, -0.023046070709824562, 0.022042321041226387, -0.025000033900141716, 0.0011016142088919878, 0.0384904146194458, -0.0008782800869084895, -0.012372875586152077, -0.004644010681658983, -0.0324411578476429, -0.006561170797795057, -0.020436324179172516, 0.016541779041290283, 0.010231545194983482, -0.000506474869325757, -0.020396173000335693, -0.007889464497566223, 0.028345862403512, -0.002158059738576412, 0.024959884583950043, -0.0238356851041317, 0.012794449925422668, 0.06365104764699936, 0.019379042088985443, 0.030139226466417313, -0.022095855325460434, 0.010318536311388016, -0.021828187629580498, -0.0018034018576145172, -0.021011805161833763, -0.030273061245679855, -0.02307283692061901, -0.0032370896078646183, 0.007474581710994244, 0.013088882900774479, -0.007742248009890318, -0.003747328417375684, 0.01221227552741766, -0.007367515470832586, 0.0054436638019979, 0.014373681508004665, 0.007561573293060064, 0.01145611796528101, 0.001309892046265304, 0.04483410716056824, -0.020985038951039314, -0.011496268212795258, -0.013744665309786797, 0.02439778484404087, 0.012881441041827202, 0.0037004868499934673, 0.004028378054499626, -0.036349084228277206, -0.027409030124545097, 0.033083558082580566, -0.0024324175901710987, 0.0007461198838427663, 0.059850189834833145, 0.02491973340511322, -0.023394035175442696, -0.023179903626441956, -0.04357607662677765, 0.0017364852828904986, 0.05382769554853439, 0.016059979796409607, -0.01204498391598463, 0.011275443248450756, -0.026351748034358025, 0.02791759744286537, -0.010867252014577389, 0.022952387109398842, -0.02189510501921177, -0.009662753902375698, 0.024437934160232544, -0.012894825078547001, -0.01723771169781685, -0.015016080811619759, 0.03062102571129799, -0.004667431581765413, 0.009201029315590858, 0.019392425194382668, 0.012687383219599724, 0.0008757707546465099, -0.0038477033376693726, -0.026137616485357285, 0.03056749328970909, -0.0126740001142025, 0.04170241206884384, 0.02023557387292385, -0.010539361275732517, -0.02257765457034111, 0.00596895907074213, -0.043683141469955444, -0.009301404468715191, 0.005416897125542164, -0.0029259275179356337, -0.023889219388365746, 0.027435798197984695, 0.01159664336591959, 0.0374465174973011, 0.03618848696351051, 0.008357880637049675, -0.008357880637049675, 0.007487965282052755, 0.0258431825786829, 0.010726727545261383, 0.03750004991889, 0.017291244119405746, 0.045878008008003235, 0.017665976658463478, -0.01597967930138111, -0.003039685543626547, -0.0364561527967453, 0.03570668771862984, -0.027395647019147873, -0.015658479183912277, -0.0051258099265396595, 0.017786426469683647, 0.009970569983124733, -0.003049723105505109, -0.0027937672566622496, -0.014507514424622059, -0.0013793179532513022, 0.016193812713027, -0.0030447044409811497, -0.0032722207251936197, 0.004225782118737698, -0.017893493175506592, 0.002830571262165904, 0.03021952696144581, -0.040819112211465836, -0.03750004991889, 0.007247065659612417, 0.012419717386364937, 0.0038543948903679848, -0.01782657578587532, 0.02501341700553894, -0.010599586181342602, -0.005704638548195362, -0.012178817763924599, -0.02069060690701008, -0.018121009692549706, 0.006771957967430353, -0.011630101129412651, -0.005537346936762333, -0.00871253851801157, -0.009395088069140911, 0.0004989467561244965, -0.011402585543692112, -0.03410068899393082, -0.010064253583550453, -0.03195935860276222, 0.008150439709424973, -0.006858949549496174, -0.018214693292975426, -0.01862957514822483, -0.028078196570277214, 0.012218967080116272, 0.007789089810103178, 0.0053633637726306915, 0.016059979796409607, 0.007635181769728661, 0.05952898785471916, 0.031879059970378876, 0.020034823566675186, -0.003432820551097393, -0.003293968504294753, -0.015484496019780636, -0.022872086614370346, -0.013838348910212517, 0.02352786995470524, 0.014574430882930756, 0.015859229490160942, -0.005175997503101826, -0.023179903626441956, -0.00487152673304081, -0.028506463393568993, -0.010505902580916882, 0.008230739273130894, 0.012827908620238304, -0.01678267866373062, 0.005075622349977493, 0.013758048415184021, -0.03956108167767525, -0.021480221301317215, 0.02380891889333725, 0.008772763423621655, 0.00397819047793746, -0.0012120265746489167, -0.009020354598760605, 0.008143747225403786, 0.0036937950644642115, -0.017438460141420364, 0.01125536859035492, 0.043254878371953964, -0.013998948037624359, -0.009227796457707882, 0.013617523945868015, -0.018763408064842224, -0.0009711268357932568, 0.012018217705190182, 0.015310512855648994, -0.013824964873492718, 0.00029338739113882184, 0.016113512217998505, -0.017438460141420364, 0.01692989468574524, 0.02510710060596466, 0.04336194321513176, -0.03388655558228493, 0.04073881357908249, 0.04539620876312256, 0.020837822929024696, -0.023447569459676743, 0.020436324179172516, -0.011342359706759453, 0.03268205747008324, -0.01328963227570057, -0.0324411578476429, -0.0002536556567065418, -0.030433660373091698, -0.012653925456106663, -0.017103876918554306, 0.009488770738244057, -0.0035967661533504725, -0.01945934072136879, -0.03118312545120716, 0.007334057241678238, 0.0033558665309101343, -0.032548222690820694, 0.04397757723927498, -0.043683141469955444, 0.02661941573023796, -0.0003977354208473116, -0.012105208821594715, -0.007568265311419964, -0.00871253851801157, -0.01856265962123871, -0.0031618084758520126, 0.004644010681658983, 0.03519812226295471, -0.004322811029851437, 0.02550859935581684, 0.030915459617972374, -0.020302489399909973, 0.02898826263844967, 0.0007561573293060064, -0.021306239068508148, -0.011014468967914581, 0.004376344382762909, -0.015524646267294884, -0.009187646210193634, -0.007053007371723652, 0.004356269259005785, 0.01751876063644886, -0.010900710709393024, 0.02057015709578991, 0.019178291782736778, -0.03741975128650665, -0.02683354914188385, 0.013617523945868015, -0.00542024290189147, 0.002480932278558612, -0.0015072959940880537, 0.03174522519111633, -0.01721094362437725, -0.015190063044428825, 0.008016605861485004, 0.035385485738515854, 0.020891355350613594, 0.029416527599096298, -0.019512875005602837, 0.03581375256180763, -0.0057615176774561405, 0.0047912271693348885, -0.015845846384763718, 0.019887607544660568, -0.021105488762259483, -0.010459061712026596, -0.006474179215729237, 0.0065444414503872395, 0.004998668562620878, 0.026686331257224083, -0.011743859387934208, 0.03364565595984459, -0.0005683727213181555, 0.002094488823786378, 0.031290192157030106, -0.00013299670536071062, 0.02728858031332493, 0.030942225828766823, 0.025776267051696777, 0.04502147436141968, 0.028452929109334946, -0.005487159360200167, 0.041033245623111725, 0.006765265949070454, 0.007675331551581621, -0.007059698924422264, -0.01881694234907627, 0.003747328417375684, 0.020222190767526627, 0.015016080811619759, 0.015712013468146324, -0.029523594304919243, -0.03886514902114868, 0.01276768371462822, -0.00826419796794653, -0.01846897602081299, -0.02498665079474449, 0.016702378168702126, -0.003406053874641657, 0.0037205617409199476, -0.01196468435227871, 0.005410205572843552, 0.05856538936495781, 0.043442241847515106, 0.0012212275760248303, 0.018067477270960808, 0.008605471812188625, 0.029095329344272614, 0.02655249834060669, -0.03019276075065136, -0.03814245015382767, -0.0039413864724338055, -0.03905251622200012, -0.009997337125241756, 0.016769295558333397, 0.012653925456106663, -0.014159548096358776, -0.0030129188671708107, 0.008351189084351063, -0.023086220026016235, -0.02692723087966442, -0.0486082024872303, -0.03155785799026489, 0.02374200150370598, 0.0242773350328207, 0.0394807830452919, -0.031718458980321884, -0.03388655558228493, -0.014159548096358776, -0.03177199140191078, -0.012479942291975021, -0.024504851549863815, 0.024049818515777588, -0.017438460141420364, 0.016983427107334137, -0.01961994171142578, 0.0034027080982923508, 0.0007072245934978127, -0.015952913090586662, 0.02103857323527336, -4.8514521040488034e-05]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
"vidia.com/
deeplearning/nccl/user-guide/docs/env.
html , 2023.
Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright,
C. L., Mishkin, P., Zhang, C., Agarwal, S., Slama, K.,
Ray, A., Schulman, J., Hilton, J., Kelton, F., Miller, L.,
Simens, M., Askell, A., Welinder, P., Christiano, P., Leike,
J., and Lowe, R. Training language models to follow
instructions with human feedback. In Advances in Neural
Information Processing Systems , 2022.Park, J., Yoon, H., Ahn, D., Choi, J., and Kim, J. OPTIMUS:
optimized matrix multiplication structure for transformer
neural network accelerator. In Dhillon, I. S., Papailiopou-
los, D. S., and Sze, V . (eds.), Proceedings of Machine
Learning and Systems (MLSys) , 2020.
Paszke, A., Gross, S., Massa, F., Lerer, A., Bradbury, J.,
Chanan, G., Killeen, T., Lin, Z., Gimelshein, N., Antiga,
L., Desmaison, A., K ¨opf, A., Yang, E., DeVito, Z., Rai-
son, M., Tejani, A., Chilamkurthy, S., Steiner, B., Fang,
L., Bai, J., and Chintala, S. Pytorch: An imperative
style, high-performance deep learning library. Advances
in Neural Information Processing Systems , 2019.
Patel, P., Choukse, E., Zhang, C., ´I˜nigo Goiri, Shah, A.,
Maleki, S., and Bianchini, R. Splitwise: Efficient genera-
tive llm inference using phase splitting, 2023.
Pope, R., Douglas, S., Chowdhery, A., Devlin, J., Bradbury,
J., Levskaya, A., Heek, J., Xiao, K., Agrawal, S., and
Dean, J. Efficiently scaling transformer inference, 2022.
Ram, O., Levine, Y ., Dalmedigos, I., Muhlgay, D., Shashua,
A., Leyton-Brown, K., and Shoham, Y . In-context
retrieval-augmented language models, 2023.
Shoeybi, M., Patwary, M., Puri, R., LeGresley, P., Casper,
J., and Catanzaro, B. Megatron-lm: Training multi-
billion parameter language models using model paral-
lelism, 2020.
Thakur, R., Rabenseifner, R., and Gropp, W. Optimization
of collective communication operations in MPICH. The
International Journal of High Performance Computing
Applications , 19(1):49–66, 2005.
Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux,
M.-A., Lacroix, T., Rozi `ere, B., Goyal, N., Hambro, E.,
Azhar, F., Rodriguez, A., Joulin, A., Grave, E., and Lam-
ple, G. Llama: Open and efficient foundation language
models. In arXiv , 2023.
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones,
L., Gomez, A. N., Kaiser, L. u., and Polosukhin, I. Atten-
tion is all you need. In Advances in Neural Information
Processing Systems , 2017.
vLLM. https://docs.vllm.ai/en/latest/ .
Zhang, H., Song, H., Li, S., Zhou, M., and Song, D. A
survey of controllable text generation using transformer-
based pre-trained language models, 2023a.
Zhang, S., Roller, S., Goyal, N., Artetxe, M., Chen, M.,
Chen, S., Dewan, C., Diab, M., Li, X., Lin, X. V ., Mi-
haylov, T., Ott, M., Shleifer, S., Shuster, K., Simig, D.,
Koura, P. S., Sridhar, A., Wang, T., and Zettlemoyer, L.
Opt","[-0.020511912181973457, 0.02507011406123638, 0.011207816191017628, -0.0385570302605629, 0.018366875126957893, -0.003559419885277748, -0.015739206224679947, 0.024104848504066467, -0.056039080023765564, 0.026625266298651695, 0.035124972462654114, -0.020578943192958832, -0.036867816001176834, 0.012226708233356476, -0.004397324752062559, -0.011529571376740932, 0.041640520095825195, -0.025633186101913452, 0.023421118035912514, 0.05566369742155075, -0.004035349935293198, -0.00010829920938704163, -0.02456066757440567, 0.032738618552684784, 0.007936635054647923, 0.0027701135259121656, -0.01866181753575802, 0.03673375025391579, -0.011938468553125858, -0.019774556159973145, 0.03550035506486893, -0.02155761793255806, -0.03823527693748474, -0.030995776876807213, -0.022294973954558372, 0.02655823342502117, 0.04362468048930168, 0.009639257565140724, -0.0198683999478817, 0.045823343098163605, -0.0015987225342541933, -0.06590624898672104, -0.008332125842571259, 0.03539310395717621, -0.027885474264621735, 0.010691666044294834, 0.012749561108648777, -0.016007335856556892, 0.004434192553162575, 0.06183067709207535, -0.0053223720751702785, 0.015980521216988564, -0.028341295197606087, 0.002957804361358285, -0.045260269194841385, -0.006019508931785822, -0.0030885173473507166, 0.007494221441447735, 0.01909082569181919, -0.01734798215329647, -0.028502171859145164, -0.046466853469610214, 0.015672173351049423, 0.019948840141296387, -0.04139920324087143, -0.018755663186311722, -0.04499214142560959, 0.01791105419397354, -0.012226708233356476, 0.014224273152649403, -0.005483249668031931, -0.00702499458566308, 0.028609424829483032, -0.02804635278880596, -0.010135297663509846, 0.005794950295239687, -0.029547877609729767, 0.08022436499595642, -0.015672173351049423, -0.006559119559824467, 0.02596834860742092, -0.0029611559584736824, 0.008533223532140255, -0.01981477439403534, -0.044697199016809464, -0.0024433305952697992, -0.029038431122899055, 0.00927728321403265, -0.026196258142590523, -0.024064628407359123, -0.03158566355705261, -0.008928714320063591, -0.03415970504283905, -0.0006058052531443536, 0.05073011294007301, 0.03595617413520813, 0.0016272113425657153, -0.012166379019618034, 0.03104940429329872, 0.06579899787902832, -0.018594784662127495, 0.015471075661480427, 0.03225598484277725, -0.010490569286048412, 0.0027583828195929527, -0.019077418372035027, 0.002202013973146677, -0.059524763375520706, -0.01976114884018898, 0.042820289731025696, -0.11626097559928894, -0.006944555789232254, -0.0038912303280085325, -0.001980807166546583, 0.019881807267665863, -0.05512743815779686, 0.005845224484801292, 0.013889111578464508, -0.02509692683815956, -0.011234628967940807, -0.04416093975305557, -0.001409356016665697, 0.03850340470671654, -0.004762651398777962, 0.029199309647083282, -0.03879834711551666, 0.0134735107421875, -0.04177458584308624, 0.006746810395270586, -0.0165570005774498, 0.0028220636304467916, 0.00021188519895076752, 0.03727000951766968, -0.04086294397711754, -0.04188183695077896, -0.03045951947569847, -0.00877454038709402, 0.00705180736258626, -0.03053995780646801, 0.017642924562096596, 0.03397201746702194, -0.010135297663509846, -0.04311523586511612, 0.03297993540763855, -0.05158812925219536, -0.00982694886624813, -0.007929932326078415, -0.03968317434191704, -0.036224305629730225, 0.009116405621170998, -0.00246008881367743, 0.0032041482627391815, -0.035071346908807755, 0.02284463867545128, -0.057862360030412674, -0.04357105493545532, -0.031478412449359894, 0.07454001903533936, 0.037511326372623444, -0.06483373045921326, 0.024681326001882553, 0.05150768905878067, 0.01135528739541769, 0.012528354302048683, 0.024386383593082428, 0.03217554837465286, -0.0067702713422477245, -0.00024822933482937515, -0.06070453301072121, -0.05330415815114975, -0.004323589149862528, -0.029816007241606712, -0.03137115761637688, -0.04552840068936348, -0.008962230756878853, -0.04005855694413185, -0.03458871319890022, -0.042873919010162354, -0.030352266505360603, -0.04802200570702553, -0.0024416549131274223, 0.04775387421250343, -0.05220482498407364, -0.0013615954667329788, -0.055449195206165314, 0.021396739408373833, -0.021410144865512848, 0.029467439278960228, 0.0025690163020044565, 0.04118470102548599, -0.013272413052618504, 0.029011618345975876, 0.0510786809027195, 0.03938823193311691, 0.02941381372511387, 0.012233410961925983, 0.057272475212812424, -0.027014054358005524, 0.0026142632123082876, -0.03252411633729935, 0.030084136873483658, 0.05204394832253456, -0.025110334157943726, -0.06091903895139694, 0.016543593257665634, -0.00835223589092493, -0.01030287891626358, -0.001959021668881178, -0.02486901730298996, -0.0185545664280653, 0.03367707505822182, 0.032041482627391815, 0.039334606379270554, 0.0019456151640042663, -0.03222917392849922, -0.008399158716201782, -0.05850587040185928, 0.00649208715185523, 0.005352536216378212, 0.017307763919234276, 0.014586248435080051, 0.033891577273607254, -0.003142143366858363, 0.008452784270048141, -0.04011218249797821, 0.03115665540099144, 0.009351018816232681, -0.01998905837535858, 0.027402842417359352, -0.003871120512485504, 0.06510186195373535, -0.009203547611832619, 0.009659367613494396, -0.04429500550031662, -0.0176027063280344, -0.04475082457065582, 0.007822680287063122, -0.0006305234273895621, -0.001187311252579093, -0.03228279948234558, -0.002974562346935272, -0.0010917900362983346, 0.013285820372402668, 0.02584769017994404, 0.008466190658509731, 0.03367707505822182, -0.0319342315196991, -0.06000739708542824, 0.05400129407644272, 0.027912287041544914, 0.007366859819740057, -0.02574043907225132, -0.03115665540099144, -0.016154807060956955, -0.021034764125943184, 0.004836387000977993, -0.014800751581788063, 0.014599654823541641, -0.013956143520772457, 0.003529255511239171, -0.00973980687558651, 0.053625911474227905, -0.006823897361755371, 0.03938823193311691, -0.0038677689153701067, 0.015698986127972603, -0.05022066831588745, 0.02509692683815956, 0.0083924550563097, -0.003172307973727584, 0.02338089793920517, -0.017696551978588104, 0.011294958181679249, 0.0011546328896656632, -0.0777575746178627, -0.030888525769114494, 0.02638394944369793, 0.020954325795173645, -0.017616111785173416, 0.05695071816444397, 0.004638641607016325, 0.02866305038332939, 0.04319567233324051, 0.04979166015982628, 0.006475328933447599, 0.03102259151637554, 0.01614139974117279, -0.008325423114001751, -0.0321219228208065, -0.030834900215268135, 0.028636237606406212, 0.0003833414812106639, 0.006136815529316664, -0.04660091921687126, 0.03700188174843788, 0.03895922750234604, 0.010731886141002178, 0.03839615359902382, 0.023809906095266342, -0.01406339555978775, 0.0385570302605629, 0.00035464324173517525, -0.017213918268680573, -0.012079237028956413, -0.009310798719525337, 0.04185502603650093, -0.026008568704128265, -0.030110949650406837, 0.03550035506486893, -0.025056708604097366, -0.0013741640141233802, 0.002409814391285181, -0.0024952806998044252, 0.005918960087001324, -0.03708231821656227, -0.034964095801115036, 0.023421118035912514, -0.04180140048265457, 0.010262658819556236, -0.048290133476257324, -0.028555799275636673, -0.022656947374343872, -0.01968071050941944, -0.0058284662663936615, -0.0259951613843441, 0.04016580805182457, -0.007219388615339994, -0.0033834599889814854, -0.011080454103648663, -0.014519215561449528, 0.027416247874498367, 0.004249853547662497, 0.03464233875274658, 0.0021634704899042845, -0.023514963686466217, -0.02374287322163582, -0.030995776876807213, 0.04121151566505432, 0.009344315156340599, -0.00519165862351656, -0.08027799427509308, -0.007996964268386364, -0.041667334735393524, -0.0001262094301637262, -0.032014671713113785, 0.007822680287063122, -0.011160893365740776, 0.021289488300681114, 0.05113230645656586, 0.03222917392849922, 0.01362768467515707, -0.0600610226392746, 0.03180016577243805, -0.007266310974955559, -0.00835223589092493, 0.022415632382035255, -0.0015501240268349648, -0.0098671680316329, 0.009237063117325306, 0.019131043925881386, -0.02071300894021988, 0.026732517406344414, 0.02941381372511387, 0.0003148427640553564, -0.0394686721265316, 0.02014993689954281, 0.0024986322969198227, 0.028582612052559853, -0.016945788636803627, -0.00976661965250969, 0.0460914708673954, 0.014184053987264633, -0.02073982171714306, 0.009961013682186604, -0.029735568910837173, 0.006351319141685963, -0.01080562174320221, 0.016288870945572853, -0.010812324471771717, 0.03761857748031616, 0.013574059121310711, 0.004936935380101204, -0.003750462317839265, -0.008271796628832817, -0.022000031545758247, 0.028314482420682907, 0.007393672596663237, -0.008834869600832462, 0.016101179644465446, 0.03236323967576027, -0.001550961984321475, -0.002865634625777602, -0.06301044672727585, 0.04126514121890068, 0.03110302984714508, 0.0021131960675120354, 0.01953323930501938, 0.02212068997323513, 0.025954941287636757, 0.017495453357696533, 0.005918960087001324, -0.0006477005081251264, -0.02705427259206772, -0.006026212126016617, 0.0011429022997617722, 0.025190772488713264, 0.023528369143605232, 0.05019385367631912, -0.003091868944466114, 0.024104848504066467, 0.04665454477071762, -0.05496656149625778, 0.0003311819164082408, -0.008305313065648079, 0.023488149046897888, -0.027965914458036423, 0.014867784455418587, 0.026826363056898117, 0.0257672518491745, 0.05990014597773552, -0.03418651968240738, -0.001045705284923315, -0.022777605801820755, -0.041050635278224945, -0.03595617413520813, 0.00882816594094038, 0.027778223156929016, -0.0756661668419838, -0.0034354100935161114, -0.040487565100193024, -0.022522883489727974, 0.0016515105962753296, 0.04477763548493385, -0.020927513018250465, -0.00973980687558651, -0.061455294489860535, 0.009927497245371342, 0.04810244217514992, 0.05158812925219536, -0.048853207379579544, 0.006471977569162846, 0.0073065306060016155, -0.05287514999508858, -0.018125558272004128, -0.013084722682833672, 0.0019741039723157883, -0.010322988033294678, 0.026705704629421234, -0.0007335857371799648, -0.04263260215520859, 0.029038431122899055, -0.011549681425094604, 0.0697673112154007, 0.0020997896790504456, 0.0024248966947197914, -0.04311523586511612, 0.07169784605503082, -0.01622183807194233, 0.06295682489871979, 0.004035349935293198, 0.027885474264621735, -0.006636206526309252, -0.017803803086280823, -0.053036026656627655, -0.0016624033451080322, 0.025525934994220734, 0.030915338546037674, -0.01580623723566532, 0.030888525769114494, 0.0004931070143356919, -0.003914691507816315, -0.01891654171049595, -0.022777605801820755, -0.024386383593082428, 0.03292630985379219, 0.023541776463389397, 0.01742842234671116, -0.05432305112481117, -0.006659667938947678, -0.034964095801115036, 0.034454647451639175, -0.02582087740302086, -0.0033767567947506905, 0.015497888438403606, 0.018366875126957893, 0.0597928911447525, 0.010423536412417889, 0.0038577141240239143, 0.0011579846031963825, 0.0025103630032390356, 0.0036029911134392023, -0.017227323725819588, 0.04421456530690193, -0.015135914087295532, 0.015484482049942017, -0.01591349020600319, -0.04544796049594879, -0.03657287359237671, 9.57830052357167e-05, -0.03839615359902382, -0.005124626215547323, -0.022362004965543747, -0.003085165750235319, 0.01497503649443388, -0.0011864732950925827, -0.01404998917132616, 0.05113230645656586, 0.005637424066662788, 0.0008458649972453713, 0.039790429174900055, -0.0045950706116855145, -0.005731269251555204, 0.0005002292455174029, 0.0238635316491127, 0.0088013531640172, 0.04241809621453285, -0.02360880747437477, 0.007286421023309231, 0.0041358983144164085, 0.02871667593717575, 0.00013448373647406697, -0.017361389473080635, -0.0005375159671530128, -0.031397972255945206, 0.022750793024897575, 0.014465590007603168, -0.028528986498713493, -0.07679230719804764, -0.02456066757440567, 0.003971669357270002, 0.006575877778232098, -0.0035460134968161583, -0.01611458696424961, -0.02088729292154312, -0.05931026116013527, -0.006341264117509127, 0.01243450865149498, -0.02191959135234356, -0.061991553753614426, 0.016999414190649986, 0.005818411707878113, 0.03297993540763855, 0.006237363908439875, 0.019694115966558456, -0.0041459533385932446, -0.01439855806529522, 0.020954325795173645, -0.005195010453462601, -0.010095078498125076, 0.03633155673742294, 0.05276789888739586, -0.029118871316313744, -0.007293124217540026, -0.02453385479748249, -0.0019774555694311857, -0.019265109673142433, 0.01650337502360344, 0.007909822277724743, -0.013594169169664383, 0.0023394303862005472, 0.021731901913881302, -0.02138333208858967, -0.011502758599817753, 0.004099030513316393, -0.026571640744805336, -0.025271210819482803, 0.002865634625777602, -0.009237063117325306, 0.003750462317839265, 0.0006506331264972687, -0.007380266208201647, -0.04249853640794754, 0.026142632588744164, 0.01670447178184986, -0.0016883783973753452, -0.05022066831588745, 0.011563087813556194, 0.00780257023870945, -0.016489967703819275, 0.02094091847538948, -0.0553419403731823, -0.016691066324710846, -0.008680694736540318, -0.029547877609729767, -0.030084136873483658, 0.03297993540763855, -0.03306037560105324, 0.0177367702126503, -0.04603784531354904, 0.0028220636304467916, 0.05802323669195175, -0.041667334735393524, -0.02692020870745182, -0.06038277968764305, -0.04054119065403938, -0.013111535459756851, 0.020672788843512535, -0.038074396550655365, -0.030245015397667885, 0.0015668821288272738, 0.004903419408947229, -0.007675208617001772, -0.022321786731481552, -0.012803186662495136, -0.0019623732659965754, -0.011723965406417847, -0.024265725165605545, 0.006079837679862976, -0.01406339555978775, -0.005855279508978128, -0.00881475955247879, -0.01585986465215683, 0.0003929773811250925, -0.027805035933852196, -0.013982957229018211, -0.0074271890334784985, -0.009692884050309658, -0.014680094085633755, 0.045126207172870636, -0.007507627829909325, -0.0018769069574773312, -0.03362344577908516, -0.0044911704026162624, 0.010242549702525139, 0.013057909905910492, 0.019104231148958206, -0.00835223589092493, -0.01559173408895731, -0.04633278772234917, 0.00978002604097128, -0.05113230645656586, -0.014170647598803043, 0.05850587040185928, 0.030808087438344955, -0.002046163659542799, -0.002374622505158186, -0.0027164877392351627, -0.022187720984220505, 0.015819644555449486, -0.03708231821656227, -0.015216352418065071, 0.022496070712804794, 0.0017101638950407505, -0.019586864858865738, 0.036894626915454865, -0.004822980612516403, -0.02464110776782036, 0.004605125170201063, -0.019493019208312035, -0.001970752375200391, -0.032041482627391815, -0.030754461884498596, 0.027697784826159477, 0.014908003620803356, 0.031451597809791565, -0.008754430338740349, -0.0038912303280085325, -0.02405122108757496, -0.0026209664065390825, -0.0014336552703753114, -0.06354670971632004, 0.0005815059994347394, 0.006827249191701412, 0.004055459517985582, -0.003981723915785551, 0.03415970504283905, 0.01667765900492668, 0.04131876677274704, -0.004021943546831608, -0.004926880821585655, -0.007621583063155413, 0.006599338725209236, -0.0006418351549655199, -0.010276065208017826, -0.0024416549131274223, -0.021101796999573708, 0.01804511994123459, -0.022750793024897575, 0.0108190281316638, 0.013667904771864414, -0.0328458733856678, 0.02071300894021988, -0.057755108922719955, -0.017803803086280823, 0.00500396778807044, 0.001871879561804235, 0.03292630985379219, 0.00244500651024282, 0.017307763919234276, -0.010349800810217857, -4.5377786591416225e-05, -0.013694717548787594, 0.003703539725393057, -0.03104940429329872, -0.0012451267102733254, -0.01496163010597229, -0.008573442697525024, 0.053062841296195984, -0.012079237028956413, -0.08682035654783249, -0.01639612205326557, 0.007594769820570946, -0.03434739634394646, 0.008901901543140411, -0.013728233985602856, -0.012146268971264362, -0.029521064832806587, 0.005272097419947386, 0.03997811675071716, -0.015457669273018837, -0.023179801180958748, -0.001409356016665697, -0.013969549909234047, 0.017482047900557518, -0.03158566355705261, 0.02551252767443657, 0.03045951947569847, -0.00569775328040123, -0.007869603112339973, -0.024721546098589897, -0.04426819086074829, 0.017240731045603752, -0.01000793557614088, -0.011730668134987354, 0.006495438516139984, -0.028394920751452446, -0.02389034442603588, 0.007333343382924795, -0.00310192396864295, 0.02874348871409893, 0.012481431476771832, 0.0069847749546170235, 0.0156051404774189, -0.03303356096148491, -0.0011680393945425749, 0.018433908000588417, -0.039817240089178085, -0.01829984225332737, -0.051802631467580795, -0.018138965591788292, -0.028609424829483032, -0.013822078704833984, -0.003941504750400782, 0.05030110478401184, 0.012333960272371769, -0.015926895663142204, 0.013178568333387375, 0.008633771911263466, 0.01552470214664936, 0.00352590368129313, -0.06719326972961426, 0.011677042581140995, 0.033274877816438675, -0.006857413798570633, -0.017951274290680885, -0.02197321690618992, 0.026370542123913765, -0.012977470643818378, -0.015216352418065071, -0.00031232903711497784, 0.009599038399755955, 0.0008303637732751667, -0.010705072432756424, 0.015672173351049423, 0.012374179437756538, -0.027443060651421547, -0.008171248249709606, -0.007688615471124649, -0.012776373885571957, 0.026987241581082344, -0.0300305113196373, -0.029494252055883408, 0.028368107974529266, -0.014184053987264633, 0.019627084955573082, 0.004796167369931936, 0.00123674760106951, 0.02809997834265232, 0.0035024425014853477, -0.007433892227709293, -0.022804418578743935, -0.0031756595708429813, 0.01647656224668026, -0.04606465995311737, -0.012608792632818222, -0.04842419922351837, -0.0650482326745987, -0.017307763919234276, 0.01561854686588049, -0.0484510138630867, -0.03654605895280838, 0.012085939757525921, 0.024734951555728912, 0.003351619467139244, -0.0072126854211091995, 0.04083613306283951, 0.00020790514827240258, -0.07877646386623383, -0.045260269194841385, 0.010845840908586979, -0.004340347368270159, 0.022804418578743935, -0.030861712992191315, 0.023796498775482178, 0.009552115574479103, 0.015725798904895782, -0.04185502603650093, -0.001819929457269609, -0.011469242163002491, 0.002381325699388981, 0.002721515018492937, 0.025499122217297554, -0.07454001903533936, 0.00836564227938652, -0.04434863105416298, 0.03836933895945549, -0.0037940333131700754, -0.040487565100193024, 0.005680995061993599, -0.003961614333093166, 0.02001587115228176, -0.023541776463389397, -0.019935432821512222, 0.017240731045603752, 0.02807316556572914, -0.022750793024897575, 0.01650337502360344, -0.052338890731334686, -0.03539310395717621, -0.003830901114270091, 0.0371091328561306, -0.03217554837465286, 0.012749561108648777, -0.016972601413726807, -0.012354069389402866, -0.01732116937637329, -0.016610626131296158, -0.026223070919513702, -0.05266064777970314, 0.030298640951514244, -0.016583813354372978, 0.044053688645362854, 0.0065892841666936874, 0.03367707505822182, -0.017200510948896408, 0.005882092285901308, -0.008600255474448204, 0.009163327515125275, -0.003380108391866088, 3.634412496467121e-05, 0.023206613957881927, 0.011797701008617878, -0.01257527619600296, -0.02104817144572735, -0.006810490973293781, 0.0453675240278244, 0.026169445365667343, 0.009746509604156017, 0.007152356207370758, -0.018648412078619003, -0.02009631134569645, -0.03651924803853035, -0.015068881213665009, -0.009712993167340755, 0.03469596430659294, -0.02936018817126751, -0.0489068329334259, -0.011663636192679405, 0.05220482498407364, 0.010242549702525139, 0.008077403530478477, 0.0206861961632967, -0.013755046762526035, 0.030754461884498596, 0.038074396550655365, -0.0018048471538349986, -0.015900082886219025, -0.0031873902771621943, -0.02553934045135975, 0.006264177151024342, 0.0009987825760617852, 0.008459487929940224, 0.028984805569052696, 0.014519215561449528, -0.005067648831754923, -0.014009770005941391, 0.04930902644991875, 0.03965636342763901, -0.00978002604097128, 0.024520449340343475, -0.019948840141296387, 0.02553934045135975, 0.006606042385101318, -0.011274848133325577, 0.020391253754496574, 0.020793447270989418, -0.017280951142311096, 0.04083613306283951, 0.04778068885207176, -0.047110363841056824, -0.03595617413520813, -0.00232267240062356, 0.02073982171714306, 0.0019255054648965597, -0.0035929360892623663, 0.009156624786555767, -0.0055167656391859055, 0.022670354694128036, 0.006545713171362877, -0.015377230942249298, 0.032604556530714035, 0.010322988033294678, 0.015926895663142204, 0.015900082886219025, 0.04426819086074829, 0.025981754064559937, 0.01701282151043415, 0.016771504655480385, 0.017830615863204002, -0.030405892059206963, -0.021959811449050903, -0.04198908805847168, -0.036197490990161896, 0.004752596374601126, 0.003934801556169987, -0.035661231726408005, -0.013507027179002762, 0.012796483933925629, 0.002617614809423685, 0.005077703855931759, -0.016208432614803314, -0.02574043907225132, 0.013808672316372395, 0.011160893365740776, 0.02509692683815956, -0.02486901730298996, 0.027322402223944664, 0.023528369143605232, 0.003968317527323961, 0.01247472781687975, 0.013493620790541172, 0.0060630799271166325, -0.0018115503480657935, 0.012789780274033546, -0.04606465995311737, -0.026089007034897804, 0.004993913229554892, 0.023756278678774834, 0.014881190843880177, -0.02102135866880417, 0.050059787929058075, -0.00040303225978277624, -0.017951274290680885, -0.0023327271919697523, -0.04807563126087189, -0.008613661862909794, 0.03493728116154671, 0.030164575204253197, 0.024064628407359123, 0.005335778463631868, -0.00990738719701767, 0.017160292714834213, -0.011556384153664112, -0.016798317432403564, -0.008600255474448204, -0.03718956932425499, 0.015926895663142204, -0.007970151491463184, -0.0012660742504522204, 0.03788670897483826, 0.025190772488713264, 0.010068264789879322, 0.007675208617001772, 0.01639612205326557, 0.0033147516660392284, 0.010262658819556236, 0.004008537158370018, 0.024976268410682678, 0.014706906862556934, -0.040514376014471054, 0.01956005208194256, 0.008928714320063591, 0.006455219350755215, 0.024011002853512764, 0.007454001810401678, 0.005456436425447464, 0.03059358336031437, -0.013332742266356945, 0.0046788607724010944, 0.015484482049942017, 0.05166856572031975, -0.0021282783709466457, -0.042873919010162354, 0.03115665540099144, 0.04131876677274704, -0.02122245542705059, -0.0335698202252388, -0.015993928536772728, 0.04265941306948662, 0.007480815052986145, -0.0002832118480000645, -0.04847782477736473, 0.04142601788043976, -0.019694115966558456, -0.018742255866527557, 0.004963748622685671, 0.03893241286277771, 0.003472277894616127, -0.008110919035971165, -0.03155884891748428, 0.030218202620744705, -0.010503975674510002, -0.036760564893484116, 0.009733103215694427, -0.009243766777217388, -0.00273324572481215, -0.021463772282004356, -0.03912010416388512, -0.015296791680157185, -0.0077288346365094185, -0.007588066626340151, -0.023206613957881927, 0.00837904866784811, -0.0015752612380310893, 0.0005140546709299088, -0.010798918083310127, -0.007293124217540026, 0.00392139470204711, -0.002766761928796768, 0.018702037632465363, 0.012441211380064487, 0.00878794677555561, -0.01561854686588049, 0.007460705004632473, -0.0037370556965470314, -0.0037471107207238674, 0.00035610958002507687, 0.03558079153299332, 0.009599038399755955, 0.013279116712510586, 0.006803787779062986, 0.0013297550613060594, 0.015310198068618774, 0.020498504862189293, 0.03343575820326805, -0.025753844529390335, -0.018232811242341995, 0.0061468700878322124, -0.004883309826254845, 0.02073982171714306, -0.013848892413079739, 0.01045705284923315, 0.006877523381263018, 0.029306560754776, 0.04477763548493385, 0.019935432821512222, 0.04493851587176323, -0.015269978903234005, 0.04145283252000809, 0.0124076958745718, -0.011549681425094604, -0.004397324752062559, -0.016583813354372978, -0.004028646741062403, -0.008305313065648079, 0.021007951349020004, 0.009532006457448006, -0.058291368186473846, 0.01906401291489601, -0.0017813857411965728, 0.018594784662127495, -0.010282768867909908, -0.015444262884557247, -0.009042670018970966, -0.010953092947602272, -0.005603908095508814, 0.029145684093236923, -0.04593059420585632, -0.02484220452606678, 0.012649011798202991, -0.007346750237047672, 0.01591349020600319, 0.01596711575984955, -0.02040465921163559, 0.001947290962561965, 0.026142632588744164, -0.029145684093236923, -0.013795265927910805, 0.03276543319225311, -0.023769685998558998, 0.004628586582839489, -0.03287268429994583, 0.016583813354372978, -0.0027231909334659576, 0.009451567195355892, 0.01152286771684885, -0.019385768100619316, 0.02871667593717575, 0.01984158717095852, 0.018205996602773666, -0.006860765162855387, 0.002478522714227438, 0.014197460375726223, -0.001960697351023555, -0.05984652042388916, -0.00175624864641577, -0.0031706320587545633, -0.023595402017235756, 0.032014671713113785, -0.007494221441447735, 0.00021638894395437092, 0.004849793389439583, 0.005935718305408955, -0.011784294620156288, -0.03643880784511566, 0.029092058539390564, -0.012166379019618034, 0.006870820187032223, -0.006602690555155277, 0.004501224961131811, 0.0019523183582350612, -0.015645360574126244, -0.020257188007235527, 0.0220938753336668, -0.012722747400403023, 0.02944062650203705, 0.020780041813850403, 0.013553949072957039, -0.002357864286750555, -0.009552115574479103, 0.01043024007230997, -0.017388202250003815, -0.0061669801361858845, -0.02448022924363613, -0.0010599496308714151, 0.0034002179745584726, -0.029494252055883408, 0.056575339287519455, 0.011656932532787323, -0.014264493249356747, 0.006257473491132259, -0.0043705119751393795, 0.0026326971128582954, -0.02927974797785282, 0.014948222786188126, 0.030808087438344955, -0.01968071050941944, 0.06874842196702957, -0.013902517966926098, -0.012340663000941277, -0.005285504274070263, -0.008566739968955517, 0.039200540632009506, -0.018675224855542183, 0.010698369704186916, -0.04174777492880821, 0.005469843279570341, -0.006870820187032223, 0.00601280527189374, -0.030995776876807213, -0.027241963893175125, 0.024976268410682678, -0.022026844322681427, -0.002190283266827464, 0.0035560682881623507, -0.004849793389439583, 0.0010163786355406046, 0.03340894356369972, 0.013091426342725754, -0.015350417234003544, -0.016918975859880447, -0.0004591718898154795, 0.012179785408079624, -0.012850109487771988, -0.0032393403816968203, 0.02371606044471264, 0.050032977014780045, 0.004655399359762669, -0.04976484552025795, -0.03509816154837608, 0.006234012544155121, -0.01824621669948101, 0.018098745495080948, -0.027376027777791023, 0.017978087067604065, -0.03595617413520813, -0.008821462281048298, 0.03222917392849922, -0.00886838510632515, -0.006632855162024498, 0.0119987977668643, -0.03281905874609947, -0.003120357869192958, -0.027965914458036423, -0.006136815529316664, 0.001074194093234837, -0.0008471218170598149, -0.01360087189823389, -0.013044503517448902, 0.018393687903881073, -0.019318735226988792, -0.008647178299725056, -0.017026226967573166, -0.0014504133723676205, 0.04292754456400871, 0.006136815529316664, 0.03131753206253052, -0.026236478239297867, 0.014519215561449528, -0.028475359082221985, -0.0014596303226426244, -0.008861682377755642, -0.03721638396382332, -0.02607559971511364, 0.006585932336747646, -0.0028673105407506227, 0.034427836537361145, 0.00784278940409422, -0.007822680287063122, 0.009015856310725212, 0.006280934903770685, 0.016074366867542267, 0.007883009500801563, 0.014733719639480114, 0.006220605690032244, 0.01768314465880394, 0.04724442958831787, -0.03000369854271412, 0.007413782645016909, -0.0218659657984972, 0.04534070938825607, 0.021544210612773895, -0.02537846378982067, 0.010336394421756268, -0.039227355271577835, -0.02753690630197525, -0.002744976431131363, 0.002726542530581355, 0.002783520147204399, 0.05791598558425903, 0.02761734463274479, -0.024212099611759186, -0.005429623648524284, -0.025914723053574562, 0.005245284643024206, 0.04858507588505745, -0.0031387917697429657, -0.009310798719525337, -0.010550898499786854, -0.02995007298886776, 0.011000015772879124, -0.016717879101634026, 0.004119140561670065, -0.031505223363637924, 0.001959021668881178, -0.00015668821288272738, -0.007554550655186176, 0.0013791914097964764, -0.01185803022235632, 0.04485807567834854, -0.009129812009632587, 0.018205996602773666, -0.01142231933772564, 0.00013794009282719344, 0.026853175833821297, -0.0176027063280344, -0.03104940429329872, 0.02582087740302086, 0.0004947828128933907, 0.04421456530690193, 0.01403658278286457, -0.02358199469745159, -0.021798932924866676, 0.019493019208312035, -0.01552470214664936, 0.012488134205341339, 0.012018907815217972, -0.015819644555449486, -0.016905568540096283, 0.0044744121842086315, -0.003901285119354725, 0.02191959135234356, 0.02663867175579071, 0.022549696266651154, -0.013929330743849277, -0.012005501426756382, -0.0003089774399995804, 0.01348691713064909, 0.05700434371829033, 0.007299827411770821, 0.039254169911146164, 0.0342937707901001, -0.010028045624494553, -0.004129195120185614, -0.013835485093295574, 0.02096773125231266, -0.007688615471124649, -0.003323130775243044, 0.0015962087782099843, 0.007983557879924774, 0.004873254802078009, 0.016489967703819275, -0.01553810853511095, -0.02610241249203682, -0.0310762170702219, -0.005111219827085733, -0.011281551793217659, 0.008928714320063591, 0.01410361472517252, -0.003663320094347, 0.01557832770049572, 0.032577741891145706, -0.05408173426985741, -0.03155884891748428, 0.02006949856877327, 0.01500184927135706, 0.0005505034932866693, -0.022335192188620567, 0.02944062650203705, -0.01596711575984955, -0.015283385291695595, 0.0023142932914197445, -0.010215735994279385, -0.006207199301570654, 0.01201220415532589, 0.0007612365880049765, -0.005969234276562929, 0.0017143534496426582, 0.0011102239368483424, 0.0064686257392168045, -0.010966499336063862, -0.03335531800985336, 0.0063747805543243885, -0.01553810853511095, 0.008204764686524868, -0.03241686522960663, -0.0023712709080427885, -0.0025975052267313004, -0.018795883283019066, 0.009759915992617607, 0.013124941848218441, 0.0045682573691010475, 0.024828797206282616, 0.001975779654458165, 0.04265941306948662, 0.05038154497742653, -0.0074204858392477036, 0.007293124217540026, -0.01762951910495758, 0.0005417055217549205, -0.004900067579001188, -0.004524686373770237, 0.03110302984714508, 0.018648412078619003, 0.011281551793217659, -0.004809574224054813, -0.020672788843512535, -0.00416941475123167, -0.02868986316025257, 0.005020726006478071, 3.095011197729036e-05, 0.018903134390711784, -0.0028807169292122126, 0.00702499458566308, 0.004538092762231827, -0.04118470102548599, -0.00781597662717104, 0.009170031175017357, 0.0028053056448698044, 0.006743458565324545, -0.0035393103025853634, -0.014478996396064758, 0.022858045995235443, -0.002433275803923607, -0.030674021691083908, 0.010249252431094646, 0.045823343098163605, 0.009800135158002377, 0.01624865084886551, 0.02027059532701969, 0.004769354593008757, -0.0047928160056471825, 0.0008069024188444018, 0.020833667367696762, 0.0019690764602273703, 0.012689231894910336, 0.01287021953612566, 0.0023612158838659525, 0.018259624019265175, 0.017187105491757393, 0.05668259039521217, -0.04593059420585632, 0.05914938077330589, 0.04257897660136223, 0.03692144155502319, -0.02389034442603588, 0.03727000951766968, -0.00567094050347805, 0.01565876603126526, 0.0026846472173929214, -0.03603661432862282, 0.004621883388608694, -0.045796528458595276, -0.01765633188188076, -0.019720928743481636, 0.012400992214679718, -0.003861065721139312, -0.0034990909043699503, -0.02014993689954281, -0.0006330371252261102, -0.00015501239977311343, -0.0281267911195755, 0.04172096028923988, -0.020806854590773582, 0.015283385291695595, -0.0024517097044736147, -0.009069482795894146, 0.006877523381263018, -0.019412580877542496, 0.00547989783808589, -0.01142231933772564, -0.00837904866784811, 0.03048633225262165, 0.01138210017234087, -0.01254846341907978, 0.03244367614388466, -0.017696551978588104, -0.0008131866925396025, 0.01953323930501938, -0.0187824759632349, -0.005332426633685827, 0.009712993167340755, -0.0008224036428146064, -0.027724597603082657, -0.012481431476771832, 0.011529571376740932, 0.016610626131296158, -0.030700834468007088, -4.9305464926874265e-05, 0.019318735226988792, -0.03895922750234604, -0.0062608253210783005, 0.009773322381079197, -0.013641091994941235, -0.01801830716431141, 0.010638040490448475, 0.04922858625650406, -0.024118253961205482, -0.030968964099884033, 0.004983858205378056, 0.03708231821656227, 0.013889111578464508, 0.05164175480604172, -0.012682528235018253, 0.03000369854271412, -0.02941381372511387, 0.003777275327593088, -0.02012312412261963, 0.014224273152649403, -0.015082287602126598, 0.022831233218312263, -0.010772105306386948, 0.012287037447094917, 0.0021450365893542767, 0.020418066531419754, -0.0032912904862314463, 0.034320585429668427, 0.003485684283077717, -0.009015856310725212, 0.008358939550817013, 0.026089007034897804, 0.01683853752911091, 0.007152356207370758, -0.005808356683701277, 0.056039080023765564, 0.04306160658597946, 0.007205982226878405, 0.032658182084560394, -0.0027818442322313786, 0.016101179644465446, 0.008177951909601688, -0.025016488507390022, 0.008667288348078728, 0.006096595898270607, 0.018433908000588417, 0.03541991487145424, -0.03335531800985336, -0.024520449340343475, 6.692765600746498e-05, 0.008989043533802032, -0.012065830640494823, -0.016798317432403564, -0.015028662048280239, -0.00896893348544836, 0.009371127933263779, -0.008358939550817013, -0.004310182761400938, 0.04847782477736473, 0.02938700094819069, 0.0010641391854733229, -0.01501525565981865, 0.02751009352505207, 0.03818165138363838, 0.017213918268680573, -0.029574690386652946, -0.039334606379270554, -0.0034119486808776855, -0.050596047192811966, -0.009203547611832619, 0.03196104243397713, 0.007936635054647923, 0.016972601413726807, 0.022549696266651154, -0.0040588113479316235, -0.028957992792129517, -0.026450982317328453, -0.02419869415462017, -0.017334576696157455, 0.04542114958167076, 0.02484220452606678, 0.020525317639112473, -0.025445494800806046, -0.0011286578373983502, -0.008070699870586395, -0.01301098708063364, -0.009397941641509533, -0.011951874941587448, 0.018232811242341995, -0.017227323725819588, -0.008781243115663528, -0.016235245391726494, 0.015645360574126244, 0.018112152814865112, -0.01035650447010994, 0.02638394944369793, -0.007219388615339994]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
": Open pre-trained transformer language models. In
arXiv , 2022a.
10
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
Zhang, T., Ladhak, F., Durmus, E., Liang, P., McKeown,
K., and Hashimoto, T. B. Benchmarking large language
models for news summarization, 2023b.
Zhang, Y ., Liu, W., Wang, X., and Shaheer, M. A. A novel
hierarchical hyper-parameter search algorithm based on
greedy strategy for wind turbine fault diagnosis. Expert
Systems with Applications , 202:117473, 2022b.
11
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
Network4 GPUs 8 GPUs
Context Method Method
Length TSP KVR-S SpeedUp × TSP KVR-S SpeedUp ×
Llama 7B1k 0.107 0.097 1.11 0.117 0.098 1.19
2k 0.111 0.100 1.11 0.117 0.103 1.14
4k 0.20 0.17 1.17 0.12 0.11 1.14
8k 0.54 0.41 1.30 0.30 0.22 1.36
12k 1.06 0.76 1.39 0.57 0.41 1.37
16k 1.76 1.24 1.42 0.92 0.65 1.41
Llama 13B1k 0.140 0.126 1.12 0.150 0.129 1.16
2k 0.143 0.131 1.09 0.153 0.131 1.17
4k 0.32 0.29 1.12 0.19 0.16 1.17
8k 0.87 0.68 1.27 0.49 0.36 1.35
12k 1.71 1.25 1.36 0.91 0.66 1.37
16k 2.89 2.05 1.41 1.46 1.05 1.39
Llama 30B1k 0.21 0.20 1.08 0.23 0.19 1.19
2k 0.28 0.26 1.06 0.24 0.20 1.19
Falcon 1B1k 0.073 0.061 1.18 0.081 0.066 1.23
2k 0.067 0.060 1.12 0.079 0.065 1.23
4k 0.09 0.07 1.26 0.08 0.06 1.21
8k 0.25 0.19 1.28 0.15 0.10 1.58
Falcon 7B1k 0.107 0.095 1.12 0.119 0.096 1.24
2k 0.117 0.103 1.13 0.118 0.099 1.20
4k 0.28 0.21 1.30 0.18 0.12 1.47
8k 0.78 0.54 1.46 0.47 0.29 1.63
Table 1. Top-1 accuracy with ImageNet1k: KV-Runahead outperforms other schemes with various pruning rates.
A. Additional Experiments
In this section, we present additional results with a wider range of LLMs using both long and short contexts to confirm that
KV-Runahead will generalize well across a broader spectrum of LLMs. We experimented with Falcon 1B, Llama 13B, and
Llama 30B, (in addition to Llama 7B and Falcon-7B from Section 5) and summarize the results in Table 1 where we can
observe the followings:
•KVR-S consistently outperforms TSP for all cases across 4 and 8 GPUs over high bandwidth network.
• The speedup from KVR-S is less with shorter inputs (as attention","[-0.015365252271294594, -0.008047783747315407, 0.02895483747124672, -0.039866600185632706, 0.002948109293356538, 0.019231624901294708, 0.004779266659170389, 0.04000980034470558, -0.03989524021744728, 0.056162647902965546, -0.008599099703133106, -0.005355642642825842, -0.025374863296747208, 0.009136095643043518, -0.002887249691411853, -0.010883123613893986, 0.003809093264862895, -0.01553709153085947, -0.024673188105225563, 0.01916002668440342, -0.027637407183647156, -0.04476400837302208, -0.006676653400063515, 0.031246021389961243, 0.012336594052612782, -0.02086409367620945, -0.041699547320604324, 0.01207167562097311, 0.03766133636236191, -0.07790025323629379, 0.015723250806331635, -0.02226744405925274, -0.09159007668495178, -0.041928667575120926, -0.010475006885826588, 0.06770448386669159, 0.008985737338662148, 0.0027261509094387293, -0.01553709153085947, 0.02420063130557537, 0.020935693755745888, -0.06890735775232315, -0.07503627240657806, -0.0012896859552711248, 0.023699434474110603, -0.003683794289827347, 0.0051301042549312115, 0.012085995636880398, -0.02444406971335411, 0.05882614850997925, 0.009064496494829655, 0.028797319158911705, -0.015250693075358868, -0.007381908595561981, -0.01089028362184763, -0.0002975854149553925, 0.042186424136161804, -0.009844930842518806, 0.028854597359895706, -0.014692217111587524, -0.0044069490395486355, -0.06335123628377914, 0.0030376086942851543, -0.0029785390943288803, -0.03388088196516037, -0.004338929429650307, -0.02243928238749504, 0.0052160234190523624, -0.0004788216610904783, 0.02298343926668167, -0.021580088883638382, -0.004721987061202526, 0.0513511598110199, -0.020334258675575256, -0.005785239394754171, 0.030214989557862282, -0.0035889248829334974, 0.03978068009018898, 0.031102823093533516, 0.0020835453178733587, 0.0186015497893095, -0.00238068331964314, 0.044305771589279175, -0.003656944492831826, 0.020047860220074654, -0.03783317655324936, -0.008334181271493435, 0.0033956062979996204, -0.019145706668496132, -0.024057431146502495, -0.016095567494630814, 0.01878770813345909, 0.0051515838131308556, 0.0049546854570508, 0.0636376366019249, 0.05335594713687897, 0.037861816585063934, -0.03551335260272026, 0.03327944874763489, 0.07188589870929718, 0.026291336864233017, 0.0345395989716053, 0.04043939709663391, -0.013553785160183907, 0.03474007546901703, -0.0040811714716255665, -0.015250693075358868, 0.014749497175216675, 0.0003199602651875466, 0.007625346537679434, -0.0979481115937233, -0.002790590515360236, -0.06312211602926254, 0.031160101294517517, 0.0017094380455091596, -0.05178075656294823, -0.049489572644233704, -0.010238728486001492, -0.016868842765688896, -0.00722080934792757, -0.0028800899162888527, 0.01089028362184763, 0.02208128571510315, -0.031188741326332092, 0.014162381179630756, -0.015837809070944786, -0.005964238196611404, -0.02256816253066063, -0.0004944840329699218, -0.007897424511611462, -0.011047802865505219, 0.015336613170802593, 0.06690257042646408, -0.0029176794923841953, -0.012214874848723412, -0.00498690502718091, -0.034825995564460754, -0.0019045466324314475, -0.05498841404914856, 0.016496524214744568, -0.011892677284777164, 0.003288207110017538, -0.010353287681937218, 0.02335575595498085, -0.05733687803149223, 0.04356113448739052, -0.014620617963373661, 0.009708892554044724, -0.041985947638750076, 0.0221385657787323, -0.03236297518014908, -0.0031306880991905928, -0.049231816083192825, 0.0065871537663042545, -0.0417281873524189, -0.014427298679947853, -0.05212443694472313, 0.041155390441417694, 0.021379610523581505, -0.04006708040833473, -0.01200723648071289, 0.019503703340888023, 0.02901211753487587, 0.019074106588959694, 0.01194995641708374, -0.010489326901733875, -0.06220564618706703, -0.012358073145151138, -0.08460196852684021, -0.08145158737897873, 0.0072494493797421455, 0.001872326945886016, -0.032076574862003326, -0.03557063266634941, 0.01928890496492386, -0.02268272079527378, -0.024501347914338112, -0.00609669741243124, -0.012143274769186974, -0.05493113398551941, -0.03130330145359039, 0.06100277230143547, -0.013711304403841496, 0.02043449692428112, -0.06203380599617958, 0.0003926785138901323, -0.0023323537316173315, 0.04696927219629288, -0.007159949745982885, 0.011305561289191246, 0.014069302007555962, 0.027479887008666992, 0.06323667615652084, 0.0369739830493927, 0.03010042943060398, 0.0014991145581007004, 0.007904584519565105, 0.01807171292603016, -0.009186215698719025, -0.005491681396961212, 0.0059606581926345825, 0.022424962371587753, 0.011040642857551575, -0.08528932183980942, 0.01592372916638851, -0.05083564296364784, -0.01000961009413004, -0.004807906225323677, -0.029269875958561897, -0.026262696832418442, 0.051551640033721924, 0.03485463559627533, 0.0470551922917366, -0.0011232171673327684, -0.01127692125737667, -0.030300907790660858, -0.07188589870929718, 0.024701828137040138, 0.0008918612729758024, 0.04301697760820389, 0.03508375585079193, 0.010790044441819191, -0.01569461077451706, 0.01356094516813755, -0.01659676432609558, 0.03302168846130371, 0.012658791616559029, -0.050033729523420334, 0.03047274611890316, -0.040954913944005966, 0.014735177159309387, -0.0076969461515545845, -0.010281688533723354, -0.0283963605761528, -0.01174231804907322, -0.09542781114578247, 0.0024129031226038933, -0.02116481214761734, -0.002876509912312031, -0.06071637570858002, -0.0016020387411117554, 0.01255855243653059, 0.02196672558784485, 0.01293086912482977, 0.021193452179431915, 0.030615946277976036, -0.02170896902680397, -0.06277844309806824, 0.035112395882606506, 0.010181448422372341, -0.03004314936697483, -0.01270891074091196, -0.06999567151069641, -0.016682682558894157, -0.01715523935854435, 0.0019403464393690228, -0.03654438257217407, -0.009007217362523079, -0.02876867912709713, -0.02518870308995247, -0.020763855427503586, 0.010324647650122643, 0.01672564260661602, 0.028382042422890663, -0.03173289820551872, -0.013489346019923687, -0.0007383698248304427, 0.02294047921895981, -0.009121776558458805, -0.057451438158750534, 0.04250146448612213, -0.007346108555793762, 0.004521508235484362, -0.04986189305782318, -0.01782827451825142, -0.012565712444484234, 0.03422456234693527, -0.0007253924268297851, -0.001642313553020358, -0.007918904535472393, 0.008921297267079353, 0.008083583787083626, 0.05438698083162308, 0.004969005472958088, -0.008162342943251133, -0.013052588328719139, 0.013696984387934208, 0.0040203118696808815, -0.008312702178955078, -0.04817214235663414, 0.01758483611047268, -0.008692178875207901, 0.02086409367620945, -0.02603357844054699, 0.0294417142868042, 0.03339400514960289, -0.004754206631332636, 0.03797637298703194, -0.011606278829276562, -0.0038413130678236485, 0.04373297467827797, -0.0013353306567296386, -0.008205302990972996, 0.020634975284337997, -0.01149887964129448, 0.05281179025769234, -0.003109208308160305, -0.013890302740037441, -0.03817685320973396, 0.024501347914338112, 0.0034564658999443054, 0.01553709153085947, -0.010288847610354424, 0.0004078933852724731, -0.02736532874405384, -0.03751813620328903, 0.02043449692428112, -0.040783073753118515, 0.05049196630716324, -0.023269837722182274, -0.004113391041755676, -0.056706804782152176, -0.010138489305973053, 0.024601588025689125, -0.025890378281474113, 0.018644509837031364, -0.0075179473496973515, 0.002552522113546729, -0.01386882271617651, -0.024472709745168686, -0.013847342692315578, 0.04989052936434746, 0.016625404357910156, -0.024243591353297234, -0.05541801080107689, -0.007747065741568804, -0.028296122327446938, 0.02919827587902546, 0.002373523311689496, 0.004492868669331074, -0.09130368381738663, -0.006132496986538172, -0.0023108739405870438, 0.02414335124194622, -0.010202928446233273, 0.07125581800937653, 0.024300869554281235, -0.01659676432609558, 0.061461009085178375, 0.033422645181417465, 0.008327022194862366, -0.05387146398425102, 0.0270073302090168, 0.0046217478811740875, 0.014384339563548565, -0.003601454896852374, -0.002122925128787756, -0.0014480998506769538, 0.02432950958609581, 0.010439206846058369, -0.012300794012844563, 0.022038325667381287, 0.011634918861091137, -0.007460667751729488, -0.0019009667448699474, 0.017126599326729774, 0.006955891381949186, 0.028195882216095924, 0.008233942091464996, -0.0022285343147814274, 0.019618263468146324, 0.008720818907022476, -0.007904584519565105, -0.026720933616161346, -0.05693592131137848, -0.041441790759563446, 0.010360447689890862, 0.0259046982973814, 0.008069263771176338, 0.05779511481523514, 0.02401447296142578, 0.013847342692315578, -0.0317615382373333, -0.020849773660302162, 0.01392610277980566, 0.005803139414638281, -0.004056111443787813, -0.01666836254298687, -0.03823413327336311, 0.005885479040443897, -0.007990503683686256, 0.00809074379503727, -0.021064572036266327, 0.009980970062315464, 0.018214913085103035, 0.03368040546774864, 0.037747256457805634, 0.00255431211553514, 0.02183784730732441, 0.0693083181977272, -0.00854182057082653, -0.016883162781596184, -0.06959471106529236, 0.0030787785071879625, 0.02031993865966797, 0.01592372916638851, -0.0016628983430564404, 0.02670661360025406, 0.01958962343633175, 0.006612213794142008, 0.029785390943288803, -0.03047274611890316, 0.02717917039990425, -0.06673073023557663, 0.021193452179431915, -0.006773312576115131, -0.0049475254490971565, 0.04367569461464882, -0.016768602654337883, 0.06867823749780655, -0.034453678876161575, -0.003610404673963785, -0.05407194048166275, -0.022238804027438164, -0.03582838922739029, -0.005430821795016527, 0.014305580407381058, -0.07973320037126541, 0.018415391445159912, -0.03642982617020607, -0.016525164246559143, 0.02318391762673855, 0.06369491666555405, 0.02200968563556671, -0.04301697760820389, -0.04155635088682175, 0.0037231738679111004, 0.017971474677324295, -0.028109963983297348, -0.004815066233277321, 0.03734629973769188, -0.022768640890717506, -0.020520417019724846, -0.02481638640165329, -0.022296084091067314, 0.0018991767428815365, -0.01897386647760868, 0.011892677284777164, -0.003877112874761224, -0.036401186138391495, 0.021637368947267532, -0.017627796158194542, 0.026778211817145348, 0.013818703591823578, -0.009773331694304943, -0.04699791222810745, 0.10654005408287048, -0.014864056371152401, 0.03665894269943237, -0.021909447386860847, 0.0027852205093950033, 0.017599156126379967, -0.0542437806725502, -0.02571853995323181, 0.03004314936697483, 0.004460648633539677, 0.05979990214109421, 0.009673092514276505, 0.03857780992984772, -0.009759011678397655, 0.021880807355046272, -0.026319975033402443, -0.012322274036705494, -0.029355794191360474, -0.011685037985444069, 0.00448570866137743, 0.034625519067049026, -0.043102897703647614, 0.03479735553264618, -0.03227705508470535, 0.0022732841316610575, -0.02597629837691784, 0.036888062953948975, 0.010059729218482971, 0.01356094516813755, 0.07933224737644196, 0.02438678964972496, 0.017069321125745773, -0.015522771514952183, 0.0122578339651227, -0.0467115119099617, -0.007532267365604639, 0.017384357750415802, -0.017728036269545555, 0.025346223264932632, -0.008384301327168941, -0.03193337842822075, 0.0034009763039648533, 0.0008779888739809394, -0.027895165607333183, 0.013245907612144947, -0.03173289820551872, 0.009322254918515682, 0.008463060483336449, -0.0006000932771712542, -0.01106928288936615, 0.043274737894535065, -0.007031070999801159, 0.00448570866137743, 0.012307954020798206, 0.0003929022641386837, 0.023813992738723755, 0.02664933353662491, 0.014763817191123962, 0.013632544316351414, 0.030272267758846283, -0.009014377370476723, 0.027279408648610115, 0.011670717969536781, 0.027050290256738663, -0.010546606034040451, -0.0033329566940665245, -0.018286511301994324, -0.0029534792993217707, 0.03955156356096268, -0.01812899298965931, -0.01769939623773098, -0.11948524415493011, -0.04840126261115074, -0.024673188105225563, 0.016711322590708733, -0.03365176543593407, -0.01898818649351597, -0.024372469633817673, -0.04032483696937561, -0.017069321125745773, 0.03820549324154854, -0.018444031476974487, -0.04510768502950668, -0.004249430261552334, 0.037747256457805634, 0.03703125938773155, 0.03247753158211708, 0.03826277330517769, 0.0052733030170202255, -0.028568200767040253, 0.06724625080823898, -0.02421495132148266, -0.0005669785314239562, 0.01435569953173399, 0.04951821267604828, -0.035255592316389084, 0.0032130274921655655, -0.03923652693629265, -0.006236316170543432, -0.013847342692315578, -0.013088388368487358, 0.010883123613893986, -0.011448759585618973, 0.006554934196174145, 0.050577886402606964, 0.02717917039990425, 0.014377179555594921, -0.018444031476974487, -0.001750607741996646, -0.004338929429650307, 0.024887986481189728, 0.0022697041276842356, 0.009737531654536724, 0.007109830155968666, -0.024959584698081017, -0.026119496673345566, 0.015265013091266155, 0.016439244151115417, 0.018086032941937447, -0.02992859110236168, 0.027938123792409897, 0.01623876579105854, 0.029212595894932747, -0.005566861014813185, -0.056964561343193054, -0.01976146176457405, -0.02494526468217373, -0.013546625152230263, -0.029355794191360474, 0.011319880373775959, -0.006397415418177843, 0.008377141319215298, -0.030873704701662064, -0.0023108739405870438, 0.054587457329034805, -0.0172125194221735, 0.016754282638430595, -0.029269875958561897, -0.015279333107173443, 0.01310986839234829, 0.012880750000476837, -0.04725566878914833, -0.007961864583194256, -0.030558666214346886, 0.016825882717967033, 0.007811505347490311, -0.0004260170098859817, -0.006544194184243679, -0.0022750741336494684, 0.013410585932433605, -0.03734629973769188, 0.012966669164597988, 0.0004546568088699132, -0.015837809070944786, -0.012386713176965714, -0.01520773395895958, -0.04800030589103699, -0.003112788312137127, -0.03127466142177582, 0.0018490570364519954, -0.020992973819375038, -0.02998587116599083, 0.05229627341032028, -0.03370904549956322, 0.0028603998944163322, -0.01812899298965931, 0.008570459671318531, -0.007152790203690529, -0.0009352684719488025, 0.0015420742565765977, -0.01751323789358139, -0.026606373488903046, -0.0318760983645916, 0.01174231804907322, -0.021852167323231697, -0.00010717550321714953, 0.01782827451825142, 0.0017461327370256186, -0.008319862186908722, 0.033365365117788315, 0.019546663388609886, -0.016983401030302048, 0.019417785108089447, -0.005380702205002308, 0.0158234890550375, 0.029842671006917953, -0.023312797769904137, -0.028425000607967377, 0.015594370663166046, -0.009529893286526203, -0.014241140335798264, 0.0043210298754274845, -0.006977371405810118, -0.030071789398789406, -0.04379025474190712, -0.029470354318618774, 0.022095605731010437, 0.05705048143863678, 0.03322216868400574, -0.025947658345103264, -0.013689824379980564, -0.003801933489739895, -0.015737570822238922, -0.022224484011530876, -0.05054924637079239, 0.013546625152230263, -0.014921335503458977, -0.013489346019923687, 0.007381908595561981, 0.0023466735146939754, 0.023942872881889343, 0.037374939769506454, -0.025217343121767044, 0.0029212594963610172, 0.017770996317267418, -0.005409342236816883, -0.006386675406247377, -0.014892695471644402, 0.028797319158911705, -0.011076442897319794, -0.0208068136125803, -0.021021613851189613, -0.0026491815224289894, 0.040725793689489365, -0.03880693018436432, 0.02689277194440365, -0.04974733293056488, 0.005638460628688335, 0.03053002618253231, 0.04840126261115074, 0.0036981140729039907, 0.007321048993617296, 0.021608728915452957, 0.0066838134080171585, -0.005011965055018663, -0.020692255347967148, -0.0032720970921218395, -0.017742356285452843, 0.007106250151991844, 0.04109811410307884, 0.002745840698480606, 0.049489572644233704, -0.02372807450592518, -0.02955627255141735, 0.007947544567286968, 0.00698095140978694, -0.029728112742304802, -0.01149887964129448, -0.02548942156136036, -0.005083564668893814, -0.007582386955618858, 0.015981007367372513, 0.04645375534892082, -0.05304091051220894, 0.008756618946790695, -0.01934618502855301, -0.03611478582024574, -0.026778211817145348, -0.0232411976903677, 0.019546663388609886, -0.00046673923498019576, -0.020176738500595093, -0.03227705508470535, -0.03399544209241867, -0.048744939267635345, 0.007410548161715269, -0.03138922154903412, 0.004091911483556032, 0.008334181271493435, 0.01659676432609558, 0.0006099382298998535, 0.013775743544101715, 0.008369981311261654, 0.028009723871946335, 0.03247753158211708, 0.0003067591169383377, -0.002744050696492195, -0.022310404106974602, -0.032448891550302505, 0.0008905187714844942, -0.04513632506132126, -0.02024833858013153, -0.035541992634534836, 0.003916492685675621, 0.0002191615931224078, -0.0441625714302063, -0.011556158773601055, 0.04063987731933594, -0.004449909087270498, -0.0318760983645916, 0.026420215144753456, 0.009171895682811737, -0.012408193200826645, -0.026133816689252853, -0.033794961869716644, 0.013790063560009003, 0.021365290507674217, -0.0018848568433895707, 0.0186015497893095, -0.021365290507674217, 0.026849811896681786, -0.007353268563747406, 0.00945829413831234, -0.008162342943251133, 0.01629604585468769, 0.012916550040245056, 0.0159380491822958, 0.006042997818440199, 0.022639760747551918, 0.011205321177840233, 0.007467827759683132, -0.012887910008430481, -0.01194995641708374, 0.030701864510774612, -0.013467865996062756, -0.033107608556747437, 0.011692197993397713, 0.01854426972568035, 0.016253085806965828, -0.0037088540848344564, 0.02341303601861, 0.009959490038454533, 0.03568518906831741, 0.027952443808317184, -0.02674957364797592, -0.03113146312534809, -0.0122578339651227, -0.013510825112462044, 0.003366966499015689, -0.020892733708024025, -0.0368594229221344, -0.009007217362523079, -0.001679008244536817, -0.00997381005436182, -0.010654005222022533, -0.00041729083750396967, 0.003118158085271716, 0.035971589386463165, -0.0027565807104110718, 0.04018164053559303, -0.024300869554281235, -0.09737531840801239, -0.041155390441417694, 0.02176624722778797, -0.012816309928894043, 0.023627834394574165, -0.03935108333826065, -0.01563733071088791, 0.006970211397856474, 0.00784730538725853, -0.006952311377972364, 0.004077591467648745, -0.027078930288553238, -0.02135097049176693, 0.004725567065179348, -0.0028961997013539076, -0.060487255454063416, -0.01782827451825142, -0.02311231754720211, 0.021379610523581505, -0.035198312252759933, -0.011577638797461987, -0.002427223138511181, 0.01021724846214056, 0.009959490038454533, -0.01015280932188034, -0.02621973678469658, 0.003358016489073634, 0.010811524465680122, 0.004410529043525457, 0.027408288791775703, -0.017441637814044952, -0.03648710623383522, 0.01635332591831684, 0.038835570216178894, -0.0293271541595459, -0.0008148918277584016, -0.024429749697446823, -0.020047860220074654, -0.005097884219139814, -0.011756638064980507, -0.03276393190026283, -0.05418650060892105, 0.018902268260717392, -0.0045250882394611835, 0.03935108333826065, -0.0319906547665596, 0.055389370769262314, 0.010117009282112122, 0.002183784730732441, -0.007013170979917049, 0.052639950066804886, -0.005681420210748911, 0.005047764629125595, 0.014835416339337826, -0.004704087041318417, 0.0051909638568758965, -0.028081323951482773, 0.0044678086414933205, 0.032448891550302505, 0.01739867776632309, 0.018415391445159912, 0.02414335124194622, -0.01563733071088791, -0.02760876715183258, -0.05490249767899513, -0.0035352252889424562, -0.017899874597787857, 0.028926197439432144, 0.025460781529545784, -0.05430106073617935, -0.02221016399562359, 0.02523166313767433, 0.022596802562475204, 0.00538428220897913, 0.019918980076909065, 0.026907091960310936, -0.0006144131766632199, 0.035541992634534836, -0.04250146448612213, 0.024587268009781837, 0.0282245222479105, -0.045164965093135834, 0.014384339563548565, 0.0026527615264058113, 0.02931283414363861, 0.01094756368547678, 0.05295499041676521, -0.023126637563109398, -0.021207772195339203, 0.01025304850190878, 0.03820549324154854, -0.019074106588959694, 0.020477456972002983, 0.017728036269545555, -0.01323158759623766, 0.02140825055539608, 0.03253481164574623, 0.023856952786445618, 0.0065656742081046104, -0.01119100209325552, 0.04656831547617912, 0.012372393161058426, -0.016926120966672897, -0.023685114458203316, -0.009200535714626312, 0.003483315696939826, 0.03978068009018898, 0.006268536206334829, 0.01661108434200287, -0.014692217111587524, 0.019976260140538216, 0.025260303169488907, 0.0158234890550375, 0.036773502826690674, -0.008835378102958202, 0.025575341656804085, 0.006988110952079296, 0.0010883123613893986, 0.02347031608223915, -0.008226782083511353, -0.004542988259345293, 0.021078892052173615, -0.0296135526150465, 0.011054962873458862, -0.012336594052612782, -0.0022160045336931944, 0.02159440889954567, 0.00569932023063302, 0.0037625536788254976, 0.019732821732759476, -0.014627777971327305, -0.004034631885588169, 0.001936766435392201, -0.014076462015509605, -0.018587229773402214, -0.0036068246699869633, 0.006189776584506035, 0.0048866658471524715, 0.009587173350155354, 0.04043939709663391, 0.023642154410481453, 0.007210069801658392, 0.059398945420980453, -0.003055508714169264, 0.020964333787560463, 0.007095510605722666, -0.009716051630675793, -0.030759144574403763, -0.016267405822873116, 0.0012324063573032618, 0.0034063460770994425, -0.011727998033165932, -0.0023234037216752768, 0.0416136272251606, 0.007260189391672611, -0.007299568969756365, -0.0018275772454217076, -0.012880750000476837, 0.021565768867731094, 0.050692446529865265, 0.01758483611047268, 0.02749420702457428, -0.008369981311261654, -0.0014212500536814332, 0.03242025151848793, -0.0032577773090451956, 0.0037625536788254976, -0.003060878487303853, -0.0018508470384404063, 0.028267482295632362, -0.01396190281957388, -0.02421495132148266, 0.024787746369838715, 0.02579014003276825, 0.04897405579686165, 0.015179093927145004, 0.006941571366041899, -0.022024005651474, 0.024100391194224358, 0.03534151241183281, -0.002223164541646838, 0.016081247478723526, -0.020577695220708847, 0.026849811896681786, 0.020047860220074654, 0.008369981311261654, 0.0134750260040164, 0.021179132163524628, -0.003977352287620306, 0.04507904499769211, -0.028267482295632362, 0.0368594229221344, 0.0045286682434380054, 0.03468279913067818, 0.006869971752166748, -0.027222130447626114, 0.029112355783581734, 0.048687659204006195, -0.04794302582740784, -0.026534775272011757, -0.008491700515151024, 0.033794961869716644, 0.013603905215859413, -0.018401071429252625, -0.027623087167739868, 0.02170896902680397, -0.027522847056388855, -0.006486914586275816, -0.0293271541595459, -0.007861625403165817, 0.026663653552532196, -0.0012270364677533507, -0.011806757189333439, 0.010174288414418697, 0.006637273356318474, -0.02140825055539608, 0.02566125988960266, 0.005341322626918554, -0.02517438307404518, -0.039981160312891006, -0.05974262207746506, -0.012358073145151138, -0.01194995641708374, 0.01384018361568451, -0.018214913085103035, 0.032878488302230835, 0.015794849023222923, -0.024787746369838715, 0.0030322386883199215, 0.008906977251172066, -0.004994065035134554, -0.0034654156770557165, 0.01898818649351597, 0.008706498891115189, -0.03158969804644585, -0.009708892554044724, -0.02359919436275959, -0.02165168896317482, -0.006973791401833296, -0.0018123623449355364, 0.011541839689016342, -0.03230569511651993, -0.034425038844347, 0.007825825363397598, -0.015723250806331635, 0.016210125759243965, 0.028782999143004417, 0.0391792468726635, -0.006039417814463377, 0.0019528763368725777, -0.002242854330688715, -0.027508527040481567, 0.026176776736974716, 0.010775724425911903, 0.006955891381949186, -0.008026303723454475, 0.02687845192849636, 0.06174740940332413, 0.022367684170603752, 0.0418427474796772, -0.02609085664153099, 0.027966763824224472, 0.00671961298212409, -0.01040340680629015, -0.0021515649277716875, -0.013790063560009003, -0.016324685886502266, -0.02001922018826008, 0.011914156377315521, 0.0198187418282032, -0.021794887259602547, 0.04542272165417671, 3.977128289989196e-05, 0.012000076472759247, -0.025532381609082222, 0.003859213087707758, -0.0006488704821094871, 0.013260227628052235, 0.008463060483336449, 0.0030805685091763735, -0.01545117236673832, -0.009708892554044724, -0.014992935582995415, -0.013589585199952126, -0.0029498992953449488, -0.007034651003777981, -0.0418427474796772, 0.011176682077348232, 0.02000490017235279, -0.013675504364073277, -0.021751927211880684, 0.037374939769506454, 0.019503703340888023, 0.0021587249357253313, 0.011806757189333439, 0.005158743821084499, 0.01665404438972473, -0.012057355605065823, 0.03090234473347664, -0.03479735553264618, 0.04470672830939293, 0.002235694322735071, 0.034425038844347, -0.019918980076909065, 0.02548942156136036, 0.004764946643263102, -0.030673226341605186, -0.02408607117831707, -0.01052512601017952, -0.006207676604390144, -0.016983401030302048, 0.015193413943052292, 0.007299568969756365, 0.03823413327336311, -0.008305542171001434, -0.008140862919390202, -0.010517966002225876, -0.033050328493118286, -0.0043210298754274845, -0.01642492599785328, 0.004295969847589731, 0.0033526464831084013, -0.010654005222022533, -0.018472671508789062, 0.009322254918515682, -0.045766398310661316, 0.0067375130020082, 0.0074320281855762005, -0.0012413563672453165, 0.0032595673110336065, 0.01456333789974451, 0.008148022927343845, -0.006569254212081432, 0.025203023105859756, -0.03216249495744705, 0.016496524214744568, -0.019475063309073448, -0.004775686655193567, -0.00024836076772771776, -0.00021166601800359786, 0.03648710623383522, 0.04797166585922241, -0.0029803290963172913, -0.011026322841644287, 0.0035119554959237576, 0.008756618946790695, -0.023384395986795425, 0.007596706971526146, 0.011334200389683247, 0.01039624772965908, 0.08746594935655594, -0.01726979948580265, -0.005588341038674116, -0.008813898079097271, -0.043332017958164215, 0.04436304792761803, -0.024057431146502495, -0.015307973138988018, -0.030186349526047707, 0.014262620359659195, -0.00267603131942451, -0.003544175298884511, -0.00933657493442297, 0.016095567494630814, 0.005233923438936472, 0.0010954723693430424, 0.007439188193529844, 0.012028715573251247, -0.019174346700310707, -0.0013022158527746797, 0.032076574862003326, 0.0033365366980433464, -0.016868842765688896, -0.017556197941303253, -0.01769939623773098, 0.008591939695179462, -0.00966593250632286, 0.018716109916567802, 0.047771185636520386, 0.02803836390376091, 0.009988130070269108, -0.02172328718006611, -0.029756752774119377, 0.009379534050822258, 0.012859269976615906, 0.012186234816908836, -0.017914194613695145, 0.018343791365623474, 0.00032354024006053805, 0.012200554832816124, 0.012307954020798206, 0.009959490038454533, -0.01830083131790161, -0.024257909506559372, -0.03817685320973396, -0.0394083634018898, 0.011434439569711685, -0.004432009067386389, 0.006436794996261597, -0.008391461335122585, -0.01283062994480133, -0.021666008979082108, -0.019560983404517174, 0.010023930110037327, 0.007489307783544064, -0.0009567483211867511, -0.009429654106497765, 0.042787861078977585, -0.0076110269874334335, 0.01027452852576971, -0.035255592316389084, -0.041499070823192596, -0.009558533318340778, 0.015608690679073334, -0.022339044138789177, -0.01119100209325552, -0.01805739291012287, 0.01280199084430933, -0.0271218903362751, 0.010654005222022533, -0.012859269976615906, -0.010668325237929821, -0.003977352287620306, -0.008391461335122585, -0.0075752269476652145, 0.020849773660302162, -0.007063290569931269, 0.024988224729895592, 0.0097661716863513, 0.022424962371587753, -0.008599099703133106, -0.0051909638568758965, -0.01910274662077427, 0.027293728664517403, 0.025589661672711372, 0.005445141810923815, 0.0208068136125803, -0.01250127237290144, -0.019059786573052406, 0.02377103455364704, -0.027093250304460526, 0.02518870308995247, 0.02359919436275959, 0.007467827759683132, -0.008942777290940285, -0.010532286018133163, -0.06134645268321037, -0.016797242686152458, 0.00964445248246193, -0.001209136564284563, -0.013467865996062756, 0.0010560925584286451, -0.03325080871582031, 0.005144423805177212, -0.00748214777559042, -0.008706498891115189, -0.025203023105859756, 0.003612194675952196, 0.006522714160382748, 0.0008766463724896312, -0.004732727073132992, -0.012264993973076344, 0.04991916939616203, -0.026262696832418442, 0.01563733071088791, 0.023556236177682877, -0.002498822519555688, 0.01685452274978161, -0.0020710155367851257, 0.009286454878747463, 0.0079976636916399, 0.0208068136125803, 0.03010042943060398, 0.015279333107173443, -0.015522771514952183, -0.017169559374451637, 0.007245869375765324, -0.024071751162409782, -0.013031109236180782, 0.0006667703273706138, -0.008348501287400723, 0.007163529749959707, 0.015837809070944786, 0.0006927251815795898, 0.03262073174118996, 0.04822942242026329, -0.00600719777867198, -0.010088369250297546, -0.004793586675077677, -0.017112281173467636, 0.028754359111189842, 0.019503703340888023, 0.007525107357650995, 0.000468081736471504, 0.016954760998487473, -0.0050083850510418415, 0.006196936592459679, 0.0209213737398386, 0.028081323951482773, -0.0007540322258137167, -0.017470277845859528, -0.012809150852262974, 0.011448759585618973, -0.009930850937962532, 0.0031539578922092915, 0.0021121851168572903, -0.01605260744690895, -0.024300869554281235, 0.002001205924898386, -4.631592673831619e-05, -0.0033240066841244698, 0.009751851670444012, 0.0006175456801429391, 0.030214989557862282, 0.04038211703300476, -0.04662559553980827, -0.0010695175733417273, 0.023627834394574165, 0.015608690679073334, 0.0006314180791378021, 0.021809207275509834, 0.0317615382373333, 0.007260189391672611, 0.003116368316113949, -0.0007585071725770831, -0.002795960521325469, -0.018286511301994324, 0.028854597359895706, -0.01666836254298687, -0.0034439358860254288, -0.012651631608605385, -0.009916530922055244, -0.006032257806509733, 0.01137716043740511, -0.027322368696331978, -0.02030561864376068, -0.0013872402487322688, 0.002738680923357606, 0.0020924953278154135, -0.023570554330945015, -0.004310289863497019, -0.005774499382823706, -0.0003226452390663326, 0.022152885794639587, -0.003168277908116579, 0.03972340375185013, 0.009200535714626312, 0.04147043079137802, -0.007840145379304886, 0.01661108434200287, 0.01642492599785328, -0.0016091987490653992, -0.0051301042549312115, -0.01466357707977295, -0.004102651495486498, 0.0443916879594326, 0.0391792468726635, 0.015952369198203087, -0.0008565090247429907, -0.016825882717967033, 0.00760386697947979, -0.024529987946152687, 0.0037840334698557854, 0.0006327605806291103, -0.005566861014813185, -0.004875925835222006, -0.010052570141851902, 0.00436398945748806, -0.015909409150481224, -0.028553880751132965, -0.006869971752166748, 0.04490720480680466, -0.019861701875925064, -0.016496524214744568, -0.004904565867036581, 0.002239274326711893, 0.003438565880060196, -0.006902191787958145, -0.014427298679947853, 0.00687355175614357, -0.03101690299808979, -0.0032040774822235107, 0.008040623739361763, 0.007124150171875954, 0.010374767705798149, -0.005495261400938034, 0.026806851848959923, 0.00200836593285203, 0.0001471145951654762, 0.01807171292603016, 0.019560983404517174, -0.010732765309512615, 0.016983401030302048, 0.019904660061001778, -0.00507640466094017, 0.0516948401927948, 0.03247753158211708, 0.023856952786445618, -0.017527557909488678, 0.0068878717720508575, -0.017713716253638268, -0.0011160571593791246, -0.0010811524698510766, -0.010589566081762314, 0.00386995286680758, -0.046797432005405426, 0.009687412530183792, -0.03170425817370415, 0.013424905948340893, 0.002491662511602044, -0.001800727448426187, -0.02889755740761757, -0.00600719777867198, 0.005971398204565048, -0.0021694647148251534, 0.03665894269943237, -0.005072824656963348, 0.03748949617147446, -0.02200968563556671, 0.023384395986795425, 0.007095510605722666, -0.0013505455572158098, -0.019417785108089447, -0.008427261374890804, 0.0006546879303641617, 0.013711304403841496, -0.023584874346852303, -0.012537072412669659, -0.006819852162152529, -0.003164697904139757, -0.007711266167461872, 0.0006940676248632371, -0.0059964582324028015, 0.002808490302413702, 0.009343734942376614, 0.005584761034697294, 0.021880807355046272, 0.0018248922424390912, 0.005910538602620363, 0.012551392428576946, -0.0021730447188019753, 0.019360505044460297, 0.014649257995188236, -0.04453488811850548, -0.02646317519247532, 0.005148003809154034, -0.014076462015509605, 0.005176643840968609, -0.01976146176457405, 0.024787746369838715, -0.00973037164658308, -0.004779266659170389, -0.001218086457811296, 0.03903604671359062, 0.016453564167022705, 0.009873570874333382, -0.009930850937962532, 0.03582838922739029, -0.013761423528194427, 0.032391615211963654, -0.020992973819375038, -0.00250240252353251, -0.006157557014375925, 0.02286887913942337, -0.005498841404914856, 0.01070412527769804, 0.004389049485325813, 0.030873704701662064, -0.020162418484687805, 0.041327230632305145, -0.0035119554959237576, 0.00897141732275486, 0.00699527096003294, 0.009945170022547245, 0.037374939769506454, -0.007976184599101543, -0.002751210704445839, 0.0017246529459953308, 0.03279257193207741, 0.007976184599101543, 0.023455996066331863, 0.00978765171021223, 0.03010042943060398, -0.0075752269476652145, 0.017856914550065994, 0.007267349399626255, 0.024257909506559372, 0.01466357707977295, 0.02664933353662491, -0.03817685320973396, -0.019675541669130325, 0.008871178142726421, 0.000998812960460782, -0.008140862919390202, -0.0318760983645916, -0.00772558618336916, -0.003442145884037018, -0.0001625532313482836, -0.04421985149383545, -0.0009281085222028196, 0.03224841505289078, 0.010038250125944614, 0.018143313005566597, 0.0397520437836647, 0.015522771514952183, 0.010868803597986698, 0.009007217362523079, 0.005631300620734692, -0.02639157511293888, -0.0017774575389921665, -0.031217381358146667, -0.007489307783544064, 0.03368040546774864, 0.015780529007315636, 0.018644509837031364, -0.015078854747116566, -0.006916511803865433, -0.030272267758846283, -0.0158234890550375, -0.04785710573196411, -0.0246302280575037, 0.02129369042813778, 0.004439169075340033, 0.027694685384631157, -0.022840240970253944, -0.01885930821299553, 0.01286642998456955, -0.015164773911237717, -0.006572834216058254, -0.015766208991408348, 0.03539879247546196, -0.0053341626189649105, 0.024372469633817673, -0.022854560986161232, -0.035370152443647385, 0.00012887909542769194, 0.023069359362125397, 0.024601588025689125, 0.0008511390187777579]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
" is less bottlenecked).
Also, we tested Llama 7B with Multi-Query-Attention (MQA) and Group-Query-Attention (GQA) (Ainslie et al., 2023)
over high bandwidth network and report the results in Table 2. MQA and GQA (Ainslie et al., 2023) are techniques to
share keys and values among queries so that the attention part can be computationally more efficient. Accordingly, (K, V)
projection computation costs will be reduced for TSP andKVR , benefiting both. In detail, TSP has lower communication
costs as it has a fewer K and V matrices to allgather , and KVR will have lower communication costs with MQA or GQA,
as it leads a smaller (K, V)cache.
Compared with Multi-Head-Attention cases from Fig. 8 (b-c), overall GQA8 and MQA reduce the TTFT universally. For
example, the speedup is as large as 1.22x with MQA. KVR demonstrates marginally better speedup gains over TSP with
GQA8 and MQA than with MHA. For the example of 8GPU and 16k context, the speedup over TSP was 1.41x with MHA
(see Fig. 8 (c)), but it becomes 1.48x with MQA and 1.46x with GQA.
B. Parallel Inference Benefits
The benefit of parallel LLM inference depends on the input context size (which determines the parallelization gain) and the
network bandwidth (which determines the parallelization cost). To understand when KVR (i.e., parallel LLM inference in
12
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
Network4 GPUs 8 GPUs
Context Method Method
Length TSP KVR-S SpeedUp × TSP KVR-S SpeedUp ×
1k 0.109 0.102 1.07 0.117 0.101 1.17
2k 0.107 0.102 1.05 0.120 0.101 1.18
Llama 7B 4k 0.18 0.14 1.23 0.12 0.10 1.18
MQA 8k 0.49 0.37 1.33 0.26 0.18 1.44
12k 0.98 0.70 1.41 0.51 0.35 1.45
16k 1.65 1.16 1.43 0.84 0.57 1.48
1k 0.112 0.102 1.10 0.119 0.101 1.18
2k 0.113 0.102 1.12 0.118 0.103 1.15
Llama 7B 4k 0.18 0.15 1.20 0.12 0.11 1.15
GQA8 8k 0.50 0.38 1.32 0.27 0.19 1.42
12k 1.00 0.72 1.39 0.52 0.36 1.42
16k 1.67 1.16 1.44 0.86 0.59 1.46
Table 2. Top-1 accuracy with ImageNet1k: KV-Runahead outperforms other schemes with various pruning rates.
Context base 10GB/s 1GB/s
Length 1 GPU 2 GPU 4 GPU 2 GPU 4 GPU
1k 0.10 0.10 0.10 0.11 0.19
2k 0.24 0.16 0.19 0.21 0.35
4k 0.65 0.38 0.36 0.84 0.93
8k 1.95 0.99 0.72 1.31 2.06
12k 3.95 1.82 1.15 2.28 2.30
Table 3. Top-1 accuracy with ImageNet1k: KV-Runahead outperforms other schemes with various pruning rates.
method rank/gpu partition size
TSP0 Antibiotics are a 3
1 type of medication 3
2 used to treat 3
3 bacterial infections 2
KVR0 Antibiotics are a type","[-0.026596281677484512, 0.004784174729138613, 0.05761093273758888, 0.002566024661064148, 0.0005962286959402263, -0.010959848761558533, 0.0054046111181378365, 0.03371157497167587, -0.023440305143594742, 0.013527666218578815, 0.016353700309991837, 0.040712106972932816, 0.004278501030057669, 0.028547249734401703, 0.005878007970750332, -0.05563127249479294, -0.013212068937718868, -0.038904592394828796, -0.023583758622407913, 0.025778597220778465, -0.012896470725536346, -0.016066793352365494, 0.0041063567623496056, 0.021675826981663704, 0.01933753304183483, -0.013384212739765644, -0.01963878609240055, -0.00231677433475852, 0.027370931580662727, -0.053450778126716614, 0.01969616860151291, -0.026926225051283836, -0.06501313298940659, -0.06363598257303238, -0.02486049383878708, 0.07224319130182266, -0.0029192790389060974, 0.025577761232852936, -0.013771537691354752, 0.016712334007024765, 0.023425959050655365, -0.039507098495960236, -0.06157024949789047, -0.003442884422838688, 0.02665366232395172, 0.008879772387444973, -0.003769241040572524, -0.008384858258068562, -0.03623635694384575, 0.031588464975357056, -0.013570702634751797, 0.03130155801773071, -0.06948888301849365, 0.014747021719813347, -0.005139222368597984, 0.007854079827666283, 0.022063151001930237, -0.019165389239788055, 0.049835752695798874, -0.0024942979216575623, 0.04174497351050377, -0.04779871180653572, 0.007344820071011782, -0.021833624690771103, -0.0050746682099998, -0.0062509868294000626, -0.0029497628565877676, 0.0017833064775913954, 0.007402201183140278, 0.0035128179006278515, -0.05029480159282684, 0.04383939504623413, 0.04249093309044838, 0.003236670047044754, 0.00934599619358778, 0.03703969717025757, -0.025434307754039764, 0.04119984805583954, 0.03798649087548256, -0.023339886218309402, 0.025376927107572556, 0.0006029530777595937, 0.05135636031627655, 0.009137989021837711, 0.021618444472551346, -0.04966360703110695, -0.01899324543774128, -0.02781563624739647, -0.04774133116006851, -0.02434406243264675, -0.02249351143836975, 0.03701100870966911, -0.00012025439355056733, 0.015120000578463078, 0.06570170819759369, 0.014431423507630825, 0.054799243807792664, -0.04174497351050377, -0.011268273927271366, 0.04811431095004082, 0.030240001156926155, 0.01222223974764347, 0.01423058845102787, -0.0072981975972652435, 0.07976015657186508, -0.002410019049420953, -0.022636964917182922, 0.0328795462846756, -0.008915635757148266, -0.01818990521132946, -0.046823225915431976, 0.0019491746788844466, -0.053795069456100464, 0.032047513872385025, 0.008148159831762314, -0.05408197641372681, -0.062258824706077576, -0.044212374836206436, -0.0019312429940328002, -0.01513434574007988, -0.021618444472551346, 0.025233473628759384, 0.03864637762308121, -0.024042809382081032, 0.014833093620836735, -0.024530550464987755, 0.010529488325119019, -0.06317692995071411, 0.014395560137927532, -0.008133814670145512, 0.0032832922879606485, 0.014560531824827194, 0.05855772644281387, 0.013133169151842594, 0.0003440642904024571, -0.006577343679964542, -0.02841814234852791, -0.0026915466878563166, -0.03784303739666939, 0.01310447882860899, -0.04418368265032768, -0.01738656684756279, 0.00403463002294302, 0.03296561911702156, -0.03752743825316429, 0.02490353025496006, -0.044126302003860474, 0.028934573754668236, -0.0101493364199996, 0.019280152395367622, -0.03328121453523636, -0.010744668543338776, -0.02880546636879444, -0.014761366881430149, -0.026467174291610718, -0.03336728736758232, -0.029752258211374283, 0.029924403876066208, 0.017874307930469513, -0.018907172605395317, -0.01285343524068594, -0.022106187418103218, 0.06220144405961037, -9.475777187617496e-05, -0.0070399814285337925, 0.0038696585688740015, -0.06357859820127487, -0.02229267545044422, -0.07534178346395493, -0.032190967351198196, -0.005243225954473019, -0.016956206411123276, -0.06329169124364853, -0.02635241113603115, 0.02912106364965439, -0.02725616842508316, -0.011705806478857994, -0.002189459279179573, 0.01654019020497799, -0.04274914786219597, -0.0429786741733551, 0.04481487721204758, 0.015794232487678528, 0.03801518306136131, -0.04659370332956314, -0.007495446130633354, -0.025219127535820007, 0.029436660930514336, -0.02224964089691639, 0.014890475198626518, 0.00011879744124598801, 0.025835977867245674, 0.050925999879837036, 0.04633548483252525, 0.024329716339707375, -0.01959574967622757, 0.0017277182778343558, 0.016296319663524628, -0.012107476592063904, 0.0036024763248860836, 0.017300494015216827, -0.0059102848172187805, 0.0392775721848011, -0.0812520682811737, 0.012996888719499111, -0.05121290683746338, 0.006265332456678152, -0.04294998198747635, -0.028002126142382622, -0.004644307773560286, 0.02940797060728073, 0.03276478126645088, 0.04002353176474571, -0.015708159655332565, -0.0012444593012332916, -0.02009783685207367, -0.0946793183684349, 0.016913169994950294, 0.000511949707288295, 0.056090325117111206, 0.033395979553461075, 0.02850421331822872, 0.0043466417118906975, 0.016210246831178665, -0.03422800824046135, 0.05517222359776497, 0.004343055188655853, -0.03712577000260353, 0.0061577423475682735, -0.03577730804681778, 0.0091451620683074, 0.01503392867743969, -0.004429127089679241, -0.029924403876066208, -0.00020217979908920825, -0.10305700451135635, -0.007359165232628584, -0.03488789498806, -0.005662827752530575, -0.07660418003797531, 0.0014040513196960092, 0.007280265912413597, 0.0006984393112361431, 0.009360342286527157, -0.007280265912413597, 0.024831803515553474, -0.02510436438024044, -0.05652068555355072, 0.014847438782453537, 0.019380569458007812, -0.05852903425693512, -0.019064972177147865, -0.10219628363847733, -0.022436128929257393, -0.04300736263394356, 0.010880948975682259, -0.017070967704057693, 0.007674762979149818, -0.032449185848236084, -0.003948558121919632, -0.002456641523167491, -0.020456470549106598, 0.021862315014004707, 0.0011494213249534369, -0.016210246831178665, 0.01702793315052986, 0.015048273839056492, 0.016898823902010918, -0.02204880490899086, -0.05838558077812195, 0.019610095769166946, -0.012889298610389233, 0.009797874838113785, -0.05591817945241928, -0.005720208864659071, -0.005885180551558733, 0.011368690989911556, -0.02645282819867134, -0.01179905142635107, -0.012501973658800125, 0.0010400379542261362, 0.004350227769464254, 0.0665050521492958, 0.015808576717972755, 0.004601271357387304, -0.007638899609446526, 0.019294498488307, 0.02655324526131153, -0.027586111798882484, -0.05015134811401367, 0.03242049366235733, 0.006896527949720621, 0.01994003914296627, 0.014582050032913685, 0.021934041753411293, 0.03101464919745922, -0.005591100547462702, 0.00986960157752037, -0.005806281231343746, 0.003613235428929329, 0.0493193194270134, 0.02349768579006195, 0.014044099487364292, 0.013484630733728409, -0.01662626303732395, 0.040166985243558884, 0.00909495260566473, 0.003613235428929329, -0.05322125554084778, 0.028432486578822136, -0.013778709806501865, 0.01362808421254158, -0.013262277469038963, 0.042462240904569626, -0.0419744998216629, -0.04217533394694328, 0.02444447949528694, -0.06593123823404312, 0.03752743825316429, -0.02729920484125614, 0.019868312403559685, -0.07080865651369095, -0.0082198865711689, -0.0015017789555713534, 0.0003366674645803869, -0.018749374896287918, -0.03508872911334038, 0.00281886151060462, -0.014122998341917992, -0.03838815912604332, 0.012516318820416927, 0.05273351073265076, 0.02795908972620964, 0.004282087553292513, -0.058701179921627045, 0.004447058774530888, -0.019251462072134018, 0.02490353025496006, -0.0012211480643600225, 0.007301784120500088, -0.08331780135631561, -0.008585693314671516, -0.017171386629343033, 0.0007620967808179557, 0.011469108983874321, 0.06392288953065872, 0.038560304790735245, -0.01410865318030119, 0.04269176721572876, -0.0023096015211194754, 0.005418956745415926, -0.02440144307911396, 0.04926193878054619, -0.006631138734519482, 0.020628616213798523, -0.013334004208445549, 0.019108008593320847, -0.018204251304268837, -0.03652326390147209, 0.013592220842838287, -0.03592076152563095, -0.002026280853897333, -0.010457761585712433, -0.003441091161221266, 0.013893472962081432, 0.026122884824872017, -0.024817457422614098, 0.019265806302428246, 0.004167324397712946, -0.008040569722652435, 0.018648957833647728, 0.020757723599672318, 0.010766186751425266, -0.05310649052262306, -0.05718057230114937, -0.039707932621240616, -0.010443415492773056, 0.06202929839491844, 0.0231533981859684, 0.05081123486161232, -0.007624554447829723, 0.0022988426499068737, -0.006767419632524252, -0.02275172807276249, 0.03853161260485649, -0.0021571821998804808, 0.021073320880532265, -0.004820038098841906, -0.07155461609363556, -0.003294051392003894, -0.008643073961138725, 0.005799108184874058, -0.01461074035614729, 0.006803283002227545, 0.00617567403241992, 0.0251617468893528, 0.04108508676290512, 0.017902998253703117, 0.017931688576936722, 0.05861510708928108, 0.0034106073435395956, -0.015048273839056492, -0.08819521963596344, -0.001387016149237752, 0.009489449672400951, 0.01069446001201868, -0.013929336331784725, 0.004658652935177088, 0.03270740061998367, -0.002295256359502673, 0.03678148239850998, -0.026883188635110855, 0.028245996683835983, -0.04392546787858009, 0.01983962208032608, -0.019667476415634155, -0.011712979525327682, 0.03944971784949303, -0.0028009298257529736, 0.05801260098814964, -0.026395447552204132, 0.029293207451701164, -0.02610854059457779, -0.0061685009859502316, -0.019853966310620308, 0.00027435485390014946, 0.014761366881430149, -0.0644393190741539, 0.012394383549690247, -0.04659370332956314, -0.03818732500076294, 0.03824470564723015, 0.02695491537451744, 0.021159393712878227, -0.023612448945641518, -0.01540690753608942, -0.0009216888574883342, -0.001410327386111021, -0.03170322626829147, 0.010507970117032528, -0.007947324775159359, -0.04656501114368439, -0.005067495629191399, -0.019021935760974884, -0.042318787425756454, 0.015234763734042645, 0.015995066612958908, -0.001972485799342394, 0.03161715343594551, -0.030326073989272118, 0.009546831250190735, 0.015435597859323025, 0.042117953300476074, 0.0335681214928627, -0.022378748282790184, -0.06719362735748291, 0.09031833708286285, -0.007911461405456066, 0.001312599633820355, -0.030785124748945236, 0.01738656684756279, 0.019265806302428246, -0.06438193470239639, -0.012272448278963566, 0.009152334183454514, 0.011167855933308601, 0.05422542989253998, 0.00602504750713706, 0.03617897629737854, 0.001246252446435392, 0.018175560981035233, -0.018075142055749893, 0.0006961978506296873, -0.040310438722372055, -0.038588996976614, -0.020929867401719093, 0.025118710473179817, -0.015851613134145737, 0.03678148239850998, 0.008714800700545311, 0.027241822332143784, -0.01119654718786478, 0.013290967792272568, 0.02600812166929245, 0.012035749852657318, 0.06977578997612, 0.06214406341314316, 0.012616736814379692, 0.002203804673627019, 0.014209071174263954, -0.06466884166002274, -0.0040238709188997746, 0.049835752695798874, -0.01778823509812355, -0.0018487571505829692, 0.012057268060743809, -0.0035594403743743896, 0.0051535675302147865, 0.00745241018012166, -0.033395979553461075, 0.017300494015216827, -0.006182846613228321, 0.01500523742288351, -0.006154155824333429, 0.004594098776578903, 0.028891537338495255, 0.057209260761737823, -0.007161916699260473, 0.00947510451078415, 0.033740267157554626, 0.0006370232440531254, -0.0021858729887753725, 0.025993777438998222, 0.035547781735658646, 0.005167912691831589, 0.03376895934343338, 0.0029407970141619444, 0.023325541988015175, 0.007746489718556404, 0.032850854098796844, -0.026122884824872017, -0.003199013415724039, -0.020915523171424866, 0.005791935604065657, 0.023985428735613823, -0.008011878468096256, -0.021231120452284813, -0.1034012958407402, -0.043322961777448654, -0.07494011521339417, -0.006172087509185076, -0.01783127151429653, -0.03282216563820839, -0.005436888430267572, -0.026395447552204132, 0.001915104454383254, 0.03310907259583473, -0.038359470665454865, -0.016009412705898285, 0.0018209631089121103, 0.02661062777042389, 0.024071499705314636, 0.01232982985675335, 0.03213358670473099, 0.02249351143836975, -0.023468995466828346, 0.06380812078714371, -0.04254831373691559, -0.004583339672535658, -0.001811100635677576, 0.03046952746808529, -0.018720684573054314, 0.026624972000718117, 0.0070830173790454865, -0.0054440610110759735, -0.0056197913363575935, -0.013599392957985401, 0.013448767364025116, -0.0017465465934947133, -0.00949662271887064, 0.056090325117111206, 0.011913814581930637, -0.0035038520582020283, -0.0342567004263401, -0.029379280284047127, 0.029838331043720245, 0.0342567004263401, -0.010644250549376011, -0.0015986100770533085, 0.013068615458905697, -0.012530664913356304, -0.012659772299230099, 0.011239582672715187, 0.02900630049407482, 0.01550732459872961, -0.022522201761603355, -0.008442239835858345, 0.019509678706526756, 0.015952030196785927, 0.0024243644438683987, -0.05485662445425987, 0.002345464890822768, -0.0040991841815412045, -0.004031043965369463, -0.023311195895075798, -0.01094550359994173, -0.0018505502957850695, 0.02420060895383358, -0.03497396782040596, 0.0115766990929842, 0.048171691596508026, -0.016368046402931213, 0.031129412353038788, -0.013398557901382446, -0.014352524653077126, -0.00046398246195167303, 0.01395802665501833, -0.042921293526887894, -0.03233442083001137, -0.02158975414931774, 0.02590770460665226, 0.0038553131744265556, -0.006430303677916527, -0.022235294803977013, -0.03382633998990059, 0.052389223128557205, -0.021761897951364517, 0.021919697523117065, 0.02444447949528694, -0.010637078434228897, 0.005705863703042269, -0.024128882214426994, -0.044068921357393265, -0.0038768311496824026, -0.0375848226249218, -0.005343643482774496, -0.01784561760723591, -0.01748698391020298, 0.026237647980451584, -0.038302090018987656, -0.009087780490517616, -0.011870778165757656, 0.012781708501279354, -0.0011834915494546294, 0.013599392957985401, 0.026581935584545135, -5.911853804718703e-06, -0.045532144606113434, -0.041371993720531464, 0.01998307555913925, -0.027772599831223488, -0.0009665180696174502, 0.00017864446272142231, 0.013305313885211945, 0.0003012523811776191, 0.02560645341873169, 0.013986717909574509, 0.009008880704641342, 0.040912941098213196, -0.0017483397386968136, 0.0432942695915699, 0.02811688929796219, -0.019581405445933342, -0.021058976650238037, 0.011956850066781044, -0.009432069025933743, -0.013061442412436008, 0.008836736902594566, -0.020772069692611694, -0.04180235415697098, -0.033539433032274246, -0.027385275810956955, 0.022608274593949318, 0.03973662480711937, 0.03161715343594551, -0.01440273318439722, -0.024989603087306023, -0.008585693314671516, -0.01834770478308201, -0.019724858924746513, -0.032650019973516464, -0.0002626992645673454, -0.04005222022533417, -0.02856159582734108, 0.004127874970436096, -0.007603036239743233, 0.011763188056647778, 0.030354764312505722, -0.03391241282224655, 0.005956907290965319, 0.029149753972887993, 0.01002022810280323, 0.03267871215939522, 0.004074079915881157, 0.004167324397712946, 0.0009817599784582853, -0.02245047502219677, -0.017056623473763466, -0.016468463465571404, 0.03282216563820839, -0.01933753304183483, 0.00692880479618907, -0.05121290683746338, 0.02090117707848549, 0.022421784698963165, 0.021130703389644623, 0.002004762878641486, 0.0005478131351992488, 0.018907172605395317, -0.025534726679325104, 0.008929980918765068, -0.006892941426485777, 0.02189100719988346, -0.0021320779342204332, -0.022063151001930237, 0.022981252521276474, 0.00020363675139378756, 0.042863909155130386, -0.028532903641462326, -0.021733207628130913, 0.009389032609760761, 0.014015408232808113, -0.011203719303011894, -0.023440305143594742, -0.02150368131697178, 0.0023490514140576124, 0.002626992529258132, 0.029436660930514336, 0.050036586821079254, -0.03431408107280731, 0.001187974470667541, -0.01094550359994173, -0.019667476415634155, -0.010034573264420033, -0.006767419632524252, -0.0016057827742770314, -0.011813396587967873, -0.012774535454809666, -0.010486451908946037, 0.0092240609228611, -0.03021131083369255, 0.016669297590851784, -0.028647666797041893, -0.003769241040572524, 0.0076819355599582195, 0.002998178591951728, -0.04484356939792633, 0.01768781803548336, 0.025462999939918518, 0.02811688929796219, 0.023368578404188156, 0.0059533207677304745, -0.018376395106315613, -0.03623635694384575, -0.01818990521132946, 0.006634725257754326, -0.023669829592108727, -0.01473267562687397, -0.04886026680469513, -0.00799036119133234, 0.004920455627143383, -0.05247529596090317, -0.011454762890934944, 0.028188616037368774, -0.011533662676811218, -0.023569412529468536, 0.024114536121487617, -0.010264098644256592, -0.03302299976348877, -0.01923711597919464, -0.020657306537032127, 0.014094308018684387, 0.004995768889784813, -0.007552827708423138, 0.011519317515194416, -0.03965055197477341, 0.01899324543774128, -0.0035719925072044134, 0.03313776105642319, -0.009432069025933743, 0.0057775904424488544, 0.01823294162750244, 0.000864755711518228, -0.007516964338719845, 0.03041214495897293, 0.03061298094689846, -0.0008235128480009735, -0.006444649305194616, -0.005806281231343746, 0.015693815425038338, -0.017099659889936447, -0.005390265956521034, 0.011103302240371704, 0.01117502897977829, 0.04840121790766716, -0.016310663893818855, 0.002634165110066533, -0.017157040536403656, 0.027227478101849556, 0.026323720812797546, -0.008019051514565945, -0.032793473452329636, -0.0355764701962471, -0.024473169818520546, -0.018921518698334694, -0.0020603511948138475, -0.014761366881430149, -0.0006953012780286372, -0.0070005315355956554, -0.013871954753994942, -0.024487515911459923, -0.03982269763946533, -0.024042809382081032, 0.00430719181895256, -0.010787704028189182, 0.038904592394828796, -0.01684144325554371, -0.09284311532974243, -0.031158102676272392, 0.03333859518170357, 0.004256983287632465, 0.03316645324230194, 0.003168529598042369, 0.012136167846620083, 0.0034608161076903343, 0.020657306537032127, -0.005139222368597984, -0.010608387179672718, -0.03523218259215355, -0.00861438363790512, -0.0043968502432107925, -0.004174497444182634, -0.02930755354464054, -0.02781563624739647, 0.0106514235958457, 0.03738398477435112, -0.041515447199344635, -0.0021643550135195255, -0.005479924380779266, 0.022364402189850807, 0.03267871215939522, 0.004576167091727257, -0.028991956263780594, 0.012738672085106373, -0.000856686441693455, 0.028604630380868912, 0.008155331946909428, -0.020915523171424866, -0.019753549247980118, 0.009460759349167347, 0.05626246705651283, -0.06254573166370392, -0.010572523809969425, -0.016855787485837936, -0.006799696478992701, 0.023325541988015175, -0.03061298094689846, -0.027399621903896332, -0.04375332221388817, -0.006154155824333429, -0.02158975414931774, 0.023669829592108727, -0.042519621551036835, 0.024587932974100113, 0.013054270297288895, -0.007093776483088732, -0.015120000578463078, 0.017702164128422737, -0.017271803691983223, -0.004464990459382534, 0.017573054879903793, -0.01177753321826458, -0.0074667553417384624, -0.024645313620567322, 0.017960380762815475, -0.005623377859592438, 0.01684144325554371, 0.0030465940944850445, 0.018677648156881332, 0.02805950678884983, -0.05040956661105156, -0.05706580728292465, -0.02626633830368519, -0.0013861196348443627, 0.035346947610378265, 0.03176060691475868, -0.01955271326005459, -0.014323833398520947, 0.019108008593320847, 0.015808576717972755, -0.006763833109289408, 0.014051271602511406, 0.01803210750222206, -0.004027457442134619, 0.02630937471985817, -0.05304910987615585, 0.03101464919745922, 0.014467286877334118, -0.05557389184832573, 0.01754436455667019, 0.014876129105687141, 0.03471574932336807, 0.01428079791367054, 0.0630621686577797, -0.03046952746808529, -0.017802581191062927, 0.013914991170167923, 0.040253058075904846, -0.02285214513540268, 0.02876242995262146, 0.019567059352993965, 0.00571303628385067, 0.037412676960229874, 0.03107203170657158, 0.018878482282161713, -0.010206717997789383, -0.004504440352320671, 0.04765525832772255, -0.003667030483484268, 0.01798907108604908, -0.06426717340946198, 4.07105399062857e-05, 0.01563643291592598, 0.02239309437572956, -0.012638255022466183, 0.057151880115270615, -0.02986702136695385, 0.015048273839056492, 0.004048975650221109, 0.0070830173790454865, 0.04834383353590965, -0.01583726890385151, 0.03310907259583473, 0.01255218219012022, -0.003988007549196482, -0.0023705693893134594, -0.015091310255229473, 0.022608274593949318, 0.015650779008865356, -0.020327363163232803, -0.01210030447691679, 0.010708805173635483, -0.0007248885231092572, 0.015435597859323025, 0.04022436589002609, 0.02090117707848549, 0.019108008593320847, -0.03141631931066513, 0.015091310255229473, 0.009668766520917416, 0.007638899609446526, -0.015478634275496006, -0.020126529037952423, 0.00571303628385067, -0.002670028479769826, 0.0028511385899037123, 0.03709707781672478, 0.011340000666677952, 0.0052360533736646175, 0.052188389003276825, 0.012423074804246426, -0.0106514235958457, 0.0164397731423378, 0.0023580172564834356, -0.0010561764938756824, 0.0021033871453255415, -0.01453184150159359, 0.009970019571483135, -0.04274914786219597, 0.024975256994366646, 0.03328121453523636, -0.006329886149615049, 0.02440144307911396, -0.007022049743682146, -0.01364960242062807, 0.019724858924746513, 0.01618155650794506, -0.029580114409327507, 0.008915635757148266, -0.0048953513614833355, -0.001721442211419344, 0.009460759349167347, 0.019581405445933342, 0.010206717997789383, -0.012609563767910004, 0.009604212827980518, 0.028791120275855064, -0.002449468709528446, -0.01220072153955698, 0.02389935590326786, 0.024315370246767998, 0.05127028748393059, 0.03362550586462021, -0.007760835345834494, -0.045417383313179016, 0.033539433032274246, 0.030584288761019707, -0.007373510859906673, 0.007768007926642895, -0.011318482458591461, 0.010909640230238438, 0.023784592747688293, -0.014180379919707775, 0.02836075983941555, 0.008901290595531464, 0.0019688995089381933, 0.0048128655180335045, -0.0005594686954282224, 0.050581708550453186, -0.0018935863627120852, 0.03001047484576702, 0.01307578757405281, -0.014847438782453537, 0.009840911254286766, 0.03310907259583473, -0.02946535125374794, -0.004626376088708639, -0.019810929894447327, 0.03488789498806, 0.013814573176205158, -0.008212713524699211, -0.02235005795955658, 0.033654194325208664, -0.02454489655792713, -0.010134991258382797, -0.024387096986174583, 0.010809222236275673, 0.016152866184711456, -0.004260569345206022, -0.03276478126645088, 0.0038481405936181545, 0.00044582661939784884, -0.014087134972214699, -0.01618155650794506, -0.015593397431075573, -0.028489869087934494, -0.03721184283494949, -0.05844296142458916, -0.004866660572588444, -0.017099659889936447, 0.01702793315052986, -0.022880835458636284, 0.013334004208445549, 0.036551956087350845, -0.0402817465364933, 0.0003888935025315732, 0.026883188635110855, -0.0020729033276438713, 0.036150284111499786, 0.008506793528795242, 0.008542656898498535, -0.03431408107280731, 0.008184023201465607, -0.02405715547502041, -0.014374041929841042, -0.016755370423197746, -0.005756072234362364, 0.011497799307107925, -0.01953836902976036, -0.015751196071505547, 0.00040682521648705006, -0.017917344346642494, -0.007301784120500088, 0.050237420946359634, 0.03230573236942291, -0.0056520686484873295, -0.006946736481040716, -0.015163036994636059, -0.003199013415724039, 0.004859487991780043, -0.0038337951991707087, 0.014273624867200851, -0.028748083859682083, 0.020556889474391937, 0.04263438656926155, 0.01473267562687397, 0.021360227838158607, -0.01255218219012022, 0.009718975983560085, 0.0009996916633099318, -0.011232410557568073, 0.008829563856124878, -0.017902998253703117, -0.0022414610721170902, -0.005379506852477789, 0.012466110289096832, 0.009675939567387104, -0.020858140662312508, 0.016870133578777313, 0.014962201938033104, 0.022134877741336823, -0.017472637817263603, 0.01553601585328579, -0.004045389126986265, -0.0011530076153576374, 0.023784592747688293, 0.001661370974034071, -0.01598072238266468, -0.002754307584837079, -0.024817457422614098, 0.0017115797381848097, -0.014818748459219933, 0.007032808382064104, -0.032592639327049255, -0.008800873532891273, 0.016224592924118042, -0.0044829221442341805, 0.0033209489192813635, 0.037154462188482285, 0.031789299100637436, -0.00499935494735837, 0.0145103232935071, -0.002212770516052842, 0.008456584997475147, -0.008557002060115337, 0.0335681214928627, -0.05316387116909027, 0.02224964089691639, -0.0018595161382108927, 0.01909366250038147, -0.009080607444047928, 0.04524523764848709, 0.03999483957886696, -0.022020114585757256, 0.001202319748699665, -0.016525844112038612, 5.8277990319766104e-05, -0.00806926004588604, 0.015392562374472618, 0.013585047796368599, 0.024989603087306023, -0.010450588539242744, 0.013785882852971554, 0.007445237599313259, -0.015564706176519394, -0.015320835635066032, -0.006204364355653524, -0.003062732517719269, 0.020083492621779442, -0.007283852435648441, -0.014847438782453537, 0.010988539084792137, -0.03408455476164818, -0.00418525654822588, -0.0006128154927864671, -0.010464933700859547, 0.006132637616246939, 0.022981252521276474, 0.0091451620683074, -0.011010057292878628, 0.020069146528840065, -0.03503134846687317, 0.021015940234065056, -0.02285214513540268, -0.0005509511684067547, 0.006068083923310041, -0.009109298698604107, 0.022335711866617203, 0.010859430767595768, 0.00809077825397253, -0.017099659889936447, -0.011756015941500664, -0.0004193773784209043, -0.004701688885688782, 0.0065414803102612495, 0.008133814670145512, -0.012803226709365845, 0.07637465000152588, -0.0015636433381587267, -0.01923711597919464, 0.00262519926764071, -0.04283522069454193, 0.046536318957805634, -0.003211565548554063, -0.013032752089202404, -0.027743909507989883, 0.016468463465571404, -0.019653132185339928, 0.007409374229609966, 0.013448767364025116, 0.0021177325397729874, -0.022522201761603355, 0.013434422202408314, -0.011863606050610542, 0.02395673654973507, 0.005834971554577351, 0.007086603902280331, 0.028045162558555603, -0.008463757112622261, -0.022120531648397446, 0.008564175106585026, -0.008937153965234756, 0.007803871296346188, 0.006896527949720621, 0.026567591354250908, 0.036810170859098434, 0.03270740061998367, 0.01768781803548336, -0.02094421349465847, -0.008097951300442219, -0.0028816224075853825, 0.021288501098752022, 0.025333890691399574, -0.016697989776730537, 0.03121548518538475, 0.02120243012905121, -0.009037571027874947, 0.021360227838158607, 0.008148159831762314, -0.008313131518661976, -0.019179735332727432, -0.031129412353038788, -0.017515674233436584, 0.03569123521447182, -0.00028152752202004194, 0.01553601585328579, -0.008313131518661976, 0.005307780113071203, -0.0026162334252148867, 0.0018218596233054996, 0.0023257401771843433, 0.020026110112667084, -0.01079487707465887, 0.004178083501756191, 0.03451491519808769, 0.0037369641941040754, 0.00887260027229786, -0.054139357060194016, -0.05167195573449135, -0.0069252182729542255, 0.0013762571616098285, -0.04392546787858009, -0.0270122978836298, -0.02100159414112568, 0.019323188811540604, -0.036810170859098434, -0.002804516116157174, -0.015148690901696682, -0.02058557979762554, 0.002246840624138713, 0.008729146793484688, -0.004515199456363916, 0.023612448945641518, 0.0051535675302147865, 0.023067325353622437, 0.01748698391020298, 0.028920229524374008, -0.005659241229295731, 0.00039247985114343464, -0.030039167031645775, 0.0020513853523880243, 0.002350844442844391, 0.005662827752530575, 0.03001047484576702, -0.017816927284002304, -0.010866603814065456, 0.031129412353038788, -0.03632242977619171, -0.00034608159330673516, 0.008506793528795242, -0.004310778342187405, -0.014295143075287342, -0.019265806302428246, -0.03428538888692856, -0.01708531379699707, -0.006882182322442532, 0.002903140615671873, -0.015206072479486465, 0.008212713524699211, -0.008119468577206135, 0.001358325476758182, -0.004791347309947014, 0.016167210415005684, -0.0368962436914444, -0.02124546654522419, 0.039162810891866684, 0.00887260027229786, 0.00809077825397253, -0.012007059529423714, -0.006186432670801878, -0.007169089280068874, -0.0004583788104355335, 0.03985138610005379, -0.003249222179874778, 0.012982543557882309, 0.0070507400669157505, 0.0023329127579927444, 0.030153928324580193, 0.02009783685207367, 0.009948501363396645, 0.016296319663524628, -0.00961855798959732, -0.006799696478992701, 0.008485275320708752, -0.007301784120500088, -0.025778597220778465, -0.006129051558673382, -0.017816927284002304, -0.011605389416217804, 0.03448622673749924, -0.009891119785606861, 0.029924403876066208, 0.043122127652168274, -0.016712334007024765, -0.013534839265048504, -0.020183909684419632, -0.018849791958928108, 0.011741669848561287, 0.0226513110101223, -0.02049950696527958, -0.004077665973454714, 0.01425927970558405, -0.009955674409866333, -0.0026987192686647177, 0.014065616764128208, 0.013054270297288895, -0.02781563624739647, -0.00168468221090734, -0.0026090608444064856, -0.001639852998778224, 0.014316661283373833, 0.002795550273731351, 0.02960880473256111, -0.0015905408654361963, -0.014847438782453537, 0.012380038388073444, 0.0020675237756222486, 0.0006181949866004288, 0.0014372249133884907, -0.010070436634123325, 0.0315597727894783, 0.05009396746754646, -0.03362550586462021, -0.004253396764397621, 0.020786413922905922, 0.023368578404188156, -0.01778823509812355, 0.024573586881160736, 0.04002353176474571, -0.011088957078754902, 0.005221707746386528, -0.0318753719329834, 0.005684345494955778, -0.03193275257945061, 0.018519848585128784, -0.028231652453541756, 0.001432741992175579, 0.00525039853528142, -0.013592220842838287, 0.0037369641941040754, 0.0024369165766984224, -0.02309601567685604, -0.0315597727894783, -0.007997533306479454, 0.01754436455667019, 0.00044336103019304574, -0.011060265824198723, 0.0048630740493535995, -0.017300494015216827, 0.0202986728399992, -0.003627580823376775, 0.007524136919528246, 0.04590512439608574, 0.010608387179672718, 0.06202929839491844, -0.0019563473761081696, 0.03135893866419792, 0.01963878609240055, 0.011060265824198723, -0.014582050032913685, -0.02544865384697914, -0.00712605332955718, 0.0429786741733551, 0.01283191703259945, 0.010321480222046375, 0.011913814581930637, -0.0014291557017713785, 0.009130815975368023, 0.004525958560407162, 0.012910816818475723, 0.01919407956302166, -0.032535258680582047, -0.009123643860220909, 5.9398720622994006e-05, 0.00859286542981863, -0.015751196071505547, -0.015722505748271942, -0.007897116243839264, 0.012487628497183323, -0.0037082734052091837, -0.03471574932336807, 0.00642671762034297, -0.01969616860151291, 0.006021461449563503, 0.014302315190434456, -0.020886830985546112, -0.022134877741336823, -0.037154462188482285, -0.00317570217885077, 0.0056197913363575935, -0.01129696425050497, 0.03293692693114281, 0.003242049366235733, 0.009216888807713985, -0.027170095592737198, -0.0051966034807264805, 0.03787172958254814, 0.011397382244467735, -0.002515816129744053, 0.00010265892342431471, 0.007190607488155365, -0.004041802603751421, 0.04214664176106453, 0.018519848585128784, -0.021116357296705246, 0.008205541409552097, 0.012293966487050056, -0.026739735156297684, 0.013671119697391987, -0.020628616213798523, -0.01953836902976036, 0.014919165521860123, -0.01390064600855112, 0.015349525958299637, -0.005451233591884375, 0.02791605331003666, 0.014237761497497559, -0.016855787485837936, -0.020513853058218956, 0.010601215064525604, 0.005684345494955778, 0.013233587145805359, 0.014158861711621284, -0.03213358670473099, 0.04053996503353119, -0.052590057253837585, 0.012415901757776737, 0.013943681493401527, 0.009805047884583473, -0.01257370039820671, -0.004733966197818518, 0.0009288614965043962, 0.026036813855171204, -0.009991537779569626, -0.012767363339662552, -0.0018209631089121103, -0.012401556596159935, 0.015048273839056492, -0.006577343679964542, -0.0006204364472068846, -0.02840379625558853, 0.010952675715088844, 0.0023436718620359898, -0.006423131097108126, 0.011978368274867535, 0.0004382056649774313, 0.006939563900232315, 0.0012184582883492112, 0.008255749940872192, 0.009604212827980518, -0.00901605375111103, -0.040769487619400024, -0.0025552657898515463, -0.008334648795425892, -0.0246596597135067, -0.01768781803548336, 0.011311309412121773, -0.005698691122233868, 0.0044398861937224865, -0.001943795126862824, 0.0115766990929842, 0.03067036159336567, 0.005336470901966095, -0.012810398824512959, 0.044413208961486816, -5.0432878197170794e-05, 0.01963878609240055, -0.006903700530529022, -0.013169032521545887, -0.029436660930514336, 0.010335825383663177, -0.016927514225244522, -0.013542012311518192, -0.015335180796682835, 0.03744136914610863, -0.022522201761603355, 0.040310438722372055, 0.009697457775473595, 0.012423074804246426, 0.014682467095553875, -0.0022199430968612432, 0.04269176721572876, -0.013936509378254414, 0.010529488325119019, -0.01052231527864933, 0.023124706000089645, 0.006046565715223551, 0.01959574967622757, -0.0006831973441876471, 0.023382922634482384, -0.004981423262506723, 0.017902998253703117, 0.021216774359345436, 0.013391385786235332, 0.0335681214928627, 0.012659772299230099, -0.03563385456800461, -0.03514610975980759, 0.020112182945013046, -0.006143396720290184, -0.02450186014175415, -0.005748899653553963, 0.01753002032637596, -0.011791879311203957, 0.0020442125387489796, -0.018247287720441818, -0.003130872966721654, 0.024387096986174583, 0.02500394731760025, 0.009575522504746914, 0.045273929834365845, 0.031043341383337975, -0.010213890112936497, -9.565435902914032e-05, -0.004045389126986265, -0.0054440610110759735, 0.0003229945432394743, -0.014352524653077126, 0.0008634108235128224, 0.009554004296660423, 0.008793700486421585, 0.004859487991780043, -0.003962903283536434, -0.0038911765441298485, -0.045015715062618256, -0.016310663893818855, -0.021661480888724327, -0.021833624690771103, 0.022809108719229698, 0.023468995466828346, 0.021675826981663704, -0.01194967795163393, -0.019667476415634155, -0.0031721158884465694, -0.025965087115764618, 0.0031470113899558783, -0.006713624577969313, 0.0372692234814167, -0.013484630733728409, 0.01763043738901615, -0.02108766697347164, -0.025563417002558708, 0.00442195450887084, 0.021173739805817604, 0.02285214513540268, 0.015019583515822887]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
" of 5
1 medication used to 3
2 treat bacterial 2
3 infections 1
Table 4. Partitioning examples for Table 5.
general) does help or does not, we experimented with Llama 7B on a low-bandwidth setup (10GB/s) and a poor-bandwidth
setup (1GB/s) and report the TTFT for each case in Table 3. The bold numbers are when it is beneficial to have multi-GPU
inference over single-GPU inference in terms of TTFT. One can observe the followings:
•Parallel inference is helpful only when the bandwidth is good enough OR the input context is long enough. For example,
the bold numbers which indicate when it is beneficial to have multi-GPU inference over single-GPU inference in terms
of TTFT form a lower triangle in the table.
•Even for parallel inference, when the bandwidth is not high enough, using more GPUs is not always helping. For the
example of 2K input and 10GB/s, TTFT is 0.16sec with 2GPUs, but it gets worse into 0.19sec with 4GPUs. Such a
degradation is more pronounced with 1GB/s network.
All above imply that for a given the infrastructure bandwidth, the optimal system for LLM inference can be determined
based on the input size distribution of the target application. A user request needs to dynamically be assigned to a system
13
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
input = ‘ A n t i b i o t i c s a r e a type of m e d i c a t i o n used t o t r e a t b a c t e r i a l i n f e c t i o n s ‘
i fmethod== ’ t s p ’ :
c o n t e x t = e v e n c o n t e x t p a r t i t i o n i n g ( input , rank , w o r l d s i z e )
e l i f method== ’ kvr ’ :
c o n t e x t = k v a c o n t e x t p a r t i t i o n i n g ( input , rank , w o r l d s i z e )
e l s e :
c o n t e x t = input
def f o r w a r d ( c o n t e x t , mask , rank , w o r l d s i z e , method , KV cache=None ) :
i fmethod== ’ kvr ’ and rank >0:
KV cache = n e t r e c v ( rank −1)
i fmethod== ’ t s p ’ :
Q = q p r o j ( c o n t e x t )
l o c a l K = k p r o j ( c o n t e x t )
l o c a l V = v p r o j ( c o n t e x t )
K, V = n e t a l l g a t h e r ( l o c a l K , l o c a l V )
e l s e :# kvr , base
Q = q p r o j ( c o n t e x t )
K = k p r o j ( c o n t e x t )
V = v p r o j ( c o n t e x t )
i fKV cache :
K = c a t ( KV cache [ 0 ] , K)
V = c a t ( KV cache [ 1 ] , V)
KV cache = s t a c k (K, V)
i fmethod== ’ kvr ’ and r an k <w o r l d s i z e −1:
n e t s e n d ( KV cache , ra n k +1)
a t t n w e i g h t s = softmax ( matmul (Q, K. T ) + mask )
a t t n o u t p u t = matmul ( a t t n w e i g h t s , V)
a t t n o u t p u t = o p r o j ( a t t n o u t p u t )
return a t t n o u t p u t , KV cache
Table 5. Simplified Pseudo Code with KV-Runahead Integration
with the right number of GPUs based on the optimization metric (i.e., cost, latency, utilization, and so on).
C. Pseudo Code and Example
Table 5 shows the simplified pseudo code for KV-Runahead integration into an existing transformer implementation, which
also contrasts it with T","[-0.05366393178701401, -0.0054225861094892025, 0.023797566071152687, -0.013359790667891502, 0.03739617392420769, -0.016970165073871613, 0.006753648165613413, 0.02978207729756832, -0.02989446371793747, 0.02428925223648548, 0.010430751368403435, 0.034052714705467224, 0.0002176365815103054, -0.0024865225423127413, -0.005541995167732239, -0.04222873970866203, 0.028826802968978882, -0.04804467409849167, -0.026565052568912506, 0.03953149542212486, -0.04781990125775337, -0.01900714635848999, 0.02902347780764103, 0.035850878804922104, 0.006971394643187523, -0.03188930079340935, -0.013282526284456253, 0.02069292590022087, 0.01733541674911976, -0.05728835612535477, 0.030119232833385468, -0.02997875213623047, -0.07906299084424973, -0.061137549579143524, 0.006704479455947876, 0.053102005273103714, 0.034108906984329224, 0.03520466387271881, -0.008330552838742733, 0.04236922040581703, 0.015649639070034027, -0.038491930812597275, -0.07872582972049713, -0.0007177726947702467, -0.0021177586168050766, -0.010114667937159538, -0.002077370183542371, -0.03944720700383186, -0.03284457325935364, 0.03790190815925598, 0.018473317846655846, 0.007698386441916227, -0.07456757873296738, 0.0014127170434221625, 0.011371977627277374, 0.011442217975854874, -0.0003852266236208379, 0.0018209913978353143, 0.0632166787981987, -0.022139884531497955, 0.012994538992643356, -0.052118636667728424, 0.014947231858968735, -0.009861801750957966, -0.0359913595020771, 0.00860449206084013, -0.011877710931003094, 0.00403884332627058, -0.033097442239522934, 0.01628180593252182, -0.03340649977326393, 0.032985057681798935, 0.04692082107067108, -0.012559046037495136, 0.00816197507083416, 0.03745236620306969, -0.020496251061558723, 0.05605211853981018, 0.02893918938934803, -0.01798163168132305, 0.05343916267156601, -0.012523925863206387, 0.037480466067790985, 0.010978628881275654, 0.026860062032938004, -0.06574533879756927, -0.04714559018611908, -0.03795810043811798, -0.0541977621614933, -0.03143975883722305, -0.01216569822281599, 0.03472702577710152, -0.029669692739844322, 0.035878974944353104, 0.03542943298816681, 0.014202679507434368, 0.054731592535972595, -0.044729311019182205, 0.0013688165927305818, 0.015228194184601307, 0.03427748754620552, 0.023727325722575188, 0.022448943927884102, -0.03905385732650757, 0.06647584587335587, -0.0033223875798285007, -0.01799567975103855, 0.015860361978411674, -0.002560275373980403, -0.012109505012631416, -0.059170808643102646, -0.020116951316595078, -0.0272674597799778, 0.03143975883722305, 0.005506874993443489, -0.043155916035175323, -0.05265246704220772, -0.00821816734969616, -0.014834846369922161, -0.006398932542651892, -0.024022337049245834, 0.018473317846655846, 0.02445782907307148, 0.008435914292931557, -0.018529510125517845, -0.024879273027181625, 0.03733998164534569, -0.049337103962898254, 0.005647356156259775, -0.0017999191768467426, 0.014539835043251514, -0.01215165015310049, 0.0637224093079567, 0.008527226746082306, -0.0003558133030310273, 0.00817602314054966, 0.002335504861548543, 0.02632623352110386, 0.0012081408640369773, 0.016885876655578613, -0.044757407158613205, -0.017686620354652405, 0.0014469594461843371, 0.01888071373105049, -0.027506276965141296, 0.043942611664533615, -0.022856339812278748, 0.010543136857450008, -0.03368746489286423, 0.006181186065077782, -0.01264333538711071, -0.0012546754442155361, -0.016871828585863113, -0.03958768770098686, 0.0027042687870562077, -0.02434544451534748, -0.03141166269779205, 0.03731188550591469, 0.027576519176363945, -0.036637574434280396, -0.013458128087222576, -0.016928020864725113, 0.052905332297086716, 0.017770910635590553, -0.01709659770131111, 0.00743147125467658, -0.0631042867898941, -0.005538483150303364, -0.06259855628013611, -0.032928865402936935, 0.027815336361527443, -0.04088011756539345, -0.045712679624557495, 0.00765624176710844, 0.0362442284822464, -0.03686234727501869, -0.03233884274959564, -0.007817795500159264, 0.013591584749519825, -0.0627671331167221, -0.05872126668691635, 0.03888528048992157, -0.0005189035437069833, 0.05363583564758301, -0.03815477713942528, -0.0018859641859307885, -0.0062022581696510315, 0.017546139657497406, -0.015677735209465027, -0.007508736103773117, 0.01621156558394432, 0.025918837636709213, 0.05518113449215889, 0.04259398952126503, -0.0007480639615096152, 0.009608934633433819, 0.032170262187719345, -0.007227773312479258, 0.015537253580987453, 0.010550160892307758, 0.01612727716565132, -0.009749416261911392, 0.014062197878956795, -0.06029466167092323, 0.012046288698911667, -0.04138585180044174, -0.03360317647457123, -0.0021897554397583008, -0.04088011756539345, -0.004951972980052233, 0.002878114813938737, 0.0451507531106472, 0.017883295193314552, 0.016759442165493965, 0.010950532741844654, -0.028686322271823883, -0.08468224853277206, 0.016576817259192467, -0.004098547622561455, 0.04340878501534462, 0.004618329461663961, 0.03523276001214981, -0.04222873970866203, 0.007333134301006794, -0.0364128053188324, 0.06248617172241211, -0.021549861878156662, -0.05279294773936272, 0.004955484997481108, -0.025609778240323067, 0.01633799821138382, -0.026958400383591652, 0.009700248017907143, -0.03343459591269493, 0.006957346107810736, -0.018332835286855698, -0.015846313908696175, -0.053804416209459305, -0.029697788879275322, -0.07771436870098114, -0.015270339325070381, 0.0011308761313557625, 0.00810578279197216, -0.028756562620401382, -0.02627004124224186, 0.0272393636405468, -0.019400496035814285, -0.05062953382730484, 0.03705902025103569, 0.02073507010936737, -0.03318173065781593, -0.02804010733962059, -0.07810771465301514, -0.03278838098049164, -0.05855268985033035, -0.0019790332298725843, 0.0047869072295725346, -0.0066061425022780895, -0.012790841050446033, 0.013956837356090546, -0.010234077461063862, -0.013774211518466473, -0.03149595111608505, 0.0027815336361527443, -0.04147014021873474, 0.019400496035814285, -0.02347445860505104, -0.010037403553724289, -0.03374365717172623, -0.04332449287176132, 0.02070697396993637, 0.00819007121026516, 0.011006725952029228, -0.016675153747200966, -0.004189860541373491, -0.010732786729931831, 0.019639313220977783, 0.0056438441388309, -0.009384164586663246, 0.009398212656378746, -0.015677735209465027, -0.015874410048127174, 0.05675452575087547, 0.014006005600094795, 0.006637750659137964, 0.0021019545383751392, -0.008955695666372776, 0.02365708537399769, 0.009510597214102745, -0.05613640695810318, 0.011400073766708374, 0.022448943927884102, 0.028194637969136238, 0.013415982946753502, 0.023853758350014687, 0.054675400257110596, -0.03419319540262222, 0.007269917521625757, -0.00821114331483841, -0.005106502678245306, 0.03424939140677452, -0.0038772893603891134, -0.007852915674448013, 0.03514847159385681, -0.03076544776558876, 0.02794177085161209, 0.0045796968042850494, -0.017686620354652405, -0.04147014021873474, 0.016689201816916466, -0.014975327998399734, 0.010613377206027508, -0.027801288291811943, 0.03964387997984886, -0.03464273735880852, -0.027843432500958443, 0.04596554860472679, -0.05166909471154213, 0.040177710354328156, -0.04051486402750015, 0.004685058258473873, -0.10109049081802368, 0.014385305345058441, 0.03318173065781593, 0.02787153050303459, 0.01736351288855076, -0.025174284353852272, 0.0045761847868561745, -0.022842291742563248, -0.020285528153181076, 0.00808471068739891, 0.002245947951450944, 0.03725569322705269, -0.014806750230491161, -0.06877974420785904, -0.001149314222857356, 0.005176743492484093, 0.022139884531497955, 0.011217447929084301, 0.005187279544770718, -0.07439900189638138, 0.003656031098216772, -0.030568774789571762, 0.02632623352110386, -0.016520624980330467, 0.056501660495996475, 0.06434052437543869, -0.00043746817391365767, 0.06788066029548645, 0.02083340659737587, 0.009187489748001099, -0.04368974640965462, 0.05726025998592377, -0.01729327253997326, 0.027351748198270798, -0.034811314195394516, 0.03332221135497093, -0.04273447394371033, -0.04731417074799538, 0.001410961034707725, -0.027759144082665443, 0.010957556776702404, 0.03537324070930481, -0.010571232996881008, -0.008295432664453983, 0.0182064026594162, -0.012931321747601032, 0.0015575885772705078, -0.005619260016828775, 0.00428468594327569, 0.011463290080428123, 0.04079582914710045, 0.00858341995626688, -0.043914515525102615, -0.05251198634505272, -0.04807277023792267, 0.02896728552877903, 0.05349535495042801, 0.031186893582344055, 0.053804416209459305, 0.02341826632618904, 0.012615238316357136, -0.013879572041332722, -0.002792069921270013, 0.04897185042500496, -0.004639401566237211, 0.01123852003365755, 0.011969023384153843, -0.0452069453895092, -0.002209071535617113, -0.013219309039413929, 0.016871828585863113, -0.02076316624879837, 0.024752840399742126, -0.01172318123281002, 0.023713277652859688, 0.030400196090340614, 0.02434544451534748, 0.04191967844963074, 0.04090821370482445, -0.0064200046472251415, -0.010690642520785332, -0.05624879151582718, -0.011224471963942051, 0.0136056337505579, 0.008527226746082306, 0.038379546254873276, 0.024738792330026627, 0.038351450115442276, 0.020243383944034576, 0.03528895229101181, -0.03427748754620552, 0.018403075635433197, -0.06265474855899811, 0.051191460341215134, -0.019358349964022636, -0.00157953891903162, 0.03888528048992157, -0.0225894246250391, 0.04411119222640991, -0.04189158231019974, 0.02076316624879837, -0.02812439575791359, -0.01487699057906866, -0.03809858113527298, -0.012594166211783886, 0.0046042813919484615, -0.05074191838502884, 0.0006628970731981099, -0.008534250780940056, -0.0022477039601653814, 0.01626775786280632, 0.039362914860248566, 0.019639313220977783, -0.00905403308570385, -0.018684038892388344, 0.03514847159385681, 0.020468154922127724, 0.017869247123599052, -0.009004863910377026, -0.013430031016469002, -0.012559046037495136, -0.005921295378357172, -0.009524645283818245, -0.07861344516277313, 0.010100619867444038, 0.0031906859949231148, -0.0005180255393497646, 0.05346725881099701, -0.05321439355611801, 0.017658524215221405, 0.014919135719537735, 0.030934026464819908, -0.0074174231849610806, -0.002981719793751836, -0.06153089553117752, 0.07956872135400772, 0.0024197937455028296, 0.025637874379754066, -0.007571952883154154, 0.012488805688917637, 0.002051029819995165, -0.043071627616882324, -0.025089995935559273, 0.00867473240941763, 0.008702828548848629, 0.09715700894594193, -0.0034400406293570995, 0.03545752912759781, -0.0030063041485846043, 0.016731346026062965, -0.00633220374584198, 0.0225894246250391, -0.01636609435081482, -0.017686620354652405, 0.017630428075790405, 0.021479621529579163, -0.036778055131435394, 0.027337700128555298, 0.0049800691194832325, 0.02539905533194542, -0.023024918511509895, -0.016675153747200966, 0.004253077320754528, 0.025989077985286713, 0.07349991798400879, 0.0637224093079567, 0.0031046411022543907, -0.005513899028301239, -0.02628408931195736, -0.02617170289158821, -0.02992255985736847, 0.04812896251678467, -0.016815636307001114, 0.016829684376716614, 0.0113157844170928, -0.020341720432043076, 0.007213725242763758, 0.03079354576766491, -0.012306179851293564, 0.03070925548672676, 0.009882873855531216, -0.001331940176896751, 0.019260013476014137, 0.019231917336583138, 0.03250741958618164, 0.06608249992132187, 0.010564208962023258, -0.03537324070930481, 0.03745236620306969, -0.0022863363847136497, 0.0029887438286095858, 0.016562769189476967, 0.04071153700351715, -0.007916132919490337, 0.025581682100892067, -0.02812439575791359, 0.024134721606969833, -0.003434772603213787, -0.0010860975598916411, -0.021282946690917015, -0.01800972782075405, -0.024935467168688774, -0.02344636246562004, 0.02072102203965187, 0.00041485941619612277, -0.02913586236536503, -0.12081409245729446, -0.029388729482889175, -0.0720951035618782, -0.006743112113326788, -0.02088959887623787, -0.038407642394304276, -0.0005873882910236716, -0.04175110161304474, 0.019681457430124283, 0.006655311211943626, -0.03430558368563652, -0.043858323246240616, -0.008400794118642807, 0.0071996767073869705, 0.0035559379030019045, 0.00657102232798934, 0.013886596076190472, 0.005812421906739473, -0.03231074661016464, 0.05827172473073006, -0.01711064763367176, -0.020074807107448578, 0.013689922168850899, 0.014694364741444588, -0.020664827898144722, 0.026803869754076004, -0.010746834799647331, -0.013071803376078606, -0.015186049975454807, 0.015902506187558174, 0.02184487320482731, -0.0007019684999249876, 0.004021282773464918, 0.03793000429868698, 0.00864663626998663, -0.006995978765189648, -0.038548123091459274, -0.030175426974892616, 0.048494212329387665, 0.014806750230491161, -0.016815636307001114, 0.0006563119823113084, 0.015101761557161808, -0.020369818434119225, 0.0032100023236125708, 0.002851774450391531, -0.005556043237447739, -0.009208562783896923, -0.02188701741397381, 0.01619751751422882, 0.0066061425022780895, -0.006546437740325928, 0.010402655228972435, -0.04987093433737755, -0.009327971376478672, -0.019695505499839783, -0.017827102914452553, -0.019526928663253784, -0.000836303923279047, -0.014680316671729088, 0.009826680645346642, -0.04099250212311745, 0.006553461775183678, 0.02975398115813732, 0.011343881487846375, 0.02524452470242977, -0.022448943927884102, 0.001857867813669145, -0.007557904813438654, -0.015733927488327026, -0.02074911817908287, -0.014610076323151588, -0.01216569822281599, 0.011526507325470448, 0.0026656363625079393, -0.0007094315951690078, -0.0359351672232151, -0.027520325034856796, 0.02093174308538437, -0.013760162517428398, 0.05102287977933884, 0.01796758361160755, -0.023853758350014687, -0.0021212706342339516, -0.03520466387271881, -0.04180729389190674, -0.004779883194714785, -0.035626109689474106, -0.037592850625514984, -0.022884435951709747, -0.0038772893603891134, 0.03427748754620552, -0.03365936875343323, 0.006170650012791157, -0.0049835811369121075, 0.013865523971617222, -0.020440058782696724, -0.0020650781225413084, 0.04197587072849274, 0.01623966172337532, -0.019428592175245285, -0.04085202142596245, 0.01615537330508232, -0.03944720700383186, 0.0005030993488617241, 0.008435914292931557, 0.02264561876654625, -0.026775773614645004, -0.0008512301137670875, 0.021114369854331017, 0.003566474188119173, 0.023741373792290688, -0.015186049975454807, 0.03180501237511635, 0.025553584098815918, -0.0022547279950231314, -0.00813387893140316, 0.003331167623400688, 0.014975327998399734, -0.013591584749519825, 0.024598311632871628, -0.016731346026062965, -0.051865771412849426, -0.033827945590019226, -0.05273675546050072, 0.026087414473295212, 0.03236693888902664, 0.035682301968336105, -0.013725042343139648, -0.040121518075466156, -0.00864663626998663, 0.005064358003437519, -0.04099250212311745, -0.04045867174863815, -0.01973765157163143, -0.026003126055002213, -0.009721320122480392, -0.004871196113526821, 0.013577536679804325, 0.00908212922513485, 0.041217271238565445, 0.008302456699311733, -0.012797865085303783, 0.0027306091506034136, 0.018403075635433197, 0.015818217769265175, -0.01886666566133499, -0.0034488209057599306, -0.0026024198159575462, -0.004077475517988205, -0.035569917410612106, -0.02614360675215721, 0.03922243416309357, -0.02885490097105503, -0.011112086474895477, -0.04975854605436325, -0.00657102232798934, -0.007909108884632587, 0.010037403553724289, 0.017813054844737053, -0.014806750230491161, 0.01621156558394432, -0.03908195346593857, 0.0013205261202529073, 0.004372486844658852, 0.015649639070034027, -0.030456388369202614, -0.007298014126718044, 0.024219010025262833, -0.0007107486017048359, 0.03694663569331169, -0.027773192152380943, -0.028264878317713737, 0.022111788392066956, 0.015649639070034027, -0.04352116957306862, -0.01982193998992443, -0.010262173600494862, -0.031299278140068054, -0.008773069828748703, 0.05133194103837013, 0.05152861401438713, -0.02358684316277504, -0.026466714218258858, 0.0037122236099094152, -0.00769136194139719, -0.016871828585863113, -0.04270637780427933, -0.022294413298368454, -0.00808471068739891, 0.010325389914214611, -0.0030695206951349974, -0.002202047500759363, -0.031243085861206055, 0.0010211248882114887, -0.024626407772302628, 0.006876569241285324, 0.0049765571020543575, -0.01269952766597271, -0.05523732677102089, 0.03545752912759781, 0.02910776622593403, 0.006455124821513891, 0.041217271238565445, 0.02362898923456669, 0.011603771708905697, -0.022013451904058456, -0.0017042162362486124, 0.009819656610488892, -0.02534286305308342, -0.01216569822281599, -0.051978155970573425, -0.019512880593538284, 0.009299875237047672, -0.025890739634633064, -0.004221469163894653, 0.042088259011507034, 0.010493967682123184, -0.003989674616605043, -0.002653344301506877, 0.0021072225645184517, -0.006855497136712074, -0.025918837636709213, -0.010669570416212082, 0.013865523971617222, 0.000685725302901119, -0.0059809996746480465, -0.003573498222976923, -0.02350255474448204, 0.017433755099773407, -0.007993397302925587, -0.01718088798224926, -0.011849614791572094, 0.0023530651815235615, -0.012095456942915916, -0.00316610187292099, -0.004309270065277815, 0.014511738903820515, 0.014905087649822235, -0.0025427150540053844, 0.0002563787274993956, -0.004505943972617388, 0.009637030772864819, -0.0056052119471132755, -0.027759144082665443, 0.012123553082346916, -0.00814090296626091, 0.06743112206459045, -0.03357508033514023, -0.010725762695074081, -0.00864663626998663, 0.01736351288855076, 0.033041249960660934, -0.03177691623568535, -0.028714418411254883, -0.03152404725551605, -0.026003126055002213, -0.0036349587608128786, -0.020355768501758575, -0.016071083024144173, 0.013914692215621471, -0.0027885576710104942, -0.035654205828905106, -0.01364075392484665, -0.02989446371793747, -0.0024794985074549913, -0.005415561608970165, -0.005991536192595959, 0.04731417074799538, -0.012067360803484917, -0.09423498809337616, -0.03540133684873581, 0.01909143663942814, 0.007895059883594513, 0.016717297956347466, -0.0001301648881053552, 0.0008718633325770497, -0.009405236691236496, -0.0005904613062739372, -0.013893620111048222, -0.02090364694595337, -0.021311042830348015, -0.002953623654320836, 0.0047588106244802475, 0.002533935010433197, -0.026775773614645004, 0.020468154922127724, 0.004253077320754528, 0.01175830140709877, -0.042903050780296326, -0.014343161135911942, -0.0028096300084143877, 0.0136196818202734, 0.01719493605196476, -0.034783218055963516, -0.0028465064242482185, 0.001792017137631774, -0.013430031016469002, 0.020159095525741577, 0.043127819895744324, -0.0037649041041731834, -0.017546139657497406, 0.0272674597799778, 0.03174882009625435, -0.035766590386629105, 0.017644476145505905, -0.014933183789253235, 0.0032433667220175266, 0.012825961224734783, -0.017869247123599052, -0.01976574771106243, -0.07574762403964996, 0.004432191140949726, 0.001984301256015897, 0.03784571588039398, -0.02612955868244171, 0.032956961542367935, -0.003076544962823391, -0.005081918090581894, 0.013542416505515575, 0.03868860378861427, -0.012488805688917637, -0.03978436067700386, 0.010465871542692184, 0.031046411022543907, -0.002440866082906723, -0.04259398952126503, 0.0014794458402320743, -0.0037403199821710587, 0.0012906737392768264, 0.00239169760607183, 0.015551301650702953, 0.021086273714900017, -0.04006532207131386, -0.033799849450588226, -0.024823080748319626, 0.021367236971855164, 0.027534374967217445, 0.007621121592819691, -0.01362670585513115, 0.0017147522885352373, 0.004449751693755388, 0.002339016878977418, -0.0004991483292542398, 0.004628865513950586, 0.01487699057906866, -0.020496251061558723, -0.002735877176746726, -0.07670290023088455, 0.034080810844898224, 0.02358684316277504, -0.04175110161304474, 0.014441498555243015, -0.0005320736672729254, 0.031158797442913055, 0.03090593032538891, 0.03194549307227135, -0.01999051682651043, -0.007838867604732513, 0.00019513758888933808, 0.021311042830348015, -0.006700967438519001, 0.009882873855531216, 0.008773069828748703, 0.011055894196033478, 0.017630428075790405, 0.013317646458745003, 0.027337700128555298, -0.0024865225423127413, -0.016647057607769966, 0.03349078819155693, 0.012467733584344387, -0.012088432908058167, -0.056642141193151474, -0.025047851726412773, 0.0033399476669728756, 0.028630129992961884, -0.019540976732969284, 0.032928865402936935, -0.05082620680332184, 0.027295555919408798, -0.01906334049999714, -0.0005803641979582608, 0.03955959156155586, 0.002259996021166444, 0.03138356655836105, 0.0136056337505579, 0.004951972980052233, 0.012530949898064137, -0.030147330835461617, 0.026466714218258858, 0.018754281103610992, -0.01169508509337902, -0.0034734050277620554, -0.0225753765553236, -0.006971394643187523, -0.0026252479292452335, 0.02627004124224186, 0.012102480977773666, 0.019709553569555283, -0.014933183789253235, 0.03231074661016464, 0.011926879175007343, 0.03270409256219864, -0.0013828647788614035, -0.03284457325935364, -0.020130999386310577, -0.0036384707782417536, -0.000733576831407845, 0.022097740322351456, 0.014399353414773941, 0.0090891532599926, 0.02343231439590454, 0.0112736402079463, -0.011126134544610977, 0.007276941556483507, 0.003951042424887419, -0.003434772603213787, 0.008808190003037453, -0.0028798708226531744, 0.0032100023236125708, -0.03551372513175011, 0.02631218545138836, 0.041189175099134445, 0.0021511230152100325, 0.03882908821105957, -0.012847033329308033, -0.02997875213623047, 0.0359632633626461, 0.05787837877869606, 0.01222189050167799, 0.00017121182463597506, 0.012776792049407959, 0.02098793536424637, 0.04408309608697891, -0.0036981755401939154, -0.010198957286775112, -0.004555112682282925, 0.028587985783815384, 0.022462991997599602, -0.00026779287145473063, -0.0451226569712162, 0.015705831348896027, 0.03961578384041786, 0.05251198634505272, 0.031102603301405907, 0.003176637925207615, -0.012355348095297813, 0.001063269330188632, 0.00635327585041523, -0.003424236550927162, -0.00590373482555151, -0.03714330866932869, 0.01626775786280632, 0.01130876038223505, -0.011842590756714344, 0.02625599317252636, 0.010100619867444038, -0.0009333239868283272, 0.01263631135225296, 0.025075947865843773, 0.02812439575791359, 0.0038140728138387203, 0.04781990125775337, 0.02093174308538437, -0.025553584098815918, 0.015186049975454807, 0.03236693888902664, -0.02438758872449398, -0.0004951973096467555, -0.004836075473576784, 0.016647057607769966, 0.01990622840821743, -0.030400196090340614, -0.03318173065781593, 0.04093630984425545, -0.008007445372641087, -0.030147330835461617, -0.011386025696992874, 0.007171580567955971, -0.0014162291772663593, 0.022069644182920456, -0.01806592009961605, 0.02809629961848259, -0.0074244472198188305, -0.014097318984568119, -0.02902347780764103, -0.017012309283018112, -0.012832985259592533, -0.006500781513750553, -0.04714559018611908, -0.032114069908857346, 0.0055736033245921135, 0.011870686896145344, -0.018501413986086845, 0.02358684316277504, 0.03242313116788864, -0.027520325034856796, 0.0025075948797166348, 0.003071276703849435, 0.0028640665113925934, 0.0002833775361068547, 0.0052013276144862175, -0.00023640402650926262, -0.02358684316277504, 0.007845891639590263, -0.028616081923246384, -0.01807996816933155, 0.0014689096715301275, -8.35206446936354e-05, 0.03458654507994652, 0.006848473101854324, 0.025132140144705772, 0.011442217975854874, -0.018655942752957344, -0.005415561608970165, 0.03770523518323898, 0.0543663389980793, 0.0023425291292369366, -0.002769241575151682, -0.004923876374959946, 0.00011216569691896439, 0.03500799089670181, -0.001480323844589293, 0.007719458546489477, -0.009173441678285599, 0.00856937188655138, 0.06737492978572845, 0.006103921215981245, 0.023727325722575188, -0.010388607159256935, 0.009159393608570099, 0.02357279509305954, -0.018332835286855698, -0.005352345295250416, -0.025623826310038567, 0.0003437406849116087, -0.021985353901982307, 0.002073858166113496, 0.008407818153500557, -0.021901065483689308, 0.01985003612935543, 0.00043615116737782955, 0.012783816084265709, -0.014567931182682514, 0.007895059883594513, -0.01222891453653574, -0.010451823472976685, 0.023825662210583687, -0.007979349233210087, -0.024696648120880127, -0.028208686038851738, -0.031102603301405907, -0.01123852003365755, -0.013043707236647606, -0.005931831430643797, -0.013212285004556179, 0.009377140551805496, 0.026059318333864212, 0.0023337488528341055, -0.010234077461063862, 0.01807996816933155, 0.022210124880075455, -0.01621156558394432, -0.0012195550370961428, 0.0030958610586822033, -0.010880292393267155, -0.00477637117728591, 0.023193495348095894, -0.04332449287176132, 0.0025427150540053844, 0.01720898412168026, 0.03717140480875969, -0.022196076810359955, 0.053832512348890305, 0.022308461368083954, -0.021957257762551308, -0.0036911515053361654, -0.02268776297569275, -0.001842063618823886, 0.024612359702587128, 0.010627425275743008, 0.0024917905684560537, 0.03722759708762169, -0.01896500214934349, 0.030259715393185616, 0.010170860216021538, -0.03725569322705269, -0.0010474651353433728, -0.022196076810359955, 0.006483221426606178, -0.003894849680364132, -0.015972746536135674, 0.006988954730331898, -0.005057333968579769, -0.038379546254873276, 0.011870686896145344, 0.004274149425327778, 0.018641894683241844, -0.004126644227653742, 0.018543558195233345, 0.020060759037733078, 0.00821114331483841, 0.005138110835105181, -0.04405499994754791, 0.00953869428485632, -0.00809173472225666, 0.0016313414089381695, 0.002259996021166444, 0.00013334766845218837, 0.014020053669810295, 0.021100321784615517, 0.006058264523744583, -0.015214146114885807, -0.012376420199871063, 0.007557904813438654, -0.02811034768819809, 0.01706850156188011, -0.0005952903302386403, -0.03261980414390564, 0.0639471784234047, -0.01993432454764843, -0.013064779341220856, 0.011582699604332447, -0.040318191051483154, 0.03191739693284035, -0.011329833418130875, -0.004488383885473013, -0.01911953277885914, 0.012467733584344387, -0.00743849528953433, 0.000712065608240664, -0.004463799763470888, 0.0039861625991761684, 0.01219379436224699, 0.005531459115445614, -0.006725552026182413, 0.02074911817908287, 0.004133668262511492, 0.012439636513590813, 0.025005707517266273, -0.02177463285624981, -0.011055894196033478, -0.0005022213445045054, -0.015523205511271954, -0.0026147118769586086, -0.008723901584744453, 0.014708412811160088, 0.02076316624879837, 0.03323792293667793, -0.0031186894048005342, -0.036581382155418396, -0.01733541674911976, -0.01081707514822483, -0.00908212922513485, 0.023797566071152687, -0.03073735162615776, 0.029585404321551323, -0.0027200730983167887, -0.005468242336064577, 0.016604913398623466, -0.001884208177216351, -0.00811280682682991, -0.010746834799647331, -0.03441796824336052, -0.007600049022585154, 0.00743147125467658, 0.014329113066196442, 0.023938046768307686, 0.005324248690158129, 0.02893918938934803, -0.008492106571793556, -0.007161044515669346, -0.0031941980123519897, 0.015157953836023808, -0.029557308182120323, 0.020243383944034576, 0.03717140480875969, 0.00864663626998663, 0.03225455433130264, -0.04340878501534462, -0.0363285169005394, -0.017827102914452553, -0.006395420525223017, -0.0452350415289402, -0.014265896752476692, -0.017939487472176552, 0.018613798543810844, -0.017644476145505905, -0.017672572284936905, 0.01708254963159561, -0.018669990822672844, 0.0022073155269026756, 0.002461938187479973, 0.004432191140949726, 0.018374979496002197, -0.016942068934440613, 0.010283245705068111, 0.0033329236321151257, 0.019147628918290138, -0.01221486646682024, -0.006054752506315708, -0.005580627825111151, 0.014181607402861118, -0.020060759037733078, 0.0010193688794970512, 0.01996242068707943, 0.0029465993866324425, -0.0226175207644701, 0.02611551061272621, -0.0023495531640946865, 0.041132982820272446, 0.009194513782858849, -0.01899309828877449, -0.011969023384153843, -0.02702864073216915, -0.02435949258506298, -0.013401934877038002, -0.0012125310022383928, 0.010381583124399185, -0.010374559089541435, -0.015958698466420174, 0.005099478643387556, 0.0038667533081024885, 0.0034066764637827873, 0.03464273735880852, -0.03528895229101181, 0.0041687884368002415, 0.033153634518384933, 0.01081707514822483, -0.007845891639590263, -0.014076245948672295, -0.009587862528860569, 0.003269706852734089, 0.016731346026062965, 0.04045867174863815, 0.01170210912823677, 0.02088959887623787, 0.007333134301006794, -0.0033434596844017506, 0.019442640244960785, 0.004825539421290159, 0.01800972782075405, -0.01976574771106243, -0.01896500214934349, 0.00119233678560704, 0.0013916448224335909, -0.0057878377847373486, -0.02093174308538437, -0.016590865328907967, 0.00018668673874344677, -0.009735368192195892, 0.027548423036932945, 0.00013257941463962197, 0.021437477320432663, 0.030344003811478615, 0.005707060918211937, -0.023909950628876686, -0.017883295193314552, -0.006595606449991465, 0.0016041231574490666, 0.025595730170607567, 0.003901873715221882, 0.010838148184120655, 0.0182344987988472, 0.00955976638942957, 0.007593024987727404, 0.01993432454764843, 0.0272112675011158, -0.014301016926765442, 0.001149314222857356, 1.2470476576709189e-05, 0.003331167623400688, 0.008836286142468452, 0.004049379378557205, 0.0025760794524103403, -0.015242243185639381, -0.033996522426605225, 0.027773192152380943, 0.0037578800693154335, 0.00562277203425765, -0.010367535054683685, -0.002686708699911833, 0.024724744260311127, 0.045600295066833496, -0.04071153700351715, -0.0005347077385522425, -0.009349043481051922, 0.025848595425486565, -0.01228510681539774, 0.03233884274959564, 0.03278838098049164, -0.002335504861548543, 0.005580627825111151, -0.0015373944770544767, 0.00031235182541422546, -0.013289550319314003, 0.015649639070034027, -0.013408958911895752, -0.007705410476773977, -0.010852196253836155, -0.01612727716565132, 0.00821114331483841, 0.007312062196433544, -0.020074807107448578, -0.03537324070930481, -0.011905807070434093, 0.011961999349296093, -0.005661404691636562, -0.026789821684360504, 0.0013091119471937418, -0.013598608784377575, 0.011912831105291843, -0.013254429213702679, 0.0058018858544528484, 0.01805187202990055, 0.015031520277261734, 0.04883136972784996, -0.013345742598176003, 0.02187296934425831, 0.010381583124399185, 0.011547579430043697, -0.0181642584502697, -0.006525365635752678, 0.012446660548448563, 0.04902804270386696, 0.01313502062112093, 0.0038140728138387203, 0.009615958668291569, 0.005907247308641672, 0.0006967004155740142, -0.005752717610448599, 0.010669570416212082, 0.021367236971855164, -0.007132948376238346, 0.0029395753517746925, -0.0022231198381632566, 0.025960981845855713, -0.008316504769027233, -0.02354469895362854, -0.0012757476652041078, 0.032170262187719345, -0.023895902559161186, -0.028798706829547882, 0.006321667693555355, -0.014848894439637661, -0.0023952096235007048, -0.012418564409017563, -0.01531248353421688, -0.005331272725015879, -0.006911689881235361, -0.013577536679804325, 0.0038246088661253452, 0.01623966172337532, 0.021479621529579163, 0.003315363312140107, 0.01489103864878416, -0.00767028983682394, -0.006493757478892803, 0.026438618078827858, -0.02428925223648548, -0.01215867418795824, -0.0031889299862086773, 0.014722460880875587, 0.018290691077709198, 0.038323353976011276, 0.03070925548672676, 0.01170913316309452, 0.010739810764789581, 0.01911953277885914, -0.007873987779021263, 0.009939066134393215, -0.02527262270450592, -0.01976574771106243, 0.0022231198381632566, -0.020257432013750076, 0.028545841574668884, -0.01983598805963993, 0.023109206929802895, 0.008358648978173733, -0.011034822091460228, 0.001835039583966136, -0.014497690834105015, -0.016787540167570114, 0.0036419827956706285, 0.010346462950110435, -0.017461851239204407, 0.019653361290693283, -0.04706130176782608, -0.008780093863606453, 0.035569917410612106, 0.014511738903820515, 0.008281384594738483, -0.0017173863016068935, 0.015200098045170307, 0.014371257275342941, -0.031327374279499054, -0.028405359014868736, 0.000990394619293511, -0.018515462055802345, 0.001500518061220646, 0.006862521171569824, -0.003919433802366257, 0.0007673801737837493, -0.011098038405179977, 0.02354469895362854, -0.014722460880875587, 0.016913972795009613, -0.00047149104648269713, -0.006082849111407995, 0.011463290080428123, 0.017546139657497406, 0.007600049022585154, -0.03517656773328781, -0.03801429271697998, -0.02808225154876709, -0.020145047456026077, -0.03866050764918327, -0.013767187483608723, 0.0025831034872680902, -0.013746114447712898, 0.014104343019425869, -0.013380862772464752, 0.005506874993443489, 0.030484486371278763, 0.005036261864006519, -0.009960138238966465, 0.017784958705306053, -0.008281384594738483, -0.001205506850965321, -0.005735157057642937, -0.003087081015110016, -0.018290691077709198, 0.0003130103286821395, -0.02353065088391304, -0.0015330043388530612, -0.013935765251517296, 0.03551372513175011, -0.0012731136521324515, 0.06226140260696411, 0.010592305101454258, -0.003016840200871229, 0.00766326580196619, 0.0006365568260662258, 0.04220064356923103, -0.0067887683399021626, 0.007845891639590263, -0.004414631053805351, 0.025736210867762566, 0.009468453004956245, 0.03245122730731964, 0.0023829175624996424, 0.0011519483523443341, -0.005138110835105181, 0.007873987779021263, 0.039278626441955566, 0.016576817259192467, 0.023348025977611542, 0.025665970519185066, -0.042144451290369034, -0.030344003811478615, 0.016633009538054466, 0.01171615719795227, -0.0361599363386631, -0.00430575804784894, 0.024963563308119774, -0.014413401484489441, -0.006876569241285324, -0.010929460637271404, 0.007621121592819691, 0.01723708026111126, 0.024794984608888626, -0.025553584098815918, 0.022912532091140747, 0.015228194184601307, -0.0026024198159575462, 0.029557308182120323, 0.018557606264948845, -0.010311341844499111, -0.005324248690158129, -0.012060336768627167, -0.007986373268067837, 0.02457021363079548, -0.0072418213821947575, 0.009763464331626892, -0.026410521939396858, -0.007283965591341257, -0.058384113013744354, -0.029529212042689323, -0.04649937525391579, -0.00026735386927612126, 0.0544506311416626, 0.004288197960704565, 0.009896921925246716, -0.02455616556107998, -0.019386447966098785, -0.009271779097616673, -0.03177691623568535, -0.016731346026062965, -0.002112490590661764, 0.03076544776558876, -0.010711714625358582, -0.013099899515509605, -0.007255869451910257, 0.016998261213302612, 0.010037403553724289, 0.010915412567555904, 0.0359913595020771, 0.021535813808441162]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
"SP. Table 4 illustrates one plausible partitioning with TSP andKVR for the example in Table 5,
underscoring its difference from TSP.
D. Lookup Table Generation Overhead
We analytically derive the cost to precompute a partitioning lookup table (which is a one-time job). Let us assume that there
areNGPUs and a Ccontext with size , and we will pick a stride size at each level such that there are 5 values to check for
14
KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation
each as shown in Figure 6. Let the time taken for each forward pass to measure TTFT be T.
At each level, there are (N−1)5combinations to evaluate. Once the best combination is picked, we can zoom in and repeat
the evaluation for log5−1Clevels. Therefore, the time taken to precompute the lookup table will be T(N−1)5log5−1C.
For instance, if we assume T= 1sec,N= 8, andC= 16 k for the case in Fig. 8 (c), it would take approximately 33 hours
for an entry. Moreover, each entry can be searched for in parallel, if more GPUs are available. In practice, after a few entries,
we can seed the search from the interpolated context partitioning with limited scopes for the expedition.
15
","[-0.05188990384340286, -0.010629488155245781, 0.059567488729953766, -0.031239839270710945, 0.0014974605292081833, -0.03409907966852188, 0.027083352208137512, 0.012946001254022121, -0.02287391573190689, 0.025137480348348618, 0.04185609146952629, 0.028830666095018387, 0.04034704715013504, -0.007803341373801231, 0.00614537950605154, -0.048289377242326736, 0.028142329305410385, -0.04106185585260391, -0.03139868751168251, 0.03304010257124901, -0.0309750959277153, -0.022317953407764435, 0.005318053066730499, 0.01809527911245823, 0.0037229680456221104, -0.009497705847024918, 0.035634595900774, 0.014680077321827412, 0.0027996720746159554, -0.05318715050816536, 0.02872476726770401, -0.01972345821559429, -0.0515986829996109, -0.04087653383612633, 0.03216644376516342, 0.04572135955095291, 0.00833944883197546, 0.03219291940331459, -0.025097768753767014, 0.014971296302974224, 0.021642854437232018, 8.423215331276879e-05, -0.07995280623435974, 0.005149278789758682, 0.03423145040869713, -0.0063770306296646595, -0.018770378082990646, -0.021126603707671165, -0.045959629118442535, 0.030207335948944092, -0.003557502990588546, 0.011708321049809456, -0.046012576669454575, 0.011417102068662643, -0.042147308588027954, -0.02102070488035679, -0.04275622218847275, -0.0249786339700222, 0.04548308998346329, 0.030948620289564133, 0.022807730361819267, -0.04198846220970154, 0.010563301853835583, 0.006916447542607784, -0.00010046843090094626, 0.002703702310100198, 0.012886433862149715, 0.004192889668047428, -0.006125523708760738, 0.034707989543676376, -0.05707889422774315, 0.034681517630815506, 0.01437562145292759, -0.025269852951169014, 0.021669330075383186, 0.03883800283074379, -0.0054735904559493065, 0.008988072164356709, 0.05011611431837082, -0.0037229680456221104, 0.037461332976818085, -0.013515201397240162, 0.06470353156328201, 0.018677717074751854, 0.03102804347872734, -0.08196486532688141, -0.017565790563821793, 0.003468151669949293, -0.04889829084277153, -0.015778766945004463, -0.02151048183441162, 0.03454914316534996, 0.006330700591206551, 0.0412471778690815, 0.0505661815404892, -0.013793183490633965, 0.03253708779811859, -0.055649273097515106, 0.014706551097333431, 0.010576538741588593, -0.013217364437878132, -0.0004351735988166183, 0.012773917056620121, -0.03955281525850296, 0.06480942666530609, 0.016970116645097733, -0.05008964240550995, 0.028486497700214386, -0.02153695747256279, -0.022463561967015266, -0.0822296142578125, -0.005251867230981588, -0.054140228778123856, 0.020213235169649124, 0.016572998836636543, -0.04656853899359703, -0.07185163348913193, -0.022000260651111603, -0.003052833955734968, -0.013051899150013924, 0.0046793571673333645, 0.026090560480952263, 0.03179580345749855, -0.006324081681668758, -0.058455564081668854, -0.028963036835193634, 0.04082358628511429, -0.0729106068611145, 0.03679947182536125, -0.00862404890358448, 0.0063273911364376545, -0.014971296302974224, 0.04198846220970154, 0.006105667911469936, -0.02284744195640087, 0.02017352357506752, -0.03219291940331459, 0.03269593417644501, 0.030339708551764488, -0.009596984833478928, -0.0735989436507225, -0.005549704656004906, 0.02869829349219799, 0.011013367213308811, -0.058402616530656815, 0.009596984833478928, -0.01358138769865036, 0.05639055743813515, -0.014997770078480244, 0.03338426724076271, -0.011072934605181217, -0.04511244595050812, 0.017062775790691376, -0.004745543468743563, 0.021444296464323997, -0.056867096573114395, -0.023760810494422913, 0.03846736252307892, 0.009583747014403343, -0.00951756164431572, -0.026275882497429848, -0.044053468853235245, 0.08021755516529083, 0.022410614416003227, -0.003656781977042556, 0.0054140230640769005, -0.027003929018974304, 0.017036302015185356, -0.06322096288204193, -0.026831844821572304, 0.009424900636076927, -0.075928695499897, -0.037408385425806046, 0.0038288659416139126, 0.0439210943877697, -0.017565790563821793, -0.05032791197299957, 0.012317233718931675, 0.00660537276417017, -0.026527389883995056, -0.0535842664539814, 0.030392657965421677, 0.009497705847024918, 0.035105109214782715, -0.01769816316664219, 0.025892002508044243, 0.01628177985548973, 0.0034813887905329466, -0.016122933477163315, 0.013230601325631142, 0.01772463694214821, -0.008902030065655708, 0.018571820110082626, 0.04257090017199516, 0.0012550539104267955, -0.002055078512057662, 0.005427260417491198, 0.0026308975648134947, 0.004255766049027443, -0.009219723753631115, 0.010351506061851978, -0.021378111094236374, -0.0007843052735552192, -0.03793787211179733, 0.020530927926301956, -0.03404612839221954, -0.008471820503473282, 0.018452685326337814, 0.013290168717503548, -0.018730666488409042, 0.004149868618696928, 0.017777586355805397, -0.0016099768690764904, 0.00933224055916071, 0.019710220396518707, -0.0053941672667860985, -0.06576251238584518, 0.014110876247286797, -0.003517791163176298, 0.040188200771808624, 0.0013758435379713774, 0.017168674618005753, -0.014044690877199173, 0.009596984833478928, -0.011238399893045425, 0.03738190978765488, -0.006082502659410238, -0.059938132762908936, 0.03701126575469971, -0.018571820110082626, 0.005596034694463015, 0.04267679899930954, 0.008379160426557064, -0.046065524220466614, -0.005566250998526812, -0.027083352208137512, -0.050989773124456406, -0.02758636698126793, -0.03211349621415138, -0.056443504989147186, -0.022066446021199226, -0.0006949540693312883, -0.006681486964225769, -0.0010598049266263843, -0.01475950051099062, 0.01079495344310999, -0.028592394664883614, -0.04188256338238716, 0.018651243299245834, 0.020385319367051125, -0.03335779532790184, -0.027745213359594345, -0.04270327091217041, -0.01321074552834034, -0.05977928638458252, -0.0036964938044548035, 0.022039972245693207, -0.031610481441020966, 0.031954649835824966, 5.100983617012389e-05, 0.006611991208046675, -0.03417850285768509, -0.016321491450071335, -0.003304341109469533, -0.02594495192170143, 0.002268528565764427, 0.02128545008599758, 0.007889383472502232, -0.042888592928647995, -0.07095149904489517, 0.03404612839221954, -0.017539316788315773, 0.018360024318099022, -0.037117164582014084, 0.010278701782226562, -0.032378241419792175, 0.01977640762925148, -0.02307247370481491, -0.019988201558589935, -0.0006680659716948867, -0.026805371046066284, -0.0011235090205445886, 0.0652330219745636, -0.000482744857436046, 0.017936432734131813, -0.013607862405478954, 0.030180862173438072, 0.029227782040834427, -0.023575488477945328, -0.07227522134780884, 0.030895670875906944, 0.018717428669333458, 0.00636379374191165, 0.02440943382680416, 0.02156343124806881, 0.056443504989147186, -0.05038085952401161, 0.011622278951108456, 0.017962908372282982, -0.028618870303034782, 0.019101308658719063, -0.010675817728042603, 0.028115855529904366, 0.023826995864510536, -0.031981125473976135, -0.000549344636965543, 0.020954519510269165, 0.00798204354941845, -0.06586840748786926, 0.01826736330986023, -0.05048675835132599, 0.02074272371828556, -0.0008087113965302706, 0.009722738526761532, -0.021073654294013977, -0.02099423110485077, 0.0645446851849556, -0.058773256838321686, 0.0201470497995615, -0.041273653507232666, 0.025508122518658638, -0.09536093473434448, 0.002784780226647854, 0.015566971153020859, 0.03576697036623955, -0.005890563130378723, -0.03309305012226105, -0.007115005981177092, 0.010728767141699791, -0.01801585592329502, 0.01375347189605236, -0.0031272931955754757, 0.02247679978609085, -0.025892002508044243, -0.0589321032166481, -0.03253708779811859, 0.007115005981177092, 0.015288989059627056, 0.035475749522447586, -0.023482829332351685, -0.07905267924070358, -0.019644035026431084, -0.020358843728899956, 0.0010589775629341602, -0.014269723556935787, 0.07142803817987442, 0.016361204907298088, -0.04352397844195366, 0.06750982254743576, 0.004318642895668745, 0.02301952615380287, -0.03539632633328438, 0.03722306340932846, -0.009934533387422562, 0.006082502659410238, -0.03613761067390442, 0.030445605516433716, -0.04341808333992958, -0.047230400145053864, 0.012383419089019299, 0.020504454150795937, 0.013303406536579132, 0.044847700744867325, -0.03213997185230255, 0.012562122195959091, 0.040955960750579834, -0.059143900871276855, 0.05244586616754532, -0.01585819013416767, 0.012244428507983685, 0.006896591745316982, 0.002399246208369732, 0.03372843563556671, -0.06247967854142189, -0.053690165281295776, -0.0489247664809227, 0.012562122195959091, 0.06173839420080185, 0.03886447846889496, 0.03698479384183884, 0.026209695264697075, -0.004556912928819656, -0.0211398396641016, -0.02128545008599758, 0.046065524220466614, -0.009908059611916542, 0.024713890627026558, 0.0023446425329893827, -0.06682148575782776, -0.020305896177887917, -0.04852765053510666, 0.004285550210624933, 0.02022647298872471, 0.029783744364976883, 0.010708911344408989, 6.48416971671395e-05, 0.027851110324263573, 0.013687285594642162, 0.009034402668476105, 0.014481518417596817, -0.0038090101443231106, -0.016175882890820503, -0.04807758331298828, -0.012859959155321121, 0.009769068099558353, 0.009206486865878105, -0.003249737434089184, 0.020041150972247124, 0.04344455525279045, -0.01682450622320175, 0.028036432340741158, -0.006290988996624947, 0.017976144328713417, -0.033198948949575424, 0.059143900871276855, 0.011311204172670841, 0.0009323966805823147, 0.06094416230916977, -0.006823787000030279, 0.057661332190036774, -0.016440628096461296, 0.015725817531347275, -0.018373262137174606, -0.007115005981177092, -0.05459029600024223, -0.014031453058123589, -0.01359462458640337, -0.037911396473646164, -0.011152357794344425, -0.012965857051312923, 0.007670969236642122, 0.0306309275329113, 0.051439836621284485, 0.041697245091199875, -0.010265463963150978, 0.01878361590206623, 0.055331580340862274, 0.009524179622530937, 0.016784794628620148, 0.011695084162056446, -0.010139710269868374, -0.01707601360976696, 0.0010606322903186083, 0.009491086937487125, -0.03542280197143555, 0.009054258465766907, 0.02002791315317154, -0.010880994610488415, 0.03375491127371788, -0.008928504772484303, 0.03928807005286217, 0.042517952620983124, 0.01744665578007698, 0.006989252287894487, -0.0053246719762682915, -0.04339160770177841, 0.020438266918063164, -0.0014205191982910037, 0.03444324806332588, 0.013832895085215569, 0.01047064084559679, 0.06285031884908676, -0.0489247664809227, -0.003964547533541918, 0.011132501997053623, 0.02827470190823078, 0.03452267125248909, -0.029333679005503654, 0.04310038685798645, 0.00664839381352067, 0.0199749656021595, -0.029757270589470863, 0.044000521302223206, -0.044424109160900116, 0.0053147440776228905, 0.010947180911898613, -0.014785975217819214, -0.03147811070084572, -0.038255564868450165, -0.0007607265142723918, 0.037487808614969254, -0.022172342985868454, 0.009199867956340313, 0.02542869932949543, 0.0271363016217947, 0.08884821832180023, 0.04820995405316353, 0.028248228132724762, 0.015527259558439255, 0.016242068260908127, -0.04532423987984657, -0.020782435312867165, 0.057290688157081604, -0.0141505878418684, -0.017406944185495377, 0.027321621775627136, -0.015077193267643452, 0.007068675477057695, -0.0014362384099513292, 0.004288859199732542, 0.023654911667108536, 0.01900864765048027, 0.01761873997747898, -0.013349736109375954, 0.021695803850889206, 0.03640235587954521, 0.032034073024988174, 0.006211565341800451, 0.013151178136467934, 0.025018345564603806, 0.00765111343935132, 0.025508122518658638, 0.009497705847024918, 0.026011137291789055, 0.006072574760764837, 0.00861081201583147, -0.02369462326169014, -0.005318053066730499, 0.007340038660913706, 0.0063373190350830555, -0.019988201558589935, 0.0006486237980425358, -0.013058518059551716, -0.012198098003864288, 0.025243379175662994, -0.03370196372270584, -0.03849383443593979, -0.13766708970069885, -0.034390296787023544, -0.06099710986018181, 0.004633027128875256, -0.004586696624755859, -0.023006288334727287, -0.0022900390904396772, -0.037117164582014084, 0.012701112776994705, 0.02188112400472164, -0.0054537346586585045, -0.019683746621012688, 0.02079567313194275, -0.0021411203779280186, 0.023906419053673744, 0.005202227272093296, 0.021470770239830017, 0.0064068143256008625, -0.03965871036052704, 0.06999842077493668, 0.004844822455197573, -0.006830405443906784, -0.02128545008599758, 0.0027765068225562572, -0.023654911667108536, 0.024184400215744972, -0.02054416574537754, -0.027401044964790344, -0.004252457059919834, 0.0062281121499836445, 0.030127912759780884, 0.010477259755134583, -0.030842723324894905, 0.01433590892702341, 0.04082358628511429, 0.02139134705066681, -0.03221939504146576, -0.0192866288125515, 0.01000071968883276, 0.03767312690615654, -0.018479159101843834, 0.014455044642090797, 0.003670019330456853, -0.019988201558589935, -0.011112646199762821, 0.006115595810115337, 0.017764348536729813, 0.030816247686743736, -0.031610481441020966, 0.021232500672340393, -0.01769816316664219, 0.006271133199334145, -0.002010402735322714, -0.016890693455934525, 0.00853800680488348, 0.00481503875926137, -0.006674868054687977, -0.014838923700153828, -0.0032778666354715824, -1.1362809345882852e-05, -0.00023620165302418172, -0.037064217031002045, 0.0063373190350830555, 0.04151192307472229, 0.014666839502751827, 0.04148544743657112, -0.009391807951033115, 0.007697443477809429, 0.0028278010431677103, 2.2299027477856725e-05, -0.02190759964287281, -0.020689774304628372, -0.018545344471931458, -0.004381519742310047, 0.009596984833478928, -0.015805240720510483, -0.027030402794480324, -0.03674652427434921, 0.026725947856903076, -0.01126487459987402, 0.04302096366882324, 0.039261594414711, -0.007803341373801231, 0.014057927764952183, -0.009305765852332115, -0.03690537065267563, 0.031663428992033005, -0.005877325776964426, -0.04024114832282066, -0.004745543468743563, -0.027665790170431137, 0.03367548808455467, -0.019114546477794647, 0.022715069353580475, -0.026434728875756264, 0.000529075157828629, 0.001516489079222083, 0.0022635646164417267, 0.03807024657726288, 0.026355305686593056, -0.021060416474938393, -0.05165163427591324, 0.04304743930697441, -0.007492266595363617, 0.015090431086719036, 0.00816736463457346, 0.0485805980861187, -0.012608451768755913, 0.014680077321827412, 0.026487678289413452, 0.026064086705446243, 0.028089381754398346, 0.003527719061821699, 0.03065740130841732, 0.03293420374393463, 0.019167494028806686, -0.009610221721231937, 0.03701126575469971, 0.02594495192170143, -0.00879613310098648, 0.05347836762666702, -0.008802751079201698, -0.02622293308377266, -0.008087941445410252, -0.020835384726524353, 0.029677847400307655, 0.013991741463541985, 0.0236416757106781, 0.002189105376601219, 0.011900261044502258, -0.026275882497429848, -0.013846131972968578, -0.023601964116096497, -0.010781715624034405, 0.002409174107015133, -0.021616380661725998, 0.006400195881724358, 0.02988964319229126, -0.004252457059919834, 0.028963036835193634, 0.028645344078540802, -0.0011805945541709661, 0.007757010869681835, -0.027242198586463928, 0.046012576669454575, 0.038679156452417374, 0.010417692363262177, -0.0027500325813889503, -0.0018581748008728027, -0.0024439217522740364, -0.02701716683804989, -0.010364742949604988, 0.03139868751168251, -0.03187522664666176, -0.012608451768755913, -0.03952633962035179, 0.004245838150382042, 0.002023640088737011, 0.01192011684179306, -0.00670465175062418, 0.002606077818199992, 0.01687745563685894, -0.04190903902053833, 0.009669789113104343, -0.00991467759013176, 0.020385319367051125, -0.012734205462038517, 0.011013367213308811, -0.008729946799576283, -0.00871009100228548, 0.027030402794480324, -0.020530927926301956, 0.01136415358632803, -0.012654782272875309, 0.03807024657726288, -0.03531690314412117, -0.023562252521514893, -0.02753341756761074, -0.02508453279733658, -0.00786952767521143, 0.029810220003128052, 0.0622149333357811, -0.039420440793037415, -0.003855340415611863, -0.011106027290225029, -0.019299866631627083, 0.003670019330456853, -0.04119423031806946, 0.02258269675076008, -0.011681846342980862, 0.007545215543359518, -0.001228579436428845, -0.0004219363909214735, -0.024965396150946617, 0.02391965687274933, 0.015288989059627056, -0.026289118453860283, -0.007836434058845043, -0.005013597197830677, -0.040294099599123, 0.011913497932255268, 0.0231254231184721, 0.03423145040869713, 0.03735543414950371, 0.008736565709114075, 0.0013841168256476521, -0.0213119238615036, 0.007412843406200409, 0.013925555162131786, -0.028195278719067574, 0.007227522321045399, -0.01761873997747898, -0.008928504772484303, -0.01707601360976696, -0.036269981414079666, 0.0008016791543923318, 0.033569589257240295, 0.007975424639880657, 0.0011797671904787421, -0.02210615761578083, -0.016665659844875336, -0.027798162773251534, -0.013647574000060558, -0.005615890491753817, 0.012621689587831497, 0.007531978189945221, -0.026514152064919472, 0.025865528732538223, -0.02562725730240345, 0.021867888048291206, 0.0020666609052568674, 0.004527129232883453, -0.000965489714872092, 0.006502784322947264, 0.011959828436374664, 0.0002608145878184587, 0.001514834351837635, 0.04963957518339157, 0.002470396226271987, -0.009596984833478928, -0.02451533079147339, -0.0030263594817370176, 0.01475950051099062, 0.0029932663310319185, 0.013084991835057735, 0.014402095228433609, 0.018995411694049835, 0.034707989543676376, -0.014282960444688797, 0.0006970223621465266, -0.01761873997747898, 0.03253708779811859, 0.030392657965421677, -0.023059237748384476, -0.008855700492858887, -0.038996849209070206, -0.0333048440515995, -0.04164429381489754, -0.0032050618901848793, -0.001859829411841929, 0.024541806429624557, 0.001881339936517179, -0.06708623468875885, -0.01886303909122944, -0.039076272398233414, -0.01571257971227169, 0.0229533389210701, 0.005635746289044619, 0.0015686105471104383, -0.02562725730240345, -0.09599632024765015, -0.001423828536644578, 0.02091480791568756, 0.006850261241197586, 0.021431058645248413, -0.008180602453649044, 0.005440497305244207, -0.018280601128935814, 0.03574049472808838, -0.0010134746553376317, -0.021378111094236374, -0.04355045408010483, -0.011350915767252445, 0.0047190687619149685, -0.005936893168836832, 0.0009828635957092047, -0.01673184707760811, 0.012793772853910923, -0.016970116645097733, -0.05398138239979744, 0.004229291807860136, -0.0024770149029791355, 0.022344427183270454, 0.005023525096476078, -0.049507204443216324, -0.014627127908170223, 0.01156271155923605, -0.033225420862436295, -0.0029336989391595125, 0.01532870065420866, -0.01724809780716896, -0.010311794467270374, 0.014110876247286797, 0.045271292328834534, -0.03836146369576454, -0.00439806655049324, -0.01883656345307827, 0.015050719492137432, 0.011006748303771019, 0.000934878655243665, -0.024422671645879745, -0.03987050801515579, 0.013819658197462559, -0.01994848996400833, 0.035555172711610794, -0.029042460024356842, 0.02158990688621998, -0.006032863166183233, -0.007962187752127647, 0.02597142569720745, 0.02943957783281803, -0.013362973928451538, -0.007757010869681835, -0.01129134837538004, 0.03772607818245888, 0.011913497932255268, -0.020279420539736748, -0.0014213465619832277, 0.0018217724282294512, 0.006737744901329279, -0.0032050618901848793, 0.01920720562338829, 0.05511978268623352, -0.04302096366882324, -0.0452977679669857, -0.037884924560785294, 0.010536827147006989, 0.047495145350694656, 0.004533747676759958, 0.016387678682804108, 0.009113825857639313, -0.012158386409282684, 0.000569614116102457, -0.008577718399465084, 0.00852476991713047, 0.000965489714872092, -0.028857139870524406, 0.01274082437157631, -0.0722222700715065, 0.018134990707039833, 0.029413102194666862, -0.03407260403037071, 0.015633156523108482, 0.017195148393511772, 0.007849671877920628, 0.010536827147006989, 0.01982935518026352, -0.00439806655049324, -0.018757140263915062, -0.020636826753616333, 0.025534598156809807, -0.01513014268130064, -0.005006978288292885, -0.0013278586557134986, 0.023178372532129288, 0.026037611067295074, 0.021894361823797226, 0.028221752494573593, 0.0026093870401382446, 0.011913497932255268, 0.026778895407915115, 0.028804190456867218, 0.0002837729116436094, -0.05718478932976723, -0.029042460024356842, 0.01457417942583561, 0.0306309275329113, -0.008915267884731293, 0.015619919635355473, -0.02096775732934475, 0.005010287743061781, -0.023059237748384476, 0.0014006634010002017, 0.03542280197143555, -0.01838649809360504, 0.040161725133657455, 0.013687285594642162, 0.012694493867456913, 0.01184731163084507, -0.05318715050816536, 0.009769068099558353, 0.03065740130841732, -0.0024141380563378334, -0.009524179622530937, -0.017195148393511772, 0.015699343755841255, -0.013621099293231964, 0.029810220003128052, 0.0006841988069936633, -0.0070223454385995865, -0.011397246271371841, 0.02562725730240345, 0.025640495121479034, 0.014785975217819214, 0.00842549093067646, -0.011926735751330853, -0.012601833790540695, -0.0010101653169840574, 0.009173393249511719, 0.02190759964287281, 0.00863728579133749, -0.00980216171592474, 0.014402095228433609, 0.014984533190727234, 0.015672868117690086, 0.012548884376883507, -0.003835484618321061, -0.006410123780369759, 0.01809527911245823, 0.001820117817260325, -0.00045378843788057566, -0.04122070223093033, -0.004219363909214735, 0.018505632877349854, -0.021298687905073166, 0.04381519928574562, -0.00457345973700285, -0.02042503096163273, 0.01940576545894146, 0.04887181520462036, 0.0030975094996392727, 0.020305896177887917, -0.0027003928553313017, -0.011503144167363644, 0.033119525760412216, 0.001535517512820661, -0.0022635646164417267, -0.010344887152314186, 0.01201939582824707, 0.027639316394925117, -0.011297967284917831, -0.015646394342184067, 0.0027880894485861063, 0.01377994567155838, 0.06417404115200043, -0.0011475015198811889, 0.003656781977042556, -0.010907469317317009, -0.026845082640647888, 0.012965857051312923, -0.02634206786751747, 0.014441806823015213, -0.022794492542743683, -0.0062976074405014515, 0.00558941625058651, -0.029386628419160843, -0.013634337112307549, 0.0009927914943546057, 0.009590365923941135, 0.006671559065580368, 0.03873210772871971, 0.029810220003128052, 0.015394886955618858, 0.03102804347872734, 0.011066315695643425, -0.00765111343935132, -0.008207076229155064, -0.016175882890820503, -0.011139120906591415, -0.002874131314456463, -0.022662119939923286, 0.02517719194293022, 0.012515791691839695, -0.02426382526755333, -0.03957928717136383, 0.04182961583137512, -0.0071216244250535965, -0.008015137165784836, -0.015646394342184067, 0.029333679005503654, 0.005599344149231911, 0.03219291940331459, -0.01732752099633217, 0.007637876085937023, 0.006727817002683878, -0.006645084358751774, -0.0012260974617674947, -0.012059107422828674, 0.0055331578478217125, -0.014455044642090797, -0.03065740130841732, -0.028195278719067574, -0.0008852391038089991, -0.007743773981928825, -0.011926735751330853, 0.005053308792412281, 0.01603027433156967, -0.01458741631358862, -0.0006209083367139101, 0.021444296464323997, -0.0010904159862548113, 0.010119854472577572, 0.012052488513290882, -0.006995870731770992, -0.015077193267643452, 0.017539316788315773, -0.01573905535042286, -0.013740234076976776, -0.010596394538879395, -0.00011334369628457353, 0.019564611837267876, 0.0011359188938513398, 0.02835412509739399, 0.015288989059627056, -0.008690235204994678, -0.02832765132188797, 0.027083352208137512, 0.026659760624170303, 0.0017258025472983718, 0.007492266595363617, -0.004606552422046661, 0.005711860489100218, 0.01994848996400833, -0.012581977993249893, 0.00581775838509202, 0.0047389245592057705, -0.0012244428507983685, 0.052181120961904526, -0.0055629415437579155, 0.0001681540597928688, -0.01018604077398777, -0.022940102964639664, 0.03068387694656849, 0.009087351150810719, -0.011284730397164822, -0.01319750864058733, -0.00036319621722213924, -0.030736824497580528, 0.030101438984274864, 0.004864678252488375, -0.024157926440238953, 0.02458151802420616, -0.0045502944849431515, 0.010305175557732582, -0.019710220396518707, 0.00343836797401309, -0.02372109889984131, -0.014719788916409016, 0.022993050515651703, -0.013819658197462559, -0.024422671645879745, -2.6383951990283094e-05, -0.021073654294013977, 0.01395202986896038, 0.019816119223833084, -0.025097768753767014, -0.003650163533166051, -0.01201939582824707, 0.04122070223093033, 0.000792578561231494, -0.02019999735057354, 0.008736565709114075, 0.026884794235229492, -0.0005249385139904916, 0.003324196906760335, -0.04177666828036308, -0.0062380400486290455, 0.0062082563526928425, -0.005536467302590609, -0.055702220648527145, 0.010192659683525562, -0.009484468027949333, 0.03367548808455467, -0.011939972639083862, 0.018770378082990646, 0.017406944185495377, -0.017751112580299377, -0.00048646784853190184, -0.03343721851706505, -0.018254127353429794, 0.033172473311424255, 0.007717299275100231, 0.013899081386625767, 0.028592394664883614, -0.02391965687274933, 0.03955281525850296, 0.012674638070166111, -0.017909958958625793, -0.003251392161473632, 0.006843642797321081, 0.0018631387501955032, 0.01303866133093834, 0.015249277465045452, -0.01493158470839262, 0.025693444535136223, -0.010510352440178394, 0.011992921121418476, -0.0025779486168175936, -0.02108689211308956, -0.02292686514556408, 0.01730104722082615, 0.027348097413778305, 0.02594495192170143, 0.02659357525408268, -0.033198948949575424, 0.005258485674858093, 0.026659760624170303, -0.012330470606684685, -0.0037229680456221104, 0.01550078485161066, 0.0229533389210701, 0.00766435032710433, 0.0062082563526928425, -0.024184400215744972, -0.02190759964287281, 0.013899081386625767, -0.008193839341402054, 0.023112187162041664, 0.004262384958565235, 0.014905110001564026, 0.06210903823375702, -0.001006028731353581, -0.03640235587954521, -0.002915497636422515, -0.026064086705446243, 0.03213997185230255, -0.004156487062573433, -0.016374440863728523, -0.028486497700214386, 0.03963223844766617, -0.014613891020417213, -0.01727457158267498, -0.007167954463511705, -0.006105667911469936, 9.136784501606598e-05, 0.030339708551764488, -0.012707731686532497, 0.015183091163635254, 0.009299146942794323, -0.017380470409989357, 0.02332398109138012, -0.034284401684999466, -0.00189126783516258, -0.004110157024115324, 0.0015214530285447836, -0.0013799802400171757, -0.015977324917912483, -0.007313563954085112, 0.018254127353429794, -0.0005476899677887559, -0.0010804880876094103, -0.013270312920212746, -0.004864678252488375, -0.011966447345912457, 0.009259435348212719, 0.020292658358812332, -0.006383649539202452, 0.016771558672189713, -0.0004761262680403888, -0.008736565709114075, 0.02153695747256279, -0.008359304629266262, -0.0010846246732398868, -0.004891152959316969, -0.02577286772429943, 0.003812319366261363, 0.020755961537361145, 0.01035812497138977, 0.021404584869742393, -0.01801585592329502, -0.0037659890949726105, -0.01035812497138977, -0.012277521193027496, 0.006340628489851952, 0.005721788387745619, -0.047177452594041824, 0.010947180911898613, -0.0020898261573165655, 0.03963223844766617, 0.037858448922634125, -0.0522870197892189, -0.033913757652044296, -0.01571257971227169, 0.01007352489978075, -0.04956015199422836, -0.0496130995452404, -0.020928045734763145, 0.029783744364976883, -0.007055438123643398, -0.014282960444688797, -0.012409893795847893, 0.019882304593920708, -0.0269642174243927, -0.00132123997900635, 0.016798032447695732, 0.017658451572060585, -0.01690392941236496, 0.03187522664666176, 0.02483302541077137, 0.019419001415371895, -0.023681387305259705, -0.010947180911898613, -0.01219148002564907, -0.010152948088943958, 0.017406944185495377, -0.005619199946522713, 0.020676538348197937, 0.019313104450702667, 0.0019144329708069563, 0.029942592605948448, -0.016798032447695732, 0.01184731163084507, -0.0002622624160721898, 0.003052833955734968, -0.023006288334727287, -0.028460023924708366, -0.03068387694656849, -0.04550956189632416, 0.020107338204979897, -0.007849671877920628, -0.039367493242025375, -0.010411073453724384, 0.03685241937637329, -0.010152948088943958, -0.03690537065267563, -0.004315333906561136, -0.02587876468896866, 0.007551833987236023, 0.022860679775476456, 0.003626998281106353, -0.007737155072391033, -0.00031066100928001106, -0.022066446021199226, -0.004990431945770979, -0.006797312293201685, 0.0528959296643734, -0.005596034694463015, 0.008518151007592678, 0.03145163506269455, -0.013389447703957558, 0.03452267125248909, -0.019366053864359856, -0.0028377289418131113, -0.014243248850107193, 0.0053710020147264, -0.011139120906591415, -0.011198688298463821, -0.008888793177902699, -0.01591113768517971, -0.016202356666326523, -0.02488597296178341, -0.015646394342184067, 0.025521360337734222, 0.009140300564467907, 0.021497245877981186, 0.047945212572813034, -0.0037229680456221104, -0.028460023924708366, -0.007684206124395132, -0.01707601360976696, -0.012952620163559914, 0.02793053351342678, -0.014481518417596817, -0.007717299275100231, 0.006251277402043343, 0.010933944024145603, 0.006284370087087154, -0.02287391573190689, 0.0429680161178112, -0.015394886955618858, 0.004421231336891651, -0.012396656908094883, -0.0053048161789774895, -0.00011861789971590042, -0.008504914119839668, 0.01821441575884819, -0.026302356272935867, -0.015355175361037254, 0.04887181520462036, -0.0008318765321746469, 0.012078963220119476, 0.005122804082930088, 0.011986303143203259, -0.006555733270943165, 0.033119525760412216, -0.04574783146381378, -0.012072344310581684, -0.007518740836530924, 0.010953799821436405, -0.018201177939772606, 0.012383419089019299, 0.022834204137325287, 0.014402095228433609, -0.015699343755841255, -0.03206054866313934, -0.0006039481377229095, -0.021431058645248413, 0.019498424604535103, -0.012919526547193527, -0.0016033583087846637, -0.009788923896849155, -0.029942592605948448, 0.02642149105668068, 0.003646854078397155, -0.0164803396910429, 0.0045701502822339535, -0.005887253675609827, 0.01136415358632803, 0.0025448554661124945, -0.002480324124917388, 0.01358138769865036, 0.0038156285881996155, 0.00924619846045971, -0.0383085161447525, -0.011741414666175842, -0.0047389245592057705, 0.01935281604528427, 0.04855412244796753, -0.01752607896924019, 0.010245608165860176, 0.01940576545894146, 0.013071754947304726, -0.010603013448417187, -0.01801585592329502, 0.021325161680579185, 0.018333550542593002, 0.002217234345152974, -0.011953209526836872, -0.002197378547862172, -0.012264284305274487, 0.0379643477499485, 0.003732896177098155, -0.00013743957970291376, -0.004732306115329266, -0.03216644376516342, 0.009352096356451511, 0.024568280205130577, -0.008418872021138668, -0.006185091100633144, -0.04736277461051941, 0.014521230012178421, 0.02869829349219799, -0.026183221489191055, -0.03759370371699333, -0.006830405443906784, -0.03420497849583626, 0.004262384958565235, -0.017605502158403397, -0.01576552912592888, -0.0014172098599374294, -0.037911396473646164, 0.010808190330862999, 0.031981125473976135, 0.02267535775899887, 0.021973785012960434, -0.02384023368358612, -9.553033123665955e-06, 0.009266054257750511, -0.008134271949529648, 0.05014258995652199, -0.026725947856903076, -0.015778766945004463, -0.005063236691057682, -0.011317823082208633, 0.009894821792840958, 0.018558582291007042, 0.019074834883213043, -0.010702292434871197, 0.01550078485161066, 0.007353275548666716, -0.02128545008599758, 0.0009059222647920251, -0.024277061223983765, -0.013832895085215569, -0.0013485418166965246, 0.011589186266064644, 0.005811139475554228, 0.0012351981131359935, 0.015871426090598106, 0.031557533890008926, 0.016983352601528168, -0.008849081583321095, -0.006532568018883467, 0.01200615894049406, 0.0157920029014349, -0.015447835437953472, -0.038202617317438126, 0.04151192307472229, -0.040929485112428665, -0.0012385074514895678, 0.02505805715918541, 0.009894821792840958, 0.008584337309002876, 0.020636826753616333, 0.01284010335803032, 0.007359894458204508, -0.024303536862134933, 0.0005344527889974415, 0.013349736109375954, -0.016745083034038544, 0.016758320853114128, -0.00426900340244174, 0.014230011962354183, -0.013389447703957558, -0.002288384363055229, 0.022344427183270454, -0.014296197332441807, 0.01727457158267498, 0.002988302381709218, -0.011436957865953445, 0.008418872021138668, 0.022542985156178474, 0.007253996562212706, -0.01107955351471901, -0.032828304916620255, -0.004136631265282631, -0.007148098666220903, 0.002895641839131713, 0.0001802537008188665, 0.012085582129657269, -0.019564611837267876, 0.016718609258532524, 0.010960417799651623, -0.005149278789758682, -0.004556912928819656, -0.00038470671279355884, 0.0017572409706190228, 0.015024244785308838, 0.004295478109270334, 0.0031488037202507257, -0.025163955986499786, 0.0052849599160254, -0.012052488513290882, 0.00826664362102747, -0.04903066158294678, -0.01804233156144619, -0.025812579318881035, 0.026355305686593056, -0.016202356666326523, 0.045668408274650574, 0.006082502659410238, 0.02438296005129814, -0.003752751974388957, 0.0006705479463562369, 0.022622408345341682, -0.030816247686743736, 0.024475619196891785, -0.008815988898277283, 0.008246787823736668, -0.027348097413778305, 0.030207335948944092, -0.0020914808847010136, -0.004656192380934954, 0.002683846279978752, 0.005801211576908827, -0.003219953738152981, 0.03756723180413246, -0.0025680207181721926, 0.03216644376516342, -0.013336499221622944, 0.010192659683525562, 0.016242068260908127, -0.0214840080589056, -0.0035608122125267982, -0.02173551544547081, 0.0319281741976738, -0.007531978189945221, 0.007677587680518627, -0.006373721640557051, 0.031610481441020966, -0.029942592605948448, 0.014004979282617569, -0.038599733263254166, 0.042067885398864746, 0.031239839270710945, -0.019644035026431084, 0.0145609425380826, -0.003019740805029869, -0.012608451768755913, 0.014044690877199173, -0.017949670553207397, 0.008941742591559887, -0.0047190687619149685, 0.013674048706889153, -0.006903210189193487, -0.01682450622320175, -0.019366053864359856, -0.04280916973948479, -0.032007597386837006, -0.04574783146381378, 0.001159084029495716, 0.04744219779968262, -0.0010101653169840574, 0.006502784322947264, 0.016890693455934525, -0.027427520602941513, -0.001322894706390798, -0.04458295553922653, -0.01027208287268877, 0.016784794628620148, 0.020928045734763145, -0.01779082417488098, -0.0022900390904396772, -0.004199508111923933, -0.00833944883197546, 0.03224586695432663, 0.020305896177887917, 0.01377994567155838, -0.003100818721577525]",KV-Runahead: Scalable Causal LLM Inference by Parallel Key-Value Cache Generation.pdf
